'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[2],{101:function(K,Z,d){K=d(0);var k=d(15);class e{constructor(){this.userId=this.email=this.displayName=null}}Object(K.a)(e,"InsertMentionParameters",null,[]);class n{constructor(){this.neighborhood=null;this.mentionLength=this.mentionStart=0}}Object(K.a)(n,"InsightsParameters",null,[]);var r=d(961),v=d(962),C=d(963),w=d(964),z=d(25),A=d(377),u=d(445),E=d(33),H=d(54),I=d(45),J=d(123);d.d(Z,"a",function(){return T});
class T{static get xFj(){return"Insights_16x16x32"}static get BWi(){return"Find_16x16x32"}static get N8g(){return"-Parameterized"}static get sXe(){return"Parameterized"}static get Isd(){return"bTryQuery"}static get z1e(){return"TellMeSuggestion_"}static get DDh(){return"bTryQueryAlternate"}static get e_e(){return"MenuTellMe"}static get pzk(){const D={},R=[];Array.add(R,{Term:{PeopleType:"Person"}});D.And=R;return D}static aHi(D){return D+T.N8g}static getParameter(D){let R="",Q="";if(D)for(let W=0;W<
D.dTf;++W)"Type"===D.y5d(W)?R=D.eb(W):"Value"===D.y5d(W)&&(Q=D.eb(W));return new k.a(R,Q)}static $Wd(D){D=Object.assign(new n,{neighborhood:D,mentionStart:0,mentionLength:D.length});return E.c(D)}static SIf(D,R,Q){D=Object.assign(new e,{displayName:D,email:R,userId:Q});return E.c(D)}static yCa(D,R,Q=null){D=Object.assign(new u.a,{neighborhood:D,mentionStart:0,mentionLength:D?D.length:0});R=Object.assign(new A.a,{selection:D,userIntent:null,entryPoint:R,launchData:Q});return E.c(R)}static eZk(D,R){return T.yCa(D,
T.fZk(R))}static fZk(D){switch(D){case "Answer":return 3;case "Definition":return 2;case "DocFindResult":return 15;case "Entity":return 16;case "InsightsResult":return 1;default:return 0}}static Mgg(){return!!z.AFrameworkApplication.fa&&z.AFrameworkApplication.fa.ka("IsGoLocalEnvironment")}static Rab(){const D=z.AFrameworkApplication.fa?z.AFrameworkApplication.fa.Ha("SovereignEnvironmentName"):null;return!!D&&0<D.length}static isEnterpriseUser(){const D=z.AFrameworkApplication.fa?z.AFrameworkApplication.fa.Ha("HostAuthType"):
null;return!!D&&"aad"===D.toLowerCase()||"external"===D&&T.Mhe()}static IVe(D){return D.Sol&&!T.Rab()}static Mjg(){const D=z.AFrameworkApplication.fa?z.AFrameworkApplication.fa.Ha("UiHostIntegrationType"):"";return!!z.AFrameworkApplication.fa&&"UnifiedUiHostTeams"===D&&z.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.UnifiedAppsShowSearchInHeader",!1)}static HVe(D){return D.$ya&&D.vVi&&(D.bsc||D.asc||D.OUa)&&!T.Mjg()&&T.isEnterpriseUser()&&!T.Rab()}static R3(){return z.AFrameworkApplication.fa?
z.AFrameworkApplication.Eya||z.AFrameworkApplication.fa.ka("SmartLookupEnableNativePane"):z.AFrameworkApplication.Eya}static MI(D){return!D||T.mkg(D.Ff)}static mkg(D){return!D||!D.trim().length}static rsd(D){if(!D)return 0;const R=Math.pow(10,5);return Math.round(D*R)/R}static Eql(){var D=new Date;return D?new Date(D.getUTCFullYear(),D.getUTCMonth(),D.getUTCDate(),D.getUTCHours(),D.getUTCMinutes(),D.getUTCSeconds(),D.getUTCMilliseconds()):null}static G9d(D){return(T.Eql().getTime()-(new Date(D)).getTime())/
1E3}static Jkg(D){const {InsightsMenuItemFactory:R}=d(960);switch(D){case r.a.Uae:case v.a.AUf:case R.Xcg:case C.a.u_g:case "FindParameterized":case "FindWithMatchesParameterized":case "AnswerForSearch":case "AnswerForSearchSingleLine":case "WolframForSearch":case "LearningForSearch":case "ImageForSearch":case "TellMeFeedback":case "TemplateForSearch":case "ActionAIFromTellMe":case "LaunchAddinDialogFromTellMe":return!0}return D.startsWith(T.Isd)||D.startsWith(T.z1e)||D.startsWith(T.DDh)||D.startsWith("PeopleSuggestion")||
D.startsWith("FileSuggestion")||D.startsWith("FindInDocumentSuggestion")||D.startsWith("NotesSuggestion")||D.startsWith("OnenoteNotesSuggestion")||D.startsWith("SmartLookupFromTellMe")||D.startsWith("GetHelpFromTellMe")||D.startsWith("GetHelpWithDescriptionFromTellMe")||D.startsWith("AddinSuggestion")||D.startsWith("OfficeScripts")?!0:!1}static U5d(D,R){const Q=[];Array.add(Q,new w.a(400,D));Array.add(Q,new w.a(200,R));D={};D.parts=Q;return JSON.stringify(D)}static iSa(D){const R=D.indexOf("<b0>"),
Q=D.lastIndexOf("</b0>"),W=[];Array.add(W,new w.a(400,D.substring(0,R)));Array.add(W,new w.a(600,D.substring(R+4,Q)));Array.add(W,new w.a(400,D.substring(Q+5,D.length)));D={};D.parts=W;return JSON.stringify(D)}static S5f(D){const R=T.G9d(D);return 60>R?CommonUIStrings.l_TimeSince_SecsAgo:3600>R?String.format(CommonUIStrings.l_TimeSince_MinsAgo,Math.floor(R/60).toString()):86400>R?String.format(CommonUIStrings.l_TimeSince_HoursAgo,Math.floor(R/3600).toString()):172800>R?CommonUIStrings.l_TimeSince_Yesterday:
String.format(CommonUIStrings.l_TimeSince_Date,(new Date(D)).localeFormat("MMMM dd, yyyy"))}static u4i(D){const R=Array(D.length);for(let Q=0;Q<D.length;Q++)R[Q]=D[Q].commandId;return R}static Mhe(){if("Dev Box"===z.AFrameworkApplication.fa.Ha("StatusBarEnvironmentNameToUse"))return!0;let D=z.AFrameworkApplication.fa.Ha("UserPrincipalName");D=J.b(D)?"":I.a.og(D);const R=z.AFrameworkApplication.fa.aw("TellMeIntEnabledForFeatureCrew")?z.AFrameworkApplication.fa.RA("TellMeIntEnabledForFeatureCrew"):
[];return 0<=Array.indexOf(R,D)&&"inner"===z.AFrameworkApplication.fa.Ha("Microsoft365Ring")}static M9i(D){switch(D.toLowerCase()){case "pptx":case "ppt":case "pot":case "ppa":case "pps":case "pptm":case "odp":case "ppsx":case "ppsm":case "potx":case "potm":return"SaveAsPowerPointPotx_20";case "docx":case "doc":case "docm":case "dot":case "dotx":case "odt":case "dotm":return"SaveAsWordDocx_20";case "xlsx":case "xls":case "xlb":case "xlc":case "xlsb":case "xlsm":case "xlt":case "odc":case "ods":return"SaveAsExcelXlsx_20";
case "pdf":return"PdfFile_32";case "one":case "onepkg":return"OneNote_32";case "vsd":case "vsdx":case "vss":case "vst":case "vdx":case "vtx":case "vsx":case "vstx":case "vssm":case "vdw":case "vsdm":case "vssx":case "vstm":case "vsw":return"Visio_32"}return""}static hx(){return H.a.wT&&!H.a.Uj}}T.$rd=9E5;Object(K.a)(T,"TellMeUtils",null,[])},1031:function(K,Z,d){K=d(0);var k=d(17),e=d(142),n=d(665),r=d(378),v=d(261),C=d(447),w=d(154),z=d(169),A=d(168),u=d(115),E=d(101);class H{constructor(fa){this.ub=
fa;this.pDc=this.g9d()}CF(){return"Add-ins"}EN(){return 0===this.ub.zq?0:1===this.ub.zq?1:3}vC(fa,ka){fa=new A.a(fa);ka.resultsUpdated(fa)}gTa(fa,ka,ha){let F;F=this.ub.HH?new z.a(27):new z.a(25);F.displayName=CommonUIStrings.l_TellMeAddinProviderTitle;ha&&this.qhl(fa.Ff,ka,F)}qhl(fa,ka,ha){const F=[];let na;na=this.ub.YGj?this.ub.HH&&this.ub.CPa?E.a.iSa(String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_1_Bolded,fa)):String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_1,
fa):this.ub.ZGj?this.ub.HH&&this.ub.CPa?E.a.iSa(String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_2_Bolded,fa)):String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_2,fa):this.ub.HH&&this.ub.CPa?E.a.iSa(String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_0_Bolded,fa)):String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_0,fa);this.ub.bda?(u.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel("LaunchAddinDialogFromTellMe",na)),
u.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId("LaunchAddinDialogFromTellMe",fa))):(F.push(appChrome.actions.setControlLabel("LaunchAddinDialogFromTellMe",na)),F.push(appChrome.actions.setButtonCommandValueId("LaunchAddinDialogFromTellMe",fa)),appChrome.api.dispatch(F));ha.fv(new w.a("LaunchAddinDialogFromTellMe",28));ka.es(ha)}g9d(){const fa=[];this.ub.vXc&&Array.add(fa,"Addin");return fa}}Object(K.a)(H,"AddinStoreResultsProvider",null,[962]);var I=d(965),J=d(330),
T=d(379),D=d(966),R=d(998),Q=d(967),W=d(446),O=d(25),Y=d(33),S=d(104);d.d(Z,"a",function(){return da});class da{constructor(fa,ka,ha){this.$Vb=this.XCc=this.YCc=this.WCc=!1;this.bI=null;this.ZR=-1;this.f5a=this.pWb=null;this.xWb="";this.t3a=0;this.ub=fa;const F=E.a.R3();this.$Ma=ka||[];this.ei=O.AFrameworkApplication.Je;this.smf=fa.sHe;this.ZCc=fa.rHe;this.BJd=F&&this.Pjb();this.CJd=F&&this.Qjb();this.x_h=F&&this.Rjb();this.EJd=this.XLb();this.umf=this.WLb();fa.YYe&&E.a.HVe(fa)&&(this.pWb=new R.a(fa),
this.WCc=fa.asc,this.YCc=fa.bsc,this.XCc=fa.OUa,this.$Vb=this.WCc&&this.Zx("File")||this.YCc&&this.Zx("People")||this.XCc&&this.Zx("Notes"));this.VCc=this.Kdl();this.aDc=fa.$jc;this.DJd=this.Ydl();this.rmf=this.Jdl();this.Gza=this.xkj();this.Y5e=new I.a(fa);this.fSh=new D.a(fa);this.Y0h=new Q.a(fa);this.bMh=new H(fa);this.sVb=ha;this.WId=new n.a;this.aDc&&(this.Y5e=new I.a(fa))}Zx(fa){return Array.contains(this.$Ma,fa)?!0:!1}CF(){return"TellMeService"}EN(){return 0===this.ub.zq?0:1===this.ub.zq?1:
this.Zx("Command")||this.Zx("Recommended")?2:3}ukj(fa){let ka="";if(!fa&&this.Zx("Command")&&this.ub.fje){ka+="CommandSearch_DLIS,";var ha=this.ub.CAh;0<ha.length&&(ka+=ha+",")}fa&&this.Zx("Recommended")&&this.ZCc&&(ha=this.cnj(),0<ha.length&&(ka+=ha+","));!fa&&this.Zx("Help")&&(fa=this.ub.BAh,0<fa.length&&(ka+=fa+","));0<ka.length&&(ka=ka.substr(0,ka.length-1));return ka}vC(fa,ka,ha,F=e.a.tellMe,na=null){const ba=new A.a(fa);ha=E.a.MI(fa);if(this.$Vb&&(!this.t3a||window.performance.now()-this.t3a>=
E.a.$rd)){var Ea=this.WId.ykj();if(Ea)this.t3a=window.performance.now(),Ea.then(wa=>{this.xWb=wa},wa=>{u.TellMeActor.instance.Hd.onError("TellMeServiceProvider:issueQuery","tellMeServiceToken promise rejected: "+wa)});else if(u.TellMeActor.instance.Hd)u.TellMeActor.instance.Hd.onError("TellMeServiceProvider:IssueQuery","undefined token promise")}var La=this.$Vb&&!!this.xWb;Ea=La||ha&&this.Zx("Recommended")&&this.ZCc;La=La||!ha&&(this.smf&&this.Zx("Command")||this.BJd&&this.Zx("Answer")||this.CJd&&
this.Zx("Definition")||this.umf&&this.Zx("Image")||this.aDc&&this.Zx("Help")||this.EJd&&this.Zx("WolframAnswer")||this.DJd&&this.Zx("Template")||this.rmf&&this.Zx("Addin"));if(Ea||La)if(this.f5a=F,F={"Content-Type":"application/json",Accept:"application/json"},F["X-Office-Version"]=O.AFrameworkApplication.buildVersion,F["X-Office-Application"]=O.AFrameworkApplication.fa.Ha("Application"),F["X-Office-Platform"]="WAC",F["X-TellMe-SqmUserId"]=O.AFrameworkApplication.fa.Ha("LoggableUserId")||"",F["X-TellMe-SessionId"]=
u.TellMeActor.instance.ITc(),this.xWb&&(F.Authorization="Bearer "+this.xWb),Ea=this.ukj(ha),0<Ea.length&&(F["X-TellMe-Flights"]=Ea),Ea=[],!ha&&this.Zx("Answer")&&this.BJd&&(na?Array.contains(na,9):1)&&Array.add(Ea,"Answer"),!ha&&this.Zx("Command")&&this.smf&&!J.CommandResultsUtility.the(fa.Ff)&&(na?Array.contains(na,17):1)&&Array.add(Ea,"Command"),!ha&&this.Zx("Definition")&&this.CJd&&(na?Array.contains(na,10):1)&&Array.add(Ea,"Definition"),!ha&&this.Zx("Help")&&this.aDc&&(na?Array.contains(na,8):
1)&&Array.add(Ea,"Help"),!ha&&this.Zx("WolframAnswer")&&this.EJd&&(na?Array.contains(na,12):1)&&Array.add(Ea,"WolframAnswer"),ha&&this.Zx("Recommended")&&this.ZCc&&!u.TellMeActor.instance.Stc&&(na?Array.contains(na,18):1)&&Array.add(Ea,"Recommended"),!ha&&this.Zx("Image")&&this.umf&&(na?Array.contains(na,19):1)&&Array.add(Ea,"Image"),this.xWb&&this.$Vb&&(na?Array.contains(na,14)||Array.contains(na,15)||Array.contains(na,20):1)&&(this.pWb.H5(),this.WCc&&this.Zx("File")&&Array.add(Ea,"File"),this.YCc&&
this.Zx("People")&&Array.add(Ea,"People"),this.XCc&&this.Zx("Notes")&&Array.add(Ea,"Notes")),!ha&&this.Zx("Template")&&this.DJd&&(na?Array.contains(na,23):1)&&Array.add(Ea,"Template"),!ha&&this.Zx("Addin")&&this.rmf&&(na?Array.contains(na,25):1)&&Array.add(Ea,"Addin"),Ea.length){F["X-TellMe-SuggestionTypes"]=Ea.join(",");F["X-TellMe-Culture"]=O.AFrameworkApplication.uiCulture;F["X-TellMe-ProcessSessionId"]=O.AFrameworkApplication.userSessionId;var ta=this.bI=S.a.create().toString();F["Client-Request-Id"]=
ta;var oa=window.performance.now();this.Mia();this.ZR=window.setTimeout(()=>{if(ta===this.bI){this.bI="";this.ZR=-1;ka.resultsUpdated(ba);const wa={};wa[r.a.provider]=this.CF();wa[r.a.xhb]=fa.tZa;u.TellMeActor.instance.Hd.wH(v.a.timedOut,this.sVb,wa)}},this.sVb);this.ei.Aj(this.Gza,2,this.wkj(fa.Ff),F,!1,0,wa=>{this.Agb(wa,fa,ka,ta,oa,na)},wa=>{this.ogb(wa,fa,ka,ta,oa)},null,null,!1,4E3,6E3)}else u.TellMeActor.instance.Hd.onError("IssueQuery","Empty Online Provider List: No online calls by provider"),
ka.resultsUpdated(ba);else ka.resultsUpdated(ba)}Mia(){-1!==this.ZR&&(window.clearTimeout(this.ZR),this.ZR=-1)}Agb(fa,ka,ha,F,na,ba){const Ea=new A.a(ka);if(F===this.bI){this.Mia();u.TellMeActor.instance.Hd.q5(ka.Ff.length,this.$Ma.join(","),fa.data.Te.toString(),Math.round(window.performance.now()-na),W.a.tellMe,!0,C.a.Fta);F=fa.data.Zd;fa=null;try{fa=Y.b(F)}catch(ya){u.TellMeActor.instance.Hd.onError("OnSuccessCallBack","Exception occured while deserializing response:"+ya);return}F=E.a.MI(ka);if("Groups"in
fa&&fa.Groups){var La=fa.Groups;for(var ta of La)if("GroupType"in ta&&"Suggestions"in ta&&ta.Suggestions)if("Commands"===ta.GroupType&&(ba?Array.contains(ba,17):1)||"Recommended"===ta.GroupType&&(ba?Array.contains(ba,18):1)){var oa=(La="Recommended"===ta.GroupType)?"DLIS":"NaiveBayes";"Source"in ta&&ta.Source&&(oa=ta.Source);var wa=ta.Suggestions;new k.a;var ra=[];for(const ya of wa)this.gVj(ya)&&(wa=ya.Type,("Command"===wa||La&&"Recommended"===wa)&&ra.push(new T.a(ya.CommandId,ya.Score)));J.CommandResultsUtility.b1c(ra,
!ka.Ff.trim().length,ta.GroupType,oa);oa=u.TellMeActor.instance.kS;wa=[];for(const ya of ra)La&&oa&&oa.jVd(ya.commandId)||wa.push(ya);ra=J.CommandResultsUtility.$Sc(ka,wa,this.ub,null,null,null,La?18:17,0);0<ra.results.length&&(this.f5a!==e.a.contextMenu&&(ra.displayName=La?CommonUIStrings.l_TellMeTryCommandTitle:CommonUIStrings.l_TellMeCommandProviderTitle),Ea.es(ra))}else if("Answer"===ta.GroupType){wa=ta.Suggestions;La=null;ra=2147483647;oa="";for(const ya of wa)if(this.dVj(ya))if(oa=ya.Type,wa=
this.Ewb(oa),"Answer"===oa&&this.BJd){La=this.MIf(oa,ya,ka.Ff);break}else wa&&wa<ra&&(ra=wa,La=this.MIf(oa,ya,ka.Ff));ra=E.a.eZk(ka.Ff,oa);La&&(ba?Array.contains(ba,La.type):1)&&(oa=[],this.VCc?this.ub.bda?(u.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(La.value,La.CJ)),u.TellMeActor.instance.actions.push(appChrome.actions.updateCompoundButtonDescription(La.value,La.description)),u.TellMeActor.instance.actions.push(appChrome.actions.setCompoundButtonCommandValueId(La.value,
ra))):(oa.push(appChrome.actions.setControlLabel(La.value,La.CJ)),oa.push(appChrome.actions.updateCompoundButtonDescription(La.value,La.description)),oa.push(appChrome.actions.setCompoundButtonCommandValueId(La.value,ra)),appChrome.api.dispatch(oa)):this.ub.bda?(u.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(La.value,La.CJ+" - "+La.description)),u.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId(La.value,ra))):(oa.push(appChrome.actions.setControlLabel(La.value,
La.CJ+" - "+La.description)),oa.push(appChrome.actions.setButtonCommandValueId(La.value,ra)),appChrome.api.dispatch(oa)),ra=this.JFi(La.type),ra.fv(La),Ea.es(ra))}else"Help"===ta.GroupType&&ta.Suggestions.length&&(ba?Array.contains(ba,8):1)?this.aDc&&(La=this.Y5e.gTa(ka,ta.Suggestions))&&0<La.results.length&&Ea.es(La):"Template"===ta.GroupType&&(ba?Array.contains(ba,23):1)?(La=ta.Suggestions)&&0<La.length&&this.Y0h.gTa(ka,Ea,La):"Addin"===ta.GroupType&&(ba?Array.contains(ba,25):1)?(La=ta.Suggestions)&&
0<La.length&&this.bMh.gTa(ka,Ea,La):"Substrate"===ta.GroupType&&this.$Vb&&"Type"in ta&&("File"===ta.Type&&this.WCc&&(ba?Array.contains(ba,15):1)?(La=this.pWb.t_f(ta.Suggestions,F,this.f5a))&&0<La.results.length&&Ea.es(La):"People"===ta.Type&&this.YCc&&(ba?Array.contains(ba,14):1)?(La=this.pWb.G2f(ta.Suggestions,F,this.f5a))&&0<La.results.length&&Ea.es(La):"Notes"===ta.Type&&this.XCc&&(ba?Array.contains(ba,14):1)&&(La=this.pWb.$1f(ta.Suggestions,F,ka))&&0<La.results.length&&Ea.es(La));else u.TellMeActor.instance.Hd.onError("OnSuccessCallBack",
"GroupType"in ta?"Invalid group suggestions found for "+ta.GroupType:"Invalid group found")}if(fa.Intents){ta=fa.Intents;for(const ya of ta)this.ele(ya)&&("Image"===ya.GroupType&&ya.ConfidenceScore>ya.ConfidenceThreshold&&(ba?Array.contains(ba,19):1)?this.fSh.gTa(ka,Ea,0,ya):"Commands"===ya.GroupType&&ya.ConfidenceScore<ya.ConfidenceThreshold&&(ba?Array.contains(ba,17):1)&&(ta=new z.a(17),Ea.es(ta)))}ha.resultsUpdated(Ea);u.TellMeActor.instance.Hd.q5(ka.Ff.length,this.$Ma.join(","),"",Math.round(window.performance.now()-
na),"",!0,C.a.provider)}}ogb(fa,ka,ha,F,na){const ba=new A.a(ka);F===this.bI&&(this.Mia(),u.TellMeActor.instance.Hd.q5(ka.Ff.length,this.$Ma.join(","),fa.data.Te.toString(),Math.round(window.performance.now()-na),W.a.tellMe,!1,C.a.Fta));ha.resultsUpdated(ba)}Ewb(fa){switch(fa){case "Entity":return this.x_h?3:0;case "Definition":return this.CJd?5:0;case "WolframAnswer":return this.EJd?2:0;default:return 0}}MIf(fa,ka,ha){switch(fa){case "Answer":return new w.a(this.VCc?"AnswerForSearch":"AnswerForSearchSingleLine",
0,""===ka.Title?ha:ka.Title,ka.Description,0);case "Entity":return new w.a(this.VCc?"AnswerForSearch":"AnswerForSearchSingleLine",2,""===ka.Title?ha:ka.Title,ka.Description,0);case "Definition":return new w.a(this.VCc?"AnswerForSearch":"AnswerForSearchSingleLine",1,""===ka.Title?ha:ka.Title,ka.Description,0);case "WolframAnswer":return new w.a("WolframForSearch",3,""===ka.Title?ha:ka.Title,ka.Description,0);default:return null}}JFi(fa){switch(fa){case 0:return new z.a(9,CommonUIStrings.l_TellMeAnswersTitle);
case 2:return new z.a(11,CommonUIStrings.l_TellMeEntityTitle);case 1:return new z.a(10,CommonUIStrings.l_TellMeDefinitionTitle);case 3:return new z.a(12,CommonUIStrings.l_TellMeAnswersTitle);case 12:return new z.a(19,this.ub.SLb?CommonUIStrings.l_TellMeImageTitleV2:CommonUIStrings.l_TellMeImageTitle);default:return null}}dVj(fa){return"Type"in fa&&!!fa.Type&&""!==fa.Type&&"Description"in fa&&!!fa.Description&&""!==fa.Description}gVj(fa){return"Type"in fa&&!!fa.Type&&""!==fa.Type&&"CommandId"in fa&&
!!fa.CommandId&&""!==fa.CommandId&&"Score"in fa&&!!fa.Score}ele(fa){if("GroupType"in fa&&fa.GroupType&&"ConfidenceScore"in fa&&"ConfidenceThreshold"in fa)return!0;u.TellMeActor.instance.Hd.onError("IsValidIntentGroup","Invalid intents found");return!1}wkj(fa){const ka=E.a.mkg(fa),ha={};ha.Query=fa;ka&&this.ZCc&&(this.GOj()?ha.UserActionEvents=u.TellMeActor.instance.xof:(ha.CommandClickedEvents=u.TellMeActor.instance.Hxd,ha.CommandActionEvents=u.TellMeActor.instance.D7e),ha.TellMeCommandClickMruEvents=
u.TellMeActor.instance.Sgf,ha.ContentType=u.TellMeActor.instance.yLc);this.DJd&&(fa={},fa.Application=this.ub.application,ha.TemplateInfo=fa);return Y.c(ha)}Pjb(){return!!this.ub&&this.ub.Pjb||!!O.AFrameworkApplication.Aa&&O.AFrameworkApplication.Aa.hb.Pjb}Qjb(){return!!this.ub&&this.ub.Qjb||!!O.AFrameworkApplication.Aa&&O.AFrameworkApplication.Aa.hb.Qjb}Rjb(){return!!this.ub&&this.ub.Rjb||!!O.AFrameworkApplication.Aa&&O.AFrameworkApplication.Aa.hb.Rjb}XLb(){return!!this.ub&&this.ub.XLb||!!O.AFrameworkApplication.Aa&&
O.AFrameworkApplication.Aa.hb.XLb}WLb(){return!!this.ub&&(this.ub.WLb||this.ub.HH)}Kdl(){return!!this.ub&&!this.ub.NUa}Ydl(){return!!this.ub&&this.ub.t$b}Jdl(){return!!this.ub&&this.ub.$Gj&&this.ub.XGj}Mkg(){return!!O.AFrameworkApplication.fa&&O.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceEdogEndpointOverride",!1)}Nkg(){return!!O.AFrameworkApplication.fa&&O.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceProdEndpointOverride",
!1)}GOj(){return!!O.AFrameworkApplication.fa&&O.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.NewZeroSearchTermModel",!1)}cnj(){return O.AFrameworkApplication.fa?O.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.TellMeZeroTermModelName",""):""}xkj(){if(!O.AFrameworkApplication.fa)return"";if(this.Nkg())return O.AFrameworkApplication.fa.Ha("TellMeServiceProdEndpointForSearch");if(this.Mkg())return O.AFrameworkApplication.fa.Ha("TellMeServiceEdogEndpointForSearch");
if(E.a.Mhe())return O.AFrameworkApplication.fa.Ha("TellMeServiceIntEndpointForSearch");let fa=O.AFrameworkApplication.fa.Ha("TellMeServiceSearchEndpoint");fa&&""!==fa||(fa=O.AFrameworkApplication.AAh);return fa}static iJf(fa,ka){if(ka)return new da(fa,["Command","Recommended"],fa.j8i);ka=E.a.R3()?"Answer Definition Help WolframAnswer Image File People Notes Template Addin".split(" "):"Help WolframAnswer File People Notes Template Addin".split(" ");return new da(fa,ka,fa.E4f)}}Object(K.a)(da,"TellMeServiceProvider",
null,[962])},1118:function(K,Z,d){d.r(Z);d.d(Z,"SurfaceStringTokenStringGenerator",function(){return e});K=d(0);var k=d(539);class e extends k.a{constructor(n){super(n);this.Ia=n}apply(n,r,v,C,w,z,A){null==z&&(z=n.Y5f(w,r));A=k.a.Krf(n,z,this.Ia.score,v,C,A);return{Osc:z,nZb:A}}}e.oZb=0;Object(K.a)(e,"SurfaceStringTokenStringGenerator",k.a,[])},1119:function(K,Z,d){d.r(Z);d.d(Z,"QueryTokenStringGenerator",function(){return n});K=d(0);var k=d(539),e=d(77);class n extends k.a{constructor(r){super(r);
this.Ia=r}apply(r,v,C,w,z,A,u){v=this.Ia.query.load(v,null);z=0;let E=null;this.Ia.query.MU===e.Annotations.sga?v&&(E=this.Ia.name):((E=this.Ia.name)&&(E+="_"),E+=this.Ia.annotations.L1(this.Ia.query.MU,v));null!=E&&(z=k.a.Krf(r,E,this.Ia.score,C,w,z));return{Osc:A,nZb:u+z}}}n.oZb=1;Object(K.a)(n,"QueryTokenStringGenerator",k.a,[])},1120:function(K,Z,d){d.r(Z);d.d(Z,"FuzzyMatchTokenStringGenerator",function(){return e});K=d(0);var k=d(539);class e extends k.a{constructor(n){super(n);this.Ia=n}apply(n,
r,v,C,w,z,A){null==z&&(z=n.Y5f(w,r));n=this.Ia.RQf.e3j(z);if(this.Ia.b7g)for(var u of n)if(!u.NG&&u.nPc)return{Osc:z,nZb:A};u=0;for(const E of n)if(E.NG&&!({ORd:u}=this.Nvf(E,!0,v,C,u)).returnValue)return{Osc:z,nZb:A};if(this.Ia.wbg)for(const E of n)if(!({ORd:u}=this.Nvf(E,!1,v,C,u)).returnValue)break;return{Osc:z,nZb:A}}Nvf(n,r,v,C,w){let z;r?(r=0,z=n.nPc?1:0):(r=n.nPc?1:0,z=n.count-r);for(let A=0;A<z;++A)if(k.a.Lrf(n.TRa+r+A,this.Ia.score,v,C),++w,0<this.Ia.kCe&&w>=this.Ia.kCe)return{returnValue:!1,
ORd:w};return{returnValue:!0,ORd:w}}}e.oZb=2;Object(K.a)(e,"FuzzyMatchTokenStringGenerator",k.a,[])},1128:function(K,Z,d){d.r(Z);K=d(0);var k=d(303),e=d(17),n=d(15),r=d(1186),v=d(169);class C{constructor(T,D,R,Q=0){this.C7f=T;this.groupType=D;this.y$d=Q;this.koc=R}}Object(K.a)(C,"SortingGroup",null,[]);class w{constructor(T,D,R,Q){this.order=T;this.b$a=D;this.yoj=R;this.groupType=Q}}Object(K.a)(w,"SortingProp",null,[]);var z=d(115),A=d(142),u=d(101),E=d(123);class H{constructor(T,D){this.cRg={};this.bRg=
{};this.YPg=this.$Wg=1;this.Jyf(T,D)}wjl(T,D,R){var Q=u.a.MI(R)?this.cRg:this.bRg;R=new e.a;for(var W of D)D=Object(r.a)(w,Q[k.a[W.groupType].toLowerCase()]),E.b(D)||R.add(new n.a(D,W));R.Sc((Y,S)=>Y.key.order<S.key.order?-1:1);Array.clear(T);W=z.TellMeActor.instance.LP;for(D=0;D<R.count;){Q=R.ga(D).key.b$a;var O=R.ga(D).value;const Y=new v.a(R.ga(D).key.groupType);E.b(W)||W.Location===A.a.contextMenu||(Y.displayName=R.ga(D).key.yoj);for(const S of O.results)Y.fv(S);for(O=++D;O<R.count&&R.ga(O).key.b$a===
Q;)this.xNd(Y,R.ga(O).value),O=++D;T.push(Y)}}xAl(T,D){this.YPg=this.$Wg=1;this.Jyf(T,D)}Jyf(T,D){this.Mwh(T);for(var R=0;R<T.length;R++){let Q=T[R];for(const W of Q.koc)this.$4h(W,R,Q.C7f,Q.groupType)}this.Mwh(D);for(T=0;T<D.length;T++){R=D[T];for(const Q of R.koc)this.Z4h(Q,T,R.C7f,R.groupType)}}Mwh(T){T.sort((D,R)=>Object(r.a)(C,D).y$d>Object(r.a)(C,R).y$d?-1:1)}$4h(T,D,R,Q){this.cRg[k.a[T].toLowerCase()]=new w(this.$Wg++,D,R,Q)}Z4h(T,D,R,Q){this.bRg[k.a[T].toLowerCase()]=new w(this.YPg++,D,R,
Q)}xNd(T,D){for(let R=0;R<D.results.length;R++)T.fv(D.results[R])}}Object(K.a)(H,"BaseGroupingSorter",null,[]);class I{constructor(){this.Zad=[new C("",24,[24]),new C(CommonUIStrings.l_TellMeRecentlyUsedTitleV2,4,[4,2]),new C(CommonUIStrings.l_TellMeCommandProviderTitle,7,[18,16,7]),new C(CommonUIStrings.l_TellMeSuggestionsProviderTitle,31,[15,14,19,3]),new C("",13,[13]),new C("",22,[22])];this.W8c=[new C(CommonUIStrings.l_TellMeCommandProviderTitle,29,[17,0,1,8,26]),new C(CommonUIStrings.l_TellMeSuggestedSearchesProviderTitle,
30,[2,19,23,27]),new C(CommonUIStrings.l_TellMePotentialMatchesProviderTitle,31,[15,14,20,9,12,10,11,25]),new C("",13,[13,24]),new C("",22,[22])];this.sxg=new H(this.Zad,this.W8c)}Xqc(T,D,R,Q=null,W=null){let O=!1;if(Q){for(const Y of u.a.MI(R)?this.Zad:this.W8c)this.kLk(Y,Q);O=!0}if(W){for(const Y of u.a.MI(R)?this.Zad:this.W8c)this.yAl(D,Y,W);O=!0}O&&this.sxg.xAl(this.Zad,this.W8c);this.sxg.wjl(T,D,R)}kLk(T,D){const R=new e.a;for(var Q of T.koc){const W=D[k.a[Q].toLowerCase()];R.add(new n.a(E.b(W)?
Number.MAX_VALUE:W,Q))}if(R.count){R.Sc((W,O)=>W.key<O.key?-1:1);D=Array(R.count);for(Q=0;Q<R.count;Q++)D[Q]=R.ga(Q).value;T.koc=D}}yAl(T,D,R){let Q=0;for(const W of D.koc)if(k.a[W].toLowerCase()in R&&R[k.a[W].toLowerCase()])for(const O of T)if(O.groupType===W){Q+=R[k.a[W].toLowerCase()];break}D.y$d=Q}}Object(K.a)(I,"SimplifiedGroupingSorter",null,[]);d.d(Z,"GroupsPlacementInfo",function(){return J});class J{constructor(T){this.aRg={};this.ZQg={};this.$Qg={};this.dRg={};this.qze={};this.DRg=this.Cdk=
this.Ubk=this.qck=1;this.WSg=null;this.Eu=T;this.mki();this.fBk();this.iki();this.qji();T.HH&&(this.WSg=new I)}EA(T){this.aRg[k.a[T].toLowerCase()]=this.qck++}ED(T,D){this.ZQg[k.a[T].toLowerCase()]=D}$qa(T){this.$Qg[k.a[T].toLowerCase()]=this.Ubk++}xS(T){this.dRg[k.a[T].toLowerCase()]=this.Cdk++}Qx(T){this.qze[k.a[T].toLowerCase()]=this.DRg++}mki(){const T=!!this.Eu&&this.Eu.NUa,D=!!this.Eu&&this.Eu.$jc,R=!!this.Eu&&this.Eu.OUa,Q=!!this.Eu&&this.Eu.Uke&&!u.a.Rab(),W=!!this.Eu&&this.Eu.t$b,O=!!this.Eu&&
this.Eu.vXc,Y=!!this.Eu&&this.Eu.lje;this.Eu&&this.Eu.tXc&&this.EA(24);this.EA(4);this.EA(18);this.EA(16);this.EA(7);this.EA(17);this.EA(0);this.EA(1);Y&&this.EA(26);W&&this.EA(23);T||this.EA(2);T&&!D||this.EA(8);this.EA(15);R&&this.EA(20);this.EA(14);this.EA(9);this.EA(12);this.EA(10);this.EA(11);T&&this.EA(2);T&&!D&&this.EA(8);this.EA(19);O&&this.EA(25);this.EA(21);this.EA(13);Q&&this.EA(22)}fBk(){this.ED(21,1);this.ED(4,3);this.ED(18,3);this.ED(16,3);this.ED(7,3);this.ED(17,5);this.ED(0,5);this.ED(1,
1);this.ED(26,2);this.ED(2,1);this.ED(8,2);this.ED(15,3);this.ED(14,2);this.ED(25,3);this.ED(9,1);this.ED(12,1);this.ED(10,1);this.ED(11,1);this.ED(19,1);this.ED(23,1);this.ED(13,1);this.ED(24,1);this.ED(20,2);this.ED(22,1)}iki(){this.$qa(4);this.$qa(0);this.$qa(17);this.$qa(7);this.$qa(16);this.$qa(18);this.$qa(15);this.$qa(20);this.$qa(8);this.$qa(14)}qji(){this.xS(14);this.xS(10);this.xS(12);this.xS(9);this.xS(11);this.xS(20);this.xS(15);this.xS(8);this.xS(2);this.xS(1);this.xS(25);this.xS(7);
this.xS(18);this.xS(16);this.xS(17);this.xS(0);this.xS(4)}VXk(){this.qze={};this.DRg=1}qgj(T,D,R){this.VXk();const Q=!!this.Eu&&this.Eu.NUa,W=!!this.Eu&&this.Eu.$jc,O=!!this.Eu&&this.Eu.OUa,Y=!!this.Eu&&this.Eu.Uke&&!u.a.Rab(),S=!!this.Eu&&this.Eu.t$b,da=!!this.Eu&&this.Eu.vXc,fa=!!this.Eu&&this.Eu.lje,ka=!!this.Eu&&this.Eu.tXc;T=T&&W;this.Qx(4);this.Qx(18);this.Qx(16);this.Qx(7);this.Qx(17);this.Qx(0);this.Qx(1);fa&&this.Qx(26);S&&this.Qx(23);Q&&!W||!T||this.Qx(8);D&&this.Qx(15);Q||this.Qx(2);da&&
this.Qx(25);R&&this.Qx(14);Q&&!W||T||this.Qx(8);D||this.Qx(15);O&&this.Qx(20);R||this.Qx(14);this.Qx(9);this.Qx(12);this.Qx(10);this.Qx(11);Q&&this.Qx(2);Q&&!W&&this.Qx(8);this.Qx(19);this.Qx(21);this.Qx(13);ka&&this.Qx(24);Y&&this.Qx(22);return this.qze}SG(){return this.Eu}}Object(K.a)(J,"GroupsPlacementInfo",null,[])},1131:function(K,Z,d){d.r(Z);K=d(0);var k=d(705),e=d(447),n=d(303),r=d(1031),v=d(446);class C{constructor(J="",T="",D="",R=-99999,Q=-1,W=0){this.Type=this.Description=this.Title=null;
this.Count=this.Age=this.Score=0;this.Title=J?J:"";this.Description=T?T:"";this.Type=D?D:"";this.Score=R;this.Age=Q;this.Count=W}}Object(K.a)(C,"Suggestion",null,[]);class w{constructor(J,T){this.GroupType=this.Suggestions=null;this.Suggestions=J;this.GroupType=T}}Object(K.a)(w,"SuggestionGroup",null,[]);class z{}z.help="help";z.answer="answer";z.commands="commands";z.N3k="servicecommands";z.DAh="template";Object(K.a)(z,"SuggestionGroupType",null,[]);var A=d(115),u=d(101),E=d(25),H=d(33);d.d(Z,"InteractionLogger",
function(){return I});class I{constructor(J,T,D){this.dzd=0;this.OKd=this.ATb=null;this.zj=J;this.PJd=this.Vxd=this.ABd=!1;this.FOh=T;this.ei=E.AFrameworkApplication.Je;this.ub=D;this.Awc=this.DGd=0}get Gna(){return this.zj.Gna}Tnd(J){this.zj.Tnd(J)}Aog(){if(this.ATb){var J=0;for(const T of this.ATb)this.zj.b2j(T,J++);this.ATb=null}}beginQuery(J,T,D){this.zj.R1j(J,T,D)}E3g(J,T){this.zj.Kgi(J,T);this.ABd=!0;this.PJd=!1}D3g(){this.ABd=!1;this.Vxd||(this.Aog(),this.zj.APf(this.dzd))}T1j(J,T){this.zj.U1j(J,
T)}dnk(J,T,D,R,Q){for(const W of this.FOh)if(J.startsWith(W)){this.PJd=!0;break}this.zj.W_j(J,T,D,R,Q)}pnk(J){this.Vxd=!1;this.dzd=J;this.ABd||this.PJd||(this.Aog(),this.zj.APf(this.dzd,!1))}onk(J,T){this.zj.$_j(J,T);this.Vxd=!0}E3d(J,T){if(!J.count)return"";let D="";const R=Date.now();for(let Q of J)J=(R-Q.timeStamp)/1E3,J=u.a.rsd(J),0<D.length&&(D+=";"),D+=T?Q.commandId:Q.controlId,D+=":",D+=J.toString();return D}pjc(){var J=this.E3d(k.a.instance.xQb,!1);0<J.length&&this.zj.U_j(J);J=this.E3d(k.a.instance.Z1a,
!0);0<J.length&&this.zj.t_j(J);J=this.E3d(k.a.instance.Bxc,!0);0<J.length&&this.zj.D0j(J);J=A.TellMeActor.instance.Tgf;0<J.length&&this.zj.Q1j(H.c(J))}m2j(J){this.zj.I_j(J)}q5(J,T,D,R,Q,W,O,Y=null){this.zj.m1j(J,T,D,R,Q,W,O,Y)}cne(J,T,D,R){this.zj.cne(J,T,D,R)}wH(J,T,D=null){this.zj.NFa(J,T,D)}onError(J,T,D=null){this.zj.zac(J,T,D)}d7k(J){this.ATb=J}Mjj(J){const T=[];if(!J)return T;for(let D=0;D<J.length;D++){const R=n.a[J[D].groupType].toLowerCase(),Q=[],W=J[D].results;if(W){for(let O=0;O<W.length;O++)"findindocument"===
R?Array.add(Q,new C("","",R,W[O].score,W[O].lGc,W[O].count)):Array.add(Q,new C(W[O].label,W[O].description,R,W[O].score,W[O].lGc,W[O].count));"answer"===R||"definition"===R||"wolframanswer"===R||"entity"===R?Array.add(T,new w(Q,z.answer)):"classifier"===R||"appsforoffice"===R?Array.add(T,new w(Q,z.commands)):"serviceclassifier"===R?Array.add(T,new w(Q,z.N3k)):"assistance"===R?Array.add(T,new w(Q,z.help)):("document"===R||"people"===R||"findindocument"===R||"notes"===R||"image"===R||"template"===R)&&
Array.add(T,new w(Q,R))}}return T}f9d(J,T){const D={};D.Query=T;D.SuggestionGroups=H.c(this.Mjj(J));return H.c(D)}B5f(J){const T={"Content-Type":"application/json",Accept:"application/json"};T["X-Office-Version"]=E.AFrameworkApplication.buildVersion;T["X-Office-Application"]=E.AFrameworkApplication.fa.Ha("Application");T["X-Office-Platform"]="WAC";T["X-TellMe-SqmUserId"]=E.AFrameworkApplication.fa.Ha("LoggableUserId")||"";T["X-TellMe-SessionId"]=this.zj.Gna.K8;T["X-TellMe-SuggestionTypes"]="Ranker";
T["X-TellMe-Culture"]=E.AFrameworkApplication.uiCulture;T["X-TellMe-ProcessSessionId"]=E.AFrameworkApplication.userSessionId;T["X-TellMe-Flights"]=J;T["X-TellMe-PartialQueryIndex"]=this.DGd;return T}Agb(J,T,D){this.q5(T.length,"RankerLogging",J.data.Te.toString(),Math.round(window.performance.now()-D),v.a.zAh,!0,e.a.Fta)}ogb(J,T,D){this.q5(T.length,"RankerLogging",J.data.Te.toString(),Math.round(window.performance.now()-D),v.a.zAh,!1,e.a.Fta)}C5f(){this.OKd||(this.OKd=new r.a(this.ub,null,6E3));return this.OKd.Gza}fne(J){const T=
this.f9d(this.ATb,J),D=this.B5f("RankerLogging"),R=window.performance.now();this.ei.Aj(this.C5f(),2,T,D,!1,0,Q=>{this.Agb(Q,J,R)},Q=>{this.ogb(Q,J,R)},null,null,!1,4E3,6E3);this.DGd++}NXk(){this.DGd=0}kTe(J){this.Awc=J}}Object(K.a)(I,"InteractionLogger",null,[])},115:function(K,Z,d){d.r(Z);K=d(0);var k=d(13),e=d(22),n=d(1186),r=d(705),v=d(263);class C{constructor(cb,Xa,Lb,pc,fc,bd){this.groupType=cb;this.resultType=Xa;this.VYe=Lb;this.b$a=pc;this.BZd=fc;this.resultIndex=bd}}Object(K.a)(C,"ClickLoggingInfo",
null,[]);const w=cb=>{const Xa=[];for(;cb;)Array.add(Xa,"{ContextId:"+cb.contextId+", IsGraphNodeContext:"+cb.el+"}"),cb=cb.xE;Xa.reverse();return"{"+Xa.join(", ")+"}"};class z{constructor(){this.K8=this.sessionId=null}}Object(K.a)(z,"CorrelationRecord",null,[967]);var A=d(261);class u{constructor(cb,Xa){this.Id=null;this.TimeStamp=0;this.Id=cb;this.TimeStamp=Xa}}Object(K.a)(u,"MRUControl",null,[]);var E;(function(cb){cb[cb.Answer=0]="Answer";cb[cb.Definition=1]="Definition";cb[cb.Entity=2]="Entity";
cb[cb.WolframAnswer=3]="WolframAnswer";cb[cb.Assistance=4]="Assistance";cb[cb.Command=5]="Command";cb[cb.Document=6]="Document";cb[cb.TryQuery=7]="TryQuery";cb[cb.FindInDocument=8]="FindInDocument";cb[cb.HelpAction=9]="HelpAction";cb[cb.Insights=10]="Insights";cb[cb.People=11]="People";cb[cb.Image=12]="Image";cb[cb.FirstRunResult=13]="FirstRunResult";cb[cb.NoCommandsFoundResult=14]="NoCommandsFoundResult";cb[cb.TestResult=15]="TestResult";cb[cb.AppsForOffice_Installed=16]="AppsForOffice_Installed";
cb[cb.AppsForOffice_Recommandation=17]="AppsForOffice_Recommandation";cb[cb.AppsForOffice_Query=18]="AppsForOffice_Query";cb[cb.Notes_Onenote=19]="Notes_Onenote";cb[cb.Notes_Samsung=20]="Notes_Samsung";cb[cb.Notes_Sticky=21]="Notes_Sticky";cb[cb.Learning=22]="Learning";cb[cb.Feedback=23]="Feedback";cb[cb.Template=24]="Template";cb[cb.ActionAI=25]="ActionAI";cb[cb.Addin=26]="Addin";cb[cb.OfficeScript=27]="OfficeScript";cb[cb.AddinStoreEntry=28]="AddinStoreEntry";cb[cb.Unknown=29]="Unknown"})(E||(E=
{}));Object(K.b)("ResultType",E);var H=d(687),I=d(101),J=d(25),T=d(368);class D{constructor(cb,Xa){this.vVh=10;this.JV=[];this.xha=[];this.kdf=this.jdf=!1;this.fUb=this.eUb="";this.dAc=Xa;this.ub=cb;this.Sdf=cb.Lo}F4b(){!this.jdf&&this.Sdf&&this.ub&&H.a.Ihg()&&(this.eUb="58F514FD-AA7A-4A06-BF46-85FF3444BEA4-"+this.ub.application,this.JV=this.$Xf(),this.jdf=!0);return this.JV}Tej(){!this.kdf&&this.Sdf&&this.ub&&H.a.Ihg()&&(this.fUb="21E7F47B-086F-41D1-9E5D-8A9FD31A7C4B-"+this.ub.application,this.xha=
this.$Xf(!0),this.kdf=!0);return this.xha}hUj(cb){return cb.startsWith("TellMeUpsell")||"OpenInClientUpsell"===cb||"TryOfficeUpsell"===cb}Che(cb){return this.yHj(cb)||this.hUj(cb)||I.a.Jkg(cb)?!1:!0}r4h(cb){cb=cb.ControlId;this.Che(cb)&&(cb=this.ZOe(cb),this.qSk(cb),this.Tek(),Array.insert(this.JV,0,new u(cb,Date.now())),this.eUb.length&&(cb=JSON.stringify(this.JV),T.a.instance.setItem(this.eUb,cb)))}FA(cb){this.Sek();Array.insert(this.xha,0,new u(E[cb],Date.now()));this.fUb.length&&(cb=JSON.stringify(this.xha),
T.a.instance.setItem(this.fUb,cb))}$Xf(cb=!1){if(!this.JV.length){var Xa=cb?T.a.instance.getItem(this.fUb):T.a.instance.getItem(this.eUb);if(!Xa||""===Xa)return cb?this.xha:this.JV;let Lb=null;try{Lb=JSON.parse(Xa)}catch(pc){this.Xri(cb),Lb=null}if(!Lb||!Lb.length||10<Lb.length)return cb?this.xha:this.JV;Xa=0;for(const pc of Lb)if(cb||this.ub.F_c(pc.Id)&&this.Che(pc.Id))if(cb?Array.insert(this.xha,Xa++,pc):Array.insert(this.JV,Xa++,pc),Xa===this.dAc)break}return cb?this.xha:this.JV}jVd(cb){cb=this.ZOe(cb);
for(const Xa of this.JV)if(Xa.Id===cb)return!0;return!1}Xri(cb=!1){T.a.instance.setItem(cb?this.fUb:this.eUb,"")}KJj(cb){cb=this.ZOe(cb.ControlId);return this.Che(cb)?this.jVd(cb):!1}qSk(cb){if(0<this.JV.length){let Xa=0;for(const Lb of this.JV){if(Lb.Id===cb){Array.removeAt(this.JV,Xa);break}Xa++}}}ZOe(cb){return"Excel"===this.ub.application&&cb.startsWith("m_excelWebRenderer_ewaCtl_")?cb.substr(26,cb.length):cb}Tek(){this.JV.length===this.dAc&&Array.removeAt(this.JV,this.JV.length-1)}Sek(){this.xha.length===
this.vVh&&Array.removeAt(this.xha,this.xha.length-1)}yHj(cb){cb=cb.split("|");let Xa="";if(6<=cb.length)Xa=cb[0];else if(3<=cb.length){if("3"===cb[0])return!0;Xa=cb[1]}return Xa.startsWith("WA")}static createInstance(cb){let Xa=3;J.AFrameworkApplication.fa&&(Xa=J.AFrameworkApplication.fa.Fc("TellMeMaxRecommendedResultsToReturn",3));return new D(cb,Xa)}}Object(K.a)(D,"MruControlsManager",null,[966]);class R{constructor(cb){this.$3a=cb}SK(cb,Xa){let Lb;return cb.CJ&&(Lb=this.$3a[cb.value])?Lb.SK(cb,
Xa):(Lb=this.NYf(cb.value))?Lb.SK(Lb.Yhk,Xa):null}Ddj(cb,Xa){if(cb=this.$3a[cb])for(const Lb of Xa)if(Xa=I.a.getParameter(Lb),Xa.key===cb.sxk)return Xa.value;return null}okk(cb){(cb=this.NYf(cb))&&cb.mkk()}NYf(cb){const Xa=cb.indexOf(I.a.N8g);return 0<Xa?this.$3a[cb.substring(0,Xa)]:null}}Object(K.a)(R,"ParameterizedCommandManager",null,[965]);var Q=d(303);class W{constructor(cb,Xa){this.Ff=cb;this.tZa=Xa}}Object(K.a)(W,"TellMeQuery",null,[]);var O=d(688);class Y{constructor(cb,Xa){this.Id=null;this.TimeElapsedSinceClick=
0;this.Id=cb;this.TimeElapsedSinceClick=Xa}}Object(K.a)(Y,"CommandClickedEvent",null,[]);var S=d(123);class da{constructor(cb,Xa){this.CWh=cb;this.Eba=Xa}resultsUpdated(cb){this.CWh(S.b(cb.query)?"":cb.query.Ff,cb.Lk,cb.attributes,this.Eba,cb.hzb)}}Object(K.a)(da,"ResultsUpdatedCallback",null,[964]);class fa{constructor(cb,Xa,Lb,pc,fc){this.CommandId=this.ControlId=null;this.TimeElapsedSinceClick=0;this.TerminalParentControlId=this.CommandSurface=null;this.ControlId=cb;this.TimeElapsedSinceClick=
Lb;this.CommandSurface=pc;this.CommandId=Xa;this.TerminalParentControlId=fc}}Object(K.a)(fa,"UserActionEvent",null,[]);var ka=d(17);class ha{constructor(cb,Xa){this.menuModel=cb;this.resultCount=Xa}}Object(K.a)(ha,"GeneratedMenuModel",null,[]);class F{constructor(){this.ariaLabel=this.sections=this.title=null;this.shouldAutoOpen=!1;this.ariaRoleDescription=null}}Object(K.a)(F,"MenuModel",null,[]);class na{constructor(cb,Xa,Lb){this.ub=cb;this.$3a=Xa;this.k5a=Lb}M0i(cb,Xa,Lb){const {TellMeActor:pc}=
d(115);let fc=0;const bd=new F,od=[];let ye="";bd.sections=[];let pd=new ka.a;const ab=!!this.ub&&this.ub.NUa;var Yb=!!this.ub&&this.ub.RLb||J.AFrameworkApplication.Aa.hb.RLb;for(const Jb of cb){cb=0;ab||(pd=new ka.a);const Oc=new ka.a;let Wb=Jb.displayName;for(const Ab of Jb.results){if(0<=Ab.value.indexOf(I.a.sXe)){if(Ab.CJ){var Sc=this.$3a[Ab.value];if(Sc&&Ab.value.endsWith(I.a.sXe)){if("FindParameterized"!==Ab.value&&!Yb){const Xb=[];Xb.push(appChrome.actions.setControlLabel(Ab.value,Sc.T$i(Ab)));
Xb.push(appChrome.actions.setButtonCommandValueId(Ab.value,Sc.y4i(Ab)));appChrome.api.dispatch(Xb)}Sc=Ab.value.replace(I.a.sXe,"");pd.remove(Sc)?cb--:Oc.add(Sc);pd.add(Ab.value);cb++}}}else switch(Ab.type){case 5:Oc.contains(Ab.value)||(pd.add(Ab.value),cb++);break;case 7:pd.add(Ab.CJ);cb++;break;case 10:case 4:case 8:case 0:case 9:case 1:case 2:case 3:case 11:case 12:case 22:case 23:case 24:case 25:case 6:case 19:case 20:case 21:case 26:case 28:case 27:pd.add(Ab.value),cb++}13===Jb.groupType&&(Wb=
I.a.R3()?0<Xa.length?String.format(CommonUIStrings.l_SeeMoreResultsButtonText,Xa):CommonUIStrings.l_SeeMoreResultsButtonTextNonParameteried:String.format(CommonUIStrings.l_InsightsButtonText,Xa));21===Jb.groupType&&(Wb=CommonUIStrings.l_LearningUILiveText)}fc+=cb;""!==Wb&&0<cb&&(ye+=" , "+cb.toString()+" "+CommonUIStrings.l_TellMeSectionLiveNotification+" "+Wb+" , ");0<pd.count&&!ab&&(cb=appChrome.api.menuSection(pd.toArray(),Jb.displayName,null,Q.a[Jb.groupType]),od.push(cb))}Yb=null;0<fc&&(Yb=0<
Xa.length?1!==fc?String.format(CommonUIStrings.l_SearchLiveNotificationForTermedQueryResults,fc,Xa):String.format(CommonUIStrings.l_SearchLiveNotificationForTermedQueryResult,Xa):1!==fc?String.format(CommonUIStrings.l_LookupLiveNotificationResultPluralFormText,fc):CommonUIStrings.l_LookupLiveNotificationResultSingularFormText,ab?(Xa=appChrome.api.menuSection(pd.toArray(),"",null,null),od.push(Xa)):Yb+=ye);Lb&&(this.ub.bda?pc.instance.actions.push(appChrome.actions.updateTellMeAriaLiveRegionText(Yb)):
appChrome.api.dispatch(appChrome.actions.updateTellMeAriaLiveRegionText(Yb)));bd.sections=od;return new ha(bd,fc,[])}static get C_d(){return na.P9e||(na.P9e=new ha(Object.assign(new F,{sections:[]}),0,[]))}}na.P9e=null;Object(K.a)(na,"TellMeMenuDefintionGenerator",null,[]);var ba;(function(cb){cb[cb.TellMeControlActivated=0]="TellMeControlActivated";cb[cb.TellMeQueryExecuted=1]="TellMeQueryExecuted";cb[cb.TellMeResultsRendered=2]="TellMeResultsRendered";cb[cb.TellMeControlDeactivated=3]="TellMeControlDeactivated"})(ba||
(ba={}));Object(K.b)("PerformanceMarker",ba);var Ea;(function(cb){cb[cb.TellMeTimeToRender=0]="TellMeTimeToRender";cb[cb.TellMeSessionLength=1]="TellMeSessionLength";cb[cb.TellMeResultTriageTime=2]="TellMeResultTriageTime"})(Ea||(Ea={}));Object(K.b)("PerformanceMeasure",Ea);class La{mark(cb){window.performance.mark(ba[cb])}measure(cb,Xa,Lb){const {TellMeActor:pc}=d(115);try{window.performance.measure(Ea[cb],ba[Xa],ba[Lb])}catch(fc){pc.instance.Hd.onError("TellMePerformance:Measure","error measuring "+
Ea[cb])}}Vme(cb,Xa,Lb){const {TellMeActor:pc}=d(115);pc.instance.Hd.cne(Xa,Lb,cb,this.jbj(cb))}gQa(cb){for(const Xa of cb)window.performance.clearMarks(ba[Xa])}clearMeasures(cb){for(const Xa of cb)window.performance.clearMeasures(Ea[Xa])}jbj(cb){let Xa=0;(cb=this.F1i(cb))&&0<cb.length&&(Xa=cb[cb.length-1].duration);return Xa}F1i(cb){return window.performance.getEntriesByName(Ea[cb],"measure")}}Object(K.a)(La,"TellMePerformance",null,[]);var ta=d(447),oa=d(446),wa=d(33);class ra{constructor(cb){this.W0h=
cb}ZGe(cb,Xa,Lb){const {TellMeActor:pc}=d(115);pc.instance.Hd.q5(Xa,oa.a.rIb,cb.data.Te.toString(),Math.round(window.performance.now()-Lb),oa.a.rIb,!0,ta.a.Fta);cb=wa.b(cb.data.Zd);Xa=-1;cb.Index&&(Xa=cb.Index);pc.instance.Hd.T1j(Xa,this.W0h)}jjc(cb,Xa,Lb){const {TellMeActor:pc}=d(115);pc.instance.Hd.q5(Xa,oa.a.rIb,cb.data.Te.toString(),Math.round(window.performance.now()-Lb),oa.a.rIb,!1,ta.a.Fta)}Wej(cb){if(cb&&""!==cb.trim()){const Lb=window.performance.now(),pc=J.AFrameworkApplication.xAh;var Xa=
{};Xa.Text=cb;Xa.IsFileHash="false";Xa=wa.c(Xa);J.AFrameworkApplication.Je.Aj(pc,2,Xa,{"Content-Type":"application/json",Accept:"application/json"},!1,0,fc=>{this.ZGe(fc,cb.length,Lb)},fc=>{this.jjc(fc,cb.length,Lb)},null,null,!1,4E3,6E3)}}}Object(K.a)(ra,"TellMeQueryIndexCallback",null,[]);var ya=d(142);class Da{constructor(cb,Xa,Lb){this.xml=cb;this.resultCount=Xa;this.pMi=Lb}}Object(K.a)(Da,"GeneratedMenuXml",null,[]);var pa=d(961),la=d(45);class Fa{constructor(cb,Xa){this.iwc=cb||{};this.AAa=
Xa}get yib(){return 5}SK(cb,Xa=null){return this.AAa.SK(cb,Xa)||this.Rii(cb.value)}Rii(cb){return Fa.Qii(cb,this.iwc[cb]||null)}static Qii(cb,Xa=null){cb=String.format('<ClonedControl Id="{0}" ',cb);for(let fc in Xa){var Lb=fc,pc=Xa[fc];pc=pc?la.a.pe(pc.toString()):"";cb+=String.format('{0}="{1}" ',Lb,pc)}return cb+"/>"}}Object(K.a)(Fa,"CommandMenuItemFactory",null,[901]);var Qa=d(134);class Sa{constructor(){this.GQh=CommonUIStrings.l_FindInDocumentText}get yib(){return 8}SK(cb){var Xa=cb.CJ;cb=la.a.pe(cb.value);
const Lb=la.a.pe(Xa);Xa=la.a.pe(String.format(this.GQh,Xa));return this.e0i(cb,Lb,Xa)}e0i(cb,Xa,Lb){return Qa.a(cb,"1540292897",Lb,I.a.BWi,null,Xa,Lb,null,null)}}Object(K.a)(Sa,"FindInDocumentMenuItemFactory",null,[901]);var Na=d(962),ua=d(960),za=d(963);class Wa{get yib(){return 7}SK(cb){const Xa=Object(n.a)(O.a,cb);return this.S0i(la.a.pe(cb.value),Xa.id)}S0i(cb,Xa){return Qa.a(Xa,"1404166600",cb,null,null,cb,cb,null,null)}}Object(K.a)(Wa,"TryQueryMenuItemFactory",null,[901]);class yb{constructor(cb){this.Lpa=
[];this.ub=cb}h8i(cb){for(const Xa of this.Lpa)if(Xa.yib===cb)return Xa;return null}LZa(cb){this.Lpa.push(cb)}ROk(cb){this.LZa(new Fa(this.ub.Zyi,cb));this.LZa(new za.a(this.ub.zjk));this.LZa(new pa.a(this.ub.C1k,this.ub.B1k,this.ub.cpl,this.ub.yxj,this.ub.Ecl));this.LZa(new ua.InsightsMenuItemFactory);this.LZa(new Sa);this.LZa(new Na.a);this.LZa(new Wa)}}Object(K.a)(yb,"MenuItemFactoryRegistry",null,[]);var Za=d(154);class ub{constructor(cb,Xa){this.ub=cb;this.xgf=new yb(this.ub);this.xgf.ROk(Xa)}N0i(cb,
Xa){let Lb=0;const pc=[],fc=[];for(const od of cb){cb=I.a.e_e;var bd=[];for(const ye of od.results){const pd=this.xgf.h8i(ye.type).SK(ye,Xa);cb=I.a.e_e;bd.push(pd);if(13===ye.type||14===ye.type)cb="Menu32";17===ye.type&&(cb="MenuTellMeExtended");ye.groupType=od.groupType;fc.push(Object(n.a)(Za.a,ye))}Lb=Lb?Lb:bd.length;bd=Qa.c("TellMeDropdownControls",bd);cb=Qa.e("TellMeDropdownMenuSection",bd,cb,od.displayName);pc.push(cb)}Xa=Qa.f(pc,"LookupDropdownMenu");return new Da(Xa,Lb,fc)}static get wNc(){return ub.Q9e||
(ub.Q9e=new Da(Qa.f([],"LookupDropdownMenu"),0,[]))}}ub.Q9e=null;Object(K.a)(ub,"TellMeXmlGenerator",null,[]);class Ib{}Ib.uik="MRU";Ib.test="Test";Object(K.a)(Ib,"ActionType",null,[]);var Ob=d(378),Hc;(function(cb){cb[cb.Service=0]="Service";cb[cb.Local=1]="Local";cb[cb.MRU=2]="MRU";cb[cb.TestResult=3]="TestResult";cb[cb.Unknown=4]="Unknown"})(Hc||(Hc={}));Object(K.b)("SubResultType",Hc);var kb=d(103);class jb{constructor(cb,Xa,Lb,pc,fc=null){this.CommandId=null;this.IsEnabled=!1;this.OptionalData=
this.SubResultType=this.ResultType=null;this.CommandId=cb;this.IsEnabled=Xa;this.ResultType=E[Lb];this.SubResultType=Hc[pc];this.OptionalData=fc?kb.a.toJSON(fc):null}}Object(K.a)(jb,"ResultInfo",null,[]);var hb=d(170),uc=d(141),mc=d(179);class Ya{constructor(cb,Xa=null){this.ecf="TellMeWAC.";this.gXh=cb;this.y1h=Xa}koa(cb,Xa,Lb){Xa=hb.a.ND(Xa);cb=hb.a.oXd(cb,this.gXh,this.y1h,Lb,Xa);uc.a.koa(cb,this.ecf)}sKa(cb,Xa,Lb=0){Xa=hb.a.ND(Xa);uc.a.sKa(Object.assign(new mc.a,{name:cb,dataFields:Xa,durationMs:Lb}),
this.ecf)}}Object(K.a)(Ya,"TellMeOtelLogger",null,[985]);var Mb=d(104);class Kc{constructor(cb,Xa,Lb,pc,fc,bd,od){this.KV=this.zZ=this.H7e=null;this.ppa=cb;this.Yxd=Xa;this.pqa=Lb;this.ANa=pc;this.mAa=fc;this.ZTh=bd;this.KV=od?od:new Ya(this.ANa?v.CuiHelper.rXe:v.CuiHelper.n_e)}get Lo(){return this.ANa}get Gna(){return this.pqa}Tnd(cb){this.H7e=cb;switch(cb){case ya.a.contextMenu:this.zZ=ya.a.contextMenu;break;default:this.zZ=ya.a.tellMe}}Kgi(cb,Xa){this.pqa.K8||(this.pqa.K8=Mb.a.create().toString(),
this.Vng(cb,!0,Xa))}APf(cb,Xa=!0){this.pqa.K8&&this.q0j(cb,Xa);this.ANa&&appChrome.api.updateTellMeCorrelationId("");this.pqa.K8=null}Vng(cb,Xa,Lb){const {TellMeActor:pc}=d(115),fc=this.rW(A.a.cyb);fc[Ob.a.culture]=this.Yxd;fc[Ob.a.appName]=this.ppa;fc[Ob.a.context]=cb;fc[Ob.a.SZc]=this.mAa;fc[Ob.a.dUj]=this.ZTh;fc[Ob.a.MSj]=Lb;fc[Ob.a.eNj]=Xa;fc[Ob.a.contentType]=pc.instance.yLc;this.KV.koa(A.a.cyb,fc,this.H7e);this.ANa&&appChrome.api.updateTellMeCorrelationId(this.pqa.K8)}q0j(cb,Xa){const Lb=this.rW(A.a.cdg);
Lb[Ob.a.kOi]=cb;Lb[Ob.a.dNj]=Xa;this.KV.sKa(A.a.cdg,Lb)}R1j(cb,Xa,Lb){let pc=0;!Lb&&0<cb.length&&(pc=cb.trim().split(" ").length);const fc=this.rW(A.a.query);fc[Ob.a.query]="!";fc[Ob.a.xhb]=Xa;fc[Ob.a.Nch]=cb.length;fc[Ob.a.Blg]=Lb;fc[Ob.a.sFl]=pc;this.KV.koa(A.a.query,fc,this.zZ)}m1j(cb,Xa,Lb,pc,fc,bd,od,ye=null){const pd=this.rW(A.a.latency);pd[Ob.a.culture]=this.Yxd;pd[Ob.a.Nch]=cb;pd[Ob.a.lEh]=Xa;pd[Ob.a.statusCode]=Lb;pd[Ob.a.M3k]=fc;pd[Ob.a.isSuccess]=bd;pd[Ob.a.gXj]=od;ye&&(pd[Ob.a.Xql]=ye);
this.KV.sKa(A.a.latency,pd,pc)}cne(cb,Xa,Lb,pc){const fc=this.rW(A.a.performance);fc[Ob.a.culture]=this.Yxd;fc[Ob.a.Ngi]=ba[cb];fc[Ob.a.TPi]=ba[Xa];fc[Ob.a.yzk]=Ea[Lb];this.KV.sKa(A.a.performance,fc,pc)}b2j(cb,Xa){var {TellMeActor:Lb}=d(115);const {CommandResultsUtility:pc}=d(330);if(cb.results.length){var fc=this.rW(A.a.Xih);fc[Ob.a.b$a]=Xa.toString();fc[Ob.a.groupType]=Q.a[cb.groupType];16===cb.groupType&&(fc[Ob.a.pSj]=Lb.instance.Stc);Xa=[];Lb=[];var bd=[];for(const od of cb.results)fc[Ob.a.resultType]||
(fc[Ob.a.resultType]=E[od.type]),cb={},26===od.type&&(cb.AssetId=od.HOd),Lb.push(pc.G8b(od.value)),Xa.push(od.value),bd.push(new jb(od.value,pc.G8b(od.value),od.type,od.subType,cb));0<Xa.length&&(fc[Ob.a.hZk]="{"+Xa.join(", ")+"}",fc[Ob.a.vPi]="{"+Lb.join(", ")+"}",fc[Ob.a.cZk]=wa.c(bd));this.KV.koa(A.a.Xih,fc,this.zZ)}}g1i(cb,Xa){if(4===cb)return Ib.uik;switch(Xa){case 5:case 16:case 17:case 18:return"Command";case 0:case 1:case 2:case 10:case 12:return"Insights";case 19:case 20:case 21:return"Notes"}return E[Xa]}W_j(cb,
Xa,Lb,pc,fc){const bd=this.rW(A.a.click);bd[Ob.a.lEh]=cb;bd[Ob.a.uxk]=Xa;bd[Ob.a.commandId]=Lb;bd[Ob.a.M6a]=pc;bd[Ob.a.actionType]=this.g1i(fc.groupType,fc.resultType);bd[Ob.a.resultType]=E[fc.resultType];bd[Ob.a.VYe]=Hc[fc.VYe];bd[Ob.a.groupType]=Q.a[fc.groupType];bd[Ob.a.b$a]=fc.b$a.toString();bd[Ob.a.BZd]=fc.BZd.toString();bd[Ob.a.resultIndex]=fc.resultIndex.toString();this.KV.koa(A.a.click,bd,this.zZ)}$_j(cb,Xa){this.pqa.K8||(this.pqa.K8=Mb.a.create().toString(),this.Vng("",!1,Xa));Xa=this.rW(A.a.lGf);
Xa[Ob.a.xhb]=cb;this.KV.sKa(A.a.lGf,Xa)}dog(cb,Xa,Lb){if(cb){if(Lb)for(let pc in Lb)cb[pc]=Lb[pc];this.KV.sKa(A.a.events,cb,Xa)}}NFa(cb,Xa,Lb=null){const pc=this.rW(A.a.events);pc[Ob.a.event]=cb;this.dog(pc,Math.round(Xa),Lb)}zac(cb,Xa,Lb=null){const pc=this.rW(A.a.events);pc[Ob.a.event]=A.a.error;pc[Ob.a.module]=cb;pc[Ob.a.errorMessage]=Xa;pc[Ob.a.message]=Xa;this.dog(pc,Math.round(window.performance.now()),Lb)}U_j(cb){const Xa=this.rW(A.a.CEf);Xa[Ob.a.value]=cb;Xa[Ob.a.qjd]=this.ANa;this.KV.koa(A.a.CEf,
Xa,this.zZ)}t_j(cb){const Xa=this.rW(A.a.zpf);Xa[Ob.a.value]=cb;Xa[Ob.a.qjd]=this.ANa;this.KV.koa(A.a.zpf,Xa,this.zZ)}D0j(cb){const Xa=this.rW(A.a.qTf);Xa[Ob.a.value]=cb;Xa[Ob.a.qjd]=this.ANa;this.KV.koa(A.a.qTf,Xa,this.zZ)}Q1j(cb){const Xa=this.rW(A.a.uch);Xa[Ob.a.value]=cb;Xa[Ob.a.qjd]=this.ANa;this.KV.koa(A.a.uch,Xa,this.zZ)}I_j(cb){const Xa=this.rW(A.a.zoh);Xa[Ob.a.value]=cb;this.KV.koa(A.a.zoh,Xa,this.zZ)}U1j(cb,Xa){const Lb=this.rW(A.a.Lch);Lb[Ob.a.rIb]=cb;Xa&&(Lb[Ob.a.K8]=Xa);this.KV.sKa(A.a.Lch,
Lb)}rW(cb){return{["SessionID"]:this.pqa.sessionId,["CorrelationID"]:this.pqa.K8,["Time"]:(new Date).getTime(),["Event"]:cb,["Scenario"]:this.zZ}}}Object(K.a)(Kc,"UsageLogger",null,[963]);var eb=d(93);class Tb{}Tb.Callback="action";Object(K.a)(Tb,"MenuLauncherAsyncTriggerCommandProperties",null,[]);var lb=d(528),Fb=d(79),rb=d(133),Qb=d(482),Bc=d(236),wb=d(54),Ad=d(268),bc=d(71),Sb=d(35);d.d(Z,"TellMeActor",function(){return Zb});class Zb{constructor(){this.AAa=this.kS=this.Od=this.$a=this.z6=this.oG=
this.Wd=this.Ca=this.Hd=this.yD=this.OEd=this.ipf=this.Fba=this.ub=null;this.iob=!1;this.Hxd=[];this.D7e=[];this.xof=[];this.Sgf=[];this.Tgf=[];this.Odf=!1;this.Kmb=this.k5a=null;this.YSb=this.mAa=!1;this.pAc=!0;this.LP=this.tyc=this.Haf=this.ZEd=this.Mgf=null;this.O1=[];this.QMa=this.bnb=this.Wga=null;this.Snb=!1;this.TEd=0;this.Dmb=null;this.Eba=-1;this.ygf=0;this.eTb=!1;this.$Ma=null;this.vof=!1;this.rS=null}get yLc(){return this.z6?this.z6.contentType:Zb.unknown}get actions(){return this.O1}set actions(cb){this.O1=
cb}ITc(){return this.Hd?this.Hd.Gna.K8:null}SG(){return this.ub}get Nhk(){return this.pAc}get lEl(){return this.Mgf}performance(){return this.yD}get Stc(){return this.vof}set Stc(cb){this.vof=cb}mG(cb){const Xa=window.performance.now();this.k5a&&!S.b(cb)&&(this.k5a(cb),this.Hd.wH(A.a.mG,window.performance.now()-Xa))}initialize(cb,Xa=null,Lb=null,pc=null,fc=null,bd=null,od=null,ye=null,pd=null,ab=null,Yb=null){const {InteractionLogger:Sc}=d(1131),{GroupsPlacementInfo:Jb}=d(1128),{AggregatorResultsProvider:Oc}=
d(987);this.ub=cb;this.mAa=!!J.AFrameworkApplication.Aa&&J.AFrameworkApplication.Aa.hb.zzb;this.Hd=pc;if(!pc){pc=new z;pc.sessionId=J.AFrameworkApplication.userSessionId;const Wb=Ad.a.ue(J.AFrameworkApplication.lcid)||Ad.a.q8b;this.Hd=new Sc(new Kc(this.ub.application,Wb.name,pc,this.ub.Lo,this.mAa,cb.$ya,null),this.ub.$yi,this.ub)}this.AAa=new R(this.ub.parameterData);this.ipf=Lb||new ub(this.ub,this.AAa);this.k5a=od;this.OEd=this.OEd||new na(this.ub,this.ub.parameterData,od);this.Od=eb.FocusManager.instance();
this.kS=D.createInstance(this.ub);this.Haf=new Jb(cb);this.Ca=fc||J.AFrameworkApplication.Ta;this.Wd=bd||J.AFrameworkApplication.we;this.oG=pd;this.Fba=Xa;this.rS=Yb;this.yD=new La;pd?pd.execute(Wb=>{Wb.isFeatureEnabled(Zb.Rol,!0).then(Ab=>{const {AggregatorResultsProvider:Xb}=d(987);this.eTb=Ab;this.Fba=this.Fba||Xb.createInstance(this.kS,this.ub,this.AAa,this.eTb);return null})}):(this.eTb=!0,this.Fba=this.Fba||Oc.createInstance(this.kS,this.ub,this.AAa,this.eTb));this.$a=ye;this.Wga=ub.wNc;this.Mgf=
new Promise(Wb=>{this.ZEd=Wb});ab&&ab.execute(Wb=>{this.z6=Wb});this.ub.Lo&&I.a.Mjg()&&(cb=String.format(CommonUIStrings.l_TeamsUnifiedAppHelpText,this.ub.application),appChrome.api.dispatch(appChrome.actions.updateTellMePlaceholderText(cb,cb)))}vb(){this.$6h()}$6h(){this.Ca.ra(Sb.a.tellMe,bc.a.frame,Object(k.a)(this,this.tellMe,"tellMe"),96);this.Ca.ra(Sb.a.d_e,bc.a.frame,Object(k.a)(this,this.$zf,"cacheAsyncMenuRefreshFunction"),96);this.Ca.ra(Sb.a.h_e,bc.a.frame,Object(k.a)(this,this.qog,"logItemExecuted"),
96);this.Ca.ra(Sb.a.k_e,bc.a.frame,Object(k.a)(this,this.$ng,"logControlDeactivation"),96);this.Ca.ra(Sb.a.j_e,bc.a.frame,Object(k.a)(this,this.mog,"logInputFocus"),96);this.Ca.ra(Sb.a.g_e,bc.a.frame,Object(k.a)(this,this.cyb,"interactionBegin"),96);this.Ca.ra(Sb.a.m_e,bc.a.frame,Object(k.a)(this,this.cyb,"interactionBegin"),96);this.Ca.ra(Sb.a.i_e,bc.a.frame,Object(k.a)(this,this.kog,"logInputBlur"),96);this.Ca.ra(Sb.a.l_e,bc.a.frame,Object(k.a)(this,this.Zng,"logControlActivated"),96);this.Ca.ra(Sb.a.mrd,
bc.a.frame,Object(k.a)(this,this.kVf,"focusSearchBox"),96);this.Ca.ra(Sb.a.c_e,bc.a.frame,Object(k.a)(this,this.FFf,"constructLiveNotificationForMenu"),96);this.Ca.ra(Sb.a.o_e,bc.a.frame,Object(k.a)(this,this.jge,"insertTryQuery"),96);this.Ca.ra(Sb.a.gme,bc.a.frame,Object(k.a)(this,this.jge,"insertTryQuery"),96);this.Ca.ra(Sb.a.O1d,bc.a.frame,Object(k.a)(this,this.cxa,"openOrInsertUrl"),96);this.Ca.ra(Sb.a.P1d,bc.a.frame,Object(k.a)(this,this.cxa,"openOrInsertUrl"),96);this.Ca.ra(Sb.a.Q1d,bc.a.frame,
Object(k.a)(this,this.cxa,"openOrInsertUrl"),96);this.Ca.ra(Sb.a.R1d,bc.a.frame,Object(k.a)(this,this.cxa,"openOrInsertUrl"),96);this.Ca.ra(Sb.a.S1d,bc.a.frame,Object(k.a)(this,this.cxa,"openOrInsertUrl"),96);this.Ca.ra(Sb.a.oHe,bc.a.frame,Object(k.a)(this,this.cxa,"openOrInsertUrl"),96);this.Ca.ra(Sb.a.pHe,bc.a.frame,Object(k.a)(this,this.cxa,"openOrInsertUrl"),96);this.Ca.ra(Sb.a.qHe,bc.a.frame,Object(k.a)(this,this.cxa,"openOrInsertUrl"),96);this.Ca.ra(Sb.a.wIe,bc.a.frame,Object(k.a)(this,this.c8b,
"insertMention"),96);this.Ca.ra(Sb.a.xIe,bc.a.frame,Object(k.a)(this,this.c8b,"insertMention"),96);this.Ca.ra(Sb.a.yIe,bc.a.frame,Object(k.a)(this,this.c8b,"insertMention"),96);this.Ca.ra(Sb.a.f_e,bc.a.frame,Object(k.a)(this,this.g7g,"openFeedback"),96);this.Ca.ra(Sb.a.p_e,bc.a.frame,Object(k.a)(this,this.cxa,"openOrInsertUrl"),96);this.Ca.ra(Sb.a.DOd,bc.a.frame,Object(k.a)(this,this.dAb,"launchAddin"),96);this.Ca.ra(Sb.a.EOd,bc.a.frame,Object(k.a)(this,this.dAb,"launchAddin"),96);this.Ca.ra(Sb.a.FOd,
bc.a.frame,Object(k.a)(this,this.dAb,"launchAddin"),96);this.Ca.ra(Sb.a.Zjb,bc.a.frame,Object(k.a)(this,this.Zjb,"showTellMeCoachmark"),96);this.Ca.ra(Sb.a.Zle,bc.a.frame,Object(k.a)(this,this.Cmg,"launchAddinStore"),96)}rOk(cb){this.pAc=!1;const Xa=window.performance.now();cb.JFa.isCompleted?(this.pAc=!0,this.ZEd(!0)):cb.zS(()=>{this.pAc=!0;this.ZEd(!0);this.Hd.wH(A.a.NJi,window.performance.now()-Xa)});this.WOk(cb)}WOk(cb){Bc.a.Hjd(Object(k.a)(this,this.cMi,"dispatcher"));Bc.a.F2b([new Qb.a(Sb.a.tellMe,
bc.a.frame,96),new Qb.a(Sb.a.d_e,bc.a.frame,96),new Qb.a(Sb.a.h_e,bc.a.frame,96),new Qb.a(Sb.a.k_e,bc.a.frame,96),new Qb.a(Sb.a.j_e,bc.a.frame,96),new Qb.a(Sb.a.g_e,bc.a.frame,96),new Qb.a(Sb.a.m_e,bc.a.frame,96),new Qb.a(Sb.a.i_e,bc.a.frame,96),new Qb.a(Sb.a.l_e,bc.a.frame,96),new Qb.a(Sb.a.mrd,bc.a.frame,96),new Qb.a(Sb.a.c_e,bc.a.frame,96),new Qb.a(Sb.a.o_e,bc.a.frame,96),new Qb.a(Sb.a.gme,bc.a.frame,96),new Qb.a(Sb.a.O1d,bc.a.frame,96),new Qb.a(Sb.a.P1d,bc.a.frame,96),new Qb.a(Sb.a.Q1d,bc.a.frame,
96),new Qb.a(Sb.a.R1d,bc.a.frame,96),new Qb.a(Sb.a.S1d,bc.a.frame,96),new Qb.a(Sb.a.oHe,bc.a.frame,96),new Qb.a(Sb.a.pHe,bc.a.frame,96),new Qb.a(Sb.a.qHe,bc.a.frame,96),new Qb.a(Sb.a.wIe,bc.a.frame,96),new Qb.a(Sb.a.xIe,bc.a.frame,96),new Qb.a(Sb.a.yIe,bc.a.frame,96),new Qb.a(Sb.a.f_e,bc.a.frame,96),new Qb.a(Sb.a.p_e,bc.a.frame,96),new Qb.a(Sb.a.DOd,bc.a.frame,96),new Qb.a(Sb.a.EOd,bc.a.frame,96),new Qb.a(Sb.a.FOd,bc.a.frame,96),new Qb.a(Sb.a.Zjb,bc.a.frame,96),new Qb.a(Sb.a.Zle,bc.a.frame,96)],cb)}cMi(cb,
Xa,Lb,pc,fc){if(Xa.contextId===bc.a.frame)switch(cb){case Sb.a.tellMe:return this.tellMe(cb,Xa,Lb,pc,fc);case Sb.a.d_e:return this.$zf(cb,Xa,Lb,pc,fc);case Sb.a.h_e:return this.qog(cb,Xa,Lb,pc,fc);case Sb.a.k_e:return this.$ng(cb,Xa,Lb,pc,fc);case Sb.a.j_e:return this.mog(cb,Xa,Lb,pc,fc);case Sb.a.g_e:return this.cyb(cb,Xa,Lb,pc,fc);case Sb.a.m_e:return this.restoreFocus(cb,Xa,Lb,pc,fc);case Sb.a.i_e:return this.kog(cb,Xa,Lb,pc,fc);case Sb.a.l_e:return this.Zng(cb,Xa,Lb,pc,fc);case Sb.a.mrd:return this.kVf(cb,
Xa,Lb,pc,fc);case Sb.a.c_e:return this.FFf(cb,Xa,Lb,pc,fc);case Sb.a.o_e:case Sb.a.gme:return this.jge(cb,Xa,Lb,pc,fc);case Sb.a.O1d:case Sb.a.P1d:case Sb.a.Q1d:case Sb.a.R1d:case Sb.a.S1d:case Sb.a.oHe:case Sb.a.pHe:case Sb.a.qHe:case Sb.a.p_e:return this.cxa(cb,Xa,Lb,pc,fc);case Sb.a.wIe:case Sb.a.xIe:case Sb.a.yIe:return this.c8b(cb,Xa,Lb,pc,fc);case Sb.a.f_e:return this.g7g(cb,Xa,Lb,pc,fc);case Sb.a.DOd:case Sb.a.EOd:case Sb.a.FOd:return this.dAb(cb,Xa,Lb,pc,fc);case Sb.a.Zjb:return this.Zjb(cb,
Xa,Lb,pc,fc);case Sb.a.Zle:return this.Cmg(cb,Xa,Lb,pc,fc)}return 2}kVf(cb,Xa,Lb){if(1===Lb)return 32;this.drh();cb=!1;(this.ub.$ya||this.mAa)&&(Xa=document.getElementById("SearchButton"))&&Xa.click();if(!this.ub.$ya&&this.mAa)for(Xa=document.getElementsByClassName("ms-suiteux-search-box"),Lb=0;Lb<Xa.length;Lb++){const pc=Xa[Lb].querySelector("input[type=search]");pc&&(cb=eb.FocusManager.Sr(pc))}else cb=eb.FocusManager.Sr($get(this.ub.Lo?v.CuiHelper.rXe:v.CuiHelper.n_e));this.YSb=!0;return cb?32:
8}jge(cb,Xa,Lb,pc,fc){if(1===Lb)return 32;if(S.b(fc))return this.Hd.onError("TellMeActor:InsertTryQuery","actiondata comes null"),16;this.drh();cb=fc.CommandValueId;Xa=this.ub.Lo?v.CuiHelper.rXe:v.CuiHelper.n_e;this.ub.Lo&&!S.b(fc[lb.a.Rfa])&&(fc[lb.a.Rfa]=!1);if(cb){if(this.ub.Lo)return appChrome.api.dispatch(appChrome.actions.updateTellMeSearchText(cb)),this.$Ma=[19],32;if(fc=$get(Xa))fc.value=cb}return eb.FocusManager.Sr($get(Xa))?32:8}drh(){this.Od.tY(this.ub.$ya||this.mAa?this.ub.gVc:this.ub.kKa,
!1)}b1i(cb,Xa){switch(cb){case 0:return String.format(CommonUIStrings.l_TellMeClassifierCommandAccessibleLabelFormat,Xa);case 4:return String.format(CommonUIStrings.l_TellMeRecentlyUsedAccessibleLabelFormat,Xa);case 5:return String.format(CommonUIStrings.l_TellMeTryQueryAccessibleLabelFormat,Xa);case 7:case 16:return String.format(CommonUIStrings.l_TellMeTryCommandAccessibleLabelFormat,Xa)}return Xa}FFf(cb,Xa,Lb,pc,fc){if(1===Lb)return 32;if(S.b(fc))return this.Hd.onError("TellMeActor:ConstructLiveNotificationForMenu",
"actiondata comes null"),16;cb=this.Wga?this.Wga.resultCount:0;fc.Value=1!==cb?String.format(CommonUIStrings.l_LookupLiveNotificationResultPluralFormText,cb):CommonUIStrings.l_LookupLiveNotificationResultSingularFormText;if(this.Wga)for(const bd of this.Wga.pMi)fc=Object(e.a)(O.a,bd)?bd.id:la.a.replaceAll(bd.value,'"',""),(fc=$get(fc+"-"+I.a.e_e))&&rb.a.bP(fc,rb.a.gs,la.a.pe(this.b1i(bd.groupType,fc.innerText)));return 32}$zf(cb,Xa,Lb,pc,fc){if(1===Lb)return 32;if(S.b(fc))return this.Hd.onError("TellMeActor:CacheAsyncMenuRefreshFunction",
"actiondata comes null"),16;this.Dmb=new Fb.a(2,1,0,()=>{fc[Tb.Callback]()},97);this.Wga&&this.Wd.Eb(this.Dmb);return 32}qog(cb,Xa,Lb,pc,fc){if(1===Lb)return 32;if(S.b(fc))return this.Hd.onError("TellMeActor:LogItemExecuted","actiondata comes null"),16;fc.CloseAllMenus&&(cb=void 0===fc.ParentControlId||null===fc.ParentControlId?"<NA>":fc.ParentControlId,Xa=this.Kmb?this.Kmb[fc.ControlId]:null,!Xa&&this.Kmb&&"<NA>"!==cb&&(Xa=this.Kmb[cb]),Xa||(Xa=this.iob&&this.kS.KJj(fc),Xa=this.HKi(Xa,fc.ControlId),
Xa=new C(Xa,29,4,-1,-1,-1),this.Hd.onError("TellMeActor:ItemExecuted","Missing ClickLoggingInfo for "+fc.ControlId+" determined group:"+Q.a[Xa.groupType])),this.Hd.dnk(fc.ControlId,cb,fc.CommandId,fc.CloseAllMenus,Xa),this.AAa.okk(fc.ControlId),fc.Location!==ya.a.contextMenu&&(this.kS.r4h(fc),this.kS.FA(Xa.resultType),this.ub.Wod&&this.Fba.y5h(fc.CommandId)));return 32}$ng(cb,Xa,Lb,pc,fc){if(1===Lb)return 32;H.a.eUj()&&(new ra(this.ITc())).Wej(this.bnb);cb=this.bnb;Xa=this.Eba;Lb=this.Hd.Awc;if(S.b(fc))return this.Hd.onError("TellMeActor:LogControlDeactivation",
"actiondata comes null"),16;fc=fc.UILocation;cb&&0<cb.length&&this.eTb&&I.a.IVe(this.ub)&&this.ub.r_c&&19!==fc&&Xa>Lb&&!this.ub.HH&&(this.Hd.fne(cb),this.Hd.kTe(Xa));this.Hd.NXk();this.ub.Ztd&&19!==fc&&(this.yD.mark(3),this.yD.measure(1,0,3),this.yD.measure(2,2,3),this.yD.Vme(0,1,2),this.yD.Vme(2,2,3),this.yD.Vme(1,0,3),this.yD.gQa([0,1,2,3]),this.yD.clearMeasures([0,2,1]));this.Hd.pnk(window.performance.now()-this.TEd);this.ub.Lo&&(this.QMa=null,this.Hd.D3g());this.YSb=this.Snb=!1;this.bnb="";return 32}mog(cb,
Xa,Lb){if(1===Lb)return 32;this.Hd.E3g(w(Xa),this.YSb);return 32}kog(cb,Xa,Lb){if(1===Lb)return 32;this.Hd.D3g();this.Snb=!1;return 32}Zng(cb,Xa,Lb,pc,fc){if(1===Lb)return 32;this.LP=null;fc&&(this.LP=fc);this.ub.Ztd&&(S.b(this.LP)||this.LP.Location!==ya.a.contextMenu)&&this.yD.mark(0);this.Hd.Tnd(S.b(this.LP)||S.b(this.LP.Location)?ya.a.unknown:this.LP.Location);this.Hd.onk(this.ygf,this.YSb);this.Snb||this.pjc();return 32}MHf(cb,Xa){const Lb=[],pc=Date.now();for(let fc of cb)cb=(pc-fc.timeStamp)/
1E3,cb=I.a.rsd(cb),Array.add(Lb,new Y(Xa?fc.commandId:fc.controlId,cb));return Lb}$Gi(cb){const Xa=[],Lb=Date.now();for(let pc of cb)if(pc.controlId||"keyboardShortcut"===pc.commandSurface)cb=(Lb-pc.timeStamp)/1E3,cb=I.a.rsd(cb),Array.add(Xa,new fa(pc.controlId,pc.commandId,cb,pc.commandSurface,pc.prd));return Xa}jIf(cb=!1){var Xa=cb?this.kS.Tej():this.kS.F4b();cb=[];const Lb=Date.now();for(const pc of Xa)Xa=(Lb-pc.TimeStamp)/1E3,Xa=I.a.rsd(Xa),Array.add(cb,new Y(pc.Id,Xa));return cb}pjc(){if(!this.Snb){this.iob=
this.Snb=!0;""!==this.ub.unh&&J.AFrameworkApplication.fk(this.ub.unh);if(!this.Odf){this.Odf=!0;const cb={};cb.IsMLREnabled=this.ub.uOj;cb.IsReactRibbonEnabled=this.ub.Lo;cb.IsSharedHeaderEnabled=!!J.AFrameworkApplication.Aa&&J.AFrameworkApplication.Aa.hb.WN;cb.IsSearchUxEnabled=this.mAa;cb.IsTellMeInHeaderEnabled=this.ub.$ya;cb.IsGoLocalEnv=I.a.Mgg();cb.IsSovereignEnvironment=I.a.Rab();cb.IsTellMeServiceResultsEnabled=I.a.IVe(this.ub);cb.IsSubstrateProviderEnabled=I.a.HVe(this.ub);cb.ShouldFetchTokens=
!!J.AFrameworkApplication.Aa&&J.AFrameworkApplication.Aa.hb.QLb;cb.IsSerpletEnabled=I.a.R3();cb.FirstOnClickTimeInMS=Math.round(window.performance.now());cb.IsHeaderHidden=J.AFrameworkApplication.hideHeader||J.AFrameworkApplication.zQ;cb.IsSearchInHeaderHidden=J.AFrameworkApplication.rVc;void 0!==window.performance.timing&&null!==window.performance.timing&&(cb.TimeSinceFetchStart=Math.round(Date.now()-window.performance.timing.fetchStart));cb.IsFindWithMatchesEnabled=this.ub.GTf;cb.HelpShowsTopSearchResult=
this.ub.jqc;cb.HelpShowsNumberOfMatches=this.ub.iqc;J.AFrameworkApplication.fa&&(cb.UiHost=J.AFrameworkApplication.fa.Ha("UiHostIntegrationType"));this.Hd.m2j(JSON.stringify(cb))}this.Hxd=this.MHf(r.a.instance.xQb,!1);this.D7e=this.MHf(r.a.instance.Z1a,!0);this.xof=this.$Gi(r.a.instance.Z1a);this.Sgf=this.jIf();this.Tgf=this.jIf(!0);this.Hd.pjc()}}cyb(cb,Xa,Lb,pc,fc){if(1===Lb)return 32;if(S.b(fc))return this.Hd.onError("TellMeActor:InteractionBegin","actiondata comes null"),16;if(wb.a.XW)return 32;
this.TEd=window.performance.now();this.pjc();cb=new da(Object(k.a)(this,this.ifa,"onRequestCompleted"),0);this.Eba++;this.Hd.beginQuery("",this.Eba,this.iob);this.Wga=ub.wNc;this.QMa=na.C_d;if(this.Fba)Zb.instance.actions=[],this.Fba.vC(new W("",this.Eba),cb,this.ub.Lo);else this.Hd.onError("TellMeActor:ExecuteTellMeQuery","Aggregator provider not resolved yet");this.Dmb&&this.Wd.Eb(this.Dmb);return 32}restoreFocus(cb,Xa,Lb){if(1===Lb)return 32;this.Od.x5(this.ub.$ya||this.mAa?this.ub.gVc:this.ub.kKa,
!1);return 32}tellMe(cb,Xa,Lb,pc,fc){if(1===Lb)return 32;if(S.b(fc))return this.Hd.onError("TellMeActor:TellMe","actiondata comes null"),16;this.LP=fc;this.Hd.Tnd(S.b(this.LP.Location)?ya.a.unknown:this.LP.Location);cb=this.LP.Value;this.ub.Lo||cb&&""!==cb.trim()?(!this.QMa&&this.ub.Lo&&(this.Hd.E3g(w(Xa),this.YSb),this.pjc()),this.MSi(cb,this.LP.Location),this.LP.PopulationXML=this.Wga.xml):this.iob?this.LP.PopulationXML=this.Wga.xml:(this.LP.PopulationXML=ub.wNc.xml,this.QMa=na.C_d,this.bnb="");
return 32}MSi(cb,Xa){this.TEd=window.performance.now();this.ub.Ztd&&Xa!==ya.a.contextMenu&&this.yD.mark(1);this.ub.Lo&&appChrome.api.dispatch(appChrome.actions.updateTellMeSearchText(cb));cb&&0<cb.trim().length&&(this.iob=!1);this.ub.ERi();Xa=S.b(Xa)?ya.a.tellMe:Xa;if(cb!==this.bnb||this.ub.Lo){this.Eba++;this.Hd.beginQuery(cb,this.Eba,this.iob);const Lb=new W(cb,this.Eba),pc=new da(Object(k.a)(this,this.ifa,"onRequestCompleted"),this.Eba);this.Wga=ub.wNc;this.QMa=na.C_d;if(this.Fba)Zb.instance.actions=
[],this.Fba.vC(Lb,pc,this.ub.Lo,Xa,this.$Ma),this.$Ma=null;else this.Hd.onError("TellMeActor:ExecuteTellMeQuery","Aggregator provider not resolved yet");this.ygf=this.Eba;this.bnb=cb}}Tyl(cb){if(this.ub.Lo){var Xa=appChrome.selectors.getActiveControlStates();if(Xa=Object(n.a)(Object,Xa[cb.value])){cb.label=Xa.label;let Lb=null;"description"in Xa&&(Lb=Xa.description);Lb&&Object.getType(Lb)===String?cb.description=Lb:"secondaryText"in Xa?cb.description=Xa.secondaryText:"fullDescriptionLabel"in Xa&&
(cb.description=Xa.fullDescriptionLabel)}}}HAk(cb){this.Kmb={};let Xa=0,Lb=0;for(const pc of cb){cb=0;for(const fc of pc.results)this.Kmb[fc.value]=new C(fc.groupType,fc.type,fc.subType,Xa,cb,Lb),cb++,Lb++,fc.label||5!==fc.type||this.Tyl(fc);0<cb&&Xa++}}QGb(cb,Xa,Lb,pc,fc){if(1===Lb)return 32;if(S.b(fc))return this.Hd.onError("TellMeActor:OpenUrlInNewTab","actiondata comes null"),16;(cb=fc.CommandValueId)&&window.open(cb,"_blank");return 32}c8b(cb,Xa,Lb,pc,fc){if(1===Lb)return 32;if(S.b(fc))return this.Hd.onError("TellMeActor:InsertMention",
"actiondata comes null"),16;cb=fc.UILocation;let bd;fc=fc.CommandValueId;try{bd=wa.a(fc)}catch(od){return this.Hd.onError("TellMeActor:InsertMention","commandValueId is not in proper format"),16}return S.b(bd)?(this.Hd.onError("TellMeActor:InsertMention","insertMentionParameters comes null"),16):S.b(this.tyc)?(this.Hd.onError("TellMeActor:InsertMention","_iInsertContentHandler comes null"),16):19!==cb?(this.Hd.onError("TellMeActor:InsertMention","location "+cb+" is unexpected"),16):this.tyc.c8b(bd.displayName,
bd.email,bd.userId)?32:(this.Hd.onError("TellMeActor:InsertMention","mention is not inserted"),16)}cxa(cb,Xa,Lb,pc,fc){return 1===Lb?32:S.b(fc)?(this.Hd.onError("TellMeActor:OpenOrInsertUrl","actiondata comes null"),16):19===fc.UILocation?this.rFj(Lb,fc):this.QGb(cb,Xa,Lb,pc,fc)}g7g(cb,Xa,Lb,pc,fc){if(1===Lb)return 32;if(S.b(fc))return this.Hd.onError("TellMeActor:OpenFeedback","actiondata comes null"),16;this.rS&&window.setTimeout(()=>{this.rS.execute(bd=>{bd.kMb("TellMeSurvey",null)})},Zb.YUi);
return 32}rFj(cb,Xa){if(1===cb)return 32;if(S.b(Xa))return this.Hd.onError("TellMeActor:InsertUrl","actiondata comes null"),16;if(S.b(this.tyc))return this.Hd.onError("TellMeActor:InsertUrl","_iInsertContentHandler comes null"),16;cb=Xa.CommandValueId;return S.b(cb)?(this.Hd.onError("TellMeActor:InsertUrl","commandValueId comes null"),16):this.tyc.insertHtmlText(cb)?32:(this.Hd.onError("TellMeActor:InsertUrl","url is not inserted"),16)}ifa(cb,Xa,Lb,pc,fc){Lb=window.performance.now();this.HAk(Xa);
this.Hd.d7k(Xa);this.ub.Lo?(this.QMa=this.OEd.M0i(Xa,cb,fc),this.ub.bda?(this.O1.push(appChrome.actions.updateTellMeSearchResults(this.QMa.menuModel,cb,fc)),appChrome.api.dispatch(this.O1)):appChrome.api.dispatch(appChrome.actions.updateTellMeSearchResults(this.QMa.menuModel,cb,fc)),this.ub.Ztd&&this.Snb&&(S.b(this.LP)||this.LP.Location!==ya.a.contextMenu)&&(this.yD.mark(2),this.yD.measure(0,1,2))):this.Wga=this.ipf.N0i(Xa,this.Hd.Gna);this.Dmb&&this.Wd.Eb(this.Dmb);fc={};fc.GroupsCount=Xa.length;
fc.QueryID=pc;fc.QueryLength=cb.length;this.Hd.wH(A.a.cFi,window.performance.now()-Lb,fc)}HKi(cb,Xa){return Xa.startsWith(this.ub.Lo?I.a.z1e:I.a.Isd)?5:cb?4:"bSearchHelp"===Xa||Xa.startsWith("GetHelpFromTellMe")?8:"bInsights"===Xa||Xa.startsWith("SmartLookupFromTellMe")?13:"ActionAIFromTellMe"===Xa?24:Xa===this.ub.FTf?2:0}FA(cb,Xa){this.Fba&&this.Fba.FA(cb,Xa)}Cmg(cb,Xa,Lb,pc,fc){if(1===Lb)return 32;if(S.b(fc))return this.Hd.onError("TellMeActor:LaunchAddinStore","actiondata comes null"),16;if(this.$a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinActionDataRefactor",
!1)){cb={};cb.SourceControlId=fc.SourceControlId;cb.Query=fc.CommandValueId;fc=this.Ca.La(Sb.a.$le,2,cb);if(32!==fc)this.Hd.onError("TellMeActor:LaunchAddinStore","CommonCommands.LaunchAppforOfficeDialog failed. Response: "+fc+".");return fc}return this.Ca.La(Sb.a.$le,2,fc)}dAb(cb,Xa,Lb,pc,fc){({AddinResultsProvider:cb}=d(702));if(1===Lb)return 32;if(S.b(fc))return this.Hd.onError("TellMeActor:LaunchAddin","actiondata comes null"),16;Lb=fc.CommandValueId;if(S.a(Lb))return this.Hd.onError("TellMeActor:LaunchAddin",
"Add-in assetId is null"),16;if(!cb.Q5a[Lb])return this.Hd.onError("TellMeActor:LaunchAddin","Add-in with assetId "+Lb+" doesn't not exist in entitlements"),16;fc=d(702).AddinResultsProvider.Q5a[Lb];cb={};cb.solutionId=fc.id;cb.version=fc.appVersion;cb.storeType=fc.storeType;cb.storeId=fc.storeId;cb.assetId=fc.assetId;cb.assetStoreId=fc.assetStoreId;cb.displayName=fc.displayName;cb.targetType=fc.targetType;cb.height=fc.height;cb.width=fc.width;fc=this.Ca.La(Sb.a.Ncg,2,cb);if(32!==fc)this.Hd.onError("TellMeActor:LaunchAddin",
"CommonCommands.InsertOfficeAddin failed. Response: "+fc+". AssetId: "+Lb);return fc}Zjb(){if(!S.b(this.rS))for(let cb of r.a.instance.Z1a){if("ShowContextMenuWithFloatie"===cb.commandId)return this.rS.execute(Xa=>{Xa.logActivity("TellMe1TabSwitchCoachMarkActivity",null)}),32;if(cb.commandId&&-1===cb.commandId.indexOf("Tab"))break}return 8}static get instance(){return Zb.Ka||(Zb.Ka=new Zb)}}Zb.Ka=null;Zb.Rol="mso_tellMeService";Zb.unknown="Unknown";Zb.YUi=500;Object(K.a)(Zb,"TellMeActor",null,[])},
1228:function(K,Z,d){d.r(Z);var k=d(0),e=d(25),n=d(68),r=d(382),v=d(924),C=d(93),w=d(55),z=d(1185),A=d(13),u=d(1220),E=d(91),H=d(65),I=d(171),J=d(1033),T=d(80);class D{static get qg(){return T.a.gC(D.ro,Box4Intl.Box4Strings.L_SymbolUnicodeNameLabel,"")}}D.ro="<div class='WACDialogRow' id='SymbolsTable'> <div id='symbolsContainer'></div> </div> <div class='WACDialogRow' id='SymbolName'> <label id='SymbolNameLabel' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='SymbolNameValue'> <label id='SymbolNameValueLabel' class='WACDialogLabel' >{1}</label> </div>";
Object(k.a)(D,"InsertSymbolsDialogHtml",null,[]);var R=d(32),Q=d(214);class W extends u.a{constructor(Ia,nb,Kb){super();this.Ref=this.Dqa=this.ROa=null;this.HBd=0;this.Ca=Ia;this.Od=nb;this.cBa=Kb;this.Xe(1,Box4Intl.Box4Strings.L_SymbolInsertButtonText);this.Xe(0,CommonUIStrings.l_DialogClose);this.GV=!1;this.qg=D.qg;this.ig="InsertSymbolsDialog"}dispose(){0<W.sLd&&r.ULS.sendTraceTag(8778014,348,50,"InsertSymbolsDialog: InsertedSymbolCount={0}, TotalInsertedSymbolCount={1}",this.HBd,W.sLd);W.I8e++;
r.ULS.sendTraceTag(8778015,348,50,"InsertSymbolsDialog: DialogCloseCount={0}",W.I8e);this.Ca=this.cBa=null;super.dispose()}T5(){this.$i(Box4Intl.Box4Strings.L_SymbolSingle,Object(A.a)(this,this.oFj,"insertSymbolsDialogHandler"),null);this.HBd=0;W.N8e++;r.ULS.sendTraceTag(8778013,348,50,"InsertSymbolsDialog: DialogOpenCount={0}",W.N8e);const Ia=this.k9d("symbol_d_"+W.xTb);Ia&&Ia.focus()}hide(){var Ia=document.getElementById("symbolsContainer");if(Ia&&(Ia=Ia.getElementsByTagName("a")))for(let nb=0;nb<
Ia.length;nb++)E.a.removeHandler(Ia[nb],H.a.focus,Object(A.a)(this,this.gzh,"symbolFocusHandler"));super.hide()}oFj(Ia){1===Ia?(this.eGe("symbol_d_"+W.xTb),this.Od.tY(this.aL,!0),this.Od.yl().uj.VE(this.pD),this.pD.focus()):this.hide()}get bAb(){return W.kff}set bAb(Ia){W.kff=Ia}get Yzb(){return W.Zef}set Yzb(Ia){W.Zef=Ia}Rwa(){super.Rwa();var Ia=document.getElementById("symbolsContainer");if(Ia&&(J.a.Dnd(Ia,this.cBa.oji(),"InsertSymbolsDialog"),Ia=Ia.getElementsByTagName("a")))for(let nb=0;nb<Ia.length;nb++)E.a.addHandler(Ia[nb],
H.a.focus,Object(A.a)(this,this.gzh,"symbolFocusHandler"))}I7(){const Ia=document.getElementById("symbolsContainer");Ia&&(this.ROa||(this.ROa=Object(A.a)(this,this.cnl,"symbolClickHandler"),this.vn.pb(H.a.click,Ia,this.ROa),this.vn.pb(H.a.doubleClick,Ia,this.ROa)),this.Dqa||(this.Dqa=Object(A.a)(this,this.enl,"symbolKeyHandler"),this.Pg.pb(H.a.Zf,Ia,this.Dqa),this.Pg.pb(H.a.ey,Ia,this.Dqa),this.Pg.pb(H.a.Hl,Ia,this.Dqa)));super.I7()}jsa(){const Ia=document.getElementById("symbolsContainer");Ia&&(this.ROa&&
(this.vn.yb(H.a.click,Ia,this.ROa),this.vn.yb(H.a.doubleClick,Ia,this.ROa),this.ROa=null),this.Dqa&&(this.Pg.yb(H.a.Zf,Ia,this.Dqa),this.Pg.yb(H.a.ey,Ia,this.Dqa),this.Pg.yb(H.a.Hl,Ia,this.Dqa),this.Dqa=null));super.jsa()}Bsk(Ia){this.erh("symbol_d_"+W.xTb,!1);W.xTb=parseInt(Ia.substr(Ia.lastIndexOf("_")+1));this.erh(Ia,!0);if(Ia=document.getElementById("SymbolNameValueLabel")){const nb=this.BTc(W.xTb);Ia.innerText=nb.altText}}BTc(Ia){const nb=this.cBa.Drc.Mqd.value,Kb=Q.a(nb);return nb[Kb[Ia]]}gzh(Ia){if(Ia.target!==
this.Ref){const nb=this.Od.yl();nb&&nb.uj&&(nb.uj.VE(Ia.target),this.Ref=Ia.target)}this.Bsk(Ia.target.id)}cnl(Ia){const nb=Ia.Cc;if("a"!==nb.tagName.toLowerCase())return!1;Ia.eventName===H.a.doubleClick&&this.eGe(nb.id);this.Od.tY(this.aL,!0);this.Od.yl().uj.VE(nb);nb.focus();return!0}enl(Ia){var nb=Ia.Cc;if("a"!==nb.tagName.toLowerCase())return!1;const Kb=parseInt(nb.id.substr(nb.id.lastIndexOf("_")+1));if(Ia.pc.ctrlKey||Ia.pc.altKey||Ia.pc.keyCode>=I.a.Tlb&&Ia.pc.keyCode<=I.a.zza)return!1;if(Ia.eventName===
H.a.Zf){Ia=Ia.pc.keyCode;let dc=-1;Ia===Sys.UI.Key.enter?(this.eGe(nb.id),this.Od.tY(this.aL,!0),this.Od.yl().uj.VE(nb),nb.focus()):Ia===Sys.UI.Key.up?dc=Kb-15:Ia===Sys.UI.Key.down?dc=Kb+15:Ia===Sys.UI.Key.left?dc=e.AFrameworkApplication.isRtl?Kb+1:Kb-1:Ia===Sys.UI.Key.right&&(dc=e.AFrameworkApplication.isRtl?Kb-1:Kb+1);0<=dc&&(nb=this.k9d("symbol_d_"+dc))&&nb.focus()}return!0}eGe(Ia){this.HBd++;W.sLd++;Ia=parseInt(Ia.substr(Ia.lastIndexOf("_")+1));const nb=this.BTc(Ia),Kb={};Kb.SourceControlId="symbol_"+
Ia+"_"+nb.Lqd;this.Ca.La(R.a.STa,2,Kb);r.ULS.sendTraceTag(8778016,348,50,"InsertSymbolsDialog: Insert symbol, index={0}",Ia)}k9d(Ia){const nb=document.getElementById("symbolsContainer");return nb?nb.querySelector("#"+Ia):null}erh(Ia,nb){(Ia=this.k9d(Ia))&&(nb?Ia.setAttribute("selected","true"):Ia.removeAttribute("selected"))}}W.xTb=0;W.kff=null;W.Zef=null;W.N8e=0;W.I8e=0;W.sLd=0;Object(k.a)(W,"InsertSymbolsDialog",u.a,[]);var O=d(42),Y=d(51),S=d(39),da=d(180),fa=d(107);class ka{constructor(Ia,nb,
Kb,dc,Ic,Id,ae,Od){this.Ca=Ia;this.rK=nb;this.q0h=new z.a(Object(A.a)(this,this.Wjj,"getSymbolsDropDownMenuProps"));this.r0h=new z.a(Object(A.a)(this,this.l9d,"getSymbolsDropDownXml"));this.zKd=dc.Drc.Mqd;this.yk=Kb;this.cBa=dc;this.wD=Ic;this.oP=Id;this.Tc=ae;this.Hm=Od}Wjj(){return this.cBa.$ji()}l9d(){return this.cBa.build()}vb(){this.Ca.ra(R.a.Phd,S.a.application,Object(A.a)(this,this.Phd,"queryInsertSymbols"),96);this.Ca.ya(R.a.Zgb,S.a.view,Object(A.a)(this,this.Zgb,"populateSymbolsDropDown"));
this.Ca.ya(R.a.Nqd,S.a.view,Object(A.a)(this,this.hzh,"symbolsDropDownOpenHandler"));this.Ca.ya(R.a.wMe,S.a.view,Object(A.a)(this,this.idh,"querySymbolPositionHandler"));this.Ca.ya(R.a.STa,S.a.view,Object(A.a)(this,this.LEa,"insertSymbolViewHandler"));this.Ca.ya(R.a.Zgb,S.a.Of,Object(A.a)(this,this.Zgb,"populateSymbolsDropDown"));this.Ca.ya(R.a.Nqd,S.a.Of,Object(A.a)(this,this.hzh,"symbolsDropDownOpenHandler"));this.Ca.ya(R.a.wMe,S.a.Of,Object(A.a)(this,this.idh,"querySymbolPositionHandler"));this.Ca.ya(R.a.STa,
S.a.Of,Object(A.a)(this,this.nFj,"insertSymbolHandler"));this.Ca.he(R.a.Zgb,1124);this.Ca.he(R.a.Nqd,1036);this.Ca.he(R.a.wMe,1124);this.Ca.he(R.a.STa,1036);e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("InsertMoreSymbolsIsEnabled")&&(this.Ca.ya(R.a.yWc,S.a.view,Object(A.a)(this,this.hvh,"showInsertMoreSymbolsDialogHandler")),this.Ca.ya(R.a.yWc,S.a.Of,Object(A.a)(this,this.hvh,"showInsertMoreSymbolsDialogHandler")),this.Ca.he(R.a.yWc,1124))}idh(Ia,nb,Kb,dc,Ic){if(1===Kb)return 32;Ia=this.cBa.X8g(Ic);
Ia=String.format(this.cBa.dnl,Ia.character);Ic[v.a.InnerHTML]=Ia;Ic[v.a.On]=!1;return 32}LEa(Ia,nb,Kb,dc,Ic){if(({If:Ia,selected:Kb,LEa:Od}=this.oKf(nb,Kb)).returnValue)return Od;var Id=O.SelectionEditor.Sg(Kb);let ae=!0;Kb=8;var Od=this.yk.le(15);Od.kd(Ia.yg);Id||(Kb=this.Ca.mi(nb,R.a.JCa,2,!0,dc,null),nb=32===Kb,r.ULS.shipAssertTag(6407387,348,nb,"DeleteForReplace did not succeed. Response is {0}",Kb),ae=nb);ae&&(nb=Ia.Lb.Qj,Id=O.SelectionEditor.Sg(nb),r.ULS.shipAssertTag(6407388,348,Id,"Context is not an InsertionPointContext after DeleteForReplace. Context is {0}",
nb.contextId),Kb=8,Id&&(Kb=this.Ca.mi(nb,R.a.STa,2,!1,dc,Ic),r.ULS.shipAssertTag(6407389,348,32===Kb,"Insertion at IP context did not succeed. Response is {0}",Kb),32===Kb&&C.FocusManager.instance().xf(Ia.vI)));Od.dispose();return Kb}oKf(Ia,nb){let Kb,dc;Kb=null;Ia.view.Mh&&(Kb=Ia.view);dc=null;return Kb&&Kb.Lb?(dc=Kb.Lb.Qj)?this.oP.ga(14)&&this.wD.Z6a(dc)?{returnValue:!0,If:Kb,selected:dc,LEa:8}:Kb.Lb.Pa.eH||this.Hm&&this.Hm.instance&&this.Hm.instance.UW(dc)||O.SelectionEditor.DXc(Ia.xE)?{returnValue:!0,
If:Kb,selected:dc,LEa:2}:1===nb?{returnValue:!0,If:Kb,selected:dc,LEa:32}:{returnValue:!1,If:Kb,selected:dc,LEa:32}:{returnValue:!0,If:Kb,selected:dc,LEa:2}:(fa.c(16851359,315,50,"DefaultActionHandler would have crashed. The context passed in was {0} which does not contain a selection manager",Ia.toString()),{returnValue:!0,If:Kb,selected:dc,LEa:8})}nFj(Ia,nb,Kb,dc,Ic){if(1===Kb)return 32;if(O.SelectionEditor.DXc(nb))return 2;Ia=this.cBa.X8g(Ic);dc.eQ=Ia.index;dc=this.rK.Nc(nb.node);Kb=dc.rc(11);
r.ULS.shipAssertTag(6379466,324,Kb,"could not root iterator at ancestor of type OutlineElement. NodeType: {0}",da.a[nb.node.type]);Kb=this.yk.le(15);Kb.yy(dc);ka.characterPropertiesEditor.replaceTextRange(nb,Ia.character,!0,!1);nb=Y.SelectionFactory.Qg(dc.currentNode,nb.Qa+1);this.Tc.setSelection(nb);Kb.dispose();return 32}Zgb(Ia,nb,Kb,dc,Ic){if(1===Kb)return 32;e.AFrameworkApplication.Aa&&e.AFrameworkApplication.Aa.hb.Np?Ic.MenuItems=this.q0h.value:Ic.PopulationXML=this.r0h.value;return 32}hzh(Ia,
nb,Kb){({LEa:Ia}=this.oKf(nb,Kb));return Ia}hvh(Ia,nb,Kb){2===Kb&&(new W(this.Ca,C.FocusManager.instance(),w.a.instance.resolve("Box4.Symbols.ISymbolsUIBuilder"))).T5();return 32}Phd(){return 32}static get characterPropertiesEditor(){return ka.Zg||(ka.Zg=w.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static set characterPropertiesEditor(Ia){ka.Zg=Ia}}ka.Zg=null;Object(k.a)(ka,"SymbolsActor",null,[1006]);class ha{constructor(Ia,nb){this.Lqd=Ia;this.altText=nb}}Object(k.a)(ha,"Symbol",null,
[]);class F{constructor(){this.yKd=null;this.zKd=new z.a(F.gXd)}get Mqd(){return this.zKd}K$i(Ia){this.yKd||(this.yKd=Q.a(this.zKd.value));return Array.indexOf(this.yKd,Ia)}static gXd(){const Ia={};Ia["\u2022"]=new ha("\u2022",Box4Intl.Box4Strings.L_Bullet);Ia["\u20ac"]=new ha("\u20ac",Box4Intl.Box4Strings.L_EuroSign);Ia["\u00a3"]=new ha("\u00a3",Box4Intl.Box4Strings.L_PoundSign);Ia["\u00a5"]=new ha("\u00a5",Box4Intl.Box4Strings.L_YenSign);Ia["\u00a9"]=new ha("\u00a9",Box4Intl.Box4Strings.L_CopyrightSign);
Ia["\u00ae"]=new ha("\u00ae",Box4Intl.Box4Strings.L_RegisteredSign);Ia["\u2122"]=new ha("\u2122",Box4Intl.Box4Strings.L_TradeMarkSign);Ia["\u00b1"]=new ha("\u00b1",Box4Intl.Box4Strings.L_PlusMinusSign);Ia["\u2260"]=new ha("\u2260",Box4Intl.Box4Strings.L_NotEqualTo);Ia["\u2264"]=new ha("\u2264",Box4Intl.Box4Strings.L_LessThanOrEqualTo);Ia["\u2265"]=new ha("\u2265",Box4Intl.Box4Strings.L_GreaterThanOrEqualTo);Ia["\u00f7"]=new ha("\u00f7",Box4Intl.Box4Strings.L_DivisionSign);Ia["\u00d7"]=new ha("\u00d7",
Box4Intl.Box4Strings.L_MultiplicationSign);Ia["\u221e"]=new ha("\u221e",Box4Intl.Box4Strings.L_Infinity);Ia["\u00b5"]=new ha("\u00b5",Box4Intl.Box4Strings.L_MicroSign);Ia["\u03b1"]=new ha("\u03b1",Box4Intl.Box4Strings.L_GreekSmallLetterAlpha);Ia["\u03b2"]=new ha("\u03b2",Box4Intl.Box4Strings.L_GreekSmallLetterBeta);Ia["\u03c0"]=new ha("\u03c0",Box4Intl.Box4Strings.L_GreekSmallLetterPi);Ia["\u03a9"]=new ha("\u03a9",Box4Intl.Box4Strings.L_OhmSign);Ia["\u03a3"]=new ha("\u03a3",Box4Intl.Box4Strings.L_NArySummation);
Ia["\u00b0"]=new ha("\u00b0",Box4Intl.Box4Strings.L_DegreeSign);Ia["\u0394"]=new ha("\u0394",Box4Intl.Box4Strings.L_CapitalLetterDelta);Ia["\u263a"]=new ha("\u263a",Box4Intl.Box4Strings.L_WhiteSmilingFace);Ia["\u2665"]=new ha("\u2665",Box4Intl.Box4Strings.L_BlackHeartSuit);Ia["\u20b9"]=new ha("\u20b9",Box4Intl.Box4Strings.L_IndianRupeeSign);Ia["\u00bf"]=new ha("\u00bf",Box4Intl.Box4Strings.L_InvertedQuestionMark);Ia["\u00a1"]=new ha("\u00a1",Box4Intl.Box4Strings.L_InvertedExclamationMark);Ia["\u2014"]=
new ha("\u2014",Box4Intl.Box4Strings.L_EmDash);Ia["\u2026"]=new ha("\u2026",Box4Intl.Box4Strings.L_HorizontalEllipsis);Ia["\u00c0"]=new ha("\u00c0",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithGrave);Ia["\u00c1"]=new ha("\u00c1",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithAcute);Ia["\u00c2"]=new ha("\u00c2",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithCircumflex);Ia["\u00c3"]=new ha("\u00c3",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithTilde);Ia["\u00c4"]=new ha("\u00c4",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithDiaeresis);
Ia["\u00c5"]=new ha("\u00c5",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithRingAbove);Ia["\u00c6"]=new ha("\u00c6",Box4Intl.Box4Strings.L_LatinCapitalLetterAe);Ia["\u00c7"]=new ha("\u00c7",Box4Intl.Box4Strings.L_LatinCapitalLetterCWithCedilla);Ia["\u00c8"]=new ha("\u00c8",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithGrave);Ia["\u00c9"]=new ha("\u00c9",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithAcute);Ia["\u00ca"]=new ha("\u00ca",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithCircumflex);Ia["\u00cb"]=
new ha("\u00cb",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithDiaeresis);Ia["\u00cc"]=new ha("\u00cc",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithGrave);Ia["\u00cd"]=new ha("\u00cd",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithAcute);Ia["\u00ce"]=new ha("\u00ce",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithCircumflex);Ia["\u00cf"]=new ha("\u00cf",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithDiaeresis);Ia["\u00d1"]=new ha("\u00d1",Box4Intl.Box4Strings.L_LatinCapitalLetterNWithTilde);Ia["\u00d2"]=
new ha("\u00d2",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithGrave);Ia["\u00d3"]=new ha("\u00d3",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithAcute);Ia["\u00d4"]=new ha("\u00d4",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithCircumflex);Ia["\u00d5"]=new ha("\u00d5",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithTilde);Ia["\u00d6"]=new ha("\u00d6",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithDiaeresis);Ia["\u00d9"]=new ha("\u00d9",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithGrave);Ia["\u00da"]=
new ha("\u00da",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithAcute);Ia["\u00db"]=new ha("\u00db",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithCircumflex);Ia["\u00dc"]=new ha("\u00dc",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithDiaeresis);Ia["\u00df"]=new ha("\u00df",Box4Intl.Box4Strings.L_LatinSmallLetterSharpS);Ia["\u00e0"]=new ha("\u00e0",Box4Intl.Box4Strings.L_LatinSmallLetterAWithGrave);Ia["\u00e1"]=new ha("\u00e1",Box4Intl.Box4Strings.L_LatinSmallLetterAWithAcute);Ia["\u00e2"]=new ha("\u00e2",
Box4Intl.Box4Strings.L_LatinSmallLetterAWithCircumflex);Ia["\u00e3"]=new ha("\u00e3",Box4Intl.Box4Strings.L_LatinSmallLetterAWithTilde);Ia["\u00e4"]=new ha("\u00e4",Box4Intl.Box4Strings.L_LatinSmallLetterAWithDiaeresis);Ia["\u00e5"]=new ha("\u00e5",Box4Intl.Box4Strings.L_LatinSmallLetterAWithRingAbove);Ia["\u00e6"]=new ha("\u00e6",Box4Intl.Box4Strings.L_LatinSmallLetterAe);Ia["\u00e7"]=new ha("\u00e7",Box4Intl.Box4Strings.L_LatinSmallLetterCWithCedilla);Ia["\u00e8"]=new ha("\u00e8",Box4Intl.Box4Strings.L_LatinSmallLetterEWithGrave);
Ia["\u00e9"]=new ha("\u00e9",Box4Intl.Box4Strings.L_LatinSmallLetterEWithAcute);Ia["\u00ea"]=new ha("\u00ea",Box4Intl.Box4Strings.L_LatinSmallLetterEWithCircumflex);Ia["\u00eb"]=new ha("\u00eb",Box4Intl.Box4Strings.L_LatinSmallLetterEWithDiaeresis);Ia["\u00ec"]=new ha("\u00ec",Box4Intl.Box4Strings.L_LatinSmallLetterIWithGrave);Ia["\u00ed"]=new ha("\u00ed",Box4Intl.Box4Strings.L_LatinSmallLetterIWithAcute);Ia["\u00ee"]=new ha("\u00ee",Box4Intl.Box4Strings.L_LatinSmallLetterIWithCircumflex);Ia["\u00ef"]=
new ha("\u00ef",Box4Intl.Box4Strings.L_LatinSmallLetterIWithDiaeresis);Ia["\u00f1"]=new ha("\u00f1",Box4Intl.Box4Strings.L_LatinSmallLetterNWithTilde);Ia["\u00f2"]=new ha("\u00f2",Box4Intl.Box4Strings.L_LatinSmallLetterOWithGrave);Ia["\u00f3"]=new ha("\u00f3",Box4Intl.Box4Strings.L_LatinSmallLetterOWithAcute);Ia["\u00f4"]=new ha("\u00f4",Box4Intl.Box4Strings.L_LatinSmallLetterOWithCircumflex);Ia["\u00f5"]=new ha("\u00f5",Box4Intl.Box4Strings.L_LatinSmallLetterOWithTilde);Ia["\u00f6"]=new ha("\u00f6",
Box4Intl.Box4Strings.L_LatinSmallLetterOWithDiaeresis);Ia["\u00f9"]=new ha("\u00f9",Box4Intl.Box4Strings.L_LatinSmallLetterUWithGrave);Ia["\u00fa"]=new ha("\u00fa",Box4Intl.Box4Strings.L_LatinSmallLetterUWithAcute);Ia["\u00fb"]=new ha("\u00fb",Box4Intl.Box4Strings.L_LatinSmallLetterUWithCircumflex);Ia["\u00fc"]=new ha("\u00fc",Box4Intl.Box4Strings.L_LatinSmallLetterUWithDiaeresis);Ia["\u00ff"]=new ha("\u00ff",Box4Intl.Box4Strings.L_LatinSmallLetterYWithDiaeresis);Ia["\u011e"]=new ha("\u011e",Box4Intl.Box4Strings.L_LatinCapitalLetterGWithBreve);
Ia["\u011f"]=new ha("\u011f",Box4Intl.Box4Strings.L_LatinSmallLetterGWithBreve);Ia["\u0130"]=new ha("\u0130",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithDotAbove);Ia["\u0131"]=new ha("\u0131",Box4Intl.Box4Strings.L_LatinSmallLetterDotlessI);Ia["\u0152"]=new ha("\u0152",Box4Intl.Box4Strings.L_LatinCapitalLigatureOe);Ia["\u0153"]=new ha("\u0153",Box4Intl.Box4Strings.L_LatinSmallLigatureOe);Ia["\u015e"]=new ha("\u015e",Box4Intl.Box4Strings.L_LatinCapitalLetterSWithCedilla);Ia["\u015f"]=new ha("\u015f",
Box4Intl.Box4Strings.L_LatinSmallLetterSWithCedilla);Ia["\u0178"]=new ha("\u0178",Box4Intl.Box4Strings.L_LatinCapitalLetterYWithDiaeresis);return Ia}}Object(k.a)(F,"SymbolsLoader",null,[782]);var na=d(45),ba=d(312),Ea=d(271),La=d(213),ta=d(578),oa=d(1216),wa=d(134),ra=d(73);class ya{constructor(Ia){this.s0h=Ia}get Drc(){return this.s0h}get dnl(){return'<div class="SymbolButtonInnerHTML" aria-hidden="true" style="color: black">{0}</div>'}X8g(Ia){Ia=Ia.SourceControlId.split("_");const nb={};2===Ia.length?
(nb.character=Ia[1],nb.index=this.Drc.K$i(nb.character)):(nb.character=Ia[2],nb.index=parseInt(Ia[1]));return nb}$ji(){return this.l5f()}build(){return this.l9d()}oji(){const Ia=new Sys.StringBuilder;Ia.append('<table class="moreSymbolsTable">');const nb=this.Drc.Mqd.value,Kb=Q.a(nb);let dc=0;for(;dc<Kb.length;){dc%15||Ia.append('<tr role="presentation">');const Ic=nb[Kb[dc]];Ia.append(String.format('<td unselectable="on">\r\n\t\t\t\t\t<div unselectable="on" role="presentation">\r\n\t\t\t\t\t\t<a id="{0}" aria-label="{2}" title="{2}" role="button" tabindex="0" unselectable="on">{1}</a>\r\n\t\t\t\t\t</div></td>',
"symbol_d_"+dc,na.a.FTa(Ic.Lqd),na.a.FTa(Ic.altText)));dc++;dc%15&&dc!==Kb.length||Ia.append("</tr>")}Ia.append("</table>");return Ia.toString()}l9d(){const Ia=this.l5f();return wa.l(Ia)}l5f(){const Ia=Object.assign(new ba.a,{Id:"menuSymbolsDropDown",MenuSectionList:[]});Array.add(Ia.MenuSectionList,this.T6h());e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("InsertMoreSymbolsIsEnabled")&&Array.add(Ia.MenuSectionList,this.D5h());return Ia}D5h(){const Ia=Object.assign(new Ea.a,{Id:"msMoreSymbols",
Title:"",DisplayMode:"Menu16",ControlsId:"ctrlMoreSymbols",ControlList:[]}),nb=Object.assign(new La.a,{Id:"btnMoreSymbols",Command:"3574218963",LabelText:na.a.pe(Box4Intl.Box4Strings.L_InsertMoreSymbols),Alt:na.a.pe(Box4Intl.Box4Strings.L_InsertMoreSymbols),Image16by16:e.AFrameworkApplication.qm,Image16by16Class:ra.getImageClass("Symbol_16x16x32"),KeyTip:CommonUIStrings.l_InsertMoreSymbolsKeytip});Array.add(Ia.ControlList,nb);return Ia}T6h(){const Ia=Object.assign(new Ea.a,{Id:"msSymbolsPosition",
ShowMenuSectionSeparator:!1,ControlList:[]}),nb=Object.assign(new ta.a,{Type:1,Id:"gallerySymbolsPosition",ExternalId:"InsertSymbols",ExternalGalleryId:"InsertSymbolGallery",Width:5,ElementDimensions:"Size16by16",GalleryItems:[]}),Kb=this.Drc.Mqd.value,dc=Q.a(Kb),Ic=Math.min(25,dc.length);for(let ae=0;ae<Ic;ae++){var Id=Kb[dc[ae]];Id=Object.assign(new oa.a,{Id:String.format("{0}{1}_{2}","symbol_",ae,Id.Lqd),Character:Id.Lqd,Command:"3966968829",QueryCommand:"816646517",Alt:na.a.pe(Id.altText)});nb.GalleryItems.push(Id)}Array.add(Ia.ControlList,
nb);return Ia}}Object(k.a)(ya,"SymbolsUiBuilder",null,[710]);var Da=d(62),pa=d(120),la=d(36),Fa=d(507),Qa=d(292);class Sa{constructor(){this.Da=null}get name(){return"Box4.Symbols"}init(){e.AFrameworkApplication.fa.ka("InsertSymbolIsEnabled")&&this.Da.resolve("Box4.Symbols.ISymbolsActor").vb()}dispose(){}$b(Ia){this.Da=Ia;this.Da.register(F,"Box4.Symbols.SymbolsLoader").as("Box4.Symbols.ISymbolsLoader").ma();this.Da.register(ya,"Box4.Symbols.SymbolsUiBuilder").as("Box4.Symbols.ISymbolsUIBuilder").ma().oa(()=>
new ya(this.Da.resolve("Box4.Symbols.ISymbolsLoader")));this.Da.register(ka,"Box4.Symbols.SymbolsActor").as("Box4.Symbols.ISymbolsActor").ma().oa(()=>new ka(e.AFrameworkApplication.Ta,new Fa.a,new Qa.a,this.Da.resolve("Box4.Symbols.ISymbolsUIBuilder"),pa.a.instance,la.a.instance,Da.a.instance,this.Da.Ja("Box4.IExternalSelectionManager")))}static main(){n.a.instance.Dc(new Sa)}}Object(k.a)(Sa,"Box4SymbolsPackage",null,[2,3]);var Na=d(1047),ua=d(33),za=d(78),Wa=d(444);class yb{constructor(Ia,nb){this.sJd=
this.rJd=null;this.xpb=new Na.a;this.ei=Ia;this.pBa=nb.appSettings[yb.tEl]||""}get qbl(){return this.xpb.task}get hca(){return this.ei.value}lXk(){const Ia={};Ia[yb.Pvj]=e.AFrameworkApplication.jh;Ia["Content-Type"]="application/json; charset=utf-8";r.ULS.sendTraceTag(6612806,215,50,"Client is sending a request to get the code for the O365 switcher");const nb=za.a.Wi(this.pBa+yb.rbl,yb.alk,e.AFrameworkApplication.Aa.hb.Vk.toString());this.hca.Aj(nb,1,"",Ia,!0,2,Object(A.a)(this,this.ZGe,"onSuccessCallback"),
Object(A.a)(this,this.jjc,"onFailureCallback"),null,void 0,void 0,void 0,void 0,"20")}A1j(Ia){try{const nb={};nb.FlightName=Ia.FlightName;nb.SessionID=Ia.SessionID;r.ULS.sendTraceTag(594883776,215,50,ua.c(nb))}catch(nb){r.ULS.sendTraceTag(594883747,215,10,"Unable to log NavBarData")}}ZGe(Ia){if((Ia=Ia.data.Zd)&&Ia.length)try{const nb=ua.a(Ia);this.rJd=nb.NavBarDataJson;r.ULS.sendTraceTag(41551899,215,50,"Skipping call to TryLoadResources for React Shared Header.");this.rJd?({kv:this.sJd}=ua.d(nb.NavBarDataJson)).returnValue?
(this.A1j(this.sJd),this.xpb.Fg(this.sJd)):(r.ULS.sendTraceTag(7660113,215,10,"Failed to deserialize : {0}",{["ShellData"]:Wa.a.btc(this.rJd)}),this.xpb.g1()):(r.ULS.sendTraceTag(9000737,215,15,"ShellData is null"),this.xpb.g1())}catch(nb){r.ULS.sendTraceTag(6362370,215,10,"Unable to parse the response from O365ShellServiceProxy."),this.xpb.g1()}else r.ULS.sendTraceTag(6362369,215,10,"Response from O365ShellServiceProxy is null.")}jjc(){this.xpb.g1();r.ULS.sendTraceTag(7608091,215,10,"Call to O365ShellServiceProxy failed.")}static get instance(){return yb.Ka||
(yb.Ka=yb.Q8a())}static Q8a(){return new yb(new z.a(()=>e.AFrameworkApplication.Je),e.AFrameworkApplication.fa,e.AFrameworkApplication.Aa.hb.Vk)}}yb.Pvj="X-qs";yb.alk="at";yb.rbl="O365ShellServiceProxy.ashx";yb.Ka=null;yb.tEl="ShellWebServiceBase";Object(k.a)(yb,"O365ShellActor",null,[775]);class Za{constructor(){this.Da=null}get name(){return"Common.App.O365Shell"}$b(Ia){this.Da=Ia;this.Da.register(yb,"Common.App.O365Shell.O365ShellActor").as("Common.App.O365Shell.IO365ShellActor").ma().oa(()=>new yb(new z.a(()=>
e.AFrameworkApplication.Je),e.AFrameworkApplication.fa,e.AFrameworkApplication.Aa.hb.Vk))}init(){e.AFrameworkApplication.fa.jf(Object(A.a)(this,this.Om,"onFullAppSettingsReady"))}Om(){e.AFrameworkApplication.Ytd&&e.AFrameworkApplication.Aa.hb.WN&&this.Da.resolve("Common.App.O365Shell.O365ShellActor").lXk()}dispose(){}static main(){n.a.instance.Dc(new Za)}}Object(k.a)(Za,"PackageManager",null,[2,3]);var ub=d(76),Ib=d(282);class Ob{constructor(Ia){this.Oa=new ub.a;this.PH=Ia}RFc(Ia){this.Oa.addHandler(Ob.dza,
Ia)}nPe(Ia){this.Oa.removeHandler(Ob.dza,Ia)}sWe(){this.Oa.raiseEvent(Ob.JKb)}rWe(){this.Oa.raiseEvent(Ob.KKb)}}Ob.JKb="SE";Ob.KKb="SEP";Ob.dza="SER";Ob.o0e="TRP";Object(k.a)(Ob,"NullSessionExpirationManager",null,[724,725]);var Hc=d(164);class kb{constructor(){this.TVb=this.KOa=!1;const Ia=e.AFrameworkApplication.hm;0>=Ia||(this.hm=Ia,r.ULS.sendTraceTag(17581890,217,50,"Initializing SessionExpirationManager. {0}",{["AccessTokenTtl"]:this.hm,["NowGetTime"]:(new Date).getTime(),["BootTime"]:e.AFrameworkApplication.bca}),
Ib.a.instance.qOd(Object(A.a)(this,this.EGb,"onSessionExpiredDetected")),Ib.a.instance.oOd(Object(A.a)(this,this.Hjc,"onSessionExpiringDetected")))}EGb(){Ib.a.instance.pih(Object(A.a)(this,this.EGb,"onSessionExpiredDetected"));r.ULS.sendTraceTag(19247381,217,50,"SessionExpiredDetected");this.dae()}Hjc(){Ib.a.instance.JUk(Object(A.a)(this,this.Hjc,"onSessionExpiringDetected"));this.TVb||this.KOa||(r.ULS.sendTraceTag(20492680,217,50,"SessionExpiringDetected - Showing expiring dialog."),this.TVb=!0,
this.YWe())}dae(){this.KOa||(e.AFrameworkApplication.xp(Hc.a.sessionAccessTokenExpired),this.KOa=!0,this.Fpd())}}Object(k.a)(kb,"ASessionExpirationManager",null,[]);var jb=d(287),hb=d(35);class uc{constructor(Ia,nb,Kb,dc){this.G_e="";this.Ouc=Ia;this.amf=Kb;this.Ylf=dc;this.Ocf=nb;Ia=(new Date(this.Ouc)).format(e.AFrameworkApplication.Msh);this.G_e=this.Ocf?String.format(CommonUIStrings.l_SessionExpiredMessage):String.format(CommonUIStrings.l_SessionExpiringMessage,Ia)}HKb(Ia){1===Ia?this.amf&&this.amf(this.Ocf):
0===Ia&&e.AFrameworkApplication.Ta.La(hb.a.close,2,jb.g)}dispose(){this.Ylf&&this.Ylf()}}uc.id="SessionExpirationDialog";Object(k.a)(uc,"SessionExpirationDialogSharedProperties",null,[]);class mc{}mc.qg="<div class='WACDialogRow' id='SessionExpirationBlock'> <label id='WACSessionExpirationText' class='WACDialogLabel' >Session Expiration</label> </div>";Object(k.a)(mc,"SessionExpirationDialogHtml",null,[]);class Ya extends T.a{constructor(Ia,nb,Kb,dc){super(nb);const Ic={};this.YAa=new uc(Ia,nb,Kb,
dc);this.ig=uc.id;e.AFrameworkApplication.SAf?(this.xd=1,this.Xe(0,CommonUIStrings.l_DialogClose)):(this.xd=0,this.yr=!1);nb||1===e.AFrameworkApplication.Aa.mode?this.Xe(1,CommonUIStrings.l_SessionExpirationRefreshButton):this.Xe(1,CommonUIStrings.l_SessionExpiringSaveAndRefreshButton);this.qg=mc.qg;Ic.WACSessionExpirationText=this.YAa.G_e;this.$i(CommonUIStrings.l_DefaultDialogTitle,Object(A.a)(this,this.HKb,"sessionExpirationDialogHandler"),Ic);this.O5(this.Nh("WACSessionExpirationText"))}HKb(Ia){this.YAa.HKb(Ia)}aYc(){return this.HQ}j7b(){this.hide()}dispose(){super.dispose();
this.YAa&&this.YAa.dispose()}}Object(k.a)(Ya,"LegacySessionExpirationDialog",T.a,[870]);var Mb=d(106);class Kc extends Mb.StandardDialog{constructor(Ia,nb,Kb,dc){super(nb);this.YAa=new uc(Ia,nb,Kb,dc);this.ig=uc.id;e.AFrameworkApplication.SAf?(this.xd=1,this.Xe(0,CommonUIStrings.l_DialogClose)):(this.xd=0,this.yr=!1);nb||1===e.AFrameworkApplication.Aa.mode?this.Xe(1,CommonUIStrings.l_SessionExpirationRefreshButton):this.Xe(1,CommonUIStrings.l_SessionExpiringSaveAndRefreshButton);this.Bx(CommonUIStrings.l_DefaultDialogTitle,
this.YAa.G_e,0,Object(A.a)(this,this.HKb,"sessionExpirationDialogHandler"))}HKb(Ia){this.YAa.HKb(Ia)}aYc(){return this.HQ}j7b(){this.hide()}dispose(){super.dispose();this.YAa&&this.YAa.dispose()}}Object(k.a)(Kc,"SessionExpirationDialog",Mb.StandardDialog,[870]);const eb=(Ia,nb,Kb,dc)=>e.AFrameworkApplication.Aa&&e.AFrameworkApplication.Aa.hb.uC&&e.AFrameworkApplication.fa.ka("ReactStandardSessionExpirationDialogIsEnabled")?new Kc(Ia,nb,Kb,dc):new Ya(Ia,nb,Kb,dc);var Tb=d(218);class lb extends kb{constructor(Ia){super();
this.zpb=this.Apb=!0;this.JP=null;this.Oa=new ub.a;this.PH=Ia}RFc(Ia){this.Oa.addHandler(lb.dza,Ia)}nPe(Ia){this.Oa.removeHandler(lb.dza,Ia)}sWe(Ia){this.Apb=Ia}rWe(Ia){this.zpb=Ia}YWe(){if(!this.JP&&!Tb.a.Ww){if(this.zpb){const Ia=Object(A.a)(this,this.cub,"disposeCallback");this.JP=eb(this.hm,!1,Object(A.a)(this,this.IKb,"sessionExpirationHandler"),Ia)}this.Oa.raiseEvent(lb.KKb)}}Fpd(){this.JP&&(this.JP.aYc()&&this.JP.j7b(),this.JP=null);if(this.Apb){const Ia=Object(A.a)(this,this.cub,"disposeCallback");
this.JP=eb(this.hm,!0,Object(A.a)(this,this.IKb,"sessionExpirationHandler"),Ia)}this.Oa.raiseEvent(lb.JKb)}cub(){this.JP=null}IKb(){this.PH.refreshDocument(null)}}lb.JKb="SE";lb.KKb="SEP";lb.dza="SER";lb.o0e="TRP";Object(k.a)(lb,"SessionExpirationManager",kb,[724,725]);var Fb=d(17);class rb{}rb.T2h="Aborting";rb.YEc="ActivityDuration";rb.error="Error";rb.y0d="Errors";rb.failed="Failed";rb.iPc="FirstActivity";rb.initialized="Initialized";rb.NWj="KickedOut";rb.VWj="LastActivity";rb.Wkh="RetryOverride";
rb.Jkd="RequestGroups";rb.XZa="Requests";rb.Vkd="Responses";rb.Tmd="SessionDuration";rb.status="Status";rb.success="Success";rb.sml="Successful";rb.tokens="Tokens";rb.eJe="PollingDuration";Object(k.a)(rb,"SessionExpirationStrings",null,[]);var Qb=d(79);class Bc{constructor(Ia){this.Gy={};this.A6={};this.sOa={};this.oog=15;this.Ydf=!1;this.MZh=new Date;this.zzc=new Date;this.Wd=Ia;this.q7=new Qb.a(2,2,6E4*this.oog,Object(A.a)(this,this.qJh,"writeMeasures"),135,"SL",!1);this.Wd.Eb(this.q7);this.nDj()}qJh(){r.ULS.sendTraceTag(41964821,
217,50,r.ULS.xle({["Aggregate"]:this.A6,["Current"]:this.Gy}))}nDj(){this.A6[rb.Jkd]=0;this.A6[rb.XZa]=0;this.A6[rb.Vkd]=0;this.A6[rb.status]=rb.initialized;this.A6[rb.iPc]=new Date;this.A6[rb.Tmd]=0;this.A6[rb.YEc]=0;this.A6[rb.Tmd]=0;this.Gy[rb.Tmd]=0;this.A6[rb.YEc]=0;this.Gy[rb.YEc]=0}get wAk(){this.sOa[rb.eJe]=+new Date-+this.sOa[rb.iPc];return this.sOa}hce(Ia,nb){var Kb=Ia[nb];Kb=Kb?Kb:0;Kb++;Ia[nb]=Kb;this.ITe(Ia)}ITe(Ia){const nb=new Date;Ia[rb.YEc]=+nb-+this.zzc;this.zzc=nb;Ia[rb.Tmd]=+this.zzc-
+this.MZh;Ia[rb.VWj]=this.zzc}FY(Ia,nb){this.Gy[Ia]=nb;this.ITe(this.Gy)}jTe(Ia,nb){this.Gy[Ia]=nb;this.ITe(this.Gy)}Nxb(Ia){this.hce(this.Gy,Ia);this.hce(this.A6,Ia);this.hce(this.sOa,Ia)}flush(){this.Ydf||(this.A6[rb.status]=this.Gy[rb.status],this.qJh(this.q7),this.Wd.G5(this.q7,6E4*this.oog))}JXk(){const Ia=this.Gy[rb.status];Ia&&(this.A6[rb.status]=Ia);this.Gy={}}PXk(){this.sOa={};this.sOa[rb.eJe]=0;this.sOa[rb.iPc]=new Date}stop(){r.ULS.sendTraceTag(41964822,217,100,"Stopping logger. Flushing one last time");
this.flush();this.Ydf=!0;this.Wd.Rg(this.q7)}}Object(k.a)(Bc,"SessionLogger",null,[720]);class wb{constructor(Ia,nb){this.YDc=Ia;this.bha=nb}get tokens(){return this.YDc}get errors(){return this.bha}}Object(k.a)(wb,"TokenRefreshArgs",null,[750]);var Ad=d(94),bc=d(196),Sb=d(132);class Zb extends Sys.EventArgs{constructor(Ia,nb,Kb,dc,Ic,Id,ae){super();this.sOa=Ia;this.Jkd=dc;this.failed=Ic;this.XZa=Id;this.Vkd=ae}}Object(k.a)(Zb,"WaitingForTokenRefreshPollingArgs",Sys.EventArgs,[]);var cb=d(87);class Xa{constructor(Ia,
nb=null,Kb=null){this.TVb=this.KOa=!1;this.zpb=this.Apb=!0;this.Oa=new ub.a;this.VVb=this.pTb=this.$Bc=!1;this.$Gd=null;this.fjf=10;this.fzc=!1;this.mLd=Ia;this.mDd=e.AFrameworkApplication.RVj;this.Wd=Sb.a.instance;r.ULS.sendTraceTag(39408093,217,50,"Initializing SessionExpirationManagerWithRefresh. {0}",{["AccessTokenTtl"]:e.AFrameworkApplication.hm,["NowGetTime"]:(new Date).getTime(),["BootTime"]:e.AFrameworkApplication.bca});this.zj=nb||new Bc(Sb.a.instance);this.Uha=Kb;Ib.a.instance.qOd(Object(A.a)(this,
this.O2h,"aSessionExpirationManagerWithRefresh_OnSessionExpired"));Ib.a.instance.oOd(Object(A.a)(this,this.xMd,"aSessionExpirationManagerWithRefresh_OnSessionExpiring"));bc.SessionStatusManager.instance.hOd(Object(A.a)(this,this.xMd,"aSessionExpirationManagerWithRefresh_OnSessionExpiring"));bc.SessionStatusManager.instance.o$h(Object(A.a)(this,this.vDk,"preemptiveTokenRefresh"));this.Yef=new Date;e.AFrameworkApplication.QVj&&(Ib.a.instance.SSd=Object(A.a)(this,this.TNk,"refreshAccessTokenWhenSessionExpired"));
Ia=!1;e.AFrameworkApplication.fa&&(e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.TokenRefreshPollingIsEnabled",!1),this.fjf=e.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.WordOnline.TokenRefreshPollInterval",10),e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.ReportLastKnownTokenRefreshError",!1),Ia=e.AFrameworkApplication.fa.ka("WopiTokenRefreshWhenNetworkResumed"));Ia?bc.SessionStatusManager.instance.hOd(Object(A.a)(this,
this.P2h,"aSessionExpirationManagerWithRefresh_OnSessionExpiringNetworkResumed")):bc.SessionStatusManager.instance.hOd(Object(A.a)(this,this.xMd,"aSessionExpirationManagerWithRefresh_OnSessionExpiring"))}RFc(Ia){this.Oa.addHandler(Xa.dza,Ia)}nPe(Ia){this.Oa.removeHandler(Xa.dza,Ia)}TNk(){this.L6b(!1);return!Ib.a.instance.vFa(e.AFrameworkApplication.hm)}O2h(Ia,nb){Ib.a.instance.d_c?this.EGb(Ia,nb):this.mDd?(this.pTb=!1,this.L6b(!1)):(this.KOa||r.ULS.sendTraceTag(520954892,217,15,"Detected session expiry before token refresh got blocked"),
this.EGb(Ia,nb))}P2h(Ia,nb){Ib.a.instance.b_c?this.Hjc(Ia,nb):(fa.c(512247769,306,50,"Refreshing tokens since the user has network and session is expiring."),this.pTb=!1,this.L6b(!0))}xMd(Ia,nb){Ib.a.instance.b_c?this.Hjc(Ia,nb):this.L6b(!0)}L6b(Ia){if(!this.$Bc&&!this.pTb)if(this.Uha&&this.Uha.zab)this.VVb=!0,this.zj.FY(rb.status,rb.NWj),this.zj.flush(),this.zj.stop();else if(r.ULS.sendTraceTag(40420955,217,50,"HandleTokenRefresh, IsExpiring:{0}. ShouldAbort: {1}",Ia,this.VVb),this.VVb)this.Fpd();
else{this.zj.flush();this.zj.JXk();this.zj.Nxb(rb.Jkd);this.$Bc=!0;this.fzc||(this.zj.PXk(),this.fzc=!0,this.HAi());const nb=this.mLd.mOk(Ia);nb.continueWith(()=>{if(this.mLd.VFk(nb))this.zj.Nxb(rb.sml),this.zj.FY(rb.status,rb.success),this.zpb=!1,this.mDd&&(this.Apb=!1),this.pTb=!1,this.Yef=new Date,this.Ell(),this.Oa.raiseEvent(Xa.dza,new wb(nb.result.tokens,null));else{const Kb=nb.result.errors;this.zj.Nxb(rb.failed);this.zj.FY(rb.status,rb.failed);Ia||(this.VVb=this.mLd.H9b(Kb));this.VVb&&(this.zj.FY(rb.T2h,
JSON.stringify(Kb)),r.ULS.sendTraceTag(520954891,217,15,"Aborting token refresh"));this.pTb=!0;this.Oa.raiseEvent(Xa.dza,new wb(null,Kb))}this.zj.flush();this.$Bc=!1})}}EGb(){this.mDd||Ib.a.instance.pih(Object(A.a)(this,this.EGb,"onSessionExpiredDetected"));r.ULS.sendTraceTag(39408094,217,50,"SessionExpiredDetected");this.dae(Ib.a.instance.d_c)}Hjc(){this.TVb||this.KOa||(r.ULS.sendTraceTag(39408095,217,50,"SessionExpiringDetected - Showing expiring dialog."),this.TVb=!0,this.YWe(Ib.a.instance.b_c))}dae(Ia){if(!this.KOa){var nb=
Ia?Hc.a.R3k:Hc.a.sessionAccessTokenExpired;const Kb=Object.assign(new cb.a,{extendedProperties:new Map});Kb.extendedProperties.set("ErrorCode",String.format("{0}",nb));e.AFrameworkApplication.xp(nb,void 0,["SessionExpired"],Kb);Ia||(Ia=new Date,nb=new Date(e.AFrameworkApplication.bca),r.ULS.sendTraceTag(51642974,217,50,"Sending data to QoS. BootTime=[{0}], Now=[{1}], Duration=[{2}]",nb,Ia,+Ia-+nb),864E5>+Ia-+nb&&Ad.Health.instance.recordQosError("SessionAccessTokenExpiredInLessThanOneDay",["SessionExpired"],
!0,!0,!1,!0,Kb),2592E5>+Ia-+nb&&Ad.Health.instance.recordQosError("SessionAccessTokenExpiredInLessThanThreeDays",["SessionExpired"],!0,!0,!1,!0,Kb));this.KOa=!0;this.Fpd()}}Ell(){this.fzc&&(this.Wd.Rg(this.$Gd),this.fzc=!1)}HAi(){this.$Gd=new Qb.a(2,2,1E3*this.fjf,Object(A.a)(this,this.Zql,"tokenRefreshPolling"),135);this.Wd.Eb(this.$Gd)}Zql(){const Ia=this.zj.wAk;r.ULS.sendTraceTag(555255521,217,50,"{0}",ua.c(Ia));this.Oa.raiseEvent(Xa.o0e,new Zb(Ia,Ia[rb.eJe],Ia[rb.iPc],Ia[rb.Jkd],Ia[rb.failed],
Ia[rb.XZa],Ia[rb.Vkd]))}vDk(){3E5<+new Date-+this.Yef?(r.ULS.sendTraceTag(528867867,217,50,"Attempting pre-emptive token refresh."),this.L6b(!1)):r.ULS.sendTraceTag(528867868,217,50,"Last Token Refresh was performed less than 5 mins ago. Not refreshing token.")}}Xa.JKb="SE";Xa.KKb="SEP";Xa.dza="SER";Xa.o0e="TRP";Object(k.a)(Xa,"ASessionExpirationManagerWithRefresh",null,[]);class Lb extends Xa{constructor(Ia,nb,Kb=null,dc=null){super(nb,Kb,dc);this.JP=null;this.PH=Ia}sWe(Ia){this.Apb=Ia}rWe(Ia){this.zpb=
Ia}YWe(Ia){if(!this.JP&&!Tb.a.Ww){if(Ia){var nb=Object(A.a)(this,this.cub,"disposeCallback");this.JP=eb(e.AFrameworkApplication.kKb,!1,Object(A.a)(this,this.IKb,"sessionExpirationHandler"),nb)}else if(this.zpb){if(this.$Bc)return;nb=Object(A.a)(this,this.cub,"disposeCallback");this.JP=eb(e.AFrameworkApplication.hm,!1,Object(A.a)(this,this.IKb,"sessionExpirationHandler"),nb)}r.ULS.sendTraceTag(39408096,217,50,"Raising event: [{0}] IsScheduledShutdown: [{1}]",Xa.KKb,Ia);this.Oa.raiseEvent(Xa.KKb)}}Fpd(){this.JP&&
(this.JP.aYc()&&this.JP.j7b(),this.JP=null);if(this.Apb){this.zj.stop();if(this.Uha&&this.Uha.zab)return;const Ia=Object(A.a)(this,this.cub,"disposeCallback");this.JP=eb(e.AFrameworkApplication.hm,!0,Object(A.a)(this,this.IKb,"sessionExpirationHandler"),Ia)}r.ULS.sendTraceTag(39408097,217,50,"Raising event {0}",Xa.JKb);this.Oa.raiseEvent(Xa.JKb)}cub(){this.JP=null}IKb(){this.PH.refreshDocument(null)}}Object(k.a)(Lb,"SessionExpirationManagerWithRefresh",Xa,[724,725]);class pc{constructor(Ia,nb,Kb=
null,dc=null){this.rof=!1;this.Ka=null;this.iNa=Ia;this.SNa=nb;this.zj=Kb||new Bc(Sb.a.instance);this.Uha=dc}create(){this.rof=e.AFrameworkApplication.Rz;if(!this.rof)return new lb(this.iNa);e.AFrameworkApplication.fk("WOPITokenRefreshIsEnabled");r.ULS.sendTraceTag(39408088,217,50,"App has requested custom Session Expiration Manager");if(!this.Ka)switch(e.AFrameworkApplication.GEl){case 1:r.ULS.sendTraceTag(39408090,217,50,"Creating new NullSessionExpirationManager");this.Ka=new Ob(this.iNa);break;
case 2:r.ULS.sendTraceTag(39408091,217,50,"Creating new SessionExpirationManagerWithRefresh");this.Ka=new Lb(this.iNa,this.SNa,this.zj,this.Uha);break;default:r.ULS.sendTraceTag(39408092,217,50,"Creating new legacy SessionExpirationManager"),this.Ka=new lb(this.iNa)}r.ULS.sendTraceTag(39408089,217,50,"Returning instance of Session Expiration Manager: {0}",Object.getType(this.Ka).getName());return this.Ka}}Object(k.a)(pc,"SessionExpirationManagerFactory",null,[723]);var fc=d(1186),bd=d(22);class od{}
Object(k.a)(od,"Error",null,[]);class ye{}Object(k.a)(ye,"NamedResult",null,[]);class pd extends ye{}Object(k.a)(pd,"ErrorInfo",ye,[]);var ab=d(104),Yb=d(173),Sc=d(124),Jb=d(704);class Oc{constructor(Ia,nb,Kb,dc=null,Ic=!1,Id=null,ae=!1,Od=!1){this.PAa=0;this.Gqa=this.Tm=null;this.YDc=new Fb.a;this.bha=new Fb.a;this.Vv=null;this.gTb=!1;this.HWb=this.IWb=null;this.Wd=Ia;this.ljf=nb;this.ljf.execute(Hd=>{Hd.zB(Sc.a.wbe,Object(A.a)(this,this.ppk,"onHostResponseReceived"))});this.oS=Kb;this.Qnf=new Jb.a("WebServiceCall",
"TokenRefresh");this.zj=dc||new Bc(Ia);this.GZh=Ic;this.zqa=Id?Id:bc.SessionStatusManager.instance;this.S9e=ae;this.jxc=Od}ppk(Ia){if(Ia.MessageId!==Sc.a.wbe)fa.c(39408099,306,15,"Unexpected message.");else{var nb=new Fb.a,Kb=new Fb.a;this.zj.Nxb(rb.Vkd);var dc=Ia.Values[Yb.a.Coh];if(!dc||0>=dc.length)fa.c(40122317,306,15,"Found no tokens in the dictionary"),dc=Ia.Values;fa.c(40122318,306,100,"The Tokens array contains {0} tokens",dc.length);this.zj.FY("Correlation",Ia.CorrelationId);var Ic="";for(let Od=
0;Od<dc.length;Od++){this.zj.jTe(rb.tokens,dc.length);var Id=dc[Od],ae=Id;if(!ae||!ae.Name)continue;this.zj.Nxb(ae.Name);const Hd=Id;if(Hd&&Hd.Value)fa.c(39408128,306,100,"Received token with name: {0}",Hd.Name),nb.add(Hd),this.YDc.add(Hd),this.jxc||this.zj.FY(rb.status,rb.success),this.S9e&&this.zqa&&this.zqa.bYk();else if(Id=this.Hgj(Id),fa.c(39408129,306,15,"Received error for token {0}. Creating error object from {1}, TaskId {2}",ae.Name,JSON.stringify(Id),this.Gqa),Kb.add(Id),this.jxc||(this.bha.add(Id),
Ic=JSON.stringify(Id),this.zj.FY(rb.error,JSON.stringify(Id)),this.zj.FY(rb.status,rb.failed)),this.S9e)for(const Bf of Id.Errors)ae=this.X7i(Bf),this.zqa&&this.zqa.n7h(ae)}this.jxc?(0<Kb.count?this.HWb?this.HWb(new wb(nb,Kb)):fa.c(512267295,306,15,"Received errors but the promise has completed"):this.IWb?this.IWb(new wb(nb,Kb)):fa.c(512267294,306,15,"Received valid tokens but the promise has completed"),fa.c(512344162,306,50,"Received new tokens response. {0} tokens and {1} errors. Correlation {2}, TaskId {3}",
nb.count,Kb.count,Ia.CorrelationId,this.Gqa)):(0<Kb.count&&""!==Ic?(dc=Object.assign(new cb.a,{extendedProperties:new Map}),dc.extendedProperties.set("Errors",Ic),dc.extendedProperties.set("RetryCount",this.PAa.toString()),dc.extendedProperties.set("NavigatorOnline",window.navigator.onLine.toString()),dc.extendedProperties.set("IsTokenExpiring",this.gTb.toString()),Ad.Health.instance.recordKpiFailure("WACTokenRefresh","TokenRefreshFailed",!1,!1,dc)):Ad.Health.instance.recordKpiSuccess("WACTokenRefresh",
null),fa.c(39408130,306,50,"Received new tokens response. {0} tokens and {1} errors. Correlation {2}, TaskId {3}",nb.count,Kb.count,Ia.CorrelationId,this.Gqa),0<Kb.count&&!this.H9b(Kb)?(Ia=this.oS.E3f(Kb),Ia!==this.oS.YJb&&(this.zj.jTe(rb.Wkh,Ia),this.Wd.G5(this.Tm,Ia))):(this.zj.flush(),this.Tm&&(fa.c(39408131,306,100,"Deleting task {0} from task manager",this.Tm.name),this.Wd.Rg(this.Tm)),this.Vv&&!this.Vv.task.isCompleted?this.Vv.Fg(new wb(nb,Kb)):fa.c(512267293,306,15,"Received results but the task has completed")))}}Hgj(Ia){if(!Ia)return null;
const nb=Object.assign(new pd,{Name:Ia.Name,Errors:[]});for(const Kb of Ia.Errors)Ia=new od,Ia.Id=Kb.Id,Ia.Details=na.a.gTc(Kb.Details,500),nb.Errors.push(Ia);return nb}requestTokensOnce(){this.Yjh()}Yjh(){e.AFrameworkApplication.PFa("SendSynchronousPostMessage;SendSynchronousPostMessageIsEnabledCf");this.PAa>=this.oS.YXg?(fa.c(39408132,306,15,"Too many attempts to refresh tokens. Aborting. TaskId {0}",this.Gqa),this.eCi(this.Vv)):(Ad.Health.instance.recordKpiUsage("WACTokenRefresh",1,"wwrelfc",null),
this.$nh())}$nh(){const Ia={};Ia[Yb.a.Coh]=this.oS.tokens;const nb=ab.a.create().toString();fa.c(39408133,306,50,"Refreshing tokens {0}. Attempt {1}. Correlation {2}. TaskId {3}.",JSON.stringify(this.oS.tokens),this.PAa+1,nb,this.Gqa);this.ljf.execute(Kb=>{Kb.sendMessage(Sc.a.lPd,Ia,nb)});this.PAa++;this.zj.Nxb(rb.XZa)}eCi(Ia){const nb=new Fb.a;for(let Kb=0;Kb<this.oS.tokens.length;Kb++){const dc=Object.assign(new pd,{Name:this.oS.tokens[Kb],Errors:[Object.assign(new od,{Id:"TOO_MANY_ATTEMPTS",Details:"We did not receive a new token from the host after the maximum allowed number of attempts"})]});
nb.add(dc);this.bha.add(dc)}this.Wd.Rg(this.Tm);this.zj.FY(rb.y0d,JSON.stringify(this.bha));this.zj.FY(rb.status,rb.failed);Ia&&!Ia.task.isCompleted&&Ia.Fg(new wb(new Fb.a,this.bha))}mOk(Ia){this.Qnf.start();this.gTb=Ia;this.Gqa=ab.a.create().toString();fa.c(41755338,306,50,"RefreshTokens Start, TaskId: [{0}]. IsTokenExpiring: [{1}].",this.Gqa,this.gTb);this.PAa=0;this.bha.clear();this.YDc.clear();this.Vv=new Na.a;this.jxc?this.Zjh(this.oS.YXg).then(nb=>{this.Vv&&!this.Vv.task.isCompleted&&this.Vv.Fg(nb);
this.HWb=this.IWb=null;this.zj.FY(rb.y0d,JSON.stringify(this.bha));this.zj.FY(rb.status,rb.success);this.zj.flush()}).catch(nb=>{this.Vv&&!this.Vv.task.isCompleted&&this.Vv.Fg(Object(fc.a)(750,nb));this.HWb=this.IWb=null;this.zj.FY(rb.y0d,JSON.stringify(this.bha));this.zj.FY(rb.status,rb.failed);this.zj.flush()}):(this.Tm=new Qb.a(this.oS.priority,2,this.oS.YJb,Object(A.a)(this,this.requestTokensOnce,"requestTokensOnce"),98,Sc.a.lPd,!0),this.GZh&&this.Yjh(),this.Wd.Eb(this.Tm));return this.Vv.task}Zjh(Ia){const nb=
this,Kb=new Promise((Od,Hd)=>{nb.IWb=Od;nb.HWb=Hd;Ad.Health.instance.recordKpiUsage("WACTokenRefresh",1,"wwrelfc",null);nb.$nh()}),dc=this,Ic=new Promise((Od,Hd)=>{window.setTimeout(()=>{Hd(dc.PHf("TIMEOUT","We did not receive a new token from the host after the maximum allowed time"))},dc.oS.YJb)});let Id=Ia;const ae=this;return new Promise((Od,Hd)=>{Id--;Promise.race([Kb,Ic]).then(Bf=>{Ad.Health.instance.recordKpiSuccess("WACTokenRefresh",null);Od(Bf)}).catch(Bf=>{var Of=ae.oS.YJb;if(Object(bd.a)(750,
Bf)&&(Bf=Object(fc.a)(750,Bf),0<Bf.errors.count)){ae.t0j(Bf.errors);ae.qqf(Bf.errors);if(ae.H9b(Bf.errors)){Hd(Bf);return}const ph=ae.oS.E3f(Bf.errors);ph!==ae.oS.YJb?(ae.zj.jTe(rb.Wkh,ph),Of=ph):ae.qUj(Bf.errors)&&(Of=0)}Id?window.setTimeout(()=>{ae.Zjh(Id).then(Od).catch(Hd)},Of):(Of=ae.PHf("TOO_MANY_ATTEMPTS","We did not receive a new token from the host after the maximum allowed number of attempts"),ae.qqf(Of.errors),Hd(Of),fa.c(512267292,306,15,"Too many attempts to refresh tokens. Aborting. TaskId {0}",
ae.Gqa))})})}qqf(Ia){for(let nb of Ia)this.bha.add(nb)}qUj(Ia){if(!Ia.count)return!1;Ia=Ia.ga(Ia.count-1);return Ia.Errors.length?"TIMEOUT"==Ia.Errors[0].Id:!1}PHf(Ia,nb){const Kb=new Fb.a;for(let dc=0;dc<this.oS.tokens.length;dc++){const Ic=this.fCi(this.oS.tokens[dc],Ia,nb);Kb.add(Ic)}return new wb(new Fb.a,Kb)}fCi(Ia,nb,Kb){return Object.assign(new pd,{Name:Ia,Errors:[Object.assign(new od,{Id:nb,Details:Kb})]})}t0j(Ia){if(Ia.count){Ia=Ia.ga(Ia.count-1);Ia=JSON.stringify(Ia);var nb=Object.assign(new cb.a,
{extendedProperties:new Map});nb.extendedProperties.set("Errors",Ia);nb.extendedProperties.set("RetryCount",this.PAa.toString());nb.extendedProperties.set("NavigatorOnline",window.navigator.onLine.toString());nb.extendedProperties.set("IsTokenExpiring",this.gTb.toString());Ad.Health.instance.recordKpiFailure("WACTokenRefresh","TokenRefreshFailed",!1,!1,nb);this.zj.FY(rb.error,Ia);this.zj.FY(rb.status,rb.failed)}}VFk(Ia){this.Qnf.stop();const nb=this.iwj(Ia.result.errors);r.ULS.sendTraceTag(41755339,
217,50,"ProcessTokensOrErrors: TokenRefreshResult:{0},TaskId:{1},IsTriggerByTokenExpiring:{2},RetryCount:{3},TotalErrorCount:{4},LastErrorName:{5},LastErrorId:{6},LastErrorDetail:{7}",!nb,this.Gqa,this.gTb,this.PAa,this.bha.count,0<Ia.result.errors.count?Ia.result.errors.ga(0).Name:"",0<Ia.result.errors.count&&0<Ia.result.errors.ga(0).Errors.length?Ia.result.errors.ga(0).Errors[0].Id:"",0<Ia.result.errors.count&&0<Ia.result.errors.ga(0).Errors.length?Ia.result.errors.ga(0).Errors[0].Details:"");return nb?
!1:this.UFk(Ia.result.tokens)}H9b(Ia){return this.oS.H9b(Ia)}UFk(Ia){for(let nb=0;nb<Ia.count;nb++){const Kb=Ia.ga(nb);if(Kb.Name===Yb.a.accessToken){const dc=(new Date).getTime();Kb.Expiry>e.AFrameworkApplication.hm?(r.ULS.sendTraceTag(39706827,217,50,"Updating AccessToken: {0}",{["AccessTokenTtl"]:Kb.Expiry,["NowGetTime"]:dc,["BootTime"]:e.AFrameworkApplication.bca},"PreviousAccessTokenTtl",e.AFrameworkApplication.hm),e.AFrameworkApplication.accessToken=Kb.Value,e.AFrameworkApplication.hm=Math.floor(Kb.Expiry),
e.AFrameworkApplication.n4e=dc,e.AFrameworkApplication.t7=Math.floor(Kb.Expiry)):r.ULS.sendTraceTag(39706828,217,15,"Ignoring AccessToken because it expires sooner than the current one: {0}",{["AccessTokenTtl"]:Kb.Expiry,["NowGetTime"]:dc,["BootTime"]:e.AFrameworkApplication.bca},"PreviousAccessTokenTtl",e.AFrameworkApplication.hm)}}return!0}iwj(Ia){let nb=!1;for(let Kb=0;Kb<Ia.count;Kb++){nb=!0;const dc=Ia.ga(Kb);r.ULS.sendTraceTag(39706829,217,15,"Received error for token {0}. Errors: {1}. TaskId: {2} ",
dc.Name,JSON.stringify(dc.Errors),this.Gqa)}return nb}X7i(Ia){let nb=Hc.a.sessionAccessTokenExpired;Ia=parseInt(Ia.Id);if(isNaN(Ia))nb=Hc.a.KEl;else{switch(Ia){case 401:nb=Hc.a.NEl;break;case 403:nb=Hc.a.IEl;break;case 500:nb=Hc.a.JEl;break;case 503:nb=Hc.a.MEl}nb===Hc.a.sessionAccessTokenExpired&&(nb=500<Ia?Hc.a.LEl:Hc.a.HEl)}return nb}}Object(k.a)(Oc,"TokenRefreshManager",null,[722]);class Wb{constructor(){this.YJb=e.AFrameworkApplication.QEl;this.YXg=e.AFrameworkApplication.OEl;this.tokens=e.AFrameworkApplication.Gnj();
this.priority=e.AFrameworkApplication.REl;this.Ikf=this.K8k();this.mMd=e.AFrameworkApplication.Fnj()}H9b(Ia){Ia=JSON.stringify(Ia);if(this.mMd&&0<this.mMd.length)for(const nb of this.mMd)if(0<nb.length&&0<=Ia.indexOf(nb))return!0;return!1}E3f(Ia){try{if(Ia)for(let nb of Ia)if(nb.Errors)for(const Kb of nb.Errors)if(Kb.Id in this.Ikf)return Number.parseInvariant(this.Ikf[Kb.Id].toString())}catch(nb){r.ULS.sendTraceTag(41501720,217,50,"TokenRefreshPolicy:GetRetryIntervalOverride, exception:{0}",nb.toString())}return this.YJb}K8k(){const Ia=
{};try{if(!e.AFrameworkApplication.fUc()||0>=e.AFrameworkApplication.fUc().length||""===e.AFrameworkApplication.fUc()[0])return Ia;for(const nb of e.AFrameworkApplication.fUc())0<nb.length&&(Ia[nb]=e.AFrameworkApplication.PEl)}catch(nb){r.ULS.sendTraceTag(41755340,217,50,"TokenRefreshPolicy:SetRetryIntervalForNetworkIssue, exception:{0}",nb.toString())}return Ia}}Object(k.a)(Wb,"TokenRefreshPolicy",null,[721]);class Ab{constructor(){this.Da=null}get name(){return"Common.App.SessionExpiration"}init(){e.AFrameworkApplication.fa.jf(()=>
{this.BEa()})}BEa(){this.Da.resolve("Common.ISessionExpirationManagerFactory");this.Da.resolve("Common.ISessionExpirationManager");this.Da.resolve("Common.ISessionExpirationManagerWithDialog")}dispose(){}$b(Ia){this.Da=Ia;Ia.register(720,"Common.App.SessionExpiration.ISessionLogger").ma().oa(()=>new Bc(Sb.a.instance));Ia.register(721,"Common.App.SessionExpiration.ITokenRefreshPolicy").ma().oa(()=>new Wb);Ia.register(722,"Common.App.SessionExpiration.ITokenRefreshManager").ma().oa(()=>new Oc(Sb.a.instance,
e.AFrameworkApplication.gT(),Ia.resolve("Common.App.SessionExpiration.ITokenRefreshPolicy"),Ia.resolve("Common.App.SessionExpiration.ISessionLogger"),e.AFrameworkApplication.fa.ka("WopiTokenRefreshSendTokenRequestWithoutTasks"),Ia.rb("Common.ISessionStatus"),e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.ReportLastKnownTokenRefreshError",!1),e.AFrameworkApplication.fa.ka("WopiTokenRefreshSyncMessageWithTimeout")));Ia.register(723,"Common.ISessionExpirationManagerFactory").ma().oa(()=>
new pc(e.AFrameworkApplication.Aa,Ia.resolve("Common.App.SessionExpiration.ITokenRefreshManager"),Ia.resolve("Common.App.SessionExpiration.ISessionLogger"),Ia.rb("Common.ISessionStatus")));Ia.register(724,"Common.ISessionExpirationManagerWithDialog").ma().oa(()=>Ia.resolve("Common.ISessionExpirationManagerFactory").create());Ia.register(725,"Common.ISessionExpirationManager").ma().oa(()=>Ia.resolve("Common.ISessionExpirationManagerWithDialog"))}static main(){n.a.instance.Dc(new Ab)}}Object(k.a)(Ab,
"SessionExpirationPackage",null,[2,3]);var Xb=d(54),vb=d(438),$c=d(37),fd=d(153),Bd=d(119),gd=d(133),Pd=d(58),cd=d(26),lf=d(34),Jd=d(28);class Xf extends Tb.a{constructor(Ia,nb){super();this.Sea=null;this.e4j=!1;this.$4j="";this.IFg=this.JFg=this.Mqg=this.Nqg=null;this.xd=3;this.Xe(1,ResourceStrings.L_SetSlideOrientationMaximize);this.Xe(2,ResourceStrings.L_SetSlideOrientationEnsure);this.ia=Ia;this.BGg=nb.pk(Pd.a.nzk)}dispose(){this.Sea=null;super.dispose()}showDialog(Ia){this.$i(Ia);this.Nqg=document.getElementById("btnMaximize");
this.JFg=Object(A.a)(this,this.xsk,"onScaleUpButton");E.a.addHandler(this.Nqg,"click",this.JFg);this.Mqg=document.getElementById("btnEnsure");this.IFg=Object(A.a)(this,this.wsk,"onScaleDownButton");E.a.addHandler(this.Mqg,"click",this.IFg)}$i(Ia){this.$pa=Object(A.a)(this,this.v9k,"setSlideOrientationRatio");this.kya(Ia);this.fm.style.width="420px";this.show()}hide(){this.Gb&&(e.AFrameworkApplication.Aa.Jw.Ho(Bd.AFrame.i5),super.hide())}xsk(Ia){this.ia.processAction(Jd.a.Bpc,2);Ia.preventDefault();
this.GV&&this.hide()}wsk(Ia){this.ia.processAction(Jd.a.Apc,2);Ia.preventDefault();this.GV&&this.hide()}v9k(Ia){1===Ia?this.ia.processAction(Jd.a.Bpc,2):2===Ia?this.ia.processAction(Jd.a.Apc,2):cd.a.J(25277209,822,50,"Cancle the slide orientation change.");this.GV&&this.hide()}kya(){this.ju();this.tA()}ju(){super.ju();Sys.UI.DomElement.addCssClass(this.Gb,this.$4j);var Ia=$get("WACDialogTitleText");Ia.innerText=ResourceStrings.l_SetSlideScaleTitle;Ia.setAttribute("title",ResourceStrings.l_SetSlideScaleTitle);
Ia=document.createElement("div");Ia.id=this.Nh("WACDialogHtmlPanel");Ia.className="WACDialogHtmlPanel";this.fm.appendChild(Ia);this.Sea=document.createElement("div");this.Sea.id=this.Nh("WACDialogText");Ia.appendChild(this.Sea);Ia=document.createElement("div");Ia.id=this.Nh("Scalediv");Ia.className="WACDialogRow";this.Sea.appendChild(Ia);var nb=document.createElement("label");nb.id=this.Nh("Scalelabel");nb.innerText=ResourceStrings.L_SetSlideOrientationInformation;Ia.appendChild(nb);Ia=document.createElement("div");
Ia.id=this.Nh("ScaleMode");Ia.setAttribute("style","margin-left: 20px;");Ia.className="WACDialogRow";this.Sea.appendChild(Ia);nb=Xf.UHf(Pd.a.G9g+"_MaximizeFit_170x130x32",this.BGg,ResourceStrings.L_SetSlideOrientationMaximize);nb.id=this.Nh("btnMaximize");var Kb=document.createElement("td");Kb.className=String.format("clip{0}x{1}","170","130");Kb.setAttribute("style","border: #ccc 1px solid");Kb.appendChild(nb);nb=Xf.UHf(Pd.a.G9g+"_Ensurefit_170x130x32",this.BGg,ResourceStrings.L_SetSlideOrientationEnsure);
nb.id=this.Nh("btnEnsure");var dc=document.createElement("td");dc.className=String.format("clip{0}x{1}","170","130");dc.setAttribute("style","border: #ccc 1px solid");dc.appendChild(nb);var Ic=document.createElement("td");Ic.setAttribute("style","width: 30px;");nb=document.createElement("tr");nb.appendChild(Kb);nb.appendChild(Ic);nb.appendChild(dc);Kb=document.createElement("td");Kb.setAttribute("align","center");dc=document.createElement("label");dc.id=this.Nh("Maxlabel");dc.className="UIFontBold";
dc.innerText=ResourceStrings.L_SetSlideOrientationMaximize;Kb.appendChild(dc);dc=document.createElement("td");dc.setAttribute("align","center");Ic=document.createElement("label");Ic.id=this.Nh("Ensurelabel");Ic.className="UIFontBold";Ic.innerText=ResourceStrings.L_SetSlideOrientationEnsure;dc.appendChild(Ic);const Id=document.createElement("td");Id.setAttribute("style","width: 30px;");Ic=document.createElement("tr");Ic.appendChild(Kb);Ic.appendChild(Id);Ic.appendChild(dc);Kb=document.createElement("table");
Kb.appendChild(nb);Kb.appendChild(Ic);Ia.appendChild(Kb)}tA(){this.Npd(Tb.a.jlc+(Tb.a.DU-Xf.mli)/2-12,Tb.a.ilc+(Tb.a.uR-Xf.rli)/2-12)}Npd(Ia,nb){this.Gb.style.top=(0>Ia?0:Ia)+"px";lf.a("DeprecateIE.SetSlideOrientation")?this.Gb.style.left=(0>nb?0:nb)+"px":Xb.a.wab&&e.AFrameworkApplication.isRtl?this.Gb.style.right=(0>nb?0:nb)+"px":this.Gb.style.left=(0>nb?0:nb)+"px";this.e4j||(this.Gb.style.width=String.format("{0}em",this.width));this.Gb.style.display="Block"}static UHf(Ia,nb,Kb){const dc=document.createElement("img");
dc.className=Ia;dc.setAttribute("Unselectable","on");dc.setAttribute(gd.a.af,gd.a.fN);dc.src=nb;Kb&&(dc.alt=Kb,dc.title=Kb);return dc}}Xf.rli=350;Xf.mli=200;Object(k.a)(Xf,"SetSlideOrientationDialog",Tb.a,[]);var ee=d(50),Ra=d(109),sb=d(244),ec=d(70);class Lc extends T.a{constructor(Ia,nb){super(!1,!1,!0);this.oGf=this.Z2=null;if(!Ia)throw Error.argumentNull("actionManager");if(!nb)throw Error.argumentNull("presentationReader");this.ia=Ia;this.qc=nb}CEa(){this.Z2=Object(A.a)(this,this.w9k,"setSlideSizeAndLayoutDialogResultHandler");
this.oGf=this.Z_i(this.getCurrentSlideDimensions());this.$i(ResourceStrings.L_SetSlideSize,this.Z2,this.oGf)}w9k(Ia,nb){1===Ia&&this.ia.La(Jd.a.Xqh,2,nb);this.dispose()}getCurrentSlideDimensions(){const Ia=this.qc.zu(),nb={};nb.height=Ia.height;nb.width=Ia.width;nb.slideType=this.qc.Dij();return nb}Z_i(Ia){return{["id"]:"SlideSizeAndLayoutDialog",["bodyControls"]:Ia,["numberFormatInfo"]:ec.e().numberFormatInfo}}}Object(k.a)(Lc,"SlideSizeAndLayoutDialog",T.a,[]);class nd{constructor(Ia,nb,Kb,dc,Ic,
Id,ae,Od,Hd){this.ZHa=this.wma=this.oU=0;this.slideSizeType="O_screen4x3 O_letterPaper O_A4paper O_35mm O_overhead O_banner O_custom O_ledgerPaper O_A3Paper O_B4ISOPaper O_B5ISOPaper O_B4JISPaper O_B5JISPaper O_HagakiCard O_screen16x9 O_screen16x10 O_Widescreen".split(" ");this.dwh=[4320,4320,4320,4320,4320,576,4896,5754,6048,5115,3387,5184,3456,1872,3240,3600,4320];this.qwh=[5760,5760,6240,6480,5760,4608,6336,7672,8064,6820,4516,6912,4608,2880,5760,5760,7680];this.ia=Ia;this.Fa=nb;this.ff=Kb;this.Jb=
dc;this.Vb=Ic;this.ua=Id;this.pa=Od;this.qc=ae;this.je=Hd}vb(){this.ia.ra(Jd.a.Iid,ee.a.application,Object(A.a)(this,this.qMe,"querySlideSize"),96);this.ia.ra(Jd.a.Hid,ee.a.application,Object(A.a)(this,this.qMe,"querySlideSize"),96);this.ia.ra(Jd.a.rMe,ee.a.application,Object(A.a)(this,this.qMe,"querySlideSize"),96);this.ia.ya(Jd.a.y9k,ee.a.application,vb.a.ZG);this.ia.ra(Jd.a.AHk,ee.a.application,vb.a.W0,96);this.ia.ra(Jd.a.Dpc,ee.a.application,Object(A.a)(this,this.Fuj,"handleSetSlideSize"),4);
this.ia.ra(Jd.a.cod,ee.a.application,Object(A.a)(this,this.Huj,"handleSetSlideSize4x3"),4);this.ia.ra(Jd.a.bod,ee.a.application,Object(A.a)(this,this.Guj,"handleSetSlideSize16x9"),4);this.ia.ra(Jd.a.xHe,ee.a.application,Object(A.a)(this,this.AXj,"launchSlideSizeAndLayoutDialogHandler"),4);this.ia.ra(Jd.a.mvk,ee.a.application,Object(A.a)(this,this.Mmg,"launchSetSlideOrientationScaleTypeDialogHandler"),4);this.ia.ra(Jd.a.nvk,ee.a.application,Object(A.a)(this,this.Mmg,"launchSetSlideOrientationScaleTypeDialogHandler"),
4);this.ia.ra(Jd.a.Bpc,ee.a.application,Object(A.a)(this,this.Wqh,"setSlideOrientationHandler"),4);this.ia.ra(Jd.a.Apc,ee.a.application,Object(A.a)(this,this.Wqh,"setSlideOrientationHandler"),4);this.ia.ra(Jd.a.Xqh,ee.a.application,Object(A.a)(this,this.x9k,"setSlideSizeAndLayoutHandler"),4);this.ia.ya(Jd.a.z9k,ee.a.application,vb.a.ZG);this.ia.ya(Jd.a.setSlideHeight,ee.a.application,vb.a.ZG);this.ia.ra(Jd.a.CHk,ee.a.application,vb.a.W0,96);this.ia.ra(Jd.a.BHk,ee.a.application,vb.a.W0,96);this.ia.ya(Jd.a.Xjl,
ee.a.application,vb.a.ZG);this.ia.ya(Jd.a.Wjl,ee.a.application,vb.a.ZG)}De(){}qMe(Ia,nb,Kb,dc,Ic){cd.a.J(34936782,822,50,"Click slide size drop down.");if(nb.contextId!==ee.a.application)return 2;if(nb=Object(fc.a)(Ra.a,Ic))Ia=nd.WJj(this.qc.zu(),Ia),nb.Qf(Ia);return 32}AXj(Ia,nb,Kb){nb=this.ua.Ba;return!nb||this.ff.$c(nb)||!lf.a("DeprecateIE.CustomizeSlideSizeActor")&&Xb.a.hx?8:1===Kb?32:fd.a("CustomizeSlideSizeActor::LaunchSetSlideSizeAndLayoutDialogHandler ",Ia,()=>{(new Lc(this.ia,this.qc)).CEa();
cd.a.J(557158615,822,50,"Open set slide size and layout dialog.");return 32})}Mmg(Ia,nb,Kb,dc,Ic){Ia=this.ua.Ba;if(!Ia||this.ff.$c(Ia))return 16;if(1===Kb)return 32;if("slideType"in Ic&&"slideWidth"in Ic&&"slideHeight"in Ic)if(this.ZHa=6,"o_custom"===Ic.slideType.toString().toLowerCase())this.oU=6*Math.round(Ic.slideWidth),this.wma=6*Math.round(Ic.slideHeight);else{Kb=0;for(const Id of this.slideSizeType){if(Ic.slideType.toString().toLowerCase()===Id.toLowerCase()){this.ZHa=Kb;break}Kb++}"landscape"===
Ic.orientation.toString()?(this.wma=this.dwh[Kb],this.oU=this.qwh[Kb]):(this.oU=this.dwh[Kb],this.wma=this.qwh[Kb])}(new Xf(this.ia,this.je)).showDialog(ResourceStrings.l_SetSlideScaleTitle);cd.a.J(34936786,822,50,"Open set slide scale type dialog.");return 32}Fuj(Ia,nb,Kb){Ia=this.ua.Ba;return!Ia||this.ff.$c(Ia)?8:this.ia.processAction(Jd.a.F7a,Kb)}Huj(Ia,nb,Kb){cd.a.J(34936788,822,50,"click set slide size 4:3.");nb=this.ua.Ba;if(!nb||this.ff.$c(nb))return 16;if(1===Kb||960===this.qc.zu().width)return 32;
this.oU=5760;this.wma=4320;this.ZHa=0;return this.qLb(this.oU,this.wma,Ia,this.ZHa,"EnsureFit")}Guj(Ia,nb,Kb){cd.a.J(34936792,822,50,"click set slide size 16:9.");nb=this.ua.Ba;if(!nb||this.ff.$c(nb))return 16;if(1===Kb)return 32;Kb=this.qc.zu();if(1280===Kb.width)return 32;this.oU=7680;this.wma=4320;this.ZHa=16;return 960===Kb.width&&720===Kb.height?this.qLb(this.oU,this.wma,Ia,this.ZHa,""):this.qLb(this.oU,this.wma,Ia,this.ZHa,"EnsureFit")}x9k(Ia,nb,Kb,dc,Ic){nb=this.ua.Ba;return!nb||this.ff.$c(nb)?
8:1===Kb?32:this.qLb(Ic.width,Ic.height,Ia,Ic.slideType,Ic.slideScaleType)}Wqh(Ia,nb,Kb){nb=this.ua.Ba;return!nb||this.ff.$c(nb)?16:1===Kb?32:this.wma&&this.oU?Ia===Jd.a.Bpc?this.qLb(this.oU,this.wma,Ia,this.ZHa,"Maximize"):Ia===Jd.a.Apc?this.qLb(this.oU,this.wma,Ia,this.ZHa,"EnsureFit"):32:(cd.a.J(34936796,822,10,"CustomizeSlideSizeActor::SetSlideOrientationHandler fail to get slide width/height."),8)}qLb(Ia,nb,Kb,dc,Ic){const Id=this.ua.Ba;let ae=!1;if(Id){var Od=Id.Pk();if(Od&&0<Od.length)for(const Hd of Od)if(Hd.TEa){ae=
!0;break}}Od=this.Jb.zd(15,void 0,()=>{this.Fa.Ed();this.pa.Qh()});try{Od.kd(Id),Od.jd=Kb,Od.Py[sb.a.ixb]=ae,Id.setValue($c.a.slideWidth,Ia),Id.setValue($c.a.slideHeight,nb),Id.setValue($c.a.slideScaleType,Ic),Id.setValue($c.a.slideSizeType,dc)}finally{Od&&Od.dispose()}cd.a.J(34936798,822,50,"Set slide width: {0}, height: {1}, scale type: {2}.",Ia,nb,Ic);this.ff.WYb(this.Vb.Cf,Id,Kb);return 32}static WJj(Ia,nb){Ia=Ia.width/Ia.height;switch(nb){case Jd.a.Iid:return.01>Math.abs(Ia-1.33);case Jd.a.Hid:return.01>
Math.abs(Ia-1.77);default:return!1}}}Object(k.a)(nd,"CustomizeSlideSizeActor",null,[227]);class Fd{}Fd.skh=0;Fd.OXk=22711;Object(k.a)(Fd,"ImageConstants",null,[]);var Ja=d(230),db=d(321),ic=d(442),id=d(41),qd=d(100),Fc=d(242),Ze=d(108);class df extends Ze.a{constructor(){super();this.ImageToken=null;this.ErrorCode=0}$k(){return 78}}Object(k.a)(df,"NotifyImageUploadFailureRequest",Ze.a,[]);class ve{constructor(Ia,nb,Kb,dc,Ic,Id,ae,Od,Hd,Bf,Of,ph,Qh,Lg,Fg,dg,hi,Mg,ne,Bh,Vh,ij,Ij){this.XHa=this.FVa=
this.mJ=null;this.$Eb=!1;this.ork=(Yj,ii)=>{(Yj=w.a.instance.Ja("Common.ISystemInitiatedFeedback"))&&ii&&ii.eQj&&Yj.execute(Wh=>{Wh.logActivity("InsertPicture",null)})};this.ia=Ia;this.ob=Kb;this.fc=nb;this.ua=Ic;this.Jb=Id;this.Fa=dc;this.fB=ae;this.dR=Od;this.Tk=Hd;this.ywe=Bf;this.Hu=Of;this.Qd=ph;this.Fb=Qh;this.lye=Lg;this.Tdc=Fg;this.oWa=dg;this.vi=hi;this.Wj=Mg;this.Ga=ne;this.hl=Bh;this.Lc=Vh;this.aU=ne.SHb;this.Ea=ij;this.i8j=null===Ij||void 0===Ij?void 0:Ij.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.Pictures.InsertPictureFloodgateSurveyEnabled",
!1);this.Pu()}Pu(){this.i8j&&this.Lc.C9h(this.ork)}vb(){this.ia.ra(Jd.a.insertPicture,S.a.application,Object(A.a)(this,this.p8f,"handleInsertPicture"),4);this.ia.ra(Jd.a.XOc,S.a.view,Object(A.a)(this,this.zvj,"handleUploadPictureAll"),4);this.ia.ra(Jd.a.BIc,S.a.application,Object(A.a)(this,this.Dpj,"handleChangePicture"),4);this.ia.ra(Jd.a.Pkd,S.a.application,Object(A.a)(this,this.duj,"handleResetPicture"),4);this.ia.ra(Jd.a.qkh,S.a.application,Object(A.a)(this,this.euj,"handleResetPictureAndSize"),
4);this.ia.ra(Jd.a.rkh,S.a.application,Object(A.a)(this,this.fuj,"handleResetPictureSplitButton"),4);this.ia.ra(Jd.a.Fra,S.a.application,Object(A.a)(this,this.Epj,"handleChangePictureStyle"),4);this.ia.ra(Jd.a.a_d,S.a.application,Object(A.a)(this,this.p8f,"handleInsertPicture"),4);this.ia.ra(Jd.a.UNf,S.a.application,Object(A.a)(this,this.tqj,"handleDragAndInsertImage"),4)}De(){}p8f(Ia,nb,Kb){this.Ga.Hfg&&!lf.a("DummyChangeGateForTest")&&cd.a.J(512500500,830,100,"HandleInsertPicture::DummyChangeGateForTest is disabled");
nb=this.ua.Ba;nb=this.Ga.AZc&&!!nb&&!this.fc.$c(nb);nb=(this.Tdc=this.lye.yIj()&&this.Tdc)?nb&&!!this.fB&&this.fB.Ttd:this.dR.lgg&&nb;if(!nb)return 16;if(1===Kb)return 32;this.$Eb=!0;this.XHa=this.ua.Ba;this.Ipd(Ia!==Jd.a.a_d,!0);return 32}zvj(Ia,nb,Kb,dc,Ic){var Id=this.ua?this.ua.Ba:null;if(!Id||!Id.isConnected)return 16;if(!this.Wj.JF(Id,1))return this.Wj.hG(Id),16;cd.a.J(512500497,822,50,"Start picture upload");nb=ve.KTj(Ic);(dc=id.a.Ib)&&dc.Va(qd.a.uFj,nb?"1":"0");this.Lc.dLk();let ae=!1;if(this.$Eb&&
this.Tdc&&!this.fB.Mjb&&this.WNj(nb)){if(Id=Id.n3(this.ob.Xd())){if(15!==Id.Gj){const Od=Id.NU;Od.BottomLeft.X!==Od.TopLeft.X&&(ae=!0)}dc&&dc.Va(qd.a.SZk,ae?"1":"0")}Id&&(15===Id.Gj||ae)?(dc&&dc.Va(qd.a.w1d,ae?"PlaceHolder Rotated":"Picture Type PlaceHolder"),Ia=this.s9f(Ia,Kb,Ic)):Ia=this.Avj(Ia,Kb,Ic)}else this.fB.Mjb=!1,Ia=this.s9f(Ia,Kb,Ic);nb&&32===Ia&&cd.a.J(512500496,822,50,"Upload a svg file successfully.");return Ia}WNj(Ia){return Ia?this.Ga.powerPointInsertSVGFileLocalRenderingEnabled:!0}tqj(Ia,
nb,Kb,dc,Ic){if(!this.fB.Szk)return cd.a.J(512500495,822,15,"PictureActor::HandleDragAndInsertImage - PictureUploadLargeImageEnabled is false"),16;if(!Ic)return 16;Ia=[];nb=0;Kb=!1;for(const Id of Ic)if(nb++,"string"===typeof Id.type)if(Ic=na.a.og(Id.type),cd.a.J(512500494,822,50,"PictureActor::HandleDragAndInsertImage - No.{0} file  Size In Bytes:{1}; Tpye:{2} ",nb,Id.size,Ic),0<=Ic.indexOf("image")&&0===this.fB.jud(Id.name))if(Ia.length<this.Ga.powerPointDragInsertMultipleImageQuantityLimit)Array.add(Ia,
Id);else{this.hl.VK(19);break}else Kb||(this.hl.VK(18),Kb=!0);if(1>Ia.length)return cd.a.J(512500493,822,15,"PictureActor::HandleDragAndInsertImage - unlegal image format"),16;this.fB.SNi(Ia);return 32}s9f(Ia,nb,Kb){if(!(this.ua&&this.ua.Ba&&this.fB))return 16;if(1===nb)return 32;this.dR.Ugb=new Date;this.$Eb&&this.ob.ij();this.Fa.Ed();this.fc.blockContent(this.ua.presentation,Ia);const dc=id.a.Ib;this.fB.pYe(Kb,Ic=>{id.a.ZK(dc,()=>{cd.a.J(512500492,822,50,"Picture upload successful");this.Psj(Kb,
Ic,Ia);this.GVf()})},Ic=>{cd.a.J(512500491,822,10,"Upload picture failed");this.O6b(Ic.error);this.GVf()});return 32}Avj(Ia,nb,Kb){if(!(this.ua&&this.ua.Ba&&this.fB))return 16;if(1===nb)return 32;const dc=String.format("{0}{1}","client",ab.a.create().toString());cd.a.J(512500490,822,50,"Client generated imageToken:{0}, imageSize:{1}",dc,Kb.mL);this.dR.Vgi(dc);const Ic=id.a.Ib;Ic&&(nb="InsertPicture",this.$Eb||(nb="ChangePicture"),Ic.actionName=nb,Ic.Nj=!0);const Id=new Date;id.a.xk("PictureUploadStart",
id.a.nf(Id));id.a.xk("ImageSize",Kb.mL.toString());id.a.xk("ImageToken",dc);const ae=this.ua.Ba.sid;this.ia.La(Jd.a.ode,2,ae);this.fB.pYe(Kb,Od=>{id.a.ZK(Ic,()=>{cd.a.J(512500489,822,50,"Upload picture completed");id.a.xk("PictureUploadDurationMS",(+new Date-+Id).toString());this.Rzk(dc,Od);this.ia.La(Jd.a.FWc,2,ae)})},Od=>{this.dR.KPf(dc);var Hd=Object.assign(new df,{ImageToken:dc,ErrorCode:Od.error.Code});Ic&&Ic.Va("UploadPictureErrorCode",Ja.a[Hd.ErrorCode]);Hd=new Fc.a(Hd,null,()=>ve.Jqk());this.vi.Eb(Hd);
cd.a.J(512500488,822,10,"Upload picture failed, ImageToken:{0}, ErrorCode:{1}, Error Message:{2}",dc,Ja.a[Od.error.Code],Od.error.Message);this.ia.La(Jd.a.FWc,2,ae)},dc);this.insertPicture(dc,Ia,Kb);return 32}Dpj(Ia,nb,Kb){Ia=this.aU?this.f9a():this.ewb();if(!(this.aU?this.I9b(Ia):this.Mig(Ia)&&this.Ga.AZc&&this.dR.lgg&&!this.fc.$c(Ia)))return 16;if(1===Kb)return 32;this.$Eb=!1;this.Ipd(!0,!1);return 32}duj(Ia,nb,Kb){return this.Fra(nb,Kb,Fd.skh,Ia)}euj(Ia,nb,Kb){return this.Fra(nb,Kb,Fd.OXk,Ia)}fuj(Ia,
nb,Kb,dc,Ic){return this.Fra(nb,1,Ic,Ia)}Epj(Ia,nb,Kb,dc,Ic){return this.Fra(nb,Kb,Ic,Ia)}Fra(Ia,nb,Kb,dc){const Ic=this.ob.Xd();if(!(Ic&&0<Ic.length))return 8;Ia=[];if(lf.a("FixForPictureAndGraphicsStyleForGrpShapes"))this.Qgj(Ic,Ia);else for(const ae of Ic){if(this.Xhg(ae)||this.fc.$c(ae))return 8;(this.aU?this.I9b(ae):this.Mig(ae))&&Ia.push(ae)}if(0>=Ia.length)return 8;if(1===nb)return 32;cd.a.J(512500487,822,15,"PictureStyle change started. PictureStyleId: '{0}'",Kb);nb=id.a.Ib?id.a.Ib.actionName:
null;for(var Id of Ia)this.zRa(Id);Id=this.Jb.zd(15,void 0,()=>{this.ob.ij();this.Fa.Ed()});try{Id.nc(Ia[0]);Id.jd=dc;for(const ae of Ia)ae.Tgb=Kb}finally{Id&&Id.dispose()}if(dc=id.a.Ib)nb&&(dc.actionName=nb),dc.Va("PictureStyleId",Kb.toString()),id.a.zfa(dc);return 32}Qgj(Ia,nb){let Kb=!1;for(const dc of Ia){if(!dc||this.Xhg(dc)||this.fc.$c(dc))return;dc.Kg&&(Kb=!0)}if(Kb)for(const dc of Ia)dc.Kg&&this.I9b(dc)&&nb.push(dc);else for(const dc of Ia)if(this.I9b(dc))nb.push(dc);else if(dc.Jf){Ia=this.Ea.Yw(dc);
for(const Ic of Ia)this.I9b(Ic)&&nb.push(Ic)}}Psj(Ia,nb,Kb){this.dR.ZYa=new Date;const dc=nb.result;if(Ia){if(this.$Eb?(nb="InsertPicture",this.dFj(dc,Ia,Kb)):(nb="ChangePicture",lf.a("ChangePictureOnMultiSelectFixEnabled")?this.tpi(dc,Ia,Kb):this.upi(dc,Ia,Kb)),Ia=id.a.Ib)Ia.actionName=nb,Ia.Va("PictureUploadStart",id.a.nf(this.dR.Ugb)),Ia.Va("PictureUploadDurationMS",(+this.dR.ZYa-+this.dR.Ugb).toString())}else Ia=Object.assign(new db.a,{Code:94}),this.O6b(Ia)}Rzk(Ia,nb){this.dR.KPf(Ia);nb.result||
cd.a.J(512500486,822,50,"Upload picture completed with null response")}dFj(Ia,nb,Kb){const dc=this.ua.Ba;if(dc&&dc.isConnected){this.FVa=dc.n3(this.ob.Xd());var Ic=this.Jb.zd(15,void 0,void 0,()=>{this.ob.selectShape(this.mJ,!0);this.Fa.Ed()});try{Ic.nc(dc),Ic.jd=Kb,Ic.Py[sb.a.$Ca]=sb.a.aWf,this.mJ=this.Tk.dCi(dc.Cb),this.FVa&&(this.mJ.eca=this.FVa.id),this.mJ.fLb(Ia.ItemId,this.Ga.jUa?null:nb.fileName,nb.fileName),dc.UB(this.mJ)}finally{Ic&&Ic.dispose()}this.fc.Bra(this.ua.Ba,this.mJ,this.Fb.Ma,
"InsertPictureAfterUpload");this.Hu.NF=this.mJ}}tpi(Ia,nb,Kb){var dc=this.ob.Xd();if(dc){var Ic=[];for(const Id of dc)Id.Jf||Ic.push(Id);for(const Id of Ic)this.zRa(Id);dc=this.Jb.zd(15);try{dc.jd=Kb;dc.nc(Ic[0]);for(const Id of Ic)Id.eca=Id.id,this.Ga.jUa?(Id.fLb(Ia.ItemId,null,nb.fileName),Id.set_alt("")):Id.fLb(Ia.ItemId,nb.fileName,nb.fileName)}finally{dc&&dc.dispose()}for(const Id of Ic)this.fc.Bra(this.ua.Ba,Id,this.Fb.Ma,"ChangePictureAfterUpload")}}upi(Ia,nb,Kb){const dc=this.aU?this.f9a():
this.ewb();if(dc){this.zRa(dc);var Ic=this.Jb.zd(15);try{Ic.jd=Kb,Ic.nc(dc),dc.eca=dc.id,this.Ga.jUa?(dc.fLb(Ia.ItemId,null,nb.fileName),dc.set_alt("")):dc.fLb(Ia.ItemId,nb.fileName,nb.fileName)}finally{Ic&&Ic.dispose()}this.fc.Bra(this.ua.Ba,dc,this.Fb.Ma,"changePictureAfterUploadSingleImage")}}O6b(Ia){this.dR.ZYa=new Date;cd.a.J(512500484,822,50,"Upload picture failed");this.Qd.YG(Ia.Code,nb=>{nb.$B=1;nb.GRa=Ia.ExtraErrorParam;return!1})}GVf(){this.fc.ZJ(this.ua.presentation)}Ipd(Ia,nb){this.ywe?
ic.a(ResourceStrings.l_GenericDialogTitle,CommonUIStrings.l_NeedToSignIn,null):this.fB&&(this.fB.W0c=this.Tdc,this.fB.IOb=0,Ia&&this.fB.jch(nb))}ewb(){const Ia=this.ob.Xd();for(const nb of Ia)if(nb&&nb.Ej)return nb;return null}f9a(){const Ia=this.ob.Xd();return Ia&&Ia.length?this.ZPd(Ia)?Ia[0]:this.ewb():null}ZPd(Ia){if(!Ia||!Ia.length)return!1;let nb=Ia[0].Ej,Kb=1===Ia[0].mediaType;for(const dc of Ia)nb=nb&&dc.Ej,Kb=Kb&&1===dc.mediaType;return nb||Kb}al(Ia){return Ia?Object(fc.a)(117,Ia.sc(this.Fb.Ma)):
null}zRa(Ia){Ia&&Ia.Yx&&(Ia=this.al(Ia))&&Ia.h1(!1)}Mig(Ia){return this.ua&&this.ua.Ba&&Ia&&Ia.Ej?!0:!1}I9b(Ia){return this.ua&&this.ua.Ba&&Ia&&(Ia.Ej||1===Ia.mediaType)?!0:!1}Xhg(Ia){return this.ua&&this.ua.Ba&&Ia&&Ia.Mp?!0:!1}insertPicture(Ia,nb,Kb){var dc=this.ua.Ba;const Ic=Object(fc.a)(295,dc.sc(this.Fb.Ma)),Id=this.XHa.Cb;if(dc&&dc.isConnected&&Ic&&this.XHa&&this.XHa.isConnected){dc=this.XHa.Pt();this.FVa=this.XHa.n3(this.ob.Xd());var ae,Od;({F1d:Od,fD:ae}=this.oWa.$Ud(this.FVa,Kb.imageWidth,
Kb.imageHeight));var Hd=this.Jb.zd(15,void 0,()=>{this.ob.Vx();this.ob.Qh();this.Fa.Ed()},()=>{this.Hu.NF=this.mJ;this.ob.selectShape(this.mJ,!0)});try{Hd.nc(this.XHa);Hd.jd=nb;this.mJ=this.Tk.$ra(!0,Id.cid,Id.sid,0,ae.x,ae.y,Od.width,Od.height,dc+1,!1);const Bf=this.oWa.mRd(this.Fb.Ld,Od,ae,Ic.mT);this.mJ.NU=Bf;this.FVa&&(this.mJ.eca=this.FVa.id,this.XHa.KU([this.FVa]));this.mJ.fLb(Ia,this.Ga.jUa?null:Kb.fileName,Kb.fileName);this.mJ.isResizable=!0;this.mJ.r9b=!0;this.mJ.vL=!0;this.mJ.FIa=!0;this.mJ.Ej=
!0;this.mJ.Rub=!!Kb.dGb;this.mJ.Pda=Kb.dGb||Kb.OVc;this.XHa.UB(this.mJ)}finally{Hd&&Hd.dispose()}id.a.I1e()}}static KTj(Ia){return!!Ia&&!!Ia.fileName&&Ia.fileName.toLowerCase().indexOf(".svg")===Ia.fileName.length-4}static Jqk(){cd.a.J(512500483,822,50,"NotifyImageUploadFailureRequest failed");return!0}}Object(k.a)(ve,"PictureActor",null,[227]);var md=d(112),Kf=d(207),oe=d(714),Hf=d(900),xb=d(84);class hg extends Sys.EventArgs{constructor(Ia,nb){super();this.oQj=Ia;this.x_c=nb}}Object(k.a)(hg,"TokenRefreshEventArgs",
Sys.EventArgs,[]);class rf{constructor(Ia,nb,Kb,dc,Ic,Id,ae){this.VEb=0;this.Oc=Ia;this.yze=nb;this.du=Kb;this.ia=dc;this.Qo=Ic;this.zb=Id;this.Ga=ae;this.yze&&this.yze.RFc(Object(A.a)(this,this.K6g,"onTokenRefreshed"))}oTd(Ia){!this.Ga.podTokenRefreshImprovementEnabled&&this.zb.Bta&&this.zb.b_a();const nb=Ib.a.instance.vFa(e.AFrameworkApplication.hm),Kb=Ib.a.instance.a_c(e.AFrameworkApplication.hm,e.AFrameworkApplication.bia);cd.a.J(41562886,801,nb||Kb?15:50,"SessionRehydrationController::CheckAccessTokenExpiry - IsExpired:{0}, IsExpiring:{1}, Trigger:{2}, Improvement:{3}, RetryCount:{4}",
nb,Kb,Ia,this.Ga.podTokenRefreshImprovementEnabled,this.VEb);Ib.a.instance.A6a();this.Ga.podTokenRefreshImprovementEnabled&&this.zb.Bta&&this.zb.b_a()}K6g(Ia,nb){cd.a.J(41562888,809,50,"PPTTokenRefreshManager::OnTokenRefreshed");try{const Kb=Object(fc.a)(wb,nb)||new wb(null,null),dc=Kb.tokens,Ic=Kb.errors;Ia="";if(void 0===Ic||null===Ic||0>=Ic.count)for(nb=0;nb<dc.count;nb++)if(dc.ga(nb).Name===Yb.a.V3k){const ae=dc.ga(nb)?dc.ga(nb):null;Ia=ae&&ae.Value&&0<ae.Value.length?ae.Value:"";break}const Id=
Ib.a.instance.vFa(e.AFrameworkApplication.hm);cd.a.J(540366599,809,50,"PPTTokenRefreshManager::OnTokenRefreshed fTokenExpired:{0} m_applicationSettings.PPTOTokenRefreshRetryEnabled:{1} m_tokenRefreshRetryCount:{2} m_applicationSettings.PPTOTokenRefreshRetryLimit:{3}",Id,this.Ga.TJe,this.VEb,this.Ga.Fah);if(0<Ia.length&&Id&&this.Ga.TJe&&this.VEb<this.Ga.Fah)cd.a.J(51205124,809,15,"PPTTokenRefreshManager::OnTokenRefreshed - Token refreshed successfully but is expired. NowTicket:{0}, NowDateTime:{1}, AccessTtl:{2}, AccessTtlDateTime:{3}, RetryEnabled:{4}, CurrentRetryCount:{5}",
(new Date).getTime(),new Date,e.AFrameworkApplication.hm,new Date(e.AFrameworkApplication.hm),this.Ga.TJe,this.VEb),this.VEb++,this.oTd(2);else if(0<Ia.length&&!Id){cd.a.J(41562890,809,Id?15:50,"PPTTokenRefreshManager::OnTokenRefreshed - Token was refreshed successfully, NowTicket:{0}, NowDateTime:{1}, AccessTtl:{2}, AccessTtlDateTime:{3}",(new Date).getTime(),new Date,e.AFrameworkApplication.hm,new Date(e.AFrameworkApplication.hm));Kf.App.E5d=e.AFrameworkApplication.Ztb=na.a.Ke(Ia);const ae=this.du.Mlc.presentationId.CYe+
"&access_token="+encodeURIComponent(e.AFrameworkApplication.accessToken)+"&access_token_ttl="+encodeURIComponent(e.AFrameworkApplication.hm.toString());this.du.Mlc=new Hf.a(new oe.a(ae));this.Oc.Beh(new hg(this.Qo?this.Qo.i_:!1,!0))}else{if(lf.a("CleanPIIFromC49mm")&&Ic)for(let ae of Ic)if(ae.Errors)for(const Od of ae.Errors)"403"===Od.Id&&Od.Details&&Od.Details.startsWith("<")&&(Od.Details=null);cd.a.J(41562892,809,15,"PPTTokenRefreshManager::OnTokenRefreshed - Token was refreshed failed, errors: {0}, RetryCount:{1}",
Ic?md.c(Ic):"There is no error in Refreshed Token, but GetFileUrl is empty",this.VEb);Ic&&0<=md.c(Ic).indexOf("The caller is not authenticated")?(e.AFrameworkApplication.xp(xb.a.Uh(383)),Ad.Health.instance.recordQosError("WopiTokenRefreshFailedOnHostUnauth",["SessionExpired"],!1,!0,!1,!0,null)):(e.AFrameworkApplication.xp(xb.a.Uh(380)),Ad.Health.instance.recordQosError("WopiTokenRefreshFailed",["SessionExpired"],!1,!0,!0,!0,null));e.AFrameworkApplication.Vu&&e.AFrameworkApplication.Vu.i8();this.Oc.Beh(new hg(this.Qo?
this.Qo.i_:!1,!1));this.ia.La(Jd.a.refresh,2,{refreshtrigger:"PPTTokenRefreshManager::OnTokenRefreshed"})}}catch(Kb){cd.a.J(41562894,809,15,"PPTTokenRefreshManager::OnTokenRefreshed - Token was refreshed failed and throw exception, exception: {0}",md.c(Kb))}}dispose(){this.yze.nPe(Object(A.a)(this,this.K6g,"onTokenRefreshed"))}}Object(k.a)(rf,"PPTTokenRefreshManager",null,[688]);var nf=d(85),kd=d(645);class If{constructor(Ia,nb,Kb,dc,Ic,Id){this.eY=this.nEl=this.VPe=null;this.e3b=this.T1d=!1;this.qad=
0;this.Zlb=id.a.Ik("SeamlessFailover");1!==nb&&2!==nb||id.a.cbb();this.Jj=new Date;id.a.cAb=this.startTime;this.PWh=Kb;this.CQa=0;this.DYh=nb;this.sQh=dc;this.zXh=Ic;this.ysl=Id;this.yUi=!1;this.resultCode=0;this.q$e=!0;if(Ia=e.AFrameworkApplication.gd)this.Uc.Va("Host",Object(fc.a)(String,Ia.Host)),this.Uc.Va("Ring",Object(fc.a)(String,Ia.Ring))}prh(Ia,nb){this.qad=window.setTimeout(Ia,nb)}Gll(){this.q$e=!1}dispose(){id.a.V$b=new Date;0<=this.qad&&(window.clearTimeout(this.qad),this.qad=-1)}get vUi(){return this.q$e}get Uc(){return this.Zlb}get startTime(){return this.Jj}get Bvk(){return this.PWh}get Ixa(){return this.DYh}get MTi(){return this.sQh}get podsCleaningRequestPattern(){return this.zXh}}
Object(k.a)(If,"SeamlessFailoverState",null,[106]);const og=Ia=>{Ia=String.format("{0}/PodHandler.ashx?action=TriggerFontsInstallation&PodsID={1}",e.AFrameworkApplication.fa.Ha("361"),Ia);e.AFrameworkApplication.Je.YV(Ia,1,null,null,null,0,()=>{cd.a.J(512263E3,801,50,"CustomFontHelper::TriggerFontsInstallation - Succeeded")},()=>{cd.a.J(512262999,801,15,"CustomFontHelper::TriggerFontsInstallation - Failed to set document settings")},null)};var pf;(function(Ia){Ia[Ia.unknown=0]="unknown";Ia[Ia.mouse=
1]="mouse";Ia[Ia.keyboard=2]="keyboard";Ia[Ia.podsPopsUnavailable=4]="podsPopsUnavailable"})(pf||(pf={}));Object(k.b)("RehydrationTrigger",pf);var ig=d(655),Oe=d(959);class Ag{constructor(Ia,nb,Kb,dc,Ic,Id,ae,Od,Hd,Bf,Of,ph,Qh,Lg,Fg,dg,hi,Mg,ne,Bh,Vh,ij,Ij){this.Ge=this.upe=null;this.JBe=this.Wad=-1;this.VRg=0;this.ieb=Ia;this.la=nb;this.Vb=Kb;this.ia=dc;this.zb=Ic;this.lE=Id;this.Ce=ae;this.Ze=Hd;this.hz=Bf;this.Qd=Of;this.Lm=ph;this.Zh=Qh;this.mc=Lg;this.BO=Fg;this.tw=Mg;this.zze=new Date;this.Bv=
dg;this.mH=hi;this.ua=ne;this.Yb=Bh;this.Yec=Vh;Ij.execute(Yj=>{this.upe=Yj});this.g4c=[];this.wbk=this.Yb.Fc("SeamlessFailoverMaxRetryAttempts",0);this.vbk=this.Yb.ka("SeamlessFailoverIncludePopsInfoInFinalLog");this.xbk=this.Yb.ka("SeamlessRehydrationAbortOnAbortedOnExitAppQosEnabled");cd.a.J(512497885,809,50,"PodSeamlessFailoverManager::PodSeamlessFailoverManager()")}get i_(){return!!this.Ge&&this.Ge.vUi}get NSf(){return this.VRg}yMd(Ia){if(this.i_){e.AFrameworkApplication.Rz&&(this.Zh.Jnc(Object(A.a)(this,
this.kfa,"onWopiTokenRefreshed")),this.d_b());var nb=0;if(this.la.Nyb)this.Ge.Uc.GB("Result","abortedOnIrmProtectedFile"),nb=365;else if(this.Ge.Uc.GB("Result",Ia),"abortedOnExitApp"!==Ia||this.xbk)nb=4===this.Ge.Ixa?356:357;this.Rib(!1,nb,!this.Ge.e3b&&"abortedOnRefreshDoc"!==Ia)}}N0e(Ia,nb,Kb){if(this.i_)cd.a.J(512497884,801,15,"PodSeamlessFailoverManager::TriggerFailover skipped");else{e.AFrameworkApplication.Vu||(e.AFrameworkApplication.Vu=cd.a.A0b());this.Qd.disabled=!1;this.Qd.hka=!1;this.Ge=
new If(Ia,nb,this.Ce.podSessionId,this.la.podsCleanPendingTasksAndRequestsWhenFailover,this.la.podsCleaningRequestPattern,Kb);this.la.wopiTokenRefreshLongerTimeoutIsEnable||this.Ge.prh(Object(A.a)(this,this.P2g,"onFailoverTimeout"),this.la.podsSeamlessFailoverTimeoutDurationInMs);this.Ge.Uc.Va("PopsAvailable",this.Ze.pA.toString());this.Ge.Uc.Va("OrderlyShutdown",Ia.toString());this.Ge.Uc.Va("Trigger",pf[nb]);this.Ge.Uc.Va("TriggerErrorCode",Ja.a[Kb]);this.Ge.Uc.Va("OldPodsId",this.Ge.Bvk);this.Ge.Uc.Va("OldPopsId",
this.Ce.Kk);cd.a.J(512497883,809,50,"PodSeamlessFailoverManager::TriggerFailover:ActionID:{0}; ActionDetails:{1}",this.Ge.Uc.actionId,this.Ge.Uc.wNb());if(1===nb||2===nb)e.AFrameworkApplication.Tg=!1,this.ua.presentation&&this.ua.presentation.zQe();this.Zh.ZFc(Object(A.a)(this,this.kfa,"onWopiTokenRefreshed"));e.AFrameworkApplication.Rz&&Ib.a.instance.A6a()?(cd.a.J(512497882,809,15,"FileUrlExpired on TriggerFailover, NowTicket: {0}, NowDateTime:{1}, AccessTtl:{2}, AccessTtlDateTime: {3}",(new Date).getTime(),
new Date,e.AFrameworkApplication.hm,new Date(e.AFrameworkApplication.hm)),this.d_b(),this.Wad=window.setTimeout(Object(A.a)(this,this.Buk,"onWopiTokenRefreshTimeout"),this.la.wopiTokenRefreshTimeoutDuringRehydrationInMs),this.la.n$g&&this.Yec.EVf(!1)):(this.Zh.Jnc(Object(A.a)(this,this.kfa,"onWopiTokenRefreshed")),this.oCh(nb))}}BUi(Ia){if(Array.contains(this.la.podTriggerFailoverOnServerErrorsCandidates,xb.a.Uh(Ia).toString())){if(!this.g4c.length)return!0;const nb=new Date;let Kb=0;for(let dc=this.g4c.length-
1;0<=dc;dc--){const Ic=this.g4c[dc];if(+nb-+Ic.startTime>this.la.podTriggerFailoverOnServerErrorsLookbackWindowInMs)break;Ic.ysl===Ia&&Kb++}if(Kb<this.la.podTriggerFailoverOnServerErrorsMaxTry)return!0;cd.a.J(512497881,809,10,"PodSeamlessFailoverManager::FTriggerFailoverForServerError - Failover for Error[{0}] has been triggered for {1} times within {2}ms. Skip.",Ia,Kb,this.la.podTriggerFailoverOnServerErrorsLookbackWindowInMs)}return!1}oCh(Ia){e.AFrameworkApplication.Rz&&(this.Zh.Jnc(Object(A.a)(this,
this.kfa,"onWopiTokenRefreshed")),this.d_b());if(++this.VRg>this.wbk)this.F$d("SeamlessFailoverMaxRetryCountReached",392);else if(this.la.wopiTokenRefreshLongerTimeoutIsEnable&&this.Ge.prh(Object(A.a)(this,this.P2g,"onFailoverTimeout"),this.la.podsSeamlessFailoverTimeoutDurationInMs),+new Date-+this.zze>=36E5*this.la.powerPointPodRecoveryStorageAgeThreshold)this.F$d("RecoveryStreamExpired",358);else{if(this.Ge.T1d&&(this.Ge.Uc.GB("Trigger",pf[Ia]+"_GetFileUrlExpired"),this.bIj())){this.F$d("GetFileUrlExpired_NoAzureBackup",
364);return}this.Ge.MTi&&this.zri();this.Zh.jjd(new ig.a(4===Ia?5:2));this.Zh.jKk();this.la.podsClosePopSessionBeforeSeamlessFailoverEnabled&&4===Ia&&(cd.a.J(512497880,801,15,"PodSeamlessFailoverManager::TriggerFailover - Close PopSesion: {0}",this.Ce.Kk),this.BO.ksb(()=>{},()=>{}));this.Lm.isPaused||this.Lm.pause();this.Ge.Uc.Wm("CreatePodsWithRetryST",new Date);this.Ge.Uc.Wm("SessionStartTime",this.zze);this.ugh()}}F$d(Ia,nb){this.zb.Bta&&this.zb.b_a();this.Ge.Uc.GB("Result",Ia);this.Rib(!1,nb)}Buk(){this.Zh.Jnc(Object(A.a)(this,
this.kfa,"onWopiTokenRefreshed"));this.d_b();cd.a.J(512497879,809,50,"WopiTokenRefreshed timeout during TriggerFailover");this.Ge.Uc.Va("WopiTokenRefreshed","TO");e.AFrameworkApplication.xp(xb.a.Uh(382));Ad.Health.instance.recordQosError("WopiTokenRefreshTimeoutOnRehydration",["SessionExpired"],!1,!0,!0,!0,null);e.AFrameworkApplication.Vu&&e.AFrameworkApplication.Vu.i8();this.Ge.e3b=!0;this.ia.La(Jd.a.refresh,2,{refreshtrigger:"PodSeamlessFailoverManager::OnWopiTokenRefreshTimeout"})}kfa(Ia,nb){Ia=
nb.x_c;this.Zh.Jnc(Object(A.a)(this,this.kfa,"onWopiTokenRefreshed"));this.d_b();this.la.n$g&&this.Yec.EVf(!0);nb=0<e.AFrameworkApplication.hm&&(new Date).getTime()>=e.AFrameworkApplication.hm-this.la.wopiTokenRefreshFileUrlExpiredBufferTimeInMs;cd.a.J(512497878,809,50,"WopiTokenRefreshed during TriggerFailover, IsTokenRefreshedSuccessfully: {0}, NowTicket: {1}, NowDateTime:{2}, AccessTtl:{3}, AccessTtlDateTime: {4}",Ia,(new Date).getTime(),new Date,e.AFrameworkApplication.hm,new Date(e.AFrameworkApplication.hm));
this.Ge.Uc.Va("WopiTokenRefreshed","True");this.Ge.Uc.Va("WopiTokenRefreshedSuccessfully",Ia.toString());this.Ge.T1d=nb;Ia?this.oCh(this.Ge.Ixa):this.Ge.e3b=!0}d_b(){-1!==this.JBe&&(window.clearTimeout(this.JBe),this.JBe=-1);-1!==this.Wad&&(window.clearTimeout(this.Wad),this.Wad=-1)}bIj(){const Ia=na.a.og(this.Yb.Ha("152")||""),nb=!e.AFrameworkApplication.Vg.IsRealEdit&&1!==this.Ge.Ixa&&2!==this.Ge.Ixa;return".pptx"!==Ia&&".ppsx"!==Ia||nb}zri(){try{let Ia=0,nb=0;const Kb={},dc={};this.tw.S2h(Ic=>
{if(-1<Ic.request.get_url().search(new RegExp(this.Ge.podsCleaningRequestPattern,"i")))return this.UBh(Kb,this.z3f(Ic.request.get_url())),Ia++,!0;this.UBh(dc,this.z3f(Ic.request.get_url()));nb++;return!1});cd.a.J(512497877,801,15,"PodSeamlessFailoverManager::CleanPendingTasksAndRequests - abort {0} requests: {1}, remain {2} request: {3}",Ia,Kb,nb,dc)}catch(Ia){cd.a.J(512497876,801,10,"PodSeamlessFailoverManager::CleanPendingTasksAndRequests failed. {0}",Ia)}}z3f(Ia){let nb=Ia;const Kb=Ia.indexOf("?");
0<Kb&&(nb=Ia.substr(0,Kb));Ia=nb.lastIndexOf("/");0<Ia&&(nb=nb.substr(Ia+1));return nb}UBh(Ia,nb){Ia[nb]=nb in Ia?Ia[nb]+1:1}P2g(){this.i_&&(this.Ge.Uc.GB("Result","Timeout"),this.Ge.Uc.Va("TimeoutDuration",(+new Date-+this.Ge.startTime).toString()),this.Rib(!1,4===this.Ge.Ixa?354:355))}Rib(Ia,nb=0,Kb=!0){if(this.i_){this.hz.hib(Object(A.a)(this,this.gfa,"onPodSessionRefreshed"));this.Vb.yi.contentReplicator.Fnc(Object(A.a)(this,this.$0g,"onAfterReplication"));var dc=+new Date-+this.zze>=6E4*this.la.pptEditorFileGetUrlExpireTimeInMinutes;
e.AFrameworkApplication.Rz&&(dc=0<e.AFrameworkApplication.hm&&(new Date).getTime()>=e.AFrameworkApplication.hm-this.la.wopiTokenRefreshFileUrlExpiredBufferTimeInMs)&&cd.a.J(512497875,809,15,"FileUrlExpired on SeamlessFailoverEnd, NowTicket: {0}, NowDateTime:{1}, AccessTtl:{2}, AccessTtlDateTime: {3}",(new Date).getTime(),new Date,e.AFrameworkApplication.hm,new Date(e.AFrameworkApplication.hm));Ia&&dc&&this.Ge.Uc.Va("SkipPopsReason","FileUrlExpired");this.mc.Jog();var Ic=this.Ge.Ixa;this.Ge.Uc.Va("IsInEditingMode",
this.mc.Fn.toString());this.Ge.Uc.Va("IsPreviousModeEditing",this.mc.N9b.toString());this.Ge.Uc.Va("IsLastKnownModeEditing",this.mc.Rie.toString());this.Ge.Uc.Va("PopSessionEverInitialized",this.Ze.Zkc.toString());this.Ge.Uc.Va("ResultErrorCode",Ja.a[nb]);this.Ge.Uc.Va("RefreshPage",Kb.toString());this.Ge.Uc.Va("FRehydrationInitiatedPageRefresh",this.Ge.e3b.toString());this.Ge.yUi=Ia;this.Ge.resultCode=nb;this.Ge.Gll();this.g4c.push(this.Ge);this.vbk||this.uPc();Ia?(this.Zh.beh(new Oe.a(Ic)),this.wCh(dc,
Ic)):(this.uPc(),0!==nb&&(Ia=xb.a.Uh(nb),e.AFrameworkApplication.xp(Ia),Ad.Health.instance.recordQosError(xb.a.Wia(Ia),["UnexpectedAppRefresh"],399===nb,!1,!0,Kb,null)),Kb?(e.AFrameworkApplication.Vu&&e.AFrameworkApplication.Vu.i8(),this.ia.La(Jd.a.refresh,2,{refreshtrigger:"PodSeamlessFailoverManager::SeamlessFailoverEnd"})):(this.Zh.beh(new Oe.a(Ic)),this.wCh(dc,Ic)))}}f3b(){return this.Ge&&this.Ge.Uc?!0:!1}uPc(){this.f3b()&&(cd.a.J(512497874,801,15,"Action Telemetry: {0}",this.Ge.Uc.wNb()),this.Ge.Uc.finish(!0),
this.Ge.dispose(),this.Ge=null)}wCh(Ia,nb){!this.mc.rL||Ia||2!==nb&&1!==nb&&4!==nb?(this.f3b()&&this.Ge.Uc.Va("PopsRehydrationAttempted","false"),cd.a.J(512497873,809,15,"TriggerRehydrateHostSession is skipped isFileUrlExpired:{0}, rehydrationTriger:{1}",Ia,nb),this.EIf(null)):(this.f3b()&&this.Ge.Uc.Va("PopsRehydrationAttempted","true"),this.BO.Bfa(4===nb?6:7,Object(A.a)(this,this.FEi,"createPopSessionSucceededCallback"),Object(A.a)(this,this.EIf,"createPopSessionFailedCallback")))}FEi(){this.f3b()&&
(this.HUf(),this.Ge.Uc.Va("POPSessionCreated","true"),this.uPc())}EIf(){if(!this.f3b())return!1;this.HUf();this.Ge.Uc.Va("POPSessionCreated","false");this.uPc();return!1}HUf(){this.Ge.Uc.GB("IsInEditingMode",this.mc.Fn.toString());this.Ge.Uc.GB("IsPreviousModeEditing",this.mc.N9b.toString());this.Ge.Uc.GB("PopSessionEverInitialized",this.Ze.Zkc.toString())}Asl(Ia){cd.a.J(512497872,801,50,"PodSeamlessfailoverManager TriggerFontsInstallationCallback started with UserHasValidLicenseForEnterpriseFonts:{0}, PPTOEnterpriseFontsEnabled:{1}",
this.Yb.ka("UserHasValidLicenseForEnterpriseFonts"),this.Yb.ka("PPTOEnterpriseFontsEnabled"));this.Yb.ka("UserHasValidLicenseForEnterpriseFonts")&&this.Yb.ka("PPTOEnterpriseFontsEnabled")&&og(Ia)}ugh(){this.Ge.eY=kd.a();this.zb.Bta||this.zb.stop();let Ia=this.la.restoreRCInCreatePodSessionRequest&&this.ua.$j?this.ua.$j.toString():"";Ia=na.a.replaceAll(Ia,"#","%23");this.ieb.createPodSession(this.Ge.eY,"SeamlessFailover_"+this.Ge.Ixa,this.Ge.CQa,+new Date-+this.Ge.startTime,Object(A.a)(this,this.EEi,
"createPodSessionSucceededCallback"),Object(A.a)(this,this.DEi,"createPodSessionFailedCallback"),this.lE,this.Ce.podSessionId,Ia);this.ieb.Fzl(this.Ge.eY,Object(A.a)(this,this.Asl,"triggerFontsInstallationCallback"));this.zb.b_a()}EEi(Ia){if(this.i_){id.a.Ird=[];this.Ge.Uc.Va("NewPodsId",this.Ge.eY);this.Ce.podSessionId=this.Ge.eY;this.Ge.Uc.Va("CreatePodsWithRetryResult","true");this.Ge.Uc.Va("CreatePodsRetryCount",this.Ge.CQa.toString());this.Ge.Uc.Va("CreatePodsDuration",(+new Date-+this.Ge.startTime).toString());
this.Lm.isPaused&&this.Lm.olb();try{this.Lm.lBf()}catch(nb){cd.a.J(512497871,801,15,"PodSeamlessfailoverManager CancelBlockedOperation failed. {0}",nb)}if(this.la.restoreRCInCreatePodSessionRequest&&Ia&&nf.a.Ckc in Ia&&!na.a.Wa(Ia[nf.a.Ckc])){const nb=Boolean.parse(Ia[nf.a.Ckc]);this.Ge.Uc.Va("RCRestoredWhenCreatePodSession",Ia[nf.a.Ckc]);nb?(this.Ge.Uc.GB("Result","Success"),this.Rib(!0)):(this.upe&&this.upe.Pri(),this.Ge.Uc.Va("DocRefreshTriggered","true"),Ia={failedMachineId:null,isPlanedShutdown:!1,
fromSeamlessFailoverManager:!0},Ia.podSessionId=this.Ce.podSessionId,this.Ge.e3b=!0,this.ia.La(Jd.a.hJb,2,Ia))}else this.rCh()}}rCh(){this.Vb.yi.contentReplicator.IFc(Object(A.a)(this,this.$0g,"onAfterReplication"));this.Esl()}Esl(){const Ia=()=>{this.Ge.VPe=new Date;this.Ge.Uc.Wm("InboundStartTime",this.Ge.VPe);this.Vb.yi.contentReplicator.yF(null,null,null)};cd.a.J(512497870,801,50,"PodSeamlessFailoverManager::TriggerInbound - ForceInboundSlide:{0}; ActiveSlide.Sid:{1}; PodSessionID:{2};",!0,this.ua.Ba?
this.ua.Ba.sid:0,this.Ge.eY);4===this.Ge.Ixa&&this.la.podsSeamlessFailoverForceInboundSlideEnabled&&this.ua.Ba?(this.mH.PVc&&this.mH.PVc.Adg(this.ua.Ba.Cb),this.Ge.Uc.Wm("ForceInboundSlideStartTime",new Date),this.Bv.f3d(this.ua.Ba,(nb,Kb)=>{cd.a.J(512497869,801,50,"PodSeamlessFailoverManager::TriggerInbound after ForceInboundSlide - SlideId:{0}; SlideStale:{1};",nb,Kb);this.i_&&(this.Ge.Uc.Wm("ForceInboundSlideEndTime",new Date),Ia())},!0,!1)):Ia()}DEi(Ia){if(!this.i_)return!0;const nb=+new Date-
+this.Ge.startTime;if(399===Ia)return cd.a.J(512497868,801,15,"PodSeamlessFailoverManager::CreatePodSessionFailedCallback - Create Pod session failed, unsupported client - PodSessionID:{0}; Time:{1};",this.Ce.podSessionId,nb),this.Qd.YG(Ia,null),this.Rib(!1,Ia,!1),!0;if(this.Ge.T1d&&230===Ia)return cd.a.J(512497867,801,15,"PodSeamlessFailoverManager::CreatePodSessionFailedCallback - Create Pod session failed, file url expired - PodSessionID:{0}; Time:{1};",this.Ce.podSessionId,nb),this.IPf("CreatePodSessionFailed_GetFileUrlFailed",
Ia),!0;if(this.Ge.CQa<this.la.podsFailoverRehydrationCreatePodSessionMaxRetryCount&&nb<this.la.podsFailoverRehydrationCreatePodSessionMaxRetryDurationInMs){let Kb;(Kb=this.Ge).CQa=Kb.CQa+1;cd.a.J(512497866,801,15,"PodSeamlessFailoverManager::CreatePodSessionFailedCallback - Create Pod session failed, continue retrying - PodSessionID:{0}; Attempts:{1}; Time:{2}; ErrorCode:{3};",this.Ce.podSessionId,this.Ge.CQa,nb,Ia);this.ugh();return!0}cd.a.J(512497865,801,15,"PodSeamlessFailoverManager::CreatePodSessionFailedCallback - Create Pod session failed, stopped retrying - PodSessionID:{0}; Attempts:{1}; Time:{2}; ErrorCode:{3};",
this.Ce.podSessionId,this.Ge.CQa,nb,Ia);this.IPf("CreatePodSessionFailed",Ia);return!0}IPf(Ia,nb){this.Ge.Uc.Va("CreatePodsWithRetryResult","false");this.Ge.Uc.Va("CreatePodsRetryCount",this.Ge.CQa.toString());this.Ge.Uc.Wm("CreatePodsWithRetryET",new Date);this.Ge.Uc.GB("Result",Ia);this.Ge.Uc.Va("CreatePodsDuration",(+new Date-+this.Ge.startTime).toString());this.Rib(!1,nb)}$0g(Ia,nb){this.i_&&(nb.kig?cd.a.J(512497864,801,50,"PodSeamlessFailoverManager::OnAfterReplication() - Current replication is outbound, replication result: {0}",
nb.Bfd):(this.Ge.Uc.GB("InboundDuration",(+new Date-+this.Ge.VPe).toString()),this.Ge.Uc.GB("Result","Success"),this.Rib(!0)))}gfa(Ia,nb){this.i_&&(this.Ge.Uc.Va("WaitPodsRefreshedDuration",(+new Date-+this.Ge.nEl).toString()),this.Ge.Uc.Va("NewPodsId",nb.eY),this.hz.hib(Object(A.a)(this,this.gfa,"onPodSessionRefreshed")),this.Lm.isPaused&&this.Lm.olb(),this.rCh())}}Object(k.a)(Ag,"PodSeamlessFailoverManager",null,[687]);class ce{constructor(Ia,nb,Kb){this.Sua=Ia;this.Xa=Kb}HZ(){}FXb(){}A5a(Ia){Ia&&
(Array.add(Ia,nf.a.dIe),Array.add(Ia,nf.a.U$),Array.add(Ia,nf.a.hHb),Array.add(Ia,nf.a.hxk),Array.add(Ia,nf.a.Ckc))}eda(Ia,nb){nb?((nb=Ia[nf.a.hHb])&&nb.toLowerCase()!==(this.Xa.V$?this.Xa.V$.toLowerCase():"")&&(cd.a.J(512497857,821,15,"HandleResponseHeaders: PodInstance was updated. Id:{0};",nb),this.Xa.V$=nb),this.Sua?(Ia=Ia[nf.a.dIe])?(this.Sua.ccpInfo=Ia,cd.a.J(512497827,826,50,"HandleResponseHeaders: CCPInfo was updated, length: {0}",Ia.length)):cd.a.J(512497826,826,15,"HandleResponseHeaders: CCPInfo couldn't be found in response headers."):
cd.a.J(512497856,826,15,"HandleResponseHeaders: ccpInfoOwner is null so skip the response headers.")):cd.a.J(512497858,826,15,"HandleResponseHeaders: abort since argument 'responseHeaders' is null.")}}Object(k.a)(ce,"RehydrationHeaderHandler",null,[774]);class me{constructor(Ia,nb,Kb,dc,Ic,Id,ae,Od,Hd,Bf){this.yO=null;this.d4c=!1;this.n8f=Of=>{if(Of.keyCode===I.a.cud||Of.keyCode===I.a.bMa||Of.keyCode===I.a.Clb||Of.keyCode>=I.a.Tlb&&Of.keyCode<=I.a.zza)return!1;this.zOe(2);return!0};this.kf=Ia;this.Oc=
nb;this.nec=Kb;this.Jr=dc;this.Yc=Ic;this.He=Id;this.pSg=Hd;this.Ga=ae;this.Qo=Od;this.sad=Bf}init(){this.Oc&&(this.Oc.pOd(Object(A.a)(this,this.sessionExpired,"sessionExpired")),this.Oc.rPa(Object(A.a)(this,this.Urk,"onRehydrateSession")))}sessionExpired(){this.avh(!0);r.ULS.sendTraceTag(594616334,821,50,"Pausing health heartbeat");Ad.Health.instance.stopAllHealthTimers()}zOe(Ia){this.avh(!1);const nb=e.AFrameworkApplication.Rz||!lf.a("Rehyrdation.StopRefreshIfWopiRefreshDisable");r.ULS.sendTraceTag(544789148,
821,100,"Should refresh token: {0}",nb);nb&&this.sad&&this.sad.oTd(0);this.Ga.podsSeamlessFailoverEnabled&&this.Qo.N0e(!1,Ia,223)}Urk(){r.ULS.sendTraceTag(594616333,821,50,"Resuming health heartbeat");Ad.Health.instance.resumeAllHealthTimers()}avh(Ia){this.d4c!==Ia&&this.kf&&(Ia?(this.yO||(this.yO=this.He.Fe(),this.yO.id="sessiontimeoutoverlay",this.yO.className="SessionTimeoutOverlay",this.yO.tabIndex=-1,this.Cfi(this.yO),this.kf.appendChild(this.yO)),this.d4c=!0,this.pSg(this.yO)):(this.MLf(this.yO),
this.yO&&this.yO.parentNode&&this.yO.parentNode.removeChild(this.yO),this.yO=null,this.d4c=!1))}Cfi(Ia){Ia&&(this.Yc.pb(H.a.click,Ia,Object(A.a)(this,this.c$a,"handleClickEvent")),this.Yc.pb(H.a.doubleClick,Ia,Object(A.a)(this,this.c$a,"handleClickEvent")),lf.a("FixRehydrationOnKeyPress")?this.Jr.addHandler(Ia,H.a.Zf,this.n8f):this.nec.pb(H.a.Zf,Ia,Object(A.a)(this,this.r8f,"handleKeyEvent")),$addHandler(window,"visibilitychange",Object(A.a)(this,this.onVisibilityChange,"onVisibilityChange")))}MLf(Ia){Ia&&
(this.Yc.yb(H.a.click,Ia,Object(A.a)(this,this.c$a,"handleClickEvent")),this.Yc.yb(H.a.doubleClick,Ia,Object(A.a)(this,this.c$a,"handleClickEvent")),lf.a("FixRehydrationOnKeyPress")?this.Jr.removeHandler(Ia,H.a.Zf,this.n8f):this.nec.yb(H.a.Zf,Ia,Object(A.a)(this,this.r8f,"handleKeyEvent")),$removeHandler(window,"visibilitychange",Object(A.a)(this,this.onVisibilityChange,"onVisibilityChange")))}c$a(){this.zOe(1);return!0}r8f(Ia){if(Ia.pc.ctrlKey||Ia.pc.altKey||Ia.pc.shiftKey||Ia.pc.keyCode>=I.a.Tlb&&
Ia.pc.keyCode<=I.a.zza)return!1;this.zOe(2);return!0}onVisibilityChange(){e.AFrameworkApplication.Rz&&!window.document.hidden&&this.sad&&this.sad.oTd(1)}dispose(){this.Oc.oih(Object(A.a)(this,this.sessionExpired,"sessionExpired"));this.yO&&(this.MLf(this.yO),this.yO.parentNode&&this.yO.parentNode.removeChild(this.yO));this.Jr=this.nec=this.Yc=null;this.d4c=!1;this.pSg=null}}Object(k.a)(me,"SessionRehydrationController",null,[]);class Je{constructor(){this.Da=null}$b(Ia){this.Da=Ia||w.a.instance}dispose(){}}
Object(k.a)(Je,"TellMePackage",null,[2,3]);var ie=d(115),Tf=d(27),He=d(15),Sg=d(101),jc=d(928);class be{constructor(Ia=null,nb=null,Kb=null,dc,Ic=null){this.Nvd=null;this.y5e=!1;this.I$e=this.pmb=null;this.C_h=this.mmf=this.vMh=this.J$e=!1;this.iwc=null;this.FMh=null==nb?e.AFrameworkApplication.vrb:nb;this.vSh=null==Kb?e.AFrameworkApplication.MEa:Kb;this.X_h=null==Ic?e.AFrameworkApplication.Eya:Ic;this.KRh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("TellMeHelpOnHelpIsEnabled");this.a1h=
!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("TellMeCommandHookIsEnabled");this.lal(!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("TellMeIgnoreQueryForHelp"));this.S0h=!!e.AFrameworkApplication.Aa&&e.AFrameworkApplication.Aa.hb.s$b;this.T0h=!Sg.a.hx()&&!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("TellMePeopleSuggestionIsEnabled");this.R0h=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("TellMeFileSuggestionIsEnabled");this.yQh=!!e.AFrameworkApplication.Aa&&
e.AFrameworkApplication.Aa.hb.QLb;this.U0h=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("TellMeSeeMoreButtonIsEnabledInZeroTerm");this.n_h=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("HelpShowsTopSearchResult");this.IWh=this.jqc||this.iqc;this.GWh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("OnlineCommandSuggestionsIsEnabled");this.HWh=this.fje;this.TTh=!!e.AFrameworkApplication.fa&&this.$ya&&e.AFrameworkApplication.fa.ka("StyledHeaderInLabelIsEnabled");
this.gRh=e.AFrameworkApplication.fa?e.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceFastSetRequestTimeOut",1400):1400;this.oRh=e.AFrameworkApplication.fa?e.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceSlowSetRequestTimeOut",1400):1400;this.dRh=e.AFrameworkApplication.fa?parseFloat(e.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.ClassifierHighConfidenceThreshold","-0.6")):-.6;this.QTh=
!!e.AFrameworkApplication.fa&&(e.AFrameworkApplication.fa.ka("SmartLookupNoteSearchIsEnabled")||e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupNoteSearchIsEnabled",!1));this.DSh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OpenSerpletActionAIFromTellMe",!1)&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletEnableActionAITab",!1)&&Sg.a.R3();this.m0h=
e.AFrameworkApplication.fa?e.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.SubstrateSearchEndpointUrl","https://substrate.office.com/search/api/v1/suggestions"):"https://substrate.office.com/search/api/v1/suggestions";this.rRh=e.AFrameworkApplication.fa?e.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.SubstrateUrlParameters",""):"";this.o_h=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.ShouldHideQueryInResults",
!1);this.L_h=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.SimplifiedGroupingExpEnabled",!1);this.y_h=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("ShowFindInDocumentInZeroTermSearchBox")||this.HH;this.aUh=!!e.AFrameworkApplication.fa&&(e.AFrameworkApplication.fa.ka("TellMeTemplateProviderIsEnabled")||e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.TemplateProviderEnabled",
!1));this.xTh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.TellMe.OfficeScriptsSamplesProvidersEnabled",!1);this.NTh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("TellMeIsRuleBasedSortingEnabled")&&"en-US"===e.AFrameworkApplication.uiCulture;this.YTh=!!e.AFrameworkApplication.fa&&(e.AFrameworkApplication.fa.ka("TellMeFeedbackProviderIsEnabled")||e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.FeedbackProviderEnabled",
!1));this.mUh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("TellMeZeroTermContextualCommandSuggestionsEnabled");this.xMh=this.$ya&&!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.UseBoldedSuggestedSearchesStrings",!1);this.FRh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.GroupReduxActionUpdates",!1);this.Q_h=!!e.AFrameworkApplication.fa&&(e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.SkipFindCount",
!1)||"Word"!==e.AFrameworkApplication.fa.Ha("Application"));this.eNh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.BreakIssueQueryIntoTasks",!1);this.e2h=!!e.AFrameworkApplication.fa&&(e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.UsePerformanceMarker",!1)||e.AFrameworkApplication.fa.ka("TellMePerformanceMarkerEnabled"));this.FSh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinProviderEnabled",
!1);this.JSh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinStoreLinkEnabled",!1);this.OTh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchDescriptionEnabled",!1);this.wZh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SearchAddinByKeywords",!1);this.ZLh=!!e.AFrameworkApplication.fa&&
e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinSearchKeywordsContainDescription",!1);this.nRh=e.AFrameworkApplication.fa?e.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMe.MenuUpdatePolicy",0):0;this.$Th=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("TellMeNotesSuggestionIsEnabled")||this.Lkg;this.HSh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchStoreEntryButtonText1Enabled",
!1);this.ISh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchStoreEntryButtonText2Enabled",!1);this.GSh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchIntegratedTellMeServiceEnabled",!1);this.V0h=this.fUj&&(this.rHe||this.sHe||this.$jc||this.$ya&&Sg.a.R3()&&!!e.AFrameworkApplication.fa&&(this.WLb||this.Pjb||this.Qjb||this.Rjb||this.XLb||e.AFrameworkApplication.fa.ka("ShowAnswerSearchResults")||
e.AFrameworkApplication.fa.ka("ShowDefinitionSearchResults")||e.AFrameworkApplication.fa.ka("ShowEntitySearchResults")||e.AFrameworkApplication.fa.ka("ShowWolframSearchResults")));this.$Lh=!!e.AFrameworkApplication.fa&&!e.AFrameworkApplication.fa.ka("AppsForOfficeThirdPartyIsDisabled")&&e.AFrameworkApplication.fa.ka("AppsForOfficeAllowExternalMarketplace")&&e.AFrameworkApplication.tia;this.aMh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("AppsForOfficePrivateCatalogIsEnabled");this.GCj(Ia||
{});this.UId="2918242107";this.TId="1454393937";this.$3a={};this.XOa=[];this.$yi=[Sg.a.Isd]}get application(){return this.pmb}get vrb(){return this.FMh}get C1k(){return this.UId}get B1k(){return this.TId}get FTf(){return this.I$e}get CWi(){return this.J$e}get MEa(){return this.vSh}get Eya(){return this.X_h}get W5a(){return this.vMh}get yxj(){return this.KRh}get cpl(){return this.a1h}get fUj(){return!0}get Sol(){return this.V0h}get Ecl(){return this.mmf}lal(Ia){this.mmf=Ia}get $ya(){return this.S0h}get bsc(){return this.T0h}get asc(){return this.R0h}get vVi(){return this.yQh}get Qol(){return this.U0h}get V0e(){return!1}get $jc(){return this.IWh}get rHe(){return this.GWh}get sHe(){return this.HWh}get NUa(){return!1}get r_c(){return!1}get Hke(){return this.TTh}get hWe(){return this.C_h}get WLb(){return!1}get Sdl(){return!1}get YXj(){return""}get Xej(){return 4}get Yej(){return 5}get rhj(){return""}get j8i(){return this.gRh}get E4f(){return this.oRh}get thj(){return 1E3}get shj(){return 1E-6}get qml(){return this.m0h}get YYe(){return!1}get pml(){return!1}get PRj(){return this.NTh}get $Zc(){return!1}get mke(){return!1}get pOj(){return!1}get oOj(){return!1}get Lkg(){return!1}get Okg(){return!1}get GTf(){return!1}get RLb(){return!1}get Pjb(){return!1}get Qjb(){return!1}get Rjb(){return!1}get XLb(){return!1}get jqc(){return this.n_h}get SLb(){return this.o_h}get iqc(){return!1}get R4d(){return null}get hke(){return!1}get Wod(){return this.y_h}get c2f(){return 0}get K3i(){return this.dRh}get g5f(){return this.rRh}get mTj(){return this.QTh}get tXc(){return this.DSh}get M1f(){return-3.9}get HH(){return this.L_h}get t$b(){return this.aUh}get lje(){return this.xTh}get Uke(){return this.YTh}get CPa(){return this.xMh}get bWj(){return this.mUh}get bda(){return this.FRh}get Xvh(){return this.Q_h}get aii(){return this.eNh}get Ztd(){return this.e2h}get vXc(){return this.FSh}get $Gj(){return this.JSh}get gSj(){return this.OTh}get rnh(){return this.wZh}get Oai(){return this.ZLh}get zq(){return this.nRh}get OUa(){return this.$Th}get YGj(){return this.HSh}get ZGj(){return this.ISh}get XGj(){return this.GSh}get gtf(){return this.$Lh}get htf(){return this.aMh}get Np(){return!!e.AFrameworkApplication.Aa&&
e.AFrameworkApplication.Aa.hb.Lo}get Lo(){return!!e.AFrameworkApplication.Aa&&e.AFrameworkApplication.Aa.hb.Lo}get uOj(){return!!e.AFrameworkApplication.Aa&&e.AFrameworkApplication.Aa.hb.zoa}get zjk(){return ra.getImageClass("OfficeAssistant_32x32x32")}t8i(){return Promise.reject("GetFindMatchCount method is not overridden")}F_c(Ia){return Array.contains(appChrome.selectors.getVisibleControlIds(),Ia)}Bhe(){return!1}get bje(){return!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("TellMeModelRankerEnabled")}get BAh(){return e.AFrameworkApplication.fa?
e.AFrameworkApplication.fa.Ha("TellMeServiceHelpClassifierModelName"):""}get fje(){return!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("TellMeMultiLingualCommandModelEnabled")}get gVc(){return"NoOpHeaderUi"}get Zyi(){return this.iwc}get parameterData(){return this.$3a}get Jul(){return this.XOa}ERi(){if(this.Nvd&&!this.y5e&&(this.y5e=!0,this.lod(this.Nvd),this.Lo)){var Ia=w.a.instance.resolve("Common.IExternalUICommandDefinitionMapping");Ia=(new jc.a(Ia)).O3d(this.Nvd.Eaa);appChrome.api.dispatch(Ia)}}get unh(){return""}lod(){}MKi(Ia){const nb=
[];for(let Kb=0;Kb<Ia.length;++Kb)Ia[Kb].Eel?nb.push(new He.a(Ia[Kb].alternate,Sg.a.DDh+Kb.toString())):nb.push(new He.a(Ia[Kb].standard,Sg.a.Isd+Kb.toString()));return nb}GCj(Ia){const nb={};for(let Kb in Ia){const dc=Kb,Ic=Ia[Kb];for(let Id in Ic){const ae=Id,Od=Ic[Id];(nb[ae]||(nb[ae]={}))[dc]=Od}}this.iwc=nb}get CAh(){return""}get mvh(){return!1}}Object(k.a)(be,"TellMeApplicationData",null,[953]);class Md{constructor(Ia,nb=null,Kb=!1){this.standard=Ia;this.alternate=nb;this.Eel=Kb}}Object(k.a)(Md,
"TryQuerySet",null,[]);class de{constructor(){this.Pgf=this.Qgf=null}get Yhk(){return this.Pgf}SK(Ia){this.Qgf=Ia;return this.EDi(Ia)}mkk(){this.Pgf=this.Qgf}T$i(Ia){return 8===Ia.type?String.format(CommonUIStrings.l_FindInDocumentText,Ia.CJ):Ia.CJ}y4i(Ia){return Ia.CJ}}Object(k.a)(de,"ParameterizedCommand",null,[]);class Zc extends de{constructor(Ia){super();this.TSj=Ia}get commandId(){return this.TSj?"FindParameterized":"EditingFind"}get sxk(){return"Find"}EDi(Ia){if(!Ia)return null;const nb=na.a.pe(String.format(ResourceStrings.l_ParamFindInDocTitle,
Ia.CJ));return wa.a(Sg.a.aHi(Ia.value),"1540292897",nb,"Find_16x16x32",null,na.a.pe(Ia.CJ),nb,null,null)}}Object(k.a)(Zc,"FindParameterizedCommand",de,[]);var Yf=d(122);class Vc extends be{constructor(){super(window.TellMeControlMetadataOverrides);this.pmb="PowerPoint";if(e.AFrameworkApplication.fa.ka("TellMeTryQueriesIsEnabled")){var Ia=[new Md(ResourceStrings.l_TellMeTryQuery01,"",!1),new Md(ResourceStrings.l_TellMeTryQuery02,"",!1),new Md(ResourceStrings.l_TellMeTryQuery03,"",!1),new Md(ResourceStrings.l_TellMeTryQuery04,
"",!1),new Md(ResourceStrings.l_TellMeTryQuery05,"",!1)];this.XOa=this.MKi(Ia)}e.AFrameworkApplication.fa.ka("TellMeFindInDocumentIsEnabled")&&(Ia=new Zc(Vc.SSj()),this.parameterData[Ia.commandId]=Ia,this.J$e=!0,this.I$e=Ia.commandId)}get kKa(){return Yf.a.lzf}lod(Ia){if(Ia){Ia=Ia.Eaa;var nb=e.AFrameworkApplication.fa;Ia["PptTellMe.Animation"]=!nb.ka("TellMeAnimationsTransitionsIsEnabled")||nb.ka("241");Ia["PptTellMe.Transition"]=!nb.ka("TellMeAnimationsTransitionsIsEnabled");Ia["PptTellMe.SelectAll"]=
!nb.ka("TellMeSelectAllResultIsEnabled");Ia["PptTellMe.AnimationNew"]=!nb.ka("241")||!nb.ka("TellMeAnimationsTransitionsIsEnabled");Ia["PptTellMe.Designer"]=!nb.ka("248");nb=nb.ka("TellMeDesktopUpSellIsEnabled");var Kb=e.AFrameworkApplication.gUj;Ia["PptTellMe.WordArtUpSellButton"]=!nb||Kb;Ia["PptTellMe.SpellCheckDictUpSellButton"]=!nb||Kb;Ia["PptTellMe.InsertAudioUpSellButton"]=!nb||Kb;Ia["PptTellMe.InsertChartUpSellButton"]=!nb||Kb;Ia["PptTellMe.WordArtUpSellButtonEnterprise"]=!nb||!Kb;Ia["PptTellMe.SpellCheckDictUpSellButtonEnterprise"]=
!nb||!Kb;Ia["PptTellMe.InsertAudioUpSellButtonEnterprise"]=!nb||!Kb;Ia["PptTellMe.InsertChartUpSellButtonEnterprise"]=!nb||!Kb}}get Lkg(){return e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.TellMeNotesSuggestionIsEnabled",!1)}get Okg(){return e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.TellMeZeroTermNotesSuggestionIsEnabled",!1)}get c2f(){return e.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.PowerPointOnline.NumberOfNotesSuggestionsToShow",
2)}get CAh(){return e.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.PowerPointOnline.TellMeMultiLanguageModelName","")}get YYe(){return e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.TellMeServiceAADAuthIsEnabled",!1)}get BAh(){return e.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.PowerPointOnline.TellMeHelpClassifierModelName","")}get WLb(){return e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.TellMeShowImageSearchResults",
!1)}get fje(){return e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.TellMeMLCModelIsEnabled",!1)}get mvh(){return e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.TellMeShowMoreFileResults",!1)}get r_c(){return e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.TellMeEnableRankerLogging",!1)}get R4d(){const Ia={};e.AFrameworkApplication.fa.ka("PPTOModernFontPickerIsEnabled")?Ia.FontName="FontPicker":
Ia.FontPicker="FontName";e.AFrameworkApplication.fa.ka("ReactNewSlideLayoutEnabled")?(Ia.NewSlide="NewSlideSplit",Ia.ChangeLayout="ChangeLayoutFlyout"):(Ia.NewSlideSplit="NewSlide",Ia.ChangeLayoutFlyout="ChangeLayout");return Ia}get M1f(){var Ia=e.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.PowerPointOnline.TellMe.NBClassifierScoreThreshold","-3.9");Ia=parseFloat(Ia);return isNaN(Ia)?-3.9:Ia}get $Zc(){return e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.TellMe.IsSerpletClassifierEnabled",
!1)}get gtf(){return e.AFrameworkApplication.fa.ka("51")}get htf(){return e.AFrameworkApplication.fa.ka("305")}static SSj(){return!!e.AFrameworkApplication.Aa&&e.AFrameworkApplication.Aa.hb.Np}}Object(k.a)(Vc,"PowerPointTellMeApplicationData",be,[]);class zc extends Je{constructor(){super()}get name(){return"PowerPointEditor.TellMe"}load(){this.init()}init(){if(e.AFrameworkApplication.wAh){var Ia=Tf.App.Kb.hb.N8d(hb.a.tellMe);Ia.fYc?zc.y$g():Ia.zS(Object(A.a)(this,this.o1k,"scriptResource_LoadFinished"));
var nb=new Vc;ie.TellMeActor.instance.initialize(nb,null,null,null,null,null,Object(A.a)(Tf.App.Kb,Tf.App.Kb.HVf,"forceUpdateRibbonControls"),e.AFrameworkApplication.fa,this.Da.Ja("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),this.Da.Ja("Common.IActionContextProvider"),this.Da.Ja("Common.ISystemInitiatedFeedback"));ie.TellMeActor.instance.rOk(Ia)}}o1k(){zc.y$g()}static y$g(){Tf.App.Kb.updateCommandUI()}}Object(k.a)(zc,"PowerPointTellMePackage",Je,[]);var vf=d(209);class Tg{constructor(){this.nh=
this.I4=this.K=null}get name(){return"PowerPointWebEditor.Chronos1"}$b(Ia){this.K=Ia;this.I4=this.K.resolve("PowerPointWebEditor.Core.IBundleMetricRecorder");this.nh=this.I4.VDa(4,this.name);this.K.register(ce,"PowerPointWebEditor.RehydrationHeaderHandler").ma().oa(()=>new ce(this.K.resolve("PowerPointWebEditor.ICCPInfoOwner"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.ISessionInfoOwner")));this.K.register(me,"PowerPointWebEditor.SessionRehydrationController").ma().oa(()=>
new me(this.K.resolve("Box4.IAppFrame").AF(),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("Common.IKeyInputManager"),this.K.resolve("PowerPointWebEditor.IInputHandlerManager"),this.K.resolve("Common.IClickInputManager"),this.K.resolve("PowerPoint.IBrowserHelperManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.PodsPops.IPodSeamlessFailoverManager"),nb=>{C.FocusManager.Sr(nb)},e.AFrameworkApplication.Rz?this.K.resolve("PowerPointWebEditor.IPPTTokenRefreshManager"):
null));this.K.register(687,"PowerPointWebEditor.PodsPops.IPodSeamlessFailoverManager").ma().oa(()=>new Ag(this.K.resolve("PowerPointWebEditor.PodsPopsCore.IPodSessionCoreManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.IPPTWorkspace"),this.K.resolve("Common.IActionManager"),this.K.resolve("Common.ITaskManager"),this.K.resolve("PowerPointWebEditor.RehydrationHeaderHandler"),this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.K.resolve("PowerPointWebEditor.IPopWebService"),
this.K.resolve("PowerPointWebEditor.IPopSessionState"),this.K.resolve("PowerPointWebEditor.Core.IPodsPopsEventHandler"),this.K.resolve("PowerPointWebEditor.IErrorHandler"),this.K.resolve("Box4.IReplicationScheduler"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventSource"),this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),this.K.resolve("PowerPointWebEditor.PodsPopsCore.IPopSessionManager"),this.K.resolve("PowerPointWebEditor.IInboundHelper"),this.K.resolve("PowerPointWebEditor.Image.IImageManager"),
e.AFrameworkApplication.Je,this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("Common.IAppSettingsManager"),this.K.resolve("PowerPointWebEditor.IPPTOfflineManager"),this.K.resolve("PowerPointWebEditor.Core.INetworkHealthManager"),this.K.Ja("PowerPointWebEditor.ICommentSessionManager")));e.AFrameworkApplication.Rz&&this.K.register(688,"PowerPointWebEditor.IPPTTokenRefreshManager").ma().oa(()=>new rf(this.K.resolve("PowerPointWebEditor.Core.ICoreEventSource"),this.K.resolve("Common.ISessionExpirationManagerWithDialog"),
this.K.resolve("PowerPointWebEditor.PresentationContext"),this.K.resolve("Common.IActionManager"),this.K.resolve("PowerPointWebEditor.PodsPops.IPodSeamlessFailoverManager"),this.K.resolve("Common.ITaskManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings")))}init(){let Ia=this.nh.su("resolvechronos1");const nb=this.K.resolve("Common.AFrameworkApplication"),Kb=this.K.resolve("PowerPointWebEditor.IApplicationContext").od;var dc=this.K.resolve("PowerPointWebEditor.View.IPPTPageView");const Ic=
this.K.resolve("Common.IActionManagerExtended"),Id=this.K.resolve("PowerPointWebEditor.IFocusManager"),ae=this.K.resolve("Common.Transaction.ITransactionFactory"),Od=this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),Hd=this.K.resolve("PowerPointWebEditor.IShapeEditor"),Bf=this.K.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),Of=this.K.resolve("PowerPointWebEditor.ShapeEdit.IShapeCountValidator"),ph=this.K.resolve("PowerPointWebEditor.PictureContext"),Qh=this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),
Lg=this.K.resolve("PowerPointWebEditor.IRibbonChangeManager"),Fg=this.K.resolve("PowerPointWebEditor.IPictureUploader");this.nh.yu(Ia);Ia=this.nh.su("regactorschronos1");dc=[new ve(Ic,Bf,Od,Id,this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),ae,Fg,ph,Hd,e.AFrameworkApplication.LQ,Lg,this.K.resolve("PowerPointWebEditor.IErrorHandler"),dc,this.K.resolve("PowerPointWebEditor.IPPTFileReaderHelper"),Kb.yMj,this.K.resolve("PowerPointWebEditor.IInsertImageHelper"),Qh,Of,Kb,this.K.resolve("PowerPointWebEditor.IBusinessBarController"),
this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("Common.IAppSettingsManager"))];for(var dg of dc)dg.vb(),dg.De();this.rCj();this.nh.yu(Ia);Ia=this.nh.su("tellme");dg=new zc;dg.$b(this.K);dg.load(nb);this.nh.yu(Ia);Kb.pptEditorTimeoutDialogRemovalIsEnabled&&Kb.wg&&(Ia=this.nh.su("initrehydrationcontroller"),this.K.resolve("PowerPointWebEditor.SessionRehydrationController").init(),this.nh.yu(Ia));Kb.podsSeamlessFailoverEnabled&&
this.K.resolve("PowerPointWebEditor.PodsPops.IPodSeamlessFailoverManager");e.AFrameworkApplication.Rz&&(Ia=this.nh.su("posttokenrefresh"),this.K.resolve("PowerPointWebEditor.IPPTTokenRefreshManager"),this.nh.yu(Ia));this.YYj()}rCj(){const Ia=this.K.resolve("Common.IActionManagerExtended"),nb=this.K.resolve("PowerPointWebEditor.IFocusManager"),Kb=this.K.resolve("Common.AFrameworkApplication").rr.Jd,dc=this.K.resolve("Common.Transaction.ITransactionFactory"),Ic=this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),
Id=this.K.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),ae=this.K.resolve("PowerPoint.IPathManager"),Od=this.K.resolve("PowerPointWebEditor.IPresentationReader"),Hd=this.K.resolve("Common.IDynamicScriptLoaderProvider").Pw;Hd.loadScript("powerpoint-editor-intl").then(()=>{cd.a.J(512497373,801,50,"Editor script is loaded successfully");Hd.loadScript("powerpoint-ribbon-intl").then(()=>{cd.a.J(512497372,801,50,"Ribbon script is loaded successfully");const Bf=[];Bf.push(new nd(Ia,
nb,Id,dc,Kb,this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Od,Ic,ae));for(const Of of Bf)Of.vb(),Of.De()}).catch(()=>{cd.a.J(512497371,801,10,"Failed to load Ribbon script")})}).catch(()=>{cd.a.J(512497370,801,10,"Failed to load Editor script")})}YYj(){cd.a.J(512497369,809,50,"Start to download chronos2 js file");this.K.resolve("PowerPointWebEditor.ScriptLoader.IUnifiedScriptLoader").Gca("pptedit.chronos2",()=>{const Ia=this.K.resolve("PowerPointWebEditor.ISessionState");Ia&&Ia.C5("Chronos2DownloadFinished")},
()=>d.e(8).then(d.bind(null,1222)))}dispose(){const Ia=this.K.resolve("PowerPointWebEditor.IApplicationSettings");Ia.pptEditorTimeoutDialogRemovalIsEnabled&&Ia.wg&&this.K.resolve("PowerPointWebEditor.SessionRehydrationController").dispose();e.AFrameworkApplication.Rz&&Ia.wg&&this.K.resolve("PowerPointWebEditor.IPPTTokenRefreshManager").dispose()}static main(){e.AFrameworkApplication.Tg&&Xb.a.fg?cd.a.J(512497368,809,15,"Firefox attempts to load chronos1 package when App is disposing"):n.a.instance.Dc(vf.a(new Tg,
4))}}Object(k.a)(Tg,"Chronos1Package",null,[2,3]);var bb=d(642),Vb=d(140),Ub=d(575),Jc=d(56),Mc=d(47);class ed{constructor(Ia,nb,Kb,dc,Ic,Id){this.type="FormatPictureTaskPaneProps";this.top=this.left=this.height=this.width=this.numberFormatInfo=null;this.disabled=!1;this.onChange=null;this.emptyValueFields=0;const ae=Object(fc.a)(Object,ec.e().numberFormatInfo);if(!ae)throw Error.argumentNull("numberFormatInfo");this.numberFormatInfo=ae;this.width=Ia;this.height=nb;this.top=dc;this.left=Kb;this.disabled=
Ic;this.emptyValueFields=Id}}Object(k.a)(ed,"FormatPictureTaskPaneProps",null,[]);class dd{constructor(Ia,nb,Kb,dc,Ic,Id,ae,Od,Hd,Bf,Of,ph){this.rcb=!0;this.rVg=this.jEg=this.g0=this.E0=0;this.pXa=this.Db=this.Pug=!1;ph.loadScript("powerpoint-editor-intl").then(()=>{this.pXa=!0}).catch(Qh=>{cd.a.J(512350083,801,10,"Failed to load powerpoint-editor-intl "+Qh.toString())});this.ob=Ia;this.Qb=nb;this.ia=Kb;this.Fa=dc;this.Lg=Ic;this.ua=Id;this.Fb=ae;this.Pi=Od;this.p9=Hd;this.fc=Bf;this.Lc=Of;this.Lg.BBa(Object(A.a)(this,
this.pdd,"onChangeRenderFormatPicturePane"));this.Qb.IK(Object(A.a)(this,this.Mu,"onAppFrameModeSwitched"));this.Lc.oPa(Object(A.a)(this,this.pdd,"onChangeRenderFormatPicturePane"))}dispose(){this.Lg.NZa(Object(A.a)(this,this.pdd,"onChangeRenderFormatPicturePane"));this.Qb.wY(Object(A.a)(this,this.Mu,"onAppFrameModeSwitched"));this.Lc.gib(Object(A.a)(this,this.pdd,"onChangeRenderFormatPicturePane"))}De(){}vb(){this.ia.ra(Jd.a.Hmc,ee.a.application,Object(A.a)(this,this.Hmc,"queryShowHideReactPictureCropPane"),
96);this.ia.ra(Jd.a.rpd,ee.a.application,Object(A.a)(this,this.rpd,"showHideReactPictureCropPane"),4);this.ia.ra(Jd.a.yOb,ee.a.application,Object(A.a)(this,this.yOb,"updatePictureCropPane"),4)}Hmc(Ia,nb,Kb,dc,Ic){(Ia=Object(fc.a)(Ra.a,Ic))&&Ia.Qf(this.Db);return 32}rpd(Ia,nb,Kb){if(!this.pXa)return 8;if(1===Kb)return 32;nb=this.ua.presentation;return this.ua.Ba&&nb&&!this.fc.$c(nb)?fd.b("ShowHideReactPictureCropPane:",this.Db.toString(),Ia,()=>{if(this.Db=!this.Db){if(this.em(),lf.a("CropControlEnableOnDisplayingFormatPicturePane")){const dc=
this.ob.Jp();(null===dc||void 0===dc?0:dc.Yx)||this.ia.processAction(Jd.a.wXd,2)}}else this.zr();return 32}):16}yOb(Ia,nb,Kb){if(!this.Db)return 8;2===Kb&&this.em(!0);return 32}em(Ia=!1){var nb=this.hTc();nb=this.jC(nb);const Kb=Object.assign(new bb.a,{title:ResourceStrings.L_FormatPicture,hideHeader:!1,width:320,location:2,contentProps:nb,onOpen:()=>{},onClose:()=>{this.Db=!1},isModernPane:!0});Vb.UISurfaces.xr().then(dc=>{Ia?dc.updateTaskPane(Mc.a.oJa,Kb):dc.showTaskPane(Mc.a.oJa,Kb);return null}).catch(dc=>
{cd.a.J(512350082,822,10,"Failed to show picture crop pane. Exception: "+dc.toString())})}zr(){Vb.UISurfaces.xr().then(Ia=>{Ia.hideTaskPane(Mc.a.oJa,2);return null}).catch(Ia=>{cd.a.J(512350081,822,10,"Failed to hide picture crop pane. Exception: "+Ia.toString())})}jC(Ia){if(Ia){const nb=Ia.U4d(),Kb=this.Fb.Ld;this.g0=Ub.a.Jv(Kb.rf(this.Pi.wM(Jc.a.lm(nb.ga(0),nb.ga(3)),Ia.zoom),1));this.E0=Ub.a.Jv(Kb.rf(this.Pi.wM(Jc.a.lm(nb.ga(0),nb.ga(1)),Ia.zoom),0));this.jEg=Ub.a.Jv(Kb.rf(this.Pi.wM(nb.ga(0).x,
Ia.zoom),0));this.rVg=Ub.a.Jv(Kb.rf(this.Pi.wM(nb.ga(0).y,Ia.zoom),1));this.rcb=!1;this.Pug=!0}else this.rcb=!0;Ia=new ed(this.E0,this.g0,this.jEg,this.rVg,this.rcb,this.Pug?0:15);Ia.onChange=Object(A.a)(this,this.Wwa,"onPropertyChange");return Ia}hTc(){const Ia=this.ob.Jp();return Ia&&Ia.Yx&&Ia.isConnected?this.p9.EF(Ia):null}Wwa(Ia,nb){const Kb={};Kb.Number=Ia;switch(nb){case 0:this.ia.La(Jd.a.Ftd,2,Kb);break;case 1:this.ia.La(Jd.a.Ctd,2,Kb);break;case 2:this.ia.La(Jd.a.Dtd,2,Kb);break;case 3:this.ia.La(Jd.a.Etd,
2,Kb)}this.em(!0)}pdd(){this.Db&&this.em(!0)}Mu(Ia){1===Ia.mode&&this.Db&&(this.Db=!1,this.zr(),this.Fa.Bj(Mc.a.oJa,this.Db))}}Object(k.a)(dd,"FormatPicturePaneActor",null,[]);var je=d(849);class Nd{constructor(Ia,nb,Kb,dc,Ic,Id,ae,Od,Hd,Bf,Of,ph,Qh,Lg,Fg,dg,hi,Mg){this.dCb=!1;if(!Fg)throw Error.argumentNull("shapeReader");if(dg&&!hi)throw Error.argumentNull("shapeSVGDependencyLoader");if(!Mg)throw Error.argumentNull("businessBarController");this.ia=Ia;this.pa=nb;this.Jb=Kb;this.vi=dc;this.fc=Ic;
this.vve=Id;this.Czg=ae;this.No=Od;this.Fb=Hd;this.ua=Bf;this.Pi=Of;this.p9=ph;this.OL=Qh;this.j0=Lg;this.Ea=Fg;this.ema=dg;this.tXa=hi;this.hl=Mg}vb(){this.ia.ra(Jd.a.wXd,S.a.application,Object(A.a)(this,this.E6b,"handlePictureCropEvent"),4);this.Czg?(this.ia.ra(Jd.a.uXd,S.a.application,Object(A.a)(this,this.Q7f,"handleCropSplitButton"),4),this.ia.ra(Jd.a.vXd,S.a.application,Object(A.a)(this,this.Q7f,"handleCropSplitButton"),4)):(this.ia.ra(Jd.a.uXd,S.a.application,Object(A.a)(this,this.E6b,"handlePictureCropEvent"),
4),this.ia.ra(Jd.a.vXd,S.a.application,Object(A.a)(this,this.E6b,"handlePictureCropEvent"),4));this.ia.ra(Jd.a.eMe,S.a.application,Object(A.a)(this,this.eHk,"queryIsActive"),101);this.ia.ra(Jd.a.apc,S.a.application,Object(A.a)(this,this.Buj,"handleSendCropInfo"),4);this.ia.ra(Jd.a.f$g,S.a.application,Object(A.a)(this,this.X$d,"handlePictureCropToShapeEvent"),4);this.ia.ra(Jd.a.e$g,S.a.application,Object(A.a)(this,this.X$d,"handlePictureCropToShapeEvent"),4);this.ia.ra(Jd.a.uIb,S.a.application,Object(A.a)(this,
this.Zhd,"queryPictureCropBounding"),100);this.ia.ra(Jd.a.wIb,S.a.application,Object(A.a)(this,this.Zhd,"queryPictureCropBounding"),100);this.ia.ra(Jd.a.vIb,S.a.application,Object(A.a)(this,this.Zhd,"queryPictureCropBounding"),100);this.ia.ra(Jd.a.pmc,S.a.application,Object(A.a)(this,this.Zhd,"queryPictureCropBounding"),100);this.ia.ra(Jd.a.Ctd,S.a.application,Object(A.a)(this,this.Btd,"updatePictureCropBounding"),4);this.ia.ra(Jd.a.Ftd,S.a.application,Object(A.a)(this,this.Btd,"updatePictureCropBounding"),
4);this.ia.ra(Jd.a.Dtd,S.a.application,Object(A.a)(this,this.Btd,"updatePictureCropBounding"),4);this.ia.ra(Jd.a.Etd,S.a.application,Object(A.a)(this,this.Btd,"updatePictureCropBounding"),4)}Q7f(Ia,nb,Kb,dc,Ic){return 1===Kb?32===this.X$d(Ia,nb,Kb,dc,Ic)||32===this.E6b(Ia,nb,Kb,dc,Ic)?32:8:this.E6b(Ia,nb,Kb,dc,Ic)}Buj(Ia,nb,Kb,dc,Ic){if(!Ic)return cd.a.J(512500482,824,50,"Send Crop Info called with no cropping info"),8;nb=Ic.pictCropperInfo;Ic=Ic.shapeNode;if(!Ic||!Ic.pictureCropInfo)return cd.a.J(512500481,
824,10,"Send Crop Info called with invalid ShapeMoniker"),8;if(1===Kb)return 32;if(Kb=id.a.Ib)Kb.actionName="EndCropPicture",Kb.Nj=!1,Kb.Qr=!0;Kb=this.Jb.zd(15);try{Kb.nc(Ic),Kb.jd=Ia,Ic.Okc=nb}finally{Kb&&Kb.dispose()}return 32}X$d(Ia,nb,Kb,dc,Ic){if(!this.Czg||this.fc.$c(this.pa.sk()))return 8;nb=this.pa.sg();if(!nb||!nb.length)return 8;const Id=[];for(var ae of nb)ae&&Id.push(ae);if(!Id.length)return 8;for(const Bf of Id)if(Bf.isLocal||this.OL.SW(Bf)||!this.cQj(Bf))return 8;if(1===Kb)return 32;
cd.a.J(512500480,824,15,"HandlePictureCropToShapeEvent:: Crop to Shape operation started");const Od=Ic?Ic.SourceControlId:"";ae=0;Kb=Od.split("_");if(3===Kb.length)ae=Number.parseInvariant(Kb[2]);else return cd.a.J(512500451,824,10,"HandlePictureCropToShapeEvent:: Crop to Shape operation called with unknown shapeName: '{0}'",Od),16;Kb=window.performance.now();Ic=new je.a;Ic.TargetShapeTypeAsInt=ae;ae=this.Jb.zd(15,void 0,()=>{for(const Bf of Id)if(Bf.Yx){const Of=this.al(Bf);Of&&Of.h1(!1)}cd.a.J(512500450,
824,50,"HandlePictureCropToShapeEvent:: Crop to Shape operation called with shapeName: '{0}'",Od)});try{ae.nc(Id[0]);ae.jd=Ia;for(var Hd of Id)Hd.Pkc=Ic}finally{ae&&ae.dispose()}Ia=window.performance.now();if(Hd=id.a.Ib)Hd.actionName="PictureCropToShape",Hd.Va("PictureCropShapeType",Ic.TargetShapeTypeAsInt.toString()),Hd.Va("PictureCropToShapeDuration",(Ia-Kb).toString()),id.a.zfa(Hd);cd.a.J(512500449,824,50,"HandlePictureCropToShapeEvent:: Crop to Shape operation completed for shapeType : '{0}'",
Ic.TargetShapeTypeAsInt);return 32}E6b(Ia,nb,Kb){if(!this.vve||this.fc.$c(this.pa.sk()))return 16;if(this.ema&&!this.tXa.qhg)return cd.a.J(512500448,824,10,"HandlePictureCropEvent:: Crop operation failed m_shapeSVGDependencyLoader is not loaded"),8;nb=this.pa.Xd();const dc=this.pa.M5d(nb);if(1!==nb.length)return lf.a("CropCannotBePerformedOnCurrentSelection")&&1!==Kb&&this.$Mf(),8;if(!dc)return 8;if(this.Ea.Yw(dc).length)return lf.a("CropCannotBePerformedOnCurrentSelection")&&1!==Kb&&this.$Mf(),8;
if(!this.Cje(dc))return 8;if(1===Kb)return 32;if(dc.isLocal||this.OL.SW(dc))return 16;if(dc.Yx){Ia=this.al(dc);if(!Ia)return 8;Ia.h1(!1);dc.pictureCropInfo=null;Tf.App.Kb.updateCommandUI();this.ia.processAction(Jd.a.yOb,2);return 32}this.pa.ij();const Ic=this.ua.Ba;this.fc.blockContent(Ic,Ia);const Id=id.a.Ib;Id&&(Id.actionName="BeginCropPicture",Id.Nj=!1,Id.Qr=!0);this.vi.J2f(dc.get_sid(),dc.get_cid(),dc.get_shapeId(),ae=>{id.a.vF(Id,()=>{this.Uok(dc,Ic,ae)})},()=>this.Tok(dc,Ic),!0);return 32}eHk(Ia,
nb,Kb,dc,Ic){if(!Object(bd.a)(Ra.a,Ic))return 8;Ia=this.pa.Jp();Ic.Qf(Ia?Ia.Yx:!1);return 32}hTc(){const Ia=this.pa.Jp();return Ia&&Ia.Yx&&Ia.isConnected?this.p9.EF(Ia):null}al(Ia){return Ia?Object(fc.a)(117,Ia.sc(this.Fb.Ma)):null}$Mf(){this.hl.VK(26)}Zhd(Ia,nb,Kb,dc,Ic){if(!this.vve||!Ic)return 16;nb=this.hTc();if(!nb)return 16;Kb=nb.U4d();dc=this.Fb.Ld;Ia=Ia===Jd.a.uIb?dc.rf(this.Pi.wM(Jc.a.lm(Kb.ga(0),Kb.ga(3)),nb.zoom),1):Ia===Jd.a.wIb?dc.rf(this.Pi.wM(Jc.a.lm(Kb.ga(0),Kb.ga(1)),nb.zoom),0):
Ia===Jd.a.vIb?dc.rf(this.Pi.wM(Kb.ga(0).x,nb.zoom),0):dc.rf(this.Pi.wM(Kb.ga(0).y,nb.zoom),1);Ic=Ic.queryResult;null!==Ic&&(Ic.uaa=parseFloat(Ub.a.Jv(Ia).toFixed(2)).toString());return 32}Btd(Ia,nb,Kb,dc,Ic){if(!this.vve||this.ema&&!this.tXa.qhg)return 16;nb=this.hTc();if(1===Kb)return nb?32:16;if(!nb||!Ic)return 16;if(2===Kb){Kb=!1;dc=nb.U4d().copy();Ic=Ub.a.MW(Ic.Number);const Id=Jc.a.lm(dc.ga(0),dc.ga(1)),ae=Jc.a.lm(dc.ga(0),dc.ga(3)),Od=this.Fb.Ld;Ia===Jd.a.Ctd?(Ic=this.Pi.zM(Od.Me(Ic,1),nb.zoom),
Ia=Ic-ae,dc.ga(2).hM(0,Ia),dc.ga(3).hM(0,Ia)):Ia===Jd.a.Ftd?(Ic=this.Pi.zM(Od.Me(Ic,0),nb.zoom),Ia=Ic-Id,dc.ga(1).hM(Ia,0),dc.ga(2).hM(Ia,0)):Ia===Jd.a.Dtd?(Kb=!0,Ic=this.Pi.zM(Od.Me(Ic,0),nb.zoom),Ia=Ic-dc.ga(0).x,dc.move(Ia,0)):Ia===Jd.a.Etd&&(Kb=!0,Ic=this.Pi.zM(Od.Me(Ic,1),nb.zoom),Ia=Ic-dc.ga(0).y,dc.move(0,Ia));nb.Qxl(dc,Kb)}return 32}cQj(Ia){let nb=[];Ia.Jf?nb=this.Ea.Yw(Ia):Ia.Kg&&(nb=this.Ea.Yw(Ia.rs()));if(nb.length){for(const Kb of nb)if(!this.Cje(Kb))return!1;return!0}return this.Cje(Ia)}Cje(Ia){const nb=
this.No.gZe&&!Ia.isGif&&(Ia.Ej||1===Ia.mediaType)&&!Ia.get_isSVGBlipFilled();return this.j0?nb&&!Ia.UFb:nb}Tok(Ia,nb){this.fc.ZJ(nb);if(!this.isActive||!Ia.isConnected)return!0;this.isActive=!1;Ia.pictureCropInfo=null;cd.a.J(512500446,824,10,"Error: Failed to perform command of Get picture crop info.");return!1}Uok(Ia,nb,Kb){this.fc.ZJ(nb);if(Ia.isConnected)if(nb=id.a.Ib,id.a.vF(nb,()=>{this.ia.processAction(Jd.a.S6a,2)}),this.OL.SW(Ia))cd.a.J(512500445,822,50,"Crop is cancelled due to shape manipulation");
else{var dc=Ia.tg(this.Fb.Ma);if(dc){var Ic=new Date;Ia.pictureCropInfo=JSON.parse(Kb.PictureCropInfoStr);this.p9.VG(Ia).Gkl();Ia=new Date;nb&&(nb.Wm("ParseCropInfoStart",Ic),nb.Wm("ParseCropInfoEnd",Ia),id.a.zfa(nb));dc.xA();this.ia.processAction(Jd.a.yOb,2)}}}get isActive(){return this.dCb}set isActive(Ia){this.dCb=Ia}}Object(k.a)(Nd,"PictureCropActor",null,[]);var Ld=d(1194),Xe=d(193),pe=d(184),fe=d(215),wd=d(131),Ue=d(165),rd=d(326),Ud=d(848),qe=d(619),Nf=d(46),sf=d(66),tf=d(718),Lf=d(114),kf=
d(206),Ed=d(167),Cd=d(881),oh=d(325),Kg=d(205),ri=d(185),Af=d(186),Zg=d(283);class gi{constructor(Ia,nb,Kb,dc,Ic,Id,ae,Od,Hd,Bf,Of,ph,Qh,Lg){this.Db=!0;this.Gk=!1;this.Gn=[];this.q4=this.bB=this.qX=this.uH=this.iJ=this.xb=null;this.MC=Array(8);this.lva=this.rn=this.Dv=null;this.pU=this.vd=1;this.Uze=new Jc.a(0,0);this.Hn=new Xe.a;this.x0=new pe.a;this.Tgc=new Jc.a(0,0);this.$eb=0;this.gu=new pe.a;this.Ava=new Jc.a(0,0);this.Yla=new Jc.a(0,0);this.mhc=this.yWa=!1;this.rec=new Jc.a(0,0);this.t$=this.U9=
null;this.bug=new ub.a;this.hu=null;if(!dc)throw Error.argumentNull("clickInputManager");if(!Ia)throw Error.argumentNull("shapeNode");if(Of&&!ph)throw Error.argumentNull("transformFactory");if(Of&&!Qh)throw Error.argumentNull("presReader");this.ta=Ia;this.Ea=nb;this.jc=Kb;this.Yc=dc;this.ia=Ic;this.PC=Id;this.ve=ae;this.v9=Od;this.Abk=Hd;this.Mva=Bf;this.ema=Of;this.wk=ph;this.s6j=Lg}Im(Ia){this.xb=new ri.a;this.xb.Yj(1);this.xb.Pd(!1);this.xb.loa(sf.a.cml);Ia.appendChild(this.xb.viewport);this.iJ=
new tf.a(!1,this.ema);this.xb.appendChild(this.iJ);this.uH=new tf.a(!1,this.ema);this.xb.appendChild(this.uH);this.uH.Yj(1);this.qX=new Ed.a;this.qX.Su(Pd.a.o1);this.qX.jr(Pd.a.NE);this.qX.KE(Lf.a.none);this.qX.Yj(1);this.xb.appendChild(this.qX);this.q4=new Ed.a;this.q4.Yj(1);this.q4.nl(sf.a.Kya);this.q4.loa("ShapeMoveHandle");this.q4.KE(Lf.a.none);this.xb.appendChild(this.q4);this.bB=new kf.a;this.K0b(this.bB);this.xb.appendChild(this.bB);this.xb.viewport.xa.setAttribute("class",sf.a.Tkc);this.xb.Pd(!1);
this.Yc.pb(H.a.click,this.q4.xa,Object(A.a)(this,this.Dcd,"noOpHandler"));this.Yc.pb(H.a.click,this.qX.xa,Object(A.a)(this,this.Dcd,"noOpHandler"))}K0b(Ia){for(let dc=0;8>dc;++dc){var nb="cropHandle"+dc;const Ic=new kf.a;Ic.xa.id=nb;if(Xb.a.jLa){var Kb=new oh.a;Kb.xa.id=nb;Kb.setVisibility(!1);Kb.setPosition(-10,-10);Kb.ih(20,20);Ic.appendChild(Kb)}Kb=new Ue.a(dc);nb=Kb.I8b()?this.DBi(Kb,nb):this.GFi(Kb,nb);Ic.appendChild(nb);Ic.Yj(1);this.MC[dc]=Ic;Ia.appendChild(Ic)}}Hbe(Ia){for(let nb=0;8>nb;++nb)if(this.MC[nb].xa.id===
Ia.id)return new Ue.a(nb);return null}ARj(Ia){return Ia.id.startsWith("cropHandle")}dispose(){this.v9();this.Gk=!0;this.Db=!1;this.xb&&this.xb.yq();this.xb=null;this.q4&&this.Yc.yb(H.a.click,this.q4.xa,Object(A.a)(this,this.Dcd,"noOpHandler"));this.q4=null;this.qX&&this.Yc.yb(H.a.click,this.qX.xa,Object(A.a)(this,this.Dcd,"noOpHandler"));this.bB=this.qX=null;this.MC&&Array.clear(this.MC);this.U9=this.t$=this.MC=null;this.rec=new Jc.a(0,0)}Lod(Ia,nb,Kb,dc){const Ic=this.K8d(),Id=Ia-Ic.x+this.Yla.x+
Kb,ae=nb-Ic.y+this.Yla.y+dc;return isNaN(Id)||isNaN(ae)?(cd.a.J(512497029,822,15,"PictureCropShapeView::ShiftPositionRelativeToShape - x:{0}, nodeTopLeft.X:{1}, m_maskViewPositionDiff.X:{2}, distX:{3}, y:{4}, nodeTopLeft.Y:{5}, m_maskViewPositionDiff.Y:{6}, distY:{7}, m_zoom:{8}",Ia,Ic.x,this.Yla.x,Kb,nb,Ic.y,this.Yla.y,dc,this.vd),new Jc.a(0,0)):new Jc.a(Id,ae)}setPosition(Ia,nb){this.yWa&&this.ta.pictureCropInfo&&(this.Ava=Ia=new Jc.a(Ia/this.vd,nb/this.vd),this.Mva?(this.U9&&this.iJ&&(nb=this.Lod(this.U9.Position.X,
this.U9.Position.Y,Ia.x,Ia.y),this.iJ.setPosition(nb.x,nb.y)),this.t$&&this.uH&&this.uH.image&&(Ia=this.Lod(this.t$.Position.X,this.t$.Position.Y,Ia.x,Ia.y),this.uH.image.setPosition(Ia.x,Ia.y))):((nb=this.ta.pictureCropInfo.MaskViewElem)&&this.iJ&&(nb=this.Lod(nb.Position.X,nb.Position.Y,Ia.x,Ia.y),this.iJ.setPosition(nb.x,nb.y)),(nb=this.ta.pictureCropInfo.TextureViewElem)&&this.uH&&this.uH.image&&(Ia=this.Lod(nb.Position.X,nb.Position.Y,Ia.x,Ia.y),this.uH.image.setPosition(Ia.x,Ia.y))),this.xb.Pl())}rjl(Ia,
nb){const Kb=new Jc.a(this.Ea.SA(this.ta,this.PC).x/this.vd,this.Ea.SA(this.ta,this.PC).y/this.vd),dc=new Jc.a(this.Yla.x+this.Ava.x,this.Yla.y+this.Ava.y);if(this.Mva)this.U9&&this.iJ&&this.iJ.setPosition(this.U9.Position.X-Kb.x+dc.x+Ia/this.vd,this.U9.Position.Y-Kb.y+dc.y+nb/this.vd),this.t$&&this.uH&&this.uH.image.setPosition(this.t$.Position.X-Kb.x+dc.x+Ia/this.vd,this.t$.Position.Y-Kb.y+dc.y+nb/this.vd);else{var Ic=this.ta.pictureCropInfo.MaskViewElem;Ic&&this.iJ.setPosition(Ic.Position.X-Kb.x+
dc.x+Ia/this.vd,Ic.Position.Y-Kb.y+dc.y+nb/this.vd);(Ic=this.ta.pictureCropInfo.TextureViewElem)&&this.uH.image.setPosition(Ic.Position.X-Kb.x+dc.x+Ia/this.vd,Ic.Position.Y-Kb.y+dc.y+nb/this.vd)}this.xb.Pl()}sjl(Ia,nb){nb.Hj(1/this.pU);this.Drh(Ia,Xe.a.add(this.vYa,nb))}resize(Ia,nb){nb.Hj(1/this.pU);this.Drh(Ia,nb)}Drh(Ia,nb){Ia=this.FRd(Ia,nb);this.Nq(Ia);this.setOffsets(nb)}K8d(){const Ia=this.Ea.SA(this.ta,this.PC);return new Jc.a(Ia.x/this.vd,Ia.y/this.vd)}gHh(){this.ta.Yx&&(this.pU=this.jc.mg(this.ta).oq/
this.Uze.x)}Gkl(){const Ia=this.jc.mg(this.ta);this.Uze.update(Ia.oq,Ia.Wk)}Hj(Ia){this.vd=Ia;this.xb.Hj(this.vd);Ia=new pe.a;Ia.Vba(1/this.vd,1/this.vd);this.bB.LE(Ia,Kg.a.cca);this.s6j?this.rY(!1):this.rY(!0)}get zoom(){return this.vd/this.pU}U4d(){this.gHh();this.Dv||(this.Dv=this.ta.fp);var Ia=Jc.a.lm(this.Dv.ga(0),this.Dv.ga(1));const nb=Jc.a.lm(this.Dv.ga(0),this.Dv.ga(3)),Kb=this.Dv.Xf(),dc=new wd.a(new Jc.a(0,0),new Jc.a(Ia,0),new Jc.a(Ia,nb),new Jc.a(0,nb));dc.move(Kb.x-Ia/2,Kb.y-nb/2);Ia=
this.K8d();dc.move(Ia.x,Ia.y);dc.scale(this.pU,this.pU);return dc}Qxl(Ia,nb){Ia=Ia.copy();Ia.scale(1/this.pU,1/this.pU);var Kb=this.K8d();Ia.move(-1*Kb.x,-1*Kb.y);Kb=Ia.Xf();const dc=new pe.a;nb?dc.x7(this.ta.get_shapeRotation(),Kb):dc.x7(this.ta.get_shapeRotation(),this.Dv.ga(0));dc.El(Ia);nb||Ia.move(this.Dv.ga(0).x-Ia.ga(0).x,this.Dv.ga(0).y-Ia.ga(0).y);this.Dv=Ia;this.qX.ut(this.Dv.points);nb=this.uH.clipPath;lf.a("SVGCreationOnChangesFromFormatPane")&&this.ema&&nb?(nb.q_b=this.dLc(Ia),this.CFc(Ia.ga(0))):
nb&&nb.I6a&&nb.I6a.$2e(this.Dv.points);this.mhc=!0;this.rY(!0);this.xb.Pl()}setZIndex(Ia){this.xb.DB(Ia+2*rd.a.Taa)}setOffsets(Ia){this.Dv||(this.Dv=this.ta.fp);this.pbi(Ia);this.Hn=Ia;var nb=this.bB.UAb;Ia=new Jc.a(nb[0].x/this.vd,nb[0].y/this.vd);var Kb=new Jc.a(nb[2].x/this.vd,nb[2].y/this.vd);const dc=new Jc.a(nb[4].x/this.vd,nb[4].y/this.vd);nb=new Jc.a(nb[6].x/this.vd,nb[6].y/this.vd);Ia=new wd.a(Ia,Kb,dc,nb);this.qX.ut(this.Dv.points);Kb=this.uH.clipPath;this.ema&&Kb?(this.CFc(Jc.a.bV(Ia.points[this.$eb],
this.Tgc)),Kb.q_b=this.dLc(Ia)):Kb&&Kb.I6a&&Kb.I6a.$2e(Ia.points);this.xb.Pl()}pbi(Ia){var nb=this.Dv,Kb=Jc.a.lm(nb.ga(0),nb.ga(1));nb=Jc.a.lm(nb.ga(0),nb.ga(3));Ia.bottom-Ia.top<-1*nb&&(nb+=Ia.bottom-Ia.top,Ia.top+=nb,Ia.bottom-=nb);Ia.right-Ia.left<-1*Kb&&(Kb+=Ia.right-Ia.left,Ia.left+=Kb,Ia.right-=Kb)}Nq(Ia){this.x0=Ia;this.qX.LE(Ia,Kg.a.cca);this.rY(!0)}Ru(Ia){this.gu=Ia;this.xb.LE(Ia,Kg.a.esb);this.xb.Pl()}My(){Array.clear(this.Gn)}YD(Ia){return this.ARj(Ia)?this.Hbe(Ia):null}yB(Ia){const nb=
[];var Kb=this.ta.pictureCropInfo;if(this.ta.Yx){const dc=this.jc.mg(this.ta);if(Kb.MaskViewElem){let Ic=Zg.a.bLc(6,dc.oq,dc.Wk);Array.add(nb,Ic)}Kb.TextureViewElem&&(Kb=Zg.a.bLc(7,dc.oq,dc.Wk),Array.add(nb,Kb));Array.add(this.Gn,Ia)}else this.Db=!1,this.xb.Pd(!1);return nb}eD(){}iBl(){this.rec.x!==this.iJ.x&&this.rec.y!==this.iJ.y&&(cd.a.J(512497026,822,50,"PictureCropShapeView::UpdateViewElementPositionForRedraw - Updating maskViewElements and PictureViewElements "),this.U9.Position.X=this.iJ.x+
this.Ea.SA(this.ta,this.PC).x/this.vd,this.U9.Position.Y=this.iJ.y+this.Ea.SA(this.ta,this.PC).y/this.vd,this.t$.Position.X=this.uH.image.x+this.Ea.SA(this.ta,this.PC).x/this.vd,this.t$.Position.Y=this.uH.image.y+this.Ea.SA(this.ta,this.PC).y/this.vd,this.Yla.update(0,0))}gZb(Ia,nb){const Kb=this.wk.kLc();this.ta.get_isVerticallyFlipped()&&(Kb.Vba(1,-1),Kb.VB(0,2*nb._y));this.ta.get_isHorizontallyFlipped()&&(Kb.Vba(-1,1),Kb.VB(2*nb._x,0));Kb.x7(Ia,nb);return Kb}U4f(){return this.ta.get_isVerticallyFlipped()&&
this.ta.get_isHorizontallyFlipped()?2:this.ta.get_isVerticallyFlipped()?3:this.ta.get_isHorizontallyFlipped()?1:0}CFc(Ia){const nb=new pe.a;nb.VB(Ia._x,Ia._y);this.uH.clipPath.LE(nb,Kg.a.cca)}dLc(Ia){cd.a.J(512497025,809,15,"PictureCropShapeView:: createSVG operation started");var nb=this.ta.get_shapeRotation();this.wk.rca(-nb,Ia.Xf()).El(Ia);this.hu||(this.hu=svgShape.FactoryGlobal.createShape());this.hu.setSVGRoot(this.xb.xa,!1);this.ta.KK?this.hu.setShapeType(this.ta.KK):(this.hu.setShapeType(4),
cd.a.J(539760099,809,50,"ShapeNode ArtShapeType is null"));this.hu.setOffsets(this.ta.get_xPersisted()+Ld.a.qY(Ia.ga(0).x/this.pU,0),this.ta.get_yPersisted()+Ld.a.qY(Ia.ga(0).y/this.pU,1));this.hu.setExtents(Ld.a.qY(Ia.ga(1).x-Ia.ga(0).x,0),Ld.a.qY(Ia.ga(2).y-Ia.ga(1).y,1));var Kb=svgShape.FactoryGlobal.getConvertor().getPath(this.hu,!1,this.pU,this.pU);if(!Kb||!Kb.length)throw cd.a.J(512497024,822,15,"PictureCropShapeView::CreateSVG -No response received from getPath"),Error.invalidOperation(" Invalid response for svgpath element");
Ia=Array(Kb.length);nb=0;for(const dc of Kb)Kb=new Ed.a,Kb.i1(dc),Kb.xa.setAttribute(Lf.a.PNb,this.gu.Wkb()),Ia[nb++]=Kb;cd.a.J(512496995,809,15,"PictureCropShapeView:: createSVG operation ended");return Ia}draw(Ia,nb){if(Array.contains(this.Gn,Ia)){Array.remove(this.Gn,Ia);if(this.ta.pictureCropInfo&&!this.yWa){if(this.ta.pictureCropInfo.MaskViewElem){Ia=this.ta.pictureCropInfo.MaskViewElem;var Kb=Ia.Clip,dc=this.jc.mg(this.ta);dc=Zg.a.bLc(6,dc.oq,dc.Wk);if(dc=nb[dc.toString()])this.iJ.G6k(dc.Base64Data,
Ia.Id.toString(),Kb.Bounds.Left,Kb.Bounds.Top,Kb.TotalWidth,Kb.TotalHeight,Kb.Bounds.Right-Kb.Bounds.Left,Kb.Bounds.Bottom-Kb.Bounds.Top),this.iJ.Pd(!0),this.iJ.setPosition(Ia.Position.X-this.Ea.SA(this.ta,this.PC).x/this.vd,Ia.Position.Y-this.Ea.SA(this.ta,this.PC).y/this.vd);this.U9=Ia;this.rec=new Jc.a(this.iJ.x,this.iJ.y)}this.ta.pictureCropInfo.TextureViewElem?(Ia=this.jc.mg(this.ta),dc=Zg.a.bLc(7,Ia.oq,Ia.Wk),Ia=this.ta.pictureCropInfo.TextureViewElem,Kb=Ia.Clip,(nb=nb[dc.toString()])?this.ema?
(this.$eb=this.U4f(),this.Tgc=this.rn.points[this.$eb].copy(),this.CFc(Jc.a.bV(this.ta.fp.points[this.$eb],this.Tgc)),this.gu=this.gZb(this.ta.get_shapeRotation(),this.ta.fp.Xf()),this.uH.H6k(nb.Base64Data,Ia.Id.toString(),Ia.Position.X-this.Ea.SA(this.ta,this.PC).x/this.vd,Ia.Position.Y-this.Ea.SA(this.ta,this.PC).y/this.vd,Kb.TotalWidth,Kb.TotalHeight,this.rn.copy().points,this.dLc(this.rn.copy()))):this.uH.F6k(nb.Base64Data,Ia.Id.toString(),Ia.Position.X-this.Ea.SA(this.ta,this.PC).x/this.vd,Ia.Position.Y-
this.Ea.SA(this.ta,this.PC).y/this.vd,Kb.TotalWidth,Kb.TotalHeight,this.ta.fp.points):cd.a.J(512496993,822,50,"PictureCropShapeView::Draw - No Crop Texture Image Downloaded"),this.t$=Ia):cd.a.J(512496992,822,50,"PictureCropShapeView::Draw - Unable to set image and bounds to polygon as TextureViewElem is null");this.Dv&&Jc.a.lm(this.Dv.ga(0),this.Dv.ga(2))||(this.Dv=this.ta.fp);this.lva=this.ta.RYa;this.q4.ut(this.lva.points);this.qX.ut(this.Dv.points);this.yWa=!0;this.rY(!0);this.visible=this.Db}else this.Mva&&
this.U9&&this.t$&&(this.iBl(),this.iJ.setPosition(this.U9.Position.X-this.Ea.SA(this.ta,this.PC).x/this.vd,this.U9.Position.Y-this.Ea.SA(this.ta,this.PC).y/this.vd),this.uH.image.setPosition(this.t$.Position.X-this.Ea.SA(this.ta,this.PC).x/this.vd,this.t$.Position.Y-this.Ea.SA(this.ta,this.PC).y/this.vd),this.ema?(this.$eb=this.U4f(),this.Tgc=this.rn.points[this.$eb].copy(),this.CFc(Jc.a.bV(this.ta.fp.points[this.$eb],this.Tgc)),this.gu=this.gZb(this.ta.get_shapeRotation(),this.ta.fp.Xf()),this.uH.clipPath.q_b=
this.dLc(this.ta.fp)):this.uH.clipPath.I6a=new Cd.a(this.ta.fp.points,0),this.rec=new Jc.a(this.iJ.x,this.iJ.y),this.Dv=this.ta.fp,this.lva=this.ta.RYa,this.q4.ut(this.lva.points),this.qX.ut(this.Dv.points),this.rY(!0),cd.a.J(512496991,822,50,"PictureCropShapeView::Draw - Redrawed crop views "));this.xb.Pl();this.xb.Pd(this.Db)}}zxl(){if(this.Dv){var Ia=this.bB.UAb;const nb=new Jc.a(Ia[0].x/this.vd,Ia[0].y/this.vd),Kb=new Jc.a(Ia[2].x/this.vd,Ia[2].y/this.vd),dc=new Jc.a(Ia[4].x/this.vd,Ia[4].y/this.vd);
Ia=new Jc.a(Ia[6].x/this.vd,Ia[6].y/this.vd);this.Dv=new wd.a(nb,Kb,dc,Ia)}else this.Dv=this.ta.fp;this.rn=this.Dv.copy();this.lva||(this.lva=this.ta.RYa);this.lva.move(this.Ava.x,this.Ava.y);this.q4.ut(this.lva.points);this.Yla.hM(this.Ava.x,this.Ava.y);this.Ava.update(0,0);this.ve.sz(new Af.a(1))}U3i(){var Ia=this.bB.UAb;const nb=new Jc.a(Ia[0].x,Ia[0].y),Kb=new Jc.a(Ia[2].x,Ia[2].y),dc=new Jc.a(Ia[4].x,Ia[4].y);Ia=new Jc.a(Ia[6].x,Ia[6].y);return new wd.a(nb,Kb,dc,Ia)}U5i(){var Ia=this.ta.RYa.copy().points,
nb=new Jc.a(Ia[0].x*this.vd,Ia[0].y*this.vd);const Kb=new Jc.a(Ia[1].x*this.vd,Ia[1].y*this.vd),dc=new Jc.a(Ia[2].x*this.vd,Ia[2].y*this.vd);Ia=new Jc.a(Ia[3].x*this.vd,Ia[3].y*this.vd);nb=new wd.a(nb,Kb,dc,Ia);nb.scale(1/this.pU,1/this.pU);nb.move((this.Yla.x+this.Ava.x)*this.vd,(this.Yla.y+this.Ava.y)*this.vd);return nb}JE(Ia){this.yWa&&(this.bB.Pd(!Ia),Ia?(this.gHh(),this.mhc=!0):(this.zxl(),this.ia.processAction(Jd.a.yOb,2),this.Mva&&(Ia={["pictCropperInfo"]:this.lyf(),["shapeNode"]:this.ta},
this.ia.La(Jd.a.apc,2,Ia))))}Yp(){return this.xb.Yp()}rY(Ia){if(this.yWa){var nb=this.Dv.copy();Ia&&this.x0.El(nb);Ia=new pe.a;Ia.yqb(this.ta.get_shapeRotation());var Kb=2*Math.ceil((this.ta.get_shapeRotation()-45)/90)%8;for(let dc=0;8>dc;++dc){const Ic=this.MC[dc];Ic.nl(Nf.a.cQ(fe.a.box4Image(gi.Eoc[Kb]),sf.a.vA));this.BKa(Ic,nb.qk(new Ue.a(dc)));Ic.LE(Ia,Kg.a.esb);Kb=(Kb+1)%8}}}BKa(Ia,nb){Ia.x===nb.x*this.vd&&Ia.y===nb.y*this.vd||Ia.setPosition(nb.x*this.vd,nb.y*this.vd)}get visible(){return this.Db}set visible(Ia){this.Db=
Ia;!Ia&&this.yWa&&(this.OSi(),this.yWa=!1);this.xb.Pd(this.Db)}OSi(){if(this.yWa){if(this.mhc){const Ia={["pictCropperInfo"]:this.lyf(),["shapeNode"]:this.ta};this.ia.La(Jd.a.apc,2,Ia)}this.M2()}}lyf(){let Ia,nb,Kb,dc;const Ic=this.Rmi();({left:Ia,top:nb,right:Kb,bottom:dc}=this.Fvi());return Object.assign(new Ud.a,{Left:Ia,Top:nb,Right:Kb,Bottom:dc,X:Ic.x,Y:Ic.y})}Fvi(){let Ia,nb,Kb,dc;({left:Ia,top:nb,right:Kb,bottom:dc}=this.DKi());({left:Ia,top:nb,right:Kb,bottom:dc}=this.pzi(Ia,nb,Kb,dc));({left:Ia,
top:nb,right:Kb,bottom:dc}=gi.QCl(Ia,nb,Kb,dc));return{left:Ia,top:nb,right:Kb,bottom:dc}}DKi(){let Ia,nb,Kb;var dc=this.lva.points;const Ic=this.Dv.points;Ia=qe.a(dc[3],dc[0],Ic[3],Ic[0]);nb=qe.a(dc[0],dc[1],Ic[0],Ic[1]);Kb=qe.a(dc[1],dc[2],Ic[1],Ic[2]);dc=qe.a(dc[2],dc[3],Ic[2],Ic[3]);return{left:Ia,top:nb,right:Kb,bottom:dc}}pzi(Ia,nb,Kb,dc){var Ic=this.lva.points;const Id=Jc.a.lm(Ic[0],Ic[1]);Ic=Jc.a.lm(Ic[1],Ic[2]);Ia=Math.floor(Ia/Id*1E6)/1E6;nb=Math.floor(nb/Ic*1E6)/1E6;Kb=Math.floor(Kb/Id*
1E6)/1E6;dc=Math.floor(dc/Ic*1E6)/1E6;return{left:Ia,top:nb,right:Kb,bottom:dc}}Rmi(){var Ia=this.Dv.copy(),nb=new pe.a,Kb=Ia.Xf();nb.x7(-1*this.ta.get_shapeRotation(),Kb);nb.El(Ia);Kb=this.Ea.SA(this.ta,this.PC);this.Abk?(nb=this.PC.rf(Ia.hc*this.vd+Kb.x,0),Ia=this.PC.rf(Ia.kc*this.vd+Kb.y,1),Ia=new Jc.a(nb,Ia)):Ia=new Jc.a(Ia.hc+Kb.x/this.vd,Ia.kc+Kb.y/this.vd);return Jc.a.scale(Ia,this.pU,this.pU)}Dcd(){return!0}M2(){this.qX.LE(new pe.a,Kg.a.cca);this.q4.setPosition(0,0);this.Hn=new Xe.a;this.rn=
this.Dv=this.x0=this.ta.pictureCropInfo=null;this.Yla.update(0,0);this.mhc=!1;this.Uze.update(0,0);this.pU=1}FRd(Ia,nb){const Kb=new pe.a;this.rn||(this.rn=Ia);Ia=this.rn.Xf();const dc=Jc.a.lm(this.rn.ga(0),this.rn.ga(1)),Ic=Jc.a.lm(this.rn.ga(0),this.rn.ga(3)),Id=dc?1+(nb.right-nb.left)/dc:1,ae=Ic?1+(nb.bottom-nb.top)/Ic:1,Od=Ia.copy();Od.hM(-1*dc/2,-1*Ic/2);Kb.x7(-1*this.ta.get_shapeRotation(),Ia);Kb.VB(-1*Od.x,-1*Od.y);Kb.Vba(Id,ae);Kb.VB(nb.left+Od.x,nb.top+Od.y);Kb.x7(this.ta.get_shapeRotation(),
Ia);return Kb}DBi(Ia,nb){var Kb=[new Jc.a(0,0),new Jc.a(20,0),new Jc.a(20,5),new Jc.a(5,5),new Jc.a(5,20),new Jc.a(0,20)];Kb=new Cd.a(Kb,0);Kb.xa.id=nb;Kb.KE("black");Kb.Su("white");Kb.jr(1);Ia.equals(Ue.a.yE)?Kb.GKa(90):Ia.equals(Ue.a.Ku)?Kb.GKa(0):Ia.equals(Ue.a.RE)?Kb.GKa(180):Ia.equals(Ue.a.IH)&&Kb.GKa(-90);return Kb}GFi(Ia,nb){const Kb=new oh.a;Kb.xa.id=nb;Kb.KE("black");Kb.Su("white");Kb.jr(1);Kb.ih(20,5);Ia.equals(Ue.a.north)?Kb.setPosition(-10,0):Ia.equals(Ue.a.south)?Kb.setPosition(-10,-5):
Ia.equals(Ue.a.east)?(Kb.setPosition(-5,-10),Kb.ih(5,20)):Ia.equals(Ue.a.west)&&(Kb.setPosition(0,-10),Kb.ih(5,20));return Kb}get vYa(){return this.Hn}get me(){return this.xb.viewport}f8d(Ia){return!this.ta.Yx&&8>Ia.index?this.MC[Ia.index].xa:null}HN(){return!1}Jx(Ia){Ia&&(this.mhc=!1)}setSelection(){}static QCl(Ia,nb,Kb,dc){.999999<Ia+Kb&&(cd.a.J(512496987,822,15,"Invalid crop region inset values: left({0}), right({1})",Ia,Kb),Kb=(999999-1E6*Ia)/1E6);.999999<nb+dc&&(cd.a.J(512496986,822,15,"Invalid crop region inset values: top({0}), bottom({1})",
nb,dc),dc=(999999-1E6*nb)/1E6);return{left:Ia,top:nb,right:Kb,bottom:dc}}}gi.Eoc=[sf.a.oyh,sf.a.myh,sf.a.nyh,sf.a.lyh,sf.a.qyh,sf.a.pyh,sf.a.ryh,sf.a.syh];Object(k.a)(gi,"PictureCropShapeView",null,[781,284,285,106]);var jg=d(654);class Hh{constructor(Ia,nb,Kb){this.Ea=Ia;this.PC=nb;this.p9=Kb}setPosition(Ia,nb,Kb){this.p9.EF(Ia.shapeNode).rjl(nb,Kb)}setOffsets(Ia,nb){this.p9.EF(Ia.shapeNode).sjl(Ia.l2e.copy(),nb)}yI(Ia,nb){const Kb=new pe.a,dc=this.p9.EF(Ia.shapeNode);nb=nb?dc.U3i().copy():dc.U5i().copy();
Ia=this.Ea.SA(Ia.shapeNode,this.PC);Kb.VB(Ia.x,Ia.y);Kb.El(nb);return new jg.a(nb)}gG(Ia){return Ia.shapeNode.Yx}}Object(k.a)(Hh,"ShapeCropMoveResizeHandler",null,[715]);class hj{constructor(Ia,nb,Kb){this.p9=Ia;this.Mva=nb;this.m8c=Kb}h1(Ia,nb,Kb){if((Ia=this.p9.EF(Ia))&&Ia.visible!==Kb){for(const dc of nb)this.m8c&&(nb=Object(fc.a)(712,dc))&&nb.setSelected(!Kb),dc!==Ia&&(dc.visible=!Kb);Ia.visible=Kb}}cpd(){return!1}htd(Ia,nb,Kb){this.p9.EF(Ia).resize(Kb,nb)}dpd(){return!1}itd(Ia,nb,Kb,dc){dc&&
this.p9.EF(Ia).setPosition(nb,Kb)}L_c(){return!this.Mva}Y8a(Ia,nb){return this.Mva?nb:[this.p9.EF(Ia)]}gG(Ia){return Ia.Yx}}Object(k.a)(hj,"ShapeViewCropUpdateStrategyHandler",null,[713,714]);var Hk=d(277);class yd{constructor(){this.K=null}get name(){return"PowerPointWebEditor.PictureCrop"}$b(Ia){this.K=Ia;this.K.register(255,"PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IPictureCropShapeView>").ma().oa(()=>new Hk.a((nb,Kb)=>{let dc=null;const Ic=Object(fc.a)(117,
nb.sc(this.K.resolve("Box4.IPageView").Ma));Ic&&!Ic.Al&&(dc=new gi(nb,this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.resolve("Common.IClickInputManager"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Box4.IPageView").Ld,this.K.resolve("PowerPointWebEditor.View.IViewEventNotifier"),Kb,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptEditingSetPictureCropInfoCommandUsingMU,this.K.resolve("PowerPointWebEditor.IApplicationSettings").UIe,
this.K.resolve("PowerPointWebEditor.IApplicationSettings").ygd,this.K.resolve("PowerPointWebEditor.ITransformFactory"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").E2d),dc.Im(Ic.xa),dc.setZIndex(3),dc.visible=!1,Ic.FM(dc.me.xa,!0),Ic.dra(dc,3));return dc}));this.K.register(Nd,"PowerPointWebEditor.PictureCropActor").ma().oa(()=>new Nd(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),
this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.K.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").dQj,this.K.resolve("PowerPointWebEditor.IApplicationSettings").TIe,this.K.resolve("Common.IBrowserUtils"),this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.IPPTUnitConversion"),
this.K.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IPictureCropShapeView>"),this.K.resolve("PowerPointWebEditor.IGraphHotColdManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").cka,this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").ygd,this.K.resolve("PowerPointWebEditor.ShapeSVG.IShapeSVGDependencyLoader"),this.K.resolve("PowerPointWebEditor.IBusinessBarController")));this.K.register(dd,
"PowerPointWebEditor.FormatPicturePaneActor").ma().oa(()=>new dd(this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),this.K.resolve("PowerPointWebEditor.IPPTUnitConversion"),
this.K.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IPictureCropShapeView>"),this.K.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),this.K.resolve("Common.IDynamicScriptLoaderProvider").Pw))}init(){this.K.resolve("PowerPointWebEditor.ViewElements.ICompositeShapeViewUpdateStrategy").addHandler(new hj(this.K.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IPictureCropShapeView>"),
this.K.resolve("PowerPointWebEditor.IApplicationSettings").UIe,this.K.resolve("PowerPointWebEditor.IApplicationSettings").zgd));this.K.resolve("PowerPointWebEditor.ISmartGuideUtility").addHandler(new Hh(this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("Box4.IPageView").Ld,this.K.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IPictureCropShapeView>")));this.K.resolve("PowerPointWebEditor.PictureCropActor").vb();this.K.resolve("PowerPointWebEditor.FormatPicturePaneActor").vb();
this.K.resolve("PowerPointWebEditor.FormatPicturePaneActor").De()}dispose(){}static main(){n.a.instance.Dc(vf.a(new yd,0))}}Object(k.a)(yd,"PPTWebEditorPictureCropPackage",null,[2,3]);var ef=d(38),yh=d(243);class Bg{constructor(Ia,nb,Kb,dc,Ic){this.Tz=[ef.a.Ri,ef.a.font,$c.a.autonumberBulletType];this.Pb=Ia;this.Ll=nb;this.Hh=Kb;this.Jfc=dc;this.gJ=Ic}format(Ia){if(Ia&&Ia.Lzb){Ia=this.Pb.Nc(Ia);for(var nb=this.Ll.S2(Ia,Ia.currentNode);nb.moveNext();){var Kb=nb.currentNode;if(Kb&&this.Hh.Yd(Kb)){const dc=
this.gJ.nQ(Ia,this.Hh.Kgb(Kb));(Kb=this.Jfc.nSc(Kb))&&yh.d(dc,Kb,this.Tz)}}}}}Object(k.a)(Bg,"BeautifyListFormatter",null,[684]);class Kd{constructor(Ia,nb,Kb,dc,Ic){this.ia=Ia;this.ua=Kb;this.Jb=nb;this.Ea=dc;this.k4j=Ic}initialize(){this.vb()}vb(){this.ia.ra(Jd.a.SPd,S.a.application,Object(A.a)(this,this.SPd,"applyTextFormatterSuggestion"),4)}SPd(Ia,nb,Kb){if(1===Kb)return 32;Ia=this.ua.Ba;if(!Ia)return 16;nb=Ia.Pk();if(!nb||!nb.length)return 16;nb=this.Ea.n_(nb);if(!nb.length)return 16;Kb=this.Jb.zd(15);
Kb.nc(Ia);for(const dc of nb)this.k4j.format(dc);Kb.dispose();return 32}}Object(k.a)(Kd,"TextFormatterActor",null,[]);class Rj{constructor(){this.K=null}get name(){return"PowerPointWebEditor.TextFormatter"}$b(Ia){this.K=Ia;Ia.register(684,"PowerPointWebEditor.IBeautifyListFormatter").ma().oa(()=>new Bg(this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.Graph.ITraverserFactory"),this.K.resolve("Box4.IParagraphReader"),this.K.resolve("PowerPointWebEditor.IPPTParagraphReader"),
this.K.resolve("PowerPointWebEditor.IPptListEditor")));Ia.register(Kd,"PowerPointWebEditor.TextFormatter.TextFormatterActor").ma().oa(()=>new Kd(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("PowerPointWebEditor.IBeautifyListFormatter")))}init(){const Ia=this.K.resolve("Common.IAppSettingsManager");Ia.jf(()=>
{Ia.ka("818")&&this.K.resolve("PowerPointWebEditor.TextFormatter.TextFormatterActor").initialize()})}dispose(){}static main(){n.a.instance.Dc(vf.a(new Rj,0))}}Object(k.a)(Rj,"PPTWebEditorTextFormatterPackage",null,[2,3]);Type.registerNamespace("Box4.Symbols");Type.registerNamespace("PowerPointWebEditor");Type.registerNamespace("PowerPointWebEditor.PictureCrop");Type.registerNamespace("PowerPointWebEditor.TellMe");Type.registerNamespace("PowerPointWebEditor.TextFormatter");Sa.main();Type.registerNamespace("Common.App.O365Shell");
Za.main();Type.registerNamespace("Common.App.SessionExpiration");Type.registerNamespace("Common.App.SessionExpiration");Ab.main();Type.registerNamespace("Common.App.TellMe");Type.registerNamespace("Common.App.TellMe.CommandRanker.NaiveBayesModel");Type.registerNamespace("Common.App.TellMe.Suggestions.LRModel");Tg.main();window.TellMeAdditionalControls={name:"CommandUI",attrs:{},children:[{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.Animation",Command:"0x9F8ACB60",LabelText:"STR@L_AnimationTab"},children:[{name:"Menu",
attrs:{Id:"PptTellMe.Animation.Menu"},children:[{name:"MenuSection",attrs:{Id:"PptTellMe.Animation.MenuSection",DisplayMode:"Thin"},children:[{name:"Gallery",attrs:{Id:"PptTellMe.Animation.Gallery",ElementDimensions:"Size64by48",Width:"3"},children:[{name:"GalleryButton",attrs:{Id:"Existing",Command:"0x11CFD1C3",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",Alt:"STR@L_ExistingButtonDescription"}},{name:"GalleryButton",attrs:{Id:"None",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",
InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationNone",Alt:"STR@L_AnimationNone"}},{name:"GalleryButton",attrs:{Id:"Appear",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationAppear",Alt:"STR@L_AnimationAppear"}},{name:"GalleryButton",attrs:{Id:"FadeIn",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationFadeIn",Alt:"STR@L_AnimationFadeIn"}},{name:"GalleryButton",
attrs:{Id:"FlyIn",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationFlyIn",Alt:"STR@L_AnimationFlyIn"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.AnimationNew",Command:"0x9F8ACB60",LabelText:"STR@L_AnimationTab"},children:[{name:"Menu",attrs:{Id:"AnimationGallery"},children:[{name:"MenuSection",attrs:{Id:"AnimationGalleryNone"},children:[{name:"Gallery",attrs:{Id:"AnimationGallery1",ElementDimensions:"Size64by48",Width:"5"},
children:[{name:"GalleryButton",attrs:{Id:"ExistingInMenu",Command:"0x4B65244F",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",Alt:"STR@L_ExistingButtonDescription"}},{name:"GalleryButton",attrs:{Id:"None",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationNone",Alt:"STR@L_AnimationNone"}}]}]},{name:"MenuSection",attrs:{Title:"STR@L_AnimationEntrance",Id:"AnimationGalleryEntrance"},children:[{name:"Gallery",attrs:{Id:"AnimationGallery2",
ElementDimensions:"Size64by48",Width:"5"},children:[{name:"GalleryButton",attrs:{Id:"Appear",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationAppear",Alt:"STR@L_AnimationAppear"}},{name:"GalleryButton",attrs:{Id:"FadeIn",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationFade",Alt:"STR@L_AnimationFade"}},{name:"GalleryButton",attrs:{Id:"FlyIn",Command:"0x9F8ACB60",
QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationFlyIn",Alt:"STR@L_AnimationFlyIn"}},{name:"GalleryButton",attrs:{Id:"Split",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationSplit",Alt:"STR@L_AnimationSplit"}},{name:"GalleryButton",attrs:{Id:"Wipe",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationWipe",Alt:"STR@L_AnimationWipe"}},
{name:"GalleryButton",attrs:{Id:"RandomBars",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationRandomBars",Alt:"STR@L_AnimationRandomBars"}},{name:"GalleryButton",attrs:{Id:"GrowAndTurn",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationGrowAndTurn",Alt:"STR@L_AnimationGrowAndTurn"}},{name:"GalleryButton",attrs:{Id:"Zoom",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",
InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationZoom",Alt:"STR@L_AnimationZoom"}},{name:"GalleryButton",attrs:{Id:"BasicZoom",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationBasicZoom",Alt:"STR@L_AnimationBasicZoom"}},{name:"GalleryButton",attrs:{Id:"Blinds",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationBlinds",Alt:"STR@L_AnimationBlinds"}},
{name:"GalleryButton",attrs:{Id:"Box",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationBox",Alt:"STR@L_AnimationBox"}},{name:"GalleryButton",attrs:{Id:"Checkerboard",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationCheckerboard",Alt:"STR@L_AnimationCheckerboard"}},{name:"GalleryButton",attrs:{Id:"Expand",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",
ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationExpand",Alt:"STR@L_AnimationExpand"}},{name:"GalleryButton",attrs:{Id:"PeekIn",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationPeekIn",Alt:"STR@L_AnimationPeekIn"}},{name:"GalleryButton",attrs:{Id:"RiseUp",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationRiseUp",Alt:"STR@L_AnimationRiseUp"}},{name:"GalleryButton",
attrs:{Id:"Stretch",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationStretch",Alt:"STR@L_AnimationStretch"}},{name:"GalleryButton",attrs:{Id:"Strips",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationStrips",Alt:"STR@L_AnimationStrips"}}]}]},{name:"MenuSection",attrs:{Title:"STR@L_AnimationEmphasis",Id:"AnimationGalleryEmphasis"},children:[{name:"Gallery",attrs:{Id:"AnimationGallery3",
ElementDimensions:"Size64by48",Width:"5"},children:[{name:"GalleryButton",attrs:{Id:"Emphasis_Spin",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationSpin",Alt:"STR@L_AnimationSpin"}},{name:"GalleryButton",attrs:{Id:"Emphasis_GrowShrink",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationGrowShrink",Alt:"STR@L_AnimationGrowShrink"}},{name:"GalleryButton",attrs:{Id:"Emphasis_Transparency",
Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationTransparency",Alt:"STR@L_AnimationTransparency"}},{name:"GalleryButton",attrs:{Id:"Emphasis_LineColor",Command:"0xA1B5DDD6",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationLineColor",Alt:"STR@L_AnimationLineColor"}},{name:"GalleryButton",attrs:{Id:"Emphasis_FillColor",Command:"0xA1B5DDD6",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",
LabelText:"STR@L_AnimationFillColor",Alt:"STR@L_AnimationFillColor"}},{name:"GalleryButton",attrs:{Id:"Emphasis_FontColor",Command:"0xA1B5DDD6",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationFontColor",Alt:"STR@L_AnimationFontColor"}}]}]},{name:"MenuSection",attrs:{Title:"STR@L_AnimationExit",Id:"AnimationGalleryExit"},children:[{name:"Gallery",attrs:{Id:"AnimationGallery4",ElementDimensions:"Size64by48",Width:"5"},children:[{name:"GalleryButton",attrs:{Id:"Exit_Disappear",
Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationDisappear",Alt:"STR@L_AnimationDisappear"}},{name:"GalleryButton",attrs:{Id:"Exit_Fade",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationFade",Alt:"STR@L_AnimationFade"}},{name:"GalleryButton",attrs:{Id:"Exit_FlyOut",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationFlyOut",
Alt:"STR@L_AnimationFlyOut"}},{name:"GalleryButton",attrs:{Id:"Exit_Split",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationSplit",Alt:"STR@L_AnimationSplit"}},{name:"GalleryButton",attrs:{Id:"Exit_Wipe",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationWipe",Alt:"STR@L_AnimationWipe"}},{name:"GalleryButton",attrs:{Id:"Exit_RandomBars",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",
InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationRandomBars",Alt:"STR@L_AnimationRandomBars"}},{name:"GalleryButton",attrs:{Id:"Exit_Zoom",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationZoom",Alt:"STR@L_AnimationZoom"}},{name:"GalleryButton",attrs:{Id:"Exit_BasicZoom",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationBasicZoom",Alt:"STR@L_AnimationBasicZoom"}},
{name:"GalleryButton",attrs:{Id:"Exit_Blinds",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationBlinds",Alt:"STR@L_AnimationBlinds"}},{name:"GalleryButton",attrs:{Id:"Exit_Box",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationBox",Alt:"STR@L_AnimationBox"}},{name:"GalleryButton",attrs:{Id:"Exit_Checkerboard",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",
ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationCheckerboard",Alt:"STR@L_AnimationCheckerboard"}},{name:"GalleryButton",attrs:{Id:"Exit_PeekOut",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationPeekOut",Alt:"STR@L_AnimationPeekOut"}},{name:"GalleryButton",attrs:{Id:"Exit_Stretchy",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationStretchy",Alt:"STR@L_AnimationStretchy"}},
{name:"GalleryButton",attrs:{Id:"Exit_Strips",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationStrips",Alt:"STR@L_AnimationStrips"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.Transition",Command:"0x78ACF6A1",LabelText:"STR@L_TransitionTab"},children:[{name:"Menu",attrs:{Id:"PptTellMe.Transition.Menu"},children:[{name:"MenuSection",attrs:{Id:"PptTellMe.Transition.MenuSection",DisplayMode:"Thin"},children:[{name:"Gallery",attrs:{Id:"PptTellMe.Transition.Gallery",
ElementDimensions:"Size64by48",Width:"2"},children:[{name:"GalleryButton",attrs:{Id:"TransitionExisting",Command:"0xDFACB0EC",QueryCommand:"0x08E3C66D",InnerHTML:"",ElementDimensions:"Size64by48",Alt:"STR@L_ExistingTransitionButtonDescription"}},{name:"GalleryButton",attrs:{Id:"TransitionNone",Command:"0x78ACF6A1",QueryCommand:"0x08E3C66D",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_TransitionNone",Alt:"STR@L_TransitionNone"}},{name:"GalleryButton",attrs:{Id:"TransitionFade",Command:"0x78ACF6A1",
QueryCommand:"0x08E3C66D",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_TransitionFade",Alt:"STR@L_TransitionFade"}},{name:"GalleryButton",attrs:{Id:"TransitionPush",Command:"0x78ACF6A1",QueryCommand:"0x08E3C66D",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_TransitionPush",Alt:"STR@L_TransitionPush"}}]}]}]}]},{name:"Button",attrs:{Id:"PptTellMe.Designer",Command:"0x9531543E",LabelText:"STR@L_ShowHideDesignerPane"}},{name:"Button",attrs:{Id:"PptTellMe.Ideas",Command:"0x76FF601A",
Image16by16:"IMGMAP@per@LightningIdeasHandraiseState_16x16x32",LabelText:"STR@L_IdeasButtonHomeRibbon"}},{name:"Button",attrs:{Id:"PptTellMe.SelectAll",Command:"0x148D0534",Image16by16:"IMGMAP@per@SelectAll_16x16x32",LabelText:"STR@L_SelectAllButton"}},{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.GroupShapesUpSellButton",LabelText:"STR@L_GroupShapesUpSell",Command:"0x2F9A3D80"},children:[{name:"Menu",attrs:{Id:"menuUpSell"},children:[{name:"MenuSection",attrs:{Id:"OpenInClientMenuSection",DisplayMode:"Menu48",
Title:"STR@L_DesktopFeature"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"UpSellOpenInClient",LabelText:"STR@L_OpenInDesktopWord",Description:"STR@L_OpenInDesktopDescription",Image48by48:"IMGMAP@prt2@PowerPoint_48x48x32",Command:"0xD5DF198A"}}]}]},{name:"MenuSection",attrs:{Id:"UpSellInformationMenuSection",ShowMenuSectionSeparator:"false",DisplayMode:"Menu48"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"jbtnTryOfficeThroughTellMeForPPTGroupShapes",
LabelText:"STR@L_DesktopUpSellTitle",Description:"STR@L_DesktopUpSellDescription",Image48by48:"IMGMAP@prt2@TryOffice_48x48x32",Command:"0x0CDCFF89"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.WordArtUpSellButton",LabelText:"STR@L_WordArtUpSell",Command:"0x2F9A3D80"},children:[{name:"Menu",attrs:{Id:"menuUpSell"},children:[{name:"MenuSection",attrs:{Id:"OpenInClientMenuSection",DisplayMode:"Menu48",Title:"STR@L_DesktopFeature"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"UpSellOpenInClient",
LabelText:"STR@L_OpenInDesktopWord",Description:"STR@L_OpenInDesktopDescription",Image48by48:"IMGMAP@prt2@PowerPoint_48x48x32",Command:"0xD5DF198A"}}]}]},{name:"MenuSection",attrs:{Id:"UpSellInformationMenuSection",ShowMenuSectionSeparator:"false",DisplayMode:"Menu48"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"jbtnTryOfficeThroughTellMeForPPTWordArt",LabelText:"STR@L_DesktopUpSellTitle",Description:"STR@L_DesktopUpSellDescription",Image48by48:"IMGMAP@prt2@TryOffice_48x48x32",
Command:"0x0CDCFF89"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.SpellCheckDictUpSellButton",LabelText:"STR@L_SpellCheckDictUpSell",Command:"0x2F9A3D80"},children:[{name:"Menu",attrs:{Id:"menuUpSell"},children:[{name:"MenuSection",attrs:{Id:"OpenInClientMenuSection",DisplayMode:"Menu48",Title:"STR@L_DesktopFeature"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"UpSellOpenInClient",LabelText:"STR@L_OpenInDesktopWord",Description:"STR@L_OpenInDesktopDescription",Image48by48:"IMGMAP@prt2@PowerPoint_48x48x32",
Command:"0xD5DF198A"}}]}]},{name:"MenuSection",attrs:{Id:"UpSellInformationMenuSection",ShowMenuSectionSeparator:"false",DisplayMode:"Menu48"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"jbtnTryOfficeThroughTellMeForPPTSpellCheckDict",LabelText:"STR@L_DesktopUpSellTitle",Description:"STR@L_DesktopUpSellDescription",Image48by48:"IMGMAP@prt2@TryOffice_48x48x32",Command:"0x0CDCFF89"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.InsertAudioUpSellButton",LabelText:"STR@L_InsertAudioUpSell",
Command:"0x2F9A3D80"},children:[{name:"Menu",attrs:{Id:"menuUpSell"},children:[{name:"MenuSection",attrs:{Id:"OpenInClientMenuSection",DisplayMode:"Menu48",Title:"STR@L_DesktopFeature"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"UpSellOpenInClient",LabelText:"STR@L_OpenInDesktopWord",Description:"STR@L_OpenInDesktopDescription",Image48by48:"IMGMAP@prt2@PowerPoint_48x48x32",Command:"0xD5DF198A"}}]}]},{name:"MenuSection",attrs:{Id:"UpSellInformationMenuSection",ShowMenuSectionSeparator:"false",
DisplayMode:"Menu48"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"jbtnTryOfficeThroughTellMeForPPTInsertAudio",LabelText:"STR@L_DesktopUpSellTitle",Description:"STR@L_DesktopUpSellDescription",Image48by48:"IMGMAP@prt2@TryOffice_48x48x32",Command:"0x0CDCFF89"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.InsertChartUpSellButton",LabelText:"STR@L_InsertChartUpSell",Command:"0x2F9A3D80"},children:[{name:"Menu",attrs:{Id:"menuUpSell"},children:[{name:"MenuSection",attrs:{Id:"OpenInClientMenuSection",
DisplayMode:"Menu48",Title:"STR@L_DesktopFeature"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"UpSellOpenInClient",LabelText:"STR@L_OpenInDesktopWord",Description:"STR@L_OpenInDesktopDescription",Image48by48:"IMGMAP@prt2@PowerPoint_48x48x32",Command:"0xD5DF198A"}}]}]},{name:"MenuSection",attrs:{Id:"UpSellInformationMenuSection",ShowMenuSectionSeparator:"false",DisplayMode:"Menu48"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"jbtnTryOfficeThroughTellMeForPPTInsertChart",
LabelText:"STR@L_DesktopUpSellTitle",Description:"STR@L_DesktopUpSellDescription",Image48by48:"IMGMAP@prt2@TryOffice_48x48x32",Command:"0x0CDCFF89"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.WordArtUpSellButtonEnterprise",LabelText:"STR@L_WordArtUpSell",Command:"0x2F9A3D80"},children:[{name:"Menu",attrs:{Id:"menuUpSell"},children:[{name:"MenuSection",attrs:{Id:"OpenInClientMenuSection",DisplayMode:"Menu48",Title:"STR@L_DesktopFeature"},children:[{name:"Controls",attrs:{},children:[{name:"Button",
attrs:{Id:"UpSellOpenInClient",LabelText:"STR@L_OpenInDesktopWord",Description:"STR@L_OpenInDesktopDescription",Image48by48:"IMGMAP@prt2@PowerPoint_48x48x32",Command:"0xD5DF198A"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.SpellCheckDictUpSellButtonEnterprise",LabelText:"STR@L_SpellCheckDictUpSell",Command:"0x2F9A3D80"},children:[{name:"Menu",attrs:{Id:"menuUpSell"},children:[{name:"MenuSection",attrs:{Id:"OpenInClientMenuSection",DisplayMode:"Menu48",Title:"STR@L_DesktopFeature"},children:[{name:"Controls",
attrs:{},children:[{name:"Button",attrs:{Id:"UpSellOpenInClient",LabelText:"STR@L_OpenInDesktopWord",Description:"STR@L_OpenInDesktopDescription",Image48by48:"IMGMAP@prt2@PowerPoint_48x48x32",Command:"0xD5DF198A"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.InsertAudioUpSellButtonEnterprise",LabelText:"STR@L_InsertAudioUpSell",Command:"0x2F9A3D80"},children:[{name:"Menu",attrs:{Id:"menuUpSell"},children:[{name:"MenuSection",attrs:{Id:"OpenInClientMenuSection",DisplayMode:"Menu48",Title:"STR@L_DesktopFeature"},
children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"UpSellOpenInClient",LabelText:"STR@L_OpenInDesktopWord",Description:"STR@L_OpenInDesktopDescription",Image48by48:"IMGMAP@prt2@PowerPoint_48x48x32",Command:"0xD5DF198A"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.InsertChartUpSellButtonEnterprise",LabelText:"STR@L_InsertChartUpSell",Command:"0x2F9A3D80"},children:[{name:"Menu",attrs:{Id:"menuUpSell"},children:[{name:"MenuSection",attrs:{Id:"OpenInClientMenuSection",DisplayMode:"Menu48",
Title:"STR@L_DesktopFeature"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"UpSellOpenInClient",LabelText:"STR@L_OpenInDesktopWord",Description:"STR@L_OpenInDesktopDescription",Image48by48:"IMGMAP@prt2@PowerPoint_48x48x32",Command:"0xD5DF198A"}}]}]}]}]}]};yd.main();Rj.main();Type.registerNamespace("NLRT")},138:function(K,Z,d){d.d(Z,"a",function(){return e});K=d(0);var k=d(221);class e{constructor(n,r){this.BNa=!1;const {Annotations:v}=d(77);if(!n)throw Error.argumentNull("annotations");
if(!n.ile(r))throw Error.argument("memberTypeID","Invalid type ID");if(v.HB(r))throw Error.argument("memberTypeID","Lists of lists are not permitted");this.Er=n;this.DVh=r;this.OB=[]}get Zqb(){return this.Er}get isReadOnly(){return this.BNa}get wU(){return this.DVh}get items(){return this.OB}L1(){const {Annotations:n}=d(77);let r="[";for(let v=0,C=this.items.length;v<C;++v){0<v&&(r+=", ");const w=this.Er.L1(this.wU,this.items[v]);this.wU===n.ZY?(r+='"',r+=k.a.A0d(w),r+='"'):r+=w}return r+"]"}isEqual(n){const {Annotations:r}=
d(77);if(this===n)return!0;if(!n||n.Zqb!==this.Er||n.wU!==this.wU||n.items.length!==this.items.length)return!1;for(let v=0;v<this.items.length;++v)if(!r.r1a(this.wU,this.items[v],n.items[v]))return!1;return!0}clone(){const n=new e(this.Er,this.wU);Array.addRange(n.items,this.items);return n}PK(){return this.isReadOnly?this.clone():this}Ime(){const {Annotations:n}=d(77);if(!this.isReadOnly){this.BNa=!0;for(const r of this.items)n.sbb(r)}}toString(){return this.L1()}}Object(K.a)(e,"ListValue",null,
[1112,1111])},142:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k{}k.tellMe="TellMe";k.contextMenu="ContextMenu";k.unknown="Unknown";Object(K.a)(k,"TellMeScenario",null,[])},154:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k{constructor(e,n,r=null,v=null,C=4,w=-99999,z=0){this.HOd="";this.lGc=-1;this.value=e;this.type=n;this.subType=C;this.label=this.CJ=r;this.groupType=28;this.description=v;this.score=w;this.count=z}}Object(K.a)(k,"ResultBinding",null,[])},168:function(K,
Z,d){d.d(Z,"a",function(){return k});K=d(0);class k{constructor(e){this.attributes=null;this.query=e;this.Lk=[]}es(e){this.Lk.push(e)}jhh(e){const n=[];for(const r of this.Lk)r.groupType!==e&&n.push(r);this.Lk.length!==n.length&&(this.Lk=n)}get hzb(){return!1}}Object(K.a)(k,"SimpleResultsUpdatedEventArgs",null,[954])},169:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k{constructor(e=28,n=""){this.bZh=[];this.groupType=e;this.displayName=n}get results(){return this.bZh}fv(e){e.groupType=
this.groupType;Array.add(this.results,e)}SOe(e=1){if(this.results.length>=e)for(let n=0;n<e;n++)Array.removeAt(this.results,this.results.length-1)}}Object(K.a)(k,"SimpleResultGroup",null,[955])},221:function(K,Z,d){K=d(0);class k{constructor(n,r){this.EPa=n;this.value=r}}Object(K.a)(k,"AttrValuePair",null,[]);d.d(Z,"a",function(){return e});class e{constructor(n){this.BNa=!1;if(!n)throw Error.argumentNull("annotations");this.Er=n;this.dO=[]}get Zqb(){return this.Er}get isReadOnly(){return this.BNa}get nae(){return 0<
this.dO.length}Qm(n){if(!this.Er.Pzb(n))throw Error.argument("attributeID","Invalid attribute ID");for(const r of this.dO)if(n===r.EPa)return n=r.value,{returnValue:!0,value:n};return{returnValue:!1,value:null}}lu(n,r){var {Annotations:v}=d(77);if(this.isReadOnly)throw Error.invalidOperation("Attempt to set annotation on read-only FeatureBundle");if(!this.Er.Pzb(n))throw Error.argument("attributeID","Invalid attribute ID");if(!this.Er.Pyb(this.Er.getAttributeType(n),r))throw Error.argument("value",
"Value is not of the correct type for the specified attribute");v.sbb(r);for(v=0;v<this.dO.length;++v){const C=this.dO[v];if(n===C.EPa){C.value=r;return}}Array.add(this.dO,new k(n,r))}Ujd(n){if(this.isReadOnly)throw Error.invalidOperation("Attempt to remove annotation from read-only FeatureBundle");if(!this.Er.Pzb(n))throw Error.argument("attributeID","Invalid attribute ID");for(let r=0;r<this.dO.length;++r)if(n===this.dO[r].EPa){Array.removeAt(this.dO,r);break}}DPc(n){if(!n)throw Error.argumentNull("action");
for(const r of this.dO)n(r.EPa,r.value)}clone(){const n=new e(this.Er);n.nCa(this);return n}nCa(n){if(this.isReadOnly)throw Error.invalidOperation("Attempt to copy annotations onto read-only FeatureBundle");if(!n)throw Error.argumentNull("other");if(n.Zqb!==this.Er)throw Error.argument("other","Incompatible feature bundle");Array.clear(this.dO);n.DPc((r,v)=>{this.lu(r,v)})}L1(){const {Annotations:n}=d(77);let r="[",v=!0;for(const C of this.dO){v?v=!1:r+=", ";r+=this.Er.yXf(C.EPa);r+="=";const w=this.Er.getAttributeType(C.EPa),
z=this.Er.L1(w,C.value);w===n.ZY?(r+='"',r+=e.A0d(z),r+='"'):r+=z}return r+"]"}isEqual(n){const {Annotations:r}=d(77);if(!n)throw Error.argumentNull("other");if(this===n)return!0;if(!n||this.Er!==n.Zqb||this.nae!==n.nae)return!1;let v=0,C=null,w=!1;n.DPc((z,A)=>{++v;if(!w){var u=-1;for(let E=0,H=this.dO.length;E<H;++E)if(this.dO[E].EPa===z){u=E;break}0>u?w=!0:(C||(C=Array(this.dO.length)),C[u]=A)}});if(this.dO.length!==v||w)return!1;for(let z=0,A=this.dO.length;z<A;++z)if(!r.r1a(this.Er.getAttributeType(this.dO[z].EPa),
this.dO[z].value,C[z]))return!1;return!0}PK(){return this.isReadOnly?this.clone():this}Ime(){const {Annotations:n}=d(77);if(!this.isReadOnly){this.BNa=!0;for(const r of this.dO)n.sbb(r.value)}}toString(){return this.L1()}static A0d(n){return n.replace("\\","\\\\").replace("[","\\[").replace("]","\\]").replace(",","\\,")}}Object(K.a)(e,"FeatureBundle",null,[1110,1111])},261:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k{}k.click="Click";k.cyb="InteractionBegin";k.cdg="InteractionEnd";
k.lGf="ControlActivated";k.query="Query";k.Lch="QueryIndexRecorded";k.CEf="Clicks";k.zpf="ActionEvents";k.qTf="FilteredActionEvents";k.zoh="SessionContext";k.latency="Latency";k.performance="Performance";k.Xih="RenderedResults";k.events="Events";k.cFi="CreateResultsMenu";k.mG="UpdateRibbonControls";k.gZk="ResultsAggregation";k.vC="IssueQuery";k.Aui="CommandSuggestions";k.error="Error";k.Ame="LoadModelData";k.NJi="DepsResolveTime";k.Ohk="ModelDataWaitTime";k.timedOut="TimedOut";k.Nai="AddinQueryCommandReady";
k.u1i="GetAddinEntitlements";k.uch="ProviderMRUEvents";k.mPi="EnableAddinSearchCommands";Object(K.a)(k,"EventNames",null,[])},278:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k{constructor(){this.Iye=null;this.gz=this.nAe=0}XPc(e,n,r){if(!e)throw Error.argumentNull("referenceList");if(0>n||n>e.length)throw Error.argumentOutOfRange("startIndex");if(0>r||r>e.length)throw Error.argumentOutOfRange("length");if(n+r>e.length)throw Error.argument("Invalid start-length range");this.Iye=e;
this.nAe=n;this.gz=r}aSa(e,n,r){this.XPc(e.Iye,e.nAe+n,r)}ga(e){if(0>e||e>=this.gz)throw Error.argumentOutOfRange("index");return this.Iye[this.nAe+e]}get count(){return this.gz}static VWd(e){const n=new k;n.XPc(e,0,e.length);return n}}Object(K.a)(k,"ReadOnlyList",null,[1133])},303:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);var k;(function(e){e[e.Classifier=0]="Classifier";e[e.AppsForOffice=1]="AppsForOffice";e[e.FindInDocument=2]="FindInDocument";e[e.FindInDocumentScopedSearch=3]="FindInDocumentScopedSearch";
e[e.RecentlyUsed=4]="RecentlyUsed";e[e.TryQuery=5]="TryQuery";e[e.Empty=6]="Empty";e[e.TryCommand=7]="TryCommand";e[e.Assistance=8]="Assistance";e[e.Answer=9]="Answer";e[e.Definition=10]="Definition";e[e.Entity=11]="Entity";e[e.WolframAnswer=12]="WolframAnswer";e[e.Insights=13]="Insights";e[e.People=14]="People";e[e.Document=15]="Document";e[e.Recommended=16]="Recommended";e[e.ServiceClassifier=17]="ServiceClassifier";e[e.ServiceRecommended=18]="ServiceRecommended";e[e.Image=19]="Image";e[e.Notes=
20]="Notes";e[e.Learning=21]="Learning";e[e.Feedback=22]="Feedback";e[e.Template=23]="Template";e[e.ActionAI=24]="ActionAI";e[e.Addin=25]="Addin";e[e.OfficeScript=26]="OfficeScript";e[e.AddinStoreEntry=27]="AddinStoreEntry";e[e.None=28]="None";e[e.MergedActions=29]="MergedActions";e[e.MergedScopedSearches=30]="MergedScopedSearches";e[e.MergedSuggestedSearches=31]="MergedSuggestedSearches"})(k||(k={}));Object(K.b)("ResultGroupType",k)},329:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k{constructor(){this.data=
this.landingTab=null}}Object(K.a)(k,"LaunchData",null,[])},330:function(K,Z,d){d.r(Z);d.d(Z,"CommandResultsUtility",function(){return A});K=d(0);var k=d(378),e=d(261),n=d(379),r=d(154),v=d(169),C=d(115),w=d(101),z=d(25);class A{static pOb(u,E){if(E&&E.Lo){const H={};for(const I of u)E.F_c(I)&&(H[I]=appChrome.selectors.getModelType(I));C.TellMeActor.instance.mG(H)}}static epl(u){return u.startsWith("btnTellMeOfficeAddIn")}static G8b(u){const E=C.TellMeActor.instance.SG();return!!E&&E.Lo&&!appChrome.selectors.isControlDisabled(u)}static b1c(u,
E,H,I){if(C.TellMeActor.instance.Hd&&u){const J=[];for(const T of u)J.push(String.format('{{"Id":"{0}","Score":{1}}}',T.commandId,T.score));u={};u[k.a.suggestions]="[{"+J.join(",")+"}]";u[k.a.Blg]=E;u[k.a.groupType]=H;u[k.a.provider]=I;C.TellMeActor.instance.Hd.wH(e.a.Aui,window.performance.now(),u)}}static r5i(u,E){const H=[],I=[];for(const J of E){E=J.commandId;let T=J;J.commandId in u&&(E=u[J.commandId],T=new n.a(E,J.score));Array.contains(I,E)||(H.push(T),I.push(E))}return H}static $Sc(u,E,H,
I,J,T,D,R){H.R4d&&(E=A.r5i(H.R4d,E));var Q=w.a.u4i(E);A.pOb(Q,H);var W=[],O=[];Q=[];const Y=new v.a(D);D=16===D||18===D||7===D||4===D?z.AFrameworkApplication.fa?z.AFrameworkApplication.fa.Fc("TellMeMaxRecommendedResultsToReturn",3):3:0===D||17===D?5:0;for(const S of E)if(!A.IJj(S.commandId)){E=A.epl(S.commandId);if(H.F_c(S.commandId)&&!E){if(w.a.Jkg(S.commandId))continue;E=null;J&&T&&(E=J.Ddj(S.commandId,T));A.G8b(S.commandId)?Array.add(W,new r.a(S.commandId,5,E,null,R,S.score)):Array.add(O,new r.a(S.commandId,
5,E,null,R,S.score))}else H.W5a&&E&&I&&Array.add(Q,S.commandId.substr(21));if(W.length+Q.length>=D)break}H=0;for(J=0;J<W.length&&H<D;J++,H++)Y.fv(W[J]);for(W=0;W<O.length&&H<D;W++,H++)Y.fv(O[W]);for(O=0;O<Q.length&&H<D;O++,H++)I.mJl(u,Q[O],Y);return Y}static IJj(u){A.Cxf||(z.AFrameworkApplication.fa&&z.AFrameworkApplication.fa.aw("TellMeControlPredictionBlockList")&&z.AFrameworkApplication.fa.RA("TellMeControlPredictionBlockList").forEach(E=>{Array.add(A.Bxf,E.toLowerCase())}),A.Cxf=!0);return Array.contains(A.Bxf,
u.toLowerCase())}static the(u){return 2<u.length&&";"===u.charAt(0)&&";"===u.charAt(u.length-1)&&!!z.AFrameworkApplication.fa&&(z.AFrameworkApplication.fa.ka("TellMeCommandHookIsEnabled")||z.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeCommandHookIsEnabled",!1))}static PYf(u){const E=new v.a(0);var H=u.split(";");u=C.TellMeActor.instance.SG();for(const I of H)if(0<I.length){H=I.split(":");const J=2===H.length?H[0]:I;if(!u.F_c(J))break;if(1===H.length)H=new r.a(J,
5,null,null,1),E.fv(H);else if(2===H.length)H=new r.a(J,5,H[1],null,1),E.fv(H);else break}return E}static c5h(u,E,H){if(!(E&&E.results&&u&&u.results&&u.results.length))return{returnValue:!1,lNd:u,INd:E};const I=[];for(var J of E.results)Array.add(I,J.value);J=0;const T=0<E.results.length?E.results[0].score:0;for(const D of u.results)if(D.score>H&&!Array.contains(I,D.value)&&A.G8b(D.value)&&(0<T&&(D.score=T),Array.insert(E.results,J,D),J++),2===J)break;return 0<J?(H=E.results.length-5,0<H&&E.SOe(H),
{returnValue:!0,lNd:u,INd:E}):{returnValue:!1,lNd:u,INd:E}}}A.Cxf=!1;A.Bxf=[];Object(K.a)(A,"CommandResultsUtility",null,[])},377:function(K,Z,d){d.d(Z,"a",function(){return e});K=d(0);var k=d(25);class e{constructor(){this.currentDocumentPath=k.AFrameworkApplication.fa.Ha("EditDocInClientUrl")}}Object(K.a)(e,"SmartLookupApplicationInterface",null,[])},378:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k{}k.appName="AppName";k.M6a="CloseAllMenus";k.commandId="CommandId";k.context="Context";
k.culture="Culture";k.message="Message";k.errorMessage="ErrorMessage";k.event="Event";k.K8="CorrelationID";k.uxk="ParentUiElement";k.query="Input";k.xhb="QueryID";k.Nch="QueryLength";k.rIb="QueryIndex";k.hZk="ResultsList";k.suggestions="Suggestions";k.scenario="Scenario";k.sessionId="SessionID";k.source="Source";k.timeStamp="Time";k.lEh="UiElement";k.qjd="ReactUx";k.value="Val";k.statusCode="StatusCode";k.M3k="Service";k.isSuccess="IsSuccess";k.Xql="TokenAcquired";k.gXj="LatencyType";k.groupName=
"GroupName";k.b$a="GroupIndex";k.groupType="GroupType";k.cZk="ResultInfoList";k.resultType="ResultType";k.VYe="SubResultType";k.dNj="IsInputBlur";k.eNj="IsInputFocus";k.MSj="IsShortCutUsed";k.actionType="ActionType";k.count="Count";k.kOi="DwellTime";k.Blg="IsZeroTerm";k.sFl="WordsCount";k.SZc="IsSearchUxEnabled";k.dUj="IsTellMeInHeaderEnabled";k.module="Module";k.resultIndex="ResultIndex";k.BZd="DisplayIndex";k.vPi="EnableList";k.provider="Provider";k.contentType="ContentType";k.pSj="IsSelectionBased";
k.Ngi="BeginPerformanceMarker";k.TPi="EndPerformanceMarker";k.yzk="PerformanceMeasure";Object(K.a)(k,"Columns",null,[])},379:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k{constructor(e,n){this.commandId=e;this.score=n}}Object(K.a)(k,"CommandSuggestion",null,[])},444:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k{static btc(e){if(!e)return"{NULL}";const n=e.length;return 600>=n?e:e.substring(0,400)+"[...]"+e.substring(n-195,n)}}Object(K.a)(k,"LogUtils",null,[])},445:function(K,
Z,d){d.d(Z,"a",function(){return k});K=d(0);class k{}Object(K.a)(k,"SmartLookupSelection",null,[])},446:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k{}k.tellMe="TellMe";k.loki="Loki";k.substrate="Substrate";k.rIb="QueryIndex";k.yAh="TellMeRanker";k.zAh="TellMeRankerLogging";Object(K.a)(k,"Services",null,[])},447:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k{}k.Fta="HttpRequest";k.provider="Provider";Object(K.a)(k,"LatencyTypes",null,[])},539:function(K,Z,d){K=d(0);
class k{constructor(){this.Nsc=this.V7b=null;this.kCe=this.score=this.Thc=0}fIe(H,I,J){this.score=H.ga(I);++I;this.V7b=H.ga(I)?J.u8(H.ga(I)):null;++I;this.Nsc=H.ga(I)?J.u8(H.ga(I)):null;++I;this.Thc=H.ga(I);++I;this.kCe=H.ga(I);++I;return I}}Object(K.a)(k,"TokenStringGeneratorInit",null,[]);class e{constructor(H,I,J,T,D){this.TRa=H;this.count=I;this.nPc=J;this.NG=T;this.depth=D}}Object(K.a)(e,"ErrorTolerantTrieMatch",null,[]);var n=d(700),r=d(969);class v{constructor(H=null,I=0,J=0,T=0){this.w1h=
H||new r.a;this.Lca=I;this.NG=J;this.depth=T}get mV(){return this.w1h}getKey(){return this.mV.Ys.toString()+":"+this.Lca.toString()}}Object(K.a)(v,"TrieBookmark",null,[]);class C{constructor(H,I){this.xwa=H;this.Rwe=I}e3j(H){if(null==H)throw Error.argumentNull("prefix");let I={};var J=I[""]=new v;this.IVc(J,I);for(J=0;J<H.length;++J){const T=H.charCodeAt(J),D={};for(let R in I)this.Gbi(T,I[R],D);I=D}return this.gsl(I)}IVc(H,I){if(!(H.NG>=this.Rwe)&&(H=new v(n.a.gUd(H.mV),H.Lca,H.NG+1,H.depth),H.mV.Az&
n.a.lMa&&(H.Lca+=1),this.xwa.dlb(H.mV))){H.depth+=1;let J=!0;for(;J;)C.Atd(H,I),this.IVc(H,I),H.Lca+=this.xwa.Tvb(H.mV,!0)+(H.mV.Az&n.a.lMa?1:0),J=this.xwa.Wsc(H.mV)}}Gbi(H,I,J){I.NG+1<=this.Rwe&&(I.NG+=1,C.Atd(I,J),--I.NG);I.mV.Az&n.a.lMa&&(I.Lca+=1);if(this.xwa.dlb(I.mV)){I.depth+=1;let T=!0;for(;T;)I.mV.Hlb===H?(C.Atd(I,J),this.IVc(I,J)):I.NG+1<=this.Rwe&&(I.NG+=1,C.Atd(I,J),this.IVc(I,J),--I.NG),I.Lca+=this.xwa.Tvb(I.mV,!0)+(I.mV.Az&n.a.lMa?1:0),T=this.xwa.Wsc(I.mV)}}gsl(H){const I=[];for(var J in H){const T=
H[J];if(!T.mV.Ys)continue;const D=!!(T.mV.Az&n.a.lMa),R=this.xwa.Tvb(T.mV,!1)+(D?1:0);Array.add(I,new e(T.Lca,R,D,T.NG,T.depth))}I.sort((T,D)=>{let R=T.TRa-D.TRa;return R||(R=-(T.count-D.count))?R:R=T.depth-D.depth});if(2>I.length)return I;H=[];for(J=0;J<I.length;)J+=C.eCh(J,I,H);return H}static Atd(H,I){const J=H.getKey();J in I?(I=I[J],I.NG=Math.min(I.NG,H.NG)):I[J]=new v(n.a.gUd(H.mV),H.Lca,H.NG,H.depth)}static eCh(H,I,J){const T=I[H];let D=T.TRa;const R=D+T.count;let Q=1,W=T.nPc;for(;H+Q<I.length&&
I[H+Q].TRa<R;){const O=I[H+Q];O.TRa>D&&(Array.add(J,new e(D,O.TRa-D,W,T.NG,T.depth)),W=!1);Q+=C.eCh(H+Q,I,J);D=O.TRa+O.count}D<R&&Array.add(J,new e(D,R-D,W,T.NG,T.depth));return Q}}Object(K.a)(C,"ErrorTolerantTrieLookupEngine",null,[1196]);class w extends k{constructor(H,I,J){super();this.wbg=this.b7g=!1;this.RQf=null;if(H){var T=0;try{T=this.fIe(H,T,I);this.b7g=1===H.ga(T);++T;this.wbg=1===H.ga(T);++T;const D=H.ga(T);this.RQf=this.Kxk(J,D)}catch(D){throw Error.argument("initData");}}}Kxk(H,I){return new C(H,
I)}}Object(K.a)(w,"FuzzyMatchTokenStringGeneratorInit",k,[]);class z extends k{constructor(H,I){super();this.query=this.name=null;if(H){this.annotations=I.annotations;var J=0;try{J=this.fIe(H,J,I),this.name=I.nC(H.ga(J)),++J,this.query=I.QD(H.ga(J))}catch(T){throw Error.argument("initData");}}}}Object(K.a)(z,"QueryTokenStringGeneratorInit",k,[]);class A extends k{constructor(H,I){super();if(H)try{this.fIe(H,0,I)}catch(J){throw Error.argument("initData");}}}Object(K.a)(A,"SurfaceStringTokenStringGeneratorInit",
k,[]);var u=d(278);d.d(Z,"a",function(){return E});class E{constructor(H){this.woe=H}get V7b(){return this.woe.V7b}get Nsc(){return this.woe.Nsc}get Thc(){return this.woe.Thc}static create(H,I,J){const {SurfaceStringTokenStringGenerator:T}=d(1118),{QueryTokenStringGenerator:D}=d(1119),{FuzzyMatchTokenStringGenerator:R}=d(1120);let Q=0;try{if(H.ga(Q)!==E.m6a)throw Error.argument("initData","Input does not represent a token string generator");++Q;const W=H.ga(Q);++Q;const O=new u.a;O.aSa(H,Q,H.count-
Q);switch(W){case T.oZb:return new T(new A(O,I));case D.oZb:return new D(new z(O,I));case R.oZb:return new R(new w(O,I,J));default:throw Error.argument("initData");}}catch(W){throw Error.argument("initData");}}static Krf(H,I,J,T,D,R){H=H.erl.getId(I,null);if(0>H)return++R,R;E.Lrf(H,J,T,D);return R}static Lrf(H,I,J,T){Array.add(T.BYe,H);Array.add(T.dyh,I);++T.JNb[J]}}E.m6a=1099767983;Object(K.a)(E,"TokenStringGenerator",null,[1154])},687:function(K,Z,d){d.d(Z,"a",function(){return e});K=d(0);var k=
d(101);d=d(25);class e{static eUj(){return!k.a.Mgg()&&!k.a.Rab()&&e.isFeatureEnabled(0)}static hkg(){return e.isFeatureEnabled(1)}static Ihg(){return e.isFeatureEnabled(2)}static isFeatureEnabled(n){return!!(e.wQh&1<<n)}}e.wQh=d.AFrameworkApplication.fa?d.AFrameworkApplication.fa.Fc("TellMeFeatureConfigValue",0):0;Object(K.a)(e,"TellMeFeatureAvailability",null,[])},688:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);d=d(154);class k extends d.a{constructor(e,n,r,v,C=null){super(e,n,C,null,
r);this.id=v}}Object(K.a)(k,"TryQueryResultBinding",d.a,[])},689:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k{constructor(e){this.Ia=e}get IIa(){return this.Ia.IIa}get Iml(){return 4!==this.Ia.style}get Lml(){return!0}get trie(){return this.Ia.trie}getId(e,n){if(!this.Iml)throw Error.invalidOperation("ID lookup not supported on this string table");switch(this.Ia.style){case 0:return this.N9i(e,n);default:throw Error.notImplemented();}}nC(e){if(!this.Lml)throw Error.invalidOperation("String lookup not supported on this string table");
if(0>e||e>=this.IIa)throw Error.argumentOutOfRange("id","Invalid string ID");switch(this.Ia.style){case 0:return this.ljj(e);case 4:return this.kjj(e);default:throw Error.notImplemented();}}N9i(e,n){e=this.Ia.trie.Zog(e,0,e.length,n);if(!e.succeeded)return-1;if(0>e.SNb||e.SNb>=this.Ia.IIa)throw Error.invalidOperation("Trie with invalid trie ID in StringTable");return this.Ia.Xsc?this.Ia.Ymc.ku(this.Ia.Xsc+4*e.SNb,4):e.SNb}ljj(e){if(this.Ia.Xsc){let n=0;for(;n<this.Ia.IIa&&this.Ia.Ymc.ku(this.Ia.Xsc+
4*n,4)!==e;++n);if(n>=this.Ia.IIa)throw Error.invalidOperation("Malformed TrieId2StringTableId in StringTable");return this.Ia.trie.Z4f(n)}return this.Ia.trie.Z4f(e)}kjj(e){const n=this.Ia.Ymc.ku(this.Ia.byh+4*e,4);e=this.Ia.Ymc.ku(this.Ia.cyh+4*e,4);if(0>e||0>n)throw Error.invalidOperation("Hash table string invalid byte range in StringTable");const r=Array(n);for(let v=0;v<n;++v)r[v]=({Qyj:e}=this.YLk(e)).returnValue;return String.fromCharCode.apply(null,r)}YLk(e){let n=0;for(let r=0;3>r;++r){const v=
this.Ia.Ymc.ga(this.Ia.bCf+e)^182;++e;n|=(v&127)<<7*r;if(!(v&128))break}return{returnValue:n,Qyj:e}}}Object(K.a)(k,"StringTable",null,[1134])},690:function(K,Z,d){d.d(Z,"a",function(){return e});K=d(0);var k=d(700);class e{constructor(n){this.trie=null;this.bCf=this.byh=this.cyh=this.Xsc=0;if(n){this.Ymc=n;var r=0;if(n.ku(r,4)!==e.m6a)throw Error.argument("bytes","Input does not represent a string table");r+=4;this.IIa=n.ku(r,4);r+=4;this.style=n.ku(r,4);r+=4;switch(this.style){case 0:const v=1===
n.ku(r,4);r+=4;v||(this.Xsc=r,r+=4*this.IIa);n.ku(r,4);this.trie=this.nyk(n,r+4);break;case 4:this.cyh=r;this.byh=r+=4*this.IIa;r+=4*this.IIa;n.ku(r,4);this.bCf=r+4;break;default:throw Error.argument("bytes");}}}nyk(n,r){return new k.a(n,r)}}e.m6a=1025118440;Object(K.a)(e,"StringTableInit",null,[])},700:function(K,Z,d){K=d(0);class k{constructor(w){this.n_g=w;this.succeeded=!1;this.SNb=w?w.SNb:0;this.bUj=!1;this.length=this.rol=0}}Object(K.a)(k,"TrieResult",null,[]);class e{constructor(w,z,A){this.yo=
new k(null);this.E9j=w;this.hdc=z;this.Aug=z+A-1}get result(){return this.yo}Q1f(){let w;return this.hdc<=this.Aug?(w=this.E9j.charAt(this.hdc),++this.hdc,{returnValue:!0,ch:w}):{returnValue:!1,ch:"\x00"}}xOe(w,z,A){w&&(this.yo.bUj=!0,this.yo.rol=z);this.yo.length=this.hdc;this.yo.succeeded=!0;this.yo.SNb=A;this.hdc!==this.Aug+1&&(this.yo=new k(this.yo))}}Object(K.a)(e,"LookUpStringVisitor",null,[1156]);var n=d(969);class r{constructor(){this.KBf=this.fzf=this.hzf=this.ezf=this.gzf=this.NRd=this.MRd=
this.PRd=this.LRd=0}}Object(K.a)(r,"TRIESTATS",null,[]);class v{constructor(){this.symbol=this.Oic=0}}Object(K.a)(v,"TrieSymbol",null,[]);d.d(Z,"a",function(){return C});class C{constructor(w,z){this.qU=null;this.W4c=this.byg=this.$xg=this.dyg=this.Wxg=this.cyg=this.ayg=this.eyg=this.Xxg=0;this.yC=w;if(w.ku(z,4)!==C.m6a)throw Error.argument("Input does not represent a trie");z+=4;this.fvg=1===w.ku(z,4);z+=4;this.W5j=1===w.ku(z,4);z+=4;this.H5j=w.ku(z,4);z+=4;if(w.ku(z,4)){w=z+4;this.qU=this.$Lk(w);
this.Xxg=z=w+C.ili;this.eyg=z+=C.KHc*(this.qU.LRd+(this.qU.LRd%2?1:0));this.ayg=z+=C.KHc*(this.qU.PRd+(this.qU.PRd%2?1:0));this.cyg=z+=C.KHc*(this.qU.MRd+(this.qU.MRd%2?1:0));this.Wxg=z+=C.KHc*(this.qU.NRd+(this.qU.NRd%2?1:0));this.dyg=z+=C.TRd*this.qU.ezf;this.$xg=z+=C.URd*this.qU.hzf;this.byg=z+=C.URd*this.qU.fzf;z+=C.URd*this.qU.gzf;if(z!==w+this.qU.KBf)throw Error.argument("Corrupted trie binary");this.W4c=z}else this.qU=null}Zog(w,z,A,u){w=new e(w,z,A);this.HIh(w,u);return w.result}Z4f(w){if(this.fvg)if(w)--w;
else return"";if(!this.qU)throw Error.argument("Invalid trieID");const z=new n.a;z.Az=0;this.dlb(z);const A=[];for(;;){if(z.Az&C.lMa)if(w)--w;else return Array.add(A,z.Hlb),String.fromCharCode.apply(null,A);const u=!!(z.Az&C.Yud),E=this.Tvb(z,!0);if(u||w<E){if(Array.add(A,z.Hlb),!this.dlb(z))throw Error.argument("Invalid trieID");}else if(w-=E,!this.Wsc(z))throw Error.argument("Invalid trieID");}}HIh(w,z){let A=0;this.fvg&&(w.xOe(this.W5j,this.H5j,0),++A);if(this.qU){var u=new n.a;u.Az=0;if(this.dlb(u))for(;;){var E=
void 0;if(!({ch:E}=w.Q1f()).returnValue)break;z&&(E=z(E));E=E.toString().charCodeAt(0);let H=!1;for(;!H;){const I=!!(u.Az&C.lMa);if(u.Hlb===E){if(H=!0,I&&w.xOe(!!(u.Az&C.R4e),u.drd,A),!this.dlb(u))return}else if(A+=this.Tvb(u,!0),!this.Wsc(u))return;I&&++A}}}}dlb(w){if(!w.Az)return this.G0e(w),!0;if(!(w.Az&C.Xud))return!1;w.Hta=0;w.Ys=w.GTa;this.G0e(w);return!0}Wsc(w){if(w.Az&C.Yud)return!1;this.G0e(w);return!0}Tvb(w,z){return w.Az&C.Q4e?w.HHc:w.Az&C.Xud?!z&&w.Az&C.Yud?this.x5i(w):1:0}x5i(w){w=C.gUd(w);
if(!this.dlb(w))return 0;let z=0;do w.Az&C.lMa&&++z,z+=this.Tvb(w,!1);while(this.Wsc(w));return z}G0e(w){w.Az||(w.Hta=0,w.Ys=this.W4c);var z=this.LLc(this.Xxg,w.Ys),A=z.symbol;w.Ys+=z.Oic;z=this.yC.ku(this.Wxg+C.TRd*A,C.TRd);w.Hlb=z&65535;w.Az=z>>16;w.Az&C.Q4e&&(w.HHc=this.mIi(w));w.Az&C.R4e&&(z=this.LLc(this.eyg,w.Ys),A=z.symbol,w.Ys+=z.Oic,w.drd=this.yC.ku(this.dyg+4*A,4));w.Az&C.ZKh?(w.GTa=this.W4c+((this.yC.ga(w.Ys)<<8|this.yC.ga(w.Ys+1))<<8|this.yC.ga(w.Ys+2)),w.Ys+=3):w.Az&C.$Kh?(w.GTa=w.Ys,
w.Hta=w.GTa):w.Az&C.aLh?(z=this.LLc(this.ayg,w.Ys),A=z.symbol,w.Ys+=z.Oic,w.GTa=this.W4c+this.yC.ku(this.$xg+4*A,4)):w.Az&C.Xud&&(z=this.LLc(this.cyg,w.Ys),A=z.symbol,w.Ys+=z.Oic,w.Hta||(w.Hta=w.Ys),w.Hta+=this.yC.ku(this.byg+4*A,4),w.GTa=w.Hta)}LLc(w,z){const A=new v;let u=0;for(;;){u+=this.yC.ga(z);++z;++A.Oic;const E=this.yC.ku(w,2);if(u<E)break;A.symbol+=E;u-=E;w+=2;u<<=8}A.symbol+=u;return A}mIi(w){let z=this.yC.ga(w.Ys);192<=z?(z=(z&63)<<15|(this.yC.ga(w.Ys+1)&127)<<8,z|=this.yC.ga(w.Ys+2),
w.Ys+=3):128<=z?(z=(z&127)<<8|this.yC.ga(w.Ys+1),w.Ys+=2):w.Ys+=1;return z}$Lk(w){const z=new r;z.LRd=this.yC.ku(w+12,2);z.PRd=this.yC.ku(w+14,2);z.MRd=this.yC.ku(w+16,2);z.NRd=this.yC.ku(w+18,2);z.gzf=this.yC.ku(w+24,4);z.ezf=this.yC.ku(w+28,4);z.hzf=this.yC.ku(w+32,4);z.fzf=this.yC.ku(w+36,4);z.KBf=this.yC.ku(w+40,4);return z}static gUd(w){const z=new n.a;z.Hlb=w.Hlb;z.Az=w.Az;z.HHc=w.HHc;z.Ys=w.Ys;z.GTa=w.GTa;z.Hta=w.Hta;z.drd=w.drd;return z}}C.m6a=1654263084;C.ili=48;C.KHc=2;C.URd=4;C.TRd=4;C.lMa=
1;C.Yud=2;C.Q4e=4;C.R4e=8;C.Xud=16;C.$Kh=64;C.aLh=128;C.ZKh=256;Object(K.a)(C,"Trie",null,[1150])},702:function(K,Z,d){d.r(Z);K=d(0);d(142);var k=d(261);class e{}e.marketPlace=0;e.catalog=1;e.privateCatalog=10;Object(K.a)(e,"AppsForOfficeStoreType",null,[]);var n=d(115),r=d(25),v=d(79),C=d(35);class w{constructor(){this.cKd=0}ELe(T,D){this.cKd=window.performance.now();this.s1a(()=>{const R=window.performance.now(),Q={},W=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinUseLocalStoreTypeClass",
!0);D.gtf&&(Q.callback=O=>{T(O,e.marketPlace,R)},W&&(Q.storeType=e.marketPlace),r.AFrameworkApplication.Ta.La(C.a.sZa,2,Q));D.htf&&(Q.callback=O=>{T(O,e.privateCatalog,R)},W?Q.storeType=e.privateCatalog:r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeFixOSFUndefinedBug",!0)?Q.storeType=10:Q.storeType=e.privateCatalog,r.AFrameworkApplication.Ta.La(C.a.sZa,2,Q))},0,()=>{if(n.TellMeActor.instance.Hd)n.TellMeActor.instance.Hd.onError("AddinEntitlementsQuery:QueryEntitlementAsync",
"Query entitlements timeout after "+(window.performance.now()-this.cKd)+" ms")})}s1a(T,D=0,R=null){2!==r.AFrameworkApplication.Ta.processAction(C.a.sZa,1)?(n.TellMeActor.instance.Hd&&n.TellMeActor.instance.Hd.wH(k.a.Nai,window.performance.now()-this.cKd),T()):D<w.wgk?r.AFrameworkApplication.we.Eb(new v.a(2,1,w.mEl,()=>{this.s1a(T,D+1,R)})):R&&R()}static get instance(){w.Ka||(w.Ka=new w);return w.Ka}}w.Ka=null;w.wgk=20;w.mEl=500;Object(K.a)(w,"AddinEntitlementsQuery",null,[]);class z{constructor(){this.description=
this.id=this.displayName=null;this.targetType=0;this.assetStoreId=this.assetId=this.appVersion=null;this.height=this.width=0;this.Ele=this.storeType=this.storeId=this.yGk=this.iconUrl=null}}Object(K.a)(z,"AddinInfo",null,[]);var A=d(154),u=d(169),E=d(168),H=d(101),I=d(70);d.d(Z,"AddinResultsProvider",function(){return J});class J{constructor(T){this.RHd=[];this.ub=T;this.Qok=(D,R,Q)=>{if(D){const W=D.errorCode;if(n.TellMeActor.instance.Hd){const O={};O.StoreType=R;O.ErrorCode=W;O.AddinCount=D.value?
D.value.length:0;n.TellMeActor.instance.Hd.wH(k.a.u1i,window.performance.now()-Q,O)}if(0===W&&D.value){J.Q5a=J.Q5a||{};D=D.value;for(const O of D)D=new z,D.displayName=O[0],D.id=O[1],D.description=O[2],D.targetType=O[3],D.appVersion=4<O.length?O[4]:"",D.assetId=5<O.length?O[5]:"",D.assetStoreId=6<O.length?O[6]:"",D.width=7<O.length?O[7]:0,D.height=8<O.length?O[8]:0,D.iconUrl=9<O.length?O[9]:"",D.yGk=10<O.length?O[10]:"",D.storeId=11<O.length?O[11]:"",D.storeType=12<O.length?O[12]:"",this.ub.rnh&&
(D.Ele=this.M$i(D)),J.Q5a[D.id]=D,0<D.iconUrl.length&&(R="AddinIcon_"+D.id,r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinCheckAppChromeReady",!0)?this.cgh(R,D.iconUrl):appChrome.addInApi.registerAddinIcon(R,D.iconUrl))}}};w.instance.ELe(this.Qok,this.ub)}CF(){return"Add-ins"}EN(){return 0===this.ub.zq?0:1===this.ub.zq?1:2}vC(T,D,R,Q,W=null){R=new E.a(T);W&&!Array.contains(W,25)||H.a.MI(T)||(W=new u.a(25),W.displayName=CommonUIStrings.l_TellMeAddinProviderTitle,
this.u$i(T.Ff,W),R.es(W));D.resultsUpdated(R)}u$i(T,D){if((T=this.z1k(T))&&0<T.length){let R=0;T.forEach(Q=>{if(!(3<++R)){var W="AddinSuggestion"+R,O={};if(r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinCheckAppChromeReady",!0)){var Y="AddinIcon_"+Q.id;0>Array.indexOf(this.RHd,Y)&&0<Q.iconUrl.length&&this.cgh(Y,Q.iconUrl);O["default"]=0<=Array.indexOf(this.RHd,Y)?Y:"AppForOfficeLogo_20"}else O["default"]=0<Q.iconUrl.length?"AddinIcon_"+Q.id:"AppForOfficeLogo_20";
Y=[];Y.push(appChrome.actions.setControlLabel(W,Q.displayName));Y.push(appChrome.actions.setControlIconSet(W,O));Y.push(appChrome.actions.setCompoundButtonCommandValueId(W,Q.id));Y.push(appChrome.actions.updateCompoundButtonDescription(W,Q.description));r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchEnableCommands",!0)&&(O=window.performance.now(),Y.push(appChrome.actions.updateControlEnabledDisabledState(W,!1)),n.TellMeActor.instance.Hd&&n.TellMeActor.instance.Hd.wH(k.a.mPi,
window.performance.now()-O));appChrome.api.dispatch(Y);W=new A.a(W,26,void 0,void 0,1);W.HOd=Telemetry.PrivacyRules.GetPrivacyCompliantId(Q.id,Q.storeType,Q.assetId,null,null,Q.storeId);D.fv(W)}})}}cgh(T,D){I.c()&&appChrome.addInApi.registerAddinIcon&&(appChrome.addInApi.registerAddinIcon(T,D),Array.add(this.RHd,T))}z1k(T){if(!J.Q5a)return null;const D=[],R=J.Q5a;for(let W in R){var Q=R[W];Q&&(this.ub.rnh?J.Qfk(T,Q)&&Array.add(D,Q):0<=Q.displayName.toLowerCase().indexOf(T.toLowerCase())?Array.add(D,
Q):this.ub.gSj&&0<=Q.description.toLowerCase().indexOf(T.toLowerCase())&&Array.add(D,Q))}return D}M$i(T){const D=J.fxh(T.displayName);this.ub.Oai&&Array.addRange(D,J.fxh(T.description));return D}static Qfk(T,D){if(!D.Ele)return!1;for(const R of T.split(" ")){T=!1;for(const Q of D.Ele)if(Q.toLowerCase().startsWith(R.toLowerCase())){T=!0;break}if(!T)return!1}return!0}static fxh(T){const D=[];for(const R of T.split(" ")){T=0;for(let Q=0;Q<R.length;Q++){const W=R.charAt(Q);W.toString().toUpperCase()===
W.toString()&&Q>T&&(Array.add(D,R.substring(T,Q)),T=Q)}Array.add(D,R.substring(T,R.length));T&&Array.add(D,R.substring(0,R.length))}return D}}J.Q5a=null;Object(K.a)(J,"AddinResultsProvider",null,[962])},77:function(K,Z,d){d.r(Z);K=d(0);var k=d(22),e=d(221),n=d(138),r=d(689),v=d(690);class C{constructor(z,A){this.BNa=!1;this.j4=null;if(!z)throw Error.argumentNull("annotations");if(!z.Qzb(A))throw Error.argument("structTypeID","Invalid struct type ID");this.Er=z;this.RAb=this.Er.a2f(A);this.k0h=A}get Zqb(){return this.Er}get isReadOnly(){return this.BNa}get Jya(){return this.k0h}wSa(z){if(0>
z||z>=this.RAb)throw Error.argument("iField","Invalid field index");return this.j4&&null!=this.j4[z]?this.j4[z]:this.Er.$4f(this.Jya,z)}rTe(z,A){if(this.isReadOnly)throw Error.invalidOperation("Attempt to set annotation on read-only StructValue");if(0>z||z>=this.RAb)throw Error.argument("iField","Invalid field index");if(!this.Er.Pyb(this.Er.K9a(this.Jya,z),A))throw Error.argument("value","Value is not of the correct type for the specified field");(this.j4||(this.j4=Array(this.RAb)))[z]=A}L1(){const {Annotations:z}=
d(77);let A="[";if(this.j4){let u=!0;for(let E=0;E<this.RAb;++E){if(null==this.j4[E])continue;const H=this.Er.K9a(this.Jya,E);if(z.r1a(H,this.j4[E],this.Er.$4f(this.Jya,E)))continue;u?u=!1:A+=", ";A+=this.Er.a5f(this.Jya,E);A+="=";const I=this.Er.L1(H,this.j4[E]);H===z.ZY?(A+='"',A+=e.a.A0d(I),A+='"'):A+=I}}return A+"]"}isEqual(z){const {Annotations:A}=d(77);if(this===z)return!0;if(!z||this.Er!==z.Zqb||this.Jya!==z.Jya)return!1;for(let u=0;u<this.RAb;++u)if(!A.r1a(this.Er.K9a(this.Jya,u),this.wSa(u),
z.wSa(u)))return!1;return!0}clone(){const z=new C(this.Er,this.Jya);this.j4&&(z.j4=Array.clone(this.j4));return z}PK(){return this.isReadOnly?this.clone():this}Ime(){const {Annotations:z}=d(77);if(!this.isReadOnly&&(this.BNa=!0,this.j4))for(let A=0;A<this.RAb;++A){const u=this.j4[A];null!=u&&z.sbb(u)}}toString(){return this.L1()}}Object(K.a)(C,"StructValue",null,[1113,1111]);d.d(Z,"Annotations",function(){return w});class w{constructor(z,A){if(!z)throw Error.argumentNull("initData");if(!A)throw Error.argumentNull("objectFetcher");
this.x5j=A.BNi;let u=0;var E=A.kSa(z.ga(u));++u;this.tAe=new r.a(new v.a(E));this.dQh=z.ga(u);++u;this.Gug=Array(this.ZNc);this.scc=Array(this.ZNc);this.UVa=Array(this.ZNc);for(E=0;E<this.ZNc;++E){this.Gug[E]=A.nC(z.ga(u));++u;this.scc[E]=z.ga(u);++u;var H=z.ga(u);++u;this.UVa[E]=Array(H);for(var I=0;I<H;++I)this.UVa[E][I]=A.nC(z.ga(u)),++u}this.j0h=z.ga(u);++u;this.RTg=Array(this.jrc);this.N$c=Array(this.jrc);this.O$c=Array(this.jrc);this.M$c=Array(this.jrc);for(E=0;E<this.jrc;++E)for(this.RTg[E]=
A.nC(z.ga(u)),++u,H=z.ga(u),++u,this.N$c[E]=Array(H),this.O$c[E]=Array(H),this.M$c[E]=Array(H),I=0;I<H;++I)this.N$c[E][I]=A.nC(z.ga(u)),++u,this.O$c[E][I]=z.ga(u),++u,this.M$c[E][I]=({D3:u}=this.gsa(this.O$c[E][I],z,u,null,null,null)).returnValue,w.sbb(this.M$c[E][I]);this.IMh=z.ga(u);++u;this.moe=Array(this.zrb);this.noe=Array(this.zrb);this.loe=Array(this.zrb);for(E=0;E<this.zrb;++E)this.moe[E]=A.nC(z.ga(u)),++u,this.noe[E]=z.ga(u),++u,this.loe[E]=({D3:u}=this.gsa(this.noe[E],z,u,null,null,null)).returnValue,
w.sbb(this.loe[E])}l4b(z){for(let A=0;A<this.zrb;++A)if(this.moe[A]===z)return A;return-1}yXf(z){if(!this.Pzb(z))throw Error.argument("attrID","Invalid attribute ID");return this.moe[z]}getAttributeType(z){if(!this.Pzb(z))throw Error.argument("attrID","Invalid attribute ID");return this.noe[z]}K9a(z,A){if(!this.Qzb(z))throw Error.argument("structTypeID","Invalid struct type ID");z=this.O$c[w.krc(z)];if(0>A||A>=z.length)throw Error.argument("iField","Invalid field index");return z[A]}L1(z,A){if(!this.ile(z))throw Error.argument("typeID",
"Invalid type ID");if(!this.Pyb(z,A))throw Error.argument("value","Value is not of the correct type");switch(z){case w.ZY:return A;case w.sga:return A?"True":"False";case w.Toa:case w.Gaa:return A.toString();case w.IM:return A.L1();default:if(!w.HB(z)&&w.mtc(z)){z=w.u0d(z);const H=this.UVa[z].length;switch(this.scc[z]){case 0:return this.UVa[z][A];case 1:if(A){var u="";for(var E=1;E<H;++E)A&1<<E-1&&(0<u.length&&(u+=" & "),u+=this.UVa[z][E]);return u}return this.UVa[z][0];case 2:u="";for(E=0;E<H;++E)A&
1<<E&&(0<u.length&&(u+=" & "),u+=this.UVa[z][E]);return u;default:throw Error.invalidOperation("Unrecognized enum type flavor "+this.scc[z]);}}else return A.L1()}}ile(z){switch(z){case w.ZY:case w.sga:case w.Toa:case w.Gaa:case w.IM:return!0;default:return w.HB(z)?this.ile(w.QDa(z)):w.mtc(z)?this.iVj(z):this.Qzb(z)}}iVj(z){z=w.u0d(z);return 0<=z&&z<this.Gug.length}Qzb(z){z=w.krc(z);return 0<=z&&z<this.RTg.length}Pzb(z){return 0<=z&&z<this.zrb}Pyb(z,A){if(null==A)return!1;switch(z){case w.ZY:return"string"===
typeof A;case w.sga:return"boolean"===typeof A;case w.Toa:return"number"===typeof A;case w.Gaa:return"number"===typeof A;case w.IM:return Object(k.a)(1110,A);default:if(w.HB(z))return Object(k.a)(1112,A)&&A.wU===w.QDa(z);if(w.mtc(z)){if("number"!==typeof A)return!1;z=w.u0d(z);const u=this.UVa[z].length;switch(this.scc[z]){case 0:return 0<=A&&A<u;case 1:return!(A&-1<<u-1);case 2:return!!A&&!(A&-1<<u);default:throw Error.invalidOperation("Unrecognized enum type flavor "+this.scc[z]);}}else return Object(k.a)(1113,
A)&&A.Jya===z}}get zrb(){return this.IMh}get ZNc(){return this.dQh}get jrc(){return this.j0h}l2i(z){if(!this.Pzb(z))throw Error.argument("attrID","Invalid attribute ID");return this.loe[z]}a2f(z){if(!this.Qzb(z))throw Error.argument("structTypeID","Invalid struct type ID");return this.N$c[w.krc(z)].length}a5f(z,A){if(!this.Qzb(z))throw Error.argument("structTypeID","Invalid struct type ID");return this.N$c[w.krc(z)][A]}$4f(z,A){if(!this.Qzb(z))throw Error.argument("structTypeID","Invalid struct type ID");
z=this.M$c[w.krc(z)];if(0>A||A>=z.length)throw Error.argument("iField","Invalid field index");return z[A]}gsa(z,A,u,E,H,I){if(!A)throw Error.argumentNull("initData");if(w.HB(z)){var J=A.ga(u);++u;z=w.QDa(z);var T=new n.a(this,z);for(var D=0;D<J;++D)Array.add(T.items,({D3:u}=this.gsa(z,A,u,E,H,I)).returnValue);return{returnValue:T,D3:u}}switch(z){case w.ZY:return{returnValue:(E||this.tAe).nC(A.ga(u++)),D3:u};case w.sga:return{returnValue:1===A.ga(u++),D3:u};case w.Toa:return{returnValue:A.ga(u++),
D3:u};case w.Gaa:return{returnValue:(H||this.x5j)[A.ga(u++)],D3:u};case w.IM:z=A.ga(u++);J=new e.a(this);for(T=0;T<z;++T)D=A.ga(u),++u,I&&(D=I[D]),J.lu(D,({D3:u}=this.gsa(this.getAttributeType(D),A,u,E,H,I)).returnValue);return{returnValue:J,D3:u};default:if(w.mtc(z))return{returnValue:A.ga(u++),D3:u};if(w.hEh(z)){J=A.ga(u++);T=new C(this,z);for(D=0;D<J;++D){const R=A.ga(u);++u;T.rTe(R,({D3:u}=this.gsa(this.K9a(z,R),A,u,E,H,I)).returnValue)}return{returnValue:T,D3:u}}throw Error.argument("typeID",
"Invalid type ID");}}static mtc(z){return 16<=(z&16383)&&16384!==(z&16384)&&32768!==(z&32768)}static hEh(z){return 16<=(z&16383)&&16384===(z&16384)&&32768!==(z&32768)}static HB(z){return 32768===(z&32768)}static Kaj(z){if(w.HB(z))throw Error.argument("nonListTypeID","Non-list type ID required");return z|32768}static QDa(z){if(!w.HB(z))throw Error.argument("listTypeID","List type ID required");return z&-32769}static r1a(z,A,u){switch(z){case w.ZY:case w.sga:case w.Toa:case w.Gaa:return A===u;case w.IM:return A.isEqual(u);
default:return w.HB(z)?A.isEqual(u):w.mtc(z)?A===u:A.isEqual(u)}}static sbb(z){Object(k.a)(1111,z)&&z.Ime()}static PK(z){return Object(k.a)(1111,z)?z.PK():z}static u0d(z){return z-16}static krc(z){return(z&-16385)-16}}w.ZY=1;w.sga=2;w.Toa=3;w.Gaa=5;w.IM=9;Object(K.a)(w,"Annotations",null,[1114])},959:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k extends Sys.EventArgs{constructor(e){super();this.Ixa=e}}Object(K.a)(k,"SessionRehydratedEventArgs",Sys.EventArgs,[])},960:function(K,Z,
d){d.r(Z);d.d(Z,"InsightsMenuItemFactory",function(){return r});K=d(0);var k=d(101),e=d(134),n=d(45);class r{constructor(v=null){this.uSh=v||CommonUIStrings.l_InsightsButtonText}get yib(){return 10}SK(v){var C=v.CJ;v=k.a.R3()?k.a.yCa(C,1):k.a.$Wd(C);C=String.format(this.uSh,C);return this.u0i(v,C)}u0i(v,C){return e.a(r.Xcg,k.a.R3()?"1914896509":"3317204163",n.a.pe(C),k.a.xFj,null,n.a.pe(v),n.a.pe(C),null,null)}}r.Xcg="bInsights";Object(K.a)(r,"InsightsMenuItemFactory",null,[901])},961:function(K,
Z,d){d.d(Z,"a",function(){return n});K=d(0);var k=d(134),e=d(45);class n{constructor(r,v,C,w,z){this.UId=r;this.TId=v;this.$0h=C;this.JRh=w;this.Jbf=z}get yib(){return 4}SK(r,v=null){v=v.sessionId+"|"+v.K8+"|"+r.CJ;if(this.Jbf||this.JRh){let C=this.Jbf||e.a.FB(CommonUIStrings.l_HelpTooltip)===e.a.FB(r.CJ.trim());if(this.$0h&&2<r.CJ.length){const w=r.CJ;";"===w.charAt(0)&&";"===w.charAt(w.length-1)&&w.substring(1,w.length-1)===n.Uae&&(C=!0)}r=C?CommonUIStrings.l_HelpButtonTextNoPlaceholder:String.format(CommonUIStrings.l_TextWithQuotation,
r.CJ);return this.NWf(v,e.a.pe(r),C)}return this.NWf(v,e.a.pe(String.format(CommonUIStrings.l_TextWithQuotation,r.CJ)),!1)}NWf(r,v,C){return k.a(n.Uae,C?this.TId:this.UId,v,"OfficeAssistant_16x16x32","A0",e.a.pe(r),v,null,null)}}n.Uae="bSearchHelp";Object(K.a)(n,"AssistanceMenuItemFactory",null,[901])},962:function(K,Z,d){d.d(Z,"a",function(){return v});K=d(0);var k=d(25),e=d(134),n=d(73),r=d(45);class v{get yib(){return 13}SK(){return v.hji()}static hji(){return e.b(v.AUf,"798637440",r.a.pe(CommonUIStrings.l_LookupFirstRunExperienceTitle),
k.AFrameworkApplication.qm,n.getImageClass("Info_32x32x32"),null,null,r.a.pe(CommonUIStrings.l_LookupFirstRunExperienceTitle),"Menu32",null,null,r.a.pe(CommonUIStrings.l_LookupFirstRunExperienceDescription),null,null)}}v.AUf="bTellMeFirstRun";Object(K.a)(v,"FirstRunMenuItemFactory",null,[901])},963:function(K,Z,d){d.d(Z,"a",function(){return r});K=d(0);var k=d(25),e=d(134),n=d(45);class r{constructor(v=null,C=null){this.phf=v;this.fWh=C||CommonUIStrings.l_LookupNoResultsDescription}get yib(){return 14}SK(v){v=
String.format(this.fWh,v.CJ);return this.Nji(v)}Nji(v){return e.b(r.u_g,"798637440",n.a.pe(CommonUIStrings.l_LookupNoResultsTitle),this.phf?k.AFrameworkApplication.qm:null,this.phf,null,null,n.a.pe(CommonUIStrings.l_LookupNoResultsTitle),"Menu32",null,null,n.a.pe(v),null,null)}}r.u_g="lookupNoResults";Object(K.a)(r,"NoCommandsFoundMenuItemFactory",null,[901])},964:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k{constructor(e,n){this.FontWeight=0;this.Text=null;this.FontWeight=e;this.Text=
n}}Object(K.a)(k,"LabelFormatted",null,[])},965:function(K,Z,d){d.d(Z,"a",function(){return C});K=d(0);d(142);var k=d(154),e=d(169),n=d(168),r=d(101),v=d(45);class C{constructor(w){this.ub=w}CF(){return"Assistance"}EN(){return 0===this.ub.zq?0:1===this.ub.zq?1:this.ub.$jc?3:2}vC(w,z,A=!1,u,E=null){u=new n.a(w);if((!E||Array.contains(E,8))&&!r.a.MI(w)){E=new e.a(8);if(A){A=v.a.FB(CommonUIStrings.l_HelpTooltip)===v.a.FB(w.Ff.trim())?CommonUIStrings.l_HelpButtonTextNoPlaceholder:String.format(CommonUIStrings.l_TextWithQuotation,
w.Ff);const H=[];this.ub.NUa&&(this.ub.hWe||H.push(appChrome.actions.setControlIconSet("GetHelpFromTellMe",{"default":"search_20"})),A=this.V1f(w.Ff));const I="||"+w.Ff;H.push(appChrome.actions.setControlLabel("GetHelpFromTellMe",A));H.push(appChrome.actions.setButtonCommandValueId("GetHelpFromTellMe",I));appChrome.api.dispatch(H);w=new k.a("GetHelpFromTellMe",4,w.Ff,null,1)}else w=new k.a("bSearchHelp",4,w.Ff,null,1);E.fv(w);E.displayName=CommonUIStrings.l_HelpButtonTitle;u.es(E)}z.resultsUpdated(u)}gTa(w,
z=null){const A=new e.a(8),u=v.a.FB(CommonUIStrings.l_HelpTooltip)===v.a.FB(w.Ff.trim())?CommonUIStrings.l_HelpButtonTextNoPlaceholder:String.format(CommonUIStrings.l_TextWithQuotation,w.Ff);for(let H=0;H<z.length&&2>H;H++){var E=void 0;E=[];let I="GetHelpWithDescriptionFromTellMe"+(H+1).toString(),J=4;if(this.ub.iqc)E.push(appChrome.actions.setControlLabel(I,u)),E.push(appChrome.actions.setCompoundButtonCommandValueId(I,w.Ff)),E.push(appChrome.actions.updateCompoundButtonDescription(I,this.vlj(z.length)));
else if(this.ub.jqc){let T=this.a6f(z[H]);I="GetHelpFromTellMe"+(H+1).toString();this.ub.NUa&&(T=this.V1f(T));J=9;E.push(appChrome.actions.setControlLabel(I,T));E.push(appChrome.actions.setButtonCommandValueId(I,this.tlj(z[H])))}appChrome.api.dispatch(E);E=new k.a(I,J,null,null,0);E.label=this.a6f(z[H]);E.description=this.slj(z[H]);A.fv(E);if(this.ub.jqc)break}A.displayName=CommonUIStrings.l_HelpButtonTitle;return A}vlj(w){return 1===w?String.format(CommonUIStrings.l_SearchResultText,w):String.format(CommonUIStrings.l_SearchResultsText,
w)}V1f(w){return this.ub.Hke?r.a.U5d(w,CommonUIStrings.l_HelpScopedButtonText):w+CommonUIStrings.l_HelpScopedButtonText}a6f(w){return w.name?w.name:""}slj(w){return w.description?w.description:""}tlj(w){return w.id?"AssetID="+w.id:""}}Object(K.a)(C,"AssistanceResultsProvider",null,[962])},966:function(K,Z,d){d.d(Z,"a",function(){return w});K=d(0);d(142);var k=d(154),e=d(169),n=d(168),r=d(115),v=d(101),C=d(329);class w{constructor(z){this.ub=z}CF(){return"Image"}EN(){return 0===this.ub.zq?0:1===this.ub.zq?
1:3===this.ub.zq?3:2}vC(z,A,u,E,H=null){u=new n.a(z);(!H||Array.contains(H,19))&&v.a.MI(z)&&this.ub.HH&&this.gTa(z,u,1);A.resultsUpdated(u)}gTa(z,A,u,E=null){var H=[];let I;r.TellMeActor.instance.SG()&&r.TellMeActor.instance.SG().NUa?(I=this.ub.Hke?v.a.U5d(z.Ff,CommonUIStrings.l_TellMeImageSuggestionScopedButtonTextNoHeader):z.Ff+CommonUIStrings.l_TellMeImageSuggestionScopedButtonTextNoHeader,this.ub.hWe||H.push(appChrome.actions.setControlIconSet("ImageForSearch",{"default":"search_20"}))):I=this.ub.HH?
v.a.MI(z)?this.ub.CPa?v.a.iSa(CommonUIStrings.l_TellMeImageSuggestionButtonTextV2Bolded):CommonUIStrings.l_TellMeImageSuggestionButtonTextV2:this.ub.CPa?v.a.iSa(String.format(CommonUIStrings.l_TellMeScopedImageSuggestionButtonTextBolded,z.Ff)):String.format(CommonUIStrings.l_TellMeScopedImageSuggestionButtonText,z.Ff):this.ub.SLb?CommonUIStrings.l_TellMeImageSuggestionButtonText:z.Ff+CommonUIStrings.l_TellMeImageSuggestionScopedButtonTextWithHeader;this.ub.bda?(r.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel("ImageForSearch",
I)),H=v.a.yCa(z.Ff,9,Object.assign(new C.a,{landingTab:"Image"})),r.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId("ImageForSearch",H))):(H.push(appChrome.actions.setControlLabel("ImageForSearch",I)),z=v.a.yCa(z.Ff,9,Object.assign(new C.a,{landingTab:"Image"})),H.push(appChrome.actions.setButtonCommandValueId("ImageForSearch",z)),appChrome.api.dispatch(H));u=new k.a("ImageForSearch",12,null,null,u);E&&(u.score=E.ConfidenceScore);E=new e.a(19,this.ub.SLb?CommonUIStrings.l_TellMeImageTitleV2:
CommonUIStrings.l_TellMeImageTitle);E.fv(u);A.es(E)}}Object(K.a)(w,"ImageResultsProvider",null,[962])},967:function(K,Z,d){d.d(Z,"a",function(){return C});K=d(0);d(142);var k=d(154),e=d(169),n=d(168),r=d(101),v=d(25);class C{constructor(w){this.ub=w}CF(){return"Template"}EN(){return 0===this.ub.zq?0:1===this.ub.zq?1:3}vC(w,z){w=new n.a(w);z.resultsUpdated(w)}gTa(w,z,A){var u=[];let E;E=this.ub.HH?this.ub.CPa?r.a.iSa(String.format(CommonUIStrings.l_TellMeTemplateButtonTextV2Bolded,w.Ff)):String.format(CommonUIStrings.l_TellMeTemplateButtonTextV2,
w.Ff):String.format(CommonUIStrings.l_TellMeTemplateButtonText,w.Ff);u.push(appChrome.actions.setControlLabel("TemplateForSearch",E));u.push(appChrome.actions.setButtonCommandValueId("TemplateForSearch",String.format(v.AFrameworkApplication.fa.Ha("TellMeTemplateProviderURL"),v.AFrameworkApplication.uiCulture,w.Ff)));appChrome.api.dispatch(u);w=new e.a(23);w.displayName=CommonUIStrings.l_TellMeTemplateProviderTitle;u=new k.a("TemplateForSearch",24,null,null,0);u.label=A[0].Title?A[0].Title:"";u.description=
A[0].Description?A[0].Description:"";w.fv(u);z.es(w)}}Object(K.a)(C,"TemplateResultsProvider",null,[962])},968:function(K,Z,d){d.d(Z,"a",function(){return A});K=d(0);d(142);var k=d(330),e=d(154),n=d(169),r=d(168),v=d(688),C=d(115),w=d(101),z=d(45);class A{constructor(u,E,H,I){this.kS=u;this.XOa=E;this.$nf=I;this.LQh=H;this.ub=C.TellMeActor.instance.SG()}CF(){return"EmptyQuery"}EN(){return 1===this.ub.zq?1:0}vC(u,E,H=!1,I,J=null){I=new r.a(u);if((!J||Array.contains(J,5)||Array.contains(J,6)||Array.contains(J,
4))&&w.a.MI(u)){this.kS.F4b().length||!this.LQh||this.$nf||(u=new n.a(6),J=new e.a(null,13,void 0,void 0,1),u.fv(J),I.es(u));u=new n.a(4);if(0<this.kS.F4b().length){u.displayName=CommonUIStrings.l_TellMeRecentlyUsedTitle;J=this.kS.F4b();var T=[];for(var D of J)T.push(D.Id);k.CommandResultsUtility.pOb(T,this.ub);for(var R of J)k.CommandResultsUtility.G8b(R.Id)&&u.fv(new e.a(R.Id,5,null,null,2));I.es(u)}if(this.$nf&&0<this.XOa.length&&this.kS.F4b().length<A.XXg){D=new n.a(5);D.displayName=CommonUIStrings.l_TellMeTryQueryTitle;
R=A.XXg-u.results.length;u=[];for(J=0;J<this.XOa.length&&J<R;++J){if(H){T=w.a.z1e+(J+1);const Q=this.XOa[J].key,W=z.a.replaceAll(Q,'"',"");u.push(appChrome.actions.setControlLabel(T,Q));u.push(appChrome.actions.setButtonCommandValueId(T,W));T=new v.a(Q,7,0,W,T)}else T=new v.a(this.XOa[J].key,7,0,this.XOa[J].value);D.fv(T)}0<u.length&&appChrome.api.dispatch(u);I.es(D)}}E.resultsUpdated(I)}}A.XXg=5;Object(K.a)(A,"EmptyQueryResultsProvider",null,[962])},969:function(K,Z,d){d.d(Z,"a",function(){return k});
K=d(0);class k{constructor(){this.drd=this.Hta=this.GTa=this.Ys=this.HHc=this.Az=this.Hlb=0}}Object(K.a)(k,"TRIESCAN",null,[])},987:function(K,Z,d){d.r(Z);var k=d(0),e=d(142),n=d(378),r=d(261),v=d(154),C=d(169),w=d(168),z=d(115),A=d(101),u=d(329);class E{constructor(xa){this.ub=xa}CF(){return"ActionAI"}EN(){return 0===this.ub.zq?0:1===this.ub.zq?1:2}vC(xa,Ma,$a=!1,Eb,ac=null){Eb=new w.a(xa);if(!ac||Array.contains(ac,24))if(this.Hdl()||!A.a.MI(xa)){ac=new C.a(24);var tc=A.a.MI(xa);$a&&($a=null,A.a.R3()&&
($a=A.a.yCa(tc?"":xa.Ff,1,Object.assign(new u.a,{landingTab:"ActionAI"}))),this.ub.bda?$a&&z.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId("ActionAIFromTellMe",$a)):(xa=[],$a&&xa.push(appChrome.actions.setButtonCommandValueId("ActionAIFromTellMe",$a)),appChrome.api.dispatch(xa)));ac.fv(new v.a("ActionAIFromTellMe",25,null,null,1));Eb.es(ac)}Ma.resultsUpdated(Eb)}Hdl(){return A.a.R3()&&this.ub.tXc}}Object(k.a)(E,"ActionAIResultsProvider",null,[962]);var H=d(702);class I{constructor(xa,
Ma){this.Tvd=xa;this.Sh=Ma}resultsUpdated(xa){this.Tvd.I8k(this.Sh,xa)}}Object(k.a)(I,"AggregatorResultsProviderCallback",null,[964]);class J{constructor(xa){this.Vaa=null;this.ub=xa;this.ub.W5a&&(this.Vaa=null)}CF(){return"AppsForOffice"}EN(){return 0===this.ub.zq?0:1===this.ub.zq?1:2}vC(xa,Ma,$a,Eb,ac=null){$a=new w.a(xa);if(!ac||Array.contains(ac,1))ac=new C.a(1),this.Vaa.OGl(ac,xa.Ff),$a.es(ac);Ma.resultsUpdated($a)}}Object(k.a)(J,"AppsForOfficeRecommendationResultsProvider",null,[962]);var T=
d(965),D=d(77),R=d(221),Q=d(22);class W{constructor(xa,Ma){this.Ia=xa;this.S5j=Ma}isMatch(xa,Ma){if(!Object(Q.a)(1110,xa))throw Error.argument("objToTest","Expected feature bundle");let $a;return({value:$a}=xa.Qm(this.Ia.Zba)).returnValue?this.Ia.S3e.isMatch($a,Ma):this.S5j}}Object(k.a)(W,"AnnotatedWithAndValueMatchesAnnotationFilter",null,[1141]);class O{constructor(xa,Ma){this.Ia=xa;this.Ure=Ma}isMatch(xa){if(!Object(Q.a)(1110,xa))throw Error.argument("objToTest","Expected feature bundle");return!!(this.Ure^
xa.Qm(this.Ia.Zba).returnValue)}}Object(k.a)(O,"AnnotatedWithAnnotationFilter",null,[1141]);class Y{constructor(xa){this.Ia=xa}isMatch(xa,Ma){if(!Object(Q.a)(1113,xa))throw Error.argument("objToTest","Expected struct value");return this.Ia.S3e.isMatch(xa.wSa(this.Ia.Jsa),Ma)}}Object(k.a)(Y,"FieldValueMatchesStructFilter",null,[1141]);class S{constructor(xa,Ma){xa&&(this.Jsa=xa.ga(0),this.S3e=Ma.u8(xa.ga(1)))}}Object(k.a)(S,"FieldValueMatchesStructFilterInit",null,[]);class da{constructor(xa){this.Ure=
xa}isMatch(xa){if(!Object(Q.a)(1110,xa))throw Error.argument("objToTest","Expected feature bundle");return!!(this.Ure^xa.nae)}}Object(k.a)(da,"HasAnnotationsAnnotationFilter",null,[1141]);class fa{constructor(xa,Ma){this.Ia=xa;this.Jq=Ma}isMatch(xa,Ma){if(!Object(Q.a)(1112,xa))throw Error.argument("objToTest","Expected list value");switch(this.Jq){case 0:for(const $a of xa.items)if(this.Ia.filter.isMatch($a,Ma))return!0;return!1;case 1:for(const $a of xa.items)if(!this.Ia.filter.isMatch($a,Ma))return!1;
return!0;default:throw Error.notImplemented();}}}Object(k.a)(fa,"ItemTestListFilter",null,[1141]);class ka{constructor(xa){this.Ia=xa}isMatch(xa,Ma){if(!Object(Q.a)(1112,xa))throw Error.argument("objToTest","Expected list value");return this.Ia.filter.isMatch(xa.items.length,Ma)}}Object(k.a)(ka,"LengthMatchesListFilter",null,[1141]);class ha{constructor(xa,Ma){this.Ia=xa;this.Jq=Ma}isMatch(xa,Ma,$a=null){let Eb=0===this.Jq;for(const ac of this.Ia.GCf)if((Eb=ac.isMatch(xa,Ma,$a))?1===this.Jq:0===this.Jq)return Eb;
2===this.Jq&&(Eb=!Eb);return Eb}}Object(k.a)(ha,"NonterminalFilter",null,[1141]);class F{constructor(xa,Ma){if(xa){var $a=xa.ga(0);this.GCf=Array($a);for(let Eb=0;Eb<$a;++Eb)this.GCf[Eb]=Ma.u8(xa.ga(1+Eb))}}}Object(k.a)(F,"NonterminalFilterInit",null,[]);class na{constructor(xa,Ma){this.Ia=xa;this.Jq=Ma}isMatch(xa,Ma){if("number"!==typeof xa)throw Error.argument("objToTest","Expected number value");let $a=this.Ia.number;if(this.Ia.query){Ma=this.Ia.query.pp(null,Ma);if("number"!==typeof Ma)throw Error.invalidOperation("Query did not return number");
$a+=Ma}switch(this.Jq){case 0:return xa===$a;case 1:return xa<$a;case 2:return xa<=$a;case 3:return xa>$a;case 4:return xa>=$a;default:throw Error.notImplemented();}}}Object(k.a)(na,"NumberFilter",null,[1141]);class ba{constructor(xa,Ma){xa&&(this.number=xa.ga(0),this.query=xa.ga(1)?Ma.QD(xa.ga(1)):null)}}Object(k.a)(ba,"NumberFilterInit",null,[]);class Ea{constructor(xa,Ma,$a){this.FRc=this.k8i;this.nHa=xa;this.Rvg=Ma;this.Pvg=$a}bTd(xa){this.Rvg=xa}k8i(xa){if(!xa)throw Error.argument("name","Invalid named feature bundle reference");
const Ma=xa.substr(1);return 1===xa.charCodeAt(0)&&Ma===this.nHa?this.Rvg:this.Pvg?this.Pvg.FRc(xa):null}}Object(k.a)(Ea,"SimpleNamedFeatureBundleResolver",null,[1180]);class La{constructor(xa){this.Ia=xa}isMatch(xa,Ma){if(!Object(Q.a)(1110,xa))throw Error.argument("objToTest","Expected feature bundle");xa=this.Ia.query.pp(null,new Ea(this.Ia.mud,xa,Ma));if("boolean"!==typeof xa)throw Error.invalidOperation("Query did not return bool");return xa}}Object(k.a)(La,"PredicateAnnotationFilter",null,[1141]);
class ta{constructor(xa,Ma){xa&&(this.mud=Ma.nC(xa.ga(0)),this.query=Ma.QD(xa.ga(1)))}}Object(k.a)(ta,"PredicateAnnotationFilterInit",null,[]);class oa{constructor(xa){this.Ia=xa}isMatch(xa,Ma){if("boolean"!==typeof xa)throw Error.argument("objToTest","Expected bool value");Ma=this.Ia.query.pp(null,Ma);if("boolean"!==typeof Ma)throw Error.invalidOperation("Query did not return bool");return xa===Ma}}Object(k.a)(oa,"QueryBooleanFilter",null,[1141]);class wa{constructor(xa,Ma){this.Ia=xa;this.Jq=Ma}isMatch(xa,
Ma){if("number"!==typeof xa)throw Error.argument("objToTest","Expected integer");Ma=this.Ia.query.pp(null,Ma);if("number"!==typeof Ma)throw Error.invalidOperation("Query did not return an enum value");switch(this.Jq){case 0:return xa===Ma;case 1:return 0!==(xa&Ma);case 2:return xa===(xa&Ma);case 3:return Ma===(xa&Ma);default:throw Error.notImplemented();}}}Object(k.a)(wa,"QueryEnumFilter",null,[1141]);class ra{constructor(xa,Ma){xa&&(this.aZc=1===xa.ga(0),this.query=Ma.QD(xa.ga(1)))}}Object(k.a)(ra,
"QueryEnumFilterInit",null,[]);class ya{constructor(xa,Ma){this.Ia=xa;this.Jq=Ma}isMatch(xa,Ma){if(!Object(Q.a)(1112,xa))throw Error.argument("objToTest","Expected list value");Ma=this.Ia.query.pp(null,Ma);if(!Object(Q.a)(1112,Ma))throw Error.invalidOperation("Query did not return list value");if(xa.wU!==Ma.wU)return!1;switch(this.Jq){case 0:return D.Annotations.r1a(D.Annotations.Kaj(xa.wU),xa,Ma);case 1:for(const $a of xa.items)for(const Eb of Ma.items)if(D.Annotations.r1a(xa.wU,$a,Eb))return!0;
return!1;case 2:for(const $a of xa.items)for(const Eb of Ma.items)if(!D.Annotations.r1a(xa.wU,$a,Eb))return!1;return!0;case 3:for(const $a of Ma.items)for(const Eb of xa.items)if(!D.Annotations.r1a(xa.wU,$a,Eb))return!1;return!0;default:throw Error.notImplemented();}}}Object(k.a)(ya,"QueryListFilter",null,[1141]);class Da{constructor(xa,Ma){this.Ia=xa;this.Jq=Ma}isMatch(xa,Ma){if("string"!==typeof xa)throw Error.argument("objToTest","Expected string");Ma=this.Ia.query.pp(null,Ma);if("string"!==typeof Ma)throw Error.invalidOperation("Query did not return string");
this.Ia.mhe&&(xa=xa.toUpperCase(),Ma=Ma.toUpperCase());switch(this.Jq){case 0:return xa===Ma;case 1:return 0<=xa.indexOf(Ma);case 2:return xa.startsWith(Ma);case 3:return xa.endsWith(Ma);case 4:return 0<=Ma.indexOf(xa);case 5:return Ma.startsWith(xa);case 6:return Ma.endsWith(xa);default:throw Error.notImplemented();}}}Object(k.a)(Da,"QueryStringFilter",null,[1141]);class pa{constructor(xa,Ma){xa&&(this.query=Ma.QD(xa.ga(0)),this.mhe=1===xa.ga(1))}}Object(k.a)(pa,"QueryStringFilterInit",null,[]);
class la{constructor(xa){this.Ia=xa}isMatch(xa,Ma){if(!Object(Q.a)(1113,xa))throw Error.argument("objToTest","Expected struct value");Ma=this.Ia.query.pp(null,Ma);if(!Object(Q.a)(1113,Ma))throw Error.invalidOperation("Query did not return struct value");return xa.isEqual(xa)}}Object(k.a)(la,"QueryStructFilter",null,[1141]);class Fa{constructor(xa){this.Ia=xa}isMatch(xa,Ma){xa=this.Ia.query.pp(null,Ma);if("boolean"!==typeof xa)throw Error.invalidOperation("Query did not return bool");return xa}}Object(k.a)(Fa,
"QueryWhereConstraintFilter",null,[1141]);class Qa{constructor(xa){this.Ia=xa}isMatch(xa){if("string"!==typeof xa)throw Error.argument("objToTest","Expected string");return this.Ia.regex.test(xa)}}Object(k.a)(Qa,"RegexStringFilter",null,[1141]);class Sa{constructor(xa,Ma){xa&&(this.regex=Ma.p3f(xa.ga(0)))}}Object(k.a)(Sa,"RegexStringFilterInit",null,[]);class Na{constructor(xa,Ma){xa&&(this.filter=Ma.u8(xa.ga(0)))}}Object(k.a)(Na,"SingleFilterFilterInit",null,[]);class ua{constructor(xa,Ma){xa&&(this.query=
Ma.QD(xa.ga(0)))}}Object(k.a)(ua,"SingleQueryFilterInit",null,[]);class za{constructor(xa){this.Ia=xa}isMatch(xa){if("boolean"!==typeof xa)throw Error.argument("objToTest","Expected bool value");return xa===this.Ia.value}}Object(k.a)(za,"StoredValueBooleanFilter",null,[1141]);class Wa{constructor(xa){xa&&(this.value=1===xa.ga(0))}}Object(k.a)(Wa,"StoredValueBooleanFilterInit",null,[]);class yb{constructor(xa,Ma){this.Ia=xa;this.Jq=Ma}isMatch(xa){if("number"!==typeof xa)throw Error.argument("objToTest",
"Expected integer");switch(this.Jq){case 0:return this.Ia.aZc?this.Ia.value?!!(xa&this.Ia.value):!xa:xa===this.Ia.value;case 1:return this.Ia.aZc?(xa&this.Ia.value)===this.Ia.value:32>xa&&(1<<xa&this.Ia.value)===this.Ia.value;case 2:return this.Ia.aZc?!!(xa&this.Ia.value):32>xa&&!!(1<<xa&this.Ia.value);default:throw Error.notImplemented();}}}Object(k.a)(yb,"StoredValueEnumFilter",null,[1141]);class Za{constructor(xa){xa&&(this.aZc=1===xa.ga(0),this.value=xa.ga(1))}}Object(k.a)(Za,"StoredValueEnumFilterInit",
null,[]);class ub{constructor(){this.txk=null;this.QRd=this.w$a=0}}Object(k.a)(ub,"WHEREConstraintData",null,[]);class Ib{constructor(xa){this.Ia=xa}isMatch(xa,Ma){if(!Object(Q.a)(ub,xa))throw Error.argument("objToTest","Expected WHERE constraint data");let $a=-1,Eb=-1;const ac=xa.txk;switch(this.Ia.VSd){case 4:$a=ac.D3b;Eb=ac.TXe;break;case 5:$a=xa.w$a;Eb=ac.D3b-xa.w$a;break;case 6:$a=ac.D3b+ac.TXe;Eb=xa.w$a+xa.QRd-$a;break;case 1:case 2:case 3:let tc=!1;for(let aa=ac.bHl;aa;aa=aa.next)if(this.Ia.ZBl===
aa.name){tc=!0;1===this.Ia.VSd?($a=aa.D3b,Eb=aa.TXe):2===this.Ia.VSd?($a=xa.w$a,Eb=aa.D3b-xa.w$a):($a=aa.D3b+aa.TXe,Eb=xa.w$a+xa.QRd-$a);break}if(!tc)return!1;break;case 7:$a=xa.w$a;Eb=xa.QRd;break;default:throw Error.notImplemented();}return null!==this.Ia.mkl.zHl(ac.bJl,$a,Eb,$a,!0,2,Ma)}}Object(k.a)(Ib,"SubSreWhereConstraintFilter",null,[1141]);class Ob{constructor(xa,Ma){if(xa){var $a=Ma.nC(xa.ga(0));this.VSd=$a.charCodeAt(0);this.ZBl=$a.substr(1);this.mkl=Ma.sgj(xa.ga(1))}}}Object(k.a)(Ob,"SubSreWhereConstraintFilterInit",
null,[]);class Hc{constructor(xa){this.Ia=xa}isMatch(xa,Ma,$a=null){if(!Object(Q.a)(1110,xa))throw Error.argument("objToTest","Expected feature bundle");if(null==$a)throw Error.argumentNull("parentTextForSpan");if(this.Ia.euf&&!this.Ia.euf.isMatch(xa,Ma))return!1;if(this.Ia.s_e){let Eb;if(({value:Eb}=xa.Qm(this.Ia.Ijl)).returnValue){if(!this.Ia.s_e.isMatch(Eb,Ma))return!1}else{let ac,tc;if(!({value:ac}=xa.Qm(this.Ia.Twh)).returnValue||!({value:tc}=xa.Qm(this.Ia.Swh)).returnValue||0>ac||0>tc||ac+tc>
$a.length||!this.Ia.s_e.isMatch($a.substr(ac,tc),Ma))return!1}}if(this.Ia.vxh){let Eb;if(!({value:Eb}=xa.Qm(this.Ia.Twh)).returnValue||!this.Ia.vxh.isMatch(Eb,Ma))return!1}if(this.Ia.Umg){let Eb;if(!({value:Eb}=xa.Qm(this.Ia.Swh)).returnValue||!this.Ia.Umg.isMatch(Eb,Ma))return!1}return!0}}Object(k.a)(Hc,"TextSpanFilter",null,[1141]);class kb{constructor(xa,Ma){xa&&(this.annotations=Ma.annotations,this.Twh=xa.ga(0),this.Swh=xa.ga(1),this.Ijl=xa.ga(2),this.s_e=xa.ga(3)?Ma.u8(xa.ga(3)):null,this.euf=
xa.ga(4)?Ma.u8(xa.ga(4)):null,this.vxh=xa.ga(5)?Ma.u8(xa.ga(5)):null,this.Umg=xa.ga(6)?Ma.u8(xa.ga(6)):null)}}Object(k.a)(kb,"TextSpanFilterInit",null,[]);class jb{constructor(xa,Ma){xa&&(this.annotations=Ma.annotations,this.Zba=xa.ga(0),this.S3e=xa.ga(1)?Ma.u8(xa.ga(1)):null)}}Object(k.a)(jb,"ValueFilterAnnotationFilterInit",null,[]);var hb=d(278);class uc{u8(xa,Ma){const $a=xa.ga(0),Eb=new hb.a;Eb.aSa(xa,1,xa.count-1);switch($a){case 1:return new ha(new F(Eb,Ma),0);case 2:return new ha(new F(Eb,
Ma),1);case 3:return new ha(new F(Eb,Ma),2);case 101:return new Qa(new Sa(Eb,Ma));case 103:return new Da(new pa(Eb,Ma),0);case 104:return new Da(new pa(Eb,Ma),1);case 105:return new Da(new pa(Eb,Ma),2);case 106:return new Da(new pa(Eb,Ma),3);case 107:return new Da(new pa(Eb,Ma),4);case 108:return new Da(new pa(Eb,Ma),5);case 109:return new Da(new pa(Eb,Ma),6);case 201:return new za(new Wa(Eb));case 202:return new oa(new ua(Eb,Ma));case 301:return new na(new ba(Eb,Ma),0);case 302:return new na(new ba(Eb,
Ma),1);case 303:return new na(new ba(Eb,Ma),2);case 304:return new na(new ba(Eb,Ma),3);case 305:return new na(new ba(Eb,Ma),4);case 401:return new yb(new Za(Eb),0);case 402:return new yb(new Za(Eb),1);case 403:return new yb(new Za(Eb),2);case 404:return new wa(new ra(Eb,Ma),0);case 405:return new wa(new ra(Eb,Ma),1);case 406:return new wa(new ra(Eb,Ma),2);case 407:return new wa(new ra(Eb,Ma),3);case 501:return new Y(new S(Eb,Ma));case 502:return new la(new ua(Eb,Ma));case 601:return new fa(new Na(Eb,
Ma),0);case 602:return new fa(new Na(Eb,Ma),1);case 603:return new ka(new Na(Eb,Ma));case 604:return new ya(new ua(Eb,Ma),0);case 605:return new ya(new ua(Eb,Ma),1);case 606:return new ya(new ua(Eb,Ma),2);case 607:return new ya(new ua(Eb,Ma),3);case 701:return new da(!1);case 702:return new da(!0);case 703:return new O(new jb(Eb,Ma),!1);case 704:return new O(new jb(Eb,Ma),!0);case 705:return new W(new jb(Eb,Ma),!1);case 706:return new W(new jb(Eb,Ma),!0);case 707:return new La(new ta(Eb,Ma));case 901:return new Hc(new kb(Eb,
Ma));case 1002:return new Fa(new ua(Eb,Ma));case 1001:return new Ib(new Ob(Eb,Ma));default:throw Error.argument("initData");}}}Object(k.a)(uc,"FilterFactory",null,[1108]);var mc=d(138);class Ya{constructor(xa){this.Ia=xa}get Xx(){return this.Ia.Xx}get MU(){return this.Ia.MU}get Eqd(){return this.Ia.Eqd}get QXc(){return this.Ia.QXc}load(xa,Ma){return this.pp(xa,xa?new Ea("root",xa,Ma):Ma)}store(xa,Ma,$a){this.DMb(xa,Ma,xa?new Ea("root",xa,$a):$a,null)}pp(xa,Ma){if(!this.QXc&&!this.Ia.annotations.Pyb(this.Xx,
xa))throw Error.argument("input","Input value not of expected type");let $a=this.Ia.EUf;for(;$a;)xa=$a.load(xa,Ma),$a=$a.next;return xa}DMb(xa,Ma,$a,Eb){if(!this.Eqd)throw Error.invalidOperation("Attempt to store into query that supports only loading");if(!this.QXc&&!this.Ia.annotations.Pyb(this.Xx,xa))throw Error.argument("lvalue","Lvalue not of expected type");if(!this.Ia.annotations.Pyb(this.MU,Ma))throw Error.argument("rvalue","Rvalue not of expected type");return this.Ia.EUf.store(xa,Ma,$a,Eb)}static rEf(xa,
Ma,$a,Eb){if($a===Eb)return Ma;if(D.Annotations.HB($a)&&D.Annotations.HB(Eb)){$a=D.Annotations.QDa($a);Eb=D.Annotations.QDa(Eb);const ac=new mc.a(xa,Eb);for(const tc of Ma.items)Array.add(ac.items,Ya.rEf(xa,tc,$a,Eb));return ac}if($a===D.Annotations.Toa){if(Eb===D.Annotations.Gaa)return Ma;if(Eb===D.Annotations.ZY)return Ma.toString()}else if($a===D.Annotations.Gaa){if(Eb===D.Annotations.Toa)return Math.floor(Ma);if(Eb===D.Annotations.ZY)return Ma.toString()}else if($a===D.Annotations.ZY){if(Eb===
D.Annotations.Toa)return parseInt(Ma);if(Eb===D.Annotations.Gaa)return parseFloat(Ma)}throw Error.invalidOperation("Type conversion failure in query step");}}Object(k.a)(Ya,"AnnotationQuery",null,[1169]);class Mb{constructor(){this.MU=this.Xx=0;this.next=null}store(){throw Error.invalidOperation("Store not supported");}UDa(xa){if(this.next)return{returnValue:this.next,Goa:xa};if(xa){const Ma=xa.jGf;xa=xa.hbh;return{returnValue:Ma,Goa:xa}}return{returnValue:null,Goa:xa}}}Object(k.a)(Mb,"AnnotationQueryStep",
null,[1209]);class Kc extends Mb{constructor(xa){super();this.Ia=xa}load(xa,Ma){Ma=this.Ia.query.pp(xa,Ma);if(D.Annotations.HB(this.Xx)){var $a=D.Annotations.QDa(this.Xx);let ac=new mc.a(this.Ia.annotations,$a);if(D.Annotations.HB(this.Ia.query.MU)){if(xa.items.length!==Ma.items.length)throw Error.invalidOperation("List length mismatch in itemwise numeric query step");for(let tc=0,aa=xa.items.length;tc<aa;++tc)Array.add(ac.items,this.cIc(xa.items[tc],Ma.items[tc],$a===D.Annotations.Gaa))}else for(var Eb of xa.items)Array.add(ac.items,
this.cIc(Eb,Ma,$a===D.Annotations.Gaa));return ac}if(D.Annotations.HB(this.Ia.query.MU)){Eb=new mc.a(this.Ia.annotations,this.Xx);for($a of Ma.items)Array.add(Eb.items,this.cIc(xa,$a,this.Xx===D.Annotations.Gaa));return Eb}return this.cIc(xa,Ma,this.Xx===D.Annotations.Gaa)}cIc(xa,Ma,$a){xa=this.hsb(xa,Ma);return $a?xa:Math.floor(xa)}}Object(k.a)(Kc,"NumericAnnotationQueryStep",Mb,[]);class eb extends Kc{constructor(xa){super(xa)}hsb(xa,Ma){return xa+Ma}}Object(k.a)(eb,"AddAnnotationQueryStep",Kc,
[]);class Tb extends Mb{constructor(xa){super();this.Ia=xa}load(xa,Ma){if(this.Xx===D.Annotations.sga&&this.Ia.query.MU===D.Annotations.sga){let ac;if(({result:ac}=this.eBf(xa)).returnValue)return ac}if(D.Annotations.HB(this.Xx)){var $a=new mc.a(this.Ia.annotations,D.Annotations.sga);Ma=this.Ia.query.pp(xa,Ma);if(D.Annotations.HB(this.Ia.query.MU)){if(xa.items.length!==Ma.items.length)throw Error.invalidOperation("List length mismatch in itemwise boolean query step");for(let ac=0,tc=xa.items.length;ac<
tc;++ac)Array.add($a.items,this.R_b(Ma.items[ac],xa.items[ac]))}else for(var Eb of xa.items)Array.add($a.items,this.R_b(Ma,Eb));return $a}Eb=this.Ia.query.pp(xa,Ma);if(D.Annotations.HB(this.Ia.query.MU)){Ma=new mc.a(this.Ia.annotations,D.Annotations.sga);for($a of Eb.items)Array.add(Ma.items,this.R_b($a,xa));return Ma}return this.R_b(Eb,xa)}}Object(k.a)(Tb,"BinaryBooleanAnnotationQueryStep",Mb,[]);class lb extends Tb{constructor(xa){super(xa)}eBf(xa){return{returnValue:!xa,result:!1}}R_b(xa,Ma){return xa&&
Ma}}Object(k.a)(lb,"AndAnnotationQueryStep",Tb,[]);class Fb{constructor(xa){xa&&(this.annotations=xa)}}Object(k.a)(Fb,"AnnotationsOnlyQueryStepInit",null,[]);class rb extends Mb{constructor(xa){super();this.Ia=xa}load(xa,Ma){Ma=this.Ia.query.pp(xa,Ma);xa=xa.clone();D.Annotations.HB(this.Ia.query.MU)?Array.addRange(xa.items,Ma.items):Array.add(xa.items,Ma);return xa}}Object(k.a)(rb,"AppendAnnotationQueryStep",Mb,[]);class Qb extends Mb{constructor(xa){super();this.Ia=xa}load(xa,Ma){if(this.Xx===D.Annotations.IM)return this.W2b(xa,
Ma);const $a=new mc.a(this.Ia.annotations,D.Annotations.IM);for(const Eb of xa.items)Array.add($a.items,this.W2b(Eb,Ma));return $a}W2b(xa,Ma){const $a=new R.a(this.Ia.annotations);$a.nCa(xa);xa=new R.a(this.Ia.annotations);this.Ia.script.f8(null,new Ea("Input",$a,new Ea("Output",xa,Ma)));return xa}}Object(k.a)(Qb,"ApplyAnnotationQueryStep",Mb,[]);class Bc extends Mb{constructor(xa){super();this.Ia=xa}load(xa,Ma){if(this.Xx===D.Annotations.IM)return Ma=this.W2b(xa,Ma),Ma.Qm(this.Ia.duf).returnValue||
new mc.a(this.Ia.annotations,D.Annotations.IM),Ma;const $a=new mc.a(this.Ia.annotations,D.Annotations.IM);for(const Eb of xa.items)if(xa=this.W2b(Eb,Ma),({value:xa}=xa.Qm(this.Ia.duf)).returnValue)for(const ac of xa.items)Array.add($a.items,ac);return $a}W2b(xa,Ma){const $a=new R.a(this.Ia.annotations);$a.nCa(xa);xa=new R.a(this.Ia.annotations);this.Ia.script.f8(null,new Ea("Input",$a,new Ea("Output",xa,Ma)));return xa}}Object(k.a)(Bc,"ApplyExpandAnnotationQueryStep",Mb,[]);class wb{constructor(xa,
Ma){xa&&(this.annotations=Ma.annotations,this.script=Ma.R8a(xa.ga(0)),this.duf=xa.ga(1))}}Object(k.a)(wb,"ApplyExpandQueryStepInit",null,[]);class Ad{constructor(xa,Ma){xa&&(this.annotations=Ma.annotations,this.script=Ma.R8a(xa.ga(0)))}}Object(k.a)(Ad,"ApplyQueryStepInit",null,[]);class bc extends Mb{constructor(xa){super();this.Ia=xa}load(xa){if(this.Xx===D.Annotations.IM)return this.U0c(xa);const Ma=new mc.a(this.Ia.annotations,this.Ia.annotations.getAttributeType(this.Ia.Zba));for(const $a of xa.items)Array.add(Ma.items,
this.U0c($a));return Ma}store(xa,Ma,$a,Eb){if(this.Xx===D.Annotations.IM){var ac=Ma,tc=({Goa:Eb}=this.UDa(Eb)).returnValue;tc&&(ac=tc.store(D.Annotations.PK(this.U0c(xa)),Ma,$a,Eb));xa.lu(this.Ia.Zba,ac)}else{var aa=Ma;if(ac=({Goa:Eb}=this.UDa(Eb)).returnValue){aa=new mc.a(this.Ia.annotations,this.Ia.annotations.getAttributeType(this.Ia.Zba));for(tc of xa.items)Array.add(aa.items,this.U0c(tc));aa=ac.store(aa,Ma,$a,Eb)}Ma=aa;if(Ma.items.length!==xa.items.length)throw Error.invalidOperation("RValue list length mismatch in Attr query step store");
for(let sa=0,Oa=xa.items.length;sa<Oa;++sa)$a=xa.items[sa],$a.isReadOnly&&($a=$a.clone(),xa.items[sa]=$a),$a.lu(this.Ia.Zba,Ma.items[sa])}return xa}U0c(xa){({value:xa}=xa.Qm(this.Ia.Zba)).returnValue||(xa=this.Ia.annotations.l2i(this.Ia.Zba));return xa}}Object(k.a)(bc,"AttrAnnotationQueryStep",Mb,[]);class Sb{constructor(xa,Ma){xa&&(this.annotations=Ma,this.Zba=xa.ga(0))}}Object(k.a)(Sb,"AttrQueryStepInit",null,[]);class Zb extends Mb{constructor(xa){super();this.Ia=xa}load(xa){const Ma=new R.a(this.Ia.annotations);
Ma.nCa(xa);return this.Ia.module.execute(Ma)}}Object(k.a)(Zb,"CallModuleAnnotationQueryStep",Mb,[]);class cb{constructor(xa,Ma){xa&&(this.annotations=Ma.annotations,this.module=Ma.g7d(xa.ga(0)))}}Object(k.a)(cb,"CallModuleQueryStepInit",null,[]);class Xa extends Mb{constructor(xa){super();this.Ia=xa}load(xa,Ma){if(D.Annotations.HB(this.Xx)){var $a=this.Ia.query.pp(xa,Ma);Ma=new mc.a(this.Ia.annotations,D.Annotations.ZY);let tc="string"===typeof $a;for(var Eb of xa.items)if(tc)Array.add(Ma.items,Eb+
$a);else for(var ac of $a.items)Array.add(Ma.items,Eb+ac);return Ma}Eb=this.Ia.query.pp(xa,Ma);if("string"===typeof Eb)return xa+Eb;ac=new mc.a(this.Ia.annotations,D.Annotations.ZY);for($a of Eb.items)Array.add(ac.items,xa+$a);return ac}}Object(k.a)(Xa,"ConcatAnnotationQueryStep",Mb,[]);class Lb extends Mb{constructor(xa){super();this.Ia=xa}load(xa){return Ya.rEf(this.Ia.annotations,xa,this.Xx,this.MU)}}Object(k.a)(Lb,"ConvertAnnotationQueryStep",Mb,[]);class pc extends Mb{constructor(){super()}load(xa){return xa.items.length}}
Object(k.a)(pc,"CountAnnotationQueryStep",Mb,[]);class fc extends Kc{constructor(xa){super(xa)}hsb(xa,Ma){return xa/Ma}}Object(k.a)(fc,"DivideAnnotationQueryStep",Kc,[]);class bd extends Mb{constructor(xa){super();this.Ia=xa}load(xa,Ma){Ma=new Ea(this.Ia.mud,null,Ma);for(const $a of xa.items)if(Ma.bTd($a),this.Ia.query.pp($a,Ma))return!0;return!1}}Object(k.a)(bd,"ExistsAnnotationQueryStep",Mb,[]);class od extends Kc{constructor(xa){super(xa)}hsb(xa,Ma){return Math.pow(xa,Ma)}}Object(k.a)(od,"ExpAnnotationQueryStep",
Kc,[]);class ye{constructor(xa,Ma){xa&&(this.Isa=Ma.nC(xa.ga(0)))}}Object(k.a)(ye,"FeatureBundleNameQueryStepInit",null,[]);class pd extends Mb{constructor(xa){super();this.Ia=xa}load(xa){if(D.Annotations.HB(this.Xx)){const Ma=new mc.a(this.Ia.annotations,this.Ia.annotations.K9a(D.Annotations.QDa(this.Xx),this.Ia.Jsa));for(const $a of xa.items)Array.add(Ma.items,$a.wSa(this.Ia.Jsa));return Ma}return xa.wSa(this.Ia.Jsa)}store(xa,Ma,$a,Eb){if(D.Annotations.HB(this.Xx)){var ac=Ma,tc=({Goa:Eb}=this.UDa(Eb)).returnValue;
if(tc){ac=new mc.a(this.Ia.annotations,this.Ia.annotations.K9a(D.Annotations.QDa(this.Xx),this.Ia.Jsa));for(var aa of xa.items)Array.add(ac.items,aa.wSa(this.Ia.Jsa));ac=tc.store(ac,Ma,$a,Eb)}Ma=ac;if(Ma.items.length!==xa.items.length)throw Error.invalidOperation("RValue list length mismatch in Field query step store");for(let sa=0,Oa=xa.items.length;sa<Oa;++sa)$a=xa.items[sa],$a.isReadOnly&&($a=$a.clone(),xa.items[sa]=$a),$a.rTe(this.Ia.Jsa,Ma.items[sa])}else tc=Ma,(aa=({Goa:Eb}=this.UDa(Eb)).returnValue)&&
(tc=aa.store(D.Annotations.PK(xa.wSa(this.Ia.Jsa)),Ma,$a,Eb)),xa.rTe(this.Ia.Jsa,tc);return xa}}Object(k.a)(pd,"FieldAnnotationQueryStep",Mb,[]);class ab{constructor(xa,Ma){xa&&(this.annotations=Ma,this.Jsa=xa.ga(0))}}Object(k.a)(ab,"FieldQueryStepInit",null,[]);class Yb extends Mb{constructor(xa){super();this.Ia=xa}load(xa,Ma){for(const $a of xa.items)if(this.Ia.filter.isMatch($a,Ma))return $a;throw Error.invalidOperation("No matching item found in FirstItemMatching load step");}store(xa,Ma,$a,Eb){let ac=
Ma,tc=-1;for(let sa=0,Oa=xa.items.length;sa<Oa;sa++)if(this.Ia.filter.isMatch(xa.items[sa],$a)){tc=sa;break}if(0>tc)throw Error.invalidOperation("No matching item found in FirstItemMatching store step");const aa=({Goa:Eb}=this.UDa(Eb)).returnValue;aa&&(ac=aa.store(D.Annotations.PK(xa.items[tc]),Ma,$a,Eb));xa.items[tc]=ac;return xa}}Object(k.a)(Yb,"FirstItemMatchingAnnotationQueryStep",Mb,[]);class Sc extends Mb{constructor(xa){super();this.Ia=xa}load(xa,Ma){Ma=new Ea(this.Ia.mud,null,Ma);for(const $a of xa.items)if(Ma.bTd($a),
!this.Ia.query.pp($a,Ma))return!1;return!0}}Object(k.a)(Sc,"ForAllAnnotationQueryStep",Mb,[]);class Jb extends Mb{constructor(xa){super();this.Ia=xa}load(xa,Ma){xa=Ma?Ma.FRc(this.Ia.Isa):null;if(!xa)throw Error.invalidOperation('Feature bundle resolution failure: "'+this.Ia.Isa+'"');return xa}store(xa,Ma,$a,Eb){xa=$a?$a.FRc(this.Ia.Isa):null;if(!xa)throw Error.invalidOperation('Feature bundle resolution failure: "'+this.Ia.Isa+'"');let ac=Ma;const tc=({Goa:Eb}=this.UDa(Eb)).returnValue;tc&&(ac=tc.store(xa,
Ma,$a,Eb));xa!==ac&&xa.nCa(ac);return xa}}Object(k.a)(Jb,"GetAnnotationQueryStep",Mb,[]);class Oc{constructor(xa,Ma){this.zOh=xa;this.LXh=Ma}get jGf(){return this.zOh}get hbh(){return this.LXh}}Object(k.a)(Oc,"AnnotationQueryStoreContinuation",null,[1226]);class Wb extends Mb{constructor(xa){super();this.Ia=xa}load(xa,Ma){return this.Ia.qrd.pp(xa,Ma)?this.Ia.GCh.pp(xa,Ma):this.Ia.FOc?this.Ia.FOc.pp(xa,Ma):xa}store(xa,Ma,$a,Eb){var ac=this.Ia.qrd.pp(xa,$a);this.next&&(Eb=new Oc(this.next,Eb));if(ac)return this.Ia.GCh.DMb(xa,
Ma,$a,Eb);if(this.Ia.FOc)return this.Ia.FOc.DMb(xa,Ma,$a,Eb);ac=Ma;let tc=null;Eb&&(tc=Eb.jGf,Eb=Eb.hbh);tc&&(ac=tc.store(D.Annotations.PK(xa),Ma,$a,Eb));return ac}}Object(k.a)(Wb,"IfAnnotationQueryStep",Mb,[]);class Ab{constructor(xa,Ma){xa&&(this.qrd=Ma.QD(xa.ga(0)),this.GCh=Ma.QD(xa.ga(1)),this.FOc=xa.ga(2)?Ma.QD(xa.ga(2)):null)}}Object(k.a)(Ab,"IfQueryStepInit",null,[]);class Xb{constructor(xa,Ma){xa&&(this.TAj=Ma.QD(xa.ga(0)),this.Dlg=Ma.QD(xa.ga(1)))}}Object(k.a)(Xb,"IndexAndItemQueryStepInit",
null,[]);class vb extends Mb{constructor(xa){super();this.Ia=xa}load(xa,Ma){const $a=this.Ia.TAj.pp(xa,Ma);Ma=this.Ia.Dlg.pp(xa,Ma);xa=xa.clone();if(0>$a||$a>xa.items.length)throw Error.invalidOperation("Index out of range in InsertAt() query step");if(D.Annotations.HB(this.Ia.Dlg.MU))for(let Eb=0;Eb<Ma.items.length;++Eb)Array.insert(xa.items,$a+Eb,Ma.items[Eb]);else Array.insert(xa.items,$a,Ma);return xa}}Object(k.a)(vb,"InsertAtAnnotationQueryStep",Mb,[]);class $c extends Mb{constructor(xa){super();
this.Ia=xa}load(xa,Ma){return!(!Ma||!Ma.FRc(this.Ia.Isa))}}Object(k.a)($c,"IsDefinedAnnotationQueryStep",Mb,[]);class fd extends Mb{constructor(xa){super();this.Ia=xa}load(xa,Ma){Ma=this.lwb(xa,Ma);return xa.items[Ma]}store(xa,Ma,$a,Eb){const ac=this.lwb(xa,$a);let tc=Ma;const aa=({Goa:Eb}=this.UDa(Eb)).returnValue;aa&&(tc=aa.store(D.Annotations.PK(xa.items[ac]),Ma,$a,Eb));xa.items[ac]=tc;return xa}lwb(xa,Ma){Ma=this.Ia.query.pp(xa,Ma);if(0>Ma||Ma>=xa.items.length)throw Error.invalidOperation("Index out of range in Item store step");
return Ma}}Object(k.a)(fd,"ItemAnnotationQueryStep",Mb,[]);class Bd extends Mb{constructor(xa){super();this.Ia=xa}load(xa,Ma){const $a=new mc.a(this.Ia.annotations,D.Annotations.QDa(this.Xx));for(const Eb of xa.items)this.Ia.filter.isMatch(Eb,Ma)&&Array.add($a.items,Eb);return $a}}Object(k.a)(Bd,"ItemsMatchingAnnotationQueryStep",Mb,[]);class gd extends Mb{constructor(xa){super();this.Ia=xa}load(xa,Ma){Ma=this.lwb(xa,Ma);return xa.items[xa.items.length-Ma-1]}store(xa,Ma,$a,Eb){const ac=this.lwb(xa,
$a);let tc=Ma;const aa=({Goa:Eb}=this.UDa(Eb)).returnValue;aa&&(tc=aa.store(D.Annotations.PK(xa.items[xa.items.length-ac-1]),Ma,$a,Eb));xa.items[xa.items.length-ac-1]=tc;return xa}lwb(xa,Ma){Ma=this.Ia.query?this.Ia.query.pp(xa,Ma):0;if(0>Ma||Ma>=xa.items.length)throw Error.invalidOperation("Index out of range in LastItem load step");return Ma}}Object(k.a)(gd,"LastItemAnnotationQueryStep",Mb,[]);class Pd extends Mb{constructor(xa){super();this.Ia=xa}load(xa){if(D.Annotations.HB(this.Xx)){const Ma=
new mc.a(this.Ia.annotations,D.Annotations.Toa);for(const $a of xa.items)Array.add(Ma.items,$a.length);return Ma}return xa.length}}Object(k.a)(Pd,"LengthAnnotationQueryStep",Mb,[]);class cd extends Mb{constructor(xa){super();this.Ia=xa}load(xa,Ma){if(D.Annotations.HB(this.Xx)){const $a=new mc.a(this.Ia.annotations,D.Annotations.sga);for(const Eb of xa.items)Array.add($a.items,this.Ia.filter.isMatch(Eb,Ma));return $a}return this.Ia.filter.isMatch(xa,Ma)}}Object(k.a)(cd,"MatchesAnnotationQueryStep",
Mb,[]);class lf extends Mb{constructor(xa){super();this.Ia=xa}load(xa,Ma){return this.Ia.filter.isMatch(xa,Ma)}}Object(k.a)(lf,"MatchesAsListAnnotationQueryStep",Mb,[]);class Jd extends Kc{constructor(xa){super(xa)}hsb(xa,Ma){return xa%Ma}}Object(k.a)(Jd,"ModuloAnnotationQueryStep",Kc,[]);class Xf extends Kc{constructor(xa){super(xa)}hsb(xa,Ma){return xa*Ma}}Object(k.a)(Xf,"MultiplyAnnotationQueryStep",Kc,[]);class ee extends Mb{constructor(xa){super();this.Ia=xa}load(xa){if(D.Annotations.HB(this.Xx)){const Ma=
new mc.a(this.Ia.annotations,D.Annotations.sga);for(const $a of xa.items)Array.add(Ma.items,!$a);return Ma}return!xa}}Object(k.a)(ee,"NotAnnotationQueryStep",Mb,[]);class Ra extends Tb{constructor(xa){super(xa)}eBf(xa){return{returnValue:xa,result:!0}}R_b(xa,Ma){return xa||Ma}}Object(k.a)(Ra,"OrAnnotationQueryStep",Tb,[]);class sb extends Mb{constructor(xa){super();this.Ia=xa}load(xa,Ma){const $a=this.Ia.mYe.pp(xa,Ma);xa=this.Ia.q0b.pp(xa,Ma);Ma=new mc.a(this.Ia.annotations,D.Annotations.Toa);for(let Eb=
0;Eb<xa;++Eb)Array.add(Ma.items,$a+Eb);return Ma}}Object(k.a)(sb,"RangeAnnotationQueryStep",Mb,[]);class ec{constructor(xa,Ma){xa&&(this.annotations=Ma.annotations,this.filter=Ma.u8(xa.ga(0)))}}Object(k.a)(ec,"SingleFilterQueryStepInit",null,[]);class Lc{constructor(xa,Ma){xa&&(this.annotations=Ma.annotations,this.query=xa.ga(0)?Ma.QD(xa.ga(0)):null)}}Object(k.a)(Lc,"SingleOptionalQueryQueryStepInit",null,[]);class nd{constructor(xa,Ma){xa&&(this.annotations=Ma.annotations,this.query=Ma.QD(xa.ga(0)))}}
Object(k.a)(nd,"SingleQueryQueryStepInit",null,[]);class Fd{constructor(xa,Ma){xa&&(this.annotations=Ma.annotations,this.mYe=Ma.QD(xa.ga(0)),this.q0b=xa.ga(1)?Ma.QD(xa.ga(1)):null)}}Object(k.a)(Fd,"StartAndCountOrLengthQueryStepInit",null,[]);class Ja extends Mb{constructor(xa){super();this.Ia=xa}load(xa,Ma){let $a;({fLa:Ma,length:$a}=this.yTc(xa,Ma));const Eb=new mc.a(this.Ia.annotations,xa.wU);for(let ac=0;ac<$a;++ac)Array.add(Eb.items,xa.items[Ma+ac]);return Eb}store(xa,Ma,$a,Eb){let ac,tc;({fLa:ac,
length:tc}=this.yTc(xa,$a));var aa=Ma;const sa=({Goa:Eb}=this.UDa(Eb)).returnValue;if(sa){aa=new mc.a(this.Ia.annotations,xa.wU);for(let Oa=0;Oa<tc;++Oa)Array.add(aa.items,xa.items[ac+Oa]);aa=sa.store(aa,Ma,$a,Eb)}Ma=aa;for($a=0;$a<tc;++$a)Array.removeAt(xa.items,ac);for(let Oa=0,ib=Ma.items.length;Oa<ib;++Oa)Array.insert(xa.items,ac+Oa,Ma.items[Oa]);return xa}yTc(xa,Ma){let $a;$a=this.Ia.mYe.pp(xa,Ma);if(0>$a)throw Error.invalidOperation("Invalid start index in Sublist() query step");Ma=this.Ia.q0b?
this.Ia.q0b.pp(xa,Ma):xa.items.length-$a;if(0>Ma||$a+Ma>xa.items.length)throw Error.invalidOperation("Start index or length out of range in Sublist() query step");return{fLa:$a,length:Ma}}}Object(k.a)(Ja,"SublistAnnotationQueryStep",Mb,[]);class db extends Mb{constructor(xa){super();this.Ia=xa}load(xa,Ma){if(D.Annotations.HB(this.Xx)){const $a=new mc.a(this.Ia.annotations,D.Annotations.ZY);for(let Eb=0,ac=xa.items.length;Eb<ac;++Eb)Array.add($a.items,this.getSubstring(xa.items[Eb],Ma));return $a}return this.getSubstring(xa,
Ma)}store(){throw Error.invalidOperation("Substring() store not yet supported by the runtime");}getSubstring(xa,Ma){let $a;({fLa:Ma,length:$a}=this.yTc(xa,Ma));return xa.substr(Ma,$a)}yTc(xa,Ma){let $a;$a=this.Ia.mYe.pp(xa,Ma);if(0>$a)throw Error.invalidOperation("Invalid start index in Substring() query step");Ma=this.Ia.q0b?this.Ia.q0b.pp(xa,Ma):xa.length-$a;if(0>Ma||$a+Ma>xa.length)throw Error.invalidOperation("Start index or length out of range in Substring() query step");return{fLa:$a,length:Ma}}}
Object(k.a)(db,"SubstringAnnotationQueryStep",Mb,[]);class ic extends Kc{constructor(xa){super(xa)}hsb(xa,Ma){return xa-Ma}}Object(k.a)(ic,"SubtractAnnotationQueryStep",Kc,[]);class id extends Mb{constructor(xa){super();this.Ia=xa}load(xa){const Ma=new mc.a(this.Ia.annotations,D.Annotations.ZY);for(let $a=0;$a<xa.length;++$a)Array.add(Ma.items,xa.charAt($a).toString());return Ma}}Object(k.a)(id,"ToCharListAnnotationQueryStep",Mb,[]);class qd extends Mb{constructor(xa){super();this.Ia=xa}load(xa){const Ma=
new mc.a(this.Ia.annotations,this.Xx);Array.add(Ma.items,xa);return Ma}}Object(k.a)(qd,"ToListAnnotationQueryStep",Mb,[]);class Fc extends Mb{constructor(xa){super();this.Ia=xa}load(){return this.Ia.value}}Object(k.a)(Fc,"ValueAnnotationQueryStep",Mb,[]);class Ze{constructor(xa,Ma){if(xa){var $a=xa.ga(0),Eb=1;this.value=({D3:Eb}=Ma.gsa($a,xa,Eb,null,null,null)).returnValue;D.Annotations.sbb(this.value)}}}Object(k.a)(Ze,"ValueQueryStepInit",null,[]);class df{constructor(xa,Ma){xa&&(this.mud=Ma.nC(xa.ga(0)),
this.query=Ma.QD(xa.ga(1)))}}Object(k.a)(df,"VarNameAndQueryQueryStepInit",null,[]);class ve{constructor(xa,Ma){this.S$e=null;if(xa){this.annotations=Ma.annotations;var $a=0;this.Xx=xa.ga($a);++$a;this.MU=xa.ga($a);++$a;this.Eqd=1===xa.ga($a);++$a;this.QXc=1===xa.ga($a);++$a;var Eb=xa.ga($a);++$a;if(Eb){var ac=$a,tc=$a+Eb,aa=$a+2*Eb;$a+=3*Eb;var sa=xa.count-$a,Oa=null;for(let Gb=0;Gb<Eb;++Gb){var ib=$a+xa.ga(aa+Gb);const Bb=(Gb===Eb-1?sa:xa.ga(aa+Gb+1))-xa.ga(aa+Gb),Cc=new hb.a;Cc.aSa(xa,ib,Bb);ib=
ve.ncj(xa.ga(tc+Gb),Cc,Ma);ib.Xx=xa.ga(ac+Gb);ib.MU=Gb===Eb-1?this.MU:xa.ga(ac+Gb+1);Oa?Oa.next=ib:this.S$e=ib;Oa=ib}}}}get EUf(){return this.S$e}static ncj(xa,Ma,$a){switch(xa){case 1:return new Jb(new ye(Ma,$a));case 2:return new $c(new ye(Ma,$a));case 3:return new bc(new Sb(Ma,$a.annotations));case 4:return new pd(new ab(Ma,$a.annotations));case 5:return new Wb(new Ab(Ma,$a));case 6:return new cd(new ec(Ma,$a));case 43:return new lf(new ec(Ma,$a));case 45:return new Qb(new Ad(Ma,$a));case 49:return new Bc(new wb(Ma,
$a));case 46:return new Fc(new Ze(Ma,$a.annotations));case 51:return new Zb(new cb(Ma,$a));case 52:return new sb(new Fd(Ma,$a));case 53:return new Lb(new Fb($a.annotations));case 13:return new fd(new nd(Ma,$a));case 14:return new gd(new Lc(Ma,$a));case 15:return new pc;case 18:return new Yb(new ec(Ma,$a));case 16:return new Sc(new df(Ma,$a));case 17:return new bd(new df(Ma,$a));case 22:return new vb(new Xb(Ma,$a));case 24:return new rb(new nd(Ma,$a));case 26:return new Ja(new Fd(Ma,$a));case 27:return new Bd(new ec(Ma,
$a));case 30:return new qd(new Fb($a.annotations));case 31:return new db(new Fd(Ma,$a));case 32:return new Xa(new nd(Ma,$a));case 47:return new Pd(new Fb($a.annotations));case 48:return new id(new Fb($a.annotations));case 34:return new eb(new nd(Ma,$a));case 35:return new ic(new nd(Ma,$a));case 36:return new Xf(new nd(Ma,$a));case 37:return new fc(new nd(Ma,$a));case 38:return new Jd(new nd(Ma,$a));case 39:return new od(new nd(Ma,$a));case 40:return new lb(new nd(Ma,$a));case 41:return new Ra(new nd(Ma,
$a));case 42:return new ee(new Fb($a.annotations));default:throw Error.argument("currStepInitData");}}}Object(k.a)(ve,"AnnotationQueryInit",null,[]);class md{constructor(xa){this.Ia=xa}execute(xa,Ma){this.f8(xa,xa?new Ea("root",xa,Ma):Ma)}f8(xa,Ma){for(const $a of this.Ia.commands)Ma=$a.execute(xa,Ma)}}Object(k.a)(md,"AnnotationScript",null,[1168]);class Kf{constructor(xa){this.Ia=xa}execute(xa,Ma){const $a=this.Ia.AEj.pp(xa,Ma),Eb=this.Ia.bwk.pp(xa,Ma);this.Ia.script.f8(xa,new Ea("Input",$a,new Ea("Output",
Eb,Ma)));return Ma}}Object(k.a)(Kf,"ApplyAnnotationScriptCommand",null,[1210]);class oe{constructor(xa,Ma){xa&&(this.AEj=Ma.QD(xa.ga(0)),this.bwk=Ma.QD(xa.ga(1)),this.script=Ma.R8a(xa.ga(2)))}}Object(k.a)(oe,"ApplyScriptCommandInit",null,[]);class Hf{constructor(xa){this.Ia=xa}execute(xa,Ma){const $a=this.Ia.uRe.pp(xa,Ma);this.Ia.o1c.DMb(xa,$a,Ma,null);return Ma}}Object(k.a)(Hf,"AssignAnnotationScriptCommand",null,[1210]);class xb{constructor(xa){this.Ia=xa}execute(xa,Ma){const $a=this.Ia.o1c.pp(xa,
Ma);xa=this.Ia.uRe.pp(xa,Ma);$a!==xa&&$a.nCa(xa);return Ma}}Object(k.a)(xb,"CopyAnnotationScriptCommand",null,[1210]);class hg{constructor(xa){this.Ia=xa}execute(xa,Ma){let $a=this.Ia.vme.pp(xa,Ma);if(this.Ia.vme.Eqd){$a=D.Annotations.PK($a);var Eb=new Ea(this.Ia.Isa,null,Ma);for(let tc=0,aa=$a.items.length;tc<aa;++tc){var ac=this.hRf(xa,$a.items[tc],Eb);if(0>this.Ia.Xkd)$a.items[tc]=ac;else if(({value:ac}=ac.Qm(this.Ia.Xkd)).returnValue)$a.items[tc]=ac;else throw Error.invalidOperation("Expected result attribute missing in Enumerate() script command");
}this.Ia.vme.DMb(xa,$a,Ma,null)}else{Eb=new Ea(this.Ia.Isa,null,Ma);for(let tc=0,aa=$a.items.length;tc<aa;++tc)this.hRf(xa,$a.items[tc],Eb)}return Ma}hRf(xa,Ma,$a){let Eb;0>this.Ia.Xkd?Eb=D.Annotations.PK(Ma):(Eb=new R.a(this.Ia.annotations),Eb.lu(this.Ia.Xkd,Ma));$a.bTd(Eb);this.Ia.Bhi.f8(xa,$a);return Eb}}Object(k.a)(hg,"EnumerateAnnotationScriptCommand",null,[1210]);class rf{constructor(xa,Ma){xa&&(this.annotations=Ma.annotations,this.Isa=Ma.nC(xa.ga(0)),this.vme=Ma.QD(xa.ga(1)),this.Bhi=Ma.R8a(xa.ga(2)),
this.Xkd=xa.ga(3))}}Object(k.a)(rf,"EnumerateScriptCommandInit",null,[]);class nf{constructor(xa){this.Ia=xa}execute(xa,Ma){this.Ia.qrd.pp(xa,Ma)?this.Ia.ftl.f8(xa,Ma):this.Ia.RSf&&this.Ia.RSf.f8(xa,Ma);return Ma}}Object(k.a)(nf,"IfAnnotationScriptCommand",null,[1210]);class kd{constructor(xa,Ma){xa&&(this.qrd=Ma.QD(xa.ga(0)),this.ftl=Ma.R8a(xa.ga(1)),this.RSf=xa.ga(2)?Ma.R8a(xa.ga(2)):null)}}Object(k.a)(kd,"IfScriptCommandInit",null,[]);class If{constructor(xa,Ma){xa&&(this.annotations=Ma.annotations,
this.o1c=Ma.QD(xa.ga(0)),this.uRe=Ma.QD(xa.ga(1)))}}Object(k.a)(If,"LvalueAndRvalueQueryScriptCommandInit",null,[]);class og{constructor(xa){this.Ia=xa}execute(xa,Ma){const $a=this.Ia.uRe.pp(this.Ia.o1c.pp(xa,Ma),Ma);this.Ia.o1c.DMb(xa,$a,Ma,null);return Ma}}Object(k.a)(og,"ModifyAnnotationScriptCommand",null,[1210]);class pf{constructor(xa){this.Ia=xa}execute(xa,Ma){const $a=new R.a(this.Ia.annotations);this.Ia.query&&$a.nCa(this.Ia.query.pp(xa,Ma));return Ma=new Ea(this.Ia.Isa,$a,Ma)}}Object(k.a)(pf,
"NewAnnotationScriptCommand",null,[1210]);class ig{constructor(xa,Ma){xa&&(this.annotations=Ma.annotations,this.Isa=Ma.nC(xa.ga(0)),this.query=xa.ga(1)?Ma.QD(xa.ga(1)):null)}}Object(k.a)(ig,"NewScriptCommandInit",null,[]);class Oe{constructor(xa){this.Ia=xa}execute(xa,Ma){xa=this.Ia.query.pp(xa,Ma);if(this.Ia.query.MU===D.Annotations.IM)xa.Ujd(this.Ia.Zba);else for(const $a of xa.items)$a.Ujd(this.Ia.Zba);return Ma}}Object(k.a)(Oe,"RemoveAnnotationScriptCommand",null,[1210]);class Ag{constructor(xa,
Ma){xa&&(this.annotations=Ma.annotations,this.query=Ma.QD(xa.ga(0)),this.Zba=xa.ga(1))}}Object(k.a)(Ag,"RemoveScriptCommandInit",null,[]);class ce{constructor(xa,Ma){if(xa){var $a=0,Eb=xa.ga($a);++$a;if(Eb){var ac=$a,tc=$a+Eb;$a+=2*Eb;var aa=xa.count-$a;this.commands=Array(Eb);for(let sa=0;sa<Eb;++sa){const Oa=$a+xa.ga(tc+sa),ib=(sa===Eb-1?aa:xa.ga(tc+sa+1))-xa.ga(tc+sa),Gb=new hb.a;Gb.aSa(xa,Oa,ib);this.commands[sa]=ce.jcj(xa.ga(ac+sa),Gb,Ma)}}}}static jcj(xa,Ma,$a){switch(xa){case 1:return new Hf(new If(Ma,
$a));case 2:return new og(new If(Ma,$a));case 3:return new Oe(new Ag(Ma,$a));case 6:return new pf(new ig(Ma,$a));case 7:return new hg(new rf(Ma,$a));case 8:return new nf(new kd(Ma,$a));case 9:return new xb(new If(Ma,$a));case 10:return new Kf(new oe(Ma,$a));default:throw Error.argument("initData");}}}Object(k.a)(ce,"AnnotationScriptInit",null,[]);var me=d(700);class Je{constructor(xa){this.QH=xa;this.VM=0}vY(){const xa=this.QH.ku(this.VM,4);this.VM+=4;return xa}get EYb(){return this.QH}get offset(){return this.VM}set offset(xa){this.VM=
xa}}Object(k.a)(Je,"ByteArrayReader",null,[]);class ie{constructor(){this.yC=null;this.Yxg=this.gz=0}ga(xa){if(0>xa||xa>=this.gz)throw Error.argumentOutOfRange("index");return this.yC.ku(this.Yxg+4*xa,4)}get count(){return this.gz}static yCi(xa,Ma,$a){const Eb=new ie;Eb.yC=xa;Eb.Yxg=Ma;Eb.gz=$a;return Eb}}Object(k.a)(ie,"ReadOnlyListOverByteArray",null,[1133]);class Tf{constructor(xa,Ma){this.Gvg=this.mvg=!1;this.Er=this.xwa=this.Xne=this.Svg=null;try{this.Er=Ma.annotations;const $a=Ma.kSa(xa.ga(0)),
Eb=new Je($a);if(-914743053!==Eb.vY())throw Error.argument("Input does not represent a flat lexicon");this.mvg=1===Eb.vY();this.Gvg=1===Eb.vY();const ac=Eb.vY();Eb.offset+=ac;const tc=Eb.vY();this.Xne=Tf.yxk(Eb,tc,this.Er);const aa=Eb.vY();this.Svg=Tf.Lxk(Eb,aa);const sa=Eb.vY();this.xwa=new me.a(Eb.EYb,Eb.offset);Eb.offset+=sa}catch($a){throw Error.argument("initData");}}get trie(){return this.xwa}m3i(xa){return"i"===xa&&this.Gvg?"\u0130":xa.toUpperCase()}mhe(){return this.mvg}S1i(xa){let Ma;Ma=
new mc.a(this.Er,D.Annotations.IM);if(1!==xa)if(0===xa)xa=new R.a(this.Er),Array.add(Ma.items,xa);else if(xa&1073741824){xa=this.Svg[xa&-1073741825];for(let Eb=0;Eb<xa.length;++Eb){var $a=xa[Eb];$a=0===$a?new R.a(this.Er):this.Xne[$a-2];Array.add(Ma.items,$a)}}else Array.add(Ma.items,this.Xne[xa-2]);return{returnValue:!0,jYj:Ma}}static yxk(xa,Ma,$a){if(Ma%4)throw Error.argument("reader");const Eb=ie.yCi(xa.EYb,xa.offset,Ma/4);xa.offset+=Ma;xa=[];for(Ma=0;Ma<Eb.count;){const ac=({D3:Ma}=$a.gsa(D.Annotations.IM,
Eb,Ma,null,null,null)).returnValue;Array.add(xa,ac)}return xa}static Lxk(xa,Ma){Ma=xa.offset+Ma;const $a=[];for(;xa.offset<Ma;){const Eb=xa.vY(),ac=Array(Eb);for(let tc=0;tc<Eb;++tc){const aa=xa.vY();ac[tc]=aa}Array.add($a,ac)}return $a}}Object(k.a)(Tf,"RawFlatLexicon",null,[1167]);var He=d(689),Sg=d(690);class jc{constructor(xa){if(null==xa)throw Error.argumentNull("base64String");const Ma=xa.length;if(Ma%4)throw Error.argument("base64String's length must be a multiple of 4");this.gz=.75*Ma;this.ava=
Array(Math.ceil(this.gz/4));xa.endsWith("==")?this.gz-=2:xa.endsWith("=")&&--this.gz;let $a=0;for(let Eb=0;Eb<Ma;Eb+=4){const ac=jc.Nld[xa.charCodeAt(Eb)-43]<<18|jc.Nld[xa.charCodeAt(Eb+1)-43]<<12|jc.Nld[xa.charCodeAt(Eb+2)-43]<<6|jc.Nld[xa.charCodeAt(Eb+3)-43];let tc=ac>>16&255;this.ava[Math.floor($a/4)]|=tc<<$a%4*8;++$a;tc=ac>>8&255;this.ava[Math.floor($a/4)]|=tc<<$a%4*8;++$a;tc=ac&255;this.ava[Math.floor($a/4)]|=tc<<$a%4*8;++$a}}get length(){return this.gz}ga(xa){if(0>xa||xa>=this.gz)throw Error.argumentOutOfRange("i");
return this.VXf(xa)}ku(xa,Ma){if(0>xa||0>Ma||xa+Ma>this.gz)throw Error.argument("Bad range");let $a=0;for(let Eb=0;Eb<Ma;++Eb)$a|=this.VXf(xa+Eb)<<8*Eb;return $a}bMk(xa,Ma){let $a=0,Eb=0,ac=Math.floor(xa/8);for(xa%=8;Eb<Ma;){const tc=8-xa>Ma-Eb?Ma-Eb:8-xa,aa=this.ga(ac);$a|=(aa>>xa&~(255<<tc))<<Eb;Eb+=tc;++ac;xa=0}return $a}VXf(xa){return this.ava[Math.floor(xa/4)]>>xa%4*8&255}}jc.Nld=[62,0,0,0,63,52,53,54,55,56,57,58,59,60,61,0,0,0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,
22,23,24,25,0,0,0,0,0,0,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51];Object(k.a)(jc,"ByteArray",null,[]);class be{constructor(xa,Ma,$a){this.jy=xa;this.o6j=Ma;this.g$j=$a;this.Hyg=Array(xa.b?xa.b.length:0);this.tAe=new He.a(new Sg.a(this.kSa(this.jy.s)));this.BX=Array(xa.t.length);this.nMh=new D.Annotations(this.hSa(0),this)}get annotations(){return this.nMh}get BNi(){return this.jy.d}Pbj(){if(!(""in this.jy.m))throw Error.argument("name","Unrecognized module");return this.g7d(this.jy.m[""])}kSa(xa){if(0>
xa||!this.jy.b||xa>=this.jy.b.length)throw Error.argumentOutOfRange("byteArrayID");return this.Hyg[xa]||(this.Hyg[xa]=new jc(this.jy.b[xa]))}nC(xa){if(1>xa||xa>=this.jy.t.length)throw Error.argumentOutOfRange("blobID");if(1!==this.jy.t[xa])throw Error.argument("blobID","Requested blob is not a string");if(null==this.BX[xa]){const Ma=this.hSa(xa).ga(0);this.BX[xa]=this.tAe.nC(Ma)}return this.BX[xa]}p3f(xa){if(1>xa||xa>=this.jy.t.length)throw Error.argumentOutOfRange("blobID");if(2!==this.jy.t[xa])throw Error.argument("blobID",
"Requested blob is not a Regex");if(!this.BX[xa]){var Ma=this.hSa(xa);const $a=this.nC(Ma.ga(0));Ma=1===Ma.ga(1);this.BX[xa]=new RegExp($a,Ma?"i":"")}return this.BX[xa]}sgj(xa){if(1>xa||xa>=this.jy.t.length)throw Error.argumentOutOfRange("blobID");if(3!==this.jy.t[xa])throw Error.argument("blobID","Requested blob is not an SRE");throw Error.notImplemented();}g7d(xa){if(1>xa||xa>=this.jy.t.length)throw Error.argumentOutOfRange("blobID");if(4!==this.jy.t[xa])throw Error.argument("blobID","Requested blob is not an NL module");
return this.BX[xa]||(this.BX[xa]=this.g$j.ecj(this.hSa(xa),this))}QD(xa){if(1>xa||xa>=this.jy.t.length)throw Error.argumentOutOfRange("blobID");if(5!==this.jy.t[xa])throw Error.argument("blobID","Requested blob is not an annotation query");return this.BX[xa]||(this.BX[xa]=new Ya(new ve(this.hSa(xa),this)))}R8a(xa){if(1>xa||xa>=this.jy.t.length)throw Error.argumentOutOfRange("blobID");if(6!==this.jy.t[xa])throw Error.argument("blobID","Requested blob is not an annotation script");return this.BX[xa]||
(this.BX[xa]=new md(new ce(this.hSa(xa),this)))}u8(xa){if(1>xa||xa>=this.jy.t.length)throw Error.argumentOutOfRange("blobID");if(7!==this.jy.t[xa])throw Error.argument("blobID","Requested blob is not a filter");return this.BX[xa]||(this.BX[xa]=this.o6j.u8(this.hSa(xa),this))}cfj(xa){if(1>xa||xa>=this.jy.t.length)throw Error.argumentOutOfRange("blobID");if(10!==this.jy.t[xa])throw Error.argument("blobID","Requested blob is not a raw flat lexicon");return this.BX[xa]||(this.BX[xa]=new Tf(this.hSa(xa),
this))}hSa(xa){const Ma=this.jy.n[xa];xa=(xa<this.jy.t.length-1?this.jy.n[xa+1]:this.jy.n.length)-Ma;if(0>Ma||0>xa||Ma+xa>this.jy.n.length)throw Error.invalidOperation("Resource contains illegal int array range ("+Ma+","+xa+")");const $a=new hb.a;$a.XPc(this.jy.n,Ma,xa);return $a}}Object(k.a)(be,"ObjectFetcher",null,[1107]);class Md{constructor(xa,Ma,$a){if(!xa)throw Error.argumentNull("prediction");if(!Ma)throw Error.argumentNull("fieldNames");if(!$a)throw Error.argumentNull("values");if(Ma.length!==
$a.length)throw Error.argument("values","fieldNames and values do not have same length");this.BXh=xa;this.Ecb=Ma;this.tfb=$a}get prediction(){return this.BXh}get dTf(){return this.Ecb.length}y5d(xa){return 0<=xa&&xa<this.Ecb.length?this.Ecb[xa]:null}eb(xa){return 0<=xa&&xa<this.tfb.length?this.tfb[xa]:null}}Object(k.a)(Md,"PredictionData",null,[]);class de{constructor(xa,Ma){if(!xa)throw Error.argumentNull("predictions");if(!Ma)throw Error.argumentNull("tokenAttributes");this.pak=xa;this.vdk=Ma}T7d(){return this.pak}iXf(){return this.vdk}}
Object(k.a)(de,"PredictionDataWithTokenAttributes",null,[]);class Zc{constructor(xa,Ma){this.prediction=null;this.score=0;this.prediction=xa;this.score=Ma}}Object(k.a)(Zc,"PredictionWithScore",null,[]);class Yf{constructor(xa,Ma){if(!xa)throw Error.argumentNull("predictions");if(!Ma)throw Error.argumentNull("attributes");this.CXh=xa;this.KMh=Ma}T7d(){return this.CXh}iXf(){return this.KMh}}Object(k.a)(Yf,"PredictionsWithTokenAttributes",null,[]);class Vc{constructor(xa,Ma,$a){if(!xa)throw Error.argumentNull("attributeName");
if(!Ma)throw Error.argumentNull("fieldNames");if(!$a)throw Error.argumentNull("values");if(Ma.length!==$a.length)throw Error.argument("values","fieldNames and values do not have same length");this.JMh=xa;this.Ecb=Ma;this.tfb=$a}get attributeName(){return this.JMh}get dTf(){return this.Ecb.length}y5d(xa){return 0<=xa&&xa<this.Ecb.length?this.Ecb[xa]:null}eb(xa){return 0<=xa&&xa<this.tfb.length?this.tfb[xa]:null}}Object(k.a)(Vc,"TokenAttributes",null,[]);var zc=d(13),vf=d(21);class Tg{constructor(xa,
Ma,$a,Eb,ac){this.Auc=0;this.A4e=null;this.Buc=this.fPb=0;this.Tud=this.Mlb=this.Saa=this.gPb=null;this.B4e=0;this.N3a=this.Gy=null;this._state=-1;this.$$ge=this.getEnumerator;this.$$cu=this.get_current;this.$$mn=this.moveNext;this.$$rst=this.reset;this.aK=xa;this.GJh=this.LJh=Ma;this.FJh=this.IJh=$a;this.wuc=this.HJh=Eb;this.xuc=this.JJh=ac}Qud(){this.Buc=0;return this.ePb}ePb(){if(!(this.Buc<this.wuc))return this.zuc;this.gPb=this.GJh.items[this.Buc+this.FJh];this.Saa=new R.a(this.aK.Ia.annotations);
1!==this.wuc&&this.aK.Ia.E8b||this.Saa.nCa(this.gPb);if(0<=this.aK.Ia.ncd){({value:this.Mlb}=this.Saa.Qm(this.aK.Ia.ncd)).returnValue?this.Mlb=this.Mlb.PK():this.Mlb=new mc.a(this.aK.Ia.annotations,D.Annotations.IM);this.Tud=this.xuc.items;this.B4e=this.Tud.length;for(this.Auc=0;this.Auc<this.B4e;++this.Auc)this.A4e=this.Tud[this.Auc],Array.add(this.Mlb.items,this.A4e);this.Saa.lu(this.aK.Ia.ncd,this.Mlb)}else 0<=this.aK.Ia.tXe?this.Saa.lu(this.aK.Ia.tXe,this.xuc.items[0]):0<=this.aK.Ia.kRd?this.Saa.lu(this.aK.Ia.kRd,
!0):this.aK.Ia.tig?this.xuc.items[0].DPc((xa,Ma)=>this.Saa.lu(xa,Ma)):(this.Saa.nCa(this.xuc.items[0]),1!==this.wuc&&this.aK.Ia.E8b||(({value:this.fPb}=this.gPb.Qm(this.aK.Ia.CS)).returnValue&&this.Saa.lu(this.aK.Ia.CS,this.fPb),({value:this.fPb}=this.gPb.Qm(this.aK.Ia.fW)).returnValue&&this.Saa.lu(this.aK.Ia.fW,this.fPb),this.gPb.Qm(this.aK.Ia.FPa).returnValue&&this.Saa.lu(this.aK.Ia.FPa,this.fPb)));this.Gy=this.Saa;this._state=2;return this.Sud}zuc(){this._state=3}Rud(){this.Buc++;return this.ePb}Sud(){return 1<
this.wuc&&this.aK.Ia.E8b?this.zuc:this.Rud}dispose(){}getEnumerator(){return-1===this._state?(this._state=0,this):(new Tg(this.aK,this.LJh,this.IJh,this.HJh,this.JJh)).getEnumerator()}[Symbol.iterator](){return Object(vf.a)(this.getEnumerator())}moveNext(){if(3===this._state)return!1;this._state?this._state=1:(this._state=1,this.N3a=this.Qud());for(;1===this._state;)this.N3a=this.N3a();return 3!==this._state}reset(){throw Error.invalidOperation("Reset() is not supported");}get_current(){return this.Gy}}
Object(k.a)(Tg,"$$sm_Microsoft$NaturalLanguage$Runtime$ScriptSharp$NLModules$FlatLexiconNLModule$CreateNewTokenAndApplyLexicalAnalyses",null,[106,136,137]);class bb{constructor(xa,Ma,$a){this.idc=this.Zxg=0;this.cBb=null;this.DAe=this.Koe=this.QAb=this.Q2c=this.Lpe=0;this.P3c=!1;this.dxe=xa;this.VAe=Ma;this.V$j=$a}Q1f(){null===this.cBb&&({QAh:this.cBb,Eag:this.Lpe,length:this.Q2c,TTi:xa}=this.dxe.Z5f(this.VAe.items[this.idc],this.V$j),this.P3c=xa||this.P3c);if(this.QAb<this.Q2c){var xa=this.cBb.charAt(this.Lpe+
this.QAb);++this.QAb;return{returnValue:!0,ch:xa}}if(this.idc===this.VAe.items.length-1)return{returnValue:!1,ch:"\x00"};++this.idc;this.QAb=0;this.cBb=null;return{returnValue:!0,ch:" "}}xOe(xa,Ma){this.QAb===this.Q2c&&this.cBb&&(this.DAe=Ma,this.Koe=this.idc-this.Zxg+1)}ZXk(xa){if(0>xa||xa>=this.VAe.items.length)throw Error.argumentOutOfRange("iToken");this.idc=this.Zxg=xa;this.cBb=null;this.Koe=this.QAb=this.Q2c=this.Lpe=0;this.DAe=-1;this.P3c=!1}$aj(){return{Oki:this.Koe,EWj:this.DAe,GTi:this.P3c}}}
Object(k.a)(bb,"TriePrefixVisitor",null,[1156]);class Vb{constructor(xa){this.Ia=xa}execute(xa){if(!({value:$a}=xa.Qm(this.Ia.xra)).returnValue)throw Error.argument("Expected input parameter NLMod.Tokens not found");let Ma;({value:Ma}=xa.Qm(this.Ia.MBa)).returnValue||(Ma=null);var $a=this.A1i($a,Ma);xa=D.Annotations.PK(xa);xa.lu(this.Ia.xra,$a);return xa}A1i(xa,Ma){let $a=null;const Eb=this.Ia.flatLexicon.trie,ac=new bb(this,xa,Ma);let tc=null;this.Ia.flatLexicon.mhe()&&(tc=Object(zc.a)(this.Ia.flatLexicon,
this.Ia.flatLexicon.m3i,"getCaseInsensitiveForm"));let aa=0,sa;var Oa;let ib;for(;aa<xa.items.length;){const Gb=xa.items[aa];ac.ZXk(aa);Eb.HIh(ac,tc);({Oki:sa,EWj:Oa,GTi:ib}=ac.$aj());if(0<sa){({jYj:Oa}=this.Ia.flatLexicon.S1i(Oa));for(let Bb of this.UDi(xa,aa,sa,Oa)){1<sa&&this.Ia.E8b&&this.zEi(xa,Ma,aa,Gb,sa,ib,Bb);if(!$a)for($a=new mc.a(this.Ia.annotations,D.Annotations.IM),Oa=0;Oa<aa;++Oa)Array.add($a.items,xa.items[Oa]);Array.add($a.items,Bb)}aa+=sa}else $a&&Array.add($a.items,Gb),++aa}return $a||
xa}zEi(xa,Ma,$a,Eb,ac,tc,aa){if(tc)tc=!0;else if(this.Ia.Zhg){tc=!1;var sa=-1;for(var Oa=0;Oa<ac;Oa++){var ib=xa.items[$a+Oa];let cc;var Gb=void 0;if(!({value:cc}=ib.Qm(this.Ia.CS)).returnValue||!({value:Gb}=ib.Qm(this.Ia.fW)).returnValue)throw Error.invalidOperation("FlatLexiconNLModule: token unexpectedly missing one or more required Span.* annotations");if(0<Oa){if(cc>sa+1){tc=!0;break}if(0>sa||null===Ma||sa>=Ma.length)throw Error.invalidOperation("FlatLexiconNLModule: token with unexpectedly out of range Span.StartIndex/Span.Length annotations");
if(" "!==Ma.charAt(sa)){tc=!0;break}}sa=cc+Gb}}else tc=!1;if(tc){Gb=new Sys.StringBuilder;for(tc=0;tc<ac;++tc)({QAh:sa,Eag:Oa,length:ib}=this.Z5f(xa.items[$a+tc],Ma)),0<tc&&Gb.append(" "),Gb.append(sa.substr(Oa,ib));aa.lu(this.Ia.FPa,Gb.toString())}xa=xa.items[$a+ac-1];let Bb,Cc;({value:Eb}=Eb.Qm(this.Ia.CS)).returnValue&&({value:Bb}=xa.Qm(this.Ia.CS)).returnValue&&({value:Cc}=xa.Qm(this.Ia.fW)).returnValue?(aa.lu(this.Ia.CS,Eb),aa.lu(this.Ia.fW,Bb+Cc-Eb)):(aa.Ujd(this.Ia.CS),aa.Ujd(this.Ia.fW))}UDi(xa,
Ma,$a,Eb){return new Tg(this,xa,Ma,$a,Eb)}Z5f(xa,Ma){let $a,Eb;if(({value:$a}=xa.Qm(this.Ia.FPa)).returnValue)Eb=!0,Ma=0,xa=$a.length;else{Eb=!1;if(null===Ma)throw Error.argument("parentText","Expected parameter NLMod.ParentText not found");$a=Ma;if(!({value:Ma}=xa.Qm(this.Ia.CS)).returnValue)throw Error.argument("Token missing required Span.StartIndex annotation","token");if(!({value:xa}=xa.Qm(this.Ia.fW)).returnValue)throw Error.argument("Token missing required Span.Length annotation","token");
if(0>Ma||0>xa||Ma+xa>$a.length)throw Error.argument("Token start/length values out of range","token");}return{QAh:$a,Eag:Ma,length:xa,TTi:Eb}}}Object(k.a)(Vb,"FlatLexiconNLModule",null,[1136]);class Ub{constructor(xa,Ma){this.kRd=this.ncd=this.tXe=this.FPa=this.fW=this.CS=this.MBa=this.xra=0;this.tig=this.Zhg=this.E8b=!1;this.flatLexicon=null;this.annotations=Ma.annotations;let $a=0;try{this.xra=xa.ga($a),++$a,this.MBa=xa.ga($a),++$a,this.CS=xa.ga($a),++$a,this.fW=xa.ga($a),++$a,this.FPa=xa.ga($a),
++$a,this.tXe=xa.ga($a),++$a,this.ncd=xa.ga($a),++$a,this.kRd=xa.ga($a),++$a,this.E8b=1===xa.ga($a),++$a,this.Zhg=1===xa.ga($a),++$a,this.tig=1===xa.ga($a),++$a,this.flatLexicon=Ma.cfj(xa.ga($a))}catch(Eb){throw Error.argument("initData");}}}Object(k.a)(Ub,"FlatLexiconNLModuleInit",null,[]);class Jc{constructor(){this.D7b=0;this.X1d=null;this.Moc=0}}Object(k.a)(Jc,"FeatureGenStackRec",null,[]);class Mc{constructor(xa){this.l0e=Array(xa);this.JNb=Array(xa);this.BYe=[];this.dyh=[]}}Object(k.a)(Mc,"TokenStringLattice",
null,[]);const ed=(xa,Ma,$a)=>{for(let Eb=0;Eb<xa.length;Eb++)$a=Ma($a,xa[Eb]);return $a},dd=(xa,Ma)=>{const $a=Array(xa.length);for(let Eb=0;Eb<xa.length;Eb++)$a[Eb]=Ma(xa[Eb]);return $a},je=(xa,Ma)=>{Ma=Array(Math.min(Ma,xa.length));for(let $a=0;$a<Ma.length;$a++)Ma[$a]=xa[$a];return Ma},Nd=(xa,Ma)=>{const $a=[];for(const Eb of xa)Ma(Eb)&&Array.add($a,Eb);return $a};class Ld{constructor(xa,Ma){this.key=xa;this.value=Ma}}Object(k.a)(Ld,"KeyValuePair",null,[]);const Xe=(xa,Ma)=>({returnValue:Ma in
xa,value:xa[Ma]}),pe=xa=>{const Ma=[];for(let $a in xa){const Eb=new Ld($a,xa[$a]);Array.add(Ma,Eb)}return Ma};class fe{constructor(xa){this.Y5f=this.mlj;this.Ia=xa;this.s7c=this.Twe=this.Uwe=0;for(const Ma of this.Ia.HOc)this.Uwe=Math.max(this.Uwe,Ma.WJe),this.Twe=Math.max(this.Twe,Ma.sJe),this.s7c=Math.max(this.s7c,Ma.qMb.length)}get eWi(){return this.Ia.asd.trie}execute(xa){if(!xa)throw Error.argumentNull("input");let Ma,$a;({tokens:Ma,hXj:$a}=this.nlj(xa));let Eb=null,ac=null,tc={};if(this.Ia.X8b){Ma=
D.Annotations.PK(Ma);for(var aa=0;aa<Ma.items.length;++aa)Ma.items[aa]=D.Annotations.PK(Ma.items[aa])}else({WSf:ac,returnValue:Eb}=this.o2f(xa,tc));aa=Array(this.s7c);const sa=Array(this.s7c);for(var Oa=0;Oa<sa.length;++Oa)sa[Oa]=new Jc;for(Oa=-this.Uwe;Oa<Ma.items.length+this.Twe;++Oa){let ib=null;this.Ia.X8b&&(ib=Ma.items[Oa],tc={},{WSf:ac,returnValue:Eb}=this.o2f(ib,tc));for(const Gb of this.Ia.HOc){if(0>Oa&&-Oa>Gb.WJe||Oa>=Ma.items.length&&Oa-Ma.items.length+1>Gb.sJe)continue;let Bb=!0;for(let Cc=
0;Cc<Gb.qMb.length;++Cc){const cc=Oa+Gb.qMb[Cc];aa[Cc]=cc;if(0>cc?0>this.Ia.XJe:cc>=Ma.items.length?0>this.Ia.tJe:!$a.JNb[cc]){Bb=!1;break}}Bb&&({AHi:Eb,BHi:ac}=this.CFj(Gb,$a,Eb,ac,tc,sa,aa))}this.Ia.X8b&&(ib.lu(this.Ia.YEa?this.Ia.yrb:this.Ia.wrb,Eb),this.Ia.YEa&&ib.lu(this.Ia.xrb,ac))}xa=D.Annotations.PK(xa);this.Ia.X8b?xa.lu(this.Ia.xra,Ma):(xa.lu(this.Ia.YEa?this.Ia.yrb:this.Ia.wrb,Eb),this.Ia.YEa&&xa.lu(this.Ia.xrb,ac));return xa}nlj(xa){let Ma,$a;if(!xa||!({value:Ma}=xa.Qm(this.Ia.xra)).returnValue)throw Error.argument("Expected input parameter NLMod.Tokens not found");
let Eb;({value:Eb}=xa.Qm(this.Ia.MBa)).returnValue||(Eb="");$a=new Mc(Ma.items.length);const ac=Nd(this.Ia.p0e,tc=>!tc.V7b||tc.V7b.isMatch(xa,null));for(let tc=0;tc<Ma.items.length;++tc){const aa=Ma.items[tc];let sa=null;$a.l0e[tc]=$a.BYe.length;let Oa=$a.JNb[tc]=0;for(const ib of ac)0<ib.Thc&&$a.JNb[tc]+Oa>=ib.Thc||ib.Nsc&&!ib.Nsc.isMatch(aa,null)||({Osc:sa,nZb:Oa}=ib.apply(this,aa,tc,$a,Eb,sa,Oa))}return{tokens:Ma,hXj:$a}}CFj(xa,Ma,$a,Eb,ac,tc,aa){let sa=0;tc[0].D7b=-1;for(tc[0].X1d=xa.qlh;;){var Oa=
aa[sa],ib=0>Oa||Oa>=Ma.JNb.length?1:Ma.JNb[Oa];let Cc=!1;for(;tc[sa].D7b<ib-1;){++tc[sa].D7b;var Gb=void 0,Bb=void 0;0>Oa?(Gb=this.Ia.XJe,Bb=1):Oa>=Ma.l0e.length?(Gb=this.Ia.tJe,Bb=1):(Bb=Ma.l0e[Oa]+tc[sa].D7b,Gb=Ma.BYe[Bb],Bb=Ma.dyh[Bb]);tc[sa].Moc=Bb*(sa?tc[sa-1].Moc:xa.score);if(({value:Gb}=Xe(tc[sa].X1d,Gb.toString())).returnValue){sa===xa.qMb.length-1?(Oa=Gb,tc[sa].Moc&&(({value:ib}=Xe(ac,Oa.toString())).returnValue||(ib=-1),0>ib&&($a=D.Annotations.PK($a),Array.add($a.items,Oa)),this.Ia.YEa&&
(Eb=D.Annotations.PK(Eb),0>ib?Array.add(Eb.items,tc[sa].Moc):Eb.items[ib]+=tc[sa].Moc),0>ib&&(this.Ia.hlg||this.Ia.YEa)&&(ac[Oa.toString()]=$a.items.length-1))):(++sa,tc[sa].D7b=-1,tc[sa].X1d=Gb);Cc=!0;break}}if(!Cc&&(--sa,0>sa))break}return{AHi:$a,BHi:Eb}}o2f(xa,Ma){let $a;if(({value:$a}=xa.Qm(this.Ia.YEa?this.Ia.yrb:this.Ia.wrb)).returnValue)for(let Eb=0;Eb<$a.items.length;++Eb)Ma[$a.items[Eb].toString()]=Eb;else $a=new mc.a(this.Ia.annotations,D.Annotations.Toa);if(this.Ia.YEa){if(({value:Ma}=
xa.Qm(this.Ia.xrb)).returnValue||(Ma=new mc.a(this.Ia.annotations,D.Annotations.Gaa)),Ma.items.length!==$a.items.length)throw Error.argument("Length mismatch between NLMod.FloatingPointFeatureIDs and NLMod.FloatingPointFeatureValues on item "+this.Ia.annotations.L1(D.Annotations.IM,xa));}else Ma=null;return{returnValue:$a,WSf:Ma}}get erl(){return this.Ia.asd}mlj(xa,Ma){var $a;if(({value:$a}=Ma.Qm(this.Ia.FPa)).returnValue)xa=$a;else{if(!({value:$a}=Ma.Qm(this.Ia.CS)).returnValue)throw Error.argument("Token is missing Span.StartIndex");
if(!({value:Ma}=Ma.Qm(this.Ia.fW)).returnValue)throw Error.argument("Token is missing Span.Length");if(0>$a||0>Ma||$a+Ma>xa.length)throw Error.argument("Token indices are out of range");xa=xa.substr($a,Ma)}return xa}}Object(k.a)(fe,"NGramNLModule",null,[1136,1137]);class wd{constructor(xa){this.qMb=null;this.score=this.sJe=this.WJe=0;this.qlh=null;if(xa){var Ma=0;try{if(xa.ga(Ma)!==wd.m6a)throw Error.argument("initData","Input does not represent a feature template");++Ma;const $a=xa.ga(Ma);++Ma;this.qMb=
Array($a);for(let Eb=0;Eb<$a;++Eb)this.qMb[Eb]=xa.ga(Ma),++Ma;this.WJe=xa.ga(Ma);++Ma;this.sJe=xa.ga(Ma);++Ma;this.score=xa.ga(Ma);++Ma;this.qlh=({Bag:Ma}=wd.Meh(xa,Ma)).returnValue}catch($a){throw Error.argument("initData");}}}static Meh(xa,Ma){const $a=xa.ga(Ma);++Ma;const Eb={};for(let ac=0;ac<$a;++ac){const tc=xa.ga(Ma);++Ma;xa.ga(Ma)?Eb[tc.toString()]=({Bag:Ma}=wd.Meh(xa,Ma)).returnValue:(++Ma,Eb[tc.toString()]=xa.ga(Ma),++Ma)}return{returnValue:Eb,Bag:Ma}}}wd.m6a=240803228;Object(k.a)(wd,"FeatureTemplate",
null,[1155]);var Ue=d(539);class rd{constructor(xa,Ma){this.YEa=this.hlg=this.X8b=!1;this.FPa=this.fW=this.CS=this.xra=this.MBa=this.xrb=this.yrb=this.wrb=0;this.asd=null;this.tJe=this.XJe=0;this.HOc=this.p0e=null;if(xa){this.annotations=Ma.annotations;var $a=0;try{this.X8b=1===xa.ga($a);++$a;this.hlg=1===xa.ga($a);++$a;this.YEa=1===xa.ga($a);++$a;this.wrb=xa.ga($a);++$a;this.yrb=xa.ga($a);++$a;this.xrb=xa.ga($a);++$a;this.MBa=xa.ga($a);++$a;this.xra=xa.ga($a);++$a;this.CS=xa.ga($a);++$a;this.fW=
xa.ga($a);++$a;this.FPa=xa.ga($a);++$a;this.asd=this.hyk(Ma.kSa(xa.ga($a)));++$a;this.XJe=xa.ga($a);++$a;this.tJe=xa.ga($a);++$a;const Eb=xa.ga($a);++$a;this.p0e=Array(Eb);for(let tc=0;tc<Eb;++tc){const aa=xa.ga($a);++$a;const sa=this.asd.trie,Oa=new hb.a;Oa.aSa(xa,$a,aa);this.p0e[tc]=this.myk(Oa,Ma,sa);$a+=aa}const ac=xa.ga($a);++$a;this.HOc=Array(ac);for(Ma=0;Ma<ac;++Ma){const tc=xa.ga($a);++$a;const aa=new hb.a;aa.aSa(xa,$a,tc);this.HOc[Ma]=this.Mxk(aa);$a+=tc}}catch(Eb){throw Error.argument("initData");
}}}hyk(xa){return new He.a(new Sg.a(xa))}myk(xa,Ma,$a){return Ue.a.create(xa,Ma,$a)}Mxk(xa){return new wd(xa)}}Object(k.a)(rd,"NGramNLModuleInit",null,[]);class Ud{constructor(xa){this.Ia=xa}execute(xa){if(!xa)throw Error.argumentNull("input");xa=xa.clone();this.Ia.script.execute(xa,null);return xa}}Object(k.a)(Ud,"ScriptNLModule",null,[1136]);class qe{constructor(xa,Ma){xa&&(this.script=Ma.R8a(xa.ga(0)))}}Object(k.a)(qe,"ScriptNLModuleInit",null,[]);const Nf=xa=>{xa=dd(xa,Ma=>Ma*Ma);return Math.sqrt(ed(xa,
(Ma,$a)=>Ma+$a,0))},sf=xa=>ed(xa,(Ma,$a)=>Ma>$a?Ma:$a,xa[0]);class tf{constructor(xa){this.Ia=xa}execute(xa){if(!xa)throw Error.argumentNull("input");var Ma=[],$a=[];this.gui(xa,Ma,$a);this.Tai(Ma,$a);const Eb={};for(let tc=0;tc<Ma.length;++tc){var ac=Ma[tc];const aa=this.Ia.hdg.ga(ac);ac=this.Ia.idg.ga(ac);for(let sa=0;sa<ac;++sa){const Oa=this.Ia.sri.ga(this.Ia.PCf.ga(aa+sa)),ib=this.Ia.QCf.ga(aa+sa);let Gb;({value:Gb}=Xe(Eb,Oa)).returnValue||(Gb=0);Eb[Oa]=Gb+$a[tc]*ib}}$a=pe(Eb);$a.sort((tc,aa)=>
{var sa=tc.value,Oa=aa.value;(sa=-(sa>Oa?1:sa<Oa?-1:0))||(sa=tc.key.localeCompare(aa.key));return sa});Ma=new mc.a(this.Ia.annotations,D.Annotations.IM);for(const tc of je($a,this.Ia.$fk))$a=new R.a(this.Ia.annotations),$a.lu(this.Ia.Hfi,tc.key),$a.lu(this.Ia.Jfi,tc.value),Array.add(Ma.items,$a);xa.lu(this.Ia.Ifi,Ma);return xa}gui(xa,Ma,$a){if(({value:xa}=xa.Qm(this.Ia.Gfi)).returnValue){let Eb;if(({value:Eb}=xa.Qm(this.Ia.yrb)).returnValue){let ac;if(!({value:ac}=xa.Qm(this.Ia.xrb)).returnValue||
Eb.items.length!==ac.items.length)throw Error.argument("NLMod.FloatingPointFeatureIDs and NLMod.FloatingPointFeatureIDValues are mismatched");this.uJc(Eb,ac,Ma,$a)}if(({value:Eb}=xa.Qm(this.Ia.Lfi)).returnValue){let ac;if(!({value:ac}=xa.Qm(this.Ia.Mfi)).returnValue||Eb.items.length!==ac.items.length)throw Error.argument("NLMod.FloatingPointFeatureNames and NLMod.FloatingPointFeatureValues are mismatched");this.uJc(Eb,ac,Ma,$a)}({value:Eb}=xa.Qm(this.Ia.wrb)).returnValue&&this.uJc(Eb,null,Ma,$a);
({value:Eb}=xa.Qm(this.Ia.Kfi)).returnValue&&this.uJc(Eb,null,Ma,$a)}}uJc(xa,Ma,$a,Eb){for(let tc=0;tc<xa.items.length;++tc){var ac=void 0;xa.wU===D.Annotations.ZY?({value:ac}=Xe(this.Ia.kOf,xa.items[tc])).returnValue||(ac=-1):(ac=xa.items[tc],ac=ac>=this.Ia.BCe&&ac<=this.Ia.sgk?this.Ia.RDe?this.Ia.RDe.ga(ac-this.Ia.BCe)-1:ac-this.Ia.BCe:-1);if(0<=ac){let aa;aa=Ma?Ma.items[tc]:1;0<aa&&(Array.add($a,ac),Array.add(Eb,aa))}}}Tai(xa,Ma){if(xa.length){switch(this.Ia.XGk){case 0:break;case 1:for(var $a=
0;$a<Ma.length;++$a)Ma[$a]=1+Math.log(Ma[$a]);break;case 2:$a=sf(Ma);for(let Eb=0;Eb<Ma.length;++Eb)Ma[Eb]=.5+Ma[Eb]/$a*.5;break;case 3:for($a=0;$a<Ma.length;++$a)Ma[$a]=1;break;default:throw Error.notImplemented();}if(this.Ia.bXc)for($a=0;$a<Ma.length;++$a)Ma[$a]*=this.Ia.bXc.ga(xa[$a]);xa=Nf(Ma);for($a=0;$a<Ma.length;++$a)Ma[$a]/=xa}}}Object(k.a)(tf,"TfIdfRankerNLModule",null,[1136]);class Lf{constructor(xa,Ma=0){if(!xa)throw Error.argumentNull("byteArray");this.jJ=Ma;if(604662927!==xa.ku(this.jJ+
0,4))throw Error.argument("byteArray","Input does not represent a compact int array");this.Yk=xa.ku(this.jJ+4,4);this.Gqg=xa.ku(this.jJ+8,4);this.r4j=xa}ga(xa){if(0>xa||xa>=this.count)throw Error.argumentOutOfRange("index");return this.r4j.bMk(8*this.jJ+96+xa*this.Gqg,this.Gqg)}get count(){return this.Yk}}Object(k.a)(Lf,"CompactIntArray",null,[1133]);const kf=(xa,Ma)=>{Ma=Array(Ma);for(let tc=0;tc<Ma.length;tc++){var $a=tc,Eb=xa.vY(),ac=1===(Eb>>31&1)?-1:1;const aa=Eb&8388607;Eb=Eb>>23&255;256===
Eb+1?ac=aa?Number.NaN:1===ac?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:Eb?(Eb-=127,ac=ac*Ed(aa,1)*Math.pow(2,Eb)):ac=ac*Ed(aa,0)*Math.pow(2,-126);Ma[$a]=ac}return Ma},Ed=(xa,Ma)=>{let $a=0;for(let Eb=0;23>Eb;Eb++)$a+=(xa>>22-Eb&1)/Math.pow(2,Eb+1);return Ma+$a};class Cd{constructor(xa,Ma){this.RDe=null;this.d0g=0;this.idg=this.hdg=this.bXc=null;this.c0g=0;this.QCf=this.PCf=null;this.annotations=Ma.annotations;let $a=0;this.Kfi=xa.ga($a);++$a;this.wrb=xa.ga($a);++$a;this.Lfi=xa.ga($a);++$a;
this.Mfi=xa.ga($a);++$a;this.yrb=xa.ga($a);++$a;this.xrb=xa.ga($a);++$a;this.Gfi=xa.ga($a);++$a;this.Ifi=xa.ga($a);++$a;this.Hfi=xa.ga($a);++$a;this.Jfi=xa.ga($a);++$a;var Eb=xa.ga($a);++$a;var ac=Array(Eb);for(var tc=0;tc<Eb;++tc)ac[tc]=Ma.nC(xa.ga($a)),++$a;this.sri=hb.a.VWd(ac);this.$fk=xa.ga($a);++$a;this.XGk=xa.ga($a);++$a;Eb=xa.ga($a);++$a;this.kOf={};for(ac=0;ac<Eb;++ac){tc=Ma.nC(xa.ga($a));++$a;const aa=xa.ga($a);++$a;this.kOf[tc]=aa}this.BCe=xa.ga($a);++$a;this.sgk=xa.ga($a);++$a;Eb=xa.ga($a);
++$a;0<Eb&&(Eb=Ma.kSa(xa.ga($a)),++$a,this.RDe=this.Zfd(new Je(Eb)));++$a;xa=Ma.kSa(xa.ga($a));this.Xxk(xa)}Zfd(xa){return new Lf(xa.EYb,xa.offset)}Xxk(xa){try{const Ma=new Je(xa);this.d0g=Ma.vY();1===Ma.vY()?this.bXc=hb.a.VWd(kf(Ma,this.d0g)):this.bXc=null;const $a=Ma.vY();this.hdg=this.Zfd(Ma);Ma.offset+=$a;const Eb=Ma.vY();this.idg=this.Zfd(Ma);Ma.offset+=Eb;this.c0g=Ma.vY();const ac=Ma.vY();this.PCf=this.Zfd(Ma);Ma.offset+=ac;this.QCf=hb.a.VWd(kf(Ma,this.c0g))}catch(Ma){throw Error.argument("byteReader");
}}}Object(k.a)(Cd,"TfIdfRankerNLModuleInit",null,[]);class oh{constructor(xa,Ma,$a,Eb){this.eIe=xa;this.qUf=$a;this.tokens=Eb;this.U7=Ma;this.FKb=-1;this.Pmd=0}}Object(k.a)(oh,"TokenizerData",null,[]);class Kg{constructor(xa){this.Ia=xa}execute(xa){if(!xa)throw Error.argumentNull("input");if(!({value:Eb}=xa.Qm(this.Ia.MBa)).returnValue)throw Error.argument("input","Expected to see annotation for attribute NLMod.ParentText");let Ma;({value:Ma}=xa.Qm(this.Ia.CS)).returnValue||(Ma=0);let $a;({value:$a}=
xa.Qm(this.Ia.fW)).returnValue||($a=Eb.length-Ma);if(0>Ma||Ma>Eb.length)throw Error.argument("input","Start index out of range");if(0>$a||$a>Eb.length)throw Error.argument("input","Length out of range");if(Ma+$a>Eb.length)throw Error.argument("input","Bad start-length range");var Eb=new oh(Eb,Ma,Ma+$a,new mc.a(this.Ia.annotations,D.Annotations.IM));this.frl(Eb);xa=xa.isReadOnly?xa.clone():xa;xa.lu(this.Ia.xra,Eb.tokens);return xa}frl(xa){for(;xa.U7<xa.qUf;){if(this.Ia.x$d){var Ma=this.Ia.x$d.Zog(xa.eIe,
xa.U7,xa.qUf-xa.U7,null);!Ma.succeeded&&Ma.n_g&&(Ma=Ma.n_g);if(Ma.succeeded){this.j4g(xa,Ma.length,this.Ia.A7f);xa.U7+=Ma.length;continue}}Ma=xa.eIe.substr(xa.U7);let $a=-1,Eb=-1,ac=-1;for(let tc=0;tc<this.Ia.Fld.length;++tc){const aa=this.Ia.Fld[tc].exec(Ma);aa&&0<aa[1].length&&(0>$a||aa[0].length>Eb)&&($a=tc,Eb=aa[0].length,ac=aa[1].length)}0<=$a?(this.j4g(xa,ac,this.Ia.lRe[$a]),xa.U7+=ac):xa.U7+=1}}j4g(xa,Ma,$a){if(this.Ia.Sjg)$a!==Kg.umi&&(0>xa.FKb&&(xa.FKb=xa.U7),xa.Pmd=xa.U7+Ma-xa.FKb,$a===
Kg.tmi&&(0<=xa.FKb&&0<xa.Pmd&&(Ma=new R.a(this.Ia.annotations),Ma.lu(this.Ia.CS,xa.FKb),Ma.lu(this.Ia.fW,xa.Pmd),Ma.lu(this.Ia.wQd,Kg.vmi),Ma.lu(this.Ia.MBa,xa.eIe),Array.add(xa.tokens.items,Ma)),xa.FKb=-1,xa.Pmd=0));else{let Eb=new R.a(this.Ia.annotations);Eb.lu(this.Ia.CS,xa.U7);Eb.lu(this.Ia.fW,Ma);Eb.lu(this.Ia.wQd,$a);Array.add(xa.tokens.items,Eb)}}}Kg.umi="GAP";Kg.tmi="EOS_CHUNK";Kg.vmi="SENTENCE";Object(k.a)(Kg,"TokenizerNLModule",null,[1136]);class ri{constructor(xa,Ma){this.fW=this.CS=this.wQd=
this.xra=this.MBa=0;this.Sjg=!1;this.lRe=this.Fld=this.A7f=this.x$d=null;if(xa){this.annotations=Ma.annotations;var $a=0;try{this.MBa=xa.ga($a);++$a;this.xra=xa.ga($a);++$a;this.wQd=xa.ga($a);++$a;this.CS=xa.ga($a);++$a;this.fW=xa.ga($a);++$a;this.Sjg=1===xa.ga($a);++$a;var Eb=xa.ga($a);++$a;0<Eb&&(this.x$d=Ma.g7d(Eb).eWi);this.A7f=xa.ga($a)?Ma.nC(xa.ga($a)):"";++$a;const ac=xa.ga($a);++$a;this.Fld=Array(ac);this.lRe=Array(ac);for(Eb=0;Eb<ac;++Eb)this.Fld[Eb]=new RegExp(Ma.nC(xa.ga($a))),++$a,this.lRe[Eb]=
Ma.nC(xa.ga($a)),++$a}catch(ac){throw Error.argument("initData");}}}}Object(k.a)(ri,"TokenizerNLModuleInit",null,[]);class Af{constructor(xa){this.Ia=xa}execute(xa){if(!xa)throw Error.argumentNull("input");let Ma;if(!({value:Ma}=xa.Qm(this.Ia.Ewf)).returnValue)throw Error.argument("Expected input parameter NLMod.StringToTransliterate not found");for(const $a of this.Ia.dYe)Ma=$a.apply(Ma);xa=D.Annotations.PK(xa);xa.lu(this.Ia.Fwf,Ma);return xa}static VPd(xa,Ma){const $a=new Sys.StringBuilder;for(let Eb=
0;Eb<xa.length;++Eb)$a.append(Ma(xa.substr(Eb,1)));return $a.toString()}}Object(k.a)(Af,"TransliteratorNLModule",null,[1136]);class Zg{constructor(xa){xa&&(this.style=xa.ga(0))}apply(xa){return Af.VPd(xa,Ma=>Zg.lpi(Ma,this.style))}static lpi(xa,Ma){switch(Ma){case 0:return xa.toLowerCase();case 1:return"I"===xa?"\u0131":xa.toLowerCase();case 2:return xa.toUpperCase();case 3:return"i"===xa?"\u0130":xa.toUpperCase();default:throw Error.invalidOperation();}}}Zg.o6a=0;Object(k.a)(Zg,"ChangeCaseTransliterationStage",
null,[1149]);class gi{apply(xa){return Af.VPd(xa,gi.Xrl)}static Xrl(xa){const Ma=xa.charCodeAt(0);return 65281<=Ma&&65374>=Ma?String.fromCharCode(Ma-65248):xa}}gi.o6a=4;Object(k.a)(gi,"LatinFullWidthToHalfWidthTransliterationStage",null,[1149]);class jg{constructor(xa,Ma){xa&&(this.regex=Ma.p3f(xa.ga(0)),this.oWk=Ma.nC(xa.ga(1)))}apply(xa){return xa.replace(this.regex,this.oWk)}}jg.o6a=1;Object(k.a)(jg,"RegexReplaceTransliterationStage",null,[1149]);class Hh{constructor(xa,Ma){if(xa){var $a=xa.ga(0),
Eb=Ma.nC(xa.ga(1)),ac=new Lf(Ma.kSa(xa.ga(2)));xa=0>xa.ga(3)?null:new Lf(Ma.kSa(xa.ga(3)));this.WYe={};for(Ma=0;Ma<$a;++Ma)this.WYe[Eb.charAt(Ma).toString()]=Eb.substr(ac.ga(Ma),xa?xa.ga(Ma):1)}}apply(xa){return Af.VPd(xa,Ma=>Ma in this.WYe?this.WYe[Ma]:Ma)}}Hh.o6a=2;Object(k.a)(Hh,"SingleCharSubstitutionsTransliterationStage",null,[1149]);class hj{constructor(xa,Ma){this.Fwf=this.Ewf=0;this.dYe=null;if(xa){this.annotations=Ma.annotations;var $a=0;try{this.Ewf=xa.ga($a);++$a;this.Fwf=xa.ga($a);++$a;
const Eb=xa.ga($a);++$a;this.dYe=Array(Eb);for(let ac=0;ac<Eb;++ac){const tc=xa.ga($a);++$a;const aa=xa.ga($a);++$a;const sa=new hb.a;sa.aSa(xa,$a,aa);$a+=aa;this.dYe[ac]=this.gyk(tc,sa,Ma)}}catch(Eb){throw Error.argument("initData");}}}gyk(xa,Ma,$a){switch(xa){case Zg.o6a:return new Zg(Ma);case jg.o6a:return new jg(Ma,$a);case Hh.o6a:return new Hh(Ma,$a);case gi.o6a:return new gi;default:throw Error.invalidOperation("Unrecognized or unsupported transliteration stage flavor");}}}Object(k.a)(hj,"TransliteratorNLModuleInit",
null,[]);class Hk{ecj(xa,Ma){const $a=xa.ga(0),Eb=new hb.a;Eb.aSa(xa,1,xa.count-1);switch($a){case 0:return new Ud(new qe(Eb,Ma));case 2:return new Kg(new ri(Eb,Ma));case 3:return new fe(new rd(Eb,Ma));case 5:return new Vb(new Ub(Eb,Ma));case 9:return new Af(new hj(Eb,Ma));case 10:return new tf(new Cd(Eb,Ma));default:throw Error.notImplemented();}}}Object(k.a)(Hk,"NLModuleFactory",null,[1109]);class yd{constructor(xa){this.pmi=";";if(!xa)throw Error.argumentNull("resource");this.D4=new be(xa,new uc,
new Hk);this.dxe=this.D4.Pbj();this.sqg=this.D4.annotations.l4b("Text.Text");this.qqg=this.D4.annotations.l4b("Classification.Predictions");this.ooe=this.D4.annotations.l4b("Classification.PredictionString");this.rqg=this.D4.annotations.l4b("Classification.Probability");this.a4j=this.D4.annotations.l4b("NLMod.Tokens");if(0>this.sqg||0>this.qqg||0>this.ooe||0>this.rqg)throw Error.argument("resourceObj","Resource does not represent a ranker");}E2i(){const xa=[];this.J0d(void 0,this.LXf(xa),null);return xa}G2i(xa,
Ma){const $a=[],Eb=[];this.J0d(xa,this.LXf($a),(ac,tc)=>{const aa=this.D4.annotations.yXf(ac),sa=[],Oa=[];Ma&&Ma.length&&-1===Array.indexOf(Ma,aa)||(ac=this.D4.annotations.getAttributeType(ac),this.M$g(ac,tc,sa,Oa),tc=new Vc(aa,sa,Oa),Array.add(Eb,tc))});return new Yf($a,Eb)}F2i(xa){const Ma=[];this.J0d(xa,$a=>{let Eb;if(({value:Eb}=$a.Qm(this.ooe)).returnValue){let ac;({value:ac}=$a.Qm(this.rqg)).returnValue&&Array.add(Ma,new Zc(Eb,ac))}},null);return Ma}J0d(xa,Ma,$a){var Eb=new R.a(this.D4.annotations);
Eb.lu(this.sqg,xa);xa=this.dxe.execute(Eb);if(({value:Eb}=xa.Qm(this.qqg)).returnValue)for(const ac of Eb.items)Ma(ac);if($a&&({value:Ma}=xa.Qm(this.a4j)).returnValue)for(const ac of Ma.items)ac.DPc($a)}M$g(xa,Ma,$a,Eb){if(D.Annotations.HB(xa))for(var ac of Ma.items)this.M$g(Ma.wU,ac,$a,Eb);else if(D.Annotations.hEh(xa)){ac=this.D4.annotations.a2f(xa);for(let tc=0;tc<ac;tc++)Array.add($a,this.D4.annotations.a5f(xa,tc)),Array.add(Eb,this.D4.annotations.L1(this.D4.annotations.K9a(xa,tc),Ma.wSa(tc)))}else Array.add($a,
"VALUE"),Array.add(Eb,this.D4.annotations.L1(xa,Ma))}LXf(xa){return Ma=>{let $a;({value:$a}=Ma.Qm(this.ooe)).returnValue&&Array.add(xa,this.sej($a))}}sej(xa){const Ma=xa.indexOf(this.pmi);return 0>Ma?xa:xa.substring(0,Ma)}}Object(k.a)(yd,"Ranker",null,[]);var ef=d(330),yh=d(379),Bg=d(25);class Kd{constructor(xa,Ma){this.eff="";this.AHd=null;this.BHd=!1;this.Vaa=null;this.MMh=["TellMe.TellMeParamCollection"];this.ub=xa;this.AAa=Ma;this.ub.W5a&&(this.Vaa=null)}get did(){if(!this.AHd&&!this.BHd){let xa=
null;try{xa=window.TellMeModel}catch(Ma){if(z.TellMeActor.instance.Hd)z.TellMeActor.instance.Hd.onError("QueryRanker","TellMeModel not found. Exception: "+Ma)}if(xa){try{this.AHd=new yd(xa)}catch(Ma){if(z.TellMeActor.instance.Hd)z.TellMeActor.instance.Hd.onError("QueryRanker","Exception thrown while loading classifier. Exception: "+Ma)}this.BHd=!0}else if(z.TellMeActor.instance.Hd)z.TellMeActor.instance.Hd.onError("QueryRanker","Classifier model not found")}return this.AHd}CF(){return"Command"}EN(){return 0===
this.ub.zq?0:1===this.ub.zq?1:2}vC(xa,Ma,$a=!1,Eb=e.a.tellMe,ac=null){const tc=new w.a(xa);if((!ac||Array.contains(ac,0))&&!A.a.MI(xa)){if(!this.did&&this.BHd){if(z.TellMeActor.instance.Hd)z.TellMeActor.instance.Hd.onError("CRASH","CommandResultsProvider: Found invalid Model data");throw Error.create("CommandResultsProvider: Model data invalid/corrupted");}this.ub.W5a&&this.Vaa&&this.Vaa.initialize();if(ef.CommandResultsUtility.the(xa.Ff)&&(ac=ef.CommandResultsUtility.PYf(xa.Ff),0<ac.results.length)){ac.displayName=
"Classifier Debug";tc.es(ac);Ma.resultsUpdated(tc);return}ac=xa?this.eff=xa.Ff:this.eff;if(Bg.AFrameworkApplication.fa.ka("TellMeParameterizedQueriesEnabled")){ac=this.uej(ac);var aa=this.UQc(ac.T7d());ac=ac.iXf()}else ac=this.tej(ac),aa=this.x4i(ac),ac=[];ef.CommandResultsUtility.b1c(aa,!1,"Classifier","TFIDF");aa=ef.CommandResultsUtility.$Sc(xa,aa,this.ub,this.Vaa,this.AAa,ac,0,1);0<aa.results.length&&Eb!==e.a.contextMenu&&(aa.displayName=CommonUIStrings.l_TellMeCommandProviderTitle);$a||aa.results.length||
this.ub.MEa||this.ub.Eya||(xa=new v.a("lookupNoResults",14,xa.Ff,null,1),aa.fv(xa));0<aa.results.length&&tc.es(aa);tc.attributes=ac}Ma.resultsUpdated(tc)}T7d(){let xa=[];try{xa=this.did.E2i()}catch(Ma){if(z.TellMeActor.instance.Hd)z.TellMeActor.instance.Hd.onError("GetPredictions","Exception: "+Ma)}return xa}tej(xa){let Ma=[];try{Ma=this.did.F2i(xa)}catch($a){if(z.TellMeActor.instance.Hd)z.TellMeActor.instance.Hd.onError("GetPredictionsWithScore","Exception: "+$a)}return Ma}uej(xa){try{return this.did.G2i(xa,
this.MMh)}catch(Ma){if(z.TellMeActor.instance.Hd)z.TellMeActor.instance.Hd.onError("GetPredictionsWithTokenAttributes","Exception: "+Ma)}return new Yf([],[])}UQc(xa){const Ma=[];if(xa)for(const $a of xa)Ma.push(new yh.a($a,-99999));return Ma}x4i(xa){const Ma=[];if(xa)for(const $a of xa)Ma.push(new yh.a($a.prediction,$a.score));return Ma}}Object(k.a)(Kd,"CommandResultsProvider",null,[962]);var Rj=d(968);class Ia{constructor(xa){this.ub=xa}CF(){return"Feedback"}EN(){return 0===this.ub.zq?0:1===this.ub.zq?
1:2}vC(xa,Ma,$a,Eb,ac=null){xa=new w.a(xa);if(!ac||Array.contains(ac,21))ac=[],ac.push(appChrome.actions.setControlLabel("TellMeFeedback",CommonUIStrings.l_TellMeFeedbackText)),appChrome.api.dispatch(ac),ac=new C.a(22),ac.displayName="",ac.fv(new v.a("TellMeFeedback",23,null,null,1)),xa.es(ac);Ma.resultsUpdated(xa)}}Object(k.a)(Ia,"FeedbackResultsProvider",null,[962]);class nb{constructor(xa,Ma,$a,Eb){this.InputText=this.CommandValueId=this.CommandId=this.Label=null;this.Label=xa;this.CommandId=Ma;
this.CommandValueId=$a;this.InputText=Eb}}Object(k.a)(nb,"FindInDocumentProp",null,[]);var Kb=d(45);class dc{constructor(xa){this.HEd=2;this.K3a=[];this.$Na=[];this.ub=xa;dc.yja=xa.FTf;dc.KTf="FindInDocumentSuggestion";dc.V9g="FindInDocumentSuggestion3";this.vUh=Object.assign(new u.a,{landingTab:"Indoc",data:null});this.VZh=this.ub.RLb||!!Bg.AFrameworkApplication.Aa&&Bg.AFrameworkApplication.Aa.hb.RLb}CF(){return"FindInDocument"}EN(){return 0===this.ub.zq?0:1===this.ub.zq?1:3===this.ub.zq?this.ub.Xvh?
2:3:2}vC(xa,Ma,$a=!1,Eb,ac=null){const tc=new w.a(xa);if(ac&&!Array.contains(ac,2))Ma.resultsUpdated(tc);else if(Array.clear(this.K3a),A.a.MI(xa)){if($a&&this.Qth()){$a=new C.a(2);$a.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle;ac=1;Eb="";if(0<this.$Na.length&&!this.ub.SLb)for(var aa of this.$Na)if(""!==aa.Label.toLowerCase()){if(ac>=this.HEd)break;this.OGh($a,aa.Label,aa.CommandValueId,dc.KTf+ac,aa.InputText);ac++}aa="";this.ub.HH?(tc.es($a),$a=new C.a(3),aa=this.ub.CPa?A.a.iSa(CommonUIStrings.l_TellMeOpenFindPaneTextV2Bolded):
CommonUIStrings.l_TellMeOpenFindPaneTextV2):aa=CommonUIStrings.l_TellMeOpenFindPaneText;Eb=this.OYf("");this.OGh($a,aa,Eb,dc.V9g,"");tc.es($a)}Ma.resultsUpdated(tc)}else aa="",$a&&($a=this.OYf(xa.Ff),Eb=[],this.ub.NUa?(this.ub.hWe&&Eb.push(appChrome.actions.setControlIconSet(dc.yja,{"default":"FindInDocument_20"})),aa=this.ub.Hke?A.a.U5d(xa.Ff,CommonUIStrings.l_FindInDocumentScopedButtonText):xa.Ff+CommonUIStrings.l_FindInDocumentScopedButtonText):this.ub.HH?(aa=this.ub.CPa?A.a.iSa(String.format(CommonUIStrings.l_FindInDocumentScopedButtonTextV2Bolded,
xa.Ff)):String.format(CommonUIStrings.l_FindInDocumentScopedButtonTextV2,xa.Ff),Eb.push(appChrome.actions.setControlIconSet(dc.yja,{"default":"FindInDocument_20"}))):aa=this.ub.SLb?CommonUIStrings.l_TellMeOpenFindPaneText:String.format(CommonUIStrings.l_TextWithQuotation,xa.Ff),this.ub.bda?(z.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(dc.yja,aa)),z.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId(dc.yja,$a))):(Eb.push(appChrome.actions.setControlLabel(dc.yja,
aa)),Eb.push(appChrome.actions.setButtonCommandValueId(dc.yja,$a)),appChrome.api.dispatch(Eb)),this.Yph(aa,dc.yja,$a,xa.Ff)),this.ub.Xvh?(aa=new v.a(dc.yja,8,xa.Ff),$a=new C.a(2),$a.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle,$a.fv(aa),tc.es($a),Ma.resultsUpdated(tc)):this.ub.t8i().then(sa=>{const Oa=new v.a(dc.yja,8,xa.Ff,null,1);Oa.count=sa;sa=new C.a(2);sa.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle;sa.fv(Oa);tc.es(sa);Ma.resultsUpdated(tc)},sa=>{z.TellMeActor.instance.Hd.onError("FindInDocumentResultsProvider:issueQuery",
"Find manager promise rejected: "+sa);sa=new v.a(dc.yja,8,xa.Ff,null,1);const Oa=new C.a(2);Oa.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle;Oa.fv(sa);tc.es(Oa);Ma.resultsUpdated(tc)})}Qth(){return!!this.ub&&this.ub.Wod}OGh(xa,Ma,$a,Eb,ac=null){const tc=[];Ma&&tc.push(appChrome.actions.setControlLabel(Eb,Ma));this.ub.HH&&tc.push(appChrome.actions.setControlIconSet(Eb,{"default":"FindInDocument_20"}));tc.push(appChrome.actions.setButtonCommandValueId(Eb,$a));appChrome.api.dispatch(tc);
this.Yph(Ma,Eb,$a,"");xa.fv(new v.a(Eb,8,ac,null,1,-99999))}OYf(xa){return this.VZh?A.a.yCa(xa,15,this.vUh):Kb.a.pe(xa)}Yph(xa,Ma,$a,Eb){this.Qth()&&this.K3a.length<this.HEd&&(xa=new nb(xa,Ma,$a,Eb),Array.add(this.K3a,xa))}q7k(xa){for(let Ma=0;Ma<this.K3a.length;Ma++)if(this.K3a[Ma].CommandId===xa){const $a=this.K3a[Ma].Label;let Eb=!1;if(0<this.$Na.length){let ac=0;for(const tc of this.$Na){if(tc.Label===$a){Array.removeAt(this.$Na,ac);Eb=!0;break}ac++}}!Eb&&this.$Na.length>=this.HEd-1&&Array.removeAt(this.$Na,
1);Array.insert(this.$Na,0,this.K3a[Ma])}}}dc.yja=null;dc.KTf=null;dc.V9g=null;Object(k.a)(dc,"FindInDocumentResultsProvider",null,[962]);var Ic=d(966);class Id{constructor(xa){this.ub=xa}CF(){return"Insights"}EN(){return 0===this.ub.zq?0:1===this.ub.zq?1:2}vC(xa,Ma,$a=!1,Eb,ac=null){Eb=new w.a(xa);if(!ac||Array.contains(ac,13))if(this.Rdl()||!A.a.MI(xa)){ac=new C.a(13);var tc=""===xa.Ff.trim(),aa=tc?"SmartLookupFromTellMeZeroTerm":"SmartLookupFromTellMe",sa=new v.a(aa,10,xa.Ff,null,1);$a&&($a=null,
A.a.R3()?tc?tc=CommonUIStrings.l_SeeMoreOpenSearchPaneLabel:(tc=this.ub.SLb?CommonUIStrings.l_SeeMoreResultsButtonTextNonParameteriedV2:String.format(CommonUIStrings.l_SeeMoreResultsButtonText,xa.Ff),$a=A.a.yCa(xa.Ff,1)):(tc=String.format(CommonUIStrings.l_InsightsButtonText,xa.Ff),$a=A.a.$Wd(xa.Ff)),this.ub.bda?(z.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(aa,tc)),$a&&z.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId("SmartLookupFromTellMe",$a))):
(xa=[],xa.push(appChrome.actions.setControlLabel(aa,tc)),$a&&xa.push(appChrome.actions.setButtonCommandValueId("SmartLookupFromTellMe",$a)),appChrome.api.dispatch(xa)),sa.label=tc);ac.fv(sa);Eb.es(ac)}Ma.resultsUpdated(Eb)}Rdl(){return A.a.R3()&&this.ub.Qol}}Object(k.a)(Id,"InsightsResultsProvider",null,[962]);var ae=d(964);class Od{constructor(xa){this.ub=xa}CF(){return"Learning"}EN(){return 0===this.ub.zq?0:1===this.ub.zq?1:2}vC(xa,Ma,$a,Eb,ac=null){$a=new w.a(xa);ac&&!Array.contains(ac,21)||!A.a.MI(xa)||
(ac=[],Eb=this.ub.YXj,ac.push(appChrome.actions.setButtonCommandValueId("LearningForSearch",Eb)),Eb=Od.T8i(Eb),ac.push(appChrome.actions.setControlLabel("LearningForSearch",Eb)),appChrome.api.dispatch(ac),xa=new v.a("LearningForSearch",22,xa.Ff,null,1),ac=new C.a(21),ac.fv(xa),$a.es(ac));Ma.resultsUpdated($a)}static T8i(xa){const Ma=[];Array.add(Ma,new ae.a(600,CommonUIStrings.l_TellMeLearningButtonTipText));Array.add(Ma,new ae.a(400,CommonUIStrings.l_TellMeLearningButtonText));Array.add(Ma,new ae.a(600,
xa));Array.add(Ma,new ae.a(400,CommonUIStrings.l_TellMeLearningButtonPunctuation));xa={};xa.parts=Ma;return JSON.stringify(xa)}}Object(k.a)(Od,"LearningProvider",null,[962]);var Hd=d(1048);class Bf{constructor(xa,Ma){this.job=this.iqb=this.tOa=this.oAc=null;this.Tv=!1;this.Aob=xa;this.XOh=Ma;xa&&this.YRf(xa)}Csd(){this.Aob.Csd()&&this.YRf(this.Aob)}Rjj(xa){let Ma=[];var $a=[];xa=Bf.Ljk(xa);var Eb="";Array.clear($a);for(let ac=0;ac<xa.length;ac++){const tc=xa.charAt(ac);-1!==" ".indexOf(tc)?(Eb.length&&
Array.add($a,Eb),Eb=""):-1!=="_-,@;.[]{}()$%*&^!\"':?/<>~`+=|\\".indexOf(tc)?(Eb.length&&Array.add($a,Eb),Eb=tc,Array.add($a,Eb),Eb=""):Eb+=tc}Eb.length&&Array.add($a,Eb);for(xa=0;xa<$a.length;xa++)Eb=this.w4i($a[xa]),Eb=this.wzi(Eb),Ma=Bf.Qgk(Ma,Eb);return Ma=this.d6h(Ma)}cje(){this.Tv||this.Csd();return this.Tv}KLc(xa){return this.oAc[xa.toString()]}d6h(xa){for(let Ma=0;Ma<xa.length;Ma++){const $a=this.tOa[Ma];if(xa[Ma].commandId!==this.KLc($a[0]))throw Error.create("Incorrect Tcid orders with Priors data");
let Eb;(Eb=xa[Ma]).score=Eb.score+$a[1]}return xa}wzi(xa){const Ma=[];for(var $a=0;$a<this.tOa.length;$a++)Ma.push(new yh.a(this.KLc(this.tOa[$a][0]),-5));$a=new Hd.a;for(var Eb=0;Eb<xa.length;Eb++)$a.add(this.KLc(xa[Eb][0]));for(Eb=0;Eb<Ma.length;Eb++){const tc=Ma[Eb];for(let aa=0;aa<xa.length;aa++){var ac=xa[aa];const sa=this.KLc(ac[0]);ac=ac[1];if(sa===tc.commandId){tc.score=ac;$a.remove(sa);break}}if(!$a.count)break}return Ma}w4i(xa){const Ma=1>xa.length;for(let aa=0;2>=aa;aa++){const sa=this.job;
for(let Oa in sa){var $a=sa[Oa],Eb=xa,ac=Oa;const ib=ac.length+1,Gb=Array((Eb.length+1)*ib);for(var tc=0;tc<=Eb.length;tc++)Gb[tc*ib]=tc;for(tc=0;tc<=ac.length;tc++)Gb[tc]=tc;for(tc=0;tc<ac.length;tc++)for(let Bb=0;Bb<Eb.length;Bb++)Gb[(Bb+1)*ib+(tc+1)]=Eb.charAt(Bb)===ac.charAt(tc)?Gb[Bb*ib+tc]:Math.min(Math.min(Gb[Bb*ib+(tc+1)]+1,Gb[(Bb+1)*ib+tc]+1),Gb[Bb*ib+tc]+1);Eb=Gb[Eb.length*ib+ac.length];if((!Eb||!Ma)&&Eb<=aa)return $a}}return this.iqb}YRf(xa){this.oAc=xa.f7d();this.tOa=xa.Fej();this.iqb=
xa.Plj();this.job=xa.P$i();if(this.Tv=!!this.oAc&&!!this.tOa&&!!this.job&&!!this.iqb)this.Tv=0<this.tOa.length&&Bf.$ge(this.tOa);this.Tv&&(this.Tv=0<this.iqb.length&&Bf.$ge(this.iqb));this.Tv&&(this.job=Bf.qmj(this.job));this.Tv||(this.job=this.iqb=this.tOa=this.oAc=null)}ulj(xa){xa=this.Rjj(xa);return this.RVi(xa,this.XOh)}RVi(xa,Ma){let $a=[];for(let Eb=0;Eb<xa.length;Eb++)xa[Eb].score>=Ma&&$a.push(xa[Eb]);$a.sort((Eb,ac)=>Eb.score<ac.score?1:Eb.score>ac.score?-1:0);0<$a.length-10&&($a=$a.slice(0,
10));return $a}static Qgk(xa,Ma){if(!xa.length)return Ma;if(xa.length!==Ma.length)throw Error.create("commandSuggestionsMerged and commandSuggestionsToMerge are not of same length");for(let $a=0;$a<xa.length;$a++){if(xa[$a].commandId!==Ma[$a].commandId)throw Error.create("Incorrect CommandId");let Eb;(Eb=xa[$a]).score=Eb.score+Ma[$a].score}return xa}static Ljk(xa){return Kb.a.og(xa)}static $ge(xa){for(let Ma=0;Ma<xa.length;Ma++)if(2!==xa[Ma].length)return!1;return!0}static qmj(xa){const Ma={};for(let ac in xa){var $a=
ac,Eb=xa[ac];const tc=Eb;tc.length&&Bf.$ge(tc)&&(Ma[$a]=Eb)}return Ma}}Object(k.a)(Bf,"NaiveBayesClassifierModel",null,[]);class Of{constructor(xa,Ma){this.Vaa=null;this.ub=xa;this.dUb=new Bf(Ma,xa.M1f);this.ub.W5a&&(this.Vaa=null)}CF(){return"NBCommand"}EN(){return 0===this.ub.zq?0:1===this.ub.zq?1:2}vC(xa,Ma,$a=!1,Eb=e.a.tellMe,ac=null){const tc=new w.a(xa);if((!ac||Array.contains(ac,0))&&!A.a.MI(xa)){if(ef.CommandResultsUtility.the(xa.Ff)&&(ac=ef.CommandResultsUtility.PYf(xa.Ff),0<ac.results.length)){ac.displayName=
"Classifier Debug";tc.es(ac);Ma.resultsUpdated(tc);return}if(!this.dUb.cje()){if(z.TellMeActor.instance.Hd)z.TellMeActor.instance.Hd.onError("CRASH","NaiveBayesCommandProvider: Found invalid Model data");throw Error.create("NaiveBayesCommandProvider: Model data invalid/corrupted");}this.ub.W5a&&this.Vaa&&this.Vaa.initialize();ac=this.dUb.ulj(xa.Ff);ef.CommandResultsUtility.b1c(ac,!1,"Classifier","NaiveBayesian");ac=ef.CommandResultsUtility.$Sc(xa,ac,this.ub,this.Vaa,null,null,0,1);0<ac.results.length&&
Eb!==e.a.contextMenu&&(ac.displayName=CommonUIStrings.l_TellMeCommandProviderTitle);$a||ac.results.length||this.ub.MEa||this.ub.Eya||(xa=new v.a("lookupNoResults",14,xa.Ff,null,1),ac.fv(xa));0<ac.results.length&&tc.es(ac)}Ma.resultsUpdated(tc)}}Object(k.a)(Of,"NaiveBayesCommandProvider",null,[962]);class ph{constructor(){this.H3a=null;this.Tv=!1;this.Csd()}Csd(){this.Tv||(this.H3a=window.NBCRM)&&4===this.H3a.length&&(this.Tv=!0);return this.Tv}Fej(){return this.Tv?this.H3a[1]:null}Plj(){return this.Tv?
this.H3a[2]:null}P$i(){return this.Tv?this.H3a[3][0]:null}f7d(){return this.Tv?this.H3a[0][0]:null}}Object(k.a)(ph,"NaiveBayesModelAdapter",null,[987]);var Qh=d(190);class Lg{constructor(xa){this.ub=xa}CF(){return"OfficeScript"}EN(){return 0===this.ub.zq?0:1===this.ub.zq?1:2}vC(xa,Ma){const $a=new w.a(xa);if(!A.a.MI(xa)){xa=Qh.d(xa.Ff);var Eb=new C.a(26);Eb.displayName=CommonUIStrings.l_TellMeOfficeScriptsTitle;Eb=this.lrf(xa,Lg.Zvl,"OfficeScriptsUnhideAllRowsCols","samples-11",CommonUIStrings.l_TellMeUnhideAllRowsColsTitle,
Eb);Eb=this.lrf(xa,Lg.ZZi,"OfficeScriptsFreezeSelection","samples-12",CommonUIStrings.l_TellMeFreezeSelectionTitle,Eb);$a.es(Eb)}Ma.resultsUpdated($a)}lrf(xa,Ma,$a,Eb,ac,tc){const aa=[];for(const sa of Ma)if(Qh.a(xa,sa)){this.ub.bda?(z.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel($a,ac)),z.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId($a,Eb))):(aa.push(appChrome.actions.setControlLabel($a,ac)),aa.push(appChrome.actions.setButtonCommandValueId($a,
Eb)),appChrome.api.dispatch(aa));tc.fv(new v.a($a,27,null,null,1));break}return tc}}Lg.Zvl="unhide row rows col cols column columns".split(" ");Lg.ZZi=["freeze","selection","pane","panes"];Object(k.a)(Lg,"OfficeScriptsSamplesProvider",null,[962]);var Fg=d(17),dg=d(15),hi=d(447),Mg=d(303),ne=d(446),Bh=d(33),Vh=d(104),ij=d(123);class Ij{constructor(xa){this.bI=null;this.ZR=-1;this.lCe=14;this.mCe=12;this.attributes=this.JLd=this.query=null;this.hzb=!1;this.jpb=[];this.ei=Bg.AFrameworkApplication.Je;
Bg.AFrameworkApplication.fa&&(this.lCe=Bg.AFrameworkApplication.fa.Fc("TellMeMaxTermedResults",this.lCe),this.mCe=Bg.AFrameworkApplication.fa.Fc("TellMeMaxZeroTermResults",this.mCe));this.RL=xa}get Lk(){return this.jpb}get atd(){return this.JLd}es(xa){let Ma=!1;for(let $a=0;$a<this.Lk.length;$a++)if(28!==this.Lk[$a].groupType&&this.Lk[$a].groupType===xa.groupType){this.xNd(this.Lk[$a],xa);Ma=!0;break}Ma||this.Lk.push(xa)}xNd(xa,Ma){for(let $a=0;$a<Ma.results.length;$a++)xa.fv(Ma.results[$a])}jhh(xa){const Ma=
[];for(const $a of this.Lk)$a.groupType!==xa&&Ma.push($a);this.Lk.length!==Ma.length&&(this.jpb=Ma)}lSk(xa){let Ma=null,$a=null,Eb=null;for(let ac=0;ac<xa.length;ac++){const tc=xa[ac];if(tc&&tc.Lk&&tc.Lk.length)for(const aa of tc.Lk)if(17===aa.groupType||18===aa.groupType)Ma=aa;else if(0===aa.groupType||16===aa.groupType)$a=aa,Eb=tc}Ma&&$a&&0<$a.results.length&&(17===Ma.groupType&&({lNd:$a,INd:Ma}=ef.CommandResultsUtility.c5h($a,Ma,this.RL.SG()?this.RL.SG().K3i:-.6)),Eb.jhh($a.groupType))}tjl(){new Fg.a;
this.Xqc(this.RL.aRg)}m$b(xa,Ma){return this.query.Ff.length>this.RL.SG().Xej&&this.MQj(xa,Ma)||this.query.Ff.length>this.RL.SG().Yej&&this.vTj(xa,Ma)?!0:!1}vTj(xa,Ma){return xa&&xa.length&&Ma&&Ma.length?-1===Ma.toLowerCase().indexOf(xa.toLowerCase())?!1:!0:!1}MQj(xa,Ma){return xa&&xa.length&&Ma&&Ma.length?Ma.toLowerCase().startsWith(xa.toLowerCase()):!1}dWi(xa){const Ma=[];for(const $a of this.RL.SG().HH?this.atd:this.Lk)xa.contains($a.groupType)||Ma.push($a);this.RL.SG().HH?this.JLd=Ma:this.jpb=
Ma}Xzl(xa,Ma){const $a=[];for(const Eb of this.Lk){const ac=Eb;if(13!==ac.groupType||24!==ac.groupType){const tc=xa[Mg.a[ac.groupType].toLowerCase()];let aa="False";tc<Ma&&(aa="True");ac.displayName=ac.displayName+" ("+aa+": "+tc+")"}$a.push(ac)}this.jpb=$a}Xqc(xa,Ma=!1,$a=null){if(this.RL.SG().HH){if(!Ma)for(this.JLd=Array(this.Lk.length),Ma=0;Ma<this.Lk.length;Ma++)this.atd[Ma]=this.Lk[Ma];this.RL.WSg.Xqc(this.Lk,this.atd,this.query,xa,$a)}else{for($a=new Fg.a;this.Lk.length;){Ma=this.Lk.pop();
const Eb=Mg.a[Ma.groupType].toLowerCase(),ac=xa[Eb];if(ij.b(ac))throw Error.create("GroupId "+Eb+" missed from group SortingOrder");$a.add(new dg.a(ac,Ma))}$a.Sc((Eb,ac)=>Eb.key<ac.key?-1:1);for(xa=0;xa<$a.count;xa++)Ma=$a.ga(xa).value,this.Lk.push(Ma)}}ujl(){var xa=!1;let Ma=!1,$a=!1;for(let ac=0;ac<this.Lk.length;ac++){var Eb=this.Lk[ac];const tc=Eb.groupType;if(8===tc||15===tc||14===tc){Eb=Eb.results;for(let aa=0;aa<Eb.length;aa++){if(8===tc&&this.m$b(this.query.Ff,Eb[aa].label)){xa=!0;break}if(15===
tc&&this.m$b(this.query.Ff,Eb[aa].label)){Ma=!0;break}if(14===tc){if(this.m$b(this.query.Ff,Eb[aa].label)||this.m$b(this.query.Ff,Eb[aa].description)){$a=!0;break}const sa=Eb[aa].label.split(" ");for(const Oa of sa)if(this.m$b(this.query.Ff,Oa)){$a=!0;break}}}}}xa=this.RL.qgj(xa,Ma,$a);this.Xqc(xa)}Agb(xa,Ma,$a,Eb,ac,tc){if(ac===this.bI){var aa=xa.data.Zd;ac=null;try{ac=Bh.b(aa)}catch(re){z.TellMeActor.instance.Hd.onError("OnSuccessCallBack","Exception occured while deserializing ranker inference response:"+
re);return}if("RankerResults"in ac&&ac.RankerResults){this.Mia();var sa=ac.RankerResults,Oa=new Fg.a,ib=new Fg.a;aa=0;for(var Gb of sa){sa=Gb.ProviderId;var Bb=Gb.Score;aa+=Bb;Oa.add(new dg.a(sa,Bb))}Oa.Sc((Ca,ob)=>Ca.value>ob.value?-1:1);Bb=tc?tc.shj:1E-6;Gb={};sa={};let re=0;for(var Cc=0;Cc<Oa.count;Cc++){let Ca=parseInt(Oa.ga(Cc).key),ob=Oa.ga(Cc).value/aa;1===Ca&&(sa.answer=re++,sa.entity=re++,sa.definition=re++,sa.wolframanswer=re++,ob<Bb&&(ib.add(9),ib.add(11),ib.add(10),ib.add(12)),Gb.answer=
ob,Gb.entity=ob,Gb.definition=ob,Gb.wolframanswer=ob);2===Ca&&(sa.assistance=re++,ob<Bb&&ib.add(8),Gb.assistance=ob);3===Ca&&(sa.classifier=re++,sa.serviceclassifier=re++,ob<Bb&&(ib.add(0),ib.add(17)),Gb.classifier=ob,Gb.serviceclassifier=ob);4===Ca&&(sa.people=re++,ob<Bb&&ib.add(14),Gb.people=ob);5===Ca&&(sa.document=re++,ob<Bb&&ib.add(15),Gb.document=ob);6===Ca&&(sa.findindocument=re++,ob<Bb&&ib.add(2),Gb.findindocument=ob);7===Ca&&(sa.notes=re++,ob<Bb&&ib.add(20),Gb.notes=ob);8===Ca&&(sa.image=
re++,ob<Bb&&ib.add(19),Gb.image=ob)}Oa=new Fg.a;Oa.add("classifier");Oa.add("serviceclassifier");Oa.add("appsforoffice");Oa.add("addin");Oa.add("findindocument");Oa.add("assistance");Oa.add("document");Oa.add("people");Oa.add("answer");Oa.add("wolframanswer");Oa.add("definition");Oa.add("entity");Oa.add("image");Oa.add("template");Oa.add("officescript");for(Cc=0;Cc<Oa.count;Cc++)Oa.ga(Cc)in sa||(sa[Oa.ga(Cc)]=re++);sa.learning=re++;sa.insights=re++;sa.actionai=re++;sa.feedback=re++;tc&&tc.oOj&&this.Xzl(Gb,
Bb);tc&&tc.pOj&&this.dWi(ib);ib={};for(var cc in Gb)ib[cc]=Gb[cc]*aa;this.Xqc(sa,!0,ib)}if(tc.$Zc&&"Intents"in ac&&ac.Intents){cc=ac.Intents;for(var Qd of cc)if(this.ele(Qd)&&"Serplet"===Qd.GroupType&&Qd.ConfidenceScore>Qd.ConfidenceThreshold){cc=!1;ac=0;if(tc.mke){aa=new v.a("",29);for(ib=0;ib<this.Lk.length;ib++)if((Oa=this.Lk[ib].results)&&0<Oa.length){ac=ib;aa=Oa[0];break}2===aa.groupType&&(cc=!0)}aa=new C.a(13);cc&&tc.mke&&(aa=new C.a(13,CommonUIStrings.l_TellMeWebTitle));ib=new v.a("SmartLookupFromTellMeQueryTermAtTop",
10,this.query.Ff,null,0);Oa=[];Gb=null;Gb=A.a.R3()?A.a.yCa(this.query.Ff,1):A.a.$Wd(this.query.Ff);Oa.push(appChrome.actions.setButtonCommandValueId("SmartLookupFromTellMeQueryTermAtTop",Gb));Gb=String.format(CommonUIStrings.l_SeeMoreResultsButtonTextAtTop,this.query.Ff);Oa.push(appChrome.actions.setControlLabel("SmartLookupFromTellMeQueryTermAtTop",Gb));appChrome.api.dispatch(Oa);aa.fv(ib);ib=[];if(cc&&tc.mke)for(ib.push(this.Lk[ac]),ib.push(aa),cc=ac+1;cc<this.Lk.length;cc++)(ac=this.Lk[cc].results)&&
0<ac.length&&ib.push(this.Lk[cc]);else for(ib.push(aa),cc=0;cc<this.Lk.length;cc++)(ac=this.Lk[cc].results)&&0<ac.length&&ib.push(this.Lk[cc]);this.jpb=ib}}if(tc.t$b&&!tc.HH){Qd=cc=-1;for(ac=0;ac<this.Lk.length;ac++)switch(this.Lk[ac].groupType){case 23:cc=ac;break;case 0:case 17:case 2:-1===Qd&&(Qd=ac)}if(-1!==cc){Qd=-1===Qd?0:cc>Qd?Qd+1:Qd;cc=this.Lk[cc];ac=Array(this.Lk.length);aa=0;for(ib=0;ib<ac.length;ib++)ib===Qd?ac[ib]=cc:(23===this.Lk[aa].groupType&&aa++,ac[ib]=this.Lk[aa],aa++);this.jpb=
ac}}Eb.resultsUpdated(this);Eb=z.TellMeActor.instance.Hd;Eb.q5(Ma.length,"RankerInference",xa.data.Te.toString(),Math.round(window.performance.now()-$a),ne.a.yAh,!0,hi.a.Fta);this.hzb&&Eb&&(xa=this.query.tZa,Ma=Eb.Awc,tc.r_c&&xa>Ma&&!tc.HH&&(Eb.fne(this.query.Ff),Eb.kTe(xa)))}}ele(xa){if("GroupType"in xa&&xa.GroupType&&"ConfidenceScore"in xa&&"ConfidenceThreshold"in xa)return!0;z.TellMeActor.instance.Hd.onError("IsValidIntentGroup","Invalid intents found");return!1}ogb(xa,Ma,$a,Eb,ac){Eb===this.bI&&
(this.Mia(),z.TellMeActor.instance.Hd.q5(Ma.length,"RankerInference",xa.data.Te.toString(),Math.round(window.performance.now()-$a),ne.a.yAh,!1,hi.a.Fta));ac.resultsUpdated(this)}Mia(){-1!==this.ZR&&(window.clearTimeout(this.ZR),this.ZR=-1)}vjl(xa){let Ma;Ma=this.RL.SG().HH?z.TellMeActor.instance.Hd.f9d(this.atd,this.query.Ff):z.TellMeActor.instance.Hd.f9d(this.Lk,this.query.Ff);var $a=this.RL.SG().rhj;""!==$a&&($a="_"+$a);let Eb="";this.RL.SG().bje&&(Eb="RankerInference"+$a+",");this.RL.SG().$Zc&&
(Eb+="SerpletClassifier");","===Eb.charAt(Eb.length-1)&&(Eb=Eb.substring(0,Eb.length-1));$a=z.TellMeActor.instance.Hd.B5f(Eb);const ac=this.bI=Vh.a.create().toString();$a["Client-Request-Id"]=ac;const tc=window.performance.now(),aa=this.RL.SG()?this.RL.SG().thj:600;this.Mia();this.ZR=window.setTimeout(()=>{if(ac===this.bI){this.bI="";this.ZR=-1;xa.resultsUpdated(this);const sa={};sa[n.a.provider]="Ranker";sa[n.a.xhb]=this.query.tZa;z.TellMeActor.instance.Hd.wH(r.a.timedOut,aa,sa)}},aa);this.ei.Aj(z.TellMeActor.instance.Hd.C5f(),
2,Ma,$a,!1,0,sa=>{this.Agb(sa,this.query.Ff,tc,xa,ac,this.RL.SG())},sa=>{this.ogb(sa,this.query.Ff,tc,ac,xa)},null,null,!1,4E3,6E3)}Wsl(){var xa=0,Ma=new Fg.a,$a=this.RL.ZQg,Eb=this.RL.$Qg;for(var ac=0;ac<this.Lk.length;ac++){var tc=this.Lk[ac],aa=Mg.a[tc.groupType].toLowerCase(),sa=$a[aa];xa+=tc.results.length;tc.results.length>sa&&(aa=Eb[aa],ij.b(aa)||Ma.add(new dg.a(aa,tc)))}Eb=!this.query||""===this.query.Ff.trim();ac=xa-(Eb?this.mCe:this.lCe);if(!(0>=ac)){Eb=window.performance.now();xa=xa.toString()+
" total,"+ac.toString()+" to remove.";if(0<Ma.count)for(Ma.Sc((Oa,ib)=>Oa.key>ib.key?-1:1),tc=0;tc<Ma.count&&0<ac;tc++){aa=Ma.ga(tc).value;sa=Mg.a[aa.groupType].toLowerCase();let Oa=aa.results.length-$a[sa];Oa>ac&&(Oa=ac);0<Oa&&(aa.SOe(Oa),xa+=sa+": "+Oa.toString()+" results removed.",ac-=Oa)}if(0<ac){xa+=ac.toString()+" results left after trimming.";Ma=new Fg.a;$a=this.RL.dRg;for(tc=0;tc<this.Lk.length;tc++)aa=this.Lk[tc],sa=$a[Mg.a[aa.groupType].toLowerCase()],ij.b(sa)||Ma.add(new dg.a(sa,aa));
Ma.Sc((Oa,ib)=>Oa.key<ib.key?-1:1);for($a=0;0<ac;)tc=Ma.ga($a++).value,ac>=tc.results.length?(Array.remove(this.Lk,tc),xa+=Mg.a[tc.groupType]+": "+tc.results.length.toString()+" results force removed.",ac-=tc.results.length):(tc.SOe(ac),xa+=Mg.a[tc.groupType]+": "+ac.toString()+" results force removed.",ac=0)}z.TellMeActor.instance.Hd&&(Ma={},Ma[n.a.message]=xa,z.TellMeActor.instance.Hd.wH("ShowOptimal",window.performance.now()-Eb,Ma))}}}Object(k.a)(Ij,"CombineResultsUpdatedEventArgs",null,[954]);
var Yj=d(687);class ii{constructor(xa,Ma,$a,Eb=!1,ac=""){this.OGd=this.fId=!1;this.qD=xa;this.q4a=[];this.Kjf=Ma.length;this.ub=z.TellMeActor.instance.SG();this.qzc=Eb;this.f5a=ac;this.Rpb={};for(xa=0;xa<Ma.length;++xa)this.Rpb[xa.toString()]=$a?0:Ma[xa].EN()}I8k(xa,Ma){Ma&&Ma.query&&Ma.query.tZa<z.TellMeActor.instance.Eba||(this.q4a[xa]=Ma,this.OGd?this.fId=!0:(!this.ub||3!==this.ub.zq||3!==this.Rpb[xa.toString()]||this.tMf())&&this.iXc())}fzk(){this.OGd=!0}hwl(){this.OGd=!1;this.fId&&(this.fId=
!1,this.iXc())}tMf(){if(this.q4a.length<this.Kjf)return!1;for(let xa=0;xa<this.Kjf;++xa)if(!this.q4a[xa])return!1;return!0}iXc(){var xa=this.tMf();const Ma=window.performance.now(),$a=new Ij(z.TellMeActor.instance.Haf);$a.lSk(this.q4a);for(var Eb=0;Eb<this.q4a.length;++Eb){var ac=this.q4a[Eb];if(ac&&ac.Lk&&ac.Lk.length&&($a.query=ac.query,ac.attributes&&0<ac.attributes.length&&($a.attributes=ac.attributes),ac&&ac.Lk&&(xa||this.Tqi(Eb,this.q4a))))for(const tc of ac.Lk)$a.es(tc)}$a.Lk&&$a.Lk.length&&
($a.hzb=xa,this.ub&&this.ub.V0e&&$a.Wsl(),Yj.a.hkg()&&(this.ub&&this.ub.PRj&&$a.query.Ff&&0<$a.query.Ff.length?$a.ujl():$a.tjl()),Yj.a.hkg()&&this.ub&&(this.ub.bje||this.ub.$Zc)&&this.qzc&&$a.query.Ff&&0<$a.query.Ff.length&&$a.hzb&&this.f5a!==e.a.contextMenu?(3===this.ub.zq&&xa||this.qD.resultsUpdated($a),$a.vjl(this.qD)):this.qD.resultsUpdated($a),xa=z.TellMeActor.instance.Hd,$a.hzb&&xa&&(Eb=$a.query.tZa,ac=xa.Awc,$a.query.Ff&&0<$a.query.Ff.length&&this.qzc&&this.ub.r_c&&this.f5a!==e.a.contextMenu&&
Eb>ac&&!this.ub.bje&&!this.ub.HH&&(xa.fne($a.query.Ff),xa.kTe(Eb)),xa.wH(r.a.gZk,window.performance.now()-Ma)))}Tqi(xa,Ma){if(!(this.Rpb&&xa.toString()in this.Rpb)||Ma.length<=xa||!Ma[xa])return!1;if(!Ma[xa].Lk.length)return!0;const $a=this.Rpb[xa.toString()];if(0===$a)return!0;const Eb=this.Rpb;for(let tc in Eb){var ac=Eb[tc];const aa=Number.parseInvariant(tc);if(aa!==xa&&ac===$a&&!(Ma.length>aa&&Ma[aa]))return!1}return!0}}Object(k.a)(ii,"ResultsAggregator",null,[]);var Wh=d(998);class Zj{constructor(){this.sNb=
this.tNb=this.rNb=this.logCount=this.logRank=this.invertedRank=0}K4h(xa,Ma){switch(xa){case 1:this.invertedRank=Ma;break;case 3:this.logRank=Ma;break;case 2:this.logCount=Ma;break;case 5:this.rNb=Ma;break;case 4:this.tNb=Ma;break;case 6:this.sNb=Ma}}}Object(k.a)(Zj,"CommandFeatures",null,[]);class Hi{constructor(xa){this.x$e=0;this.I3a=xa;this.$Nh={}}get modelId(){return this.I3a}get featureIntercept(){return this.x$e}get x_b(){return this.$Nh}Q3h(xa,Ma,$a){0===Ma?this.x$e=$a:(this.x_b[xa]||(this.x_b[xa]=
new Zj),this.x_b[xa].K4h(Ma,$a))}}Object(k.a)(Hi,"CoefficientsModel",null,[]);const $i=(xa,Ma)=>Math.pow(10,-Ma/(60*Math.LN10/Math.LN2*xa));class Ai{constructor(xa,Ma){this.Yk=1;this.wxc=new Zj;this.features.logCount=1+Math.log(this.count)/Math.LN2;this.features.invertedRank=xa?1/xa:0;this.features.logRank=2/Math.pow(2,xa);this.features.rNb=$i(10,Ma);this.features.tNb=$i(2,Ma);this.features.sNb=$i(1,Ma)}get count(){return this.Yk}get features(){return this.wxc}KAj(){this.Yk=this.count+1;this.features.logCount=
1+Math.log(this.count)/Math.LN2}Qzl(xa){const Ma=2/Math.pow(2,xa);this.features.invertedRank=Math.max(this.features.invertedRank,xa?1/xa:0);this.features.logRank=Math.max(this.features.logRank,Ma)}ZAl(xa){const Ma=$i(10,xa),$a=$i(2,xa);xa=$i(1,xa);this.features.rNb=Math.max(this.features.rNb,Ma);this.features.tNb=Math.max(this.features.tNb,$a);this.features.sNb=Math.max(this.features.sNb,xa)}}Object(k.a)(Ai,"CommandModel",null,[]);class si{constructor(xa){this.hQb=null;if(!xa&&z.TellMeActor.instance.Hd)z.TellMeActor.instance.Hd.onError("PredictionEngine",
"IModelAdapter can't be null");this.Aob=xa;this.nAc=this.Ame()}Ame(){const xa=this.Aob.Jbj(),Ma=this.Aob.f7d();if(void 0===xa||null===xa||void 0===Ma||null===Ma)return!1;try{window.performance.now();this.hQb={};for(let $a=0;$a<xa.length;$a++){const Eb=xa[$a],ac=Ma[Eb[0].toString()].trim(),tc=Eb[1],aa=0!==tc?Ma[Eb[2].toString()].trim():"",sa=Eb[3];ac in this.hQb||(this.hQb[ac]=new Hi(ac));this.hQb[ac].Q3h(aa,tc,sa)}}catch($a){if(z.TellMeActor.instance.Hd)z.TellMeActor.instance.Hd.onError("LoadModelData",
"Error Loading Suggestions Model: "+$a);return!1}return!0}t0i(){const xa=this.Aob.n$i(),Ma={};if(!xa)return Ma;let $a=1;for(let Eb=0;Eb<xa.length;Eb++){const ac=xa[Eb];ac.Id in Ma?(Ma[ac.Id].KAj(),Ma[ac.Id].Qzl($a),Ma[ac.Id].ZAl(ac.TimeElapsedSinceClick)):Ma[ac.Id]=new Ai($a,ac.TimeElapsedSinceClick);$a++}return Ma}cje(){this.nAc||(this.nAc=this.Ame());return this.nAc}qej(){let xa=[];if(!this.nAc){if(z.TellMeActor.instance.Hd)z.TellMeActor.instance.Hd.onError("GetPredictedCommands","IModelAdapter returned no data");
return xa}const Ma=this.t0i(),$a=this.hQb;for(let ac in $a){const tc=$a[ac],aa=tc.modelId;let sa=0;for(let Oa in Ma){var Eb=Oa;const ib=Ma[Oa].features;(Eb=Eb in tc.x_b?tc.x_b[Eb]:null)&&(sa+=ib.invertedRank*Eb.invertedRank+ib.logRank*Eb.logRank+ib.logCount*Eb.logCount+ib.rNb*Eb.rNb+ib.tNb*Eb.tNb+ib.sNb*Eb.sNb)}sa+=tc.featureIntercept;xa.push(new yh.a(aa,sa))}xa.sort((ac,tc)=>ac.score<tc.score?1:ac.score>tc.score?-1:0);0<xa.length-10&&(xa=xa.slice(0,10));return xa}}Object(k.a)(si,"PredictionEngine",
null,[]);class Ni{constructor(){this.Plf={"Multiselect,Paragraph,SelectionRange":"LineSpacing WordCountSplitButton Find RemoveSpaceAfterParagraph ParagraphOptions SpacingAfter".split(" "),"Paragraph,SelectionRange":"Find LineSpacing WordCountSplitButton Strikethrough Superscript Subscript".split(" "),"Paragraph,SelectionRange,Image":"CropPictureMenu PrintDocument Find EditPictureAltText FormatPictureOptions MarginsCustom".split(" "),"Paragraph,SelectionRange,SpellingError":"LineSpacing WordCountSplitButton Spelling Find SetProofingLanguage Strikethrough".split(" "),
"Multiselect,Paragraph,SelectionRange,SpellingError":"LineSpacing WordCountSplitButton SetProofingLanguage Find RemoveSpaceAfterParagraph ParagraphOptions".split(" "),"Multiselect,Paragraph,SelectionRange,WhiteSpaceAtCursor":"LineSpacing WordCountSplitButton RemoveSpaceAfterParagraph Find WordCount ParagraphOptions".split(" "),"Paragraph,SelectionRange,Table":"Find Strikethrough CellShading Superscript Subscript OpenInClientWithIcon".split(" "),"Multiselect,Paragraph,SelectionRange,Table":"CellShading MergeCells Strikethrough Find LineSpacing NoBorder".split(" "),
"Paragraph,SelectionRange,List":"Find Strikethrough Superscript InsertLink Subscript Highlighter".split(" "),"Paragraph,SelectionRange,WhiteSpaceAtCursor":"WordCountSplitButton LineSpacing WordCount ApplyStyle Find Strikethrough".split(" "),"Multiselect,EmptyParagraph,SelectionRange":"LineSpacing WordCountSplitButton Find SetProofingLanguage ParagraphOptions RemoveSpaceAfterParagraph".split(" "),"Multiselect,Paragraph,SelectionRange,List":"LineSpacing Strikethrough WordCountSplitButton Find DistributeColumns SpacingAfter".split(" "),
"EmptyParagraph,SelectionRange":"Find InsertHeaderFooter LineSpacing BorderGallery_MLR InsertPageNumber LineSpacing".split(" "),"Multiselect,EmptyParagraph,SelectionRange,Table":"MergeCells CellShading DeleteRow BorderGallery_MLR NoBorder Find".split(" "),"EmptyParagraph,SelectionRange,Table":"MergeCells CellShading NoBorder Find BorderGallery_MLR DeleteRow".split(" "),"Multiselect,Paragraph,SelectionRange,SpellingError,WhiteSpaceAtCursor":"LineSpacing WordCountSplitButton SetProofingLanguage Find RemoveSpaceAfterParagraph ParagraphOptions".split(" "),
"Paragraph,SelectionRange,SpellingError,WhiteSpaceAtCursor":"WordCountSplitButton LineSpacing SetProofingLanguage WordCount Find IndentHanging".split(" "),"Paragraph,SelectionRange,SpellingError,Table":"Find Strikethrough SetProofingLanguage Spelling ChangeCaseUpper WordCountSplitButton".split(" "),"Paragraph,SelectionRange,Hyperlink":"IndentHanging Find InsertLink LineSpacing Strikethrough BorderGallery_MLR".split(" "),"Paragraph,SelectionRange,SpellingError,List":"Strikethrough Spelling Find WordCountSplitButton SetProofingLanguage Subscript".split(" "),
"Multiselect,Paragraph,SelectionRange,SpellingError,Table":"SetProofingLanguage LineSpacing Find CellShading MergeCells Strikethrough".split(" "),"Multiselect,Paragraph,SelectionRange,Hyperlink":"LineSpacing IndentHanging Find ParagraphOptions WordCountSplitButton RemoveSpaceAfterParagraph".split(" "),"Multiselect,Paragraph,SelectionRange,WhiteSpaceAtCursor,Table":"CellShading MergeCells LineSpacing Strikethrough Find NoBorder".split(" "),"Multiselect,Paragraph,SelectionRange,SpellingError,List":"LineSpacing SetProofingLanguage Strikethrough WordCountSplitButton Find ParagraphOptions".split(" ")}}UQc(xa,
Ma){return Ma&&"word"===Ma.application.toLowerCase()&&xa in this.Plf?this.Plf[xa]:[]}}Object(k.a)(Ni,"SuggestionResultsUtility",null,[]);class ak{constructor(xa,Ma,$a){this.ub=Ma;this.dUb=new si(xa);this.kS=$a;this.jnf=new Ni}CF(){return"Suggestion"}EN(){return 0===this.ub.zq?0:1===this.ub.zq?1:2}vC(xa,Ma,$a,Eb=e.a.tellMe,ac=null){$a=new w.a(xa);z.TellMeActor.instance.Stc=!1;if((!ac||Array.contains(ac,16))&&A.a.MI(xa)){if(!this.dUb.cje()){if(z.TellMeActor.instance.Hd)z.TellMeActor.instance.Hd.onError("CRASH",
"SuggestionResultsProvider: Found invalid Model data");throw Error.create("SuggestionResultsProvider: Model data invalid/corrupted");}Date.now();if(this.hke()&&0<this.jnf.UQc(z.TellMeActor.instance.yLc,this.ub).length){const aa=this.jnf.UQc(z.TellMeActor.instance.yLc,this.ub);ac=[];for(var tc of aa)this.ub.Wod&&"Find"===tc||ac.push(new yh.a(tc,0));z.TellMeActor.instance.Stc=!0}else ac=this.dUb.qej();ef.CommandResultsUtility.b1c(ac,!0,"Recommended","LRE");tc=[];for(const aa of ac)this.kS&&this.kS.jVd(aa.commandId)||
tc.push(aa);xa=ef.CommandResultsUtility.$Sc(xa,tc,this.ub,null,null,null,16,1);0<xa.results.length&&Eb!==e.a.contextMenu&&(xa.displayName=CommonUIStrings.l_TellMeTryCommandTitle);0<xa.results.length&&$a.es(xa)}Ma.resultsUpdated($a)}hke(){return!!this.ub&&(this.ub.hke||this.ub.bWj)}}Object(k.a)(ak,"SuggestionResultsProvider",null,[962]);class Sj{n$i(){return z.TellMeActor.instance.Hxd}Jbj(){return window.TellMeSuggestionModel}f7d(){return window.CoefficientModelIdMap}}Object(k.a)(Sj,"SuggestionsModelAdapter",
null,[986]);var ti=d(1031),Ii=d(967);d.d(Z,"AggregatorResultsProvider",function(){return bg});class bg{constructor(xa=!1){this.Xob={};this.Xob[e.a.tellMe]=[];this.Xob[e.a.contextMenu]=[];this.qzc=xa}Clg(xa,Ma,$a,Eb,ac=null){let tc;var aa=!1;switch(Eb){case e.a.contextMenu:tc=this.Xob[e.a.contextMenu];aa=!0;break;default:tc=this.Xob[e.a.tellMe]}Ma=new ii(Ma,tc,aa,this.qzc,Eb);Ma.fzk();for(let sa=0;sa<tc.length;++sa){const Oa=window.performance.now(),ib=new I(Ma,sa);(aa=z.TellMeActor.instance.SG())&&
aa.aii?window.setTimeout(()=>{tc[sa].vC(xa,ib,$a,Eb,ac);if(z.TellMeActor.instance.Hd){const Gb={};Gb[n.a.provider]=tc[sa].CF();Gb[n.a.xhb]=xa.tZa;z.TellMeActor.instance.Hd.wH(r.a.vC,window.performance.now()-Oa,Gb)}},0):(tc[sa].vC(xa,ib,$a,Eb,ac),z.TellMeActor.instance.Hd&&(aa={},aa[n.a.provider]=tc[sa].CF(),aa[n.a.xhb]=xa.tZa,z.TellMeActor.instance.Hd.wH(r.a.vC,window.performance.now()-Oa,aa)))}Ma.hwl()}CF(){return"Aggregator"}EN(){return 0}vC(xa,Ma,$a=!1,Eb=e.a.tellMe,ac=null){if(z.TellMeActor.instance.Nhk)this.Clg(xa,
Ma,$a,Eb,ac);else{const tc=window.performance.now();z.TellMeActor.instance.lEl.then(()=>{z.TellMeActor.instance.Hd&&z.TellMeActor.instance.Hd.wH(r.a.Ohk,window.performance.now()-tc);this.Clg(xa,Ma,$a,Eb,ac);return!0})}}FA(xa,Ma){this.Xob[Ma].push(xa)}y5h(xa){switch(xa){case "FindParameterized":case "FindInDocumentSuggestion1":case "FindInDocumentSuggestion2":const Ma=this.Xob[e.a.tellMe];for(const $a of Ma)if("FindInDocument"===$a.CF()){$a.q7k(xa);break}}}static createInstance(xa,Ma,$a,Eb){var ac=
Eb&&A.a.IVe(Ma),tc=ac&&Ma.rHe;const aa=Ma.Uke&&!A.a.Rab(),sa=Ma.lje,Oa=new bg(ac);if(Ma.Sdl){var ib=new Od(Ma);Oa.FA(ib,e.a.tellMe)}ib=Ma.Lo?Bg.AFrameworkApplication.fa.ka("TellMeIsSuggestionsForSimplifiedUxEnabled"):Bg.AFrameworkApplication.fa.ka("TellMeSuggestionsIsEnabled");const Gb=!ib&&Bg.AFrameworkApplication.fa.ka("TellMeFirstRunExperienceIsEnabled");Oa.FA(new Rj.a(xa,Ma.Jul,Gb,!1),e.a.tellMe);ib&&Oa.FA(new ak(new Sj,Ma,xa),e.a.tellMe);xa=Bg.AFrameworkApplication.Aa.hb.Kkg?new Of(Ma,new ph):
new Kd(Ma,$a);Oa.FA(xa,e.a.contextMenu);(ac&&Ma.sHe||tc)&&Oa.FA(ti.a.iJf(Ma,!0),e.a.tellMe);Oa.FA(xa,e.a.tellMe);!Ma.CWi||"Word"===Ma.application&&Ma.GTf||Oa.FA(new dc(Ma),e.a.tellMe);Ma.W5a&&(tc=new J(Ma),Oa.FA(tc,e.a.tellMe),Oa.FA(tc,e.a.contextMenu));!Ma.vrb||Ma.jqc||Ma.iqc||Oa.FA(new T.a(Ma),e.a.tellMe);Eb&&(Ma.MEa||A.a.R3())&&(tc=new Id(Ma),Oa.FA(tc,e.a.tellMe),Oa.FA(tc,e.a.contextMenu));ac&&Oa.FA(ti.a.iJf(Ma,!1),e.a.tellMe);Eb&&!Ma.YYe&&A.a.HVe(Ma)&&(Oa.FA(new Wh.a(Ma),e.a.tellMe),Ma.pml&&Oa.FA(new Wh.a(Ma),
e.a.contextMenu));aa&&Oa.FA(new Ia(Ma),e.a.tellMe);(Ma.WLb||Ma.HH)&&Oa.FA(new Ic.a(Ma),e.a.tellMe);Ma.t$b&&Oa.FA(new Ii.a(Ma),e.a.tellMe);Ma.tXc&&(ac=new E(Ma),Oa.FA(ac,e.a.tellMe),Oa.FA(ac,e.a.contextMenu));Eb&&Ma.vXc&&Oa.FA(new H.AddinResultsProvider(Ma),e.a.tellMe);sa&&"Excel"===Ma.application&&Oa.FA(new Lg(Ma),e.a.tellMe);return Oa}}Object(k.a)(bg,"AggregatorResultsProvider",null,[962])},998:function(K,Z,d){K=d(0);var k=d(142),e=d(665),n=d(378),r=d(261),v=d(447);class C{constructor(ka,ha){this.DimensionValue=
this.DimensionName=null;this.DimensionName=ka;this.DimensionValue=ha}}Object(K.a)(C,"Dimension",null,[]);class w{constructor(ka,ha,F,na,ba){this.Query=this.EntityType=null;this.Size=this.From=0;this.Filter=null;this.EntityType=ka;this.Query=ha;this.From=F;this.Size=na;ba&&(this.Filter=ba)}}Object(K.a)(w,"EntityRequest",null,[]);class z{constructor(ka){this.QueryString=null;this.QueryString=ka}}Object(K.a)(z,"Query",null,[]);var A=d(154);class u{constructor(ka,ha){this.Dimensions=this.Name=null;this.Name=
ka;this.Dimensions=ha}}Object(K.a)(u,"Scenario",null,[]);var E=d(169),H=d(168);class I{constructor(ka,ha,F,na){this.Scenario=this.Cvid=this.TimeZone=this.EntityRequests=null;this.EntityRequests=ka;this.TimeZone=ha;this.Cvid=F;this.Scenario=na}}Object(K.a)(I,"SubstrateBody",null,[]);var J=d(446),T=d(115),D=d(101),R=d(25),Q=d(927),W=d(926),O=d(329),Y=d(33),S=d(45),da=d(104);d.d(Z,"a",function(){return fa});class fa{constructor(ka){this.rUb=this.EOa=this.zAc=this.GRb=this.QUb=0;this.rhf=this.Yif=this.bI=
null;this.t3a=0;this.ZR=-1;this.qWb="";this.ei=R.AFrameworkApplication.Je;this.ub=ka;this.pDc=this.g9d();this.WId=new e.a;this.qgf=this.ub.V0e?3:2;this.Dnf=this.ub.V0e&&this.ub.mvh?5:3;this.jpf=this.ub.Wod?2:3;this.kpf=1;this.bAc=this.ub.c2f;this.Jmf=this.ub.mTj;this.sVb=ka.E4f;R.AFrameworkApplication.fa&&(this.Yif=R.AFrameworkApplication.fa.Ha("AppCatalogUrl")+R.AFrameworkApplication.fa.Ha("SearchPersonaPhotoBaseUrl"))}CF(){return"Substrate"}EN(){return 0===this.ub.zq?0:1===this.ub.zq?1:3}vC(ka,
ha,F,na=k.a.tellMe,ba=null){const Ea=new H.a(ka);if(!ba||Array.contains(ba,14)||Array.contains(ba,15)||Array.contains(ba,20))if(!this.t3a||window.performance.now()-this.t3a>=D.a.$rd)if(F=this.WId.f5f())this.t3a=window.performance.now(),F.then(La=>{La&&""!==La?(this.qWb=La,""!==this.bI&&this.e5f(ka,na,this.qWb,ha,ba)):(T.TellMeActor.instance.Hd.onError("SubstrateResultsProvider:IssueQuery","Empty or null token returned"),ha.resultsUpdated(Ea))},La=>{T.TellMeActor.instance.Hd.onError("SubstrateResultsProvider:IssueQuery",
"SubstrateTokenPromise rejected "+La);ha.resultsUpdated(Ea)});else{if(T.TellMeActor.instance.Hd)T.TellMeActor.instance.Hd.onError("SubstrateResultsProvider:IssueQuery","undefined token promise");ha.resultsUpdated(Ea)}else this.qWb&&""!==this.qWb?this.e5f(ka,na,this.qWb,ha,ba):(ha.resultsUpdated(Ea),T.TellMeActor.instance.Hd.onError("SubstrateResultsProvider:IssueQuery","Not able to acquire token"));else ha.resultsUpdated(Ea)}H5(){this.EOa=this.rUb=this.zAc=this.GRb=this.QUb=0}e5f(ka,ha,F,na,ba){this.H5();
const Ea=new H.a(ka),La=this.bI=da.a.create().toString();this.Mia();this.ZR=window.setTimeout(()=>{if(La===this.bI){this.bI="";this.ZR=-1;na.resultsUpdated(Ea);const wa={};wa[n.a.provider]=this.CF();wa[n.a.xhb]=ka.tZa;T.TellMeActor.instance.Hd.wH(r.a.timedOut,this.sVb,wa)}},this.sVb);const ta={"Content-Type":"application/json",Accept:"application/json"};ta.Authorization="Bearer "+F;ta["X-Office-Version"]=R.AFrameworkApplication.buildVersion;ta["X-Office-Application"]=R.AFrameworkApplication.fa.Ha("Application");
ta["X-Office-Platform"]="WAC";ta["X-TellMe-SessionId"]=T.TellMeActor.instance.ITc();ta["X-TellMe-Culture"]=R.AFrameworkApplication.uiCulture;ta["X-TellMe-ProcessSessionId"]=R.AFrameworkApplication.userSessionId;ta["Client-Request-Id"]=La;const oa=window.performance.now();this.ei.Aj(this.Ejj(),2,this.Fjj(ka.Ff,this.ub.application,T.TellMeActor.instance.ITc(),D.a.MI(ka)),ta,!1,0,wa=>{this.Agb(wa,ka,na,La,oa,ha,ba)},wa=>{this.ogb(wa,ka,na,La,oa)},null,null,!1,4E3,6E3)}Mia(){-1!==this.ZR&&(window.clearTimeout(this.ZR),
this.ZR=-1)}Agb(ka,ha,F,na,ba,Ea,La){T.TellMeActor.instance.Hd.q5(ha.Ff.length,this.pDc.join(","),ka.data.Te.toString(),Math.round(window.performance.now()-ba),J.a.substrate,!0,v.a.Fta);const ta=D.a.MI(ha),oa=new H.a(ha);if(na===this.bI){this.Mia();ka=Y.b(ka.data.Zd);if(ka.Groups){ka=ka.Groups;for(const wa of ka)"People"===wa.Type&&this.ub.bsc&&(La?Array.contains(La,14):1)?(ka=this.G2f(wa.Suggestions,ta,Ea),0<ka.results.length&&oa.es(ka)):"File"===wa.Type&&this.ub.asc&&(La?Array.contains(La,15):1)?
(ka=this.t_f(wa.Suggestions,ta,Ea),0<ka.results.length&&oa.es(ka)):"Notes"===wa.Type&&this.ub.OUa&&Ea!==k.a.contextMenu&&(La?Array.contains(La,20):1)&&(ka=this.$1f(wa.Suggestions,ta,ha),0<ka.results.length&&oa.es(ka))}F.resultsUpdated(oa);T.TellMeActor.instance.Hd.q5(ha.Ff.length,this.pDc.join(","),"",Math.round(window.performance.now()-ba),"",!0,v.a.provider)}else F.resultsUpdated(oa)}$1f(ka,ha,F){const na=new E.a(20);na.displayName=CommonUIStrings.l_TellMeNotesProviderTitle;for(const ba of ka)this.sVj(ba)&&
(ka=ba.NotesType,ka=S.a.og(ka),ka=this.Kcj(ka,ba.LastModifiedTime,ba.BodyPreview,ba.Subject,ha,F,ba))&&(ka.groupType=20,na.fv(ka));return na}G2f(ka,ha,F){const na=new E.a(14);na.displayName=CommonUIStrings.l_TellMePeopleProviderTitle;for(const Ea of ka)if(this.tVj(Ea)){var ba=Ea.Id.split("@")[0];ka=Ea.EmailAddresses[0];let La=Ea.Type;if(void 0===La||null===La)La="User";if(ba=this.Udj(La,Ea.DisplayName,Ea.JobTitle,ka,ba,F,ha))ba.description=ka,ka=Ea.JobTitle,"Department"in Ea&&"CompanyName"in Ea&&
(ka+="@"+Ea.Department+"@"+Ea.CompanyName),ba.HOd=ka,na.fv(ba)}return na}t_f(ka,ha,F){const na=new E.a(15);na.displayName=CommonUIStrings.l_TellMeFileProviderTitle;for(const La of ka)if(this.jVj(La)){var ba=La.FileName;ka=La.FileExtension;const ta=ba.length>ka.length?ba.substr(0,ba.length-ka.length-1):La.Title;var Ea=void 0;ka=0;"DateCreated"in La?(ka=D.a.G9d(La.DateCreated),Ea=D.a.S5f(La.DateCreated),Ea=String.format(CommonUIStrings.l_CreatedTimeFormatString,La.Author,Ea)):Ea=La.Author;const oa=
La.AccessUrl+"?web=1",wa=S.a.v7b(oa);ba=String.format('<a href="{0}">{1}</a>',wa,S.a.FTa(ba));if(F!==k.a.contextMenu||S.a.V8(oa))if(ba=this.n8i(ta,F===k.a.contextMenu?ba:oa,Ea,La.FileExtension,La.Text,ha))ba.description=La.Author,ba.lGc=ka,na.fv(ba)}return na}ogb(ka,ha,F,na,ba){na===this.bI&&(this.Mia(),T.TellMeActor.instance.Hd.q5(ha.Ff.length,this.pDc.join(","),ka.data.Te.toString(),Math.round(window.performance.now()-ba),J.a.substrate,!1,v.a.Fta));ka=new H.a(ha);F.resultsUpdated(ka)}Udj(ka,ha,
F,na,ba,Ea,La){La=La?this.kpf:this.qgf;if(!window.LPC&&!D.a.Mhe()||this.QUb===La)return null;this.QUb+=1;La="PeopleSuggestion"+this.QUb.toString();var ta=this.Yif+"?size=1&accountName="+na;ka=Object.assign(new Q.a,{PersonaType:ka,Smtp:na,ProfilePictureUrl:ta,AadObjectId:ba});const oa=Object.assign(new W.a,{identifiers:ka,displayName:ha});ka=Ea===k.a.contextMenu;this.ub.bda?(T.TellMeActor.instance.actions.push(appChrome.actions.setPersonaButtonCoauthor(La,oa,ha,F)),Ea===k.a.contextMenu&&(F=D.a.SIf(ha,
na,ba),T.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId(La,F))),T.TellMeActor.instance.actions.push(appChrome.actions.updatePersonaButtonLPCEnabledDisabledState(La,ka))):(ta=[],ta.push(appChrome.actions.setPersonaButtonCoauthor(La,oa,ha,F)),Ea===k.a.contextMenu&&(F=D.a.SIf(ha,na,ba),ta.push(appChrome.actions.setButtonCommandValueId(La,F))),ta.push(appChrome.actions.updatePersonaButtonLPCEnabledDisabledState(La,ka)),appChrome.api.dispatch(ta));return new A.a(La,11,ha,na,
0)}Kcj(ka,ha,F,na,ba,Ea,La){if(ba&&!this.ub.Okg||this.zAc===this.bAc||this.rUb===this.bAc||this.EOa===this.bAc)return null;var ta=null;this.zAc+=1;ba="";const oa=[],wa={};La.type="Notes";this.rhf=Object.assign(new O.a,{landingTab:"Notes",data:La});Ea=D.a.yCa(Ea.Ff,33,this.rhf);if("onenotepagepreviews"===ka){if(!("ClickthroughUrl"in La&&La.ClickthroughUrl)||""===La.ClickthroughUrl)return null;this.rUb+=1;ba="OnenoteNotesSuggestion"+this.rUb.toString();wa["default"]="SaveAsonetoc2_20";ta=La.ClickthroughUrl;
oa.push(appChrome.actions.setControlIconSet(ba,wa));oa.push(appChrome.actions.setCompoundButtonCommandValueId(ba,ta));ta=new A.a(ba,19,null,null,0)}else if("stickynote"===ka){if(!this.Jmf)return null;this.EOa+=1;ba="NotesSuggestion"+this.EOa.toString();wa["default"]="ShowAllNotes_20";oa.push(appChrome.actions.setControlIconSet(ba,wa));oa.push(appChrome.actions.setCompoundButtonCommandValueId(ba,Ea));ta=new A.a(ba,21,null,null,0)}else if("samsung"===ka){if(!this.Jmf)return null;this.EOa+=1;ba="NotesSuggestion"+
this.EOa.toString();wa["default"]="CategoryCollapsed_20";oa.push(appChrome.actions.setControlIconSet(ba,wa));oa.push(appChrome.actions.setCompoundButtonCommandValueId(ba,Ea));ta=new A.a(ba,20,null,null,0)}""!==ba&&(ka=D.a.S5f(ha),ka=String.format(CommonUIStrings.l_LastModifiedString,ka),ta.label=na,ta.lGc=D.a.G9d(ha),oa.push(appChrome.actions.setControlLabel(ba,na)),oa.push(appChrome.actions.updateCompoundButtonDescription(ba,ka)),oa.push(appChrome.actions.setControlCustomTooltip(ba,F)),appChrome.api.dispatch(oa));
return ta}n8i(ka,ha,F,na,ba,Ea){if(this.GRb===(Ea?this.jpf:this.Dnf))return null;this.GRb+=1;Ea="FileSuggestion"+this.GRb.toString();const La=[],ta={};ta["default"]=D.a.M9i(na);this.ub.bda?(T.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(Ea,ka)),T.TellMeActor.instance.actions.push(appChrome.actions.setControlIconSet(Ea,ta)),T.TellMeActor.instance.actions.push(appChrome.actions.updateCompoundButtonDescription(Ea,F)),T.TellMeActor.instance.actions.push(appChrome.actions.setCompoundButtonCommandValueId(Ea,
ha)),T.TellMeActor.instance.actions.push(appChrome.actions.setControlCustomTooltip(Ea,ba))):(La.push(appChrome.actions.setControlLabel(Ea,ka)),La.push(appChrome.actions.setControlIconSet(Ea,ta)),La.push(appChrome.actions.updateCompoundButtonDescription(Ea,F)),La.push(appChrome.actions.setCompoundButtonCommandValueId(Ea,ha)),La.push(appChrome.actions.setControlCustomTooltip(Ea,ba)),appChrome.api.dispatch(La));return new A.a(Ea,6,ka,F,0)}g9d(){const ka=[];this.ub.bsc&&Array.add(ka,"People");this.ub.asc&&
Array.add(ka,"File");this.ub.OUa&&Array.add(ka,"Notes");return ka}Fjj(ka,ha,F,na){var ba=new z(ka);ka=new w("File",ba,0,na?this.jpf:this.Dnf,null);na=new w("People",ba,0,na?this.kpf:this.qgf,D.a.pzk);ba=new w("Notes",ba,0,this.bAc,null);ha=new C("app",ha.toLowerCase());var Ea=[];Array.add(Ea,ha);ha=new u("tellmesearch",Ea);Ea=[];this.ub.asc&&Array.add(Ea,ka);this.ub.bsc&&Array.add(Ea,na);this.ub.OUa&&Array.add(Ea,ba);F=new I(Ea,"UTC",F,ha);return Y.c(F)}Ejj(){let ka=this.ub.qml;this.ub.OUa&&(ka+=
"?&setflight=NotesFrom3S");""!==this.ub.g5f&&(ka=ka+"&"+this.ub.g5f);return ka}tVj(ka){return"DisplayName"in ka&&"Id"in ka&&"EmailAddresses"in ka&&!!ka.Id&&!!ka.EmailAddresses}jVj(ka){return"FileExtension"in ka&&!!ka.FileExtension&&"FileName"in ka&&!!ka.FileName&&""!==ka.FileName&&"AccessUrl"in ka&&!!ka.AccessUrl&&""!==ka.AccessUrl}sVj(ka){return"Id"in ka&&!!ka.Id&&"NotesType"in ka&&!!ka.NotesType&&"Subject"in ka&&!!ka.Subject&&""!==ka.Subject}}Object(K.a)(fa,"SubstrateResultsProvider",null,[962])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/18430998/wdjs/ppteditDS.chronos1.js.map