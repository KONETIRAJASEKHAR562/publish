'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[9],{1225:function(K,Z,d){d.r(Z);var k=d(0),e=d(17),n=d(382),r=d(271);class v{constructor(){this.uNh=new e.a}get YHc(){return this.uNh}Wcj(L){n.ULS.sendTraceTag(17306645,220,50,"Context menu id: {0}",L);const ca=new e.a;for(let X of this.YHc)for(let qb of X.Tic)qb.id===L&&ca.add(qb);return ca}Xii(){var L=this.Wcj("ContextMenuText");if(L&&0<L.count){const ca=Object.assign(new r.a,{ControlList:[]});for(let X of L)L=
X.Hsc(),0<L.length&&Array.addRange(ca.ControlList,L);return ca}return null}iqf(L){this.YHc.add(L)}CRk(L){for(let ca of this.YHc)if(ca.Gtf===L.Gtf){this.YHc.remove(ca);break}}static BLi(L,ca,X=null){L=v.Y4i(L);0<L.length&&(v.tnd(L,!1),X&&X(ca,L))}static Y4i(L){const ca=[];if(L&&L.Tic&&0<L.Tic.count)for(let X of L.Tic)if(X.controls&&0<X.controls.count)for(let qb of X.controls)if(qb.menuItems&&0<qb.menuItems.count)for(let Rb of qb.menuItems)Array.add(ca,Rb.id);return ca}static tnd(L,ca){if(L.length){var X=
[];for(const qb of L)X.push(appChrome.actions.updateControlEnabledDisabledState(qb,ca));appChrome.api.dispatch(X)}}}Object(k.a)(v,"ContextMenuExtensibilityCache",null,[1088,1089]);var C=d(25),w=d(368),z=d(106),A=d(68),u=d(13);class E{constructor(L,ca,X){this._id=L;this.WLh=ca;this.bOh=X;this.Jdg=OfficeExt.CommandInvokeMode.Default}get id(){return this._id}get AOd(){return this.WLh}get wui(){return this.bOh}execute(L,ca,X){X=X||{};X.commandMode=this.Jdg;ca.invokeAppCommand(this.AOd,this.wui,X,(qb,
Rb)=>{L.h4g(this.id,this.AOd,qb,Rb)})}}Object(k.a)(E,"AddinNativeActionBase",null,[890]);class H extends E{constructor(L,ca){super(1,L,ca);this.Jdg=OfficeExt.CommandInvokeMode.ExclusiveForNew}}Object(k.a)(H,"AddinTakeSnapshotAction",E,[]);class I{cHf(L,ca){let X=null;switch(L){case 1:X=new H(ca,this.Q3d().getNativeActionName(L));break;case 2:X=new E(2,ca,this.Q3d().getNativeActionName(L));break;case 3:X=new E(3,ca,this.Q3d().getNativeActionName(L))}return X}Q3d(){return OfficeExt.AddinNativeActionRuntimeManager.getInstance()}}
Object(k.a)(I,"AddinNativeActionManager",null,[832]);class J{invokeAppCommand(L,ca,X,qb){OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(L,ca,X,qb)}static getInstance(){J.Ka||(J.Ka=new J);return J.Ka}}J.Ka=null;Object(k.a)(J,"OSFAddinCommandsRuntimeManager",null,[833]);var T=d(76);class D{constructor(){this.mOf=this.displayName=this.a0b=this.NJ=this.mM=null;this.isUpgraded=!1}Ejg(L,ca){return this.mM.getStoreType().toLowerCase()===L.toLowerCase()&&this.mM.getSolutionId().toLowerCase()===ca.toLowerCase()}}
Object(k.a)(D,"AddinCommandsResourceItem",null,[]);class R{constructor(){this.Lvd=null;this.IAd=0;this.gCd=!1;this.Oa=new T.a;this.wSh=new e.a}H7h(L){this.Oa.addHandler("AddinCommandsLoadingMessageChanged",L)}get ZXb(){return this.Lvd}BLb(L){L!==this.Lvd&&(this.Lvd=L,this.Oa.raiseEvent("AddinCommandsLoadingMessageChanged"))}G4k(){this.IAd++;this.ZXb||this.BLb(CommonUIStrings.l_LoadingAddInsTitle)}qTe(){this.IAd--;this.V0c()&&(this.gCd?this.ZXb!==CommonUIStrings.l_ErrorLoadingAddInsTitle&&this.BLb(CommonUIStrings.l_ErrorLoadingAddInsTitle):
this.BLb(null))}X5k(){this.gCd=!0;this.BLb(CommonUIStrings.l_ErrorLoadingAddInsTitle)}RCf(){this.gCd=!1;this.V0c()?this.BLb(null):this.BLb(CommonUIStrings.l_LoadingAddInsTitle)}V0c(){return 0>=this.IAd}get ayb(){return this.wSh}s8a(L,ca,X=0){for(let qb of this.ayb)if(qb.Ejg(L,ca)&&(!qb.NJ||qb.NJ.T0i===X))return qb;return null}Wqf(L,ca,X,qb){const Rb=new D;Rb.mM=L;Rb.NJ=ca;Rb.a0b=X;Rb.displayName=qb;this.ayb.add(Rb)}G5h(L,ca,X,qb){const Rb=new D;Rb.mM=L;Rb.NJ=ca;Rb.a0b=null;Rb.mOf=X;Rb.displayName=
qb;this.ayb.add(Rb)}kRk(L,ca){let X=0;for(let qb of this.ayb)qb.mM.getStoreType()===L&&qb.mM.getSolutionId()===ca?this.ayb.removeAt(X):X++}static getInstance(){R.Ka||(R.Ka=new R);return R.Ka}}R.Ka=null;Object(k.a)(R,"AddinCommandsResourceManager",null,[]);var Q=d(217),W=d(534),O=d(170),Y=d(141);class S extends Sys.EventArgs{constructor(){super();this.NJ=this.Au=null}}Object(k.a)(S,"InsertionParamEventArgs",Sys.EventArgs,[]);class da{constructor(L,ca,X,qb,Rb,Qc){this.mx=L;this.Au=ca;this.haa=X;this.displayName=
Rb;this.jmg=Qc}}Object(k.a)(da,"PostLaunchAddinCommandsParameters",null,[]);var fa=d(33),ka=d(45),ha=d(1186);class F{constructor(L,ca,X,qb=null){this.soc=C.AFrameworkApplication.fa.Ha("RoamingServiceHandlerWebServiceBase");this.appName=L;this.cSb=ca;this.$Rb=X;this.VUb=qb}jOc(L){this.ySi(L,Object(u.a)(this,this.XDa,"getRequestSuccessCallback"),Object(u.a)(this,this.Tja,"getRequestFailureCallback"))}ySi(L,ca,X){const qb=new Sys.StringBuilder(this.soc);qb.append("RoamingServiceHandler.ashx?action=");
qb.append("getAddinTeachingCalloutSettings");qb.append("&");qb.append(this.V7d(L));qb.append("&");qb.append(C.AFrameworkApplication.jh);C.AFrameworkApplication.Je.Aj(qb.toString(),1,null,null,!0,2,ca,X,null)}Jub(L){this.FSi(L)}FSi(L){var ca=new Sys.StringBuilder(this.soc);ca.append("RoamingServiceHandler.ashx?action=");ca.append("saveAddinTeachingCalloutSettings");ca.append("&");ca.append(C.AFrameworkApplication.jh);ca=ca.toString();L=fa.c(L);C.AFrameworkApplication.Je.Aj(ca,2,L,null,!0,4,null,Object(u.a)(this,
this.W$,"postRequestFailureCallback"),null)}XDa(L){let ca=!1,X=null;try{if(0<L.data.Zd.length){const qb=Object(ha.a)(Object,fa.a(L.data.Zd)),Rb=qb?qb[this.appName]:null;Rb&&(X=Object(ha.a)(Object,fa.a(Rb.toString())))}ca=!0}catch(qb){this.Tja(null)}ca&&this.cSb&&this.cSb(X)}Tja(L){this.$Rb&&this.$Rb(L?L.data:null)}W$(L){this.VUb&&this.VUb(L?L.data:null)}V7d(L){const ca=new Sys.StringBuilder("requestedsettings=");for(let X=0;X<L.count;X++)ca.append(L.ga(X)),X<L.count-1&&ca.append(";");return ca.toString()}}
Object(k.a)(F,"AddinTeachingUIRoamingRequestHandler",null,[]);var na=d(192);class ba{constructor(L,ca,X){this.roc=!1;this.Waa=null;this.Oa=L;this.FSb=ca;this.xPb=X}hNd(){window.addEventListener?(window.addEventListener("LaunchAddinTaskpane",Object(u.a)(this,this.kGe,"onLaunchButtonClickedEventHandler"),!0),window.addEventListener("DismissCallout",Object(u.a)(this,this.BFe,"onDismissButtonClickedEventHandler"),!0),window.addEventListener("CloseCallout",Object(u.a)(this,this.nFe,"onCloseButtonClickedEventHandler"),
!0),window.addEventListener("FGWebSurfaceEvent",Object(u.a)(this,this.ajc,"onCampaignLaunchedHandler"),!0)):n.ULS.sendTraceTag(525112601,220,15,"AddEventListenerForTeachingCallout failed to get Window")}kGe(){const L={["AppTeachingUICalloutAction"]:"ClickOnLaunch",["SDX.Id"]:ba.qQ(this.FSb),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};this.xPb&&this.xPb.tabs&&!this.xPb.tabs[0].isOfficeTab&&(L["SDX.FeatureFlags"]="NonOfficeTab");Y.a.sendTelemetryEvent(Object.assign(new na.a,
{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:O.a.ND(L)}));this.yIa();this.xPb?appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(this.xPb,()=>{const ca=new S;ca.Au=this.FSb;this.Oa.raiseEvent(Q.a.Yle,ca)}):n.ULS.sendTraceTag(525112602,220,10,"onLaunchButtonClickedEventHandler failed to get a valid addinObj")}nFe(){const L={["AppTeachingUICalloutAction"]:"ClickOnClose",["SDX.Id"]:ba.qQ(this.FSb),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};
Y.a.sendTelemetryEvent(Object.assign(new na.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:O.a.ND(L)}));this.yIa()}BFe(){const L={["AppTeachingUICalloutAction"]:"ClickOnDismiss",["SDX.Id"]:ba.qQ(this.FSb),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};Y.a.sendTelemetryEvent(Object.assign(new na.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:O.a.ND(L)}));this.yIa()}ajc(L){if(L&&(L=L.detail)&&L.id&&this.lhe(L.id)){const X=
(L.action||"").toLowerCase();if(L.success&&"opened"===X){var ca={["AppTeachingUICalloutAction"]:"CampaignLaunched",["SDX.Id"]:ba.qQ(this.FSb),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};Y.a.sendTelemetryEvent(Object.assign(new na.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:O.a.ND(ca)}));n.ULS.sendTraceTag(523355483,220,50,"CD addin UI has been launched. Attempting to save roaming.");this.yIa();window.removeEventListener&&window.removeEventListener("FGWebSurfaceEvent",
Object(u.a)(this,this.ajc,"onCampaignLaunchedHandler"),!0)}else try{ca=JSON.stringify(L),n.ULS.sendTraceTag(523321995,220,15,"Campaign launch failure. Event:"+ca)}catch(qb){ca="id : "+L.id+" telemetryEventName: "+L.telemetryEventName,n.ULS.sendTraceTag(523321996,220,50,"Error serializing campaign event. "+ca+" Error: "+(qb?qb.toString():""))}}}lhe(L){L=ka.a.og(L);return-1!==L.indexOf("d7f1cbbb-3631-4cae-bc2d-177774aa1190")||-1!==L.indexOf("7f5167e4-54e6-4353-a9d7-686741f379b7")||-1!==L.indexOf("cbb7eaa0-6e95-422d-9647-2be7d2737d4a")||
-1!==L.indexOf("f210940e-28e4-4d7c-90dd-0093db1f7df3")||-1!==L.indexOf("d30cc3b5-1c10-414f-9390-b59949be99f8")||-1!==L.indexOf("912b80fb-c00f-4c89-ab73-2e14c3511993")}k_a(L){const ca=C.AFrameworkApplication.fa.Ha("WebAppShortName");if(ca){const X={},qb={};qb.LastTeachingUIShowTime=(new Date).toUTCString();qb.AddinHasShown=L;X[ca]=fa.c(qb);this.Waa=new F(ca,null,null,Object(u.a)(this,this.W$,"postRequestFailureCallback")),this.Waa.Jub(X),n.ULS.sendTraceTag(523535564,220,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service")}else n.ULS.sendTraceTag(523535565,
220,10,"Fail to save roaming service since AppName is null")}yIa(){if(!this.roc){const L=window.g_roamingAddinList;L&&(this.k_a(L),this.roc=!0)}}W$(L){n.ULS.sendTraceTag(523535566,220,10,"failed to POST data to Roaming Settings Service with status: {0}",L?L.Te:-1)}static qQ(L){return Telemetry.PrivacyRules.GetPrivacyCompliantId(L.solutionId,L.storeType,L.assetId,null,null,L.storeId)}}Object(k.a)(ba,"PrivateCatalogTeachingCalloutHandler",null,[]);var Ea=d(14),La=d(15),ta=d(979);class oa{constructor(){this.addinId=
null;this.targetType=0;this.solutionId=null}}Object(k.a)(oa,"AddinAbstract",null,[]);class wa extends Sys.EventArgs{constructor(L){super();this.solutionId=L.solutionId;this.assetId=L.assetId;this.storeType=L.storeType;this.storeId=L.storeId;this.assetStoreId=L.assetStoreId;this.targetType=L.targetType;this.width=L.width;this.height=L.height;this.displayName=L.displayName;this.version=L.version}}Object(k.a)(wa,"ShowTeachingCalloutForContentAddinEventArgs",Sys.EventArgs,[]);var ra=d(123);class ya{constructor(L){this.Nqb=
this.Au=null;this.roc=!1;this.LMa=this.Xuc=this.NJa=this.vl=this.Waa=this.d1=null;this.Ip=L}get appName(){return C.AFrameworkApplication.fa.Ha("WebAppShortName")}get itf(){this.Waa||(this.Waa=new F(this.appName,Object(u.a)(this,this.XDa,"getRequestSuccessCallback"),Object(u.a)(this,this.Tja,"getRequestFailureCallback"),Object(u.a)(this,this.W$,"postRequestFailureCallback")));return this.Waa}get sPa(){this.Xuc||(this.Xuc=new e.a);return this.Xuc}set sPa(L){this.Xuc=L}get X6a(){this.LMa||(this.LMa=
new e.a);return this.LMa}set X6a(L){this.LMa=L}hNd(L,ca){window.addEventListener?(this.Au=L,this.Nqb=ca,window.addEventListener("LaunchAddinTaskpane",Object(u.a)(this,this.kGe,"onLaunchButtonClickedEventHandler"),!0),window.addEventListener("DismissCallout",Object(u.a)(this,this.BFe,"onDismissButtonClickedEventHandler"),!0),window.addEventListener("CloseCallout",Object(u.a)(this,this.nFe,"onCloseButtonClickedEventHandler"),!0),window.addEventListener("FGWebSurfaceEvent",Object(u.a)(this,this.ajc,
"onCampaignLaunchedHandler"),!0)):n.ULS.sendTraceTag(525112601,220,15,"AddEventListenerForTeachingCallout failed to get Window")}Psl(L,ca,X,qb){this.vl=L;this.sPa=ca;this.X6a=X;this.NJa=qb;n.ULS.sendTraceTag(0,220,50,"Calls into TriggerTeachingCallout with addin entitlements: command addins: {0}, content addins: {1}",ca?ca.count.toString():"null",X?X.count.toString():"null");0<this.sPa.count||0<this.X6a.count?(L=new e.a,L.add(this.appName),this.itf.jOc(L)):this.NJa(new e.a,null)}kGe(){const L=new Ea.ScriptSharpLegacyMap;
this.Nqb&&this.Nqb.tabs&&!this.Nqb.tabs[0].isOfficeTab&&L.$("SDX.FeatureFlags","NonOfficeTab");this.MFa(ya.qQ(this.Au),"ClickOnLaunch",L);this.yIa();this.Nqb?appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(this.Nqb,()=>{const ca=new S;ca.Au=this.Au;this.Ip.raiseEvent(Q.a.Yle,ca)}):n.ULS.sendTraceTag(525112602,220,10,"onLaunchButtonClickedEventHandler failed to get a valid addinObj")}nFe(){this.MFa(ya.qQ(this.Au),"ClickOnClose");this.yIa()}BFe(){this.MFa(ya.qQ(this.Au),"ClickOnDismiss");this.yIa()}ajc(L){if(L&&
(L=L.detail)&&L.id&&this.lhe(L.id)){const ca=(L.action||"").toLowerCase();if(L.success&&"opened"===ca)this.MFa(ya.qQ(this.Au),"CampaignLaunched"),n.ULS.sendTraceTag(523355483,220,50,"CD addin UI has been launched. Attempting to save roaming."),this.yIa(),window.removeEventListener&&window.removeEventListener("FGWebSurfaceEvent",Object(u.a)(this,this.ajc,"onCampaignLaunchedHandler"),!0);else{let X;try{X=JSON.stringify(L),n.ULS.sendTraceTag(523321995,220,15,"Campaign launch failure. Event:"+X)}catch(qb){X=
"id : "+L.id+" telemetryEventName: "+L.telemetryEventName,n.ULS.sendTraceTag(523321996,220,50,"Error serializing campaign event. "+X+" Error: "+(qb?qb.toString():""))}}}}lhe(L){L=ka.a.og(L);return-1!==L.indexOf("d7f1cbbb-3631-4cae-bc2d-177774aa1190")||-1!==L.indexOf("7f5167e4-54e6-4353-a9d7-686741f379b7")||-1!==L.indexOf("cbb7eaa0-6e95-422d-9647-2be7d2737d4a")||-1!==L.indexOf("f210940e-28e4-4d7c-90dd-0093db1f7df3")||-1!==L.indexOf("d30cc3b5-1c10-414f-9390-b59949be99f8")||-1!==L.indexOf("912b80fb-c00f-4c89-ab73-2e14c3511993")}k_a(L){if(this.appName){const ca=
{},X={};X.LastTeachingUIShowTime=(new Date).toUTCString();X.AddinHasShown=L;ca[this.appName]=fa.c(X);this.itf.Jub(ca);n.ULS.sendTraceTag(539530527,220,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service")}else n.ULS.sendTraceTag(539530528,220,10,"Fail to save roaming service since AppName is null")}yIa(){if(!this.roc){const L=window.g_roamingAddinList;L&&(this.k_a(L),this.roc=!0)}}XDa(L){L?this.aWe(L)?(n.ULS.sendTraceTag(527523845,220,50,"should show teaching UI"),
this.d1="AddinHasShown"in L&&L.AddinHasShown?L.AddinHasShown.toString():null,this.O_b()):(n.ULS.sendTraceTag(538248466,220,50,"Not Show TeachingUI this time"),this.NJa(this.sPa,null)):(n.ULS.sendTraceTag(527523844,220,50,"userSettings is null"),this.d1=null,this.O_b())}Tja(L){n.ULS.sendTraceTag(539530529,220,10,"GET data from Roaming Settings Service with status: {0}, fallback",L?L.Te:-1);this.NJa(this.sPa,null)}W$(L){n.ULS.sendTraceTag(539530530,220,10,"failed to POST data to Roaming Settings Service with status: {0}",
L?L.Te:-1)}O_b(){const L=this.$Yd();0===L.targetType?(L.solutionId?this.DLe(L):this.MFa(null,"NoSolutionId"),this.RGh(L),this.NJa(this.sPa,null)):this.NJa(this.sPa,L);n.ULS.sendTraceTag(528023563,220,50,"Show teaching callout for: {0}",L.addinId)}DLe(L){const ca=new ta.a;ca.callbackFunc=X=>{if(X.errorCode){this.MFa(L.solutionId,"FailToGetAppDetails");var qb=window.g_roamingAddinList;qb&&this.k_a(qb)}else if(X.value)for(qb of X.value)if(X=qb[1],X===L.solutionId){const Rb={};Rb.solutionId=X;Rb.assetId=
qb[5];Rb.storeType=qb[12];Rb.storeId=qb[11];Rb.assetStoreId=qb[6];Rb.targetType=qb[3];Rb.width=qb[7];Rb.height=qb[8];Rb.displayName=qb[0];Rb.version=qb[4];n.ULS.sendTraceTag(0,220,50,"Raise a teaching callout event for content addin: {0}.",L.solutionId);qb=new wa(Rb);this.Ip.raiseEvent(Q.a.oWe,qb);break}};ca.storeType=OSF.StoreTypeEnum.PrivateCatalog;ca.fromInsertDialog=!1;ca.refresh=!1;this.vl.queryEntitlementDetails(ca)}aWe(L){if("LastTeachingUIShowTime"in L){if(L=+new Date-+new Date(L.LastTeachingUIShowTime.toString()),
L<C.AFrameworkApplication.fa.oQ("AddinShowTeachingUIIntervalInMS",864E5))return n.ULS.sendTraceTag(538248467,220,50,"ShouldShowTeachingUI: False, Teaching callout is shown {0}MS ago",L),!1}else n.ULS.sendTraceTag(527523846,220,50,"userSetting has no date key");return!0}$Yd(){let L=new La.a(new oa,0),ca=new La.a(new oa,0),X=0,qb=0,Rb=0;var Qc=new e.a;for(var jd of this.sPa)Qc.add(jd);for(let vd of this.X6a)Qc.add(vd);for(let vd of Qc)if(!("excatalog"!==vd.storeType||ra.b(vd.installTimeInMS)||!vd.installTimeInMS||
vd.installTimeInMS<=C.AFrameworkApplication.fa.oQ("DateTimeInMSForNewAddin",16409952E5))){Qc=ya.f4b(vd);if(this.d1&&(jd=this.d1.split(","),0<jd.length&&Array.contains(jd,Qc))){Rb++;n.ULS.sendTraceTag(528345032,220,50,"This addin has shown teaching UI before");continue}Qc.startsWith("private_")?(L=ya.$0f(vd,L),qb++):(ca=ya.$0f(vd,ca),X++)}n.ULS.sendTraceTag(528345033,220,50,"Number of New CD addins for this user: Private:{0}, Store:{1}. Addin has shown teachingUI:{2}",qb,X,Rb);return 0<ca.value?ca.key:
0<L.value?L.key:Object.assign(new oa,{addinId:null,targetType:-1,solutionId:null})}MFa(L,ca,X=null){L={["AppTeachingUICalloutAction"]:ca,["SDX.Id"]:L,["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};if(X)for(let qb of X.keys)L[qb]=X.ga(qb);Y.a.sendTelemetryEvent(Object.assign(new na.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:O.a.ND(L)}))}RGh(L){L&&(window.g_roamingAddinList=this.d1?this.d1+","+L.addinId:L.addinId)}static qQ(L){return Telemetry.PrivacyRules.GetPrivacyCompliantId(L.solutionId,
L.storeType,L.assetId,null,null,L.storeId)}static $0f(L,ca){return ca.value<L.installTimeInMS?new La.a(Object.assign(new oa,{addinId:ya.f4b(L),targetType:L.targetType,solutionId:L.solutionId}),L.installTimeInMS):ca}static f4b(L){return Telemetry.PrivacyRules.IsPrivateAddin(L.storeType,L.assetId,null,null,L.storeId)?"private_"+L.installTimeInMS:L.solutionId}}Object(k.a)(ya,"PrivateCatalogTeachingCalloutHandler2",null,[]);class Da{constructor(L){this.Gef=null;this.$bf=L}get WUa(){return this.Gef}wqb(L,
ca=null){this.$bf.wqb(L,ca);this.Gef=L}UOe(L){this.$bf.UOe(L)}}Object(k.a)(Da,"RibbonExtensibilityManagerWithChangeDetection",null,[1104]);var pa=d(78);const la=()=>{const L=pa.a.zwb(window.location.href.toLowerCase(),"wdomexsrctype");return!!L&&"4"===L},Fa=()=>pa.a.zwb(window.location.href.toLowerCase(),"wdtpl"),Qa=()=>{const L=pa.a.zwb(window.location.href.toLowerCase(),"wdomexsrctype");return!!L&&"1"===L},Sa=L=>{let ca=null;switch(L){case 0:ca="omex";break;case 1:ca="spcatalog";break;case 2:ca=
"spapp";break;case 3:ca="filesystem";break;case 4:ca="exchange";break;case 6:ca="registry";break;case 7:ca="inmemory";break;case 8:ca="uploadfiledevcatalog";break;case 9:ca="hardcodedpreinstall";break;case 10:ca="excatalog";break;case 16:ca="wopicatalog"}return ca},Na=L=>{let ca=-1;switch(L.toLowerCase()){case "omex":ca=0;break;case "spcatalog":ca=1;break;case "spapp":ca=2;break;case "filesystem":ca=3;break;case "exchange":ca=4;break;case "registry":ca=6;break;case "inmemory":ca=7;break;case "uploadfiledevcatalog":ca=
8;break;case "hardcodedpreinstall":ca=9;break;case "excatalog":ca=10;break;case "wopicatalog":ca=16}return ca};class ua{constructor(){this.title=this.id=this.tabs=null}}Object(k.a)(ua,"AddInDataTransferObject",null,[]);class za{constructor(L,ca,X){this.Vuc=L;this.SLh=ca;this.TLh=X}get rF(){return this.Vuc}get j5h(){return this.SLh}get k5h(){return this.TLh}static xvb(L){return(L=L.T$)?Object.assign(new ua,{tabs:L.rF.toArray(),id:L.j5h,title:L.k5h}):null}}Object(k.a)(za,"OneLineRibbonExtensibility",
null,[]);class Wa{wqb(L,ca=null){if(L=za.xvb(L)){appChrome.addInApi.dispatchActionsToInstallAddIn(L,ca);for(const X of L.tabs)if(X.autoFocus){appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(L,()=>{});break}}}UOe(L){(L=za.xvb(L))&&appChrome.addInApi.dispatchActionsToRemoveAddIn(L)}static HLi(L,ca,X=null){L=Wa.Pfj(L);0<L.length&&(Wa.tnd(L,!1),X&&X(ca,L))}static Pfj(L){const ca=[];if(L&&(L=L.T$,L.rF&&0<L.rF.count))for(let X of L.rF)if(X.groups&&0<X.groups.length)for(const qb of X.groups)if(qb.controls&&
0<qb.controls.length)for(const Rb of qb.controls)Array.add(ca,Rb.id);return ca}static tnd(L){if(L.length){var ca=[];for(const X of L)ca.push(appChrome.actions.updateControlEnabledDisabledState(X,!0));appChrome.api.dispatch(ca)}}}Object(k.a)(Wa,"OneLineRibbonExtensibilityManager",null,[1104]);class yb{constructor(){this.Ver=1}}Object(k.a)(yb,"CacheItem",null,[]);class Za{constructor(){}}Object(k.a)(Za,"AppsDataCacheManager",null,[1096]);class ub{constructor(){new Za(w.a.instance)}Koh(L,ca){L=Q.a.G_f()+
L;w.a.instance.setItem(L,ca.toString())}$2f(){var L=Q.a.c3f();n.ULS.sendTraceTag(527523850,306,50,"set cache key:{0}",L);L=w.a.instance.getItem(L);return fa.a(L)}qqh(L){const ca=Q.a.c3f();n.ULS.sendTraceTag(527523851,306,50,"get cache key:{0}",ca);w.a.instance.setItem(ca,fa.c(L))}Chg(){return!!w.a.instance.localStorage}static get instance(){ub.Ka||(ub.Ka=new ub);return ub.Ka}}ub.Ka=null;Object(k.a)(ub,"AddInCommandsCacheManager",null,[1077]);var Ib=d(694),Ob=d(67);class Hc{static m0f(L){const ca=
new e.a;if(Hc.gFf)for(var X of Hc.gFf)ca.add(X);X=null;switch(L){case "Workbook":X=Hc.uFl;break;case "Document":X=Hc.mNi;break;case "Presentation":X=Hc.eEk}if(X)for(const qb of X)ca.add(qb);return ca}}Hc.gFf=["PrimaryCommandSurface","ContextMenu"];Hc.uFl=null;Hc.mNi=null;Hc.eEk=null;Object(k.a)(Hc,"ExtensionPointType",null,[]);class kb{constructor(L){this.Mhf=null;if(ra.b(L))throw n.ULS.sendTraceTag(9175315,220,10,"The agave key should not be null or undefined."),Error.create("The agave key should not be null or undefined");
this.dMh=L}get Tic(){return this.Mhf||(this.Mhf=new e.a)}get Gtf(){return this.dMh}}Object(k.a)(kb,"ContextMenuExtensibility",null,[1090]);class jb{constructor(L,ca=null,X=0){if(ra.b(L))throw n.ULS.sendTraceTag(9041814,220,10,"OneLineRibbonExtensibilityObject should not be null or undefined."),Error.create("OneLineRibbonExtensibilityObject should not be null or undefined.");this.FWh=L;this.d0h=ca;this.cRh=X}get T$(){return this.FWh}get startedNode(){return this.d0h}get T0i(){return this.cRh}}Object(k.a)(jb,
"RibbonExtensibility",null,[1142]);class hb{constructor(L){this.cQh=L.entitlement}get entitlement(){return this.cQh}createActionContext(L,ca){L={};L.ownerAddinInfo=this.entitlement;L.action=ca;return L}}Object(k.a)(hb,"AddInCommandsContextProvider",null,[]);class uc{constructor(L,ca,X){this.x5e=this.eventBuilder=this.contextMenuBuilder=this.ribbonBuilder=this.actionBuilder=this.commandSurface=null;this.ribbonBuilder=L;this.eventBuilder=ca;this.contextMenuBuilder=X}get addinInfo(){return this.x5e}BBi(L){return new hb(L)}createActionBuilder(L,
ca){return OfficeExt.DefaultControlActionBinder.createActionBuilder(L,ca.entitlement,ca.manifest)}startApplyAddin(L){this.x5e=L;const ca=this.BBi(L);this.actionBuilder=this.createActionBuilder(ca,L)}endApplyAddin(){}G3d(L,ca,X=0){return this.ribbonBuilder.rF&&0<this.ribbonBuilder.rF.count?new jb(this.D0i(L,ca),this.addinInfo.startedNode,X):null}DWf(){var L=null;if(this.contextMenuBuilder.Ebd&&0<this.contextMenuBuilder.Ebd.count){L||(L=this.addinInfo.entitlement.solutionId);L=new kb(L);for(let ca of this.contextMenuBuilder.Ebd)L.Tic.add(ca);
return L}return null}D0i(L,ca){return this.ribbonBuilder.rF&&0<this.ribbonBuilder.rF.count?new za(this.ribbonBuilder.rF,L,ca):null}}Object(k.a)(uc,"AddinCommandsBuilder",null,[]);class mc{constructor(L,ca,X,qb,Rb,Qc,jd){this.okb=new Ob.a;this.mx=L;this.vl=ca;this.AS=X;this.ooc=qb;this.xVd=Rb;this.hKa=Qc;this.Kqb=jd;this.waa=C.AFrameworkApplication.Aa.gV}A0c(L,ca,X,qb,Rb,Qc,jd){const vd=(Xd,Ke,jf,wf)=>{Rb(Xd,Ke,jf,wf);Xd=Ib.a[this.mx]+Ke.assetId;({value:Ke}=this.okb.Uf(Xd)).returnValue&&(Ke.stop(),
this.okb.remove(Xd))};if(0!==this.mx&&L){n.ULS.sendTraceTag(17326351,220,50,"Addin count {0}.",L.count);4===this.mx&&(n.ULS.sendTraceTag(17586256,220,100,String.format("Refresh AddinCommands for dataprovider : {0}",qb)),this.Qri(L,qb),Qc());for(let Xd of L)if(L=Xd,n.ULS.sendTraceTag(17638144,220,50,String.format("{0}: Install addin {1}",this.AS.jT,Telemetry.PrivacyRules.GetPrivacyCompliantId(L.solutionId,L.ownerAddinStoreType||L.storeType,L.assetId,null,null,L.storeId))),this.rIh(L))if(jd&&L.requireConsent)jd(L,
Ke=>{try{if(this.waa){const wf=Ib.a[this.mx]+Ke.solutionId,eg=this.waa.Ci("ComponentAttach",wf);this.okb.$(wf,eg)}const jf=this.hKa.s8a(Ke.storeType,Ke.solutionId);6!==this.mx&&(jf&&(this.TIc(jf),jf.mM.purge(!1)),this.vl.insertOsfControl(this.Jlc(Ke,ca,X,vd)),jf&&this.vl.ownerAddinControlRecreated(Ke.solutionId,Ke.storeType))}catch(jf){n.ULS.sendTraceTag(572839882,220,10,String.format("{0}: AddinCommands SolutionId={1} Version={2} StoreType={3} StoreId={4} failed to install. Error message : {5}.",
this.AS.jT,Telemetry.PrivacyRules.GetPrivacyCompliantId(Ke.solutionId,Ke.ownerAddinStoreType||Ke.storeType,Ke.assetId,null,null,Ke.storeId),Ke.version,Ke.storeType,Ke.storeId,jf.message)),vd(!1,Ke,null,null)}});else try{if(this.waa){const jf=Ib.a[this.mx]+L.solutionId,wf=this.waa.Ci("ComponentAttach",jf);this.okb.$(jf,wf)}const Ke=this.hKa.s8a(L.storeType,L.solutionId);6!==this.mx&&(Ke&&(this.TIc(Ke),Ke.mM.purge(!1)),this.vl.insertOsfControl(this.Jlc(L,ca,X,vd)),Ke&&this.vl.ownerAddinControlRecreated(L.solutionId,
L.storeType))}catch(Ke){n.ULS.sendTraceTag(17388185,220,10,String.format("{0}: AddinCommands SolutionId={1} AppVersion={2} StoreType={3} StoreId={4} failed to install. Error message : {5}.",this.AS.jT,Telemetry.PrivacyRules.GetPrivacyCompliantId(L.solutionId,L.ownerAddinStoreType||L.storeType,L.assetId,null,null,L.storeId),L.version,L.storeType,L.storeId,Ke.message)),vd(!1,L,null,null)}else vd(!1,L,null,null)}}oXj(L,ca,X,qb,Rb,Qc){const jd=(vd,Xd,Ke,jf)=>{Qc(vd,Xd,Ke,jf);vd=Ib.a[this.mx]+Xd.solutionId;
({value:Xd}=this.okb.Uf(vd)).returnValue&&(Xd.stop(),this.okb.remove(vd))};if(6===this.mx&&L)if(n.ULS.sendTraceTag(592290762,220,50,String.format("{0}: Install dynamic ribbon {1}",this.AS.jT,Telemetry.PrivacyRules.GetPrivacyCompliantId(L.solutionId,L.ownerAddinStoreType||L.storeType,L.assetId,null,null,L.storeId))),this.rIh(L))try{if(this.waa){const Xd=Ib.a[this.mx]+L.solutionId,Ke=this.waa.Ci("ComponentAttach",Xd);this.okb.$(Xd,Ke)}const vd=this.hKa.s8a(L.storeType,L.solutionId);vd||jd(!1,L,null,
null);C.AFrameworkApplication.Aa&&C.AFrameworkApplication.Aa.hb.SKf?this.UWf(L,ca,qb,Rb,X,Xd=>{jd(Xd,L,X,vd.displayName)}):(this.UWf(L,ca,qb,Rb,X),jd(!0,L,X,vd.displayName))}catch(vd){n.ULS.sendTraceTag(592290764,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to launch dynamic commands. Error message : {5}.",this.AS.jT,Telemetry.PrivacyRules.GetPrivacyCompliantId(L.solutionId,L.ownerAddinStoreType||L.storeType,L.assetId,null,null,L.storeId),L.version,
L.storeType,L.storeId,vd.message)),jd(!1,L,null,null)}else jd(!1,L,null,null)}xlk(L,ca,X,qb,Rb,Qc){if(Qc)if(Qc._isAddinCommandsManifest(this.AS.jT))try{C.AFrameworkApplication.Aa&&C.AFrameworkApplication.Aa.hb.SKf?this.TWf(L,ca,X,Rb,Qc,jd=>{qb(jd,L,Qc,Qc.getDefaultDisplayName())}):(this.TWf(L,ca,X,Rb,Qc),qb(!0,L,Qc,Qc.getDefaultDisplayName()))}catch(jd){n.ULS.sendTraceTag(17586257,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to generate ui extensibility. Error message : {5}.",
this.AS.jT,Telemetry.PrivacyRules.GetPrivacyCompliantId(L.solutionId,L.ownerAddinStoreType||L.storeType,L.assetId,null,null,L.storeId),L.version,L.storeType,L.storeId,jd.message)),qb(!1,L,Qc,Qc.getDefaultDisplayName())}else n.ULS.sendTraceTag(17586258,220,10,String.format("{0}: Regular content/taskpane addin AssetId={1} AppVersion={2} StoreType={3} StoreId={4} is not supported for addincommands.",this.AS.jT,Telemetry.PrivacyRules.GetPrivacyCompliantId(L.solutionId,L.ownerAddinStoreType||L.storeType,
L.assetId,null,null,L.storeId),L.version,L.storeType,L.storeId)),qb(!1,L,null,null);else n.ULS.sendTraceTag(17586259,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to get manifest.",this.AS.jT,Telemetry.PrivacyRules.GetPrivacyCompliantId(L.solutionId,L.ownerAddinStoreType||L.storeType,L.assetId,null,null,L.storeId),L.version,L.storeType,L.storeId)),qb(!1,L,null,null)}Jlc(L,ca,X,qb){const Rb={},Qc=document.createElement("div");Qc.setAttribute("visible",
"false");Rb.div=Qc;Rb.id=L.solutionId;Rb.solutionId=L.solutionId;Rb.version=L.version;Rb.storeType=L.storeType;Rb.storeId=L.storeId;Rb.assetId=L.assetId;Rb.assetStoreId=L.assetStoreId;Rb.isvirtualOsfControl=!0;Rb.virtualOsfControlActivationCallback=(jd,vd)=>{const Xd=this.hKa.s8a(L.storeType,L.solutionId);Xd&&(Xd.isUpgraded&&(L.isUpgraded=!0),this.TIc(Xd));this.xlk(L,ca,X,qb,jd,vd)};Rb.reason=3===this.mx?Microsoft.Office.WebExtension.InitializationReason.Inserted:Microsoft.Office.WebExtension.InitializationReason.DocumentOpened;
return Rb}TWf(L,ca,X,qb,Rb,Qc=null){const jd={};jd.solutionId=qb.getSolutionId();jd.version=qb.getVersion();jd.storeType=qb.getStoreType();jd.storeId=qb.getStoreId();jd.assetId=qb.getAssetId();jd.assetStoreId=qb.getAssetStoreId();jd.targetType=qb.getOsfControlType();let vd=null,Xd=null;if(C.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFGenerateUIExtensibilityParseBuildLoggingKill",!1))vd=(new OfficeExt.Parser.AddinCommandsManifestParser(this.AS.jT,this.AS.formFactor)).parseExtensions(jd,
Rb,this.Kqb),Xd=Hc.m0f(this.AS.jT);else try{vd=(new OfficeExt.Parser.AddinCommandsManifestParser(this.AS.jT,this.AS.formFactor)).parseExtensions(jd,Rb,this.Kqb),Xd=Hc.m0f(this.AS.jT)}catch(jf){throw n.ULS.sendTraceTag(538752131,220,10,"Exception encounter while parsing manifest. Exception: "+jf.message),jf;}if(Xd&&0<Xd.count){if(C.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFGenerateUIExtensibilityParseBuildLoggingKill",!1)){var Ke=ca(L);ca=X(L);X=!!C.AFrameworkApplication.fa&&
C.AFrameworkApplication.fa.ka("AddinCommandsMultipleCustomTabsEnabled");Ke=new uc(Ke,null,ca);for(let jf of Xd)Ke.commandSurface=jf,vd.apply(Ke,this.Kqb,X)}else try{let jf=ca(L),wf=X(L),eg=!!C.AFrameworkApplication.fa&&C.AFrameworkApplication.fa.ka("AddinCommandsMultipleCustomTabsEnabled");Ke=new uc(jf,null,wf);for(let Ng of Xd)Ke.commandSurface=Ng,vd.apply(Ke,this.Kqb,eg)}catch(jf){throw n.ULS.sendTraceTag(538752132,220,10,"Exception encounter while building ribbon. Exception: "+jf.message),jf;}if(OSF.OUtil.checkFlight(14))try{let jf=
Ke.G3d(L.solutionId,Rb.getDefaultDisplayName()),wf=Ke.DWf();jf&&this.ooc.wqb(jf,Qc);wf&&this.xVd.iqf(wf);this.hKa.Wqf(qb,jf,wf,Rb.getDefaultDisplayName());n.ULS.sendTraceTag(17326353,220,100,"Add-in name: {0}.",Rb.getDefaultDisplayName())}catch(jf){throw OfficeExt.DevConsole.log(jf),n.ULS.sendTraceTag(539870850,220,10,"Error generating ribbon extensibility. Exception: "+jf.message),jf;}else try{let jf=Ke.G3d(L.solutionId,Rb.getDefaultDisplayName()),wf=Ke.DWf();jf&&this.ooc.wqb(jf);wf&&this.xVd.iqf(wf);
this.hKa.Wqf(qb,jf,wf,Rb.getDefaultDisplayName());n.ULS.sendTraceTag(579376721,220,100,"Add-in name: {0}.",Rb.getDefaultDisplayName())}catch(jf){throw n.ULS.sendTraceTag(539870851,220,10,"Error generating ribbon extensibility. Exception: "+jf.message),jf;}}}UWf(L,ca,X,qb,Rb,Qc=null){const jd={};jd.solutionId=L.solutionId;jd.version=L.version;jd.storeType=L.storeType;jd.storeId=L.storeId;jd.assetId=L.assetId;jd.assetStoreId=L.assetStoreId;jd.targetType=L.targetType;const vd=new OfficeExt.JsonParser.AddinCommandsJsonParser(this.AS.jT,
this.AS.formFactor);try{const Xd=ca.getManifest(),Ke=vd.parse(jd,Xd,Rb,this.Kqb,ca.getSharedRuntimeId(),ca),jf=X(L),wf=qb(L),eg=new uc(jf,null,wf);eg.commandSurface="PrimaryCommandSurface";Ke.apply(eg,this.Kqb,!0);if(eg.ribbonBuilder.rF&&0<eg.ribbonBuilder.rF.count){const Ng=eg.G3d(L.solutionId,ca.getManifest().getDefaultDisplayName(),1);C.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.RibbonExtensibilityNullCheckKillSwitch",!1)?this.ooc.wqb(Ng,Qc):Ng&&this.ooc.wqb(Ng,
Qc);this.hKa.G5h(ca,Ng,Rb,ca.getManifest().getDefaultDisplayName());n.ULS.sendTraceTag(592290767,220,100,"Add-in name: {0}.",ca.getManifest().getDefaultDisplayName())}}catch(Xd){n.ULS.sendTraceTag(592290768,220,15,"Failed to generate dynamic Add-in commands. Add-in name: {0}. Error: {1}",ca.getManifest().getDefaultDisplayName(),Xd.toString()),OSF.OUtil.checkFlight(14)&&OfficeExt.DevConsole.log(Xd)}}TIc(L){L.NJ&&this.ooc.UOe(L.NJ);L.a0b&&this.xVd.CRk(L.a0b);this.hKa.kRk(L.mM.getStoreType(),L.mM.getSolutionId())}Qri(L,
ca){ca=Sa(ca);for(let X of this.hKa.ayb){if(X.mM.getStoreType()!==ca)continue;let qb=!0;for(let Rb of L){const Qc=Rb;if(Qc&&X.Ejg(Qc.storeType,Qc.solutionId)){qb=!1;break}}qb&&(this.TIc(X),X.mM.purge(!1))}}rIh(L){return!!L&&!!L.solutionId&&!!L.version&&!!L.storeType&&!!L.storeId}}Object(k.a)(mc,"AddInCommandsIntegration",null,[]);var Ya=d(1136),Mb=d(164),Kc=d(921),eb=d(571),Tb=d(346),lb=d(922),Fb=d(140),rb=d(95),Qb=d(63),Bc=d(55);class wb{static get H7(){return wb.pG||(wb.pG=Bc.a.instance.rb("Common.Utils.IAriaNotifier"))}static hHf(L,
ca,X,qb){wb.IV&&wb.IV.qL&&wb.IV.dismiss();wb.IV=Ya.a.HWd(ca,L,L,3);wb.IV.content=X;ra.a(qb)||(wb.IV.title=qb,wb.IV.c7b=!0);L=new Sys.UI.Bounds(0,0,rb.a.$Tc(),rb.a.ZTc());wb.IV.OZ=wb.v4d(L,ca,wb.IV.Qaa,1);wb.IV.show();wb.H7&&wb.H7.sendNotification(X.innerText,!0)}static aWd(L,ca,X,qb=null){Fb.UISurfaces.CN().then(Rb=>{let Qc=null;wb.cVb&&(Rb.removeNotification(wb.cVb),wb.cVb=null);const jd=Rb.callout(Object.assign(new Kc.a,{target:L,title:ca,content:X,showCloseIcon:!0,hasDynamicSizing:!0,jumpToCalloutTargetButtonEnabled:!0,
calloutProps:Object.assign(new lb.a,{onDismiss:()=>{Rb.removeNotification(Qc)},directionalHint:null!=qb?qb:null})})),vd=Object.assign(new Tb.a,{expirationOptions:Object.assign(new eb.a,{displayTimeoutSeconds:7,onExpire:()=>{Rb.removeNotification(wb.cVb)}})});Qc=wb.cVb=Rb.addNotification(jd,vd);return null},Rb=>{n.ULS.sendTraceTag(593352342,383,15,"Failed to GetNotificationsAPIAsync: {0}",Rb);return null})}static lWe(L){wb.IV&&wb.IV.qL&&wb.IV.dismiss();const ca=new z.StandardDialog;ca.e0a=!1;ca.xd=
0;ca.zy(Mb.a.iXj,CommonUIStrings.l_DialogError,ra.a(L)?wb.NZf():L,null)}static Sel(L){wb.IV&&wb.IV.qL&&wb.IV.dismiss();n.ULS.sendTraceTag(17425951,220,10,String.format("AddinCommandsActivationError : error code {0}.",L.errorCode));const ca=ra.a(L.description)?wb.NZf():L.description,X=new z.StandardDialog;let qb=null;L.mZb?(X.xd=1,X.Xe(1,L.buttonText),X.jya(1)):X.xd=0;qb=Rb=>{1===Rb?L.mZb():L.G1b&&L.G1b()};X.e0a=!1;0===L.uce?X.zy(L.errorCode,L.title?L.title:CommonUIStrings.l_DialogError,ca,qb):1===
L.uce?X.cP(L.title?L.title:CommonUIStrings.l_DialogWarning,ca,qb):X.Yjb(L.title?L.title:CommonUIStrings.l_DialogInfo,ca,qb)}static v4d(L,ca,X,qb){let Rb=0===qb?0:4;const Qc=L.x+L.width-ca.x-ca.width;ca.x-L.x+ca.width/2<=X/2?Rb=0===qb?2:5:Qc+ca.width/2<=X/2&&(Rb=0===qb?3:6);return Rb}static cfl(L,ca,X,qb=!1){(ca=za.xvb(ca))&&appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn&&appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(ca,Rb=>{Rb&&(qb||wb.aWd(Rb,X,L,5))})}static dfl(L,ca,X=!1){wb.cfl(ca.startedNode?
ca.startedNode.description:String.format(CommonUIStrings.l_NewAddInLoadedContent,L),ca,ca.startedNode?ca.startedNode.title:String.format(CommonUIStrings.l_NewAddInLoadedTitle,L),X)}static bfl(L,ca,X,qb){if(wb.LHh)L=String.format(CommonUIStrings.l_ErrorLoadingAddInsContentOuterString,String.format(CommonUIStrings.l_ErrorLoadingAddInsContentInnerString,X,qb,CommonUIStrings.l_InsertionDialogRefresh)),wb.aWd(ca,L,CommonUIStrings.l_ErrorLoadingAddInsTitle,1);else{ca=Qb.a.ii(ca);var Rb=CommonUIStrings.l_ErrorLoadingAddInsContentOuterString.split("{0}"),
Qc=document.createElement("span");Qc.innerText=Rb[0];var jd=document.createElement("span");jd.innerText=String.format(CommonUIStrings.l_ErrorLoadingAddInsContentInnerString,X,qb,CommonUIStrings.l_InsertionDialogRefresh);jd.className="UIFontBold";X=document.createElement("span");X.innerText=Rb[1];qb=document.createElement("div");Sys.UI.DomElement.addCssClass(qb,"ModalCalloutControl");qb.appendChild(Qc);qb.appendChild(jd);qb.appendChild(X);wb.hHf(L,ca,qb,CommonUIStrings.l_ErrorLoadingAddInsTitle)}}static xgl(L,
ca){var X=CommonUIStrings.l_InstallingCustomFunctionsErrorCalloutMsg,qb=CommonUIStrings.l_InstallingCustomFunctionsErrorStatusBarMsg;wb.LHh?wb.aWd(ca,X,qb):(ca=Qb.a.ii(ca),wb.hHf(L,ca,wb.uki(qb),X))}static uki(L){const ca=document.createElement("div");Sys.UI.DomElement.addCssClass(ca,"ModalCalloutControl");ca.innerText=L;return ca}static NZf(){return CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive}static get LHh(){return C.AFrameworkApplication.Aa.hb.Lo&&C.AFrameworkApplication.Aa.hb.BUa}}
wb.IV=null;wb.cVb=null;wb.pG=null;Object(k.a)(wb,"AddInCommandsNotificationFactory",null,[]);class Ad{constructor(L,ca,X,qb,Rb,Qc,jd,vd=null){this.Oa=new T.a;this.Mvd=L;this.xOh=ca;this.TM=X;this.dof=qb;this.hpb=Rb;this.ULh=Qc;this.Yuc=jd;this.vWh=vd;this.ZSh=C.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:5996085_EmailAlertAutolaunchOnWacEnabled");this.PBd=C.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:6635045_FixAutoLaunchAddinFromDeeplink")}G7h(L){this.Oa.addHandler(Q.a.atf,
L)}C8h(L){this.Oa.addHandler(Q.a.Yle,L)}U$h(L){this.Oa.addHandler(Q.a.xuh,L)}T7h(L){this.Oa.addHandler(Q.a.MQd,L)}yXj(L,ca,X){const qb=X[Q.a.aGc],Rb=void 0===X[Q.a.A7]?0:X[Q.a.A7];if(qb&&0!==Rb)if(0>=qb.count&&4!==Rb)this.U$g(new da(Rb,null,null,ca,null,!0));else{var Qc=qb.count,jd=new Da(new Wa),vd=void 0===X[Q.a.B7]?-1:X[Q.a.B7],Xd=new mc(Rb,this.TM,this.Mvd,jd,this.xOh,this.hpb,this.Yuc),Ke=Ug=>this.dof.Rji(Ug.solutionId,this.Yuc,this.Mvd,L),jf=Ug=>this.dof.Wii(Ug.solutionId),wf=(Ug,Ah,We)=>{Qc--;
We=new da(Rb,Ah,jd,ca,We,0>=Qc);if(Ug&&Ah)this.U$g(We);else{if(3===Rb||Ah&&Ah.isUpgraded)Ug="",Ah&&(Ug=Telemetry.PrivacyRules.GetPrivacyCompliantId(Ah.solutionId,Ah.ownerAddinStoreType||Ah.storeType,Ah.assetId,null,null,Ah.storeId)),Ah={["SDX_AppInstallOrigin"]:"User",["SDX_AppInstallErrorCode"]:"onAddinCompletedBase.fail",["SDX_Id"]:Ug},Y.a.sendTelemetryEvent(Object.assign(new na.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:O.a.ND(Ah)}));this.T$g(We)}Qc||C.AFrameworkApplication.Aa.updateCommandUI()},
eg=(Ug,Ah,We,lk)=>{wf(Ug,Ah,lk)},Ng=()=>{this.dEe();0>=qb.count&&4===Rb&&this.hpb.qTe()};6===Rb?(vd=X[Q.a.lOi],X=X[Q.a.mOi],Xd.oXj(qb.ga(0),vd,X,Ke,jf,(Ug,Ah,We,lk)=>{wf(Ug,Ah,lk)})):Xd.A0c(qb,Ke,jf,vd,eg,Ng,this.vWh)}else Y.a.sendTelemetryEvent(Object.assign(new na.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:O.a.ND({["SDX_AppInstallOrigin"]:"User",["SDX_AppInstallErrorCode"]:"LaunchOneLineRibbonAddinCommands.fail",["SDX_Id"]:""})})),n.ULS.sendTraceTag(24786637,220,10,String.format("{0}: parameters are invalid for LaunchOnlineAddinCommands.",
this.Mvd.jT)),this.T$g(new da(Rb,null,null,ca,null,!0))}T$g(L){this.dEe(L);this.ovh(!1,L)}U$g(L){const ca=L.Au;let X=null;null!==ca&&(X=ca.storeType,X=X.toLowerCase());if(L&&"omex"===X&&(3===L.mx||ca.isUpgraded)){var qb={["SDX_AppInstallOrigin"]:"User",["SDX_AppInstallErrorCode"]:"0",["SDX_Id"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(ca.solutionId,ca.ownerAddinStoreType||ca.storeType,ca.assetId,null,null,ca.storeId)};Y.a.sendTelemetryEvent(Object.assign(new na.a,{name:"Office.Extensibility.Host.AppInstall",
dataFields:O.a.ND(qb)}))}this.dEe(L);qb=this.PBd&&Qa()&&"omex"===X&&!!L.haa&&!!ca.solutionId&&2===L.mx&&ca.solutionId.toLowerCase()===Fa().toLowerCase();var Rb="omex"===X&&!!L.haa&&(3===L.mx&&"hardcodedpreinstall"!==X||ca.isUpgraded);const Qc=C.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableLaunchCDAddIn",!1)&&"excatalog"===X&&3===L.mx;if(Rb||qb||Qc)qb=new S,qb.Au=ca,qb.NJ=L.haa.WUa,this.Oa.raiseEvent(Q.a.MQd,qb);this.ZSh&&(qb=la(),Rb=Fa(),qb&&ca&&"excatalog"===
ca.storeType&&L.haa&&5===L.mx&&Rb&&(ca.storeId&&ca.storeId.toLowerCase()===Rb.toLowerCase()||ca.assetId&&ca.assetId.toLowerCase()===Rb.toLowerCase())&&(qb=new S,qb.Au=ca,qb.NJ=L.haa.WUa,this.Oa.raiseEvent(Q.a.MQd,qb),n.ULS.sendTraceTag(525362254,220,50,"Email alert triggers AutoLaunchAddin event.")));ca&&(ub.instance.Koh(Na(X),!0),"uploadfiledevcatalog"===X&&(qb=this.ULh.createAddinDataProvider(X,this.TM))&&qb.localCacheAddinCommands(this.TM.dxa,ca.solutionId,ca.version,ca.storeId),W.a.dOb(Q.a.YXb,
"true",Na(X)));this.ovh(!0,L)}ovh(L,ca){L?C.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",!1)&&ca.haa&&5===ca.mx&&ca.haa.WUa&&void 0!==ca.Au.showCallout&&null!==ca.Au.showCallout&&ca.Au.showCallout?(C.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingCalloutRefactorEnabled",!1)?(new ya(this.Oa)).hNd(ca.Au,za.xvb(ca.haa.WUa)):(new ba(this.Oa,ca.Au,za.xvb(ca.haa.WUa))).hNd(),L=new S,L.NJ=ca.haa.WUa,
L.Au=ca.Au,this.Oa.raiseEvent(Q.a.xuh,L)):3!==ca.mx?ca.jmg&&this.hpb.qTe():ca.haa&&ca.haa.WUa&&"hardcodedpreinstall"!==ca.Au.storeType&&wb.dfl(ca.displayName,ca.haa.WUa,ca.Au.isAutoLaunched):3===ca.mx?ca.Au&&"uploadfiledevcatalog"===ca.Au.storeType.toLowerCase()?(ca=this.Yuc.Y7i(ca.Au.solutionId),wb.lWe(ca?ca:CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive)):this.hpb.X5k():ca.jmg&&this.hpb.qTe()}dEe(L=null){var ca=L?L.Au:null;const X=new S;if(X.Au=ca){var qb=this.hpb.s8a(ca.storeType,
ca.solutionId,6===L.mx?1:0);if(qb&&qb.NJ){X.NJ=qb.NJ;var Rb=this.PBd?Fa():null;Rb=this.PBd&&Qa()&&!!ca.solutionId&&!!Rb&&ca.solutionId.toLowerCase()===Rb.toLowerCase()&&2===L.mx;if(3===L.mx&&"hardcodedpreinstall"!==ca.storeType||Rb)L="",qb.NJ.T$&&qb.NJ.T$.rF&&(qb=qb.NJ.T$.rF.ga(0))&&(L=qb.id),ca={["SDX_CommandPlacement"]:L,["SDX_PinningAction"]:"Pinning",["SDX_PinningActionErrorCode"]:"0",["SDX_Id"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(ca.solutionId,ca.ownerAddinStoreType||ca.storeType,ca.assetId,
null,null,ca.storeId)},Y.a.sendTelemetryEvent(Object.assign(new na.a,{name:"Office.Extensibility.Host.AppPinning",dataFields:O.a.ND(ca)}))}}this.Oa.raiseEvent(Q.a.atf,X)}}Object(k.a)(Ad,"LaunchAddinCommandsHandler",null,[1084]);class bc{constructor(L){this.QWh=L}get dxa(){return this.QWh}insertOsfControl(L){return this.dxa.insertOsfControl(L)}getManifestInvaildErrorString(){return this.dxa.getManifestInvaildErrorString()}isAddinCommandsAsync(L,ca){this.dxa.isAddinCommandsAsync(L,ca)}isAddinCommandsExAsync(L,
ca){this.dxa.isAddinCommandsExAsync(L,ca)}ownerAddinControlRecreated(L,ca){this.dxa.ownerAddinControlRecreated(L,ca)}queryEntitlementDetails(L){this.dxa.queryEntitlementDetails(L)}}Object(k.a)(bc,"ContextActivationMgrWrapper",null,[1086]);class Sb{}Sb.Nlb="Alt";Sb.Olb="Command";Sb.id="Id";Sb.t1a="Image16by16";Sb.Plb="LabelText";Sb.button="Button";Sb.L2d="FlyoutAnchor";Object(k.a)(Sb,"AddinDataNodeConstants",null,[]);var Zb=d(213),cb=d(404),Xa=d(312),Lb=d(70);class pc{constructor(L,ca){this.iAc=this.V7e=
null;if(ra.b(L)||ra.b(ca))throw n.ULS.sendTraceTag(9175312,220,10,"ControlDefinition id or type should not be null or undefined."),Error.create("ControlDefinition id or type should not be null or undefined");this.Wxd=ca;this._id=L;this.mN[Sb.id]=this._id}get id(){return this._id||""}get mN(){return this.V7e||(this.V7e={})}get controlType(){return this.Wxd||""}get menuItems(){return this.iAc||(this.iAc=new e.a)}Hsc(){let L=null;this.Wxd===Sb.L2d?L=Object.assign(new cb.a,{Menu:this.Ggk()}):this.Wxd===
Sb.button&&(L=Object.assign(new Zb.a,{}));L&&(this.mN[Sb.id]&&(L.ExternalId=this.mN[Sb.id]),this.mN[Sb.Olb]&&(L.Command=this.mN[Sb.Olb].toString()),this.mN[Sb.Plb]&&(L.LabelText=this.mN[Sb.Plb]),this.mN[Sb.Nlb]&&(L.Alt=this.mN[Sb.Nlb]),this.mN[Sb.t1a]&&(Lb.c()&&appChrome.addInApi.registerAddinIcon&&appChrome.addInApi.registerAddinIcon(this._id,this.mN[Sb.t1a]),L.ExternalImageId=this._id));return L}Ggk(){const L=Object.assign(new Xa.a,{UpdateDynamically:!0,MenuSectionList:[]});if(this.iAc){const ca=
Object.assign(new r.a,{ControlList:[]});for(let X of this.iAc)Array.add(ca.ControlList,X.Hsc());Array.add(L.MenuSectionList,ca)}return L}}Object(k.a)(pc,"ControlDefinition",null,[1083]);class fc{constructor(L){this.vba=null;if(ra.b(L))throw n.ULS.sendTraceTag(9175313,220,10,"MenuItemDefinition id should not be null or undefined."),Error.create("MenuItemDefinition id should not be null or undefined");this._id=L;this.$hc[Sb.id]=this._id}get $hc(){return this.vba||(this.vba={})}get id(){return this._id||
""}Hsc(){const L=Object.assign(new Zb.a,{});this.vba[Sb.id]&&(L.ExternalId=this.vba[Sb.id]);this.vba[Sb.Olb]&&(L.Command=this.vba[Sb.Olb].toString());this.vba[Sb.Plb]&&(L.LabelText=this.vba[Sb.Plb]);this.vba[Sb.Nlb]&&(L.Alt=this.vba[Sb.Nlb]);this.vba[Sb.t1a]&&(Lb.c()&&appChrome.addInApi.registerAddinIcon&&appChrome.addInApi.registerAddinIcon(this._id,this.vba[Sb.t1a]),L.ExternalImageId=this._id);return L}}Object(k.a)(fc,"MenuItemDefinition",null,[1124]);class bd{constructor(L){this.mwc=null;if(ra.b(L))throw n.ULS.sendTraceTag(9175314,
220,10,"OfficeMenuDefinition id should not be null or undefined."),Error.create("OfficeMenuDefinition id should not be null or undefined");this._id=L}get id(){return this._id}get controls(){return this.mwc||(this.mwc=new e.a)}Hsc(){const L=[];if(this.mwc)for(let ca of this.mwc){const X=ca.Hsc();X&&L.push(X)}return L}}Object(k.a)(bd,"OfficeMenuDefinition",null,[1081]);var od=d(35);class ye{constructor(L,ca,X){this.xV=this.Zmb=null;this.mFd=L;this.Jmb=ca;this.Ylb=X;this.FVh=new e.a}get pcd(){return this.mFd}get C_b(){return this.Jmb}get DMd(){return this.Ylb}addButton(L){n.ULS.sendTraceTag(17085952,
220,50,"ContextMenu button actiontype: {0}.",L.actionType);this.xV=new pc(this.SPa(L.id),Sb.button);this.xV.mN[Sb.Plb]=L.label;this.xV.mN[Sb.Nlb]=L.label;this.xV.mN[Sb.t1a]=L.icon["16"];this.TYb(this.xV.mN[Sb.id],L.action);this.C5a(this.xV.mN);this.Zmb.controls.add(this.xV);this.xV=null}startBuildMenu(L){if(ra.b(this.Zmb))this.Zmb=new bd(L.id);else{const ca=this.SPa(L.id);this.xV=new pc(ca,Sb.L2d);this.Urb(this.xV.mN,L);this.xV.mN[Sb.t1a]=L.icon["16"];this.xV.mN[Sb.Olb]=od.a.E7}}addMenuItem(L){n.ULS.sendTraceTag(17085953,
220,50,"ContextMenu menu item actiontype: {0}.",L.actionType);const ca=new fc(this.SPa(L.id));this.Urb(ca.$hc,L);L.icon&&(ca.$hc[Sb.t1a]=L.icon["16"]);this.TYb(ca.$hc[Sb.id],L.action);this.C5a(ca.$hc);this.xV.menuItems.add(ca)}endBuildMenu(){ra.b(this.xV)?(this.Ebd.add(this.Zmb),this.Zmb=null):(this.Zmb.controls.add(this.xV),this.xV=null)}get Ebd(){return this.FVh}TYb(L,ca){this.DMd.bindAction(L,ca)}C5a(L){this.C_b.C5a(L)}SPa(L){return this.pcd.HDa(L)}Urb(L,ca){L[Sb.Plb]=ca.label;L[Sb.Nlb]=ca.label}}
Object(k.a)(ye,"ContextMenuExtensibilityCreator",null,[1103,1098]);class pd{constructor(L){this.gUb=L}get Aic(){return this.gUb}HDa(L){return this.Aic+L}}Object(k.a)(pd,"DefaultContextMenuNamingProvider",null,[1102]);class ab{constructor(L,ca,X,qb){this.gUb=L;C.AFrameworkApplication.fa.ka("AddInCommandsMissingTabIsEnabled")&&X.tbj();this.Kmf=ca;this.q_h=qb}get Aic(){return this.gUb}get solutionId(){return this.Kmf}get QVe(){return this.q_h}HDa(L){L=this.Aic+this.solutionId+L;return this.QVe?(L in
ab.bGc||(ab.bGc[L]="AddinControl"+ab.Kai++),ab.bGc[L]):L}bKf(L){if(this.QVe){const X=ab.bGc;for(let qb in X){var ca=qb;if(L===X[qb])return ca.substr(this.Aic.length+this.solutionId.length)}}return L}Yjj(L){L=this.Aic+this.solutionId+L;return this.QVe?(L in ab.GOd||(ab.GOd[L]="AddinTab"+ab.Pai++),ab.GOd[L]):L}}ab.bGc={};ab.GOd={};ab.Pai=0;ab.Kai=0;Object(k.a)(ab,"DefaultRibbonNamingProvider",null,[1082]);class Yb{bindAction(L,ca){OfficeExt.DefaultControlActionBinder.bindAction(L,ca)}}Object(k.a)(Yb,
"DefaultUIControlActionBinder",null,[1100]);class Sc{constructor(L){this.aOh=L}get command(){return this.aOh}C5a(L){L[Sb.Olb]=this.command}}Object(k.a)(Sc,"DefaultUIControlCommandBinder",null,[1099]);var Jb=d(526);class Oc{constructor(){this.iconLocation=this.title=this.id=null;this.enabled=!1;this.controlType=0;this.attributes=this.menuItems=null}}Object(k.a)(Oc,"AddInControl",null,[]);class Wb{constructor(){this.controls=this.title=this.mlrId=this.id=null;this.groupType=0;this.attributes=null}}
Object(k.a)(Wb,"AddInGroup",null,[]);class Ab{constructor(){this.iconLocation=this.title=this.id=null;this.enabled=!1;this.attributes=null}}Object(k.a)(Ab,"AddInMenuItem",null,[]);class Xb{constructor(){this.groups=this.attributes=this.title=this.id=null;this.visible=this.isOfficeTab=!1;this.insertAfter=this.insertBefore=this.tabType=null;this.autoFocus=!1}}Object(k.a)(Xb,"AddInTab",null,[]);class vb{constructor(L,ca,X,qb,Rb,Qc){this.Vuc=new e.a;this.EQb=this.Rza=this.$mb=null;this.mFd=L;this.Ylb=
ca;this.Jmb=X;this.Kmf=qb;this.Yuc=Rb;this.m$e=Qc}get pcd(){return this.mFd}get rF(){return this.Vuc}get DMd(){return this.Ylb}get C_b(){return this.Jmb}startBuildTab(L){const ca=L.isOfficeTab?L.id:this.pcd.Yjj(L.id),X=L.isOfficeTab?null:L.label;this.$mb=Object.assign(new Xb,{id:ca,title:X,isOfficeTab:L.isOfficeTab,visible:L.visible,groups:[],tabType:L.tabType,insertBefore:L.insertBefore,insertAfter:L.insertAfter,autoFocus:L.autoFocus})}startBuildGroup(L){const ca=this.SPa(L.id);this.Rza=Object.assign(new Wb,
{id:ca,mlrId:L.mlrId,title:L.label,controls:[],groupType:0})}addNativeGroup(L){this.Rza=Object.assign(new Wb,{id:L.id,mlrId:L.mlrId,title:L.label,controls:[],groupType:1});this.$mb.groups.push(this.Rza)}addButton(L){const ca=this.SPa(L.id);ca&&(this.TYb(ca,L.action),n.ULS.sendTraceTag(24786640,220,50,"AddInDataTransferObject button actiontype: {0}.",L.actionType),L=Object.assign(new Oc,{id:ca,title:L.label,iconLocation:this.i6d(L),enabled:L.enabled,controlType:0,attributes:this.Urb()}),this.m$e.Ppf(new Jb.a(ca,
this.C_b.command.toString())),this.Rza.controls.push(L))}addNativeControl(L){L.id&&(n.ULS.sendTraceTag(590709920,220,50,"AddInDataTransferObject button actiontype: {0}.",L.actionType),L=Object.assign(new Oc,{id:L.id,title:"",iconLocation:"",enabled:L.enabled,controlType:2,attributes:this.Urb()}),this.Rza.controls.push(L))}startBuildMenu(L){const ca=this.SPa(L.id);ca&&(this.EQb=Object.assign(new Oc,{id:ca,title:L.label,iconLocation:this.i6d(L),controlType:1,attributes:{},menuItems:[]}))}addMenuItem(L){const ca=
this.SPa(L.id);ca&&(this.TYb(ca,L.action),n.ULS.sendTraceTag(24786642,220,50,"AddInDataTransferObject menu item actiontype: {0}.",L.actionType),L=Object.assign(new Ab,{id:ca,title:L.label,iconLocation:this.i6d(L),enabled:L.enabled,attributes:this.Urb()}),this.m$e.Ppf(new Jb.a(ca,this.C_b.command.toString())),this.EQb.menuItems.push(L))}endBuildMenu(){ra.b(this.EQb.id)||this.Rza.controls.push(this.EQb);this.EQb=null}endBuildGroup(){ra.b(this.Rza.id)||this.$mb.groups.push(this.Rza);this.Rza=null}endBuildTab(){ra.b(this.$mb.id)||
this.Vuc.add(this.$mb);this.$mb=null}Urb(){const L={};this.C5a(L);return L}i6d(L){return L.icon["80"]?L.icon["80"]:L.icon["32"]}C5a(L){this.C_b.C5a(L)}SPa(L){return this.pcd.HDa(L)}TYb(L,ca){this.DMd.bindAction(L,ca)}}Object(k.a)(vb,"OneLineRibbonExtensibilityCreator",null,[1097,1098]);class $c{constructor(L,ca){this.gUb=L;this.Ylb=new Yb;this.Jmb=new Sc(ca)}Wii(L){L=new pd(L);return new ye(L,this.Jmb,this.Ylb)}Rji(L,ca,X,qb){X=new ab(this.gUb,L,X,!0);return new vb(X,this.Ylb,this.Jmb,L,ca,qb)}}Object(k.a)($c,
"UIExtensibilityFactory",null,[1078]);class fd{createAddinDataProvider(L,ca){return OfficeExt.AddinDataProviderFactory.createAddinDataProvider(L,ca.dxa)}static get instance(){fd.Ka||(fd.Ka=new fd);return fd.Ka}}fd.Ka=null;Object(k.a)(fd,"OSFAddinDataProviderFactory",null,[1080]);class Bd{constructor(){this.Lqb=null}setErrorMessageForAddin(L,ca){this.Lqb||(this.Lqb={});this.Lqb[L]=ca}Y7i(L){return this.Lqb&&L in this.Lqb?this.Lqb[L]:null}}Object(k.a)(Bd,"AddinCommandsErrorManager",null,[]);class gd{constructor(){this.uce=
0;this.mZb=this.buttonText=this.description=this.title=this.id=null;this.errorCode=0;this.aag=!1;this.xzj=this.G1b=null}}Object(k.a)(gd,"AddInCommandsNotificationParameters",null,[]);class Pd{constructor(){this.h6e=this.svd=null}get EMd(){return this.svd||(this.svd=OfficeExt.DefaultControlActionBinder.retrieveActionContext)}set EMd(L){this.svd=L}get igi(){return this.h6e||(this.h6e=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap())}getTaskPaneControlIdFromSolutionIdRuntimeId(L,
ca){return OfficeExt.DefaultControlActionBinder.getTaskPaneControlIdFromSolutionIdRuntimeId(L,ca)}x6b(L,ca,X,qb,Rb){n.ULS.sendTraceTag(17138449,220,50,"Control id: {0}.",L);if((L=ca.s8a(Rb.ownerAddinInfo.storeType,Rb.ownerAddinInfo.solutionId))&&L.mM&&!L.mM.getIsUpgrading())if(ca=null,0<L.mM.getNotificationParams().length&&(ca=this.yyf(L.mM.getNotificationParams()[0]))&&2147758681===ca.errorCode&&(L.isUpgraded=!0),2!==L.mM.getStatus()&&(1!==L.mM.getStatus()||ca&&2147758681===ca.errorCode))ca&&this.tuh(L,
ca,null);else try{X.setOwnerAddinEToken(L.mM.getEToken()),Rb.action(X,qb.dxa)}catch(Qc){n.ULS.sendTraceTag(17425949,220,10,String.format("HandleAddinCommandsAction error info : {0}.",C.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.LogStackInfo")?Qc.stack:Qc.message)),wb.lWe(CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive)}}tuh(L,ca,X=null){const qb=L.mM;if(1===qb.getNotificationParams().length||ca.aag){const Rb=ca.mZb,Qc=ca.G1b;
ca.mZb=()=>{qb.removeFirstNotification();if(0<qb.getNotificationParams().length){const jd=this.yyf(qb.getNotificationParams()[0]);this.tuh(L,jd)}2147758681===ca.errorCode&&(Wa.HLi(L.NJ,qb,Object(u.a)(this,this.Tbg,"initUpgradeStateDetectTask")),v.BLi(L.a0b,qb,Object(u.a)(this,this.Tbg,"initUpgradeStateDetectTask")));Rb&&Rb()};ca.G1b=()=>{Qc&&Qc();X&&X()};wb.Sel(ca)}}Tbg(L,ca){let X=null;X=()=>{L.getIsUpgrading()?window.setTimeout(X,1E3):L.getUpgradingFailed()?Wa.tnd(ca,!0):C.AFrameworkApplication.Aa.updateCommandUI()};
window.setTimeout(X,1E3)}yyf(L){const ca=new gd;ca.uce=L.infoType;ca.id=L.id;ca.title=L.title;ca.description=L.description;ca.buttonText=L.buttonTxt;ca.mZb=L.buttonCallback;ca.aag=L.highPriority;ca.G1b=L.dismissCallback;ca.errorCode=L.errorCode;ca.xzj=L.iframeNotificationUrl;return ca}}Object(k.a)(Pd,"AddinCommandsActionHandler",null,[1091]);class cd{constructor(){this.labelText=null;this.visible=!1}}Object(k.a)(cd,"AddinStatusCommandValues",null,[]);class lf{static hHk(L){const ca=new cd;ca.labelText=
L.ZXb;ca.visible=ca.labelText?!0:!1;return ca}static LWe(){const L=document.getElementById(void 0);L?lf.jvh(void 0,void 0,L,void 0,void 0):n.ULS.sendTraceTag(17662423,220,100,String.format("{0} element is not availiable",void 0))}static jvh(L,ca,X,qb,Rb){X?L.ZXb===CommonUIStrings.l_ErrorLoadingAddInsTitle?wb.bfl(ca,X,qb,Rb):L.ZXb===CommonUIStrings.l_InstallingCustomFunctionsErrorStatusBarMsg&&wb.xgl(ca,X):n.ULS.sendTraceTag(543801756,220,100,String.format("addinLabelElement element is not available"))}}
Object(k.a)(lf,"AddinCommandsStatusHandler",null,[]);class Jd{constructor(){this.mx=this.U0=0;this.xOd=null;this.whd=this.bsd=0;this.LMa=this.fAd=this.Kvd=this.aKc=this.xDa=this.hra=null}get wOd(){this.Kvd||(this.Kvd=new e.a);return this.Kvd}get z3d(){this.fAd||(this.fAd=new e.a);return this.fAd}get X6a(){this.LMa||(this.LMa=new e.a);return this.LMa}}Object(k.a)(Jd,"AddinCommandsListLoaderContext",null,[]);const Xf=L=>{const ca={};ca.solutionId=L.solutionId;ca.version=L.version;ca.storeType=L.storeType;
ca.storeId=L.storeId;ca.assetId=L.assetId;ca.assetStoreId=L.assetStoreId;ca.targetType=L.targetType;ca.requireConsent=L.requireConsent||!1;ca.isAddinCommands=!0;ca.addinCommandsActionType=0;return ca};class ee{constructor(L,ca){this.entitlement=L;this.metadata=ca}sBh(){const L=Xf(this.entitlement);L.targetType=this.targetType;return L}get solutionId(){return this.entitlement.solutionId}get version(){return this.entitlement.version}get storeType(){return this.entitlement.storeType}get storeId(){return this.entitlement.storeId}get assetId(){return this.entitlement.assetId}get assetStoreId(){return this.entitlement.assetStoreId}get targetType(){return-1!==
this.entitlement.targetType?this.entitlement.targetType:this.metadata.targetType}get eToken(){return this.entitlement.eToken}get requireConsent(){return this.entitlement.requireConsent}get installTimeInMS(){return this.entitlement.installTimeInMS}}Object(k.a)(ee,"AddinEntitlementEx",null,[]);var Ra=d(21);class sb{constructor(L){this.Cg=null;this.iba=L}get_current(){if(!this.Cg)throw Error.argumentOutOfRange();return this.Cg.data}moveNext(){if(!this.Cg)return this.Cg=this.iba,!!this.iba;if(!this.Cg.next)return!1;
this.Cg=this.Cg.next;return!0}reset(){this.Cg=this.iba}}Object(k.a)(sb,"ListEnumerator",null,[0]);class ec{constructor(L,ca,X){this.next=X;this.previous=ca;this.data=L}}Object(k.a)(ec,"ListNode",null,[]);class Lc{constructor(){this.S4a=this.hha=null;this.Yk=0}add(L){this.hha?this.S4a=this.S4a.next=new ec(L,this.S4a,null):this.hha=this.S4a=new ec(L,null,null);this.Yk=this.count+1}insert(L,ca){if(L>this.count||0>L)throw Error.argumentOutOfRange("pos");if(L===this.count)this.add(ca);else{for(var X=this.hha;0!==
L--;)X=X.next;L=new ec(ca,X.previous,X);L.previous?L.previous.next=L:this.hha=L;L.next?L.next.previous=L:this.S4a=L;this.Yk=this.count+1}}remove(L){let ca=this.hha;for(;ca&&ca.data!==L;)ca=ca.next;if(!ca)return!1;ca.previous?ca.previous.next=ca.next:this.hha=ca.next;ca.next?ca.next.previous=ca.previous:this.S4a=ca.previous;this.Yk=this.count-1;return!0}clear(){let L=this.hha,ca;for(this.S4a=this.hha=null;L;)ca=L.next,L.previous=null,L.next=null,L=ca;this.Yk=0}indexOf(L){let ca=this.hha,X=0;for(;ca&&
ca.data!==L;)ca=ca.next,X++;return ca?X:-1}ga(L){return this.at(L).data}get count(){return this.Yk}getEnumerator(){return new sb(this.hha)}[Symbol.iterator](){return Object(Ra.a)(this.getEnumerator())}toArray(){const L=Array(this.count);let ca=0;for(let X of this)L[ca]=X,ca++;return L}at(L){let ca=this.hha,X=0;for(;X!==L;){if(!ca)throw Error.argumentOutOfRange("pos");ca=ca.next;X++}return ca}}Object(k.a)(Lc,"List",null,[1]);class nd extends Sys.EventArgs{constructor(L){super();this.properties=L}}
Object(k.a)(nd,"AddinCommandsEntitlementsRetrievedEventArgs",Sys.EventArgs,[]);class Fd{constructor(){this.addinId=null;this.targetType=0;this.solutionId=null}}Object(k.a)(Fd,"MiniAddinInfo",null,[]);class Ja{constructor(L,ca,X){this.Ip=new T.a;this.context=new Jd;this.MKd=this.LXe=this.O5a=this.d1=this.Waa=null;this.contextActivationMgr=L;this.Lai=ca;this.P5a=X;this.appName=C.AFrameworkApplication.fa.Ha("WebAppShortName")}get pAh(){this.MKd||(this.MKd=new ya(this.Ip));return this.MKd}F7h(L){this.Ip.addHandler(Q.a.XXb,
L)}W$h(L){this.Ip.addHandler(Q.a.oWe,L)}Oul(L){null!==L&&(this.context.U0=L[Q.a.B7],this.context.mx=L[Q.a.A7],this.context.bsd=this.context.whd=0,L=Q.a.Mqb in L?L[Q.a.Mqb]:0,-1!==this.context.U0&&0!==this.context.mx&&(this.context.hra=new Lc,this.context.xDa=new Lc,this.context.aKc=new Lc,this.context.xOd=this.Lai.createAddinDataProvider(Sa(this.context.U0),this.contextActivationMgr),this.context.xOd?this.context.xOd.getEntitlementsAsync(this.contextActivationMgr.dxa,!0,L,ca=>{this.bqk(ca)}):n.ULS.sendTraceTag(17638145,
220,10,"Create AddinDataProvider fails for {0}",this.context.U0)))}bqk(L){if(L&&0<L.length){this.context.bsd=L.length;const X=C.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:6635045_FixAutoLaunchAddinFromDeeplink")?Fa():null;for(let qb=0;qb<L.length;qb++){const Rb=L[qb];if(C.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:6635045_FixAutoLaunchAddinFromDeeplink")&&Qa()&&Rb&&Rb.storeType&&"omex"===Rb.storeType.toLowerCase()&&Rb.assetId&&X&&Rb.assetId.toLowerCase()===X.toLowerCase()){var ca=
{["SDX_AppInstallOrigin"]:"DeeplinkUser",["SDX_Id"]:Ja.qQ(Rb)};Y.a.sendTelemetryEvent(Object.assign(new na.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:O.a.ND(ca)}))}!Rb||1!==Rb.targetType&&-1!==Rb.targetType?this.Zcd():(ca={},C.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.VSO6786086_RetireAddinCommandsCheckingContextProperties")?(ca.solutionId=Rb.solutionId,ca.version=Rb.version):(ca.marketplaceId=Rb.solutionId,ca.marketplaceVersion=Rb.version),ca.storeType=
Rb.storeType,ca.storeId=Rb.storeId,ca.targetData=Rb,Ja.Zrc?this.contextActivationMgr.isAddinCommandsExAsync(ca,Object(u.a)(this,this.Kpk,"onIsAddinCommandsExCompleted")):this.contextActivationMgr.isAddinCommandsAsync(ca,(Qc,jd,vd)=>{Qc?(jd&&this.context.hra.add(vd.targetData),10===this.context.U0&&(Qc=vd.targetData,jd=Qc.targetType,ra.b(vd.targetTypeForExp)||(jd=vd.targetTypeForExp,Qc.targetType=jd),this.context.xDa.add(Qc),0===jd&&this.context.aKc.add(Qc))):(vd=vd.targetData,n.ULS.sendTraceTag(542978528,
220,15,"Checking AddinCommands fails for {0} from {1}",Telemetry.PrivacyRules.GetPrivacyCompliantId(vd.solutionId,vd.storeType,vd.assetId,null,null,vd.storeId),vd.storeType));this.Zcd()}))}}else this.Zcd()}Zcd(){var L;(L=this.context).whd=L.whd+1;this.context.whd>=this.context.bsd&&(this.P5a.Koh(this.context.U0,!1),0<this.context.bsd&&10===this.context.U0&&("Excel"===this.appName||"PowerPoint"===this.appName||"Word"===this.appName)?(L=!1,C.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:5996085_EmailAlertAutolaunchOnWacEnabled")&&
la()&&(L=this.o0j()),this.F_j(),C.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",!1)&&!L?Ja.Zrc?this.pAh.Psl(this.contextActivationMgr,this.context.wOd,this.context.X6a,(ca,X)=>{const qb=new e.a;for(let Rb of ca)ca=Rb.sBh(),X&&X.solutionId===Rb.solutionId&&(ca.showCallout=!0,this.pAh.RGh(X)),qb.add(ca);this.NJa(qb)}):this.w1i(this.context.hra):this.iFc(this.context.hra)):this.iFc(this.context.hra))}iFc(L){if(Ja.Zrc)this.NJa(this.svi(this.context.wOd));
else{var ca=new e.a;if(L)for(let X of this.context.hra)ca.add(Xf(X));this.context.hra&&1>this.context.hra.count&&W.a.dOb(Q.a.YXb,"false",this.context.U0);L={["ack2"]:ca};L[Q.a.B7]=this.context.U0;L[Q.a.A7]=this.context.mx;this.Ip.raiseEvent(Q.a.XXb,new nd(L),this)}}svi(L){const ca=new e.a;if(L)for(let X of L)ca.add(X.sBh());return ca}NJa(L){L&&L.count||W.a.dOb(Q.a.YXb,"false",this.context.U0);L={["ack2"]:L};L[Q.a.B7]=this.context.U0;L[Q.a.A7]=this.context.mx;this.Ip.raiseEvent(Q.a.XXb,new nd(L),this)}k_a(L){if(this.appName){const ca=
{},X={};X.LastTeachingUIShowTime=(new Date).toUTCString();X.AddinHasShown=L;ca[this.appName]=fa.c(X);this.Waa&&(this.Waa.Jub(ca),n.ULS.sendTraceTag(539530527,306,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service"))}else n.ULS.sendTraceTag(539530528,306,10,"Fail to save roaming service since AppName is null")}w1i(L){(this.O5a=L)?(L=new e.a,L.add(this.appName),this.Waa=new F(this.appName,Object(u.a)(this,this.XDa,"getRequestSuccessCallback"),Object(u.a)(this,
this.Tja,"getRequestFailureCallback"),Object(u.a)(this,this.W$,"postRequestFailureCallback")),this.Waa.jOc(L)):(L={["ack2"]:new e.a},L[Q.a.B7]=this.context.U0,L[Q.a.A7]=this.context.mx,this.Ip.raiseEvent(Q.a.XXb,new nd(L),this))}XDa(L){L?this.aWe(L)?(n.ULS.sendTraceTag(527523845,306,50,"should show teaching UI"),this.d1="AddinHasShown"in L&&L.AddinHasShown?L.AddinHasShown.toString():null,this.O_b()):(n.ULS.sendTraceTag(538248466,306,50,"Not Show TeachingUI this time"),this.iFc(this.O5a)):(n.ULS.sendTraceTag(527523844,
306,50,"userSettings is null"),this.d1=null,this.O_b())}Tja(L){n.ULS.sendTraceTag(539530529,306,10,"GET data from Roaming Settings Service with status: {0}, fallback",L?L.Te:-1);this.iFc(this.O5a)}W$(L){n.ULS.sendTraceTag(539530530,306,10,"failed to POST data to Roaming Settings Service with status: {0}",L?L.Te:-1)}O_b(){const L=this.$Yd();0===L.targetType?(L.solutionId?(this.LXe=L.solutionId,this.DLe()):this.MFa("NoSolutionId"),L.addinId&&(window.g_roamingAddinList=this.d1?this.d1+","+L.addinId:
L.addinId),this.Nqf(null)):this.Nqf(L.addinId);n.ULS.sendTraceTag(528023563,306,50,"Show teaching callout for: {0}",L.addinId)}DLe(){const L=new ta.a;L.callbackFunc=ca=>{if(ca.errorCode){this.MFa("FailToGetAppDetails");var X=window.g_roamingAddinList;X&&this.k_a(X)}else if(ca.value)for(X of ca.value)if(ca=X[1],ca===this.LXe){const qb={};qb.solutionId=ca;qb.assetId=X[5];qb.storeType=X[12];qb.storeId=X[11];qb.assetStoreId=X[6];qb.targetType=X[3];qb.width=X[7];qb.height=X[8];qb.displayName=X[0];qb.version=
X[4];X=new wa(qb);this.Ip.raiseEvent(Q.a.oWe,X);break}};L.storeType=OSF.StoreTypeEnum.PrivateCatalog;L.fromInsertDialog=!1;L.refresh=!1;this.contextActivationMgr.queryEntitlementDetails(L)}aWe(L){if("LastTeachingUIShowTime"in L){if(L=+new Date-+new Date(L.LastTeachingUIShowTime.toString()),L<C.AFrameworkApplication.fa.oQ("AddinShowTeachingUIIntervalInMS",864E5))return n.ULS.sendTraceTag(538248467,306,50,"ShouldShowTeachingUI: False, Teaching callout is shown {0}MS ago",L),!1}else n.ULS.sendTraceTag(527523846,
306,50,"userSetting has no date key");return!0}$Yd(){let L=new La.a(new Fd,0),ca=new La.a(new Fd,0),X=0,qb=0,Rb=0;var Qc=new Lc;if(0<this.context.hra.count)for(var jd of this.context.hra)Qc.add(jd);if(0<this.context.aKc.count)for(let vd of this.context.aKc)Qc.add(vd);for(let vd of Qc)if(!("excatalog"!==vd.storeType||ra.b(vd.installTimeInMS)||!vd.installTimeInMS||vd.installTimeInMS<=C.AFrameworkApplication.fa.oQ("DateTimeInMSForNewAddin",16409952E5))){Qc=Ja.f4b(vd);if(this.d1&&(jd=this.d1.split(","),
0<jd.length&&Array.contains(jd,Qc))){Rb++;n.ULS.sendTraceTag(528345032,306,50,"This addin has shown teaching UI before");continue}Qc.startsWith("private_")?(L.value<vd.installTimeInMS&&(L=new La.a(Object.assign(new Fd,{addinId:Qc,targetType:vd.targetType,solutionId:vd.solutionId}),vd.installTimeInMS)),qb++):(ca.value<vd.installTimeInMS&&(ca=new La.a(Object.assign(new Fd,{addinId:Qc,targetType:vd.targetType,solutionId:vd.solutionId}),vd.installTimeInMS)),X++)}n.ULS.sendTraceTag(528345033,306,50,"Number of New CD addins for this user: Private:{0}, Store:{1}. Addin has shown teachingUI:{2}",
qb,X,Rb);return 0<ca.value?ca.key:0<L.value?L.key:Object.assign(new Fd,{addinId:null,targetType:-1,solutionId:null})}Nqf(L){const ca=new e.a;for(let X of this.O5a){const qb=Xf(X);if(L){const Rb=Ja.f4b(X);L===Rb&&(qb.showCallout=!0,window.g_roamingAddinList=this.d1?this.d1+","+L:L)}ca.add(qb)}this.O5a&&1>this.O5a.count&&W.a.dOb(Q.a.YXb,"false",this.context.U0);L={["ack2"]:ca};L[Q.a.B7]=this.context.U0;L[Q.a.A7]=this.context.mx;this.Ip.raiseEvent(Q.a.XXb,new nd(L),this)}o0j(){if(Ja.Zrc)return this.p0j(this.context.z3d);
var L=!1;if(this.context.xDa&&1>this.context.xDa.count)return L;const ca=Fa();if(!ca)return L;for(let X of this.context.xDa)if(X.storeId&&X.storeId.toLowerCase()===ca.toLowerCase()||X.assetId&&X.assetId.toLowerCase()===ca.toLowerCase())L={["SDX_Id"]:Ja.qQ(X),["SDX_TargetType"]:ra.b(X.targetType)?"":X.targetType.toString()},Y.a.sendTelemetryEvent(Object.assign(new na.a,{name:"Office.Extensibility.Host.EmailAlertNotification",dataFields:O.a.ND(L)})),L=!0;return L}F_j(){if(Ja.Zrc)this.G_j(this.context.z3d);
else if(!(this.context.xDa&&1>this.context.xDa.count))if(this.P5a.Chg()){var L=this.P5a.$2f();L?(L=this.mZf(this.context.xDa,L),n.ULS.sendTraceTag(527523848,306,50,"detect new addins using localStorage")):(L=this.mZf(this.context.xDa,null),n.ULS.sendTraceTag(527523847,306,50,"no data from cache"));this.P5a.qqh(L)}else n.ULS.sendTraceTag(528589915,306,50,"Local storage got disabled")}mZf(L,ca){const X={};let qb=!1;for(let Rb of L)if(L=Ja.qQ(Rb))!ca||L in ca||(this.kVa(Rb,L),n.ULS.sendTraceTag(527523849,
306,50,"New addin detected,log to AppInstall")),"private"===L.toLowerCase()?qb||(qb=!0,X[L]=null):X[L]=null;return X}kVa(L,ca){var X=L.installTimeInMS?(new Date(L.installTimeInMS)).toISOString():"";X={["SDX.Id"]:ca,["SDX.AppInstallOrigin"]:"Organization",["SDX.TargetType"]:ra.b(L.targetType)?"":L.targetType.toString(),["SDX.AdminDeploymentTime"]:X};Y.a.sendTelemetryEvent(Object.assign(new na.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:O.a.ND(X)}));1===L.targetType&&(L={["SDX.Id"]:ca,
["SDX.AppInstallOrigin"]:"Organization",["SDX.CommandPlacement"]:"Ribbon"},Y.a.sendTelemetryEvent(Object.assign(new na.a,{name:"Office.Extensibility.Host.AppPinning",dataFields:O.a.ND(L)})))}p0j(L){let ca=!1;if(L&&1>L.count)return ca;const X=Fa();if(!X)return ca;for(let qb of L)if(qb.storeId&&qb.storeId.toLowerCase()===X.toLowerCase()||qb.assetId&&qb.assetId.toLowerCase()===X.toLowerCase())L={["SDX_Id"]:Ja.b3f(qb),["SDX_TargetType"]:ra.b(qb.targetType)?"":qb.targetType.toString()},Y.a.sendTelemetryEvent(Object.assign(new na.a,
{name:"Office.Extensibility.Host.EmailAlertNotification",dataFields:O.a.ND(L)})),ca=!0;return ca}G_j(L){if(!(L&&1>L.count))if(this.P5a.Chg()){var ca=this.P5a.$2f();ca?(L=this.nZf(L,ca),n.ULS.sendTraceTag(527523848,306,50,"detect new addins using localStorage")):(L=this.nZf(L,null),n.ULS.sendTraceTag(527523847,306,50,"no data from cache"));this.P5a.qqh(L)}else n.ULS.sendTraceTag(528589915,306,50,"Local storage got disabled")}nZf(L,ca){const X={};let qb=!1;for(let Rb of L)if(L=Ja.b3f(Rb))!ca||L in ca||
(this.x2j(Rb,L),n.ULS.sendTraceTag(527523849,306,50,"New addin detected,log to AppInstall")),"private"===L.toLowerCase()?qb||(qb=!0,X[L]=null):X[L]=null;return X}x2j(L,ca){var X=L.installTimeInMS?(new Date(L.installTimeInMS)).toISOString():"";X={["SDX.Id"]:ca,["SDX.AppInstallOrigin"]:"Organization",["SDX.TargetType"]:ra.b(L.targetType)?"":L.targetType.toString(),["SDX.AdminDeploymentTime"]:X};Y.a.sendTelemetryEvent(Object.assign(new na.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:O.a.ND(X)}));
1===L.targetType&&(L={["SDX.Id"]:ca,["SDX.AppInstallOrigin"]:"Organization",["SDX.CommandPlacement"]:"Ribbon"},Y.a.sendTelemetryEvent(Object.assign(new na.a,{name:"Office.Extensibility.Host.AppPinning",dataFields:O.a.ND(L)})))}Kpk(L,ca,X,qb){L?(-1===qb.targetType&&(qb.targetType=X.targetTypeForExp),L=new ee(X.targetData,qb),ca&&this.context.wOd.add(L),10===this.context.U0&&(this.context.z3d.add(L),0===L.targetType&&this.context.X6a.add(L))):(ca=X.targetData,n.ULS.sendTraceTag(542978528,220,15,"Checking AddinCommands fails for {0} from {1}",
Telemetry.PrivacyRules.GetPrivacyCompliantId(ca.solutionId,ca.storeType,ca.assetId,null,null,ca.storeId),ca.storeType));this.Zcd()}MFa(L){L={["AppTeachingUICalloutAction"]:L,["SDX.Id"]:this.LXe,["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};Y.a.sendTelemetryEvent(Object.assign(new na.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:O.a.ND(L)}))}static get Zrc(){return C.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingCalloutRefactorEnabled",
!1)}static qQ(L){return Telemetry.PrivacyRules.GetPrivacyCompliantId(L.solutionId,L.storeType,L.assetId,null,null,L.storeId)}static b3f(L){return Telemetry.PrivacyRules.GetPrivacyCompliantId(L.solutionId,L.storeType,L.assetId,null,null,L.storeId)}static f4b(L){return Telemetry.PrivacyRules.IsPrivateAddin(L.storeType,L.assetId,null,null,L.storeId)?"private_"+L.installTimeInMS:L.solutionId}}Object(k.a)(Ja,"AddInCommandsListLoader",null,[]);var db=d(1117),ic=d(177),id=d(1218),qd=d(27),Fc=d(58);class Ze{constructor(L,
ca,X){this.Cbb=this.UFa=this.rea=this.Deb=null;this.Oye=this.e9c=-1;this.hH=null;this.tRg=!1;this.Epg=L;this.Yb=ca;this.Kpg=this.Yb.Fc("AddinMaxTabSwitchDetectionTimesForTeachingUI",3);this.H3j=this.Yb.Fc("AddinMaxDOMElementDetectionTimesForTeachingUI",10);this.S1c=this.Yb.Ha("WebAppShortName");this.Lc=X;ka.a.Wa(this.S1c)&&(this.S1c="PowerPoint")}qQ(L){return Telemetry.PrivacyRules.GetPrivacyCompliantId(L.solutionId,L.storeType,L.assetId,null,null,L.storeId)}CQk(L){this.hH=L;this.Lc.M5a(Object(u.a)(this,
this.F3g,"onInsertTabSwitched_ContentAddin"));window.addEventListener("LaunchContentAddin",Object(u.a)(this,this.buk,"onTryItButtonClicked_ContentAddin"),!0);window.addEventListener("DismissCallout",Object(u.a)(this,this.Unk,"onDismissButtonClicked_ContentAddin"),!0);window.addEventListener("CloseCallout",Object(u.a)(this,this.Smk,"onCloseButtonClicked_ContentAddin"),!0)}Vpk(){this.rea&&this.Cbb&&(this.Epg.x6b({["SourceControlId"]:this.Cbb}),n.ULS.sendTraceTag(512499854,220,50,"Launch addin command has been triggered"))}gfl(L,
ca){ca?(this.rea=ca.Au,(this.Deb=ca.NJ)&&this.Deb.T$&&this.Deb.T$.rF&&(this.UFa=this.Deb.T$.rF.ga(0)),this.UFa?this.UFa.isOfficeTab?(L=this.rea.solutionId,ca=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap(),L in ca?this.Cbb=ca[L]:(n.ULS.sendTraceTag(512499852,220,15,"OnLaunchAddinButtonClicked failed to get button id from controlIdMap for add-in: {0}",this.qQ(this.rea)),this.Cbb=this.s1i(this.Deb)),this.Cbb?0<this.UFa.id.indexOf(Fc.a.Heh)?appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(za.xvb(this.Deb),
()=>{this.Avh(this.WSc(this.Cbb))}):this.Lc.M5a(Object(u.a)(this,this.s6g,"onTabSwitched")):(this.lVa("NoEnabledButtonFound",this.rea),n.ULS.sendTraceTag(512499851,220,10,"OnLaunchAddinButtonClicked failed to get button id for addin"),this.xIa())):this.Cvh(this.WSc(this.UFa.id),0):(this.lVa("NoTabFound",this.rea),n.ULS.sendTraceTag(512499853,220,10,"ShowCalloutOnAddin finds that the ribbon extensibility has no tab id"),this.xIa())):this.xIa()}s6g(L,ca){!this.UFa||void 0===this.UFa.id||null===this.UFa.id||
0>ka.a.og(this.UFa.id).indexOf(ka.a.og(ca.G$))||(this.Lc.DJb(Object(u.a)(this,this.s6g,"onTabSwitched")),this.yTd(ca.G0g,ca.G$,this.Kpg,!1))}F3g(L,ca){"Insert"===ca.G$&&(this.Lc.DJb(Object(u.a)(this,this.F3g,"onInsertTabSwitched_ContentAddin")),this.yTd(ca.G0g,ca.G$,this.Kpg,!0))}yTd(L,ca,X,qb){if(0>X)this.lVa("TabSwitchTimeOut",this.rea);else{var Rb=document.querySelector("button"+this.WSc(ca));Rb.hasAttribute("aria-selected")&&"false"!==Rb.getAttribute("aria-selected")?(0<this.Oye&&window.clearTimeout(this.Oye),
qb?this.whl():this.Avh(this.WSc(this.Cbb))):this.Oye=window.setTimeout(()=>{this.yTd(L,ca,X-1,qb)},1E3)}}WSc(L){return"[id="+L+"]"}whl(){let L=document.querySelector("button[data-unique-id = 'Ribbon-InsertAddIns']");var ca=L?window.getComputedStyle(L,null):null;if(!L||ca&&"none"===ca.display)if(L=document.querySelector("button[data-unique-id = 'Overflow-RibbonOverflowMenu-overflow']"))n.ULS.sendTraceTag(512499849,220,15,"Callout show on Overflow button");else{this.uAb("NoAnchor",this.hH);n.ULS.sendTraceTag(512499850,
220,15,"ShowTeachingCalloutToContentAddin failed to get an anchorElement");return}else n.ULS.sendTraceTag(512499848,220,15,"Callout show on OfficeAddin Button");(ca=Bc.a.instance.Ja("Common.ISystemInitiatedFeedback"))&&L?(ca.execute(X=>{X.logActivity("ShowTeachingUIForContentAddin",null)}),this.uAb("Show",this.hH),n.ULS.sendTraceTag(512499846,220,50,"ShowTeachingCalloutToContentAddin triggered an LPP activity")):(this.uAb("NoSifFutureObject",this.hH),n.ULS.sendTraceTag(512499847,220,15,"ShowTeachingCalloutToContentAddin failed to get a sifFuture"))}buk(){this.uAb("ClickOnLaunch",
this.hH);this.xIa();const L={};L.solutionId=this.hH.solutionId;L.assetId=this.hH.assetId;L.assetStoreId=this.hH.assetStoreId;L.height=this.hH.height?this.hH.height:600;L.storeId=this.hH.storeId;L.targetType=this.hH.targetType;L.width=this.hH.width?this.hH.width:600;L.displayName=this.hH.displayName;L.version=this.hH.version;L.storeType=this.hH.storeType;L.isAddinCommands=!1;this.Epg.Kd.dAb("0",3,L)}Smk(){this.uAb("ClickOnClose",this.hH);this.xIa()}Unk(){this.uAb("ClickOnDismiss",this.hH);this.xIa()}Cvh(L,
ca){if(ca>this.H3j)window.clearTimeout(this.e9c),this.Bvh("[data-unique-id='pivotOverflowButton']"),n.ULS.sendTraceTag(512499845,220,50,"ShowTeachingCalloutWithPoll did not find the Addin Tab in time");else{var X=document.querySelector("button"+L);!X||X.hasAttribute("tabIndex")&&"-1"===X.getAttribute("tabIndex")?this.e9c=window.setTimeout(()=>{this.Cvh(L,ca+1)},1E3):(0<this.e9c&&window.clearTimeout(this.e9c),this.Bvh(L))}}Avh(L){let ca=document.querySelector("button[data-unique-id='RightPaddle']");
if(ca)this.lVa("RightPaddlePresent",this.rea);else if(L=(ca=document.querySelector("button"+L))?window.getComputedStyle(ca,null):null,!ca||L&&"none"===L.display)if(ca=document.querySelector("button[id='RibbonOverflowMenu-overflow']"),!ca){this.lVa("NoAnchor",this.rea);n.ULS.sendTraceTag(512499844,220,15,"ShowTeachingCalloutToAddinButton failed to get an anchorElement");this.xIa();return}this.sCh(ca,"ShowTeachingUIForAddinButton")}Bvh(L){let ca=document.querySelector("button"+L);if(!ca&&("[data-unique-id='pivotOverflowButton']"!==
L&&(ca=document.querySelector("button[data-unique-id='pivotOverflowButton']")),!ca)){this.lVa("NoAnchor",this.rea);n.ULS.sendTraceTag(512499843,220,15,"ShowTeachingCalloutToAddinTab failed to get an anchorElement");this.xIa();return}this.sCh(ca,"ShowTeachingUIForAddinTab")}sCh(L,ca){L.setAttribute("lpp-id","latestAddin");const X=Bc.a.instance.Ja("Common.ISystemInitiatedFeedback");X&&L?(this.lVa("Show",this.rea),X.execute(qb=>{qb.logActivity(ca,null)}),n.ULS.sendTraceTag(512499841,220,50,"TriggerLPPActivity triggered an LPP activity")):
(this.lVa("NoSifFutureObject",this.rea),n.ULS.sendTraceTag(512499842,220,15,"TriggerLPPActivity failed to get a sifFuture"),this.xIa())}s1i(L){if(!L||!L.T$||!L.T$.rF)return null;for(let ca of L.T$.rF)if(ca)for(const X of ca.groups)if(X)for(const qb of X.controls){if(qb&&qb.attributes&&0===qb.controlType&&qb.enabled)return qb.id;if(qb.menuItems)for(const Rb of qb.menuItems)if(Rb.attributes&&Rb.enabled)return qb.id}return null}lVa(L,ca){Ze.kVa(L,this.qQ(ca))}uAb(L,ca){ca=Telemetry.PrivacyRules.GetPrivacyCompliantId(ca.solutionId,
ca.storeType,ca.assetId,null,null,ca.storeId);Ze.kVa(L,ca)}k_a(L){const ca={};ca[this.S1c]=fa.c({["LastTeachingUIShowTime"]:(new Date).toUTCString(),["AddinHasShown"]:L});(new F(this.S1c,null,null,Object(u.a)(this,this.W$,"postRequestFailureCallback"))).Jub(ca);n.ULS.sendTraceTag(512499840,306,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service")}W$(L){n.ULS.sendTraceTag(512499811,306,15,"failed to POST data to Roaming Settings Service with status: {0}",
L?L.Te:-1)}xIa(){if(!this.tRg){const L=window.g_roamingAddinList;L&&(this.k_a(L),this.tRg=!0)}}static kVa(L,ca){L={["AppTeachingUICalloutAction"]:L,["SDX.Id"]:ca,["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};Y.a.sendTelemetryEvent(Object.assign(new na.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:O.a.ND(L)}))}}Object(k.a)(Ze,"AddinTeachingCalloutHandler",null,[]);class df{}Object(k.a)(df,"AddinCommandsHost",null,[]);var ve=d(80),md=
d(133);class Kf extends ve.a{constructor(){super(void 0,void 0,void 0,!0);this.SQb="AddinCommandsUILessDialog";this.kLd="WACDialogTitleText";this.aba="0";this.aS=380;this.Zga=190;this.ig=this.SQb;this.xd=5;this.qOh=String.format("{0}px",this.aS);this.$aa=String.format("{0}px",this.Zga);this.oae=this.yr=!1;this.ju()}ju(){super.ju();this.fm.style.width=this.qOh;this.fm.style.height=this.$aa;this.fm.style.padding=this.aba}kya(L){this.tA();document.getElementById(this.Nh(this.kLd)).innerText=L}tA(){super.tA();
this.Gb.style.width=String.format("{0}px",this.aS);this.Gb.style.height=String.format("{0}px",this.Zga);this.Gb.removeAttribute(md.a.af);this.Gb.removeAttribute(md.a.D2)}hide(){this.dbe()}get lja(){return this.fm}initializeAndShowWithTitle(){this.$i(CommonUIStrings.l_NotificationUITitle,null,null)}}Object(k.a)(Kf,"AddinCommandsUILessDialog",ve.a,[1087]);var oe=d(40),Hf=d(159),xb=d(37),hg=d(331);class rf extends df{constructor(L,ca,X,qb){super();this.hF=!!C.AFrameworkApplication.Aa&&!!C.AFrameworkApplication.Aa.hb&&
C.AFrameworkApplication.Aa.hb.bX;this.W9=L;this.Zc=ca;this.o5c=X;this.ofb=qb}setOwnerAddinEToken(L){this.W9.eToken=L}showTaskpane(L,ca,X){n.ULS.sendTraceTag(509699670,220,50,String.format("ShowTaskpane action called."));this.Ccg(L,ca,X,!0)||n.ULS.sendTraceTag(509699669,806,10,String.format("ShowTaskpane : instance id is null."))}showDialog(){}createUILessSandbox(L,ca,X){n.ULS.sendTraceTag(509699668,220,50,String.format("UILess action called."));this.Ccg(L,ca,X,!1,this.o5c)||n.ULS.sendTraceTag(509699667,
806,10,String.format("UILess : instance id is null."))}disposeHost(){}Ccg(L,ca,X,qb,Rb=!1){var Qc=this.Zc.mQ(L.solutionId);Qc||(Qc=this.Zc.bXi(L,ca,this.W9.solutionId,Rb));if(Qc&&this.Zc.aua(Qc.instanceId))return this.Zc.kib(Qc.instanceId),X(Qc.instanceId,0),Rb||this.Zc.MKb(Qc.instanceId,qb),!0;let jd=null;if(!Qc)if(Qc=this.Zc.Jii(L,ca,qb,this.W9.solutionId,Rb),Qc.setValue(xb.a.ownerAddinStoreType,this.W9.storeType),jd=Qc.sa(Hf.a.sharedRuntimeId,null),this.Gog(!!jd,!0),Rb&&(Rb=Rb&&!jd),ca=Rb?new Kf:
null,Rb?this.Zc.Tjb(Qc,ca.lja):(Qc.setValue(oe.a.oYb,qb||!!jd),this.Zc.Cih(Qc)),Qc=this.Zc.mQ(L.solutionId))if(Rb&&this.ofb.$(Qc.instanceId,ca),L=this.Zc.qDa(this.W9.solutionId)){if(L=new hg.a(L),this.Zc.pFh(L.id,Qc.instanceId),jd&&!this.Zc.u3b(L.Exa)&&(L=this.Zc.b4d(L.Exa)))L.Yv||L.G3h(jd),this.Zc.pFc(this.W9.solutionId,L)}else{L=this.Zc.Iii(this.W9,jd);if(!L)return X(null,5001),!1;this.Zc.pFc(this.W9.solutionId,L);this.z_j(!!jd)}else return X(null,5001),!1;X(Qc.instanceId,0);this.hF&&(X=this.Zc.aua(Qc.instanceId),
this.Zc.MKb(Qc.instanceId,X?qb:!0));this.Gog(!!jd,!1);return!0}Gog(L,ca){L&&window.performance&&window.performance.memory&&n.ULS.sendTraceTag(509699666,802,50,"Shared runtime memory usage: before={0}, jsHeapSizeLimit={1}, totalJSHeapSize={2}, usedJSHeapSize={3}",ca,window.performance.memory.jsHeapSizeLimit,window.performance.memory.totalJSHeapSize,window.performance.memory.usedJSHeapSize)}z_j(L){n.ULS.sendTraceTag(509699665,802,50,"PPT WAC add-in created: SolutionId: {0}, StoreType: {1}, IsShareRuntime: {2}",
Telemetry.PrivacyRules.GetPrivacyCompliantId(this.W9.solutionId,this.W9.storeType,this.W9.assetId,null,null,this.W9.storeId),this.W9.storeType,L)}}Object(k.a)(rf,"WACPowerPointAddInCommandsHost",df,[]);var nf=d(186);class kd{constructor(L,ca,X,qb,Rb,Qc,jd,vd,Xd,Ke,jf){this.hH=this.xUg=null;if(!L)throw Error.argumentNull("app");this.ala=new R;this.csg=X;this.Qb=L.rr;this.ve=jd;this.Zc=ca;this.bla=Qc;this.Zc.v9h(Object(u.a)(this,this.qsi,"clearLoadingAddinMessage"));this.ala.H7h(Object(u.a)(this,this.Ioj,
"handleAddinCommandsLoadingMessageChanged"));this.Ga=qb;this.Yb=Rb;db.a.r7b=db.a.mah;this.ofb=new Ob.a;this.ABb=Xd;this.hl=Ke;this.g5j=new e.a;this.kBb=new e.a;this.Lc=jf}get Kd(){return this.Zc}A0c(L){n.ULS.sendTraceTag(512499869,220,50,"LaunchOperationType {0}.",L[Q.a.A7]);if(this.Ga.C9b||!this.Ga.tia){var ca=L[Q.a.aGc];if(ca&&0<ca.count){const qb=ca.count;for(let Rb=qb-1;0<=Rb;Rb--){const Qc=ca.ga(Rb);OSF.OsfControl.isFirstPartyStoreString(Qc.storeType)||ca.remove(ca.ga(Rb))}ca.count<qb&&(this.Ga.C9b&&
!this.hl.uda(22)&&this.hl.SCa(22),this.Ga.tia||this.hl.uda(36)||this.hl.SCa(36));if(!ca.count)return}}let X=null;X=C.AFrameworkApplication.fa.ka("HostInstallAddInsIsEnabled")?new Ad(this.bla,this.csg,new bc(this.Zc.vl),new $c("",od.a.F5a),this.ala,fd.instance,new Bd,(qb,Rb)=>{const Qc={};Qc.solutionId=qb.solutionId;Qc.version=qb.version;Qc.storeType=qb.storeType;Qc.storeId=qb.storeId;Qc.assetId=qb.assetId;Qc.assetStoreId=qb.assetStoreId;this.Zc.Ehl(Qc,()=>{Rb(qb)})}):new Ad(this.bla,this.csg,new bc(this.Zc.vl),
new $c("",od.a.F5a),this.ala,fd.instance,new Bd);X.T7h(Object(u.a)(this,this.hmk,"onAutoLaunchAddin"));X.G7h(Object(u.a)(this,this.Wpk,"onLaunchAddinCommandsCompleted"));this.Yb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",!1)&&(ca=new Ze(this,this.Yb,this.Lc),X.C8h(Object(u.a)(ca,ca.Vpk,"onLaunchAddinButtonClicked")),X.U$h(Object(u.a)(ca,ca.gfl,"showCalloutOnAddin")));try{ic.a.get_instance().Dk(5,null).continueWith(()=>{X.yXj(this.ABb,qd.App.Kb.AF(),L)},
11)}catch(qb){n.ULS.sendTraceTag(512499868,220,10,String.format("LaunchAddinCommands error message : {0}.",qb.message))}}Goj(L){L=L[this.bla.sQa];L=(new Pd).EMd(L);return C.AFrameworkApplication.tia||OSF.OsfControl.isFirstPartyStoreString(L.ownerAddinInfo.storeType)}x6b(L){const ca=new Pd;this.A$d(ca,L[this.bla.sQa])}A$d(L,ca){const X=L.EMd(ca),qb=new rf(X.ownerAddinInfo,this.Zc,this.Ga.tka,this.ofb);L.x6b(ca,this.ala,qb,new bc(this.Zc.vl),X)}Bch(L){const ca=lf.hHk(this.ala);L[id.a.LabelText]=ca.labelText;
L[id.a.Visible]=ca.visible}Uel(){this.LWe()}YLb(L){L&&Q.a.zOd in L&&L[Q.a.zOd]&&wb.lWe(L[Q.a.zOd].toString())}UNk(){if(this.ala.V0c()){this.ala.RCf();const L=this.g4d();if(L&&0<L.count)for(let ca of L)this.VJb({["ack1"]:ca,["ack0"]:4,["ak0"]:(new Date).getTime()})}else this.Yb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)&&(n.ULS.sendTraceTag(509669719,220,50,"refreshAllAddinCommands: LoadingCompleteForAllProviders() returns {0}",this.ala.V0c()),this.Z$(10,
!0),this.Z$(0,!0))}Ioj(){this.ve.sz(new nf.a(2));this.LWe()}HGk(L){L&&Q.a.B7 in L?this.Z$(L[Q.a.B7],!0):n.ULS.sendTraceTag(509669718,220,10,"queryAddinDetailsWithActionData: invalid actionData.")}Z$(L,ca=!1){this.Zc?(n.ULS.sendTraceTag(509669716,220,50,"QueryAddinDetails: providerType: {0}, refreshRequired: {1}",L,ca),this.Zc.Z$(L,ca)):n.ULS.sendTraceTag(509669717,220,10,"QueryAddinDetails: abort because m_appForOfficeManager is null.")}VJb(L){n.ULS.sendTraceTag(512499867,220,50,"Launch AddinCommands entitlements list, LaunchOperationType {0}, DataProvider {1}.",
L[Q.a.A7],L[Q.a.B7]);this.ala.G4k();window.setTimeout(()=>{const ca=new Ja(new bc(this.Zc.vl),fd.instance,ub.instance);ca.F7h((X,qb)=>{this.Yb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)&&this.Z$(L[Q.a.B7]);this.A0c(qb.properties)});ca.W$h((X,qb)=>{this.hH=qb;this.xUg=new Ze(this,this.Yb,this.Lc);this.xUg.CQk(this.hH)});ca.Oul(L)},0)}qsi(){this.ala.RCf()}dgi(L){var ca=this.Zc.mQ(L);if(ca&&ca.Yv&&ca.Yv.Xxa&&!(0>=ca.Yv.state)){var X=new Pd,qb=X.getTaskPaneControlIdFromSolutionIdRuntimeId(L,
ca.Yv.Xxa);qb&&(this.Zc.pFc(L,ca),this.A$d(X,qb),this.Zc.WDf(L),(ca=this.Zc.mQ(L+qb))?this.Zc.setInitialDisplayMode(ca.instanceId,1):n.ULS.sendTraceTag(512499866,802,10,"Failed to find auto-loaded shared runtime pane for "+L))}}hgi(L){if(L&&L.solutionId){var ca=new Pd,X=ca.igi;if(X=L.solutionId in X?X[L.solutionId]:null){let qb=this.Zc.mQ(L.solutionId);if(!qb){qb=this.Zc.b4d(L.solutionId);if(!qb){n.ULS.sendTraceTag(512499864,220,15,String.format("AutoShowTaskPane appForOffice is null for {0}",Telemetry.PrivacyRules.GetPrivacyCompliantId(L.solutionId,
L.storeType,L.assetId,null,null,L.storeId)));return}this.Zc.pFc(L.solutionId,qb)}L=qb.settings;(L=Q.a.$sf in L?L[Q.a.$sf]:null)&&"true"===L.toLowerCase()&&this.A$d(ca,X)}}else n.ULS.sendTraceTag(512499865,220,10,"LaunchAddInCommands AutoShowTaskPane failed. Invalid solution id.")}Rbl(L){if(void 0===L||null===L||void 0===L[this.bla.sQa]||null===L[this.bla.sQa])return!1;L=L[this.bla.sQa];return ka.a.Wa(L)?!1:this.kBb.contains(L)}L8k(L){L=L.T$;if(!L)n.ULS.sendTraceTag(512499863,220,15,"Ribbon Extensibility for React ribbons should not be null.");
else if(L.rF)for(let ca of L.rF)if(ca.groups)for(const X of ca.groups)if(X.controls)for(const qb of X.controls)if(this.uZe(qb.id,qb.enabled),1===qb.controlType&&qb.menuItems)for(const Rb of qb.menuItems)this.uZe(Rb.id,Rb.enabled)}uZe(L,ca){if(L&&L.length){var X=this.kBb.contains(L);X&&ca&&this.kBb.remove(L);X||ca||this.kBb.add(L)}}Nxl(L){let ca=null,X=null,qb=!0;void 0!==L[Q.a.o_d]&&null!==L[Q.a.o_d]&&void 0!==L[this.bla.sQa]&&null!==L[this.bla.sQa]&&void 0!==L[Q.a.m_d]&&null!==L[Q.a.m_d]&&(ca=L[Q.a.o_d],
X=L[this.bla.sQa],qb=L[Q.a.m_d]);ka.a.Wa(ca)||ka.a.Wa(X)||(L=(new ab("",ca,this.bla,!0)).HDa(X),this.uZe(L,qb),this.Qb.updateCommandUI())}V2b(L){if(void 0!==L&&null!==L&&void 0!==L[Q.a.n_d]&&null!==L[Q.a.n_d])switch(L[Q.a.n_d]){case 1:this.Nxl(L);break;case 4:this.kBb.clear(),this.kBb.addRange(this.g5j)}}hmk(L,ca){if(ca)if(ca)if(L=ca.Au,ca=ca.NJ,!Qa()&&!la()||this.Zc.b4d(L.solutionId)){var X=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap();(ca=L.solutionId in X?X[L.solutionId]:
this.f5i(ca))?(this.x6b({["SourceControlId"]:ca}),L.isAutoLaunched=!0):n.ULS.sendTraceTag(512499860,220,15,"addinCommandControlId is null")}else n.ULS.sendTraceTag(512259016,220,15,String.format("AppForOffice is null for {0}",Telemetry.PrivacyRules.GetPrivacyCompliantId(L.solutionId,L.storeType,L.assetId,null,null,L.storeId)));else n.ULS.sendTraceTag(512499861,220,15,"agaveParams is null");else n.ULS.sendTraceTag(512499862,220,15,"No args for OnAutoLaunchAddin event")}f5i(L){if(!L)return n.ULS.sendTraceTag(512499859,
220,10,"Failed to get button id for addin"),null;L=L.T$;if(!L||!L.rF||!L.rF.count)return n.ULS.sendTraceTag(512499858,220,15,"It has 0 or multiple tabs"),null;L=L.rF.ga(0);if(!L.groups||1!==L.groups.length)return n.ULS.sendTraceTag(512499857,220,15,"It has 0 or multiple groups"),null;L=L.groups[0];if(!L.controls||1!==L.controls.length)return n.ULS.sendTraceTag(512499856,220,15,"It has 0 or multiple buttons"),null;L=L.controls[0];return L.attributes&&0===L.controlType&&L.enabled?L.id:null}Wpk(L,ca){let X=
null;ca&&(X=ca);X&&X.NJ&&this.L8k(X.NJ);X?(X.Au&&this.dgi(X.Au.solutionId),this.Ga.VGj&&window.setTimeout(()=>{X.Au&&this.hgi(X.Au)},0)):n.ULS.sendTraceTag(512499855,220,10,String.format("OnLaunchAddinCommandsCompleted EventArgs is null."))}g4d(){const L=new e.a;this.Ga.Qta&&(this.Ga.Uge&&L.add(0),this.Yb.ka("187")&&L.add(1),this.Yb.ka("305")&&L.add(10),L.add(8));return L}LWe(){const L=document.querySelector("[data-unique-id='ShowAddInCommandsLoadStatusCallout']");lf.jvh(this.ala,this.Qb.AF(),L,ResourceStrings.L_Insert,
CommonUIStrings.L_ButtonOfficeAddins)}Iqc(L){L&&this.ofb.Hb(L)&&this.ofb.ga(L).initializeAndShowWithTitle()}n7b(L){L&&this.ofb.Hb(L)&&this.ofb.ga(L).hide()}}Object(k.a)(kd,"AddinCommandsManager",null,[1056]);class If{constructor(){this.cUg={["tabhome"]:"PptRibbon.Home",["tabinsert"]:"PptRibbon.InsertTab",["tabdesign"]:"PptRibbon.Design",["tabtransitions"]:"PptRibbon.Transition",["tabanimations"]:"PptRibbon.Animation",["tabview"]:"PptRibbon.View"};this.WEg={["tabslideshow"]:["PptRibbon.SlideShow",
ResourceStrings.l_SlideShowTab,CommonUIStrings.l_SlideShowTabKeytip],["tabreview"]:["PptRibbon.Review",ResourceStrings.L_ReviewTab,CommonUIStrings.l_ReviewTabKeytip],["tabdeveloper"]:["PptRibbon.Developer",ResourceStrings.l_DeveloperTab,CommonUIStrings.l_DeveloperTabKeytip],["tabaddins"]:["PptRibbon.AddIns",ResourceStrings.l_AddInsTab,CommonUIStrings.l_AddInsTabKeytip]};this.x7c=null}get sQa(){return"SourceControlId"}get jT(){return"Presentation"}get formFactor(){return"DesktopFormFactor"}tbj(){if(!this.x7c){this.x7c=
{};for(const L of Object.keys(this.cUg))this.x7c[L]=this.cUg[L];for(const L of Object.keys(this.WEg))this.x7c[L]=this.WEg[L][0]}}}Object(k.a)(If,"AddinCommandsStringProvider",null,[1055]);class og{constructor(L){this.Pyi=L}d0i(){return this.Pyi.Xii()}}Object(k.a)(og,"ContextMenuExtensibilityHandler",null,[1054]);var pf=d(79),ig=d(34);class Oe{constructor(L,ca,X,qb){this.mwe=null;this.Zc=L;this.uUg=ca;this.pa=X;this.Lg=qb}get S$b(){return this.mwe}set S$b(L){this.mwe=L}register(){this.pa.GG(Object(u.a)(this,
this.Emd,"selectionChangeEventHandler"));ig.a("ExtensibilitySlideSelectionChangedEventFix")&&this.Lg.Hqb(Object(u.a)(this,this.Emd,"selectionChangeEventHandler"))}dispose(){this.pa.Nxa(Object(u.a)(this,this.Emd,"selectionChangeEventHandler"));ig.a("ExtensibilitySlideSelectionChangedEventFix")&&this.Lg.pkd(Object(u.a)(this,this.Emd,"selectionChangeEventHandler"))}Emd(){try{this.S$b&&this.uUg.Rg(this.S$b),this.mwe=new pf.a(4,1,0,()=>{this.S$b=null;this.vsl()},90,"50"),this.uUg.Eb(this.S$b)}catch(L){n.ULS.sendTraceTag(18442309,
802,10,L.toString())}}vsl(){try{this.Zc.wdh(OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent.toString(),null);const ca=this.pa.sk();if(ca){var L=ca.Pk();if(L)for(const X of L)if(X.Cq){const qb=new hg.a(X);this.Zc.DZa(OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent.toString(),qb.id,null)}}}catch(ca){n.ULS.sendTraceTag(18442310,802,10,ca.toString())}}}Object(k.a)(Oe,"AppForOfficeApiSelectionChangeEventListener",null,[1046,106]);var Ag=d(541),ce=d(986),me=d(717);class Je{}Je.generalException=
"generalException";Je.invalidArgument="invalidArgument";Je.notAllowed="notAllowed";Je.apiNotAvailable="apiNotAvailable";Je.unresolvedPendingRequest="unresolvedPendingRequest";Je.timeout="timeout";Je.adalTimeout="adalTimeout";Je.userNotSignedIn="userNotSignedIn";Je.userAborted="userAborted";Je.silentSignInFailed="silentSignInFailed";Je.invalidResourceUrl="invalidResourceUrl";Je.invalidGrant="invalidGrant";Je.connectionLost="connectionLost";Je.clientError="clientError";Je.serverError="serverError";
Object(k.a)(Je,"WopiHostErrorCodes",null,[]);var ie=d(224);class Tf{}Object(k.a)(Tf,"OAuthCallerMetadata",null,[]);var He=d(54);class Sg{constructor(L){this.XL=L;this.XPh=C.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AppForOfficeSSOV2MSA",!1)}d3h(L,ca,X,qb,Rb,Qc){if(!this.XL)return qb=new ce.a,qb.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,Promise.resolve(qb);const jd=new Tf;jd.AddinName=Rb;jd.AddinTrustId=Qc;let vd=-1;Qc=null;if(qb&&this.khg())Qc=
this.XL.gDh(Q.a.Erd,L,qb,Sg.e3f(Rb),jd);else{const Xd=Date.now();Qc=this.XL.nV(Q.a.Erd,L,jd).then(Ke=>{vd=Date.now()-Xd;const jf=(ca||X)&&"login_required"===Ke.ErrorCode;return(ca&&("interaction_required"===Ke.ErrorCode||"consent_required"===Ke.ErrorCode||"invalid_grant"===Ke.ErrorCode)||jf)&&this.khg()?this.XL.gDh(Q.a.Erd,L,null,Sg.e3f(Rb),jd):Promise.resolve(Ke)})}return Qc.then(Xd=>{const Ke=new ce.a;Xd.IsSuccess?(Ke.token=Xd.Token,Xd.Telemetry&&(Ke.Ykb=Xd.Telemetry.fromCache,Ke.expiresOn=Xd.Telemetry.expiresOn)):
(Ke.errorCode=this.gfk(Xd),Ke.ZZe=this.wxk(Xd));return Ke}).catch(()=>{const Xd=new ce.a;Xd.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;return Promise.resolve(Xd)}).then(Xd=>{Xd.OBa="OauthManager";0<=vd&&(Xd.b6b=vd);return Xd})}VKj(L){const ca=(C.AFrameworkApplication.fa.Ha(C.AFrameworkApplication.YJ)||"").toLowerCase();return(He.a.zFa||"teams"===ca&&ie.OAuthManagerSettings.t$a)&&!Sg.pKj(L)||!this.XL||!this.XL.PHj()?!1:!0}khg(){return this.XPh||1!==me.a.xQc()}gfk(L){switch(L.ErrorCode){case "UserCancelled":case "interaction_required":L=
OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserAborted;break;case "consent_required":case "invalid_grant":L=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant;break;case "login_required":L=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform;break;case "invalid_client":case "invalid_application_ID":L=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;break;case "invalid_resource":L=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl;break;case "popup_window_error":L=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOConnectionLost;
break;default:L=L.ErrorCode===Je.userAborted?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserAborted:L.ErrorCode===Je.silentSignInFailed?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform:L.ErrorCode===Je.invalidResourceUrl?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl:L.ErrorCode===Je.invalidGrant?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant:L.ErrorCode===Je.connectionLost?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOConnectionLost:OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOServerError}return L}wxk(L){let ca=
"";(L=RegExp("AADSTS(\\d+)").exec(L.ErrorMessage))&&1<L.length&&(ca=L[1]);return ca}static e3f(L){return String.format(CommonUIStrings.l_SSOSignInNeededNotification_Description_Text_Addins,L)}static pKj(L){if(!L)return!1;L=L.toLowerCase();for(const ca of Ag.AppsForOfficeSingleSignOnManager.lPc)if(ca===L)return!0;return!1}}Object(k.a)(Sg,"AppsforOfficeTokenFromOauthManager",null,[1138]);class jc{constructor(L){this.wdk=L}static q1e(){if(C.AFrameworkApplication.fa.ka("AppForOfficeSSOV2IsEnabled")){var L=
null;try{L=Bc.a.instance.resolve("Common.App.OAuth.IOAuthManager")}catch(ca){n.ULS.sendTraceTag(592061330,1300,10,"Unable to resolve IOAuthManager: "+ca)}L=new Sg(L);jc.Ka=new jc(L)}}static getInstance(){jc.Ubf||(jc.q1e(),jc.Ubf=!0);return jc.Ka}}jc.Ka=null;jc.Ubf=!1;Object(k.a)(jc,"AppsForOfficeOauthManagerFactory",null,[1119]);class be{constructor(L){const ca=jc.getInstance();this.Dmf=new Ag.AppsForOfficeSingleSignOnManager(L,ca)}getAccessTokenAsync(L,ca){return new Promise(X=>{const qb=C.AFrameworkApplication.fa.ka("342");
this.Dmf.getAccessToken(L,qb,ca,(Rb,Qc)=>{const jd={};jd.errorCode=Rb;jd.accessToken=Qc?Qc.accessToken:"";X(jd)})})}removeCallbackForAddin(L){this.Dmf.removeCallbackForAddin(L)}}Object(k.a)(be,"AppForOfficeAuthProvider",null,[1076]);class Md{ZAi(L){return new be(L)}}Object(k.a)(Md,"AppForOfficeAuthFactory",null,[999]);var de=d(232),Zc=d(61),Yf=d(46),Vc=d(620);class zc{constructor(L,ca,X,qb,Rb,Qc,jd){this.$ze=this.Zze=this.Ixe=this.Hxe=0;this.fGg=.5;this.JCb=null;this.Fte=0;this.X3j={};this.lfc=document.createElement("div");
this.lfc.className="OsfAddinOverlay";ca.appendChild(this.lfc);X.E6k(this.lfc);this.wek=L;this.uJ=jd;this.uJ.EFc(Object(u.a)(this,this.LGb,"onZoomed"));this.ua=qb;this.Kc=Rb;this.Lq=Qc;this.Lq.$V(Object(u.a)(this,this.uOe,"registerSlideViewElementEvents"))}dispose(){this.uJ.ekd(Object(u.a)(this,this.LGb,"onZoomed"));this.Lq.Una(Object(u.a)(this,this.uOe,"registerSlideViewElementEvents"))}initialize(){if(this.ua.Ba){this.uOe(null,null);const L=this.Kc.Ic;L&&(this.Hxe=parseFloat(L.CU.style.left),this.Ixe=
parseFloat(L.CU.style.top),this.Zze=parseFloat(L.me.xa.style.left),this.$ze=parseFloat(L.me.xa.style.top))}this.X2e();this.LGb(null,new Vc.a(this.wek.zoom))}uOe(L,ca){(L=this.Kc.Ic)&&L!==this.JCb&&(L.dai(Object(u.a)(this,this.zGh,"updateOffsetFromSlideView")),L.d$h(Object(u.a)(this,this.yGh,"updateOffsetFromPageContentContainer")),this.JCb&&(this.JCb.ZUk(Object(u.a)(this,this.zGh,"updateOffsetFromSlideView")),this.JCb.vUk(Object(u.a)(this,this.yGh,"updateOffsetFromPageContentContainer")),this.tZe(this.JCb,
!1)),ca&&ca.g_c&&1!==this.Fte&&this.tZe(L,!0),this.JCb=L)}tZe(L,ca){if(L&&(L=L.Fd)&&L.isConnected){var X=L.Pk();if(X&&X.length)for(const Rb of X)if(Rb.Cq){X=Rb.sa(xb.a.IZ,null);var qb=Zc.a.PE(L.eb(xb.a.sid),L.eb(xb.a.cid)).toString();const Qc=Rb.get_shapeId().toString();X=X+Qc+qb;ig.a("Microsoft.Office.SharedOnline.FixBug6808089")?(qb=Rb.tg(0),(null===qb||void 0===qb?0:qb.xa)?this.wKa(X,ca,qb.xa.ie):this.wKa(X,ca,null)):this.wKa(X,ca,null)}}}e6(L){this.Fte=L;const ca=this.Kc.Ic;ca?(n.ULS.sendTraceTag(512369926,
806,50,"AppForOfficeContentAppsContainer.SwitchToMode: Hide the addin container on active slide('{0}#{1}').",ca.Fd.sid,ca.Fd.cid),this.tZe(ca,2===L)):n.ULS.sendTraceTag(512369925,806,50,"AppForOfficeContentAppsContainer.SwitchToMode: SlideViewElement is null.")}yGh(L,ca){this.Hxe=ca.x;this.Ixe=ca.y;this.X2e()}zGh(L,ca){this.Zze=ca.x;this.$ze=ca.y;this.X2e()}X2e(){this.lfc.style.left=Yf.a.Pc(this.Hxe+this.Zze+de.a.Y5-this.fGg);this.lfc.style.top=Yf.a.Pc(this.Ixe+this.$ze+de.a.Y5-this.fGg)}zHj(L){return L in
this.ora}j0k(L,ca){this.ora[L]=ca}wKa(L,ca,X){1===this.Fte&&ca||L in this.ora&&this.ora[L].wKa(ca,X)}Egh(L){L in this.ora&&(this.ora[L].dispose(),delete this.ora[L])}bTe(L,ca){L in this.ora&&this.ora[L].bTe(ca)}LGb(){}get ora(){return this.X3j}}Object(k.a)(zc,"AppForOfficeContentAppsContainer",null,[1053,106]);var vf=d(398);class Tg extends z.StandardDialog{constructor(L,ca){super();this.GNh=CommonUIStrings.l_AppsforOfficeDeveloperModeCheckboxLabel;this.oQh=CommonUIStrings.l_AppsforOfficeDeveloperModeHelpUrlText;
this.pQh=CommonUIStrings.l_AppsforOfficeDeveloperModeHelpUrl;this.nPh=L;this.RQb=ca}showDialog(L,ca){const X=new ve.a(void 0,void 0,!1);X.xd=0;X.ig=vf.a.pjd(Number.MAX_VALUE).toString();X.qg=String.format("<div style=\ufffdheight:100px;width:400px;border:none;\ufffd><body><p>{0}<a href='{1}'target='_blank'>{2}</a></p><br/><br/><input type='checkbox' id='optInCheckbox'>  {3}</input></body></div>",ca,this.pQh,this.oQh,this.GNh);X.$i(L,Object(u.a)(this,this.Nmk,"onCheckboxExecute$4"),{optInCheckbox:!1})}Nmk(L,
ca){1===L&&ca.optInCheckbox&&(w.a.instance.getItem("optedIntoAddinDeveloperMode")?w.a.instance.removeItem("optedIntoAddinDeveloperMode"):(w.a.instance.setItem("optedIntoAddinDeveloperMode","true"),this.Mqc()))}Mqc(){const L=new z.StandardDialog;L.xd=4;const ca=CommonUIStrings.l_AppsforOfficeL_RegisterDeveloperAddinManifestWarningMessage+String.format(CommonUIStrings.l_AppsForOfficeDeveloperManifestUrl,this.nPh)+CommonUIStrings.l_AppsforOfficeLoadManifestUrl;L.cP(CommonUIStrings.l_AppsforOfficeRegisterDeveloperAddinManifestWarningTitle,
ca,this.RQb)}}Object(k.a)(Tg,"AppForOfficeDeveloperModeOptInDialog",z.StandardDialog,[]);const bb=L=>{const ca=[];if(!L)return ca;ca[OSF.DDA.Marshaling.ThemingKeys.Accent1]=Vb(L.Accent1);ca[OSF.DDA.Marshaling.ThemingKeys.Accent2]=Vb(L.Accent2);ca[OSF.DDA.Marshaling.ThemingKeys.Accent3]=Vb(L.Accent3);ca[OSF.DDA.Marshaling.ThemingKeys.Accent4]=Vb(L.Accent4);ca[OSF.DDA.Marshaling.ThemingKeys.Accent5]=Vb(L.Accent5);ca[OSF.DDA.Marshaling.ThemingKeys.Accent6]=Vb(L.Accent6);ca[OSF.DDA.Marshaling.ThemingKeys.Background1]=
Vb(L.OsfColorScheme?L.OsfColorScheme.Background1:null);ca[OSF.DDA.Marshaling.ThemingKeys.Background2]=Vb(L.OsfColorScheme?L.OsfColorScheme.Background2:null);ca[OSF.DDA.Marshaling.ThemingKeys.Text1]=Vb(L.OsfColorScheme?L.OsfColorScheme.Text1:null);ca[OSF.DDA.Marshaling.ThemingKeys.Text2]=Vb(L.OsfColorScheme?L.OsfColorScheme.Text2:null);ca[OSF.DDA.Marshaling.ThemingKeys.Hyperlink]=Vb(L.Hyperlink);ca[OSF.DDA.Marshaling.ThemingKeys.FollowedHyperlink]=Vb(L.FollowedHyperlink);const X=L.OsfFontScheme;X&&
(ca[OSF.DDA.Marshaling.ThemingKeys.HdEastAsian]=X.HdEaFt,ca[OSF.DDA.Marshaling.ThemingKeys.HdLatin]=X.HdLtnFt,ca[OSF.DDA.Marshaling.ThemingKeys.HdLocalized]=X.HdLclFt,ca[OSF.DDA.Marshaling.ThemingKeys.HdScript]=X.HdSptFt,ca[OSF.DDA.Marshaling.ThemingKeys.BdEastAsian]=X.BdEaFt,ca[OSF.DDA.Marshaling.ThemingKeys.BdLatin]=X.BdLtnFt,ca[OSF.DDA.Marshaling.ThemingKeys.BdLocalized]=X.BdLclFt,ca[OSF.DDA.Marshaling.ThemingKeys.BdScript]=X.BdSptFt);ca[OSF.DDA.Marshaling.ThemingKeys.BackgroundColor]=Vb(L.Background);
return ca},Vb=L=>{if(!L)return null;let ca;ca=L.b;ca+=L.g<<8;return ca+=L.r<<16};class Ub{constructor(L,ca,X){this.kGg=L;this.QQ=ca;this.f6j=X}register(){this.kGg.ik(Object(u.a)(this,this.XAh,"themeChangedCallback"))}dispose(){this.kGg.Cm(Object(u.a)(this,this.XAh,"themeChangedCallback"))}XAh(L,ca){if(ca.node.Sa(xb.a.Ne)&&(ca.property===xb.a.Ne||ca.property===xb.a.Oaa)){L=ca.node;try{var X=bb(L?L.Ne:null)}catch(qb){return}if(L){L=L.Pk();for(const qb of L)qb.Cq&&(L=this.f6j.R2(qb),this.QQ.DZa(OSF.DDA.EventDispId.dispidDocumentThemeChangedEvent.toString(),
L.id,X))}this.QQ.wdh(OSF.DDA.EventDispId.dispidDocumentThemeChangedEvent.toString(),X)}}}Object(k.a)(Ub,"AppForOfficeDocumentThemeListener",null,[1046,106]);var Jc=d(218);class Mc extends ve.a{constructor(L,ca,X){super();this.Mqa=null;this.kLd="WACDialogTitleText";this.aba="0";this.ypa="15px";this.pOh="0px";this.$aa="calc(100% - 30px)";this.oOh="100%";this.fkf=0;this.Oa=new T.a;this.YLh=new I;this.xd=5;this.ig=this.SQb=X;this.Kyd=L;this.J8e=ca;this.lzd=!!C.AFrameworkApplication.fa&&C.AFrameworkApplication.fa.ka("OfficeAddinEnableInsertDialogAccessibilityFix")}f9h(L){this.Oa.addHandler("OnDialogClosedEventKey",
L)}s7k(){this.$pa=null}ju(){super.ju();this.fm.style.width="100%";this.fm.style.height=this.d7b?this.$aa:this.oOh;this.fm.style.marginTop=this.d7b?this.ypa:this.pOh;this.fm.style.padding=this.aba}tA(){super.tA();this.Gb.style.width=String.format("{0}px",this.Kyd*window.innerWidth/100);this.Gb.style.height=String.format("{0}px",this.J8e*window.innerHeight/100);this.Gb.style.minWidth="0px";this.lzd&&C.AFrameworkApplication.isRtl&&100===this.Kyd&&(this.Gb.style.right="0px",this.Gb.style.marginRight=
"0px");this.Mqa=document.getElementById(this.Nh(this.kLd));this.Mqa.style.position="absolute";this.Mqa.style.whiteSpace="nowrap";this.Mqa.style.textOverflow="ellipsis";C.AFrameworkApplication.isRtl?(this.Mqa.style.right="14px",this.Mqa.style.left="44px"):(this.Mqa.style.right="44px",this.Mqa.style.left="14px")}kya(L){super.kya(L);this.Mqa&&this.Mqa.setAttribute("title",L)}get lja(){return this.fm}qQe(){this.Gb.style.width=String.format("{0}px",this.Kyd*window.innerWidth/100);this.Gb.style.height=
String.format("{0}px",this.J8e*window.innerHeight/100);this.Gb.style.overflowY="hidden";this.Gb.style.overflowX="hidden";this.Gb.style.marginTop="";this.Gb.style.top="";He.a.wab&&C.AFrameworkApplication.isRtl?(this.Gb.style.right="",this.Gb.style.marginRight=""):(this.Gb.style.left="",this.Gb.style.marginLeft="")}hide(){this.YLh.cHf(3,this.SQb).execute(this,J.getInstance(),{});this.fkf=window.setTimeout(()=>{this.Oa.raiseEvent("OnDialogClosedEventKey",this.SQb);Jc.a.prototype.hide.call(this)},500)}h4g(L){3===
L&&(window.clearTimeout(this.fkf),this.Oa.raiseEvent("OnDialogClosedEventKey",this.SQb),super.hide())}}Object(k.a)(Mc,"AppsForOfficeDialog",ve.a,[794,795]);class ed{constructor(){this.dialog=this.ig=null}}Object(k.a)(ed,"DialogInfo",null,[]);class dd{}dd.url="url";dd.height="height";dd.width="width";dd.AZd="displayInIframe";dd.uVc="hideTitle";Object(k.a)(dd,"DialogSettings",null,[]);class je{constructor(){this.height=this.width=0;this.ig=this.controlId=this.pageUrl=null;this.uVc=this.AZd=!1}}Object(k.a)(je,
"DisplayDialogParams",null,[]);class Nd extends Sys.EventArgs{constructor(L,ca,X=null,qb="",Rb=""){super();this.controlId=L;this.messageType=ca;this.messageContent=X;this.xCe=qb;this.sLa=Rb}}Object(k.a)(Nd,"OnMessageDialogEventArgs",Sys.EventArgs,[]);class Ld extends Sys.EventArgs{constructor(L,ca,X=null,qb="",Rb=""){super();this.controlId=L;this.messageType=ca;this.messageContent=X;this.xCe=qb;this.sLa=Rb}}Object(k.a)(Ld,"OnMessageParentEventArgs",Sys.EventArgs,[]);var Xe=d(104);class pe{constructor(L){this.Oa=
new T.a;this.TM=L}A9h(L){this.Oa.addHandler("OnMessageParentEventKey",L)}Vhh(L){this.Oa.removeHandler("OnMessageParentEventKey",L)}z9h(L){this.Oa.addHandler("OnMessageDialogEventKey",L)}ZTk(L){this.Oa.removeHandler("OnMessageDialogEventKey",L)}showDialog(L,ca,X,qb){if(pe.npa.Hb(ca))n.ULS.sendTraceTag(18896285,344,100,"ShowDialog: agave dialog map already has dialog info for this control."),X(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);else try{const jf=fa.b(L),wf=jf[dd.url];if(this.TM.getOsfControl(ca).checkAppDomains(wf)){var Rb=
new je;Rb.width=jf[dd.width];Rb.height=jf[dd.height];Rb.pageUrl=wf;Rb.AZd=jf[dd.AZd];Rb.uVc=jf[dd.uVc];Rb.controlId=ca;Rb.ig=Xe.a.create().toString();var Qc=new ed;Qc.ig=Rb.ig;var jd=this.TM.getOsfControl(Rb.controlId).getManifest().getDefaultDisplayName(),vd=this.TM.getOsfControl(Rb.controlId).getStoreType().toLowerCase();L=null;L=(4===C.AFrameworkApplication.Aa.hb.Vk&&"hardcodedpreinstall"===vd||"sdxcatalog"===vd)&&Rb.uVc?this.createAndShowAppsForOfficeDialog(Rb.width,Rb.height,Rb.ig,!0,jd):this.createAndShowAppsForOfficeDialog(Rb.width,
Rb.height,Rb.ig,!1,jd);var Xd=this.TM.getOsfControl(Rb.controlId),Ke=Xd.getManifest();ca={};ca.id=Rb.ig;ca.solutionId=Xd.getSolutionId();ca.version=Xd.getVersion();ca.storeType=vd;ca.storeId=Xd.getStoreId();ca.assetId=Xd.getAssetId();ca.assetStoreId=Xd.getAssetStoreId();ca.ownerAddinSolutionId=Xd.getOwnerAddinSolutionId();ca.ownerAddinStoreType=Xd.getOwnerAddinStoreType();ca.appDomains=Ke.getAppDomains();ca.dialogUrl=wf;ca.osfControlType=1;ca.agaveName=jd;ca.div=L.lja;n.ULS.sendTraceTag(542978531,
344,50,"ShowDialog: asset id {0}, url hash code {1}",Telemetry.PrivacyRules.GetPrivacyCompliantId(ca.solutionId,ca.ownerAddinStoreType||ca.storeType,ca.assetId,null,null,ca.storeId),ka.a.iN(Rb.pageUrl));this.TM.insertDialogControl(ca);L.f9h(Object(u.a)(this,this.Fnk,"onDialogClosed"));Qc.dialog=L;pe.npa.$(Rb.controlId,Qc);qb&&qb(ca);X(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}else n.ULS.sendTraceTag(19940611,344,10,"ShowDialog: dialog url not in app domains list."),X(OSF.DDA.ErrorCodeManager.errorCodes.ooeAppDomains)}catch(jf){n.ULS.sendTraceTag(18371104,
344,10,"ShowDialog: action failed. Exception message: {0}",jf.message),X(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}}ohk(L,ca,X,qb){C.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MessageParentOriginLeaveTargetOrigin",!1)||""===qb&&(qb=X);try{const Rb=this.HDa(L);Rb&&this.Oa.raiseEvent("OnMessageParentEventKey",new Ld(Rb,OSF.DialogMessageType.DialogMessageReceived,ca,X,qb))}catch(Rb){return n.ULS.sendTraceTag(555238219,344,10,"MessageParentOrigin: action failed. Exception message: {0}",
Rb.message),OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}rti(L,ca){if(pe.npa.Hb(L))try{const X=pe.npa.ga(L);X.dialog&&X.dialog.hide();this.TM.purgeDialogControl(X.ig);pe.npa.remove(L);ca(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}catch(X){n.ULS.sendTraceTag(18371106,344,10,"CloseDialog: action failed. Exception message: {0}",X.message),ca(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}else n.ULS.sendTraceTag(18896286,344,10,
"CloseDialog: agave dialog map does not has dialog info for this control."),ca(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}W2k(L,ca,X,qb){C.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SendMessageOriginLeaveTargetOrigin",!1)||""===qb&&(qb=X);if(pe.npa.Hb(L)&&(L=pe.npa.ga(L),L.dialog))try{this.Oa.raiseEvent("OnMessageDialogEventKey",new Nd(L.ig,OSF.DialogMessageType.DialogParentMessageReceived,ca,X,qb))}catch(Rb){n.ULS.sendTraceTag(555045763,344,10,"SendMessageOrigin: action failed. Exception message: {0}",
Rb.message)}}HDa(L){let ca=null;for(let X of pe.npa)if(X.value.ig===L){ca=X.key;break}return ca}Fnk(L,ca){if(L=this.HDa(ca))this.TM.purgeDialogControl(ca),pe.npa.remove(L),this.Oa.raiseEvent("OnMessageParentEventKey",new Ld(L,OSF.DialogMessageType.DialogClosed,null,null,"*"))}createAndShowAppsForOfficeDialog(L,ca,X,qb,Rb){L=new Mc(L,ca,X);Rb=qb?"":String.format(CommonUIStrings.l_ShowDialogApiInlineDialogTitle,Rb);qb&&(L.d7b=!1,L.yr=!1);L.$i(Rb,null,null);L.s7k();return L}static H6f(){return pe.npa}static getInstance(L){pe.Ka||
(pe.Ka=new pe(L));return pe.Ka}}pe.Ka=null;pe.npa=new Ob.a;Object(k.a)(pe,"AppsForOfficeDialogManager",null,[772]);var fe=d(712),wd=d(65),Ue=d(119),rd=d(93),Ud=d(171),qe=d(122);class Nf extends Sys.EventArgs{constructor(L){super();this.Xba=L}}Object(k.a)(Nf,"AppForOfficeFocusOnAddinPaneEventArgs",Sys.EventArgs,[]);var sf=d(47);class tf{constructor(L,ca,X,qb,Rb,Qc){this.PQ=[];this.CBe=new fe.a;this.hF=!!C.AFrameworkApplication.Aa&&!!C.AFrameworkApplication.Aa.hb&&C.AFrameworkApplication.Aa.hb.bX;this.OX=
L;this.G7j=this.OX.firstChild;this.Fa=ca;this.Jr=X;this.ob=qb;this.Zc=Rb;this.ve=Qc}get A2(){return this.PQ}get Kd(){return this.Zc.value}mae(){return 0<this.Pic}OP(L){if(L){this.A2.push(L);var ca=L.xa;ca&&!this.hF&&this.OX.insertBefore(ca,this.G7j);1===this.Pic&&this.Fa.Bj(qe.a.RRd,!0);L.isVisible&&this.Jr.addHandler(L.xa,wd.a.Zf,Object(u.a)(this,this.e9f,"handleShortCutsOnAddinPane"))}}dhh(L){L&&(Array.remove(this.PQ,L),L=L.xa,this.Jr.removeHandler(L,wd.a.Zf,Object(u.a)(this,this.e9f,"handleShortCutsOnAddinPane")),
L&&!this.hF&&this.OX.removeChild(L),this.Pic||this.Fa.Bj(qe.a.RRd,!1))}e6(L){if(1===L||2===L){if(1===L){this.CBe=new fe.a;for(const ca of this.A2)ca.isVisible&&this.CBe.add(ca.id.toLowerCase())}L=2===L;for(const ca of this.A2)this.CBe.contains(ca.id.toLowerCase())&&(ca.yp(L),(L&&1===this.Pic||!L&&!this.Pic)&&this.Fa.Bj(qe.a.RRd,L))}}Lrj(L,ca){for(const X of this.PQ)L=X.layout(L,ca)}zU(L,ca){if(L){L=null;if(ca===sf.a.rg)for(ca=this.PQ.length-1;0<=ca;ca--){if(this.PQ[ca].isVisible){L=this.PQ[ca];break}}else if(ca===
qe.a.izf||ca===qe.a.Tki||ca===Ue.AFrame.UV||ca===Ue.AFrame.F3b||ca===qe.a.J2||ca===qe.a.Yki||ca===sf.a.HE||ca===sf.a.HI||ca===sf.a.DW)for(ca=0;ca<this.PQ.length;ca++)if(this.PQ[ca].isVisible){L=this.PQ[ca];break}this.S2d(L)}}S2d(L){if(L){var ca=this.Kd.dPc(L.id);ca&&this.ve.sIk(new Nf(ca.Xba));this.Kd.notifyAgave(L.id,11)}else n.ULS.sendTraceTag(19014042,806,10,"Focus could not be put on the null addin pane!")}RYi(L,ca){var X;for(X=0;X<this.PQ.length&&this.PQ[X].id!==L;X++);if(X===this.PQ.length)n.ULS.sendTraceTag(19014043,
806,10,String.format("Failed to find the taskpane with instance id: {0}",L)),this.Q0e(ca);else{L=null;if(5===ca)for(--X;0<=X;X--){if(this.PQ[X].isVisible){L=this.PQ[X];break}}else if(6===ca)for(X+=1;X<this.PQ.length;X++)if(this.PQ[X].isVisible){L=this.PQ[X];break}L?this.S2d(L):this.Q0e(ca)}}hVf(L){for(const ca of this.PQ)if(ca.id===L){rd.FocusManager.Sr(ca.yti);return}n.ULS.sendTraceTag(19014044,806,10,String.format("Failed to focus on addinpane's the close button with instance id: {0}",L))}iul(L){for(let ca of pe.H6f())if(ca.value.ig.toLowerCase()===
L.toLowerCase())return ca.value.dialog.hide(),ca.key;return null}Q0e(L){5===L?this.Fa.cTa(!1):6===L&&this.Fa.cTa(!0)}DRf(){const L=this.ob.Xd();L&&1===L.length&&(this.ob.selectShape(L[0],!0),this.Fa.Ed())}get Pic(){let L=0;for(const ca of this.A2)ca.isVisible&&L++;return L}e9f(L){if(L.keyCode===Ud.a.cZ&&L.ctrlKey)for(var ca=0;ca<this.A2.length;ca++){var X=this.A2[ca];if(X.isVisible&&X.xa.contains(L.target)){X=null;if(L.shiftKey)for(ca+=1;ca<this.A2.length;ca++){if(this.A2[ca].isVisible){X=this.A2[ca];
break}}else for(--ca;0<=ca;ca--)if(this.A2[ca].isVisible){X=this.A2[ca];break}X&&(this.S2d(X),L.preventDefault(),L.stopPropagation());break}}}xf(L){this.Fa.xf(L)}}Object(k.a)(tf,"AppForOfficeFocusManager",null,[1052]);var Lf=d(941);class kf{yBi(L,ca,X){L=Lf.a.X4f(L.Qgb);L.appName=OSF.AppName.PowerpointWebApp;L.clientMode=1;L.formFactor="DefaultSettings";L.hostControl=ca;ca=Bc.a.instance.resolve("PowerPointWebEditor.IAppForOfficeManager");L.allowExternalMarketplace=L.allowExternalMarketplace&&ca.b0b;
X.register(L);X=new OSF.ContextActivationManager(L);X.setWSA(C.AFrameworkApplication.jj);return X}}Object(k.a)(kf,"AppForOfficeImportedClassFactory",null,[1051]);class Ed{constructor(L){this.cqg=L}iOe(){for(const L of this.cqg)L.register()}dispose(){for(const L of this.cqg)L.dispose()}}Object(k.a)(Ed,"AppForOfficeListenerManager",null,[1050,106]);var Cd=d(1187),oh=d(1188),Kg=d(156),ri;(function(L){L[L.myAddins=0]="myAddins";L[L.adminManaged=1]="adminManaged";L[L.popular=2]="popular"})(ri||(ri={}));
Object(k.b)("AddinCollectionType",ri);class Af{constructor(){this.AUP=this.priority=0}}Object(k.a)(Af,"AddinDetailInfo",null,[]);class Zg{constructor(){this.sMb=null;this.errorCode=0;this.failure=null}}Object(k.a)(Zg,"AddinCollection",null,[]);class gi extends Sys.EventArgs{constructor(L,ca){super();this.WXb=L;this.C7=ca}}Object(k.a)(gi,"AddinDetailsRefreshedEventArgs",Sys.EventArgs,[]);class jg{constructor(L){this.errorCode=L;this.C7=[];this.failure=null}}Object(k.a)(jg,"GetAddinDetailsResult",null,
[]);var Hh=d(693);class hj{}Object(k.a)(hj,"GetEntitlementDetailsParameters",null,[]);var Hk=d(190),yd=d(210),ef=d(6);class yh{constructor(L,ca,X=null){this.Oa=new T.a;this.mpa=new Cd.a(oh.a.jp());this.OH=new Kg.a;this.aHd=null;this.vBd="https://store-images.s-microsoft.com";this.kKd=new yd.a;this.kKd.add(OSF.StoreTypeEnum.MarketPlace,0);this.kKd.add(OSF.StoreTypeEnum.PrivateCatalog,1);this.$a=L;this.TM=ca;this.c2a=X;if(this.$a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DescriptionInTooltipEnabled",
!1)||this.$a.isChangeGateEnabled("Microsoft.Office.SharedOnline.CustomizablePopularAddinsEnabled"))this.vBd=this.Y9i(L,this.vBd);this.Srf(Object(u.a)(this,this.yEe,"onAddinDetailsRefreshed"))}get vl(){return this.TM.value}e4b(L){if(!this.Sge(L))return L=Error.create("AddinDetails is not ready yet",{["errorCode"]:1,["collectionType"]:ri[L]}),Object.assign(new jg(1),{failure:L});if(this.OH.ga(L).failure)return Object.assign(new jg(this.OH.ga(L).errorCode),{failure:this.OH.ga(L).failure});n.ULS.shipAssertTag(509870082,
220,!!this.OH.ga(L).sMb,"_addinCollectionDict[{0}].SolutionIds must be valid when the collectionType is ready.",L);const ca=new jg(0);for(let X of this.OH.ga(L).sMb)this.mpa.Hb(X)&&Array.add(ca.C7,this.mpa.ga(X));return ca}t1i(L){return this.mpa.Hb(L)?this.mpa.ga(L):null}RPk(L){if(L){this.Srf(L);for(let X of this.OH.keys)if(this.Sge(X)&&!this.OH.ga(X).failure){n.ULS.shipAssertTag(509870081,220,!!this.OH.ga(X).sMb,"_addinCollectionDict[{0}].SolutionIds must be valid when the collectionType is ready.",
X);var ca=[];for(let qb of this.OH.ga(X).sMb)Array.add(ca,this.mpa.ga(qb));ca=new gi(X,ca);L(null,ca)}}}Z$(L,ca=!1){0!==L&&10!==L?n.ULS.sendTraceTag(509870080,220,50,"QueryAddinDetails: skipping providerType: {0}.",Hh.a[L]):this.GGk(L,Object(u.a)(this,this.Frk,"onQueryAddinDetailsCompleted"),ca)}Srf(L){this.Oa.addHandler(Q.a.ctf,L)}Frk(L,ca,X){if(X)if(yh.S1j(L,X,window.performance.now()-ca),0===X.errorCode){let Rb;if(X.value){let Qc=0;Rb=Array(X.value.length);X.value.forEach(jd=>{Rb[Qc++]=jd})}else Rb=
[];this.M_g(L,Rb)}else if(-1===X.errorCode||10===X.errorCode)this.M_g(L,[]);else{var qb={};qb.collectionType=ri[L];qb.invokeResultCode=X.errorCode;qb["queryResult.Value"]=X.value?String.format("Length: {0}",X.value.length):"null";qb.queryStart=ca;qb.queryDuration=window.performance.now()-ca;this.OH.$(L,Object.assign(new Zg(L),{errorCode:3,failure:Error.create("QueryAddinDetails hit an invocation failure",qb)}));n.ULS.sendTraceTag(512231324,220,10,"OnQueryAddinDetailsCompleted: fail to query add-in details for collectionType '{0}' - failure: {1}; errorInfo: {2}",
ri[L],this.OH.ga(L).failure.toString(),JSON.stringify(this.OH.ga(L).failure))}else qb={},qb.collectionType=ri[L],qb.queryResult=X?"not null":"null",qb.queryStart=ca,qb.queryDuration=window.performance.now()-ca,this.OH.$(L,Object.assign(new Zg(L),{errorCode:3,failure:Error.create("QueryAddinDetails hit an invocation failure",qb)})),n.ULS.sendTraceTag(512231323,220,10,"OnQueryAddinDetailsCompleted: fail to query add-in details for collectionType '{0}' - failure: {1}; errorInfo: {2}",ri[L],this.OH.ga(L).failure.toString(),
JSON.stringify(this.OH.ga(L).failure))}eae(L){const ca={};ca.collectionType=ri[L];this.OH.$(L,Object.assign(new Zg(L),{errorCode:2,failure:Error.create("The store is disabled.",ca)}));n.ULS.sendTraceTag(510253056,220,10,"Fail to query add-in details for collectionType '{0}' - failure: {1}; errorInfo: {2}",ri[L],this.OH.ga(L).failure.toString(),JSON.stringify(this.OH.ga(L).failure))}edl(){return this.Sge(2)?this.$a.isChangeGateEnabled("Microsoft.Office.SharedOnline.RequeryPopularAddins")?!!this.OH.ga(2).failure:
!1:!0}GGk(L,ca,X=!1){n.ULS.sendTraceTag(510248470,220,50,"QueryAddinDetailsInternal: storeType: {0}.",L);L!==OSF.StoreTypeEnum.MarketPlace&&L!==OSF.StoreTypeEnum.PrivateCatalog?n.ULS.shipAssertTag(509753571,220,!1,"Unsupported storeType: {0}",L):(this.edl()&&this.queryStoreDisabled(0,(qb,Rb)=>{Rb?this.eae(2):(qb=window.performance.now(),ca(2,qb,this.iej()))}),this.queryStoreDisabled(L,(qb,Rb)=>{if(qb===OSF.StoreTypeEnum.MarketPlace&&Rb)this.eae(0);else if(qb===OSF.StoreTypeEnum.PrivateCatalog&&Rb)this.eae(1);
else{var Qc=window.performance.now();this.vl.getEntitlementDetails(Object.assign(new hj,{storeType:qb,refresh:X}),jd=>{ca(this.kKd.ga(qb),Qc,jd)})}}))}M_g(L,ca){L=new gi(L,ca);this.Oa.raiseEvent(Q.a.ctf,L)}yEe(L,ca){L=Object.assign(new Zg(ca.WXb),{sMb:new e.a});var X=ca.C7;for(const qb of X)X=qb.solutionId,this.mpa.Hb(X)?this.mpa.$(X,this.Hgk(this.mpa.ga(X),ca.WXb,qb)):this.mpa.add(X,qb),L.sMb.add(X);this.OH.$(ca.WXb,L)}Sge(L){return this.OH.Hb(L)?!!this.mpa:!1}get Mei(){return this.c2a?!this.c2a.AreThirdPartyAddInsAllowed||
this.c2a.AppsForOfficeThirdPartyIsDisabled:!this.$a.ka("AreThirdPartyAddInsAllowed")||this.$a.ka("AppsForOfficeThirdPartyIsDisabled")}get hOj(){return this.c2a?!this.c2a.AppsForOfficeAllowExternalMarketplace:!this.$a.ka("AppsForOfficeAllowExternalMarketplace")}get Qgd(){return this.c2a?this.c2a.PopularAddinDetailsJsonString:this.$a.Ha("PopularAddinDetailsJsonString")}queryStoreDisabled(L,ca){if(this.Mei)ca(L,!0);else if(L===OSF.StoreTypeEnum.MarketPlace&&this.hOj)ca(L,!0);else{const X=yh.Dql(L);if(X){const qb=
window.performance.now();this.vl.queryStoreDisabled(X,Rb=>{n.ULS.sendTraceTag(509679070,220,50,"queryStoreDisabled: storeType: {0}, disabled: {1}, queryStart: {2}, queryDuration: {3}",L,Rb,qb,window.performance.now()-qb);ca(L,Rb)})}else ca(L,!1)}}Hgk(L,ca,X){if(!L)return X;if(!X)return L;if(2===ca)return L.addinInfo=X.addinInfo,L;X.addinInfo=L.addinInfo;return X}iej(){if(this.$a.isChangeGateEnabled("Microsoft.Office.SharedOnline.CustomizablePopularAddinsEnabled")){if(!this.aHd){var L=JSON.parse(this.Qgd);
this.Mdi(L);this.NUf(L);this.aHd=L}return yh.Byf(this.aHd)}L=JSON.parse(this.Qgd);this.NUf(L);return yh.Byf(L)}Mdi(L){const ca=this.Uji();for(var X=0;X<L.length&&0<ca.count;X++){const qb=L[X];if(ca.Hb(qb.solutionId)){let Rb=String.format("Found an override, solutionId: {0}",qb.solutionId);const Qc=ca.ga(qb.solutionId);Qc&&(isNaN(Qc.addinInfo.priority)||(Rb=String.format("{0}; AddinInfo.Priority: update {1} to {2}",Rb,qb.addinInfo.priority,Qc.addinInfo.priority),qb.addinInfo.priority=Qc.addinInfo.priority),
isNaN(Qc.addinInfo.AUP)||(Rb=String.format("{0}; AddinInfo.AUP: update {1} to {2}",Rb,qb.addinInfo.AUP,Qc.addinInfo.AUP),qb.addinInfo.AUP=Qc.addinInfo.AUP),Qc.displayName&&(Rb=String.format("{0}; DisplayName: update {1} to {2}",Rb,qb.displayName,Qc.displayName),qb.displayName=Qc.displayName),Qc.iconUrl&&(Rb=String.format("{0}; DisplayName: update {1} to {2}",Rb,qb.iconUrl,Qc.iconUrl),qb.iconUrl=Qc.iconUrl));ca.remove(qb.solutionId);n.ULS.sendTraceTag(509379136,220,50,"BuildPopularAddinDetailOverrides: {0}.",
Rb)}}for(let qb of ca.keys)X=ca.ga(qb),X.displayName&&X.iconUrl&&X.addinInfo&&(L.push(X),n.ULS.sendTraceTag(509379107,220,50,"BuildPopularAddinDetailOverrides: append an override to pouplar addins: {0}.",JSON.stringify(X)))}Uji(){const L=new Cd.a(oh.a.jp());let ca=this.$a.getStringFeatureGate("Microsoft.Office.SharedOnline.CustomizablePopularAddins","");if(!ca)return L;ca=ca.trim();if(12>=ca.length)return n.ULS.sendTraceTag(509379106,220,10,"BuildPopularAddinDetailOverrides: skipping the overrides: {0}.",
ca),L;n.ULS.sendTraceTag(509379105,220,50,"BuildPopularAddinDetailOverrides: overrideString: {0}.",ca);try{const X=[],qb=ca.split("|");for(let Rb=qb.length-1;0<=Rb;Rb--){const Qc=qb[Rb],jd=Qc.split("\\");if(2>jd.length){X.push(Qc);continue}const vd=this.$xk(jd);vd?L.Hb(vd.solutionId)||L.add(vd.solutionId,vd):X.push(Qc)}0<X.length&&n.ULS.sendTraceTag(509379104,220,10,"BuildPopularAddinDetailOverrides: skipped records: {0}.",X.join("|"));0<L.count&&n.ULS.sendTraceTag(509379103,220,50,"BuildPopularAddinDetailOverrides: {0} valid overrides: {1}.",
L.count,JSON.stringify(ef.toArray(L.values)));return L}catch(X){n.ULS.sendTraceTag(509379102,220,10,"BuildPopularAddinDetailOverrides: failed in parsing the overrideString: {0}; exception: {1}.",ca,X.toString())}return L}$xk(L){const ca={};let X=0;X<L.length&&0<L[X].trim().length&&L[X].trim().toLowerCase().startsWith("wa")&&(ca.solutionId=L[X].trim(),ca.addinInfo=Object.assign(new Af,{priority:Number.NaN,AUP:Number.NaN}),++X<L.length&&0<L[X].trim().length&&(ca.addinInfo.priority=parseInt(L[X].trim())),
++X<L.length&&0<L[X].trim().length&&(ca.addinInfo.AUP=parseInt(L[X].trim())),++X<L.length&&0<L[X].trim().length&&(ca.displayName=L[X].trim()),++X<L.length&&0<L[X].trim().length&&(ca.iconUrl=L[X].trim()));return ca.solutionId?ca:null}NUf(L){for(let ca=0;ca<L.length;ca++)Hk.c(L[ca].iconUrl.toLowerCase(),"http",0)||(L[ca].iconUrl=String.format("{0}/image/apps.{1}",this.vBd,L[ca].iconUrl))}Y9i(L,ca){L=L.Ha("AddinImageStoreServiceUrl");if(!L)return ca;L=L.toLowerCase();return L.startsWith("http://")||
L.startsWith("https://")?L:ca}static S1j(L,ca,X){const qb={};qb.AddinCollectionType=ri[L];qb.ErrorCode=ca.errorCode;qb.AddinCount=ca.value?ca.value.length:0;n.ULS.sendTraceTag(512231322,220,50,"AddinDetailsManager.LogQueryCompletedResult - Time elapsed: {0} ms; fields: {1}",X,JSON.stringify(qb))}static Byf(L){const ca={errorCode:0};ca.value=L;return ca}static Dql(L){return L===OSF.StoreTypeEnum.MarketPlace?"omex":L===OSF.StoreTypeEnum.PrivateCatalog?"excatalog":null}}Object(k.a)(yh,"AddinDetailsManager",
null,[739]);var Bg=d(199),Kd=d(347),Rj=d(569),Ia=d(1185);class nb extends ve.a{constructor(){super();this.$aa="calc(100% - 46px)";this.ypa="15px";this.aba="0";this.VQb="WACDialogPanel";this.aS=695;this.WQb=462;this.Zga="80%";this.JPb=350;this.BMa="100%";this.xd=5;this.ig="AppsForOfficeInsertionDialog";this.lzd=!!C.AFrameworkApplication.fa&&C.AFrameworkApplication.fa.ka("OfficeAddinEnableInsertDialogAccessibilityFix")}ju(){super.ju();this.fm.style.width=this.BMa;this.fm.style.height=this.$aa;this.fm.style.marginTop=
this.ypa;this.fm.style.padding=this.aba}aaa(){this.fm.style.width=this.BMa;this.fm.style.height=this.$aa;this.fm.style.marginTop=this.ypa;this.fm.style.padding=this.aba;this.aS>Jc.a.uR?(this.Gb.style.width=String.format("{0}px",Jc.a.uR),this.Gb.style.overflowX="scroll",C.AFrameworkApplication.isRtl?this.Gb.style.right="0":this.Gb.style.left="0"):(this.Gb.style.width=String.format("{0}px",this.aS),this.Gb.style.overflowX="hidden");this.Gb.offsetHeight>Jc.a.DU||this.WQb+50>Jc.a.DU?(this.Gb.style.height=
String.format("{0}px",Jc.a.DU),this.Gb.style.overflowY="scroll",this.Gb.style.top="0",C.AFrameworkApplication.isRtl?this.Gb.style.right="0":this.Gb.style.left="0",this.lzd||(this.Gb.style.marginTop="-48px"),this.fm.style.minHeight=String.format("{0}px",this.JPb)):(this.Gb.style.overflowY="hidden",this.Gb.style.top="10%",this.Gb.style.height=this.Zga);this.XBa()}XBa(){if(this.Gb){var L=this.Gb.style.zIndex;this.Gb.style.zIndex="-9999";if(this.aS>Jc.a.uR)C.AFrameworkApplication.isRtl?this.Gb.style.marginRight=
"0":this.Gb.style.marginLeft="0";else{const ca=String.format("{0}px",Math.floor(-this.Gb.offsetWidth/2));C.AFrameworkApplication.isRtl?this.Gb.style.marginRight=ca:this.Gb.style.marginLeft=ca;C.AFrameworkApplication.isRtl?this.Gb.style.right="50%":this.Gb.style.left="50%"}this.Gb.style.zIndex=String(L)}else n.ULS.sendTraceTag(19976784,306,10,"_divMessageBox is null in CenterDialog()")}tA(){super.tA();const L=document.getElementById(this.Nh(this.VQb));L.style.width=String.format("{0}px",this.aS);L.style.height=
this.Zga}get lja(){return this.fm}}Object(k.a)(nb,"AppsForOfficeInsertionDialog",ve.a,[734]);class Kb extends ve.a{constructor(L=!0,ca=!0){super();this.$aa="calc(100% - 46px)";this.ypa="15px";this.aba="0";this.VQb="WACDialogPanel";this.aS=695;this.WQb=462;this.Zga="80%";this.JPb=350;this.BMa="100%";this.h9e="auto";this.i9e="5px";this.j9e="auto";this.f9e="40px";this.g9e="100px";this.k9e="200px";this.xd=5;this.ig="SDXDialog";this.czc=L;this.d7b=ca}ju(){super.ju();this.fm.style.width=this.BMa;this.fm.style.height=
this.$aa;this.fm.style.marginTop=this.ypa;this.fm.style.padding=this.aba}aaa(){this.fm.style.width=this.BMa;this.fm.style.height=this.czc?this.$aa:"100%";this.fm.style.marginTop=this.czc?this.ypa:"0px";this.fm.style.padding=this.aba;this.czc?(this.aS>Jc.a.uR?(this.Gb.style.width=String.format("{0}px",Jc.a.uR),this.Gb.style.overflowX="scroll",C.AFrameworkApplication.isRtl?this.Gb.style.right="0":this.Gb.style.left="0"):(this.Gb.style.width=String.format("{0}px",this.aS),this.Gb.style.overflowX="hidden"),
this.Gb.offsetHeight>Jc.a.DU||this.WQb+50>Jc.a.DU?(this.Gb.style.height=String.format("{0}px",Jc.a.DU),this.Gb.style.overflowY="scroll",this.Gb.style.top="0",C.AFrameworkApplication.isRtl?this.Gb.style.right="0":this.Gb.style.left="0",this.fm.style.minHeight=String.format("{0}px",this.JPb)):(this.Gb.style.overflowY="hidden",this.Gb.style.top="10%",this.Gb.style.height=this.Zga),this.XBa()):(this.Gb.style.left=this.h9e,this.Gb.style.right=this.i9e,this.Gb.style.top=this.j9e,this.Gb.style.bottom=this.f9e,
this.Gb.style.width=this.k9e,this.Gb.style.height=this.g9e,this.Gb.style.overflowX="hidden",this.Gb.style.overflowY="hidden")}XBa(){if(this.Gb){var L=this.Gb.style.zIndex;this.Gb.style.zIndex="-9999";if(this.aS>Jc.a.uR)C.AFrameworkApplication.isRtl?this.Gb.style.marginRight="0":this.Gb.style.marginLeft="0";else{const ca=String.format("{0}px",Math.floor(-this.Gb.offsetWidth/2));C.AFrameworkApplication.isRtl?this.Gb.style.marginRight=ca:this.Gb.style.marginLeft=ca;C.AFrameworkApplication.isRtl?this.Gb.style.right=
"50%":this.Gb.style.left="50%"}this.Gb.style.zIndex=String(L)}else n.ULS.sendTraceTag(524892188,306,10,"_divMessageBox is null in CenterDialog()")}tA(){super.tA();const L=document.getElementById(this.Nh(this.VQb));L.style.width=String.format("{0}px",this.aS);L.style.height=this.Zga}get Vyb(){return this.czc}get lja(){return this.fm}y5k(L,ca,X,qb){this.h9e=L;this.i9e=ca;this.j9e=X;this.f9e=qb}z5k(L,ca){this.g9e=L;this.k9e=ca}}Object(k.a)(Kb,"SDXDialog",ve.a,[]);class dc extends ve.a{constructor(L,
ca,X,qb){super();this.$aa="calc(100% - 46px)";this.ypa="15px";this.aba="0";this.VQb="WACDialogPanel";this.aS=695;this.WQb=462;this.Zga="80%";this.JPb=350;this.BMa="100%";this.iNa=null;this.xd=5;this.ig="AddinInstallDialog";this.EMh=L;this.nba=ca;this.H1h=X;this.BWh=qb}ju(){super.ju();this.fm.style.width=this.BMa;this.fm.style.height=this.$aa;this.fm.style.marginTop=this.ypa;this.fm.style.padding=this.aba;document.getElementById(this.Nh("WACDialogButtonPanel")).style.display="none";this.jQa.setAttribute("tabindex",
"0");$addHandler(this.jQa,"keyup",Object(u.a)(this,this.Spk,"onKeyUp"));const L=document.createElement("iframe");L.setAttribute("id","InstallAddinDialog");L.setAttribute("src","about:blank");L.setAttribute("width","100%");L.setAttribute("height","100%");L.setAttribute("marginHeight","0");L.setAttribute("marginWidth","0");L.setAttribute("frameBorder","0");L.setAttribute("sandbox","allow-scripts allow-forms allow-same-origin ms-allow-popups allow-popups");const ca=String.format("https://inclient.store.office.com/gyro/clientstore/flyoutdetails/{0}?client={1}&ui={2}&rs={2}",
this.EMh,this.nba,this.H1h);L.setAttribute("src",ca);this.iNa=L;$addHandler(L,"load",Object(u.a)(this,this.onLoad,"onLoad"));$addHandler(window,"message",Object(u.a)(this,this.onMessage,"onMessage"));this.fm.appendChild(L);this.fm.appendChild(this.sCi())}sCi(){const L=document.createElement("div");L.setAttribute("tabindex","0");$addHandler(L,"focus",Object(u.a)(this,this.gqk,"onLoopPivotFocus"));return L}Spk(L){13!==L.keyCode&&32!==L.keyCode||this.hide()}gqk(){this.jQa.focus()}onLoad(){this.iNa.focus()}onMessage(L){L=
L.rawEvent;if(L.source===this.iNa.contentWindow&&(L=(L=L.data)?L.split("|"):null)&&0<L.length&&("REFRESH_REQUIRED"===L[0]||"PRELOAD_MANIFEST"===L[0])){w.a.instance.setItem("refreshRequired","true");const ca={};ca.solutionId=L[1];ca.version=dc.Hjk(L[3]);ca.storeType=L[4];ca.storeId=L[5];ca.assetId=L[6];ca.targetType=dc.jyk(L[2]);ca.assetStoreId=L[7];ca.width=parseInt(L[8]);ca.height=parseInt(L[9]);this.BWh(ca)}}aaa(){this.fm.style.width=this.BMa;this.fm.style.height=this.$aa;this.fm.style.marginTop=
this.ypa;this.fm.style.padding=this.aba;this.aS>Jc.a.uR?(this.Gb.style.width=String.format("{0}px",Jc.a.uR),this.Gb.style.overflowX="scroll",C.AFrameworkApplication.isRtl?this.Gb.style.right="0":this.Gb.style.left="0"):(this.Gb.style.width=String.format("{0}px",this.aS),this.Gb.style.overflowX="hidden");this.Gb.offsetHeight>Jc.a.DU||this.WQb+50>Jc.a.DU?(this.Gb.style.height=String.format("{0}px",Jc.a.DU),this.Gb.style.overflowY="scroll",this.Gb.style.top="0",C.AFrameworkApplication.isRtl?this.Gb.style.right=
"0":this.Gb.style.left="0",this.fm.style.minHeight=String.format("{0}px",this.JPb)):(this.Gb.style.overflowY="hidden",this.Gb.style.top="10%",this.Gb.style.height=this.Zga);this.XBa()}XBa(){if(this.Gb){var L=this.Gb.style.zIndex;this.Gb.style.zIndex="-9999";if(this.aS>Jc.a.uR)C.AFrameworkApplication.isRtl?this.Gb.style.marginRight="0":this.Gb.style.marginLeft="0";else{const ca=String.format("{0}px",Math.floor(-this.Gb.offsetWidth/2));C.AFrameworkApplication.isRtl?this.Gb.style.marginRight=ca:this.Gb.style.marginLeft=
ca;C.AFrameworkApplication.isRtl?this.Gb.style.right="50%":this.Gb.style.left="50%"}this.Gb.style.zIndex=String(L)}else n.ULS.sendTraceTag(509871430,306,10,"_divMessageBox is null in CenterDialog()")}tA(){super.tA();const L=document.getElementById(this.Nh(this.VQb));L.style.width=String.format("{0}px",this.aS);L.style.height=this.Zga}get lja(){return this.fm}dispose(){super.dispose();$removeHandler(window,"message",Object(u.a)(this,this.onMessage,"onMessage"))}static jyk(L){switch(L){case "1":return 0;
case "2":return 1;default:return 0}}static Hjk(L){const ca=L.split(".");for(let X=0;X<4-ca.length;X++)L+=".0";return L}}Object(k.a)(dc,"AddinInstallDialog",ve.a,[]);var Ic=d(174);class Id{constructor(L,ca,X){this.Dxb=L;this.onSuccess=ca;this.onError=X;$addHandler(window,"message",Object(u.a)(this,this.F6b,"handleResponse"))}F6b(L){try{if(L&&L.rawEvent&&L.rawEvent.origin&&this.Dxb&&this.Dxb.id){var ca=this.R8g(L.rawEvent.origin);const X=this.R8g(document.domain);if(oh.a.jp().equals(X,ca))if(L.rawEvent.source&&
L.rawEvent.source.frameElement&&L.rawEvent.source.frameElement.id&&oh.a.jp().equals(L.rawEvent.source.frameElement.id,this.Dxb.id)){ca=null;try{ca=JSON.parse(L.rawEvent.data)}catch(qb){n.ULS.sendTraceTag(39112971,344,50,"AuthenticationProxy.HandleResponse: The received response is malformed or not intended for the privateCatalogIframe: {0}",qb.message)}ca?(ca.statusCode!==Ic.a.Ey||void 0!==ca.error&&ca.error?(n.ULS.sendTraceTag(23707648,344,50,"Authentication proxy returned a result but the operation failed. statusCode '{0}', Error: '{1}'",
ca.statusCode,ca.error),this.onError()):(n.ULS.sendTraceTag(23705827,344,100,"Received response from authentication proxy."),this.onSuccess(ca.authorizationCode?ca.authorizationCode:ca.signInUrl)),$removeHandler(window,"message",Object(u.a)(this,this.F6b,"handleResponse")),this.Dxb?document.body.contains(this.Dxb)?document.body.removeChild(this.Dxb):n.ULS.sendTraceTag(24978499,344,15,"The iframe is not a child of Body."):n.ULS.sendTraceTag(24978500,344,15,"The iframe is null.")):n.ULS.sendTraceTag(575976219,
344,50,"AuthenticationProxy.HandleResponse: this was not our message, just wait for right one.")}else n.ULS.sendTraceTag(51451614,344,50,"AuthenticationProxy ResponseHandler skipped processing for event. Event does not originate from expected iFrame.");else n.ULS.sendTraceTag(51451613,344,50,"AuthenticationProxy ResponseHandler skipped processing for event. Failed validate event origin.")}else n.ULS.sendTraceTag(51418200,344,50,"AuthenticationProxy ResponseHandler skipped processing for event.")}catch(X){n.ULS.sendTraceTag(23707649,
344,10,"Exception in authentication proxy message handler: {0}.",X.message)}}R8g(L){let ca="";try{L&&(ca=-1<L.indexOf("//")?L.split("/")[2]:L.split("/")[0])&&(ca=ca.split(":")[0],ca=ca.split("?")[0])}catch(X){n.ULS.sendTraceTag(51451615,344,10,"Failed to parse host name from url: {0}",X.message)}return ca}static Tx(L,ca,X){new Id(L,ca,X)}}Object(k.a)(Id,"ResponseHandler",null,[]);var ae=d(222);class Od{constructor(L){this.Qqa=L}tryAuthenticate(L,ca){this.wgd(Od.bSh,()=>{L()},ca)}tryAuthorize(L,ca){this.wgd(Od.NMh,
L,ca)}getSignInUrl(L,ca){this.wgd(Od.Bmf,L,ca)}signOut(L,ca){this.wgd(Od.I_h,L,ca)}wgd(L,ca,X){var qb=new ae.QueryStringBuilder("AuthenticationProxyHandler.aspx");qb.Ki("responseType",L);C.AFrameworkApplication.gPa(qb);qb=String.format("{0}{1}&{2}",this.Qqa,qb.toString(),C.AFrameworkApplication.jh);const Rb=document.createElement("iframe");Rb.setAttribute("id","privateCatalogIframe");Rb.setAttribute("name","privateCatalogIframe");Rb.setAttribute("style","display: none");oh.a.jp().equals(L,Od.Bmf)||
Rb.setAttribute("sandbox","allow-scripts allow-forms allow-same-origin allow-popups allow-pointer-lock");Id.Tx(Rb,ca,X);Rb.setAttribute("src",qb);document.body.appendChild(Rb)}}Od.NMh="authcode";Od.bSh="identitytoken";Od.Bmf="signinurl";Od.I_h="signout";Object(k.a)(Od,"AuthenticationProxy",null,[]);class Hd{}Hd.getUserId="getUserId";Hd.getLastStoreUpdate="laststoreupdate";Hd.getEntitlement="getEntitlements";Hd.getEToken="getEToken";Hd.getManifest="getManifest";Hd.getAppState="getAppState";Hd.getKilledApps=
"getRemovedAddins";Hd.getAppDetails="getAppDetails";Hd.removeApps="removeAddin";Hd.getLastPrivateCatalogUpdate="getLastPrivateCatalogUpdate";Hd.getPrivateCatalogAddIns="getAddIns";Hd.getPrivateCatalogManifests="getAppManifests";Hd.isStoreDisabled="isStoreDisabled";Object(k.a)(Hd,"S2SWebRequestActions",null,[]);var Bf=d(519);class Of{getUserId(L,ca){const X=new e.a;X.add(new La.a("corr",L));this.Gx(Hd.getUserId,X,1,ca)}getLastStoreUpdate(L,ca,X){const qb=new e.a;qb.add(new La.a("lc",L));qb.add(new La.a("corr",
ca));this.Gx(Hd.getLastStoreUpdate,qb,1,X)}getEntitlement(L,ca,X,qb){L=new e.a;L.add(new La.a("av",ca));L.add(new La.a("corr",X));this.Gx(Hd.getEntitlement,L,1,qb)}getEToken(L,ca,X,qb,Rb,Qc){const jd=new e.a;jd.add(new La.a("cmu",L));jd.add(new La.a("cmf",ca));jd.add(new La.a("assetid",X));jd.add(new La.a("expver",qb));jd.add(new La.a("corr",Rb));this.Gx(Hd.getEToken,jd,1,Qc)}getManifest(L,ca,X,qb){const Rb=new e.a;Rb.add(new La.a("cmu",L));Rb.add(new La.a("assetid",ca));Rb.add(new La.a("corr",X));
this.Gx(Hd.getManifest,Rb,1,qb)}getAppState(L,ca,X){const qb=new e.a;qb.add(new La.a("ma",L));qb.add(new La.a("corr",ca));this.Gx(Hd.getAppState,qb,1,X)}getKilledApps(L,ca){const X=new e.a;X.add(new La.a("corr",L));this.Gx(Hd.getKilledApps,X,1,ca)}getAppDetails(L,ca,X,qb){const Rb=new e.a;Rb.add(new La.a("cmo",L));Rb.add(new La.a("corr",X));this.sendWithBody(Hd.getAppDetails,Rb,ca,2,qb,!1)}removeApps(L,ca,X){const qb=new e.a;qb.add(new La.a("corr",ca));this.sendWithBody(Hd.removeApps,qb,L,2,X,!1)}getLastPrivateCatalogUpdate(L,
ca,X,qb,Rb,Qc){const jd=new e.a;jd.add(new La.a("catalog","privatecatalog"));jd.add(new La.a("clientCode",L));jd.add(new La.a("clientVersion",ca));jd.add(new La.a("corr",Rb));L=String.format("authorizationCode={0}&refreshToken={1}",X?ka.a.Ke(X):"",qb?ka.a.Ke(qb):"");this.sendWithBody(Hd.getLastPrivateCatalogUpdate,jd,L,2,Qc,!0)}getPrivateCatalogAddIns(L,ca,X,qb,Rb,Qc){const jd=new e.a;jd.add(new La.a("catalog","privatecatalog"));jd.add(new La.a("clientCode",L));jd.add(new La.a("clientVersion",ca));
jd.add(new La.a("corr",Rb));L=String.format("authorizationCode={0}&refreshToken={1}",X?ka.a.Ke(X):"",qb?ka.a.Ke(qb):"");this.sendWithBody(Hd.getPrivateCatalogAddIns,jd,L,2,Qc,!0)}getPrivateCatalogManifests(L,ca,X,qb,Rb){const Qc=new e.a;Qc.add(new La.a("catalog","privatecatalog"));Qc.add(new La.a("corr",qb));L=String.format("extensionIds={0}&authorizationCode={1}&refreshToken={2}",ka.a.Ke(L),ca?ka.a.Ke(ca):"",X?ka.a.Ke(X):"");this.sendWithBody(Hd.getPrivateCatalogManifests,Qc,L,2,Rb,!0)}isStoreDisabled(L,
ca){const X=new e.a;X.add(new La.a("corr",L));this.Gx(Hd.isStoreDisabled,X,2,ca)}Gx(L,ca,X,qb){this.sendWithBody(L,ca,null,X,qb,!1)}sendWithBody(L,ca,X,qb,Rb,Qc){const jd=new ae.QueryStringBuilder("AddinServiceHandler.ashx");jd.Ki("action",L);jd.Ki("app",Bf.a[C.AFrameworkApplication.Aa.hb.Vk]);for(let vd of ca)jd.Ki(vd.key,vd.value);ca=String.format("{0}{1}&{2}",C.AFrameworkApplication.Aa.hb.Vma,jd.toString(),C.AFrameworkApplication.jh);C.AFrameworkApplication.Je.Aj(ca,qb,X,null,!1,2,vd=>{let Xd=
null,Ke=null;vd&&vd.data&&(vd.data.rj["X-BlockedForMinor"]&&"1"===vd.data.rj["X-BlockedForMinor"].toString()&&(vd.data.Te=451),Xd=vd.data.Zd,Ke=vd.data.rj);Rb(vd.data.Te,Xd,Ke)},vd=>{var Xd=null;let Ke=null;Qc&&vd&&vd.data&&vd.data.Zd&&(Xd=vd.data.Zd,Ke=vd.data.rj);Rb(vd.data.Te,Xd,Ke);if(C.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OEP.AddinServiceHandlerTelemetry",!0)){Xd={message:"AddinServiceHandler request failed"};Xd.code=vd.data.Te;Xd.action=L;if(vd.data.request||
vd.data.request.get_headers())Xd["X-UserSessionId"]=vd.data.request.get_headers()["X-UserSessionId"];408===vd.data.Te||503===vd.data.Te?n.ULS.sendTraceTag(538784582,220,10,JSON.stringify(Xd)):n.ULS.sendTraceTag(18392345,220,50,JSON.stringify(Xd))}else n.ULS.sendTraceTag(538736349,220,50,"S2S web request failed with {0}.",vd.data.Te)},null,void 0,void 0,void 0,void 0,"AddinServiceHandler_"+L,void 0,void 0,void 0,["X-UserKey"])}}Object(k.a)(Of,"S2SWebRequestManager",null,[]);var ph=d(30),Qh=d(82);class Lg{constructor(L,
ca){this.state=L;this.Xxa=ca}}Object(k.a)(Lg,"BackgroundAppData",null,[1093]);class Fg{constructor(L,ca,X,qb,Rb,Qc,jd,vd){this.Xba=null;this.V3j=L;this.Yck=qb;this.nE=ca;this.hu=X;this.rgc=Rb;this.settings=Qc;this.Y3j=jd;this.Yv=vd}get ap(){return this.V3j}get taskpane(){return this.Yck}get instanceId(){return this.nE}get shape(){return this.hu}get Tw(){return this.Y3j}G3h(L){this.Yv=new Lg(0,L)}}Object(k.a)(Fg,"AppForOffice",null,[1048]);var dg=d(29);class hi{}hi.c_Error="Error";Object(k.a)(hi,"ApiResponseKeyStrings",
null,[]);class Mg{constructor(L,ca,X,qb,Rb){this.EventDispId=L;this.ControlId=ca;this.TargetId=X;this.Handler=qb;this.Callback=Rb}}Object(k.a)(Mg,"EventRegistrationParams",null,[]);var ne=d(26);class Bh{constructor(L,ca){this.invokeDdaMethod=this.InvokeDdaMethod;this.registerDdaEventAsync=this.RegisterDdaEventAsync;this.zb=C.AFrameworkApplication.we;this.bxe=L;this.Nug=ca}InvokeDdaMethod(L,ca,X){const qb=L.DdaMethod.DispatchId,Rb=this.bxe.Z1i(qb);Rb?(Rb.parameters=L,Rb.callback=ca,Rb.Sai=X,Rb.controlId=
L.DdaMethod.ControlId,this.zb.Eb(new pf.a(2,1,0,Object(u.a)(Rb,Rb.go,"go"),90,"51"))):(L="API Call for method ID "+qb+" does not exist:"+dg.Debug.Ot(),ne.a.J(8958091,802,10,L),this.xSd(ca))}RegisterDdaEventAsync(L,ca,X,qb,Rb){const Qc=new pf.a(2,1,0,Object(u.a)(this,this.cPk,"registerEventTaskProcess"),90,"52");Qc.customData=new Mg(L,ca,X,qb,Rb);this.zb.Eb(Qc)}UnregisterDdaEventAsync(L,ca,X,qb,Rb){const Qc=new pf.a(2,1,0,Object(u.a)(this,this.qwl,"unregisterEventTaskProcess"),90,"53");Qc.customData=
new Mg(L,ca,X,qb,Rb);this.zb.Eb(Qc)}cPk(L){L=L.customData;var ca=this.Nug.Z3d(L.EventDispId);ca?ca.addHandler(L.ControlId,L.Handler,L.Callback,L.TargetId):(ca="Event for dispatch ID "+L.EventDispId+" does not exist:"+dg.Debug.Ot(),ne.a.J(8958093,802,10,ca),this.xSd(L.Callback))}qwl(L){L=L.customData;var ca=this.Nug.Z3d(L.EventDispId);ca?ca.removeHandler(L.ControlId,L.Handler,L.Callback,L.TargetId):(ca="Event for dispatch ID "+L.EventDispId+" does not exist:"+dg.Debug.Ot(),ne.a.J(8958095,802,10,ca),
this.xSd(L.Callback))}xSd(L){if(L){var ca={};ca[hi.c_Error]=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;L(ca)}}}Object(k.a)(Bh,"AppForOfficeApiAdapter",null,[1123]);class Vh{constructor(L,ca,X,qb){this.menuItemId=L;this.XU=ca;this.Tll=X;this.IVi=qb}}Object(k.a)(Vh,"NewDocumentParameters",null,[]);var ij=d(575),Ij=d(128),Yj=d(139),ii=d(42),Wh=d(51),Zj=d(75),Hi=d(31),$i=d(38),Ai=d(49),si=d(39),Ni=d(32),ak=d(56);class Sj{constructor(L,ca,X){this.Keb=[];this.T3c=this.DBb=!1;this.ta=L;this.PF=
ca;this.gz=X}build(){const L=this.ta.WD();if(!L)return this.Keb;for(const ca of L)if(this.zFk(ca),this.T3c)break;return this.Keb}zFk(L){const ca=Hi.ParagraphReader.textLength(L);this.AFk(L,ca);this.T3c||this.fFk(L)}AFk(L,ca){this.DBb||(this.PF>=ca?this.PF-=ca:(this.DBb=!0,this.gz||this.Keb.push(Ai.a.Kj(Object(ha.a)(Qh.a,L),this.PF))));this.DBb&&(this.gz>ca-this.PF?0<ca&&(this.Keb.push(Ai.a.createTextRange(Object(ha.a)(Qh.a,L),this.PF,ca)),this.gz-=ca-this.PF,this.PF=0):0<this.gz&&(this.Keb.push(Ai.a.createTextRange(Object(ha.a)(Qh.a,
L),this.PF,this.PF+this.gz)),this.gz=0));0>=this.gz&&(this.T3c=!0)}fFk(L){this.DBb||(0<this.PF?--this.PF:(this.DBb=!0,this.gz||this.Keb.push(Ai.a.zQa(Object(ha.a)(Qh.a,L)))));this.DBb&&0<this.gz&&(this.Keb.push(Ai.a.oca(Object(ha.a)(Qh.a,L))),--this.gz);0>=this.gz&&(this.T3c=!0)}}Object(k.a)(Sj,"TextSelectionBuilder",null,[]);var ti=d(980),Ii=d(28);class bg{constructor(L,ca,X,qb,Rb,Qc,jd,vd,Xd,Ke,jf,wf,eg,Ng,Ug,Ah,We,lk,jm,Kh,$d,xk,Ie){this.Ga=L;this.Yb=ca;this.eJ=X;this.jfc=qb;this.pa=Rb;this.cJ=
Qc;this.d7c=jd;this.Jb=vd;this.ia=Xd;this.ua=jf;this.Vb=Ke;this.Sb=wf;this.jc=eg;this.S3j=Ng;this.ob=Ug;this.Fb=Ah;this.Tk=We;this.Ea=lk;this.Pb=jm;this.Tdb=Kh;this.Hh=$d;this.Hu=xk;this.m$j=Ie}$gj(){let L;L="";if(this.ob.bH()){if(1<this.ob.Bmd())return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeGetSelectionNotMatchDataType,Soc:L};const ca=this.ob.Jp();if(this.ETj(ca)){const X=[];this.Ea.DJ(ca,qb=>{qb&&X.push(qb.characterData)});L=X.join(bg.Yzf);return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,
Soc:L}}}else if(this.ob.pC())return this.getSelectedTextRange();return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeGetSelectionNotMatchDataType,Soc:L}}Wgj(){let L;L="";return{returnValue:({BXe:L}=this.getSelectedSlides()).returnValue,n2k:L}}Wvb(){return this.eJ.Qgb.documentUrl}Xnj(L){if(!L)return OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotNavTo;var ca=this.Sb.Lj();if(!this.ua.Ba)throw Error.argumentNull("ActiveSlide is null");const X=this.ua.Ba.oe;switch(L){case "previous":L=X-1;break;case "next":L=
X+1;break;case "first":L=0;break;case "last":L=ca-1;break;default:if(L=parseInt(L),isNaN(L))return OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotNavTo}if(0>L||L>ca-1)return OSF.DDA.ErrorCodeManager.errorCodes.ooeNavOutOfBound;ca=this.Sb.mC(L);if(!ca)return OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotNavTo;this.Vb.Ba=ca;return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}Ynj(L){if(!L)return OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotNavTo;L=parseInt(L);if(isNaN(L))return OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotNavTo;
L=this.P8d(L);if(!L)return OSF.DDA.ErrorCodeManager.errorCodes.ooeSpecifiedIdNotExist;this.Vb.Ba=L;return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}d9k(L){var ca=this.ob.Xd();if(!ca.length){if(ca=Object(ha.a)(116,this.ob.sk()||this.ua.Ba)){var X=ca.Cb;L=this.Tk.RWd(X.cid,X.sid,ca.Pt()+1,L,"");X=this.Jb.zd(7);X.nc(ca);ca.UB(L);this.ob.selectShape(L,!0);X.dispose();this.Hu.NF=L;return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}}else if(1===ca.length){if(this.ob.bH())return this.d$k(L);if(this.ob.pC())return this.e$k(L)}return OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotWriteToSelection}Z8k(L,
ca,X,qb,Rb,Qc,jd){if(this.vOc(Rb,0,bg.Rlb)||this.vOc(Qc,0,bg.Rlb)||this.vOc(X,-bg.Rlb,bg.Rlb)||this.vOc(qb,-bg.Rlb,bg.Rlb)||0!==jd&&1!==jd)return OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam;if(L.length>this.Ga.pptEditorAppsForOfficeImageMaxSizeInBytes)return OSF.DDA.ErrorCodeManager.errorCodes.ooeSetDataIsTooLarge;var vd=this.ob.Xd().length;if(ca||Rb||Qc||!vd){vd=this.ua.Ba;if(!vd)throw Error.argumentNull("ActiveSlide is null");const Xd=vd.Cb,Ke=vd.Pt();let jf=!0,wf=new ak.a(0,0);ca?wf=new ak.a(X,
qb):!this.Ga.QBk||Rb&&Qc?wf=this.Sb.pta(Rb,Qc):jf=!1;ca=this.Tk.$ra(!1,Xd.cid,Xd.sid,0,ij.a.AH(wf.x),ij.a.AH(wf.y),ij.a.AH(Rb),ij.a.AH(Qc),Ke+1,!0);jf||(ca.ao($i.a.qy),ca.ao($i.a.ry));ca.Ej=!0;ca.Bpd=!0;ca.Sy=jd;ca.kka=0===jd?this.AHf(L):L;ca.oyb=!0;L=this.Jb.zd(7);try{this.Ga.qT&&(L.jd=Ii.a.Jqf),L.nc(vd),vd.UB(ca),this.ob.selectShape(ca,!0)}finally{L&&L.dispose()}this.Hu.NF=ca;return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}if(1===vd&&(vd=this.ob.Jp())&&vd.kIc){ca=this.ua.Ba;if(!ca)throw Error.argumentNull("ActiveSlide is null");
X=this.H9a(ca,vd);X.Ej=!0;X.Sy=jd;X.kka=0===jd?this.AHf(L):L;X.oyb=!0;L=this.Jb.zd(7);try{L.nc(ca),ca.KU([vd]),ca.UB(X),this.ob.selectShape(X,!0)}finally{L&&L.dispose()}this.Hu.NF=X;return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}ne.a.J(512263113,802,10,"No placehoder seleted or multi-shape seleted.");return OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotWriteToSelection}tka(){return this.Ga.tka}DHj(){return this.Yb.ka("342")}j7i(L){if(!L)return null;L=this.S3j.R2(L);L=0===L.Tw?L.node:this.ua.Ba;
if(!L)return null;L=Object(ha.a)(115,this.jc.mg(L));return bb(L.Ne)}ORe(L,ca){if(L&&ca)if(ig.a("UseUndoTransactionForSaveSettingToApp")){var X=this.Jb.zd(15,void 0,void 0,void 0,!0);try{X.nc(L),X.jd=Ii.a.Txb,ti.a.oFh(this.d7c.value,L,ca)}finally{X&&X.dispose()}}else{X=this.Jb.zd(4);try{X.nc(L),ti.a.oFh(this.d7c.value,L,ca),this.Vb.yi.Jfa()}finally{X&&X.dispose()}}}h7a(L,ca,X){const qb=new z.StandardDialog;qb.xd=4;qb.Bx(CommonUIStrings.l_GeneralAddInMessageDialogTitle,CommonUIStrings.l_NewFileAPIConsentMessage,
1,Rb=>{2===Rb||0===Rb?X(OSF.DDA.ErrorCodeManager.errorCodes.ooeOperationCancelled):(Rb=new Vh("blank","agave",L?bg.bjk:bg.cjk,L),this.m$j.create(ca,X,Rb).h7a())})}We(){return this.ob.We()}Xd(){return this.ob.Xd()}dhj(){var L=this.ob.Xd();if(!(L.length&&this.ob.pC()&&this.pa.value&&this.pa.value.Pa.length))return[];const ca=this.pa.value.Pa.ga(0);return(L=bg.bfj(L[0],ca))&&2===L.length?L:[]}Sul(L){if(!L)return!1;this.ob.Utb();if(!L.length)return!0;L[0]!==this.ua.Ba&&(this.Vb.Ba=L[0]);for(const ca of L)ca&&
this.ob.J5a(ca);return!0}Rul(L){if(!L)return!1;if(!L.length)return this.ob.Qh(),!0;this.ob.s_a(L,!0);return!0}Tul(L,ca,X){if(!bg.ukg(L))return!1;if(0>ca)return!0;L=(new Sj(L,ca,X)).build();L=[new Ij.Selection(L,!0)];L=new Yj.SelectionCollection(L,0);this.ob.ME(L);return!0}getSelectedSlides(){let L;L="";var ca=null;if(!ca||!ca.length){var X=this.ob.sk()||this.ua.Ba;ca||(ca=[]);X&&ca.push(X)}if(!ca.length)return ne.a.J(512263111,802,10,"Unexpected error: cannot get current slide."),{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,
BXe:L};X=[];for(const qb of ca){ca=qb.oe+1;if(!ca)return ne.a.J(512263110,802,10,"Returned slide index is invalid."),{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,BXe:L};Array.add(X,[qb.sid.toString(),qb.title||"",ca.toString()])}L=fa.c(X);return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,BXe:L}}getSelectedTextRange(){var L=[];for(let ca=0;ca<this.pa.value.Pa.length;ca++){const X=this.pa.value.Pa.ga(ca);Array.add(L,this.jTc(X))}L=L.join(bg.Yzf);if(L===Zj.AParagraphNode.f_)return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeGetSelectionNotMatchDataType,
Soc:L};L=Zj.AParagraphNode.$jd(L);return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,Soc:L}}ETj(L){if(!L)return!1;let ca=L.nua||L.lx||L.Rf||L.ud;if(!ca&&L.gl)switch(L.Gj){case 0:case 2:case 1:case 3:case 10:case 8:ca=!0}return ca}FTj(L){if(!L)return!1;let ca=L.nua||L.lx;if(!ca&&L.gl)switch(L.Gj){case 0:case 2:case 1:case 3:case 8:ca=!0}return ca}jTc(L){let ca="";if(L)for(let X=0;X<L.length;X++){const qb=L.ga(X),Rb=qb.Qa,Qc=qb.Nb-Rb;let jd="";Hi.ParagraphReader.Yd(qb.node)&&(jd=qb.node.characterData);
switch(qb.contextId){case si.a.paragraph:ca+=jd+"\r";break;case si.a.textRange:0<Qc&&(ca+=jd.substr(Rb,Qc));break;case si.a.endOfParagraph:ca+="\r"}}return ca}P8d(L){var ca=this.ua.presentation;if(!ca)throw Error.argumentNull("Presentation is null");ca=ca.slides||[];for(let X=0;X<ca.length;X++)if(ca[X].Cb.sid===L)return Object(ha.a)(116,ca[X]);return null}e$k(L){if(!this.pa.value||!this.cJ.value||!this.jfc.value)return OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;if(1===this.pa.value.Pa.length){if(!ii.SelectionEditor.gx(this.pa.value.Pa.mb)&&
32!==this.ia.processAction(Ni.a.JCa,2))return OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;var ca=this.pa.value.Pa.mb.Ua;const X=ca.node,qb=ca.Qa;ca=ca.Nb;const Rb=this.Jb.zd(7);try{Rb.nc(X);let Qc=null;Qc=qb===ca?Ai.a.Kj(X,qb):Ai.a.createTextRange(X,qb,ca);this.cJ.value.replaceTextRange(Qc,L)}finally{Rb.dispose()}ca=qb+L.length;this.pa.value.setSelection(Wh.SelectionFactory.V2(X,qb,ca));return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}ne.a.J(512263107,802,10,"SetTextForSelectedTextRange is called when there are more than one shape selected.");
return OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotWriteToSelection}d$k(L){if(!this.pa.value||!this.cJ.value||!this.jfc.value)return OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;const ca=this.ob.Jp();if(!ca)return L="Fail to get shape while setting selected shape's text: shape returned as null: "+dg.Debug.Ot(),ne.a.J(512263106,802,10,L),OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;if(this.FTj(ca)){const X=this.Pb.Nc(ca),qb=this.Jb.zd(7);try{qb.nc(X);ca.deleteParagraph();this.jfc.value.JZ(X,
!0);this.Tdb.wi(X);const Rb=X.currentNode,Qc=this.Hh.textLength(Rb),jd=Ai.a.createTextRange(Rb,0,Qc);this.cJ.value.replaceTextRange(jd,L)}finally{qb.dispose()}return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}ne.a.J(512263105,802,10,"Shape is not supported by SetDataAsync");return OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotWriteToSelection}vOc(L,ca,X){return L<ca||X<L}AHf(L){return"data:image/png;base64,"+L}H9a(L,ca){if(!L)return null;var X=L.Cb;L=L.Pt();let qb;const Rb=Fc.a.cY,Qc=Fc.a.h5;qb=
ca?ca.twb(Fc.a.cY,Fc.a.h5):this.Sb.pta(Fc.a.cY,Fc.a.h5);X=this.Tk.$ra(!0,X.cid,X.sid,0,qb.x,qb.y,Rb,Qc,L+1,!0);ca&&(X.eca=ca.id);return X}static ukg(L){if(!L)return!1;let ca=L.nua||L.lx;if(!ca&&L.gl)switch(L.Gj){case 0:case 2:case 1:case 3:case 5:case 6:case 8:ca=!0}return ca}static Okj(L,ca){L=L.WD();if(!L||!ca)return 0;let X=0;for(const qb of L){if(qb===ca)break;X+=Hi.ParagraphReader.textLength(Object(ha.a)(Qh.a,qb))+1}return X}static bfj(L,ca){if(!bg.ukg(L)||!ca)return[];var X=-1;let qb=0;for(let Rb of ca){ca=
Hi.ParagraphReader.Yd(Rb.node)?Hi.ParagraphReader.textLength(Rb.node):0;if(-1===X)switch(X=Hi.ParagraphReader.Yd(Rb.node)?bg.Okj(L,Object(ha.a)(5,Rb.node)):0,Rb.contextId){case si.a.paragraph:break;case si.a.textRange:case si.a.Of:X+=Rb.Qa;break;case si.a.endOfParagraph:X+=ca;break;default:return[]}switch(Rb.contextId){case si.a.paragraph:qb+=ca+1;break;case si.a.textRange:qb+=Math.max(0,Rb.Nb-Rb.Qa);break;case si.a.endOfParagraph:qb+=1}}return[X,qb]}}bg.Yzf=" ";bg.Rlb=169056;bg.cjk="streamEmpty";
bg.bjk="streamBase64";Object(k.a)(bg,"AppForOfficeApiFacadeEditorImpl",null,[1122]);class xa{I8f(L,ca,X){if(X.qDa(L))n.ULS.sendTraceTag(512360733,806,10,"[HandlePersistedOwnerApp]This method should not be invoked when OwnerApp already exists.");else if(L=X.u3b(L)){const qb={};qb.solutionId=L.ap.id;qb.version=L.ap.version;qb.storeType=L.ap.storeType;qb.storeId=L.ap.store;qb.assetId=null;qb.assetStoreId=null;qb.targetType=1;qb.isAddinCommands=!0;qb.addinCommandsActionType=1;qb.sharedRuntimeId=L.Yv?
L.Yv.Xxa:null;qb.backgroundState=L.Yv?L.Yv.state:-1;L.settings=ca;X.rPd.QG().La(Ii.a.pWc,2,qb);return!0}return!1}AHj(L,ca){if(!L&&!ca)return!0;if(!L||!ca||Object.keys(L).length!==Object.keys(ca).length)return!1;for(let Rb in L){var X=Rb,qb=L[Rb];if(!(X in ca)||ca[X]!==qb)return!1}return!0}}Object(k.a)(xa,"AppForOfficeAppSettingProxy",null,[]);class Ma{constructor(L,ca,X,qb){this._id=L;this.p5a=ca;this.o7=X;this.cnf=qb}get id(){return this._id}get version(){return this.p5a}get store(){return this.o7}get storeType(){return this.cnf}}
Object(k.a)(Ma,"AppForOfficeReference",null,[1117]);class $a{constructor(L,ca){this._id=L;this.U_h=ca}get id(){return this._id}get slideId(){return this.U_h}}Object(k.a)($a,"AppForOfficeShape",null,[1118]);class Eb{constructor(L,ca,X,qb,Rb,Qc=null,jd=!1){this.yPh=L;this.y2h=ca;this.s5a=X;this.oZh=qb;this.vGd=Rb;this.isForUILessAction=jd;this.WWh=Qc}get BNf(){return this.yPh}get visibility(){return this.y2h}get width(){return this.s5a}get row(){return this.oZh}get ownerAddinSolutionId(){return this.vGd}get ownerAddinStoreType(){return this.WWh}}
Object(k.a)(Eb,"AppForOfficeTaskpane",null,[1116]);class ac{constructor(L,ca,X,qb=null){this.ddaBinding=null;this.dispid=0;this.ArrayData=this.controlId=null;this.dispid=L;this.controlId=ca;this.ddaBinding=X;this.ArrayData=qb}getDispid(){return this.dispid}getDdaBinding(){return this.ddaBinding}}Object(k.a)(ac,"DdaEventArgs",null,[]);class tc{constructor(L,ca){this.xBb=null;this.Zc=L;this.ia=ca}Z3d(L){this.xBb||this.NAk();if(!L||!this.xBb[L])return null;L=this.xBb[L];L.Kd=this.Zc;L.zn=this.ia;return L}lDf(L){const ca=
this.xBb;for(let X in ca)ca[X].removeHandler(L)}set(L,ca){this.xBb[L]=ca}}Object(k.a)(tc,"ApiEventStore",null,[]);class aa{constructor(){this.yo=this.ia=this.Zc=null;this.Bl={}}get handlers(){return this.Bl}get zn(){return this.ia}set zn(L){this.ia=L}get Kd(){return this.Zc}set Kd(L){this.Zc=L}raiseEvent(L,ca=null){L=this.qta(L);if(ca){var X=this.Bl[ca];X&&X(L)}else for(X in ca=this.Bl,ca){const qb=ca[X];qb&&qb(L)}}addHandler(L,ca,X=null){this.Bl[L]=ca;this.t6a(X)}removeHandler(L,ca,X=null){delete this.Bl[L];
this.t6a(X)}get result(){return this.yo}t6a(L){this.JA(L,OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}JA(L,ca){L&&(this.yo={},this.yo[hi.c_Error]=ca,L(this.yo))}}Object(k.a)(aa,"ApiEvent",null,[1120]);class sa extends aa{constructor(){super()}qta(L){return L}static get instance(){sa.Qp||(sa.Qp=new sa);return sa.Qp}}sa.Qp=null;Object(k.a)(sa,"ActivationStatusChangedEvent",aa,[]);class Oa extends aa{constructor(){super()}qta(){return"view"}static get instance(){Oa.Qp||(Oa.Qp=new Oa);return Oa.Qp}}
Oa.Qp=null;Object(k.a)(Oa,"ActiveViewChangedEvent",aa,[]);var ib=d(103);class Gb extends aa{constructor(){super();this.ioe=null}qta(){return null}get lsa(){!this.ioe&&this.Kd&&(this.ioe=pe.getInstance(this.Kd.vl));return this.ioe}addHandler(L,ca,X=null,qb=null){this.Kd?this.Kd.qu.tka()?L in this.handlers?this.JA(X,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):(n.ULS.sendTraceTag(20247126,802,50,"AddHandler was called."),this.showDialog(L,qb,Rb=>{Rb===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?
(ib.a.count(this.handlers)||this.lsa.A9h(Object(u.a)(this,this.oGe,"onMessageParentEvent")),this.handlers[L]=ca,this.Kd.vl?({value:Rb}=pe.H6f().Uf(L),Rb?(this.Kd.vl.setActivationCompletedStatus(Rb.ig,!0),this.Kd.DZa(OSF.DDA.EventDispId.dispidActivationStatusChangedEvent.toString(),Rb.ig,!0)):n.ULS.sendTraceTag(24463263,806,15,"Show dialog successed but get dialogInfo failed")):n.ULS.sendTraceTag(24463264,806,15,"Show dialog successed but ContextActivationManager is null"),this.t6a(X)):(n.ULS.sendTraceTag(20247127,
806,10,"Show dialog failed. Error code: {0}",Rb.toString()),this.JA(X,Rb))})):this.JA(X,OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported):this.JA(X,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}removeHandler(L,ca,X=null){this.Kd?this.Kd.qu.tka()?L in this.handlers?(n.ULS.sendTraceTag(20247128,802,50,"RemoveHandler was called."),this.lsa.rti(L,qb=>{delete this.handlers[L];ib.a.count(this.handlers)||this.lsa.Vhh(Object(u.a)(this,this.oGe,"onMessageParentEvent"));qb!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&
n.ULS.sendTraceTag(20247129,806,10,"Close dialog failed. Error code: {0}",qb.toString());this.JA(X,qb)})):this.JA(X,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):this.JA(X,OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported):this.JA(X,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}showDialog(L,ca,X){try{this.lsa.showDialog(ca,L,X,null)}catch(qb){n.ULS.sendTraceTag(19535264,806,10,"DialogMessageReceivedEvent: Show dialog failed. Exception message: {0}",qb.message),X(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}}oGe(L,
ca){if(ca.controlId in this.Bl){L={};L[OSF.DDA.Marshaling.Dialog.DialogMessageReceivedEventKeys.MessageType]=ca.messageType;L[OSF.DDA.Marshaling.Dialog.DialogMessageReceivedEventKeys.MessageContent]=ca.messageContent;L[OSF.DDA.Marshaling.Dialog.DialogMessageReceivedEventKeys.MessageOrigin]=ca.xCe;L[OSF.DDA.Marshaling.Dialog.DialogMessageReceivedEventKeys.TargetOrigin]=ca.sLa;const X=this.Bl[ca.controlId];X&&X(L);ca.messageType===OSF.DialogMessageType.DialogClosed&&(delete this.Bl[ca.controlId],ib.a.count(this.Bl)||
this.lsa.Vhh(Object(u.a)(this,this.oGe,"onMessageParentEvent")))}}static get instance(){Gb.Qp||(Gb.Qp=new Gb);return Gb.Qp}}Gb.Qp=null;Object(k.a)(Gb,"DialogMessageReceivedEvent",aa,[]);class Bb extends aa{constructor(){super()}qta(){return null}addHandler(L,ca,X=null){this.Kd?this.Kd.qu.tka()?(ca=this.Kd.Dvb(L))&&ca.taskpane&&ca.taskpane.isForUILessAction?(this.zn.La(od.a.Iqc,2,L),this.t6a(X)):this.JA(X,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):this.JA(X,OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported):
this.JA(X,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}removeHandler(L,ca,X=null){this.Kd?this.Kd.qu.tka()?(ca=this.Kd.Dvb(L))&&ca.taskpane?ca.taskpane.isForUILessAction?(this.zn.La(od.a.n7b,2,L),this.t6a(X)):this.JA(X,OSF.DDA.ErrorCodeManager.errorCodes.ooeNotUILessDialog):this.JA(X,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):this.JA(X,OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported):this.JA(X,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}}Object(k.a)(Bb,
"DialogNotificationShownInAddinEvent",aa,[]);class Cc extends aa{constructor(){super();this.vl=this.WPd=null}qta(){return null}get lsa(){this.WPd||(this.WPd=pe.getInstance(this.contextActivationMgr));return this.WPd}get contextActivationMgr(){!this.vl&&this.Kd&&(this.vl=this.Kd.vl);return this.vl}addHandler(L,ca,X=null){this.Kd&&!this.Kd.qu.tka()?this.JA(X,OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported):L in this.Bl?this.JA(X,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):(ib.a.count(this.Bl)||
this.lsa.z9h(Object(u.a)(this,this.c4g,"onMessageDialogEvent")),this.Bl[L]=ca,this.JA(X,OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess))}removeHandler(L,ca,X=null){this.Kd&&!this.Kd.qu.tka()?this.JA(X,OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported):L in this.Bl?(delete this.Bl[L],ib.a.count(this.Bl)||this.lsa.ZTk(Object(u.a)(this,this.c4g,"onMessageDialogEvent")),this.JA(X,OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)):this.JA(X,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}c4g(L,
ca){ca.controlId in this.Bl&&(L={},L[OSF.DDA.Marshaling.Dialog.DialogParentMessageReceivedEventKeys.MessageType]=ca.messageType,L[OSF.DDA.Marshaling.Dialog.DialogParentMessageReceivedEventKeys.MessageContent]=ca.messageContent,L[OSF.DDA.Marshaling.Dialog.DialogParentMessageReceivedEventKeys.MessageOrigin]=ca.xCe,L[OSF.DDA.Marshaling.Dialog.DialogParentMessageReceivedEventKeys.TargetOrigin]=ca.sLa,(ca=this.Bl[ca.controlId])&&ca(L))}static get instance(){Cc.Qp||(Cc.Qp=new Cc);return Cc.Qp}}Cc.Qp=null;
Object(k.a)(Cc,"DialogParentMessageReceivedEvent",aa,[]);class cc extends aa{constructor(){super()}qta(){return{}}static get instance(){cc.Qp||(cc.Qp=new cc);return cc.Qp}}cc.Qp=null;Object(k.a)(cc,"DocumentSelectionChangedEvent",aa,[]);class Qd extends aa{constructor(){super()}qta(){return null}raiseEvent(L,ca){try{const X=this.Bl[ca];X&&(ca={},ca[OSF.DDA.Marshaling.ThemingKeys.DocumentTheme.toString()]=L,X(ca))}catch(X){ne.a.J(17687447,802,10,"DocumentThemeChanged Event failed, message: "+X.message)}}static get instance(){Qd.Qp||
(Qd.Qp=new Qd);return Qd.Qp}}Qd.Qp=null;Object(k.a)(Qd,"DocumentThemeChangedEvent",aa,[]);class re extends aa{constructor(){super()}qta(){return null}addHandler(L,ca,X=null){this.JA(X,OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidApiCallInContext)}removeHandler(L,ca,X=null){this.JA(X,OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidApiCallInContext)}static get instance(){re.Qp||(re.Qp=new re);return re.Qp}}re.Qp=null;Object(k.a)(re,"OfficeThemeChangedEvent",aa,[]);class Ca{constructor(){}}Object(k.a)(Ca,
"RichApiEventManagerHost",null,[1121]);class ob extends aa{constructor(){super();this.qId=null}qta(L){return L}addHandler(L,ca,X=null,qb=null){this.Kd&&ra.a(qb)?(this.qId||(this.qId=new Ca(this),OfficeExtension.WacRuntime.RichApi.initEventManagerHost(this.qId)),this.Bl[L]=ca,this.t6a(X)):this.JA(X,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}removeHandler(L,ca,X=null,qb=null){this.Kd&&ra.a(qb)&&L in this.Bl?(delete this.Bl[L],this.t6a(X)):this.JA(X,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}static get instance(){return ob.Ka||
(ob.Ka=new ob)}}ob.Ka=null;Object(k.a)(ob,"RichApiMessageEvent",aa,[]);class Hb extends aa{constructor(){super()}qta(L){return L}static get instance(){Hb.Qp||(Hb.Qp=new Hb);return Hb.Qp}}Hb.Qp=null;Object(k.a)(Hb,"SettingsChangedEvent",aa,[]);class rc extends tc{constructor(L,ca){super(L,ca)}NAk(){this.xBb={};this.set(OSF.DDA.EventDispId.dispidSettingsChangedEvent,Hb.instance);this.set(OSF.DDA.EventDispId.dispidActiveViewChangedEvent,Oa.instance);this.set(OSF.DDA.EventDispId.dispidActivationStatusChangedEvent,
sa.instance);this.set(OSF.DDA.EventDispId.dispidDocumentThemeChangedEvent,Qd.instance);this.set(OSF.DDA.EventDispId.dispidOfficeThemeChangedEvent,re.instance);this.set(OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent,cc.instance);this.set(OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent,Gb.instance);this.set(OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent,Cc.instance);this.set(OSF.DDA.EventDispId.dispidDialogNotificationShownInAddinEvent,new Bb);this.set(OSF.DDA.EventDispId.dispidRichApiMessageEvent,
ob.instance)}}Object(k.a)(rc,"EditorEventStore",tc,[]);class td{constructor(L){this.Mec=null;this.Zc=L}Z1i(L){this.Mec||this.cBk();if(!L||!this.Mec[L])return null;if(L=this.Mec[L]())L.Kd=this.Zc;return L}set(L,ca){this.Mec[L]=ca}}Object(k.a)(td,"ApiMethodFactory",null,[]);class sc{constructor(L,ca,X,qb){this.instanceId=L.toLowerCase();this.fileSize=ca;this.L1d=qb;this.swh=X}}Object(k.a)(sc,"DocumentCopy",null,[]);var Tc=d(385),Dc=d(275);class xc extends Tc.a{constructor(L,ca,X,qb,Rb,Qc,jd){super();
this.gB=L.string;this.nE=ca;this.Dla=X;this.Nea=Rb;this.Zbk=qb;this.Jac=Qc;this.pVa=jd;this.EYa=Object(u.a)(this,this.Nok,"onGetDocumentCopyChunkFinished");this.onError=Object(u.a)(this,this.Mok,"onGetDocumentCopyChunkError")}start(){this.Uod=!1;Dc.a.VZf(this.gB,this.nE,this.Dla,this.Zbk,this.Nea,Object(u.a)(this,this.gda,"handleWebserviceResponse"),Object(u.a)(this,this.fda,"handleWebserviceError"))}Nok(L){if(L.MRa){const ca={};L=L.result;ca.value=L.FileData;ca.errorCode=L.ErrorCode;this.Jac(this.nE,
ca)}else this.handleError(L)}Mok(L){this.handleError(L)}handleError(L){this.pVa&&(L=L.error,this.pVa(this.nE,!!L&&2===L.type))}}Object(k.a)(xc,"GetDocumentCopyChunkTask",Tc.a,[]);class pg extends Tc.a{constructor(L,ca,X,qb,Rb,Qc){super();this.gB=L.string;this.nE=ca;this.Dla=X;this.Nea=qb;this.Jac=Rb;this.pVa=Qc;this.EYa=Object(u.a)(this,this.Pok,"onGetDocumentCopyFinished");this.onError=Object(u.a)(this,this.Ook,"onGetDocumentCopyError")}start(){this.Uod=!1;Dc.a.g7i(this.gB,this.nE,this.Dla,Object(u.a)(this,
this.gda,"handleWebserviceResponse"),Object(u.a)(this,this.fda,"handleWebserviceError"))}Pok(L){if(L.MRa){const ca={};L=L.result;ca.fileSize=L.FileSize;ca.errorCode=L.ErrorCode;ca.format=this.Dla;ca.sliceSize=this.Nea;this.Jac(this.nE,ca)}else this.handleError(L)}Ook(L){this.handleError(L)}handleError(L){this.pVa&&(L=L.error,this.pVa(this.nE,!!L&&2===L.type))}}Object(k.a)(pg,"GetDocumentCopyTask",Tc.a,[]);class Ih extends Tc.a{constructor(L,ca,X,qb,Rb,Qc,jd){super();this.gB=L.string;this.nE=ca;this.Dla=
X;this.G8j=qb;this.F8j=Rb;this.Jac=Qc;this.pVa=jd;this.EYa=Object(u.a)(this,this.Wrk,"onReleaseDocumentCopyFinished");this.onError=Object(u.a)(this,this.Vrk,"onReleaseDocumentCopyError")}start(){this.Uod=!1;Dc.a.tnc(this.gB,this.nE,this.Dla,this.G8j,this.F8j,Object(u.a)(this,this.gda,"handleWebserviceResponse"),Object(u.a)(this,this.fda,"handleWebserviceError"))}Wrk(L){if(L.MRa){const ca={};ca.errorCode=L.result.ErrorCode;this.Jac(this.nE,ca)}else this.handleError(L)}Vrk(L){this.handleError(L)}handleError(L){this.pVa&&
(L=L.error,this.pVa(this.nE,!!L&&2===L.type))}}Object(k.a)(Ih,"ReleaseGetDocumentCopyTask",Tc.a,[]);class vh{constructor(){this.fad=null}start(){this.fad.start()}static CCi(L,ca,X,qb,Rb,Qc){const jd=new vh;jd.fad=new pg(L,ca,X,qb,Rb,Qc);return jd}static BCi(L,ca,X,qb,Rb,Qc,jd){const vd=new vh;vd.fad=new xc(L,ca,X,qb,Rb,Qc,jd);return vd}static IIf(L,ca,X,qb,Rb,Qc,jd){const vd=new vh;vd.fad=new Ih(L,ca,X,qb,Rb,Qc,jd);return vd}}Object(k.a)(vh,"AppForOfficeTask",null,[]);class Ti{constructor(){this.Ppe=
1;this.A$e=new Ob.a}get oDa(){return this.A$e}Emi(L,ca,X,qb){const Rb=this.R1f();L=new sc(L,ca,X,qb);this.oDa.$(Rb.toString(),L);return Rb}Dfg(L,ca){for(let X of this.oDa){const qb=X.value;if(qb.instanceId===L.toLowerCase()&&qb.L1d===ca)return!0}return!1}YXf(L){return this.oDa.ga(L.toString())}tRk(L){this.oDa.remove(L.toString())}tnc(L,ca,X,qb){(qb&&this.uRk(ca)||X&&this.mRk())&&vh.IIf(L,ca,4,X,qb,()=>{},()=>{}).start()}mRk(){let L=!1;0<this.oDa.count&&(this.A$e=new Ob.a,L=!0);return L}uRk(L){if(!L)return!1;
const ca=[];for(let X of this.oDa)X.value.instanceId===L.toLowerCase()&&ca.push(X.key);for(L=0;L<ca.length;L++)this.oDa.remove(ca[L]);return 0<ca.length}R1f(){return this.Ppe++}}Object(k.a)(Ti,"GetDocumentCopyHelper",null,[1044]);class ai{constructor(L,ca){this.Yvg=ca.length;this.Nea=L;this.Ybk=Math.ceil(this.Yvg/L);this.Fzi(ca)}Fzi(L){for(let ca=0;ca<this.Ybk;ca++){const X=ca*this.Nea;L.slice(X,Math.min(X+this.Nea,this.Yvg))}}}Object(k.a)(ai,"DocumentCopyCache",null,[]);class Il{constructor(){this.Sxe=
this.qye=null;this.Txe=this.rye=0}add(L,ca,X,qb){4===ca?(this.rye=L,this.qye=new ai(X,qb)):3===ca&&(this.Txe=L,this.Sxe=new ai(X,qb))}remove(L){this.rye===L?(this.rye=0,this.qye=null):this.Txe===L&&(this.Txe=0,this.Sxe=null)}contains(L){return 4===L&&!!this.qye||3===L&&!!this.Sxe}}Object(k.a)(Il,"PerAppCache",null,[]);class ui{get cache(){return ui.ji}get M1d(){return ui.j6j}Dfg(L,ca){return L in this.cache&&this.cache[L].contains(ca)}VZf(){}tnc(L){if(L.toString()in this.M1d){const ca=this.M1d[L.toString()];
delete this.M1d[L.toString()];this.cache[ca].remove(L)}}R1f(){return ui.Ppe++}}ui.ji={};ui.j6j={};ui.Ppe=1;Object(k.a)(ui,"GetFileApiProxy",null,[1139]);class Cg{constructor(L,ca,X){this.vh=0;this.controlId=this.iAa=this.rE=this.HAb=this.Zc=this.yo=null;this.parameters=L;this.callback=ca;this.Sai=X;new ui;this.Hbb=new xa;this.bWa=new Ti}get vGc(){this.Hbb||(this.Hbb=new xa);return this.Hbb}get Sca(){return this.bWa}get i0k(){this.rE||(this.rE=Bc.a.instance.resolve("PowerPointWebEditor.Storage.ISaveAndCloseHandler"));
return this.rE}get ryj(){return this.iAa||(this.iAa=Bc.a.instance.Ja("Postmessage.IHostPostmessenger"))}get errorCode(){return this.vh}set errorCode(L){this.vh=L}get result(){return this.yo}set result(L){this.yo=L}get qu(){return this.HAb}get Kd(){return this.Zc}set Kd(L){(this.Zc=L)?(this.HAb=this.Zc.qu,this.bWa=this.Zc.Sca):this.bWa=this.HAb=null}go(){this.yo={};try{this.Wq()}catch(L){this.E_j(L)}this.FH()}E_j(L){this.vh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;ne.a.J(18396573,802,10,
"Error when executing API: {0}",L.toString())}FH(){this.vh!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&ne.a.J(18985232,802,10,"Error when API method failed. m_errorCode = {0}",this.vh);this.yo[hi.c_Error]=this.vh;this.callback(this.yo)}a4d(){return this.controlId?this.Kd?this.Kd.u_.FW(this.controlId):null:null}e2i(){if(!this.controlId)return null;let L=null;this.Kd&&(L=this.Kd.u_.FW(this.controlId));return L?0===L.Tw?this.Kd.zTf(L.shape.slideId,L.shape.id):1===L.Tw?this.Kd.qDa(L.ap.id):null:
null}w9d(L){return L?this.Kd?this.Kd.w9d(L):null:null}}Object(k.a)(Cg,"ApiMethod",null,[]);class hl extends Cg{constructor(){super()}Wq(){OfficeExt.AddinCommandsRuntimeManager.invocationCompleted(this.parameters[Q.a.Hai][Q.a.Gai],this.parameters);this.vh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}get description(){return"Run AddinCommandsRuntimeManager InvocationCompleted."}}Object(k.a)(hl,"AppCommandInvocationCompletedMethod",Cg,[]);class yj extends Cg{constructor(){super()}go(){this.yo={};this.Wq()}Wq(){if(this.qu)try{const L=
this.parameters[OSF.DDA.Marshaling.CreateDocument.Base64].toString();L&&L.length>this.Kd.rPd.od.pptEditorAppsForOfficeCreateDocumentApiMaxAllowedBase64?(n.ULS.sendTraceTag(587747342,802,15,"Too large base64 stream size:{0}",L.length),this.vh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam,this.FH()):this.qu.h7a(L,Object(u.a)(this,this.ZBi,"createDocumentSuccessCallback"),Object(u.a)(this,this.YBi,"createDocumentFailCallback"))}catch(L){ne.a.J(35156300,802,10,"Exception thrown at CreateDocumentMethod: "+
L.toString()),this.vh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,this.FH()}else this.vh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,this.FH()}ZBi(L){const ca=new z.StandardDialog;ca.xd=4;ca.Bx(CommonUIStrings.l_GeneralAddInMessageDialogTitle,CommonUIStrings.l_OpenWindowConsentMessage,1,X=>{1===X&&window.open(L);this.vh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess;this.FH()})}YBi(L){this.vh=L?L:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;this.FH()}get description(){return"Create a new ppt document in the user's default folder."}}
Object(k.a)(yj,"CreateDocumentMethod",Cg,[]);var Oi=d(94),jj=d(87);class zh{static uMk(L){const ca=new Map;ca.set("ApiId",L.toString());Oi.Health.instance.recordKpiUsage(zh.omh,1,zh.kmh,ca)}static tMk(L,ca,X){const qb=new Map;qb.set("ApiId",L.toString());L=Object.assign(new jj.a,{extendedProperties:qb,durationMs:zh.a_f(ca,X)});Oi.Health.instance.recordKpiSuccess(zh.omh,L)}static nfh(L){const ca=new Map;ca.set("fWacPartition",L.toString());Oi.Health.instance.recordKpiUsage(zh.pmh,1,zh.kmh,ca)}static WNe(L,
ca){L=Object.assign(new jj.a,{durationMs:zh.a_f(L,ca)});Oi.Health.instance.recordKpiSuccess(zh.pmh,L)}static a_f(L,ca){let X=null;L&&ca&&(X=ca-L);return X}}zh.omh="PptApiCall";zh.pmh="PptApiRequest";zh.kmh="pptom";Object(k.a)(zh,"PptWacApiTelemetry",null,[]);class bk{constructor(){this.ver=0;this.exec=this.sel=null}}Object(k.a)(bk,"ApiRequest",null,[]);class Wk{constructor(){this.txRn=this.shpLst=this.sldLst=null}}Object(k.a)(Wk,"SelectionData",null,[]);const Xk=(L,ca)=>{var X=Object,qb=X.assign,
Rb=new bk,Qc=Object,jd=Qc.assign,vd=new Wk,Xd=L.qu.We();const Ke=[];if(Xd){Ke.length=Xd.length;for(var jf=0;jf<Xd.length;jf++)Ke[jf]=Xd[jf].Cb.toString()}Xd=L.qu.Xd();jf=[];if(Xd){jf.length=Xd.length;for(let wf=0;wf<Xd.length;wf++)jf[wf]=Xd[wf].get_shapeId().toString()}L=qb.call(X,Rb,{ver:1,exec:ca,sel:jd.call(Qc,vd,{sldLst:Ke,shpLst:jf,txRn:L.qu.dhj()})});return Sys.Serialization.JavaScriptSerializer.serialize(L)},he=L=>{let ca,X;ca=L.addType("Microsoft.Office.PowerPoint.Application","{549654b5-691c-491b-bed1-3eccfa85e525}",
"{64189aae-7617-40e1-ba92-365392bd2387}",3,0);X=ca.addMethod("InsertHyperLink",1001,"Void",0,0,"InsertHyperLink",4);X.addParameter("address","String",1,null,0);X.addParameter("displayName","String",1,null,0);X=ca.addMethod("InsertSlideFromContent",1002,"Microsoft.Office.PowerPoint.InsertSlideReturnCode",1,0,"InsertSlideFromContent",4);X.addParameter("slideContent","String",1,null,0);ca=L.addType("Microsoft.Office.PowerPoint.Presentation","{a8af8473-88c1-49d7-a986-565cb7100e9e}","",3,0);ca.addProperty("SlideMasters",
3,"Microsoft.Office.PowerPoint.SlideMasterCollection",3,!0,null,0);ca.addProperty("Slides",2,"Microsoft.Office.PowerPoint.SlideCollection",3,!0,null,0);ca.addProperty("Tags",4,"Microsoft.Office.PowerPoint.TagCollection",3,!0,null,0);ca.addProperty("Title",1,"String",1,!0,null,0);ca.addMethod("GetSelectedShapes",5,"Microsoft.Office.PowerPoint.ShapeScopedCollection",3,0,"SelectedShapes",0);ca.addMethod("GetSelectedSlides",6,"Microsoft.Office.PowerPoint.SlideScopedCollection",3,0,"SelectedSlides",0);
ca.addMethod("GetSelectedTextRange",7,"Microsoft.Office.PowerPoint.TextRange",3,0,"SelectedTextRange",0);ca.addMethod("GetSelectedTextRangeOrNullObject",9,"Microsoft.Office.PowerPoint.TextRange",3,0,"SelectedTextRangeOrNullObject",0);X=ca.addMethod("InsertSlidesFromBase64",1003,"Void",0,0,"InsertSlidesFromBase64",0);X.addParameter("base64File","String",1,null,0);X.addParameter("options","Microsoft.Office.PowerPoint.InsertSlideOptions",2,null,0);X=ca.addMethod("SetSelectedSlides",8,"Void",0,0,"SetSelectedSlides",
0);X.addParameter("slideIds","String[]",1,null,0);X=ca.addMethod("_RegisterEvent",1001,"Void",0,1,"_RegisterEvent",0);X.addParameter("referenceId","String",1,null,0);X.addParameter("eventType","Int32",1,null,0);X=ca.addMethod("_UnregisterEvent",1002,"Void",0,1,"_UnregisterEvent",0);X.addParameter("referenceId","String",1,null,0);X.addParameter("eventType","Int32",1,null,0);ca=L.addType("Microsoft.Office.PowerPoint.AddSlideOptions","{171a8d61-4952-4d67-b7e1-0197ac277d6a}","{af133e5f-ae0b-4a2b-8316-7b26d0a6b4f6}",
2,0);ca.addProperty("LayoutId",1,"String",1,!1,null,0);ca.addProperty("SlideMasterId",2,"String",1,!1,null,0);ca=L.addType("Microsoft.Office.PowerPoint.BulletFormat","{43bd46c0-809f-4417-b22c-84e44ab6e592}","",3,0);ca.addProperty("Visible",2,"Boolean",1,!1,null,0);ca.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);ca=L.addEnumType("Microsoft.Office.PowerPoint.ConnectorType");ca.addEnumField("Straight",0);ca.addEnumField("Elbow",1);ca.addEnumField("Curve",2);ca=L.addEnumType("Microsoft.Office.PowerPoint.GeometricShapeType");
ca.addEnumField("LineInverse",0);ca.addEnumField("Triangle",1);ca.addEnumField("RightTriangle",2);ca.addEnumField("Rectangle",3);ca.addEnumField("Diamond",4);ca.addEnumField("Parallelogram",5);ca.addEnumField("Trapezoid",6);ca.addEnumField("NonIsoscelesTrapezoid",7);ca.addEnumField("Pentagon",8);ca.addEnumField("Hexagon",9);ca.addEnumField("Heptagon",10);ca.addEnumField("Octagon",11);ca.addEnumField("Decagon",12);ca.addEnumField("Dodecagon",13);ca.addEnumField("Star4",14);ca.addEnumField("Star5",
15);ca.addEnumField("Star6",16);ca.addEnumField("Star7",17);ca.addEnumField("Star8",18);ca.addEnumField("Star10",19);ca.addEnumField("Star12",20);ca.addEnumField("Star16",21);ca.addEnumField("Star24",22);ca.addEnumField("Star32",23);ca.addEnumField("RoundRectangle",24);ca.addEnumField("Round1Rectangle",25);ca.addEnumField("Round2SameRectangle",26);ca.addEnumField("Round2DiagonalRectangle",27);ca.addEnumField("SnipRoundRectangle",28);ca.addEnumField("Snip1Rectangle",29);ca.addEnumField("Snip2SameRectangle",
30);ca.addEnumField("Snip2DiagonalRectangle",31);ca.addEnumField("Plaque",32);ca.addEnumField("Ellipse",33);ca.addEnumField("Teardrop",34);ca.addEnumField("HomePlate",35);ca.addEnumField("Chevron",36);ca.addEnumField("PieWedge",37);ca.addEnumField("Pie",38);ca.addEnumField("BlockArc",39);ca.addEnumField("Donut",40);ca.addEnumField("NoSmoking",41);ca.addEnumField("RightArrow",42);ca.addEnumField("LeftArrow",43);ca.addEnumField("UpArrow",44);ca.addEnumField("DownArrow",45);ca.addEnumField("StripedRightArrow",
46);ca.addEnumField("NotchedRightArrow",47);ca.addEnumField("BentUpArrow",48);ca.addEnumField("LeftRightArrow",49);ca.addEnumField("UpDownArrow",50);ca.addEnumField("LeftUpArrow",51);ca.addEnumField("LeftRightUpArrow",52);ca.addEnumField("QuadArrow",53);ca.addEnumField("LeftArrowCallout",54);ca.addEnumField("RightArrowCallout",55);ca.addEnumField("UpArrowCallout",56);ca.addEnumField("DownArrowCallout",57);ca.addEnumField("LeftRightArrowCallout",58);ca.addEnumField("UpDownArrowCallout",59);ca.addEnumField("QuadArrowCallout",
60);ca.addEnumField("BentArrow",61);ca.addEnumField("UturnArrow",62);ca.addEnumField("CircularArrow",63);ca.addEnumField("LeftCircularArrow",64);ca.addEnumField("LeftRightCircularArrow",65);ca.addEnumField("CurvedRightArrow",66);ca.addEnumField("CurvedLeftArrow",67);ca.addEnumField("CurvedUpArrow",68);ca.addEnumField("CurvedDownArrow",69);ca.addEnumField("SwooshArrow",70);ca.addEnumField("Cube",71);ca.addEnumField("Can",72);ca.addEnumField("LightningBolt",73);ca.addEnumField("Heart",74);ca.addEnumField("Sun",
75);ca.addEnumField("Moon",76);ca.addEnumField("SmileyFace",77);ca.addEnumField("IrregularSeal1",78);ca.addEnumField("IrregularSeal2",79);ca.addEnumField("FoldedCorner",80);ca.addEnumField("Bevel",81);ca.addEnumField("Frame",82);ca.addEnumField("HalfFrame",83);ca.addEnumField("Corner",84);ca.addEnumField("DiagonalStripe",85);ca.addEnumField("Chord",86);ca.addEnumField("Arc",87);ca.addEnumField("LeftBracket",88);ca.addEnumField("RightBracket",89);ca.addEnumField("LeftBrace",90);ca.addEnumField("RightBrace",
91);ca.addEnumField("BracketPair",92);ca.addEnumField("BracePair",93);ca.addEnumField("Callout1",94);ca.addEnumField("Callout2",95);ca.addEnumField("Callout3",96);ca.addEnumField("AccentCallout1",97);ca.addEnumField("AccentCallout2",98);ca.addEnumField("AccentCallout3",99);ca.addEnumField("BorderCallout1",100);ca.addEnumField("BorderCallout2",101);ca.addEnumField("BorderCallout3",102);ca.addEnumField("AccentBorderCallout1",103);ca.addEnumField("AccentBorderCallout2",104);ca.addEnumField("AccentBorderCallout3",
105);ca.addEnumField("WedgeRectCallout",106);ca.addEnumField("WedgeRRectCallout",107);ca.addEnumField("WedgeEllipseCallout",108);ca.addEnumField("CloudCallout",109);ca.addEnumField("Cloud",110);ca.addEnumField("Ribbon",111);ca.addEnumField("Ribbon2",112);ca.addEnumField("EllipseRibbon",113);ca.addEnumField("EllipseRibbon2",114);ca.addEnumField("LeftRightRibbon",115);ca.addEnumField("VerticalScroll",116);ca.addEnumField("HorizontalScroll",117);ca.addEnumField("Wave",118);ca.addEnumField("DoubleWave",
119);ca.addEnumField("Plus",120);ca.addEnumField("FlowChartProcess",121);ca.addEnumField("FlowChartDecision",122);ca.addEnumField("FlowChartInputOutput",123);ca.addEnumField("FlowChartPredefinedProcess",124);ca.addEnumField("FlowChartInternalStorage",125);ca.addEnumField("FlowChartDocument",126);ca.addEnumField("FlowChartMultidocument",127);ca.addEnumField("FlowChartTerminator",128);ca.addEnumField("FlowChartPreparation",129);ca.addEnumField("FlowChartManualInput",130);ca.addEnumField("FlowChartManualOperation",
131);ca.addEnumField("FlowChartConnector",132);ca.addEnumField("FlowChartPunchedCard",133);ca.addEnumField("FlowChartPunchedTape",134);ca.addEnumField("FlowChartSummingJunction",135);ca.addEnumField("FlowChartOr",136);ca.addEnumField("FlowChartCollate",137);ca.addEnumField("FlowChartSort",138);ca.addEnumField("FlowChartExtract",139);ca.addEnumField("FlowChartMerge",140);ca.addEnumField("FlowChartOfflineStorage",141);ca.addEnumField("FlowChartOnlineStorage",142);ca.addEnumField("FlowChartMagneticTape",
143);ca.addEnumField("FlowChartMagneticDisk",144);ca.addEnumField("FlowChartMagneticDrum",145);ca.addEnumField("FlowChartDisplay",146);ca.addEnumField("FlowChartDelay",147);ca.addEnumField("FlowChartAlternateProcess",148);ca.addEnumField("FlowChartOffpageConnector",149);ca.addEnumField("ActionButtonBlank",150);ca.addEnumField("ActionButtonHome",151);ca.addEnumField("ActionButtonHelp",152);ca.addEnumField("ActionButtonInformation",153);ca.addEnumField("ActionButtonForwardNext",154);ca.addEnumField("ActionButtonBackPrevious",
155);ca.addEnumField("ActionButtonEnd",156);ca.addEnumField("ActionButtonBeginning",157);ca.addEnumField("ActionButtonReturn",158);ca.addEnumField("ActionButtonDocument",159);ca.addEnumField("ActionButtonSound",160);ca.addEnumField("ActionButtonMovie",161);ca.addEnumField("Gear6",162);ca.addEnumField("Gear9",163);ca.addEnumField("Funnel",164);ca.addEnumField("MathPlus",165);ca.addEnumField("MathMinus",166);ca.addEnumField("MathMultiply",167);ca.addEnumField("MathDivide",168);ca.addEnumField("MathEqual",
169);ca.addEnumField("MathNotEqual",170);ca.addEnumField("CornerTabs",171);ca.addEnumField("SquareTabs",172);ca.addEnumField("PlaqueTabs",173);ca.addEnumField("ChartX",174);ca.addEnumField("ChartStar",175);ca.addEnumField("ChartPlus",176);ca=L.addEnumType("Microsoft.Office.PowerPoint.InsertSlideFormatting");ca.addEnumField("KeepSourceFormatting",0);ca.addEnumField("UseDestinationTheme",1);ca=L.addType("Microsoft.Office.PowerPoint.InsertSlideOptions","{9ca3e504-5701-467b-9596-15521056bac3}","{806c3519-08f4-41ba-b0d9-3c323c51c3e9}",
2,0);ca.addProperty("Formatting",1,"Microsoft.Office.PowerPoint.InsertSlideFormatting",1,!1,null,0);ca.addProperty("SourceSlideIds",4,"String[]",1,!1,null,0);ca.addProperty("TargetSlideId",5,"String",1,!1,null,0);ca=L.addEnumType("Microsoft.Office.PowerPoint.ParagraphHorizontalAlignment");ca.addEnumField("Left",0);ca.addEnumField("Center",1);ca.addEnumField("Right",2);ca.addEnumField("Justify",3);ca.addEnumField("JustifyLow",4);ca.addEnumField("Distributed",5);ca.addEnumField("ThaiDistributed",6);
ca=L.addType("Microsoft.Office.PowerPoint.ParagraphFormat","{c164d05d-7a4f-409f-8a5e-ef5f1d2ffa54}","",3,0);ca.addProperty("BulletFormat",1,"Microsoft.Office.PowerPoint.BulletFormat",3,!0,null,0);ca.addProperty("HorizontalAlignment",2,"Microsoft.Office.PowerPoint.ParagraphHorizontalAlignment",1,!1,null,0);ca.addMethod("_OnAccess",3,"Void",0,1,"_OnAccess",0);ca=L.addType("Microsoft.Office.PowerPoint.ShapeAddOptions","{b75ad347-9abe-4531-a338-3ba7a70bf9e1}","{2b45cbde-9fbf-4aa2-9972-5508e4c99ad8}",
2,0);ca.addProperty("Height",1,"Double",1,!1,null,0);ca.addProperty("Left",2,"Double",1,!1,null,0);ca.addProperty("Top",3,"Double",1,!1,null,0);ca.addProperty("Width",4,"Double",1,!1,null,0);ca=L.addType("Microsoft.Office.PowerPoint.ShapeCollection","{27a07ec1-bcc6-45bf-9c60-07250facfbca}","",3,0);X=ca.addMethod("AddGeometricShape",6,"Microsoft.Office.PowerPoint.Shape",3,0,"AddGeometricShape",0);X.addParameter("geometricShapeType","Microsoft.Office.PowerPoint.GeometricShapeType",1,null,0);X.addParameter("options",
"Microsoft.Office.PowerPoint.ShapeAddOptions",2,null,0);X=ca.addMethod("AddLine",7,"Microsoft.Office.PowerPoint.Shape",3,0,"AddLine",0);X.addParameter("connectorType","Microsoft.Office.PowerPoint.ConnectorType",1,null,0);X.addParameter("options","Microsoft.Office.PowerPoint.ShapeAddOptions",2,null,0);X=ca.addMethod("AddTextBox",8,"Microsoft.Office.PowerPoint.Shape",3,0,"AddTextBox",0);X.addParameter("text","String",1,null,0);X.addParameter("options","Microsoft.Office.PowerPoint.ShapeAddOptions",2,
null,0);ca.addMethod("GetCount",1,"Int32",1,1,"Count",0);X=ca.addIndexerMethod(2,"Microsoft.Office.PowerPoint.Shape",3,0);X.addParameter("key","String",1,null,0);X=ca.addMethod("GetItemAt",5,"Microsoft.Office.PowerPoint.Shape",3,1,"ItemAt",0);X.addParameter("index","Int32",1,null,0);X=ca.addMethod("GetItemOrNullObject",3,"Microsoft.Office.PowerPoint.Shape",3,0,"ItemOrNullObject",0);X.addParameter("id","String",1,null,0);ca.addMethod("_OnAccess",4,"Void",0,1,"_OnAccess",0);ca.setCollectionInfo("Microsoft.Office.PowerPoint.Shape",
!0);ca=L.addType("Microsoft.Office.PowerPoint.SlideLayout","{4494143a-d362-45fd-89c6-506e97741384}","",3,0);ca.addProperty("Id",1,"String",1,!0,null,0);ca.addProperty("Name",3,"String",1,!0,null,0);ca.addProperty("Shapes",4,"Microsoft.Office.PowerPoint.ShapeCollection",3,!0,null,0);ca.addMethod("_OnAccess",2,"Void",0,1,"_OnAccess",0);ca=L.addType("Microsoft.Office.PowerPoint.SlideLayoutCollection","{8f09fea3-67af-49f9-b42a-0a8f8cd02615}","",3,0);ca.addMethod("GetCount",1,"Int32",1,1,"Count",0);X=
ca.addIndexerMethod(2,"Microsoft.Office.PowerPoint.SlideLayout",3,0);X.addParameter("key","String",1,null,0);X=ca.addMethod("GetItemAt",3,"Microsoft.Office.PowerPoint.SlideLayout",3,1,"ItemAt",0);X.addParameter("index","Int32",1,null,0);X=ca.addMethod("GetItemOrNullObject",4,"Microsoft.Office.PowerPoint.SlideLayout",3,0,"ItemOrNullObject",0);X.addParameter("id","String",1,null,0);ca.addMethod("_OnAccess",5,"Void",0,1,"_OnAccess",0);ca.setCollectionInfo("Microsoft.Office.PowerPoint.SlideLayout",!0);
ca=L.addType("Microsoft.Office.PowerPoint.SlideMaster","{4a835b29-4422-4659-ab73-2e1e0096e7c1}","",3,0);ca.addProperty("Id",1,"String",1,!0,null,0);ca.addProperty("Layouts",3,"Microsoft.Office.PowerPoint.SlideLayoutCollection",3,!0,null,0);ca.addProperty("Name",4,"String",1,!0,null,0);ca.addProperty("Shapes",5,"Microsoft.Office.PowerPoint.ShapeCollection",3,!0,null,0);ca.addMethod("_OnAccess",2,"Void",0,1,"_OnAccess",0);ca=L.addType("Microsoft.Office.PowerPoint.Tag","{f26bc228-f6da-40de-b9ef-2a57ad2b5162}",
"",3,0);ca.addProperty("Key",2,"String",1,!0,null,0);ca.addProperty("Value",3,"String",1,!1,null,0);ca.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);ca=L.addType("Microsoft.Office.PowerPoint.TagCollection","{edf01799-a99c-4e57-94f2-5830600f5da4}","",3,0);X=ca.addMethod("Add",1,"Void",0,0,"Add",0);X.addParameter("key","String",1,null,0);X.addParameter("value","String",1,null,0);X=ca.addMethod("Delete",2,"Void",0,0,"Delete",0);X.addParameter("key","String",1,null,0);ca.addMethod("GetCount",3,"Int32",
1,1,"Count",0);X=ca.addIndexerMethod(4,"Microsoft.Office.PowerPoint.Tag",3,0);X.addParameter("key","String",1,null,0);X=ca.addMethod("GetItemAt",5,"Microsoft.Office.PowerPoint.Tag",3,1,"ItemAt",0);X.addParameter("index","Int32",1,null,0);X=ca.addMethod("GetItemOrNullObject",6,"Microsoft.Office.PowerPoint.Tag",3,0,"ItemOrNullObject",0);X.addParameter("key","String",1,null,0);ca.addMethod("_OnAccess",7,"Void",0,1,"_OnAccess",0);ca.setCollectionInfo("Microsoft.Office.PowerPoint.Tag",!0);ca=L.addType("Microsoft.Office.PowerPoint.Slide",
"{61c859a3-9c46-44a7-a415-aeb6f43a1dc7}","",3,0);ca.addProperty("Id",1,"String",1,!0,null,0);ca.addProperty("Layout",5,"Microsoft.Office.PowerPoint.SlideLayout",3,!0,null,0);ca.addProperty("Shapes",4,"Microsoft.Office.PowerPoint.ShapeCollection",3,!0,null,0);ca.addProperty("SlideMaster",6,"Microsoft.Office.PowerPoint.SlideMaster",3,!0,null,0);ca.addProperty("Tags",7,"Microsoft.Office.PowerPoint.TagCollection",3,!0,null,0);ca.addMethod("Delete",3,"Void",0,0,"Delete",0);X=ca.addMethod("SetSelectedShapes",
8,"Void",0,0,"SetSelectedShapes",0);X.addParameter("shapeIds","String[]",1,null,0);ca.addMethod("_OnAccess",2,"Void",0,1,"_OnAccess",0);ca=L.addEnumType("Microsoft.Office.PowerPoint.ShapeFillType");ca.addEnumField("NoFill",0);ca.addEnumField("Solid",1);ca.addEnumField("Gradient",2);ca.addEnumField("Pattern",3);ca.addEnumField("PictureAndTexture",4);ca.addEnumField("SlideBackground",5);ca=L.addType("Microsoft.Office.PowerPoint.ShapeFill","{2df31ab1-fa27-4e46-9704-1fb3f49bed4b}","",3,0);ca.addProperty("ForegroundColor",
2,"String",1,!1,null,0);ca.addProperty("Transparency",5,"Double",1,!1,null,0);ca.addProperty("Type",6,"Microsoft.Office.PowerPoint.ShapeFillType",1,!0,null,0);ca.addMethod("Clear",1,"Void",0,0,"Clear",0);X=ca.addMethod("SetSolidColor",4,"Void",0,0,"SetSolidColor",0);X.addParameter("color","String",1,null,0);ca.addMethod("_OnAccess",3,"Void",0,1,"_OnAccess",0);ca=L.addEnumType("Microsoft.Office.PowerPoint.ShapeLineStyle");ca.addEnumField("Single",0);ca.addEnumField("ThickBetweenThin",1);ca.addEnumField("ThickThin",
2);ca.addEnumField("ThinThick",3);ca.addEnumField("ThinThin",4);ca=L.addEnumType("Microsoft.Office.PowerPoint.ShapeLineDashStyle");ca.addEnumField("Dash",0);ca.addEnumField("DashDot",1);ca.addEnumField("DashDotDot",2);ca.addEnumField("LongDash",3);ca.addEnumField("LongDashDot",4);ca.addEnumField("RoundDot",5);ca.addEnumField("Solid",6);ca.addEnumField("SquareDot",7);ca.addEnumField("LongDashDotDot",8);ca.addEnumField("SystemDash",9);ca.addEnumField("SystemDot",10);ca.addEnumField("SystemDashDot",
11);ca=L.addType("Microsoft.Office.PowerPoint.ShapeLineFormat","{f275eab8-4363-41e8-b11a-e41e3c725f21}","",3,0);ca.addProperty("Color",1,"String",1,!1,null,0);ca.addProperty("DashStyle",2,"Microsoft.Office.PowerPoint.ShapeLineDashStyle",1,!1,null,0);ca.addProperty("Style",4,"Microsoft.Office.PowerPoint.ShapeLineStyle",1,!1,null,0);ca.addProperty("Transparency",5,"Double",1,!1,null,0);ca.addProperty("Visible",6,"Boolean",1,!1,null,0);ca.addProperty("Weight",7,"Double",1,!1,null,0);ca.addMethod("_OnAccess",
3,"Void",0,1,"_OnAccess",0);ca=L.addEnumType("Microsoft.Office.PowerPoint.ShapeType");ca.addEnumField("Unsupported",0);ca.addEnumField("Image",1);ca.addEnumField("GeometricShape",2);ca.addEnumField("Group",3);ca.addEnumField("Line",4);ca=L.addEnumType("Microsoft.Office.PowerPoint.ShapeAutoSize");ca.addEnumField("AutoSizeNone",0);ca.addEnumField("AutoSizeTextToFitShape",1);ca.addEnumField("AutoSizeShapeToFitText",2);ca.addEnumField("AutoSizeMixed",3);ca=L.addEnumType("Microsoft.Office.PowerPoint.TextVerticalAlignment");
ca.addEnumField("Top",0);ca.addEnumField("Middle",1);ca.addEnumField("Bottom",2);ca.addEnumField("TopCentered",3);ca.addEnumField("MiddleCentered",4);ca.addEnumField("BottomCentered",5);ca=L.addEnumType("Microsoft.Office.PowerPoint.ShapeFontUnderlineStyle");ca.addEnumField("None",0);ca.addEnumField("Single",1);ca.addEnumField("Double",2);ca.addEnumField("Heavy",3);ca.addEnumField("Dotted",4);ca.addEnumField("DottedHeavy",5);ca.addEnumField("Dash",6);ca.addEnumField("DashHeavy",7);ca.addEnumField("DashLong",
8);ca.addEnumField("DashLongHeavy",9);ca.addEnumField("DotDash",10);ca.addEnumField("DotDashHeavy",11);ca.addEnumField("DotDotDash",12);ca.addEnumField("DotDotDashHeavy",13);ca.addEnumField("Wavy",14);ca.addEnumField("WavyHeavy",15);ca.addEnumField("WavyDouble",16);ca=L.addType("Microsoft.Office.PowerPoint.ShapeFont","{06c9e9fa-f317-4016-b9f4-aea94e9690f4}","",3,0);ca.addProperty("Bold",1,"Boolean",1,!1,null,0);ca.addProperty("Color",2,"String",1,!1,null,0);ca.addProperty("Italic",3,"Boolean",1,!1,
null,0);ca.addProperty("Name",5,"String",1,!1,null,0);ca.addProperty("Size",6,"Double",1,!1,null,0);ca.addProperty("Underline",7,"Microsoft.Office.PowerPoint.ShapeFontUnderlineStyle",1,!1,null,0);ca.addMethod("_OnAccess",4,"Void",0,1,"_OnAccess",0);ca=L.addType("Microsoft.Office.PowerPoint.TextRange","{1eb59e56-2d48-4b16-b3bb-4fe7debe51c2}","",3,0);ca.addProperty("Font",1,"Microsoft.Office.PowerPoint.ShapeFont",3,!0,null,0);ca.addProperty("Length",7,"Int32",1,!1,null,0);ca.addProperty("ParagraphFormat",
4,"Microsoft.Office.PowerPoint.ParagraphFormat",3,!0,null,0);ca.addProperty("Start",9,"Int32",1,!1,null,0);ca.addProperty("Text",5,"String",1,!1,null,0);ca.addMethod("GetParentTextFrame",10,"Microsoft.Office.PowerPoint.TextFrame",3,0,"ParentTextFrame",0);X=ca.addMethod("GetSubstring",2,"Microsoft.Office.PowerPoint.TextRange",3,0,"Substring",0);X.addParameter("start","Int32",1,null,0);X.addParameter("length","Int32",1,null,0);ca.addMethod("SetSelected",8,"Void",0,0,"SetSelected",0);ca.addMethod("_OnAccess",
3,"Void",0,1,"_OnAccess",0);ca=L.addType("Microsoft.Office.PowerPoint.TextFrame","{b5929948-a2b9-4816-8e79-fe9deef82e48}","",3,0);ca.addProperty("AutoSizeSetting",1,"Microsoft.Office.PowerPoint.ShapeAutoSize",1,!1,null,0);ca.addProperty("BottomMargin",2,"Double",1,!1,null,0);ca.addProperty("HasText",4,"Boolean",1,!0,null,0);ca.addProperty("LeftMargin",6,"Double",1,!1,null,0);ca.addProperty("RightMargin",7,"Double",1,!1,null,0);ca.addProperty("TextRange",8,"Microsoft.Office.PowerPoint.TextRange",3,
!0,null,0);ca.addProperty("TopMargin",9,"Double",1,!1,null,0);ca.addProperty("VerticalAlignment",10,"Microsoft.Office.PowerPoint.TextVerticalAlignment",1,!1,null,0);ca.addProperty("WordWrap",11,"Boolean",1,!1,null,0);ca.addMethod("DeleteText",3,"Void",0,0,"DeleteText",0);ca.addMethod("GetParentShape",13,"Microsoft.Office.PowerPoint.Shape",3,0,"ParentShape",0);ca.addMethod("_OnAccess",5,"Void",0,1,"_OnAccess",0);ca=L.addType("Microsoft.Office.PowerPoint.Shape","{62ed0f8f-a9ce-46bd-8ad2-61634aee155d}",
"",3,0);ca.addProperty("Fill",11,"Microsoft.Office.PowerPoint.ShapeFill",3,!0,null,0);ca.addProperty("Height",5,"Double",1,!1,null,0);ca.addProperty("Id",1,"String",1,!0,null,0);ca.addProperty("Left",6,"Double",1,!1,null,0);ca.addProperty("LineFormat",12,"Microsoft.Office.PowerPoint.ShapeLineFormat",3,!0,null,0);ca.addProperty("Name",7,"String",1,!1,null,0);ca.addProperty("Tags",3,"Microsoft.Office.PowerPoint.TagCollection",3,!0,null,0);ca.addProperty("TextFrame",13,"Microsoft.Office.PowerPoint.TextFrame",
3,!0,null,0);ca.addProperty("Top",8,"Double",1,!1,null,0);ca.addProperty("Type",9,"Microsoft.Office.PowerPoint.ShapeType",1,!0,null,0);ca.addProperty("Width",10,"Double",1,!1,null,0);ca.addMethod("Delete",4,"Void",0,0,"Delete",0);ca.addMethod("GetParentSlide",15,"Microsoft.Office.PowerPoint.Slide",3,0,"ParentSlide",0);ca.addMethod("GetParentSlideLayout",16,"Microsoft.Office.PowerPoint.SlideLayout",3,0,"ParentSlideLayout",0);ca.addMethod("GetParentSlideLayoutOrNullObject",18,"Microsoft.Office.PowerPoint.SlideLayout",
3,0,"ParentSlideLayoutOrNullObject",0);ca.addMethod("GetParentSlideMaster",17,"Microsoft.Office.PowerPoint.SlideMaster",3,0,"ParentSlideMaster",0);ca.addMethod("GetParentSlideMasterOrNullObject",19,"Microsoft.Office.PowerPoint.SlideMaster",3,0,"ParentSlideMasterOrNullObject",0);ca.addMethod("GetParentSlideOrNullObject",20,"Microsoft.Office.PowerPoint.Slide",3,0,"ParentSlideOrNullObject",0);ca.addMethod("_OnAccess",2,"Void",0,1,"_OnAccess",0);ca=L.addType("Microsoft.Office.PowerPoint.ShapeScopedCollection",
"{607dbfd7-bd79-4651-b5ff-3a66bc46be74}","",3,0);ca.addMethod("GetCount",1,"Int32",1,1,"Count",0);X=ca.addIndexerMethod(2,"Microsoft.Office.PowerPoint.Shape",3,0);X.addParameter("key","String",1,null,0);X=ca.addMethod("GetItemAt",3,"Microsoft.Office.PowerPoint.Shape",3,1,"ItemAt",0);X.addParameter("index","Int32",1,null,0);X=ca.addMethod("GetItemOrNullObject",4,"Microsoft.Office.PowerPoint.Shape",3,0,"ItemOrNullObject",0);X.addParameter("id","String",1,null,0);ca.addMethod("_OnAccess",5,"Void",0,
1,"_OnAccess",0);ca.setCollectionInfo("Microsoft.Office.PowerPoint.Shape",!0);ca=L.addType("Microsoft.Office.PowerPoint.SlideCollection","{450b9577-a7dd-4d69-8dc9-afa8fba58465}","",3,0);X=ca.addMethod("Add",6,"Void",0,0,"Add",0);X.addParameter("options","Microsoft.Office.PowerPoint.AddSlideOptions",2,null,0);ca.addMethod("GetCount",1,"Int32",1,1,"Count",0);X=ca.addIndexerMethod(5,"Microsoft.Office.PowerPoint.Slide",3,0);X.addParameter("key","String",1,null,0);X=ca.addMethod("GetItemAt",2,"Microsoft.Office.PowerPoint.Slide",
3,1,"ItemAt",0);X.addParameter("index","Int32",1,null,0);X=ca.addMethod("GetItemOrNullObject",3,"Microsoft.Office.PowerPoint.Slide",3,0,"ItemOrNullObject",0);X.addParameter("id","String",1,null,0);ca.addMethod("_OnAccess",4,"Void",0,1,"_OnAccess",0);ca.setCollectionInfo("Microsoft.Office.PowerPoint.Slide",!0);ca=L.addType("Microsoft.Office.PowerPoint.SlideScopedCollection","{574045cb-b56d-4fca-89e5-b567250b9ce5}","",3,0);ca.addMethod("GetCount",1,"Int32",1,1,"Count",0);X=ca.addIndexerMethod(2,"Microsoft.Office.PowerPoint.Slide",
3,0);X.addParameter("key","String",1,null,0);X=ca.addMethod("GetItemAt",3,"Microsoft.Office.PowerPoint.Slide",3,1,"ItemAt",0);X.addParameter("index","Int32",1,null,0);X=ca.addMethod("GetItemOrNullObject",4,"Microsoft.Office.PowerPoint.Slide",3,0,"ItemOrNullObject",0);X.addParameter("id","String",1,null,0);ca.addMethod("_OnAccess",5,"Void",0,1,"_OnAccess",0);ca.setCollectionInfo("Microsoft.Office.PowerPoint.Slide",!0);ca=L.addType("Microsoft.Office.PowerPoint.SlideMasterCollection","{d5e75669-5fac-49ec-aaad-e1f6181f6fbd}",
"",3,0);ca.addMethod("GetCount",1,"Int32",1,1,"Count",0);X=ca.addIndexerMethod(2,"Microsoft.Office.PowerPoint.SlideMaster",3,0);X.addParameter("key","String",1,null,0);X=ca.addMethod("GetItemAt",3,"Microsoft.Office.PowerPoint.SlideMaster",3,1,"ItemAt",0);X.addParameter("index","Int32",1,null,0);X=ca.addMethod("GetItemOrNullObject",4,"Microsoft.Office.PowerPoint.SlideMaster",3,0,"ItemOrNullObject",0);X.addParameter("id","String",1,null,0);ca.addMethod("_OnAccess",5,"Void",0,1,"_OnAccess",0);ca.setCollectionInfo("Microsoft.Office.PowerPoint.SlideMaster",
!0);ca=L.addType("Microsoft.AppRuntime.AppRuntimeService","{a9f1fc0a-741e-4882-87e1-025d6f8024e7}","{43a4559c-806b-4e89-914e-da9256212148}",3,0);ca.addMethod("GetAppRuntimeState",2,"Microsoft.AppRuntime.AppRuntimeState",1,1,"AppRuntimeState",0);X=ca.addMethod("SetAppRuntimeState",1,"Void",0,0,"SetAppRuntimeState",0);X.addParameter("appRuntimeState","Microsoft.AppRuntime.AppRuntimeState",1,null,0);ca=L.addEnumType("Microsoft.AppRuntime.AppRuntimeState");ca.addEnumField("Inactive",0);ca.addEnumField("Background",
1);ca.addEnumField("Visible",2);ca=L.addEnumType("Microsoft.AppRuntime.Visibility");ca.addEnumField("Hidden",1);ca.addEnumField("Visible",2);ca=L.addType("Microsoft.AppRuntime.AppRuntimePersistenceService","{e8c34c73-c596-41e3-8943-dd7dd03839c7}","{7b93e367-9ccc-4d0e-8d75-79387538164b}",3,0);ca.addMethod("GetAppRuntimeStartState",2,"Microsoft.AppRuntime.AppRuntimeState",1,1,"AppRuntimeStartState",0);X=ca.addMethod("SetAppRuntimeStartState",1,"Void",0,0,"SetAppRuntimeStartState",0);X.addParameter("appRuntimeState",
"Microsoft.AppRuntime.AppRuntimeState",1,null,0);ca=L.addEnumType("Microsoft.Office.Licensing.LicenseFeatureTier");ca.addEnumField("Unknown",0);ca.addEnumField("Basic",1);ca.addEnumField("Premium",2);ca=L.addType("Microsoft.Office.Licensing.License","{db7c13ab-8285-4ff7-88d6-c9e7b2ca9b12}","{89df9b4a-85de-42d7-89d1-de8bc29e6df0}",3,0);X=ca.addMethod("GetFeatureTier",2,"Microsoft.Office.Licensing.LicenseFeatureTier",1,1,"FeatureTier",0);X.addParameter("feature","String",1,null,0);X.addParameter("fallbackValue",
"Microsoft.Office.Licensing.LicenseFeatureTier",1,null,0);X=ca.addMethod("GetLicenseFeature",5,"Microsoft.Office.Licensing.LicenseFeature",3,1,"LicenseFeature",0);X.addParameter("feature","String",1,null,0);X=ca.addMethod("GetMsaDeviceTicket",7,"String",1,1,"MsaDeviceTicket",4);X.addParameter("resource","String",1,null,0);X.addParameter("policy","String",1,null,0);X.addParameter("options","Microsoft.Office.Licensing.MsaDeviceTicketOptions",3,null,0);X=ca.addMethod("IsFeatureEnabled",1,"Boolean",1,
1,"IsFeatureEnabled",0);X.addParameter("feature","String",1,null,0);X.addParameter("fallbackValue","Boolean",1,null,0);ca.addMethod("IsFreemiumUpsellEnabled",3,"Boolean",1,1,"IsFreemiumUpsellEnabled",0);X=ca.addMethod("LaunchUpsellExperience",4,"Void",0,1,"LaunchUpsellExperience",0);X.addParameter("experienceId","String",1,null,0);X=ca.addMethod("_TestFireStateChangedEvent",6,"Void",0,0,"_TestFireStateChangedEvent",4);X.addParameter("feature","String",1,null,0);ca=L.addType("Microsoft.Office.Licensing.LicenseFeature",
"{5af0b996-137f-447f-99be-8749e73546c8}","",3,0);ca.addProperty("Id",5,"String",1,!0,null,0);ca.addMethod("_RegisterStateChange",6,"Void",0,1,"_RegisterStateChange",0);ca.addMethod("_UnregisterStateChange",7,"Void",0,1,"_UnregisterStateChange",0);ca=L.addType("Microsoft.Office.Licensing.MsaDeviceTicketOptions","{b20df140-2e7a-4b77-bb33-14fa3f7871aa}","{fdd1b6d0-e5d9-4e98-bdbd-bdcf387c7835}",3,0);ca.addProperty("Scopes",1,"String",1,!1,null,0);ca=L.addType("Microsoft.DynamicRibbon.DynamicRibbon","{967ecb27-5cdb-41a1-8383-04fc1d6e118f}",
"{a652fd4a-c501-486a-8cb6-ed52946eca50}",3,0);ca.addProperty("Buttons",4,"Microsoft.DynamicRibbon.RibbonButtonCollection",3,!0,null,0);X=ca.addMethod("ExecuteRequestCreate",7,"Void",0,1,"ExecuteRequestCreate",0);X.addParameter("jsonCreate","String",1,null,0);X=ca.addMethod("ExecuteRequestUpdate",6,"Void",0,1,"ExecuteRequestUpdate",0);X.addParameter("jsonUpdate","String",1,null,0);X=ca.addMethod("GetButton",3,"Microsoft.DynamicRibbon.RibbonButton",3,1,"Button",0);X.addParameter("id","String",1,null,
0);X=ca.addMethod("GetTab",5,"Microsoft.DynamicRibbon.RibbonTab",3,1,"Tab",0);X.addParameter("id","String",1,null,0);ca.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);ca=L.addType("Microsoft.DynamicRibbon.RibbonTab","{c68e16e8-67dd-48cf-b92f-46b40ca336ee}","",3,0);ca.addProperty("Id",2,"String",1,!0,null,0);X=ca.addMethod("SetVisibility",3,"Void",0,0,"SetVisibility",0);X.addParameter("visibility","Boolean",1,null,0);ca.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);ca=L.addType("Microsoft.DynamicRibbon.RibbonButton",
"{88e27ee2-4787-4d0d-8ff7-788a8be7c8c5}","",3,0);ca.addProperty("Enabled",3,"Boolean",1,!1,null,0);ca.addProperty("Id",2,"String",1,!0,null,0);ca.addProperty("Label",4,"String",1,!0,null,0);X=ca.addMethod("SetEnabled",5,"Void",0,0,"SetEnabled",0);X.addParameter("enabled","Boolean",1,null,0);ca.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);ca=L.addType("Microsoft.DynamicRibbon.RibbonButtonCollection","{208b41cf-a38c-47cd-83fc-0ff0c4848ec3}","",3,0);ca.addMethod("GetCount",3,"Int32",1,1,"Count",
0);X=ca.addIndexerMethod(2,"Microsoft.DynamicRibbon.RibbonButton",3,0);X.addParameter("key","String",1,null,0);ca.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);ca.setCollectionInfo("Microsoft.DynamicRibbon.RibbonButton",!0)};var ik=d(41);class Zf{constructor(L,ca){this.ngc=L;this.Qfc=ca}NHf(L){return[200,null,L]}JSi(L,ca,X,qb,Rb,Qc){const jd=ik.a.YY(),vd=this.ngc.create(ca,X,qb);qb.Ipf=vd;const Xd=this.Qfc.create(Qc);Xd.context.appId=ca;Xd.context.controlId=X;const Ke=()=>{zh.nfh(!0);vd.oKe=!1;
OfficeExtension.WacRuntime.RichApi.executeRichApiRequest(vd,he,Xd,L).then(wf=>{if(!wf)return n.ULS.sendTraceTag(587745500,802,10,"ExecuteRichApiRequest failed."),Rb(null,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError),null;zh.WNe(jd,ik.a.YY());Rb(wf,OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess);return null},wf=>{n.ULS.sendTraceTag(587745499,802,10,"A PPT Rich API batch execution was failed, AppId: {0}  Reason: {1}",ca,wf);Rb(null,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);return null})},
jf=()=>{zh.nfh(!1);let wf=L[4];ig.a("ExtensibilityUseSerializedPayloads")&&(wf=Xk(qb,wf));OfficeExtension.WacRuntime.Utility.createPromise(eg=>{const Ng={};Ng.promiseToResolve=eg;Ng.requestBody=wf;C.AFrameworkApplication.Ta.La(Ii.a.I0d,2,Ng)}).then(eg=>{ig.a("ExtensibilityResetResponse")&&C.AFrameworkApplication.Ta.La(Ii.a.I0d,2,{promiseToResolve:null,requestBody:""});if(ig.a("ExtensibilityUseSerializedPayloads")){a:if((eg=Sys.Serialization.JavaScriptSerializer.deserialize(eg.toString()))&&eg.sel&&
eg.sel.sldLst){var Ng=Qc.presentation,Ug=eg.sel.sldLst,Ah=[];if(Ug)for(We of Ug)({slideId:Ug}=Zc.a.eDh(We)).returnValue&&(Ug=Object(ha.a)(116,Ng.lC(Ug)))&&Ah.push(Ug);var We=Ah;if(We.length&&!qb.qu.Sul(We))eg=null;else{We=1===We.length?We[0]:null;Ng=null;if(We&&eg.sel.shpLst){Ah=eg.sel.shpLst;Ng=[];if(Ah)for(lk of Ah)(Ah=We.eT(parseInt(lk)))&&Ng.push(Ah);var lk=Ng;if(lk.length&&!qb.qu.Rul(lk)){eg=null;break a}Ng=1===lk.length?lk[0]:null}eg=Ng&&eg.sel.txRn&&(eg.sel.txRn.length&&2!==eg.sel.txRn.length||
2===eg.sel.txRn.length&&0<=eg.sel.txRn[0]&&!qb.qu.Tul(Ng,eg.sel.txRn[0],eg.sel.txRn[1]))?null:eg.rst}}else eg=null;eg?(zh.WNe(jd,ik.a.YY()),Rb(this.NHf(eg),OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)):Rb(null,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}else zh.WNe(jd,ik.a.YY()),Rb(this.NHf(eg),OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess);return null},()=>{Rb(null,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);return null})};L?(vd.oKe=!0,OfficeExtension.WacRuntime.RichApi.executeRichApiRequest(vd,
he,Xd,L).then(wf=>{wf&&vd.ivg?Ke():jf();return null},()=>{jf();return null})):Ke()}}Object(k.a)(Zf,"RichApiRequest",null,[]);class em extends Cg{constructor(L,ca,X){super();this.ngc=L;this.Qfc=ca;this.ua=X}go(){this.yo={};this.Wq()}Wq(){const L=this.parameters.ArrayData;if(L){var ca=null,X=this.a4d();ig.a("SetOwnerAddinAssetIdForSharedRuntimeAPIsInPptWac")?X&&X.taskpane&&(ca=X.taskpane.ownerAddinSolutionId):X&&(ca=X.ap.id);try{(new Zf(this.ngc,this.Qfc)).JSi(L,ca,this.controlId,this.Kd,Object(u.a)(this,
this.KSi,"executeRichApiRequestCallback"),this.ua)}catch(qb){ne.a.J(36804577,802,10,"Exception thrown at ExecuteRichApiRequestMethod: "+qb.toString()),this.vh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,this.FH()}}else this.vh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,this.FH()}KSi(L,ca){this.errorCode=ca;this.errorCode===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&(this.yo.Data=L);this.FH()}get description(){return"Run ExecuteRichApi Invocation Completed."}}Object(k.a)(em,
"ExecuteRichApiRequestMethod",Cg,[]);class nj extends Cg{constructor(){super()}go(){this.yo={};this.Wq()}Wq(){const L=this.HAb.DHj();n.ULS.sendTraceTag(587747344,802,50,"GetAccessToken was called!");const ca=(X,qb)=>{X===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?(qb=qb.accessToken,this.yo[OSF.DDA.Marshaling.SingleSignOn.AccessTokenResultKeys.AccessToken]=qb):(qb=this.Kd.u_.FW(this.controlId),n.ULS.sendTraceTag(587747343,802,10,"{0}",{["errorCode"]:X.toString(),["appId"]:qb.ap.id,["storeType"]:qb.ap.storeType}));
this.vh=X;this.FH()};this.ryj.execute(X=>{const qb=this.Kd.vl,Rb=jc.getInstance();Ag.AppsForOfficeSingleSignOnManager.getInstance(qb,X,Rb).getAccessToken(this.controlId,L,this.parameters,ca)})}get description(){return"Postmessage to wac host layer to get an access token for Addin."}}Object(k.a)(nj,"GetAccessTokenMethod",Cg,[]);class vk extends Cg{constructor(){super()}Wq(){let L=null;this.qu&&(L=Microsoft.Office.WebExtension.ActiveView.Edit);L?(this.result[Microsoft.Office.WebExtension.Parameters.Data]=
L,this.vh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):this.vh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}get description(){return"Returns the ActiveView value for current mode."}}Object(k.a)(vk,"GetActiveViewMethod",Cg,[]);var wk=d(1124);class yl extends Cg{constructor(){super()}go(){this.yo={};this.Wq()}Wq(){var L=this.Zc.vl.getOsfControl(this.controlId);if(!C.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.OEP.Block3PGetAuthContext",!1)||L.isFirstParty()){L=L.getManifest();
var ca=L.getMarketplaceID(),X=L.getWebApplicationId(),qb=L.getWebApplicationMsaId();Bc.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getAuthContext(ca).then(Rb=>{this.errorCode=0;const Qc={};Qc[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Upn]=Rb.upn;Qc[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.UserId]=Rb.userId;Qc[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AppId]=X;Qc[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.MsaAppId]=qb?qb:X;Qc[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Authority]=
Rb.authority;Qc[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthorityType]=wk.a.o2i(Rb.authorityType);Qc[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.IsAnonymous]=Rb.isAnonymous;Qc[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.TenantId]=Rb.tenantId;Qc[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.SupportsAuthToken]=Rb.supportsAuthToken;this.yo[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthContext]=Qc;this.FH()},Rb=>{this.vh=1;this.yo[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Error]=
Rb;this.FH()})}}get description(){return"Return authentication context needed by WebAuth stack."}}Object(k.a)(yl,"GetAuthContextMethod",Cg,[]);class tg extends Cg{constructor(){super()}go(){this.yo={};this.Wq();this.vh!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&this.FH()}Wq(){var L=this.parameters[OSF.DDA.Marshaling.File.ParameterKeys.Handle.toString()];const ca=this.parameters[OSF.DDA.Marshaling.File.ParameterKeys.SliceIndex.toString()];L=this.Sca.YXf(L);!L||ca*L.swh>=L.fileSize?this.vh=OSF.DDA.ErrorCodeManager.errorCodes.ooeIndexOutOfRange:
(vh.BCi(this.Kd.presentationId,this.controlId,L.L1d,ca,L.swh,Object(u.a)(this,this.l1b,"customizedOnFinished"),Object(u.a)(this,this.k1b,"customizedOnError")).start(),this.vh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}l1b(L,ca){L?0===ca.errorCode?(L=ca.value,this.yo[OSF.DDA.Marshaling.File.SlicePropertiesKeys.Data.toString()]=L,this.yo[OSF.DDA.Marshaling.File.SlicePropertiesKeys.SliceSize.toString()]=L.length,this.vh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):this.vh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError:
this.vh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;this.FH()}k1b(){this.vh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;this.FH()}get description(){return"Returns the specified slice."}}Object(k.a)(tg,"GetDocumentCopyChunkMethod",Cg,[]);class Pi extends Cg{constructor(){super();this.Nea=this.Dla=0}go(){this.yo={};this.Wq();this.vh!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&this.FH()}Wq(){try{const L=this.parameters[OSF.DDA.Marshaling.File.ParameterKeys.FileType.toString()];
this.Nea=this.parameters[OSF.DDA.Marshaling.File.ParameterKeys.SliceSize.toString()];if(1>this.Nea||4194304<this.Nea)ne.a.J(17310339,802,50,"GetDocumentCopyMethod: Invalid slice size: "+this.Nea),this.vh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidSliceSize;else{switch(L){case 1:this.Dla=4;break;case 2:this.Dla=3;break;default:ne.a.J(17310341,802,50,"GetDocumentCopyMethod: Unsupported file type: "+L);this.vh=OSF.DDA.ErrorCodeManager.errorCodes.ooeFileTypeNotSupported;return}this.Sca.Dfg(this.controlId,
this.Dla)?this.vh=OSF.DDA.ErrorCodeManager.errorCodes.ooeMemoryFileLimit:this.Sca.oDa.count>=this.Kd.rPd.od.pptEditorAppForOfficeMaxDocumentReaders?this.vh=OSF.DDA.ErrorCodeManager.errorCodes.ooeTooManyIncompleteRequests:(this.i0k.j3(!1,!0,()=>{this.t0k()},Object(u.a)(this,this.Yxa,"saveFailureCallback")),this.vh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}}catch(L){ne.a.J(17310343,802,10,"Exception thrown at GetDocumentCopyMethod: "+L.toString()),this.vh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}}t0k(){vh.CCi(this.Kd.presentationId,
this.controlId,this.Dla,this.Nea,Object(u.a)(this,this.l1b,"customizedOnFinished"),Object(u.a)(this,this.k1b,"customizedOnError")).start()}Yxa(){this.vh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;this.FH();return!1}l1b(L,ca){if(L&&L.length){L=ca.format;var X=ca.sliceSize,qb=ca.errorCode;0===qb?(ca=ca.fileSize,this.yo[OSF.DDA.Marshaling.File.FilePropertiesKeys.FileSize.toString()]=ca,ca=this.Sca.Emi(this.controlId,ca,X,L),this.yo[OSF.DDA.Marshaling.File.FilePropertiesKeys.Handle.toString()]=
ca,this.vh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):this.vh=174===qb?OSF.DDA.ErrorCodeManager.errorCodes.ooeMemoryFileLimit:175===qb?OSF.DDA.ErrorCodeManager.errorCodes.ooeTooManyIncompleteRequests:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}else this.vh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;this.FH()}k1b(L,ca){this.vh=ca?OSF.DDA.ErrorCodeManager.errorCodes.ooeNetworkProblemRetrieveFile:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;this.FH()}get description(){return"Returns the entire document file in slices."}}
Object(k.a)(Pi,"GetDocumentCopyMethod",Cg,[]);class Jl extends Cg{constructor(){super()}Wq(){this.vh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;try{const L=this.e2i(),ca=this.qu.j7i(L);ca&&(this.yo[""+OSF.DDA.Marshaling.ThemingKeys.DocumentTheme]=ca,this.vh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}catch(L){ne.a.J(17687510,802,10,"Exception thrown at GetDocumentThemeMethod: "+L)}}get description(){return"Returns the DocumentTheme (equivalent to AppForOfficeTheme) value for slide."}}
Object(k.a)(Jl,"GetDocumentThemeMethod",Cg,[]);class pm extends Cg{constructor(){super()}Wq(){this.vh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;let L=null;if(this.qu&&void 0!==(L=this.qu.Wvb())&&null!==(L=this.qu.Wvb())){var ca={};ca[OSF.DDA.Marshaling.FilePropertiesKeys.Url.toString()]=L;this.result[OSF.DDA.Marshaling.FilePropertiesKeys.Properties.toString()]=ca;this.vh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}}get description(){return"Returns the file properties. Now it only returns the URL."}}
Object(k.a)(pm,"GetFilePropertiesMethod",Cg,[]);class hn extends Cg{constructor(){super()}Wq(){this.vh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidApiCallInContext}get description(){return"(Not implemented) Returns OfficeTheme properties."}}Object(k.a)(hn,"GetOfficeThemeMethod",Cg,[]);class Em extends Cg{constructor(){super()}Wq(){this.vh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;if(this.qu)try{var L=this.parameters[OSF.DDA.WAC.UniqueArguments.GetData].CoerceType.toString();L===Microsoft.Office.WebExtension.CoercionType.SlideRange?
(L=null,this.vh=({n2k:L}=this.qu.Wgj()).returnValue,this.yo[OSF.DDA.WAC.UniqueArguments.Data]=L):L===Microsoft.Office.WebExtension.CoercionType.Text?(L=null,this.vh=({Soc:L}=this.qu.$gj()).returnValue,this.yo[OSF.DDA.WAC.UniqueArguments.Data]=L):this.vh=OSF.DDA.ErrorCodeManager.errorCodes.ooeCoercionTypeNotSupported}catch(ca){ne.a.J(8958164,802,10,"Exception thrown at GetSelectedDataMethod: "+ca.toString())}}get description(){return"Get data contained in the current selection of the document."}}Object(k.a)(Em,
"GetSelectedDataMethod",Cg,[]);class fm extends Cg{constructor(){super()}Wq(){var L=this.a4d();if(L){const ca={};ca.Settings=this.p3d(L.settings);this.yo[OSF.DDA.Marshaling.SettingsKeys.SerializedSettings]=ca;this.vh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}else L="AppForOffice instance could not be found for ID "+this.controlId+dg.Debug.Ot(),ne.a.J(8958160,802,10,L),this.vh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}get description(){return"Loads/Refreshes Settings object for an app"}p3d(L){const ca=
{};let X=0;for(let qb in L)ca[X.toString()]=[qb,L[qb]],X++;return ca}}Object(k.a)(fm,"LoadSettingsMethod",Cg,[]);class qm extends Cg{constructor(){super()}Wq(){n.ULS.sendTraceTag(587747346,802,50,"ExecuteAsync was called!");this.HAb.tka()?(this.vh=Gb.instance.lsa.ohk(this.controlId,this.parameters[OSF.DDA.Marshaling.MessageParentKeys.MessageToParent],this.parameters[Q.a.BOd],this.parameters[OSF.DDA.Marshaling.MessageParentKeys.TargetOrigin]),this.vh!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&
n.ULS.sendTraceTag(587747345,806,10,"ExecuteAsync failed. Error code: {0}",this.vh.toString())):this.vh=OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported}get description(){return"Run messageParent method."}}Object(k.a)(qm,"MessageParentMethod",Cg,[]);class Ik extends Cg{constructor(){super()}Wq(){this.vh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;if(this.qu)try{const L=this.parameters[OSF.DDA.Marshaling.NavigationKeys.NavigationRequest],ca=L[OSF.DDA.Marshaling.NavigationKeys.GoToType],
X=L[OSF.DDA.Marshaling.NavigationKeys.Id].toString();this.vh=ca===OSF.DDA.Marshaling.GoToType.Index?this.qu.Xnj(X):ca===OSF.DDA.Marshaling.GoToType.Slide?this.qu.Ynj(X):OSF.DDA.ErrorCodeManager.errorCodes.ooeUnsupportedEnumeration}catch(L){ne.a.J(8958162,802,10,"Exception thrown at navigatetomethod: "+L.toString())}}get description(){return"Go to the slide specified by user."}}Object(k.a)(Ik,"NavigateToMethod",Cg,[]);class Jk extends Cg{constructor(){super();this.jte=0}go(){this.yo={};this.Wq();this.vh!==
OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&this.FH()}Wq(){this.jte=this.parameters[OSF.DDA.Marshaling.File.ParameterKeys.Handle.toString()];const L=this.Sca.YXf(this.jte);L?(vh.IIf(this.Kd.presentationId,this.controlId,L.L1d,!1,!1,Object(u.a)(this,this.l1b,"customizedOnFinished"),Object(u.a)(this,this.k1b,"customizedOnError")).start(),this.vh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):this.vh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSpecifiedIdNotExist}l1b(L,ca){L?0===ca.errorCode?(this.vh=
OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,this.Sca.tRk(this.jte)):this.vh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError:this.vh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;this.FH()}k1b(){this.vh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;this.FH()}get description(){return"Closes the document file."}}Object(k.a)(Jk,"ReleaseDocumentCopyMethod",Cg,[]);class Kl extends Cg{constructor(){super();this.RHa=null}Wq(){var L=this.a4d();if(L){var ca=this.parameters[OSF.DDA.WAC.UniqueArguments.SettingsRequest];
this.RHa=this.p3d(Array.isArray(ca[OSF.DDA.Marshaling.SettingsKeys.SerializedSettings])?ca[OSF.DDA.Marshaling.SettingsKeys.SerializedSettings]:null);ca=null;L.taskpane&&(ca=L.taskpane.ownerAddinSolutionId);var X;if(L.taskpane&&ca)if(X=this.Kd.qDa(ca)){this.qu.ORe(X,this.RHa);if(X=this.Kd.u_.$3d(ca))X.settings=this.RHa;L.settings=this.RHa;this.Kd.k3e(ca,this.RHa);this.vh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}else this.vGc.I8f(ca,this.RHa,this.Zc)?(L.settings=this.RHa,this.vh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):
this.vh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;else(X=0===L.Tw?this.Kd.zTf(L.shape.slideId,L.shape.id):this.Kd.qDa(L.ap.id))?(this.qu.ORe(X,this.RHa),L.settings=this.RHa,this.vh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):this.vh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}else L="AppForOffice instance could not be found for ID "+this.controlId+dg.Debug.Ot(),ne.a.J(9052994,802,10,L),this.vh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}get description(){return"Saves settings to document."}p3d(L){const ca=
{};if(L)for(let X=0;X<L.length;X++){const qb=Array.isArray(L[X])?L[X]:null;qb&&1<qb.length&&(ca[qb[0]]=qb[1])}return ca}}Object(k.a)(Kl,"SaveSettingsMethod",Cg,[]);class Fm extends Cg{constructor(){super()}Wq(){this.HAb.tka()?(Gb.instance.lsa.W2k(this.controlId,this.parameters[OSF.DDA.Marshaling.SendMessageKeys.MessageContent],this.parameters[Q.a.BOd],this.parameters[OSF.DDA.Marshaling.SendMessageKeys.TargetOrigin]),this.vh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):this.vh=OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported}get description(){return"Run sendMessage/messageChild method."}}
Object(k.a)(Fm,"SendMessageMethod",Cg,[]);class ck extends Cg{constructor(){super()}Wq(){this.vh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;if(this.qu)try{const ca=this.parameters[OSF.DDA.WAC.UniqueArguments.SetData];var L=ca.CoerceType.toString();const X=ca[OSF.DDA.WAC.UniqueArguments.Data];if(L===Microsoft.Office.WebExtension.CoercionType.Text)this.vh=this.qu.d9k(X);else{let qb;if(L===Microsoft.Office.WebExtension.CoercionType.Image)qb=0;else if(L===Microsoft.Office.WebExtension.CoercionType.XmlSvg)qb=
1;else{this.vh=OSF.DDA.ErrorCodeManager.errorCodes.ooeCoercionTypeNotSupported;return}L=!1;let Rb=0,Qc=0,jd=0,vd=0;({Mwj:L,x:Rb,y:Qc,width:jd,height:vd}=this.ATi(ca,L,Rb,Qc,jd,vd));this.vh=this.qu.Z8k(X,L,Rb,Qc,jd,vd,qb)}}catch(ca){ne.a.J(17310337,802,10,"Exception thrown at SetSelectedDataMethod: "+ca)}}ATi(L,ca,X,qb,Rb,Qc){const jd=L[OSF.DDA.Marshaling.SetDataKeys.ImageLeft],vd=L[OSF.DDA.Marshaling.SetDataKeys.ImageTop];void 0!==jd&&null!==jd&&"number"===typeof jd&&void 0!==vd&&null!==vd&&"number"===
typeof vd&&(ca=!0,X=jd,qb=vd);L[OSF.DDA.Marshaling.SetDataKeys.ImageWidth]&&(Rb=L[OSF.DDA.Marshaling.SetDataKeys.ImageWidth]);L[OSF.DDA.Marshaling.SetDataKeys.ImageHeight]&&(Qc=L[OSF.DDA.Marshaling.SetDataKeys.ImageHeight]);return{Mwj:ca,x:X,y:qb,width:Rb,height:Qc}}get description(){return"Writes data to the current selection in the document."}}Object(k.a)(ck,"SetSelectedDataMethod",Cg,[]);class Ui extends td{constructor(L){super(L)}cBk(){this.Mec={};this.set(OSF.DDA.MethodDispId.dispidLoadSettingsMethod,
()=>new fm);this.set(OSF.DDA.MethodDispId.dispidSaveSettingsMethod,()=>new Kl);this.set(OSF.DDA.MethodDispId.dispidGetActiveViewMethod,()=>new vk);this.set(OSF.DDA.MethodDispId.dispidNavigateToMethod,()=>new Ik);this.set(OSF.DDA.MethodDispId.dispidGetSelectedDataMethod,()=>new Em);this.set(OSF.DDA.MethodDispId.dispidGetFilePropertiesMethod,()=>new pm);this.set(OSF.DDA.MethodDispId.dispidGetDocumentThemeMethod,()=>new Jl);this.set(OSF.DDA.MethodDispId.dispidGetOfficeThemeMethod,()=>new hn);this.set(OSF.DDA.MethodDispId.dispidSetSelectedDataMethod,
()=>new ck);this.set(OSF.DDA.MethodDispId.dispidGetDocumentCopyMethod,()=>new Pi);this.set(OSF.DDA.MethodDispId.dispidGetDocumentCopyChunkMethod,()=>new tg);this.set(OSF.DDA.MethodDispId.dispidReleaseDocumentCopyMethod,()=>new Jk);this.set(OSF.DDA.MethodDispId.dispidAppCommandInvocationCompletedMethod,()=>new hl);this.set(OSF.DDA.MethodDispId.dispidMessageParentMethod,()=>new qm);this.set(OSF.DDA.MethodDispId.dispidSendMessageMethod,()=>new Fm);this.set(OSF.DDA.MethodDispId.dispidGetAccessTokenMethod,
()=>new nj);this.set(OSF.DDA.MethodDispId.dispidGetAuthContextMethod,()=>new yl);this.set(OSF.DDA.MethodDispId.dispidCreateDocumentMethod,()=>new yj);this.set(OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod,()=>new em(this.Zc.GZk,this.Zc.fEk,this.Zc.o_))}}Object(k.a)(Ui,"EditorMethodFactory",td,[]);class Ch extends Sys.EventArgs{constructor(L){super();this.xSh=L}get instanceId(){return this.xSh}}Object(k.a)(Ch,"FirstPartyAddInHidingEventArgs",Sys.EventArgs,[]);class Ba{constructor(){this.sWa=
{};this.uue={};this.$8c={};this.h5c={}}Tpf(L,ca){ca&&L&&(this.sWa[L]=ca,this.h5c[L]=!1)}p4h(L,ca){L&&ca&&(this.$8c[L]=ca)}pRk(L){if(L){var ca=this.sWa[L];ca&&(delete this.$8c[ca.ap.id],delete this.sWa[L],delete this.uue[L],delete this.h5c[L])}}FW(L){return L?this.sWa[L]:null}A$i(L){return L?this.h5c[L]:!1}Lij(L){return L?this.uue[L]:null}gGh(L,ca){L&&(this.h5c[L]=ca)}wAl(L,ca){L&&(this.uue[L]=ca)}$3d(L){if(!L)return null;const ca=this.sWa;for(let X in ca){const qb=ca[X];if(qb&&qb.ap.id.toLowerCase()===
L.toLowerCase())return qb}return null}a2i(L,ca,X){if(!L||!ca||!X)return null;const qb=this.sWa;for(let Rb in qb){const Qc=qb[Rb];if(Qc&&Qc.taskpane&&Qc.taskpane.ownerAddinSolutionId&&Qc.taskpane.ownerAddinSolutionId.toLowerCase()===L.toLowerCase()){const jd=X.getOsfControl(Qc.instanceId);if(jd&&jd.getSharedRuntimeId()===ca)return Qc}}return null}b3d(L){ib.a.forEach(this.sWa,(ca,X)=>{ca=Object(ha.a)(1048,X);1===ca.Tw&&L(ca)},null)}TVi(L){const ca=this.sWa;for(let X in ca){const qb=Object(ha.a)(1048,
ca[X]);if(qb&&L(qb))return qb}return null}yTf(L){return L in this.$8c?this.$8c[L]:null}}Object(k.a)(Ba,"OsfAppInstacneCache",null,[]);class il{constructor(){}}Object(k.a)(il,"AppForOfficeSDXDialog",null,[1075]);class Gg{constructor(L,ca,X,qb,Rb,Qc,jd,vd,Xd,Ke,jf,wf,eg,Ng,Ug,Ah,We,lk,jm,Kh,$d,xk,Ie,Yd,Pe){this.xCb=!!C.AFrameworkApplication.Aa&&!!C.AFrameworkApplication.Aa.hb&&C.AFrameworkApplication.Aa.hb.bX;this.b0b=!1;this.IAb=this.oea=this.Zne=this.Ipf=null;this.va=new T.a;this.Hzg=!1;this.Mo=L;
this.eJ=ca;this.bxe=new Ui(this);this.R1c=new rc(this,Kh);this.bWa=$d;this.KVa=qb;this.Xqg={};this.UF=new Ba;this.T3j=X;this.VAb=Rb.value;this.Uz=jd;this.Pb=Qc;this.PX=vd;this.Qb=Xd;this.I3j=We;this.Kua=Ke;this.Yb=jf;this.vi=wf;this.ua=eg;this.Ea=Ng;this.jc=Ug;this.qc=Ah;this.Zac=jm;this.Hbb=new xa;this.F3j=lk;this.hl=xk;this.ngc=Ie;this.Qfc=Yd;this.w$j=Pe}initialize(){this.e6(this.Qb.mode);this.Qb.IK(Object(u.a)(this,this.v8f,"handleModeSwitch"))}dispose(){this.Qb.wY(Object(u.a)(this,this.v8f,"handleModeSwitch"))}get vGc(){this.Hbb||
(this.Hbb=new xa);return this.Hbb}get vl(){if(!Gg.Iua){this.Mo&&(this.Mo.od.CHj&&OfficeExt.S2SOmexCatalogService.initRequestHandler(new Of),this.Yb.ka("305")&&OfficeExt.PrivateCatalogService.initRequestHandler(new Of,new Od(this.Mo.od.wg?C.AFrameworkApplication.fa.appSettings.AuthProxyHandlerWebServiceBase:C.AFrameworkApplication.fa.appSettings.WebServiceBase),this.Yb.ka("306")),OfficeExt.MosRequestHandler.init(new Of),OfficeExt.ProxyBasedCatalogService.initRequestHandler&&OfficeExt.ProxyBasedCatalogService.initRequestHandler(new Of));
const L=new Bh(this.bxe,this.R1c);this.IAb=this.sF.OAi(this.UF);Gg.Iua=this.T3j.yBi(this.eJ,L,this.IAb);Gg.Iua.setOAuthManager(this.w$j);Gg.Iua&&"undefined"!==typeof Gg.Iua.hostCheckReadyHandler&&C.AFrameworkApplication.y8h(Object(u.a)(Gg.Iua,Gg.Iua.hostCheckReadyHandler,"hostCheckReadyHandler"))}return Gg.Iua}u2e(L){(L=this.vl.getOsfControl(L))&&this.IAb&&this.IAb.c2g(L)}dAb(L,ca,X){this.IAb?this.IAb.kXj(L,ca,X):n.ULS.sendTraceTag(512508178,806,10,"m_appEventListener is null")}Tjb(L,ca,X=null){const qb=
this.sF.R2(L);if(this.Yb.ka("569")&&!OSF.OsfControl.isFirstPartyStoreString(this.ltb(qb.storeType)))this.hl.uda(22)||this.hl.SCa(22);else if(0===qb.Tw)this.KVa.zHj(qb.id)?(X=this.KVa.ora[qb.id],ig.a("Microsoft.Office.SharedOnline.FixBug6808089")?this.KVa.wKa(qb.id,this.FVe(L),ca):(X.aTe(ca),this.KVa.wKa(qb.id,this.FVe(L),null))):(L=this.fpd(L,ca),L.aTe(ca),this.KVa.j0k(qb.id,L));else if(1===qb.Tw){const Rb=qb.node.sa(xb.a.IZ,null);this.aua(qb.id)?qb.Ydg||this.MKb(Rb,!0):this.fpd(L,ca,X);this.Mo.od.Qta&&
!qb.ownerAddinSolutionId&&(ca=this.w9d(qb.Exa),this.k3e(qb.Exa,ca.settings))}}launchInsertDialog(){this.va.raiseEvent("OnInsertionDialogOpened");this.oea=new nb;this.oea.$i("",null,null);this.vl.launchInsertDialog(this.oea.lja)}jXj(L){const ca=this.cGc.t1i(L);this.Mo.QG().La(od.a.jde,2,{version:ca.version,storeType:ca.storeType,storeId:ca.storeId,assetId:ca.assetId,assetStoreId:ca.assetStoreId,targetType:ca.targetType,displayName:ca.displayName,solutionId:L,width:ca.width,height:ca.height})}B0c(L){const ca=
this.vl.getAppUILocale()||"en-US";this.Jpg=new dc(L,"wac_powerpoint",ca,X=>{this.Mo.QG().La(od.a.jde,2,X);this.Jpg.hide()});this.Jpg.$i("",null,null);return!0}sXj(L){this.va.raiseEvent("OnInsertionDialogOpened");this.oea=new nb;this.oea.$i("",null,null);if(L){const ca={navigationMode:0};ca.assetId=L;this.vl.launchInsertDialog(this.oea.lja,"{98143890-AC66-440E-A448-ED8771A02D52}",ca)}else this.vl.launchInsertDialog(this.oea.lja)}Jmg(L){this.va.raiseEvent("OnInsertionDialogOpened");this.oea=new nb;
this.oea.$i("",null,null);this.vl.launchInsertDialog(this.oea.lja,L,{navigationMode:0})}P$f(){this.oea&&this.oea.hide()}kib(L){const ca=this.$Tf(L);ca?this.Cih(ca):n.ULS.sendTraceTag(512508177,806,10,String.format("Failed to find the AppNode with instance id: {0}",L))}Cih(L){const ca=this.sF.R2(L);if(this.Yb.ka("569")&&!OSF.OsfControl.isFirstPartyStoreString(this.ltb(ca.storeType)))this.hl.uda(22)||this.hl.SCa(22);else{var X=(qb,Rb)=>{const Qc=this.sF.R2(qb),jd=this.sF.wKc(C.AFrameworkApplication.isRtl,
Qc.id,Qc.width,Qc.visibility);Rb.OP(jd);this.xCb||jd.yp(Qc.visibility);let vd=Rb=null;this.Mo.od.Qta&&this.Mo.od.cUj&&(vd=this.rjd(L),Rb=()=>{this.QK(jd,!0,!1);this.TNb(vd)});this.Tjb(qb,jd.uGc,Rb);this.xCb&&(vd&&(qb=this.mQ(vd.ap.id).Xba,jd.m$k(qb)),jd.yp(Qc.visibility))};if(this.Mo.od.Qta){const qb=this.sF.R2(L),Rb={};Rb.solutionId=qb.Exa;Rb.version=qb.version;Rb.storeType=this.ltb(qb.storeType);Rb.storeId=qb.store;Rb.targetData=L;this.vl.isAddinCommandsAsync(Rb,(Qc,jd)=>{const vd=this.rjd(L);var Xd=
L.sa(Hf.a.isForUILessAction,!1);const Ke=L.sa(Hf.a.sharedRuntimeId,null),jf=qb.ownerAddinSolutionId,wf=!!vd.Yv&&0<vd.Yv.state&&!!vd.Yv.Xxa;if(!jd&&qb.visibility||jd&&jf&&!wf||Xd&&!ka.a.Wa(Ke))X(L,this.Uz),this.u_.gGh(qb.id,jd);else if(jd){if(Xd=this.u3b(qb.Exa))vd.settings=Xd.settings,this.qu.ORe(L,vd.settings);this.u_.Tpf(vd.instanceId,vd);this.u_.gGh(vd.instanceId,jd);this.k3e(vd.ap.id,vd.settings);if(qb.visibility&&this.Kua.installVisibleAddinCommandsEnabled||wf){if("omex"!==Rb.storeType.toLowerCase()&&
!wf)return;let eg=!1;this.ELe(Ng=>{if(!Ng[Q.a.Mai]){if(Ng[Q.a.dtf])for(const Ug of Ng[Q.a.dtf])if(eg=Hk.e(Ug[1])===Hk.e(qb.Exa))break;eg||this.UEc(vd)}})}}Qc||ne.a.J(512508176,220,10,"Checking AddinCommands fails for {0} from {1}",qb.Exa,this.ltb(qb.storeType))})}else X(L,this.Uz)}}zvb(L){return L&&L.assetId?L.sourceLocationOverrideResourceId?String.format("{0}.{1}",L.assetId,L.sourceLocationOverrideResourceId):L.assetId:null}PVk(L){L.N_b=-1;const ca=this.myf(L);this.rgc=void 0!=L.qMc&&void 0!=L.uMc?
new Kb(L.qMc,L.uMc):new Kb;void 0!=L.dialogLeft&&void 0!=L.tMc&&void 0!=L.dialogTop&&void 0!=L.oMc&&this.rgc.y5k(L.dialogLeft,L.tMc,L.dialogTop,L.oMc);void 0!=L.dialogHeight&&void 0!=L.dialogWidth&&this.rgc.z5k(L.dialogHeight,L.dialogWidth);this.rgc.$i("",null,null);this.fpd(ca,this.rgc.lja,null,L)}AVk(L){ig.a("EnableSDXDialog2")&&(L.N_b=1);const ca=this.myf(L),X=this.sF.R2(ca);if(C.AFrameworkApplication.eke(X.Exa)){const qb=this.sF.wKc(C.AFrameworkApplication.isRtl,X.id,X.width,X.visibility,L);this.Uz.OP(qb);
qb.yp(X.visibility);this.fpd(ca,qb.uGc,null,L)}}ELe(L){const ca={};ca.callback=L;C.AFrameworkApplication.Ta.La(od.a.sZa,2,ca)}UEc(L){const ca=this.sF.wKc(C.AFrameworkApplication.isRtl,L.instanceId,L.taskpane.width,L.taskpane.visibility);this.Uz.OP(ca);ca.yp(L.taskpane.visibility);const X=ca.uGc;Object(ha.a)(1047,this.sF.eWd(this.Mo.od,L,X,C.AFrameworkApplication.isRtl,this)).UEc(this.vl,X,()=>{this.TNb(L);this.QK(ca,!1,!!L.Yv&&!!L.Yv.Xxa);w.a.instance.setItem(Q.a.yOd,"true")})}QK(L,ca,X){L.yp(!1);
X||(Gg.Iua.purgeOsfControl(L.id,!1),ca?this.Mo.QG().La(Ii.a.mVc,2,L.id):this.R1c.lDf(L.id),L.dispose())}TNb(L){var ca={};ca.solutionId=L.ap.id;ca.version=L.ap.version;ca.storeType=L.ap.storeType;ca.storeId=L.ap.store;ca.assetId=null;ca.assetStoreId=null;ca.sharedRuntimeId=L.Yv?L.Yv.Xxa:null;ca.backgroundState=L.Yv?L.Yv.state:-1;L=new e.a;L.add(ca);ca={};ca[Q.a.aGc]=L;ca[Q.a.A7]=3;this.Mo.QG().La(od.a.z0c,2,ca)}uQc(){const L=this.PX.Cf;var ca=null;L&&(ca=new ph.GraphIterator,ca.set(L),ca=ca.Bb(18));
return ca}mQ(L){return L?(L=this.UF.$3d(L))&&L.taskpane?L:null:null}bXi(L,ca,X,qb){if(!L||!ca||!X)return null;L=this.getSharedRuntimeId(ca,qb,L.solutionId,X);return(X=this.UF.a2i(X,L,this.vl))&&X.taskpane?X:null}dPc(L){return L?(L=this.UF.FW(L))&&L.taskpane?L:null:null}qDa(L){if(!L)return null;var ca=this.uQc();if(ca&&(ca=this.Pb.Nc(ca))&&ca.Bb(19)){do{const X=ca.currentNode;if(this.BYb(X.sa(oe.a.arb,null),L))return X}while(ca.Cj(19))}return null}$Tf(L){if(!L)return null;var ca=this.uQc();if(ca&&
(ca=this.Pb.Nc(ca))&&ca.Bb(19)){do{const X=ca.currentNode;if(this.BYb(X.sa(xb.a.IZ,null),L))return X}while(ca.Cj(19))}return null}zTf(L,ca){return(L=this.qc.zl(L))?L.eT(ca):null}WGj(L){return L?this.UF.A$i(L):!1}Jii(L,ca,X,qb,Rb){if(!L||!L)return null;let Qc;if(!(L.solutionId&&L.version&&L.storeId&&L.storeType))return n.ULS.sendTraceTag(512508175,802,15,"Invalid entitlement"),null;Qc=Object(ha.a)(Qh.a,this.VAb.createInstance(1074135137));Qc.setValue(oe.a.arb,L.solutionId);Qc.setValue(oe.a.DGc,L.version);
Qc.setValue(oe.a.CGc,L.storeId);Qc.setValue(xb.a.lYb,this.iKc(L.storeType));Qc.setValue(oe.a.yGc,!1);Qc.setValue(xb.a.IZ,Xe.a.create().toString());Qc.setValue(oe.a.nPd,"right");Qc.setValue(oe.a.oYb,X);Rb&&Qc.setValue(Hf.a.isForUILessAction,Rb);qb&&(Qc.setValue(xb.a.U7g,qb),(L=this.getSharedRuntimeId(ca,Rb,L.solutionId,qb))&&Qc.setValue(Hf.a.sharedRuntimeId,L));return Qc}b4d(L){L=this.qDa(L);return this.rjd(L)}Iii(L,ca){if(!(L&&L&&L.solutionId&&L.version&&L.storeId&&L.storeType))return null;L=new Ma(L.solutionId,
L.version,L.storeId,L.storeType);ca=ca?new Lg(0,ca):null;return new Fg(L,null,null,null,null,{},1,ca)}FZd(L){Ag.AppsForOfficeSingleSignOnManager.Jpi(L);const ca=this.UF.FW(L);ca&&(Gg.Iua.purgeOsfControl(ca.instanceId,!1),this.R1c.lDf(ca.instanceId),this.UF.pRk(ca.instanceId),this.KVa.Egh(ca.instanceId),this.bWa.tnc(this.presentationId,L,!1,!0))}notifyAgave(L,ca){this.vl.notifyAgave(L,ca)}xOk(L){!this.Hzg&&L.Tj&&(L=L.Tj,L.Ad(47).y7(Object(u.a)(this,this.huf,"appDisposeHandler")),L.Ad(10).y7(Object(u.a)(this,
this.huf,"appDisposeHandler")),this.Hzg=!0)}huf(L,ca){L=ca.node;ca=1074135137===L.Se;if(L.sa(xb.a.Cq,!1)||ca)L=this.sF.R2(L),this.FZd(L.id)}myf(L){const ca=Object(ha.a)(9,this.VAb.createInstance(1074135137));ca.setValue(oe.a.DGc,"1.0.0.0");ca.setValue(oe.a.CGc,"en-US");ca.setValue(xb.a.IZ,Xe.a.create().toString());ca.setValue(oe.a.oYb,!0);ca.setValue(xb.a.gPd,null);ca.setValue(xb.a.fuf,null);ca.setValue(oe.a.arb,this.zvb(L));L.ZLa?(ca.setValue(oe.a.mYb,"sdxcatalog"),ca.setValue(xb.a.lYb,this.iKc("sdxcatalog"))):
(ca.setValue(oe.a.mYb,"firstparty"),ca.setValue(xb.a.lYb,this.iKc("firstparty")));ca.setValue(xb.a.isAddinCommands,!1);ca.setValue(oe.a.yGc,!1);ca.setValue(oe.a.nPd,"right");return ca}rjd(L,ca=null){if(!L)return null;L=this.sF.R2(L);var X=this.ltb(L.storeType);const qb=new Ma(L.Exa,L.version,L.store,X);let Rb=null,Qc=null,jd;if(ig.a("EnableSDXDialog2")&&-1==(null===ca||void 0===ca?void 0:ca.N_b))jd=new il;else if(0===L.Tw)Rb=new $a(L.shapeId,L.slideId);else if(1===L.Tw)Qc=new Eb(L.BNf,L.visibility,
L.width,L.row,L.ownerAddinSolutionId,L.ownerAddinStoreType,L.Ydg);else return null;let vd={};ca&&OSF.OsfControl.isFirstPartyStoreString(X)?vd=OSF.OUtil.serializeSettings(ca.nonPersistedSettings):L.ownerAddinSolutionId||(vd=L.settings);X=L.c6a?new Lg(L.Brb,L.c6a):null;return ig.a("EnableSDXDialog2")?new Fg(qb,L.id,Rb,Qc,jd,vd,jd&&ca?ca.N_b:L.Tw,X):new Fg(qb,L.id,Rb,Qc,null,vd,L.Tw,X)}Gfh(L,ca=null){if(this.Yb.ka("883")){var X=this.vl.getOsfControl(L);if(X&&ca){ca.nonPersistedSettings&&X.setSettings(OSF.OUtil.serializeSettings(ca.nonPersistedSettings));
if(ca.TE){const qb=Object(ha.a)(1048,this.dPc(L));qb&&(qb.Xba=ca.TE,this.xCb&&this.MKb(L,!0))}X.refresh();this.u2e(L)}}}fpd(L,ca,X=null,qb=null){const Rb=this.rjd(L,qb);if(!Rb||OSF.OsfControl.isFirstPartyStoreString(Rb.ap.storeType)&&!C.AFrameworkApplication.eke(Rb.ap.id))return null;var Qc=this.sF.R2(L);if(this.Yb.ka("569")&&!OSF.OsfControl.isFirstPartyStoreString(this.ltb(Qc.storeType)))return this.hl.uda(22)||this.hl.SCa(22),null;qb&&qb.TE&&(Rb.Xba=qb.TE);Qc=Object(ha.a)(1047,this.sF.eWd(this.Mo.od,
Rb,ca,C.AFrameworkApplication.isRtl,this));this.UF.Tpf(Rb.instanceId,Rb);this.UF.p4h(Rb.ap.id,ca);qb&&qb.p5&&qb.p5();this.Mo.od.Qta&&Rb.taskpane&&Rb.taskpane.ownerAddinSolutionId&&(ca=this.UF.$3d(Rb.taskpane.ownerAddinSolutionId))&&this.pFh(ca.instanceId,Rb.instanceId);Qc.Xel(this.vl,this.FVe(L),X,qb,this.Kua.powerPointDragInsertImageIsEnabled);Rb.taskpane&&Rb.taskpane.ownerAddinSolutionId||this.xOk(L);return Qc}cAh(L){if(this.Kua.UUj){const X=this.u_.FW(L);if(X&&0===X.Tw&&X.shape){var ca=this.u_.Lij(L);
const qb=new Date;!ca||qb.getTime()-ca.getTime()>=this.Kua.pptEditorAppForOfficeSnapshotIntervalTime?(n.ULS.sendTraceTag(512508173,806,50,"Start to generate addin [{0}] {1} snapshot",X.ap.id,L),(ca=this.I3j.cHf(1,L))?(this.u_.wAl(L,qb),ca.execute(this,this.F3j,null)):n.ULS.sendTraceTag(512508172,806,50,"Snapshot action is null for addin [{0}] {1}.",X?X.ap.id:"AppNotExist",L)):n.ULS.sendTraceTag(512508171,806,50,"Addin [{0}] {1} snapshot interval is less than config interval threshold.",X?X.ap.id:
"AppNotExist",L)}}}h4g(L,ca,X,qb){1===L&&this.Ltk(ca,X,qb)}Ltk(L,ca,X){let qb=null;X&&X.result&&(X=X.result,qb=X.substr(X.indexOf("base64,")+7));const Rb=this.u_.FW(L);ca===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&qb&&0<qb.length&&Rb?0===Rb.Tw&&Rb.shape&&Rb.ap&&this.vi.EFh(Rb.shape.slideId.toString(),Rb.shape.id,qb,()=>{n.ULS.sendTraceTag(512508170,806,50,"Update addin [{0}] {1} snapshot succeed with {2} bytes",Rb.ap.id,L,qb.length)},()=>{n.ULS.sendTraceTag(512508169,806,10,"Update addin [{0}] {1} snapshot failed",
Rb.ap.id,L);return!1}):n.ULS.sendTraceTag(512508168,806,10,"Generate addin [{0}] {1} snapshot failed with {2} bytes",Rb?Rb.ap.id:"AppNotExist",L,qb?qb.length:0)}u3b(L){return L?this.Xqg[L]:null}pFc(L,ca){L&&ca&&(this.Xqg[L]=ca)}get qu(){this.Zne||(this.Zne=new bg(this.Mo.od,Bc.a.instance.resolve("Common.IAppSettingsManager"),this.eJ,Bc.a.instance.re("Box4.IOutlineEditor"),Bc.a.instance.re("Box4.ISelectionManager"),Bc.a.instance.re("Box4.ICharacterPropertiesEditor"),Bc.a.instance.re("PowerPointWebEditor.IClassFactory"),
Bc.a.instance.resolve("Common.Transaction.ITransactionFactory"),this.Mo.QG(),Bc.a.instance.resolve("PowerPointWebEditor.IPPTWorkspace"),Bc.a.instance.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Bc.a.instance.resolve("PowerPointWebEditor.IPresentationReader"),Bc.a.instance.resolve("PowerPointWebEditor.ISlideReader"),Bc.a.instance.resolve("PowerPointWebEditor.IAppforOfficeClassFactory"),Bc.a.instance.resolve("PowerPointWebEditor.IPptSelectionManager"),Bc.a.instance.resolve("PowerPointWebEditor.View.IPPTPageView"),
Bc.a.instance.resolve("PowerPointWebEditor.IShapeEditor"),Bc.a.instance.resolve("PowerPointWebEditor.IShapeReader"),Bc.a.instance.resolve("Box4.Graph.IGraphIteratorFactory"),Bc.a.instance.resolve("Box4.IOutlineElementNavigator"),Bc.a.instance.resolve("Box4.IParagraphReader"),Bc.a.instance.resolve("PowerPointWebEditor.IRibbonChangeManager"),Bc.a.instance.resolve("Common.App.NewAndOpen.UX.NewDocumentFromStreamOperationFactory")));return this.Zne}get Sca(){return this.bWa}DZa(L,ca,X){this.R1c.Z3d(L).raiseEvent(X,
ca)}wdh(L,ca){this.UF.b3d(X=>{this.DZa(L,X.instanceId,ca)})}pFh(L,ca){if(L&&ca){L=this.u_.FW(L);var X=this.u_.FW(ca);L&&X&&(X.settings=L.settings,this.m4g(ca,L.settings))}}k3e(L,ca){L&&ca&&this.u_.b3d(X=>{this.BYb(X.taskpane.ownerAddinSolutionId,L)&&!this.vGc.AHj(X.settings,ca)&&(X.settings=ca,this.m4g(X.instanceId,ca))})}v8f(L){this.e6(L.mode)}e6(L){if(1!==L&&2!==L)throw Error.invalidOperation(String.format("The mode '{0}' being swtiched to is unsupported.",L));n.ULS.sendTraceTag(512508167,806,50,
"AppForOfficeManager.SwitchToMode: {0} the content add-in's container on active slide.",2===L?"Show":"Edit");this.KVa.e6(L);this.Uz.e6(L)}m4g(L,ca){const X=OSF.DDA.EventDispId.dispidSettingsChangedEvent.toString();this.DZa(X,L,ca)}ltb(L){switch(L){case 0:L="spcatalog";break;case 1:L="filesystem";break;case 2:L="omex";break;case 3:L="spapp";break;case 4:L="registry";break;case 5:L="inmemory";break;case 6:L="uploadfiledevcatalog";break;case 7:L="excatalog";break;case 8:L="firstparty";break;case 9:L=
"sdxcatalog";break;default:throw Error.create(String.format("[{0}] is not the valid store type int value.",L));}return L}iKc(L){if(!L)throw Error.create("Store Type should not be null.");Gg.L5||Gg.bCj();if(L in Gg.L5)return Gg.L5[L];throw Error.create(String.format("[{0}] is not the valid store type.",L));}w9d(L){return L?this.UF.TVi(ca=>this.BYb(ca.ap.id,L)):null}get rPd(){return this.Mo}v9h(L){this.va.addHandler("OnInsertionDialogOpened",L)}KFc(L){this.va.addHandler("OnFirstPartyAddInHidden",L)}QTk(L){this.va.removeHandler("OnFirstPartyAddInHidden",
L)}YIk(L){this.va.raiseEvent("OnFirstPartyAddInHidden",new Ch(L))}hUd(L){const ca=Bg.a.gpa(this.Uz.A2,X=>X.id===L);if(1!==ca.length)return!1;this.QK(ca[0],!0,this.aua(L));return!0}MKb(L,ca){const X=Bg.a.gpa(this.Uz.A2,qb=>qb.id===L);1!==X.length?ne.a.J(512508166,220,50,"Panes with appropriate instance id are {0}",X.length):X[0].yp(ca)}o1i(L){const ca=Bg.a.gpa(this.Uz.A2,X=>X.id===L);return 1!==ca.length?(ne.a.J(512508165,220,50,"Panes with appropriate instance id are {0}",ca.length),!1):ca[0].isVisible}Xul(L,
ca){const X=this.u3b(L);X&&X.Yv&&X.Yv.Xxa&&(X.Yv.state=ca?1:0,(this.qDa(L)||this.vGc.I8f(L,X.settings,this))&&this.Mo.QG().La(Ii.a.sFh,2,X))}p1i(L){return(L=this.u3b(L))&&L.Yv?1===L.Yv.state:!1}WDf(L){this.u_.b3d(ca=>{this.BYb(ca.taskpane.ownerAddinSolutionId,L)&&this.hUd(ca.instanceId)})}Dvb(L){return this.UF.FW(L)}aua(L){if(!L||4===this.vl.getOsfControlStatus(L))return!1;L=this.vl.getOsfControl(L);return!!L&&!!L.getSharedRuntimeId()}setInitialDisplayMode(L,ca){(L=this.vl.getOsfControl(L))&&L.setInitialDisplayMode(ca)}getSharedRuntimeId(L,
ca,X,qb){if(!L)return null;const Rb=new If;if(!Rb)return null;if(ca)return L.getSharedRuntimeId(Rb.jT,ca,null);X=(new ab("",qb,Rb,!0)).bKf(X.substr(qb.length));return L.getSharedRuntimeId(Rb.jT,ca,X)}xXi(L,ca){const X={};X.visibility=ca?"Visible":"Hidden";ca=JSON.stringify(X);this.oUf(L,65539,"",ca)}zXi(L,ca,X){this.oUf(L,1,ca,X)}Ehl(L,ca){L=new Ma(L.solutionId,L.version,L.storeId,L.storeType);var X=new Eb("right",!0,350,0,null,null,!1);L=new Fg(L,Kd.a.create().toString(),null,X,null,{},1,null);const qb=
this.sF.wKc(C.AFrameworkApplication.isRtl,L.instanceId,L.taskpane.width,L.taskpane.visibility);this.Uz.OP(qb);qb.yp(L.taskpane.visibility);X=qb.uGc;Object(ha.a)(1047,this.sF.eWd(this.Mo.od,L,X,C.AFrameworkApplication.isRtl,this)).UEc(this.vl,X,()=>{this.QK(qb,!1,!1);ca()})}oUf(L,ca,X,qb){var Rb=Array(6);Rb[0]=65536;Rb[1]=ca;Rb[2]=X;Rb[3]=qb;Rb[4]=-1;Rb[5]=!1;ca=Array(1);ca[0]=Rb;Rb=new ac(OSF.DDA.EventDispId.dispidRichApiMessageEvent,L,null,ca);this.DZa(OSF.DDA.EventDispId.dispidRichApiMessageEvent.toString(),
L,Rb)}BYb(L,ca){return L&&ca?L.toLowerCase()===ca.toLowerCase():!1}FVe(L){return!this.Qb||1!==this.Qb.mode||L&&"FA000000012"===L.sa(xb.a.gPd,null)?1===this.sF.R2(L).Tw?!0:this.Ea.wFa(L)?this.ua.Ba===this.jc.mg(L):!1:!1}get presentationId(){return this.Mo.MSa().presentationId}get WFf(){return this.KVa}get u_(){return this.UF}get sF(){return this.Zac.value}get GZk(){return this.ngc}get fEk(){return this.Qfc}get o_(){return this.ua}static bCj(){Gg.L5={};Gg.L5.inmemory=5;Gg.L5.uploadfiledevcatalog=6;
Gg.L5.spcatalog=0;Gg.L5.omex=2;Gg.L5.registry=4;Gg.L5.spapp=3;Gg.L5.filesystem=1;Gg.L5.excatalog=7;Gg.L5.firstparty=8;Gg.L5.sdxcatalog=9}get btf(){return this.cGc}get cGc(){this.hGc&&!this.Hpg&&(this.Hpg=new yh(new Rj.a({["AppsForOfficeAllowExternalMarketplace"]:this.Kua.Uge.toString(),["AppsForOfficeThirdPartyIsDisabled"]:this.Kua.C9b.toString(),["AreThirdPartyAddInsAllowed"]:this.Kua.tia.toString(),["PopularAddinDetailsJsonString"]:Gg.Qgd}),new Ia.a(()=>this.vl)));return this.Hpg}get hGc(){return this.Yb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",
!1)}Z$(L,ca){this.cGc&&this.cGc.Z$(L,ca)}static get Qgd(){return'[{"displayName":"QR4Office","solutionId":"wa104051163","iconUrl":"https://store-images.s-microsoft.com/image/apps.53638.20ce8aca-39c5-4b97-b87a-47d0f3e21e0d.0b60ea0f-7e02-4465-baeb-bb55c723d670.9147ef8e-cf16-47cf-af10-ef553e88804d.png","addinInfo":{"priority":1,"AUP":1}},{"displayName":"Pickit | Make impactful presentations in minutes","solutionId":"wa104178141","iconUrl":"https://store-images.s-microsoft.com/image/apps.52119.865d61ab-6329-4325-ab0d-d26b79dacfb7.7c9712b0-85a4-4901-839e-2ac101b87124.5e9898d6-d6c2-49a0-8098-1eb30d35701b.png","addinInfo":{"priority":1,"AUP":1720}},{"displayName":"Poll Everywhere Presenter","solutionId":"wa104218073","iconUrl":"https://store-images.s-microsoft.com/image/apps.27009.88b1aa30-f74d-43ab-b5f6-4565d9a70427.06bc2362-a830-44c4-84e3-f5b99c45acf8.47ba58ff-e53f-4c3e-bea2-3aa7562d1cc6.png","addinInfo":{"priority":1,"AUP":1542}},{"displayName":"Web Video Player","solutionId":"wa104221182","iconUrl":"https://store-images.s-microsoft.com/image/apps.21223.8fa8e2cf-70f0-4b35-ab45-a587c415721d.71d26e67-e3a5-4499-af2a-87e1ada53aca.91b974c8-435a-45c4-bbc7-167fa1d34ffb.png","addinInfo":{"priority":1,"AUP":967}},{"displayName":"Web Viewer","solutionId":"wa104295828","iconUrl":"https://store-images.s-microsoft.com/image/apps.53665.f48f5d64-1b9c-4db4-8579-0a8a770cc1df.479bd539-f5d1-4edd-8d3f-fd2aa12fe078.d7ba8494-d2ee-426a-985a-25a7db9bf8f5.png","addinInfo":{"priority":1,"AUP":2132}},{"displayName":"Mentimeter - Interactive Presentations","solutionId":"wa104379261","iconUrl":"https://store-images.s-microsoft.com/image/apps.51223.47e20eb4-286a-415c-a7c6-a30d8aaf5dd8.bb9bb1df-e506-4b71-82d1-44c6d0de3876.92bae303-c177-4756-a889-8da8fce426e2.png","addinInfo":{"priority":1,"AUP":747}},{"displayName":"Pexels - Free Stock Photos","solutionId":"wa104379997","iconUrl":"https://store-images.s-microsoft.com/image/apps.42183.883a975e-b768-42b6-804b-7440e32d8a14.594bab1e-71b2-4309-b08a-27d3d8832a91.9373d154-174d-40db-873f-11b8a2e636a4.png","addinInfo":{"priority":1,"AUP":437}},{"displayName":"officeatwork | Template Chooser for Office - M365","solutionId":"wa104380050","iconUrl":"https://store-images.s-microsoft.com/image/apps.21517.40f3490e-24f2-4502-9a44-28e543d36a75.cc0236b1-594c-49ad-9462-3f787be3cd4f.f383d0e6-2de8-4367-9108-e62781456dad","addinInfo":{"priority":1,"AUP":785}},{"displayName":"PP Timer","solutionId":"wa104380667","iconUrl":"https://store-images.s-microsoft.com/image/apps.34537.0bb60981-b391-4645-8398-65b19c9df09a.571de747-edd5-4568-9dd0-072bcf87df09.69ce727f-55eb-405a-9470-668ccee0d6fc.png","addinInfo":{"priority":1,"AUP":7}},{"displayName":"Pixton Comic Characters","solutionId":"wa104380907","iconUrl":"https://store-images.s-microsoft.com/image/apps.29860.e57c0b3f-b9bb-4ebd-b4e4-8b64b797db43.8ed21d66-e83f-4ec7-98e4-f637d866c239.755b4296-081d-4793-8eb5-ed82118043d8.png","addinInfo":{"priority":1,"AUP":1759}},{"displayName":"Icons by Noun Project","solutionId":"wa104381063","iconUrl":"https://store-images.s-microsoft.com/image/apps.43800.2d301a6f-7f58-486a-aa28-60900de38763.afe578dd-fbdd-497d-b1e4-66a6217bfb17.c7c39ea5-5370-437d-8e9d-f9fe1fa77b09.png","addinInfo":{"priority":1,"AUP":287}},{"displayName":"Adobe Acrobat Sign for Microsoft Word and PowerPoint","solutionId":"wa104381155","iconUrl":"https://store-images.s-microsoft.com/image/apps.31139.c4694bde-161e-42b4-8b8f-87f0c1b5010e.4a78185a-5a69-438c-99c2-80f85f7092a3.39897ffc-7ed4-4e29-bd29-b748bc14ae57.png","addinInfo":{"priority":1,"AUP":4672}},{"displayName":"IconScout - Icons, Illustrations & 3D Assets","solutionId":"wa104381411","iconUrl":"https://store-images.s-microsoft.com/image/apps.36684.41fa480b-3128-4253-a7ae-3e7c1406bfb6.07fc268d-eaaa-4f81-b6b3-911c8b2d104d.5b4a7a13-0f35-4b05-a07e-7b5c347ad154.png","addinInfo":{"priority":1,"AUP":382}},{"displayName":"Forms","solutionId":"wa104381526","iconUrl":"https://store-images.s-microsoft.com/image/apps.3597.3f744035-7cc5-4b23-9aea-1e7380b37172.42f8397f-a77f-48a3-a506-4032a34b3bf7.14bf7247-1539-4086-9824-7fe176221f3d.png","addinInfo":{"priority":1,"AUP":6443}},{"displayName":"Wooclap","solutionId":"wa104381682","iconUrl":"https://store-images.s-microsoft.com/image/apps.13441.9fb6980a-f99b-4bf1-9d44-82fefa4843e1.4d33dfef-862e-473d-bfb1-2bdabc490da8.e1403f2d-3a83-46a6-8215-0a1020f33bbc.png","addinInfo":{"priority":1,"AUP":781}},{"displayName":"MathType","solutionId":"wa104381909","iconUrl":"https://store-images.s-microsoft.com/image/apps.44741.813eee75-3ca3-4574-8852-d4a1ee5fd6fb.a6600903-ad52-41cc-a277-a99d413f741b.18009730-067c-46f9-a8f7-539cd53cbd6b.png","addinInfo":{"priority":1,"AUP":1659}},{"displayName":"EasyTimer","solutionId":"wa104382064","iconUrl":"https://store-images.s-microsoft.com/image/apps.17586.18a4e21f-e685-4cd1-910e-2b2e032b01ff.5f21673c-f2a3-4710-8cdc-532e6d7a4f45.baa310be-ee05-44be-8e2b-1373024798f8.png","addinInfo":{"priority":1,"AUP":1294}},{"displayName":"Pear Deck Add-in","solutionId":"wa200000094","iconUrl":"https://store-images.s-microsoft.com/image/apps.59452.62af3df0-63ba-40f1-83d3-a0bc16189b66.26661aad-7dc8-4f47-a9d9-3aa9c939d106.e9f66df9-6115-41f5-8721-fab23ac9b3a8.png","addinInfo":{"priority":1,"AUP":8399}},{"displayName":"draw.io Diagrams","solutionId":"wa200000113","iconUrl":"https://store-images.s-microsoft.com/image/apps.14142.2ec57164-ba5b-42ee-8253-ade72ca74c8d.e8efbcc8-e27f-4682-9321-eb111eb3bc68.950e1c22-0dd9-4079-807b-145ecdb6df9c.png","addinInfo":{"priority":1,"AUP":711}},{"displayName":"Adobe Creative Cloud for Word and PowerPoint","solutionId":"wa200000729","iconUrl":"https://store-images.s-microsoft.com/image/apps.18500.2f664073-3b83-4944-804c-69c30f0e9064.600364c5-532a-4bb4-8ea4-627757d016c6.9c5597d2-2156-401e-8697-18cb65b7c13c.png","addinInfo":{"priority":1,"AUP":676}},{"displayName":"Premast Plus","solutionId":"wa200001396","iconUrl":"https://store-images.s-microsoft.com/image/apps.62947.925c188e-dab2-4231-acfb-60d131eb7da4.132d74f0-1c13-48eb-b8f5-fcec0b139825.1b91bd7f-2be5-430e-a33c-2016eb52f79a.png","addinInfo":{"priority":1,"AUP":211}},{"displayName":"Slides365 - Build Professional Presentations Yourself","solutionId":"wa200001409","iconUrl":"https://store-images.s-microsoft.com/image/apps.10382.5c0bebe6-0d6f-40c0-88ff-4bcc1c0a3acb.9a0fd746-d03b-42f5-8b9f-1eced5547c82.1b9b795d-9337-411d-be6b-fd064ef3dec8.png","addinInfo":{"priority":1,"AUP":114}},{"displayName":"SlideHub","solutionId":"wa200001625","iconUrl":"https://store-images.s-microsoft.com/image/apps.28341.df79b07c-0691-4db6-9851-8b81eaa9f482.805bbb88-2bbf-4a63-9d09-d9c6ebedfc46.339597b4-5e8a-4295-8925-ed11ad30fbc1.png","addinInfo":{"priority":1,"AUP":515}},{"displayName":"Breaktime","solutionId":"wa200001661","iconUrl":"https://store-images.s-microsoft.com/image/apps.53429.790a3023-92b3-4c27-bd32-62a1ac84d552.c35b1205-7b21-4321-84c7-9708e97de568.4d0318b8-f51d-4eef-ae55-3c20fb66521e.png","addinInfo":{"priority":1,"AUP":3243}},{"displayName":"Jasperactive for Office","solutionId":"wa200002334","iconUrl":"https://store-images.s-microsoft.com/image/apps.24398.0a1bdc08-ac9f-4231-8e69-4eb02a692937.a4408ec1-bba8-4f97-961d-09257a62e38a.0013100a-0ba3-4b30-b729-14bf64da59dc.png","addinInfo":{"priority":1,"AUP":1439}},{"displayName":"RRSlide Library","solutionId":"wa200003157","iconUrl":"https://store-images.s-microsoft.com/image/apps.27146.0ffbcab3-3f86-4d90-847e-e9e416c2f04d.1ada7438-24b1-4363-861f-4f3235e1fe56.1c5b196a-7fe5-49ea-ad4c-a502150e70e9.png","addinInfo":{"priority":1,"AUP":130}},{"displayName":"Microsoft Power BI","solutionId":"wa200003233","iconUrl":"https://store-images.s-microsoft.com/image/apps.44848.68115a5f-13b5-4260-9fe9-b6c37e561377.e47b03c9-a5b9-4b5b-97be-affb2ee9bff5.82fc138b-c424-4039-b098-8fdbd0d76965.png","addinInfo":{"priority":1,"AUP":32046}},{"displayName":"Read on reMarkable","solutionId":"wa200003915","iconUrl":"https://store-images.s-microsoft.com/image/apps.7364.f24d322e-3985-4b36-9f2b-d1a92a90534c.43df7b3a-e5a9-4d72-ad4c-53ba599d45c7.1c530b09-8be4-40d7-878f-1bacd2fd0bce.png","addinInfo":{"priority":1,"AUP":135}},{"displayName":"Adobe Acrobat Sign for Microsoft Word and PowerPoint - Government","solutionId":"wa200003944","iconUrl":"https://store-images.s-microsoft.com/image/apps.36564.aa7b92f6-ad15-4d7f-9951-1891d6c9b744.bab76294-ed68-4ac6-b148-791343322826.105c41f6-ff06-4b30-8a37-a9168d40cfee.png","addinInfo":{"priority":1,"AUP":4629}}]'}$5k(L,
ca=null){if(this.vl.getOsfControl(L)&&ca){if(ca.TE){const X=Object(ha.a)(1048,this.dPc(L));X&&(X.Xba=ca.TE)}this.u2e(L)}}}Gg.L5=null;Gg.Iua=null;Object(k.a)(Gg,"AppForOfficeManager",null,[1049,106,795]);class zj{constructor(L,ca,X){this.QQ=L;this.lxg=ca;this.Pb=X}register(){this.lxg.ik(Object(u.a)(this,this.quf,"appSettingChangedEventHandler"))}dispose(){this.lxg.Cm(Object(u.a)(this,this.quf,"appSettingChangedEventHandler"))}quf(L,ca){L=ca.node;ca=ca.property;try{if(1074135139===L.Se&&ca===oe.a.BGc){ca=
null;var X=this.Pb.Nc(L);X.rc(47)||X.rc(10);X.zc();this.zhe(X.currentNode)&&(ca=new hg.a(X.currentNode));var qb=ca.settings;ig.a("RefreshAppSettingsValue")&&(this.QQ.Dvb(ca.id).settings=qb);this.QQ.DZa(OSF.DDA.EventDispId.dispidSettingsChangedEvent.toString(),ca.id,qb)}}catch(Rb){n.ULS.sendTraceTag(18442307,802,10,"Failed to execute AppSettingChangedEventHanlder: {0}.",Rb)}}zhe(L){if(!L)return!1;const ca=Object(ha.a)(4,L);return 1074135137===L.Se||!!ca&&ca.Cq}}Object(k.a)(zj,"AppForOfficeSettingChangedEventListener",
null,[1046,106]);class Mf{constructor(L,ca,X){this.QQ=L;this.fqg=ca;this.Pb=X}register(){for(const L of this.fqg)L.FG(Object(u.a)(this,this.ruf,"appSettingCreatedEventHandler"))}dispose(){for(const L of this.fqg)L.ZO(Object(u.a)(this,this.ruf,"appSettingCreatedEventHandler"))}ruf(L,ca){L=ca.node;try{if(this.zhe(L)&&21===ca.RZ){this.Pb.Nc(L).n6b()||n.ULS.sendTraceTag(20821900,802,15,"Got OnChildTopologyChanged event but no child found.");const X=new hg.a(L),qb=X.settings;this.QQ.DZa(OSF.DDA.EventDispId.dispidSettingsChangedEvent.toString(),
X.id,qb)}}catch(X){n.ULS.sendTraceTag(20821901,802,10,"Failed to execute AppSettingCreatedEventHandler: {0}.",X)}}zhe(L){if(!L)return!1;const ca=Object(ha.a)(4,L);return 1074135137===L.Se||!!ca&&ca.Cq}}Object(k.a)(Mf,"AppForOfficeSettingCreatedEventListener",null,[1046,106]);class Ll{constructor(L,ca){this.ia=L;this.Xt=ca}register(){this.Xt.ik(Object(u.a)(this,this.nAh,"taskpaneAppCreatedEventHandler"))}dispose(){this.Xt.Cm(Object(u.a)(this,this.nAh,"taskpaneAppCreatedEventHandler"))}nAh(L,ca){if(L=
ca.node)L=new hg.a(L),ca.property.id===xb.a.IZ.id&&1===L.Tw&&(ca=ca.node.sa(xb.a.IZ,null))&&this.ia.La(Ii.a.kib,2,ca)}}Object(k.a)(Ll,"AppForOfficeTaskpaneAppCreatedEventListener",null,[1046,106]);var nc=d(642),Tm=d(525),Nc=d(888);class qf{constructor(L,ca,X,qb,Rb){this.xCb=!!C.AFrameworkApplication.Aa&&!!C.AFrameworkApplication.Aa.hb&&C.AFrameworkApplication.Aa.hb.bX;this.QQ=L;this.Mo=ca;this.Qb=X;this.UF=qb;this.Uz=Rb}register(L){L.controlStatusChanged=Object(u.a)(this,this.c2g,"onControlStatusChanged");
L.notifyHost=Object(u.a)(this,this.n4g,"onOsfNotifyHost")}c2g(L){let ca=this.UF.yTf(L.getSolutionId());const X=this.UF.FW(L.getID());X&&X.ap&&L.isFirstParty()&&(ca=this.UF.yTf(X.ap.id));if(ca&&X&&ca.previousSibling){var qb=L.getSolutionId(),Rb=L.getVersion(),Qc=null,jd=null;jd=L.isFirstParty()?OSF.OsfManifestManager.getCachedManifest(qb,""):OSF.OsfManifestManager.getCachedManifest(qb,Rb);L.isFirstParty()&&X.Xba?Qc=X.Xba:jd&&(Qc=jd.getDefaultDisplayName(),X.Xba=Qc);if(!(0===X.Tw||ig.a("EnableSDXDialog2")&&
-1===X.Tw)){if(ig.a("TaskpaneIconUrlPassing")&&this.xCb){Rb=null;jd&&(Rb=jd.getDefaultIconUrl());jd=null;ig.a("UpdateTaskpaneWithInstanceId")&&(jd=Object.assign(new Nc.a,{getContent:()=>ca,type:"LegacyTaskPaneProps"}));const vd=Object.assign(new nc.a,{title:Qc,hideHeader:ig.a("UpdateTaskpaneWithInstanceId"),iconUrl:Rb,width:320,location:2,contentProps:jd,onOpen:()=>{},onClose:()=>{},isModernPane:!0});Fb.UISurfaces.xr().then(Xd=>{if(ig.a("UpdateTaskpaneWithInstanceId")){const Ke=L.getID();Xd.updateTaskPane(Ke,
vd)}else Xd.updateTaskPane(qb,vd);return null}).catch(()=>{ne.a.J(512360770,220,10,"taskPaneAPI.UpdateTaskpane() fails for {0}",qb)})}ca.previousSibling&&(ca.previousSibling.innerText===Qc||!L.isFirstParty()&&""!==ca.previousSibling.innerText)||!Qc||!X.taskpane||X.taskpane.isForUILessAction||(ca.previousSibling.innerText=Qc,this.Qb.eTa())}}}kXj(L,ca,X){this.n4g(L,ca,X)}get hGc(){return this.Mo.od.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)}Fei(L,ca){return oh.a.jp().equals(L.solutionId,
ca.solutionId)&&oh.a.jp().equals(L.storeType,ca.storeType)}n4g(L,ca,X){3===ca?(this.QQ.P$f(),this.Uz.xf(sf.a.UE),X?(this.L6c=X,this.Mo.QG().La(Ii.a.pWc,2,X)):n.ULS.sendTraceTag(512360769,806,10,"InsertAgave: should have valid insert agave parameters")):41===ca?this.hGc&&X&&(this.L6c=X):40===ca?this.hGc&&this.L6c&&X&&this.Fei(this.L6c,X)&&X.storeType&&(n.ULS.sendTraceTag(509669715,220,50,"AgaveHostAction.OsfControlLoad: the loadedAgaveParams' PrivacyCompliantId: {0}",qf.qQ(X)),this.L6c=void 0,this.QQ.Z$(Na(X.storeType))):
36===ca?X?this.Mo.QG().La(Ii.a.pWc,2,X):n.ULS.sendTraceTag(512360768,806,10,"InsertDevManifest: should have valid insert agave parameters"):37===ca?X&&(L=Object(ha.a)(Object,X),L={["ak1"]:this.QQ.vl.getDevManifestInvalidUrlErrorString(L.manifestUrl)},this.Mo.QG().La(od.a.YLb,2,L)):2===ca?this.QQ.P$f():9===ca?this.Mo.od.Qta&&this.Mo.od.Vdg&&this.Mo.QG().La(od.a.YNe,2,X):5===ca||6===ca?(X=this.UF.FW(L))?0===X.Tw?this.Uz.Q0e(ca):this.Uz.RYi(L,ca):n.ULS.sendTraceTag(512360738,806,10,String.format("Failed to find the cached app with instance Id: {0}",
L)):13===ca||14===ca?(X=this.UF.FW(L))?0===X.Tw||X.taskpane&&X.taskpane.isForUILessAction?this.QQ.notifyAgave(L,13===ca?11:12):(He.a.fg&&document.activeElement.blur(),this.xCb&&13===ca?rd.FocusManager.instance().iUe(sf.a.EM):this.Uz.hVf(L)):n.ULS.sendTraceTag(512360737,806,10,String.format("Failed to find the cached app with instance Id: {0}",L)):16===ca?(ca=this.UF.FW(L))?0===ca.Tw&&this.Uz.DRf():n.ULS.sendTraceTag(512360736,806,10,String.format("Failed to find the cached app with instance Id: {0}",
L)):17===ca||18===ca?(ca=this.UF.FW(L))?0===ca.Tw?this.Uz.DRf():(He.a.fg&&document.activeElement.blur(),this.Uz.hVf(L)):n.ULS.sendTraceTag(512360735,806,10,String.format("Failed to find the cached app with instance Id: {0}",L)):1===ca||10===ca?(ca=this.UF.FW(L))?0===ca.Tw&&this.QQ.cAh(L):n.ULS.sendTraceTag(512360734,806,10,String.format("Failed to find the cached app with instance Id: {0}",L)):8===ca?(L={["ak1"]:this.QQ.vl.getManifestInvaildErrorString()},this.Mo.QG().La(od.a.YLb,2,L)):15===ca?(L=
this.Uz.iul(L))&&(ca=this.QQ.Dvb(L))&&ca.taskpane&&!ca.taskpane.isForUILessAction&&this.QQ.notifyAgave(L,11):23===ca?Y.a.sendOtelEvent(Object.assign(new Tm.a,{otelEvent:X})):38===ca?Y.a.sendOtelCustomerContent(Object.assign(new Tm.a,{otelEvent:X})):32===ca?(L=Object(ha.a)(Object,X).solutionId,this.QQ.WDf(L)):34===ca&&(L=Object(ha.a)(Object,X),ca=L.controlId,X=new ab("",L.ownerAddinSolutionId,new If,!0),L.originalControlId=X?X.bKf(ca):ca)}static qQ(L){return Telemetry.PrivacyRules.GetPrivacyCompliantId(L.solutionId,
L.storeType,L.assetId,null,null,L.storeId)}}Object(k.a)(qf,"AppForOfficeAppEventHandler",null,[1074]);var gm=d(249),Rh=d(1204);class Vf{static Y5h(L){var ca=L.getAttribute("style");ca=ca?ca.toString():"";0>ca.indexOf("pointer-events: auto")&&L.className!==Vf.fKb&&(ig.a("Microsoft.Office.SharedOnline.FixBug6808089")?L.style.pointerEvents="auto":L.setAttribute("style",ca+" pointer-events: auto"))}static erf(L){var ca=L.getAttribute("style");ca=ca?ca.toString():"";0>ca.indexOf("pointer-events: none")&&
L.className===Vf.fKb&&(ig.a("Microsoft.Office.SharedOnline.FixBug6808089")?L.style.pointerEvents="none":L.setAttribute("style",ca+" pointer-events: none"))}static wSk(L){var ca=L.getAttribute("style");ca=ca?ca.toString():"";0<=ca.indexOf("pointer-events: none")&&L.className===Vf.fKb&&(ig.a("Microsoft.Office.SharedOnline.FixBug6808089")?L.style.pointerEvents="":(ca=ca.replace("pointer-events: none",""),L.setAttribute("style",ca)))}}Vf.q_k="AppForOfficeContainer EditAppForOfficeContainer";Vf.fKb="AppForOfficeContainer EditAppForOfficeHidden EditAppForOfficeContainer";
Vf.wRe="";Object(k.a)(Vf,"AppForOfficeViewHelper",null,[]);var jn=d(978),kn=d(137);class M{constructor(L,ca,X,qb,Rb){this.Vz=this.Gpg=null;this.CHa=!1;this.$A=ca;this.ai=X;ca&&ca.taskpane&&ca.taskpane.isForUILessAction?(this.Vz=null,this.Gpg=X):(this.Vz=new kn.a,this.Vz.ie.className=Vf.fKb,this.Vz.ie.id="AppForOffice_"+this.$A.instanceId,this.Vz.ie.style.width="100%",this.Vz.ie.style.height="100%",this.Vz.ie.style.position="relative",this.Vz.ie.style.left="0",this.Vz.ie.style.top="0",X.appendChild(this.Vz.ie));
this.Zc=Rb}dispose(){this.qRk();this.$A=null}qRk(){this.Vz&&this.Vz.yq()}aTe(L){L&&this.Vz&&L!==this.ai&&(this.ai=L,L.appendChild(this.Vz.ie),this.CHa&&this.nda())}aCa(L){L&&(L.ie.innerHTML="")}Xel(L,ca,X=null,qb=null,Rb=!1){this.n3h(L,ca,X,qb,Rb)}UEc(L,ca,X){ca=this.Jlc(ca);L.insertBlankControlWithErrorUX(ca,()=>{X()})}n3h(L,ca,X=null,qb=null,Rb=!1){this.CHa=Rb;this.aCa(this.Vz);this.$A&&L&&(this.wKa(ca,null),ca=this.Jlc(this.Vz?this.Vz.ie:this.Gpg,qb,L),ca.virtualOsfControlActivationCallback=X,
L.insertOsfControl(ca),L.setActivationCompletedStatus(this.$A.instanceId,!0),Rb&&this.nda())}nda(){if(this.Vz){var L=this.Vz.xa;if(L){var ca=L.parentNode;ca&&"OsfAddinOverlay"!==ca.className&&(gm.a.instance.pb(wd.a.Qma,ca,Object(u.a)(this,this.ghh,"removePointerEventsStyleHandler")),Rh.a.instance.pb(wd.a.drop,ca,Object(u.a)(this,this.ghh,"removePointerEventsStyleHandler")),gm.a.instance.pb(wd.a.Rma,ca,Object(u.a)(this,this.Z5h,"addPointerEventsStyleHandler")),Vf.erf(L))}}}ghh(L){L=L.pc.target;for(let ca=
0;ca<L.childNodes.length;++ca)Vf.wSk(L.childNodes[ca]);return!0}Z5h(L){L=L.pc.target;for(let ca=0;ca<L.childNodes.length;++ca)Vf.erf(L.childNodes[ca]);return!0}wKa(L,ca){this.Vz&&(L?(null!=ca&&this.aTe(ca),this.Vz.ie.className=""===Vf.wRe?Vf.q_k:Vf.wRe,Vf.Y5h(this.Vz.xa)):(this.Vz.ie.className!==Vf.fKb&&(Vf.wRe=this.Vz.ie.className),this.Vz.ie.className=Vf.fKb))}bTe(L){this.Vz&&(this.Vz.ie.style.zIndex=String(L))}Jlc(L,ca=null,X=null){const qb={};qb.div=L;qb.id=this.$A.instanceId;L=this.$A.ap.id;
const Rb=this.$A.taskpane?this.$A.taskpane.ownerAddinSolutionId:null;if(X&&Rb){const Qc=this.$A.taskpane.isForUILessAction;this.$A.Yv?qb.sharedRuntimeId=this.$A.Yv.Xxa:(X=X.getOsfControl(Rb).getManifest(),qb.sharedRuntimeId=this.Zc.getSharedRuntimeId(X,Qc,L,Rb));qb.initialDisplayMode=Qc?1:2}qb.hostInfoFlags=0;qb.sharedRuntimeId?(qb.hostInfoFlags|=1,qb.solutionId=Rb):ca?(qb.solutionId=ca.assetId,qb.sourceLocationOverrideResourceId=ca.sourceLocationOverrideResourceId,qb.featureGates=C.AFrameworkApplication.fa.L8i(ca.assetId)):
qb.solutionId=L;qb.version=this.$A.ap.version;qb.storeId=this.$A.ap.store;qb.storeType=this.$A.ap.storeType;qb.assetId=null;qb.assetStoreId=null;qb.settings=this.$A.settings;qb.reason=jn.a.contains(this.$A.ap.id,this.$A.Tw,this.$A.ap.store,this.$A.ap.storeType,this.$A.ap.version)?Microsoft.Office.WebExtension.InitializationReason.Inserted:Microsoft.Office.WebExtension.InitializationReason.DocumentOpened;0===this.$A.Tw?qb.osfControlType=0:1===this.$A.Tw&&(qb.osfControlType=1);C.AFrameworkApplication.tia||
OSF.OsfControl.isFirstPartyStoreString(qb.storeType)||(n.ULS.sendTraceTag(512369924,802,50,(0===this.$A.Tw?"Content":"Taskpane")+" web add-in disabled by doc IRM"),qb.hostInfoFlags|=4);this.$A.taskpane?(qb.isForUILessAction=this.$A.taskpane.isForUILessAction,qb.ownerAddinSolutionId=Rb,qb.ownerAddinStoreType=this.$A.taskpane.ownerAddinStoreType):qb.isForUILessAction=!1;return qb}}Object(k.a)(M,"AppForOfficeView",null,[1047]);var Gm=d(276),jl=d(73);class Aj{constructor(L,ca,X,qb,Rb,Qc,jd,vd,Xd,Ke,jf,
wf,eg,Ng,Ug){new Gm.a(0,0,0,0);this.Ibb=this.cO=this.vo=null;this.XAe=ResourceStrings.l_AddinPane;this.hF=!!C.AFrameworkApplication.Aa&&!!C.AFrameworkApplication.Aa.hb&&C.AFrameworkApplication.Aa.hb.bX;this.qb=Yf.a.Fe();this.Qb=Qc;this.Yc=vd;this.Uz=jd;this.je=Xd;this.Zt=L;this.nE=ca;this.Mo=X;this.J3j=qb;this.Db=Rb;this.Jr=Ke;this.Zc=jf;this.Oc=wf;this.mc=eg;this.tH=Ng;this.Zz=Ug;this.initialize()}dispose(){this.Yc&&this.vo&&(this.Yc.yb(wd.a.click,this.vo,Object(u.a)(this,this.gCa,"closePaneButtonClickHandler")),
this.Jr.removeHandler(this.vo,wd.a.Zf,Object(u.a)(this,this.f9f,"handleShortCutsOnCloseButton")),this.vo=null);this.Oc.jib(Object(u.a)(this,this.Aw,"onUnifiedAppStateChanged"));this.Qb.CJb(Object(u.a)(this,this.gY,"onSetOffline"));this.Uz.dhh(this)}initialize(){const L="label_"+this.nE;this.qb.className=this.Zt?"AddinPane AddinPaneRTL":"AddinPane AddinPaneLTR";if(Object(ig.a)("AddClassOnSDXPaneContainer")&&this.Zz){const ca=this.Zz.yol;ca&&(this.qb.className+=" "+ca)}this.qb.style.position="absolute";
this.qb.style.display="none";this.qb.setAttribute(md.a.af,md.a.LBa);this.qb.setAttribute(md.a.D2,L);this.vo=this.tCa("per","ClosePaneGlyph_16x16x32");Sys.UI.DomElement.addCssClass(this.vo,"AddinPaneCloseButton");this.Yc.pb(wd.a.click,this.vo,Object(u.a)(this,this.gCa,"closePaneButtonClickHandler"));this.Jr.addHandler(this.vo,wd.a.Zf,Object(u.a)(this,this.f9f,"handleShortCutsOnCloseButton"));this.qb.appendChild(this.vo);this.Ibb=Yf.a.Fe();this.Ibb.className="PaneLabel";this.Ibb.id=L;this.Ibb.setAttribute(md.a.af,
md.a.bwf);this.Ibb.setAttribute(md.a.CYb,"1");this.qb.appendChild(this.Ibb);this.cO=Yf.a.Fe();this.cO.className="AddinPanePanelResize";this.qb.appendChild(this.cO);this.Oc.z7(Object(u.a)(this,this.Aw,"onUnifiedAppStateChanged"));this.Qb.L5a(Object(u.a)(this,this.gY,"onSetOffline"))}Aw(L,ca){ca.dab&&!this.mc.Fn&&this.isVisible&&this.E$f()}gY(L){L&&this.isVisible&&this.E$f()}E$f(){this.yp(!1);this.Mo.QG().La(Ii.a.mVc,2,this.nE);this.zle()||this.dispose()}layout(L,ca){const X=ca?L.hD(this.width):L.iD(this.width);
this.isVisible&&(ca?X.hD(1):X.iD(1),this.cO.style.height=(L.height-this.vo.clientHeight-this.Ibb.clientHeight).toString()+"px",this.cO.style.width="100%");Yf.a.k1(this.qb,X);return L}m$k(L){this.XAe=L}yp(L){const ca=this.Db!==L;if(this.Db=L)this.qb.style.display="block";const X=this.zle();this.tH.X6k(this.nE,X);if(this.hF){let qb=this.XAe;Object(ig.a)("TaskPaneToolTip")&&this.Mo.od.qT?this.Zz&&this.Zz.lAh?qb=this.Zz.lAh:this.Zz&&(qb=this.Zz.TE):qb=this.Zz?this.Zz.TE:this.XAe;this.tH.yM(this,this.Db,
qb,this.nE)}else this.Qb.eTa();X&&(this.vo.style.visibility=L?"visible":"hidden",ca&&this.Zc.xXi(this.nE,L))}zle(){return this.Zc.aua(this.nE)}gCa(){this.yp(!1);this.Mo.QG().La(Ii.a.mVc,2,this.nE);this.zle()||this.dispose();return!0}sCa(L,ca,X,qb,Rb,Qc){const jd=Yf.a.eC();jd.alt=Rb;jd.className=jl.getImageClassWithCluster(L,qb);jd.src=this.je.pk(L+".png");jd.setAttribute("Unselectable","on");L=Yf.a.Nn();L.className=ca+" cui-img-cont-float";L.appendChild(jd);ca=Yf.a.Nn();ca.className=X;ca.setAttribute("Unselectable",
"on");ca.appendChild(L);X=Yf.a.nca();X.className="CommentPaneNoBorderButton cui-ctl";X.title=Rb;X.setAttribute(md.a.af,md.a.ru);X.tabIndex=0;X.appendChild(ca);Qc&&(Rb=Yf.a.Nn(),Rb.className="cui-ctl-mediumlabel",Rb.setAttribute("Unselectable","on"),Rb.innerText=Qc,X.appendChild(Rb));return X}tCa(L,ca){return this.sCa(L,"cui-img-16by16","cui-ctl-iconContainer",ca,CommonUIStrings.l_DialogClose,null)}f9f(L){L.keyCode===Ud.a.tq||L.keyCode===Ud.a.mP?(this.gCa(null),L.preventDefault(),L.stopPropagation()):
L.keyCode===Ud.a.Pq&&(L.shiftKey?this.Zc.notifyAgave(this.nE,12):this.Zc.notifyAgave(this.nE,11),L.preventDefault(),L.stopPropagation())}get isVisible(){return this.Db}get xa(){return this.qb}get order(){return 6}get width(){return this.isVisible?this.J3j:0}get uGc(){return this.cO}get yti(){return this.vo}get id(){return this.nE}}Object(k.a)(Aj,"AddInPane",null,[1073,461,106]);class Cf{constructor(L,ca,X,qb,Rb,Qc,jd,vd,Xd,Ke){this.Mo=L;this.Qb=ca;this.Uz=X;this.Yc=qb;this.je=Rb;this.h0=Qc;this.Zc=
jd;this.Oc=vd;this.mc=Xd;this.tH=Ke}wKc(L,ca,X,qb,Rb){return new Aj(L,ca,this.Mo,X,qb,this.Qb,this.Uz,this.Yc,this.je,this.h0,this.Zc,this.Oc,this.mc,this.tH,Rb)}R2(L){return new hg.a(L)}OAi(L){return new qf(this.Zc,this.Mo,this.Qb,L,this.Uz)}eWd(L,ca,X,qb,Rb){return new M(L,ca,X,qb,Rb)}}Object(k.a)(Cf,"AppforOfficeClassFactory",null,[1045]);class Rf{constructor(L){this.Fvg=this.ZQ=!1;this.Nm=ik.a.YY();this.$pg=L;zh.uMk(this.$pg)}Mv(){this.Fvg=!0}dispose(){if(this.Fvg&&!this.ZQ){var L=ik.a.YY();zh.tMk(this.$pg,
this.Nm,L);this.ZQ=!0}}}Object(k.a)(Rf,"ApiCallLogger",null,[106]);class jk{get formatting(){return 0}set formatting(L){}get sourceSlideIds(){return null}set sourceSlideIds(L){}get targetSlideId(){return null}set targetSlideId(L){}getTypeName(){return"Microsoft.Office.PowerPoint.InsertSlideOptions"}invokePropertyGet(L){switch(L){case 1:return this.formatting;case 4:return this.sourceSlideIds;case 5:return this.targetSlideId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokePropertyGetAsync(L){L=
this.invokePropertyGet(L);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}invokePropertySet(L,ca){switch(L){case 1:this.formatting=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ca,0,"int");return;case 4:this.sourceSlideIds=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ca,0,"Array<string>");return;case 5:this.targetSlideId=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ca,0,"string");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);
}invokePropertySetAsync(L,ca){this.invokePropertySet(L,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(L){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokeMethodAsync(L,ca){L=this.invokeMethod(L,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}}Object(k.a)(jk,"InsertSlideOptions",null,[]);class ki{constructor(){this.controlId=this.appId=null}}Object(k.a)(ki,"RequestContext",null,[]);class $n{constructor(){this.Imf=
this.qff=null}get layoutId(){return this.qff}set layoutId(L){this.qff=L}get slideMasterId(){return this.Imf}set slideMasterId(L){this.Imf=L}getTypeName(){return"Microsoft.Office.PowerPoint.AddSlideOptions"}invokePropertyGet(L){switch(L){case 1:return this.layoutId;case 2:return this.slideMasterId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokePropertyGetAsync(L){L=this.invokePropertyGet(L);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}invokePropertySet(L,
ca){switch(L){case 1:this.layoutId=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ca,0,"string");return;case 2:this.slideMasterId=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ca,0,"string");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokePropertySetAsync(L,ca){this.invokePropertySet(L,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(L){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);
}invokeMethodAsync(L,ca){L=this.invokeMethod(L,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}}Object(k.a)($n,"AddSlideOptions",null,[]);class yg{constructor(L,ca,X){this.$ac=L;this.o9=ca;this.Zc=X}getAppRuntimeStartState(){if(!this.Zc.aua(this.o9))throw Error.invalidOperation("GetAppRuntimeStartState: Invalid controlId or it is not shared runtime.");return this.Zc.p1i(this.$ac)?1:0}setAppRuntimeStartState(L){if(!this.Zc.aua(this.o9)||0!==L&&1!==L)throw Error.invalidOperation("SetAppRuntimeStartState: Invalid controlId or state, or it is not shared runtime.");
this.Zc.Xul(this.$ac,1===L)}getTypeName(){return"Microsoft.AppRuntime.AppRuntimePersistenceService"}invokePropertyGet(L){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokePropertyGetAsync(L){L=this.invokePropertyGet(L);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}invokePropertySet(L){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokePropertySetAsync(L,ca){this.invokePropertySet(L,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(L,
ca){switch(L){case 2:return this.g2i();case 1:return this.u4k(ca)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokeMethodAsync(L,ca){L=this.invokeMethod(L,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}g2i(){return this.getAppRuntimeStartState()}u4k(L){L=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,0,"int");this.setAppRuntimeStartState(L);return null}}Object(k.a)(yg,"AppRuntimePersistenceService",null,[]);class rm{constructor(L,
ca){this.o9=L;this.Zc=ca}getAppRuntimeState(){if(!this.Zc.aua(this.o9))throw Error.invalidOperation("GetAppRuntimeState: Invalid controlId or it is not shared runtime.");return this.Zc.o1i(this.o9)?2:1}setAppRuntimeState(L){if(!this.Zc.aua(this.o9)||2!==L&&1!==L)throw Error.invalidOperation("GetAppRuntimeState: Invalid controlId or state, or it is not shared runtime.");this.Zc.MKb(this.o9,2===L)}getTypeName(){return"Microsoft.AppRuntime.AppRuntimeService"}invokePropertyGet(L){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);
}invokePropertyGetAsync(L){L=this.invokePropertyGet(L);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}invokePropertySet(L){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokePropertySetAsync(L,ca){this.invokePropertySet(L,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(L,ca){switch(L){case 2:return this.h2i();case 1:return this.v4k(ca)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokeMethodAsync(L,
ca){L=this.invokeMethod(L,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}h2i(){return this.getAppRuntimeState()}v4k(L){L=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,0,"int");this.setAppRuntimeState(L);return null}}Object(k.a)(rm,"AppRuntimeService",null,[]);class dk{insertHyperLink(){}insertSlideFromContent(){return 0}getTypeName(){return"Microsoft.Office.PowerPoint.Application"}invokePropertyGet(L){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);
}invokePropertyGetAsync(L){L=this.invokePropertyGet(L);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}invokePropertySet(L){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokePropertySetAsync(L,ca){this.invokePropertySet(L,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(L,ca){switch(L){case 1001:return this.PEj(ca);case 1002:return this.jFj(ca)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);
}invokeMethodAsync(L,ca){L=this.invokeMethod(L,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}PEj(L){const ca=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,0,"string");L=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,1,"string");this.insertHyperLink(ca,L);return null}jFj(L){L=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,0,"string");return this.insertSlideFromContent(L)}}Object(k.a)(dk,"Application",null,[]);class Jj{constructor(L,
ca){this.tG=!1;this._id=L;this.vGd=ca}get enabled(){return this.tG}set enabled(L){this.tG=L;C.AFrameworkApplication.Ta.La(od.a.V2b,2,{["DynamicAddinCommandsMethodDispatchId"]:1,["SolutionId"]:this.vGd,["SourceControlId"]:this.id,["MethodData"]:this.enabled})}get id(){return this._id}get label(){return null}setEnabled(){}_OnAccess(){}getTypeName(){return"Microsoft.DynamicRibbon.RibbonButton"}invokePropertyGet(L){switch(L){case 3:return this.enabled;case 2:return this.id;case 4:return this.label}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);
}invokePropertyGetAsync(L){L=this.invokePropertyGet(L);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}invokePropertySet(L,ca){switch(L){case 3:this.enabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ca,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokePropertySetAsync(L,ca){this.invokePropertySet(L,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(L,ca){switch(L){case 5:return this.O5k(ca);
case 1:return this.NH()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokeMethodAsync(L,ca){L=this.invokeMethod(L,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}O5k(L){L=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,0,"boolean");this.setEnabled(L);return null}NH(){this._OnAccess();return null}}Object(k.a)(Jj,"RibbonButton",null,[]);class gf{constructor(){}get id(){return null}setVisibility(){}_OnAccess(){}getTypeName(){return"Microsoft.DynamicRibbon.RibbonTab"}invokePropertyGet(L){switch(L){case 2:return this.id}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);
}invokePropertyGetAsync(L){L=this.invokePropertyGet(L);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}invokePropertySet(L){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokePropertySetAsync(L,ca){this.invokePropertySet(L,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(L,ca){switch(L){case 3:return this.N$k(ca);case 1:return this.NH()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokeMethodAsync(L,
ca){L=this.invokeMethod(L,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}N$k(L){L=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,0,"boolean");this.setVisibility(L);return null}NH(){this._OnAccess();return null}}Object(k.a)(gf,"RibbonTab",null,[]);class Ul{constructor(L,ca){this.vMa=this.TM=this.aBc=null;this.fwc=L;this.I1a=ca;ka.a.Wa(this.fwc)||(this.vMa=ca.Dvb(L),this.aBc=(this.TM=this.I1a?this.I1a.vl:null)?this.TM.getOsfControl(this.fwc):null)}get buttons(){return null}executeRequestCreate(){return null}executeRequestUpdate(){return null}getButton(L){let ca=
null;if(!this.Ifg())return this.lHf();if(!ka.a.Wa(L)&&this.vMa&&this.vMa.taskpane){if(!this.yCf(L))return this.yHf(L);ca=new Jj(L,this.vMa.taskpane.ownerAddinSolutionId)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(ca)}getTab(L){let ca=null;if(!this.Ifg())return this.lHf();if(!ka.a.Wa(L)&&this.vMa&&this.vMa.taskpane){if(!this.yCf(L))return this.yHf(L);ca=new gf(L)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(ca)}_OnAccess(){}getTypeName(){return"Microsoft.DynamicRibbon.DynamicRibbon"}invokePropertyGet(L){switch(L){case 4:return this.buttons}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);
}invokePropertyGetAsync(L){L=this.invokePropertyGet(L);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}invokePropertySet(L){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokePropertySetAsync(L,ca){this.invokePropertySet(L,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(L){switch(L){case 1:return this.NH()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokeMethodAsync(L,ca){switch(L){case 7:return this.HSi(ca);
case 6:return this.ISi(ca);case 3:return this.a3i(ca);case 5:return this.Zjj(ca)}L=this.invokeMethod(L,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}HSi(L){L=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,0,"string");return this.executeRequestCreate(L)}ISi(L){L=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,0,"string");return this.executeRequestUpdate(L)}a3i(L){L=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,0,"string");return this.getButton(L)}Zjj(L){L=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,0,"string");return this.getTab(L)}NH(){this._OnAccess();return null}yHf(L){return this.LHf("ControlIdNotFound",ResourceStrings.L_RichApiErrorMessage_ControlIdNotFound+L)}lHf(){return this.LHf("ApiNotAvailable",ResourceStrings.L_RichApiErrorMessage_ApiNotAvailable)}Ifg(){const L=!ka.a.Wa(this.aBc.getSharedRuntimeId());ne.a.J(512497821,802,15,String.format("IsDynamicRibbonApiAvailable check. hasSharedRuntimeId:{0}.",L));return L}yCf(L){if(this.aBc){var ca=
this.aBc.getManifest();if(ca&&(ca=ca.getRibbonExtensionControlMap()))return L in ca||this.Vpi(L)}return!1}Vpi(L){var ca=this.TWi();if(ca){ca=ca.mOf;for(const X of ca.tabs){if(X.id===L)return!0;for(const qb of X.groups)for(const Rb of qb.controls){if(Rb.id===L)return!0;if("Menu"===Rb.type){ca=Rb;for(const Qc of ca.items)if(Qc.id===L)return!0}}}}return!1}TWi(){return R.getInstance().s8a(this.vMa.taskpane.ownerAddinStoreType,this.vMa.taskpane.ownerAddinSolutionId,1)}LHf(L,ca){return OfficeExtension.WacRuntime.Utility.createPromise((X,
qb)=>{qb(OfficeExtension.WacRuntime.Utility.createRichApiException(L,ca))})}}Object(k.a)(Ul,"DynamicRibbon",null,[]);class Vi{constructor(L,ca,X,qb){this.J6e="";this.vxc=0;this.oG=L;this._id=ca;this.yUb=X;this.I1a=qb}get id(){return this._id}_RegisterStateChange(){this.vxc||this.oG.execute(L=>{OfficeExtension.WacRuntime.RichApi.getEventManager().register(this.yUb,this._id,1);this.J6e=L.Vhb(this._id,ca=>{this.I1a.zXi(this.yUb,this._id,JSON.stringify(ca))})});this.vxc++;return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}_UnregisterStateChange(){this.vxc--;
this.vxc||this.oG.execute(L=>{L.rJb(this._id,this.J6e)});return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}getTypeName(){return"Microsoft.Office.Licensing.LicenseFeature"}invokePropertyGet(L){switch(L){case 5:return this.id}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokePropertyGetAsync(L){L=this.invokePropertyGet(L);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}invokePropertySet(L){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);
}invokePropertySetAsync(L,ca){this.invokePropertySet(L,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(L){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokeMethodAsync(L,ca){switch(L){case 6:return this.xLh();case 7:return this.BLh()}L=this.invokeMethod(L,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}xLh(){return this._RegisterStateChange()}BLh(){return this._UnregisterStateChange()}}Object(k.a)(Vi,"LicenseFeature",
null,[]);class Rd{get scopes(){return null}set scopes(L){}getTypeName(){return"Microsoft.Office.Licensing.MsaDeviceTicketOptions"}invokePropertyGet(L){switch(L){case 1:return this.scopes}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokePropertyGetAsync(L){L=this.invokePropertyGet(L);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}invokePropertySet(L,ca){switch(L){case 1:this.scopes=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ca,0,"string");
return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokePropertySetAsync(L,ca){this.invokePropertySet(L,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(L){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokeMethodAsync(L,ca){L=this.invokeMethod(L,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}}Object(k.a)(Rd,"MsaDeviceTicketOptions",null,[]);class kk{constructor(L,ca){this.oG=
Bc.a.instance.Ja("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");this.yUb=L;this.I1a=ca}getFeatureTier(L,ca){return OfficeExtension.WacRuntime.Utility.createPromise(X=>{const qb=1===ca?1:2===ca?2:0;this.oG.execute(Rb=>{Rb.getFeatureTier(L,qb).then(Qc=>{X(this.naj(Qc))},()=>{X(ca)})})})}getLicenseFeature(L){L=new Vi(this.oG,L,this.yUb,this.I1a);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}getMsaDeviceTicket(){return null}isFeatureEnabled(L,ca){return OfficeExtension.WacRuntime.Utility.createPromise(X=>
{this.oG.execute(qb=>{qb.isFeatureEnabled(L,ca).then(Rb=>{X(Rb)},()=>{X(ca)})})})}isFreemiumUpsellEnabled(){return OfficeExtension.WacRuntime.Utility.createPromise(L=>{this.oG.execute(ca=>{ca=ca.isFreemiumUpsellEnabled();L(ca)})})}launchUpsellExperience(L){if(this.I1a.vl.getOsfControl(this.yUb).isFirstParty())return OfficeExtension.WacRuntime.Utility.createPromise(()=>{this.oG.execute(ca=>{ca.launchUpsellExperience(L)})});throw OfficeExtension.WacRuntime.Utility.createRichApiException("AccessDenied",
"");}_TestFireStateChangedEvent(){}getTypeName(){return"Microsoft.Office.Licensing.License"}invokePropertyGet(L){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokePropertyGetAsync(L){L=this.invokePropertyGet(L);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}invokePropertySet(L){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokePropertySetAsync(L,ca){this.invokePropertySet(L,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(L,
ca){switch(L){case 7:return this.bcj(ca);case 6:return this.zLh(ca)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokeMethodAsync(L,ca){switch(L){case 2:return this.l8i(ca);case 5:return this.maj(ca);case 1:return this.jLj(ca);case 3:return this.XLj();case 4:return this.BXj(ca)}L=this.invokeMethod(L,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}l8i(L){const ca=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,0,"string");L=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,
1,"int");return this.getFeatureTier(ca,L)}maj(L){L=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,0,"string");return this.getLicenseFeature(L)}bcj(L){const ca=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,0,"string"),X=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,1,"string");L=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,2,Rd);return this.getMsaDeviceTicket(ca,X,L)}jLj(L){const ca=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,
0,"string");L=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,1,"boolean");return this.isFeatureEnabled(ca,L)}XLj(){return this.isFreemiumUpsellEnabled()}BXj(L){L=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,0,"string");return this.launchUpsellExperience(L)}zLh(L){L=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,0,"string");this._TestFireStateChangedEvent(L);return null}naj(L){switch(L){case 1:return 1;case 2:return 2;default:return 0}}}Object(k.a)(kk,"License",
null,[]);class Fe{get height(){return 0}set height(L){}get left(){return 0}set left(L){}get top(){return 0}set top(L){}get width(){return 0}set width(L){}getTypeName(){return"Microsoft.Office.PowerPoint.ShapeAddOptions"}invokePropertyGet(L){switch(L){case 1:return this.height;case 2:return this.left;case 3:return this.top;case 4:return this.width}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokePropertyGetAsync(L){L=this.invokePropertyGet(L);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}invokePropertySet(L,
ca){switch(L){case 1:this.height=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ca,0,"number");return;case 2:this.left=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ca,0,"number");return;case 3:this.top=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ca,0,"number");return;case 4:this.width=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ca,0,"number");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokePropertySetAsync(L,
ca){this.invokePropertySet(L,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(L){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokeMethodAsync(L,ca){L=this.invokeMethod(L,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}}Object(k.a)(Fe,"ShapeAddOptions",null,[]);class ug{constructor(L,ca,X){this.oKe=!1;this.ivg=!0;this.$ac=L;this.o9=ca;this.Zc=X}hostName(){return"PowerPointOnline"}appId(){return this.$ac}controlId(){return this.o9}createInstance(L){switch(L){case "Microsoft.Office.PowerPoint.AddSlideOptions":return new $n;
case "Microsoft.Office.PowerPoint.Application":return new dk;case "Microsoft.Office.PowerPoint.InsertSlideOptions":return new jk;case "Microsoft.Office.PowerPoint.ShapeAddOptions":return new Fe;case "Microsoft.AppRuntime.AppRuntimeService":return new rm(this.o9,this.Zc);case "Microsoft.AppRuntime.AppRuntimePersistenceService":return new yg(this.$ac,this.o9,this.Zc);case "Microsoft.Office.Licensing.License":return new kk(this.o9,this.Zc);case "Microsoft.DynamicRibbon.DynamicRibbon":return new Ul(this.o9,
this.Zc)}n.ULS.sendTraceTag(588375570,802,10,"Typename: {0} is an invalid parameter. Only instance for Application can be created through this method.",L);return null}static Xq(L){const ca=Bc.a.instance.resolve("PowerPointWebEditor.IAppForOfficeManager").Ipf;L||(ca.ivg=!1);return!ca.oKe}}Object(k.a)(ug,"RichApiHost",null,[1071]);class Kk{constructor(L,ca,X){this.ovd=this.Sh=-1;this.OB=X;0<=L&&(this.Sh+=L,this.ovd=0<ca?L+ca<this.OB.getCount()?L+ca:this.OB.getCount():this.OB.getCount())}get_current(){return-1<
this.Sh&&this.Sh<this.ovd?this.OB.getItemAt(this.Sh):null}moveNext(){const L=this.wul();return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}wul(){return this.Sh+1<this.ovd?(this.Sh++,!0):!1}}Object(k.a)(Kk,"ElementEnumerator",null,[1115]);class zl{constructor(L,ca){this.E4a=L;this.qS=ca}get fill(){ug.Xq(!1);return null}get height(){ug.Xq(!1);return 0}set height(L){ug.Xq(!1)}get id(){const L=new Rf(28);try{ne.a.J(572643292,802,50,"PptApi Call - Shape.GetId");if(!this.E4a)return ne.a.J(577525073,
802,10,"Shape is null."),"";const ca=this.E4a.get_shapeId().toString();L.Mv();return ca}finally{L&&L.dispose()}}get left(){ug.Xq(!1);return 0}set left(L){ug.Xq(!1)}get lineFormat(){ug.Xq(!1);return null}get name(){ug.Xq(!1);return null}set name(L){ug.Xq(!1)}get tags(){ug.Xq(!1);return null}get textFrame(){ug.Xq(!1);return null}get top(){ug.Xq(!1);return 0}set top(L){ug.Xq(!1)}get type(){ug.Xq(!1);return 0}get width(){ug.Xq(!1);return 0}set width(L){ug.Xq(!1)}deleteObject(){if(ug.Xq(!0)){var L=new Rf(45);
try{ne.a.J(572527067,802,50,"PptApi Call - Shape.Delete");const ca=Object(ha.a)(116,this.qS);ca&&(ca.GJi(Object(ha.a)(4,this.E4a)),L.Mv())}finally{L&&L.dispose()}}}getParentSlide(){ug.Xq(!1);return null}getParentSlideLayout(){ug.Xq(!1);return null}getParentSlideLayoutOrNullObject(){ug.Xq(!1);return null}getParentSlideMaster(){ug.Xq(!1);return null}getParentSlideMasterOrNullObject(){ug.Xq(!1);return null}getParentSlideOrNullObject(){ug.Xq(!1);return null}_OnAccess(){}getTypeName(){return"Microsoft.Office.PowerPoint.Shape"}invokePropertyGet(L){switch(L){case 11:return this.fill;
case 5:return this.height;case 1:return this.id;case 6:return this.left;case 12:return this.lineFormat;case 7:return this.name;case 3:return this.tags;case 13:return this.textFrame;case 8:return this.top;case 9:return this.type;case 10:return this.width}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokePropertyGetAsync(L){L=this.invokePropertyGet(L);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}invokePropertySet(L,ca){switch(L){case 5:this.height=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ca,0,"number");return;case 6:this.left=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ca,0,"number");return;case 7:this.name=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ca,0,"string");return;case 8:this.top=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ca,0,"number");return;case 10:this.width=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ca,0,"number");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);
}invokePropertySetAsync(L,ca){this.invokePropertySet(L,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(L){switch(L){case 4:return this.GYd();case 15:return this.Fdj();case 16:return this.Gdj();case 18:return this.Hdj();case 17:return this.Idj();case 19:return this.Jdj();case 20:return this.Kdj();case 2:return this.NH()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokeMethodAsync(L,ca){L=this.invokeMethod(L,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}GYd(){this.deleteObject();
return null}Fdj(){return this.getParentSlide()}Gdj(){return this.getParentSlideLayout()}Hdj(){return this.getParentSlideLayoutOrNullObject()}Idj(){return this.getParentSlideMaster()}Jdj(){return this.getParentSlideMasterOrNullObject()}Kdj(){return this.getParentSlideOrNullObject()}NH(){this._OnAccess();return null}}Object(k.a)(zl,"Shape",null,[]);class Dh{constructor(L){this.sSb=this.vpb=null;this.qS=L;if(L=Object(ha.a)(116,this.qS))this.vpb=L.SSa();this.WAk()}WAk(){this.sSb=new Ea.ScriptSharpLegacyMap;
if(this.vpb)for(const L of this.vpb){const ca=new zl(L,this.qS);this.sSb.add(ca.id,ca)}}addGeometricShape(){ug.Xq(!1);return null}addLine(){ug.Xq(!1);return null}addTextBox(){ug.Xq(!1);return null}getCount(){const L=new Rf(29);try{ne.a.J(572643288,802,50,"PptApi Call - ShapeCollection.GetCount");if(!this.vpb)return ne.a.J(577525071,802,50,"In Shape.GetCount(), _shapes is null"),0;L.Mv();return this.vpb.length}finally{L&&L.dispose()}}getItem(L){const ca=new Rf(31);try{ne.a.J(572643289,802,50,"PptApi Call - ShapeCollection.GetItem");
try{const X=this.sSb.ga(L);ca.Mv();return X}catch(X){throw ne.a.J(577525069,802,15,String.format("In Shape.GetItem(id), Exception: {0} ",X.message)),OfficeExtension.WacRuntime.Utility.createRichApiException(OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam.toString(),"InvalidParam passed to GetItem(id)");}}finally{ca&&ca.dispose()}}getItemAt(L){const ca=new Rf(30);try{ne.a.J(572643290,802,50,"PptApi Call - ShapeCollection.GetItemAt");try{const X=this.vpb[L].get_shapeId().toString(),qb=this.sSb.ga(X);
ca.Mv();return qb}catch(X){throw ne.a.J(577525067,802,15,String.format("In Shape.GetItemAt(index), Exception: {0} ",X.message)),OfficeExtension.WacRuntime.Utility.createRichApiException(OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam.toString(),"InvalidParam passed to GetItemAt(index)");}}finally{ca&&ca.dispose()}}getItemOrNullObject(L){const ca=new Rf(32);try{ne.a.J(572643291,802,50,"PptApi Call - ShapeCollection.GetItemOrNullObject");let X;({value:X}=this.sSb.Uf(L));ca.Mv();return X}finally{ca&&
ca.dispose()}}_OnAccess(){}getAsyncEnumerator(L,ca){return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new Kk(L,ca,this))}getTypeName(){return"Microsoft.Office.PowerPoint.ShapeCollection"}invokePropertyGet(L){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokePropertyGetAsync(L){L=this.invokePropertyGet(L);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}invokePropertySet(L){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);
}invokePropertySetAsync(L,ca){this.invokePropertySet(L,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(L,ca){switch(L){case 6:return this.U4h(ca);case 7:return this.s5h(ca);case 8:return this.a7h(ca);case 1:return this.a9a();case 2:return this.q9a(ca);case 5:return this.p9a(ca);case 3:return this.r9a(ca);case 4:return this.NH()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokeMethodAsync(L,ca){L=this.invokeMethod(L,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}U4h(L){const ca=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,0,"int");L=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,1,Fe);return this.addGeometricShape(ca,L)}s5h(L){const ca=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,0,"int");L=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,1,Fe);return this.addLine(ca,L)}a7h(L){const ca=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,0,"string");L=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,
1,Fe);return this.addTextBox(ca,L)}a9a(){return this.getCount()}q9a(L){L=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,0,"string");return this.getItem(L)}p9a(L){L=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,0,"int");return this.getItemAt(L)}r9a(L){L=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,0,"string");return this.getItemOrNullObject(L)}NH(){this._OnAccess();return null}}Object(k.a)(Dh,"ShapeCollection",null,[1094]);class Sh{constructor(L){this.fDc=
L}get id(){const L=new Rf(15);try{ne.a.J(572643276,802,50,"PptApi Call - SlideLayout.GetId");if(!this.fDc)return ne.a.J(576581654,802,10,"SlideLayout is null."),"";const ca=this.fDc.Id.toString();L.Mv();return ca}finally{L&&L.dispose()}}get name(){const L=new Rf(16);try{ne.a.J(572643277,802,50,"PptApi Call - SlideLayout.GetName");if(!this.fDc)return ne.a.J(576581655,802,10,"SlideLayout is null."),"";const ca=this.fDc.Name;L.Mv();return ca}finally{L&&L.dispose()}}get shapes(){ug.Xq(!1);return null}_OnAccess(){}getTypeName(){return"Microsoft.Office.PowerPoint.SlideLayout"}invokePropertyGet(L){switch(L){case 1:return this.id;
case 3:return this.name;case 4:return this.shapes}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokePropertyGetAsync(L){L=this.invokePropertyGet(L);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}invokePropertySet(L){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokePropertySetAsync(L,ca){this.invokePropertySet(L,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(L){switch(L){case 2:return this.NH()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);
}invokeMethodAsync(L,ca){L=this.invokeMethod(L,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}NH(){this._OnAccess();return null}}Object(k.a)(Sh,"SlideLayout",null,[]);class oj{constructor(L){this.tSb=null;this.fWb=L;this.XAk()}XAk(){this.tSb=new Ea.ScriptSharpLegacyMap;if(this.fWb)for(const L of this.fWb){const ca=new Sh(L);this.tSb.add(ca.id,ca)}}getCount(){const L=new Rf(17);try{ne.a.J(572643272,802,50,"PptApi Call - SlideLayoutCollection.GetCount");if(!this.fWb)return ne.a.J(576581651,
802,50,"In SlideLayouts.GetCount(), _slideLayouts is null"),0;L.Mv();return this.fWb.length}finally{L&&L.dispose()}}getItem(L){const ca=new Rf(19);try{ne.a.J(572643273,802,50,"PptApi Call - SlideLayoutCollection.GetItem");try{const X=this.tSb.ga(L);ca.Mv();return X}catch(X){throw ne.a.J(576581652,802,15,String.format("In SlideLayout.GetItem(id), Exception: {0} ",X.message)),OfficeExtension.WacRuntime.Utility.createRichApiException(OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam.toString(),"InvalidParam passed to GetItem(id)");
}}finally{ca&&ca.dispose()}}getItemAt(L){const ca=new Rf(18);try{ne.a.J(572643274,802,50,"PptApi Call - SlideLayoutCollection.GetItemAt");try{const X=this.tSb.ga(this.fWb[L].Id.toString());ca.Mv();return X}catch(X){throw ne.a.J(576581653,802,15,String.format("In SlideLayouts.GetItemAt(index), Exception: {0} ",X.message)),OfficeExtension.WacRuntime.Utility.createRichApiException(OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam.toString(),"InvalidParam passed to GetItemAt(index)");}}finally{ca&&
ca.dispose()}}getItemOrNullObject(L){const ca=new Rf(20);try{ne.a.J(572643275,802,50,"PptApi Call - SlideLayoutCollection.GetItemOrNullObject");let X;({value:X}=this.tSb.Uf(L));ca.Mv();return X}finally{ca&&ca.dispose()}}_OnAccess(){}getAsyncEnumerator(L,ca){return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new Kk(L,ca,this))}getTypeName(){return"Microsoft.Office.PowerPoint.SlideLayoutCollection"}invokePropertyGet(L){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);
}invokePropertyGetAsync(L){L=this.invokePropertyGet(L);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}invokePropertySet(L){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokePropertySetAsync(L,ca){this.invokePropertySet(L,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(L,ca){switch(L){case 1:return this.a9a();case 2:return this.q9a(ca);case 3:return this.p9a(ca);case 4:return this.r9a(ca);case 5:return this.NH()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);
}invokeMethodAsync(L,ca){L=this.invokeMethod(L,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}a9a(){return this.getCount()}q9a(L){L=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,0,"string");return this.getItem(L)}p9a(L){L=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,0,"int");return this.getItemAt(L)}r9a(L){L=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,0,"string");return this.getItemOrNullObject(L)}NH(){this._OnAccess();return null}}
Object(k.a)(oj,"SlideLayoutCollection",null,[1094]);class ag{constructor(L){this.Fpb=L}get id(){const L=new Rf(21);try{ne.a.J(572643269,802,50,"PptApi Call - SlideMaster.GetId");if(!this.Fpb)return ne.a.J(576581648,802,10,"SlideMaster is null."),"";const ca=this.Fpb.Id.toString();L.Mv();return ca}finally{L&&L.dispose()}}get layouts(){const L=new Rf(23);try{ne.a.J(572643270,802,50,"PptApi Call - SlideMaster.GetLayouts");if(!this.Fpb)return ne.a.J(576581649,802,10,"SlideMaster is null."),null;const ca=
new oj(this.Fpb.ContentMasters);L.Mv();return ca}finally{L&&L.dispose()}}get name(){const L=new Rf(22);try{ne.a.J(572643271,802,50,"PptApi Call - SlideMaster.GetName");if(!this.Fpb)return ne.a.J(576581650,802,10,"SlideMaster is null."),"";const ca=this.Fpb.Name;L.Mv();return ca}finally{L&&L.dispose()}}get shapes(){ug.Xq(!1);return null}_OnAccess(){}getTypeName(){return"Microsoft.Office.PowerPoint.SlideMaster"}invokePropertyGet(L){switch(L){case 1:return this.id;case 3:return this.layouts;case 4:return this.name;
case 5:return this.shapes}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokePropertyGetAsync(L){L=this.invokePropertyGet(L);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}invokePropertySet(L){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokePropertySetAsync(L,ca){this.invokePropertySet(L,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(L){switch(L){case 2:return this.NH()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);
}invokeMethodAsync(L,ca){L=this.invokeMethod(L,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}NH(){this._OnAccess();return null}}Object(k.a)(ag,"SlideMaster",null,[]);class uf{constructor(L,ca){this.qS=L;this.GAa=ca}get id(){const L=new Rf(5);try{ne.a.J(572643283,802,50,"PptApi Call - Slide.GetId");if(!this.qS)return ne.a.J(587747398,802,10,"Slide is null."),"";const ca=this.qS.Cb.toString();L.Mv();return ca}finally{L&&L.dispose()}}get layout(){const L=new Rf(9);try{ne.a.J(572643284,
802,50,"PptApi Call - Slide.GetLayout");const ca=this.GAa.F0;for(let X=0;X<ca.length;X++){const qb=ca[X].ContentMasters;for(let Rb=0;Rb<qb.length;Rb++)if(this.qS.Bn===qb[Rb].Id){const Qc=new Sh(qb[Rb]);L.Mv();return Qc}}throw OfficeExtension.WacRuntime.Utility.createRichApiException(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError.toString(),"Slide does not have a Layout.");}finally{L&&L.dispose()}}get shapes(){const L=new Rf(6);try{ne.a.J(572643285,802,50,"PptApi Call - Slide.GetShapes");const ca=
new Dh(this.qS);L.Mv();return ca}finally{L&&L.dispose()}}get slideMaster(){const L=new Rf(8);try{ne.a.J(572643286,802,50,"PptApi Call - Slide.GetSlideMaster");const ca=this.GAa.F0;for(let X=0;X<ca.length;X++)if(this.qS.hj===ca[X].Id){const qb=new ag(ca[X]);L.Mv();return qb}throw OfficeExtension.WacRuntime.Utility.createRichApiException(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError.toString(),"Slide does not have a SlideMaster.");}finally{L&&L.dispose()}}get tags(){ug.Xq(!1);return null}deleteObject(){if(ug.Xq(!0)){var L=
new Rf(7);try{ne.a.J(572643287,802,50,"PptApi Call - Slide.Delete"),this.GAa.qI(this.qS),L.Mv()}finally{L&&L.dispose()}}}setSelectedShapes(){ug.Xq(!1)}_OnAccess(){}getTypeName(){return"Microsoft.Office.PowerPoint.Slide"}invokePropertyGet(L){switch(L){case 1:return this.id;case 5:return this.layout;case 4:return this.shapes;case 6:return this.slideMaster;case 7:return this.tags}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokePropertyGetAsync(L){L=this.invokePropertyGet(L);
return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}invokePropertySet(L){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokePropertySetAsync(L,ca){this.invokePropertySet(L,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(L,ca){switch(L){case 3:return this.GYd();case 8:return this.b9k(ca);case 2:return this.NH()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokeMethodAsync(L,ca){L=this.invokeMethod(L,
ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}GYd(){this.deleteObject();return null}b9k(L){L=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,0,"Array<string>");this.setSelectedShapes(L);return null}NH(){this._OnAccess();return null}}Object(k.a)(uf,"Slide",null,[]);class hm{constructor(L){this.uSb=null;this.GAa=L;this.Gpb=this.GAa.slides;this.YAk()}YAk(){this.uSb=new Ea.ScriptSharpLegacyMap;if(this.Gpb)for(const L of this.Gpb){const ca=new uf(L,this.GAa);this.uSb.add(ca.id,
ca)}}u6i(){return 0<this.getCount()?this.Gpb[this.getCount()-1]:null}i5d(L){return L?L.hj:this.GAa.F0[0].Id}g5d(L){const ca=this.GAa.F0;for(let X=0;X<ca.length;X++)if(L===ca[X].Id)return ca[X].ContentMasters[0].Id;return 0}add(L){if(ug.Xq(!0)){var ca=new Rf(10);try{ne.a.J(572643278,802,50,"PptApi Call - SlideCollection.Add");const X=this.u6i();let qb=0;qb=L&&L.slideMasterId?parseInt(L.slideMasterId):this.i5d(X);let Rb=0;Rb=L&&L.layoutId?parseInt(L.layoutId):this.g5d(qb);this.GAa.IXb(X,null,qb,Rb);
ca.Mv()}finally{ca&&ca.dispose()}}}getCount(){const L=new Rf(11);try{ne.a.J(572643279,802,50,"PptApi Call - SlideCollection.GetCount");if(!this.Gpb)return ne.a.J(587747396,802,50,"In Slides.GetCount(), _slides is null"),0;L.Mv();return this.Gpb.length}finally{L&&L.dispose()}}getItem(L){const ca=new Rf(13);try{ne.a.J(572643280,802,50,"PptApi Call - SlideCollection.GetItem");try{const X=this.uSb.ga(L);ca.Mv();return X}catch(X){throw ne.a.J(587747394,802,15,String.format("In Slide.GetItem(id), Exception: {0} ",
X.message)),OfficeExtension.WacRuntime.Utility.createRichApiException(OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam.toString(),"InvalidParam passed to GetItem(id)");}}finally{ca&&ca.dispose()}}getItemAt(L){const ca=new Rf(12);try{ne.a.J(572643281,802,50,"PptApi Call - SlideCollection.GetItemAt");try{const X=this.uSb.ga(this.Gpb[L].Cb.toString());ca.Mv();return X}catch(X){throw ne.a.J(587747392,802,15,String.format("In Slide.GetItemAt(index), Exception: {0} ",X.message)),OfficeExtension.WacRuntime.Utility.createRichApiException(OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam.toString(),
"InvalidParam passed to GetItemAt(index)");}}finally{ca&&ca.dispose()}}getItemOrNullObject(L){const ca=new Rf(14);try{ne.a.J(572643282,802,50,"PptApi Call - SlideCollection.GetItemOrNullObject");let X;({value:X}=this.uSb.Uf(L));ca.Mv();return X}finally{ca&&ca.dispose()}}_OnAccess(){}getAsyncEnumerator(L,ca){return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new Kk(L,ca,this))}getTypeName(){return"Microsoft.Office.PowerPoint.SlideCollection"}invokePropertyGet(L){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);
}invokePropertyGetAsync(L){L=this.invokePropertyGet(L);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}invokePropertySet(L){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokePropertySetAsync(L,ca){this.invokePropertySet(L,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(L,ca){switch(L){case 6:return this.q5h(ca);case 1:return this.a9a();case 5:return this.q9a(ca);case 2:return this.p9a(ca);case 3:return this.r9a(ca);
case 4:return this.NH()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokeMethodAsync(L,ca){L=this.invokeMethod(L,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}q5h(L){L=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,0,$n);this.add(L);return null}a9a(){return this.getCount()}q9a(L){L=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,0,"string");return this.getItem(L)}p9a(L){L=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,
0,"int");return this.getItemAt(L)}r9a(L){L=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,0,"string");return this.getItemOrNullObject(L)}NH(){this._OnAccess();return null}}Object(k.a)(hm,"SlideCollection",null,[1094]);class lc{constructor(L){this.vSb=null;this.gWb=L;this.ZAk()}ZAk(){this.vSb=new Ea.ScriptSharpLegacyMap;if(this.gWb)for(const L of this.gWb){const ca=new ag(L);this.vSb.add(ca.id,ca)}}getCount(){const L=new Rf(24);try{ne.a.J(572643265,802,50,"PptApi Call - SlideMasterCollection.GetCount");
if(!this.gWb)return ne.a.J(576581645,802,50,"In SlideMasters.GetCount(), _slideMasters is null"),0;L.Mv();return this.gWb.length}finally{L&&L.dispose()}}getItem(L){const ca=new Rf(26);try{ne.a.J(572643266,802,50,"PptApi Call - SlideMasterCollection.GetItem");try{const X=this.vSb.ga(L);ca.Mv();return X}catch(X){throw ne.a.J(576581646,802,15,String.format("In SlideMaster.GetItem(id), Exception: {0} ",X.message)),OfficeExtension.WacRuntime.Utility.createRichApiException(OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam.toString(),
"InvalidParam passed to GetItem(id)");}}finally{ca&&ca.dispose()}}getItemAt(L){const ca=new Rf(25);try{ne.a.J(572643267,802,50,"PptApi Call - SlideMasterCollection.GetItemAt");try{const X=this.vSb.ga(this.gWb[L].Id.toString());ca.Mv();return X}catch(X){throw ne.a.J(576581647,802,15,String.format("In SlideMasters.GetItemAt(index), Exception: {0} ",X.message)),OfficeExtension.WacRuntime.Utility.createRichApiException(OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam.toString(),"InvalidParam passed to GetItemAt(index)");
}}finally{ca&&ca.dispose()}}getItemOrNullObject(L){const ca=new Rf(27);try{ne.a.J(572643268,802,50,"PptApi Call - SlideMasterCollection.GetItemOrNullObject");let X;({value:X}=this.vSb.Uf(L));ca.Mv();return X}finally{ca&&ca.dispose()}}_OnAccess(){}getAsyncEnumerator(L,ca){return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new Kk(L,ca,this))}getTypeName(){return"Microsoft.Office.PowerPoint.SlideMasterCollection"}invokePropertyGet(L){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);
}invokePropertyGetAsync(L){L=this.invokePropertyGet(L);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}invokePropertySet(L){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokePropertySetAsync(L,ca){this.invokePropertySet(L,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(L,ca){switch(L){case 1:return this.a9a();case 2:return this.q9a(ca);case 3:return this.p9a(ca);case 4:return this.r9a(ca);case 5:return this.NH()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);
}invokeMethodAsync(L,ca){L=this.invokeMethod(L,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}a9a(){return this.getCount()}q9a(L){L=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,0,"string");return this.getItem(L)}p9a(L){L=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,0,"int");return this.getItemAt(L)}r9a(L){L=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,0,"string");return this.getItemOrNullObject(L)}NH(){this._OnAccess();return null}}
Object(k.a)(lc,"SlideMasterCollection",null,[1094]);class Lk{constructor(L){this.iE=new ki;this.H4=L.presentation}get context(){return this.iE}get slideMasters(){const L=new Rf(2);try{ne.a.J(572643293,802,50,"PptApi Call - Presentation.GetSlideMasters");const ca=new lc(this.H4.F0);L.Mv();return ca}finally{L&&L.dispose()}}get slides(){const L=new Rf(3);try{ne.a.J(572643294,802,50,"PptApi Call - Presentation.GetSlides");const ca=new hm(this.H4);L.Mv();return ca}finally{L&&L.dispose()}}get tags(){ug.Xq(!1);
return null}get title(){const L=new Rf(4);try{return ne.a.J(572643295,802,50,"PptApi Call - Presentation.GetTitle"),L.Mv(),"This is the title property"}finally{L&&L.dispose()}}getSelectedShapes(){ug.Xq(!1);return null}getSelectedSlides(){ug.Xq(!1);return null}getSelectedTextRange(){ug.Xq(!1);return null}getSelectedTextRangeOrNullObject(){ug.Xq(!1);return null}insertSlidesFromBase64(){ug.Xq(!1)}setSelectedSlides(){ug.Xq(!1)}_RegisterEvent(L,ca){OfficeExtension.WacRuntime.RichApi.getEventManager().register(this.context.controlId,
L,ca)}_UnregisterEvent(L,ca){OfficeExtension.WacRuntime.RichApi.getEventManager().unregister(this.context.controlId,L,ca)}getTypeName(){return"Microsoft.Office.PowerPoint.Presentation"}invokePropertyGet(L){switch(L){case 3:return this.slideMasters;case 2:return this.slides;case 4:return this.tags;case 1:return this.title}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokePropertyGetAsync(L){L=this.invokePropertyGet(L);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}invokePropertySet(L){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);
}invokePropertySetAsync(L,ca){this.invokePropertySet(L,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(L,ca){switch(L){case 5:return this.Vgj();case 6:return this.Xgj();case 7:return this.bhj();case 9:return this.chj();case 1003:return this.kFj(ca);case 8:return this.c9k(ca);case 1001:return this.wLh(ca);case 1002:return this.ALh(ca)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokeMethodAsync(L,ca){L=this.invokeMethod(L,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}Vgj(){return this.getSelectedShapes()}Xgj(){return this.getSelectedSlides()}bhj(){return this.getSelectedTextRange()}chj(){return this.getSelectedTextRangeOrNullObject()}kFj(L){const ca=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,0,"string");L=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,1,jk);this.insertSlidesFromBase64(ca,L);return null}c9k(L){L=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,0,"Array<string>");this.setSelectedSlides(L);return null}wLh(L){const ca=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,0,"string");L=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,1,"int");this._RegisterEvent(ca,L);return null}ALh(L){const ca=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,0,"string");L=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,1,"int");this._UnregisterEvent(ca,L);return null}}Object(k.a)(Lk,"Presentation",null,[]);class Ye{create(L){return new Lk(L)}}Object(k.a)(Ye,"PresentationFactory",null,[1042]);class im{create(L,ca,X){return new ug(L,ca,X)}}Object(k.a)(im,"RichApiHostFactory",null,[1043]);class ih{constructor(L){this.qb=document.createElement("div");this.qb.className="AddinPaneFrame";
this.Uz=L}dispose(){}layout(L,ca){this.Uz.value.Lrj(L,ca);return L}get isVisible(){return!1}get xa(){return this.qb}get order(){return 13}}Object(k.a)(ih,"AddinPaneFrame",null,[998,461,106]);class Jh{constructor(){this.ncb=this.i3c=this.K=this.Zc=this.aJ=null;this.hF=!!C.AFrameworkApplication.Aa&&!!C.AFrameworkApplication.Aa.hb&&C.AFrameworkApplication.Aa.hb.bX}get name(){return"PowerPointWebEditor.AppForOffice"}$b(L){this.aJ=L.resolve("Common.AFrameworkApplication");this.K=L;this.K.register(Ti,"PowerPointWebEditor.AppForOfficeApi.GetDocumentCopyHelper").as("PowerPointWebEditor.IGetDocumentCopyHelper").oa(()=>
new Ti).ma();this.K.register(tf,"PowerPointWebEditor.AppForOfficeFocusManager").as("PowerPointWebEditor.IAppForOfficeFocusManager").oa(()=>new tf(this.K.resolve("PowerPointWebEditor.IAddinPaneFrame").xa,this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("PowerPointWebEditor.IInputHandlerManager"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.re("PowerPointWebEditor.IAppForOfficeManager"),this.K.resolve("PowerPointWebEditor.View.IViewEventNotifier"))).ma();this.K.register(zc,
"PowerPointWebEditor.AppForOfficeContentAppsContainer").as("PowerPointWebEditor.IAppForOfficeContentAppsContainer").oa(()=>new zc(this.K.resolve("PowerPointWebEditor.IPPTZoomManager"),this.K.resolve("Box4.IPageView").container,this.K.resolve("PowerPointWebEditor.IViewElementHelper"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("PowerPointWebEditor.ViewCore.IViewCoreEventHandlers"))).ma();
this.K.register(Gg,"PowerPointWebEditor.AppForOfficeManager").as("PowerPointWebEditor.IAppForOfficeManager").oa(()=>new Gg(this.K.resolve("PowerPointWebEditor.IApplicationContext"),this.K.resolve("PowerPointWebEditor.IFrameContext"),new kf,this.K.resolve("PowerPointWebEditor.IAppForOfficeContentAppsContainer"),this.K.re("PowerPointWebEditor.IClassFactory"),this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.IAppForOfficeFocusManager"),this.K.resolve("PowerPointWebEditor.IPPTWorkspace"),
this.K.resolve("Box4.IAppFrame"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("Common.IAppSettingsManager"),this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),new I,J.getInstance(),this.K.re("PowerPointWebEditor.IAppforOfficeClassFactory"),
this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IGetDocumentCopyHelper"),this.K.resolve("PowerPointWebEditor.IBusinessBarController"),this.K.resolve("PowerPointWebEditor.AppForOfficeApi.IRichApiHostFactory"),this.K.resolve("PowerPointWebEditor.AppForOfficeApi.IPresentationFactory"),this.K.resolve("Common.App.OAuth.IOAuthManager"))).ma();const ca=new v;this.K.register(kd,"PowerPointWebEditor.AddinCommandsManager").as("PowerPointWebEditor.IAddinCommandsManager").oa(()=>
new kd(this.aJ,this.K.resolve("PowerPointWebEditor.IAppForOfficeManager"),ca,this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("Common.IAppSettingsManager"),new If,this.K.resolve("PowerPointWebEditor.View.IViewEventNotifier"),this.K.resolve("Common.IRibbonExternal"),this.K.resolve("Common.IExternalUICommandDefinitionMapping"),this.K.resolve("PowerPointWebEditor.IBusinessBarController"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"))).ma();this.K.register(og,"PowerPointWebEditor.ContextMenuExtensibilityHandler").as("PowerPointWebEditor.IContextMenuExtensibilityHandler").oa(()=>
new og(ca)).ma();this.K.register(Ed,"PowerPointWebEditor.AppForOfficeListenerManager").as("PowerPointWebEditor.IAppForOfficeListenerManager").oa(()=>new Ed(this.c0i())).ma();this.K.register(Cf,"PowerPointWebEditor.AppforOfficeClassFactory").as("PowerPointWebEditor.IAppforOfficeClassFactory").oa(()=>new Cf(this.K.resolve("PowerPointWebEditor.IApplicationContext"),this.K.resolve("PowerPointWebEditor.AppFrame"),this.K.resolve("PowerPointWebEditor.IAppForOfficeFocusManager"),this.K.resolve("Common.IClickInputManager"),
this.K.resolve("PowerPoint.IPathManager"),this.K.resolve("PowerPointWebEditor.IInputHandlerManager"),this.K.resolve("PowerPointWebEditor.IAppForOfficeManager"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),this.K.resolve("PowerPointWebEditor.ITaskPaneManager"))).ma();this.K.register(im,"PowerPointWebEditor.AppForOfficeApi.RichApiHostFactory").as("PowerPointWebEditor.AppForOfficeApi.IRichApiHostFactory").oa(()=>new im).ma();
this.K.register(Ye,"PowerPointWebEditor.AppForOfficeApi.PresentationFactory").as("PowerPointWebEditor.AppForOfficeApi.IPresentationFactory").oa(()=>new Ye).ma();this.K.register(998,"PowerPointWebEditor.IAddinPaneFrame").ma().oa(()=>new ih(this.K.re("PowerPointWebEditor.IAppForOfficeFocusManager")));this.K.register(999,"PowerPointWebEditor.IAppForOfficeAuthFactory").ma().oa(()=>new Md)}init(){C.AFrameworkApplication.nsa||this.K.resolve("Common.IAppSettingsManager").jf(Object(u.a)(this,this.Om,"onFullAppSettingsReady"))}Om(){this.Zc=
this.K.resolve("PowerPointWebEditor.IAppForOfficeManager");this.Zc.b0b=!0;C.AFrameworkApplication.fa.ka("OcpsIsEnabled")?this.K.Ja("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(L=>{L.isFeatureEnabled(Jh.z$j,!0).then(ca=>{this.Zc.b0b=ca;this.Pxb();return null})}):this.Pxb()}Pxb(){this.K.resolve("PowerPointWebEditor.IAddinCommandsManager");this.K.resolve("PowerPointWebEditor.IAppForOfficeAuthFactory");this.K.resolve("PowerPointWebEditor.IAppForOfficeListenerManager").iOe();
this.K.resolve("PowerPointWebEditor.IAppForOfficeContentAppsContainer").initialize();const L=this.K.resolve("PowerPointWebEditor.IAppForOfficeManagerFactory");L.Ksl();L.Lsl();L.Qpj();this.Mul();this.tCj();this.K.resolve("PowerPointWebEditor.IAppForOfficeManager").initialize()}dispose(){this.K.resolve("PowerPointWebEditor.IAppForOfficeManager").dispose();this.K.resolve("PowerPointWebEditor.IAppForOfficeListenerManager").dispose()}tCj(){const L=this.K.resolve("PowerPointWebEditor.IAddinPaneFrame");
this.hF||this.K.resolve("PowerPointWebEditor.IPaneManager").OP(L);const ca=this.K.resolve("PowerPointWebEditor.IFocusManager"),X=this.K.resolve("PowerPointWebEditor.IAppForOfficeFocusManager");ca.H8(sf.a.ira,sf.a.nj,L,!X.mae());this.aJ.rr.Mq()}c0i(){const L=[];var ca=[];ca.push(this.K.resolve("Box4.Graph.IGraphInstance").Ad(47));ca.push(this.K.resolve("Box4.Graph.IGraphInstance").Ad(10));ca=new Mf(this.K.resolve("PowerPointWebEditor.IAppForOfficeManager"),ca,this.K.resolve("Box4.Graph.IGraphIteratorFactory"));
L.push(ca);ca=new zj(this.K.resolve("PowerPointWebEditor.IAppForOfficeManager"),this.K.resolve("Box4.Graph.IGraphInstance").Ad(49),this.K.resolve("Box4.Graph.IGraphIteratorFactory"));L.push(ca);ca=new Oe(this.K.resolve("PowerPointWebEditor.IAppForOfficeManager"),this.K.resolve("Common.ITaskManager"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"));L.push(ca);ca=new Ll(this.K.resolve("Common.IActionManagerExtended"),
this.K.resolve("Box4.Graph.IGraphInstance").Ad(47));L.push(ca);ca=new Ub(this.K.resolve("Box4.Graph.IGraphInstance").Ad(8),this.K.resolve("PowerPointWebEditor.IAppForOfficeManager"),this.K.resolve("PowerPointWebEditor.IAppforOfficeClassFactory"));L.push(ca);return L}Mul(){this.ncb=C.AFrameworkApplication.fa.Ha("DevAddinManifestFileUrl");this.i3c=C.AFrameworkApplication.fa.Ha("DevAddinManifestGuid");var L=C.AFrameworkApplication.fa.Ha("IsDevAddinTest");if(this.ncb&&this.i3c&&L)if(L="true"===L,w.a.instance.getItem("optedIntoAddinDeveloperMode")||
L&&C.AFrameworkApplication.fa.ka("SuppressDeveloperAddinDialogs"))if(w.a.instance.getItem(this.i3c)||L&&C.AFrameworkApplication.fa.ka("SuppressDeveloperAddinDialogs"))this.Zc.vl.validateAndCacheNewDevAddinManifest(this.ncb);else{L=new z.StandardDialog;L.xd=4;const ca=CommonUIStrings.l_AppsforOfficeL_RegisterDeveloperAddinManifestWarningMessage+String.format(CommonUIStrings.l_AppsForOfficeDeveloperManifestUrl,this.ncb)+CommonUIStrings.l_AppsforOfficeLoadManifestUrl;L.cP(CommonUIStrings.l_AppsforOfficeRegisterDeveloperAddinManifestWarningTitle,
ca,Object(u.a)(this,this.Yfh,"registerDevAddinManifestHandler"))}else L=Object(u.a)(this,this.Yfh,"registerDevAddinManifestHandler"),L=new Tg(this.ncb,L),L.xd=0,L.showDialog(CommonUIStrings.l_AppsforOfficeNotOptedIntoAddinDeveloperModeTitle,CommonUIStrings.l_AppsforOfficeNotOptedIntoAddinDeveloperModeMessage)}Yfh(L){1===L&&this.ncb&&this.UOk()}UOk(){this.Zc&&(this.Zc.vl.validateAndCacheNewDevAddinManifest(this.ncb),w.a.instance.setItem(this.i3c,"true"))}static main(){A.a.instance.Dc(new Jh)}}Jh.z$j=
"mso_officeStore";Object(k.a)(Jh,"AppForOfficePackage",null,[2,3]);Type.registerNamespace("Microsoft.AppRuntime");Type.registerNamespace("OSF");Type.registerNamespace("PowerPointWebEditor");Type.registerNamespace("PowerPointWebEditor.AppForOfficeApi");Type.registerNamespace("CommandUI.AddInCommands");Jh.main()},541:function(K,Z,d){d.r(Z);K=d(0);var k=d(17),e=d(382),n=d(67);class r{constructor(){this.startTime=0;this.callback=null}}Object(K.a)(r,"SSOCallbackInfo",null,[]);class v{constructor(){this.accessToken=
null}}Object(K.a)(v,"AccessTokenInformation",null,[1140]);var C=d(986);class w{constructor(){this.token=null;this.expiresOn=0;this.OBa=this.gW=null}}Object(K.a)(w,"CachedTokenInfo",null,[]);class z{constructor(){this.Bvc=new k.a;this.lra=this.kra=!1;this.ILa=this.gW=null;this.startTime=this.retryCount=0;this.jtf=null}get ySd(){return this.Bvc}}Object(K.a)(z,"SSORequestInfo",null,[]);class A extends z{constructor(){super();this.errorCode=0}}Object(K.a)(A,"SSOFailedRequestInfo",z,[]);var u=d(25);class E{constructor(Y,
S,da,fa){this.k7=new k.a;this.dS=new k.a;this.FMa=null;this.gVb=new k.a;this.fff=Promise.resolve(null);this.zmf=!1;this.UYh=S;this.fwc=Y;this.cnf=da;this.XLh=fa}qdl(Y){if(this.FMa&&this.FMa.gW===Y.gW){if(Date.now()/1E3+E.egk>this.FMa.expiresOn)return this.FMa=null,!1;Y=new C.a;Y.token=this.FMa.token;Y.expiresOn=this.FMa.expiresOn;Y.OBa=this.FMa.OBa;Y.Ykb=!0;Y.b6b=0;this.M6b(Y);return!0}return!1}Obl(Y){for(let S=0;S<this.dS.count;S++)if(this.dS.ga(S).gW===Y.gW&&this.dS.ga(S).ILa===Y.ILa){let da;(da=
this.dS.ga(S)).retryCount=da.retryCount+1;Y.retryCount=this.dS.ga(S).retryCount;if(this.dS.ga(S).retryCount<E.eYa||!this.dS.ga(S).kra&&Y.kra||!this.dS.ga(S).lra&&Y.lra){if(!this.dS.ga(S).kra&&Y.kra||!this.dS.ga(S).lra&&Y.lra)Y.retryCount=0;this.dS.removeAt(S);break}Y=new C.a;Y.errorCode=this.dS.ga(S).errorCode;this.M6b(Y);return!0}return!1}g7h(Y,S){for(let da=0;da<this.dS.count;da++)if(this.dS.ga(da).ILa===Y.ILa&&this.dS.ga(da).gW===Y.gW)return;this.dS.add(Object.assign(new A,{kra:Y.kra,lra:Y.lra,
gW:Y.gW,ILa:Y.ILa,errorCode:S,retryCount:Y.retryCount}))}get resource(){return this.UYh}M3d(Y,S,da,fa,ka,ha){const {AppsForOfficeSingleSignOnManager:F}=d(541);""===da&&(da=null);if(this.zmf)F.Zka(ha,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,null,null);else{var na=null;for(let ba of this.k7)if(ba.kra===Y&&ba.lra===S&&ba.gW===da&&ba.ILa===ka){na=ba;break}na||(na=Object.assign(new z,{kra:Y,lra:S,gW:da,jtf:fa,ILa:ka,retryCount:0,startTime:F.zF()}),this.k7.add(na));na.retryCount=0;na.ySd.add(ha);
this.fff=this.fff.then(()=>{var {AppsForOfficeSingleSignOnManager:ba}=d(541);if(0<this.k7.count){var Ea=this.k7.ga(0);if(this.qdl(Ea)||this.Obl(Ea))return null;for(let ta=0;ta<this.gVb.count;)this.gVb.ga(ta)+E.Ppl<ba.zF()?this.gVb.removeAt(ta):ta++;if(this.gVb.count>=E.tgk||this.k7.count>=E.bgk)return Ea=new C.a,Ea.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOCallThrottled,this.M6b(Ea),null;let La=null;u.AFrameworkApplication.Aa&&(ba=u.AFrameworkApplication.Aa.gV)&&(La=ba.Ci("ComponentAttach",
this.fwc+E.i0h));return Ea.ILa.d3h(this.resource,Ea.kra,Ea.lra,Ea.gW,this.XLh,Ea.jtf).then(ta=>{La&&La.stop();this.M6b(ta)},()=>{La&&La.stop();const ta=new C.a;ta.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;this.M6b(ta)})}return null})}}M6b(Y){const {AppsForOfficeSingleSignOnManager:S}=d(541);try{if(this.k7.count){var da=this.k7.ga(0);this.k7.removeAt(0);var fa=null;Y.errorCode||(fa=new v,fa.accessToken=Y.token);Y.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl&&
Y.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant&&Y.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError&&Y.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOServerError||this.g7h(da,Y.errorCode);var ka={};null!=Y.b6b&&(ka.getTokenSilentTime=Y.b6b.toString());null!=Y.J9d&&(ka.getTokenPopupTime=Y.J9d.toString());null!=Y.h6d&&(ka.getIDTokenTime=Y.h6d.toString());null!=Y.Ykb&&(ka.tokenCached=Y.Ykb.toString());Y.ZZe&&(ka.detailedError=Y.ZZe);Y.OBa&&(ka.authLibrary=
Y.OBa);da.retryCount&&(ka.retryCount=da.retryCount);for(var ha of da.ySd)S.Zka(ha,Y.errorCode,fa,ka);null!=Y.Ykb&&Y.Ykb||this.gVb.add(da.startTime);if(!Y.errorCode)for(null!=Y.expiresOn&&(this.FMa=Object.assign(new w,{token:Y.token,expiresOn:Y.expiresOn,gW:da.gW,OBa:Y.OBa})),this.dS.clear(),ha=0;ha<this.k7.count;)if(this.k7.ga(ha).gW===da.gW){for(let F of this.k7.ga(ha).ySd)S.Zka(F,Y.errorCode,fa,ka);this.k7.removeAt(ha)}else ha++}}catch(F){e.ULS.sendTraceTag(21628945,344,10,"ReceivedAccessTokenHandler: exception message: {0}",
F.message)}}shutdown(){this.zmf=!0;this.k7.clear()}}E.Ppl=6E4;E.tgk=6;E.bgk=6;E.eYa=3;E.egk=300;E.i0h="GetAccessToken";Object(K.a)(E,"SSOCallbackManager",null,[]);var H=d(217),I=d(224),J=d(170),T=d(78),D=d(54),R=d(45),Q=d(141),W=d(192);d.d(Z,"AppsForOfficeSingleSignOnManager",function(){return O});class O{constructor(Y,S,da=null){this.emb=new n.a;const fa=new k.a;S&&fa.add(S.wdk);da&&fa.addRange(da);this.TM=Y;this.q1h=fa}removeCallbackForAddin(Y){this.emb.Hb(Y)&&(this.emb.ga(Y).shutdown(),this.emb.remove(Y))}N3d(Y,
S,da,fa,ka,ha,F,na,ba,Ea){Ea=Object.assign(new r,{startTime:O.zF(),callback:Ea});try{const oa=!!da&&""!==da;var La=Ea.startTime;const wa=this.getOsfControl(Y);let ra=wa.getStoreType()||"",ya=wa.getOwnerAddinStoreType()||"",Da=wa.getSolutionId()||"";const pa=wa.getVersion()||"";ra=ra.toLowerCase();ya=ya.toLowerCase();Da=Da.toLowerCase();var ta=T.a.URc(S)||"";const la=T.a.URc(wa.getIframeUrl())||"",Fa=ta.toLowerCase()===la.toLowerCase();ta=ra;"inmemory"===ra&&(ta=ya);const Qa=Telemetry.PrivacyRules.GetPrivacyCompliantId(Da,
ta,wa.getAssetId(),null,null,wa.getStoreId()),Sa={["callInstanceId"]:La.toString(),["controlSolutionId"]:Qa,["controlVersion"]:pa,["storeType"]:ra,["ownerStoreType"]:ya,["allowConsentPrompt"]:fa.toString(),["forMSGraphAccess"]:ka.toString(),["allowSignInPrompt"]:ha.toString(),["hasAddinAuthChallenge"]:oa.toString(),["securityOriginEqualsSourceLocation"]:Fa.toString(),["singleSignOnEnabled"]:F.toString(),["accountTypeFilter"]:na||""};e.ULS.sendTraceTag(51401115,344,50,"{0}",Sa);Q.a.sendTelemetryEvent(Object.assign(new W.a,
{name:"Office.Online.Extensibility.SSO.GetAccessTokenV2Start",dataFields:J.a.ND(Sa)}));La=!0;const Na=u.AFrameworkApplication.fa.Ha("HostAuthType");switch(na){case "aad":La="aad"===Na;break;case "msa":La="msa"===Na;break;default:La=!na||"noFilter"===na}if(La){na=null;if(F)for(let ua of this.q1h)if(ua.VKj(Da)){na=ua;break}na?this.isSSOAddin(Y)?(F=!0,"omex"===ta&&(F=!1),"spapp"===ta||"spcatalog"===ta?(e.ULS.sendTraceTag(594043737,344,10,"GetAccessToken: SharePoint catalog add-ins not supported."),O.Zka(Ea,
OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null)):ka&&!F?(e.ULS.sendTraceTag(51234570,344,10,"GetAccessToken: Store add-ins do not support tokens for graph access."),O.Zka(Ea,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null)):(ka&&"exchange"===ta&&(fa=!1),this.M3d(Y,S,da,ta,fa,ha,ba,na,Ea))):(e.ULS.sendTraceTag(22402395,344,10,"GetAccessToken: current Addin is not a SSO Addin."),O.Zka(Ea,OSF.DDA.ErrorCodeManager.errorCodes.ooeNotSSOAgave,null,null)):
O.Zka(Ea,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null)}else O.Zka(Ea,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedUserIdentity,null,null)}catch(oa){this.a1c(),e.ULS.sendTraceTag(22402397,344,10,"GetAccessToken: action failed. Exception message: {0}",oa.message),O.Zka(Ea,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,null,null)}}getAccessToken(Y,S,da,fa){this.N3d(Y,da[H.a.BOd]||null,da[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AuthChallenge]||null,
da[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AllowConsentPrompt]||!1,da[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.ForMSGraphAccess]||!1,da[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AllowSignInPrompt]||!1,S,da[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AccountTypeFilter]||null,da[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AddinTrustId]||null,fa)}M3d(Y,S,da,fa,ka,ha,F,na,ba){this.emb.Hb(Y)?fa=this.emb.ga(Y):(fa=new E(Y,this.getWebApplicationResource(Y).split(",")[0],
fa,this.getDefaultDisplayName(Y)),this.emb.add(Y,fa));const Ea=fa.resource;Y=O.Jfj(Ea,this.getWebApplicationId(Y));const La=OfficeExt.WACUtils.getHostSecure(S);Y&&La?Y.toLowerCase()===La.toLowerCase()?fa.M3d(ka,ha,da,F,na,ba):(O.xbb('SSO Resource "'+Ea+'" cannot be used from "'+S+'" origin due to domain mismatch.'),e.ULS.sendTraceTag(22402396,344,10,"GetAccessToken: current Addin's host does not match its Web Application's resource."),O.Zka(ba,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl,
null,null)):(Y||e.ULS.sendTraceTag(594118746,344,10,"Invalid resource URL for SSO."),La||e.ULS.sendTraceTag(594118745,344,10,"Invalid page URL for SSO."),O.Zka(ba,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl,null,null))}a1c(){e.ULS.sendTraceTag(39068820,344,50,"Browser information: {0}",{["UserAgent"]:window.navigator.userAgent})}getOsfControl(Y){return this.TM.getOsfControl(Y)}isSSOAddin(Y){return this.getOsfControl(Y).getManifest().isSSOAddin()}getWebApplicationId(Y){return this.getOsfControl(Y).getManifest().getWebApplicationId()}getWebApplicationResource(Y){return this.getOsfControl(Y).getManifest().getWebApplicationResource()}getDefaultDisplayName(Y){return this.getOsfControl(Y).getManifest().getDefaultDisplayName()}static v4f(){try{const Y=
{};D.a.zFa&&I.OAuthManagerSettings.t$a&&(Y.UiHostSupportsAuthTokenAddinList=O.lPc);Y.UiHostSupportsAuthToken=I.OAuthManagerSettings.t$a;return Y}catch(Y){e.ULS.sendTraceTag(561860814,344,10,"GetSingleSignOnRuntimeSettings: exception message: {0}",Y.message)}return null}static getInstance(Y,S,da=null){O.Ka||(O.Ka=new O(Y,da));return O.Ka}static Jpi(Y){O.Ka&&O.Ka.removeCallbackForAddin(Y)}static xbb(Y){window.console.warn&&window.console.warn(Y)}static Jfj(Y,S){if(!Y)return"";S||(S="");let da=Y.toLowerCase();
var fa=S.toLowerCase();RegExp("^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$").test(fa)||(O.xbb('SSO App Id "'+S+'" is not a valid format. It will be rejected from store submission.'),e.ULS.sendTraceTag(590962907,344,10,"App id does not match a GUID."));da.endsWith(fa)||(O.xbb('SSO Resource "'+Y+'" does not end with App Id "'+S+'". It will be rejected from store submission.'),e.ULS.sendTraceTag(590962908,344,10,"Resource does not end with app id."));if(!da.startsWith("https://")&&
!da.startsWith("api://"))return O.xbb('SSO Resource "'+Y+'" must be https:// or api:// protocol.'),e.ULS.sendTraceTag(590962909,344,10,"Resource not using https or api protocol."),"";for(S=0;S<Y.length;S++){fa=Y.charAt(S);const ka=R.a.charCodeAt(Y,S);if(33>ka||126<ka||"&"===fa||"?"===fa||"#"===fa||"%"===fa||"\\"===fa)return O.xbb('SSO Resource "'+Y+'" contains an invalid character "'+fa+'".'),e.ULS.sendTraceTag(590962910,344,10,"Invalid character '"+fa+"' in resource URI."),""}if(0<=Y.indexOf("::"))return O.xbb('SSO Resource "'+
Y+'" contains an invalid string "::".'),e.ULS.sendTraceTag(590962911,344,10,":: in resource URI."),"";if(120<Y.length)return O.xbb('SSO Resource "'+Y+'" is '+Y.length+" characters and exceeds the max length of 120 characters."),e.ULS.sendTraceTag(590962912,344,10,"Length of resource: "+Y.length+"."),"";da.startsWith("api://")&&(da="https://"+da.substring(6,da.length));return 8===da.length?"":OfficeExt.WACUtils.getHostSecure(da)||""}static Zka(Y,S,da,fa){var ka=Y.startTime;let ha=0;0<ka&&(ha=O.zF()-
ka);ka={["callInstanceId"]:ka.toString(),["callDuration"]:ha.toString(),["errorCode"]:S.toString()};if(fa)for(let F in fa)ka[F]=fa[F];e.ULS.sendTraceTag(51401116,344,50,"{0}",ka);Q.a.sendTelemetryEvent(Object.assign(new W.a,{name:"Office.Online.Extensibility.SSO.GetAccessTokenV2End",dataFields:J.a.ND(ka)}));Y.callback(S,da)}static zF(){try{if(window.performance&&window.performance.now)return window.performance.now()}catch(Y){}return Date.now()}}O.lPc="wa200000047 wa104381973 42de5e8d-cfa0-459d-813d-cf777d47ada0 97d94c7b-54e5-4098-8dbb-b486b6c1f049 wa104381526 d98404ac-f9e2-4292-8cb6-eec349559ae5".split(" ");
O.Ka=null;Object(K.a)(O,"AppsForOfficeSingleSignOnManager",null,[1095])},986:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k{constructor(){this.token=null;this.errorCode=0;this.expiresOn=this.OBa=this.Ykb=this.h6d=this.J9d=this.b6b=this.ZZe=null}}Object(K.a)(k,"AppsForOfficeOauthResult",null,[])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/18430998/wdjs/ppteditDS.appforoffice.js.map