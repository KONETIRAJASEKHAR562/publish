'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[10],{1226:function(K,Z,d){d.r(Z);var k=d(0),e=d(382),n=d(25),r=d(54),v=d(68),C=d(17),w=d(13);class z{constructor(){this.ContextId=this.SessionId=this.AppId=this.Payload=this.Topic=null}}Object(k.a)(z,"AugmentationServiceRequest",null,[]);var A=d(33),u=d(67);class E{constructor(Ca,ob,Hb){this.dqb=this.Qqa=null;this.sMh=Hb;this.$a=ob;this.ei=Ca}initialize(){e.ULS.sendTraceTag(25747911,306,50,"Start initialing augmentation loop ...");
const Ca=this.$a.Ha("AugmentationLoopWebServiceBase"),ob=this.$a.Ha("WebServiceBase");this.Qqa=(void 0===Ca?ob:Ca)+"proofing.ashx?"+n.AFrameworkApplication.jh+"&apitype=AL";this.dqb=new u.a;e.ULS.sendTraceTag(25747912,306,50,"Augmentation Loop initialized")}addEventHandler(Ca,ob){if(Ca&&""!==Ca)if(ob){if(!({value:Hb}=this.dqb.Uf(Ca)).returnValue){var Hb=new C.a;this.dqb.add(Ca,Hb)}Hb.contains(ob)||Hb.add(ob)}else e.ULS.sendTraceTag(25747914,306,15,"eventHandler is null");else e.ULS.sendTraceTag(25747913,
306,15,"topic is empty or null")}removeEventHandler(Ca,ob){Ca&&""!==Ca?ob?this.dqb.Hb(Ca)?({value:Ca}=this.dqb.Uf(Ca),Ca&&Ca.contains(ob)&&Ca.remove(ob)):e.ULS.sendTraceTag(25747917,306,15,"Topic {0} doesn't exist in handler map.",Ca):e.ULS.sendTraceTag(25747916,306,15,"Try to remove null handler"):e.ULS.sendTraceTag(25747915,306,15,"topic is empty or null")}wSe(Ca,ob,Hb){this.Xnc(Ca,ob,Hb,Object(w.a)(this,this.eKa,"requestSucceeded"),Object(w.a)(this,this.cKa,"requestFailed"))}Xnc(Ca,ob,Hb,rc,td,
sc=null){Ca=Object.assign(new z,{Topic:Ca,Payload:ob,AppId:this.sMh,SessionId:this.ei.userSessionId,ContextId:Hb});this.ei.Aj(this.Qqa,2,A.c(Ca),{"Content-Type":"application/json; charset=utf-8"},!1,3,rc,td,sc?sc:Ca,void 0,void 0,void 0,void 0,"18")}eKa(Ca){!n.AFrameworkApplication.Tg&&Ca&&Ca.data&&this.gmk(Ca.data.Zd)}cKa(Ca){!n.AFrameworkApplication.Tg&&Ca&&Ca.data&&e.ULS.sendTraceTag(25747918,306,15,"{0}",Ca.data.Zd)}gmk(Ca){if(Ca){try{var ob=A.a(Ca)}catch(Hb){e.ULS.sendTraceTag(36284437,306,10,
"Try parse aug response failed:{0}",Hb.message);return}if(({value:Ca}=this.dqb.Uf(ob.Topic)).returnValue)for(let Hb of Ca)Hb(ob.ContextId,ob.Payload);else e.ULS.sendTraceTag(25747919,306,50,"Cannot find handlers for Topic:{0};",ob.Topic)}}}Object(k.a)(E,"AugmentationManager",null,[929]);var H=d(1186);class I{}Object(k.a)(I,"HostMetadata",null,[]);class J{}Object(k.a)(J,"Lambda",null,[]);class T extends J{constructor(){super()}}Object(k.a)(T,"WrapperLambda",J,[]);var D=d(394),R=d(141);class Q{constructor(){this.handler=
this.schemaName=null}}Object(k.a)(Q,"AddEventHandlerParameters",null,[]);var W=d(653);class O{constructor(){this.lambda=this.name=null}}Object(k.a)(O,"RegisterSimpleLocalWorkflowParameters",null,[]);class Y{constructor(){this.lambdaAfter=this.lambdaRemote=this.lambdaBefore=this.name=null}}Object(k.a)(Y,"RegisterSimpleRemoteWorkflowParameters",null,[]);var S=d(958);class da{constructor(){this.requestAuthTokenCallback=null}}Object(k.a)(da,"SetRequestAuthTokenCallbackParameters",null,[]);class fa{constructor(){this.sendOTelEvent=
null}}Object(k.a)(fa,"SetSendOTelEventCallbackParameters",null,[]);class ka{constructor(){this.ulsLogger=null}}Object(k.a)(ka,"SetULSLoggerParameters",null,[]);var ha=d(908);class F{constructor(){this.correlationVector=this.input=this.inputSchema=null}}Object(k.a)(F,"SubmitParameters",null,[]);var na=d(525);class ba{constructor(Ca,ob=null){this.fZ=null;new u.a;new I;this.PZh=Ca;this.fOa=ob}initialize(Ca){this.fZ?e.ULS.sendTraceTag(51185349,306,15,"Initialize called multiple times."):(Ca||(Ca=new W.a),
this.fZ=new Promise(ob=>{e.ULS.sendTraceTag(51185350,306,50,"Start download and initialize augloop runtime ...");const Hb=n.AFrameworkApplication.Pj("al",2);this.PZh.pAb(Hb).continueWith(()=>{e.ULS.sendTraceTag(51185351,306,50,"augloop: Successfully loaded script");const rc=augLoop.ALFactoryGlobal.getAugLoopRuntimeManager();rc.setRequestAuthTokenCallback(Object.assign(new da,{requestAuthTokenCallback:Object(w.a)(this,this.dXk,"requestAuthToken")}));rc.setULSLogger(Object.assign(new ka,{ulsLogger:new D.a}));
rc.setSendOTelEventCallback(Object.assign(new fa,{sendOTelEvent:Object(w.a)(this,this.sendOTelEvent,"sendOTelEvent")}));let td=n.AFrameworkApplication.fa.Ha("OfficeApplicationName")||"";td=td.replace("Web","");Ca.appName=Ca.appName||td;Ca.serviceUrl=Ca.serviceUrl||n.AFrameworkApplication.fa.Ha("AugLoopCloudALServiceUrl");Ca.appVersion=Ca.appVersion||n.AFrameworkApplication.fa.Ha("BuildVersion")||"";Ca.releaseAudienceGroup=Ca.releaseAudienceGroup||(n.AFrameworkApplication.gd?Object(H.a)(String,n.AFrameworkApplication.gd.AudienceGroup)||
"":"");Ca.sessionId=Ca.sessionId||n.AFrameworkApplication.fa.Ha("SessionId")||"";Ca.uiLanguage=Ca.uiLanguage||n.AFrameworkApplication.uiCulture;Ca.flights=Ca.flights||this.Y0i();Ca.initSession=Ca.initSession||!0;Ca.downloadBaseUrl=Ca.downloadBaseUrl||n.AFrameworkApplication.fa.Ha("AugLoopDownloadBaseUrl");rc.initialize(Ca);ob({})})}))}registerSchemas(){e.ULS.sendTraceTag(51185352,306,50,"RegisterSchemas is a No-Op");return this.fZ}registerSimpleLocalWorkflow(Ca,ob){return this.fZ.then(()=>{e.ULS.sendTraceTag(51185353,
306,50,"Registering local workflow: {0} to AugLoop.",Ca);return augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().registerSimpleLocalWorkflow(Object.assign(new O,{name:Ca,lambda:this.lsd(ob)}))})}registerSimpleRemoteWorkflow(Ca,ob,Hb,rc){return this.fZ.then(()=>{e.ULS.sendTraceTag(51185354,306,50,"Registering remote workflow: {0} to AugLoop.",Ca);return augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().registerSimpleRemoteWorkflow(Object.assign(new Y,{name:Ca,lambdaBefore:this.lsd(ob),lambdaRemote:this.lsd(Hb),
lambdaAfter:this.lsd(rc)}))})}registerReduceWorkflow(){e.ULS.sendTraceTag(51185355,306,100,"RegisterReduceWorkflow is NYI");return this.fZ}submit(Ca,ob){this.fZ.then(()=>{e.ULS.sendTraceTag(51185356,306,100,"Submitting event: {0} to AugLoop.",Ca);augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().submit(Object.assign(new F,{inputSchema:Ca,input:ob}))})}flushTelemetry(){e.ULS.sendTraceTag(51185357,306,100,"FlushTelemetry is NYI")}submitOperation(Ca){this.fZ.then(()=>{e.ULS.sendTraceTag(51185358,306,
100,"Submitting Operation: {0} to AugLoop.",Ca);augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().submitOperation(Object.assign(new ha.a,{operation:Ca}))})}setSessionDataCallback(Ca){this.fZ.then(()=>{e.ULS.sendTraceTag(592318537,306,100,"Setting SessionData Callback");augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().setSessionDataCallback(Ca)})}setInitSessionCallback(Ca){this.fZ.then(()=>{e.ULS.sendTraceTag(594384065,306,100,"Setting init session override Callback");augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().setInitSessionCallback(Ca)})}setSessionInitOverrideCallback(Ca){this.fZ.then(()=>
{e.ULS.sendTraceTag(594384064,306,100,"Setting session init override Callback");augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().setSessionInitOverrideCallback(Ca)})}setAnnotationResultCallback(Ca){this.fZ.then(()=>{e.ULS.sendTraceTag(51185359,306,100,"Setting Result Callback");augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().setAnnotationResultCallback(Object.assign(new S.a,{handler:Ca}))})}activateAnnotation(Ca){return this.fZ.then(()=>{e.ULS.sendTraceTag(51226247,306,100,"Activating Annotation: {0}",
Ca.annotationType);return augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().activateAnnotation(Ca)})}releaseAnnotation(Ca){return this.fZ.then(()=>{e.ULS.sendTraceTag(51226248,306,100,"Releasing Annotation: {0}",Ca.token);return augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().releaseAnnotation(Ca)})}addEventHandler(Ca,ob){Ca&&""!==Ca?ob?this.fZ.then(()=>{e.ULS.sendTraceTag(51185362,306,100,"Setting Result Callback");augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().addEventHandler(Object.assign(new Q,
{schemaName:Ca,handler:Hb=>{Hb&&ob(Hb.inputSchema,Hb.input,Hb.outputSchema,Hb.output)}}))}):e.ULS.sendTraceTag(51185361,306,15,"eventHandler is null"):e.ULS.sendTraceTag(51185360,306,15,"schemaName is empty or null")}removeEventHandler(){e.ULS.sendTraceTag(51185363,306,100,"RemoveEventHandler is NYI.")}dXk(){const Ca=n.AFrameworkApplication.fa.Ha("AugLoopOAuthResourceUriV2");if(this.fOa)return new Promise(ob=>{this.fOa.execute(Hb=>{Hb.nV("AugLoop",Ca).then(rc=>{rc.IsSuccess?ob(rc.Token):(e.ULS.sendTraceTag(51499467,
306,15,rc.ErrorMessage),ob(n.AFrameworkApplication.fa.Ha("AugloopACLPUserDataSignature")||""));return{}})})});e.ULS.sendTraceTag(51499468,306,50,"Auth requested without a IOAuthManager");return Promise.resolve("")}sendOTelEvent(Ca){R.a.sendOtelEvent(Object.assign(new na.a,{otelEvent:Ca}))}lsd(Ca){if(Ca){let ob=null;Ca.func&&(ob=(Hb,rc,td,sc)=>{Ca.func(Hb,rc,sc)});return Object.assign(new T,{name:Ca.name,inputSchema:Ca.inputSchema,outputSchema:Ca.outputSchema,func:ob})}return null}Y0i(){var Ca=n.AFrameworkApplication.fa.Ha("FlightId");
const ob=n.AFrameworkApplication.fa.RA("AugLoopFlightKeywordList"),Hb=[];if(Ca&&""!==Ca&&ob&&0<ob.length){Ca=Ca.split(";");for(let rc=0;rc<Ca.length;rc++)for(let td=0;td<ob.length;td++)-1<Ca[rc].toLowerCase().indexOf(ob[td].toLowerCase())&&Array.add(Hb,Ca[rc])}return 0<Hb.length?Hb.join(";"):""}}Object(k.a)(ba,"NewAugLoopRuntimeManager",null,[928]);var Ea=d(55),La=d(1217),ta=d(45);class oa{}Object(k.a)(oa,"Lambda",null,[942]);var wa=d(906);class ra{constructor(){this.documentOpenType=this.getItemsEndPoint=
this.downloadUrl=null}}Object(k.a)(ra,"PowerPointParameters",null,[]);class ya{constructor(){this.initSessionCallback=null}}Object(k.a)(ya,"SetInitSessionCallbackParameters",null,[]);class Da{constructor(){this.sessionDataCallback=this.handler=null}}Object(k.a)(Da,"SetSessionDataCallbackParameters",null,[]);class pa{constructor(){this.handler=null}}Object(k.a)(pa,"SetSessionInitOverrideCallbackParameters",null,[]);var la=d(389),Fa=d(514),Qa=d(127);class Sa extends Fa.a{constructor(){super();this.H_=
Object.assign(new Qa.a,{T_:Sa.getTypeName(),B_:Sa.getBaseTypes()})}static getTypeName(){return"AugLoop_Core_DeleteOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}}Object(k.a)(Sa,"DeleteOperation",Fa.a,[]);var Na=d(685),ua=d(256);class za extends ua.a{constructor(){super();this.bridgeId=this.cv=this.messageId=null;this.H_=Object.assign(new Qa.a,{T_:za.getTypeName(),B_:za.getBaseTypes()})}static getTypeName(){return"AugLoop_Session_Protocol_Message"}static getBaseTypes(){return[]}}
Object(k.a)(za,"Message",ua.a,[]);class Wa extends za{constructor(){super();this.protocolVersion=0;this.enableRemoteExecutionNotification=this.enableSessionInspectorLogs=this.returnWorkflowInputTypes=this.extensionConfigs=this.authToken=this.origin=this.sessionKey=this.serviceUrl=this.clientMetadata=null;this.H_=Object.assign(new Qa.a,{T_:Wa.getTypeName(),B_:Wa.getBaseTypes()})}static getTypeName(){return"AugLoop_Session_Protocol_SessionInitMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}}
Object(k.a)(Wa,"SessionInitMessage",za,[]);class yb extends Wa{constructor(){super();this.documentOpenType=this.getItemsEndPoint=this.downloadUrl=null;this.H_=Object.assign(new Qa.a,{T_:yb.getTypeName(),B_:yb.getBaseTypes()})}static getTypeName(){return"AugLoop_Powerpoint_Session_Protocol_PowerPointSessionInitMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_SessionInitMessage","AugLoop_Session_Protocol_Message"]}}Object(k.a)(yb,"PowerPointSessionInitMessage",Wa,[]);var Za=d(34);class ub{constructor(){this.authToken=
this.origin=this.Eoh=null}}Object(k.a)(ub,"SessionData",null,[]);var Ib=d(530);class Ob{constructor(Ca,ob,Hb){this.Yne=new u.a;this.Q1c=new u.a;this.xne=new u.a;this.qEb=this.$9c=this.vBb=this.WQ=null;this.xC=Ca;this.Ga=ob;this.vi=Hb;const rc=new W.a;rc.powerpoint=new ra;if(Za.a("AL.SendSlideTile"))if(Za.a("AL.EnableRehydration"))this.xC.initialize(new W.a),this.xC.setInitSessionCallback(Object.assign(new ya,{initSessionCallback:Object(w.a)(this,this.Jsk,"onSessionInit")})),this.xC.setSessionInitOverrideCallback(Object.assign(new pa,
{handler:Object(w.a)(this,this.Ksk,"onSessionInitOverride")})),this.qEb=this.mWc(),this.xC.setAnnotationResultCallback(Object(w.a)(this,this.onAnnotationResult,"onAnnotationResult")),this.x9=Promise.resolve(null);else{Ca=Ea.a.instance.resolve("PowerPointWebEditor.ISessionInfoOwner").podSessionId;ob=Ea.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").podsWebServiceBase;Ca=String.format("{0}PodHandler.ashx?action=GetSnappedDownloadLink&PodSID={1}",ob,Ca);ob=Ea.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").s9a?
Ea.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").gSc:Ea.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").podsWebServiceBase;var td=String.format("{0}getitems.ashx",ob);ob=new La.a(n.AFrameworkApplication.Je);this.x9=Ib.b(ob.HSe(Ca));this.x9.then(sc=>{try{const Tc=JSON.parse(sc),Dc=Tc.downloadUrl;ta.a.Wa(Dc)?e.ULS.sendTraceTag(51422528,306,15,"PPTAugLoopRuntimeManager: GetSnappedDownloadLink returned a bad response: {0}",Tc):(rc.powerpoint.downloadUrl=Dc,rc.powerpoint.getItemsEndPoint=
td,this.Ga.z2b&&(rc.powerpoint.documentOpenType=this.j2f()))}catch(Tc){e.ULS.sendTraceTag(51422529,306,15,"PPTAugLoopRuntimeManager: Failed to retreive document download URL: {0}",Tc)}this.xC.initialize(rc);this.qEb=this.mWc();this.xC.setAnnotationResultCallback(Object(w.a)(this,this.onAnnotationResult,"onAnnotationResult"));return null}).catch(sc=>{e.ULS.sendTraceTag(51422530,306,15,"PPTAugLoopRuntimeManager: Failed to retreive document download URL: {0}",sc);this.xC.initialize(rc);this.qEb=this.mWc();
this.xC.setAnnotationResultCallback(Object(w.a)(this,this.onAnnotationResult,"onAnnotationResult"))})}else this.x9=new Promise(sc=>{this.xC.initialize(rc);this.qEb=this.mWc();this.xC.setAnnotationResultCallback(Object(w.a)(this,this.onAnnotationResult,"onAnnotationResult"));sc("")})}x5a(Ca){this.x9.then(ob=>{this.xC.activateAnnotation(Object.assign(new wa.a,{annotationType:Ca}));return ob})}knc(Ca,ob){if(Ca)if(ob){if(!({value:Hb}=this.Yne.Uf(Ca)).returnValue){var Hb=new C.a;this.Yne.add(Ca,Hb)}Hb.contains(ob)||
Hb.add(ob)}else e.ULS.sendTraceTag(51388803,306,15,"AnnotationHandler is null");else e.ULS.sendTraceTag(51388802,306,15,"Annotation Type is null or empty")}Ufh(Ca,ob){if(Ca)if(ob){if(!({value:Hb}=this.Q1c.Uf(Ca)).returnValue){var Hb=new C.a;this.Q1c.add(Ca,Hb)}Hb.contains(ob)||Hb.add(ob)}else e.ULS.sendTraceTag(575931363,306,15,"AnnotationHandler is null");else e.ULS.sendTraceTag(575931362,306,15,"Annotation Type is null or empty")}addEventHandler(Ca,ob){this.x9.then(()=>{this.xC.addEventHandler(Ca,
ob);return null})}removeEventHandler(Ca,ob){this.x9.then(()=>{this.xC.removeEventHandler(Ca,ob);return null})}registerSimpleLocalWorkflow(Ca,ob){return this.x9.then(()=>this.xC.registerSimpleLocalWorkflow(Ca,this.msd(ob)))}registerSimpleRemoteWorkflow(Ca,ob,Hb,rc){return this.x9.then(()=>this.xC.registerSimpleRemoteWorkflow(Ca,this.msd(ob),this.msd(Hb),this.msd(rc)))}submit(Ca,ob){this.x9.then(()=>{this.xC.submit(Ca,ob);return null})}submitOperation(Ca){this.x9.then(()=>{this.xC.submitOperation(Ca);
return null})}wBl(Ca,ob,Hb,rc,td){this.qEb&&this.qEb.then(()=>{this.vi.augmentImage(Ca,ob,Hb,!0,this.$9c.Eoh,this.$9c.origin,this.$9c.authToken,rc,td);return null})}Ksk(Ca){e.ULS.sendTraceTag(594609494,306,50,"PPTAugLoopRuntimeManager: OnSessionInitOverride");const ob=Object.assign(new yb,{protocolVersion:Ca.protocolVersion,clientMetadata:Ca.clientMetadata,sessionKey:Ca.sessionKey,origin:Ca.origin,authToken:Ca.authToken,messageId:Ca.messageId,cv:Ca.cv});try{this.Ga.z2b&&(ob.documentOpenType=this.j2f())}catch(Hb){e.ULS.sendTraceTag(578155528,
306,10,"PPTWebEditorAugLoopRunTimeManager::OnSessionInitOverride exception:{0}",Hb)}this.c6k(Ca);if(ta.a.Wa(this.WQ)||ta.a.Wa(this.vBb))return e.ULS.sendTraceTag(594609493,306,15,"PPTAugLoopRuntimeManager: Failed to override sessionInitMessage, null or empty downloadUrl obtained"),Ca;ob.downloadUrl=this.WQ;ob.getItemsEndPoint=this.vBb;this.vBb=this.WQ=null;return ob}Jsk(){e.ULS.sendTraceTag(594609492,306,50,"PPTAugLoopRuntimeManager: OnSessionInit");var Ca=Ea.a.instance.resolve("PowerPointWebEditor.ISessionInfoOwner").podSessionId;
const ob=Ea.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").podsWebServiceBase;var Hb=Ea.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").s9a?Ea.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").gSc:Ea.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").podsWebServiceBase;Ca=String.format("{0}PodHandler.ashx?action=GetSnappedDownloadLink&PodSID={1}",ob,Ca);const rc=String.format("{0}getitems.ashx",Hb);Hb=new La.a(n.AFrameworkApplication.Je);return Ib.b(Hb.HSe(Ca)).then(td=>
{try{const sc=JSON.parse(td),Tc=sc.downloadUrl;ta.a.Wa(Tc)?e.ULS.sendTraceTag(594609491,306,15,"PPTAugLoopRuntimeManager: GetSnappedDownloadLink returned a bad response: {0}",sc):(this.WQ=Tc,this.vBb=rc)}catch(sc){e.ULS.sendTraceTag(594609490,306,15,"PPTAugLoopRuntimeManager: Failed to retreive document download URL: {0}",sc)}return null}).catch(td=>{e.ULS.sendTraceTag(594609489,306,15,"PPTAugLoopRuntimeManager: Failed to retreive document download URL: {0}",td)})}mWc(){return new Promise(Ca=>{this.xC.setSessionDataCallback(Object.assign(new Da,
{sessionDataCallback:(ob,Hb,rc)=>{this.$9c=Object.assign(new ub,{Eoh:ob,origin:Hb,authToken:rc});Ca(null)}}))})}onAnnotationResult(Ca){if(Ca&&Ca.items)if(ua.a.YSa(Ca)!==la.a.getTypeName()&&ua.a.YSa(Ca)!==Na.a.getTypeName())this.Ga.bPf&&ua.a.YSa(Ca)===Sa.getTypeName()&&this.Ank(Ca);else for(const Hb of Ca.items){if(!Hb||!Hb.body)continue;const rc=ua.a.YSa(Hb.body);if(!rc)continue;var ob=Hb.body||{};Ca.parentPath&&(ob.parentPath=Ca.parentPath);let td=null;if(!({value:td}=this.Yne.Uf(rc)).returnValue)e.ULS.sendTraceTag(51388804,
306,50,"Cannot find handlers for annotation:{0};",rc);else if(td)for(let sc of td)sc(ob);if(this.Ga.bPf){ob=null;if(({value:ob}=this.Q1c.Uf(rc)).returnValue)for(let sc of ob)sc(Hb,!1);ta.a.Wa(Hb.id)||this.xne.$(Hb.id,rc)}}}Ank(Ca){for(const ob of Ca.items){if(!ob||!ob.id)continue;if(!({value:Ca}=this.xne.Uf(ob.id)).returnValue)continue;let Hb=null;if(({value:Hb}=this.Q1c.Uf(Ca)).returnValue)for(let rc of Hb)rc(ob,!0);this.xne.remove(ob.id)}}msd(Ca){return Ca?Object.assign(new oa,{name:Ca.name,inputSchema:Ca.inputSchema,
outputSchema:Ca.outputSchema,func:Ca.func}):null}j2f(){try{return this.Ga.tT?0:this.Ga.VUa?2:1}catch(Ca){return e.ULS.sendTraceTag(578697036,306,50,"PPTWebEditorAugLoopRunTimeManager::GetOpenType :{0};",Ca),2}}c6k(Ca){try{ta.a.Wa(Ca.clientMetadata.flights)?Ca.clientMetadata.flights=";":Ca.clientMetadata.flights+=";",this.Ga.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.AugloopAgendaTASClassifierModelIsEnabled",!1)?Ca.clientMetadata.flights+="Microsoft.Office.PowerPointOnline.AugloopAgendaTASClassifierModelIsEnabled-Treatment;":
Ca.clientMetadata.flights+="Microsoft.Office.PowerPointOnline.AugloopAgendaTASClassifierModelIsEnabled-Control;"}catch(ob){e.ULS.sendTraceTag(559445142,306,50,"PPTWebEditorAugLoopRunTimeManager::SetFlights :{0};",ob)}}}Object(k.a)(Ob,"PPTAugLoopRuntimeManager",null,[927]);class Hc{constructor(Ca){this.MT=Ca;this.MT.initialize()}addEventHandler(Ca,ob){this.MT.addEventHandler(Ca,ob)}removeEventHandler(Ca,ob){this.MT.removeEventHandler(Ca,ob)}wSe(Ca,ob,Hb){this.MT.wSe(Ca,ob,Hb)}Xnc(Ca,ob,Hb,rc,td,sc=
null){this.MT.Xnc(Ca,ob,Hb,rc,td,sc)}}Object(k.a)(Hc,"PPTAugmentationManager",null,[926]);var kb=d(347),jb=d(104);class hb{constructor(Ca){hb.assign(hb,this,Ca)}static getTypeName(){return"AugLoop_Core_SchemaObject"}static getBaseTypes(){return[]}static YSa(Ca){return Ca&&Ca.H_?Ca.H_.T_:void 0}static yQc(Ca){return Ca&&Ca.H_&&Ca.H_.B_?Ca.H_.B_:[]}static jXf(Ca){const ob=hb.YSa(Ca);return ob?[ob,...hb.yQc(Ca)]:[]}static pFb(Ca,ob){if(!Array.isArray(ob)||0===ob.length)return!0;const Hb=hb.YSa(Ca);Ca=
hb.yQc(Ca);for(const rc of ob)if(rc===Hb||0<=Ca.indexOf(rc))return!0;return!1}static assign(Ca,ob,Hb){if(Hb)for(const rc of Object.keys(Hb))ob[rc]=Hb[rc];ob.H_=Ca.H_;return ob}}hb.H_={T_:hb.getTypeName(),B_:hb.getBaseTypes()};class uc{constructor(Ca){hb.assign(uc,this,Ca)}static getTypeName(){return"AugLoop_Chat_ChatsHolder"}static getBaseTypes(){return["AugLoop_Core_TileGroup"]}static typeGuard(Ca){return hb.pFb(Ca,[uc.getTypeName()])}}uc.H_={T_:uc.getTypeName(),B_:uc.getBaseTypes()};class mc{constructor(Ca){hb.assign(mc,
this,Ca)}static getTypeName(){return"AugLoop_Chat_Chat"}static getBaseTypes(){return[]}static typeGuard(Ca){return hb.pFb(Ca,[mc.getTypeName()])}}mc.H_={T_:mc.getTypeName(),B_:mc.getBaseTypes()};class Ya{constructor(Ca){hb.assign(Ya,this,Ca)}static getTypeName(){return"AugLoop_Chat_MessagesHolder"}static getBaseTypes(){return["AugLoop_Core_TileGroup"]}static typeGuard(Ca){return hb.pFb(Ca,[Ya.getTypeName()])}}Ya.H_={T_:Ya.getTypeName(),B_:Ya.getBaseTypes()};class Mb{constructor(Ca){hb.assign(Mb,this,
Ca)}static getTypeName(){return"AugLoop_Chat_ChatMessage"}static getBaseTypes(){return[]}static typeGuard(Ca){return hb.pFb(Ca,[Mb.getTypeName()])}}Mb.H_={T_:Mb.getTypeName(),B_:Mb.getBaseTypes()};class Kc{constructor(Ca){hb.assign(Kc,this,Ca)}static getTypeName(){return"AugLoop_Chat_TextChatMessage"}static getBaseTypes(){return["AugLoop_Chat_ChatMessage"]}static typeGuard(Ca){return hb.pFb(Ca,[Kc.getTypeName()])}}Kc.H_={T_:Kc.getTypeName(),B_:Kc.getBaseTypes()};var eb=d(26);class Tb{constructor(Ca){this.qH=
Ca;Ca.body&&(Ca=Ca.body,this.ID=Ca.id,this.Status=Ca.status,this.Text=Ca.text,this.Wud=this.khj())}khj(){return this.qH.parentPath&&0<this.qH.parentPath.length?this.qH.parentPath[this.qH.parentPath.length-1]:""}}Object(k.a)(Tb,"ALChatHelperResponse",null,[936]);class lb{constructor(Ca,ob){this.o$j=0;this.XQg=new Map;this.xC=ob;const Hb=["session","chats"],rc=(new kb.a(jb.a.create(),1)).toString(),td=[...Hb,rc];this.V9j=[...td,"messages"];this.xC.execute(sc=>{sc.submitOperation(lb.eVd(Hb,rc,Ca.chat));
sc.submitOperation(lb.eVd(td,"messages",new Ya));sc.x5a(Ca.responseType);sc.Ufh(Ca.responseType,this.yta.bind(this))})}yta(Ca){Ca=new Tb(Ca);if(Ca.Wud){const ob=this.XQg.get(Ca.Wud);if(ob){ob(Ca);this.XQg.delete(Ca.Wud);return}}this.f5j?this.f5j(Ca):eb.a.J(509366417,822,15,"No handler found")}send(Ca){const ob=`${this.o$j++}`;this.xC.execute(Hb=>{Hb.submitOperation(lb.eVd(this.V9j,ob,Ca))})}static eVd(Ca,ob,Hb){return Object.assign(new la.a,{parentPath:Ca,items:[{id:ob,body:Hb}]})}}Object(k.a)(lb,
"ALChatHelper",null,[932]);class Fb{constructor(Ca){this.V1c=Ca}create(Ca){return new lb(Ca,this.V1c)}}Object(k.a)(Fb,"ALChatHelperFactory",null,[894]);class rb{constructor(){this.K=null}get name(){return"PowerPointWebEditor.AugmentationLoop"}$b(Ca){this.K=Ca;this.K.register(Hc,"PowerPointWebEditor.AugmentationLoop.PPTAugmentationManager").as("PowerPointWebEditor.AugmentationLoop.IPPTAugmentationManager").ma().oa(()=>new Hc(new E(n.AFrameworkApplication.Je,Ca.resolve("Common.IAppSettingsManager"),
"PowerPoint_Online")));this.K.register(Ob,"PowerPointWebEditor.AugmentationLoop.PPTAugLoopRuntimeManager").as("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager").ma().oa(()=>{const ob=r.a.LVj();e.ULS.sendTraceTag(509441561,306,50,"IsWebSocketSupported: {0}",ob);n.AFrameworkApplication.fa.appSettings.AugLoopUseWebSocket=ob.toString();return new Ob(new ba(Ca.resolve("Common.ISharedDependencyLoader"),Ca.Ja("Common.App.OAuth.IOAuthManager")),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),
this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"))});Object(Za.a)("EnableALChatHelper")&&this.K.register(Fb,"PowerPointWebEditor.AugmentationLoop.ALChatHelperFactory").as("PowerPointWebEditor.AugmentationLoop.IALChatHelperFactory").ma().oa(()=>new Fb(this.K.Ja("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager")))}init(){this.K.resolve("PowerPointWebEditor.AugmentationLoop.IPPTAugmentationManager");this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptAugLoopRuntimeIntegrationEnabled&&
(this.K.resolve("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),Object(Za.a)("EnableALChatHelper")&&this.K.resolve("PowerPointWebEditor.AugmentationLoop.IALChatHelperFactory"))}dispose(){}static main(){v.a.instance.Dc(new rb)}}Object(k.a)(rb,"PPTWebEditorAugmentationLoopPackage",null,[2,3]);var Qb=d(1185),Bc=d(907),wb=d(905),Ad=d(542),bc=d(62),Sb=d(31);class Zb{constructor(Ca){if(!Ca)throw Error.argumentNull("Handler for Text Prediction is Null- unable to retrieve initial text prediction signal state");
this.D0=Ca}F6b(Ca){this.D0e(Ca)}D0e(Ca){if(Ca){try{const td=Ca.parentPath;if(!td||4>td.length){eb.a.J(590181647,820,50,"ParentPath is Null or Empty.");return}const sc=td[3];var ob=td[2];if(!sc){eb.a.J(590181645,820,50,"Unable to retreive original paragraph text");return}var Hb=this.D0.p$i(sc);this.D0.$Rk(sc);const Tc=Ca.predictions;if(!Tc||!Tc.length){eb.a.J(590181643,820,50,"Augloop Annotations Null or Empty.");return}const Dc=Tc[0];if(!Dc)return;var rc=Dc.text;if(!rc||!rc.length){eb.a.J(590181641,
820,50,"Text Predictions Null or Empty.");return}}catch(td){eb.a.J(590710030,820,10,"Unable to parse output because of modified output type from Augloop");return}rc&&Zb.lMi(rc,Hb,ob)}else eb.a.J(590181649,820,50,"Annotations returned from service is null.")}static lMi(Ca,ob,Hb){Ca&&Ca.length&&(ob=Zb.rej(Ca,ob),-1!==ob&&(ob=Ca.substring(ob,Ca.length),Hb=Object.assign(new wb.a,{text:Ca,B8:ob,Cx:Hb}),Ad.a.KD.z5=Hb,Ad.a.EPd(Ca,ob)))}static rej(Ca,ob){var Hb=bc.a.instance.Pa.mb.Ye.node;if(!Hb||!ob)return-1;
Hb=Sb.ParagraphReader.text(Hb);if(!Hb)return-1;if(Hb!==ob)if(Hb.length>ob.length&&Hb.substring(0,ob.length)===ob){if(!Ca.startsWith(Hb.substring(ob.length,Hb.length-ob.length)))return-1;eb.a.J(590181638,820,50,"Ghost Text matches part of the Prediction Text.")}else return-1;return" "===Hb.substring(Hb.length-1,1)?0:Zb.W0f(Hb)}static W0f(Ca){return Ca?Ca.length-1-Ca.lastIndexOf(" "):-1}}Object(k.a)(Zb,"TextPredictionAugLoopResponseManager",null,[]);var cb=d(434);class Xa extends Fa.a{constructor(){super();
this.H_=Object.assign(new Qa.a,{T_:Xa.getTypeName(),B_:Xa.getBaseTypes()})}static getTypeName(){return"AugLoop_Signals_SignalOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}}Object(k.a)(Xa,"SignalOperation",Fa.a,[]);var Lb=d(1032);class pc{constructor(){this.YJe=!1}}Object(k.a)(pc,"PredictionSettings",null,[]);class fc{constructor(Ca,ob){this.e$c=null;this.$te={};this.xC=Ca;this.Qb=ob;this.Qb.OFc(Object(w.a)(this,this.T8f,"handleResize"))}p$i(Ca){return this.$te[Ca]}T6k(Ca,ob){this.$te[Ca]=
ob}$Rk(Ca){Ca&&delete this.$te[Ca]}get settings(){this.e$c||(this.e$c=Object.assign(new pc,{YJe:!1}));return this.e$c}set settings(Ca){this.e$c=Ca}Ptl(Ca){if(this.settings.YJe&&Ca){var ob=Ca.id.toString(),Hb=Ad.a.KD.z5,rc=bc.a.instance.Pa.mb;if(rc&&1===rc.length&&rc.Ye){rc=rc.Ye;var td=rc.node;if(Sb.ParagraphReader.textLength(td)===rc.Qa){if(Hb&&td&&ob===Hb.Cx&&ob===td.id.toString()&&(rc=this.Z5d(Hb,td))){Hb.B8=rc;Ad.a.EPd(Hb.text,rc);return}Ad.a.KD.z5=null;Hb=jb.a.create().toString();rc=Sb.ParagraphReader.text(Ca);
this.T6k(Hb,rc);Ca=["Signal",Lb.a.getTypeName(),ob,Hb];Hb=fc.mcj(rc);ob=[Object.assign(new cb.a,{id:ob,body:Hb})];var sc=Object.assign(new Xa,{parentPath:Ca,items:ob});this.xC.execute(Tc=>{Tc.submitOperation(sc);eb.a.J(512493778,820,50,"TextPrediction Signal sent to Augloop Service")})}}}}uJb(){Ad.a.KD.z5=null;Ad.a.ETa()}G6b(Ca){!Ca||1<Ca.length?this.uJb():1>Ca.length||((Ca=Ca[0])&&Ca.context?(Ca=Ca.context,Ca.Qa===Ca.Nb&&Sb.ParagraphReader.textLength(Ca.node)===Ca.Qa||this.uJb()):this.uJb())}Z5d(Ca,
ob){var Hb=null;if(Ca&&ob){ob=Sb.ParagraphReader.text(ob);Ca=Ca.text;if(!ob||!Ca)return Hb;ob=ob.replace(RegExp("\\u00a0","g")," ");Ca=Ca.replace(RegExp("\\u00a0","g")," ");if(ob){if(ob.endsWith(Ca))return this.uJb(),Hb;Hb=fc.ldj(ob,Ca);Hb=Ca.substring(Hb,Ca.length)}}return Hb}T8f(){Ad.a.ETa()}dispose(){this.Qb.jkd(Object(w.a)(this,this.T8f,"handleResize"))}static mcj(Ca){return Object.assign(new Lb.a,{languageId:"en-US",startOfSentence:!0,text:Ca})}static ldj(Ca,ob){for(let Hb=ob.length;0<Hb;Hb--){const rc=
ob.substring(0,Hb);if(Ca.endsWith(rc.trimStart()))return rc.length}return 0}}fc.zUa=!1;Object(k.a)(fc,"TextPredictionHandler",null,[855]);var bd=d(50),od=d(28);class ye{constructor(Ca,ob){this.ia=Ca;this.qc=ob}vb(){this.ia.ya(od.a.qDk,bd.a.application,Object(w.a)(this,this.tDk,"predictionHandler"))}tDk(Ca,ob,Hb){return n.AFrameworkApplication.fa.ka("PPTOTextPredictionIsEnabled")?1===Hb?this.qc.Lj()?32:2:8:8}}Object(k.a)(ye,"TextPredictorActor",null,[]);class pd{constructor(){this.PAe=this.K=null}get name(){return"PowerPointWebEditor.TextPrediction"}$b(Ca){this.K=
Ca;Ca.register(ye,"PowerPointWebEditor.TextPrediction.TextPredictorActor").ma().oa(()=>new ye(Ca.resolve("Common.IActionManagerExtended"),Ca.resolve("PowerPointWebEditor.IPresentationReader")));Ca.register(855,"PowerPointWebEditor.TextPrediction.ITextPredictionHandler").ma().oa(()=>new fc(Ca.Ja("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),Ca.resolve("PowerPointWebEditor.Core.IPPTAppFrame")))}init(){this.K.resolve("PowerPointWebEditor.TextPrediction.TextPredictorActor").vb();this.PAe=
new Qb.a(()=>new Zb(this.K.resolve("PowerPointWebEditor.TextPrediction.ITextPredictionHandler")));this.K.Ja("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager").execute(Ca=>{Ca.x5a(Bc.a.getTypeName());Ca.knc(Bc.a.getTypeName(),Object(w.a)(this.PAe.value,this.PAe.value.F6b,"handleResponse"))})}dispose(){}static main(){v.a.instance.Dc(new pd)}}Object(k.a)(pd,"TextPredictionPackage",null,[2,3]);var ab=d(268),Yb=d(27);class Sc{}Object(k.a)(Sc,"AugContextId",null,[]);class Jb{}Object(k.a)(Jb,
"AugParagraph",null,[]);class Oc{}Object(k.a)(Oc,"AugShape",null,[]);class Wb{}Object(k.a)(Wb,"ShapeTextTile",null,[]);class Ab{constructor(Ca,ob,Hb,rc){this.Ea=Hb;this.Hh=rc;this.Pb=Ca;this.Ll=ob}P0b(Ca,ob){return Ca&&Ca.isConnected&&this.Ea.wFa(Ca)?(Ca=Object(H.a)(4,Ca))?Object.assign(new Wb,{Topic:"ShapeText",ContextId:A.c(Ab.Nxi(Ca,ob)),Data:A.c(this.Oxi(Ca))}):null:null}o0b(Ca){return Ca&&Ca.get_shapeId()&&Ca.hasText&&!Ca.$p?Ca.Ahe:!1}Oxi(Ca){const ob=[];Ca=this.Pb.Nc(Ca);for(Ca=this.Ll.S2(Ca,
Ca.currentNode);Ca.moveNext();){var Hb=Ca.currentNode;const rc=Hb;this.Hh.Yd(rc)&&(Hb=Object.assign(new Jb,{t:this.Hh.text(rc),l:this.Hh.Kgb(Hb)}),Array.add(ob,Hb))}return Object.assign(new Oc,{p:ob,c:ab.a.ue(n.AFrameworkApplication.lcid).ovb})}static Nxi(Ca,ob){return Object.assign(new Sc,{gid:Ca.id,sid:Ca.slideSid,cid:Ca.slideCid,shapeId:Ca.get_shapeId(),rid:(Ca.p0c||Ca.DFa||Yb.App.Um).toString(),t:ob,c:(new Date).getTime()})}}Object(k.a)(Ab,"ShapeTextTileManager",null,[840,924]);var Xb=d(103),
vb=d(1207),$c=d(199),fd=d(79),Bd;(function(Ca){Ca[Ca.none=0]="none";Ca[Ca.onParagraphPropertyChanged=1]="onParagraphPropertyChanged";Ca[Ca.onSelectionFinished=2]="onSelectionFinished";Ca[Ca.onActiveSlideDomReady=4]="onActiveSlideDomReady";Ca[Ca.onShapeChildTopologyChanged=8]="onShapeChildTopologyChanged";Ca[Ca.onParagraphDisconnect=16]="onParagraphDisconnect";Ca[Ca.onNumberListPropertyChanged=32]="onNumberListPropertyChanged";Ca[Ca.onNumberListDisconnect=64]="onNumberListDisconnect";Ca[Ca.onSlideConnected=
128]="onSlideConnected";Ca[Ca.onSlideDisconnected=256]="onSlideDisconnected"})(Bd||(Bd={}));Object(k.b)("EventNames",Bd);class gd{constructor(){this.N0a=this.graphNode=null;this.YUa=0;this.O_e=null}}Object(k.a)(gd,"TileGraphNode",null,[]);class Pd{constructor(){this.dnh=this.SRe=this.s$d=this.q7f=0}}Object(k.a)(Pd,"TileTelemetry",null,[]);var cd;(function(Ca){Ca[Ca.unknown=0]="unknown";Ca[Ca.activeSlideChanged=1]="activeSlideChanged";Ca[Ca.shapeSelected=2]="shapeSelected";Ca[Ca.listLevelChanged=3]=
"listLevelChanged";Ca[Ca.richEditTextUnicodeChanged=4]="richEditTextUnicodeChanged";Ca[Ca.shapeChildTopologyChanged=5]="shapeChildTopologyChanged";Ca[Ca.paragraphDeleted=6]="paragraphDeleted";Ca[Ca.numberListDeleted=7]="numberListDeleted";Ca[Ca.numberListPropertyChanged=8]="numberListPropertyChanged";Ca[Ca.slideAdded=9]="slideAdded";Ca[Ca.slideDeleted=10]="slideDeleted"})(cd||(cd={}));Object(k.b)("TriggerName",cd);var lf=d(428);class Jd{constructor(Ca,ob,Hb,rc){this.zb=ob;this.p6j=Hb;this.pdk=Ca;
this.RAe={};this.$bc={};this.Qb=rc}initialize(){this.Pu()}dispose(){this.Voa()}onParagraphPropertyChanged(Ca,ob){this.Osa(ob,1)}BGb(Ca,ob){this.Osa(ob,2)}onActiveSlideDomReady(Ca,ob){this.Osa(ob,4)}onShapeChildTopologyChanged(Ca,ob){this.Osa(ob,8)}PIa(Ca,ob){this.Osa(ob,16)}J6g(Ca,ob){Ca=new lf.a(!1,null,ob.Ba);this.Osa(Ca,4)}get Cy(){return this.pdk}get c_(){return this.RAe}get kja(){return this.$bc}Osa(Ca,ob){try{if(2===this.Qb.mode&&Object(vb.a)(Bd,ob)in this.RAe){var Hb=Date.now();Object(H.a)(931,
this.RAe[Object(vb.a)(Bd,ob)]).r3(Ca,(rc,td)=>{this.Dnk(rc,td,Hb)})}}catch(rc){eb.a.J(36495880,306,10,"Exception thrown at DetectTiles: "+rc)}}Dnk(Ca,ob,Hb){if(!$c.a.Wa(Ca))try{for(const rc of Ca){if(!Xb.a.count(this.$bc)){const Tc=new fd.a(3,1,this.p6j,Object(w.a)(this,this.fireTileEvents,"fireTileEvents"),90,"24");this.zb.Eb(Tc)}let td;if(rc.id.toString()in this.$bc)td=Object(H.a)(gd,this.$bc[rc.id.toString()]),td.YUa=ob;else{const Tc=new Pd;td=Object.assign(new gd,{graphNode:rc,YUa:ob,N0a:{},O_e:Tc});
this.$bc[rc.id.toString()]=td;this.Elk(Tc,Hb)}const sc=cd[ob];td.N0a[sc]=(sc in td.N0a?td.N0a[sc]:0)+1}}catch(rc){eb.a.J(36495882,306,10,"Exception thrown at FireTiles: "+rc)}}Elk(Ca,ob){Ca&&(Ca.q7f=ob,Ca.s$d=Date.now())}a1g(Ca,ob){Ca&&(Ca.SRe=ob,Ca.dnh=Date.now())}KWf(Ca){return Ca?String.format("GraphDetectDuration: {0}, QueueDuration: {1}, ScanGraphSpaceDuration: {2}",Ca.s$d-Ca.q7f,Ca.SRe-Ca.s$d,Ca.dnh-Ca.SRe):""}}Object(k.a)(Jd,"TileTriggerControllerBase",null,[943,106]);class Xf extends Jd{constructor(Ca,
ob,Hb,rc,td,sc,Tc,Dc,xc,pg,Ih,vh,Ti){super(Tc&31,Dc,pg,vh);this.fU=Ca.Ad(12);this.cM=Ca.Ad(10);this.pa=ob;this.qd=Hb;this.MT=rc;this.c$=td;this.nU=sc;this.ua=xc;this.tU=Ih;this.Pdk=Ti}Pu(){1===(this.Cy&1)&&(this.fU.ik(Object(w.a)(this,this.onParagraphPropertyChanged,"onParagraphPropertyChanged")),this.c_[Object(vb.a)(Bd,1)]=this.tU.DFi());2===(this.Cy&2)&&(this.pa.GG(Object(w.a)(this,this.BGb,"onProcessSetSelectionFinished")),this.c_[Object(vb.a)(Bd,2)]=this.tU.EFi());4===(this.Cy&4)&&(this.qd.$V(Object(w.a)(this,
this.onActiveSlideDomReady,"onActiveSlideDomReady")),this.c_[Object(vb.a)(Bd,4)]=this.tU.BFi());8===(this.Cy&8)&&(this.cM.FG(Object(w.a)(this,this.onShapeChildTopologyChanged,"onShapeChildTopologyChanged")),this.c_[Object(vb.a)(Bd,8)]=this.tU.FFi());16===(this.Cy&16)&&(this.fU.CBa(Object(w.a)(this,this.PIa,"onBeforeParagraphDisconnect")),this.c_[Object(vb.a)(Bd,16)]=this.tU.CFi())}Voa(){this.fU.Cm(Object(w.a)(this,this.onParagraphPropertyChanged,"onParagraphPropertyChanged"));this.pa.Nxa(Object(w.a)(this,
this.BGb,"onProcessSetSelectionFinished"));this.qd.Una(Object(w.a)(this,this.onActiveSlideDomReady,"onActiveSlideDomReady"));this.cM.ZO(Object(w.a)(this,this.onShapeChildTopologyChanged,"onShapeChildTopologyChanged"));this.fU.ZJa(Object(w.a)(this,this.PIa,"onBeforeParagraphDisconnect"))}fireTileEvents(){try{if(this.ua&&this.ua.Ba){var Ca=this.ua.Ba.Pk();for(const ob of Ca){const Hb=ob.id.toString();Hb in this.kja&&(this.x3b(Object(H.a)(gd,this.kja[Hb])),delete this.kja[Hb])}Xb.a.forEach(this.kja,
ob=>{delete this.kja[ob]},null)}}catch(ob){eb.a.J(36525510,306,10,"Exception thrown at FireTileEvents: "+ob)}}x3b(Ca){if(Ca){var ob=Date.now(),Hb=this.nU.P0b(Ca.graphNode,cd[Ca.YUa]);if(Hb){this.Pdk?this.c$.execute(td=>{td.submit("ShapeTextTile",Hb)}):this.MT.execute(td=>{td.wSe(Hb.Topic,Hb.Data,Hb.ContextId)});const rc=Ca.O_e;this.a1g(rc,ob);eb.a.J(26007383,306,50,"Fire a tile. LatestTrigger: {0}, TriggerCount: {1}, {2}",cd[Ca.YUa],Ca.N0a,this.KWf(rc))}}}}Object(k.a)(Xf,"ShapeTextTileTriggerController",
Jd,[]);var ee=d(22),Ra=d(75),sb=d(38),ec=d(90),Lc=d(82),nd=d(159),Fd=d(37);class Ja{constructor(){this.lcid=this.end=this.start=0;this.noProof=!1}}Object(k.a)(Ja,"TextSpan",null,[]);class db{}Object(k.a)(db,"AugCharFormat",null,[]);class ic{}Object(k.a)(ic,"AugCharFormatRun",null,[]);class id{}Object(k.a)(id,"AugDrawingElement",null,[]);class qd{}Object(k.a)(qd,"AugDrawingElementMoniker",null,[]);class Fc{}Object(k.a)(Fc,"AugPara",null,[]);class Ze{}Object(k.a)(Ze,"AugParaFormat",null,[]);class df{}
Object(k.a)(df,"AugParaFormatRun",null,[]);class ve{}Object(k.a)(ve,"AugSlide",null,[]);class md{}Object(k.a)(md,"AugSlideMoniker",null,[]);class Kf{}Object(k.a)(Kf,"AugText",null,[]);class oe{}Object(k.a)(oe,"AugTextTile",null,[]);class Hf{constructor(Ca,ob,Hb,rc,td,sc,Tc,Dc,xc,pg,Ih,vh){this.Hh=Ca;this.Xl=ob;this.Dye=Hb;this.Pb=rc;this.XX=td;this.yc=sc;this.Ll=Tc;this.bXa=Ih;this.i7c=Dc;this.Jfc=xc;this.eA=pg;this.A8c=vh}P0b(Ca){if(!Ca||!Ca.isConnected)return null;var ob=Object(H.a)(116,Ca);if(!ob)return null;
let Hb=Ca=0;ob=({Ofd:Ca,zMc:Hb}=this.XFi(ob)).returnValue;if(!ob)return null;ob=Object.assign(new oe,{Id:jb.a.create().toString(),Content:A.c(ob)});eb.a.J(37091038,306,50,"TileId: {0}; ParaCount: {1}; DirtyParaCount: {2};",ob.Id,Ca,Hb);return ob}XFi(Ca){let ob=0,Hb=0;const rc=[];var td=Ca?Ca.Pk():[];for(sc of td)if(!this.Xl.iFa(sc)||this.bXa)if(sc.ud){if(td=this.yc.FN(sc))td=this.Pb.Nc(td),this.XX.EPc(td,Tc=>{(Tc=Object(H.a)(123,Tc.currentNode))&&!Tc.isGhostCell&&({Ofd:ob,zMc:Hb}=this.BWf(Tc,ob,Hb,
rc));return!0})}else({Ofd:ob,zMc:Hb}=this.BWf(sc,ob,Hb,rc));var sc=ob;td=Hb;return{returnValue:Object.assign(new ve,{id:Ca.id.toString(),mk:Object.assign(new md,{sId:Ca.sid,cId:Ca.cid}),drawingElems:rc,isSlideCritiqueReady:Ca.isSlideCritiqueReady}),Ofd:sc,zMc:td}}BWf(Ca,ob,Hb,rc){const td=[];let sc=0;var Tc=this.Pb.Nc(Ca);for(Tc=this.Ll.S2(Tc,Tc.currentNode);Tc.moveNext();){var Dc=Tc.currentNode;Dc&&this.Hh.Yd(Dc)&&Dc.Sa(sb.a.pq)&&(Dc=this.W_i(Dc))&&(Dc.pfRuns&&0<Dc.pfRuns.length&&Dc.pfRuns[0].pf.proofingDirty&&
sc++,Array.add(td,Dc))}0<td.length&&(ob+=td.length,Hb+=sc,Ca=Object.assign(new id,{id:Ca.id.toString(),mk:this.U_i(Ca),text:Object.assign(new Kf,{paragraphs:td})}),Array.add(rc,Ca));return{Ofd:ob,zMc:Hb}}U_i(Ca){if(!Ca)return null;var ob="";let Hb=0,rc=0;if(Object(ee.a)(123,Ca))ob=Object(H.a)(123,Ca),rc=3,ob=ob.cellId.toString();else if(Object(ee.a)(4,Ca))if(Ca=Object(H.a)(4,Ca),ob=Ca.get_shapeId().toString(),Hb=Ca.get_cid(),Ca.V3)rc=1;else if(Ca.Rf)rc=2;else if(Ca.lx||Ca.gl)rc=4;return Object.assign(new qd,
{id:ob,cId:Hb,type:rc})}W_i(Ca){if(!Ca)return null;Ca=Object(H.a)(Ra.AParagraphNode,Ca);if(!Ca)return null;var ob=Ca.sa(Fd.a.xT,!1);ob=Object.assign(new Fc,{id:Ca.id.toString(),chars:ob?"":this.Hh.text(Ca)});const Hb=this.V_i(Ca);Hb&&0<Hb.length&&(ob.pfRuns=Hb);(Ca=this.T_i(Ca))&&0<Ca.length&&(ob.cfRuns=Ca);return ob}V_i(Ca){const ob=[],Hb=Object(H.a)(Lc.a,this.Jfc.nSc(Ca));let rc=16,td="",sc=0,Tc=0;if(Hb&&this.A8c){const Dc=this.eA.u9a(Hb);if(Dc)if(rc=Dc.listType,1===rc)td=this.i7c.lAb(Hb);else if(0===
rc){sc=Hb.sa(Fd.a.autonumberBulletType,8);const xc=Object(H.a)(925,this.i7c);xc&&(Tc=xc.uaj(Dc,Hb))}}Ca=Object.assign(new df,{pf:Object.assign(new Ze,{lvl:this.Hh.Kgb(Ca),proofingDirty:!Ca.sa(nd.a.Cda,!1),revisionId:Ca.sa(nd.a.v0c,0).toString(),listType:rc,listTag:td,listNumeration:sc,listElementIndex:Tc})});Array.add(ob,Ca);return ob}T_i(Ca){const ob=[];let Hb=this.Y$i(Ca);if(0<Hb.count){Hb=this.$hi(this.Dye.sRc(Ca),Hb);for(let rc of Hb)Ca=rc.end-rc.start,Array.add(ob,Object.assign(new ic,{len:Ca,
cf:Object.assign(new db,{lang:rc.lcid,noProof:rc.noProof})}))}return ob}Y$i(Ca){const ob=new C.a,Hb=Ca.characterData;let rc=-1,td=-1,sc=0;for(let Tc=0;Tc<Ca.Ra.length;Tc++){const Dc=Ca.Ra.ga(Tc).formatting;Dc&&(td=ec.a.language(Dc),-1!==rc&&rc!==td&&(ob.add(Object.assign(new Ja,{start:sc,end:Ca.Ra.ga(Tc).cp,lcid:rc,noProof:!1})),sc=Ca.Ra.ga(Tc).cp),rc=td)}ob.add(Object.assign(new Ja,{start:sc,end:Hb.length,lcid:td,noProof:!1}));return ob}$hi(Ca,ob){if(!Ca)return ob;for(const Hb of Ca){Ca=!1;for(let rc=
0;rc<ob.count;rc++){if(!Ca)if(ob.ga(rc).start===Hb.begin)Ca=!0,ob.ga(rc).noProof=!0;else if(Hb.begin>ob.ga(rc).start&&Hb.begin<ob.ga(rc).end){ob.insert(rc+1,Object.assign(new Ja,{start:Hb.begin,end:ob.ga(rc).end,lcid:ob.ga(rc).lcid,noProof:!0}));Ca=!0;ob.ga(rc).end=Hb.begin;continue}if(Ca)if(Hb.end>ob.ga(rc).end)ob.ga(rc).noProof=!0;else{if(Hb.end===ob.ga(rc).end){ob.ga(rc).noProof=!0;break}if(Hb.end<ob.ga(rc).end){ob.insert(rc+1,Object.assign(new Ja,{start:Hb.end,end:ob.ga(rc).end,lcid:ob.ga(rc).lcid,
noProof:!1}));ob.ga(rc).end=Hb.end;ob.ga(rc).noProof=!0;break}}}}return ob}}Object(k.a)(Hf,"SlideTextTileManager",null,[841,924]);var xb=d(437);class hg extends Jd{constructor(Ca,ob,Hb,rc,td,sc,Tc,Dc,xc,pg,Ih){super(ob&125,Hb,rc,Ih);this.qd=Ca;this.tU=td;this.gck=sc;this.fU=Tc.Ad(12);this.cM=Tc.Ad(10);this.c$=Dc;this.ua=xc;this.oVg=pg;this.P7c=Tc.Ad(22)}Pu(){4===(this.Cy&4)&&(this.qd.$V(Object(w.a)(this,this.onActiveSlideDomReady,"onActiveSlideDomReady")),this.oVg.rai(Object(w.a)(this,this.J6g,"onTilingModuleLoaded")),
this.c_[Object(vb.a)(Bd,4)]=this.tU.RFi());16===(this.Cy&16)&&(this.fU.CBa(Object(w.a)(this,this.PIa,"onBeforeParagraphDisconnect")),this.c_[Object(vb.a)(Bd,16)]=this.tU.UFi());1===(this.Cy&1)&&(this.fU.ik(Object(w.a)(this,this.onParagraphPropertyChanged,"onParagraphPropertyChanged")),this.c_[Object(vb.a)(Bd,1)]=this.tU.VFi());8===(this.Cy&8)&&(this.cM.FG(Object(w.a)(this,this.onShapeChildTopologyChanged,"onShapeChildTopologyChanged")),this.c_[Object(vb.a)(Bd,8)]=this.tU.WFi());64===(this.Cy&64)&&
(this.P7c.CBa(Object(w.a)(this,this.x1g,"onBeforeNumberListDicsonnect")),this.c_[Object(vb.a)(Bd,64)]=this.tU.SFi());32===(this.Cy&32)&&(this.P7c.ik(Object(w.a)(this,this.onNumberListPropertyChanged,"onNumberListPropertyChanged")),this.c_[Object(vb.a)(Bd,32)]=this.tU.TFi())}Voa(){this.qd.Una(Object(w.a)(this,this.onActiveSlideDomReady,"onActiveSlideDomReady"));this.fU.Cm(Object(w.a)(this,this.onParagraphPropertyChanged,"onParagraphPropertyChanged"));this.fU.ZJa(Object(w.a)(this,this.PIa,"onBeforeParagraphDisconnect"));
this.oVg.iVk(Object(w.a)(this,this.J6g,"onTilingModuleLoaded"));this.P7c.ZJa(Object(w.a)(this,this.x1g,"onBeforeNumberListDicsonnect"));this.P7c.Cm(Object(w.a)(this,this.onNumberListPropertyChanged,"onNumberListPropertyChanged"))}x1g(Ca,ob){this.Osa(ob,64)}onNumberListPropertyChanged(Ca,ob){this.Osa(ob,32)}fireTileEvents(){try{Xb.a.forEach(this.kja,Ca=>{this.x3b(Object(H.a)(gd,this.kja[Ca]));delete this.kja[Ca]},null)}catch(Ca){eb.a.J(36525513,306,10,"Exception thrown at FireTileEvents: "+Ca)}}x3b(Ca){if(Ca&&
this.ua.Ba&&Ca.graphNode&&this.ua.Ba.id===Ca.graphNode.id){var ob=Date.now(),Hb=this.gck.P0b(Ca.graphNode,cd[Ca.YUa]);if(Hb){this.c$.execute(td=>{td.submit(xb.a.Sqc,Hb)});const rc=Ca.O_e;this.a1g(rc,ob);eb.a.J(36525515,306,50,"Fire a tile. LatestTrigger: {0}, TriggerCount: {1}, TileSize: {2}, TileId: {3}, {4}",cd[Ca.YUa],Ca.N0a,A.c(Hb).length,Hb.Id,this.KWf(rc))}}}}Object(k.a)(hg,"SlideTextTileTriggerController",Jd,[]);class rf extends ua.a{constructor(){super();this.shapeType=this.textTiles=null;
this.H_=Object.assign(new Qa.a,{T_:rf.getTypeName(),B_:rf.getBaseTypes()})}static getTypeName(){return"AugLoop_Powerpoint_PowerPointShape"}static getBaseTypes(){return[]}}Object(k.a)(rf,"PowerPointShape",ua.a,[]);class nf extends ua.a{constructor(){super();this.cid=this.sid=this.themeId=this.isSlideHidden=this.shapes=null;this.H_=Object.assign(new Qa.a,{T_:nf.getTypeName(),B_:nf.getBaseTypes()})}static getTypeName(){return"AugLoop_Powerpoint_PowerPointSlide"}static getBaseTypes(){return[]}}Object(k.a)(nf,
"PowerPointSlide",ua.a,[]);class kd extends ua.a{constructor(){super();this.content=null;this.H_=Object.assign(new Qa.a,{T_:kd.getTypeName(),B_:kd.getBaseTypes()})}static getTypeName(){return"AugLoop_Text_TextTile"}static getBaseTypes(){return[]}}Object(k.a)(kd,"TextTile",ua.a,[]);class If extends kd{constructor(){super();this.isColdIp=this.ipPosition=this.queryRange=this.fontKerning=this.specialIndentBy=this.specialIndentType=this.bulletAndNumberFontFamily=this.bulletAndNumberFontSize=this.listId=
this.rightIndentation=this.lineSpacing=this.spacingAfterParagraph=this.spacingBeforeParagraph=this.objectReferences=this.isInsideTOC=this.isInsideTable=this.formattedRanges=this.alignment=this.listType=this.outlineLevel=this.indentation=null;this.H_=Object.assign(new Qa.a,{T_:If.getTypeName(),B_:If.getBaseTypes()})}static getTypeName(){return"AugLoop_Text_FormattedTextTile"}static getBaseTypes(){return["AugLoop_Text_TextTile"]}}Object(k.a)(If,"FormattedTextTile",kd,[]);class og{constructor(Ca,ob,
Hb,rc,td,sc){this.Pb=Ca;this.Ll=ob;this.Hh=rc;this.Ga=Hb;this.gdk=td;this.qc=sc}P0b(Ca){if(!Ca||!Ca.isConnected)return null;Ca=Object(H.a)(116,Ca);if(!Ca)return null;let ob=null;const Hb=new C.a;var rc=Ca.Pk();for(var td of rc)(rc=this.LWf(td,!1))&&Hb.add(rc);(td=Ca.GSa())&&td.isConnected&&(td=this.LWf(td,!0))&&Hb.add(td);if(0<Hb.count&&(ob=Object.assign(new nf,{shapes:Hb.toArray()}),this.Ga.z2b)){ob.isSlideHidden=Ca.an;ob.themeId=this.USa(Ca);try{ob.cid=Ca.cid.toString(),ob.sid=Ca.sid.toString()}catch(sc){eb.a.J(575494306,
822,50,"Exception message: "+sc.message)}}return ob}LWf(Ca,ob){if(!Ca)return null;var Hb=this.Pb.Nc(Ca);Hb=this.Ll.S2(Hb,Hb.currentNode);let rc=null;const td=new C.a;for(;Hb.moveNext();){var sc=Hb.currentNode;if(sc&&this.Hh.Yd(sc)){sc=Object(H.a)(Ra.AParagraphNode,sc);var Tc=this.Hh.text(sc);Tc&&(Tc=Object.assign(new If,{content:Tc}),this.Ga.z2b&&this.gdk.TAk(Tc,sc),td.add(Tc))}}0<td.count&&(rc=Object.assign(new rf,{textTiles:td.toArray()}));this.Ga.z2b&&rc&&(rc.shapeType=this.sVi(Ca,ob));return rc}sVi(Ca,
ob){if(ob)return 3;if(!Ca)return 9;switch(Ca.Gj){case 0:case 2:return 0;case 3:return 1;case 10:return 7;case 15:return 5;case 9:case 12:return 8;case 8:return this.Whj(Ca)}return 9}Whj(Ca){return Ca?0<Ca.W8d().length?4:Ca.Bda?9:Ca.lx?6:2:9}USa(Ca){if(!Ca)return"";Ca=Ca.hj;let ob=null;const Hb=this.qc.xI();if(Hb&&0<Hb.length&&Ca)for(const rc of Hb)if(rc.Id===Ca){ob=rc;break}return ob&&ob.ThemeFamilyId?ob.ThemeFamilyId:""}}Object(k.a)(og,"SlideTileManager",null,[924]);class pf extends Jd{constructor(Ca,
ob,Hb,rc,td,sc,Tc,Dc){super(ob&401,Hb,rc,Dc);this.z$c=Ca.Ad(8);this.fU=Ca.Ad(12);this.tU=td;this.hck=sc;this.c$=Tc}Pu(){16===(this.Cy&16)&&(this.fU.CBa(Object(w.a)(this,this.PIa,"onBeforeParagraphDisconnect")),this.c_[Object(vb.a)(Bd,16)]=this.tU.PFi());1===(this.Cy&1)&&(this.fU.ik(Object(w.a)(this,this.onParagraphPropertyChanged,"onParagraphPropertyChanged")),this.c_[Object(vb.a)(Bd,1)]=this.tU.QFi());128===(this.Cy&128)&&(this.z$c.kia(Object(w.a)(this,this.onSlideConnected,"onSlideConnected")),
this.c_[Object(vb.a)(Bd,128)]=this.tU.NFi());256===(this.Cy&256)&&(this.z$c.y7(Object(w.a)(this,this.onSlideDisconnected,"onSlideDisconnected")),this.c_[Object(vb.a)(Bd,256)]=this.tU.OFi())}Voa(){this.fU.Cm(Object(w.a)(this,this.onParagraphPropertyChanged,"onParagraphPropertyChanged"));this.fU.ZJa(Object(w.a)(this,this.PIa,"onBeforeParagraphDisconnect"));this.z$c.Vna(Object(w.a)(this,this.onSlideConnected,"onSlideConnected"));this.z$c.$Ja(Object(w.a)(this,this.onSlideDisconnected,"onSlideDisconnected"))}onSlideConnected(Ca,
ob){this.Osa(ob,128)}onSlideDisconnected(Ca,ob){this.Osa(ob,256)}fireTileEvents(){try{Xb.a.forEach(this.kja,Ca=>{this.x3b(Object(H.a)(gd,this.kja[Ca]));delete this.kja[Ca]},null)}catch(Ca){eb.a.J(512496604,306,10,"Exception thrown at FireTileEvents: "+Ca)}}x3b(Ca){if(Ca&&Ca.graphNode){var ob=this.hck.P0b(Ca.graphNode,cd[Ca.YUa]),Hb=null,rc=Object(H.a)(116,Ca.graphNode);if(rc&&!rc.ON&&!rc.Dzb){var td=Za.a("AL.SlideTileIdOriginalFormat")?rc.sid.toString()+rc.cid.toString():rc.sid.toString()+"#"+rc.cid.toString();
rc=["session","doc"];ob=[Object.assign(new cb.a,{id:td,body:ob})];10===Ca.YUa?"slideAdded"in Ca.N0a||(Hb=Object.assign(new Sa,{parentPath:rc,items:ob})):Hb="slideAdded"in Ca.N0a?Object.assign(new la.a,{parentPath:rc,items:ob}):Object.assign(new Na.a,{parentPath:rc,items:ob});Hb&&this.c$.execute(sc=>{sc.submitOperation(Hb)})}}}}Object(k.a)(pf,"SlideTileTriggerController",Jd,[]);var ig=d(1194),Oe=d(30);class Ag{constructor(Ca,ob){this.eA=Ca;this.X9=ob}TAk(Ca,ob){try{Ca.listType=this.pwb(ob),Ca.outlineLevel=
Sb.ParagraphReader.ISc(ob),Ca.indentation=Ag.iaj(this.X9.v8(ob))}catch(Hb){eb.a.J(587313229,822,50,"Exception message: "+Hb.message)}}pwb(Ca){const ob=new Oe.GraphIterator;ob.set(Ca);ob.rc(11);ob.Ng(11);return(Ca=this.eA.fw(ob))?Ag.Czi(Ca.listType):6}static Czi(Ca){switch(Ca){case 15:return 5;case 1:return 1;case 42:return 7;case 13:return 3;case 14:return 4;case 16:return 6;case 0:return 2;default:return 7}}static iaj(Ca){return 2===Ca.Vf?Math.floor(ig.a.cCf(Ca.value)/20):Math.floor(Ca.value/20)}}
Object(k.a)(Ag,"TextTileFormatter",null,[842]);var ce=d(76);class me{constructor(){this.P_e="TML";this.va=new ce.a}rai(Ca){this.va.addHandler(this.P_e,Ca)}iVk(Ca){this.va.removeHandler(this.P_e,Ca)}VKk(Ca){this.va.raiseEvent(this.P_e,Ca)}}Object(k.a)(me,"TilingEventSource",null,[918,919,920]);class Je{}Je.Pal="ShapeTextOnActiveSlideDomReady";Je.Sal="ShapeTextOnSelectionFinished";Je.Ral="ShapeTextOnParagraphPropertyChanged";Je.Tal="ShapeTextOnShapeChildTopologyChanged";Je.Qal="ShapeTextOnParagraphDisconnect";
Je.Jil="SlideTextOnActiveSlideDomReady";Je.Nil="SlideTextOnParagraphPropertyChanged";Je.Mil="SlideTextOnParagraphDisconnect";Je.Oil="SlideTextOnShapeChildTopologyChanged";Je.Lil="SlideTextOnNumberListPropertyChanged";Je.Kil="SlideTextOnNumberListDisconnect";Je.Gil="SlideOnParagraphPropertyChanged";Je.Fil="SlideOnParagraphDisconnect";Je.Dil="SlideOnConnect";Je.Eil="SlideOnDisconnect";Object(k.a)(Je,"DetectStrategyName",null,[]);class ie{constructor(Ca){this.nU=Ca}get Cy(){return 4}r3(Ca,ob){const Hb=
[];if((Ca=Object(H.a)(lf.a,Ca))&&Ca.Ba&&(Ca=Object(H.a)(116,Ca.Ba))){Ca=Ca.Pk();for(const rc of Ca)this.nU.o0b(rc)&&Array.add(Hb,rc);0<Hb.length&&ob(Hb,1)}}}Object(k.a)(ie,"ShapeTextOnActiveSlideDomReadyDetectStrategy",null,[931]);var Tf=d(252);class He{constructor(Ca,ob,Hb){this.Ea=Ca;this.nU=ob;this.pa=Hb}get Cy(){return 16}r3(Ca,ob){if((Ca=Object(H.a)(Tf.a,Ca))&&Ca.node&&12===Ca.node.type&&(Ca=this.Ea.Zm(Ca.node))&&this.nU.o0b(Ca)){var Hb=this.pa.m_();Hb&&Hb.id===Ca.id&&(Hb=[],Array.add(Hb,Ca),
ob(Hb,6))}}}Object(k.a)(He,"ShapeTextOnParagraphDisconnectDetectStrategy",null,[931]);var Sg=d(40),jc=d(353);class be{constructor(Ca,ob,Hb){this.Ea=Ca;this.nU=ob;this.pa=Hb}get Cy(){return 1}r3(Ca,ob){if((Ca=Object(H.a)(jc.a,Ca))&&Ca.node&&12===Ca.node.type){const rc=this.Ea.Zm(Ca.node);if(rc&&this.nU.o0b(rc)){var Hb=this.pa.m_();Hb&&Hb.id===rc.id&&(Ca.property===Sg.a.listLevel?this.Xtb(3,rc,ob):Ca.property===sb.a.pq&&this.Xtb(4,rc,ob))}}}Xtb(Ca,ob,Hb){if(ob){var rc=[];Array.add(rc,ob);Hb(rc,Ca)}}}
Object(k.a)(be,"ShapeTextOnParagraphPropertyChangedDetectStrategy",null,[931]);var Md=d(837);class de{constructor(Ca,ob,Hb,rc){this.pa=Ca;this.nU=ob;this.D0=Hb;this.chc=rc}get Cy(){return 2}r3(Ca,ob){const Hb=[];if(Ca=Object(H.a)(Md.a,Ca))if(this.chc&&this.D0&&this.D0.G6b(Ca.eG),!this.pa.J3())this.chc&&this.D0&&this.D0.uJb();else if(Ca.zE&&Ca.zE.length){this.chc&&this.D0&&this.D0.uJb();Ca=this.pa.Xd();for(const rc of Ca)this.nU.o0b(rc)&&Array.add(Hb,rc);0<Hb.length&&ob(Hb,2)}}}Object(k.a)(de,"ShapeTextOnSelectionFinishedDetectStrategy",
null,[931]);var Zc=d(580);class Yf{constructor(Ca,ob){this.pa=Ca;this.nU=ob}get Cy(){return 8}r3(Ca,ob){const Hb=[];if((Ca=Object(H.a)(Zc.a,Ca))&&Ca.node&&10===Ca.node.type&&1===Ca.RZ&&(Ca=Object(H.a)(4,Ca.node))&&this.nU.o0b(Ca)){var rc=this.pa.m_();rc&&rc.get_shapeId()===Ca.get_shapeId()&&(Array.add(Hb,Ca),ob(Hb,5))}}}Object(k.a)(Yf,"ShapeTextOnShapeChildTopologyChangedDetectStrategy",null,[931]);class Vc{constructor(Ca){this.qpg=Ca}get Cy(){return 1===this.qpg?128:256}r3(Ca,ob){if((Ca=Object(H.a)(Tf.a,
Ca))&&Ca.node&&8===Ca.node.type){const Hb=[];Array.add(Hb,Ca.node);1===this.qpg?ob(Hb,9):ob(Hb,10)}}}Object(k.a)(Vc,"SlideOnConnectOrDisconnectDetectStrategy",null,[931]);class zc{constructor(Ca){this.jc=Ca}get Cy(){return 16}r3(Ca,ob){if((Ca=Object(H.a)(Tf.a,Ca))&&Ca.node&&12===Ca.node.type){const Hb=this.jc.mg(Ca.node);Hb&&(Ca=[],Array.add(Ca,Hb),ob(Ca,6))}}}Object(k.a)(zc,"SlideOnParagraphDisconnectDetectStrategy",null,[931]);class vf{constructor(Ca){this.jc=Ca}get Cy(){return 1}r3(Ca,ob){var Hb=
Object(H.a)(jc.a,Ca);if(Hb&&Hb.node&&12===Hb.node.type){const rc=this.jc.mg(Hb.node);rc&&Object(H.a)(Ra.AParagraphNode,Hb.node)&&(Ca=0,Hb.property===Sg.a.listLevel?Ca=3:Hb.property===sb.a.pq&&(Ca=4),Hb=[],Array.add(Hb,rc),ob(Hb,Ca))}}}Object(k.a)(vf,"SlideOnParagraphPropertyChangedDetectStrategy",null,[931]);class Tg{get Cy(){return 4}r3(Ca,ob){if((Ca=Object(H.a)(lf.a,Ca))&&Ca.Ba&&(Ca=Object(H.a)(116,Ca.Ba))){var Hb=Ca.Pk();for(var rc of Hb)if(rc.hasText){rc=[];Array.add(rc,Ca);ob(rc,1);break}}}}
Object(k.a)(Tg,"SlideTextOnActiveSlideDomReadyDetectStrategy",null,[931]);class bb{constructor(Ca,ob){this.jc=Ca;this.ua=ob}get Cy(){return 64}r3(Ca,ob){if((Ca=Object(H.a)(Tf.a,Ca))&&this.ua.Ba&&Ca.node&&22===Ca.node.type&&(Ca=this.jc.mg(Ca.node))&&Ca.id===this.ua.Ba.id){const Hb=[];Array.add(Hb,Ca);ob(Hb,7)}}}Object(k.a)(bb,"SlideTextOnNumberListDisconnectDetectStrategy",null,[931]);class Vb{constructor(Ca,ob){this.jc=Ca;this.ua=ob}get Cy(){return 32}r3(Ca,ob){var Hb=Object(H.a)(jc.a,Ca);Hb&&Hb.node&&
22===Hb.node.type&&(Ca=this.jc.mg(Hb.node))&&this.ua.Ba&&Ca.id===this.ua.Ba.id&&Hb.property===sb.a.Ri&&(Hb=[],Array.add(Hb,Ca),ob(Hb,8))}}Object(k.a)(Vb,"SlideTextOnNumberListPropertyChangedDetectStrategy",null,[931]);class Ub{constructor(Ca,ob,Hb,rc){this.ua=Ca;this.Xl=ob;this.jc=Hb;this.bXa=rc}get Cy(){return 16}r3(Ca,ob){if((Ca=Object(H.a)(Tf.a,Ca))&&Ca.node&&this.ua.Ba&&12===Ca.node.type){const Hb=this.jc.mg(Ca.node);!Hb||Hb.id!==this.ua.Ba.id||this.Xl.wka(Ca.node)&&!this.bXa||(Ca=[],Array.add(Ca,
this.ua.Ba),ob(Ca,6))}}}Object(k.a)(Ub,"SlideTextOnParagraphDisconnectDetectStrategy",null,[931]);class Jc{constructor(Ca,ob,Hb,rc,td,sc,Tc,Dc){this.ua=Ca;this.Xl=ob;this.jc=Hb;this.Ea=rc;this.bXa=td;this.D0=Tc;this.chc=Dc}get Cy(){return 1}r3(Ca,ob){if((Ca=Object(H.a)(jc.a,Ca))&&Ca.node&&this.ua.Ba&&12===Ca.node.type){var Hb=this.jc.mg(Ca.node);if(Hb&&Hb.id===this.ua.Ba.id&&(Hb=Object(H.a)(Ra.AParagraphNode,Ca.node))&&(!this.Xl.wka(Hb)||this.bXa)){var rc=this.Ea.Zm(Hb);rc.nua||rc.lx||rc.Rf||rc.ud||
!rc.gl||!this.chc||(this.D0.settings.YJe=!0,this.D0.Ptl(Hb));Ca.property===Sg.a.listLevel?this.Xtb(3,this.ua.Ba,ob):Ca.property===sb.a.pq?this.Xtb(4,this.ua.Ba,ob):Ca.property===nd.a.Cda&&(Hb.sa(nd.a.Cda,!1)||this.Xtb(4,this.ua.Ba,ob))}}}Xtb(Ca,ob,Hb){if(ob){var rc=[];Array.add(rc,ob);Hb(rc,Ca)}}}Object(k.a)(Jc,"SlideTextOnParagraphPropertyChangedDetectStrategy",null,[931]);class Mc{constructor(Ca,ob){this.ua=Ca;this.jc=ob}get Cy(){return 8}r3(Ca,ob){Ca=Object(H.a)(Zc.a,Ca);this.ua.Ba&&Ca&&Ca.node&&
10===Ca.node.type&&1===Ca.RZ&&(Ca=Object(H.a)(4,Ca.node))&&(Ca=this.jc.mg(Ca))&&Ca.id===this.ua.Ba.id&&(Ca=[],Array.add(Ca,this.ua.Ba),ob(Ca,5))}}Object(k.a)(Mc,"SlideTextOnShapeChildTopologyChangedDetectStrategy",null,[931]);class ed{constructor(Ca,ob,Hb,rc,td,sc,Tc,Dc,xc){this.jc=Ca;this.Ea=ob;this.ob=Hb;this.nU=rc;this.ua=td;this.Xl=sc;this.Ga=Tc;this.xC=Dc;this.D0=xc}M7i(Ca){if($c.a.Wa(Ca))return 0;let ob=0;for(const Hb of Ca)ob|=this.wYk(Hb);return ob}O7i(Ca){if($c.a.Wa(Ca))return 0;let ob=0;
for(const Hb of Ca)ob|=this.yYk(Hb);return ob}N7i(Ca){if($c.a.Wa(Ca))return 0;let ob=0;for(const Hb of Ca)ob|=this.xYk(Hb);return ob}DFi(){return new be(this.Ea,this.nU,this.ob)}EFi(){return new de(this.ob,this.nU,this.D0,this.Ga.Flc)}BFi(){return new ie(this.nU)}FFi(){return new Yf(this.ob,this.nU)}CFi(){return new He(this.Ea,this.nU,this.ob)}RFi(){return new Tg}UFi(){return new Ub(this.ua,this.Xl,this.jc,this.Ga.pptNotesInSlideTextTileIsEnabled)}VFi(){return new Jc(this.ua,this.Xl,this.jc,this.Ea,
this.Ga.pptNotesInSlideTextTileIsEnabled,this.xC,this.D0,this.Ga.Flc)}WFi(){return new Mc(this.ua,this.jc)}TFi(){return new Vb(this.jc,this.ua)}SFi(){return new bb(this.jc,this.ua)}PFi(){return new zc(this.jc)}QFi(){return new vf(this.jc)}OFi(){return new Vc(2)}NFi(){return new Vc(1)}wYk(Ca){return Ca===Je.Ral?1:Ca===Je.Sal?2:Ca===Je.Pal?4:Ca===Je.Tal?8:Ca===Je.Qal?16:0}yYk(Ca){return Ca===Je.Jil?4:Ca===Je.Mil?16:Ca===Je.Nil?1:Ca===Je.Oil?8:Ca===Je.Lil?32:Ca===Je.Kil?64:0}xYk(Ca){return Ca===Je.Fil?
16:Ca===Je.Gil?1:Ca===Je.Dil?128:Ca===Je.Eil?256:0}}Object(k.a)(ed,"TilingFactory",null,[843]);class dd extends Sys.EventArgs{constructor(Ca){super();this.Ba=Ca}}Object(k.a)(dd,"TilingModuleLoadEventArgs",Sys.EventArgs,[]);class je{constructor(){this.K=null;this.Yze=this.roe=!1}get name(){return"PowerPointWebEditor.ContentUpdateDetection"}$b(Ca){this.K=Ca;Ca.register(me,"PowerPointWebEditor.ContentUpdateDetection.TilingEventSource").as("PowerPointWebEditor.ContentUpdateDetection.ITilingEventNotifier").as("PowerPointWebEditor.ContentUpdateDetection.ITilingEventHandlers").as("PowerPointWebEditor.ContentUpdateDetection.ITilingEventSource").ma().oa(()=>
new me);Ca.register(840,"PowerPointWebEditor.ContentUpdateDetection.IShapeTextTileManager").ma().oa(()=>new Ab(Ca.resolve("Box4.Graph.IGraphIteratorFactory"),Ca.resolve("PowerPointWebEditor.Graph.ITraverserFactory"),Ca.resolve("PowerPointWebEditor.IShapeReader"),Ca.resolve("Box4.IParagraphReader")));Ca.register(841,"PowerPointWebEditor.ContentUpdateDetection.ISlideTextTileManager").ma().oa(()=>new Hf(Ca.resolve("Box4.IParagraphReader"),Ca.resolve("PowerPointWebEditor.Graph.INotesReader"),Ca.resolve("Box4.Proofing.IProofingTextUtility"),
Ca.resolve("Box4.Graph.IGraphIteratorFactory"),Ca.resolve("Box4.ITableNavigator"),Ca.resolve("PowerPointWebEditor.Graph.ITableReader"),Ca.resolve("PowerPointWebEditor.Graph.ITraverserFactory"),Ca.resolve("Box4.IListMarkerUtility"),Ca.resolve("PowerPointWebEditor.IPPTParagraphReader"),Ca.resolve("Box4.List.IListReader"),Ca.resolve("PowerPointWebEditor.IApplicationSettings").pptNotesInSlideTextTileIsEnabled,Ca.resolve("PowerPointWebEditor.IApplicationSettings").powerPointTopologyAndListInfoInSlideTileIsEnabled));
Ca.register(842,"PowerPointWebEditor.ContentUpdateDetection.ITextTileFormatter").ma().oa(()=>new Ag(Ca.resolve("Box4.List.IListReader"),Ca.resolve("Box4.IParagraphIndentationReader")));Ca.register(og,"PowerPointWebEditor.ContentUpdateDetection.SlideTileManager").ma().oa(()=>new og(Ca.resolve("Box4.Graph.IGraphIteratorFactory"),Ca.resolve("PowerPointWebEditor.Graph.ITraverserFactory"),Ca.resolve("PowerPointWebEditor.IApplicationSettings"),Ca.resolve("Box4.IParagraphReader"),Ca.resolve("PowerPointWebEditor.ContentUpdateDetection.ITextTileFormatter"),
Ca.resolve("PowerPointWebEditor.IPresentationReader")));Ca.register(843,"PowerPointWebEditor.ContentUpdateDetection.ITilingFactory").ma().oa(()=>new ed(Ca.resolve("PowerPointWebEditor.ISlideReader"),Ca.resolve("PowerPointWebEditor.IShapeReader"),Ca.resolve("PowerPointWebEditor.IPptSelectionManager"),Ca.resolve("PowerPointWebEditor.ContentUpdateDetection.IShapeTextTileManager"),Ca.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Ca.resolve("PowerPointWebEditor.Graph.INotesReader"),Ca.resolve("PowerPointWebEditor.IApplicationSettings"),
Ca.Ja("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),Ca.resolve("PowerPointWebEditor.TextPrediction.ITextPredictionHandler")));Ca.register(Xf,"PowerPointWebEditor.ContentUpdateDetection.ShapeTextTileTriggerController").ma().oa(()=>new Xf(Ca.resolve("Box4.Graph.IGraphInstance"),Ca.resolve("PowerPointWebEditor.IPptSelectionManager"),Ca.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),Ca.Ja("PowerPointWebEditor.AugmentationLoop.IPPTAugmentationManager"),Ca.Ja("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),
Ca.resolve("PowerPointWebEditor.ContentUpdateDetection.IShapeTextTileManager"),Ca.resolve("PowerPointWebEditor.ContentUpdateDetection.ITilingFactory").M7i(Ca.resolve("PowerPointWebEditor.IApplicationSettings").powerPointTileDetectStrategyList),Ca.resolve("Common.ITaskManager"),Ca.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Ca.resolve("PowerPointWebEditor.IApplicationSettings").powerPointFireTileEventsIntervalInMilliseconds,Ca.resolve("PowerPointWebEditor.ContentUpdateDetection.ITilingFactory"),
Ca.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),Ca.resolve("PowerPointWebEditor.IApplicationSettings").replaceObjectUseClientAL));Ca.register(hg,"PowerPointWebEditor.ContentUpdateDetection.SlideTextTileTriggerController").ma().oa(()=>new hg(Ca.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),Ca.resolve("PowerPointWebEditor.ContentUpdateDetection.ITilingFactory").O7i(Ca.resolve("PowerPointWebEditor.IApplicationSettings").powerPointTileDetectStrategyList),Ca.resolve("Common.ITaskManager"),
Ca.resolve("PowerPointWebEditor.IApplicationSettings").powerPointFireSlideTileEventsIntervalInMilliseconds,Ca.resolve("PowerPointWebEditor.ContentUpdateDetection.ITilingFactory"),Ca.resolve("PowerPointWebEditor.ContentUpdateDetection.ISlideTextTileManager"),Ca.resolve("Box4.Graph.IGraphInstance"),Ca.Ja("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),Ca.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Ca.resolve("PowerPointWebEditor.ContentUpdateDetection.ITilingEventHandlers"),
Ca.resolve("PowerPointWebEditor.Core.IPPTAppFrame")));Ca.register(pf,"PowerPointWebEditor.ContentUpdateDetection.SlideTileTriggerController").ma().oa(()=>new pf(Ca.resolve("Box4.Graph.IGraphInstance"),Ca.resolve("PowerPointWebEditor.ContentUpdateDetection.ITilingFactory").N7i(Ca.resolve("PowerPointWebEditor.IApplicationSettings").powerPointTileDetectStrategyList),Ca.resolve("Common.ITaskManager"),Ca.resolve("PowerPointWebEditor.IApplicationSettings").powerPointFireSlideTileEventsIntervalInMilliseconds,
Ca.resolve("PowerPointWebEditor.ContentUpdateDetection.ITilingFactory"),Ca.resolve("PowerPointWebEditor.ContentUpdateDetection.SlideTileManager"),Ca.Ja("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),Ca.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),Ca.resolve("PowerPointWebEditor.IApplicationSettings")))}rSf(){return Za.a("AL.SendSlideTile")}init(){const Ca=this.K.resolve("Common.IAppSettingsManager");Ca.jf(()=>{this.roe=Ca.ka("497");this.Yze=Ca.ka("810")||Ca.ka("809");this.roe&&
(Ca.ka("473")&&this.K.resolve("PowerPointWebEditor.ContentUpdateDetection.ShapeTextTileTriggerController").initialize(),(this.Yze||this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointInfraredMakeItVisualEnabled)&&this.K.resolve("PowerPointWebEditor.ContentUpdateDetection.SlideTextTileTriggerController").initialize(),this.rSf()&&this.K.resolve("PowerPointWebEditor.ContentUpdateDetection.SlideTileTriggerController").initialize());this.K.resolve("PowerPointWebEditor.ContentUpdateDetection.ITilingEventNotifier").VKk(new dd(this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager").Ba))})}dispose(){this.roe&&
(this.K.resolve("Common.IAppSettingsManager").ka("473")&&this.K.resolve("PowerPointWebEditor.ContentUpdateDetection.ShapeTextTileTriggerController").dispose(),(this.Yze||this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointInfraredMakeItVisualEnabled)&&this.K.resolve("PowerPointWebEditor.ContentUpdateDetection.SlideTextTileTriggerController").dispose(),this.rSf()&&this.K.resolve("PowerPointWebEditor.ContentUpdateDetection.SlideTileTriggerController").initialize())}static main(){v.a.instance.Dc(new je)}}
Object(k.a)(je,"PPTWebEditorContentUpdateDetectionPackage",null,[2,3]);var Nd=d(1006),Ld=d(642),Xe=d(140),pe=d(153),fe=d(520),wd=d(109),Ue=d(47);class rd{constructor(Ca,ob,Hb,rc,td,sc,Tc,Dc){this.type="EditorPaneProps";this.critiqueCountInclusiveness=this.critiqueCountClarity=this.critiqueCountConciseness=this.critiqueCountVocabulary=this.critiqueCountPunctuationConvention=this.critiqueCountFormality=this.critiqueCountGrammar=this.critiqueCountSpelling=null;this.critiqueCountSpelling=Ca;this.critiqueCountGrammar=
ob;this.critiqueCountFormality=Hb;this.critiqueCountPunctuationConvention=rc;this.critiqueCountVocabulary=td;this.critiqueCountConciseness=sc;this.critiqueCountClarity=Tc;this.critiqueCountInclusiveness=Dc}}Object(k.a)(rd,"EditorPaneProps",null,[]);class Ud{constructor(Ca,ob,Hb,rc,td,sc,Tc,Dc,xc,pg,Ih,vh,Ti,ai,Il){this.Db=!1;this.wli=320;this.pXa=!1;this.Caa={};if(!Ca)throw Error.argumentNull("pptSelectionManager");if(!ob)throw Error.argumentNull("appFrame");if(!Hb)throw Error.argumentNull("actionManager");
if(!rc)throw Error.argumentNull("focusManager");if(!td)throw Error.argumentNull("editorPane");if(!Tc)throw Error.argumentNull("graphOperationEventHandler");if(!Dc)throw Error.argumentNull("viewElementEventHandlers");if(!xc)throw Error.argumentNull("viewEventSource");if(!pg)throw Error.argumentNull("pageView");if(!vh)throw Error.argumentNull("workspace");if(!Ti)throw Error.argumentNull("dynamicScriptLoader");if(!Il)throw Error.argumentNull("graphTopologyManager");Ti.loadScript("powerpoint-editor-intl").then(()=>
{this.pXa=!0}).catch(ui=>{eb.a.J(512267606,801,10,"Failed to load powerpoint-editor-intl "+ui.toString())});this.Qb=ob;this.ia=Hb;this.dpe=ai;this.Fa=rc;this.Lg=Tc;this.qd=Dc;this.Lc=xc;this.c$=Ih;this.ua=Il;this.Lg.kI(this.RIa.bind(this));this.Lg.BBa(this.RIa.bind(this));this.Lc.oPa(this.RIa.bind(this));this.qd.EBa(this.RIa.bind(this));this.Qb.IK(this.Mu.bind(this));this.initialize()}initialize(){this.c$.execute(Ca=>{Ca.addEventHandler(fe.a.pUd,this.Cqj.bind(this))})}dispose(){this.Lg.F5(this.RIa.bind(this));
this.Lg.NZa(this.RIa.bind(this));this.Lc.gib(this.RIa.bind(this));this.qd.iib(this.RIa.bind(this));this.Qb.wY(this.RIa.bind(this))}vb(){this.ia.ra(od.a.npd,bd.a.application,this.npd.bind(this),4);this.ia.ra(od.a.Khd,bd.a.application,this.Khd.bind(this),96)}De(){}RIa(){this.Db&&this.em(!0)}Mu(Ca){1===Ca.mode&&this.Db&&(this.Db=!1,this.zr(),this.Fa.Bj(Ue.a.b8,this.Db))}Khd(Ca,ob,Hb,rc,td){(Ca=Object(H.a)(wd.a,td))&&Ca.Qf(this.Db);return 32}npd(Ca,ob,Hb){return this.pXa?1===Hb?32:2===Hb?(this.Db=!this.Db,
pe.b("EditorPaneActor::ShowHideEditorPane PaneOpen: ",this.Db.toString(),Ca,()=>{this.Db?this.em():this.zr();return 32})):8:8}em(Ca=!1){const ob=this.jC(),Hb=Object.assign(new Ld.a,{title:"Editor Pane",hideHeader:!1,width:this.wli,location:2,contentProps:ob,onOpen:()=>{},onClose:()=>{this.Db=!1},isModernPane:!0});Xe.UISurfaces.xr().then(rc=>{Ca?rc.updateTaskPane(Ue.a.b8,Hb):rc.showTaskPane(Ue.a.b8,Hb);return null}).catch(rc=>{eb.a.J(512267605,822,10,"EditorPaneActor::ShowPane, Failed to show editor pane. Exception: "+
rc.toString())})}zr(){Xe.UISurfaces.xr().then(Ca=>{Ca.hideTaskPane(Ue.a.b8,2);return null}).catch(Ca=>{eb.a.J(512267604,822,10,"EditorPaneActor::HidePane, Failed to hide editor pane. Exception: "+Ca.toString())})}jC(){let Ca=0,ob=0,Hb=0,rc=0,td=0,sc=0,Tc=0,Dc=0;const xc=this.ua.Ba?this.ua.Ba.cid:void 0;xc&&this.Caa[xc]&&Object.keys(this.Caa[xc]).forEach(pg=>{this.Caa[xc][pg].forEach(Ih=>{switch(Ih.CategoryTitle){case "Spelling":Ca+=1;break;case "Grammar":ob+=1;break;case "Conciseness":sc+=1;break;
case "Formality":Hb+=1;break;case "PunctuationConventions":rc+=1;break;case "Clarity":Tc+=1;break;case "Inclusiveness":Dc+=1;break;case "Vocabulary":td+=1;break;default:eb.a.J(509727769,822,50,"Unknown Critique Type: "+Ih.CategoryTitle)}})});return new rd(Ca,ob,Hb,rc,td,sc,Tc,Dc)}Pxl(Ca,ob){const Hb={};Object.keys(Ca).forEach(rc=>{this.Caa[ob]?(Object.keys(this.Caa[ob]).includes(rc),this.Caa[ob][rc]=Ca[rc]):(Hb[rc]=Ca[rc],this.Caa[ob]=Hb)})}Cqj(Ca,ob,Hb,rc){ob&&rc&&(Ca=JSON.parse(ob.Content),rc=this.dpe.sGf(rc.critiques),
ob=this.ua.Ba.cid,null!=rc&&0<rc.length?this.Pxl(this.n3i(rc),ob):0==rc.length&&this.Caa[ob]&&this.sOi(Ca.drawingElems,ob),this.Caa[ob]&&this.JSk(Ca.drawingElems,ob),this.em(!0))}JSk(Ca,ob){const Hb=Object.keys(this.Caa[ob]),rc=this.wlj(Ca);Hb.forEach(td=>{rc.includes(td)||delete this.Caa[ob][td]})}wlj(Ca){const ob=[];Ca.forEach(Hb=>{0<Hb.text.paragraphs.length&&Hb.text.paragraphs.forEach(rc=>{ob.push(rc.id)})});return ob}sOi(Ca,ob){Ca.forEach(Hb=>{0<Hb.text.paragraphs.length&&this.Iqi(Hb.text.paragraphs,
ob)})}Iqi(Ca,ob){Ca.forEach(Hb=>{this.Caa[ob][Hb.id]&&(Hb.pfRuns[0].pf.proofingDirty||""==Hb.chars)&&delete this.Caa[ob][Hb.id]})}n3i(Ca){const ob={};if(Ca)for(const Hb of Ca)Hb.TileId in ob?Array.add(ob[Hb.TileId],Hb):ob[Hb.TileId]=[Hb];return ob}}Object(k.a)(Ud,"DexLitePaneActor",null,[106,227]);class qe{constructor(){this.va=new ce.a}fNe(Ca){this.va.raiseEvent("OnEditorConsistencyCritiqueOnActiveSlide",Ca)}nsf(Ca){this.va.addHandler("OnEditorConsistencyCritiqueOnActiveSlide",Ca)}}Object(k.a)(qe,
"EditorRuntimeEventSource",null,[921,922,923]);var Nf=d(15),sf=d(49),tf=d(681),Lf=d(32);class kf{constructor(Ca,ob){this.paragraph=Ca;this.critiqueId=ob}}Object(k.a)(kf,"CritiqueToHighlight",null,[]);class Ed{constructor(Ca,ob,Hb,rc,td,sc,Tc,Dc,xc,pg){this.jea=Ca;this.Y4j=ob;this.ua=Hb;this.FC=rc;this.Jb=td;this.cJ=sc;this.pa=Tc;this.Epe=Dc;this.Fa=xc;this.y6j=pg;this.jea.nOe(this.Y4j)}wVc(Ca){Ca.length?(Ca=this.rdj(Ca),Ca.length&&(Ca=Object.assign(new tf.a,{action:0,type:2,jda:Ca,rhb:this.jea.jbb?
this.jea.jbb.jda:null}),this.jea.ond(Ca))):this.hJi()}hJi(){var Ca=this.jea.jbb?this.jea.jbb.jda:null;Ca=Object.assign(new tf.a,{action:1,type:2,jda:Ca,rhb:Ca});this.jea.ond(Ca)}rdj(Ca){const ob=[];if(!this.Epe.isEnabled(2))return ob;var Hb=this.ua.Ba;if(Hb&&Hb.isSlideCritiqueReady){var rc=Hb.YKa;if(!rc.count)return this.bne(2),ob;Hb=0;for(let sc of rc)if(rc=Object(H.a)(Ra.AParagraphNode,sc)){var td=this.n6d(rc);for(const Tc of td)td=Object(H.a)(287,Tc.Gh),td.qN&&Array.contains(Ca,td.qN.TraceId)&&
(Hb++,td=new kf(rc,td.qN.TraceId),Array.add(ob,td))}Hb!==Ca.length&&this.one(2,Hb,Ca.length)}else this.jne(2,Hb);return ob}eAh(Ca){if(!this.Epe.isEnabled(3))return!1;var ob=this.ua.Ba;if(ob&&ob.isSlideCritiqueReady){ob=ob.YKa;if(!ob.count)return this.bne(3),!1;let Hb=0;const rc=this.Jb.zd(15,void 0,()=>{this.Gah()});try{let td=!1;rc.nc(ob.ga(0));rc.jd=Lf.a.erd;for(let sc of ob){const Tc=Object(H.a)(Ra.AParagraphNode,sc);if(Tc){const Dc=new C.a,xc=this.n6d(Tc);for(const pg of xc){const Ih=Object(H.a)(287,
pg.Gh);if(Ih.qN&&Ca.Hb(Ih.qN.TraceId)){const vh=Ca.ga(Ih.qN.TraceId);let Ti;try{Ti=Ih.qN.Suggestions[vh].Text;const ai=new Nf.a(pg,Ti);Dc.add(ai);td||(Ih.JLa(this.efk(vh)),td=!0);Hb++}catch(ai){eb.a.J(38843398,375,10,"Take suggestion: Parse failed with exception: {0}",ai)}}}Dc.count&&(Dc.Sc((pg,Ih)=>Ih.key.begin-pg.key.begin),this.jWk(Tc,Dc))}}Hb!==Ca.count&&this.one(3,Hb,Ca.count)}finally{rc&&rc.dispose()}}else return this.jne(3,ob),!1;return!0}efk(Ca){switch(Ca){case 0:return Lf.a.Vya;case 1:return Lf.a.Wya;
case 2:return Lf.a.Xya;case 3:return Lf.a.qLa;case 4:return Lf.a.rLa;default:return 0}}jWk(Ca,ob){for(let Hb of ob)this.cJ.replaceTextRange(sf.a.createTextRange(Ca,0<Hb.key.begin?Hb.key.begin:0,Hb.key.end),Hb.value,!0,!1)}ignoreCritiques(Ca,ob){if(!this.Epe.isEnabled(ob))return!1;var Hb=this.ua.Ba;if(Hb&&Hb.isSlideCritiqueReady){var rc=Hb.YKa;if(!rc.count)return this.bne(ob),!1;this.Gah();Hb=!1;let td=0;for(let sc of rc)if(rc=Object(H.a)(Ra.AParagraphNode,sc)){rc=this.n6d(rc);for(const Tc of rc)rc=
Object(H.a)(287,Tc.Gh),rc.qN&&Array.contains(Ca,rc.qN.TraceId)&&(rc.wEa=!0,Hb||(rc.JLa(Lf.a.Ibe),Hb=!0),td++)}td!==Ca.length&&this.one(ob,td,Ca.length)}else return this.jne(ob,Hb),!1;return!0}n6d(Ca){return this.FC.BF(Ca,ob=>{ob=Object(H.a)(287,ob.Gh);return!!ob&&5===ob.proofingType&&!ob.wEa})}bne(Ca){eb.a.J(38843400,375,15,"{0}: No slide critique in active slide. Skipping",Ca)}one(Ca,ob,Hb){eb.a.J(38843402,375,15,"{0}: ErrorRange number mismatch. Actual: {1}, expected: {2}",Ca,ob,Hb)}jne(Ca,ob){eb.a.J(38843404,
375,15,"{0}: Active slide is null or slide critiques are not ready. Active slide null: {1}",Ca,!!ob)}Gah(){this.pa.Vx();this.pa.ij();this.y6j&&this.Fa.xf(Ue.a.rg,!0)}}Object(k.a)(Ed,"ConsistencyCheckActor",null,[844]);var Cd=d(311),oh=d(95),Kg=d(901),ri=d(678),Af=d(48),Zg=d(679),gi=d(680);class jg extends ri.a{constructor(Ca,ob){super();this.F3c=[Kg.a.NDe,Kg.a.H0c,Kg.a.rld,Kg.a.sHc];this.ua=Ca;this.w8j=ob;this.Ute=[new Zg.a("InconsistentCritiquesHighlight",null),new Zg.a("InconsistentCritiquesLeftSidebar",
null),new Zg.a("InconsistentCritiquesRightSidebar",null)]}get wxb(){return this.w8j}get mbe(){return this.Ute}n8b(Ca,ob){Ca=Object(ee.a)(Array,Ca)?Array.isArray(Ca)?Ca:null:null;if(!Ca||0<Ca.length&&!Object(H.a)(kf,Ca[0]))return ob;const Hb=new Af.GraphTransaction(3);try{Hb.kd(this.ua.presentation);for(const rc of Ca)gi.b(rc.paragraph),ob.add(rc.paragraph)}finally{Hb&&Hb.dispose()}return ob}Bjc(Ca,ob){if(this.wxb&&this.r_&&this.r_.aja&&this.r_.aja.jda&&2===this.r_.aja.type){var Hb=[],rc=[];this.C$g(this.r_.aja.jda,
Hb,rc);var td=[];this.C$g(this.r_.aja.rhb,null,td);ob=ob.querySelectorAll("*");for(let sc=0;sc<ob.length;sc++){let Tc="",Dc="";const xc=ob[sc];for(let pg=0;pg<this.F3c.length;pg++)Cd.a.ye(xc,this.F3c[pg])&&(Dc=this.F3c[pg],Tc=Cd.a.ye(xc,this.F3c[pg]));Tc.length&&2===this.r_.aja.type&&(0===this.r_.aja.action?Array.contains(rc,Ca)&&Array.contains(Hb,Tc)?this.Zxj(xc,Dc):this.Tjd(xc):1===this.r_.aja.action&&Array.contains(td,Ca)&&this.Tjd(xc))}}}Zxj(Ca,ob){oh.a.sI(Ca,"InconsistentCritiquesHighlight");
switch(ob){case Kg.a.H0c:oh.a.sI(Ca,"InconsistentCritiquesLeftSidebar");break;case Kg.a.rld:oh.a.sI(Ca,"InconsistentCritiquesRightSidebar");break;case Kg.a.sHc:oh.a.sI(Ca,"InconsistentCritiquesLeftSidebar"),oh.a.sI(Ca,"InconsistentCritiquesRightSidebar")}}C$g(Ca,ob,Hb){if(Ca)for(const rc of Ca)Array.add(Hb,rc.paragraph),ob&&Array.add(ob,rc.critiqueId)}}Object(k.a)(jg,"CritiquesHighlightActor",ri.a,[]);class Hh{}Object(k.a)(Hh,"Critique",null,[]);class hj{}Object(k.a)(hj,"Suggestion",null,[]);class Hk{qGf(Ca,
ob){if(!Ca)return[];const Hb=Array(Ca.length);for(let rc=0;rc<Ca.length;rc++)Hb[rc]=ob(Ca[rc]);return Hb}ezi(Ca){return Object.assign(new Hh,{critiqueId:Ca.TraceId,typeId:Ca.TypeId,tag:Ca.Tag,bucketId:Ca.BucketId,paragraphId:Ca.TileId,start:Ca.Start,length:Ca.Length,categoryTitle:Ca.CategoryTitle,explanationTitle:Ca.ExplanationTitle,explanationLabel:Ca.ExplanationLabel,explanation:Ca.Explanation,suggestions:this.qGf(Ca.Suggestions,Object(w.a)(this,this.fzi,"convertBox4Suggestion"))})}fzi(Ca){return Object.assign(new hj,
{text:Ca.Text,description:Ca.Description,bucketId:Ca.BucketId,numberOfInstances:Ca.NumberOfInstances})}}Object(k.a)(Hk,"DataContractMapper",null,[847]);class yd extends Sys.EventArgs{constructor(Ca){super();this.instanceId=Ca}}Object(k.a)(yd,"PaneClosedEventArgs",Sys.EventArgs,[]);var ef=d(186);class yh{constructor(Ca,ob,Hb,rc,td,sc,Tc,Dc){this.ia=Ca;this.Zc=ob;this.Lc=Hb;this.Cqe=rc;this.rDb=td;this.WBb=sc;this.due=Tc;this.Rdk=Dc;this.Ge=0;this.Zc.execute(xc=>{xc.KFc(Object(w.a)(this,this.XIa,"onPaneClosed"))})}get state(){return this.Ge}sod(Ca){this.Ge!==
Ca&&(this.Ge=Ca,this.Lc.sz(new ef.a(1)))}r7g(Ca){0===this.state&&(eb.a.J(36966754,375,50,"[EditorPane] Begin opening Editor pane, reason: {0} Time: {1}",Ca,(new Date).getTime()),this.sod(1),Ca={},Ca.TE=ResourceStrings.L_EditorPaneTitle,Ca.assetId=this.rDb.getAssetId(),Ca.p5=Object(w.a)(this,this.tgb,"onPaneRendered"),Ca.nonPersistedSettings={},Ca.nonPersistedSettings.IdeasEnabled=this.due.toString(),Ca.ZLa=this.Rdk,32!==this.ia.La(od.a.Ufa,2,Ca)&&(eb.a.J(36966784,375,15,"[EditorPane] Failed to open Editor pane"),
this.sod(0)))}QK(Ca){if(2===this.state){var ob=this.rDb.m9a();ob&&(eb.a.J(36966786,375,50,"[EditorPane] Begin closing Editor pane, reason: {0}",Ca),32!==this.ia.La(od.a.Ssb,2,ob)&&eb.a.J(36966788,375,15,"[EditorPane] Failed to close Editor pane"))}}XIa(Ca,ob){2===this.state&&ob&&(Ca=ob.instanceId)&&Ca.length&&(ob=this.rDb.m9a(),ob!==Ca&&ob||(eb.a.J(37626588,375,50,"[EditorPane] Pane closed"),this.Cqe.JJk(new yd(Ca)),this.sod(0),this.WBb.sessionEnd()))}tgb(){const Ca=this.rDb.m9a();1!==this.state?
eb.a.J(37626590,375,15,"[EditorPaneActor] Received pane rendered event even though we weren't in opening state. Instance id={0}",Ca):(eb.a.J(37626592,375,50,"[EditorPane] Pane rendered. Instance id={0}",Ca),this.sod(2),this.WBb.Z3k())}}Object(k.a)(yh,"EditorPane",null,[849]);class Bg{constructor(Ca,ob){this.type=0;this.id=null;this.type=Ca;this.id=ob}static ilb(Ca){return Ca.id&&Ca.id.toString().length&&Object(ee.a)(Number,Ca.type)?new Bg(Ca.type,Ca.id.toString()):null}}Object(k.a)(Bg,"Message",null,
[]);var Kd=d(2);class Rj{constructor(Ca,ob,Hb,rc,td,sc,Tc,Dc,xc,pg,Ih,vh,Ti,ai,Il,ui){this.F0d=new Nd.a;this.ia=Ca;this.$_=ob;this.sBb=Hb;this.gug=rc;this.a0=td;this.qGg=sc;this.JL=Tc;this.Cqe=Dc;this.ua=xc;this.hma=pg;this.x$c=Ih;this.Rk=vh;this.G5j=Ti;this.Lc=ai;this.I6j=Il;this.qc=ui;this.eOc=new Nd.a(0);this.eOc.add(0,2001);this.eOc.add(1,2002);this.eOc.add(2,2003)}vb(){this.ia.ra(od.a.yJe,bd.a.application,Object(w.a)(this,this.HOf,"editorPaneButtonClicked"),4);this.ia.ra(od.a.fMe,bd.a.application,
Object(w.a)(this,this.Ich,"queryEditorPaneButton"),96);this.ia.ra(od.a.PBk,bd.a.application,Object(w.a)(this,this.HOf,"editorPaneButtonClicked"),4);this.ia.ra(od.a.gMe,bd.a.application,Object(w.a)(this,this.Ich,"queryEditorPaneButton"),96);this.ia.ra(od.a.xJe,bd.a.application,Object(w.a)(this,this.IOf,"editorPaneExtenal"),4);this.ia.ra(od.a.dah,bd.a.application,Object(w.a)(this,this.IOf,"editorPaneExtenal"),4);this.gug.XNd(Object(w.a)(this,this.gok,"onEditorPaneMessageReceived"));this.hma.N5a(Object(w.a)(this,
this.M0,"onSlidePresenceChanged"));this.x$c.ik(Object(w.a)(this,this.rna,"onSlidePropertyChanged"));this.Rk.kI(Object(w.a)(this,this.sB,"onActiveSlideChanged"));this.Cqe.g$h(Object(w.a)(this,this.XIa,"onPaneClosed"))}De(){}IOf(Ca,ob,Hb){if(1===Hb)return 32;switch(Ca){case od.a.xJe:this.$_.r7g(2);break;case od.a.dah:this.$_.QK(2);break;default:return eb.a.J(38412318,375,10,"[EditorPaneActor] Unsupported actionId: {0}",Ca),16}return 32}HOf(Ca,ob,Hb){if(1===Hb)return this.qc.Lj()?32:16;switch(this.$_.state){case 0:return this.$_.r7g(1),
32;case 2:return this.$_.QK(1),32;case 1:return eb.a.J(37626594,375,50,"[EditorPaneActor] User double clicked to open pane before it was rendered"),this.Lc.sz(new ef.a(1)),32;default:return eb.a.J(36966800,375,10,"[EditorPaneActor] Unsupported EditorPaneState"),16}}Ich(Ca,ob,Hb,rc,td){if(!td||!Object(ee.a)(wd.a,td))return 8;td.Qf(2===this.$_.state||1===this.$_.state);return 32}gok(Ca,ob){this.hok(ob)}hok(Ca){const ob=this.a0.aKi(Ca.message);if(ob){var Hb;({value:Hb}=this.qGg.Uf(ob.type)).returnValue||
(Hb=this.qGg.ga(0));var rc=Hb.process(Ca,ob);rc.continueWith(()=>{const td=rc.result,sc=this.a0.rPf(td);this.sendMessage(Ca.instanceId,sc);this.$0j(Ca,ob,td)})}else eb.a.J(37025985,375,15,"[EditorPaneActor] OnEditorPaneMessageReceived, can't deserialize message."),Kd.Task.Nt(!1)}gNe(Ca){this.F0d.Hb(Ca)||this.F0d.$(Ca,this.I6j.tWd(200,()=>{const ob=this.sBb.Djj(Ca);if(ob.length){var Hb=new Bg(this.eOc.ga(Ca),kb.a.create().toString());Hb=this.a0.rPf(Hb);this.Y2k(ob,Hb)}this.G5j.fNe(Ca)}));this.F0d.ga(Ca).perform()}Y2k(Ca,
ob){for(const Hb of Ca)this.sendMessage(Hb,ob)}sendMessage(Ca,ob){this.gug.sendMessage(Ca,ob)}$0j(Ca,ob,Hb){const rc=new Date,td=+rc-+Ca.Xeh;2E3<=td&&eb.a.J(39331167,375,1E4<=td?10:15,"[EditorPaneActor] Host was slow to respond to the message receivedInstanceId={0} receivedIsFromEditorPane={1} receivedTimestamp={2} currentTime={3} passedMilliseconds={4} receivedId={5} receivedType={6} responseId={7} responseType={8}",Ca.instanceId,Ca.rie,Ca.Xeh.toUTCString(),rc.getTime(),td.toString(),ob.id,ob.type,
Hb.id,Hb.type)}rna(Ca,ob){ob.property===nd.a.isSlideCritiqueReady&&this.gNe(1)}sB(){this.gNe(0)}M0(Ca,ob){(Ca=this.ua.Ba)&&ob.slideId.equals(Ca.Cb)&&this.gNe(2)}XIa(Ca,ob){this.sBb.Kwl(ob.instanceId);this.JL.visualizeCritiques([])}}Object(k.a)(Rj,"EditorPaneActor",null,[]);class Ia{constructor(){this.va=new ce.a}g$h(Ca){this.va.addHandler("PaneClosed",Ca)}JJk(Ca){this.va.raiseEvent("PaneClosed",Ca)}}Object(k.a)(Ia,"EditorPaneEventSource",null,[850,902,903]);var nb=d(4);class Kb{}Object(k.a)(Kb,"Paragraph",
null,[]);var dc=d(211);class Ic{constructor(Ca,ob,Hb,rc,td,sc,Tc,Dc,xc){this.ua=Ca;this.FC=ob;this.JVa=Hb;this.ia=rc;this.Ea=td;this.Dak=sc;this.Vpe=Tc;this.Hh=Dc;this.B8j=xc}checkProofingDirty(Ca){const ob=Ca.includedTags;if(2===Ca.critiqueSelection&&1===ob)return Ca=(Ca=this.ua.Ba)&&Ca.isConnected?!Ca.isSlideCritiqueReady:!0,this.Cua(0,!0),Ca;this.Rog("CheckProofingDirty");return!0}getCritiques(Ca){var ob=Ca.includedTags;if(2===Ca.critiqueSelection&&1===ob){Ca=this.ua.Ba;if(!Ca||!Ca.isConnected||
!Ca.isSlideCritiqueReady)return null;ob=Ca.YKa;Ca=[];for(let Hb of ob)if((ob=Hb)&&ob.isConnected){ob=this.FC.BF(ob,rc=>{rc=Object(H.a)(287,rc.Gh);return!!rc&&5===rc.proofingType&&!rc.wEa});for(const rc of ob)(ob=Object(H.a)(287,rc.Gh))&&Ca.push(ob.qN)}this.Cua(1,!0);return this.Vpe.qGf(Ca,Object(w.a)(this.Vpe,this.Vpe.ezi,"convertBox4Critique"))}this.Rog("GetCritiques");return null}D2f(Ca){var ob=this.ua.Ba;if(!ob||!ob.isConnected)return null;const Hb=[];Ca=Ic.Tik(Ca);ob=ob.Hia;for(const rc of Ca)(Ca=
Object(H.a)(Lc.a,ob.ye(kb.a.Hf(rc))))&&Ca.isConnected&&Hb.push(Object.assign(new Kb,{paragraphId:rc,text:this.Hh.OPe(Ca,"\n")}));return Hb}getSupportedLanguages(Ca){return this.Dak.F5i(Ca.includedTags).CWR(ob=>{const Hb=[];if(ob=Object(H.a)(nb.a,ob)){ob=ob.result;for(let rc of ob)(ob=ab.a.ue(rc))&&Array.add(Hb,ob.name)}this.Cua(6,!0);return Hb})}getLanguagesOnCurrentSlide(){const Ca=[],ob=[],Hb=this.ua.Ba;let rc=[];Hb&&(rc=Hb.Pk());for(const td of rc)this.Ea.DJ(td,sc=>{if(sc&&Object(ee.a)(Ra.AParagraphNode,
sc)){sc=Object(H.a)(Ra.AParagraphNode,sc);var Tc=sc.characterData;if(Tc&&Tc.length){var Dc=-1,xc;for(Tc=0;Tc<sc.Ra.length;Tc++)if(xc=sc.Ra.ga(Tc).formatting)xc=ec.a.language(xc),Dc===xc||Array.contains(Ca,xc)||(Array.add(Ca,xc),(Dc=ab.a.ue(xc))&&Array.add(ob,Dc.name)),Dc=xc}}});this.Cua(7,!0);return ob}visualizeCritiques(Ca){if(!Ca)return this.Cua(2,!1),1;const ob=Array(Ca.length);if(!Ca.length)return this.JVa.wVc(ob),this.Cua(2,!0),0;for(let Hb=0;Hb<Ca.length;Hb++)ob[Hb]=Ca[Hb].critiqueId;this.JVa.wVc(ob);
this.Cua(2,!0);return 0}resolveCritiques(Ca){if(!Ca||!Ca.length)return 1;const ob=new Nd.a(0);for(const Hb of Ca)ob.add(Hb.critiqueId,Hb.suggestionIndex);Ca=this.JVa.eAh(ob);this.Cua(3,Ca);return Ca?0:1}ignoreCritiques(Ca){if(!Ca||!Ca.length)return 1;const ob=[];for(const Hb of Ca)Array.add(ob,Hb.critiqueId);Ca=this.JVa.ignoreCritiques(ob,4);this.Cua(4,Ca);return Ca?0:1}openProofingSettingsDialog(){if(this.B8j){const Ca=this.ia.processAction(Lf.a.OGb,2);this.Cua(5,32===Ca)}}Cua(Ca,ob){eb.a.J(37266337,
375,50,"{0}: {1}",Ca,ob?0:1)}Rog(Ca){eb.a.J(36750081,375,15,"{0}: Unsupported CritiqueFilter",Ca)}static Tik(Ca){const ob=new dc.a;for(var Hb of Ca)ob.contains(Hb.paragraphId)||ob.add(Hb.paragraphId);Ca=Array(ob.count);Hb=0;for(let rc of ob)Ca[Hb++]=rc;return Ca}}Object(k.a)(Ic,"EditorPaneHost",null,[846]);class Id{}Object(k.a)(Id,"EditorRuntimeNotificationData",null,[]);class ae extends Sys.EventArgs{constructor(){super();this.q2b=this.nka=null}}Object(k.a)(ae,"EditorRuntimeNotificationEventArgs",
Sys.EventArgs,[]);class Od{constructor(){this.notificationConfidence=0;this.shouldRaiseNotification=!1;this.confidence=0;this.resultStatus=null}}Object(k.a)(Od,"InfraredResultBase",null,[]);var Hd=d(333),Bf=d(521);class Of{constructor(Ca,ob){this.includedTags=this.critiqueSelection=0;this.critiqueSelection=Ca;this.includedTags=ob}static KH(Ca){return Object(ee.a)(Number,Ca.critiqueSelection)&&Object(ee.a)(Number,Ca.includedTags)?new Of(Ca.critiqueSelection,Ca.includedTags):null}}Object(k.a)(Of,"CritiqueFilter",
null,[]);class ph{constructor(Ca,ob,Hb,rc){this.ia=Ca;this.JL=ob;this.ua=Hb;this.hug=rc}fNe(Ca){if(this.hug){var ob=new Of(2,1),Hb=this.JL.checkProofingDirty(ob),rc=Hb?[]:this.JL.getCritiques(ob),td=Hb?[]:this.JL.D2f(rc);ob=this.lEe();Ca=Object.assign(new Id,{isProofingDirty:Hb,critiques:rc,paragraphs:td,numberOfCoAuthors:ob,contextChanged:0===Ca});td=(rc=!!rc&&0<rc.length)?1:0;let sc=Hd.a.success;0<ob?sc=Hd.a.GIa:Hb?sc=Hd.a.pending:rc||(sc=Hd.a.GIa);Hb=Object.assign(new ae,{nka:Object.assign(new Od,
{notificationConfidence:td,shouldRaiseNotification:!1,confidence:1,resultStatus:sc}),q2b:Ca});this.hug.fNe(Hb)}}lEe(){var Ca=this.ua.Ba;if(!Ca||!Ca.isConnected)return 0;Ca=Object.assign(new Bf.a,{slideId:Ca.Cb});this.ia.La(od.a.AZa,2,Ca);return Ca.Rqc}}Object(k.a)(ph,"EditorRuntimeEventRaiser",null,[845]);var Qh=d(536),Lg=d(695);class Fg{constructor(Ca){this.C7j=Ca}Z3k(){this.x_a(0,0)}sessionEnd(){this.x_a(1,0)}wml(){this.x_a(2,4)}yml(){this.x_a(2,3)}x_a(Ca,ob){this.C7j.execute(Hb=>{const rc=Object.assign(new Lg.a,
{cardId:Qh.a.FOf,actionType:Ca,actionEngagement:ob});Hb.Ncd(rc)})}}Object(k.a)(Fg,"InfraredTelemetryLogger",null,[848]);class dg extends Bg{constructor(Ca,ob,Hb){super(Ca,ob);this.payload=null;this.payload=Hb}}Object(k.a)(dg,"MessageWithPayload",Bg,[]);class hi extends dg{constructor(Ca,ob,Hb){super(Ca,ob,Hb)}}Object(k.a)(hi,"CheckProofingDirtyAndGetCritiquesResponse",dg,[]);class Mg extends dg{constructor(Ca,ob,Hb){super(Ca,ob,Hb)}}Object(k.a)(Mg,"ResponseMessage",dg,[]);class ne{constructor(Ca){this.statusCode=
0;this.logErrorMessage=null;this.statusCode=Ca;this.logErrorMessage="";0!==Ca&&(this.logErrorMessage=Ca.toString())}}Object(k.a)(ne,"Response",null,[]);class Bh extends ne{constructor(Ca,ob,Hb,rc){super(0);this.isProofingDirty=!1;this.languagesOnTheCurrentSlide=this.paragraphs=this.critiques=null;this.isProofingDirty=Ca;this.critiques=ob;this.paragraphs=Hb;this.languagesOnTheCurrentSlide=rc}}Object(k.a)(Bh,"ProofingDirtyAndCritiques",ne,[]);class Vh{constructor(Ca,ob,Hb){this.ua=Ca;this.JL=ob;this.a0=
Hb}process(Ca,ob){var Hb=this.a0.lIi(Ca.message);if(!Hb)return eb.a.J(37025993,375,15,"[CheckProofingDirtyAndGetCritiquesProcessor] Can't decode message."),Ca=new ne(1),Kd.Task.Nt(new Mg(1003,ob.id,Ca));Ca=this.ua.Ba;if(!Ca||!Ca.isConnected)return eb.a.J(37025995,375,50,"[CheckProofingDirtyAndGetCritiquesProcessor] Active slide doesn't exist or is not connected"),Ca=new Bh(!1,[],[],[]),ob=new hi(1003,ob.id,Ca),Kd.Task.Nt(ob);Hb=(Ca=this.JL.checkProofingDirty(Hb.payload))?[]:this.JL.getCritiques(Hb.payload);
if(!Hb)return eb.a.J(38418246,375,15,"[CheckProofingDirtyAndGetCritiquesProcessor] No box4 critiques were returned by host"),Ca=new ne(2),Kd.Task.Nt(new Mg(1003,ob.id,Ca));const rc=Ca?[]:this.JL.D2f(Hb),td=Ca?[]:this.JL.getLanguagesOnCurrentSlide();if(!td)return eb.a.J(38418248,375,15,"[CheckProofingDirtyAndGetCritiquesProcessor] Failed to query languages on current slide"),Ca=new ne(7),Kd.Task.Nt(new Mg(1003,ob.id,Ca));Ca=new Bh(Ca,Hb,rc,td);ob=new hi(1003,ob.id,Ca);return Kd.Task.Nt(ob)}}Object(k.a)(Vh,
"CheckProofingDirtyAndGetCritiquesProcessor",null,[898]);class ij{constructor(Ca,ob,Hb){this.JL=Ca;this.a0=ob;this.WBb=Hb}process(Ca,ob){var Hb=this.a0.nIi(Ca.message);if(!Hb)return eb.a.J(37087328,375,15,"[IgnoreProcessor] Can't decode message."),Ca=new ne(1),Kd.Task.Nt(new Mg(1006,ob.id,Ca));Hb=this.JL.ignoreCritiques(Hb.payload);0===Hb&&Ca.rie&&this.WBb.yml();Ca=0===Hb?new ne(0):new ne(6);return Kd.Task.Nt(new Mg(1006,ob.id,Ca))}}Object(k.a)(ij,"IgnoreProcessor",null,[898]);class Ij extends dg{constructor(Ca,
ob,Hb){super(Ca,ob,Hb)}}Object(k.a)(Ij,"NumberOfCoAuthorsResponse",dg,[]);class Yj extends ne{constructor(Ca){super(0);this.numberOfCoAuthors=0;this.numberOfCoAuthors=Ca}}Object(k.a)(Yj,"NumberOfCoAuthorsModel",ne,[]);class ii{constructor(Ca,ob){this.ia=Ca;this.ua=ob}process(Ca,ob){Ca=this.lEe();Ca=new Yj(Ca);return Kd.Task.Nt(new Ij(1009,ob.id,Ca))}lEe(){var Ca=this.ua.Ba;if(!Ca||!Ca.isConnected)return 0;Ca=Object.assign(new Bf.a,{slideId:Ca.Cb});this.ia.La(od.a.AZa,2,Ca);return Ca.Rqc}}Object(k.a)(ii,
"NumberOfCoAuthorsProcessor",null,[898]);class Wh{constructor(Ca,ob,Hb){this.ia=Ca;this.$_=ob;this.due=Hb}process(Ca,ob){if(!this.due)return eb.a.J(38412446,375,15,"[OpenIdeasPaneAndCloseEditorPaneProcessor] Ideas disabled, but we were asked to open Ideas pane"),Ca=new ne(10),Kd.Task.Nt(new Mg(1011,ob.id,Ca));this.$_.QK(3);Ca=this.ia.processAction(od.a.EWe,2);32!==Ca&&eb.a.J(38412448,375,15,"[OpenIdeasPaneAndCloseEditorPaneProcessor] Failed to open Ideas pane");Ca=new ne(32!==Ca?9:0);return Kd.Task.Nt(new Mg(1011,
ob.id,Ca))}}Object(k.a)(Wh,"OpenIdeasPaneAndCloseEditorPaneProcessor",null,[898]);class Zj{constructor(Ca){this.JL=Ca}process(Ca,ob){this.JL.openProofingSettingsDialog();Ca=new ne(0);return Kd.Task.Nt(new Mg(1007,ob.id,Ca))}}Object(k.a)(Zj,"OpenProofingSettingsProcessor",null,[898]);class Hi{constructor(Ca,ob,Hb){this.JL=Ca;this.a0=ob;this.WBb=Hb}process(Ca,ob){var Hb=this.a0.oIi(Ca.message);if(!Hb)return eb.a.J(37087330,375,15,"[ResolveProcessor] Can't decode message."),Ca=new ne(1),Kd.Task.Nt(new Mg(1005,
ob.id,Ca));Hb=this.JL.resolveCritiques(Hb.payload);0===Hb&&Ca.rie&&this.WBb.wml();Ca=0===Hb?new ne(0):new ne(5);return Kd.Task.Nt(new Mg(1005,ob.id,Ca))}}Object(k.a)(Hi,"ResolveProcessor",null,[898]);class $i extends dg{constructor(Ca,ob,Hb){super(Ca,ob,Hb)}}Object(k.a)($i,"SubscriptionResponse",dg,[]);class Ai extends ne{constructor(Ca){super(0);this.telemetryCorrelationId=null;this.telemetryCorrelationId=Ca}}Object(k.a)(Ai,"SubscriptionModel",ne,[]);class si{constructor(Ca,ob){this.sBb=Ca;this.a0=
ob}process(Ca,ob){const Hb=this.a0.pIi(Ca.message);if(!Hb)return eb.a.J(39331169,375,15,"[SubscribeProcessor] Can't decode message."),Ca=new ne(1),Kd.Task.Nt(new Mg(1001,ob.id,Ca));eb.a.J(39331171,375,50,"Editor pane telemetry correlation id={0}",Hb.payload.telemetryCorrelationId);this.sBb.subscribe(Ca.instanceId,0);this.sBb.subscribe(Ca.instanceId,1);this.sBb.subscribe(Ca.instanceId,2);Ca=new Ai("not available");return Kd.Task.Nt(new $i(1001,ob.id,Ca))}}Object(k.a)(si,"SubscribeProcessor",null,[898]);
class Ni extends dg{constructor(Ca,ob,Hb){super(Ca,ob,Hb)}}Object(k.a)(Ni,"SupportedLanguagesResponse",dg,[]);class ak extends ne{constructor(Ca){super(0);this.supportedLanguages=null;this.supportedLanguages=Ca}}Object(k.a)(ak,"SupportedLanguagesModel",ne,[]);class Sj{constructor(Ca,ob){this.JL=Ca;this.a0=ob}process(Ca,ob){Ca=this.a0.qIi(Ca.message);if(!Ca)return eb.a.J(38094432,375,15,"[SupportedLanguagesProcessor] Can't decode message."),Ca=new ne(1),Kd.Task.Nt(new Mg(1010,ob.id,Ca));const Hb=this.JL.getSupportedLanguages(Ca.payload);
return Hb.CWR(()=>{var rc=Hb.result;if(!rc)return eb.a.J(38094434,375,15,"[SupportedLanguagesProcessor] Failed to query supported languages"),rc=new ne(8),new Mg(1010,ob.id,rc);rc=new ak(rc);return new Ni(1010,ob.id,rc)})}}Object(k.a)(Sj,"SupportedLanguagesProcessor",null,[898]);class ti{process(Ca,ob){eb.a.J(37025999,375,15,"[UnsupportedMessageProcessor] Unsupported message type: {0}",ob.type);Ca=new ne(3);return Kd.Task.Nt(new Mg(ob.type,ob.id,Ca))}}Object(k.a)(ti,"UnsupportedMessageProcessor",
null,[898]);class Ii{constructor(Ca,ob){this.JL=Ca;this.a0=ob}process(Ca,ob){Ca=this.a0.rIi(Ca.message);if(!Ca)return eb.a.J(37026001,375,15,"[VisualizeProcessor] Can't decode message."),Ca=new ne(1),Kd.Task.Nt(new Mg(1004,ob.id,Ca));Ca=0===this.JL.visualizeCritiques(Ca.payload)?new ne(0):new ne(4);return Kd.Task.Nt(new Mg(1004,ob.id,Ca))}}Object(k.a)(Ii,"VisualizeProcessor",null,[898]);class bg extends dg{constructor(Ca,ob,Hb){super(Ca,ob,Hb)}static KH(Ca){const ob=Bg.ilb(Ca);return ob&&Ca.payload?
(Ca=Of.KH(Ca.payload))?new bg(ob.type,ob.id,Ca):null:null}}Object(k.a)(bg,"CheckProofingDirtyAndGetCritiquesMessage",dg,[]);class xa{constructor(Ca){this.AQb=Ca}get critiqueId(){return this.AQb}static KH(Ca){return Ca.critiqueId&&Object(H.a)(String,Ca.critiqueId)?new xa(Ca.critiqueId.toString()):null}}Object(k.a)(xa,"CritiqueIgnore",null,[]);class Ma extends dg{constructor(Ca,ob,Hb){super(Ca,ob,Hb)}static KH(Ca){const ob=Bg.ilb(Ca);if(!ob||!Ca.payload||!Object(ee.a)(Array,Ca.payload))return null;
Ca=Ca.payload;const Hb=Array(Ca.length);for(let rc=0;rc<Ca.length;rc++){const td=xa.KH(Ca[rc]);if(!Hb)return null;Hb[rc]=td}return new Ma(ob.type,ob.id,Hb)}}Object(k.a)(Ma,"IgnoreCritiquesMessage",dg,[]);class $a{constructor(Ca,ob){this.AQb=Ca;this.n0h=ob}get critiqueId(){return this.AQb}get suggestionIndex(){return this.n0h}static KH(Ca){return Ca.critiqueId&&Object(H.a)(String,Ca.critiqueId)&&Object(ee.a)(Number,Ca.suggestionIndex)?new $a(Ca.critiqueId.toString(),Ca.suggestionIndex):null}}Object(k.a)($a,
"CritiqueResolution",null,[]);class Eb extends dg{constructor(Ca,ob,Hb){super(Ca,ob,Hb)}static KH(Ca){const ob=Bg.ilb(Ca);if(!ob||!Ca.payload||!Object(ee.a)(Array,Ca.payload))return null;Ca=Ca.payload;const Hb=Array(Ca.length);for(let rc=0;rc<Ca.length;rc++){const td=$a.KH(Ca[rc]);if(!Hb)return null;Hb[rc]=td}return new Eb(ob.type,ob.id,Hb)}}Object(k.a)(Eb,"ResolveCritiquesMessage",dg,[]);class ac{constructor(Ca){this.telemetryCorrelationId=null;this.telemetryCorrelationId=Ca}static KH(Ca){let ob=
"unavailable";Ca.telemetryCorrelationId&&Object(H.a)(String,Ca.telemetryCorrelationId)&&Ca.telemetryCorrelationId.toString().length&&50>=Ca.telemetryCorrelationId.toString().length&&(ob=Ca.telemetryCorrelationId.toString());return new ac(ob)}}Object(k.a)(ac,"Subscription",null,[]);class tc extends dg{constructor(Ca,ob,Hb){super(Ca,ob,Hb)}static KH(Ca){const ob=Bg.ilb(Ca);if(!ob)return null;Ca.payload||(Ca.payload={});return(Ca=ac.KH(Ca.payload))?new tc(ob.type,ob.id,Ca):null}}Object(k.a)(tc,"SubscribeMessage",
dg,[]);class aa extends dg{constructor(Ca,ob,Hb){super(Ca,ob,Hb)}static KH(Ca){const ob=Bg.ilb(Ca);return ob&&Ca.payload?(Ca=Of.KH(Ca.payload))?new aa(ob.type,ob.id,Ca):null:null}}Object(k.a)(aa,"SupportedLanguagesMessage",dg,[]);class sa{constructor(Ca){this.AQb=Ca}get critiqueId(){return this.AQb}static KH(Ca){return Ca.critiqueId&&Object(H.a)(String,Ca.critiqueId)&&Ca.critiqueId.toString().length?new sa(Ca.critiqueId.toString()):null}}Object(k.a)(sa,"CritiqueToVisualize",null,[]);class Oa extends dg{constructor(Ca,
ob,Hb){super(Ca,ob,Hb)}static KH(Ca){const ob=Bg.ilb(Ca);if(!ob||!Ca.payload||!Object(ee.a)(Array,Ca.payload))return null;Ca=Ca.payload;const Hb=Array(Ca.length);for(let rc=0;rc<Ca.length;rc++){const td=sa.KH(Ca[rc]);if(!Hb)return null;Hb[rc]=td}return new Oa(ob.type,ob.id,Hb)}}Object(k.a)(Oa,"VisualizeCritiquesMessage",dg,[]);class ib{aKi(Ca){return this.hlb(Ca,Bg.ilb)}pIi(Ca){return this.hlb(Ca,tc.KH)}lIi(Ca){return this.hlb(Ca,bg.KH)}rIi(Ca){return this.hlb(Ca,Oa.KH)}oIi(Ca){return this.hlb(Ca,
Eb.KH)}nIi(Ca){return this.hlb(Ca,Ma.KH)}qIi(Ca){return this.hlb(Ca,aa.KH)}hlb(Ca,ob){try{let Hb;return({kv:Hb}=A.d(Ca)).returnValue?ob(Hb):null}catch(Hb){return null}}rPf(Ca){return A.c(Ca)}}Object(k.a)(ib,"MessageEncoder",null,[854]);var Gb=d(78);class Bb extends Sys.EventArgs{constructor(Ca,ob,Hb){super();this.instanceId=Ca;this.message=ob;this.rie=Hb;this.Xeh=new Date}}Object(k.a)(Bb,"MessageReceivedEventArgs",Sys.EventArgs,[]);class Cc{constructor(Ca,ob,Hb){this.va=new ce.a;this.rDb=Ca;this.Spg=
ob;this.q7j=new RegExp(Hb,"i")}initialize(){try{if(window.addEventListener)return window.addEventListener("message",Object(w.a)(this,this.gic,"messageReceivedHandler"),!1),!0;if(-1<window.navigator.userAgent.indexOf("MSIE")&&window.attachEvent)return window.attachEvent("onmessage",Object(w.a)(this,this.gic,"messageReceivedHandler")),!0;eb.a.J(37026003,375,10,"[EditorPane.Messaging.Messenger] Failed to subscribe to onmessage event of window")}catch(Ca){eb.a.J(37026005,375,10,"[EditorPane.Messaging.Messenger] Failed to subscribe to onmessage event of window with exception, message: {0}, stack: {1}",
Ca.message,Ca.stack)}return!1}XNd(Ca){this.va.addHandler("MessageReceived",Ca)}Ehh(Ca){this.va.removeHandler("MessageReceived",Ca)}sendMessage(Ca,ob){if(Ca&&ob){var Hb={};Hb.message=ob;Hb.editorPaneWildCard=".";this.V2k(Ca,Hb)}}V2k(Ca,ob){OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(Ca,"onCustomMessage",ob,Hb=>{Hb&&eb.a.J(37026007,375,15,"Couldn't deliver the message to Editor pane, status: {0}.",Hb)})}gic(Ca){const ob=Ca.origin;if(this.y9b(ob)){var Hb;({kv:Hb}=A.d(Ca.data)).returnValue&&
Hb&&"."===Hb.editorPaneWildCard&&Hb.message&&this.va.raiseEvent("MessageReceived",new Bb(this.rDb.m9a(),Hb.message,ob===this.Spg))}}y9b(Ca){const ob=Gb.a.pQ(window.location.href);return!!Ca&&0<Ca.length&&"null"!==Ca&&(Ca===this.Spg||Ca===ob||this.q7j.test(Ca))}}Object(k.a)(Cc,"Messenger",null,[853]);class cc{constructor(Ca,ob){this.Zc=Ca;this.assetId=ob.nah}m9a(){if(!this.Zc.instance)return eb.a.J(37025987,375,15,"[EditorPaneManager] App for office manager not present"),null;const Ca=this.Zc.instance.mQ(this.assetId);
return Ca?Ca.instanceId?Ca.instanceId:(eb.a.J(37025991,375,15,"[EditorPaneManager] App for office doesn't have instance id"),null):(eb.a.J(37025989,375,200,"[EditorPaneManager] App for office not found"),null)}getAssetId(){return this.assetId}}Object(k.a)(cc,"PaneIdsProvider",null,[851]);class Qd{constructor(){this.Es=new Nd.a}subscribe(Ca,ob){Ca&&(this.Es.Hb(ob)||this.Es.add(ob,[]),Array.contains(this.Es.ga(ob),Ca)||this.Es.ga(ob).push(Ca))}unsubscribe(Ca,ob){Ca&&this.Es.Hb(ob)&&(Ca=Array.indexOf(this.Es.ga(ob),
Ca),-1!==Ca&&Array.removeAt(this.Es.ga(ob),Ca))}Kwl(Ca){Ca&&(this.unsubscribe(Ca,0),this.unsubscribe(Ca,1),this.unsubscribe(Ca,2))}Djj(Ca){return this.Es.Hb(Ca)?this.Es.ga(Ca):[]}}Object(k.a)(Qd,"EditorPaneSubscriptionsManager",null,[852]);class re{constructor(){this.K=null}get name(){return"PowerPointWebEditor.EditorPane"}$b(Ca){Ca&&(this.K=Ca,this.K.register(jg,"PowerPointWebEditor.Proofing.CritiquesHighlightActor").ma().oa(()=>new jg(this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptEditorConsistencyCheckIsEnabled)),this.K.register(844,"PowerPointWebEditor.Proofing.IConsistencyCheckActor").ma().oa(()=>new Ed(this.K.resolve("Box4.Highlight.IHighlightManager"),this.K.resolve("PowerPointWebEditor.Proofing.CritiquesHighlightActor"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("Box4.Proofing.IErrorRangeEditor"),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("Box4.ICharacterPropertiesEditor"),
this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.Proofing.IConsistencyCheckManager"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptFocusDocumentAfterActionOnEditorPaneIsEnabled)),this.K.register(Rj,"PowerPointWebEditor.EditorPane.EditorPaneActor").ma().oa(()=>new Rj(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPane"),this.K.resolve("PowerPointWebEditor.EditorPane.Subscription.IEditorPaneSubscriptionsManager"),
this.K.resolve("PowerPointWebEditor.EditorPane.Messaging.IMessenger"),this.K.resolve("PowerPointWebEditor.EditorPane.Messaging.IMessageEncoder"),this.LDi(),this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPaneHost"),this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPaneEventSource"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerpointPresence.IPresenceEventHandlers"),this.K.resolve("Box4.Graph.IGraphInstance").Ad(8),this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),
this.K.resolve("PowerPointWebEditor.EditorPane.IEditorRuntimeEventRaiser"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),this.K.resolve("PowerPointWebEditor.IFunctionThrottlerFactory"),this.K.resolve("PowerPointWebEditor.IPresentationReader"))),re.gKj&&this.K.register(Ud,"PowerPointWebEditor.EditorPane.DexLitePaneActor").ma().oa(()=>new Ud(this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),this.K.resolve("Common.IActionManagerExtended"),
this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("PowerPointWebEditor.View.IDexLitePane"),this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPaneHost"),this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),this.K.Ja("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),
this.K.resolve("PowerPointWebEditor.IPPTWorkspace"),this.K.resolve("Common.IDynamicScriptLoaderProvider").Pw,this.K.resolve("PowerPointWebEditor.Proofing.ICloudALResponseTransformer"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"))),this.K.register(845,"PowerPointWebEditor.EditorPane.IEditorRuntimeEventRaiser").ma().oa(()=>new ph(this.K.resolve("Common.IActionManager"),this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPaneHost"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
this.K.resolve("PowerPointWebEditor.Editor.Common.Model.IEditorRuntimeEventSource"))),this.K.register(qe,"PowerPointWebEditor.Editor.Common.Model.EditorRuntimeEventSource").as("PowerPointWebEditor.Editor.Common.Model.IEditorRuntimeEventSource").as("PowerPointWebEditor.Editor.Common.Model.IEditorRuntimeEventNotifier").as("PowerPointWebEditor.Editor.Common.Model.IEditorRuntimeEventHandler").ma().oa(()=>new qe),this.K.register(846,"PowerPointWebEditor.EditorPane.IEditorPaneHost").ma().oa(()=>new Ic(this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
this.K.resolve("Box4.Proofing.IErrorRangeEditor"),this.K.resolve("PowerPointWebEditor.Proofing.IConsistencyCheckActor"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("Box4.Proofing.IProofingLanguageInfoManager"),this.K.resolve("PowerPointWebEditor.EditorPane.IDataContractMapper"),this.K.resolve("Box4.IParagraphReader"),this.K.resolve("Common.IAppSettingsManager").ka("299"))),this.K.register(847,"PowerPointWebEditor.EditorPane.IDataContractMapper").ma().oa(()=>
new Hk),this.K.register(848,"PowerPointWebEditor.EditorPane.IInfraredTelemetryLogger").ma().oa(()=>new Fg(this.K.Ja("PowerPointWebEditor.IInfraredTelemetryListener"))),this.K.register(849,"PowerPointWebEditor.EditorPane.IEditorPane").ma().oa(()=>new yh(this.K.resolve("Common.IActionManagerExtended"),this.K.Ja("PowerPointWebEditor.IAppForOfficeManager"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPaneEventSource"),this.K.resolve("PowerPointWebEditor.EditorPane.IPaneIdsProvider"),
this.K.resolve("PowerPointWebEditor.EditorPane.IInfraredTelemetryLogger"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointIdeasIsEnabled,!0)),this.K.register(850,"PowerPointWebEditor.EditorPane.IEditorPaneEventSource").ma().oa(()=>new Ia),this.K.register(851,"PowerPointWebEditor.EditorPane.IPaneIdsProvider").ma().oa(()=>new cc(this.K.Ja("PowerPointWebEditor.IAppForOfficeManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"))),this.K.register(852,"PowerPointWebEditor.EditorPane.Subscription.IEditorPaneSubscriptionsManager").ma().oa(()=>
new Qd),this.K.register(853,"PowerPointWebEditor.EditorPane.Messaging.IMessenger").ma().oa(()=>new Cc(this.K.resolve("PowerPointWebEditor.EditorPane.IPaneIdsProvider"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").uCk,this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointIdeasApprovedOriginPattern)),this.K.register(854,"PowerPointWebEditor.EditorPane.Messaging.IMessageEncoder").ma().oa(()=>new ib),this.K.register(ti,"PowerPointWebEditor.EditorPane.MessageProcessing.UnsupportedMessageProcessor").ma().oa(()=>
new ti),this.K.register(si,"PowerPointWebEditor.EditorPane.MessageProcessing.SubscribeProcessor").ma().oa(()=>new si(this.K.resolve("PowerPointWebEditor.EditorPane.Subscription.IEditorPaneSubscriptionsManager"),this.K.resolve("PowerPointWebEditor.EditorPane.Messaging.IMessageEncoder"))),this.K.register(Hi,"PowerPointWebEditor.EditorPane.MessageProcessing.ResolveProcessor").ma().oa(()=>new Hi(this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPaneHost"),this.K.resolve("PowerPointWebEditor.EditorPane.Messaging.IMessageEncoder"),
this.K.resolve("PowerPointWebEditor.EditorPane.IInfraredTelemetryLogger"))),this.K.register(ij,"PowerPointWebEditor.EditorPane.MessageProcessing.IgnoreProcessor").ma().oa(()=>new ij(this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPaneHost"),this.K.resolve("PowerPointWebEditor.EditorPane.Messaging.IMessageEncoder"),this.K.resolve("PowerPointWebEditor.EditorPane.IInfraredTelemetryLogger"))),this.K.register(Zj,"PowerPointWebEditor.EditorPane.MessageProcessing.OpenProofingSettingsProcessor").ma().oa(()=>
new Zj(this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPaneHost"))),this.K.register(Vh,"PowerPointWebEditor.EditorPane.MessageProcessing.CheckProofingDirtyAndGetCritiquesProcessor").ma().oa(()=>new Vh(this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPaneHost"),this.K.resolve("PowerPointWebEditor.EditorPane.Messaging.IMessageEncoder"))),this.K.register(Ii,"PowerPointWebEditor.EditorPane.MessageProcessing.VisualizeProcessor").ma().oa(()=>
new Ii(this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPaneHost"),this.K.resolve("PowerPointWebEditor.EditorPane.Messaging.IMessageEncoder"))),this.K.register(ii,"PowerPointWebEditor.EditorPane.MessageProcessing.NumberOfCoAuthorsProcessor").ma().oa(()=>new ii(this.K.resolve("Common.IActionManager"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"))),this.K.register(Sj,"PowerPointWebEditor.EditorPane.MessageProcessing.SupportedLanguagesProcessor").ma().oa(()=>new Sj(this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPaneHost"),
this.K.resolve("PowerPointWebEditor.EditorPane.Messaging.IMessageEncoder"))),this.K.register(Wh,"PowerPointWebEditor.EditorPane.MessageProcessing.OpenIdeasPaneAndCloseEditorPaneProcessor").ma().oa(()=>new Wh(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPane"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointIdeasIsEnabled)))}init(){this.K&&this.K.resolve("Common.IAppSettingsManager").jf(()=>{var Ca=this.K.resolve("PowerPointWebEditor.IApplicationSettings");
re.Ocl(Ca)&&this.K.resolve("PowerPointWebEditor.EditorPane.Messaging.IMessenger").initialize()&&(Ca=this.K.resolve("PowerPointWebEditor.EditorPane.EditorPaneActor"),Ca.vb(),Ca.De(),Ca=this.K.resolve("PowerPointWebEditor.EditorPane.DexLitePaneActor"),Ca.vb(),Ca.De())})}dispose(){}LDi(){const Ca=new Nd.a;Ca.$(0,this.K.resolve("PowerPointWebEditor.EditorPane.MessageProcessing.UnsupportedMessageProcessor"));Ca.$(1,this.K.resolve("PowerPointWebEditor.EditorPane.MessageProcessing.SubscribeProcessor"));
Ca.$(3,this.K.resolve("PowerPointWebEditor.EditorPane.MessageProcessing.CheckProofingDirtyAndGetCritiquesProcessor"));Ca.$(4,this.K.resolve("PowerPointWebEditor.EditorPane.MessageProcessing.VisualizeProcessor"));Ca.$(5,this.K.resolve("PowerPointWebEditor.EditorPane.MessageProcessing.ResolveProcessor"));Ca.$(6,this.K.resolve("PowerPointWebEditor.EditorPane.MessageProcessing.IgnoreProcessor"));Ca.$(7,this.K.resolve("PowerPointWebEditor.EditorPane.MessageProcessing.OpenProofingSettingsProcessor"));Ca.$(9,
this.K.resolve("PowerPointWebEditor.EditorPane.MessageProcessing.NumberOfCoAuthorsProcessor"));Ca.$(10,this.K.resolve("PowerPointWebEditor.EditorPane.MessageProcessing.SupportedLanguagesProcessor"));Ca.$(11,this.K.resolve("PowerPointWebEditor.EditorPane.MessageProcessing.OpenIdeasPaneAndCloseEditorPaneProcessor"));return Ca}static main(){v.a.instance.Dc(new re)}static Ocl(Ca){return Ca.pptEditorConsistencyCheckIsEnabled&&re.LHj(Ca.nah)}static gKj(Ca){return Ca.YLf}static LHj(Ca){return!!Ca&&0<Ca.length}}
Object(k.a)(re,"PptWebEditorEditorPanePackage",null,[2,3]);Type.registerNamespace("PowerPointWebEditor");Type.registerNamespace("PowerPointWebEditor.AugmentationLoop");Type.registerNamespace("PowerPointWebEditor.ContentUpdateDetection");Type.registerNamespace("PowerPointWebEditor.EditorPane");Type.registerNamespace("PowerPointWebEditor.EditorPane.MessageProcessing");Type.registerNamespace("PowerPointWebEditor.EditorPane.Messaging");Type.registerNamespace("PowerPointWebEditor.EditorPane.Model");Type.registerNamespace("PowerPointWebEditor.EditorPane.Subscription");
Type.registerNamespace("PowerPointWebEditor.Proofing");Type.registerNamespace("PowerPointWebEditor.TextPrediction");rb.main();pd.main();je.main();re.main()},678:function(K,Z,d){d.d(Z,"a",function(){return v});K=d(0);var k=d(17),e=d(95),n=d(27),r=d(48);d(96);class v{constructor(){this.r_=null}get wxb(){return!1}qCh(C,w){let z=new k.a;const A=new r.GraphTransaction(3);try{A.kd(n.App.Kb.Jd.Cn.yg),this.D$b(w)&&(z=this.n8b(w,z)),w!==C&&this.D$b(C)&&(z=this.n8b(C,z))}finally{A&&A.dispose()}return z.toArray()}D$b(C){return!!C}Tjd(C){let w=
!1;for(const z of this.mbe)w||!Sys.UI.DomElement.containsCssClass(C,z.className)&&!Sys.UI.DomElement.containsCssClass(C,z.u6b)||(w=!0),e.a.XJa(C,z.className),e.a.XJa(C,z.u6b)}}Object(K.a)(v,"AHighlightActor",null,[934])},679:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k{constructor(e,n){this.className=e;this.u6b=n}}Object(K.a)(k,"HighlightCssClassPair",null,[])},680:function(K,Z,d){d.d(Z,"b",function(){return r});d.d(Z,"a",function(){return v});var k=d(95);d(27);var e=d(48);d(31);
d(92);var n=d(96);const r=C=>{const w=new e.GraphTransaction(3);try{w.kd(C),C.wv(32,!0)}finally{w&&w.dispose()}},v=C=>{if(C){C=k.a.Ija(C);if(-1===C.indexOf(n.a.R7)&&-1!==C.indexOf(n.a.hN)&&-1===C.indexOf(n.a.Z0b))return 2;if(-1===C.indexOf(n.a.R7)&&(-1!==C.indexOf(n.a.Y0b)||-1!==C.indexOf(n.a.vN)||-1!==C.indexOf(n.a.Z0b)||-1!==C.indexOf(n.a.GJc)||-1!==C.indexOf(n.a.tLc)||-1!==C.indexOf(n.a.rLc)||-1!==C.indexOf(n.a.qLc)||-1!==C.indexOf(n.a.EXd)||-1!==C.indexOf(n.a.zXd)||-1!==C.indexOf(n.a.BXd)||-1!==
C.indexOf(n.a.sLc)||-1!==C.indexOf(n.a.yXd)))return 1;if(-1!==C.indexOf("WACImageContainer"))return 3}return 0}},681:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k{constructor(){this.type=this.action=0;this.rhb=this.jda=null}}Object(K.a)(k,"HighlightOperation",null,[])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/18430998/wdjs/ppteditDS.augloop.js.map