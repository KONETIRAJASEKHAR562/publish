'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[12],{1229:function(K,Z,d){d.r(Z);var k=d(0),e=d(1185),n=d(1241),r=d(25),v=d(68),C=d(17);class w{constructor(bb){bb.Ja("Common.App.SearchCommon.SearchHostRuntime").execute(()=>{})}}Object(k.a)(w,"DocumentContentExtractionManager",null,[951]);var z=d(382),A=d(13),u=d(1047);class E{}E.mjl="mso_smartLookup";E.channelId="SmartLookup";E.ljl="https://uciserviceintcdnwus.blob.core.windows.net/mirrored/smartlookup/";E.Ewh=
"https://uci.edog.cdn.office.net/mirrored/smartlookup/";E.Fwh="https://uci.cdn.office.net/mirrored/smartlookup/";E.kjl="https://hedwigtestserver.blob.core.windows.net/builds/";E.jjl="http://localhost:8080/";E.Vqc="current";E.Dwh="next";E.Bwk=2;E.Nfd=CommonUIStrings.L_SmartLookupPaneTitle;E.UY="InsightsTaskPane";E.width=400;E.uAh="appCorrelationId";E.vAh="message";Object(k.a)(E,"InsightsConstants",null,[]);var H=d(929),I=d(170);class J{}Object(k.a)(J,"ActivityContractInfo",null,[]);class T{}Object(k.a)(T,
"BrowserPaneDataField",null,[]);class D{}Object(k.a)(D,"BrowserPaneTelemetryEvent",null,[]);var R=d(141),Q=d(55),W=d(179),O=d(192);class Y{static Qu(bb,Vb){const Ub=new D;Ub.eventName="Diagnostics";Ub.isActivity=!1;Ub.activityContract=Object.assign(new J,{success:!0});const Jc=[],Mc=new T;Mc.name="Message";Mc.dataType=0;Mc.value=bb;bb=new T;bb.name="Level";bb.dataType=0;bb.value=Y.laj(Vb);Array.add(Jc,Mc);Array.add(Jc,bb);Ub.dataFields=Jc;Y.sendTelemetryEvent(Ub)}static Kmd(bb,Vb){const Ub=new D;
Ub.eventName=bb;Ub.isActivity=!1;Ub.activityContract=Object.assign(new J,{success:!0});bb=[];const Jc=new T;Jc.name="AppCorrelationId";Jc.dataType=0;Jc.value=Vb;Array.add(bb,Jc);Ub.dataFields=bb;Y.sendTelemetryEvent(Ub)}static U2k(bb,Vb,Ub,Jc,Mc,ed){const dd=new D;dd.eventName="LaunchPaneWithError";dd.isActivity=!1;dd.activityContract=Object.assign(new J,{success:!0});const je=[],Nd=new T;Nd.name="IsNetworkConnected";Nd.dataType=0;Nd.value=bb?"true":"false";bb=new T;bb.name="IsHostruntimeAvailable";
bb.dataType=0;bb.value=Vb?"true":"false";Vb=new T;Vb.name="EntryPoint";Vb.dataType=0;Vb.value=Ub;Ub=new T;Ub.name="RuntimeVersion";Ub.dataType=0;Ub.value=Jc;Jc=new T;Jc.name="IsFirstRelease";Jc.dataType=1;Jc.value=Mc?"true":"false";Mc=new T;Mc.name="IsZeroTerm";Mc.dataType=1;Mc.value=ed?"true":"false";ed=new T;ed.name="IsClientSideRendering";ed.dataType=1;ed.value="false";Array.add(je,Nd);Array.add(je,Vb);Array.add(je,bb);Array.add(je,Ub);Array.add(je,Jc);Array.add(je,Mc);Array.add(je,ed);dd.dataFields=
je;Y.sendTelemetryEvent(dd)}static ySe(bb,Vb,Ub){const Jc=new D;Jc.eventName="CDNDownloadLatency";Jc.isActivity=!0;Jc.activityContract=Object.assign(new J,{duration:Ub,success:!0});Ub=[];const Mc=new T;Mc.name="CDNHostname";Mc.dataType=0;Mc.value=bb;bb=new T;bb.name="Filename";bb.dataType=0;bb.value=Vb;Array.add(Ub,Mc);Array.add(Ub,bb);Jc.dataFields=Ub;Y.sendTelemetryEvent(Jc,1)}static Zoc(bb,Vb,Ub,Jc,Mc,ed,dd,je){const Nd=new D;Nd.eventName="LaunchPane";Nd.isActivity=!0;Nd.activityContract=Object.assign(new J,
{duration:Vb,success:!0});Vb=[];const Ld=new T;Ld.name="AppCorrelationId";Ld.dataType=0;Ld.value=bb;bb=new T;bb.name="EntryPoint";bb.dataType=0;bb.value=Ub;Ub=new T;Ub.name="IsServerSideRendering";Ub.dataType=1;Ub.value="true";const Xe=new T;Xe.name="UxVersion";Xe.dataType=0;Xe.value=Jc;Jc=new T;Jc.name="FeatureGates";Jc.dataType=0;Jc.value=Mc;Mc=new T;Mc.name="IsFirstRelease";Mc.dataType=1;Mc.value=ed?"true":"false";ed=new T;ed.name="IsZeroTerm";ed.dataType=1;ed.value=dd?"true":"false";dd=new T;
dd.name="IsClientSideRendering";dd.dataType=1;dd.value=je?"true":"false";Array.add(Vb,Ld);Array.add(Vb,bb);Array.add(Vb,Ub);Array.add(Vb,Xe);Array.add(Vb,Jc);Array.add(Vb,Mc);Array.add(Vb,ed);Array.add(Vb,dd);Nd.dataFields=Vb;Y.sendTelemetryEvent(Nd)}static sendTelemetryEvent(bb,Vb=2){if(bb.isFeedbackActivity)Y.y0j(bb.eventName);else{var Ub=-1<bb.eventName.indexOf(Y.tAh)?bb.eventName:Y.tAh+bb.eventName,Jc=Y.h6i(bb.dataFields);bb.isActivity?(bb=Object.assign(new W.a,{name:Ub,samplingPolicy:Vb,dataFields:Jc,
succeeded:bb.activityContract.success,durationMs:bb.activityContract.duration}),R.a.sendActivityEvent(bb)):(bb=Object.assign(new O.a,{name:Ub,samplingPolicy:Vb,dataFields:Jc}),R.a.sendTelemetryEvent(bb))}}static laj(bb){switch(bb){case 10:return"Error";case 15:return"Warning";default:return"Info"}}static h6i(bb){const Vb=[];if(bb&&0<bb.length)for(const Ub of bb)(bb=I.a.t8(Ub.name,Ub.value,Y.Nzi(Ub.dataType)))&&Array.add(Vb,bb);return Vb}static Nzi(bb){switch(bb){case 0:return 2;case 1:return 1;case 2:return 3;
case 3:return 4;default:return 0}}static y0j(bb){const Vb=Q.a.instance.rb("Common.ISystemInitiatedFeedback");Vb?Vb.logActivity(bb,null):z.ULS.sendTraceTag(540624772,1303,15,"Failed to resolve ISystemInitiatedFeedback.")}}Y.tAh="Office.Insights.SmartLookup.";Object(k.a)(Y,"TelemetryUtils",null,[]);var S;(function(bb){bb[bb.other=0]="other";bb[bb.searchBoxSearch=1]="searchBoxSearch";bb[bb.searchBoxDictionary=2]="searchBoxDictionary";bb[bb.searchBoxQuickAnswer=3]="searchBoxQuickAnswer";bb[bb.smartLookupRibbon=
4]="smartLookupRibbon";bb[bb.smartLookupContextMenu=5]="smartLookupContextMenu";bb[bb.entity=6]="entity";bb[bb.dictionary=7]="dictionary";bb[bb.web=8]="web";bb[bb.pictures=9]="pictures";bb[bb.files=10]="files";bb[bb.bookmarks=11]="bookmarks";bb[bb.help=12]="help";bb[bb.chartRecommendation=13]="chartRecommendation";bb[bb.linkSkill=14]="linkSkill";bb[bb.searchBoxFindInDocument=15]="searchBoxFindInDocument";bb[bb.searchBoxEntity=16]="searchBoxEntity";bb[bb.searchSkill=17]="searchSkill";bb[bb.controlF=
18]="controlF";bb[bb.ribbonFindButton=19]="ribbonFindButton";bb[bb.reuseSlides=20]="reuseSlides";bb[bb.data=21]="data";bb[bb.contextMenuDictionary=22]="contextMenuDictionary";bb[bb.contextMenuSearchSuggestion=23]="contextMenuSearchSuggestion";bb[bb.contextMenuSynonyms=24]="contextMenuSynonyms";bb[bb.contextMenuSearchBoxSearch=25]="contextMenuSearchBoxSearch";bb[bb.searchBoxSearchZeroTerm=26]="searchBoxSearchZeroTerm";bb[bb.contextMenuSearchZeroTerm=27]="contextMenuSearchZeroTerm";bb[bb.note=28]="note";
bb[bb.smartLookupAutoLaunch=29]="smartLookupAutoLaunch";bb[bb.contextMenuSmartLookupInSubMenu=30]="contextMenuSmartLookupInSubMenu";bb[bb.dataDisambiguate=31]="dataDisambiguate";bb[bb.linkFiles=32]="linkFiles";bb[bb.searchBoxNoteL2=33]="searchBoxNoteL2";bb[bb.contextMenuLaunchL2Document=34]="contextMenuLaunchL2Document";bb[bb.actionAI=35]="actionAI";bb[bb.pasteAsNewSlide=36]="pasteAsNewSlide";bb[bb.slidesCompression=37]="slidesCompression";bb[bb.prefetch=99]="prefetch"})(S||(S={}));Object(k.b)("EntryPoint",
S);var da=d(377),fa=d(445),ka=d(196),ha=d(33),F=d(104);class na{static CQ(bb,Vb,Ub,Jc,Mc,ed){if(1===Ub)return ka.SessionStatusManager.instance.C_?32:8;if(Mc.value.oel())return Y.Qu("Skipping Serplet launch",10),32;Vb=ed;if(!Vb)return 8;bb=na.S8a();if(Ub=Vb.CommandValueId)try{Vb=ha.a(Ub)}catch(dd){return z.ULS.sendTraceTag(594044173,1313,15,"SmartLookup application interface [{0}] is not in proper format",Ub),8}Ub=Vb;Vb.selection||(Vb.neighborhood?Ub=Object.assign(new da.a,{selection:Vb}):(Vb=Mc.value.l9a(),
Ub.selection=Object.assign(new fa.a,{neighborhood:Vb.neighborhood,mentionStart:Vb.mentionStart,mentionLength:Vb.mentionLength})));Ub.selection.clientDetectedLanguage=null;return na.Kub(ed,null,Ub,bb,0,Mc)}static Kub(bb,Vb,Ub,Jc,Mc,ed){const dd={};dd.controlId=bb?bb.SourceControlId:"shortcut";Ub&&(dd.entryPoint=S[Ub.entryPoint]);z.ULS.sendTraceTag(594044172,1303,50,na.Dja("Show insights",Jc,dd));Vb?ed.value.qgl(Vb,Jc,Mc):Ub&&(r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableCopilotAddin",
!1)?ed.value.Tel(Ub,Jc):ed.value.rgl(Ub,Jc,Mc));return 32}static Dja(bb,Vb,Ub=null){bb={["appCorrelationId"]:Vb,["message"]:bb};if(Ub)for(let Jc in Ub)bb[Jc]=Ub[Jc];return ha.c(bb)}static S8a(){return F.a.create().toString()}}Object(k.a)(na,"InvokingPaneUtils",null,[]);class ba{}Object(k.a)(ba,"LaunchDataInDoc",null,[]);class Ea{}Object(k.a)(Ea,"LaunchDataPasteAsSlide",null,[]);class La{}Object(k.a)(La,"LaunchDataSlidesCompression",null,[]);var ta=d(387),oa=d(119),wa=d(70),ra=d(329),ya=d(79),Da=d(63),
pa=d(71),la=d(527),Fa=d(35);class Qa{constructor(bb,Vb,Ub,Jc,Mc,ed,dd,je,Nd){this.XQb=this.nyc=this.io=null;this.Iy=bb;this.Ca=Vb||r.AFrameworkApplication.Ta;this.oK=Ub;this.Od=Jc;this.Ndf=je;this.fOa=Mc;this.$a=ed;this.Wd=dd;this.TCj();this.fha=new e.a(()=>new ta.a(Nd.value,Object(A.a)(this,this.TDa,"getMoreInfoEventReceived")))}vb(){this.Ca.ya(Fa.a.vFj,pa.a.frame,Object(A.a)(this,this.ogl,"showInsights"));this.Ca.ya(Fa.a.wFj,pa.a.frame,Object(A.a)(this,this.pgl,"showInsightsForTellMe"));this.Ca.ya(Fa.a.definitions,
pa.a.frame,Object(A.a)(this,this.wfl,"showDefinitions"));this.Ca.ya(Fa.a.gJi,pa.a.frame,Object(A.a)(this,this.xfl,"showDefinitionsForTellMe"));this.Ca.ya(Fa.a.JWe,pa.a.frame,Object(A.a)(this,this.JWe,"showInsightsForSuggestion"));this.Ndf&&(this.Ca.ya(Fa.a.Ldg,pa.a.frame,Object(A.a)(this,this.CQ,"invokeSmartLookupPane")),this.Ca.ya(Fa.a.Ege,pa.a.frame,Object(A.a)(this,this.Ege,"invokeInDocSerplet")),this.Ca.ya(Fa.a.pXc,pa.a.frame,Object(A.a)(this,this.pXc,"invokeSerpletRibbon")),this.Ca.ya(Fa.a.oXc,
pa.a.frame,Object(A.a)(this,this.oXc,"invokeSerpletContextMenu")),this.Ca.ya(Fa.a.Kge,pa.a.frame,Object(A.a)(this,this.Kge,"invokeSerpletTellMeZeroTerm")),this.Ca.ya(Fa.a.Jge,pa.a.frame,Object(A.a)(this,this.Jge,"invokeSerpletTellMeNotes")),this.Ca.ya(Fa.a.Dge,pa.a.frame,Object(A.a)(this,this.Dge,"invokeImageSerpletContextMenu")),this.Ca.ya(Fa.a.rXc,pa.a.frame,Object(A.a)(this,this.rXc,"invokeSynonymsSerpletContextMenu")),this.Ca.ya(Fa.a.Bge,pa.a.frame,Object(A.a)(this,this.Bge,"invokeDictionarySerpletContextMenu")),
this.Ca.ya(Fa.a.Lge,pa.a.frame,Object(A.a)(this,this.Lge,"invokeZeroTermSerpletContextMenu")),this.Ca.ya(Fa.a.zge,pa.a.frame,Object(A.a)(this,this.zge,"invokeDefinitionSearchFromFloatie")),this.Ca.ya(Fa.a.nXc,pa.a.frame,Object(A.a)(this,this.nXc,"invokeSerpletBrowseFiles")),this.Ca.ya(Fa.a.Fge,pa.a.frame,Object(A.a)(this,this.Fge,"invokeInDocSerpletWithLaunchData")),this.Ca.ya(Fa.a.VMe,pa.a.frame,Object(A.a)(this,this.VMe,"queryToggleSerplet")),this.Ca.ya(Fa.a.GTe,pa.a.frame,Object(A.a)(this,this.GTe,
"setInDocSearchParameter")),this.Ca.ya(Fa.a.qXc,pa.a.frame,Object(A.a)(this,this.qXc,"invokeSerpletSlidesCompression")),this.Ca.ya(Fa.a.Ige,pa.a.frame,Object(A.a)(this,this.Ige,"invokeSerpletPasteAsNewSlide")),r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletAutolaunch",!1)&&(this.Ca.ya(Fa.a.CGj,pa.a.frame,Object(A.a)(this,this.EGj,"invokeSmartLookupPaneConversations")),this.Ca.ya(Fa.a.yge,pa.a.frame,Object(A.a)(this,this.yge,"invokeAutoLaunchSearchRequest"))),
this.gPk().continueWith(()=>{r.AFrameworkApplication.Aa&&r.AFrameworkApplication.Aa.updateCommandUI(!0)}))}vqf(){this.Ca.ra(Fa.a.eyb,pa.a.frame,Object(A.a)(this,this.eyb,"invokeFilesSerplet"),4);this.Ca.ra(Fa.a.Fdg,pa.a.frame,Object(A.a)(this,this.eyb,"invokeFilesSerplet"),4);this.Ca.ra(Fa.a.Hdg,pa.a.frame,Object(A.a)(this,this.tGj,"invokeLinkFilesSerplet"),4);if(this.$a.ka("IsTellMeUpSellEnterpriseEnabled")&&this.$a.ka("SmartLookupTokenPrefetchIsEnabled")){const bb=ya.a.aLc(0,Object(A.a)(this,this.Mah,
"prefetchToken"),0,177);this.Wd.Eb(bb)}}KNd(){wa.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.AddEmptyFilesActionWhenUnavailable")&&(this.Ca.ya(Fa.a.eyb,pa.a.frame,Object(A.a)(this,this.Cge,"invokeFilesSerpletUnavailable")),this.Ca.ya(Fa.a.Fdg,pa.a.frame,Object(A.a)(this,this.Cge,"invokeFilesSerpletUnavailable")),this.Ca.ya(Fa.a.Hdg,pa.a.frame,Object(A.a)(this,this.Cge,"invokeFilesSerpletUnavailable")))}Mah(bb){z.ULS.sendTraceTag(579352786,1303,50,"SmartLookupFiles: Token prefetch initiated, interval={0}, IsRetry={1}",
bb.interval,!!bb.data);this.bOb().then(Vb=>{let Ub=1;if(Vb)z.ULS.sendTraceTag(579352787,1303,50,"SmartLookupFiles: Token prefetch succeeded"),this.JSe("SmartLookupFiles: Token prefetch succeeded",!0),Vb=6E4*this.$a.Fc("SmartLookupTokenRenewalWaitDurationInMinutes",30);else{z.ULS.sendTraceTag(579352788,1303,50,"SmartLookupFiles: Token prefetch failed");this.JSe("SmartLookupFiles: Token prefetch failed",!1);Ub=parseInt(bb.data||"1");if(Ub>this.$a.Fc("SmartLookupTokenRenewalRetryThreshold",5)){z.ULS.sendTraceTag(577345097,
1303,10,"SmartLookupFiles: Token prefetch max retry count reached");this.JSe("SmartLookupFiles: Token prefetch max retry count reached",!1);return}Vb=6E4*this.$a.Fc("SmartLookupTokenRetryWaitDurationInMinutes",10);Ub++}Vb=new ya.a(3,1,Vb,Object(A.a)(this,this.Mah,"prefetchToken"),177);Vb.data=Ub.toString();this.Wd.Eb(Vb)})}JSe(bb="",Vb=!1){this.fOa.execute(Ub=>{Ub&&Ub.w_a("PrefetchToken",Vb,0,"SmartLookup",bb)})}bOb(){return this.fOa?new Promise(bb=>{this.fOa.execute(Vb=>{if(Vb){var Ub=Date.now();
Vb.getToken("SmartLookup",this.$a.Ha("SmartLookupShredderServiceEndpoint")).then(Jc=>{bb(!!Jc&&0<Jc.length);Vb.w_a("TryGetTokenInternal",!!Jc&&0<Jc.length,Date.now()-Ub,"SmartLookup")})}else bb(!1)})}):Promise.resolve(!1)}gPk(){const bb=new u.a;if(this.$a.ka("BrowserSupportsInsightsPaneSSO"))this.vqf(),bb.Fg(!0);else{if(!this.fOa)return z.ULS.sendTraceTag(587534883,1303,10,"_oAuthManagerFuture not initialized"),bb.Fg(!1),this.KNd(),bb.task;this.fOa.execute(Vb=>{Vb?Vb.getToken("SmartLookup",this.$a.Ha("SmartLookupShredderServiceEndpoint")).then(Ub=>
{z.ULS.sendTraceTag(587534913,1303,15,"Token:{0}",!!Ub&&0<Ub.length);Ub&&0<Ub.length?(this.vqf(),bb.Fg(!0)):this.KNd()}):(z.ULS.sendTraceTag(587534912,1303,10,"Unable to resolve oAuthManager"),bb.Fg(!1),this.KNd())})}return bb.task}ogl(bb,Vb,Ub,Jc,Mc){if(1===Ub)return r.AFrameworkApplication.Aa&&r.AFrameworkApplication.fa.ka("OneNoteDelayLoadContextActivationManager")&&!r.AFrameworkApplication.b0b?8:this.Iy.value.ihg()?32:8;bb=na.S8a();Vb=this.Iy.value.l9a();return this.Ndf?(Vb=Object.assign(new fa.a,
{neighborhood:Vb.neighborhood,mentionStart:Vb.mentionStart,mentionLength:Vb.mentionLength}),Vb=Object.assign(new da.a,{selection:Vb,userIntent:null,entryPoint:0,launchData:Object.assign(new ra.a,{landingTab:"All"})}),na.Kub(Mc,null,Vb,bb,0,this.Iy)):na.Kub(Mc,Vb,null,bb,0,this.Iy)}wfl(bb,Vb,Ub,Jc,Mc){if(1===Ub)return this.Iy.value.ihg()?32:8;bb=na.S8a();Vb=this.Iy.value.l9a();return na.Kub(Mc,Vb,null,bb,1,this.Iy)}pgl(bb,Vb,Ub,Jc,Mc){return 1===Ub?32:this.yRf(Mc,0)}xfl(bb,Vb,Ub,Jc,Mc){return 1===
Ub?32:this.yRf(Mc,1)}yRf(bb,Vb){const Ub=na.S8a(),Jc=bb.CommandValueId;let Mc;try{Mc=ha.a(Jc)}catch(ed){return z.ULS.sendTraceTag(6295941,1303,15,na.Dja(String.format("Insights parameters [{0}] is not in proper format.",Jc),Ub)),8}return na.Kub(bb,Mc,null,Ub,Vb,this.Iy)}JWe(bb,Vb,Ub,Jc,Mc){if(1===Ub)return 32;if(!Mc)return 8;bb=Mc.query?Mc.query:"";Vb=na.S8a();Ub=new H.a;Ub.neighborhood=bb;Ub.mentionStart=0;Ub.mentionLength=bb.length;return na.Kub(Mc,Ub,null,Vb,0,this.Iy)}tGj(bb,Vb,Ub,Jc){if(1===
Ub)return ka.SessionStatusManager.instance.C_?32:8;const Mc=r.AFrameworkApplication.fa.ka("InsertFileLinkSerpletIsEnabled"),ed=this.Iy.value.ASa();return this.CQ(bb,Vb,Ub,Jc,Object.assign(new da.a,{selection:Object.assign(new fa.a,{neighborhood:ed.neighborhood,mentionStart:0,mentionLength:0}),launchData:Object.assign(new ra.a,{landingTab:"File"}),entryPoint:Mc?32:10}))}eyb(bb,Vb,Ub,Jc){if(1===Ub)return ka.SessionStatusManager.instance.C_?32:8;const Mc=r.AFrameworkApplication.fa.ka("InvokeReuseSlidesSerpletIsEnabled"),
ed=this.Iy.value.ASa();return this.CQ(bb,Vb,Ub,Jc,Object.assign(new da.a,{selection:Object.assign(new fa.a,{neighborhood:ed.neighborhood,mentionStart:0,mentionLength:0}),launchData:Object.assign(new ra.a,{landingTab:Mc?"Slide":"File"}),entryPoint:Mc?20:10}))}Cge(){return 2}Ege(bb,Vb,Ub,Jc,Mc){if(1===Ub)return ka.SessionStatusManager.instance.eka?8:32;const ed=this.Iy.value.ASa();Mc=void 0===Mc||null===Mc?18:19;return this.CQ(bb,Vb,Ub,Jc,Object.assign(new da.a,{selection:Object.assign(new fa.a,{neighborhood:ed.neighborhood,
mentionStart:ed.mentionStart,mentionLength:ed.mentionLength}),launchData:Object.assign(new ra.a,{landingTab:"Indoc"}),entryPoint:Mc}))}Fge(bb,Vb,Ub,Jc,Mc){Mc=Mc.CommandValueId;if(!Mc||Mc&&this.XQb&&Mc.query===this.XQb.query&&Mc.matchCase===this.XQb.matchCase&&Mc.matchWholeWordOnly===this.XQb.matchWholeWordOnly)return 32;const ed=this.Iy.value.ASa();return this.CQ(bb,Vb,Ub,Jc,Object.assign(new da.a,{selection:Object.assign(new fa.a,{neighborhood:ed.neighborhood,mentionStart:ed.mentionStart,mentionLength:ed.mentionLength}),
launchData:Object.assign(new ra.a,{landingTab:"Indoc",data:Object.assign(new ba,{type:4,query:Mc.query,matchCase:Mc.matchCase,matchWholeWord:Mc.matchWholeWordOnly})}),entryPoint:18}))}VMe(bb,Vb,Ub,Jc,Mc){Mc&&(Mc[la.a.On]=this.Iy.value.D9b);return 32}GTe(bb,Vb,Ub,Jc,Mc){if(bb=Mc.CommandValueId)this.XQb=bb;return 32}EGj(bb,Vb,Ub){if(1===Ub)return ka.SessionStatusManager.instance.C_?32:8;bb=this.Iy.value.ASa();bb=Object.assign(new da.a,{selection:Object.assign(new fa.a,{neighborhood:bb.neighborhood,
mentionStart:bb.mentionStart,mentionLength:0}),entryPoint:29,launchData:Object.assign(new ra.a,{landingTab:"All"})});this.Iy.value.cme(bb);return 32}yge(bb,Vb,Ub){if(1===Ub)return ka.SessionStatusManager.instance.C_?32:8;bb=this.Iy.value.ASa();bb=Object.assign(new da.a,{selection:Object.assign(new fa.a,{neighborhood:bb.neighborhood,mentionStart:bb.mentionStart,mentionLength:0}),entryPoint:29,launchData:Object.assign(new ra.a,{landingTab:"All",data:r.AFrameworkApplication.eRa})});Vb=na.S8a();this.Iy.value.Mmd(bb,
Vb);return 32}pXc(bb,Vb,Ub,Jc){if(1===Ub)return ka.SessionStatusManager.instance.C_?32:8;const Mc=this.Iy.value.t$i();return this.CQ(bb,Vb,Ub,Jc,Object.assign(new da.a,{selection:Object.assign(new fa.a,{neighborhood:Mc.neighborhood,mentionStart:Mc.mentionStart,mentionLength:Mc.mentionLength}),entryPoint:4,launchData:Object.assign(new ra.a,{landingTab:"All"})}))}oXc(bb,Vb,Ub,Jc){return this.CQ(bb,Vb,Ub,Jc,Object.assign(new da.a,{entryPoint:5,launchData:Object.assign(new ra.a,{landingTab:"All"})}))}Kge(bb,
Vb,Ub,Jc){if(1===Ub)return ka.SessionStatusManager.instance.C_?32:8;const Mc=this.Iy.value.ASa();return this.CQ(bb,Vb,Ub,Jc,Object.assign(new da.a,{selection:Object.assign(new fa.a,{neighborhood:Mc.neighborhood,mentionStart:Mc.mentionStart,mentionLength:0}),launchData:Object.assign(new ra.a,{landingTab:"All"}),entryPoint:26}))}Bge(bb,Vb,Ub,Jc){return 1===Ub?(bb=this.Iy.value.l9a())&&0<bb.mentionLength?32:8:this.CQ(bb,Vb,Ub,Jc,Object.assign(new da.a,{entryPoint:22,launchData:Object.assign(new ra.a,
{landingTab:"All"})}))}zge(bb,Vb,Ub,Jc){return 1===Ub?(bb=this.Iy.value.l9a())&&0<bb.mentionLength?32:8:this.CQ(bb,Vb,Ub,Jc,Object.assign(new da.a,{entryPoint:7,launchData:Object.assign(new ra.a,{landingTab:"All"})}))}Dge(bb,Vb,Ub,Jc){return this.CQ(bb,Vb,Ub,Jc,Object.assign(new da.a,{launchData:Object.assign(new ra.a,{landingTab:"Image"}),entryPoint:9}))}rXc(bb,Vb,Ub,Jc){return this.CQ(bb,Vb,Ub,Jc,Object.assign(new da.a,{launchData:Object.assign(new ra.a,{landingTab:"All"}),entryPoint:24}))}Jge(bb,
Vb,Ub,Jc){return this.CQ(bb,Vb,Ub,Jc,Object.assign(new da.a,{launchData:Object.assign(new ra.a,{landingTab:"Notes"}),entryPoint:33}))}Lge(bb,Vb,Ub,Jc){if(1===Ub)return ka.SessionStatusManager.instance.C_?32:8;const Mc=this.Iy.value.ASa();return this.CQ(bb,Vb,Ub,Jc,Object.assign(new da.a,{selection:Object.assign(new fa.a,{neighborhood:Mc.neighborhood,mentionStart:Mc.mentionStart,mentionLength:0}),launchData:Object.assign(new ra.a,{landingTab:"All"}),entryPoint:27}))}qXc(bb,Vb,Ub,Jc,Mc){if(!Mc)return 8;
const ed=Mc.url;Mc=Mc.selectedSlideIDs;return this.CQ(bb,Vb,Ub,Jc,Object.assign(new da.a,{launchData:Object.assign(new ra.a,{landingTab:"All",data:Object.assign(new La,{type:6,url:ed,selectedSlideIDs:Mc})}),entryPoint:37}))}Ige(bb,Vb,Ub,Jc,Mc){if(!Mc)return 8;const ed=Mc.Selection;Mc=Mc.CurrentDocTitle;return this.CQ(bb,Vb,Ub,Jc,Object.assign(new da.a,{launchData:Object.assign(new ra.a,{landingTab:"All",data:Object.assign(new Ea,{type:5,selection:ed,currentDocTitle:Mc})}),entryPoint:36}))}CQ(bb,Vb,
Ub,Jc,Mc){return na.CQ(bb,Vb,Ub,Jc,this.Iy,Mc)}nXc(bb,Vb,Ub){if(1===Ub)return 32;this.io||this.fha.value.Yca("Browse File from Search pane",!0);if(!this.nyc||""===this.nyc)return z.ULS.sendTraceTag(558409934,1303,10,"InsightsActor: Failed to get host url to browse files."),8;Da.a.un(this.nyc,"_blank",void 0,"BrowseFilesFromSearchPane");return 32}TDa(bb){this.io||3!==bb.state||(this.io=bb,this.nyc=this.io.vR)}TCj(){const bb=this.Od.Gc(E.UY);bb.parent=oa.AFrame.nj;bb.Wba(Object(A.a)(this,this.DSe,"sendIFrameTakeFocusMessage"));
this.oK.Yqa(E.UY)}DSe(){document.activeElement.blur();r.AFrameworkApplication.Aa&&r.AFrameworkApplication.Aa.hb.bX||(this.Iy.value.uTe(),this.Iy.value.S2k())}dispose(){this.Iy.value&&this.Iy.value.dispose()}}Object(k.a)(Qa,"InsightsActor",null,[106]);var Sa=d(1186),Na=d(684),ua=d(54),za=d(268),Wa=d(45);const yb=bb=>{bb=bb.split("-");return bb[bb.length-1]},Za=bb=>18===bb||19===bb||15===bb,ub=()=>{var bb=kb();if(bb)return Promise.resolve(bb);bb=uc().replace("SearchWeb","searchweb");bb=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupCDNNextIsEnabled",
!1)?bb+E.Dwh+"/":bb+E.Vqc+"/";bb+="version.json";if(ua.a.hx)return Ib(bb);try{const Vb=new Sys.Net.WebRequest;Vb.set_httpVerb("GET");Vb.set_url(bb);bb={};bb.method=Vb.get_httpVerb();return"function"!==typeof window.fetch?(Y.Qu("InsightsUtils - Failed to download version.json because fetch API is unavailable.",10),Promise.resolve("")):window.fetch(Vb.getResolvedUrl(),bb).then(Ub=>Ub.json()).catch(()=>{Y.Qu("InsightsUtils - Failed to prefetch version.json of HttpException.",10);return""}).then(Ub=>
{Ub=ha.b(JSON.stringify(Ub));return Ub.version?Ub.version:""},Ub=>{Y.Qu("InsightsUtils - Failed to deserialize version: "+Ub.toString(),10);z.ULS.sendTraceTag(591971029,1303,15,"Insights: Failed to deserialize version: "+Ub.toString());return""}).then(Ub=>Ub)}catch(Vb){return Y.Qu("InsightsUtils - Failed to download version.json: "+Vb.toString(),10),z.ULS.sendTraceTag(591984149,1303,50,"Insights: Call to Version JSON failed + "+Vb.toString()),Promise.resolve("")}},Ib=bb=>{const Vb=r.AFrameworkApplication.Je;
return new Promise(Ub=>{const Jc=new Na.a(bb,1,null,null,!0,2,null);Vb.send(Jc).kJb(Mc=>{Mc&&Mc.data?Mc.data.Zd||(Y.Qu("InsightsUtils - Request for version.json with ClientRequestManager returned empty ResponseData. StatusCode: "+Mc.data.Te,10),Ub("")):(Y.Qu("InsightsUtils - Request for version.json with ClientRequestManager returned no Data.",10),Ub(""));try{const ed=ha.b(Mc.data.Zd);ed.version&&Ub(ed.version)}catch(ed){Y.Qu("InsightsUtils - Failed to deserialize version: "+ed.toString(),10),Ub("")}},
Mc=>{Mc&&Mc.data?Y.Qu("InsightsUtils - Failed to prefetch version.json with ClientRequestManager. StatusCode: "+Mc.data.Te,10):Y.Qu("InsightsUtils - Failed to prefetch version.json with ClientRequestManager. Unknown HTTP Failure.",10);Ub("")})})},Ob=()=>r.AFrameworkApplication.fa.ka("SmartLookupEnableLocalOverride")||r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableLocalOverride",!1),Hc=()=>{const bb=uc();return Ob()||r.AFrameworkApplication.fa.Ha("SmartLookupPRClientVersion")?
bb+kb()+"/":r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupCDNNextIsEnabled",!1)?bb+E.Dwh:bb+E.Vqc},kb=()=>Ob()?"dev":r.AFrameworkApplication.fa.Ha("SmartLookupPRClientVersion")?r.AFrameworkApplication.fa.Ha("SmartLookupPRClientVersion").split("/")[1]:r.AFrameworkApplication.fa.Ha("SmartLookupClientVersion"),jb=bb=>{var Vb=3===r.AFrameworkApplication.Aa.hb.Vk?"wordwac":2===r.AFrameworkApplication.Aa.hb.Vk?"pptwac":"excelwac";var Ub=za.a.ue(r.AFrameworkApplication.lcid);
const Jc=Ub?Ub.name:"en-us";Ub=uc();const Mc=Ya();Vb="main_ssr_wac.html?appName="+Vb+"&culture="+Jc;return"LOCAL"===Mc?Ub+Vb:Ub+((""!==bb?bb:E.Vqc)+"/")+Vb},hb=bb=>uc()+(""!==bb?bb:E.Vqc)+"/scripts/microsoft.office.smartlookup.host.runtime.js",uc=()=>{switch(Ya()){case "LOCAL":return E.jjl;case "PR":const bb=r.AFrameworkApplication.fa.Ha("SmartLookupPRClientVersion").split("/");return E.kjl+bb[0]+"/";case "INT":return E.ljl;case "EDOG":return E.Ewh;default:return E.Fwh}},mc=()=>{if(!r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SerpletCDNLatencyActivityEnabled",
!1))return"";switch(Ya()){case "EDOG":return E.Ewh;case "PROD":return E.Fwh;default:return""}},Ya=()=>{if(r.AFrameworkApplication.fa.ka("SmartLookupEnableEdogSourceLocationOverride")||r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableEdogSourceLocationOverride",!1))return"EDOG";if(r.AFrameworkApplication.fa.ka("SmartLookupEnableProdSourceLocationOverride")||r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableProdSourceLocationOverride",
!1))return"PROD";if(r.AFrameworkApplication.fa.ka("SmartLookupEnableIntSourceLocationOverride")||r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableIntSourceLocationOverride",!1))return"INT";if(r.AFrameworkApplication.fa.Ha("SmartLookupPRClientVersion")&&r.AFrameworkApplication.fa.Ha("SmartLookupPRIntentSvc"))return"PR";if(Ob())return"LOCAL";switch(Object(Sa.a)(String,r.AFrameworkApplication.gd.AudienceGroup)||""){case "Dogfood":if(r.AFrameworkApplication.fa&&
r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSmartLookupSKITeamDogfood",!1)){let bb=r.AFrameworkApplication.fa.Ha("UserPrincipalName");bb=Wa.a.og(bb);const Vb=r.AFrameworkApplication.fa.aw("SmartLookupINTEnabledForSKITeam")?r.AFrameworkApplication.fa.RA("SmartLookupINTEnabledForSKITeam"):[];if(0<=Array.indexOf(Vb,bb))return"INT"}return"EDOG";case "Microsoft":return"EDOG";default:return"PROD"}},Mb=()=>{let bb;bb=r.AFrameworkApplication.fa.ka("IntentSvcEnableEdogSourceLocationOverride")||
r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IntentSvcEnableEdogSourceLocationOverride",!1)?"EDOG":r.AFrameworkApplication.fa.ka("IntentSvcEnableProdSourceLocationOverride")||r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IntentSvcEnableProdSourceLocationOverride",!1)?"PROD":r.AFrameworkApplication.fa.ka("IntentSvcEnableIntSourceLocationOverride")||r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IntentSvcEnableIntSourceLocationOverride",
!1)?"INT":Ya();const Vb=r.AFrameworkApplication.fa.Ha("IntentServiceEndpoint"),Ub=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IntentSvcNewEndpointEnabled",!1);if("PROD"===bb&&""!==Vb)return Vb+"searchendpointv2/";switch(bb){case "LOCAL":return"wss://127.0.0.1:9000/officeaugmentation/searchendpointv2/";case "PR":return r.AFrameworkApplication.fa.Ha("SmartLookupPRIntentSvc")+"searchendpointv2/";case "INT":return(Ub?"wss://entity.osi.office-int.net/officeaugmentation/":
"wss://augmentation.osi.office-int.net/officeaugmentation/")+"searchendpointv2/";case "EDOG":return(Ub?"wss://entity.osi.officeppe.net/officeaugmentation/":"wss://augmentation.osi.officeppe.net/officeaugmentation/")+"searchendpointv2/";default:return"wss://augmentation.osi.office.net/officeaugmentation/searchendpointv2/"}};class Kc{sendTelemetryEvent(bb){Y.sendTelemetryEvent(bb)}}Object(k.a)(Kc,"OtelTelemetrySink",null,[968]);class eb{}Object(k.a)(eb,"ApplicationProperties",null,[]);class Tb{constructor(){this.createdDate=
this.author=this.filePath=this.docName=null}}Object(k.a)(Tb,"CurrentDocumentProperties",null,[]);class lb{}Object(k.a)(lb,"EnterpriseUserInfo",null,[]);class Fb{}Object(k.a)(Fb,"FeatureGates",null,[]);var rb=d(78);class Qb{constructor(bb,Vb){this.gq=this.gh=null;this.Tzg=!0;this.p5a=Vb;this.oG=bb;this.oG.execute(Ub=>{Ub.isFeatureEnabled("mso_sendASmile",!0).then(Jc=>{this.Tzg=Jc}).catch(Jc=>{Y.Qu("SearchHelper - Failed to check if Feedback feature is enabled: "+Jc.toString(),15)})});bb=Mb();Vb=r.AFrameworkApplication.fa.ka("SmartLookupEnableInDocumentSearch")||
r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentSearch",!1);if(r.AFrameworkApplication.fa.ka("SmartLookupFeatureGateV2")){this.gq={};const Ub=this.mhj();if(Ub&&0<Ub.length)for(let Jc=0;Jc<Ub.length;Jc++){const Mc=Ub[Jc],ed=this.cij(Mc);switch(ed.toLowerCase()){case "true":this.gq[Mc]=!0;break;case "false":this.gq[Mc]=!1;break;default:this.gq[Mc]=ed}}this.gq.EnableInDocumentSearch=Vb;this.gq.EnableInDocumentSearchReplace=!0;this.gq.EnableInDocumentParamLocalSearch=
!0;this.gq.EnableInDocumentQuerySuggest=Vb&&r.AFrameworkApplication.fa.ka("SmartLookupEnableInDocumentQuerySuggest")||r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentQuerySuggest",!1);this.gq.EnableInDocumentQuestionGeneration=Vb&&r.AFrameworkApplication.fa.ka("SmartLookupEnableInDocumentQuestionGeneration")||r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentQuestionGeneration",!1);
this.gq.EnableInDocumentGlobalEncoder=Vb&&r.AFrameworkApplication.fa.ka("SmartLookupEnableInDocumentGlobalEncoder")||r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentGlobalEncoder",!1);this.gq.EnableInDocumentExperiment1=Vb&&r.AFrameworkApplication.fa.ka("SmartLookupEnableInDocumentExperiment1")||r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment1",!1);this.gq.EnableInDocumentExperiment2=
Vb&&r.AFrameworkApplication.fa.ka("SmartLookupEnableInDocumentExperiment2")||r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment2",!1);this.gq.EnableInDocumentExperiment3=Vb&&r.AFrameworkApplication.fa.ka("SmartLookupEnableInDocumentExperiment3")||r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment3",!1);this.gq.EnableZeroTermAutoRefresh=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableZeroTermAutoRefresh",
!1);this.gq.EnableTap3SZeroTerm=r.AFrameworkApplication.fa.ka("SmartLookupEnableTap3SZeroTerm")||r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableTap3SZeroTerm",!1);this.gq.EnableLocalSearch=!0;this.gq.EnableInDocumentStickyFilters=!0;this.gq.IntentServiceEndpoint=bb;this.gq.EnablePDFShredding=r.AFrameworkApplication.fa.ka("SmartLookupEnableSharepointPDFIsEnabled")||r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupSharepointPDFEnabled",
!1);this.gq.FilterNonPPTFilesForReuseSlides=r.AFrameworkApplication.fa.ka("SmartLookupFilterNonPPTFilesForReuseSlides");this.gq.UXBundleVersion=kb();this.gq.SmartLookupServicePath=Hc();this.gq.EnableAcronymSearch=!0;this.gq.UseAltAnswerEndpoint1=r.AFrameworkApplication.fa.ka("SmartLookupUseAltAnswerEndpoint1")||r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint1",!1);this.gq.UseAltAnswerEndpoint2=r.AFrameworkApplication.fa.ka("SmartLookupUseAltAnswerEndpoint2")||
r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint2",!1);this.gq.UseAltAnswerEndpoint3=r.AFrameworkApplication.fa.ka("SmartLookupUseAltAnswerEndpoint3")||r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint3",!1);this.gq.UseNextUXVersion=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupCDNNextIsEnabled",!1);this.gq.IgnoreNeighborhoodContext=
r.AFrameworkApplication.fa.ka("SmartLookupIgnoreNeighborhoodContextIsEnabled");this.gq.ShowDebugInfo="INT"===Ya();this.gq.DebugCommands=r.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.EnableSmartLookupDebugCommands","");this.gq.ChangeGates=r.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.SmartLookupChangeGateNames","");this.gq.QnaInMixSection=!0;this.gq.EnableNoteSearch=r.AFrameworkApplication.fa.ka("SmartLookupNoteSearchIsEnabled")||r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupNoteSearchIsEnabled",
!1);this.gq.EnableWikiL2=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupWikipediaL2Enabled",!1);this.gq.EnableFilteringOutRedundantKPE=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableFilteringOutRedundantKPE",!1);this.gq.EnableZeroTermEntitySuggestion=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableZeroTermEntitySuggestion",!1);this.gq.RankingModels=r.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.SmartLookupRankingModels",
"");this.gq.EnableClientSideRendering=!0}else this.gh=new Fb,this.gh.EnableInDocumentSearch=Vb,this.gh.EnableInDocumentSearchReplace=!0,this.gh.EnableInDocumentParamLocalSearch=!0,this.gh.EnableInDocumentQuerySuggest=Vb&&r.AFrameworkApplication.fa.ka("SmartLookupEnableInDocumentQuerySuggest")||r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentQuerySuggest",!1),this.gh.EnableInDocumentQuestionGeneration=Vb&&r.AFrameworkApplication.fa.ka("SmartLookupEnableInDocumentQuestionGeneration")||
r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentQuestionGeneration",!1),this.gh.EnableInDocumentGlobalEncoder=Vb&&r.AFrameworkApplication.fa.ka("SmartLookupEnableInDocumentGlobalEncoder")||r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentGlobalEncoder",!1),this.gh.EnableInDocumentExperiment1=Vb&&r.AFrameworkApplication.fa.ka("SmartLookupEnableInDocumentExperiment1")||r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment1",
!1),this.gh.EnableInDocumentExperiment2=Vb&&r.AFrameworkApplication.fa.ka("SmartLookupEnableInDocumentExperiment2")||r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment2",!1),this.gh.EnableInDocumentExperiment3=Vb&&r.AFrameworkApplication.fa.ka("SmartLookupEnableInDocumentExperiment3")||r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment3",!1),this.gh.EnableZeroTermAutoRefresh=
r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableZeroTermAutoRefresh",!1),this.gh.EnableTap3SZeroTerm=r.AFrameworkApplication.fa.ka("SmartLookupEnableTap3SZeroTerm")||r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableTap3SZeroTerm",!1),this.gh.EnableLocalSearch=!0,this.gh.EnableInDocumentStickyFilters=!0,this.gh.IntentServiceEndpoint=bb,this.gh.EnablePDFShredding=r.AFrameworkApplication.fa.ka("SmartLookupEnableSharepointPDFIsEnabled")||
r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupSharepointPDFEnabled",!1),this.gh.FilterNonPPTFilesForReuseSlides=r.AFrameworkApplication.fa.ka("SmartLookupFilterNonPPTFilesForReuseSlides"),this.gh.UXBundleVersion=kb(),this.gh.SmartLookupServicePath=Hc(),this.gh.EnableAcronymSearch=!0,this.gh.UseAltAnswerEndpoint1=r.AFrameworkApplication.fa.ka("SmartLookupUseAltAnswerEndpoint1")||r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint1",
!1),this.gh.UseAltAnswerEndpoint2=r.AFrameworkApplication.fa.ka("SmartLookupUseAltAnswerEndpoint2")||r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint2",!1),this.gh.UseAltAnswerEndpoint3=r.AFrameworkApplication.fa.ka("SmartLookupUseAltAnswerEndpoint3")||r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint3",!1),this.gh.UseNextUXVersion=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupCDNNextIsEnabled",
!1),this.gh.IgnoreNeighborhoodContext=r.AFrameworkApplication.fa.ka("SmartLookupIgnoreNeighborhoodContextIsEnabled"),this.gh.ShowDebugInfo="INT"===Ya(),this.gh.DebugCommands=r.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.EnableSmartLookupDebugCommands",""),this.gh.ChangeGates=r.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.SmartLookupChangeGateNames",""),this.gh.QnaInMixSection=!0,this.gh.EnableNoteSearch=r.AFrameworkApplication.fa.ka("SmartLookupNoteSearchIsEnabled")||
r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupNoteSearchIsEnabled",!1),this.gh.EnableWikiL2=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupWikipediaL2Enabled",!1),this.gh.EnableFilteringOutRedundantKPE=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableFilteringOutRedundantKPE",!1),this.gh.EnableZeroTermEntitySuggestion=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableZeroTermEntitySuggestion",
!1),this.gh.RankingModels=r.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.SmartLookupRankingModels",""),this.gh.EnableClientSideRendering=!0,this.gh.SharedSerpletFeatureGate1=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate1",!1),this.gh.SharedSerpletFeatureGate2=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate2",!1),this.gh.SharedSerpletFeatureGate3=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate3",
!1),this.gh.SharedSerpletFeatureGate4=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate4",!1),this.gh.SharedSerpletFeatureGate5=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate5",!1),this.gh.SharedSerpletFeatureGate6=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate6",!1),this.gh.SharedSerpletFeatureGate7=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate7",
!1),this.gh.SharedSerpletFeatureGate8=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate8",!1),this.gh.SharedSerpletFeatureGate9=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate9",!1),this.gh.SharedSerpletFeatureGate10=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate10",!1),this.gh.SharedSerpletFeatureGate11=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate11",
!1),this.gh.SharedSerpletFeatureGate12=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate12",!1),this.gh.SharedSerpletFeatureGate13=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate13",!1),this.gh.SharedSerpletFeatureGate14=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate14",!1),this.gh.SharedSerpletFeatureGate15=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate15",
!1),this.gh.SharedSerpletFeatureGate16=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate16",!1),this.gh.SharedSerpletFeatureGate17=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate17",!1),this.gh.SharedSerpletFeatureGate18=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate18",!1),this.gh.SharedSerpletFeatureGate19=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate19",
!1),this.gh.SharedSerpletFeatureGate20=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate20",!1),this.gh.SharedSerpletFeatureGate21=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate21",!1),this.gh.SharedSerpletFeatureGate22=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate22",!1),this.gh.SharedSerpletFeatureGate23=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate23",
!1),this.gh.SharedSerpletFeatureGate24=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate24",!1),this.gh.SharedSerpletFeatureGate25=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate25",!1),this.gh.SharedSerpletFeatureGate26=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate26",!1),this.gh.SharedSerpletFeatureGate27=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate27",
!1),this.gh.SharedSerpletFeatureGate28=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate28",!1),this.gh.SharedSerpletFeatureGate29=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate29",!1),this.gh.SharedSerpletFeatureGate30=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate30",!1),this.gh.SharedSerpletFeatureGate31=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate31",
!1),this.gh.SharedSerpletFeatureGate32=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate32",!1),this.gh.SharedSerpletFeatureGate33=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate33",!1),this.gh.SharedSerpletFeatureGate34=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate34",!1),this.gh.SharedSerpletFeatureGate35=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate35",
!1),this.gh.SharedSerpletFeatureGate36=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate36",!1),this.gh.SharedSerpletFeatureGate37=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate37",!1),this.gh.SharedSerpletFeatureGate38=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate38",!1),this.gh.SharedSerpletFeatureGate39=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate39",
!1),this.gh.SharedSerpletFeatureGate40=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate40",!1);this.STb=Q.a.instance.resolve("Common.App.SearchCommon.ISearchOAuthManager");this.Qeb=!!r.AFrameworkApplication.fa&&r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableOAuthManager",!1);this.Hdc=Qb.isEnterpriseUser();this.zEb=r.AFrameworkApplication.fa.Ha("SmartLookupShredderServiceEndpoint");this.adk=rb.a.UD(r.AFrameworkApplication.fa.Ha("AppCatalogUrl")||
"");this.Odk=r.AFrameworkApplication.fa.Ha("UserPrincipalName");(this.Hdc||this.Qeb)&&this.r4f()}cij(bb){return r.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline."+bb,"")}mhj(){const bb=r.AFrameworkApplication.fa.pPc,Vb=r.AFrameworkApplication.fa.RA("SmartLookupFlightKeywordList"),Ub=[];if(bb&&Vb&&0<Vb.length)for(let Mc in bb){var Jc={key:Mc,value:bb[Mc]};Jc=Jc&&Jc.key?Jc.key:"";for(let ed=0;ed<Vb.length;ed++)if(-1<Jc.toLowerCase().indexOf(Vb[ed].toLowerCase())){const dd=
Jc.split(".");dd&&4===dd.length&&Array.add(Ub,dd[dd.length-1])}}return Ub}K5b(bb,Vb,Ub,Jc){return new Promise(Mc=>{this.lTj().then(ed=>{const dd=new eb;dd.anid="";dd.applicationName=3===r.AFrameworkApplication.Aa.hb.Vk?"WORD":"POWERPNT";dd.applicationVersion=r.AFrameworkApplication.buildVersion;dd.appCorrelationId=bb?bb:na.S8a();dd.themePlatform="web";dd.lcid=r.AFrameworkApplication.lcid;dd.launchUtcTime=(new Date).toUTCString();r.AFrameworkApplication.fa.ka("SmartLookupFeatureGateV2")?dd.featureGates=
ha.c(this.gq):dd.featureGates=ha.c(this.gh);var je=za.a.ue(r.AFrameworkApplication.lcid);je=je?je.name:null;dd.market=yb(je);dd.uiLanguage=je;dd.sessionId=r.AFrameworkApplication.userSessionId;dd.themeId=Ub;dd.parentalControl="yes";dd.processorOnlyMode=ed;dd.isEditingAllowed=Vb.isEditingAllowed();dd.isFeedbackEnabled=this.Tzg;dd.isClientSideRendering=Za(Jc);dd.disableClipboard=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SerpletRestrictCopyWithIRMEnabled",!1)&&r.AFrameworkApplication.EJ&&
!r.AFrameworkApplication.tRa;dd.accessToken=this.Hdc||this.Qeb?this.r4f():"";ed=new lb;ed.CountryCode=yb(je);ed.ServiceEndpoint=this.zEb;ed.IsGoLocal=r.AFrameworkApplication.fa.ka("IsGoLocalEnvironment");ed.IsEnabled=this.Hdc;ed.IsEnterpriseEnabled=this.Hdc;ed.TenantRoot=this.adk;ed.Upn=this.Odk;je=Ya();ed.IsEUDB="PROD"===je&&""!==r.AFrameworkApplication.fa.Ha("IntentServiceEndpoint");dd.enterpriseUserInfo=ed;ed=new Tb;ed.filePath=r.AFrameworkApplication.fa.Ha("EditDocInClientUrl");ed.docName=r.AFrameworkApplication.fa.Ha("FileName");
ed.author=99!==Jc?Vb.author():null;ed.createdDate=99!==Jc?Vb.createdDate():null;dd.currentDocument=ed;Mc(dd)})})}lTj(){return new Promise(bb=>{this.oG?this.oG.execute(Vb=>{Vb.isFeatureEnabled(E.mjl,!0).then(Ub=>{bb(!Ub)}).catch(Ub=>{Y.Qu("SearchHelper - Failed to load the SmartLookup state from application feature helper: "+Ub.toString(),10);bb(!0)})}):bb(!0)})}P9g(bb){this.STb&&(this.Hdc||this.Qeb)&&this.I9d(this.zEb).then(Vb=>{bb(Vb)})}r4f(){if("Dev Box"===r.AFrameworkApplication.fa.Ha("StatusBarEnvironmentNameToUse")&&
void 0!==window.SearchPaneShredderTokenOverride&&null!==window.SearchPaneShredderTokenOverride)return window.SearchPaneShredderTokenOverride;const bb=this.Qeb?"Search":"SmartLookup";return this.STb?this.STb.jlj(bb,this.zEb,this.Qeb):""}I9d(bb){if("Dev Box"===r.AFrameworkApplication.fa.Ha("StatusBarEnvironmentNameToUse")&&void 0!==window.SearchPaneShredderTokenOverride&&null!==window.SearchPaneShredderTokenOverride)return new Promise(Ub=>{Ub(window.SearchPaneShredderTokenOverride)});const Vb=this.Qeb?
"Search":"SmartLookup";return this.STb?this.STb.getToken(Vb,bb,this.Qeb):Promise.resolve("")}J9a(){return this.p5a?this.p5a.getVersion():""}r_f(){return r.AFrameworkApplication.fa.ka("SmartLookupFeatureGateV2")?ha.c(this.gq):ha.c(this.gh)}static isEnterpriseUser(){const bb=r.AFrameworkApplication.fa.Ha("SovereignEnvironmentName"),Vb=r.AFrameworkApplication.fa.ka("IsTellMeUpSellEnterpriseEnabled");return(!bb||!bb.length)&&Vb}}Object(k.a)(Qb,"SearchHelper",null,[952]);class Bc{constructor(){Bc.Ka=""}getVersion(){return Bc.Ka}J$k(bb){Bc.Ka=
bb}}Bc.Ka=null;Object(k.a)(Bc,"SmartLookupVersion",null,[]);var wb=d(269),Ad=d(93);class bc{}Object(k.a)(bc,"ConfigurationProvider",null,[]);class Sb{constructor(bb){Sb.Ka=bb}g6d(){return Sb.Ka}}Sb.Ka=null;Object(k.a)(Sb,"SearchHostRuntime",null,[]);var Zb=d(132),cb=d(236),Xa=d(281),Lb=d(288);class pc{constructor(){this.sK=this.dmb=this.Da=null}get name(){return"Common.App.Insights"}$b(bb){this.Da=bb;const Vb=Lb.a.Uu(Q.a.instance.Ja("Common.IEventEmitter<Common.IGetMoreInfoResult>")),Ub=r.AFrameworkApplication.fa.ka("SmartLookupEnableNativePane")||
r.AFrameworkApplication.fa.ka("SmartLookupIsEnabled");bb.register(Qa,"Common.App.Insights.InsightsActor").ma().oa(()=>new Qa(bb.re("Common.App.Insights.IInsightsManager"),r.AFrameworkApplication.Ta,wb.a.instance,Ad.FocusManager.instance(),bb.Ja("Common.App.SearchCommon.ISearchOAuthManager"),r.AFrameworkApplication.fa,Zb.a.instance,Ub,new e.a(()=>Vb.result)));bb.register(951,"Common.App.Insights.IDocumentContentExtractionManager").ma().oa(()=>new w(bb));Ub&&(bb.register(Bc,"Common.App.Insights.SmartLookupVersion").ma().oa(()=>
new Bc),bb.register(952,"Common.App.SearchCommon.ISearchHelper").ma().oa(()=>new Qb(Q.a.instance.Ja("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),bb.rb("Common.App.Insights.SmartLookupVersion"))))}init(){r.AFrameworkApplication.MEa&&(this.dmb=this.Da.rb("Common.App.Insights.InsightsActor"),this.dmb.vb())}MNi(){this.GFj()}GFj(){ub().then(bb=>{if(""!==bb){const Vb=this.Da.rb("Common.App.Insights.SmartLookupVersion");Vb&&Vb.J$k(bb)}this.dNc();this.dmb=this.Da.resolve("Common.App.Insights.InsightsActor");
bb=hb(bb);bb=Xa.a.create(bb);bb.zS((Vb,Ub)=>{Ub.succeeded?this.wal()&&this.prefetchZeroTerm():Y.Qu("InsightsPackage - Failed to load SmartLookupHostRuntime script. ResourceURL: "+Ub.rt,10);this.dmb.vb()});cb.a.Wx(bb)})}wal(){const bb=Object.assign(new bc,{channelId:E.channelId,approvedOriginPattern:Ob()?"^(http)?://(localhost:8080)$":r.AFrameworkApplication.fa.Ha("SmartLookupApprovedOriginPattern")});var Vb=this.Da.resolve("Common.App.SearchCommon.IDocumentContentExecutor");const Ub=this.Da.resolve("Common.App.SearchCommon.ISerpletExecutor"),
Jc=this.Da.resolve("Common.App.SearchCommon.IInsertContentExecutor"),Mc=new C.a;Vb&&Mc.add(Vb);Ub&&Mc.add(Ub);Jc&&Mc.add(Jc);Vb=Mb();try{const ed=new Kc,dd=SmartLookupHostRuntime.setup(bb,Mc.toArray(),!0,Vb,ed);this.Da.register(Sb,"Common.App.SearchCommon.SearchHostRuntime").ma().oa(()=>new Sb(dd));return!0}catch(ed){return Y.Qu("InsightsPackage - Failed to setup SmartLookupHostRuntime during package initialization. Error: "+ed,10),!1}}prefetchZeroTerm(){if(r.AFrameworkApplication.fa.ka("SmartLookupEnableInDocumentSearch")||
r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentSearch",!1)){var bb=Q.a.instance.rb("Common.App.SearchCommon.SearchHostRuntime");if(bb){const Vb=this.Da.resolve("Common.App.SearchCommon.ISearchHelper"),Ub=this.Da.resolve("Common.App.SearchCommon.IDocumentHelper");Vb.K5b(null,Ub,0,99).then(Jc=>{bb.g6d().prefetchZeroTerm(Jc,r.AFrameworkApplication.userSessionId,Hc(),!0,"Indoc",null)})}else Y.Qu("InsightsPackage - Failed to prefetch zero term because we failed to resolve the HostRuntime.",
15)}}dNc(){var bb=this.Da.resolve("Common.App.SearchCommon.ISearchHelper");const Vb=jb(bb.J9a());bb=bb.J9a();bb=uc()+(""!==bb?bb:E.Vqc)+"/scripts/microsoft.office.smartlookup.ssr.js";const Ub=mc();ua.a.hx?this.LNi(Vb,bb):(this.JNi(Vb,Ub),this.KNi(bb,Ub))}JNi(bb,Vb){const Ub=new Sys.Net.WebRequest;Ub.set_httpVerb("GET");const Jc={};Jc.method=Ub.get_httpVerb();Ub.set_url(bb);const Mc=(new Date).getTime();try{window.fetch(Ub.getResolvedUrl(),Jc).then(()=>{""!==Vb&&Y.ySe(Vb,bb,(new Date).getTime()-Mc);
this.Da.rb("Common.App.Insights.SmartLookupVersion")})}catch(ed){Y.Qu("InsightsPackage - Failed to prefetch Html file because of HttpException. Error: "+ed.toString(),10)}}KNi(bb,Vb){var Ub=new Sys.Net.WebRequest;Ub.set_httpVerb("GET");const Jc={};Jc.method=Ub.get_httpVerb();Ub.set_url(bb);let Mc=-1;if(r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletPrefetchJSOnIdle",!1))Ub=r.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletPrefetchDelayInMs",
3E5),Zb.a.instance.Eb(new ya.a(5,1,Ub,()=>{const ed=Xa.a.create(bb);ed.bsf(()=>{Mc=Date.now()});ed.zS((dd,je)=>{je.succeeded?""!==Vb&&Y.ySe(Vb,bb,Date.now()-Mc):Y.Qu("InsightsPackage - Failed to prefetch JS file.",10)});cb.a.Wx(ed)}));else{Mc=Date.now();try{window.fetch(Ub.getResolvedUrl(),Jc).then(()=>{""!==Vb&&Y.ySe(Vb,bb,Date.now()-Mc)})}catch(ed){Y.Qu("InsightsPackage - Failed to prefetch JS file because of HttpException. Error: "+ed.toString(),10)}}}LNi(bb,Vb){if(ua.a.hx){var Ub=r.AFrameworkApplication.Je;
bb=new Na.a(bb,1,null,null,!0,2,null);Ub.send(bb).kJb(Jc=>{Jc&&Jc.data?Jc.data.Zd?this.Da.rb("Common.App.Insights.SmartLookupVersion"):Y.Qu("InsightsPackage - Request for Html with ClientRequestManager returned empty ResponseData. StatusCode: "+Jc.data.Te,10):Y.Qu("InsightsPackage - Request for Html with ClientRequestManager returned no Data.",10)},Jc=>{Jc&&Jc.data?Y.Qu("InsightsPackage - Failed to prefetch Html file with ClientRequestManager. StatusCode: "+Jc.data.Te,10):Y.Qu("InsightsPackage - Failed to prefetch Html file with ClientRequestManager. Unknown HTTP Failure.",
10)});r.AFrameworkApplication.fa.ka("SmartLookupPrefetchJSIsEnabled")&&(Vb=new Na.a(Vb,1,null,null,!0,2,null),Ub.send(Vb).kJb(Jc=>{Jc&&Jc.data?Jc.data.Zd||Y.Qu("InsightsPackage - Request for SSR JS with ClientRequestManager returned empty ResponseData. StatusCode: "+Jc.data.Te,10):Y.Qu("InsightsPackage - Request for SSR JS with ClientRequestManager returned no Data.",10)},Jc=>{Jc&&Jc.data?Y.Qu("InsightsPackage - Failed to prefetch JS SSR file with ClientRequestManager. StatusCode: "+Jc.data.Te,10):
Y.Qu("InsightsPackage - Failed to prefetch JS SSR file with ClientRequestManager. Unknown HTTP Failure.",10)}))}}dispose(){this.dmb&&this.dmb.dispose()}}Object(k.a)(pc,"InsightsPackage",null,[2,3]);var fc=d(27),bd=d(97),od=d(666),ye=d(1082),pd=d(533),ab=d(59),Yb=d(32);class Sc{constructor(bb,Vb,Ub,Jc=!0){this.streamUrl=bb;this.objectType=Vb;this.formatType=Ub;this.renderAfterInsert=Jc}}Object(k.a)(Sc,"InsertContentFromStreamData",null,[]);var Jb=d(531),Oc=d(28);class Wb{constructor(bb,Vb,Ub){this.ia=
bb;this.pa=Vb;this.ua=Ub}insertOnlinePicture(bb){const Vb=Object(Sa.a)(115,this.ua.Ba);bb&&Vb&&(bb=Object.assign(new pd.a,{Action:"Insert",Caption:bb.caption,OriginalUrl:bb.sourceUrl,Height:bb.height,Width:bb.width,LicenseDisplayName:bb.licenseDisplayName,LicenseUrl:bb.licenseUrl,ThumbnailUrl:bb.thumbnailUrl,PageUrl:bb.pageUrl}),this.ia.La(Oc.a.O$a,2,bb))}insertHtmlText(bb){if(bb)if(1===this.pa.Xd().length){const Vb=new ye.DictionaryPropertySet;Vb.setValue(ab.a.FU,bb.htmlText);Vb.setValue(ab.a.pgd,
!1);8===this.ia.La(Yb.a.ggd,2,Vb)&&this.Hcg(bb)}else this.Hcg(bb)}Hcg(bb){bb=Object.assign(new Jb.a,{pqc:!1,VY:bb.htmlText});this.ia.La(Oc.a.fJa,2,bb)}insertContentFromStreamUrl(bb){bb&&(bb=new Sc(bb.streamUrl,bb.objectType,bb.formatType,bb.renderAfterInsert),this.ia.La(Oc.a.uWc,2,bb))}getId(){return"InsertContentExecutor"}}Object(k.a)(Wb,"InsertContentExecutor",null,[808,950]);var Ab=d(1004),Xb=d(188);class vb{}Object(k.a)(vb,"CommandMetadataResponse",null,[]);class $c{constructor(){this.Fbe=this.getAllIcons()}executeCommand(){}executeCommandAsync(){return Promise.resolve(null)}openFeedbackPane(){}openSerpletTaskPane(){}sendAutoLaunchSearchRequest(){}openFindReplaceTaskPane(){}openFindReplaceTaskPaneV2(){}openFindTaskPane(){}openNavigationPane(){}closeNavigationPane(){}openPrivacySettings(){Xb.PrivacyDialogManager.hpd()}browseFiles(){}getId(){return"SerpletExecutor"}getCommandMetadata(bb){const Vb=
new vb;bb.iconNames&&(Vb.svgData=this.getCommandIconSvg(bb.iconNames));if(!bb.commandId||""===bb.commandId)return Vb.isVisible=!1,Vb;try{Vb.isVisible=Array.contains(appChrome.selectors.getVisibleControlIds(),bb.commandId);Vb.isDisabled=appChrome.selectors.isControlDisabled(bb.commandId);Vb.label=appChrome.selectors.getControlLabel(bb.commandId);if(Vb.svgData&&""!==Vb.svgData)return Vb;const Ub=appChrome.selectors.getControlIconSet(bb.commandId),Jc=Array(2);Jc[0]=Ub["default"];Jc[1]=Ub.icon32;Vb.svgData=
this.getCommandIconSvg(Jc)}catch(Ub){return null}return Vb}getCommandIconSvg(bb){if(!this.Fbe)return"";for(let Vb=0;Vb<bb.length;Vb++){const Ub=bb[Vb];if(Ub in this.Fbe)return this.Fbe[Ub]}return""}startSpeech(){return Promise.resolve(!1)}stopSpeech(){return Promise.resolve(!1)}getAllIcons(){return{}}createFeedbackPropertiesFromData(bb){const Vb={SourceControlId:"GiveFeedback"};Vb.feedbackType="true"===bb.IsPosFeedback?0:1;const Ub={};Ub.featureArea=$c.$Ui;Vb.telemetryGroup=Ub;Vb.appData=bb;return Vb}}
$c.xxj="FA000000012";$c.sHk="AssetID=";$c.$Ui="SearchPane";Object(k.a)($c,"BaseSerpletExecutor",null,[807,950]);var fd=d(26);class Bd extends $c{constructor(bb,Vb=null){super();this.ia=bb;this.sFg=Vb;if(!bb)throw Error.argumentNull("m_actionManager");}openFeedbackPane(bb){this.ia.La(Fa.a.mKb,2,this.createFeedbackPropertiesFromData(bb))}openHelpTaskPane(bb){const Vb={};Vb.query=$c.sHk+bb;bb={};bb.assetId=$c.xxj;bb.nonPersistedSettings=Vb;this.ia.La(Oc.a.Ufa,2,bb)}browseFiles(){this.ia.La(Fa.a.nXc,
2,null)}executeCommand(bb){if(bb)switch(bb.CommandId){case 3:appChrome.api.executeCommand(bb.Data.CommandId,bb.Data.Payload);break;case 4:if(this.sFg)try{this.sFg.IFj(bb.Data.AST)}catch(Vb){fd.a.J(509449952,1313,15,`SmartLookup PPTSerpletExecutor executeCommand: Exception thrown while executing provided AST. ${Vb}`)}}}}Object(k.a)(Bd,"PPTSerpletExecutor",$c,[]);class gd{isEditingAllowed(){return!0}author(){return null}createdDate(){return null}}Object(k.a)(gd,"BaseDocumentHelper",null,[809]);class Pd extends gd{constructor(){super()}isEditingAllowed(){return fc.App.Kb.Jd.isEditingAllowed}}
Object(k.a)(Pd,"PptDocumentHelper",gd,[]);class cd{constructor(){this.nwc=this.ZH=null}ZVd(){return null}ASa(){return this.l9a()}t$i(){return this.l9a()}qgl(bb,Vb,Ub){this.ZH||(this.ZH=this.TKc());this.ZH.em(bb,Vb,Ub)}rgl(bb,Vb,Ub){this.ZH||(this.ZH=this.TKc());this.ZH.RWe(bb,Vb,Ub)}Tel(bb,Vb){this.nwc||(this.nwc=this.ZVd());this.nwc&&this.nwc.RWe(bb,Vb)}Mmd(bb,Vb){this.ZH||(this.ZH=this.TKc());this.ZH.Mmd(bb,Vb)}cme(bb){this.ZH||(this.ZH=this.TKc());this.ZH.cme(bb)}S2k(){this.ZH&&this.ZH.DSe()}uTe(){this.ZH&&
this.ZH.h6k()}oel(){var bb=r.AFrameworkApplication.fa.Fc("SmartLookupLaunchThrottleThresholdInMilliseconds",1500);bb=window.performance.now()-cd.xmg<=bb;bb||(cd.xmg=window.performance.now());return bb}dispose(){this.ZH&&(this.ZH.dispose(),this.ZH=null)}get D9b(){return this.ZH?this.ZH.isVisible:!1}}cd.xmg=0;Object(k.a)(cd,"InsightsManager",null,[406,106]);class lf{constructor(bb,Vb,Ub,Jc,Mc,ed=!0,dd=null,je=null){this.dK=this.Zo=this.oha=null;this.ENa=!1;this.sK=null;this.Od=Vb;this.ZCd=ed;this.YQb=
je?je:new gd;this.oG=dd;this.oK=bb;this.ZCd&&(Q.a.instance.rb("Common.App.SearchCommon.SearchHostRuntime")&&(this.sK=Q.a.instance.resolve("Common.App.SearchCommon.SearchHostRuntime").g6d()),this.QV=Q.a.instance.resolve("Common.App.SearchCommon.ISearchHelper"),this.p5a=this.QV.J9a())}qgb(bb){if(this.ZCd){bb=bb.rawEvent;try{var Vb=ha.a(bb.data)}catch(Ub){z.ULS.sendTraceTag(595161728,1303,15,this.Dja("Message data from Serplet [{0}] failed to deserialize.",bb.data));return}switch(Vb.actionType){case 101:bb=
0;this.Zo&&(bb=this.Zo.entryPoint);this.QV.K5b(this.dK,this.YQb,this.USa(),bb).then(Ub=>{Vb.data=Ub;this.xHb(Vb)});break;case 118:Vb.data=this.Zo?this.Zo:Object.assign(new da.a,{selection:Object.assign(new fa.a,{neighborhood:this.oha.neighborhood,mentionStart:this.oha.mentionStart,mentionLength:this.oha.mentionLength})});this.xHb(Vb);break;case 103:bb=ha.a(Object(Sa.a)(String,Vb.data));Y.sendTelemetryEvent(bb);break;case 206:this.QV.I9d(Vb.data).then(Ub=>{Vb.data=Ub;this.xHb(Vb)});break;case 112:Vb.data.shiftPressed?
(ua.a.fg&&document.activeElement.blur(),this.oK.zUc(0,null,2,null,null),z.ULS.sendTraceTag(592545156,1303,50,this.Dja("Serplet UX lost focus through Ctrl + Shift + F6"))):(this.oK.cTa(0,null,2,null,null),z.ULS.sendTraceTag(592545155,1303,50,this.Dja("Serplet UX lost focus through Ctrl + F6")));break;case 40:this.zr()}}}Sib(bb){if(this.sK){var Vb=0;this.Zo&&(Vb=this.Zo.entryPoint);this.QV.K5b(this.dK,this.YQb,this.USa(),Vb).then(Ub=>{Y.Kmd("SearchFromHost",this.dK);this.Zo.launchData||(this.Zo.launchData=
new ra.a);const Jc=Hc();try{this.sK.search(this.Zo,Ub,r.AFrameworkApplication.userSessionId,Jc,bb),this.QV.P9g(Mc=>{Y.Kmd("SearchFromHostWithToken",this.dK);this.sK.searchAuthenticatedProviders(this.Zo,Ub,r.AFrameworkApplication.userSessionId,Jc,null,Mc)})}catch(Mc){Y.Qu("BaseSmartLookupPane - Fail to search from host. Error: "+Mc,10)}}).catch(Ub=>{Y.Qu("BaseSmartLookupPane - Failed to resolve application properties and invoke Search: "+Ub.toString(),10)})}}Zoc(bb){this.ZCd&&Y.Zoc(this.dK,Math.round(window.performance.now()-
bb),this.Zo?S[this.Zo.entryPoint]:"",this.QV.J9a(),this.QV.r_f(),r.AFrameworkApplication.pGc,this.ENa,Za(this.Zo?this.Zo.entryPoint:0))}}Object(k.a)(lf,"BaseSmartLookupPane",null,[1E3,106]);class Jd{constructor(){this.type="SmartLookupTaskPaneProps"}}Object(k.a)(Jd,"SmartLookupTaskPaneProps",null,[]);var Xf=d(642);class ee{}Object(k.a)(ee,"ActionDescriptor",null,[]);var Ra=d(95);class sb extends lf{constructor(bb,Vb,Ub,Jc=null,Mc=null,ed=null,dd=!0,je=null,Nd=null){super(Vb,Ub,Jc,Mc,ed,dd,je,Nd);
this.LKd=!!r.AFrameworkApplication.Aa&&!!r.AFrameworkApplication.Aa.hb&&r.AFrameworkApplication.Aa.hb.Tke;this.gob=this.PHd=!1;this.yVh=r.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletMaxViewportWidthThreshold",1680);this.xVh=r.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletMaxPaneWidth",844);this.CVh=r.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletMediumViewportWidthThreshold",1366);this.BVh=r.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletMediumPaneWidth",
700);dd||Y.Qu("ReactSmartLookupPane - React SmartLookup pane constructed for legacy SmartLookup.",10);this.hqa=bb;this.Ebf=jb(this.p5a)}get isVisible(){return this.gob}Mmd(bb,Vb){this.Zo=bb;this.oha=bb=Object.assign(new H.a,{neighborhood:bb.selection.neighborhood,mentionStart:bb.selection.mentionStart,mentionLength:bb.selection.mentionLength});this.ENa=!bb.mentionLength;this.dK=Vb;this.Sib(!1)}cme(bb){this.Zo=bb;this.Aya(Object.assign(new H.a,{neighborhood:bb.selection.neighborhood,mentionStart:bb.selection.mentionStart,
mentionLength:bb.selection.mentionLength}),!1)}em(bb,Vb){this.dK=Vb;this.Aya(bb,!0)}RWe(bb,Vb,Ub){this.Zo=bb;this.em(Object.assign(new H.a,{neighborhood:bb.selection.neighborhood,mentionStart:bb.selection.mentionStart,mentionLength:bb.selection.mentionLength}),Vb,Ub)}zr(){this.wnd();this.hqa.hideTaskPane()}Aya(bb,Vb){ka.SessionStatusManager.instance.C_&&this.sK?(this.oha=bb,this.ENa=!bb.mentionLength,bb=window.performance.now(),this.initialize(),this.isVisible?r.AFrameworkApplication.fa.ka("SmartLookupDisableRefreshPaneIsEnabled")?
(this.hqa.updateTaskPane(null),Vb&&this.n3k()):(Vb&&this.Sib(!1),this.PHd=!this.PHd,this.hqa.updateTaskPane(this.sca())):(Vb&&this.Sib(this.isVisible),this.hqa.showTaskPane(this.sca())),this.Zoc(bb)):(this.hqa.showTaskPane(this.sca()),Y.U2k(ka.SessionStatusManager.instance.C_,!!this.sK,this.Zo?S[this.Zo.entryPoint]:"",this.QV.J9a(),r.AFrameworkApplication.pGc,this.ENa))}n3k(){if(!this.Zo){const bb=Object.assign(new fa.a,{neighborhood:this.oha.neighborhood,mentionStart:this.oha.mentionStart,mentionLength:this.oha.mentionLength});
this.Zo=Object.assign(new da.a,{selection:bb,userIntent:null,entryPoint:0,launchData:null})}this.Sib(this.isVisible)}a3k(){const bb=new ee;bb.transactionId=this.dK;bb.actionType=15;bb.channelId=E.channelId;this.xHb(bb)}qgb(bb){const Vb=bb.rawEvent;document.getElementById(E.UY)&&Vb.source!==document.getElementById(E.UY).contentWindow||this.CLk(bb)}CLk(bb){const Vb=bb.rawEvent;let Ub;try{Ub=ha.b(Vb.data)}catch(Jc){z.ULS.sendTraceTag(545604257,1303,15,this.Dja("Message data from Serplet [{0}] failed to deserialize.",
Vb.data));return}switch(Ub.actionType){case 32:r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletL2Resizing",!1)&&(Ra.a.$Tc()>=this.yVh?this.hqa.updateTaskPane(this.iXd(this.xVh)):Ra.a.$Tc()>=this.CVh&&this.hqa.updateTaskPane(this.iXd(this.BVh)));break;case 33:r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletL2Resizing",!1)&&this.hqa.updateTaskPane(this.iXd(Ub.data));break;case 42:this.hqa.updateTaskPane(this.zGi(Ub.data));
break;case 43:this.hqa.updateTaskPane(this.sca());break;default:super.qgb(bb)}}dispose(){}initialize(){this.Gjb()}Gjb(){const bb=this.Od.Gc(E.UY);bb.parent=oa.AFrame.nj;bb.zL=!0}ZKb(){this.Od.xf(E.UY)}wnd(){this.Ske()&&this.Od.xf(this.Od.X7)}oOe(){$addHandler(window,"message",Object(A.a)(this,this.qgb,"onIFrameMessage"))}h2e(){$removeHandler(window,"message",Object(A.a)(this,this.qgb,"onIFrameMessage"))}Ske(){return!!this.Od.Be&&this.Od.Be.name===E.UY}xHb(bb){bb=ha.c(bb);document.getElementById(E.UY)&&
document.getElementById(E.UY).contentWindow.postMessage(bb,rb.a.pQ(this.Ebf))}Dja(bb,...Vb){const Ub={};this.dK&&(Ub[E.uAh]=this.dK);Ub[E.vAh]=String.format.apply(null,[bb].concat(Vb));return ha.c(Ub)}USa(){return wa.a("isSharedUXDarkModeOn")&&appChrome.api.isSharedUXDarkModeOn()?3:0}E6g(){if(this.sK)this.sK.onPaneThemeChanged(this.USa());return wa.a("getTheme")?appChrome.api.getTheme():null}DSe(){}h6k(){document.getElementById(E.UY)&&Ad.FocusManager.Sr(document.getElementById(E.UY).contentWindow)}ZFe(){Y.Qu("ReactSmartLookupPane - Iframe component failed to load.",
10)}qpk(){r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DisableSerpletIFrameLoadHandler",!1)||window.navigator.onLine||Y.Qu("ReactSmartLookupPane - Onload detected no network.",50)}n5i(){let bb;if(!this.Zo)return"";10===this.Zo.entryPoint?bb=2===r.AFrameworkApplication.Aa.hb.Vk?CommonUIStrings.l_ReuseSlidesPaneTitle:CommonUIStrings.l_ReuseFilesPaneTitle:18===this.Zo.entryPoint?bb=CommonUIStrings.l_FindInDocumentPaneTitle:(bb=CommonUIStrings.L_CoPilotPaneTitle,!this.Zo.launchData||
""===this.Zo.launchData.landingTab||"ActionAI"!==this.Zo.launchData.landingTab&&"Copilot"!==this.Zo.launchData.landingTab||(bb=CommonUIStrings.l_CoPilotPreviewPaneTitle));return bb}sca(){var bb=CommonUIStrings.L_SmartLookupPaneTitle;r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableCoPilotPaneTitle",!1)&&(bb=this.n5i());const Vb=new Jd;Vb.src=this.Ebf;Vb.id=E.UY;Vb.refreshPane=this.PHd;Vb.onError=Object(A.a)(this,this.ZFe,"onIFrameError");Vb.onLoad=Object(A.a)(this,
this.qpk,"onIFrameLoad");Vb.title=bb;ka.SessionStatusManager.instance.C_?this.sK||(Vb.errorMessage=CommonUIStrings.l_SmartLookupPaneInitializationError,Vb.errorType=1):(Vb.errorMessage=CommonUIStrings.l_SmartLookupPaneNetworkDisconnected,Vb.errorType=0);bb=Object.assign(new Xf.a,{title:bb,hideHeader:!1,width:E.width,location:E.Bwk,contentProps:Vb,isModernPane:!0,onOpen:()=>{this.ZKb();this.gob=!0;this.oOe();wa.a("registerOnThemeChangeCallback")&&appChrome.api.registerOnThemeChangeCallback(Object(A.a)(this,
this.E6g,"onThemeIdChanged"));r.AFrameworkApplication.Aa.updateCommandUI();if(this.sK)this.sK.onPaneStateChanged(!0)},onClose:()=>{this.a3k();this.wnd();this.gob=!1;this.h2e();wa.a("removeOnThemeChangeCallback")&&appChrome.api.removeOnThemeChangeCallback(Object(A.a)(this,this.E6g,"onThemeIdChanged"));r.AFrameworkApplication.Aa.updateCommandUI();if(this.sK)this.sK.onPaneStateChanged(!1)}});this.LKd&&(bb.enableResize=!0,bb.minResizeWidth=320,bb.maxResizeWidth=920);return bb}zGi(bb){const Vb=this.sca();
Vb.title=bb;Vb.contentProps.title=bb;return Vb}iXd(bb){const Vb=this.sca();Vb.resizeWidth=bb;return Vb}}Object(k.a)(sb,"ReactSmartLookupPane",lf,[]);var ec=d(140);class Lc{constructor(){this.Vdf=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.SmartLookupPaneResizingEnabled",!1)}showTaskPane(bb){ec.UISurfaces.xr().then(Vb=>{this.Vdf||(bb.enableResize=!1);Vb.showTaskPane(E.UY,bb);return null})}updateTaskPane(bb=null){ec.UISurfaces.xr().then(Vb=>{Vb.setSelectedTaskPane(E.UY);
bb&&(this.Vdf||(bb.enableResize=!1),Vb.updateTaskPane(E.UY,bb));return null})}hideTaskPane(){ec.UISurfaces.xr().then(bb=>{bb.hideTaskPane(E.UY,2);return null})}}Object(k.a)(Lc,"PptReactSmartLookupPaneHandler",null,[961]);class nd{static Oij(){switch(r.AFrameworkApplication.fa.ka("SmartLookupEnableEdogSourceLocationOverride")?"EDOG":r.AFrameworkApplication.fa.ka("SmartLookupEnableProdSourceLocationOverride")?"PROD":r.AFrameworkApplication.fa.ka("SmartLookupEnableIntSourceLocationOverride")?"INT":nd.R7i()){case "INT":return"WAC.INT.URL";
case "EDOG":return"WAC.EDOG.URL";default:return"WAC.PROD.URL"}}static R7i(){switch(Object(Sa.a)(String,r.AFrameworkApplication.gd.AudienceGroup)||""){case "Dogfood":if(r.AFrameworkApplication.fa){let bb=r.AFrameworkApplication.fa.Ha("UserPrincipalName");bb=Wa.a.og(bb);const Vb=r.AFrameworkApplication.fa.aw("SmartLookupINTEnabledForSKITeam")?r.AFrameworkApplication.fa.RA("SmartLookupINTEnabledForSKITeam"):[];return 0<=Array.indexOf(Vb,bb)?"INT":"EDOG"}return"EDOG";default:return"PROD"}}}Object(k.a)(nd,
"Utils",null,[]);class Fd{constructor(bb,Vb=null){this.dK=this.Zo=this.oha=null;this.ENa=!1;this.sK=null;this.oK=bb;this.YQb=Vb?Vb:new gd;Q.a.instance.rb("Common.App.SearchCommon.SearchHostRuntime")&&(this.sK=Q.a.instance.resolve("Common.App.SearchCommon.SearchHostRuntime").g6d());this.QV=Q.a.instance.resolve("Common.App.SearchCommon.ISearchHelper");this.p5a=this.QV.J9a()}Sib(bb){if(this.sK){var Vb=0;this.Zo&&(Vb=this.Zo.entryPoint);this.QV.K5b(this.dK,this.YQb,this.USa(),Vb).then(Ub=>{Y.Kmd("SearchFromHost",
this.dK);this.Zo.launchData||(this.Zo.launchData=new ra.a);const Jc=Hc();try{this.sK.search(this.Zo,Ub,r.AFrameworkApplication.userSessionId,Jc,bb),this.QV.P9g(Mc=>{Y.Kmd("SearchFromHostWithToken",this.dK);this.sK.searchAuthenticatedProviders(this.Zo,Ub,r.AFrameworkApplication.userSessionId,Jc,null,Mc)})}catch(Mc){Y.Qu("BaseSmartLookupPane - Fail to search from host. Error: "+Mc,10)}}).catch(Ub=>{Y.Qu("BaseSmartLookupPane - Failed to resolve application properties and invoke Search: "+Ub.toString(),
10)})}}oOe(){$addHandler(window,"message",Object(A.a)(this,this.qgb,"onIFrameMessage"))}h2e(){$removeHandler(window,"message",Object(A.a)(this,this.qgb,"onIFrameMessage"))}xHb(bb){bb=ha.c(bb);document.getElementById(this.wwb())&&document.getElementById(this.wwb()).contentWindow.postMessage(bb,rb.a.pQ(uc()))}qgb(bb){let Vb;bb=bb.rawEvent;try{Vb=ha.b(bb.data)}catch(Ub){z.ULS.sendTraceTag(509614105,1303,15,this.Dja("Message data from Serplet [{0}] failed to deserialize.",bb.data));return}switch(Vb.actionType){case 103:bb=
ha.b(Object(Sa.a)(String,Vb.data));Y.sendTelemetryEvent(bb);break;case 206:this.QV.I9d(Vb.data).then(Ub=>{Vb.data=Ub;this.xHb(Vb)});break;case 112:Vb.data.shiftPressed?(ua.a.fg&&document.activeElement.blur(),this.oK.zUc(0,null,2,null,null),z.ULS.sendTraceTag(509614104,1303,50,this.Dja("Serplet UX lost focus through Ctrl + Shift + F6"))):(this.oK.cTa(0,null,2,null,null),z.ULS.sendTraceTag(509614103,1303,50,this.Dja("Serplet UX lost focus through Ctrl + F6")));break;case 40:this.zr()}}Dja(bb,...Vb){const Ub=
{};this.dK&&(Ub[E.uAh]=this.dK);Ub[E.vAh]=String.format.apply(null,[bb].concat(Vb));return ha.c(Ub)}Zoc(bb){Y.Zoc(this.dK,Math.round(window.performance.now()-bb),this.Zo?S[this.Zo.entryPoint]:"",this.QV.J9a(),this.QV.r_f(),r.AFrameworkApplication.pGc,this.ENa,Za(this.Zo?this.Zo.entryPoint:0))}}Fd.Jci="AppProperties";Fd.ijl="SmartLookupApplicationInterface";Object(k.a)(Fd,"BaseCopilotAddin",null,[982,106]);class Ja extends Fd{constructor(bb,Vb,Ub,Jc){if(!bb)throw Error.argumentNull("actionManager");
if(!Vb)throw Error.argumentNull("appForOfficeManager");if(!Jc)throw Error.argumentNull("f6Manager");super(Jc,Ub);this.Db=!1;this.Yzg=!0;this.oqg="FA000000006";this.ia=bb;this.Zc=Vb;this.Zz={};this.rck=nd.Oij();this.Zz.sourceLocationOverrideResourceId=this.rck;this.Zz.TE="Copilot";this.Zz.assetId=this.oqg;this.Zz.ZLa=!0}RWe(bb,Vb){this.Zo=bb;const Ub=Object.assign(new H.a,{neighborhood:bb.selection.neighborhood,mentionStart:bb.selection.mentionStart,mentionLength:bb.selection.mentionLength});this.dK=
Vb;this.oha=Ub;this.ENa=!Ub.mentionLength;ka.SessionStatusManager.instance.C_&&this.sK?(this.Sib(!1),this.QV.K5b(this.dK,this.YQb,this.USa(),bb.entryPoint).then(Jc=>{Jc.isFirstLaunch=this.Yzg;this.Yzg=!1;const Mc={};Mc[Fd.ijl]=this.Zo;Mc[Fd.Jci]=Jc;this.Zz.nonPersistedSettings=Mc;this.Zz.p5=Object(A.a)(this,this.tgb,"onPaneRendered");this.ia.La(Oc.a.Ufa,2,this.Zz);this.Db=!0})):(this.ia.La(Oc.a.Ufa,2,this.Zz),this.Db=!0)}tgb(){this.oOe()}zr(){const bb=this.wwb();this.h2e();bb&&this.ia&&this.ia.La(Oc.a.Ssb,
2,bb);this.Db=!1}Mmd(bb,Vb){this.Zo=bb;this.oha=bb=Object.assign(new H.a,{neighborhood:bb.selection.neighborhood,mentionStart:bb.selection.mentionStart,mentionLength:bb.selection.mentionLength});this.ENa=!bb.mentionLength;this.dK=Vb;this.Sib(!1)}dispose(){}wwb(){if(this.Zc.instance){const bb=this.Zc.instance.mQ(this.oqg+"."+this.Zz.sourceLocationOverrideResourceId);if(bb)return bb.instanceId;fd.a.J(509433935,1313,15,"PPT Copilot Addin: Could not find task pane from ID.")}else fd.a.J(509433934,1313,
15,"PPT Copilot Addin: AppForOfficeManager is unavailable.");return null}USa(){return wa.a("isSharedUXDarkModeOn")&&appChrome.api.isSharedUXDarkModeOn()?3:0}get isVisible(){return this.Db}}Object(k.a)(Ja,"PptCopilotAddin",Fd,[]);class db extends cd{constructor(bb,Vb,Ub,Jc,Mc){super();this.ZRg=bb;this.Yb=Ub;this.ia=Jc;this.Zc=Mc}TKc(){const bb=this.Yb.ka("822");return new sb(new Lc,wb.a.instance,Ad.FocusManager.instance(),Q.a.instance.resolve("Common.App.SearchCommon.IDocumentContentExecutor"),Q.a.instance.resolve("Common.App.SearchCommon.ISerpletExecutor"),
Q.a.instance.resolve("Common.App.SearchCommon.IInsertContentExecutor"),bb,Q.a.instance.Ja("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"))}ZVd(){return this.Yb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableCopilotAddin",!1)?new Ja(this.ia,this.Zc,null,wb.a.instance):super.ZVd()}l9a(){return this.ZRg.getSelectedText()}ihg(){return this.ZRg.VJj()}}Object(k.a)(db,"SmartLookupManager",cd,[]);class ic{constructor(bb,Vb,Ub,Jc,Mc,ed,dd){this.X3=bb;this.Jb=Vb;this.ddk=Ub;this.Hbk=
Jc;this.lck=Mc;this.x7j=ed;this.sUg=dd;this.vGa=new Map;if(!bb)throw Error.argumentNull("m_appForOfficeManagerFuture");if(!Vb)throw Error.argumentNull("m_transactionFactory");if(!Ub)throw Error.argumentNull("m_textODSLEntity");if(!Jc)throw Error.argumentNull("m_shapeODSLEntity");if(!Mc)throw Error.argumentNull("m_slideODSLEntity");if(!ed)throw Error.argumentNull("m_imageODSLEntity");if(!dd)throw Error.argumentNull("m_tablesODSLEntity");this.X3&&this.X3.execute(je=>{this.Zc=je});this.vGa=new Map;this.vGa.set("text",
this.ddk);this.vGa.set("shapes",this.Hbk);this.vGa.set("slides",this.lck);this.vGa.set("images",this.x7j);this.vGa.set("tables",this.sUg);this.vGa.set("table",this.sUg)}Vxi(bb,Vb){return Object.assign({},...bb.map(Ub=>Vb.has(Ub.value)?{[Ub.name]:Vb.get(Ub.value)}:{[Ub.name]:JSON.parse(Ub.value)}))}IFj(bb){if(this.Zc){var Vb=this.Jb.le(15);try{Vb.nc(this.Zc.o_.presentation);const Ub=new Map;for(const Jc of bb.statements){const Mc=Jc.name.split("_");if(2!==Mc.length)throw Error.argumentOutOfRange("statement",
Mc,"Provided ODSL statement does not have expected format of action_entity.");const ed=Mc[0],dd=Mc[1];if(!this.vGa.has(dd))throw Error.argumentOutOfRange("entityName",dd,"Provided entity name in ODSL statement is not supported.");const je=this.vGa.get(dd);if(!je)throw Error.argumentOutOfRange("entity",je,"Could not access entity for provided ODSL statement.");const Nd=this.Vxi(Jc.arguments,Ub);if(!Nd)throw Error.argumentOutOfRange("args",Nd,"Could not construct ODSL statement input from provided args.");
let Ld;switch(ed){case "select":Ld=je.select(Nd);break;case "format":Ld=je.format(Nd);break;case "insert":Ld=je.insert(Nd);break;case "delete":Ld=je.delete(Nd);break;case "default":throw Error.argumentOutOfRange("action",ed,"Provided action in ODSL statement is not supported.");}Jc.returnVariable&&Ld&&Ub.set(Jc.returnVariable,Ld)}}catch(Ub){fd.a.J(509440020,1313,15,`SmartLookup PPTSerpletExecutor executeCommand: Exception thrown while executing provided AST. ${Ub}`)}finally{Vb&&Vb.dispose()}}else fd.a.J(509440021,
1313,15,"SmartLookup ODSLInterpreter interpret: Skipping execution because no AppForOfficeManager instance exists.")}}Object(k.a)(ic,"ODSLInterpreter",null,[949]);var id=d(630);class qd{constructor(bb,Vb,Ub){this.Vb=bb;this.ia=Vb;this.S0g=Jc=>{if(Jc)switch(Jc.actionType){case "Query":this.Erk(Jc)}};if(!this.Vb)throw Error.argumentNull("m_workspace");if(!this.ia)throw Error.argumentNull("m_actionManager");if(!Ub)throw Error.argumentNull("actorFuture");Ub.execute(()=>{this.start().catch(Jc=>{z.ULS.sendTraceTag(509440287,
1313,10,`Unable to start Copilot UX, error: ${Jc}`)})})}Erk(bb){var Vb;bb=null!==(Vb=bb.query)&&void 0!==Vb?Vb:"";Vb=Object.assign(new da.a,{selection:Object.assign(new fa.a,{neighborhood:bb,mentionStart:0,mentionLength:bb.length}),launchData:Object.assign(new ra.a,{landingTab:"Copilot"}),entryPoint:0});this.ia.La(Fa.a.Ldg,2,Vb)}m5i(){this.U4c||(this.U4c=document.createElement("div"),this.U4c.id="copilotHost",document.body.appendChild(this.U4c));return this.U4c}start(){return Object(id.a)(this,void 0,
void 0,function*(){const bb=this.m5i();this.T4j=yield(yield ec.UISurfaces.l5i()).renderCopilot(bb,{S0g:this.S0g});if(!this.T4j)throw Error("Copilot control interface is not returned.");})}}Object(k.a)(qd,"PptCopilot",null,[]);class Fc{constructor(bb,Vb){this.X3=bb;this.pa=Vb;this.insert=({description:Ub})=>{throw Error(`Could not get imageString in Base64 for ${Ub}`);};if(!bb)throw Error.argumentNull("m_appForOfficeManagerFuture");if(!Vb)throw Error.argumentNull("m_selectionManager");this.X3&&this.X3.execute(Ub=>
{this.Zc=Ub})}select(){throw Error("Method not implemented.");}format(){throw Error("Method not implemented.");}delete(){throw Error("Method not implemented.");}}Object(k.a)(Fc,"ODSLImage",null,[875]);var Ze=d(575),df=d(1194),ve;(function(bb){bb[bb.horizontal=0]="horizontal";bb[bb.vertical=1]="vertical"})(ve||(ve={}));Object(k.b)("Orientation",ve);var md=d(280),Kf=d(61),oe=d(56),Hf=d(388),xb=d(673),hg=d(41),rf=d(100),nf=d(1012),kd=d(674),If=d(241),og=d(228);class pf{}var ig=pf;pf.dmh={aliceblue:"#f0f8ff",
antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",
darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",
honeydew:"#f0fff0",hotpink:"#ff69b4","indianred ":"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",
limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",
orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",
snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};pf.nQa=bb=>{bb=bb.toLowerCase().trim().replace(/\s/g,"");return pf.dmh[bb]?pf.dmh[bb]:""};pf.hBf=bb=>bb?""!==ig.nQa(bb):!1;pf.l4i=bb=>{var Vb=/^#([0-9a-f])*$/i;if(!bb||!bb.match(Vb))throw Error("invalid hex color string provided");Vb=new og.Color;switch(bb.length){case 7:Vb.a=
1;Vb.r=parseInt(bb.substring(1,3),16);Vb.g=parseInt(bb.substring(3,5),16);Vb.b=parseInt(bb.substring(5,7),16);break;case 9:Vb.r=parseInt(bb.substring(1,3),16);Vb.g=parseInt(bb.substring(3,5),16);Vb.b=parseInt(bb.substring(5,7),16);Vb.a=parseInt(bb.substring(7,9),16);break;default:throw Error("unsupported color string provided");}return Vb};Object(k.a)(pf,"ColorTranslator",null,[]);class Oe{constructor(bb,Vb,Ub,Jc,Mc,ed,dd,je,Nd,Ld,Xe){this.X3=bb;this.pa=Vb;this.Wj=Ub;this.tXa=Jc;this.qWa=Mc;this.Ea=
ed;this.Tk=dd;this.Pi=je;this.Fb=Nd;this.Hs=Ld;this.Hu=Xe;this.bDb=this.iHa=0;this.tSe=(pe,fe)=>{for(let wd of pe)fe.push(...wd.Pk())};this.select=({scope:pe,index:fe=-1})=>{let wd=[],Ue=null!==pe&&void 0!==pe?pe:"Selection";if("Selection"===Ue){const rd=this.pa.Xd();0<rd.length?wd.push(...rd):this.tSe(this.pa.We(),wd);0!==wd.length||pe||(Ue="Presentation")}if("Presentation"===Ue&&this.Zc){pe=this.Zc.o_.presentation.slides;if(null===pe)throw Error("Could not cast from ISlide to ISlideNode on presentation slides.");
this.tSe(pe,wd)}else Array.isArray(Ue)&&0<Ue.length&&Ue[0]instanceof md.a&&this.tSe(Ue,wd);-1!==fe&&fe<wd.length&&(wd=[wd[fe]]);return wd};this.format=({shapes:pe,left:fe,top:wd,height:Ue,width:rd,lineColor:Ud,lineDashStyle:qe,lineWeight:Nf,lineTransparency:sf,fillColor:tf,fillTransparency:Lf})=>{if(pe&&0<pe.length)for(const kf of pe){void 0!==fe&&(kf.qy=fe);void 0!==wd&&(kf.ry=wd);void 0!==Ue&&(kf.wC=Ue);void 0!==rd&&(kf.nx=rd);Ud&&(pe=pf.nQa(Ud),Ud=""===pe?Ud:pe,pe=If.a.parse(Ud),kf.sya=JSON.stringify(pe));
if(qe)switch(qe){case "Dash":kf.QO=0;break;case "DashDot":kf.QO=1;break;case "DashDotDot":kf.QO=2;break;case "LongDash":kf.QO=3;break;case "LongDashDot":kf.QO=4;break;case "RoundDot":kf.QO=5;break;case "Solid":kf.QO=6;break;case "SquareDot":kf.QO=7;break;case "LongDashDotDot":kf.QO=8;break;case "SystemDash":kf.QO=9;break;case "SystemDot":kf.QO=10;break;case "SystemDashDot":kf.QO=11;break;default:kf.QO=6}void 0!==Nf&&(kf.outlineWidth=Nf);void 0!==sf&&(pe=If.a.parse(kf.sya),pe.Alpha=100*sf,kf.sya=JSON.stringify(pe));
tf&&(tf=""===pf.nQa(tf)?tf:pf.nQa(tf),pe=If.a.parse(tf),kf.woa=JSON.stringify(pe));void 0!==Lf&&(pe=If.a.parse(kf.woa),pe.Alpha=100*Lf,kf.woa=JSON.stringify(pe))}};this.insert=({shapeType:pe,slides:fe})=>{if(!this.Zc)throw Error("Cannot insert shapes without appForOfficeManager instance.");const wd=[];for(const tf of fe){if(!tf)throw Error("Cannot find selected slide to insert shape.");fe=tf.Cb;if(Kf.a.ax(fe))throw Error("Cannot insert on fake slide node.");const Lf=this.U8a(pe);if(!Lf)throw Error("Could not load props for shapeType.");
if(!this.Wj.JF(tf,1))throw this.Wj.hG(tf),Error("Too many shapes on the slide.");const kf=this.tXa.sL;var Ue=tf.Ne.HasDefaultShape,rd=tf.Ne.HasDefaultLine,Ud=95===Lf.$fa||97===Lf.$fa||Array.contains(xb.a.lme,Lf.$fa);rd=rd&&Ud;Ue=Ue&&!Ud;this.qga(0);var qe=void 0;let Ed,Cd;var Nf=this.Zc.o_.presentation.slideWidth,sf=this.Zc.o_.presentation.slideHeight;qe=new oe.a((Nf-Lf.width*Ze.a.UC)/2,(sf-Lf.height*Ze.a.UC)/2);Ud=qe.x+df.a.rf(this.hO*Hf.a.HS,ve.horizontal);Cd=qe.y+df.a.rf(this.hO*Hf.a.HS,ve.vertical);
kf?(qe=Lf.width*Ze.a.UC,Ed=Lf.height*Ze.a.UC):(qe=df.a.rf(Oe.vZb,ve.horizontal),Ed=df.a.rf(Oe.uZb,ve.vertical),Ud=Nf/2-df.a.rf(Oe.vZb/2-this.hO*Hf.a.HS,ve.horizontal),Cd=sf/2-df.a.rf(Oe.uZb/2-this.hO*Hf.a.HS,ve.vertical));this.hO++;this.hO>this.iHa&&(this.hO=this.bDb);Nf=tf.Pt();sf=Object(Sa.a)(295,this.Zc.o_.Ba.tg(this.Fb.Ma));hg.a.Ib&&(rd||Ue)&&hg.a.Ib.Va(rf.a.w1d,rd?"HasDefaultLine":"HasDefaultShape");fe=!kf||"TextBox"===pe||Ue||rd?this.Tk.FQa(!1,fe.cid,fe.sid,0,Lf.shapeType,Ud,Cd,qe,Ed,Nf+1):
xb.a.gLc(fe,Lf,sf.mT,null,new nf.a,Ud,Cd,qe,Ed,Nf,this.Ea,this.Tk,this.Fb,this.Zc.o_,this.Pi);this.Hs.zW([fe],tf,null);this.Hu.NF=fe;this.Ysc();wd.push(fe)}return wd};this.delete=({shapes:pe})=>{for(const fe of pe)this.Tk.EMc(fe)};if(!bb)throw Error.argumentNull("m_appForOfficeManagerFuture");if(!Vb)throw Error.argumentNull("m_selectionManager");if(!Ub)throw Error.argumentNull("m_shapeCountValidator");if(!Jc)throw Error.argumentNull("m_shapeSVGDependencyLoader");this.X3&&this.X3.execute(pe=>{this.Zc=
pe});this.hO=0}qga(bb){this.qWa.i0e(bb)}Ysc(){const bb=Q.a.instance.Ja("Common.ISystemInitiatedFeedback");bb&&bb.execute(Vb=>{Vb.logActivity("InsertShapeActivity",null)})}U8a(bb){switch(bb){case "TextBox":return new kd.a(34,16,.5,3);case "TextBoxAtSpecifiedLocation":return new kd.a(34,16,.5,3);case "Ellipse":return new kd.a(34,9,1,1);case "Triangle":return new kd.a(2,17,1,1.16);case "RightTriangle":return new kd.a(3,55,1,1);case "Parallelogram":return new kd.a(6,56,1,1.33);case "Trapezoid":return new kd.a(7,
57,1.33,1);case "Diamond":return new kd.a(5,58,1,1);case "SPentagon":return new kd.a(9,59,1,1.05);case "Hexagon":return new kd.a(10,60,1,1.16);case "Heptagon":return new kd.a(11,61,1,1);case "Octagon":return new kd.a(12,62,1,1);case "Decagon":return new kd.a(13,63,1,1);case "Dodecagon":return new kd.a(14,64,1,1);case "Pie":return new kd.a(39,65,1,1);case "Chord":return new kd.a(87,66,1,1);case "Teardrop":return new kd.a(35,67,1,1);case "Frame":return new kd.a(83,68,1,1);case "HalfFrame":return new kd.a(84,
69,1,1);case "LShape":return new kd.a(85,70,1,1);case "DiagonalStripe":return new kd.a(86,71,1,1);case "Cross":return new kd.a(130,72,1,1);case "Plaque":return new kd.a(33,73,1,1);case "Can":return new kd.a(73,7,1.33,1);case "Cube":return new kd.a(72,8,1.33,1.33);case "Bevel":return new kd.a(82,74,1.14,1.14);case "Donut":return new kd.a(41,75,1,1);case "NoSymbol":return new kd.a(42,76,1,1);case "BlockArc":return new kd.a(40,77,1,1);case "FoldedCorner":return new kd.a(81,78,1,1);case "SmileyFace":return new kd.a(78,
79,1,1);case "Heart":return new kd.a(75,18,1,1);case "LightningBolt":return new kd.a(74,80,1,1);case "Sun":return new kd.a(76,81,1,1);case "Moon":return new kd.a(77,82,1,.5);case "Cloud":return new kd.a(120,83,1,1);case "Arc":return new kd.a(88,84,1,1);case "DoubleBracket":return new kd.a(93,85,1,1);case "DoubleBrace":return new kd.a(94,86,1,1.17);case "LeftBracket":return new kd.a(89,87,1,.08);case "RightBracket":return new kd.a(90,88,1,.08);case "LeftBrace":return new kd.a(91,89,1,.17);case "RightBrace":return new kd.a(92,
90,1,.17);case "MathPlus":return new kd.a(175,19,1,1);case "MathMinus":return new kd.a(176,20,1,1);case "MathMultiply":return new kd.a(177,21,1,1);case "MathDivide":return new kd.a(178,22,1,1);case "MathEqual":return new kd.a(179,23,1,1);case "MathNotEqual":return new kd.a(180,24,1,1);case "StraightConnector":return new kd.a(95,12,1,1);case "StraightConnectorArrow":return new kd.a(95,13,1,1);case "StraightConnectorTwoArrow":return new kd.a(95,14,1,1);case "ElbowConnector":return new kd.a(97,26,1,
1);case "ElbowArrowConnector":return new kd.a(97,155,1,1);case "ElbowDoubleArrowConnector":return new kd.a(97,156,1,1);case "CurvedConnector":return new kd.a(101,25,1,1);case "CurvedArrowConnector":return new kd.a(101,153,1,1);case "CurvedDoubleArrowConnector":return new kd.a(101,154,1,1);case "DownArrow":return new kd.a(46,0,1.07,.53);case "LeftArrow":return new kd.a(44,1,.53,1.07);case "LeftRightArrow":return new kd.a(50,2,.53,1.33);case "RightArrow":return new kd.a(43,3,.53,1.07);case "UpArrow":return new kd.a(45,
4,1.07,.53);case "UpDownArrow":return new kd.a(51,5,1.33,.53);case "LeftRightUpArrow":return new kd.a(53,27,.93,1.33);case "BentArrow":return new kd.a(62,28,.95,.89);case "UTurnArrow":return new kd.a(63,29,.96,.97);case "LeftUpArrow":return new kd.a(52,30,.93,.93);case "BentUpArrow":return new kd.a(49,31,.8,.93);case "CurvedRightArrow":return new kd.a(67,32,1.33,.8);case "CurvedLeftArrow":return new kd.a(68,33,1.33,.8);case "CurvedUpArrow":return new kd.a(69,34,.8,1.33);case "CurvedDownArrow":return new kd.a(70,
46,.8,1.33);case "StripedRightArrow":return new kd.a(47,35,.53,1.07);case "NotchedRightArrow":return new kd.a(48,36,.53,1.07);case "Pentagon":return new kd.a(36,37,.53,1.07);case "Chevron":return new kd.a(37,38,.53,.53);case "RightArrowCallout":return new kd.a(56,39,1,1);case "DownArrowCallout":return new kd.a(58,40,1,1);case "LeftArrowCallout":return new kd.a(55,41,1,1);case "UpArrowCallout":return new kd.a(57,42,1,1);case "LeftRightArrowCallout":return new kd.a(59,43,.63,1.33);case "QuadArrowCallout":return new kd.a(61,
44,1.33,1.33);case "CircularArrow":return new kd.a(64,45,1.07,1.07);case "QuadArrow":return new kd.a(54,47,1.33,1.33);case "Rectangle":return new kd.a(4,10,1,1);case "RoundedRectangle":return new kd.a(25,11,1,1);case "RoundDiagonalCornerRectangle":return new kd.a(28,48,1,1);case "RoundSameSideCornerRectangle":return new kd.a(27,49,1,1);case "RoundSingleCornerRectangle":return new kd.a(26,50,1,1);case "SnipRoundSingleCornerRectangle":return new kd.a(29,51,1,1);case "SnipDiagonalCornerRectangle":return new kd.a(32,
52,1,1);case "SnipSameSideCornerRectangle":return new kd.a(31,53,1,1);case "SnipSingleCornerRectangle":return new kd.a(30,54,1,1);case "RectangularCallout":return new kd.a(116,91,.67,1);case "RoundedRectangleCallout":return new kd.a(117,6,.67,1);case "OvalCallout":return new kd.a(118,92,.67,1);case "CloudCallout":return new kd.a(119,93,.67,1);case "LineCallout1":return new kd.a(104,94,.67,1);case "LineCallout2":return new kd.a(105,95,.67,1);case "LineCallout3":return new kd.a(106,96,.67,1);case "LineCallout1Accent":return new kd.a(107,
97,.67,1);case "LineCallout2Accent":return new kd.a(108,98,.67,1);case "LineCallout3Accent":return new kd.a(109,99,.67,1);case "LineCallout1BorderAccent":return new kd.a(110,100,.67,1);case "LineCallout2BorderAccent":return new kd.a(111,101,.67,1);case "LineCallout3BorderAccent":return new kd.a(112,102,.67,1);case "LineCallout1NoBorder":return new kd.a(113,103,.67,1);case "LineCallout2NoBorder":return new kd.a(114,104,.67,1);case "LineCallout3NoBorder":return new kd.a(115,105,.67,1);case "Explosion1":return new kd.a(79,
106,1,1);case "Explosion2":return new kd.a(80,107,1,1);case "Star4":return new kd.a(15,108,1,1);case "Star5":return new kd.a(16,15,1,1);case "Star6":return new kd.a(17,109,1,1);case "Star7":return new kd.a(18,110,1,1);case "Star8":return new kd.a(19,111,1,1);case "Star10":return new kd.a(20,112,1,1);case "Star12":return new kd.a(21,113,1,1);case "Star16":return new kd.a(22,114,1,1);case "Star24":return new kd.a(23,115,1,1);case "Star32":return new kd.a(24,116,1,1);case "UpRibbon":return new kd.a(122,
117,.67,1.33);case "DownRibbon":return new kd.a(121,118,.67,1.33);case "CurvedUpRibbon":return new kd.a(124,119,.83,1.33);case "CurvedDownRibbon":return new kd.a(123,120,.83,1.33);case "VerticalScroll":return new kd.a(126,121,1.25,1.13);case "HorizontalScroll":return new kd.a(127,122,1.13,1.25);case "Wave":return new kd.a(128,123,1,1);case "DoubleWave":return new kd.a(129,124,1,1);case "Process":return new kd.a(131,125,.67,1);case "AlternateProcess":return new kd.a(158,126,.67,1);case "Decision":return new kd.a(132,
127,.67,1);case "Data":return new kd.a(133,128,.67,1);case "PredefinedProcess":return new kd.a(134,129,.67,1);case "InternalStorage":return new kd.a(135,130,.67,.67);case "Document":return new kd.a(136,131,.67,1);case "Multidocument":return new kd.a(137,132,.83,1.16);case "Terminator":return new kd.a(138,133,.33,1);case "Preparation":return new kd.a(139,134,.67,1.16);case "ManualInput":return new kd.a(140,135,.5,1);case "ManualOperation":return new kd.a(141,136,.67,1);case "Connector":return new kd.a(142,
137,.5,.5);case "OffpageConnector":return new kd.a(159,138,.67,.67);case "Card":return new kd.a(143,139,.88,1);case "PunchedTape":return new kd.a(144,140,.88,1);case "SummingJunction":return new kd.a(145,141,.67,.67);case "Or":return new kd.a(146,142,.67,.67);case "Collate":return new kd.a(147,143,1,.5);case "Sort":return new kd.a(148,144,1,.5);case "Extract":return new kd.a(149,145,.75,.75);case "Merge":return new kd.a(150,146,.75,.75);case "StoredData":return new kd.a(152,147,.67,1);case "Delay":return new kd.a(157,
148,.67,.67);case "SequentialActionStorage":return new kd.a(153,149,.67,.67);case "MagneticDisk":return new kd.a(154,150,.67,1);case "DirectAccessStorage":return new kd.a(155,151,.75,1);case "Display":return new kd.a(156,152,.67,1);default:return null}}}Oe.vZb=110;Oe.uZb=75;Object(k.a)(Oe,"ODSLShape",null,[875]);var Ag=d(675);class ce{constructor(bb,Vb,Ub,Jc){this.X3=bb;this.pa=Vb;this.ff=Ub;this.Fu=Jc;this.select=({scope:Mc,index:ed=-1})=>{const dd=[];let je=null!==Mc&&void 0!==Mc?Mc:"Selection";
if("Selection"===je){const Nd=this.pa.We();0<Nd.length&&dd.push(...Nd);0!==dd.length||Mc||(je="Presentation")}if("Presentation"===je&&this.Zc){Mc=this.Zc.o_.presentation.slides;if(null===Mc)throw Error("Could not cast from ISlide to ISlideNode on presentation slides.");dd.push(...Mc)}return-1!==ed&&ed<dd.length?[dd[ed]]:dd};this.i5d=Mc=>Mc?Mc.hj:this.Zc.o_.presentation.F0[0].Id;this.g5d=Mc=>{const ed=this.Zc.o_.presentation.F0;for(let dd=0;dd<ed.length;dd++)if(Mc===ed[dd].Id)return ed[dd].ContentMasters[0].Id;
return 0};this.insert=({slides:Mc})=>{if(!Mc||0===Mc.length)return[];if(!this.Zc)throw Error("Cannot insert slides without appForOfficeManager instance.");const ed=[];for(const dd of Mc)Mc=this.i5d(dd),Mc=this.Zc.o_.presentation.IXb(dd,null,Mc,this.g5d(Mc)),ed.push(Object(Sa.a)(md.a,Mc));return ed};this.delete=({slides:Mc})=>{if(!this.Zc)throw Error("Cannot delete slides without appForOfficeManager instance.");for(const ed of Mc)ed&&!this.ff.$c(ed)&&ed.isConnected&&(this.pa.Qh(),this.Zc.o_.presentation.qI(ed),
this.Fu.ljd(new Ag.a([ed])))};if(!bb)throw Error.argumentNull("m_appForOfficeManagerFuture");if(!Vb)throw Error.argumentNull("m_selectionManager");if(!Ub)throw Error.argumentNull("m_actionBlockingManager");if(!Jc)throw Error.argumentNull("m_graphOperationEventNotifier");this.X3&&this.X3.execute(Mc=>{this.Zc=Mc})}format(){throw Error("Method not implemented.");}}Object(k.a)(ce,"ODSLSlide",null,[875]);var me=d(1219),Je=d(37),ie=d(339),Tf=d(147),He=d(30),Sg=d(49);class jc{static a0f(bb,Vb,Ub){bb=this.i9i(bb,
Vb,Ub);Vb=new C.a;for(const Jc of bb)Vb.add(Sg.a.create(Jc));return Vb}static i9i(bb,Vb,Ub){const Jc=new He.GraphIterator;Jc.set(Vb);Vb=new C.a;this.QRc(bb,Jc,Ub,!1,Vb);return Vb}static QRc(bb,Vb,Ub,Jc,Mc){let ed=null;if(Vb&&(ed=Vb.Gi())){do{switch(ed.type){case 12:break;case 35:Jc&&this.QRc(bb,Vb,Ub,Jc,Mc);break;case 14:Ub&&this.QRc(bb,Vb,Ub,Jc,Mc);break;default:this.QRc(bb,Vb,Ub,Jc,Mc)}if(bb===ed.type)if(12===bb){const dd=ed;if(null===dd)throw Error("Could not cast node of NodeType.Paragraph to ParagraphNode");
dd.characterData&&!dd.I9f&&Mc.add(ed)}else Mc.add(ed)}while(ed=Vb.kp());Vb.zc()}}static Gnh(bb,Vb){for(const Ub of bb)Vb.push(...this.a0f(12,Ub,!1).toArray())}static pKb(bb,Vb,Ub){for(let Jc of Vb)Ub.push(...this.a0f(bb,Jc,14===bb).toArray())}}Object(k.a)(jc,"GraphUtils",null,[]);var be=d(545);class Md{constructor(bb,Vb,Ub,Jc,Mc,ed,dd,je,Nd,Ld){this.ua=bb;this.pa=Vb;this.Wj=Ub;this.Fa=Jc;this.Tk=Mc;this.Hu=ed;this.C0=dd;this.ff=je;this.ia=Nd;this.Hs=Ld;this.select=({scope:Xe,index:pe=-1})=>{let fe=
[],wd=[],Ue=null!==Xe&&void 0!==Xe?Xe:"Selection";if("Selection"===Ue){var rd=this.pa.Ym();rd?wd.push(rd):(rd=this.pa.We(),0<rd.length&&jc.pKb(14,rd,fe),0!=fe.length||Xe||(Ue="Presentation"))}if(Array.isArray(Ue)&&0<Ue.length&&Ue[0]instanceof md.a)jc.pKb(14,Ue,fe);else if("Presentation"===Ue&&this.ua.presentation){Xe=this.ua.presentation.slides;if(null===Xe)throw Error("Could not cast from ISlide to ISlideNode on presentation slides");jc.pKb(14,Xe,fe)}wd.push(...fe.map(Ud=>Ud.node));return-1!==pe&&
pe<wd.length?[wd[pe]]:wd};this.format=({tables:Xe,table:pe,color:fe,fillColor:wd,styles:Ue,cellColor:rd,border:Ud,borderColor:qe,mergeCells:Nf,splitCells:sf})=>{if(Xe=null!==Xe&&void 0!==Xe?Xe:pe){var tf=Lf=>{var kf;let Ed=!1;var Cd=!1,oh=!1;for(const ri of Lf){let Af=this.pa.rv();1===Lf.length&&Af&&0<Af.length?Ed=!0:Af=ri.M9a();Af.filter(Zg=>!Zg.isGhostCell);var Kg=this.wjj(null!==(kf=null!==Ue&&void 0!==Ue?Ue:wd)&&void 0!==kf?kf:fe);Kg&&0<Kg.length&&ri.setValue(Je.a.Uya,F.a.Hf(Kg));if(rd&&pf.hBf(rd)&&
!Cd){Cd=this.X8d(rd);for(const Zg of Af)Kg=Zg.cellShading,ie.b(Kg),Kg.solidFillField=Cd,Zg.cellShading=Kg;Cd=Ed&&1===Lf.length}if((Ud||qe)&&!oh){if(Ud)oh=qe&&pf.hBf(qe)?this.X8d(qe):void 0,this.ia.La(Oc.a.Koa,me.a.execute,{["TableNode"]:ri,["CellNodes"]:Af,["SourceControlId"]:this.V8a(Ud),["BorderColor"]:oh,["DoNotCreateTransaction"]:!0});else{oh=pf.nQa(qe);this.ia.La(Oc.a.B0a,me.a.execute,{["TableNode"]:ri,["Color"]:oh});oh=this.X8d(qe);for(const Zg of Af)Tf.Box4ColorHelper.V$a(Zg.lLa)||(Zg.lLa=
oh),Tf.Box4ColorHelper.V$a(Zg.gga)||(Zg.gga=oh),Tf.Box4ColorHelper.V$a(Zg.kLa)||(Zg.kLa=oh),Tf.Box4ColorHelper.V$a(Zg.hga)||(Zg.hga=oh)}oh=Ed&&1===Lf.length}(Nf||sf)&&Ed&&this.ia.La(Nf?Oc.a.mergeTableCells:Oc.a.splitTableCells,me.a.execute,{["rows"]:1,["columns"]:2})}};Xe instanceof Promise?Xe.then(Lf=>{tf(Lf)}):tf(Xe)}};this.insert=({rows:Xe,columns:pe,slides:fe})=>{if(!Xe||Number.isNaN(Xe)||!pe||Number.isNaN(pe))throw Error("Invalid rows and columns provided.");this.pa.Vx();this.pa.Qh();this.Fa.Ed();
const wd=[];for(const Ue of fe){fe=Ue.node;if(!fe)throw Error("Cannot find selected slide to insert table.");if(this.ff.$c(fe))continue;if(!this.Wj.JF(fe,1))throw this.Wj.hG(fe),Error("Too many shapes on the slide.");const rd=fe.Cb,Ud=fe.U2(rd.sid,rd.cid,0,Xe,pe,fe.Pt());this.Hs.zW([Ud],fe,null);this.Hu.NF=Ud;const qe=(Nf,sf)=>{const tf=()=>{sf&&(Nf(sf.CTc()),be.a.instance.rUk(tf))};be.a.instance.Dsf(tf);return tf};wd.push(new Promise(Nf=>qe(Nf,Ud).bind(this)))}return Promise.all(wd)};this.delete=
({tables:Xe})=>{for(var pe of Xe)Xe=this.pa.Jp(),Xe&&Xe.ud&&this.ff.$c(Xe)||(Xe=Object(Sa.a)(4,pe),this.Tk.EMc(Xe));(pe=this.ua.Ba)&&this.ff.Zv(pe,"handleDeleteTable")};if(!bb)throw Error.argumentNull("m_graphTopologyManager");if(!Vb)throw Error.argumentNull("m_selectionManager");if(!Ub)throw Error.argumentNull("m_shapeCountValidator");if(!Jc)throw Error.argumentNull("m_focusManager");if(!Mc)throw Error.argumentNull("m_shapeEditor");if(!ed)throw Error.argumentNull("m_ribbonChangeManager");if(!dd)throw Error.argumentNull("m_tableStyleGalleryManager");
if(!je)throw Error.argumentNull("m_actionBlockingManager");if(!Nd)throw Error.argumentNull("m_actionManager");if(!Ld)throw Error.argumentNull("m_transactionHelper");}Ykj(){var bb=this.pa.We();return bb&&0!=bb.length?(bb=bb[0])?bb.Ne:null:null}j4i(bb,Vb){bb=pf.l4i(bb);return(Math.abs(bb.r-Vb.r)^2)+(Math.abs(bb.g-Vb.g)^2)+(Math.abs(bb.b-Vb.b)^2)}wjj(bb){if(!bb)return"";var Vb=bb.toLowerCase();this.C0.Z_d();bb=this.C0.pQc();if(!bb||!bb.length)return"";if(Vb.includes("transparent")||Vb.includes("none")){var Ub=
bb[0].Lh(Je.a.tableStyle);return Ub.YX?Ub.YX.styleIdField:""}Vb=pf.nQa(Vb);if(!Vb.length)return"";const Jc=this.Ykj();if(!Jc)return"";let Mc=999999,ed="";for(let je=0;7>je;++je){const Nd=bb[je].Lh(Je.a.tableStyle);if(!Nd.YX)continue;var dd=null!==(Ub=Nd.YX.firstRowField)&&void 0!==Ub?Ub:Nd.YX.wholeTblField;if(!dd||!dd.tcStyleField)continue;dd=dd.tcStyleField.fillField;if(!dd||dd.noFillField)continue;let Ld;dd.solidFillField?Ld=Tf.Box4ColorHelper.LJ(Tf.Box4ColorHelper.Doa(dd.solidFillField),Jc):dd.gradFillField&&
(Ld=ie.f(dd.gradFillField,Jc).stops[0].color);Ld&&(dd=this.j4i(Vb,Ld),dd<=Mc&&(Mc=dd,ed=Nd.YX.styleIdField))}return ed}X8d(bb){const Vb={};Vb.Color=pf.nQa(bb);return Tf.Box4ColorHelper.oV(Vb)}V8a(bb){bb=bb.toLowerCase();if(bb.includes("no"))return"TableBordersNoBorder";if(!bb.includes("all")){if(bb.includes("outside"))return"TableBordersOutsideBorders";if(bb.includes("horizontal"))return"TableBordersInsideHorizontalBorder";if(bb.includes("vertical"))return"TableBordersInsideVerticalBorder";if(bb.includes("inside"))return"TableBordersInsideBorders";
if(bb.includes("top"))return"TableBordersTopBorder";if(bb.includes("bottom"))return"TableBordersBottomBorder";if(bb.includes("left"))return"TableBordersLeftBorder";if(bb.includes("right"))return"TableBordersRightBorder";if(bb.includes("up"))return"TableBordersDiagonalUpBorder";if(bb.includes("down"))return"TableBordersDiagonalDownBorder";if(bb.includes("diagonal"))return"TableBordersDiagonalUpBorder"}return"TableBordersAllBorders"}}Object(k.a)(Md,"ODSLTable",null,[875]);var de=d(31),Zc=d(39),Yf=d(90),
Vc=d(181),zc=d(993);class vf{constructor(bb,Vb,Ub,Jc,Mc,ed,dd){this.X3=bb;this.pa=Vb;this.ki=Ub;this.Gva=Jc;this.Ea=Mc;this.gJ=ed;this.cJ=dd;this.select=({scope:je,text:Nd,index:Ld=-1})=>{const Xe=[];let pe=[];var fe=null!==je&&void 0!==je?je:"Selection";if("Selection"===fe){var wd=this.pa.Pa.mb;wd?(wd=wd.toArray().filter(Ue=>de.ParagraphReader.Yd(Ue.node)),0<wd.length?Xe.push(...wd):(wd=this.pa.Xd(),0<wd.length&&jc.Gnh(wd,Xe))):jc.pKb(12,this.pa.We(),Xe);0!==Xe.length||je||(fe="Presentation")}if(Array.isArray(fe)&&
0<fe.length&&fe[0]instanceof md.a)jc.pKb(12,fe,Xe);else if(Array.isArray(fe)&&0<fe.length&&fe[0]instanceof zc.a)jc.Gnh(fe,Xe);else if("Presentation"===fe&&this.Zc){je=this.Zc.o_.presentation.slides;if(null===je)throw Error("Could not cast from ISlide to ISlideNode on presentation slides.");jc.pKb(12,je,Xe)}if(Nd)for(const Ue of Xe){je=de.ParagraphReader.text(Ue.node);je=this.matchAll(je,Nd);for(const rd of je)rd[0]&&void 0!==rd.index&&(je=rd.index,fe=rd.index+rd[0].length,wd=Sg.a.Kj(Ue.node,je),this.cJ.ZXe(wd),
wd=Sg.a.Kj(Ue.node,fe+1),this.cJ.ZXe(wd),pe.push(Sg.a.createTextRange(Ue.node,je,fe)))}else pe=Xe;-1!==Ld&&Ld<Xe.length&&(pe=[pe[Ld]]);return pe};this.O4k=(je,Nd)=>{const Ld=new He.GraphIterator;Ld.set(je);Ld.rc(11);Ld.Ng(11);je=je.Sf.fw(Ld);const Xe=Nd?1:16;Nd=Nd?1:0;je?je.mya(Xe,Nd):(Nd=Vc.a.pN(Xe,Nd),this.gJ.xPa(Ld,Nd))};this.z6k=(je,Nd)=>{switch(Nd){case "Left":Nd=1;break;case "Center":Nd=2;break;case "Right":Nd=3;break;case "Distributed":Nd=7;break;case "Justify":Nd=6;break;default:Nd=1}this.Gva.RJ(je,
Nd)};this.L$k=(je,Nd)=>{if(je=this.Ea.Zm(je)){switch(Nd){case "Top":Nd=0;break;case "Middle":Nd=1;break;case "Bottom":Nd=2;break;default:Nd=0}je.setValue(Je.a.hP,Nd)}};this.format=({textRanges:je,color:Nd,bold:Ld,italic:Xe,underline:pe,fontName:fe,size:wd,bulleted:Ue,horizontalAlignment:rd,verticalAlignment:Ud})=>{if(je&&0<je.length)for(const qe of je){je=[];if(qe.contextId===Zc.a.paragraph){const Nf=Yf.a.hXf(qe.node,!1);for(const sf of Nf)je.push(sf.formatting)}else je.push(Yf.a.ps(qe));for(const Nf of je)Nf&&
(Nd&&(je=pf.nQa(Nd),Nd=""===je?Nd:je,this.ki.Ls(Nf,Nd,null)),void 0!==Ld&&this.ki.GH(Nf,Ld),void 0!==Xe&&this.ki.setItalic(Nf,Xe),pe&&this.ki.JY(Nf,"None"!==pe),fe&&this.ki.TU(Nf,fe),void 0!==wd&&this.ki.ir(Nf,2*wd),void 0!==Ue&&this.O4k(qe.node,Ue),rd&&this.z6k(qe.node,rd),Ud&&this.L$k(qe.node,Ud))}};this.insert=({precededBy:je,text:Nd})=>{const Ld=[];for(const Xe of je){je=Xe.node;const pe=Sg.a.Kj(je,Xe.Nb+1);this.cJ.replaceTextRange(pe,Nd,!0);je=Sg.a.createTextRange(je,Xe.Nb+1,Xe.Nb+Nd.length);
Ld.push(je)}return Ld};this.delete=({textRanges:je})=>{for(const Nd of je)this.cJ.replaceTextRange(Nd,"",!0)};if(!bb)throw Error.argumentNull("m_appForOfficeManagerFuture");if(!Vb)throw Error.argumentNull("m_selectionManager");if(!Ub)throw Error.argumentNull("m_formattingEditor");if(!Jc)throw Error.argumentNull("m_paragraphEditor");if(!Mc)throw Error.argumentNull("m_shapeReader");if(!ed)throw Error.argumentNull("m_listEditor");if(!dd)throw Error.argumentNull("m_characterPropertiesEditor");this.X3&&
this.X3.execute(je=>{this.Zc=je})}matchAll(bb,Vb){Vb=Vb instanceof RegExp?Vb:new RegExp(Vb,"g");const Ub=[];let Jc;for(;null!==(Jc=Vb.exec(bb));)Ub.push(Jc);return Ub}}Object(k.a)(vf,"ODSLText",null,[875]);class Tg extends pc{constructor(){super()}get name(){return"Ppt.SmartLookup"}init(){r.AFrameworkApplication.Eya&&this.MNi()}$b(bb){super.$b(bb);bb.register(od.a,"Box4.Insights.Box4InsightsSelection").as("Common.App.Insights.IInsightsSelection").as("Box4.Insights.IBox4InsightsSelection").ma().oa(()=>
new od.a);bb.register(db,"PowerPointWebEditor.SmartLookup.SmartLookupManager").as("Common.App.Insights.IInsightsManager").ma().oa(()=>new db(bb.resolve("Common.App.Insights.IInsightsSelection"),bb,bb.resolve("Common.IAppSettingsManager"),bb.resolve("Common.IActionManagerExtended"),bb.Ja("PowerPointWebEditor.IAppForOfficeManager")));bb.register(806,"Common.App.SearchCommon.IDocumentContentExecutor").as("Common.App.SearchCommon.IDocumentContentExecutor").ma().oa(()=>new Ab.a(new e.a(()=>fc.App.Kb?fc.App.Kb.Jd.yi:
null),bd.InteractiveViewManager.instance,bb.resolve("Box4.ISelectionFactory"),bb.resolve("PowerPointWebEditor.ISlideReader"),bb.resolve("PowerPointWebEditor.IPPTWorkspace"),bb.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),new n.a,bb.resolve("Common.IActionManagerExtended"),bb.resolve("PowerPointWebEditor.IPptSelectionManager"),bb.resolve("PowerPointWebEditor.IClipServiceManager"),bb.resolve("PowerPointWebEditor.IPresentationReader")));r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletEnableHALO",
!1)&&(bb.register(vf,"PowerPointWebEditor.SmartLookup.ODSLBox4.PowerPoint.Entities.ODSLText").as("PowerPointWebEditor.SmartLookup.ODSLBox4.PowerPoint.Entities.ODSLText").ma().oa(()=>new vf(bb.Ja("PowerPointWebEditor.AppForOfficeManager"),bb.resolve("PowerPointWebEditor.IPptSelectionManager"),bb.resolve("Box4.IFormattingEditor"),bb.resolve("Box4.IParagraphEditor"),bb.resolve("PowerPointWebEditor.IShapeReader"),bb.resolve("Box4.List.IListEditor"),bb.resolve("Box4.ICharacterPropertiesEditor"))),bb.register(Oe,
"PowerPointWebEditor.SmartLookup.ODSLBox4.PowerPoint.Entities.ODSLShape").as("PowerPointWebEditor.SmartLookup.ODSLBox4.PowerPoint.Entities.ODSLShape").ma().oa(()=>new Oe(bb.Ja("PowerPointWebEditor.AppForOfficeManager"),bb.resolve("PowerPointWebEditor.IPptSelectionManager"),bb.resolve("PowerPointWebEditor.ShapeEdit.IShapeCountValidator"),bb.resolve("PowerPointWebEditor.ShapeSVG.IShapeSVGDependencyLoader"),bb.resolve("PowerPointWebEditor.IInsertShapeOverlayViewStateManager"),bb.resolve("PowerPointWebEditor.IShapeReader"),
bb.resolve("PowerPointWebEditor.IShapeEditor"),bb.resolve("PowerPointWebEditor.IPPTUnitConversion"),bb.resolve("PowerPointWebEditor.View.IPPTPageView"),bb.resolve("PowerPointWebEditor.IGraphTransactionHelper"),bb.resolve("PowerPointWebEditor.IRibbonChangeManager"))),bb.register(ce,"PowerPointWebEditor.SmartLookup.ODSLBox4.PowerPoint.Entities.ODSLSlide").as("PowerPointWebEditor.SmartLookup.ODSLBox4.PowerPoint.Entities.ODSLSlide").ma().oa(()=>new ce(bb.Ja("PowerPointWebEditor.AppForOfficeManager"),
bb.resolve("PowerPointWebEditor.IPptSelectionManager"),bb.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),bb.resolve("PowerPointWebEditor.Graph.IGraphOperationEventNotifier"))),bb.register(Fc,"PowerPointWebEditor.SmartLookup.ODSLBox4.PowerPoint.Entities.ODSLImage").as("PowerPointWebEditor.SmartLookup.ODSLBox4.PowerPoint.Entities.ODSLImage").ma().oa(()=>new Fc(bb.Ja("PowerPointWebEditor.AppForOfficeManager"),bb.resolve("PowerPointWebEditor.IPptSelectionManager"))),bb.register(vf,
"PowerPointWebEditor.SmartLookup.ODSLBox4.PowerPoint.Entities.ODSLText").as("PowerPointWebEditor.SmartLookup.ODSLBox4.PowerPoint.Entities.ODSLText").ma().oa(()=>new vf(bb.Ja("PowerPointWebEditor.AppForOfficeManager"),bb.resolve("PowerPointWebEditor.IPptSelectionManager"),bb.resolve("Box4.IFormattingEditor"),bb.resolve("Box4.IParagraphEditor"),bb.resolve("PowerPointWebEditor.IShapeReader"),bb.resolve("Box4.List.IListEditor"),bb.resolve("Box4.ICharacterPropertiesEditor"))),bb.register(Oe,"PowerPointWebEditor.SmartLookup.ODSLBox4.PowerPoint.Entities.ODSLShape").as("PowerPointWebEditor.SmartLookup.ODSLBox4.PowerPoint.Entities.ODSLShape").ma().oa(()=>
new Oe(bb.Ja("PowerPointWebEditor.AppForOfficeManager"),bb.resolve("PowerPointWebEditor.IPptSelectionManager"),bb.resolve("PowerPointWebEditor.ShapeEdit.IShapeCountValidator"),bb.resolve("PowerPointWebEditor.ShapeSVG.IShapeSVGDependencyLoader"),bb.resolve("PowerPointWebEditor.IInsertShapeOverlayViewStateManager"),bb.resolve("PowerPointWebEditor.IShapeReader"),bb.resolve("PowerPointWebEditor.IShapeEditor"),bb.resolve("PowerPointWebEditor.IPPTUnitConversion"),bb.resolve("PowerPointWebEditor.View.IPPTPageView"),
bb.resolve("PowerPointWebEditor.IGraphTransactionHelper"),bb.resolve("PowerPointWebEditor.IRibbonChangeManager"))),bb.register(ce,"PowerPointWebEditor.SmartLookup.ODSLBox4.PowerPoint.Entities.ODSLSlide").as("PowerPointWebEditor.SmartLookup.ODSLBox4.PowerPoint.Entities.ODSLSlide").ma().oa(()=>new ce(bb.Ja("PowerPointWebEditor.AppForOfficeManager"),bb.resolve("PowerPointWebEditor.IPptSelectionManager"),bb.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),bb.resolve("PowerPointWebEditor.Graph.IGraphOperationEventNotifier"))),
bb.register(Fc,"PowerPointWebEditor.SmartLookup.ODSLBox4.PowerPoint.Entities.ODSLImage").as("PowerPointWebEditor.SmartLookup.ODSLBox4.PowerPoint.Entities.ODSLImage").ma().oa(()=>new Fc(bb.Ja("PowerPointWebEditor.AppForOfficeManager"),bb.resolve("PowerPointWebEditor.IPptSelectionManager"))),bb.register(Md,"PowerPointWebEditor.SmartLookup.ODSLBox4.PowerPoint.Entities.ODSLTable").as("PowerPointWebEditor.SmartLookup.ODSLBox4.PowerPoint.Entities.ODSLTable").ma().oa(()=>new Md(bb.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
bb.resolve("PowerPointWebEditor.IPptSelectionManager"),bb.resolve("PowerPointWebEditor.ShapeEdit.IShapeCountValidator"),bb.resolve("PowerPointWebEditor.IFocusManager"),bb.resolve("PowerPointWebEditor.IShapeEditor"),bb.resolve("PowerPointWebEditor.IRibbonChangeManager"),bb.resolve("PowerPointWebEditor.ITableStyleGalleryManager"),bb.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),bb.resolve("Common.IActionManagerExtended"),bb.resolve("PowerPointWebEditor.IGraphTransactionHelper"))),
bb.register(ic,"PowerPointWebEditor.SmartLookup.ODSLBox4.PowerPoint.ODSLInterpreter").as("PowerPointWebEditor.SmartLookup.ODSLBox4.PowerPoint.IODSLInterpreter").ma().oa(()=>new ic(bb.Ja("PowerPointWebEditor.AppForOfficeManager"),bb.resolve("Common.Transaction.ITransactionFactory"),bb.resolve("PowerPointWebEditor.SmartLookup.ODSLBox4.PowerPoint.Entities.ODSLText"),bb.resolve("PowerPointWebEditor.SmartLookup.ODSLBox4.PowerPoint.Entities.ODSLShape"),bb.resolve("PowerPointWebEditor.SmartLookup.ODSLBox4.PowerPoint.Entities.ODSLSlide"),
bb.resolve("PowerPointWebEditor.SmartLookup.ODSLBox4.PowerPoint.Entities.ODSLImage"),bb.resolve("PowerPointWebEditor.SmartLookup.ODSLBox4.PowerPoint.Entities.ODSLTable"))));bb.register(807,"Common.App.SearchCommon.ISerpletExecutor").as("Common.App.SearchCommon.ISerpletExecutor").ma().oa(()=>new Bd(bb.resolve("Common.IActionManagerExtended"),bb.rb("PowerPointWebEditor.SmartLookup.ODSLBox4.PowerPoint.IODSLInterpreter")));bb.register(808,"Common.App.SearchCommon.IInsertContentExecutor").as("Common.App.SearchCommon.IInsertContentExecutor").ma().oa(()=>
new Wb(r.AFrameworkApplication.Ta,bb.resolve("PowerPointWebEditor.IPptSelectionManager"),bb.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager")));bb.register(809,"Common.App.SearchCommon.IDocumentHelper").ma().oa(()=>new Pd);r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.CopilotUxIsEnabled",!1)&&(bb.register(qd,"PowerPointWebEditor.SmartLookup.PptCopilot").as("PowerPointWebEditor.SmartLookup.PptCopilot").ma().oa(()=>new qd(bb.resolve("PowerPointWebEditor.IPPTWorkspace"),
bb.resolve("Common.IActionManagerExtended"),bb.Ja("Common.App.Insights.InsightsActor"))),bb.resolve("PowerPointWebEditor.SmartLookup.PptCopilot"))}static main(){v.a.instance.Dc(new Tg)}}Object(k.a)(Tg,"PptSmartLookupPackage",pc,[]);Type.registerNamespace("PowerPointWebEditor.SmartLookup");Tg.main()}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/18430998/wdjs/ppteditDS.smartlookup.js.map