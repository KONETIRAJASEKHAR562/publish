'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[5],{1023:function(K,Z,d){K=d(0);var k;(function(n){n[n.multipleBrowsersImageClassName=0]="multipleBrowsersImageClassName";n[n.peopleImageClassName=1]="peopleImageClassName";n[n.peopleImageClusterPath=4]="peopleImageClusterPath";n[n.multipleBrowserImageClusterPath=5]="multipleBrowserImageClusterPath";n[n.imageDimension=6]="imageDimension";n[n.rtl=8]="rtl";n[n.pointerInputManager=9]="pointerInputManager";n[n.clickInputManager=
10]="clickInputManager";n[n.vertical=11]="vertical";n[n.zIndex=12]="zIndex";n[n.contextMenuInputManager=13]="contextMenuInputManager";n[n.imageDomElement=14]="imageDomElement";n[n.useIdleTooltip=15]="useIdleTooltip";n[n.viewportBoundsCallback=16]="viewportBoundsCallback";n[n.flipHorizontalDirection=17]="flipHorizontalDirection";n[n.fixRemoveFadeOutElementCrash=18]="fixRemoveFadeOutElementCrash";n[n.ignoreEventOnExpandedTooltip=19]="ignoreEventOnExpandedTooltip";n[n.ipWidthAdjustForFlyout=20]="ipWidthAdjustForFlyout"})(k||
(k={}));Object(K.b)("PresenceTooltipSettingKeys",k);d.d(Z,"a",function(){return e});class e{constructor(){this.Hy={}}get(n,r=null){n=k[n];return"number"===typeof r?(r=this.Hy[n])?Number.parseInvariant(r.toString()):0:this.Hy[n]}add(n,r){this.Hy[k[n]]=r}FD(n,r){k[n]in this.Hy||(this.Hy[k[n]]=r)}remove(n){delete this.Hy[k[n]]}}Object(K.a)(e,"PresenceTooltipSettings",null,[])},1117:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k{}k.mah="WAC_Powerpoint";k.r7b=null;Object(K.a)(k,"AddinHostApp",
null,[])},1130:function(K,Z,d){K=d(0);var k=d(13),e=d(1186),n=d(234),r=d(235),v=d(65),C=d(95);class w extends n.a{constructor(R,Q){super(R);this.Bf=null;this.fI=Q.get(8,!1);this.$R=Q.get(6,0);this.element=R;this.element.className=w.z8a;this.h5a=this.createElement("ul");this.element.appendChild(this.h5a);this.Jn=Q.get(10);this.Jn.pb(v.a.click,this.element,Object(k.a)(this,this.onClick,"onClick"));this.Yo=Q.get(9);this.Yo.pb(v.a.pointerOut,this.element,Object(k.a)(this,this.pz,"onPointerOut"));this.Yo.pb(v.a.pointerDown,
this.element,Object(k.a)(this,this.Kx,"stopPropagationAndPreventDefaultBehavior"));this.UM=Q.get(13);this.UM.pb(this.element,Object(k.a)(this,this.Kx,"stopPropagationAndPreventDefaultBehavior"))}aW(R){this.addHandler(r.a.lp,R)}Z0(R){this.removeHandler(r.a.lp,R)}get Maa(){return this.Bf}dispose(){this.element&&(this.Jn.yb(v.a.click,this.element,Object(k.a)(this,this.onClick,"onClick")),this.Yo.yb(v.a.pointerDown,this.element,Object(k.a)(this,this.Kx,"stopPropagationAndPreventDefaultBehavior")),this.Yo.yb(v.a.pointerOut,
this.element,Object(k.a)(this,this.pz,"onPointerOut")),this.UM.yb(this.element,Object(k.a)(this,this.Kx,"stopPropagationAndPreventDefaultBehavior")));super.dispose()}hide(){this.visible=!1}show(R,Q,W){this.hide();!R||0>=R.length||(this.fI?this.element.style.right=Q+"px":this.element.style.left=Q+"px",this.element.style.top=W+"px",this.NNd(R),this.visible=!0)}NNd(R){this.Bf=R;C.a.tu(this.h5a);for(let Q=R.length-1;0<=Q;Q--)this.Rx(R[Q])}Rx(R){const Q=document.createElement("li");Q.style.backgroundColor=
R.color;Q.style.height=this.$R+"px";Q.id="fly_"+R.clientId;Q.style.lineHeight=this.$R+"px";C.a.Ix(Q,R.userName);Q.setAttribute("dir","auto");this.h5a.appendChild(Q)}onClick(){this.hide();return!1}pz(R){this.raiseEvent(r.a.lp,new r.a(3,R));return!1}}w.z8a="prFlyout UIFont";Object(K.a)(w,"PresenceTooltipFlyoutControl",n.a,[]);var z=d(73);class A extends n.a{constructor(R,Q,W){super(R);this.ZM=null;this.Bf=[];this.element.className="prGlyph";this.Jc=Q;this.h7=this.Jc.get(9);this.vn=this.Jc.get(10);this.UM=
this.Jc.get(13);this.obe();this.Rx(W);this.i3a=!1}get NO(){return this.Bf.length}get Maa(){return this.Bf}aW(R){this.addHandler(r.a.lp,R)}Z0(R){this.removeHandler(r.a.lp,R)}dispose(){this.b2e();super.dispose()}Rx(R){Array.add(this.Bf,R);2===this.NO?this.Jaa(!0):1===this.NO?this.Jaa(!1):this.Jaa(this.i3a)}JJ(R){this.a2d(R)&&(1<this.NO&&this.Jaa(!0),1===this.NO?this.Jaa(!1):1>this.NO&&this.hide())}show(){this.Jaa(2<=this.NO);this.visible=!0}hide(){this.visible=!1}m6d(R){return R?this.y4b(0,5):this.y4b(1,
4)}a2d(R){for(let Q=0;Q<this.NO;Q++)if(this.Bf[Q].clientId===R)return R=this.Bf[Q],Array.removeAt(this.Bf,Q),R;return null}Jaa(R){this.i3a!==R&&(this.ZM&&this.element.removeChild(this.ZM),this.ZM=this.m6d(R),this.element.appendChild(this.ZM),this.i3a=R);this.ZM.childNodes[0].style.backgroundColor=this.Bf[this.Bf.length-1].color}y4b(R,Q){const W=this.Jc.get(6,0),O=this.Jc.get(14);return z.createClusteredImageFromClusterWithImageClass(W,W,this.Jc.get(R),this.Jc.get(Q),"cui-img-cont-float cui-img-16by16",
"",!1,"",this.element.ownerDocument,O?O.cloneNode(!0):null)}WC(R){3!==R.Yf&&this.raiseEvent(r.a.lp,new r.a(2,R));return!1}onClick(R){this.raiseEvent(r.a.lp,new r.a(1,R));return!0}pz(R){3!==R.Yf&&this.raiseEvent(r.a.lp,new r.a(3,R));return!1}b2e(){this.element&&(this.h7.yb(v.a.pointerDown,this.element,Object(k.a)(this,this.Kx,"stopPropagationAndPreventDefaultBehavior")),this.h7.yb(v.a.pointerOver,this.element,Object(k.a)(this,this.WC,"onPointerOver")),this.h7.yb(v.a.pointerOut,this.element,Object(k.a)(this,
this.pz,"onPointerOut")),this.vn.yb(v.a.doubleClick,this.element,Object(k.a)(this,this.Kx,"stopPropagationAndPreventDefaultBehavior")),this.vn.yb(v.a.click,this.element,Object(k.a)(this,this.onClick,"onClick")),this.UM.yb(this.element,Object(k.a)(this,this.Kx,"stopPropagationAndPreventDefaultBehavior")))}obe(){this.element&&(this.h7.pb(v.a.pointerDown,this.element,Object(k.a)(this,this.Kx,"stopPropagationAndPreventDefaultBehavior")),this.h7.pb(v.a.pointerOver,this.element,Object(k.a)(this,this.WC,
"onPointerOver")),this.h7.pb(v.a.pointerOut,this.element,Object(k.a)(this,this.pz,"onPointerOut")),this.vn.pb(v.a.doubleClick,this.element,Object(k.a)(this,this.Kx,"stopPropagationAndPreventDefaultBehavior")),this.vn.pb(v.a.click,this.element,Object(k.a)(this,this.onClick,"onClick")),this.UM.pb(this.element,Object(k.a)(this,this.Kx,"stopPropagationAndPreventDefaultBehavior")))}}Object(K.a)(A,"PresenceTooltipGlyph",n.a,[]);var u=d(116);d(63);var E=d(199);class H extends n.a{constructor(R,Q,W){super(R);
this.Bf=[];this.gm=[];this.cI=0;this.Sha=this.P6=!1;this.rPb=null;this.iha={};this.Jc=W;this.Vi=W.get(8,!1);this.wG=W.get(11,!1);R=W.get(12,0);this.imageDimension=W.get(6,0);this.K4a=Q;this.element.id=H.M8a();this.element.className=n.a.ytb("prControl",this.Vi);R&&(this.zIndex=R);this.rtl=this.Vi;this.hjb(Q);this.Cz=this.createElement("div");this.Cz.className=this.wG?"prContainerV":"prContainerHr";this.element.appendChild(this.Cz);this.LRb=Array(this.cI);for(Q=0;Q<this.cI;Q++)this.ew[Q]=new w(this.createElement("div"),
this.Jc),this.ew[Q].aW(Object(k.a)(this,this.aG,"onInteractivityChanged")),this.element.appendChild(this.ew[Q].element)}get nhb(){return E.a.clone(this.Bf)}getGlyph(R){return this.iha[R]}get ew(){return this.LRb}get vXb(){return this.rPb}get bLa(){return this.imageDimension+2}get width(){return this.wG?this.bLa:this.K4a}get height(){return this.wG?this.K4a:this.bLa}aW(R){this.addHandler(r.a.lp,R)}Z0(R){this.removeHandler(r.a.lp,R)}dispose(){if(this.ew)for(const R of this.ew)R.Z0(Object(k.a)(this,
this.aG,"onInteractivityChanged")),u.a.Fx(R);u.a.Rld(this.gm);this.gm=this.LRb=null;super.dispose()}Wfa(){this.JN();this.Vjb();this.visible=!0;this.P6=!1}Xjb(){!this.gm||1>this.gm.length||(this.JN(),this.visible=!0,this.Vjb(),this.tJa(this.gm[this.gm.length-1]),this.P6=!0)}xya(){if(this.gm&&!(1>this.gm.length)){this.visible=!0;this.Vjb();var R=0;for(const Q of this.gm)this.tJa(Q,R++);this.P6=!1;this.Sha=!0}}hide(){this.visible=!1;this.JN();for(let R=0;R<this.gm.length;R++)this.gm[R].hide();this.P6=
!1}a_b(){if(!this.Sha)return!1;let R=0;for(const Q of this.ew)Q.visible&&R++;return this.Sha=0<R&&(this.Bf.length<=this.cI?R===this.Bf.length:R===this.cI)}Rx(R){if(!(0>=this.cI)){R.clientId||(R.clientId=(H.pha++).toString());if(R.clientId in this.iha){var Q=this.YS(R.clientId);if(0<=Q){Q=this.Bf[Q];if(Q.color===R.color&&Q.userName===R.userName)return;this.JJ(R.clientId)}}Q=this.a_b();var W=0;if(this.Bf.length<this.cI){var O=new A(this.createElement("div"),this.Jc,R);O.aW(Object(k.a)(this,this.aG,
"onInteractivityChanged"));this.Vi&&!this.wG&&0<this.Bf.length?this.Cz.insertBefore(O.element,this.Cz.firstChild):(this.Cz.appendChild(O.element),W=this.gm.length);Array.add(this.gm,O)}else this.Vi&&!this.wG?O=this.gm[0]:(W=this.gm.length-1,O=this.gm[W]),O.Rx(R);O.show();this.iha[R.clientId]=O;Array.add(this.Bf,R);this.Btc(O,W);Q&&this.xya()}}JJ(R){const Q=this.a_b();Q&&this.JN();this.Tna(R);this.Bf.length>=this.cI&&this.gm.length<this.cI&&this.FNe();0>=this.Bf.length?this.hide():Q&&this.xya()}Ufb(){}Tna(R){var Q=
this.YS(R);0>Q||(R=this.Bf[Q],Array.removeAt(this.Bf,Q),Q=this.iha[R.clientId],delete this.iha[R.clientId],Q.JJ(R.clientId),this.Btc(Q),0>=Q.NO&&(this.Cz.removeChild(Q.element),Array.remove(this.gm,Q),Q.dispose()))}Djb(){}FNe(){var R=this.w7d();!R||1>=R.Maa.length||(R=Array.clone(this.Bf),R.forEach(Q=>{this.Tna(Q.clientId)}),R.forEach(Q=>{this.Rx(Q)}))}YS(R){for(let Q=0;Q<this.Bf.length;Q++)if(this.Bf[Q].clientId===R)return Q;return-1}w7d(){return this.Vi&&!this.wG?this.gm[0]:this.gm[this.gm.length-
1]}position(R,Q){this.element.style.top=Q+"px";this.element.style.left=R+"px"}Vjb(){for(let R=0;R<this.gm.length;R++)this.gm[R].show()}JN(){for(let R=0;R<this.cI;R++)this.ew[R].hide();this.Sha=!1}tJa(R,Q=0){if(R)if(this.rPb=R,this.wG){const W=this.imageDimension;if(1<R.Maa.length)this.ew[Q].show(R.Maa,W,this.height-this.imageDimension);else{const O=this.Cz.children.length;for(let Y=0;Y<this.Cz.children.length;Y++)R.element===this.Cz.children[Y]&&this.ew[Q].show(R.Maa,W,this.height-(O-Y)*this.bLa+
2)}}else this.ew[Q].show(R.Maa,this.width,0)}aG(R,Q){var W=Object(e.a)(A,R);W=W?this.o3b(W):-1;if(2===Q.type||1===Q.type&&-1!==W&&!this.ew[W].visible)this.tJa(R);else if(1===Q.type)this.JN(),this.P6=!1;else if(3===Q.type){if(this.S2b(Q.Yi))return;this.P6||this.JN()}this.raiseEvent(r.a.lp,Q)}S2b(R){R=H.A9a(R);let Q=!1;for(const W of this.ew)if(C.a.Zta(W.element,R)){Q=!0;break}return this.Cz!==R&&C.a.Zta(this.Cz,R)||Q}Btc(R,Q=0){const W=this.Pge(R);W&&0>=R.NO?this.ew[Q].hide():W?this.tJa(R):this.ew[Q].hide()}o3b(R){let Q=
0;for(const W of this.gm){if(R===W)return Q;Q++}return-1}Pge(R){const Q=this.o3b(R);return!!this.vXb&&R===this.vXb&&-1!==Q&&this.ew[Q].visible}hjb(R){this.cI=R===this.imageDimension?1:Math.floor(R/this.bLa);this.wG?(this.element.style.height=R+"px",this.element.style.width=this.imageDimension+"px"):(this.element.style.width=R+"px",this.element.style.height=this.imageDimension+"px")}static M8a(){return String.format("{0}-{1}","presencetooltip",H.pha++)}static A9a(R){R=R.pc.rawEvent;return R.relatedTarget||
R.toElement}}H.pha=0;Object(K.a)(H,"PresenceTooltipControl",n.a,[430,106]);var I=d(223),J=d(286),T=d(265);d.d(Z,"a",function(){return D});class D{constructor(R){this.Jc=R;this.Jc.FD(10,I.a.instance);this.Jc.FD(9,T.a.instance);this.Jc.FD(6,16);this.Jc.FD(13,J.a.instance)}MKc(R,Q){return new H(R,Q,this.Jc)}rtb(R){return new H(R,16,this.Jc)}}Object(K.a)(D,"PresenceTooltipFactory",null,[429])},1144:function(K,Z,d){K=d(0);class k{}k.taskPaneWidth=330;Object(K.a)(k,"AppsForOfficeConstants",null,[]);d.d(Z,
"a",function(){return e});class e{constructor(){this.pW=null;this.resizeMaxWidth=this.resizeMinWidth=0;this.dialogWidth=this.dialogHeight=this.oMc=this.dialogTop=this.tMc=this.dialogLeft=null;this.taskPaneWidth=k.taskPaneWidth;this.TE=this.sourceLocationOverrideResourceId=null;this.nonPersistedSettings={};this.onTaskPaneClose=null;this.isResizable=this.isModernPane=!1;this.sharedRuntimeId=null;this.isPaneAutoOpened=this.isPreload=!1;this.uMc=this.qMc=!0}}Object(K.a)(e,"FirstPartyAddInOptionalParameters",
null,[])},1219:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);var k;(function(e){e[e.isEnabled=1]="isEnabled";e[e.execute=2]="execute";e[e.animation=3]="animation"})(k||(k={}));Object(K.b)("ActionBehavior",k)},1220:function(K,Z,d){d.d(Z,"a",function(){return C});K=d(0);var k=d(80),e=d(119),n=d(25),r=d(93),v=d(218);class C extends k.a{constructor(w,z=!1){super(w,!1,z)}get Vyb(){return!1}get aL(){return v.a.C1b+"/modeless"}get bAb(){return null}set bAb(w){}get Yzb(){return null}set Yzb(w){}$i(w,
z=null,A=null){this.DK&&(A.isModal=!1);super.$i(w,z,A)}hide(){if(n.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.HideReactModelessDialogEnabled")||this.Gb)this.kGh(),n.AFrameworkApplication.Aa.Jw.Ho(e.AFrame.i5),super.hide()}J4h(){const w=n.AFrameworkApplication.Aa.Jw,z=n.AFrameworkApplication.Aa.Rr;w.w2(this.aL);w.Yqa(this.aL);z.Gc(this.aL).parent=e.AFrame.nj}Zqa(){r.FocusManager.KM()&&(super.Zqa(),this.J4h(),n.AFrameworkApplication.Aa.Jw.EK(e.AFrame.i5))}dib(){if(r.FocusManager.KM()&&
!n.AFrameworkApplication.Tg){const w=r.FocusManager.instance();w.x5(this.aL);const z=w.rQ(this.aL);z&&z.uj.VE(null);w.wJb(this.aL)}}aaa(){"DL"===this.Rqa||"DP"===this.Rqa?super.aaa():n.AFrameworkApplication.fa&&n.AFrameworkApplication.fa.ka("WacAutoFitNonModalDialogIsEnabled")?(this.kGh(),this.Uwf()&&this.Uvh(this.Gb.clientHeight,this.Gb.clientWidth)):this.tA()}tA(){this.Uvh(k.a.s8e,k.a.v8e)}Uvh(w,z){if(this.Yzb&&this.bAb){let A,u;A=v.a.jlc+this.bAb;u=v.a.ilc+this.Yzb;A+w>this.Qja()&&(A=this.Qja()-
w);u+z>this.mta()&&(u=this.mta()-z);this.Npd(A,u)}else super.tA()}p7d(w){if(!w)return null;w.endsWith("px")&&(w=w.substring(0,w.length-2));return v.a.bzb(w)?((w=parseInt(w))||(w=1),w):null}kGh(){if(this.Gb&&this.Gb.style){var w=this.p7d(this.Gb.style.top);w&&(this.bAb=w-v.a.jlc);if(w=n.AFrameworkApplication.isRtl?this.p7d(this.Gb.style.right):this.p7d(this.Gb.style.left))this.Yzb=w-v.a.ilc}}}Object(K.a)(C,"ModelessCustomDialog",k.a,[])},1223:function(K,Z,d){d.r(Z);var k=d(0),e=d(382),n=d(1187),r=
d(1188),v=d(13),C=d(1186),w;(function(f){f[f.applicationFeatureHelperHandler=0]="applicationFeatureHelperHandler";f[f.cloudPolicySettings=1]="cloudPolicySettings";f[f.alternateAuthToken=2]="alternateAuthToken"})(w||(w={}));Object(k.b)("ApplicationFeatureHelperRequestType",w);class z{constructor(){this.message=null;this.tv=0}}Object(k.a)(z,"HttpRequstToPromiseRejectData",null,[]);var A=d(94),u=d(78),E=d(174),H=d(45);class I{constructor(f,x){this.$a=f;this.ei=x}B0b(f,x,N,ea=null,ma=null,Ha=null,Ua=
null,mb=null){const gb=w[N],Cb=gb+"RequestFailure";A.Health.instance.recordKpiUsage(Cb,0,"jpittsdirects",null);return new Promise((zb,Pb)=>{e.ULS.sendTraceTag(50622688,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: Initializing HttpRequest {0}.",gb);const oc=null!=Ua?Ua:this.$a.Fc("ApplicationFeatureHelperRequestQueueTimeout",15E3),Ec=null!=mb?mb:this.$a.Fc("ApplicationFeatureHelperRequestSentTimeout",3E4);this.ei.YV(f,1,null,this.c6d(N,ea),Ha,1,Xc=>{e.ULS.sendTraceTag(50622689,3004,
50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: HttpRequest {0} Succeeded.",gb);try{if(void 0===Xc||null===Xc||void 0===Xc.data||null===Xc.data||void 0===Xc.data.Zd||null===Xc.data.Zd){A.Health.instance.recordKpiFailure(Cb,"Invalid RequestSucceededEventArgs",!1,!0,null);let zd=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data or args.Data.ResponseData is null or undefined request {0}",gb);Pb(this.Sja(zd,Xc))}else if(Xc.data.Te!==E.a.Ey){A.Health.instance.recordKpiFailure(Cb,
"HttpStatusCode_"+Xc.data.Te.toString(),!1,!0,null);let zd=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: ApplicationFeatureHelper Service token generation returned unexpected response code {0}, request {1}",Xc.data.Te,gb);Pb(this.Sja(zd,Xc))}else{void 0!==ma&&null!==ma&&void 0!==Xc.data.rj&&null!==Xc.data.rj&&ma(Xc.data.rj);var Ac=x(Xc.data.Zd);if(Ac)e.ULS.sendTraceTag(50622690,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: Successfully parsed response for request {0}",
gb),zb(Ac);else{A.Health.instance.recordKpiFailure(Cb,"Parse Failure",!1,!0,null);let zd=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Failed to parse response for request {0}",gb);Pb(this.Sja(zd,Xc))}}}catch(zd){A.Health.instance.recordKpiFailure(Cb,"Unexpected Failure",!1,!0,null),Ac=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Exception {0} for request {1}",zd,gb),Pb(this.Sja(Ac,Xc))}},Xc=>{if(Xc.data){A.Health.instance.recordKpiFailure(Cb,"HttpStatusCode_"+
Xc.data.Te.toString(),!1,!0,null);var Ac=H.a.gTc(Xc.data.Zd||"No Data");Ac=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Request Failed: HttpStatus - {0}, ResponseData - {1} for Request - {2}",Xc.data.Te,Ac,gb)}else A.Health.instance.recordKpiFailure(Cb,"Invalid RequestFailedEventArgs",!1,!0,null),Ac=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data is null or undefined for request {0}",gb);Pb(this.Sja(Ac,Xc))},null,void 0,void 0,oc,Ec)})}Sja(f,
x){const N=new z;N.message=f;N.tv=x&&x.data?x.data.Te:-1;return N}c6d(f,x){const N={};N["x-UserDataSignature"]=this.$a.Ha("UserDataSignature");N["x-LicensingIsEnabled"]=this.$a.ka("LicensingIsEnabled").toString();N["x-CacheIsEnabled"]=this.$a.ka("LicensingRedisIsEnabled").toString();N["x-OcpsIsEnabled"]=this.$a.ka("OcpsIsEnabled").toString();N["x-LicensingAADIdIsEnabled"]=this.$a.ka("LicensingAadIdIsEnabled").toString();0===f&&(N["x-LicenseCheckOnTenantEnabled"]="true",N["x-SupportUserConsentDependentFeatures"]=
"true",N["x-AFHUserConsentGroupValue"]="0",N["x-UseShellServiceForUserConsentGroup"]="true",N["x-SMBUserLicensingEnabled"]="true",N["x-AFHPIPLComplianceEnabled"]=u.a.dT(window.location.href,"wd_afhpipl")||"false");if(x)for(let ea of x.keys)N[ea]=x.ga(ea);return N}}Object(k.a)(I,"HttpRequestToPromiseUtility",null,[]);var J=d(25),T;(function(f){f[f.loki=0]="loki";f[f.augloopACLP=1]="augloopACLP"})(T||(T={}));Object(k.b)("AlternateAuthSupportApp",T);var D=d(224),R=d(33);class Q{constructor(){this.Token=
null;this.ExpirationTime=0}}Object(k.a)(Q,"WacAlternateAuthToken",null,[]);class W{constructor(f,x){this.$ql=3E5;if(void 0===f||null===f||void 0===x||null===x)throw Error.argumentNull("appSettingsManager/clientRequestManager");this.$a=f;this.bvc=new n.a(r.a.jp());this.qSb=new I(f,x);void 0!==D.OAuthManagerSettings.qne&&null!==D.OAuthManagerSettings.qne&&void 0!==D.OAuthManagerSettings.m1c&&null!==D.OAuthManagerSettings.m1c&&0<D.OAuthManagerSettings.m1c&&(f=new Q,f.Token=D.OAuthManagerSettings.qne,
f.ExpirationTime=D.OAuthManagerSettings.m1c,this.bvc.$("loki",f))}R1i(){let f=null;this.bvc.Hb(T[0])&&(f=this.bvc.ga(T[0]));return void 0===f||null===f||this.xUj(f)?this.nVi():Promise.resolve(f.Token)}xUj(f){return f.ExpirationTime-Date.now()<this.$ql}nVi(){const f=new n.a(r.a.jp());f.$("X-AlternateAuthApp",T[0]);return this.qSb.B0b(this.uSa("/afhs/AlternateAuthHelperHandler.ashx"),Object(v.a)(this,this.xxk,"parseAlternateAuthTokenResponse"),2,f).then(x=>{e.ULS.sendTraceTag(545821456,3004,50,"AlternateAuthHelper:FetchNewUserDataSignatureToken: Retrieved WacAlternateAuthToken for {0}",
T[0]);this.bvc.$(T[0],x);return x.Token},x=>{x=Object(C.a)(z,x);e.ULS.sendTraceTag(545604827,3004,10,"AlternateAuthHelper:FetchNewUserDataSignatureToken: Error: {0}, status code: {1}",x.message,x.tv);return null})}xxk(f){let x=null;({kv:x}=R.d(f));e.ULS.sendTraceTag(545821457,3004,x?50:10,"ParseAlternateAuthTokenResponse: fetched WacAlternateAuthToken from {0}",f);return x}uSa(f){return String.format("{0}{1}?{2}",this.$a.Ha("WebServiceBase"),f,J.AFrameworkApplication.jh)}}Object(k.a)(W,"AlternateAuthHelper",
null,[627]);var O=d(1048);class Y{constructor(f,x,N){this.featureName=null;this.isEnabled=!1;this.tierName=0;this.featureName=f;this.isEnabled=x;this.tierName=N}}Object(k.a)(Y,"FeatureStateChangeArgs",null,[]);var S=d(219),da=d(222),fa=d(54),ka=d(103),ha=d(104),F;(function(f){f[f.Enabled=0]="Enabled";f[f.Disabled=1]="Disabled"})(F||(F={}));Object(k.b)("FeatureState",F);var na=d(55),ba=d(35),Ea=d(87);class La{constructor(f,x,N=null,ea=null,ma=null){this.PRa=this.NV=this.wkf=this.KNa=this.nDc=null;
this.qSb=new I(f,x);this.$a=f;this.NUh=f.Fc("LicensingMaxRetryAttempts",0);this.ezc=f.ka("IsO365ConsumerHost");this.GCd=f.ka("IsO365CommercialHost");this.Vyc=f.ka("PremiumUpsellIsEnabled");this.$Dd=0;this.w7e=N;this.Eof=ea;this.Ca=ma;this.JNa=f.ka("LicensingIsEnabled");this.T3a=f.ka("OcpsIsEnabled")&&this.GCd;this.YLd=f.ka("ShowPrivacyDialog")&&!!ea;this.OBd=f.ka("IsAnonymousUser");this.y1d=new Promise(Ha=>{Ha(!1)});this.P0a=new Promise(Ha=>{Ha(!0)});this.ORa=new n.a(r.a.jp());this.wEc=!0;this.vff=
this.oaj();this.jje()&&!this.OBd?(void 0!==J.AFrameworkApplication.Aa&&null!==J.AFrameworkApplication.Aa&&(this.nDc=J.AFrameworkApplication.Aa.gV,void 0!==this.nDc&&null!==this.nDc&&(this.KNa=this.nDc.nFb("WebServiceCall","ApplicationFeatureHelperService"))),this.PRa=this.r1e()):this.PRa=new Promise(Ha=>{Ha({})});this.PRa.catch(Ha=>{Ha=Object(C.a)(z,Ha);e.ULS.sendTraceTag(42513088,3004,10,"ApplicationFeatureHelper initialization failed, HttpStatus={0}",Ha?Ha.tv.toString():"Unknown")});this.wEc&&(this.Vyc=
!1,this.isFeatureEnabled("FreemiumUpsell",!0).then(Ha=>{this.Vyc=this.$a.ka("PremiumUpsellIsEnabled")&&Ha;return null}))}oaj(){const f=this.$a.aw("AllLicensedFeatures")?this.$a.RA("AllLicensedFeatures"):[],x=new O.a;for(let N=0;N<f.length;N++)x.add(f[N]);return x}jje(){return this.GCd||this.ezc}r1e(f=0,x=!1){e.ULS.sendTraceTag(51185368,3004,50,"ApplicationFeatureHelper_TryInitializeLicensing: forceRefresh = {0}",x);const N=S.a.Lz();N&&(N.set("retryAttempt",f.toString()),N.set("forceRefresh",x.toString()),
N.set("isO365ConsumerHost",this.ezc.toString()),N.set("isO365CommercialHost",this.GCd.toString()),N.set("isFreemiumUpsellSettingEnabled",this.Vyc.toString()));A.Health.instance.recordKpiUsageForAlertableKpi("AFHSLicensingFailedRequest","waclicensing",N);A.Health.instance.recordKpiUsage("AFHSLicensingSuccessfulRequest",1,"waclicensing",N);void 0!==this.KNa&&null!==this.KNa&&this.KNa.start();let ea=null;x&&(ea=new n.a(r.a.jp()),ea.$("x-LicensingForceRefresh","true"));this.wkf=new Date;return(this.JNa?
this.qSb.B0b(this.uSa("/afhs/ApplicationFeatureHelperHandler.ashx"),Object(v.a)(this,this.Axk,"parseApplicationFeatureHelperResponse"),0,ea,Object(v.a)(this,this.REk,"processApplicationFeatureHelperResponseHeaders"),["Date"]):Promise.resolve({})).then(ma=>{const Ha=Object.assign(new Ea.a,{durationMs:this.Uxh()});Ha.extendedProperties=N;Ha.extendedProperties&&ma&&(Ha.extendedProperties.set("featureCount",ka.a.count(ma).toString()),Ha.extendedProperties.set("licensingTestFeatureEnabled",("LicensingTestFeature"in
ma).toString()),Ha.extendedProperties.set("msoPremiumBadgeEnabled",("MsoPremiumBadge"in ma).toString()),"FreemiumUpsell"in ma&&Ha.extendedProperties.set("isFreemiumUpsellEnabled",ma.FreemiumUpsell.toString()),this.NV&&Ha.extendedProperties.set("fromCache",(this.NV<this.wkf).toString()));A.Health.instance.recordKpiSuccess("AFHSLicensingSuccessfulRequest",Ha);return ma},ma=>{const Ha=Object.assign(new Ea.a,{durationMs:this.Uxh()}),Ua=Object(C.a)(z,ma);if(!Ua)return e.ULS.sendTraceTag(51491471,3004,
10,"ApplicationFeatureHelper_TryInitializeLicensing: Invalid cast to HttpRequestToPromiseRejectData"),A.Health.instance.recordKpiFailure("AFHSLicensingFailedRequest","InvalidCastToHttpRequestToPromiseRejectData",!1,!0,Ha),new Promise((mb,gb)=>{gb(ma)});Ha.extendedProperties=N;Ha.extendedProperties&&Ha.extendedProperties.set("status",Ua.tv.toString());A.Health.instance.recordKpiFailure("AFHSLicensingFailedRequest","RequestFailed",!1,!0,Ha);return 408===Ua.tv&&++f<=this.NUh?this.r1e(f):new Promise((mb,
gb)=>{gb(Ua)})})}Axk(f){(f=R.b(f))?(e.ULS.sendTraceTag(50436170,3004,50,"ParseApplicationFeatureHelperResponse: Successfully fetched features"),e.ULS.sendTraceTag(50938594,3004,50,"{0}",f)):e.ULS.sendTraceTag(50436171,3004,10,"ParseApplicationFeatureHelperResponse: ApplicationFeatureHelper Service returned a null feature set");return f.Features}uSa(f){var x=String.format("{0}{1}",this.$a.Ha("WebServiceBase"),f);this.$a.aw("ApplicationFeatureHelperHttpCachingEnabled")&&this.$a.ka("ApplicationFeatureHelperHttpCachingEnabled")&&
(f=La.pSc(this.$a))&&0<f.length&&(this.wEc&&(f+="ucbf"),x=new da.QueryStringBuilder(x),x.Ki("afhskey",f),x=x.toString());return x}isFeatureEnabled(f,x){if(!this.T3a&&!this.YLd&&!this.JNa)return this.P0a;e.ULS.sendTraceTag(42513091,3004,50,"ApplicationFeatureHelper.IsFeatureEnabled: Call made to check if feature: {0} is enabled.",f);if("ConnectedServices"===f){var N=this.T3a?this.w7e.o3("ControllerConnectedServicesEnabled"):this.P0a;const Ha=this.YLd?this.Eof.getSettings().then(Ua=>2!==Ua.cC,()=>x):
this.P0a;return N.then(Ua=>Ua?Ha:this.y1d)}N=null;N=this.T3a?this.w7e.isFeatureEnabled(f):this.P0a;let ea=null;ea=this.JNa?this.iLj(f,x):this.P0a;let ma=null;ma=this.YLd?this.Eof.isFeatureEnabled(f):this.P0a;return N.then(Ha=>Ha?ma.then(Ua=>Ua?ea:this.y1d):this.y1d).then(Ha=>{this.eog(f,Ha,!0);return Ha},()=>{this.eog(f,x,!1);return x})}eog(f,x,N){e.ULS.sendTraceTag(526713106,3004,50,"FeatureName={0}, IsEnabled={1}, IsSuccess={2}",f,x,N)}getFeatureTier(f,x){if(!this.JNa)return new Promise(N=>{N(2)});
e.ULS.sendTraceTag(42804871,3004,50,"ApplicationFeatureHelper.GetFeatureTier: Call made to get Feature's Tier.",f);return this.PRa.then(N=>this.NTc(f,N,x),()=>x)}isFreemiumUpsellEnabled(){const f=this.Vyc&&this.ezc&&!this.OBd;if(f&&2!==this.$Dd||!f&&1!==this.$Dd)e.ULS.sendTraceTag(509728161,3004,20,"ApplicationFeatureHelper_IsFreemiumUpsellEnabled: isO365ConsumerHost={0}, isAnonymousUser={1}, isFreemiumUpsellEnabled={2}",this.ezc.toString(),this.OBd.toString(),f.toString()),this.$Dd=f?2:1;return f}launchUpsellExperience(f,
x=null){e.ULS.sendTraceTag(594564814,3004,50,String.format("ApplicationFeatureHelper_LaunchUpsellExperience: Launching upsell experience for experienceId: {0}",f));var N=S.a.Lz();N&&(N.set("experienceId",f),x&&N.set("campaignId",x));A.Health.instance.recordKpiUsage("AFHCLaunchUpsellSuccess",1,"waclicensing",N);if(N=na.a.instance.rb("Common.IInProductMessagingUIManager")){const ea=Object(v.a)(this,this.qqj,"handleDimeTaskComplete");N.Emg(f,ea,x)}else e.ULS.sendTraceTag(594367561,3004,15,"InProductMessaging was not initialized"),
A.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","InProductMessagingNotInitialized",!1,!0,null),this.Ca.La(ba.a.WPc,2,{["experience"]:f})}Vhb(f,x){if(!this.JNa)return null;if(!f||!x)return e.ULS.sendTraceTag(594564813,3004,10,"ApplicationFeatureHelper_RegisterFeatureStateChangeCallback: Invalid input."),null;const N=ha.a.create().toString();this.ORa.Hb(f)||this.ORa.$(f,new n.a(r.a.jp()));this.ORa.ga(f).add(N,x);e.ULS.sendTraceTag(594564812,3004,50,String.format("ApplicationFeatureHelper_RegisterFeatureStateChangeCallback: registered callback {0} for feature {1}",
N,f));return N}rJb(f,x){this.JNa&&(f&&this.ORa.Hb(f)?x&&ha.a.isValid(x)?this.ORa.ga(f).Hb(x)?(e.ULS.sendTraceTag(594564808,3004,50,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: Removing callback {0} for feature {1}",x,f)),this.ORa.ga(f).remove(x)):e.ULS.sendTraceTag(594564809,3004,15,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: callbackId {0} not registered for feature {1} ",x,f)):e.ULS.sendTraceTag(594564810,3004,10,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: invalid callbackId {0} for feature {1}",
x,f)):e.ULS.sendTraceTag(594564811,3004,10,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: invalid or non registered featureName {0}",f)))}NTc(f,x,N){return this.wEc?f in x?x[f].LicenseTier:N:f in x?this.kyk(x[f],N):N}kyk(f,x){switch(f.toLowerCase()){case "unknown":return 0;case "basic":return 1;case "premium":return 2;default:return x}}qqj(){e.ULS.sendTraceTag(594367560,3004,50,"ApplicationFeatureHelper_HandleDimeTaskComplete");this.PRa.then(f=>{this.Hfh(f)}).catch(()=>
{this.Hfh({})})}Hfh(f){e.ULS.sendTraceTag(594051087,3004,50,"ApplicationFeatureHelper_RefreshLicensingAndNotifyUpdatedFeatures");const x=this.r1e(0,!0);x.then(N=>{this.PRa=x;ka.a.count(N)>ka.a.count(f)?A.Health.instance.recordKpiSuccess("AFHCLaunchUpsellSuccess",null):A.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","FeatureCountNotIncreased",!1,!0,null);for(let ea of this.ORa.keys)if(ea in N){const ma=this.NTc(ea,N,0);ea in f?this.NTc(ea,f,0)!==ma&&this.cEe(ea,!0,ma):this.cEe(ea,!0,ma)}else ea in
f&&this.cEe(ea,!1,this.NTc(ea,f,0))}).catch(N=>{A.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","LicensingRefreshFailed",!1,!0,null);e.ULS.sendTraceTag(594051086,3004,10,JSON.stringify(N))})}cEe(f,x,N){e.ULS.sendTraceTag(594051085,3004,50,"ApplicationFeatureHelper_NotifyFeatureStateChanged: Notify feature state changed callbacks for feature {0}, {1}, {2}",f,x,N);x=new Y(f,x,N);N=this.ORa.ga(f);for(let ea of N)try{ea.value(x)}catch(ma){e.ULS.sendTraceTag(594051084,3004,10,String.format("ApplicationFeatureHelper_NotifyFeatureStateChanged: Exception when calling registered callback: feature: {0} callbackId: {1}, exception {2}",
f,ea.key,ma.message))}}hLj(f,x){if(this.JNa){const N=this.vff.contains(f);let ea=!0,ma="",Ha=!1;return this.PRa.then(Ua=>{f in Ua?(Ua=Ua[f],ma=F[Ua.FeatureState],ea=1!==Ua.FeatureState):ea=!N;this.pog(f,N,ma,Ha,x,ea);return ea},()=>{Ha=!0;N&&(ea=x);this.pog(f,N,ma,Ha,x,ea);return ea})}return this.P0a}pog(f,x,N,ea,ma,Ha){e.ULS.sendTraceTag(557389507,3004,50,"featureName : {0}, isLicenseControlledFeature={1}, encounteredError = {2}, featureData={3}, fallbackValue={4}, isAllowed={5}",f,x,ea,N,ma,Ha)}iLj(f,
x){if(this.wEc)return this.hLj(f,x);if(this.JNa){if(this.vff.contains(f))return this.PRa.then(N=>f in N,()=>x);e.ULS.sendTraceTag(590385821,3004,50,"ApplicationFeatureHelper_IsFeatureAllowedByUserLicense: Feature '{0}' requested while not in the licensed features set.",f)}return this.P0a}REk(f){try{f&&"Date"in f&&(this.NV=new Date(f.Date),e.ULS.sendTraceTag(578863817,3004,50,"ProcessApplicationFeatureHelperResponseHeaders Date {0}",this.NV.toString()))}catch(x){e.ULS.sendTraceTag(578863818,3004,10,
"ProcessApplicationFeatureHelperResponseHeaders Exception {0}",x)}}Uxh(){if(void 0!==this.KNa&&null!==this.KNa){const f=this.KNa.Rq;this.KNa.stop();return f}return null}static pSc(f){try{if(fa.a.iZe){const x=f.Ha("UserDataSignature").split(".");if(1<x.length){const N=window.self.atob(x[1]),ea=JSON.parse(N).LocalStorageKey;if(void 0!==ea&&null!==ea&&0<ea.length)return ea}}}catch(x){e.ULS.sendTraceTag(578863816,3004,10,"GetLocalStorageCacheKey exception {0}",x.toString())}return null}}Object(k.a)(La,
"ApplicationFeatureHelper",null,[628]);var ta=d(17);class oa{constructor(f,x){this.PolicySettings=null;this.ExpirationTime=0;this.PolicySettings=f.PolicySettings;f=new Date;f.setMinutes(f.getMinutes()+x);this.ExpirationTime=f.getTime()}}Object(k.a)(oa,"CloudPolicySettingsCacheData",null,[]);var wa=d(368),ra=d(236),ya=d(281);class Da{static Nvh(){return J.AFrameworkApplication.fa.ka("SideCarIsEnabled")?Da.Yld&&Da.fYc?new Promise(f=>{f(!0)}):new Promise((f,x)=>{Da.Yld=ya.a.create(J.AFrameworkApplication.fa.Ha("SideCarUrl"));
ra.a.Wx(Da.Yld);Da.Yld.zS((N,ea)=>{(Da.fYc=ea.succeeded)?f(ea.succeeded):x(ea.succeeded)})}):new Promise(f=>{f(!1)})}}Da.fYc=!1;Da.Yld=null;Object(k.a)(Da,"SideCarLoader",null,[]);class pa{constructor(){this.ControllerConnectedServicesFeatureNames=this.PolicySettings=null}}Object(k.a)(pa,"CloudPolicySettingsData",null,[]);class la{constructor(f,x){this.pxd=0;this.nJc=null;this.qSb=new I(f,x);this.$a=f;x=f.Ha("HostAuthType");this.T3a=f.ka("OcpsIsEnabled")&&f.ka("IsO365CommercialHost")&&!(void 0===
x||null===x)&&"aad"===x.toLowerCase();this.Khf=R.b(f.Ha("OcpsDefaultSettings")||"{}");this.KTb=this.pSc();x=this.$a.aw("ServicesControlsMicrosoftControllerServicesList")?this.$a.RA("ServicesControlsMicrosoftControllerServicesList")||[]:[];this.lwc=new O.a;for(let N=0;N<x.length;N++)this.lwc.add(x[N]);this.T3a&&!f.ka("IsAnonymousUser")&&f.ka("SideCarIsEnabled")?this.nJc=this.mul():this.nJc=this.q1e(this.T3a,this.uSa("/afhs/CloudPolicySettings.ashx"),Object(v.a)(this,this.Hxk,"parseCloudPolicySettingsResponse"));
this.nJc.then(()=>null).catch(N=>{N=Object(C.a)(z,N);e.ULS.sendTraceTag(50622685,3004,10,"CloudPolicySettingsHelper initialization failed, HttpStatus={0}",N?N.tv.toString():"Unknown")})}o3(f,x=!0){if(!this.T3a){const Ha=this;return new Promise(Ua=>{Ua(Ha.c5b(f))})}let N=this,ea=this;const ma=this.nJc.then(Ha=>{try{let Ua=null;Ha.PolicySettings&&"unknown"in Ha.PolicySettings&&(Ua=Ha.PolicySettings.unknown);if(Ua){if(f in Ua&&void 0!==Ua[f]&&null!==Ua[f])return new Promise(gb=>{gb("0"!==Ua[f])});const mb=
f.toLowerCase();if(mb in Ua&&void 0!==Ua[mb]&&null!==Ua[mb])return new Promise(gb=>{gb("0"!==Ua[mb])});e.ULS.sendTraceTag(51512667,3004,50,"Policy"+f+" not found, using default");return new Promise(gb=>{gb(N.c5b(f))})}return new Promise(mb=>{mb(N.c5b(f))})}catch(Ua){return e.ULS.sendTraceTag(50622686,3004,10,"Failed to get "+f+" policy value. Error Message: {0}",Ua.message),N.handleError(Ua.toString(),x,N.c5b(f))}},Ha=>ea.handleError(Ha,x,ea.c5b(f)));ma.then(Ha=>{e.ULS.sendTraceTag(50651667,3004,
50,"CloudPolicySettingsHelper.GetBooleanPolicySetting: policy: {0}, value: {1}",f,Ha);return null});return ma}isFeatureEnabled(f,x=!0){if(this.$a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1))return this.kLj(f,x);let N=new Promise(ma=>{ma(!0)}),ea="";this.lwc.contains(f)&&(ea="ControllerConnectedServicesEnabled",N=this.o3(ea,x));N.then(ma=>{e.ULS.sendTraceTag(50651668,3004,50,"CloudPolicySettingsHelper.IsFeatureEnabled: Feature: {0}, enabled or not: {1}, by policy: {2}",
f,ma,ea);return null});return N}kLj(f,x=!0){let N=new Promise(ma=>{ma(!0)}),ea="";"mso_sendASmile"===f?ea="Enabled":"Survey"===f||"FloodgateSurvey"===f?ea="SurveyEnabled":this.lwc.contains(f)&&(ea="ControllerConnectedServicesEnabled");""!==ea&&(N=this.o3(ea,x));N.then(ma=>{e.ULS.sendTraceTag(558187080,3004,50,"CloudPolicySettingsHelper.IsFeatureEnabledV2: Feature: {0}, enabled or not: {1}, by policy: {2}",f,ma,ea);return null});return N}handleError(f,x,N){return x?new Promise(ea=>{ea(N)}):new Promise((ea,
ma)=>{ma(f)})}q1e(f,x,N){if(!f)return Promise.resolve(new pa);let ea=!1,ma=null;A.Health.instance.recordKpiUsage("GetCloudPolicySettings",1,"jpittsdirects",null);let Ha=this.bWd("GetCloudPolicySettings");return(new Promise((Ua,mb)=>{if(void 0!==this.KTb&&null!==this.KTb&&0<this.KTb.length){const gb=this.Stl();if(void 0!==gb&&null!==gb){ea=!0;Ua(gb);return}}this.qSb.B0b(x,N,1,null,Object(v.a)(this,this.YEk,"processCloudPolicySettingsResponseHeaders"),["CheckIn-Interval"],this.$a.Fc("CloudPolicySettingsRequestQueueTimeout",
15E3),this.$a.Fc("CloudPolicySettingsRequestSentTimeout",3E4)).then(gb=>{e.ULS.sendTraceTag(51662933,3004,50,"Retrieved CloudPolicySettingsData from OCPS");this.Yul(gb);Ua(gb);return gb},gb=>{mb(gb);return null})})).then(Ua=>{({Ay:Ha,returnValue:ma}=this.lqd(Ha));var mb=S.a.Lz();mb&&mb.set("FromCache",ea.toString());mb=Object.assign(new Ea.a,{durationMs:ma,extendedProperties:mb});A.Health.instance.recordKpiSuccess("GetCloudPolicySettings",mb);return Ua})}mul(){return Da.Nvh().then(()=>{e.ULS.sendTraceTag(593282845,
3004,50,"CloudPolicySettingsHelper - Retrieving CloudPolicySettingsData Promise from Sidecar");return sidecar.cloudPolicy.GetCloudPolicySettingsData()})}uSa(f){return String.format("{0}{1}",this.$a.Ha("WebServiceBase"),f)}Hxk(f){let x=null;({kv:x}=R.d(f));f=!!x;e.ULS.sendTraceTag(50622687,3004,f?50:10,"ParseCloudPolicySettingsResponse: Success={0}",f);return x}YEk(f){try{if(void 0!==f&&null!==f&&"CheckIn-Interval"in f){const x=parseInt(f["CheckIn-Interval"]);void 0!==x&&null!==x&&0<x&&(this.pxd=x)}}catch(x){e.ULS.sendTraceTag(51662934,
3004,10,"ProcessCloudPolicySettingsResponseHeaders Exception {0}",x)}}c5b(f){return f in this.Khf?"0"!==this.Khf[f]:!0}Stl(){try{const f=wa.a.instance.getItem(this.KTb);if(void 0===f||null===f)return e.ULS.sendTraceTag(51662936,3004,50,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage is null"),null;e.ULS.sendTraceTag(51662937,3004,50,"TryGetCloudPolicySettingsDataFromCache retrieved data {0} from LocalStorage",f);const x=JSON.parse(f);if(void 0===x||null===x)return e.ULS.sendTraceTag(51662938,
3004,15,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage is null after parsing"),null;if(void 0===x.ExpirationTime||null===x.ExpirationTime)return e.ULS.sendTraceTag(51662939,3004,15,"TryGetCloudPolicySettingsDataFromCache ExpirationTime from LocalStorage is null after parsing"),null;if((new Date(x.ExpirationTime)).getTime()<Date.now())return e.ULS.sendTraceTag(51662940,3004,50,"TryGetCloudPolicySettingsDataFromCache Cache is expired"),null;const N=new pa;N.PolicySettings=x.PolicySettings;
N.ControllerConnectedServicesFeatureNames=new ta.a;this.$a.aw("ServicesControlsMicrosoftControllerServicesList")&&this.$a.RA("ServicesControlsMicrosoftControllerServicesList");for(let ea of this.lwc)N.ControllerConnectedServicesFeatureNames.add(ea);e.ULS.sendTraceTag(51662941,3004,50,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage retrieved");return N}catch(f){return e.ULS.sendTraceTag(51662942,3004,10,"TryGetCloudPolicySettingsDataFromCache exception {0}",f.toString()),null}}Yul(f){try{if(void 0===
f||null===f||void 0===f.PolicySettings||null===f.PolicySettings)e.ULS.sendTraceTag(51662944,3004,15,"TrySetCloudPolicySettingsDataIntoCache data/PolicySettings is null");else if(0>=this.pxd)e.ULS.sendTraceTag(51662945,3004,15,"TrySetCloudPolicySettingsDataIntoCache _checkInInterval is Invalid");else{const x=new oa(f,this.pxd),N=JSON.stringify(x);e.ULS.sendTraceTag(51662946,3004,50,"TrySetCloudPolicySettingsDataIntoCache data to cache {0}",N);wa.a.instance.setItem(this.KTb,N);e.ULS.sendTraceTag(51662947,
3004,50,"TrySetCloudPolicySettingsDataIntoCache set data to cache")}}catch(x){e.ULS.sendTraceTag(51662976,3004,10,"TrySetCloudPolicySettingsDataIntoCache exception {0}",x.toString())}}pSc(){const f=La.pSc(this.$a);return f&&0<f.length?"OCPS"+f:null}bWd(f){const x=na.a.instance.rb("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder");return void 0!==x&&null!==x?x.Ci("WebServiceCall",f):null}lqd(f){if(void 0!==f&&null!==f){const x=f.Rq;f.stop();return{returnValue:x,Ay:null}}return{returnValue:null,
Ay:f}}}Object(k.a)(la,"CloudPolicySettingsHelper",null,[625]);class Fa{constructor(){this.NNf=this.QHh=this.cC=0;this.ONf=this.RHh=this.a7a="";this.ZJd=this.tza=2}clone(){const f=new Fa;f.cC=this.cC;f.QHh=this.QHh;f.NNf=this.NNf;f.a7a=this.a7a;f.RHh=this.RHh;f.ONf=this.ONf;f.tza=this.tza;f.ZJd=this.src;return f}get src(){return this.ZJd}serialize(f=null){const x={};if(!f||f.contains(Fa.ggb))x[Fa.ggb]=this.cC;if(!f||f.contains(Fa.Uic))x[Fa.Uic]=this.a7a;if(!f||f.contains(Fa.Vic))x[Fa.Vic]=this.tza;
return JSON.stringify(x)}static create(f,x=null){const N=new Fa;N.ZJd=f;void 0!==x&&null!==x&&(Fa.ggb in x&&(N.cC=x[Fa.ggb]),Fa.Uic in x&&(N.a7a=x[Fa.Uic]),Fa.Vic in x&&(N.tza=x[Fa.Vic]));return N}static deserialize(f,x){try{const N=JSON.parse(f);if(void 0!==N&&null!==N)return Fa.create(x,N);e.ULS.sendTraceTag(50860946,306,10,"UserPrivacySettings Deserialize: Unable to convert {0} to dict",f);throw Error.argument("settingsData");}catch(N){throw e.ULS.sendTraceTag(50860947,306,10,"UserPrivacySettings Deserialize Exception = {0}",
N.toString()),N;}}}Fa.ggb="CCS";Fa.Uic="CCSTime";Fa.Vic="OfficePrivacyRoamedNoticeShown";Object(k.a)(Fa,"UserPrivacySettings",null,[]);var Qa=d(208);class Sa{constructor(f,x){if(void 0===f||null===f||void 0===x||null===x)throw Error.argumentNull("appSettingsManager/clientRequestManager");this.$a=f;this.ei=x;this.oJd=this.Jc=null}uSa(f){var x=String.format("{0}RoamingServiceHandler.ashx?action=",this.$a.appSettings.RoamingServiceHandlerWebServiceBase||"");x=new Sys.StringBuilder(x);x.append(f);x.append("&");
x.append(J.AFrameworkApplication.jh);return x.toString()}executeRequest(f,x,N,ea=null){return this.ei.vqb(f,x,ea,null,2,N,"33",!1,null,6E4)}saveSettings(f){return new Promise((x,N)=>{try{if(void 0===this.Jc||null===this.Jc||void 0===f||null===f)e.ULS.sendTraceTag(51258443,3004,15,"SaveUserPrivacySettings: Can't determine setting changes to save"),N("Can't determine setting changes to save");else{var ea=this.Jc.cC!==f.cC;if(2===this.Jc.src&&ea)this.H0k(f),x(!0);else{var ma=this.I3k(f);if(void 0===
ma||null===ma||!ma.length)e.ULS.sendTraceTag(50917389,3004,15,"SaveUserPrivacySettings: returning since nothing changed"),N("No changes to save");else if(1===this.Jc.src)x(this.NDh(ma));else if(0===this.Jc.src){e.ULS.sendTraceTag(51258444,3004,50,"UserPrivacySettingsHelper: SaveSettings to Roaming {0}",ma);const Ha=this.executeRequest(this.uSa("saveUserPrivacySettings"),2,"SaveUserPrivacySettingsRequest",ma);Ha.continueWith(()=>{if(Ha.Sn||Ha.rm)e.ULS.sendTraceTag(50860929,3004,10,"SaveUserPrivacySettings: Roaming Request Cancelled/Failed"),
x(!1);else{var Ua=Ha.result;void 0!==Ua.Xi&&null!==Ua.Xi&&void 0!==Ua.Xi.data&&null!==Ua.Xi.data&&Ua.Xi.data.Te===E.a.Ey?(e.ULS.sendTraceTag(51258445,3004,50,"SaveUserPrivacySettings: Roaming Request Succeeded"),x(!0)):(e.ULS.sendTraceTag(51258446,3004,10,"SaveUserPrivacySettings: Roaming Request Failed"),x(!1))}})}}}}catch(Ha){e.ULS.sendTraceTag(50860930,3004,10,"SaveUserPrivacySettings: Exception = {0}",Ha.toString()),x(!1)}})}I3k(f){if(void 0===this.Jc||null===this.Jc||void 0===f||null===f)throw Error.invalidOperation("User Privacy settings have not been initialized");
const x=new ta.a;0===f.src?(this.Jc.cC!==f.cC&&(x.add(Fa.ggb),x.add(Fa.Uic)),this.Jc.tza!==f.tza&&x.add(Fa.Vic)):1===f.src&&this.Jc.cC!==f.cC&&x.add(Fa.ggb);return x.count?f.serialize(x):(e.ULS.sendTraceTag(50860931,3004,50,"SaveUserPrivacySettings: returning since nothing changed"),null)}getSettings(){if(!this.oJd){const f=this;this.oJd=new Promise(x=>{try{f.Jc?x(f.Jc.clone()):f.aul().then(N=>{f.Jc=N;x(f.Jc.clone());return null},()=>{f.Ztl().then(N=>{f.Jc=N;x(f.Jc.clone());return null},()=>{f.$tl().then(N=>
{f.Jc=N;x(f.Jc.clone());return null},()=>{e.ULS.sendTraceTag(50967430,3004,10,"UserPrivacySettings TryGetSettingsFromQueryParams returned an error)");f.Jc=new Fa;x(f.Jc.clone());return null});return null});return null})}catch(N){e.ULS.sendTraceTag(50860932,3004,10,"UserPrivacySettings GetSettings: Exception = {0}",N.toString()),f.Jc=new Fa,x(f.Jc.clone())}})}return this.oJd}aul(){return new Promise((f,x)=>{try{const ea=-1!==window.location.href.indexOf("&wd_pn=2");if(this.$a.ka("PrivacyDialogShouldCheckRoaming")||
ea){var N=this.executeRequest(this.uSa("getUserPrivacySettings"),1,"GetUserPrivacySettingsRequest");N.continueWith(()=>{try{if(N.Sn||N.rm)e.ULS.sendTraceTag(50860934,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Request failure");else{const ma=N.result;if(ma&&ma.Xi&&ma.Xi.data)if(ma.Xi.data.Te!==E.a.Ey)e.ULS.sendTraceTag(50860936,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Received error response {0}",ma.Xi.data.Te);else{if(ma.Xi.data.Zd){f(Sa.parse(ma.Xi.data.Zd,0));e.ULS.sendTraceTag(51258447,
3004,50,"UserPrivacySettings TryGetSettingsFromRoaming: Success, Settings {0}",ma.Xi.data.Zd);return}e.ULS.sendTraceTag(50860937,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: ResponseData is null")}else e.ULS.sendTraceTag(50860935,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Data is null");x("UserPrivacySettings TryGetSettingsFromRoaming Request Faillure")}}catch(ma){e.ULS.sendTraceTag(50860938,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming Exception handling request {0}",
ma.toString()),x("UserPrivacySettings TryGetSettingsFromRoaming Request Exception")}})}else e.ULS.sendTraceTag(50860933,3004,50,"UserPrivacySettings TryGetSettingsFromRoaming: Roaming should not be used"),x("Roaming should not be used")}catch(ea){e.ULS.sendTraceTag(50860939,3004,10,"TryGetSettingsFromRoaming Exception = {0}",ea.toString()),x("UserPrivacySettings TryGetSettingsFromRoaming Exception")}})}Ztl(){return new Promise((f,x)=>{try{const N=Qa.a.get("WacUPToggleState");let ea=null;void 0!==
N&&null!==N&&0<N.length&&(ea=decodeURIComponent(N));if(void 0!==ea&&null!==ea&&0<ea.length){const ma=Sa.parse(ea,1);e.ULS.sendTraceTag(51258448,3004,50,"TryGetSettingsFromCookie: UserPrivacySettings retrieved from cookie {0}",ma.toString());f(ma)}else{const ma=Fa.create(1),Ha=new ta.a;Ha.add(Fa.ggb);const Ua=ma.serialize(Ha);this.NDh(Ua)?(e.ULS.sendTraceTag(51258449,3004,50,"TryGetSettingsFromCookie: UserPrivacySettings initialized and retrieved from cookie {0}",Ua),f(ma)):(e.ULS.sendTraceTag(51258450,
3004,15,"TryGetSettingsFromCookie: Failure initializing cookie with settings {0}",Ua),x("UserPrivacySettings TryGetSettingsFromCookie Failure in TrySaveSettingsToCookie"))}}catch(N){e.ULS.sendTraceTag(50860941,3004,10,"TryGetSettingsFromCookie from Cookie Exception = {0}",N.toString()),x("UserPrivacySettings TryGetSettingsFromCookie Eception")}})}$tl(){return new Promise(f=>{try{var x=-1!==window.location.href.indexOf("&wdccsoff=1");let N=Fa.create(2);x?(N.cC=2,J.AFrameworkApplication.yMf(),e.ULS.sendTraceTag(51258451,
3004,50,"TryGetSettingsFromQueryParams: Retrieved from query param {0}",N.toString())):(N.cC=1,e.ULS.sendTraceTag(51258452,3004,50,"TryGetSettingsFromQueryParams: Initialized with query param as data source for {0}",N.toString()));f(N)}catch(N){e.ULS.sendTraceTag(50967431,3004,50,"TryGetSettingsFromCookie from Query Params Exception = {0}",N.toString()),x=Fa.create(2),x.cC=1,f(x)}})}H0k(f){e.ULS.sendTraceTag(51258453,3004,50,"UserPrivacySettingsHelper: SaveSettingsToQueryParam");2===f.cC?J.AFrameworkApplication.yMf():
J.AFrameworkApplication.oPi();e.ULS.sendTraceTag(51258454,3004,50,"SaveSettingsToQueryParam saved settings = {0}",f)}NDh(f){try{e.ULS.sendTraceTag(51258455,3004,50,"UserPrivacySettingsHelper: TrySaveSettingsToCookie Saving settings {0}",f);const x=this.$a.Ha("PrivacyCookieDomain")||"";if(!x||!x.length)throw Error.invalidOperation("PrivacyCookieDomain is null or empty");e.ULS.sendTraceTag(51258456,3004,50,"SaveUserPrivacySettings to Cookie {0}",f);return Qa.a.Arh("WacUPToggleState",f,Qa.a.wJ,x)}catch(x){return e.ULS.sendTraceTag(50860942,
3004,50,"SaveUserPrivacySettings to Cookie Exception = {0}",x.toString()),!1}}isFeatureEnabled(f){return this.getSettings().then(x=>{const N=this.$a.aw("ServicesControlsMicrosoftControllerServicesList")?this.$a.RA("ServicesControlsMicrosoftControllerServicesList"):[],ea=new O.a;for(let ma=0;ma<N.length;ma++)ea.add(N[ma]);return ea.contains(f)?2!==x.cC:!0},()=>{e.ULS.sendTraceTag(50860945,3004,10,"Failed to get privacy setting for feature {0}",f);return!0})}static parse(f,x){try{return e.ULS.sendTraceTag(50860943,
3004,50,"Parsing user privacy settings {0} from {1}",f,x),Fa.deserialize(f,x)}catch(N){throw e.ULS.sendTraceTag(50860944,3004,10,"GetUserPrivacySettings Exception = {0}",N.toString()),N;}}}Object(k.a)(Sa,"UserPrivacySettingsHelper",null,[626]);var Na=d(68);class ua{constructor(){this.Da=null}get name(){return"Common.App.ApplicationFeatureHelper.ApplicationFeatureHelperPackage"}$b(f){this.Da=f;this.Da.register(625,"Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").ma().oa(()=>new la(J.AFrameworkApplication.fa,
J.AFrameworkApplication.Je));this.Da.register(626,"Common.App.ApplicationFeatureHelper.IUserPrivacySettingsHelper").ma().oa(()=>new Sa(J.AFrameworkApplication.fa,J.AFrameworkApplication.Je));this.Da.register(627,"Common.App.ApplicationFeatureHelper.IAlternateAuthHelper").ma().oa(()=>new W(J.AFrameworkApplication.fa,J.AFrameworkApplication.Je));this.Da.register(628,"Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").ma().oa(()=>new La(J.AFrameworkApplication.fa,J.AFrameworkApplication.Je,
this.Da.resolve("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper"),this.Da.resolve("Common.App.ApplicationFeatureHelper.IUserPrivacySettingsHelper"),J.AFrameworkApplication.Ta))}init(){J.AFrameworkApplication.fa.jf(()=>{const f=this.Da.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");J.AFrameworkApplication.fa.ka("LicensingIsEnabled")&&(f.isFeatureEnabled("LicensingTestFeature",!1).then(x=>{e.ULS.sendTraceTag(42513092,3004,50,"ApplicationFeatureHelperPackage.Init: LicensingTestFeature returned IsFeatureEnabled as {0}. IsAnonymousUser : {1}.",
x,J.AFrameworkApplication.fa.Ha("IsAnonymousUser"));return null}),f.getFeatureTier("LicensingTestFeature",0).then(x=>{e.ULS.sendTraceTag(42804872,3004,50,"ApplicationFeatureHelperPackage.Init: LicensingTestFeature returned GetFeatureTier as {0}. IsAnonymousUser : {1}.",x,J.AFrameworkApplication.fa.Ha("IsAnonymousUser"));return null}));this.Da.resolve("Common.App.ApplicationFeatureHelper.IAlternateAuthHelper");this.Zol()})}dispose(){}Zol(){try{J.AFrameworkApplication.fa.ka("SideCarIsEnabled")&&Da.Nvh().then(f=>
{e.ULS.sendTraceTag(594057429,3004,50,"Sidecar Loader attempted to load Sidecar.  SideCarIsAvailable:{0}",f);return f})}catch(f){}}static main(){Na.a.instance.Dc(new ua)}}Object(k.a)(ua,"ApplicationFeatureHelperPackage",null,[2,3]);var za=d(508),Wa=d(6);class yb{constructor(f,x){this.ei=f;this.yD=x}Gx(f,x,N,ea=null){return this.$Mi(f,ea,ma=>this.ei.vqb(ma,2,N,x,2,void 0,void 0,void 0,void 0,void 0,"2"))}$Mi(f,x,N){const ea=!!x&&""!==x;let ma=f;ea&&(ma=u.a.G5a(f,"perfTag",x));const Ha=new Date;return za.a.then(N(ma),
Ua=>{const mb=+new Date-+Ha;if(!Ua||!Ua.Xi||!Ua.Xi.data)return Ua;ea&&Ua.Xi.data.request&&this.c3k(Ua.Xi.data.request.getResolvedUrl(),x,mb);return Ua})}c3k(f,x,N){f=this.yD.Ifj(f);if(f.count&&(f=Wa.last(f))){const ea={Message:"Request durations for activities calls."};ea.PerfTag=x;ea.CustomDuration=N;ea.PerformanceDuration=f.duration;e.ULS.sendTraceTag(592189641,3012,50,JSON.stringify(ea))}}}Object(k.a)(yb,"CatchUpNetworkingWrapper",null,[696]);var Za=d(374);class ub extends Za.a{constructor(f,x){super(f,
x)}$k(){return 6}}Object(k.a)(ub,"GetActivityFeedRequest",Za.a,[]);class Ib extends Za.a{constructor(f,x,N,ea,ma,Ha){super(f,x);this.ItemIds=null;this.ActivityStatesToReset=this.ActivityStatesToSet=0;this.ResetUnseenCount=!1;this.ItemIds=N;this.ActivityStatesToSet=ea;this.ActivityStatesToReset=ma;this.ResetUnseenCount=Ha}$k(){return 7}}Object(k.a)(Ib,"UpdateActivityFeedStateRequest",Za.a,[]);var Ob=d(522);class Hc{constructor(f,x,N){this.fhf=f;this.P1a=x;this.$1a=N}getActivityFeed(f){return za.a.then(this.$1a.execute(new ub(this.P1a(),
null),(x,N,ea)=>this.fhf.Gx(x,N,ea,"ActivityFeed"),f),x=>{if(!x)return e.ULS.sendTraceTag(572846937,3012,10,"GetActivityFeed: Response is null"),null;if(!x.Xi)return e.ULS.sendTraceTag(572846938,3012,10,"GetActivityFeed: Response.Args is null"),null;if(!x.Xi.data)return e.ULS.sendTraceTag(572846939,3012,10,"GetActivityFeed: Response.Args.Data is null"),null;if(!x.Xi.data.Zd)return e.ULS.sendTraceTag(572846940,3012,10,"GetActivityFeed: Response.Args.Data.ResponseData is null"),null;x=Ob.a.x7a(x.Xi.data.Zd);
return x?x:(e.ULS.sendTraceTag(572846941,3012,10,"GetActivityFeed: Deserialized response is null"),null)})}Uwl(f,x,N,ea,ma){return za.a.then(this.$1a.execute(new Ib(this.P1a(),null,x,N,ea,ma),(Ha,Ua,mb)=>this.fhf.Gx(Ha,Ua,mb,"UpdateActivityFeedState"),f),Ha=>{try{return Ha.succeeded}catch(Ua){return e.ULS.sendTraceTag(523121054,3012,10,"UpdateActivityFeed: Exception: "+Ua.message),!1}})}}Object(k.a)(Hc,"CatchUpRequestHandler",null,[694]);var kb=d(211);class jb{constructor(f){this.Dpb=f;this.Sff=new kb.a}R_j(){this.I0j()}I0j(){if(this.Dpb){var f=
x=>{this.Sff.contains("CatchUpChangesFeedback")||(this.Sff.add("CatchUpChangesFeedback"),x.logActivity("CatchUpChangesFeedback",null))};this.Dpb.execute(x=>{window.setTimeout(()=>{f(x)},2E4)})}else e.ULS.sendTraceTag(571586199,383,15,"FloodgateEventLogger: IFuture<ISystemInitiatedFeedback> was null")}}Object(k.a)(jb,"FloodgateEventLogger",null,[]);class hb{constructor(f){this.rXh=f}get duration(){return this.rXh.duration}}Object(k.a)(hb,"PerformanceResourceTimingWrapper",null,[]);class uc{constructor(f){this.yD=
f}Ifj(f){const x=new ta.a;if(!this.yD)return x;f=this.yD.getEntriesByName(f,"resource");if(!f)return x;for(const N of f)x.add(new hb(N));return x}}Object(k.a)(uc,"PerformanceWrapper",null,[]);class mc{constructor(){this.Da=null}get name(){return"Common.App.CatchUpActivity"}$b(f){this.Da=f;this.Da.register(yb,"Common.App.CatchUpActivity.CatchUpNetworkingWrapper").as("Common.App.CatchUpActivity.ICatchUpNetworkingWrapper").ma().oa(()=>new yb(J.AFrameworkApplication.Je,new uc(window.performance)));this.Da.register(Hc,
"Common.App.CatchUpActivity.CatchUpRequestHandler").as("Common.App.CatchUpActivity.ICatchUpRequestHandler").ma().oa(()=>new Hc(this.Da.resolve("Common.App.CatchUpActivity.ICatchUpNetworkingWrapper"),()=>J.AFrameworkApplication.jh,new Ob.a));this.Da.register(jb,"Common.App.CatchUpActivity.FloodgateEventLogger").ma().oa(()=>new jb(this.Da.Ja("Common.ISystemInitiatedFeedback")))}init(){this.Da.resolve("Common.App.CatchUpActivity.ICatchUpNetworkingWrapper");this.Da.resolve("Common.App.CatchUpActivity.ICatchUpRequestHandler")}dispose(){}static main(){Na.a.instance.Dc(new mc)}}
Object(k.a)(mc,"CatchUpActivityPackage",null,[2,3]);var Ya=d(1185),Mb=d(106);class Kc{constructor(f,x,N){this.NWe=this.OWe=this.PWe=!1;this.aXe=!f&&!x;this.bXe=!f&&!N;this.aXe||this.bXe||(this.PWe=!f,this.OWe=!x,this.NWe=!N)}}Object(k.a)(Kc,"RenameDisabledDialogInfo",null,[]);class eb extends Mb.StandardDialog{constructor(f,x,N,ea,ma){super();this.r_e=[];this.h2=new Kc(f,x,N);this.$Oa=ea;this.CNa=ma;this.ig="RenameDisabledDialog";this.xd=0;this.Xe(1,CommonUIStrings.l_DialogClose);this.b$k();this.LVk()}b$k(){this.h2.aXe?
this.Hqc(this.$Oa?this.CNa?CommonUIStrings.l_RenameFileRenameReadOnlyRecommended:CommonUIStrings.l_RenameFileRenameNotEveryoneSupportsRename:CommonUIStrings.l_RenameFileRenameDisabledCoauthFull):this.h2.bXe?this.Hqc(CommonUIStrings.l_RenameFileRenameDisabledPermissionFull):this.u5h();this.ZEc(this.r_e)}Hqc(f){Array.add(this.r_e,f)}u5h(){const f=[];this.h2.PWe||Array.add(f,CommonUIStrings.l_RenameFileRenameDisabledSignIn);this.h2.OWe||Array.add(f,CommonUIStrings.l_RenameFileRenameDisabledPermission);
this.h2.NWe||Array.add(f,CommonUIStrings.l_RenameFileRenameDisabledCoauth);0<f.length&&Array.add(this.r_e,f)}}Object(k.a)(eb,"ReactRenameDisabledDialogBase",Mb.StandardDialog,[]);class Tb extends eb{constructor(f,x,N,ea,ma){super(f,x,N,ea,ma)}LVk(){this.qFb(CommonUIStrings.l_RenameFileRenameDisabledTitle,null,null,null,null,null)}}Object(k.a)(Tb,"ReactRenameDisabledDialog",eb,[]);var lb=d(80);class Fb{static get qg(){return lb.a.gC(Fb.ro,CommonUIStrings.l_RenameFileRenameDisabled,CommonUIStrings.l_RenameFileRenameDisabledSignIn,
CommonUIStrings.l_RenameFileRenameDisabledPermission,CommonUIStrings.l_RenameFileRenameDisabledCoauth)}}Fb.ro="<div class='WACDialogRow' id='RenameRow'> <label id='labelDisabledMessage' class='WACDialogLabel' >{0}</label> <div class='WACDialogRow' id='MultipleSuggestionsRow'> <ul id='ulRenameFileDisabled' class='WACDialogUList'> <li id='liRenameFileRenameDisabledSignIn'>{1}</li> <li id='liRenameFileRenameDisabledPermission'>{2}</li> <li id='liRenameFileRenameDisabledCoauth'>{3}</li> </ul> </div> </div>";
Object(k.a)(Fb,"RenameDisabledDialogHtml",null,[]);class rb extends lb.a{constructor(f,x,N,ea,ma){super();this.h2=new Kc(f,x,N);this.$Oa=ea;this.CNa=ma;this.ig="RenameDisabledDialog";this.xd=0;this.Xe(1,CommonUIStrings.l_DialogClose);this.qg=Fb.qg;this.showDialog(CommonUIStrings.l_RenameFileRenameDisabledTitle,null);this.O5("RenameRow")}Rwa(){if(this.h2.aXe){let f;f=this.$Oa?this.CNa?CommonUIStrings.l_RenameFileRenameReadOnlyRecommended:CommonUIStrings.l_RenameFileRenameNotEveryoneSupportsRename:
CommonUIStrings.l_RenameFileRenameDisabledCoauthFull;rb.Hqc(document.getElementById("ulRenameFileDisabled"),document.getElementById("labelDisabledMessage"),f)}else this.h2.bXe?rb.Hqc(document.getElementById("ulRenameFileDisabled"),document.getElementById("labelDisabledMessage"),CommonUIStrings.l_RenameFileRenameDisabledPermissionFull):this.Vxj()}Vxj(){this.h2.PWe&&(document.getElementById("liRenameFileRenameDisabledSignIn").style.display="none");this.h2.OWe&&(document.getElementById("liRenameFileRenameDisabledPermission").style.display=
"none");this.h2.NWe&&(document.getElementById("liRenameFileRenameDisabledCoauth").style.display="none")}static Hqc(f,x,N){f.style.display="none";x.innerText=N}}Object(k.a)(rb,"RenameDisabledDialog",lb.a,[]);var Qb=d(71);class Bc{constructor(f,x){this.F3a=0;this.Ca=f;this.Gpa=x}initialize(f){if(!this.Ca||!this.Gpa)return!1;this.F3a=f;this.vb();return!0}vb(){this.Ca.ya(ba.a.KJc,Qb.a.frame,Object(v.a)(this,this.KJc,"commitNewDocumentTitle"))}KJc(f,x,N,ea,ma){if(1===N)return this.Ca.processAction(ba.a.renameFile,
1);f=H.a.TG(this.Gpa.Uw);ma=(0,ma.getNewDocumentTitle)();ma.length>this.F3a&&(ma=ma.substr(0,this.F3a));if(32!==this.Ca.La(ba.a.renameFile,2,ma))return this.EOb(f),8;this.EOb(ma);return 32}EOb(f){appChrome.api.dispatch(appChrome.actions.updateDocumentTitle(f))}static iC(){return new Bc(J.AFrameworkApplication.Ta,J.AFrameworkApplication.xu)}}Object(k.a)(Bc,"ReactRenameUIHandler",null,[744]);var wb=d(263),Ad=d(664),bc=d(568),Sb=d(65),Zb=d(178),cb=d(265),Xa=d(133),Lb=d(63);class pc{constructor(f,x,N,
ea,ma,Ha,Ua,mb,gb,Cb,zb,Pb){this._initialized=!1;this._element=null;this.F3a=0;this.$Id=this.qBd=!1;this.Ca=f;this.Awd=x;this.Pg=N;this.Yo=ea;this.Gpa=ma;this.wlf=Ha;this.HCc=Ua;this.vxd=mb;this.Spa=gb;this.vdf=Cb;this.kj=zb;this.kCd=Pb}get isActive(){return"true"===this._element.getAttribute("contentEditable")}initialize(f,x,N){if(!(this.Ca&&this.Gpa&&this.wlf&&this.HCc&&this.vxd&&x)||0>=f)return!1;this._element=x;this._element.title=N;this._element.setAttribute(Xa.a.af,Xa.a.ru);this._element.setAttribute("Unselectable",
"on");this.F3a=f;this.HJ();return this._initialized=!0}HJ(){this.Awd&&(this.Awd.pb(Sb.a.blur,this._element,Object(v.a)(this,this.onBlur,"onBlur")),this.Awd.pb(Sb.a.paste,this._element,Object(v.a)(this,this.jrk,"onPaste")));this.Pg.pb(Sb.a.Zf,this._element,Object(v.a)(this,this.onKeyDown,"onKeyDown"));this.Yo.pb(Sb.a.pointerDown,this._element,Object(v.a)(this,this.Uwa,"onPointerDown"));this.Yo.pb(Sb.a.xR,this._element,Object(v.a)(this,this.BGe,"onPointerUp"))}onBlur(){this.isActive&&!this.qBd&&(this.vdf||
this.vxd(this._element),this.eFf(),this.eYd(!1));return this.qBd=!1}jrk(){e.ULS.sendTraceTag(4281482,203,15,"Attempting to paste into the document title");return!0}onKeyDown(f){return this.isActive?this.Ppk(f):this.Qpk(f)}Ppk(f){let x=!1;switch(f.pc.keyCode){case Sys.UI.Key.enter:this.eFf();this.eYd(this.kj||this.kCd);x=!0;break;case Sys.UI.Key.tab:this.vdf&&this.vxd(this._element);break;case Sys.UI.Key.esc:this.IQe(),this.eYd(this.kj||this.kCd),x=!0}return x}Qpk(f){let x=!1;switch(f.pc.keyCode){case Sys.UI.Key.enter:case Sys.UI.Key.space:this.HCh(this.kCd),
this.isActive&&this.HCc(this._element),x=!0}return x}Uwa(){this.isActive||(this.HCh(!1),this.isActive&&(this._element.focus(),this.HCc(this._element),this.$Id=!0));return!1}BGe(){return this.$Id?(this.HCc(this._element),this.$Id=!1,!0):!1}nzb(){return 32===this.Ca.processAction(ba.a.renameFile,1)}eFf(){const f=H.a.TG(this.Gpa.Uw);let x=this._element.innerText.trim();x.length>this.F3a&&(x=x.substr(0,this.F3a));x!==f&&""!==x?32!==this.Ca.La(ba.a.renameFile,2,x)?this.IQe():this.EOb(x):this.IQe()}IQe(){this.EOb(H.a.TG(this.Gpa.Uw))}EOb(f){this._initialized&&
(this._element.innerText=f,this.wlf())}HCh(f){this.nzb()?this.isActive||(f&&(this.qBd=!0,this._element.blur()),this._element.setAttribute("contentEditable","true"),this._element.removeAttribute("Unselectable"),this._element.setAttribute(Xa.a.af,Xa.a.hwf),this._element.style.width="auto",Sys.UI.DomElement.addCssClass(this._element,wb.CuiHelper.xOf),this.Spa&&this.Spa.execute(x=>{x.Udh(!0)}),f&&this._element.focus(),e.ULS.sendTraceTag(9234188,203,50,"Rename document from header.")):this.Ca.processAction(ba.a.gMb,
2)}eYd(f){this._element.removeAttribute("contentEditable");this._element.setAttribute("Unselectable","on");this._element.setAttribute(Xa.a.af,Xa.a.ru);Sys.UI.DomElement.removeCssClass(this._element,wb.CuiHelper.xOf);this.Spa&&this.Spa.execute(x=>{x.Udh(!1)});f&&(this._element.blur(),this._element.focus())}static m_a(){Ad.a.m_a(J.AFrameworkApplication.isRtl)}static iC(){return new pc(J.AFrameworkApplication.Ta,bc.a.instance,Zb.KeyInputManager.instance,cb.a.instance,J.AFrameworkApplication.xu,pc.m_a,
Lb.a.T1k,Lb.a.ADf,na.a.instance.Ja("Common.App.Header.HeaderEventSource"),fa.a.IF,fa.a.Ni,fa.a.fg)}}Object(k.a)(pc,"RenameUIHandler",null,[744]);class fc{static get instance(){return J.AFrameworkApplication.Aa.hb.WN?fc.Ka||(fc.Ka=Bc.iC()):fc.Ka||(fc.Ka=pc.iC())}}fc.Ka=null;Object(k.a)(fc,"RenameUIHandlerFactory",null,[]);class bd{constructor(){this.FDe=this.Zik=this.DHi=null}}Object(k.a)(bd,"RenameMruEntryProperties",null,[]);var od=d(173),ye=d(124),pd=d(435),ab;(function(f){f[f.unknown=-1]="unknown";
f[f.success=0]="success";f[f.renameInvalidFileName=1]="renameInvalidFileName";f[f.renameInCoauthNotSupported=2]="renameInCoauthNotSupported";f[f.renameNotSupportedInViewMode=3]="renameNotSupportedInViewMode";f[f.permissionDenied=4]="permissionDenied";f[f.serverCommunicationFailure=5]="serverCommunicationFailure";f[f.fileNameTooLong=6]="fileNameTooLong"})(ab||(ab={}));Object(k.b)("CommonOperationResult",ab);class Yb{constructor(f,x,N,ea,ma,Ha,Ua,mb,gb,Cb,zb,Pb){this.Gdf=f;this.Ca=x;this.Qga=N;this.cF=
ea;this.v3a=ma;this.h2h=Ha;this.$Oa=Ua;this.oof=mb;this.HYh=gb;this.CNa=Cb;this.$a=zb;this.GYh=Pb}vb(){J.AFrameworkApplication.Aa&&J.AFrameworkApplication.Aa.hb.WN||this.zn.ya(ba.a.S7b,Qb.a.frame,Object(v.a)(this,this.S7b,"initializeRenameUIHandler"));this.zn.ya(ba.a.gMb,Qb.a.frame,Object(v.a)(this,this.gMb,"showRenameDisabledDialog"));this.zn.ya(ba.a.renameFile,Qb.a.frame,Object(v.a)(this,this.renameFile,"renameFile"));this.zn.ra(ba.a.fileNameUpdate,Qb.a.frame,Object(v.a)(this,this.dOk,"refreshFilename"),
64);this.zn.ra(ba.a.icd,Qb.a.frame,Object(v.a)(this,this.icd,"moveToFolderCompleteByHost"),64);this.zn.ya(ba.a.Tfb,Qb.a.frame,Object(v.a)(this,this.Tfb,"moveToFolder"));(J.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IgnorePostMessageChecksForMove",!0)||J.AFrameworkApplication.Aa&&(J.AFrameworkApplication.fa.ka("PostMessageEmbedded")||J.AFrameworkApplication.fa.ka("IsJsApi"))&&J.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MoveRenameProcess",
!0))&&J.AFrameworkApplication.gT().execute(f=>{f.pu(ye.a.qZg);f.zB(ye.a.qZg,Yb.kMk);f.pu(ye.a.N1d);f.zB(ye.a.N1d,Yb.iMk)})}nzb(){return 0===this.GYh.u3f()?32:8}WBl(){return this.LA?this.$Oa?this.LA.QZd:this.LA.ADa:!0}S7b(){return fc.instance.initialize(J.AFrameworkApplication.MOc,J.AFrameworkApplication.bNc,J.AFrameworkApplication.yih||CommonUIStrings.l_RenameFileTooltip)?32:8}gMb(){const f=this.WBl(),x=this.h2h();e.ULS.sendTraceTag(4059649,203,50,"ShowRenameDisabledDialog: userIsAnonymous = {0}, userCanRename = {1}, userCanRenameInCurrentSession = {2}, userCanRenameInCoauthSessionsWithRenameCapableUsers = {3}",
this.v3a,x,f,this.$Oa);J.AFrameworkApplication.Aa&&J.AFrameworkApplication.Aa.hb.uC&&J.AFrameworkApplication.fa.ka("ReactRenameDisabledDialogIsEnabled")?new Tb(this.v3a,!x,!f,this.$Oa,this.CNa()):new rb(this.v3a,!x,!f,this.$Oa,this.CNa());return 32}renameFile(f,x,N,ea,ma){if(1===N)return this.nzb();if(!J.AFrameworkApplication.$7a)return 8;if(8===this.nzb())return this.zn.processAction(ba.a.gMb,2),8;e.ULS.sendTraceTag(38114562,203,50,"RenameFileAttempt");J.AFrameworkApplication.$7a(ma,Object(v.a)(this,
this.Ejc,"onRenameFileSuccess"),Object(v.a)(this,this.Xrk,"onRenameFileFailure"));return 32}Ejc(f,x){f?0!==f.OperationResult?this.a8f(f.OperationResult):(this.X2k(x,f.NewName),this.fxl(f,Object(v.a)(J.AFrameworkApplication.Aa.hb,J.AFrameworkApplication.Aa.hb.AGh,"updateOpenInClientDocumentUrl")),J.AFrameworkApplication.fa.ka("DocumentNameInJewelInfoMenuIsEnabled")&&J.AFrameworkApplication.Aa.updateCommandUI(),this.HYh.lFh()):this.a8f(5)}X2k(f,x){const N={};N[od.a.HVi]=x;f.sendMessage(ye.a.N1d,N)}fxl(f,
x){this.qxl(f);J.AFrameworkApplication.xMc=f.DirectInvokeDavUrl;x=x(f.EditDocInClientUrl);const N=new bd;N.FDe=this.cF.Uw;N.DHi=x;N.Zik=f.EditDocInClientUrl;this.zn.La(ba.a.zih,2,N)}a8f(f){switch(f){case 1:f=new Mb.StandardDialog,f.xd=0,f.cP(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileInvalidName,null),this.Kkh()}}qxl(f){this.cF.Uw=Yb.Rci(this.cF.Uw,f.NewName);f.BreadcrumbFolderName&&(this.cF.breadcrumbFolderName=f.BreadcrumbFolderName);f.BreadcrumbFolderUrl&&(this.cF.breadcrumbFolderUrl=
f.BreadcrumbFolderUrl);this.oof(f.NewName)}Xrk(f){const x=new Mb.StandardDialog;x.xd=0;switch(f){case 1:e.ULS.sendTraceTag(38114563,203,50,"OnRenameFileFailure: InvalidFileName");x.Yjb(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileInvalidName,null);break;case 6:e.ULS.sendTraceTag(38114564,203,50,"OnRenameFileFailure: FileNameTooLong");x.Yjb(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileNameTooLong,null);break;default:e.ULS.sendTraceTag(38114565,
203,15,"OnRenameFileFailure: {0}",{["Result"]:f}),x.Yjb(CommonUIStrings.l_RenameFileGenericErrorTitle,CommonUIStrings.l_RenameFileGenericError,null)}J.AFrameworkApplication.gT().execute(N=>{N.sendMessage(ye.a.GVi,{["FailureMessage"]:ab[f]})});this.Kkh()}dOk(f,x,N){if(1===N)return this.nzb();if(!J.AFrameworkApplication.zsa)return 8;J.AFrameworkApplication.zsa(Object(v.a)(this,this.CGb,"onRefreshFilenameSuccess"),Object(v.a)(this,this.Sed,"onRefreshFilenameFailure"),!1);return 32}Tfb(f,x,N,ea,ma){if(1===
N)return J.AFrameworkApplication.fa.ka("UiHostSupportsMoveToFolder")?32:8;if(2===N){const Ha={};f=J.AFrameworkApplication.Zab;x=J.AFrameworkApplication.fa.ka("UiHostSupportsDocRebootFeatures");f=(!f||f&&x)&&J.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CrossSiteMove",!1);Ha[od.a.Bml]=f;ma&&ma.MoveButtonClickedTime&&(Ha[od.a.aik]=ma.MoveButtonClickedTime.getTime());J.AFrameworkApplication.gT().execute(Ua=>{Ua.sendMessage(ye.a.Tfb,Ha)});ma&&ma.MoveButtonClickedTime&&
((f=S.a.Lz())&&f.set("MovePostDuration",((new Date).getTime()-ma.MoveButtonClickedTime.getTime()).toString()),A.Health.instance.recordKpiUsage("MoveToFolder",0,"smartfio",f));return 32}return 8}icd(f,x,N,ea,ma){if(1===N)return J.AFrameworkApplication.fa.ka("UiHostSupportsMoveToFolder")?this.nzb():8;if(2===N){if(!J.AFrameworkApplication.Xoc)return A.Health.instance.recordKpiFailure("MoveToFolder","Null SendFileNameAndLocationUpdateNotification",!1,!1,null),8;if(!ma)return A.Health.instance.recordKpiFailure("MoveToFolder",
"Null actiondata",!1,!1,null),8;if(ma[od.a.TJj])if(ma[od.a.uHh])if(f=ma[od.a.uHh].toLowerCase(),x=J.AFrameworkApplication.fa.ka("UiHostSupportsDocRebootFeatures"),N=J.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CrossSiteMove",!1),x&&J.AFrameworkApplication.Zab&&N){const Ha={};Ha[od.a.cJb]="1";Ha[od.a.documentUrl]=f;Ha[od.a.reason]=pd.a.HRe;A.Health.instance.recordKpiSuccess("MoveToFolder",null);J.AFrameworkApplication.gT().execute(Ua=>{Ua.sendMessage(ye.a.VCa,Ha)})}else if(!J.AFrameworkApplication.Zab&&
N)A.Health.instance.recordKpiSuccess("MoveToFolder",null),Lb.a.un(f,Lb.a.Raa(3),void 0,"RenameActor.MoveToFolderCompleteByHost");else return A.Health.instance.recordKpiFailure("MoveToFolder","CrossSite Unsupported",!1,!1,null),8;else A.Health.instance.recordKpiFailure("MoveToFolder","Null newDocUrl",!1,!1,null);else J.AFrameworkApplication.zsa(Object(v.a)(this,this.CGb,"onRefreshFilenameSuccess"),Object(v.a)(this,this.Sed,"onRefreshFilenameFailure"),!1),J.AFrameworkApplication.Xoc(),A.Health.instance.recordKpiSuccess("MoveToFolder",
null)}return 32}zel(f,x){return f&&x?f!==this.cF.breadcrumbFolderName||x!==this.cF.breadcrumbFolderUrl:!1}CGb(f,x){f&&(f.NewName!==H.a.TG(this.cF.Uw)||this.zel(f.BreadcrumbFolderName,f.BreadcrumbFolderUrl))&&this.Ejc(f,x)}Sed(){}Kkh(){this.oof(H.a.TG(this.cF.Uw))}get zn(){return this.Ca.value}get LA(){return this.Qga.value}static get instance(){return Yb.Ka||(Yb.Ka=Yb.Q8a())}static Q8a(){return new Yb(J.AFrameworkApplication.Q9b,new Ya.a(()=>J.AFrameworkApplication.Ta),new Ya.a(()=>J.AFrameworkApplication.LA),
J.AFrameworkApplication.xu,J.AFrameworkApplication.LQ,()=>J.AFrameworkApplication.Vtc,J.AFrameworkApplication.Knc,Object(v.a)(fc.instance,fc.instance.EOb,"updateTitle"),na.a.instance.resolve("Common.App.Rename.IRenamedFileChecker"),()=>J.AFrameworkApplication.yT,J.AFrameworkApplication.fa,na.a.instance.resolve("Common.IRenameProps"))}static Rci(f,x){f=H.a.bT(f);return x+f}static kMk(f){const x=f.Values[od.a.tOj];e.ULS.sendTraceTag(560820289,204,50,"Host_MoveToFolder Received IsSuccessful: {0}",x);
x?J.AFrameworkApplication.Ta.La(ba.a.icd,2,f.Values):A.Health.instance.recordKpiFailure("MoveToFolder","MoveToFolder Server Failure",!1,!1,null)}static iMk(f){J.AFrameworkApplication.Ta.La(ba.a.renameFile,2,f.Values.NewName)}}Yb.Ka=null;Object(k.a)(Yb,"RenameActor",null,[]);var Sc=d(383),Jb=d(649),Oc=d(588),Wb=d(196);class Ab{constructor(f,x){this.Ca=f;this.Dyd=x}vb(){this.Ca.ya(ba.a.WWe,Qb.a.frame,Object(v.a)(this,this.$gl,"showRenameDialogAction"))}$gl(f,x,N){f=32;if(1===N)return Wb.SessionStatusManager.instance.eka||
J.AFrameworkApplication.GQ?8:32;2===N&&(32!==this.Ca.processAction(ba.a.renameFile,1)?(this.Ca.processAction(ba.a.gMb,2),Sc.a.instance.Wb(Jb.a.vja,{["Reason"]:Oc.a.nVk}),f=8):32===this.Ca.processAction(ba.a.Gqc,1)?this.Ca.processAction(ba.a.Gqc,2):this.Dyd.value.create().T5());return f}}Object(k.a)(Ab,"RenameDialogActor",null,[779]);class Xb{constructor(f,x,N){this.dialog=null;this.Ca=f;this.cF=x;this.eNa=N}Cfj(){const f={};f.nameInputProps={["type"]:"AppInputProps",["id"]:Xb.gub,["label"]:CommonUIStrings.l_RenameDialogLabel,
["value"]:H.a.TG(this.cF.Uw),["maxLength"]:this.eNa};return f}T5(){const f={["id"]:"RenameDialog",["bodyControls"]:this.Cfj()};this.dialog=new lb.a(!1,!1,!0);this.dialog.xd=1;this.dialog.ig="RenameDialog";this.dialog.$i(CommonUIStrings.l_RenameDialogTitle,Object(v.a)(this,this.xPe,"renameDialogHandler"),f)}xPe(f,x){if(x&&1===f){if(x[Xb.gub]&&(f=H.a.TG(this.cF.Uw),x=(x[Xb.gub]||"").trim(),x!==f&&""!==x)){this.Ca.La(ba.a.renameFile,2,x);return}Sc.a.instance.Wb(Jb.a.Q1b,{["Reason"]:Oc.a.jTf})}}}Xb.gub=
"txtDocumentName";Object(k.a)(Xb,"ReactRenameDialog",null,[800]);class vb{static get qg(){return lb.a.gC(vb.ro,CommonUIStrings.l_RenameDialogLabel)}}vb.ro="<div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblDocumentName' class='WACDialogLabel' for='txtDocumentName' >{0}</label> <input type='text' id='txtDocumentName' class='WACDialogInput' autocomplete=\"off\"/> </div>";Object(k.a)(vb,"RenameDialogHtml",null,[]);class $c extends lb.a{constructor(f,x,N){super();this.Ca=f;this.cF=x;this.eNa=
N;this.ig="RenameDialog";this.qg=vb.qg}T5(){var f={["txtDocumentName"]:H.a.TG(this.cF.Uw)};this.$i(CommonUIStrings.l_RenameDialogTitle,Object(v.a)(this,this.xPe,"renameDialogHandler"),f);f=document.getElementById($c.gub);0<this.eNa&&(f.maxLength=this.eNa);f.focus()}xPe(f,x){if(1===f&&(f=H.a.TG(this.cF.Uw),x=(x[$c.gub]||"").trim(),x!==f&&""!==x)){this.Ca.La(ba.a.renameFile,2,x);return}Sc.a.instance.Wb(Jb.a.Q1b,{["Reason"]:Oc.a.jTf})}}$c.gub="txtDocumentName";Object(k.a)($c,"RenameDialog",lb.a,[800]);
class fd{constructor(f){this.Gpa=null;this.eNa=0;this.Ca=f;this._initialized=!1}initialize(f,x){this.Gpa=f;this.eNa=x;this._initialized=!0}create(){return this._initialized?J.AFrameworkApplication.Aa&&J.AFrameworkApplication.Aa.hb.uC&&J.AFrameworkApplication.fa.ka("ReactRenameDialogIsEnabled")?new Xb(this.Ca,this.Gpa,this.eNa):new $c(this.Ca,this.Gpa,this.eNa):null}}Object(k.a)(fd,"RenameDialogFactory",null,[778]);var Bd=d(119),gd=d(102),Pd=d(70),cd=d(79),lf=d(132);class Jd{constructor(f,x){this.Ca=
f;this.Od=x}vb(){this.Ca.ya(ba.a.Gqc,Qb.a.frame,Object(v.a)(this,this.ahl,"showRenameFlyoutAction"))}goi(){return Pd.d("setDocumentTitleFlyoutOpened")&&J.AFrameworkApplication.Aa.hb.WN}ahl(f,x,N){if(1===N)return this.goi()?32:8;appChrome.api.dispatch(appChrome.actions.setDocumentTitleFlyoutOpened(!0));return 32}z6h(){Jd.PSj&&J.AFrameworkApplication.jua&&lf.a.instance.Eb(new cd.a(5,1,5E3,()=>{32===this.Ca.processAction(ba.a.Gqc,1)&&this.Od&&this.Od.Be.name===Bd.AFrame.wW&&(gd.a("RenameFloatieShownOnNewDocumentLoad",
!0),this.Ca.processAction(ba.a.Gqc,2))}))}static get PSj(){Jd.lzc&&null!=Jd.lzc||(J.AFrameworkApplication.PFa("ShowRenameFlyoutOnNewDocumentLoad;ShowRenameFlyoutOnNewDocumentLoadCf"),Jd.lzc=J.AFrameworkApplication.fa?J.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShowRenameFlyoutOnNewDocumentLoadIsEnabled",!1):!1);return Jd.lzc}}Jd.lzc=null;Object(k.a)(Jd,"RenameFlyoutActor",null,[777]);class Xf{constructor(f,x,N,ea,ma){this.rUd=null;this.Qga=ma;this.Hdf=N;this.Gdf=
ea;this.j2h=f;this.CNa=x}get LA(){return this.Qga.value}u3f(){if(!this.Gdf())return 5;if(this.CNa())return 1;if(this.LA){if(this.Hdf&&!this.LA.QZd)return 3;if(!this.Hdf&&!this.LA.ADa)return 4}return this.j2h()?0:2}}Object(k.a)(Xf,"RenameProps",null,[776]);var ee=d(67);class Ra{constructor(f,x,N,ea,ma,Ha){this.NB=!1;this.TDd=new ee.a;this.jnb=x;this.Ewc=N;this.Rvc=ea;this.$a=ma;this.Uha=Ha}enable(){this.NB||(this.lFh(),this.nYe(),this.NB=!0)}generateKey(f,x,N){return String.format("{0}/{1}/{2}",N,
f,x)}I$i(){const f=H.a.TG(this.jnb().Uw);return this.generateKey(this.jnb().breadcrumbFolderName,this.jnb().breadcrumbFolderUrl,f)}J$i(f,x,N){return f&&x?this.generateKey(f,x,N):N}sLi(f,x,N){return f&&f!==this.jnb().breadcrumbFolderName||x&&x!==this.jnb().breadcrumbFolderUrl?!0:N!==H.a.TG(this.jnb().Uw)}lFh(){const f=this.I$i();this.TDd.$(f,new Date)}FIe(f){this.adl(f)&&this.xpf(f)}adl(f){const x=this.Rvc();return x?this.Uha&&this.Uha.zab||!x.die||!J.AFrameworkApplication.zsa?(this.Yxh(f),this.NB=
!1):!0:!1}e6g(f,x,N,ea){const ma=this.sLi(f,x,N);f=this.J$i(f,x,N);x=this.TDd.Uf(f).returnValue;ma&&!x&&(this.d8f(ea),e.ULS.sendTraceTag(591734297,203,50,"{0} forced FileNameUpdate",this.ane));ma||this.TDd.$(f,this.Ewc())}}Object(k.a)(Ra,"ARenamedFileChecker",null,[686]);class sb extends Ra{constructor(f,x,N,ea,ma,Ha,Ua,mb){super(f,x,N,ea,ma,Ha);this.dkf=ma;this.FYh=Ua;this.eBd=mb}get ane(){return"RenamedFileCheckerUsingSettingsRefresh"}nYe(){this.dkf.iOd(Object(v.a)(this,this.c9f,"handleSettingsRefresh"))}c9f(f,
x){x&&x.Hic&&x.klk&&(x.yzb("BreadcrumbDocName")||x.yzb("BreadcrumbFolderName")||x.yzb("BreadcrumbFolderUrl")||x.yzb("DirectInvokeDAVUrl")||x.yzb("EditDocInClientUrl"))&&(e.ULS.sendTraceTag(591229211,203,50,"{0}: Possible rename detected.",this.ane),this.FIe(x))}Yxh(){this.dkf.mUk(Object(v.a)(this,this.c9f,"handleSettingsRefresh"))}xpf(f){if(f&&f.Hic){const x=f.Hic;this.e6g(x.Ha("BreadcrumbFolderName"),x.Ha("BreadcrumbFolderUrl"),x.Ha("BreadcrumbDocName"),f)}}d8f(f){const x={OperationResult:0,classId:1};
f=f.Hic;x.BreadcrumbFolderName=f.Ha("BreadcrumbFolderName");x.BreadcrumbFolderUrl=f.Ha("BreadcrumbFolderUrl");x.DirectInvokeDavUrl=f.Ha("DirectInvokeDAVUrl");x.EditDocInClientUrl=f.Ha("EditDocInClientUrl");f=f.Ha("BreadcrumbDocName");x.NewName=J.AFrameworkApplication.YMc?f:H.a.TG(f);this.eBd.execute(N=>{this.BGj(x,N)})}BGj(f,x){this.FYh().Ejc(f,x)}}Object(k.a)(sb,"RenamedFileCheckerUsingSettingsRefresh",Ra,[]);class ec extends Ra{constructor(f,x,N,ea,ma,Ha,Ua,mb,gb,Cb){super(f,N,ea,ma,Ha,gb);this.mVb=
this.EEc=null;this.wXh=x;this.Ca=Ua;this.Wd=mb;Cb&&Cb.execute(zb=>{this.NQk(zb)})}get ane(){return"RenamedFileCheckerUsingTask"}NQk(f){this.EEc=f;this.EEc.TFc(Object(v.a)(this,this.P6b,"handleVisibilityChange"))}P6b(f,x){!this.NB||0!==x.newState&&1!==x.newState||this.mVb||(this.nYe(),this.FIe(this.mVb))}nYe(){this.mVb=new cd.a(3,2,this.wXh(),Object(v.a)(this,this.FIe,"performRenameFileCheckTick"),89);this.Wd.Eb(this.mVb)}Yxh(f){this.Wd.Rg(f)}xpf(f){this.EEc&&2===this.EEc.R5a?this.RRk(f):J.AFrameworkApplication.zsa(Object(v.a)(this,
this.CGb,"onRefreshFilenameSuccess"),Object(v.a)(this,this.Sed,"onRefreshFilenameFailure"),!0)}RRk(f){this.Wd.Rg(f);this.mVb=null}CGb(f){f&&this.e6g(f.BreadcrumbFolderName,f.BreadcrumbFolderUrl,f.NewName,null)}d8f(){this.Ca.processAction(ba.a.fileNameUpdate,2)}Sed(){}}Object(k.a)(ec,"RenamedFileCheckerUsingTask",Ra,[]);var Lc=d(93);class nd{constructor(){this.$a=this.Da=null}get name(){return"Common.App.RenameFile"}$b(f){this.Da=f;this.$a=J.AFrameworkApplication.fa;this.Da.register(Ab,"Common.App.Rename.RenameDialogActor").as("Common.App.Rename.IRenameDialogActor").oa(()=>
new Ab(J.AFrameworkApplication.Ta,this.Da.re("Common.App.Rename.IRenameDialogFactory"))).ma();this.Da.register(fd,"Common.App.Rename.RenameDialogFactory").as("Common.App.Rename.IRenameDialogFactory").oa(()=>new fd(J.AFrameworkApplication.Ta)).ma();this.Da.register(686,"Common.App.Rename.IRenamedFileChecker").oa(()=>this.WEi()).ma();this.Da.register(Jd,"Common.App.Rename.RenameFlyoutActor").as("Common.App.Rename.IRenameFlyoutActor").oa(()=>new Jd(J.AFrameworkApplication.Ta,Lc.FocusManager.instance())).ma()}WEi(){if(this.$a.ka("RenamedFileCheckerWithSettingsRefreshIsEnabled")){const f=
this.Da.rb("Common.IRefreshableAppSettings");if(f&&f.pRj)return new sb(()=>f.Fc("RenamedFileCheckerMaxCachedAgeInMs",48E4),()=>J.AFrameworkApplication.xu,()=>new Date,()=>J.AFrameworkApplication.LA,f,this.Da.rb("Common.ISessionStatus"),()=>Yb.instance,this.Da.Ja("Postmessage.IHostPostmessenger"))}return new ec(()=>this.$a.Fc("RenamedFileCheckerMaxCachedAgeInMs",48E4),()=>this.$a.Fc("RenamedFileCheckerPingIntervalInMs",12E4),()=>J.AFrameworkApplication.xu,()=>new Date,()=>J.AFrameworkApplication.LA,
J.AFrameworkApplication.fa,J.AFrameworkApplication.Ta,J.AFrameworkApplication.we,this.Da.rb("Common.ISessionStatus"),this.Da.Ja("Common.App.VisibilityManagement.IVisibilityManager"))}init(){this.$a.jf(Object(v.a)(this,this.Om,"onFullAppSettingsReady"))}Om(){const f=J.AFrameworkApplication.Aa.hb.WN;J.AFrameworkApplication.Q9b()&&fc.instance.initialize(J.AFrameworkApplication.MOc,f?null:J.AFrameworkApplication.bNc,f?null:J.AFrameworkApplication.yih||CommonUIStrings.l_RenameFileTooltip)&&(this.Da.register(Xf,
"Common.App.Rename.RenameProps").as("Common.IRenameProps").oa(()=>new Xf(()=>J.AFrameworkApplication.Vtc,()=>J.AFrameworkApplication.yT,J.AFrameworkApplication.Knc,J.AFrameworkApplication.Q9b,new Ya.a(()=>J.AFrameworkApplication.LA))).ma(),Yb.instance.vb(),this.$a.ka("RenameDialogIsEnabled")&&(this.Da.resolve("Common.App.Rename.RenameDialogFactory").initialize(J.AFrameworkApplication.xu,J.AFrameworkApplication.MOc),this.Da.resolve("Common.App.Rename.IRenameDialogActor").vb()),this.Da.resolve("Common.App.Rename.IRenameFlyoutActor").vb(),
J.AFrameworkApplication.Knc&&this.Da.resolve("Common.App.Rename.IRenamedFileChecker").enable(),this.Da.resolve("Common.App.Rename.IRenameFlyoutActor").z6h())}dispose(){}}Object(k.a)(nd,"PackageManager",null,[2,3]);const Fd=f=>{try{return R.a(f)}catch(x){}return null};class Ja{constructor(f,x,N,ea,ma,Ha){this.e2=!1;this.pS=null;this.TGd=!1;this.Ca=f;this.ei=x;this.Qga=N;this.sff=ea;this.$a=ma;this.GUh=Ha}init(f,x){x&&f.Ja("Common.Interface.IRtcBasicProvider").execute(Object(v.a)(this,this.OQd,"awaitRtc"))}OQd(f){const x=
f.fM.task;x.continueWith(()=>{this.pS=x.result;this.TGd&&(this.pS.Lfa(2,null,!0),this.TGd=!1);this.pS.FBa((N,ea)=>{2===ea.type&&this.zn.processAction(ba.a.fileNameUpdate,2)});this.pS.K5a((N,ea)=>{2===ea.newState&&this.zn.processAction(ba.a.fileNameUpdate,2)});2===this.pS.connectionState&&this.zn.processAction(ba.a.fileNameUpdate,2)})}zsa(f){this.uRf(f,!0)}uRf(f,x){const N=this.bki(f.Wvh),ea={};ea[Ja.aGf]=Ja.bGf;this.Rjh.Aj(N,2,"",ea,!1,2,Object(v.a)(this,this.CGb,"onRefreshFilenameSuccess"),x?Object(v.a)(this,
this.Srk,"onRefreshFilenameFailureRetry"):Object(v.a)(this,this.W4g,"onRefreshFilenameFailureNoRetry"),f)}CGb(f){this.e2=!1;const x=Fd(f.data.Zd);f.data.state.onSuccess(x,this.sff.value)}Srk(f){5!==f.data.status||this.e2?this.W4g(f):(this.e2=!0,this.uRf(f.data.state,!1))}W4g(f){f.data.state.oz(-1)}$7a(f){this.vRf(f,!0)}vRf(f,x){const N=this.cki(),ea={};ea[Ja.aGf]=Ja.bGf;ea[Ja.Nvj]=H.a.Ke(f.akh);ea[Ja.Lvj]=this.GUh.value.rUd;this.Rjh.Aj(N,2,"",ea,!1,2,Object(v.a)(this,this.Ejc,"onRenameFileSuccess"),
x?Object(v.a)(this,this.Yrk,"onRenameFileFailureRetry"):Object(v.a)(this,this.b5g,"onRenameFileFailureNoRetry"),f)}cki(){return this.Iyf()}bki(f){let x=this.Iyf();return x=u.a.Wi(x,Ja.Rvj,f?"2":"1")}Iyf(){let f=(this.$a.value.appSettings.RenameWebServiceBase||"")+Ja.Mvj;f=u.a.Wi(f,Ja.Ovj,H.a.Ke(J.AFrameworkApplication.jh));this.LA&&this.LA.die&&(f=u.a.Wi(f,Ja.Qvj,"1"));return f}Ejc(f){this.e2=!1;const x=Fd(f.data.Zd);f.data.state.onSuccess(x,this.sff.value);this.R_g()}R_g(){this.pS?this.pS.Lfa(2,
null,!0):this.TGd=!0}Yrk(f){5!==f.data.status||this.e2?this.b5g(f):(this.e2=!0,this.vRf(f.data.state,!1))}b5g(f){f.data.state.oz(-1)}get zn(){return this.Ca.value}get Rjh(){return this.ei.value}get LA(){return this.Qga.value}static get instance(){return Ja.Ka||(Ja.Ka=Ja.Q8a())}static Q8a(){return new Ja(new Ya.a(()=>J.AFrameworkApplication.Ta),new Ya.a(()=>J.AFrameworkApplication.Je),new Ya.a(()=>J.AFrameworkApplication.LA),new Ya.a(()=>na.a.instance.resolve("Postmessage.IHostPostmessenger")),new Ya.a(()=>
J.AFrameworkApplication.fa),new Ya.a(()=>na.a.instance.resolve("Common.IRenameProps")))}}Ja.aGf="Content-Type";Ja.bGf="application/json; charset=utf-8";Ja.Mvj="renamehandler.ashx";Ja.Ovj="qs";Ja.Nvj="n";Ja.Qvj="sl";Ja.Lvj="X-CoauthLockId";Ja.Rvj="u";Ja.Ka=null;Object(k.a)(Ja,"ExecuteRenameFileHandler",null,[]);class db{constructor(){this.oz=this.onSuccess=null;this.Wvh=!1}}Object(k.a)(db,"ExecuteRefreshFilenameData",null,[]);class ic{constructor(){this.oz=this.onSuccess=this.akh=null}}Object(k.a)(ic,
"ExecuteRenameFileData",null,[]);class id{constructor(){this.Da=null;this.Ezd=Ja.instance}get name(){return"Common.App.RenameFile.RenameExecutor"}$b(f){this.Da=f}init(){J.AFrameworkApplication.fa.jf(Object(v.a)(this,this.Om,"onFullAppSettingsReady"))}Om(){J.AFrameworkApplication.Q9b()&&(Ja.instance.init(this.Da,J.AFrameworkApplication.Knc),J.AFrameworkApplication.$7a=Object(v.a)(this,this.$7a,"executeRenameFile"),J.AFrameworkApplication.zsa=Object(v.a)(this,this.zsa,"executeRefreshFilename"),J.AFrameworkApplication.Xoc=
Object(v.a)(this,this.Xoc,"sendFileNameAndLocationUpdateNotification"))}$7a(f,x,N){const ea=new ic;ea.akh=f;ea.onSuccess=x;ea.oz=N;this.Ezd.$7a(ea)}zsa(f,x,N){const ea=new db;ea.onSuccess=f;ea.oz=x;ea.Wvh=N;this.Ezd.zsa(ea)}Xoc(){this.Ezd.R_g()}dispose(){}}Object(k.a)(id,"PackageManager",null,[2,3]);class qd{constructor(f,x,N,ea,ma,Ha){this.PolicyCookie=this.WebAffinitizedUrl=this.IsSafeLinksEnabled=null;this.PolicyCookieTTL=0;this.WasServiceDown=!1;this.AffinitizedUrl=null;this.IsSafeLinksEnabled=
f;this.WebAffinitizedUrl=x;this.PolicyCookie=N;this.PolicyCookieTTL=ea;this.WasServiceDown=ma;this.AffinitizedUrl=Ha}}Object(k.a)(qd,"SafeLinksData",null,[]);class Fc{constructor(f,x){this.frd=f;this.Ay=x}}Object(k.a)(Fc,"SafeLinksGetUrlReputationRequestData",null,[]);class Ze{constructor(f,x,N,ea){this.$a=f;this.ei=x;this.tRh=N;Ze.Xh=ea}Fsd(f,x,N){try{var ea=null;Ze.Xh&&(ea=Ze.Xh.Ci("WebServiceCall","SafeLinksGetUrlReputation"));const ma=new Fc(x,ea);ea={};ea.AffinitizedUrl=f;ea.TargetUrl=x;ea.PolicyCookie=
N;const Ha=R.c(ea);this.ei.Aj(this.tRh,2,Ha,null,!1,2,Object(v.a)(this,this.apk,"onGetUrlReputationSuccessCallback"),Object(v.a)(this,this.$ok,"onGetUrlReputationFailureCallback"),ma,void 0,void 0,3E3,3E3,"36");return!0}catch(ma){e.ULS.sendTraceTag(588788033,378,10,ma.message)}return!1}apk(f){let x="OnGetUrlReputationSuccessCallback: ",N=10;const ea=f.data.state;try{const ma=R.b(f.data.Zd).reputationResults[0],Ha=ma.navigateUrl.length,Ua=ea.frd.length,mb=ma.navigateUrl===ea.frd;ma.navigateUrl&&0<
ma.navigateUrl.length&&(ea.frd=ma.navigateUrl);x+=String.format("HttpStatus {0}, verdict {1}, clickedUrlLength = {2} navigateUrlLength {3}, navigateUrlSameAsClickedUrl {4}",f.data.Te,ma.verdict,Ua.toString(),Ha.toString(),mb.toString());N=50}catch(ma){x+=String.format("Exception {0}",ma.message)}this.i8f(ea,x,N)}$ok(f){let x="OnGetUrlReputationFailureCallback: ";const N=f.data.state;try{x+=String.format("HttpStatus {0}",f.data.Te)}catch(ea){x+=String.format("Exception {0}",ea.message)}this.i8f(N,
x,10)}i8f(f,x,N){f.Ay&&(f.Ay.stop(),f.Ay=null);e.ULS.sendTraceTag(588788034,378,N,x);Lb.a.un(f.frd,void 0,"noopener,noreferrer","SafeLinksNav")}}Ze.Xh=null;Object(k.a)(Ze,"SafeLinksNavigationHelper",null,[]);var df;(function(f){f[f.enabledByPolicy=0]="enabledByPolicy";f[f.disabledByPolicy=1]="disabledByPolicy";f[f.disabled_GetPolicyFailure=2]="disabled_GetPolicyFailure";f[f.disabled_PendingGetPolicyRequest=3]="disabled_PendingGetPolicyRequest"})(df||(df={}));Object(k.b)("SafeLinksNavigationState",
df);var ve=d(492);class md{constructor(f,x,N,ea=!1,ma=null,Ha=null){this.N2a=this.M2a=0;this.Z8b=this.Yxc=!1;this.pOa=null;this.fob=!0;this.PCc=null;e.ULS.sendTraceTag(26019598,378,100,"Initializing SafeLinksManager.");this.$a=f;this.ei=x;this.ppa=N;md.Xh=Ha;this.C2h=ea?this.$a.Ha("SafeLinksHandlerWebServiceBase"):this.$a.Ha("WebServiceBase");this.k2h=this.$a.Ha("SafeLinksHashedUserId");this.xFl=this.$a.Ha("SafeLinksWorkloadIdHeaderValue");this.$zc=this.$a.Fc("SafeLinksMaxGetPolicyBootRetries",2);
this.aAc=this.$a.Fc("SafeLinksMaxGetPolicyOnLinkClickRetries",1);this.Qyc=this.TRj();this.Pyc=this.SRj();e.ULS.sendTraceTag(26019599,378,50,"SafeLinksManager _isEnabledForUser={0}, _isEnabledForBrowser={1}",this.Qyc,this.Pyc);if(this.Qyc&&this.Pyc){x=(f=this.Hvb())?f.IsSafeLinksEnabled.toLowerCase():"";N=this.Eje();e.ULS.sendTraceTag(36231312,378,50,"Cached values for IsSafeLinksEnabled: {0}, IsPolicyCookieExpired: {1}.",x,N);var Ua=!f||"unknown"===x||f.WasServiceDown||N,mb=S.a.Lz();mb&&(mb.set("shouldGetSafeLinksDataFromServer",
Ua.toString()),mb.set("isSafeLinksEnabledCacheValue",x.toString()));ma?(this.fob=!1,ma.execute(gb=>{gb.isFeatureEnabled("MsoUrlreputation",!0).then(Cb=>{this.fob=Cb;mb.set("isUserLicensedForSafeLinks",this.fob.toString());A.Health.instance.recordKpiUsage("SafeLinksGetPolicy1",0,"jpittsdirects",mb);this.fob&&Ua&&this.dTc(!0);return null})})):(A.Health.instance.recordKpiUsage("SafeLinksGetPolicy1",0,"jpittsdirects",mb),Ua&&this.dTc(!0))}}get appName(){return this.ppa}get yud(){return this.C2h}get userId(){return this.k2h}get hej(){const f=
this.yud?this.yud+"/":"",x=new da.QueryStringBuilder("SafeLinksHandler.ashx");x.Ki("app",this.appName);this.$a.ka("SafeLinksUseDebugHeader")&&x.Ki("action","debug");this.$a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthAATPOP",!1)&&x.Ki("s2satpop","1");this.$a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthUseE03App",!1)&&x.Ki("s2se03","1");return String.format("{0}{1}&{2}",f,x.toString(),J.AFrameworkApplication.jh)}get Ylj(){const f=this.yud?this.yud+
"/":"",x=new da.QueryStringBuilder("SafeLinksHandler.ashx");x.Ki("app",this.appName);this.$a.ka("SafeLinksUseDebugHeader")&&x.Ki("action","debug");this.$a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthAATPOP",!1)&&x.Ki("s2satpop","1");this.$a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthAAT",!1)&&x.Ki("s2saat","1");this.$a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthUseE03App",!1)&&x.Ki("s2se03","1");x.Ki("slrt","GetUrlReputation");
return String.format("{0}{1}&{2}",f,x.toString(),J.AFrameworkApplication.jh)}get Nik(){md.JId||(md.JId=new Ze(this.$a,this.ei,this.Ylj,md.Xh));return md.JId}Fsd(f){if(!f)return e.ULS.sendTraceTag(593367827,378,10,"SafeLinksManager.TryNavigate: Null/Empty targetUrl"),!1;var x=this.IMj(f);e.ULS.sendTraceTag(594830615,378,50,"SafeLinksManager.TryNavigate: isSupportedHyperLinkType={0},_isEnabledForUser={1},_isEnabledForBrowser={2},_isUserLicensedForSafeLinks={3}",x,this.Qyc,this.Pyc,this.fob);if(!(x&&
this.Qyc&&this.Pyc&&this.fob))return!1;x=0;const N=({state:x}=this.xel()).returnValue;e.ULS.sendTraceTag(595079385,378,50,"ShouldTryUsingSafeLinksService returned NavigationState={0}",df[x]);const ea=S.a.Lz();ea&&ea.set("SafeLinksNavigationState",df[x]);A.Health.instance.recordKpiUsage("SafeLinksNavigations",0,"jpittsdirects",ea);if(!N)return 2!==x&&3!==x||A.Health.instance.recordKpiFailure("SafeLinksNavigations",df[x],!1,!0,null),!1;e.ULS.sendTraceTag(26019601,378,50,"Using safelinks to navigate hyperlink");
if(this.Lel())return this.Eje()?!1:this.Nik.Fsd(this.B1i(),f,this.P2f());if(!this.Eje())return this.wDh(f),!0;this.pOa=f;e.ULS.sendTraceTag(24462627,378,50,"Refreshing the cache as policy cookie expired.");this.Z8b=!1;this.dTc();return!0}IMj(f){f=f.toLowerCase();const x=this.$a.RA("SafeLinksUnsupportedProtocols");if(x)for(let N=0;N<x.length;N++)if(f.startsWith(x[N]))return!1;return!0}dTc(f=!1){var x=S.a.Lz();x&&x.set("isOnBootRequest",f.toString());A.Health.instance.recordKpiUsage("SafeLinksGetPolicySuccessfulRequest",
1,"jpittsdirects",x);A.Health.instance.recordKpiUsage("SafeLinksGetPolicyFailedRequest",0,"jpittsdirects",x);x=this.bWd("SafeLinksGetPolicy");this.ei.Aj(this.hej,1,null,null,!0,2,Object(v.a)(this,this.ygj,"getSafeLinksDataFromServer_OnSuccessCallback"),Object(v.a)(this,this.xgj,"getSafeLinksDataFromServer_OnFailureCallback"),x,void 0,void 0,void 0,void 0,"23");this.Z8b=f;this.Yxc=!0;f?this.M2a++:this.N2a++}ygj(f){let x=E.a.Pjk,N="";try{this.Yxc=this.Z8b=!1;var ea=f.data.state;const Pb=({Ay:ea}=this.lqd(ea)).returnValue,
oc=Object.assign(new Ea.a,{durationMs:Pb});A.Health.instance.recordKpiSuccess("SafeLinksGetPolicySuccessfulRequest",oc);e.ULS.sendTraceTag(594830614,378,50,"GetSafeLinksDataFromServer_OnSuccessCallback: HttpStatus {0}, data length {1}, Duration {2}",f.data.Te,f.data.Zd.length,Pb);if(f.data.Te!==E.a.Ey)N="Unexpected httpStatus: "+f.data.Te.toString();else{ea=null;try{ea=R.b(f.data.Zd)}catch(Ec){N="Exception:"+Ec.toString()+" deserializing response";return}if(ea){var ma=ea.IsSafeLinksEnabled;if(void 0===
ma||null===ma||0>=ma.length)N="Invalid isSafeLinksEnabledString";else{e.ULS.sendTraceTag(594830613,378,50,"Retrieved isSafeLinksEnabledString {0}",ma);var Ha=md.iIe(ma);if(void 0===ea.WebAffinitizedUrl||null===ea.WebAffinitizedUrl||0>=ea.WebAffinitizedUrl.length)N="Invalid WebAffinitizedUrl";else if(void 0===ea.PolicyCookie||null===ea.PolicyCookie||0>=ea.PolicyCookie.length)N="Invalid PolicyCookie";else if(void 0===ea.PolicyCookieTTL||null===ea.PolicyCookieTTL)N="Invalid PolicyCookieTTL";else{var Ua=
ea.WebAffinitizedUrl,mb=ea.PolicyCookie,gb=ea.AffinitizedUrl,Cb=new Date;Cb.setMinutes(Cb.getMinutes()+(5<ea.PolicyCookieTTL?ea.PolicyCookieTTL-5:0));var zb=new qd(ma,Ua,mb,Cb.getTime(),!1,gb);this.Toh(zb);x=f.data.Te;this.pOa&&(Ha?(this.wDh(this.pOa),this.N2a=this.M2a=0):(e.ULS.sendTraceTag(26019602,378,50,"SafeLinks is disabled by admin; Navigating without SafeLinks"),A.Health.instance.recordKpiFailure("SafeLinksNavigations","disabledByPolicy",!0,!0,null),Lb.a.yPc(this.pOa)),this.pOa=null)}}}else N=
"Error when serializing response into SafeLinksData. SafeLinksData is null."}}catch(Pb){N="GetSafeLinksDataFromServer_OnSuccessCallback: Exception:  "+Pb.toString()}finally{x!==E.a.Ey&&this.h8f(x,N)}}xgj(f){this.Yxc=!1;let x=500,N="";try{let ea=f.data.state;const ma=({Ay:ea}=this.lqd(ea)).returnValue,Ha=Object.assign(new Ea.a,{durationMs:ma});x=f.data.Te;A.Health.instance.recordKpiFailure("SafeLinksGetPolicyFailedRequest","HttpStatusCode_"+x.toString(),!1,!0,Ha);N="Request Failed, Status="+ve.a[f.data.status]+
" Duration: "+ma}catch(ea){N="GetSafeLinksDataFromServer_OnFailureCallback Exception: "+ea.toString()}finally{this.h8f(x,N)}}h8f(f,x=""){try{if(e.ULS.sendTraceTag(594830612,378,10,"HandleGetPolicyRequestError: HttpStatus {0}, Error {1}",f,x),this.M2a<this.$zc&&this.N2a<this.aAc)this.dTc(this.Z8b);else{this.Z8b=!1;e.ULS.sendTraceTag(24462656,378,10,"Exhausted all retries for SafeLinks GetPolicy call. OnBootRetries: {0}, OnClickRetries: {1}, HttpStatus: {2}, Error: {3}",this.M2a,this.N2a,f,x);x=null;
const N=S.a.Lz();N&&(N.set("HttpStatus",f.toString()),x=Object.assign(new Ea.a,{extendedProperties:N}));A.Health.instance.recordKpiFailure("SafeLinksGetPolicy1","GetPolicyRequestError",!1,!0,x);const ea=new qd("false","","",0,!0,"");this.Toh(ea);this.pOa&&(e.ULS.sendTraceTag(26019603,378,50,"Error occurred during at-click GetPolicy call, NavigationState = {0}","disabled_GetPolicyFailure"),A.Health.instance.recordKpiFailure("SafeLinksNavigations","disabled_GetPolicyFailure",!1,!0,null),Lb.a.yPc(this.pOa),
this.pOa=null)}}catch(N){e.ULS.sendTraceTag(594830611,378,10,"HandleGetPolicyRequestError: Exception {0}",N.toString())}}wDh(f){const x=this.P2f(),N=this.Qmj(),ea={};ea.Url=f;ea.SafeLinksCookie=x;ea.CorrelationId=ha.a.create().toString();ea.WorkloadId=this.xFl;ea.UserAgentInfo=fa.a.Ly+"|"+this.appName;e.ULS.sendTraceTag(23900187,378,50,"Validating hyperlink with request correlation: {0}",ea.CorrelationId);Lb.a.Ygd(Lb.a.Raa(4),N,ea)}TRj(){const f=this.$a.Ha("IsSafeLinksEnabledForUser");return f?md.iIe(f):
!1}SRj(){const f=this.$a.RA("SafeLinksDisabledBrowsers");if(fa.a.uT){if(this.$a.aw("SafeLinksForTeamsIsEnabled")&&this.$a.ka("SafeLinksForTeamsIsEnabled"))return!0;if(Array.contains(f,"Electron"))return!1}else if(Array.contains(f,fa.a.Ly))return!1;return"officecomhwa"===(this.$a.Ha(J.AFrameworkApplication.YJ)||"").toLowerCase()?!1:!0}Lel(){return-1!==window.location.href.indexOf("&wd_slnh=1")||this.$a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksUseNavigationHelperForMobile",!1)&&
fa.a.aje?!0:fa.a.uT}xel(){let f;f=0;const x=this.Hvb(),N=x?x.IsSafeLinksEnabled:"";if(""!==N)return x.WasServiceDown?(e.ULS.sendTraceTag(51663971,378,50,"Failed to retrieve policy data"),{returnValue:!1,state:2}):"false"===N.toLowerCase()?(e.ULS.sendTraceTag(51664E3,378,50,"SafeLinks disabled for the user"),{returnValue:!1,state:1}):{returnValue:md.iIe(N),state:f};if(this.Yxc)return f=3,e.ULS.sendTraceTag(595079384,378,50,"Currently getting SafeLinks policy"),{returnValue:!1,state:f};if(this.M2a>=
this.$zc||this.N2a>=this.aAc)return f=2,e.ULS.sendTraceTag(51664001,378,50,"Exhausted all retries- Failure in GetPolicy for SafeLinks ({0}/{1} boot, {2}/{3} onClick)",this.M2a,this.$zc,this.N2a,this.aAc),{returnValue:!1,state:f};e.ULS.sendTraceTag(23900182,378,10,"Inconsistent SafeLinks state: SafeLinks cache data is null with no on boot request pending, and {0} retries left over. Perhaps LocalStorage is inaccessable.",this.$zc+this.aAc-(this.M2a+this.N2a));return{returnValue:!0,state:f}}P2f(){const f=
this.Hvb();return f?f.PolicyCookie:""}Qmj(){const f=this.Hvb();return f?f.WebAffinitizedUrl:""}B1i(){const f=this.Hvb();return f?f.AffinitizedUrl:""}e8i(){const f=new Date;try{const x=this.Hvb();f.setTime(x?x.PolicyCookieTTL:0)}catch(x){e.ULS.sendTraceTag(24462658,378,10,"Exception occured while fetching expiration time from cache: {0}",x)}return f}Eje(){const f=this.e8i();return!!f&&f.getTime()<Date.now()}Hvb(){if(!this.PCc){const f=wa.a.instance.getItem(this.userId);if(!f||""===f)return null;this.PCc=
JSON.parse(f)}return this.PCc}Toh(f){if(void 0===f||null===f)throw Error.argumentNull("safeLinksData");if(void 0===f.IsSafeLinksEnabled||null===f.IsSafeLinksEnabled||0>=f.IsSafeLinksEnabled.length)throw Error.argumentNull("safeLinksData.IsSafeLinksEnabled");this.PCc=f;f.WasServiceDown||this.EFl(f)}EFl(f){f=JSON.stringify(f);wa.a.instance.setItem(this.userId,f)}bWd(f){return void 0!==md.Xh&&null!==md.Xh?md.Xh.Ci("WebServiceCall",f):null}lqd(f){if(void 0!==f&&null!==f){const x=f.Rq;f.stop();return{returnValue:x,
Ay:null}}return{returnValue:null,Ay:f}}static iIe(f){return"false"!==f.toLowerCase()?!0:!1}}md.Xh=null;md.JId=null;Object(k.a)(md,"SafeLinksManager",null,[671]);const Kf=f=>{switch(f){case 3:return"Word";case 2:return"PowerPoint";case 1:return"Excel";default:return"Unknown"}},oe=f=>{switch(f){case 1:return"Edit";case 2:return"View";case 3:return"InstantView";default:return"Unknown"}};var Hf=d(209);class xb{constructor(){this.K=null}get name(){return"PowerPointSafeLinks"}$b(f){this.K=f}init(){J.AFrameworkApplication.fa.jf(Object(v.a)(this,
this.Om,"onFullAppSettingsReady"))}Om(){const f=this.K.resolve("PowerPointWebEditor.IApplicationSettings"),x=f?f.wg:!1;f.pptSafeLinksIsEnabled&&(this.K.register(md,"Common.App.SafeLinks.SafeLinksManager").as("Common.App.SafeLinks.ISafeLinksManager").ma().oa(()=>new md(J.AFrameworkApplication.fa,J.AFrameworkApplication.Je,String.format("{0}-{1}",Kf(J.AFrameworkApplication.Aa.hb.Vk),oe(J.AFrameworkApplication.Aa.hb.KIa)),x)).ma(),this.K.rb("Common.App.SafeLinks.ISafeLinksManager"))}dispose(){}static main(){Na.a.instance.Dc(Hf.a(new xb,
0))}}Object(k.a)(xb,"SafeLinksPackage",null,[2,3]);var hg=d(342),rf=d(285),nf=d(1191),kd=d(85),If=d(27),og=d(171),pf=d(91),ig=d(1025);class Oe{constructor(f,x,N,ea,ma,Ha){this.xG=f;this._id=x;this.Syd=ea;this.CPh=ma;this.DPh=Ha;this.Owc=this.Jtb;void 0!==N&&null!==N&&(this.Jtb=N)}get defaultValue(){return this.Owc}get lcid(){return this.xG}get id(){return this._id}get Jtb(){return(this.CPh||Oe.A9e)(this.Syd)}set Jtb(f){(this.DPh||Oe.B9e)(this.Syd,f)}get Wf(){return this.Syd}static mr(){Oe.A9e=()=>
null;Oe.B9e=()=>{}}}Oe.A9e=null;Oe.B9e=null;Object(k.a)(Oe,"GrammarSettingOption",null,[1197]);Oe.mr();class Ag{constructor(f,x,N){this.v2d=f;this.bSe=x;this.ejk=N}}Object(k.a)(Ag,"TwoLevelCacheKey",null,[]);var ce=d(32),me=d(214),Je=d(2);class ie extends lb.a{constructor(f,x,N,ea){super();this.bId=this.u7=this.laf=this.FQb=null;this.Jo=ea;this.$xd=f;this.ig=ie.id;this.AWh=()=>{this.FQb=N?ka.a.Qpc(N):{};this.laf=N?ka.a.Qpc(N):{};const ma=this.Fii(),Ha=ie.IBi(ma,ie.Rmd(Object(v.a)(this,this.HBi,"createCritiqueTypeSettingsTracker"))(ie.lvi(mb=>
this.FQb=mb)));Ha(N||{});var Ua=ie.Rmd(ie.HGi())(mb=>mb.cloneNode(!0));ie.JBi(ma,ie.gBi(ie.$Ei(x),ie.GBi(Ua))(N))(f.toString());this.bId=this.eki();Ua=mb=>{if("click"===mb.type||mb.keyCode===og.a.tq||mb.keyCode===og.a.QOb)this.FQb[f.toString()]={},ma.reset(),ie.uXk(Ha)};pf.a.addHandler(this.YZa,Sb.a.click,Ua);pf.a.addHandler(this.YZa,Sb.a.Zf,Ua)};this.qg=""}get YZa(){return this.bId}ZUj(){var f=ie.HOe(this.FQb),x=ie.HOe(this.laf);if(!f&&!x)return!1;let N;try{N=f?Object(C.a)(Object,f[this.$xd.toString()]):
{};var ea=x?Object(C.a)(Object,x[this.$xd.toString()]):{}}catch(Ua){return e.ULS.sendTraceTag(36489288,375,15,"Parse to dictionary failed"),!1}if(!N&&!ea)return!1;N=N?N:{};ea=ea?ea:{};f=String.format("language: {0}",this.$xd.toString());x=!1;for(let Ua in N){var ma=Ua,Ha=N[Ua];ma in ea&&ea[ma]===Ha||(x=!0,f=String.format("{0}, [{1}, {2}]",f,ma,Ha))}for(let Ua in ea)ea=Ua,ea in N||(x=!0,f=String.format("{0}, [{1}, default]",f,ea));x&&e.ULS.sendTraceTag(37319685,375,50,"User changed settings: {0}",
f);return x}$i(f,x,N){super.$i(f,x,N);this.gMk()}sN(f){return f.Cc.id===ie.ikh?!1:super.sN(f)}a2k(){this.Jo.yl().bcd();this.u7=this.Jo.yl().uj.$Z}gMk(){this.Jo.yl().scope.Ap(Lc.FocusManager.instance().Eqa);this.Jo.yl().scope.Ap(Lc.FocusManager.instance().Fqa);this.Jo.yl().scope.bindAction(Lc.FocusManager.instance().Eqa,ce.a.s6b);this.Jo.yl().scope.bindAction(Lc.FocusManager.instance().Fqa,ce.a.r6b);this.Jo.yl().scope.bindAction(Zb.KeyInputManager.Na(og.a.Naa,0),ce.a.mUc);this.Jo.yl().scope.bindAction(Zb.KeyInputManager.Na(og.a.zga,
0),ce.a.lUc);this.Jo.yl().scope.bindAction(Zb.KeyInputManager.Na(og.a.aZ,0),ce.a.mUc);this.Jo.yl().scope.bindAction(Zb.KeyInputManager.Na(og.a.x6,0),ce.a.lUc)}get settings(){return ie.HOe(this.FQb)}Rwa(){super.Rwa();this.AWh()}Fii(){const f=ie.$ii(),x=ie.bZb("WACDialogRow",f);this.MP.insertBefore(x,this.MP.firstChild);return f}HBi(f){const x=ig.a.merge(null,f);return N=>{N.Jtb===(f&&f[N.lcid]?f[N.lcid][N.id]:null)||N.Jtb!==N.defaultValue?ie.n2f(x,N.lcid)[N.id]=N.Jtb:delete ie.n2f(x,N.lcid)[N.id];
this.u7=this.N8i(N.Wf);return x}}N8i(f){return f?(f=f.getElementsByTagName(Sys.UI.DomElement.containsCssClass(f,ie.TWj)?"select":"input"))?f[0]:null:null}dispose(){this.YZa&&(pf.a.Dgh(this.YZa),this.bId=null);super.dispose()}eki(){const f=document.createElement("input");f.id=ie.ikh;f.type="reset";f.setAttribute("form",ie.JVf);f.className="WACButton WACDialogButtonNormal GrammarSettingsDialogResetButton";f.value=CommonUIStrings.l_ResetAll;const x=ie.bZb("GrammarSettingsDialogResetButtonContainer",
f),N=document.getElementById("WACDialogButtonPanel");N.parentNode.insertBefore(x,N);return f}static get V0b(){return"CritiqueType"}static lvi(f){return x=>N=>f(x(N))}static Rmd(f){return x=>N=>x(f(N))}static HOe(f){const x={};ka.a.forEach(f,(N,ea)=>{0<me.a(ea).length&&(x[N]=ea)},null);return x}static $ii(){const f=document.createElement("form");f.id=ie.JVf;Sys.UI.DomElement.addCssClass(f,"WACDialogList");Sys.UI.DomElement.addCssClass(f,ie.cHi);return f}static IBi(f,x){const N=ie.mLk(f,Sb.a.change);
return ea=>{const ma=x(ea);N(Ha=>{Ha=Ha.target.parentNode;Sys.UI.DomElement.containsCssClass(Ha,ie.V0b)&&ma(Ha[ie.ywf])})}}static mLk(f,x){let N=null;return ea=>{N&&pf.a.removeHandler(f,x,N);pf.a.addHandler(f,x,ea);N=ea}}static n2f(f,x){return f[x]=f[x]||{}}static uXk(f){e.ULS.sendTraceTag(36489289,375,50,"User click reset all button");f(null)}static $Ei(f){let x=null;return N=>{x=N;return f.request(Number.parseInvariant(N)).CWRCo(ea=>x===N?ea.result:null,ie.hYd)}}static JBi(f,x){const N=ie.r2i(ea=>
ie.vql(ea.children));return ea=>{const ma=N(ea,f);f.innerHTML="";(ma?Je.Task.Nt(ma):x(ea)).continueWith(Ha=>{Ha=Ha.result;for(let Ua=0;Ua<Ha.length;Ua++)f.appendChild(Ha[Ua])},ie.hYd)}}static gBi(f,x){return N=>ea=>f(ea).CWRCo(ma=>Wa.toArray(Wa.select(Wa.asEnumerable(ma.result),Ha=>x(N,Ha,ea))),ie.hYd)}static vql(f){const x=[];for(let N=0;N<f.length;N++)x.push(f[N]);return x}static r2i(f){const x={};let N=null;return(ea,ma)=>{N&&!x[N]&&(ma=f(ma))&&(x[N]=ma);N=ea;return x[ea]}}static HGi(){const f=
{};return x=>{f[x.v2d]=f[x.v2d]||{};const N=f[x.v2d];N[x.bSe]=N[x.bSe]||x.ejk();return N[x.bSe]}}static GBi(f){return(x,N,ea)=>{const ma=f(new Ag(ea,N.Id,()=>ie.Nii(N)));ma.setAttribute("role","group");const Ha=ie.JBf+N.Name;ma.setAttribute("aria-labelledby",Ha);for(const Ua of N.CritiqueTypeInfoList){const mb=ie.$_i(ea,Ua,x,f);ma.appendChild(mb);mb.setAttribute("aria-labelledby",Ha)}return ma}}static $_i(f,x,N,ea){ea=ea(new Ag(f,x.Id,()=>x.IsBinaryCritiqueType?ie.Lii(x):ie.Oji(x)));f=new Oe(f,x.Id,
N&&N[f]?N[f][x.Id]:null,ea,x.IsBinaryCritiqueType?ma=>ma.children[0].checked:ma=>ma.children[1].selectedIndex,x.IsBinaryCritiqueType?(ma,Ha)=>{ma.children[0].checked=Ha}:(ma,Ha)=>{ma.children[1].selectedIndex=Ha});ea[ie.ywf]=f;return ea}static Nii(f){f=ie.Oii(f.Name);f.className="WACWritingStylesDialogCategoryTitle";return ie.bZb("CritiqueCategory",f)}static Lii(f){const x=ie.Pii();x.id=f.Id;0<f.DefaultCritiqueValue&&x.setAttribute("checked","checked");f=ie.uyf(f.Name,f.Id);f.className="WACDialogLabel";
const N=ie.bZb(ie.V0b,x,f);N.appendChild(x);N.appendChild(f);return N}static Oji(f){f=ie.Bji(f.Id,f.Name,ie.Tji(f.CritiqueTypeValues,f.DefaultCritiqueValue),f.DefaultCritiqueValue);Sys.UI.DomElement.addCssClass(f,ie.V0b);return f}static Tji(f,x){return Wa.toArray(Wa.Si(Wa.asEnumerable(f||[]),(N,ea)=>{N=ie.Sji(N,ea.toString());ea===x&&N.setAttribute("selected","selected");return N}))}static Bji(f,x,N,ea){x=ie.uyf(x,f);const ma=document.createElement("select");ma.id=f;ma.className="WACDialogList";N=
N||[];for(f=0;f<N.length;f++)ma.appendChild(N[f]),ea===f&&(N[f].selected=!0);return ie.bZb("GrammarSettingsDialogLabeledInlineList",x,ma)}static Sji(f,x){const N=document.createElement("option");N.text=f;N.value=x;return N}static Pii(){const f=document.createElement("input");f.type="checkbox";f.className="WACDialogCheckBox";return f}static uyf(f,x){const N=document.createElement("label");N.innerText=f;N.setAttribute("for",x);return N}static Oii(f){const x=document.createElement("div");x.innerText=
f;x.id=ie.JBf+f;return x}static bZb(f=null,...x){const N=document.createElement("div");N.className=f;for(const ea of x)N.appendChild(ea);return N}}ie.id="GrammarSettingsDialog";ie.JVf="CritiqueTypeSettings";ie.cHi="CritiquesList";ie.TWj="GrammarSettingsDialogLabeledInlineList";ie.ikh="ResetButton";ie.JBf="WritingStylesCategory_";ie.hYd=11;ie.ywf="CritiqueType";Object(k.a)(ie,"GrammarSettingsDialog",lb.a,[]);var Tf=d(140),He=d(312),Sg=d(1112),jc=d(39),be=d(345),Md=d(58),de=d(153),Zc=d(47),Yf=d(884),
Vc=d(26),zc=d(28);class vf{constructor(){this.Color=null;this.Transparency=this.Scale=this.EffectDataPropType=this.Degree=0}}Object(k.a)(vf,"EffectDataInfo",null,[]);var Tg=d(847);class bb{constructor(){this.EffectType=this.EffectId=0;this.FRemoveExisting=!1;this.ShapeIds=null}}Object(k.a)(bb,"AddAnimationInfo",null,[]);class Vb{constructor(){this.TargetEffects=null}}Object(k.a)(Vb,"DeleteAnimationInfo",null,[]);class Ub{constructor(){this.EffectNodeId=0;this.ShapeId=null}}Object(k.a)(Ub,"TargetEffect",
null,[]);class Jc{constructor(){this.EffectType=this.EffectId=0;this.IsReplaceShapeAnimations=!1;this.TargetEffects=null}}Object(k.a)(Jc,"ReplaceAnimationInfo",null,[]);class Mc{constructor(){this.Duration=this.Direction=this.Delay=0;this.EffectData=null;this.ModifyAnimPropType=0;this.TargetEffects=null}}Object(k.a)(Mc,"ModifyAnimationInfo",null,[]);class ed{constructor(){this.StartType=0;this.TargetEffects=null}}Object(k.a)(ed,"ChangeAnimationRelationshipInfo",null,[]);var dd=d(347),je=d(147),Nd=
d(88);class Ld{constructor(){this.BuildType=0;this.TargetEffects=null}}Object(k.a)(Ld,"ChangeAnimationBuildTypeInfo",null,[]);class Xe{constructor(){this.IsLater=!1;this.TargetEffects=this.RefEffect=null}}Object(k.a)(Xe,"ReorderAnimationEffectsInfo",null,[]);var pe;(function(f){f[f.OnClick=0]="OnClick";f[f.WithPrevious=1]="WithPrevious";f[f.AfterPrevious=2]="AfterPrevious";f[f.Invalid=3]="Invalid"})(pe||(pe={}));Object(k.b)("AnimationStartType",pe);var fe;(function(f){f[f.Default=0]="Default";f[f.AsOneObject=
1]="AsOneObject";f[f.AllAtOnce=2]="AllAtOnce";f[f.ByParagraph=3]="ByParagraph";f[f.OnyByOne=4]="OnyByOne"})(fe||(fe={}));Object(k.b)("AnimationBuildType",fe);var wd;(function(f){f[f.AddAnimation=0]="AddAnimation";f[f.DeleteAnimation=1]="DeleteAnimation";f[f.ReplaceAnimation=2]="ReplaceAnimation";f[f.ModifyAnimation=3]="ModifyAnimation";f[f.ChangeAnimationRelationshipInfo=4]="ChangeAnimationRelationshipInfo";f[f.ChangeBuildType=5]="ChangeBuildType";f[f.ReorderAnimation=6]="ReorderAnimation"})(wd||
(wd={}));Object(k.b)("AnimationActionType",wd);var Ue;(function(f){f[f.Degree=0]="Degree";f[f.Color=1]="Color";f[f.Transparency=2]="Transparency";f[f.Scale=3]="Scale"})(Ue||(Ue={}));Object(k.b)("EffectDataPropType",Ue);var rd;(function(f){f[f.Delay=0]="Delay";f[f.Duration=1]="Duration";f[f.Direction=2]="Direction";f[f.EffectData=3]="EffectData"})(rd||(rd={}));Object(k.b)("ModifyAnimationPropertyType",rd);var Ud=d(34);class qe{constructor(f,x,N,ea,ma,Ha,Ua,mb,gb,Cb){this.a6="Existing";this.$Ka="ExistingInMenu";
this.RXe="AnimationExisting";this.SXe="AnimationExistingInMenu";this.tWa=!1;this.Xgb=(zb,Pb,oc,Ec,Xc)=>{zb=this.rx.ly;Pb=this.pa.sk();if(!Pb||!zb||!zb.length)return 8;if(1===oc)return 32;oc=this.Uja(zb,Pb);Xc.MenuItems=this.Hii(zb,Pb,oc);return 32};this.Cna=(zb,Pb,oc,Ec,Xc)=>{zb=Xc.queryResult;Xc=Xc.SourceControlId;Ec=Pb=-1;Xc!==this.a6&&({effectType:Ec,effectId:Pb}=this.Fk.vRc(Xc));var Ac=this.rx.ly;if(!this.pa.sk())return 8;if(1!==oc)return 32;oc=this.Fk.wRc(Xc);var zd=oc.label;if(Xc===this.a6||
Xc===this.$Ka)zd=ResourceStrings.L_ExistingButtonDescription;this.L8a(Xc,oc.image,oc.label,zb,zd);let ue=zd=!1;const bf=0==Ac.length?0:Ac[0].EffectId,Ce=0==Ac.length?0:Ac[0].EffectType,qg=!this.Fk.Cyb(Ac);Ac=this.Fk.Q8b(Ac);qg||Ac||(zd=Pb===bf&&Ec===Ce,ue=this.Fk.iYc(Ce,bf));Xc===this.a6?(ue=this.VGk(this.a6,zb,Ac,ue,qg,oc.image,Ce,bf),zb.UU(qg||Ac||ue)):Xc===this.$Ka?(ue=qe.TGk(zb,Ac,qg,ue),zb.UU(qg||Ac||ue)):zb.UU(zd);return 32};this.vz=(zb,Pb,oc,Ec,Xc)=>{Pb=this.rx.ly;var Ac=this.pa.sk();let zd=
!0;Ec=this.getSelectedShapes();if(!Ec||!Ec.length)if(zd=!1,Ec=this.Uja(Pb,Ac),!Ec||!Ec.length)return Vc.a.J(509677843,800,10,"AnimationActor::setAnimation: selected shapes info is null"),8;if(!qe.Pjg(Ac,Ec)||this.qua(Ec))return 8;if(1===oc)return Ac=0<Pb.length&&!this.Fk.Cyb(Pb),oc=qe.lSj(Ec),Ac&&oc?8:zb===zc.a.PKb||zb===zc.a.C_a?(Ec=0<Pb.length&&this.Fk.Q8b(Pb),oc=!1,Ac||Ec||(oc=this.Fk.iYc(0<Pb.length?Pb[0].EffectType:-1,0<Pb.length?Pb[0].EffectId:-1)),zb===zc.a.C_a&&(oc=Ac?!0:!1),Ac||Ec||oc?32:
16):zb===zc.a.OKb?qe.mSj(Ec)?32:16:32;zb=Xc.SourceControlId;if(!zb)return 8;if(zb===this.a6||zb===this.$Ka||zb===this.RXe||zb===this.SXe)return 32;zb=this.Fk.vRc(zb);(zb=qe.Y1i(Ec,zb.effectId,zb.effectType,zd,Pb))&&this.g_(Ac,zb);return 32};this.eZg=(zb,Pb,oc)=>{const Ec=this.rx.ly;Pb=this.pa.sk();if(!Pb||!Ec||!Ec.length)return 8;var Xc=this.Uja(Ec,Pb);if(!Xc||!Xc.length)return Vc.a.J(509670021,800,10,"AnimationActor::moveAnimationHandler: selected shapes info is null"),8;if(this.qua(Xc))return 8;
switch(zb){case zc.a.SCe:zb=!1;break;case zc.a.TCe:zb=!0;break;default:return 8}Xc=this.Fk.Ubj(Pb,Ec,zb);if(1===oc)return Xc.isEnabled?32:8;if(!Xc.zjd)return Vc.a.J(509670020,800,10,"AnimationActor::moveAnimationHandler: move animation info ref target is null"),8;oc=qe.A8(Ec);oc=qe.JIf(oc,Xc.zjd,zb);this.g_(Pb,oc);return 32};this.hya=(zb,Pb,oc,Ec,Xc)=>{Pb=this.rx.ly;zb=this.pa.sk();if(!zb||!Pb||!Pb.length)return 8;Ec=this.Uja(Pb,zb);if(!Ec||!Ec.length)return Vc.a.J(509677842,800,10,"AnimationActor::setAnimationColor: selected shapes info is null"),
8;if(this.qua(Ec))return 8;if(1===oc)return 32;oc=je.Box4ColorHelper.oV(Xc);if(!oc)return Vc.a.J(509677841,800,10,"AnimationActor::setAnimationColor:  solid is null"),8;oc=je.Box4ColorHelper.wib(oc,zb.Ne);if(!oc)return Vc.a.J(509677840,800,10,"AnimationActor::setAnimationColor:  color is null"),8;Xc=new Tg.a;Xc.AnimationAction=1;Ec=new Mc;Ec.TargetEffects=qe.A8(Pb);Ec.ModifyAnimPropType=3;Pb=new vf;Pb.Color=[oc.r,oc.g,oc.b];Pb.EffectDataPropType=1;Ec.EffectData=Pb;Xc.ModifyAnimationInfo=Ec;this.g_(zb,
Xc);return 32};this.BLe=()=>{const zb=this.rx.ly;var Pb=this.pa.sk();if(!Pb||!zb||!zb.length)return 8;Pb=this.Uja(zb,Pb);return Pb&&Pb.length?this.Fk.Oni(Pb,this.Ea,zb)?32:16:(Vc.a.J(509677839,800,10,"AnimationActor::queryEffectOptions: selected shapes info is null"),8)};this.A_a=(zb,Pb,oc,Ec,Xc)=>{zb=this.rx.ly;Pb=this.pa.sk();if(!Pb||!zb||!zb.length)return 8;Ec=this.Uja(zb,Pb);if(!Ec||!Ec.length)return Vc.a.J(509677838,800,10,"AnimationActor::setAnimationDirection: selected shapes info is null"),
8;if(this.qua(Ec))return 8;if(1===oc)return 32;oc=this.Fk.H4b(Xc.MenuItemId);Xc=new Tg.a;Xc.AnimationAction=1;Ec=new Mc;Ec.TargetEffects=qe.A8(zb);Ec.ModifyAnimPropType=2;Ec.Direction=oc;Xc.ModifyAnimationInfo=Ec;this.g_(Pb,Xc);return 32};this.pZa=(zb,Pb,oc,Ec,Xc)=>{zb=this.rx.ly;if(!this.pa.sk()||!zb||!zb.length)return 8;Pb=Xc.queryResult;Xc=this.Fk.H4b(Xc.MenuItemId);qe.oHj(zb)&&Pb.Qf(zb[0].Direction===Xc);return 32};this.vKa=(zb,Pb,oc,Ec,Xc)=>{zb=this.rx.ly;Pb=this.pa.sk();if(!Pb||!zb||!zb.length)return 8;
Ec=this.Uja(zb,Pb);if(!Ec||!Ec.length)return Vc.a.J(509677652,800,10,"AnimationActor::setAnimationSequence: selected shapes info is null"),8;if(this.qua(Ec))return 8;if(1===oc)return 32;oc=Xc.MenuItemId;Xc=new Tg.a;Xc.AnimationAction=5;Ec=new Ld;Ec.TargetEffects=qe.A8(zb);Ec.BuildType=qe.X2i(oc);Xc.ChangeAnimationBuildTypeInfo=Ec;this.g_(Pb,Xc);return 32};this.Dna=(zb,Pb,oc,Ec,Xc)=>{zb=this.rx.ly;if(!this.pa.sk()||!zb||!zb.length)return 8;Pb=Xc.queryResult;Xc=this.Fk.v8d(Xc.MenuItemId);qe.mHj(zb)&&
Pb.Qf(zb[0].BuildType===Xc);return 32};this.B_a=(zb,Pb,oc,Ec,Xc)=>{Pb=this.rx.ly;zb=this.pa.sk();if(!zb||!Pb||!Pb.length)return 8;Ec=this.Uja(Pb,zb);if(!Ec||!Ec.length)return Vc.a.J(509677837,800,10,"AnimationActor::setAnimationEffectData: selected shapes info is null"),8;if(this.qua(Ec))return 8;if(1===oc)return 32;Ec=Xc.MenuItemId;oc=new Tg.a;oc.AnimationAction=1;Xc=new Mc;Xc.TargetEffects=qe.A8(Pb);Xc.ModifyAnimPropType=3;Pb=this.x7i(Ec);if(!Pb)return Vc.a.J(509703439,800,15,"AnimationActor::setAnimationEffectData:  effect data info is null"),
16;Xc.EffectData=Pb;oc.ModifyAnimationInfo=Xc;this.g_(zb,oc);return 32};this.rZa=(zb,Pb,oc,Ec,Xc)=>{zb=this.rx.ly;if(!this.pa.sk()||!zb||!zb.length)return 8;Xc.queryResult.Qf(this.Fk.iFf(qe.y7i(zb[0].EffectData),Xc.MenuItemId));return 32};this.s4k=(zb,Pb,oc,Ec,Xc)=>{Pb=this.rx.ly;zb=this.pa.sk();if(!zb||!Pb||!Pb.length)return 8;Ec=this.Uja(Pb,zb);if(!Ec||!Ec.length)return Vc.a.J(509677836,800,10,"AnimationActor::setAnimationStartHandler: selected shape info is null"),8;if(this.qua(Ec))return 8;if(1===
oc)return 32;oc=Xc.CommandValueId;if(!oc||!oc.trim().length)return Vc.a.J(509703438,800,10,"AnimationActor::setAnimationStartHandler:  startoption value is null or empty"),16;oc=qe.bjj(oc);if(3==oc)return Vc.a.J(509703437,800,15,"AnimationActor::setAnimationStartHandler:  startoption value is invalid"),16;Xc=qe.A8(Pb);oc=qe.tHf(Xc,oc);this.g_(zb,oc);return 32};this.Zlc=(zb,Pb,oc,Ec,Xc)=>{zb=this.rx.ly;if(!this.pa.sk()||!zb||!zb.length)return this.$Se(Xc,""),32;Pb=zb[0].StartType;oc=!0;for(const Ac of zb)if(Pb!=
Ac.StartType){oc=!1;break}oc?this.$Se(Xc,pe[Pb].toString()):this.$Se(Xc,"");return 32};this.r4k=(zb,Pb,oc,Ec,Xc)=>{zb=this.pa.sk();Pb=this.rx.ly;if(!zb||!Pb||!Pb.length)return 8;Ec=this.Uja(Pb,zb);if(!Ec||!Ec.length)return Vc.a.J(509677835,800,10,"AnimationActor::setAnimationDurationHandler: selected shape info is null"),8;if(this.qua(Ec))return 8;const Ac=!this.Fk.Cyb(Pb);if(qe.Ojg(Ec)&&Ac)return 8;if(1===oc)return 32;(oc=Math.floor(1E3*Xc.Number))||(oc=10);Xc=qe.A8(Pb);oc=qe.KKc(Xc,1,oc);this.g_(zb,
oc);return 32};this.qZa=(zb,Pb,oc,Ec,Xc)=>{zb=this.rx.ly;if(!this.pa.sk()||!zb||!zb.length)return this.QKb(Xc,"0.00"),32;Pb=zb[0].Duration;oc=!0;for(const Ac of zb)if(Pb!=Ac.Duration){oc=!1;break}oc?this.QKb(Xc,Number(Pb/1E3).toFixed(2)):this.QKb(Xc,"0.01");return 32};this.Kuj=(zb,Pb,oc)=>1==oc?32:de.b("AnimationPaneActor::ShowHideAnimationPane PaneOpen:",this.tWa.toString(),zb,()=>{(this.tWa=!this.tWa)?this.nWe(!1):this.F$f();return 32});this.Ylc=(zb,Pb,oc,Ec,Xc)=>{Xc&&Xc.Qf(this.tWa);return 32};
this.nWe=zb=>{const Pb=this.jC();var oc=Object(v.a)(this,this.Ooj,"applyAnimationAction");Pb.ZHl=oc;oc=Object(v.a)(this,this.Qoj,"handleAnimationSelectionChangeFromPane");Pb.S$=oc;oc=this.getSelectedShapes();Pb.MHl=!oc||!oc.length;if(oc=this.pa.sk()){Pb.RHl=!oc.qEa;var Ec=oc.Pk();Pb.cW=oc.W3d(Ec);Pb.KIl=this.rx.ly.map(Ac=>Ac.EffectNodeId);var Xc={title:ResourceStrings.L_AnimationGalleryGroup,hideHeader:!1,width:Pb.Ewk,location:2,contentProps:Pb,onOpen:()=>{},onClose:()=>{this.tWa=!1},isModernPane:!0};
Tf.UISurfaces.xr().then(Ac=>{zb?this.tWa&&Ac.updateTaskPane(Zc.a.wPa,Xc):Ac.showTaskPane(Zc.a.wPa,Xc);return null}).catch(Ac=>{Vc.a.J(512500804,800,10,"AnimationActor::showAnimationPane exception: {0}",Ac.toString())})}else Vc.a.J(509642376,800,10,"AnimationActor::showAnimationPane: selected slide is null")};this.Osk=()=>{this.tWa&&this.nWe(!0)};this.Ooj=zb=>{switch(zb.actionType){case 0:this.Coj();break;case 2:this.auj(zb);break;case 1:this.dqj(zb);break;case 3:this.Trj(zb);break;case 4:this.zpj(zb);
break;case 5:break;case 6:this.$tj(zb);break;default:Vc.a.J(509642375,800,10,"AnimationActor::applyAnimationActionFromPane: invalid animation action type")}};this.Qoj=zb=>{const Pb=this.pa.sk();Pb&&zb&&zb.length?this.rx.srf(zb,Pb):Vc.a.J(509620888,800,10,"AnimationActor::handleAnimationSelectionChangeFromPane: slide or animation ids info is null")};this.Coj=()=>{var zb=this.getSelectedShapes();const Pb=this.pa.sk();Pb&&zb&&zb.length?(zb=qe.bXf(zb,10,0,!1))&&this.g_(Pb,zb):Vc.a.J(509642374,800,10,
"AnimationActor::applyAddAnimationFromPane: slide or shapes info is null")};this.auj=zb=>{if(zb&&zb.bjh){var Pb=zb.bjh.effectId,oc=zb.bjh.effectType,Ec=this.rx.ly;(zb=this.pa.sk())&&Ec&&Ec.length?(Pb=qe.v3f(Ec,Pb,oc))&&this.g_(zb,Pb):Vc.a.J(509642372,800,10,"AnimationActor::applyReplaceAnimation: slide or animation info is null")}else Vc.a.J(509642373,800,10,"AnimationActor::applyReplaceAnimation: replace animation info is null")};this.dqj=zb=>{if(zb&&zb.vJi){var Pb=this.pa.sk();zb=zb.vJi.TGl;Pb&&
zb&&zb.length?(zb=qe.skj(zb),zb=qe.EHf(zb),this.g_(Pb,zb)):Vc.a.J(509616839,800,10,"AnimationActor::handleDeleteAnimation: slide or deleteAnimationIds is null/empty")}else Vc.a.J(509616840,800,10,"AnimationActor::handleDeleteAnimation: delete animation info is null")};this.jC=()=>({type:"AnimationPaneProps",Ewk:Yf.a,PHl:!0});this.nti=()=>{this.F$f();return 32};this.exl=()=>{this.nWe(!0);return 32};this.F$f=()=>{Tf.UISurfaces.xr().then(zb=>{zb.hideTaskPane(Zc.a.wPa,2);return null}).catch(zb=>{Vc.a.J(512500803,
833,10,"AnimationActor::hideAnimationPane exception: {0}",zb.toString())})};this.q4k=(zb,Pb,oc,Ec,Xc)=>{Pb=this.rx.ly;zb=this.pa.sk();if(!zb||!Pb||!Pb.length)return 8;Ec=this.Uja(Pb,zb);if(!Ec||!Ec.length)return Vc.a.J(509677834,800,10,"AnimationActor::setAnimationDelayHandler: selected shapes info is null"),8;if(this.qua(Ec))return 8;const Ac=!this.Fk.Cyb(Pb);if(qe.Ojg(Ec)&&Ac)return 8;if(1===oc)return 32;oc=Math.floor(1E3*Xc.Number);Xc=qe.A8(Pb);oc=qe.KKc(Xc,0,oc);this.g_(zb,oc);return 32};this.oZa=
(zb,Pb,oc,Ec,Xc)=>{zb=this.rx.ly;if(!this.pa.sk()||!zb||!zb.length)return this.QKb(Xc,"0.00"),32;Pb=zb[0].Delay;oc=!0;for(const Ac of zb)if(Pb!=Ac.Delay){oc=!1;break}oc?this.QKb(Xc,Number(Pb/1E3).toFixed(2)):this.QKb(Xc,"0.00");return 32};this.Hii=(zb,Pb,oc)=>{var Ec;const Xc=new He.a;Xc.Id="AnimationMenuEffectOptions";Xc.UpdateDynamically=!0;Xc.Title=ResourceStrings.L_EffectOptions;Xc.MenuSectionList=[];if(!this.Fk.Q8b(zb)){const Ac=zb[0];Xc.MenuSectionList.push(this.Fk.XSc(Ac.EffectId,Ac.EffectType,
"Direction","2289594085","3782857737"));if(this.Fk.dle(Ac))if(Xc.MenuSectionList.push(be.f(Pb.Ne,"Theme Colors","Color.Menu.Controls","themeColor","AnimationEffectOptionsThemeColorPicker","679168237",2)),Xc.MenuSectionList.push(be.d("Standard Colors","Color.Menu.Controls","standardColor","AnimationEffectOptionsStandardColorPicker","679168237",!1)),this.nHj(zb)){const zd=null===(Ec=Ac.EffectData)||void 0===Ec?void 0:Ec.Color;Ec=new Nd.a(Nd.a.clh(zd));be.h(Xc,Ec,Pb.Ne)}else be.h(Xc,null,Pb.Ne);Xc.MenuSectionList.push(this.Fk.XSc(Ac.EffectId,
Ac.EffectType,"EffectData","2949363495","4132852551"))}Xc.MenuSectionList.push(this.Fk.hfj(oc,this.Ea,zb));return Xc};this.x7i=zb=>{let Pb=new vf;const oc=this.Fk.m5d(zb);return zb.toLowerCase().startsWith("spin")?(Pb.Degree=parseFloat(oc),Pb.EffectDataPropType=0,Pb):zb.toLowerCase().startsWith("transparency")?(Pb.Transparency=parseFloat(oc),Pb.EffectDataPropType=2,Pb):zb.toLowerCase().startsWith("growshrink")?(Pb.Scale=parseFloat(oc),Pb.EffectDataPropType=3,Pb):null};this.VGk=(zb,Pb,oc,Ec,Xc,Ac,
zd,ue)=>{if(Xc)return!1;if(oc)return this.L8a(zb,Ac,ResourceStrings.L_AnimationMultiple,Pb,ResourceStrings.L_AnimationMultiple),Ec;Ec&&(Ac=this.Fk.vTc(zd,ue),{image:Ac,label:oc}=this.Fk.wRc(Ac),this.L8a(zb,Ac,oc,Pb,oc));return Ec};this.L8a=(zb,Pb,oc,Ec,Xc)=>{let Ac;Ac=zb===this.a6?"298832323":zb===this.$Ka?"1264919631":"2676673376";Pb=Pb.substring((Md.a.Lkc+"_").length,Pb.length-6);const zd=new Sg.a;zd.Id=zb;zd.ExternalId="Animation"+zb;zd.Icon=Pb;zd.Command=Ac;zd.QueryCommand="1852964326";zd.LabelText=
oc;zd.FullIconStyle={root:{width:"32px",height:"32px"}};zd.PreviewIconStyle={root:{width:"24px",height:"24px"}};zd.Alt=Xc;Ec.l3=zd};this.getSelectedShapes=()=>{let zb=[];const Pb=this.pa.Xd();if(!Pb)return zb;for(const oc of Pb)oc.get_smartArtModelId()?zb.push(this.Ea.vr(oc)):oc.Kg?zb.push(this.Ea.rs(oc)):zb.push(oc);return zb};this.Uja=(zb,Pb)=>{const oc=[];if(!zb||!zb.length||!Pb)return oc;const Ec=Pb.Pk();if(!Ec||!Ec.length)return oc;Pb=new Map;for(const Xc of Ec)Pb.set(Xc.id.toString(),Xc);for(const Xc of zb){zb=
dd.a.Hf(Xc.ShapeId);zb=Pb.get(zb.toString());if(!zb)return[];oc.push(zb)}return oc};this.g_=(zb,Pb)=>{const oc=this.Jb.zd(15,void 0,()=>{this.pa.ij();this.Fa.Ed()});try{oc.nc(zb),zb.mra=Pb}finally{oc&&oc.dispose()}};this.qua=zb=>{if(!zb||0==zb.length)return!1;for(const Pb of zb)if(this.fc.$c(Pb))return!0;return!1};this.$Se=(zb,Pb)=>{zb.WZ=Pb;zb.dpc()};this.QKb=(zb,Pb)=>{zb.queryResult.uaa=Pb};if(!f)throw Error.argumentNull("actionManager");if(!x)throw Error.argumentNull("selectionManager");if(!N)throw Error.argumentNull("focusManager");
if(!ea)throw Error.argumentNull("transactionFactory");if(!ma)throw Error.argumentNull("animationHelper");if(!Ha)throw Error.argumentNull("graphActionBlockingManager");if(!Ua)throw Error.argumentNull("shapeReader");if(!mb)throw Error.argumentNull("pathManager");if(!gb)throw Error.argumentNull("effectSelectionManager");this.ia=f;this.pa=x;this.Fa=N;this.Jb=ea;this.wfc=mb.pk(Md.a.sgd);this.Fk=ma;this.fc=Ha;this.Ea=Ua;this.rx=gb;this.la=Cb}vb(){this.ia.ra(zc.a.ePd,jc.a.application,this.s4k,4);this.ia.ra(zc.a.Zlc,
jc.a.application,this.Zlc,97);this.ia.ra(zc.a.ZSe,jc.a.application,this.r4k,4);this.ia.ra(zc.a.qZa,jc.a.application,this.qZa,97);this.ia.ra(zc.a.Uuh,jc.a.application,this.Kuj,4);this.ia.ra(zc.a.Ylc,jc.a.application,this.Ylc,96);this.ia.ra(zc.a.YSe,jc.a.application,this.q4k,4);this.ia.ra(zc.a.oZa,jc.a.application,this.oZa,97);this.ia.ra(zc.a.Cna,jc.a.application,this.Cna,97);this.ia.ra(zc.a.vz,jc.a.application,this.vz,5);this.ia.ra(zc.a.OKb,jc.a.application,this.vz,5);this.ia.ra(zc.a.PKb,jc.a.application,
this.vz,5);this.ia.ra(zc.a.C_a,jc.a.application,this.vz,5);this.ia.ra(zc.a.CLe,jc.a.application,this.BLe,100);this.ia.ra(zc.a.A_a,jc.a.application,this.A_a,5);this.ia.ra(zc.a.pZa,jc.a.application,this.pZa,97);this.ia.ra(zc.a.B_a,jc.a.application,this.B_a,4);this.ia.ra(zc.a.rZa,jc.a.application,this.rZa,96);this.ia.ra(zc.a.bnd,jc.a.application,this.vKa,5);this.ia.ra(zc.a.cnd,jc.a.application,this.vKa,5);this.ia.ra(zc.a.dnd,jc.a.application,this.vKa,5);this.ia.ra(zc.a.fnd,jc.a.application,this.vKa,
5);this.ia.ra(zc.a.Dna,jc.a.application,this.Dna,97);this.ia.ra(zc.a.Xgb,jc.a.application,this.Xgb,96);this.ia.ra(zc.a.hya,jc.a.application,this.hya,4);this.ia.ra(zc.a.SCe,jc.a.application,this.eZg,4);this.ia.ra(zc.a.TCe,jc.a.application,this.eZg,4);this.ia.ra(zc.a.qlb,jc.a.application,this.exl,4);this.ia.ra(zc.a.XDf,jc.a.application,this.nti,4);this.la.qT&&Ud.a("AnimationGalleryActionAIEnabled")&&this.ia.ra(zc.a.cPd,jc.a.application,Object(v.a)(this,this.B$d,"handleAnimationGalleryActionAI"),4);
this.pa.GG(this.Osk)}De(){}B$d(f,x){if(x.contextId!==jc.a.application)return 2;f=this.getSelectedShapes();return!qe.Pjg(this.pa.sk(),f)||this.qua(f)?8:32}zpj(f){if(f&&f.ipi){var x=this.rx.ly,N=this.pa.sk();N&&x&&x.length?(f=f.ipi,x=qe.A8(x),x=qe.tHf(x,f.cJl),this.g_(N,x)):Vc.a.J(509444173,800,10,"AnimationActor::handleChangeAnimationRelationshipInfo: slide or selected animation info is null")}else Vc.a.J(509444174,800,10,"AnimationActor::handleChangeAnimationRelationshipInfo: change relationship info is null")}Trj(f){if(f&&
f.Rhk){var x=this.rx.ly,N=this.pa.sk();N&&x&&x.length?(x=qe.A8(x),(f=qe.v4i(f.Rhk,x))?this.g_(N,f):Vc.a.J(509444170,800,10,"AnimationActor::handleModifyAnimation: command info is null, invalid modify prop type might be passed")):Vc.a.J(509444171,800,10,"AnimationActor::handleModifyAnimation: slide or selected animation info is null")}else Vc.a.J(509444172,800,10,"AnimationActor::handleModifyAnimation: modify info is null")}$tj(f){var x=f.Xna;if(f&&x){var N=this.rx.ly,ea=f.Xna.pIl;if((f=this.pa.sk())&&
N&&N.length&&ea){var ma=new Ub;ma.EffectNodeId=ea.aPi;ma.ShapeId=ea.shapeId;N=qe.A8(N);x=qe.JIf(N,ma,x.OHl);this.g_(f,x)}else Vc.a.J(509444168,800,10,"AnimationActor::handleReorderAnimation: slide, selected or ref animation info is null")}else Vc.a.J(509444169,800,10,"AnimationActor::handleReorderAnimation: reorder animation info is null")}static v4i(f,x){switch(f.WHl){case 0:return qe.KKc(x,0,f.delay);case 1:return qe.KKc(x,1,f.duration);default:return null}}nHj(f){var x;if(!(f&&f.length&&!this.Fk.Q8b(f)&&
this.Fk.dle(f[0])&&f[0].EffectData&&f[0].EffectData.Color))return!1;const N=null===(x=f[0].EffectData)||void 0===x?void 0:x.Color;for(const ea of f){if(!ea.EffectData||!ea.EffectData.Color)return!1;f=ea.EffectData.Color;if(f[0]!=N[0]||f[1]!=N[1]||f[2]!=N[2])return!1}return!0}static tHf(f,x){const N=new Tg.a;N.AnimationAction=4;const ea=new ed;ea.TargetEffects=f;ea.StartType=x;N.ChangeAnimationRelationshipInfo=ea;return N}static KKc(f,x,N){const ea=new Tg.a;ea.AnimationAction=1;const ma=new Mc;ma.TargetEffects=
f;ma.ModifyAnimPropType=x;1===x?ma.Duration=N:ma.Delay=N;ea.ModifyAnimationInfo=ma;return ea}static JIf(f,x,N){const ea=new Tg.a;ea.AnimationAction=6;const ma=new Xe;ma.TargetEffects=f;ma.IsLater=N;ma.RefEffect=x;ea.ReorderAnimationEffectsInfo=ma;return ea}}qe.skj=f=>{const x=[];if(!f||!f.length)return x;for(const N of f)f=new Ub,f.EffectNodeId=N.aPi,f.ShapeId=N.shapeId,x.push(f);return x};qe.X2i=f=>{switch(f){case "AsOneObject":return 1;case "AllAtOnce":return 2;case "ByParagraph":return 3;case "OneByOne":return 4;
default:return 0}};qe.Y1i=(f,x,N,ea,ma)=>0==x&&0==N?qe.F6i(ma):ea?qe.bXf(f,x,N,!0):qe.v3f(ma,x,N);qe.v3f=(f,x,N)=>{let ea=new Tg.a;ea.AnimationAction=2;let ma=new Jc;if(!f||!f.length)return Vc.a.J(509703434,800,15,"AnimationActor::getReplaceAnimationCommandInfo:  animation info is null or empty"),null;ma.TargetEffects=qe.A8(f);ma.EffectId=x;ma.EffectType=N;ea.ReplaceAnimationInfo=ma;return ea};qe.F6i=f=>f&&f.length?qe.EHf(qe.A8(f)):(Vc.a.J(509703433,800,15,"AnimationActor::getDeleteAnimationCommandInfo:  animation info is null or empty"),
null);qe.bXf=(f,x,N,ea)=>{let ma=new Tg.a;ma.AnimationAction=0;let Ha=new bb;Ha.EffectId=x;Ha.EffectType=N;Ha.ShapeIds=[];Ha.FRemoveExisting=ea;for(const Ua of f)Ha.ShapeIds.push(Ua.id.toString());ma.AddAnimationInfo=Ha;return ma};qe.EHf=f=>{const x=new Tg.a;x.AnimationAction=3;const N=new Vb;N.TargetEffects=f;x.DeleteAnimationInfo=N;return x};qe.bjj=f=>{switch(f.toLocaleLowerCase()){case "on click":return 0;case "with previous":return 1;case "after previous":return 2}return 3};qe.A8=f=>{if(!f||!f.length)return null;
const x=[];for(const N of f)f=new Ub,f.EffectNodeId=N.EffectNodeId,f.ShapeId=N.ShapeId,x.push(f);return x};qe.lSj=f=>{if(!f||0==f.length)return!1;for(const x of f)if(x.I3)return!0;return!1};qe.Ojg=f=>{if(!f||0==f.length)return!1;for(const x of f)if(1===x.mediaType||2===x.mediaType)return!0;return!1};qe.Pjg=(f,x)=>{if(!f||!x||!x.length)return!1;for(const N of x)if(N.pT||N.Cq||N.Mp)return!1;return!0};qe.mSj=f=>{if(!f||!f.length)return!1;for(const x of f)if(x.ud||x.ar||x.Mp)return!1;return!0};qe.oHj=
f=>{if(!f||!f.length)return!1;const x=f[0].Direction;for(let N=1;N<f.length;N++)if(f[N].Direction!=x)return!1;return!0};qe.mHj=f=>{if(!f||!f.length)return!1;const x=f[0].BuildType;for(let N=1;N<f.length;N++)if(f[N].BuildType!=x)return!1;return!0};qe.y7i=f=>{if(!f)return"";switch(f.EffectDataPropType){case 0:return f.Degree.toString();case 3:return f.Scale.toString();case 2:return f.Transparency.toString()}return""};qe.TGk=(f,x,N,ea)=>{N?(f.J8a=ResourceStrings.L_AnimationExisting,ea&&(ea=!1)):x&&(f.J8a=
ResourceStrings.L_AnimationMultiple);return ea};Object(k.a)(qe,"AnimationActor",null,[227]);class Nf{constructor(){this.BuildId=0;this.BuildIds=null;this.Duration=this.Direction=this.Delay=0;this.EffectData=null;this.EffectType=this.EffectId=0;this.HasTrigger=this.HasMultiple=this.HasExisting=!1;this.Id=null;this.IsTrigger=this.IsTextRangeType=!1;this.ParaRangeStart=this.ParaRangeEnd=0;this.RenderAnimationImage=!1;this.StartType=this.SequenceIndex=this.SequenceId=0}}Object(k.a)(Nf,"EditAnimationInfo",
null,[]);var sf;(function(f){f[f.invalid=0]="invalid";f[f.basicBlockList=1]="basicBlockList";f[f.alternatingHexagons=2]="alternatingHexagons";f[f.pictureCaptionList=3]="pictureCaptionList";f[f.linedList=4]="linedList";f[f.verticalBulletList=5]="verticalBulletList";f[f.verticalBoxList=6]="verticalBoxList";f[f.verticalBracketList=7]="verticalBracketList";f[f.varyingWidthList=8]="varyingWidthList";f[f.tabList=9]="tabList";f[f.horizontalBulletList=10]="horizontalBulletList";f[f.squareAccentList=11]="squareAccentList";
f[f.pictureAccentList=12]="pictureAccentList";f[f.bendingPictureAccentList=13]="bendingPictureAccentList";f[f.stackedList=14]="stackedList";f[f.increasingCircleProcess=15]="increasingCircleProcess";f[f.pieProcess=16]="pieProcess";f[f.detailedProcess=17]="detailedProcess";f[f.groupedList=18]="groupedList";f[f.horizontalPictureList=19]="horizontalPictureList";f[f.continuousPictureList=20]="continuousPictureList";f[f.pictureStrips=21]="pictureStrips";f[f.verticalPictureList=22]="verticalPictureList";
f[f.alternatingPictureBlocks=23]="alternatingPictureBlocks";f[f.verticalPictureAccentList=24]="verticalPictureAccentList";f[f.titledPictureAccentList=25]="titledPictureAccentList";f[f.verticalBlockList=26]="verticalBlockList";f[f.verticalChevronList=27]="verticalChevronList";f[f.verticalAccentList=28]="verticalAccentList";f[f.verticalArrowList=29]="verticalArrowList";f[f.trapezoidList=30]="trapezoidList";f[f.descendingBlockList=31]="descendingBlockList";f[f.tableList=32]="tableList";f[f.segmentedProcess=
33]="segmentedProcess";f[f.verticalCurvedList=34]="verticalCurvedList";f[f.pyramidList=35]="pyramidList";f[f.targetList=36]="targetList";f[f.hierarchyList=37]="hierarchyList";f[f.verticalCircleList=38]="verticalCircleList";f[f.tableHierarchy=39]="tableHierarchy";f[f.architectureLayout=40]="architectureLayout";f[f.basicProcess=41]="basicProcess";f[f.stepUpProcess=42]="stepUpProcess";f[f.stepDownProcess=43]="stepDownProcess";f[f.accentProcess=44]="accentProcess";f[f.pictureAccentProcess=45]="pictureAccentProcess";
f[f.alternatingFlow=46]="alternatingFlow";f[f.continuousBlockProcess=47]="continuousBlockProcess";f[f.increasingArrowsProcess=48]="increasingArrowsProcess";f[f.interconnectedBlockProcess=49]="interconnectedBlockProcess";f[f.continuousArrowProcess=50]="continuousArrowProcess";f[f.convergingText=51]="convergingText";f[f.processArrows=52]="processArrows";f[f.circleAccentTimeline=53]="circleAccentTimeline";f[f.basicTimeline=54]="basicTimeline";f[f.circleProcess=55]="circleProcess";f[f.basicChevronProcess=
56]="basicChevronProcess";f[f.chevronAccentProcess=57]="chevronAccentProcess";f[f.closedChevronProcess=58]="closedChevronProcess";f[f.chevronList=59]="chevronList";f[f.subStepProcess=60]="subStepProcess";f[f.phasedProcess=61]="phasedProcess";f[f.randomtoResultProcess=62]="randomtoResultProcess";f[f.verticalProcess=63]="verticalProcess";f[f.staggeredProcess=64]="staggeredProcess";f[f.processList=65]="processList";f[f.circleArrowProcess=66]="circleArrowProcess";f[f.basicBendingProcess=67]="basicBendingProcess";
f[f.repeatingBendingProcess=68]="repeatingBendingProcess";f[f.verticalBendingProcess=69]="verticalBendingProcess";f[f.ascendingPictureAccentProcess=70]="ascendingPictureAccentProcess";f[f.upwardArrow=71]="upwardArrow";f[f.descendingProcess=72]="descendingProcess";f[f.circularBendingProcess=73]="circularBendingProcess";f[f.equation=74]="equation";f[f.verticalEquation=75]="verticalEquation";f[f.funnel=76]="funnel";f[f.gear=77]="gear";f[f.arrowRibbon=78]="arrowRibbon";f[f.opposingArrows=79]="opposingArrows";
f[f.convergingArrows=80]="convergingArrows";f[f.divergingArrows=81]="divergingArrows";f[f.basicCycle=82]="basicCycle";f[f.textCycle=83]="textCycle";f[f.blockCycle=84]="blockCycle";f[f.nondirectionalCycle=85]="nondirectionalCycle";f[f.continuousCycle=86]="continuousCycle";f[f.multidirectionalCycle=87]="multidirectionalCycle";f[f.segmentedCycle=88]="segmentedCycle";f[f.basicPie=89]="basicPie";f[f.hexagonRadial=90]="hexagonRadial";f[f.radialCycle=91]="radialCycle";f[f.basicRadial=92]="basicRadial";f[f.divergingRadial=
93]="divergingRadial";f[f.radialVenn=94]="radialVenn";f[f.cycleMatrix=95]="cycleMatrix";f[f.radialCluster=96]="radialCluster";f[f.organizationChart=97]="organizationChart";f[f.pictureOrganizationChart=98]="pictureOrganizationChart";f[f.nameandTitleOrganizationChart=99]="nameandTitleOrganizationChart";f[f.halfCircleOrganizationChart=100]="halfCircleOrganizationChart";f[f.circlePictureHierarchy=101]="circlePictureHierarchy";f[f.hierarchy=102]="hierarchy";f[f.labeledHierarchy=103]="labeledHierarchy";
f[f.horizontalOrganizationChart=104]="horizontalOrganizationChart";f[f.horizontalMultiLevelHierarchy=105]="horizontalMultiLevelHierarchy";f[f.horizontalHierarchy=106]="horizontalHierarchy";f[f.horizontalLabeledHierarchy=107]="horizontalLabeledHierarchy";f[f.balance=108]="balance";f[f.circleRelationship=109]="circleRelationship";f[f.hexagonCluster=110]="hexagonCluster";f[f.opposingIdeas=111]="opposingIdeas";f[f.plusandMinus=112]="plusandMinus";f[f.reverseList=113]="reverseList";f[f.counterbalanceArrows=
114]="counterbalanceArrows";f[f.segmentedPyramid=115]="segmentedPyramid";f[f.nestedTarget=116]="nestedTarget";f[f.convergingRadial=117]="convergingRadial";f[f.radialList=118]="radialList";f[f.tabbedArc=119]="tabbedArc";f[f.basicTarget=120]="basicTarget";f[f.basicVenn=121]="basicVenn";f[f.linearVenn=122]="linearVenn";f[f.stackedVenn=123]="stackedVenn";f[f.interconnectedRings=124]="interconnectedRings";f[f.basicMatrix=125]="basicMatrix";f[f.titledMatrix=126]="titledMatrix";f[f.gridMatrix=127]="gridMatrix";
f[f.basicPyramid=128]="basicPyramid";f[f.invertedPyramid=129]="invertedPyramid";f[f.accentedPicture=130]="accentedPicture";f[f.circularPictureCallout=131]="circularPictureCallout";f[f.radialPictureList=132]="radialPictureList";f[f.snapshotPictureList=133]="snapshotPictureList";f[f.spiralPicture=134]="spiralPicture";f[f.captionedPictures=135]="captionedPictures";f[f.bendingPictureCaption=136]="bendingPictureCaption";f[f.pictureFrame=137]="pictureFrame";f[f.bendingPictureSemiTransparentText=138]="bendingPictureSemiTransparentText";
f[f.bendingPictureBlocks=139]="bendingPictureBlocks";f[f.bendingPictureCaptionList=140]="bendingPictureCaptionList";f[f.titledPictureBlocks=141]="titledPictureBlocks";f[f.pictureGrid=142]="pictureGrid";f[f.pictureAccentBlocks=143]="pictureAccentBlocks";f[f.themePictureAccent=144]="themePictureAccent";f[f.themePictureGrid=145]="themePictureGrid";f[f.themePictureAlternatingAccent=146]="themePictureAlternatingAccent";f[f.alternatingPictureCircles=147]="alternatingPictureCircles";f[f.titlePictureLineup=
148]="titlePictureLineup";f[f.pictureLineup=149]="pictureLineup";f[f.framedTextPicture=150]="framedTextPicture";f[f.bubblePictureList=151]="bubblePictureList";f[f.linearArrowProcessNumbered=152]="linearArrowProcessNumbered";f[f.linearBlockProcessNumbered=153]="linearBlockProcessNumbered";f[f.basicLinearProcessNumbered=154]="basicLinearProcessNumbered";f[f.accentHomeChevronProcess=155]="accentHomeChevronProcess";f[f.basicProcessNew=156]="basicProcessNew";f[f.basicTimelineNew=157]="basicTimelineNew";
f[f.chevronBlockProcess=158]="chevronBlockProcess";f[f.hexagonTimeline=159]="hexagonTimeline";f[f.horizontalActionList=160]="horizontalActionList";f[f.repeatingBendingProcessNew=161]="repeatingBendingProcessNew";f[f.roundedRectangleTimeline=162]="roundedRectangleTimeline";f[f.verticalDownArrowProcess=163]="verticalDownArrowProcess";f[f.verticalHollowActionList=164]="verticalHollowActionList";f[f.verticalSolidActionList=165]="verticalSolidActionList";f[f.dropPinTimeline=166]="dropPinTimeline";f[f.horizontalLabelsTimeline=
167]="horizontalLabelsTimeline";f[f.horizontalPathTimeline=168]="horizontalPathTimeline";f[f.iconLabelList=169]="iconLabelList";f[f.iconCircleList=170]="iconCircleList";f[f.iconLabelDescriptionList=171]="iconLabelDescriptionList";f[f.iconVerticalSolidList=172]="iconVerticalSolidList";f[f.iconCircleLabelList=173]="iconCircleLabelList";f[f.iconCircleOutlineLabelList=174]="iconCircleOutlineLabelList";f[f.iconLeafLabelList=175]="iconLeafLabelList";f[f.iconLeafOutlineLabelList=176]="iconLeafOutlineLabelList";
f[f.centeredIconLabelDescriptionList=177]="centeredIconLabelDescriptionList"})(sf||(sf={}));Object(k.b)("SmartArtLayout",sf);var tf;(function(f){f[f.title=0]="title";f[f.body=1]="body";f[f.centerTitle=2]="centerTitle";f[f.subTitle=3]="subTitle";f[f.slideNum=5]="slideNum";f[f.footer=6]="footer";f[f.object=8]="object";f[f.graph=9]="graph";f[f.table=10]="table";f[f.clipArt=11]="clipArt";f[f.orgChart=12]="orgChart";f[f.media=13]="media";f[f.picture=15]="picture"})(tf||(tf={}));Object(k.b)("PlaceholderType",
tf);class Lf{constructor(f,x,N,ea,ma,Ha,Ua,mb,gb,Cb){this.a6="Existing";this.$Ka="ExistingInMenu";this.RXe="AnimationExisting";this.SXe="AnimationExistingInMenu";this.ia=f;this.jq=x;this.pa=N;this.wfc=Cb.pk(Md.a.sgd);this.Jb=ma;this.Fa=ea;this.Fk=Ha;this.fc=Ua;this.P7j=mb.pptAnimationMarkersEnabled;this.Ea=gb;this.la=mb}vb(){this.ia.ra(zc.a.Cna,jc.a.application,Object(v.a)(this,this.Cna,"queryAnimationGallery"),97);this.ia.ra(zc.a.aMe,jc.a.application,Object(v.a)(this,this.aMe,"queryMoreAnimationGallery"),
96);this.ia.ra(zc.a.vz,jc.a.application,Object(v.a)(this,this.vz,"setAnimation"),5);this.ia.ra(zc.a.OKb,jc.a.application,Object(v.a)(this,this.vz,"setAnimation"),5);this.ia.ra(zc.a.PKb,jc.a.application,Object(v.a)(this,this.vz,"setAnimation"),5);this.ia.ra(zc.a.C_a,jc.a.application,Object(v.a)(this,this.vz,"setAnimation"),5);this.ia.ra(zc.a.CLe,jc.a.application,Object(v.a)(this,this.BLe,"queryEffectOptions"),100);this.ia.ra(zc.a.A_a,jc.a.application,Object(v.a)(this,this.A_a,"setAnimationDirection"),
5);this.ia.ra(zc.a.pZa,jc.a.application,Object(v.a)(this,this.pZa,"queryAnimationDirection"),97);this.ia.ra(zc.a.B_a,jc.a.application,Object(v.a)(this,this.B_a,"setAnimationEffectData"),4);this.ia.ra(zc.a.rZa,jc.a.application,Object(v.a)(this,this.rZa,"queryAnimationEffectData"),96);this.ia.ra(zc.a.bnd,jc.a.application,Object(v.a)(this,this.vKa,"setAnimationSequence"),5);this.ia.ra(zc.a.cnd,jc.a.application,Object(v.a)(this,this.vKa,"setAnimationSequence"),5);this.ia.ra(zc.a.dnd,jc.a.application,
Object(v.a)(this,this.vKa,"setAnimationSequence"),5);this.ia.ra(zc.a.fnd,jc.a.application,Object(v.a)(this,this.vKa,"setAnimationSequence"),5);this.ia.ra(zc.a.Dna,jc.a.application,Object(v.a)(this,this.Dna,"queryAnimationSequence"),97);this.ia.ra(zc.a.LPe,jc.a.application,Object(v.a)(this,this.daa,"reorderAnimation"),4);this.ia.ra(zc.a.MPe,jc.a.application,Object(v.a)(this,this.daa,"reorderAnimation"),4);this.ia.ra(zc.a.Xgb,jc.a.application,Object(v.a)(this,this.Xgb,"populateAnimationEffectOptions"),
96);this.ia.ra(zc.a.hya,jc.a.application,Object(v.a)(this,this.hya,"setAnimationColor"),4);this.la.qT&&Ud.a("AnimationGalleryActionAIEnabled")&&this.ia.ra(zc.a.cPd,jc.a.application,Object(v.a)(this,this.B$d,"handleAnimationGalleryActionAI"),4)}De(){}Xgb(f,x,N,ea,ma){f=this.sQ();x=this.pa.sk();if(!x||!f)return 8;if(1===N)return 32;N=Lf.w3(x,f);if(!N||0===N.EffectId)return 16;ma.MenuItems=this.Gii(N,x,f);return 32}Cna(f,x,N,ea,ma){f=ma.queryResult;ma=ma.SourceControlId;var Ha=ea=-1;ma!==this.a6&&({effectType:Ha,
effectId:ea}=this.Fk.vRc(ma));x=this.sQ();var Ua=this.pa.sk();if(!Ua||!x)return 8;if(1!==N)return 32;({image:N,label:Cb}=this.Fk.wRc(ma));var mb=Cb;if(ma===this.a6||ma===this.$Ka)mb=ResourceStrings.L_ExistingButtonDescription;this.L8a(ma,N,Cb,f,mb);var gb=Lf.w3(Ua,x);var Cb=gb?gb.EffectId:0;mb=gb?gb.EffectType:0;const zb=!this.Fk.eab(gb,x);gb=this.Fk.hje(gb,x);this.P7j&&(Ua=Ua?Ua.RSa(x):null,gb=gb&&!this.Fk.WRj(Ua));ea=!zb&&!gb&&ea===Cb&&Ha===mb;Ha=zb?!1:this.Fk.iYc(mb,Cb);ma===this.a6||ma===this.$Ka?
(Ha=ma===this.a6?this.WGk(this.a6,f,gb,Ha,N,mb,Cb):Lf.UGk(f,gb,Ha),f.UU(zb||gb||Ha)):x&&f.UU(ea);return 32}B$d(f,x){if(x.contextId!==jc.a.application)return 2;f=this.sQ();return!this.pa.sk()||!f||f.pT||f.Cq||f.Mp?8:this.fc.$c(f)?16:32}WGk(f,x,N,ea,ma,Ha,Ua){N?this.L8a(f,ma,ResourceStrings.L_AnimationMultiple,x,ResourceStrings.L_AnimationMultiple):ea&&(ma=this.Fk.vTc(Ha,Ua),{image:ma,label:N}=this.Fk.wRc(ma),this.L8a(f,ma,N,x,N));return ea}L8a(f,x,N,ea,ma){let Ha;Ha=f===this.a6?"298832323":f===this.$Ka?
"1264919631":"2676673376";x=x.substring((Md.a.Lkc+"_").length,x.length-6);f=Object.assign(new Sg.a,{Id:f,ExternalId:"Animation"+f,Icon:x,Command:Ha,QueryCommand:"1852964326",LabelText:N,FullIconStyle:{root:{width:"32px",height:"32px"}},PreviewIconStyle:{root:{width:"24px",height:"24px"}},Alt:ma});ea.l3=f}aMe(f,x){if(x.contextId!==jc.a.application)return 2;f=this.sQ();return!this.pa.sk()||!f||f.pT||f.Cq||f.Mp?8:this.fc.$c(f)?16:32}vz(f,x,N,ea,ma){x=this.sQ();var Ha=this.pa.sk();if(!Ha||!x||x.pT||x.Cq||
x.Mp)return 8;if(this.fc.$c(x))return 16;var Ua=(ea=Lf.w3(Ha,x))?ea.EffectId:-1,mb=ea?ea.EffectType:-1;if(1===N)return f===zc.a.PKb||f===zc.a.C_a?(Ha=this.Fk.iYc(mb,Ua),N=!!ea&&!this.Fk.eab(ea,x),f===zc.a.C_a&&(Ha=N?!0:!1),x=!!ea&&this.Fk.hje(ea,x),x=N||x,Ha||x?32:16):f===zc.a.OKb?x.ud||x.ar||x.Mp?16:32:32;f=ma.SourceControlId;if(!f)return 8;if(f===this.a6||f===this.$Ka||f===this.RXe||f===this.SXe)return 32;({effectType:ma,effectId:N}=this.Fk.vRc(f));Ua=this.Fk.r6i(f);mb=this.Fk.o6i(f);ea=x.T$a()?
Lf.z5b(Ha,x):ea;ea||(ea=new Nf,ea.Id=x.id.toString(),ea.BuildIds=[Ha.g2b+1],ea.HasTrigger=!1,ea.BuildId=Ha.g2b+1,ea.SequenceIndex=0,ea.IsTextRangeType=!1);ea.HasExisting=!1;ea.HasMultiple=!1;ea.EffectType=ma;ea.SequenceId=1;ea.EffectId=N;ea.Direction=Ua;ea.EffectData=mb;ea.IsTrigger=!1;this.X2b(Ha,x,ea);e.ULS.sendTraceTag(512500802,800,50,"AnimationActorLegacy.SetAnimation: Effect={0}, SlideId.Sid={1}, ShapeId={2}",f,Ha.Cb.sid,x.id);this.q2j(Ha);return 32}hya(f,x,N,ea,ma){x=this.jq.presentation;if(!x)throw Error.argumentNull("Presentation is null");
f=this.sQ();if(!f)return 8;x=Object(C.a)(116,x.lC(f.slideId));if(!x)return 8;ea=Lf.w3(x,f);if(!(ea&&ma&&x&&f))return 8;if(this.fc.$c(f))return 16;if(1===N)return 32;N=je.Box4ColorHelper.oV(ma);N=je.Box4ColorHelper.wib(N,x.Ne);if(!N)return 8;ea.EffectData=String.format("{0},{1},{2}",N.r.toString(16),N.g.toString(16),N.b.toString(16));this.X2b(x,f,ea);return 32}BLe(){const f=this.sQ();var x=this.pa.sk();return x&&f?this.fc.$c(f)?16:(x=Lf.w3(x,f))&&this.Fk.Nni(f,this.Ea,x)?32:16:8}daa(f,x,N){x=this.sQ();
const ea=this.pa.sk();if(!ea||!x)return 8;if(this.fc.$c(x))return 16;const ma=Lf.z5b(ea,x);let Ha;switch(f){case zc.a.LPe:Ha=!1;break;case zc.a.MPe:Ha=!0;break;default:return 8}let Ua=!1;if(x&&(Ua=!!ma&&!ma.HasTrigger&&1===ma.BuildIds.length)){let mb=!1,gb=!1;({CZb:mb,EZb:gb}=Lf.Sni(ea,ma));Ua=Ha?gb&&Ua:mb&&Ua}if(1===N)return Ua?32:8;if(Ua){N=this.Jb.zd(15,void 0,()=>{this.pa.ij();this.Fa.Ed()});try{N.nc(ea),N.jd=f,ea.daa(x,Ha)}finally{N&&N.dispose()}}return 32}A_a(f,x,N,ea,ma){f=this.sQ();x=this.pa.sk();
if(!x||!f)return 8;if(1===N)return 32;if(this.fc.$c(f))return 16;N=Lf.z5b(x,f);if(!N)return 8;ma=ma.MenuItemId;N.Direction=this.Fk.H4b(ma);this.X2b(x,f,N);e.ULS.sendTraceTag(512500801,800,50,"AnimationActorLegacy.SetAnimationDirection: Effect={0}, EffectDirection={1}, SlideId.Sid={2}, ShapeId={3}",this.Fk.vTc(N.EffectType,N.EffectId),ma,x.sid,f.id);return 32}pZa(f,x,N,ea,ma){x=this.sQ();ea=this.pa.sk();if(!ea||!x)return 8;f=ma.queryResult;ma=this.Fk.H4b(ma.MenuItemId);x=Lf.w3(ea,x);1===N&&x&&f.Qf(x.Direction===
ma);return 32}vKa(f,x,N,ea,ma){f=ma.MenuItemId;x=this.sQ();ea=this.pa.sk();if(!ea||!x)return 8;if(1===N)return 32;if(this.fc.$c(x))return 16;N=Lf.z5b(ea,x);if(!N)return 8;N.SequenceId=this.Fk.v8d(f);this.X2b(ea,x,N);return 32}Dna(f,x,N,ea,ma){f=this.sQ();x=this.pa.sk();if(!x||!f)return 8;f=Lf.w3(x,f);x=ma.queryResult;ma=this.Fk.v8d(ma.MenuItemId);1===N&&f&&x.Qf(f.SequenceId===ma);return 32}B_a(f,x,N,ea,ma){f=this.sQ();x=this.pa.sk();if(!x||!f)return 8;if(1===N)return 32;if(this.fc.$c(f))return 16;
N=Lf.z5b(x,f);if(!N)return 8;if(!ma)return 2;N.EffectData=this.Fk.m5d(ma.MenuItemId);this.X2b(x,f,N);return 32}rZa(f,x,N,ea,ma){f=this.sQ();x=this.pa.sk();if(!x||!f)return 8;f=Lf.w3(x,f);1===N&&f&&ma.queryResult.Qf(this.Fk.iFf(f.EffectData,ma.MenuItemId));return 32}X2b(f,x,N){const ea=this.Jb.zd(15,void 0,()=>{this.pa.ij();this.Fa.Ed()});try{ea.nc(f),f.zpc(x,N)}finally{ea&&ea.dispose()}}Gii(f,x,N){const ea=Object.assign(new He.a,{Id:"AnimationMenuEffectOptions",UpdateDynamically:!0,Title:ResourceStrings.L_EffectOptions,
MenuSectionList:[]});Array.add(ea.MenuSectionList,this.Fk.XSc(f.EffectId,f.EffectType,"Direction","2289594085","3782857737"));this.Fk.Teg(f)&&(Array.add(ea.MenuSectionList,be.f(x.Ne,"Theme Colors","Color.Menu.Controls","themeColor","AnimationEffectOptionsThemeColorPicker","679168237",2)),Array.add(ea.MenuSectionList,be.d("Standard Colors","Color.Menu.Controls","standardColor","AnimationEffectOptionsStandardColorPicker","679168237",!1)));Array.add(ea.MenuSectionList,this.Fk.XSc(f.EffectId,f.EffectType,
"EffectData","2949363495","4132852551"));Array.add(ea.MenuSectionList,this.Fk.gfj(N,this.Ea,f));return ea}q2j(f){if(f){var x=f.Pk(),N=String.format("{0}#{1}",f.sid,f.cid);if(x&&0<x.length)for(const ea of x)if(x=f.aEa(ea)){const ma=x.EffectId,Ha=x.EffectType,Ua=x.Direction,mb=this.Fk.vTc(Ha,ma),gb=this.Ea.d0f(ea),Cb=Lf.Phj(ea,gb);e.ULS.sendTraceTag(512500800,800,50,"Slide animation info: Effect={0}, EffectID={1}, EffectType={2}, Direction={3}, Len={4}, ShapeType={5}, ShapeSubType={6}, SeqID={7}, SlideID={8}, ShapeID={9}",
mb,ma,Ha,Ua,ea.WD().length,gb,Cb,x.SequenceId,N,ea.id)}}}sQ(){const f=this.pa.Jp();return f?f.get_smartArtModelId()?this.Ea.vr(f):f.Kg?this.Ea.rs(f):f:null}static UGk(f,x,N){x?f.J8a=ResourceStrings.L_AnimationMultiple:(f.J8a=ResourceStrings.L_AnimationExisting,N&&(N=!1));return N}static Sni(f,x){let N,ea;if(!x)return{CZb:!1,EZb:!1};const ma=f.q_d,Ha=f.g2b,Ua=x.BuildIds[0];ea=N=!0;0===x.StartType?N=Ua>ma?!0:!1:ea=Ua<Ha?!0:!1;if(Ua===ma||Ua===Ha){if(!Ua)return{CZb:!1,EZb:ea};for(const mb of f.hQ)if(mb.Id!==
x.Id)for(const gb of mb.BuildIds)if(0===x.StartType){if(gb>=Ua)return ea=!0,{CZb:N,EZb:ea}}else if(gb===Ua)return N=!0,{CZb:N,EZb:ea};0===x.StartType?ea=!1:N=!1}return{CZb:N,EZb:ea}}static w3(f,x){return f&&x?f.w3(x):null}static z5b(f,x){return f&&x?f.aEa(x):null}static Phj(f,x){return 24===x?sf[f.smartArtInfo.SmartArtLayout]:1===x?f.shapeType.toString():14===x?tf[f.Gj]:"Unknown"}}Object(k.a)(Lf,"AnimationActorLegacy",null,[227]);class kf{constructor(f,x,N,ea){this.zf=null;this.Ca=f;this.Rmb=x;this.ARh=
N;this.pHd=ea;this.pHd.init();this.Rmb.init()}vb(){this.Ca.ra(ce.a.OGb,jc.a.application,Object(v.a)(this,this.OGb,"openGrammarSettings"),1028);this.Ca.ya(ce.a.s6b,Qb.a.frame,Object(v.a)(this,this.o7f,"grammarDialogTabFocusHandler"));this.Ca.ya(ce.a.r6b,Qb.a.frame,Object(v.a)(this,this.o7f,"grammarDialogTabFocusHandler"));this.Ca.ya(ce.a.mUc,Qb.a.frame,Object(v.a)(this,this.n7f,"grammarDialogOptionFocusHandler"));this.Ca.ya(ce.a.lUc,Qb.a.frame,Object(v.a)(this,this.n7f,"grammarDialogOptionFocusHandler"))}OGb(f,
x,N,ea,ma){f=this.pZf();if(1===N)return this.pHd.request(f).result&&this.pHd.request(f).result.length?6===this.Rmb.B3a.status?32:8:8;this.zf=this.ARh(f,this.Rmb.B3a.result);this.zf.showDialog(CommonUIStrings.l_GrammarSettingsDialogTitle,Ha=>{e.ULS.sendTraceTag(36489285,375,50,"User click button of {0}",1===Ha?"OK":0===Ha?"Cancel":"");1===Ha&&(this.zf.ZUj()?(e.ULS.sendTraceTag(36489286,375,50,"User update proofing options"),this.Rmb.saveSettings(this.zf.settings)):e.ULS.sendTraceTag(36508631,375,50,
"User click OK with but not update setting"))});f=N="";ma&&(N+=ma.SourceControlId,f+=ma.Alt);e.ULS.sendTraceTag(36489287,375,50,"Open grammar setting dialog, SourceControlId: "+N+", Alt: "+f);return 32}pZf(){return J.AFrameworkApplication.lcid}o7f(f){if(!this.zf)return 2;var x=this.zf.Jo.yl().uj.$Z;if(x===this.zf.Qv&&f===ce.a.s6b||x===this.zf.YZa&&f===ce.a.r6b)this.zf.u7?this.zf.Jo.yl().uj.VE(this.zf.u7):this.zf.a2k();else if(Sys.UI.DomElement.containsCssClass(x,ie.V0b)||x.parentNode&&Sys.UI.DomElement.containsCssClass(x.parentNode,
ie.V0b))x=null,f===ce.a.s6b?x=this.zf.YZa:f===ce.a.r6b&&(x=this.zf.Qv),this.zf.Jo.yl().uj.VE(x);else if(f===ce.a.s6b)this.zf.Jo.yl().BFb();else if(f===ce.a.r6b)this.zf.Jo.yl().zFb();else return 2;return 32}n7f(f){if(!this.zf)return 2;let x=this.zf.Jo.yl().uj.$Z;if(x===this.zf.Qv||x===this.zf.YZa||x===this.zf.pD)return 2;f===ce.a.lUc&&this.zf.Jo.yl().BFb();f===ce.a.mUc&&this.zf.Jo.yl().zFb();x=this.zf.Jo.yl().uj.$Z;x===this.zf.YZa?this.zf.Jo.yl().zFb():x===this.zf.Qv?this.zf.Jo.yl().BFb():this.zf.u7=
x;return 32}}Object(k.a)(kf,"GrammarSettingsActor",null,[]);class Ed extends kf{constructor(f,x,N,ea,ma,Ha,Ua){super(f,x,N,ea);this.ob=ma;this.awe=Ha;this.Ea=Ua}pZf(){let f=J.AFrameworkApplication.lcid;if(this.ob.F_(this.ob.Pa)){var x=this.ob.Xd();x&&1===x.length&&(x=this.Ea.BSa(x[0]),0<x&&(f=x))}else this.ob.Pa.mb&&(x=this.awe.iSc(this.ob.Qj),0<x&&(f=x));return f}}Object(k.a)(Ed,"EditorSettingsActor",kf,[]);var Cd=d(61),oh=d(321),Kg=d(241),ri=d(442),Af=d(41);class Zg{constructor(f,x,N,ea,ma,Ha,Ua,
mb,gb,Cb,zb,Pb){this.lTd=null;this.h9f=(oc,Ec,Xc)=>{var Ac;Ec=this.pa.We();if(!Ec||!Ec.length)return Vc.a.J(509362200,822,10,"FormatBackgroundActor::handleSlidesBackgroundReset: selected slides are empty"),8;for(const zd of Ec)if(!zd||this.fc.$c(zd))return Vc.a.J(509362199,822,10,"FormatBackgroundActor::handleSlidesBackgroundReset: selected slides is blocked"),8;if(!this.dcl(Ec))return Vc.a.J(509362198,822,50,"FormatBackgroundActor::handleSlidesBackgroundReset: The selected slide follow master background"),
8;if(1===Xc)return 32;null===(Ac=Af.a.Ib)||void 0===Ac?void 0:Ac.Va("SlideCount",Ec.length.toString());Xc=this.Jb.zd(15,void 0,()=>{this.Fa.Ed();this.pa.Qh()});try{Xc.nc(this.ua.Ba);Xc.jd=oc;for(const zd of Ec)zd.$nc=!0}finally{Xc&&Xc.dispose()}return 32};this.ia=f;this.Fa=x;this.fc=N;this.pa=ea;this.Jb=ma;this.PX=Ha;this.ua=Ua;this.fB=mb;this.dR=gb;this.ywe=Cb;this.Qd=zb;this.Ga=Pb}vb(){this.ia.ra(zc.a.Ssa,jc.a.application,Object(v.a)(this,this.k9f,"handleSlidesSolidFill"),4);this.ia.ra(zc.a.NPc,
jc.a.application,Object(v.a)(this,this.k9f,"handleSlidesSolidFill"),4);this.ia.ra(zc.a.m3d,jc.a.application,Object(v.a)(this,this.j9f,"handleSlidesPicture"),4);this.ia.ra(zc.a.LVf,jc.a.application,Object(v.a)(this,this.j9f,"handleSlidesPicture"),4);this.ia.ra(zc.a.l3d,jc.a.application,Object(v.a)(this,this.Ouj,"handleSlidesFinalizePicture"),4);this.ia.ra(zc.a.LPc,jc.a.application,Object(v.a)(this,this.G7f,"handleApplyAll"),4);this.ia.ra(zc.a.KVf,jc.a.application,Object(v.a)(this,this.G7f,"handleApplyAll"),
4);this.ia.ra(zc.a.jJe,jc.a.application,Object(v.a)(this,this.Tsj,"handlePopulateFillMenu"),96);this.ia.ra(zc.a.H$g,jc.a.application,Object(v.a)(this,this.Usj,"handlePopulateFillMenuForCanvasContextMenu"),96);this.ia.ra(zc.a.KCe,jc.a.application,Object(v.a)(this,this.Zrj,"handleMoreFormatBackgroundColors"),96);this.ia.ra(zc.a.ehd,jc.a.application,Object(v.a)(this,this.$rj,"handleMoreFormatBackgroundColorsResponse"),4);this.ia.ra(zc.a.MPc,jc.a.application,this.h9f,4);this.ia.ra(zc.a.MVf,jc.a.application,
this.h9f,4)}De(){}Tsj(f,x,N,ea,ma){f=this.ua.Ba;if(!f||this.fc.$c(f))return 16;if(1===N)return 32;if(!ma)return Vc.a.J(512500616,822,10,"HandlePopulateFillMenu requires actionData"),8;N=f.Ne;if(!N)return Vc.a.J(512500615,822,10,"HandlePopulateFillMenu failed to get theme information from slide"),8;f=this.PX.Cf.M7;x=Object.assign(new He.a,{Id:"PptRibbon.Drawing.ShapeFill",MenuSectionList:[]});Array.add(x.MenuSectionList,be.f(N,"Theme Colors","Color.Menu.Controls","themeColor","FormatBackgroundThemeColors",
"3049223287",1));Array.add(x.MenuSectionList,be.d("Standard Colors","Color.Menu.Controls","standardColor","FormatBackgroundStandardColors","3049223287",!1));f&&0<f.length?(appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("FormatBackgroundRecentColors",!1)),Array.add(x.MenuSectionList,be.c(f,"Recent Colors","Color.Menu.Controls","recentColor","FormatBackgroundRecentColors","1912773268",!1))):appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("FormatBackgroundRecentColors",
!0));Array.add(x.MenuSectionList,be.a("More Format Background Color","Color.Menu.Controls","3938657252",ResourceStrings.l_MoreFormatBackgroundColors,"Color.Menu.MoreFormatBackgroundColors","MoreFormatBackgroundColors","per_AppointmentColor0_16x16x32",ResourceStrings.l_MoreFormatBackgroundColorsKeytip));ma.MenuItems=x;return 32}Usj(f,x,N,ea,ma){f=this.ua.Ba;if(!f||this.fc.$c(f))return 16;if(1===N)return 32;if(!ma)return Vc.a.J(512623376,822,10,"HandlePopulateFillMenuForCanvasContextMenu requires actionData"),
8;x=f.Ne;if(!x)return Vc.a.J(512623374,822,10,"HandlePopulateFillMenuForCanvasContextMenu failed to get theme information from slide"),8;N=this.PX.Cf.M7;ea=zc.a.NPc.toString();f=Object.assign(new He.a,{Id:"PptRibbon.Drawing.ShapeFill",MenuSectionList:[]});f.MenuSectionList.push(be.f(x,"Theme Colors","Color.Menu.Controls","themeColor","FormatBackgroundThemeColorsFromCanvas",ea,1));f.MenuSectionList.push(be.d("Standard Colors","Color.Menu.Controls","standardColor","FormatBackgroundStandardColorsFromCanvas",
ea,!1));x=zc.a.ehd.toString();N&&0<N.length?(appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("FormatBackgroundRecentColors",!1)),f.MenuSectionList.push(be.c(N,"Recent Colors","Color.Menu.Controls","recentColor","FormatBackgroundRecentColors",x,!1))):appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("FormatBackgroundRecentColors",!0));f.MenuSectionList.push(be.a("More Format Background Color","Color.Menu.Controls",zc.a.KCe.toString(),ResourceStrings.l_MoreFormatBackgroundColors,
"Color.Menu.MoreFormatBackgroundColors","MoreFormatBackgroundColors","per_AppointmentColor0_16x16x32",ResourceStrings.l_MoreFormatBackgroundColorsKeytip));ma.MenuItems=f;return 32}k9f(f,x,N,ea,ma){x=this.pa.We();if(!x||!x.length)return 16;for(const Ha of x)if(!Ha||this.fc.$c(Ha))return 16;if(1===N)return 32;N=Zg.Yfd(ma);if(!N)return 8;Af.a.Ib&&Af.a.Ib.Va("SlideCount",x.length.toString());ma=this.Jb.zd(15,void 0,()=>{this.Fa.Ed();this.pa.Qh()});try{ma.nc(this.ua.Ba);ma.jd=f;for(const Ha of x)Ha.Drb=
N}finally{ma&&ma.dispose()}return 32}j9f(f,x,N){this.lTd=this.ua.Ba;f=this.pa.We();if(!f||!f.length)return 16;for(const ea of f)if(!ea||this.fc.$c(ea)||Cd.a.ax(ea.Cb))return 16;if(1===N)return 32;this.Ipd(!1);return 32}G7f(f,x,N){x=this.ua.Ba;if(!x||this.fc.$c(x))return 16;if(1===N)return 32;N=x.Cb;x=this.PX.Cf;if(!x)return 8;const ea=this.Jb.zd(15,void 0,()=>{this.Fa.Ed();this.pa.Qh()});try{ea.nc(x),ea.jd=f,x.drb=N}finally{ea&&ea.dispose()}return 32}dcl(f){const x=this.PX.Cf;if(!x)return Vc.a.J(509362197,
822,50,"FormatBackgroundActor::shouldEnableResetBackground: Current presentation is null"),!1;for(const ea of f)if((f=ea.DS)&&-1==f.indexOf("/BgSource/ContentMaster")&&-1==f.indexOf("/BgSource/MainMaster")){var N=x.dXi(ea.hj,ea.Bn);if(!N){Vc.a.J(509362196,822,50,"FormatBackgroundActor::shouldEnableResetBackground: Slide master for current slide is null");break}N=N.DS;if(!N||!f.match(N))return!0}return!1}Ouj(f,x,N,ea,ma){x=this.pa.We();if(!x||!x.length)return 16;for(const Ua of x)if(!Ua||!Ua.isConnected)return 16;
if(1===N)return 32;this.dR.Ugb=new Date;const Ha=Af.a.Ib;this.fB.pYe(ma,Ua=>{Af.a.ZK(Ha,()=>{this.Quj(Ua,f)})},Ua=>{this.O6b(Ua.error)});this.ua.Ba===this.lTd&&(this.Fa.Ed(),this.pa.Qh());return 32}Zrj(f,x,N,ea,ma){f=this.ua.Ba;if(!f||this.fc.$c(f))return Vc.a.J(512500611,822,10,"HandleMoreFormatBackgroundColors: currentSlide is null"),16;if(this.Ga.tC&&Ud.a("MoreColorBackgroundForMultipleSlidesEnabled")?1>this.pa.We().length:1!==this.pa.We().length)return 16;if(1===N)return this.ia.La(zc.a.renderColorPicker,
1,ma);N=Kg.a.parse(f.DS);if(!N)return 8;ma=N.GLa();N=null;ma&&(N=je.Box4ColorHelper.Usa(ma));ma={};ma.currentColor=N;ma.handleCommand=zc.a.ehd;return this.ia.La(zc.a.renderColorPicker,2,ma)}$rj(f,x,N,ea,ma){if(1===N)return this.ia.La(zc.a.Ssa,N,ma);if(!ma)return Vc.a.J(512500609,822,10,"HandleMoreFormatBackgroundColorsResponse: actionData is null"),16;f=this.ia.La(zc.a.Ssa,N,ma);32===f&&this.ia.La(zc.a.zBa,N,ma);return f}Ipd(f){this.ywe?ri.a(ResourceStrings.l_GenericDialogTitle,CommonUIStrings.l_NeedToSignIn,
null):this.fB&&(this.fB.IOb=1,this.fB.jch(f))}Quj(f,x){this.dR.ZYa=new Date;(f=f.result)?this.ypi(f,x):(x=Object.assign(new oh.a,{Code:94}),this.O6b(x))}ypi(f,x){const N=this.pa.We(),ea=this.Jb.zd(15);try{ea.nc(this.lTd);ea.jd=x;for(const ma of N)ma.oC=f.ItemId}finally{ea&&ea.dispose()}if(f=Af.a.Ib)f.actionName="FormatBackgroundPicture",f.Va("PictureUploadStart",Af.a.nf(this.dR.Ugb)),f.Va("PictureUploadDurationMS",(+this.dR.ZYa-+this.dR.Ugb).toString())}O6b(f){this.dR.ZYa=new Date;this.Qd.YG(f.Code,
x=>{x.$B=1;x.GRa=f.ExtraErrorParam;return!1})}static Yfd(f){return Kg.a.parse(f.Color)}}Object(k.a)(Zg,"FormatBackgroundActor",null,[227]);var gi=d(75),jg=d(31),Hh=d(415),hj=d(30),Hk=d(152);const yd=f=>{let x=f.isBold?"b:1;":"";x+=f.isItalic?"i:1;":"";x+=f.dE?"u:1;":"";x+=f.KF?"s:1;":"";x+=f.isSuperscript?"sup:1;":"";return x+=f.LF?"sub:1;":""},ef=(f,x,N)=>{let ea=null;for(var ma,Ha=jg.ParagraphReader.text(f),Ua=0;f.Ra&&Ua<f.Ra.length;){var mb=f.Ra.ga(Ua),gb=mb.cp;ma=Ua<f.Ra.length-1?f.Ra.ga(Ua+1).cp:
jg.ParagraphReader.textLength(f);if(-1!==x&&ma<=x)Ua++;else{if(-1!==N&&gb>N)break;var Cb="";mb.formatting?Cb=yd(mb.formatting.cache):(mb=Hh.c(f.Ra,mb.cp).q0c)&&(Cb=yd(mb.cache));mb=gb;-1!==x&&(mb=Math.max(x,gb));gb=ma;-1!==N&&(gb=Math.min(N,ma));gb=H.a.substring(Ha,mb,gb);0<gb.length&&(ma=document.createElement("span"),ma.setAttribute("style",Cb),ma.innerText=gb,ea||(ea=document.createElement("p")),ea.appendChild(ma));Ua++}}if(ea&&jg.ParagraphReader.VW(f)){x=ea;N=x.setAttribute;Ua=new hj.GraphIterator;
Ua.set(f);Ua.rc(11);Ua.Ng(11);Ha="";if(f.Sf.fw(Ua))switch(Ua=f.Sf.fw(Ua),f=jg.ParagraphReader.Kgb(f),Cb=Ua.eX,Ua.listType){case 0:switch(Ua.listStyle){case 1:Ha="decimal";break;case 2:Ha="loweralpha";break;case 3:Ha="lowerroman";break;case 4:Ha="upperalpha";break;case 5:Ha="upperroman";break;default:Ha="decimal"}Ha=String.format("lt:{0};in:{1};li:{2}",Ha,f,Cb);break;case 1:switch(Ua.listStyle){case 1:Ha="disc";break;case 2:Ha="circle";break;case 3:Ha="square";break;default:Ha="disc"}Ha=String.format("lt:{0};in:{1}",
Ha,f)}N.call(x,"style",Ha)}return ea},yh=f=>{if(f){var x;(x=na.a.instance.resolve("PowerPointWebEditor.Graph.ITableReader"))?x=x.FN(f):(Vc.a.J(512500561,822,10,"ImmersiveReader: TableReader is null."),x=null);if(x){f=null;x=x.M9a();for(let N=0;N<x.length;N++){const ea=Bg(Object(C.a)(gi.AParagraphNode,x[N].A3b));f=Kd(ea,f)}return f}f=Array.isArray(f.WD())?f.WD():null;return Bg(f&&0<f.length?f[0]:null)}return null},Bg=f=>{let x=null;for(;f;){const N=ef(f,-1,-1);x=Kd(N,x);f=jg.ParagraphReader.lta(f,
!1,!0,!1)}return x},Kd=(f,x)=>{f&&(x||(x=document.createElement("div")),x.appendChild(f));return x},Rj=f=>{const x=Object.assign(new Hk.a,{Source:6});na.a.instance.resolve("PowerPointWebEditor.IErrorHandler").us(x,f,N=>{N.$B=1;N.cCa=0;N.title=ResourceStrings.L_ImmersiveReaderErrorDialogTitle;N.message=ResourceStrings.L_ImmersiveReaderErrorDialogMessage;return!1})};class Ia{constructor(f,x,N,ea){this.syg=!1;this.U9c="";this.ia=f;this.Fa=x;this.ob=N;const ma=new Date;ea("immersiveReader").then(()=>
{this.syg=!0;Vc.a.J(512500569,822,50,"ImmersiveReader: Loaded SDK successfully. Duration (ms): {0}",+new Date-+ma)}).catch(Ha=>{const Ua=+new Date-+ma;Vc.a.J(512500568,822,10,"ImmersiveReader: Failed to load SDK. Duration (ms): {0}, Exception: {1} ",Ua,Ha.toString());const mb=new Map;mb.set("JSLoadDurationInMs",Ua.toString());mb.set("Exception",Ha.toString());A.Health.instance.recordKpiFailure("ImmersiveReaderTriggered","JSLoadFailed",!1,!0,Object.assign(new Ea.a,{extendedProperties:mb}))})}vb(){this.ia.ya(zc.a.immersiveReader,
jc.a.view,Object(v.a)(this,this.pbg,"immersiveReaderHandler"));this.ia.ya(zc.a.Xbe,jc.a.view,Object(v.a)(this,this.pbg,"immersiveReaderHandler"))}De(){this.Fa.Gc(Zc.a.iQ).bindAction(Zb.KeyInputManager.Na(og.a.Guc,Zb.KeyInputManager.Le|4),zc.a.immersiveReader)}K1i(f){let x="";for(f=Object(C.a)(gi.AParagraphNode,f.node);f;){const N=jg.ParagraphReader.lta(f,!0,!0,!1);if(N)f=N;else break}for(;f;)x+="\n"+jg.ParagraphReader.text(f),f=jg.ParagraphReader.lta(f,!1,!0,!1);return x}sji(){var f=this.ob.We();
let x=null;if(!f)return null;for(const N of f)if(f=N.SSa())for(const ea of f)f=yh(ea),x=Kd(f,x);return x}rji(){let f=null;var x=this.ob.Pa;if(!x)return null;for(let ma of x)if(ma)for(x=0;x<ma.length;x++){var N=ma.ga(x),ea=null;if(N.contextId===jc.a.outline||N.contextId===jc.a.Of)if(jg.ParagraphReader.Yd(N.node)){for(N=Object(C.a)(gi.AParagraphNode,N.node);N;)if(ea=jg.ParagraphReader.lta(N,!0,!0,!1))N=ea;else break;ea=Bg(N)}else ea=yh(Object(C.a)(4,N.node));else N.contextId!==jc.a.endOfParagraph&&
jg.ParagraphReader.Yd(N.node)&&(ea=ef(Object(C.a)(gi.AParagraphNode,N.node),N.Qa,N.Nb));f=Kd(ea,f)}return f}wji(){let f;return(f=this.ob.xs()?this.sji():this.rji())?f.innerHTML:""}Hkj(){let f="";const x=this.ob.Pa.mb;if(x)for(let N=0;N<x.length;N++){const ea=x.ga(N),ma=ea.Qa,Ha=ea.Nb-ma;let Ua;if(jg.ParagraphReader.Yd(ea.node))switch(Ua=ea.node.characterData,ea.contextId){case jc.a.paragraph:f+=Ua+"\r";break;case jc.a.textRange:0<Ha&&(f+=Ua.substr(ma,Ha));break;case jc.a.endOfParagraph:f+="\r";break;
case jc.a.Of:f+=this.K1i(ea)}}return f}Hmg(){const f=new XMLHttpRequest,x=na.a.instance.resolve("PowerPointWebEditor.ISessionInfoOwner").podSessionId;var N=na.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").podsWebServiceBase;N=String.format("{0}PodHandler.ashx?action=ImmersiveReaderAuthToken&PodSID={1}",N,x);f.open("GET",N,!0);const ea=ha.a.create().toString();f.setRequestHeader("X-UserSessionId",J.AFrameworkApplication.userSessionId);f.setRequestHeader("X-CorrelationID",ea);f.setRequestHeader("X-WacCluster",
na.a.instance.resolve("PowerPointWebEditor.ISessionInfoOwner").nk);let ma=null;const Ha=new Map;f.onreadystatechange=()=>{if(4===f.readyState)if(200===f.status){var Ua=+new Date-+ma;Vc.a.J(512500567,822,50,"ImmersiveReader: auth token received. Duration (ms): {0}",Ua);Ha.set("AuthTokenDurationInMs",Ua.toString());Ua=f.responseText.replace('"',"");const mb=new Date,gb=Ud.a("EnableSendingHTMLToIR")?[{["content"]:this.U9c,["mimeType"]:"text/html"}]:[{["content"]:this.U9c}];immersiveReader.launchAsync(Ua,
null,{["title"]:ResourceStrings.L_ImmersiveReaderDialogTitle,["chunks"]:gb},null).then(Cb=>{Cb=(Cb=Object(C.a)(Object,Cb))?Cb.sessionId:"";const zb=+new Date-+mb,Pb=+new Date-+ma;Vc.a.J(512500566,822,50,"ImmersiveReader: IR Pane launched successfully. Duration (ms) of LaunchAsync(): {0}, IR response sessionId: {1}",zb,Cb);Ha.set("LaunchAsyncDurationInMs",zb.toString());Ha.set("IRResponseSessionId",Cb);Ha.set("UserPerceivedDurationInMs",Pb.toString());A.Health.instance.recordKpiSuccess("ImmersiveReaderTriggered",
Object.assign(new Ea.a,{extendedProperties:Ha}))}).catch(Cb=>{Rj(x);const zb=+new Date-+mb,Pb=+new Date-+ma;Vc.a.J(512500565,822,10,"ImmersiveReader: LaunchAsync failed. Duration (ms): {0}, ErrorJson: {1}",zb,Cb);Ha.set("LaunchAsyncDurationInMs",zb.toString());Ha.set("ErrorJson",Cb.toString());Ha.set("UserPerceivedDurationInMs",Pb.toString());A.Health.instance.recordKpiFailure("ImmersiveReaderTriggered","LaunchAsyncFailed",!1,!0,Object.assign(new Ea.a,{extendedProperties:Ha}))})}else Rj(x),Ua=+new Date-
+ma,Vc.a.J(512500564,822,10,"ImmersiveReader: Request for auth token failed. Duration (ms): {0}, statusCode:{1}, CorrelationId: {2}",Ua,f.status,ea),Ha.set("CorrelationId",ea),Ha.set("StatusCode",f.status.toString()),Ha.set("UserPerceivedDurationInMs",Ua.toString()),A.Health.instance.recordKpiFailure("ImmersiveReaderTriggered","RequestForAuthTokenFailed",!1,!0,Object.assign(new Ea.a,{extendedProperties:Ha}));else Vc.a.J(512500563,822,15,"Immersive Reader auth token request in progress. CorrelationId: {0}, Request Status: {1}",
ea,f.status)};ma=new Date;Vc.a.J(512500562,822,50,"Begin request for ImmersiveReader auth token. StartTime: {0}, CorrelationId: {1}",ma.getTime(),ea);N=new Map;N.set("CorrelationId",ea);N.set("Info","RequestingAuthToken");A.Health.instance.recordKpiUsage("ImmersiveReaderTriggered",1,null,N);f.send(null)}pbg(f,x,N){if(1===N||6===this.ia.wq){if(!this.syg)return 8;this.U9c=Ud.a("EnableSendingHTMLToIR")?this.wji():this.Hkj();if(""===this.U9c)return 8}2===N&&this.Hmg();return 32}}Object(k.a)(Ia,"ImmersiveReaderActor",
null,[227]);var nb=d(576),Kb=d(781);class dc{constructor(f){this.customData=null;this.lQ=f}}Object(k.a)(dc,"PropertySetChangedState",null,[]);class Ic{static VEk(f,x,N){if(f&&x){var ea=new dc(x),ma=(Ha,Ua,mb)=>{N.UEk(Ha,Ua,mb,ea)};f=new Kb.a(x,f);f.$Fc=ma;f.EIc=ma;f.qkd=ma;f.wfa()}}}Object(k.a)(Ic,"PropertySetChangedManager",null,[]);class Id{constructor(f){this.cYh=f}UEk(f,x,N,ea){const ma=this.cYh[f.id.toString()];ma&&ma(f,x,N,ea)}}Object(k.a)(Id,"PropertyChangedProcessor",null,[]);var ae=d(1082),
Od=d(438),Hd=d(59),Bf=d(575),Of=d(398),ph=d(954);class Qh{constructor(){this.rLe=this.Q0c=this.hWc=null}}Object(k.a)(Qh,"ParagraphDialogResults",null,[]);class Lg extends lb.a{constructor(f,x,N){super(void 0,void 0,!0);this.cva=null;if(null===f)throw Error.argumentNull("properties");this.mea=f.clone();this.S9=f.clone();this.dB=N;this.ia=x;this.Eak=new Ya.a(Object(v.a)(this,this.PEi,"createPropertyChangedHandlers"))}kpd(){this.ig="ParagraphDialog";const f={};f.bodyControls=this.n4d();this.$i(ResourceStrings.L_ParagraphDialogTitle,
Object(v.a)(this,this.eZd,"dialogResultHandler"),f)}eZd(f,x){1===f&&(this.Nzl(x),f=Object.assign(new Qh,{hWc:this.mea,Q0c:this.S9,rLe:this.Eak}),this.ia.La(zc.a.fFf,2,f));this.dispose()}n4d(){this.cva=Lg.h5d();const f={};this.Lwi(f);this.Zvi(f);var x=ph.a("Inch",3,0,56,.1);const N=ph.a("Character",2,0,56,.1);x=[x,N];this.nxi(f,x);this.dwi(f,x);x=[ph.a("Point",5,0,1584,1)];this.ewi(f,x);this.Yvi(f,x);this.Mwi(f);return f}Nzl(f){this.Zwl(f);this.BAl(f);this.nxl(f);this.oxl(f);this.Xwl(f);this.azl(f)}PEi(){const f=
{};f[Hd.a.eE.id.toString()]=Object(v.a)(this.dB,this.dB.rWj,"justificationChangedHandler");f[Hd.a.XGb.id.toString()]=Object(v.a)(this.dB,this.dB.o8g,"paraIndentLeftChangedHandler");f[Hd.a.YGb.id.toString()]=Object(v.a)(this.dB,this.dB.o8g,"paraIndentLeftChangedHandler");f[Hd.a.Yfa.id.toString()]=Object(v.a)(this.dB,this.dB.UXe,"specialIndentChangedHandler");f[Hd.a.vMb.id.toString()]=Object(v.a)(this.dB,this.dB.UXe,"specialIndentChangedHandler");f[Hd.a.wMb.id.toString()]=Object(v.a)(this.dB,this.dB.UXe,
"specialIndentChangedHandler");f[Hd.a.ox.id.toString()]=Object(v.a)(this.dB,this.dB.pYj,"lineSpacingChangedHandler");f[Hd.a.aHb.id.toString()]=Object(v.a)(this.dB,this.dB.r8g,"paraSpacingAfterChangedHandler");f[Hd.a.$Gb.id.toString()]=Object(v.a)(this.dB,this.dB.r8g,"paraSpacingAfterChangedHandler");f[Hd.a.dHb.id.toString()]=Object(v.a)(this.dB,this.dB.t8g,"paraSpacingBeforeChangedHandler");f[Hd.a.cHb.id.toString()]=Object(v.a)(this.dB,this.dB.t8g,"paraSpacingBeforeChangedHandler");return f}Mwi(f){var x=
Lg.saj(this.mea),N="multiple"===x;f.lineSpacingComboBoxProps={["type"]:"AppComboBoxProps",["id"]:"LineSpacingComboBox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacing,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingAlt,["showLabel"]:!0,["options"]:ph.b([Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingSingle,Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingOneAndHalf,Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingDouble,Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingMultiple],
["1.00","1.50","2.00","multiple"]),["selectedKey"]:x,["allowFreeForm"]:!1};x=0;let ea=!1;this.mea.Sa(Hd.a.ox)&&N&&(x=this.mea.eb(Hd.a.ox),0<=x&&(ea=!0));N=[ph.a("none",0,0,9.99,.5)];N={["type"]:"AppSpinButtonProps",["id"]:"AtSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingAt,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingAtAlt,["unitType"]:"none",["validUnits"]:N,["numberFormatInfo"]:this.cva,["validReservedValues"]:[""]};N.value=ea?x:"";f.atSpinButtonProps=
N}Yvi(f,x){f.afterSpacingSpinButtonProps=Lg.nod(Lg.IXf(this.mea,Hd.a.aHb,Hd.a.$Gb),{["type"]:"AppSpinButtonProps",["id"]:"AfterSpacingSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingAfter,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingAfterAlt,["unitType"]:Bf.a.g0b(5),["validUnits"]:x,["numberFormatInfo"]:this.cva,["validReservedValues"]:[""]})}ewi(f,x){f.beforeSpacingSpinButtonProps=Lg.nod(Lg.IXf(this.mea,Hd.a.dHb,Hd.a.cHb),{["type"]:"AppSpinButtonProps",["id"]:"BeforeSpacingSpinButton",
["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingBefore,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingBeforeAlt,["unitType"]:Bf.a.g0b(5),["validUnits"]:x,["numberFormatInfo"]:this.cva,["validReservedValues"]:[""]})}dwi(f,x){let N,ea;({F7g:ea,G7g:N}=Lg.w0f(this.mea,Hd.a.YGb,Hd.a.XGb,!1));x={["type"]:"AppSpinButtonProps",["id"]:"BeforeTextSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentLeft,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentLeftAlt,
["unitType"]:Bf.a.g0b(N),["validUnits"]:x,["numberFormatInfo"]:this.cva,["validReservedValues"]:[""]};x=Lg.nod(ea,x);f.beforeTextSpinButtonProps=x}nxi(f,x){var N={["type"]:"AppComboBoxProps",["id"]:"SpecialComboBox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentation,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentationAlt,["showLabel"]:!0,["options"]:ph.b([Box4Intl.Box4Strings.l_ParagraphDialogNoneIndent,Box4Intl.Box4Strings.l_ParagraphDialogFirstLineIndent,Box4Intl.Box4Strings.l_ParagraphDialogHangingIndent],
["0","1","2"]),["allowFreeForm"]:!1},ea=this.mea.Sa(Hd.a.Yfa)?this.mea.eb(Hd.a.Yfa):-1;Lg.jkg(ea)?N.selectedKey=ea.toString():N.defaultSelectedKey="";f.specialIndentationComboBoxProps=N;({F7g:N,G7g:ea}=Lg.w0f(this.mea,Hd.a.wMb,Hd.a.vMb,1!==ea&&2!==ea));x={["type"]:"AppSpinButtonProps",["id"]:"BySpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentationBy,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentationByAlt,["unitType"]:Bf.a.g0b(ea),["validUnits"]:x,["numberFormatInfo"]:this.cva};
x=Lg.nod(N,x);f.bySpinButtonProps=x}Zvi(f){const x={["type"]:"AppComboBoxProps",["id"]:"AlignmentComboBox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogAlignment,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogAlignmentAlt,["showLabel"]:!0,["options"]:ph.b([Box4Intl.Box4Strings.l_ParagraphDialogAlignLeft,Box4Intl.Box4Strings.l_ParagraphDialogAlignCenter,Box4Intl.Box4Strings.l_ParagraphDialogAlignRight,Box4Intl.Box4Strings.l_ParagraphDialogAlignJustified],["1","2","3","6"]),["allowFreeForm"]:!1},
N=this.mea.Sa(Hd.a.eE)?this.mea.eb(Hd.a.eE):0;Lg.ANj(N)?x.selectedKey=N.toString():x.defaultSelectedKey="";f.alignmentComboBoxProps=x}Lwi(f){f.generalLabelProps={["type"]:"AppLabelProps",["id"]:"GeneralSection",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogGeneral,["forId"]:"GeneralGroup"};f.indentationLabelProps={["type"]:"AppLabelProps",["id"]:"IndentationSection",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentation,["forId"]:"IndentationGroup"};f.spacingLabelProps={["type"]:"AppLabelProps",
["id"]:"SpacingSection",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacing,["forId"]:"SpacingGroup"}}azl(f){if(f.lineSpacingComboBoxProps){const x=f.lineSpacingComboBoxProps.selectedKey.toString();let N=ph.c(x);"multiple"===x&&(f=f.atSpinButtonProps)&&(N=parseFloat(f.value.toString()));this.S9.setValue(Hd.a.ox,N);this.S9.setValue(Hd.a.gX,2)}}Xwl(f){if(f.afterSpacingSpinButtonProps){f=f.afterSpacingSpinButtonProps;var x=Bf.a.f0b(f.unitType.toString().toLowerCase());""!==f.value.toString()&&(x=
4===x?2:4,this.S9.setValue(Hd.a.aHb,parseInt(f.value.toString())),this.S9.setValue(Hd.a.$Gb,x))}}oxl(f){if(f.beforeSpacingSpinButtonProps){f=f.beforeSpacingSpinButtonProps;var x=Bf.a.f0b(f.unitType.toString().toLowerCase());""!==f.value.toString()&&(x=4===x?2:4,this.S9.setValue(Hd.a.dHb,parseInt(f.value.toString())),this.S9.setValue(Hd.a.cHb,x))}}nxl(f){if(f.beforeTextSpinButtonProps){var x=f.beforeTextSpinButtonProps;f=Bf.a.f0b(x.unitType.toString().toLowerCase());if(""!==x.value.toString()){x=parseFloat(x.value.toString());
let N;2===f?N=2:(N=1,x=Bf.a.eEh(x,f));this.S9.setValue(Hd.a.YGb,x);this.S9.setValue(Hd.a.XGb,N)}}}BAl(f){var x=f.bySpinButtonProps,N=f.didChangeSpecialIndentationComboBoxValue;if(x&&""!==x.value.toString()||N)if(f.specialIndentationComboBoxProps&&(f=f.specialIndentationComboBoxProps,N=-1,f.selectedKey&&(f=f.selectedKey.toString(),N=parseInt(f)),Lg.jkg(N)&&this.S9.setValue(Hd.a.Yfa,N)),x){f=parseFloat(x.value.toString());x=Bf.a.f0b(x.unitType.toString().toLowerCase());if(0>f||isNaN(f))f=0;2===x?N=
2:(N=1,f=Bf.a.eEh(f,x));this.S9.setValue(Hd.a.wMb,f);this.S9.setValue(Hd.a.vMb,N)}}Zwl(f){f.alignmentComboBoxProps&&(f=f.alignmentComboBoxProps,f.selectedKey&&(f=parseInt(f.selectedKey.toString()),0<=f&&this.S9.setValue(Hd.a.eE,f)))}static IXf(f,x,N){if(f.Sa(x)&&f.Sa(N)){N=f.eb(N);if(2!==N&&4!==N)return Number.NaN;f=f.eb(x);2===N&&(f*=Lg.nAk);return f}return Number.NaN}static nod(f,x){x.value=isNaN(f)?"":f;return x}static h5d(){return{["negativeSign"]:"-",["numberDecimalDigits"]:2,["numberDecimalSeparator"]:".",
["numberNegativePattern"]:1,["numberGroupSeparator"]:",",["numberGroupSizes"]:[3]}}static w0f(f,x,N,ea){let ma=3;Ud.a("BySpinButtonDefaultvalueFix")&&ea?x=0:f.Sa(x)&&f.Sa(N)&&!ea?(x=f.eb(x),2===f.eb(N)?ma=2:x=Bf.a.fDl(x,ma)):x=Number.NaN;return{F7g:x,G7g:ma}}static ANj(f){return 1===f||2===f||3===f||6===f}static jkg(f){return 1===f||2===f||0===f}static saj(f){if(Lg.twj(f)){f=f.eb(Hd.a.ox);var x="multiple";Of.a.Uy(f,1)?x="1.00":Of.a.Uy(f,1.5)?x="1.50":Of.a.Uy(f,2)&&(x="2.00");return x}}static twj(f){return f.Sa(Hd.a.ox)&&
f.Sa(Hd.a.gX)&&2===f.eb(Hd.a.gX)?!0:!1}}Lg.nAk=72;Object(k.a)(Lg,"ReactParagraphDialog",lb.a,[]);class Fg{constructor(f,x,N,ea,ma,Ha,Ua,mb,gb,Cb,zb){this.kqe=[];this.ia=f;this.pa=x;this.Eea=N;this.X9=ea;this.Jb=ma;this.Hh=Ha;this.uHa=Ua;this.Ea=mb;this.dB=gb;this.Bea=Cb;this.AUg=zb}vb(){this.ia.ra(zc.a.fAb,jc.a.application,Object(v.a)(this,this.Mwk,"paragraphDialogHandler"),4);this.ia.ra(zc.a.fFf,jc.a.application,Object(v.a)(this,this.Zui,"commitParagraphDialogHandler"),4);this.ia.ra(zc.a.Uch,jc.a.view,
Od.a.W0,96);this.ia.ra(zc.a.Kch,jc.a.view,Od.a.W0,96);this.ia.ra(zc.a.gdh,jc.a.view,Od.a.W0,96);this.ia.ra(zc.a.hdh,jc.a.view,Od.a.W0,96);this.ia.ra(zc.a.fdh,jc.a.view,Od.a.W0,96);this.ia.ra(zc.a.edh,jc.a.view,Od.a.W0,96);this.ia.ra(zc.a.Och,jc.a.view,Od.a.W0,96);this.ia.ra(zc.a.Pch,jc.a.view,Od.a.W0,96);this.ia.ya(zc.a.s7g,jc.a.view,Od.a.ZG);this.ia.ya(zc.a.Ywh,jc.a.view,Od.a.ZG);this.ia.ya(zc.a.Bbg,jc.a.view,Od.a.ZG);this.ia.ya(zc.a.axh,jc.a.view,Od.a.ZG);this.ia.ya(zc.a.$wh,jc.a.view,Od.a.ZG);
this.ia.ya(zc.a.t7g,jc.a.view,Od.a.ZG);this.ia.ya(zc.a.u7g,jc.a.view,Od.a.ZG);this.ia.ya(zc.a.o7g,jc.a.view,Od.a.ZG);this.ia.ya(zc.a.Zwh,jc.a.view,Od.a.ZG);this.ia.ya(zc.a.n7g,jc.a.view,Od.a.ZG);this.ia.ya(zc.a.w7g,jc.a.view,Od.a.ZG);this.ia.ya(zc.a.v7g,jc.a.view,Od.a.ZG);this.ia.ya(zc.a.bxh,jc.a.view,Od.a.ZG);this.ia.ya(zc.a.Xhd,jc.a.paragraph,Object(v.a)(this,this.Lej,"getPropertiesForParagraphDialog"));this.ia.ya(zc.a.Xhd,jc.a.view,this.Bea);this.ia.he(zc.a.Xhd,96)}De(){}Mwk(f,x,N){if(this.pa.xs()||
this.pa.W8())return 16;f=this.pa.Xd();if(!this.Ea.n_(f,!0).length&&!this.pa.Hka())return 16;if(1===N)return 32;this.AUg&&Vc.a.J(25040911,820,50,"Setting Paragraph properties from: {0}, IsDialogLancherButton: {1}",this.ia.wq,"PptRibbon.Home"===this.ia.Ora);Array.clear(this.kqe);this.ia.processAction(zc.a.Xhd,2);return(N=nb.APropertySet.y$i(this.kqe))?((new Lg(N,this.ia,this.dB)).kpd(),32):16}Zui(f,x,N,ea,ma){if(1===N)return 32;if(!(ma&&ma.hWc&&ma.Q0c&&ma.rLe))return 16;x=this.pa.sk();this.dB.tBj();
N=this.Jb.le(15);try{N.nc(x),N.jd=f,ma.hWc.equals(ma.Q0c)||this.zti(),Ic.VEk(ma.hWc,ma.Q0c,new Id(ma.rLe.value))}finally{N&&N.dispose()}if(this.AUg){let Ha;({HKh:f,IKh:ma,KKh:x,JKh:N,GKh:ea,LKh:Ha}=this.dB.Mol());Vc.a.J(25040909,820,50,"IsJustificationChanged: {0}, IsLnSpacChanged: {1}, IsSpaceBeforeChanged: {2}, IsSpaceAfterChanged: {3}, IsIndentLeftChanged: {4}, IsSpecialIndentChanged: {5}",f,ma,x,N,ea,Ha)}Af.a.kP(!0,!0);return 32}Lej(f,x,N){if(1===N)return 32;x=x.node;f=new ae.DictionaryPropertySet;
f.setValue(Hd.a.eE,this.Hh.BN(x));N=this.Eea.JSa(x);f.setValue(Hd.a.gX,N.Vf);f.setValue(Hd.a.ox,N.value);N=this.Eea.JW(x);f.setValue(Hd.a.cHb,N.beforeSpacing.Vf);f.setValue(Hd.a.dHb,N.beforeSpacing.value);f.setValue(Hd.a.$Gb,N.afterSpacing.Vf);f.setValue(Hd.a.aHb,N.afterSpacing.value);N=this.X9.v8(x);f.setValue(Hd.a.XGb,1);f.setValue(Hd.a.YGb,N.MM);x=this.uHa.TSa(x);f.setValue(Hd.a.Yfa,x.specialIndentType);f.setValue(Hd.a.vMb,x.Vf);f.setValue(Hd.a.wMb,x.value);this.kqe.push(f);return 32}zti(){if(this.pa.bH()){var f=
this.pa.Xd();f=this.Ea.n_(f);for(const x of f)x.Rsa()}}}Object(k.a)(Fg,"ParagraphDialogActor",null,[227]);var dg;(function(f){f[f.unspecified=-1]="unspecified";f[f.none=0]="none";f[f.left=1]="left";f[f.center=2]="center";f[f.right=3]="right";f[f.inner=4]="inner";f[f.outer=5]="outer";f[f.both=6]="both";f[f.distribute=7]="distribute";f[f.margin=8]="margin";f[f.highKashida=9]="highKashida";f[f.lowKashida=10]="lowKashida";f[f.mediumKashida=11]="mediumKashida";f[f.numTab=12]="numTab";f[f.thaiDistribute=
13]="thaiDistribute";f[f.start=14]="start";f[f.end=15]="end"})(dg||(dg={}));Object(k.b)("Justification",dg);var hi=d(572);class Mg{constructor(){this.value=this.Vf=0}}Object(k.a)(Mg,"ParagraphSpacingCommandData",null,[]);class ne{constructor(){this.Uwh=this.p8g=this.s8g=this.u8g=!1}}Object(k.a)(ne,"PptPropertySetChangedState",null,[]);class Bh{constructor(f){this.Cke=this.Iie=this.Ake=this.Bke=this.Wie=this.Pie=!1;this.lec={};this.ia=f;this.zBj()}rWj(f,x,N){N&&(f=this.lec[dg[N]],void 0!==f&&null!==
f&&(this.ia.processAction(f,2),this.Pie=!0))}pYj(f,x,N){void 0!==N&&null!==N&&(this.ia.La(zc.a.una,2,N),this.Wie=!0)}t8g(f,x,N,ea){void 0!==N&&null!==N&&(f=Bh.CQc(ea),!f.u8g&&null!==ea&&ea.lQ.Sa(Hd.a.cHb)&&ea.lQ.Sa(Hd.a.dHb)&&(x=ea.lQ.eb(Hd.a.dHb),ea=ea.lQ.eb(Hd.a.cHb),f.u8g=!0,this.ia.La(zc.a.zjb,2,Object.assign(new Mg,{value:x,Vf:ea})),this.Bke=!0))}r8g(f,x,N,ea){void 0!==N&&null!==N&&(f=Bh.CQc(ea),!f.s8g&&null!==ea&&ea.lQ.Sa(Hd.a.$Gb)&&ea.lQ.Sa(Hd.a.aHb)&&(x=ea.lQ.eb(Hd.a.aHb),ea=ea.lQ.eb(Hd.a.$Gb),
f.s8g=!0,this.ia.La(zc.a.yjb,2,Object.assign(new Mg,{value:x,Vf:ea})),this.Ake=!0))}o8g(f,x,N,ea){void 0!==N&&null!==N&&(x=Bh.CQc(ea),!x.p8g&&null!==ea&&ea.lQ.Sa(Hd.a.XGb)&&ea.lQ.Sa(Hd.a.YGb)&&(f=ea.lQ.eb(Hd.a.YGb),ea=ea.lQ.eb(Hd.a.XGb),x.p8g=!0,x=new hi.a,x.Vf=ea,x.value=f,this.ia.La(zc.a.mka,2,x),this.Iie=!0))}UXe(f,x,N,ea){void 0!==N&&null!==N&&(N=Bh.CQc(ea),!N.Uwh&&null!==ea&&ea.lQ.Sa(Hd.a.vMb)&&ea.lQ.Sa(Hd.a.wMb)&&(x=0,ea.lQ.Sa(Hd.a.Yfa)&&(x=ea.lQ.eb(Hd.a.Yfa)),f=ea.lQ.eb(Hd.a.wMb),ea=ea.lQ.eb(Hd.a.vMb),
N.Uwh=!0,N=0,1===x?N=zc.a.rLb:2===x?N=zc.a.tLb:0===x&&(N=zc.a.vLb),x=new hi.a,x.Vf=ea,x.value=f,this.ia.La(N,2,x),this.Cke=!0))}Mol(){return{HKh:this.Pie,IKh:this.Wie,KKh:this.Bke,JKh:this.Ake,GKh:this.Iie,LKh:this.Cke}}tBj(){this.Cke=this.Iie=this.Ake=this.Bke=this.Wie=this.Pie=!1}zBj(){this.lec.left=ce.a.leftJustify;this.lec.center=ce.a.centerJustify;this.lec.right=ce.a.rightJustify;this.lec.both=ce.a.fullJustify}static CQc(f){f.customData||(f.customData=new ne);return f.customData}}Object(k.a)(Bh,
"ParagraphLevelPropertyChangedHandlers",null,[1008]);var Vh=d(527),ij=d(199),Ij=d(268),Yj=d(344),ii=d(38),Wh=d(49),Zj=d(82),Hi=d(159);class $i{constructor(f,x){this.Gub=f;this.Gh=x}}Object(k.a)($i,"DoNotCheckCritiqueTypeActionData",null,[]);var Ai=d(22);class si{B6a(f){return(f=Object(C.a)($i,f))?Object(Ai.a)(Yj.a,f.Gh):!1}bHe(f,x){if(x=Object(C.a)($i,x)){const N=x.Gh;N&&(N.JLa(f,x.Gub),e.ULS.sendTraceTag(37855319,375,50,"Don't check this critique for whole doc finished, removed errors count: {0}",
x.Gub))}}}Object(k.a)(si,"DoNotCheckCritiqueTypeCallback",null,[1153]);var Ni=d(461),ak=d(48);class Sj extends Ni.a{constructor(f,x,N,ea,ma,Ha,Ua){super();this.dBe=null;this.init(f);this.Nl("WholePresentationOperation");this.AEa(J.AFrameworkApplication.Ta,x,N,ea,ma);this.Qdb=0;this.NWg=Ua;this.jxg=Ha;this.SFa=ma;this.Oac=x;this.B6a()?1===this.behavior&&(this.Ep=32,this.EY()):(this.Ep=8,this.EY())}run(){0===this.Qdb&&this.YUe();1===this.Qdb&&this.aLe();2===this.Qdb&&this.XZe();3===this.Qdb&&this.s2d()}B6a(){return this.NWg.B6a(this.SFa)}bHe(){this.NWg.bHe(this.Oac,
this.SFa)}YUe(){this.dBe=new ak.GraphTransaction(3);this.dBe.nc(this.jxg.node);this.Qdb=1}aLe(){this.Oy||this.ijb(this.jxg.xE);1!==this.Ana()&&(this.Qdb=2)}XZe(){this.bHe();this.dBe.dispose();this.Qdb=3}s2d(){this.EY()}}Object(k.a)(Sj,"WholePresentationOperation",Ni.a,[]);var ti=d(50);class Ii{constructor(f,x,N,ea,ma,Ha,Ua,mb,gb,Cb,zb,Pb){this.uEa=!1;this.ia=f;this.npg=x;this.XF=N;this.Jb=ea;this.P2c=ma;this.ua=Ha;this.Ea=Ua;this.f$=zb;this.awe=mb;this.FC=gb;this.ob=Pb;this.i$c=Cb.fsh;this.H8j=Cb.pptProofingRemoveWholeDocTargetCritiquesEnabled;
this.g8j=Cb.pptHideProofingErrorIsEnabled;this.dDj()}get W0b(){return this.XF.AUa?this.P2c.instance:null}vb(){this.ia.ra(zc.a.sIb,ti.a.application,Object(v.a)(this,this.sIb,"queryLanguage"),96);this.ia.ra(zc.a.Afd,ti.a.application,Object(v.a)(this,this.lvk,"openPPTLanguageDialogView"),4);this.XF.Sgg&&this.ia.ra(ce.a.NVc,jc.a.Of,Object(v.a)(this,this.NVc,"ignoreProofingError"),4);this.XF.Phe&&(this.H8j?(this.ia.ya(ce.a.eub,jc.a.paragraph,Object(v.a)(this,this.uNf,"doNotCheckThisCritiqueTypeForNode")),
this.ia.ya(ce.a.eub,jc.a.section,Object(v.a)(this,this.uNf,"doNotCheckThisCritiqueTypeForNode")),this.ia.WV(ce.a.eub,jc.a.Of,Object(v.a)(this,this.TMi,"doNotCheckThisCritiqueTypeForWholeDoc"),4),this.ia.ra(zc.a.O1b,jc.a.Of,Object(v.a)(this,this.O1b,"doNotCheckThisCritiqueTypeForCurrentSlide"),4)):this.ia.ra(ce.a.eub,jc.a.Of,Object(v.a)(this,this.O1b,"doNotCheckThisCritiqueTypeForCurrentSlide"),4));this.g8j&&(this.ia.ra(zc.a.Ohd,ti.a.application,Object(v.a)(this,this.Ohd,"queryHideProofingErrors"),
100),this.ia.ra(zc.a.W$f,ti.a.application,Object(v.a)(this,this.Lql,"toggleHideProofingErrors"),4))}De(){}dDj(){this.uEa=Ii.ebe;e.ULS.sendTraceTag(37237070,375,50,"Initialized with hide proofing errors: {0}",this.uEa);this.uEa&&this.T$f(this.uEa)}Ohd(f,x,N,ea,ma){if(1===N)return 32;if(!ma)return 8;ma[Vh.a.On]=this.uEa;return 32}Lql(f,x,N,ea,ma){if(1===N)return 32;if(!(ma&&Vh.a.On in ma))return 8;this.uEa=ma[Vh.a.On];Ii.ebe=this.uEa;this.T$f(this.uEa);e.ULS.sendTraceTag(37237071,375,50,"User hide proofing errors: {0}",
this.uEa);return 32}uNf(f,x,N,ea,ma){if(!x)return 8;f=x.node;if(!f)return 8;if(x.contextId===jc.a.section&&!f.sa(Hi.a.$fg,!1))return 32;if(x.contextId===jc.a.paragraph&&f.sa(Hi.a.Cda,!1)){x=Object(C.a)($i,ma);if(!x)return 8;ma=x.Gh;if(!ma)return 8;x.Gub+=this.fhh(f,ma.typeId,ma.lcid)}return 2}TMi(f,x,N,ea,ma){var Ha=this.X5i();Ha=new $i(0,Ha);this.ia.mi(N,zc.a.O1b,ea,!1,ma,Ha);N=Wh.a.create(Object(C.a)(Zj.a,this.ua.presentation));e.ULS.sendTraceTag(37012126,375,50,"User click do not check this critique for whole doc with behavior: {0}",
ea);return new Sj(f,x,ea,ma,Ha,N,new si)}O1b(f,x,N,ea,ma){f=Object(C.a)($i,ma);if(!f)return 8;ea=f.Gh;if(!ea)return 8;if(1===N)return 32;if(!x.node)return 8;e.ULS.sendTraceTag(36790874,375,50,"Don't check this critique triggerred, language id: {0}, critique type id: {1}",ea.lcid,ea.typeId);f.Gub+=this.ySk(ea.typeId,ea.lcid);this.W0b&&this.W0b.CLi(ea.lcid.toString(),ea.typeId);return 32}NVc(f,x,N){if(1===N)return 32;e.ULS.sendTraceTag(36790875,375,50,"Ignore proofing error triggerred");N=this.FC.vSa(x);
if(!N||!N.Gh)return 8;x=x.node;var ea=this.ua.Ba;if(!x||!ea)return 8;ea=this.Jb.le(Ii.Blj(N));try{ea.nc(x),this.FC.YJa(x,[N],!0),x.setValue(ii.a.NFf,!0)}finally{ea&&ea.dispose()}N.Gh.JLa(f,1);this.ob.JUa()||Af.a.kP(!0,!1);e.ULS.sendTraceTag(36790876,375,50,"Ignore proofing error action succeeded");return 32}T$f(f){this.f$.MVe=f}X5i(){var f=this.ob.Pa.mb;if(!f)return null;f=this.FC.vSa(f.Ua);if(!f||!f.Gh)return null;f=Object(C.a)(Yj.a,f.Gh);return!f||0>=f.lcid?null:f}ySk(f,x){const N=new Date;if(!this.ua.Ba)return 0;
const ea=this.ua.Ba.Pk();if(!ea)return 0;let ma=0,Ha=0;const Ua=this.Jb.le(3);try{Ua.nc(this.ua.Ba);for(const mb of ea)this.Ea.DJ(mb,gb=>{++Ha;gb.Sa(ii.a.pq)&&gb.sa(Hi.a.Cda,!1)&&(ma+=this.fhh(gb,f,x))})}finally{Ua&&Ua.dispose()}e.ULS.sendTraceTag(36825112,375,50,"Remove proofing error take time(ms): {0}, scanned paragraph count: {1}, scanned shape count: {2}, removed errors count: {3}",+new Date-+N,Ha,ea.length,ma);return ma}fhh(f,x,N){const ea=this.FC.BF(f,ma=>{ma=Object(C.a)(Yj.a,ma.Gh);return!!ma&&
ma.typeId===x&&ma.lcid===N});if(ij.a.Wa(ea))return 0;this.FC.YJa(f,ea);return ea.length}sIb(f,x,N,ea,ma){ma.GHc=this.W$i();return 32}W$i(){let f=J.AFrameworkApplication.lcid;if(this.ob.F_(this.ob.Pa)){var x=this.ob.Xd();if(1<x.length||1!==x.length)return"";x=this.Ea.BSa(x[0]);0<x&&(f=x)}else this.ob.Pa.mb&&(x=this.awe.iSc(this.ob.Qj),0<x&&(f=x));return Ij.a.ue(f)?Ij.a.ue(f).displayName:Ij.a.ue(J.AFrameworkApplication.lcid).displayName}DSj(){const f=this.ob.Xd();return 1===f.length&&f[0].HZc}lvk(f,
x,N){if(2!==N)return 32;this.i$c&&this.ob.F_(this.ob.Pa)&&this.DSj()?(e.ULS.sendTraceTag(8955537,806,50,"Set proofing language on shape level."),this.npg.value.getInstance(!0).Fqc()):this.ob.Pa.mb&&(e.ULS.sendTraceTag(8955536,806,50,"Set proofing language in text edit view."),this.npg.value.getInstance(!1).Fqc());return 32}static get ebe(){const f=Qa.a.get("PowerPointHideProofingErrors");return f?"true"===f.toLowerCase():!1}static set ebe(f){Qa.a.SJ("PowerPointHideProofingErrors",f.toString(),30)||
e.ULS.sendTraceTag(37237069,375,10,"Failed to set cookie for hide proofing errors to {0}",f.toString())}static Blj(f){return 1===f.Gh.proofingType?15:3}}Object(k.a)(Ii,"ProofingActor",null,[227]);var bg=d(271),xa=d(578);class Ma{constructor(f,x){this.Ne=f.toLowerCase();this.variant=x}}Object(k.a)(Ma,"ThemeVariant",null,[]);var $a=d(37);class Eb{constructor(f,x,N){this.z1d=f;this.NEh=x;this.T3e=N}}Object(k.a)(Eb,"ThemeData",null,[]);class ac{}ac.hLa=[new Eb("62f939b6-93af-4db8-9c6b-d6c7dfdc589f","OfficeTheme",
4),new Eb("b8441adb-2e43-4af7-b97a-bd870242c6a8","Ion",4),new Eb("28cdc826-8792-45c0-861b-85eb3adeda33","Organic",4),new Eb("f226e7a2-7162-461c-9490-d27d9dc04e43","Frame",4),new Eb("fc33163d-4339-46b1-8eed-24c834239d99","IonBoardroom",4),new Eb("789ec3fe-34fd-429c-9918-760025e6c145","Mesh",4),new Eb("5f128b03-dcca-4eeb-ab3b-cf2899314a46","Retrospect",8),new Eb("0507925b-6ac9-4358-8e18-c330545d08f8","Slice",4),new Eb("1306e473-ed32-493b-a2d0-240a757edd34","Savon",4),new Eb("98dff888-2449-4d28-977c-6306c017633e",
"Banded",4),new Eb("39ec5628-30ed-4578-acd8-9820edb8e15a","Quotable",4),new Eb("7acabc62-bf99-48cf-a9dc-4db89c7b13dc","WoodType",4),new Eb("5665723a-49ba-4b57-8411-a56f8f207965","Basis",4),new Eb("3577f8c9-a904-41d8-97d2-fd898f53f20e","Integral",8),new Eb("7cb32d59-10c0-40dd-b7bd-2e94284a981c","Wisp",4),new Eb("9697a71b-4ab7-4a1a-bd5b-bb2d22835b57","Dividend",4),new Eb("c4bb2a3d-0e93-4c5f-b0d2-9d3fce089cc5","Celestial",4),new Eb("3388167b-a2eb-4685-9635-1831d9aef8c4","Parallax",4),new Eb("4c5440d6-04d2-4954-96cf-f251137069b2",
"Metropolitan",8),new Eb("c0c680cd-088a-49fc-a102-d699147f32b2","Facet",4),new Eb("ba0eb5a6-f2d4-4f82-977b-64adee4a2a69","View",4),new Eb("5156b0e4-0eb1-49fe-a26b-15f6f698aec6","Atlas",4),new Eb("025cb5fb-2dd3-45ee-b6f0-cc461540eb19","Madison",4)];Object(k.a)(ac,"DesignManager_data",null,[]);class tc{constructor(f,x,N,ea,ma,Ha,Ua,mb,gb,Cb,zb,Pb){this.x3c=null;this.y3c=0;this.nvg=this.w3c=!1;this.$Dg=null;this.pZb=new Ma("",0);this.fVg={["ThemesOfficeTheme"]:"62f939b6-93af-4db8-9c6b-d6c7dfdc589f",
["ThemesIon"]:"b8441adb-2e43-4af7-b97a-bd870242c6a8",["ThemesAtlas"]:"5156b0e4-0eb1-49fe-a26b-15f6f698aec6",["ThemesMadison"]:"025cb5fb-2dd3-45ee-b6f0-cc461540eb19",["ThemesOrganic"]:"28cdc826-8792-45c0-861b-85eb3adeda33",["ThemesFrame"]:"f226e7a2-7162-461c-9490-d27d9dc04e43",["ThemesIonBoardroom"]:"fc33163d-4339-46b1-8eed-24c834239d99",["ThemesMesh"]:"789ec3fe-34fd-429c-9918-760025e6c145",["ThemesRetrospect"]:"5f128b03-dcca-4eeb-ab3b-cf2899314a46",["ThemesSlice"]:"0507925b-6ac9-4358-8e18-c330545d08f8",
["ThemesSavon"]:"1306e473-ed32-493b-a2d0-240a757edd34",["ThemesBanded"]:"98dff888-2449-4d28-977c-6306c017633e",["ThemesQuotable"]:"39ec5628-30ed-4578-acd8-9820edb8e15a",["ThemesWoodType"]:"7acabc62-bf99-48cf-a9dc-4db89c7b13dc",["ThemesBasis"]:"5665723a-49ba-4b57-8411-a56f8f207965",["ThemesIntegral"]:"3577f8c9-a904-41d8-97d2-fd898f53f20e",["ThemesWisp"]:"7cb32d59-10c0-40dd-b7bd-2e94284a981c",["ThemesDividend"]:"9697a71b-4ab7-4a1a-bd5b-bb2d22835b57",["ThemesCelestial"]:"c4bb2a3d-0e93-4c5f-b0d2-9d3fce089cc5",
["ThemesParallax"]:"3388167b-a2eb-4685-9635-1831d9aef8c4",["ThemesMetropolitan"]:"4c5440d6-04d2-4954-96cf-f251137069b2",["ThemesFacet"]:"c0c680cd-088a-49fc-a102-d699147f32b2",["ThemesViewTheme"]:"ba0eb5a6-f2d4-4f82-977b-64adee4a2a69"};this.ia=f;this.Fa=x;this.fc=N;this.pa=ma;this.Jb=ea;this.Vb=Ua;this.ua=mb;this.qc=gb;this.jdk=Cb;this.$5c=zb;this.mzg=Pb}vb(){this.ia.ra(zc.a.$v,ti.a.application,Object(v.a)(this,this.p9f,"handleThemeChange"),4);this.ia.ra(zc.a.YBa,ti.a.application,Object(v.a)(this,
this.p9f,"handleThemeChange"),4);this.ia.ra(zc.a.Shd,ti.a.application,Object(v.a)(this,this.Shd,"queryMoreThemeGallery"),96);this.ia.ra(zc.a.bMe,ti.a.application,Object(v.a)(this,this.bMe,"queryMoreVariantGallery"),96);this.ia.ra(zc.a.rz,ti.a.application,Object(v.a)(this,this.rz,"queryThemes"),97);this.ia.ra(zc.a.Tmc,ti.a.application,Object(v.a)(this,this.Tmc,"queryThemeVariants"),97);this.ia.ra(zc.a.Wgd,ti.a.application,Object(v.a)(this,this.Wgd,"populateVariantGallery"),96)}De(){}rz(f,x,N,ea,ma){ma&&
ma.XU&&(f=this.fVg[ma.XU]===this.JDa().Ne,ma.zZa.Qf(f));return 32}Tmc(f,x,N,ea,ma){if(ma&&ma.XU){f=this.JDa();x=f.Ne;N=ma.XU;try{var Ha=Number.parseInvariant(N.substring(N.length-1,N.length))}catch(Ua){Ha=0}ma=ma.zZa;ma.Qf(f.variant===Ha);Ha=tc.VWf(N,Ha,x);ma.l3=Ha}return 32}Shd(f,x,N){if(x.contextId!==jc.a.application)return 2;f=this.pa.sk();var ea=this.JDa();x=tc.$5b(ea.Ne);ea=ea.variant-1;return this.fc.$c(f)?16:1!==N||(e.ULS.sendTraceTag(512499972,801,50,"ThemeActor.QueryMoreThemeGallery: Dropdown menu opened. CurrentTheme={0} CurrentVariant={1}",
x,ea),this.qc.Lj())?32:8}bMe(f,x,N){if(x.contextId!==jc.a.application)return 2;var ea=this.pa.sk();x=this.JDa();f=tc.$5b(x.Ne);x=x.variant-1;if(this.fc.$c(ea))return 16;if(1===N)if(N=tc.e6b(this.JDa().Ne),ea=this.jdk.BVj(N),N&&ea)e.ULS.sendTraceTag(512499971,801,50,"ThemeActor.QueryMoreVariantGallery: Dropdown menu opened. CurrentTheme={0} CurrentVariant={1}",f,x);else return 16;return 32}p9f(f,x,N,ea,ma){x=this.pa.We();ea=this.ua.Ba;if(!ea||f===zc.a.YBa&&this.JDa()===this.pZb||this.fc.$c(ea))return 16;
if(1===N)return 32;N=Object(C.a)(String,ma);if(null===N)return 8;ma=this.fVg[N];return f===zc.a.$v?this.tzk(ea,ma,x):f===zc.a.YBa?this.uzk(ea,N):8}tzk(f,x,N){if(!f)return 16;1>=this.YGf()||this.mzg&&N&&1<N.length?(this.TPd(f,x,0,!1,N),e.ULS.sendTraceTag(512499968,801,50,"ThemeActor.PerformChangeTheme: ThemeName={0} SelectedVariant={1} SlideId.Sid={2}",tc.$5b(x),0,f.Cb.sid)):(this.x3c=x,this.y3c=0,this.w3c=!1,f=new Mb.StandardDialog,f.xd=1,f.cP(ResourceStrings.l_GenericDialogTitle,ResourceStrings.l_MultipleMainMastersMessage,
Object(v.a)(this,this.ZBf,"changeThemeHandler")));return 32}uzk(f,x){if(!f)return 16;const N=this.JDa();let ea;try{if(ea=Number.parseInvariant(x.substring(7,x.length))-1,0>ea||ea>tc.e6b(N.Ne))ea=-1}catch(ma){ea=-1}1>=this.YGf()?(this.TPd(f,N.Ne,ea,!0,null),e.ULS.sendTraceTag(512499939,801,50,"ThemeActor.PerformChangeVariant: ThemeName={0} SelectedVariant={1} SlideId.Sid={2}",tc.$5b(N.Ne),ea,f.Cb.sid)):(this.x3c=N.Ne,this.y3c=ea,this.w3c=!0,f=new Mb.StandardDialog,f.xd=1,f.cP(ResourceStrings.l_GenericDialogTitle,
ResourceStrings.l_MultipleMainMastersMessage,Object(v.a)(this,this.ZBf,"changeThemeHandler")));return 32}JDa(){let f=null;var x=this.ua.Ba;if(x){x=x.hj;const ea=this.qc.xI();if(ea&&x)for(var N of ea)if(N.Id===x){f=N;break}}if(!f)return this.nvg?this.$Dg:this.pZb;if(!f.ThemeFamilyId||f.ThemeFamilyId===tc.Zli)return this.pZb;N="5156b0e4-0eb1-49fe-a26b-15f6f698aec6"===f.ThemeFamilyId||"025cb5fb-2dd3-45ee-b6f0-cc461540eb19"===f.ThemeFamilyId;return!this.$5c&&N?this.pZb:new Ma(f.ThemeFamilyId,f.VariantIndex+
1)}YGf(){const f=this.qc.xI();let x=0;if(f)for(const N of f)N.InContent&&(x+=1);return x}ZBf(f){const x=this.ua.Ba;if(x){var N=this.x3c,ea=this.y3c,ma=this.w3c;this.x3c=null;this.y3c=-1;this.w3c=!1;1===f&&(this.TPd(x,N,ea,ma,null),e.ULS.sendTraceTag(512499936,801,50,"ThemeActor.ChangeThemeHandler: ThemeName={0} SelectedVariant={1} SlideId.Sid={2}",tc.$5b(N),ea,x.Cb.sid))}}TPd(f,x,N,ea,ma){this.$Dg=(this.nvg=ea)?new Ma(x,0):this.pZb;const Ha=this.Jb.zd(15,void 0,()=>{this.Fa.Ed();this.pa.Qh()},void 0,
!0);try{if(Ha.nc(f),Ha.jd=ea?zc.a.YBa:zc.a.$v,this.mzg&&ma)for(const Ua of ma)Ua.setValue($a.a.L_e,x),Ua.setValue($a.a.Oaa,N),Ua.setValue($a.a.fei,1<ma.length);else f.setValue($a.a.L_e,x),f.setValue($a.a.Oaa,N)}finally{Ha&&Ha.dispose()}this.fc.WYb(this.Vb.Cf,f,"ChangeTheme")}Wgd(f,x,N,ea,ma){if(1===N)return 32;f=Math.max(tc.e6b(this.JDa().Ne),4);x=this.JDa().Ne;ma.MenuItems=tc.kfj(f,x);return 32}static e6b(f){for(let x=0;x<ac.hLa.length;++x)if(ac.hLa[x].z1d===f)return ac.hLa[x].T3e;return 0}static $5b(f){for(let x=
0;x<ac.hLa.length;++x)if(ac.hLa[x].z1d===f)return ac.hLa[x].NEh;return tc.xmi}static PUi(f){let x="";for(let N=0;N<ac.hLa.length;++N)ac.hLa[N].z1d===f&&(x=ac.hLa[N].NEh.replace(" ",""));return x}static kfj(f,x){const N=Object.assign(new He.a,{Id:"PptRibbon.Design.ThemeVariants.Anchor.Menu",MenuSectionList:[]});var ea=Object.assign(new bg.a,{Id:"PptRibbon.Design.ThemeVariants.MenuSection",DisplayMode:"Size85by48",ControlList:[]});Array.add(N.MenuSectionList,ea);const ma=Object.assign(new xa.a,{Id:"PptRibbon.Design.ThemeVariants.Gallery",
ExternalId:"MoreVariantsSection",ExternalGalleryId:"MoreVariantsGallery",Type:4,Width:4,ElementDimensions:"Size85by48",GalleryItems:[]});Array.add(ea.ControlList,ma);for(ea=1;ea<=f;++ea)Array.add(ma.GalleryItems,tc.VWf("Variant"+ea,ea,x));return N}static VWf(f,x,N){N=!tc.e6b(N)||x>tc.e6b(N)?"EmptyVariantsGallery_85x48x8":String.format("ThemeVariantGallery{0}{1}_85x48x24",tc.PUi(N),x);return Object.assign(new Sg.a,{Id:f,ExternalId:f,Icon:N,Alt:String.format(ResourceStrings.L_ThemeVariantAlt,x),PreviewIconStyle:{root:{width:"49px",
height:"28px",margin:"-2px"}},FullIconStyle:{root:{width:"85px",height:"48px"}},Command:"2759977169",QueryCommand:"1425701611"})}}tc.Zli="00000000-0000-0000-0000-000000000000";tc.xmi="Unsupported Theme";Object(k.a)(tc,"ThemeActor",null,[227]);var aa=d(469);class sa{}sa.none=0;sa.cut=0;sa.random=1;sa.blinds=2;sa.CTd=3;sa.pCa=4;sa.dissolve=5;sa.fade=6;sa.QLa=7;sa.wNe=8;sa.Aud=9;sa.wipe=10;sa.bsh=11;sa.split=13;sa.Gal=17;sa.Lal=18;sa.wedge=19;sa.push=20;sa.wUd=21;sa.Stf=23;sa.wheel=26;sa.Zrh=27;sa.muc=
28;sa.bKb=29;sa.mEa=30;sa.noc=39;sa.sZe=42;sa.flip=43;sa.rM=44;sa.CEl=47;sa.u1d=48;sa.d_d=49;sa.QHi=50;sa.l4e=51;sa.iEk=52;sa.LZi=53;sa.fHi=54;sa.uIe=55;sa.Z7g=56;sa.QHe=57;sa.SOd=58;sa.DHe=59;sa.morph=60;sa.pan=36;sa.B3d=38;sa.KVd=37;sa.WZd=33;sa.window=34;sa.L3b=32;sa.zoom=31;sa.RFl=22;Object(k.a)(sa,"TransitionTypes",null,[]);class Oa{constructor(f,x,N,ea,ma,Ha,Ua,mb,gb,Cb,zb){this.ia=f;this.Vb=x;this.ua=N;this.pa=ma;this.Fa=Ha;this.Jb=ea;this.qn=Ua;this.fc=mb;this.dCg=gb.CPj;this.jn=gb.tC;this.g6c=
gb.GQj;this.wfc=Cb.pk(Md.a.sgd);this.Ola=gb.qT;this.Fb=zb}vb(){this.g6c?(this.dCg?(this.ia.ra(zc.a.Rj,jc.a.application,Object(v.a)(this,this.C9k,"setSlidesTransitionGalleryExceptExisting"),5),this.ia.ra(zc.a.yj,jc.a.application,Object(v.a)(this,this.GHk,"querySlidesTransitionGalleryExceptExisting"),97),this.ia.ra(zc.a.toa,jc.a.application,Object(v.a)(this,this.D9k,"setSlidesTransitionGalleryExisting"),5),this.ia.ra(zc.a.pya,jc.a.application,Object(v.a)(this,this.E9k,"setSlidesTransitionGalleryExistingInMenu"),
5),this.ia.ra(zc.a.Fna,jc.a.application,Object(v.a)(this,this.HHk,"querySlidesTransitionGalleryExisting"),97),this.ia.ra(zc.a.Dxa,jc.a.application,Object(v.a)(this,this.IHk,"querySlidesTransitionGalleryExistingInMenu"),97)):(this.ia.ra(zc.a.Rj,jc.a.application,Object(v.a)(this,this.qUe,"setSlidesTransitionGallery"),5),this.ia.ra(zc.a.yj,jc.a.application,Object(v.a)(this,this.sMe,"querySlidesTransitionGallery"),97),this.ia.ra(zc.a.toa,jc.a.application,Object(v.a)(this,this.qUe,"setSlidesTransitionGallery"),
5),this.ia.ra(zc.a.pya,jc.a.application,Object(v.a)(this,this.qUe,"setSlidesTransitionGallery"),5),this.ia.ra(zc.a.Fna,jc.a.application,Object(v.a)(this,this.sMe,"querySlidesTransitionGallery"),97),this.ia.ra(zc.a.Dxa,jc.a.application,Object(v.a)(this,this.sMe,"querySlidesTransitionGallery"),97)),this.ia.ra(zc.a.Kpc,jc.a.application,Object(v.a)(this,this.B9k,"setSlidesTransitionEffectOption"),5),this.ia.ra(zc.a.Qid,jc.a.application,Object(v.a)(this,this.EHk,"querySlidesTransitionEffectOption"),97),
this.ia.ra(zc.a.Mhb,jc.a.application,Object(v.a)(this,this.FHk,"querySlidesTransitionEffectOptionsAnchor"),100),this.ia.ra(zc.a.wHb,jc.a.application,Object(v.a)(this,this.mBk,"populateSlidesTransitionEffectOptions"),96),this.ia.ra(zc.a.Cxa,jc.a.application,Object(v.a)(this,this.DHk,"querySlidesTransitionDuration"),97),this.ia.ra(zc.a.Cjb,jc.a.application,Object(v.a)(this,this.A9k,"setSlidesTransitionDuration"),5)):(this.dCg?(this.ia.ra(zc.a.Rj,jc.a.application,Object(v.a)(this,this.u$k,"setTransitionGalleryExceptExisting"),
5),this.ia.ra(zc.a.yj,jc.a.application,Object(v.a)(this,this.YHk,"queryTransitionGalleryExceptExisting"),97),this.ia.ra(zc.a.toa,jc.a.application,Object(v.a)(this,this.v$k,"setTransitionGalleryExisting"),5),this.ia.ra(zc.a.pya,jc.a.application,Object(v.a)(this,this.w$k,"setTransitionGalleryExistingInMenu"),5),this.ia.ra(zc.a.Fna,jc.a.application,Object(v.a)(this,this.Fna,"queryTransitionGalleryExisting"),97),this.ia.ra(zc.a.Dxa,jc.a.application,Object(v.a)(this,this.Dxa,"queryTransitionGalleryExistingInMenu"),
97)):(this.ia.ra(zc.a.Rj,jc.a.application,Object(v.a)(this,this.EUe,"setTransitionGallery"),5),this.ia.ra(zc.a.yj,jc.a.application,Object(v.a)(this,this.yj,"queryTransitionGallery"),97),this.ia.ra(zc.a.toa,jc.a.application,Object(v.a)(this,this.EUe,"setTransitionGallery"),5),this.ia.ra(zc.a.pya,jc.a.application,Object(v.a)(this,this.EUe,"setTransitionGallery"),5),this.ia.ra(zc.a.Fna,jc.a.application,Object(v.a)(this,this.yj,"queryTransitionGallery"),97),this.ia.ra(zc.a.Dxa,jc.a.application,Object(v.a)(this,
this.yj,"queryTransitionGallery"),97)),this.ia.ra(zc.a.Kpc,jc.a.application,Object(v.a)(this,this.t$k,"setTransitionEffectOption"),5),this.ia.ra(zc.a.Qid,jc.a.application,Object(v.a)(this,this.XHk,"queryTransitionEffectOption"),97),this.ia.ra(zc.a.Mhb,jc.a.application,Object(v.a)(this,this.Mhb,"queryTransitionEffectOptionsAnchor"),100),this.ia.ra(zc.a.wHb,jc.a.application,Object(v.a)(this,this.wHb,"populateTransitionEffectOptions"),96),this.ia.ra(zc.a.Cxa,jc.a.application,Object(v.a)(this,this.Cxa,
"queryTransitionDuration"),97),this.ia.ra(zc.a.Cjb,jc.a.application,Object(v.a)(this,this.Cjb,"setTransitionDuration"),5));this.ia.ra(zc.a.Bjb,jc.a.application,Object(v.a)(this,this.Bjb,"setTransitionApplyAll"),4);this.ia.ra(zc.a.YIb,jc.a.application,Object(v.a)(this,this.YIb,"queryTransitionApplyAll"),96)}De(){}wHb(f,x,N,ea,ma){if(this.jn&&1!==this.pa.We().length)return 16;if(1===N)return 32;f=(f=this.ua.Ba)?f.eo:null;if(!f)return 16;if(!ma)return 8;f=this.qn.Wwb(f);f.next&&(ma.MenuItems=this.Myf(f));
return 32}yj(f,x,N,ea,ma){if(!ma)return 8;f=ma.queryResult;ma=ma.SourceControlId;x=this.qn.uQ(ma);if(!x)return 8;f.zDa=Oa.F3d(x.uc,x.oc,this.wfc);x=this.ua.Ba;if(!x)return 16;1===N&&((N=x.eo)?(N=this.qn.XSa(N),f.UU(!N&&"TransitionExisting"===ma||N===ma)):f.UU("TransitionNone"===ma));return 32}YHk(f,x,N,ea,ma){if(!ma||f!==zc.a.yj)return 8;f=ma.queryResult;ma=ma.SourceControlId;x=this.qn.uQ(ma);if(!x)return 8;ea=x.uc.split("_")[1]+"_24";x=Oa.dSa(ma,ma,ea,"2024601249","149145197",x.oc,x.oc);f.l3=x;x=
this.ua.Ba;if(!x)return 16;1===N&&((N=x.eo)?(N=this.qn.XSa(N),f.UU(N===ma)):f.UU("TransitionNone"===ma));return 32}Fna(f,x,N,ea,ma){if(!ma||f!==zc.a.Fna)return 8;f=ma.queryResult;ma=ma.SourceControlId;if(!ma||"TransitionExisting"!==ma)return 16;x=this.qn.uQ(ma);if(!x)return 8;ea=x.uc.split("_")[1]+"_24";x=Oa.dSa(ma,ma,ea,"3752636652","3476251476",x.oc,x.oc);f.l3=x;x=this.ua.Ba;if(!x)return 16;if(1===N&&(N=x.eo)){N=this.qn.XSa(N);x=this.qn.A_c(N,this.qn.iwb());if(N&&!x){ea=this.qn.uQ(N);if(!ea)return 8;
const Ha=ea.uc.split("_")[1]+"_24";ma=Oa.dSa(ma,ma,Ha,"3752636652","3476251476",ea.oc,ea.oc);f.l3=ma}f.UU(!N||!!N&&!x)}return 32}Dxa(f,x,N,ea,ma){if(!ma||f!==zc.a.Dxa)return 8;f=ma.queryResult;ma=ma.SourceControlId;if(!ma||"TransitionExistingInMenu"!==ma)return 16;x=this.qn.uQ(ma);if(!x)return 8;ea=x.uc.split("_")[1]+"_24";ma=Oa.dSa(ma,ma,ea,"4036532528","2831233208",x.oc,x.oc);f.l3=ma;ma=this.ua.Ba;if(!ma)return 16;1===N&&(N=ma.eo)&&(N=this.qn.XSa(N),f.UU(!N));return 32}Mhb(f,x,N){f=this.ua.Ba;if(!f)return 16;
f=this.qn.Wwb(f.eo);return!f||!f.next||this.jn&&1!==this.pa.We().length?16:1===N?32:8}EUe(f,x,N,ea,ma){if(!ma)return 8;x=ma.SourceControlId;ma=f===zc.a.toa||f===zc.a.pya;ea=this.ua.Ba;if(!ea||this.fc.$c(ea)||this.jn&&1!==this.pa.We().length)return 16;var Ha=ea.eo;const Ua=!!this.qn.WSa(Ha);if(ma&&(!Ha||Ua))return 16;if(1===N)return 32;Ha=this.qn.uQ(x);if(!Ha)return 8;if(!ma&&2===N&&x){Af.a.xk("SlideCount","1");N=this.Jb.zd(15,void 0,()=>{this.pa.ij();this.Fa.Ed()});try{N.nc(ea),N.jd=f,ea.eo=Ha.tc}finally{N&&
N.dispose()}e.ULS.sendTraceTag(512499935,801,50,"TransitionActor: Command=SetTransitionGallery, TransitionType={0}, TransitionEffectOption={1}, SlideId.Sid={2}",x,Ha.next||"null",ea.Cb.sid)}return 32}u$k(f,x,N,ea,ma){if(!ma)return 8;x=ma.SourceControlId;ea=this.ua.Ba;if(!ea)return 16;if(f!==zc.a.Rj)return 8;if(this.fc.$c(ea)||this.jn&&1!==this.pa.We().length)return 16;if(1===N)return 32;ma=this.qn.uQ(x);if(!ma)return 8;if(2===N&&x){Af.a.xk("SlideCount","1");N=this.Jb.zd(15,void 0,()=>{this.pa.ij();
this.Fa.Ed()});try{N.nc(ea),N.jd=f,ea.eo=ma.tc}finally{N&&N.dispose()}e.ULS.sendTraceTag(512499934,801,50,"TransitionActor: Command=SetTransitionGallery, TransitionType={0}, TransitionEffectOption={1}, SlideId.Sid={2}",x,ma.next||"null",ea.Cb.sid)}return 32}v$k(f,x,N,ea,ma){if(!ma)return 8;x=this.ua.Ba;if(!x)return 16;if(f!==zc.a.toa)return 8;if(this.jn&&1!==this.pa.We().length)return 16;if(1!==N)return 8;f=x.eo;N=!!this.qn.WSa(f);x=this.qn.Wwb(f);x=this.qn.A_c(x?x.parent:null,this.qn.iwb());return f&&
!N||!x?32:16}w$k(f,x,N,ea,ma){if(!ma)return 8;x=this.ua.Ba;if(!x)return 16;if(f!==zc.a.pya)return 8;if(this.jn&&1!==this.pa.We().length)return 16;if(1!==N)return 8;f=x.eo;N=!!this.qn.WSa(f);return!f||N?16:32}Bjb(f,x,N){x=this.ua.Ba;if(!x||this.fc.$c(x)||this.jn&&1!==this.pa.We().length)return 16;if(1===N)return 32;Af.a.xk("SlideCount","1");N=this.Vb.Cf;const ea=this.Jb.zd(15,void 0,()=>{this.pa.ij();this.Fa.Ed()});try{ea.nc(N),ea.jd=f,N.erb=x.Cb}finally{ea&&ea.dispose()}e.ULS.sendTraceTag(512499933,
801,50,"TransitionActor: Command=SetTransitionApplyAll");return 32}YIb(f,x,N,ea,ma){f=this.ua.Ba?!0:!1;if(!ma)return 8;ma=ma.queryResult;ma.zDa=Oa.F3d("pegal_TransitionNewsFlash_32x32x32",ResourceStrings.L_TransitionApplyAll,this.wfc);ma.UU(f);return f?32:16}t$k(f,x,N,ea,ma){if(!ma)return 8;x=ma.MenuItemId;if(this.jn&&1!==this.pa.We().length)return 16;if(1===N)return 32;N=this.ua.Ba;if(!N||this.fc.$c(N))return 16;ea=N?N.eo:null;ma=this.qn.uQ(x);if(!ea||!ma||!ma.tc)return 16;ea.TransitionType=ma.tc.TransitionType;
ea.Direction=ma.tc.Direction;ea.Duration=ma.tc.Duration;Af.a.xk("SlideCount","1");const Ha=this.Jb.zd(15,void 0,()=>{this.pa.ij();this.Fa.Ed()});try{Ha.nc(N),Ha.jd=f,N.eo=ea}finally{Ha&&Ha.dispose()}e.ULS.sendTraceTag(512499932,801,50,"TransitionActor: Command=SetTransitionEffectOption, TransitionType={0}, TransitionEffectOption={1}, SlideId.Sid={2}",ma.parent,x,N.Cb.sid);return 32}XHk(f,x,N,ea,ma){if(!ma)return 8;f=ma.queryResult;ma=ma.MenuItemId;x=this.ua.Ba;if(!x)return 16;1===N&&f.Qf(this.qn.WSa(x.eo)===
ma);return 32}Cxa(f,x,N,ea,ma){f=this.ua.Ba;if(!f)return 16;if(!ma)return 8;f=f.eo;if(ma=ma.queryResult)ma.uaa=f?(f.Duration/1E3).toString():"0";return 32}Cjb(f,x,N,ea,ma){x=this.ua.Ba;if(!x||this.fc.$c(x))return 16;if(!ma)return 8;if(this.jn&&1!==this.pa.We().length)return 16;ea=Math.floor(1E3*ma.Number);ma=x.eo;if(!ma)return 16;Af.a.Ib&&(Af.a.Ib.actionName="SetTransitionDuration");if(1===N)return"TransitionNone"===this.qn.XSa(ma)?16:32;if(2===N){ma.Duration=ea;const Ha=this.Fa.Be;Af.a.xk("SlideCount",
"1");N=this.Jb.zd(15,void 0,()=>{this.pa.ij();!Ha||Ha.name!==Zc.a.rg&&Ha.name!==Zc.a.uz||this.Fa.Ed()});try{N.nc(x),N.jd=f,x.eo=ma}finally{N&&N.dispose()}}return 32}mBk(f,x,N,ea,ma){if(1===N)return 32;if(!ma)return 8;x=this.pa.We();if(!x||!x.length)return 16;f=x[0].eo;if(!f)return 16;f=this.qn.Wwb(f);if(1<x.length)for(const Ha of x){x=Ha.eo;if(!x)return 16;x=this.qn.Wwb(x);if(f.parent!==x.parent)return 16}f.next&&(ma.MenuItems=this.Myf(f));return 32}sMe(f,x,N,ea,ma){if(!ma)return 8;f=ma.queryResult;
ma=ma.SourceControlId;x=this.qn.uQ(ma);if(!x)return 8;f.zDa=Oa.F3d(x.uc,x.oc,this.wfc);x=this.pa.We();if(!x||!x.length)return 16;1===N&&(N="",({Roa:N}=this.cRa(x)).returnValue&&f.UU(!N&&"TransitionExisting"===ma||N===ma));return 32}GHk(f,x,N,ea,ma){if(!ma||f!==zc.a.yj)return 8;f=ma.queryResult;ma=ma.SourceControlId;x=this.qn.uQ(ma);if(!x)return 8;ea=x.uc.split("_")[1]+"_24";x=Oa.dSa(ma,ma,ea,"2024601249","149145197",x.oc,x.oc);f.l3=x;x=this.pa.We();if(!x||!x.length)return 16;1===N&&(N="",({Roa:N}=
this.cRa(x)).returnValue&&f.UU(N===ma));return 32}HHk(f,x,N,ea,ma){if(!ma||f!==zc.a.Fna)return 8;f=ma.queryResult;ma=ma.SourceControlId;if(!ma||"TransitionExisting"!==ma)return 16;x=this.qn.uQ(ma);if(!x)return 8;ea=x.uc.split("_")[1]+"_24";x=Oa.dSa(ma,ma,ea,"3752636652","3476251476",x.oc,x.oc);f.l3=x;x=this.pa.We();if(!x||!x.length)return 16;if(1===N&&(N="",({Roa:N}=this.cRa(x)).returnValue)){x=this.qn.A_c(N,this.qn.iwb());if(N&&!x){ea=this.qn.uQ(N);if(!ea)return 8;const Ha=ea.uc.split("_")[1]+"_24";
ma=Oa.dSa(ma,ma,Ha,"3752636652","3476251476",ea.oc,ea.oc);f.l3=ma}f.UU(!N||!!N&&!x)}return 32}IHk(f,x,N,ea,ma){if(!ma||f!==zc.a.Dxa)return 8;f=ma.queryResult;ma=ma.SourceControlId;if(!ma||"TransitionExistingInMenu"!==ma)return 16;x=this.qn.uQ(ma);if(!x)return 8;ea=x.uc.split("_")[1]+"_24";ma=Oa.dSa(ma,ma,ea,"4036532528","2831233208",x.oc,x.oc);f.l3=ma;ma=this.pa.We();if(!ma||!ma.length)return 16;1===N&&(N="",({Roa:N}=this.cRa(ma)).returnValue&&f.UU(!N));return 32}FHk(f,x,N){f=this.pa.We();if(!f||
!f.length)return 16;x=this.qn.Wwb(f[0].eo);return!x||!x.next||1<f.length&&!this.cRa(f).returnValue?16:1===N?32:8}qUe(f,x,N,ea,ma){if(!ma)return 8;x=ma.SourceControlId;ma=f===zc.a.toa||f===zc.a.pya;ea=this.pa.We();if(!ea||!ea.length)return 16;for(var Ha of ea)if(this.fc.$c(Ha))return 16;Ha="";const Ua=({Roa:Ha}=this.cRa(ea)).returnValue;if(ma&&(!Ua||Ha))return 16;if(1===N)return 32;Ha=this.qn.uQ(x);if(!Ha)return 8;if(!ma&&2===N&&x){Af.a.xk("SlideCount",ea.length.toString());N=this.Jb.zd(15,void 0,
()=>{this.pa.ij();this.Fa.Ed()});try{N.nc(this.Vb.Cf);N.jd=f;for(const mb of ea)mb.eo=Ha.tc}finally{N&&N.dispose()}e.ULS.sendTraceTag(512499931,801,50,"TransitionActor: Command=SetTransitionGallery, TransitionType={0}, TransitionEffectOption={1}",x,Ha.next||"null")}return 32}Gdl(){if(!Object(Ud.a)("ToggleMorphTransitionToNoneForActionAi")||!this.Ola)return!1;const f=this.pa.We();let x=!0;for(const N of f)if(!N.eo||N.DXe!==sa.morph){x=!1;break}return x}C9k(f,x,N,ea,ma){if(!ma)return 8;x=ma.SourceControlId;
this.Gdl()&&(x="TransitionNone");if(f!==zc.a.Rj)return 8;ea=this.pa.We();if(!ea||!ea.length)return 16;for(var Ha of ea)if(this.fc.$c(Ha))return 16;if(1===N)return 32;Ha=this.qn.uQ(x);if(!Ha)return 8;if(2===N&&x){Af.a.xk("SlideCount",ea.length.toString());N=this.Jb.zd(15,void 0,()=>{this.pa.ij();this.Fa.Ed()},()=>{1===this.Fb.Sl&&this.Fa.Bj(Zc.a.QE,!0)});try{N.nc(this.Vb.Cf);N.jd=f;for(const Ua of ea)Ua.eo=Ha.tc}finally{N&&N.dispose()}e.ULS.sendTraceTag(512499930,801,50,"TransitionActor: Command=SetTransitionGallery, TransitionType={0}, TransitionEffectOption={1}",
x,Ha.next||"null")}return 32}D9k(f,x,N,ea,ma){if(!ma)return 8;x=this.pa.We();if(!x||!x.length)return 16;if(f!==zc.a.toa||1!==N)return 8;ea="";f=({Roa:ea}=this.cRa(x)).returnValue;N=!!ea;x=ea&&0<ea.length?this.qn.uQ(ea):null;x=this.qn.A_c(x?x.parent:null,this.qn.iwb());return!f||N&&x?16:32}E9k(f,x,N,ea,ma){if(!ma)return 8;x=this.pa.We();if(!x||!x.length)return 16;if(f!==zc.a.pya||1!==N)return 8;f="";return!({Roa:f}=this.cRa(x)).returnValue||f?16:32}B9k(f,x,N,ea,ma){if(!ma)return 8;x=ma.MenuItemId;
if(1===N)return 32;N=this.pa.We();if(!N||!N.length)return 16;for(var Ha of N)if(this.fc.$c(Ha)||!Ha.eo)return 16;Ha=this.qn.uQ(x);if(!Ha||!Ha.tc)return 16;Af.a.xk("SlideCount",N.length.toString());ea=this.Jb.zd(15,void 0,()=>{this.pa.ij();this.Fa.Ed()});try{ea.nc(this.Vb.Cf);ea.jd=f;for(const Ua of N){let mb=Ua.eo;mb.TransitionType=Ha.tc.TransitionType;mb.Direction=Ha.tc.Direction;mb.Duration=Ha.tc.Duration;Ua.eo=mb}}finally{ea&&ea.dispose()}e.ULS.sendTraceTag(512499929,801,50,"TransitionActor: Command=SetTransitionEffectOption, TransitionType={0}, TransitionEffectOption={1}",
Ha.parent,x);return 32}EHk(f,x,N,ea,ma){if(!ma)return 8;f=ma.queryResult;ma=ma.MenuItemId;x=this.pa.We();if(!x||!x.length)return 16;1===N&&(N="",({Roa:N}=this.aNi(x)).returnValue&&f.Qf(N===ma));return 32}DHk(f,x,N,ea,ma){if(!ma)return 8;f=this.pa.We();if(!f||!f.length)return 16;if(ma=ma.queryResult)f=Oa.Fij(f),ma.uaa=f;return 32}A9k(f,x,N,ea,ma){if(!ma)return 8;x=this.pa.We();if(!x||!x.length)return 16;for(const Ha of x)if(this.fc.$c(Ha))return 16;ma=Math.floor(1E3*ma.Number);for(const Ha of x)if(!Ha.eo)return 16;
Af.a.Ib&&(Af.a.Ib.actionName="SetTransitionDuration");if(1===N){for(const Ha of x)if("TransitionNone"===this.qn.XSa(Ha.eo))return 16;return 32}if(2===N){const Ha=this.Fa.Be;Af.a.xk("SlideCount",x.length.toString());N=this.Jb.zd(15,void 0,()=>{this.pa.ij();!Ha||Ha.name!==Zc.a.rg&&Ha.name!==Zc.a.uz||this.Fa.Ed()});try{N.nc(this.Vb.Cf);N.jd=f;for(const Ua of x){const mb=Ua.eo;mb.Duration=ma;Ua.eo=mb}}finally{N&&N.dispose()}}return 32}cRa(f){let x;x="";if(!f||!f.length)return{returnValue:!1,Roa:x};x=
this.qn.XSa(f[0].eo);let N=!0;if(1<f.length)for(const ea of f)if(f=this.qn.XSa(ea?ea.eo:null),x!==f){N=!1;break}N||(x="");return{returnValue:N,Roa:x}}aNi(f){let x;x="";if(!f||!f.length)return{returnValue:!1,Roa:x};x=this.qn.WSa(f[0].eo);let N=!0;if(1<f.length)for(const ea of f)if(f=this.qn.WSa(ea?ea.eo:null),x!==f){N=!1;break}N||(x="");return{returnValue:N,Roa:x}}Myf(f){const x=Object.assign(new He.a,{Id:"TransitionMenuEffectOptions",UpdateDynamically:!0,Title:ResourceStrings.L_TransitionEffectOptions,
MenuSectionList:[]}),N=Object.assign(new bg.a,{Id:"MenuSectionEffectOptions",ControlsId:"MenuSectionEffectOptions.Controls",DisplayMode:"Menu32",ControlList:[]});Array.add(x.MenuSectionList,N);let ea=null;for(f=({key:ea}=this.qn.U1f(f)).returnValue;f;)Array.add(N.ControlList,Object.assign(new aa.a,{Command:"961566706",Id:ea,ExternalId:"TransitionEffectOptions"+ea,QueryCommand:"3535869262"})),{key:ea,returnValue:f}=this.qn.U1f(f);return x}static Fij(f){let x;if(!f||!f.length)return"0";const N=f[0].eo;
x=N?(N.Duration/1E3).toString():"0";let ea=!0;if(1<f.length)for(const ma of f)if((f=ma?ma.eo:null)||N){if(!f&&N||f&&!N){ea=!1;break}if(x!==(f.Duration/1E3).toString()){ea=!1;break}}ea||(x="0");return x}static F3d(f,x,N){f=String.format('<SPAN class="cui-img-32by32 cui-img-cont-float" unselectable="on"><IMG class="{0}" src="{1}" unselectable="on"></SPAN>',f,N);x=String.format('<P class="cui-ctl-mediumlabel GalleryButtonLabel" unselectable="on">{0}</P>',x);return String.format('<DIV class="GalleryButtonWithLabel">{0}{1}</DIV>',
f,x)}static dSa(f,x,N,ea,ma,Ha,Ua){return Object.assign(new Sg.a,{Id:f,ExternalId:x,Icon:N,Command:ea,QueryCommand:ma,LabelText:Ha,FullIconStyle:{root:{width:"32px",height:"32px"}},PreviewIconStyle:{root:{width:"24px",height:"24px"}},Alt:Ua})}}Object(k.a)(Oa,"TransitionActor",null,[227]);var ib=d(1006);class Gb{constructor(){this.effectId=this.effectType=0;this.labelText=this.Qe=this.Dn=this.Rn=null}}Object(k.a)(Gb,"AnimInfo",null,[]);class Bb{constructor(){this.Fj=this.labelText=this.Qe=this.id=
null}}Object(k.a)(Bb,"EffectOption",null,[]);class Cc extends Bb{constructor(){super();this.value=null}}Object(k.a)(Cc,"EffectData",Bb,[]);class cc{constructor(f){this.yVa=f;cc.Fl||(cc.Fl=new ib.a,cc.Fl.add("FromBottom",Object.assign(new Bb,{id:"FromBottom",Qe:cc.ef("AnimEffectPropFromBottom"),labelText:ResourceStrings.L_EffectOptionsDirectionFromBottom,Fj:CommonUIStrings.l_AnimationFromBottomKeytip})),cc.Fl.add("FromBottomLeft",Object.assign(new Bb,{id:"FromBottomLeft",Qe:cc.ef("AnimEffectPropFromBottomLeft"),
labelText:ResourceStrings.L_EffectOptionsDirectionFromBottomLeft,Fj:CommonUIStrings.l_AnimationFromBottomLeftKeytip})),cc.Fl.add("FromLeft",Object.assign(new Bb,{id:"FromLeft",Qe:cc.ef("AnimEffectPropFromLeft"),labelText:ResourceStrings.L_EffectOptionsDirectionFromLeft,Fj:CommonUIStrings.l_AnimationFromLeftKeytip})),cc.Fl.add("FromTopLeft",Object.assign(new Bb,{id:"FromTopLeft",Qe:cc.ef("AnimEffectPropFromTopLeft"),labelText:ResourceStrings.L_EffectOptionsDirectionFromTopLeft,Fj:CommonUIStrings.l_AnimationFromTopLeftKeytip})),
cc.Fl.add("FromTop",Object.assign(new Bb,{id:"FromTop",Qe:cc.ef("AnimEffectPropFromTop"),labelText:ResourceStrings.L_EffectOptionsDirectionFromTop,Fj:CommonUIStrings.l_AnimationFromTopKeytip})),cc.Fl.add("FromTopRight",Object.assign(new Bb,{id:"FromTopRight",Qe:cc.ef("AnimEffectPropFromTopRight"),labelText:ResourceStrings.L_EffectOptionsDirectionFromTopRight,Fj:CommonUIStrings.l_AnimationFromTopRightKeytip})),cc.Fl.add("FromRight",Object.assign(new Bb,{id:"FromRight",Qe:cc.ef("AnimEffectPropFromRight"),
labelText:ResourceStrings.L_EffectOptionsDirectionFromRight,Fj:CommonUIStrings.l_AnimationFromRightKeytip})),cc.Fl.add("FromBottomRight",Object.assign(new Bb,{id:"FromBottomRight",Qe:cc.ef("AnimEffectPropFromBottomRight"),labelText:ResourceStrings.L_EffectOptionsDirectionFromBottomRight,Fj:CommonUIStrings.l_AnimationFromBottomRightKeytip})),cc.Fl.add("ToBottom",Object.assign(new Bb,{id:"ToBottom",Qe:cc.ef("AnimEffectPropFromTop"),labelText:ResourceStrings.L_EffectOptionsDirectionToBottom,Fj:CommonUIStrings.l_AnimationFromBottomKeytip})),
cc.Fl.add("ToBottomLeft",Object.assign(new Bb,{id:"ToBottomLeft",Qe:cc.ef("AnimEffectPropFromTopRight"),labelText:ResourceStrings.L_EffectOptionsDirectionToBottomLeft,Fj:CommonUIStrings.l_AnimationFromBottomLeftKeytip})),cc.Fl.add("ToLeft",Object.assign(new Bb,{id:"ToLeft",Qe:cc.ef("AnimEffectPropFromRight"),labelText:ResourceStrings.L_EffectOptionsDirectionToLeft,Fj:CommonUIStrings.l_AnimationFromLeftKeytip})),cc.Fl.add("ToTopLeft",Object.assign(new Bb,{id:"ToTopLeft",Qe:cc.ef("AnimEffectPropFromBottomRight"),
labelText:ResourceStrings.L_EffectOptionsDirectionToTopLeft,Fj:CommonUIStrings.l_AnimationFromTopLeftKeytip})),cc.Fl.add("ToTop",Object.assign(new Bb,{id:"ToTop",Qe:cc.ef("AnimEffectPropFromBottom"),labelText:ResourceStrings.L_EffectOptionsDirectionToTop,Fj:CommonUIStrings.l_AnimationFromTopKeytip})),cc.Fl.add("ToTopRight",Object.assign(new Bb,{id:"ToTopRight",Qe:cc.ef("AnimEffectPropFromBottomLeft"),labelText:ResourceStrings.L_EffectOptionsDirectionToTopRight,Fj:CommonUIStrings.l_AnimationFromTopRightKeytip})),
cc.Fl.add("ToRight",Object.assign(new Bb,{id:"ToRight",Qe:cc.ef("AnimEffectPropFromLeft"),labelText:ResourceStrings.L_EffectOptionsDirectionToRight,Fj:CommonUIStrings.l_AnimationFromRightKeytip})),cc.Fl.add("ToBottomRight",Object.assign(new Bb,{id:"ToBottomRight",Qe:cc.ef("AnimEffectPropFromTopLeft"),labelText:ResourceStrings.L_EffectOptionsDirectionToBottomRight,Fj:CommonUIStrings.l_AnimationFromBottomRightKeytip})),cc.Fl.add("Horizontal",Object.assign(new Bb,{id:"Horizontal",Qe:cc.ef("AnimEffectPropHorizontal"),
labelText:ResourceStrings.L_EffectOptionsDirectionHorizontal,Fj:CommonUIStrings.l_AnimationHorizontalKeytip})),cc.Fl.add("HorizontalIn",Object.assign(new Bb,{id:"HorizontalIn",Qe:cc.ef("AnimEffectPropHorizontalIn"),labelText:ResourceStrings.L_EffectOptionsDirectionHorizontalIn,Fj:CommonUIStrings.l_AnimationHorizontalInKeytip})),cc.Fl.add("HorizontalOut",Object.assign(new Bb,{id:"HorizontalOut",Qe:cc.ef("AnimEffectPropHorizontalOut"),labelText:ResourceStrings.L_EffectOptionsDirectionHorizontalOut,
Fj:CommonUIStrings.l_AnimationHorizontalOutKeytip})),cc.Fl.add("Vertical",Object.assign(new Bb,{id:"Vertical",Qe:cc.ef("AnimEffectPropVertical"),labelText:ResourceStrings.L_EffectOptionsDirectionVertical,Fj:CommonUIStrings.l_AnimationVerticalKeytip})),cc.Fl.add("VerticalIn",Object.assign(new Bb,{id:"VerticalIn",Qe:cc.ef("AnimEffectPropVerticalIn"),labelText:ResourceStrings.L_EffectOptionsDirectionVerticalIn,Fj:CommonUIStrings.l_AnimationVerticalInKeytip})),cc.Fl.add("VerticalOut",Object.assign(new Bb,
{id:"VerticalOut",Qe:cc.ef("AnimEffectPropVerticalOut"),labelText:ResourceStrings.L_EffectOptionsDirectionVerticalOut,Fj:CommonUIStrings.l_AnimationVerticalOutKeytip})),cc.Fl.add("LeftDown",Object.assign(new Bb,{id:"LeftDown",Qe:cc.ef("AnimEffectPropFromTopRight"),labelText:ResourceStrings.L_EffectOptionsDirectionLeftDown,Fj:CommonUIStrings.l_AnimationLeftDownKeytip})),cc.Fl.add("LeftUp",Object.assign(new Bb,{id:"LeftUp",Qe:cc.ef("AnimEffectPropFromBottomRight"),labelText:ResourceStrings.L_EffectOptionsDirectionLeftUp,
Fj:CommonUIStrings.l_AnimationLeftUpKeytip})),cc.Fl.add("RightDown",Object.assign(new Bb,{id:"RightDown",Qe:cc.ef("AnimEffectPropFromTopLeft"),labelText:ResourceStrings.L_EffectOptionsDirectionRightDown,Fj:CommonUIStrings.l_AnimationRightDownKeytip})),cc.Fl.add("RightUp",Object.assign(new Bb,{id:"RightUp",Qe:cc.ef("AnimEffectPropFromBottomLeft"),labelText:ResourceStrings.L_EffectOptionsDirectionRightUp,Fj:CommonUIStrings.l_AnimationRightUpKeytip})),cc.Fl.add("In",Object.assign(new Bb,{id:"In",Qe:cc.ef("AnimEffectPropIn"),
labelText:ResourceStrings.L_EffectOptionsDirectionIn,Fj:CommonUIStrings.l_AnimationInKeytip})),cc.Fl.add("InBottom",Object.assign(new Bb,{id:"InBottom",Qe:cc.ef("AnimEffectPropIn"),labelText:ResourceStrings.L_EffectOptionsDirectionInToScreenBottom,Fj:CommonUIStrings.l_AnimationInToScreenBottomKeytip})),cc.Fl.add("InCenter",Object.assign(new Bb,{id:"InCenter",Qe:cc.ef("AnimEffectPropIn"),labelText:ResourceStrings.L_EffectOptionsDirectionInCenter,Fj:CommonUIStrings.l_AnimationOutToScreenCenterKeytip})),
cc.Fl.add("InSlightly",Object.assign(new Bb,{id:"InSlightly",Qe:cc.ef("AnimEffectPropIn"),labelText:ResourceStrings.L_EffectOptionsDirectionInSlightly,Fj:CommonUIStrings.l_AnimationInSlightlyKeytip})),cc.Fl.add("Out",Object.assign(new Bb,{id:"Out",Qe:cc.ef("AnimEffectPropOut"),labelText:ResourceStrings.L_EffectOptionsDirectionOut,Fj:CommonUIStrings.l_AnimationOutKeytip})),cc.Fl.add("OutBottom",Object.assign(new Bb,{id:"OutBottom",Qe:cc.ef("AnimEffectPropOut"),labelText:ResourceStrings.L_EffectOptionsDirectionOutBottom,
Fj:CommonUIStrings.l_AnimationOutFromScreenBottomKeytip})),cc.Fl.add("OutCenter",Object.assign(new Bb,{id:"OutCenter",Qe:cc.ef("AnimEffectPropOut"),labelText:ResourceStrings.L_EffectOptionsDirectionOutToScreenCenter,Fj:CommonUIStrings.l_AnimationOutToScreenCenterKeytip})),cc.Fl.add("OutSlightly",Object.assign(new Bb,{id:"OutSlightly",Qe:cc.ef("AnimEffectPropOut"),labelText:ResourceStrings.L_EffectOptionsDirectionOutSlightly,Fj:CommonUIStrings.l_AnimationOutSlightlyKeytip})),cc.Fl.add("FloatUp",Object.assign(new Bb,
{id:"FloatUp",Qe:cc.ef("AnimEffectPropFloatUp"),labelText:ResourceStrings.L_EffectOptionsDirectionFloatUp,Fj:CommonUIStrings.l_AnimationOutKeytip})),cc.Fl.add("FloatDown",Object.assign(new Bb,{id:"FloatDown",Qe:cc.ef("AnimEffectPropFloatDown"),labelText:ResourceStrings.L_EffectOptionsDirectionFloatDown,Fj:CommonUIStrings.l_AnimationDownKeytip})),cc.Fl.add("ObjectCenter",Object.assign(new Bb,{id:"ObjectCenter",Qe:cc.ef("AnimEffectPropFadedZoomIn"),labelText:ResourceStrings.L_EffectOptionsDirectionObjectCenter,
Fj:CommonUIStrings.l_AnimationObjectCenterKeytip})),cc.Fl.add("SlideCenter",Object.assign(new Bb,{id:"SlideCenter",Qe:cc.ef("AnimEffectPropFadedZoomInFromCenter"),labelText:ResourceStrings.L_EffectOptionsDirectionSlideCenter,Fj:CommonUIStrings.l_AnimationSlideCenterKeytip})),cc.Fl.add("ObjectCenterOut",Object.assign(new Bb,{id:"ObjectCenterOut",Qe:cc.ef("AnimEffectPropFadedZoomIn"),labelText:ResourceStrings.L_EffectOptionsDirectionObjectCenter,Fj:CommonUIStrings.l_AnimationObjectCenterKeytip})),cc.Fl.add("SlideCenterOut",
Object.assign(new Bb,{id:"SlideCenterOut",Qe:cc.ef("AnimEffectPropFadedZoomInFromCenter"),labelText:ResourceStrings.L_EffectOptionsDirectionSlideCenter,Fj:CommonUIStrings.l_AnimationSlideCenterKeytip})),cc.Fl.add("Clockwise",Object.assign(new Bb,{id:"Clockwise",Qe:cc.ef("AnimEffectPropClockwise"),labelText:ResourceStrings.L_EffectOptionsDirectionClockwise,Fj:CommonUIStrings.l_AnimationClockWiseKeytip})),cc.Fl.add("CounterClockwise",Object.assign(new Bb,{id:"CounterClockwise",Qe:cc.ef("AnimEffectPropCounterclockwise"),
labelText:ResourceStrings.L_EffectOptionsDirectionCounterClockwise,Fj:CommonUIStrings.l_AnimationCounterClockWiseKeytip})),cc.Fl.add("Across",Object.assign(new Bb,{id:"Across",Qe:cc.ef("AnimEffectPropHorizontal"),labelText:ResourceStrings.L_EffectOptionsDirectionAcross,Fj:CommonUIStrings.l_AnimationAcrossKeytip})),cc.Fl.add("Up",Object.assign(new Bb,{id:"Up",Qe:cc.ef("AnimEffectPropVertical"),labelText:ResourceStrings.L_EffectOptionsDirectionUp,Fj:CommonUIStrings.l_AnimationUpKeytip})),cc.Fl.add("Down",
Object.assign(new Bb,{id:"Down",Qe:cc.ef("AnimEffectPropVertical"),labelText:ResourceStrings.L_EffectOptionsDirectionDown,Fj:CommonUIStrings.l_AnimationDownKeytip})),cc.Fl.add("GrowShrinkHorizontal",Object.assign(new Bb,{id:"GrowShrinkHorizontal",Qe:cc.ef("AnimEffectPropGrowShrinkHorizontal"),labelText:ResourceStrings.L_EffectOptionsDirectionHorizontal,Fj:CommonUIStrings.l_AnimationHorizontalKeytip})),cc.Fl.add("GrowShrinkVertical",Object.assign(new Bb,{id:"GrowShrinkVertical",Qe:cc.ef("AnimEffectPropGrowShrinkVertical"),
labelText:ResourceStrings.L_EffectOptionsDirectionVertical,Fj:CommonUIStrings.l_AnimationVerticalKeytip})),cc.Fl.add("GrowShrinkBoth",Object.assign(new Bb,{id:"GrowShrinkBoth",Qe:cc.ef("AnimEffectPropBoth"),labelText:ResourceStrings.L_EffectOptionsDirectionBoth,Fj:CommonUIStrings.l_AnimationBothKeytip})));cc.US||(cc.US=new ib.a,cc.US.add("Spin_Quarter",Object.assign(new Cc,{id:"Spin_Quarter",Qe:cc.ef("AnimEffectPropQuarterSpin"),labelText:ResourceStrings.L_EffectOptionsSpinQuarter,value:"90",Fj:CommonUIStrings.l_AnimationQuarterSpinKeytip})),
cc.US.add("Spin_Half",Object.assign(new Cc,{id:"Spin_Half",Qe:cc.ef("AnimEffectPropHalfSpin"),labelText:ResourceStrings.L_EffectOptionsSpinHalf,value:"180",Fj:CommonUIStrings.l_AnimationHalfSpinKeytip})),cc.US.add("Spin_Full",Object.assign(new Cc,{id:"Spin_Full",Qe:cc.ef("AnimEffectPropFullSpin"),labelText:ResourceStrings.L_EffectOptionsSpinFull,value:"360",Fj:CommonUIStrings.l_AnimationFullSpinKeytip})),cc.US.add("Spin_Two",Object.assign(new Cc,{id:"Spin_Two",Qe:cc.ef("AnimEffectPropTwoSpins"),labelText:ResourceStrings.L_EffectOptionsSpinTwo,
value:"720",Fj:CommonUIStrings.l_AnimationTwoSpinKeytip})),cc.US.add("Transparency_25",Object.assign(new Cc,{id:"Transparency_25",Qe:cc.ef("AnimEffectPropTransparent25"),labelText:ResourceStrings.L_EffectOptionsTransparency25Percent,value:"0.75",Fj:CommonUIStrings.l_Animation25PerKeytip})),cc.US.add("Transparency_50",Object.assign(new Cc,{id:"Transparency_50",Qe:cc.ef("AnimEffectPropTransparent50"),labelText:ResourceStrings.L_EffectOptionsTransparency50Percent,value:"0.5",Fj:CommonUIStrings.l_Animation50PerKeytip})),
cc.US.add("Transparency_75",Object.assign(new Cc,{id:"Transparency_75",Qe:cc.ef("AnimEffectPropTransparent75"),labelText:ResourceStrings.L_EffectOptionsTransparency75Percent,value:"0.25",Fj:CommonUIStrings.l_Animation75PerKeytip})),cc.US.add("Transparency_100",Object.assign(new Cc,{id:"Transparency_100",Qe:cc.ef("AnimEffectPropTransparent100"),labelText:ResourceStrings.L_EffectOptionsTransparency100Percent,value:"0.0",Fj:CommonUIStrings.l_Animation100PerKeytip})),cc.US.add("GrowShrink_Tiny",Object.assign(new Cc,
{id:"GrowShrink_Tiny",Qe:cc.ef("AnimEffectPropTiny"),labelText:ResourceStrings.L_EffectOptionsGrowShrinkTiny,value:"25",Fj:CommonUIStrings.l_AnimationTinyKeytip})),cc.US.add("GrowShrink_Smaller",Object.assign(new Cc,{id:"GrowShrink_Smaller",Qe:cc.ef("AnimEffectPropSmaller"),labelText:ResourceStrings.L_EffectOptionsGrowShrinkSmaller,value:"50",Fj:CommonUIStrings.l_AnimationSmallerKeytip})),cc.US.add("GrowShrink_Larger",Object.assign(new Cc,{id:"GrowShrink_Larger",Qe:cc.ef("AnimEffectPropLarger"),labelText:ResourceStrings.L_EffectOptionsGrowShrinkLarger,
value:"150",Fj:CommonUIStrings.l_AnimationLargerKeytip})),cc.US.add("GrowShrink_Huge",Object.assign(new Cc,{id:"GrowShrink_Huge",Qe:cc.ef("AnimEffectPropHuge"),labelText:ResourceStrings.L_EffectOptionsGrowShrinkHuge,value:"400",Fj:CommonUIStrings.l_AnimationHugeKeytip})));if(!cc.im)if(cc.im=new ib.a,cc.im.add("Existing",Object.assign(new Gb,{effectType:-1,effectId:-1,Qe:cc.ef("AnimFxMultiple"),labelText:ResourceStrings.L_AnimationExisting,Rn:[],Dn:[]})),cc.im.add("None",Object.assign(new Gb,{effectType:0,
effectId:0,Qe:cc.ef("AnimFxNone"),labelText:ResourceStrings.L_AnimationNone,Rn:[],Dn:[]})),cc.im.add("Appear",Object.assign(new Gb,{effectType:0,effectId:1,Qe:cc.ef("AnimFxEntranceAppear"),labelText:ResourceStrings.L_AnimationAppear,Rn:[],Dn:[]})),cc.im.add("FadeIn",Object.assign(new Gb,{effectType:0,effectId:10,Qe:cc.ef("AnimFxEntranceFadeIn"),labelText:ResourceStrings.L_AnimationFade,Rn:[],Dn:[]})),this.yVa){cc.im.add("FlyIn",Object.assign(new Gb,{effectType:0,effectId:2,Qe:cc.ef("AnimFxEntranceFlyIn"),
labelText:ResourceStrings.L_AnimationFlyIn,Rn:"FromBottom FromBottomLeft FromLeft FromTopLeft FromTop FromTopRight FromRight FromBottomRight".split(" "),Dn:[]}));cc.im.add("Wipe",Object.assign(new Gb,{effectType:0,effectId:22,Qe:cc.ef("AnimFxEntranceWipeIn"),labelText:ResourceStrings.L_AnimationWipe,Rn:["FromBottom","FromLeft","FromRight","FromTop"],Dn:[]}));cc.im.add("Zoom",Object.assign(new Gb,{effectType:0,effectId:53,Qe:cc.ef("AnimFxEntranceFadedZoom"),labelText:ResourceStrings.L_AnimationZoom,
Rn:["ObjectCenter","SlideCenter"],Dn:[]}));cc.im.add("Checkerboard",Object.assign(new Gb,{effectType:0,effectId:5,Qe:cc.ef("AnimFxEntranceGeneric"),labelText:ResourceStrings.L_AnimationCheckerboard,Rn:["Across","Down"],Dn:[]}));cc.im.add("BasicZoom",Object.assign(new Gb,{effectType:0,effectId:23,Qe:cc.ef("AnimFxEntranceGeneric"),labelText:ResourceStrings.L_AnimationBasicZoom,Rn:"In InCenter InSlightly Out OutBottom OutSlightly".split(" "),Dn:[]}));cc.im.add("Blinds",Object.assign(new Gb,{effectType:0,
effectId:3,Qe:cc.ef("AnimFxEntranceGeneric"),labelText:ResourceStrings.L_AnimationBlinds,Rn:["Horizontal","Vertical"],Dn:[]}));let x;cc.im.add("Box",(x=new Gb,x.effectType=0,x.effectId=4,x.Qe=cc.ef("AnimFxEntranceShape"),x.labelText=ResourceStrings.L_AnimationBox,x.Rn=["In","Out"],x.Dn=[],x));let N;cc.im.add("PeekIn",(N=new Gb,N.effectType=0,N.effectId=12,N.Qe=cc.ef("AnimFxEntranceGeneric"),N.labelText=ResourceStrings.L_AnimationPeekIn,N.Rn=["FromBottom","FromLeft","FromRight","FromTop"],N.Dn=[],
N));let ea;cc.im.add("Expand",(ea=new Gb,ea.effectType=0,ea.effectId=55,ea.Qe=cc.ef("AnimFxEntranceGeneric"),ea.labelText=ResourceStrings.L_AnimationExpand,ea.Rn=[],ea.Dn=[],ea));let ma;cc.im.add("GrowAndTurn",(ma=new Gb,ma.effectType=0,ma.effectId=31,ma.Qe=cc.ef("AnimFxEntranceGrowAndTurn"),ma.labelText=ResourceStrings.L_AnimationGrowAndTurn,ma.Rn=[],ma.Dn=[],ma));let Ha;cc.im.add("RandomBars",(Ha=new Gb,Ha.effectType=0,Ha.effectId=14,Ha.Qe=cc.ef("AnimFxEntranceRandomBars"),Ha.labelText=ResourceStrings.L_AnimationRandomBars,
Ha.Rn=["Horizontal","Vertical"],Ha.Dn=[],Ha));let Ua;cc.im.add("RiseUp",(Ua=new Gb,Ua.effectType=0,Ua.effectId=37,Ua.Qe=cc.ef("AnimFxEntranceGeneric"),Ua.labelText=ResourceStrings.L_AnimationRiseUp,Ua.Rn=[],Ua.Dn=[],Ua));let mb;cc.im.add("Split",(mb=new Gb,mb.effectType=0,mb.effectId=16,mb.Qe=cc.ef("AnimFxEntranceSplit"),mb.labelText=ResourceStrings.L_AnimationSplit,mb.Rn=["HorizontalIn","HorizontalOut","VerticalIn","VerticalOut"],mb.Dn=[],mb));let gb;cc.im.add("Strips",(gb=new Gb,gb.effectType=0,
gb.effectId=18,gb.Qe=cc.ef("AnimFxEntranceGeneric"),gb.labelText=ResourceStrings.L_AnimationStrips,gb.Rn=["LeftDown","LeftUp","RightDown","RightUp"],gb.Dn=[],gb));let Cb;cc.im.add("Stretch",(Cb=new Gb,Cb.effectType=0,Cb.effectId=17,Cb.Qe=cc.ef("AnimFxEntranceGeneric"),Cb.labelText=ResourceStrings.L_AnimationStretch,Cb.Rn=["Across","FromBottom","FromLeft","FromRight","FromTop"],Cb.Dn=[],Cb));let zb;cc.im.add("Exit_Disappear",(zb=new Gb,zb.effectType=1,zb.effectId=1,zb.Qe=cc.ef("AnimFxExitDisappear"),
zb.labelText=ResourceStrings.L_AnimationDisappear,zb.Rn=[],zb.Dn=[],zb));let Pb;cc.im.add("Exit_Fade",(Pb=new Gb,Pb.effectType=1,Pb.effectId=10,Pb.Qe=cc.ef("AnimFxExitFadeOut"),Pb.labelText=ResourceStrings.L_AnimationFade,Pb.Rn=[],Pb.Dn=[],Pb));let oc;cc.im.add("Exit_FlyOut",(oc=new Gb,oc.effectType=1,oc.effectId=2,oc.Qe=cc.ef("AnimFxExitFlyOut"),oc.labelText=ResourceStrings.L_AnimationFlyOut,oc.Rn="ToBottom ToBottomLeft ToLeft ToTopLeft ToTop ToTopRight ToRight ToBottomRight".split(" "),oc.Dn=[],
oc));let Ec;cc.im.add("Exit_Wipe",(Ec=new Gb,Ec.effectType=1,Ec.effectId=22,Ec.Qe=cc.ef("AnimFxExitWipe"),Ec.labelText=ResourceStrings.L_AnimationWipe,Ec.Rn=["FromBottom","FromLeft","FromRight","FromTop"],Ec.Dn=[],Ec));let Xc;cc.im.add("Exit_Zoom",(Xc=new Gb,Xc.effectType=1,Xc.effectId=53,Xc.Qe=cc.ef("AnimFxExitFadedZoom"),Xc.labelText=ResourceStrings.L_AnimationZoom,Xc.Rn=["ObjectCenterOut","SlideCenterOut"],Xc.Dn=[],Xc));let Ac;cc.im.add("Exit_Checkerboard",(Ac=new Gb,Ac.effectType=1,Ac.effectId=
5,Ac.Qe=cc.ef("AnimFxExitGeneric"),Ac.labelText=ResourceStrings.L_AnimationCheckerboard,Ac.Rn=["Across","Up"],Ac.Dn=[],Ac));let zd;cc.im.add("Exit_BasicZoom",(zd=new Gb,zd.effectType=1,zd.effectId=23,zd.Qe=cc.ef("AnimFxExitGeneric"),zd.labelText=ResourceStrings.L_AnimationBasicZoom,zd.Rn="Out OutCenter OutSlightly In InBottom InSlightly".split(" "),zd.Dn=[],zd));let ue;cc.im.add("Exit_Blinds",(ue=new Gb,ue.effectType=1,ue.effectId=3,ue.Qe=cc.ef("AnimFxExitGeneric"),ue.labelText=ResourceStrings.L_AnimationBlinds,
ue.Rn=["Horizontal","Vertical"],ue.Dn=[],ue));let bf;cc.im.add("Exit_Box",(bf=new Gb,bf.effectType=1,bf.effectId=4,bf.Qe=cc.ef("AnimFxExitShape"),bf.labelText=ResourceStrings.L_AnimationBox,bf.Rn=["In","Out"],bf.Dn=[],bf));let Ce;cc.im.add("Exit_PeekOut",(Ce=new Gb,Ce.effectType=1,Ce.effectId=12,Ce.Qe=cc.ef("AnimFxExitGeneric"),Ce.labelText=ResourceStrings.L_AnimationPeekOut,Ce.Rn=["ToBottom","ToLeft","ToRight","ToTop"],Ce.Dn=[],Ce));let qg;cc.im.add("Exit_RandomBars",(qg=new Gb,qg.effectType=1,qg.effectId=
14,qg.Qe=cc.ef("AnimFxExitRandomBars"),qg.labelText=ResourceStrings.L_AnimationRandomBars,qg.Rn=["Horizontal","Vertical"],qg.Dn=[],qg));let Df;cc.im.add("Exit_Split",(Df=new Gb,Df.effectType=1,Df.effectId=16,Df.Qe=cc.ef("AnimFxExitSplit"),Df.labelText=ResourceStrings.L_AnimationSplit,Df.Rn=["HorizontalIn","HorizontalOut","VerticalIn","VerticalOut"],Df.Dn=[],Df));let Bi;cc.im.add("Exit_Strips",(Bi=new Gb,Bi.effectType=1,Bi.effectId=18,Bi.Qe=cc.ef("AnimFxExitGeneric"),Bi.labelText=ResourceStrings.L_AnimationStrips,
Bi.Rn=["LeftDown","LeftUp","RightDown","RightUp"],Bi.Dn=[],Bi));let wi;cc.im.add("Exit_Stretchy",(wi=new Gb,wi.effectType=1,wi.effectId=17,wi.Qe=cc.ef("AnimFxExitGeneric"),wi.labelText=ResourceStrings.L_AnimationStretchy,wi.Rn=[],wi.Dn=[],wi));let Pf;cc.im.add("Exit_Zoom",(Pf=new Gb,Pf.effectType=1,Pf.effectId=53,Pf.Qe=cc.ef("AnimFxExitFadedZoom"),Pf.labelText=ResourceStrings.L_AnimationZoom,Pf.Rn=["ObjectCenterOut","SlideCenterOut"],Pf.Dn=[],Pf));let Ci;cc.im.add("Emphasis_Spin",(Ci=new Gb,Ci.effectType=
2,Ci.effectId=8,Ci.Qe=cc.ef("AnimFxEmphasisSpin"),Ci.labelText=ResourceStrings.L_AnimationSpin,Ci.Rn=["Clockwise","CounterClockwise"],Ci.Dn=["Spin_Quarter","Spin_Half","Spin_Full","Spin_Two"],Ci));let Tj;cc.im.add("Emphasis_Transparency",(Tj=new Gb,Tj.effectType=2,Tj.effectId=9,Tj.Qe=cc.ef("AnimFxEmphasisTransparency"),Tj.labelText=ResourceStrings.L_AnimationTransparency,Tj.Rn=[],Tj.Dn=["Transparency_25","Transparency_50","Transparency_75","Transparency_100"],Tj));let qh;cc.im.add("Emphasis_GrowShrink",
(qh=new Gb,qh.effectType=2,qh.effectId=6,qh.Qe=cc.ef("AnimFxEmphasisGrowShrink"),qh.labelText=ResourceStrings.L_AnimationGrowShrink,qh.Rn=["GrowShrinkHorizontal","GrowShrinkVertical","GrowShrinkBoth"],qh.Dn=["GrowShrink_Tiny","GrowShrink_Smaller","GrowShrink_Larger","GrowShrink_Huge"],qh));let Uj;cc.im.add("Emphasis_FillColor",(Uj=new Gb,Uj.effectType=2,Uj.effectId=1,Uj.Qe=cc.ef("AnimFxEmphasisChangeFillColor"),Uj.labelText=ResourceStrings.L_AnimationFillColor,Uj.Rn=[],Uj.Dn=[],Uj));let ol;cc.im.add("Emphasis_FontColor",
(ol=new Gb,ol.effectType=2,ol.effectId=3,ol.Qe=cc.ef("AnimFxEmphasisChangeFontColor"),ol.labelText=ResourceStrings.L_AnimationFontColor,ol.Rn=[],ol.Dn=[],ol));let pl;cc.im.add("Emphasis_LineColor",(pl=new Gb,pl.effectType=2,pl.effectId=7,pl.Qe=cc.ef("AnimFxEmphasisChangeLineColor"),pl.labelText=ResourceStrings.L_AnimationLineColor,pl.Rn=[],pl.Dn=[],pl))}else cc.im.add("FlyIn",Object.assign(new Gb,{effectType:0,effectId:2,Qe:cc.ef("AnimFxEntranceFlyIn"),labelText:ResourceStrings.L_AnimationFlyIn,Rn:["FromBottom",
"FromLeft","FromTop","FromRight"],Dn:[]}))}j4b(f,x){let N=null;cc.im.forEach((ea,ma)=>{ma.effectType===f&&ma.effectId===x&&(N=ma);return!0});return N}vTc(f,x){let N=null;cc.im.forEach((ea,ma)=>{ma.effectType===f&&ma.effectId===x&&(N=ea);return!0});return N}XSc(f,x,N,ea,ma){const Ha=Object.assign(new bg.a,{Id:"MenuSectionEffectOptions"+N,ControlsId:"MenuSectionEffectOptionsDirection.Controls",DisplayMode:"Menu32",ControlList:[]});f=this.j4b(x,f);if(!f)return Ha;if((f=cc.z7i(f,N))&&f.length)for(x=0;x<
f.length;x++){const Ua=cc.A7i(f[x],N),mb="AnimationEffectOptions"+("Direction"===N?"Direction":"Data")+Ua.id;Array.add(Ha.ControlList,Object.assign(new aa.a,{Command:ea,Id:Ua.id,ExternalId:mb,QueryCommand:ma}))}return Ha}vRc(f){var x;return(x=cc.im.ga(f))?(f=x.effectType,x=x.effectId,{returnValue:!0,effectType:f,effectId:x}):{returnValue:!1,effectType:-1,effectId:-1}}wRc(f){let x,N;x=cc.ef("AnimFxMultiple");N=ResourceStrings.L_AnimationExisting;if(f=cc.im.ga(f))x=f.Qe,N=f.labelText;return{image:x,
label:N}}iYc(f,x){if(0===f){if(0!==x&&1!==x&&2!==x&&10!==x)return!0}else if(0<f)return!0;return!1}eab(f,x){return f&&x?this.yVa?(x=x.T$a()?f.IsTrigger:f.HasTrigger,!!this.j4b(f.EffectType,f.EffectId)&&!x):!f.HasExisting:!0}WZc(f){return f?this.Cyb(Array(f)):!0}Cyb(f){if(!f||!f.length)return!0;for(const x of f)if(null==this.j4b(x.EffectType,x.EffectId))return!1;return!0}hje(f,x){return x&&f&&this.yVa?x.T$a()?!1:f.HasMultiple:!1}Q8b(f){if(!f||!f.length)return!1;const x=f[0].EffectId,N=f[0].EffectType;
for(let ea=1;ea<f.length;ea++){const ma=f[ea];if(ma.EffectId!=x||ma.EffectType!=N)return!0}return!1}Teg(f){if(f&&this.yVa&&2===f.EffectType)switch(f.EffectId){case 1:case 3:case 7:return!0}return!1}dle(f){if(!f)return!1;if(2===f.EffectType)switch(f.EffectId){case 1:case 3:case 7:return!0}return!1}r6i(f){f=cc.im.ga(f);return this.H4b(f.Rn[0])}o6i(f){return(f=cc.im.ga(f))&&f.Dn.length?this.m5d(f.Dn[0]):""}H4b(f){switch(f){case "FromBottom":case "ToBottom":return 3;case "FromBottomLeft":case "ToBottomLeft":case "LeftDown":return 8;
case "FromLeft":case "ToLeft":return 4;case "FromTopLeft":case "ToTopLeft":case "LeftUp":return 5;case "FromTop":case "ToTop":return 1;case "FromTopRight":case "ToTopRight":case "RightUp":return 6;case "FromRight":case "ToRight":return 2;case "FromBottomRight":case "ToBottomRight":case "RightDown":return 7;case "Horizontal":case "Across":return 9;case "HorizontalIn":return 15;case "HorizontalOut":return 16;case "Vertical":case "Down":case "Up":return 10;case "VerticalIn":return 17;case "VerticalOut":return 18;
case "In":case "ObjectCenter":return 11;case "InCenter":case "SlideCenter":return 22;case "InBottom":return 23;case "InSlightly":return 21;case "Out":case "ObjectCenterOut":return 12;case "OutBottom":return 26;case "OutSlightly":return 24;case "OutCenter":case "SlideCenterOut":return 25;case "FloatUp":return 1;case "FloatDown":return 3;case "Clockwise":return 13;case "CounterClockwise":return 14;case "GrowShrinkHorizontal":return 27;case "GrowShrinkVertical":return 28;case "GrowShrinkBoth":return 29;
default:return 0}}m5d(f){return(f=cc.US.ga(f))?f.value:""}iFf(f,x){return(x=cc.US.ga(x))&&parseFloat(f)===parseFloat(x.value)?!0:!1}v8d(f){switch(f){case "AsOneObject":return 1;case "AllAtOnce":return 2;case "ByParagraph":return 3;case "OneByOne":return 4;default:return 0}}Lni(f){if(null===f)throw Error.argumentNull("animation");const x=this.j4b(f.EffectType,f.EffectId);return!!x&&(0<x.Rn.length||0<x.Dn.length||this.Teg(f))}Mni(f){if(!f)return!1;const x=this.j4b(f.EffectType,f.EffectId);return!!x&&
(0<x.Rn.length||0<x.Dn.length||this.dle(f))}Nni(f,x,N){return this.eab(N,f)&&!this.hje(N,f)&&(this.Lni(N)||this.HAf(f,x,N)||this.ASd(f,x,N)||this.FAf(f,x,N)||this.BSd(f,N))}Oni(f,x,N){if(!(f&&x&&N&&N.length&&this.Cyb(N)))return!1;f=cc.kHf(f,N);x=this.IAf(x,f)||this.KAf(x,f)||this.GAf(x,f)||this.MAf(f);let ea;this.Q8b(N)||(ea=this.Mni(N[0]));return ea||x}gfj(f,x,N){const ea=Object.assign(new bg.a,{Id:"MenuSectionEffectOptionsSequence",ControlsId:"MenuSectionEffectOptionsSequence.Controls",DisplayMode:"Menu32",
ControlList:[]});this.HAf(f,x,N)&&Array.add(ea.ControlList,Object.assign(new aa.a,{Command:"1850236812",Id:"AsOneObject",ExternalId:"AnimationEffectOptionsSequenceAsOneObject",QueryCommand:"1125291975"}));this.FAf(f,x,N)&&this.yVa&&Array.add(ea.ControlList,Object.assign(new aa.a,{Command:"2048458448",Id:"AllAtOnce",ExternalId:"AnimationEffectOptionsSequenceAllAtOnce",QueryCommand:"1125291975"}));this.ASd(f,x,N)&&Array.add(ea.ControlList,Object.assign(new aa.a,{Command:"3467781846",Id:"ByParagraph",
ExternalId:"AnimationEffectOptionsSequenceByParagraph",QueryCommand:"1125291975"}));this.BSd(f,N)&&Array.add(ea.ControlList,Object.assign(new aa.a,{Command:"1486892994",Id:"OneByOne",ExternalId:"AnimationEffectOptionsSequenceOneByOne",QueryCommand:"1125291975"}));return ea}hfj(f,x,N){const ea=new bg.a;ea.Id="MenuSectionEffectOptionsSequence";ea.ControlsId="MenuSectionEffectOptionsSequence.Controls";ea.DisplayMode="Menu32";ea.ControlList=[];if(!(f&&f.length&&x&&N&&N.length))return ea;f=cc.kHf(f,N);
this.IAf(x,f)&&(N=new aa.a,N.Command="1850236812",N.Id="AsOneObject",N.ExternalId="AnimationEffectOptionsSequenceAsOneObject",N.QueryCommand="1125291975",ea.ControlList.push(N));this.GAf(x,f)&&(N=new aa.a,N.Command="2048458448",N.Id="AllAtOnce",N.ExternalId="AnimationEffectOptionsSequenceAllAtOnce",N.QueryCommand="1125291975",ea.ControlList.push(N));this.KAf(x,f)&&(x=new aa.a,x.Command="3467781846",x.Id="ByParagraph",x.ExternalId="AnimationEffectOptionsSequenceByParagraph",x.QueryCommand="1125291975",
ea.ControlList.push(x));this.MAf(f)&&(x=new aa.a,x.Command="1486892994",x.Id="OneByOne",x.ExternalId="AnimationEffectOptionsSequenceOneByOne",x.QueryCommand="1125291975",ea.ControlList.push(x));return ea}WRj(f){let x=!0,N=0;if(!f)return!1;for(const ea of f)if(x)N=ea.EffectId,x=!1;else if(ea.EffectId!==N)return!1;return!0}Ubj(f,x,N){const ea={isEnabled:!1,zjd:null};if(!f||!x||!x.length)return ea;f=cc.dbj(f);if(!f.length)return ea;const ma=f.map(Ha=>Ha.EffectNodeId);x=x.map(Ha=>Ha.EffectNodeId).sort((Ha,
Ua)=>Ha-Ua);if(!cc.jSj(x,ma))return ea;if(N){N=ma.indexOf(x[x.length-1]);if(-1==N||N==ma.length-1)return ea;ea.isEnabled=!0;ea.zjd=cc.y5f(f[N+1])}else{N=ma.indexOf(x[0]);if(-1==N||0==N)return ea;ea.isEnabled=!0;ea.zjd=cc.y5f(f[N-1])}return ea}static kHf(f,x){const N=new Map;for(const ea of f)N.set(ea.id.toString(),ea);f=new Map;for(const ea of x)x=dd.a.Hf(ea.ShapeId),x=N.get(x.toString()),f.set(ea,x);return f}static y5f(f){const x=new Ub;x.EffectNodeId=f.EffectNodeId;x.ShapeId=f.ShapeId;return x}static jSj(f,
x){if(!(f&&f.length&&x&&x.length)||f.length>x.length)return!1;const N=f[f.length-1],ea=x.indexOf(f[0]);return x.indexOf(N)-ea+1==f.length}static dbj(f){const x=[];if(!f)return x;f=f.cW;if(!f||!f.Sequences)return x;for(const N of f.Sequences[0].Effects)x.push(N);return x.sort((N,ea)=>N.EffectNodeId-ea.EffectNodeId)}HAf(f,x,N){return 0!==N.SequenceId&&0!==N.EffectId&&this.eab(N,f)&&(f.Rf||2!==N.EffectType||1!==N.EffectId&&7!==N.EffectId)&&(f.V3||this.BSd(f,N)||this.ASd(f,x,N))}Qni(f,x,N){return f&&
0!==N.BuildType&&0!==N.EffectId&&this.WZc(N)&&(f.Rf||2!==N.EffectType||1!==N.EffectId&&7!==N.EffectId)&&(f.V3||this.LAf(f,N)||this.JAf(f,x,N))}IAf(f,x){for(let [N,ea]of x)if(!this.Qni(ea,f,N))return!1;return!0}FAf(f,x,N){return 0!==N.SequenceId&&!f.V3&&!f.ud&&0!==N.EffectId&&this.eab(N,f)&&(f.Rf||2!==N.EffectType||1!==N.EffectId&&7!==N.EffectId)&&(f.gl||f.Rf||f.isEditable&&0<x.$ca(f).length)}Pni(f,x,N){return f&&0!==N.BuildType&&!f.V3&&!f.ud&&0!==N.EffectId&&this.WZc(N)&&(f.Rf||2!==N.EffectType||
1!==N.EffectId&&7!==N.EffectId)&&(f.gl||f.Rf||f.isEditable&&0<x.$ca(f).length)}GAf(f,x){for(let [N,ea]of x)if(!this.Pni(ea,f,N))return!1;return!0}ASd(f,x,N){return 0!==N.SequenceId&&!f.Rf&&!f.V3&&!f.ud&&0!==N.EffectId&&this.eab(N,f)&&(2!==N.EffectType||1!==N.EffectId&&7!==N.EffectId)&&(f.gl||f.isEditable&&0<x.$ca(f).length)}JAf(f,x,N){return f&&0!==N.BuildType&&!f.Rf&&!f.V3&&!f.ud&&0!==N.EffectId&&this.WZc(N)&&(2!==N.EffectType||1!==N.EffectId&&7!==N.EffectId)&&(f.gl||f.isEditable&&0<x.$ca(f).length)}KAf(f,
x){for(let [N,ea]of x)if(!this.JAf(ea,f,N))return!1;return!0}BSd(f,x){return 0!==x.SequenceId&&f.Rf&&0!==x.EffectId&&this.eab(x,f)}LAf(f,x){return f&&0!==x.BuildType&&f.Rf&&0!==x.EffectId&&this.WZc(x)}MAf(f){for(let [x,N]of f)if(!this.LAf(N,x))return!1;return!0}static ef(f){return Md.a.Lkc+"_"+f+"_32x32x32"}static z7i(f,x){switch(x){case "Direction":return f.Rn;case "EffectData":return f.Dn;default:return null}}static A7i(f,x){switch(x){case "Direction":return cc.Fl.ga(f);case "EffectData":return cc.US.ga(f);
default:return null}}}cc.Fl=null;cc.US=null;cc.im=null;Object(k.a)(cc,"AnimationHelper",null,[1066]);class Qd{constructor(f,x,N,ea,ma,Ha,Ua){this.gE=null;this.DZe=!1;this.kHa=N;this.pa=f;(this.ova=ea)&&ma.execute(mb=>{this.gE=mb});this.ta=Ua;this.ia=x;this.Jla=Ha}selectShape(){this.pa&&!this.pa.cX(this.ta)&&this.pa.selectShape(this.ta,!0)}onVolumeChanged(f){const x={ActionFromPlayer:!0};.2>=f?(x.SourceControlId="SetVolumeLow",this.ia.La(zc.a.pod,2,x)):.2<f&&.8>f?(x.SourceControlId="SetVolumeMedium",
this.ia.La(zc.a.qod,2,x)):.8<=f&&(x.SourceControlId="SetVolumeHigh",this.ia.La(zc.a.ood,2,x));this.selectShape()}onPlayToggled(f){const x={ActionFromPlayer:!0};f?this.ia.La(zc.a.$Gc,2,x):this.ia.La(zc.a.IYb,2,x);this.selectShape()}onMuteToggled(f){if(f)this.ia.La(zc.a.rod,2,{ActionFromPlayer:!0,SourceControlId:"SetVolumeMute"});else this.onVolumeChanged(this.ta.media.vlmField);this.selectShape()}onPlayerReadyStateChanged(f){f&&appChrome.api.dispatch(appChrome.actions.updateControlEnabledDisabledState("AudioPlay",
!1))}onMouseHoverStateChanged(f){f||this.pa.ske(this.ta)||(f=this.bL())&&f.showHidePlayer(!1)}onPlayerClicked(){this.ova&&this.ia.processAction(zc.a.iOb,2)}onPlayerError(f){Vc.a.J(512497820,822,10,"AudioLibraryCallback::OnPlayerError Error Message: {0}",f);f&&-1<f.indexOf("PIPELINE_ERROR_READ")&&this.kHa.a7d(this.Jla.podSessionId,this.ta).then(x=>{const N=this.bL();N&&N.setAudioSrc(x)})}onKeyDown(f){f===og.a.Blb?(f=this.bL())&&f.removeFocusFromPlayer():f===og.a.Pq&&(this.DZe=!0)}onBlur(){const f=
this.bL();f&&(this.DZe?f.setFocusOnPlayer():f.removeFocusFromPlayer());this.DZe=!1}bL(){return this.ova&&this.gE?this.gE.bL(this.ta):null}}Object(k.a)(Qd,"AudioLibraryCallback",null,[1085]);class re{constructor(f,x,N,ea,ma,Ha){this.kHa=f;this.pa=x;this.ia=N;this.ova=ea;this.Lbb=Ha;this.Jla=ma}WAi(f){return new Qd(this.pa,this.ia,this.kHa,this.ova,this.Lbb,this.Jla,f)}}Object(k.a)(re,"AudioLibraryCallbackFactory",null,[1010]);class Ca{constructor(f,x,N,ea){this.volume=f;this.mute=x;this.repeat=N;this.rewind=
ea}}Object(k.a)(Ca,"MediaProperties",null,[]);class ob{constructor(f,x,N,ea){this.b4j=f;this.Ewe=x;this.kHa=N;this.Jla=ea}createAudioManager(f,x,N){return new Promise((ea,ma)=>{this.Ewe("audioPlayback").then(()=>{window.self.audioPlayback?(Vc.a.J(512497818,801,50,"audio script is loaded successfully"),ea(this.XAi(f,x,N))):(Vc.a.J(512497819,801,10,"Audio script is loaded successfully but AudioPlayback namespace cannot be found"),ma("Audio script is loaded successfully but AudioPlayback namespace cannot be found"))}).catch(Ha=>
{Vc.a.J(512497817,801,10,"Failed to load audio script "+Ha.toString());ma("Failed to load audio script ")})})}XAi(f,x,N){const ea=x.media;let ma=null;ea&&(ma=new Ca(ea.vlmField,ea.mteField,ea.repeatField,ea.rewindField));const Ha=audioPlayback.pptAudioFactoryGlobal.createAudioManager(f,N,this.b4j.WAi(x),ma);this.kHa.a7d(this.Jla.podSessionId,x).then(Ua=>{Ha&&Ha.setAudioSrc(Ua)});return Ha}}Object(k.a)(ob,"AudioManagerFactory",null,[1011]);var Hb=d(1239);class rc{constructor(){this.JAb=new Hb.a}BOk(f,
x){x&&this.JAb.$(x.id,f)}TEh(f){f&&this.JAb.Hb(f.id)&&(this.JAb.ga(f.id).dispose(),this.JAb.remove(f.id))}bL(f){return f&&this.JAb.Hb(f.id)?this.JAb.ga(f.id):null}}Object(k.a)(rc,"AudioManagerStore",null,[1009]);class td{BVj(f){return!td.iwb(td.gDl)||f>td.T3e?!0:!1}static iwb(f){return(f=document.getElementById(f))?f:null}}td.gDl="PptRibbon.Design.ThemeVariants-MaxSize";td.T3e=4;Object(k.a)(td,"ThemeHelper",null,[1064]);class sc{constructor(){this.Duration=this.Direction=0;this.IsManualAdvance=!1;
this.TransitionType=0}}Object(k.a)(sc,"EditTransitionInfo",null,[]);class Tc{constructor(){this.next=this.parent=this.tc=this.Dx=this.uc=this.oc=null}}Object(k.a)(Tc,"Transition",null,[]);class Dc{}Dc.none=0;Dc.LYi=5;Dc.MYi=4;Dc.Qpl=1;Dc.doj=1;Dc.Xgi=2;Dc.k8=0;Dc.ZRa=1;Dc.wDa=2;Dc.tvb=3;Dc.ZPc=4;Dc.YPc=5;Dc.bQc=6;Dc.aQc=7;Dc.iUc=2;Dc.UTa=1;Dc.Tnj=1;Dc.KRd=0;Dc.Nki=1;Dc.Mki=2;Dc.Vnj=0;Dc.Unj=1;Dc.h7f=2;Dc.eoj=3;Dc.m$d=0;Dc.k6b=1;Dc.hUc=0;Dc.X9a=1;Dc.qhi=1;Dc.yxf=0;Dc.Gwh=2;Dc.njl=0;Dc.Spl=3;Dc.Rpl=
1;Dc.wheel=1;Dc.nlh=29;Dc.hWf=0;Dc.c_i=1;Dc.l_i=2;Dc.v_i=3;Dc.gWf=8;Dc.b_i=9;Dc.k_i=10;Dc.u_i=11;Dc.iWf=12;Dc.f_i=13;Dc.n_i=14;Dc.y_i=15;Dc.jWf=4;Dc.g_i=5;Dc.o_i=6;Dc.z_i=7;Dc.m_i=0;Dc.w_i=1;Dc.q_i=2;Dc.d_i=3;Dc.cWf=4;Dc.x_i=5;Dc.r_i=6;Dc.e_i=7;Object(k.a)(Dc,"TransitionEffectOptions",null,[]);class xc{constructor(f,x){let N=0;this.Ac=new ib.a;this.Ola=x;this.Ac.$("TransitionExisting",Object.assign(new Tc,{oc:ResourceStrings.L_TransitionExisting,uc:xc.Ec("TransitionFlash"),parent:"TransitionExisting"}));
this.Ac.$("TransitionExistingInMenu",Object.assign(new Tc,{oc:ResourceStrings.L_TransitionExisting,uc:xc.Ec("TransitionFlash"),parent:"TransitionExisting"}));this.Ac.$("TransitionNone",Object.assign(new Tc,{oc:ResourceStrings.L_TransitionNone,uc:xc.Ec("TransitionNone"),tc:Object.assign(new sc,{TransitionType:sa.none,Direction:Dc.Xgi,Duration:0,IsManualAdvance:!0}),parent:"TransitionNone"}));this.Ac.$("TransitionFade",Object.assign(new Tc,{oc:ResourceStrings.L_TransitionFade,uc:xc.Ec("TransitionFadeSmoothly"),
tc:Object.assign(new sc,{TransitionType:sa.Stf,Direction:Dc.none,Duration:700,IsManualAdvance:!0}),parent:"TransitionFade",next:"TransitionFadeSmoothly"}));this.Ac.$("TransitionFadeSmoothly",Object.assign(new Tc,{oc:ResourceStrings.L_TransitionSmoothly,Dx:CommonUIStrings.l_TransitionFadeSmoothlyKeytip,uc:xc.Ec("TransitionFadeSmoothly"),tc:Object.assign(new sc,{TransitionType:sa.Stf,Direction:Dc.none,Duration:700,IsManualAdvance:!0}),parent:"TransitionFade",next:"TransitionFadeThroughBlack"}));this.Ac.$("TransitionFadeThroughBlack",
Object.assign(new Tc,{oc:ResourceStrings.L_TransitionThroughBlack,Dx:CommonUIStrings.l_TransitionFadeThroughBlackKeytip,uc:xc.Ec("TransitionFadeThroughBlack"),tc:Object.assign(new sc,{TransitionType:sa.fade,Direction:Dc.none,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionFade"}));let ea=[];if(f){ea=f.toLowerCase().split(",");for(let ma=0;ma<ea.length;ma++)ea[ma]=ea[ma].trim()}Array.contains(ea,"push")||(this.Ac.$("TransitionPush",Object.assign(new Tc,{oc:ResourceStrings.L_TransitionPush,uc:xc.Ec("TransitionPushUp"),
tc:Object.assign(new sc,{TransitionType:sa.push,Direction:Dc.ZRa,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionPush",next:"TransitionPushFromBottom"})),this.Ac.$("TransitionPushFromBottom",Object.assign(new Tc,{oc:ResourceStrings.L_TransitionFromBottom,Dx:CommonUIStrings.l_TransitionPushFromBottomKeytip,uc:xc.Ec("TransitionPushUp"),tc:Object.assign(new sc,{TransitionType:sa.push,Direction:Dc.ZRa,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionPush",next:"TransitionPushFromLeft"})),this.Ac.$("TransitionPushFromLeft",
Object.assign(new Tc,{oc:ResourceStrings.L_TransitionFromLeft,Dx:CommonUIStrings.l_TransitionPushFromLeftKeytip,uc:xc.Ec("TransitionPushRight"),tc:Object.assign(new sc,{TransitionType:sa.push,Direction:Dc.wDa,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionPush",next:"TransitionPushFromRight"})),this.Ac.$("TransitionPushFromRight",Object.assign(new Tc,{oc:ResourceStrings.L_TransitionFromRight,Dx:CommonUIStrings.l_TransitionPushFromRightKeytip,uc:xc.Ec("TransitionPushLeft"),tc:Object.assign(new sc,
{TransitionType:sa.push,Direction:Dc.k8,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionPush",next:"TransitionPushFromTop"})),this.Ac.$("TransitionPushFromTop",Object.assign(new Tc,{oc:ResourceStrings.L_TransitionFromTop,Dx:CommonUIStrings.l_TransitionPushFromTopKeytip,uc:xc.Ec("TransitionPushDown"),tc:Object.assign(new sc,{TransitionType:sa.push,Direction:Dc.tvb,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionPush"})));Array.contains(ea,"cut")||(this.Ac.$("TransitionCut",Object.assign(new Tc,
{oc:ResourceStrings.L_TransitionCut,uc:xc.Ec("TransitionCut"),tc:Object.assign(new sc,{TransitionType:sa.cut,Direction:Dc.none,Duration:100,IsManualAdvance:!0}),parent:"TransitionCut",next:"TransitionCutNone"})),this.Ac.$("TransitionCutNone",Object.assign(new Tc,{oc:ResourceStrings.L_TransitionNone,Dx:CommonUIStrings.l_TransitionCutNoneKeytip,uc:xc.Ec("TransitionCut"),tc:Object.assign(new sc,{TransitionType:sa.cut,Direction:Dc.none,Duration:100,IsManualAdvance:!0}),parent:"TransitionCut",next:"TransitionCutThroughBlack"})),
this.Ac.$("TransitionCutThroughBlack",Object.assign(new Tc,{oc:ResourceStrings.L_TransitionThroughBlack,Dx:CommonUIStrings.l_TransitionCutThroughBlackKeytip,uc:xc.Ec("TransitionCutThroughBlack"),tc:Object.assign(new sc,{TransitionType:sa.cut,Direction:Dc.Qpl,Duration:500,IsManualAdvance:!0}),parent:"TransitionCut"})));Array.contains(ea,"wipe")||(this.Ac.$("TransitionWipe",Object.assign(new Tc,{oc:ResourceStrings.L_TransitionWipe,uc:xc.Ec("TransitionWipeLeft"),tc:Object.assign(new sc,{TransitionType:sa.wipe,
Direction:Dc.k8,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionWipe",next:"TransitionWipeFromRight"})),this.Ac.$("TransitionWipeFromRight",Object.assign(new Tc,{oc:ResourceStrings.L_TransitionFromRight,Dx:CommonUIStrings.l_TransitionWipeFromRightKeytip,uc:xc.Ec("TransitionWipeLeft"),tc:Object.assign(new sc,{TransitionType:sa.wipe,Direction:Dc.k8,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionWipe",next:"TransitionWipeFromTop"})),this.Ac.$("TransitionWipeFromTop",Object.assign(new Tc,{oc:ResourceStrings.L_TransitionFromTop,
Dx:CommonUIStrings.l_TransitionWipeFromTopKeytip,uc:xc.Ec("TransitionWipeDown"),tc:Object.assign(new sc,{TransitionType:sa.wipe,Direction:Dc.tvb,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionWipe",next:"TransitionWipeFromLeft"})),this.Ac.$("TransitionWipeFromLeft",Object.assign(new Tc,{oc:ResourceStrings.L_TransitionFromLeft,Dx:CommonUIStrings.l_TransitionWipeFromLeftKeytip,uc:xc.Ec("TransitionWipeRight"),tc:Object.assign(new sc,{TransitionType:sa.wipe,Direction:Dc.wDa,Duration:1E3,IsManualAdvance:!0}),
parent:"TransitionWipe",next:"TransitionWipeFromBottom"})),this.Ac.$("TransitionWipeFromBottom",Object.assign(new Tc,{oc:ResourceStrings.L_TransitionFromBottom,Dx:CommonUIStrings.l_TransitionWipeFromBottomKeytip,uc:xc.Ec("TransitionWipeUp"),tc:Object.assign(new sc,{TransitionType:sa.wipe,Direction:Dc.ZRa,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionWipe",next:"TransitionWipeFromTopRight"})),this.Ac.$("TransitionWipeFromTopRight",Object.assign(new Tc,{oc:ResourceStrings.L_TransitionFromTopRight,
Dx:CommonUIStrings.l_TransitionWipeFromTopRightKeytip,uc:xc.Ec("TransitionStripsLeftDown"),tc:Object.assign(new sc,{TransitionType:sa.Aud,Direction:Dc.bQc,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionWipe",next:"TransitionWipeFromBottomRight"})),this.Ac.$("TransitionWipeFromBottomRight",Object.assign(new Tc,{oc:ResourceStrings.L_TransitionFromBottomRight,Dx:CommonUIStrings.l_TransitionWipeFromBottomRightKeytip,uc:xc.Ec("TransitionStripsLeftUp"),tc:Object.assign(new sc,{TransitionType:sa.Aud,
Direction:Dc.ZPc,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionWipe",next:"TransitionWipeFromTopLeft"})),this.Ac.$("TransitionWipeFromTopLeft",Object.assign(new Tc,{oc:ResourceStrings.L_TransitionFromTopLeft,Dx:CommonUIStrings.l_TransitionWipeFromTopLeftKeytip,uc:xc.Ec("TransitionStripsRightDown"),tc:Object.assign(new sc,{TransitionType:sa.Aud,Direction:Dc.aQc,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionWipe",next:"TransitionWipeFromBottomLeft"})),this.Ac.$("TransitionWipeFromBottomLeft",
Object.assign(new Tc,{oc:ResourceStrings.L_TransitionFromBottomLeft,Dx:CommonUIStrings.l_TransitionWipeFromBottomLeftKeytip,uc:xc.Ec("TransitionStripsRightUp"),tc:Object.assign(new sc,{TransitionType:sa.Aud,Direction:Dc.YPc,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionWipe"})));this.Ola&&Ud.a("MorphTransitionActionAIEnabled")&&this.Ac.$("TransitionMorphActionAI",Object.assign(new Tc,{oc:ResourceStrings.L_TransitionMorph,uc:xc.Ec("TransitionByObject"),tc:Object.assign(new sc,{TransitionType:sa.morph,
Direction:Dc.KRd,Duration:2E3,IsManualAdvance:!0}),parent:"TransitionMorph",next:"TransitionMorphByObject"}));Array.contains(ea,"morph")||(this.Ac.$("TransitionMorph",Object.assign(new Tc,{oc:ResourceStrings.L_TransitionMorph,uc:xc.Ec("TransitionByObject"),tc:Object.assign(new sc,{TransitionType:sa.morph,Direction:Dc.KRd,Duration:2E3,IsManualAdvance:!0}),parent:"TransitionMorph",next:"TransitionMorphByObject"})),this.Ac.$("TransitionMorphByObject",Object.assign(new Tc,{oc:ResourceStrings.L_TransitionByObject,
Dx:CommonUIStrings.l_TransitionMorphObjectsKeytip,uc:xc.Ec("TransitionByObject"),tc:Object.assign(new sc,{TransitionType:sa.morph,Direction:Dc.KRd,Duration:2E3,IsManualAdvance:!0}),parent:"TransitionMorph",next:"TransitionMorphByWord"})),this.Ac.$("TransitionMorphByWord",Object.assign(new Tc,{oc:ResourceStrings.L_TransitionByWord,Dx:CommonUIStrings.l_TransitionMorphWordsKeytip,uc:xc.Ec("TransitionByWord"),tc:Object.assign(new sc,{TransitionType:sa.morph,Direction:Dc.Nki,Duration:2E3,IsManualAdvance:!0}),
parent:"TransitionMorph",next:"TransitionMorphByChar"})),this.Ac.$("TransitionMorphByChar",Object.assign(new Tc,{oc:ResourceStrings.L_TransitionByChar,Dx:CommonUIStrings.l_TransitionMorphCharactersKeytip,uc:xc.Ec("TransitionByChar"),tc:Object.assign(new sc,{TransitionType:sa.morph,Direction:Dc.Mki,Duration:2E3,IsManualAdvance:!0}),parent:"TransitionMorph"})));Array.contains(ea,"split")||(this.Ac.$("TransitionSplit",Object.assign(new Tc,{oc:ResourceStrings.L_TransitionSplit,uc:xc.Ec("TransitionSplitOutVertical"),
tc:Object.assign(new sc,{TransitionType:sa.split,Direction:Dc.h7f,Duration:1500,IsManualAdvance:!0}),parent:"TransitionSplit",next:"TransitionSplitVerticalOut"})),this.Ac.$("TransitionSplitVerticalOut",Object.assign(new Tc,{oc:ResourceStrings.L_TransitionVerticalOut,Dx:CommonUIStrings.l_TransitionSplitVerticalOutKeytip,uc:xc.Ec("TransitionSplitOutVertical"),tc:Object.assign(new sc,{TransitionType:sa.split,Direction:Dc.h7f,Duration:1500,IsManualAdvance:!0}),parent:"TransitionSplit",next:"TransitionSplitHorizontalIn"})),
this.Ac.$("TransitionSplitHorizontalIn",Object.assign(new Tc,{oc:ResourceStrings.L_TransitionHorizontalIn,Dx:CommonUIStrings.l_TransitionSplitHorizontalInKeytip,uc:xc.Ec("TransitionSplitInHorizontal"),tc:Object.assign(new sc,{TransitionType:sa.split,Direction:Dc.Unj,Duration:1500,IsManualAdvance:!0}),parent:"TransitionSplit",next:"TransitionSplitHorizontalOut"})),this.Ac.$("TransitionSplitHorizontalOut",Object.assign(new Tc,{oc:ResourceStrings.L_TransitionHorizontalOut,Dx:CommonUIStrings.l_TransitionSplitHorizontalOutKeytip,
uc:xc.Ec("TransitionSplitOutHorizontal"),tc:Object.assign(new sc,{TransitionType:sa.split,Direction:Dc.Vnj,Duration:1500,IsManualAdvance:!0}),parent:"TransitionSplit",next:"TransitionSplitVerticalIn"})),this.Ac.$("TransitionSplitVerticalIn",Object.assign(new Tc,{oc:ResourceStrings.L_TransitionVerticalIn,Dx:CommonUIStrings.l_TransitionSplitVerticalInKeytip,uc:xc.Ec("TransitionSplitInVertical"),tc:Object.assign(new sc,{TransitionType:sa.split,Direction:Dc.eoj,Duration:1500,IsManualAdvance:!0}),parent:"TransitionSplit"})));
if(!Array.contains(ea,"randombars")){this.Ac.$("TransitionRandomBars",Object.assign(new Tc,{oc:ResourceStrings.L_TransitionRandomBars,uc:xc.Ec("TransitionRandomBarsVertical"),tc:Object.assign(new sc,{TransitionType:sa.wNe,Direction:Dc.X9a,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionRandomBars",next:"TransitionRandomBarsVertical"}));this.Ac.$("TransitionRandomBarsVertical",Object.assign(new Tc,{oc:ResourceStrings.L_TransitionVertical,Dx:CommonUIStrings.l_TransitionRandomBarsVerticalKeytip,
uc:xc.Ec("TransitionRandomBarsVertical"),tc:Object.assign(new sc,{TransitionType:sa.wNe,Direction:Dc.X9a,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionRandomBars",next:"TransitionRandomBarsHorizontal"}));let ma,Ha;this.Ac.$("TransitionRandomBarsHorizontal",(Ha=new Tc,Ha.oc=ResourceStrings.L_TransitionHorizontal,Ha.Dx=CommonUIStrings.l_TransitionRandomBarsHorizontalKeytip,Ha.uc=xc.Ec("TransitionRandomBarsHorizontal"),Ha.tc=(ma=new sc,ma.TransitionType=sa.wNe,ma.Direction=Dc.hUc,ma.Duration=1E3,
ma.IsManualAdvance=!0,ma),Ha.parent="TransitionRandomBars",Ha))}if(!Array.contains(ea,"shape")){let ma,Ha;this.Ac.$("TransitionShape",(Ha=new Tc,Ha.oc=ResourceStrings.L_TransitionShape,Ha.uc=xc.Ec("TransitionShapeCircle"),Ha.tc=(ma=new sc,ma.TransitionType=sa.Zrh,ma.Direction=Dc.none,ma.Duration=800,ma.IsManualAdvance=!0,ma),Ha.parent="TransitionShape",Ha.next="TransitionShapeCircle",Ha));let Ua,mb;this.Ac.$("TransitionShapeCircle",(mb=new Tc,mb.oc=ResourceStrings.L_TransitionCircle,mb.Dx=CommonUIStrings.l_TransitionShapeCircleKeytip,
mb.uc=xc.Ec("TransitionShapeCircle"),mb.tc=(Ua=new sc,Ua.TransitionType=sa.Zrh,Ua.Direction=Dc.none,Ua.Duration=800,Ua.IsManualAdvance=!0,Ua),mb.parent="TransitionShape",mb.next="TransitionShapeDiamond",mb));let gb,Cb;this.Ac.$("TransitionShapeDiamond",(Cb=new Tc,Cb.oc=ResourceStrings.L_TransitionDiamond,Cb.Dx=CommonUIStrings.l_TransitionShapeDiamondKeytip,Cb.uc=xc.Ec("TransitionShapeDiamond"),Cb.tc=(gb=new sc,gb.TransitionType=sa.Gal,gb.Direction=Dc.none,gb.Duration=800,gb.IsManualAdvance=!0,gb),
Cb.parent="TransitionShape",Cb.next="TransitionShapePlus",Cb));let zb,Pb;this.Ac.$("TransitionShapePlus",(Pb=new Tc,Pb.oc=ResourceStrings.L_TransitionPlus,Pb.Dx=CommonUIStrings.l_TransitionShapePlusKeytip,Pb.uc=xc.Ec("TransitionShapePlus"),Pb.tc=(zb=new sc,zb.TransitionType=sa.Lal,zb.Direction=Dc.none,zb.Duration=1E3,zb.IsManualAdvance=!0,zb),Pb.parent="TransitionShape",Pb.next="TransitionShapeIn",Pb));let oc,Ec;this.Ac.$("TransitionShapeIn",(Ec=new Tc,Ec.oc=ResourceStrings.L_TransitionIn,Ec.Dx=CommonUIStrings.l_TransitionShapeInKeytip,
Ec.uc=xc.Ec("TransitionBoxIn"),Ec.tc=(oc=new sc,oc.TransitionType=sa.bsh,oc.Direction=Dc.k6b,oc.Duration=1200,oc.IsManualAdvance=!0,oc),Ec.parent="TransitionShape",Ec.next="TransitionShapeOut",Ec));let Xc,Ac;this.Ac.$("TransitionShapeOut",(Ac=new Tc,Ac.oc=ResourceStrings.L_TransitionOut,Ac.Dx=CommonUIStrings.l_TransitionShapeOutKeytip,Ac.uc=xc.Ec("TransitionBoxOut"),Ac.tc=(Xc=new sc,Xc.TransitionType=sa.bsh,Xc.Direction=Dc.m$d,Xc.Duration=1200,Xc.IsManualAdvance=!0,Xc),Ac.parent="TransitionShape",
Ac))}if(!Array.contains(ea,"reveal")){let ma,Ha;this.Ac.$("TransitionReveal",(Ha=new Tc,Ha.oc=ResourceStrings.L_TransitionReveal,Ha.uc=xc.Ec("TransitionRevealSmoothlyFromRight"),Ha.tc=(ma=new sc,ma.TransitionType=sa.noc,ma.Direction=Dc.Gwh,ma.Duration=3400,ma.IsManualAdvance=!0,ma),Ha.parent="TransitionReveal",Ha.next="TransitionRevealSmoothlyFromRight",Ha));let Ua,mb;this.Ac.$("TransitionRevealSmoothlyFromRight",(mb=new Tc,mb.oc=ResourceStrings.L_TransitionSmoothlyFromRight,mb.uc=xc.Ec("TransitionRevealSmoothlyFromRight"),
mb.tc=(Ua=new sc,Ua.TransitionType=sa.noc,Ua.Direction=Dc.Gwh,Ua.Duration=3400,Ua.IsManualAdvance=!0,Ua),mb.parent="TransitionReveal",mb.next="TransitionRevealSmoothlyFromLeft",mb));let gb,Cb;this.Ac.$("TransitionRevealSmoothlyFromLeft",(Cb=new Tc,Cb.oc=ResourceStrings.L_TransitionSmoothlyFromLeft,Cb.uc=xc.Ec("TransitionRevealSmoothlyFromLeft"),Cb.tc=(gb=new sc,gb.TransitionType=sa.noc,gb.Direction=Dc.njl,gb.Duration=3400,gb.IsManualAdvance=!0,gb),Cb.parent="TransitionReveal",Cb.next="TransitionRevealFromRight",
Cb));let zb,Pb;this.Ac.$("TransitionRevealFromRight",(Pb=new Tc,Pb.oc=ResourceStrings.L_TransitionThroughBlackFromRight,Pb.uc=xc.Ec("TransitionRevealFromRight"),Pb.tc=(zb=new sc,zb.TransitionType=sa.noc,zb.Direction=Dc.Spl,zb.Duration=3400,zb.IsManualAdvance=!0,zb),Pb.parent="TransitionReveal",Pb.next="TransitionRevealFromLeft",Pb));let oc,Ec;this.Ac.$("TransitionRevealFromLeft",(Ec=new Tc,Ec.oc=ResourceStrings.L_TransitionThroughBlackFromLeft,Ec.uc=xc.Ec("TransitionRevealFromLeft"),Ec.tc=(oc=new sc,
oc.TransitionType=sa.noc,oc.Direction=Dc.Rpl,oc.Duration=3400,oc.IsManualAdvance=!0,oc),Ec.parent="TransitionReveal",Ec))}if(!Array.contains(ea,"cover")){let ma,Ha;this.Ac.$("TransitionCover",(Ha=new Tc,Ha.oc=ResourceStrings.L_TransitionCover,Ha.uc=xc.Ec("TransitionCoverLeft"),Ha.tc=(ma=new sc,ma.TransitionType=sa.pCa,ma.Direction=Dc.k8,ma.Duration=1E3,ma.IsManualAdvance=!0,ma),Ha.parent="TransitionCover",Ha.next="TransitionCoverFromRight",Ha));let Ua,mb;this.Ac.$("TransitionCoverFromRight",(mb=new Tc,
mb.oc=ResourceStrings.L_TransitionFromRight,mb.uc=xc.Ec("TransitionCoverLeft"),mb.tc=(Ua=new sc,Ua.TransitionType=sa.pCa,Ua.Direction=Dc.k8,Ua.Duration=1E3,Ua.IsManualAdvance=!0,Ua),mb.parent="TransitionCover",mb.next="TransitionCoverFromTop",mb));let gb,Cb;this.Ac.$("TransitionCoverFromTop",(Cb=new Tc,Cb.oc=ResourceStrings.L_TransitionFromTop,Cb.uc=xc.Ec("TransitionCoverDown"),Cb.tc=(gb=new sc,gb.TransitionType=sa.pCa,gb.Direction=Dc.tvb,gb.Duration=1E3,gb.IsManualAdvance=!0,gb),Cb.parent="TransitionCover",
Cb.next="TransitionCoverFromLeft",Cb));let zb,Pb;this.Ac.$("TransitionCoverFromLeft",(Pb=new Tc,Pb.oc=ResourceStrings.L_TransitionFromLeft,Pb.uc=xc.Ec("TransitionCoverRight"),Pb.tc=(zb=new sc,zb.TransitionType=sa.pCa,zb.Direction=Dc.wDa,zb.Duration=1E3,zb.IsManualAdvance=!0,zb),Pb.parent="TransitionCover",Pb.next="TransitionCoverFromBottom",Pb));let oc,Ec;this.Ac.$("TransitionCoverFromBottom",(Ec=new Tc,Ec.oc=ResourceStrings.L_TransitionFromBottom,Ec.uc=xc.Ec("TransitionCoverUp"),Ec.tc=(oc=new sc,
oc.TransitionType=sa.pCa,oc.Direction=Dc.ZRa,oc.Duration=1E3,oc.IsManualAdvance=!0,oc),Ec.parent="TransitionCover",Ec.next="TransitionCoverFromTopRight",Ec));let Xc,Ac;this.Ac.$("TransitionCoverFromTopRight",(Ac=new Tc,Ac.oc=ResourceStrings.L_TransitionFromTopRight,Ac.uc=xc.Ec("TransitionCoverLeftDown"),Ac.tc=(Xc=new sc,Xc.TransitionType=sa.pCa,Xc.Direction=Dc.bQc,Xc.Duration=1E3,Xc.IsManualAdvance=!0,Xc),Ac.parent="TransitionCover",Ac.next="TransitionCoverFromBottomRight",Ac));let zd,ue;this.Ac.$("TransitionCoverFromBottomRight",
(ue=new Tc,ue.oc=ResourceStrings.L_TransitionFromBottomRight,ue.uc=xc.Ec("TransitionCoverLeftUp"),ue.tc=(zd=new sc,zd.TransitionType=sa.pCa,zd.Direction=Dc.ZPc,zd.Duration=1E3,zd.IsManualAdvance=!0,zd),ue.parent="TransitionCover",ue.next="TransitionCoverFromTopLeft",ue));let bf,Ce;this.Ac.$("TransitionCoverFromTopLeft",(Ce=new Tc,Ce.oc=ResourceStrings.L_TransitionFromTopLeft,Ce.uc=xc.Ec("TransitionCoverRightDown"),Ce.tc=(bf=new sc,bf.TransitionType=sa.pCa,bf.Direction=Dc.aQc,bf.Duration=1E3,bf.IsManualAdvance=
!0,bf),Ce.parent="TransitionCover",Ce.next="TransitionCoverFromBottomLeft",Ce));let qg,Df;this.Ac.$("TransitionCoverFromBottomLeft",(Df=new Tc,Df.oc=ResourceStrings.L_TransitionFromBottomLeft,Df.uc=xc.Ec("TransitionCoverRightUp"),Df.tc=(qg=new sc,qg.TransitionType=sa.pCa,qg.Direction=Dc.YPc,qg.Duration=1E3,qg.IsManualAdvance=!0,qg),Df.parent="TransitionCover",Df))}if(!Array.contains(ea,"uncover")){let ma,Ha;this.Ac.$("TransitionUncover",(Ha=new Tc,Ha.oc=ResourceStrings.L_TransitionUncover,Ha.uc=xc.Ec("TransitionUncoverLeft"),
Ha.tc=(ma=new sc,ma.TransitionType=sa.QLa,ma.Direction=Dc.k8,ma.Duration=750,ma.IsManualAdvance=!0,ma),Ha.parent="TransitionUncover",Ha.next="TransitionUncoverFromRight",Ha));let Ua,mb;this.Ac.$("TransitionUncoverFromRight",(mb=new Tc,mb.oc=ResourceStrings.L_TransitionFromRight,mb.uc=xc.Ec("TransitionUncoverLeft"),mb.tc=(Ua=new sc,Ua.TransitionType=sa.QLa,Ua.Direction=Dc.k8,Ua.Duration=750,Ua.IsManualAdvance=!0,Ua),mb.parent="TransitionUncover",mb.next="TransitionUncoverFromTop",mb));let gb,Cb;this.Ac.$("TransitionUncoverFromTop",
(Cb=new Tc,Cb.oc=ResourceStrings.L_TransitionFromTop,Cb.uc=xc.Ec("TransitionUncoverDown"),Cb.tc=(gb=new sc,gb.TransitionType=sa.QLa,gb.Direction=Dc.tvb,gb.Duration=750,gb.IsManualAdvance=!0,gb),Cb.parent="TransitionUncover",Cb.next="TransitionUncoverFromLeft",Cb));let zb,Pb;this.Ac.$("TransitionUncoverFromLeft",(Pb=new Tc,Pb.oc=ResourceStrings.L_TransitionFromLeft,Pb.uc=xc.Ec("TransitionUncoverRight"),Pb.tc=(zb=new sc,zb.TransitionType=sa.QLa,zb.Direction=Dc.wDa,zb.Duration=750,zb.IsManualAdvance=
!0,zb),Pb.parent="TransitionUncover",Pb.next="TransitionUncoverFromBottom",Pb));let oc,Ec;this.Ac.$("TransitionUncoverFromBottom",(Ec=new Tc,Ec.oc=ResourceStrings.L_TransitionFromBottom,Ec.uc=xc.Ec("TransitionUncoverUp"),Ec.tc=(oc=new sc,oc.TransitionType=sa.QLa,oc.Direction=Dc.ZRa,oc.Duration=750,oc.IsManualAdvance=!0,oc),Ec.parent="TransitionUncover",Ec.next="TransitionUncoverFromTopRight",Ec));this.Ac.$("TransitionUncoverFromTopRight",Object.assign(new Tc,{oc:ResourceStrings.L_TransitionFromTopRight,
uc:xc.Ec("TransitionUncoverLeftDown"),tc:Object.assign(new sc,{TransitionType:sa.QLa,Direction:Dc.bQc,Duration:750,IsManualAdvance:!0}),parent:"TransitionUncover",next:"TransitionUncoverFromBottomRight"}));this.Ac.$("TransitionUncoverFromBottomRight",Object.assign(new Tc,{oc:ResourceStrings.L_TransitionFromBottomRight,uc:xc.Ec("TransitionUncoverLeftUp"),tc:Object.assign(new sc,{TransitionType:sa.QLa,Direction:Dc.ZPc,Duration:750,IsManualAdvance:!0}),parent:"TransitionUncover",next:"TransitionUncoverFromTopLeft"}));
this.Ac.$("TransitionUncoverFromTopLeft",Object.assign(new Tc,{oc:ResourceStrings.L_TransitionFromTopLeft,uc:xc.Ec("TransitionUncoverRightDown"),tc:Object.assign(new sc,{TransitionType:sa.QLa,Direction:Dc.aQc,Duration:750,IsManualAdvance:!0}),parent:"TransitionUncover",next:"TransitionUncoverFromBottomLeft"}));this.Ac.$("TransitionUncoverFromBottomLeft",Object.assign(new Tc,{oc:ResourceStrings.L_TransitionFromBottomLeft,uc:xc.Ec("TransitionUncoverRightUp"),tc:Object.assign(new sc,{TransitionType:sa.QLa,
Direction:Dc.YPc,Duration:750,IsManualAdvance:!0}),parent:"TransitionUncover"}))}if(!Array.contains(ea,"menusectionexciting")){if(!Array.contains(ea,"fallover")){this.Ac.$("TransitionFallOver",Object.assign(new Tc,{oc:ResourceStrings.L_TransitionFallOver,uc:xc.Ec("TransitionFallOverLeft"),tc:Object.assign(new sc,{TransitionType:sa.u1d,Direction:Dc.none,Duration:2E3,IsManualAdvance:!0}),parent:"TransitionFallOver",next:"TransitionFallOverLeft"}));let ma,Ha;this.Ac.$("TransitionFallOverLeft",(Ha=new Tc,
Ha.oc=ResourceStrings.L_TransitionGoLeft,Ha.uc=xc.Ec("TransitionFallOverLeft"),Ha.tc=(ma=new sc,ma.TransitionType=sa.u1d,ma.Direction=Dc.none,ma.Duration=2E3,ma.IsManualAdvance=!0,ma),Ha.parent="TransitionFallOver",Ha.next="TransitionFallOverRight",Ha));let Ua,mb;this.Ac.$("TransitionFallOverRight",(mb=new Tc,mb.oc=ResourceStrings.L_TransitionGoRight,mb.uc=xc.Ec("TransitionFallOverRight"),mb.tc=(Ua=new sc,Ua.TransitionType=sa.u1d,Ua.Direction=Dc.UTa,Ua.Duration=2E3,Ua.IsManualAdvance=!0,Ua),mb.parent=
"TransitionFallOver",mb))}if(!Array.contains(ea,"drape")){let ma,Ha;this.Ac.$("TransitionDrape",(Ha=new Tc,Ha.oc=ResourceStrings.L_TransitionDrape,Ha.uc=xc.Ec("TransitionDrapeLeft"),Ha.tc=(ma=new sc,ma.TransitionType=sa.d_d,ma.Direction=Dc.none,ma.Duration=2E3,ma.IsManualAdvance=!0,ma),Ha.parent="TransitionDrape",Ha.next="TransitionDrapeLeft",Ha));let Ua,mb;this.Ac.$("TransitionDrapeLeft",(mb=new Tc,mb.oc=ResourceStrings.L_TransitionGoLeft,mb.uc=xc.Ec("TransitionDrapeLeft"),mb.tc=(Ua=new sc,Ua.TransitionType=
sa.d_d,Ua.Direction=Dc.none,Ua.Duration=2E3,Ua.IsManualAdvance=!0,Ua),mb.parent="TransitionDrape",mb.next="TransitionDrapeRight",mb));let gb,Cb;this.Ac.$("TransitionDrapeRight",(Cb=new Tc,Cb.oc=ResourceStrings.L_TransitionGoRight,Cb.uc=xc.Ec("TransitionDrapeRight"),Cb.tc=(gb=new sc,gb.TransitionType=sa.d_d,gb.Direction=Dc.UTa,gb.Duration=2E3,gb.IsManualAdvance=!0,gb),Cb.parent="TransitionDrape",Cb))}if(!Array.contains(ea,"curtains")){let ma,Ha;this.Ac.$("TransitionCurtains",(Ha=new Tc,Ha.oc=ResourceStrings.L_TransitionCurtains,
Ha.uc=xc.Ec("TransitionCurtains"),Ha.tc=(ma=new sc,ma.TransitionType=sa.QHi,ma.Direction=Dc.none,ma.Duration=6E3,ma.IsManualAdvance=!0,ma),Ha.parent="TransitionCurtains",Ha))}if(!Array.contains(ea,"wind")){let ma,Ha;this.Ac.$("TransitionWind",(Ha=new Tc,Ha.oc=ResourceStrings.L_TransitionWind,Ha.uc=xc.Ec("TransitionWindRight"),Ha.tc=(ma=new sc,ma.TransitionType=sa.l4e,ma.Direction=Dc.none,ma.Duration=2E3,ma.IsManualAdvance=!0,ma),Ha.parent="TransitionWind",Ha.next="TransitionWindRight",Ha));let Ua,
mb;this.Ac.$("TransitionWindRight",(mb=new Tc,mb.oc=ResourceStrings.L_TransitionGoRight,mb.uc=xc.Ec("TransitionWindRight"),mb.tc=(Ua=new sc,Ua.TransitionType=sa.l4e,Ua.Direction=Dc.none,Ua.Duration=2E3,Ua.IsManualAdvance=!0,Ua),mb.parent="TransitionWind",mb.next="TransitionWindLeft",mb));let gb,Cb;this.Ac.$("TransitionWindLeft",(Cb=new Tc,Cb.oc=ResourceStrings.L_TransitionGoLeft,Cb.uc=xc.Ec("TransitionWindLeft"),Cb.tc=(gb=new sc,gb.TransitionType=sa.l4e,gb.Direction=Dc.UTa,gb.Duration=2E3,gb.IsManualAdvance=
!0,gb),Cb.parent="TransitionWind",Cb))}if(!Array.contains(ea,"prestige")){let ma,Ha;this.Ac.$("TransitionPrestige",(Ha=new Tc,Ha.oc=ResourceStrings.L_TransitionPrestige,Ha.uc=xc.Ec("TransitionPrestige"),Ha.tc=(ma=new sc,ma.TransitionType=sa.iEk,ma.Direction=Dc.none,ma.Duration=2E3,ma.IsManualAdvance=!0,ma),Ha.parent="TransitionPrestige",Ha))}if(!Array.contains(ea,"fracture")){let ma,Ha;this.Ac.$("TransitionFracture",(Ha=new Tc,Ha.oc=ResourceStrings.L_TransitionFracture,Ha.uc=xc.Ec("TransitionFracture"),
Ha.tc=(ma=new sc,ma.TransitionType=sa.LZi,ma.Direction=Dc.none,ma.Duration=2E3,ma.IsManualAdvance=!0,ma),Ha.parent="TransitionFracture",Ha))}if(!Array.contains(ea,"crush")){let ma,Ha;this.Ac.$("TransitionCrush",(Ha=new Tc,Ha.oc=ResourceStrings.L_TransitionCrush,Ha.uc=xc.Ec("TransitionCrush"),Ha.tc=(ma=new sc,ma.TransitionType=sa.fHi,ma.Direction=Dc.none,ma.Duration=2E3,ma.IsManualAdvance=!0,ma),Ha.parent="TransitionCrush",Ha))}if(!Array.contains(ea,"peeloff")){let ma,Ha;this.Ac.$("TransitionPeelOff",
(Ha=new Tc,Ha.oc=ResourceStrings.L_TransitionPeelOff,Ha.uc=xc.Ec("TransitionPeelOffLeft"),Ha.tc=(ma=new sc,ma.TransitionType=sa.uIe,ma.Direction=Dc.none,ma.Duration=1250,ma.IsManualAdvance=!0,ma),Ha.parent="TransitionPeelOff",Ha.next="TransitionPeelOffLeft",Ha));let Ua,mb;this.Ac.$("TransitionPeelOffLeft",(mb=new Tc,mb.oc=ResourceStrings.L_TransitionGoLeft,mb.uc=xc.Ec("TransitionPeelOffLeft"),mb.tc=(Ua=new sc,Ua.TransitionType=sa.uIe,Ua.Direction=Dc.none,Ua.Duration=1250,Ua.IsManualAdvance=!0,Ua),
mb.parent="TransitionPeelOff",mb.next="TransitionPeelOffRight",mb));let gb,Cb;this.Ac.$("TransitionPeelOffRight",(Cb=new Tc,Cb.oc=ResourceStrings.L_TransitionGoRight,Cb.uc=xc.Ec("TransitionPeelOffRight"),Cb.tc=(gb=new sc,gb.TransitionType=sa.uIe,gb.Direction=Dc.UTa,gb.Duration=1250,gb.IsManualAdvance=!0,gb),Cb.parent="TransitionPeelOff",Cb))}if(!Array.contains(ea,"pagecurl")){let ma,Ha;this.Ac.$("TransitionPageCurl",(Ha=new Tc,Ha.oc=ResourceStrings.L_TransitionPageCurl,Ha.uc=xc.Ec("TransitionTwoPageCurlFromRight"),
Ha.tc=(ma=new sc,ma.TransitionType=sa.QHe,ma.Direction=Dc.none,ma.Duration=1250,ma.IsManualAdvance=!0,ma),Ha.parent="TransitionPageCurl",Ha.next="TransitionPageCurlDoubleLeft",Ha));let Ua,mb;this.Ac.$("TransitionPageCurlDoubleLeft",(mb=new Tc,mb.oc=ResourceStrings.L_TransitionEffectOptionDoubleLeft,mb.uc=xc.Ec("TransitionTwoPageCurlFromRight"),mb.tc=(Ua=new sc,Ua.TransitionType=sa.QHe,Ua.Direction=Dc.none,Ua.Duration=1250,Ua.IsManualAdvance=!0,Ua),mb.parent="TransitionPageCurl",mb.next="TransitionPageCurlDoubleRight",
mb));let gb,Cb;this.Ac.$("TransitionPageCurlDoubleRight",(Cb=new Tc,Cb.oc=ResourceStrings.L_TransitionEffectOptionDoubleRight,Cb.uc=xc.Ec("TransitionTwoPageCurlFromLeft"),Cb.tc=(gb=new sc,gb.TransitionType=sa.QHe,gb.Direction=Dc.UTa,gb.Duration=1250,gb.IsManualAdvance=!0,gb),Cb.parent="TransitionPageCurl",Cb.next="TransitionPageCurlSingleLeft",Cb));let zb,Pb;this.Ac.$("TransitionPageCurlSingleLeft",(Pb=new Tc,Pb.oc=ResourceStrings.L_TransitionEffectOptionSingleLeft,Pb.uc=xc.Ec("TransitionPageCurlFromRight"),
Pb.tc=(zb=new sc,zb.TransitionType=sa.Z7g,zb.Direction=Dc.none,zb.Duration=1250,zb.IsManualAdvance=!0,zb),Pb.parent="TransitionPageCurl",Pb.next="TransitionPageCurlSingleRight",Pb));let oc,Ec;this.Ac.$("TransitionPageCurlSingleRight",(Ec=new Tc,Ec.oc=ResourceStrings.L_TransitionEffectOptionSingleRight,Ec.uc=xc.Ec("TransitionPageCurlFromLeft"),Ec.tc=(oc=new sc,oc.TransitionType=sa.Z7g,oc.Direction=Dc.UTa,oc.Duration=1250,oc.IsManualAdvance=!0,oc),Ec.parent="TransitionPageCurl",Ec))}if(!Array.contains(ea,
"airplane")){let ma,Ha;this.Ac.$("TransitionAirplane",(Ha=new Tc,Ha.oc=ResourceStrings.L_TransitionAirplane,Ha.uc=xc.Ec("TransitionAirplaneRight"),Ha.tc=(ma=new sc,ma.TransitionType=sa.SOd,ma.Direction=Dc.none,ma.Duration=1250,ma.IsManualAdvance=!0,ma),Ha.parent="TransitionAirplane",Ha.next="TransitionAirplaneRight",Ha));let Ua,mb;this.Ac.$("TransitionAirplaneRight",(mb=new Tc,mb.oc=ResourceStrings.L_TransitionGoRight,mb.uc=xc.Ec("TransitionAirplaneRight"),mb.tc=(Ua=new sc,Ua.TransitionType=sa.SOd,
Ua.Direction=Dc.none,Ua.Duration=1250,Ua.IsManualAdvance=!0,Ua),mb.parent="TransitionAirplane",mb.next="TransitionAirplaneLeft",mb));let gb,Cb;this.Ac.$("TransitionAirplaneLeft",(Cb=new Tc,Cb.oc=ResourceStrings.L_TransitionGoLeft,Cb.uc=xc.Ec("TransitionAirplaneLeft"),Cb.tc=(gb=new sc,gb.TransitionType=sa.SOd,gb.Direction=Dc.UTa,gb.Duration=1250,gb.IsManualAdvance=!0,gb),Cb.parent="TransitionAirplane",Cb))}if(!Array.contains(ea,"origami")){let ma,Ha;this.Ac.$("TransitionOrigami",(Ha=new Tc,Ha.oc=ResourceStrings.L_TransitionOrigami,
Ha.uc=xc.Ec("TransitionOrigamiRight"),Ha.tc=(ma=new sc,ma.TransitionType=sa.DHe,ma.Direction=Dc.none,ma.Duration=3250,ma.IsManualAdvance=!0,ma),Ha.parent="TransitionOrigami",Ha.next="TransitionOrigamiRight",Ha));let Ua,mb;this.Ac.$("TransitionOrigamiRight",(mb=new Tc,mb.oc=ResourceStrings.L_TransitionGoRight,mb.uc=xc.Ec("TransitionOrigamiRight"),mb.tc=(Ua=new sc,Ua.TransitionType=sa.DHe,Ua.Direction=Dc.none,Ua.Duration=3250,Ua.IsManualAdvance=!0,Ua),mb.parent="TransitionOrigami",mb.next="TransitionOrigamiLeft",
mb));let gb,Cb;this.Ac.$("TransitionOrigamiLeft",(Cb=new Tc,Cb.oc=ResourceStrings.L_TransitionGoLeft,Cb.uc=xc.Ec("TransitionOrigamiLeft"),Cb.tc=(gb=new sc,gb.TransitionType=sa.DHe,gb.Direction=Dc.UTa,gb.Duration=3250,gb.IsManualAdvance=!0,gb),Cb.parent="TransitionOrigami",Cb))}Array.contains(ea,"dissolve")||this.Ac.$("TransitionDissolve",Object.assign(new Tc,{oc:ResourceStrings.L_TransitionDissolve,uc:xc.Ec("TransitionDissolve"),tc:Object.assign(new sc,{TransitionType:sa.dissolve,Direction:Dc.none,
Duration:1200,IsManualAdvance:!0}),parent:"TransitionDissolve"}));Array.contains(ea,"checker")||(this.Ac.$("TransitionChecker",Object.assign(new Tc,{oc:ResourceStrings.L_TransitionChecker,uc:xc.Ec("TransitionCheckerboardAcross"),tc:Object.assign(new sc,{TransitionType:sa.CTd,Direction:Dc.none,Duration:2500,IsManualAdvance:!0}),parent:"TransitionChecker",next:"TransitionCheckerFromLeft"})),this.Ac.$("TransitionCheckerFromLeft",Object.assign(new Tc,{oc:ResourceStrings.L_TransitionFromLeft,uc:xc.Ec("TransitionCheckerboardAcross"),
tc:Object.assign(new sc,{TransitionType:sa.CTd,Direction:Dc.none,Duration:2500,IsManualAdvance:!0}),parent:"TransitionChecker",next:"TransitionCheckerFromTop"})),this.Ac.$("TransitionCheckerFromTop",Object.assign(new Tc,{oc:ResourceStrings.L_TransitionFromTop,uc:xc.Ec("TransitionCheckerboardDown"),tc:Object.assign(new sc,{TransitionType:sa.CTd,Direction:Dc.Tnj,Duration:2500,IsManualAdvance:!0}),parent:"TransitionChecker"})));if(!Array.contains(ea,"blinds")){this.Ac.$("TransitionBlinds",Object.assign(new Tc,
{oc:ResourceStrings.L_TransitionBlinds,uc:xc.Ec("TransitionBlindsVertical"),tc:Object.assign(new sc,{TransitionType:sa.blinds,Direction:Dc.yxf,Duration:1600,IsManualAdvance:!0}),parent:"TransitionBlinds",next:"TransitionBlindsVertical"}));let ma,Ha;this.Ac.$("TransitionBlindsVertical",(Ha=new Tc,Ha.oc=ResourceStrings.L_TransitionVertical,Ha.uc=xc.Ec("TransitionBlindsVertical"),Ha.tc=(ma=new sc,ma.TransitionType=sa.blinds,ma.Direction=Dc.yxf,ma.Duration=1600,ma.IsManualAdvance=!0,ma),Ha.parent="TransitionBlinds",
Ha.next="TransitionBlindsHorizontal",Ha));let Ua,mb;this.Ac.$("TransitionBlindsHorizontal",(mb=new Tc,mb.oc=ResourceStrings.L_TransitionHorizontal,mb.uc=xc.Ec("TransitionBlindsHorizontal"),mb.tc=(Ua=new sc,Ua.TransitionType=sa.blinds,Ua.Direction=Dc.qhi,Ua.Duration=1600,Ua.IsManualAdvance=!0,Ua),mb.parent="TransitionBlinds",mb))}if(!Array.contains(ea,"wheel")){let ma,Ha;this.Ac.$("TransitionWheel",(Ha=new Tc,Ha.oc=ResourceStrings.L_TransitionWheel,Ha.uc=xc.Ec("TransitionWheelClockwise1"),Ha.tc=(ma=
new sc,ma.TransitionType=sa.wheel,ma.Direction=Dc.wheel,ma.Duration=1E3,ma.IsManualAdvance=!0,ma),Ha.parent="TransitionWheel",Ha.next="TransitionWheelClockwise",Ha));let Ua,mb;this.Ac.$("TransitionWheelClockwise",(mb=new Tc,mb.oc=ResourceStrings.l_TransitionWheelClockWise,mb.uc=xc.Ec("TransitionWheelClockwise1"),mb.tc=(Ua=new sc,Ua.TransitionType=sa.wheel,Ua.Direction=Dc.wheel,Ua.Duration=1E3,Ua.IsManualAdvance=!0,Ua),mb.parent="TransitionWheel",mb.next="TransitionWheelCounterclockwise",mb));let gb,
Cb;this.Ac.$("TransitionWheelCounterclockwise",(Cb=new Tc,Cb.oc=ResourceStrings.l_TransitionWheelCounterClockWise,Cb.uc=xc.Ec("TransitionWheelCounterclockwise1"),Cb.tc=(gb=new sc,gb.TransitionType=sa.CEl,gb.Direction=Dc.wheel,gb.Duration=1E3,gb.IsManualAdvance=!0,gb),Cb.parent="TransitionWheel",Cb.next="TransitionWheelWedge",Cb));let zb,Pb;this.Ac.$("TransitionWheelWedge",(Pb=new Tc,Pb.oc=ResourceStrings.l_TransitionWheelWedge,Pb.uc=xc.Ec("TransitionWedge"),Pb.tc=(zb=new sc,zb.TransitionType=sa.wedge,
zb.Direction=Dc.none,zb.Duration=1E3,zb.IsManualAdvance=!0,zb),Pb.parent="TransitionWheel",Pb))}if(!Array.contains(ea,"ripple")){let ma,Ha;this.Ac.$("TransitionRipple",(Ha=new Tc,Ha.oc=ResourceStrings.L_TransitionRipple,Ha.uc=xc.Ec("TransitionRipple"),Ha.tc=(ma=new sc,ma.TransitionType=sa.bKb,ma.Direction=Dc.nlh,ma.Duration=1400,ma.IsManualAdvance=!0,ma),Ha.parent="TransitionRipple",Ha.next="TransitionRippleCenter",Ha));let Ua,mb;this.Ac.$("TransitionRippleCenter",(mb=new Tc,mb.oc=ResourceStrings.L_EffectOptionsDirectionCenter,
mb.uc=xc.Ec("TransitionRipple"),mb.tc=(Ua=new sc,Ua.TransitionType=sa.bKb,Ua.Direction=Dc.nlh,Ua.Duration=1400,Ua.IsManualAdvance=!0,Ua),mb.parent="TransitionRipple",mb.next="TransitionRippleBottomLeft",mb));let gb,Cb;this.Ac.$("TransitionRippleBottomLeft",(Cb=new Tc,Cb.oc=ResourceStrings.L_TransitionFromBottomLeft,Cb.uc=xc.Ec("TransitionRippleBottomLeft"),Cb.tc=(gb=new sc,gb.TransitionType=sa.bKb,gb.Direction=Dc.YPc,gb.Duration=1500,gb.IsManualAdvance=!0,gb),Cb.parent="TransitionRipple",Cb.next=
"TransitionRippleBottomRight",Cb));let zb,Pb;this.Ac.$("TransitionRippleBottomRight",(Pb=new Tc,Pb.oc=ResourceStrings.L_TransitionFromBottomRight,Pb.uc=xc.Ec("TransitionRippleBottomRight"),Pb.tc=(zb=new sc,zb.TransitionType=sa.bKb,zb.Direction=Dc.ZPc,zb.Duration=1500,zb.IsManualAdvance=!0,zb),Pb.parent="TransitionRipple",Pb.next="TransitionRippleTopRight",Pb));let oc,Ec;this.Ac.$("TransitionRippleTopRight",(Ec=new Tc,Ec.oc=ResourceStrings.L_TransitionFromTopRight,Ec.uc=xc.Ec("TransitionRippleTopRight"),
Ec.tc=(oc=new sc,oc.TransitionType=sa.bKb,oc.Direction=Dc.bQc,oc.Duration=1500,oc.IsManualAdvance=!0,oc),Ec.parent="TransitionRipple",Ec.next="TransitionRippleTopLeft",Ec));let Xc,Ac;this.Ac.$("TransitionRippleTopLeft",(Ac=new Tc,Ac.oc=ResourceStrings.L_TransitionFromTopLeft,Ac.uc=xc.Ec("TransitionRippleTopLeft"),Ac.tc=(Xc=new sc,Xc.TransitionType=sa.bKb,Xc.Direction=Dc.aQc,Xc.Duration=1500,Xc.IsManualAdvance=!0,Xc),Ac.parent="TransitionRipple",Ac))}if(!Array.contains(ea,"glitter")){let ma,Ha;this.Ac.$("TransitionGlitter",
(Ha=new Tc,Ha.oc=ResourceStrings.L_TransitionGlitter,Ha.uc=xc.Ec("TransitionGlitterHexagonLeft"),Ha.tc=(ma=new sc,ma.TransitionType=sa.mEa,ma.Direction=Dc.cWf,ma.Duration=3900,ma.IsManualAdvance=!0,ma),Ha.parent="TransitionGlitter",Ha.next="TransitionGlitterHexagonLeft",Ha));let Ua,mb;this.Ac.$("TransitionGlitterHexagonLeft",(mb=new Tc,mb.oc=ResourceStrings.L_TransitionHexagonsFromLeft,mb.uc=xc.Ec("TransitionGlitterHexagonLeft"),mb.tc=(Ua=new sc,Ua.TransitionType=sa.mEa,Ua.Direction=Dc.cWf,Ua.Duration=
3900,Ua.IsManualAdvance=!0,Ua),mb.parent="TransitionGlitter",mb.next="TransitionGlitterHexagonTop",mb));let gb,Cb;this.Ac.$("TransitionGlitterHexagonTop",(Cb=new Tc,Cb.oc=ResourceStrings.L_TransitionHexagonsFromTop,Cb.uc=xc.Ec("TransitionGlitterHexagonTop"),Cb.tc=(gb=new sc,gb.TransitionType=sa.mEa,gb.Direction=Dc.x_i,gb.Duration=3900,gb.IsManualAdvance=!0,gb),Cb.parent="TransitionGlitter",Cb.next="TransitionGlitterHexagonRight",Cb));let zb,Pb;this.Ac.$("TransitionGlitterHexagonRight",(Pb=new Tc,
Pb.oc=ResourceStrings.L_TransitionHexagonsFromRight,Pb.uc=xc.Ec("TransitionGlitterHexagonRight"),Pb.tc=(zb=new sc,zb.TransitionType=sa.mEa,zb.Direction=Dc.r_i,zb.Duration=3900,zb.IsManualAdvance=!0,zb),Pb.parent="TransitionGlitter",Pb.next="TransitionGlitterHexagonBottom",Pb));let oc,Ec;this.Ac.$("TransitionGlitterHexagonBottom",(Ec=new Tc,Ec.oc=ResourceStrings.L_TransitionHexagonsFromBottom,Ec.uc=xc.Ec("TransitionGlitterHexagonBottom"),Ec.tc=(oc=new sc,oc.TransitionType=sa.mEa,oc.Direction=Dc.e_i,
oc.Duration=3900,oc.IsManualAdvance=!0,oc),Ec.parent="TransitionGlitter",Ec.next="TransitionGlitterDiamondLeft",Ec));let Xc,Ac;this.Ac.$("TransitionGlitterDiamondLeft",(Ac=new Tc,Ac.oc=ResourceStrings.L_TransitionDiamondsFromLeft,Ac.uc=xc.Ec("TransitionGlitterDiamondLeft"),Ac.tc=(Xc=new sc,Xc.TransitionType=sa.mEa,Xc.Direction=Dc.m_i,Xc.Duration=3900,Xc.IsManualAdvance=!0,Xc),Ac.parent="TransitionGlitter",Ac.next="TransitionGlitterDiamondTop",Ac));let zd,ue;this.Ac.$("TransitionGlitterDiamondTop",
(ue=new Tc,ue.oc=ResourceStrings.L_TransitionDiamondsFromTop,ue.uc=xc.Ec("TransitionGlitterDiamondTop"),ue.tc=(zd=new sc,zd.TransitionType=sa.mEa,zd.Direction=Dc.w_i,zd.Duration=3900,zd.IsManualAdvance=!0,zd),ue.parent="TransitionGlitter",ue.next="TransitionGlitterDiamondRight",ue));let bf,Ce;this.Ac.$("TransitionGlitterDiamondRight",(Ce=new Tc,Ce.oc=ResourceStrings.L_TransitionDiamondsFromRight,Ce.uc=xc.Ec("TransitionGlitterDiamondRight"),Ce.tc=(bf=new sc,bf.TransitionType=sa.mEa,bf.Direction=Dc.q_i,
bf.Duration=3900,bf.IsManualAdvance=!0,bf),Ce.parent="TransitionGlitter",Ce.next="TransitionGlitterDiamondBottom",Ce));let qg,Df;this.Ac.$("TransitionGlitterDiamondBottom",(Df=new Tc,Df.oc=ResourceStrings.L_TransitionDiamondsFromBottom,Df.uc=xc.Ec("TransitionGlitterDiamondBottom"),Df.tc=(qg=new sc,qg.TransitionType=sa.mEa,qg.Direction=Dc.d_i,qg.Duration=3900,qg.IsManualAdvance=!0,qg),Df.parent="TransitionGlitter",Df))}if(!Array.contains(ea,"vortex")){let ma,Ha;this.Ac.$("TransitionVortex",(Ha=new Tc,
Ha.oc=ResourceStrings.L_TransitionVortex,Ha.uc=xc.Ec("TransitionVortexFromLeft"),Ha.tc=(ma=new sc,ma.TransitionType=sa.muc,ma.Direction=Dc.wDa,ma.Duration=4E3,ma.IsManualAdvance=!0,ma),Ha.parent="TransitionVortex",Ha.next="TransitionVortexFromLeft",Ha));let Ua,mb;this.Ac.$("TransitionVortexFromLeft",(mb=new Tc,mb.oc=ResourceStrings.L_TransitionFromLeft,mb.uc=xc.Ec("TransitionVortexFromLeft"),mb.tc=(Ua=new sc,Ua.TransitionType=sa.muc,Ua.Direction=Dc.wDa,Ua.Duration=4E3,Ua.IsManualAdvance=!0,Ua),mb.parent=
"TransitionVortex",mb.next="TransitionVortexFromTop",mb));let gb,Cb;this.Ac.$("TransitionVortexFromTop",(Cb=new Tc,Cb.oc=ResourceStrings.L_TransitionFromTop,Cb.uc=xc.Ec("TransitionVortexFromTop"),Cb.tc=(gb=new sc,gb.TransitionType=sa.muc,gb.Direction=Dc.tvb,gb.Duration=4E3,gb.IsManualAdvance=!0,gb),Cb.parent="TransitionVortex",Cb.next="TransitionVortexFromRight",Cb));let zb,Pb;this.Ac.$("TransitionVortexFromRight",(Pb=new Tc,Pb.oc=ResourceStrings.L_TransitionFromRight,Pb.uc=xc.Ec("TransitionVortexFromRight"),
Pb.tc=(zb=new sc,zb.TransitionType=sa.muc,zb.Direction=Dc.k8,zb.Duration=4E3,zb.IsManualAdvance=!0,zb),Pb.parent="TransitionVortex",Pb.next="TransitionVortexFromBottom",Pb));let oc,Ec;this.Ac.$("TransitionVortexFromBottom",(Ec=new Tc,Ec.oc=ResourceStrings.L_TransitionFromBottom,Ec.uc=xc.Ec("TransitionVortexFromBottom"),Ec.tc=(oc=new sc,oc.TransitionType=sa.muc,oc.Direction=Dc.ZRa,oc.Duration=4E3,oc.IsManualAdvance=!0,oc),Ec.parent="TransitionVortex",Ec))}Array.contains(ea,"switch")||(this.Ac.$("TransitionSwitch",
Object.assign(new Tc,{oc:ResourceStrings.L_TransitionSwitch,uc:xc.Ec("TransitionSwitchRight"),tc:Object.assign(new sc,{TransitionType:sa.sZe,Direction:Dc.iUc,Duration:1250,IsManualAdvance:!0}),parent:"TransitionSwitch",next:"TransitionSwitchRight"})),this.Ac.$("TransitionSwitchRight",Object.assign(new Tc,{oc:ResourceStrings.L_TransitionGoRight,uc:xc.Ec("TransitionSwitchRight"),tc:Object.assign(new sc,{TransitionType:sa.sZe,Direction:Dc.iUc,Duration:1250,IsManualAdvance:!0}),parent:"TransitionSwitch",
next:"TransitionSwitchLeft"})),this.Ac.$("TransitionSwitchLeft",Object.assign(new Tc,{oc:ResourceStrings.L_TransitionGoLeft,uc:xc.Ec("TransitionSwitchLeft"),tc:Object.assign(new sc,{TransitionType:sa.sZe,Direction:Dc.none,Duration:1250,IsManualAdvance:!0}),parent:"TransitionSwitch"})));if(!Array.contains(ea,"flip")){this.Ac.$("TransitionFlip",Object.assign(new Tc,{oc:ResourceStrings.L_TransitionFlip,uc:xc.Ec("TransitionFlipRight"),tc:Object.assign(new sc,{TransitionType:sa.flip,Direction:Dc.iUc,Duration:1250,
IsManualAdvance:!0}),parent:"TransitionFlip",next:"TransitionFlipRight"}));this.Ac.$("TransitionFlipRight",Object.assign(new Tc,{oc:ResourceStrings.L_TransitionGoRight,uc:xc.Ec("TransitionFlipRight"),tc:Object.assign(new sc,{TransitionType:sa.flip,Direction:Dc.iUc,Duration:1250,IsManualAdvance:!0}),parent:"TransitionFlip",next:"TransitionFlipLeft"}));let ma,Ha;this.Ac.$("TransitionFlipLeft",(Ha=new Tc,Ha.oc=ResourceStrings.L_TransitionGoLeft,Ha.uc=xc.Ec("TransitionFlipLeft"),Ha.tc=(ma=new sc,ma.TransitionType=
sa.flip,ma.Direction=Dc.none,ma.Duration=1250,ma.IsManualAdvance=!0,ma),Ha.parent="TransitionFlip",Ha))}if(!Array.contains(ea,"galleryicon")){let ma,Ha;this.Ac.$("TransitionGalleryIcon",(Ha=new Tc,Ha.oc=ResourceStrings.L_TransitionGallery,Ha.uc=xc.Ec("TransitionGalleryRight"),Ha.tc=(ma=new sc,ma.TransitionType=sa.B3d,ma.Direction=Dc.k8,ma.Duration=1600,ma.IsManualAdvance=!0,ma),Ha.parent="TransitionGalleryIcon",Ha.next="TransitionGalleryIconFromRight",Ha));let Ua,mb;this.Ac.$("TransitionGalleryIconFromRight",
(mb=new Tc,mb.oc=ResourceStrings.L_TransitionFromRight,mb.uc=xc.Ec("TransitionGalleryRight"),mb.tc=(Ua=new sc,Ua.TransitionType=sa.B3d,Ua.Direction=Dc.k8,Ua.Duration=1600,Ua.IsManualAdvance=!0,Ua),mb.parent="TransitionGalleryIcon",mb.next="TransitionGalleryIconFromLeft",mb));let gb,Cb;this.Ac.$("TransitionGalleryIconFromLeft",(Cb=new Tc,Cb.oc=ResourceStrings.L_TransitionFromLeft,Cb.uc=xc.Ec("TransitionGalleryLeft"),Cb.tc=(gb=new sc,gb.TransitionType=sa.B3d,gb.Direction=Dc.wDa,gb.Duration=1600,gb.IsManualAdvance=
!0,gb),Cb.parent="TransitionGalleryIcon",Cb))}if(!Array.contains(ea,"cube")){let ma,Ha;this.Ac.$("TransitionCube",(Ha=new Tc,Ha.oc=ResourceStrings.L_TransitionCube,Ha.uc=xc.Ec("TransitionCubeFromRight"),Ha.tc=(ma=new sc,ma.TransitionType=sa.rM,ma.Direction=Dc.hWf,ma.Duration=1200,ma.IsManualAdvance=!0,ma),Ha.parent="TransitionCube",Ha.next="TransitionCubeFromRight",Ha));let Ua,mb;this.Ac.$("TransitionCubeFromRight",(mb=new Tc,mb.oc=ResourceStrings.L_TransitionFromRight,mb.uc=xc.Ec("TransitionCubeFromRight"),
mb.tc=(Ua=new sc,Ua.TransitionType=sa.rM,Ua.Direction=Dc.hWf,Ua.Duration=1200,Ua.IsManualAdvance=!0,Ua),mb.parent="TransitionCube",mb.next="TransitionCubeFromBottom",mb));let gb,Cb;this.Ac.$("TransitionCubeFromBottom",(Cb=new Tc,Cb.oc=ResourceStrings.L_TransitionFromBottom,Cb.uc=xc.Ec("TransitionCubeFromBottom"),Cb.tc=(gb=new sc,gb.TransitionType=sa.rM,gb.Direction=Dc.c_i,gb.Duration=1200,gb.IsManualAdvance=!0,gb),Cb.parent="TransitionCube",Cb.next="TransitionCubeFromLeft",Cb));let zb,Pb;this.Ac.$("TransitionCubeFromLeft",
(Pb=new Tc,Pb.oc=ResourceStrings.L_TransitionFromLeft,Pb.uc=xc.Ec("TransitionCubeFromLeft"),Pb.tc=(zb=new sc,zb.TransitionType=sa.rM,zb.Direction=Dc.l_i,zb.Duration=1200,zb.IsManualAdvance=!0,zb),Pb.parent="TransitionCube",Pb.next="TransitionCubeFromTop",Pb));let oc,Ec;this.Ac.$("TransitionCubeFromTop",(Ec=new Tc,Ec.oc=ResourceStrings.L_TransitionFromTop,Ec.uc=xc.Ec("TransitionCubeFromTop"),Ec.tc=(oc=new sc,oc.TransitionType=sa.rM,oc.Direction=Dc.v_i,oc.Duration=1200,oc.IsManualAdvance=!0,oc),Ec.parent=
"TransitionCube",Ec))}if(!Array.contains(ea,"doors")){let ma,Ha;this.Ac.$("TransitionDoors",(Ha=new Tc,Ha.oc=ResourceStrings.L_TransitionDoors,Ha.uc=xc.Ec("TransitionDoorsVertical"),Ha.tc=(ma=new sc,ma.TransitionType=sa.WZd,ma.Direction=Dc.X9a,ma.Duration=1400,ma.IsManualAdvance=!0,ma),Ha.parent="TransitionDoors",Ha.next="TransitionDoorsVertical",Ha));let Ua,mb;this.Ac.$("TransitionDoorsVertical",(mb=new Tc,mb.oc=ResourceStrings.L_TransitionVertical,mb.uc=xc.Ec("TransitionDoorsVertical"),mb.tc=(Ua=
new sc,Ua.TransitionType=sa.WZd,Ua.Direction=Dc.X9a,Ua.Duration=1400,Ua.IsManualAdvance=!0,Ua),mb.parent="TransitionDoors",mb.next="TransitionDoorsHorizontal",mb));let gb,Cb;this.Ac.$("TransitionDoorsHorizontal",(Cb=new Tc,Cb.oc=ResourceStrings.L_TransitionHorizontal,Cb.uc=xc.Ec("TransitionDoorsHorizontal"),Cb.tc=(gb=new sc,gb.TransitionType=sa.WZd,gb.Direction=Dc.hUc,gb.Duration=1400,gb.IsManualAdvance=!0,gb),Cb.parent="TransitionDoors",Cb))}if(!Array.contains(ea,"box")){let ma,Ha;this.Ac.$("TransitionBox",
(Ha=new Tc,Ha.oc=ResourceStrings.L_TransitionBox,Ha.uc=xc.Ec("TransitionBoxFromRight"),Ha.tc=(ma=new sc,ma.TransitionType=sa.rM,ma.Direction=Dc.gWf,ma.Duration=1600,ma.IsManualAdvance=!0,ma),Ha.parent="TransitionBox",Ha.next="TransitionBoxFromRight",Ha));let Ua,mb;this.Ac.$("TransitionBoxFromRight",(mb=new Tc,mb.oc=ResourceStrings.L_TransitionFromRight,mb.uc=xc.Ec("TransitionBoxFromRight"),mb.tc=(Ua=new sc,Ua.TransitionType=sa.rM,Ua.Direction=Dc.gWf,Ua.Duration=1600,Ua.IsManualAdvance=!0,Ua),mb.parent=
"TransitionBox",mb.next="TransitionBoxFromBottom",mb));let gb,Cb;this.Ac.$("TransitionBoxFromBottom",(Cb=new Tc,Cb.oc=ResourceStrings.L_TransitionFromBottom,Cb.uc=xc.Ec("TransitionBoxFromBottom"),Cb.tc=(gb=new sc,gb.TransitionType=sa.rM,gb.Direction=Dc.b_i,gb.Duration=1600,gb.IsManualAdvance=!0,gb),Cb.parent="TransitionBox",Cb.next="TransitionBoxFromLeft",Cb));let zb,Pb;this.Ac.$("TransitionBoxFromLeft",(Pb=new Tc,Pb.oc=ResourceStrings.L_TransitionFromLeft,Pb.uc=xc.Ec("TransitionBoxFromLeft"),Pb.tc=
(zb=new sc,zb.TransitionType=sa.rM,zb.Direction=Dc.k_i,zb.Duration=1600,zb.IsManualAdvance=!0,zb),Pb.parent="TransitionBox",Pb.next="TransitionBoxFromTop",Pb));let oc,Ec;this.Ac.$("TransitionBoxFromTop",(Ec=new Tc,Ec.oc=ResourceStrings.L_TransitionFromTop,Ec.uc=xc.Ec("TransitionBoxFromTop"),Ec.tc=(oc=new sc,oc.TransitionType=sa.rM,oc.Direction=Dc.u_i,oc.Duration=1600,oc.IsManualAdvance=!0,oc),Ec.parent="TransitionBox",Ec))}if(!Array.contains(ea,"comb")){let ma,Ha;this.Ac.$("TransitionComb",(Ha=new Tc,
Ha.oc=ResourceStrings.L_TransitionComb,Ha.uc=xc.Ec("TransitionCombHorizontal"),Ha.tc=(ma=new sc,ma.TransitionType=sa.wUd,ma.Direction=Dc.none,ma.Duration=1E3,ma.IsManualAdvance=!0,ma),Ha.parent="TransitionComb",Ha.next="TransitionCombHorizontal",Ha));let Ua,mb;this.Ac.$("TransitionCombHorizontal",(mb=new Tc,mb.oc=ResourceStrings.L_TransitionHorizontal,mb.uc=xc.Ec("TransitionCombHorizontal"),mb.tc=(Ua=new sc,Ua.TransitionType=sa.wUd,Ua.Direction=Dc.hUc,Ua.Duration=1E3,Ua.IsManualAdvance=!0,Ua),mb.parent=
"TransitionComb",mb.next="TransitionCombVertical",mb));let gb,Cb;this.Ac.$("TransitionCombVertical",(Cb=new Tc,Cb.oc=ResourceStrings.L_TransitionVertical,Cb.uc=xc.Ec("TransitionCombVertical"),Cb.tc=(gb=new sc,gb.TransitionType=sa.wUd,gb.Direction=Dc.X9a,gb.Duration=1E3,gb.IsManualAdvance=!0,gb),Cb.parent="TransitionComb",Cb))}if(!Array.contains(ea,"zoom")){let ma,Ha;this.Ac.$("TransitionZoom",(Ha=new Tc,Ha.oc=ResourceStrings.L_TransitionZoom,Ha.uc=xc.Ec("TransitionZoomIn"),Ha.tc=(ma=new sc,ma.TransitionType=
sa.zoom,ma.Direction=Dc.k6b,ma.Duration=900,ma.IsManualAdvance=!0,ma),Ha.parent="TransitionZoom",Ha.next="TransitionZoomIn",Ha));let Ua,mb;this.Ac.$("TransitionZoomIn",(mb=new Tc,mb.oc=ResourceStrings.L_TransitionIn,mb.uc=xc.Ec("TransitionZoomIn"),mb.tc=(Ua=new sc,Ua.TransitionType=sa.zoom,Ua.Direction=Dc.k6b,Ua.Duration=900,Ua.IsManualAdvance=!0,Ua),mb.parent="TransitionZoom",mb.next="TransitionZoomOut",mb));let gb,Cb;this.Ac.$("TransitionZoomOut",(Cb=new Tc,Cb.oc=ResourceStrings.L_TransitionOut,
Cb.uc=xc.Ec("TransitionZoomOut"),Cb.tc=(gb=new sc,gb.TransitionType=sa.zoom,gb.Direction=Dc.m$d,gb.Duration=900,gb.IsManualAdvance=!0,gb),Cb.parent="TransitionZoom",Cb.next="TransitionZoomAndRotate",Cb));let zb,Pb;this.Ac.$("TransitionZoomAndRotate",(Pb=new Tc,Pb.oc=ResourceStrings.L_TransitionZoomAndRotate,Pb.uc=xc.Ec("TransitionNewsFlash"),Pb.tc=(zb=new sc,zb.TransitionType=sa.RFl,zb.Direction=Dc.none,zb.Duration=1500,zb.IsManualAdvance=!0,zb),Pb.parent="TransitionZoom",Pb))}if(!Array.contains(ea,
"random")){let ma,Ha;this.Ac.$("TransitionRandom",(Ha=new Tc,Ha.oc=ResourceStrings.L_TransitionRandom,Ha.uc=xc.Ec("TransitionRandom"),Ha.tc=(ma=new sc,ma.TransitionType=sa.random,ma.Direction=Dc.doj,ma.Duration=1500,ma.IsManualAdvance=!0,ma),Ha.parent="TransitionRandom",Ha))}}if(!Array.contains(ea,"menusectiondynamiccontent")){if(!Array.contains(ea,"pan")){let ma,Ha;this.Ac.$("TransitionPan",(Ha=new Tc,Ha.oc=ResourceStrings.L_TransitionPan,Ha.uc=xc.Ec("TransitionPanFromBottom"),Ha.tc=(ma=new sc,ma.TransitionType=
sa.pan,ma.Direction=Dc.ZRa,ma.Duration=1300,ma.IsManualAdvance=!0,ma),Ha.parent="TransitionPan",Ha.next="TransitionPanFromBottom",Ha));this.Ac.$("TransitionPanFromBottom",Object.assign(new Tc,{oc:ResourceStrings.L_TransitionFromBottom,uc:xc.Ec("TransitionPanFromBottom"),tc:Object.assign(new sc,{TransitionType:sa.pan,Direction:Dc.ZRa,Duration:1300,IsManualAdvance:!0}),parent:"TransitionPan",next:"TransitionPanFromLeft"}));this.Ac.$("TransitionPanFromLeft",Object.assign(new Tc,{oc:ResourceStrings.L_TransitionFromLeft,
uc:xc.Ec("TransitionPanFromLeft"),tc:Object.assign(new sc,{TransitionType:sa.pan,Direction:Dc.wDa,Duration:1300,IsManualAdvance:!0}),parent:"TransitionPan",next:"TransitionPanFromRight"}));this.Ac.$("TransitionPanFromRight",Object.assign(new Tc,{oc:ResourceStrings.L_TransitionFromRight,uc:xc.Ec("TransitionPanFromRight"),tc:Object.assign(new sc,{TransitionType:sa.pan,Direction:Dc.k8,Duration:1300,IsManualAdvance:!0}),parent:"TransitionPan",next:"TransitionPanFromTop"}));this.Ac.$("TransitionPanFromTop",
Object.assign(new Tc,{oc:ResourceStrings.L_TransitionFromTop,uc:xc.Ec("TransitionPanFromTop"),tc:Object.assign(new sc,{TransitionType:sa.pan,Direction:Dc.tvb,Duration:1300,IsManualAdvance:!0}),parent:"TransitionPan"}))}if(!Array.contains(ea,"conveyor")){this.Ac.$("TransitionConveyor",Object.assign(new Tc,{oc:ResourceStrings.L_TransitionConveyor,uc:xc.Ec("TransitionConveyorRight"),tc:Object.assign(new sc,{TransitionType:sa.KVd,Direction:Dc.k8,Duration:1600,IsManualAdvance:!0}),parent:"TransitionConveyor",
next:"TransitionConveyorFromRight"}));let ma,Ha;this.Ac.$("TransitionConveyorFromRight",(Ha=new Tc,Ha.oc=ResourceStrings.L_TransitionFromRight,Ha.uc=xc.Ec("TransitionConveyorRight"),Ha.tc=(ma=new sc,ma.TransitionType=sa.KVd,ma.Direction=Dc.k8,ma.Duration=1600,ma.IsManualAdvance=!0,ma),Ha.parent="TransitionConveyor",Ha.next="TransitionConveyorFromLeft",Ha));let Ua,mb;this.Ac.$("TransitionConveyorFromLeft",(mb=new Tc,mb.oc=ResourceStrings.L_TransitionFromLeft,mb.uc=xc.Ec("TransitionConveyorLeft"),mb.tc=
(Ua=new sc,Ua.TransitionType=sa.KVd,Ua.Direction=Dc.wDa,Ua.Duration=1600,Ua.IsManualAdvance=!0,Ua),mb.parent="TransitionConveyor",mb))}if(!Array.contains(ea,"rotate")){let ma,Ha;this.Ac.$("TransitionRotate",(Ha=new Tc,Ha.oc=ResourceStrings.L_TransitionRotate,Ha.uc=xc.Ec("TransitionRotateLeft"),Ha.tc=(ma=new sc,ma.TransitionType=sa.rM,ma.Direction=Dc.jWf,ma.Duration=2E3,ma.IsManualAdvance=!0,ma),Ha.parent="TransitionRotate",Ha.next="TransitionRotateFromRight",Ha));let Ua,mb;this.Ac.$("TransitionRotateFromRight",
(mb=new Tc,mb.oc=ResourceStrings.L_TransitionFromRight,mb.uc=xc.Ec("TransitionRotateLeft"),mb.tc=(Ua=new sc,Ua.TransitionType=sa.rM,Ua.Direction=Dc.jWf,Ua.Duration=2E3,Ua.IsManualAdvance=!0,Ua),mb.parent="TransitionRotate",mb.next="TransitionRotateFromBottom",mb));let gb,Cb;this.Ac.$("TransitionRotateFromBottom",(Cb=new Tc,Cb.oc=ResourceStrings.L_TransitionFromBottom,Cb.uc=xc.Ec("TransitionRotateTop"),Cb.tc=(gb=new sc,gb.TransitionType=sa.rM,gb.Direction=Dc.g_i,gb.Duration=2E3,gb.IsManualAdvance=
!0,gb),Cb.parent="TransitionRotate",Cb.next="TransitionRotateFromLeft",Cb));let zb,Pb;this.Ac.$("TransitionRotateFromLeft",(Pb=new Tc,Pb.oc=ResourceStrings.L_TransitionFromLeft,Pb.uc=xc.Ec("TransitionRotateRight"),Pb.tc=(zb=new sc,zb.TransitionType=sa.rM,zb.Direction=Dc.o_i,zb.Duration=2E3,zb.IsManualAdvance=!0,zb),Pb.parent="TransitionRotate",Pb.next="TransitionRotateFromTop",Pb));let oc,Ec;this.Ac.$("TransitionRotateFromTop",(Ec=new Tc,Ec.oc=ResourceStrings.L_TransitionFromTop,Ec.uc=xc.Ec("TransitionRotateBottom"),
Ec.tc=(oc=new sc,oc.TransitionType=sa.rM,oc.Direction=Dc.z_i,oc.Duration=2E3,oc.IsManualAdvance=!0,oc),Ec.parent="TransitionRotate",Ec))}if(!Array.contains(ea,"window")){let ma,Ha;this.Ac.$("TransitionWindow",(Ha=new Tc,Ha.oc=ResourceStrings.L_TransitionWindow,Ha.uc=xc.Ec("TransitionWindowVertical"),Ha.tc=(ma=new sc,ma.TransitionType=sa.window,ma.Direction=Dc.X9a,ma.Duration=1500,ma.IsManualAdvance=!0,ma),Ha.parent="TransitionWindow",Ha.next="TransitionWindowVertical",Ha));let Ua,mb;this.Ac.$("TransitionWindowVertical",
(mb=new Tc,mb.oc=ResourceStrings.L_TransitionVertical,mb.uc=xc.Ec("TransitionWindowVertical"),mb.tc=(Ua=new sc,Ua.TransitionType=sa.window,Ua.Direction=Dc.X9a,Ua.Duration=1500,Ua.IsManualAdvance=!0,Ua),mb.parent="TransitionWindow",mb.next="TransitionWindowHorizontal",mb));let gb,Cb;this.Ac.$("TransitionWindowHorizontal",(Cb=new Tc,Cb.oc=ResourceStrings.L_TransitionHorizontal,Cb.uc=xc.Ec("TransitionWindowHorizontal"),Cb.tc=(gb=new sc,gb.TransitionType=sa.window,gb.Direction=Dc.hUc,gb.Duration=1500,
gb.IsManualAdvance=!0,gb),Cb.parent="TransitionWindow",Cb))}if(!Array.contains(ea,"orbit")){let ma,Ha;this.Ac.$("TransitionOrbit",(Ha=new Tc,Ha.oc=ResourceStrings.L_TransitionOrbit,Ha.uc=xc.Ec("TransitionOrbitFromRight"),Ha.tc=(ma=new sc,ma.TransitionType=sa.rM,ma.Direction=Dc.iWf,ma.Duration=1600,ma.IsManualAdvance=!0,ma),Ha.parent="TransitionOrbit",Ha.next="TransitionOrbitFromRight",Ha));let Ua,mb;this.Ac.$("TransitionOrbitFromRight",(mb=new Tc,mb.oc=ResourceStrings.L_TransitionFromRight,mb.uc=
xc.Ec("TransitionOrbitFromRight"),mb.tc=(Ua=new sc,Ua.TransitionType=sa.rM,Ua.Direction=Dc.iWf,Ua.Duration=1600,Ua.IsManualAdvance=!0,Ua),mb.parent="TransitionOrbit",mb.next="TransitionOrbitFromBottom",mb));let gb,Cb;this.Ac.$("TransitionOrbitFromBottom",(Cb=new Tc,Cb.oc=ResourceStrings.L_TransitionFromBottom,Cb.uc=xc.Ec("TransitionOrbitFromBottom"),Cb.tc=(gb=new sc,gb.TransitionType=sa.rM,gb.Direction=Dc.f_i,gb.Duration=1600,gb.IsManualAdvance=!0,gb),Cb.parent="TransitionOrbit",Cb.next="TransitionOrbitFromLeft",
Cb));let zb,Pb;this.Ac.$("TransitionOrbitFromLeft",(Pb=new Tc,Pb.oc=ResourceStrings.L_TransitionFromLeft,Pb.uc=xc.Ec("TransitionOrbitFromLeft"),Pb.tc=(zb=new sc,zb.TransitionType=sa.rM,zb.Direction=Dc.n_i,zb.Duration=1600,zb.IsManualAdvance=!0,zb),Pb.parent="TransitionOrbit",Pb.next="TransitionOrbitFromTop",Pb));let oc,Ec;this.Ac.$("TransitionOrbitFromTop",(Ec=new Tc,Ec.oc=ResourceStrings.L_TransitionFromTop,Ec.uc=xc.Ec("TransitionOrbitFromTop"),Ec.tc=(oc=new sc,oc.TransitionType=sa.rM,oc.Direction=
Dc.y_i,oc.Duration=1600,oc.IsManualAdvance=!0,oc),Ec.parent="TransitionOrbit",Ec))}if(!Array.contains(ea,"flythrough")){let ma,Ha;this.Ac.$("TransitionFlyThrough",(Ha=new Tc,Ha.oc=ResourceStrings.L_TransitionFlyThrough,Ha.uc=xc.Ec("TransitionFlyThroughIn"),Ha.tc=(ma=new sc,ma.TransitionType=sa.L3b,ma.Direction=Dc.k6b,ma.Duration=800,ma.IsManualAdvance=!0,ma),Ha.parent="TransitionFlyThrough",Ha.next="TransitionFlyThroughIn",Ha));let Ua,mb;this.Ac.$("TransitionFlyThroughIn",(mb=new Tc,mb.oc=ResourceStrings.L_TransitionIn,
mb.uc=xc.Ec("TransitionFlyThroughIn"),mb.tc=(Ua=new sc,Ua.TransitionType=sa.L3b,Ua.Direction=Dc.k6b,Ua.Duration=800,Ua.IsManualAdvance=!0,Ua),mb.parent="TransitionFlyThrough",mb.next="TransitionFlyThroughOut",mb));let gb,Cb;this.Ac.$("TransitionFlyThroughOut",(Cb=new Tc,Cb.oc=ResourceStrings.L_TransitionOut,Cb.uc=xc.Ec("TransitionFlyThroughOut"),Cb.tc=(gb=new sc,gb.TransitionType=sa.L3b,gb.Direction=Dc.m$d,gb.Duration=800,gb.IsManualAdvance=!0,gb),Cb.parent="TransitionFlyThrough",Cb.next="TransitionFlyThroughInWithBounce",
Cb));let zb,Pb;this.Ac.$("TransitionFlyThroughInWithBounce",(Pb=new Tc,Pb.oc=ResourceStrings.L_TransitionInWithBounce,Pb.uc=xc.Ec("TransitionFlyThroughIn"),Pb.tc=(zb=new sc,zb.TransitionType=sa.L3b,zb.Direction=Dc.LYi,zb.Duration=900,zb.IsManualAdvance=!0,zb),Pb.parent="TransitionFlyThrough",Pb.next="TransitionFlyThroughOutWithBounce",Pb));let oc,Ec;this.Ac.$("TransitionFlyThroughOutWithBounce",(Ec=new Tc,Ec.oc=ResourceStrings.L_TransitionOutWithBounce,Ec.uc=xc.Ec("TransitionFlyThroughOut"),Ec.tc=
(oc=new sc,oc.TransitionType=sa.L3b,oc.Direction=Dc.MYi,oc.Duration=900,oc.IsManualAdvance=!0,oc),Ec.parent="TransitionFlyThrough",Ec))}}this.Ac.forEach((ma,Ha)=>{ma===Ha.parent&&++N;return!0})}WSa(f){let x=null;f?this.Ac.forEach((N,ea)=>{ea.tc&&ea.tc.TransitionType===f.TransitionType&&ea.tc.Direction===f.Direction&&(x=N);return!0}):x="TransitionNone";return x}uQ(f){return this.Ac.ga(f)}Wwb(f){return(f=this.WSa(f))?this.Ac.ga(this.Ac.ga(f).parent):null}XSa(f){return(f=this.WSa(f))?this.Ac.ga(f).parent:
null}U1f(f){let x,N=null;x=null;f&&f.next&&(x=f.next,N=this.uQ(x));return{returnValue:N,key:x}}iwb(){var f=[xc.K_i,xc.uLk,xc.vLk];for(const x of f)if(f=document.getElementById(x))return f;return null}A_c(f,x){return f&&x&&x.childNodes?f.startsWith(xc.L_i)?x.contains(document.getElementById(f)):!1:!x&&f?"TransitionExisting"===f||"TransitionNone"===f||"TransitionMorph"===f||"TransitionCut"===f||"TransitionFade"===f||"TransitionPush"===f||"TransitionWipe"===f:!1}static Ec(f){return Md.a.Lkc+"_"+f+"_32x32x32"}}
xc.K_i="PptRibbon.Transition.Gallery-MaxSize-1-0";xc.uLk="Transitions";xc.vLk="Transitions-previewWrapper";xc.L_i="Transition";Object(k.a)(xc,"TransitionHelper",null,[1063]);var pg=d(245);class Ih{constructor(){this.nh=this.K=null}get name(){return"PowerPointWebEditor.Advanced"}$b(f){this.K=f;this.nh=this.K.resolve("PowerPointWebEditor.Core.IBundleMetricRecorder").VDa(0,this.name);this.K.register(1008,"PowerPointWebEditor.IParagraphLevelPropertyChangedHandlers").ma().oa(()=>new Bh(this.K.resolve("Common.IActionManagerExtended")));
if(this.K.resolve("PowerPointWebEditor.IApplicationSettings").VP){const x=pg.a(this.K);this.K.register(1009,"PowerPointWebEditor.IAudioManagerStore").ma().oa(()=>new rc);this.K.register(1010,"PowerPointWebEditor.IAudioLibraryCallbackFactory").ma().oa(()=>new re(this.K.resolve("PowerPointWebEditor.IMediaLocalRequestHelper"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("Common.IActionManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").VP,this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),
this.K.Ja("PowerPointWebEditor.IAudioManagerStore")));this.K.register(1011,"PowerPointWebEditor.IAudioManagerFactory").ma().oa(()=>new ob(this.K.resolve("PowerPointWebEditor.IAudioLibraryCallbackFactory"),x,this.K.resolve("PowerPointWebEditor.IMediaLocalRequestHelper"),this.K.resolve("PowerPointWebEditor.ISessionInfoOwner")));this.K.resolve("PowerPointWebEditor.IAudioManagerFactory");this.K.resolve("PowerPointWebEditor.IAudioManagerStore")}}init(){let f=this.nh.su("resolve");var x=this.K.resolve("Common.AFrameworkApplication");
const N=this.K.resolve("PowerPointWebEditor.IApplicationContext"),ea=N.od;x=x.rr;const ma=this.K.resolve("Common.IActionManagerExtended"),Ha=this.K.resolve("PowerPointWebEditor.IFocusManager");x=x.Jd;const Ua=this.K.resolve("Common.Transaction.ITransactionFactory"),mb=this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),gb=this.K.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),Cb=this.K.resolve("PowerPointWebEditor.PictureContext"),zb=this.K.resolve("PowerPoint.IPathManager");
var Pb=this.K.resolve("PowerPointWebEditor.IPresentationReader");const oc=this.K.resolve("PowerPointWebEditor.IShapeReader"),Ec=this.K.resolve("PowerPointWebEditor.IPictureUploader"),Xc=this.K.re("PowerPointWebEditor.IPPTLanguageDialogFactory"),Ac=this.K.resolve("Box4.IParagraphReader");this.nh.yu(f);f=this.nh.su("regactors");Pb=[new Fg(ma,mb,this.K.resolve("PowerPointWebEditor.Graph.IPPTLineSpacingHelper"),this.K.resolve("Box4.IParagraphIndentationReader"),this.K.resolve("Common.Transaction.ITransactionFactory"),
Ac,this.K.resolve("PowerPointWebEditor.IPPTParagraphReader"),oc,this.K.resolve("PowerPointWebEditor.IParagraphLevelPropertyChangedHandlers"),If.App.zLa.HKc(12),ea.telemetryForPptParagraphSettingEnabled),new tc(ma,Ha,gb,Ua,mb,zb,x,this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Pb,new td,ea.Uhg,this.K.resolve("Common.IAppSettingsManager").ka("ChangingThemeSelectedSlidesEnabled")),new Oa(ma,x,this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Ua,mb,Ha,new xc(ea.LLa,
this.K.resolve("PowerPointWebEditor.IApplicationSettings").qT),gb,ea,zb,this.K.resolve("PowerPointWebEditor.View.IPPTPageView"))];ea.Yqb?Pb.push(new qe(ma,mb,Ha,Ua,new cc(ea.XPd),gb,oc,zb,this.K.resolve("PowerPointWebEditor.Animations.IEffectSelectionManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"))):Pb.push(new Lf(ma,this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),mb,Ha,Ua,new cc(ea.XPd),gb,this.K.resolve("PowerPointWebEditor.IApplicationSettings"),oc,zb));ea.powerPointFormatBackgroundEnabled&&
Pb.push(new Zg(ma,Ha,gb,mb,Ua,x,this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Ec,Cb,J.AFrameworkApplication.LQ,this.K.resolve("PowerPointWebEditor.IErrorHandler"),ea));for(const zd of Pb)zd.vb(),zd.De();this.nh.yu(f);J.AFrameworkApplication.fa.jf(()=>{f=this.nh.su("regfullactors");const zd=[],ue=this.K.resolve("Box4.Proofing.IProofingFeatureConfiguration");ue.AUa=this.K.resolve("Common.IAppSettingsManager").ka("299");N.od.jIb&&zd.push(new Ii(ma,Xc,ue,this.K.resolve("Common.Transaction.ITransactionFactory"),
this.K.Ja("Box4.Proofing.ICritiqueTypeSettings"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("Box4.ILanguageReader"),this.K.resolve("Box4.Proofing.IErrorRangeEditor"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("Box4.IProofingManager"),mb));this.K.resolve("PowerPointWebEditor.IApplicationSettings").M7b&&zd.push(new Ia(ma,Ha,mb,pg.a(this.K)));for(const bf of zd)bf.vb(),bf.De();ue.AUa&&
(new Ed(ma,this.K.resolve("Box4.Proofing.ICritiqueTypeSettings"),(bf,Ce)=>new ie(bf,this.K.resolve("Box4.Proofing.IProofingConfigV2Manager"),Ce,this.K.resolve("Common.IFocusManager")),this.K.resolve("Box4.Proofing.IProofingConfigV2Manager"),mb,this.K.resolve("Box4.ILanguageReader"),oc)).vb();this.nh.yu(f)})}dispose(){}}Object(k.a)(Ih,"AdvancedPackage",null,[2,3]);class vh{get container(){return na.a.instance.resolve("PowerPointWebEditor.IRibbonPane").xa}}Object(k.a)(vh,"PPTFloatPaneContainer",null,
[632]);class Ti{constructor(f,x,N=null){this.qfb=new ib.a(0);this.ZYa=null;this.Ugb=this.ZYa=If.App.Um;this.rse=f;this.bWg=1E3*x;this.bxg=N||(()=>(new Date).getTime())}Vgi(f){this.rse&&this.qfb.add(f,(new Date).getTime())}KPf(f){this.rse&&(this.qfb.remove(f),this.nrl(this.bxg()-this.bWg))}nrl(f){if(this.qfb.count){var x=[];this.qfb.forEach((N,ea)=>{ea<f&&x.push(N);return!0});for(const N of x)this.qfb.remove(N)}}get lgg(){return this.Ugb<=this.ZYa}Svj(){if(!this.rse||!this.qfb.count)return!1;let f=
!1;const x=this.bxg();this.qfb.forEach((N,ea)=>x-ea<this.bWg?(f=!0,!1):!0);return f}}Object(k.a)(Ti,"PictureContext",null,[1007]);var ai=d(896),Il=d(433);class ui{constructor(){this.rdb=this.Jwe=this.xEg=this.yEg=!1;this.nh=this.I4=this.xDb=this.TEg=this.K=null;this.Wbc=[new Ih];this.LX=[]}get name(){return"PowerPointWebEditor.Chronos"}$b(f){this.K=f;this.I4=this.K.resolve("PowerPointWebEditor.Core.IBundleMetricRecorder");this.nh=this.I4.VDa(0,this.name);for(let x=0;x<this.Wbc.length;++x)Array.add(this.LX,
Hf.a(this.Wbc[x],0));for(const x of this.LX)x.$b(f);ui.uwi(f);this.K.register(Ti,"PowerPointWebEditor.PictureContext").as("PowerPointWebEditor.IPictureContext").ma().oa(()=>new Ti(this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptEditingPromptUnsavedDialogForUploadingImageEnabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptEditingUploadLargeImageTimeoutInSeconds))}Fjc(f,x){f=hg.a.instance;for(let ea=0;ea<x.entries.length;ea++){var N=x.entries[ea];N.url=u.a.removeParameter(N.url,
J.AFrameworkApplication.VV);const ma=u.a.Nna(N.url);let Ha=!1;if("about:blank"===N.url||ma.endsWith("RemoteUls.ashx")||"renamehandler.ashx"===ma&&"2"===u.a.dT(N.url,"u")||this.rdb&&(Ha=ma.endsWith("PowerPoint.ashx"))&&N.url.endsWith("ib=1"))N.behavior=1;else{if(Ha||ma.endsWith("PowerPoint.ashx")||ma.endsWith("GetUpdates")||ma.endsWith("images.ashx")||ma.endsWith("GetThumb"))N.behavior=2;if(!this.yEg&&ma.endsWith("PowerPoint.ashx")&&"true"===u.a.dT(N.url,kd.a.ixk))N=N.EB,f.ic(rf.a.sVd,parseInt(String(N.fetchStart))),
f.ic(rf.a.Jyi,parseInt(String(N.responseStart))),f.ic(rf.a.Byi,parseInt(String(N.responseEnd-N.responseStart))),this.yEg=!0;else if(!this.xEg&&ma.endsWith("PowerPoint.ashx")&&"true"===u.a.dT(N.url,"dSlide")){this.xEg=!0;N=N.EB;f.ic("SlideImageFetchStart",parseInt(String(N.fetchStart)));f.ic("SlideImageResponseStart",parseInt(String(N.responseStart)));f.ic("SlideImageDownloadDuration",parseInt(String(N.responseEnd-N.responseStart)));let Ua;({transferSize:Ua}=ui.WDh(N)).returnValue&&f.ic("SlideImageSize",
Ua)}else if(!this.Jwe&&ma.endsWith("images.ashx")&&"true"===u.a.dT(N.url,"minimalboot")&&u.a.dT(N.url,"index")===this.TEg){this.Jwe=!0;N=N.EB;f.ic("MBootFetchStart",parseInt(String(N.fetchStart)));f.ic("MBootResponseStart",parseInt(String(N.responseStart)));f.ic("MBootDownload",parseInt(String(N.responseEnd-N.responseStart)));let Ua;({transferSize:Ua}=ui.WDh(N)).returnValue&&f.ic("MBootSize",Ua)}}}}u7k(){const f=window.self.FirstSlideRequestIndex;void 0===f||null===f?this.Jwe=!0:this.TEg=f.toString()}init(){Vc.a.J(512497358,
809,50,"ChronosPackage::Init");const f=this.K.resolve("PowerPointWebEditor.IApplicationSettings"),x=this.K.resolve("Common.ITaskManager");for(var N of this.LX)this.nh.su(N.name),N.init(),this.nh.yu(N.name);this.K.resolve("Common.IAppSettingsManager").jf(()=>{if(f.podsAnimationSuggestionEnabled){const ea=this.nh.su("animationpreview");this.wCj();this.nh.yu(ea)}});this.K.resolve("Common.IActionManagerExtended").Lna(this.K.resolve("PowerPointWebEditor.IPasteFloatieHelper"));N=na.a.instance.resolve("Box4.IProofingManager");
if(null!==N){let ea=this.nh.su("proofingresume");N.resume();this.nh.yu(ea)}if(f.kua||!f.IUa)N=this.nh.su("loaddelayedres"),this.K.resolve("PowerPointWebEditor.IPresentationResourcesManager").wxh(),this.nh.yu(N);this.u7k();this.rdb=f.podsUseRealtimeCoauthReplicationTimerForInbound;N=this.K.resolve("Common.NetworkTiming.IResourceTimingLogger");N.$b(30,0);N.Xrf(Object(v.a)(this,this.Fjc,"onResourceTimingEntriesAvailable"));N.activate();f.tUa&&(this.xDb=window.self.PerfMeterData,void 0!==this.xDb&&null!==
this.xDb&&(x.Eb(new cd.a(3,2,6E4,Object(v.a)(this,this.collectPerfMeterData,"collectPerfMeterData"),90,"67")),Vc.a.J(512497357,809,50,"CollectPerfMeterData task started"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler").GA(()=>{this.collectPerfMeterData(null)})));this.XYj(f)}XYj(f){Vc.a.J(512497356,809,50,"Start to download chronos1 js file");if(f.stc)this.K.resolve("PowerPointWebEditor.ScriptLoader.IUnifiedScriptLoader").Gca("pptedit.chronos1",null,()=>d.e(2).then(d.bind(null,1228)));
else{f=nf.a.create("pptedit.chronos1",null,()=>d.e(2).then(d.bind(null,1228)));const x=this.K.resolve("PowerPointWebEditor.ISessionState");f.zS(()=>{x&&x.C5("Chronos1DownloadFinished")});ra.a.Wx(f)}}collectPerfMeterData(){if(0<this.xDb.length){const f=[];for(const x of this.xDb)f.push({["Id"]:x.Id,["Value"]:x.Value.toFixed(2),["Start"]:x.Start.toFixed(2),["Duration"]:x.Duration.toFixed(2)});Vc.a.J(512497355,813,50,JSON.stringify(f));this.xDb.length=0}}dispose(){for(var f of this.LX)f.dispose();f=
this.K.resolve("Common.NetworkTiming.IResourceTimingLogger");f.deactivate(!0);f.Bhh(Object(v.a)(this,this.Fjc,"onResourceTimingEntriesAvailable"))}wCj(){const f=nf.a.create("pptedit.animationpreview",null,()=>d.e(18).then(d.bind(null,1242)));try{ra.a.Wx(f)}catch(x){Vc.a.J(512497354,809,10,"ChronosPackage::InitializeAnimationPreview - Failed to download animationpreview script, Exception: {0}",x.toString())}}static uwi(f){f.register(632,"Common.IFloatPaneContainer").ma().oa(()=>new vh)}static WDh(f){f=
parseInt(String(ai.a(f,"transferSize")));return{returnValue:!f.toString().startsWith("NaN"),transferSize:f}}static main(){J.AFrameworkApplication.Tg&&fa.a.fg?Vc.a.J(512497353,809,15,"Firefox attempts to load chronos package when App is disposing"):(hg.a.instance.ic(Il.a.ETd,(new Date).getTime()),Na.a.instance.Dc(Hf.a(new ui,0)))}}Object(k.a)(ui,"ChronosPackage",null,[2,3]);class Cg{constructor(f,x,N,ea,ma,Ha,Ua){this.tEb=this.IT=!1;this.ua=f;this.jc=x;this.Xt=N;this.lq=ea;this.Fbb=Ha;this.ve=ma;this.Xz=
this.ua.Ba;this.Kc=Ua}initialize(){this.Xt.ik(Object(v.a)(this,this.hh,"onPropertyChanged"));this.ve.M5a(Object(v.a)(this,this.R$,"onRibbonTabSwitched"));this.lq.$V(Object(v.a)(this,this.onActiveSlideDomReady,"onActiveSlideDomReady"));this.lq.Gqb(Object(v.a)(this,this.qna,"onShapeViewElementAdded"));this.lq.S$h(Object(v.a)(this,this.K5g,"onShapesAllSelected"))}dispose(){this.Xt.Cm(Object(v.a)(this,this.hh,"onPropertyChanged"));this.ve.DJb(Object(v.a)(this,this.R$,"onRibbonTabSwitched"));this.lq.Una(Object(v.a)(this,
this.onActiveSlideDomReady,"onActiveSlideDomReady"));this.lq.Inc(Object(v.a)(this,this.qna,"onShapeViewElementAdded"));this.lq.RUk(Object(v.a)(this,this.K5g,"onShapesAllSelected"))}hh(f,x){x.property===$a.a.cQc&&this.IT&&this.jc.mg(x.node)===this.Xz&&this.SJa(this.IT)}R$(f,x){if(this.IT=!!x.G$&&0<=x.G$.indexOf("Animation"))this.tEb=!0;this.SJa(this.IT)}qna(f,x){(f=this.ua.Ba)&&f.XN&&f===this.Xz&&(x=x.Gw)&&x.shapeNode&&this.Xz&&this.xFa(this.Xz.Cb,x.shapeNode)&&this.SJa(this.IT)}xFa(f,x){return f&&
x?f.equals(x.slideId):!1}onActiveSlideDomReady(f,x){(f=Object(C.a)(116,x.Ba))&&this.Xz&&this.Xz.Cb!==f.Cb&&(this.Xz=f,this.SJa(this.IT))}K5g(){this.maa()}maa(){if(this.IT&&this.Xz&&this.Xz.qEa&&this.tEb){var f=this.Xz.Pk();if(f&&0<f.length)for(const x of f)x&&x.T$a()&&(f=this.Fbb.VG(x))&&(f.f_b(),f.maa(!0))}}SJa(f){if(this.tEb&&this.Xz&&this.Xz.XN&&this.Kc.Ic&&this.Kc.Ic.sGc){var x=this.Xz.Pk();if(x&&0<x.length)for(const N of x)N&&(x=this.Fbb.VG(N))&&(x.visible=f,x.Uhb())}}}Object(k.a)(Cg,"AnimationMarkerManagerLegacy",
null,[106]);var hl=d(76),yj=d(56);class Oi{constructor(f,x){this.height=f;this.top=x}}Object(k.a)(Oi,"ParagraphProperties",null,[]);var jj=d(46),zh=d(66),bk=d(137),Wk=d(167),Xk=d(194),he=d(185);class ik{constructor(f,x,N,ea,ma,Ha,Ua,mb,gb,Cb,zb,Pb,oc,Ec,Xc){this.Pec=this.bA=this.Jeb=this.Gk=this.Db=!1;this.va=new hl.a;this.gfc=this.vd=1;this.pn=this.ln=this.Xg=this.xb=this.qb=null;this.Im=Ac=>{Ac&&this.uO?(this.qb=new bk.a,this.qb.qr("AnimationMarkerView"),this.uO.appendChild(this.qb.xa),this.xb=
new he.a,this.xb.Yj(0),this.qb.appendChild(this.xb.viewport),this.Xg=new Wk.a,this.Xg.Yj(1),this.Xg.setVisibility(!1),this.xb.appendChild(this.Xg),this.ln=new bk.a,this.ln.qr("ShapeAnimationMarkerContainer"),this.ln.xa.id=this.ta.id.toString(),this.ln.ih(20,this.qb.xa.clientHeight),this.ln.Yj(1),this.qb.appendChild(this.ln),this.pn=new bk.a,this.pn.qr("TextAnimationMarkerContainer"),this.pn.xa.id=this.ta.id.toString(),this.pn.ih(20,this.qb.xa.clientHeight),this.pn.Yj(1),this.qb.appendChild(this.pn),
this.$f.pb(Sb.a.mq,this.ln.xa,this.XC),this.$f.pb(Sb.a.Is,this.ln.xa,this.XC),this.$f.pb(Sb.a.mq,this.pn.xa,this.XC),this.$f.pb(Sb.a.Is,this.pn.xa,this.XC),this.$f.pb(Sb.a.xJ,this.ln.xa,this.bTa),this.$f.pb(Sb.a.xJ,this.pn.xa,this.bTa),this.$f.pb(Sb.a.mouseDown,this.ln.xa,this.bTa),this.$f.pb(Sb.a.mouseDown,this.pn.xa,this.bTa),this.Yc.pb(Sb.a.click,this.pn.xa,this.xUc),this.Yc.pb(Sb.a.click,this.ln.xa,this.xUc),this.setVisibility()):Vc.a.J(509682581,800,10,"AnimationMarkerView: {0} is null",Ac?"m_markerViewParentElement":
"parent")};this.HN=()=>!0;this.bTa=Ac=>{if(!Ac&&!Ac.Cc.id.startsWith(Md.a.Xqb)&&!Ac.Cc.id.startsWith("overlappedMarker"))return Vc.a.J(509682580,800,50,"AnimationMarkerView:handleAnimationMarkerClick source element is not marker"),!1;Ac.eventName==Sb.a.xJ&&this.nGe(Ac);Ac=Ac.pc;Ac.preventDefault();Ac.stopPropagation();return!0};this.xUc=Ac=>{Ac=Ac.pc;Ac.preventDefault();Ac.stopPropagation();return!0};this.setSelection=()=>{};this.setVisibility=()=>{let Ac=this.Db&&!this.bA;this.ta&&this.ta.isHiddenShape&&
(Ac=!1);this.qb&&this.qb.Pd(Ac);this.ln&&this.ln.Pd(Ac);this.pn&&this.pn.Pd(Ac)};this.maa=Ac=>{if(this.Ada()){this.Jeb=Ac;Ac=[this.ln.xa.childNodes,this.pn.xa.childNodes];for(const zd of Ac)for(Ac=0;zd&&Ac<zd.length;Ac++)this.Qoc(zd[Ac],this.Jeb)}};this.d2k=Ac=>{if(this.Ada()){var zd=[this.ln.xa.childNodes,this.pn.xa.childNodes];for(const ue of zd)for(zd=0;ue&&zd<ue.length;zd++){const bf=this.k4b(ue[zd]);for(const Ce of Ac)bf.includes(Ce)&&this.Qoc(ue[zd],!0)}}};this.k4b=Ac=>{if(!Ac||!this.ta)return null;
Ac=Ac.getAttribute("AnimProps");if(!Ac||!Ac.toString()||!Ac.toString().trim().length)return null;Ac=Ac.toString().split(" ");if(!Ac||!Ac.length)return null;const zd=[];for(const ue of Ac){if(!ue||!ue.trim().length)return null;zd.push(Number.parseInvariant(ue.trim()))}return zd};this.Ada=()=>{const Ac=!!this.ta&&!!this.uO&&!!this.ln&&!!this.pn;Ac||Vc.a.J(509682579,800,10,"AnimationMarkerView: the containers are not exist.");return Ac};this.gQa=()=>{this.Lia(!0);this.Lia(!1)};this.Lia=Ac=>{if(this.$f&&
this.Yc&&this.Ada()&&(Ac=Ac?this.pn.xa:this.ln.xa)&&Ac.childNodes&&0<Ac.childNodes.length){const zd=Ac.childNodes;for(const ue=0;ue<zd.length;)Ac.removeChild(zd[ue])}};this.QMd=()=>{if(this.Ada()){var Ac=this.jc.mg(this.ta);if(Ac)if((Ac=Ac.hwb(this.ta))&&Ac.length){var zd=!1,ue=!1,bf=[];for(const Ce of Ac)Ce.IsTextRangeType?ue=!0:(zd=!0,bf.push(Ce));this.Pec=zd&&ue;this.TLa(!0);this.TLa(!1);this.Lia(!1);0<bf.length&&(this.d2b(bf,this.Pi.wM(this.ta.fp.kc,this.vd),this.Pi.wM(this.ta.fp.Xb-this.ta.fp.kc,
this.vd),!1,-1)||Vc.a.J(509682577,800,10,"AnimationMarkerView: no shape marker is rendered"));ue?this.q0d():this.Lia(!0)}else this.gQa();else Vc.a.J(509682578,800,10,"AnimationMarkerView::addAnimationMarkers: slideNode is null")}};this.q0d=()=>{const Ac=new cd.a(2,1,0,this.ensureTextIsRenderedAndDrawMarkers,90,"26");this.zb.Eb(Ac)};this.ensureTextIsRenderedAndDrawMarkers=()=>{this.Gk||(this.Gqe(),this.e2b())};this.e2b=()=>{this.Lia(!0);if(this.Nae()){var Ac=this.I8d();if(Ac&&Ac.length){var zd;if(({top:zd}=
this.Q8d()).returnValue){var ue=0;for(let Ce=0;Ce<Ac.length;Ce++){var bf=this.jc.mg(this.ta);if(!bf){Vc.a.J(509682574,800,10,"AnimationMarkerView:drawTextAnimationMarkers slide node is null.");return}(bf=bf.z7d(this.ta,Ce))&&0<bf.length&&Ac[Ce]&&(ue+=this.d2b(bf,Ac[Ce].top-zd,Ac[Ce].height,!0,Ce))}ue||Vc.a.J(509682573,800,10,"AnimationMarkerView: no paragraph marker is rendered.")}else Vc.a.J(509682575,800,50,"AnimationMarkerView: GetSlideContentClientRects failed.")}else Vc.a.J(509682576,800,50,
"AnimationMarkerView: the paragrph view is not rendered")}};this.I8d=()=>{const Ac=[];var zd=hj.GraphIterator.nb(this.ta);zd=this.Ll.S2(zd,zd.currentNode);for(var ue;zd.moveNext();)(ue=zd.currentNode)&&this.Hh.Yd(ue)&&ue&&(ue=ue.sc(this.mz))&&ue.htmlElement&&(ue=this.nta(ue.htmlElement))&&ue.height&&Ac.push(ue);return Ac};this.nta=Ac=>{if(!Ac)return Vc.a.J(509682570,800,10,"AnimationMarkerView:getParagraphProperties paragraph is null"),null;Ac=Ac.querySelectorAll(".TextRun");if(!Ac||!Ac.length)return null;
let zd=0,ue=0;let bf,Ce=!1;for(let Df=0;Df<Ac.length&&Ac[Df];Df++){var qg=Ac[Df].getClientRects();({top:qg,bottom:bf}=this.b2d(qg)).returnValue&&(Df?(zd=zd>qg?qg:zd,ue=ue<bf?bf:ue):(zd=qg,ue=bf),Ce=!0)}if(Ce)return new Oi(ue-zd,zd);Vc.a.J(509682569,800,50,"AnimationMarkerView: search failed in GetParagraphProperties.");return null};this.d2b=(Ac,zd,ue,bf)=>{if(!this.Ada()||!Ac||!Ac.length)return 0;const Ce=bf?this.pn.xa:this.ln.xa;ue=(ue=Math.floor(this.Pi.Pm(ue)/21))?ue:1;let qg=0,Df=null,Bi=null,
wi=!0,Pf=!1;for(let qh=0;qh<Ac.length;qh++){const Uj=Ac[qh];var Ci=new bk.a;Ci.xa.id=Md.a.Xqb+Uj.ClickOrder;Ci.ih(20,16);Ci.Yj(1);if(Uj.IsTrigger){var Tj=this.mXd();Ci.xa.appendChild(Tj)}else Ci.xa.innerText=Uj.ClickOrder.toString();let ol=Tj=!1;qh<ue?(bf&&(Ci.xa.style.position=zh.a.absolute,Ci.xa.style.top=jj.a.Pc(this.Pi.Pm(zd)+21*qg)),Pf=this.Jeb||this.rx.mVd(Uj.EffectNodeId),Ci.xa.setAttribute(zh.a.Jra,Pf?"animMarkerSelected":"animMarkerUnselected"),Ce.appendChild(Ci.xa),qg++):qh===ue?(wi=wi&&
Uj.EffectId===Df.EffectId,Tj=!0,ol=Df.IsTrigger):wi=wi&&Uj.EffectId===Df.EffectId;Tj&&Bi.xa.appendChild(this.DRd(ol,wi,Pf));Df=Uj;Bi||(Bi=Ci);bf?(Ci=[],(Tj=this.k4b(Bi.xa))&&Ci.push(...Tj),Ci.push(Uj.EffectNodeId),Bi.xa.setAttribute("AnimProps",Ci.join(" "))):Ci.xa.setAttribute("AnimProps",Uj.EffectNodeId)}this.FM();return qg};this.DRd=(Ac,zd,ue)=>{const bf=new bk.a;bf.xa.id="overlappedMarker";bf.xa.style.marginTop=Ac?"3px":"-13px";bf.xa.setAttribute(zh.a.Jra,"overlappedMarker "+(ue?"animMarkerSelected":
"animMarkerUnselected"));zd&&this.l1(bf.xa,"SameEffectOverlapped",1);return bf.xa};this.FM=()=>{this.EAe(this.qb.xa,!0)};this.Nae=()=>{var Ac=this.jc.mg(this.ta);if(!Ac)return Vc.a.J(509682567,800,10,"AnimationMarkerView::hasTextAnimations: slideNode is null"),!1;Ac=Ac.hwb(this.ta);if(!Ac||!Ac.length)return!1;for(const zd of Ac)if(zd.IsTextRangeType)return!0;return!1};this.TLa=Ac=>{if(this.Ada()){var zd=Ac?this.ln.xa:this.pn.xa,ue,bf;zd&&({x:ue,y:bf}=this.Y6d(Ac)).returnValue&&(zd.style.position=
zh.a.absolute,zd.style.left=jj.a.Pc(ue),zd.style.zIndex="20000",Ac?zd.style.top=jj.a.Pc(bf):this.e2b())}};this.nGe=Ac=>{if(this.va&&Ac&&this.Fa&&Ac.Cc){var zd=Ac.Cc.id.startsWith("overlappedMarker")&&Ac.Cc.offsetParent?Ac.Cc.offsetParent:Ac.Cc;(zd=this.k4b(zd))?(Ac.ctrlKey?this.rx.Poj(zd,this.jc.mg(this.ta)):(this.rx.fsa(),this.rx.srf(zd,this.jc.mg(this.ta))),this.va.raiseEvent("OnMarkerClick",Ac),this.Fa.Ed()):Vc.a.J(509682566,800,10,"AnimationMarkerView: failed to parse the animation properties.")}};
this.Pl=()=>{this.xb&&(this.BOb(),this.xb.Pl())};this.BOb=()=>{if(this.ta&&this.Xg){var Ac=this.ta.fp.points;Ac=ik.jra(Ac,this.Owb());this.Xg.ut(Ac)}};this.Owb=()=>{let Ac=Md.a.zKb;this.ta.Rf||!this.ta.tua&&!this.ta.gl||(Ac+=6);return Ac};this.Yp=()=>{this.xb&&this.gfc!==this.vd&&this.Uhb();return null};this.Nq=()=>{};this.Ru=()=>{};this.Hj=Ac=>{this.gfc=this.vd;this.vd=Ac};this.setZIndex=Ac=>{this.xb&&this.xb.DB(Ac)};this.draw=()=>{this.Uhb()};this.Uhb=()=>{this.qb&&this.uO&&this.Db&&!this.bA&&(this.gQa(),
this.QMd());this.setVisibility()};this.XC=Ac=>{if(!this.va||!Ac)return!1;this.va.raiseEvent("OnSelectionAreaHover",Ac);Ac.eventName===Sb.a.mq?this.l1(Ac.Cc,"animMarkerHovered",1):Ac.eventName===Sb.a.Is&&this.l1(Ac.Cc,"animMarkerHovered",2);return!0};this.Qoc=(Ac,zd)=>{Ac?zd?(this.l1(Ac,"animMarkerUnselected",2),this.l1(Ac,"animMarkerSelected",1)):(this.l1(Ac,"animMarkerSelected",2),this.l1(Ac,"animMarkerUnselected",1)):Vc.a.J(509682565,800,10,"AnimationMarkerView:selectMarker domElement is null")};
this.l1=(Ac,zd,ue)=>{const bf=this.UUc(Ac);switch(ue){case 0:Ac.setAttribute(zh.a.Jra,zd);bf&&Ac.lastChild.setAttribute(zh.a.Jra,zd);break;case 1:Sys.UI.DomElement.addCssClass(Ac,zd);bf&&Sys.UI.DomElement.addCssClass(Ac.lastChild,zd);break;case 2:Sys.UI.DomElement.removeCssClass(Ac,zd),bf&&Sys.UI.DomElement.removeCssClass(Ac.lastChild,zd)}};this.UUc=Ac=>!!Ac&&!!Ac.lastChild&&!!Ac.lastChild.id&&"overlappedMarker"===Ac.lastChild.id;this.setPosition=()=>{};this.JE=Ac=>{this.bA=Ac;this.bA||(this.Ur(),
this.maa(!0));this.setVisibility()};this.YD=()=>null;this.Jx=()=>{};this.yB=()=>[];this.My=()=>{};this.eD=()=>{};this.Ur=()=>{!this.Gk&&this.uO&&(this.TLa(!0),this.TLa(!1))};this.mXd=()=>{const Ac=new Xk.a;Ac.ih(10,10);Ac.xa.setAttribute(zh.a.Jra,"pointer-events-none");Ac.qya("0 0 2048 2048");const zd=new Wk.a;zd.i1("M 421 1984 l 422 -896 h -478 l 569 -1024 h 599 l -499 640 h 621 l -1077 1280 M 1165 640 h 627 l -1184 1408 h -288 l 422 -896 h -486 l 640 -1152 h 768 m -1116 1920 l 969 -1152 h -614 l 499 -640 h -431 l -498 896 h 471 l -422 896");
zd.KE("#E67E22");zd.Su("#FFFF00");zd.jr(5);Ac.appendChild(zd);return Ac.xa};if(!f)throw Error.argumentNull("shapeNode");if(!x)throw Error.argumentNull("slideReader");if(!N)throw Error.argumentNull("traverserFactory");if(!ea)throw Error.argumentNull("paragraphReader");if(!Ua)throw Error.argumentNull("activeSlideViewManager");if(!mb)throw Error.argumentNull("mouseInputManager");if(!gb)throw Error.argumentNull("clickInputManager");if(!Cb)throw Error.argumentNull("focusManagers");if(!Xc)throw Error.argumentNull("effectSelectionManager");
if(!Pb)throw Error.argumentNull("pptUnitConversion");this.ta=f;this.jc=x;this.Ll=N;this.Hh=ea;this.mz=Ha;this.EAe=ma;this.uO=Ua.Ic?Ua.Ic.sGc:null;this.Nze=Ua.Ic?Ua.Ic.Qqc:null;this.$f=mb;this.Yc=gb;this.Fa=Cb;this.zb=zb;this.v9=oc;this.Gqe=Ec;this.Pi=Pb;this.rx=Xc}dispose(){this.Gk||(this.v9(),this.Gk=!0,this.Db=!1,this.gQa(),this.Yc&&this.ln&&this.Yc.yb(Sb.a.click,this.ln.xa,this.xUc),this.$f&&this.ln&&(this.$f.yb(Sb.a.mq,this.ln.xa,this.XC),this.$f.yb(Sb.a.Is,this.ln.xa,this.XC),this.$f.yb(Sb.a.xJ,
this.ln.xa,this.bTa),this.$f.yb(Sb.a.mouseDown,this.ln.xa,this.bTa)),this.ln=null,this.Yc&&this.pn&&this.Yc.yb(Sb.a.click,this.pn.xa,this.xUc),this.$f&&this.pn&&(this.$f.yb(Sb.a.mq,this.pn.xa,this.XC),this.$f.yb(Sb.a.Is,this.pn.xa,this.XC),this.$f.yb(Sb.a.xJ,this.pn.xa,this.bTa),this.$f.yb(Sb.a.mouseDown,this.pn.xa,this.bTa)),this.Fa=this.Hh=this.ta=this.Ll=this.jc=this.Pi=this.rx=this.xb=this.Xg=this.uO=this.qb=this.pn=null)}get visible(){return this.Db}set visible(f){this.Db=f}get BB(){return this.xb}get qq(){return this.Xg}get me(){return this.qb}Q8d(){return this.getClientRects(this.Nze)}getClientRects(f){let x,
N;x=N=0;if(!f)return Vc.a.J(509682572,800,10,"AnimationMarkerView: element is null for GetClientRects."),{returnValue:!1,left:x,top:N};f=f.getClientRects();if(!f||!f.length||!f[0])return Vc.a.J(509682571,800,10,"AnimationMarkerView: cannot get boundingRects."),{returnValue:!1,left:x,top:N};N=Math.round(f[0].top);x=Math.round(f[0].left);return{returnValue:!0,left:x,top:N}}b2d(f){let x,N;x=N=0;if(!f||!f.length||!f[0])return Vc.a.J(509682568,800,50,"AnimationMarkerView: boundingRects is nulll or empty."),
{returnValue:!1,top:x,bottom:N};x=f[0].top;N=f[0].bottom;for(let ea=1;ea<f.length&&f[ea];ea++)x=f[ea].top>x?x:f[ea].top,N=f[ea].bottom<N?N:f[ea].bottom;return{returnValue:!0,top:x,bottom:N}}Y6d(f){let x,N;x=N=0;if(!this.ta)return{returnValue:!1,x,y:N};var ea=Object(C.a)(117,this.ta.sc(this.mz));if(!ea)return{returnValue:!1,x,y:N};ea=ea.ls();if(!ea)return{returnValue:!1,x,y:N};x=f?ea.hc-(this.Pec?61:35):ea.hc-20-15;N=ea.kc;return{returnValue:!0,x,y:N}}}ik.jra=(f,x)=>[new yj.a(f[0]._x-x,f[0]._y-x),
new yj.a(f[1]._x+x,f[1]._y-x),new yj.a(f[2]._x+x,f[2]._y+x),new yj.a(f[3]._x-x,f[3]._y+x)];Object(k.a)(ik,"AnimationMarkerView",null,[676,284,285,106]);class Zf{constructor(f,x,N,ea,ma,Ha,Ua,mb,gb,Cb,zb,Pb,oc,Ec){this.Y5c=this.Jeb=this.Gk=this.Db=!1;this.GVa=this.wbc=-1;this.Pec=this.bA=!1;this.va=new hl.a;this.gfc=this.vd=1;this.pn=this.ln=this.Xg=this.xb=this.qb=null;this.ta=f;this.jc=x;this.Ll=N;this.Hh=ea;this.mz=Ha;this.EAe=ma;this.uO=Ua.Ic?Ua.Ic.sGc:null;this.Nze=Ua.Ic?Ua.Ic.Qqc:null;this.$f=
mb;this.Yc=gb;this.Fa=Cb;this.zb=zb;this.v9=oc;this.Gqe=Ec;this.Pi=Pb}dispose(){this.Gk||(this.v9(),this.Gk=!0,this.Db=!1,this.f_b(),this.gQa(),this.$f&&this.ln&&(this.$f.yb(Sb.a.mq,this.ln.xa,Object(v.a)(this,this.XC,"onSelectionAreaHover")),this.$f.yb(Sb.a.Is,this.ln.xa,Object(v.a)(this,this.XC,"onSelectionAreaHover"))),this.ln=null,this.$f&&this.pn&&(this.$f.yb(Sb.a.mq,this.pn.xa,Object(v.a)(this,this.XC,"onSelectionAreaHover")),this.$f.yb(Sb.a.Is,this.pn.xa,Object(v.a)(this,this.XC,"onSelectionAreaHover"))),
this.xb=this.Xg=this.uO=this.qb=this.pn=null)}get visible(){return this.Db}set visible(f){this.Db=f}get BB(){return this.xb}get qq(){return this.Xg}get me(){return this.qb}Im(f){f&&this.uO?(this.qb=new bk.a,this.qb.qr("AnimationMarkerView"),this.uO.appendChild(this.qb.xa),this.xb=new he.a,this.xb.Yj(0),this.qb.appendChild(this.xb.viewport),this.Xg=new Wk.a,this.Xg.Yj(1),this.Xg.setVisibility(!1),this.xb.appendChild(this.Xg),this.ln=new bk.a,this.ln.qr("ShapeAnimationMarkerContainer"),this.ln.xa.id=
this.ta.id.toString(),this.ln.ih(20,this.qb.xa.clientHeight),this.ln.Yj(1),this.qb.appendChild(this.ln),this.pn=new bk.a,this.pn.qr("TextAnimationMarkerContainer"),this.pn.xa.id=this.ta.id.toString(),this.pn.ih(20,this.qb.xa.clientHeight),this.pn.Yj(1),this.qb.appendChild(this.pn),this.$f.pb(Sb.a.mq,this.ln.xa,Object(v.a)(this,this.XC,"onSelectionAreaHover")),this.$f.pb(Sb.a.Is,this.ln.xa,Object(v.a)(this,this.XC,"onSelectionAreaHover")),this.$f.pb(Sb.a.mq,this.pn.xa,Object(v.a)(this,this.XC,"onSelectionAreaHover")),
this.$f.pb(Sb.a.Is,this.pn.xa,Object(v.a)(this,this.XC,"onSelectionAreaHover")),this.setVisibility()):Vc.a.J(509682564,800,10,"AnimationMarkerView: {0} is null",f?"m_markerViewParentElement":"parent")}HN(f){let x=!1;f&&f.Cc.id.startsWith(Md.a.Xqb)||f.Cc.id.startsWith("overlappedMarker")?(this.nGe(f),x=!0):(this.f_b(),this.maa(!0));return x}setSelection(f){if(f&&!this.Y5c||!f)this.maa(f),this.f_b()}setVisibility(){let f=this.Db&&!this.bA;this.ta&&this.ta.isHiddenShape&&(f=!1);this.qb&&this.qb.Pd(f);
this.ln&&this.ln.Pd(f);this.pn&&this.pn.Pd(f)}maa(f){if(this.Ada()){this.Jeb=f;f=[this.ln.xa.childNodes,this.pn.xa.childNodes];for(const x of f)for(f=0;x&&f<x.length;f++)this.Qoc(x[f],this.Jeb)}}k4b(f){if(!f||!this.ta)return null;f=f.getAttribute("AnimProps");if(!f||!f.toString()||!f.toString().trim().length)return null;f=f.toString().split(" ");if(!f||4!==f.length)return null;const x=[];for(const N of f){if(!N||!N.trim().length)return null;x.push(Number.parseInvariant(N.trim()))}return x}Ada(){const f=
!!this.ta&&!!this.uO&&!!this.ln&&!!this.pn;f||Vc.a.J(509682563,800,10,"AnimationMarkerView: the containers are not exist.");return f}gQa(){this.Lia(!0);this.Lia(!1)}Lia(f){if(this.$f&&this.Yc&&this.Ada()&&(f=f?this.pn.xa:this.ln.xa)&&f.childNodes&&0<f.childNodes.length){const x=f.childNodes;for(const N=0;N<x.length;)f.removeChild(x[N])}}QMd(){if(this.Ada()){var f=this.nXf(this.ta);if(f&&f.length){var x=!1,N=!1,ea=[];for(const ma of f)ma.IsTextRangeType?N=!0:(x=!0,ea.push(ma));this.Pec=x&&N;this.TLa(!0);
this.TLa(!1);this.Lia(!1);0<ea.length&&(Vc.a.J(509682562,800,50,"AnimationMarkerView: draw shape animation markers."),this.d2b(ea,this.Pi.wM(this.ta.fp.kc,this.vd),this.Pi.wM(this.ta.fp.Xb-this.ta.fp.kc,this.vd),!1,-1)||Vc.a.J(509682561,800,10,"AnimationMarkerView: no shape marker is rendered"));N?this.q0d():this.Lia(!0);if(!N&&-1!==this.GVa||-1!==this.GVa&&-1===this.GVa&&!x)this.TTd(),this.maa(!0)}else this.gQa()}}q0d(){const f=new cd.a(2,1,0,Object(v.a)(this,this.ensureTextIsRenderedAndDrawMarkers,
"ensureTextIsRenderedAndDrawMarkers"),90,"26");this.zb.Eb(f)}ensureTextIsRenderedAndDrawMarkers(){this.Gk||(this.Gqe(),this.e2b())}e2b(){this.Lia(!0);if(this.Nae(this.ta)){var f=this.I8d();if(f&&f.length){var x;if(({top:x}=this.Q8d()).returnValue){var N=0;Vc.a.J(509682530,800,50,"AnimationMarkerView: draw paragraph animation markers.");for(let ma=0;ma<f.length;ma++){var ea=this.jc.mg(this.ta);if(!ea)return;(ea=ea.LSc(this.ta,ma))&&0<ea.length&&f[ma]&&(N+=this.d2b(ea,f[ma].top-x,f[ma].height,!0,ma))}N||
Vc.a.J(509682529,800,10,"AnimationMarkerView: no paragraph marker is rendered.")}else Vc.a.J(509682531,800,50,"AnimationMarkerView: GetSlideContentClientRects failed.")}else Vc.a.J(509682560,800,50,"AnimationMarkerView: the paragrph view is not rendered")}}I8d(){const f=[];var x=hj.GraphIterator.nb(this.ta);x=this.Ll.S2(x,x.currentNode);for(var N;x.moveNext();)(N=x.currentNode)&&this.Hh.Yd(N)&&N&&(N=N.sc(this.mz))&&N.htmlElement&&(N=this.nta(N.htmlElement))&&N.height&&f.push(N);return f}Q8d(){return this.getClientRects(this.Nze)}getClientRects(f){let x,
N;x=N=0;if(!f)return Vc.a.J(509682528,800,10,"AnimationMarkerView: element is null for GetClientRects."),{returnValue:!1,left:x,top:N};f=f.getClientRects();if(!f||!f.length||!f[0])return Vc.a.J(509682527,800,50,"AnimationMarkerView: cannot get boundingRects."),{returnValue:!1,left:x,top:N};N=Math.round(f[0].top);x=Math.round(f[0].left);return{returnValue:!0,left:x,top:N}}nta(f){if(!f)return Vc.a.J(509682526,800,10,"AnimationMarkerView: paragraph is null"),null;f=f.querySelectorAll(".TextRun");if(!f||
!f.length)return null;let x=0,N=0;let ea,ma=!1;for(let Ua=0;Ua<f.length&&f[Ua];Ua++){var Ha=f[Ua].getClientRects();({top:Ha,bottom:ea}=this.b2d(Ha)).returnValue&&(Ua?(x=x>Ha?Ha:x,N=N<ea?ea:N):(x=Ha,N=ea),ma=!0)}if(ma)return new Oi(N-x,x);Vc.a.J(509682525,800,50,"AnimationMarkerView: search failed in GetParagraphProperties.");return null}b2d(f){let x,N;x=N=0;if(!f||!f.length||!f[0])return Vc.a.J(509682524,800,50,"AnimationMarkerView: boundingRects is nulll or empty."),{returnValue:!1,top:x,bottom:N};
x=f[0].top;N=f[0].bottom;for(let ea=1;ea<f.length&&f[ea];ea++)x=f[ea].top>x?x:f[ea].top,N=f[ea].bottom<N?N:f[ea].bottom;return{returnValue:!0,top:x,bottom:N}}d2b(f,x,N,ea,ma){if(!this.Ada()||!f||!f.length)return 0;const Ha=ea?this.pn.xa:this.ln.xa;N=(N=Math.floor(this.Pi.Pm(N)/21))?N:1;let Ua=0,mb=null,gb=new bk.a,Cb=!1,zb=!1;const Pb=ma===this.GVa&&f.length<this.wbc+1;for(let Ec=0;Ec<f.length;Ec++){const Xc=f[Ec],Ac=new bk.a;Ac.xa.id=Md.a.Xqb+Xc.BuildId;Ac.ih(20,16);Ac.Yj(1);if(Xc.IsTrigger){var oc=
this.mXd();Ac.xa.appendChild(oc)}else Ac.xa.innerText=Xc.BuildId.toString();let zd=oc=!1;Ec<N?(ea&&(Ac.xa.style.position=zh.a.absolute,Ac.xa.style.top=jj.a.Pc(this.Pi.Pm(x)+21*Ua)),Ac.xa.setAttribute("AnimProps",String.format("{0} {1} {2} {3}",Ec,ma,Xc.BuildId,Xc.EffectId)),zb=this.Jeb||Pb&&f.length-1===Ec||this.Y5c&&this.wbc===Ec&&this.GVa===ma,Ac.xa.setAttribute(zh.a.Jra,zb?"animMarkerSelected":"animMarkerUnselected"),Ha.appendChild(Ac.xa),Ua++):Ec===N&&gb.xa?(Cb=Cb&&Xc.EffectId===mb.EffectId,oc=
!0,zd=mb.IsTrigger):Cb=Cb&&Xc.EffectId===mb.EffectId;oc&&gb.xa.appendChild(this.DRd(zd,Cb,zb));gb=Ac;mb=Xc}this.FM();return Ua}DRd(f,x,N){const ea=new bk.a;ea.xa.id="overlappedMarker";ea.xa.style.marginTop=f?"3px":"-13px";ea.xa.setAttribute(zh.a.Jra,"overlappedMarker "+(N?"animMarkerSelected":"animMarkerUnselected"));x&&this.l1(ea.xa,"SameEffectOverlapped",1);return ea.xa}FM(){this.EAe(this.qb.xa,!0)}nXf(f){if(!f)return null;const x=this.jc.mg(f);return x?x.RSa(f):null}Nae(f){f=this.nXf(f);if(!f||
!f.length)return!1;for(const x of f)if(x.IsTextRangeType)return!0;return!1}TLa(f){if(this.Ada()){var x=f?this.ln.xa:this.pn.xa,N,ea;x&&({x:N,y:ea}=this.Y6d(f)).returnValue&&(x.style.position=zh.a.absolute,x.style.left=jj.a.Pc(N),x.style.zIndex="20000",f?x.style.top=jj.a.Pc(ea):this.e2b())}}Y6d(f){let x,N;x=N=0;if(!this.ta)return{returnValue:!1,x,y:N};var ea=Object(C.a)(117,this.ta.sc(this.mz));if(!ea)return{returnValue:!1,x,y:N};ea=ea.ls();if(!ea)return{returnValue:!1,x,y:N};x=f?ea.hc-(this.Pec?61:
35):ea.hc-20-15;N=ea.kc;return{returnValue:!0,x,y:N}}nGe(f){if(this.va&&f&&this.Fa&&f.Cc){var x=f.Cc.id.startsWith("overlappedMarker")&&f.Cc.offsetParent?f.Cc.offsetParent:f.Cc;this.b5k(x);this.UUc(x)&&!this.XRj(x)&&this.TTd();this.maa(!1);this.Qoc(x,!0);this.va.raiseEvent("OnMarkerClick",f);this.Fa.Ed()}}f_b(){this.Y5c=!1;this.GVa=this.wbc=-1;this.TTd()}b5k(f){(f=this.k4b(f))?(this.Y5c=!0,this.wbc=f[0],this.GVa=f[1],this.ta.cya=this.wbc,this.ta.qKa=this.GVa):Vc.a.J(509682523,800,10,"AnimationMarkerView: failed to parse the animation properties.")}TTd(){this.ta&&
(this.ta.cya=-1,this.ta.qKa=-1)}Pl(){this.xb&&(this.BOb(),this.xb.Pl())}BOb(){if(this.ta&&this.Xg){var f=this.ta.fp.points;f=Zf.jra(f,this.Owb());this.Xg.ut(f)}}Owb(){let f=Md.a.zKb;this.ta.Rf||!this.ta.tua&&!this.ta.gl||(f+=6);return f}Yp(){this.xb&&this.gfc!==this.vd&&this.Uhb();return null}Nq(){}Ru(){}Hj(f){this.gfc=this.vd;this.vd=f}setZIndex(f){this.xb&&this.xb.DB(f)}draw(){this.Uhb()}Uhb(){this.qb&&this.uO&&this.Db&&!this.bA&&this.QMd();this.setVisibility()}XC(f){if(!this.va||!f)return!1;this.va.raiseEvent("OnSelectionAreaHover",
f);f.eventName===Sb.a.mq?this.l1(f.Cc,"animMarkerHovered",1):f.eventName===Sb.a.Is&&this.l1(f.Cc,"animMarkerHovered",2);return!0}Qoc(f,x){f&&(x?(this.l1(f,"animMarkerUnselected",2),this.l1(f,"animMarkerSelected",1)):(this.l1(f,"animMarkerSelected",2),this.l1(f,"animMarkerUnselected",1)))}l1(f,x,N){const ea=this.UUc(f);switch(N){case 0:f.setAttribute(zh.a.Jra,x);ea&&f.lastChild.setAttribute(zh.a.Jra,x);break;case 1:Sys.UI.DomElement.addCssClass(f,x);ea&&Sys.UI.DomElement.addCssClass(f.lastChild,x);
break;case 2:Sys.UI.DomElement.removeCssClass(f,x),ea&&Sys.UI.DomElement.removeCssClass(f.lastChild,x)}}UUc(f){return!!f&&!!f.lastChild&&!!f.lastChild.id&&"overlappedMarker"===f.lastChild.id}XRj(f){return!!f&&!!f.lastChild&&!!f.lastChild.id&&0<=f.lastChild.className.indexOf("SameEffectOverlapped")}setPosition(){}JE(f){(this.bA=f)?this.f_b():(this.Ur(),this.maa(!0));this.setVisibility()}YD(){return null}Jx(){}yB(){return[]}My(){}eD(){}Ur(){!this.Gk&&this.uO&&(this.TLa(!0),this.TLa(!1))}mXd(){const f=
new Xk.a;f.ih(10,10);f.xa.setAttribute(zh.a.Jra,"pointer-events-none");f.qya("0 0 2048 2048");const x=new Wk.a;x.i1("M 421 1984 l 422 -896 h -478 l 569 -1024 h 599 l -499 640 h 621 l -1077 1280 M 1165 640 h 627 l -1184 1408 h -288 l 422 -896 h -486 l 640 -1152 h 768 m -1116 1920 l 969 -1152 h -614 l 499 -640 h -431 l -498 896 h 471 l -422 896");x.KE("#E67E22");x.Su("#FFFF00");x.jr(5);f.appendChild(x);return f.xa}static jra(f,x){return[new yj.a(f[0]._x-x,f[0]._y-x),new yj.a(f[1]._x+x,f[1]._y-x),new yj.a(f[2]._x+
x,f[2]._y+x),new yj.a(f[3]._x-x,f[3]._y+x)]}}Object(k.a)(Zf,"AnimationMarkerViewLegacy",null,[675,284,285,106]);var em=d(277),nj=d(1219),vk=d(186);class wk{constructor(f,x,N,ea,ma,Ha,Ua,mb,gb){this.tEb=this.IT=!1;this.ly=[];this.T9c=new Set;this.initialize=()=>{this.Xt.ik(this.hh);this.ve.M5a(this.R$);this.lq.$V(this.onActiveSlideDomReady);this.lq.Gqb(this.qna);this.lq.sOd(this.KYa);this.pa.GG(this.S$)};this.dispose=()=>{this.Xt.Cm(this.hh);this.ve.DJb(this.R$);this.lq.Una(this.onActiveSlideDomReady);
this.lq.Inc(this.qna);this.lq.sPe(this.KYa);this.pa.Nxa(this.S$);this.ia=this.T9c=this.ly=this.Xz=this.jc=this.pa=this.lq=this.ve=this.Xt=null};this.KYa=()=>{this.G6b()};this.S$=()=>{this.G6b()};this.G6b=()=>{const Cb=this.pa.Xd();this.g_b();const zb=this.Xz.Pk();if(zb&&zb.length){var Pb=new Set;for(const oc of Cb)Pb.add(oc.id);for(const oc of zb)Pb.has(oc.id)?this.t6h(oc):this.GSk(oc);this.ia.La(zc.a.qlb,nj.a.execute,null)}};this.Poj=(Cb,zb)=>{zb&&Cb&&Cb.length&&(this.mVd(Cb[0])?(zb=this.ly.filter(Pb=>
!Cb.includes(Pb.EffectNodeId)),this.g_b(),this.fsa(),this.CNd(zb)):(zb=this.jc.oXf(Cb,zb),this.eNd(zb),zb=Object.assign([],this.ly),this.g_b(),this.fsa(),this.CNd(zb)),this.ia.La(zc.a.qlb,nj.a.execute,null))};this.fsa=()=>{const Cb=this.pa.Xd();this.pa.fsa(Cb)};this.CNd=Cb=>{if(Cb&&Cb.length){this.eNd(Cb);var zb=this.Xz.Pk();if(zb&&zb.length){Cb=new Map;for(var Pb of this.ly){var oc=dd.a.Hf(Pb.ShapeId);if(!oc){Vc.a.J(509620887,800,10,"EffectSelectionManager::addSelectedEffectHelper:  shape guid is null");
return}oc=oc.toString();Cb.has(oc)||Cb.set(oc,new Set);oc=Cb.get(oc);null===oc||void 0===oc?void 0:oc.add(Pb.EffectNodeId)}for(const Ec of zb)if(Pb=this.Fbb.VG(Ec))Pb.maa(!1),zb=Ec.id.toString(),(zb=Cb.has(zb)?Cb.get(zb):null)&&zb.size&&Pb.d2k(Array.from(zb));this.ve.sz(new vk.a(7))}}};this.srf=(Cb,zb)=>{zb&&Cb&&Cb.length&&(this.g_b(),Cb=this.jc.oXf(Cb,zb),this.CNd(Cb),this.ia.La(zc.a.qlb,nj.a.execute,null))};this.t6h=Cb=>{if(Cb){var zb=this.jc.mg(Cb);zb&&(zb=zb.hwb(Cb),this.eNd(zb),this.Fbb.VG(Cb).maa(!0))}};
this.GSk=Cb=>{Cb&&(Cb=this.Fbb.VG(Cb))&&Cb.maa(!1)};this.eNd=Cb=>{if(Cb&&Cb.length)for(const zb of Cb)this.mVd(zb.EffectNodeId)||(this.ly.push(zb),this.T9c.add(zb.EffectNodeId))};this.mVd=Cb=>this.T9c.has(Cb);this.hh=(Cb,zb)=>{zb&&zb.property===$a.a.dPd&&this.IT&&this.jc.mg(zb.node)===this.Xz&&(this.SJa(this.IT),this.G6b(),this.ve.sz(new vk.a(7)),this.ia.La(zc.a.qlb,nj.a.execute,null))};this.R$=(Cb,zb)=>{if(zb){if(this.IT=!!zb.G$&&0<=zb.G$.indexOf("Animation"))this.tEb=!0;this.SJa(this.IT);this.IT||
this.ia.La(zc.a.XDf,nj.a.execute,null)}};this.qna=(Cb,zb)=>{Cb=this.ua.Ba;zb&&Cb&&Cb.XN&&Cb===this.Xz&&(zb=zb.Gw)&&zb.shapeNode&&this.Xz&&this.xFa(this.Xz.Cb,zb.shapeNode)&&(this.SJa(this.IT),this.ia.La(zc.a.qlb,nj.a.execute,null))};this.xFa=(Cb,zb)=>Cb&&zb?Cb.equals(zb.slideId):!1;this.onActiveSlideDomReady=(Cb,zb)=>{zb&&(Cb=Object(C.a)(116,zb.Ba))&&this.Xz&&this.Xz.Cb!==Cb.Cb&&(this.Xz=Cb,this.g_b(),this.SJa(this.IT),this.ia.La(zc.a.qlb,nj.a.execute,null))};this.SJa=Cb=>{if(this.tEb&&this.Xz&&this.Xz.XN&&
this.Kc.Ic&&this.Kc.Ic.sGc){var zb=this.Xz.Pk();if(zb&&zb.length)for(const Pb of zb)if(zb=this.Fbb.VG(Pb))zb.visible=Cb,zb.Uhb()}};this.g_b=()=>{this.T9c.clear();this.ly.length=0};if(!f)throw Error.argumentNull("actionManager");if(!x)throw Error.argumentNull("graphTopologyManager");if(!N)throw Error.argumentNull("slideReader");if(!ea)throw Error.argumentNull("graphNodeEventHandlers");if(!ma)throw Error.argumentNull("viewElementEventHandler");if(!Ha)throw Error.argumentNull("viewEventNotifier");if(!Ua)throw Error.argumentNull("animationMarkerViewManager");
if(!mb)throw Error.argumentNull("activeSlideViewManager");if(!gb)throw Error.argumentNull("selectionManager");this.ia=f;this.ua=x;this.jc=N;this.Xt=ea;this.lq=ma;this.Fbb=Ua;this.ve=Ha;this.Xz=this.ua.Ba;this.Kc=mb;this.pa=gb}}Object(k.a)(wk,"EffectSelectionManager",null,[669,106]);class yl{constructor(){this.K=null;this.eCb=!1}get name(){return"PowerPointWebEditor.Animations"}$b(f){this.K=f;(this.eCb=this.K.resolve("PowerPointWebEditor.IApplicationContext").od.Yqb)?(this.K.register(255,"PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.Animations.IAnimationMarkerView>").ma().oa(()=>
new em.a((x,N)=>{let ea=null;const ma=Object(C.a)(117,x.sc(this.K.resolve("Box4.IPageView").Ma));ma&&!ma.Al&&ma.xa&&(ea=new ik(x,this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.resolve("PowerPointWebEditor.Graph.ITraverserFactory"),this.K.resolve("Box4.IParagraphReader"),Object(v.a)(ma,ma.FM,"takeOwnershipOfSubtree"),this.K.resolve("Box4.IPageView").Ma,this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.K.resolve("Common.MouseInputManager"),this.K.resolve("Common.IClickInputManager"),
this.K.resolve("PowerPointWebEditor.IFocusManager"),J.AFrameworkApplication.we,this.K.resolve("PowerPointWebEditor.IPPTUnitConversion"),N,()=>{ma.fDa()},this.K.resolve("PowerPointWebEditor.Animations.IEffectSelectionManager")),ea.Im(ma.xa),ea.setZIndex(4),ea.visible=!1,ma.FM(ea.me.xa,!0),ma.dra(ea,4));return ea})),this.K.register(wk,"PowerPointWebEditor.Animations.IEffectSelectionManager").ma().oa(()=>new wk(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.resolve("Box4.Graph.IGraphInstance").Ad(8),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),this.K.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.Animations.IAnimationMarkerView>"),this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager")))):(this.K.register(255,
"PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.Animations.IAnimationMarkerViewLegacy>").ma().oa(()=>new em.a((x,N)=>{let ea=null;const ma=Object(C.a)(117,x.sc(this.K.resolve("Box4.IPageView").Ma));ma&&!ma.Al&&ma.xa&&(ea=new Zf(x,this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.resolve("PowerPointWebEditor.Graph.ITraverserFactory"),this.K.resolve("Box4.IParagraphReader"),Object(v.a)(ma,ma.FM,"takeOwnershipOfSubtree"),this.K.resolve("Box4.IPageView").Ma,this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),
this.K.resolve("Common.MouseInputManager"),this.K.resolve("Common.IClickInputManager"),this.K.resolve("PowerPointWebEditor.IFocusManager"),J.AFrameworkApplication.we,this.K.resolve("PowerPointWebEditor.IPPTUnitConversion"),N,()=>{ma.fDa()}),ea.Im(ma.xa),ea.setZIndex(4),ea.visible=!1,ma.FM(ea.me.xa,!0),ma.dra(ea,4));return ea})),this.K.register(Cg,"PowerPointWebEditor.Animations.AnimationMarkerManagerLegacy").ma().oa(()=>new Cg(this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.ISlideReader"),
this.K.resolve("Box4.Graph.IGraphInstance").Ad(8),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),this.K.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.Animations.IAnimationMarkerViewLegacy>"),this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"))))}init(){this.eCb?this.K.resolve("PowerPointWebEditor.Animations.IEffectSelectionManager").initialize():this.K.resolve("PowerPointWebEditor.Animations.AnimationMarkerManagerLegacy").initialize()}dispose(){this.eCb?
this.K.resolve("PowerPointWebEditor.Animations.IEffectSelectionManager").dispose():this.K.resolve("PowerPointWebEditor.Animations.AnimationMarkerManagerLegacy").dispose()}static main(){Na.a.instance.Dc(Hf.a(new yl,0))}}Object(k.a)(yl,"PPTWebEditorAnimationsPackage",null,[2,3]);var tg=d(1029),Pi=d(122);class Jl{constructor(f,x,N,ea){this.ia=f;this.Fa=x;this.pte=N;this.qc=ea}vb(){this.ia.ya(zc.a.find,jc.a.view,Object(v.a)(this,this.findText,"findText"));this.ia.ya(zc.a.find,jc.a.notes,Object(v.a)(this,
this.findText,"findText"));this.ia.ya(zc.a.find,jc.a.Of,Object(v.a)(this,this.findText,"findText"));this.ia.ya(ba.a.findInDocument,jc.a.view,Object(v.a)(this,this.findInDocument,"findInDocument"));this.ia.he(zc.a.find,0);this.ia.ya(zc.a.$0,jc.a.view,Object(v.a)(this,this.$0,"replaceText"));this.ia.ya(zc.a.$0,jc.a.notes,Object(v.a)(this,this.$0,"replaceText"));this.ia.ya(zc.a.$0,jc.a.Of,Object(v.a)(this,this.$0,"replaceText"));this.ia.he(zc.a.$0,4)}De(){const f=[this.Fa.Gc(Pi.a.JD),this.Fa.Gc(Pi.a.J2),
this.Fa.Gc(Zc.a.rg),this.Fa.Gc(Zc.a.iQ)];for(const x of f)x.bindAction(Zb.KeyInputManager.Na(og.a.ipa,Zb.KeyInputManager.Le),zc.a.find),x.bindAction(Zb.KeyInputManager.Na(og.a.Ulb,Zb.KeyInputManager.Le),zc.a.$0)}findText(f,x,N){return x.contextId!==jc.a.view&&x.contextId!==jc.a.notes&&x.contextId!==jc.a.Of?2:1===N?this.qc.Lj()?32:8:2===N?(this.pte.txh(x),Vc.a.J(539773087,820,50,"FindTextDialog is initialized."),32):8}$0(f,x,N){return x.contextId!==jc.a.view&&x.contextId!==jc.a.notes&&x.contextId!==
jc.a.Of?2:1===N?this.qc.Lj()?32:8:2===N?(this.pte.cll(x),Vc.a.J(539773088,820,50,"ReplaceTextDialog is initialized."),32):8}findInDocument(f,x,N,ea,ma){if(x.contextId!==jc.a.view&&x.contextId!==jc.a.notes&&x.contextId!==jc.a.Of)return 2;if(1===N)return 32;if(2===N){if(!ma)return 8;f=ma.CommandValueId||"";Vc.a.J(539773089,820,50,"Find. ActionData QueryLength: {0}",f.length);this.pte.Kkl(x,f);Vc.a.J(539773090,820,50,"FindTextDialog is initialized from Search Box.");return 32}return 8}}Object(k.a)(Jl,
"FindReplaceTextActor",null,[227]);var pm=d(1220);class hn extends pm.a{constructor(f,x,N){super(!1,!0);this.Wqe=!1;this.P9c=null;this.ZCb=!1;this.Iug=this.$vg=null;this.ote=!0;this.yte=this.zte=this.xte=!1;this.oma=null;this.i9c=!1;this.Sye=!0;this.VSg=this.Ave=!1;this.uQg=this.wQg=null;this.PEg=0;this.Fa=f;this.t9=x;this.cdk="FindReplaceTextDialog";this.Z_=ResourceStrings.l_FindTextTitle;N&&(this.Z_=ResourceStrings.l_ReplaceTextTitle);this.Dve=N;this.GV=!1}T5(){this.$i(this.Z_,this.t9,this.q8());
this.Wqe=!1}dispose(){super.dispose();this.Wqe=!0}ELi(){this.xte=this.ote=!1;this.u6(this.Z_,this.t9,this.q8())}fPf(f){f&&(this.Fa.xf(Bd.AFrame.i5),this.xte=!0);this.ote=!0;this.u6(this.Z_,this.t9,this.q8())}j7b(){this.hide()}m5k(f){this.P9c=f.searchString;this.ZCb=f.matchCase;this.oma=f.replaceString}Al(){return this.Wqe}L_a(f,x){this.Iug=f;this.PEg=x;this.VSg=0===x;this.u6(this.Z_,this.t9,this.q8())}und(f){this.$vg=f;this.u6(this.Z_,this.t9,this.q8())}Qnd(f){this.wQg=f;this.u6(this.Z_,this.t9,this.q8())}eUe(f){this.uQg=
f;this.u6(this.Z_,this.t9,this.q8())}get q_a(){return this.P9c}set q_a(f){this.P9c=f}get matchCase(){return this.ZCb}set matchCase(f){this.ZCb=f}get RPe(){return this.oma}set RPe(f){this.oma=f}EPi(f){f&&(this.Fa.xf(Bd.AFrame.i5),this.zte=!0);this.i9c=!0;this.u6(this.Z_,this.t9,this.q8())}mZd(){this.zte=this.i9c=!1;this.u6(this.Z_,this.t9,this.q8())}DPi(f){f&&(this.Fa.xf(Bd.AFrame.i5),this.yte=!0);this.Sye=!0;this.u6(this.Z_,this.t9,this.q8())}GLi(){this.yte=this.Sye=!1;this.u6(this.Z_,this.t9,this.q8())}anl(){this.Z_=
ResourceStrings.l_ReplaceTextTitle;this.Dve=!0;this.i9c=!1;this.u6(this.Z_,this.t9,this.q8());this.Fa.xf(Bd.AFrame.i5)}CPi(){this.Ave=!0;this.u6(this.Z_,this.t9,this.q8())}K2i(){return{["searchString"]:this.P9c,["findNextButtonAriaLabel"]:this.$vg,["errorMessage"]:this.Iug,["findNextButtonIsEnabled"]:this.ote,["focusFindNextButton"]:this.xte,["focusDialog"]:Object(v.a)(this,this.OYi,"focusDialog"),["isReplaceActive"]:this.Dve,["replaceButtonIsEnabled"]:this.i9c,["replaceAllButtonIsEnabled"]:this.Sye,
["showMessageAsError"]:this.VSg,["messageStatus"]:this.PEg,["focusReplaceButton"]:this.zte,["focusReplaceAllButton"]:this.yte,["replaceButtonAriaLabel"]:this.wQg,["replaceAllButtonAriaLabel"]:this.uQg,["readOnlyModeEnabled"]:this.Ave}}q8(){return{["id"]:this.cdk,["bodyControls"]:this.K2i(),["isModal"]:!1}}OYi(){this.Fa.xf(Bd.AFrame.i5)}}Object(k.a)(hn,"ReactFindReplaceTextDialog",pm.a,[695]);class Em{constructor(f){this.Fa=f}getInstance(f,x){return new hn(this.Fa.value,f,x)}}Object(k.a)(Em,"FindReplaceTextDialogFactory",
null,[642]);class fm{constructor(){this.j6=this.lga=this.paragraphIndex=this.GR=this.slideIndex=0}reset(){this.slideIndex=this.GR=this.paragraphIndex=0;this.lga=this.j6=-1}clone(){const f=new fm;f.slideIndex=this.slideIndex;f.GR=this.GR;f.paragraphIndex=this.paragraphIndex;f.lga=this.lga;f.j6=this.j6;return f}}Object(k.a)(fm,"TextPosition",null,[]);class qm{constructor(){this.fwe=this.V2c=null;this.dP=new fm;this.km=new fm;this.state=this.XKa=0;this.msb=this.G0d=!1;this.pattern=this.d1b=this.f1b=
null;this.matchCase=!1;this.reset()}reset(){this.XKa=0;this.dP.reset();this.km.reset();this.state=0;this.msb=this.G0d=!1;this.fwe=this.LQa=this.d1b=this.f1b=null}get LQa(){return this.V2c}set LQa(f){if(this.V2c=f)this.fwe=this.V2c}get $Wj(){return this.fwe}}Object(k.a)(qm,"FindContext",null,[]);var Ik=d(51),Jk=d(92);class Kl{constructor(){this.ShouldMatchCase=!1}}Object(k.a)(Kl,"MatchTextInfo",null,[]);class Fm{constructor(){this.ActiveSlideSid=this.ActiveSlideCid=0;this.OldStr=this.NewStr=this.MatchTxtInfo=
null}}Object(k.a)(Fm,"ReplaceAllTextInfo",null,[]);var ck=d(952),Ui=d(160),Ch=d(957),Ba=d(323);class il{constructor(f,x,N,ea,ma,Ha,Ua,mb,gb,Cb,zb,Pb,oc,Ec,Xc,Ac,zd,ue,bf,Ce,qg,Df,Bi){this.BHa=this.vm=this.iE=null;this.Bd=new qm;this.oma=this.VF="";this.Iec=!1;this.ZDb=this.Rdb=0;this.YDb=Date.now();this.h9c=-1;this.nte=0;this.O8c=-1;this.ia=f;this.Occ=x;this.Fa=N;this.Lq=ea;this.qc=ma;this.Ea=Ha;this.Xl=Ua;this.Dva=mb;this.Fb=gb;this.zb=Cb;this.Vb=zb;this.ua=Pb;this.Pb=oc;this.Jb=Ac;this.ve=Ec;this.Gq=
Xc;this.cJ=zd;this.$Ha=ue;this.iEg=bf;this.peb=Ce;this.mak=qg;this.FL=Bi;this.vQg=Df}txh(f){this.iE=f;this.vm=this.iEg.value.getInstance(Object(v.a)(this,this.VTf,"findReplaceTextDialogResultHandler"),!1);this.VF&&(this.vm.q_a=this.VF,this.O8c=-1);this.vm.T5();3!=this.ia.mode&&this.vm.CPi();this.CUa()&&this.kZd()}Kkl(f,x){this.CUa()||(this.VF=x);this.txh(f);this.CUa()||(this.vm.q_a=this.VF,this.vm.T5(),this.O0e(x,!1))}cll(f){this.iE=f;this.vm=this.iEg.value.getInstance(Object(v.a)(this,this.VTf,"findReplaceTextDialogResultHandler"),
!0);this.VF&&(this.vm.q_a=this.VF);this.vm.T5();this.CUa()&&this.kZd()}VTf(f,x){if(x)switch(this.vm.m5k(x),f){case 1:this.Pmk();break;case 2:this.Qmk();break;case 3:this.Rmk(this.vm.RPe);break;default:this.efl(),this.clearSelection(),this.Bd.reset(),this.vm.j7b()}else Vc.a.J(512496416,820,10,"Got null control value for findreplace dialog")}w9f(){return this.Bd.f1b&&this.LMd!==this.Bd.f1b.oe}O0e(f,x){this.AMf();if(0===this.Bd.state||3===this.Bd.state||f!==this.VF||x!==this.Iec||this.w9f())this.uBj(f,
x),this.O8c=-1;this.Bd.msb=!1;this.Ndd()}get LMd(){return this.ua.Ba?this.ua.Ba.oe:0}uBj(f,x){const N=f===this.VF&&3===this.Bd.state&&!this.w9f(),ea=this.Bd.dP.clone();this.Bd.reset();this.VF=f;this.Iec=x;N?this.Bd.dP=ea.clone():(this.Bd.dP.slideIndex=this.LMd,this.H8i());this.Bd.km=this.Bd.dP.clone()}Ndd(){this.kXi(this.VF,this.Iec)?4!==this.Bd.state&&this.setSelection():(e.ULS.sendTraceTag(539829126,820,50,"Text not found"),this.B2b())}kXi(f,x){var N=this.ua.presentation;if(!N)throw Error.argumentNull("Presentation is null");
if(N=N.slides||[],N.length){this.Bd.XKa=N.length;const ea=N.length+this.Bd.dP.slideIndex;for(;this.Bd.km.slideIndex<=ea;){const ma=this.Bd.km.slideIndex%N.length,Ha=this.mXi(N[ma],f,x,this.Bd.km.slideIndex===ea?this.Bd.dP.GR:il.hCe);if(Ha&&(this.Bd.f1b=this.qc.zl(Ha.Cb)))return!0;if(7===this.Bd.state)return this.Bd.msb&&(Vc.a.J(512496414,820,50,"call into PerformBackendFind recursively."),this.Bd.state=0),this.szk(N[ma]?N[ma].Cb:null,f,x);if(3===this.Bd.state)break;let Ua;(Ua=this.Bd.km).slideIndex=
Ua.slideIndex+1;this.Bd.km.GR=0}}else this.Bd.state=1;return!1}mXi(f,x,N,ea){if(!f)return null;var ma=this.qc.zl(f.Cb),Ha=this.Pb.Nc(ma);ma=ma.SSa()||[];(Ha=Ha.Bb(27))&&ma.push(Ha);if(!ma.length)return this.Bd.state=7,null;for(;this.Bd.km.GR<=Math.min(ma.length-1,ea);){if(this.Bd.d1b=this.lXi(ma[this.Bd.km.GR],x,N,this.Bd.km.GR===ea?this.Bd.dP.paragraphIndex:il.hCe))return f;let Ua;(Ua=this.Bd.km).GR=Ua.GR+1;this.Bd.km.paragraphIndex=0}return null}lXi(f,x,N,ea){if(!this.Xl.iFa(f)&&f.sC)return null;
const ma=Jk.a.createInstance(f);let Ha=0;for(;ma.moveNext()&&this.Bd.km.paragraphIndex<=ea;){const Ua=ma.currentNode;if(jg.ParagraphReader.Yd(Ua)&&Ha++===this.Bd.km.paragraphIndex){if(this.Bd.LQa=this.iXi(Ua,x,N,this.Bd.km.paragraphIndex===ea?this.Bd.dP.lga:il.hCe))return f;let mb;(mb=this.Bd.km).paragraphIndex=mb.paragraphIndex+1;this.Bd.km.lga=this.Bd.km.j6=-1}}return null}iXi(f,x,N,ea){if(!jg.ParagraphReader.Yd(f))return null;let ma=f.bwb();if(!ma.length)return null;ma=ma.substring(0,Math.min(ma.length,
ea));return this.nXi(ma,Math.max(0,this.Bd.km.j6),x,N)?f:null}nXi(f,x,N,ea){let ma=f,Ha=N;ea||(ma=f.toLowerCase(),Ha=N.toLowerCase());f=ma.indexOf(Ha,-1===x?0:x);if(-1!==f)return this.Bd.km.lga=f,this.Bd.km.j6=f+Ha.length,this.Bd.state=2,this.Bd.G0d=!0;this.Bd.state=1;return!1}H8i(){var f=Ui.b(this.iE);f=f?f.Lb:null;if(!f||!f.Pa)e.ULS.sendTraceTag(512496411,820,50,"There could be no slide at all");else if(f.Pa.mb){var x=f.Pa.mb.Ua;if(jg.ParagraphReader.Yd(x.node)){f=Object(C.a)(5,x.node);this.Bd.dP.lga=
x.Qa;this.Bd.dP.j6=x.Qa;const N=this.Ea.Xca(x.node);N?(this.Bd.dP.GR=N.get_zIndex()-1,this.Bd.dP.paragraphIndex=this.A2f(f)):this.Xl.Awb(x.node)&&(x=this.ua.Ba?this.ua.Ba.SSa():null,this.Bd.dP.GR=x?x.length:0,this.Bd.dP.paragraphIndex=this.A2f(f))}else this.Ea.wFa(x.node)&&(this.Bd.dP.GR=x.node.get_zIndex()-1)}}A2f(f){f=this.Pb.Nc(f);if(!f.q6(N=>10===N.type||60===N.type||16===N.type))return 0;f.zc();const x=f.xq;f.zc();return Math.max(0,f.mSa(x))}WZg(){const f=this.ua.presentation;if(!f)throw Error.argumentNull("Presentation is null");
return this.Bd.dP.slideIndex||this.Bd.dP.GR?this.Bd.km.slideIndex<(f.slides||[]).length:!1}j7f(){const f=this.ua.presentation;if(!f)throw Error.argumentNull("Presentation is null");this.Bd.km.slideIndex=f.slides?f.slides.length:0;this.Bd.msb=!1;this.Ndd()}$Xc(){return this.vm.Al()}kmk(f){if(!this.$Xc()){Vc.a.J(512496409,820,50,"OnBackendFindSucceeded");var x=Cd.a.empty;({slideId:x}=Cd.a.eDh(f));(f=this.qc.Vja(x))?(x=f.slideIndex,x>this.Bd.dP.slideIndex&&x<this.Bd.km.slideIndex?this.B2b():this.Vb.Ba!==
f?(this.Lq.$V(Object(v.a)(this,this.iGb,"onActiveSlideDomChanged")),this.Vb.Ba=f):(this.Bd.state=5,this.Bd.msb=!0,this.Bd.km.slideIndex=this.Bd.km.slideIndex>x?x+this.Bd.XKa:x,this.Bd.km.GR=0,this.Bd.km.paragraphIndex=0,this.Bd.km.lga=-1,this.Bd.km.j6=-1,this.Ndd())):this.WZg()?this.j7f():this.B2b()}}iGb(){Vc.a.J(512496408,820,50,"OnActiveSlideDomChanged");this.Lq.Una(Object(v.a)(this,this.iGb,"onActiveSlideDomChanged"));this.$Xc()||this.BHa||(this.BHa=new cd.a(3,1,0,Object(v.a)(this,this.FGe,"onPostActiveSlideDomChangedTask"),
90,"30"),this.zb.Eb(this.BHa))}FGe(){Vc.a.J(512496407,820,50,"OnPostActiveSlideDomChangedTask");this.BHa=null;if(!this.$Xc())if(4===this.Bd.state){const f=this.LMd;this.Bd.km.slideIndex=this.Bd.km.slideIndex>f?f+this.Bd.XKa:f;this.Bd.state=5;this.Bd.msb=!0;this.Ndd()}else 2===this.Bd.state?this.setSelection():this.B2b()}jmk(){this.$Xc()||(Vc.a.J(512496406,820,50,"OnBackendFindFailed"),this.WZg()?this.j7f():this.B2b())}szk(f,x,N){Vc.a.J(512496405,820,50,"PerformBackendFind");this.Occ.findText(x,N,
f.toString(),Object(v.a)(this,this.kmk,"onBackendFindSucceeded"),Object(v.a)(this,this.jmk,"onBackendFindFailed"));this.Bd.state=4;return!0}B2b(){this.Bd.state=this.Bd.G0d?3:1;Vc.a.J(512496404,820,50,"End of Find: {0}",this.Bd.state);this.clearSelection();this.L_a(0,"")}getShapeType(f){return f.lx?ResourceStrings.L_TextBox:f.ar?ResourceStrings.l_Chart:f.ud?ResourceStrings.L_Table:f.Rf?ResourceStrings.L_SmartArt:f.Mp?ResourceStrings.L_Media:f.Ej?ResourceStrings.l_Picture:f.gl?ResourceStrings.l_Placeholder:
ResourceStrings.l_ShapeObject}setSelection(){var f=this.Bd.LQa,x=this.Bd.f1b;if(this.Vb.Ba!==x)this.Lq.$V(Object(v.a)(this,this.iGb,"onActiveSlideDomChanged")),this.Vb.Ba=x;else{f=Ik.SelectionFactory.V2(f,this.Bd.km.lga,this.Bd.km.j6);if(this.Xl.iFa(this.Bd.d1b))this.ia.La(zc.a.SKa,2,new ck.a(!0)),this.Fa.xf(Pi.a.J2),this.Dva.setSelection(f),this.L_a(this.Bd.km.slideIndex%this.qc.Lj()+1,ResourceStrings.l_NotesPaneType);else{x=this.Bd.d1b;const N=this.Bd.d1b.tg(this.Fb.Ma);if(N)if(N.$p){let ea;(ea=
this.Bd.km).GR=ea.GR+1;this.Bd.km.paragraphIndex=0;this.Bd.km.lga=0;this.Bd.km.j6=0;N.zpd()}else this.mak&&x.Rf?(this.ve.ieh(new Ba.a(x)),this.$Ha.setSelection(f)):(this.Fa.xf(Zc.a.rg),this.Fb.setSelection(f));this.L_a(this.Bd.km.slideIndex%this.qc.Lj()+1,this.getShapeType(x))}Vc.a.J(512496402,820,50,"Find Text: {0}/{1}/{2}/({3},{4} )",this.Bd.km.slideIndex,this.Bd.km.GR,this.Bd.km.paragraphIndex,this.Bd.km.lga,this.Bd.km.j6);this.G_d()}}clearSelection(){var f=Ui.b(this.iE);if(f=f?f.Lb:null){var x=
this.Bd.$Wj;x&&(x=Ik.SelectionFactory.Qg(x,0),f.setSelection(x))}else Vc.a.J(512496401,820,10,"Find Replace Text: Selection manager received as null when clearing selection")}L_a(f,x){const N=new Sys.StringBuilder,ea=new Sys.StringBuilder;let ma=!1;f!=this.O8c?(this.O8c=f,this.nte=1):this.nte++;switch(this.Bd.state){case 1:ma=!0;N.append(ResourceStrings.l_FindTextNotFound);break;case 3:N.append(ResourceStrings.l_FindTextFindOver);break;case 6:ma=!0;N.append(ResourceStrings.l_FindTextFindAgain);break;
case 2:ea.append(String.format(ResourceStrings.l_FindTextMessageWithCount,this.nte,f,x));break;default:Vc.a.J(512496400,820,50,"Find Text: {0}",this.Bd.state)}this.t7k(N.toString(),ma,ea.toString());this.G_d()}Msl(f){f=this.hWk(f);32===f&&this.O0e(this.VF,this.Iec);16===f&&(this.vm.L_a(ResourceStrings.l_ReplaceTextErrorMessage,0),this.vm.mZd(),this.vm.fPf(!0))}hWk(f){return Af.a.M0d("SingleReplaceAction",zc.a.$0,()=>{f||(f="",Vc.a.J(512496399,820,50,"Replacing with empty string"));var x=this.Bd.LQa;
if(!x)return Vc.a.J(512496398,820,10,"ParagraphNode not set in findContext"),16;var N=this.Bd.km.lga;const ea=this.Bd.km.j6;if(-1===N||-1===ea)return Vc.a.J(512496397,820,10,"Invalid start or end position of current text selection."),16;const ma=this.Gq.le(15);ma.kd(x);this.cJ.replaceTextRange(Wh.a.createTextRange(x,N,ea),f,!0,!1,zc.a.$0);x=N+f.length;N=x!==this.Bd.km.j6;this.Bd.km.j6=x;ma.dispose();N&&this.setSelection();return 32})}G_d(){this.vm.fPf(1===this.Rdb);this.kPf();this.vm.DPi(3===this.Rdb)}kPf(){this.Bd.LQa?
this.vm.EPi(2===this.Rdb):this.vm.mZd()}AMf(){this.vm.ELi();this.vm.mZd();this.vm.GLi()}t7k(f,x,N){2===this.Rdb?(this.vm.Qnd(ResourceStrings.l_ReplaceTextReplaced+". "+N),this.vm.und("")):(this.vm.und(N),this.vm.Qnd(""));this.vm.eUe("");this.vm.L_a(f,x?0:1)}wSi(f,x){const N=Af.a.Ik("FindNext");N.Va("CommandId",f.toString());N.Va("IsReadOnlyModeEnabled",this.vm.Ave.toString());try{x()}finally{N.finish(!0)}}Pmk(){H.a.Wa(this.vm.q_a)||this.wSi(zc.a.find,()=>{Vc.a.J(512496396,820,50,"Find Text Started");
this.Rdb=1;this.O0e(this.vm.q_a,this.vm.matchCase);return 32})}Qmk(){this.vm.Dve?(Vc.a.J(512496394,820,50,"Replace Text Started"),this.Rdb=2,this.Msl(this.vm.RPe)):(this.vm.anl(),Vc.a.J(512496395,820,50,"Find dialog switched to replace dialog"),this.kPf())}Rmk(f){this.CUa()?Vc.a.J(512496393,820,10,"ReplaceAll Already in progress. ReplaceAllStartTime:{0}, Time diff:{1}",this.ZDb,Date.now()-this.ZDb):H.a.Wa(this.vm.q_a)||(Ud.a("FixReplaceAllTimeOutError")&&(this.ua.presentation.Efa=-16),this.VF=this.vm.q_a,
this.oma=f?f:"",this.ZDb=Date.now(),this.Rdb=3,this.kZd(),this.iWi(this.ua.Ba,this.VF,this.oma,this.Iec),0<this.vQg&&(this.h9c=window.setTimeout(()=>{this.c5g()},this.vQg)),16===this.replaceAll()&&(this.YDb=Date.now(),this.xDf(),this.c5g()))}replaceAll(){return Af.a.M0d("ReplaceAllAction",zc.a.$0,()=>{Vc.a.J(512496392,820,50,"ReplaceAll Text Started");const f=this.ua.presentation;if(f){const x=this.Jb.zd(15);try{x.nc(f),this.peb.ik(Object(v.a)(this,this.vgb,"onPresentationPropertyChange")),f.FJb=
Object.assign(new Fm,{NewStr:this.oma,OldStr:this.VF,ActiveSlideCid:this.ua.Ba.cid,ActiveSlideSid:this.ua.Ba.sid,MatchTxtInfo:Object.assign(new Kl,{ShouldMatchCase:this.vm.matchCase})})}finally{x&&x.dispose()}return 32}return 16})}iWi(f,x,N,ea){if(f){f=this.qc.zl(f.Cb);var ma=this.Pb.Nc(f);f=f.SSa()||[];(ma=ma.Bb(27))&&f.push(ma);if(f.length)for(ma=0;ma<=f.length-1;)this.rXi(f[ma],x,N,ea),ma++}else Vc.a.J(512496391,820,50,"slide must not be null.")}rXi(f,x,N,ea){if(this.Xl.iFa(f)||!f.sC)for(f=Jk.a.createInstance(f);f.moveNext();){const ma=
f.currentNode;if(!jg.ParagraphReader.Yd(ma))continue;let Ha=null;(Ha=this.jXi(ma,x,ea))&&Ha.characterData.replace(x,N)}}jXi(f,x,N){if(!jg.ParagraphReader.Yd(f))return Vc.a.J(512496390,820,50,"node must be ParagraphNode"),null;const ea=f.bwb();return ea.length?this.oXi(ea,x,N)?f:null:null}oXi(f,x,N){let ea=f,ma=x;N||(ea=f.toLowerCase(),ma=x.toLowerCase());return-1!==ea.indexOf(ma,0)?!0:!1}vgb(f,x){if(!this.CUa())Vc.a.J(512496389,820,50,"ReplaceAll Not Iniitated");else if(x.property===$a.a.NPe){this.xDf();
f=Object(C.a)(388,x.node);if(-1!==f.Efa){var N=2;if(0===f.Efa){x=ResourceStrings.l_FindTextNotFound;var ea=ResourceStrings.l_ReplaceAllCalloutNotificationNoMatchMessage;N=0;var ma=ResourceStrings.l_ReplaceAllCalloutNotificationNoMatchTitle}else 1===f.Efa?(x=String.format(ResourceStrings.l_ReplaceAllSuccessSingular,f.Efa,this.VF,this.oma),ea=String.format(ResourceStrings.l_ReplaceAllCalloutNotificationMessageSingular,f.Efa,this.VF,this.oma)):(x=String.format(ResourceStrings.l_ReplaceAllSuccessPlural,
f.Efa,this.VF,this.oma),ea=String.format(ResourceStrings.l_ReplaceAllCalloutNotificationMessagePlural,f.Efa,this.VF,this.oma)),ma=ResourceStrings.l_ReplaceAllCalloutNotificationSuccessTitle}else ma=ResourceStrings.l_ReplaceAllCalloutNotificationErrorTitle,x=ea=ResourceStrings.l_ReplaceAllErrorMessage,N=0,Vc.a.J(512496388,820,10,"Invalid ReplaceAllTextCount");this.YDb=Date.now();Vc.a.J(512496387,820,50,"Time taken for Replace All operation in ms: {0}",this.YDb-this.ZDb);this.ePf(x,N);this.peb.Cm(Object(v.a)(this,
this.vgb,"onPresentationPropertyChange"));this.vm.Al()&&this.pWe(ma,ea,10);f.Efa=-16}}CUa(){return this.ZDb>this.YDb}kZd(){var f=String.format(ResourceStrings.l_ReplaceAllInProgress,this.VF);this.vm.L_a(f,3);f=String.format(ResourceStrings.l_ReplaceAllInProgressDialogButtonsAriaLabel,ResourceStrings.l_ReplaceAllTextReplaceAll,this.VF);this.vm.eUe(f);f=String.format(ResourceStrings.l_ReplaceAllInProgressDialogButtonsAriaLabel,ResourceStrings.l_ReplaceTextReplace,this.VF);this.vm.Qnd(f);f=String.format(ResourceStrings.l_ReplaceAllInProgressDialogButtonsAriaLabel,
ResourceStrings.l_FindTextFindNext,this.VF);this.vm.und(f);this.AMf()}ePf(f,x){this.vm.L_a(f,x);this.vm.eUe(f);this.vm.Qnd("");this.vm.und("");this.G_d()}efl(){if(this.CUa()){var f=String.format(ResourceStrings.l_ReplaceAllInProgress,this.VF);this.pWe(ResourceStrings.l_ReplaceAllCalloutNotificationProgressTitle,f,1024)}}pWe(f,x,N){this.FL?(this.FL.qZd(),Vc.a.J(512496385,820,50,"Callout notification called for Replace All operation"),f=Object.assign(new Ch.a,{title:f,message:x,timeoutInSeconds:N}),
f=this.FL.wuh(f),f.hUa&&Vc.a.J(512496384,820,10,"Error in callout notification: Error:{0}",f.message)):Vc.a.J(512496386,820,10,"Find Replace Text: m_calloutNotification adapter is null.")}c5g(){let f=!1;this.CUa()&&(f=!0,this.YDb=Date.now());Vc.a.J(512496355,820,10,"Error returned in replace all operation. ReplaceAll Timeout: {0}, Time taken in ms: {1}",f,this.YDb-this.ZDb);this.ePf(ResourceStrings.l_ReplaceAllErrorMessage,0);this.peb.Cm(Object(v.a)(this,this.vgb,"onPresentationPropertyChange"));
this.vm.Al()&&this.pWe(ResourceStrings.l_ReplaceAllCalloutNotificationErrorTitle,ResourceStrings.l_ReplaceAllErrorMessage,10);this.ua.presentation.Efa=-16}xDf(){-1!==this.h9c&&(window.clearTimeout(this.h9c),this.h9c=-1)}}il.hCe=1024;Object(k.a)(il,"FindReplaceTextHandler",null,[643]);class Gg{constructor(f){this.EEg=this.KTg=null;this.ZCb=!1;this.J4=f}findText(f,x,N,ea,ma){this.EEg=f;this.ZCb=x;this.KTg=N;this.J4.yF(ea,ma,null)}get ell(){return this.KTg}get matchCase(){return this.ZCb}get sbd(){return this.EEg}}
Object(k.a)(Gg,"FindTextManager",null,[641]);var zj=d(384),Mf=d(108);class Ll extends Mf.a{constructor(){super();this.MatchText=null;this.MatchCase=!1;this.SlideID=null}$k(){return 54}static fVd(f,x,N){const ea=new Ll;ea.SlideID=N;ea.MatchText=f;ea.MatchCase=x;return ea}}Object(k.a)(Ll,"FindTextRequest",Mf.a,[]);class nc extends zj.a{constructor(f,x,N,ea){super();this.yGa=this.gIa=null;this.oO=this.h4=!1;this.Qbc=null;this.Qd=N;this.E1c=!1;this.Occ=x;this.Xa=ea;this.Lm=f;this.enabled=2;this.Lm.register(this)}yF(f,
x){this.E1c=!0;this.gIa=f;this.yGa=x;this.Lm.kaa()}forceOutbound(){}dka(){return this.E1c&&!this.h4}IN(){return!1}sTa(){return this.Ud&&2===this.Ud.status?!0:this.dka()}IJb(){if(1===this._state)this.Qbc=this.Xa.podSessionId,this.Ud.DH=Ll.fVd(this.Occ.value.sbd,this.Occ.value.matchCase,this.Occ.value.ell),this.Ud.status=1,this._state=3;else if(3===this._state&&this.Ud&&2===this.Ud.status){if(2!==this.Ud.statusCode)this.xH();else{if(!this.Ud.Or||1!==this.Ud.Or.length){this.xH();return}const f=this.Ud.Or[0];
0===f.StatusCode?(this.K0(),this.gIa&&this.gIa(f.SlideID)):(this.xH(f),124===f.StatusCode&&this.Qd.us(f.ServerError,this.Qbc))}this.Qbc=null}}xH(f=null){this.E1c=!1;this._state=1;Vc.a.J(21849603,824,15,"FindTextRequest failed. OperationResult:{0}, RequestStatus:{1}, HttpStatusCode:{2}, IsLastReplicationFailed:{3}, PodSessionId:{4}",f?f.StatusCode:-1,this.Ud?ve.a[this.Ud.statusCode]:"NULL",this.Ud?this.Ud.tv:-1,this.oO,this.Qbc||"NULL");this.oO=!0;this.yGa&&this.yGa(-1,-1)}K0(){this.E1c=!1;this._state=
1;Vc.a.J(25012056,818,this.oO?15:50,"FindTextRequest succeeded. IsLastReplicationFailed:{0}, PodSessionId:{1}",this.oO,this.Qbc||"NULL");this.oO=!1}dispose(){this.h4||(1===this._state&&this.Lm.unregister(this),this.h4=!0)}}Object(k.a)(nc,"FindTextReplicator",zj.a,[106]);class Tm{constructor(){this.K=null}get name(){return"PowerPointWebEditor.FindText"}$b(f){this.K=f;this.K.register(641,"PowerPointWebEditor.IFindTextManager").ma().oa(()=>new Gg(new nc(this.K.resolve("PowerPointWebEditor.IPPTReplicationScheduler"),
this.K.re("PowerPointWebEditor.IFindTextManager"),this.K.resolve("PowerPointWebEditor.IErrorHandler"),this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"))));this.K.register(642,"PowerPointWebEditor.IFindReplaceTextDialogFactory").ma().oa(()=>new Em(this.K.re("PowerPointWebEditor.IFocusManager")));const x=new tg.a(this.K.resolve("Common.App.CalloutNotification.ICalloutNotification"),this.K.resolve("PowerPointWebEditor.IRibbonPane").xa);this.K.register(643,"PowerPointWebEditor.IFindReplaceTextHandler").ma().oa(()=>
new il(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IFindTextManager"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("PowerPointWebEditor.Graph.INotesReader"),this.K.resolve("PowerPointWebEditor.INotesView"),this.K.resolve("Box4.IPageView"),this.K.resolve("Common.ITaskManager"),
this.K.resolve("PowerPointWebEditor.IPPTWorkspace"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventNotifier"),this.K.resolve("Box4.Graph.IGraphTransactionFactory"),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("Box4.ICharacterPropertiesEditor"),this.K.resolve("PowerPointWebEditor.ISmartArtTextView"),this.K.re("PowerPointWebEditor.IFindReplaceTextDialogFactory"),
this.K.resolve("Box4.Graph.IGraphInstance").Ad(7),this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointEditSmartArtTextPaneIsEnabled,this.K.resolve("Common.IAppSettingsManager").Fc("ReplaceAllClientTimeoutMS",0),x))}init(){let f=new Jl(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("PowerPointWebEditor.IFindReplaceTextHandler"),this.K.resolve("PowerPointWebEditor.IPresentationReader"));f.vb();f.De()}dispose(){}static main(){Na.a.instance.Dc(Hf.a(new Tm,
0))}}Object(k.a)(Tm,"PPTWebEditorFindTextPackage",null,[2,3]);class Nc{constructor(f){this.Ga=f}get jPd(){return"PowerPoint"}get EAf(){return"c551d75c-10b1-4de2-83cc-cce22d7c06bd"}get version(){return 1}get currentVersion(){return 0}get cKj(){return this.Ga.powerPointEditorFirstRunExperienceDataStoreIsEnabled}get Ozb(){return this.Ga.powerPointEditorFirstRunExperienceUIIsEnabled}get Pkg(){return this.Ga.powerPointEditorFirstRunExperienceTestIsEnabled}get rYi(){return"Microsoft.Office.Server.Powerpoint.Web.IWacPptEditorFirstRunExperienceUISettings"}get BYg(){return 24}get olh(){return 4E3}get soc(){return this.Ga.roamingServiceHandlerWebServiceBase||
""}}Object(k.a)(Nc,"FirstRunExperienceLauncherSettings",null,[1005]);class qf{constructor(f){this.ewg=f}Nfl(f){this.ewg&&this.ewg.xWe(f)}}Object(k.a)(qf,"FirstRunExperienceManager",null,[633]);class gm{constructor(){this.K=null}get name(){return"PowerPointWebEditor.FirstRunExperience"}$b(f){if(!f)throw Error.argumentNull("container");this.K=f;this.K.register(633,"PowerPointWebEditor.FirstRunExperience.IFirstRunExperienceManager").ma().oa(()=>new qf(this.K.resolve("Common.App.FirstRunExperienceLauncher.IFirstRunExperienceLauncher")))}init(){this.K.resolve("Common.IAppSettingsManager").jf(()=>
{this.xWe()})}dispose(){}xWe(){var f=this.K.resolve("PowerPointWebEditor.IApplicationSettings");if(!f)throw Error.argumentNull("appSettings");const x=this.K.resolve("PowerPointWebEditor.FirstRunExperience.IFirstRunExperienceManager");x&&(f=new Nc(f),x.Nfl(f))}static main(){Na.a.instance.Dc(new gm)}}Object(k.a)(gm,"PPTWebEditorFirstRunExperiencePackage",null,[2,3]);var Rh=d(177),Vf=d(394);class jn{constructor(){this.flyoutAnchorTarget=this.useCompactSummaryString=this.disableDismissOnClick=this.customDynamicEntryPointEnabled=
this.dynamicEntryPointEnabled=this.activityFeedDataEnabled=this.includeRelevantAuthorsInSummaryString=this.summaryStringEnabled=this.flyoutEnabled=this.featuredActivityGroupsEnabled=null}}Object(k.a)(jn,"CatchUpConfiguration",null,[]);class kn{constructor(){this.emptyCatchUpBehaviorManager=this.ulsLogger=this.uiCulture=this.flyoutRibbonButton=this.flyoutFocus=this.dataCulture=this.changeSummariesDataProvider=this.appColorUpdateIsEnabled=this.activityRequestManager=this.activityNavigationManager=this.activityContentManager=
null}}Object(k.a)(kn,"SharedControllerFactoryParameters",null,[]);const M=(f,x)=>{if(!f)throw Error.create(String.format("Argument {0} is null.",x));},Gm=f=>{if(!f.navigationId)return Vc.a.J(524895832,3012,10,"CreateNavigationData: navigation id is missing."),null;try{const x=window.atob(f.navigationId);return x&&""!==x?{["NavigationId"]:x}:null}catch(x){return Vc.a.J(524145986,3012,10,"CreateNavigationData: decoding navigation id failed.",x),null}};class jl{constructor(f){M(f,"ActivityContentManager.IActionManagerExtended");
this.ia=f}doesContentExist(f){if(!f)return Vc.a.J(524895831,3012,10,"DoesContentExist: activity is null."),!1;switch(f.type){case 2:case 3:case 4:case 6:case 8:case 9:case 7:case 10:return(f=Gm(f))?32===this.ia.La(ba.a.jub,2,f):!1;default:return!1}}}Object(k.a)(jl,"ActivityContentManager",null,[637]);class Aj{constructor(f){this.zn=f}shouldShowEmptyExperienceButton(){return J.AFrameworkApplication.K_c()}getExplanationText(){return""}getCommandName(){return ResourceStrings.L_FileHistory}onButtonClick(){this.zn.La(ba.a.Kqc,
2,null)}onInviteOthersButtonClick(){this.zn.La(ba.a.Ksa,2,null)}}Object(k.a)(Aj,"EmptyCatchUpBehaviorManager",null,[640]);class Cf{constructor(){this.color=this.imageUrl=this.email=this.givenName=this.displayName=this.provider=this.id=null}}Object(k.a)(Cf,"Person",null,[]);var Rf=d(644),jk=d(230),ki=d(166);class $n extends Mf.a{constructor(f){super();this.StartTime=null;this.StartTime=f}$k(){return 93}}Object(k.a)($n,"GetFileRevisionHistoryRequest",Mf.a,[]);class yg{constructor(f,x,N){this.ProviderId=
this.UserId=this.UserName=null;this.UserName=f;this.UserId=x;this.ProviderId=N}}Object(k.a)(yg,"Author",null,[]);const rm=(f,x)=>f&&x?f.providerIdField===x.ProviderId?f.userIdField===x.UserId:f.userNameField===x.UserName:!1;var dk=d(242);class Jj{constructor(f,x,N){this.z4c=this.Mbb=null;this.vi=f;this.acb=N;this.acb.m9h(Object(v.a)(this,this.$2g,"onFileRevisionHistoryReady"));x.jf(()=>{this.Mbb=new yg(x.Ha("UserName"),x.Ha("387"),x.Ha("388"))})}dispose(){this.acb.PTk(Object(v.a)(this,this.$2g,"onFileRevisionHistoryReady"));
this.Mbb=null}o8i(f,x,N){f&&N&&(this.z4c=N,f=new dk.a(new $n(f),ea=>{this.Cog(ea,x);this.Ted(ea)},ea=>{this.Cog(ea,x);return this.xgb(ea)}),this.vi.Eb(f))}$2g(f,x){f=null;const N=[];H.a.Wa(x.OOc)||(({OOc:x}=this.zul(x.OOc)).returnValue?ki.b(x.fileRevisionEntriesField,ea=>this.oPj(ea.changesDataField),ea=>{N.push(ea.changesDataField)}):f="ErrorGetFileRevisionHistoryParseJsonException");this.LFe(N,f)}Ted(f){let x=null;f.ServerError&&0!==f.ServerError.Code?x=jk.a[f.ServerError.Code]:0!==f.StatusCode&&
(x=Rf.a[f.StatusCode]);x&&this.LFe(null,x)}xgb(f){Vc.a.J(512262998,811,15,"OnGetFileRevisionAuthorNamesFailed() - "+f.toString());this.LFe(null,"ErrorGetFileRevisionHistoryFailed");return!0}LFe(f,x){this.z4c&&(f=this.n1i(f),this.z4c(f,x),this.z4c=null)}zul(f){let x;x=null;try{x=Sys.Serialization.JavaScriptSerializer.deserialize(f)}catch(N){Vc.a.J(512262997,811,10,"TryParseFileRevisionList() - Exception: "+N)}return{returnValue:!!x,OOc:x}}oPj(f){return!rm(f,this.Mbb)}Cog(f,x){f.Pxa&&x.Wm("GetAuthorNamesRequestInvokedTime",
f.Pxa);x.Va("GetAuthorNamesRequestCorrelationId",f.Jh)}n1i(f){if(!f)return[];const x=Array(f.length);for(let ea=0;ea<f.length;ea++){var N=f[ea];N=Object.assign(new Cf,{displayName:N.userNameField,id:N.userIdField,provider:N.providerIdField});x[ea]=N}return x}}Object(k.a)(Jj,"FileRevisionHistoryService",null,[680,106]);class gf{constructor(f,x){M(f,"FlyoutFocus.IF6Manager");M(x,"FlyoutFocus.IFocusManagerHelper");this.mh=f;this.jE=x}initialize(){this.jE.H8(Zc.a.v6a,Zc.a.nj,null,Object(v.a)(this,this.QYi,
"focusOnFirstFlyoutItem"),()=>{},!0)}enableF6Focus(){this.mh.EK(Zc.a.v6a)}disableF6Focus(){this.mh.Ho(Zc.a.v6a)}QYi(){const f=document.getElementById("flyoutItem0");f&&(Vc.a.J(570730465,3012,50,"Focused on the catch-up flyout via ctrl+F6"),f.focus())}}Object(k.a)(gf,"FlyoutFocus",null,[679]);class Ul{constructor(f,x,N,ea){this.j2c=null;this.Rqg=this.uxg=this.mCb=this.K5c=!1;M(x,"FlyoutRibbonButton.IActionManagerExtended");M(N,"FlyoutRibbonButton.IFocusManager");M(ea,"FlyoutRibbonButton.FloodgateEventLogger");
this.Qb=f;this.ia=x;this.Fa=N;this.t6j=ea;this.x6j=new Date}initialize(){J.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",!1)&&Ud.a("DelayRegisterCatchUpActions")||this.vb()}registerButtonClickedEvent(f){this.j2c&&Vc.a.J(571532947,3012,15,"RegisterButtonClickedEvent: Button clicked callback should only be registered once.");this.j2c=f.buttonClickedCallback}onFlyoutInitialized(){this.K5c&&Vc.a.J(571532948,3012,15,"OnFlyoutInitialized: Flyout should only be initialized once.");
const f=(new Date).getTime()-this.x6j.getTime();Vc.a.J(593601546,3012,50,"Time from retrieve activities to initialize Flyout: {0}",f);this.K5c=!0;gd.c(ba.a.Noi,!0,gd.e,0,0,f);J.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",!1)&&Ud.a("DelayRegisterCatchUpActions")&&this.vb();this.Qb&&this.Qb.updateCommandUI()}logFlightTriggers(){}onFlyoutVisibilityChanged(f){this.mCb!==f.flyoutIsVisible&&(this.mCb=f.flyoutIsVisible,this.Qb&&this.Qb.updateCommandUI(!0),
this.mCb&&this.Rqg?this.Fa.xf(Zc.a.v6a):this.mCb||this.Fa.xf(Zc.a.nj),this.mCb||this.t6j.R_j())}vb(){this.ia.ya(ba.a.ABh,Qb.a.frame,Object(v.a)(this,this.Utk,"onToggleCatchUpFlyout"));this.ia.ra(ba.a.ldh,Qb.a.frame,Object(v.a)(this,this.Grk,"onQueryToggleCatchUpFlyout"),96)}Utk(f,x,N){if(1===N)return this.K5c?(this.uxg||(this.uxg=!0,Vc.a.J(588129368,3012,50,"Catch Up Button Is Enabled.")),32):8;if(!this.j2c)return 8;this.Rqg=!0;this.j2c();return 32}Grk(f,x,N,ea,ma){ma[Vh.a.Visible]=!0;ma[Vh.a.On]=
this.mCb&&this.K5c;return 32}}Object(k.a)(Ul,"FlyoutRibbonButton",null,[678]);const Vi=f=>{window.performance&&"function"===typeof window.performance.mark&&window.performance.mark("CatchUpInit."+f)};class Rd{constructor(f,x,N,ea,ma,Ha){M(f,"PowerPointActivityNavigationManager.IActionManagerExtended");M(x,"PowerPointActivityNavigationManager.IPresentationReader");M(N,"PowerPointActivityNavigationManager.IThumbnailNavigationPaneView");M(ea,"PowerPointActivityNavigationManager.IRibbonUser");M(Ha,"PowerPointActivityNavigationManager.IActivityContentManager");
this.ia=f;this.qc=x;this.Ie=N;this.hB=ea;this.ibk=ma;this.E3j=Ha}navigateToActivity(f){if(f.fromSummaryString)return this.v6k(),this.coj(),this.$nj(),this.hfl(),Promise.resolve(1);f=f.activity;if(!f)return Vc.a.J(524145984,3012,10,"NavigateToActivity: activity is null."),Promise.resolve(8);if(!f.navigationId)return Vc.a.J(524145985,3012,10,"NavigateToActivity: navigation id is null."),Promise.resolve(4);if(!this.E3j.doesContentExist(f))return Promise.resolve(2);switch(f.type){case 2:case 3:case 4:case 6:case 8:case 9:case 7:case 10:f=
Gm(f);if(!f)return Promise.resolve(5);f=this.ia.La(ba.a.D_b,2,f);return Promise.resolve(32===f?1:6);default:return Promise.resolve(7)}}v6k(){const f=this.qc.Pn;f?f.lDa=!0:Vc.a.J(570831450,3012,10,"PowerPointActivityNavigationManager: IPageManifestNode is null.")}coj(){this.hB.selectRibbonTabById(this.ibk)}$nj(){var f=this.qc.Pn;if(f&&f.slides){var x=null;for(const N of f.slides)if(N&&(f=this.qc.zl(N.Cb))&&f.isUnread){x=f;break}x?(this.Ie.vnd(),this.Ie.xU(x.oe)):Vc.a.J(570831452,3012,15,"PowerPointActivityNavigationManager: Could not find any unread slides.")}else Vc.a.J(570831451,
3012,10,"PowerPointActivityNavigationManager: IPageManifestNode is null.")}hfl(){this.ia.La(zc.a.Wjb,2,{InvokeSource:1,ShowRevisionTrackingStatus:3})}}Object(k.a)(Rd,"PowerPointActivityNavigationManager",null,[638]);class kk{constructor(){this.collectionId=this.type=this.id=null;this.activityState=0;this.timestamp=this.activityFeedItemPayload=null}}Object(k.a)(kk,"ActivityFeedItem",null,[]);class Fe{constructor(){this.activityFeedItems=null}}Object(k.a)(Fe,"ActivityFeedPayload",null,[]);class ug{constructor(){this.lowWaterline=
this.highWaterline=this.wywaWaterline=this.actors=this.activities=null;this.hasMore=!1;this.isFirstDocumentOpen=null}}Object(k.a)(ug,"ActivityRequestPayload",null,[]);var Kk=d(530);class zl{constructor(){this.activityFeedItemId=this.activityId=null;this.type=0;this.collectionId=this.state=this.navigationId=this.relevancy=this.displayTimestamp=this.location=this.actors=null}}Object(k.a)(zl,"Activity",null,[]);class Dh{constructor(f,x,N,ea,ma,Ha,Ua,mb){this.Pf=this.qwe=null;M(f,"PowerPointActivityRequestManager.IJsonpHelperManager");
M(x,"PowerPointActivityRequestManager.PowerPointWaterlineUpdater");M(N,"PowerPointActivityRequestManager.IFileRevisionHistoryService");M(ea,"PowerPointActivityRequestManager.IAppSettingsManager");M(ma,"PowerPointActivityRequestManager.IApplicationSettings");M(Ha,"PowerPointActivityRequestManager.IActionManagerExtended");M(Ua,"PowerPointActivityRequestManager.ICatchUpRequestHandler");this.XGa=f;this.qek=x;this.n6j=N;this.Yb=ea;this.ia=Ha;this.q2c=Ua;this.lSg=mb}requestWYWAActivities(){return new Promise((f,
x)=>{this.Pf=Af.a.Ik("ShowWYWACallout",2);this.qek.nZk(N=>{N=this.HFk(N);Dh.isExpectedError(N)?f(Dh.PLc):N?(Vc.a.J(572111054,3012,10,"OnReadRoamingSucceeded() - Error: {0}",N),x(N)):this.n6j.o8i(this.qwe,this.Pf,(ea,ma)=>{ma&&(Vc.a.J(572111055,3012,10,"GetFileRevisionAuthorNamesAsync() - Error: {0}",ma),x(ma));f(Dh.bzi(ea))})},N=>{const ea=!!N.data&&Dh.eLj(N.data.Te);N=this.XGa.Nja(N);Vc.a.J(572111056,3012,ea?50:10,"OnReadRoamingFailed() - Error: {0}",N);ea?f(Dh.PLc):x(N)})})}requestActivities(){return Promise.resolve(Dh.PLc)}requestRelevantActivities(){return Promise.resolve(Dh.PLc)}requestActivityFeed(){return this.q2c?
Kk.b(this.q2c.getActivityFeed(this.lSg)).then(f=>Object.assign(new Fe,{activityFeedItems:Dh.csl(f)})):Promise.resolve(Object.assign(new Fe,{activityFeedItems:[]}))}updateActivityState(f){return this.q2c?Kk.b(this.q2c.Uwl(this.lSg,f.itemIds,f.activityStatesToSet||0,f.activityStatesToReset||0,f.resetUnseenCount)):Promise.resolve(!1)}HFk(f){f=f.data.Zd;if(!f)return"ErrorReadRoamingEmptyResponseBody";let x;try{x=JSON.parse(f)}catch(N){return N.toString()}f=null;if(!x.Error){if(!x.Timestamp)throw Error.create("response.Error and response.Timestamp are empty");
f=x.Timestamp}this.qwe=this.$Al(f);Vc.a.J(561588038,3012,100,"Timestamp for retrieving activities: "+this.qwe);return x.Error}$Al(f){const x={};var N=this.Yb.Fc("AppWaterlineOverrideTimestampValue",0);return N?(f=new Date(1E3*N),x.timestamp=f,this.ia.La(zc.a.Epd,2,x),f.format("yyyy-MM-ddTHH:mm:ssZ")):f?(N=this.Yb.Fc("AppWaterlineOverrideDaysValue",0))?(f=new Date(+new Date(f)-+new Date(864E5*N)),x.timestamp=f,this.ia.La(zc.a.Epd,2,x),f.format("yyyy-MM-ddTHH:mm:ssZ")):f:null}static bzi(f){return f?
Object.assign(new ug,{actors:f}):null}static csl(f){const x=[];if(!f)return x;for(const N of f)x.push(Object.assign(new kk,{id:N.id,type:N.type,collectionId:N.collectionId,activityState:N.activityState,activityFeedItemPayload:N.activityFeedItemPayload,timestamp:N.timestamp}));return x}static isExpectedError(f){return"ErrorDocNotInRoamingList"===f||"ErrorLastViewedDocListIsEmpty"===f}static eLj(f){return 403===f}}Dh.PLc=Object.assign(new ug,{activities:[],actors:[],hasMore:!1,highWaterline:"",lowWaterline:"",
wywaWaterline:""});Object.assign(new ug,{activities:[Object.assign(new zl,{activityId:"activityId1",type:3,actors:[Object.assign(new Cf,{id:"personId1",provider:"provider",displayName:"Kat Larsson",email:"klarsson@contoso.net"})],displayTimestamp:new Date,relevancy:2,navigationId:"navigationId1"}),Object.assign(new zl,{activityId:"activityId2",type:4,actors:[Object.assign(new Cf,{id:"personId2",provider:"provider",displayName:"Frankie Smith",email:"fsmith@contoso.net"})],displayTimestamp:new Date,
relevancy:2,navigationId:"navigationId2"})]});Object.assign(new Fe,{activityFeedItems:[Object.assign(new kk,{id:"FeedItemId1",type:"UserAtMentioned",collectionId:"CollectionId1",activityState:0,activityFeedItemPayload:'{"isReply":false,"id":"1","timestamp":"2021-10-05T14:15:25.1663372Z","data":{"activityId":"a1","navigationId":"n1","commentThreadId":"1","commentThreadIsTask":false},"fileDetails":{"documentUrl":"url","linkUrl":"url","siteUrl":"url","listItemUniqueId":"u1","sourceRelativeUrl":"url","sourceFileName":"file.pptx","sourceFileExtension":"pptx","hostItemId":"SPO_ID"},"actor":{"id":null,"provider":null,"email":"kat.larsson@microsoft.com","userPrincipalName":"klarsson@microsoft.com","name":"Kat Larsson","roles":"Creator","pictureUrl":null},"userRoles":"Mentioned"}',
timestamp:(new Date).toISOString()}),Object.assign(new kk,{id:"FeedItemId2",type:"UserAtMentioned",collectionId:"CollectionId1",activityState:0,activityFeedItemPayload:'{"isReply":false,"id":"2","timestamp":"2021-10-05T14:15:25.1663372Z","data":{"activityId":"a2","navigationId":"n2","commentThreadId":"2","commentThreadIsTask":false},"fileDetails":{"documentUrl":"url","linkUrl":"url","siteUrl":"url","listItemUniqueId":"u1","sourceRelativeUrl":"url","sourceFileName":"file.pptx","sourceFileExtension":"pptx","hostItemId":"SPO_ID"},"actor":{"id":null,"provider":null,"email":"frankie.smith@microsoft.com","userPrincipalName":"fsmith@microsoft.com","name":"Frankie Smith","roles":"Creator","pictureUrl":null},"userRoles":"Mentioned"}',
timestamp:(new Date).toISOString()})]});Object(k.a)(Dh,"PowerPointActivityRequestManager",null,[639]);var Sh=d(259);class oj{constructor(f,x,N,ea,ma,Ha){this.mdb=!1;this.cEg=null;this.Oc=f;this.tw=x;this.obk=N;this.XGa=ea;this.zb=ma;this.rEb=Ha}initialize(){this.Oc&&(this.Oc.qPa(Object(v.a)(this,this.lGb,"onBeforeSessionEnd")),this.Oc.GA(Object(v.a)(this,this.kM,"onSessionClosed")));this.h1k()}nZk(f,x){const N=this.F3f("getPPTDocLastViewedTimestamp");this.Gx(N,1,f,x)}lGb(){this.pJh()}kM(){this.mdb=
!0}h1k(){if(this.zb){var f=new cd.a(3,2,3E4,Object(v.a)(this,this.pXk,"requestWriteWaterline"),90,"29");this.zb.Eb(f)}}pXk(){!this.mdb&&3E4<+Af.a.T$b-+this.cEg&&(this.pJh(),this.cEg=Af.a.T$b)}pJh(){const f=this.F3f("savePPTDocLastViewedTimestamp");this.rEb.ka("SendBeaconOnRoamingRequestsIsEnabled")?this.tw.rKa(f,""):this.Gx(f,2,Object(v.a)(this,this.Duk,"onWriteWaterlineSucceeded"),Object(v.a)(this,this.Cuk,"onWriteWaterlineFailed"))}Duk(f){let x=null;try{const N=f.data.Zd;x=N?JSON.parse(N).Error:
"ErrorWriteRoamingEmptyResponseBody"}catch(N){x="ErrorWriteRoamingParseJsonResponseException",Vc.a.J(572555921,3012,10,"OnWriteRoamingSucceeded() - Exception: "+N)}finally{x&&this.Sog(x)}Vc.a.J(572555922,3012,50,"OnWriteRoamingSucceeded, TotalTimeMs:{0}, QueueTimeMs:{1}",+f.data.hv-+f.data.rI,+f.data.St-+f.data.rI)}Cuk(f){this.Sog("ErrorReadRoamingFailed");Vc.a.J(572555923,3012,10,"OnWriteRoamingFailed() - Failure message: {0}",this.XGa.Nja(f))}F3f(f){return this.obk+String.format("RoamingServiceHandler.ashx?action={0}&{1}",
f,J.AFrameworkApplication.jh)}Gx(f,x,N,ea){const ma={};ma["X-StatelessPopsAffinityRoutingEnabled"]=this.rEb.ka("PPTStatelessPOPSRequestAffinityEnabled").toString();this.tw.Aj(f,x,null,ma,!1,1,N,ea,null,void 0,void 0,void 0,void 0,Sh.a("5"))}Sog(f){Vc.a.J(572555924,811,50,f)}}Object(k.a)(oj,"PowerPointWaterlineUpdater",null,[]);class ag{get name(){return"PowerPointWebEditor.Activity"}get Rge(){return J.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ActivityFeedIsEnabled",
!1)}init(){this.K.resolve("Common.IAppSettingsManager").jf(Object(v.a)(this,this.qJi,"delayedInit"))}$b(f){this.K=f}dispose(){this.K=this.p2c=null}Zbl(f){return!f||f.ka("IsAnonymousUser")?!1:f.ka("PPTCatchUpFlyoutIsEnabled")}qJi(){const f=this.K.resolve("Common.IAppSettingsManager");this.Zbl(f)&&(Vi("Begin"),this.FNi(),this.x0j())}FNi(){Rh.a.get_instance().Dk(7,()=>{Vi("ScriptDownload");pg.a(this.K)("catchUpActivity").catch(()=>{Vc.a.J(512262995,3012,10,"Failed to download catch-up script")}).then(()=>
this.jBj()).catch(()=>{Vc.a.J(512262994,3012,10,"Failed to initialize shared catch-up code")})})}x0j(){Vc.a.J(589608192,3012,50,"Catch Up script is loaded and Flyout is enabled.");this.Rge&&Vc.a.J(526718752,3012,50,"ActivityFeedData is enabled")}jBj(){const f=new Jj(this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.K.resolve("Common.IAppSettingsManager"),this.K.resolve("PowerPointWebEditor.CoreExt.ICoreExtEventHandler")),x=this.K.resolve("Common.AFrameworkApplication");this.K.register(oj,
"PowerPointWebEditor.Activity.PowerPointWaterlineUpdater").ma().oa(()=>new oj(this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),J.AFrameworkApplication.Je,this.K.resolve("PowerPointWebEditor.IApplicationSettings").roamingServiceHandlerWebServiceBase,this.K.resolve("PowerPointWebEditor.IJsonpHelperManager"),this.K.resolve("Common.ITaskManager"),this.K.resolve("Common.IAppSettingsManager")));this.K.register(637,"Common.App.CatchUpActivity.IActivityContentManager").ma().oa(()=>new jl(this.K.resolve("Common.IActionManagerExtended"),
this.K.resolve("PowerPointWebEditor.IApplicationSettings")));this.K.register(638,"Common.App.CatchUpActivity.IActivityNavigationManager").ma().oa(()=>new Rd(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView"),this.K.resolve("PowerPointWebEditor.IRibbonUser"),Md.a.KLk,this.K.resolve("Common.App.CatchUpActivity.IActivityContentManager")));let N=null;this.K.resolve("PowerPointWebEditor.IApplicationSettings").wg&&
(N=this.K.resolve("Common.IAppSettingsManager").Ha("368")+"p");this.K.register(639,"Common.App.CatchUpActivity.IActivityRequestManager").ma().oa(()=>new Dh(this.K.resolve("PowerPointWebEditor.IJsonpHelperManager"),this.K.resolve("PowerPointWebEditor.Activity.PowerPointWaterlineUpdater"),f,this.K.resolve("Common.IAppSettingsManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Common.App.CatchUpActivity.ICatchUpRequestHandler"),
N));this.K.register(Ul,"PowerPointWebEditor.Activity.FlyoutRibbonButton").as("Common.App.CatchUpActivity.IFlyoutRibbonButton").ma().oa(()=>new Ul(x.rr,J.AFrameworkApplication.Ta,this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("Common.App.CatchUpActivity.FloodgateEventLogger")));this.K.register(gf,"PowerPointWebEditor.Activity.FlyoutFocus").as("Common.App.CatchUpActivity.IFlyoutFocus").ma().oa(()=>new gf(this.K.resolve("Common.IF6Manager"),this.K.resolve("PowerPointWebEditor.View.IFocusManagerHelper")));
this.K.register(640,"Common.App.CatchUpActivity.IEmptyCatchUpBehaviorManager").ma().oa(()=>new Aj(this.K.resolve("Common.IActionManagerExtended")));this.p2c=catchUpActivity.FactoryGlobal.getPowerPointCatchUpAppInstance(Object.assign(new kn,{activityContentManager:this.K.resolve("Common.App.CatchUpActivity.IActivityContentManager"),activityNavigationManager:this.K.resolve("Common.App.CatchUpActivity.IActivityNavigationManager"),activityRequestManager:this.K.resolve("Common.App.CatchUpActivity.IActivityRequestManager"),
dataCulture:J.AFrameworkApplication.dataCulture,emptyCatchUpBehaviorManager:this.Rge?this.K.resolve("Common.App.CatchUpActivity.IEmptyCatchUpBehaviorManager"):null,flyoutFocus:this.K.resolve("Common.App.CatchUpActivity.IFlyoutFocus"),flyoutRibbonButton:this.K.resolve("Common.App.CatchUpActivity.IFlyoutRibbonButton"),uiCulture:J.AFrameworkApplication.uiCulture,ulsLogger:new Vf.a}));if(!this.p2c)return Promise.reject("Failure to create CatchUpApp");this.K.resolve("PowerPointWebEditor.Activity.FlyoutRibbonButton").initialize();
this.K.resolve("PowerPointWebEditor.Activity.FlyoutFocus").initialize();this.p2c.setWebpackPublicPath(J.AFrameworkApplication.aga);Vi("InitializeCatchUpApp");return this.p2c.initialize(Object.assign(new jn,{activityFeedDataEnabled:this.Rge,featuredActivityGroupsEnabled:!1,summaryStringEnabled:!0})).then(()=>{this.K.resolve("PowerPointWebEditor.Activity.PowerPointWaterlineUpdater").initialize()})}static main(){Na.a.instance.Dc(Hf.a(new ag,0))}}Object(k.a)(ag,"PPTWebEditorActivityPackage",null,[2,3]);
var uf=d(727);class hm extends Sys.EventArgs{constructor(f,x){super();this.shape=f;this.lDa=x}}Object(k.a)(hm,"ShowHideStateChangedEventArgs",Sys.EventArgs,[]);class lc{constructor(f,x,N,ea,ma,Ha,Ua){this.Pf=null;this.ia=f;this.ua=x;this.hR=N;this.A9c=ea;this.Sb=ma;this.Lc=Ha;this.Ceb=Ua}dispose(){this.Pf&&(this.Pf=null)}De(){}vb(){this.ia.ya(zc.a.XBe,ti.a.application,Object(v.a)(this,this.Qrj,"handleMarkAsRead"));this.ia.ya(zc.a.Wjb,ti.a.application,Object(v.a)(this,this.Luj,"handleShowHideChanges"));
this.ia.ra(zc.a.oMe,jc.a.application,Object(v.a)(this,this.ttj,"handleQueryShowHideChanges"),96);this.ia.ra(zc.a.Epd,ti.a.application,Object(v.a)(this,this.Muj,"handleShowRevisionTrackingWithUrlOverrides"),96)}Qrj(f,x,N,ea,ma){if(1===N)return this.Sb.Lj()?32:8;f=new Date;if(!ma)throw Error.argumentNull("actionData is null");if(ma.SlideNode){if(ma=Object(C.a)(116,ma.SlideNode))Vc.a.J(509654912,804,50,String.format("HandleMarkAsRead: Mark slide {0} as read",ma.slideIndex+1)),this.hR.I$b?this.hR.mbd(ma,
!0):(ma.fX=f,this.hR.dOe(ma))}else this.YBe(f);return 32}YBe(f){const x=this.ua.presentation;if(!x)throw Error.argumentNull("Presentation is null");this.Pf=Af.a.Ik("MarkActivitiesAsRead",1);Vc.a.J(509654883,804,50,"MarkAllSlidesAsRead: User marks slides as read via Ribbon button");this.hR.I$b?this.hR.YBe():(ki.b(x.slides||[],null,N=>{if(N=Object(C.a)(116,N))N.fX=f}),this.hR.Efh())}Luj(f,x,N,ea,ma){if(1===N)return this.Sb.Lj()?32:8;const Ha=this.Sb.Pn;f=this.ua.Ba;if(!(Ha&&f&&f.isConnected&&ma))return 16;
N=x=!1;switch(ma.ShowRevisionTrackingStatus){case 0:N=x=!1;break;case 2:x=!0;N=!1;break;case 3:N=x=!0;break;case 1:x=Ha.lDa&&!this.hR.ZTd?!0:!Ha.lDa;N=!0;break;default:return 8}if(this.hR.ZTd&&!N)return 32;ma=ma.InvokeSource;Ha.lDa=x;this.hR.ZTd=x&&N;N&&this.Ceb.c2j(ma,x);ma=f.Pk();ki.b(ma,null,Ua=>{this.A9c.IKk(new hm(Ua,Ha.lDa))});this.Lc.sz(new vk.a(1));return 32}ttj(f,x,N,ea,ma){f=this.Sb.Pn;if(!f)return 16;ma.Qf(f.lDa);return 32}Muj(f,x,N,ea,ma){f=this.ua.presentation;if(!ma||!f||!f.slides)return 8;
ma=ma.timestamp;if(!ma)return 8;for(const Ha of f.slides)Object(C.a)(116,Ha).fX=ma;this.hR.eOe(f.slides);return 32}}Object(k.a)(lc,"RevisionTrackingActor",null,[227,106]);class Lk{constructor(f){this.backgroundColor=this.foregroundColor=null;f&&f.isInHighContrastMode&&f.highContrastColors?(this.foregroundColor=f.highContrastColors.foregroundTextColor||"#006BFF",this.backgroundColor=f.highContrastColors.backgroundColor||"#006BFF"):this.backgroundColor=this.foregroundColor="#006BFF"}}Object(k.a)(Lk,
"RevisionTrackingColorProvider",null,[]);class Ye{constructor(){this.va=new hl.a}MKk(f){this.va.raiseEvent("SlideUSC",f)}tOd(f){this.va.addHandler("SlideUSC",f)}uPe(f){this.va.removeHandler("SlideUSC",f)}oKk(f){this.va.raiseEvent("ShapeUSC",f)}K$h(f){this.va.addHandler("ShapeUSC",f)}LUk(f){this.va.removeHandler("ShapeUSC",f)}IKk(f){this.va.raiseEvent("ShowHideSC",f)}V$h(f){this.va.addHandler("ShowHideSC",f)}SUk(f){this.va.removeHandler("ShowHideSC",f)}}Object(k.a)(Ye,"RevisionTrackingEventSource",
null,[705,706,707]);class im extends Sys.EventArgs{constructor(f,x){super();this.shape=f;this.slide=x}}Object(k.a)(im,"ShapeUnreadStateChangedEventArgs",Sys.EventArgs,[]);class ih{constructor(){this.cid=this.sid=0}}Object(k.a)(ih,"Slide",null,[]);class Jh{constructor(f,x){this.dt=this.mk=null;this.mk=Object.assign(new ih,{sid:f.sid,cid:f.cid});this.dt=x}}Object(k.a)(Jh,"SlideLastViewedVersion",null,[]);class L{constructor(){this.v=0;this.lv=this.defLv=null;this.v=1}}Object(k.a)(L,"SlideLastViewedVersions",
null,[]);class ca extends Sys.EventArgs{constructor(f){super();this.slide=f}}Object(k.a)(ca,"SlideUnreadStateChangedEventArgs",Sys.EventArgs,[]);class X{constructor(f,x,N,ea,ma,Ha,Ua,mb,gb,Cb,zb,Pb,oc,Ec,Xc,Ac){this.icb=this.Mbb=null;this.dwg=!1;this.pue=null;this.O6c=0;this.RCb=this.sec=null;this.Xxe=[];this.R8c=null;this.Y9c=!1;this.wxa=null;this.jae=this.iae=this.ZTd=!1;Vc.a.J(512262749,804,50,"Start RevisionTrackingManager::RevisionTrackingManager()");this.ize=f;this.ua=x;this.zb=N;this.jc=ea;
this.Sb=ma;this.qd=Ha;this.shc=Ua;this.Oc=mb;this.Rk=gb;this.A9c=zb;this.uSg=Cb;this.Yb=oc;this.uek=Pb.pptEditingRevisionTrackingWriteRoamingCacheIntervalMs;this.oCg=Pb.GRj;this.MSg=!0;this.rH=!1;this.LHa=new ib.a;this.Oc.WFc(Object(v.a)(this,this.pna,"onSessionAccessTokenExpired"));J.AFrameworkApplication.Rz&&this.Oc.ZFc(Object(v.a)(this,this.kfa,"onWopiTokenRefreshed"));this.Yb.jf(()=>{this.iae=!0;this.initialize();this.Efh();this.iae=!1});this.Ceb=Ec;this.Fb=Xc;this.eck=Ac}get I$b(){return Ud.a("WriteSlideLastViewedVersionsOnRead")}dispose(){this.Mbb&&
(this.qd.Una(Object(v.a)(this,this.onActiveSlideDomReady,"onActiveSlideDomReady")),this.qd.Inc(Object(v.a)(this,this.qna,"onShapeViewElementAdded")),this.shc.cPe(Object(v.a)(this,this.rgb,"onMarkedUndo")),this.Oc.qPe(Object(v.a)(this,this.lGb,"onBeforeSessionEnd")),this.Oc.baa(Object(v.a)(this,this.kM,"onSessionClosed")),this.Oc.Dfa(Object(v.a)(this,this.Bo,"onSessionRehydrated")),this.Rk.WUk(Object(v.a)(this,this.R5g,"onSlideChangesDataChanged")),this.Rk.BUk(Object(v.a)(this,this.R4g,"onPresentationLastModifiedTimeReceived")),
this.oCg&&this.uSg.Cm(Object(v.a)(this,this.D5g,"onShapePropertyChanged")),this.Oc.nih(Object(v.a)(this,this.pna,"onSessionAccessTokenExpired")))}initialize(){Vc.a.J(512262748,804,50,"Start RevisionTrackingManager::Initialize()");this.pue=new Date;this.O6c=this.pue.getTime();this.B4k();this.qd.$V(Object(v.a)(this,this.onActiveSlideDomReady,"onActiveSlideDomReady"));this.qd.Gqb(Object(v.a)(this,this.qna,"onShapeViewElementAdded"));this.shc.RXb(Object(v.a)(this,this.rgb,"onMarkedUndo"));this.Oc.qPa(Object(v.a)(this,
this.lGb,"onBeforeSessionEnd"));this.Oc.GA(Object(v.a)(this,this.kM,"onSessionClosed"));this.Oc.WB(Object(v.a)(this,this.Bo,"onSessionRehydrated"));this.Rk.aai(Object(v.a)(this,this.R5g,"onSlideChangesDataChanged"));this.Rk.q$h(Object(v.a)(this,this.R4g,"onPresentationLastModifiedTimeReceived"));this.oCg&&this.uSg.ik(Object(v.a)(this,this.D5g,"onShapePropertyChanged"));this.wxa=this.ua.Ba;this.icb=this.v6i();this.getSlideLastViewedVersions();const f=new cd.a(3,2,this.uek,()=>{this.getSlideLastViewedVersions()},
90,"12");this.zb.Eb(f)}onActiveSlideDomReady(f,x){f=Object(C.a)(116,x.Ba);this.wxa&&f!==this.wxa&&this.EVe()&&(this.wxa.isConnected&&(this.wxa.isUnread&&this.mbd(this.wxa,!0),!this.I$b&&this.wxa.changesData&&(this.wxa.fX=this.wxa.changesData.dtField)),f&&f.isUnread&&this.Ofh(f));this.wxa=f;this.O6c=Date.now()}rgb(f,x){x.actionId!==ce.a.LTa&&x.Tyb&&(f=this.ua.Ba)&&f.isConnected&&f.isUnread&&this.EVe()&&this.mbd(f,!0)}lGb(){this.EVe()&&this.Twl();this.Nud()}kM(){this.Ceb.log();this.rH=!0}Bo(){this.rH=
!1;this.sec&&this.nFh(this.sec)}nFh(f){var x=this.ua.presentation;if(!x)throw Error.argumentNull("Presentation is null");x=x.slides||[];0<x.length&&(this.uAl(x,f),this.eOe(x))}Mrk(f){this.jae=!0;Vc.a.J(512262747,804,50,"OnReceiveLastViewedVersionInfo()");f&&(this.LHa=new ib.a,this.forEach(f.lv,ea=>{const ma=ea.mk.sid;(!this.LHa.Hb(ma)||this.LHa.ga(ma).dt<ea.dt)&&this.LHa.$(ma,ea)}));const x=Af.a.T$b;let N=!1;this.RCb&&this.ize.YVj&&x!==this.RCb&&(this.sec&&R.c(this.PWf())===R.c(this.sec)||(N=!0));
f&&f.defLv&&(this.icb=f.defLv,this.MSg=!1,f.lv&&0<f.lv.length&&this.nFh(f));N&&this.Nud();this.RCb=Af.a.T$b;this.jae=!1}R5g(f,x){this.forEach(x.slides,N=>{this.ohe(N.changesData)||(this.ua.Ba&&N.Cb!==this.ua.Ba.Cb||this.cxj(Object(C.a)(116,N)))&&this.dOe(Object(C.a)(116,N))})}R4g(f,x){this.MSg&&(this.icb=x.gEk)}D5g(f,x){f=x.property;x=Object(C.a)(4,x.node);f===$a.a.aKb&&(f=this.jc.mg(x),f===this.ua.Ba&&f.isUnread&&x.changesData.dtField<=f.changesData.dtField&&(Vc.a.J(512262746,804,50,"Trying to highlight a shape in active slide, time elapsed after last slide navigation: {0}ms",
Date.now()-this.O6c),this.cOe(this.ua.Ba,x)))}qna(f,x){f=x.Gw.shapeNode;this.ua.Ba.isUnread&&this.xFa(this.ua.Ba.Cb,f)&&!this.ohe(f.changesData)&&(this.Xxe.push(f),this.R8c||(this.R8c=new cd.a(2,1,0,Object(v.a)(this,this.tryHighlightInsertedShapes,"tryHighlightInsertedShapes"),90,"13"),this.zb.Eb(this.R8c)))}getSlideLastViewedVersions(){this.rH||this.Y9c||this.ize.getSlideLastViewedVersionInfo(Object(v.a)(this,this.Mrk,"onReceiveLastViewedVersionInfo"))}Nud(){if(!this.rH&&!this.Y9c){var f=this.PWf();
this.ize.putSlideLastViewedVersionInfo(f);this.sec=f}}PWf(){const f=this.ua.presentation;if(!f)throw Error.argumentNull("Presentation is null");const x=Object.assign(new L,{defLv:this.icb}),N=[];this.forEach(f.slides||[],ea=>{ea=ea.Cb;const ma=this.Sb.zl(ea);ma&&ma.fX&&(!ea.cid&&this.LHa.Hb(ea.sid)?ea=Cd.a.PE(ea.sid,this.LHa.ga(ea.sid).mk.cid):ea.cid&&this.LHa.Hb(ea.sid)&&ea.cid!==this.LHa.ga(ea.sid).mk.cid&&Vc.a.J(512262745,804,50,"The same sid {0} has different cid. Roaming cid:{1}, Slide node cid:{2}",
ea.sid,this.LHa.ga(ea.sid),ea.cid),N.push(new Jh(ea,ma.fX)))});x.lv=N;return x}uAl(f,x){const N=x.lv;this.forEach(f,ea=>{const ma=Object(C.a)(116,ea);this.forEach(N,Ha=>{ma&&this.Jei(ma,Ha.mk)&&(!ma.fX||ma.fX<Ha.dt)&&(ma.fX=Ha.dt)})})}Jei(f,x){return f.cid&&x.cid?f.sid===x.sid&&f.cid===x.cid:f.sid===x.sid}eOe(f){this.forEach(f,x=>{this.dOe(Object(C.a)(116,x))})}Efh(){var f=this.ua.presentation;if(!f)throw Error.argumentNull("Presentation is null");f=f.slides||[];0<f.length&&this.eOe(f)}Ofh(f){this.IIh(f,
x=>{this.cOe(f,x)})}dOe(f){if(f&&f.isConnected&&f.changesData){const x=this.FXc(f.changesData,this.kSc(f));x!==f.isUnread&&(this.BXg(f,x),this.Lul(),f===this.ua.Ba&&this.Ofh(f))}}cOe(f,x){if(x&&x.isConnected&&x.Sa($a.a.aKb)){const N=this.FXc(x.changesData,this.kSc(f));this.zXg(f,x,N)}}zXg(f,x,N){N!==x.isUnread&&(Vc.a.J(512262744,804,50,"Shape unread state changed: {0} -> {1}",x.isUnread,N),x.isUnread=N,this.A9c.oKk(new im(x,f)))}BXg(f,x){x!==f.isUnread&&(Vc.a.J(512262743,804,50,"Slide unread state changed: {0} -> {1}, SlideId={2}",
f.isUnread,x,f.Cb.toString()),f.isUnread=x,this.A9c.MKk(new ca(f)))}mbd(f,x){if(this.I$b){if(!f)throw Error.argumentNull("ISlideNode is null");this.tAl(f);Vc.a.J(509654915,804,50,"MarkSlideAsRead - SlideId={0}, isUnread={1}, writeToRoaming={2}",f.Cb.toString(),f.isUnread,x);if(!f.isUnread)return!1}this.IIh(f,N=>{this.zXg(f,N,!1)});this.BXg(f,!1);this.I$b&&x&&this.Nud();return!0}YBe(){const f=this.ua.presentation;if(!f)throw Error.argumentNull("Presentation is null");let x=!1;this.forEach(f.slides,
N=>{N=this.mbd(Object(C.a)(116,N),!1);x||(x=N)});Vc.a.J(509654914,804,50,"MarkAllSlidesAsRead - requiresWriteToRoaming={0}",x);x&&this.Nud()}IIh(f,x){f&&(f=f.Pk(),this.forEach(f,N=>{x(N)}))}forEach(f,x){ki.b(f,null,x)}ohe(f){return rm(f,this.Mbb)}FXc(f,x){return!!f&&!!f.dtField&&!this.ohe(f)&&f.dtField>x}v6i(){const f=this.Sb.Pn;if(f&&f.eKe)return f.eKe;Vc.a.J(512262742,808,50,"GetDefaultLastViewedTime - No PresLastModifiedTime");return new Date}Ueg(f){const x=Object(C.a)(116,this.eck.x4f(f));return x&&
x.isUnread&&f&&this.FXc(f.changesData,this.kSc(x))}B4k(){this.Mbb=new yg(this.Yb.Ha("UserName"),this.Yb.Ha("387"),this.Yb.Ha("388"))}tAl(f){f.fX=f&&f.changesData?f.changesData.dtField:this.icb}Twl(){const f=this.ua.Ba;f&&(f.fX=f.changesData?f.changesData.dtField:this.icb)}kSc(f){return f.fX||this.icb}Lul(){this.dwg||(this.dwg=!0,Vc.a.J(512262741,804,50,"First revision tracking view render completed!"))}cxj(f){return f.isConnected&&f.changesData&&f.changesData.dtField?f.changesData.dtField<=this.pue&&
this.FXc(f.changesData,this.kSc(f)):!1}xFa(f,x){return f.equals(x.slideId)}tryHighlightInsertedShapes(){Vc.a.J(512262740,804,50,"Trying to highlight inserted shapes on active slide, time elapsed after last slide navigation: {0}ms",Date.now()-this.O6c);this.R8c=null;const f=this.ua.Ba;if(f&&f.isUnread){const x=f.Cb;for(const N of this.Xxe)this.xFa(x,N)&&this.cOe(f,N)}Array.clear(this.Xxe)}pna(){this.Y9c=!0}kfa(f,x){try{x.x_c?(Vc.a.J(512262739,804,50,"RevisionTrackingManager::OnWopiTokenRefreshed Token refresh succeeded."),
this.Y9c=!1):Vc.a.J(512262738,804,15,"RevisionTrackingManager::OnWopiTokenRefreshed Token refresh failed.")}catch(N){Vc.a.J(512262737,804,10,"RevisionTrackingManager::OnWopiTokenRefreshed Exception: {0}",N)}}EVe(){return 1!==this.Fb.Sl}}Object(k.a)(X,"RevisionTrackingManager",null,[]);class qb{constructor(f,x,N,ea,ma,Ha,Ua,mb,gb,Cb,zb){this.ua=f;this.Sb=x;this.fze=N;this.qd=ea;this.P4=ma;this.Ea=Ha;this.z2c=Ua;this.kfb=mb;this.Re=gb;this.QGa=Cb;this.l8j=zb;this.tGg=!1;this.qd.Iqb(Object(v.a)(this,
this.V6g,"onVisibleThumbnailRangeChanged"));this.qd.vOd(Object(v.a)(this,this.IGb,"onThumbnailRefresh"));this.qd.O$h(Object(v.a)(this,this.C5g,"onShapePresenceStateChanged"));this.qd.nai(Object(v.a)(this,this.F6g,"onThumbnailPresenceStateChanged"));this.qd.V9h(Object(v.a)(this,this.ctk,"onShapeViewElementShowRevisionTrackingHint"));this.qd.S9h(Object(v.a)(this,this.Wsk,"onShapeViewElementHideRevisionTrackingHint"));this.P4.tOd(Object(v.a)(this,this.MYa,"onSlideUnreadStateChanged"));this.P4.K$h(Object(v.a)(this,
this.I5g,"onShapeUnreadStateChanged"));this.P4.V$h(Object(v.a)(this,this.M5g,"onShowHideStateChanged"))}dispose(){this.qd.wih(Object(v.a)(this,this.V6g,"onVisibleThumbnailRangeChanged"));this.qd.eVk(Object(v.a)(this,this.IGb,"onThumbnailRefresh"));this.qd.OUk(Object(v.a)(this,this.C5g,"onShapePresenceStateChanged"));this.qd.dVk(Object(v.a)(this,this.F6g,"onThumbnailPresenceStateChanged"));this.P4.uPe(Object(v.a)(this,this.MYa,"onSlideUnreadStateChanged"));this.P4.LUk(Object(v.a)(this,this.I5g,"onShapeUnreadStateChanged"));
this.P4.SUk(Object(v.a)(this,this.M5g,"onShowHideStateChanged"))}V6g(){const f=this.ua.presentation;if(!f)throw Error.argumentNull("Presentation is null");ki.b(f.slides||[],null,x=>{(x=this.Sb.zl(x.Cb))&&x.isUnread&&this.cXe(x)})}IGb(f,x){f=this.Sb.zl(x.jBh);f.isUnread&&this.cXe(f)}MYa(f,x){f=x.slide;f.isUnread?this.cXe(f):this.HSk(f)}I5g(f,x){f=x.shape;x=x.slide;f&&(f.isUnread?x===this.ua.Ba&&this.ZWe(f):this.WOe(f))}C5g(f,x){f=x.shape;f.vs?this.WOe(f):f.isUnread&&this.ZWe(f,!0)}F6g(f,x){f=x.slide;
f.vs&&!this.$Ve?this.MSk(f):f.isUnread&&this.yhl(f)}M5g(f,x){f=x.shape;x.lDa&&f.isUnread?this.ZWe(f):this.WOe(f)}get $Ve(){return this.l8j}cXe(f){f&&f.isConnected&&this.Otd(f,x=>{x.wvh();f.vs&&!this.$Ve||this.prf(x)})}HSk(f){f&&f.isConnected&&this.Otd(f,x=>{x.lhh();x.TOe()})}yhl(f){f.vs&&!this.$Ve||this.Otd(f,Object(v.a)(this,this.prf,"addRevisionTrackingPawnForThumbnail"))}MSk(f){this.Otd(f,x=>{x.TOe()})}Nth(){const f=this.Sb.Pn;return!this.QGa||this.QGa&&f.lDa}ZWe(f,x=!1){this.Nth()&&!f.vs&&f.Sa($a.a.aKb)&&
(Object(C.a)(117,f.sc(this.Re))?(this.fze.VG(f).display(()=>this.Ea.aTc(f)),this.pul(),Vc.a.J(23606109,804,50,"ShowShapeRevisionTrackingView(), IsTriggeredByPresenceUpdate={0}",x)):Vc.a.J(23606111,804,50,"ShowShapeRevisionTrackingView() failed, no shape view element created"))}WOe(f){const x=this.fze.EF(f);x?x.dismiss():this.Nth()&&f.isUnread&&Vc.a.J(23606113,804,50,"RemoveShapeRevisionTrackingView() failed, a revision tracking view is expected but not found")}Otd(f,x){f&&((f=Object(C.a)(681,f.tg(this.kfb)))?
x(f):Vc.a.J(23606115,804,50,"UpdateThumbnailRevisionTrackingView() failed, no thumbnail view element found"))}prf(f){f.zNd(this.z2c.backgroundColor,ResourceStrings.l_RevisionTracking_Slide_Has_Unread_Changes)}ctk(f,x){this.cHh(x.Gw.shapeNode,!0)}Wsk(f,x){this.cHh(x.Gw.shapeNode,!1)}cHh(f,x){(f=this.fze.EF(f))&&(x?f.zya():f.q_())}pul(){this.tGg||(this.tGg=!0,gd.c(ba.a.Ooi))}}Object(k.a)(qb,"RevisionTrackingPresenter",null,[]);class Rb{qIf(){const f=new Xk.a;f.ih(10,10);f.qya("0 0 10 10");f.xa.setAttribute("class",
"ModernRevisionTrackingIconSVG");const x=new Wk.a;x.i1("M1,5 a4,4 0 1,0 8,0 a4,4 0 1,0 -8,0");x.xa.setAttribute("class","ModernRevisionTrackingIconPath");f.appendChild(x);return f.xa}}Object(k.a)(Rb,"RevisionTrackingSVGProvider",null,[636]);class Qc{constructor(){this.B9c=this.nad=this.mad=this.mxe=0}F2j(){this.nad+=1}c2j(f,x){switch(f){case 2:x&&(this.mad+=1);break;case 0:x?(this.B9c+=1,Vc.a.J(39068549,804,50,"HandleShowHideChanges: User enables detailed highlight via Ribbon button")):Vc.a.J(39068551,
804,50,"HandleShowHideChanges: User disables detailed highlight via Ribbon button");break;case 1:x&&(this.mxe+=1)}}log(){Vc.a.J(39068553,804,15,"WYWA Notification Clicks:{0}; Thumbnail Revision Tracking Pawn Clicks: {1}; Thumbnail Revision Tracking Pawn Hovers: {2}; Show Hide Changes Ribbon Clicks:{3};",this.mxe,this.mad,this.nad,this.B9c);0<this.mad+this.nad+this.B9c&&gd.c(ba.a.XSd)}}Object(k.a)(Qc,"RevisionTrackingTelemetry",null,[]);var jd=d(1023),vd=d(1130),Xd=d(73),Ke=d(570);class jf{constructor(f,
x,N,ea,ma){this.Jbb=null;this.KHa=f;this.Ceb=x;this.lc=ma;this.Vb=N;this.pa=ea;this.KHa.aW(Object(v.a)(this,this.aG,"onInteractivityChanged"))}dispose(){this.KHa&&this.KHa.dispose();this.Jbb=this.KHa=null}display(f,x){this.Jbb||(this.Jbb=new Ke.a);this.Jbb.color=f;this.Jbb.userName=x;this.KHa.Rx(this.Jbb)}dismiss(){this.KHa.JJ(this.Jbb.clientId)}zya(){this.KHa.xya()}q_(){this.KHa.Wfa()}get sQd(){const f=this.KHa.nhb;return 0<f.length?f[0]:null}aG(f,x){f={InvokeSource:2,ShowRevisionTrackingStatus:null};
1===x.type?(this.Vb.Ba!==this.lc?(this.lc&&(this.Vb.Ba=this.lc,this.pa.Vx()),f.ShowRevisionTrackingStatus=3):f.ShowRevisionTrackingStatus=1,J.AFrameworkApplication.Ta.La(zc.a.Wjb,2,f)):2===x.type?this.lc&&this.Vb.Ba===this.lc&&(f.ShowRevisionTrackingStatus=2,J.AFrameworkApplication.Ta.La(zc.a.Wjb,2,f),this.Ceb.F2j()):3===x.type&&this.lc&&this.Vb.Ba===this.lc&&(f.ShowRevisionTrackingStatus=0,J.AFrameworkApplication.Ta.La(zc.a.Wjb,2,f))}}Object(k.a)(jf,"ThumbnailRevisionTrackingPawn",null,[698,106]);
d(299);class wf{constructor(f,x,N,ea,ma,Ha){this.He=f;f=Xd.getImageClassWithCluster("pegal","UnreadNotification_16x16x32");x=x.pk("pegal.png");N=N.qIf();this.vak=this.EGi(J.AFrameworkApplication.isRtl,f,x,N);this.Ceb=ea;this.Vb=ma;this.pa=Ha}vEi(f,x){return new jf(this.vak.rtb(f),this.Ceb,this.Vb,this.pa,x)}Pc(f){return this.He.Pc(f)}EGi(f,x,N,ea){const ma=new jd.a;ma.add(1,x);ma.add(4,N);ma.add(6,16);ma.add(8,f);ma.add(12,2);ma.add(11,!1);ma.add(14,ea);return new vd.a(ma)}}Object(k.a)(wf,"RevisionTrackingThumbnailGadgetsFactory",
null,[635]);class eg{constructor(f,x,N){this.M5c=this.kec=!0;this.tw=f;this.XGa=x;this.la=N}get YVj(){return this.kec}getSlideLastViewedVersionInfo(f){if(this.M5c){Vc.a.J(25203102,824,50,"GetSlideLastViewedVersionInfo(), Start sending read request to FE at [{0}]",JSON.stringify(new Date));var x=this.la.roamingServiceHandlerWebServiceBase+String.format("RoamingServiceHandler.ashx?action={0}&{1}","getPPTSlideLastViewedMetadata",J.AFrameworkApplication.jh),N={};N["X-StatelessPopsAffinityRoutingEnabled"]=
this.la.pptStatelessPOPSRequestAffinityEnabled.toString();this.tw.Aj(x,1,null,N,!1,2,Object(v.a)(this,this.epk,"onGetVersionInfoSucceeded"),Object(v.a)(this,this.dpk,"onGetVersionInfoFailed"),f,void 0,void 0,void 0,void 0,Sh.a("12"));this.M5c=!1}else Vc.a.J(25203100,824,50,"Response of previous get roaming request is not back yet.")}putSlideLastViewedVersionInfo(f){if(this.kec){Vc.a.J(25203106,824,50,"PutSlideLastViewedVersionInfo(), Start sending write request to FE");var x=R.c(f),N=this.la.pptRevisionTrackingMaxRoamingDataSizeInBytes;
if(x.length>N)Vc.a.J(25203136,824,50,"Roaming data size is bigger than the limitation, won't write to roaming service, slideNum={0}, dataSize={1}, sizeLimitation={2}",f.lv.length,x.length,N);else{N=this.la.roamingServiceHandlerWebServiceBase+String.format("RoamingServiceHandler.ashx?action={0}&{1}","savePPTSlideLastViewedMetadata",J.AFrameworkApplication.jh);if(J.AFrameworkApplication.fa.ka("SendBeaconOnRoamingRequestsIsEnabled"))this.tw.rKa(N,x);else{const ea={};ea["X-StatelessPopsAffinityRoutingEnabled"]=
this.la.pptStatelessPOPSRequestAffinityEnabled.toString();this.tw.Aj(N,2,x,ea,!1,2,Object(v.a)(this,this.Drk,"onPutVersionInfoSucceeded"),Object(v.a)(this,this.Crk,"onPutVersionInfoFailed"),f.lv.length,void 0,void 0,void 0,void 0,Sh.a("13"))}this.kec=!1}}else Vc.a.J(25203104,824,50,"Response of previous write roaming request is not back yet.")}dispose(){}epk(f){this.M5c=!0;let x=0;try{let N=null;f.data.Zd&&0<f.data.Zd.trim().length&&(x=f.data.Zd.length,N=JSON.parse(f.data.Zd,Object(v.a)(this,this.mWj,
"jsonDateReviver")));const ea=f.data.state;ea(N)}catch(N){Vc.a.J(23132289,824,10,"OnGetVersionInfoSucceeded catched exception: {0}",N.toString())}f=String.format("OnGetVersionInfoSucceeded, responseSize={0}, EnqueueTime={1}, InvokedTime={2}, CompletedTime={3}",x,JSON.stringify(f.data.rI),JSON.stringify(f.data.St),JSON.stringify(f.data.hv));Vc.a.J(25203139,824,50,f)}dpk(f){this.M5c=!0;f=this.XGa.Nja(f);Vc.a.J(23132291,824,50,"OnGetVersionInfoFailed: Web service failed with {0}",f)}Drk(f){this.kec=
!0;Vc.a.J(25203142,824,50,"OnPutVersionInfoSucceeded, TotalTimeMs:{0}, QueueTimeMs:{1}",+f.data.hv-+f.data.rI,+f.data.St-+f.data.rI)}Crk(f){this.kec=!0;const x=this.XGa.Nja(f);Vc.a.J(23132293,824,50,"OnPutVersionInfoFailed: Web service failed with {0}, NumSlides={1}",x,f.data.state)}mWj(f,x){return"dt"===f||"defLv"===f?new Date(x):x}}Object(k.a)(eg,"RoamingCacheProxy",null,[634,106]);var Ng=d(682),Ug=d(114);class Ah{constructor(f,x,N){this.Bg=f;this.pJ=Object(C.a)(Ng.a,this.Bg.esh);this.z2c=x;this.Dck=
N;this.Bg.Phg=!0}display(f){let x;x=this.Dck.qIf();this.pJ.orf(this.z2c.backgroundColor,f,x);this.Bg.mOb(this.z2c.foregroundColor);this.Bg.setVisibility()}dismiss(){this.pJ.clear();this.Bg.mOb(Ug.a.none);this.Bg.setVisibility()}Im(f){this.Bg.Im(f)}eD(f){this.Bg.eD(f)}Yp(){return this.Bg.Yp()}HN(f){return this.Bg.syb(f)}Jx(f){this.Bg.Jx(f)}dispose(){this.Bg.dispose()}My(){this.Bg.My()}YD(f){return this.Bg.YD(f)}yB(f){return this.Bg.yB(f)}draw(f,x){this.Bg.draw(f,x)}get visible(){return this.Bg.visible}set visible(f){this.Bg.visible=
f}setPosition(f,x){this.Bg.setPosition(f,x)}Hj(f){this.Bg.Hj(f)}Nq(f){this.Bg.Nq(f)}Ru(f){this.Bg.Ru(f)}setZIndex(f){this.Bg.setZIndex(f)}JE(f,x){this.Bg.JE(f,x)}zya(){this.pJ.zya()}q_(){this.pJ.q_()}setSelection(){}}Object(k.a)(Ah,"ShapeRevisionTrackingView",null,[668,284,285,106]);class We{constructor(){this.K=null;this.QGa=this.tCb=this.qO=this.w4=!1}get name(){return"PowerPointWebEditor.RevisionTracking"}init(){}$b(f){this.K=f;f.resolve("Common.IAppSettingsManager").jf(()=>{this.qO=f.resolve("PowerPointWebEditor.IApplicationContext").od.wg;
this.tCb=f.resolve("PowerPointWebEditor.IApplicationContext").od.qQj;this.w4=f.resolve("PowerPointWebEditor.IApplicationContext").od.pke;this.QGa=f.resolve("PowerPointWebEditor.IApplicationContext").od.pje;this.register();this.resolve()})}dispose(){this.w4&&(this.K.resolve("PowerPointWebEditor.RevisionTracking.RevisionTrackingManager").dispose(),this.K.resolve("PowerPointWebEditor.RevisionTracking.RevisionTrackingPresenter").dispose(),this.K.resolve("PowerPointWebEditor.RevisionTracking.IRoamingCacheProxy").dispose())}register(){const f=
this.K;this.qO&&this.tCb&&f.register(uf.a,"PowerPointWebEditor.PodsInfoSender").ma().oa(()=>new uf.a(J.AFrameworkApplication.Je,f.resolve("PowerPointWebEditor.ISessionInfoOwner"),f.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),f.resolve("PowerPointWebEditor.Core.IPodsPopsEventHandler"),f.resolve("PowerPointWebEditor.IErrorHandler"),f.resolve("Common.ITaskManager"),f.resolve("Common.IAppSettingsManager")));this.w4&&(f.register(Qc,"RevisionTrackingTelemetry").ma().oa(()=>new Qc),f.register(X,
"PowerPointWebEditor.RevisionTracking.RevisionTrackingManager").ma().oa(()=>new X(f.resolve("PowerPointWebEditor.RevisionTracking.IRoamingCacheProxy"),f.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),f.resolve("Common.ITaskManager"),f.resolve("PowerPointWebEditor.ISlideReader"),f.resolve("PowerPointWebEditor.IPresentationReader"),f.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),f.resolve("PowerPointWebEditor.UndoRedo.IUndoEventHandlers"),f.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),
f.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),f.resolve("Box4.Graph.IGraphInstance").Ad(10),f.resolve("PowerPointWebEditor.RevisionTracking.IRevisionTrackingEventSource"),f.resolve("PowerPointWebEditor.IApplicationSettings"),f.resolve("Common.IAppSettingsManager"),f.resolve("RevisionTrackingTelemetry"),f.resolve("PowerPointWebEditor.View.IPPTPageView"),f.resolve("PowerPointWebEditor.Graph.SlideNodeHelper"))),f.register(qb,"PowerPointWebEditor.RevisionTracking.RevisionTrackingPresenter").ma().oa(()=>
new qb(f.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),f.resolve("PowerPointWebEditor.IPresentationReader"),f.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapeRevisionTrackingView>"),f.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),f.resolve("PowerPointWebEditor.RevisionTracking.IRevisionTrackingEventHandlers"),f.resolve("PowerPointWebEditor.IShapeReader"),f.resolve("PowerPointWebEditor.RevisionTracking.RevisionTrackingColorProvider"),
f.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView").Ma,f.resolve("Box4.IPageView").Ma,f.resolve("PowerPointWebEditor.IApplicationSettings").pje,f.resolve("Common.IAppSettingsManager").ka("PPTCanvasPresenceBubbleUXEnabled"))),f.register(634,"PowerPointWebEditor.RevisionTracking.IRoamingCacheProxy").ma().oa(()=>new eg(J.AFrameworkApplication.Je,f.resolve("PowerPointWebEditor.IJsonpHelperManager"),f.resolve("PowerPointWebEditor.IApplicationSettings"))),f.register(635,"PowerPointWebEditor.RevisionTracking.IRevisionTrackingThumbnailGadgetsFactory").ma().oa(()=>
new wf(f.resolve("PowerPoint.IBrowserHelperManager"),f.resolve("PowerPoint.IPathManager"),f.resolve("PowerPointWebEditor.RevisionTracking.IRevisionTrackingSVGProvider"),f.resolve("RevisionTrackingTelemetry"),f.resolve("PowerPointWebEditor.IPPTWorkspaceGraph"),f.resolve("PowerPointWebEditor.IPptSelectionManager"))),f.register(Ye,"PowerPointWebEditor.RevisionTracking.RevisionTrackingEventSource").as("PowerPointWebEditor.RevisionTracking.IRevisionTrackingEventSource").as("PowerPointWebEditor.RevisionTracking.IRevisionTrackingEventNotifier").as("PowerPointWebEditor.RevisionTracking.IRevisionTrackingEventHandlers").ma().oa(()=>
new Ye),f.register(255,"PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapeRevisionTrackingView>").ma().oa(()=>new em.a((x,N)=>{let ea=null;const ma=Object(C.a)(117,x.sc(f.resolve("Box4.IPageView").Ma));ma&&!ma.Al&&(x=f.resolve("PowerPointWebEditor.ShapePresence.IShapePawnViewFactory").cXd(f.resolve("PowerPointWebEditor.IPptSelectionManager"),(Ha,Ua,mb)=>f.resolve("PowerPointWebEditor.ShapePresence.IShapePawnFactory").AFi(Ha,Ua,mb,f.resolve("PowerPointWebEditor.Core.ICoreEventHandler")),
x,N,ma.RU),ea=new Ah(x,f.resolve("PowerPointWebEditor.RevisionTracking.RevisionTrackingColorProvider"),f.resolve("PowerPointWebEditor.RevisionTracking.IRevisionTrackingSVGProvider")),ea.Im(ma.RU),ma.dra(ea,1),ea.visible=ma.yQ||ma.Tn);return ea})),f.register(Lk,"PowerPointWebEditor.RevisionTracking.RevisionTrackingColorProvider").ma().oa(()=>new Lk(f.resolve("Common.Utils.IHighContrastDetector"))),f.register(636,"PowerPointWebEditor.RevisionTracking.IRevisionTrackingSVGProvider").ma().oa(()=>new Rb),
this.qO&&this.QGa&&f.register(lc,"PowerPointWebEditor.RevisionTracking.RevisionTrackingActor").ma().oa(()=>new lc(f.resolve("Common.IActionManagerExtended"),f.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),f.resolve("PowerPointWebEditor.RevisionTracking.RevisionTrackingManager"),f.resolve("PowerPointWebEditor.RevisionTracking.IRevisionTrackingEventNotifier"),f.resolve("PowerPointWebEditor.IPresentationReader"),f.resolve("PowerPointWebEditor.View.IViewEventSource"),f.resolve("RevisionTrackingTelemetry"))))}resolve(){this.qO&&
this.tCb&&this.K.resolve("PowerPointWebEditor.PodsInfoSender");if(this.w4&&(this.K.resolve("PowerPointWebEditor.RevisionTracking.RevisionTrackingPresenter"),this.K.resolve("PowerPointWebEditor.RevisionTracking.RevisionTrackingManager"),this.K.resolve("PowerPointWebEditor.RevisionTracking.IRevisionTrackingThumbnailGadgetsFactory"),this.QGa)){const f=this.K.resolve("PowerPointWebEditor.RevisionTracking.RevisionTrackingActor");f.vb();f.De()}}static main(){Na.a.instance.Dc(Hf.a(new We,0))}}Object(k.a)(We,
"PPTWebEditorRevisionTrackingPackage",null,[2,3]);var lk=d(538),jm=d(683);class Kh{get name(){return"Common.App.OAuth.OAuthPackage"}$b(f){f.register(670,"Common.App.OAuth.IOAuthManager").ma().oa(()=>new lk.OAuthManager)}init(){const f=na.a.instance.resolve("Common.App.OAuth.IOAuthManager");this.evl(f)}evl(f){const x=J.AFrameworkApplication.fa.Ha("FileSource");if(J.AFrameworkApplication.fa.ka("IsO365ConsumerHost")||J.AFrameworkApplication.fa.ka("IsO365CommercialHost")||"WopiTest"===x){var N=D.OAuthManagerSettings.QVd;
if(N&&N.IsEnabled){var ea=N.Application,ma=D.OAuthManagerSettings.authority;if(void 0!==ea&&null!==ea&&ea.length&&void 0!==ma&&null!==ma&&ma.length){var Ha=jm.a[f.C6],Ua=fa.a.Ly,mb=f.RD();try{var gb=new Map;void 0!==gb&&null!==gb?(gb.set("SupportStatus",Ha),gb.set("Browser",Ua),gb.set("AuthStrategy",mb)):gb=null}catch(zb){gb=null}A.Health.instance.recordKpiUsageForAlertableKpi("WacCorePFT","WacOAuthFC",gb);var Cb=Lb.a.tj();f.nV("Core",ea).then(zb=>{const Pb=Math.floor(Lb.a.tj()-Cb);Ha=jm.a[f.C6];
Ua=fa.a.Ly;mb=f.RD();e.ULS.sendTraceTag(562943369,3E3,50,'OAuthManager attempted to get a Core token to the WAC FrontEnd API in {0} ms. Success={1}, SupportStatus={2}, ErrorCode="{3}", Host="{4}", Browser="{5}", AuthStrategy="{6}"',Pb,zb.IsSuccess,Ha,zb.ErrorCode,x,Ua,mb);gb&&(gb.set("SupportStatus",Ha),gb.set("Browser",Ua),gb.set("AuthStrategy",mb));var oc=Object.assign(new Ea.a,{durationMs:Pb,extendedProperties:gb});if(zb.IsSuccess){if(A.Health.instance.recordKpiSuccess("WacCorePFT",oc),zb="Bearer "+
zb.Token,J.AFrameworkApplication.Je.f4e=zb,oc=N.Endpoint){var Ec=Lb.a.tj();J.AFrameworkApplication.Je.vqb(oc,1,null,{["Authorization"]:zb},2,"OAuthManagerValidateAccess",void 0,void 0,void 0,2E4).continueWith(Xc=>{var Ac=Math.floor(Lb.a.tj()-Ec),zd=null;Xc.Sn?Xc="Canceled":Xc.rm?Xc="Faulted":(zd=Xc.result,Xc=zd.succeeded?"Completed":"Failed");Ac={["TaskResult"]:Xc,["BrowserTokenDurationMS"]:Pb,["BrowserValidationDurationMS"]:Ac};zd&&(Ac.HttpStatus=zd.Xi.data.Te,zd.succeeded&&(zd=R.a(zd.Xi.data.Zd),
Ac.ServerValidationDurationMS=zd.ElapsedMilliseconds,Ac.ServerValidationResult=zd.ValidatedToken,Ac.KMSI=zd.KMSI,Ac.Scopes=zd.Scopes,Ac.TokenExpirationS=Math.floor(parseInt(zd.Expiration)-(new Date).getTime()/1E3)));e.ULS.sendTraceTag(520632322,3E3,"Completed"===Xc?50:15,ka.a.toJSON(Ac))})}}else A.Health.instance.recordKpiFailure("WacCorePFT",zb.ErrorCode,!1,!1,oc)}).catch(zb=>{var Pb=Math.floor(Lb.a.tj()-Cb);Pb=Object.assign(new Ea.a,{durationMs:Pb,extendedProperties:gb});A.Health.instance.recordKpiFailure("WacCorePFT",
"UNEXPECTED CATCH: "+zb.toString(),!1,!1,Pb)})}}}}dispose(){}static main(){Na.a.instance.Dc(new Kh)}}Object(k.a)(Kh,"OAuthPackage",null,[2,3]);var $d=d(404),xk=d(213),Ie=d(134);class Yd{constructor(f){this.QOa=[ce.a.Qrc,ce.a.Rrc,ce.a.Trc,ce.a.Urc,ce.a.Vrc];this.T8e=f}PZf(f){return this.T8e?this.T8e.qRc(f.Ua):null}create(f){return f?(f=this.G0b(f))?Ie.m(f):"":""}VBi(f){f=f.suggestions;if(!f||!f.count)return null;f=({mLf:x}=this.nGi(f)).returnValue;var x=Yd.XCi(x);const N=Object.assign(new $d.a,{ExternalId:"DictationCorrectionMenu",
Command:"798637440",LabelText:Box4Intl.Box4Strings.L_DictationCorrectionsFlyoutTitle,Image16by16Class:Xd.getImageClassWithCluster(J.AFrameworkApplication.KN,Yd.oLi),Image16by16:J.AFrameworkApplication.qm,Menu:Object.assign(new He.a,{ExternalId:"DictationCorrectionSubMenu",UpdateDynamically:!0,ShouldAutoOpen:!0,MenuSectionList:[]})});f&&Array.add(N.Menu.MenuSectionList,f);Array.add(N.Menu.MenuSectionList,x);return N}nGi(f){let x;const N=Object.assign(new bg.a,{Id:"DictationCorrectionSuggestions",ControlList:[],
ControlsId:"DictationCorrectionSuggestionsControls",Title:Box4Intl.Box4Strings.L_DictationCorrectionsGroupTitle});x=null;for(let ea=0,ma=Math.min(this.QOa.length,f.count);ea<ma;++ea){if(!x&&""===f.ga(ea).suggestion){x=this.QOa[ea].toString();continue}const Ha=Object.assign(new xk.a,{ExternalId:"btnDictationCorrectionSuggestion"+ea,Command:this.QOa[ea].toString(),LabelText:f.ga(ea).suggestion});Array.add(N.ControlList,Ha)}return N.ControlList.length?{returnValue:N,mLf:x}:{returnValue:null,mLf:x}}G0b(f){if(f=
this.VBi(f)){const x=Object.assign(new bg.a,{Id:"DictationCorrectionSection",ControlList:[],ControlsId:"DictationCorrectionSection"});Array.add(x.ControlList,f);return x}return null}static XCi(f){const x=Object.assign(new bg.a,{Id:"DictationCorrectionIgnoreSuggestionSection",ControlList:[],ControlsId:"DictationCorrectionIgnoreSuggestionSectionControls"}),N=Object.assign(new xk.a,{ExternalId:"btnIgnoreDictationCorrectionSuggestion",Command:"421768503",LabelText:Box4Intl.Box4Strings.L_DictationCorrectionsIgnoreSuggetion});
Array.add(x.ControlList,N);f&&(f=Object.assign(new xk.a,{ExternalId:"btnDeleteDictationCorrectionSuggestion",Command:f,LabelText:Box4Intl.Box4Strings.L_DictationCorrectionsDeleteSuggetion}),Array.add(x.ControlList,f));return x}}Yd.oLi="Insertaudio_16x16x32";Object(k.a)(Yd,"DictationCorrectionContextMenuManager",null,[667]);var Pe=d(439);class so{constructor(f,x){this.xwc=null;this.pr=f;this.rZ=x}get key(){return"DICTATIONCORRECTION"}get O7(){return Box4Intl.Box4Strings.l_DictationCorrectionContentTitle}reset(f){this.pr.Yd(f.node)?
this.xwc=f.node:this.xwc=null}dtc(f){let x;x=null;if(!this.xwc)return{returnValue:!1,tBa:x};f=this.rZ.S6i(this.xwc,f);if(!f)return{returnValue:!1,tBa:x};x=Object.assign(new Pe.a,{T0:this.key,ZP:f,description:this.Q4d()});return{returnValue:!0,tBa:x}}Q4d(){return J.AFrameworkApplication.fa&&J.AFrameworkApplication.fa.ka("WordEditorIdeasCardsIsEnabled")?Box4Intl.Box4Strings.l_ShowIntentSuggestionTooltipClickOrPress:null}}Object(k.a)(so,"DictationCorrectionDetailsProvider",null,[701,384]);var Bj=d(607),
Qe=d(141);class ln{constructor(f,x,N=-1){this.TriggerType="click";this.TreatedInUX="true";this.PhraseId=f.Hzk;this.CorrectionId=f.id;switch(x){case 0:this.EditType="alternate";this.AlternateId=N;break;case 1:this.EditType="ignore";break;case 2:this.EditType="dismissed";break;default:e.ULS.sendTraceTag(51246608,394,10,"Invalid CorrectionEditType value")}}}Object(k.a)(ln,"CorrectionEvent",null,[]);class Yk{constructor(){this.Id="Corrections";this.Name="Telemetry";this.ClientSessionId="";this.CorrectionEvents=
null}}Object(k.a)(Yk,"CorrectionTelemetry",null,[]);class xf{constructor(){this.Id="Corrections";this.Name="Session";this.ClientSessionId="";this.SessionInfo=null}}Object(k.a)(xf,"CorrectionsSessionTelemetry",null,[]);class Vg{constructor(){this.jS=!1;this.pvd=this.WDd=0}start(){this.jS||(this.jS=!0,this.WDd=this.getTime())}stop(){this.jS&&(this.pvd+=this.getTime()-this.WDd,this.jS=!1)}get Rq(){return this.pvd+(this.jS?this.getTime()-this.WDd:0)}getTime(){return(new Date).getTime()}}Object(k.a)(Vg,
"DictationCorrectionsSessionTimer",null,[]);class mn{constructor(){this.StartTime="";this.AlternateEditCount=this.ManualEditCount=this.Duration=0;this.TextInfo=null}}Object(k.a)(mn,"SessionInfo",null,[]);class Hm{constructor(){this.FinalText="";this.PhraseIds=null}}Object(k.a)(Hm,"TextInfo",null,[]);var Im=d(179),ff=d(129);class to{constructor(f){this.whf=this.FFd=this.GFd=0;this.yLh="Office.Voice.Online.DictationCorrectionsSession";this.B4a=null;this.upb=Object.assign(new mn,{TextInfo:[new Hm]});
this.vaf=f}startSession(){this.B4a||(this.upb.StartTime=(new Date).toISOString(),this.B4a=new Vg);this.B4a.start()}pauseSession(){this.B4a.stop()}endSession(){this.B4a.stop();var f=new Im.a;f.name=this.yLh;f.samplingPolicy=2;f.durationMs=this.B4a.Rq;f.dataFields=[];Array.add(f.dataFields,Object.assign(new ff.a,{name:"CorrectionSessionId",string:this.fya}));Array.add(f.dataFields,Object.assign(new ff.a,{name:"StartTime",string:this.upb.StartTime}));Array.add(f.dataFields,Object.assign(new ff.a,{name:"NumberOfCorrectionsMarked",
int64:this.GFd}));Array.add(f.dataFields,Object.assign(new ff.a,{name:"NumberOfCorrectionsMade",int64:this.FFd}));Array.add(f.dataFields,Object.assign(new ff.a,{name:"NumberOfCorrectionsDismissed",int64:this.whf}));Qe.a.sendActivityEvent(f);if(If.App.d_&&0<If.App.d_.Y9g.length){this.upb.AlternateEditCount=this.FFd;this.upb.Duration=Math.floor(this.B4a.Rq/1E3);this.upb.TextInfo[0].PhraseIds=If.App.d_.Y9g;var x=new xf;x.ClientSessionId=this.fya;x.SessionInfo=this.upb;if(f=this.vaf())x=R.c(x),f.aog(x)}}Lnk(f){this.GFd+=
f}r2g(f,x,N=-1){0===x?this.FFd++:1===x&&this.whf++;var ea=new Yk;ea.ClientSessionId=this.fya;ea.CorrectionEvents=[new ln(f,x,N)];if(f=this.vaf())ea=R.c(ea),f.aog(ea)}get fya(){return If.App.d_?If.App.d_.fya:""}}Object(k.a)(to,"DictationCorrectionsTelemetry",null,[]);var nn=d(42),Uf=d(40);class Cj{constructor(f,x,N){this.oN=f;this.Nb=x;this.MG=N}}Object(k.a)(Cj,"DictationCorrectionRange",null,[]);var ao=d(357);class bo{constructor(f,x,N){this.r7=this.Qq=null;this.Omb=f;this.Oza=x;this.kBc=new ao.a(new Bj.a);
this.owc=N;this.Jna()}rge(f){this.Oza.OCa&&jg.ParagraphReader.Yd(f)&&this.kBc.contains(f.id)&&this.Omb.rge(f)}Hkl(){this.Oza.OCa=!0;this.Qq=new to(()=>this.r7);this.Qq.startSession()}yll(){this.Oza.OCa=!1;var f=If.App.Kb.Jd.Cn.yg;if(f){f=f.Fh;for(let x of this.kBc){const N=f.ye(x);N&&jg.ParagraphReader.Yd(N)&&this.Omb.csi(N)}}this.owc.clear();this.kBc.clear();this.Qq.endSession()}RYk(f){if(this.Oza.OCa){var x=f.sa(Uf.a.fZd,null);if(!ij.a.Wa(x)){var N=new ta.a,ea=Math.min(x.length,f.Ra.length);for(let ma=
0;ma<ea;ma++){const Ha=this.owc.s5i(x[ma]);if(Ha){const Ua=f.Ra.ga(ma).cp;N.add(new Cj(Ua,Ua+Ha.source.length,Ha))}}this.Omb.jfk(f,N)}}}v2e(f,x){if(!x)return!1;if(!this.Oza.OCa||!f)return x.add(null),!1;x.add(f.mv?f.mv.MG.key:null);return!!f.mv}w0k(f,x){this.Oza.OCa&&x&&Wa.AT(x,N=>!!N)?f.te(Uf.a.fZd,x.toArray()):f.removeProperty(Uf.a.fZd)}ggh(f){this.r7=f}Jna(){this.Omb.b8h(Object(v.a)(this,this.Hnk,"onDictationCorrectionMarkerAdded"));pf.a.addHandler(window.self,Sb.a.blur,()=>{this.Qq&&this.Oza.OCa&&
this.Qq.pauseSession()});pf.a.addHandler(window.self,Sb.a.focus,()=>{this.Qq&&this.Oza.OCa&&this.Qq.startSession()});this.Omb.c8h(Object(v.a)(this,this.Jnk,"onDictationCorrectionMarkerRemoved"))}Jnk(f,x){this.owc.HRk(x.WGf)}Hnk(f,x){this.kBc.add(x.Qwk);this.Qq&&this.Qq.Lnk(x.Mfk);this.owc.y4h(x.WGf)}Gnk(f,x){this.Qq&&this.Qq.r2g(f,0,x)}Knk(f){this.Qq&&this.Qq.r2g(f,1)}S6i(f,x){if(!this.Oza.OCa)return null;f=Wh.a.Kj(f,x);return this.Omb.qRc(f)}}Object(k.a)(bo,"DictationCorrectionManager",null,[666]);
class Um extends Sys.EventArgs{constructor(f,x){super();this.Qwk=f;this.Mfk=x?x.count:0;this.WGf=x}}Object(k.a)(Um,"DictationCorrectionMarkerEventArgs",Sys.EventArgs,[]);class Wf{constructor(f,x,N,ea,ma){this.tXh=f;this._id=x;this.jOh=ea;this.rWb=ma;this.It=N;this.mTb=String.format("{0}_{1}",f,x)}get Hzk(){return this.tXh}get id(){return this._id}get source(){return this.It}get confidence(){return this.jOh}get suggestions(){return this.rWb}get key(){return this.mTb}Ugk(f){this.suggestions.addRange(f.suggestions)}}
Object(k.a)(Wf,"DictationCorrectionDetails",null,[]);class on{constructor(f,x,N){this.Kn=f;this.IOh=x;this.zWh=N}get MG(){return this.IOh}get r3g(){return this.zWh}get Ee(){return this.Kn}$d(f){return new on(f||this.Ee,this.MG,this.r3g)}}Object(k.a)(on,"DictationCorrectionObject",null,[146]);class vg{constructor(f,x){this.source=f;this.suggestion=x}}Object(k.a)(vg,"DictationCorrectionSuggestion",null,[]);class Td{constructor(f){this.Zg=f;this.Oa=new hl.a}b8h(f){this.Oa.addHandler("ADCM",f)}c8h(f){this.Oa.addHandler("RDCM",
f)}jfk(f,x){this.tfk(f,x)}tfk(f,x){if(f&&x&&x.count&&(x=Td.SCl(f,x))&&x.count){this.osi(f,x);var N=new ta.a;for(var ea of x)N.add(ea.oN),N.add(ea.Nb);f.a0d(N);for(let ma of x)ea=f.Ra.aT(ma.oN),ea.mv=new on(ea,ma.MG,Object(v.a)(this,this.xsj,"handleParagraphSplit")),ea.isFromErrorRangeSplit=!0,ea=f.Ra.aT(ma.Nb),ea.isDictationCorrectionEnd=!0,ea.isFromErrorRangeSplit=!0;0<x.count&&this.Oa.raiseEvent("ADCM",new Um(f.id,x))}}OZf(f){const x=new ta.a;if(f){let N=null,ea=-1;for(let ma=0;ma<f.Ra.length;ma++){const Ha=
f.Ra.ga(ma);Ha.mv?(ea=Ha.cp,N=Ha.mv.MG):Ha.isDictationCorrectionEnd&&(N?x.add(new Cj(ea,Ha.cp,N)):e.ULS.sendTraceTag(593285261,394,10,"Correction range end with no start."),N=null)}}return x}ync(f,x){if(f&&x&&x.count){for(let N of x){let ea=f.Ra.aT(N.oN);ea&&(ea.mv=null);if(ea=f.Ra.aT(N.Nb))ea.isDictationCorrectionEnd=!1}this.Oa.raiseEvent("RDCM",new Um(f.id,x))}}csi(f){if(f)for(let x=0;x<f.Ra.length;x++){const N=f.Ra.ga(x);N.mv&&(N.mv=null);N.isDictationCorrectionEnd&&(N.isDictationCorrectionEnd=
!1)}}qRc(f){if(!f||!nn.SelectionEditor.ek(f)&&!nn.SelectionEditor.Sg(f))return null;const x=f.node;let N=f.Qa;f=f.Nb;let ea=0,ma=null;for(let Ha=0;Ha<x.Ra.length;Ha++){const Ua=x.Ra.ga(Ha);if(Ua.mv&&N>=Ua.cp)ma=Ua.mv,ea=Ua.cp;else if(ma&&Ua.isDictationCorrectionEnd){if(f<=Ua.cp)return new Cj(ea,Ua.cp,ma.MG);ma=null}}return null}TCl(f,x,N){if(!f)return!1;f=jg.ParagraphReader.text(f);return Td.kIh(f,x.source,N)}rge(f){if(f){var x=this.OZf(f);if(x&&0<x.count){const N=new ta.a,ea=jg.ParagraphReader.text(f);
for(let ma of x)Td.jIh(ea,ma)||N.add(ma);this.ync(f,N)}}}osi(f,x){x.ga(0);x.ga(x.count-1);const N=this.OZf(f);let ea=0,ma=0;const Ha=new ta.a;for(;ma<x.count&&ea<N.count;){const Ua=x.ga(ma),mb=N.ga(ea);Ua.Nb<mb.oN?ma++:(mb.Nb>Ua.oN&&Ha.add(mb),ea++)}this.ync(f,Ha)}xsj(f,x){const N=x.Ee;for(var ea=f.Ra.mwb(N.cp)+1;ea<f.Ra.length;ea++){const ma=f.Ra.ga(ea);if(ma.isDictationCorrectionEnd){let Ha;this.ync(f,(Ha=new ta.a,Ha.add(new Cj(N.cp,ma.cp,x.MG)),Ha));break}}}Atk(f,x){(f=If.App.Kb.Jd.Cn.yg)&&(x=
f.Fh.ye(dd.a.Hf(x.nodeId)))&&jg.ParagraphReader.Yd(x)&&this.IRk(x)}IRk(f){if(f){var x=0,N=!1,ea=!1,ma=new ta.a;for(let Ha=0;Ha<f.Ra.length;Ha++){const Ua=f.Ra.ga(Ha);Ua.mv&&(x=Ha,N=!0);N&&(Ua.Up||Ua.yL)&&(ea=!0);Ua.isDictationCorrectionEnd&&N&&(N=!1,ea&&(ea=f.Ra.ga(x),ea.mv&&ea.mv.MG&&ma.add(new Cj(ea.cp,Ua.cp,ea.mv.MG)),ea.mv=null,ea=Ua.isDictationCorrectionEnd=!1))}this.Oa.raiseEvent("RDCM",new Um(f.id,ma))}}static SCl(f,x){if(!x.count)return x;x.Sc((ea,ma)=>ea.oN!==ma.oN?ea.oN-ma.oN:ea.Nb-ma.Nb);
f=jg.ParagraphReader.text(f);const N=new ta.a;for(let ea=0;ea<x.count;ea++){const ma=x.ga(ea);if(ma.oN>f.length||ma.Nb>f.length)break;if(!Td.jIh(f,ma))continue;if(!N.count){N.add(ma);continue}const Ha=N.ga(N.count-1);ma.oN>Ha.Nb?N.add(ma):Ha.oN===ma.oN&&Ha.Nb===ma.Nb&&Ha.MG.Ugk(ma.MG)}return N}static kIh(f,x,N){if(N+x.length<=f.length){for(let ea=0;ea<x.length;ea++)if(x.charAt(ea)!==f.charAt(ea+N))return!1;return!0}return!1}static jIh(f,x){return!f||x.oN>f.length||x.Nb>f.length||!x.MG||!x.MG.source?
!1:Td.kIh(f,x.MG.source,x.oN)}}Object(k.a)(Td,"DictationCorrectionRangeEditor",null,[665]);class Kj{constructor(){this.OCa=!1}}Object(k.a)(Kj,"DictationCorrectionSettings",null,[]);var uo=d(14);class co{constructor(){this.nWb=new uo.ScriptSharpLegacyMap}y4h(f){if(f&&f.count)for(let x of f)x.MG?(f=x.MG.key,this.nWb.Hb(f)||this.nWb.add(f,x.MG)):e.ULS.sendTraceTag(593285260,394,10,"Correction details is null.")}HRk(f){if(f&&f.count)for(let x of f)x.MG?this.nWb.remove(x.MG.key):e.ULS.sendTraceTag(593285259,
394,10,"Correction details is null.")}s5i(f){if(!f)return null;let x;return({value:x}=this.nWb.Uf(f)).returnValue?x:null}clear(){this.nWb=new uo.ScriptSharpLegacyMap}}Object(k.a)(co,"DictationCorrectionStorage",null,[700]);class Ml{constructor(f,x,N,ea,ma,Ha,Ua){this.Zg=f;this.TQb=x;this.rZ=N;this.Ca=ea;this.Tc=ma;this.hf=Ha;this.yk=Ua}vb(){this.Ca.ya(ce.a.Qrc,jc.a.Of,Object(v.a)(this,this.Wrc,"takeSuggestedDictationCorrectionAction"));this.Ca.ya(ce.a.Rrc,jc.a.Of,Object(v.a)(this,this.Wrc,"takeSuggestedDictationCorrectionAction"));
this.Ca.ya(ce.a.Trc,jc.a.Of,Object(v.a)(this,this.Wrc,"takeSuggestedDictationCorrectionAction"));this.Ca.ya(ce.a.Urc,jc.a.Of,Object(v.a)(this,this.Wrc,"takeSuggestedDictationCorrectionAction"));this.Ca.ya(ce.a.Vrc,jc.a.Of,Object(v.a)(this,this.Wrc,"takeSuggestedDictationCorrectionAction"));this.Ca.ya(ce.a.Prc,jc.a.Of,Object(v.a)(this,this.Prc,"takeIgnoreSuggestedDictationCorrection"));this.Ca.ya(ce.a.Qrc,jc.a.view,Object(v.a)(this,this.Wsb,"collapseIpThenExecuteAction"));this.Ca.ya(ce.a.Rrc,jc.a.view,
Object(v.a)(this,this.Wsb,"collapseIpThenExecuteAction"));this.Ca.ya(ce.a.Trc,jc.a.view,Object(v.a)(this,this.Wsb,"collapseIpThenExecuteAction"));this.Ca.ya(ce.a.Urc,jc.a.view,Object(v.a)(this,this.Wsb,"collapseIpThenExecuteAction"));this.Ca.ya(ce.a.Vrc,jc.a.view,Object(v.a)(this,this.Wsb,"collapseIpThenExecuteAction"));this.Ca.ya(ce.a.Prc,jc.a.view,Object(v.a)(this,this.Wsb,"collapseIpThenExecuteAction"));this.Ca.he(ce.a.Qrc,96);this.Ca.he(ce.a.Rrc,96);this.Ca.he(ce.a.Trc,96);this.Ca.he(ce.a.Urc,
96);this.Ca.he(ce.a.Vrc,96);this.Ca.he(ce.a.Prc,96)}rdi(f,x,N){const ea=this.yk.le(15);try{ea.kd(f);let ma;this.TQb.ync(f,(ma=new ta.a,ma.add(x),ma));const Ha=x.MG.suggestions.ga(N);if(this.TQb.TCl(f,Ha,x.oN)){const Ua=Wh.a.createTextRange(f,x.oN,x.oN+Ha.source.length);this.Zg.replaceTextRange(Ua,Ha.suggestion);this.rZ.Gnk(x.MG,N)}else e.ULS.sendTraceTag(50946527,394,100,"Failed to apply Suggestion")}finally{ea&&ea.dispose()}}Wrc(f,x,N){2===N&&x.el&&(N=this.TQb.qRc(x))&&this.rdi(x.node,N,this.u5i(f));
return 32}Wsb(f,x,N,ea,ma){if(2===N){x=this.Tc.Pa.mb;if(!x)return 2;x=this.hf.Ql(x,!0,!1);return this.Ca.mi(x.Ua,f,N,!1,ea,ma)}return 32}Prc(f,x,N){if(2===N&&x.el&&(f=this.TQb.qRc(x))){let ea;this.TQb.ync(x.node,(ea=new ta.a,ea.add(f),ea));this.rZ.Knk(f.MG)}return 32}u5i(f){switch(f){case ce.a.Qrc:return 0;case ce.a.Rrc:return 1;case ce.a.Trc:return 2;case ce.a.Urc:return 3;case ce.a.Vrc:return 4;default:return-1}}}Object(k.a)(Ml,"DictationCorrectionsActor",null,[683]);var Jm=d(317),Cn=d(62);class Zk{constructor(){this.U8e=
this.Da=null}get name(){return"Box4.DictationCorrections"}$b(f){this.Da=f;this.Da.register(665,"Box4.DictationCorrections.IDictationCorrectionRangeEditor").ma().oa(()=>new Td(this.Da.resolve("Box4.ICharacterPropertiesEditor")));this.Da.register(666,"Box4.DictationCorrections.IDictationCorrectionManager").ma().oa(()=>new bo(this.Da.resolve("Box4.DictationCorrections.IDictationCorrectionRangeEditor"),new Kj,new co));this.Da.register(667,"Box4.DictationCorrections.IDictationCorrectionContextMenuManager").ma().oa(()=>
new Yd(this.Da.resolve("Box4.DictationCorrections.IDictationCorrectionRangeEditor")))}init(){this.Da.resolve("Box4.DictationCorrections.IDictationCorrectionManager");this.U8e=new Ml(this.Da.resolve("Box4.ICharacterPropertiesEditor"),this.Da.resolve("Box4.DictationCorrections.IDictationCorrectionRangeEditor"),this.Da.resolve("Box4.DictationCorrections.IDictationCorrectionManager"),J.AFrameworkApplication.Ta,Cn.a.instance,Jm.a.instance,this.Da.resolve("Box4.Graph.IGraphTransactionFactory"));this.U8e.vb();
this.VOk(this.Da.Ja("Box4.Accessibility.IAccessibilityContextManager"),this.Da.resolve("Box4.IParagraphReader"),this.Da.resolve("Box4.DictationCorrections.IDictationCorrectionManager"));const f=this.Da.rb("Box4.Proofing.IErrorRangeEditor"),x=this.Da.rb("Box4.DictationCorrections.IDictationCorrectionRangeEditor");J.AFrameworkApplication.fa.ka("WacBox4DictationFloatieIsEnabled")&&f&&x&&f.j9h(Object(v.a)(x,x.Atk,"onSpellingErrorRangesChangedEventHandler"));If.App.Kb.updateCommandUI()}dispose(){}VOk(f,
x,N){f&&f.execute(ea=>{ea.JZa(new so(x,N))})}}Object(k.a)(Zk,"DictationCorrectionsPackageManager",null,[2,3]);d(1199);d(712);var Km=d(479);class kl{constructor(f,x,N,ea=null,ma=null){this.Kn=f;this.DG=x;this.RTh=N;this._id=ea;this.JBd=ma}get Ee(){return this.Kn}get type(){return this.DG}get vk(){return this.RTh}get id(){return this._id}get bdg(){return this.JBd}$d(f){return new kl(f,this.type,this.vk,this.id,this.bdg)}toString(){return String.format("Type = {0}, IsStart = {1}, Id = {2}",this.type,
this.vk,this.id?this.id.toString():"<null>")}}Object(k.a)(kl,"IntentObject",null,[146]);d(595);class Eh{constructor(f,x,N,ea=null,ma=null){Km.a(f);this.DG=f;this.Cwd=x;this.nzd=N;this._id=ea;this.JBd=ma}get type(){return this.DG}get begin(){return this.Cwd}get end(){return this.nzd}get id(){return this._id}get bdg(){return this.JBd}toString(){return String.format("Type = {0}, Begin = {1}, End = {2}, Id = {3}",this.type,this.begin,this.end,this.id?this.id.toString():"<null>")}}Object(k.a)(Eh,"IntentRange",
null,[237]);d(356);d(156);d(210);class mk{constructor(f){this.Zg=f}}Object(k.a)(mk,"IntentRangeEditor",null,[646]);class eo{constructor(){this.Da=null}get name(){return"Box4.Intent"}$b(f){this.Da=f;this.Da.register(mk,"Box4.Intent.IntentRangeEditor").as("Box4.Intent.IIntentRangeEditor").ma().oa(()=>new mk(this.Da.resolve("Box4.ICharacterPropertiesEditor")))}init(){this.Da.resolve("Box4.IProofingManager")}dispose(){}static main(){Na.a.instance.Dc(new eo)}}Object(k.a)(eo,"PackageManager",null,[2,3]);
var fo=d(1144),Dj=d(1106),Vm=d(302),Ki=d(1107),ek=d(923),Dn=d(787);class wg{}wg.productionLanguages="en-US es-ES zh-CN en-CA es-MX en-GB fr-FR de-DE it-IT hi-IN pt-BR fr-CA ja-JP en-IN en-AU".split(" ");wg.previewLanguages="nb-NO da-DK sv-SE fi-FI nl-NL ko-KR pl-PL pt-PT ru-RU th-TH zh-TW ar-SA he-IL tr-TR ar-BH cs-CZ hu-HU el-GR sk-SK vi-VN sl-SI hr-HR ro-RO lt-LT bg-BG lv-LV et-EE ar-EG zh-HK en-NZ ga-IE mt-MT gu-IN mr-IN ta-IN te-IN".split(" ");wg.YDl="en-US en-CA en-GB en-AU en-IN en-NZ".split(" ");
wg.egi=["en-US","en-CA","en-GB","en-AU","en-IN"];wg.fgi="en-US es-ES zh-CN en-CA es-MX en-GB fr-FR de-DE it-IT en-AU en-IN fr-CA pt-BR ja-JP ko-KR hi-IN pl-PL pt-PT ru-RU zh-TW ar-SA he-IL tr-TR ar-BH cs-CZ hu-HU el-GR sk-SK vi-VN sl-SI hr-HR ro-RO lt-LT bg-BG lv-LV et-EE ar-EG zh-HK en-NZ ga-IE mt-MT gu-IN mr-IN ta-IN te-IN".split(" ");wg.GIi="en-US";wg.eLi="btnStartDictation";wg.pLi="btnDictationFloatieToggle";wg.jLi="Dictation";wg.qLi="DictationFloatieToggle";wg.kMf="Insertaudio_32x32x32";wg.jMf=
"Insertaudio_16x16x32";wg.iLi="JotInsertAudioRecordingShort_32x32x32";wg.hLi="JotInsertAudioRecordingShort_16x16x32";wg.Njl="speechOn.wav";wg.Mjl="speechOff.wav";Object(k.a)(wg,"DictationConstants",null,[]);class Vl{constructor(f){this.Def=f;this.WMa=(f=Ij.a.ue(f))?f.displayName:this.Def;this.xG=f?f.LCID:Vl.UXj}get j0c(){return this.Def}get displayName(){return this.WMa}get LCID(){return this.xG}}Vl.UXj=1033;Object(k.a)(Vl,"DictationLanguage",null,[]);class lh{constructor(f,x,N,ea,ma,Ha,Ua,mb,gb){this.Fzc=
null;this.Laf=!1;this.eba=null;this.bqb=!1;this.Ca=f;this.rZ=If.App.H0a;this.Swc=If.App.d_;this.c2=N;this.rCc=x;this.Kf=ea;this.vP=ma;this.vg=Ua;this.Od=gb;this.vg.pL&&(this.eba=Ha);this.wMh=mb}vb(){this.Ca.ra(ce.a.blc,jc.a.view,Object(v.a)(this,this.blc,"populateDictationLanguages"),96);this.Ca.ra(ce.a.mTe,jc.a.view,Object(v.a)(this,this.mTe,"setDictationLanguage"),1028);this.Ca.ra(ce.a.kMe,jc.a.view,Object(v.a)(this,this.kMe,"querySelectedDictationLanguage"),96);this.Ca.ra(ce.a.ANb,jc.a.view,Object(v.a)(this,
this.ANb,"toggleDictation"),1028);this.Ca.ra(ce.a.Ihd,jc.a.view,Object(v.a)(this,this.Ihd,"queryDictation"),96);this.Ca.ra(ce.a.gMf,jc.a.view,Object(v.a)(this,this.oGb,"onDictationError"),64);this.Ca.ra(ce.a.lMf,jc.a.view,Object(v.a)(this,this.oGb,"onDictationError"),64);this.Ca.ra(ce.a.oMf,jc.a.view,Object(v.a)(this,this.Pnk,"onDictationRecordingStarted"),64);this.Ca.ra(ce.a.pMf,jc.a.view,Object(v.a)(this,this.Qnk,"onDictationRecordingStopped"),64);this.Ca.ra(ce.a.mMf,jc.a.view,Object(v.a)(this,
this.Onk,"onDictationModifyRunLanguage"),64);this.Ca.ra(ce.a.iMf,jc.a.view,Object(v.a)(this,this.Nnk,"onDictationFocusLost"),64);this.Ca.ra(ce.a.rMf,jc.a.view,Object(v.a)(this,this.ook,"onFailedToInsertText"),64);this.Ca.ra(ce.a.nMf,jc.a.view,Object(v.a)(this,this.Snk,"onDictationTimeout"),64);this.Ca.ra(ce.a.E$g,jc.a.view,Object(v.a)(this,this.blc,"populateDictationLanguages"),96);this.Ca.ra(ce.a.nTe,jc.a.view,Object(v.a)(this,this.nTe,"setDictationSettingsLanguage"),1028);this.Ca.ra(ce.a.zLe,jc.a.view,
Object(v.a)(this,this.zLe,"queryDictationSettingsLanguage"),96);this.Ca.ra(ce.a.lLi,jc.a.view,Object(v.a)(this,this.showHelpPane,"showHelpPane"),96);this.Ca.ra(ce.a.mLi,jc.a.view,Object(v.a)(this,this.showHelpPane,"showHelpPane"),96);this.Ca.ra(ce.a.kLi,jc.a.view,Object(v.a)(this,this.Jql,"toggleAutoPunctuation"),96);this.Ca.ra(ce.a.OGk,jc.a.view,Object(v.a)(this,this.VHk,"queryToggleAutoPunctuation"),96);this.Ca.ra(ce.a.nLi,jc.a.view,Object(v.a)(this,this.Wql,"toggleVoiceCommands"),96);this.Ca.ra(ce.a.PGk,
jc.a.view,Object(v.a)(this,this.WHk,"queryToggleVoiceCommands"),96);this.Ca.ra(ce.a.Wrd,jc.a.view,Object(v.a)(this,this.Wrd,"toggleDictationInFloatie"),1028);this.Ca.ra(ce.a.hMf,jc.a.view,Object(v.a)(this,this.Mnk,"onDictationFloatieDismissed"),1028);this.Ca.ra(ce.a.gLi,jc.a.view,Object(v.a)(this,this.krk,"onPauseDictationCommand"),96);this.Ca.ra(ce.a.fLi,jc.a.view,Object(v.a)(this,this.mok,"onExitDictationCommand"),96);const f=Zb.KeyInputManager.Na(og.a.XHh,1);this.Od.Gc(Bd.AFrame.nj).bindAction(f,
ce.a.qMf);this.Ca.ra(ce.a.qMf,jc.a.view,Object(v.a)(this,this.Rnk,"onDictationShortcut"),1028)}pRc(){return J.AFrameworkApplication.Aa&&J.AFrameworkApplication.Aa.hb.Np?this.vg.pL?wg.qLi:wg.jLi:this.vg.pL?wg.pLi:wg.eLi}Ihd(f,x,N,ea,ma){if(1===N)return 32;ma&&(f=!!J.AFrameworkApplication.Aa&&J.AFrameworkApplication.Aa.hb.Np,this.eba?ma[f?Vh.a.On:Dj.a.On]=this.eba.isVisible():(N=this.c2.wI(),N=(x=2===N)||1===N,f?(ma[Vh.a.On]=N,ma[Vm.a.IconSet]=x?(new Ki.a("JotInsertAudioRecordingShort_20")).iconSet:
J.AFrameworkApplication.Aa.hb.zoa?(new Ki.a("InsertAudio_32")).iconSet:(new Ki.a("InsertAudio_20",null,null,"InsertAudio_32")).iconSet):(ma[Dj.a.On]=N,x?(ma[Dj.a.Image32by32Class]=Xd.getImageClass(wg.iLi),ma[Dj.a.Image16by16Class]=Xd.getImageClass(wg.hLi)):(ma[Dj.a.Image32by32Class]=Xd.getImageClass(wg.kMf),ma[Dj.a.Image16by16Class]=Xd.getImageClass(wg.jMf)))));return 32}ANb(f,x,N){if(2===N)if(this.eba)this.DBh();else return this.L0d();return 32}Wrd(f,x,N){return 2!==N?32:this.L0d()}blc(f,x,N,ea,
ma){if(1===N)return 32;this.LAk(ma,f===ce.a.E$g);return 32}kMe(f,x,N,ea,ma){if(1===N)return 32;ma&&((f=ma.MenuItemId)&&f===this.vg.NS?(ma[Vh.a.On]=!0,this.Fzc=ma.SourceControlId):ma[Vh.a.On]=!1);return 32}zLe(f,x,N,ea,ma){if(1===N)return 32;ma&&(ma[ek.a.Value]=(new Vl(this.vg.NS)).displayName);return 32}mTe(f,x,N,ea,ma){if(1===N)return 32;ma&&(f=ma.SourceControlId,this.Fzc!==f&&(this.vg.NS=ma.MenuItemId,this.iGh(this.Fzc),this.iGh(f),this.Fzc=f,2===this.c2.wI()&&this.$U()));return 32}nTe(f,x,N,ea,
ma){if(1===N)return 32;if(ma){f=ma.MenuItemId;if(this.vg.NS!==f){this.vg.NS=f;if(this.eba)this.eba.onDictationLanguageChanged(f);2===this.c2.wI()&&this.$U()}this.z2e()}return 32}showHelpPane(f,x,N,ea,ma){if(1===N)return 32;f=this.wMh.value;if(!f)return 0;ma&&(ma={},ma.query="AssetID="+(this.vg.BBl?lh.IRh:lh.UAd),ma=Object.assign(new fo.a,{nonPersistedSettings:ma}),f.Ufa(lh.TAd,ma));return 32}Jql(f,x,N,ea,ma){if(1===N)return this.vg.dhe?32:8;ma&&this.vg&&(this.vg.useAutoPunctuation=ma[Vh.a.On]);2===
this.c2.wI()&&this.$U();this.z2e();return 32}Wql(f,x,N,ea,ma){if(1===N)return this.vg.mle?32:8;ma&&this.vg&&(this.vg.OOb=ma[Vh.a.On]);2===this.c2.wI()&&(this.c2.$U(),this.sOb());this.JFh();return 32}VHk(f,x,N,ea,ma){if(1===N)return 32;ma&&this.vg&&(ma[Vh.a.On]=this.vg.useAutoPunctuation);return 32}WHk(f,x,N,ea,ma){if(1===N)return 32;ma&&this.vg&&(ma[Vh.a.On]=this.vg.OOb);return 32}Mnk(f,x,N){2===N&&this.ENc();return 32}krk(f,x,N){2===N&&this.vg.pL&&2===this.c2.wI()&&this.$U();return 32}mok(f,x,N){2===
N&&this.vg.pL&&this.ENc();return 32}x4h(){const f=Object.assign(new bg.a,{Title:"",ShowMenuSectionSeparator:!0,DisplayMode:"Menu",Id:"dictationButton",ControlsId:"ctrDictationButton",ControlList:[]}),x=Object.assign(new aa.a,{Id:"DictationLanguageList_"+this.pRc(),ExternalId:"DictationLanguageList_"+this.pRc(),LabelText:Box4Intl.Box4Strings.L_DictationRibbonLabel,Command:"1394650145",MenuItemId:this.pRc(),QueryCommand:"2417470717",Image16by16Class:Xd.getImageClass(wg.jMf),Image32by32Class:Xd.getImageClass(wg.kMf),
Visible:!0,AriaLabel:Xa.a.$ei});Array.add(f.ControlList,x);return f}LAk(f,x){f.MenuItems=Object.assign(new He.a,{Id:x?"DictationSettingsLanguageList":"DictationLanguageList",MenuSectionList:[],UpdateDynamically:!0});if(!x){var N=this.x4h();Array.add(f.MenuItems.MenuSectionList,N)}N=this.vg.gch;0<N.length&&(N=lh.YKc(N,"dictationProdcutionLanguages","",x),Array.add(f.MenuItems.MenuSectionList,N));N=this.vg.fbh;0<N.length&&(x=lh.YKc(N,"dictationPreviewLanguages",Box4Intl.Box4Strings.L_DictationPreviewLanguages,
x),Array.add(f.MenuItems.MenuSectionList,x));f.PopulationXML=Ie.l(f.MenuItems);this.Laf=!0}sOb(){const f=this.rCc.value;if(f){const x=this.pRc();if(J.AFrameworkApplication.Aa&&J.AFrameworkApplication.Aa.hb.Np){const N={};N[x]=this.vg.pL?"ToggleButtonModel":"SplitButtonModel";this.Laf&&!this.vg.pL&&(N["DictationLanguageList_"+x]="ToggleButtonModel");f.qOb(N)}this.z2e();this.JFh()}}z2e(){if(this.vg.pL){const f=this.rCc.value;J.AFrameworkApplication.Aa&&J.AFrameworkApplication.Aa.hb.Np&&f.qOb({DictationSettingsAutoPunctuation:"CheckboxModel"})}}JFh(){if(this.vg.pL){const f=
this.rCc.value;J.AFrameworkApplication.Aa&&J.AFrameworkApplication.Aa.hb.Np&&f.qOb({DictationSettingsVoiceCommands:"CheckboxModel"})}}iGh(f){const x=this.rCc.value;if(x&&J.AFrameworkApplication.Aa&&J.AFrameworkApplication.Aa.hb.Np){const N={};N[f]="ToggleButtonModel";x.qOb(N)}}oGb(f,x,N){2===N&&(this.vg.pL?this.ENc():this.$U());return 32}ook(f,x,N){2===N&&this.$U();return 32}Pnk(f,x,N){2===N&&this.sOb();return 32}Qnk(f,x,N){2===N&&(this.c2.$U(),this.sOb());return 32}Onk(f,x,N,ea,ma){2===N&&ma&&(f=
Ij.a.ue(this.vg.NS),this.Kf.mpc(this.vP.ps(ma),f.LCID,ma.Nb));return 32}Nnk(f,x,N){2===N&&this.$U();return 32}Snk(f,x,N){2===N&&this.$U();return 32}DBh(){this.bqb||(this.bqb=!0,this.eba.isVisible()?(this.ENc(),this.bqb=!1):this.showFloatie(),this.sOb())}showFloatie(){this.eba.showFloatie((new Vl(this.vg.NS)).displayName).then(()=>{0===this.c2.wI()&&this.c2.ikb().then(()=>{this.bqb=!1}).catch(f=>{this.bqb=!1;e.ULS.sendTraceTag(577901849,394,10,"Failed to start dictation {0}",f)});this.vg.M8b&&this.rZ&&
this.rZ.Hkl();this.Swc&&this.Swc.startSession()}).catch(()=>{this.bqb=!1})}L0d(){const f=this.c2.wI();if(1===f||3===f)return 1;0===f?this.ikb():this.$U();return 32}ENc(){const f=this.c2.wI();1!==f&&(this.eba&&this.eba.hideFloatie(),this.rZ&&this.rZ.yll(),0!==f&&this.$U(),this.Swc&&this.Swc.endSession(),this.sOb())}$U(){this.c2.$U();this.sOb()}ikb(){this.c2.ikb().then(()=>{}).catch(f=>{e.ULS.sendTraceTag(577901848,394,10,"Failed to start dictation {0}",f)})}Rnk(f,x,N){return 2===N&&this.vg&&this.vg.lKj?
this.vg.pL&&this.eba&&!this.eba.isVisible()?(this.DBh(),32):this.L0d():32}static createInstance(f,x,N,ea,ma,Ha,Ua,mb){return lh.Ka||(lh.Ka=new lh(J.AFrameworkApplication.Ta,f,x,N,ea,ma,Ha,Ua,mb))}static YKc(f,x,N,ea){N=Object.assign(new bg.a,{DisplayMode:"Menu",Title:N,Id:x,ControlsId:"ctr"+x,ControlList:[]});for(const ma of f){f=x+"_"+ma.j0c;const Ha=ma.displayName,Ua=ma.j0c;ea?(f=Object.assign(new Dn.a,{Id:f,ExternalId:f,LabelText:Ha,Command:"3662249320",MenuItemId:Ua,Visible:!0}),Array.add(N.ControlList,
f)):(f=Object.assign(new aa.a,{Id:f,ExternalId:f,LabelText:Ha,Command:"2863762275",MenuItemId:Ua,QueryCommand:"2739750502",Visible:!0,AriaLabel:Xa.a.rrb}),Array.add(N.ControlList,f))}return N}}lh.Ka=null;lh.TAd="FA000000012";lh.UAd="3876e05f-3fcc-418f-b8ab-db7ce0d11d3c";lh.IRh="78766431-0933-4603-abf5-5bcc1dee9dda";Object(k.a)(lh,"DictationActor",null,[674]);var sm=d(269),vo=d(1104),yk=d(155);class pn{constructor(f,x){this.sZ=null;this.pba=!1;this.PMa=null;this.rPh=f;this.vg=x}isVisible(){return this.pba}uXc(){return this.pba&&
!!this.sZ}CQi(){if(this.sZ)return!0;this.sZ=this.rPh.value;if(!this.sZ)return!1;this.sZ.UIl(ce.a.Wrd);this.sZ.OIl(ce.a.hMf);pf.a.addHandler(window.self,Sb.a.resize,()=>{this.Gvj()});const f=Lc.FocusManager.instance().Gc(yk.AppFrame.A7a);f.Wba(x=>{this.xYi(x)});f.xBa((x,N)=>{this.wYi(N)});f.zL=!0;f.HQe=!0;sm.a.instance.w2(yk.AppFrame.A7a,!0);sm.a.instance.Ho(yk.AppFrame.A7a);return!0}xYi(f){this.uXc()&&f.name!==Bd.AFrame.VO&&this.sZ.focus()}wYi(f){this.uXc()&&f.name!==Bd.AFrame.VO&&this.sZ.blur()}showFloatie(f){return this.pba?
Promise.resolve(null):this.CQi()?new Promise((x,N)=>{this.sZ.JHl().then(()=>{this.sZ.showDictationFloatie(this.LRc(),!1,f,this.vg.useAutoPunctuation);this.PMa=f;this.pba=!0;sm.a.instance.EK(yk.AppFrame.A7a);x(null)}).catch(()=>{N("failed to intialize the floatie")})}):Promise.reject("Unable to find the dictation floatie controller")}hideFloatie(){this.uXc()&&(this.sZ.dismissDictationFloatie(),sm.a.instance.Ho(yk.AppFrame.A7a),this.pba=!1)}showDictationWarning(f){this.uXc()&&this.sZ.showDictationWarning(f)}onDictationLanguageChanged(f){this.PMa=
f}LRc(){var f=If.App.Kb.H7a.getBoundingClientRect();const x=f.left+f.width/2-44;f=f.top+f.height-70;return Object.assign(new vo.a,{x,y:f})}Gvj(){this.pba&&this.sZ&&(this.sZ.dismissDictationFloatie(),this.sZ.showDictationFloatie(this.LRc(),!1,this.PMa,this.vg.useAutoPunctuation))}}Object(k.a)(pn,"DictationFloatieManager",null,[]);class $k{constructor(){this.Bha=this.wAa=0;this.pxc=null;this.sba=!0;this.Luc="";this.vg=this.Eh=null;this.xAa=this.xba=this.hNa=this.At=this.Jj=0;this.qzd=this.lZ="";this.iVb=
this.rQb=0;this.Kzd=this.aAd=this.$zd=!1;this.WJd="";this.SUb=this.URb=this.Xh=this.b2=null;this.Zxd=this.fAc=this.eAc=this.uLd=this.Unf=this.Z4a=this.X4a=0}set Ixi(f){this.lZ=f}get fya(){return If.App.d_?If.App.d_.fya:""}get U0a(){return If.App.d_?If.App.d_.U0a:""}set U0a(f){If.App.d_&&(If.App.d_.U0a=f)}onFragment(f){this.hNa||(this.hNa=(new Date).getTime());this.URb&&(this.URb.stop(),this.X4a+=this.URb.Rq,this.URb.start());this.wAa++;this.xAa+=f.split(" ").length}onFinalPhrase(f){this.hNa||(this.hNa=
(new Date).getTime());this.SUb&&(this.SUb.stop(),this.Z4a+=this.SUb.Rq,this.SUb.start());this.xAa=0;this.Bha++;this.xba+=f.split(" ").length}onConnectionStarted(f){this.rQb=(new Date).getTime();this.Ixi=f;this.Xh&&(this.URb=this.Xh.Ci("WebServiceCall","FragmentResponse"),this.SUb=this.Xh.Ci("WebServiceCall","PhraseResponse"))}onRecordingStarted(){this.iVb=(new Date).getTime()}onMicrophoneError(f){this.onCustomError("MicrophoneError",f)}onCustomError(f,x=null){this.sba=!1;this.pxc=f;this.setEndReason(x||
f)}setEndReason(f){this.qzd=f}onTextInsertionError(){this.onCustomError("FailedToInsertText")}onTextInserted(f,x){this.Zxd=x;f?(this.uLd+=x,x>this.fAc&&(this.fAc=x)):(this.Unf=x,x>this.eAc&&(this.eAc=x))}onFocusLost(){this.$zd=!0}onFocusLostWhileStarting(){this.aAd=!0}onFailedToStartTurn(){this.Kzd=!0}onSpeechSessionStarted(f){this.WJd=f}setDictationLatency(f){this.b2=f}endActivity(){}onCommandCalled(){}onAugloopError(){}onFinalResultAnnotationResponse(){}onPartialResultAnnotationResponse(){}setRecordingStartTime(){}onCommandError(){}setCurFinalResultAnnotationResponseTime(){}calculateMaxAndMinFinalResultUserPerceivedLatency(){}setCurPartialResultAnnotationResponseTime(){}calculateMaxAndMinPartialResultUserPerceivedLatency(){}setFirstAudioChunkStartTime(){}setMicrophoneWarmUpLatency(){}getDictationStartTime(){}}
Object(k.a)($k,"AbstractDictationSessionTelemetry",null,[743]);class kj{}kj.seen="Seen";kj.tried="Tried";kj.kept="Kept";Object(k.a)(kj,"FunnelStatus",null,[]);class Ej{constructor(){this.dataFields=this.name=null}}Object(k.a)(Ej,"Contract",null,[]);class nk extends $k{constructor(f,x){super();this.F7e=this.E7e=this.a6e=!1;this.LEd=this.GEd=this.MHd=0;this.VEd=this.UEd=2147483647;this.tLd=this.rLd=0;this.vg=f;this.Jj=(new Date).getTime();this.Xh=x;this.U0a=ha.a.create().toString();this.Eh=new Im.a;
this.Eh.dataFields=[];this.Luc="Office.Voice.Online.ALDictationSession"}onFinalResultAnnotationResponse(f,x,N){f=f+this.Zxd-(this.MHd+(x+N)/1E4);this.rLd+=f;this.GEd<f&&(this.GEd=f);this.UEd>f&&(this.UEd=f)}onPartialResultAnnotationResponse(f,x,N){f=f+this.Zxd-(this.MHd+(x+N)/1E4);this.tLd+=f;this.LEd<f&&(this.LEd=f);this.VEd>f&&(this.VEd=f)}setRecordingStartTime(f){this.MHd=f}onCommandCalled(){this.E7e=!0}onAugloopError(f){this.sba=!1;this.a6e=!0;this.pxc=f}onCommandError(){this.F7e=!0}endActivity(){this.xba+=
this.xAa;this.At=(new Date).getTime();this.Eh.succeeded=this.sba;this.Eh.durationMs=this.At-this.Jj;Array.add(this.Eh.dataFields,Object.assign(new ff.a,{name:"Success",bool:this.sba}));this.sba||Array.add(this.Eh.dataFields,Object.assign(new ff.a,{name:"error",string:this.pxc}));Array.add(this.Eh.dataFields,Object.assign(new ff.a,{name:"SessionID",string:this.fya}));Array.add(this.Eh.dataFields,Object.assign(new ff.a,{name:"SpeechSessionID",string:this.WJd}));Array.add(this.Eh.dataFields,Object.assign(new ff.a,
{name:"TurnID",string:this.U0a}));Array.add(this.Eh.dataFields,Object.assign(new ff.a,{name:"NumberOfWords",int64:0<this.xAa?this.xAa+this.xba:this.xba}));Array.add(this.Eh.dataFields,Object.assign(new ff.a,{name:"NumberOfFragments",int64:this.wAa}));Array.add(this.Eh.dataFields,Object.assign(new ff.a,{name:"NumberOfFinalPhrases",int64:this.Bha}));Array.add(this.Eh.dataFields,Object.assign(new ff.a,{name:"Language",string:this.vg.NS}));Array.add(this.Eh.dataFields,Object.assign(new ff.a,{name:"connectionID",
string:this.lZ}));Array.add(this.Eh.dataFields,Object.assign(new ff.a,{name:"IsFrontdoor",bool:!0}));Array.add(this.Eh.dataFields,Object.assign(new ff.a,{name:"IsUsingFloatie",bool:this.vg.pL}));Array.add(this.Eh.dataFields,Object.assign(new ff.a,{name:"UseAutoPunctuation",bool:this.vg.useAutoPunctuation}));Array.add(this.Eh.dataFields,Object.assign(new ff.a,{name:"EndReason",string:this.qzd}));this.hNa&&Array.add(this.Eh.dataFields,Object.assign(new ff.a,{name:"TimeToGetFirstResult",int64:this.hNa-
this.rQb}));this.sba&&(Array.add(this.Eh.dataFields,Object.assign(new ff.a,{name:"TimeToStartRecording",int64:this.iVb-this.Jj})),Array.add(this.Eh.dataFields,Object.assign(new ff.a,{name:"TimeToOpenConnection",int64:this.rQb-this.iVb})));Array.add(this.Eh.dataFields,Object.assign(new ff.a,{name:"FocusLost",bool:this.$zd}));Array.add(this.Eh.dataFields,Object.assign(new ff.a,{name:"FocusLostWhileStarting",bool:this.aAd}));Array.add(this.Eh.dataFields,Object.assign(new ff.a,{name:"FailedToStartTurn",
bool:this.Kzd}));Array.add(this.Eh.dataFields,Object.assign(new ff.a,{name:"MaxTimeToInsertFragment",int64:this.eAc}));Array.add(this.Eh.dataFields,Object.assign(new ff.a,{name:"MaxTimeToInsertPhrase",int64:this.fAc}));var f=kj.seen;this.sba&&0<this.xba&&(f=0<this.Bha?kj.kept:kj.tried);Array.add(this.Eh.dataFields,Object.assign(new ff.a,{name:"DictationFunnel",contract:Object.assign(new Ej,{name:"Office.System.Funnel",dataFields:[Object.assign(new ff.a,{name:"Name",string:"Dictation"}),Object.assign(new ff.a,
{name:"State",string:f})]})}));this.Eh.name=this.Luc;this.Eh.samplingPolicy=2;Array.add(this.Eh.dataFields,Object.assign(new ff.a,{name:"AugloopFailed",bool:this.a6e}));Array.add(this.Eh.dataFields,Object.assign(new ff.a,{name:"CommandsUsed",bool:this.E7e}));Array.add(this.Eh.dataFields,Object.assign(new ff.a,{name:"CommandsFailed",bool:this.F7e}));Array.add(this.Eh.dataFields,Object.assign(new ff.a,{name:"MaxFinalResultUserPerceivedLatency",int64:this.GEd}));Array.add(this.Eh.dataFields,Object.assign(new ff.a,
{name:"MinFinalResultUserPerceivedLatency",int64:this.UEd}));Array.add(this.Eh.dataFields,Object.assign(new ff.a,{name:"MaxPartialResultUserPerceivedLatency",int64:this.LEd}));Array.add(this.Eh.dataFields,Object.assign(new ff.a,{name:"MinPartialResultUserPerceivedLatency",int64:this.VEd}));f=0<this.Bha?this.rLd/this.Bha:0;const x=0<this.wAa?this.tLd/this.wAa:0;Array.add(this.Eh.dataFields,Object.assign(new ff.a,{name:"AverageFinalResultUserPerceivedLatency",double:f}));Array.add(this.Eh.dataFields,
Object.assign(new ff.a,{name:"AveragePartialResultUserPerceivedLatency",double:x}));Qe.a.sendActivityEvent(this.Eh)}}Object(k.a)(nk,"AugloopDictationTelemetry",$k,[]);var pj=d(215);class ke{constructor(f){this.B6=f}play(){this.B6.play()}pause(){this.B6.pause()}get paused(){return this.B6.paused}get currentTime(){return this.B6.currentTime}set currentTime(f){this.B6.currentTime=f}get duration(){return this.B6.duration}get error(){const f=this.B6.error;return f?f.code:0}get readyState(){return this.B6.readyState}get src(){return this.B6.getAttribute("src")}set src(f){this.B6.setAttribute("src",
f)}get preload(){return this.B6.getAttribute("preload")}set preload(f){this.B6.setAttribute("preload",f)}get Wf(){return this.B6}}Object(k.a)(ke,"AudioElement",null,[]);class yi{constructor(){this.MFd=this.LFd=this.Z4a=this.X4a=this.Nyd=0}onAudioData(){this.Nyd||(this.Nyd=(new Date).getTime())}onFragment(f){this.X4a+=this.T5f(f);this.LFd++}mrk(f){this.Z4a+=this.T5f(f);this.MFd++}EXf(){return this.MFd?this.Z4a/this.MFd:0}t2i(){return this.LFd?this.X4a/this.LFd:this.EXf()}T5f(f){if(!f)return 0;const x=
(new Date).getTime();let N=null;return({kv:N}=R.d(f)).returnValue?x-this.Nyd-(N.Offset+N.Duration)/1E4:0}}Object(k.a)(yi,"DictationLatency",null,[]);class ad{constructor(f,x){this.N6=0;this.UJd=this.VJd=null;this.iTb=!1;this.lAc=null;this.Tyc=!1;this.b2=this.Qq=null;this.sG=x;this.jba=f}onFinalText(f,x){if(2===this.N6){var N=f.size;if(1!==N&&(e.ULS.sendTraceTag(51442337,394,10,"Final text mapping has invalid size of {0}",N),!N))return;x=x.get("JsonResult");this.b2&&this.b2.mrk(x);this.sG.onFinalPhrase(f.values().next().value,
x)}}onFragmentText(f,x){if(2===this.N6){var N=f.size;if(1!==N&&(e.ULS.sendTraceTag(51442338,394,10,"Fragment text mapping has invalid size of {0}",N),!N))return;x=x.get("JsonResult");if(this.b2)this.b2.onFragment(x);this.sG.onFragment(f.values().next().value)}}onError(f){if(0!==this.N6&&3!==this.N6&&"ErrorNone"!==f){this.N6=3;switch(f){case "ErrorInvalidSubscriptionFromConfig":case "ErrorInvalidRegionFromConfig":case "ErrorAddSessionFailure":case "ErrorCreateSpeechSessionBadRequest":this.sG.plk(f);
break;case "ErrorSpeechHandlerWebSocketFailure":case "ErrorProtobufDeserializationFailure":case "ErrorConnectionRetryFailure":this.sG.knk(f);break;case "ErrorWaitAudioTimeout":case "ErrorInitialBabbleTimeout":case "ErrorCustomEndpointTimeout":this.sG.lM(f);break;case "ErrorInitialSilenceTimeout":this.sG.ypk(f);break;case "ErrorInvalidMessage":case "ErrorAudioAbortError":case "ErrorAudioOverconstrainedError":case "ErrorAudioTypeError":case "ErrorAudioCaptureAsync":this.sG.onMicrophoneError(f);break;
case "ErrorAudioSecurityError":case "ErrorAudioNotAllowedError":case "ErrorAudioPermissionDeniedError":this.sG.TFe("NotAllowedError");break;case "ErrorAudioNotFoundError":case "ErrorAudioDevicesNotFoundError":this.sG.TFe("NotFoundError");break;case "ErrorAudioNotReadableError":this.sG.TFe("NotReadableError");break;default:this.sG.guk(f)}this.N6=0}}onSpeechRecognitionStarted(f){window.self.document.hasFocus()?(this.N6=2,this.iTb=!1,this.sG.onRecordingStarted(),this.sG.onConnectionStarted(f),this.VJd||
(this.VJd=Object.assign(new ke(document.createElement("audio")),{src:pj.a.box4Image(wg.Njl)})),this.VJd.play()):(this.f2e(),this.sG.onFocusLost())}onSpeechEnd(){this.f2e();0!==this.wI()&&(this.N6=3,this.sG.Qrk(),this.N6=0,this.UJd||(this.UJd=Object.assign(new ke(document.createElement("audio")),{src:pj.a.box4Image(wg.Mjl)})),this.UJd.play())}onAudioData(f){if(this.b2)this.b2.onAudioData();if(this.jba){var x=0;for(const N of f)x+=Math.pow(N,2);f=Math.sqrt(x/f.length)>ad.Ajl;!this.iTb&&f?(this.iTb=
!0,this.lAc=null):this.iTb&&!f&&(this.lAc?(new Date).getTime()>=this.lAc+ad.shk&&(this.iTb=!1):this.lAc=(new Date).getTime())}}onSpeechSessionStarted(f){this.sG.onSpeechSessionStarted(f)}onEventUpdate(f){if(this.jba&&"QualityStatusUpdate"===f.eventName)switch(f.shortCode){case 13:case 2:this.jba.showDictationWarning(Box4Intl.Box4Strings.L_DictationWarningLowSoundLevel);break;case 3:case 4:this.jba.showDictationWarning(Box4Intl.Box4Strings.L_DictationWarningTooMuchNoise);break;case 8:case 6:case 7:this.jba.showDictationWarning(Box4Intl.Box4Strings.L_DictationWarningCheckNetworkConnection)}}p0a(f,
x){this.sG.xRa(!1);this.sG.Hx=f;this.sG.keg=x;this.jPk();this.Qq=f;this.N6=1;this.b2=new yi;this.Qq&&this.Qq.setDictationLatency(this.b2)}wI(){return this.N6}jPk(){this.Tyc||(pf.a.addHandler(window.self,Sb.a.blur,Object(v.a)(this,this.i3g,"onFocusLostEventHandler")),this.Tyc=!0)}f2e(){this.Tyc&&(pf.a.removeHandler(window.self,Sb.a.blur,Object(v.a)(this,this.i3g,"onFocusLostEventHandler")),this.Tyc=!1)}i3g(){if(1===this.N6){if(this.Qq)this.Qq.onFocusLostWhileStarting()}else 2===this.N6&&(this.f2e(),
this.sG.onFocusLost())}}ad.Ajl=350;ad.shk=350;Object(k.a)(ad,"FrontdoorSpeechClientObserver",null,[716]);class Lh extends ad{constructor(f,x){super(f,x);this.jNa=new ad(f,x)}onFinalText(f,x){this.jNa.onFinalText(f,x)}onFragmentText(f,x){this.jNa.onFragmentText(f,x)}onError(f){this.jNa.onError(f)}onSpeechRecognitionStarted(f){this.jNa.onSpeechRecognitionStarted(f)}onSpeechEnd(){this.jNa.onSpeechEnd()}onAudioData(f){this.jNa.onAudioData(f)}p0a(f,x){this.jNa.p0a(f,x)}wI(){return this.jNa.wI()}}Object(k.a)(Lh,
"AugloopFrontdoorSpeechObserverAbstractDecorator",ad,[]);class kg extends Lh{constructor(f,x,N){super(f,x);this.Tc=N}onFinalText(f,x){super.onFinalText(f,x)}onFragmentText(f,x){if(this.jke())super.onFragmentText(f,x)}onError(f){super.onError(f)}onSpeechRecognitionStarted(f=null){const x=ha.a.create().toString();super.onSpeechRecognitionStarted(f?f:x)}onSpeechEnd(){super.onSpeechEnd()}onAudioData(f){super.onAudioData(f)}p0a(f,x){super.p0a(f,x)}wI(){return super.wI()}jke(){const f=this.Tc.Pa.mb.Ua;
return f.Nb!==f.Qa?!1:!0}}Object(k.a)(kg,"AugloopFrontdoorSpeechObserverDecorator",Lh,[]);class ok{constructor(f){this.Qof=f}onVoiceCommand(f){this.Qof.onVoiceCommand(f)}setDictationSessionTelemetry(f){this.Qof.setDictationSessionTelemetry(f)}}Object(k.a)(ok,"AugloopVoiceCommandObserverAbstractDecorator",null,[741]);class Fn extends ok{constructor(f,x,N){super(f);this.X1=x;this.Tc=N}onVoiceCommand(f){this.jke()&&this.X1.hJl();super.onVoiceCommand(f)}setDictationSessionTelemetry(f){super.setDictationSessionTelemetry(f)}jke(){const f=
this.Tc.Pa.mb.Ua;return f.Nb!==f.Qa?!1:!0}}Object(k.a)(Fn,"AugloopVoiceCommandObserverDecorator",ok,[]);class Nl{constructor(f){this.vg=f}aog(f){const x=J.AFrameworkApplication.Je;if(x){var N=this.vg.mWf;N&&""!==N&&x.Aj(String.format("https://{0}/SpeechHandler.ashx?action=SendCorrectionTelemetry",N),2,f,{["Content-Type"]:"application/json; charset=utf-8"},!1,3,()=>{},()=>{},null)}}}Object(k.a)(Nl,"FrontdoorCorrectionsTelemetryLogger",null,[740]);class Gn{constructor(){this.properties=this.useCorrections=
this.useAutoPunctuation=this.dictationLanguage=null}}Object(k.a)(Gn,"SpeechDictationSettings",null,[]);class bi{constructor(f,x,N,ea){this.Myd=this.Fy=null;this.X1=f;this.jba=x;this.sG=N;this.Lmb=ea;this.initializeCommandsDictionary()}onVoiceCommand(f){if(this.Myd)this.Myd.onCommandCalled();var x=4;if(({value:x}=this.Fy.Uf(f.commandId,0)).returnValue&&4!==x){let N=null;f.commandValue&&(N=new n.a(r.a.jp()),N.add("commandValue",f.commandValue));this.sG.xRa(!1);x=this.X1.executeCommand(x,N);if(f.offset&&
f.duration)this.Lmb.onCommandFinished(f.commandId,x,f.offset,f.duration)}}setDictationSessionTelemetry(f){this.Myd=f}initializeCommandsDictionary(){this.Fy=new n.a(r.a.jp());this.Fy.add("Word.Editing.Undo",2);this.Fy.add("Word.Editing.Bold",5);this.Fy.add("Word.Editing.Italics",6);this.Fy.add("Word.Editing.Underline",10);this.Fy.add("Word.Editing.StrikeThrough",20);this.Fy.add("Word.Editing.Subscript",19);this.Fy.add("Word.Editing.Superscript",18);this.Fy.add("Word.Editing.RemoveBold",11);this.Fy.add("Word.Editing.RemoveUnderline",
13);this.Fy.add("Word.Editing.RemoveItalics",12);this.Fy.add("Word.Editing.RemoveStrikeThrough",21);this.Fy.add("Word.Editing.RemoveSubscript",22);this.Fy.add("Word.Editing.RemoveSuperscript",24);this.Fy.add("Word.Editing.Paste",7);this.Fy.add("Word.Editing.InsertTable",8);this.Fy.add("Word.Editing.InsertComment",9);this.Fy.add("Word.Editing.InsertBullet",23);this.Fy.add("Word.Editing.FullJustify",14);this.Fy.add("Word.Editing.CenterJustify",15);this.Fy.add("Word.Editing.LeftJustify",16);this.Fy.add("Word.Editing.RightJustify",
17);this.Fy.add("Command.Exit",1);this.Fy.add("Command.Pause",0);this.Fy.add("Command.ShowHelp",26);this.Fy.add("Command.ShowCommand",27);this.Fy.add("Word.Editing.RemoveFormatting",28)}}Object(k.a)(bi,"VoiceCommandObserver",null,[741]);var zk=d(958);class aj{constructor(f,x,N,ea,ma,Ha,Ua){this.Qq=this.cXb=null;this.wzj=0;this.Lmb=ma;this.vg=Ua;ma=new Gn;ma.dictationLanguage=Ua.NS;ma.useAutoPunctuation=Ua.useAutoPunctuation?"Intelligent":"Explicit";ma.useCorrections=Ua.M8b.toString();alVoiceClient.DictationSettingsManager.dictationSettings=
ma;this.n7=new kg(f,Ha,ea);this.Rof=new Fn(new bi(x,f,Ha,this.Lmb),x,ea);this.gvc=augLoop.ALFactoryGlobal.getAugLoopRuntimeManager();this.I5e=Array(N);this.gvc.setAnnotationResultCallback(Object.assign(new zk.a,{handler:mb=>{for(const gb of this.I5e)gb.onAnnotationResult(mb)}}));this.hWb=new alVoiceClient.SpeechToTextClient(this.gvc,this.n7,Ua.ylb||Ua.Utd,!1);this.Spf(this.hWb.getAnnotationObserver());this.bXb=new alVoiceClient.VoiceCommandingClient(this.gvc,this.Rof,this.n7);this.Spf(this.bXb.getAnnotationObserver());
Ua.M8b&&(f=new Nl(Ua),(x=If.App.H0a)&&x.ggh(f))}ccg(f,x){return new Promise(N=>{const ea=new Gn;ea.dictationLanguage=f;ea.useAutoPunctuation=this.vg.useAutoPunctuation?"Intelligent":"Explicit";alVoiceClient.DictationSettingsManager.dictationSettings=ea;this.Qq=x;N(this.HCj())})}ikb(f){if(!this.hWb)return 3;this.cXb.startVoiceSessionFromMicrophoneInput();this.n7.p0a(this.Qq,f);f=this.vg.OOb;this.hWb.initializeAsync(f?[1]:[1,0],this.Qq);f&&this.lll();return 0}$U(f){if(f&&this.n7)this.n7.onSpeechEnd();
this.hWb&&this.hWb.uninitializeAsync();this.cXb&&(this.cXb.stopVoiceSession(),this.cXb=null);this.Qq=null;this.vg.OOb&&this.Mll()}wI(){return this.n7.wI()}HCj(){this.vg.OOb&&this.Rof.setDictationSessionTelemetry(this.Qq);this.cXb=new alVoiceClient.VoiceSession(this.gvc,this.n7,this.vg.ylb,this.Lmb,this.Qq);return 0}lll(){this.bXb&&this.bXb.initializeAsync(this.Qq)}Mll(){this.bXb&&this.bXb.uninitializeAsync()}Spf(f){this.I5e[this.wzj++]=f}}Object(k.a)(aj,"AugloopSpeechClientProxy",null,[690]);class xo extends $k{constructor(f,
x){super();this.vg=f;this.Jj=(new Date).getTime();this.Xh=x;this.U0a=ha.a.create().toString();this.Eh=new Im.a;this.Eh.dataFields=[];this.Luc="Office.Voice.Online.DictationSession"}endActivity(){this.xba+=this.xAa;this.At=(new Date).getTime();this.Eh.succeeded=this.sba;this.Eh.durationMs=this.At-this.Jj;Array.add(this.Eh.dataFields,Object.assign(new ff.a,{name:"Success",bool:this.sba}));this.sba||Array.add(this.Eh.dataFields,Object.assign(new ff.a,{name:"error",string:this.pxc}));Array.add(this.Eh.dataFields,
Object.assign(new ff.a,{name:"SessionID",string:this.fya}));Array.add(this.Eh.dataFields,Object.assign(new ff.a,{name:"SpeechSessionID",string:this.WJd}));Array.add(this.Eh.dataFields,Object.assign(new ff.a,{name:"TurnID",string:this.U0a}));Array.add(this.Eh.dataFields,Object.assign(new ff.a,{name:"NumberOfWords",int64:0<this.xAa?this.xAa+this.xba:this.xba}));Array.add(this.Eh.dataFields,Object.assign(new ff.a,{name:"NumberOfFragments",int64:this.wAa}));Array.add(this.Eh.dataFields,Object.assign(new ff.a,
{name:"NumberOfFinalPhrases",int64:this.Bha}));Array.add(this.Eh.dataFields,Object.assign(new ff.a,{name:"Language",string:this.vg.NS}));Array.add(this.Eh.dataFields,Object.assign(new ff.a,{name:"connectionID",string:this.lZ}));Array.add(this.Eh.dataFields,Object.assign(new ff.a,{name:"IsFrontdoor",bool:!0}));Array.add(this.Eh.dataFields,Object.assign(new ff.a,{name:"IsUsingFloatie",bool:this.vg.pL}));Array.add(this.Eh.dataFields,Object.assign(new ff.a,{name:"UseAutoPunctuation",bool:this.vg.useAutoPunctuation}));
Array.add(this.Eh.dataFields,Object.assign(new ff.a,{name:"EndReason",string:this.qzd}));this.hNa&&Array.add(this.Eh.dataFields,Object.assign(new ff.a,{name:"TimeToGetFirstResult",int64:this.hNa-this.rQb}));this.sba&&(Array.add(this.Eh.dataFields,Object.assign(new ff.a,{name:"TimeToStartRecording",int64:this.iVb-this.Jj})),Array.add(this.Eh.dataFields,Object.assign(new ff.a,{name:"TimeToOpenConnection",int64:this.rQb-this.iVb})));Array.add(this.Eh.dataFields,Object.assign(new ff.a,{name:"FocusLost",
bool:this.$zd}));Array.add(this.Eh.dataFields,Object.assign(new ff.a,{name:"FocusLostWhileStarting",bool:this.aAd}));Array.add(this.Eh.dataFields,Object.assign(new ff.a,{name:"FailedToStartTurn",bool:this.Kzd}));Array.add(this.Eh.dataFields,Object.assign(new ff.a,{name:"AverageFragmentLatency",double:this.b2?this.b2.t2i():0<this.wAa?this.X4a/this.wAa:0}));Array.add(this.Eh.dataFields,Object.assign(new ff.a,{name:"AveragePhraseLatency",double:this.b2?this.b2.EXf():0<this.Bha?this.Z4a/this.Bha:0}));
Array.add(this.Eh.dataFields,Object.assign(new ff.a,{name:"AveragePhraseInsertionLatency",double:0<this.Bha?this.uLd/this.Bha:0}));Array.add(this.Eh.dataFields,Object.assign(new ff.a,{name:"AverageFragmentInsertionLatency",double:0<this.wAa?this.Unf/this.wAa:0}));Array.add(this.Eh.dataFields,Object.assign(new ff.a,{name:"MaxTimeToInsertFragment",int64:this.eAc}));Array.add(this.Eh.dataFields,Object.assign(new ff.a,{name:"MaxTimeToInsertPhrase",int64:this.fAc}));let f=kj.seen;this.sba&&0<this.xba&&
(f=0<this.Bha?kj.kept:kj.tried);Array.add(this.Eh.dataFields,Object.assign(new ff.a,{name:"DictationFunnel",contract:Object.assign(new Ej,{name:"Office.System.Funnel",dataFields:[Object.assign(new ff.a,{name:"Name",string:"Dictation"}),Object.assign(new ff.a,{name:"State",string:f})]})}));this.Eh.name=this.Luc;this.Eh.samplingPolicy=2;Qe.a.sendActivityEvent(this.Eh)}}Object(k.a)(xo,"DictationSessionTelemetry",$k,[]);var Dd=d(1139);class ch{constructor(f,x){this.GAc=f;this.NSh=x}getAccessToken(f){this.NSh&&
this.GAc?this.GAc.nV("OfficeDictation",J.AFrameworkApplication.fa.Ha("DictationResourceID")).then(x=>{x.IsSuccess?f(x.Token):f(ch.f_d)}).catch(()=>{f(ch.f_d)}):f(ch.f_d)}}ch.f_d="dictation access token";Object(k.a)(ch,"AuthenticationProvider",null,[]);class Le{constructor(f){this.USh=f;this.fEc=new Vf.a}debugAssertTag(f,x,N,ea){this.Mud(ea);this.fEc.debugAssertTag(f,x,N,ea)}debugTraceTag(f,x,N,ea){this.Mud(ea);this.fEc.debugTraceTag(f,x,N,ea)}sendTraceTag(f,x,N,ea){this.Mud(ea);this.fEc.sendTraceTag(f,
x,N,ea)}shipAssertTag(f,x,N,ea){this.Mud(ea);this.fEc.shipAssertTag(f,x,N,ea)}Mud(f){if(this.USh){const x=window.console;x&&x.log(String.format("FDSpeechService: {0}",f))}}}Object(k.a)(Le,"FrontdoorExternalLogger",null,[264]);class km{constructor(){this.accessToken=null}}Object(k.a)(km,"IAuthenticationProvider",null,[]);class ze{constructor(){this.customEndpointConfig=this.userSessionId=this.speechFDBase=this.properties=this.targetLanguages=this.sourceLanguage=this.speechMode=null;this.clientApp=
0;this.clientMetaData=null;this.captureAudioPauseResumeRecordingState=this.requestServiceCustomEndpoint=!1;this.speechProcessorScript=null}}Object(k.a)(ze,"ISpeechConfig",null,[]);class Hn{constructor(f,x,N,ea,ma){this.Qq=this.Ipb=null;this.iKd=!1;this.n7=new ad(N,ea);this.yV=f;this.vg=x;this.PMh=new ch(ma,x.kKj);this.vg.M8b&&(f=new Nl(x),(x=If.App.H0a)&&x.ggh(f))}ccg(f,x){return new Promise(N=>{this.PMh.getAccessToken(ea=>{N(this.jCj(f,x,ea))})})}jCj(f,x,N){this.Qq=x;f=this.mWd(f);N=Object.assign(new km,
{accessToken:N});x=new Le(this.vg.bYc);this.Ipb=(new PPTSpeechClient.SpeechClientFactory).createSpeechClient(f,this.n7,N,null,x);return this.Ipb?0:(e.ULS.shipAssertTag(42796123,394,!1,"Speech client was not successfully created"),3)}ikb(f){if(!this.Ipb)return 3;this.n7.p0a(this.Qq,f);this.Ipb.startSpeechRecognition();return 0}$U(f){if(!this.iKd){this.iKd=!0;if(this.Ipb)try{this.Ipb.stopSpeechRecognition()}catch(x){e.ULS.shipAssertTag(593277727,394,!1,x.message)}if(f&&this.n7)this.n7.onSpeechEnd();
this.Qq=null;this.iKd=!1}}wI(){return this.n7.wI()}mWd(f){const x=new ze;x.speechMode="Dictation";x.sourceLanguage=f;(f=this.vg.mWf)&&""!==f&&(x.speechFDBase=String.format("wss://{0}/",f));x.properties=new Map;this.yV&&(x.properties.set("DictationInsertionPointLeft",this.yV.D5f()),x.properties.set("DictationInsertionPointRight",this.yV.Akj()));x.properties.set("Corrections","true");x.properties.set("punctuation",this.vg&&this.vg.useAutoPunctuation?"Intelligent":"Explicit");this.vg.bYc&&x.properties.set("EnableAudioLogging",
this.vg.bYc.toString());switch(Dd.a.tPd){case "Word":x.clientApp=1;break;case "PowerPoint":x.clientApp=0;break;case "OneNote":x.clientApp=2}return x}}Object(k.a)(Hn,"FrontdoorSpeechClientProxy",null,[690]);class ci{static Oel(){ci.showDialog(Box4Intl.Box4Strings.L_DictationErrorDialogTitle,Box4Intl.Box4Strings.L_DictationAccessDeniedErrorMessage)}static lfl(){ci.showDialog(Box4Intl.Box4Strings.L_DictationErrorDialogTitle,Box4Intl.Box4Strings.L_DictationFailedToConnectErrorMessage)}static ygl(f){ci.showDialog(Box4Intl.Box4Strings.L_DictationErrorDialogTitle,
f)}static Hhl(){ci.showDialog(Box4Intl.Box4Strings.L_DictationErrorDialogTitle,Box4Intl.Box4Strings.L_DictationUnknownErrorMessage)}static showDialog(f,x){ci.zf||(ci.zf=new Mb.StandardDialog,ci.zf.yr=J.AFrameworkApplication.tda,ci.zf.xd=0,ci.zf.Xe(1,CommonUIStrings.l_DialogClose),ci.zf.cP(f,x,()=>{ci.zf=null}))}}ci.zf=null;Object(k.a)(ci,"Dialogs",null,[]);class Og{constructor(f,x,N,ea,ma,Ha,Ua,mb){this.Bob=this.gqb=!1;this.Hx=null;this.yV=f;this.keg=x;this.Ca=N;this.DMa=ea;this.vg=ma;this.X1=Ha;
this.oQb=Ua;this.jba=mb;this.Njf=new O.a;for(f=0;f<Og.Mjf.length;f++)this.Njf.add(Og.Mjf.charAt(f).toString())}onFinalPhrase(f,x=null){let N=!0;if(this.Hx)this.Hx.onFinalPhrase(f);if(this.oQb&&this.X1){var ea=this.oQb.iIl(f);if(ea){this.xRa(!1);this.X1.executeCommand(ea.commandId,null);return}}ea=(new Date).getTime();if(1===f.length&&"\n"===f)this.H$d("",null),this.oRf();else{let ma=f.indexOf("\n");for(0<ma&&ma!==f.length-1&&(N=!1);0<=ma;)this.H$d(f.substr(0,ma),N?x:null),this.oRf(),f=f.substr(ma+
1),ma=f.indexOf("\n"),N=!1;this.H$d(f,N?x:null)}f=(new Date).getTime();if(this.Hx)this.Hx.onTextInserted(!0,f-ea)}onFragment(f){if(this.gqb)var x=this.KTc(f);else{if(!this.hqd())return;x=this.Bob?this.KTc(f):f}if(this.Hx)this.Hx.onFragment(f);f=!0;const N=(new Date).getTime();this.yV&&!this.yV.cdi(x)&&(this.b8f(),f=!1);x=(new Date).getTime();if(this.Hx)this.Hx.onTextInserted(!1,x-N);f&&this.X1&&this.X1.bIl()}onRecordingStarted(){this.Ca.processAction(ce.a.oMf,2);if(this.Hx)this.Hx.onRecordingStarted()}onMicrophoneError(f=
""){this.u8f(Box4Intl.Box4Strings.L_DictationMicrophoneErrorMessage,f)}oGb(f){if(this.Hx)this.Hx.onCustomError(f);this.Ca.La(ce.a.gMf,2,f)}plk(f){this.oGb(f);ci.Oel()}knk(f){this.oGb(f);ci.lfl()}guk(f){this.oGb(f);ci.Hhl()}lM(f){this.Hx&&this.Hx.setEndReason(f);this.Ca.La(ce.a.nMf,2,f)}ypk(f){this.lM(f);this.khl()}Qrk(){this.xRa(!1);this.Ca.processAction(ce.a.pMf,2)}onConnectionStarted(f){if(this.Hx)this.Hx.onConnectionStarted(f)}TFe(f){this.u8f(this.ybj(f),f)}onFocusLost(){if(this.Hx)this.Hx.onFocusLost();
this.Ca.processAction(ce.a.iMf,2)}oTj(f){return this.keg&&!H.a.ple(f)&&!this.Njf.contains(f.toString())}KTc(f){return 0<f.length&&this.oTj(f.charAt(0))?" "+f:f}hqd(){if(this.gqb)return!0;if(this.yV){const f=this.yV.D5f();this.Bob=!1;f&&0<f.length&&(this.Bob=!H.a.ple(f.charAt(f.length-1))&&!f.endsWith("\u201c"));return this.gqb=this.yV.hqd()}if(this.Hx)this.Hx.onFailedToStartTurn();this.X1&&this.X1.dIl();return!1}xRa(f){this.Bob=this.gqb=!1;this.yV&&(f&&this.yV.Shk(),this.yV.xRa())}onSpeechSessionStarted(f){if(this.Hx)this.Hx.onSpeechSessionStarted(f);
this.vg.bYc&&this.tWe(f)}u8f(f,x=""){if(this.Hx)this.Hx.onMicrophoneError(x);this.Ca.processAction(ce.a.lMf,2);ci.ygl(f)}ybj(f){f=f.trimStart();return f.startsWith("NotAllowedError")||f.startsWith("PermissionDeniedError")?Box4Intl.Box4Strings.L_DictationMicrophoneAccessDeniedMessage:f.startsWith("NotFoundError")||f.startsWith("DevicesNotFoundError")?Box4Intl.Box4Strings.L_DictationMicrophoneNotFoundMessage:f.startsWith("NotReadableError")||f.startsWith("TrackStartError")?Box4Intl.Box4Strings.L_DictationMicrophoneInUseMessage:
Box4Intl.Box4Strings.L_DictationMicrophoneErrorMessage}khl(){this.DMa&&this.DMa.execute(f=>{f.zfl()})}tWe(f){this.DMa&&this.DMa.execute(x=>{x.tWe(String.format("ServiceSessionID:{0} ClientSessionId: {1}",f,this.Usi))})}H$d(f,x){if(this.gqb||this.hqd()){if(this.yV){const N=this.Bob?this.KTc(f):f;(this.vg.M8b&&Object(Ai.a)(689,this.yV)?this.yV.LHl(N,x,0<f.length&&f.charAt(0)!==N.charAt(0)):this.yV.NEj(this.Bob?this.KTc(f):f))||this.b8f()}this.xRa(!0)}}b8f(){if(this.Hx)this.Hx.onTextInsertionError();
this.Ca.processAction(ce.a.rMf,2)}oRf(){this.Ca.processAction(ce.a.rB,2)}get Usi(){return If.App.d_?If.App.d_.fya:""}}Og.Mjf='-\u2013.,:;/?!"\u3002\uff0c\uff1a\uff1b\u3001\uff1f\uff01\u201d';Object(k.a)(Og,"SpeechClientObserverController",null,[]);class qn{constructor(f,x,N,ea,ma,Ha,Ua,mb,gb,Cb,zb,Pb){this.oQb=this.X1=this.jba=this.Qq=this.OOa=null;this.Pw=f;this.sPh=x;this.Tc=N;this.DMa=ea;this.Xh=ma;this.vg=Ha;this.GAc=zb;this.hmf=Pb;this.vg.pL&&(this.jba=Ua);if(this.vg.Cfg||this.vg.ylb)this.X1=
mb;this.vg.Cfg&&(this.oQb=gb);this.Lmb=Cb}ikb(){this.DMa&&this.DMa.execute(f=>{f.Gxj()});return new Promise((f,x)=>{this.OOa?this.zRf(f,x):this.LZj().then(()=>{var N=this.sPh.value;N?(N=N.UBi(),this.OOa=this.cGi(N),this.zRf(f,x)):x(4)}).catch(()=>{x(2)})})}zRf(f,x){this.p0a().then(N=>{0===N?f(0):x(N)}).catch(N=>{x(N)})}p0a(){return new Promise((f,x)=>{this.Qq=new xo(this.vg,this.Xh);if(this.vg.Utd||this.vg.ylb)this.Qq=new nk(this.vg,this.Xh);this.OOa.ccg(this.vg.NS,this.Qq).then(N=>{0!==N?f(N):f(this.OOa.ikb(this.xlg()))}).catch(N=>
{x(N)})})}LZj(){return this.vg.Utd||this.vg.ylb?this.Cng("alVoiceClient",!0):this.Cng("PPTSpeechClient")}Cng(f,x=!1){return!x&&this.hmf&&J.AFrameworkApplication.Aa.hb.bgg?(x=J.AFrameworkApplication.Pj(f,2),Kk.a(this.hmf.pAb(x))):this.Pw?this.Pw.loadScript(f):new Promise((N,ea)=>{ea("Unable to load speech client "+f)})}$U(f=!0){0!==this.wI()&&(this.OOa&&this.OOa.$U(f),this.Qq&&(this.Qq.endActivity(),this.Qq=null))}wI(){return this.OOa?this.OOa.wI():0}xlg(){return"zh-CN"!==this.vg.NS&&"ja-JP"!==this.vg.NS}cGi(f){const x=
new Og(f,this.xlg(),J.AFrameworkApplication.Ta,this.DMa,this.vg,this.X1,this.oQb,this.jba);return this.vg.Utd||this.vg.ylb?new aj(this.jba,this.X1,2,this.Tc,this.Lmb,x,this.vg):new Hn(f,this.vg,this.jba,x,this.GAc)}}Object(k.a)(qn,"DictationManager",null,[]);class tm{constructor(){this.ajf=[];this.U0a=this.jJd=""}startSession(){this.jJd=ha.a.create().toString();this.ajf=[]}endSession(){this.jJd=""}get fya(){return this.jJd}get Y9g(){return this.ajf}}Object(k.a)(tm,"DictationSessionInfo",null,[645]);
class um{constructor(f,x,N){this.VLd=this.YWb=this.SLd=this.XWb=!1;this.PMa="";this.$a=f?f:J.AFrameworkApplication.fa;this.p3a=x;this.Tc=N}get useAutoPunctuation(){if(!this.pL||!this.dhe)return!1;if(this.SLd)return this.XWb;const f=wa.a.instance.getItem("WACDictationFUseAutoPunctuation");this.XWb=void 0===f||null===f?this.$a.ka("DictationAutoPunctuationEnglishDefaultOnIsEnabled")?Array.contains(wg.egi,this.NS):!1:Boolean.parse(f);this.SLd=!0;return this.XWb}set useAutoPunctuation(f){this.pL&&this.dhe&&
(this.XWb=f,this.SLd=!0,wa.a.instance.setItem("WACDictationFUseAutoPunctuation",this.XWb.toString()))}get OOb(){if(!this.pL||!this.mle)return!1;if(this.VLd)return this.YWb;const f=wa.a.instance.getItem("WACDictationFloatieUseVoiceCommands");this.YWb=void 0===f||null===f?!0:Boolean.parse(f);this.VLd=!0;return this.YWb}set OOb(f){this.pL&&this.mle&&(this.YWb=f,this.VLd=!0,wa.a.instance.setItem("WACDictationFloatieUseVoiceCommands",this.YWb.toString()))}get dhe(){return Array.contains(wg.fgi,this.NS)}get mle(){return this.ylb&&
Array.contains(wg.YDl,this.NS)}get NS(){""===this.PMa&&(this.PMa=this.q6i());return this.PMa}set NS(f){f&&(this.PMa=f)}get M8b(){return this.pL}get pL(){return this.$a.ka("WacBox4DictationFloatieIsEnabled")}get BBl(){return this.$a.ka("WacBox4DictationInternalArticle")}get mWf(){return this.$a.Ha("DictationFrontdoorDomain")}get Utd(){return this.$a.ka("WacBox4DictationUseAugloopService")}get Cfg(){return this.$a.ka("WacBox4DictationCommandsIsEnabled")&&this.pL}get ylb(){return this.$a.ka("WacBox4DictationUseAugloopServiceWithFrontdoor")}get kKj(){return this.$a.ka("WacDictationAuthenticationEnabled")}get bYc(){return this.$a.ka("DictationDebugModeEnabled")}get gch(){return this.getSupportedLanguages(0)}get fbh(){return this.getSupportedLanguages(1)}get lKj(){return fa.a.Nyh&&
this.$a.ka("UserCanUseDictation")}getSupportedLanguages(f){const x=[];f=0===f?wg.productionLanguages:wg.previewLanguages;for(const N of f)Array.add(x,new Vl(N));x.sort((N,ea)=>N.displayName.localeCompare(ea.displayName));return x}q6i(){if(this.p3a&&this.Tc){const f=this.p3a.iSc(this.Tc.Qj);for(const x of this.gch)if(x.LCID===f)return x.j0c;for(const x of this.fbh)if(x.LCID===f)return x.j0c}return wg.GIi}}Object(k.a)(um,"DictationSettings",null,[]);class yo{constructor(){this.S8e=this.Da=null}get name(){return"Box4.Dictation"}$b(f){this.Da=
f;const x=na.a.instance.rb("Common.IDynamicScriptLoaderProvider");let N=null;x&&(N=x.Pw);const ea=na.a.instance.re("Box4.Dictation.IDictationHostFactory");this.Da.register(um,"Box4.Dictation.DictationSettings").ma().oa(()=>new um(this.Da.resolve("Common.IAppSettingsManager"),this.Da.resolve("Box4.ILanguageReader"),this.Da.resolve("Box4.ISelectionManager")));const ma=na.a.instance.re("Common.IDictationFloatieController");this.Da.register(pn,"Box4.Dictation.DictationFloatieManager").ma().oa(()=>new pn(ma,
this.Da.resolve("Box4.Dictation.DictationSettings")));this.Da.register(qn,"Box4.Dictation.DictationManager").ma().oa(()=>new qn(N,ea,this.Da.resolve("Box4.ISelectionManager"),f.Ja("Box4.IBusinessBarController"),f.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),this.Da.resolve("Box4.Dictation.DictationSettings"),this.Da.resolve("Box4.Dictation.DictationFloatieManager"),this.Da.rb("Box4.DictationCommands.IDictationCommandManager"),this.Da.rb("Box4.DictationCommands.IDictationCommandParser"),
this.Da.rb("Box4.DictationCommands.IDictationCommandsTelemetry"),this.Da.resolve("Common.App.OAuth.IOAuthManager"),this.Da.resolve("Common.ISharedDependencyLoader")));this.Da.register(645,"Box4.Dictation.IDictationSessionInfo").ma().oa(()=>new tm)}init(){this.Da.resolve("Box4.Dictation.IDictationSessionInfo");this.S8e=lh.createInstance(this.Da.re("Common.IRibbonButtonUpdater"),this.Da.resolve("Box4.Dictation.DictationManager"),this.Da.resolve("Box4.IFormattingEditor"),this.Da.resolve("Box4.IFormattingReader"),
this.Da.resolve("Box4.Dictation.DictationFloatieManager"),this.Da.resolve("Box4.Dictation.DictationSettings"),this.Da.re("Common.App.AppsForOfficeCommon.IAppsForOfficeUIActor"),Lc.FocusManager.instance());this.S8e.vb();If.App.Kb.updateCommandUI()}dispose(){}}Object(k.a)(yo,"DictationPackageManager",null,[2,3]);class zo{constructor(f,x,N){this.NX=null;this.PF=this.tX=-1;this.JBb=!1;this.cJ=f;this.pa=x;this.ia=N}D5f(){return this.G5f(!1)}Akj(){return this.G5f(!0)}hqd(){this.NX&&this.xRa();const f=this.pa.Pa.mb;
if(f){const x=f.Ua;if(x&&jg.ParagraphReader.Yd(x.node))return this.NX=x.node,this.PF=f.Ua.z5a,this.tX=f.Ua.wXb,this.JBb=!0}return!1}xRa(){this.NX=null;this.JBb=!1;this.tX=this.PF=-1}cdi(f){if(this.NX){const x=new ak.GraphTransaction(15);try{x.kd(this.NX);const N=this.JBb&&this.PF!==this.tX?Wh.a.createTextRange(this.NX,this.PF,this.tX):Wh.a.Kj(this.NX,this.tX);this.cJ.replaceTextRange(N,f);this.tX=this.JBb?this.PF+f.length:this.tX+f.length;const ea=Ik.SelectionFactory.Qg(this.NX,this.tX);this.pa.setSelection(ea);
this.JBb=!1;return!0}finally{x&&x.dispose()}}return!1}NEj(f){if(this.NX){const x=new ak.GraphTransaction(15);try{x.kd(this.NX);const N=this.PF!==this.tX?Wh.a.createTextRange(this.NX,this.PF,this.tX):Wh.a.Kj(this.NX,this.tX);this.cJ.replaceTextRange(N,f);this.tX=this.PF+f.length;const ea=Ik.SelectionFactory.Qg(this.NX,this.tX);this.pa.setSelection(ea);this.JBb=!1;return!0}finally{x&&x.dispose()}}return!1}Shk(){var f=this.T6i();this.ia&&f&&f.z5a!==f.wXb&&0<=f.z5a&&(f=Wh.a.createTextRange(f.node,f.z5a,
f.wXb),this.ia.La(ce.a.mMf,2,f))}T6i(){return this.NX?this.PF!==this.tX?Wh.a.createTextRange(this.NX,this.PF,this.tX):Wh.a.Kj(this.NX,this.tX):null}G5f(f){var x=this.pa.Pa.mb;if(x){var N=x.Ua;if(N&&(x=N.node,jg.ParagraphReader.Yd(x)&&(N=f?N.wXb:N.z5a,x=jg.ParagraphReader.text(x),N<=x.length)))return f?x.substring(N,x.length):x.substring(0,N)}return""}}Object(k.a)(zo,"DictationHost",null,[672]);class Wm{constructor(f,x,N){this.cJ=f;this.pa=x;this.ia=N}UBi(){return new zo(this.cJ,this.pa,this.ia)}}
Object(k.a)(Wm,"DictationHostFactory",null,[644]);class pk{get name(){return"PowerPointWebEditor.Dictation"}$b(f){f.register(Wm,"PowerPointWebEditor.Dictation.DictationHostFactory").as("Box4.Dictation.IDictationHostFactory").ma().oa(()=>new Wm(f.resolve("Box4.ICharacterPropertiesEditor"),f.resolve("Box4.ISelectionManager"),J.AFrameworkApplication.Ta))}init(){}dispose(){}static main(){Na.a.instance.Dc(new pk)}}Object(k.a)(pk,"PPTWebEditorDictationPackage",null,[2,3]);var ll=d(453);class Wl{constructor(f,
x,N=null){this.id=f.Id;N||(N="");this.oMk=N;this.sensitivityLabel=f}}Object(k.a)(Wl,"AutoPolicyLabelData",null,[]);class $g{constructor(f,x){this.G7=f;this.displayName=x}}Object(k.a)($g,"PolicyLabelRequestState",null,[]);class vm{static get yle(){return vm.tWj}}vm.tWj="<div class='WACDialogRow' id='JustificationMessageBlock'> <div class='WACDialogIcon' id='JustificationIconArea'> <div class='clip32x32' id='JustificationIconClip' unselectable='on' style='z-index: 0; display: inline-block;'> <img id='iconJustification' class='{1}' role='presentation' src={0} /> </div> </div> <div class='WACDialogTextPanel WACJustificationDialogMessage' id='JustificationMessageArea'> <label id='messageJustification' class='WACDialogLabel' >{2}</label> </div> </div> <br/> <div class='WACDialogTextPanel WACJustificationDialogRow' id='JustificationDlgBlock0'> <input type='radio' id='radiobox0' name='ListRadioBox' class='WACDialogRadio' alt='{3}' title='{3}'></input> <label id='JustificationDlgList0' class='WACDialogLabel' for='radiobox0' >{3}</label> </div> <div class='WACDialogTextPanel WACJustificationDialogRow' id='JustificationDlgBlock1'> <input type='radio' id='radiobox1' name='ListRadioBox' class='WACDialogRadio' alt='{4}' title='{4}'></input> <label id='JustificationDlgList1' class='WACDialogLabel' for='radiobox1' >{4}</label> </div> <div class='WACDialogTextPanel WACJustificationDialogRow' id='JustificationDlgBlock2'> <input type='radio' id='radiobox2' name='ListRadioBox' class='WACDialogRadio' alt='{5}' title='{5}'></input> <label id='JustificationDlgList2' class='WACDialogLabel' for='radiobox2' >{5}</label> </div> <div class='WACDialogTextPanel WACJustificationDialogRow WACJustificationDialogTextAreaRow' id='JustificationTextAreaBlock'> <textarea id='txtJustification' class='JustificationTextArea' placeholder='{6}' style='border:solid 1px grey;resize:none;' autocomplete=\"off\"></textarea> </div>";
Object(k.a)(vm,"JustificationDialogHtml",null,[]);class Th extends lb.a{constructor(f,x){super(!1,!1,Th.F1);this.FNa=[CommonUIStrings.l_SensitivityJustificationNoLongerApplies,CommonUIStrings.l_SensitivityJustificationIncorrect,CommonUIStrings.l_SensitivityJustificationOther];this.UBc=null;this.SBc=!1;this.ICc=f;this.qD=x;this.qg=this.cji();this.xd=1;this.ig=Th.id;this.Xe(1,CommonUIStrings.l_DialogChange);this.cD(1,!1);this.jya(0)}KWe(){if(Th.F1)this.$i(CommonUIStrings.l_SensitivityJustificationTitle,
Object(v.a)(this,this.Geh,"reactJustificationDialogHandler"),this.o3f(this.SBc));else{const f={};for(let x=0;x<this.FNa.length;x++)f[Th.aNe+x]=!1;f[Th.jsc]="";this.$i(CommonUIStrings.l_SensitivityJustificationTitle,Object(v.a)(this,this.sWj,"justificationDialogHandler"),f);this.mOe();pf.a.addHandler($get(Th.jsc),Sb.a.input,Object(v.a)(this,this.fpl,"textAreaHandler"))}}validate(){if(Th.F1)return this.mIh(this.UBc);const f=$get(Th.jsc);return f.disabled?!0:this.mIh(f.value)}mIh(f){const x=2>f.length,
N=500<f.length,ea=RegExp("[{|}|;|\\\\]").test(f);f=""===H.a.FOe(f);return!x&&!N&&!ea&&!f}sWj(f,x){let N="";if(1===f)for(let ea=0;ea<this.FNa.length;ea++)if(x[Th.aNe+ea]){N=ea===this.FNa.length-1?x[Th.jsc]:this.FNa[ea];break}this.qD(f,this.ICc,N)}Geh(f){let x="";1===f&&this.UBc&&(x=this.UBc);this.qD(f,this.ICc,x)}Npk(f){this.UBc=f;f=this.validate();this.SBc!==f&&(this.SBc=f,this.u6(CommonUIStrings.l_SensitivityJustificationTitle,Object(v.a)(this,this.Geh,"reactJustificationDialogHandler"),this.o3f(this.SBc)))}o3f(f){return{["id"]:this.ig,
["bodyControls"]:{["choiceGroupProps"]:{},["textAreaProps"]:{["placeholder"]:CommonUIStrings.l_SensitivityJustificationPlaceholder}},["actionButtonProps"]:{["label"]:CommonUIStrings.l_DialogChange,["disabled"]:!f},["infoMessage"]:CommonUIStrings.l_SensitivityJustificationMessage,["justificationIrrelevantLabel"]:CommonUIStrings.l_SensitivityJustificationNoLongerApplies,["justificationIncorrectLabel"]:CommonUIStrings.l_SensitivityJustificationIncorrect,["justificationOtherLabel"]:CommonUIStrings.l_SensitivityJustificationOther,
["onJustificationUpdated"]:Object(v.a)(this,this.Npk,"onJustificationUpdated")}}fpl(f){f.target&&this.cD(1,this.validate())}cji(){return lb.a.gC(Th.yle,J.AFrameworkApplication.qm,Xd.getImageClass(Th.vEa),CommonUIStrings.l_SensitivityJustificationMessage,this.FNa[0],this.FNa[1],this.FNa[2],CommonUIStrings.l_SensitivityJustificationPlaceholder)}mOe(){const f=document.getElementsByName(Th.KYj);for(let x=0;x<f.length;x++)pf.a.addHandler(f[x],Sb.a.focus,Object(v.a)(this,this.Rid,"radioButtonFocusHandler")),
pf.a.addHandler(f[x],Sb.a.click,Object(v.a)(this,this.Rid,"radioButtonFocusHandler"))}Rid(f){if(f=f.target){f.checked=!0;var x=$get(Th.jsc);f.id===Th.aNe+(this.FNa.length-1)?(x.disabled=!1,Sys.UI.DomElement.setVisible(x,!0),x.focus()):(x.disabled=!0,f.focus());this.cD(1,this.validate())}}static get F1(){return J.AFrameworkApplication.Aa.hb.uC&&J.AFrameworkApplication.Aa.hb.Pje}}Th.yle=vm.yle;Th.KYj="ListRadioBox";Th.aNe="radiobox";Th.jsc="txtJustification";Th.vEa="Info_32x32x32";Th.id="JustificationDialog";
Object(k.a)(Th,"JustificationDialog",lb.a,[]);class Xl extends lb.a{constructor(f,x,N){super(!1,!1,!0);if(f&&N){var ea={["id"]:"MandatoryLabellingDialog"};this.oPh=N;this.dEd=x;if(!J.AFrameworkApplication.fa.ka("MandatoryLabelingDialogLearnMoreSwitchIsEnabled")||this.dEd&&""!==this.dEd)ea.learnMoreLink={["type"]:"AppLinkProps",["id"]:"mandatoryLabellingLearnMoreLink",["text"]:CommonUIStrings.l_LearnMore,["handler"]:{["href"]:this.dEd,["target"]:"_blank"},["customTooltip"]:CommonUIStrings.L_LearnMoreTooltip};
x={["sections"]:[],["shouldAutoOpen"]:!1};Array.add(x.sections,{["id"]:"mandatoryLabellingFlyoutMenuSection",["controls"]:f});ea.labelFlyout={["type"]:"AppFlyoutAnchorProps",["id"]:"mandatoryLabellingFyout",["label"]:"Pick a label",["hideLabel"]:!1,["hideChevron"]:!1,["hideIcon"]:!0,["menuDefinition"]:x};f={["id"]:"MandatoryLabellingDialog",["bodyControls"]:ea};ea.initialLabelText=CommonUIStrings.l_MandatoryLabellingDialogInitialLabelText;ea.descriptionText=CommonUIStrings.l_MandatoryLabellingDialogDescriptionText;
this.$i(CommonUIStrings.l_MandatoryLabellingDialogBusinessBarTitle,Object(v.a)(this,this.afk,"mandatoryLabellingDialogHandler"),f)}else e.ULS.sendTraceTag(560547850,306,10,"MandatoryLabelingDialog was triggered with invalid inputs")}afk(f,x){1===f&&x.selectedLabel&&(f=x.selectedLabel,""!==f&&this.oPh(f))}}Object(k.a)(Xl,"MandatoryLabellingDialog",lb.a,[]);class Ol{constructor(){this.Vpa=!!J.AFrameworkApplication.Aa&&J.AFrameworkApplication.Aa.hb.uC}CDi(f,x,N){this.Vpa&&new Xl(f,x,N)}static get instance(){return Ol.Ka||
(Ol.Ka=new Ol)}}Ol.Ka=null;Object(k.a)(Ol,"MandatoryLabellingDialogFactory",null,[697]);class Re{}Re.qll="sbProtectForm14";Re.tll="SBStatusBarMarkAsReadOnly14";Re.WXj="Info_16x16x32";Re.rCf="QuickSearchCompletedToday_16x16x32";Re.xNe="CommonControlCheckboxCheck_16";Re.zBh="On";Re.visible="Visible";Re.NYi="ImageIsVisible";Re.XU="SourceControlId";Re.menuItemId="MenuItemId";Re.menu="Menu";Re.luf="AppLockId";Re.value="Value";Re.labelText="LabelText";Re.alt="Alt";Re.Wag="Image16by16";Re.Exb="Image16by16Class";
Re.pll="SBProtectForm_16";Re.sll="SBStatusBarMarkAsReadOnly_16";Re.icon="Icon";Re.iconColor="IconColor";Re.customTooltip="CustomTooltip";Re.PLk="MipTagDynamicFillWithOutline_20";Re.QLk="MipTagLockDynamicFillWithOutline_20";Re.OLk="MipTagErrorOutline_20";Re.RLk="MipTagQuestionOutline_20";Re.E0e="transparent";Re.Bvl="UILocation";Object(k.a)(Re,"PolicyConstants",null,[]);class qk extends lb.a{constructor(f,x,N){super(!1,!1,qk.F1);this.ICc=f;this.m2=x;this.qD=N;this.xd=1;this.ig=qk.id;this.jya(1);this.jya(0)}lXe(){const f=
{["id"]:"UserDefinedPermissionsDialog"};qk.F1&&this.$i("Defined Permissions",Object(v.a)(this,this.$Bl,"userDefinedPermissionsDialogHandler"),f)}$Bl(f){1!==f&&this.qD(f,this.ICc,"",this.m2)}static get F1(){return J.AFrameworkApplication.Aa.hb.uC&&J.AFrameworkApplication.Aa.hb.Pje}}qk.id="UserDefinedPermissionsDialog";Object(k.a)(qk,"UserDefinedPermissionsDialog",lb.a,[]);var qj=d(579),ml=d(190),vi=d(466);class zi{constructor(f,x,N,ea){this.zDd=this.ADd=null;this.edf=this.PCd=this.oDd=this.aTb=this.yef=
this.fgf=this.pyd=!1;this.Smb=this.Tza=this.LAa=this.xMa=this.m2=this.AA=this.Jha=this.xi=null;this.BOh=this.twd=0;this.Ozd=this.fef=this.p6e=null;this.Ca=f;this.Rh=x;this.$a=N;this.Ak=ea;this.YTb={};this.ejf={};this.hgf={};this.w8b=N.ka("WacApplyManualPolicyLabelIsEnabled");this.Ak.value.rOd(Object(v.a)(this,this.EKe,"processAutoSensitivityLabel"));this.Ak.value.Usf(Object(v.a)(this,this.EKe,"processAutoSensitivityLabel"));this.Ak.value.WNd(Object(v.a)(this,this.iuk,"onUpdateLabelInfo"));J.AFrameworkApplication.Aa&&
J.AFrameworkApplication.Aa.IK(Object(v.a)(this,this.bOk,"refreshDocumentPolicyLabelsOnModeChange"));N.ka("SupportsPolicies")&&N.Ha("AppliedPolicyId")&&(this.ADd=N.Ha("IrmPolicyTitle"),this.zDd=N.Ha("IrmPolicyDescription"));this.uHd=N.ka("ProtectedFile");this.SMh=this.$a.Fc("SetPolicyLabelAwaitFileExistsOnHostMaxRetries",6);this.TMh=this.$a.Fc("SetPolicyLabelAwaitFileExistsOnHostRetryDelayMs",5E3)}get jua(){return J.AFrameworkApplication.jua||!!this.fef&&this.fef()}vb(){this.Ca.ya(ba.a.tHe,Qb.a.frame,
Object(v.a)(this,this.DNf,"documentLabelPaneHandler"));this.Ca.ra(ba.a.xIb,Qb.a.frame,Object(v.a)(this,this.xIb,"queryPolicyLabel"),96);this.Ca.ya(ba.a.Xkb,Qb.a.frame,Object(v.a)(this,this.Xkb,"toggleSensitivity"));this.Ca.ya(ba.a.Ygb,Qb.a.frame,Object(v.a)(this,this.Ygb,"populateSensitivityFlyout"));this.Ca.ya(ba.a.ujb,Qb.a.frame,Object(v.a)(this,this.ujb,"setSensitivity"));this.Ca.ra(ba.a.xmc,Qb.a.frame,Object(v.a)(this,this.xmc,"querySensitivity"),96);this.Ca.ya(ba.a.Fhb,Qb.a.frame,Object(v.a)(this,
this.Fhb,"querySensitivityToggleButton"));this.Ca.ya(ba.a.Ehb,Qb.a.frame,Object(v.a)(this,this.Ehb,"querySensitivitySubFlyout"));this.sXb(ba.a.Xkb)||this.Ca.he(ba.a.Xkb,4);this.sXb(ba.a.Ygb)||this.Ca.he(ba.a.Ygb,4);this.sXb(ba.a.ujb)||this.Ca.he(ba.a.ujb,4);this.sXb(ba.a.Fhb)||this.Ca.he(ba.a.Fhb,4);this.sXb(ba.a.Ehb)||this.Ca.he(ba.a.Ehb,4);this.Rh.updateCommandUI();J.AFrameworkApplication.fa&&J.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CacheSensitivityVisibility",
!1)&&Pd.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.DelayPolicyActionRegistration")&&this.Ak.value.qTk(Object(v.a)(this,this.Tfh,"registerActionsHandler"))}Tfh(){this.vb()}SEh(){this.Ca.WO(ba.a.tHe,Qb.a.frame,Object(v.a)(this,this.DNf,"documentLabelPaneHandler"));this.Ca.WO(ba.a.xIb,Qb.a.frame,Object(v.a)(this,this.xIb,"queryPolicyLabel"));this.Ca.WO(ba.a.Xkb,Qb.a.frame,Object(v.a)(this,this.Xkb,"toggleSensitivity"));this.Ca.WO(ba.a.Ygb,Qb.a.frame,Object(v.a)(this,
this.Ygb,"populateSensitivityFlyout"));this.Ca.WO(ba.a.ujb,Qb.a.frame,Object(v.a)(this,this.ujb,"setSensitivity"));this.Ca.WO(ba.a.xmc,Qb.a.frame,Object(v.a)(this,this.xmc,"querySensitivity"));this.Ca.WO(ba.a.Fhb,Qb.a.frame,Object(v.a)(this,this.Fhb,"querySensitivityToggleButton"));this.Ca.WO(ba.a.Ehb,Qb.a.frame,Object(v.a)(this,this.Ehb,"querySensitivitySubFlyout"))}Xkb(){return 32}vXf(f){const x="mandatoryLabelling_"+f.Id;this.hgf[x]=f.Id;return{["type"]:"AppToggleButtonProps",["id"]:x,["label"]:f.DisplayName,
["hideLabel"]:!1,["customTooltip"]:f.Tooltip}}Yab(){return this.$a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UDPEnabled",!1)}fbj(){const f=[],x=this.Jha;for(let ea in x){var N=x[ea];const ma=this.AA[ea];if(ma&&ma.Enabled&&!ma.HasUserDefinedPermissions)if(N.count){const Ha={["sections"]:[],["shouldAutoOpen"]:!1},Ua={["id"]:"mandatoryLabelling_flyoutMenuSection_"+ma.Id,["controls"]:[]};for(let mb of N)(N=this.AA[mb])&&N.Enabled&&!N.HasUserDefinedPermissions&&Array.add(Ua.controls,this.vXf(N));
Array.add(Ha.sections,Ua);Array.add(f,{["type"]:"AppFlyoutAnchorProps",["id"]:"mandatoryLabelling_"+ma.Id,["label"]:ma.DisplayName,["hideLabel"]:!1,["hideChevron"]:!1,["hideIcon"]:!1,["menuDefinition"]:Ha})}else Array.add(f,this.vXf(ma))}return f}Ygb(f,x,N,ea,ma){if(1===N||!this.Ak.value.prb(!0))return 32;ma.MenuItems=Object.assign(new He.a,{Id:"SensitivityList",MenuSectionList:[],UpdateDynamically:!0});Array.add(ma.MenuItems.MenuSectionList,this.YKc(!this.isReactRibbonEnabled()));this.xi.CustomUrl&&
Array.add(ma.MenuItems.MenuSectionList,this.iDi(this.isReactRibbonEnabled()?this.xi.CustomUrl:H.a.pe(this.xi.CustomUrl)));this.isReactRibbonEnabled()||(ma.PopulationXML=Ie.l(ma.MenuItems));return 32}xmc(f,x,N,ea,ma){if(1===N||!ma||!this.w8b)return 32;this.xi=this.Ak.value.Uv;if(this.Ak.value.prb(!0)&&(ma[Re.visible]=!0,this.$a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.LabelsAvailableActivityControlEnabled",!1)?this.yef||(gd.a("MipLabelsAvailable"),this.yef=!0):gd.a("MipLabelsAvailable"),
this.$a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ClpLouderLabelTUIEnabled",!1)&&this.xi&&this.xi.AreLabelsAvailable&&(f=na.a.instance.Ja("Common.ISystemInitiatedFeedback")))){const Ha=zi.Wa(this.xi.AppliedPolicyId)?"LouderLabel_NoLabelAppliedOnLoadActivity":"LouderLabel_LabelExistsOnLoadActivity";f.execute(Ua=>{Ua.logActivity(Ha,null)})}return 32}Fhb(f,x,N,ea,ma){if(1===N||!ma)return 32;let Ha,Ua;ma[Re.zBh]=!!(Ha=ma[Re.menuItemId])&&!!(Ua=this.YTb[Ha])&&Ua===this.xi.AppliedPolicyId;return 32}Ehb(f,
x,N,ea,ma){if(1===N||!ma)return 32;let Ha,Ua,mb;f=!!(Ha=ma[Re.XU])&&!!(Ua=this.YTb[Ha])&&!!(mb=this.Jha[Ua])&&mb.contains(this.xi.AppliedPolicyId);ma[Re.NYi]=f;ma[Re.zBh]=f;return 32}ujb(f,x,N,ea,ma){if(1===N||!ma)return 32;f=this.YTb[ma[Re.XU]];x=this.Cvl(ma[Re.Bvl]);N=new ff.a;N.name="SensitivityPickerLocation";N.int64=x;gd.a("SensitivityPickerUsage",void 0,void 0,[N]);return this.IKa(f,ma,2)}eYc(){return!!J.AFrameworkApplication.Aa&&1===J.AFrameworkApplication.Aa.mode}bOk(){this.PCd&&!this.eYc()&&
(this.PCd=!1,this.Ak.value.aOk())}qsl(){this.xi.DefaultLabelId&&this.xi.MandatoryLabelingEnforced?this.pyd||this.eYc()?this.xi.AppliedPolicyId?this.z0d(""):(this.Ak.value.CRj(this.Ak.value.W$b)||this.eYc())&&this.LPf():this.hph():this.xi.DefaultLabelId?this.hph():this.xi.MandatoryLabelingEnforced&&(this.xi.AppliedPolicyId?this.z0d(""):this.LPf())}Khg(){return this.xi.MandatoryLabelingEnforced?this.xi&&this.xi.AreLabelsAvailable?this.$a.ka("TestOverrideIsReactDialogEnabled")||this.Rh&&this.Rh.hb&&
this.Rh.hb.uC?!0:(e.ULS.sendTraceTag(539109065,306,50,"Mandatory labelling not invoked b/c react dialogs disabled!"),!1):(e.ULS.sendTraceTag(539109064,306,50,"Mandatory labelling not invoked b/c there are no sensitivity labels!"),!1):(e.ULS.sendTraceTag(539109063,306,50,"Mandatory labelling not invoked b/c user did not have policy!"),!1)}LPf(){!this.Khg()||J.AFrameworkApplication.GQ||this.fgf||(this.fgf=J.AFrameworkApplication.GQ=!0,e.ULS.sendTraceTag(562837517,306,50,"Mandatory labelling is invoked successfully."),
this.Ak.value.Fdh("",1),this.Ak.value.tNd(37,CommonUIStrings.l_MandatoryLabellingDialogBusinessBarTitle,CommonUIStrings.l_MandatoryLabellingDialogDescriptionText,CommonUIStrings.l_MandatoryLabellingDialogBusinessBarButton,()=>{this.Zek()}))}z0d(f){this.Khg()&&J.AFrameworkApplication.GQ&&(J.AFrameworkApplication.GQ=!1,e.ULS.sendTraceTag(562837518,306,50,"Mandatory labelling is escaped successfully."),this.Ak.value.OOe(),this.Ak.value.Fdh(f,2))}Zek(){Ol.instance.CDi(this.fbj(),this.xi.CustomUrl,Object(v.a)(this,
this.$ek,"mandatoryLabellingDialogCallback"))}$ek(f){this.z0d(this.hgf[f])}cxf(){return this.$a.ka("CoAuthForProtectedFilesEnabled")&&this.$a.ka("SupportsOfficeClientCoauthoring")&&this.$a.ka("SetPolicyLabelAwaitFileExistsOnHostIsEnabled")&&!!this.Ozd&&this.jua}IKa(f,x,N,ea=null){this.Ak.value.mKk(N);let ma=32,Ha=!1,Ua=!0;const mb=2===N||8===N||16===N,gb=f===this.xi.AppliedPolicyId;if(this.p6e&&this.p6e(f,mb))e.ULS.sendTraceTag(42860829,306,15,"SetSensitivity : As app doesn't support changing the label, skipping SetSensitivity call. ApplyLabelFlag : {0}",
N),this.Rh.updateCommandUI();else if(x&&Re.luf in x&&this.Ak.value.PTe(x[Re.luf]),f)if(this.Ak.value.Wjg()||this.cxf()&&this.oDd)e.ULS.sendTraceTag(42796168,306,50,"Policy label cannot be set because a set policy label request is already in progress. ApplyLabelFlag: {0}",N),this.Rh.updateCommandUI(),mb&&this.mGc(CommonUIStrings.l_SensitivityApplicationDialogErrorTitle,CommonUIStrings.l_SensitivityQuickApplicationErrorMessage);else if(this.$a.ka("HasDocumentEditRights"))if(this.Ak.value.joi(f))if(!this.Yab()&&
this.AA[f]&&this.AA[f].HasUserDefinedPermissions&&!gb)e.ULS.sendTraceTag(540608323,306,50,"UDP label cannot be applied during UDP in WAC Phase 1. ApplyLabelFlag: {0}",N),1!==N&&4!==N&&this.cci();else if(mb&&this.xi.MandatoryLabelingEnforced&&gb)e.ULS.sendTraceTag(570972054,306,50,"Policy label cannot be removed due to mandatory labeling. ApplyLabelFlag: {0}",N),this.mGc(CommonUIStrings.l_MandatoryLabellingBlockLabelRemovalDialogTitle,CommonUIStrings.l_MandatoryLabellingBlockLabelRemovalDialogDescriptionText);
else{if(mb&&this.$a.ka("WacLabelingJustificationDialogIsEnabled")&&this.xi.RequiredDowngradeJustification&&(gb||this.AA[f].RequiredDowngradeJustification)&&(this.Yab()?!this.edf&&!ea:!this.m2))return e.ULS.sendTraceTag(570972055,306,50,"Downgrade justification is required. ApplyLabelFlag: {0}",N),this.KWe(f),ma;if(this.Yab()&&this.AA[f].HasUserDefinedPermissions&&!gb)return e.ULS.sendTraceTag(523019968,306,50,"UDP Label is selected. ApplyLabelFlag: {0}",N),this.lXe(f,ea),ma;if(this.cxf()&&!this.Ozd())this.twd<
this.SMh?(e.ULS.sendTraceTag(577356770,306,50,"File does not exist on host, retrying after delay. RetryCount: {0} ApplyLabelFlag: {1}",this.twd,N),this.oDd=!0,this.twd++,Je.Task.delay(this.TMh).continueWith(()=>{this.oDd=!1;this.IKa(f,x,N)})):(e.ULS.sendTraceTag(577356771,306,15,"Policy label cannot be set because maximum retries were reached checking for file existence. ApplyLabelFlag: {0}",N),Ha=1!==N,Ua=!1,ma=8);else{if(this.PPj(f)&&(e.ULS.sendTraceTag(553911752,306,15,"Policy label cannot be set because the selected label is a parent label. ApplyLabelFlag: {0}",
N),1===N||8===N||4===N))return ma;e.ULS.sendTraceTag(570972056,306,50,"SetSensitivityByPolicyId is succeeded. ApplyLabelFlag: {0}",N);this.setPolicyLabel(gb?"":f,this.Yab()?ea:this.m2,"",N);return ma}}else e.ULS.sendTraceTag(42796169,306,50,"Policy label cannot be set because the user is in a coauth session. ApplyLabelFlag: {0}",N),this.Rh.updateCommandUI(),mb&&this.mGc(CommonUIStrings.l_SensitivityApplicationDialogErrorTitle,CommonUIStrings.l_SensitivityCoauthApplicationErrorMessage);else e.ULS.sendTraceTag(558892739,
306,50,"Policy label cannot be set because the user doesn't have edit rights. ApplyLabelFlag: {0}",N),this.Rh.updateCommandUI(),mb&&this.mGc(CommonUIStrings.l_SensitivityApplicationDialogErrorTitle,CommonUIStrings.l_SensitivityNoEditRightsErrorMessage);else e.ULS.sendTraceTag(42796167,306,15,"Policy label cannot be set because the selected policy ID is null. ApplyLabelFlag: {0}",N),this.Rh.updateCommandUI(),Ha=mb,Ua=!1,ma=8;this.Ak.value.ceh(0,N,Ha,Ua);return ma}lvf(f,x,N=null,ea=!1){A.Health.instance.recordKpiUsage("MipAutoClassificationSetLabel",
0,"wordclpfc",null);this.$a.ka("SupportsOfficeClientCoauthoring")&&this.$a.ka("CoAuthForProtectedFilesIsEnabled")?(this.aTb=!1,(this.xi=this.Ak.value.Uv)&&!this.xi.AppliedPolicyId?this.aTb=!0:this.xi&&this.xi.PolicyLabelAssignmentMethod&&(this.aTb=ml.e(this.xi.PolicyLabelAssignmentMethod)===ml.e("standard"))):this.aTb=ea;f=zi.Wa(f)?null:this.AA[f];(x=zi.Wa(x)?null:this.AA[x])?this.LAa=new Wl(x,!0,N):(this.Ak.value.Kxa(29),this.Tza=null);f?this.xMa=new Wl(f,!1):this.Smb=null;this.EKe(null,null)}Jdi(f){this.IKa(f,
null,16)}D6k(){this.AA={};if(this.xi=this.Ak.value.Uv)for(const f of this.xi.SensitivityLabels)this.AA[f.Id]=f}PPj(f){if(this.Jha&&f in this.Jha){f=this.Jha[f];for(let x of f)if((f=this.AA[x])&&f.Enabled)return!0}return!1}Z7k(){this.Jha={};if(this.xi=this.Ak.value.Uv){for(const f of this.xi.SensitivityLabels)f.ParentId||(this.Jha[f.Id]=new ta.a);for(const f of this.xi.SensitivityLabels){if(this.$a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.RemoveDisabledLabelsFromChildLabel",!1)){if(!(f.ParentId&&
f.ParentId in this.Jha&&f.Enabled))continue}else if(!(f.ParentId&&f.ParentId in this.Jha))continue;this.Jha[f.ParentId].add(f.Id)}}}xHk(){if(this.$a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CacheSensitivityVisibility",!1)){this.xi=this.Ak.value.Uv;const f=this.w8b&&this.isReactRibbonEnabled()&&this.Ak.value.prb();zi.pib(f)}else this.w8b&&this.isReactRibbonEnabled()?(this.xi=this.Ak.value.Uv,this.Ak.value.prb()?(zi.pib(!0),appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("Sensitivity",
!1))):zi.pib(!1)):zi.pib(!1)}fPk(f){this.Ozd=f}hph(){if(this.$a.ka("WacApplyDefaultPolicyLabelIsEnabled"))if(this.eYc())this.PCd=!0;else if(!this.pyd)if(this.pyd=!0,this.xi=this.Ak.value.Uv,this.$a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DefaultLabelForSPODocLibEnabled",!1)){if(this.xi&&this.xi.DefaultLabelId)if(!this.xi.AppliedPolicyId)e.ULS.sendTraceTag(509732190,306,50,"Default labeling triggered. DefaultLabelType: {0}",this.xi.DefaultLabelType),this.IKa(this.xi.DefaultLabelId,null,
1);else if(r.a.jp().equals(this.xi.DefaultLabelType,"documentLibraryDefault")){const f=this.AA[this.xi.AppliedPolicyId],x=this.AA[this.xi.DefaultLabelId];this.xi.AppliedPolicyId!==this.xi.DefaultLabelId&&r.a.jp().equals(this.xi.PolicyLabelAssignmentMethod,"standard")&&f.Order<x.Order&&(e.ULS.sendTraceTag(509732189,306,50,"Default labeling triggered. DefaultLabelType: {0}",this.xi.DefaultLabelType),this.IKa(this.xi.DefaultLabelId,null,1))}}else this.xi&&this.xi.DefaultLabelId&&!this.xi.AppliedPolicyId&&
(e.ULS.sendTraceTag(593774210,306,50,"Default labeling triggered. DefaultLabel: {0}",this.xi.DefaultLabelId),this.IKa(this.xi.DefaultLabelId,null,1))}EKe(){if(!this.Ak.value.Wjg()){var f=this.AA[this.xi.AppliedPolicyId];this.aTb&&this.xMa&&this.Smb!==this.xMa.id&&(!f||f.Order<this.xMa.sensitivityLabel.Order)&&(f=this.IKa(this.xMa.id,{},4),32!==f?e.ULS.sendTraceTag(50868813,306,10,"ProcessAutoSensitivityLabel: SetSensitivityByPolicyId failed with response: "+f):(this.Smb=this.xMa.id,this.Tza&&(f=this.AA[this.Tza])&&
f.Order<=this.xMa.sensitivityLabel.Order&&(this.Ak.value.Kxa(29),this.Tza=null)));f=this.AA[this.Ak.value.Uv.AppliedPolicyId];if(this.LAa&&this.Tza!==this.LAa.id&&(!f||f.Order<this.LAa.sensitivityLabel.Order)){const x=this.LAa.id;this.Ak.value.Kxa(29);this.Ak.value.aFc(29,CommonUIStrings.l_PolicyBusinessBarTitle,String.format(CommonUIStrings.l_PolicyLabelRecommendationMessage,this.J7d(this.LAa.sensitivityLabel))+" "+this.LAa.oMk,CommonUIStrings.l_PolicyLabelRecommendationButton,()=>{this.IKa(x,{},
8)});this.Tza=this.LAa.id}this.LAa=this.xMa=null}}setPolicyLabel(f,x,N,ea=2){this.Yab()?x&&(this.edf=!0):this.m2=x;this.Ak.value.setPolicyLabel(f);this.Rh.updateCommandUI();N=new $g(ea,this.J7d(this.AA[f]));this.Ak.value.aUe(f,this.Yab()?x:this.m2,N)}Xyi(f,x,N,ea){1===f&&this.setPolicyLabel(x,ea,N)}Wyi(f,x,N){1===f?this.Yab()?this.IKa(x,null,2,N):this.setPolicyLabel(x===this.xi.AppliedPolicyId?"":x,N,""):this.Rh.updateCommandUI()}KWe(f){(new Th(f,Object(v.a)(this,this.Wyi,"continueToSetPolicyLabelFromJustificationDialog"))).KWe()}lXe(f,
x){(new qk(f,x,Object(v.a)(this,this.Xyi,"continueToSetPolicyLabelFromUDPDialog"))).lXe()}mGc(f="",x=""){const N=new Mb.StandardDialog;N.yr=J.AFrameworkApplication.tda;N.xd=0;N.Xe(1,CommonUIStrings.l_DialogClose);N.cP(f,x,null)}yhi(f){1===f&&this.Ak.value.WKk()}cci(){const f=new Mb.StandardDialog;f.yr=J.AFrameworkApplication.tda;f.xd=1;f.Xe(1,CommonUIStrings.l_OICDownLoadACopyDialogOpenButton);f.Xe(0,CommonUIStrings.l_DialogClose);f.cP(CommonUIStrings.l_SensitivityApplicationDialogErrorTitle,CommonUIStrings.l_SensitivityBlockUDPSetLabelMessage,
Object(v.a)(this,this.yhi,"blockUDPSetLabelHandler"))}isReactRibbonEnabled(){return!!this.Rh&&!!this.Rh.hb&&this.Rh.hb.Lo}izb(){return this.Rh&&this.Rh.hb?this.Rh.hb.izb:!1}DNf(){return 32}xIb(f,x,N,ea,ma){if(1===N)return 32;this.xi=this.Ak.value.Uv;if(!this.xi||!ma)return 32;ma[Re.value]="";ma[Re.labelText]="";ma[Re.alt]=null;ma[Re.Wag]=null;ma[Re.Exb]=null;ma[Re.customTooltip]="";ma[Re.visible]=!1;ma[Re.iconColor]="";N=x=f=ma[Re.icon]="";if(!this.xi.AreLabelsAvailable){if(!this.ADd)return 32;f=
this.ADd;N=Re.E0e;this.zDd&&(x=this.zDd)}else if(this.xi.AppliedPolicyId){ea=null;for(const Ha of this.xi.SensitivityLabels)if(Ha.Id.toLowerCase()===this.xi.AppliedPolicyId.toLowerCase()){ea=Ha;break}ea&&(f=this.J7d(ea),x=ea.Tooltip,this.uHd=J.AFrameworkApplication.EJ=ea.IsEndpointProtectionEnabled,N=this.KYf(ea))}this.$a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ClpLouderLabelEnabled",!1)?(f?(ma[Re.value]=f,ma[Re.labelText]=f,ma[Re.customTooltip]=x,this.Mph(N,this.uHd,ma)):this.$a.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.ClpUseOutlineImageForNoLabel")?
(ma[Re.iconColor]=Re.E0e,this.xi.MandatoryLabelingEnforced?(ma[Re.value]=ma[Re.labelText]=HeaderStrings.SelectASensitivityLabel,ma[Re.icon]=Re.OLk):(ma[Re.value]=ma[Re.labelText]=HeaderStrings.NoSensitivityLabel,ma[Re.icon]=Re.RLk)):(ma[Re.iconColor]="#000000",this.xi.MandatoryLabelingEnforced?(ma[Re.value]=ma[Re.labelText]=HeaderStrings.SelectASensitivityLabel,ma[Re.icon]="MipTagErrorDynamicColor_20"):(ma[Re.value]=ma[Re.labelText]=HeaderStrings.NoSensitivityLabel,ma[Re.icon]="MipTagQuestionDynamicColor_20")),
ma[Re.visible]=!0):f&&(ma[Re.value]=f,ma[Re.labelText]=f,this.izb()?ma[Re.customTooltip]=x:ma[Re.alt]=x,this.Mph(N,this.uHd,ma),ma[Re.visible]=!0);return 32}J7d(f){return f?this.AA?f.ParentId&&this.AA[f.ParentId]?this.AA[f.ParentId].DisplayName+"\\"+f.DisplayName:f.DisplayName:(e.ULS.sendTraceTag(4282E4,306,15,"Policy ID to Sensitivity label dictionary has not been initialized."),f.DisplayName):""}Mph(f,x,N){this.$a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ClpLouderLabelEnabled",!1)?(N[Re.icon]=
this.w5f(x),N[Re.iconColor]=this.x5f(f)):this.izb()?N[Re.icon]=x?Re.pll:Re.sll:(N[Re.Wag]=J.AFrameworkApplication.qm,N[Re.Exb]=x?Xd.getImageClass(Re.qll):Xd.getImageClass(Re.tll))}iDi(f){const x=this.Lt("LearnMoreSection",!0);f=Object.assign(new xk.a,{Id:"SensitivityLearnMore",ExternalId:"SensitivityLearnMore",MenuItemId:f,LabelText:CommonUIStrings.l_LearnMore,Command:"1959943459",Image16by16:J.AFrameworkApplication.qm,Image16by16Class:Xd.getImageClass(Re.WXj),Visible:!0,Alt:CommonUIStrings.L_LearnMoreTooltip,
KeyTip:"L"});Array.add(x.ControlList,f);return x}oJf(f,x,N=!1){let ea;ea="Toggle_"+f.Id;ea="Sensitivity_"+ea;const ma=f.DisplayName,Ha=f.Tooltip;var Ua=f.Id===this.xi.AppliedPolicyId,mb=N?H.a.pe(ea):ea;this.$a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ClpLouderLabelEnabled",!1)?(Ua=this.KYf(f),x=Object.assign(new aa.a,{Id:mb,ExternalId:mb,LabelText:N?H.a.pe(ma):ma,Command:"2935633379",MenuItemId:mb,QueryCommand:"991261903",Visible:!0,Alt:N?H.a.pe(Ha):Ha,AriaLabel:Xa.a.rrb,IconColor:this.x5f(Ua),
KeyTip:x}),x.ExternalImageId=this.w5f(f.IsEndpointProtectionEnabled)):(mb=Object.assign(new qj.a,{Id:mb,ExternalId:mb,LabelText:N?H.a.pe(ma):ma,Command:"2935633379",MenuItemId:mb,QueryCommand:"991261903",CheckedImage:J.AFrameworkApplication.qm,Visible:!0,Alt:N?H.a.pe(Ha):Ha,IsChecked:Ua,AriaLabel:Xa.a.rrb,KeyTip:x}),this.isReactRibbonEnabled()?(mb.CheckedImageClass=Xd.getImageClass(Re.xNe),mb.ExternalImageId=Re.xNe):mb.CheckedImageClass=Xd.getImageClass(Re.rCf),x=mb);mb=ea;this.YTb[mb]=f.Id;this.ejf[f.Id]=
mb;return x}Lt(f,x=!1){return Object.assign(new bg.a,{Title:"",Id:f,DisplayMode:Re.menu,ShowMenuSectionSeparator:x,ControlsId:"Ctrl_"+f,ControlList:[]})}iGi(f,x,N,ea){f=zi.xih()?this.Lt(f+"Sub"):this.Lt(x+"Sub");x=1;for(let ma of N)(N=this.AA[ma])&&N.Enabled&&(Array.add(f.ControlList,this.oJf(N,x.toString(),ea)),x++);return f}YKc(f=!1){const x=this.Lt("SensitivitySection");let N=1;const ea=this.Jha;for(let Ha in ea){const Ua=ea[Ha],mb=this.AA[Ha];if(mb&&mb.Enabled){if(Ua.count){const gb="Sensitivity_"+
mb.Name;var ma=f?H.a.pe(gb):gb;ma=zi.xih()?"Label"+this.BOh++:ma;const Cb=Object.assign(new $d.a,{Id:ma,ExternalId:ma,LabelText:f?H.a.pe(mb.DisplayName):mb.DisplayName,Command:"798637440",QueryCommand:"2875864574",Menu:Object.assign(new He.a,{Title:"",MenuSectionList:[],UpdateDynamically:!0}),ImageIsVisible:!1,Toggled:!1,ImageUsesSpaceWhileInvisible:!0,AriaLabel:Xa.a.rrb,KeyTip:N.toString(),Alt:f?H.a.pe(mb.Tooltip):mb.Tooltip});this.isReactRibbonEnabled()?Cb.ExternalImageId=Re.xNe:(Cb.Image16by16=
J.AFrameworkApplication.qm,Cb.Image16by16Class=Xd.getImageClass(Re.rCf));Array.add(Cb.Menu.MenuSectionList,this.iGi(ma,gb,Ua,f));Array.add(x.ControlList,Cb);this.YTb[Cb.Id]=mb.Id;this.ejf[mb.Id]=Cb.Id}else Array.add(x.ControlList,this.oJf(mb,N.toString(),f));N++}}return x}sXb(f){return!!this.Ca.$S(f)&&!!this.Ca.$S(f).flags&&!!this.Ca.$S(f).flags.length}iuk(f,x){x.onSuccess&&this.AA&&(f=this.AA[this.Ak.value.Uv.AppliedPolicyId])&&(this.Tza&&(x=this.AA[this.Tza])&&x.Order<=f.Order&&(this.Ak.value.Kxa(29),
this.Tza=null),this.Smb&&this.Smb!==f.Id&&(this.Ak.value.Kxa(28),this.Smb=null))}w5f(f){return f?Re.QLk:Re.PLk}x5f(f){return f?f:Re.E0e}KYf(f){if(f.Color||!f.ParentId)return f.Color;const x=this.AA[f.ParentId];return x?x.Color:f.Color}Cvl(f){switch(f){case 2:case 14:case 15:return 1;case 21:return 2;default:return 0}}static xih(){if(null!=zi.fCc)return zi.fCc;J.AFrameworkApplication.PFa("ce2ai523-t;6f627846-c");zi.fCc=J.AFrameworkApplication.fa?J.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.RenameCLPControlIds",
!1):!1;return zi.fCc}static pib(f){J.AFrameworkApplication.fa&&J.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GeneralizedRibbonTTVRReporting",!1)||(f?(vi.a.L$("ribbon","sensitivity"),vi.a.J$("ribbon","sensitivity")):vi.a.K$("ribbon","sensitivity"));J.AFrameworkApplication.fa&&J.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CacheSensitivityVisibility",!1)&&Pd.c()&&appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("Sensitivity",
!f))}static Wa(f){return f&&f.length?!1:!0}}zi.fCc=null;Object(k.a)(zi,"PolicyActor",null,[673]);var pp=d(1189),Xh;(function(f){f[f.unknown=0]="unknown";f[f.boot=1]="boot";f[f.refresh=2]="refresh";f[f.selfSetPolicyLabel=3]="selfSetPolicyLabel"})(Xh||(Xh={}));Object(k.b)("GetPolicyLabelsReason",Xh);class Yl extends Sys.EventArgs{constructor(f,x,N,ea,ma,Ha){super();this.Zrb=f;this.title=x;this.message=N;this.buttonText=ea;this.jZb=ma;this.LZc=Ha}}Object(k.a)(Yl,"AddAutoPolicyBusinessBarEntryEventArgs",
Sys.EventArgs,[]);class Kp extends Sys.EventArgs{constructor(f,x,N,ea,ma){super();this.Zrb=f;this.title=x;this.message=N;this.buttonText=ea;this.jZb=ma}}Object(k.a)(Kp,"AddMandatoryLabellingBusinessBarEntryEventArgs",Sys.EventArgs,[]);var al;(function(f){f[f.none=0]="none";f[f.reasonDefaultLabel=1]="reasonDefaultLabel";f[f.reasonManual=2]="reasonManual";f[f.reasonAutomatic=4]="reasonAutomatic";f[f.reasonRecommended=8]="reasonRecommended";f[f.reasonMandatory=16]="reasonMandatory"})(al||(al={}));Object(k.b)("ApplyLabelFlags",
al);class bj extends Sys.EventArgs{constructor(f,x,N){super();this.jEf=f;this.iEf=x;this.existingLabelPriority=N}}Object(k.a)(bj,"AutoCLPSecurityNodesEventArgs",Sys.EventArgs,[]);class Pl extends Sys.EventArgs{constructor(){super()}}Object(k.a)(Pl,"GetPolicyLabelEventArgs",Sys.EventArgs,[]);class bl extends Sys.EventArgs{constructor(){super()}}Object(k.a)(bl,"GetPolicyLabelFailureEventArgs",Sys.EventArgs,[]);class Wo{constructor(){this.AreLabelsAvailable=!1;this.AppliedPolicyId=null;this.MandatoryLabelingEnforced=
this.RequiredDowngradeJustification=!1;this.SensitivityLabels=this.PolicyLabelVersionToken=this.PolicyLabelAssignmentMethod=this.CustomUrl=this.DefaultLabelType=this.DefaultLabelId=null;this.AreLabelsAvailable=!1;this.AppliedPolicyId="";this.RequiredDowngradeJustification=!1;this.PolicyLabelVersionToken=this.PolicyLabelAssignmentMethod=this.DefaultLabelType=this.DefaultLabelId="";this.SensitivityLabels=[];this.MandatoryLabelingEnforced=!1;this.CustomUrl=""}}Object(k.a)(Wo,"GetPolicyLabelsData",null,
[]);class rn extends Sys.EventArgs{constructor(f=!1){super();this.onSuccess=f}}Object(k.a)(rn,"LabelInfoUpdateEventArgs",Sys.EventArgs,[]);class Xm extends Sys.EventArgs{constructor(f,x){super();this.mXg=f;this.iPd=x}}Object(k.a)(Xm,"MandatoryLabellingAppHandlerEventArgs",Sys.EventArgs,[]);class ho extends Sys.EventArgs{constructor(f,x,N,ea){super();this.title=f;this.tAk=x;this.buttonText=N;this.Amk=ea}}Object(k.a)(ho,"PolicyTipEventArgs",Sys.EventArgs,[]);class li extends Sys.EventArgs{constructor(f,
x){super();this.Zrb=f;this.LZc=x}}Object(k.a)(li,"RemoveAutoPolicyBusinessBarEntryEventArgs",Sys.EventArgs,[]);class xe extends Sys.EventArgs{constructor(){super()}}Object(k.a)(xe,"RemoveMandatoryLabellingBusinessBarEntryEventArgs",Sys.EventArgs,[]);class sn extends Sys.EventArgs{constructor(f,x){super();this.x$g=f;this.G7=x}}Object(k.a)(sn,"SetPolicyLabelEventArgs",Sys.EventArgs,[]);class qc extends Sys.EventArgs{constructor(f,x,N,ea=null,ma=null,Ha=null,Ua=null){super();this.errorType=f;this.wgl=
N;this.title=ea;this.message=ma;this.buttonText=Ha;this.jZb=Ua}}Object(k.a)(qc,"SetPolicyLabelFailureEventArgs",Sys.EventArgs,[]);class Nk extends Sys.EventArgs{constructor(){super()}}Object(k.a)(Nk,"SetPolicyLabelTriggeredEventArgs",Sys.EventArgs,[]);class In extends Sys.EventArgs{constructor(f){super();this.Xcl=f}}Object(k.a)(In,"UDPLabelingAppHandlerEventArgs",Sys.EventArgs,[]);var Zl=d(684),Lj=d(448);class Se{static V5k(f,x){if(!f||!x||f.count!==x.count)return!1;for(let N of f)if(!x.contains(N))return!1;
return!0}static toArray(f){if(!f)return null;const x=Array(f.count);let N=0;for(let ea of f)x[N]=ea,N++;return x}}Object(k.a)(Se,"HashSetUtils",null,[]);var cj=d(771);class io{constructor(f,x,N,ea=0,ma=null){this.lyd=this.J9e=null;this.LOa=this.aSb=this.bSb=0;this.Jga="";this.A4a=this.xef=this.jwd=this.UBd=this.Eza=this.sEd=null;this.gdf=!1;this.L1a=null;this.aBd=0;this.yBc=this.D4a=this.K2a=this.xBc=null;this.Oa=new hl.a;this.spc=this.h5b=this.pS=null;this.QBd=!1;this.W$b=null;this.$a=f;this.ei=
x;this.Xh=N;this.cAc=ea;this.Uv=new Wo;this.djf=this.$a.Ha("PolicyHandlerEndpointName")||"PolicyHandler.ashx";this.oG=ma;this.w8b=f.ka("WacApplyManualPolicyLabelIsEnabled");this.F8b=f.ka("CoAuthForProtectedFilesIsEnabled");this.ukb=f.ka("SupportsOfficeClientCoauthoring");this.CSj=!1;this.g8k=3E4;this.Wd=lf.a.instance;f.ka("SupportsPolicies")&&gd.a("MipSupportsPolicies");this.F8b&&this.ukb&&gd.a("MipSupportsOfficeClientCoauthoring")}get che(){return this.QBd}k$h(f){this.Oa.addHandler("PolicyTipEvent",
f)}WNd(f){this.Oa.addHandler("LabelInfoUpdateEvent",f)}qTk(f){this.Oa.removeHandler("LabelInfoUpdateEvent",f)}rOd(f){this.Oa.addHandler("SetPolicyLabelEventKey",f)}qih(f){this.Oa.removeHandler("SetPolicyLabelEventKey",f)}Usf(f){this.Oa.addHandler("SetPolicyLabelFailureEventKey",f)}o8h(f){this.Oa.addHandler("GetAutoPolicyLabelEventKey",f);this.che&&(e.ULS.sendTraceTag(51668058,306,15,"GetAutoPolicyLabelHandler was registered after the AutoPolicyLabelHandlerEvent was raised"),this.iNe(new Pl(0)))}Z7h(f){this.Oa.addHandler("CreateAutoCLPSecurityNodesEventKey",
f)}xai(f){this.Oa.addHandler("UpdateAutoCLPLabelPriorityNodeEventKey",f)}yai(f){this.Oa.addHandler("UpdateAutoCLPSITNodesEventKey",f)}D7h(f){this.Oa.addHandler("AddAutoPolicyBusinessBarEntryEventKey",f)}x$h(f){this.Oa.addHandler("RemoveAutoPolicyBusinessBarEntryEventKey",f)}E7h(f){this.Oa.addHandler("AddMandatoryLabellingBusinessBarEntryEventKey",f)}y$h(f){this.Oa.addHandler("RemoveMandatoryLabellingBusinessBarEntryEventKey",f)}I8h(f){this.Oa.addHandler("MandatoryLabellingAppHandlerEventKey",f)}uai(f){this.Oa.addHandler("UDPLabelingAppHandlerEventKey",
f)}get cLj(){if(!this.J9e)return!1;for(const f of this.J9e.T3d())if(!f.Capabilities||!f.Capabilities.SupportsClientIsMipTrusted)return!1;return!0}get Ajg(){return!!this.pS}OBj(f){f&&this.F8b&&this.ukb&&f.execute(Object(v.a)(this,this.OQd,"awaitRtc"))}KPk(f){this.UBd=f}yqi(){return this.UBd?this.UBd():!1}AOk(f){this.jwd=f}zF(){return(new Date).getTime()}OQd(f){if(!this.Ajg){var x=f.fM.task;x.continueWith(()=>{this.pS=x.result;this.pS.FBa(Object(v.a)(this,this.Tpk,"onLabelChangeUpdateOverRtc"))})}}Tpk(f,
x){12===x.type&&(this.xef?this.xef():this.qSa(this.Jga,2,this.Eza,!0))}WZf(){this.Xh&&(this.xBc=this.Xh.Ci("WebServiceCall","Call Get Policy Endpoint On Server"));var f=cj.a.vCa(1,1);this.$a.ka("SendHostAttributionInfoForPolicyLabelEnabled")?(f=new Zl.a(this.Cwb("datalosspolicy"),1,null,null,!0,2,null,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,f),this.ei.send(f).kJb(Object(v.a)(this,this.h2g,"onDataLossPolicySuccessCallback"),Object(v.a)(this,this.g2g,"onDataLossPolicyFailureCallback"))):
this.ei.Aj(this.Cwb("datalosspolicy"),1,null,null,!0,2,Object(v.a)(this,this.h2g,"onDataLossPolicySuccessCallback"),Object(v.a)(this,this.g2g,"onDataLossPolicyFailureCallback"),null);this.bSb++;e.ULS.sendTraceTag(25565151,306,50,"Policy request is sent to server. The endpoint used is {0}. Policy call times: {1}.",this.djf,this.bSb)}aOk(){this.qSa(this.Jga,2,this.Eza)}qSa(f,x=0,N=null,ea=!1){A.Health.instance.recordKpiUsage("MipGetPolicyLabel",0,"officewebclp",this.t5d(void 0,x));this.h5b=this.zF();
const ma=this.wWd(x);this.tRc(f,ma,N,ea,x);this.ZPe(!0)}h2g(f){this.w$g();let x="";({data:x}=this.m1e(f)).returnValue&&(e.ULS.sendTraceTag(25565153,306,50,"Request to get DataLossPrevention policy succeeded."),this.bSb=0,this.Xh&&(this.yBc=this.Xh.Ci("Task","Parse and Handle Get Policy Response")),this.zxk(x),this.yBc&&(this.yBc.stop(),this.yBc=null))}g2g(f){this.w$g();this.bSb<=this.cAc?this.WZf():(e.ULS.sendTraceTag(25565154,306,15,"Request to get DataLossPrevention policy failed with error response: {0}.",
f?f.data?f.data.RJb:null:null),this.bSb=0)}Wjg(){return 0<this.LOa}setPolicyLabel(f){this.Uv.AppliedPolicyId=f}aUe(f,x,N=null){const ea=this.RCi(N);this.f8k(f,x,ea,N)}t5g(f){this.D4a&&(this.D4a.stop(),this.D4a=null);let x,N;({Nnh:x,oqh:N}=this.e4f(f));const ea=f.data.state,ma=ea?ea.G7:2;let Ha="";({data:Ha}=this.m1e(f)).returnValue?(e.ULS.sendTraceTag(41799707,306,50,"Request to set label policy data succeeded. ApplyLabelFlag: {0}",ma),this.LOa=0,this.fyk(Ha,x,N,ea)):this.WQe(ma)}mKk(f){A.Health.instance.recordKpiUsage("MipSetPolicyLabel",
0,"officewebclp",this.t5d(f));this.spc=this.zF();e.ULS.sendTraceTag(575947405,306,50,"Raising set policy label triggered event.");this.Oa.raiseEvent("SetPolicyLabelTriggeredEventKey",new Nk(f))}nkk(){this.F8b&&this.ukb&&this.Ajg&&this.pS.Lfa(12,null,!0)}s5g(f){this.D4a&&(this.D4a.stop(),this.D4a=null);let x;({Nnh:N,oqh:x}=this.e4f(f));if(this.LOa<=this.cAc)this.aUe(N,x);else{var N=(N=f.data.state)?N.G7:2;e.ULS.sendTraceTag(41799708,306,15,"Request to set label policy failed with error response: {0}. ApplyLabelFlag: {1}",
f?f.data?f.data.RJb:null:null,N);this.W$b="WACServerConnectionFailed";this.LOa=0;this.WQe(N)}}CRj(f){if(f&&("LabelNotSupported"===f||"LabelErrorRetryLater"===f||"CoherencyFailure"===f||"LabelIdNotFound"===f||"LabelDisabled"===f))return e.ULS.sendTraceTag(539103556,306,50,"LabelError is retriable: {0}",f),!0;e.ULS.sendTraceTag(539103557,306,50,"LabelError is not retriable: {0}",f);return!1}joi(f){if(!f)return!1;let x=null,N=null;for(const ea of this.Uv.SensitivityLabels)ea.Id===f&&(x=ea),ea.Id===this.Jga&&
(N=ea);if(!x)return!1;if(this.F8b&&this.ukb){if(this.jwd&&this.jwd()||this.cLj)return!0}else if(J.AFrameworkApplication.LA&&J.AFrameworkApplication.LA.ADa||this.Eza&&this.Eza())return!0;return x.IsEndpointProtectionEnabled===(!!N&&N.IsEndpointProtectionEnabled)}aFc(f,x,N,ea,ma){28===f?this.qdh(new Yl(f,x,N,ea,ma,!1)):this.qdh(new Yl(f,x,N,ea,ma,!0))}Kxa(f){28===f?this.Tdh(new li(f,!1)):this.Tdh(new li(f,!0))}JIk(f,x,N){e.ULS.sendTraceTag(545280777,306,50,"Raising a CreateAutoCLPSecurityNodes event.");
this.Oa.raiseEvent("CreateAutoCLPSecurityNodesEventKey",new bj(f,x,N))}ZKk(f){e.ULS.sendTraceTag(545280778,306,50,"Raising a UpdateAutoCLPLabelPriorityNode event.");this.Oa.raiseEvent("UpdateAutoCLPLabelPriorityNodeEventKey",new bj(null,null,f))}$Kk(f,x){e.ULS.sendTraceTag(545280779,306,50,"Raising a UpdateAutoCLPSITNodes event.");this.Oa.raiseEvent("UpdateAutoCLPSITNodesEventKey",new bj(f,x,null))}Fdh(f,x){e.ULS.sendTraceTag(572650527,306,50,"Raising a mandatory labelling"+(1===x?"Reading":"Edit")+
" switch event.");this.Oa.raiseEvent("MandatoryLabellingAppHandlerEventKey",new Xm(f,x))}tNd(f,x,N,ea,ma){37===f&&this.nIk(new Kp(37,x,N,ea,ma))}OOe(){this.XJk(new xe)}WKk(){e.ULS.sendTraceTag(540608322,306,50,"Raising a UDP labeling event.");this.Oa.raiseEvent("UDPLabelingAppHandlerEventKey",new In(!0))}prb(f=!1){const x=!!this.Uv&&this.Uv.AreLabelsAvailable&&!!this.Uv.SensitivityLabels&&0<this.Uv.SensitivityLabels.length&&ij.a.any(this.Uv.SensitivityLabels,N=>!!N&&N.Enabled);x||f||zi.pib(!1);return x}n3g(f){this.K2a&&
(this.K2a.stop(),this.K2a=null);var x="";this.ZPe(!1);({data:x}=this.m1e(f)).returnValue?(e.ULS.sendTraceTag(34996493,306,50,"Request to get label policy data succeeded."),this.aSb=0,x=this.Qxk(x),f=this.Q2f(f.data),A.Health.instance.recordKpiSuccess("MipGetPolicyLabel",this.mQc(void 0,f,this.h5b)),this.h5b=null,f=new Pl(f),this.bJk(f),this.$a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AutoCLPV2Transition",!1)?x&&this.zbl()?this.che?this.kxl():(this.$a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSecurityNodesAfterLicenseCheck",
!1)||this.yKc(),this.iNe(f),this.QBd=!0):x||this.fjd():!this.che&&x&&this.$a.ka("WacApplyManualPolicyLabelIsEnabled")&&this.Rvf()?(this.iNe(f),this.QBd=!0):x||this.fjd()):this.fjd()}zbl(){if(!this.$a.ka("WacApplyManualPolicyLabelIsEnabled"))return e.ULS.sendTraceTag(539877667,306,50,"ShouldAutoClassificationRun returned false - Manual Labeling is not enabled"),!1;if(!this.Rvf())return!1;if(""===this.Jga)return e.ULS.sendTraceTag(539877696,306,50,"ShouldAutoClassificationRun returned true - document is not labeled"),
!0;if(this.L1a===this.aBd)return e.ULS.sendTraceTag(539877697,306,50,"ShouldAutoClassificationRun returned false - Applied label already has the highest priority"),!1;e.ULS.sendTraceTag(539877698,306,50,"ShouldAutoClassificationRun returned true - document is labeled but not with the highest priority label");return!0}yKc(){this.rFh();e.ULS.sendTraceTag(545104324,306,50,"Creating AutoCLP Security nodes. HasSITs: {0}, LabelPriority: {1}",0<this.A4a.count,this.L1a);const f=Se.toArray(this.A4a);this.JIk(f,
f,this.L1a)}kxl(){var f=this.A4a;this.rFh();Se.V5k(f,this.A4a)||(e.ULS.sendTraceTag(545104325,306,50,"Updating AutoCLP SIT nodes. HasSITs: {0}",0<this.A4a.count),f=Se.toArray(this.A4a),this.$Kk(f,f));this.gdf&&(e.ULS.sendTraceTag(545104326,306,50,"Updating AutoCLP Label Priority node. LabelPriority: {0}",this.L1a),this.ZKk(this.L1a))}rFh(){const f=new pp.a(r.a.jp());for(const x of this.Uv.SensitivityLabels)if(x&&x.AutoLabelingSensitiveTypeIds&&0<x.AutoLabelingSensitiveTypeIds.length)for(const N of x.AutoLabelingSensitiveTypeIds)N&&
f.add(N);this.A4a=f}m3g(f){const x=this.Q2f(f.data);A.Health.instance.recordKpiFailure("MipGetPolicyLabel","GetPolicyLabelsFailure",!1,!1,this.mQc(void 0,x,this.h5b));this.h5b=null;this.K2a&&(this.K2a.stop(),this.K2a=null);if(this.aSb<=this.cAc){if(this.$a.ka("SendHostAttributionInfoForPolicyLabelEnabled")){const N=f.data.request.get_headers();if("HostAttributionInfo.ScenarioParamName"in N&&N[cj.a.URe]&&"HostAttributionInfo.ScenarioTypeParamName"in N&&N[cj.a.VRe]){f.data.request.get_headers();f.data.request.get_headers();
f=this.wWd(x);this.tRc(this.Jga,f,this.Eza,void 0,x);return}}this.qSa(this.Jga,x,this.Eza)}else e.ULS.sendTraceTag(34996494,306,15,"Request to get label policy failed with error response: {0}.",f?f.data?f.data.RJb:null:null),this.fjd(),this.aSb=0,this.ZPe(!1)}Q2f(f){return f.state?f.state:0}Cwb(f,x=!1){let N=String.format("{0}{1}?action={2}&{3}",this.$a.Ha("PolicyHandlerWebServiceBase")||J.AFrameworkApplication.Aa.hb.Vma,this.djf,f,J.AFrameworkApplication.jh);"setpolicylabel"===f&&J.AFrameworkApplication.LA&&
J.AFrameworkApplication.LA.die&&(N=u.a.Wi(N,"sl","1"));x&&(N=u.a.Wi(N,"cbd","1"));return N}e4f(f){let x,N;x=N=null;f&&f.data&&f.data.request&&f.data.request.get_headers()&&(x=f.data.request.get_headers()[Lj.a.Onh],N=f.data.request.get_headers()[Lj.a.pqh]);return{Nnh:x,oqh:N}}m1e(f){f=f?f.data?f.data.Zd:null:null;return f&&f.length&&!this.ySj(f)?{returnValue:!0,data:f}:(e.ULS.sendTraceTag(25565152,306,10,"No response data from policy endpoint."),{returnValue:!1,data:f})}zxk(f){let x;try{x=R.b(f)}catch(N){e.ULS.sendTraceTag(37880331,
306,10,"Error when deserializing DataLossPrevention response.");return}if(x)if(x.IsPolicyTipAvailable)switch(x.IsPolicyTipAvailable.toLowerCase()){case "false":e.ULS.sendTraceTag(26007261,306,50,"policyData.IsPolicyTipAvailable is false so DLP policy tip is not present.");break;case "true":e.ULS.sendTraceTag(25565186,306,50,"DLP Policy is enabled on this document.");this.lyd=x.NavigateUrl;this.Ogl(x.GeneralText,Object(v.a)(this,this.xnk,"onDataLossPolicyOverrideButtonClick"));break;default:e.ULS.sendTraceTag(26007262,
306,10,"policyData.IsPolicyTipAvailable is expected to be 'true' or 'false' but it is {0}",x.IsPolicyTipAvailable)}else e.ULS.sendTraceTag(26007260,306,10,"policyData.IsPolicyTipAvailable is null or empty whereas it should be 'true' or 'false'.");else e.ULS.sendTraceTag(25565185,306,10,"policyData is null after deserializing DataLossPrevention response.")}Lzi(f){switch(f){case "CoherencyFailure":return 1;case "DisabledByPolicy":return 2;case "FileCheckedOut":return 3;case "FileEncrypted":return 4;
case "FileLocked":return 5;case "FileNotSupported":return 6;case "FileTooLarge":return 7;case "InvalidOperationOnZeroByteFile":return 8;case "LabelDisabled":return 9;case "LabelErrorRetryLater":return 10;case "LabelIdNotFound":return 11;case "LabelIrmDisabledByTenant":return 12;case "LabelNotSupported":return 13;case "MinorVersionLimitExceeded":return 15;default:return 0}}fyk(f,x,N,ea){var ma=ea?ea.G7:2;let Ha=0,Ua="",mb;if(({kv:mb}=R.d(f)).returnValue)if(mb){Ua="Success";f=this.wWd(3);if(mb.IsSuccessful){A.Health.instance.recordKpiSuccess("MipSetPolicyLabel",
this.mQc(ma,void 0,this.spc));this.W$b=this.spc=null;e.ULS.sendTraceTag(51233632,306,50,"setPolicyLabel was successful as seen after deserializing set policy label data response. ApplyLabelFlag: {0}",ma);2===ma&&this.Kxa(29);this.a9k(x,ma);this.nkk();this.Kxa(28);ea&&4===ma&&this.aFc(28,CommonUIStrings.l_PolicyBusinessBarTitle,String.format(CommonUIStrings.l_PolicyLabelAutomaticallyAppliedMessage,ea.displayName),CommonUIStrings.l_DialogOk,()=>{});gd.a("MipAppliedLabels",void 0,void 0,[Object.assign(new ff.a,
{name:"SetPolicyLabelApplyFlag",string:al[ma]})]);this.tRc(x,f,this.Eza,void 0,3);return}e.ULS.sendTraceTag(51233631,306,10,"setPolicyLabel was unsuccessful as seen after deserializing set policy label data response. ApplyLabelFlag: {0}, FailureReason: {1}",ma,mb.FailureReason);this.W$b=mb.FailureReason;this.$a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ImproveSetLabelFailureErrMsg",!1)?Ha=this.Lzi(mb.FailureReason):"FileTooLarge"===mb.FailureReason?Ha=7:"LabelNotSupported"===mb.FailureReason?
Ha=13:"LabelDisabled"===mb.FailureReason?Ha=9:"MinorVersionLimitExceeded"===mb.FailureReason&&(Ha=15);this.CSj&&0<=mb.FailureReason.indexOf("InvalidOperationOnZeroByteFile")&&(ea=new cd.a(2,1,this.g8k,()=>{e.ULS.sendTraceTag(575428443,306,15,"Retring SetPolicyLabelRequestAsync as previous called failed due to zero byte. Attempt number : {0}",this.LOa);this.LOa<=this.cAc&&this.aUe(x,N)}),this.Wd.Eb(ea));this.F8b&&this.ukb&&this.tRc(this.Uv.AppliedPolicyId,f,this.Eza,!0,3)}else Ua="setPolicyLabelData null.",
e.ULS.sendTraceTag(42467541,306,10,"setPolicyLabelData is null after deserializing set policy label data response. ApplyLabelFlag: {0}",ma);else Ua="TryDeserialize failed.",e.ULS.sendTraceTag(41799709,306,10,"Error when deserializing set policy label data response. ApplyLabelFlag: {0}",ma);this.WQe(ma,Ha);ma=this.mQc(ma,void 0,this.spc);this.spc=null;ma.extendedProperties.set("SetPolicyLabelDataFailureReason",this.W$b);ma.extendedProperties.set("SetPolicyLabelDataParseStatus",Ua.toString());A.Health.instance.recordKpiFailure("MipSetPolicyLabel",
"SetPolicyLabelFailure",!1,!1,ma)}WQe(f,x=0){const N=2===f||8===f||16===f;this.setPolicyLabel(this.Jga);this.Ddh(new rn);this.ceh(x,f,N,!1)}a9k(f,x){this.setPolicyLabel(this.Jga=f);if(""===f)J.AFrameworkApplication.EJ=!1,J.AFrameworkApplication.y2b=!1;else for(const N of this.Uv.SensitivityLabels)if(N.Id===f){J.AFrameworkApplication.EJ=N.IsEndpointProtectionEnabled;break}this.lKk(new sn(f,x))}Vyl(){for(const f of this.Uv.SensitivityLabels)f&&f.Enabled&&(f.Id===this.Jga&&(this.gdf=this.L1a!==f.Order,
this.L1a=f.Order),f.Order>this.aBd&&(this.aBd=f.Order))}Qxk(f){if(!({kv:f}=R.d(f)).returnValue)return e.ULS.sendTraceTag(34996495,306,10,"Error when deserializing label policy data response."),!1;if(!f)return e.ULS.sendTraceTag(42467542,306,10,"policyData is null after deserializing label policy data response."),!1;if(!f.AreLabelsAvailable)return!1;this.Uv=f;this.Jga=f.AppliedPolicyId;this.$a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AutoCLPV2Transition",!1)&&this.Vyl();this.prb()&&e.ULS.sendTraceTag(51197846,
306,50,"Labels are available for display after GetPolicyLabels call.");this.Ddh(new rn(!0));return!0}Rvf(){if(!this.prb())return e.ULS.sendTraceTag(539877699,306,50,"AreAutoLabelingSensitiveTypesAvailable returned false - No labels to display"),!1;for(const f of this.Uv.SensitivityLabels)if(f&&f.AutoLabelingSensitiveTypeIds&&0<f.AutoLabelingSensitiveTypeIds.length)return!0;e.ULS.sendTraceTag(539877700,306,50,"AreAutoLabelingSensitiveTypesAvailable returned false - No labels with AutoClp SIT");return!1}Ddh(f){e.ULS.sendTraceTag(35393610,
306,50,"Raising label info update event.");this.Oa.raiseEvent("LabelInfoUpdateEvent",f)}bJk(f){e.ULS.sendTraceTag(50676305,306,50,"Raising get policy label event.");this.Oa.raiseEvent("GetPolicyLabelEventKey",f)}fjd(){zi.pib(!1);this.Oa.raiseEvent("GetPolicyLabelFailureEventKey",new bl)}iNe(f){this.oG&&this.oG.execute(x=>{x=[x.isFeatureEnabled("MsoClpSpTwo",!0),x.isFeatureEnabled("MsoDrmPremiumSpTwo",!0)];Promise.all(x).then(N=>{ij.a.any(N,ea=>ea)&&(e.ULS.sendTraceTag(50944077,306,50,"Raising get auto policy label event."),
this.Oa.raiseEvent("GetAutoPolicyLabelEventKey",f),this.$a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSecurityNodesAfterLicenseCheck",!1)&&this.yKc(),gd.a("MipAutoClassificationEnabled"));return null})})}t5d(f=null,x=null){const N=new Map;N.set("ClpCoauth",this.ukb.toString());null!=f&&N.set("ApplyLabelFlags",al[f]);null!=x&&N.set("GetPolicyLabelsReason",Xh[x]);return N}mQc(f=null,x=null,N=null){const ea=new Ea.a;ea.extendedProperties=this.t5d(f,x);null!=N&&(ea.durationMs=this.zF()-
N);return ea}lKk(f){e.ULS.sendTraceTag(41799710,306,50,"Raising set policy label event.");this.Oa.raiseEvent("SetPolicyLabelEventKey",f)}qdh(f){e.ULS.sendTraceTag(51128227,306,50,"Raising an add auto policy business bar entry event.");f&&f.LZc&&gd.a("MipRecommendations");this.Oa.raiseEvent("AddAutoPolicyBusinessBarEntryEventKey",f)}Tdh(f){e.ULS.sendTraceTag(51128256,306,50,"Raising an remove auto policy business bar entry event.");this.Oa.raiseEvent("RemoveAutoPolicyBusinessBarEntryEventKey",f)}nIk(f){e.ULS.sendTraceTag(573842331,
306,50,"Raising an add mandatory labelling business bar entry event.");this.Oa.raiseEvent("AddMandatoryLabellingBusinessBarEntryEventKey",f)}XJk(f){e.ULS.sendTraceTag(573842332,306,50,"Raising a remove mandatory labelling business bar entry event.");this.Oa.raiseEvent("RemoveMandatoryLabellingBusinessBarEntryEventKey",f)}Ogl(f,x=null){e.ULS.sendTraceTag(34996496,306,50,"Showing policy tip to user.");this.Oa.raiseEvent("PolicyTipEvent",new ho(CommonUIStrings.l_PolicyBusinessBarTitle,f,CommonUIStrings.l_PolicyOverrideButton,
x))}ceh(f,x,N,ea=!0){e.ULS.sendTraceTag(42074656,306,ea?50:15,"Raising set policy label failure event. ApplyLabelFlags: {0}",x);ea=CommonUIStrings.l_SensitivityApplicationErrorBusinessBarTitle;let ma=CommonUIStrings.l_SensitivityApplicationErrorBusinessBarMessage,Ha=null,Ua=null;switch(f){case 2:ea=CommonUIStrings.l_SensitivityApplicationErrorDisabledByPolicyBusinessBarTitle;ma=CommonUIStrings.l_SensitivityApplicationErrorDisabledByPolicyBusinessBarMessage;break;case 5:ma=CommonUIStrings.l_SensitivityApplicationErrorFileLockedBusinessBarMessage;
break;case 7:ea=CommonUIStrings.l_SensitivityApplicationErrorFileTooLargeBusinessBarTitle;ma=CommonUIStrings.l_SensitivityApplicationErrorFileTooLargeBusinessBarMessage;break;case 13:ea=CommonUIStrings.l_SensitivityApplicationErrorLabelNotSupportedBusinessBarTitle;ma=CommonUIStrings.l_SensitivityApplicationErrorLabelNotSupportedBusinessBarMessage;break;case 9:ea=CommonUIStrings.l_SensitivityApplicationErrorLabelDisabledBusinessBarTitle;ma=CommonUIStrings.l_SensitivityApplicationErrorLabelDisabledBusinessBarMessage;
break;case 10:ma=CommonUIStrings.l_SensitivityApplicationErrorLabelErrorRetryLaterBusinessBarMessage;break;case 14:ea=CommonUIStrings.l_SensitivityCoauthMandatoryApplicationErrorTitle;ma=CommonUIStrings.l_SensitivityCoauthMandatoryApplicationErrorMessage;break;case 15:ea=CommonUIStrings.l_SensitivityApplicationErrorMinorVersionLimitReachedBusinessBarTitle,ma=CommonUIStrings.l_SensitivityApplicationErrorMinorVersionLimitReachedBusinessBarMessage,Ha=CommonUIStrings.l_LearnMore,Ua=()=>{this.h8k()}}f=
new qc(f,x,N,ea,ma,Ha,Ua);this.Oa.raiseEvent("SetPolicyLabelFailureEventKey",f)}PTe(f){this.sEd=f}xnk(){this.lyd?(e.ULS.sendTraceTag(25565187,306,50,"DLP override button was clicked."),Lb.a.yPc(this.lyd)):e.ULS.sendTraceTag(25565188,306,10,"Null NavigateUrl got in policy response. Could not navigate to SPO.")}ySj(f){if(!f.startsWith("<")||-1===f.indexOf("Error")&&-1===f.indexOf("Unavailable"))return!1;e.ULS.sendTraceTag(25565189,306,10,"The response from server is not a valid JSON response and it matches the error page keyword. This might be the error response from a non-existing endpoint.");
return!0}w$g(){this.xBc&&(this.xBc.stop(),this.xBc=null)}f1i(f){if(!f)return"manual";switch(f.G7){case 0:return"manual";case 4:return"auto";case 1:return"default";case 16:return"mandatory";case 2:return"manual";case 8:return"recommended";default:return"manual"}}k2i(f){if(!f)return"privileged";f=f.G7;let x="privileged";if(4===f||1===f)x="standard";return x}tRc(f,x,N=null,ea=!1,ma=0){this.$a.ka("WacLabelingGetPolicyLabelsIsEnabled")&&(this.Jga=f,this.Eza=N,this.Xh&&(this.K2a=this.Xh.Ci("WebServiceCall",
"Call Get Policy Endpoint On Server")),N={},N[Lj.a.hdi]=f,this.$a.ka("SendHostAttributionInfoForPolicyLabelEnabled")?(f=new Zl.a(this.Cwb("getpolicylabels",ea),1,null,N,!0,2,ma,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,x),this.ei.send(f).kJb(Object(v.a)(this,this.n3g,"onGetPolicyLabelsSuccessCallback"),Object(v.a)(this,this.m3g,"onGetPolicyLabelsFailureCallback"))):this.ei.Aj(this.Cwb("getpolicylabels",ea),1,null,N,!0,2,Object(v.a)(this,this.n3g,"onGetPolicyLabelsSuccessCallback"),
Object(v.a)(this,this.m3g,"onGetPolicyLabelsFailureCallback"),ma,void 0,void 0,void 0,void 0,"22"),this.aSb++,e.ULS.sendTraceTag(34996492,306,50,"Policy label request sent to server. Policy call times: {0}",this.aSb))}f8k(f,x,N,ea=null){if(this.w8b){this.Xh&&(this.D4a=this.Xh.Ci("WebServiceCall","Call Set Policy Endpoint On Server"));var ma={};ma[Lj.a.Onh]=f;x&&(ma[Lj.a.pqh]=encodeURIComponent(x));this.sEd&&(ma[Lj.a.Fci]=this.sEd);ea?(ma[Lj.a.mqh]=this.f1i(ea),ma[Lj.a.nqh]=this.k2i(ea),this.$a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DefaultLabelForSPODocLibEnabled",
!1)&&1===ea.G7&&this.Uv.DefaultLabelType&&(ma[Lj.a.e8k]=this.Uv.DefaultLabelType)):(ma[Lj.a.mqh]="manual",ma[Lj.a.nqh]="privileged");this.ukb&&this.Uv&&(ma[Lj.a.sAk]=this.Uv.PolicyLabelVersionToken);this.$a.ka("SendHostAttributionInfoForPolicyLabelEnabled")?(f=new Zl.a(this.Cwb("setpolicylabel",!0),1,null,ma,!0,2,ea,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,N),this.ei.send(f).kJb(Object(v.a)(this,this.t5g,"onSetPolicyLabelSuccessCallback"),Object(v.a)(this,
this.s5g,"onSetPolicyLabelFailureCallback"))):this.ei.Aj(this.Cwb("setpolicylabel",!0),1,null,ma,!0,2,Object(v.a)(this,this.t5g,"onSetPolicyLabelSuccessCallback"),Object(v.a)(this,this.s5g,"onSetPolicyLabelFailureCallback"),ea,void 0,void 0,void 0,void 0,"32");this.LOa++;e.ULS.sendTraceTag(41799706,306,50,"Set policy label request sent to server. Policy call times: {0}",this.LOa)}else e.ULS.sendTraceTag(570972052,306,50,"SetPolicyLabelRequestInternalAsync was exited - ApplyManualPolicyLabel was not enabled.")}h8k(){const f=
new Mb.StandardDialog,x=this.$a.Ha("BreadcrumbFolderUrl");x?(f.xd=11,f.Xe(1,CommonUIStrings.l_SensitivityApplicationErrorMinorVersionLimitReachedViewInfoAction),f.Xe(2,CommonUIStrings.l_DialogOk)):(f.xd=0,f.Xe(1,CommonUIStrings.l_DialogOk));f.oNd(CommonUIStrings.l_SensitivityApplicationErrorMinorVersionLimitReachedViewInfoHelpText,"0f6cd105-974f-44a4-aadb-43ac5bdfd247");f.MRk();f.cP(CommonUIStrings.l_SensitivityApplicationErrorMinorVersionLimitReachedViewInfoTitle,CommonUIStrings.l_SensitivityApplicationErrorMinorVersionLimitReachedViewInfoMessage,
N=>{1===N&&x&&Lb.a.un(x,"_blank",void 0,"SetPolicyLabelFailureBusinessBarActionCallback.BreadcrumbFolderUrl")})}wWd(f){switch(f){case 1:return cj.a.vCa(1,1);case 2:return cj.a.vCa(7,1);case 3:return cj.a.vCa(8,1);default:return cj.a.vCa(7,0)}}RCi(f=null){if(!f)return cj.a.vCa(8,0);switch(f.G7){case 1:case 16:return cj.a.vCa(1,1);case 4:case 2:case 8:return cj.a.vCa(8,1);default:return cj.a.vCa(8,0)}}ZPe(f){this.$a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GeneralizedRibbonTTVRReporting",
!1)&&appChrome.api.setAsyncRequestStatus("sensitivity",f)}}Object(k.a)(io,"PolicyManager",null,[648]);class Mj{constructor(){this.mJd=this.ZGd=this.ggf=this.bkf=this.f6e=this.ho=this.rOa=this.Da=this.Ak=null}get name(){return"Common.App.Policy"}init(){J.AFrameworkApplication.fa.ka("ShouldInitCommonPolicyPackage")&&(J.AFrameworkApplication.fa.ka("IsDataLossPreventionEnabledForUser")&&J.AFrameworkApplication.Aa&&(this.Ak=this.Da.resolve("Common.App.Policy.Contracts.IPolicyManager"),this.Ak.k$h(Object(v.a)(this,
this.Ngl,"showPolicyBusinessBar")),e.ULS.sendTraceTag(36537375,306,50,"PolicyManager is created successfully."),Rh.a.get_instance().Dk(6,()=>{this.Ak.WZf()})),J.AFrameworkApplication.fa.ka("WacLabelingPoliciesIsEnabled")&&J.AFrameworkApplication.fa.ka("SupportsPolicies")?Rh.a.get_instance().Dk(6,Object(v.a)(this,this.Hlk,"onAfterRibbonBehaviorAttached")):zi.pib(!1))}dispose(){}$b(f){f.register(648,"Common.App.Policy.Contracts.IPolicyManager").ma().oa(()=>new io(J.AFrameworkApplication.fa,J.AFrameworkApplication.Je,
J.AFrameworkApplication.Aa.gV,J.AFrameworkApplication.fa.Fc("MaxGetPolicyRetries",1),f.Ja("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),J.AFrameworkApplication.Aa.hb.Vk));f.register(zi,"Common.App.Policy.PolicyActor").as("Common.App.Policy.Contracts.IPolicyActor").ma().oa(()=>new zi(J.AFrameworkApplication.Ta,J.AFrameworkApplication.Aa,J.AFrameworkApplication.fa,f.re("Common.App.Policy.Contracts.IPolicyManager")));this.Da=f}Hlk(){this.ho=this.Da.rb("CommonUI.BusinessBar");this.Ak||
(this.Ak=this.Da.resolve("Common.App.Policy.Contracts.IPolicyManager"));this.rOa=this.Da.resolve("Common.App.Policy.PolicyActor");J.AFrameworkApplication.fa&&J.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CacheSensitivityVisibility",!1)&&Pd.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.DelayPolicyActionRegistration")?this.Ak.WNd(Object(v.a)(this.rOa,this.rOa.Tfh,"registerActionsHandler")):this.rOa.vb();this.Ak.WNd(Object(v.a)(this,
this.Uyl,"updateLabelInfo"));J.AFrameworkApplication.fa.ka("WacApplyManualPolicyLabelIsEnabled")&&(this.Ak.Usf(Object(v.a)(this,this.Euj,"handleSetPolicyLabelFailure")),this.Ak.D7h(Object(v.a)(this,this.aFc,"addAutoPolicyBusinessBarEntry")),this.Ak.x$h(Object(v.a)(this,this.Kxa,"removeAutoPolicyBusinessBarEntry")),this.Ak.E7h(Object(v.a)(this,this.tNd,"addMandatoryLabellingBusinessBarEntry")),this.Ak.y$h(Object(v.a)(this,this.OOe,"removeMandatoryLabellingBusinessBarEntry")))}Uyl(){this.rOa.Z7k();
this.rOa.D6k();this.rOa.xHk();const f=this.Ak.yqi();J.AFrameworkApplication.fa.ka("HasDocumentEditRights")&&!f?this.rOa.qsl():e.ULS.sendTraceTag(558682911,306,50,"Default/Mandatory Labeling has been skipped because HasDocumentEditRights: {0}, IsClpBlockedByAppSpecificScenario: {1}",J.AFrameworkApplication.fa.ka("HasDocumentEditRights"),f);J.AFrameworkApplication.Aa.updateCommandUI()}Ngl(f,x){this.ZGd&&this.ho.uda(38)&&this.ho.removeEntry(this.ZGd);f=this.O2f(x.title,x.tAk,38,x.Amk,x.buttonText);J.AFrameworkApplication.Aa.hb.cFc(f,
!0)?(this.ZGd=f,e.ULS.sendTraceTag(34174785,306,50,"Add entry to BusinessBar succeeded. Policy message is shown to user.")):e.ULS.sendTraceTag(34174784,306,10,"Failed to add entry to business bar. Policy message could not be shown to user.")}Euj(f,x){x.wgl&&(this.mJd&&this.ho.uda(21)&&this.ho.removeEntry(this.mJd),f=this.O2f(x.title,x.message,21,null,null,x.jZb,x.buttonText),J.AFrameworkApplication.Aa.hb.cFc(f,!0)?(this.mJd=f,e.ULS.sendTraceTag(42074655,306,50,"Add entry to BusinessBar succeeded. CLP policy message is shown to user.")):
e.ULS.sendTraceTag(42074654,306,10,"Failed to add entry to business bar. CLP policy message could not be shown to user."))}Kxa(f,x){(f=x.LZc?this.bkf:this.f6e)&&this.ho&&this.ho.uda(x.Zrb)&&this.ho.removeEntry(f)}aFc(f,x){this.ho&&(this.Ak.Kxa(x.Zrb),f=new ll.a(x.title,x.message,null),f.id=x.Zrb,f.closeable=!0,f.image=3,f.addButton(x.buttonText,x.jZb,x.buttonText,!0),this.ho.Yh(f,!1),x.LZc?this.bkf=f:this.f6e=f)}tNd(f,x){this.ho&&(f=new ll.a(x.title,x.message,null),f.id=x.Zrb,f.closeable=!1,f.image=
3,f.addButton(x.buttonText,x.jZb,x.buttonText,!1),this.ho.Yh(f,!1),this.ggf=f)}OOe(){const f=this.ggf;f&&this.ho&&this.ho.uda(f.id)&&this.ho.removeEntry(f)}O2f(f,x,N,ea=null,ma=null,Ha=null,Ua=null){f=new ll.a(f,x,null);f.id=N;f.closeable=!0;ea&&f.Uqf(ma,ea);Ha&&f.addButton(Ua,Ha,Ua);return f}static main(){Na.a.instance.Dc(new Mj)}}Object(k.a)(Mj,"PackageManager",null,[2,3]);var Jn=d(288),jo=d(256),Ym=d(127);class Li extends jo.a{constructor(){super();this.fullDocSITs=this.partialDocSITs=null;this.H_=
Object.assign(new Ym.a,{T_:Li.getTypeName(),B_:Li.getBaseTypes()})}static getTypeName(){return"AugLoop_SecurityShared_SecurityShared"}static getBaseTypes(){return[]}}Object(k.a)(Li,"SecurityShared",jo.a,[]);class Kn extends Li{constructor(){super();this.existingLabelPriority=null;this.H_=Object.assign(new Ym.a,{T_:Kn.getTypeName(),B_:Kn.getBaseTypes()})}static getTypeName(){return"AugLoop_SecurityShared_CLP"}static getBaseTypes(){return["AugLoop_SecurityShared_SecurityShared"]}}Object(k.a)(Kn,"CLP",
Li,[]);var Ln=d(389),Ao=d(434),Xo=d(685);class Bo extends Mf.a{constructor(f){super();this.TenantId=null;this.TenantId=f}$k(){return 103}}Object(k.a)(Bo,"GetAppliedPolicyIdRequest",Mf.a,[]);class qp extends Sys.EventArgs{constructor(f){super();this.pia=f}}Object(k.a)(qp,"OnAppliedPolicyReceivedEventArgs",Sys.EventArgs,[]);class Co{constructor(f,x,N){this.ZX=this.Gte=this.y4c=null;this.va=new hl.a;this.p9b=!1;this.vi=f;this.acb=x;this.Yb=N;this.acb.O8h(Object(v.a)(this,this.k1g,"onAppliedPolicyIdReady"));
this.acb.w9h(Object(v.a)(this,this.I3g,"onIsManuallyAppliedReady"))}P8h(f){this.va.addHandler("AppliedPolicyEventReceivedKey",f)}dispose(){this.acb.zTk(Object(v.a)(this,this.k1g,"onAppliedPolicyIdReady"));this.acb.WTk(Object(v.a)(this,this.I3g,"onIsManuallyAppliedReady"))}wXf(f,x){f?(this.ZX=f,this.y4c=x,f=new dk.a(new Bo(f),N=>{this.Ted(N)},N=>this.xgb(N)),this.vi.Eb(f)):Vc.a.J(41735234,822,15,"GetAppliedPolicyIdAsync: tenantId is null or empty")}B$i(f,x){!x||H.a.Wa(f)?Vc.a.J(51446608,822,15,"GetIsManuallyAppliedAsync: tenantId or callback is null or empty"):
(this.ZX=f,this.Gte=x,f=new dk.a(new Bo(f),N=>{this.Ted(N)},N=>this.xgb(N)),this.vi.Eb(f))}k1g(f,x){f="";H.a.Wa(x.pia)||(f=x.pia);"00000000-0000-0000-0000-000000000000"===f?(x=H.a.Wa(this.ZX)?this.Yb.Ha("TenantId"):this.ZX,this.wXf(x,this.y4c)):this.HEe(f,null)}I3g(f,x){this.Lpk(x.p9b)}Ted(f){let x=null;f.ServerError&&0!==f.ServerError.Code?x=jk.a[f.ServerError.Code]:0!==f.StatusCode&&(x=Rf.a[f.StatusCode]);x&&this.HEe("",x)}xgb(){Vc.a.J(41735236,822,15,"OnGetAppliedPolicyIdFailed()");this.HEe("",
"ErrorGetAppliedPolicyIdFailed");return!0}HEe(f,x){x&&Vc.a.J(41735238,822,15,"OnAppliedPolicyIdReceived: error: "+x);this.y4c?this.y4c(f,x):Vc.a.J(50628552,822,15,"m_getAppliedPolicyIdCallback is null");Vc.a.J(587239824,822,50,"OnAppliedPolicyIdReceived: Triggering OnAppliedPolicyReceivedEvent");f=new qp(f);this.va.raiseEvent("AppliedPolicyEventReceivedKey",f)}Lpk(f){this.Gte?this.Gte(f,null):Vc.a.J(51446615,822,15,"m_getIsManuallyAppliedCallback is null")}}Object(k.a)(Co,"AppliedPolicyIdService",
null,[609,106]);class ko{constructor(f,x,N,ea){this.CDb=f;this.VFa=x;this.hU=N;this.la=ea}yta(f){var x=f.automatic||{},N=x.sensitivityLabel||{};x=this.bhe()?x.id:N.id;N=f.recommended||{};const ea=N.sensitivityLabel||{};f=this.bhe()?N.id:ea.id;N=this.bhe()?N.policyTip:ea.policyTip;this.la.pptIsManuallyAppliedForAclpIsEnabled?this.CDb.lvf(x,f,N,!this.hU.Uv.AppliedPolicyId||!this.VFa.p9b):this.CDb.lvf(x,f,N,!this.hU.Uv.AppliedPolicyId)}bhe(){return this.la.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AutoCLPV2Transition",
!1)}}Object(k.a)(ko,"AutoClpAnnotationEventHandler",null,[]);class tn{constructor(){this.ApplyLabelType=0;this.LabelJson=this.LabelId=this.DocLocation=null;this.SkipContentMarking=!1;this.UserPrincipalName=this.UserName=this.TenantId=null}}Object(k.a)(tn,"PolicyInfo",null,[]);var un=d(991);class nl{constructor(){this.pHb=this.startTime=null}}Object(k.a)(nl,"PollingData",null,[]);class wm{constructor(f,x,N,ea,ma,Ha,Ua,mb,gb,Cb,zb,Pb){this.GSg=this.pCb=!1;this.p3c=null;this.NAg=!1;this.ia=f;this.CDb=
x;this.hU=N;this.ZX=ea;this.nsg=new ta.a;this.K6j=ma;this.VFa=Ha;this.zb=Ua;this.DSg=mb;this.Eq=gb;this.dJ=Cb;this.Fv=zb;this.mc=Pb;this.PIg=J.AFrameworkApplication.fa.Fc("ClpLabelPollingIntervalMs",3E4);this.hye=J.AFrameworkApplication.fa.Fc("ClpLabelPollingTimeoutMs",3E5);this.Ima=J.AFrameworkApplication.fa.Ha("UserName");this.Tdk=J.AFrameworkApplication.fa.Ha("UserPrincipalName");this.t5j=this.e7i()}e7i(){let f;if(J.AFrameworkApplication.fa.ka("DynamicVariableCLPFixEnabled")){if(f=J.AFrameworkApplication.fa.Ha("EditDocInClientUrl"))return Vc.a.J(512263634,
822,50,"PptPolicyManager::GetDocLocation EditDocInClientUrl is not null"),f;Vc.a.J(512263633,822,10,"PptPolicyManager::GetDocLocation EditDocInClientUrl is null")}(f=J.AFrameworkApplication.fa.Ha("WOPISrc"))||Vc.a.J(512263632,822,10,"PptPolicyManager::GetDocLocation WOPISrc is null");Vc.a.J(512263631,822,50,"PptPolicyManager::GetDocLocation WOPISrc is not null");return f}dispose(){this.CDb=null;if(this.pCb){this.hU.qih(Object(v.a)(this,this.r5g,"onSetLabelSucceeded"));for(let f of this.nsg)this.hU.qih(f)}}init(){this.CDb.vb();
this.CDb.De();if(J.AFrameworkApplication.fa.ka("PPTClpSwitchEnabled")&&J.AFrameworkApplication.fa.ka("SupportsOfficeClientCoauthoring")){const f=Object(C.a)(un.a,If.App.Ih);f&&this.hU.AOk(Object(v.a)(f,f.oei,"areAllCoauthorsInSessionClientMipTrusted"));this.hU.OBj(this.K6j);0<this.PIg&&0<this.hye&&this.VFa.P8h(Object(v.a)(this,this.Ynk,"onDocumentContentPolicyChanged"));J.AFrameworkApplication.jua&&this.DSg.fPk(()=>this.Eq.BJh);this.Eq.W3&&(Vc.a.J(512263630,822,50,"PPTPolicyManager::Init - Setting LockId to {0}",
this.Eq.W3),this.hU.PTe(this.Eq.W3));this.dJ.D8h(()=>{Vc.a.J(512263629,822,50,"PPTPolicyManager::LockIdChanged - Setting LockId to {0}",this.Eq.W3);this.hU.PTe(this.Eq.W3)})}this.hU.uai(Object(v.a)(this,this.lei,"applyUdpLabeling"));this.hU.KPk(Object(v.a)(this,this.hJj,"isClpBlockedByAppSpecificScenario"));this.hU.I8h(Object(v.a)(this,this.Idi,"applyMandatoryLabeling"));this.hU.rOd(Object(v.a)(this,this.r5g,"onSetLabelSucceeded"));this.pCb=!0}lei(f,x){x.Xcl&&J.AFrameworkApplication.Ta.processAction(zc.a.openInClient,
2)}hJj(){const f=!this.mc.getState(2)&&!this.mc.$hg;this.GSg!==f&&(this.mc.Jog(),Vc.a.J(512263628,822,50,"PPTPolicyManager::IsClpBlockedByAppSpecificScenario - {0}",f),this.GSg=f);return f}get pia(){return this.hU.Uv.AppliedPolicyId}YPk(f){this.hU.rOd(f);this.nsg.add(f)}Dzk(f,x,N){const ea=new tn;ea.TenantId=this.ZX;ea.LabelId=f;ea.ApplyLabelType=x;ea.LabelJson=wm.RXi(R.c(N));ea.SkipContentMarking=!1;ea.UserName=this.Ima;ea.UserPrincipalName=this.Tdk;ea.DocLocation=this.t5j;Vc.a.J(512263627,822,50,
"PersistLabelToWorker: Updating worker with received policy");this.ia.La(zc.a.Z$g,2,ea)}Idi(f,x){if(x&&0!==x.iPd){(f=1===x.iPd)?this.Fv.czh():(this.Fv.$yh(),""!==x.mXg&&this.DSg.Jdi(x.mXg));x=f?1:3;var N=J.AFrameworkApplication.Ta.mode;x!==N?Vc.a.J(512263625,822,10,"ApplyMandatoryLabeling ModeSwitch Failed. Expected: {0}, Current: {1}",x,N):this.NAg=f}else Vc.a.J(512263626,822,50,"ApplyMandatoryLabelling is called with invalid inputs.")}r5g(f,x){this.Dzk(x.x$g,x.G7,this.hU.Uv);Vc.a.J(512263624,822,
50,"OnSetLabelSucceeded: Set policy label to ppt file after set label succeeded on host.")}k1d(f){f&&this.pia?f=this.pia.toLowerCase()===f.toLowerCase():(Vc.a.J(512263623,822,50,"FLabelIdMatchesPolicyManager: null labelId or null AppliedPolicyId, can't compare case insensitively. fNullLabelId:{0} fNullAppliedPolicyId:{1}",!f,!this.pia),f=f===this.pia);Vc.a.J(512263622,822,50,"FLabelIdMatchesPolicyManager: fLabelIdMatchesPolicyManager:{0}",f);return f}xAk(f){const x=Object(C.a)(nl,f.customData);if(x){var N=
+new Date-+x.startTime;Vc.a.J(512263620,822,50,"PollingTaskCallback: Callback received, durationMs:{0}",N);this.k1d(x.pHb)||N>this.hye||x.pHb!==this.p3c?(Vc.a.J(512263619,822,50,"PollingTaskCallback: Stopping loop due to FAreInSync:{0} fDidTimeout:{1} fStaleLabelId:{2}",this.k1d(x.pHb),N>this.hye,x.pHb!==this.p3c),this.zb.Rg(f)):(Vc.a.J(512263618,822,50,"PollingTaskCallback: Triggering GetPolicy call"),this.hU.qSa(x.pHb,void 0,wm.uPa,!0))}else Vc.a.J(512263621,822,15,"PollingTaskCallback: Failed to get pollingData from taskItem, removing task"),
this.zb.Rg(f)}mml(f){Vc.a.J(512263617,822,50,"SubmitPollingTask: Submitting new polling task");const x=new cd.a(2,2,this.PIg,Object(v.a)(this,this.xAk,"pollingTaskCallback"),90,"113");x.customData=Object.assign(new nl,{startTime:new Date,pHb:f});this.zb.Eb(x)}Ynk(f,x){Vc.a.J(512263616,822,50,"OnDocumentContentPolicyChanged: Notification received");x.pia||Vc.a.J(512263587,822,50,"OnDocumentContentPolicyChanged: Empty labelId - could indicate bug or all labels removed");this.p3c=x.pia;this.k1d(this.p3c)?
Vc.a.J(512263586,822,50,"OnDocumentContentPolicyChanged: PODS is in agreement with SPO, no need to poll"):this.mml(x.pia)}static uPa(){const f=If.App.Ih.amIAlone,x=If.App.Ih.uPa;let N=!1;const ea=Object(C.a)(un.a,If.App.Ih);ea&&(N=ea.pei());Vc.a.J(512263585,822,50,"AmITheOnlyCoauthor: Used block self coauth flow, fAmIAlone:{0} fAmITheOnlyCoauthor:{1} fAreAllCoauthorsWebClients:{2}",f,x,N);return f||x&&N}static RXi(f){f=f.replace(RegExp(":null","gi"),':""');return f=f.replace(RegExp('"LabelActions":',
"gi"),'"Actions":')}}Object(k.a)(wm,"PptPolicyManager",null,[106]);class rk{constructor(f,x,N,ea){this.C3j=f;this.qc=x;this.Jb=N;this.la=ea}vb(){this.C3j.ra(zc.a.Z$g,ti.a.application,Object(v.a)(this,this.$oj,"handleApplySensitivity"),4)}De(){}$oj(f,x,N,ea,ma){if(!(J.AFrameworkApplication.fa.ka("WacLabelingPoliciesIsEnabled")&&J.AFrameworkApplication.fa.ka("WacApplyManualPolicyLabelIsEnabled")&&this.la.pptLabelingGetPolicyLabelsIsEnabled&&this.la.pptApplyManualPolicyLabelIsEnabled&&J.AFrameworkApplication.fa.ka("SupportsPolicies")))return 16;
if(x.contextId!==ti.a.application)return 2;if(!ma||!Object(Ai.a)(tn,ma))return 8;f=Object(C.a)(tn,ma);if(H.a.Wa(f.TenantId))return Vc.a.J(41793040,808,10,"The tenant id of policy info is empty or null"),8;if(H.a.Wa(f.LabelJson))return Vc.a.J(41793042,808,10,"The label json of policy info is empty or null"),8;if(1===N)return 32;N=this.qc.Pn;x=this.Jb.zd(7);try{x.nc(N),N.qHb=f}finally{x&&x.dispose()}return 32}}Object(k.a)(rk,"SetPolicyActor",null,[227]);class Wg{constructor(){this.dbc=this.C8c=this.Yb=
this.VFa=this.K=null;this.hQg=!0}get name(){return"PowerPointWebEditor.Policy"}$b(f){this.K=f;this.K.register(609,"PowerPointWebEditor.Policy.IAppliedPolicyIdService").ma().oa(()=>new Co(this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.K.resolve("PowerPointWebEditor.CoreExt.ICoreExtEventHandler"),this.K.resolve("Common.IAppSettingsManager")))}init(){this.Yb=this.K.resolve("Common.IAppSettingsManager");this.Yb.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.SensitivityTTVRImprovementEnabled",
!1)?this.Yb.hyb(Object(v.a)(this,this.Om,"onFullAppSettingsReady")):this.K.resolve("Common.IAppSettingsManager").jf(Object(v.a)(this,this.Om,"onFullAppSettingsReady"))}dispose(){}Om(){if(this.Yb.ka("WacLabelingPoliciesIsEnabled")&&this.Yb.ka("SupportsPolicies")&&this.Yb.ka("890"))this.VFa=this.K.resolve("PowerPointWebEditor.Policy.IAppliedPolicyIdService"),Rh.a.get_instance().Dk(10,Object(v.a)(this,this.Ilk,"onAfterRibbonDisplayed")),Jn.a.Uu(this.K.Ja("Common.App.Policy.Contracts.IPolicyManager")).continueWith(f=>
{const x=new rk(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"));f=f.result;this.C8c=new wm(this.K.resolve("Common.IActionManagerExtended"),x,f,this.Yb.Ha("TenantId"),this.K.Ja("Common.Interface.IRtcBasicProvider"),this.K.resolve("PowerPointWebEditor.Policy.IAppliedPolicyIdService"),this.K.resolve("Common.ITaskManager"),this.K.resolve("Common.App.Policy.Contracts.IPolicyActor"),
this.K.resolve("PowerPointWebEditor.ICoauthStateSetter"),this.K.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler"),this.K.resolve("PowerPointWebEditor.Application.IReadOnlyManager"),this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState"));this.C8c.init()});else if(this.K.resolve("PowerPointWebEditor.IApplicationSettings").Jib){const f=this.K.resolve("PowerPointWebEditor.IPPTRumTracker");f.K$(f.K5,f.soh)}}Ilk(){Jn.a.Uu(this.K.Ja("Common.App.Policy.Contracts.IPolicyManager")).continueWith(f=>
{const x=f.result;J.AFrameworkApplication.fa.ka("AutoClpIsEnabled")&&(Vc.a.J(512274584,822,50,"OnAfterRibbonDisplayed: Registering with GetAutoPolicyLabelHandler API"),this.dbc=new Ya.a(()=>new ko(this.K.resolve("Common.App.Policy.Contracts.IPolicyActor"),this.K.resolve("PowerPointWebEditor.Policy.IAppliedPolicyIdService"),x,this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.Yb.Ha("TenantId"))),x.o8h(Object(v.a)(this,this.COk,"registerAutoClpAnnotationEventHandler")),J.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AutoCLPV2Transition",
!1)&&(x.Z7h(Object(v.a)(this,this.yKc,"createAutoCLPSecurityNodes")),x.xai(Object(v.a)(this,this.ixl,"updateAutoCLPLabelPriorityNode")),x.yai(Object(v.a)(this,this.jxl,"updateAutoCLPSITNodes"))));(f=this.Yb.Ha("AppliedPolicyId"))||J.AFrameworkApplication.fa.ka("PPTClpSwitchEnabled")&&J.AFrameworkApplication.fa.ka("SupportsOfficeClientCoauthoring")?J.AFrameworkApplication.fa.ka("PPTOCoauthorPopUpFixManualCLPEnabled")?x.qSa(f,void 0,wm.uPa):x.qSa(f):(f=this.Yb.Ha("TenantId"),H.a.Wa(f)?Vc.a.J(512274583,
822,15,"OnAfterRibbonDisplayed: tenantId is null or empty"):(Vc.a.J(512274582,822,50,"OnAfterRibbonDisplayed: Call AppliedPolicyIdService.GetAppliedPolicyIdAsync"),this.VFa.wXf(f,(N,ea)=>{ea&&Vc.a.J(512274581,822,15,"OnAfterRibbonDisplayed: AppliedPolicyIdService.GetAppliedPolicyIdAsync failed: "+ea);H.a.Wa(N)&&(N="",Vc.a.J(512274580,822,50,"OnAfterRibbonDisplayed: AppliedPolicyIdService.GetAppliedPolicyIdAsync: appliedPolicyIdInFile is empty"));J.AFrameworkApplication.fa.ka("PPTOCoauthorPopUpFixManualCLPEnabled")?
x.qSa(N,void 0,wm.uPa):x.qSa(N)}),this.VFa.B$i(f,(N,ea)=>{ea?Vc.a.J(512274579,822,15,"OnAfterRibbonDisplayed: AppliedPolicyIdService.GetIsManuallyAppliedAsync failed: "+ea):this.VFa.p9b=N}),this.C8c.YPk(Object(v.a)(this,this.Syl,"updateIsManuallyApplied"))))})}COk(){const f=this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState");this.hQg&&(f.Fn||this.C8c.NAg&&f.N9b)&&(this.K.Ja("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager").execute(x=>{Vc.a.J(512274578,822,50,"RegisterAutoClpAnnotationEventHandler: Registering with AugLoopRuntimeManager");
J.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AutoCLPV2Transition",!1)?(x.x5a("AugLoop_SecurityClp_LabellingAnnotation"),x.knc("AugLoop_SecurityClp_LabellingAnnotation",Object(v.a)(this.dbc.value,this.dbc.value.yta,"handleAnnotationEvent"))):(x.x5a("AugLoop_Automatic_Clp_LabellingAnnotation"),x.knc("AugLoop_Automatic_Clp_LabellingAnnotation",Object(v.a)(this.dbc.value,this.dbc.value.yta,"handleAnnotationEvent")))}),this.hQg=!1)}yKc(f,x){f=[Object.assign(new Ao.a,
{id:"clp",body:Object.assign(new Kn,{existingLabelPriority:x.existingLabelPriority,partialDocSITs:x.jEf,fullDocSITs:x.iEf})})];const N=Object.assign(new Ln.a,{parentPath:["session","doc","security"],items:f});this.K.Ja("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager").execute(ea=>{Vc.a.J(512274577,822,50,"CreateAutoCLPSecurityNodes: Submit AddOperations to AugLoopRuntimeManager");ea.submitOperation(N)})}ixl(f,x){f=[Object.assign(new Ao.a,{id:"clp",body:Object.assign(new Kn,{existingLabelPriority:x.existingLabelPriority})})];
const N=Object.assign(new Xo.a,{parentPath:["session","doc","security"],items:f});this.K.Ja("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager").execute(ea=>{Vc.a.J(512274576,822,50,"UpdateAutoCLPLabelPriorityNode: Submit UpdateOperation to AugLoopRuntimeManager");ea.submitOperation(N)})}jxl(f,x){f=[Object.assign(new Ao.a,{id:"clp",body:Object.assign(new Kn,{partialDocSITs:x.jEf,fullDocSITs:x.iEf})})];const N=Object.assign(new Xo.a,{parentPath:["session","doc","security"],items:f});this.K.Ja("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager").execute(ea=>
{Vc.a.J(512274575,822,50,"updateAutoCLPSITNodes: Submit UpdateOperation to AugLoopRuntimeManager");ea.submitOperation(N)})}Syl(f,x){x&&(this.VFa.p9b=x.x$g&&0!==x.G7?2===x.G7||8===x.G7||16===x.G7?!0:!1:!1)}static main(){Na.a.instance.Dc(new Wg)}}Object(k.a)(Wg,"PPTWebEditorPolicyPackage",null,[2,3]);Type.registerNamespace("B4Intent");Type.registerNamespace("Box4.Dictation");Type.registerNamespace("Box4.Dictation.Authentication");Type.registerNamespace("Box4.DictationCorrections");Type.registerNamespace("Common.App.CatchUpActivity");
Type.registerNamespace("OfficeVoice.FrontdoorSpeechClient");Type.registerNamespace("PPTe");Type.registerNamespace("PowerPoint");Type.registerNamespace("PowerPointSafeLinks");Type.registerNamespace("PowerPointWebEditor");Type.registerNamespace("PowerPointWebEditor.Activity");Type.registerNamespace("PowerPointWebEditor.Animations");Type.registerNamespace("PowerPointWebEditor.Dictation");Type.registerNamespace("PowerPointWebEditor.FirstRunExperience");Type.registerNamespace("PowerPointWebEditor.Policy");
Type.registerNamespace("PowerPointWebEditor.RevisionTracking");Type.registerNamespace("Common");Type.registerNamespace("Common.App.ApplicationFeatureHelper");ua.main();Type.registerNamespace("Common.App.CatchUpActivity");mc.main();Type.registerNamespace("Common.Comments");Type.registerNamespace("Common.App.Rename");Na.a.instance.Dc(new nd,7);Type.registerNamespace("Common.App.Rename.RenameExecutor");Na.a.instance.Dc(new id);Type.registerNamespace("Common.App.SafeLinks");xb.main();ui.main();yl.main();
Tm.main();gm.main();ag.main();We.main();Type.registerNamespace("Common.App.OAuth");Kh.main();Na.a.instance.Dc(new Zk);eo.main();Na.a.instance.Dc(new yo);pk.main();Type.registerNamespace("Common.App.AugmentationLoop");Type.registerNamespace("Common.App.Policy.Contracts");Type.registerNamespace("Common.App.Policy");Mj.main();Wg.main()},209:function(K,Z,d){K=d(0);var k=d(55);class e{constructor(v,C,w,z,A){this.NGa=!1;this.ZBb=v;this.eBb=C;this.kbc=w;this.c8j=A;this.pDb=z.VDa(w,C.name)}get Vyf(){return this.kbc}$b(v){this.pDb.nxf();
this.eBb.$b(v);this.pDb.zPf()}init(){this.pDb.su(this.eBb.name+"_d");this.c8j?this.ZBb.MBj(this,this.kbc):this.ZBb.LBj(this,this.kbc)}KBj(){this.pDb.yu(this.eBb.name+"_d");this.pDb.pxf();this.eBb.init();this.NGa=!0;this.pDb.CPf()}dispose(){this.NGa&&this.eBb.dispose()}get name(){return this.eBb.name}}Object(K.a)(e,"DelayLoadedPackage",null,[708,2,3]);class n{constructor(v,C){this.ZBb=null;v.execute(w=>{this.ZBb=w});this.q4j=C}create(v,C,w){return this.ZBb?new e(this.ZBb,v,C,this.q4j.value,w):v}static get instance(){return n.Ka||
(n.Ka=new n(k.a.instance.Ja("PowerPointWebEditor.DelayLoadedPackageInitializer"),k.a.instance.re("PowerPointWebEditor.Core.IBundleMetricRecorder")))}}n.Ka=null;Object(K.a)(n,"DelayLoadedPackageFactory",null,[]);d.d(Z,"a",function(){return r});const r=(v,C)=>n.instance.create(v,C,!1)},217:function(K,Z,d){d.d(Z,"a",function(){return r});K=d(0);var k=d(25),e=d(1117),n=d(45);class r{static G_f(){return r.Jai+"_"+e.a.r7b+"_"+n.a.iN(k.AFrameworkApplication.userName)+"_"}static cXf(v){return v+"_"+e.a.r7b+
"_"+n.a.iN(k.AFrameworkApplication.userName)+"_"}static c3f(){return r.OEk+"_"+e.a.r7b+"_"+n.a.iN(k.AFrameworkApplication.userName)+"_"}}r.A7="ack0";r.B7="ack1";r.aGc="ack2";r.Jai="ack3";r.XXb="ack4";r.atf="ack7";r.Yle="ack8";r.xuh="ack9";r.MQd="ack10";r.oWe="ack13";r.ctf="AddinDetailsRefreshed";r.Hai="DdaMethod";r.Gai="ControlId";r.BOd="SecurityOrigin";r.Mqb="ak0";r.zOd="ak1";r.ftf="ak2";r.YXb="ak4";r.$sf="Office.AutoShowTaskpaneWithDocument";r.yOd="refreshRequired";r.dtf="value";r.Mai="errorCode";
r.o_d="SolutionId";r.m_d="MethodData";r.n_d="DynamicAddinCommandsMethodDispatchId";r.nOi="SourceControlId";r.lOi="OsfControl";r.mOi="RibbonUpdaterData";r.Erd="AddinShared";r.OEk="__OSF_PRIVATECATALOG_ADDINIDS";Object(K.a)(r,"AddinConstantsString",null,[])},234:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);d=d(76);class k extends d.a{constructor(e){super();this._element=null;this.element=e}get element(){return this._element}set element(e){this._element=e}get visible(){return"visible"===this.element.style.visibility}set visible(e){this.element.style.visibility=
e?"visible":"hidden"}get rtl(){return"rtl"===this.element.dir.toLowerCase()}set rtl(e){this.element.dir=e?"rtl":"ltr"}get zIndex(){return this.element.style.zIndex}set zIndex(e){this.element.style.zIndex=String(e)}dispose(){this.element&&this.element.parentNode&&this.element.parentNode.removeChild(this.element);this.element=null;super.dispose()}createElement(e){return this.element.ownerDocument.createElement(e)}Kx(){return!0}static ytb(e,n){return e+(n?"Rtl":"")}}Object(K.a)(k,"BasePresenceControl",
d.a,[106,405])},235:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k extends Sys.EventArgs{constructor(e,n){super();this.type=e;this.Yi=n}}k.lp="InteractivityChanged";Object(K.a)(k,"InteractivityChangedEventArgs",Sys.EventArgs,[])},277:function(K,Z,d){d.d(Z,"a",function(){return e});K=d(0);var k=d(1006);class e{constructor(n){this.kl=new k.a;this.WXa=n}VG(n){const r=n.id;let v=null;this.kl.Hb(r)?v=this.kl.ga(r):(this.WXa&&(v=this.WXa(n,()=>{this.znc(r)})),v&&this.kl.$(r,v));return v}EF(n){n=
n.id;return this.kl.Hb(n)?this.kl.ga(n):null}znc(n){this.kl.remove(n)}}Object(K.a)(e,"ShapeComponentViewManager",null,[255])},376:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k{}Object(K.a)(k,"OAuthResult",null,[])},443:function(K,Z,d){d.d(Z,"a",function(){return v});K=d(0);var k=d(65),e=d(13),n=d(326),r=d(114);class v{constructor(C,w,z,A,u,E,H,I,J,T,D,R){this.rZb=1;this.$T=w;this.ai=C;this.gpe=z;this.He=J;this.rp=T;this.Yc=D;this.SHa=I;this.qHa=u;this.rHa=A;this.wO=E;this.He.addCssClass(this.ai,
"prControl");this.ai.style.width=this.He.Pc(w);this.Ir=H.WIf();this.BGa=H.VIf();this.Ir.Dia(C);this.BGa.Dia(C,w,w);this.lXa=R;this.Jna()}dispose(){this.qtc();this.clear();this.Ir.dispose();this.BGa.dispose();this.He.removeCssClass(this.ai,"prControl")}get ofa(){return r.a.none}clear(){this.Lra();this.Psb();this.TJb()}setZIndex(C){this.ai.style.zIndex=String(C)}Yhc(){this.lXa.xa.style.zIndex=String(this.rZb+n.a.Taa)}TJb(){this.lXa.xa.style.zIndex="0"}ynd(C,w,z=null){C=this.SHa.uWd(this.$T,this.$T,
this.gpe,C,"",z);this.Ir.poa(C,w)}E5a(C,w){this.BGa.add(C,w)}Psb(){this.BGa.clear()}Lra(){this.Ir.clear()}onClick(){return!0}Jna(){this.rHa&&this.rp.pb(k.a.pointerOver,this.ai,this.rHa);this.qHa&&this.rp.pb(k.a.pointerOut,this.ai,this.qHa);this.wO?this.Yc.pb(k.a.click,this.ai,this.wO):this.Yc.pb(k.a.click,this.ai,Object(e.a)(this,this.onClick,"onClick"));this.Yc.pb(k.a.doubleClick,this.ai,Object(e.a)(this,this.onClick,"onClick"))}qtc(){this.rHa&&this.rp.yb(k.a.pointerOver,this.ai,this.rHa);this.qHa&&
this.rp.yb(k.a.pointerOut,this.ai,this.qHa);this.wO?this.Yc.yb(k.a.click,this.ai,this.wO):this.Yc.yb(k.a.click,this.ai,Object(e.a)(this,this.onClick,"onClick"));this.Yc.yb(k.a.doubleClick,this.ai,Object(e.a)(this,this.onClick,"onClick"))}}Object(K.a)(v,"ShapePawn",null,[256])},538:function(K,Z,d){d.r(Z);K=d(0);var k=d(382),e=d(1207),n=d(683),r;(function(ya){ya[ya.external=0]="external";ya[ya.msa=1]="msa";ya[ya.aad=2]="aad"})(r||(r={}));Object(K.b)("AuthorityType",r);var v=d(376);class C{constructor(ya){this.MVh=
ya}initialize(){return Promise.resolve(0)}R0c(){return Promise.resolve(0)}nV(){k.ULS.sendTraceTag(574239257,3E3,50,"Automation flag set.  Returning Mock Token.");return Promise.resolve(Object.assign(new v.a,{IsSuccess:!0,Token:this.MVh}))}Dsd(){return Promise.resolve(Object.assign(new v.a,{IsSuccess:!1,ErrorCode:"authTokenStrategy_loginNotSupported",ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}Fqd(){return!1}M5b(){return"MockAuthTokenStrategy"}}
Object(K.a)(C,"MockAuthTokenStrategy",null,[780]);var w=d(717);class z{static get(ya,Da,pa){if(!pa)return ya;let la=0;return Promise.race([ya,new Promise(Fa=>{la=window.setTimeout(()=>{Fa(Da)},pa)})]).then(Fa=>{window.clearTimeout(la);return Promise.resolve(Fa)}).catch(()=>{window.clearTimeout(la);return Promise.resolve(Da)})}}Object(K.a)(z,"PromiseWithTimeout",null,[]);var A=d(25),u=d(224);class E{constructor(ya,Da,pa,la,Fa){this.scope=this.resource=null;this.silentLogin=!1;this.correlationId=this.options=
null;this.resource=ya;this.scope=Da;this.silentLogin=pa;this.options=la;this.correlationId=Fa}}Object(K.a)(E,"TokenRequestParameters",null,[801]);var H=d(54),I=d(55);class J{constructor(){this.Yof=null;let ya=A.AFrameworkApplication.fa.Ha(A.AFrameworkApplication.YJ),Da=A.AFrameworkApplication.fa.Ha(A.AFrameworkApplication.pEh);this.Npb=String.format("ParentFrameTokenStrategy uiHost={0} uiHostIntegrationType={1}",ya&&""!==ya?ya:"Unspecified",Da&&""!==Da?Da:"Unspecified")}initialize(){return new Promise(ya=>
{I.a.instance.Ja("Common.App.WopiIdentity.IWopiIdentity").execute(Da=>{this.Yof=Da;ya(0)})})}Gc(ya){const Da=["HTTPS:","API:"];let pa=!1;const la=ya.toLocaleUpperCase();for(const Fa of Da)if(la.startsWith(Fa)){pa=!0;break}return pa||this.rMj(ya)?ya+"/.default":ya}rMj(ya){return RegExp("/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i").test(ya)}R0c(){return Promise.resolve(0)}nV(ya,Da,pa,la,Fa,Qa,Sa){if(H.a.zFa){Fa=u.OAuthManagerSettings.bEl;if(!Fa)return Da=Object.assign(new v.a,
{IsSuccess:!1,ErrorCode:"TeamsNoAllowListFound",ErrorMessage:"No app list was found."}),Promise.resolve(Da);if(!Array.contains(Fa,ya))return Da=Object.assign(new v.a,{IsSuccess:!1,ErrorCode:"TeamsDisallowedApp",ErrorMessage:"Disallowed appName: "+ya}),Promise.resolve(Da)}ya=this.Gc(pa);pa=new E(pa,ya,!la,null,A.AFrameworkApplication.userSessionId);return this.Yof.getAccessToken(pa,Da,Sa).then(Na=>Object.assign(new v.a,{IsSuccess:!0,Token:Na.accessToken}),Na=>Object.assign(new v.a,{IsSuccess:!1,ErrorCode:Na}))}Dsd(){return Promise.resolve(Object.assign(new v.a,
{IsSuccess:!1,ErrorCode:"authTokenStrategy_loginNotSupported",ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}Fqd(){return!1}M5b(){return this.Npb}}Object(K.a)(J,"ParentFrameTokenStrategy",null,[780]);var T=d(13),D=d(453),R=d(17);class Q{constructor(){this.reject=this.resolve=null;this.startTime=0;this.ich=this.ixf=null}}Object(K.a)(Q,"PromiseWrapper",null,[]);class W{constructor(ya=0){this.VM=0;this.MUb=!1;this.ou=new R.a;this._timeout=ya}enqueue(ya){return new Promise((Da,
pa)=>{this.ou.add(Object.assign(new Q,{ich:ya,resolve:Da,reject:pa}));this.process()})}process(){if(this.MUb||this.VM===this.ou.count)return!1;const ya=this.ou.ga(this.VM++);try{this.MUb=!0,ya.ich().then(Da=>{this.MUb=!1;this.TUd(ya,Da,null,!0)}).catch(Da=>{this.MUb=!1;this.TUd(ya,null,Da,!1)})}catch(Da){this.MUb=!1,this.TUd(ya,null,Da,!1)}return!0}TUd(ya,Da,pa,la){if(la){const Fa=()=>{ya.resolve(Da);this.process()};0<this._timeout?window.setTimeout(()=>{Fa()},this._timeout):Fa()}else{const Fa=()=>
{ya.reject(pa);this.process()};0<this._timeout?window.setTimeout(()=>{Fa()},this._timeout):Fa()}}}Object(K.a)(W,"PromiseQueue",null,[]);class O{constructor(){this.correlationId=this.resolve=null}}Object(K.a)(O,"ResolveWithCorrelation",null,[]);var Y=d(1186),S=d(80),da=d(524),fa=d(124);class ka extends S.a{constructor(ya,Da,pa,la,Fa,Qa){super(!1,!1,!0);this.P8e=this.Uga=null;this.Hba=ya;this.PXh=pa;this.aF=la;this.A1h=Fa;this.h3a=Qa;this.BA=document.createElement("iframe");this.BA.id="SharedAuthInteractiveFrame";
this.BA.setAttribute("name","SharedAuthInteractiveFrame");this.BA.setAttribute("title","SharedAuthInteractiveFrame");this.BA.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms allow-popups");this.BA.style.border="0";this.BA.style.height="48px";this.BA.style.width="190px";$addHandler(this.BA,"error",Object(T.a)(this,this.etk,"onSharedAuthFrameError"));ya=String.format("{0}{1}{2}{3}{4}{5}{6}{7}{8}",this.Hba,Da,"?replyUrl=",window.location.protocol,"//",window.location.host,"&interactive=1",
"&WacUserType=",A.AFrameworkApplication.userType);this.BA.src=ya;this.pPh=new Promise(Sa=>{this.P8e=Sa});this.Q8e=!1}T5(){this.Uga={["id"]:"SharedAuthConsentDialog",["bodyControls"]:{["promptMessage"]:this.PXh,["errorText"]:CommonUIStrings.l_InternalError,["rtl"]:A.AFrameworkApplication.isRtl,["frameLoaded"]:!1,["createFrame"]:Object(T.a)(this,this.xCi,"createFrame"),["resolveDialogStyles"]:this.P8e}};this.xd=5;this.$i(CommonUIStrings.l_SignIn,Object(T.a)(this,this.gbl,"sharedAuthConsentDialogHandler"),
this.Uga)}MGh(ya=!1,Da=5){this.Uga&&this.Uga.bodyControls&&(!0!==Object(Y.a)(Object,this.Uga.bodyControls).frameLoaded&&(Object(Y.a)(Object,this.Uga.bodyControls).frameLoaded=!0),ya!==Object(Y.a)(Object,this.Uga.bodyControls).frameLoadSuccess&&(Object(Y.a)(Object,this.Uga.bodyControls).frameLoadSuccess=ya),Da!==this.Uga.dialogButtonsOption&&(this.Uga.dialogButtonsOption=null,this.xd=Da),this.update(this.Uga))}ihl(ya,Da){const pa=new da.a(fa.a.kbl);pa.Values={["signInLabel"]:CommonUIStrings.l_SignIn,
["cancelLabel"]:CommonUIStrings.l_DialogCancel,["rtl"]:A.AFrameworkApplication.isRtl,["messageCorrelationId"]:ya,["dialogStyles"]:Da};this.aF.$ib(pa,this.BA.contentWindow,this.Hba)}FVf(){this.MGh(!1,6)}get lsh(){return this.BA}get aLi(){return this.pPh.then(ya=>{this.Q8e=!0;return ya})}get bLi(){return this.Q8e}etk(){this.FVf()}xCi(){return this.BA}gbl(ya){0===ya&&(this.A1h.reject(Object.assign(new v.a,{ErrorCode:"UserCancelled",ErrorMessage:"The interactive flow was cancelled by the user"})),this.h3a(null))}}
Object(K.a)(ka,"SharedAuthConsentDialog",S.a,[802]);var ha=d(660),F=d(94),na=d(219),ba=d(63),Ea=d(104),La=d(87);class ta{constructor(){this.BA=null;this.syc=0;this.xob=this.fqb=this.pwd=this.h3a=this.AZ=this.Znf=null;this.aF=new ha.a(null,null);this.Npb="SharedAuthTokenStrategy Unloaded";this.Hba=u.OAuthManagerSettings.ibl;this.imf=u.OAuthManagerSettings.hbl;this.R9e=u.OAuthManagerSettings.enableConsoleLogging;this.YPh=A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthPopupFlashEnabled",
!1);this.R_h=A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthSkipUpnCheckEnabled",!1);this.uOa={};this.ySh=new W(1500)}M5b(){return this.Npb}initialize(){var {OAuthManager:ya}=d(538);if("loadFrame"in this.uOa)return this.uOa.loadFrame.ixf;if(!this.Hba)return F.Health.instance.recordKpiFailure(ya.kpiName,"SharedAuthFrameOriginNotSet",!1,!1,null),k.ULS.sendTraceTag(562381581,3E3,10,"SharedAuthTokenStrategy Init failed: No Shared Frame Origin Path"),Promise.reject(1);
ya=this.oqd("loadFrame");this.syc=ba.a.tj();var Da=this.Hba+this.imf+"?replyUrl="+window.location.protocol+"//"+window.location.host+"&usid="+A.AFrameworkApplication.userSessionId+"&WacUserType="+A.AFrameworkApplication.userType;this.BA=document.createElement("iframe");this.kWc(this.BA);this.BA.style.cssText="height:0;width:0;display:none;";this.BA.id="SharedAuthFrame";this.BA.setAttribute("name","SharedAuthFrame");this.BA.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms allow-popups");
this.BA.setAttribute("title","SharedAuthFrame");this.BA.src=Da;document.body.appendChild(this.BA);Da=ba.a.tj()-this.syc;k.ULS.sendTraceTag(573112899,3E3,50,"SharedAuthTokenStrategy Create: Frame Appended to Document. E/T:[{0}]. sharedAuthFrame.Src={1}",Da,this.BA.src);return ya}R0c(ya){this.pwd=ya;const Da=new da.a(fa.a.osh);Da.Values=this.Nwf(ya);ya=this.oqd("initFrame");this.aF.$ib(Da,this.BA.contentWindow,this.Hba);k.ULS.sendTraceTag(573112900,3E3,50,"SharedAuthTokenStrategy Init: Called package initialize.");
return ya}nV(ya,Da,pa,la,Fa,Qa){const Sa=new da.a(fa.a.lbl),Na=this.y3f();Sa.Values=this.fDh(ya,Da,pa,la,Fa,Qa,Na);ya=this.oqd(Na);la&&A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedAuthInteractiveConsentUI",!1)?this.ySh.enqueue(()=>new Promise(ua=>{this.bul(Qa,Sa,ua,Na)})):(this.aF.$ib(Sa,this.BA.contentWindow,this.Hba),k.ULS.sendTraceTag(573112901,3E3,50,"SharedAuthTokenStrategy TryGetToken: Called TryGetToken for app {0}",Da));return ya}bul(ya,Da,pa,la){const Fa=
this.uOa[la];Fa&&(this.fqb=Da,this.h3a=Object.assign(new O,{resolve:pa,correlationId:la}),this.AZ=new ka(this.Hba,this.imf,ya,this.aF,Fa,pa),this.AZ.T5())}y3f(){return Ea.a.create().toString()}fDh(ya,Da,pa,la,Fa,Qa,Sa){const Na={};Na.appName=ya;Na.appId=Da;Na.target=pa;Na.withPopup=la;Na.claims=Fa;Na.promptMessage=Qa;Na.messageCorrelationId=Sa;return Na}kWc(ya){$addHandler(ya,"load",Object(T.a)(this,this.rpk,"onIFrameLoaded"));$addHandler(ya,"error",Object(T.a)(this,this.ZFe,"onIFrameError"));this.aF.uBa(this.Hba);
this.aF.pu(fa.a.rsh);this.aF.zB(fa.a.rsh,Object(T.a)(this,this.zsk,"onScriptLoaded"));this.aF.pu(fa.a.qsh);this.aF.zB(fa.a.qsh,Object(T.a)(this,this.ysk,"onScriptInitialized"));this.aF.pu(fa.a.msh);this.aF.zB(fa.a.msh,Object(T.a)(this,this.Zok,"onGetTokenResponse"));this.aF.pu(fa.a.ssh);this.aF.zB(fa.a.ssh,Object(T.a)(this,this.fqk,"onLoginResponse"));this.aF.pu(fa.a.psh);this.aF.zB(fa.a.psh,Object(T.a)(this,this.Fpk,"onInteractiveFlowReady"));this.aF.pu(fa.a.nsh);this.aF.zB(fa.a.nsh,Object(T.a)(this,
this.npk,"onHideDialog"));this.aF.pu(fa.a.ksh);this.aF.zB(fa.a.ksh,Object(T.a)(this,this.Tmk,"onCloseDialog"))}oqd(ya){const Da=new Q;Da.startTime=ba.a.tj();const pa=new Promise((la,Fa)=>{Da.resolve=la;Da.reject=Fa});Da.ixf=pa;this.uOa[ya]=Da;return pa}rpk(){const ya=ba.a.tj()-this.syc;k.ULS.sendTraceTag(572346566,3E3,50,"WACOAuth.aspx iFrame loaded successfully. E/T:[{0}]",ya)}ZFe(ya){const {OAuthManager:Da}=d(538),pa=ba.a.tj()-this.syc,la=Object.assign(new La.a,{durationMs:pa});F.Health.instance.recordKpiFailure(Da.kpiName,
"SharedAuthWACOAuthAspxFrameError",!1,!0,la);k.ULS.sendTraceTag(572346567,3E3,10,"WACOAuth.aspx iFrame failed to load after {0} ms: {1}",pa,this.R9e?JSON.stringify(ya):"")}zsk(ya){const {OAuthManager:Da}=d(538),pa=this.uOa.loadFrame;var la=ba.a.tj()-pa.startTime,Fa=ya.Values.AuthLibrary.toString();ya=ya.Values.Success.toString();k.ULS.sendTraceTag(573112902,3E3,50,"SharedAuthTokenStrategy OnScriptLoaded. Success={0} AuthLibrary={1} E/T: [{2}]",ya,Fa,la);Fa&&(this.Npb="SharedAuthTokenStrategy "+Fa);
Fa=Boolean.parse(ya);Fa||(ya=na.a.Lz(),void 0!==ya&&null!==ya&&(ya.set("AuthLibrary",this.M5b()),la=Object.assign(new La.a,{durationMs:la,extendedProperties:ya}),F.Health.instance.recordKpiFailure(Da.kpiName,"SharedAuthStrategyInitFailed",!1,!0,la)));pa.resolve(Fa?0:1)}ysk(ya){if(ya.Values.interactive&&this.fqb&&this.fqb.Values.messageCorrelationId){const pa=this.fqb.Values.messageCorrelationId.toString();if(ya.Values.interactive&&this.AZ){this.AZ.aLi.then(la=>{this.aF.$ib(this.fqb,this.AZ.lsh.contentWindow,
this.Hba);this.AZ.ihl(pa,la);this.AZ.MGh(!0);this.fqb=null});return}}ya=this.uOa.initFrame;const Da=ba.a.tj()-ya.startTime;k.ULS.sendTraceTag(573112903,3E3,50,"SharedAuthTokenStrategy OnScriptInitialized. E/T: [{0}]",Da);ya.resolve(0)}Zok(ya){if(ya.Values.messageCorrelationId&&ya.Values.messageCorrelationId.toString()){var Da=ya.Values.messageCorrelationId.toString(),pa=this.uOa[Da];if(pa){var la=ba.a.tj()-pa.startTime;k.ULS.sendTraceTag(573112906,3E3,50,"SharedAuthTokenStrategy OnGetTokenResponse. E/T: [{0}]",
la);ya.Values.isSuccess&&ya.Values.isSuccess?pa.resolve(ya.Values.response):pa.reject(ya.Values.response);this.KDh(Da)}else k.ULS.sendTraceTag(573112905,3E3,10,"SharedAuthTokenStrategy OnGetTokenResponse called with an unregistered messageCorrelationId")}else k.ULS.sendTraceTag(573112904,3E3,10,"SharedAuthTokenStrategy OnGetTokenResponse called without valid messageCorrelationId")}Fpk(){if(this.AZ.bLi)this.AZ.FVf();else if(this.pwd&&this.AZ){const ya=new da.a(fa.a.osh);ya.Values=this.Nwf(this.pwd,
!0);this.aF.$ib(ya,this.AZ.lsh.contentWindow,this.Hba)}}npk(){this.AZ&&this.AZ.dbe()}Tmk(ya){ya.Values.cancelled&&ya.Values.cancelled&&ya.Values.messageCorrelationId&&this.KDh(ya.Values.messageCorrelationId.toString());this.AZ&&this.AZ.hide()}Nwf(ya,Da=!1){const pa={};pa.appIds=this.b2i();pa.upn=ya.loginHint;pa.authority=ya.authority;pa.authorityType=Object(e.a)(r,ya.authorityType);pa.tenantId=ya.tenantId;pa.correlationId=A.AFrameworkApplication.userSessionId;pa.enableConsoleLogging=this.R9e;pa.enablePopupFlash=
this.YPh;pa.skipUpnCheck=this.R_h;pa.interactive=Da;return pa}b2i(){const ya=[],Da=u.OAuthManagerSettings.hPd;for(let pa in Da)Array.add(ya,Da[pa]);return ya}Dsd(ya,Da,pa,la,Fa,Qa){const Sa=new da.a(fa.a.jbl),Na=this.y3f();Sa.Values=this.fDh(ya,Da,pa,la,Fa,Qa,Na);this.Znf=Sa;ya=this.oqd(Na);k.ULS.sendTraceTag(555049437,3E3,50,"SharedAuthTokenStrategy TryLogin: Called TryLogin for app {0}",Da);this.afl();return ya}Fqd(){return!0}afl(){this.xob||(this.xob=new D.a(CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Title,
CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Body,null),this.xob.id=16,this.xob.eje=!1,this.xob.addButton(CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Button,()=>{k.ULS.sendTraceTag(527827290,3E3,50,"SharedAuthTokenStrategy TryLogin: User Clicked Login");this.aF.$ib(this.Znf,this.BA.contentWindow,this.Hba)},CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Button,!0),A.AFrameworkApplication.Aa.hb.cFc(this.xob,!0)||k.ULS.sendTraceTag(555049438,3E3,10,"Failed to add entry to business bar. Login message could not be shown to user."))}fqk(ya){if(ya.Values.messageCorrelationId&&
ya.Values.messageCorrelationId.toString()){var Da=this.uOa[ya.Values.messageCorrelationId.toString()];if(Da){var pa=ba.a.tj()-Da.startTime;k.ULS.sendTraceTag(555049441,3E3,50,"SharedAuthTokenStrategy OnLoginResponse. E/T: [{0}]",pa);ya.Values.isSuccess&&ya.Values.isSuccess?Da.resolve(ya.Values.response):Da.reject(ya.Values.response)}else k.ULS.sendTraceTag(555049440,3E3,10,"SharedAuthTokenStrategy OnLoginResponse called with an unregistered messageCorrelationId")}else k.ULS.sendTraceTag(555049439,
3E3,10,"SharedAuthTokenStrategy OnLoginResponse called without valid messageCorrelationId")}KDh(ya){this.h3a&&this.h3a.correlationId===ya&&(this.h3a.resolve(null),this.h3a=null)}}Object(K.a)(ta,"SharedAuthTokenStrategy",null,[780]);class oa{constructor(ya){this.JHd=ya;this.Npb="UnsupportedAuthTokenStrategy Reason="+n.a[this.JHd]}initialize(){return Promise.resolve(0)}R0c(){return Promise.resolve(0)}nV(){return Promise.resolve(Object.assign(new v.a,{IsSuccess:!1,ErrorCode:n.a[this.JHd],ErrorMessage:"Unable to get a token. Reason: ["+
n.a[this.JHd]+"]"}))}Dsd(){return Promise.resolve(Object.assign(new v.a,{IsSuccess:!1,ErrorCode:"authTokenStrategy_loginNotSupported",ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}Fqd(){return!1}M5b(){return this.Npb}}Object(K.a)(oa,"UnsupportedAuthTokenStrategy",null,[780]);var wa=d(217);d.d(Z,"OAuthManager",function(){return ra});class ra{constructor(ya=null){this.C6=0;this.R1=null;this.o4a=0;const Da=ba.a.tj();this.pSh=this.AKi(ya).then(pa=>
pa?this.fBj():(k.ULS.sendTraceTag(527827277,3E3,15,"DetermineAuthLibrary failed leaving {0} in {1} ms, all future TryGetToken requests will fail.",this.RD(),Math.floor(ba.a.tj()-Da)),pa=na.a.Lz(),void 0!==pa&&null!==pa&&(pa.set("AuthLibrary",this.RD()),pa=Object.assign(new La.a,{durationMs:Math.floor(ba.a.tj()-Da),extendedProperties:pa}),F.Health.instance.recordKpiFailure(ra.kpiName,"StrategyPickFailed",!1,!0,pa)),Promise.resolve(1))).then(pa=>0!==pa?Promise.resolve(pa):this.TYj())}BKi(){var ya=u.OAuthManagerSettings.Jhk;
ya&&0<ya.length?(this.C6=1,this.R1=new C(ya)):A.AFrameworkApplication.fa.ka("IsO365ConsumerHost")||A.AFrameworkApplication.fa.ka("IsO365CommercialHost")?A.AFrameworkApplication.fa.ka("IsAnonymousUser")?(this.C6=2,this.R1=new oa(this.C6)):(ya=w.a.getAuthContext().loginHint)&&ya.length?u.OAuthManagerSettings.t$a?(this.C6=1,this.R1=new J):(this.C6=1,this.R1=new ta):(this.C6=3,this.R1=new oa(this.C6)):(this.C6=4,this.R1=new oa(this.C6))}RD(){return this.R1?this.R1.M5b()||"Unknown":"None"}AKi(ya=null){k.ULS.sendTraceTag(562128578,
3E3,50,"Creating OAuthManager.");const Da=ba.a.tj();return A.AFrameworkApplication.fa.$8i().then(pa=>{pa?(this.BKi(),ya&&(this.R1=ya),k.ULS.sendTraceTag(42084323,3E3,50,"Creation succeeded OAuthManager successfully in {4} ms with clientVer={0}, appVer={1}, docVer={2}, strategy={3}",u.OAuthManagerSettings.clientVersion,u.OAuthManagerSettings.appVersion,u.OAuthManagerSettings.kNi,this.RD(),Math.floor(ba.a.tj()-Da))):k.ULS.sendTraceTag(562128579,3E3,15,"Creation failed for OAuthManager, unable to get app settings after {0} ms, all future TryGetToken requests will fail.",
Math.floor(ba.a.tj()-Da));return Promise.resolve(pa)},()=>{k.ULS.sendTraceTag(562128580,3E3,15,"Creation failed for OAuthManager, unable to get app settings after {0} ms, all future TryGetToken requests will fail.",Math.floor(ba.a.tj()-Da));return Promise.resolve(!1)})}fBj(){k.ULS.sendTraceTag(573390991,3E3,50,"Initializing {0}",this.RD());const ya=ba.a.tj();return z.get(this.R1.initialize(),2,u.OAuthManagerSettings.nLe).then(Da=>{if(0===Da)k.ULS.sendTraceTag(42084353,3E3,50,"Initialization succeeded for {0} in {1} ms.",
this.RD(),Math.floor(ba.a.tj()-ya));else if(1===Da){k.ULS.sendTraceTag(527827291,3E3,15,"Initialization failed for {0} in {1} ms, all future TryGetToken requests will fail.",this.RD(),Math.floor(ba.a.tj()-ya));var pa=na.a.Lz();void 0!==pa&&null!==pa&&(pa.set("AuthLibrary",this.RD()),pa=Object.assign(new La.a,{durationMs:Math.floor(ba.a.tj()-ya),extendedProperties:pa}),F.Health.instance.recordKpiFailure(ra.kpiName,"StrategyInitFailed",!1,!0,pa))}else 2===Da&&(k.ULS.sendTraceTag(42267908,3E3,15,"Initialization timed out for {0} after {1} ms, all future TryGetToken requests will fail.",
this.RD(),Math.floor(ba.a.tj()-ya)),pa=na.a.Lz(),void 0!==pa&&null!==pa&&(pa.set("AuthLibrary",this.RD()),pa=Object.assign(new La.a,{durationMs:Math.floor(ba.a.tj()-ya),extendedProperties:pa}),F.Health.instance.recordKpiFailure(ra.kpiName,"StrategyInitTimedOut",!1,!0,pa)));return Promise.resolve(Da)},()=>{k.ULS.sendTraceTag(574239256,3E3,15,"Initialization failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.RD(),Math.floor(ba.a.tj()-ya));return Promise.resolve(1)})}TYj(){k.ULS.sendTraceTag(562128581,
3E3,50,"Loading {0}",this.RD());const ya=ba.a.tj();return z.get(this.R1.R0c(w.a.getAuthContext()),2,u.OAuthManagerSettings.nLe).then(Da=>{if(0===Da)k.ULS.sendTraceTag(562128582,3E3,50,"Load succeeded for {0} in {1} ms.",this.RD(),Math.floor(ba.a.tj()-ya));else if(1===Da){k.ULS.sendTraceTag(562128583,3E3,15,"Load failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.RD(),Math.floor(ba.a.tj()-ya));var pa=na.a.Lz();void 0!==pa&&null!==pa&&(pa.set("AuthLibrary",this.RD()),pa=Object.assign(new La.a,
{durationMs:Math.floor(ba.a.tj()-ya),extendedProperties:pa}),F.Health.instance.recordKpiFailure(ra.kpiName,"StrategyLoadFailed",!1,!0,pa))}else 2===Da&&(k.ULS.sendTraceTag(558469660,3E3,15,"Load timed out for {0} after {1} ms, all future TryGetToken requests will fail.",this.RD(),Math.floor(ba.a.tj()-ya)),pa=na.a.Lz(),void 0!==pa&&null!==pa&&(pa.set("AuthLibrary",this.RD()),pa=Object.assign(new La.a,{durationMs:Math.floor(ba.a.tj()-ya),extendedProperties:pa}),F.Health.instance.recordKpiFailure(ra.kpiName,
"StrategyLoadTimedOut",!1,!0,pa)));return Promise.resolve(Da)},()=>{k.ULS.sendTraceTag(562128584,3E3,15,"Load failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.RD(),Math.floor(ba.a.tj()-ya));return Promise.resolve(1)})}nV(ya,Da,pa=null){return this.bOb(ya,Da,!1,null,"",pa)}gDh(ya,Da,pa,la,Fa=null){return this.bOb(ya,Da,!0,pa,la,Fa)}bOb(ya,Da,pa,la,Fa,Qa,Sa=0){Sa+=1;k.ULS.sendTraceTag(42084352,3E3,50,"OAuthManager TryGetToken(appName={0}, target={1}) called.  Using strategy {2} - attempt {3}",
ya,this.Mib(ya,Da),this.RD(),Sa);var Na=na.a.Lz();void 0!==Na&&null!==Na&&(Na.set("AuthLibrary",this.RD()),Na.set("AppName",ya),Na.set("Target",this.Mib(ya,Da)),F.Health.instance.recordKpiUsage(ra.kpiName,0,"WacOAuthFC",Na));if(!u.OAuthManagerSettings.isEnabled){var ua;return this.Rme((ua=new v.a,ua.IsSuccess=!1,ua.Token=null,ua.ErrorCode="NotEnabled",ua.ErrorMessage="OAuthManager is disabled.",ua),ya)}const za=u.OAuthManagerSettings.hPd[ya];if(void 0===za||null===za){k.ULS.sendTraceTag(41961345,
3E3,15,"Auth context not found. Ensure that your app [{0}] is listed in the OAuthManagerApplications setting.",ya);var Wa;return this.Rme((Wa=new v.a,Wa.IsSuccess=!1,Wa.Token=null,Wa.ErrorCode="DisallowedApp",Wa.ErrorMessage="Disallowed appName: "+ya,Wa),ya)}const yb=ba.a.tj(),Za=this;Na=this.pSh.then(Hc=>Za.FGj(ya,za,Da,pa,la,Fa,Qa,Hc));ua=pa?0:u.OAuthManagerSettings.nLe;let ub;Wa=(ub=new v.a,ub.IsSuccess=!1,ub.Token=null,ub.ErrorCode="authTokenStrategy_timeout",ub.ErrorMessage="Auth Strategy timed out after ["+
ua+"] ms when fetching token",ub);let Ib=this,Ob=this;return z.get(Na,Wa,ua).then(Hc=>Sa<=ra.vgk&&(Hc.ErrorCode===ra.oBh||Hc.ErrorCode===ra.Sll)?(k.ULS.sendTraceTag(573175516,3E3,50,"TryGetToken attempt {0} timed out after {1} ms - retrying",Sa,Math.floor(ba.a.tj()-yb)),Ib.bOb(ya,Da,pa,la,Fa,Qa,Sa)):Hc.ErrorCode===ra.Flg&&!pa&&(k.ULS.sendTraceTag(561517645,3E3,50,"TryGetToken attempt {0} failed with ITP error.  3P Cookies are [{1}]. Retry: [{2]}]",Sa,ra.hPf),ra.xPi&&Ib.R1.Fqd()&&Ib.R1.Dsd(ya,za,Da,
pa,la,Fa).then(kb=>Promise.resolve(Ib.f1c(kb,ya,Da,za,yb))).catch(()=>{let kb;const jb=(kb=new v.a,kb.IsSuccess=!1,kb.Token=null,kb.ErrorCode="authTokenStrategy_failure",kb.ErrorMessage="LoginPopup failed, GetToken could not be called",kb);return Promise.resolve(Ib.f1c(jb,ya,Da,za,yb))}),ra.hPf)?Ib.bOb(ya,Da,!0,la,Fa,Qa,Sa):Promise.resolve(Ib.f1c(Hc,ya,Da,za,yb))).catch(()=>{let Hc;const kb=(Hc=new v.a,Hc.IsSuccess=!1,Hc.Token=null,Hc.ErrorCode="authTokenStrategy_failure",Hc.ErrorMessage="Auth Strategy failed with an unknown error",
Hc);return Promise.resolve(Ob.f1c(kb,ya,Da,za,yb))})}FGj(ya,Da,pa,la,Fa,Qa,Sa,Na){return 1===Na||2===Na?this.Rme(Object.assign(new v.a,{IsSuccess:!1,Token:null,ErrorCode:1===Na?"InitFailed":"InitTimedOut",ErrorMessage:"Auth Strategy Failed to Init or Load"}),ya):this.R1.nV(ya,Da,pa,la,Fa,Qa,Sa).then(ua=>Promise.resolve(this.z_g(ua,!0,ya))).catch(ua=>Promise.resolve(this.z_g(ua,!1,ya)))}f1c(ya,Da,pa,la,Fa){const Qa={};Fa=ba.a.tj()-Fa;Qa.IsSuccess=ya.IsSuccess;Qa.ErrorCode=ya.IsSuccess?"Success":ya.ErrorCode||
"";Qa.ErrorMessage=ya.IsSuccess?"Success":this.Mib(Da,ya.ErrorMessage||"");Qa.Target=this.Mib(Da,pa||"");Qa.TimeInMS=Math.floor(Fa);Qa.AuthLibrary=this.RD();Qa.AppName=Da;Qa.AuthorityType=Object(e.a)(r,w.a.xQc());Qa.UserType=this.mmj(w.a.getAuthContext());Qa.IsAuthSupportedInSession=n.a[this.C6];Qa.RequestCount=++this.o4a;Qa.AppId=la;k.ULS.sendTraceTag(593863640,3E3,50,JSON.stringify(Qa));ya.IsSuccess||(pa=na.a.Lz(),void 0!==pa&&null!==pa&&(pa.set("AppName",Da),pa.set("AuthLibrary",this.RD()),pa.set("ErrorCode",
ya.ErrorCode),pa.set("ErrorMessage",this.Mib(Da,ya.ErrorMessage)),Da=Object.assign(new La.a,{durationMs:Fa,extendedProperties:pa}),F.Health.instance.recordKpiFailure(ra.kpiName,"TryGetTokenFailure",!1,!0,Da)));return ya}Rme(ya,Da){k.ULS.sendTraceTag(578435090,3E3,15,"OAuthManager failed without invoking GetToken. AppName: '{0}', Reason: '{1}'",Da,this.Mib(Da,ya.ErrorMessage));const pa=na.a.Lz();void 0!==pa&&null!==pa&&(pa.set("AppName",Da),pa.set("AuthLibrary",this.RD()),pa.set("ErrorCode",ya.ErrorCode),
pa.set("ErrorMessage",this.Mib(Da,ya.ErrorMessage)),Da=Object.assign(new La.a,{extendedProperties:pa}),F.Health.instance.recordKpiFailure(ra.kpiName,"FailureBeforeGetToken",!1,!0,Da));return Promise.resolve(ya)}Agg(ya){return ya===wa.a.Erd}Mib(ya,Da){return this.Agg(ya)&&Da?"REDACTED":Da}mmj(ya){return A.AFrameworkApplication.fa.ka("IsAnonymousUser")?"anonymous":!ya.loginHint||1>ya.loginHint.length?"empty":-1<ya.loginHint.indexOf("guest#")?"guest":-1<ya.loginHint.indexOf("ext#")?"external":0>ya.upn.indexOf("@")?
"no-at":"supported"}PHj(){return 1===this.C6}z_g(ya,Da,pa){let la=null,Fa=null,Qa=null,Sa=null;ya?ya.ErrorCode||ya.ErrorMessage?(Fa=ya.ErrorCode?ya.ErrorCode:ra.bRf,Qa=ya.ErrorMessage?ya.ErrorMessage:"No message"):ya.Token?Da?la=ya.Token:(Fa=ra.XQk,Qa="A rejected promise returned a token."):(Fa=ra.bRf,Qa=JSON.stringify(ya)):(Fa=ra.yjk,Qa="No result came from Auth Token Strategy");ya&&ya.Telemetry&&!this.Agg(pa)&&(Sa=ya.Telemetry,k.ULS.sendTraceTag(579166408,3E3,50,JSON.stringify(Sa)));if(Fa===ra.Xhk||
Fa===ra.brl)Fa=ra.oBh,Qa="Auth Library Timed Out";Fa===ra.Wfi&&-1<Qa.indexOf(ra.R2h)&&(Fa=ra.Flg);if(Fa||Qa)la=null;return Object.assign(new v.a,{IsSuccess:!!la,Token:la,ErrorCode:Fa,ErrorMessage:Qa,Telemetry:Sa})}static get hPf(){return A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthInteractiveFallbackEnabled",!1)}static get xPi(){return A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthLoginFlowEnabled",!1)}}ra.brl="token_renewal_error";
ra.bRf="Exception";ra.yjk="NoResult";ra.XQk="RejectToken";ra.Xhk="monitor_window_timeout";ra.oBh="Timeout";ra.Sll="authTokenStrategy_timeout";ra.Wfi="login_required";ra.R2h="AADSTS50058";ra.Flg="Cookies Disabled";ra.kpiName="OAuthManager";ra.vgk=2;Object(K.a)(ra,"OAuthManager",null,[670])},682:function(K,Z,d){d.d(Z,"a",function(){return z});K=d(0);var k=d(1186),e=d(13),n=d(102),r=d(35),v=d(26),C=d(443),w=d(114);class z{constructor(A,u,E,H,I,J){this.b4a=this.sGa=null;this.fr=Object(k.a)(C.a,H.bXd(A,
u,E,Object(e.a)(this,this.WC,"onPointerOver"),Object(e.a)(this,this.pz,"onPointerOut"),I));this.xHa=0;this.Oc=J;this.Oc.GA(Object(e.a)(this,this.vB,"onSessionEnd"));this.clear()}dispose(){this.fr.dispose();this.sGa=null}get ofa(){return this.b4a}setZIndex(A){this.fr.setZIndex(A)}orf(A,u,E){this.b4a=A;this.sGa=u;this.fr.ynd("UnreadNotification_16x16x32",this.ofa,E)}clear(){this.fr.clear();this.b4a=w.a.none}zya(){this.q_();this.fr.E5a(this.ofa,this.J1b);this.fr.Yhc()}q_(){this.fr.Psb();this.fr.TJb()}vB(){v.a.J(39068559,
804,15,"Canvas shape highlights pawn hovered count: {0};",this.xHa);0<this.xHa&&n.c(r.a.XSd)}get J1b(){return this.sGa?this.sGa():""}WC(){this.zya();v.a.J(23606147,804,50,"Shape revision tracking pawn hovered");this.xHa+=1;return!0}pz(){this.q_();return!0}}Object(K.a)(z,"ShapeRevisionTrackingPawn",null,[256])},683:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);var k;(function(e){e[e.unknown=0]="unknown";e[e.supported=1]="supported";e[e.userUnsupportedAnonymous=2]="userUnsupportedAnonymous";
e[e.userUnsupportedNoLoginHint=3]="userUnsupportedNoLoginHint";e[e.hostUnsupported=4]="hostUnsupported"})(k||(k={}));Object(K.b)("SupportStatus",k)},684:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k{constructor(e,n,r,v,C,w,z,A=null,u=null,E=!1,H=null,I=null,J=null,T=null,D=!1,R=null,Q=null,W=null,O=null,Y=null,S=null){this.url=e;this.iDl=n;this.body=r;this.headers=v;this.ZVe=C;this.priority=w;this.state=z;this.QIh=A;this.Ync=u;this.Oi=E;this.gIk=H;this.B3k=I;this.name=J;this.UGb=
T;this.j3d=D;this.LHe=R;this.Py=Q;this.iyb=W;this.QJb=O;this.fyj=Y;this.responseType=S}}Object(K.a)(k,"ClientRequest",null,[])},685:function(K,Z,d){d.d(Z,"a",function(){return e});K=d(0);Z=d(514);var k=d(127);class e extends Z.a{constructor(){super();this.H_=Object.assign(new k.a,{T_:e.getTypeName(),B_:e.getBaseTypes()})}static getTypeName(){return"AugLoop_Core_UpdateOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}}Object(K.a)(e,"UpdateOperation",Z.a,[])},717:function(K,Z,d){K=d(0);
class k{}Object(K.a)(k,"AuthContext",null,[]);var e=d(25),n=d(224);d.d(Z,"a",function(){return r});class r{static getAuthContext(){const v=e.AFrameworkApplication.fa.Ha("UserPrincipalName")||"";let C=v;e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthLoginHintEnabled",!1)&&(C=n.OAuthManagerSettings.Tkk||v);return Object.assign(new k,{upn:v,loginHint:C,authority:n.OAuthManagerSettings.authority,authorityType:r.xQc(),tenantId:e.AFrameworkApplication.fa.Ha("TenantId")||
""})}static xQc(){let v=0;const C=r.BXf();"aad"===C.toLowerCase()?v=2:"msa"===C.toLowerCase()&&(v=1);return v}static BXf(){return e.AFrameworkApplication.fa.Ha("HostAuthType")||""}}Object(K.a)(r,"OAuthIdentity",null,[])},727:function(K,Z,d){K=d(0);var k=d(25),e=d(104),n=d(79),r=d(13),v=d(33),C=d(85),w=d(26),z=d(259);class A{constructor(){this.TenantId=this.LoggableUserId=this.FileSource=this.ProviderId=this.UserId=this.UserName=null;this.EnableMacrosForProtectedFile=this.BrowserCacheAllowed=!1;this.ComplianceDomainPrefix=
this.ServerDocId=null;this.IsCLPCoauthoringEnabled=this.IsO365CommercialHost=this.IsO365ConsumerHost=!1}}Object(K.a)(A,"PodsInfo",null,[]);d.d(Z,"a",function(){return u});class u{constructor(E,H,I,J,T,D,R){w.a.J(512262873,804,50,"Start PodsInfoSender::PodsInfoSender()");this.Yb=R;this.tw=E;this.Xa=H;this.Oc=I;this.hz=J;this.Qd=T;this.zb=D;this.pCb=!1;this.kXa=0;this.Yb.jf(Object(r.a)(this,this.initialize,"initialize"))}initialize(){w.a.J(512262872,804,50,"Start PodsInfoSender::Initialize()");this.sendInfoToPods(null);
this.Oc.WB(Object(r.a)(this,this.Bo,"onSessionRehydrated"));this.hz.Fqb(Object(r.a)(this,this.gfa,"onPodSessionRefreshed"));this.pCb=!0}dispose(){this.pCb&&(this.Oc.Dfa(Object(r.a)(this,this.Bo,"onSessionRehydrated")),this.hz.hib(Object(r.a)(this,this.gfa,"onPodSessionRefreshed")),this.pCb=!1)}sendInfoToPods(){var E=this.Yb.Ha("361"),H=this.Xa.podSessionId;const I=this.Xa.nk,J=k.AFrameworkApplication.userSessionId,T=e.a.create().toString();w.a.J(512262871,804,50,"PodsInfoSender.SendInfoToPods: Send user info to Pods, correlation={0}",
T);E=String.format("{0}PodHandler.ashx?action=SendUserInfo&PodSID={1}",E,H);H={"Content-Type":"application/json; charset=utf-8",WaitForSessionTimeoutMs:"0"};H["X-UserSessionId"]=J;H["X-CorrelationID"]=T;H["X-WacCluster"]=I;try{const D=Object.assign(new A,{UserName:this.Yb.Ha(C.a.oxk),UserId:this.Yb.Ha("387"),ProviderId:this.Yb.Ha("388"),FileSource:this.Yb.Ha("FileSource"),LoggableUserId:this.Yb.Ha("LoggableUserId"),TenantId:this.Yb.Ha("TenantId"),BrowserCacheAllowed:this.Yb.ka("535")&&this.Yb.ka("431"),
EnableMacrosForProtectedFile:k.AFrameworkApplication.y2b,ServerDocId:this.Yb.Ha("ServerDocId"),ComplianceDomainPrefix:k.AFrameworkApplication.fa.Ha("ComplianceDomainPrefix"),IsO365CommercialHost:this.Yb.ka("IsO365CommercialHost"),IsO365ConsumerHost:this.Yb.ka("IsO365ConsumerHost"),IsCLPCoauthoringEnabled:this.Yb.ka("PPTClpSwitchEnabled")&&this.Yb.ka("SupportsOfficeClientCoauthoring")}),R=v.c(D);this.tw.Aj(E,2,R,H,!1,1,Object(r.a)(this,this.Gsk,"onSendUserInfoSucceeded"),Object(r.a)(this,this.Fsk,
"onSendUserInfoFailed"),null,void 0,void 0,void 0,void 0,z.a("6"))}catch(D){w.a.J(512262870,804,15,"PodsInfoSender.SendInfoToPods: error serializing user info {0}",D)}}Gsk(){w.a.J(512262869,804,50,"PodsInfoSender.OnSendUserInfoSucceeded");this.kXa=0}Fsk(){w.a.J(512262868,804,50,"PodsInfoSender.OnSendUserInfoFailed");3>this.kXa?this.rZk():this.Pnj()}rZk(){this.kXa++;w.a.J(512262867,804,50,"PodsInfoSender.RetryRequestOnFailure: Request failed - retrying (failures count: {0})",this.kXa);const E=new n.a(1,
1,5E3,Object(r.a)(this,this.sendInfoToPods,"sendInfoToPods"),90,"22");this.zb.Eb(E)}Pnj(){w.a.J(512262866,804,15,"PodsInfoSender.GiveUp: Request failed - giving up (failures count: {0})",this.kXa);this.Qd.YG(307,null);this.kXa=0}Bo(){this.kXa=0;w.a.J(512262865,804,50,"PodsInfoSender.OnSessionRehydrated");this.sendInfoToPods(null)}gfa(){this.kXa=0;w.a.J(512262864,804,50,"PodsInfoSender.OnPodSessionRefreshed");this.sendInfoToPods(null)}}Object(K.a)(u,"PodsInfoSender",null,[])},957:function(K,Z,d){d.d(Z,
"a",function(){return k});K=d(0);class k{constructor(){this.message=this.title=null;this.g$f=!1;this.aIb=null;this.l$f=!1;this.amd=null;this.F1k=this.zEk=0;this.G1k=this.AEk=null;this.timeoutInSeconds=0}}Object(K.a)(k,"CalloutNotificationMessageAttributes",null,[])},958:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k{constructor(){this.handler=null}}Object(K.a)(k,"SetAnnotationResultCallbackParameters",null,[])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/18430998/wdjs/ppteditDS.chronosslim.js.map