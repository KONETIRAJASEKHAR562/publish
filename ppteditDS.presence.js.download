'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[11],{1231:function(K,Z,d){d.r(Z);K=d(0);var k=d(13);class e{constructor(Xa,Lb){this.vOa=null;this.PUb=Xa;this.xXh=Lb}init(){this.PUb.continueWith(()=>{this.vOa=this.PUb.result;this.vOa.Jqb(Object(k.a)(this,this.O0,"onUsersUpdated"))})}O0(){e.Yvf(this.vOa.P8a())&&(this.vOa.wPe(Object(k.a)(this,this.O0,"onUsersUpdated")),this.xXh.IsRealCoauthSession=!0)}static Yvf(Xa){let Lb=null;for(const pc of Xa)if(pc)if(Xa=pc.isAnonymous||
!pc.email?pc.clientId:pc.email.toUpperCase(),!Lb)Lb=Xa;else if(Lb!==Xa)return!0;return!1}}Object(K.a)(e,"CoauthTelemetry",null,[1284]);var n=d(382),r=d(1047),v=d(1186),C=d(25),w;(function(Xa){Xa[Xa.badStatePreventedTelemetry=0]="badStatePreventedTelemetry";Xa[Xa.notImplemented=1]="notImplemented";Xa[Xa.renderHandled=2]="renderHandled";Xa[Xa.renderHandledWithVeto=3]="renderHandledWithVeto"})(w||(w={}));Object(K.b)("CoauthorGalleryTelemetryEndResult",w);var z=d(94),A=d(103),u=d(2);class E{constructor(Xa,
Lb,pc,fc,bd,od,ye,pd,ab){this.Uif=this.B7e=this.wK=null;this.lpa=Xa;this.jDc=new r.a;this.$a=pc;this.Exd=Lb;this.Gga=fc;this.oi=bd;this.VGd=od;this.qOa=ye;this.yMh=pd;this.$af=this.Xaf=!1;this.UDc=0;this.y7e=1;this.S1a=ab;this.$Wb=this.$a.ka("PeoplesWellExtraButtonInfoIsEnabled");this.lmb=Object(v.a)(String,C.AFrameworkApplication.gd.Application)||""}get Mxh(){return this.jDc.task}init(){u.Task.WAA.call(null,this.qOa,this.Exd,this.VGd).continueWith(()=>{this.wK=this.qOa.result;this.B7e=this.Exd.result;
this.Uif=this.VGd.result;u.Task.WAA.call(null,this.Exd.result.hCa,this.VGd.result.Lrd).continueWith(()=>{this.y7e=this.B7e.hCa.result;this.UDc=this.Uif.Lrd.result;this.wK.Jqb(Object(k.a)(this,this.wfd,"onUsersUpdatedEventListener"));this.wK.P8a().length&&this.O0()})})}wfd(){this.O0()}O0(){this.yMh(this.wK.P8a())?(this.wK.wPe(Object(k.a)(this,this.wfd,"onUsersUpdatedEventListener")),this.wok(this.Xaf)):this.jDc.HM(1);this.Xaf=!0}wok(Xa){this.$af?this.Mxh.continueWith(()=>{n.ULS.sendTraceTag(42062996,
325,15,"We already attempted to log a render of coauthor gallery: {0}",w[this.Mxh.result])}):(this.$af=!0,this.TFk(0===this.y7e&&!Xa))}TFk(Xa){Xa?this.Gga.Dk(4,Object(k.a)(this,this.gGe,"onInteractiveReady")):this.jDc.HM(1)}gGe(){const Xa=this.oi.ah("AppInitStatus_interactivityReady");n.ULS.shipAssertTag(42259235,325,!!this.UDc);const Lb=this.UDc-Xa,pc={};pc.InteractiveTime=Xa;pc.ReactRenderComplete=this.UDc;pc.HadTabSwitch=this.S1a();pc.IsModernGallery=this.$Wb;n.ULS.sendTraceTag(594883104,325,50,
A.a.toJSON(pc));this.$Wb?(n.ULS.sendTraceTag(42062997,325,15,Lb.toString()),this.jDc.HM(this.qDl(Lb)?3:2)):n.ULS.sendTraceTag(594883103,325,15,Lb.toString())}qDl(Xa){const Lb=Xa>this.$a.Fc("CoauthorGalleryTimeToRenderDurationMs",1E4),pc="Word"===this.lmb;if(this.S1a())return n.ULS.sendTraceTag(50455714,325,50,Lb.toString()),!1;pc&&z.Health.instance.recordKpiUsage("CoauthGalleryExperienceDegraded",0,"wordcollabrel",null);Lb&&(pc&&z.Health.instance.recordKpiFailure("CoauthGalleryExperienceDegraded",
"CoauthorGalleryTimeToRenderDurationIsTooLong",!1,!0,null),n.ULS.sendTraceTag(42062998,325,15,Xa.toString()));return Lb}}Object(K.a)(E,"CoauthorGalleryTelemetry",null,[1283]);class H{constructor(Xa){this.wK=null;this.Qvc={};this.rBc={};this.ASb=null;this.qOa=Xa}TSc(Xa){const Lb=new r.a;this.init().continueWith(()=>{Xa in this.Qvc?Lb.HM(this.Qvc[Xa]):this.rBc[Xa]=Lb});return Lb.task}init(){if(this.ASb)return this.ASb.task;this.ASb=new r.a;this.qOa.continueWith(()=>{this.wK=this.qOa.result;this.wK.Jqb(Object(k.a)(this,
this.O0,"onUsersUpdated"));this.IGh();this.ASb.Fg(null)});return this.ASb.task}IGh(){const Xa=this.wK.P8a();Xa.sort(Object(k.a)(this,this.cvi,"comparePresenceUsers"));this.Qvc={};for(let Lb=0;Lb<Xa.length&&Xa[Lb]&&Xa[Lb].AFa;Lb++)this.a6h(this.Qvc,Xa[Lb].clientId,Lb)}a6h(Xa,Lb,pc){Xa[Lb]=pc;Lb in this.rBc&&(this.rBc[Lb].HM(pc),delete this.rBc[Lb])}O0(){this.IGh()}cvi(Xa,Lb){return Xa.AFa>Lb.AFa?1:Xa.AFa<Lb.AFa?-1:0}}Object(K.a)(H,"CoauthorPositionFinder",null,[1282]);var I=d(1189),J=d(1188),T=d(1187),
D=d(17),R=d(104);class Q{constructor(){this.Yha=null;this.QPb=Array(32)}xor(Xa){if(!Xa)throw Error.argumentNull("Guid argument cannot be null");const Lb=new Q,pc=new Sys.StringBuilder;for(let fc=0;fc<Xa.QPb.length;fc++){const bd=this.QPb[fc]^Xa.QPb[fc];Lb.QPb[fc]=bd;pc.append(bd.toString(16));7!==fc&&11!==fc&&15!==fc&&19!==fc||pc.append("-")}Lb.Yha=R.a.Hf(pc.toString());return Lb}toString(){return this.Yha.toString()}equals(Xa){if(!Xa)throw Error.argumentNull("Guid argument cannot be null");return this.Yha.equals(Xa.Yha)}static $Pc(Xa){if(!Xa)throw Error.argumentNull("String input cannot be null");
const Lb=new Q;Lb.Yha=R.a.Hf(Xa);const pc=Lb.Yha.toString();let fc=0;for(let od=0;od<pc.length;od++){var bd=Xa.charAt(od);if(Q.AMj(bd))bd=Q.Axj(bd,Xa.charCodeAt(od)),Lb.QPb[fc++]=bd;else if(!Q.VLj(bd))throw Error.argument("String contains characters not valid in Guids");}return Lb}static AMj(Xa){return"0"<=Xa&&"9">=Xa||"A"<=Xa&&"F">=Xa||"a"<=Xa&&"f">=Xa}static VLj(Xa){return"{"===Xa||"}"===Xa||"-"===Xa}static Axj(Xa,Lb){if("0"<=Xa&&"9">=Xa)return Lb-48;if("A"<=Xa&&"F">=Xa)return Lb-65+10;if("a"<=
Xa&&"f">=Xa)return Lb-97+10;throw Error.argument("Char is not valid hex digit");}}Object(K.a)(Q,"Guid",null,[]);class W{constructor(Xa,Lb,pc,fc){this.vOa=null;this.r8e=this.Ygf=!1;this.lff=0;this.PUb=Xa;this.AKd=Lb;this.$a=pc;this.jFd=fc;this.gMh=C.AFrameworkApplication.Alb||C.AFrameworkApplication.LQ;this.Vff=new I.a(J.a.jp())}get TXd(){return this.$a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IsCustomAnonymousNameEnabled",!1)}init(){this.PUb.continueWith(()=>{this.vOa=this.PUb.result;
this.vOa.Jqb(Object(k.a)(this,this.O0,"onUsersUpdated"))})}O0(){this.eui(this.vOa.P8a())}eui(Xa){var Lb=0;const pc=new T.a(J.a.jp());for(const fc of Xa)if(fc&&fc.isAnonymous){C.AFrameworkApplication.PFa("70eb6120;2gfeb930");if(pc.Hb(fc.userName))pc.ga(fc.userName).add(fc.clientId);else{let bd;pc.add(fc.userName,(bd=new D.a,bd.add(fc.clientId),bd))}fc.clientId!==this.jFd?(Lb++,2<=Lb&&!this.Ygf&&this.z1j()):!this.r8e&&this.TXd&&"Guest"===fc.userName&&(n.ULS.sendTraceTag(509726851,302,50,"User was assigned 'Guest' name"),
this.r8e=!0)}if(this.TXd&&this.lff!==Lb){n.ULS.sendTraceTag(512553562,302,50,"Total guests updated to: {0}",Lb+(this.gMh?1:0));this.lff=Lb;for(let fc of pc.keys)2<=pc.ga(fc).count&&(Xa=this.p7i(pc.ga(fc)),this.Vff.contains(Xa)||(Lb={},Lb.guestsWithSameName=pc.ga(fc).count,Lb.identifier=Xa,n.ULS.sendTraceTag(526394833,302,50,"Duplicate guest friendly name detected: {0}",Lb),this.Vff.add(Xa)))}}z1j(){n.ULS.sendTraceTag(525112603,302,50,"Multiple guests simultaneously coauthoring");this.Ygf=!0;this.TXd&&
this.AKd&&this.AKd.continueWith(()=>{window.setTimeout(()=>{this.AKd.result.logActivity("MultipleGuestsCoauthoring",null)},15E3)})}p7i(Xa){if(!Xa||1>=Xa.count)return"";let Lb=Q.$Pc(Xa.ga(0));for(let pc=1;pc<Xa.count;pc++)Lb=Lb.xor(Q.$Pc(Xa.ga(pc)));return Lb.toString()}}Object(K.a)(W,"GuestCoauthTelemetry",null,[]);var O=d(1185);class Y{constructor(){this.id=null;this.d=this.tp=this.mp=this.st=this.et=0;this.ct=null;this.vc=!1}}Object(K.a)(Y,"PL",null,[]);var S=d(33);class da{constructor(){this.ct=
this.vt=this.d=0}static uoh(Xa,Lb,pc){const fc=new da;fc.d=Xa;fc.vt=Lb;fc.ct=pc;return S.c(fc)}}Object(K.a)(da,"VD",null,[]);var fa=d(87);class ka{constructor(Xa,Lb,pc,fc,bd,od,ye,pd,ab){this.bmf=!1;this._id=Xa;this.Jj=Lb;this.At=pc;this.kFd=fc;this.aLd=bd;this.q5a=od;this.n2a=ye;this.ONh=pd;this.S1a=ab;this.lmb=Object(v.a)(String,C.AFrameworkApplication.gd.Application)||""}qud(Xa){u.Task.WAA(this.kFd,this.aLd).continueWith(()=>{if(this.kFd.result<=this.aLd.result)Xa.HM(!1);else{var Lb=this.At-this.Jj,
pc=new Y;pc.id=this._id;pc.et=this.At;pc.st=this.Jj;pc.d=this.At-this.Jj;pc.mp=this.kFd.result;pc.tp=this.aLd.result;pc.ct=this.N3i(this.ONh);pc.vc=this.S1a();var fc=S.c(pc),bd="Word"===this.lmb;n.ULS.sendTraceTag(42078597,302,15,fc);if(bd){const od=new Map;od.set("data",fc);z.Health.instance.recordKpiUsage("PresenceExperienceDegraded",0,"wordcollabrel",od)}Lb>this.q5a.value&&!this.bmf&&!pc.vc&&(this.bmf=!0,Xa.HM(!0),pc=Object.assign(new fa.a,{inStaging:!0,extendedProperties:new Map}),pc.extendedProperties.set("data",
fc),bd&&z.Health.instance.recordKpiFailure("PresenceExperienceDegraded","PresenceRenderDurationIsTooLong",!1,!0,pc),Lb<this.n2a.value&&n.ULS.sendTraceTag(42078598,302,15,da.uoh(Lb,this.q5a.value,this.n2a.value)));Xa.task.isCompleted||Xa.HM(!1)}})}N3i(Xa){switch(Xa){case 2:return"NonWac";case 0:return"Unknown";case 1:return"Wac";default:return"Unknown"}}}Object(K.a)(ka,"PresenceLatencyActivityLogger",null,[]);class ha{constructor(Xa,Lb,pc){this.X6e=this.x7e=this.Evc=this.Pvc=this.gmb=0;this._id=Xa;
this.q5a=Lb;this.n2a=pc;this.lmb=Object(v.a)(String,C.AFrameworkApplication.gd.Application)||""}get Ftf(){return this.gmb}set Ftf(Xa){this.gmb=Xa;this.pTd()}get lEf(){return this.Pvc}set lEf(Xa){this.Pvc=Xa;this.pTd()}get ABf(){return this.Evc}set ABf(Xa){this.Evc=Xa;this.pTd()}get mEf(){return 0!==this.x7e}get BBf(){return 0!==this.X6e}pTd(){!this.mEf&&this.gmb&&this.Pvc&&(this.x7e=this.qud(this.Pvc,"CoauthGalleryLightupDurationTooLong"));!this.BBf&&this.gmb&&this.Evc&&(this.X6e=this.qud(this.Evc,
"CanvasPresenceLightupDurationTooLong"))}qud(Xa,Lb){const pc=Xa-this.gmb;var fc=new Y;fc.id=this._id;fc.et=Xa;fc.st=this.gmb;fc.d=pc;var bd=S.c(fc);Xa="Word"===this.lmb;fc="CanvasPresenceLightupDurationTooLong"===Lb?"PresenceExperienceDegraded":"CoauthGalleryExperienceDegraded";"CanvasPresenceLightupDurationTooLong"===Lb?n.ULS.sendTraceTag(572289499,302,15,bd):n.ULS.sendTraceTag(571524118,302,15,bd);if(Xa){var od=new Map;od.set("data",bd);z.Health.instance.recordKpiUsage(fc,0,"wordcollabrel",od)}return pc>
this.q5a.value?(od=Object.assign(new fa.a,{inStaging:!0,extendedProperties:new Map}),od.extendedProperties.set("data",bd),bd=pc<this.n2a.value,od.extendedProperties.set("cash",bd?"true":"false"),Xa&&z.Health.instance.recordKpiFailure(fc,Lb,!1,!0,od),n.ULS.sendTraceTag(572289500,302,15,da.uoh(pc,this.q5a.value,this.n2a.value)),bd?2:1):3}}Object(K.a)(ha,"PresenceLightupLatencyLogger",null,[]);var F=d(285),na=d(279);class ba{constructor(Xa,Lb,pc,fc,bd,od,ye=null,pd=null,ab=null){this.Cjf={};this.Dxd=
{};this.pef=new D.a;this.BSb=this.wK=this.ACc=null;this.Tmf=this.Smf=0;this.q5a=new O.a(()=>ye.oQ("PresenceBootLatencyThreshold",1E4));this.n2a=new O.a(()=>ye.oQ("PresenceBootLatencyCutoffThreshold",6E4));this.t2h=new O.a(()=>ye.oQ("PresenceLightupLatencyThreshold",2E3));this.WOh=new O.a(()=>ye.oQ("PresenceLightupLatencyCutoffThreshold",1E4));this.AXh=fc;this.z7e=Xa;this.glf=Lb;this.qOa=pc;this.oi=bd;this.jFd=pd;this.S1a=od;this.bbf=ab;this.q6e=!1;this.init()}$Pi(Xa,Lb=0){var pc=new Date;const fc=
new r.a;this.init().continueWith(()=>{this.vrk(Xa);this.aQi(fc,Xa,pc,Lb)})}get OZg(){return this.jFd||"{"+C.AFrameworkApplication.userSessionId+"}"}init(){if(this.BSb)return this.BSb.task;this.BSb=new r.a;this.S1a()&&n.ULS.sendTraceTag(50951700,302,15,"TabSwitched Session");this.z7e.continueWith(()=>{const Xa=this.z7e.result,Lb=Xa.hCa,pc=Xa.Zbd;pc.continueWith(()=>{Lb.continueWith(()=>{this.bbf&&this.bbf.addQosPillar("RealTimeCoauth");this.hll(Lb.result,pc.result);this.BSb.Fg(null)})})});this.glf.continueWith(()=>
{this.ACc=this.glf.result;this.ACc.K5a(Object(k.a)(this,this.lsk,"onRtcConnection"));this.ACc.FBa(Object(k.a)(this,this.Zmk,"onCoauthorBootReceived"))});this.qOa.continueWith(()=>{this.wK=this.qOa.result;this.wK.Jqb(Object(k.a)(this,this.wfd,"onUsersUpdatedEventListener"));0<this.wK.P8a().length&&this.O0()});return this.BSb.task}zYf(){return this.oi.Fo(F.a.zlb)?this.oi.ah(F.a.zlb):na.a.TBa?window.performance.timing.fetchStart:-1}lsk(Xa,Lb){this.q6e||2!==Lb.newState||(Xa=this.zYf(),Xa=Date.now()-Xa,
Lb={},Lb.clientId=this.OZg,Lb.bootTime=Xa,this.q6e=!0,this.ACc.Lfa(15,Lb))}Zmk(Xa,Lb){if(15===Lb.type){Xa=Date.now();Lb=Lb.oza;var pc=Lb.bootTime;this.A6d(Lb.clientId).Ftf=Xa-pc}}wfd(){this.O0()}O0(){const Xa=Date.now();var Lb=this.wK.P8a();const pc=new D.a;for(const fc of Lb)this.pef.contains(fc.clientId)||(this.pef.add(fc.clientId),pc.add(fc.clientId));if(0<pc.count)for(let fc of pc)Lb=this.A6d(fc),Lb.mEf||(Lb.lEf=Xa)}vrk(Xa){Xa=this.A6d(Xa);Xa.BBf||(Xa.ABf=Date.now())}A6d(Xa){return Xa in this.Dxd?
this.Dxd[Xa]:this.Dxd[Xa]=new ha(Xa,this.t2h,this.WOh)}hll(Xa,Lb=0){this.Smf=Xa;this.Tmf=Lb?Lb:(new Date).getTime()}aQi(Xa,Lb,pc,fc){pc=pc?pc.getTime():(new Date).getTime();Lb in this.Cjf?Xa.A1():(fc=new ka(Lb,this.ajj(),pc,this.TSc(this.OZg),this.TSc(Lb),this.q5a,this.n2a,fc,this.S1a),this.Cjf[Lb]=fc,fc.qud(Xa))}ajj(){return 1===this.Smf?this.Tmf:this.zYf()}TSc(Xa){return this.AXh.TSc(Xa)}}Object(K.a)(ba,"PresenceBootTelemetry",null,[1281]);var Ea=d(177),La=d(68),ta=d(342),oa=d(55),wa=d(288);class ra{get name(){return"Common.App.CoauthTelemetry"}$b(Xa){Xa.register(e,
"Common.App.CoauthTelemetry.CoauthTelemetry").as("Common.App.CoauthTelemetry.ICoauthTelemetry").ma().oa(()=>new e(wa.a.Uu(Xa.Ja("Common.IPeopleInfoProvider")),C.AFrameworkApplication.Vg));Xa.register(E,"Common.App.CoauthTelemetry.CoauthorGalleryTelemetry").as("Common.ICoauthorGalleryTelemetry").ma().oa(()=>new E(C.AFrameworkApplication.Ta,wa.a.Uu(Xa.Ja("Common.ICoauthoringTelemeryInfoProvider")),C.AFrameworkApplication.fa,Ea.a.get_instance(),ta.a.instance,wa.a.Uu(Xa.Ja("Common.IPeoplesWell")),wa.a.Uu(Xa.Ja("Common.IPeopleInfoProvider")),
e.Yvf,()=>this.gyf()));Xa.register(ba,"Common.App.CoauthTelemetry.PresenceBootTelemetry").as("Common.App.CoauthTelemetry.IPresenceBootTelemetry").ma().oa(()=>new ba(wa.a.Uu(Xa.Ja("Common.ICoauthoringTelemeryInfoProvider")),wa.a.Uu(Xa.Ja("Common.IRealtimeChannelBasic")),wa.a.Uu(Xa.Ja("Common.IPeopleInfoProvider")),Xa.resolve("Common.App.CoauthTelemetry.ICoauthorPositionFinder"),ta.a.instance,()=>this.gyf(),C.AFrameworkApplication.fa,null,z.Health.instance));Xa.register(H,"Common.App.CoauthTelemetry.CoauthorPositionFinder").as("Common.App.CoauthTelemetry.ICoauthorPositionFinder").ma().oa(()=>
new H(wa.a.Uu(Xa.Ja("Common.IPeopleInfoProvider"))));Xa.register(W,"Common.App.CoauthTelemetry.GuestCoauthTelemetry").ma().oa(()=>new W(wa.a.Uu(Xa.Ja("Common.IPeopleInfoProvider")),wa.a.Uu(Xa.Ja("Common.ISystemInitiatedFeedback")),C.AFrameworkApplication.fa,"{"+C.AFrameworkApplication.userSessionId+"}"))}init(){C.AFrameworkApplication.fa.jf(()=>{oa.a.instance.resolve("Common.App.CoauthTelemetry.CoauthTelemetry").init();oa.a.instance.resolve("Common.App.CoauthTelemetry.GuestCoauthTelemetry").init();
C.AFrameworkApplication.fa.ka("CoauthorGalleryTelemetryIsEnabled")&&oa.a.instance.resolve("Common.ICoauthorGalleryTelemetry").init();C.AFrameworkApplication.fa.ka("CashTelemetryIsEnabled")&&(oa.a.instance.resolve("Common.App.CoauthTelemetry.IPresenceBootTelemetry"),oa.a.instance.resolve("Common.App.CoauthTelemetry.ICoauthorPositionFinder"))})}dispose(){}gyf(){return na.a.TBa&&ta.a.instance.Fo(F.a.Utc)?0<ta.a.instance.ah(F.a.Utc)[F.a.uud]:!1}static main(){La.a.instance.Dc(new ra)}}Object(K.a)(ra,"CoauthTelemetryPackage",
null,[2,3]);var ya=d(263),Da=d(1191),pa=d(236),la=d(466);class Fa{constructor(Xa,Lb,pc,fc,bd){this.Jc=Xa;this._clientId=Lb;this.wPh=bd;this.uRh=pc||(()=>null);this.vRh=fc||(()=>null)}get id(){return this.Jc.id}get MEc(){return this.Jc.MEc}get QEc(){return this.Jc.QEc}get PEc(){return this.Jc.PEc}get OEc(){return this.Jc.OEc}get NEc(){return this.Jc.NEc}get SEc(){return this.Jc.SEc}get GMd(){return this.Jc.GMd}get nMb(){return this.Jc.nMb}get Mpd(){return this.Jc.Mpd}get ocd(){return this.Jc.ocd}get clientId(){return this._clientId}get wta(){return this.uRh}get A3(){return this.vRh}get jMi(){return this.wPh}static createInstance(Xa,
Lb,pc,fc,bd=!1){return new Fa(Xa,Lb,pc,fc,bd)}}Object(K.a)(Fa,"PeoplesWellSettings",null,[]);var Qa=d(26);class Sa{constructor(Xa){this.vj=Xa}get hCa(){return this.vj.hCa}get Zbd(){return this.vj.Zbd}}Object(K.a)(Sa,"CoauthoringTelemetryInfoProvider",null,[693]);var Na=d(913),ua=d(76),za=d(116),Wa=d(773),yb=d(570);class Za{constructor(Xa,Lb,pc,fc,bd){this.cFb=new ua.a;this.lz=null;this.vj=Xa;this.neb=pc;this.dJ=fc;this.dJ.TNd(Object(k.a)(this,this.Gdd,"onEditorTableUpdate"));this.Z5j=C.AFrameworkApplication.fa.ka("PeoplesWellExtraButtonInfoIsEnabled");
this.xye=bd;Lb&&Lb.execute(od=>{this.lz=od})}dispose(){this.cFb&&(za.a.Rld([this.cFb]),this.cFb=null);this.dJ.Ahh(Object(k.a)(this,this.Gdd,"onEditorTableUpdate"))}Jqb(Xa){this.cFb.addHandler("UsersUpdatedEvent",Xa)}wPe(Xa){this.cFb.removeHandler("UsersUpdatedEvent",Xa)}P8a(){return this.kXf(!1)}L1i(){return this.kXf(!0)}kXf(Xa){const Lb=[];this.vj.klb(this.vj.VC).returnValue||Qa.a.J(512497499,814,50,"PeopleInfoProvider::GetAllUsers - current editor({0}) missing in editortable",this.vj.VC);var pc=
null;this.lz&&(pc=this.lz.oQc());const fc=this.xye.f_f();let bd=!1;for(const od of this.vj.e_)Xa&&Za.TGc(fc,od.EmailAddress)?bd=!0:Array.add(Lb,this.LEi(od,pc));pc={};pc.fExcludeCurrent=Xa;pc.fCurrentExcluded=bd;pc.CurrentID=this.vj.VC;pc.EditorCount=this.vj.e_.length;pc.IsRtcNull=!this.lz;pc.UserCount=Lb.length;Qa.a.J(512497498,814,50,"PeopleInfoProvider::GetAllUsers:{0}",S.c(pc));return Lb}LEi(Xa,Lb){const pc=this.neb.hEa(new Na.a(Xa.EmailAddress,void 0,Xa.Name),Xa.ColorIndex,Xa.ID,1),fc=new Wa.a;
fc.G_a(0);let bd=0,od=!1,ye=!1;if(Lb&&Xa.ID in Lb){fc.G_a(1);if(this.Z5j){const pd=Lb[Xa.ID];pd&&pd.capabilities&4&&fc.G_a(4);od=!0;pd&&(bd=pd.capabilities,ye=pd.isAnonymous)}delete Lb[Xa.ID]}Qa.a.J(512497495,814,50,"PeopleInfoProvider::GetAllUsers; ClientId: {0}; Color: {1}; PresenceCapabilityHasFlagRealTimeChannel: {2}; PresenceCapabilityHasFlagSupportsChat: {3}; MyClientId: {4}; IsEmailAddressEmpty: {5}; rtcCapabilities: {6}; fIssuserinrtc: {7}; isAnonymous: {8}",Xa.ID,pc,fc.hda(1),fc.hda(4),this.vj.VC,
!Xa.EmailAddress,bd,od,ye);return new yb.a(Xa.ID,Xa.Name,pc,fc,null,Xa.EmailAddress,void 0,void 0,ye,void 0,void 0,Xa.JoinCoauthTime)}Gdd(){Qa.a.J(512497494,814,50,"PeopleInfoProvider::OnEditorTableUpdate");this.cFb.raiseEvent("UsersUpdatedEvent",this)}static TGc(Xa,Lb){return!!Xa&&!!Lb&&Xa.toLowerCase()===Lb.toLowerCase()}}Object(K.a)(Za,"PeopleInfoProvider",null,[1331]);var ub=d(79),Ib=d(213),Ob=d(134),Hc=d(312),kb=d(271);class jb extends Ib.a{constructor(){super();this.JoinTimeInMS=0;this.IsAnonymous=
!1;this.ImageUrl=null;this.CanJump=this.ActiveStatus=!1;this.Upn=null}get ControlType(){return 5}}Object(K.a)(jb,"PeopleButtonProps",Ib.a,[]);var hb=d(758),uc=d(45),mc=d(67);class Ya{constructor(Xa){this.Xtc=new mc.a;this.RXd=null;this.clientId=Xa}H$k(Xa){this.oRk();this.q5k(Xa);for(const Lb of Xa)Lb.clientId!==this.clientId&&this.Orf(Lb)}get $td(){const Xa=[];for(let Lb of this.Xtc.values){const pc=this.Lnh(Lb);Array.add(Xa,pc)}return Xa}get Mwa(){return this.Xtc.count}MNd(Xa,Lb){Xa=Xa.toUpperCase();
let pc;({value:pc}=this.Xtc.Uf(Xa)).returnValue||(pc=[],this.Xtc.$(Xa,pc));Array.add(pc,Lb)}oRk(){this.Xtc=new mc.a}q5k(Xa){for(const Lb of Xa)if(Lb.clientId===this.clientId){this.RXd=Lb;break}}}Object(K.a)(Ya,"UserTracker",null,[1686]);class Mb extends Ya{constructor(Xa,Lb){super(Xa);this.wRh=Lb}Orf(Xa){Xa.isAnonymous||!Xa.email?this.MNd(Xa.clientId,Xa):this.RXd&&J.a.jp().equals(this.RXd.email,Xa.email)||this.MNd(Xa.email,Xa)}Lnh(Xa){let Lb=new Date(0),pc=0<Xa.length?Xa[0]:null;for(const fc of Xa)(Xa=
this.wRh(fc.clientId))&&Lb.getTime()<Xa.aAb.getTime()&&(Lb=Xa.aAb,pc=fc);return pc}}Object(K.a)(Mb,"UniqueUserTracker",Ya,[]);class Kc extends Ya{constructor(Xa){super(Xa)}Orf(Xa){this.MNd(Xa.clientId,Xa)}Lnh(Xa){return Xa[0]}}Object(K.a)(Kc,"UserInstanceTracker",Ya,[]);const eb=(Xa,Lb,pc)=>pc?new Mb(Xa,Lb):new Kc(Xa);var Tb=d(71),lb=d(663),Fb=d(35);class rb{constructor(Xa,Lb=null,pc=null){this.wK=null;this.eLd=new r.a;this.Jc=Xa;this.tgd=Lb;pc&&pc.continueWith(()=>{this.wK=pc.result;this.wK.Jqb(Object(k.a)(this,
this.O0,"onUsersUpdated"));this.Djd()});new yb.a(this.settings.clientId,"Anonymous user","#cccccc",new Wa.a(7));this.yYc=this.jDd=!0;this.OAd=this.UGd=!1;this.G1=eb(this.settings.clientId,this.settings.A3,Xa.jMi)}get settings(){return this.Jc}get lJj(){return C.AFrameworkApplication.fa?C.AFrameworkApplication.fa.ka("ColorPresenceHashIsEnabled"):!1}get Seg(){return C.AFrameworkApplication.fa?C.AFrameworkApplication.fa.ka("PeoplesWellExtraButtonInfoIsEnabled"):!1}g5i(){let Xa;let Lb,pc,fc,bd;var od=
this.h5i();this.G1.Mwa?1===this.G1.Mwa?(Lb=!0,pc=this.settings.nMb.cluster,fc=this.settings.nMb.pLc,bd=this.G1.$td[0].color):(Lb=!0,pc=this.settings.ocd.cluster,fc=this.settings.ocd.pLc,bd=""):(Lb=!1,bd=fc=pc="");Xa=od[0];od=od.slice(1);return{Lvk:Xa,Mvk:od,Hvk:Lb,eIl:pc,Jvk:fc,Ivk:bd}}h5i(){if(2<=this.G1.Mwa)return[String.format(CommonUIStrings.l_PeoplesWellStateNumberOfOtherPeopleEditingHere,this.G1.Mwa)];if(1===this.G1.Mwa){const Xa=this.G1.$td[0],Lb=this.settings.A3(Xa.clientId);return Lb&&2===
Lb.status?[CommonUIStrings.l_PeoplesWellStateUserIsInactive,Xa.userName]:[Xa.isReadOnly?CommonUIStrings.l_PeoplesWellStateUserIsAlsoViewing:CommonUIStrings.l_PeoplesWellStateUserIsAlsoEditing,Xa.userName]}return[CommonUIStrings.l_PeoplesWellStateYouAreAllByYourself]}kmj(Xa){return this.lmj(Xa)}VAf(Xa,Lb,pc){return Lb?this.eoi(Lb)?(Xa=this.settings.A3(Xa))&&2===Xa.status?!1:!0:(pc&&n.ULS.sendTraceTag(4482394,325,50,"User has presence data but app can't use it"),!1):(pc&&n.ULS.sendTraceTag(4482393,
325,50,"User does not have any presence data"),!1)}fjj(Xa){return Xa.isReadOnly?CommonUIStrings.l_PeoplesWellUserStatusIsViewingOffline:CommonUIStrings.l_PeoplesWellUserStatusLocationUnknown}lmj(Xa){if(!Xa.capabilities.hda(1))return this.fjj(Xa);const Lb=Xa.isReadOnly,pc=this.settings.A3(Xa.clientId);Xa=this.settings.wta(Xa.clientId);if(!pc)return CommonUIStrings.l_PeoplesWellUserStatusLocationUnknown;switch(pc.status){case 1:return Xa?Lb?CommonUIStrings.l_PeoplesWellUserStatusIsViewingOnline:this.Ozi(Xa)||
CommonUIStrings.l_PeoplesWellUserStatusLocationUnknown:CommonUIStrings.l_PeoplesWellUserStatusLocationUnknown;case 2:return CommonUIStrings.l_PeoplesWellUserStatusIsInactive;default:return CommonUIStrings.l_PeoplesWellUserStatusLocationUnknown}}a$i(Xa){if(this.tgd.cle)return this.tgd.R0b(Xa.email,"O365",C.AFrameworkApplication.jh,0)}$lj(Xa){Xa=this.settings.A3(Xa.clientId);return!Xa||Xa&&1===Xa.status?!0:!1}amj(Xa){var Lb=String.format("buttonPeoplesWellUser-{0}",Xa.clientId),pc=Xa.clientId,fc=this.kmj(Xa);
const bd=Xa.userName,od=Xa.color;var ye=Object,pd=ye.assign,ab=new jb,Yb=this.settings.SEc.toString(),Sc=this.settings.Mpd.cluster,Jb=this.settings.Mpd.pLc,Oc=this.SZf(),Wb=Xa.isAnonymous,Ab;if(Ab=[bd],Ab.length){var Xb=new Sys.StringBuilder("STRARRY@");for(const vb of Ab)Xb.append(vb?vb.length:0),Xb.append(","),Xb.append(vb),Xb.append(",");Ab=Xb.toString().slice(0,-1)}else Ab=null;Lb=pd.call(ye,ab,{Id:Lb,Command:Yb,LabelText:"{0}",Image32by32:Sc,Image32by32Class:Jb,MenuItemId:pc,CommandValueId:pc,
Alt:bd,DisplayMode:Oc,LabelCss:"display:block; max-width:160px; padding:0px; white-space:normal; word-wrap:break-word",Description:fc,ImageBackColor:od,IsAnonymous:Wb,LabelTextUserGeneratedPlaceholderReplacements:Ab,Upn:Xa.email});C.AFrameworkApplication.fa.ka("PeoplesWellExtraButtonInfoIsEnabled")&&this.tgd&&(pc=this.a$i(Xa),fc=this.$lj(Xa),Lb.ImageUrl=pc,Lb.ActiveStatus=fc,Lb.JoinTimeInMS=Xa.AFa,Xa=this.VAf(Xa.clientId,this.settings.wta(Xa.clientId),!1),Lb.CanJump=Xa,""===pc&&n.ULS.sendTraceTag(40969413,
302,50,"ImageURL collection failed"));return Lb}m9i(){return Object.assign(new Ib.a,{Id:"BasicChat",Command:"2288458806",LabelText:CommonUIStrings.l_StartGroupChat,LabelCss:"display:block; max-width:160px; padding:0px; white-space:normal; word-wrap:break-word"})}SZf(){return this.lJj?"Initials":"Menu32"}bmj(Xa){const Lb=[];for(const pc of Xa)Xa=this.amj(pc),Array.add(Lb,Xa);return Lb}Bhe(){return 0<this.G1.Mwa}ZHk(Xa){if(!this.jDd)return!0;this.yYc||(Xa[lb.a.Visible]=!0);let Lb,pc,fc,bd,od;({Lvk:Lb,
Mvk:pc,Hvk:fc,Jvk:bd,Ivk:od}=this.g5i());Xa[lb.a.LabelText]=Lb;pc&&pc.length&&(Xa[lb.a.LabelTextUserGeneratedPlaceholderReplacements]=pc);Xa[lb.a.ImageIsVisible]=fc;Xa[lb.a.Image16by16Class]=bd;Xa[lb.a.ImageBackColor]=od;this.jDd=!1;return!0}QAk(Xa){if(0>=this.G1.Mwa)return!1;var Lb=this.yjl(this.G1.$td),pc=this.bmj(Lb);Lb=Object.assign(new Hc.a,{Id:"menuCoauthors",MaxWidth:"220px",MenuSectionList:[]});pc=Object.assign(new kb.a,{Id:"msCoauthors",ControlsId:"msCoauthorsControls",DisplayMode:this.SZf(),
ControlList:pc});C.AFrameworkApplication.fa.ka("WordEditorDisplayPeoplesWellLabelIsEnabled")&&this.tgd&&(pc.Title=CommonUIStrings.l_PeoplesWellFlyoutLabel,pc.TitleId="menuCoauthorsTitle",pc.Theme="Light");Array.add(Lb.MenuSectionList,pc);C.AFrameworkApplication.fa.ka("DocChatIsEnabled")&&C.AFrameworkApplication.fa.ka("PeoplesWellExtraButtonInfoIsEnabled")&&C.AFrameworkApplication.Aa&&C.AFrameworkApplication.Aa.hb.Lo&&(pc=[],Array.add(pc,this.m9i()),pc=Object.assign(new kb.a,{Id:"msGroupChat",ControlsId:"msGroupChatControl",
ControlList:pc}),Array.add(Lb.MenuSectionList,pc));C.AFrameworkApplication.Aa&&C.AFrameworkApplication.Aa.hb.Lo?Xa.MenuItems=Lb:Xa.PopulationXML=Ob.l(Lb);return!0}TBl(Xa){n.ULS.sendTraceTag(4482395,325,50,"PeoplesWell: Received user button click");Xa=Xa.MenuItemId;if(!Xa)return!1;const Lb=this.settings.wta(Xa);if(!this.VAf(Xa,Lb,!0))return!1;this.pWj(Xa,Lb);return!0}ZNk(){const Xa=this.O1i();this.G1.H$k(Xa);this.yYc&&1<=this.G1.Mwa&&(n.ULS.sendTraceTag(6092429,325,50,"PeoplesWell: User is no longer forever alone."),
this.yYc=!1);this.jDd=!0}O0(){this.OAd||(window.setTimeout(()=>{this.Djd();this.OAd=!1},3E3),this.OAd=!0)}O1i(){let Xa;Xa=this.M1i()||[];for(const Lb of Xa)this.h0k(Lb);return Xa}h0k(Xa){Xa.clientId||(Xa.clientId=R.a.create().toString());Xa.userName||(Xa.userName="Anonymous user");Xa.capabilities||(Xa.capabilities=new Wa.a);Xa.color||(Xa.color="#cccccc");Xa.AFa||(Xa.AFa=0)}yjl(Xa){const Lb=[];Array.addRange(Lb,Xa);Lb.sort(rb.wvk);return Lb}eQk(){C.AFrameworkApplication.fa.ka("CoauthorGalleryTelemetryIsEnabled")&&
!this.UGd&&(C.AFrameworkApplication.Ta.$S(Fb.a.pEf)&&hb.a.isSharedUxGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.DoNotRegisterCoauthorsRenderedMultiplTimes")||C.AFrameworkApplication.Ta.ra(Fb.a.pEf,Tb.a.frame,Object(k.a)(this,this.$mk,"onCoauthorGalleryFirstRender"),96));this.fQk();this.UGd=!0;this.Djd()}$mk(Xa,Lb,pc,fc,bd){this.eLd.HM(bd.RenderTime);return 32}get Lrd(){return this.eLd.task}Djd(){if(!this.UGd&&(this.eLd.HM((new Date).getTime()),n.ULS.sendTraceTag(42567504,325,50,"We are trying to render the coauthor gallery before we are ready to record the render time"),
this.Seg))return;this.ZNk();this.Seg&&this.yYc?C.AFrameworkApplication.fa&&C.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GeneralizedRibbonTTVRReporting",!1)||la.a.K$("ribbon","coauthorGallery"):(C.AFrameworkApplication.fa&&C.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GeneralizedRibbonTTVRReporting",!1)||(la.a.L$("ribbon","coauthorGallery"),la.a.J$("ribbon","coauthorGallery")),this.$Nk())}dispose(){this.wK&&(this.wK.wPe(Object(k.a)(this,
this.O0,"onUsersUpdated")),this.wK=null)}static wvk(Xa,Lb){return Xa.capabilities.hda(1)&&Lb.capabilities.hda(1)||!Xa.capabilities.hda(1)&&!Lb.capabilities.hda(1)?uc.a.localeCompare(Xa.userName,Lb.userName):Xa.capabilities.hda(1)?-1:1}}Object(K.a)(rb,"APeoplesWell",null,[1572,106]);var Qb=d(39);class Bc extends rb{constructor(Xa,Lb,pc=null,fc=null){super(Xa,pc,fc);this.Zza=()=>!0;this.Ca=Lb}aIk(Xa){return this.ZHk(Xa)}SAk(Xa){return this.QAk(Xa)}VBl(Xa){return this.TBl(Xa)}wQ(Xa,Lb,pc,fc,bd,od){Xa=
!1;switch(pc){case 1:Xa=bd(fc);break;case 2:Xa=od(fc)}return Bc.Ehi(Xa)}JJj(Xa,Lb,pc,fc,bd){return this.wQ(Xa,Lb,pc,bd,()=>this.Bhe(),this.Zza)}$Hk(Xa,Lb,pc,fc,bd){return this.wQ(Xa,Lb,pc,bd,Object(k.a)(this,this.aIk,"queryUsersProxy"),this.Zza)}RAk(Xa,Lb,pc,fc,bd){return this.wQ(Xa,Lb,pc,bd,this.Zza,Object(k.a)(this,this.SAk,"populateFlyoutContentsProxy"))}zui(Xa,Lb,pc,fc,bd){return this.wQ(Xa,Lb,pc,bd,this.Zza,this.Zza)}yui(Xa,Lb,pc,fc,bd){return this.wQ(Xa,Lb,pc,bd,this.Zza,this.Zza)}UBl(Xa,Lb,
pc,fc,bd){return this.wQ(Xa,Lb,pc,bd,this.Zza,Object(k.a)(this,this.VBl,"userButtonClickProxy"))}qzk(Xa,Lb,pc,fc,bd){return this.wQ(Xa,Lb,pc,bd,this.Zza,()=>{this.Djd();return!0})}fQk(){this.Ca.ya(this.settings.MEc,Qb.a.application,Object(k.a)(this,this.JJj,"isControlEnabledHandler"));this.Ca.ra(this.settings.QEc,Qb.a.application,Object(k.a)(this,this.$Hk,"queryUsersHandler"),96);this.Ca.ra(this.settings.OEc,Qb.a.application,Object(k.a)(this,this.zui,"commandMenuOpenHandler"),96);this.Ca.ra(this.settings.NEc,
Qb.a.application,Object(k.a)(this,this.yui,"commandMenuCloseHandler"),96);this.Ca.ra(this.settings.PEc,Qb.a.application,Object(k.a)(this,this.RAk,"populateFlyoutContentsHandler"),96);this.Ca.ya(this.settings.SEc,Qb.a.application,Object(k.a)(this,this.UBl,"userButtonClickHandler"));this.Ca.ra(this.settings.GMd,Qb.a.application,Object(k.a)(this,this.qzk,"peoplesWellRefreshControlHandler"),96)}dispose(){super.dispose()}static Ehi(Xa){return Xa?32:8}}Object(K.a)(Bc,"ABox4PeoplesWell",rb,[]);var wb=d(728);
class Ad extends Sys.EventArgs{constructor(Xa){super();this.controlId=Xa}}Object(K.a)(Ad,"RibbonControlStatusChangedEventArgs",Sys.EventArgs,[]);class bc extends Bc{constructor(Xa,Lb,pc,fc,bd,od,ye,pd,ab,Yb,Sc,Jb,Oc,Wb,Ab,Xb,vb,$c){super(Xa,Lb,Xb,$c?u.Task.Nt($c):null);this.lz=null;this.Nte=!1;if(!bd)throw Error.argumentNull("coauthStateGetter");if(!od)throw Error.argumentNull("appFrame");if(!ye)throw Error.argumentNull("taskManager");this.vj=bd;this.Qb=od;this.zb=ye;fc&&fc.execute(fd=>{this.lz=fd});
pc&&pc.execute(fd=>{fd.p$h(Object(k.a)(this,this.aEk,"presenceChanged"))});this.qc=pd;this.Ie=ab;this.ve=Yb;this.Ddc=Oc;this.m4j=Sc;this.neb=Jb;this.tBb=Wb;this.iU=Ab;this.xye=vb;this.GGg=$c;this.Lrd.continueWith(()=>{this.iU.XQi(this.Lrd.result)})}pWj(Xa,Lb){let pc=null;({data:pc}=this.l1e(Lb)).returnValue&&pc&&pc.$j&&(Qa.a.J(512497493,814,50,"PowerPointPeoplesWell : JumpToUserLocation; clientId: {0}; slideId: {1}; MyClientId: {2};",Xa,pc.$j,this.vj.VC),(Xa=this.qc.Vja(pc.$j))?(this.Ie.vnd(),this.Ie.xU(Xa.oe)):
Qa.a.J(512497492,814,15,"PowerPointPeoplesWell : JumpToUserLocation; failed to find slide by id: {0}; ",pc.$j))}l1e(Xa){let Lb;Lb=null;if(!Xa)throw Qa.a.J(512497491,814,10,"PowerPointPeoplesWell : TryGetPresenceData; Presence was null; MyClientId: {0};",this.vj.VC),Error.argumentNull("presence");return Xa?(Lb=wb.a.NKc(Xa.data))?{returnValue:!0,data:Lb}:{returnValue:!1,data:Lb}:{returnValue:!1,data:Lb}}eoi(Xa){let Lb=null;return({data:Lb}=this.l1e(Xa)).returnValue&&Lb&&Lb.$j?!0:!1}M1i(){if(this.GGg)return this.GGg.L1i();
Qa.a.J(512497490,814,50,"PowerPointPeoplesWell::GetAllUsersInfo - PeopleInfoProvider is null.");const Xa=this.N1i();0<Xa.length&&Qa.a.J(512497489,814,50,"PowerPointPeoplesWell::GetAllUsersInfo - non-empy editor count {0}.",Xa.length);return Xa}N1i(){const Xa=[],Lb=this.xye.f_f();this.vj.klb(this.vj.VC).returnValue||Qa.a.J(512497488,814,50,"PowerPointPeoplesWell : GetAllUsersInfo, there is no current editorId:{0} in the editortable",this.vj.VC);let pc=null;this.lz&&(pc=this.lz.oQc());var fc=C.AFrameworkApplication.fa.ka("PeoplesWellExtraButtonInfoIsEnabled");
for(var bd of this.vj.e_){var od=this.neb.hEa(new Na.a(bd.EmailAddress,void 0,bd.Name),bd.ColorIndex,bd.ID,1),ye=new Wa.a;ye.G_a(0);let pd=0,ab=!1;if(bc.$Uj(bd.ID,pc)){ye.G_a(1);if(fc){let Yb=pc[bd.ID];Yb&&(pd=Yb.capabilities);ab=!0;Yb&&Yb.capabilities&4&&ye.G_a(4)}delete pc[bd.ID]}bc.TGc(Lb,bd.EmailAddress)||(Array.add(Xa,new yb.a(bd.ID,bd.Name,od,ye,null,bd.EmailAddress)),Qa.a.J(8958496,814,50,"PowePointPeoplesWell : GetAllUsersInfo; ClientId: {0}; Color: {1}; PresenceCapabilityHasFlagRealTimeChannel: {2}; PresenceCapabilityHasFlagSupportsChat: {3}; MyClientId: {4}; IsEmailAddressEmpty: {5}; rtcCapabilities:{6}; fIssuserinrtc{7};",
bd.ID,od,ye.hda(1),ye.hda(4),this.vj.VC,!bd.EmailAddress,pd,ab))}if(!fc&&this.Ddc&&pc)for(let pd in pc)fc=pc[pd],!bc.TGc(Lb,fc.email)&&fc&&fc.userName&&(bd=new Wa.a,bd.G_a(1),fc.capabilities&4&&bd.G_a(4),od=this.tBb.l5d(fc.email)||fc.email,ye=this.neb.hEa(new Na.a(od,void 0,fc.userName),null,fc.clientId,1),Array.add(Xa,new yb.a(fc.clientId,fc.userName,ye,bd,null,od)),Qa.a.J(38897818,814,50,"PowePointPeoplesWell : GetAllUsersInfo; Get info from RTC when user is not in editor table and username is provided; ClientId: {0}; Color: {1}; PresenceCapabilityHasFlagRealTimeChannel: {2}; PresenceCapabilityHasFlagSupportsChat: {3}; MyClientId: {4}; IsEmailAddressEmpty: {5}; rtcPresenceCapabilities: {6};",
fc.clientId,ye,bd.hda(1),bd.hda(4),this.lz.clientId,!fc.email,fc.capabilities));return Xa}Ozi(Xa){let Lb=null,pc=" ";({data:Lb}=this.l1e(Xa)).returnValue&&Lb&&Lb.$j&&(Xa=this.qc.Vja(Lb.$j))&&(pc=String.format(ResourceStrings.l_PeoplesWellUserStatusIsEditingSlide,Xa.oe+1));return pc}aEk(){this.Qb.Mt.aFa?this.Nte||(this.zb.Eb(new ub.a(2,1,0,Object(k.a)(this,this.handlePendingRefresh,"handlePendingRefresh"),90,"70")),this.Nte=!0):this.Ca.processAction(Fb.a.O6a,2)}$Nk(){this.ve.bKk(new Ad(this.settings.id,
!0));const Xa=1<this.G1.Mwa||1===this.G1.Mwa&&this.G1.$td[0].clientId!==this.settings.clientId;this.m4j.execute(Lb=>{Xa&&this.iU&&this.iU.M1j();Lb.xOb()});Xa&&this.iU.Yh(14,Date.now())}handlePendingRefresh(){this.Nte=!1;this.Ca.processAction(Fb.a.O6a,2)}dispose(){super.dispose()}static $Uj(Xa,Lb){return Lb&&Xa in Lb?!0:!1}static TGc(Xa,Lb){return!!Xa&&!!Lb&&Xa.toLowerCase()===Lb.toLowerCase()}}Object(K.a)(bc,"PowerPointPeoplesWell",Bc,[]);class Sb{constructor(Xa){this.Ofc=null;Xa.execute(Lb=>{this.Ofc=
Lb})}wta(Xa){return this.Ofc?this.Ofc.wta(Xa):null}A3(Xa){return this.Ofc?this.Ofc.A3(Xa):null}}Object(K.a)(Sb,"PresenceUserInfoGetterProxy",null,[1220]);var Zb=d(34);class cb{constructor(){this.I4=this.dJ=this.nh=this.K=null}get name(){return"PowerPointWebEditor.PeoplesWell"}$b(Xa){cb.Ebc=Date.now();this.K=Xa;this.I4=this.K.resolve("PowerPointWebEditor.Core.IBundleMetricRecorder");this.nh=this.I4.VDa(6,this.name);this.K.register(1220,"PowerPointWebEditor.IPresenceUserInfoGetter").ma().oa(()=>new Sb(this.K.Ja("PowerPointWebEditor.IDelayedPresenceUserInfoGetter")));
this.K.register(693,"Common.ICoauthoringTelemeryInfoProvider").ma().oa(()=>new Sa(this.K.resolve("PowerPointWebEditor.ICoauthStateGetter")));this.K.register(Za,"PowerpointPresence.PeopleInfoProvider").as("Common.IPeopleInfoProvider").ma().oa(()=>new Za(this.K.resolve("PowerPointWebEditor.ICoauthStateGetter"),this.K.Ja("Common.IRealtimeChannelBasic"),this.K.resolve("PowerpointPresence.IPresenceColorProvider"),this.K.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler"),this.K.resolve("PowerpointPresence.IPresencePrepCacheParser")));
if(Zb.a("PeoplesBaseUlrConfiguredForPods")&&(Xa=this.K.resolve("Common.App.People.IExternalPeopleAPI"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").wg)){const Lb=this.K.resolve("Common.IAppSettingsManager").Ha("368");Xa.Q7g(Lb+"p")}Qa.a.J(509669911,814,50,"PPTWebEditorPeoplesWellPackage:Configure")}init(){if(C.AFrameworkApplication.fa&&C.AFrameworkApplication.fa.ka("UnifiedScriptLoaderForDSEnabled"))this.K.resolve("PowerPointWebEditor.ScriptLoader.IUnifiedScriptLoader").Gca("pptedit.presence1",
null,()=>d.e(4).then(d.bind(null,1230)));else{const Xa=Da.a.create("pptedit.presence1",null,()=>d.e(4).then(d.bind(null,1230)));pa.a.Wx(Xa)}this.K.resolve("Common.ICoauthoringTelemeryInfoProvider");this.K.resolve("Common.IPeopleInfoProvider");C.AFrameworkApplication.LA.ADa?(this.dJ=this.K.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler"),la.a.K$("ribbon","coauthorGallery"),this.dJ.SNd(Object(k.a)(this,this.gcg,"initializePeoplesWellHandler"))):this.fcg()}gcg(){try{C.AFrameworkApplication.LA.ADa||
(this.fcg(),this.dJ.aPe(Object(k.a)(this,this.gcg,"initializePeoplesWellHandler")))}catch(Xa){Qa.a.J(8958610,814,10,"PresencePackage::Init; Loading presence and peoples well failed: {0}",Xa)}}fcg(){const Xa=this.nh.su("peoplewell");this.yDj(this.K.resolve("PowerPointWebEditor.IPresenceUserInfoGetter"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.AppFrame"),this.K.resolve("Common.ITaskManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerpointPresence.RtcParams").clientId);
this.nh.yu(Xa)}yDj(Xa,Lb,pc,fc,bd,od){var ye=this.K.resolve("PowerpointPresence.IPresencePerfLogger");ye.Yh(10,cb.Ebc);ye.Yh(9,cb.$fc);ye.Yh(11,(new Date).getTime());ye=Date.now();const pd=ya.CuiHelper.Vdj(C.AFrameworkApplication.qm,C.AFrameworkApplication.qm,C.AFrameworkApplication.qm);Xa=Fa.createInstance(pd,od,Object(k.a)(Xa,Xa.wta,"getUserPresence"),Object(k.a)(Xa,Xa.A3,"getUserStatusInfo"),!0);(od=this.K.resolve("PowerpointPresence.PeopleInfoProvider"))||Qa.a.J(509669910,814,10,"InitializePeoplesWellInternal; null PeopleInfoProvider");
Qa.a.J(509669909,814,50,"InitializePeoplesWellInternal; creating peopleswell");const ab=new bc(Xa,Lb,this.K.Ja("PowerpointPresence.IPresenceManager"),this.K.Ja("Common.IRealtimeChannelBasic"),this.K.resolve("PowerPointWebEditor.ICoauthStateGetter"),pc,fc,this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView"),this.K.resolve("PowerPointWebEditor.View.IViewEventNotifier"),this.K.Ja("Box4.IBox4BridgeCommandUi"),this.K.resolve("PowerpointPresence.IPresenceColorProvider"),
bd.podsDefaultToRtcForPresenceEnabled,this.K.resolve("PowerpointPresence.IPresenceEmailConverter"),this.K.resolve("PowerpointPresence.IPresencePerfLogger"),this.K.resolve("Common.App.People.IPeopleManager"),this.K.resolve("PowerpointPresence.IPresencePrepCacheParser"),od);ab.eQk();this.K.register(bc,"PowerpointPresence.PowerPointPeoplesWell").as("Common.IPeoplesWell").ma().oa(()=>ab);this.K.resolve("Common.IPeoplesWell");this.K.Ja("Box4.IBox4BridgeCommandUi").execute(Yb=>{Yb.xOb()});Qa.a.J(8958615,
814,50,"PresencePackage::InitializePeoplesWell; People's Well loaded and initialized. Time cost: {0}",Date.now()-ye);this.K.resolve("PowerpointPresence.IPresencePerfLogger").bRi()}dispose(){}static main(){cb.$fc=Date.now();if(C.AFrameworkApplication.fa&&C.AFrameworkApplication.fa.ka("IsSyncConfigPresenceEnabled")){const Xa=new cb;Xa.$b(oa.a.instance);Xa.init()}else La.a.instance.Dc(new cb)}}cb.$fc=0;cb.Ebc=0;Object(K.a)(cb,"PPTWebEditorPeoplesWellPackage",null,[2,3]);Type.registerNamespace("PowerPointWebEditor");
Type.registerNamespace("PowerPointWebEditor.PeoplesWell");Type.registerNamespace("PowerpointPresence");Type.registerNamespace("RealtimePresenceUI");window.g_hermesPresenceJS=new Date;Type.registerNamespace("Common.App.CoauthTelemetry");ra.main();Type.registerNamespace("RealtimePresenceUI");cb.main()},728:function(K,Z,d){K=d(0);var k=d(61);class e{constructor(r,v,C){this.slideId=r;this.shapes=v;this.sn=C}}Object(K.a)(e,"SerializablePresenceData",null,[]);d.d(Z,"a",function(){return n});class n{constructor(r,
v,C=0){if(!n.isValid(r))throw Error.create("Invalid Presence Data");this.mB=r;this.k$c=v;this.gSg=C?C:++n.KHi}get $j(){return this.mB}get PU(){return this.k$c}toString(){return this.mB.toString()+" : "+(this.PU&&this.PU.length?this.PU[0].toString():"")+" : "+this.gSg}w8d(){return new e(this.mB.quc,this.k$c,this.gSg)}static isValid(r){return!!r}static NKc(r){return new n(new k.a(r.slideId),r.shapes,r.sn)}}n.KHi=0;Object(K.a)(n,"PresenceData",null,[])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/18430998/wdjs/ppteditDS.presence.js.map