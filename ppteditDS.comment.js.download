'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[7],{1227:function(K,Z,d){d.r(Z);var k=d(0),e=d(25),n=d(382),r=d(17),v=d(22);class C{}C.beginDraftingAsync="OSC:BDA";C.HYi="OSC:FEQ";C.selectComment="OSC:SC";Object(k.a)(C,"CommentTaskNames",null,[]);class w{constructor(aa){this.CGa=aa;this.P5j=[]}get handler(){return this.CGa}get d8(){return this.P5j}}Object(k.a)(w,"RegisteredListener",null,[]);class z{constructor(aa,sa){this.type=0;this.payload=null;this.type=aa;
this.payload=sa}}Object(k.a)(z,"OfficeSharedCommentsEvent",null,[1514]);class A{constructor(){this.eventType=0;this.newViewContainer=null;this.viewContainerVisibilityState=1}}Object(k.a)(A,"ViewContainerEvent",null,[1514]);var u=d(659);class E{constructor(aa){this.vte=!1;this.IX=new r.a;this.zb=aa}wPk(aa){aa=new w(aa);this.IX.add(aa)}VEh(aa){for(let sa=0;sa<this.IX.count;++sa)if(this.IX.ga(sa).handler===aa){this.IX.removeAt(sa);break}}hoa(aa=!1){const sa=()=>{if(e.AFrameworkApplication.Tg)n.ULS.sendTraceTag(40420181,
201,50,"Skipped processing comment pane events since app is shutting down.");else for(let Gb=0;Gb<this.IX.count;++Gb){const Bb=this.IX.ga(Gb);for(;0<Bb.d8.length;){var Oa=Array.dequeue(Bb.d8);if(Object(v.a)(A,Oa)){var ib=Bb.handler;ib(Oa)}else Object(v.a)(z,Oa)&&(ib=Bb.handler,ib(Oa.type,Oa.payload))}}};aa?sa():this.vte||(this.vte=!0,u.a.Aqb(this.zb,()=>{sa();this.vte=!1},C.HYi))}}Object(k.a)(E,"GenericEventHost",null,[]);class H extends E{constructor(aa){super(aa)}MQk(aa){this.wPk(aa)}Fwl(aa){this.VEh(aa)}wrh(aa){aa=
this.vBi(aa);for(let sa=0;sa<this.IX.count;++sa)Array.enqueue(this.IX.ga(sa).d8,aa);this.hoa(!0)}vBi(aa){const sa=new A;sa.eventType=3;sa.viewContainerVisibilityState=aa;return sa}SYi(){const aa=this.SGi();for(let sa=0;sa<this.IX.count;++sa)Array.enqueue(this.IX.ga(sa).d8,aa);this.hoa(!0)}SGi(){const aa=new A;aa.eventType=2;return aa}}Object(k.a)(H,"ViewContainerEventHost",E,[1495]);class I{constructor(){this.numberOfThreads=this.numberOfComments=0;this.contextDetails=this.changes=this.commentId=
this.comment=this.comments=null;this.virtualized=!1;this.index=0;this.tempId=this.threadIds=null;this.errorType=0;this.tasks=null;this.richTextCapabilityFlags=this.modelCapabilityFlags=0;this.rehydrationDrafts=this.contextDrafts=this.smartReplies=null}}Object(k.a)(I,"BasicEventPayload",null,[1553]);class J{constructor(aa){this.nextPopulatedContextDetails=0;this.commentThreadCounts=null;this.isReadOnly=!1;this.isReadOnly=aa}}Object(k.a)(J,"CommentContextDetails",null,[]);class T{constructor(){this.numberOfThreads=
this.numberOfComments=0;this.contextDetails=null;this.selectedThreadIndex=0;this.virtualized=!1;this.rehydrationDrafts=this.contextDrafts=null}}Object(k.a)(T,"ContextChangeWithSelectedThreadIndex",null,[1553]);class D{constructor(){this.tasks=this.comments=null}}Object(k.a)(D,"LoadCommentsNoVirtualization",null,[1553]);class R extends E{constructor(aa){super(aa);this.hZh=0}OPk(aa,sa,Oa,ib,Gb,Bb,Cc=0){aa=new w(aa);Bb&&Array.enqueue(aa.d8,this.fBi(Bb,this.hZh));Bb=sa?sa.length:0;Array.enqueue(aa.d8,
this.wHf(Bb,Oa,ib,Cc,null));Bb&&Array.enqueue(aa.d8,this.iIf(sa,Gb));this.IX.add(aa);this.hoa()}ZEh(aa){this.VEh(aa)}ASe(aa,sa,Oa,ib=0,Gb=null){this.PTa(this.wHf(aa,sa,Oa,ib,Gb));this.hoa()}K2k(aa,sa,Oa,ib,Gb=null){this.PTa(this.zBi(aa,sa,Oa,ib,Gb));this.hoa()}coh(aa,sa,Oa){this.PTa(this.CBi(aa,sa,Oa));this.hoa()}ESe(aa,sa){this.PTa(this.iIf(aa,sa));this.hoa()}selectComment(aa){this.PTa(this.QIf(aa,6));this.hoa()}highlightComment(aa){this.PTa(this.QIf(aa,7));this.hoa()}c1a(aa,sa){this.PTa(this.VDi(aa,
sa));this.hoa()}oBk(aa,sa){this.PTa(this.$Fi(aa,sa));this.hoa()}fBi(aa,sa=0){const Oa=new I;Oa.modelCapabilityFlags=aa;Oa.richTextCapabilityFlags=sa;return new z(12,Oa)}wHf(aa,sa,Oa,ib,Gb=null){const Bb=new I;Bb.numberOfComments=aa;Bb.numberOfThreads=sa;Bb.contextDetails=Object.assign(new J(Oa),{nextPopulatedContextDetails:ib});Bb.contextDrafts=Gb;Bb.rehydrationDrafts=null;return new z(0,Bb)}zBi(aa,sa,Oa,ib,Gb=null){const Bb=new T;Bb.numberOfComments=aa;Bb.numberOfThreads=sa;Bb.selectedThreadIndex=
Oa;Bb.contextDetails=Object.assign(new J(ib),{nextPopulatedContextDetails:0});Bb.contextDrafts=Gb;Bb.rehydrationDrafts=null;return new z(0,Bb)}CBi(aa,sa,Oa){const ib=new I;ib.comments=aa;ib.numberOfThreads=sa;ib.tasks=Oa;return new z(2,ib)}iIf(aa,sa){const Oa=new D;Oa.comments=aa;Oa.tasks=sa;return new z(1,Oa)}QIf(aa,sa){const Oa=new I;Oa.commentId="";aa&&(Oa.commentId=aa);return new z(sa,Oa)}VDi(aa,sa){const Oa=new I;Oa.changes=[];Oa.contextDetails=Object.assign(new J(sa),{nextPopulatedContextDetails:aa});
return new z(10,Oa)}$Fi(aa,sa){const Oa=new I;Oa.commentId=aa;Oa.smartReplies=sa;return new z(15,Oa)}PTa(aa){for(let sa=0;sa<this.IX.count;++sa)Array.enqueue(this.IX.ga(sa).d8,aa)}}Object(k.a)(R,"OfficeSharedCommentsEventHost",E,[1544]);var Q=d(1185);class W{constructor(){this.dmf=this.knf=!1;this.t1h=[]}get QNb(){return this.t1h}get skb(){return this.knf}set skb(aa){this.knf=aa;for(const sa of this.QNb)sa.skb=aa}get ojb(){return this.dmf}set ojb(aa){this.dmf=aa;for(const sa of this.QNb)sa.ojb=aa}KLa(aa){for(const sa of this.QNb)aa=
sa.KLa(aa);return aa}}Object(k.a)(W,"AggregateCommentTaskPersonTransformer",null,[1573]);var O=d(104);class Y{constructor(aa,sa,Oa,ib,Gb=!1){this.priority=this.completion=-1;this.type=aa;this.user=sa;this.time=Oa;this.recordId=ib;this.isLossy=Gb}}Object(k.a)(Y,"HistoryRecord",null,[]);class S{constructor(aa,sa){this.zUh=new Q.a(()=>sa.KLa(aa.value))}j6i(){return new Date}rCa(aa,sa,Oa){if(0===aa)throw n.ULS.sendTraceTag(594650201,327,10,"CreateBlankHistoryRecord: we do not expect user to be able to create a record of type Unknown in the browser."),
Error.argument("recordType");const ib=O.a.create().toString();Oa=new Y(aa,this.zUh.value,Oa,ib,!1);Oa.commentId=sa;n.ULS.sendTraceTag(42796192,327,50,"History Record Generated. [RecordType: {0}]",aa);return Oa}}Object(k.a)(S,"HistoryRecordFactory",null,[1574]);class da{constructor(){this.endDate=this.startDate=null}}Object(k.a)(da,"CommentTaskSchedule",null,[]);class fa{constructor(aa,sa,Oa,ib,Gb,Bb){this.isLossy=aa;this.title=sa;this.assignees=Oa;this.schedule=ib;this.completion=Gb;this.priority=
Bb}}Object(k.a)(fa,"CommentTaskState",null,[]);class ka{constructor(){this.commentId=null}}Object(k.a)(ka,"HistoryItem",null,[]);class ha{constructor(aa,sa,Oa,ib,Gb,Bb,Cc){this.ZBd=!1;if(1!==sa.type)throw Error.argument("createRecord");this.MQb=Oa;this.JQb=ib;this.KQb=Gb;this.mhf=1;this.uyc=aa;this.RVh=Bb;this._state=new fa(!1,this.MQb,Cc,new da,this.KQb,this.JQb);this._history=[];this.tIf(sa)}Atb(aa,sa){if(1!==aa.type)throw Error.argument("createRecordTemplate");const Oa=ha.Xjj(aa,this.mhf);this.mhf++;
return Object.assign(new Y(sa,aa.user,aa.time,Oa),{commentId:aa.commentId})}get nmg(){return this.history[this.history.length-1]}get M9f(){return this.state.completion===this.KQb}get L9f(){return this.state.priority===this.JQb}get N9f(){return(void 0===this.state.schedule.startDate||null===this.state.schedule.startDate)&&(void 0===this.state.schedule.endDate||null===this.state.schedule.endDate)}get O9f(){return this.state.title===this.MQb}tIf(aa){aa=Object.assign(new ka,{commentId:aa.commentId,records:[aa]});
this.history.push(aa)}xXf(aa){let sa=-1;for(let Oa=0;Oa<this.state.assignees.length;Oa++)if(this.uyc.equals(this.state.assignees[Oa],aa)){sa=Oa;break}return sa}wbl(aa){const sa=this.nmg,Oa=sa.records[sa.records.length-1];return this.uyc.equals(Oa.user,aa.user)&&sa.commentId===aa.commentId&&Oa.time.getTime()===aa.time.getTime()?!0:!1}lBl(aa){switch(aa.type){case 2:-1===this.xXf(aa.assignee)&&this.state.assignees.push(aa.assignee);break;case 3:const sa=this.xXf(aa.assignee);0<=sa&&this.state.assignees.splice(sa,
1);break;case 4:Array.clear(this.state.assignees);break;case 5:this.state.schedule=aa.schedule;break;case 6:this.state.completion=aa.completion;break;case 9:this.state.title=aa.title;break;case 10:this.state.priority=aa.priority;break;case 0:this.state.isLossy=!0;break;case 1:n.ULS.sendTraceTag(595198540,327,10,"Create record passed for state evaluation");break;case 7:this.ZBd=!0;break;case 8:this.ZBd=!1;break;case -1:n.ULS.sendTraceTag(51139905,327,10,"Undo record passed for state evaluation");break;
default:this.state.isLossy=!0}aa.isLossy&&(this.state.isLossy=!0);this.wbl(aa)?this.nmg.records.push(aa):this.tIf(aa)}get isDeleted(){return this.ZBd}get state(){return this._state}get history(){return this._history}B9i(aa){if(!aa)return this.history;const sa=Array.clone(this.history),Oa=sa[0],ib=Oa.records.shift();if(!this.RVh){var Gb=this.Atb(ib,4);Oa.records.unshift(Gb)}!aa.M9f&&this.M9f&&(Gb=this.Atb(ib,6),Gb.completion=this.KQb,Oa.records.unshift(Gb));!aa.L9f&&this.L9f&&(Gb=this.Atb(ib,10),Gb.priority=
this.JQb,Oa.records.unshift(Gb));!aa.N9f&&this.N9f&&(Gb=this.Atb(ib,5),Gb.schedule=new da,Oa.records.unshift(Gb));!aa.O9f&&this.O9f&&(Gb=this.Atb(ib,9),Gb.title=this.MQb,Oa.records.unshift(Gb));aa.isDeleted&&(aa=this.Atb(ib,8),Oa.records.unshift(aa));return sa}static Xjj(aa,sa){return"Synthesized-"+aa.recordId+"-"+sa}}Object(k.a)(ha,"CommentTaskStateBuilder",null,[]);var F=d(712);class na{constructor(aa,sa,Oa,ib){this.id=aa;this.commentId=sa;this.currentState=Oa;this.history=ib}}Object(k.a)(na,"CommentTaskItem",
null,[]);class ba{constructor(aa,sa="",Oa="",ib=""){this.IsCurrentUser=!1;this.UserId=aa;this.Provider=sa;this.DisplayName=Oa;this.Email=ib}}Object(k.a)(ba,"CommentTaskPerson",null,[1567]);const Ea=aa=>{const sa=new ba(aa.UserId,aa.Provider,aa.DisplayName,aa.Email);sa.IsCurrentUser=aa.IsCurrentUser;return sa};var La=d(1006);d(284);class ta{constructor(aa){this.extensions=aa}}Object(k.a)(ta,"ExtensionList",null,[]);class oa{static clone(aa){aa=oa.iti(aa.extensions);return new ta(aa)}static UDf(aa){return aa?
oa.clone(aa):null}static isEmpty(aa){return!aa.extensions||!aa.extensions.count}static Wa(aa){return!aa||oa.isEmpty(aa)}static iti(aa){if(!aa)return null;const sa=new La.a;aa.forEach((Oa,ib)=>{sa.add(Oa,ib);return!0});return sa}}Object(k.a)(oa,"ExtensionListExtensions",null,[]);class wa{static clone(aa){var sa=Ea(aa.user);sa=new Y(aa.type,sa,aa.time,aa.recordId,aa.isLossy);sa.commentId=aa.commentId;sa.anchorExtensionList=oa.UDf(aa.anchorExtensionList);sa.recordExtensionList=oa.UDf(aa.recordExtensionList);
aa.assignee&&(sa.assignee=Ea(aa.assignee));if(aa.schedule){var Oa=aa.schedule;const ib=new da;ib.startDate=Oa.startDate;ib.endDate=Oa.endDate;sa.schedule=ib}sa.completion=aa.completion;sa.title=aa.title;sa.priority=aa.priority;sa.undoId=aa.undoId;return sa}}Object(k.a)(wa,"HistoryRecordExtensions",null,[]);class ra{constructor(aa,sa,Oa,ib,Gb,Bb,Cc,cc=!1){this.uyc=aa;this.tBc=sa;this.qqa=Oa;this.vOh=ib;this.MQb=Gb;this.JQb=Bb;this.KQb=Cc;this.dzc=cc}xGi(aa,sa,Oa,ib=null){if(!aa)throw n.ULS.sendTraceTag(42796181,
327,10,"taskId cannot be null."),Error.argumentNull("taskId");if(!sa)throw n.ULS.sendTraceTag(42796182,327,10,"parentCommentId cannot be null."),Error.argumentNull("parentCommentId");if(!Oa||!Oa.length)throw n.ULS.sendTraceTag(42796183,327,10,"records cannot be null or empty."),Error.argumentNull("records");if(1!==Oa[0].type)throw n.ULS.sendTraceTag(42796184,327,10,"First record must be a Create record."),Error.argument("First record must be a Create record.");var Gb=[],Bb=null,Cc=this.WFk(Oa);for(var cc of Oa)if(!Cc.contains(cc.recordId))if(Oa=
this.f6f(cc.commentId,ib),Oa=this.R0i(cc,Oa),1===Oa.type){let re=[];this.dzc&&Bb&&Bb.state&&(re=Bb.state.assignees);Bb=new ha(this.uyc,Oa,this.MQb,this.JQb,this.KQb,this.dzc,re);Gb.push(Bb)}else if(Bb)Bb.lBl(Oa);else throw n.ULS.sendTraceTag(595198539,327,10,"Undo resulted in ignoring of Task creation without also ignoring records after the create record."),Error.argument("Undo resulted in ignoring of Task creation without also ignoring records after the create record.");Cc=null;cc=[];if(Bb){Bb.isDeleted||
(Cc=Bb.state);Bb=null;for(var Qd of Gb)Gb=Qd.B9i(Bb),Array.addRange(cc,Gb),Bb=Qd}Qd=this.f6f(sa,ib);Cc&&(Cc.completion=this.Cvi(sa,ib,Cc.completion));return new na(aa,Qd,Cc,cc)}m0i(aa,sa,Oa,ib=null){if(!sa)throw n.ULS.sendTraceTag(42796185,327,10,"update cannot be null."),Error.argumentNull("update");if(Oa&&!aa)throw n.ULS.sendTraceTag(42796187,327,10,"CommentId must be specified for task creation."),Error.argument("commentId");const Gb=[],Bb=this.qqa.j6i();if(Oa){var Cc=this.qqa.rCa(1,aa,Bb);Gb.push(Cc)}Cc=
null;if(sa.assigneeUpdate){if(!sa.assigneeUpdate.assigneesToAdd||!sa.assigneeUpdate.assigneesToRemove)throw n.ULS.sendTraceTag(536999254,327,15,"Invalid AssigneeUpdate."),Error.argument("Schedule","Invalid AssigneeUpdate.");for(var cc=0;cc<sa.assigneeUpdate.assigneesToAdd.length;cc++){var Qd=this.uIf(2,sa.assigneeUpdate.assigneesToAdd[cc],aa,Bb);Qd&&Gb.push(Qd)}for(cc=0;cc<sa.assigneeUpdate.assigneesToRemove.length;cc++)(Qd=this.uIf(3,sa.assigneeUpdate.assigneesToRemove[cc],aa,Bb))&&Gb.push(Qd)}else sa.assignee&&
(Oa||(Cc=this.qqa.rCa(4,aa,Bb),Gb.push(Cc)),cc=this.qqa.rCa(2,aa,Bb),Cc=this.tBc.KLa(sa.assignee),cc.assignee=Cc,Gb.push(cc));sa.title?(ib=this.qqa.rCa(9,aa,Bb),ib.title=sa.title,Gb.push(ib)):Oa&&ib&&(cc=this.qqa.rCa(9,aa,Bb),cc.title=this.vOh.Ilj(ib,Cc),Gb.push(cc));if(sa.schedule){if(sa.schedule.startDate>sa.schedule.endDate)throw n.ULS.sendTraceTag(42796188,327,10,"Invalid schedule."),Error.argument("Schedule","Invalid schedule.");ib=this.qqa.rCa(5,aa,Bb);ib.schedule=sa.schedule;Gb.push(ib)}if(void 0!==
sa.completion&&null!==sa.completion){ib=sa.completion;if(0>ib||100<ib)throw n.ULS.sendTraceTag(42796189,327,10,"Invalid completion state."),Error.argumentOutOfRange("completion");Oa||n.ULS.sendTraceTag(595198538,327,50,"Task progress change. [Progress: {0}]",ib);Oa=this.qqa.rCa(6,aa,Bb);Oa.completion=ib;Gb.push(Oa)}if(void 0!==sa.priority&&null!==sa.priority){sa=sa.priority;if(0>sa||10<sa)throw n.ULS.sendTraceTag(42796190,327,10,"Invalid priority state."),Error.argumentOutOfRange("priority");aa=this.qqa.rCa(10,
aa,Bb);aa.priority=sa;Gb.push(aa)}return Gb}uIf(aa,sa,Oa,ib){if(2!==aa&&3!==aa)return n.ULS.sendTraceTag(0,327,10,"Assignee field should only be used for an Assign or Unassign HistoryRecord."),null;aa=this.qqa.rCa(aa,Oa,ib);aa.assignee=this.tBc.KLa(sa);return aa}WFk(aa){const sa=new F.a,Oa=new F.a;for(let ib=aa.length-1;0<=ib;ib--){const Gb=aa[ib],Bb=Oa.contains(Gb.recordId);Bb||-1!==Gb.type||(Oa.contains(Gb.undoId)?n.ULS.sendTraceTag(578670598,327,50,"Multiple Undo records attempting to undo the same record."):
Oa.add(Gb.undoId));if(Bb||-1===Gb.type)sa.contains(Gb.recordId)?n.ULS.sendTraceTag(578670599,327,50,"Record was already added to records to ignore. There must be multiple records with same ID."):sa.add(Gb.recordId)}return sa}R0i(aa,sa){const Oa=wa.clone(aa);Oa.commentId=sa;Oa.user=this.tBc.KLa(aa.user);Oa.assignee=this.tBc.KLa(aa.assignee);return Oa}Cvi(aa,sa,Oa){let ib=Oa;aa&&sa&&(({value:sa}=sa.Uf(aa)).returnValue?(ib=sa.ResolveState?100:100===Oa?0:Oa,ib!==Oa&&n.ULS.sendTraceTag(592719873,327,50,
"Task completion state has been changed to match comment resolution state for comment {0}",aa)):n.ULS.sendTraceTag(592719874,327,50,"Comment {0} not found in translation map. Completion unchanged",aa));return ib}f6f(aa,sa){let Oa=aa;aa&&sa&&(({value:sa}=sa.Uf(aa)).returnValue?Oa=sa.CommentId:(n.ULS.sendTraceTag(42796191,327,50,"Id not found in translation map. Possible Orphan task candidate [CommentId: {0}]",aa),Oa=aa));return Oa}}Object(k.a)(ra,"CommentTaskTranslatorImpl",null,[1205]);class ya{constructor(){this.s2a=
{};this.s2a.ops=[]}eFj(aa){const sa=this.s2a.ops;if(sa.length){var Oa=sa.length-1;const ib=sa[Oa];if(!ib.attributes){ib.insert+=aa;sa[Oa]=ib;this.s2a.ops=sa;return}}Oa={};Oa.insert=aa;Array.add(sa,Oa)}DEj(aa,sa,Oa){var ib={};ib.fullName=sa.fullName;ib.email=sa.email;ib.resolveState=sa.resolveState;sa={};sa.atmention=ib;aa=this.MWd(aa,sa);Oa&&(ib={},ib.contentId=Oa.contentId,Oa={},Oa.atmention=ib,aa.optional=Oa);Array.add(this.s2a.ops,aa)}insertImage(aa,sa){aa=this.MWd(aa,{});const Oa={};Oa.base64=
sa.base64;sa={};sa.image=Oa;aa.optional=sa;Array.add(this.s2a.ops,aa)}insertHyperLink(aa,sa){const Oa={};Oa.link=sa.link;this.N8k(Oa,sa);Array.add(this.s2a.ops,this.MWd(aa,Oa))}I6i(){return Sys.Serialization.JavaScriptSerializer.serialize(this.s2a)}MWd(aa,sa){const Oa={};Oa.insert=aa;Oa.attributes=sa;return Oa}N8k(aa,sa){this.djb(sa.weight>=ya.whk,aa,"weight",sa.weight);this.djb(sa.italic,aa,"italic",!0);this.djb(sa.underline,aa,"underline",!0);this.djb(sa.strikethrough,aa,"strikethrough",!0);this.djb(!!sa.highlight,
aa,"highlight",sa.highlight);this.djb(!!sa.color,aa,"color",sa.color);this.djb(!!sa.paragraph,aa,"paragraph",sa.paragraph)}djb(aa,sa,Oa,ib){aa&&(sa[Oa]=ib)}static JZf(aa){return Sys.Serialization.JavaScriptSerializer.deserialize(aa,!0)}}ya.whk=700;Object(k.a)(ya,"DeltaFormatCreator",null,[1537]);var Da=d(523),pa=d(1133);class la{constructor(){this.ellipsis=CommonUIStrings.l_Ellipsis}Ilj(aa,sa){if(!aa)throw n.ULS.sendTraceTag(592998807,327,10,"Missing commentRichText"),Error.argumentNull("commentRichText");
try{var Oa=ya.JZf(aa)}catch(Qd){throw n.ULS.sendTraceTag(592998806,327,10,"commentRichText not in Delta Format"),Error.format("Improperly formatted Delta text in commentRichText");}var ib=aa=0,Gb=0;const Bb=RegExp("\\s+","g"),Cc=new Sys.StringBuilder;for(var cc of Oa.ops)cc.attributes&&cc.attributes.atmention&&cc.attributes.atmention.email&&sa&&(Oa=cc.attributes.atmention.email,0<Oa.length&&(Oa===sa.UserId||Oa===sa.Email||Oa===Da.a.h8a(sa.UserId))&&(ib=aa,Gb=ib+cc.insert.length)),Oa=cc.insert.replace(Bb,
" "),aa+=Oa.length,Cc.append(Oa);!Gb&&sa&&n.ULS.sendTraceTag(592998805,327,10,"Assignee was not found in comment text",sa.Provider);sa=Cc.toString().trimEnd();aa=sa.length;255<aa?(cc=(255-(Gb-ib))/2,0>ib-cc?(aa=pa.a.instance.k4d(sa,255-this.ellipsis.length),Gb=sa.substring(0,aa)+this.ellipsis,aa="Trimmed End"):Gb+cc>aa?(ib=pa.a.instance.NRc(sa,aa-255+this.ellipsis.length),Gb=this.ellipsis+sa.substring(ib,aa),aa="Trimmed Start"):(ib=pa.a.instance.NRc(sa,ib-cc+this.ellipsis.length),aa=pa.a.instance.k4d(sa,
Gb+cc-this.ellipsis.length),Gb=this.ellipsis+sa.substring(ib,aa)+this.ellipsis,aa="Trimmed Both")):(aa="No Trim",Gb=sa);n.ULS.sendTraceTag(592998804,327,50,aa);return Gb}}Object(k.a)(la,"ContentExtractor",null,[]);class Fa{constructor(aa,sa){this.aSh=aa;this.AUh=sa;this.ojb=this.skb=!1}KLa(aa){if(!aa)return null;if(void 0===aa.UserId||null===aa.UserId)throw n.ULS.sendTraceTag(593368219,327,10,"Unexpected user missing UserId field"),Error.argumentType();if(aa.IsCurrentUser||!this.aSh.equals(this.AUh.value,
aa))return aa;aa=Ea(aa);aa.IsCurrentUser=!0;return aa}}Object(k.a)(Fa,"EnsureIsCurrentUserSetTransformer",null,[1573]);class Qa{constructor(){this.ojb=this.skb=!1}KLa(aa){if(!aa)return null;if(void 0===aa.UserId||null===aa.UserId)return aa;if(!aa.Email||""===aa.Email){let sa;if(sa=Da.a.h8a(aa.UserId))return aa=Ea(aa),aa.Email=sa,aa}return aa}}Object(k.a)(Qa,"RestoreEmailTransformer",null,[1573]);class Sa{constructor(){this.ojb=this.skb=!1}KLa(aa){if(!aa)return null;if(void 0!==aa.UserId&&null!==aa.UserId)return aa;
switch(this.skb?this.ojb?2:1:0){case 0:if(void 0===aa.UserId||null===aa.UserId)throw n.ULS.sendTraceTag(593368215,327,10,"assignee missing UserId"),Error.argument("assignee.UserId");aa=Ea(aa);break;case 1:if(void 0===aa.Id||null===aa.Id)throw n.ULS.sendTraceTag(593368214,327,10,"assignee missing Id"),Error.argument("assignee.Id");if(void 0===aa.Email||null===aa.Email)throw n.ULS.sendTraceTag(593368213,327,10,"assignee missing Email"),Error.argument("assignee.Email");var sa=Sa.Z8g(aa.Id,aa.Email,null);
if(!sa||""===sa)throw n.ULS.sendTraceTag(593368212,327,10,"Failed to generate UserId"),Error.argument("UserId");var Oa=e.AFrameworkApplication.fa.Ha("HostAuthType")||"";if("aad"!==Oa.toLowerCase()||sa.startsWith("S::")){if("msa"===Oa.toLowerCase())throw n.ULS.sendTraceTag(593368210,327,10,"Unexpected IPersonObject in MSA Environment"),Error.argument("CommentTaskUserType");n.ULS.sendTraceTag(593368209,327,50,"Receiving IPersonObject with AuthType {0}",Oa)}else throw n.ULS.sendTraceTag(593368211,327,
10,"Unexpected UserID format"),Error.argument("userId");aa=new ba(sa,"AD",aa.DisplayName,aa.Email);break;case 2:if(void 0===aa.UserPrincipalName||null===aa.UserPrincipalName)throw n.ULS.sendTraceTag(593368208,327,10,"assignee missing UserPrincipalName"),Error.argument("assignee.UserPrincipalName");if(void 0!==aa.SuggestionSubtype&&null!==aa.SuggestionSubtype)if("OrganizationUser"===aa.SuggestionSubtype)sa="AD";else throw n.ULS.sendTraceTag(593368207,327,10,"Unexpected LPP SuggestionSubtype : {0}",
aa.SuggestionSubtype),Error.argument("assignee.SuggestionSubtype");else throw n.ULS.sendTraceTag(593368206,327,10,"Missing SuggestionSubtype"),Error.argument("assignee.SuggestionSubtype");Oa=Sa.Z8g(aa.Id,aa.UserPrincipalName,aa.AadObjectId);if(!Oa||""===Oa)throw n.ULS.sendTraceTag(593368205,327,10,"Failed to generate UserId"),Error.argument("UserId");if("AD"===sa&&!Oa.startsWith("S::"))throw n.ULS.sendTraceTag(593368204,327,10,"Unexpected UserID and Provider combination"),Error.argument("userId");
aa=new ba(Oa,sa,aa.Name,aa.UserPrincipalName);break;default:throw n.ULS.sendTraceTag(593368203,327,10,"Unexpected UserType"),Error.argument("assignee.UserType");}return aa}static Z8g(aa,sa,Oa){if(!sa||""===sa)return n.ULS.sendTraceTag(593368218,327,50,"Missing UPN"),aa;if(Oa&&""!==Oa)return"S::"+sa+"::"+Oa;if(!aa||""===aa)return n.ULS.sendTraceTag(593368217,327,50,"Missing ID"),aa;if(aa.startsWith("S::"))return aa;if(-1!==aa.indexOf("@")){Oa=aa.split("@");if(O.a.isValid(Oa[0]))return"S::"+sa+"::"+
Oa[0];n.ULS.sendTraceTag(593368216,327,50,"ID is not in AadObjectId@TenantId format")}return aa}}Object(k.a)(Sa,"UserIdCanonicalizationTransformer",null,[1573]);class Na{constructor(aa,sa,Oa=!1,ib=!1){this.aQh=aa;this.W6e=sa;this.TUh=Oa;this.dzc=ib}tBi(){const aa=new Da.a;var sa=new Q.a(Na.Y5i);const Oa=new W;this.W6e&&(Oa.QNb.push(new Sa),Oa.QNb.push(new Qa));this.aQh&&Oa.QNb.push(new Fa(aa,sa));Oa.skb=this.W6e;Oa.ojb=this.TUh;sa=new S(sa,Oa);const ib=new la;return new ra(aa,Oa,sa,ib,Na.dJi,Na.QIi,
Na.RIi,this.dzc)}static Y5i(){const aa=new ba(e.AFrameworkApplication.fa.Ha("PresenceUserId")||"",e.AFrameworkApplication.fa.Ha("PresenceProvider")||"",e.AFrameworkApplication.userName||"");aa.IsCurrentUser=!0;return aa}}Na.dJi="";Na.QIi=5;Na.RIi=0;Object(k.a)(Na,"CommentTaskTranslatorFactory",null,[1566]);class ua{constructor(){this.qJd=this.t5e=!1;this.Dpb=this.Qs=this.Zbf=this.Kff=this.Jof=this.Tif=this.Anf=this.J7e=this.Pw=this.UVb=null}initialize(aa,sa,Oa,ib=null,Gb=null,Bb=null,Cc=null,cc=null,
Qd=null,re=null){this.Pw=aa;this.J7e=sa;this.Anf=Oa;this.Tif=ib;this.Jof=Gb;this.Kff=Bb;this.Zbf=Cc;this.Qs=cc;this.t5e=!0;this.Dpb=Qd;this.UVb=re}i8b(aa=null,sa=null){if(!this.t5e)return n.ULS.sendTraceTag(41424203,201,10,"InstantiateSharedComments called before activation manager initialization."),new Promise((Oa,ib)=>{ib(u.a.vu(-2130915313))});if(this.qJd)return n.ULS.sendTraceTag(41424204,201,10,"InstantiateSharedComments called after shared comments was already instantiated."),new Promise(()=>
{});this.UVb||(e.AFrameworkApplication.fa.ka("DynamicBundlesIsEnabled")?this.UVb=appResourceLoader.loadChunk("sharedComments"):this.UVb=this.Pw.loadScript("sharedComments"));return this.UVb.then(()=>{aa&&aa();this.qJd||(this.Dpb&&this.Dpb.execute(Oa=>{Oa.logActivity("Office_Docs_SharedComments_InitializeWebFloodgate","InitializeFloodgateServiceInCommentsPane")}),sa&&sa(),sharedComments.instantiate(this.J7e,this.Anf,this.Tif,this.Jof,this.Kff,this.Zbf,this.Qs));this.qJd=!0})}}Object(k.a)(ua,"CommentActivationManager",
null,[1568]);var za=d(13);class Wa{constructor(){this.actionBehavior=this.actionType=0}}Object(k.a)(Wa,"CommentUIActionPayload",null,[]);var yb=d(258);class Za{constructor(aa,sa){this.Ca=aa;this.B1a=sa;this.uvd=new yb.a;for(let Oa of this.B1a)this.uvd.$(Oa.value.canvasActionId,Oa.key),aa=Oa.value,aa.delayActionsUntilRegistration||this.ya(aa)}ya(aa){aa.withFlags?this.Ca.ra(aa.canvasActionId,aa.canvasContextId,Object(za.a)(this,this.rXb,"actionHandler"),97):this.Ca.ya(aa.canvasActionId,aa.canvasContextId,
Object(za.a)(this,this.rXb,"actionHandler"))}Gxa(aa,sa){this.B1a.Hb(aa)&&(this.B1a.ga(aa).delayActionsUntilRegistration&&this.ya(this.B1a.ga(aa)),this.B1a.ga(aa).registeredCallback=sa)}rXb(aa,sa,Oa,ib,Gb){if(this.uvd.Hb(aa)){var Bb=this.uvd.ga(aa);if(!this.B1a.Hb(Bb))return 8;const Cc=this.B1a.ga(Bb);if(Cc.preCallback){const cc=Cc.preCallback(aa,sa,Oa,ib,Gb);if(2!==cc)return cc}if(!Cc.registeredCallback)return 1===Oa?8:2;Bb=Object.assign(new Wa,{actionType:Bb});1===Oa&&(Bb.actionBehavior=1);Bb=Cc.registeredCallback(Bb);
return Cc.postCallback?Cc.postCallback(Bb,aa,sa,Oa,ib,Gb):Bb?32:8}return 2}}Object(k.a)(Za,"OfficeSharedCommentsActionHost",null,[1546]);var ub=d(342),Ib=d(35),Ob=d(189);class Hc{}Object(k.a)(Hc,"CommentActivityData",null,[]);var kb=d(141),jb=d(71);class hb{constructor(aa,sa,Oa,ib,Gb,Bb,Cc,cc,Qd,re=null,Ca=null){this.Npf={["CancelCommentCreateThreadAction"]:Ib.a.tsh,["CommitComment"]:Ib.a.ush,["CommitDraftAction"]:Ib.a.vsh,["CommitDraftCreateAction"]:Ib.a.kVe,["CommitDraftEditAction"]:Ib.a.mVe,["CommitDraftReplyAction"]:Ib.a.jVe,
["CreateReplyAction"]:Ib.a.jVe,["CreateReplyWithMentions"]:Ib.a.wsh,["CreateReplyWithTaskAssigned"]:Ib.a.xsh,["CreateThreadAction"]:Ib.a.kVe,["CreateThreadWithMentions"]:Ib.a.ysh,["CreateThreadWithTaskAssigned"]:Ib.a.zsh,["DeletePostAction"]:Ib.a.Ash,["DeleteThreadAction"]:Ib.a.Bsh,["DeleteThreadWithTask"]:Ib.a.Csh,["DiscardDraftAsync"]:Ib.a.Dsh,["PresentLinkToCommentAction"]:Ib.a.Esh,["ResolveThreadAction"]:Ib.a.Ish,["ResolveThreadWithTask"]:Ib.a.Jsh,["ReopenThreadAction"]:Ib.a.Fsh,["ReopenThreadWithTask"]:Ib.a.Gsh,
["RequestInitCommentSession"]:Ib.a.Hsh,["SelectCommentAction"]:Ib.a.Ksh,["UpdateCommentBodyAction"]:Ib.a.mVe};this.dataCenter=this.ring=this.sessionId=this.releaseChannel=this.releaseAudience=this.appVersion=this.appName=null;this.disableUpload=!1;this.sovereignEnvironmentName=null;this.appName=aa;this.appVersion=sa;this.releaseAudience=Oa;this.releaseChannel=ib;this.sessionId=Gb;this.ring=Bb;this.dataCenter=Cc;this.disableUpload=cc;this.sovereignEnvironmentName=Ca;this.Ca=Qd;this.Vif=re;this.fEj()}fEj(){this.Ca.ya(Ib.a.tsh,
jb.a.frame,Ob.ActionManager.Jg);this.Ca.ya(Ib.a.ush,jb.a.frame,Ob.ActionManager.Jg);this.Ca.ya(Ib.a.vsh,jb.a.frame,Ob.ActionManager.Jg);this.Ca.ya(Ib.a.jVe,jb.a.frame,Ob.ActionManager.Jg);this.Ca.ya(Ib.a.wsh,jb.a.frame,Ob.ActionManager.Jg);this.Ca.ya(Ib.a.xsh,jb.a.frame,Ob.ActionManager.Jg);this.Ca.ya(Ib.a.kVe,jb.a.frame,Ob.ActionManager.Jg);this.Ca.ya(Ib.a.ysh,jb.a.frame,Ob.ActionManager.Jg);this.Ca.ya(Ib.a.zsh,jb.a.frame,Ob.ActionManager.Jg);this.Ca.ya(Ib.a.Ash,jb.a.frame,Ob.ActionManager.Jg);this.Ca.ya(Ib.a.Bsh,
jb.a.frame,Ob.ActionManager.Jg);this.Ca.ya(Ib.a.Csh,jb.a.frame,Ob.ActionManager.Jg);this.Ca.ya(Ib.a.Dsh,jb.a.frame,Ob.ActionManager.Jg);this.Ca.ya(Ib.a.Esh,jb.a.frame,Ob.ActionManager.Jg);this.Ca.ya(Ib.a.Ish,jb.a.frame,Ob.ActionManager.Jg);this.Ca.ya(Ib.a.Jsh,jb.a.frame,Ob.ActionManager.Jg);this.Ca.ya(Ib.a.Fsh,jb.a.frame,Ob.ActionManager.Jg);this.Ca.ya(Ib.a.Gsh,jb.a.frame,Ob.ActionManager.Jg);this.Ca.ya(Ib.a.Hsh,jb.a.frame,Ob.ActionManager.Jg);this.Ca.ya(Ib.a.Ksh,jb.a.frame,Ob.ActionManager.Jg);this.Ca.ya(Ib.a.mVe,
jb.a.frame,Ob.ActionManager.Jg)}sendULSTrace(aa,sa,Oa,ib){n.ULS.sendTraceTag(aa,sa,Oa,ib)}recordActivity(aa){this.Npf[aa]&&this.Ca.processAction(this.Npf[aa],2)}sendOtelEvent(aa){kb.a.sendOtelEvent(aa)}recordPerfData(aa,sa){this.Vif&&(aa=Object.assign(new Hc,{durationMs:sa,name:aa}),this.Vif.Gna(aa))}}Object(k.a)(hb,"OfficeSharedCommentsTelemetry",null,[]);var uc=d(268);class mc{constructor(aa,sa,Oa,ib){this.isRightToLeft=!1;this.dataCulture=this.uiCulture=this.appLocale=null;this.isRightToLeft=aa;
this.appLocale=sa;this.uiCulture=Oa;this.dataCulture=ib}}Object(k.a)(mc,"LocalizationDetails",null,[]);var Ya=d(288),Mb=d(65),Kc=d(91);class eb{constructor(aa,sa){this.v2h=aa;this.i$e=sa}getViewContainer(){return this.v2h}registerForViewContainerEvents(aa){this.i$e.MQk(aa)}unregisterForViewContainerEvents(aa){this.i$e.Fwl(aa)}}Object(k.a)(eb,"ViewContainerProvider",null,[1494]);var Tb=d(68),lb=d(1186),Fb=d(33),rb=d(27),Qb=d(247),Bc=d(207),wb=d(26),Ad=d(245),bc=d(631);class Sb{static F0f(aa){return aa===
Sb.create?0:aa===Sb.reply?1:aa===Sb.edit?2:aa===Sb.metadata?3:null}}Sb.create="CREATE";Sb.reply="REPLY";Sb.edit="EDIT";Sb.metadata="METADATA";Object(k.a)(Sb,"CommentSessionType",null,[]);class Zb{constructor(){this.insertIndex=0;this.author=this.updatedSessionParams=this.anchorHintText=this.authorIdentity=this.authorName=null}}Object(k.a)(Zb,"InitCommentSessionResult",null,[]);class cb extends Zb{constructor(){super();this.updatedDraftSessionConfiguration=null}}Object(k.a)(cb,"BeginDraftingHostResult",
Zb,[]);class Xa{constructor(aa,sa="",Oa="",ib="",Gb=!1){this.Email=this.DisplayName=this.Provider=this.UserId=null;this.IsCurrentUser=!1;this.UserId=aa;this.Provider=sa;this.DisplayName=Oa;this.Email=ib;this.IsCurrentUser=Gb}}Object(k.a)(Xa,"OfficeSharedCommentUser",null,[]);var Lb=d(45),pc=d(55),fc=d(190),bd=d(34);class od{constructor(aa,sa,Oa){this.Jq=aa;this.A5j=sa;this.K4j=Oa;this.Vug=null;this.mCg=!1}get pQa(){return this.Jq}get fC(){return this.A5j}get commentId(){return this.K4j}get g8(){return this.Vug}set g8(aa){this.Vug=
aa}get TZc(){return this.mCg}set TZc(aa){this.mCg=aa}}Object(k.a)(od,"ActiveCommentSession",null,[]);var ye=d(676);class pd{static get ogk(){return 50}static V1i(aa){return pd.D4i(aa)}static $dj(aa){if(""===aa)return"";let sa=0,Oa="";try{const ib=ya.JZf(aa);for(const Gb of ib.ops)if(pd.Tta(Gb))sa||(Oa+=pd.C8i(Gb.attributes.atmention.fullName)),sa+=1;else{const Bb=Gb.insert?Gb.insert:"";" "!==Bb&&0<Bb.length&&(sa=0,Oa+=Bb)}}catch(ib){n.ULS.sendTraceTag(558428681,327,10,"Comment formatString could not be deserialized since it is not in a proper Delta Format.")}return Oa}static D4i(aa){aa=
pd.$dj(aa);return 0<aa.length&&aa.split(" ").length<=pd.ogk?aa:null}static C8i(aa){let sa="";aa&&(aa=aa.split(" "),0<aa.length&&(sa=aa[0]));return sa}static Tta(aa){return!!aa.attributes&&!!aa.attributes.atmention}}Object(k.a)(pd,"BaseCommentSmartReplyHelpers",null,[]);class ab{constructor(aa){this.vpe=aa}MCl(aa,sa,Oa,ib){-1===Oa||sa||(sa=ib[Oa],Oa=sa.author?sa.author.IsCurrentUser:!1,sa&&sa.commentBody&&!Oa&&(sa=pd.V1i(sa.commentBody))&&this.vpe.invoke(aa,sa))}}Object(k.a)(ab,"CommentSmartReplyHelpers",
null,[]);class Yb{constructor(aa,sa,Oa,ib,Gb,Bb,Cc,cc,Qd,re,Ca,ob,Hb,rc,td,sc){this.M7c=!1;this.kb=aa;this.UWa=sa;this.Iqe=Oa;this.z3j=ib;this.zb=Gb;this.Yb=Bb;this.xad=Cc;this.Q4j=cc;this.Kva=Qd;this.vpe=Ca;this.U5j=ob;this.fva=Hb;this.x8c=rc;this.I4j=td;this.ia=sc}beginDraftingAsync(aa){if(!aa)return new Promise((Oa,ib)=>{ib(u.a.vu(-2130915327))});const sa=Sb.F0f(aa.sessionType);return void 0===sa||null===sa?new Promise((Oa,ib)=>{ib(u.a.vu(-2130915317))}):2===sa&&aa.commentId===Yb.PFb?new Promise((Oa,
ib)=>{ib(u.a.vu(-2130915324))}):new Promise((Oa,ib)=>{u.a.Aqb(this.zb,()=>{var Gb=this.kb.s7d(),Bb=null;let Cc=-1;wb.a.J(512496833,805,50,"CommentAPI::BeginDraftingAsync - SessionType: {0}",sa);try{switch(sa){case 0:if(this.x8c)try{Cc=this.kb.z0f(!0)}catch(Ca){wb.a.J(512496832,801,10,"GetIndexForDraftCommentCardInsertion threw en exception{0}",Ca),Cc=Gb.length}else Cc=Gb.length;Bb=new od(sa,aa,"");this.M7c=!0;break;case 1:if(!aa.threadId||!aa.threadId.length)throw u.a.vu(-2130915324);Cc=Yb.g$i(Gb,
aa.threadId);if(-1===Cc)throw u.a.vu(-2130915323);if(this.Yb.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.SmartRepliesIsEnabled",!1)){var cc=aa.threadId;(new ab(this.vpe)).MCl(cc,Yb.Yvj(Gb,cc),Yb.o6d(Gb,cc),Gb)}Bb=new od(sa,aa,aa.threadId);break;case 2:if(!aa.commentId||!aa.commentId.length)throw u.a.vu(-2130915324);Cc=Yb.o6d(Gb,aa.commentId);if(-1===Cc)throw u.a.vu(-2130915323);Bb=new od(sa,aa,aa.commentId);break;case 3:Cc=Yb.o6d(Gb,aa.threadId);Bb=new od(sa,aa,aa.threadId);break;default:throw u.a.vu(-2130915322);
}if(!Bb)throw u.a.vu(-2130915322);var Qd=this.kb.lBj(Bb);if(Qd)throw Qd;}catch(Ca){ib(Ca);return}Gb=new cb;Bb=this.Yb.Ha("UserName");Qd=this.Yb.Ha("387");cc=this.Yb.Ha("388");const re=bd.a("PPTPlumbEmailThroughCG")?Da.a.h8a(Qd||""):"";Qd=new Xa(Qd,cc,Bb,re,!0);Gb.author=Qd;Gb.insertIndex=Cc;Gb.authorName=Bb;Gb.authorIdentity=new String;Oa(Gb)})})}commit(aa,sa,Oa){if(!this.kb.vLc)throw wb.a.J(512496803,805,10,"CommentAPI::Commit - CurrentCommentSession is null; CommentSessionEndReason:{0}",this.kb.Rui),
u.a.vu(-2130915320);var ib=this.kb.vLc.fC;if(!ib)throw wb.a.J(512496802,805,15,"CommentAPI::Commit - CurrentCommentSession.DraftConfiguration is null"),u.a.vu(-2130915320);const Gb=Sb.F0f(ib.sessionType);if(void 0===Gb||null===Gb)throw u.a.vu(-2130915317);if(aa!==ib.draftId)throw u.a.vu(-2130915327);const Bb=this.fva?fc.e(O.a.create().toString()):"";this.kb.EMf();switch(Gb){case 0:return wb.a.J(512496801,805,50,"CommentAPI::Commit - Create Comment {0}",Bb),ib={},this.kb.dWk(Bb),ib.commentId=Bb,this.M7c=
!1,this.kb.i_g=Bb,Yb.ACh(Oa),Yb.zCh(),this.createComment(sa,ib,Oa);case 1:return wb.a.J(512496800,805,50,"CommentAPI::Commit - Create Reply {0}:{1}",ib.threadId,Bb),aa={},aa.parentId=ib.threadId,aa.commentId=Bb,Yb.ACh(Oa),Yb.zCh(),this.createComment(sa,aa,Oa);case 2:return wb.a.J(512496799,805,50,"CommentAPI::Commit - Edit comment {0}",ib.commentId),Oa={},Oa.commentBody=sa,this.Fxl(ib.commentId,Oa),aa;case 3:return wb.a.J(512496798,805,50,"CommentAPI::Commit - Update Metadata {0}",ib.threadId),this.Gxl(ib.threadId,
Oa),ib.threadId;default:throw u.a.vu(-2130915322);}}endCommentSession(aa){wb.a.J(512496797,805,50,"CommentAPI::EndCommentSession - DraftId: {0}",aa);this.kb.endCommentSession(aa,this.M7c?9:1);this.M7c=!1}createComment(aa,sa,Oa){const ib=this.xad.osd(aa,new Date);let Gb="";this.fva&&(Gb=Lb.a.Wa(sa.commentId)?O.a.create().toString():sa.commentId);let Bb=null;void 0!==Oa&&null!==Oa&&(Bb=this.xad.ksl(Gb,Oa.Task,aa));aa=this.kb.Amd;if(Oa=sa.parentId?null:this.kb.Ckj())aa=this.kb.p2k;this.UWa.n4h(Gb,ib.plainText,
sa.parentId,aa,this.kb.anchorNode,ib.d_g,Bb,Oa);return Lb.a.Wa(Gb)?Yb.PFb:Gb}deleteComment(aa){if(aa===Yb.PFb)throw u.a.vu(-2130915327);wb.a.J(512496796,805,50,"CommentAPI::DeleteComment - {0}",aa);this.UWa.deleteComment(aa)}selectComment(aa){aa!==Yb.PFb&&this.kb.Kfa(aa,0,!1)}highlightComment(aa){aa!==Yb.PFb&&this.kb.q3h(aa)}AFh(aa,sa,Oa){const ib=Array.clone(this.kb.s7d());var Gb=null;for(var Bb of ib)if(Bb.commentId===aa){Gb=Bb;break}if(!Gb)throw wb.a.J(512496795,805,10,"Comment ID not found, UI and model in a mismatched state."),
u.a.vu(-2130915323);(Bb=e.AFrameworkApplication.userName)&&0<Bb.length&&Bb!==Gb.author.DisplayName&&wb.a.J(512496794,805,50,"Author of comment being edited is not the current user (isAnonymous={0})",e.AFrameworkApplication.Alb||e.AFrameworkApplication.LQ);Bb=new Date;Gb=this.xad.osd(Gb.commentBody,null).plainText;sa=this.xad.osd(sa.commentBody,Bb);this.UWa.rOi(sa.plainText,aa,sa.d_g);Oa||Gb!==sa.plainText||this.Iqe.coh(ib,this.kb.j0g,Array.clone(this.kb.g2f()))}Fxl(aa,sa){if(aa===Yb.PFb)throw u.a.vu(-2130915327);
sa.commentBody&&(this.Yb.ka("896")?this.AFh(aa,sa,!0):u.a.Aqb(this.zb,()=>{this.AFh(aa,sa,!1)}))}Gxl(aa,sa){if(void 0===sa.Resolve||null===sa.Resolve)throw u.a.vu(-2130915327);const Oa=sa.Resolve.isResolved;let ib=Oa?100:0;void 0!==sa.Task&&null!==sa.Task&&(ib=sa.Task.completion);this.UWa.BFh(aa,Oa?1:0,ib);Oa&&this.kb.f5k()}setThreadResolvedState(aa,sa){this.UWa.BFh(aa,sa?1:0,sa?100:0);sa&&this.kb.KLf(aa)}selectFirstThreadInNextCommentContext(){this.kb.$1k()}selectLastThreadInPreviousCommentContext(){this.kb.c2k()}presentLinkToComment(aa){if(aa=
this.UWa.rij(aa)){aa=JSON.stringify({["sId"]:aa.sid,["cId"]:aa.cid});var sa={};sa.nav=ye.a(aa);sa.mode="copy";wb.a.J(512496792,805,50,"PresentLinkToComment: nav:{0}",aa);this.ia.La(Ib.a.Ksa,2,sa)}else wb.a.J(512496793,805,50,"PresentLinkToComment failed")}registerForCommentEvents(aa){this.I4j.Ibj().then(sa=>{this.Iqe.OPk(aa,this.kb.s7d(),this.kb.j0g,this.kb.isReadOnly,this.kb.g2f(),sa,this.Q4j.n0c)})}unregisterForCommentEvents(aa){this.Iqe.ZEh(aa)}registerForAction(aa,sa){this.z3j.Gxa(aa,sa);this.kb.gOk()}unregisterForAction(){}loadThreads(){wb.a.J(512496791,
805,10,"LoadThreads is not supported on WAC")}checkAtMentionCapability(){return new Promise(aa=>{e.AFrameworkApplication.fa.jf(()=>{this.Kva?this.Kva.atMentionsEnabledAsync().then(sa=>{aa(sa);return null}):aa(!1)})})}resolveSupported(){return this.U5j}static g$i(aa,sa){let Oa=!1;for(let ib=0;ib<aa.length;ib++){if(Oa&&aa[ib].commentId!==sa&&aa[ib].parentId!==sa)return ib;aa[ib].commentId===sa&&(Oa=!0)}return Oa?aa.length:-1}static Yvj(aa,sa){let Oa=!1;for(let ib=0;ib<aa.length;ib++)if(aa[ib].commentId===
sa&&(Oa=!0),Oa&&aa[ib].parentId===sa)return!0;return!1}static o6d(aa,sa){for(let Oa=0;Oa<aa.length;Oa++)if(aa[Oa].commentId===sa)return Oa;return-1}static zCh(){if(bd.a("CommentsFpsIsEnabled"))try{const aa=pc.a.instance.Ja("Common.ISystemInitiatedFeedback");aa&&aa.execute(sa=>{sa.logActivity("PPTWebCommitNewCommentActivity","CommentsFpsIsEnabledBRS")})}catch(aa){wb.a.J(512496790,805,10,"Exception thrown while triggering PPTWebCommitNewCommentActivity. Exception: {0}",aa)}}static ACh(aa){if(bd.a("CommentsTasksFpsIsEnabled")&&
aa&&aa.Task)try{const sa=pc.a.instance.Ja("Common.ISystemInitiatedFeedback");sa&&sa.execute(Oa=>{Oa.logActivity("PPTWebCommitTaskActivity","CommentsTasksFpsIsEnabledBRS")})}catch(sa){wb.a.J(512496789,805,10,"Exception thrown while triggering PPTWebCommitTaskActivity. Exception: {0}",sa)}}}Yb.PFb="temp-id";Object(k.a)(Yb,"CommentAPI",null,[1232,1233]);var Sc=d(199),Jb=d(347),Oc=d(681);class Wb{constructor(aa,sa,Oa){this.vkc=aa;this.commentId=sa;this.state=Oa}}Object(k.a)(Wb,"CommentTextAnchorToHighlight",
null,[]);var Ab=d(54),Xb=d(75),vb=d(31),$c=d(88),fd=d(90),Bd=d(49);class gd{constructor(){this.pzd=this.bKd=this.nOa=null;this.K9f=!1;this.trd=this.urd=this.endPos=this.startPos=0}get paragraphs(){return this.nOa}get ZU(){return this.bKd}set ZU(aa){this.bKd=aa;this.nOa=[];this.nOa.push(this.bKd)}get d3(){return this.pzd}set d3(aa){this.pzd=aa;this.nOa&&this.k$b&&this.nOa.push(this.pzd)}sUi(){for(const aa of this.nOa){const sa=Object(lb.a)(5,aa);if(sa&&-1!==sa.bwb().indexOf("\ufffc"))return!0}return!1}Qkg(aa){const sa=
(this.trd&4294967295)>>>0;aa.TextBodyLength!==this.urd||sa===aa.TextBodyHash||gd.tmh.contains(this.trd)||(gd.tmh.add(this.trd),wb.a.J(554280861,805,50,"IsTextBodyLengthValid - text body length matches but hash does not; ContainsObjectReplaceChar:{0}",this.sUi()));return aa.TextBodyLength===this.urd}get Ceh(){let aa=0;if(this.isValid)if(this.k$b){aa+=vb.ParagraphReader.textLength(this.ZU)-this.startPos;aa+=this.endPos;for(let sa=1;sa<this.paragraphs.length-1;sa++){const Oa=this.paragraphs[sa];Oa&&
(aa+=vb.ParagraphReader.textLength(Oa)+1)}}else aa=this.endPos-this.startPos;return aa}get xLa(){if(!this.isValid)return $c.a.auto;var aa=Bd.a.Kj(this.ZU,this.startPos+1);if(!aa)return $c.a.auto;aa=fd.a.ps(aa);return aa?(aa=aa.cache)&&aa.C3?aa.fontColor:$c.a.auto:$c.a.auto}get isValid(){return!!this.ZU&&!!this.d3&&!!this.paragraphs}get k$b(){return!this.ZU.equals(this.d3)}R5h(aa){this.nOa&&aa&&this.nOa.push(aa)}dGj(){if(this.isValid&&(this.ZU.wv(16,!0),this.k$b))for(let aa=1;aa<this.paragraphs.length;aa++){const sa=
this.paragraphs[aa];sa&&sa.wv(16,!0)}}EJj(aa,sa){if(!this.isValid)return!1;const Oa=Object(lb.a)(Xb.AParagraphNode,aa.node),ib=Object(lb.a)(Xb.AParagraphNode,sa.node);return!(Oa&&ib&&Array.contains(this.paragraphs,Oa)&&Array.contains(this.paragraphs,ib))||Oa.equals(this.ZU)&&(0>aa.Qa||aa.Qa<this.startPos)||ib.equals(this.d3)&&(0>sa.Nb||sa.Nb>this.endPos)?!1:!0}$Zf(aa){let sa=3;aa&&(!this.k$b&&this.ZU.equals(aa)?sa=2:this.ZU.equals(aa)?sa=0:this.d3.equals(aa)&&(sa=1));return sa}}gd.tmh=new F.a;Object(k.a)(gd,
"TextAnchorParagraphInfo",null,[]);class Pd{static Vub(aa,sa){return aa||sa?aa&&sa?aa.commentId===sa.commentId:!1:!0}static tOc(aa){return!!aa.Children&&0<aa.Children.length}static udj(aa,sa){aa=aa.bwb()+"\r";for(let Oa=0;Oa<aa.length;Oa++){let ib=aa.charCodeAt(Oa);160===ib&&(ib=32);sa=(sa<<5>>>0)+sa+ib}return sa}static xN(aa){return!!aa&&!!aa.textAnchoringInfo&&aa.textAnchoringInfo.EndPos>aa.textAnchoringInfo.StartPos&&0<aa.textAnchoringInfo.TextBodyLength}static W5b(aa,sa){if(!Pd.xN(aa))return null;
if(!sa||1>sa.WD().length)return wb.a.J(574179520,805,sa?10:15,"CommentUtilities::GetTextAnchoredCommentParagraph - CommentAnchorShape is null:{0}, else text anchored shape has no paragraphs",!sa),null;let Oa=null,ib=null,Gb=null;aa.textAnchoringInfo.AnchoringShape&&(aa.textAnchoringInfo.AnchoringShape.TableCell?(Oa=O.a.Hf(aa.textAnchoringInfo.AnchoringShape.TableCell.RowId),ib=O.a.Hf(aa.textAnchoringInfo.AnchoringShape.TableCell.ColId)):aa.textAnchoringInfo.AnchoringShape.SmartArtNodeId&&(Gb=aa.textAnchoringInfo.AnchoringShape.SmartArtNodeId,
Gb.startsWith("{")||(Gb="{"+Gb),Gb.endsWith("}")||(Gb+="}")));let Bb=aa.textAnchoringInfo.StartPos;aa=aa.textAnchoringInfo.EndPos;let Cc=0,cc=0;const Qd=new gd;sa=sa.WD();for(let Ca=0;Ca<sa.length;Ca++){const ob=sa[Ca],Hb=vb.ParagraphReader.textLength(Object(lb.a)(Xb.AParagraphNode,ob));if(Oa&&ib){var re=ob.dL();if(!re||!Oa.equals(re.rowId)||!ib.equals(re.cellId))continue}else if(Gb&&(!ob.get_smartArtModelId()||Gb!==ob.get_smartArtModelId()))continue;if(!Qd.isValid&&(Hb>Bb||Qd.ZU)){if(!Qd.ZU&&(Qd.ZU=
Object(lb.a)(Xb.AParagraphNode,ob),Qd.startPos=Bb,!Qd.ZU))return null;re=Ca===sa.length-1||!!Gb&&Pd.IOj(Gb,sa[Ca+1])||!!Oa&&!!ib&&Pd.HOj(Oa,ib,sa[Ca+1]);re=Hb<aa&&0<Hb&&re;if((Hb>=aa||re)&&!Qd.d3){if(re&&(aa=Hb),Qd.d3=Object(lb.a)(Xb.AParagraphNode,ob),Qd.endPos=aa,!Qd.d3)return null}else ob.equals(Qd.ZU)||Qd.R5h(Object(lb.a)(Xb.AParagraphNode,ob))}Cc+=Hb+1;cc=Pd.udj(ob,cc);Qd.ZU||(Bb-=Hb+1);aa-=Hb+1}Qd.urd=Cc;Qd.trd=cc;return Qd}static IOj(aa,sa){return sa.get_smartArtModelId()&&sa.get_smartArtModelId()===
aa?!1:!0}static HOj(aa,sa,Oa){return(Oa=Oa.dL())&&aa.equals(Oa.rowId)&&sa.equals(Oa.cellId)?!1:!0}static Bkj(aa,sa,Oa,ib){Oa=ib=-1;if(!aa)return wb.a.J(554574735,805,15,"CommentUtilities::GetTextAnchorParagraphFromSelection - Parent shape is null."),{returnValue:null,eLa:Oa,cDa:ib};let Gb=Object(lb.a)(5,sa.Ua.node);const Bb=Object(lb.a)(5,sa.Ye.node);if(!Gb||!Bb)return wb.a.J(554574736,805,15,"CommentUtilities::GetTextAnchorParagraphFromSelection - Start paragraph node is null:{0}; end paragraph node is null:{1}.",
!Gb,!Bb),{returnValue:null,eLa:Oa,cDa:ib};const Cc=sa.Ua.z5a,cc=sa.Ye.wXb;var Qd=vb.ParagraphReader.textLength(sa.Ua.node);sa=vb.ParagraphReader.textLength(sa.Ye.node);if(0>Cc||0>=cc||Cc===cc&&Gb===Bb||Cc>Qd||cc>sa)return wb.a.J(554574737,805,50,"CommentUtilities::GetTextAnchorParagraphFromSelection - Invalid start/end character positions. StartCp:{0}; EndCp{1}; FirstCtxTextLength:{2}; LastCtxTextLenth:{3}.",Cc,cc,Qd,sa),{returnValue:null,eLa:Oa,cDa:ib};aa=aa.WD();if(!aa)return wb.a.J(554574738,805,
15,"CommentUtilities::GetTextAnchorParagraphFromSelection - Parent shape paragraph node list is null."),{returnValue:null,eLa:Oa,cDa:ib};Qd=0;for(const re of aa){if(Bb.get_smartArtModelId()){if(re.get_smartArtModelId()!==Bb.get_smartArtModelId())continue;Gb.get_smartArtModelId()!==Bb.get_smartArtModelId()&&(Gb=re)}if(Bb.ys()){if(re.dL()!==Bb.dL())continue;Gb.dL()!==Bb.dL()&&(Gb=re)}Gb===re&&(Oa=Cc+Qd);Bb===re&&(ib=cc+Qd);if(0<=Oa&&0<=ib)return{returnValue:Gb,eLa:Oa,cDa:ib};Qd+=re.bwb().length+1}0<=
Oa&&-1===ib&&(Gb.get_smartArtModelId()||Gb.ys())&&(ib=Qd-1);return{returnValue:Gb,eLa:Oa,cDa:ib}}static get wHc(){return Ab.a.fg||Ab.a.mUa}static get xOc(){return!Ab.a.Ni}}Object(k.a)(Pd,"CommentUtilities",null,[]);class cd extends Sys.EventArgs{constructor(aa){super();this.Kal=aa}}Object(k.a)(cd,"CommentsVisibilityOnSmartArtChangeEventArgs",Sys.EventArgs,[]);class lf{constructor(aa,sa,Oa,ib,Gb,Bb,Cc,cc,Qd,re){this.ASg=[];this.nbd=null;this.Pod=!1;if(!re)throw Error.argumentNull("viewElementEventNotifier");
this.Kc=sa;this.Mze=this.Kgc=!1;this.F2c=aa;this.Bbk=Oa;this.ccb=this.NVa=null;this.il=ib;this.pa=Gb;this.zVa=Bb;this.fGa=Cc;this.jea=cc;this.L4j=Qd;this.vJ=re;this.jea.nOe(this.L4j)}get vW(){return this.NVa&&this.NVa.isConnected?this.NVa:null}get iwh(){return this.Kgc}ypc(aa,sa,Oa=!1,ib=!1){const Gb=this.Bbk.VG(aa);if(Gb)switch(sa){case 0:Gb.display(Oa,ib);this.NVa=aa;break;case 1:Gb.activate();this.ccb=aa;break;case 2:Gb.dismiss();this.NVa=null;break;case 3:this.vW&&this.vW===aa&&this.l7a&&this.q1d(this.l7a,
aa)?Gb.display(Pd.xN(this.l7a),ib):Gb.dismiss();this.ccb=null;break;case 4:Gb.hMi(Oa),this.NVa=aa}}aod(aa){if(this.Kc&&this.Kc.Ic)switch(aa){case 0:this.Kc.Ic.highlight();this.Kgc=!0;break;case 2:this.Kc.Ic.JEh();this.Kgc=!1;break;case 1:this.Kc.Ic.highlight();this.Mze=!0;break;case 3:this.Kc.Ic.JEh(),this.Mze=!1}}fMc(){this.F2c&&(this.Kgc?this.aod(2):this.vW&&this.ypc(this.vW,2),this.Ytb(null))}q1d(aa,sa){if(!Pd.xN(aa))return!0;aa=this.il.Qy();return Sc.a.any(aa,Oa=>!Pd.xN(Oa)&&Oa.anchorShape===
sa.get_shapeId())}lSe(aa,sa,Oa,ib=!1,Gb=!1){if(this.F2c&&aa&&(!ib||lf.jub(this.il.Qy(),aa))){ib=this.l8(aa);var Bb=this.vW!==ib&&!!this.vW;Bb&&this.pa.Z7(this.vW);this.fMc();if(ib){const Cc=Pd.xN(aa);this.ccb===ib?this.q1d(aa,ib)?this.ypc(ib,4,Cc,Cc&&Bb):this.NVa=ib:this.q1d(aa,ib)?this.ypc(ib,0,Cc,Oa&&Bb):this.NVa=ib;sa=!!sa&&sa===aa.commentId;(Cc||sa)&&Gb||this.I2k(ib,String.format(ResourceStrings.L_CommentAnchoringShapeSelection,aa.authorName,aa.dt.toDateString(),aa.dt.toLocaleTimeString()))}else this.aod(0),
this.Kc&&this.Kc.Ic&&this.Kc.Ic.Fd&&this.Hmd(String.format(ResourceStrings.L_CommentAnchoringSlideCommentSelection,(this.Kc.Ic.Fd.oe+1).toString(),this.Kc.Ic.Fd.title));!Gb&&Bb&&this.pa.selectShape(this.vW,!0,!1);this.Ytb(null)}}p3h(aa){if(this.F2c){var sa=this.l8(aa);sa?Pd.xN(aa)?this.ccb=sa:this.ypc(sa,1):this.aod(1);this.Ytb(aa)}}ILc(){this.ccb&&this.ypc(this.ccb,3);this.Mze&&!this.Kgc&&this.aod(3);this.Ytb(null)}l8(aa){if(!aa)return null;try{return this.fGa.qQc(aa)}catch(sa){return wb.a.J(512496788,
805,15,"GetAnchoredShapeForComment - Exception while getting anchored shape: {0}",sa),null}}Ytb(aa){const sa=[];var Oa=this.ccb;aa&&!Oa&&(Oa=this.vW);const ib=this.vW?this.vW:this.pa.Jp();ib||aa&&Oa||this.yCh(sa);let Gb=null;const Bb=[];var Cc=!1;if(Pd.xN(aa)&&Oa&&0<Oa.WD().length&&(!this.l7a||aa.commentId!==this.l7a.commentId)){var cc=Pd.W5b(aa,Oa);cc&&cc.isValid&&(Cc=Jb.a.Hf("{"+aa.commentId+"}{1}"),sa.push(new Wb(cc,Cc,1)),Cc=!0,Oa=this.fGa.al(Oa))&&(Bb.push(Oa),(Oa=Oa.shapeNode)&&Oa.Rf&&(Gb=Oa))}if(this.Pod||
ib&&0<ib.WD().length)if(Oa=this.il.Qy())for(var Qd of Oa){if(!Pd.xN(Qd)||!this.Pod&&Qd.anchorShape!==ib.get_shapeId()||Cc&&Qd.commentId===aa.commentId)continue;cc=this.Pod?this.l8(Qd):ib;if(!cc)continue;let re=Pd.W5b(Qd,cc);if(!re||!re.isValid)continue;let Ca=5;(Oa=!!this.l7a&&Qd.commentId===this.l7a.commentId)&&(Ca=0);const ob=Jb.a.Hf("{"+Qd.commentId+"}{1}");sa.push(new Wb(re,ob,Ca));if(cc=this.fGa.al(cc))Bb.push(cc),cc=cc.shapeNode,!Gb&&cc&&Oa&&cc.Rf&&(Gb=cc)}for(const re of this.ASg)!re||Array.contains(Bb,
re)||re.shapeNode&&re.shapeNode.Rf||(re.cie=!1,re.$p||!re.Tn||re.$x||re.YMb());aa=null;for(const re of Bb)(Qd=re.shapeNode)&&Qd.Rf?(aa||(aa=Qd),Gb||ib!==Qd||(Gb=Qd)):(re.cie=!0,re.Tn||(wb.a.J(512496787,805,50,"DetermineTextAnchorHighlighting - Switched from FidelityView to EditView to display text anchors"),re.Kqd()));Gb||this.pa.xL()||!aa||(Gb=aa);this.ASg=Bb;this.vJ.FIk(new cd(Gb));this.yCh(sa)}yCh(aa){aa=Object.assign(new Oc.a,{action:0,type:0,jda:aa,rhb:this.jea.jbb?this.jea.jbb.jda:null});this.jea.ond(aa)}Hmd(aa){this.zVa.yfa(aa)}I2k(aa,
sa){this.zVa.Seh(aa,sa)}gTe(aa){this.F2c=aa}get l7a(){return this.nbd&&this.nbd.yKb?this.nbd.yKb.comment:null}static jub(aa,sa){if(aa)for(const Oa of aa)if(sa.commentId===Oa.commentId)return!0;return!1}}Object(k.a)(lf,"CommentAnchoringHighlightsHelper",null,[]);var Jd=d(41);class Xf{constructor(aa,sa,Oa,ib,Gb,Bb,Cc){this.qc=aa;this.ua=sa;this.k4c=Oa;this.gO=ib;this.Jbk=Gb;this.Qb=Bb;this.zb=Cc;this.Lef=0}c1a(aa,sa){if(aa||1!==this.n0c)if(2>this.qc.Lj())this.v3h?this.STe(5):this.STe(1);else{const Oa=
Jd.a.Ik("UpdateNextPopulatedContextDetails",2);this.k4c.i2d((ib,Gb,Bb)=>{this.tok(ib,Gb,Bb,Oa,sa)},Oa)}}get n0c(){return this.Lef}tok(aa,sa,Oa,ib,Gb){let Bb=1;if(this.ua.Ba){const Cc=this.ua.Ba.oe;let cc=!1,Qd=!1,re=!1;sa&&aa&&(aa=aa.oe,aa<Cc?cc=!0:aa===Cc?Qd=!0:(re=!0,Oa||(cc=!0)));0<=Gb&&(Gb<Cc?cc=!0:Gb===Cc?Qd=!0:re=!0);re?Bb=cc||Qd?3:2:cc?Bb=4:Qd&&(Bb=5)}this.STe(Bb);ib.finish();u.a.Aqb(this.zb,()=>{this.Qb.updateCommandUI()})}STe(aa){this.Lef=aa;this.Jbk.c1a(aa,1===this.Qb.mode)}get v3h(){return!!this.ua.Ba&&
this.gO.vNi(this.ua.Ba)}}Object(k.a)(Xf,"CommentContextDetailsUpdateHelper",null,[1207]);var ee=d(37);class Ra{g5k(aa){if(null===aa)throw Error.argumentNull("comment");aa.setValue(ee.a.commentId,"")}c5k(aa,sa){if(null===aa)throw Error.argumentNull("comment");aa.setValue(ee.a.$Td,sa)}e5k(aa){if(null===aa)throw Error.argumentNull("comment");if(aa=Object(lb.a)(1228,aa))aa.Ysb=ResourceStrings.anonymousCommentAuthor}npc(aa){if(null===aa)throw Error.argumentNull("comment");aa.setValue(ee.a.G_b,!0)}bph(aa,
sa,Oa,ib){if(null===aa)throw Error.argumentNull("comment");if(aa=Object(lb.a)(1228,aa))aa.authorName=sa,aa.KYb=Oa,aa.cHc=ib}h5k(aa,sa){if(null===aa)throw Error.argumentNull("comment");aa.setValue(ee.a.H_b,sa)}}Object(k.a)(Ra,"CommentEditor",null,[1231]);var sb=d(30),ec=d(82),Lc=d(56);class nd{constructor(){this.anchorShape=0;this.dt=this.commentId=this.Children=this.changesData=this.authorName=null;this.isUnread=!1;this.reactions=this.providerId=this.pos=null;this.status=0;this.userId=this.textAnchoringInfo=
this.text=this.taskInfo=null}}Object(k.a)(nd,"Comment",null,[]);var Fd=d(297),Ja=d(891),db=d(280),ic=d(28);const id=aa=>aa.ka("PPTOCommentReactionsUIEnabled");class qd{constructor(aa,sa,Oa,ib,Gb,Bb,Cc,cc,Qd,re,Ca,ob,Hb,rc,td){this.Rda=null;this.VAb=ib;this.Jb=Gb;this.ua=Bb;this.aB=Cc;this.pla=cc;this.Yb=Qd;this.Pb=re;this.pa=Ca;this.hE=ob;this.Wpe=Hb;this.jc=rc;this.hR=td;this.lR=aa;this.J4j=Oa;this.T5j=0===sa;this.iFh();this.Pme()}dispose(){}get userName(){return this.Yb.appSettings.UserName}get userId(){return this.Yb.appSettings["387"]}get providerId(){return this.Yb.appSettings["388"]}get isTasksHistoryEnabled(){return this.Yb.ka("TasksHistoryEnabled")}get A8b(){return this.Yb.ka("PPTOBlueDotsForComments")}get Ehg(){return bd.a("Comments.LogTasksTelemetry")}get mDa(){return this.Yb.ka("SlideResizePerfImprovementEnabled")}addComment(aa,
sa,Oa){this.dqf("",aa,sa,Oa,null,null,null,null)}n4h(aa,sa,Oa,ib,Gb,Bb,Cc,cc){this.dqf(aa,sa,Oa,ib,Gb,Bb,Cc,cc)}dqf(aa,sa,Oa,ib,Gb,Bb,Cc,cc){const Qd=this.lR.Ci("UserAction","AddComment");e.AFrameworkApplication.fa.vda?this.fqf(aa,sa,Oa,ib,Gb,Bb,Cc,cc,Qd):this.Yb.jf(()=>{this.fqf(aa,sa,Oa,ib,Gb,Bb,Cc,cc,Qd)})}fqf(aa,sa,Oa,ib,Gb,Bb,Cc,cc,Qd){this.J4j.wtb().then(re=>{qd.imh&&(wb.a.J(512262931,805,15,"FirstCommentBeingAdded - IsBlank:{0}; CreateNewCommentPolicyEnabled:{1}",this.T5j,re),this.hE.c0j(re),
qd.imh=!1);this.m4h(aa,sa,Oa,ib,Gb,Bb,Cc,cc);Qd&&Qd.stop();return re}).catch(re=>{wb.a.J(512262930,805,10,JSON.stringify(re));throw Error.create("CreateNewEnabledAsync or AddCommentOnFullAppSettingsReady failed");})}m4h(aa,sa,Oa,ib,Gb,Bb,Cc,cc){if(this.H8b()){var Qd=!1,re=0,Ca=0;ib&&(Qd=!0,re=ib.x,Ca=ib.y);ib=this.Jb.le(15);try{var ob=this.Rda;ib.nc(ob);const Hb=sb.GraphIterator.nb(ob),rc=Object(lb.a)(ec.a,this.VAb.createInstance(1074135127));this.pla.npc(rc);this.pla.g5k(rc);this.pla.c5k(rc,aa);
ob=null;const td=Object(lb.a)(1228,rc);if(td){if(td.$sb=Qd)td.jca=Object.assign(new Ja.a,{X:re,Y:Ca});td.nBh=this.Wpe.ilj();td.YGc=Bb;if(ob=Object(lb.a)(4,Gb))td.E_b=ob.get_shapeId();Oa&&(td.jxa=Oa);Cc&&(td.taskInfo=Cc);cc&&(td.textAnchoringInfo=cc);td.Qra=sa}let sc=this.userId;Gb=!sc;const Tc=!this.providerId,Dc=!this.userName;(Gb||Tc)&&wb.a.J(512262928,805,Gb&&!Tc?15:10,"CommentEditor UserID null: {0}; ProviderID null: {1} UserName null: {2};",Gb,Tc,Dc);bd.a("Comments.UseNameInPlaceOfUserId")&&
Gb&&!Tc&&(sc=Dc?ResourceStrings.anonymousCommentAuthor:this.userName);this.pla.bph(rc,this.userName,sc,this.providerId);Dc&&this.pla.e5k(rc);Hb.Cl(rc,1);wb.a.J(512262927,805,50,"CommentManager::AddCommentOnFullAppSettingsReady - Added comment: {0}; Has Task: {1}; Is Text Anchored: {2}, Is Shape Anchored: {3}",aa,!!Cc,!!cc,!!ob)}finally{ib&&ib.dispose()}this.v_j(aa,Oa,sa,cc,Cc)}else wb.a.J(512262929,805,10,"CommentManager::AddCommentOnFullAppSettingsReady - CommentContentNode is unavailable")}v_j(aa,
sa,Oa,ib,Gb){this.Ehg?sa?(sa=this.ODa(sa))?(sa=this.dta(sa))?this.hE.w_j(aa,Oa.length-1,!!ib,sa.taskInfo,Gb):wb.a.J(512262925,805,10,"CommentManager::AddCommentOnFullAppSettingsReady - Parent comment not found"):wb.a.J(512262926,805,10,"CommentManager::AddCommentOnFullAppSettingsReady - Parent comment node not found"):this.hE.x_j(aa,Oa.length-1,!!ib,!!Gb):this.hE.Mme(aa,Oa.length-1,!!ib,!!Gb)}deleteComment(aa){this.hE.p2j();if(this.H8b()){var sa=this.Jb.zd(15);try{sa.nc(this.Rda),this.CYd(aa,this.Rda),
sa.jd=ic.a.deleteComment}finally{sa&&sa.dispose()}}else wb.a.J(512262924,805,10,"CommentManager::DeleteComment - CommentContentNode is unavailable")}CYd(aa,sa){bd.a("IsDeselectShapeOnDeleteCommentEnabled")&&this.pa.O8()&&(wb.a.J(512262923,805,15,"CommentManager::DeleteCommentHelper - Removing shape selection in text edit while deleting comment"),this.pa.Qh());const Oa=this.A4i(aa,sa);if(Oa&&0<Oa.count){this.pla.npc(sa);for(let ib of Oa)sa=sb.GraphIterator.nb(ib),sa.rc(39),sa.Mi();wb.a.J(512262922,
805,50,"CommentManager::DeleteCommentHelper - Deleted comment {0}",aa)}else wb.a.J(512262921,805,10,"CommentManager::DeleteCommentHelper - Failed to find comment node {0}",aa);this.hE.yNk()}VQa(){const aa=Date.now();this.hE.g0j();const sa=this.Qy();if(sa){var Oa=this.Jb.zd(15);try{Oa.nc(this.ua.Ba);for(const ib of sa)this.CYd(ib.commentId,this.Rda);Oa.jd=ic.a.VQa}finally{Oa&&Oa.dispose()}wb.a.J(512262919,805,50,"CommentManager::DeleteAllCommentsInSlide - Time taken: {0} ms",Date.now()-aa)}else wb.a.J(512262920,
805,10,"CommentManager::DeleteAllCommentsInSlide - Failed to retrieve comments of active slide")}v1b(aa){const sa=Date.now();aa?this.hE.h0j():this.hE.f0j();const Oa=this.ua.presentation;if(Oa){var ib=Oa.slides;if(ib){var Gb=this.Jb.zd(15);try{Gb.nc(Oa);for(const Bb of ib){const Cc=Object(lb.a)(116,Bb);if(!Cc||!Cc.SD()){wb.a.J(512262918,805,10,"CommentManager::DeleteAllComments - slideNode not found or has no comments node: {0}",Cc);continue}const cc=sb.GraphIterator.nb(Cc).Bb(16);for(const Qd of this.eta(Cc.SD()))(aa?
1===Qd.status:1)&&this.CYd(Qd.commentId,cc)}Gb.jd=aa?ic.a.Rtb:ic.a.Qtb}finally{Gb&&Gb.dispose()}wb.a.J(512262917,805,50,"CommentManager::DeleteAllComments - Time taken: {0} ms - fOnlyDeleteResolved: {1}",Date.now()-sa,aa)}}}editComment(aa,sa){this.oOf(aa,sa,null)}rOi(aa,sa,Oa){this.oOf(aa,sa,Oa)}oOf(aa,sa,Oa){if(this.H8b()){var ib=this.ODa(sa);if(ib){const Gb=this.Jb.le(15);try{Gb.nc(ib);this.pla.npc(ib);const Bb=Object(lb.a)(1228,ib);Bb&&(Bb.Qra=aa,Bb.YGc=Oa)}finally{Gb&&Gb.dispose()}wb.a.J(512262915,
805,50,"CommentManager::EditCommentInternal - Edited comment {0}",sa)}else wb.a.J(512262914,805,10,"CommentManager::EditCommentInternal - Failed to find comment node {0}",sa);this.hE.l0j()}else wb.a.J(512262916,805,10,"CommentManager::EditCommentInternal - CommentContentNode is unavailable")}AFb(aa,sa){if(this.H8b()){var Oa=this.ODa(aa);if(Oa){if(null===sa)throw Error.argumentNull("pos");const ib=this.Jb.le(15);try{ib.nc(Oa),this.pla.npc(Oa),Object(lb.a)(1228,Oa).jca=Object.assign(new Ja.a,{X:sa.x,
Y:sa.y})}finally{ib&&ib.dispose()}wb.a.J(512262912,805,50,"CommentManager::MoveComment - Moved comment {0}",aa)}else wb.a.J(512262883,805,10,"CommentManager::MoveComment - Failed to find comment node {0}",aa);this.hE.x1j(aa)}else wb.a.J(512262913,805,10,"CommentManager::MoveComment - CommentContentNode is unavailable")}BFh(aa,sa,Oa){if(this.H8b()){var ib=this.ODa(aa);if(ib){const Gb=this.Jb.le(15);try{Gb.nc(ib),this.pla.npc(ib),this.pla.h5k(ib,sa),Object(lb.a)(1228,ib).Gkb=Oa,this.isTasksHistoryEnabled&&
this.pla.bph(ib,this.userName,this.userId,this.providerId)}finally{Gb&&Gb.dispose()}if(this.Ehg){Oa=this.dta(ib);if(!Oa){wb.a.J(512262881,805,10,"CommentManager::UpdateCommentStatus - Failed to find comment");return}1===sa?this.hE.Z1j(!!Oa.taskInfo):0===sa&&this.hE.P2j(!!Oa.taskInfo)}else 1===sa&&this.hE.$1j();wb.a.J(512262880,805,50,"CommentManager::UpdateCommentStatus - Updated comment status {0}:{1}",aa,sa)}else wb.a.J(512262879,805,10,"CommentManager::UpdateCommentStatus - Failed to find comment node {0}",
aa)}else wb.a.J(512262882,805,10,"CommentManager::UpdateCommentStatus - CommentContentNode is unavailable")}Qy(){return this.eta(this.Rda)}eta(aa){const sa=[];if(!aa||39!==aa.type)return sa;aa=sb.GraphIterator.nb(aa);for(var Oa=aa.Gi();Oa;){if(40===Oa.type){const ib=Object(lb.a)(1228,Oa).jxa;Oa=this.dta(Oa);if(ib)for(const Gb of sa)Gb.commentId===ib&&(Gb.Children||(Gb.Children=[]),Gb.Children.push(Oa));else sa.push(Oa)}Oa=aa.kp()}return sa}iFh(){const aa=this.ua.Ba;this.Rda=aa?sb.GraphIterator.nb(aa).Bb(16):
null}f9i(){if(!this.Rda)return!1;const aa=sb.GraphIterator.nb(this.Rda);if(this.aB.RYf(this.Rda))return!0;let sa=aa.Gi();for(;sa;){if(this.aB.RYf(sa))return!0;sa=aa.kp()}return!1}sWi(aa,sa){return this.ATf(aa,sa,!1)}EWi(aa,sa){return this.ATf(aa,sa,!0)}ATf(aa,sa,Oa){if(!aa)return null;if(aa=aa.SD()){aa=this.Pb.Nc(aa);let ib=Oa?aa.n6b():aa.Gi();for(;ib;){if(!(this.aB.NZc(ib)||sa&&0!==this.aB.XQc(ib)))return this.dta(ib);ib=Oa?aa.oEa():aa.kp()}}return null}vNi(aa){return aa?(aa=aa.SD())?!!this.Pb.Nc(aa).Gi():
!1:!1}YQc(aa){if(!aa)return 0;var sa=aa.SD();aa=0;if(sa){sa=this.Pb.Nc(sa);let Oa=sa.Gi();for(;Oa;)this.aB.NZc(Oa)||aa++,Oa=sa.kp()}return aa}H8b(){return!!this.Rda&&this.Rda.isConnected}A4i(aa,sa){sa=sb.GraphIterator.nb(sa);var Oa=sa.Gi();const ib=new r.a;for(;Oa;){const Gb=this.aB.VQc(Oa),Bb=Object(lb.a)(1228,Oa).jxa;aa!==Gb&&aa!==Bb||ib.add(Oa);Oa=sa.kp()}return ib}ODa(aa){const sa=sb.GraphIterator.nb(this.Rda);let Oa=sa.Gi();for(;Oa;){const ib=this.aB.VQc(Oa);if(aa===ib)return Oa;Oa=sa.kp()}return null}k8d(aa){aa=
this.ODa(aa);if(!aa)return null;const sa=Object(lb.a)(1228,aa).jxa;return Lb.a.Wa(sa)?aa:this.ODa(sa)}dta(aa){if(bd.a("GetCommentFromGraphNodeNullSafety")){var sa=Object(lb.a)(1228,aa);if(!sa)return null;var Oa=new nd;Oa.dt=sa.U0b;Oa.text=sa.Qra;Oa.status=this.aB.XQc(aa);Oa.userId=sa.KYb;Oa.commentId=this.aB.VQc(aa);Oa.authorName=sa.authorName;Oa.providerId=sa.cHc;Oa.anchorShape=sa.E_b;Oa.pos=Object.assign(new Fd.a,{X:sa.jca.X,Y:sa.jca.Y});Oa.taskInfo=sa.taskInfo;Oa.textAnchoringInfo=sa.textAnchoringInfo;
this.A8b&&(Oa.changesData=sa.changesData,Oa.isUnread=this.hR.instance&&this.hR.instance.Ueg(sa));id(this.Yb)&&(Oa.reactions=sa.reactions);return Oa}if(aa){sa=this.aB.VQc(aa);Oa=new nd;const ib=Object(lb.a)(1228,aa);if(ib){Oa.dt=ib.U0b;Oa.anchorShape=ib.E_b;const Gb=ib.jca;Oa.pos=Object.assign(new Fd.a,{X:Gb.X,Y:Gb.Y});Oa.text=ib.Qra;Oa.authorName=ib.authorName;Oa.userId=ib.KYb;Oa.providerId=ib.cHc;this.A8b&&(Oa.changesData=ib.changesData,Oa.isUnread=this.hR.instance&&this.hR.instance.Ueg(ib));id(this.Yb)&&
(Oa.reactions=ib.reactions)}Oa.status=this.aB.XQc(aa);Oa.commentId=sa;Oa.taskInfo=Object(lb.a)(1228,ib).taskInfo;Oa.textAnchoringInfo=Object(lb.a)(1228,ib).textAnchoringInfo;return Oa}return null}Z8a(aa){if(!aa)return[];const sa=this.eta(aa.SD());if(!sa||this.mDa&&!sa.length){if(!sa)throw Error.create("GetCommentsSortedByPositionForSlide - Comments should not be null");return sa}sa.sort((Oa,ib)=>{var Gb=this.jc.G8d(aa,Oa.anchorShape);Gb=Gb?Gb.fD:new Lc.a(0,0);var Bb=this.jc.G8d(aa,ib.anchorShape);
Bb=Bb?Bb.fD:new Lc.a(0,0);Gb.y+=Oa.pos.Y;Bb.y+=ib.pos.Y;Gb.x+=Oa.pos.X;Bb.x+=ib.pos.X;let Cc=Gb.y-Bb.y;Cc||(Cc=Gb.x-Bb.x)||(Cc=+Oa.dt-+ib.dt);return Cc});return sa}rij(aa){var sa=this.ua.presentation;if(!sa)return null;sa=sa.slides;if(!sa)return null;for(const Oa of sa)if(sa=Object(lb.a)(db.a,Oa))for(const ib of this.eta(sa.SD())){if(aa===ib.commentId)return Oa;if(ib.Children)for(const Gb of ib.Children)if(aa===Gb.commentId)return Oa}return null}Pme(){let aa=0,sa=0;var Oa=this.ua.presentation;if(Oa){var ib=
Oa.slides;if(ib){Oa=new r.a;for(const Gb of ib)if((ib=Object(lb.a)(db.a,Gb))&&ib.SD())for(const Bb of this.eta(ib.SD()))Pd.xN(Bb)?sa+=1:Bb.textAnchoringInfo&&Oa.add(Bb.commentId),aa+=1;this.hE.Pme(aa,sa,Oa)}}}}qd.imh=!0;Object(k.a)(qd,"CommentManager",null,[1229,1230,106]);var Fc=d(131);class Ze{constructor(aa,sa,Oa,ib){this.gO=aa;this.Kc=sa;this.Fb=Oa;this.yc=ib}Dhj(aa){if(null===aa)throw Error.argumentNull("comment");if(aa=this.qQc(aa))if(aa=this.al(aa))return aa.xa.xa;return null}T1i(aa){if(null===
aa)throw Error.argumentNull("comment");if(aa=this.qQc(aa)){if(aa.ud){var sa=this.yc.FN(aa);if(!sa)return wb.a.J(595133523,805,10,"GetAnchorBoundingRegion: Shape {0} is table shape but has no table node",aa.get_shapeId()),null;sa=sa.sc(this.Fb.Ma);return sa&&sa.htmlElement?Fc.a.Oca(new Sys.UI.Bounds(sa.htmlElement.clientLeft,sa.htmlElement.clientTop,sa.htmlElement.clientWidth,sa.htmlElement.clientHeight)):(wb.a.J(595133521,805,10,"GetAnchorBoundingRegion: cannot find table view element for table shape {0}",
aa.get_shapeId()),null)}if(aa=this.al(aa))return aa=aa.xa.xa,Fc.a.Oca(new Sys.UI.Bounds(aa.clientLeft,aa.clientTop,aa.clientWidth,aa.clientHeight))}return null}qQc(aa){if(null===aa)throw Error.argumentNull("comment");if(!aa.anchorShape)return null;aa=this.gO.k8d(aa.commentId);aa=this.gO.dta(aa);if(!aa)return null;const sa=this.Kc.Ic?this.Kc.Ic.Fd:null;return sa?sa.kC(aa.anchorShape):(wb.a.J(557090388,805,50,"ActiveSlide is null"),null)}U1i(aa){if(null===aa)throw Error.argumentNull("comment");if(!aa.anchorShape)return 0;
if(aa=this.qQc(aa))if(aa=this.al(aa))return aa.rotation;return 0}al(aa){if(null===aa)throw Error.argumentNull("shapeNode");return Object(lb.a)(117,aa.sc(this.Fb.Ma))}}Object(k.a)(Ze,"CommentMarkerAnchorHelper",null,[1201]);var df=d(575),ve=d(113);class md{constructor(aa,sa,Oa){this.u9=aa;this.Kc=sa;this.tpe=Oa}uNi(aa){const sa=Object(lb.a)(1228,this.tpe.ODa(aa.commentId));if(!sa)throw n.ULS.sendTraceTag(595203538,805,10,"There is no graph node for comment {0}",aa.commentId),Error.invalidOperation("GraphNodeNotFoundForComment");
return!!sa.jca}Ffj(aa,sa){if(!aa)throw Error.argumentNull("commentMarkerViewElement");if(!sa)throw Error.argumentNull("comment");if(!this.tpe.ODa(sa.commentId))return n.ULS.sendTraceTag(595141910,805,10,"GetRenderingPosition: There is no graph node for comment {0}",sa.commentId),new Lc.a(0,Number.MIN_VALUE);const Oa=aa.fp;aa=aa.Xfd;if(!this.uNi(sa)||!sa.pos.X&&!sa.pos.Y){if(Oa)return sa=new Lc.a(Oa.Zb-Oa.hc-md.Old.width-md.emh.width,md.emh.height),md.Y8f(sa,Oa,aa),sa;if(this.Kc.Ic&&this.Kc.Ic.BB)return new Lc.a(this.Kc.Ic.BB.clientWidth-
md.Old.width,0);n.ULS.sendTraceTag(595203537,805,10,"m_activeSlideViewManager.ActiveSlideView || m_activeSlideViewManager.ActiveSlideView.ScreenBoundsElement is null");return new Lc.a(0,0)}sa=new Lc.a(this.u9.Me(sa.pos.X,0),this.u9.Me(sa.pos.Y,1));sa=new Lc.a(sa._x-md.j_a._x,sa._y-md.j_a._y);Oa&&(sa._x=Math.max(0,sa._x),sa._y=Math.max(0,sa._y),sa._x=Math.min(sa._x,Oa.Zb-Oa.hc-md.Old.width),sa._y=Math.min(sa._y,Oa.Xb-Oa.kc-md.Old.height),md.Y8f(sa,Oa,aa));return sa}Hxl(aa,sa){var Oa=new Lc.a(aa.element.offsetLeft,
aa.element.offsetTop);Oa=new Lc.a(Oa._x+md.j_a._x,Oa._y+md.j_a._y);const ib=aa.fp;ib&&aa.Xfd%360&&md.xvf(Oa,0-aa.Xfd,ib.Xf());sa.pos.X=this.u9.rf(Oa._x,0);sa.pos.Y=this.u9.rf(Oa._y,1);this.tpe.AFb(sa.commentId,new Lc.a(sa.pos.X,sa.pos.Y))}static Y8f(aa,sa,Oa){if(sa&&Oa%360){var ib=new Lc.a(aa._x+md.j_a._x,aa._y+md.j_a._y);md.xvf(ib,Oa,sa.Xf());aa.update(ib._x-md.j_a._x,ib._y-md.j_a._y)}}static xvf(aa,sa,Oa){aa.hM(0-Oa._x,0-Oa._y);sa=df.a.xYd(sa);aa.update(aa._x*Math.cos(sa)-aa._y*Math.sin(sa)+Oa._x,
aa._x*Math.sin(sa)+aa._y*Math.cos(sa)+Oa._y)}}md.Old=new ve.a(20,20);md.emh=new ve.a(4,4);md.j_a=new Lc.a(4,20);Object(k.a)(md,"CommentMarkerPositionHelper",null,[1202]);var Kf=d(133),oe=d(73),Hf=d(46);class xb{constructor(aa,sa){this.dIa=this.sHa=this.Exe=null;this.Abc=aa;this.Kq=sa}xv(){return!0}Nu(aa){if(!aa)return!1;this.dIa=this.Abc.element.style;this.Exe=new Lc.a(aa.clientPoint.x,aa.clientPoint.y);this.sHa=new Lc.a(parseInt(this.dIa.left),parseInt(this.dIa.top));this.zw(aa);return!0}zw(aa){if(!aa)return!1;
aa=this.L1f(new Lc.a(aa.clientPoint.x,aa.clientPoint.y),this.Exe);this.dIa.left=Hf.a.Pc(this.sHa._x+aa._x);this.dIa.top=Hf.a.Pc(this.sHa._y+aa._y);return!0}Zn(aa){if(aa){aa=this.L1f(new Lc.a(aa.clientPoint.x,aa.clientPoint.y),this.Exe);var sa=this.sHa._x+aa._x,Oa=this.sHa._y+aa._y,ib=this.Abc.fp;ib&&(sa=Math.max(ib.hc,sa),sa=Math.min(ib.Zb-this.Abc.element.clientWidth,sa),Oa=Math.max(ib.kc,Oa),Oa=Math.min(ib.Xb-this.Abc.element.clientHeight,Oa),aa._x=sa-this.sHa._x,aa._y=Oa-this.sHa._y);this.dIa.left=
Hf.a.Pc(sa);this.dIa.top=Hf.a.Pc(Oa);this.Abc.kZg(aa)}}iu(){this.dIa.left=Hf.a.Pc(this.sHa._x);this.dIa.top=Hf.a.Pc(this.sHa._y)}L1f(aa,sa){aa=Lc.a.bV(aa,sa);return new Lc.a(this.Kq.Pm(aa.x),this.Kq.Pm(aa.y))}}Object(k.a)(xb,"CommentMarkerDragAdapter",null,[244]);class hg{constructor(aa,sa,Oa,ib,Gb,Bb,Cc,cc){this.y9=null;this.VVa=this.WVa=!1;if(!sa)throw Error.argumentNull("parentElement");this.BBb=cc;this.n9=aa;this.kq=Oa;this.zla=ib;this.AC=Gb;this.Z3c=Cc;this.ym=document.createElement("div");this.ym.className=
Pd.tOc(aa)?this.AC.FXg:this.AC.EXg;this.ym.title=ResourceStrings.L_CommentMarkerTooltip;this.ym.style.display=this.Z3c||this.BBb?"none":"block";this.ym.setAttribute("data-pptcommentid",String.format("{0}",aa.commentId));this.aA=document.createElement("img");this.aA.alt=ResourceStrings.L_CommentMarkerTooltip;this.aA.src=Oa.frame.pk(Oa.frame.JS+".png");this.aA.setAttribute(Kf.a.af,Kf.a.ru);this.ym.appendChild(this.aA);this.Y0a();this.frame.Yc.pb(Mb.a.click,this.ym,Object(za.a)(this,this.ZB,"clickHandler"));
Pd.xOc&&(Kc.a.addHandler(this.ym,Mb.a.mq,Object(za.a)(this,this.Gwa,"mouseOverHandler")),Kc.a.addHandler(this.ym,Mb.a.Is,Object(za.a)(this,this.mic,"mouseOutHandler")));Pd.wHc&&Kc.a.addHandler(this.aA,Mb.a.mouseDown,Object(za.a)(this,this.Nlc,"preventNativeDragMouseDownHandler"));sa.appendChild(this.ym);Bb||this.pWd()}dispose(){this.aA&&(Pd.wHc&&Kc.a.removeHandler(this.aA,Mb.a.mouseDown,Object(za.a)(this,this.Nlc,"preventNativeDragMouseDownHandler")),this.frame.Yc.yb(Mb.a.click,this.ym,Object(za.a)(this,
this.ZB,"clickHandler")),this.aA.parentNode&&this.aA.parentNode.removeChild(this.aA),this.aA=null);this.ym&&(Pd.xOc&&(Kc.a.removeHandler(this.ym,Mb.a.mq,Object(za.a)(this,this.Gwa,"mouseOverHandler")),Kc.a.removeHandler(this.ym,Mb.a.Is,Object(za.a)(this,this.mic,"mouseOutHandler"))),this.zla&&(this.zla.QSd(),this.zla.XE(this.ym,this.y9)),this.ym.parentNode&&this.ym.parentNode.removeChild(this.ym));this.kq=this.n9=null}get comment(){return this.n9}get element(){return this.ym}get frame(){return this.kq.frame}pWd(){this.zla&&
(this.y9=new xb(this,pc.a.instance.resolve("PowerPointWebEditor.IPPTUnitConversion")),this.zla.GJ(this.ym,this.y9))}updatePosition(aa){this.ym.style.left=Hf.a.Pc(aa._x-(this.kq.isRightToLeft?this.AC.dCe:0));this.ym.style.top=Hf.a.Pc(aa._y)}kZg(aa){this.kq.AFb(this.n9,aa)}select(aa){this.WVa=aa;this.Y0a()}activate(aa){this.VVa=aa;this.Y0a()}Ruh(){}setVisibility(aa){this.ym.style.display=aa&&!this.BBb?"block":"none"}Y0a(){this.BBb||(this.aA.className=Pd.tOc(this.n9)?this.WVa?oe.getImageClassWithCluster(this.frame.JS,
this.AC.IXg):this.VVa?oe.getImageClassWithCluster(this.frame.JS,this.AC.GXg):oe.getImageClassWithCluster(this.frame.JS,this.AC.HXg):this.WVa?oe.getImageClassWithCluster(this.frame.JS,this.AC.DXg):this.VVa?oe.getImageClassWithCluster(this.frame.JS,this.AC.cCe):oe.getImageClassWithCluster(this.frame.JS,this.AC.Rhc))}get fp(){return null}get Xfd(){return 0}ZB(aa){if(aa.lA!==Sys.UI.MouseButton.leftButton)return!1;this.frame.selectComment(this.n9,null,!1,!0,aa.Yf,1,!1);aa=aa.pc;aa.preventDefault();aa.stopPropagation();
return!0}Gwa(){this.frame.nqb(this.n9,1)}mic(){this.frame.nqb(null,1)}Nlc(aa){aa.preventDefault()}}Object(k.a)(hg,"LegacyCommentMarkerViewElement",null,[1266]);var rf=d(95),nf=d(636);class kd{constructor(aa,sa,Oa,ib,Gb,Bb,Cc,cc,Qd){this.y9=null;this.qvg=this.VVa=this.WVa=!1;if(!sa)throw Error.argumentNull("parentElement");this.n9=aa;this.kq=Oa;this.zla=ib;this.AC=Gb;this.fGa=Bb;this.D2c=Cc;this.Z3c=Qd;this.ym=document.createElement("div");this.ym.className=Pd.tOc(aa)?this.AC.FXg:this.AC.EXg;Sys.UI.DomElement.addCssClass(this.ym,
"CommentMarker");this.ym.title=ResourceStrings.L_CommentMarkerTooltip;this.ym.style.display="none";this.ym.setAttribute("data-pptcommentid",String.format("{0}",aa.commentId));this.aA=document.createElement("img");this.aA.alt=ResourceStrings.L_CommentMarkerTooltip;this.aA.src=Oa.frame.pk(Oa.frame.JS+".png");this.aA.setAttribute(Kf.a.af,Kf.a.ru);this.ym.appendChild(this.aA);this.Y0a();this.frame.Yc.pb(Mb.a.click,this.ym,Object(za.a)(this,this.ZB,"clickHandler"));Pd.xOc&&(Kc.a.addHandler(this.ym,Mb.a.mq,
Object(za.a)(this,this.Gwa,"mouseOverHandler")),Kc.a.addHandler(this.ym,Mb.a.Is,Object(za.a)(this,this.mic,"mouseOutHandler")));Pd.wHc&&Kc.a.addHandler(this.aA,Mb.a.mouseDown,Object(za.a)(this,this.Nlc,"preventNativeDragMouseDownHandler"));sa.appendChild(this.ym);cc||this.pWd()}dispose(){this.aA&&(Pd.wHc&&Kc.a.removeHandler(this.aA,Mb.a.mouseDown,Object(za.a)(this,this.Nlc,"preventNativeDragMouseDownHandler")),this.frame.Yc.yb(Mb.a.click,this.ym,Object(za.a)(this,this.ZB,"clickHandler")),this.aA.parentNode&&
this.aA.parentNode.removeChild(this.aA),this.aA=null);this.ym&&(Pd.xOc&&(Kc.a.removeHandler(this.ym,Mb.a.mq,Object(za.a)(this,this.Gwa,"mouseOverHandler")),Kc.a.removeHandler(this.ym,Mb.a.Is,Object(za.a)(this,this.mic,"mouseOutHandler"))),this.zla&&(this.zla.QSd(),this.zla.XE(this.ym,this.y9)),this.ym.parentNode&&this.ym.parentNode.removeChild(this.ym));this.kq=this.n9=null}get comment(){return this.n9}get element(){return this.ym}get frame(){return this.kq.frame}pWd(){this.zla&&(this.y9=new xb(this,
pc.a.instance.resolve("PowerPointWebEditor.IPPTUnitConversion")),this.zla.GJ(this.ym,this.y9))}updatePosition(){const aa=this.D2c.Ffj(this,this.comment);this.ym.style.left=aa._x+"px";this.ym.style.top=aa._y+"px"}kZg(){this.D2c.Hxl(this,this.comment)}select(aa){this.WVa=aa;this.Y0a();this.onVisibilityChange()}activate(aa){this.VVa=aa;this.Y0a();this.onVisibilityChange()}Ruh(aa){this.qvg=aa;this.Y0a();this.onVisibilityChange()}setVisibility(aa){this.Z3c=!aa;this.onVisibilityChange()}onVisibilityChange(){!this.Z3c&&
(this.WVa||this.VVa||this.qvg)?(this.updatePosition(this.frame.mCa(this.comment.pos.X,this.comment.pos.Y)),this.ym.style.display="block",rf.a.sI(this.ym,nf.a.IJc)):(this.ym.style.display="none",rf.a.XJa(this.ym,nf.a.IJc))}get fp(){return this.fGa.T1i(this.n9)}get Xfd(){return this.fGa.U1i(this.n9)}Y0a(){this.aA.className=Pd.tOc(this.n9)?this.WVa?oe.getImageClassWithCluster(this.frame.JS,this.AC.IXg):this.VVa?oe.getImageClassWithCluster(this.frame.JS,this.AC.GXg):oe.getImageClassWithCluster(this.frame.JS,
this.AC.HXg):this.WVa?oe.getImageClassWithCluster(this.frame.JS,this.AC.DXg):this.VVa?oe.getImageClassWithCluster(this.frame.JS,this.AC.cCe):oe.getImageClassWithCluster(this.frame.JS,this.AC.Rhc)}ZB(aa){if(aa.lA!==Sys.UI.MouseButton.leftButton)return!1;this.frame.selectComment(this.n9,null,!1,!0,aa.Yf,1,!1);aa=aa.pc;aa.preventDefault();aa.stopPropagation();return!0}Gwa(){this.aA.className=oe.getImageClassWithCluster(this.frame.JS,this.AC.cCe)}mic(){this.aA.className=oe.getImageClassWithCluster(this.frame.JS,
this.AC.Rhc)}Nlc(aa){aa.preventDefault()}}Object(k.a)(kd,"ModernCommentMarkerViewElement",null,[1266]);class If{constructor(aa,sa,Oa,ib,Gb,Bb){this.fGa=aa;this.D2c=sa;this.AC=Oa;this.Ecc=Gb;this.BBb=Bb;ib.wtb().then(Cc=>{Cc||this.HUe(!1)})}dispose(){this.AC=null}create(aa,sa,Oa,ib,Gb,Bb){if(this.Ecc){const Cc=this.fGa.Dhj(aa);return new kd(aa,Cc||sa,Oa,ib,this.AC,this.fGa,this.D2c,Gb,Bb)}return new hg(aa,sa,Oa,ib,this.AC,Gb,Bb,this.BBb)}HUe(aa){this.BBb=this.Ecc=aa;this.AC.HUe(aa)}}Object(k.a)(If,
"CommentMarkerViewElementFactory",null,[1203,106]);var og=d(76);class pf extends og.a{constructor(){super()}iai(aa){this.addHandler(pf.Lxh,aa)}P_g(){this.raiseEvent(pf.Lxh)}}pf.Lxh="S";Object(k.a)(pf,"ATransactionCompletedProcessor",og.a,[1285]);var ig=d(38);class Oe extends pf{constructor(aa,sa,Oa){super();this.Hdk=aa;this.B4c=sa;this.zX=Oa}get index(){return 0}run(){this.Hdk()}dFf(aa,sa){sa.property!==ee.a.jca&&sa.property!==ee.a.Qra&&sa.property!==ee.a.commentId&&sa.property!==ee.a.G_b&&sa.property!==
ee.a.H_b&&sa.property!==ee.a.gsc&&sa.property!==ee.a.fsc||this.P_g()}OEf(aa,sa){sa.property!==ig.a.NA&&sa.property!==ee.a.G_b||this.P_g()}ayj(){this.B4c.Ad(39).ik(Object(za.a)(this,this.OEf,"commentContentPropertyChanged"));this.B4c.Ad(40).ik(Object(za.a)(this,this.dFf,"commentPropertyChanged"));this.zX.F4k(this)}Fvl(){this.B4c.Ad(40).Cm(Object(za.a)(this,this.dFf,"commentPropertyChanged"));this.B4c.Ad(39).Cm(Object(za.a)(this,this.OEf,"commentContentPropertyChanged"))}}Object(k.a)(Oe,"CommentPropertyTracker",
pf,[]);var Ag=d(909),ce=d(127);class me extends Ag.a{constructor(){super();this.comment=this.commentId=null;this.H_=Object.assign(new ce.a,{T_:me.getTypeName(),B_:me.getBaseTypes()})}static getTypeName(){return"AugLoop_SmartReply_CommentSmartReplySignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}}Object(k.a)(me,"CommentSmartReplySignal",Ag.a,[]);var Je=d(602);class ie extends Je.a{constructor(){super();this.DomainName=this.CommentId=null;this.ConfidenceLevel=0;this.ElapsedTime=this.ResultSets=
null;this.H_=Object.assign(new ce.a,{T_:ie.getTypeName(),B_:ie.getBaseTypes()})}static getTypeName(){return"AugLoop_SmartReply_SmartReply"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}Object(k.a)(ie,"SmartReply",Je.a,[]);var Tf=d(389),He=d(434);class Sg{constructor(aa,sa){this.eOh=aa;this.$5e=sa}initialize(){this.$5e.execute(aa=>{const sa=ie.getTypeName();aa.x5a(sa);aa.knc(sa,Object(za.a)(this,this.yta,"handleAnnotationEvent"))})}invoke(aa,sa){const Oa=Object.assign(new Tf.a,{parentPath:["Signal",
me.getTypeName()],items:[Object.assign(new He.a,{body:Object.assign(new me,{commentId:aa,comment:sa})})]});this.$5e.execute(ib=>{ib.submitOperation(Oa)})}yta(aa){if(aa){var sa=new r.a;if(aa&&aa.CommentId&&aa.ResultSets&&0<aa.ResultSets.length&&aa.ResultSets[0].Documents&&0<aa.ResultSets[0].Documents.length){for(const Oa of aa.ResultSets[0].Documents)sa.add(Oa.Caption);0<sa.count&&this.eOh.oBk(aa.CommentId,sa.toArray())}else wb.a.J(557593412,327,10,"Invalid response from SmartReplies request")}else wb.a.J(557593411,
327,50,"Smart reply invocation returned null annotations.")}}Object(k.a)(Sg,"CommentSmartReplyProvider",null,[]);var jc=d(311),be=d(285),Md=d(279),de=d(96),Zc=d(179),Yf=d(129),Vc=d(61),zc=d(433);class vf{constructor(aa,sa,Oa,ib,Gb){this.wpe=this.eqe=this.Bqe=this.M1c=0;this.Wrg=new r.a;this.MAe=this.isg=this.ype=this.jgc=this.fxe=0;this.Gye=new r.a;this.Rne=this.Qne=this.Sne=this.Pne=0;this.Upg=new r.a;this.a$c=new r.a;this.cqe=this.aqe=this.bqe=this.dqe=this.wue=this.vue=this.xue=this.yue=0;this.P1c=
this.tte=this.G2c=rb.App.Um;this.MWa=null;this.GAe=this.HAe=this.gad=this.Ead=this.p9c=this.One=0;if(!aa)throw Error.argumentNull("coreEventHandler");if(!sa)throw Error.argumentNull("appSettingsManager");this.Oc=aa;this.Yb=sa;this.ua=Oa;this.aB=ib;this.rpe=Gb;this.Oc.WB(Object(za.a)(this,this.Bo,"onSessionRehydrated"));this.Oc.GA(Object(za.a)(this,this.vB,"onSessionEnd"))}get KUd(){return this.Yb.ka("CommentTextAnchoringCreateNewEnabled")}get Eol(){return this.Yb.ka("TasksForCommentsEnabled")}Mme(aa,
sa,Oa,ib){this.M1c+=1;this.wpe+=sa;Oa&&(this.Pne+=1,this.Gye.add(aa));ib&&(this.One+=1)}x_j(aa,sa,Oa,ib){this.gad=ib?this.gad+1:this.gad;this.Mme(aa,sa,Oa,ib)}w_j(aa,sa,Oa,ib,Gb){(Gb=!!Gb)&&ib?this.HAe+=1:Gb&&(this.GAe+=1);this.Mme(aa,sa,Oa,Gb)}B2j(){this.Sne+=1}y2j(){this.Qne+=1}z2j(){this.Rne+=1}A2j(aa,sa,Oa,ib){this.nhg(aa.commentId)||(Oa&&!this.jUj(sa,Oa.WD(),ib)?this.Nog(aa,Oa,!0):this.Nog(aa,Oa,!1))}yNk(){this.eqe+=1}p2j(){this.dqe+=1}g0j(){this.bqe+=1}f0j(){this.aqe+=1}h0j(){this.cqe+=1}l0j(){this.Bqe+=
1}x1j(aa){this.Wrg.contains(aa)||(this.fxe+=1,this.Wrg.add(aa))}Z1j(aa){this.p9c=aa?this.p9c+1:this.p9c;this.jgc+=1}P2j(aa){this.Ead=aa?this.Ead+1:this.Ead}$1j(){this.jgc+=1}Pme(aa,sa,Oa){this.ype=aa;this.MAe=sa;this.Upg=Oa;this.wog()}c0j(aa){this.isg=aa?1:2}ank(aa){this.G2c===rb.App.Um&&(this.G2c=new Date,this.NFa("OnCollabCornerCommentsEnabled",this.G2c,aa),this.zSe("CollabCornerCommentsEnabled",this.G2c))}xok(aa){this.tte===rb.App.Um&&(this.tte=new Date,this.NFa("OnFloatingCommentsRendered",this.tte,
aa))}Ylk(aa){this.P1c===rb.App.Um&&(this.P1c=new Date,this.NFa("OnAllFloatingContainersVisible",this.P1c,aa),this.zSe("AllFloatingContainersVisible",this.P1c))}ynk(aa){const sa=new Date;this.NFa("OnDeepLinkedCommentSelected",sa,aa);this.zSe("DeepLinkedCommentSelected",sa)}nhg(aa){return this.Upg.contains(aa)||this.a$c.contains(aa)}jUj(aa,sa,Oa){let ib=0;for(const Bb of sa)if(sa=Object(lb.a)(1127,Bb.sc(Oa))){sa=sa.htmlElement.getElementsByClassName(de.a.Y0b);for(let Cc=0;Cc<sa.length;Cc++){var Gb=
sa[Cc];const cc=jc.a.ye(Gb,de.a.IUd);cc&&(ib+=Sc.a.contains(cc,aa)?1:0);(Gb=jc.a.ye(Gb,de.a.EUd))&&(ib+=Sc.a.contains(Gb,aa)?1:0);if(2===ib)return!0}}return!1}Nog(aa,sa,Oa){if(aa&&aa.textAnchoringInfo&&!this.nhg(aa.commentId))if(aa.textAnchoringInfo.EndPos<=aa.textAnchoringInfo.StartPos){if(sa){if(Oa){this.wue+=1;this.a$c.add(aa.commentId);return}this.xue+=1}else this.yue+=1;this.a$c.add(aa.commentId)}else 0>=aa.textAnchoringInfo.TextBodyLength&&(this.Gye.contains(aa.commentId)?this.Gye.remove(aa.commentId):
(this.vue+=1,this.a$c.add(aa.commentId)))}NFa(aa,sa,Oa){const ib={};ib.Event=aa;ib.Time=sa.getTime();ib.SlideId=Oa.toString();ib.LandingSlide=this.U$i();ib.SessionDimensions=this.x8d();ib.PerfMetrics=this.f2i();ib.CommentPerfMetrics=this.C4i();ib.CommentFileType=this.rpe;ib.CommentDeepLinkedOpen=!!this.Yb.Ha("CurrentCommentId");ib.StandaloneCommentJsEnabled=!0;ib.LoadSharedCommentsEarly=!0;ib.FetchFullAppSettingsOnBoot=this.Yb.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.FetchFullAppSettingsOnBoot",
!1);ib.PrefetchCommentCloudPolicy=this.Yb.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.PrefetchCommentCloudPolicy",!1);wb.a.J(509703831,805,15,Fb.c(ib))}wog(){wb.a.J(509703830,805,15,"Comment(s) - OnOpen:{0}; FileType:{1}",this.ype,this.rpe);wb.a.J(509703829,805,15,"Text Anchor(s) - OnOpen:{0}",this.MAe);wb.a.J(509703828,805,15,"Comment/Tasks BRSs - TextAnchoringCreateNewEnabled:{0}; TasksForCommentsEnabled:{1}; ",this.KUd,this.Eol)}log(){wb.a.J(509703827,805,15,"Comment(s) - Added:{0}; Edited:{1}; Deleted:{2}; AverageLength:{3}; Moved:{4}; Resolved:{5}; OnOpen:{6}; FileType:{7}; CreateNewPolicy:{8}",
this.M1c,this.Bqe,this.eqe,this.wpe/this.M1c,this.fxe,this.jgc,this.ype,this.rpe,this.isg);wb.a.J(509703826,805,15,"Text Anchor(s) - OnOpen:{0}; Added:{1}; WithMultiPara:{2}; InSmartArt{3}; InTable:{4}; InvalidStartEndPos:{5}; InvalidBodyLength:{6}; InvalidShape:{7}; InvalidTextDelete:{8}",this.MAe,this.Pne,this.Sne,this.Qne,this.Rne,this.xue,this.vue,this.yue,this.wue);wb.a.J(509703825,805,15,"Deleted Comment(s) - Single:{0}; InSlide:{1}; InPresentation:{2}; Resolved:{3}",this.dqe,this.bqe,this.aqe,
this.cqe);this.w2j()}w2j(){wb.a.J(509703824,845,15,"Task(s) - Added:{0}",this.One);const aa={};aa.ResolvedTasksCount=this.p9c;aa.UnresolvedTasksCount=this.Ead;aa.TasksCreatedNewThreadCount=this.gad;aa.TasksReassignedInReplyCount=this.HAe;aa.TasksCreatedInReplyCount=this.GAe;wb.a.J(509703823,845,15,Fb.c(aa))}Bo(){this.wog()}vB(){this.log()}U$i(){if(this.MWa)return this.MWa;this.MWa={};var aa=parseInt(this.Yb.Ha("CurrentSlideId"));aa=aa!==Vc.a.empty.sid?Vc.a.PE(aa,0):this.ua.presentation.I9a(0);if(!aa)return this.MWa;
this.MWa.SlideId=aa.toString();if(aa=this.ua.presentation.P8d(aa.sid))aa=Object(lb.a)(116,aa).SD(),this.MWa.HasComments=this.aB.H9f(aa),this.MWa.HasActiveComments=this.aB.v9f(aa);return this.MWa}x8d(){const aa={};aa.Ring=e.AFrameworkApplication.gd.Ring;aa.Host=e.AFrameworkApplication.gd.Host;aa.UiHost=e.AFrameworkApplication.gd.UiHost;aa.SessionOrigin=e.AFrameworkApplication.gd.SessionOrigin;aa.ApplicationMode=e.AFrameworkApplication.gd.ApplicationMode;aa.Browser=e.AFrameworkApplication.gd.Browser;
aa.Os=e.AFrameworkApplication.gd.Os;return aa}f2i(){const aa={};aa[be.a.POb]=ub.a.instance.ah(be.a.POb);aa.DocPageNavigationStart=ub.a.instance.ah("DocPageNavigationStart");aa[be.a.Y3b]=ub.a.instance.ah(be.a.Y3b);aa[zc.a.mQe]=ub.a.instance.ah(zc.a.mQe);aa[zc.a.lQe]=ub.a.instance.ah(zc.a.lQe);aa[zc.a.Tjh]=ub.a.instance.ah(zc.a.Tjh);aa[zc.a.U0d]=ub.a.instance.ah(zc.a.U0d);aa[zc.a.V0d]=ub.a.instance.ah(zc.a.V0d);aa[zc.a.T0d]=ub.a.instance.ah(zc.a.T0d);aa[zc.a.ETd]=ub.a.instance.ah(zc.a.ETd);aa[be.a.uud]=
0<Md.a.instance.tfh();return aa}C4i(){const aa={};aa[bc.a.HUd]=ub.a.instance.ah(bc.a.HUd);aa[bc.a.MUd]=ub.a.instance.ah(bc.a.MUd);aa[bc.a.R7b]=ub.a.instance.ah(bc.a.R7b);aa[bc.a.Ace]=ub.a.instance.ah(bc.a.Ace);aa[bc.a.lVe]=ub.a.instance.ah(bc.a.lVe);aa[bc.a.i8b]=ub.a.instance.ah(bc.a.i8b);aa[bc.a.Bce]=ub.a.instance.ah(bc.a.Bce);aa[bc.a.yme]=ub.a.instance.ah(bc.a.yme);aa[bc.a.F2d]=ub.a.instance.ah(bc.a.F2d);aa[bc.a.G2d]=ub.a.instance.ah(bc.a.G2d);aa[bc.a.Hod]=ub.a.instance.ah(bc.a.Hod);aa[bc.a.JWd]=
ub.a.instance.ah(bc.a.JWd);aa[bc.a.IWd]=ub.a.instance.ah(bc.a.IWd);return aa}vhj(){const aa=ub.a.instance.ah("DocPageNavigationStart");if(!ub.a.instance.ah(be.a.POb))return aa;const sa=ub.a.instance.ah(be.a.POb);return 6E4>aa-sa?sa:aa}zSe(aa,sa){const Oa=[];Array.add(Oa,Object.assign(new Yf.a,{name:"EventName",string:aa}));kb.a.sendActivityEvent(Object.assign(new Zc.a,{name:"CommentsBootEvents",durationMs:sa.getTime()-this.vhj(),dataFields:Oa}))}}Object(k.a)(vf,"CommentTelemetryManager",null,[1227]);
var Tg=d(678),bb=d(679),Vb=d(680);class Ub extends Tg.a{constructor(aa,sa){super();this.V7j=aa;this.Bi=sa;this.Ute=[new bb.a(de.a.REf,null),new bb.a(de.a.SEf,null),new bb.a(de.a.TEf,null),new bb.a(de.a.WEf,null),new bb.a(de.a.$Ef,null),new bb.a(de.a.aFf,null),new bb.a(de.a.ZEf,null),new bb.a(de.a.UEf,null),new bb.a(de.a.VEf,null),new bb.a(de.a.XEf,null),new bb.a(de.a.YEf,null)]}get isInHighContrastMode(){return!!this.Bi&&this.Bi.isInHighContrastMode}get wxb(){return this.V7j}get mbe(){return this.Ute}Bjc(aa,
sa){var Oa=this.r_.aja;if(Oa&&0===Oa.type&&(Oa=this.r_.aja.jda,Oa=Object(v.a)(Array,Oa)?Oa:null)){var ib=null,Gb=null,Bb=new La.a;for(const Cc of Oa)Cc.vkc.isValid&&Array.contains(Cc.vkc.paragraphs,aa)&&(0===Cc.state?ib=Cc.commentId:1===Cc.state&&(Gb=Cc.commentId),Bb.$(Cc.commentId,Cc.vkc));this.ydi(sa.querySelectorAll("*"),Bb,aa,ib,Gb)}}n8b(aa,sa){aa=Object(v.a)(Array,aa)?Array.isArray(aa)?aa:null:null;if(!aa||0<aa.length&&!Object(lb.a)(Wb,aa[0]))return sa;for(const Oa of aa)if(Oa.vkc.isValid)for(const ib of Oa.vkc.paragraphs)ib&&
(Vb.b(ib),sa.add(ib));return sa}oUi(aa,sa){aa=aa.xLa;const Oa=sa?Ub.c5j:Ub.d5j;sa=$c.a.IYf(aa,sa?Ub.l9j:Ub.m9j);aa=$c.a.IYf(aa,Oa);return sa<aa}ydi(aa,sa,Oa,ib,Gb){const Bb=new F.a,Cc=new F.a;for(let re=0;re<aa.length;re++){const Ca=aa[re];this.Tjd(Ca);if(!Ca.parentNode)continue;var cc=jc.a.ye(Ca,de.a.IUd),Qd=jc.a.ye(Ca,de.a.EUd);const ob=[!1,!1,!1];if(cc)for(const Hb of cc)if(sa.Hb(Hb)){cc=sa.ga(Hb).$Zf(Oa);if(sa.ga(Hb).K9f||(2===cc||0===cc)&&!this.isInHighContrastMode&&this.oUi(sa.ga(Hb),Hb===Gb))sa.ga(Hb).K9f=
!0,Bb.add(Hb);Cc.add(Hb);this.XLf(sa,Oa,Hb,ib,Gb,ob,!0)}if(Qd)for(const Hb of Qd)Cc.contains(Hb)&&(Cc.remove(Hb),Bb.remove(Hb),this.XLf(sa,Oa,Hb,ib,Gb,ob,!1));if(0!==Vb.a(Ca)){Qd=(cc=0<Bb.count)&&!!Gb&&Bb.contains(Gb);const Hb=!!ib&&Cc.contains(ib),rc=!!Gb&&Cc.contains(Gb);0<Cc.count&&!this.isInHighContrastMode&&0<=Ca.parentNode.className.indexOf(de.a.yLa)&&(rf.a.sI(Ca.parentNode,de.a.REf),rc?rf.a.sI(Ca.parentNode,Qd?de.a.VEf:de.a.UEf):Hb?(rf.a.sI(Ca.parentNode,de.a.SEf),cc=Ca.parentNode.className.match(new RegExp("\\b"+
de.a.cag+"\\b")),(!cc||1>cc.length)&&rf.a.sI(Ca.parentNode,de.a.TEf)):rf.a.sI(Ca.parentNode,cc?de.a.aFf:de.a.$Ef));ob[1]?rf.a.sI(Ca,Qd?de.a.YEf:de.a.XEf):ob[0]?rf.a.sI(Ca,de.a.WEf):ob[2]&&rf.a.sI(Ca,de.a.ZEf)}}}XLf(aa,sa,Oa,ib,Gb,Bb,Cc){aa=aa.ga(Oa).$Zf(sa);if(2===aa||(Cc?0===aa:1===aa))ib&&ib.equals(Oa)&&(Bb[0]=!0),Gb&&Gb.equals(Oa)&&(Bb[1]=!0),Bb[2]=!0}}Ub.m9j="#F5E7F6";Ub.d5j="#503355";Ub.l9j="#F2E1F4";Ub.c5j="#4C3050";Object(k.a)(Ub,"CommentTextAnchorHighlightActor",Tg.a,[]);class Jc{constructor(aa){let sa;
this.oVh=20;sa=aa?aa="SharedCommentBubble":aa="SharedCommentBubbleSelected";this.jVh=this.XRa("SharedCommentBubble");this.iVh=this.XRa("SharedCommentBubbleHover");this.jgf=this.XRa(aa);this.nVh=this.XRa("SharedCommentBubble");this.mVh=this.XRa("SharedCommentBubbleHover");this.kgf=this.XRa(sa);this.kVh="ModernCommentMarkerElementSingle cui-img-cont-float";this.lVh="ModernCommentMarkerElementWithReplies cui-img-cont-float"}get EXg(){return this.kVh}get FXg(){return this.lVh}get dCe(){return this.oVh}get Rhc(){return this.jVh}get cCe(){return this.iVh}get DXg(){return this.jgf}get HXg(){return this.nVh}get GXg(){return this.mVh}get IXg(){return this.kgf}HUe(aa){const sa=
aa?this.Rhc:"SharedCommentBubbleSelected";aa=aa?this.Rhc:sa;this.jgf=this.XRa(sa);this.kgf=this.XRa(aa)}XRa(aa){return String.format("{0}_{1}x{2}x32",aa,this.dCe,this.dCe)}}Object(k.a)(Jc,"CommentViewHelper",null,[]);class Mc{constructor(aa,sa,Oa,ib,Gb,Bb){this.Oc=aa;this.ua=sa;this.zb=Oa;this.DPg=ib;this.kb=Bb;this.DPg.FG(Object(za.a)(this,this.dfd,"onSlideOrderChanged"));this.Oc.X7h(Object(za.a)(this,this.Z1g,"onCommentsChanged"))}dispose(){this.Oc.$Sk(Object(za.a)(this,this.Z1g,"onCommentsChanged"));
this.DPg.ZO(Object(za.a)(this,this.dfd,"onSlideOrderChanged"))}Z1g(){const aa=this.ua.Ba;u.a.Aqb(this.zb,()=>{this.FBk(aa)})}dfd(aa,sa){if(2===sa.RZ){const Oa=this.ua.Ba;u.a.Aqb(this.zb,()=>{this.W$g(Oa)})}}W$g(aa){this.ua.Ba===aa&&aa&&this.kb.c1a(!0)}FBk(aa){this.W$g(aa)}}Object(k.a)(Mc,"CommentsChangeListener",null,[106]);var ed=d(140),dd=d(276),je=d(171);class Nd{static sCa(aa,sa,Oa,ib,Gb,Bb,Cc){const cc=Hf.a.eC();cc.alt=Bb;cc.className=oe.getImageClassWithCluster(sa,Gb);cc.setAttribute(Kf.a.af,
Kf.a.ru);cc.src=aa.pk(sa+".png");cc.setAttribute("Unselectable","on");aa=Hf.a.Nn();aa.className=Oa+" cui-img-cont-float";aa.setAttribute(Kf.a.af,Kf.a.ru);aa.appendChild(cc);Oa=Hf.a.Nn();Oa.className=ib;Oa.setAttribute("Unselectable","on");Oa.setAttribute(Kf.a.af,Kf.a.ru);Oa.appendChild(aa);ib=Hf.a.nca();ib.className=Nd.t_k+" cui-ctl";ib.title=Bb;ib.setAttribute(Kf.a.af,Kf.a.ru);ib.setAttribute(Kf.a.gs,Bb);ib.appendChild(Oa);Cc&&(Bb=Hf.a.Nn(),Bb.className="cui-ctl-mediumlabel",Bb.setAttribute("Unselectable",
"on"),Bb.setAttribute(Kf.a.af,Kf.a.ru),Bb.innerText=Cc,ib.appendChild(Bb));return ib}static tCa(aa,sa){return Nd.sCa(aa,aa.JS,"cui-img-16by16","cui-ctl-iconContainer",sa,CommonUIStrings.l_DialogClose,null)}}Nd.r_k="CommentPaneLTR";Nd.s_k="CommentPaneRTL";Nd.t_k="CommentPaneWithBorderButton";Nd.H_k=300;Object(k.a)(Nd,"CommentPaneHelper",null,[]);var Ld=d(47);class Xe{constructor(aa,sa,Oa,ib,Gb){this.gdc=this.MHa=null;new dd.a(0,0,0,0);this.wWa=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("PptReactTabbedTaskPanesM2IsEnabled");
this.Yrg=null;this.xth=!1;this.nH=Gb;this.eJ=aa;this.Qb=sa;this.nH||(this.MHa=document.createElement("div"),this.MHa.className="CommentPanel",this.MHa.style.position="absolute");this.Db=!1;this.rO=Oa;this.wUg=ib}dispose(){}layout(aa,sa){if(this.wWa)return aa;if(null===aa)throw Error.argumentNull("availableArea");const Oa=sa?aa.hD(this.width):aa.iD(this.width);this.isVisible&&(sa?Oa.hD(1):Oa.iD(1));this.nH||Hf.a.k1(this.MHa,Oa);return aa}zbe(aa){this.gdc=aa}i5k(aa){this.Yrg=aa}yp(aa,sa){this.Db=aa;
this.wWa?this.nH?this.yM(this.Db):this.wUg.yM(this,this.Db,ResourceStrings.L_Comments,Ld.a.Hp):(this.Qb.bgb(this.rO&&sa?1:2),this.eJ.updateCommandUI())}yM(aa){ed.UISurfaces.xr().then(sa=>{aa?sa.showTaskPane(Ld.a.Hp,this.Yrg):sa.hideTaskPane(Ld.a.Hp,2);return null}).catch(sa=>{wb.a.J(572339907,833,10,"CommentsPane::ShowHidePane exception: {0}. isVisible: {1}",sa.toString(),aa.toString())})}qSe(){ed.UISurfaces.xr().then(aa=>{aa.setSelectedTaskPane(Ld.a.Hp);return null}).catch(aa=>{wb.a.J(572339909,
833,10,"CommentsPane::SelectPane exception: {0}",aa.toString())})}W1k(){try{this.nH?this.qSe():this.wUg.qSe(Ld.a.Hp)}catch(aa){wb.a.J(592591050,805,100," Task pane couldn't be selected as it is not present in tabbed task pane group",aa)}}bgb(aa){this.Qb.bgb(this.rO&&aa?1:2)}get isVisible(){return this.Db}get xa(){return this.MHa}get order(){return 18}get width(){return this.isVisible?Nd.H_k+1:0}}Object(k.a)(Xe,"CommentsPane",null,[1208,461,106,1222]);class pe{constructor(){this.WZa=this.fLa=0;this.Uc=
this.y_a=this.Nia=null}}Object(k.a)(pe,"FindCommentContext",null,[]);var fe;(function(aa){aa[aa.findNextComment=0]="findNextComment";aa[aa.findPreviousComment=1]="findPreviousComment";aa[aa.findNextActiveComment=2]="findNextActiveComment";aa[aa.findPreviousActiveComment=3]="findPreviousActiveComment"})(fe||(fe={}));Object(k.b)("FindCommentRequestType",fe);class wd{constructor(aa,sa,Oa,ib,Gb,Bb){this.qc=aa;this.ua=sa;this.mte=Oa;this.gO=ib;this.Wzg=Gb;this.Bd=new pe;this.G6j=Bb}get iCa(){return this.G6j.value}dispose(){this.mte.dispose();
this.Bd=this.mte=null}h2d(aa,sa,Oa){this.d2d(0,!1,aa,sa,Oa)}o2d(aa,sa,Oa){this.d2d(1,!1,aa,sa,Oa)}i2d(aa,sa){this.d2d(0,!0,aa,sa,!1)}d2d(aa,sa,Oa,ib,Gb){var Bb=this.ua.presentation;if(!Bb)throw Error.argumentNull("Presentation is null");ib||(ib=Jd.a.Ik("FindComment",0),ib.Va("FindCommentRequestType",fe[aa]));ib.Va(wd.ZRd,"true");if(this.Wzg&&this.ua.Ba){if(!this.ua.Ba)throw Error.argumentNull("ActiveSlide is null");const Cc=this.ua.Ba.oe;Bb=Bb.slides||[];this.Bd.Nia=Oa;this.Bd.WZa=wd.s8i(aa,Gb);this.Bd.Uc=
ib;sa?this.e2d(Bb[Cc>=Bb.length-1?0:Cc+1]):1===aa?this.PTf(Bb,Cc-1,Gb):this.MTf(Bb,Cc+1,Gb)}else ib.Va(wd.Fli,this.Wzg.toString()),Oa(null,null,!1,!1)}MTf(aa,sa,Oa){this.Bd.y_a=null;this.Bd.fLa=sa;for(let ib=sa;ib<aa.length;ib++)if(aa[ib]&&this.ekg(aa[ib])){const Gb=this.x8i(aa[ib],Oa);if(Gb){this.Bd.Nia(aa[ib],Gb,!1,!1);return}}else{this.e2d(aa[ib]);return}0<sa?this.HWi(Oa):this.notFound()}PTf(aa,sa,Oa){this.Bd.y_a=null;this.Bd.fLa=sa;for(let ib=sa;-1<ib;ib--)if(aa[ib]&&this.ekg(aa[ib])){const Gb=
this.$$i(aa[ib],Oa);if(Gb){this.Bd.Nia(aa[ib],Gb,!1,!1);return}}else{this.e2d(aa[ib]);return}sa<aa.length-1?this.PWi(Oa):this.notFound()}e2d(aa){this.Bd.Uc.Wm(wd.jmi,new Date);aa&&this.mte.find(aa.Cb,this.Bd.WZa,Object(za.a)(this,this.Isk,"onServerFindSucceeded"),Object(za.a)(this,this.Hsk,"onServerFindFailed"))}Isk(aa){this.Bd.Uc.GB(wd.ZRd,"false");this.Bd.Uc.Wm(wd.Wzf,new Date);this.Bd.Uc.Va(wd.Fzf,"true");aa?(this.Bd.y_a=aa,-1===this.F5b(this.Bd.y_a.TargetSlideId)?this.notFound():this.Bd.Nia(this.Cql(this.Bd.y_a.TargetSlideId),
this.Bd.y_a.TargetComment,this.Bd.y_a.IsFirstComment,this.Bd.y_a.IsLastComment)):this.notFound()}Hsk(){this.Bd.Uc.GB(wd.ZRd,"false");this.Bd.Uc.Wm(wd.Wzf,new Date);this.Bd.Uc.Va(wd.Fzf,"false");wb.a.J(512496786,805,50,"OnServerFindFailed");this.notFound()}HWi(aa){var sa=this.ua.presentation;if(!sa)throw Error.argumentNull("Presentation is null");sa=sa.slides||[];Sc.a.Wa(sa)?this.notFound():this.MTf(sa,0,aa)}PWi(aa){var sa=this.ua.presentation;if(!sa)throw Error.argumentNull("Presentation is null");
sa=sa.slides||[];Sc.a.Wa(sa)?this.notFound():this.PTf(sa,sa.length-1,aa)}x8i(aa,sa){aa=this.qc.zl(aa.Cb);if(this.iCa){const Oa=(aa=this.gO.Z8a(aa))?aa.length:0;for(let ib=0;ib<Oa;ib++){const Gb=aa[ib];if(wd.nlg(Gb,sa))return Gb}return null}return this.gO.sWi(aa,sa)}$$i(aa,sa){aa=this.qc.zl(aa.Cb);if(this.iCa){var Oa=(aa=this.gO.Z8a(aa))?aa.length:0;for(--Oa;0<=Oa;Oa--){const ib=aa[Oa];if(wd.nlg(ib,sa))return ib}return null}return this.gO.EWi(aa,sa)}ekg(aa){return aa.aE}F5b(aa){var sa=this.ua.presentation;
if(!sa)throw Error.argumentNull("Presentation is null");if(aa){sa=sa.slides||[];aa=new Vc.a(aa);for(let Oa=0;Oa<sa.length;Oa++)if(sa[Oa]&&Vc.a.K_b(sa[Oa].Cb,aa))return Oa}return-1}Cql(aa){return aa?this.qc.Vja(new Vc.a(aa)):null}notFound(){this.Bd.Nia&&this.Bd.Nia(null,null,!1,!1)}static s8i(aa,sa){if(sa)switch(aa){case 0:return 2;case 1:return 3}return aa}static nlg(aa,sa){return!sa||0===aa.status}}wd.ZRd="IsCompletedSearchInClient";wd.jmi="ServerSearchStartTime";wd.Wzf="ServerSearchEndTime";wd.Fzf=
"IsServerSearchSucceeded";wd.Fli="IsBRSOn";Object(k.a)(wd,"FindCommentLogic",null,[1206,106]);var Ue=d(79);class rd{constructor(){this.type=0;this.Nia=this.Uc=null;this.JMd=!1}}Object(k.a)(rd,"Entry",null,[]);class Ud{constructor(aa,sa){this.N3c=null;this.Qp=aa;this.zb=sa;this.kma=[];this.Zwe=0}dispose(){this.Qp.dispose();this.kma=this.Qp=null;wb.a.J(25985481,805,50,"MaxQueuedEntryNum: {0}",this.Zwe)}h2d(aa,sa,Oa){this.enqueue(1,aa,sa,Oa)}o2d(aa,sa,Oa){this.enqueue(0,aa,sa,Oa)}i2d(aa,sa){this.enqueue(2,
aa,sa,!1)}enqueue(aa,sa,Oa,ib){Oa.Va("AlreadyQueuedEntryCount",this.kma.length.toString());aa=Object.assign(new rd,{type:aa,Nia:(Gb,Bb,Cc,cc)=>{sa(Gb,Bb,Cc,cc);this.N3c=null;this.E9g()},Uc:Oa,JMd:ib});Array.enqueue(this.kma,aa);this.Zwe=Math.max(this.Zwe,this.kma.length);this.E9g()}E9g(){0<this.kma.length&&!this.N3c&&(this.N3c=new Ue.a(2,1,0,Object(za.a)(this,this.xFk,"processOneEntry"),90,"49"),this.zb.Eb(this.N3c))}xFk(){const aa=Array.dequeue(this.kma);1===aa.type?this.Qp.h2d(aa.Nia,aa.Uc,aa.JMd):
0===aa.type?this.Qp.o2d(aa.Nia,aa.Uc,aa.JMd):this.Qp.i2d(aa.Nia,aa.Uc)}}Object(k.a)(Ud,"FindCommentLogicDecorator",null,[1206,106]);var qe=d(384),Nf=d(108);class sf extends Nf.a{constructor(aa,sa){super();this.StartSlideId=null;this.RequestType=0;this.FFindModernComments=!1;if(null===aa)throw Error.argumentNull("slideId");this.RequestType=sa;this.StartSlideId=aa.toString();this.FFindModernComments=!0}$k(){return 88}}Object(k.a)(sf,"FindCommentRequest",Nf.a,[]);class tf extends qe.a{constructor(aa){super();
this.Ama=null;this.PQg=0;this.gIa=this.yGa=null;this.enabled=2;this.jDb=0;this.Gk=!1;this.Lm=aa;this.Lm.register(this)}dispose(){this.Gk||(1===this._state&&this.Lm.unregister(this),this.Gk=!0,this.jDb=0)}find(aa,sa,Oa,ib){0<this.jDb&&null!==Oa&&(wb.a.J(523249091,805,15,"FindCommentReplicator::Find() - NumPendingFindRequests={0}",this.jDb),Oa(null));this.Ama=aa;this.PQg=sa;this.yF(Oa,ib,null)}dka(){return 0<this.jDb&&!this.Gk}IN(){return!1}sTa(){return this.wjg||this.dka()}IJb(){if(1===this._state)this.Ud.DH=
new sf(this.Ama,this.PQg),this.Ud.status=1,this._state=3;else if(3===this._state&&this.wjg)if(wb.a.J(523249092,805,50,"FindCommentRequest EnqeueTime={0}, InvokedTime={1}, CompletedTime={2}",this.Ud.Ikd,this.Ud.St,this.Ud.hv),2===this.Ud.statusCode&&this.Ud.Or&&1===this.Ud.Or.length){const aa=this.Ud.Or[0];0!==aa.StatusCode?this.xH(aa):this.K0(aa)}else this.xH()}yF(aa,sa){this.jDb++;this.gIa=aa;this.yGa=sa;this.Lm.kaa()}forceOutbound(){}xH(aa=null){wb.a.J(523249094,805,50,"FindCommentReplicator Inbound failed: HttpStatusCode={0}, OperationStatusCode={1}, FindCommentResponseStatusCode={2}",
this.Ud.tv,this.Ud.statusCode,aa?aa.StatusCode:-1);this.B3g(aa,!1)}K0(aa){this.B3g(aa,!0)}get wjg(){return!!this.Ud&&2===this.Ud.status}B3g(aa,sa){this.jDb--;this._state=1;if(sa){sa=null;try{sa=Sys.Serialization.JavaScriptSerializer.deserialize(aa.FindCommentResult)}catch(Oa){wb.a.J(523249095,805,10,"Cannot parse find comment result: {0}",Oa)}this.gIa(sa)}else this.yGa(null,-1)}}Object(k.a)(tf,"FindCommentReplicator",qe.a,[106]);class Lf{constructor(){this.Qs=null;this.fvc=this.qjf=this.Z5e=this.HDc=
this.Pof=this.khf=this.zkf=!1}aij(){this.Qs||(n.ULS.sendTraceTag(588292828,327,10,"OfficeSharedCommentsAppCapabilities: AppSettings object should not be empty"),this.Sqh());return this.Qs}Ibj(){return new Promise((aa,sa)=>{this.fvc?aa(this.F1f()):this.Ooh().then(()=>{aa(this.F1f())}).catch(Oa=>{sa(Oa)})})}F1f(){this.fvc||n.ULS.sendTraceTag(588292829,327,10,"OfficeSharedCommentsAppCapabilities: GetModelCapabilitiesInternal should not be called before AtMentions are resolved");let aa;aa=33;this.Z5e&&
(aa|=2);this.zkf&&(aa|=8);this.Pof&&(aa|=16);this.khf&&(aa|=4);this.HDc&&(aa|=64);this.qjf&&(aa|=128);return aa}}Object(k.a)(Lf,"OfficeSharedCommentsAppCapabilities",null,[1545]);class kf extends Lf{constructor(aa,sa,Oa,ib,Gb,Bb){super();this.Yb=aa;this.Ga=sa;this.EGg=Oa;this.D7c=Bb;this.Q9k(ib,Gb);this.Sqh();this.Ooh()}Q9k(aa,sa){this.HDc=this.Yb.ka("TasksForCommentsEnabled")&&!aa;this.Pof=!1;this.zkf=sa;this.qjf=this.khf=!0}Sqh(){this.Qs={};const aa=this.HDc&&e.AFrameworkApplication.fa.ka("TasksCreationFromReplyEnabled");
this.Qs.CommentsFluentUI="true";this.Qs.CommentsFluentUIV2="true";this.Qs.CommentTasks=this.HDc.toString();bd.a("DeprecateIE.SharedCommentAppCapabilities")?this.Qs.DisabledChangeGates=this.Yb.Ha("DisabledChangeGatesInSharedComments"):this.Qs.DisabledChangeGates=Ab.a.Dj?"WebThemeIntegrationHighContrastFixes,":""+this.Yb.Ha("DisabledChangeGatesInSharedComments");this.Qs.DiscreteHostedComments="true";this.Qs.CommentReactions=id(this.Yb).toString();this.Qs.NewCommentButton="true";this.Qs.PersonaColor=
"true";this.Qs.LivePersonaPicker="true";this.Qs.AtMentionFloodgateSurvey=e.AFrameworkApplication.fa.ka("AtMentionUserFloodGateCampaignIsEnabled").toString();this.Qs.CommentTasksFromReply=aa.toString();this.Qs.LogDraftCommentIdPair=this.D7c.toString();this.Qs.HyperlinksInComments="true";this.Qs.SmartReplies=this.Yb.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.SmartRepliesIsEnabled",!1).toString();this.Qs.NewModelState="true";this.Qs.TaskPaneWithNewInfrastructure=this.Ga.NUd.toString();
this.Qs.NewSelectionInteractions="true";this.Qs.ExtendedDrafting="true";this.Qs.LinkToComment="true";this.Qs.PersonaIconImageForWeb="true";this.Qs.NoDiscardOnFocusLoss="true";this.Qs.WebThemeIntegration="true";this.Qs.TaskHistoryRecordIDs=this.Yb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TaskHistoryRecordIDs",!1).toString()}Ooh(){return new Promise((aa,sa)=>{this.EGg?this.EGg.atMentionsEnabledAsync().then(Oa=>{this.Z5e=Oa;this.fvc=!0;aa(this.fvc)}):(n.ULS.sendTraceTag(509645712,327,10,
"OfficeSharedCommentsAppCapabilities: SetAtMentionCapabilityAsync should not be called before _peopleAPIInstance is initialized"),sa(u.a.vu(-2130915320)))})}}Object(k.a)(kf,"PPTSharedCommentAppCapabilities",Lf,[]);class Ed{constructor(aa){this.Bg=aa}display(aa,sa){this.Bg.p2e(aa?0:2,sa);this.Bg.setVisibility()}dismiss(){this.Bg.Rri();this.Bg.setVisibility()}activate(){this.Bg.p2e(1);this.Bg.setVisibility()}hMi(aa){this.Bg.p2e(aa?0:2)}Im(aa){this.Bg.Im(aa)}eD(aa){this.Bg.eD(aa)}Yp(){return this.Bg.Yp()}HN(aa){return this.Bg.syb(aa)}Jx(aa){this.Bg.Jx(aa)}dispose(){this.Bg.dispose()}My(){this.Bg.My()}YD(aa){return this.Bg.YD(aa)}yB(aa){return this.Bg.yB(aa)}draw(aa,
sa){this.Bg.draw(aa,sa)}get visible(){return this.Bg.visible}set visible(aa){this.Bg.visible=aa}setPosition(aa,sa){this.Bg.setPosition(aa,sa)}Hj(aa){this.Bg.Hj(aa)}Nq(aa){this.Bg.Nq(aa)}Ru(aa){this.Bg.Ru(aa)}setZIndex(aa){this.Bg.setZIndex(aa)}JE(aa,sa){this.Bg.JE(aa,sa)}setSelection(){}}Object(k.a)(Ed,"ShapeCommentsAnchoredSelectionView",null,[1225,284,285,106]);class Cd{constructor(aa,sa){this.canvasContextId=this.canvasActionId=0;this.withFlags=!1;this.postCallback=this.registeredCallback=this.preCallback=
null;this.delayActionsUntilRegistration=!1;this.canvasActionId=aa;this.canvasContextId=sa}}Object(k.a)(Cd,"CommentUIAction",null,[]);var oh=d(63),Kg=d(642),ri=d(119),Af=d(178),Zg=d(1106),gi=d(527);class jg{constructor(){this.draftId=null;this.insertIndex=0;this.anchorHintText=null}}Object(k.a)(jg,"CurrentContextDraft",null,[]);class Hh{constructor(){this.contentId=null;this.anchorTop=this.containerContentType=0;this.anchorBottom=this.anchorRight=this.anchorLeft=null}}Object(k.a)(Hh,"IContentAnchorPosition",
null,[]);class hj{constructor(){this.y=this.x=this.height=this.width=0}}Object(k.a)(hj,"IViewportInfo",null,[]);class Hk{constructor(){this.allContainersVisibleCallback=this.positionsUpdatedScrollHeightCallback=this.positionsUpdatedCallback=this.paneOpenedCallback=this.paneClosedCallback=null}}Object(k.a)(Hk,"FloatingContainerManagerCreationParams",null,[]);var yd=d(139),ef=d(51),yh=d(815),Bg=d(414),Kd=d(380),Rj=d(894),Ia;(function(aa){aa[aa.line=0]="line";aa[aa.lineInv=1]="lineInv";aa[aa.triangle=
2]="triangle";aa[aa.rtTriangle=3]="rtTriangle";aa[aa.rect=4]="rect";aa[aa.diamond=5]="diamond";aa[aa.parallelogram=6]="parallelogram";aa[aa.trapezoid=7]="trapezoid";aa[aa.nonIsoscelesTrapezoid=8]="nonIsoscelesTrapezoid";aa[aa.pentagon=9]="pentagon";aa[aa.hexagon=10]="hexagon";aa[aa.heptagon=11]="heptagon";aa[aa.octagon=12]="octagon";aa[aa.decagon=13]="decagon";aa[aa.dodecagon=14]="dodecagon";aa[aa.star4=15]="star4";aa[aa.star5=16]="star5";aa[aa.star6=17]="star6";aa[aa.star7=18]="star7";aa[aa.star8=
19]="star8";aa[aa.star10=20]="star10";aa[aa.star12=21]="star12";aa[aa.star16=22]="star16";aa[aa.star24=23]="star24";aa[aa.star32=24]="star32";aa[aa.roundRect=25]="roundRect";aa[aa.round1Rect=26]="round1Rect";aa[aa.round2SameRect=27]="round2SameRect";aa[aa.round2DiagRect=28]="round2DiagRect";aa[aa.snipRoundRect=29]="snipRoundRect";aa[aa.snip1Rect=30]="snip1Rect";aa[aa.snip2SameRect=31]="snip2SameRect";aa[aa.snip2DiagRect=32]="snip2DiagRect";aa[aa.plaque=33]="plaque";aa[aa.ellipse=34]="ellipse";aa[aa.teardrop=
35]="teardrop";aa[aa.homePlate=36]="homePlate";aa[aa.chevron=37]="chevron";aa[aa.pieWedge=38]="pieWedge";aa[aa.pie=39]="pie";aa[aa.blockArc=40]="blockArc";aa[aa.donut=41]="donut";aa[aa.noSmoking=42]="noSmoking";aa[aa.rightArrow=43]="rightArrow";aa[aa.leftArrow=44]="leftArrow";aa[aa.upArrow=45]="upArrow";aa[aa.downArrow=46]="downArrow";aa[aa.stripedRightArrow=47]="stripedRightArrow";aa[aa.notchedRightArrow=48]="notchedRightArrow";aa[aa.bentUpArrow=49]="bentUpArrow";aa[aa.leftRightArrow=50]="leftRightArrow";
aa[aa.upDownArrow=51]="upDownArrow";aa[aa.leftUpArrow=52]="leftUpArrow";aa[aa.leftRightUpArrow=53]="leftRightUpArrow";aa[aa.quadArrow=54]="quadArrow";aa[aa.leftArrowCallout=55]="leftArrowCallout";aa[aa.rightArrowCallout=56]="rightArrowCallout";aa[aa.upArrowCallout=57]="upArrowCallout";aa[aa.downArrowCallout=58]="downArrowCallout";aa[aa.leftRightArrowCallout=59]="leftRightArrowCallout";aa[aa.upDownArrowCallout=60]="upDownArrowCallout";aa[aa.quadArrowCallout=61]="quadArrowCallout";aa[aa.bentArrow=62]=
"bentArrow";aa[aa.uturnArrow=63]="uturnArrow";aa[aa.circularArrow=64]="circularArrow";aa[aa.leftCircularArrow=65]="leftCircularArrow";aa[aa.leftRightCircularArrow=66]="leftRightCircularArrow";aa[aa.curvedRightArrow=67]="curvedRightArrow";aa[aa.curvedLeftArrow=68]="curvedLeftArrow";aa[aa.curvedUpArrow=69]="curvedUpArrow";aa[aa.curvedDownArrow=70]="curvedDownArrow";aa[aa.swooshArrow=71]="swooshArrow";aa[aa.cube=72]="cube";aa[aa.can=73]="can";aa[aa.lightningBolt=74]="lightningBolt";aa[aa.heart=75]="heart";
aa[aa.sun=76]="sun";aa[aa.moon=77]="moon";aa[aa.smileyFace=78]="smileyFace";aa[aa.irregularSeal1=79]="irregularSeal1";aa[aa.irregularSeal2=80]="irregularSeal2";aa[aa.foldedCorner=81]="foldedCorner";aa[aa.bevel=82]="bevel";aa[aa.frame=83]="frame";aa[aa.halfFrame=84]="halfFrame";aa[aa.corner=85]="corner";aa[aa.diagStripe=86]="diagStripe";aa[aa.chord=87]="chord";aa[aa.arc=88]="arc";aa[aa.leftBracket=89]="leftBracket";aa[aa.rightBracket=90]="rightBracket";aa[aa.leftBrace=91]="leftBrace";aa[aa.rightBrace=
92]="rightBrace";aa[aa.bracketPair=93]="bracketPair";aa[aa.bracePair=94]="bracePair";aa[aa.straightConnector1=95]="straightConnector1";aa[aa.bentConnector2=96]="bentConnector2";aa[aa.bentConnector3=97]="bentConnector3";aa[aa.bentConnector4=98]="bentConnector4";aa[aa.bentConnector5=99]="bentConnector5";aa[aa.curvedConnector2=100]="curvedConnector2";aa[aa.curvedConnector3=101]="curvedConnector3";aa[aa.curvedConnector4=102]="curvedConnector4";aa[aa.curvedConnector5=103]="curvedConnector5";aa[aa.callout1=
104]="callout1";aa[aa.callout2=105]="callout2";aa[aa.callout3=106]="callout3";aa[aa.accentCallout1=107]="accentCallout1";aa[aa.accentCallout2=108]="accentCallout2";aa[aa.accentCallout3=109]="accentCallout3";aa[aa.borderCallout1=110]="borderCallout1";aa[aa.borderCallout2=111]="borderCallout2";aa[aa.borderCallout3=112]="borderCallout3";aa[aa.accentBorderCallout1=113]="accentBorderCallout1";aa[aa.accentBorderCallout2=114]="accentBorderCallout2";aa[aa.accentBorderCallout3=115]="accentBorderCallout3";
aa[aa.wedgeRectCallout=116]="wedgeRectCallout";aa[aa.wedgeRoundRectCallout=117]="wedgeRoundRectCallout";aa[aa.wedgeEllipseCallout=118]="wedgeEllipseCallout";aa[aa.cloudCallout=119]="cloudCallout";aa[aa.cloud=120]="cloud";aa[aa.ribbon=121]="ribbon";aa[aa.ribbon2=122]="ribbon2";aa[aa.ellipseRibbon=123]="ellipseRibbon";aa[aa.ellipseRibbon2=124]="ellipseRibbon2";aa[aa.leftRightRibbon=125]="leftRightRibbon";aa[aa.verticalScroll=126]="verticalScroll";aa[aa.horizontalScroll=127]="horizontalScroll";aa[aa.wave=
128]="wave";aa[aa.doubleWave=129]="doubleWave";aa[aa.plus=130]="plus";aa[aa.flowChartProcess=131]="flowChartProcess";aa[aa.flowChartDecision=132]="flowChartDecision";aa[aa.flowChartInputOutput=133]="flowChartInputOutput";aa[aa.flowChartPredefinedProcess=134]="flowChartPredefinedProcess";aa[aa.flowChartInternalStorage=135]="flowChartInternalStorage";aa[aa.flowChartDocument=136]="flowChartDocument";aa[aa.flowChartMultidocument=137]="flowChartMultidocument";aa[aa.flowChartTerminator=138]="flowChartTerminator";
aa[aa.flowChartPreparation=139]="flowChartPreparation";aa[aa.flowChartManualInput=140]="flowChartManualInput";aa[aa.flowChartManualOperation=141]="flowChartManualOperation";aa[aa.flowChartConnector=142]="flowChartConnector";aa[aa.flowChartPunchedCard=143]="flowChartPunchedCard";aa[aa.flowChartPunchedTape=144]="flowChartPunchedTape";aa[aa.flowChartSummingJunction=145]="flowChartSummingJunction";aa[aa.flowChartOr=146]="flowChartOr";aa[aa.flowChartCollate=147]="flowChartCollate";aa[aa.flowChartSort=
148]="flowChartSort";aa[aa.flowChartExtract=149]="flowChartExtract";aa[aa.flowChartMerge=150]="flowChartMerge";aa[aa.flowChartOfflineStorage=151]="flowChartOfflineStorage";aa[aa.flowChartOnlineStorage=152]="flowChartOnlineStorage";aa[aa.flowChartMagneticTape=153]="flowChartMagneticTape";aa[aa.flowChartMagneticDisk=154]="flowChartMagneticDisk";aa[aa.flowChartMagneticDrum=155]="flowChartMagneticDrum";aa[aa.flowChartDisplay=156]="flowChartDisplay";aa[aa.flowChartDelay=157]="flowChartDelay";aa[aa.flowChartAlternateProcess=
158]="flowChartAlternateProcess";aa[aa.flowChartOffpageConnector=159]="flowChartOffpageConnector";aa[aa.actionButtonBlank=160]="actionButtonBlank";aa[aa.actionButtonHome=161]="actionButtonHome";aa[aa.actionButtonHelp=162]="actionButtonHelp";aa[aa.actionButtonInformation=163]="actionButtonInformation";aa[aa.actionButtonForwardNext=164]="actionButtonForwardNext";aa[aa.actionButtonBackPrevious=165]="actionButtonBackPrevious";aa[aa.actionButtonEnd=166]="actionButtonEnd";aa[aa.actionButtonBeginning=167]=
"actionButtonBeginning";aa[aa.actionButtonReturn=168]="actionButtonReturn";aa[aa.actionButtonDocument=169]="actionButtonDocument";aa[aa.actionButtonSound=170]="actionButtonSound";aa[aa.actionButtonMovie=171]="actionButtonMovie";aa[aa.gear6=172]="gear6";aa[aa.gear9=173]="gear9";aa[aa.funnel=174]="funnel";aa[aa.mathPlus=175]="mathPlus";aa[aa.mathMinus=176]="mathMinus";aa[aa.mathMultiply=177]="mathMultiply";aa[aa.mathDivide=178]="mathDivide";aa[aa.mathEqual=179]="mathEqual";aa[aa.mathNotEqual=180]="mathNotEqual";
aa[aa.cornerTabs=181]="cornerTabs";aa[aa.squareTabs=182]="squareTabs";aa[aa.plaqueTabs=183]="plaqueTabs";aa[aa.chartX=184]="chartX";aa[aa.chartStar=185]="chartStar";aa[aa.chartPlus=186]="chartPlus"})(Ia||(Ia={}));Object(k.b)("ST_ShapeType",Ia);var nb=d(152);class Kb{constructor(){this.RowId=this.ColId=null}}Object(k.a)(Kb,"TableCellInfo",null,[]);var dc=d(893),Ic=d(50),Id=d(183),ae=d(122),Od=d(166),Hd=d(1103),Bf=d(921),Of=d(922),ph=d(346),Qh=d(106);class Lg{constructor(aa,sa){this.Zva=this.fBb=null;
this.CCg=!1;this.Cze=aa;this.mh=sa}get sTj(){return this.CCg}qJb(aa,sa){sa&&aa.removeNotification(sa);return sa}zRk(aa){this.fBb=this.qJb(aa,this.fBb);this.qJb(aa,this.Zva);this.Zva=this.fBb=null}bhl(aa,sa,Oa){aa?this.Cze.zm.isVisible&&1===aa.tM.length&&sa.Ba&&Vc.a.taa(aa.v8a.Cb,sa.Ba.Cb)||ed.UISurfaces.CN().then(ib=>{this.Zva=this.qJb(ib,this.Zva);this.Zva=null;var Gb=Object.assign(new Hd.a,{label:aa.aIb,onExecute:()=>{aa.primaryButtonAction(this.Cze,sa);sa.Ba.oe!==aa.v8a.oe&&Oa.xU(aa.v8a.oe);this.qJb(ib,
this.Zva);this.Zva=null}}),Bb=Object.assign(new Hd.a,{label:aa.amd,onExecute:()=>{this.CCg=!0;this.qJb(ib,this.Zva);this.Zva=null}});Bb=Object.assign(new Bf.a,{target:".EditingRibbonPanel",title:aa.title,content:aa.content,primaryButtonProps:Gb,secondaryButtonProps:Bb,useTeachingStyles:!1,showCloseIcon:!0,calloutProps:Object.assign(new Of.a,{directionalHint:6,gapSpace:4,isBeakVisible:!1,onDismiss:()=>{this.mh.Ho(Ld.a.W_a)},preventDismissOnScroll:!0,preventDismissOnResize:!0})});Gb=Object.assign(new ph.a,
{onShow:()=>{this.mh.EK(Ld.a.W_a)}});Bb=ib.callout(Bb);this.Zva=ib.addNotification(Bb,Gb)}):wb.a.J(546153881,805,50,"SharedCommentFrame::ShowReviewResolvedCommentsCallout - Trying to show review resolved comments callout when params are null.")}Cuh(aa,sa){const Oa=new Qh.StandardDialog;Oa.xd=4;Oa.Bx(ResourceStrings.l_DeleteAllCommentsConfirmationTitle,sa?ResourceStrings.l_DeleteAllResolvedCommentsConfirmation:ResourceStrings.l_DeleteAllCommentsConfirmation,1,ib=>{1===ib?(aa.v1b(sa),this.Cze.m1d(sa)?
this.Duh():this.Buh(sa?ResourceStrings.l_DeleteAllResolvedCommentsInPresentationCallout:ResourceStrings.l_DeleteAllCommentsInPresentationCallout),wb.a.J(546153882,805,50,"SharedCommentFrame::ShowDeleteAllConfirmationDialog - Yes button clicked for DeleteAllComments - fDeleteAllResolved: {0}",sa)):wb.a.J(546153883,805,50,"SharedCommentFrame::ShowDeleteAllConfirmationDialog - No button clicked for DeleteAllComments - fDeleteAllResolved: {0}",sa)})}Duh(){const aa=new Qh.StandardDialog;aa.xd=0;aa.Bx(ResourceStrings.l_DeleteAllCommentsErrorTitle,
ResourceStrings.l_DeleteAllCommentsError,1,null)}Buh(aa){const sa=()=>{this.mh.EK(Ld.a.W_a)},Oa=()=>{this.mh.Ho(Ld.a.W_a)};ed.UISurfaces.CN().then(ib=>{this.qJb(ib,this.fBb);this.fBb=null;var Gb=Object.assign(new Bf.a,{target:".EditingRibbonPanel",title:ResourceStrings.l_DeleteAllCommentsCalloutTitle,content:aa,showCloseIcon:!0,useTeachingStyles:!1,calloutProps:Object.assign(new Of.a,{directionalHint:6,isBeakVisible:!1,onDismiss:Oa,preventDismissOnScroll:!0,preventDismissOnResize:!0})});const Bb=
Object.assign(new ph.a,{onShow:sa});Gb=ib.callout(Gb);this.fBb=ib.addNotification(Gb,Bb)})}}Object(k.a)(Lg,"CommentCalloutDialogManager",null,[]);var Fg=d(953);class dg{constructor(aa){this.UWa=aa;this.kma=[];this.$pe=new Fg.a(1E3,Object(za.a)(this,this.perform,"perform"))}CBk(aa){Array.contains(this.kma,aa)||Array.add(this.kma,aa);this.$pe.perform()}perform(){const aa=this.kma;this.kma=[];for(let sa=0;sa<aa.length;sa++){const Oa=aa[sa];this.UWa.AFb(Oa.commentId,new Lc.a(Oa.pos.X,Oa.pos.Y))}}}Object(k.a)(dg,
"CommentKeyboardMoveController",null,[]);class hi{constructor(aa,sa,Oa,ib,Gb){this.TFa=this.bwa=null;this.yea=[];if(!aa)throw Error.argumentNull("parentElement");if(!sa)throw Error.argumentNull("frame");this.YCb=Oa;this.ai=aa;this.kb=sa;this.zvg=ib;this.Kvg=Gb}dispose(){this.DOe();this.kb=this.ai=null}DOe(){this.TFa=this.bwa=null;if(this.yea&&0<this.yea.length){for(const aa of this.yea)aa&&aa.dispose();Array.clear(this.yea)}}h_(aa){if(!this.mDa)return!0;if(!aa||!aa.length)return!1;aa=Od.e(aa,sa=>
0===sa.status);return!!aa&&0<aa.length}Cjd(aa){this.DOe();if(aa&&this.ai){var sa=this.kb.isReadOnly?null:this.kb.Vt;for(const Oa of aa)this.yea.push(this.YCb.create(Oa,this.ai,this,sa,this.kb.isReadOnly,Pd.xN(Oa)||!this.Kvg));this.h_(aa)&&this.T2e()}}selectComment(aa,sa){if(!(!aa&&!this.bwa||this.bwa&&Pd.Vub(aa,this.bwa.comment))&&(this.bwa&&this.bwa.select(!1),this.bwa=null,aa))for(const Oa of this.yea){if(Pd.Vub(Oa.comment,aa)){this.bwa=Oa;Oa.select(!0);break}if(sa&&Oa.comment.Children)for(const ib of Oa.comment.Children)if(Pd.Vub(ib,
aa)){this.bwa=Oa;Oa.select(!0);return}}}nqb(aa,sa){if(!(!aa&&!this.TFa||this.TFa&&Pd.Vub(aa,this.TFa.comment))&&(this.TFa&&this.TFa.activate(!1),this.TFa=null,aa))for(const Oa of this.yea){if(Pd.Vub(Oa.comment,aa)){this.TFa=Oa;Oa.activate(!0);break}if(sa&&Oa.comment.Children)for(const ib of Oa.comment.Children)if(Pd.Vub(ib,aa)){this.TFa=Oa;Oa.activate(!0);return}}}Suh(aa){for(const sa of this.yea)sa.Ruh(aa)}T2e(){for(const aa of this.yea)aa.updatePosition(this.kb.mCa(aa.comment.pos.X,aa.comment.pos.Y))}AFb(aa,
sa){sa=this.kb.HGf(sa._x,sa._y);aa.pos.X+=sa._x;aa.pos.Y+=sa._y;sa=new Lc.a(aa.pos.X,aa.pos.Y);this.kb.selectComment(aa,null,!0,!1,0,1,!1);this.kb.manager.AFb(aa.commentId,sa)}izl(aa){for(const sa of this.yea)if(sa.comment===aa){sa.updatePosition(this.kb.mCa(sa.comment.pos.X,sa.comment.pos.Y));break}}jzl(aa){for(const sa of aa)for(const Oa of this.yea)Oa.comment.commentId===sa.commentId&&Oa.updatePosition(this.kb.mCa(Oa.comment.pos.X,Oa.comment.pos.Y))}setVisibility(aa){this.Kvg=aa;for(const sa of this.yea)sa.setVisibility(!Pd.xN(sa.comment)&&
aa)}get frame(){return this.kb}get isRightToLeft(){return this.zvg}set isRightToLeft(aa){this.zvg=aa}get parentElement(){return this.ai}set parentElement(aa){this.ai=aa}get yKb(){return this.bwa}get mDa(){return!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("SlideResizePerfImprovementEnabled")}}Object(k.a)(hi,"CommentMarkerView",null,[]);class Mg{constructor(){this.comment=this.slide=null;this.direction=0;this.kSe=null}}Object(k.a)(Mg,"CommentSelectContext",null,[]);var ne;(function(aa){aa[aa.previous=
0]="previous";aa[aa.next=1]="next"})(ne||(ne={}));Object(k.b)("CommentSelectDirection",ne);class Bh{constructor(aa,sa){if(!aa||1>aa.length)throw Error.argument("ISlideNode[] slides");if(!sa)throw Error.argumentNull("ICommentGraphManager graphManager");this.kck=aa;this.il=sa;this.$ye=[];this.init()}get kJa(){return this.kck}get tM(){return this.$ye}get v8a(){return this.tM[this.tM.length-1]}get aIb(){return 1<this.tM.length?ResourceStrings.L_CommentReviewResolvedCalloutGoToButton:ResourceStrings.L_CommentReviewResolvedCalloutReviewButton}get amd(){return ResourceStrings.L_CommentReviewResolvedCalloutDontShowButton}get title(){return ResourceStrings.L_CommentReviewResolvedCalloutTitle}get content(){return this.Cil()}init(){for(const aa of this.kJa)for(const sa of this.il.eta(aa.SD()))if(1===
sa.status){this.$ye.push(aa);break}if(1>this.$ye.length)throw Error.argument("ISlideNode[] slides contains no resolved comments.");}Cil(){switch(this.tM.length){case 1:return ResourceStrings.L_CommentReviewResolvedCalloutContentSlides1;case 2:return String.format(ResourceStrings.L_CommentReviewResolvedCalloutContentSlides2,this.tM[1].oe+1,this.tM[0].oe+1);case 3:return String.format(ResourceStrings.L_CommentReviewResolvedCalloutContentSlides3,this.tM[2].oe+1,this.tM[1].oe+1,this.tM[0].oe+1);case 4:return String.format(ResourceStrings.L_CommentReviewResolvedCalloutContentSlides4,
this.tM[3].oe+1,this.tM[2].oe+1,this.tM[1].oe+1);default:return String.format(ResourceStrings.L_CommentReviewResolvedCalloutContentSlidesN,this.tM[this.tM.length-1].oe+1,this.tM[this.tM.length-2].oe+1,this.tM[this.tM.length-3].oe+1,this.tM.length-3)}}G8i(){for(const aa of this.il.Z8a(this.v8a))if(1===aa.status)return aa;return null}primaryButtonAction(aa,sa){if(!sa.presentation||!sa.presentation.slides)return wb.a.J(571269902,805,10,"ResolvedCommentsCalloutParams::PrimaryButtonAction - Failed to show callout due to null {0}",
sa.presentation?"Presentation.Slides":"Presentation"),null;const Oa=this.G8i();if(!Oa)return null;aa.zm.isVisible||aa.gpd();if(sa.Ba&&Vc.a.taa(sa.Ba.Cb,this.v8a.Cb))aa.Kfa(Oa.commentId,1,!0);else for(const ib of sa.presentation.slides)if(Vc.a.taa(ib.Cb,this.v8a.Cb))return Object.assign(new Mg,{slide:this.v8a,comment:Oa,direction:1,kSe:Jd.a.Ik("SelectResolvedCommentCrossSlide",1)});return null}}Object(k.a)(Bh,"ResolvedCommentsCalloutParams",null,[]);class Vh{constructor(){this.type="SharedCommentsTaskPaneProps";
this.focusCallback=null}}Object(k.a)(Vh,"SharedCommentsTaskPaneProps",null,[]);var ij=d(956),Ij=d(432),Yj=d(156);class ii{constructor(aa,sa,Oa,ib,Gb,Bb,Cc,cc,Qd,re,Ca,ob,Hb,rc,td,sc,Tc,Dc,xc,pg,Ih,vh,Ti,ai,Il,ui,Cg,hl,yj,Oi,jj,zh,bk,Wk,Xk,he,ik,Zf,em,nj,vk,wk,yl,tg,Pi,Jl,pm,hn,Em,fm,qm,Ik,Jk,Kl,Fm,ck,Ui,Ch){this.uze=this.kn=null;this.Bcb=!0;this.Po=this.Lre=this.Hcc=this.tre=this.Dcb=!1;this.Ldb=0;this.R9c=this.dEb=!1;this.gGa=this.a9c=this.$h=this.wVa=this.Peb=this.k$=this.Wpg=null;this.Dvg=this.AWa=
!1;this.Gr=null;this.Fze=this.ere=!1;this.VQg=null;this.vzf=[Ld.a.uz,Ld.a.Hp,Ld.a.oW,Ld.a.Fui];this.Qlb=2147483647;this.vAb=0;this.XDg=-1;this.Trg=0;this.Sec=null;this.Q8c=this.ppe=!1;this.MYa=(Ba,il)=>{il.slide===this.ua.Ba&&(Ba=this.hR.instance.iae||this.hR.instance.jae,!il.slide.isUnread||Ba)&&(il=this.il.Qy(),this.gJb(il,e.AFrameworkApplication.isRtl,!0))};if(!he)throw Error.argumentNull("appSettingsManager");if(!vh)throw Error.argumentNull("commentEventHost");if(!sa)throw Error.argumentNull("commentTelemetryManager");
if(Jk.Ks&&!Ch)throw Error.argumentNull("sorterViewActorLazy");this.nH=qm;this.ia=Oa;this.Qb=ib;this.zm=Gb;this.Vt=Bb;this.Yc=Cc;this.Fa=cc;this.mh=Qd;this.je=re;this.pa=Ca;this.Kc=Hb;this.oy=rc;this.lq=td;this.il=aa;this.hE=sa;this.a9j=new dg(aa);this.PX=sc;this.ua=Tc;this.iad=Dc.Ad(40);this.mGg=bd.a("PreventCommentDraftDeletionOnPageContentChange")?Dc.Ad(7):Dc.Ad(8);this.tDb=ob;this.uO=Hb.Ic?Hb.Ic.GUd:null;this.uva=Il;this.zb=pg;this.W_=vh;this.zfb=Ti;this.XEg=Ih;this.K9c=ai;this.qpe=ui;this.k4c=
Cg;this.Ie=Oi;this.c8c=hl;this.Lq=yj;this.N2c=jj;this.Hv=zh;this.YCb=bk;this.lR=Wk;this.Wn=Xk;this.Yb=he;this.zs=Zf;this.dvg=em;this.b4=new r.a;this.Qd=nj;this.Xa=vk;this.Meb=yl;this.fva=wk;this.Lc=tg;this.Ea=pm;this.sbk=hn;this.cJ=Em;this.Lcc=fm;this.Ga=Jk;this.Hk=Kl;this.sX=Fm;this.Ecc=Jl;this.YGa=!1;this.ia.Lna(this);this.Ybb=new Lg(this,this.mh);this.hR=ck;this.P4=Ui;this.iAe=Ch;if(!ik)throw Error.argumentNull("InteractiveViewManagerFuture");this.bzg=ik;this.D3j=this.BAi();this.nH&&this.zm.i5k(this.pdj());
this.Pb=Ik;Pi.wtb().then(Ba=>{Ba||this.gTe(!1)})}get rOc(){return this.dvg}get r1d(){return this.Yb.ka("195")}get nSf(){return this.fva}get p1b(){return this.Yb.Ha("CurrentCommentId")}get gYd(){return this.Yb.Ha("CurrentSlideId")}get I_b(){return this.Yb.ka("PptReactTabbedTaskPanesM2IsEnabled")}get XCk(){return this.Yb.ka("PPTSafeLinksIsEnabledForModernComments")}get Tui(){return this.Yb.ka("CommentTextAnchoringReadWriteEnabled")}get KUd(){return this.Yb.ka("CommentTextAnchoringCreateNewEnabled")}get cPf(){return this.Yb.ka("EnableDeleteAllComments")}get mDa(){return this.Yb.ka("SlideResizePerfImprovementEnabled")}get yub(){return bd.a("CompactingDHCsEnabled")}get dSf(){return bd.a("CanvasToCommentFocusFixV2")}get A8b(){return this.Yb.ka("PPTOBlueDotsForComments")}initialize(){this.Po=
1===this.Qb.mode;this.nH||(this.uva?Sys.UI.DomElement.addCssClass(this.tDb,Nd.s_k):Sys.UI.DomElement.addCssClass(this.tDb,Nd.r_k));const aa=this.Fa.Gc(Ld.a.Hp);aa.zL=!0;aa.k1a=!0;aa.Uba(Oa=>{const ib=!bd.a("FixAltF12KeboardingInCommentPane")||!Oa||Oa.name!==Ld.a.EM;this.kjc(!0,!Oa||Oa.name!==Ld.a.uz&&ib,!0)});aa.xBa((Oa,ib)=>{Oa=(ib.name===Ld.a.VO||ib.name===Ld.a.iaa)&&Oa.name===Ld.a.Hp;this.kjc(!1,!1,ib.name===Ld.a.Hp||ib.name===Ld.a.rg||ib.name===Ld.a.uz||ib.name===Ld.a.oW||this.I_b&&ib.name===
Ld.a.EM||Oa)});const sa=this.Fa.Gc(Ld.a.uz);sa.Uba((Oa,ib)=>{this.Jrk(Oa,ib)});sa.xBa(()=>{this.Irk()});this.nH||this.Yc.nJb(Mb.a.click,this.tDb,Object(za.a)(this,this.nGb,"onCommentPaneParentDivClick"),null,aa.k1a);this.vb();this.oy.ZNd(Object(za.a)(this,this.QIa,"onBeforeSlideSwitched"));this.oy.$V(Object(za.a)(this,this.s2e,"updateCommentsWhenNavigateSlide"));this.lq.lPa(Object(za.a)(this,this.Kpf,"activeSlideDOMDisplayed"));this.Lq.f$h(Object(za.a)(this,this.z4g,"onPageViewZoomChanged"));this.zs.Vsf(Object(za.a)(this,
this.onShapeSelected,"onShapeSelected"));this.zs.J$h(Object(za.a)(this,this.v5g,"onShapeDeselected"));this.oy.UXb(Object(za.a)(this,this.G5g,"onShapeTextSelected"));this.oy.sOd(Object(za.a)(this,this.KYa,"onSlideBackgroundClicked"));this.Ecc&&(this.oy.VXb(Object(za.a)(this,this.ntk,"onSlideSizeUpdated")),this.oy.Q$h(Object(za.a)(this,this.E5g,"onShapeRotatedOrBoundsUpdated")),this.oy.M$h(Object(za.a)(this,this.E5g,"onShapeRotatedOrBoundsUpdated")));this.iad.ik(Object(za.a)(this,this.A6g,"onTextAnchorPropertyChanged"));
this.mGg.FG(Object(za.a)(this,this.uB,"onChildTopologyChanged"));this.iad.CBa(Object(za.a)(this,this.C1g,"onBeforeTextAnchorDisconnect"));this.Meb.ik(Object(za.a)(this,this.Ljc,"onShapePropertyChange"));this.Meb.c$h(Object(za.a)(this,this.z5g,"onShapeInvalidation"));this.Lc.i8h(Object(za.a)(this,this.L2g,"onF6FocusDocument"));this.Lc.NFc(Object(za.a)(this,this.zgb,"onSetFocus"));this.A8b&&this.P4.execute(Oa=>{Oa.tOd(this.MYa)});this.N2c.pOd(Object(za.a)(this,this.Yed,"onSessionExpired"));this.N2c.GA(Object(za.a)(this,
this.Zwa,"onSessionEnded"));this.Kc.Ic&&this.Kc.Ic.GUd&&(this.QIa(this,null),this.s2e(this,null));this.Qb.IK(Object(za.a)(this,this.j1g,"onAppModeSwitched"));this.Qb.L5a(Object(za.a)(this,this.gY,"onSetOffline"));this.lq.Gqb(Object(za.a)(this,this.$ed,"onShapeViewElementAddedOrRemoved"));this.lq.Xsf(Object(za.a)(this,this.$ed,"onShapeViewElementAddedOrRemoved"));this.pa.GG(Object(za.a)(this,this.yH,"onSelectionChanged"))}$ed(aa,sa){this.kn&&(aa=sa.Gw)&&aa.shapeNode&&this.FSj(aa.shapeNode.slideId)&&
this.kn.Cjd(this.il.Qy())}FSj(aa){return!!this.ua&&!!this.ua.$j&&this.ua.$j.equals(aa)}gTe(aa){this.fva=this.dvg=aa;this.Wn.gTe(aa)}ntk(){this.kn&&this.kn.T2e()}E5g(aa,sa){if(this.kn){const Oa=sa.Gw.shapeNode;if(Oa){if((aa=this.il.Qy())&&aa.length){sa=[];for(const ib of aa)ib.anchorShape===Oa.get_shapeId()&&sa.push(ib);this.kn.jzl(sa)}}else wb.a.J(512496785,805,10,"SharedCommentFrame:OnShapeRotatedOrBoundsUpdated shape is null")}}Iyl(){try{if(this.I_b&&this.zm){const aa=Object(lb.a)(1222,this.zm);
aa&&(aa.xth=!!this.$h)}}catch(aa){wb.a.J(512496784,805,10,"TabbedTaskPane - Exception while updating if draft comment is closed for tabbed flow",aa)}}iSf(){return this.$h&&this.$h.g8&&this.ua.Ba?!Vc.a.taa(this.$h.g8,this.ua.Ba.Cb):!1}Nub(){return this.$h&&this.ua.Ba?!this.$h.g8||Vc.a.taa(this.$h.g8,this.ua.Ba.Cb):!1}Jih(){if(this.Gr&&this.Gr.isIntegratedExtensionEnabled()){const aa=this.il.Qy(),sa=!this.mDa||!this.YGa;aa&&0<aa.length&&(this.CR(!0,!0,sa),this.ukd());this.Nub()&&this.Iih(this.$h)}}crk(){if(this.Gr){this.Iyl();
this.Jih();const aa=this.vKb;aa&&0!==aa.status&&this.SLa(1)}}erk(){this.z1b();const aa=!this.mDa||!(this.h_()&&this.YGa);this.CR(!1,!1,aa)}rrk(aa){this.vAb!==aa&&(this.vAb=aa,this.Kc&&this.Kc.Ic&&this.Kc.Ic.xGh(2,!1,this.vAb))}Pbg(){const aa=Object.assign(new Hk,{paneClosedCallback:Object(za.a)(this,this.crk,"onPaneClosedCallback"),paneOpenedCallback:Object(za.a)(this,this.erk,"onPaneOpenedCallback"),positionsUpdatedScrollHeightCallback:Object(za.a)(this,this.rrk,"onPositionUpdatedScrollHeightCallback")});
aa.allContainersVisibleCallback=Object(za.a)(this,this.Xlk,"onAllContainersVisible");this.Gr=floatingContainerManager.FactoryGlobal.createFloatingContainerManagerInstance(aa)}NDj(){this.XCk&&this.sbk.execute(aa=>{const sa=sharedComments.RichContentEditAPIFactoryGlobal.getRichContentEditAPI();sa?sa.registerSafelinksNavigator(Object(za.a)(aa,aa.Fsd,"tryNavigate")):wb.a.J(512496783,805,15,"SharedCommentFrame:InitializeRichContentEditAPI consumerAPI is null. Created successfully:{0}")})}vBj(){this.Pbg();
this.CR(!0,!1,!0);this.ere=!0;const aa=this.A4b();Kc.a.Ijd(aa,[Mb.a.contextMenu]);if(this.Gr){this.Gr.setDhcContainerPanel(aa,this.uva);var sa=Object.assign(new hj,{width:parseFloat(aa.style.width),height:this.Qlb,x:0,y:0});this.Gr.updateViewport(sa);this.Gr.setCompactContainers(this.yub)}this.ukd();this.hE.xok(this.ua.$j);sa=this.Fa.Gc(Ld.a.oW);sa.zL=!0;sa.k1a=!0;sa.Uba(Oa=>{this.kjc(!0,!Oa||Oa.name!==Ld.a.uz,!0)});sa.xBa((Oa,ib)=>{Oa=(ib.name===Ld.a.VO||ib.name===Ld.a.iaa)&&Oa.name===Ld.a.oW;this.kjc(!1,
!1,ib.name===Ld.a.Hp||ib.name===Ld.a.rg||ib.name===Ld.a.uz||ib.name===Ld.a.oW||this.I_b&&ib.name===Ld.a.EM||Oa)});this.Fa.iWc(Ld.a.oW,Ld.a.nj,aa);this.bgh();this.ia.ya(ic.a.W5,jb.a.frame,Object(za.a)(this,this.W5,"showHideComments"))}ukd(){const aa=this.il.Qy();this.Fih(aa)}bgh(){if(this.Gr){const aa=this.A4b();if(aa){const sa=this.Fa.Gc(Ld.a.oW);this.Yc.nJb(Mb.a.click,aa,Object(za.a)(this,this.nGb,"onCommentPaneParentDivClick"),null,sa.k1a)}}}YEh(){if(this.Gr){const aa=this.A4b();aa&&this.Yc.yb(Mb.a.click,
aa,Object(za.a)(this,this.nGb,"onCommentPaneParentDivClick"))}}A4b(){const aa=this.Kc&&this.Kc.Ic?this.Kc.Ic.kca:null;return aa?aa.xa:null}Fih(aa){if(this.Kc.Ic&&this.ere){if(!this.Gr)try{this.Pbg(),wb.a.J(512496782,801,15,"SharedCommentFrame::RenderCommentContainers - m_containerManager is null. Created successfully:{0}",!!this.Gr)}catch(ib){wb.a.J(512496781,801,10,"SharedCommentFrame::RenderCommentContainers - Error creating m_containerManager: {0}",ib);return}var sa=Date.now();if((aa=this.LLf(aa))&&
aa.length){var Oa=this.A4b();Oa.setAttribute(Kf.a.af,"group");if(Oa){this.b4=this.S4i(aa);wb.a.J(512496780,801,50,"SharedCommentFrame::RenderCommentContainers - Content anchor positions: {0}",this.b4.count);if(!this.b4.count&&!this.fUa){this.CR(!1,!1,!0);wb.a.J(512496779,801,50,"SharedCommentFrame::RenderCommentContainers - Time taken:{0} ms",Date.now()-sa);return}this.Gr.setDhcContainerPanel(Oa,this.uva);this.Gr.attachContainers(this.b4.toArray());this.CR(!0,!1,!0)}wb.a.J(512496778,801,50,"SharedCommentFrame::RenderCommentContainers Time taken:{0} ms",
Date.now()-sa)}}}LLf(aa){if(!aa||!aa.length)return aa;const sa=new r.a;for(const Oa of aa)0!==Oa.status?this.KLf(Oa.commentId):sa.add(Oa);return sa.toArray()}hAl(){this.ppe=!1;if(!this.Wn.iwh&&!this.Wn.vW&&this.Kc.Ic){var aa=this.il.Z8a(this.Kc.Ic.Fd);for(const sa of aa)if(0===sa.status){this.selectComment(sa,null,!0,!0,0,0,!1);break}}}tij(){if(!this.Kc||!this.Kc.Ic||!this.Kc.Ic.Fd)return this.Qlb;var aa=this.Kc.Ic.Fd;if(isNaN(aa.Wk))return this.Qlb;aa=aa.Wk;return 0>aa?this.Qlb:aa}mXf(aa){var sa=
this.Wn.l8(aa);aa=aa.pos.Y;sa&&(aa+=sa.fD.y,sa.Kg&&(sa=this.Ea.rs(sa),aa+=sa&&sa.fD?sa.fD.y:0));return this.mCa(0,aa).y}w2e(){if(this.Gr){const aa=this.tij();aa!==this.XDg&&(this.XDg=aa,this.Gr.setSlideHeight(aa))}}Iih(aa){if(aa&&0===aa.pQa){var sa=0;if(this.yub)sa=-this.Qlb,this.w2e();else{const Oa=this.pa.Jp();Oa&&(sa=this.mCa(0,Oa.fD.y).y)}sa=Object.assign(new Hh,{contentId:aa.fC.draftId,containerContentType:0,anchorTop:sa,anchorLeft:0});this.CR(!0,!0,!0);this.Gr.setDhcContainerPanel(this.A4b(),
this.uva);this.Gr.updateDrafting(sa,!0);this.Gr.selectContainer(aa.fC.draftId,!0)}}dWk(aa){if(this.b4){var sa=0,Oa="";if(this.yub){var ib=this.pa.Jp();ib&&(sa=this.mCa(0,ib.fD.y).y);if(ib=this.il.Qy())for(const Gb of ib)Lb.a.Wa(Gb.commentId)||this.mXf(Gb)!==sa||(Oa=Gb.commentId)}sa=Object.assign(new Hh,{contentId:aa,containerContentType:0,anchorTop:sa,anchorLeft:0});this.yub?this.Gr.updateDraftingAndPosition(sa,!1,Oa):this.Gr.updateDrafting(sa,!1);this.Gr.selectContainer(aa,!0)}}KLf(aa){if(this.Gr&&
this.b4){for(let sa of this.b4)ii.KXg(sa,aa)&&(this.Gr.detachContainers([sa]),this.b4.remove(sa));this.h_()||this.fUa||this.CR(!1,!1,!0)}}f5k(){this.ppe=!0}LNc(){this.I_b&&this.zm&&this.zm.isVisible&&this.zm.W1k()}QTi(){var aa=this.ua.presentation;if(!aa)return!1;aa=aa.slides;if(!aa)return!1;for(const sa of aa)if(aa=Object(lb.a)(db.a,sa))for(const Oa of this.il.eta(aa.SD()))if(Pd.xN(Oa))return!0;return!1}R8d(aa){var sa=this.ua.presentation;if(!sa)return null;sa=sa.slides;if(!sa)return null;for(const Oa of sa)if(sa=
Object(lb.a)(db.a,Oa),Vc.a.taa(sa.Cb,aa))return sa;return null}ITi(){return this.KUd||this.Tui&&this.QTi()}p5f(){const aa=this.pa.Pa.mb,sa=this.pa.Pa.g6;if(!aa||!sa)return null;var Oa=Object(lb.a)(5,aa.Ua.node),ib=Object(lb.a)(5,sa.Ua.node);if(!Oa||!ib)return null;Oa=Object(lb.a)(Id.TableCellNode,Oa.dL());ib=Object(lb.a)(Id.TableCellNode,ib.dL());return Oa&&ib?Oa.rowIndex>ib.rowIndex?aa:sa:null}Ckj(){if(!this.ITi()||!this.pa.O8())return null;wb.a.J(512496777,805,50,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Begin.");
var aa=0,sa=0;if(this.pa.Pa.Gl){var Oa=this.p5f();if(!Oa)return wb.a.J(512496776,805,15,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Failed, table cell selection is null."),null;var ib=Oa}else ib=this.pa.Pa.mb;if(!ib)return wb.a.J(512496775,805,15,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Failed, current selection is null."),null;const Gb=({eLa:aa,cDa:sa}=Pd.Bkj(this.pa.m_(),ib,aa,sa)).returnValue;if(!Gb||0>aa||0>sa||0>=sa-aa)return wb.a.J(512496774,805,15,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Failed, invalid text anchor ParagraphNode is null:{0}, EndPos:{1}, StartPos:{2}.",
!Gb,sa,aa),null;Oa=new dc.a;Oa.StartPos=aa;Oa.EndPos=sa;if(this.pa.JUa()&&Gb.get_smartArtModelId()){wb.a.J(512496773,805,50,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Text selection in SmartArt.");Oa.AnchoringShape=new Rj.a;aa=O.a.Hf(Gb.get_smartArtModelId()).toString();if(!aa||!O.a.isValid(aa))return wb.a.J(512496772,805,15,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Failed, Smart Art node ID string is null:{0} or invalid.",!aa),null;Oa.AnchoringShape.SmartArtNodeId=aa;
this.hE.y2j()}else if(Gb.ys()){wb.a.J(512496771,805,50,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Text selection in table.");sa=Object(lb.a)(Id.TableCellNode,Gb.dL());if(!sa)return wb.a.J(512496770,805,15,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Failed, table cell node is null."),null;aa=sa.rowId.toString();sa=sa.cellId.toString();if(!(aa&&sa&&O.a.isValid(aa)&&O.a.isValid(sa)))return wb.a.J(512496769,805,15,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Failed, Row/Col ID string is null:{0}/{1} or invalid.",
!aa,!sa),null;Oa.AnchoringShape=new Rj.a;Oa.AnchoringShape.TableCell=new Kb;Oa.AnchoringShape.TableCell.RowId=aa;Oa.AnchoringShape.TableCell.ColId=sa;this.hE.z2j()}aa=Object(lb.a)(5,ib.Ua.node);ib=Object(lb.a)(5,ib.Ye.node);aa!==ib&&this.hE.B2j();wb.a.J(512496768,805,50,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Succeeded.");return Oa}uKi(aa){if(this.Gr&&aa){for(const sa of this.b4.toArray()){let Oa=!1;for(const ib of aa)if(ii.KXg(sa,ib.commentId)){Oa=!0;break}Oa||(this.Gr.detachContainers([sa]),
this.b4.remove(sa),wb.a.J(512496739,801,50,"SharedCommentFrame::DetachDeletedCommentContainers {0}",sa.contentId))}this.h_()||this.fUa||this.CR(!1,!1,!0)}}z1b(){if(this.Gr){for(const aa of this.b4.toArray())this.Gr.detachContainers([aa]);this.b4.clear()}this.h_()||this.fUa||(this.mDa&&!this.YGa?this.CR(!1,!1,!1):this.CR(!1,!1,!0))}MXe(aa){if(!aa)return null;aa.sort((sa,Oa)=>{var ib=this.Wn.l8(sa);ib=ib?ib.fD:new Lc.a(0,0);var Gb=this.Wn.l8(Oa);Gb=Gb?Gb.fD:new Lc.a(0,0);ib.y+=sa.pos.Y;Gb.y+=Oa.pos.Y;
ib.x+=sa.pos.X;Gb.x+=Oa.pos.X;let Bb=ib.y-Gb.y;Bb||(Bb=ib.x-Gb.x)||(Bb=+sa.dt-+Oa.dt);return Bb});return aa}S4i(aa){const sa=new r.a;if(aa){this.yub&&this.w2e();for(const Oa of aa)Lb.a.Wa(Oa.commentId)||(aa=this.mXf(Oa),aa=Object.assign(new Hh,{contentId:Oa.commentId,containerContentType:0,anchorTop:aa,anchorLeft:0}),sa.add(aa))}return sa}gY(aa){this.J3g(aa)}Hgh(aa,sa){for(let Oa=0;Oa<aa.Ra.length;Oa++){const ib=aa.Ra.ga(Oa);if(!ib.zg)continue;const Gb=[];for(let Bb=0;Bb<ib.zg.length;Bb++){const Cc=
ib.zg.ga(Bb);Cc.nI.equals(sa)&&Gb.push(Cc)}if(!(1>Gb.length))try{aa.Joa=!0;for(const Bb of Gb)ib.zg.remove(Bb)}catch(Bb){wb.a.J(512496738,805,10,"SharedCommentFrame::RemoveCommentRange - Exception{0} when trying to remove start/end comment GUIDs",Bb.toString())}finally{aa.Joa=!1}}}eqf(aa,sa,Oa){aa.zg||(aa.zg=new Bg.a(aa));const ib=aa.zg.Ee.paragraph;sa=new yh.a(aa.zg.Ee,null,sa,Oa);aa.zg.add(sa);ib.Yu()}FKc(aa){return Jb.a.Hf("{"+aa+"}{1}")}CXb(aa,sa,Oa,ib){let Gb=null;for(let Bb=0;Bb<aa.Ra.length;Bb++){let Cc=
aa.Ra.ga(Bb);if(Cc.cp>=Oa){try{aa.Joa=!0;if(Cc.cp>Oa||!Cc.formatting)this.cJ.Zfa(aa,Bb,Oa,Gb),Cc=aa.Ra.ga(Bb);this.eqf(Cc,sa,ib)}catch(cc){wb.a.J(512496737,805,10,"SharedCommentFrame::AddCommentRange - Exception{0} when trying to add start/end comment GUIDs",cc.toString())}finally{aa.Joa=!1}return}Cc.formatting&&(Gb=Cc.formatting)}if(vb.ParagraphReader.textLength(aa)>=Oa)try{aa.Joa=!0;this.cJ.Zfa(aa,aa.Ra.length,Oa,Gb);const Bb=aa.Ra.ga(aa.Ra.length-1);this.eqf(Bb,sa,ib)}catch(Bb){wb.a.J(512496736,
805,10,"SharedCommentFrame::AddCommentRange - Exception{0} when trying to add start/end comment GUIDs",Bb.toString())}finally{aa.Joa=!1}}j2b(){var aa=this.il.Qy();if(aa){var sa=Date.now(),Oa=!1,ib=new La.a;for(var Gb of aa){var Bb=Pd.W5b(Gb,this.Wn.l8(Gb));ib.$(Gb.commentId,Bb)}for(var Cc of aa)if(Cc.textAnchoringInfo&&(Gb=this.Wn.l8(Cc))&&(Bb=ib.ga(Cc.commentId),!Bb||!Bb.isValid||Bb.Qkg(Cc.textAnchoringInfo)))for(var cc of Gb.WD())this.Hgh(Object(lb.a)(Xb.AParagraphNode,cc),this.FKc(Cc.commentId));
for(const Qd of aa)if((aa=ib.ga(Qd.commentId))&&aa.isValid&&aa.Qkg(Qd.textAnchoringInfo)&&(this.zm.isVisible||0===Qd.status)){Oa=this.FKc(Qd.commentId);this.CXb(aa.ZU,Oa,aa.startPos,!0);if(aa.k$b)for(Cc=1;Cc<aa.paragraphs.length;Cc++){if(cc=aa.paragraphs[Cc])this.CXb(cc,Oa,0,!0),aa.d3.equals(cc)?this.CXb(aa.d3,Oa,aa.endPos,!1):this.CXb(cc,Oa,vb.ParagraphReader.textLength(cc),!1)}else this.CXb(aa.d3,Oa,aa.endPos,!1);aa.dGj();Oa=!0}Oa&&wb.a.J(512496735,805,100,"SharedCommentFrame::EditCommentParagraphMarkers - time taken:{0} ms",
Date.now()-sa)}}A6g(aa,sa){if((aa=this.il.dta(sa.node))&&(sa.property===ee.a.gsc||sa.property===ee.a.fsc||sa.property===ee.a.rrd||sa.property===ee.a.srd)){const Oa=Pd.xN(aa);Oa&&this.j2b();!aa.textAnchoringInfo||Oa||sa.property!==ee.a.srd&&sa.property!==ee.a.rrd||this.hE.A2j(aa,this.FKc(aa.commentId),this.Wn.l8(aa),this.Kc.Ic.Ma)}}yPf(){this.$h&&this.k$&&(this.W_.ASe(this.k$.length,this.Ldb,this.Po,this.qpe.n0c),this.W_.ESe(Array.clone(this.k$),Array.clone(this.Peb)),this.lCf(2))}jTj(aa,sa){sa=this.Pb.Nc(sa);
for(var Oa=sa.Bb(2);Oa;Oa=sa.Af(2))if((Oa=Object(lb.a)(115,Oa))&&Vc.a.taa(Oa.Cb,aa))return!0;return!1}uB(aa,sa){sa&&(aa=Object(lb.a)(388,sa.node),sa=sa.RZ,aa&&2===sa&&((sa=this.PX.Cf)&&sa.slides&&0>=sa.slides.length&&this.zm.isVisible&&this.inc(!1,!1),this.$h&&(sa=this.$h.g8,!sa&&this.ua.Ba&&(sa=this.ua.Ba.Cb),this.jTj(sa,aa)||this.yPf())))}C1g(aa,sa){if((aa=this.il.dta(sa.node))&&Pd.xN(aa)&&(sa=this.Wn.l8(aa)))for(const Oa of sa.WD())this.Hgh(Object(lb.a)(Xb.AParagraphNode,Oa),this.FKc(aa.commentId))}z5g(aa,
sa){(aa=Object(lb.a)(4,sa.node))&&0<aa.WD().length&&(sa.sdg&192||sa.sdg&4)&&this.j2b()}Ljc(aa,sa){aa=sa.property;sa=sa.node;if(aa===ig.a.qy||aa===ig.a.ry)if(aa=this.il.Qy()){for(const Oa of aa)Oa.pos.Y=sa.fD.y,Oa.pos.X=sa.fD.x;this.ukd()}}Yed(){wb.a.J(512496734,805,this.e$a?15:50,"SharedCommentFrame::OnSessionExpired - HasActiveDraft:{0}",this.e$a)}Zwa(aa,sa){wb.a.J(512496733,805,this.e$a?15:50,"SharedCommentFrame::OnSessionEnded - SessionEndedReason:{0};HasActiveDraft:{1}",Ij.a[sa.fG],this.e$a)}dispose(){this.kn&&
(this.kn.dispose(),this.kn=null);this.YCb&&(this.YCb.dispose(),this.YCb=null);this.oy.Ihh(Object(za.a)(this,this.QIa,"onBeforeSlideSwitched"));this.oy.Una(Object(za.a)(this,this.s2e,"updateCommentsWhenNavigateSlide"));this.oy.AJb(Object(za.a)(this,this.Kpf,"activeSlideDOMDisplayed"));this.Lq.wUk(Object(za.a)(this,this.z4g,"onPageViewZoomChanged"));this.zs.rih(Object(za.a)(this,this.onShapeSelected,"onShapeSelected"));this.zs.KUk(Object(za.a)(this,this.v5g,"onShapeDeselected"));this.oy.okd(Object(za.a)(this,
this.G5g,"onShapeTextSelected"));this.oy.sPe(Object(za.a)(this,this.KYa,"onSlideBackgroundClicked"));this.Meb.Cm(Object(za.a)(this,this.Ljc,"onShapePropertyChange"));this.Meb.tUk(Object(za.a)(this,this.z5g,"onShapeInvalidation"));this.Lc.gTk(Object(za.a)(this,this.L2g,"onF6FocusDocument"));this.Lc.lPe(Object(za.a)(this,this.zgb,"onSetFocus"));this.A8b&&this.P4.execute(aa=>{aa.uPe(this.MYa)});this.iad.Cm(Object(za.a)(this,this.A6g,"onTextAnchorPropertyChanged"));this.mGg.ZO(Object(za.a)(this,this.uB,
"onChildTopologyChanged"));this.iad.ZJa(Object(za.a)(this,this.C1g,"onBeforeTextAnchorDisconnect"));this.Qb.wY(Object(za.a)(this,this.j1g,"onAppModeSwitched"));this.N2c.oih(Object(za.a)(this,this.Yed,"onSessionExpired"));this.N2c.baa(Object(za.a)(this,this.Zwa,"onSessionEnded"));this.Qb.CJb(Object(za.a)(this,this.gY,"onSetOffline"));this.nH||this.Yc.yb(Mb.a.click,this.tDb,Object(za.a)(this,this.nGb,"onCommentPaneParentDivClick"));this.YEh();this.uO=this.tDb=null;this.lq.Inc(Object(za.a)(this,this.$ed,
"onShapeViewElementAddedOrRemoved"));this.lq.PUk(Object(za.a)(this,this.$ed,"onShapeViewElementAddedOrRemoved"));this.pa.Nxa(Object(za.a)(this,this.yH,"onSelectionChanged"))}get isReadOnly(){return this.Po}get fUa(){return!!this.$h}get hasFocus(){return this.tre}BAi(){const aa=new Yj.a;var sa=new Cd(ic.a.OTa,Ic.a.application);sa.preCallback=Object(za.a)(this,this.PIc,"claimFocus");sa.postCallback=Object(za.a)(this,this.DMf,"disableOnEmptyDeckAndReadOnly");aa.$(0,sa);sa=new Cd(ic.a.deleteComment,Ic.a.application);
sa.preCallback=Object(za.a)(this,this.PIc,"claimFocus");sa.postCallback=Object(za.a)(this,this.DMf,"disableOnEmptyDeckAndReadOnly");aa.$(3,sa);sa=new Cd(ic.a.pKe,Ic.a.application);sa.preCallback=Object(za.a)(this,this.PIc,"claimFocus");sa.postCallback=Object(za.a)(this,this.O$g,"postCommentAction");aa.$(2,sa);sa=new Cd(ic.a.KDe,Ic.a.application);sa.preCallback=Object(za.a)(this,this.PIc,"claimFocus");sa.postCallback=Object(za.a)(this,this.O$g,"postCommentAction");aa.$(1,sa);sa=new Cd(Ib.a.zNb,Ic.a.application);
sa.preCallback=Object(za.a)(this,this.$fl,"showHideActionPreCallback");sa.postCallback=Object(za.a)(this,this.Zfl,"showHideActionPostCallback");sa.delayActionsUntilRegistration=this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",!1)&&bd.a("DelayCommentsShowHideAction");aa.$(6,sa);return aa}$fl(aa,sa,Oa,ib,Gb){if(1===Oa)return!this.ua.Ba||this.isDisabled?8:2;wb.a.J(36983504,805,50,"New Comment Pane opened.");this.zm.bgb(!!Gb&&Gb.AutoShowHide);return 2}Zfl(aa,sa,Oa,ib,
Gb,Bb){if(1===ib)return aa&&this.hE.ank(this.ua.$j),aa?32:8;this.vtf(this.zm.isVisible,!!Bb&&Bb.AutoShowHide);return aa?32:8}PIc(aa,sa,Oa,ib,Gb){if(1===Oa&&this.pa.ZTa())return 8;1!==Oa&&((this.Hcc=!!Gb&&Gb.ShouldCanvasTakeFocus)||this.xsa(),this.pa.Vx(),this.Lre=!0);return 2}O$g(aa,sa,Oa,ib){if(1===ib&&(this.AWa||!this.k$))return 8;this.Hcc=!1;return aa?32:8}DMf(aa,sa,Oa,ib){return(1!==ib||!this.Po&&this.k$)&&this.Kc.Ic?aa?32:8:8}mCa(aa,sa){return new Lc.a(this.c8c.Me(aa,0),this.c8c.Me(sa,1))}HGf(aa,
sa){return new Lc.a(this.c8c.rf(aa,0),this.c8c.rf(sa,1))}Ovb(aa){aa=this.il.ODa(aa);return this.il.dta(aa)}Kfa(aa,sa,Oa){!this.iSf()||aa!==this.$h.fC.draftId&&aa!==this.$h.commentId?this.Nub()&&aa===this.$h.fC.draftId?(this.W_.selectComment(aa),this.Gr&&this.Gr.selectContainer(aa,!0),this.dSf&&!this.hasFocus&&1!==sa&&this.xsa()):this.selectComment(this.Ovb(aa),null,!0,!0,0,sa,Oa):(aa=this.R8d(this.$h.g8),aa)?1!==sa&&(this.$h.TZc=!0,this.Ga.Ks?this.iAe.xU(aa.oe):this.Ie.xU(aa.oe)):(wb.a.J(512496732,
805,10,"SharedCommentFrame::SelectCommentId - InvalidCommentDataState - slide for extended draft not found"),this.endCommentSession(this.$h.fC.draftId,0))}selectComment(aa,sa,Oa,ib,Gb,Bb,Cc){this.pa.Vx();sa=this.vKb?this.vKb.commentId:null;Cc||this.LNc();0!==Bb?aa?this.W_.selectComment(aa.commentId):this.W_.selectComment(null):0===Bb&&(Bb=this.Wn.l8(aa))&&Bb.KK&&this.Wn.Hmd(Ia[Bb.KK]);this.kn&&this.kn.selectComment(aa,!0);!this.zm.isVisible&&this.Gr&&aa&&aa!==this.wVa&&(Bb=this.il.k8d(aa.commentId))&&
(Bb=this.il.dta(Bb),this.Gr.selectContainer(Bb.commentId,!this.Hcc&&!Cc&&!this.Lre),this.Lre=!1,this.Kc&&this.Kc.Ic&&this.Kc.Ic.ztd(5,!1,this.vAb));Cc||this.Hcc||this.xsa();!this.Wn||!this.zm.isVisible&&this.zm.isVisible||(this.Wn.lSe(aa,sa,!0,!1,Cc),Pd.xN(aa)&&!Cc&&this.j2b());this.Qb.updateCommandUI()}get vKb(){return this.kn&&this.kn.yKb?this.kn.yKb.comment:null}$1k(){if(!this.AWa){const aa=Jd.a.Ik("SelectNextCommentCrossSlide",1),sa=!this.zm.isVisible;this.AWa=!0;this.k4c.h2d((Oa,ib)=>{this.b3g(Oa,
ib,1,aa)},aa,sa)}}c2k(){if(!this.AWa){const aa=Jd.a.Ik("SelectPreviousCommentCrossSlide",1),sa=!this.zm.isVisible;this.AWa=!0;this.k4c.o2d((Oa,ib)=>{this.b3g(Oa,ib,0,aa)},aa,sa)}}b3g(aa,sa,Oa,ib){ib.Wm("FindCommentEndTime",new Date);this.zb.Eb(new Ue.a(2,1,100,()=>{this.AWa&&(this.AWa=!1,this.Tcl(aa,sa,Oa)?this.Kfa(this.$h.commentId||this.$h.fC.draftId,0,!1):sa&&aa&&this.Kc.Ic.Fd?aa.Cb.equals(this.Kc.Ic.Fd.Cb)?(this.selectComment(sa,null,!0,!0,2,1,!1),ib.Va("CircularSelectCommentInSingleSlide",ne[Oa]),
ib.finish()):(this.gGa=Object.assign(new Mg,{slide:aa,comment:sa,direction:Oa,kSe:ib}),this.Ga.Ks?this.iAe.xU(aa.oe):this.Ie.xU(aa.oe)):(this.Qb.updateCommandUI(),ib.Va("NoCommentFound",ne[Oa]),ib.finish()))},90,"47"))}D0f(){let aa=-1;if(!this.$h)return aa;if(this.$h.g8){const sa=this.R8d(this.$h.g8);sa&&(aa=sa.oe)}else this.Kc.Ic&&this.Kc.Ic.Fd&&(aa=this.Kc.Ic.Fd.oe);return aa}Tcl(aa,sa,Oa){if(!this.$h||this.$h.fC.sessionType!==Sb.create)return!1;const ib=this.D0f();if(0>ib)return!1;if(!sa||!aa)return!0;
sa=this.Kc.Ic.Fd.oe;if(1===Oa)return Oa=ib<=sa&&sa<aa.oe,sa=aa.oe<=sa&&sa<ib,ib<=aa.oe&&!Oa||sa;Oa=ib>=sa&&sa>aa.oe;sa=aa.oe>=sa&&sa>ib;return ib>aa.oe&&!Oa||sa}SLa(aa){0!==aa&&this.W_.selectComment(null);this.kn&&this.kn.selectComment(null,!1);if(this.Gr&&(this.Gr.deselectContainer(),this.Kc&&this.Kc.Ic)){let sa=5;const Oa=this.pa.Jp();Oa&&Oa.Rf&&(sa=2);this.Kc.Ic.ztd(sa,!1,this.vAb)}this.Wn&&0!==aa&&(this.Wn.fMc(),this.Wn.ILc());this.Qb.updateCommandUI()}q3h(aa){this.nqb(this.Ovb(aa),0)}nqb(aa,
sa){this.wVa!==aa&&(this.Wn&&(aa?this.Wn.p3h(aa):this.Wn.ILc()),this.wVa=aa,0!==sa&&(this.wVa?this.W_.highlightComment(this.wVa.commentId):this.W_.highlightComment(null)),this.kn&&this.kn.nqb(this.wVa,!0))}Y1k(){if(this.p1b){var aa=this.Ovb(this.p1b),sa=this.Kc.Ic.Fd.sid,Oa=sa===parseInt(this.gYd);aa?(1!==aa.status&&2!==aa.status||this.gpd(),this.selectComment(aa,null,!0,!0,0,1,!1),this.hE.ynk(this.ua.$j),wb.a.J(512496730,804,15,"Deep link - Comment successfully found.  CommentId: {0}; DeepLinkedSlideId: {1};",
this.p1b,this.gYd)):(Oa&&this.Qd.us(Object.assign(new nb.a,{Code:389,Source:4}),this.Xa.podSessionId),wb.a.J(512496731,804,15,"Deep link - Comment not found. CommentId: {0}; DeepLinkedSlideId: {1}; CurrentSlideId: {2}",this.p1b,this.gYd,parseInt(sa)))}}get manager(){return this.il}get JS(){return"per"}get JXg(){return this.uO}set JXg(aa){this.uO=aa;this.kn&&(this.kn.parentElement=aa)}get i_g(){return this.Sec}set i_g(aa){this.Sec=aa}Cjd(aa){this.gJb(aa,void 0,!0)}zU(aa,sa){sa=!bd.a("FixAltF12KeboardingInCommentPane")||
sa;this.kjc(aa,sa,!0)}fOe(){!this.nH&&this.zm&&(this.tDb.style.display=this.zm.isVisible?"flex":"none");this.kn&&(this.kn.setVisibility(this.Bcb),this.kn.Suh(this.Dcb),this.Wn.Ytb(this.wVa))}inc(aa,sa){this.RDh(aa,sa);this.fOe();this.vtf(aa,sa)}z4g(){this.kn&&!this.Ecc&&this.kn.T2e();this.ukd();this.yub&&this.w2e()}Sah(){this.AWa=!1;this.QPf();this.kn&&this.kn.DOe();this.dEb=!1;this.YEh()}QPf(){this.il.iFh()}QIa(){this.YGa=this.h_()||this.Nub();this.Wn&&this.YGa&&(this.Wn.fMc(),this.Wn.ILc());this.r1d&&
(this.Sah(),this.axf())}wdl(){return this.$h&&this.$h.g8&&this.ua.Ba?this.$h.TZc&&Vc.a.taa(this.$h.g8,this.ua.Ba.Cb):!1}s2e(){this.r1d||this.Sah();this.ua.Ba||this.QIa(this,null);this.QPf();this.Kc.Ic&&(this.JXg=this.Kc.Ic.GUd);const aa=this.Kc&&this.Kc.Ic?this.il.Z8a(this.Kc.Ic.Fd):this.il.Qy(),sa=this.h$i(aa),Oa=this.h_()||this.Nub();this.Q8c||Oa||(this.Hk.K$(this.Hk.USd,this.Hk.JUd),this.Q8c=!0);this.zm.isVisible||(Oa?(this.z1b(),this.Jih()):this.h_()?(this.z1b(),this.CR(!0,!1,!0)):this.mDa&&!this.YGa?
this.CR(!1,!1,!1):this.CR(!1,!1,!0),this.bgh());this.gJb(aa,e.AFrameworkApplication.isRtl,!1,sa);this.wdl()?(this.Kfa(this.$h.commentId||this.$h.fC.draftId,0,!1),this.$h.TZc=!1):-1<sa&&this.Kfa(aa[sa].commentId,0,!1);this.gGa&&(this.gGa.kSe.finish(),this.gGa=null);this.c1a(!1);-1!==sa&&this.kn&&(this.kn.nqb(null,!1),this.kn.selectComment(aa[sa],!1));this.r1d||this.axf()}Kpf(){if(this.Fze){try{this.Ybb.bhl(this.VQg,this.ua,this.Ie)}catch(aa){wb.a.J(512496729,805,10,"ActiveSlideDOMDisplayed - Exception while attempting to show resolved comment callout: {0}",
aa)}this.Fze=!1}}c1a(aa){const sa=this.D0f();this.qpe.c1a(aa,sa)}byl(aa){this.$h&&!this.$h.g8&&(this.$h.g8=aa)}onShapeSelected(aa,sa){this.rOc&&(aa=sa.shapeNode,this.fVe(aa),aa&&0<aa.WD().length&&this.j2b())}G5g(aa,sa){this.rOc&&(this.fVe(sa.Gw.shapeNode),this.j2b())}yH(aa,sa){if(sa&&sa.ll&&this.pa.O8()&&(aa=this.il.Qy())){sa=!1;for(var Oa of aa)if(Pd.xN(Oa)){sa=!0;break}sa&&((Oa=this.pa.m_())?this.fVe(Oa):wb.a.J(512496728,805,10,"SharedCommentFrame::OnSelectionChanged - Text selection exists but associated shape is null."))}}fVe(aa){aa.get_shapeId()&&
(this.Wn&&aa!==this.Wn.vW&&this.SLa(1),this.Fnh(aa.get_shapeId(),!0))}Fnh(aa,sa){var Oa=this.il.Qy();if(Oa){var ib=null,Gb=null,Bb=0,Cc=null;for(const cc of Oa)if((this.zm.isVisible||0===cc.status)&&cc.anchorShape===aa)if(this.pa.O8()&&Pd.xN(cc)){Oa=this.pa.Pa.mb.Ua;const Qd=this.pa.Pa.mb.Ye,re=Pd.W5b(cc,this.Wn.l8(cc));re&&re.isValid?(this.vKb&&this.vKb.commentId===cc.commentId||re.urd===cc.textAnchoringInfo.TextBodyLength)&&re.EJj(Oa,Qd)&&(Gb?(Oa=re.Ceh,Oa<Bb&&(Gb=cc,Bb=Oa)):(Gb=cc,Bb=re.Ceh)):
(ib=cc,wb.a.J(512496727,805,10,"SharedCommentFrame::SelectCommentWithShapeId - Comment anchor shape paragraph is null."))}else Gb||Cc||Pd.xN(cc)||(Cc=cc);Gb?this.Kfa(Gb.commentId,1,sa):Cc?this.Kfa(Cc.commentId,1,sa):this.pa.O8()&&!ib?this.Wn&&this.SLa(1):ib&&this.Kfa(ib.commentId,1,sa)}}v5g(){if(this.rOc){var aa=this.Z4d();this.Wn.Hmd(String.format(ResourceStrings.L_CommentAnchoringSlideActiveCommentCount,aa.toString()));this.SLa(1)}}Z4d(){const aa=this.il.Qy();let sa=[];aa&&(sa=Od.e(aa,Oa=>0===Oa.status));
return sa.length}KYa(){this.rOc&&this.SLa(1)}L2g(aa,sa){sa.Zfb===Ld.a.rg&&this.Wn.Hmd(ResourceStrings.l_SlidePanel+", "+String.format(ResourceStrings.L_CommentAnchoringSlideActiveCommentCount,this.Z4d().toString()));sa.YHb===Ld.a.rg&&this.SLa(1)}zgb(aa,sa){this.dSf&&sa.Zfb!==Ld.a.oW&&(sa.YHb===Ld.a.oW||Ld.a.uz)&&this.e$a&&this.SLa(1)}h$i(aa){let sa=-1;if(this.gGa&&this.Kc.Ic)if(this.gGa.slide!==this.Kc.Ic.Fd)wb.a.J(512496726,805,50,"GetIndexOfCommentToSelect() - Active slide doesn't match expected slide in select context");
else if(aa&&0<aa.length){if(this.zm.isVisible)sa=1===this.gGa.direction?0:aa.length-1;else if(1===this.gGa.direction)for(var Oa=0;Oa<aa.length;Oa++){if(0===aa[Oa].status){sa=Oa;break}}else for(Oa=aa.length-1;0<=Oa;Oa--)if(0===aa[Oa].status){sa=Oa;break}0<=sa&&sa<aa.length&&(aa=aa[sa],Oa=this.gGa.comment,Oa.dt===aa.dt&&Oa.commentId===aa.commentId&&Oa.authorName===aa.authorName||wb.a.J(512496725,805,15,"GetIndexOfCommentToSelect() - Expected comment doesn't exist in active slide"))}return sa}Y1g(){this.il.f9i()?
this.$h&&(0===this.$h.pQa||1===this.$h.pQa?(this.nSf&&this.gJb(this.il.Qy(),e.AFrameworkApplication.isRtl,!0),0===this.$h.pQa&&(this.R9c=!0)):this.$h&&2===this.$h.pQa&&this.nSf&&this.gJb(this.il.Qy(),e.AFrameworkApplication.isRtl,!0)):this.gJb(this.il.Qy(),e.AFrameworkApplication.isRtl,!0)}get Amd(){const aa=this.pa.Jp();if(aa){const sa=aa.fD;this.uze=new Lc.a(e.AFrameworkApplication.isRtl?sa.x:sa.x+aa.nx,sa.y)}else this.uze=null;return this.uze}get p2k(){if(!this.pa.O8())return null;var aa=Object(lb.a)(5,
this.pa.Pa.mb.Ye.node);if(!aa)return null;const sa=Object(lb.a)(1127,aa.sc(this.Kc.Ic.Ma));if(!sa)return null;var Oa=null,ib=sa.htmlElement.getElementsByClassName("Selected");if(0<ib.length)Oa=ib[ib.length-1];else if(this.pa.Pa.Gl){if(ib=this.p5f())if(ib=Object(lb.a)(5,ib.Ye.node))if(ib!==aa){if(aa=Object(lb.a)(1127,ib.sc(this.Kc.Ic.Ma)))Oa=aa.htmlElement}else Oa=sa.htmlElement}else return null;aa=this.pa.Jp();if(!aa||!Oa)return null;aa=Object(lb.a)(117,aa.sc(this.Kc.Ic.Ma));if(!aa)return null;Oa=
oh.a.ii(Oa);aa=oh.a.ii(aa.qq);if(0>=Oa.width+Oa.height&&0>=aa.width+aa.height)return null;aa=Lc.a.bV(new Lc.a(Oa.x,Oa.y),new Lc.a(aa.x,aa.y));return this.HGf(aa.x+Oa.width-5,aa.y+10)}get anchorNode(){const aa=this.pa.Jp();return this.Wpg=aa?aa:this.Kc.Ic.Fd}RDh(aa,sa){this.zm&&(sa||this.cph(),this.zfb.wrh(aa?3:1),!this.isDisabled&&aa&&bd.a("CommentShimmerBugFix")&&this.sX&&this.sX.isVisible&&(this.sX.Y$f(),this.Qb.bgb(1)),this.CR(!aa,!1,!0),this.zm.yp(!this.isDisabled&&aa,sa),this.zm.isVisible&&(this.Bcb=
!0))}CR(aa,sa,Oa){const ib=this.h_();Oa&&(!ib&&!this.YGa||ib&&this.YGa)&&wb.a.J(512496724,805,50,"Slide Resize and render was called for Navigation between slides without comments or both slides with comments but it was unnecessary.");!this.h_()&&!this.fUa&&aa&&!sa||this.zm.isVisible&&aa&&!sa||this.h_()&&this.sX&&this.sX.isVisible&&!aa&&!sa||!this.Kc.Ic||!(sa=this.Kc.Ic.kca)||(sa.setVisibility(aa),aa=new ij.a(aa),this.oy.udh(aa),Oa?this.Qb.bgb(1):wb.a.J(512496723,805,50,"Slide Resize and render was redundant. Navigation was between both slides without comments or both slides with comments"),
this.Kc.Ic.ztd(5,!1,this.vAb))}$ul(aa){this.zm&&(this.Bcb=!this.isDisabled&&aa,this.Bcb||(this.zfb.wrh(1),this.zm.yp(!1,!1),this.Fa.Bj(Ld.a.Hp,!1)))}pdj(){const aa=new Vh;aa.focusCallback=Object(za.a)(this,this.wPc,"focusFirstPaneElement");return Object.assign(new Kg.a,{title:ResourceStrings.L_Comments,hideHeader:!1,width:parseInt(this.hIl?300:320),contentProps:aa,location:2,onOpen:sa=>{Kc.a.Ijd(sa,[Mb.a.contextMenu]);const Oa=this.Fa.Gc(Ld.a.Hp);this.Yc.nJb(Mb.a.click,sa,Object(za.a)(this,this.nGb,
"onCommentPaneParentDivClick"),null,Oa.k1a)},onClose:sa=>{this.inc(!1,!1);this.Yc.yb(Mb.a.click,sa,Object(za.a)(this,this.nGb,"onCommentPaneParentDivClick"))},isModernPane:!0})}axf(){if(!this.Dvg){var aa=this.il.Qy();aa=!!aa&&0<aa.length;wb.a.J(512496722,805,50,"SharedCommentPane::AutoShowHideCommentsPane hasComments:{0}",aa);aa?this.h_()&&this.CR(!0,!1,!0):(this.z1b(),this.mDa&&!this.YGa?this.CR(!1,!1,!1):this.CR(!1,!1,!0))}}gpd(){this.zm.isVisible||this.ia.processAction(ic.a.W5,2);this.LNc()}Exj(){this.zm.isVisible&&
this.ia.processAction(ic.a.W5,2)}pk(aa){return this.je.pk(aa)}get isDisabled(){const aa=this.PX.Cf;return aa?aa.h$a:!0}grf(){this.a9c||(this.a9c=new Ue.a(0,1,0,Object(za.a)(this,this.YNk,"refreshCommentsTask"),90,"48"),this.zb.Eb(this.a9c))}j1g(aa){this.J3g(1===aa.mode)}J3g(aa){this.Po=aa;this.grf();bd.a("PreventCommentPaneCloseOnReadOnlyChanged")?this.yPf():this.zm.isVisible&&this.Po&&this.Exj()}s7d(){return this.k$?this.k$:[]}g2f(){return this.Peb?this.Peb:[]}get j0g(){return this.Ldb}get vLc(){return this.$h}z0f(aa){const sa=
this.Kc&&this.Kc.Ic?this.il.Z8a(this.Kc.Ic.Fd):this.MXe(this.il.Qy());if(!sa||!sa.length)return 0;let Oa=null;this.Amd&&(Oa=this.mCa(this.Amd.x,this.Amd.y));let ib=-1,Gb=0;for(let Qd=0;Qd<sa.length;Qd++){var Bb=this.Wn.l8(sa[Qd]);if(!Oa&&Bb)break;if(Bb&&Oa){var Cc=Bb.fD.x,cc=Bb.fD.y;Cc+=sa[Qd].pos.X;cc+=sa[Qd].pos.Y;Bb.Kg&&(Bb=this.Ea.rs(Bb),Cc+=Bb&&Bb.fD?Bb.fD.x:0,cc+=Bb&&Bb.fD?Bb.fD.y:0);cc=this.mCa(Cc,cc);Cc=cc.y;cc=cc.x;if(Oa.y<Cc)break;if(Oa.y>Cc||Oa.y===Cc&&Oa.x>=cc)ib=Qd,sa[Qd].Children&&aa&&
(Gb+=sa[Qd].Children.length)}else Bb||(ib=Qd,sa[Qd].Children&&aa&&(Gb+=sa[Qd].Children.length))}return ib+Gb+1}lBj(aa){if(!this.ere)throw wb.a.J(512496721,805,10,"SharedCommentFrame::InitCommentSession - InvalidCommentDataState - floating container not loaded"),u.a.vu(-2130915320);if(this.$h)return wb.a.J(512496720,805,15,"SharedCommentFrame::InitCommentSession - CommentSessionAlreadyActive"),u.a.vu(-2130915319);if(null===aa)throw Error.argumentNull("session");if(!aa.commentId.length&&0!==aa.pQa)return u.a.vu(-2130915327);
this.$h=aa;this.c1a(!0);0===aa.pQa&&(this.SLa(0),this.zm.isVisible||this.Iih(aa));if(this.zm.isVisible||!this.zm.isVisible)this.xsa(),this.BPi();let sa="";aa.fC&&(sa=aa.fC.draftId);wb.a.J(512496719,805,50,"SharedCommentFrame::InitCommentSession - Success; DraftId:{0}",sa);return null}endCommentSession(aa,sa){if(this.$h){if(this.$h.fC&&this.$h.fC.draftId!==aa)throw wb.a.J(512496718,805,10,"SharedCommentFrame::EndCommentSession - InvalidArgument; EndingDraftId:{0}, ActiveDraftId:{1}",aa,this.$h.fC.draftId),
u.a.vu(-2130915327);this.Trg=sa}9!==sa||this.zm.isVisible||this.Fa.bD(Ld.a.rg);this.$h=null;this.Qb.updateCommandUI();if(this.Gr&&!this.zm.isVisible){const Oa=[Object.assign(new Hh,{contentId:aa,containerContentType:0,anchorTop:0,anchorLeft:0})];this.Gr.detachContainers(Oa);this.h_()||this.CR(!1,!1,!0)}this.K9c.Bjg&&this.EMf();wb.a.J(512496717,805,50,"SharedCommentFrame::EndCommentSession - Success; DraftId:{0}; EndReason:{1}",aa,sa)}get Rui(){return this.Trg}P5(){this.xsa()}TLf(aa){if(this.Ga.ka("CommentCopyPasteEnabled")&&
!this.Ybb.sTj)for(const sa of aa)for(const Oa of this.il.eta(sa.SD()))if(1===Oa.status){this.VQg=new Bh(aa,this.il);this.Fze=!0;return}}vb(){1!==this.Lcc.Pia&&(this.ia.ya(ic.a.Bqc,Ic.a.application,Object(za.a)(this,this.W5,"showHideComments")),this.ia.ra(ic.a.nMe,Ic.a.application,Object(za.a)(this,this.LJa,"queryShowHideComments"),97));this.cPf&&(this.ia.ya(ic.a.VQa,Ic.a.application,Object(za.a)(this,this.v1b,"deleteAllComments")),this.ia.ya(ic.a.Qtb,Ic.a.application,Object(za.a)(this,this.v1b,"deleteAllComments")),
this.ia.ya(ic.a.Rtb,Ic.a.application,Object(za.a)(this,this.v1b,"deleteAllComments")));this.ia.ya(ic.a.$Lb,Ic.a.application,Object(za.a)(this,this.W5,"showHideComments"));this.ia.ra(Ib.a.UMe,jb.a.frame,Object(za.a)(this,this.LJa,"queryShowHideComments"),97);this.ia.ra(ic.a.LJa,Ic.a.application,Object(za.a)(this,this.LJa,"queryShowHideComments"),97);this.ia.ra(ic.a.OIb,Ic.a.application,Object(za.a)(this,this.LJa,"queryShowHideComments"),97);this.ia.ra(ic.a.Eid,Ic.a.application,Object(za.a)(this,this.LJa,
"queryShowHideComments"),97);this.ia.ya(ic.a.WCe,Ic.a.application,Object(za.a)(this,this.Pcd,"nudgeCommentMarker"));this.ia.ya(ic.a.XCe,Ic.a.application,Object(za.a)(this,this.Pcd,"nudgeCommentMarker"));this.ia.ya(ic.a.YCe,Ic.a.application,Object(za.a)(this,this.Pcd,"nudgeCommentMarker"));this.ia.ya(ic.a.ZCe,Ic.a.application,Object(za.a)(this,this.Pcd,"nudgeCommentMarker"));this.ia.ya(ic.a.yNb,Ic.a.application,Object(za.a)(this,this.yNb,"toggleCommentAnchoringFocus"));this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ActivityFeedIsEnabled",
!1)&&(this.ia.ya(Ib.a.jub,Ic.a.application,Object(za.a)(this,this.jub,"doesCommentExist")),this.ia.ya(Ib.a.D_b,Ic.a.application,Object(za.a)(this,this.D_b,"commentActivitySelected")));this.De()}De(){var aa=this.Fa.Gc(ri.AFrame.nj),sa=this.Fa.Gc(Ld.a.uz);const Oa=this.Fa.Gc(Ld.a.HR);aa.bindAction(Af.KeyInputManager.Na(je.a.zza,1),ic.a.yNb);sa.bindAction(Af.KeyInputManager.Na(je.a.zza,1),ic.a.yNb);Oa.bindAction(Af.KeyInputManager.Na(je.a.zza,1),ic.a.yNb);aa=this.Fa.Gc(Ld.a.Hp);sa=[aa,this.Fa.Gc(ae.a.JD),
this.Fa.Gc(ae.a.J2),this.Fa.Gc(Ld.a.rg),this.Fa.Gc(Ld.a.iQ)];for(const ib of sa)ib.bindAction(Af.KeyInputManager.Na(je.a.Dga,Af.KeyInputManager.Le|(Ab.a.uk?4:1)),ic.a.OTa);aa.bindAction(Af.KeyInputManager.Na(je.a.Aza,1),ic.a.OTa)}gJb(aa,sa,Oa,ib=-1){this.uva=sa;!this.kn&&this.uO&&(this.kn=new hi(this.uO,this,this.YCb,this.uva,this.Bcb),this.Wn.nbd=this.kn);if(aa){ii.X_j(aa);sa=null;this.pa.O8()&&(sa=this.pa.Pa);var Gb=0<aa.length?aa[aa.length-1]:null;if(this.kn){var Bb=this.kn.yKb?this.kn.yKb.comment:
null;const Cc=Bb?Bb.commentId:null;this.kn.isRightToLeft=this.uva;this.kn.Cjd(aa);this.Wn&&(this.h_()||this.Nub())&&(this.Wn.fMc(),this.Wn.ILc());this.kn.selectComment(null,!1);if(this.$h)Bb=this.Ovb(this.$h.commentId),this.Wn&&this.Wn.lSe(Bb,Cc,!1),this.kn.selectComment(Bb,!0);else if(Oa&&Bb){const cc=this.Ovb(Bb.commentId);this.Wn&&(this.zm.isVisible||!cc||1!==cc.status&&2!==cc.status)&&(this.kn.selectComment(Bb,!1),this.Wn.lSe(Bb,Cc,!1,!0))}else this.R9c&&Gb&&(this.Kfa(Gb.commentId,1,!1),this.kn.selectComment(Gb,
!1));this.kn.Suh(this.Dcb);this.Dcb&&this.Wn.Ytb(this.wVa)}this.Ldb=aa.length;aa=this.MXe(aa);this.k$=this.XEg.fsl(aa,this.Po);this.Peb=this.XEg.esl(aa);Oa?(this.c1a(!0),this.W_.coh(Array.clone(this.k$),this.Ldb,Array.clone(this.Peb)),this.R9c&&Gb&&this.W_.selectComment(Gb.commentId)):(Oa=[],this.Nub()&&(Oa=this.z0f(!1),Oa=[Object.assign(new jg,{draftId:this.$h.fC.draftId,insertIndex:0>ib?0:Oa})]),0>ib?this.W_.ASe(this.k$.length,this.Ldb,this.Po,this.qpe.n0c,Oa):this.W_.K2k(this.k$.length,this.Ldb,
ib,this.Po,Oa),this.W_.ESe(Array.clone(this.k$),Array.clone(this.Peb)));if(this.Sec){if(ib=this.Ovb(this.Sec))this.selectComment(ib,null,!0,!0,0,1,!1),this.Sec=null}else sa&&this.pa.ME(sa);aa=this.LLf(aa);this.b4&&aa&&this.b4.count>aa.length&&this.uKi(aa);this.Fih(aa);this.ppe&&this.hAl();this.R9c=!1}else this.W_.ASe(0,0,this.Po,1),this.W_.ESe([],[]),this.Ldb=0,this.kn&&(this.kn.isRightToLeft=this.uva,this.kn.Cjd(null)),this.Peb=this.k$=null,this.RDh(!1,!1),this.z1b()}xsa(){this.I_b&&this.LNc();this.hasFocus?
this.$h&&this.K9c.Bjg&&!this.iSf()&&this.Fa.bD(Ld.a.uz):this.Fa.bD(this.zm.isVisible?Ld.a.Hp:Ld.a.oW)}YNk(){this.a9c=null;this.Y1g()}nGb(){this.xsa();this.pa.Vx();return!1}lCf(aa){if(this.$h){if(!this.$h.fC)throw wb.a.J(512496716,805,10,"CheckDraftConfigurationAndEndCommentSession - InvalidCommentDataState DraftConfiguration is null. EndReason: {0}",aa),u.a.vu(-2130915320);this.endCommentSession(this.$h.fC.draftId,aa)}else wb.a.J(512496715,805,50,"Calling EndCommentSession when there is no currentCommentSession. EndReason: {0}",
aa),this.endCommentSession("",aa)}BPi(){this.dEb=this.Fa.Be.name===(this.zm.isVisible?Ld.a.Hp:Ld.a.oW);this.K9c.qtf(!0)}EMf(){this.K9c.qtf(!1);this.dEb&&(this.Fa.bD(this.zm.isVisible?Ld.a.Hp:Ld.a.oW),this.dEb=!1)}Jrk(aa,sa){if(aa&&aa.name!==Ld.a.Hp&&aa.name!==Ld.a.oW&&sa.name===Ld.a.uz)if(this.zm.isVisible)this.wPc();else if(this.$h){aa="";switch(this.$h.pQa){case 0:aa=this.$h.fC?this.$h.fC.draftId:"";break;case 1:case 2:if(sa=this.il.k8d(this.$h.commentId))aa=this.il.dta(sa).commentId}this.Gr.selectContainer(aa,
!0)}this.dEb=!0}Irk(){this.dEb=!1}wPc(){this.zm.isVisible&&this.zfb.SYi()}kjc(aa,sa,Oa){this.tre=aa;this.Qb.updateCommandUI();(bd.a("FixAltF12KeboardingInCommentPane")||!this.nH)&&this.tre&&sa&&this.wPc();aa||Oa||this.SLa(1)}m1d(aa){var sa=this.ua.presentation;if(!sa)return!1;sa=sa.slides;if(!sa)return!1;for(const Oa of sa)if(sa=Object(lb.a)(db.a,Oa))if(sa=this.il.eta(sa.SD()),aa)for(const ib of sa){if(1===ib.status)return!0}else{if(sa&&0<sa.length)return!0}else wb.a.J(512496714,805,10,"SharedCommentFrame::FPresentationHasComments - slideNode not found");
return!1}uJi(){this.il.VQa();const aa=this.il.Qy();aa&&aa.length?this.Ybb.Duh():this.Ybb.Buh(ResourceStrings.l_DeleteAllCommentsOnSlideCallout)}Pcd(aa,sa,Oa){if(1===Oa)return 32;if(null!==this.Qnh){sa=this.Qnh;switch(aa){case ic.a.WCe:sa.pos.Y+=20;break;case ic.a.XCe:sa.pos.X-=20;break;case ic.a.YCe:sa.pos.X+=20;break;case ic.a.ZCe:sa.pos.Y-=20}this.kn.izl(sa);this.a9j.CBk(sa)}return 32}v1b(aa,sa,Oa){return!this.cPf||this.Po||this.$h&&this.$h.fC?8:1===Oa?this.E6i(aa):this.sJi(aa)}E6i(aa){switch(aa){case ic.a.VQa:return this.il.Qy()&&
this.il.Qy().length?32:8;case ic.a.Qtb:return this.m1d(!1)?32:8;case ic.a.Rtb:return 1!==this.Lcc.Pia&&this.m1d(!0)?32:8;default:return wb.a.J(512496712,805,15,"SharedCommentFrame::GetDeleteAllCommentsState - Unexpected actionId: {0}",aa),2}}sJi(aa){switch(aa){case ic.a.VQa:this.uJi();break;case ic.a.Qtb:this.Ybb.Cuh(this.il,!1);break;case ic.a.Rtb:this.Ybb.Cuh(this.il,!0);break;default:return wb.a.J(512496711,805,15,"SharedCommentFrame::DeleteAllCommentsExecute - Unexpected actionId, cannot execute: {0}",
aa),2}return 32}W5(aa,sa,Oa,ib,Gb){if(1===Oa)return!this.ua.Ba||this.isDisabled?8:32;sa=!this.zm.isVisible;Oa=this.lR.Ci("UserAction",String.format("ShowHideComments: {0}",sa?"ShowPane":"HidePane"));wb.a.J(36983504,805,50,"New Comment Pane opened.");aa===ic.a.$Lb?(this.$ul(!this.Bcb),this.fOe()):aa===ic.a.Bqc?(this.Dcb=!this.Dcb,this.Wn.Pod=this.Dcb,this.fOe()):this.inc(sa,!!Gb&&Gb.AutoShowHide);Oa&&Oa.stop();return 32}pQi(){this.zm.isVisible&&this.Kfa(this.$h.fC.draftId,1,!1)}yNb(){var aa=this.Fa.Be.name;
if(this.$h&&this.$h.fC)return aa===Ld.a.rg?(this.xsa(),bd.a("FixAltF12KeboardingInCommentPane")||bd.a("SelectCommentDuringAlt12ActiveDraftEnable")&&this.pQi()):this.Fa.xf(Ld.a.rg),32;if(this.Wn.iwh||this.Wn.vW){if(aa===Ld.a.rg||aa===Ld.a.HR){var sa=this.Wn.vW;this.zm.isVisible||(aa=0,sa&&(aa=sa.get_shapeId()),this.Fnh(aa,!1));this.xsa();return 32}if(Sc.a.contains(this.vzf,aa)){if((sa=this.vKb)&&Pd.xN(sa)){if(aa=Pd.W5b(sa,this.Wn.vW),aa.isValid){const Oa=[];for(let Gb=0;Gb<aa.paragraphs.length;Gb++){const Bb=
aa.paragraphs[Gb];Bb&&Oa.push(ef.SelectionFactory.V2(Bb,aa.ZU.equals(Bb)?aa.startPos:0,aa.d3.equals(Bb)?aa.endPos:vb.ParagraphReader.textLength(Bb)))}const ib=new yd.SelectionCollection(Oa,0);sa.textAnchoringInfo.AnchoringShape&&sa.textAnchoringInfo.AnchoringShape.SmartArtNodeId?(this.Fa.xf(Ld.a.HR),this.bzg.execute(Gb=>{(Gb=Object(lb.a)(526,Gb.Rd))&&this.bzg.instance.vrh(Object(lb.a)(Kd.a,Gb),ib)})):(this.Fa.xf(Ld.a.rg),this.pa.ME(ib))}}else this.Fa.xf(Ld.a.rg);return 32}}else{if(Sc.a.contains(this.vzf,
aa))this.Fa.xf(Ld.a.rg);else{aa=null;aa=this.Kc&&this.Kc.Ic?this.il.Z8a(this.Kc.Ic.Fd):this.MXe(this.il.Qy());if(!Sc.a.Wa(aa))for(sa of aa)if(this.zm.isVisible||0===sa.status){this.Kfa(sa.commentId,1,!1);break}this.xsa()}return 32}return 8}vtf(aa,sa){aa&&!sa?this.nH?this.LNc():(this.Fa.Bj(Ld.a.Hp,!0),this.xsa(),this.wPc()):sa?aa&&this.Fa.H8(Ld.a.Hp,Ld.a.nj,this.zm,!1):0<this.Z4d()||this.$h&&this.$h.fC?this.Fa.Bj(Ld.a.oW,!0):this.Fa.Bj(Ld.a.Hp,!1);sa||this.cph()}Xlk(){this.Q8c||(this.Hk.L$(this.Hk.USd,
this.Hk.JUd),this.Hk.J$(this.Hk.USd,this.Hk.JUd),this.Q8c=!0,this.hE.Ylk(this.ua.$j));this.sX&&this.sX.FUi()}cph(){const aa=this.il.Qy();aa&&0<aa.length&&(this.Dvg=!0)}h_(){var aa=this.il.Qy();if(!aa||!aa.length)return!1;aa=Od.e(aa,sa=>0===sa.status);return!!aa&&0<aa.length}LJa(aa,sa,Oa,ib,Gb){aa===ic.a.LJa?Gb[Zg.a.On]=this.zm.isVisible:aa===ic.a.OIb||aa===Ib.a.UMe?Gb[gi.a.On]=this.zm.isVisible:aa===ic.a.Eid?Gb[gi.a.On]=this.Bcb:aa===ic.a.nMe&&(Gb[gi.a.On]=this.Dcb);return!this.ua.Ba||this.isDisabled?
16:32}jub(aa,sa,Oa,ib,Gb){return 2!==Oa?32:(aa=this.ZRf(Gb))&&this.findComment(aa)?32:8}D_b(aa,sa,Oa,ib,Gb){return 2!==Oa?32:(aa=this.ZRf(Gb))&&this.Kik(aa)?32:8}ZRf(aa){if(!aa)return null;aa=aa.NavigationId;if(!aa)return null;try{return JSON.parse(aa)}catch(sa){return wb.a.J(512496710,805,10,"ExtractNavParams - Exception while parsing navigation id",sa),null}}Kik(aa){if(aa.sId!==this.Kc.Ic.Fd.sid){var sa=Vc.a.PE(aa.sId,aa.cId);sa=this.R8d(sa);if(!sa)return!1;this.Ga.Ks?this.iAe.xU(sa.oe):this.Ie.xU(sa.oe)}sa=
this.findComment(aa);if(!sa)return!1;1!==sa.status&&2!==sa.status||this.gpd();this.Kfa(aa.commentId,1,!1);return!0}findComment(aa){var sa=this.ua.presentation;if(!sa)return null;sa=sa.slides;if(!sa)return null;for(const Oa of sa)if((sa=Object(lb.a)(db.a,Oa))&&sa.sid===aa.sId){sa=this.il.eta(sa.SD());for(const ib of sa){if(ib.commentId===aa.commentId)return ib;if(ib.Children&&ib.Children.length)for(const Gb of ib.Children)if(Gb.commentId===aa.commentId)return Gb}}return null}isCollapsed(){return!1}get Qnh(){return null}clearSelection(){}gOk(){this.Qb.updateCommandUI()}get e$a(){return!!this.$h}Pri(){this.$h&&
this.lCf(8)}N$(aa){2===aa.behavior&&aa.actionId===ic.a.hZa&&(aa=this.Hv.kRc(!0),aa!==ic.a.lgd&&aa!==ic.a.gQ&&aa!==ic.a.VQa&&aa!==ic.a.Qtb&&aa!==ic.a.Rtb||ed.UISurfaces.CN().then(sa=>{this.Ybb.zRk(sa)}))}M$(){}static KXg(aa,sa){return aa.contentId===sa}static X_j(aa){let sa="";if(aa){for(const Oa of aa)if(sa+=Oa.commentId+";",Oa.Children)for(const ib of Oa.Children)sa+=ib.commentId+";";wb.a.J(512496659,805,15,"LogCommentIds() - {0}",sa)}}}Object(k.a)(ii,"SharedCommentFrame",null,[1223,106,1224,141]);
class Wh{constructor(aa,sa,Oa,ib,Gb,Bb,Cc=null){this.date=this.author=this.commentBody=this.parentId=this.commentId=null;this.commentFlags=0;this.usersByReactionType=null;this.commentId=aa;this.parentId=sa;this.commentBody=Oa;this.author=ib;this.date=Gb;this.commentFlags=Bb;this.usersByReactionType=Cc}}Object(k.a)(Wh,"OfficeSharedCommentModel",null,[]);class Zj{constructor(aa,sa){this.CommentId=aa;this.ResolveState=sa}}Object(k.a)(Zj,"CommentProperties",null,[]);class Hi{constructor(){this.email=
this.fullName="";this.resolveState=0}}Object(k.a)(Hi,"AtMentionAttributes",null,[]);class $i{constructor(){this.contentId=""}}Object(k.a)($i,"AtMentionOptionalAttributes",null,[]);class Ai{constructor(){this.atmention=this.altText=this.lang=null;this.italic=!1;this.link=null;this.underline=this.strikethrough=!1;this.weight=0;this.paragraph=this.color=this.highlight=null}}Object(k.a)(Ai,"DeltaAttributes",null,[]);var si;(function(aa){aa[aa.Undo=-1]="Undo";aa[aa.Unknown=0]="Unknown";aa[aa.Create=1]=
"Create";aa[aa.Assign=2]="Assign";aa[aa.Unassign=3]="Unassign";aa[aa.UnassignAll=4]="UnassignAll";aa[aa.Schedule=5]="Schedule";aa[aa.Progress=6]="Progress";aa[aa.Delete=7]="Delete";aa[aa.Restore=8]="Restore";aa[aa.SetTitle=9]="SetTitle";aa[aa.Priority=10]="Priority"})(si||(si={}));Object(k.b)("HistoryRecordType",si);class Ni{constructor(){this.Id=this.FullName=this.Email=this.DispName=null}}Object(k.a)(Ni,"CommentAtMention",null,[]);var ak=d(892);class Sj{constructor(){this.UserId=this.ProviderId=
this.FullName=this.Email=this.DisplayName=null}}Object(k.a)(Sj,"UserInfo",null,[]);class ti{constructor(aa,sa){this.plainText=aa;this.d_g=sa}}Object(k.a)(ti,"TextTranslationResult",null,[]);var Ii=d(67);class bg{constructor(aa,sa,Oa){this.CYk="[";this.rfi=RegExp("\\<\\@(.*?)\\>|\\[\\@(.*?)\\]");this.xYj=RegExp("(?:https?:\\/\\/|www\\.)[^\\s]+","gi");this.sfi=RegExp("(\\<\\@.*?\\>|\\[\\@.*?\\]|(?:https?:\\/\\/|www\\.)[^\\s]+)","gi");this.Vog=!1;this.n9j="\ud83d\udc4d";this.MGi=ib=>{if(!ib)return null;
let Gb={};for(const Cc of ib)if(Cc.Type==this.n9j){var Bb=Cc.ReactionInstances;ib=[];for(const cc of Bb)Bb=cc.User,ib.push({DateUtc:cc.Time,DisplayName:Bb.DisplayName,Email:Bb.Email,Provider:Bb.ProviderId,UserId:Bb.UserId,IsCurrentUser:!1});Gb["1"]=ib}return Gb};this.Yb=aa;this.Dze=sa;this.Uve=Oa}get userId(){return this.Yb.appSettings["387"]}get providerId(){return this.Yb.appSettings["388"]}$hj(aa,sa){let Oa=0;if(1===aa.status||2===aa.status)Oa|=8;sa&&(Oa|=1);this.pdl(aa)&&(Oa|=16);this.Yb.ka("PPTOBlueDotsForComments")&&
aa.isUnread&&(Oa|=32);return Oa}isCurrentUser(aa){return Lb.a.Wa(aa.userId)?!1:"Author"===aa.userId||this.userId===aa.userId&&this.providerId===aa.providerId?!0:!1}pdl(aa){return""===aa.userId||"Author"===aa.userId||!this.kDl(aa.userId)||this.userId===aa.userId&&this.providerId===aa.providerId?!1:!0}kDl(aa){return 3===aa.split("::").length}dCh(aa,sa,Oa){var ib;if(null===aa)throw Error.argumentNull("comment");const Gb=this.hsl(aa.text);var Bb=aa.authorName,Cc=bd.a("PPTPlumbEmailThroughCG")?Da.a.h8a(aa.userId||
""):"";const cc=aa.dt;Oa=this.$hj(aa,Oa);Bb=new Xa(aa.userId,aa.providerId,Bb,Cc,this.isCurrentUser(aa));return id(this.Yb)&&(null===aa||void 0===aa?0:aa.reactions)?(Cc=this.MGi(null===(ib=aa.reactions)||void 0===ib?void 0:ib.ReactionList),new Wh(aa.commentId,sa,Gb,Bb,cc,Oa,Cc)):new Wh(aa.commentId,sa,Gb,Bb,cc,Oa)}fsl(aa,sa){if(null===aa)throw Error.argumentNull("comments");const Oa=new r.a;for(const ib of aa)if(Oa.add(this.dCh(ib,"",sa)),ib.Children&&0<ib.Children.length)for(const Gb of ib.Children)Oa.add(this.dCh(Gb,
ib.commentId,sa));return Oa.toArray()}lsl(aa,sa,Oa,ib){const Gb=Object.assign(new ak.a,{Asignees:[]});aa=this.Dze.m0i(aa,sa,!sa.taskId,Oa);for(const Bb of aa)2===Bb.type?Bb.assignee?(aa=Object.assign(new Sj,{DisplayName:Bb.assignee.DisplayName,FullName:Bb.assignee.DisplayName,UserId:Bb.assignee.UserId,ProviderId:Bb.assignee.Provider,Email:Bb.assignee.Email}),Gb.Asignees.push(aa)):wb.a.J(512496658,845,10,"TranslateSharedTaskMetadataToTaskInfo - History record type is assign, but Assignee is null."):
9===Bb.type&&(Gb.Title=Bb.title);if(!Gb.Asignees)return wb.a.J(512496657,845,10,"TranslateSharedTaskMetadataToTaskInfo - TaskInfo assignee is null and not set."),null;Gb.Title||(wb.a.J(512496656,845,15,"TranslateSharedTaskMetadataToTaskInfo - TaskInfo title is null and not set."),Gb.Title=ib);return Gb}jsl(aa,sa){const Oa=new ak.a;if(aa.assignee){const ib=new Sj,Gb=aa.assignee;ib.DisplayName=Gb.Name;ib.FullName=Gb.Name;ib.UserId=Gb.UserPrincipalName;ib.ProviderId="O365";ib.Email=Gb.UserPrincipalName;
Oa.Asignees=[ib]}Oa.Title=aa.title?aa.title:sa;return Oa}ksl(aa,sa,Oa){if(!sa)return null;try{const ib=this.osd(Oa,new Date).plainText,Gb=this.Uve?this.lsl(aa,sa,Oa,ib):this.jsl(sa,ib);if(!Gb)return null;Gb.CompletionPercentage=sa.completion?sa.completion:0;return Gb}catch(ib){wb.a.J(512496655,845,10,"TranslateSharedTaskMetadataToTaskInfo - Exception thrown: {0}",ib)}return null}esl(aa){if(null===aa)throw Error.argumentNull("comments");const sa=new r.a;for(const Oa of aa)Oa.taskInfo&&Oa.taskInfo.Asignees&&
0<Oa.taskInfo.Asignees.length&&(aa=this.dsl(Oa))&&sa.add(aa);return sa.toArray()}dsl(aa){if(this.Uve&&this.Dze&&0<aa.taskInfo.TaskHistoryRecords.length)try{const sa=bg.nzi(aa.taskInfo.TaskHistoryRecords),Oa=new Ii.a;Oa.add(aa.commentId,new Zj(aa.commentId,100===aa.taskInfo.CompletionPercentage));const ib=this.Dze.xGi(aa.commentId,aa.commentId,sa,Oa);bg.Rpi(aa,ib,this.Uve);return ib}catch(sa){return wb.a.J(512496654,845,10,"TranslateCommentTaskToSharedCommentTaskItem Failed due to [{0}]",sa.message),
this.cCh(aa)}else return this.cCh(aa)}cCh(aa){var sa=new da;sa.startDate=aa.taskInfo.StartDate;sa.endDate=aa.taskInfo.DueDate;const Oa=new ba(aa.taskInfo.Asignees[0].UserId);Oa.DisplayName=aa.taskInfo.Asignees[0].DisplayName;Oa.Provider=aa.taskInfo.Asignees[0].ProviderId;Oa.Email=aa.taskInfo.Asignees[0].Email;const ib=Array(1);ib[0]=Oa;sa=new fa(!1,aa.taskInfo.Title,ib,sa,aa.taskInfo.CompletionPercentage,0);return new na(aa.commentId,aa.commentId,sa,[])}hsl(aa){if(null===aa)throw Error.argumentNull("nativeText");
const sa=new ya;aa=aa.split(this.sfi);for(const ib of aa){var Oa=this.rfi.exec(ib);Oa&&3===Oa.length?(aa=new Hi,Oa[0].substring(0,1)===this.CYk?(aa.fullName=Oa[2],aa.resolveState=1):(aa.fullName=Oa[1],aa.resolveState=0),aa.email="UnknownEmail",Oa=new $i,Oa.contentId="Pre-existing Mention",sa.DEj("@"+aa.fullName,aa,Oa),this.Vog||(this.Vog=!0,wb.a.J(512496653,845,15,"Rendering mention when AtMentions are disabled."))):(aa=this.xYj.exec(ib))&&1===aa.length?(aa=aa[0],sa.insertHyperLink(aa,Object.assign(new Ai,
{link:aa}))):sa.eFj(ib)}return sa.I6i()}osd(aa,sa){var Oa=Sys.Serialization.JavaScriptSerializer.deserialize(aa);aa=[];sa||(sa=new Date);const ib=new Sys.StringBuilder;for(const Gb of Oa.ops)if(Gb.attributes){if(Gb.attributes.atmention){const Bb=1<Gb.insert.length?Gb.insert.substring(1,Gb.insert.length):"";if(Gb.optional&&Gb.optional.atmention&&Gb.optional.atmention.contentId)Oa=bg.K0f(Bb,1===Gb.attributes.atmention.resolveState);else{Oa=bg.K0f(Bb,1===Gb.attributes.atmention.resolveState);const Cc=
bg.lcj(sa,1===Gb.attributes.atmention.resolveState);Array.add(aa,Object.assign(new Ni,{FullName:Gb.attributes.atmention.fullName,DispName:Bb,Id:Cc,Email:Gb.attributes.atmention.email}));sa=new Date(sa.getTime()+1)}}else Gb.attributes.link||wb.a.J(512496652,845,10,"Unsupported formatting discovered in Delta. Stripping out rich text."),Oa=Gb.insert;ib.append(Oa)}else ib.append(Gb.insert);return new ti(ib.toString(),aa)}static Mzi(aa){switch(aa){case 0:return 0;case 1:return 1;case 2:return 2;case 3:return 3;
case 4:return 4;case 5:return 5;case 6:return 6;case 7:return 10;case 8:return 9;case 9:return-1;default:return 0}}static Jzi(aa){var sa=null;aa.User&&(sa=new ba(aa.User.UserId,aa.User.ProviderId,aa.User.DisplayName));sa=new Y(bg.Mzi(aa.HistoryRecordType),sa,aa.DtTime,aa.RecordId);sa.commentId=aa.CommentId;aa.Assignee&&(sa.assignee=new ba(aa.Assignee.UserId,aa.Assignee.ProviderId,aa.Assignee.DisplayName));aa.StartDate&&aa.DueDate?(sa.schedule=new da,sa.schedule.startDate=aa.StartDate?aa.StartDate:
null,sa.schedule.endDate=aa.DueDate?aa.DueDate:null):aa.StartDate&&!aa.DueDate?wb.a.J(512496651,845,10,"ConvertToOfficeSharedHistoryRecord schedule end date is null but start date is not"):!aa.StartDate&&aa.DueDate&&wb.a.J(512496650,845,10,"ConvertToOfficeSharedHistoryRecord schedule start date is null but end date is not");var Oa=aa.Priority;0<Oa?sa.priority=Oa:wb.a.J(512496649,845,10,"Priority is negative");Oa=aa.CompletionPercentage;0<=Oa?sa.completion=Oa:wb.a.J(512496648,845,10,"Percent complete is negative");
sa.title=aa.Title;sa.undoId=aa.UndoId;return sa}static nzi(aa){const sa=aa.length,Oa=Array(sa);for(let ib=0;ib<sa;++ib)Oa[ib]=bg.Jzi(aa[ib]);return Oa}static Rpi(aa,sa,Oa){const ib=sa.currentState,Gb=aa.taskInfo;let Bb=!1;const Cc=bd.a("SetTaskFromTaskStateInsteadOfHistory");Gb.StartDate.toString()!==ib.schedule.startDate.toString()&&(Cc&&(ib.schedule.startDate=Gb.StartDate),Bb=!0,wb.a.J(512496647,845,10,"Start Date does not match."));Gb.DueDate.toString()!==ib.schedule.endDate.toString()&&(Cc&&(ib.schedule.endDate=
Gb.DueDate),Bb=!0,wb.a.J(512496646,845,10,"End Date does not match."));Gb.CompletionPercentage!==ib.completion&&(Cc&&(ib.completion=Gb.CompletionPercentage),Bb=!0,wb.a.J(512496645,845,10,"Completion percentage does not match."));Gb.Title!==ib.title&&(Cc&&(ib.title=Gb.Title),Bb=!0,wb.a.J(512496644,845,10,"Title does not match."));Gb.Asignees[0].UserId!==ib.assignees[0].UserId&&(Cc&&(ib.assignees[0].UserId=Gb.Asignees[0].UserId),Bb=!0,wb.a.J(512496643,845,10,"Assigned to user id does not match."));
Gb.Asignees[0].DisplayName!==ib.assignees[0].DisplayName&&(Cc&&(ib.assignees[0].DisplayName=Gb.Asignees[0].DisplayName),Bb=!0,wb.a.J(512496642,845,10,"Assigned to display name does not match."));Gb.Asignees[0].ProviderId!==ib.assignees[0].Provider&&(Cc&&(ib.assignees[0].Provider=Gb.Asignees[0].ProviderId),Bb=!0,wb.a.J(512496641,845,10,"Assigned to provider id does not match."));Gb.Asignees[0].Email!==ib.assignees[0].Email&&(Cc&&(ib.assignees[0].Email=Gb.Asignees[0].Email),Oa||(Bb=!0,wb.a.J(512496640,
845,10,"Assigned to email does not match.")));if(Bb&&Oa&&(bg.v2j(aa,sa),bd.a("IsThrowForTaskStateMismatchEnabled")))throw wb.a.J(0,845,10,"There was a mismatch between the state and state as determined by history"),Error.create("TaskStateMismatch");}static v2j(aa,sa){const Oa=new r.a;for(const ib of sa.history)for(const Gb of ib.records)Oa.add(si[Gb.type]);if(Oa.count!==aa.taskInfo.TaskHistoryRecords.length){sa=new r.a;for(const ib of aa.taskInfo.TaskHistoryRecords)sa.add(si[ib.HistoryRecordType]);
wb.a.J(512496611,845,10,"LogTaskHistoryDetailsForMismatch")}}static lcj(aa,sa){aa=aa._toFormattedString("yyyy-MM-ddThh:mm:ss:fff",Sys.CultureInfo.InvariantCulture);return sa?aa+"_Z":aa}static K0f(aa,sa){return sa?"[@"+aa+"]":"<@"+aa+">"}}Object(k.a)(bg,"SharedCommentModelTranslator",null,[1221]);class xa{constructor(aa,sa,Oa){this.wWa=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("PptReactTabbedTaskPanesM2IsEnabled")&&e.AFrameworkApplication.fa.ka("PptReactTabbedTaskPanesF6LoopFixesIsEnabled");
this.Ldf=!1;this.Fa=aa;this.mh=sa;this.ZAb=Oa}qtf(aa){aa?(this.wWa&&this.ZAb&&this.ZAb.isVisible||this.mh.EK(Ld.a.uz),this.mh.Ho(Ld.a.Hp),this.Fa.bD(Ld.a.uz)):(this.mh.Ho(Ld.a.uz),this.ZAb.isVisible&&!this.wWa&&this.mh.EK(Ld.a.Hp));this.Ldf=aa}get Bjg(){return this.Ldf}}Object(k.a)(xa,"SharedCommentsRTEFocusActionHelper",null,[1204]);class Ma{constructor(aa,sa,Oa,ib){this.cancelButton=this.confirmButton=this.body=this.title=null;this.title=aa;this.body=sa;this.confirmButton=Oa;this.cancelButton=ib}}
Object(k.a)(Ma,"ViewContainerModalDialogStrings",null,[]);class $a{constructor(aa,sa,Oa){this.containerType="full-pane";this.identifier=null;this.kb=aa;this.Fa=sa;this.identifier=Oa}closeView(){this.kb.inc(!1,!1)}openView(){this.kb.inc(!0,!1)}invokeModalConfirmationDialog(aa,sa,Oa){const ib=new Qh.StandardDialog;Oa&&Oa.title&&Oa.body&&Oa.confirmButton&&Oa.cancelButton||(wb.a.J(35496838,805,10,"InvokeModalConfirmationDialog: No localized strings provided."),Oa=new Ma("","","",""));ib.xd=1;ib.Xe(1,
Oa.confirmButton);ib.Xe(0,Oa.cancelButton);ib.B7a=this.Fa.Be.name;ib.Nic=!0;ib.Bx(Oa.title,Oa.body,1,Gb=>{1===Gb?(aa(),ib.B7a=null):sa()})}}Object(k.a)($a,"ViewContainerAPI",null,[1215,1216]);class Eb extends Sys.EventArgs{constructor(){super()}}Object(k.a)(Eb,"CommentsPackageLoadedEventArgs",Sys.EventArgs,[]);var ac=d(277);class tc{constructor(){this.rEg=this.zUg=this.zfb=this.sWg=this.Kva=this.C2c=this.MHa=this.E2c=this.TQ=this.K=null;this.zcb=this.fva=this.CBb=!1;this.lR=this.xpe=null;this.oGg=
"6F1926CF-E872-4C4C-9393-3956FCFEB98A";this.gO=null;this.wWa=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("PptReactTabbedTaskPanesM2IsEnabled");this.nH=!1}$b(aa){this.K=aa;this.nH=this.K.resolve("PowerPointWebEditor.IApplicationSettings").NUd;this.lR=this.K.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder");this.zfb=new H(e.AFrameworkApplication.we,"CommentPane");aa.register(Ra,"PowerPointWebEditor.CommentEditor").as("PowerPointWebEditor.ICommentEditor").ma().oa(()=>new Ra);
const sa=this.K.resolve("PowerPointWebEditor.IFileInfo").Pia,Oa=2===sa||3===sa;this.CBb=Oa;this.zcb=1===sa;aa.register(vf,"PowerPointWebEditor.CommentTelemetryManager").as("PowerPointWeb.Comments.ICommentTelemetryManager").ma().oa(()=>new vf(this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("Common.IAppSettingsManager"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.Graph.ICommentReader"),sa));aa.register(qd,"PowerPointWebEditor.CommentManager").as("PowerPointWeb.Comments.ICommentGraphManager").ma().oa(()=>
new qd(this.lR,sa,this.K.resolve("PowerPointWebEditor.ICommentCloudPolicy"),this.K.resolve("PowerPointWebEditor.IClassFactory"),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.Graph.ICommentReader"),this.K.resolve("PowerPointWebEditor.ICommentEditor"),this.K.resolve("Common.IAppSettingsManager"),this.K.resolve("PowerPointWebEditor.Graph.IPptGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),
this.K.resolve("PowerPointWeb.Comments.ICommentTelemetryManager"),this.K.resolve("PowerPoint.IDateHelper"),this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.Ja("PowerPointWebEditor.RevisionTracking.RevisionTrackingManager")));const ib=this.CBb||!this.zcb;this.gO=this.K.resolve("PowerPointWeb.Comments.ICommentGraphManager");ib&&aa.register(255,"PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapeCommentsAnchoredSelectionView>").ma().oa(()=>new ac.a((Qd,re)=>
{let Ca=null;const ob=Object(lb.a)(117,Qd.sc(aa.resolve("Box4.IPageView").Ma));ob&&!ob.Al&&(Qd=aa.resolve("PowerPointWebEditor.ShapePresence.IShapePawnViewFactory").cXd(aa.resolve("PowerPointWebEditor.IPptSelectionManager"),null,Qd,re,ob.RU),Ca=new Ed(Qd),Ca.Im(ob.RU),ob.dra(Ca,5),Ca.visible=ob.yQ||ob.Tn);return Ca}));this.K.register(1201,"PowerPointWeb.Comments.ICommentMarkerAnchorHelper").ma().oa(()=>new Ze(this.gO,this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),
aa.resolve("PowerPointWebEditor.Graph.ITableReader")));this.K.register(1202,"PowerPointWeb.Comments.ICommentMarkerPositionHelper").ma().oa(()=>new md(this.K.resolve("PowerPointWebEditor.View.IPPTPageView").Ld,this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.gO));const Gb=this.CBb||!this.zcb;this.K.register(1203,"PowerPointWeb.Comments.ICommentMarkerViewElementFactory").ma().oa(()=>new If(this.K.resolve("PowerPointWeb.Comments.ICommentMarkerAnchorHelper"),this.K.resolve("PowerPointWeb.Comments.ICommentMarkerPositionHelper"),
new Jc(Gb),this.K.resolve("PowerPointWebEditor.ICommentCloudPolicy"),Gb,Gb));this.K.register(Ub,"PowerPointWebEditor.CommentTextAnchorHighlightActor").ma().oa(()=>new Ub(!this.zcb,this.K.resolve("Common.Utils.IHighContrastDetector")));const Bb=new lf(ib,this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),ib?this.K.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapeCommentsAnchoredSelectionView>"):null,this.gO,this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),
this.K.resolve("PowerPointWebEditor.IAriaManager"),this.K.resolve("PowerPointWeb.Comments.ICommentMarkerAnchorHelper"),this.K.resolve("Box4.Highlight.IHighlightManager"),this.K.resolve("PowerPointWebEditor.CommentTextAnchorHighlightActor"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventNotifier"));aa.register(1204,"PowerPointWebEditor.IRTEFocusActionHelper").ma().oa(()=>new xa(aa.resolve("Common.IFocusManager"),aa.resolve("Common.IF6Manager"),aa.resolve("PowerPointWebEditor.ICommentsPane")));
this.K.register(R,"Common.Comments.OfficeSharedCommentsEventHost").as("Common.Comments.IOfficeSharedCommentsEventHost").ma().oa(()=>new R(this.K.resolve("Common.ITaskManager")));const Cc=this.K.resolve("Common.IAppSettingsManager").ka("TasksHistoryEnabled");Cc&&this.K.register(1205,"Common.Comments.ICommentTaskTranslator").ma().oa(()=>(new Na(!0,Cc,!0)).tBi());this.K.register(bg,"PowerPointWebEditor.SharedCommentModelTranslator").as("PowerPointWeb.Comments.ISharedCommentModelTranslator").ma().oa(()=>
new bg(this.K.resolve("Common.IAppSettingsManager"),Cc?this.K.resolve("Common.Comments.ICommentTaskTranslator"):null,Cc));this.K.register(ua,"Common.Comments.CommentActivationManager").as("Common.Comments.ICommentActivationManager").ma().oa(()=>new ua);this.fva=this.K.resolve("Common.IAppSettingsManager").ka("896")&&(Oa||!this.zcb);this.K.register(ii,"PowerPointWebEditor.SharedCommentFrame").as("PowerPointWeb.Comments.ICommentFrame").as("PowerPointWebEditor.ICommentSessionManager").ma().oa(()=>new ii(this.gO,
this.K.resolve("PowerPointWeb.Comments.ICommentTelemetryManager"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),this.K.resolve("PowerPointWebEditor.ICommentsPane"),this.K.resolve("Common.DragInputManager"),this.K.resolve("Common.IClickInputManager"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("Common.IF6Manager"),this.K.resolve("PowerPoint.IPathManager"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.ICommentsPane").xa,
this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventSource"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("PowerPointWebEditor.IPPTWorkspace"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("Box4.Graph.IGraphInstance"),this.K.resolve("PowerPoint.IDateHelper"),this.K.resolve("Common.ITaskManager"),this.K.resolve("PowerPointWeb.Comments.ISharedCommentModelTranslator"),
this.K.resolve("Common.Comments.IOfficeSharedCommentsEventHost"),this.zfb,this.K.resolve("PowerPointWebEditor.IRTEFocusActionHelper"),e.AFrameworkApplication.isRtl,this.K.resolve("PowerPointWebEditor.ICommentContextDetailsUpdateHelper"),this.K.resolve("PowerPointWebEditor.IFindCommentLogic"),this.K.resolve("PowerPointWebEditor.View.IPPTPageView").Ld,this.K.resolve("PowerPointWebEditor.View.IViewEventHandlers"),this.K.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),
this.K.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoManager"),this.K.resolve("PowerPointWeb.Comments.ICommentMarkerViewElementFactory"),this.lR,Bb,this.K.resolve("Common.IAppSettingsManager"),this.K.Ja("Box4.IInteractiveViewManager"),this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventSource"),ib,aa.resolve("PowerPointWebEditor.IErrorHandler"),aa.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.fva,aa.resolve("Box4.Graph.IGraphInstance").Ad(10),aa.resolve("PowerPointWebEditor.View.IViewEventSource"),
aa.resolve("PowerPointWebEditor.ICommentCloudPolicy"),Gb,aa.resolve("PowerPointWebEditor.IShapeReader"),aa.Ja("Common.App.SafeLinks.ISafeLinksManager"),aa.resolve("Box4.ICharacterPropertiesEditor"),aa.resolve("PowerPointWebEditor.IFileInfo"),this.nH,aa.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.IPPTRumTracker"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").AIa?this.K.resolve("PowerPointWebEditor.ICommentShimmerView"):
null,this.K.Ja("PowerPointWebEditor.RevisionTracking.RevisionTrackingManager"),this.K.Ja("PowerPointWebEditor.RevisionTracking.IRevisionTrackingEventHandlers"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").Ks?this.K.resolve("PowerPointWebEditor.ISorterViewActorLazy"):null));this.K.register(Za,"Common.Comments.OfficeSharedCommentsActionHost").as("Common.Comments.IOfficeSharedCommentsActionHost").ma().oa(()=>new Za(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWeb.Comments.ICommentFrame").D3j));
this.K.register($a,"PowerPointWebEditor.ViewContainerAPI").as("PowerPointWeb.Comments.IPptViewContainerAPI").ma().oa(()=>new $a(this.K.resolve("PowerPointWeb.Comments.ICommentFrame"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.oGg));const cc=new wd(this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),new tf(this.K.resolve("PowerPointWebEditor.IPPTReplicationScheduler")),this.gO,this.K.resolve("Common.IAppSettingsManager").ka("459"),
this.K.re("PowerPointWeb.Comments.ICommentFrame"));this.K.register(1206,"PowerPointWebEditor.IFindCommentLogic").ma().oa(()=>new Ud(cc,this.K.resolve("Common.ITaskManager")));this.K.register(Mc,"PowerPointWebEditor.CommentsChangeListener").ma().oa(()=>new Mc(this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("Common.ITaskManager"),this.K.resolve("Box4.Graph.IGraphInstance").Ad(7),this.K.resolve("PowerPointWebEditor.ICommentContextDetailsUpdateHelper"),
this.K.resolve("PowerPointWeb.Comments.ICommentFrame")));this.K.register(1207,"PowerPointWebEditor.ICommentContextDetailsUpdateHelper").ma().oa(()=>new Xf(this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.IFindCommentLogic"),this.gO,this.K.resolve("Common.Comments.IOfficeSharedCommentsEventHost"),this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),this.K.resolve("Common.ITaskManager")));
this.K.register(Oe,"PowerPointWebEditor.CommentPropertyTracker").ma().oa(()=>new Oe(Object(za.a)(this.K.resolve("PowerPointWeb.Comments.ICommentFrame"),this.K.resolve("PowerPointWeb.Comments.ICommentFrame").Y1g,"onCommentPropertiesUpdated"),rb.App.iP.fV,Qb.GraphTransactionManager.instance));this.K.register(1208,"PowerPointWebEditor.ICommentsPane").ma().oa(()=>new Xe(this.K.resolve("PowerPointWebEditor.IFrameContext"),this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").rua,
this.K.resolve("PowerPointWebEditor.ITaskPaneManager"),this.nH));this.K.register(Sg,"PowerPointWebEditor.CommentSmartReplyProvider").ma().oa(()=>new Sg(this.K.resolve("Common.Comments.IOfficeSharedCommentsEventHost"),this.K.Ja("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager")))}init(){ub.a.instance.ic(bc.a.MUd,(new Date).getTime());const aa=this.lR.Ci("UserAction","InitCommentsPackage"),sa={};this.nH||(this.MHa=this.K.resolve("PowerPointWebEditor.ICommentsPane").xa);this.TQ=this.K.resolve("PowerPointWeb.Comments.ICommentFrame");
this.TQ.initialize();var Oa=aa.Rq;sa.CommentFrameInitMS=Oa;this.K.resolve("PowerPointWebEditor.ICommentSessionManager");this.E2c=this.K.resolve("PowerPointWebEditor.CommentPropertyTracker");this.E2c.ayj();const ib=aa.Rq;sa.CommentPropertyTrackerInitMS=ib-Oa;this.xpe=this.K.resolve("PowerPointWebEditor.CommentsChangeListener");this.sWg=this.K.resolve("PowerPointWeb.Comments.IPptViewContainerAPI");var Gb=Fb.b(e.AFrameworkApplication.fa.appSettings.SessionStartInfoJson.toString());Oa=Gb.Ring||"Unknown";
Gb=Gb.WACDatacenter||"Unknown";const Bb=this.K.resolve("PowerPointWebEditor.IApplicationSettings").FHj;var Cc=e.AFrameworkApplication.fa.Ha("LokiComplianceEnvironment");Cc=Cc&&""!==Cc?Cc:e.AFrameworkApplication.fa.Ha("SovereignEnvironmentName");this.zUg=new hb("PowerPoint",e.AFrameworkApplication.buildVersion,null,null,e.AFrameworkApplication.userSessionId,Oa,Gb,!Bb,this.K.resolve("Common.IActionManagerExtended"),null,Cc);Oa=uc.a.ue(e.AFrameworkApplication.lcid);this.rEg=new mc(e.AFrameworkApplication.isRtl,
Oa?Oa.name:Sys.CultureInfo.CurrentCulture.name,e.AFrameworkApplication.uiCulture,e.AFrameworkApplication.dataCulture);this.nH||(this.MHa.id=this.oGg);this.R7b();e.AFrameworkApplication.fa.jf(Object(za.a)(this,this.Om,"onFullAppSettingsReady"));(Oa=this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventSource"))&&Oa.EIk(new Eb);Oa=aa.Rq;sa.CommentReactPaneInitMS=Oa-ib;this.mBj();sa.CommentPaneInitMS=aa.Rq-Oa;e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.SmartRepliesIsEnabled",
!1)&&this.K.resolve("PowerPointWebEditor.CommentSmartReplyProvider").initialize();aa.stop();wb.a.J(512262878,805,15,"CommentsPackage::Init telemetry InitTimeMS:{0}; ModernCommentsReloadEnabledWithoutRoundtrip:{1}",sa,this.K.resolve("Common.IAppSettingsManager").ka("896"))}mBj(){const aa=this.K.resolve("PowerPointWebEditor.ICommentsPane"),sa=this.K.resolve("PowerPointWebEditor.IPaneManager");this.nH||(!this.wWa||this.wWa&&!document.getElementsByClassName("CommentPanel").length)&&sa.OP(aa);sa.gAb(2);
this.K.resolve("PowerPointWebEditor.IFocusManager").H8(Ld.a.Hp,Ld.a.nj,aa,!aa.isVisible)}R7b(){ub.a.instance.ic(bc.a.R7b,(new Date).getTime());const aa=this;this.K.resolve("PowerPointWebEditor.ICommentCloudPolicy").wtb().then(sa=>{ub.a.instance.ic(bc.a.Ace,(new Date).getTime());Ya.a.Uu(aa.K.Ja("Common.App.People.IExternalPeopleAPI")).continueWith(Oa=>{aa.Kva=Oa.result;aa.Kva||wb.a.J(512262877,805,10,"InitOfficeSharedComments: IExternalPeopleAPI instance is null");aa.K.resolve("PowerPointWebEditor.IApplicationSettings").wg&&
(Oa=aa.K.resolve("Common.IAppSettingsManager").Ha("368"),aa.Kva.Q7g(Oa+"p"));Oa=[Mb.a.contextMenu];aa.nH||Kc.a.Ijd(aa.MHa,Oa);const ib=sa&&(aa.CBb||!aa.zcb),Gb=aa.K.resolve("Common.IAppSettingsManager").ka("PositionDraftCommentCardOnCommentsPaneBasedOnAnchorPositionEnabled");aa.K.register(kf,"PowerPointWebEditor.PPTSharedCommentAppCapabilities").as("Common.Comments.IOfficeSharedCommentsAppCapabilities").ma().oa(()=>new kf(aa.K.resolve("Common.IAppSettingsManager"),aa.K.resolve("PowerPointWebEditor.IApplicationSettings"),
aa.Kva,aa.zcb,ib,aa.fva));aa.K.register(Yb,"PowerPointWebEditor.CommentAPI").as("PowerPointWebEditor.IPptOfficeSharedCommentAPI").ma().oa(()=>new Yb(aa.K.resolve("PowerPointWeb.Comments.ICommentFrame"),aa.gO,aa.K.resolve("Common.Comments.IOfficeSharedCommentsEventHost"),aa.K.resolve("Common.Comments.IOfficeSharedCommentsActionHost"),aa.K.resolve("Common.ITaskManager"),aa.K.resolve("Common.IAppSettingsManager"),aa.K.resolve("PowerPointWeb.Comments.ISharedCommentModelTranslator"),aa.K.resolve("PowerPointWebEditor.ICommentContextDetailsUpdateHelper"),
aa.Kva,aa.K.resolve("PowerPointWebEditor.ICommentCloudPolicy"),aa.K.resolve("PowerPointWebEditor.CommentSmartReplyProvider"),ib,aa.fva,Gb,aa.K.resolve("Common.Comments.IOfficeSharedCommentsAppCapabilities"),aa.K.resolve("Common.IActionManagerExtended"),aa.K.resolve("PowerPointWebEditor.IApplicationSettings")));aa.C2c=aa.K.resolve("PowerPointWebEditor.IPptOfficeSharedCommentAPI")},11).continueWith(()=>{aa.C2c&&aa.C2c.checkAtMentionCapability().then(Oa=>{Oa&&((Oa=aa.K.Ja("Common.ISystemInitiatedFeedback"))?
Oa.execute(ib=>{ib.logActivity("Office_Docs_SharedComments_InitializeWebFloodgate","InitializeFloodgateServiceInCommentsPane")}):wb.a.J(512262876,805,10,"InitOfficeSharedComments:InitOfficeSharedComments sifFuture should not be null."))});aa.kBj()})})}kBj(){ub.a.instance.ic(bc.a.lVe,(new Date).getTime());const aa=this.K.resolve("Common.IDynamicScriptLoaderProvider").Pw,sa=this.K.resolve("Common.Comments.IOfficeSharedCommentsAppCapabilities"),Oa=this.K.resolve("Common.Comments.ICommentActivationManager");
ub.a.instance.ic("CommentActivationManagerInitStart",(new Date).getTime());Oa.initialize(aa,this.C2c,this.zUg,this.Kva,new eb(this.sWg,this.zfb),this.rEg,null,sa.aij());ub.a.instance.ic(bc.a.i8b,(new Date).getTime());Oa.i8b().then(()=>{ub.a.instance.ic(bc.a.Bce,(new Date).getTime());this.TQ.NDj();ub.a.instance.ic(bc.a.yme,(new Date).getTime());Ad.a(this.K)("floatingContainerManager").then(()=>{ub.a.instance.ic(bc.a.F2d,(new Date).getTime());this.TQ.vBj();ub.a.instance.ic(bc.a.G2d,(new Date).getTime());
if(this.K.resolve("PowerPointWebEditor.IApplicationSettings").wei){const ib=this.gO.Qy();ib&&0<ib.length?(this.TQ.Y1k(),ub.a.instance.ic(bc.a.Hod,(new Date).getTime()),Bc.App.DKb(null,bc.a.Hod)):wb.a.J(512262875,805,50,"InitCommentActivationManager: Deep link to a slide without comments")}}).catch(ib=>{wb.a.J(512262874,801,10,"Failed to load the resources for the floating container UI + "+ib.toString())})})}Om(){this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame").updateCommandUI()}dispose(){this.E2c&&
this.E2c.Fvl();this.TQ&&this.TQ.dispose();this.xpe&&this.xpe.dispose();this.Kva=null}get name(){return"PowerPointWebEditor.CommentsPackage"}static main(){ub.a.instance.ic(bc.a.HUd,(new Date).getTime());Tb.a.instance.Dc(new tc)}}Object(k.a)(tc,"CommentsPackage",null,[2,3]);Type.registerNamespace("Common.App.SharedComments");Type.registerNamespace("FloatingContainer");Type.registerNamespace("FloatingContainerManager");Type.registerNamespace("PowerPointWeb.Comments");Type.registerNamespace("PowerPointWebEditor");
Type.registerNamespace("RichContentEditAPI");tc.main()},277:function(K,Z,d){d.d(Z,"a",function(){return e});K=d(0);var k=d(1006);class e{constructor(n){this.kl=new k.a;this.WXa=n}VG(n){const r=n.id;let v=null;this.kl.Hb(r)?v=this.kl.ga(r):(this.WXa&&(v=this.WXa(n,()=>{this.znc(r)})),v&&this.kl.$(r,v));return v}EF(n){n=n.id;return this.kl.Hb(n)?this.kl.ga(n):null}znc(n){this.kl.remove(n)}}Object(K.a)(e,"ShapeComponentViewManager",null,[255])},678:function(K,Z,d){d.d(Z,"a",function(){return v});K=d(0);
var k=d(17),e=d(95),n=d(27),r=d(48);d(96);class v{constructor(){this.r_=null}get wxb(){return!1}qCh(C,w){let z=new k.a;const A=new r.GraphTransaction(3);try{A.kd(n.App.Kb.Jd.Cn.yg),this.D$b(w)&&(z=this.n8b(w,z)),w!==C&&this.D$b(C)&&(z=this.n8b(C,z))}finally{A&&A.dispose()}return z.toArray()}D$b(C){return!!C}Tjd(C){let w=!1;for(const z of this.mbe)w||!Sys.UI.DomElement.containsCssClass(C,z.className)&&!Sys.UI.DomElement.containsCssClass(C,z.u6b)||(w=!0),e.a.XJa(C,z.className),e.a.XJa(C,z.u6b)}}Object(K.a)(v,
"AHighlightActor",null,[934])},679:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k{constructor(e,n){this.className=e;this.u6b=n}}Object(K.a)(k,"HighlightCssClassPair",null,[])},680:function(K,Z,d){d.d(Z,"b",function(){return r});d.d(Z,"a",function(){return v});var k=d(95);d(27);var e=d(48);d(31);d(92);var n=d(96);const r=C=>{const w=new e.GraphTransaction(3);try{w.kd(C),C.wv(32,!0)}finally{w&&w.dispose()}},v=C=>{if(C){C=k.a.Ija(C);if(-1===C.indexOf(n.a.R7)&&-1!==C.indexOf(n.a.hN)&&
-1===C.indexOf(n.a.Z0b))return 2;if(-1===C.indexOf(n.a.R7)&&(-1!==C.indexOf(n.a.Y0b)||-1!==C.indexOf(n.a.vN)||-1!==C.indexOf(n.a.Z0b)||-1!==C.indexOf(n.a.GJc)||-1!==C.indexOf(n.a.tLc)||-1!==C.indexOf(n.a.rLc)||-1!==C.indexOf(n.a.qLc)||-1!==C.indexOf(n.a.EXd)||-1!==C.indexOf(n.a.zXd)||-1!==C.indexOf(n.a.BXd)||-1!==C.indexOf(n.a.sLc)||-1!==C.indexOf(n.a.yXd)))return 1;if(-1!==C.indexOf("WACImageContainer"))return 3}return 0}},681:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k{constructor(){this.type=
this.action=0;this.rhb=this.jda=null}}Object(K.a)(k,"HighlightOperation",null,[])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/18430998/wdjs/ppteditDS.comment.js.map