/*
 @license DOMPurify 2.4.1 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.4.1/LICENSE */
'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[3],{1001:function(K,Z,d){K=d(0);var k=d(382);d(1186);var e=d(94),n=d(63),r=d(87);class v{constructor(){this.hasImpliedUsage=this.additionalValues=this.isInternal=this.isIntentional=null}}Object(K.a)(v,"IKpiFailureOptionalProperties",null,[]);class C{constructor(){this.hasImpliedUsage=this.additionalValues=null}}Object(K.a)(C,"IKpiSuccessOptionalProperties",null,[]);var w=d(918);class z{constructor(){this.blockFutureEmissionDurationInMs=
this.optionalVeto=this.optionalProperties=this.errorName=this.kpiName=null}}Object(K.a)(z,"KpiFailureParams",null,[]);class A{constructor(){this.blockFutureEmissionDurationInMs=this.optionalProperties=this.kpiName=null}}Object(K.a)(A,"KpiSuccessParams",null,[]);var u=d(919);d.d(Z,"a",function(){return E});class E{static getInstance(H){try{return healthSmall.HealthFactoryGlobal.getExtendedHealthInstance(e.Health.instance,H)}catch(I){return k.ULS.Zib(521457890,383,10,I,"Failed to initialize extendedHealth"),
null}}static aNk(H,I){const J=E.getInstance(H);J&&J.logKpiUsage(E.S$i());const T=n.a.tj();try{const D=I();D.then(R=>{const Q=E.R$i(n.a.tj()-T);J&&J.logKpiSuccess(Q);return R}).catch(R=>{let Q="UnknownError";R&&(Q=R.toString());R=E.R0f(Q,n.a.tj()-T);J&&J.logKpiFailure(R)});return D}catch(D){throw H="",H=D.message,H=E.R0f(H,n.a.tj()-T),J&&J.logKpiFailure(H),D;}}static S$i(){const H=Object.assign(new w.a,{extendedProperties:E.s5d()});return Object.assign(new u.a,{kpiName:"InitFloodgate",kpiType:0,optionalProperties:H,
blockFutureEmissionDurationInMs:3E5})}static R$i(H=null){H=Object.assign(new C,{additionalValues:Object.assign(new r.a,{extendedProperties:E.s5d(),durationMs:H})});return Object.assign(new A,{kpiName:"InitFloodgate",optionalProperties:H,blockFutureEmissionDurationInMs:3E5})}static R0f(H,I=null){I=Object.assign(new v,{additionalValues:Object.assign(new r.a,{extendedProperties:E.s5d(),durationMs:I})});return Object.assign(new z,{kpiName:"InitFloodgate",errorName:H,optionalProperties:I,optionalVeto:null,
blockFutureEmissionDurationInMs:3E5})}static s5d(){const H=new Map;H.has("SkipAria")||H.set("SkipAria","True");return H}}Object(K.a)(E,"ExtendedHealth",null,[])},1004:function(K,Z,d){K=d(0);class k{constructor(){this.results=null;this.totalResultCount=0;this.hasTooManyResults=!1}}Object(K.a)(k,"DocumentContentSearchResults",null,[]);class e{getAllParagraphsInDocument(){return null}selectRange(){}selectRangeV2(T,D,R,Q,W){this.selectRange(D,R,Q,W)}selectRangeV3(){}search(){}searchV2(T,D){this.search(T,
R=>{D(Object.assign(new k,{results:R,totalResultCount:R.length,hasTooManyResults:100<R.length}))})}searchWithParam(T,D){this.search(T.query,D)}searchWithParamV2(T,D){this.searchWithParam(T,R=>{D(Object.assign(new k,{results:R,totalResultCount:R.length,hasTooManyResults:R.length>T.totalResultLimit}))})}highlight(){}highlightWithParam(T){this.highlight(T.query)}getRevision(){return null}getDocumentSelection(){return null}clearDocumentSelection(){}selectNextPrevHighlight(){return-1}getSelectedText(){return null}submitDocumentContentExtractionSignal(){}generateDocumentSummary(){return Promise.resolve(null)}generateDocumentSummaryDetails(){return Promise.resolve(null)}highlightDocumentKeySentences(){return Promise.resolve(null)}getDocumentKeySentences(){return Promise.resolve(null)}clearDocumentKeySentencesHighlights(){}extractDocumentObjects(){}getAuthorImageUrlFromClient(){return Promise.resolve(null)}getId(){return"DocumentContentExecutor"}}
Object(K.a)(e,"BaseDocumentContentExecutor",null,[806,950]);class n{constructor(){this.subdocumentId=this.snippet=null;this.endOffsetInParagraph=this.startOffsetInParagraph=this.paragraphIndex=this.endOffsetInSnippet=this.startOffsetInSnippet=this.subdocumentType=0;this.authorName=this.authorEmail=null}}Object(K.a)(n,"DocumentContentSearchResult",null,[]);var r=d(104),v=d(25),C=d(45),w=d(17),z=d(75),A=d(31),u=d(49),E=d(382),H=d(671),I=d(28);d.d(Z,"a",function(){return J});class J extends e{constructor(T,
D,R,Q,W,O,Y,S,da,fa,ka){super();if(!T)throw Error("pageNode is null");if(!D)throw Error("interactiveViewManager is null");if(!R)throw Error("selectionFactory is null");if(!Q)throw Error("slideReader is null");if(!W)throw Error("workspace is null");if(!O)throw Error("graphTopologyManager is null");if(!Y)throw Error("searchContextFactory is null");if(!S)throw Error("actionManager is null");if(!da)throw Error("selectionManager is null");if(!fa)throw Error("clipServiceManager is null");if(!ka)throw Error("presentationReader is null");
this.N$j=T;this.IC=D;this.W9c=R;this.jc=Q;this.Vb=W;this.ua=O;this.ybk=Y;this.ia=S;this.pa=da;this.fO=fa;this.qc=ka}getAllParagraphsInDocument(){const T=this.G7d(),D=new w.a;for(let R of T)D.add(J.D7d(R));return D.toArray()}selectRange(T,D,R,Q){if(!(0>T||0>D||0>R||0>Q||T>R||T===R&&D>Q)){var W=this.G7d();W.count<=R||(T=W.ga(T),R=W.ga(R),J.plg(T,D)&&J.plg(R,Q)&&(W=this.jc.mg(T),this.ua.Ba!==W&&this.Vb.Joh(W),D=this.W9c.Qg(T,D),Q=this.W9c.wN(D,u.a.Kj(R,Q+1)),this.IC.KUe(this.Vb.GK,Q)))}}search(T,D){const R=
new w.a,Q=T.toLowerCase();var W=this.G7d();let O=0;for(let S of W){W=J.D7d(S);const da=W.toLowerCase();let fa=0;for(;-1<(fa=da.indexOf(Q,fa));){var Y=this.ybk.rFi(W,fa,fa+T.length);Y=Object.assign(new n,{snippet:Y.Syi,startOffsetInSnippet:Y.dZk,endOffsetInSnippet:Y.aZk-1,paragraphIndex:O,startOffsetInParagraph:fa,endOffsetInParagraph:fa+T.length-1});R.add(Y);fa+=T.length}O++}R.Sc((S,da)=>S.paragraphIndex===da.paragraphIndex?S.startOffsetInParagraph-da.startOffsetInParagraph:S.paragraphIndex-da.paragraphIndex);
D(R.toArray())}getSelectedSlidesAsPPTXStream(){const T=this.pa.We();if(T&&T.length)return this.CYf(T);E.ULS.sendTraceTag(509642065,1313,10,"Unable to get selected slides. getAllSelectedSlideNodes returned undefined or empty")}getAllSlidesAsPPTXStream(){const T=this.qc.L4f();if(T&&T.length)return this.CYf(T);E.ULS.sendTraceTag(509437598,1313,10,"Unable to get slides in presentaiton. Calling getSortedSlideNodes returnd no slides")}CYf(T){var D=this.fO.DKc(1,T.length,!1),R=r.a.create().toString();R=
new H.a(D,R,T);var Q=8;Q=this.ia.La(I.a.PVd,2,R);D.qW=Q;R=v.AFrameworkApplication.fa.Ha("361");Q=C.a.Ke(D.Gp);const W=C.a.Ke(D.mD);D=C.a.Ke(D.ty);if(Q&&W&&D)return{url:`${R}GetClipboardBytes.ashx?Id=${Q}&DC=${W}&pkey=${D}&wdwaccluster=${W}&DataType=${1}`,selectedSlideIDs:T.map(O=>O.id.toString())}}G7d(){var T=A.ParagraphReader.NSc(this.N$j.value,!0,!1);const D=new w.a;for(let R of T)T=this.jc.mg(R),T.ON||T.Dzb||D.add(R);return D}static D7d(T){T=A.ParagraphReader.text(T);return z.AParagraphNode.$jd(T,
" ")}static plg(T,D){T=J.D7d(T);return D<T.length}}Object(K.a)(J,"PPTDocumentContentExecutor",e,[])},1007:function(K,Z,d){K=d(0);var k=d(382),e=d(1186),n=d(1187),r=d(1188),v=d(119),C=d(25),w=d(1001),z=d(198),A=d(269),u=d(93),E=d(249),H=d(307),I=d(33),J=d(190),T=d(54),D=d(45);class R{constructor(){this.cvFlights=this.uiHost=this.productName=null;this.isCVSurveyEnabled=!1}}Object(K.a)(R,"CustomerVoiceSurveyParams",null,[]);var Q=d(141),W=d(525);class O{sendTelemetryEvent(da){const fa=new W.a;fa.otelEvent=
da;Q.a.sendOtelEvent(fa)}}Object(K.a)(O,"OtelTelemetrySink",null,[1351]);var Y=d(920);d.d(Z,"a",function(){return S});class S{static init(da,fa,ka,ha,F){F.onDismiss=da;F.onError=fa;da=null;OfficeBrowserFeedback.initOptions?("screenshot"in F&&(OfficeBrowserFeedback.initOptions.screenshot=F.screenshot),"showEmailAddress"in F&&(OfficeBrowserFeedback.initOptions.showEmailAddress=F.showEmailAddress),"feedbackForumUrl"in F&&(OfficeBrowserFeedback.initOptions.feedbackForumUrl=F.feedbackForumUrl),da=F):OfficeBrowserFeedback.initOptions=
F;OfficeBrowserFeedback.initOptions.telemetrySink||(OfficeBrowserFeedback.initOptions.telemetrySink=S.BIf());OfficeBrowserFeedback.multiFeedback(da).then(()=>{k.ULS.sendTraceTag(36300302,356,100,"BFCOCV Success calling OCV Feedback")}).catch(na=>k.ULS.sendTraceTag(36300303,356,10,"BFCOCV Error:"+na.toString()))}static Cce(da,fa,ka,ha){k.ULS.sendTraceTag(36546398,356,50,"BFCOCV.Entered InitSIFeedback");if(S.Rnb===S.initialized)return Promise.resolve(1);if(S.Rnb===S.mcg)return S.ncg||(S.ncg=!0,k.ULS.sendTraceTag(36546399,
356,15,"BFCOCV.InitSIFeedback:Initializing")),Promise.resolve(0);if(S.Rnb!==S.error){S.Rnb=S.mcg;k.ULS.sendTraceTag(36546400,356,50,"BFCOCV.InitSIFeedback:past init check");if(S.RBj(da,fa,ka,ha))return S.wBj();S.Rnb=S.error;Promise.reject(S.p0g)}return Promise.reject(0)}static wBj(){try{return w.a.aNk(S.Q$i(),()=>OfficeBrowserFeedback.floodgate.initialize().then(()=>S.hYe())).catch(da=>{let fa=10;da&&da.toString()&&J.a(da.toString(),S.m_j)&&(fa=15);k.ULS.sendTraceTag(36546402,356,fa,"BFCOCV Floodgate initialize error:"+
da.toString())})}catch(da){return k.ULS.sendTraceTag(590975881,356,15,"BFCOCV Floodgate initialize error:"+da.toString()),Promise.reject(S.Zkk)}}static Q$i(){return Object.assign(new Y.a,{featureName:"Floodgate",crewAlias:"floodgatecrew",vetoPillar:"OfficeBrowserFeedback"})}static hYe(){return OfficeBrowserFeedback.floodgate.start().then(()=>{S.yYi()}).catch(da=>{k.ULS.sendTraceTag(36546401,356,10,"BFCOCV Floodgate start error:"+da.toString())})}static yYi(){S.Rnb=S.initialized;k.ULS.sendTraceTag(36546403,
356,50,"BFCOCV.Started floodgate");try{const da=C.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.FloodgateTestActivity","");for(const fa of da.split("|"))fa&&S.logActivity(fa,null)}catch(da){k.ULS.sendTraceTag(539015366,356,50,"Error triggering test activity")}}static wua(){let da=!1;const fa=C.AFrameworkApplication.fa;fa&&(da="teams"===(fa.Ha(C.AFrameworkApplication.YJ)||"").toLowerCase());return T.a.zFa||da}static u0g(){return"undefined"==typeof OfficeBrowserFeedback}static RBj(da,
fa,ka,ha){let F=!0;try{if(S.u0g())return k.ULS.sendTraceTag(39900617,356,15,S.p0g),!1;OfficeBrowserFeedback.initOptions||(ka.onDismiss=ha,ka.onError=fa,ka=S.Qci(ka),OfficeBrowserFeedback.initOptions=ka);OfficeBrowserFeedback.initOptions.telemetrySink||(OfficeBrowserFeedback.initOptions.telemetrySink=S.BIf());fa={};ha={};ha.onSurveyActivated=S.Itk;ha.onTeachingCampaignRender=ka.onTeachingCampaignRender;fa.onSurveyActivatedCallback=ha;fa.onDismiss=da;fa.autoDismiss=ka.FloodgateUIAutoDismissTimeEnum;
fa.telemetryGroup=ka.telemetryGroup;fa.uIStringGetter=ka.uIStringGetter;fa.authTokenCallback=ka.authTokenCallback;fa.augLoopCallback=ka.augLoopCallback;fa.campaignFlights="";fa.governanceServiceEnabled=ka.governanceServiceEnabled;fa.governanceServiceConfig=ka.governanceServiceConfig;fa.personalizerEnabled=ka.personalizerEnabled;fa.messagingServiceSettings=ka.messagingServiceSettings;fa.isPriorityEnabled=ka.isPriorityEnabled;C.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateAdminControlsEnabled",
!1)&&("surveyEnabled"in ka&&(fa.surveyEnabled=ka.surveyEnabled),"showEmailAddress"in ka&&(fa.showEmailAddress=ka.showEmailAddress));fa.isEudbUxEnabled=!1;C.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EUDBUXIsEnabled",!1)&&(fa.isEudbUxEnabled=!0);const ba=S.T5i(ka),Ea=S.H_f(ba);let La=S.n6i(ka);for(let ta in Ea){da=ta;var na=Ea[ta];-1!==da.toLowerCase().indexOf("flight")?fa.campaignFlights+=na+";":La=La+da+"="+na+"&"}k.ULS.sendTraceTag(50422099,356,50,"campaignFlights: "+
fa.campaignFlights+" campaignQueryParameters: "+La);fa.campaignQueryParameters=La;fa.customerVoiceSurveyParams=S.e6i(ka.Application.toString(),S.wua()?S.Fol:"");OfficeBrowserFeedback.floodgate.initOptions=fa}catch(ba){F=!1,k.ULS.sendTraceTag(39900618,356,15,ba.toString())}return F}static Qci(da){try{const fa=da.applicationGroup?da.applicationGroup:{},ka=fa.appData,ha=ka?I.a(I.a('"'+ka+'"')):{};ha.fgUIAutoDismiss=da.FloodgateUIAutoDismissTimeEnum;fa.appData=I.c(ha);da.applicationGroup=fa}catch(fa){k.ULS.sendTraceTag(588842831,
356,10,"Failed to parse applicationGroup.appData",fa.toString())}return da}static T5i(da){da=Array.isArray(da.Flights)?da.Flights:null;da||(da=(da=C.AFrameworkApplication.fa.Ha("FlightId"))?da.toString().split(";"):null);if(C.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateTreatmentVariableFlighting",!0)){const fa=C.AFrameworkApplication.fa.pPc;if(fa)for(let ka in fa){const ha={key:ka,value:fa[ka]};-1!==(ha&&ha.key?ha.key.toLowerCase():"").indexOf("floodgateflight")&&
"unset"!==(ha&&ha.value?ha.value.toString().toLowerCase():"")&&da.push(ha.key)}}return da}static H_f(da){const fa={SelfTriggerActivity:""};if(!da||!da.length)return fa;try{for(let F=0;F<da.length;F++){let na=da[F]?da[F].toLowerCase():"";if(-1===na.indexOf("floodgateflight"))continue;const ba=na.lastIndexOf(".");-1!==ba&&(na=na.substring(ba+1,na.length));if(-1!==("AppFlights"in fa?fa.AppFlights:"").indexOf(na))continue;fa.AppFlights="AppFlights"in fa?fa.AppFlights+(";"+na):na;const Ea=D.a.replaceAll(na,
"-",""),La=C.AFrameworkApplication.fa.Ha(Ea);if(La)try{const ta=I.a(La);ta&&ta.SelfTriggerActivity||(fa.SelfTriggerActivity+=";"+Ea);if(ta)for(let oa in ta){var ka=oa,ha=ta[oa];ka in fa?fa[ka]!==ha&&(fa[ka]=fa[ka]+";"+ha):fa[ka]=ha}}catch(ta){k.ULS.sendTraceTag(50422101,356,10,"Failed to parse the "+Ea+" json data",ta.toString())}else fa.SelfTriggerActivity+=";"+Ea}}catch(F){k.ULS.sendTraceTag(50422102,356,10,"Failed to get floodgate flight parameters for floodgateContext",F.toString())}return fa}static n6i(da){let fa=
"";const ka={["OFC_Audience"]:"AudienceGroup",["Datacenter"]:"WACDatacenter",["TenantId"]:"TenantId"};for(let na in ka){var ha=na,F=ka[na];let ba=da[Object(e.a)(String,F)];ba||(ba=C.AFrameworkApplication.fa.Ha(Object(e.a)(String,F)));ba&&(fa+=ha+"="+encodeURIComponent(ba)+"&")}return fa}static u5k(da){S.WXd=da}static Itk(da,fa,ka){if(da)try{const F=fa?fa.getCampaignId():"",na=fa?fa.getLauncherType():"",ba=ka?ka.contextInfo:null;var ha=fa?fa.getSurveyInfo():null;const Ea=ha?ha.getPreferredLaunchType():
null,La=ha?ha.getMetadata():null,ta=La?La.getContentMetadata():null,oa=ta?ta.customSurveyName:null,wa=ta?ta.telemetryEventName:null;S.EIj(F)?k.ULS.sendTraceTag(539015367,356,50,"BFCOCV.onSurveyActivated campaign disabled -"+F):(ha={},ha.campaignId=F,ha.surveyName=oa,ha.launcherType=na,ha.contextInfoLength=ba?ba.length.toString():"-1",ha.preferredLaunchType=Ea,ha.telemetryEventName=wa,k.ULS.sendTraceTag(36706399,356,50,"BFCOCV.onSurveyActivated -  "+JSON.stringify(ha)),na&&"coachingux"===na.toLowerCase()&&
Ea&&"default"!==Ea.toLowerCase()&&S.l9f(ta,fa,ka)?k.ULS.sendTraceTag(555071513,356,50,"BFCOCV.onSurveyActivated. Custom survey activation successful - "+JSON.stringify(ha)):(da.launch(ka),S.Rrh()))}catch(F){k.ULS.sendTraceTag(555071514,356,10,"BFCOCV.onSurveyActivated. Error handling activation callback - "+(F?F.toString():""))}else k.ULS.sendTraceTag(36706400,356,10,"BFCOCV.onSurveyActivated given a null launcher")}static kvj(da){da=da?da.surfaceContext:null;if(!da||!da.surveyForm)return k.ULS.sendTraceTag(555071516,
356,10,"Missing activation arguments"),!1;try{const fa=da.surveyForm.getSurveyInfo(),ka=fa?fa.getMetadata():null,ha=ka?ka.getContentMetadata():null;return S.l9f(ha,da.surveyForm,da.surveyParams)}catch(fa){k.ULS.sendTraceTag(555071517,356,10,"BFCOCV.HandleActivationCallback Error - "+(fa?fa.toString():""))}return!1}static l9f(da,fa,ka){if(!da||!da.customSurveyName||!fa)return k.ULS.sendTraceTag(555071518,356,10,"Survey arguments not provided "+(da?da.customSurveyName:null)),!1;const ha=fa.getCampaignId();
if(da.telemetryEventName){var F={["action"]:"Opened",["id"]:ha,["success"]:"true",["triggerType"]:"custom",["customSurveyName"]:da.customSurveyName,["telemetryEventName"]:da.telemetryEventName};S.WXd?S.WXd(da.telemetryEventName,F):(C.AFrameworkApplication.fk(da.telemetryEventName),C.AFrameworkApplication.Aac(da.telemetryEventName),k.ULS.sendTraceTag(512505554,356,50,"BFCOCV.onSurveyActivated survey activated -"+JSON.stringify(F)))}F=S.Dpf.Hb(da.customSurveyName)?S.Dpf.ga(da.customSurveyName):null;
if(!F)return k.ULS.sendTraceTag(555071519,356,50,"Activation callback not found - "+da.customSurveyName+", "+ha),!1;(da=F(fa,ka))&&da.then(na=>{k.ULS.sendTraceTag(555071520,356,50,"Activation callback result - "+JSON.stringify(na))}).catch(na=>{k.ULS.sendTraceTag(555071521,356,50,"Error in activation callback handling: "+(na?na.toString():""))});return!0}static EIj(da){try{return-1!==C.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.FloodgateDisabledCampaigns","").toLowerCase().indexOf((da||
"").toLowerCase())}catch(fa){k.ULS.sendTraceTag(539015368,356,10,"Error checking if campaign is disabled - "+da)}return!1}static logActivity(da,fa=null){if(S.wTd(da,"LogActivity")){var ka=S.N5d();ka&&(k.ULS.sendTraceTag(37856259,356,50,"BFCOCV.Calling OCV's logActivity "+da),ka.logActivity(da,1,fa))}}static kMb(da){da?(k.ULS.sendTraceTag(38605915,356,50,"BFCOCV.Calling OCV's showCustomSurvey"),OfficeBrowserFeedback.floodgate.showCustomSurvey(da),S.Rrh()):k.ULS.sendTraceTag(38605914,356,10,"BFCOCV.surveyJsonObject null:")}static Rrh(){S.Zqa(S.WUf)}static UCj(da,
fa,ka){var ha=[3,2,5,1];const F=u.FocusManager.instance(),na=F.Gc(da);na.parent=v.AFrame.nj;na.zL=!0;A.a.instance.w2(da,!0);fa&&na.Uba(fa);if(ka){E.a.instance.v7(da,ka,!1,!0);H.a.instance.v7(da,ka,!1,!0);da=new z.DOMFocusListing(()=>ka);for(fa=0;fa<ha.length;++fa)da.Eo(ha[fa]);F.Eia(()=>ka,na,da).kX=!0}}static Zqa(da){const fa=document.getElementById(da);fa?S.UCj(da,S.Bok,fa):k.ULS.sendTraceTag(36706402,356,15,"BFCOCV.Could not find container "+da)}static Bok(da,fa){k.ULS.sendTraceTag(37107265,356,
100,"BFCOCV.OnFocusAction. PrevScopeName "+(da?da.name:"")+" NextScopeName "+(fa?fa.name:""));fa&&(da=u.FocusManager.instance().rQ(fa.name))&&da.bcd()}static sac(da){if(S.wTd(da,"LogActivityStart")){var fa=S.N5d();fa&&(k.ULS.sendTraceTag(37856260,356,50,"BFCOCV.Calling OCV's logActivityStartTime "+da),fa.logActivityStartTime(da))}}static Ong(da){if(S.wTd(da,"LogActivityEnd")){var fa=S.N5d();fa&&(k.ULS.sendTraceTag(37856262,356,50,"BFCOCV.Calling OCV's logActivityStopTime "+da),fa.logActivityStopTime(da,
new Date))}}static zYi(){OfficeBrowserFeedback.floodgate.start()}static AYi(){OfficeBrowserFeedback.floodgate.stop()}static wTd(da,fa){da||k.ULS.sendTraceTag(36546433,356,10,"BFCOCV.Error. null 'name' in method "+fa);return!!da}static N5d(){let da=null;const fa=OfficeBrowserFeedback.floodgate.getEngine();fa?(da=fa.getActivityListener())||k.ULS.sendTraceTag(36546434,356,10,"BFCOCV.Error floodgate listener null"):S.$_g||(S.$_g=!0,k.ULS.sendTraceTag(36546435,356,15,"BFCOCV.Error floodgate engine null"));
return da}static BIf(){return new O}static e6i(da,fa){return Object.assign(new R,{productName:da,uiHost:fa,cvFlights:"",isCVSurveyEnabled:!0})}}S.WUf="obf-ToastContainer";S.notInitialized=0;S.mcg=1;S.initialized=2;S.error=-1;S.Rnb=S.notInitialized;S.$_g=!1;S.ncg=!1;S.m_j="window.localStorage is not available";S.p0g="OFB still undefined";S.Zkk="OFB Floodgate is undefined or does not contain initialize function";S.Fol="Teams";S.Dpf=new n.a(r.a.jp());S.WXd=null;Object(K.a)(S,"BrowserFeedbackControlOCV",
null,[])},1011:function(K,Z,d){K=d(0);var k=d(346),e=d(662);class n extends e.a{constructor(u,E=null,H=null){super("DeferredContentType");this.title=this.isDeferred=this.messageText=null;this.title=E;this.messageText=u;this.isDeferred=H}}Object(K.a)(n,"DeferredContentProps",e.a,[]);var r=d(26),v=d(921),C=d(922);const w=(u,E)=>Object.assign(new v.a,{target:".EditingRibbonPanel",content:u,useTeachingStyles:!1,showCloseIcon:!0,calloutProps:Object.assign(new C.a,{directionalHint:6,gapSpace:4,isBeakVisible:!1,
preventDismissOnScroll:!0,onDismiss:E,preventDismissOnResize:!0})});var z=d(47);d.d(Z,"a",function(){return A});class A{constructor(){this.PT=new n(ResourceStrings.l_DeferredContentDownloadACopyWaitToastMessage,ResourceStrings.l_DeferredContentDownloadACopyWaitDialogTitle,!0)}eMi(u,E,H,I){I=Object.assign(new k.a,{onShow:()=>{H.EK(z.a.W_a)}});E=u.callout(E);return I=u.addNotification(E,I)}vRk(u,E){u.removeNotification(E);r.a.J(523871964,843,10,"DownloadACopy Toast can not be removed!");return E}sEi(u){return w(this.PT,
()=>{u.Ho(z.a.W_a)})}}Object(K.a)(A,"DownloadACopyDeferred",null,[596])},1012:function(K,Z,d){K=d(0);var k=d(575),e=d(1186),n=d(296),r=d(497);class v{constructor(){this.limField=0;this.limFieldSpecified=!1}}Object(K.a)(v,"CT_LineJoinMiterProperties",null,[]);var C=d(950);class w{constructor(){this.valField=0}}Object(K.a)(w,"CT_PositiveFixedPercentage",null,[]);var z=d(951),A=d(363),u=d(319),E=d(297);d.d(Z,"a",function(){return H});class H{i4f(I,J,T,D,R,Q){I=Object(e.a)(295,Q.Ba.tg(R.Ma));T=R.Ld;R=
Math.round(D.zM(T.Me(J.width*k.a.UC,0),I.mT));J=Math.round(D.zM(T.Me(J.height*k.a.UC,1),I.mT));return{jsh:R,ash:J}}qHf(I,J){return Object.assign(new n.a,{TopLeft:Object.assign(new E.a,{X:0,Y:0}),TopRight:Object.assign(new E.a,{X:I,Y:0}),BottomLeft:Object.assign(new E.a,{X:0,Y:J}),BottomRight:Object.assign(new E.a,{X:I,Y:J})})}Rph(I){I.lineStyle=Object.assign(new C.a,{algnField:0,algnFieldSpecified:!0,capField:2,capFieldSpecified:!0,cmpdField:0,cmpdFieldSpecified:!0,miterField:Object.assign(new v,
{limField:8E5,limFieldSpecified:!0}),prstDashField:Object.assign(new z.a,{valField:0,valFieldSpecified:!0}),solidFillField:Object.assign(new u.a,{schemeClrField:Object.assign(new A.a,{valField:4})}),wField:6350,wFieldSpecified:!0})}bqh(I){I.fill=Object.assign(new r.a,{solidFillField:Object.assign(new u.a,{schemeClrField:Object.assign(new A.a,{valField:4})})});I.lineStyle=Object.assign(new C.a,{algnField:0,algnFieldSpecified:!0,capField:2,capFieldSpecified:!0,cmpdField:0,cmpdFieldSpecified:!0,miterField:Object.assign(new v,
{limField:8E5,limFieldSpecified:!0}),prstDashField:Object.assign(new z.a,{valField:0,valFieldSpecified:!0}),solidFillField:Object.assign(new u.a,{schemeClrField:this.qFi(Object.assign(new w,{valField:5E4}))}),wField:12700,wFieldSpecified:!0})}qFi(I){const J={itemsElementNameField:[26]};J.itemsField=[I];J.valField=4;return J}}Object(K.a)(H,"InsertShapeActorHelper",null,[467])},1022:function(K,Z,d){K=d(0);var k=d(13),e=d(1185),n=d(25),r=d(65),v=d(79);class C{constructor(z,A,u,E=null){this.origin=z;
this.data=A;this.source=u;this.pc=E}}Object(K.a)(C,"MessageEventArgs",null,[]);d.d(Z,"a",function(){return w});class w{constructor(z,A){this.lMd=null;this.G2h=z;this.Wd=A;this.kAc=null}get Pkb(){return this.G2h.value}get taskManager(){return this.Wd.value}yfi(z){this.kAc=z;this.lMd=Object(k.a)(this,this.DBk,"postMessageEventHandler");this.Pkb.addHandler(r.a.message,this.lMd,null)}xKi(){this.kAc=null;this.Pkb.removeHandler(r.a.message,this.lMd)}iXc(z,A){const u=new v.a(0,1,1,()=>{z(A)},7);this.taskManager.Eb(u)}qGj(z,
A){const u=new v.a(0,1,1,()=>{z(A)},7);this.taskManager.Eb(u)}DBk(z){return this.kAc?this.kAc(new C(z.origin,z.data,z.source,z.pc)):!1}static get instance(){return w.Q8a()}static Q8a(){return new w(new e.a(()=>n.AFrameworkApplication.Pkb),new e.a(()=>n.AFrameworkApplication.we))}}Object(K.a)(w,"MessageEventHandler",null,[865])},1025:function(K,Z,d){K=d(0);var k=d(382),e=d(103),n=d(268),r=d(13),v=d(1186),C=d(33);class w{constructor(){this.Value=this.Id=this.LanguageId=null}}Object(K.a)(w,"CritiqueTypeOption",
null,[]);var z=d(2);d.d(Z,"a",function(){return A});class A{constructor(u,E,H){this.lJd={};this.ol=null;this.Ukf=u;this.kZh=E;this.lZh=H;this.B3a=z.Task.Nt({})}init(){this.B3a=this.Ukf.R9d(this.kZh,["ProofingSettingLanguageList","ProofingSettings"]).CWRCo(Object(r.a)(this,this.eqk,"onLoadSettingsTaskFinished"),8)}$rl(u){const E={};if(!(u&&"ProofingSettingLanguageList"in u))return E;const H=Array.isArray(C.a(u.ProofingSettingLanguageList))?C.a(u.ProofingSettingLanguageList):null;for(const I of H)"ProofingSettings"+
I in u&&(E[I]=Object(v.a)(Object,C.a(u["ProofingSettings"+I])));return E}asl(u){const E={},H=[];for(let T in u){var I=T,J=u[T];J&&(H.push(I),E["ProofingSettings"+I]=C.c(J))}E.ProofingSettingLanguageList=C.c(H);return E}saveSettings(u){this.B3a=z.Task.Nt(u);this.ol=null;try{const E=this.asl(u);this.Ukf.urh(this.lZh,E).continueWith(Object(r.a)(this,this.psk,"onSaveSettingsTaskFinished"),8)}catch(E){k.ULS.sendTraceTag(35401881,375,10,"Save settings failed with exception {0}",E.toString())}}T4d(){if(!this.ol){if(6!==
this.B3a.status)return[];try{var u=this.B3a.result;let J;if(e.a.isEmpty(this.lJd))J=u;else if(e.a.isEmpty(u))J=this.lJd;else{J={};var E=this.lJd;for(let T in E)J[T]=e.a.Qpc(E[T]);J=A.merge(J,u)}this.ol=[];for(let T in J){var H=J[T];const D=n.a.ue(parseInt(T));if(!D)continue;const R=D.name;E=H;for(let Q in E){u=Q;var I=E[Q];const W=Object.assign(new w,{LanguageId:R,Id:u,Value:I.toString()});this.ol.push(W)}}}catch(J){k.ULS.sendTraceTag(36542301,375,10,"GetCritiqueTypeOptions failed with exception: {0}",
J.toString())}}return this.ol}CLi(u,E){const H=this.B3a.result;if(H)try{let I=H[u];I||(I={});I[E]=!1;H[u]=I;this.saveSettings(H)}catch(I){k.ULS.sendTraceTag(36750082,375,10,"DisableCritique failed with exception: {0}",I.toString())}}eqk(u){if(u.rm)return k.ULS.sendTraceTag(34964619,375,10,"Load setting failed with exception {0}",u.Zi),null;if(6===u.status)try{return this.$rl(u.result)}catch(E){k.ULS.sendTraceTag(34964620,375,10,"Parse settings with exception {0}",E.toString())}return null}psk(u){u.rm&&
k.ULS.sendTraceTag(34964621,375,10,"Save setting failed with exception {0}",u.Zi)}static merge(u,E){u=u||{};if(E)for(let J in E){var H=J,I=E[J];u[H]=u[H]||{};for(let T in I)u[H][T]=I[T]}return u}}Object(K.a)(A,"CritiqueTypeSettings",null,[1198])},1028:function(K,Z,d){K=d(0);var k=d(133),e=d(78),n=d(1194),r=d(25),v=d(199),C=d(45),w=d(163),z=d(26),A=d(440),u=d(531);class E{constructor(){this.alt=null;this.height=0;this.src=this.alt="";this.width=this.height=0}}Object(K.a)(E,"ImagePasteArgs",null,[]);
var H=d(324),I=d(41),J=d(46),T=d(28);d.d(Z,"a",function(){return D});class D{constructor(R,Q,W,O,Y,S,da,fa,ka,ha,F,na){this.ia=R;this.Fa=Q;this.vHa=W;this.pa=O;this.pek=Y;this.No=S;this.ila=da;this.He=ha;this.fB=F;this.Bc=na;this.$dc=fa;this.k6c=ka;this.p$c=!1;this.Kec=-1}kQ(R){if(!this.vHa.x8b(this.Fa)||!R)return!1;if(R.zOc&&R.Nbe)return this.p$c=!1,R.kQ=this.$dc;if(!R.tn||0<R.tn.getElementsByTagName(J.a.Pag).length)return!1;this.p$c=!this.uwj(R)&&this.WSj(this.pa.Xd());R.kQ=this.p$c?this.k6c:this.$dc;
return R.kQ}WSj(R){return 1===R.length?R[0].kUj:!1}lFk(R,Q){this.Lbh(R,Q,0);if(!R.firstChild||!R.firstChild.className||!A.a.Qdg(R.firstChild.className))if(!this.No.fg||"<br>"!==R.innerHTML){const W=w.b(R);W&&0<W.length&&(Q.VY=R.innerHTML)}}Lbh(R,Q,W){if(R){if(W>=D.IHc)throw Error.create(String.format("Exceeds the maximum recursions ({0}).",D.IHc));if(1===R.nodeType){var O=R.tagName.toLowerCase();if(this.ila.ZQj(O))R.parentNode.removeChild(R);else{for(let S=R.firstChild;S;S=Y){var Y=S.nextSibling;
this.Lbh(S,Q,W+1)}O===J.a.G8?(R.parentNode.removeChild(R),this.mFk(R,Q)):O===J.a.hNb?(R.parentNode.removeChild(R),this.SFk(R,Q)):O===J.a.listTag&&this.sFk(R);this.Bc.vUe(R,Q.Ub)}}}}sFk(R){if(R){var Q=R.getAttribute("data-"+k.a.CYb);if(Q&&0<Q.length&&R.style){var W=parseInt(Q);if(1!==Q.length||isNaN(W)||1>W||W>H.a.K7)Q="1",W=1;W>this.Kec&&(this.Kec=W);Q=String.format(J.a.DYj,Q);(W=R.style.cssText)?R.setAttribute("style",Q+W):R.setAttribute("style",Q)}if((Q=R.parentNode)&&!this.He.UNj(Q.tagName)){W=
R.nextSibling;const O=this.He.Q0b();O.appendChild(R);Q.insertBefore(O,W)}}}mFk(R,Q){if(R&&R.src&&R.src.length){var W=window.location.href.toLowerCase();W=e.a.pQ(W);if(R.src.startsWith(W))z.a.J(20501650,826,50,"Pasted image src is an empty string.");else{W=Math.ceil(n.a.Me(this.ila.b$i(R),0,!1));var O=Math.ceil(n.a.Me(this.ila.T9i(R),1,!1));Q.kda.push(Object.assign(new E,{src:R.src,alt:R.alt,width:W?W:R.width,height:O?O:R.height}))}}}SFk(R,Q){R&&R.innerHTML&&R.rows&&R.rows.length&&(R.getElementsByTagName(J.a.Vqd).length||
R.getElementsByTagName(J.a.Onl).length)&&(R=w.c(R),!R||0>=R.length||Q.Fkb.push(R))}uwj(R){if(R.zOc)return!0;const Q=R.tn.getElementsByTagName(J.a.hNb).length;return 0<R.tn.getElementsByTagName(J.a.G8).length||0<Q}paste(R){if(r.AFrameworkApplication.LQ)this.pek.Mqc(ResourceStrings.l_GenericDialogTitle,CommonUIStrings.l_NeedToSignIn,null);else{const Q=Object.assign(new u.a,{Ub:R.Ub});let W=!0;Q.pqc=this.p$c;if(R.zOc)Q.kda.push(Object.assign(new E,{src:R.Nbe,width:0,height:0}));else try{this.lFk(R.tn,
Q),0<this.Kec&&(z.a.J(21050954,826,50,String.format("max list level pasted into new shape = {0}.",this.Kec-1)),this.Kec=-1)}catch(O){W=!1,z.a.J(23634591,826,15,O.message)}W&&(this.bcl(Q)?this.Oyk(Q):this.ia.La(T.a.fJa,2,Q))}}bcl(R){return v.a.Wa(R.Fkb)&&C.a.Wa(R.VY)&&!!R.kda&&1===R.kda.length&&this.eVj(R.kda[0].src)}eVj(R){if(C.a.Wa(R)||!R.startsWith("data:image"))return!1;R=R.split(";");if(!R||2!==R.length)return!1;R=R[0].replace("/",".");return 0===this.fB.jud(R,!0)}Oyk(R){let Q=new Image;const W=
R.kda[0],O=I.a.Ib;if(W.width&&W.height)R.wZc=!0,this.ia.La(T.a.fJa,2,R);else{const Y=new Date;Q.onload=()=>{R.nIe=+new Date-+Y;W.width=Q.width;W.height=Q.height;R.wZc=!0;Q=null;I.a.vF(O,()=>{this.ia.La(T.a.fJa,2,R)})};Q.onerror=()=>{Q=null;I.a.vF(O,()=>{this.ia.La(T.a.fJa,2,R)})};Q.src=W.src}}}D.IHc=100;Object(K.a)(D,"HtmlPasteHandler",null,[382])},1029:function(K,Z,d){K=d(0);var k=d(45);class e{constructor(r,v){this.b8j=r;this.z7c=v}get hUa(){return this.b8j}get message(){return this.z7c}}Object(K.a)(e,
"CalloutNotificationError",null,[]);d.d(Z,"a",function(){return n});class n{constructor(r,v){this.frg=r;this.nbk=v}Tfa(r,v,C,w,z,A,u,E,H,I,J,T){this.frg.show(this.nbk,null,!1,H,I,r,v,C,z,w,A,u,E,J,T)}qZd(){this.frg.dismiss()}wuh(r){if(!r)throw Error.argumentNull("CalloutNotificationMessageAttributes");const v=this.NCl(r);if(v&&v.hUa)return v;this.Tfa(r.title,r.message,r.g$f,r.aIb,r.l$f,r.amd,r.zEk,r.F1k,r.AEk,r.G1k,!!r.timeoutInSeconds,r.timeoutInSeconds);return new e(!1,null)}NCl(r){return k.a.Wa(r.title)?
new e(!0,"Invalid Title"):k.a.Wa(r.message)?new e(!0,"Invalid Message"):r.g$f&&k.a.Wa(r.aIb)?new e(!0,"Missing PrimaryButtonLabel"):r.l$f&&k.a.Wa(r.amd)?new e(!0,"Missing SecondaryButtonLabel"):new e(!1,null)}}Object(K.a)(n,"CalloutNotificationAdapter",null,[318])},1030:function(K,Z,d){K=d(0);var k=d(25),e=d(725),n=d(229);class r extends e.a{constructor(C,w){super(C);this.i4j=w}vBh(C){return n.i(n.g(C))}Z_e(C){return n.i(C)}Isc(C){return this.i4j?C.bhi:C.Isc().toString()}Aki(C,w,z){const A=new Sys.StringBuilder;
A.append(String.format('<Menu Id="{0}">',"menuFontColor"));A.append(this.d$d(C,w,z));A.append('<MenuSection Id="More Font Colors"><Controls Id="Color.Menu.Controls">');A.append(String.format('<Button Id="Color.Menu.MoreFontColors" Command="{0}" Image16by16="{1}" Image16by16Class="per_MoreColors_16x16x32" LabelText="{2}" Keytip="{3}" />',"862825906",k.AFrameworkApplication.qm,ResourceStrings.l_MoreFontColors,ResourceStrings.l_MoreFontColorsKeytip));A.append("</Controls> </MenuSection>");A.append("</Menu>");
return A.toString()}}Object(K.a)(r,"ColorMenuBuilder",e.a,[]);d.d(Z,"a",function(){return v});class v{n4i(C){return new e.a(C)}LYf(C,w){return new r(C,w)}}Object(K.a)(v,"ColorPickerBuilderFactory",null,[336])},1032:function(K,Z,d){K=d(0);var k=d(909),e=d(127);class n extends k.a{constructor(){super();this.languageId=null;this.startOfSentence=!1;this.userInitQuery=this.text=null;this.H_=Object.assign(new e.a,{T_:n.getTypeName(),B_:n.getBaseTypes()})}static getTypeName(){return"AugLoop_Signals_TextPredictorSignalBase"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}}
Object(K.a)(n,"TextPredictorSignalBase",k.a,[]);d.d(Z,"a",function(){return r});class r extends n{constructor(){super();this.H_=Object.assign(new e.a,{T_:r.getTypeName(),B_:r.getBaseTypes()})}static getTypeName(){return"AugLoop_Signals_TextPredictorSignal"}static getBaseTypes(){return["AugLoop_Signals_TextPredictorSignalBase","AugLoop_Signals_Signal"]}}Object(K.a)(r,"TextPredictorSignal",n,[])},1033:function(K,Z,d){K=d(0);var k=d(382),e=d(95),n=d(1114),r=d.n(n),v=d(45),C=d(25);d.d(Z,"a",function(){return w});
class w{static Dnd(z,A,u){if(z&&u&&(e.a.aCa(z),A&&""!==A))try{if(v.a.Wa("HtmlStringSanitizeByDomPurify"))var E=!1;else{var H=C.AFrameworkApplication.fa.Ha("PPTDisabledChangeGates");if(H){var I=H.split(";");E=I&&0<I.length?0>Array.indexOf(I,"HtmlStringSanitizeByDomPurify"):!0}else E=!1}E&&(A=r.a.sanitize(A));const J=w.EPh.parseFromString(A,"text/html");if(J&&J.body){const T=J.body.childNodes;for(A=0;A<T.length;A+=1)z.appendChild(T[A].cloneNode(!0))}}catch(J){k.ULS.sendTraceTag(523106530,324,10,"In class: {0}, unable to parse HTML, {1}",
u,J.message)}}}w.EPh=new DOMParser;Object(K.a)(w,"DOMParserHelper",null,[])},109:function(K,Z,d){d.d(Z,"a",function(){return e});K=d(0);var k=d(1214);class e{constructor(){this.J8a=this.azf=this.l3=this.uaa=this.GHc=this.hQc=this.wvb=this.zDa=this.WZ=this.BJc=this.Urd=null}Qf(n){this.Urd=new k.a;this.Urd.value=n}dpc(){this.BJc=new k.a;this.BJc.value=!0}UU(n){this.hQc=new k.a;this.hQc.value=n}}Object(K.a)(e,"QueryResult",null,[])},1097:function(K,Z,d){d.d(Z,"a",function(){return e});K=d(0);var k=d(95);
class e{constructor(n){this.Bxd=n.cloneNode(!0);this.mif=n}restore(){for(k.a.tu(this.mif);this.Bxd.firstChild;){const n=this.Bxd.firstChild;k.a.XO(n);this.mif.appendChild(n)}this.Bxd=null}}Object(K.a)(e,"DomElementContentState",null,[])},1098:function(K,Z,d){d.r(Z);d.d(Z,"SpellingRequestObjectUpdatedV2",function(){return n});K=d(0);var k=d(658),e=d(657);class n extends k.a{constructor(){super();this.ProofingEngine=0;this.UseContextualResults=!1;this.TextUnit=0;this.Descriptors=this.OverriddenCritiqueTypeOptions=
null;this.UxLcid=0}static y3d(r,v){const C=new n;k.a.hJe(C,r,v);C.UserActionType=e.a[r.userAction];C.ProofingEngine=r.xfa;C.Descriptors=r.descriptors;C.OverriddenCritiqueTypeOptions=r.overriddenCritiqueTypeOptions;C.UxLcid=r.VHh;2===r.xfa?C.TextUnit=r.range.textUnit:1===r.xfa&&(C.UseContextualResults=!0);return C}}Object(K.a)(n,"SpellingRequestObjectUpdatedV2",k.a,[])},1099:function(K,Z,d){d.r(Z);d.d(Z,"SpellingRequestObjectUpdated",function(){return n});K=d(0);var k=d(658),e=d(657);class n extends k.a{constructor(){super();
this.UseContextualResults=this.TrackMetrics=this.UseOneSpeller=!1;this.ExperimentId=null}static y3d(r,v,C,w,z,A){const u=new n;k.a.hJe(u,r,v);u.UserActionType=e.a[r.userAction];u.UseOneSpeller=C;u.TrackMetrics=w;u.UseContextualResults=z;A&&(u.ExperimentId=A);return u}}Object(K.a)(n,"SpellingRequestObjectUpdated",k.a,[])},1100:function(K,Z,d){d.r(Z);d.d(Z,"ReactOICErrorDialogWithTrial",function(){return r});K=d(0);var k=d(13);Z=d(915);var e=d(195),n=d(80);class r extends Z.a{constructor(v,C,w,z,A,
u){super(v,C,w,z,A,u);C={["errorMessage"]:this.OQf,["offerString"]:this.t0g};v=new n.a(!1,!1,!0);this.Quh?(v.xd=1,C.helpLink={["type"]:"AppLinkProps",["id"]:"helpLink",["text"]:this.BTa,["onExecute"]:()=>{e.Redirect.showHelp(this.B$f)}}):(v.xd=4,v.Xe(2,this.Cag));v.Xe(1,this.ypf);v.ig=this.id;C={["id"]:this.id,["dialogIcon"]:this.icon,["bodyControls"]:C};v.$i(this.$Qa,Object(k.a)(this,this.BLk,"reactOICErrorDialogWithTrialHandler"),C)}}Object(K.a)(r,"ReactOICErrorDialogWithTrial",Z.a,[])},1101:function(K,
Z,d){d.r(Z);d.d(Z,"OICErrorDialogWithTrial",function(){return n});K=d(0);var k=d(13);Z=d(915);var e=d(106);class n extends Z.a{constructor(r,v,C,w,z,A){super(r,v,C,w,z,A);r=document.createElement("span");r.innerText=this.OQf;r.appendChild(document.createElement("br"));r.appendChild(document.createElement("br"));v=document.createElement("span");v.innerText=this.t0g;r.appendChild(v);v=new e.StandardDialog;this.Quh?(v.xd=1,v.oNd(this.BTa,this.B$f)):(v.xd=4,v.Xe(2,this.Cag));v.Xe(1,this.ypf);v.ig=this.id;
v.Bx(this.$Qa,null,this.icon,Object(k.a)(this,this.eYj,"legacyOICErrorDialogWithTrialHandler"),r)}}Object(K.a)(n,"OICErrorDialogWithTrial",Z.a,[])},1102:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k{constructor(){this.keytip=this.id=this.image=this.label=this.command=null}}Object(K.a)(k,"HeaderButtonInfo",null,[])},1103:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k{constructor(){this.ariaDescription=this.onExecute=this.label=null}}Object(K.a)(k,"CalloutButtonProps",
null,[])},1104:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k{constructor(){this.y=this.x=0}}Object(K.a)(k,"IPoint",null,[])},1105:function(K,Z,d){d.d(Z,"a",function(){return e});K=d(0);var k=d(25);d=d(76);class e{static $8h(n){e.e5e.addHandler(e.BEf,n)}static CIk(n){k.AFrameworkApplication.fa.ka("SqmCommandEventSourceEnabled")&&e.e5e.raiseEvent(e.BEf,n)}}e.BEf="CommandClickEvent";e.e5e=new d.a;Object(K.a)(e,"CommandClickEvents",null,[])},1106:function(K,Z,d){d.d(Z,"a",function(){return k});
K=d(0);class k{}k.Image16by16Class="Image16by16Class";k.Image32by32Class="Image32by32Class";k.On="On";k.LabelText="LabelText";k.ApplyLabelTextToControlOnly="ApplyLabelTextToControlOnly";k.EnsureControlRoleIsButton="EnsureControlRoleIsButton";k.Visible="Visible";Object(K.a)(k,"SplitButtonCommandProperties",null,[])},1107:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k{constructor(e,n=null,r=null,v=null){this.iconSet={};this.iconSet["default"]=e;this.iconSet.icon16=n;this.iconSet.icon24=
r;this.iconSet.icon32=v}}Object(K.a)(k,"IconSetContainer",null,[])},1108:function(K,Z,d){d.r(Z);d.d(Z,"NewCustomEventFactory",function(){return k});K=d(0);d=d(529);class k extends d.a{constructor(){super()}create(e,n){const r={};r.detail=n;return new CustomEvent(e,r)}}Object(K.a)(k,"NewCustomEventFactory",d.a,[])},1109:function(K,Z,d){d.r(Z);d.d(Z,"IECustomEventFactory",function(){return k});K=d(0);d=d(529);class k extends d.a{constructor(){super()}create(e,n){const r=window.document.createEvent("CustomEvent");
r.initCustomEvent(e,!1,!1,n);return r}}Object(K.a)(k,"IECustomEventFactory",d.a,[])},1110:function(K,Z,d){d.r(Z);d.d(Z,"CheckRoamingRightsRequest",function(){return k});K=d(0);d=d(945);class k extends d.a{constructor(){super()}Ewb(){return 2}$k(){return 1}}Object(K.a)(k,"CheckRoamingRightsRequest",d.a,[])},1111:function(K,Z,d){d.r(Z);d.d(Z,"GetRoamingLauncherRequest",function(){return k});K=d(0);d=d(945);class k extends d.a{constructor(){super()}Ewb(){return 0}$k(){return 2}}Object(K.a)(k,"GetRoamingLauncherRequest",
d.a,[])},1112:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);d=d(351);class k extends d.a{constructor(){super();this.LargePreviewIconStyle=this.PreviewIconStyle=this.FullIconStyle=this.Icon=null}get Type(){return 4}}Object(K.a)(k,"IconGalleryButtonProps",d.a,[])},1113:function(K,Z,d){d.d(Z,"a",function(){return n});K=d(0);var k=d(198),e=d(93);class n{constructor(r){this.Xv=r;this.VM=Array.indexOf(this.Xv,this.zja)}dispose(){this.Xv=null}get $Z(){return this.Xv[this.VM]}VE(r){this.epc(r,!1);
return!0}F8a(r){this.epc(r,!0)}epc(r,v){r&&(this.$Z!==r||v)&&(r.tabIndex=0,e.FocusManager.Sr(r));Array.contains(this.Xv,r)&&(this.VM=Array.indexOf(this.Xv,r))}get ibh(){let r=this.VM;do if(r)if(0<r&&r<this.Xv.length)r--;else break;else r=this.Xv.length-1;while(!k.DOMFocusListing.ZCa(this.Xv[r])&&r!==this.VM);return this.Xv[r]}get j_g(){let r=this.VM;do if(r===this.Xv.length-1)r=0;else if(0<=r&&r<this.Xv.length-1)r++;else break;while(!k.DOMFocusListing.ZCa(this.Xv[r])&&r!==this.VM);return this.Xv[r]}get zja(){let r=
0;for(;!k.DOMFocusListing.ZCa(this.Xv[r])&&r<this.Xv.length;)r++;return k.DOMFocusListing.ZCa(this.Xv[r])?this.Xv[r]:null}get Xzb(){let r=this.Xv.length-1;for(;!k.DOMFocusListing.ZCa(this.Xv[r])&&0<r;)r--;return k.DOMFocusListing.ZCa(this.Xv[r])?this.Xv[r]:null}}Object(K.a)(n,"DialogFocusListing",null,[221])},1114:function(K){(function(Z,d){K.exports=d()})(this,function(){function Z(kb,jb){if("object"!==d(kb)||"function"!==typeof kb.createPolicy)return null;var hb=null;jb.currentScript&&jb.currentScript.hasAttribute("data-tt-policy-suffix")&&
(hb=jb.currentScript.getAttribute("data-tt-policy-suffix"));jb="dompurify"+(hb?"#"+hb:"");try{return kb.createPolicy(jb,{createHTML:function(uc){return uc},createScriptURL:function(uc){return uc}})}catch(uc){return console.warn("TrustedTypes policy "+jb+" could not be created."),null}}function d(kb){"@babel/helpers - typeof";return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(jb){return typeof jb}:function(jb){return jb&&"function"==typeof Symbol&&jb.constructor===Symbol&&
jb!==Symbol.prototype?"symbol":typeof jb},d(kb)}function k(kb,jb){k=Object.setPrototypeOf||function(hb,uc){hb.__proto__=uc;return hb};return k(kb,jb)}function e(){if("undefined"===typeof Reflect||!Reflect.construct||Reflect.construct.XIl)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(kb){return!1}}function n(kb,jb,hb){n=e()?Reflect.construct:function(uc,mc,Ya){var Mb=[null];Mb.push.apply(Mb,mc);uc=new (Function.bind.apply(uc,
Mb));Ya&&k(uc,Ya.prototype);return uc};return n.apply(null,arguments)}function r(kb){var jb=Array.isArray(kb)?v(kb):void 0;jb||(jb="undefined"!==typeof Symbol&&null!=kb[Symbol.iterator]||null!=kb["@@iterator"]?Array.from(kb):void 0);if(!jb)a:{if(kb){if("string"===typeof kb){jb=v(kb,void 0);break a}jb=Object.prototype.toString.call(kb).slice(8,-1);"Object"===jb&&kb.constructor&&(jb=kb.constructor.name);if("Map"===jb||"Set"===jb){jb=Array.from(kb);break a}if("Arguments"===jb||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(jb)){jb=
v(kb,void 0);break a}}jb=void 0}if(!(kb=jb))throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");return kb}function v(kb,jb){if(null==jb||jb>kb.length)jb=kb.length;for(var hb=0,uc=Array(jb);hb<jb;hb++)uc[hb]=kb[hb];return uc}function C(kb){return function(jb){for(var hb=arguments.length,uc=Array(1<hb?hb-1:0),mc=1;mc<hb;mc++)uc[mc-1]=arguments[mc];return O(kb,jb,uc)}}function w(kb,jb,hb){hb=hb?hb:
ka;H&&H(kb,null);for(var uc=jb.length;uc--;){var mc=jb[uc];if("string"===typeof mc){var Ya=hb(mc);Ya!==mc&&(I(jb)||(jb[uc]=Ya),mc=Ya)}kb[mc]=!0}return kb}function z(kb){var jb=Q(null),hb;for(hb in kb)O(E,kb,[hb])&&(jb[hb]=kb[hb]);return jb}function A(kb,jb){for(;null!==kb;){var hb=T(kb,jb);if(hb){if(hb.get)return C(hb.get);if("function"===typeof hb.value)return C(hb.value)}kb=J(kb)}return function(uc){console.warn("fallback value for",uc);return null}}function u(){function kb(jc){var be,Md;hb("beforeSanitizeAttributes",
jc,null);var de=jc.attributes;if(de){var Zc={attrName:"",Dwf:"",Zlg:!0,RGl:Jd};for(Md=de.length;Md--;){var Yf=be=de[Md],Vc=Yf.name;Yf=Yf.namespaceURI;be="value"===Vc?be.value:Ea(be.value);var zc=Oe(Vc);Zc.attrName=zc;Zc.Dwf=be;Zc.Zlg=!0;Zc.sZi=void 0;hb("uponSanitizeAttribute",jc,Zc);be=Zc.Dwf;if(!Zc.sZi&&(Mb(Vc,jc),Zc.Zlg))if(La(/\/>/i,be))Mb(Vc,jc);else{Fd&&(be=na(be,Ab," "),be=na(be,Xb," "),be=na(be,vb," "));var vf=Oe(jc.nodeName);a:{var Tg=vf;var bb=zc,Vb=be;if(Fc&&("id"===bb||"name"===bb)&&(Vb in
rb||Vb in ce))Tg=!1;else{if(!Lc||sb[bb]||!La($c,bb))if(!ec||!La(fd,bb))if(!Jd[bb]||sb[bb]){if(!(0<Tg.indexOf("-")&&(ee.v1 instanceof RegExp&&La(ee.v1,Tg)||ee.v1 instanceof Function&&ee.v1(Tg))&&(ee.$5a instanceof RegExp&&La(ee.$5a,bb)||ee.$5a instanceof Function&&ee.$5a(bb))||"is"===bb&&ee.oGc&&(ee.v1 instanceof RegExp&&La(ee.v1,Vb)||ee.v1 instanceof Function&&ee.v1(Vb)))){Tg=!1;break a}}else if(!(hg[bb]||La(Pd,na(Vb,gd,""))||("src"===bb||"xlink:href"===bb||"href"===bb)&&"script"!==Tg&&0===ba(Vb,
"data:")&&Hf[Tg]||nd&&!La(Bd,na(Vb,gd,"")))&&Vb){Tg=!1;break a}Tg=!0}}if(Tg){!Ze||"id"!==zc&&"name"!==zc||(Mb(Vc,jc),be="user-content-"+be);if(ye&&"object"===d(Lb)&&"function"===typeof Lb.getAttributeType&&!Yf)switch(Lb.getAttributeType(vf,zc)){case "TrustedHTML":be=ye.createHTML(be);break;case "TrustedScriptURL":be=ye.createScriptURL(be)}try{Yf?jc.setAttributeNS(Yf,Vc,be):jc.setAttribute(Vc,be),da(Tb.removed)}catch(Ub){}}}}hb("afterSanitizeAttributes",jc,null)}}function jb(jc){hb("beforeSanitizeElements",
jc,null);if(jc instanceof cb&&("string"!==typeof jc.nodeName||"string"!==typeof jc.textContent||"function"!==typeof jc.removeChild||!(jc.attributes instanceof Zb)||"function"!==typeof jc.removeAttribute||"function"!==typeof jc.setAttribute||"string"!==typeof jc.namespaceURI||"function"!==typeof jc.insertBefore||"function"!==typeof jc.hasChildNodes)||La(/[\u0080-\uFFFF]/,jc.nodeName))return Kc(jc),!0;var be=Oe(jc.nodeName);hb("uponSanitizeElement",jc,{tagName:be,SGl:cd});if(!(!jc.hasChildNodes()||
uc(jc.firstElementChild)||uc(jc.content)&&uc(jc.content.firstElementChild))&&La(/<[/\w]/g,jc.innerHTML)&&La(/<[/\w]/g,jc.textContent)||"select"===be&&La(/<template/i,jc.innerHTML))return Kc(jc),!0;if(!cd[be]||Ra[be]){if(!Ra[be]&&0<be.indexOf("-")&&(ee.v1 instanceof RegExp&&La(ee.v1,be)||ee.v1 instanceof Function&&ee.v1(be)))return!1;if(df&&!Kf[be]){be=od(jc)||jc.parentNode;var Md=bd(jc)||jc.childNodes;if(Md&&be)for(var de=Md.length-1;0<=de;--de)be.insertBefore(pc(Md[de],!0),fc(jc))}Kc(jc);return!0}if(Md=
jc instanceof Ad){(Md=od(jc))&&Md.tagName||(Md={namespaceURI:nf,tagName:"template"});de=ka(jc.tagName);var Zc=ka(Md.tagName);Md=!(If[jc.namespaceURI]&&("http://www.w3.org/2000/svg"===jc.namespaceURI?"http://www.w3.org/1999/xhtml"===Md.namespaceURI?"svg"===de:"http://www.w3.org/1998/Math/MathML"===Md.namespaceURI?"svg"===de&&("annotation-xml"===Zc||me[Zc]):Tf[de]:"http://www.w3.org/1998/Math/MathML"===jc.namespaceURI?"http://www.w3.org/1999/xhtml"===Md.namespaceURI?"math"===de:"http://www.w3.org/2000/svg"===
Md.namespaceURI?"math"===de&&Je[Zc]:He[de]:"http://www.w3.org/1999/xhtml"===jc.namespaceURI?"http://www.w3.org/2000/svg"===Md.namespaceURI&&!Je[Zc]||"http://www.w3.org/1998/Math/MathML"===Md.namespaceURI&&!me[Zc]?0:!He[de]&&(ie[de]||!Tf[de]):"application/xhtml+xml"===pf&&If[jc.namespaceURI]))}if(Md||("noscript"===be||"noembed"===be)&&La(/<\/no(script|embed)/i,jc.innerHTML))return Kc(jc),!0;Fd&&3===jc.nodeType&&(be=jc.textContent,be=na(be,Ab," "),be=na(be,Xb," "),be=na(be,vb," "),jc.textContent!==
be&&(fa(Tb.removed,{element:jc.cloneNode()}),jc.textContent=be));hb("afterSanitizeElements",jc,null);return!1}function hb(jc,be,Md){Wb[jc]&&S(Wb[jc],function(de){de.call(Tb,be,Md,Ag)})}function uc(jc){return"object"===d(wb)?jc instanceof wb:jc&&"object"===d(jc)&&"number"===typeof jc.nodeType&&"string"===typeof jc.nodeName}function mc(jc){return Yb.call(jc.ownerDocument||jc,jc,bc.SHOW_ELEMENT|bc.SHOW_COMMENT|bc.SHOW_TEXT,null,!1)}function Ya(jc){if(db)jc="<remove></remove>"+jc;else var be=(be=F(jc,
/^[\r\n\t ]+/))&&be[0];"application/xhtml+xml"===pf&&"http://www.w3.org/1999/xhtml"===nf&&(jc='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+jc+"</body></html>");var Md=ye?ye.createHTML(jc):jc;if("http://www.w3.org/1999/xhtml"===nf)try{var de=(new Xa).parseFromString(Md,pf)}catch(Zc){}if(!de||!de.documentElement){de=ab.createDocument(nf,"template",null);try{de.documentElement.innerHTML=kd?"":Md}catch(Zc){}}Md=de.body||de.documentElement;jc&&be&&Md.insertBefore(rb.createTextNode(be),
Md.childNodes[0]||null);return"http://www.w3.org/1999/xhtml"===nf?Jb.call(de,Ja?"html":"body")[0]:Ja?de.documentElement:Md}function Mb(jc,be){try{fa(Tb.removed,{attribute:be.getAttributeNode(jc),from:be})}catch(Md){fa(Tb.removed,{attribute:null,from:be})}be.removeAttribute(jc);if("is"===jc&&!Jd[jc])if(ic||id)try{Kc(be)}catch(Md){}else try{be.setAttribute(jc,"")}catch(Md){}}function Kc(jc){fa(Tb.removed,{element:jc});try{jc.parentNode.removeChild(jc)}catch(be){try{jc.outerHTML=pd}catch(Md){jc.remove()}}}
function eb(jc){return jc instanceof RegExp||jc instanceof Function}function Tb(jc){return u(jc)}var lb=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"undefined"===typeof window?null:window;Tb.version="2.4.1";Tb.removed=[];if(!lb||!lb.document||9!==lb.document.nodeType)return Tb.k_c=!1,Tb;var Fb=lb.document,rb=lb.document,Qb=lb.DocumentFragment,Bc=lb.HTMLTemplateElement,wb=lb.Node,Ad=lb.Element,bc=lb.NodeFilter,Sb=lb.NamedNodeMap,Zb=void 0===Sb?lb.NamedNodeMap||lb.AGl:Sb,cb=lb.HTMLFormElement,
Xa=lb.DOMParser,Lb=lb.trustedTypes;Sb=Ad.prototype;var pc=A(Sb,"cloneNode"),fc=A(Sb,"nextSibling"),bd=A(Sb,"childNodes"),od=A(Sb,"parentNode");"function"===typeof Bc&&(Bc=rb.createElement("template"),Bc.content&&Bc.content.ownerDocument&&(rb=Bc.content.ownerDocument));var ye=Z(Lb,Fb),pd=ye?ye.createHTML(""):"";Bc=rb;var ab=Bc.implementation,Yb=Bc.createNodeIterator,Sc=Bc.createDocumentFragment,Jb=Bc.getElementsByTagName,Oc=Fb.importNode;Bc={};try{Bc=z(rb).documentMode?rb.documentMode:{}}catch(jc){}var Wb=
{};Tb.k_c="function"===typeof od&&ab&&"undefined"!==typeof ab.createHTMLDocument&&9!==Bc;var Ab=ua,Xb=za,vb=Wa,$c=yb,fd=Za,Bd=Ib,gd=Ob,Pd=ub,cd=null,lf=w({},[].concat(r(oa),r(wa),r(ra),r(Da),r(la))),Jd=null,Xf=w({},[].concat(r(Fa),r(Qa),r(Sa),r(Na))),ee=Object.seal(Object.create(null,{v1:{writable:!0,configurable:!1,enumerable:!0,value:null},$5a:{writable:!0,configurable:!1,enumerable:!0,value:null},oGc:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Ra=null,sb=null,ec=!0,Lc=!0,nd=!1,Fd=!1,
Ja=!1,db=!1,ic=!1,id=!1,qd=!1,Fc=!0,Ze=!1,df=!0,ve=!1,md={},Kf=null,oe=w({},"annotation-xml audio colgroup desc foreignobject head iframe math mi mn mo ms mtext noembed noframes noscript plaintext script style svg template thead title video xmp".split(" ")),Hf=null,xb=w({},"audio video img source image track".split(" ")),hg=null,rf=w({},"alt class for id label name pattern placeholder role summary title value style xmlns".split(" ")),nf="http://www.w3.org/1999/xhtml",kd=!1,If=null,og=w({},["http://www.w3.org/1998/Math/MathML",
"http://www.w3.org/2000/svg","http://www.w3.org/1999/xhtml"],ha),pf,ig=["application/xhtml+xml","text/html"],Oe,Ag=null,ce=rb.createElement("form"),me=w({},["mi","mo","mn","ms","mtext"]),Je=w({},["foreignobject","desc","title","annotation-xml"]),ie=w({},["title","style","font","a","script"]),Tf=w({},wa);w(Tf,ra);w(Tf,ya);var He=w({},Da);w(He,pa);var Sg=function Md(be){var de,Zc=mc(be);for(hb("beforeSanitizeShadowDOM",be,null);de=Zc.nextNode();)hb("uponSanitizeShadowNode",de,null),jb(de)||(de.content instanceof
Qb&&Md(de.content),kb(de));hb("afterSanitizeShadowDOM",be,null)};Tb.sanitize=function(be){var Md=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};(kd=!be)&&(be="\x3c!--\x3e");if("string"!==typeof be&&!uc(be)){if("function"!==typeof be.toString)throw ta("toString is not a function");be=be.toString();if("string"!==typeof be)throw ta("dirty is not a string, aborting");}if(!Tb.k_c){if("object"===d(lb.b0e)||"function"===typeof lb.b0e){if("string"===typeof be)return lb.b0e(be);if(uc(be))return lb.b0e(be.outerHTML)}return be}Ag&&
Ag===Md||(Md&&"object"===d(Md)||(Md={}),Md=z(Md),pf=-1===ig.indexOf(Md.SKh)?pf="text/html":pf=Md.SKh,Oe="application/xhtml+xml"===pf?ha:ka,cd="ALLOWED_TAGS"in Md?w({},Md.eGl,Oe):lf,Jd="ALLOWED_ATTR"in Md?w({},Md.cGl,Oe):Xf,If="ALLOWED_NAMESPACES"in Md?w({},Md.dGl,ha):og,hg="ADD_URI_SAFE_ATTR"in Md?w(z(rf),Md.D4e,Oe):rf,Hf="ADD_DATA_URI_TAGS"in Md?w(z(xb),Md.bGl,Oe):xb,Kf="FORBID_CONTENTS"in Md?w({},Md.L4e,Oe):oe,Ra="FORBID_TAGS"in Md?w({},Md.vGl,Oe):{},sb="FORBID_ATTR"in Md?w({},Md.uGl,Oe):{},md=
"USE_PROFILES"in Md?Md.KGl:!1,ec=!1!==Md.gGl,Lc=!1!==Md.hGl,nd=Md.iGl||!1,Fd=Md.FGl||!1,Ja=Md.LGl||!1,ic=Md.CGl||!1,id=Md.DGl||!1,qd=Md.EGl||!1,db=Md.wGl||!1,Fc=!1!==Md.GGl,Ze=Md.HGl||!1,df=!1!==Md.yGl,ve=Md.xGl||!1,Pd=Md.fGl||Pd,nf=Md.BGl||"http://www.w3.org/1999/xhtml",Md.kMa&&eb(Md.kMa.v1)&&(ee.v1=Md.kMa.v1),Md.kMa&&eb(Md.kMa.$5a)&&(ee.$5a=Md.kMa.$5a),Md.kMa&&"boolean"===typeof Md.kMa.oGc&&(ee.oGc=Md.kMa.oGc),Fd&&(Lc=!1),id&&(ic=!0),md&&(cd=w({},r(la)),Jd=[],!0===md.html&&(w(cd,oa),w(Jd,Fa)),!0===
md.Tml&&(w(cd,wa),w(Jd,Qa),w(Jd,Na)),!0===md.dJl&&(w(cd,ra),w(Jd,Qa),w(Jd,Na)),!0===md.VHl&&(w(cd,Da),w(Jd,Sa),w(Jd,Na))),Md.OJh&&(cd===lf&&(cd=z(cd)),w(cd,Md.OJh,Oe)),Md.NJh&&(Jd===Xf&&(Jd=z(Jd)),w(Jd,Md.NJh,Oe)),Md.D4e&&w(hg,Md.D4e,Oe),Md.L4e&&(Kf===oe&&(Kf=z(Kf)),w(Kf,Md.L4e,Oe)),df&&(cd["#text"]=!0),Ja&&w(cd,["html","head","body"]),cd.table&&(w(cd,["tbody"]),delete Ra.oAh),D&&D(Md),Ag=Md);Tb.removed=[];"string"===typeof be&&(ve=!1);if(ve){if(be.nodeName&&(Md=Oe(be.nodeName),!cd[Md]||Ra[Md]))throw ta("root node is forbidden and cannot be sanitized in-place");
}else if(be instanceof wb){var de=Ya("\x3c!----\x3e");Md=de.ownerDocument.importNode(be,!0);1===Md.nodeType&&"BODY"===Md.nodeName?de=Md:"HTML"===Md.nodeName?de=Md:de.appendChild(Md)}else{if(!ic&&!Fd&&!Ja&&-1===be.indexOf("<"))return ye&&qd?ye.createHTML(be):be;de=Ya(be);if(!de)return ic?null:qd?pd:""}de&&db&&Kc(de.firstChild);for(var Zc=mc(ve?be:de);Md=Zc.nextNode();)if((3!==Md.nodeType||Md!==Yf)&&!jb(Md)){Md.content instanceof Qb&&Sg(Md.content);kb(Md);var Yf=Md}if(ve)return be;if(ic){if(id)for(Yf=
Sc.call(de.ownerDocument);de.firstChild;)Yf.appendChild(de.firstChild);else Yf=de;Jd.WIl&&(Yf=Oc.call(Fb,Yf,!0));return Yf}Yf=Ja?de.outerHTML:de.innerHTML;Ja&&cd["!doctype"]&&de.ownerDocument&&de.ownerDocument.doctype&&de.ownerDocument.doctype.name&&La(Hc,de.ownerDocument.doctype.name)&&(Yf="<!DOCTYPE "+de.ownerDocument.doctype.name+">\n"+Yf);Fd&&(Yf=na(Yf,Ab," "),Yf=na(Yf,Xb," "),Yf=na(Yf,vb," "));return ye&&qd?ye.createHTML(Yf):Yf};return Tb}var E=Object.hasOwnProperty,H=Object.setPrototypeOf,I=
Object.isFrozen,J=Object.getPrototypeOf,T=Object.getOwnPropertyDescriptor,D=Object.freeze,R=Object.seal,Q=Object.create,W="undefined"!==typeof Reflect&&Reflect,O=W.apply,Y=W.construct;O||(O=function(kb,jb,hb){return kb.apply(jb,hb)});D||(D=function(kb){return kb});R||(R=function(kb){return kb});Y||(Y=function(kb,jb){return n(kb,r(jb))});var S=C(Array.prototype.forEach),da=C(Array.prototype.pop),fa=C(Array.prototype.push),ka=C(String.prototype.toLowerCase),ha=C(String.prototype.toString),F=C(String.prototype.match),
na=C(String.prototype.replace),ba=C(String.prototype.indexOf),Ea=C(String.prototype.trim),La=C(RegExp.prototype.test),ta=function(kb){return function(){for(var jb=arguments.length,hb=Array(jb),uc=0;uc<jb;uc++)hb[uc]=arguments[uc];return Y(kb,hb)}}(TypeError),oa=D("a abbr acronym address area article aside audio b bdi bdo big blink blockquote body br button canvas caption center cite code col colgroup content data datalist dd decorator del details dfn dialog dir div dl dt element em fieldset figcaption figure font footer form h1 h2 h3 h4 h5 h6 head header hgroup hr html i img input ins kbd label legend li main map mark marquee menu menuitem meter nav nobr ol optgroup option output p picture pre progress q rp rt ruby s samp section select shadow small source spacer span strike strong style sub summary sup table tbody td template textarea tfoot th thead time tr track tt u ul var video wbr".split(" ")),
wa=D("svg a altglyph altglyphdef altglyphitem animatecolor animatemotion animatetransform circle clippath defs desc ellipse filter font g glyph glyphref hkern image line lineargradient marker mask metadata mpath path pattern polygon polyline radialgradient rect stop style switch symbol text textpath title tref tspan view vkern".split(" ")),ra=D("feBlend feColorMatrix feComponentTransfer feComposite feConvolveMatrix feDiffuseLighting feDisplacementMap feDistantLight feFlood feFuncA feFuncB feFuncG feFuncR feGaussianBlur feImage feMerge feMergeNode feMorphology feOffset fePointLight feSpecularLighting feSpotLight feTile feTurbulence".split(" ")),
ya=D("animate color-profile cursor discard fedropshadow font-face font-face-format font-face-name font-face-src font-face-uri foreignobject hatch hatchpath mesh meshgradient meshpatch meshrow missing-glyph script set solidcolor unknown use".split(" ")),Da=D("math menclose merror mfenced mfrac mglyph mi mlabeledtr mmultiscripts mn mo mover mpadded mphantom mroot mrow ms mspace msqrt mstyle msub msup msubsup mtable mtd mtext mtr munder munderover".split(" ")),pa=D("maction maligngroup malignmark mlongdiv mscarries mscarry msgroup mstack msline msrow semantics annotation annotation-xml mprescripts none".split(" ")),
la=D(["#text"]),Fa=D("accept action align alt autocapitalize autocomplete autopictureinpicture autoplay background bgcolor border capture cellpadding cellspacing checked cite class clear color cols colspan controls controlslist coords crossorigin datetime decoding default dir disabled disablepictureinpicture disableremoteplayback download draggable enctype enterkeyhint face for headers height hidden high href hreflang id inputmode integrity ismap kind label lang list loading loop low max maxlength media method min minlength multiple muted name nonce noshade novalidate nowrap open optimum pattern placeholder playsinline poster preload pubdate radiogroup readonly rel required rev reversed role rows rowspan spellcheck scope selected shape size sizes span srclang start src srcset step style summary tabindex title translate type usemap valign value width xmlns slot".split(" ")),
Qa=D("accent-height accumulate additive alignment-baseline ascent attributename attributetype azimuth basefrequency baseline-shift begin bias by class clip clippathunits clip-path clip-rule color color-interpolation color-interpolation-filters color-profile color-rendering cx cy d dx dy diffuseconstant direction display divisor dur edgemode elevation end fill fill-opacity fill-rule filter filterunits flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight fx fy g1 g2 glyph-name glyphref gradientunits gradienttransform height href id image-rendering in in2 k k1 k2 k3 k4 kerning keypoints keysplines keytimes lang lengthadjust letter-spacing kernelmatrix kernelunitlength lighting-color local marker-end marker-mid marker-start markerheight markerunits markerwidth maskcontentunits maskunits max mask media method mode min name numoctaves offset operator opacity order orient orientation origin overflow paint-order path pathlength patterncontentunits patterntransform patternunits points preservealpha preserveaspectratio primitiveunits r rx ry radius refx refy repeatcount repeatdur restart result rotate scale seed shape-rendering specularconstant specularexponent spreadmethod startoffset stddeviation stitchtiles stop-color stop-opacity stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke stroke-width style surfacescale systemlanguage tabindex targetx targety transform transform-origin text-anchor text-decoration text-rendering textlength type u1 u2 unicode values viewbox visibility version vert-adv-y vert-origin-x vert-origin-y width word-spacing wrap writing-mode xchannelselector ychannelselector x x1 x2 xmlns y y1 y2 z zoomandpan".split(" ")),
Sa=D("accent accentunder align bevelled close columnsalign columnlines columnspan denomalign depth dir display displaystyle encoding fence frame height href id largeop length linethickness lspace lquote mathbackground mathcolor mathsize mathvariant maxsize minsize movablelimits notation numalign open rowalign rowlines rowspacing rowspan rspace rquote scriptlevel scriptminsize scriptsizemultiplier selection separator separators stretchy subscriptshift supscriptshift symmetric voffset width xmlns".split(" ")),
Na=D(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),ua=R(/\{\{[\w\W]*|[\w\W]*\}\}/gm),za=R(/<%[\w\W]*|[\w\W]*%>/gm),Wa=R(/\${[\w\W]*}/gm),yb=R(/^data-[\-\w.\u00B7-\uFFFF]/),Za=R(/^aria-[\-\w]+$/),ub=R(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),Ib=R(/^(?:\w+script|data):/i),Ob=R(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Hc=R(/^html$/i);return u()})},1115:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k{constructor(){this.InsertionPoint=
this.GalleryButtons=this.Title=this.SectionId=null}}Object(K.a)(k,"GallerySectionProps",null,[])},1116:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);d=d(302);class k{}k.Value="Value";k.Image16by16Class="Image16by16Class";k.Alt="Alt";k.Visible=d.a.visible;Object(K.a)(k,"LabelCommandProperties",null,[])},1125:function(K,Z,d){d.r(Z);K=d(0);var k=d(382),e=d(13),n=d(1186),r=d(25),v=d(140),C=d(455),w=d(267),z=d(196),A=d(55),u=d(71),E=d(35);class H{constructor(eb,Tb,lb,Fb,rb){this.cFd=null;this.yP=
!0;this.rP=null;this.Ca=eb;this.Rh=Tb;this.jyd=lb;this.OZh=Fb;this.Vg=rb;r.AFrameworkApplication.FFc(Object(e.a)(this,this.Xyl,"updateLastError"));this.OZh.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1)?(this.yP=r.AFrameworkApplication.OE,A.a.instance.Ja("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(Qb=>{Qb.isFeatureEnabled("mso_sendASmile",!0).then(Bc=>{this.yP=r.AFrameworkApplication.OE&&Bc;this.Rh&&this.Rh.updateCommandUI();
return null},()=>null)})):A.a.instance.Ja("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").execute(Qb=>{Qb.o3("Enabled").then(Bc=>{this.yP=Bc;return null},()=>null)})}get Vg(){this.rP||(r.AFrameworkApplication.Vg||(r.AFrameworkApplication.Vg=new C.a),this.rP=r.AFrameworkApplication.Vg);return this.rP}set Vg(eb){this.rP=eb}Xyl(eb,Tb){void 0!==Tb&&null!==Tb&&Tb&&(this.cFd=Tb.errorCode)}vb(){this.Ca.ya(E.a.giveFeedback,u.a.frame,Object(e.a)(this,this.Onj,"giveFeedbackHandler"));this.Ca.ya(E.a.P0e,
u.a.frame,Object(e.a)(this,this.P0e,"triggerFloodgateSurvey"));this.Rh.updateCommandUI()}P0e(eb,Tb,lb,Fb,rb){if(1===lb)return 32;if(2===lb&&!rb)return 8;A.a.instance.Ja("Common.ISystemInitiatedFeedback").execute(Qb=>{Qb.logActivity(Object(n.a)(String,rb.ActivityName),Object(n.a)(String,rb.BRSName))});return 32}Onj(eb,Tb,lb,Fb,rb){if(1===lb)return r.AFrameworkApplication.fa.ka("IsFeedbackExperiencesAvailable")||(this.yP=!1),this.yP&&z.SessionStatusManager.instance.C_?32:8;if(2===lb){k.ULS.sendTraceTag(8405838,
356,50,"");this.Vg.Feedback|=w.a.cVi;const Qb=rb||{};void 0!==Qb.ErrorCode&&null!==Qb.ErrorCode||null==this.cFd||(Qb.ErrorCode=this.cFd);r.AFrameworkApplication.fa.qNd(Qb);this.jyd&&(this.jyd.instance||3===r.AFrameworkApplication.Aa.hb.Vk&&1===r.AFrameworkApplication.Aa.hb.KIa||A.a.instance.rb("Common.App.CustomerFeedback.ICustomerFeedbackFormManager"),this.jyd.execute(Bc=>{r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OcvFeedbackvNextModalWacEnabled",!1)?v.UISurfaces.e2f().then(wb=>
{void 0!==wb&&null!==wb?(Bc.wXj(Qb,wb),k.ULS.sendTraceTag(8405838,356,100,"Opened OCV vNext Modal")):(k.ULS.sendTraceTag(520626707,356,15,"feedbackAPI not retrived"),Bc.ame(Qb));return wb},()=>{k.ULS.sendTraceTag(520626706,356,15,"error while retieving feedbackAPI");Bc.ame(Qb);return null}):Bc.ame(Qb)}))}return 32}}Object(K.a)(H,"CustomerFeedbackActor",null,[1279]);class I{constructor(eb,Tb,lb){this.kTb=this.pEd=!1;this.rP=this.U7e=null;this.g5a=eb;this.jCc=Tb;this.Vg=lb}get Vg(){this.rP||(r.AFrameworkApplication.Vg||
(r.AFrameworkApplication.Vg=new C.a),this.rP=r.AFrameworkApplication.Vg);return this.rP}set Vg(eb){this.rP=eb}ame(eb){this.U7e=eb;this.Qbg()||this.kac()}wXj(eb,Tb){this.g5a.Kfl(eb,Tb)}kac(){this.pEd||(this.pEd=!0,this.jCc.ZZd(Object(e.a)(this,this.Ukk,"oFeedbackJsDownloadFinished")))}Ukk(eb){eb?(this.kTb=!0,this.Vg.Feedback|=w.a.gVi,this.Qbg(),k.ULS.sendTraceTag(7611924,356,100,"CF - JS downloaded")):(this.Vg.Feedback|=w.a.fVi,k.ULS.sendTraceTag(7611925,356,100,"CF - JS download failed"));this.pEd=
!1}Qbg(){return this.kTb?(this.g5a.Ghl(this.U7e),!0):!1}Olg(eb){this.kTb=eb}}Object(K.a)(I,"CustomerFeedbackC3FormManager",null,[1319]);var J=d(17),T=d(661),D=d(172),R=d(236),Q=d(281);class W{constructor(eb=null){this.Whf=null;this.TAc=new J.a;this.pP=eb}ZZd(eb){W.H$b()?this.TAc.add(eb):this.Whf=eb;var Tb="Feedback/officebrowserfeedback_floodgate.js";T.a.lie()&&(Tb="Feedback/latest/officebrowserfeedback_floodgate.js");eb="OFeedbackIntl";r.AFrameworkApplication.fa.aw("IsServerFlavorDebug")&&r.AFrameworkApplication.fa.ka("IsServerFlavorDebug")&&
(eb+=".debug");eb+=".js";Tb=D.a.J_b(Tb);D.a.avi(eb);eb=Q.a.create(Tb);eb.zS(Object(e.a)(this,this.Mpk,"onJsDownloadFinished"));R.a.Wx(eb);k.ULS.sendTraceTag(7611929,356,100,"CF - Downloading JS from: {0}",Tb)}Q4k(eb){this.pP?eb&&this.pP.add(eb):this.pP=eb}Mpk(eb,Tb){if(W.H$b()){for(eb=0;eb<this.TAc.count;eb++)this.TAc.ga(eb)(Tb.succeeded,this.pP);this.TAc.clear()}else this.Whf(Tb.succeeded,this.pP)}static H$b(){return!!r.AFrameworkApplication.Aa&&!!r.AFrameworkApplication.Aa.hb&&3===r.AFrameworkApplication.Aa.hb.Vk&&
1===r.AFrameworkApplication.Aa.hb.KIa}}Object(K.a)(W,"CustomerFeedbackResourceDownloadManager",null,[1318]);class O{constructor(){this.audienceGroup=null;this.sEe=this.Gib=0}hjg(){return!this.sEe}}Object(K.a)(O,"OCVData",null,[]);var Y=d(119),S=d(198),da=d(102);class fa extends Sys.EventArgs{constructor(eb){super();this.nml=eb}}Object(K.a)(fa,"OnFeedbackUiDismisedArgs",Sys.EventArgs,[]);var ka=d(170),ha=d(70),F=d(195),na=d(33),ba=d(190),Ea=d(268),La=d(45),ta=d(1007),oa=d(76);class wa{constructor(eb,
Tb){this.Cek="obf-MainContentHolder";this.lYj="obf-OverallSmileAnchor";this.QDl="obf-visible";this.cQb=this.bQb=wa.Nkd;this.iCd=this.hCd=this.yP=!0;this.ncf=this.Ynb=this.Wzd=this.Vzd=this.ozc=this.Oyc=this.XSb=!1;this.Syc=!0;this.CEd=this.gEd=this.rP=this.Bdd=this.KBd=this.pKd=null;this.xQh=r.AFrameworkApplication.fa.ka("FeedbackTabHandlerEnabled");this.Od=eb;this.Vg=Tb;this.Oa=new oa.a;if(r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",
!1)){const Qb=this;A.a.instance.Ja("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(wb=>{wb.isFeatureEnabled("mso_sendASmile",Qb.yP).then(Ad=>{Qb.yP=Ad;return null},()=>null);wb.isFeatureEnabled("FloodgateSurvey",Qb.ozc).then(Ad=>{Qb.ozc=Ad;Qb.Wzd=!0;return null},()=>null)});const Bc=this;A.a.instance.Ja("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").execute(wb=>{wb.o3("IncludeScreenshot").then(Ad=>{Bc.XSb=Ad;return null},()=>null);wb.o3("IncludeEmail").then(Ad=>
{Bc.Oyc=Ad;Bc.Vzd=!0;return null},()=>null)})}else{const Qb=this;A.a.instance.Ja("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").execute(Bc=>{Bc.o3("Enabled").then(wb=>{Qb.yP=wb;return null},()=>null);Bc.o3("IncludeScreenshot").then(wb=>{Qb.XSb=wb;return null},()=>null);Bc.o3("IncludeEmail").then(wb=>{Qb.Oyc=wb;Qb.Vzd=!0;return null},()=>null);Bc.o3("SurveyEnabled").then(wb=>{Qb.ozc=wb;Qb.Wzd=!0;return null},()=>null)})}if(r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForUpsell",
!0)){this.Ynb=r.AFrameworkApplication.fa.ka("PremiumUpsellIsEnabled");const Qb=this;A.a.instance.Ja("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(Bc=>{Qb.Ynb=Bc.isFreemiumUpsellEnabled();Bc.isFeatureEnabled("mso_sendASmile",!1).then(wb=>{Qb.ncf=wb;return null},()=>null)})}const lb=this;A.a.instance.Ja("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(Qb=>{Qb.isFeatureEnabled("FeedbackForum",lb.Syc).then(Bc=>{lb.Syc=Bc;return null},()=>null)});const Fb=
this;A.a.instance.Ja("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(Qb=>{Qb.isFeatureEnabled("FeedbackComplianceCannotConsent",Fb.hCd).then(Bc=>{Fb.hCd=Bc;return null},()=>null)});const rb=this;A.a.instance.Ja("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(Qb=>{Qb.isFeatureEnabled("FeedbackComplianceCannotPartialConsent",rb.iCd).then(Bc=>{rb.iCd=Bc;return null},()=>null)});T.a.lie()?(this.pKd=D.a.J_b("Feedback/latest/officebrowserfeedback.css"),
this.KBd=D.a.PUd("Feedback/latest/Intl/")):(this.pKd=D.a.J_b("Feedback/officebrowserfeedback.css"),this.KBd=D.a.PUd("Feedback/Intl/"))}get Vg(){this.rP||(r.AFrameworkApplication.Vg||(r.AFrameworkApplication.Vg=new C.a),this.rP=r.AFrameworkApplication.Vg);return this.rP}set Vg(eb){this.rP=eb}get kme(){return this.gEd||(this.gEd=document.getElementById(this.lYj))}get cbd(){return this.CEd||(this.CEd=document.getElementById(this.Cek))}l9h(eb){this.Oa.addHandler(wa.T2g,eb)}Wri(){this.CEd=this.gEd=null}KKj(eb){return!!eb&&
0<=eb.className.toLowerCase().indexOf(this.QDl.toLowerCase())}Kfl(eb,Tb){r.AFrameworkApplication.OE?this.yP&&(k.ULS.sendTraceTag(520626705,356,15,"Feedback api retrieved"),eb=eb||{},this.getContext(eb),Tb.initializeFeedbackModal(eb,Object(e.a)(this,this.onDismiss,"onDismiss"),Object(e.a)(this,this.onError,"onError")),k.ULS.sendTraceTag(7948385,356,50,"Successfully opened feedback form and set focus."),this.Vg.Feedback|=w.a.ZSf):k.ULS.sendTraceTag(37856257,356,15,"ShowFeedbackButton is false, but ShowUi got called, some feedback entry point is still visible")}Ghl(eb){if(!r.AFrameworkApplication.OE)k.ULS.sendTraceTag(520626704,
356,15,"ShowFeedbackButton is false, but ShowUi got called, some feedback entry point is still visible");else if(this.yP){eb=eb||{};this.getContext(eb);var Tb=wa.GKi(eb.AppMode||"Unknown");ta.a.init(Object(e.a)(this,this.onDismiss,"onDismiss"),Object(e.a)(this,this.onError,"onError"),356,Tb,eb);this.QCj();wa.allowKeytips(!1);k.ULS.sendTraceTag(520488648,356,50,"Successfully opened feedback form and set focus.");this.Vg.Feedback|=w.a.ZSf}}PVi(eb,Tb){Tb&&2>=Tb.Gib?((Tb=r.AFrameworkApplication.fa.Ha("UserPrincipalName"))&&
0<Tb.length&&(eb.userEmail=Tb),eb.userEmailConsentDefault=!0):eb.userEmail=""}rXf(eb){const Tb={};if(void 0!==eb.appData&&null!==eb.appData){var lb=eb.appData;for(var Fb in lb)Tb[Fb]=lb[Fb]}Tb.App=eb.Application||"";Tb.AppMode=eb.AppMode||"";Tb.AppModeExt=eb.ApplicationMode||"";Tb.Host=eb.Host||"";Tb.Language=eb.locale;Tb.IsError=eb.Error||!1;Tb.IsCrash=eb.Crash||!1;Tb.ServerDocId=eb.ServerDocId||"";eb.ErrorCode&&""!==eb.ErrorCode.toString()&&(Tb.IsError=!0);"Origin"in eb&&(Tb.Origin=eb.Origin);Tb.ClientThrottlingProtection=
this.Vg.ClientThrottlingProtection||"";Tb.HostServiceLevel=this.Vg.HostServiceLevel||"";Tb.RequestedCallThrottling=this.Vg.RequestedCallThrottling||"";Tb.WacServiceLevel=this.Vg.WacServiceLevel||"";this.Vg.HostResponseStats&&(lb=this.Vg.HostResponseStats.Label)&&(Tb.HostFarmHint=lb);lb=r.AFrameworkApplication.fa;(Fb=lb.Ha(r.AFrameworkApplication.YJ))&&""!==Fb&&(Tb.UiHost=Fb);(Fb=lb.Ha(r.AFrameworkApplication.pEh))&&""!==Fb&&(Tb.UiHostIntegrationType=Fb);lb.ka("OcvFeedbackIncludesSessionOriginIsEnabled")&&
(lb=eb.SessionOrigin,lb&&""!==lb||(eb=eb.SourceControlId)&&""!==eb&&ba.a(ba.d(eb),"feedback")&&(lb=this.eZf().SessionOrigin),lb&&""!==lb&&(Tb.SessionOrigin=lb));eb=null;try{eb=na.c(Tb),eb=La.a.Dca(eb,La.a.Szb)}catch(rb){eb="",k.ULS.sendTraceTag(520644571,356,10,"Exception trying to serialize appData:"+rb.message)}return{["appData"]:eb||""}}a6i(eb){const Tb={};for(let lb in eb)Tb[lb]=eb[lb];Tb.IsFreemiumUpsellEnabled=this.Ynb;Tb.IsAadcEnabled=this.ncf;Tb.IsFeedbackEnabled=this.yP;return Tb}d6i(){let eb=
null;try{const Tb=r.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.WebSurfacesSettings",null);Tb&&(eb=na.b(Tb))}catch(Tb){k.ULS.sendTraceTag(543520794,356,10,"Could not deserialize WebSurfacesSettingsJson")}return eb||{}}G4i(eb,Tb){if(eb&&Tb){eb.LanguageID?eb.locale=Ea.a.ue(eb.LanguageID).name||"":eb.ApplicationLCID&&(eb.locale=eb.ApplicationLCID);eb.applicationGroup=this.rXf(eb);eb.applicationSettings=this.a6i(r.AFrameworkApplication.fa.appSettings);eb.webSurfacesSettings=
this.d6i();wa.VLf(Tb,eb);eb.appId=wa.LKi();eb.environment=Tb.sEe;eb.stylesUrl=this.pKd;eb.intlUrl=this.KBd;eb.rtl=r.AFrameworkApplication.fa.ka("Rtl")?"rtl":"ltr";var lb=wa.KKi();eb.primaryColour=lb.primaryColour;eb.secondaryColour=lb.secondaryColour;eb.sessionId=eb.SessionID||eb.WACSessionID||"";eb.build=eb.ApplicationVersion||eb.WFEVersion||"";lb=eb.FlightIDs?eb.FlightIDs.toString():eb.Flights?eb.Flights.toString():"";var Fb="";eb.ErrorCode&&(Fb=eb.ErrorCode.toString());var rb=this.aej(eb),Qb=Tb.hjg()?
r.AFrameworkApplication.fa.Ha("TenantId"):"";Qb&&"0"!==Qb||(Qb="");var Bc=r.AFrameworkApplication.fa.Ha("LoggableUserIdSpace"),wb=r.AFrameworkApplication.fa.Ha("LoggableUserId")||"";switch(Bc){case "MsaPuid":wb="p:"+wb;break;case "MsaCid":wb="m:"+wb;break;case "OrgIdPuid":wb="a:"+(r.AFrameworkApplication.fa.Ha("AADUserObjectId")||wb);break;default:k.ULS.sendTraceTag(575415951,356,50,"Unknown LoggableUserIdSpace. LoggableUserId: "+wb+", LoggableUserIdSpace: "+Bc),wb=""}Bc={};if(void 0!==eb.telemetryGroup&&
null!==eb.telemetryGroup){const Ad=eb.telemetryGroup;for(let bc in Ad)Bc[bc]=Ad[bc]}Bc.audienceGroup=Tb.audienceGroup;Bc.audience=Tb.audienceGroup;Bc.flights=lb;Bc.platform=rb;Bc.ringId=Tb.Gib;Bc.officeUILang=r.AFrameworkApplication.lcid;Bc.errorCode=Fb;Bc.loggableUserId=wb;Bc.processSessionId=eb.SessionID||eb.WACSessionID||"";Bc.officeBuild=eb.ApplicationVersion||eb.WFEVersion||"";0<Qb.length&&"84df9e7f-e9f6-40af-b435-aaaaaaaaaaaa"!==Qb&&(Bc.tenantId=Qb);eb.telemetryGroup=Bc;eb.webGroup={["browser"]:eb.Browser||
"",["browserVersion"]:(eb.BrowserMajorVersion||"")+"."+(eb.BrowserMinorVersion||""),["dataCenter"]:eb.Datacenter||eb.WACDatacenter||""};eb.isCommercialHost=r.AFrameworkApplication.fa.ka("IsO365CommercialHost");this.EKi(eb);eb.disableIncludeScreenshot=!this.XSb;eb.screenshot=this.XSb;eb.showEmailAddress=this.Oyc;eb.emailPolicyValue=this.Oyc?1:0;eb.screenshotPolicyValue=this.XSb?1:0;r.AFrameworkApplication.fa.ka("IsO365CommercialHost")||(eb.disableIncludeScreenshot=!1,eb.showEmailAddress=!0,eb.screenshot=
!0);r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateAdminControlsEnabled",!1)&&(eb.surveyEnabled=this.ozc,r.AFrameworkApplication.fa.ka("IsO365ConsumerHost")&&(eb.showEmailAddress=!0,eb.surveyEnabled=!0));this.PVi(eb,Tb);this.Bdd=eb.DismissHandler?eb.DismissHandler:null;this.CKi(eb)}}Bei(){return this.Vzd&&this.Wzd}getContext(eb){eb=eb||this.eZf();const Tb=new O;this.G4i(eb,Tb);return eb}aej(eb){let Tb="";eb.Platform&&(Tb=eb.Platform.toString());eb.PlatformMajorVersion&&
(0<Tb.length&&(Tb+=" "),Tb+=eb.PlatformMajorVersion.toString()+".");eb.PlatformMinorVersion&&(Tb+=eb.PlatformMinorVersion.toString());return Tb}zkl(eb){eb.ApplicationMode&&(eb.AppMode=eb.ApplicationMode);eb.ApplicationModeExtended&&(eb.ApplicationMode=eb.ApplicationModeExtended)}eZf(){let eb;try{eb=na.b(r.AFrameworkApplication.fa.appSettings.SessionStartInfoJson.toString()),this.zkl(eb)}catch(Tb){k.ULS.sendTraceTag(36794389,356,10,"Could not deserialize SessionStartInfoJson"),eb={}}return eb}onError(eb){k.ULS.sendTraceTag(37259477,
356,10,"FB submit error: "+eb);this.Vg.Feedback|=w.a.eVi;wa.allowKeytips(!0)}RMi(){if(wa.Shg()){k.ULS.sendTraceTag(40112215,356,50,wa.Z_g);var eb=A.a.instance.resolve("Common.ISystemInitiatedFeedback");eb&&eb.logActivity("AppUsageNPSLocalizationTest",null)}}onDismiss(eb){this.Ona();this.Wri();ka.a.eGb()&&k.ULS.sendTraceTag(34936718,356,50,"FB dismiss");ka.a.SUa()&&da.c(eb?E.a.bVi:E.a.XUi,!0,null,2,8);eb?(ka.a.eGb()&&k.ULS.sendTraceTag(34936719,356,15,"FB submit"),this.Vg.Feedback|=w.a.hVi):(this.Vg.Feedback|=
w.a.dVi,this.RMi());this.Oa.raiseEvent(wa.T2g,new fa(eb));wa.allowKeytips(!0);this.Bdd&&(this.Bdd(),this.Bdd=null)}QCj(){if(this.Od){let eb=!1,Tb=5,lb=!1;this.cQb=this.clearInterval(this.cQb);this.bQb=this.clearInterval(this.bQb);this.bQb=window.setInterval(()=>{if(this.kme){lb=!0;var Fb=this.Od.Gc(wa.q7a);Fb.zL=!0;Fb.parent=Y.AFrame.nj;Fb.D5a(wa.THi);Fb.Wba(()=>{let rb=this.Od.rQ(wa.q7a),Qb=null,Bc=5,wb=!1;this.cQb=window.setInterval(()=>{this.KKj(this.cbd)&&(wb=!0,this.kme.focus(),rb||(rb=this.Od.rQ(wa.q7a)),
rb&&!Qb&&(Qb=rb.uj),Qb&&Qb.VE(this.kme));Bc--;if(wb||!Bc)this.cQb=this.clearInterval(this.cQb)},1E3)});eb||(this.Od.tY(wa.q7a,!0),eb=!0);this.xQh&&this.cbd&&(Fb=new S.DOMFocusListing(()=>this.cbd),Fb.Eo(1),Fb.Eo(2),Fb.Eo(3),Fb.Eo(5),Fb=this.Od.Eia(()=>this.cbd,this.Od.Gc(wa.q7a),Fb),Fb.$hb(),Fb.kX=!0,Fb.rQa=!0,Fb.hZg())}Tb--;if(lb||!Tb)this.bQb=this.clearInterval(this.bQb)},1E3)}}clearInterval(eb){eb!==wa.Nkd&&(window.clearInterval(eb),eb=wa.Nkd);return eb}Ona(){this.Od&&(this.Od.x5(wa.q7a),this.Od.wJb(wa.q7a))}CKi(eb){this.hCd?
this.iCd||(eb.ageGroup=4):eb.ageGroup=3;r.AFrameworkApplication.fa.ka("IsAnonymousUser")?eb.authenticationType=2:eb.authenticationType="aad"===r.AFrameworkApplication.fa.Ha("HostAuthType")?1:0}EKi(eb){this.Syc&&(eb.myFeedbackForumUrl="https://go.microsoft.com/fwlink/?linkid=2171883",eb.MyFeedbackPortalUrl="https://go.microsoft.com/fwlink/?linkid=2171883");if(this.Syc){const Tb=wa.FKi();void 0!==Tb&&null!==Tb&&(eb.feedbackPortalUrl=Tb,eb.feedbackForumUrl=Tb)}}static allowKeytips(eb){r.AFrameworkApplication.Aa.hb.Lo&&
ha.a("allowKeytips")&&appChrome.api.allowKeytips(eb)}static VLf(eb,Tb){if(Tb){eb.Gib=parseInt(Tb.Ring);if(isNaN(eb.Gib))eb.audienceGroup="Unknown",eb.Gib=-2;else switch(eb.Gib){case 0:case 1:eb.audienceGroup="Dogfood";break;case 2:eb.audienceGroup="Microsoft";break;case 3:case 4:case 5:case 6:eb.audienceGroup="Production";break;default:eb.audienceGroup="Unknown"}var lb=!0;Tb.Host&&(lb="MsInternal"!==Tb.Host&&"Blue Chicken"!==Tb.Host);eb.sEe=lb?0:1}}static LKi(){let eb=0;switch(F.Redirect.application){case 2:eb=
2155;break;case 4:eb=2158;break;case 3:eb=2157;break;case 1:eb=2156;break;case 5:eb=2159;break;default:k.ULS.sendTraceTag(34723679,356,10,"Unexpected Application: {0}",F.Redirect.application.toString())}return eb}static KKi(){const eb={};let Tb="#2B579A",lb="#3C65A4";switch(F.Redirect.application){case 2:r.AFrameworkApplication.fa&&r.AFrameworkApplication.fa.ka("AppColorUpdateIsEnabled")?(Tb="#185ABD",lb="#2E6AC5"):(Tb="#2B579A",lb="#3C65A4");break;case 4:Tb="#7719AA";lb="#9953C0";break;case 3:Tb=
"#B7472A";lb="#C75033";break;case 1:Tb="#217346";lb="#3F8159";break;case 5:Tb="#3955A3";lb="#4D6AB8";break;default:k.ULS.sendTraceTag(36230303,356,10,"Unexpected Application: {0}",F.Redirect.application.toString())}eb.primaryColour=Tb;eb.secondaryColour=lb;return eb}static FKi(){let eb=null;switch(F.Redirect.application){case 2:eb="https://go.microsoft.com/fwlink/?linkid=2170869&clcid=0x409";break;case 4:eb="https://go.microsoft.com/fwlink/?linkid=2172997&clcid=0x409";break;case 3:eb="https://go.microsoft.com/fwlink/?linkid=2171000&clcid=0x409";
break;case 1:eb="https://go.microsoft.com/fwlink/?linkid=2170798&clcid=0x409";break;case 5:eb="https://go.microsoft.com/fwlink/?linkid=2173231&clcid=0x409";break;default:k.ULS.sendTraceTag(540577997,356,10,"Unexpected Application: {0}",F.Redirect.application.toString())}return eb}static GKi(eb){let Tb=356;switch(F.Redirect.application){case 2:switch(eb){case "Edit":Tb=364;break;case "View":case "Attendee":case "Presenter":Tb=363;break;default:k.ULS.sendTraceTag(7652195,356,15,"Unexpected ModeName: {0}. Setting ULSCat to Word Online View Mode",
r.AFrameworkApplication.Aa.iYa),Tb=363}break;case 4:Tb=362;break;case 3:switch(eb){case "Edit":Tb=361;break;case "View":case "Attendee":case "Presenter":case "Outline":case "":Tb=360;break;default:k.ULS.sendTraceTag(7652224,356,15,"Unexpected ModeName: {0}. Setting ULSCat to PowerPoint Online View Mode",r.AFrameworkApplication.Aa.iYa),Tb=360}break;case 1:switch(eb){case "Edit":Tb=358;break;case "View":Tb=357;break;case "Survey":Tb=359;break;default:k.ULS.sendTraceTag(7652225,356,15,"Unexpected ModeName: {0}. Setting ULSCat to Excel Online View Mode",
r.AFrameworkApplication.Aa.iYa),Tb=357}break;case 5:switch(eb){case "View":Tb=373;break;case "Edit":Tb=374;break;default:k.ULS.sendTraceTag(18158298,356,15,"Unexpected ModeName: {0}. Setting ULSCat to Visio Online View Mode",r.AFrameworkApplication.Aa.iYa),Tb=373}break;default:k.ULS.sendTraceTag(7652226,356,10,"Unexpected Application: {0}",F.Redirect.application.toString())}return Tb}static THi(){k.ULS.sendTraceTag(38572302,356,50,"CustomerFeedbackScope is disposed")}static Shg(){if(!wa.hEe){const eb=
!!r.AFrameworkApplication.fa&&r.AFrameworkApplication.fa.ka(wa.Z_g);wa.hEe=eb?2:1}return 2===wa.hEe}}wa.q7a="CustomerFeedbackFocusId";wa.T2g="FUID";wa.Nkd=-1;wa.hEe=0;wa.Z_g="NPSLocalizationTestingIsEnabled";Object(K.a)(wa,"CustomerFeedbackUiWrapper",null,[1317]);var ra=d(14),ya=d(1187),Da=d(1188);class pa{constructor(eb,Tb,lb,Fb){this.N6e=eb;this.Fga=Tb;this.M6e=lb;this.mWh=Fb}activityName(){return this.Fga}object(){return this.mWh}}Object(K.a)(pa,"OneCallBackData",null,[]);class la{constructor(eb,
Tb,lb,Fb){this.GMa=[];Array.add(this.GMa,new pa(eb,Tb,lb,Fb))}add(eb){eb&&Array.addRange(this.GMa,eb.GMa)}Yri(){Array.clear(this.GMa)}}Object(K.a)(la,"CallBackData",null,[]);var Fa=d(662);class Qa extends Fa.a{constructor(eb,Tb,lb=null,Fb=!1,rb=!1,Qb=null,Bc=null,wb=null){super("FloodgateTeachingCallout");this.image=this.footer=this.message=this.smallHeadline=this.title=null;this.positionImageAtLeft=!1;this.secondaryButtonProps=this.primaryButtonProps=null;this.footer=eb;this.message=Tb;this.image=
lb;this.positionImageAtLeft=Fb;this.smallHeadline=rb;this.title=Qb;this.primaryButtonProps=Bc;this.secondaryButtonProps=wb}}Object(K.a)(Qa,"FloodgateCalloutContent",Fa.a,[]);class Sa{constructor(){this.sch=this.options=null}}Object(K.a)(Sa,"Notification",null,[]);var Na=d(1103),ua=d(921),za=d(346);class Wa extends Fa.a{constructor(eb,Tb,lb=null,Fb=null){super("PremiumUpsellCallout");this.imageHeight=this.imageProps=this.content=this.title=null;this.title=eb;this.content=Tb;this.imageProps=lb;this.imageHeight=
Fb}}Object(K.a)(Wa,"PremiumUpsellCalloutContentProps",Fa.a,[]);var yb=d(922);class Za{constructor(eb){this.alt=this.ariaLabel=this.src=null;this.src=eb}}Object(K.a)(Za,"ImageProps",null,[]);class ub{static FVd(eb){return ub.efj().then(Tb=>{try{const lb=[];for(let Fb=0;Fb<eb.length;Fb++){const rb=eb[Fb],Qb=ub.GTj(rb.surfaceType),Bc=new Sa;Bc.options=ub.Lcj(rb,!Qb);Bc.sch=Qb?Tb.callout(ub.Qek(eb[Fb])):Tb.externalNotification();lb.push(Bc)}return ub.Tfl(Tb,lb)}catch(lb){throw Error.create("Failed to convert and show teaching UX using WAC notifications: "+
lb.message);}})}static GTj(eb){switch(eb.toLowerCase()){case "teaching":case "coachmark":case "sequence":case "premiumupsell":return!0;default:return!1}}static Lcj(eb,Tb){const lb=new za.a;Tb&&(lb.onShow=eb.onUnsupportedSurfaceType);lb.telemetryId="FloodgateTeachingUx-Surface"+(Tb?"NotSupported":"Supported");return lb}static Qek(eb){var Tb="premiumupsell"!==eb.surfaceType.toLowerCase()?new Qa(eb.footer,eb.description,eb.illustrationImage?Object.assign(new Za(eb.illustrationImage),{ariaLabel:eb.imageAriaLabel}):
null,"left"===eb.position,eb.smallHeadline,eb.title,ub.EQc(eb.primaryButtonText,eb.primaryButtonAction),ub.EQc(eb.secondaryButtonText,eb.secondaryButtonAction)):new Wa(eb.title,eb.description,eb.illustrationImage?Object.assign(new Za(eb.illustrationImage),{ariaLabel:eb.imageAriaLabel}):null);Tb=Object.assign(new ua.a,{target:eb.selector,content:Tb,showCloseIcon:null!=eb.hasCloseButton?eb.hasCloseButton:!0,preventLightDismiss:null!=eb.preventAutoDismiss?eb.preventAutoDismiss:!1,useTeachingStyles:!0,
calloutProps:Object.assign(new yb.a,{onDismiss:()=>{if(eb.onClosed)eb.onClosed("close")},directionalHint:eb.anchorHint,setInitialFocus:!0})});"coachmark"===eb.surfaceType.toLowerCase()?(Tb.hasDynamicSizing=!1,Tb.useCoachmark=!0,Tb.calloutProps.setInitialFocus=!1):"premiumupsell"===eb.surfaceType.toLowerCase()&&(Tb.primaryButtonProps=ub.EQc(eb.primaryButtonText,eb.primaryButtonAction),Tb.secondaryButtonProps=ub.EQc(eb.secondaryButtonText,eb.secondaryButtonAction),Tb.showCloseIcon=!1,Tb.useTeachingStyles=
!1,Tb.calloutProps.preventDismissOnLostFocus=!1);return Tb}static EQc(eb,Tb){return eb&&""!==eb&&Tb?Object.assign(new Na.a,{label:eb,onExecute:Tb}):(k.ULS.shipAssertTag(594569111,356,(!eb||""===eb)&&!Tb,"A callout button needs both a caption and an action."),null)}static efj(){ub.rPc||(r.AFrameworkApplication.Aa.hb.BUa&&r.AFrameworkApplication.fa.ka("WacFloodgateNotificationsIntegrationIsEnabled")?ub.rPc=v.UISurfaces.CN().then(eb=>{const Tb=new Qa(null,null);if(eb.isCustomContentSupported&&eb.isCustomContentSupported(Tb))return eb;
throw Error.create("Custom Content not supported: "+Tb.type);},eb=>{k.ULS.sendTraceTag(593352343,383,15,"Failed to GetNotificationsAPIAsync: {0}",eb);return null}):ub.rPc=Promise.reject("React Notifications not enabled"));return ub.rPc}static Tfl(eb,Tb){if(!Tb||!Tb.length)return[];const lb=[];for(let Fb=0;Fb<Tb.length;Fb++){const rb=ub.Ggl(eb,Tb[Fb]);lb.push(rb)}return lb}static Ggl(eb,Tb){const lb=eb.addNotification(Tb.sch,Tb.options);return()=>{eb.removeNotification(lb)}}}ub.rPc=null;Object(K.a)(ub,
"FloodgateNotifications",null,[]);const Ib=(eb,Tb)=>{eb=r.AFrameworkApplication.fa.Ha("UserPrincipalName");if(Tb=!!Tb.o0g&&2===Tb.o0g.Gib)Tb=(Tb=eb.toLowerCase())?0<Tb.indexOf("linkedin.com")||0<Tb.indexOf("linkedin.biz"):!1;return Tb};class Ob{constructor(eb,Tb){this.o0g=eb;this.context=Tb}}Object(K.a)(Ob,"SurveyMetadata",null,[]);var Hc=d(65),kb=d(269),jb=d(91),hb=d(79);class uc{constructor(eb){this.hUa=this.isInitialized=!1;this.dja=this.nmb=null;this.l1a=!1;this.oZe=null;this.Yfg=!1;this.RLc=
0;this.PKf=-1;this.qJe=this.QLc=null;this.f7b=!0;this.dQ=eb;this.Dsc={};this.Cwf=!1;this.UJb=this.na=null;this.qPc=0}mEj(eb){this.isInitialized&&this.nmb||this.hUa?k.ULS.sendTraceTag(595142230,356,10,"SIFB: InitializeWACAppParameters called too late, its already initialized or in err state."):null===eb?k.ULS.sendTraceTag(595142229,356,15,"SIFB: InitializeWACAppParameters was passed null param"):(this.l1a=eb.l1a,k.ULS.sendTraceTag(595142228,356,10,"SIFB: GetAppSpecificFeedbackData returned null"))}cEj(){const eb=
this.dQ.getContext(null),Tb=new O;wa.VLf(Tb,eb);this.oZe=new Ob(Tb,eb);this.UJb=new ra.ScriptSharpLegacyMap;this.UJb.$("LinkedInWACUsage",Ib)}get brb(){this.nmb||(this.nmb=A.a.instance.rb("Common.App.IAppSpecificFeedbackData"));return this.nmb}logActivity(eb,Tb,lb=null){eb&&this.x8a(eb,uc.Efb,Tb)&&(this.isInitialized?(k.ULS.sendTraceTag(37754499,356,50,"SIFB: LogActivity "+eb),ta.a.logActivity(eb,lb)):(k.ULS.sendTraceTag(37754500,356,50,"SIFB: LogActivity (initializing first) "+eb),this.Nce(new la(ta.a.logActivity,
eb,null,lb))))}Kme(eb){try{r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.LogTriggerActivityName",!1)&&k.ULS.sendTraceTag(520140175,356,50,"Trigger Activity Name: "+eb),-1===this.PKf&&(this.PKf=r.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.DeferredActivityDelayInMilliSeconds",uc.sKf)),this.QLc||(this.QLc=r.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.FloodgateDeferredActivityAllowedList"," ").toString().toLowerCase()),
!r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AllowAllTriggerActivities",!0)&&this.QLc&&eb&&eb.startsWith("Ribbon_")&&-1===this.QLc.indexOf(eb.toLowerCase())?k.ULS.sendTraceTag(527247310,356,100,"SIFB: LogActivityDeferred activity ignored"):this.isInitialized?(0<this.RLc&&r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ClearNearActivityTimeouts",!1)&&(window.clearTimeout(this.RLc),k.ULS.sendTraceTag(592217693,356,50,"SIFB: LogActivityDeferred cancelled "+
eb)),this.RLc=window.setTimeout(()=>{this.RLc=0;this.logActivity(eb,null)},uc.sKf)):k.ULS.sendTraceTag(592217692,356,50,"SIFB: LogActivityDeferred called before initialization "+eb)}catch(Tb){k.ULS.sendTraceTag(527247311,356,10,"SIFB: LogActivityDeferred activity failed: "+(Tb?Tb.toString():""))}}sac(eb,Tb){eb&&this.x8a(eb,uc.Efb,Tb)&&(this.Qng(eb,Tb),this.Dsc[eb]=Tb)}Qng(eb,Tb){this.x8a(eb,uc.Efb,Tb)&&(this.isInitialized?(k.ULS.sendTraceTag(37754501,356,50,"SIFB: LogActivityStartInternal "+eb),ta.a.sac(eb,
null)):(k.ULS.sendTraceTag(37754502,356,50,"SIFB: LogActivityStartInternal (initializing first) "+eb),this.Nce(new la(ta.a.sac,eb,null,null))))}Ong(eb){eb&&this.isInitialized&&this.x8a(eb,uc.Efb,void 0)&&(eb in this.Dsc&&delete this.Dsc[eb],this.Png(eb,void 0))}Png(eb,Tb){this.isInitialized&&this.x8a(eb,uc.Efb,Tb)&&(k.ULS.sendTraceTag(37754503,356,50,"SIFB: LogActivityEndInternal "+eb),ta.a.Ong(eb))}kMb(eb,Tb){if(this.x8a(eb,uc.Efb,Tb))if(this.brb){if(Tb=this.brb.Q9d(eb))this.isInitialized?(k.ULS.sendTraceTag(38605911,
356,50,"SIFB:ShowUserInitiatedSurvey "+eb),ta.a.kMb(Tb)):(k.ULS.sendTraceTag(38605912,356,50,"SIFB:ShowUserInitiatedSurvey (initializing first) "+eb),this.Nce(new la(null,null,ta.a.kMb,Tb)))}else k.ULS.sendTraceTag(556896919,356,10,"AppSpecificFeedbackData is null")}x8a(eb,Tb,lb){if(this.hUa)return!1;if(!r.AFrameworkApplication.OE)return k.ULS.sendTraceTag(37601796,356,50,"SIFB: All feedback/floodgate is disabled"),!1;if(!this.FLj())return!1;this.TAi();return(this.wKj(eb)||this.FHi(eb)||this.dHj(eb))&&
this.Zhi(Tb,lb)&&this.Rml(eb)}TAi(){if(!this.nmb){const eb=A.a.instance.rb("Common.App.IAppSpecificFeedbackData");eb?this.nmb=eb:k.ULS.sendTraceTag(589641477,356,10,"SIFB.Error:IAppSpecificFeedbackData not found in the container")}}GLj(eb){return 6!==eb}FLj(){if(0===this.qPc){const eb=this.dQ.getContext(null);this.qPc=this.GLj(parseInt(eb.Ring))?1:2;2===this.qPc&&k.ULS.sendTraceTag(50389538,356,15,"SIFB: floodgate disabled in this environment")}return 1===this.qPc}Rml(eb){null===this.UJb&&this.cEj();
return eb&&this.UJb&&this.UJb.Hb(eb)?this.UJb.ga(eb)(eb,this.oZe):!0}V5i(){if(!this.dja&&!this.Cwf){this.Cwf=!0;const eb=this.dQ.getContext(null);this.dja="locale"in eb?eb.locale:"";this.dja=this.dja.toLowerCase()}return this.dja}FHi(eb){this.dja||(this.dja=this.V5i());if(!(this.dja&&this.dja.length&&eb&&eb.length))return!1;let Tb="en-us"===this.dja||this.JOj(eb)||wa.Shg();!Tb&&this.yOj(eb)&&(Tb=this.zOj(this.dja));return Tb}yOj(eb){return this.brb?"AppUsageNPS"===eb||"AppUsageTimeSatisfiedNPS"===
eb||"SuiteUsageNPS"===eb||"SuiteUsageTimeSatisfiedNPS"===eb:(k.ULS.sendTraceTag(593769179,356,10,"SIFB:IsNPSActivity AppSpecificFeedbackData was null. activityName: "+eb),!1)}wKj(eb){return!!eb&&-1!==eb.toLowerCase().indexOf("floodgateflight")}JOj(eb){return!!eb&&-1!==eb.toLowerCase().indexOf("nlqs")}zOj(eb){if(r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateAllNpsLanguages",!1))return!0;if(!eb||!eb.length)return!1;if(!r.AFrameworkApplication.fa.ka("WacNPSLocalizedLanguagesEnabled"))return"en-us"===
eb;let Tb=!1;switch(eb){case "en-us":case "es-es":case "ja-jp":case "en-gb":case "pt-br":case "nl-nl":case "de-de":case "fr-fr":case "sv-se":case "fi-fi":case "nb-no":case "da-dk":case "ru-ru":case "es-mx":case "pl-pl":case "zh-cn":case "zh-tw":case "it-it":case "ko-kr":Tb=!0}return Tb}Zhi(eb,Tb){return r.AFrameworkApplication.fa.ka(eb)?Tb&&!r.AFrameworkApplication.fa.ka(Tb)?(k.ULS.sendTraceTag(36767233,356,50,"SIFB: FC BRS("+Tb+") is off"),!1):!0:(k.ULS.sendTraceTag(36546386,356,50,"SIFB: Main SIF BRS("+
eb+") is off"),!1)}dHj(eb){const Tb=r.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.AllowedCampaignActivities","ShowFirstRunExperienceUIV2");return!!eb&&!!Tb&&-1!==Tb.toLowerCase().indexOf(eb.toLowerCase())}Nce(eb){if(r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateAdminControlsEnabled",!1))r.AFrameworkApplication.fa.jf(()=>{try{this.dNc(eb)}catch(Tb){k.ULS.sendTraceTag(50357646,356,10,"SIFB.Error:Download and initialize failed "+
Tb)}});else try{this.dNc(eb)}catch(Tb){k.ULS.sendTraceTag(574997505,356,10,"SIFB.Error:Download and initialize failed "+Tb)}}Yjc(){this.l1a||this.start()}yuk(){this.l1a||this.stop()}hYe(){this.l1a&&this.start()}zll(){this.l1a&&this.stop()}start(){k.ULS.sendTraceTag(37623952,356,100,"SIFB: Start called "+this.isInitialized);if(this.isInitialized)if(r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateDelayStart",!1)){const eb=hb.a.aLc(r.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.FloodgateAfterIdleCallbackDelayMs",
10),Object(e.a)(this,this.Hxh,"startSurvey"),r.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.FloodgateDelayStartIdleOverrideMs",1E3));r.AFrameworkApplication.we.Eb(eb)}else this.Hxh(null)}Hxh(){ta.a.zYi();this.eql()}stop(){k.ULS.sendTraceTag(37623953,356,100,"SIFB: Stop called "+this.isInitialized);this.isInitialized&&(this.dql(),ta.a.AYi())}eql(){const eb=this.Dsc;for(let Tb in eb)this.Qng(Tb,eb[Tb])}dql(){const eb=this.Dsc;for(let Tb in eb)this.Png(Tb,eb[Tb])}dNc(eb){k.ULS.sendTraceTag(36546388,
356,100,"SIFB: Entered DownloadResources");var Tb=A.a.instance.resolve("Common.App.CustomerFeedback.ICustomerFeedbackFormManager");Tb&&(Tb.kTb?this.XUf(!0,eb):(Tb=A.a.instance.resolve("Common.App.CustomerFeedback.ICustomerFeedbackResourceDownloadManager"),Tb.Q4k(eb),Tb.ZZd(Object(e.a)(this,this.XUf,"floodgateJsDownloadFinished"))))}XUf(eb,Tb){k.ULS.sendTraceTag(36546389,356,100,"SIFB: Entered FloodgateJsDownloadFinished. succeeded is "+eb);let lb="";Tb&&Tb.GMa&&0<Tb.GMa.length&&(lb=Tb.GMa[0].activityName());
if(eb)if(T.a.lie())if(this.isInitialized)this.KZd(Tb);else{if(this.hUa||!this.qJe)this.qJe=this.P$g();this.qJe.then(()=>{this.KZd(Tb)}).catch(Fb=>this.Q$g(lb,Fb))}else this.P$g().then(()=>{this.KZd(Tb)}).catch(Fb=>this.Q$g(lb,Fb));else this.hUa=!0,k.ULS.sendTraceTag(36546391,356,10,"SIFB Error:JS download failed. Activity name "+lb)}Q$g(eb,Tb){this.hUa=!0;k.ULS.sendTraceTag(36546390,356,10,"SIFB Error: in post download init. Activity name "+eb+". "+Tb.toString())}BYi(eb){this.na||this.iEj();let Tb=
eb;eb&&0<eb.length&&(Tb=this.na&&this.na.Hb(eb)?this.na.ga(eb):eb);return Tb?Tb:""}P$g(){var eb=A.a.instance.resolve("Common.App.CustomerFeedback.ICustomerFeedbackFormManager");eb&&eb.Olg(!0);this.qal();this.R$k();this.initOptions();if(r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1)&&r.AFrameworkApplication.fa.ka("IsO365ConsumerHost"))return this.E1i().then(Tb=>{this.Sme(Tb);return Tb}).then(Tb=>ta.a.Cce(Object(e.a)(this,
this.PGe,"onSIFeedbackDismiss"),Object(e.a)(this.dQ,this.dQ.onError,"onError"),Tb,Object(e.a)(this.dQ,this.dQ.onDismiss,"onDismiss")));if(r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateAdminControlsEnabled",!1)&&r.AFrameworkApplication.fa.ka("IsO365CommercialHost")&&r.AFrameworkApplication.fa.ka("OcpsIsEnabled"))return uc.jJi(this.G0f()).then(()=>{const Tb=this.U3d();this.Sme(Tb);return Tb}).then(Tb=>ta.a.Cce(Object(e.a)(this,this.PGe,"onSIFeedbackDismiss"),
Object(e.a)(this.dQ,this.dQ.onError,"onError"),Tb,Object(e.a)(this.dQ,this.dQ.onDismiss,"onDismiss")));eb=this.U3d();this.Sme(eb);return ta.a.Cce(Object(e.a)(this,this.PGe,"onSIFeedbackDismiss"),Object(e.a)(this.dQ,this.dQ.onError,"onError"),eb,Object(e.a)(this.dQ,this.dQ.onDismiss,"onDismiss"))}E1i(){return new Promise(eb=>{A.a.instance.Ja("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(Tb=>{const lb=this.U3d();Tb.isFeatureEnabled("FloodgateSurvey",!0).then(Fb=>{lb.surveyEnabled=
"surveyEnabled"in lb?Fb&&lb.surveyEnabled:Fb;eb(lb);return null},Fb=>{k.ULS.sendTraceTag(555857947,356,15,"GetAllContextForFloodgatePromise Error {0}",Fb.toString());eb(lb);return null})})})}c6i(){let eb=null;try{const Tb=r.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.MessagingServiceSettings",null);Tb&&(eb=na.b(Tb))}catch(Tb){k.ULS.sendTraceTag(540285072,356,10,"Could not deserialize MessagingServiceSettingsJson")}return eb||{}}U3d(){const eb=this.dQ.getContext(null);
eb.FloodgateUIAutoDismissTimeEnum=this.q2i();eb.uIStringGetter=Object(e.a)(this,this.BYi,"floodgateUIStringGetter");eb.authTokenCallback=uc.$Ai(Object(n.a)(String,eb.AudienceGroup));eb.augLoopCallback=uc.YAi();eb.onTeachingCampaignRender=uc.FVd;eb.governanceServiceEnabled=uc.$_f();eb.governanceServiceConfig=uc.e9i();eb.personalizerEnabled=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgatePersonalizerEnabled",!1);eb.messagingServiceSettings=this.c6i();eb.isPriorityEnabled=
uc.Eej();return eb}Sme(eb){const Tb=this.dQ.Bei(),lb=this.G0f(),Fb=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateAdminControlsEnabled",!1),rb=r.AFrameworkApplication.fa.ka("IsO365CommercialHost"),Qb=r.AFrameworkApplication.fa.ka("IsO365ConsumerHost"),Bc=r.AFrameworkApplication.fa.ka("OcpsIsEnabled"),wb="surveyEnabled"in eb?eb.surveyEnabled:"null or undefined",Ad="showEmailAddress"in eb?eb.showEmailAddress:"null or undefined",bc=uc.$_f(),Sb=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgatePersonalizerEnabled",
!1);k.ULS.sendTraceTag(575947136,356,50,'"Info": "SIFB Info: Floodgate SDK will init.", "OcpsPoliciesSet": "{0}", "FGAdminControlsEnabled": "{1}", "IsO365CommercialHost": "{2}", "IsO365ConsumerHost": "{3}", "OcpsIsEnabled": "{4}", "FGInitDelayTime": "{5}", "ShowEmailAddress": "{6}", "surveyEnabled": "{7}", "governanceServiceEnabled": "{8}", "governanceServiceConfig": "{9}", "personalizerEnabled": "{10}"',Tb,Fb,rb,Qb,Bc,lb,Ad,wb,bc,na.c(eb.governanceServiceConfig),Sb)}q2i(){return Ib(null,this.oZe)?
(k.ULS.sendTraceTag(593278928,356,50,"SIFB Info:LinkedIn - Floodgate AutoDismissTimeEnum:0"),0):r.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.FloodgatePromptAutoDismissEnum",r.AFrameworkApplication.fa.Fc("FloodgateUIAutoDismissTimeEnum",2))}G0f(){return r.AFrameworkApplication.fa.Fc("FloodgateContextAndInitDelayInMilliSeconds",uc.PIi)}KZd(eb){this.isInitialized=!0;this.B7h();ta.a.u5k(Object(e.a)(this,this.L2j,"logTriggerEvent"));if(eb){for(const Tb of eb.GMa)Tb.N6e?(0,Tb.N6e)(Tb.activityName(),
Tb.object()):Tb.M6e?(0,Tb.M6e)(Tb.object()):k.ULS.sendTraceTag(38605913,356,10,"SIFB Error:callerData callback actions were null");eb.Yri()}else k.ULS.sendTraceTag(37623954,356,10,"SIFB Error:callerData was null");try{const Tb=this.dQ.getContext(null),lb=ta.a.H_f(Array.isArray(Tb.Flights)?Tb.Flights:null),Fb=lb?Object(n.a)(String,lb.SelfTriggerActivity):null;if(Fb)for(const rb of Fb.split(";"))rb&&""!==rb&&this.logActivity(rb,null)}catch(Tb){k.ULS.sendTraceTag(51131788,356,10,"SIFB Error:error posting webactivities "+
(Tb?Tb.toString():""))}}B7h(){if(!this.Yfg&&window.addEventListener){const eb=Object(e.a)(this,this.vuk,"onWebCampaignEvent");window.addEventListener("FGWebSurfaceEvent",eb,!0);this.Yfg=!0}}Xng(eb,Tb){eb&&(r.AFrameworkApplication.fk(eb),r.AFrameworkApplication.Aac(eb));k.ULS.sendTraceTag(50704975,306,50,"Web Campaign UI launched. "+Tb)}LJj(eb){if(!eb)return!1;try{const Tb=(r.AFrameworkApplication.fa.Ha("FlightId")||"").toLocaleLowerCase(),lb=eb.toString().toLocaleLowerCase().split(";");for(const Fb of lb)if(2<
Fb.length&&(Fb.lastIndexOf("-control")===Fb.length-8||Fb.lastIndexOf("cf")===Fb.length-2&&-1!==Tb.indexOf(Fb)))return!0}catch(Tb){k.ULS.sendTraceTag(512505555,306,50,"Error serializing campaign event -"+(Tb?Tb.toString():""))}return!1}L2j(eb,Tb){Tb=Tb||{};if(eb&&!("isControl"in Tb)){const lb=this.LJj(eb);lb&&(Tb.isControl=lb)}this.Xng(eb,JSON.stringify(Tb))}vuk(eb){if(eb=eb?eb.detail:null){var Tb=!r.AFrameworkApplication.fa.ka("WacFloodgateNotificationsIntegrationIsEnabled"),lb=(eb.action||"").toLowerCase();
switch(lb){case "dismissed":Tb&&kb.a.instance.Ho("obf-DynamicWebSurfaces");break;case "updated":Tb&&ta.a.Zqa("obf-DynamicWebSurfaces");break;case "opened":case "":lb=eb.telemetryEventName;let Fb;try{Fb=JSON.stringify(eb)}catch(rb){Fb="id : "+eb.id+" telemetryEventName: "+lb,k.ULS.sendTraceTag(51131789,306,50,"Error serializing campaign event. "+Fb+" Error: "+(rb?rb.toString():""))}eb.success?this.Xng(lb,Fb):k.ULS.sendTraceTag(50422098,306,10,"Error launching Web Campaign UI."+Fb);eb.isHidden||eb.isAA||
!Tb||ta.a.Zqa("obf-DynamicWebSurfaces");break;default:k.ULS.sendTraceTag(594626399,306,50,"Unrecognized action "+lb)}}}atl(eb){var Tb=["Live"];if(!eb)return null;try{const lb=na.b(eb),Fb=new J.a;for(const rb of lb){const Qb=rb.Tags;if(Qb)for(const Bc of Tb)Array.contains(Qb,Bc)&&Fb.add(rb)}return na.c(Fb.toArray())}catch(lb){return k.ULS.sendTraceTag(523904348,356,10,"Could not deserialize CampaignDefinitionsJson"),null}}qal(){let eb=!1,Tb=null;const lb=this.oSc();if(lb&&this.brb)try{let Fb=this.brb.j3i();
r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.Excel.FilterOfficeLiveSurvey",!1)&&r.AFrameworkApplication.iua&&(Fb=this.atl(Fb));Fb?(lb.setItem(uc.Jni,Fb),eb=!0):(Tb="SIFB.campaign str was null",k.ULS.sendTraceTag(594143442,356,10,Tb))}catch(Fb){Tb="SIFB.Floodgate surveys !available. Exception writing to localStorage:SetupCampaigns: "+Fb,k.ULS.sendTraceTag(594143441,356,50,Tb)}else this.brb?(Tb="SIFB.Floodgate surveys !available. Campaign !set.Storage.Local was null",k.ULS.sendTraceTag(594143440,
356,50,Tb)):(Tb="SIFB.Floodgate surveys not available. App Specific Feedback data was null",k.ULS.sendTraceTag(556896920,356,50,Tb));k.ULS.sendTraceTag(37856258,356,50,"SIFB:Exiting SetupCampaigns "+eb+" errorString: "+(Tb?Tb:"null"))}PGe(eb,Tb){ka.a.eGb()&&k.ULS.sendTraceTag(36546397,356,50,"SIFB.Floodgate dismissed, submitted:{0}, campaingId:{1}",Tb,eb);ka.a.SUa()&&da.c(Tb?E.a.dCl:E.a.cCl,!0,null,2,8);kb.a.instance.Ho(ta.a.WUf)}initOptions(){}R$k(){this.l1a||(jb.a.addHandler(window.self,Hc.a.focus,
Object(e.a)(this,this.Yjc,"onWindowFocus")),jb.a.addHandler(window.self,Hc.a.blur,Object(e.a)(this,this.yuk,"onWindowBlur")))}oSc(){if(!this.f7b)return null;let eb=null;try{eb=localStorage}catch(Tb){this.f7b=!1,eb=null,k.ULS.sendTraceTag(594052320,356,50,"SIFB.GetLocalStorage error "+(Tb?Tb.toString():""))}return eb}iEj(){k.ULS.sendTraceTag(39077269,356,50,"inside InitializeUIStringGetter");try{this.na=new ya.a(Da.a.jp()),this.na.$("nps_Title",CommonUIStrings.l_WAC_NPS_Title),this.na.$("nps_PromptQuestion",
CommonUIStrings.l_WAC_NPS_PromptQuestion),this.na.$("nps_RatingQuestion",CommonUIStrings.l_WAC_NPS_RatingQuestion),this.na.$("nps_RatingQuestion_Word",uc.G6f()),this.na.$("nps_RatingQuestion_OneNote",uc.enj()),this.na.$("nps_OneClickPromptQuestion_PPT",CommonUIStrings.l_WAC_NPS_OneClickPromptQuestion_PPT),this.na.$("nps_OneClickPromptQuestion_Excel",CommonUIStrings.l_WAC_NPS_OneClickPromptQuestion_Excel),this.na.$("nps_OneClickRatingQuestion_Excel",uc.E6f()),this.na.$("nps_OneClickRatingQuestion_PowerPoint",
uc.F6f()),this.na.$("nps_RatingQuestion_PowerPoint",uc.F6f()),this.na.$("nps_RatingQuestion_Excel",uc.E6f()),this.na.$("nps_RatingQuestion_Visio",CommonUIStrings.l_WAC_NPS_RatingQuestion_Visio),this.na.$("nps_Rating_Values_1",CommonUIStrings.l_WAC_NPS_Rating_Values_1),this.na.$("nps_Rating_Values_2",CommonUIStrings.l_WAC_NPS_Rating_Values_2),this.na.$("nps_Rating_Values_3",CommonUIStrings.l_WAC_NPS_Rating_Values_3),this.na.$("nps_Rating_Values_4",CommonUIStrings.l_WAC_NPS_Rating_Values_4),this.na.$("nps_Rating_Values_5",
CommonUIStrings.l_WAC_NPS_Rating_Values_5),this.na.$("nps_QuestionQuestion",CommonUIStrings.l_WAC_NPS_Rating_QuestionQuestion),this.na.$("nps_OneClickPromptQuestion",CommonUIStrings.l_WAC_NPS_OneClickPromptQuestion),this.na.$("nps_OneClickRatingQuestion_Word",uc.G6f()),this.na.$("nps_OneClickRating_Values_1",CommonUIStrings.l_WAC_NPS_OneClickRating_Values_1),this.na.$("nps_OneClickRating_Values_2",CommonUIStrings.l_WAC_NPS_OneClickRating_Values_2),this.na.$("nps_OneClickRating_Values_3",CommonUIStrings.l_WAC_NPS_OneClickRating_Values_3),
this.na.$("nps_OneClickRating_Values_4",CommonUIStrings.l_WAC_NPS_OneClickRating_Values_4),this.na.$("nps_OneClickRating_Values_5",CommonUIStrings.l_WAC_NPS_OneClickRating_Values_5),this.na.$("nps_Suite_RatingQuestion","How likely are you to recommend Microsoft 365 to others, if asked?"),this.na.$("nps_Suite_QuestionQuestion","Please tell us more. Why did you choose that answer?"),this.na.$("NSVPromptTitle",CommonUIStrings.l_Excel_NSV_Prompt),this.na.$("NSVTimedSurvey_Question",CommonUIStrings.l_Excel_NSV_Overview_Question),
this.na.$("SatisfactionRating_1",CommonUIStrings.l_Excel_Rating_1_Satisfied),this.na.$("SatisfactionRating_2",CommonUIStrings.l_Excel_Rating_2_Satisfied),this.na.$("SatisfactionRating_3",CommonUIStrings.l_Excel_Rating_3_Satisfied),this.na.$("SatisfactionRating_4",CommonUIStrings.l_Excel_Rating_4_Satisfied),this.na.$("SatisfactionRating_5",CommonUIStrings.l_Excel_Rating_5_Satisfied),this.na.$("NSV_Timed_Feedback_Freeform_Question",CommonUIStrings.l_Excel_NSV_Timed_Feedback_Freeform_Question),this.na.$("NSV_Prompt_Title_Feedback",
CommonUIStrings.l_Title_For_NSV_Floodgate_Prompt),this.na.$("NSVDidntCreateSheetViewQuestion",CommonUIStrings.l_NSV_Didnt_Create_NSV_Survey_Question),this.na.$("NSVDidntCreateNSVOption_1",CommonUIStrings.l_NSV_Didnt_Create_NSV_Option_1),this.na.$("NSVDidntCreateNSVOption_2",CommonUIStrings.l_NSV_Didnt_Create_NSV_Option_2),this.na.$("NSVDidntCreateNSVOption_3",CommonUIStrings.l_NSV_Didnt_Create_NSV_Option_3),this.na.$("NSVDidntCreateNSVOption_4",CommonUIStrings.l_NSV_Didnt_Create_NSV_Option_4),this.na.$("NSVFreeformDidntCreateSheetView",
CommonUIStrings.l_NSV_Freeform_Reason_Didnt_Create_SheetView),this.na.$("NSVDidntCreatePrompt",CommonUIStrings.l_NSV_Didnt_Create_SheetView_Prompt),this.na.$("NSVPromptQuestion",CommonUIStrings.l_NSV_PromptQuestion),this.na.$("CatchUpFPS_Title",CommonUIStrings.l_WAC_CatchUpFPS_Title),this.na.$("CatchUpFPS_Question",CommonUIStrings.l_WAC_CatchUpFPS_Question),this.na.$("CatchUpFPS_YesLabel",CommonUIStrings.l_WAC_CatchUpFPS_YesLabel),this.na.$("CatchUpFPS_NoLabel",CommonUIStrings.l_WAC_CatchUpFPS_NoLabel),
this.na.$("CatchUpFPS_RatingQuestion",CommonUIStrings.l_WAC_CatchUpFPS_RatingQuestion),this.na.$("CatchUpFPS_RatingValue_1",CommonUIStrings.l_WAC_CatchUpFPS_RatingValue_1),this.na.$("CatchUpFPS_RatingValue_2",CommonUIStrings.l_WAC_CatchUpFPS_RatingValue_2),this.na.$("CatchUpFPS_RatingValue_3",CommonUIStrings.l_WAC_CatchUpFPS_RatingValue_3),this.na.$("CatchUpFPS_RatingValue_4",CommonUIStrings.l_WAC_CatchUpFPS_RatingValue_4),this.na.$("CatchUpFPS_RatingValue_5",CommonUIStrings.l_WAC_CatchUpFPS_RatingValue_5),
this.na.$("CatchUpFPS_WhyQuestion",CommonUIStrings.l_WAC_CatchUpFPS_WhyQuestion),this.na.$("ReviewMode_FloodgatePromptTitle",CommonUIStrings.l_WAC_ReviewMode_FloodgatePromptTitle),this.na.$("ReviewMode_FloodgatePromptQuestion",CommonUIStrings.l_WAC_ReviewMode_FloodgatePromptQuestion),this.na.$("ReviewMode_FloodgatePrompt_YesLabel",CommonUIStrings.l_WAC_ReviewMode_FloodgatePrompt_YesLabel),this.na.$("ReviewMode_FloodgatePrompt_NoLabel",CommonUIStrings.l_WAC_ReviewMode_FloodgatePrompt_NoLabel),this.na.$("ReviewMode_FloodgateRatingQuestion",
CommonUIStrings.l_WAC_ReviewMode_FloodgateRatingQuestion),this.na.$("ReviewMode_FloodgateRating_1",CommonUIStrings.l_WAC_ReviewMode_FloodgateRating_1),this.na.$("ReviewMode_FloodgateRating_2",CommonUIStrings.l_WAC_ReviewMode_FloodgateRating_2),this.na.$("ReviewMode_FloodgateRating_3",CommonUIStrings.l_WAC_ReviewMode_FloodgateRating_3),this.na.$("ReviewMode_FloodgateRating_4",CommonUIStrings.l_WAC_ReviewMode_FloodgateRating_4),this.na.$("ReviewMode_FloodgateRating_5",CommonUIStrings.l_WAC_ReviewMode_FloodgateRating_5),
this.na.$("ReviewMode_FloodgateQuestion",CommonUIStrings.l_WAC_ReviewMode_FloodgateQuestion),this.na.$("collab_RatingQuestion_Visio",CommonUIStrings.l_Visio_Collab_RatingQuestion),this.na.$("collab_Title_Visio",CommonUIStrings.l_Visio_Collab_Title),this.na.$("collab_Prompt_Question_Visio",CommonUIStrings.l_Visio_Collab_Prompt_Question),this.na.$("collab_Rating_Values_1",CommonUIStrings.l_Visio_Collab_FPS_Rating_Values_1),this.na.$("collab_Rating_Values_2",CommonUIStrings.l_Visio_Collab_FPS_Rating_Values_2),
this.na.$("collab_Rating_Values_3",CommonUIStrings.l_Visio_Collab_FPS_Rating_Values_3),this.na.$("collab_Rating_Values_4",CommonUIStrings.l_Visio_Collab_FPS_Rating_Values_4),this.na.$("collab_Rating_Values_5",CommonUIStrings.l_Visio_Collab_FPS_Rating_Values_5),this.na.$("collab_Question_Visio",CommonUIStrings.l_Visio_Collab_Question),this.na.$("connector_campaign_Survey_Question",CommonUIStrings.l_VisioWeb_ConnectorCampaign_Survey_Question),this.na.$("connector_campaign_Title",CommonUIStrings.l_VisioWeb_ConnectorCampaign_Title),
this.na.$("connector_campaign_Prompt_Question",CommonUIStrings.l_VisioWeb_ConnectorCampaign_Prompt_Question),this.na.$("connector_campaign_Rating_Values_1",CommonUIStrings.l_VisioWeb_ConnectorCampaign_Rating_Values_1),this.na.$("connector_campaign_Rating_Values_2",CommonUIStrings.l_VisioWeb_ConnectorCampaign_Rating_Values_2),this.na.$("connector_campaign_Rating_Values_3",CommonUIStrings.l_VisioWeb_ConnectorCampaign_Rating_Values_3),this.na.$("connector_campaign_Rating_Values_4",CommonUIStrings.l_VisioWeb_ConnectorCampaign_Rating_Values_4),
this.na.$("connector_campaign_Rating_Values_5",CommonUIStrings.l_VisioWeb_ConnectorCampaign_Rating_Values_5),this.na.$("connector_campaign_Verbatim_Question",CommonUIStrings.l_VisioWeb_ConnectorCampaign_Verbatim_Question),this.na.$("WordFollowUpFeelingsFPS_PromptTitle",CommonUIStrings.l_WordFollowUpFeelingsFPS_PromptTitle),this.na.$("WordFollowUpFeelingsFPS_PromptQuestion",CommonUIStrings.l_WordFollowUpFeelingsFPS_PromptQuestion),this.na.$("WordFollowUpFeelingsFPS_Prompt_YesLabel",CommonUIStrings.l_WordFollowUpFeelingsFPS_Prompt_YesLabel),
this.na.$("WordFollowUpFeelingsFPS_Prompt_NoLabel",CommonUIStrings.l_WordFollowUpFeelingsFPS_Prompt_NoLabel),this.na.$("WordFollowUpFeelingsFPS_RatingQuestion",CommonUIStrings.l_WordFollowUpFeelingsFPS_RatingQuestion),this.na.$("WordFollowUpFeelingsFPS_RatingValue_1",CommonUIStrings.l_WordFollowUpFeelingsFPS_RatingValue_1),this.na.$("WordFollowUpFeelingsFPS_RatingValue_2",CommonUIStrings.l_WordFollowUpFeelingsFPS_RatingValue_2),this.na.$("WordFollowUpFeelingsFPS_RatingValue_3",CommonUIStrings.l_WordFollowUpFeelingsFPS_RatingValue_3),
this.na.$("WordFollowUpFeelingsFPS_RatingValue_4",CommonUIStrings.l_WordFollowUpFeelingsFPS_RatingValue_4),this.na.$("WordFollowUpFeelingsFPS_RatingValue_5",CommonUIStrings.l_WordFollowUpFeelingsFPS_RatingValue_5),this.na.$("WordFollowUpFeelingsFPS_WhyQuestion",CommonUIStrings.l_WordFollowUpFeelingsFPS_WhyQuestion),this.na.$("DictationV2_Title",CommonUIStrings.l_WAC_DictationV2_FloodgateSurvey_Title),this.na.$("DictationV2_GreetingQuestion",CommonUIStrings.l_WAC_DictationV2_FloodgateSurvey_GreetingQuestion),
this.na.$("DictationV2_GreetingAnswer_Sure",CommonUIStrings.l_WAC_DictationV2_FloodgateSurvey_GreetingAnswer_Sure),this.na.$("DictationV2_GreetingAnswer_Notnow",CommonUIStrings.l_WAC_DictationV2_FloodgateSurvey_GreetingAnswer_Notnow),this.na.$("DictationV2_RatingQuestion",CommonUIStrings.l_WAC_DictationV2_FloodgateSurvey_RatingQuestion),this.na.$("DictationV2_RatingAnswer_1",CommonUIStrings.l_WAC_DictationV2_FloodgateSurvey_RatingAnswer_1),this.na.$("DictationV2_RatingAnswer_2",CommonUIStrings.l_WAC_DictationV2_FloodgateSurvey_RatingAnswer_2),
this.na.$("DictationV2_RatingAnswer_3",CommonUIStrings.l_WAC_DictationV2_FloodgateSurvey_RatingAnswer_3),this.na.$("DictationV2_RatingAnswer_4",CommonUIStrings.l_WAC_DictationV2_FloodgateSurvey_RatingAnswer_4),this.na.$("DictationV2_RatingAnswer_5",CommonUIStrings.l_WAC_DictationV2_FloodgateSurvey_RatingAnswer_5),this.na.$("DictationV2_PromptQuestion",CommonUIStrings.l_WAC_DictationV2_FloodgateSurvey_PromptQuestion),this.na.$("OfficeScriptsFPS_Title",CommonUIStrings.l_WAC_OfficeScriptsFPS_Title),
this.na.$("OfficeScriptsFPS_Question",CommonUIStrings.l_WAC_OfficeScriptsFPS_Question),this.na.$("OfficeScriptsFPS_YesLabel",CommonUIStrings.l_WAC_OfficeScriptsFPS_YesLabel),this.na.$("OfficeScriptsFPS_NoLabel",CommonUIStrings.l_WAC_OfficeScriptsFPS_NoLabel),this.na.$("OfficeScriptsFPS_RatingQuestion",CommonUIStrings.l_WAC_OfficeScriptsFPS_RatingQuestion),this.na.$("OfficeScriptsFPS_RatingValue_1",CommonUIStrings.l_WAC_OfficeScriptsFPS_RatingValue_1),this.na.$("OfficeScriptsFPS_RatingValue_2",CommonUIStrings.l_WAC_OfficeScriptsFPS_RatingValue_2),
this.na.$("OfficeScriptsFPS_RatingValue_3",CommonUIStrings.l_WAC_OfficeScriptsFPS_RatingValue_3),this.na.$("OfficeScriptsFPS_RatingValue_4",CommonUIStrings.l_WAC_OfficeScriptsFPS_RatingValue_4),this.na.$("OfficeScriptsFPS_RatingValue_5",CommonUIStrings.l_WAC_OfficeScriptsFPS_RatingValue_5),this.na.$("OfficeScriptsFPS_WhyQuestion",CommonUIStrings.l_WAC_OfficeScriptsFPS_WhyQuestion),this.na.$("ExcelAddins_Prompt",CommonUIStrings.l_Excel_Addins_Prompt),this.na.$("ExcelAddins_PromptQuestion",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),
this.na.$("ExcelAddins_Rating_Question",CommonUIStrings.l_Excel_Addins_Rating_Question),this.na.$("ExcelAddins_QuestionQuestion",CommonUIStrings.l_Excel_Addins_QuestionQuestion),this.na.$("ExcelAddins_Rating_1_Expectations",CommonUIStrings.l_Excel_Addins_Choice_1),this.na.$("ExcelAddins_Rating_2_Expectations",CommonUIStrings.l_Excel_Addins_Choice_2),this.na.$("ExcelAddins_Rating_3_Expectations",CommonUIStrings.l_Excel_Addins_Choice_3),this.na.$("ExcelAddins_Rating_4_Expectations",CommonUIStrings.l_Excel_Addins_Choice_4),
this.na.$("ExcelAddins_Rating_5_Expectations",CommonUIStrings.l_Excel_Addins_Choice_5),this.na.$("ExcelIdeas_Prompt",CommonUIStrings.l_Excel_Ideas_Prompt),this.na.$("ExcelIdeas_PromptQuestion",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.na.$("ExcelIdeas_Rating_Question",CommonUIStrings.l_Excel_Ideas_Rating_Question),this.na.$("ExcelIdeas_ExpectationsQuestion",CommonUIStrings.l_Excel_Ideas_ExpectationsQuestion),this.na.$("ExcelIdeas_Rating_1_Expectations",CommonUIStrings.l_Excel_Rating_1_Expectations),
this.na.$("ExcelIdeas_Rating_2_Expectations",CommonUIStrings.l_Excel_Rating_2_Expectations),this.na.$("ExcelIdeas_Rating_3_Expectations",CommonUIStrings.l_Excel_Rating_3_Expectations),this.na.$("ExcelIdeas_Rating_4_Expectations",CommonUIStrings.l_Excel_Rating_4_Expectations),this.na.$("ExcelIdeas_Rating_5_Expectations",CommonUIStrings.l_Excel_Rating_5_Expectations),this.na.$("ExcelRecommendedCharts_Prompt",CommonUIStrings.l_Excel_RecommendedCharts_Prompt),this.na.$("ExcelRecommendedCharts_PromptQuestion",
CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.na.$("ExcelRecommendedCharts_Rating_Question",CommonUIStrings.l_Excel_RecommendedCharts_Rating_Question),this.na.$("ExcelRecommendedCharts_WhyQuestion",CommonUIStrings.l_Excel_RecommendedCharts_WhyQuestion),this.na.$("ExcelRecommendedCharts_Rating_1_Satisfied",CommonUIStrings.l_ExcelRecommendedCharts_Rating_1_Satisfied),this.na.$("ExcelRecommendedCharts_Rating_2_Satisfied",CommonUIStrings.l_ExcelRecommendedCharts_Rating_2_Satisfied),this.na.$("ExcelRecommendedCharts_Rating_3_Satisfied",
CommonUIStrings.l_ExcelRecommendedCharts_Rating_3_Satisfied),this.na.$("ExcelRecommendedCharts_Rating_4_Satisfied",CommonUIStrings.l_ExcelRecommendedCharts_Rating_4_Satisfied),this.na.$("ExcelRecommendedCharts_Rating_5_Satisfied",CommonUIStrings.l_ExcelRecommendedCharts_Rating_5_Satisfied),this.na.$("ExcelRecommendedPivotTable_Prompt",CommonUIStrings.l_Excel_RecommendedPivotTable_Prompt),this.na.$("ExcelRecommendedPivotTable_PromptQuestion",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.na.$("ExcelRecommendedPivotTable_Rating_Question",
CommonUIStrings.l_Excel_RecommendedPivotTable_Rating_Question),this.na.$("ExcelRecommendedPivotTable_ExpectationsQuestion",CommonUIStrings.l_Excel_RecommendedPivotTable_ExpectationsQuestion),this.na.$("ExcelRecommendedPivotTable_Rating_1_Expectations",CommonUIStrings.l_Excel_Rating_1_Expectations),this.na.$("ExcelRecommendedPivotTable_Rating_2_Expectations",CommonUIStrings.l_Excel_Rating_2_Expectations),this.na.$("ExcelRecommendedPivotTable_Rating_3_Expectations",CommonUIStrings.l_Excel_Rating_3_Expectations),
this.na.$("ExcelRecommendedPivotTable_Rating_4_Expectations",CommonUIStrings.l_Excel_Rating_4_Expectations),this.na.$("ExcelRecommendedPivotTable_Rating_5_Expectations",CommonUIStrings.l_Excel_Rating_5_Expectations),this.na.$("Download_as_Image_Rating_Question",CommonUIStrings.l_Visio_Download_As_Image_Rating_Question),this.na.$("Download_as_Image_Title",CommonUIStrings.l_Visio_Download_As_Image_Title),this.na.$("Download_as_Image_Prompt_Question",CommonUIStrings.l_Visio_FPS_Prompt_Question),this.na.$("Download_as_Image_Rating_Values_1",
CommonUIStrings.l_Visio_FPS_Rating_Values_1),this.na.$("Download_as_Image_Rating_Values_2",CommonUIStrings.l_Visio_FPS_Rating_Values_2),this.na.$("Download_as_Image_Rating_Values_3",CommonUIStrings.l_Visio_FPS_Rating_Values_3),this.na.$("Download_as_Image_Rating_Values_4",CommonUIStrings.l_Visio_FPS_Rating_Values_4),this.na.$("Download_as_Image_Rating_Values_5",CommonUIStrings.l_Visio_FPS_Rating_Values_5),this.na.$("Download_as_Image_Question",CommonUIStrings.l_Visio_FPS_General_Question),this.na.$("TextPredictions_FloodgatePromptTitle",
CommonUIStrings.l_WAC_TextPredictions_FloodgatePromptTitle),this.na.$("TextPredictions_FloodgatePromptQuestion",CommonUIStrings.l_WAC_TextPredictions_FloodgatePromptQuestion),this.na.$("TextPredictions_FloodgatePrompt_YesLabel",CommonUIStrings.l_WAC_TextPredictions_FloodgatePrompt_YesLabel),this.na.$("TextPredictions_FloodgatePrompt_NoLabel",CommonUIStrings.l_WAC_TextPredictions_FloodgatePrompt_NoLabel),this.na.$("TextPredictions_FloodgateRatingQuestion",CommonUIStrings.l_WAC_TextPredictions_FloodgateRatingQuestion),
this.na.$("TextPredictions_FloodgateRating_1",CommonUIStrings.l_WAC_TextPredictions_FloodgateRating_1),this.na.$("TextPredictions_FloodgateRating_2",CommonUIStrings.l_WAC_TextPredictions_FloodgateRating_2),this.na.$("TextPredictions_FloodgateRating_3",CommonUIStrings.l_WAC_TextPredictions_FloodgateRating_3),this.na.$("TextPredictions_FloodgateRating_4",CommonUIStrings.l_WAC_TextPredictions_FloodgateRating_4),this.na.$("TextPredictions_FloodgateRating_5",CommonUIStrings.l_WAC_TextPredictions_FloodgateRating_5),
this.na.$("TextPredictions_FloodgateQuestion",CommonUIStrings.l_WAC_TextPredictions_FloodgateQuestion),this.na.$("SoftwareITDiagrams_Title",CommonUIStrings.l_Visio_SoftwareITDiagrams_Title),this.na.$("SoftwareITDiagrams_Survey_Question",CommonUIStrings.l_VisioWeb_SoftwareITDiagrams_Survey_Question),this.na.$("SoftwareITDiagrams_Prompt_Question",CommonUIStrings.l_Visio_FPS_Prompt_Question1),this.na.$("SoftwareITDiagrams_Rating_Values_1",CommonUIStrings.l_Visio_FPS_Rating_Values_1a),this.na.$("SoftwareITDiagrams_Rating_Values_2",
CommonUIStrings.l_Visio_FPS_Rating_Values_2),this.na.$("SoftwareITDiagrams_Rating_Values_3",CommonUIStrings.l_Visio_FPS_Rating_Values_3),this.na.$("SoftwareITDiagrams_Rating_Values_4",CommonUIStrings.l_Visio_FPS_Rating_Values_4),this.na.$("SoftwareITDiagrams_Rating_Values_5",CommonUIStrings.l_Visio_FPS_Rating_Values_5),this.na.$("SofwareITDiagrams_Question",CommonUIStrings.l_Visio_FPS_General_Question),this.na.$("ExternalContent_FloodgatePromptTitle",CommonUIStrings.l_WAC_ExternalContent_FloodgatePromptTitle),
this.na.$("ExternalContent_FloodgatePromptQuestion",CommonUIStrings.l_WAC_ExternalContent_FloodgatePromptQuestion),this.na.$("ExternalContent_FloodgatePrompt_YesLabel",CommonUIStrings.l_WAC_ExternalContent_FloodgatePrompt_YesLabel),this.na.$("ExternalContent_FloodgatePrompt_NoLabel",CommonUIStrings.l_WAC_ExternalContent_FloodgatePrompt_NoLabel),this.na.$("ExternalContent_FloodgateRatingQuestion",CommonUIStrings.l_WAC_ExternalContent_FloodgateRatingQuestion),this.na.$("ExternalContent_FloodgateRating_1",
CommonUIStrings.l_WAC_ExternalContent_FloodgateRating_1),this.na.$("ExternalContent_FloodgateRating_2",CommonUIStrings.l_WAC_ExternalContent_FloodgateRating_2),this.na.$("ExternalContent_FloodgateRating_3",CommonUIStrings.l_WAC_ExternalContent_FloodgateRating_3),this.na.$("ExternalContent_FloodgateRating_4",CommonUIStrings.l_WAC_ExternalContent_FloodgateRating_4),this.na.$("ExternalContent_FloodgateRating_5",CommonUIStrings.l_WAC_ExternalContent_FloodgateRating_5),this.na.$("ExternalContent_FloodgateQuestion",
CommonUIStrings.l_WAC_ExternalContent_FloodgateQuestion),this.na.$("Translator_GreetingQuestion",CommonUIStrings.l_Word_Translator_Floodgate_GreetingQuestion),this.na.$("Translator_PromptTitle",CommonUIStrings.l_Word_Translator_Floodgate_PromptTitle),this.na.$("Translator_GreetingAnswer_NotNow",CommonUIStrings.l_Word_Translator_Floodgate_GreetingAnswer_NotNow),this.na.$("Translator_GreetingAnswer_Sure",CommonUIStrings.l_Word_Translator_Floodgate_GreetingAnswer_Sure),this.na.$("Translator_RatingQuestion",
CommonUIStrings.l_Word_Translator_Floodgate_RatingQuestion),this.na.$("Translator_RatingValue_1",CommonUIStrings.l_Word_Translator_Floodgate_RatingValue_1),this.na.$("Translator_RatingValue_2",CommonUIStrings.l_Word_Translator_Floodgate_RatingValue_2),this.na.$("Translator_RatingValue_3",CommonUIStrings.l_Word_Translator_Floodgate_RatingValue_3),this.na.$("Translator_RatingValue_4",CommonUIStrings.l_Word_Translator_Floodgate_RatingValue_4),this.na.$("Translator_RatingValue_5",CommonUIStrings.l_Word_Translator_Floodgate_RatingValue_5),
this.na.$("Translator_PromptQuestion",CommonUIStrings.l_Word_Translator_Floodgate_PromptQuestion),this.na.$("TeamsOpen_GreetingQuestion",CommonUIStrings.l_WAC_NPS_Title),this.na.$("TeamsOpen_PromptTitle",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.na.$("TeamsOpen_GreetingAnswer_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("TeamsOpen_GreetingAnswer_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("TeamsOpen_RatingQuestion_Word",CommonUIStrings.l_WAC_NPS_TeamsFileOpenFloodgate_Word),
this.na.$("TeamsOpen_RatingQuestion_Excel",CommonUIStrings.l_WAC_NPS_TeamsFileOpenFloodgate_Excel),this.na.$("TeamsOpen_RatingQuestion_PowerPoint",CommonUIStrings.l_WAC_NPS_TeamsFileOpenFloodgate_PowerPoint),this.na.$("TeamsOpen_Rating_Browser",CommonUIStrings.l_WAC_NPS_TeamsFileOpenFloodgate_Rating_Browser),this.na.$("TeamsOpen_Rating_Teams",CommonUIStrings.l_WAC_NPS_TeamsFileOpenFloodgate_Rating_Teams),this.na.$("TeamsOpen_PromptQuestion",CommonUIStrings.l_WAC_NPS_Rating_QuestionQuestion),this.na.$("LinkedIn_Title",
CommonUIStrings.l_LinkedIn_Title),this.na.$("LinkedIn_PromptQuestion",CommonUIStrings.l_LinkedIn_PromptQuestion),this.na.$("LinkedIn_QuestionQuestion",CommonUIStrings.l_LinkedIn_QuestionQuestion),this.na.$("LinkedIn_Rating_Values_1",CommonUIStrings.l_LinkedIn_Rating_Values_1),this.na.$("LinkedIn_Rating_Values_2",CommonUIStrings.l_LinkedIn_Rating_Values_2),this.na.$("LinkedIn_Rating_Values_3",CommonUIStrings.l_LinkedIn_Rating_Values_3),this.na.$("LinkedIn_Rating_Values_4",CommonUIStrings.l_LinkedIn_Rating_Values_4),
this.na.$("LinkedIn_Rating_Values_5",CommonUIStrings.l_LinkedIn_Rating_Values_5),this.na.$("Excel_LinkedIn_RatingQuestion",CommonUIStrings.l_Excel_LinkedIn_RatingQuestion),this.na.$("VHRestore_Title",CommonUIStrings.l_WAC_VHRestore_PromptTitle),this.na.$("VHRestore_PromptQuestion",CommonUIStrings.l_WAC_VHRestore_PromptQuestion),this.na.$("VHRestore_Sure",CommonUIStrings.l_WAC_VHRestore_Sure),this.na.$("VHRestore_NotNow",CommonUIStrings.l_WAC_VHRestore_NotNow),this.na.$("VHRestore_SurveyQuestion",
CommonUIStrings.l_WAC_VHRestore_SurveyQuestion),this.na.$("VHRestore_Answer_Options_1",CommonUIStrings.l_WAC_VHRestore_AnswerOption_1),this.na.$("VHRestore_Answer_Options_2",CommonUIStrings.l_WAC_VHRestore_AnswerOption_2),this.na.$("VHRestore_Answer_Options_3",CommonUIStrings.l_WAC_VHRestore_AnswerOption_3),this.na.$("VHRestore_Answer_Options_4",CommonUIStrings.l_WAC_VHRestore_AnswerOption_4),this.na.$("VHRestore_WhyQuestion",CommonUIStrings.l_WAC_VHRestore_WhyQuestion),this.na.$("ShowChanges_Prompt",
CommonUIStrings.l_Excel_ShowChanges_Prompt),this.na.$("ShowChanges_PromptQuestion",CommonUIStrings.l_Excel_ShowChanges_PromptQuestion),this.na.$("ShowChanges_PromptLabel_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("ShowChanges_PromptLabel_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("ShowChanges_RatingQuestion",CommonUIStrings.l_Excel_ShowChanges_RatingQuestion),this.na.$("ShowChanges_RatingValue_1",CommonUIStrings.l_Excel_ShowChanges_RatingValue_1),this.na.$("ShowChanges_RatingValue_2",
CommonUIStrings.l_Excel_ShowChanges_RatingValue_2),this.na.$("ShowChanges_RatingValue_3",CommonUIStrings.l_Excel_ShowChanges_RatingValue_3),this.na.$("ShowChanges_RatingValue_4",CommonUIStrings.l_Excel_ShowChanges_RatingValue_4),this.na.$("ShowChanges_RatingValue_5",CommonUIStrings.l_Excel_ShowChanges_RatingValue_5),this.na.$("ShowChanges_WhyQuestion",CommonUIStrings.l_Excel_ShowChanges_WhyQuestion),this.na.$("ModernUxExperiment_FloodgatePromptTitle",CommonUIStrings.l_ModernUxExperiment_Floodgate_PromptTitle),
this.na.$("ModernUxExperiment_FloodgatePromptQuestion",CommonUIStrings.l_ModernUxExperiment_Floodgate_PromptQuestion),this.na.$("ModernUxExperiment_FloodgatePromptAnswer_NotNow",CommonUIStrings.l_ModernUxExperiment_Floodgate_PromptAnswer_NotNow),this.na.$("ModernUxExperiment_FloodgatePromptAnswer_Sure",CommonUIStrings.l_ModernUxExperiment_Floodgate_PromptAnswer_Sure),this.na.$("ModernUxExperiment_FloodgateRatingQuestion",CommonUIStrings.l_ModernUxExperiment_Floodgate_RatingQuestion),this.na.$("ModernUxExperiment_FloodgateRatingValue_1",
CommonUIStrings.l_ModernUxExperiment_Floodgate_RatingValue_1),this.na.$("ModernUxExperiment_FloodgateRatingValue_2",CommonUIStrings.l_ModernUxExperiment_Floodgate_RatingValue_2),this.na.$("ModernUxExperiment_FloodgateRatingValue_3",CommonUIStrings.l_ModernUxExperiment_Floodgate_RatingValue_3),this.na.$("ModernUxExperiment_FloodgateRatingValue_4",CommonUIStrings.l_ModernUxExperiment_Floodgate_RatingValue_4),this.na.$("ModernUxExperiment_FloodgateRatingValue_5",CommonUIStrings.l_ModernUxExperiment_Floodgate_RatingValue_5),
this.na.$("ModernUxExperiment_FloodgateHearMoreQuestion",CommonUIStrings.l_ModernUxExperiment_Floodgate_HearMoreQuestion),this.na.$("FileBackedLoopComponents_FloodgatePromptTitle",CommonUIStrings.l_FileBackedLoopComponents_Floodgate_PromptTitle),this.na.$("FileBackedLoopComponents_FloodgatePromptQuestion",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.na.$("FileBackedLoopComponents_FloodgatePromptAnswer_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("FileBackedLoopComponents_FloodgatePromptAnswer_Sure",
CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("FileBackedLoopComponents_FloodgateRatingQuestion",CommonUIStrings.l_FileBackedLoopComponents_Floodgate_RatingQuestion),this.na.$("FileBackedLoopComponents_FloodgateRatingValue_1",CommonUIStrings.l_FileBackedLoopComponents_Floodgate_RatingValue_1),this.na.$("FileBackedLoopComponents_FloodgateRatingValue_2",CommonUIStrings.l_FileBackedLoopComponents_Floodgate_RatingValue_2),this.na.$("FileBackedLoopComponents_FloodgateRatingValue_3",CommonUIStrings.l_FileBackedLoopComponents_Floodgate_RatingValue_3),
this.na.$("FileBackedLoopComponents_FloodgateRatingValue_4",CommonUIStrings.l_FileBackedLoopComponents_Floodgate_RatingValue_4),this.na.$("FileBackedLoopComponents_FloodgateRatingValue_5",CommonUIStrings.l_FileBackedLoopComponents_Floodgate_RatingValue_5),this.na.$("FileBackedLoopComponents_FloodgateWhyQuestion",CommonUIStrings.l_FileBackedLoopComponents_Floodgate_FloodgateWhyQuestion),this.na.$("PollLoopComponent_FloodgatePromptTitle",CommonUIStrings.l_PollLoopComponent_Floodgate_PromptTitle),this.na.$("PollLoopComponent_FloodgatePromptQuestion",
CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.na.$("PollLoopComponent_FloodgatePromptAnswer_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("PollLoopComponent_FloodgatePromptAnswer_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("PollLoopComponent_FloodgateRatingQuestion",CommonUIStrings.l_PollLoopComponent_Floodgate_RatingQuestion),this.na.$("PollLoopComponent_FloodgateRatingValue_1",CommonUIStrings.l_PollLoopComponent_Floodgate_RatingValue_1),this.na.$("PollLoopComponent_FloodgateRatingValue_2",
CommonUIStrings.l_PollLoopComponent_Floodgate_RatingValue_2),this.na.$("PollLoopComponent_FloodgateRatingValue_3",CommonUIStrings.l_PollLoopComponent_Floodgate_RatingValue_3),this.na.$("PollLoopComponent_FloodgateRatingValue_4",CommonUIStrings.l_PollLoopComponent_Floodgate_RatingValue_4),this.na.$("PollLoopComponent_FloodgateRatingValue_5",CommonUIStrings.l_PollLoopComponent_Floodgate_RatingValue_5),this.na.$("PollLoopComponent_FloodgateWhyQuestion",CommonUIStrings.l_PollLoopComponent_Floodgate_FloodgateWhyQuestion),
this.na.$("TabSwitchTreatmentExperiment_FloodgatePromptTitle",CommonUIStrings.l_TabSwitchTreatmentExperiment_Floodgate_PromptTitle),this.na.$("TabSwitchTreatmentExperiment_FloodgatePromptQuestion",CommonUIStrings.l_TabSwitchTreatmentExperiment_Floodgate_PromptQuestion),this.na.$("TabSwitchTreatmentExperiment_FloodgatePromptAnswer_NotNow",CommonUIStrings.l_TabSwitchTreatmentExperiment_Floodgate_PromptAnswer_NotNow),this.na.$("TabSwitchTreatmentExperiment_FloodgatePromptAnswer_Sure",CommonUIStrings.l_TabSwitchTreatmentExperiment_Floodgate_PromptAnswer_Sure),
this.na.$("TabSwitchTreatmentExperiment_FloodgateRatingQuestion",CommonUIStrings.l_TabSwitchTreatmentExperiment_Floodgate_RatingQuestion),this.na.$("TabSwitchTreatmentExperiment_FloodgateRatingValue_1",CommonUIStrings.l_TabSwitchTreatmentExperiment_Floodgate_RatingValue_1),this.na.$("TabSwitchTreatmentExperiment_FloodgateRatingValue_2",CommonUIStrings.l_TabSwitchTreatmentExperiment_Floodgate_RatingValue_2),this.na.$("TabSwitchTreatmentExperiment_FloodgateRatingValue_3",CommonUIStrings.l_TabSwitchTreatmentExperiment_Floodgate_RatingValue_3),
this.na.$("TabSwitchTreatmentExperiment_FloodgateRatingValue_4",CommonUIStrings.l_TabSwitchTreatmentExperiment_Floodgate_RatingValue_4),this.na.$("TabSwitchTreatmentExperiment_FloodgateRatingValue_5",CommonUIStrings.l_TabSwitchTreatmentExperiment_Floodgate_RatingValue_5),this.na.$("TabSwitchTreatmentExperiment_FloodgateHearMoreQuestion",CommonUIStrings.l_TabSwitchTreatmentExperiment_Floodgate_HearMoreQuestion),this.na.$("TabSwitchControlExperiment_FloodgatePromptTitle",CommonUIStrings.l_TabSwitchControlExperiment_Floodgate_PromptTitle),
this.na.$("TabSwitchControlExperiment_FloodgatePromptQuestion",CommonUIStrings.l_TabSwitchControlExperiment_Floodgate_PromptQuestion),this.na.$("TabSwitchControlExperiment_FloodgatePromptAnswer_NotNow",CommonUIStrings.l_TabSwitchControlExperiment_Floodgate_PromptAnswer_NotNow),this.na.$("TabSwitchControlExperiment_FloodgatePromptAnswer_Sure",CommonUIStrings.l_TabSwitchControlExperiment_Floodgate_PromptAnswer_Sure),this.na.$("TabSwitchControlExperiment_FloodgateRatingQuestion",CommonUIStrings.l_TabSwitchControlExperiment_Floodgate_RatingQuestion),
this.na.$("TabSwitchControlExperiment_FloodgateRatingValue_1",CommonUIStrings.l_TabSwitchControlExperiment_Floodgate_RatingValue_1),this.na.$("TabSwitchControlExperiment_FloodgateRatingValue_2",CommonUIStrings.l_TabSwitchControlExperiment_Floodgate_RatingValue_2),this.na.$("TabSwitchControlExperiment_FloodgateRatingValue_3",CommonUIStrings.l_TabSwitchControlExperiment_Floodgate_RatingValue_3),this.na.$("TabSwitchControlExperiment_FloodgateRatingValue_4",CommonUIStrings.l_TabSwitchControlExperiment_Floodgate_RatingValue_4),
this.na.$("TabSwitchControlExperiment_FloodgateRatingValue_5",CommonUIStrings.l_TabSwitchControlExperiment_Floodgate_RatingValue_5),this.na.$("TabSwitchControlExperiment_FloodgateHearMoreQuestion",CommonUIStrings.l_TabSwitchControlExperiment_Floodgate_HearMoreQuestion),this.na.$("ShortcutDiscovery_PromptTitle",CommonUIStrings.l_ShortcutDiscovery_PromptTitle),this.na.$("ShortcutDiscovery_PromptQuestion",CommonUIStrings.l_ShortcutDiscovery_PromptQuestion),this.na.$("ShortcutDiscovery_PromptAnswer_NotNow",
CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("ShortcutDiscovery_PromptAnswer_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("ShortcutDiscovery_RatingQuestion",CommonUIStrings.l_ShortcutDiscovery_RatingQuestion),this.na.$("ShortcutDiscovery_RatingValue_1",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_1),this.na.$("ShortcutDiscovery_RatingValue_2",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_2),this.na.$("ShortcutDiscovery_RatingValue_3",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_3),
this.na.$("ShortcutDiscovery_RatingValue_4",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_4),this.na.$("ShortcutDiscovery_RatingValue_5",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_5),this.na.$("ShortcutDiscovery_WhyQuestion",CommonUIStrings.l_ShortcutDiscovery_WhyQuestion),this.na.$("Fonts_PromptTitle",CommonUIStrings.l_FontExperience_FloodgatePromptTitle),this.na.$("Fonts_PromptQuestion",CommonUIStrings.l_FontExperience_FloodgatePromptQuestion),this.na.$("Fonts_PromptAnswer_NotNow",
CommonUIStrings.l_FontExperience_FloodgatePromptAnswer_NotNow),this.na.$("Fonts_PromptAnswer_Sure",CommonUIStrings.l_FontExperience_FloodgatePromptAnswer_Sure),this.na.$("Fonts_RatingQuestion",CommonUIStrings.l_FontExperience_FloodgateRatingQuestion),this.na.$("Fonts_RatingValue_1",CommonUIStrings.l_FontExperience_FloodgateRatingValue_1),this.na.$("Fonts_RatingValue_2",CommonUIStrings.l_FontExperience_FloodgateRatingValue_2),this.na.$("Fonts_RatingValue_3",CommonUIStrings.l_FontExperience_FloodgateRatingValue_3),
this.na.$("Fonts_RatingValue_4",CommonUIStrings.l_FontExperience_FloodgateRatingValue_4),this.na.$("Fonts_RatingValue_5",CommonUIStrings.l_FontExperience_FloodgateRatingValue_5),this.na.$("Fonts_WhyQuestion",CommonUIStrings.l_FontExperience_FloodgateWhyQuestion),this.na.$("Ruler_PromptTitle",CommonUIStrings.l_WordRuler_PromptTitle),this.na.$("Ruler_PromptQuestion",CommonUIStrings.l_WordRuler_PromptQuestion),this.na.$("Ruler_PromptAnswer_NotNow",CommonUIStrings.l_WordRuler_PromptAnswer_NotNow),this.na.$("Ruler_PromptAnswer_Sure",
CommonUIStrings.l_WordRuler_PromptAnswer_Sure),this.na.$("Ruler_RatingQuestion",CommonUIStrings.l_WordRuler_RatingQuestion),this.na.$("Ruler_RatingValue_1",CommonUIStrings.l_WordRuler_RatingValue_1),this.na.$("Ruler_RatingValue_2",CommonUIStrings.l_WordRuler_RatingValue_2),this.na.$("Ruler_RatingValue_3",CommonUIStrings.l_WordRuler_RatingValue_3),this.na.$("Ruler_RatingValue_4",CommonUIStrings.l_WordRuler_RatingValue_4),this.na.$("Ruler_RatingValue_5",CommonUIStrings.l_WordRuler_RatingValue_5),this.na.$("Ruler_WhyQuestion",
CommonUIStrings.l_WordRuler_WhyQuestion),this.na.$("CustomTabDialog_PromptTitle",CommonUIStrings.l_CustomTabDialog_PromptTitle),this.na.$("CustomTabDialog_PromptQuestion",CommonUIStrings.l_CustomTabDialog_PromptQuestion),this.na.$("CustomTabDialog_PromptAnswer_NotNow",CommonUIStrings.l_CustomTabDialog_PromptAnswer_NotNow),this.na.$("CustomTabDialog_PromptAnswer_Sure",CommonUIStrings.l_CustomTabDialog_PromptAnswer_Sure),this.na.$("CustomTabDialog_RatingQuestion",CommonUIStrings.l_CustomTabDialog_RatingQuestion),
this.na.$("CustomTabDialog_RatingValue_1",CommonUIStrings.l_CustomTabDialog_RatingValue_1),this.na.$("CustomTabDialog_RatingValue_2",CommonUIStrings.l_CustomTabDialog_RatingValue_2),this.na.$("CustomTabDialog_RatingValue_3",CommonUIStrings.l_CustomTabDialog_RatingValue_3),this.na.$("CustomTabDialog_RatingValue_4",CommonUIStrings.l_CustomTabDialog_RatingValue_4),this.na.$("CustomTabDialog_RatingValue_5",CommonUIStrings.l_CustomTabDialog_RatingValue_5),this.na.$("CustomTabDialog_WhyQuestion",CommonUIStrings.l_CustomTabDialog_WhyQuestion),
this.na.$("WordStyles_FloodgatePromptTitle",CommonUIStrings.l_WordStyles_FloodgatePromptTitle),this.na.$("WordStyles_FloodgatePromptQuestion",CommonUIStrings.l_WordStyles_FloodgatePromptQuestion),this.na.$("WordStyles_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordStyles_FloodgatePrompt_YesLabel),this.na.$("WordStyles_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordStyles_FloodgatePrompt_NoLabel),this.na.$("WordStyles_FloodgateRatingQuestion",CommonUIStrings.l_WordStyles_FloodgateRatingQuestion),
this.na.$("WordStyles_FloodgateRating_1",CommonUIStrings.l_WordStyles_FloodgateRating_1),this.na.$("WordStyles_FloodgateRating_2",CommonUIStrings.l_WordStyles_FloodgateRating_2),this.na.$("WordStyles_FloodgateRating_3",CommonUIStrings.l_WordStyles_FloodgateRating_3),this.na.$("WordStyles_FloodgateRating_4",CommonUIStrings.l_WordStyles_FloodgateRating_4),this.na.$("WordStyles_FloodgateRating_5",CommonUIStrings.l_WordStyles_FloodgateRating_5),this.na.$("WordStyles_FloodgateWhyQuestion",CommonUIStrings.l_WordStyles_FloodgateWhyQuestion),
this.na.$("UnsavedChangesHighlight_PromptTitle",CommonUIStrings.l_WAC_WordUnsavedChangesHighlight_PromptTitle),this.na.$("UnsavedChangesHighlight_PromptQuestion",CommonUIStrings.l_WAC_WordUnsavedChangesHighlight_PromptQuestion),this.na.$("UnsavedChangesHighlight_Prompt_YesLabel",CommonUIStrings.l_WAC_WordUnsavedChangesHighlight_Prompt_YesLabel),this.na.$("UnsavedChangesHighlight_Prompt_NoLabel",CommonUIStrings.l_WAC_WordUnsavedChangesHighlight_Prompt_NoLabel),this.na.$("UnsavedChangesHighlight_RatingQuestion",
CommonUIStrings.l_WAC_WordUnsavedChangesHighlight_RatingQuestion),this.na.$("UnsavedChangesHighlight_Rating_Yes",CommonUIStrings.l_WAC_WordUnsavedChangesHighlight_Rating_Yes),this.na.$("UnsavedChangesHighlight_Rating_No",CommonUIStrings.l_WAC_WordUnsavedChangesHighlight_Rating_No),this.na.$("UnsavedChangesHighlight_CommentQuestion",CommonUIStrings.l_WAC_WordUnsavedChangesHighlight_CommentQuestion),this.na.$("WordUnifiedRead_FloodgatePromptTitle",CommonUIStrings.l_WordUnifiedRead_FloodgatePromptTitle),
this.na.$("WordUnifiedRead_FloodgatePromptQuestion",CommonUIStrings.l_WordUnifiedRead_FloodgatePromptQuestion),this.na.$("WordUnifiedRead_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordUnifiedRead_FloodgatePrompt_YesLabel),this.na.$("WordUnifiedRead_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordUnifiedRead_FloodgatePrompt_NoLabel),this.na.$("WordUnifiedRead_FloodgateRatingQuestion",CommonUIStrings.l_WordUnifiedRead_FloodgateRatingQuestion),this.na.$("WordUnifiedRead_FloodgateRating_1",CommonUIStrings.l_WordUnifiedRead_FloodgateRating_1),
this.na.$("WordUnifiedRead_FloodgateRating_2",CommonUIStrings.l_WordUnifiedRead_FloodgateRating_2),this.na.$("WordUnifiedRead_FloodgateRating_3",CommonUIStrings.l_WordUnifiedRead_FloodgateRating_3),this.na.$("WordUnifiedRead_FloodgateRating_4",CommonUIStrings.l_WordUnifiedRead_FloodgateRating_4),this.na.$("WordUnifiedRead_FloodgateRating_5",CommonUIStrings.l_WordUnifiedRead_FloodgateRating_5),this.na.$("WordUnifiedRead_FloodgateWhyQuestion",CommonUIStrings.l_WordUnifiedRead_FloodgateWhyQuestion),
this.na.$("GrammarSuggestions_FloodgatePromptTitle",CommonUIStrings.l_WAC_GrammarSuggestions_FloodgatePromptTitle),this.na.$("GrammarSuggestions_FloodgatePromptQuestion",CommonUIStrings.l_WAC_GrammarSuggestions_FloodgatePromptQuestion),this.na.$("GrammarSuggestions_FloodgatePrompt_YesLabel",CommonUIStrings.l_WAC_GrammarSuggestions_FloodgatePrompt_YesLabel),this.na.$("GrammarSuggestions_FloodgatePrompt_NoLabel",CommonUIStrings.l_WAC_GrammarSuggestions_FloodgatePrompt_NoLabel),this.na.$("GrammarSuggestions_FloodgateRatingQuestion",
CommonUIStrings.l_WAC_GrammarSuggestions_FloodgateRatingQuestion),this.na.$("GrammarSuggestions_FloodgateRating_1",CommonUIStrings.l_WAC_GrammarSuggestions_FloodgateRating_1),this.na.$("GrammarSuggestions_FloodgateRating_2",CommonUIStrings.l_WAC_GrammarSuggestions_FloodgateRating_2),this.na.$("GrammarSuggestions_FloodgateRating_3",CommonUIStrings.l_WAC_GrammarSuggestions_FloodgateRating_3),this.na.$("GrammarSuggestions_FloodgateRating_4",CommonUIStrings.l_WAC_GrammarSuggestions_FloodgateRating_4),
this.na.$("GrammarSuggestions_FloodgateRating_5",CommonUIStrings.l_WAC_GrammarSuggestions_FloodgateRating_5),this.na.$("GrammarSuggestions_FloodgateQuestion",CommonUIStrings.l_WAC_GrammarSuggestions_FloodgateQuestion),this.na.$("WordRemoveSsr_FloodgatePromptTitle",CommonUIStrings.l_WordRemoveSsr_FloodgatePromptTitle),this.na.$("WordRemoveSsr_FloodgatePromptQuestion",CommonUIStrings.l_WordRemoveSsr_FloodgatePromptQuestion),this.na.$("WordRemoveSsr_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordRemoveSsr_FloodgatePrompt_YesLabel),
this.na.$("WordRemoveSsr_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordRemoveSsr_FloodgatePrompt_NoLabel),this.na.$("WordRemoveSsr_FloodgateRatingQuestion",CommonUIStrings.l_WordRemoveSsr_FloodgateRatingQuestion),this.na.$("WordRemoveSsr_FloodgateRating_1",CommonUIStrings.l_WordRemoveSsr_FloodgateRating_1),this.na.$("WordRemoveSsr_FloodgateRating_2",CommonUIStrings.l_WordRemoveSsr_FloodgateRating_2),this.na.$("WordRemoveSsr_FloodgateRating_3",CommonUIStrings.l_WordRemoveSsr_FloodgateRating_3),this.na.$("WordRemoveSsr_FloodgateRating_4",
CommonUIStrings.l_WordRemoveSsr_FloodgateRating_4),this.na.$("WordRemoveSsr_FloodgateRating_5",CommonUIStrings.l_WordRemoveSsr_FloodgateRating_5),this.na.$("WordRemoveSsr_FloodgateWhyQuestion",CommonUIStrings.l_WordRemoveSsr_FloodgateWhyQuestion),this.na.$("WordDrawing_FloodgatePromptTitle",CommonUIStrings.l_WordDrawing_FloodgatePromptTitle),this.na.$("WordDrawing_FloodgatePromptQuestion",CommonUIStrings.l_WordDrawing_FloodgatePromptQuestion),this.na.$("WordDrawing_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordDrawing_FloodgatePrompt_YesLabel),
this.na.$("WordDrawing_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordDrawing_FloodgatePrompt_NoLabel),this.na.$("WordDrawing_FloodgateRatingQuestion",CommonUIStrings.l_WordDrawing_FloodgateRatingQuestion),this.na.$("WordDrawing_FloodgateRating_1",CommonUIStrings.l_WordDrawing_FloodgateRating_1),this.na.$("WordDrawing_FloodgateRating_2",CommonUIStrings.l_WordDrawing_FloodgateRating_2),this.na.$("WordDrawing_FloodgateRating_3",CommonUIStrings.l_WordDrawing_FloodgateRating_3),this.na.$("WordDrawing_FloodgateRating_4",
CommonUIStrings.l_WordDrawing_FloodgateRating_4),this.na.$("WordDrawing_FloodgateRating_5",CommonUIStrings.l_WordDrawing_FloodgateRating_5),this.na.$("WordDrawing_FloodgateWhyQuestion",CommonUIStrings.l_WordDrawing_FloodgateWhyQuestion),this.na.$("WordPenNSAT_FloodgatePromptTitle",CommonUIStrings.l_WordPenNSAT_FloodgatePromptTitle),this.na.$("WordPenNSAT_FloodgatePromptQuestion",CommonUIStrings.l_WordPenNSAT_FloodgatePromptQuestion),this.na.$("WordPenNSAT_FloodgatePrompt_YesLabel",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),
this.na.$("WordPenNSAT_FloodgatePrompt_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("WordPenNSAT_FloodgateRatingQuestion",CommonUIStrings.l_WordPenNSAT_FloodgateRatingQuestion),this.na.$("WordPenNSAT_FloodgateRating_1",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_1_VeryDissatisfied),this.na.$("WordPenNSAT_FloodgateRating_2",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_2_SomewhatDissatisfied),this.na.$("WordPenNSAT_FloodgateRating_3",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_3_Neutral),
this.na.$("WordPenNSAT_FloodgateRating_4",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_4_SomewhatSatisfied),this.na.$("WordPenNSAT_FloodgateRating_5",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_5_VerySatisfied),this.na.$("WordPenNSAT_FloodgateWhyQuestion",CommonUIStrings.l_WordPenNSAT_FloodgateWhyQuestion),this.na.$("ShyRibbon_FloodgatePromptTitle",CommonUIStrings.l_ShyRibbon_FloodgatePromptTitle),this.na.$("ShyRibbon_FloodgatePromptQuestion",CommonUIStrings.l_ShyRibbon_FloodgatePromptQuestion),
this.na.$("ShyRibbon_FloodgatePrompt_YesLabel",CommonUIStrings.l_ShyRibbon_FloodgatePrompt_YesLabel),this.na.$("ShyRibbon_FloodgatePrompt_NoLabel",CommonUIStrings.l_ShyRibbon_FloodgatePrompt_NoLabel),this.na.$("ShyRibbon_Floodgate_Question",CommonUIStrings.l_ShyRibbon_Floodgate_Question),this.na.$("ShyRibbon_Floodgate_Option_1",CommonUIStrings.l_ShyRibbon_Floodgate_Option_1),this.na.$("ShyRibbon_Floodgate_Option_2",CommonUIStrings.l_ShyRibbon_Floodgate_Option_2),this.na.$("ShyRibbon_Floodgate_Option_3",
CommonUIStrings.l_ShyRibbon_Floodgate_Option_3),this.na.$("ShyRibbon_Floodgate_Option_4",CommonUIStrings.l_ShyRibbon_Floodgate_Option_4),this.na.$("ShyRibbon_Floodgate_Option_5",CommonUIStrings.l_ShyRibbon_Floodgate_Option_5),this.na.$("ShyRibbon_FloodgateTellusMore",CommonUIStrings.l_ShyRibbon_Floodgate_TellMore),this.na.$("WordAutoCorrect_FloodgatePromptTitle",CommonUIStrings.l_WordAutoCorrect_FloodgatePromptTitle),this.na.$("WordAutoCorrect_FloodgatePromptQuestion",CommonUIStrings.l_WordAutoCorrect_FloodgatePromptQuestion),
this.na.$("WordAutoCorrect_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordAutoCorrect_FloodgatePrompt_YesLabel),this.na.$("WordAutoCorrect_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordAutoCorrect_FloodgatePrompt_NoLabel),this.na.$("WordAutoCorrect_FloodgateRatingQuestion",CommonUIStrings.l_WordAutoCorrect_FloodgateRatingQuestion),this.na.$("WordAutoCorrect_FloodgateRating_1",CommonUIStrings.l_WordAutoCorrect_FloodgateRating_1),this.na.$("WordAutoCorrect_FloodgateRating_2",CommonUIStrings.l_WordAutoCorrect_FloodgateRating_2),
this.na.$("WordAutoCorrect_FloodgateRating_3",CommonUIStrings.l_WordAutoCorrect_FloodgateRating_3),this.na.$("WordAutoCorrect_FloodgateRating_4",CommonUIStrings.l_WordAutoCorrect_FloodgateRating_4),this.na.$("WordAutoCorrect_FloodgateRating_5",CommonUIStrings.l_WordAutoCorrect_FloodgateRating_5),this.na.$("WordAutoCorrect_FloodgateWhyQuestion",CommonUIStrings.l_WordAutoCorrect_FloodgateWhyQuestion),this.na.$("PasswordProtectedDocumentSupport_FloodgatePromptTitle",CommonUIStrings.l_PasswordProtectedDocumentSupport_FloodgatePromptTitle),
this.na.$("PasswordProtectedDocumentSupport_FloodgatePromptQuestion",CommonUIStrings.l_PasswordProtectedDocumentSupport_FloodgatePromptQuestion),this.na.$("PasswordProtectedDocumentSupport_FloodgatePrompt_YesLabel",CommonUIStrings.l_PasswordProtectedDocumentSupport_FloodgatePrompt_YesLabel),this.na.$("PasswordProtectedDocumentSupport_FloodgatePrompt_NoLabel",CommonUIStrings.l_PasswordProtectedDocumentSupport_FloodgatePrompt_NoLabel),this.na.$("PasswordProtectedDocumentSupport_FloodgateRatingQuestion",
CommonUIStrings.l_PasswordProtectedDocumentSupport_FloodgateRatingQuestion),this.na.$("PasswordProtectedDocumentSupport_FloodgateRating_1",CommonUIStrings.l_PasswordProtectedDocumentSupport_FloodgateRating_1),this.na.$("PasswordProtectedDocumentSupport_FloodgateRating_2",CommonUIStrings.l_PasswordProtectedDocumentSupport_FloodgateRating_2),this.na.$("PasswordProtectedDocumentSupport_FloodgateRating_3",CommonUIStrings.l_PasswordProtectedDocumentSupport_FloodgateRating_3),this.na.$("PasswordProtectedDocumentSupport_FloodgateRating_4",
CommonUIStrings.l_PasswordProtectedDocumentSupport_FloodgateRating_4),this.na.$("PasswordProtectedDocumentSupport_FloodgateRating_5",CommonUIStrings.l_PasswordProtectedDocumentSupport_FloodgateRating_5),this.na.$("PasswordProtectedDocumentSupport_FloodgateWhyQuestion",CommonUIStrings.l_PasswordProtectedDocumentSupport_FloodgateWhyQuestion),this.na.$("WordSimilarity_FloodgatePromptTitle",CommonUIStrings.l_WordSimilarity_FloodgatePromptTitle),this.na.$("WordSimilarity_FloodgatePromptQuestion",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),
this.na.$("WordSimilarity_FloodgatePrompt_YesLabel",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("WordSimilarity_FloodgatePrompt_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("WordSimilarity_FloodgateRatingQuestion",CommonUIStrings.l_WordSimilarity_FloodgateRatingQuestion),this.na.$("WordSimilarity_FloodgateRating_1",CommonUIStrings.l_WordSimilarity_FloodgateRating_1),this.na.$("WordSimilarity_FloodgateRating_2",CommonUIStrings.l_WordSimilarity_FloodgateRating_2),this.na.$("WordSimilarity_FloodgateRating_3",
CommonUIStrings.l_WordSimilarity_FloodgateRating_3),this.na.$("WordSimilarity_FloodgateRating_4",CommonUIStrings.l_WordSimilarity_FloodgateRating_4),this.na.$("WordSimilarity_FloodgateRating_5",CommonUIStrings.l_WordSimilarity_FloodgateRating_5),this.na.$("WordSimilarity_FloodgateWhyQuestion",CommonUIStrings.l_WordSimilarity_FloodgateWhyQuestion),this.na.$("PremiumPreviewFloodgateTitle",CommonUIStrings.l_PremiumPreview_FeedbackTitle),this.na.$("PremiumPreviewFloodgatePrompt",CommonUIStrings.l_PremiumPreview_FeedbackPrompt),
this.na.$("PremiumPreviewFloodgateRatingQuestion",CommonUIStrings.l_PremiumPreview_FeedbackRatingQuestion),this.na.$("PremiumPreviewFloodgateQuestion",CommonUIStrings.l_PremiumPreview_FeedbackQuestion1),this.na.$("PremiumPreviewFloodgateMinRating",CommonUIStrings.l_PremiumPreview_FeedbackMinRating),this.na.$("PremiumPreviewFloodgateMaxRating",CommonUIStrings.l_PremiumPreview_FeedbackMaxRating),this.na.$("FloodgateNLQSPromptTitle",CommonUIStrings.l_FloodgateNLQSPromptTitle),this.na.$("FloodgateNLQSPromptSubtitle",
CommonUIStrings.l_FloodgateNLQSPromptSubtitle),this.na.$("FloodgateNLQSPromptYes",CommonUIStrings.l_FloodgateNLQSPromptYes),this.na.$("FloodgateNLQSPromptNo",CommonUIStrings.l_FloodgateNLQSPromptNo),this.na.$("FloodgateNLQSRatingQuestion",CommonUIStrings.l_FloodgateNLQSRatingQuestion),this.na.$("FloodgateNLQSRating1",CommonUIStrings.l_FloodgateNLQSRating1),this.na.$("FloodgateNLQSRating2",CommonUIStrings.l_FloodgateNLQSRating2),this.na.$("FloodgateNLQSRating3",CommonUIStrings.l_FloodgateNLQSRating3),
this.na.$("FloodgateNLQSRating4",CommonUIStrings.l_FloodgateNLQSRating4),this.na.$("FloodgateNLQSRating5",CommonUIStrings.l_FloodgateNLQSRating5),this.na.$("FloodgateNLQSDetailsQuestion",CommonUIStrings.l_FloodgateNLQSDetailsQuestion),this.na.$("ExcelWebEaseOfUse_Prompt",CommonUIStrings.l_ExcelWeb_EaseOfUse_Prompt),this.na.$("ExcelWebEaseOfUse_PromptQuestion",CommonUIStrings.l_ExcelWeb_EaseOfUse_PromptQuestion),this.na.$("ExcelWebEaseOfUse_PromptLabel_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),
this.na.$("ExcelWebEaseOfUse_PromptLabel_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("ExcelWebEaseOfUse_RatingQuestion",CommonUIStrings.l_ExcelWeb_EaseOfUse_RatingQuestion),this.na.$("ExcelWebEaseOfUse_RatingValue_1",CommonUIStrings.l_ExcelWeb_EaseOfUse_RatingValue_1),this.na.$("ExcelWebEaseOfUse_RatingValue_2",CommonUIStrings.l_ExcelWeb_EaseOfUse_RatingValue_2),this.na.$("ExcelWebEaseOfUse_RatingValue_3",CommonUIStrings.l_ExcelWeb_EaseOfUse_RatingValue_3),this.na.$("ExcelWebEaseOfUse_RatingValue_4",
CommonUIStrings.l_ExcelWeb_EaseOfUse_RatingValue_4),this.na.$("ExcelWebEaseOfUse_RatingValue_5",CommonUIStrings.l_ExcelWeb_EaseOfUse_RatingValue_5),this.na.$("ExcelWebEaseOfUse_WhyQuestion",CommonUIStrings.l_ExcelWeb_EaseOfUse_WhyQuestion),this.na.$("ExcelWebPrintSurvey_Prompt",CommonUIStrings.l_ExcelWeb_PrintSurvey_Prompt),this.na.$("ExcelWebPrintSurvey_PromptQuestion",CommonUIStrings.l_ExcelWeb_PrintSurvey_PromptQuestion),this.na.$("ExcelWebPrintSurvey_PromptLabel_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),
this.na.$("ExcelWebPrintSurvey_PromptLabel_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("ExcelWebPrintSurvey_RatingQuestion",CommonUIStrings.l_ExcelWeb_PrintSurvey_RatingQuestion),this.na.$("ExcelWebPrintSurvey_RatingValue_1",CommonUIStrings.l_ExcelWeb_PrintSurvey_RatingValue_1),this.na.$("ExcelWebPrintSurvey_RatingValue_2",CommonUIStrings.l_ExcelWeb_PrintSurvey_RatingValue_2),this.na.$("ExcelWebPrintSurvey_RatingValue_3",CommonUIStrings.l_ExcelWeb_PrintSurvey_RatingValue_3),this.na.$("ExcelWebPrintSurvey_RatingValue_4",
CommonUIStrings.l_ExcelWeb_PrintSurvey_RatingValue_4),this.na.$("ExcelWebPrintSurvey_RatingValue_5",CommonUIStrings.l_ExcelWeb_PrintSurvey_RatingValue_5),this.na.$("ExcelWebPrintSurvey_WhyQuestion",CommonUIStrings.l_ExcelWeb_PrintSurvey_WhyQuestion),this.na.$("ReactAutoFilter_PromptLine_1",CommonUIStrings.l_Excel_ReactAutoFilter_PromptLine_1),this.na.$("ReactAutoFilter_PromptLine_2",CommonUIStrings.l_Excel_ReactAutoFilter_PromptLine_2),this.na.$("ReactAutoFilter_PromptLabel_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),
this.na.$("ReactAutoFilter_PromptLabel_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("ReactAutoFilter_RatingQuestion",CommonUIStrings.l_Excel_ReactAutoFilter_RatingQuestion),this.na.$("ReactAutoFilter_RatingValue_1",CommonUIStrings.l_Excel_ReactAutoFilter_RatingValue_1),this.na.$("ReactAutoFilter_RatingValue_2",CommonUIStrings.l_Excel_ReactAutoFilter_RatingValue_2),this.na.$("ReactAutoFilter_RatingValue_3",CommonUIStrings.l_Excel_ReactAutoFilter_RatingValue_3),this.na.$("ReactAutoFilter_RatingValue_4",
CommonUIStrings.l_Excel_ReactAutoFilter_RatingValue_4),this.na.$("ReactAutoFilter_RatingValue_5",CommonUIStrings.l_Excel_ReactAutoFilter_RatingValue_5),this.na.$("ReactAutoFilter_CommentQuestion",CommonUIStrings.l_Excel_ReactAutoFilter_CommentQuestion),this.na.$("WordLinksExperience_FloodgatePromptTitle",CommonUIStrings.l_WordLinksExperience_FloodgatePromptTitle),this.na.$("WordLinksExperience_FloodgatePromptQuestion",CommonUIStrings.l_WordLinksExperience_FloodgatePromptQuestion),this.na.$("WordLinksExperience_FloodgatePrompt_YesLabel",
CommonUIStrings.l_WordLinksExperience_FloodgatePrompt_YesLabel),this.na.$("WordLinksExperience_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordLinksExperience_FloodgatePrompt_NoLabel),this.na.$("WordLinksExperience_FloodgateRatingQuestion",CommonUIStrings.l_WordLinksExperience_FloodgateRatingQuestion),this.na.$("WordLinksExperience_FloodgateRating_1",CommonUIStrings.l_WordLinksExperience_FloodgateRating_1),this.na.$("WordLinksExperience_FloodgateRating_2",CommonUIStrings.l_WordLinksExperience_FloodgateRating_2),
this.na.$("WordLinksExperience_FloodgateRating_3",CommonUIStrings.l_WordLinksExperience_FloodgateRating_3),this.na.$("WordLinksExperience_FloodgateRating_4",CommonUIStrings.l_WordLinksExperience_FloodgateRating_4),this.na.$("WordLinksExperience_FloodgateRating_5",CommonUIStrings.l_WordLinksExperience_FloodgateRating_5),this.na.$("WordLinksExperience_FloodgateWhyQuestion",CommonUIStrings.l_WordLinksExperience_FloodgateWhyQuestion),this.na.$("OnlineVideoSupport_FloodgatePromptTitle",CommonUIStrings.l_OnlineVideoSupport_FloodgatePromptTitle),
this.na.$("OnlineVideoSupport_FloodgatePromptQuestion",CommonUIStrings.l_OnlineVideoSupport_FloodgatePromptQuestion),this.na.$("OnlineVideoSupport_FloodgatePrompt_YesLabel",CommonUIStrings.l_OnlineVideoSupport_FloodgatePrompt_YesLabel),this.na.$("OnlineVideoSupport_FloodgatePrompt_NoLabel",CommonUIStrings.l_OnlineVideoSupport_FloodgatePrompt_NoLabel),this.na.$("OnlineVideoSupport_FloodgateRatingQuestion",CommonUIStrings.l_OnlineVideoSupport_FloodgateRatingQuestion),this.na.$("OnlineVideoSupport_FloodgateRating_1",
CommonUIStrings.l_OnlineVideoSupport_FloodgateRating_1),this.na.$("OnlineVideoSupport_FloodgateRating_2",CommonUIStrings.l_OnlineVideoSupport_FloodgateRating_2),this.na.$("OnlineVideoSupport_FloodgateRating_3",CommonUIStrings.l_OnlineVideoSupport_FloodgateRating_3),this.na.$("OnlineVideoSupport_FloodgateRating_4",CommonUIStrings.l_OnlineVideoSupport_FloodgateRating_4),this.na.$("OnlineVideoSupport_FloodgateRating_5",CommonUIStrings.l_OnlineVideoSupport_FloodgateRating_5),this.na.$("OnlineVideoSupport_FloodgateWhyQuestion",
CommonUIStrings.l_OnlineVideoSupport_FloodgateWhyQuestion),this.na.$("NavPaneExperience_FloodgatePromptTitle",CommonUIStrings.l_NavPaneExperience_FloodgatePromptTitle),this.na.$("NavPaneExperience_FloodgatePromptQuestion",CommonUIStrings.l_NavPaneExperience_FloodgatePromptQuestion),this.na.$("NavPaneExperience_FloodgatePrompt_YesLabel",CommonUIStrings.l_NavPaneExperience_FloodgatePrompt_YesLabel),this.na.$("NavPaneExperience_FloodgatePrompt_NoLabel",CommonUIStrings.l_NavPaneExperience_FloodgatePrompt_NoLabel),
this.na.$("NavPaneExperience_FloodgateRatingQuestion",CommonUIStrings.l_NavPaneExperience_FloodgateRatingQuestion),this.na.$("NavPaneExperience_FloodgateRating_1",CommonUIStrings.l_NavPaneExperience_FloodgateRating_1),this.na.$("NavPaneExperience_FloodgateRating_2",CommonUIStrings.l_NavPaneExperience_FloodgateRating_2),this.na.$("NavPaneExperience_FloodgateRating_3",CommonUIStrings.l_NavPaneExperience_FloodgateRating_3),this.na.$("NavPaneExperience_FloodgateRating_4",CommonUIStrings.l_NavPaneExperience_FloodgateRating_4),
this.na.$("NavPaneExperience_FloodgateRating_5",CommonUIStrings.l_NavPaneExperience_FloodgateRating_5),this.na.$("NavPaneExperience_FloodgateWhyQuestion",CommonUIStrings.l_NavPaneExperience_FloodgateWhyQuestion),this.na.$("BookmarksExperience_FloodgatePromptTitle",CommonUIStrings.l_BookmarksExperience_FloodgatePromptTitle),this.na.$("BookmarksExperience_FloodgatePromptQuestion",CommonUIStrings.l_BookmarksExperience_FloodgatePromptQuestion),this.na.$("BookmarksExperience_FloodgatePrompt_YesLabel",
CommonUIStrings.l_BookmarksExperience_FloodgatePrompt_YesLabel),this.na.$("BookmarksExperience_FloodgatePrompt_NoLabel",CommonUIStrings.l_BookmarksExperience_FloodgatePrompt_NoLabel),this.na.$("BookmarksExperience_FloodgateRatingQuestion",CommonUIStrings.l_BookmarksExperience_FloodgateRatingQuestion),this.na.$("BookmarksExperience_FloodgateRating_1",CommonUIStrings.l_BookmarksExperience_FloodgateRating_1),this.na.$("BookmarksExperience_FloodgateRating_2",CommonUIStrings.l_BookmarksExperience_FloodgateRating_2),
this.na.$("BookmarksExperience_FloodgateRating_3",CommonUIStrings.l_BookmarksExperience_FloodgateRating_3),this.na.$("BookmarksExperience_FloodgateRating_4",CommonUIStrings.l_BookmarksExperience_FloodgateRating_4),this.na.$("BookmarksExperience_FloodgateRating_5",CommonUIStrings.l_BookmarksExperience_FloodgateRating_5),this.na.$("BookmarksExperience_FloodgateWhyQuestion",CommonUIStrings.l_BookmarksExperience_FloodgateWhyQuestion),this.na.$("WordPictureBorder_FloodgatePromptTitle",CommonUIStrings.l_WordPictureBorder_FloodgatePromptTitle),
this.na.$("WordPictureBorder_FloodgatePromptQuestion",CommonUIStrings.l_WordPictureBorder_FloodgatePromptQuestion),this.na.$("WordPictureBorder_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordPictureBorder_FloodgatePrompt_YesLabel),this.na.$("WordPictureBorder_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordPictureBorder_FloodgatePrompt_NoLabel),this.na.$("WordPictureBorder_FloodgateRatingQuestion",CommonUIStrings.l_WordPictureBorder_FloodgateRatingQuestion),this.na.$("WordPictureBorder_FloodgateRating_1",
CommonUIStrings.l_WordPictureBorder_FloodgateRating_1),this.na.$("WordPictureBorder_FloodgateRating_2",CommonUIStrings.l_WordPictureBorder_FloodgateRating_2),this.na.$("WordPictureBorder_FloodgateRating_3",CommonUIStrings.l_WordPictureBorder_FloodgateRating_3),this.na.$("WordPictureBorder_FloodgateRating_4",CommonUIStrings.l_WordPictureBorder_FloodgateRating_4),this.na.$("WordPictureBorder_FloodgateRating_5",CommonUIStrings.l_WordPictureBorder_FloodgateRating_5),this.na.$("WordPictureBorder_FloodgateWhyQuestion",
CommonUIStrings.l_WordPictureBorder_FloodgateWhyQuestion),this.na.$("WordComment_FloodgatePromptTitle",CommonUIStrings.l_WordComment_FloodgatePromptTitle),this.na.$("WordComment_FloodgatePromptQuestion",CommonUIStrings.l_WordComment_FloodgatePromptQuestion),this.na.$("WordComment_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordComment_FloodgatePrompt_YesLabel),this.na.$("WordComment_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordComment_FloodgatePrompt_NoLabel),this.na.$("WordComment_FloodgateRatingQuestion",
CommonUIStrings.l_WordComment_FloodgateRatingQuestion),this.na.$("WordComment_FloodgateRating_1",CommonUIStrings.l_WordComment_FloodgateRating_1),this.na.$("WordComment_FloodgateRating_2",CommonUIStrings.l_WordComment_FloodgateRating_2),this.na.$("WordComment_FloodgateRating_3",CommonUIStrings.l_WordComment_FloodgateRating_3),this.na.$("WordComment_FloodgateRating_4",CommonUIStrings.l_WordComment_FloodgateRating_4),this.na.$("WordComment_FloodgateRating_5",CommonUIStrings.l_WordComment_FloodgateRating_5),
this.na.$("WordComment_FloodgateWhyQuestion",CommonUIStrings.l_WordComment_FloodgateWhyQuestion),this.na.$("WordTrackChanges_FloodgatePromptTitle",CommonUIStrings.l_WordTrackChanges_FloodgatePromptTitle),this.na.$("WordTrackChanges_FloodgatePromptQuestion",CommonUIStrings.l_WordTrackChanges_FloodgatePromptQuestion),this.na.$("WordTrackChanges_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordTrackChanges_FloodgatePrompt_YesLabel),this.na.$("WordTrackChanges_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordTrackChanges_FloodgatePrompt_NoLabel),
this.na.$("WordTrackChanges_FloodgateRatingQuestion",CommonUIStrings.l_WordTrackChanges_FloodgateRatingQuestion),this.na.$("WordTrackChanges_FloodgateRating_1",CommonUIStrings.l_WordTrackChanges_FloodgateRating_1),this.na.$("WordTrackChanges_FloodgateRating_2",CommonUIStrings.l_WordTrackChanges_FloodgateRating_2),this.na.$("WordTrackChanges_FloodgateRating_3",CommonUIStrings.l_WordTrackChanges_FloodgateRating_3),this.na.$("WordTrackChanges_FloodgateRating_4",CommonUIStrings.l_WordTrackChanges_FloodgateRating_4),
this.na.$("WordTrackChanges_FloodgateRating_5",CommonUIStrings.l_WordTrackChanges_FloodgateRating_5),this.na.$("WordTrackChanges_FloodgateWhyQuestion",CommonUIStrings.l_WordTrackChanges_FloodgateWhyQuestion),this.na.$("CollabCorner_Survey_DownloadCopies_Prompt_Line_1",CommonUIStrings.l_CollabCorner_Survey_DownloadCopies_Prompt_Line_1),this.na.$("CollabCorner_Survey_DownloadCopies_Prompt_Line_2",CommonUIStrings.l_CollabCorner_Survey_DownloadCopies_Prompt_Line_2),this.na.$("CollabCorner_Survey_DownloadCopies_Prompt_YesLabel",
CommonUIStrings.l_CollabCorner_Survey_DownloadCopies_Prompt_YesLabel),this.na.$("CollabCorner_Survey_DownloadCopies_Prompt_NoLabel",CommonUIStrings.l_CollabCorner_Survey_DownloadCopies_Prompt_NoLabel),this.na.$("CollabCorner_Survey_DownloadCopies_Rating_Question",CommonUIStrings.l_CollabCorner_Survey_DownloadCopies_Rating_Question),this.na.$("CollabCorner_Survey_DownloadCopies_Rating_Scale_1",CommonUIStrings.l_CollabCorner_Survey_DownloadCopies_Rating_Scale_1),this.na.$("CollabCorner_Survey_DownloadCopies_Rating_Scale_2",
CommonUIStrings.l_CollabCorner_Survey_DownloadCopies_Rating_Scale_2),this.na.$("CollabCorner_Survey_DownloadCopies_Rating_Scale_3",CommonUIStrings.l_CollabCorner_Survey_DownloadCopies_Rating_Scale_3),this.na.$("CollabCorner_Survey_DownloadCopies_Rating_Scale_4",CommonUIStrings.l_CollabCorner_Survey_DownloadCopies_Rating_Scale_4),this.na.$("CollabCorner_Survey_DownloadCopies_Rating_Scale_5",CommonUIStrings.l_CollabCorner_Survey_DownloadCopies_Rating_Scale_5),this.na.$("CollabCorner_Survey_DownloadCopies_Comment_Question",
CommonUIStrings.l_CollabCorner_Survey_DownloadCopies_Comment_Question),this.na.$("WordListsExperience_FloodgatePromptTitle",CommonUIStrings.l_WordListsExperience_FloodgatePromptTitle),this.na.$("WordListsExperience_FloodgatePromptQuestion",CommonUIStrings.l_WordListsExperience_FloodgatePromptQuestion),this.na.$("WordListsExperience_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordListsExperience_FloodgatePrompt_YesLabel),this.na.$("WordListsExperience_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordListsExperience_FloodgatePrompt_NoLabel),
this.na.$("WordListsExperience_FloodgateRatingQuestion",CommonUIStrings.l_WordListsExperience_FloodgateRatingQuestion),this.na.$("WordListsExperience_FloodgateRating_1",CommonUIStrings.l_WordListsExperience_FloodgateRating_1),this.na.$("WordListsExperience_FloodgateRating_5",CommonUIStrings.l_WordListsExperience_FloodgateRating_5),this.na.$("WordListsExperience_FloodgateAdditionalThoughts",CommonUIStrings.l_WordListsExperience_FloodgateAdditionalThoughts),this.na.$("WordChartsSupport_FloodgatePromptTitle",
CommonUIStrings.l_WordChartsSupport_FloodgatePromptTitle),this.na.$("WordChartsSupport_FloodgatePromptQuestion",CommonUIStrings.l_WordChartsSupport_FloodgatePromptQuestion),this.na.$("WordChartsSupport_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordChartsSupport_FloodgatePrompt_YesLabel),this.na.$("WordChartsSupport_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordChartsSupport_FloodgatePrompt_NoLabel),this.na.$("WordChartsSupport_FloodgateRatingQuestion",CommonUIStrings.l_WordChartsSupport_FloodgateRatingQuestion),
this.na.$("WordChartsSupport_FloodgateRating_1",CommonUIStrings.l_WordChartsSupport_FloodgateRating_1),this.na.$("WordChartsSupport_FloodgateRating_2",CommonUIStrings.l_WordChartsSupport_FloodgateRating_2),this.na.$("WordChartsSupport_FloodgateRating_3",CommonUIStrings.l_WordChartsSupport_FloodgateRating_3),this.na.$("WordChartsSupport_FloodgateRating_4",CommonUIStrings.l_WordChartsSupport_FloodgateRating_4),this.na.$("WordChartsSupport_FloodgateRating_5",CommonUIStrings.l_WordChartsSupport_FloodgateRating_5),
this.na.$("WordChartsSupport_FloodgateWhyQuestion",CommonUIStrings.l_WordChartsSupport_FloodgateWhyQuestion),this.na.$("WordTablesSupport_FloodgatePromptTitle",CommonUIStrings.l_WordTablesSupport_FloodgatePromptTitle),this.na.$("WordTablesSupport_FloodgatePromptQuestion",CommonUIStrings.l_WordTablesSupport_FloodgatePromptQuestion),this.na.$("WordTablesSupport_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordTablesSupport_FloodgatePrompt_YesLabel),this.na.$("WordTablesSupport_FloodgatePrompt_NoLabel",
CommonUIStrings.l_WordTablesSupport_FloodgatePrompt_NoLabel),this.na.$("WordTablesSupport_FloodgateRatingQuestion",CommonUIStrings.l_WordTablesSupport_FloodgateRatingQuestion),this.na.$("WordTablesSupport_FloodgateRating_1",CommonUIStrings.l_WordTablesSupport_FloodgateRating_1),this.na.$("WordTablesSupport_FloodgateRating_2",CommonUIStrings.l_WordTablesSupport_FloodgateRating_2),this.na.$("WordTablesSupport_FloodgateRating_3",CommonUIStrings.l_WordTablesSupport_FloodgateRating_3),this.na.$("WordTablesSupport_FloodgateRating_4",
CommonUIStrings.l_WordTablesSupport_FloodgateRating_4),this.na.$("WordTablesSupport_FloodgateRating_5",CommonUIStrings.l_WordTablesSupport_FloodgateRating_5),this.na.$("WordTablesSupport_FloodgateWhyQuestion",CommonUIStrings.l_WordTablesSupport_FloodgateWhyQuestion),this.na.$("ModernPresence_PromptLine_1",CommonUIStrings.l_Excel_ModernPresence_PromptLine_1),this.na.$("ModernPresence_PromptLine_2",CommonUIStrings.l_Excel_ModernPresence_PromptLine_2),this.na.$("ModernPresence_PromptLabel_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),
this.na.$("ModernPresence_PromptLabel_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("ModernPresence_RatingQuestion",CommonUIStrings.l_Excel_ModernPresence_RatingQuestion),this.na.$("ModernPresence_RatingValue_1",CommonUIStrings.l_Excel_ModernPresence_RatingValue_1),this.na.$("ModernPresence_RatingValue_2",CommonUIStrings.l_Excel_ModernPresence_RatingValue_2),this.na.$("ModernPresence_RatingValue_3",CommonUIStrings.l_Excel_ModernPresence_RatingValue_3),this.na.$("ModernPresence_RatingValue_4",
CommonUIStrings.l_Excel_ModernPresence_RatingValue_4),this.na.$("ModernPresence_RatingValue_5",CommonUIStrings.l_Excel_ModernPresence_RatingValue_5),this.na.$("ModernPresence_CommentQuestion",CommonUIStrings.l_Excel_ModernPresence_CommentQuestion),this.na.$("WordInsertImages_FloodgatePromptTitle",CommonUIStrings.l_WordInsertImages_FloodgatePromptTitle),this.na.$("WordInsertImages_FloodgatePromptQuestion",CommonUIStrings.l_WordInsertImages_FloodgatePromptQuestion),this.na.$("WordInsertImages_FloodgatePrompt_YesLabel",
CommonUIStrings.l_WordInsertImages_FloodgatePrompt_YesLabel),this.na.$("WordInsertImages_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordInsertImages_FloodgatePrompt_NoLabel),this.na.$("WordInsertImages_FloodgateRatingQuestion",CommonUIStrings.l_WordInsertImages_FloodgateRatingQuestion),this.na.$("WordInsertImages_FloodgateRating_1",CommonUIStrings.l_WordInsertImages_FloodgateRating_1),this.na.$("WordInsertImages_FloodgateRating_2",CommonUIStrings.l_WordInsertImages_FloodgateRating_2),this.na.$("WordInsertImages_FloodgateRating_3",
CommonUIStrings.l_WordInsertImages_FloodgateRating_3),this.na.$("WordInsertImages_FloodgateRating_4",CommonUIStrings.l_WordInsertImages_FloodgateRating_4),this.na.$("WordInsertImages_FloodgateRating_5",CommonUIStrings.l_WordInsertImages_FloodgateRating_5),this.na.$("WordInsertImages_FloodgateWhyQuestion",CommonUIStrings.l_WordInsertImages_FloodgateWhyQuestion),this.na.$("FontPicker_FloodgatePromptTitle",CommonUIStrings.l_FontPicker_FloodgatePromptTitle),this.na.$("FontPicker_FloodgatePromptQuestion",
CommonUIStrings.l_FontPicker_FloodgatePromptQuestion),this.na.$("FontPicker_FloodgatePromptYesLabel",CommonUIStrings.l_FontPicker_FloodgatePromptYesLabel),this.na.$("FontPicker_FloodgatePromptNoLabel",CommonUIStrings.l_FontPicker_FloodgatePromptNoLabel),this.na.$("FontPicker_FloodgateRatingQuestion",CommonUIStrings.l_FontPicker_FloodgateRatingQuestion),this.na.$("FontPicker_FloodgateRating1",CommonUIStrings.l_FontPicker_FloodgateRating1),this.na.$("FontPicker_FloodgateRating2",CommonUIStrings.l_FontPicker_FloodgateRating2),
this.na.$("FontPicker_FloodgateRating3",CommonUIStrings.l_FontPicker_FloodgateRating3),this.na.$("FontPicker_FloodgateRating4",CommonUIStrings.l_FontPicker_FloodgateRating4),this.na.$("FontPicker_FloodgateRating5",CommonUIStrings.l_FontPicker_FloodgateRating5),this.na.$("FontPicker_FloodgateCommentQuestion",CommonUIStrings.l_FontPicker_FloodgateCommentQuestion),this.na.$("FormulasMenu_PromptLine_1",CommonUIStrings.l_Excel_FormulasMenu_PromptLine_1),this.na.$("FormulasMenu_PromptLine_2",CommonUIStrings.l_Excel_FormulasMenu_PromptLine_2),
this.na.$("FormulasMenu_PromptLabel_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("FormulasMenu_PromptLabel_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("FormulasMenu_RatingQuestion",CommonUIStrings.l_Excel_FormulasMenu_RatingQuestion),this.na.$("FormulasMenu_RatingValue_1",CommonUIStrings.l_Excel_FormulasMenu_RatingValue_1),this.na.$("FormulasMenu_RatingValue_2",CommonUIStrings.l_Excel_FormulasMenu_RatingValue_2),this.na.$("FormulasMenu_RatingValue_3",CommonUIStrings.l_Excel_FormulasMenu_RatingValue_3),
this.na.$("FormulasMenu_RatingValue_4",CommonUIStrings.l_Excel_FormulasMenu_RatingValue_4),this.na.$("FormulasMenu_RatingValue_5",CommonUIStrings.l_Excel_FormulasMenu_RatingValue_5),this.na.$("FormulasMenu_CommentQuestion",CommonUIStrings.l_Excel_FormulasMenu_CommentQuestion),this.na.$("WordWebEditorSeen_FloodgatePromptTitle",CommonUIStrings.l_WAC_GenericSurvey_FloodgatePromptTitle),this.na.$("WordWebEditorSeen_FloodgatePromptQuestion",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.na.$("WordWebEditorSeen_FloodgatePrompt_YesLabel",
CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("WordWebEditorSeen_FloodgatePrompt_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("WordWebEditorSeen_FloodgateRatingQuestion",CommonUIStrings.l_WordWebEditorSeen_FloodgateRatingQuestion),this.na.$("WordWebEditorSeen_FloodgateRating_1",CommonUIStrings.l_WAC_GenericSurvey_RaitingValue_ExtremelyNegative),this.na.$("WordWebEditorSeen_FloodgateRating_2",CommonUIStrings.l_WAC_GenericSurvey_RaitingValue_SomewhatNegative),this.na.$("WordWebEditorSeen_FloodgateRating_3",
CommonUIStrings.l_WAC_GenericSurvey_RaitingValue_NeitherNegativeNorPositive),this.na.$("WordWebEditorSeen_FloodgateRating_4",CommonUIStrings.l_WAC_GenericSurvey_RaitingValue_SomewhatPositive),this.na.$("WordWebEditorSeen_FloodgateRating_5",CommonUIStrings.l_WAC_GenericSurvey_RaitingValue_ExtremelyPositive),this.na.$("WordWebEditorSeen_FloodgateWhyQuestion",CommonUIStrings.l_WordWebEditorSeen_FloodgateWhyQuestion),this.na.$("OnenotePerf_FloodgatePromptTitle",uc.fnj()),this.na.$("OnenotePerf_FloodgatePromptQuestion",
CommonUIStrings.l_OnenotePerf_FloodgatePromptQuestion),this.na.$("OnenotePerf_FloodgatePrompt_YesLabel",CommonUIStrings.l_OnenotePerf_FloodgatePrompt_YesLabel),this.na.$("OnenotePerf_FloodgatePrompt_NoLabel",CommonUIStrings.l_OnenotePerf_FloodgatePrompt_NoLabel),this.na.$("OnenotePerf_FloodgateRatingQuestion",uc.gnj()),this.na.$("OnenotePerf_FloodgateRatingQuestionChoice_1",CommonUIStrings.l_OnenotePerf_FloodgateRatingQuestionChoice_1),this.na.$("OnenotePerf_FloodgateRatingQuestionChoice_2",CommonUIStrings.l_OnenotePerf_FloodgateRatingQuestionChoice_2),
this.na.$("OnenotePerf_FloodgateRatingQuestionChoice_3",CommonUIStrings.l_OnenotePerf_FloodgateRatingQuestionChoice_3),this.na.$("OnenotePerf_FloodgateRatingQuestionChoice_4",CommonUIStrings.l_OnenotePerf_FloodgateRatingQuestionChoice_4),this.na.$("OnenotePerf_FloodgateRatingQuestionChoice_5",CommonUIStrings.l_OnenotePerf_FloodgateRatingQuestionChoice_5),this.na.$("OnenotePerf_FloodgateWhyQuestion",CommonUIStrings.l_OnenotePerf_FloodgateWhyQuestion),this.na.$("OnenoteInkSurvey_Prompt",CommonUIStrings.l_OnenoteInkSurvey_Prompt),
this.na.$("OnenoteInkSurvey_PromptQuestion",CommonUIStrings.l_InkSurvey_PromptQuestion),this.na.$("OnenoteInkSurvey_Prompt_Sure",CommonUIStrings.l_InkSurvey_Prompt_Sure),this.na.$("OnenoteInkSurvey_Prompt_NoNow",CommonUIStrings.l_InkSurvey_Prompt_NoNow),this.na.$("OnenoteInkSurvey_RatingQuestion",CommonUIStrings.l_OnenoteInkSurvey_RatingQuestion),this.na.$("OnenoteInkSurvey_QuestionChoice_1",CommonUIStrings.l_InkSurvey_QuestionChoice_1),this.na.$("OnenoteInkSurvey_QuestionChoice_2",CommonUIStrings.l_InkSurvey_QuestionChoice_2),
this.na.$("OnenoteInkSurvey_QuestionChoice_3",CommonUIStrings.l_InkSurvey_QuestionChoice_3),this.na.$("OnenoteInkSurvey_QuestionChoice_4",CommonUIStrings.l_InkSurvey_QuestionChoice_4),this.na.$("OnenoteInkSurvey_QuestionChoice_5",CommonUIStrings.l_InkSurvey_QuestionChoice_5),this.na.$("OnenoteInkSurvey_WhyQuestion",CommonUIStrings.l_InkSurvey_WhyQuestion),this.na.$("OnenotePenInkSurvey_Prompt",CommonUIStrings.l_OnenotePenInkSurvey_Prompt),this.na.$("OnenotePenInkSurvey_PromptQuestion",CommonUIStrings.l_PenInkSurvey_PromptQuestion),
this.na.$("OnenotePenInkSurvey_Prompt_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("OnenotePenInkSurvey_Prompt_NoNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("OnenotePenInkSurvey_RatingQuestion",CommonUIStrings.l_OnenotePenInkSurvey_RatingQuestion),this.na.$("OnenotePenInkSurvey_QuestionChoice_5",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_5_VerySatisfied),this.na.$("OnenotePenInkSurvey_QuestionChoice_4",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_4_SomewhatSatisfied),
this.na.$("OnenotePenInkSurvey_QuestionChoice_3",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_3_Neutral),this.na.$("OnenotePenInkSurvey_QuestionChoice_2",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_2_SomewhatDissatisfied),this.na.$("OnenotePenInkSurvey_QuestionChoice_1",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_1_VeryDissatisfied),this.na.$("OnenotePenInkSurvey_WhyQuestion",CommonUIStrings.l_PenInkSurvey_WhyQuestion),this.na.$("PenInkSurvey_Prompt",CommonUIStrings.l_PenInkSurvey_Prompt),
this.na.$("PenInkSurvey_RatingQuestion",CommonUIStrings.l_PenInkSurvey_RatingQuestion),this.na.$("PenInkSurvey_PromptQuestion",CommonUIStrings.l_PenInkSurvey_PromptQuestion),this.na.$("PenInkSurvey_Prompt_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("PenInkSurvey_Prompt_NoNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("PenInkSurvey_QuestionChoice_5",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_5_VerySatisfied),this.na.$("PenInkSurvey_QuestionChoice_4",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_4_SomewhatSatisfied),
this.na.$("PenInkSurvey_QuestionChoice_3",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_3_Neutral),this.na.$("PenInkSurvey_QuestionChoice_2",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_2_SomewhatDissatisfied),this.na.$("PenInkSurvey_QuestionChoice_1",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_1_VeryDissatisfied),this.na.$("PenInkSurvey_WhyQuestion",CommonUIStrings.l_PenInkSurvey_WhyQuestion),this.na.$("SkittleFloodgateTitle",CommonUIStrings.l_Skittle_FeedbackTitle),this.na.$("SkittleFloodgatePrompt",
CommonUIStrings.l_Skittle_FeedbackPrompt),this.na.$("SkittleFloodgateRatingQuestion",CommonUIStrings.l_Skittle_FeedbackRatingQuestion),this.na.$("SkittleFloodgateQuestion",CommonUIStrings.l_Skittle_FeedbackQuestion),this.na.$("SkittleFloodgateMinRating",CommonUIStrings.l_Skittle_FeedbackMinRating),this.na.$("SkittleFloodgateMaxRating",CommonUIStrings.l_Skittle_FeedbackMaxRating),this.na.$("WordDocumentModes_FloodgatePromptTitle",CommonUIStrings.l_WordDocumentModes_FloodgatePromptTitle),this.na.$("WordDocumentModes_FloodgatePromptQuestion",
CommonUIStrings.l_WordDocumentModes_FloodgatePromptQuestion),this.na.$("WordDocumentModes_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordDocumentModes_FloodgatePrompt_YesLabel),this.na.$("WordDocumentModes_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordDocumentModes_FloodgatePrompt_NoLabel),this.na.$("WordDocumentModes_FloodgateRatingQuestion",CommonUIStrings.l_WordDocumentModes_FloodgateRatingQuestion),this.na.$("WordDocumentModes_FloodgateRating_1",CommonUIStrings.l_WordDocumentModes_FloodgateRating_1),
this.na.$("WordDocumentModes_FloodgateRating_5",CommonUIStrings.l_WordDocumentModes_FloodgateRating_5),this.na.$("WordDocumentModes_FloodgateWhyQuestion",CommonUIStrings.l_WordDocumentModes_FloodgateWhyQuestion),this.na.$("WordDesignerFloodgateTitle",CommonUIStrings.l_WordDesigner_FeedbackTitle),this.na.$("WordDesignerFloodgatePrompt",CommonUIStrings.l_WordDesigner_FeedbackPrompt),this.na.$("WordDesignerFloodgatePromptYesLabel",CommonUIStrings.l_WordDesigner_FloodgatePrompt_YesLabel),this.na.$("WordDesignerFloodgatePromptNoLabel",
CommonUIStrings.l_WordDesigner_FloodgatePrompt_NoLabel),this.na.$("WordDesignerFloodgateRatingQuestion",CommonUIStrings.l_WordDesigner_FeedbackRatingQuestion),this.na.$("WordDesignerFloodgateMinRating",CommonUIStrings.l_WordDesigner_FeedbackMinRating),this.na.$("WordDesignerFloodgateMaxRating",CommonUIStrings.l_WordDesigner_FeedbackMaxRating),this.na.$("WordDesignerFloodgateQuestion",CommonUIStrings.l_WordDesigner_FeedbackQuestion1),this.na.$("WordDesignerBlankDocumentExperienceTitle",CommonUIStrings.l_WordDesigner_BlankDocumentExperience_UserInitiatedTitle),
this.na.$("WordDesignerBlankDocumentExperienceRatingQuestion",CommonUIStrings.l_WordDesigner_BlankDocumentExperience_UserInitiatedRatingQuestion),this.na.$("WordDesignerBlankDocumentExperienceCommentQuestion",CommonUIStrings.l_WordDesigner_BlankDocumentExperience_UserInitiatedCommentQuestion),this.na.$("WordDesignerT2ISurveyQuestion",CommonUIStrings.l_WordDesigner_T2ISurveyQuestion),this.na.$("WordDesignerPQSurveyQuestion",CommonUIStrings.l_WordDesigner_PQSurveyQuestion),this.na.$("WordDesignerFormattingSuggestionsSurveyQuestion",
CommonUIStrings.l_WordDesigner_FormattingSuggestionsSurveyQuestion),this.na.$("WordDesignerAllContextualSuggestionsFeedbackRatingQuestion",CommonUIStrings.l_WordDesigner_AllContextualSuggestionsFeedbackRatingQuestion),this.na.$("WordDesignerDesignerPasteFeedbackRatingQuestion",uc.hnj()),this.na.$("WordDesignerHideSuggestionsQuestion",CommonUIStrings.l_WordDesigner_HideSuggestionsQuestion),this.na.$("WordDesignerHideSuggestionsAnswer1",CommonUIStrings.l_WordDesigner_HideSuggestionsAnswer_1),this.na.$("WordDesignerHideSuggestionsAnswer2",
CommonUIStrings.l_WordDesigner_HideSuggestionsAnswer_2),this.na.$("WordDesignerHideSuggestionsAnswer3",CommonUIStrings.l_WordDesigner_HideSuggestionsAnswer_3),this.na.$("WordDesignerHideSuggestionsAnswer4",CommonUIStrings.l_WordDesigner_HideSuggestionsAnswer_4),this.na.$("FpsInDocSearch_FloodgatePromptTitle",CommonUIStrings.l_FpsInDocSearch_FloodgatePromptTitle),this.na.$("FpsInDocSearch_FloodgatePromptQuestion",CommonUIStrings.l_FpsInDocSearch_FloodgatePromptQuestion),this.na.$("FpsInDocSearch_FloodgatePrompt_YesLabel",
CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("FpsInDocSearch_FloodgatePrompt_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("FpsInDocSearch_FloodgateRatingQuestion",CommonUIStrings.l_FpsInDocSearch_FloodgateRatingQuestion),this.na.$("FpsInDocSearch_FloodgateRating_1",CommonUIStrings.l_FpsInDocSearch_FloodgateRating_1),this.na.$("FpsInDocSearch_FloodgateRating_2",CommonUIStrings.l_FpsInDocSearch_FloodgateRating_2),this.na.$("FpsInDocSearch_FloodgateRating_3",CommonUIStrings.l_FpsInDocSearch_FloodgateRating_3),
this.na.$("FpsInDocSearch_FloodgateRating_4",CommonUIStrings.l_FpsInDocSearch_FloodgateRating_4),this.na.$("FpsInDocSearch_FloodgateRating_5",CommonUIStrings.l_FpsInDocSearch_FloodgateRating_5),this.na.$("FpsInDocSearch_FloodgateWhyQuestion",CommonUIStrings.l_FpsInDocSearch_FloodgateWhyQuestion),this.na.$("FpsInDocQna_FloodgatePromptTitle",CommonUIStrings.l_FpsInDocQna_FloodgatePromptTitle),this.na.$("FpsInDocQna_FloodgatePromptQuestion",CommonUIStrings.l_FpsInDocQna_FloodgatePromptQuestion),this.na.$("FpsInDocQna_FloodgatePrompt_YesLabel",
CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("FpsInDocQna_FloodgatePrompt_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("FpsInDocQna_FloodgateRatingQuestion",CommonUIStrings.l_FpsInDocQna_FloodgateRatingQuestion),this.na.$("FpsInDocQna_FloodgateRating_1",CommonUIStrings.l_FpsInDocQna_FloodgateRating_1),this.na.$("FpsInDocQna_FloodgateRating_2",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_2),this.na.$("FpsInDocQna_FloodgateRating_3",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_3),
this.na.$("FpsInDocQna_FloodgateRating_4",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_4),this.na.$("FpsInDocQna_FloodgateRating_5",CommonUIStrings.l_FpsInDocQna_FloodgateRating_5),this.na.$("FpsInDocQna_FloodgateWhyQuestion",CommonUIStrings.l_FpsInDocQna_FloodgateWhyQuestion),this.na.$("AtMentionFPS_Title",CommonUIStrings.l_WAC_AtMentionFPS_Title),this.na.$("AtMentionFPS_Question",CommonUIStrings.l_WAC_AtMentionFPS_Question),this.na.$("AtMentionFPS_YesLabel",CommonUIStrings.l_WAC_AtMentionFPS_YesLabel),
this.na.$("AtMentionFPS_NoLabel",CommonUIStrings.l_WAC_AtMentionFPS_NoLabel),this.na.$("AtMentionFPS_RatingQuestion",CommonUIStrings.l_WAC_AtMentionFPS_RatingQuestion),this.na.$("AtMentionFPS_RatingValue_1",CommonUIStrings.l_WAC_AtMentionFPS_RatingValue_1),this.na.$("AtMentionFPS_RatingValue_2",CommonUIStrings.l_WAC_AtMentionFPS_RatingValue_2),this.na.$("AtMentionFPS_RatingValue_3",CommonUIStrings.l_WAC_AtMentionFPS_RatingValue_3),this.na.$("AtMentionFPS_RatingValue_4",CommonUIStrings.l_WAC_AtMentionFPS_RatingValue_4),
this.na.$("AtMentionFPS_RatingValue_5",CommonUIStrings.l_WAC_AtMentionFPS_RatingValue_5),this.na.$("AtMentionFPS_WhyQuestion",CommonUIStrings.l_WAC_AtMentionFPS_WhyQuestion),this.na.$("ClientPaginationSurvey_Title",CommonUIStrings.l_WAC_ClientPaginationSurvey_Title),this.na.$("ClientPaginationSurvey_Question",CommonUIStrings.l_WAC_ClientPaginationSurvey_Question),this.na.$("ClientPaginationSurvey_YesLabel",CommonUIStrings.l_WAC_ClientPaginationSurvey_YesLabel),this.na.$("ClientPaginationSurvey_NoLabel",
CommonUIStrings.l_WAC_ClientPaginationSurvey_NoLabel),this.na.$("ClientPaginationSurvey_RatingQuestion",CommonUIStrings.l_WAC_ClientPaginationSurvey_RatingQuestion),this.na.$("ClientPaginationSurvey_RatingValue_1",CommonUIStrings.l_WAC_ClientPaginationSurvey_RatingValue_1),this.na.$("ClientPaginationSurvey_RatingValue_2",CommonUIStrings.l_WAC_ClientPaginationSurvey_RatingValue_2),this.na.$("ClientPaginationSurvey_RatingValue_3",CommonUIStrings.l_WAC_ClientPaginationSurvey_RatingValue_3),this.na.$("ClientPaginationSurvey_RatingValue_4",
CommonUIStrings.l_WAC_ClientPaginationSurvey_RatingValue_4),this.na.$("ClientPaginationSurvey_RatingValue_5",CommonUIStrings.l_WAC_ClientPaginationSurvey_RatingValue_5),this.na.$("ClientPaginationSurvey_WhyQuestion",CommonUIStrings.l_WAC_ClientPaginationSurvey_WhyQuestion),this.na.$("CIQAtInvokeFPS_Title",CommonUIStrings.l_WAC_CIQAtInvokeFPS_Title),this.na.$("CIQAtInvokeFPS_Question",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.na.$("CIQAtInvokeFPS_YesLabel",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),
this.na.$("CIQAtInvokeFPS_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("CIQAtInvokeFPS_RatingQuestion",CommonUIStrings.l_WAC_CIQAtInvokeFPS_RatingQuestion),this.na.$("CIQAtInvokeFPS_RatingValue_1",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_1),this.na.$("CIQAtInvokeFPS_RatingValue_2",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_2),this.na.$("CIQAtInvokeFPS_RatingValue_3",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_3),this.na.$("CIQAtInvokeFPS_RatingValue_4",
CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_4),this.na.$("CIQAtInvokeFPS_RatingValue_5",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_5),this.na.$("CIQAtInvokeFPS_WhyQuestion",CommonUIStrings.l_WAC_CIQAtInvokeFPS_WhyQuestion),this.na.$("ConditionalFormatting_PromptLine_1",CommonUIStrings.l_Excel_ConditionalFormatting_PromptLine_1),this.na.$("ConditionalFormatting_PromptLine_2",CommonUIStrings.l_Excel_ConditionalFormatting_PromptLine_2),this.na.$("ConditionalFormatting_PromptLabel_Sure",
CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("ConditionalFormatting_PromptLabel_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("ConditionalFormatting_RatingQuestion",CommonUIStrings.l_Excel_ConditionalFormatting_RatingQuestion),this.na.$("ConditionalFormatting_RatingValue_1",CommonUIStrings.l_Excel_ConditionalFormatting_RatingValue_1),this.na.$("ConditionalFormatting_RatingValue_2",CommonUIStrings.l_Excel_ConditionalFormatting_RatingValue_2),this.na.$("ConditionalFormatting_RatingValue_3",
CommonUIStrings.l_Excel_ConditionalFormatting_RatingValue_3),this.na.$("ConditionalFormatting_RatingValue_4",CommonUIStrings.l_Excel_ConditionalFormatting_RatingValue_4),this.na.$("ConditionalFormatting_RatingValue_5",CommonUIStrings.l_Excel_ConditionalFormatting_RatingValue_5),this.na.$("ConditionalFormatting_CommentQuestion",CommonUIStrings.l_Excel_ConditionalFormatting_CommentQuestion),this.na.$("InAppNotification_Title",CommonUIStrings.l_WAC_InAppNotification_Title),this.na.$("InAppNotification_Description",
CommonUIStrings.l_WAC_InAppNotification_Description),this.na.$("InAppNotification_Button1_AddinTab",CommonUIStrings.l_WAC_InAppNotification_Button1_AddinTab),this.na.$("InAppNotification_Button1_AddinButton",CommonUIStrings.l_WAC_InAppNotification_Button1_AddinButton),this.na.$("InAppNotification_Button2",CommonUIStrings.l_WAC_InAppNotification_Button2),this.na.$("BlueDotsFPS_Title",CommonUIStrings.l_WAC_GenericSurvey_FloodgatePromptTitle),this.na.$("BlueDotsFPS_Question",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),
this.na.$("BlueDotsFPS_YesLabel",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("BlueDotsFPS_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("BlueDotsFPS_RatingQuestion",CommonUIStrings.l_WAC_CatchUpBlueDotsFPS_RatingQuestion),this.na.$("BlueDotsFPS_RatingValue_1",CommonUIStrings.l_WAC_CatchUpFPS_RatingValue_1),this.na.$("BlueDotsFPS_RatingValue_2",CommonUIStrings.l_WAC_CatchUpFPS_RatingValue_2),this.na.$("BlueDotsFPS_RatingValue_3",CommonUIStrings.l_WAC_CatchUpFPS_RatingValue_3),
this.na.$("BlueDotsFPS_RatingValue_4",CommonUIStrings.l_WAC_CatchUpFPS_RatingValue_4),this.na.$("BlueDotsFPS_RatingValue_5",CommonUIStrings.l_WAC_CatchUpFPS_RatingValue_5),this.na.$("BlueDotsFPS_WhyQuestion",CommonUIStrings.l_WAC_CatchUpBlueDotsFPS_WhyQuestion),this.na.$("WordWebOpeningDocuments_FloodgatePromptTitle",CommonUIStrings.l_WordWebOpeningDocuments_FloodgatePromptTitle),this.na.$("WordWebOpeningDocuments_FloodgatePromptQuestion",CommonUIStrings.l_WordWebOpeningDocuments_FloodgatePromptQuestion),
this.na.$("WordWebOpeningDocuments_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordWebOpeningDocuments_FloodgatePrompt_YesLabel),this.na.$("WordWebOpeningDocuments_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordWebOpeningDocuments_FloodgatePrompt_NoLabel),this.na.$("WordWebOpeningDocuments_FloodgateRatingQuestion",CommonUIStrings.l_WordWebOpeningDocuments_FloodgateRatingQuestion),this.na.$("WordWebOpeningDocuments_FloodgateRating_1",CommonUIStrings.l_WordWebOpeningDocuments_FloodgateRating_1),this.na.$("WordWebOpeningDocuments_FloodgateRating_2",
CommonUIStrings.l_WordWebOpeningDocuments_FloodgateRating_2),this.na.$("WordWebOpeningDocuments_FloodgateRating_3",CommonUIStrings.l_WordWebOpeningDocuments_FloodgateRating_3),this.na.$("WordWebOpeningDocuments_FloodgateRating_4",CommonUIStrings.l_WordWebOpeningDocuments_FloodgateRating_4),this.na.$("WordWebOpeningDocuments_FloodgateRating_5",CommonUIStrings.l_WordWebOpeningDocuments_FloodgateRating_5),this.na.$("WordWebOpeningDocuments_FloodgateTellUsMoreQuestion",CommonUIStrings.l_WordWebOpeningDocuments_FloodgateTellUsMore),
this.na.$("WordCommentReaction_FloodgatePromptTitle",CommonUIStrings.l_WordCommentReaction_FloodgatePromptTitle),this.na.$("WordCommentReaction_FloodgatePromptQuestion",CommonUIStrings.l_WordCommentReaction_FloodgatePromptQuestion),this.na.$("WordCommentReaction_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordCommentReaction_FloodgatePrompt_YesLabel),this.na.$("WordCommentReaction_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordCommentReaction_FloodgatePrompt_NoLabel),this.na.$("WordCommentReaction_FloodgateRatingQuestion",
CommonUIStrings.l_WordCommentReaction_FloodgateRatingQuestion),this.na.$("WordCommentReaction_FloodgateRating_1",CommonUIStrings.l_WordCommentReaction_FloodgateRating_1),this.na.$("WordCommentReaction_FloodgateRating_2",CommonUIStrings.l_WordCommentReaction_FloodgateRating_2),this.na.$("WordCommentReaction_FloodgateRating_3",CommonUIStrings.l_WordCommentReaction_FloodgateRating_3),this.na.$("WordCommentReaction_FloodgateRating_4",CommonUIStrings.l_WordCommentReaction_FloodgateRating_4),this.na.$("WordCommentReaction_FloodgateRating_5",
CommonUIStrings.l_WordCommentReaction_FloodgateRating_5),this.na.$("WordCommentReaction_FloodgateWhyQuestion",CommonUIStrings.l_WordCommentReaction_FloodgateWhyQuestion),this.na.$("GuestCoauthoring_FloodgatePromptTitle",CommonUIStrings.l_WAC_GuestCoauthSurvey_PromptTitle),this.na.$("GuestCoauthoring_FloodgatePromptQuestion",CommonUIStrings.l_WAC_GuestCoauthSurvey_PromptQuestion),this.na.$("GuestCoauthoring_FloodgatePrompt_YesLabel",CommonUIStrings.l_WAC_GuestCoauthSurvey_YesLabel),this.na.$("GuestCoauthoring_FloodgatePrompt_NoLabel",
CommonUIStrings.l_WAC_GuestCoauthSurvey_NoLabel),this.na.$("GuestCoauthoring_FloodgateQuestion",CommonUIStrings.l_WAC_GuestCoauthSurvey_FloodgateQuestion),this.na.$("GuestCoauthoring_FloodgateRatingValue_1",CommonUIStrings.l_WAC_GuestCoauthSurvey_RatingValue_1),this.na.$("GuestCoauthoring_FloodgateRatingValue_2",CommonUIStrings.l_WAC_GuestCoauthSurvey_RatingValue_2),this.na.$("GuestCoauthoring_FloodgateRatingValue_3",CommonUIStrings.l_WAC_GuestCoauthSurvey_RatingValue_3),this.na.$("GuestCoauthoring_FloodgateRatingValue_4",
CommonUIStrings.l_WAC_GuestCoauthSurvey_RatingValue_4),this.na.$("GuestCoauthoring_FloodgateRatingValue_5",CommonUIStrings.l_WAC_GuestCoauthSurvey_RatingValue_5),this.na.$("GuestCoauthoring_FloodgateRatingQuestion",CommonUIStrings.l_WAC_GuestCoauthSurvey_RatingQuestion),this.na.$("CtrlClickExperience_FloodgatePromptTitle",CommonUIStrings.l_CtrlClickExperience_FloodgatePromptTitle),this.na.$("CtrlClickExperience_FloodgatePromptQuestion",CommonUIStrings.l_CtrlClickExperience_FloodgatePromptQuestion),
this.na.$("CtrlClickExperience_FloodgatePrompt_YesLabel",CommonUIStrings.l_CtrlClickExperience_FloodgatePrompt_YesLabel),this.na.$("CtrlClickExperience_FloodgatePrompt_NoLabel",CommonUIStrings.l_CtrlClickExperience_FloodgatePrompt_NoLabel),this.na.$("CtrlClickExperience_FloodgateRatingQuestion",CommonUIStrings.l_CtrlClickExperience_FloodgateRatingQuestion),this.na.$("CtrlClickExperience_FloodgateRating_1",CommonUIStrings.l_CtrlClickExperience_FloodgateRating_1),this.na.$("CtrlClickExperience_FloodgateRating_2",
CommonUIStrings.l_CtrlClickExperience_FloodgateRating_2),this.na.$("CtrlClickExperience_FloodgateRating_3",CommonUIStrings.l_CtrlClickExperience_FloodgateRating_3),this.na.$("CtrlClickExperience_FloodgateRating_4",CommonUIStrings.l_CtrlClickExperience_FloodgateRating_4),this.na.$("CtrlClickExperience_FloodgateRating_5",CommonUIStrings.l_CtrlClickExperience_FloodgateRating_5),this.na.$("CtrlClickExperience_FloodgateWhyQuestion",CommonUIStrings.l_CtrlClickExperience_FloodgateWhyQuestion),this.na.$("WordTypingResponsiveness_FloodgatePromptTitle",
CommonUIStrings.l_WordTypingResponsiveness_FloodgatePromptTitle),this.na.$("WordTypingResponsiveness_FloodgatePromptQuestion",CommonUIStrings.l_WordTypingResponsiveness_FloodgatePromptQuestion),this.na.$("WordTypingResponsiveness_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordTypingResponsiveness_FloodgatePrompt_YesLabel),this.na.$("WordTypingResponsiveness_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordTypingResponsiveness_FloodgatePrompt_NoLabel),this.na.$("WordTypingResponsiveness_FloodgateRatingQuestion",
CommonUIStrings.l_WordTypingResponsiveness_FloodgateRatingQuestion),this.na.$("WordTypingResponsiveness_FloodgateRating_1",CommonUIStrings.l_WordTypingResponsiveness_FloodgateRating_1),this.na.$("WordTypingResponsiveness_FloodgateRating_2",CommonUIStrings.l_WordTypingResponsiveness_FloodgateRating_2),this.na.$("WordTypingResponsiveness_FloodgateRating_3",CommonUIStrings.l_WordTypingResponsiveness_FloodgateRating_3),this.na.$("WordTypingResponsiveness_FloodgateRating_4",CommonUIStrings.l_WordTypingResponsiveness_FloodgateRating_4),
this.na.$("WordTypingResponsiveness_FloodgateRating_5",CommonUIStrings.l_WordTypingResponsiveness_FloodgateRating_5),this.na.$("WordTypingResponsiveness_FloodgateWhyQuestion",CommonUIStrings.l_WordTypingResponsiveness_FloodgateWhyQuestion),this.na.$("ShareSection_PromptLine_1",CommonUIStrings.l_Excel_ShareSection_PromptLine_1),this.na.$("ShareSection_PromptLine_2",CommonUIStrings.l_Excel_ShareSection_PromptLine_2),this.na.$("ShareSection_PromptLabel_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),
this.na.$("ShareSection_PromptLabel_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("ShareSection_RatingQuestion",CommonUIStrings.l_Excel_ShareSection_RatingQuestion),this.na.$("ShareSection_RatingValue_1",CommonUIStrings.l_Excel_Rating_1_Satisfied),this.na.$("ShareSection_RatingValue_2",CommonUIStrings.l_Excel_Rating_2_Satisfied),this.na.$("ShareSection_RatingValue_3",CommonUIStrings.l_Excel_Rating_3_Satisfied),this.na.$("ShareSection_RatingValue_4",CommonUIStrings.l_Excel_Rating_4_Satisfied),
this.na.$("ShareSection_RatingValue_5",CommonUIStrings.l_Excel_Rating_5_Satisfied),this.na.$("ShareSection_CommentQuestion",CommonUIStrings.l_Excel_ShareSection_CommentQuestion),this.na.$("ShareSection_LinkCreation_PromptLine_1",CommonUIStrings.l_Excel_ShareSection_LinkGeneration_PromptLine_1),this.na.$("WordUnsavedPrompt_FloodgatePromptTitle",CommonUIStrings.l_WAC_GenericSurvey_FloodgatePromptTitle),this.na.$("WordUnsavedPrompt_FloodgatePromptQuestion",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),
this.na.$("WordUnsavedPrompt_FloodgatePrompt_YesLabel",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("WordUnsavedPrompt_FloodgatePrompt_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("WordUnsavedPrompt_FloodgateRatingQuestion",CommonUIStrings.l_WordUnsavedPrompt_FloodgateRatingQuestion),this.na.$("WordUnsavedPrompt_FloodgateRating_1",CommonUIStrings.l_WordUnsavedPrompt_FloodgateRating_1),this.na.$("WordUnsavedPrompt_FloodgateRating_2",CommonUIStrings.l_WordUnsavedPrompt_FloodgateRating_2),
this.na.$("WordUnsavedPrompt_FloodgateRating_3",CommonUIStrings.l_WordUnsavedPrompt_FloodgateRating_3),this.na.$("WordUnsavedPrompt_FloodgateRating_4",CommonUIStrings.l_WordUnsavedPrompt_FloodgateRating_4),this.na.$("WordUnsavedPrompt_FloodgateRating_5",CommonUIStrings.l_WordUnsavedPrompt_FloodgateRating_5),this.na.$("WordUnsavedPrompt_FloodgateWhyQuestion",CommonUIStrings.l_WordUnsavedPrompt_FloodgateWhyQuestion),this.na.$("ExcelLive_PromptLine_1",CommonUIStrings.l_Excel_ExcelLive_PromptLine_1),
this.na.$("ExcelLive_PromptLine_2",CommonUIStrings.l_Excel_ExcelLive_PromptLine_2),this.na.$("ExcelLive_PromptLabel_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("ExcelLive_PromptLabel_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("ExcelLive_RatingQuestion",CommonUIStrings.l_Excel_ExcelLive_RatingQuestion),this.na.$("ExcelLive_RatingValue_1",CommonUIStrings.l_Excel_ExcelLive_RatingValue_1),this.na.$("ExcelLive_RatingValue_2",CommonUIStrings.l_Excel_ExcelLive_RatingValue_2),
this.na.$("ExcelLive_RatingValue_3",CommonUIStrings.l_Excel_ExcelLive_RatingValue_3),this.na.$("ExcelLive_RatingValue_4",CommonUIStrings.l_Excel_ExcelLive_RatingValue_4),this.na.$("ExcelLive_RatingValue_5",CommonUIStrings.l_Excel_ExcelLive_RatingValue_5),this.na.$("ExcelLive_CommentQuestion",CommonUIStrings.l_Excel_ExcelLive_CommentQuestion),this.na.$("SmartViewFormatAsTable_Prompt",CommonUIStrings.l_Excel_SmartViewFormatAsTable_Prompt),this.na.$("SmartViewFormatAsTable_PromptQuestion",CommonUIStrings.l_Excel_SmartViewFormatAsTable_PromptQuestion),
this.na.$("SmartViewFormatAsTable_Rating_Question",CommonUIStrings.l_Excel_SmartViewFormatAsTable_Rating_Question),this.na.$("SmartViewFormatAsTable_RatingValue_1",CommonUIStrings.l_Excel_SmartViewFormatAsTable_RatingValue_1),this.na.$("SmartViewFormatAsTable_RatingValue_2",CommonUIStrings.l_Excel_SmartViewFormatAsTable_RatingValue_2),this.na.$("SmartViewFormatAsTable_RatingValue_3",CommonUIStrings.l_Excel_SmartViewFormatAsTable_RatingValue_3),this.na.$("SmartViewFormatAsTable_RatingValue_4",CommonUIStrings.l_Excel_SmartViewFormatAsTable_RatingValue_4),
this.na.$("SmartViewFormatAsTable_RatingValue_5",CommonUIStrings.l_Excel_SmartViewFormatAsTable_RatingValue_5),this.na.$("SmartViewFormatAsTable_WhyQuestion",CommonUIStrings.l_Excel_SmartViewFormatAsTable_WhyQuestion),this.na.$("EaseOfDiscoveringCommand_Floodgate_PromptTitle",CommonUIStrings.l_EaseOfDiscoveringCommand_Floodgate_PromptTitle),this.na.$("EaseOfDiscoveringCommand_Floodgate_PromptQuestion",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.na.$("EaseOfDiscoveringCommand_Floodgate_PromptAnswer_NotNow",
CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("EaseOfDiscoveringCommand_Floodgate_PromptAnswer_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("EaseOfDiscoveringCommand_Floodgate_RatingQuestion",CommonUIStrings.l_EaseOfDiscoveringCommand_Floodgate_RatingQuestion),this.na.$("EaseOfDiscoveringCommand_Floodgate_RatingValue_1",CommonUIStrings.l_EaseOfDiscoveringCommand_Floodgate_RatingValue_1),this.na.$("EaseOfDiscoveringCommand_Floodgate_RatingValue_2",CommonUIStrings.l_EaseOfDiscoveringCommand_Floodgate_RatingValue_2),
this.na.$("EaseOfDiscoveringCommand_Floodgate_RatingValue_3",CommonUIStrings.l_EaseOfDiscoveringCommand_Floodgate_RatingValue_3),this.na.$("EaseOfDiscoveringCommand_Floodgate_RatingValue_4",CommonUIStrings.l_EaseOfDiscoveringCommand_Floodgate_RatingValue_4),this.na.$("EaseOfDiscoveringCommand_Floodgate_RatingValue_5",CommonUIStrings.l_EaseOfDiscoveringCommand_Floodgate_RatingValue_5),this.na.$("EaseOfDiscoveringCommand_Floodgate_HearMoreQuestion",CommonUIStrings.l_EaseOfDiscoveringCommand_Floodgate_HearMoreQuestion),
this.na.$("EaseOfEditingAndFormatting_Floodgate_PromptTitle",CommonUIStrings.l_EaseOfEditingAndFormatting_Floodgate_PromptTitle),this.na.$("EaseOfEditingAndFormatting_Floodgate_PromptQuestion",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.na.$("EaseOfEditingAndFormatting_Floodgate_PromptAnswer_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("EaseOfEditingAndFormatting_Floodgate_PromptAnswer_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("EaseOfEditingAndFormatting_Floodgate_RatingQuestion",
CommonUIStrings.l_EaseOfEditingAndFormatting_Floodgate_RatingQuestion),this.na.$("EaseOfEditingAndFormatting_Floodgate_RatingValue_1",CommonUIStrings.l_EaseOfEditingAndFormatting_Floodgate_RatingValue_1),this.na.$("EaseOfEditingAndFormatting_Floodgate_RatingValue_2",CommonUIStrings.l_EaseOfEditingAndFormatting_Floodgate_RatingValue_2),this.na.$("EaseOfEditingAndFormatting_Floodgate_RatingValue_3",CommonUIStrings.l_EaseOfEditingAndFormatting_Floodgate_RatingValue_3),this.na.$("EaseOfEditingAndFormatting_Floodgate_RatingValue_4",
CommonUIStrings.l_EaseOfEditingAndFormatting_Floodgate_RatingValue_4),this.na.$("EaseOfEditingAndFormatting_Floodgate_RatingValue_5",CommonUIStrings.l_EaseOfEditingAndFormatting_Floodgate_RatingValue_5),this.na.$("EaseOfEditingAndFormatting_Floodgate_HearMoreQuestion",CommonUIStrings.l_EaseOfEditingAndFormatting_Floodgate_HearMoreQuestion),this.na.$("EaseOfUse_Floodgate_Prompt_Line1",CommonUIStrings.l_EaseOfUse_Floodgate_Prompt_Line1),this.na.$("EaseOfUse_Floodgate_Prompt_Line2",CommonUIStrings.l_EaseOfUse_Floodgate_Prompt_Line2),
this.na.$("EaseOfUse_Floodgate_Prompt_Affirmative_Answer",CommonUIStrings.l_EaseOfUse_Floodgate_Prompt_Affirmative_Answer),this.na.$("EaseOfUse_Floodgate_Prompt_Negative_Answer",CommonUIStrings.l_EaseOfUse_Floodgate_Prompt_Negative_Answer),this.na.$("EaseOfUse_Floodgate_Rating_Question",CommonUIStrings.l_EaseOfUse_Floodgate_Rating_Question),this.na.$("EaseOfUse_Floodgate_Rating_Scale_1",CommonUIStrings.l_EaseOfUse_Floodgate_Rating_Scale_1),this.na.$("EaseOfUse_Floodgate_Rating_Scale_2",CommonUIStrings.l_EaseOfUse_Floodgate_Rating_Scale_2),
this.na.$("EaseOfUse_Floodgate_Rating_Scale_3",CommonUIStrings.l_EaseOfUse_Floodgate_Rating_Scale_3),this.na.$("EaseOfUse_Floodgate_Rating_Scale_4",CommonUIStrings.l_EaseOfUse_Floodgate_Rating_Scale_4),this.na.$("EaseOfUse_Floodgate_Rating_Scale_5",CommonUIStrings.l_EaseOfUse_Floodgate_Rating_Scale_5),this.na.$("EaseOfUse_Floodgate_Comment_Question",CommonUIStrings.l_EaseOfUse_Floodgate_Comment_Question),this.na.$("PerformanceExperience_PromptLine_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),
this.na.$("PerformanceExperience_PromptLine_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("PerformanceExperience_RatingQuestion",uc.j6b(0)),this.na.$("PerformanceExperience_RatingQuestion_OpenFile",uc.j6b(1)),this.na.$("PerformanceExperience_RatingQuestion_Responsivness",uc.j6b(2)),this.na.$("PerformanceExperience_RatingQuestion_OpenFile_CurrentSession",uc.j6b(3)),this.na.$("PerformanceExperience_RatingQuestion_Responsivness_CurrentSession",uc.j6b(4)),this.na.$("PerformanceExperience_RatingValue_1",
CommonUIStrings.l_Excel_Rating_1_Satisfied),this.na.$("PerformanceExperience_RatingValue_2",CommonUIStrings.l_Excel_Rating_2_Satisfied),this.na.$("PerformanceExperience_RatingValue_3",CommonUIStrings.l_Excel_Rating_3_Satisfied),this.na.$("PerformanceExperience_RatingValue_4",CommonUIStrings.l_Excel_Rating_4_Satisfied),this.na.$("PerformanceExperience_RatingValue_5",CommonUIStrings.l_Excel_Rating_5_Satisfied),this.na.$("PerformanceExperience_CommentQuestion",CommonUIStrings.l_Excel_PerformanceExperience_CommentQuestion),
this.na.$("CleanData_PromptTitle",CommonUIStrings.l_Excel_CleanData_Survey_PromptTitle),this.na.$("CleanData_PromptQuestion",CommonUIStrings.l_Excel_CleanData_Survey_PromptQuestion),this.na.$("CleanData_PromptAnswer_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("CleanData_PromptAnswer_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("CleanData_RatingQuestion",CommonUIStrings.l_Excel_CleanData_Survey_RatingQuestion),this.na.$("CleanData_RatingValue_1",CommonUIStrings.l_Excel_CleanData_Survey_RatingValue_1),
this.na.$("CleanData_RatingValue_2",CommonUIStrings.l_Excel_CleanData_Survey_RatingValue_2),this.na.$("CleanData_RatingValue_3",CommonUIStrings.l_Excel_CleanData_Survey_RatingValue_3),this.na.$("CleanData_RatingValue_4",CommonUIStrings.l_Excel_CleanData_Survey_RatingValue_4),this.na.$("CleanData_RatingValue_5",CommonUIStrings.l_Excel_CleanData_Survey_RatingValue_5),this.na.$("CleanData_CommentQuestion",CommonUIStrings.l_Excel_CleanData_Survey_CommentQuestion),this.na.$("DarkModeSurvey_Title",CommonUIStrings.l_WAC_DarkModeSurvey_Title),
this.na.$("DarkModeSurvey_Question",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.na.$("DarkModeSurvey_YesLabel",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("DarkModeSurvey_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("DarkModeSurvey_RatingQuestion",CommonUIStrings.l_WAC_DarkModeSurvey_RatingQuestion),this.na.$("DarkModeSurvey_RatingValue_1",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_1_VeryDissatisfied),this.na.$("DarkModeSurvey_RatingValue_2",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_2_SomewhatDissatisfied),
this.na.$("DarkModeSurvey_RatingValue_3",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_3_Neutral),this.na.$("DarkModeSurvey_RatingValue_4",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_4_SomewhatSatisfied),this.na.$("DarkModeSurvey_RatingValue_5",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_5_VerySatisfied),this.na.$("DarkModeSurvey_WhyQuestion",CommonUIStrings.l_WAC_GenericSurvey_WhyThatRatingQuestion),this.na.$("Fluent2Survey_Title",CommonUIStrings.l_Fluent2StyleFloodgateSurvey_Prompt_Line_1),
this.na.$("Fluent2Survey_Question",CommonUIStrings.l_Fluent2StyleFloodgateSurvey_Prompt_Line_2),this.na.$("Fluent2Survey_YesLabel",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("Fluent2Survey_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("Fluent2Survey_RatingQuestion",CommonUIStrings.l_Fluent2StyleFloodgateSurvey_Rating_Question),this.na.$("Fluent2Survey_RatingValue_1",CommonUIStrings.l_Fluent2StyleFloodgateSurvey_Rating_Question_Option_1),this.na.$("Fluent2Survey_RatingValue_2",
CommonUIStrings.l_Fluent2StyleFloodgateSurvey_Rating_Question_Option_2),this.na.$("Fluent2Survey_RatingValue_3",CommonUIStrings.l_Fluent2StyleFloodgateSurvey_Rating_Question_Option_3),this.na.$("Fluent2Survey_RatingValue_4",CommonUIStrings.l_Fluent2StyleFloodgateSurvey_Rating_Question_Option_4),this.na.$("Fluent2Survey_RatingValue_5",CommonUIStrings.l_Fluent2StyleFloodgateSurvey_Rating_Question_Option_5),this.na.$("Fluent2Survey_WhyQuestion",CommonUIStrings.l_Fluent2StyleFloodgateSurvey_CommentQuestion),
this.na.$("Fluent2OptOutSurvey_Title",CommonUIStrings.l_Fluent2StyleOptOutFloodgateSurvey_Prompt_Line_1),this.na.$("Fluent2OptOutSurvey_Question",CommonUIStrings.l_Fluent2StyleOptOutFloodgateSurvey_Prompt_Line_2),this.na.$("Fluent2OptOutSurvey_YesLabel",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("Fluent2OptOutSurvey_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("Fluent2OptOutSurvey_RatingQuestion",CommonUIStrings.l_Fluent2StyleOptOutFloodgateSurvey_Rating_Question),
this.na.$("Fluent2OptOutSurvey_RatingValue_1",CommonUIStrings.l_Fluent2StyleOptOutFloodgateSurvey_Rating_Question_Option_1),this.na.$("Fluent2OptOutSurvey_RatingValue_2",CommonUIStrings.l_Fluent2StyleOptOutFloodgateSurvey_Rating_Question_Option_2),this.na.$("Fluent2OptOutSurvey_WhyQuestion",CommonUIStrings.l_Fluent2StyleFloodgateSurvey_CommentQuestion),this.na.$("ConsumerExperiment_PromptTitle",CommonUIStrings.l_ConsumerExperiment_Floodgate_PromptTitle),this.na.$("ConsumerExperiment_PromptQuestion",
CommonUIStrings.l_ConsumerExperiment_Floodgate_PromptQuestion),this.na.$("ConsumerExperiment_RatingQuestion",CommonUIStrings.l_ConsumerExperiment_Floodgate_RatingQuestion),this.na.$("ConsumerExperiment_RatingValue1",CommonUIStrings.l_ConsumerExperiment_Floodgate_RatingValue_1),this.na.$("ConsumerExperiment_RatingValue2",CommonUIStrings.l_ConsumerExperiment_Floodgate_RatingValue_2),this.na.$("ConsumerExperiment_RatingValue3",CommonUIStrings.l_ConsumerExperiment_Floodgate_RatingValue_3),this.na.$("ConsumerExperiment_RatingValue4",
CommonUIStrings.l_ConsumerExperiment_Floodgate_RatingValue_4),this.na.$("ConsumerExperiment_RatingValue5",CommonUIStrings.l_ConsumerExperiment_Floodgate_RatingValue_5),this.na.$("ConsumerExperiment_VerbatimQuestion",CommonUIStrings.l_ConsumerExperiment_Floodgate_Verbatim_Question),this.na.$("ConsumerExperiment_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("ConsumerExperiment_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("AIMakerSurvey_Title",CommonUIStrings.l_AIMakerSurvey_Title),
this.na.$("AIMakerSurvey_Question",CommonUIStrings.l_AIMakerSurvey_Question),this.na.$("AIMakerSurvey_YesLabel",CommonUIStrings.l_AIMakerSurvey_YesLabel),this.na.$("AIMakerSurvey_NoLabel",CommonUIStrings.l_AIMakerSurvey_NoLabel),this.na.$("AIMakerSurvey_RatingQuestion",CommonUIStrings.l_AIMakerSurvey_RatingQuestion),this.na.$("AIMakerSurvey_MinRating",CommonUIStrings.l_AIMakerSurvey_MinRating),this.na.$("AIMakerSurvey_MaxRating",CommonUIStrings.l_AIMakerSurvey_MaxRating),this.na.$("AIMakerSurvey_CommentQuestion",
CommonUIStrings.l_AIMakerSurvey_CommentQuestion),this.na.$("CheckPerformance_Prompt",CommonUIStrings.l_Excel_CheckPerformance_Prompt),this.na.$("CheckPerformance_PromptQuestion",CommonUIStrings.l_Excel_CheckPerformance_PromptQuestion),this.na.$("CheckPerformance_PromptLabel_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("CheckPerformance_PromptLabel_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("CheckPerformance_RatingQuestion",CommonUIStrings.l_Excel_CheckPerformance_RatingQuestion),
this.na.$("CheckPerformance_RatingValue_1",CommonUIStrings.l_Excel_CheckPerformance_RatingValue_1),this.na.$("CheckPerformance_RatingValue_2",CommonUIStrings.l_Excel_CheckPerformance_RatingValue_2),this.na.$("CheckPerformance_RatingValue_3",CommonUIStrings.l_Excel_CheckPerformance_RatingValue_3),this.na.$("CheckPerformance_RatingValue_4",CommonUIStrings.l_Excel_CheckPerformance_RatingValue_4),this.na.$("CheckPerformance_RatingValue_5",CommonUIStrings.l_Excel_CheckPerformance_RatingValue_5),this.na.$("CheckPerformance_CommentQuestion",
CommonUIStrings.l_Excel_CheckPerformance_CommentQuestion),this.na.$("SmartSuggestion_PromptTitle",CommonUIStrings.l_Excel_SmartSuggestion_Survey_PromptTitle),this.na.$("SmartSuggestion_PromptQuestion",CommonUIStrings.l_Excel_SmartSuggestion_Survey_PromptQuestion),this.na.$("SmartSuggestion_PromptAnswer_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("SmartSuggestion_PromptAnswer_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("SmartSuggestion_RatingQuestion",CommonUIStrings.l_Excel_SmartSuggestion_Survey_RatingQuestion),
this.na.$("SmartSuggestion_RatingValue_1",CommonUIStrings.l_Excel_SmartSuggestion_Survey_RatingValue_1),this.na.$("SmartSuggestion_RatingValue_2",CommonUIStrings.l_Excel_SmartSuggestion_Survey_RatingValue_2),this.na.$("SmartSuggestion_RatingValue_3",CommonUIStrings.l_Excel_SmartSuggestion_Survey_RatingValue_3),this.na.$("SmartSuggestion_RatingValue_4",CommonUIStrings.l_Excel_SmartSuggestion_Survey_RatingValue_4),this.na.$("SmartSuggestion_RatingValue_5",CommonUIStrings.l_Excel_SmartSuggestion_Survey_RatingValue_5),
this.na.$("SmartSuggestion_CommentQuestion",CommonUIStrings.l_Excel_SmartSuggestion_Survey_CommentQuestion),this.na.$("PPTO_Picture_FloodgatePromptTitle",CommonUIStrings.l_WAC_GenericSurvey_FloodgatePromptTitle),this.na.$("PPTO_Picture_FloodgatePromptQuestion",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.na.$("PPTO_Picture_FloodgatePrompt_YesLabel",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("PPTO_Picture_FloodgatePrompt_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),
this.na.$("PPTO_Picture_FloodgateRatingQuestion",CommonUIStrings.l_PPTO_Picture_FloodgateRatingQuestion),this.na.$("PPTO_Picture_FloodgateRating_1",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_1_VeryDissatisfied),this.na.$("PPTO_Picture_FloodgateRating_2",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_2_SomewhatDissatisfied),this.na.$("PPTO_Picture_FloodgateRating_3",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_3_Neutral),this.na.$("PPTO_Picture_FloodgateRating_4",CommonUIStrings.l_PPTO_Picture_FloodgateRating_4_SomewhatSatisfied),
this.na.$("PPTO_Picture_FloodgateRating_5",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_5_VerySatisfied),this.na.$("PPTO_Picture_FloodgateWhyQuestion",CommonUIStrings.l_PPTO_Picture_FloodgateWhyQuestion),this.na.$("CCPExperience_FloodgatePromptTitle",CommonUIStrings.l_CCPExperience_FloodgatePromptTitle),this.na.$("CCPExperience_FloodgatePromptQuestion",CommonUIStrings.l_CCPExperience_FloodgatePromptQuestion),this.na.$("CCPExperience_FloodgatePrompt_YesLabel",CommonUIStrings.l_CCPExperience_FloodgatePrompt_YesLabel),
this.na.$("CCPExperience_FloodgatePrompt_NoLabel",CommonUIStrings.l_CCPExperience_FloodgatePrompt_NoLabel),this.na.$("CCPExperience_FloodgateRatingQuestion",CommonUIStrings.l_CCPExperience_FloodgateRatingQuestion),this.na.$("CCPExperience_FloodgateRating_1",CommonUIStrings.l_CCPExperience_FloodgateRating_1),this.na.$("CCPExperience_FloodgateRating_2",CommonUIStrings.l_CCPExperience_FloodgateRating_2),this.na.$("CCPExperience_FloodgateRating_3",CommonUIStrings.l_CCPExperience_FloodgateRating_3),this.na.$("CCPExperience_FloodgateRating_4",
CommonUIStrings.l_CCPExperience_FloodgateRating_4),this.na.$("CCPExperience_FloodgateRating_5",CommonUIStrings.l_CCPExperience_FloodgateRating_5),this.na.$("CCPExperience_FloodgateWhyQuestion",CommonUIStrings.l_CCPExperience_FloodgateWhyQuestion),this.na.$("FRE_FirstTeachingCalloutTitle",CommonUIStrings.l_FRE_FirstTeachingCalloutTitle),this.na.$("FRE_FirstTeachingCalloutDescription",CommonUIStrings.l_FRE_FirstTeachingCalloutDescription),this.na.$("FRE_TeachingCalloutNextButtonText",CommonUIStrings.l_FRE_TeachingCalloutNextButtonText),
this.na.$("FRE_SecondTeachingCalloutTitle",CommonUIStrings.l_FRE_SecondTeachingCalloutTitle),this.na.$("FRE_SecondTeachingCalloutDescription",CommonUIStrings.l_FRE_SecondTeachingCalloutDescription),this.na.$("FRE_ThirdTeachingCalloutTitle",CommonUIStrings.l_FRE_ThirdTeachingCalloutTitle),this.na.$("FRE_ThirdTeachingCalloutDescription",CommonUIStrings.l_FRE_ThirdTeachingCalloutDescription),this.na.$("FRE_TeachingCalloutGotItButtonText",CommonUIStrings.l_FRE_TeachingCalloutGotItButtonText),this.na.$("FloodgateSurveyNoRealEditPromptTitle",
CommonUIStrings.l_FloodgateSurveyNoRealEditPromptTitle),this.na.$("FloodgateSurveyNoRealEditPromptQuestion",CommonUIStrings.l_FloodgateSurveyNoRealEditPromptQuestion),this.na.$("FloodgateSurveyNoRealEditSure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("FloodgateSurveyNoRealEditNotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("FloodgateSurveyNoRealEditQuestion1",CommonUIStrings.l_FloodgateSurveyNoRealEditQuestion1),this.na.$("FloodgateSurveyNoRealEditOption1",CommonUIStrings.l_FloodgateSurveyNoRealEditOption1),
this.na.$("FloodgateSurveyNoRealEditOption2",CommonUIStrings.l_FloodgateSurveyNoRealEditOption2),this.na.$("FloodgateSurveyNoRealEditOption3",CommonUIStrings.l_FloodgateSurveyNoRealEditOption3),this.na.$("FloodgateSurveyNoRealEditOption4",CommonUIStrings.l_FloodgateSurveyNoRealEditOption4),this.na.$("FloodgateSurveyNoRealEditOption5",CommonUIStrings.l_FloodgateSurveyNoRealEditOption5),this.na.$("FloodgateSurveyNoRealEditQuestion2",CommonUIStrings.l_FloodgateSurveyNoRealEditQuestion2),this.na.$("FormulaByExample_PromptTitle",
CommonUIStrings.l_Excel_FormulaByExample_Survey_PromptTitle),this.na.$("FormulaByExample_PromptQuestion",CommonUIStrings.l_Excel_FormulaByExample_Survey_PromptQuestion),this.na.$("FormulaByExample_PromptAnswer_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("FormulaByExample_PromptAnswer_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("FormulaByExample_RatingQuestion",CommonUIStrings.l_Excel_FormulaByExample_Survey_RatingQuestion),this.na.$("FormulaByExampleIgnored_RatingQuestion",
CommonUIStrings.l_Excel_FormulaByExampleIgnored_Survey_RatingQuestion),this.na.$("FormulaByExample_RatingValue_1",CommonUIStrings.l_Excel_FormulaByExample_Survey_RatingValue_1),this.na.$("FormulaByExample_RatingValue_2",CommonUIStrings.l_Excel_FormulaByExample_Survey_RatingValue_2),this.na.$("FormulaByExample_RatingValue_3",CommonUIStrings.l_Excel_FormulaByExample_Survey_RatingValue_3),this.na.$("FormulaByExample_RatingValue_4",CommonUIStrings.l_Excel_FormulaByExample_Survey_RatingValue_4),this.na.$("FormulaByExample_RatingValue_5",
CommonUIStrings.l_Excel_FormulaByExample_Survey_RatingValue_5),this.na.$("FormulaByExample_CommentQuestion",CommonUIStrings.l_Excel_FormulaByExample_Survey_CommentQuestion),this.na.$("FormulaByExampleDeclined_CommentQuestion",CommonUIStrings.l_Excel_FormulaByExampleDeclined_Survey_CommentQuestion)}catch(eb){k.ULS.sendTraceTag(594052319,356,15,"SIFB.InitializeUIStringGetter error "+(eb?eb.toString():""))}}static jJi(eb){try{return new Promise(Tb=>{window.setTimeout(()=>{Tb(null)},eb)})}catch(Tb){return k.ULS.sendTraceTag(578348238,
356,50,"SIFB Info: Floodgate init delay not possible in DelayCustomMs"),Promise.resolve(null)}}static $_f(){return!r.AFrameworkApplication.fa.ka("FloodgateGovernanceServiceIsDisabled")}static Eej(){return r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgatePrioritySurveyEnabled",!1)}static FVd(eb){const Tb=eb?eb[0]:null;k.ULS.sendTraceTag(512505556,356,50,"SIFB Info:ConvertAndShowTeachingUx - "+(Tb?Tb.surfaceId:""));if(Tb&&"customsurface"===(Tb&&Tb.surfaceType?
Tb.surfaceType.toLocaleLowerCase():null)){const lb=ta.a.kvj(Tb);if(lb)return k.ULS.sendTraceTag(555071522,356,50,"SIFB Info:Floodgate activation result - "+lb+", "+Tb.surfaceId),null}return ub.FVd(eb)}static e9i(){const eb={};eb.retry=r.AFrameworkApplication.fa.Fc("FloodgateGovernanceServiceRetryCount",0);eb.timeout=r.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.FloodgateGovernanceServiceTimeoutInMs",1E4);eb.simpleRequestEnabled=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateGovernanceServiceSimpleRequestEnabled",
!1);eb.forceServicelessSurveyDisplay=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateGovernanceServiceForceServicelessSurveyDisplayEnabled",!1);return eb}static $Ai(eb){if(!("Unknown"!==eb&&"Automation"!==eb&&r.AFrameworkApplication.fa.ka("FloodgateAuthCallbackIsEnabled")||r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateLocalMessagingEnabled",!1)))return k.ULS.sendTraceTag(50423047,356,50,"SIFB Info:Floodgate authCallback not enabled "+
eb),null;eb={};eb.getUserPuid=uc.imj;return eb}static YAi(){const eb={},Tb=!r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateAugLoopRuntimeIsDisabled",!1)&&(r.AFrameworkApplication.fa.ka("IsO365ConsumerHost")||r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateAugLoopRuntimeIsEnabled",!1));eb.isEnabled=Tb;return eb}static imj(){return r.AFrameworkApplication.fa.Ha("Puid")}static G6f(){return ta.a.wua()?CommonUIStrings.l_WAC_NPS_RatingQuestion_WordForTeams:
CommonUIStrings.l_WAC_NPS_RatingQuestion_Word}static F6f(){return ta.a.wua()?CommonUIStrings.l_WAC_NPS_RatingQuestion_PowerPointForTeams:CommonUIStrings.l_WAC_NPS_RatingQuestion_PowerPoint}static E6f(){return ta.a.wua()&&r.AFrameworkApplication.fa.ka("ExcelNpsForTeamsQuestionIsEnabled")?CommonUIStrings.l_WAC_NPS_RatingQuestion_ExcelForTeams:CommonUIStrings.l_WAC_NPS_RatingQuestion_Excel}static j6b(eb){if(ta.a.wua())switch(eb){case 1:return CommonUIStrings.l_ExcelForTeams_PerformanceExperience_RatingQuestion_OpenFile;
case 2:return CommonUIStrings.l_ExcelForTeams_PerformanceExperience_RatingQuestion_Responsivness;case 3:return CommonUIStrings.l_ExcelForTeams_PerformanceExperience_RatingQuestion_OpenFile_CurrentSession;case 4:return CommonUIStrings.l_ExcelForTeams_PerformanceExperience_RatingQuestion_Responsivness_CurrentSession;default:return CommonUIStrings.l_ExcelForTeams_PerformanceExperience_RatingQuestion}switch(eb){case 1:return CommonUIStrings.l_Excel_PerformanceExperience_RatingQuestion_OpenFile;case 2:return CommonUIStrings.l_Excel_PerformanceExperience_RatingQuestion_Responsivness;
case 3:return CommonUIStrings.l_Excel_PerformanceExperience_RatingQuestion_OpenFile_CurrentSession;case 4:return CommonUIStrings.l_Excel_PerformanceExperience_RatingQuestion_Responsivness_CurrentSession;default:return CommonUIStrings.l_Excel_PerformanceExperience_RatingQuestion}}static enj(){return ta.a.wua()&&r.AFrameworkApplication.fa.ka("NpsOneNoteForTeamsQuestionIsEnabled")?CommonUIStrings.l_WAC_NPS_RatingQuestion_OneNoteForTeams:CommonUIStrings.l_WAC_NPS_RatingQuestion_OneNote}static gnj(){return ta.a.wua()?
CommonUIStrings.l_OnenotePerf_FloodgateRatingQuestionForTeams:CommonUIStrings.l_OnenotePerf_FloodgateRatingQuestion}static fnj(){return ta.a.wua()?CommonUIStrings.l_OnenotePerf_FloodgatePromptTitleForTeams:CommonUIStrings.l_OnenotePerf_FloodgatePromptTitle}static hnj(){switch(r.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.WordOnline.Designer.SmartPasteInCCPFloatieExperience",0)){case 1:return CommonUIStrings.l_WordDesigner_FormatWithDesignerFeedbackRatingQuestion;case 2:return CommonUIStrings.l_WordDesigner_MatchDocumentFormattingFeedbackRatingQuestion;
case 3:return CommonUIStrings.l_WordDesigner_UseSmartPasteFeedbackRatingQuestion;default:return""}}}uc.Efb="SystemInitiatedFeedbackIsEnabled";uc.Jni="obf-CampaignDefinitions";uc.sKf=100;uc.PIi=8002;Object(K.a)(uc,"SystemInitiatedFeedback",null,[1316]);class mc{constructor(eb){if(!eb)throw Error.argumentNull("SystemInitiatedFeedback is null");this.Amf=eb;this.Fvd={};this.Uuc={};this.Cvd={}}logActivity(eb,Tb,lb){const Fb=new Date;if(!eb||!this.Amf.x8a(eb,uc.Efb,Tb))return!1;let rb=null;eb in this.Fvd&&
(rb=this.Fvd[eb]);const Qb=this.m1i(eb),Bc=this.l1i(eb);if(this.dQi(rb,Fb,lb))return k.ULS.sendTraceTag(39924675,356,50,"SIFB with time lapse: skipped {0} {1} log(s)",Qb,eb),this.Amf.logActivity(eb,Tb),this.Fvd[eb]=Fb,this.Uuc[eb]=0,this.Cvd[eb]=Bc+1,!0;this.Uuc[eb]=Qb+1;return!1}dQi(eb,Tb,lb){return eb?Tb.getTime()-eb.getTime()>=1E3*lb:!0}m1i(eb){let Tb=0;eb in this.Uuc&&(Tb=this.Uuc[eb]);return Tb}l1i(eb){let Tb=0;eb in this.Cvd&&(Tb=this.Cvd[eb]);return Tb}}Object(K.a)(mc,"SystemInitiatedFeedbackWithTimeLapse",
null,[1315]);var Ya=d(93),Mb=d(68);d.d(Z,"CustomerFeedbackPackage",function(){return Kc});class Kc{constructor(){this.i8e=this.Da=null}get name(){return"Common.App.CustomerFeedback"}$b(eb){r.AFrameworkApplication.Vg||(k.ULS.sendTraceTag(51385996,356,15,"DataPlumber is null. Recreate it"),r.AFrameworkApplication.Vg=new C.a);eb.register(W,"Common.App.CustomerFeedback.CustomerFeedbackResourceDownloadManager").as("Common.App.CustomerFeedback.ICustomerFeedbackResourceDownloadManager").ma();eb.register(wa,
"Common.App.CustomerFeedback.CustomerFeedbackUiWrapper").as("Common.App.ICustomerFeedbackUiWrapper").ma().oa(()=>new wa(Ya.FocusManager.instance(),r.AFrameworkApplication.Vg));eb.register(I,"Common.App.CustomerFeedback.CustomerFeedbackC3FormManager").as("Common.App.CustomerFeedback.ICustomerFeedbackFormManager").ma().oa(()=>new I(eb.resolve("Common.App.ICustomerFeedbackUiWrapper"),eb.resolve("Common.App.CustomerFeedback.ICustomerFeedbackResourceDownloadManager"),r.AFrameworkApplication.Vg));eb.register(1279,
"Common.ICustomerFeedbackActor").ma().oa(()=>new H(r.AFrameworkApplication.Ta,r.AFrameworkApplication.Aa,eb.Ja("Common.App.CustomerFeedback.ICustomerFeedbackFormManager"),r.AFrameworkApplication.fa,r.AFrameworkApplication.Vg));eb.register(uc,"Common.App.CustomerFeedback.SystemInitiatedFeedback").as("Common.ISystemInitiatedFeedback").ma().oa(()=>new uc(eb.resolve("Common.App.ICustomerFeedbackUiWrapper")));eb.register(mc,"Common.App.CustomerFeedback.SystemInitiatedFeedbackWithTimeLapse").as("Common.ISystemInitiatedFeedbackWithTimeLapse").ma().oa(()=>
new mc(eb.resolve("Common.ISystemInitiatedFeedback")));this.Da=eb}init(){Kc._initialized||(Kc.H$b()||(this.i8e=this.Da.resolve("Common.ICustomerFeedbackActor"),this.i8e.vb(),r.AFrameworkApplication.Aa.updateCommandUI()),this.Da.Ja("Common.App.IAppSpecificFeedbackData").execute(()=>{this.Da.resolve("Common.App.CustomerFeedback.SystemInitiatedFeedback");this.Da.resolve("Common.App.CustomerFeedback.SystemInitiatedFeedbackWithTimeLapse")}),Kc._initialized=!0)}dispose(){}static H$b(){return!!r.AFrameworkApplication.Aa&&
!!r.AFrameworkApplication.Aa.hb&&3===r.AFrameworkApplication.Aa.hb.Vk&&1===r.AFrameworkApplication.Aa.hb.KIa}static main(){let eb=!1;Kc.H$b()&&(eb=!0);Mb.a.instance.Dc(new Kc,0,eb)}}Kc._initialized=!1;Object(K.a)(Kc,"CustomerFeedbackPackage",null,[2,3])},1135:function(K,Z,d){K=d(0);var k=d(13),e=d(33);class n{constructor(){this.classId=0}static x7a(z){try{return e.a(z)}catch(A){}return null}}Object(K.a)(n,"ARoamingAppsResponse",null,[]);class r{constructor(){this.state=this.callback=null;this.iie=
!1}}Object(K.a)(r,"GetRoamingAppsLauncherContext",null,[]);var v=d(25),C=d(79);d.d(Z,"a",function(){return w});class w{constructor(z){this.qxd=!1;this.l7=w.I$a;this.rId=this.NFd=0;this.platform=null;this.jZh=z;this.Bof=this.tId=!1}get bRe(){return this.jZh}get bCl(){return this.bRe&&this.tId?this.Bof:!1}dri(){v.AFrameworkApplication.w9b&&this.bRe&&!this.tId&&!this.qxd&&(this.rId=3,this.qxd=!0,this.TXk(),this.gRf())}TXk(){this.l7=w.I$a;this.NFd=0}getRoamingAppsLauncher(z,A,u){this.bCl?(z=new r,z.callback=
A,z.state=u,z.iie=!0,this.lRf(z)):A(!1,"",u)}gRf(){const z=new (d(1110).CheckRoamingRightsRequest);z.RoamingApp=this.rId;z.BaseDocQuerySignature=v.AFrameworkApplication.jh;z.execute(Object(k.a)(this,this.fri,"checkUserRoamingRightsSucceeded"),Object(k.a)(this,this.eri,"checkUserRoamingRightsFailed"),null)}fri(z){v.AFrameworkApplication.Tg||((z=n.x7a(z.data.Zd))?this.IUe(z.HasRights):this.IUe(!1))}eri(){if(!v.AFrameworkApplication.Tg)if(this.NFd>=w.ngk)this.IUe(!1);else{var z=new C.a(2,1,this.l7,Object(k.a)(this,
this.retryCheckUserRoamingRights,"retryCheckUserRoamingRights"),59);v.AFrameworkApplication.we.Eb(z);this.NFd++;this.l7*=w.QQe;this.l7>w.Whc&&(this.l7=w.Whc)}}IUe(z){this.Bof=z;this.tId=!0;this.qxd=!1}retryCheckUserRoamingRights(){this.gRf()}lRf(z){const A=new (d(1111).GetRoamingLauncherRequest);A.RoamingApp=this.rId;A.BaseDocQuerySignature=v.AFrameworkApplication.jh;A.execute(Object(k.a)(this,this.Ufj,"getRoamingAppsLauncherSucceeded"),Object(k.a)(this,this.Tfj,"getRoamingAppsLauncherFailed"),z)}Ufj(z){if(!v.AFrameworkApplication.Tg){var A=
n.x7a(z.data.Zd);z=z.data.state;A?(this.platform=A.Platform,z.callback(!0,A.Launcher,z.state)):z.callback(!1,"",z.state)}}Tfj(z){if(!v.AFrameworkApplication.Tg){var A=z.data.state;5===z.data.status&&A.iie?(A.iie=!1,this.lRf(A)):A.callback(!1,"",A.state)}}static get instance(){return w.Ht||(w.Ht=new w(v.AFrameworkApplication.Eei))}}w.I$a=1E3;w.QQe=5;w.Whc=12E5;w.ngk=5;w.Ht=null;Object(K.a)(w,"RoamingAppsManager",null,[])},1136:function(K,Z,d){K=d(0);var k=d(13),e=d(949),n=d(65);class r extends e.a{constructor(E,
H,I,J,T,D=null){super(E,I,T.LR,D);this.Lgf=0;this.Qaa=this.Gbj(J);this.cqb=H;this.Rh=T;this.T_e=7;this.$r=this.cqb.ownerDocument.createElement("div");this.$r.className="ModalCalloutControlOverlay";this.$r.tabIndex=0;this.cqb.insertBefore(this.$r,this.cqb.firstChild)}show(){this.qL||(this.Rh.lhb(),this.Rh.MPa(!1),this.$r.style.zIndex=String(this.Rh.Vqa),super.show(),this.Pu(),this.Lgf=window.setTimeout(Object(k.a)(this,this.dismiss,"dismiss"),1E3*this.T_e))}dismiss(){this.qL&&(this.Rh.wRa(!1),this.Voa(),
this.cqb&&this.cqb.contains(this.$r)&&this.cqb.removeChild(this.$r),super.dismiss(),window.clearTimeout(this.Lgf))}Pu(){this.Rh.nia(Object(k.a)(this,this.dismiss,"dismiss"));this.Rh.By.pb(n.a.click,this.$r,Object(k.a)(this,this.onClick,"onClick"))}Voa(){this.Rh.PZa(Object(k.a)(this,this.dismiss,"dismiss"));this.Rh.By.yb(n.a.click,this.$r,Object(k.a)(this,this.onClick,"onClick"))}onClick(){this.dismiss();return!0}Gbj(E){let H=0;switch(E){case 0:H=190;break;case 1:H=250;break;case 2:H=300;break;case 3:H=
360}return H}}Object(K.a)(r,"ModalCallout",e.a,[]);var v=d(382),C=d(346),w=d(140);class z extends r{constructor(E,H,I,J,T,D=null){super(E,H,I,J,T,D);this.BAc=null}show(){if(!this.qL){const E=Object.assign(new C.a,{onShow:()=>{r.prototype.show.call(this)}});w.UISurfaces.CN().then(H=>{const I=H.externalNotification();this.BAc=H.addNotification(I,E);return null},H=>{v.ULS.sendTraceTag(593352345,383,15,"Failed to GetNotificationsAPIAsync: {0}",H);return null})}}dismiss(){this.qL&&this.BAc&&(w.UISurfaces.CN().then(E=>
{E.removeNotification(this.BAc);return this.BAc=null},E=>{v.ULS.sendTraceTag(593352344,383,15,"Failed to GetNotificationsAPIAsync: {0}",E);return null}),super.dismiss())}}Object(K.a)(z,"ReactManagedModalCallout",r,[]);var A=d(25);d.d(Z,"a",function(){return u});class u{static HWd(E,H,I,J,T=null){return A.AFrameworkApplication.Aa.hb.BUa?new z(E,H,I,J,A.AFrameworkApplication.Aa,T):new r(E,H,I,J,A.AFrameworkApplication.Aa,T)}}Object(K.a)(u,"ModalCalloutControlFactory",null,[])},1137:function(K,Z,d){d.r(Z);
K=d(0);var k=d(512),e=d(513);class n{constructor(w){this.EP=this.h7e=k.a.unused;this.cDc=w}get Msb(){return this.h7e}NEe(w,z,A,u){A===this.cDc.element&&(this.h7e=w,this.EP=u+this.cDc.offset)}JGe(){}HRd(w){return this.Msb!==k.a.unused?Object.assign(new e.a,{element:w,offset:this.EP}):null}}Object(K.a)(n,"ChildSelectionHelper",null,[1451]);class r{constructor(w,z){this.fFd=!1;this.cDc=z;this._parent=w;this.EP=z.offset}get Msb(){return k.a.unused}NEe(w,z,A,u){z||this.cDc.offset!==w||(this.EP=u,this.fFd=
!0)}JGe(w,z){!this.fFd&&this.EP>z&&(this.EP-=z-w+1)}HRd(w){return Object.assign(new e.a,{element:this.fFd?w:this._parent,offset:this.EP})}}Object(K.a)(r,"ParentSelectionHelper",null,[1451]);var v=d(902);d.d(Z,"CombineHelper",function(){return C});class C{constructor(w,z,A){this.W9e=k.a.unused;this.mQb="";this._element=w;this.lWb=z;this.PVb=this.MYf(w,A.start);this.MVb=this.MYf(w,A.end)}MYf(w,z){return z.element===w?new r(w,z):new n(z)}b7h(w){const z=w===this.lWb,A=this._element.childNodes[w],u=this.mQb.length;
this.PVb.NEe(w,z,A,u);this.MVb.NEe(w,z,A,u);this.mQb+=A.nodeValue}end(w,z){this.lWb!==z&&(this.W9e=z,Array.add(w,this))}pui(){var w=this.yej();this.Fgh(this.lWb,w-1);this.Fgh(w+1,this.W9e);w=this._element.childNodes[this.lWb];this.mQb!==w.nodeValue&&(w.nodeValue=this.mQb);return this.xki(w)}Fgh(w,z){if(!(z<w)){this.PVb.JGe(w,z);this.MVb.JGe(w,z);for(let A=w;A<=z;A++)this._element.removeChild(this._element.childNodes[w])}}xki(w){return Object.assign(new v.a,{start:this.PVb.HRd(w),end:this.MVb.HRd(w)})}yej(){return this.PVb.Msb!==
k.a.unused?this.PVb.Msb:this.MVb.Msb!==k.a.unused?this.MVb.Msb:this.lWb}}Object(K.a)(C,"CombineHelper",null,[])},1142:function(K,Z,d){K=d(0);var k=d(1185),e=d(382),n=d(25),r=d(79),v=d(67);class C{static jnj(){if(!C.avc&&(C.avc=new v.a,n.AFrameworkApplication.fa&&n.AFrameworkApplication.fa.aw("AggregatorIdDisabledList"))){const A=n.AFrameworkApplication.fa.RA("AggregatorIdDisabledList");for(let u=0;u<A.length;u++)C.avc.$(A[u],!0)}return C.avc}}C.avc=null;Object(K.a)(C,"DisabledAggregatorListStore",
null,[]);var w=d(284);d.d(Z,"a",function(){return z});class z{constructor(A,u,E,H,I,J=!0,T=null){this.Y8e=this.hnf=this.gef=!1;this.Wd=null;if(!A)throw w.a.argument("taskManagerLazy");if(!I)throw w.a.argument("dataAggregator");this.N0h=A;this.aGd=u;this._id=E;this.gcf=6E4*H;this.Hwc=I;this.xkf=J;this.CVb=T;C.jnj().Hb(this._id.toString())&&(this.Y8e=!0)}get taskManager(){return this.Wd||(this.Wd=this.N0h.value)}track(A,u=null){this.Y8e||(this.wRi(),this.d1k(),this.Hwc.aYb(A,u))}d1k(){!this.gef&&0<
this.gcf&&(this.gef=!0,this.hnh())}hnh(){const A=new r.a(5,1,this.gcf,()=>{this.L2k()},19,this._id.toString());this.taskManager.Eb(A)}L2k(){!this.CVb||this.CVb.zVe()?this.Imd():this.xkf&&this.Hwc.reset();this.hnh()}Imd(){const A=this.Hwc.getData();if(A){const u=parseInt(String(A.length));if(isNaN(u)||0<u)this.qoh(A),this.xkf&&this.Hwc.reset()}}qoh(A){e.ULS.sendTraceTag(7079840,335,50,"Aggregator: {0}",{["ID"]:this._id.toString(),["Data"]:A})}wRi(){this.hnf||(this.aGd(()=>{this.Imd()}),this.hnf=!0)}static ur(A,
u,E,H,I){return new z(new k.a(()=>n.AFrameworkApplication.we),n.AFrameworkApplication.cga,A,u,E,H,I)}static EW(A,u,E,H=!0){return z.ur(A,u,E,H,null)}}Object(K.a)(z,"Aggregator",null,[1264])},1213:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);var k;(function(e){e[e.chrome=0]="chrome";e[e.edge=1]="edge";e[e.firefox=2]="firefox";e[e.IE=3]="IE";e[e.safari=4]="safari";e[e.others=5]="others";e[e.unknown=6]="unknown";e[e.electron=7]="electron";e[e.chromiumEdge=8]="chromiumEdge";e[e.teamsElectron=
9]="teamsElectron"})(k||(k={}));Object(K.b)("BrowserCode",k)},1214:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k{constructor(){this.value=!1}}Object(K.a)(k,"OutBool",null,[])},1215:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k{constructor(){this.Alt=this.DisplayColor=this.Color=null}}Object(K.a)(k,"ColorCellProps",null,[])},1216:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);d=d(351);class k extends d.a{constructor(){super();this.Style=this.Character=null}get Type(){return 1}}
Object(K.a)(k,"CharacterCodeGalleryButtonProps",d.a,[])},1217:function(K,Z,d){d.d(Z,"a",function(){return e});K=d(0);var k=d(508);class e{constructor(n){this.hca=n}HSe(n){return k.a.then(this.hca.vqb(n,1,"",{"Content-Type":"application/json; charset=utf-8"},0,void 0,void 0,void 0,void 0,void 0,"2"),r=>this.Mfj(r))}Mfj(n){return n&&n.Xi&&n.Xi.data?n.Xi.data.Zd:null}}Object(K.a)(e,"SimpleRequestManager",null,[1515])},1218:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);d=d(302);class k{}k.LabelText=
d.a.labelText;k.Alt=d.a.alt;k.Image16by16Class=d.a.Exb;k.Image32by32Class=d.a.xEa;k.Image48by48Class=d.a.Mbe;k.Visible=d.a.visible;k.HasPopup="HasPopup";Object(K.a)(k,"ButtonCommandProperties",null,[])},1221:function(K,Z,d){function k(a,b){if(!a||!b)return[];const c=new Set;a.forEach(h=>{var m;return null===(m=null===h||void 0===h?void 0:h.qEe)||void 0===m?void 0:m.forEach(y=>{y&&c.add(y)})});return Array.from(c).map(h=>b.ye(pa.a.Hf(h))).filter(h=>null!==h&&void 0!==h)}function e(a,b){return b&&b.TableNode?
new eF(b):new fF(a)}d.r(Z);var n=d(0),r=d(68),v=d(54),C=d(93),w=d(178),z=d(171),A=d(119),u=d(25),E=d(1082),H=d(35),I=d(155),J=d(36);class T{constructor(a){this.value=a}}Object(n.a)(T,"RefTriState",null,[]);var D=d(32);class R{iOe(){this.MRi();this.Lyj();this.uWj();this.f3j();J.a.instance.ga(70)&&this.lGk();this.A2k();J.a.instance.ga(71)&&this.MMb();this.mnl();this.gol();this.UHi();this.eWj();this.FZk();this.Jjl();this.kpl();J.a.instance.ga(79)&&(v.a.uk||this.RAj(),this.LYj(),this.akk(),this.Svl())}MRi(){const a=
C.FocusManager.instance().Gc(I.AppFrame.xW);a.bindAction(w.KeyInputManager.Na(z.a.tq,0),D.a.enter);a.bindAction(w.KeyInputManager.Na(z.a.tq,4),D.a.Iod)}Lyj(){const a=C.FocusManager.instance().Gc(I.AppFrame.xW);A.AFrame.jk(a,w.KeyInputManager.hw(Box4Intl.Box4Strings.l_HK_Hyperlink),D.a.insertHyperlink)}RAj(){const a=C.FocusManager.instance().Gc(A.AFrame.nj);A.AFrame.jk(a,w.KeyInputManager.Na(z.a.zga,5),D.a.MD);A.AFrame.jk(a,w.KeyInputManager.Na(z.a.Naa,5),D.a.qz)}eWj(){if(!v.a.hx){const a=C.FocusManager.instance().Gc(A.AFrame.nj);
A.AFrame.jk(a,w.KeyInputManager.Na(z.a.Iuc,w.KeyInputManager.Le),D.a.Jlg,R.Dib("faOpen"))}}uWj(){const a=C.FocusManager.instance().Gc(I.AppFrame.xW);J.a.instance.ga(54)&&A.AFrame.jk(a,w.KeyInputManager.hw(Box4Intl.Box4Strings.l_HK_CenterJustify),D.a.centerJustify,R.FJ);v.a.uk?(A.AFrame.jk(a,w.KeyInputManager.hw(Box4Intl.Box4Strings.l_HK_LeftJustify_Mac),D.a.leftJustify,R.FJ),A.AFrame.jk(a,w.KeyInputManager.hw(Box4Intl.Box4Strings.l_HK_RightJustify_Mac),D.a.rightJustify,R.FJ)):(A.AFrame.jk(a,w.KeyInputManager.hw(Box4Intl.Box4Strings.l_HK_LeftJustify),
D.a.leftJustify,R.FJ),A.AFrame.jk(a,w.KeyInputManager.hw(Box4Intl.Box4Strings.l_HK_RightJustify),D.a.rightJustify,R.FJ));J.a.instance.ga(54)&&A.AFrame.jk(a,w.KeyInputManager.Na(z.a.bvd,w.KeyInputManager.Le),D.a.fullJustify,R.FJ)}LYj(){var a=C.FocusManager.instance();const b=a.Gc(A.AFrame.nj);a=a.Gc(I.AppFrame.xW);A.AFrame.jk(b,w.KeyInputManager.Na(z.a.dMa,w.KeyInputManager.Le),D.a.jP,R.sMf);A.AFrame.jk(b,w.KeyInputManager.Na(z.a.L3e,w.KeyInputManager.Le),D.a.NR,R.sMf);v.a.Rzb&&a.bindAction(w.KeyInputManager.Na(z.a.Huc,
4|w.KeyInputManager.Le),D.a.jP)}f3j(){const a=C.FocusManager.instance().Gc(A.AFrame.nj);A.AFrame.jk(a,w.KeyInputManager.hw(Box4Intl.Box4Strings.l_HK_TellMe),H.a.mrd,R.FJ)}akk(){if(J.a.instance.ga(27)||J.a.instance.ga(58)){const a=C.FocusManager.instance().Gc(A.AFrame.nj),b=J.a.instance.ga(58)?D.a.N0k:D.a.save;A.AFrame.jk(a,w.KeyInputManager.hw(Box4Intl.Box4Strings.l_HK_Save),b);A.AFrame.jk(a,w.KeyInputManager.Na(z.a.$4e,0),D.a.sync)}}lGk(){const a=C.FocusManager.instance().Gc(I.AppFrame.xW);u.AFrameworkApplication.fa.ka("WordEditorIdeasIsEnabled")&&
u.AFrameworkApplication.fa.ka("WordEditorIdeasCardsIsEnabled")||A.AFrame.jk(a,w.KeyInputManager.Na(z.a.Fuc,1),D.a.Ccd);A.AFrame.jk(a,w.KeyInputManager.Na(z.a.Fuc,0),D.a.Ccd)}A2k(){this.Xnh(I.AppFrame.xW);this.Xnh(I.AppFrame.BNe)}Xnh(a){var b=C.FocusManager.instance(),c=z.a.Naa,h=z.a.zga;a=b.Gc(a);const m=b.Gc(u.AFrameworkApplication.bhb);a.bindAction(w.KeyInputManager.Na(c,0),D.a.leftArrow);a.bindAction(w.KeyInputManager.Na(h,0),D.a.rightArrow);a.bindAction(w.KeyInputManager.Na(z.a.aZ,0),D.a.upArrow);
a.bindAction(w.KeyInputManager.Na(z.a.x6,0),D.a.downArrow);a.bindAction(w.KeyInputManager.Na(h,4),D.a.Y_a);a.bindAction(w.KeyInputManager.Na(c,4),D.a.X_a);v.a.uk?(a.bindAction(w.KeyInputManager.Na(h,1),D.a.ACa),a.bindAction(w.KeyInputManager.Na(c,1),D.a.zCa),a.bindAction(w.KeyInputManager.Na(h,5),D.a.IQa),a.bindAction(w.KeyInputManager.Na(c,5),D.a.HQa),a.bindAction(w.KeyInputManager.Na(h,8),D.a.lYa),a.bindAction(w.KeyInputManager.Na(c,8),D.a.mYa),a.bindAction(w.KeyInputManager.Na(h,12),D.a.ERa),a.bindAction(w.KeyInputManager.Na(c,
12),D.a.FRa)):(a.bindAction(w.KeyInputManager.Na(h,w.KeyInputManager.Le),D.a.ACa),a.bindAction(w.KeyInputManager.Na(c,w.KeyInputManager.Le),D.a.zCa),a.bindAction(w.KeyInputManager.Na(h,w.KeyInputManager.Le|4),D.a.IQa),a.bindAction(w.KeyInputManager.Na(c,w.KeyInputManager.Le|4),D.a.HQa));a.bindAction(w.KeyInputManager.Na(z.a.aZ,4),D.a.KLb);a.bindAction(w.KeyInputManager.Na(z.a.x6,4),D.a.Ljb);a.bindAction(w.KeyInputManager.Na(z.a.aZ,w.KeyInputManager.Le),D.a.a1b);a.bindAction(w.KeyInputManager.Na(z.a.x6,
w.KeyInputManager.Le),D.a.Dtb);a.bindAction(w.KeyInputManager.Na(z.a.aZ,w.KeyInputManager.Le|4),D.a.j7a);a.bindAction(w.KeyInputManager.Na(z.a.x6,w.KeyInputManager.Le|4),D.a.GQa);a.bindAction(w.KeyInputManager.Na(z.a.YE,0),D.a.mYa);a.bindAction(w.KeyInputManager.Na(z.a.YE,4),D.a.FRa);if(J.a.instance.ga(41))a.bindAction(w.KeyInputManager.Na(z.a.YE,w.KeyInputManager.Le),D.a.ccd),a.bindAction(w.KeyInputManager.Na(z.a.Nw,w.KeyInputManager.Le),D.a.bDe);else if(J.a.instance.ga(17)||J.a.instance.ga(77))a.bindAction(w.KeyInputManager.Na(z.a.YE,
w.KeyInputManager.Le),D.a.Ofb),a.bindAction(w.KeyInputManager.Na(z.a.Nw,w.KeyInputManager.Le),D.a.Nfb);a.bindAction(w.KeyInputManager.Na(z.a.YE,w.KeyInputManager.Le|4),D.a.d8a);a.bindAction(w.KeyInputManager.Na(z.a.Nw,0),D.a.lYa);a.bindAction(w.KeyInputManager.Na(z.a.Nw,4),D.a.ERa);a.bindAction(w.KeyInputManager.Na(z.a.Nw,w.KeyInputManager.Le|4),D.a.c8a);v.a.uk&&(a.bindAction(w.KeyInputManager.Na(z.a.aZ,2),D.a.mYa),a.bindAction(w.KeyInputManager.Na(z.a.aZ,6),D.a.FRa),a.bindAction(w.KeyInputManager.Na(z.a.x6,
2),D.a.lYa),a.bindAction(w.KeyInputManager.Na(z.a.x6,6),D.a.ERa),a.bindAction(w.KeyInputManager.Na(z.a.YE,1),D.a.Ofb),a.bindAction(w.KeyInputManager.Na(z.a.Nw,1),D.a.Nfb),J.a.instance.ga(6)&&(a.bindAction(w.KeyInputManager.Na(z.a.aZ,5),D.a.j7a),a.bindAction(w.KeyInputManager.Na(z.a.x6,5),D.a.GQa)));c=w.KeyInputManager.hw(Box4Intl.Box4Strings.l_HK_SelectAll);a.bindAction(c,D.a.Bsa);m.bindAction(c,H.a.bRa);J.a.instance.ga(79)&&(h=b.Gc(A.AFrame.GD),b=b.Gc(A.AFrame.nj),h.bindAction(c,H.a.SBa),b.bindAction(w.KeyInputManager.Na(z.a.mMa,
w.KeyInputManager.Le|4),D.a.emd),J.a.instance.ga(41)&&v.a.uk&&(a.bindAction(w.KeyInputManager.Na(z.a.JB,1),D.a.Ofb),a.bindAction(w.KeyInputManager.Na(z.a.IB,1),D.a.Nfb)),b.bindAction(w.KeyInputManager.Na(z.a.IB,0),D.a.pageDown),b.bindAction(w.KeyInputManager.Na(z.a.JB,0),D.a.pageUp),b.bindAction(w.KeyInputManager.Na(z.a.IB,4),D.a.dqc),b.bindAction(w.KeyInputManager.Na(z.a.JB,4),D.a.Kod));J.a.instance.ga(6)&&(a.bindAction(w.KeyInputManager.Na(z.a.IB,w.KeyInputManager.Le|4),H.a.bRa),a.bindAction(w.KeyInputManager.Na(z.a.JB,
w.KeyInputManager.Le|4),H.a.bRa));v.a.Uj||a.bindAction(w.KeyInputManager.Na(z.a.cMa,0),D.a.saa);a.bindAction(w.KeyInputManager.Na(z.a.jpa,4),D.a.Jod);a.bindAction(w.KeyInputManager.Na(z.a.jpa,4|w.KeyInputManager.Le),D.a.Jod)}MMb(){const a=C.FocusManager.instance().Gc(I.AppFrame.xW);A.AFrame.jk(a,w.KeyInputManager.Na(z.a.Zud,w.KeyInputManager.Le|1),D.a.LPd);A.AFrame.jk(a,w.KeyInputManager.Na(z.a.$ud,w.KeyInputManager.Le|1),D.a.MPd);A.AFrame.jk(a,w.KeyInputManager.Na(z.a.U4e,w.KeyInputManager.Le|1),
D.a.NPd);A.AFrame.jk(a,w.KeyInputManager.Na(z.a.V4e,w.KeyInputManager.Le|1),D.a.OPd);A.AFrame.jk(a,w.KeyInputManager.Na(z.a.W4e,w.KeyInputManager.Le|1),D.a.PPd);A.AFrame.jk(a,w.KeyInputManager.Na(z.a.X4e,w.KeyInputManager.Le|1),D.a.QPd);A.AFrame.jk(a,w.KeyInputManager.Na(z.a.Aza,w.KeyInputManager.Le|4),D.a.KPd);J.a.instance.ga(61)&&C.FocusManager.instance().Gc(A.AFrame.nj).bindAction(w.KeyInputManager.Na(z.a.evd,w.KeyInputManager.Le|4),D.a.aei)}mnl(){const a=C.FocusManager.instance().Gc(I.AppFrame.xW);
a.bindAction(w.KeyInputManager.Na(z.a.Pq,0),D.a.tab);a.bindAction(w.KeyInputManager.Na(z.a.Pq,4),D.a.eqc)}gol(){if(J.a.instance.ga(30)){const a=C.FocusManager.instance().Gc(I.AppFrame.xW);A.AFrame.jk(a,w.KeyInputManager.Na(z.a.tq,w.KeyInputManager.Le),D.a.Pta)}}kpl(){const a=C.FocusManager.instance(),b=a.Gc(I.AppFrame.xW);a.Gc(A.AFrame.GD);A.AFrame.jk(b,w.KeyInputManager.hw(Box4Intl.Box4Strings.l_HK_Bold),D.a.bold,R.FJ);A.AFrame.jk(b,w.KeyInputManager.hw(Box4Intl.Box4Strings.l_HK_Italic),D.a.setItalic,
R.FJ);A.AFrame.jk(b,w.KeyInputManager.hw(Box4Intl.Box4Strings.l_HK_Underline),D.a.underline,R.FJ);v.a.uk&&(A.AFrame.jk(b,w.KeyInputManager.hw(Box4Intl.Box4Strings.l_HK_Bold_Mac),D.a.bold,R.FJ),A.AFrame.jk(b,w.KeyInputManager.hw(Box4Intl.Box4Strings.l_HK_Italic_Mac),D.a.setItalic,R.FJ),A.AFrame.jk(b,w.KeyInputManager.hw(Box4Intl.Box4Strings.l_HK_Underline_Mac),D.a.underline,R.FJ));A.AFrame.jk(b,w.KeyInputManager.hw(Box4Intl.Box4Strings.l_HK_ClearFormatting),D.a.clearFormatting);J.a.instance.ga(54)&&
A.AFrame.jk(b,w.KeyInputManager.Na(z.a.Wlb,w.KeyInputManager.Le|4),D.a.clearFormatting);A.AFrame.jk(b,w.KeyInputManager.Na(z.a.Ulb,w.KeyInputManager.Le|1),D.a.Q5,R.Dib("00FFFF"));if(J.a.instance.ga(94)||J.a.instance.ga(96))A.AFrame.jk(b,w.KeyInputManager.Na(z.a.dMa,w.KeyInputManager.Le|4),D.a.DI,R.FJ),A.AFrame.jk(b,w.KeyInputManager.Na(z.a.$tc,w.KeyInputManager.Le),D.a.DI,R.FJ),A.AFrame.jk(b,w.KeyInputManager.Na(z.a.bud,w.KeyInputManager.Le|4),D.a.UJ,R.FJ),A.AFrame.jk(b,w.KeyInputManager.Na(z.a.Ytc,
w.KeyInputManager.Le),D.a.UJ,R.FJ);u.AFrameworkApplication.fa.ka("PPTOToggleCaseByShiftF3Enabled")&&A.AFrame.jk(b,w.KeyInputManager.hw(Box4Intl.Box4Strings.l_HK_ToggleCase),D.a.Vrd);u.AFrameworkApplication.fa.ka("SubSuperscriptShortcutEnabled")&&(A.AFrame.jk(b,w.KeyInputManager.Na(z.a.dud,w.KeyInputManager.Le|4),D.a.superscript,R.FJ),A.AFrame.jk(b,w.KeyInputManager.Na(z.a.gud,w.KeyInputManager.Le|4),D.a.superscript,R.FJ),A.AFrame.jk(b,w.KeyInputManager.Na(z.a.eud,w.KeyInputManager.Le|4),D.a.subscript,
R.FJ),A.AFrame.jk(b,w.KeyInputManager.Na(z.a.Ztc,w.KeyInputManager.Le|4),D.a.subscript,R.FJ))}Svl(){const a=C.FocusManager.instance().Gc(A.AFrame.GD),b=C.FocusManager.instance().Gc(I.AppFrame.xW);var c=w.KeyInputManager.hw(Box4Intl.Box4Strings.l_HK_Undo);a.bindAction(c,H.a.SBa);b.bindAction(c,D.a.undo);c=w.KeyInputManager.Na(z.a.MH,1);a.bindAction(c,H.a.SBa);v.a.uk||b.bindAction(c,D.a.undo);c=w.KeyInputManager.hw(Box4Intl.Box4Strings.l_HK_Redo);a.bindAction(c,H.a.SBa);b.bindAction(c,D.a.redo);c=w.KeyInputManager.Na(z.a.MH,
5);a.bindAction(c,H.a.SBa);v.a.uk||b.bindAction(c,D.a.redo)}Jjl(){const a=C.FocusManager.instance().Gc(I.AppFrame.xW);J.a.instance.ga(54)?(v.a.uk?this.Ara(a,w.KeyInputManager.Na(z.a.$ud,5),"\u20ac"):this.Ara(a,w.KeyInputManager.Na(z.a.Slb,w.KeyInputManager.Le|1),"\u20ac"),this.Ara(a,w.KeyInputManager.Na(z.a.yza,w.KeyInputManager.Le|1),"\u00a9"),this.Ara(a,w.KeyInputManager.Na(z.a.jPb,w.KeyInputManager.Le|1),"\u00ae"),this.Ara(a,w.KeyInputManager.Na(z.a.kPb,w.KeyInputManager.Le|1),"\u2122"),this.Ara(a,
w.KeyInputManager.Na(z.a.Ztc,w.KeyInputManager.Le|1),"\u2014"),this.Ara(a,w.KeyInputManager.Na(z.a.dMa,w.KeyInputManager.Le|1),"\u2026"),this.Ara(a,w.KeyInputManager.Na(z.a.L3e,w.KeyInputManager.Le|5),"\u00bf"),this.Ara(a,w.KeyInputManager.Na(z.a.Zud,w.KeyInputManager.Le|5),"\u00a1")):J.a.instance.ga(25)&&this.Ara(a,w.KeyInputManager.Na(z.a.Slb,w.KeyInputManager.Le|1),"\u20ac")}Ara(a,b,c){A.AFrame.jk(a,b,D.a.STa,R.mFj("symbol_"+c))}UHi(){if(u.AFrameworkApplication.OE){var a=C.FocusManager.instance().Gc(A.AFrame.nj);
A.AFrame.jk(a,w.KeyInputManager.Na(z.a.Y4e,w.KeyInputManager.Le|1),H.a.giveFeedback);A.AFrame.jk(a,w.KeyInputManager.Na(z.a.Z4e,w.KeyInputManager.Le|1),H.a.giveFeedback)}}FZk(){const a=C.FocusManager.instance().Gc(A.AFrame.nj);v.a.hx||A.AFrame.jk(a,w.KeyInputManager.Na(z.a.Ulb,1),D.a.activateRibbonTab,R.Dib("tabHome"));A.AFrame.jk(a,w.KeyInputManager.Na(z.a.Aza,1),D.a.activateRibbonTab,R.Dib("tabInsert"));A.AFrame.jk(a,w.KeyInputManager.Na(z.a.Vlb,1),D.a.activateRibbonTab,R.Dib("tabPageLayout"));
A.AFrame.jk(a,w.KeyInputManager.Na(z.a.jPb,1),D.a.activateRibbonTab,R.Dib("tabReview"));A.AFrame.jk(a,w.KeyInputManager.Na(z.a.b5e,1),D.a.activateRibbonTab,R.Dib("tabView"))}static get instance(){return R.Ka||(R.Ka=new R)}static sMf(){return new E.DictionaryPropertySet}static FJ(){return new T(2)}static mFj(a){return()=>{const b={};b.SourceControlId=a;return b}}static Dib(a){return()=>a}}R.Ka=null;Object(n.a)(R,"ShortcutRegistration",null,[]);class Q{get name(){return"Box4.Shortcuts"}$b(){}init(){R.instance.iOe()}dispose(){}static main(){r.a.instance.Dc(new Q)}}
Object(n.a)(Q,"Box4ShortcutsPackage",null,[2,3]);var W=d(304);class O{Kt(a,b,c=!1,h=!1,m=!1,y=null){return W.a.Kt(a,b,c,h,m,y)}Otc(a,b,c){return W.a.Otc(a,b,c)}Prb(a,b){return W.a.Prb(a,b)}QZ(a,b,c,h,m=!1,y=!1){return W.a.QZ(a,b,c,h,m,y)}QPa(a,b=null){return W.a.QPa(a,b)}rda(){W.a.rda()}e7a(a,b,c,h=null){return W.a.e7a(a,b,c,h)}dEa(a,b,c=!1,h=!0){return W.a.dEa(a,b,c,h)}$9b(a,b){return W.a.$9b(a,b)}}Object(n.a)(O,"TextMetricsAdapterProxy",null,[1471]);var Y=d(311),S=d(149);class da{Ikj(a){var b=a;
for(a=null;!a&&b&&"P"!==b.tagName;)a=Y.a.ye(b,S.a.nNb),b=b.parentNode;b=-1;a&&(b=parseInt(a.toString(),10));return b}}Object(n.a)(da,"TextMetricsHelper",null,[512]);class fa{constructor(){this.Da=null}get name(){return"Box4.TextMetrics"}init(){this.Da.resolve("Box4.ITextMetricsAdapter")}dispose(){}$b(a){this.Da=a;this.Da.register(1471,"Box4.ITextMetricsAdapter").ma().oa(()=>new O);this.Da.register(512,"Box4.TextMetricsApi.ITextMetricsHelper").ma().oa(()=>new da)}static main(){r.a.instance.Dc(new fa)}}
Object(n.a)(fa,"Box4TextMetricsPackage",null,[2,3]);var ka=d(335),ha=d(249),F=d(13),na=d(97),ba=d(382),Ea=d(712),La=d(95),ta=d(45),oa=d(1205),wa=d(1201),ra=d(65),ya=d(558),Da=d(103),pa=d(347),la=d(788),Fa=d(268),Qa=d(17),Sa=d(6);class Na{static s6k(a){const b=new Ea.a;for(let c of a)b.add(c);return b}static Ogh(a,b){const c=new Qa.a;b=Na.s6k(b);for(let h of a)b.contains(h)||c.add(h);return c}static JRk(a,b){return Na.Ogh(Sa.asEnumerable(a),b).toArray()}static KRk(a,b){return Na.Ogh(a,b)}}Object(n.a)(Na,
"ExtendedGuidUtils",null,[]);var ua=d(1186),za=d(22),Wa=d(163);class yb{}yb.Moi="ChangeInfo";Object(n.a)(yb,"CatchUpActivityConstants",null,[]);class Za{}Za.VGb="\u00a0";Za.Qxf="\ue200";Za.nbg="\ue201";Za.EOi=32767;Za.KMc=3;Za.zZd=1;Object(n.a)(Za,"ContentEditableViewConstants",null,[]);var ub=d(540),Ib=d(121),Ob=d(31),Hc=d(362),kb=d(38),jb=d(40),hb=d(88),uc=d(90),mc=d(52),Ya=d(86);class Mb{constructor(a,b,c){this.Qa=b;this.Nb=c}}Object(n.a)(Mb,"ChangeInfo",null,[]);d(603);var Kc=d(807);class eb{}
Object(n.a)(eb,"InternalLinkConstants",null,[]);class Tb extends Sys.EventArgs{constructor(){super();this.N7a=null}}Object(n.a)(Tb,"EditEventArgs",Sys.EventArgs,[]);class lb extends Tb{constructor(){super();this.VXj=0;this.wrl=this.xNc=this.A_e=this.wYj=this.xAj=this.Ndg=this.PVf=this.xVi=this.PRi=!1}}Object(n.a)(lb,"ParagraphContentUpdatedEventArgs",Tb,[]);class Fb{constructor(a){this.r0c=a}}Object(n.a)(Fb,"BlobPresenterArgs",null,[]);var rb=d(30);class Qb{}Qb.G3="TrackedChange";Qb.$zh="TrackChangeTableRowInsertion";
Qb.Xzh="TrackChangeTableRowDeletion";Qb.JAh="TrackChangeTextInsertion";Qb.HAh="TrackChangeTextDeletion";Qb.Yzj="TrackChangeImageModified";Qb.Wzj="TrackChangeImageInsertion";Qb.Szj="TrackChangeImageDeletion";Qb.rme="TrackChangeIndirectEffect";Object(n.a)(Qb,"TrackChangeConstants",null,[]);var Bc=d(901),wb=d(96);const Ad=a=>!!a.MQa&&Sa.AT(a.MQa,b=>3===b.type||2===b.type||4===b.type),bc=(a,b)=>{let c=!1,h=!1,m=null;if(b.MQa)for(let y of b.MQa)1===y.type&&(c=!0),3===y.type&&(h=!0),4===y.type&&y.Ee&&y.Ee.paragraph&&
(m=y);m&&Sys.UI.DomElement.addCssClass(a,wb.a.nHi);h&&Sys.UI.DomElement.addCssClass(a,wb.a.cag);c&&Sys.UI.DomElement.addCssClass(a,wb.a.hHi)},Sb=a=>{const b=[wb.a.ONi,wb.a.PNi,wb.a.NNi];for(const c of b)Sys.UI.DomElement.removeCssClass(a,c)};var Zb=d(356);class cb{constructor(a){this.qRb=this.mWb=this.c8e=null;this.Ii=a}get paragraphNode(){return this.Ii}get MQa(){return this.c8e}get mkb(){return this.mWb}get T7a(){return this.qRb}get isEmpty(){return(!this.MQa||!this.MQa.count)&&(!this.mkb||!this.mkb.count)&&
(!this.T7a||!this.T7a.count)}Fqk(){this.mkb&&(this.mWb=new Qa.a);this.T7a&&(this.qRb=new Qa.a)}Qtd(a){this.MQa||(this.c8e=new Zb.a);this.mkb||(this.mWb=new Qa.a);this.T7a||(this.qRb=new Qa.a);this.MQa.Qtd(a,b=>{this.mkb.add(b)},b=>{this.T7a.add(b)})}}Object(n.a)(cb,"IntentRenderingState",null,[]);class Xa{constructor(a,b){this.element=a;this.next=b}}Object(n.a)(Xa,"ElementStackNode",null,[]);class Lb{constructor(a=!1){this._history=new Sys.StringBuilder;this.eAa=this.ev=null;this.MWb=a}A0j(a){if(this.MWb&&
a){this._history.append("[Cp "+a.cp+":");if(a.Wh)for(var b=0;b<a.Wh.length;b++)this._history.append(a.Wh.ga(b).py+","+a.Wh.ga(b).Yea),b!==a.Wh.length-1&&this._history.append("|");if(a.kk)for(a.Wh&&this._history.append("|"),b=0;b<a.kk.length;b++)this._history.append(a.kk.ga(b).Vta?"B":"I"),this._history.append(a.kk.ga(b).vk?"S":"E"),this._history.append(a.kk.ga(b).lzb?"R":"F"),b!==a.kk.length-1&&this._history.append("|");this._history.append("]\n")}}clear(){if(this.ev){for(var a=this.ev;a.next;)a=
a.next;a.next=this.eAa;this.eAa=this.ev;this.ev=null;this.MWb&&this._history.append("Clear\n")}}peek(a=""){this.isEmpty()&&ba.ULS.sendTraceTag(50604245,324,15,"_top is null when calling Peek with Label: {0}. History: {1}",a,this._history.toString());this.MWb&&this._history.append(String.format("Peek Label: {0}\n",a));return this.ev.element}pop(a=""){this.isEmpty()&&ba.ULS.sendTraceTag(50604246,324,15,"_top is null when calling Pop with label {0}. History: {1}",a,this._history.toString());const b=
this.ev.element;this.ev.element=null;const c=this.ev.next;this.ev.next=this.eAa;this.eAa=this.ev;this.ev=c;this.MWb&&this._history.append(String.format("Pop {0} Label:{1}\n",b?b.className:"Null Element",a));return b}push(a,b=""){if(this.eAa){const c=this.eAa.next;this.eAa.next=this.ev;this.ev=this.eAa;this.eAa=c;this.ev.element=a}else this.ev=new Xa(a,this.ev);this.MWb&&this._history.append(String.format("Push {0} Label:{1}\n",a?a.className:"Null Element",b))}isEmpty(){return!this.ev}}Object(n.a)(Lb,
"ElementStack",null,[]);class pc{constructor(){this.R9b=!1;this.span=null}}Object(n.a)(pc,"IntelligentPlaceholderRenderingState",null,[]);class fc{constructor(a,b,c){this.eventName=a;this.Cc=b;this.handler=c}}Object(n.a)(fc,"ParagraphContentRendererMouseEventRegistration",null,[]);var bd=d(76);class od extends Sys.EventArgs{constructor(a,b,c){super();this.element=a;this.paragraphNode=b;this.oJb=c}}Object(n.a)(od,"ParagraphContentRendererEventArgs",Sys.EventArgs,[]);class ye extends od{constructor(a,
b,c,h,m){super(a,b,c);this.mWb=h.mkb;this.qRb=h.T7a;this.TPh=m}get mkb(){return this.mWb}get T7a(){return this.qRb}get elementType(){return this.TPh}}Object(n.a)(ye,"IntentRangeRenderedEventArgs",od,[]);class pd extends od{constructor(a,b,c,h){super(a,b,c);this.Up=h}}Object(n.a)(pd,"SpellingErrorRenderedEventArgs",od,[]);class ab{constructor(){this.Oa=new bd.a}dispose(){this.Oa&&(this.Oa.dispose(),this.Oa=null)}OKk(a,b,c,h){this.Oa&&this.Oa.raiseEvent(ab.ztk,new pd(a,b,c,h))}Cdh(a,b,c,h,m){this.Oa&&
this.Oa.raiseEvent(ab.Epk,new ye(a,b,c,h,m))}}ab.ztk="OnSpellingErrorRangeRendered";ab.Epk="OnIntentRangeRendered";Object(n.a)(ab,"ParagraphRenderEvents",null,[106]);class Yb{constructor(){this.FCf=null;this.s$f=!1;this.cZg=this.vpf=null}}Object(n.a)(Yb,"RenderParagraphContentResults",null,[]);var Sc=d(156),Jb=d(67);class Oc{constructor(a,b,c,h,m,y,G,U,ja,va,Ta,fb,Db,gc,hc,Gc){this.lAa=this.rDd=this.tCd=this.apb=null;this.Lf=a;this.AP=b;this.fd=c;this.Qpa=h;this.$M=m;this.Wv=G;this.n4a=U;this.LNa=
ja;this.GOh=Ta;this.FV=fb;this.pYh=Db;this.hRh=gc;this.lNh=Gc;this.iof=new Ea.a;this.CDc=hc;this.hob=!!va&&va.WEa(65);this.NDc=this.Qxc=null;this.uNa=y;this.wTh=!!u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.ka("MinimizeIntelligentPlaceholderWorkIsEnabled");this.hd=va}get cAf(){return!0}get jhg(){null==this.tCd&&(this.tCd=!!this.hd&&this.hd.isFeatureEnabled(85));return this.tCd}get ylg(){null==this.rDd&&(this.rDd=!!this.hd&&this.hd.isFeatureEnabled(77));return this.rDd}get RN(){null==this.lAa&&
(this.lAa=!!this.hd&&this.hd.isFeatureEnabled(79));return this.lAa}KVk(a,b,c,h,m,y,G,U,ja,va,Ta,fb,Db,gc,hc,Gc,Pc,yc,Vd){this.Qxc={};this.NDc=new Sc.a;const De=Ob.ParagraphReader.text(a),Wd=new Qa.a;var Ve=!1;u.AFrameworkApplication.fa&&(Ve=u.AFrameworkApplication.fa.ka("ElementStackTrackHistoryIsEnabled"));const $e=new Lb(Ve);$e.push(c,"RenderParagraphContentStart");let Qf=null,lg=null,Hg=null,Qg=null,Sf=Ve=null;const sh=new lb;var Xg=!1;let ni=!1,Ri=!1,uj=!1,dj=0,ej=null,Ei=null;const Dk=new Qa.a;
this.CDc&&this.CDc.GHl(a,c);const vj=this.LNa.JW(a);this.LNa.Fdi(c,a,b,vj,b.Ld);if(this.n4a.ix&&b.Vl){var tk=this.Lf.Rd;tk&&1===tk.editingView.mode&&(c.style.fontFamily="",c.style.fontSize="")}tk=!a.QW;let Fl=!1,rl=!1,Gl=!1,Vj=!1,Ek=0,Wj=!1,fk=!1,Fj=null,sl=0;const dh=new pc,Rl=Array(a.Ra.length+1);let lm=this.jhg?new Qa.a:null,Fk=null,Sl=null;for(;dj<a.Ra.length;){const le=a.Ra.ga(dj);var Xi=void 0,xi=void 0,mg=!1;$e.A0j(le);({HJc:Xi,DJc:xi}=Oc.QYf(le));this.jhg&&(!this.wTh||Xi.length||xi.length)&&
({HJc:Xi,DJc:xi,EHi:lm,mNj:mg}=Oc.Ixl(le.paragraph.Fh,Xi,xi,lm),dh.R9b=0<lm.count);Vj=0<Xi.length||Vj;Rl[dj]=c.childNodes.length;if(0<le.cp&&le.Mj)break;let yf=le.cp;const Eg=dj<a.Ra.length-1?a.Ra.ga(dj+1).cp:Ob.ParagraphReader.textLength(a);dj++;var eh=!1;0<yf&&$e.pop("CurrentCpLargerThanZero");le.yL&&(Qf=null);le.mv&&(Sl=le.mv);le.isDictationCorrectionEnd&&(Sl=null);le.DY&&(lg=null);le.O3&&(Hg=null);le.Gka&&(Qg=null);var jh=void 0,xd=void 0;this.RN?(jh=le.Eda,xd=le.x_):(jh=!!le.Io,xd=!!le.fieldRangeEnd);
if(!Xg||le.blob||le.formatting||le.hyperlink||le.en||le.Q3||xd||jh||this.hob&&(le.isTrackChangeInfoEnd||le.$N)||le.jw&&!le.jw.isEmpty)eh=!0,0<yf&&Xg&&$e.pop("InFormattingSpan");xd&&($e.pop("HasFieldEnd"),Xg=!1);le.en&&(Fl||(Ri=!0),rl=Fl=!1);le.hyperlink&&(Fl&&(Ri=!0),Fl=!0,rl=le.hyperlink.Tta);le.en&&!Ri&&($e.pop("IsHyperlinkEnd"),Xg=!1);this.hd&&this.hd.isFeatureEnabled(17)&&(le.isChangeEnd&&(Wj||ba.ULS.sendTraceTag(36282713,324,15,"Found catch up change end with out change start!"),Wj=!1,Ei=null),
le.changeStart&&(Wj&&ba.ULS.sendTraceTag(36282714,324,15,"Found catch up change start with out change end!"),Ei=le,Wj=!le.Mj));if(this.hob&&(le.isTrackChangeInfoEnd&&(Gl||(uj=!0),Gl=!1,ej=null),le.$N&&(Gl&&(uj=!0),ej=le,Gl=!le.Mj),le.isTrackChangeInfoEnd&&!uj)){for(Xg=0;Xg<Ek;Xg++)$e.pop("IsTrackChangeInfoEnd");Ek=0;Xg=!1}Fk&&Fk.Fqk();le.jw&&(Fk||(Fk=new cb(a)),Fk.Qtd(le.jw));if(le.Q3&&!le.Mj){Ve=Ve||le.formatting;xd=this.aIf($e.peek("CreateIpFormattingSpan"),Ve,vj,b,a,Ta,ja,ej);xd=La.a.t9a(xd);for(let Fi of xd)fb=
Oc.iia(m,fb,Fi);sh.Ndg=!0}le.hyperlink&&!Ri&&({GFa:fb,jPi:fk,returnValue:Sf}=this.DVk(Sf,le,$e,vj,sh,b,a,h,m,y,G,ja,ej,fb,Ta,tk,Xg,fk));!this.hob||uj||le.Mj||(le.zp&&(this.JPe(le.zp,$e,sh,b,ja),Ek++),le.Do&&(this.JPe(le.Do,$e,sh,b,ja),Ek++),le.Ns&&(this.JPe(le.Ns,$e,sh,b,ja),Ek++));jh&&({KQa:Ve,GFa:fb,returnValue:Sf}=this.zVk(Sf,m,a,le,Ve,$e,vj,sh,b,ja,Ta,fb,Xg,tk,ej));this.ylg&&this.VBf(a,b,Pc&&Gc);le.blob?({GFa:fb,vYj:Fj,uYj:sl,returnValue:ni}=this.rVk(fb,Xg,Ve,le,y,G,tk,Sf,$e,vj,sh,yf,ni,Gc,b,
Dk,Pc,a,Ta,m,Db,gc,U,ja,Wd,ej,Ei,Xi,xi,Fj,sl,Fk),Xg=!1,Ve=Sf=null):(jh=le.Q3&&!ta.a.substring(De,yf,Eg).length,eh&&(eh=Sf,{KQa:Ve,returnValue:Sf}=this.BVk(Ve,le,vj,$e,sh,b,a,ja,ej,Ta,jh),Xg=!0,Sf&&Sf.style&&(fk&&eh&&eh.style&&(eh.style.fontSize=Sf.style.fontSize,eh.style.lineHeight=Sf.style.lineHeight),Fj&&Fj.style&&0<sl&&le.formatting&&le.formatting.cache.Ata&&sl>le.formatting.cache.fontSize&&(Fj.style.fontSize=Sf.style.fontSize,Fj.style.lineHeight=Sf.style.lineHeight))),fk=!1,Fj=null,sl=0,jh||(le.Up&&
(Qf=le.Up),le.wF&&(Hg=le.wF),le.AL&&(Qg=le.AL),le.Dw&&(lg=le.Dw),eh=ta.a.substring(De,yf,Eg),mg=this.kXd($e.peek("CreateTextOverlaySpan1"),Ve,a,Qf,Hg,Qg,lg,b,Dk,ja,eh,Pc&&(Db<=yf&&yf<gc||a.QW),Vd,dh,mg,Fk,!!Sl,rl),$e.push(mg,"TextOverlaySpan1"),sh.A_e=!0,this.YMd($e.peek("AddCommentHintCssAndDataToElement"),Xi,xi),this.$M&&this.$M.myb&&Qf&&Qf.Gh&&(Xi=Object(ua.a)(287,Qf.Gh))&&Xi.qN&&Xi.qN.TraceId&&5===Xi.proofingType&&!Xi.wEa&&(this.ARk($e.peek("RemoveConsistencyCheckCustomData")),xi=this.M4i(le.Up,
a,dj),Y.a.Lv($e.peek("errorDetails"),xi,Xi.qN.TraceId)),this.eTe(Ei,$e.peek("SetChangeId"),le.cp,Eg),Pc&&Db!==gc&&({GFa:fb,returnValue:yf}=this.KFk(mg,$e,Ve,a,Qf,Hg,Qg,lg,sh,b,m,Dk,ja,De,Db,gc,fb,yf,Eg,Vd,dh,Fk,!!Sl,rl)),La.a.Ix($e.peek("SetElementText"),ta.a.substring(De,yf,Eg)),fb=Oc.iia(m,fb,$e.peek("AddLeafNodeElement"))))}if(a.VUc!==Vj||this.hob||this.n4a.ruc)a.VUc=Vj,(h=mc.OutlineElementNavigator.PA(a))&&h.sda(b.Ma,32,!0);({r0c:Sf,GFa:fb,returnValue:Xg}=this.FVk(a,c,Ve,vj,sh,Sf,b,a,m,ja,ej,
Ta,fb,Xg,tk));!dh.R9b&&dh.span&&this.zPd(null,dh.span);tk&&this.yVk(c,Sf,sh,b,a,m,ja,va,fb,hc,Ei);Rl[Rl.length-1]=c.children.length;this.Dyl(ni,yc,b);this.yzl(sh,Xg,m);this.fqh(b,a,c);let Ne;return Ne=new Yb,Ne.FCf=Wd,Ne.s$f=ni,Ne.vpf=Rl,Ne.cZg=Dk,Ne}oJb(a,b,c,h){this.AP.pb(a,b,c,h);return new fc(a,b,c)}M4i(a,b,c){let h=0;a&&a.Gh&&(h|=16);if(c<b.Ra.length&&b.Ra.ga(c).yL||c===b.Ra.length)h|=1;switch(h){case 0:return Bc.a.NDe;case 16:return Bc.a.H0c;case 1:return Bc.a.rld;case 17:return Bc.a.sHc}return""}ARk(a){Y.a.Rna(a,
Bc.a.NDe);Y.a.Rna(a,Bc.a.H0c);Y.a.Rna(a,Bc.a.rld);Y.a.Rna(a,Bc.a.sHc)}eTe(a,b,c,h){this.hd&&this.hd.isFeatureEnabled(17)&&a&&a.changeStart&&Y.a.Lv(b,yb.Moi,new Mb(a.changeStart.id,c,h))}DVk(a,b,c,h,m,y,G,U,ja,va,Ta,fb,Db,gc,hc,Gc,Pc,yc){!Gc||Pc||b.Q3||(a=this.y0b(c.peek("CreateFormattingSpan1"),null,h,y,G,fb,hc,Db),a.className+=" EmptyTextRun",gc=Oc.iia(ja,gc,a),yc=m.xNc=!0);b=this.lDi(c.peek("CreateLinkAnchor"),b.hyperlink,y,U,va,Ta,fb);c.push(b,"RenderHyperlink");m.wYj=!0;return{returnValue:a,GFa:gc,
jPi:yc}}JPe(a,b,c,h,m){a=this.FGi(b.peek("CreateTrackChangeRange"),a,h,m);b.push(a,"RenderTrackChange");c.wrl=!0}zVk(a,b,c,h,m,y,G,U,ja,va,Ta,fb,Db,gc,hc){Db||h.Q3||(m=h.formatting||m,gc?(a=this.y0b(y.peek("CreateFormattingSpan2"),m,G,ja,c,va,Ta,hc),a.appendChild(ja.ownerDocument.createTextNode("")),a.className+=" EmptyTextRun",fb=Oc.iia(b,fb,a),U.xNc=!0):(a=this.lLc(m,G,ja,c,Ta,hc),U.PVf=!0));b=this.lCi(y.peek("CreateFieldRangeSpan1"),ja,va,c);y.push(b,"RenderFieldRange");U.xVi=!0;return{returnValue:a,
KQa:m,GFa:fb}}rVk(a,b,c,h,m,y,G,U,ja,va,Ta,fb,Db,gc,hc,Gc,Pc,yc,Vd,De,Wd,Ve,$e,Qf,lg,Hg,Qg,Sf,sh,Xg,ni,Ri){b||(c=h.formatting||c,G&&!h.Q3?(U=this.y0b(ja.peek("CreateFormattingSpan4"),c,va,hc,yc,Qf,Vd,Hg),U.appendChild(hc.ownerDocument.createTextNode("")),U.className+=" EmptyTextRun",a=Oc.iia(De,a,U),Ta.xNc=!0):U=this.lLc(c,va,hc,yc,Vd,Hg));1===h.blob.Sq&&(Db=!0);b=h.blob.xej(hc);b.FWf(new Fb(U));U=b.element;Sys.UI.DomElement.containsCssClass(U,wb.a.aac)&&(Xg=U,c&&c.cache.Ata&&(ni=c.cache.fontSize));
Sys.UI.DomElement.addCssClass(U,wb.a.hN);this.n4a.VNi&&5!==h.blob.Sq&&Sys.UI.DomElement.addCssClass(U,wb.a.RNi);this.hob&&this.EVk(h,hc,U,Hg);this.YMd(U,Sf,sh);Ri&&!Ri.isEmpty?(bc(U,Ri),this.apb&&this.apb.Cdh(U,yc,(uj,dj,ej,Ei)=>{Gc.add(this.oJb(uj,dj,ej,Ei))},Ri,1)):Sb(U);this.eTe(Qg,U,h.cp,h.cp+1);ja.peek("blobElt").appendChild(U);$e(U,!0);lg.add(h.blob);Pc&&(Wd<=fb&&fb+1<=Ve||yc.QW)?(gc&&(Sys.UI.DomElement.containsCssClass(U,wb.a.CXd)||Sys.UI.DomElement.addCssClass(U,wb.a.CXd),u.AFrameworkApplication.fk("Microsoft.Office.Web.SessionSettings.IWacWordTouchImageGrippiesResizedSettings"),
u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.ka("TouchImageGrippiesResizedIsEnabled")&&this.Lf&&this.Lf.Rd&&Object(za.a)(ub.PageView,this.Lf.Rd)&&(c=this.Lf.Rd,fb=u.AFrameworkApplication.Ta,c&&3===c.umg?fb.La(D.a.PBh,2,U):fb.La(D.a.QBh,2,U))),Sys.UI.DomElement.addCssClass(U,wb.a.R7)):(Sys.UI.DomElement.removeCssClass(U,wb.a.CXd),Sys.UI.DomElement.removeCssClass(U,wb.a.R7));this.ylg||this.VBf(yc,hc,Pc&&gc);Sys.UI.DomElement.removeCssClass(U,wb.a.jHi);this.hd&&this.hd.isFeatureEnabled(162)&&
5===h.blob.Sq&&(h=h.blob,h.properties&&h.properties.Sa(kb.a.C7b)&&(h=h.properties.eb(kb.a.C7b))&&""!==h&&(Gc.add(this.oJb(ra.a.Qma,U,m,h)),Gc.add(this.oJb(ra.a.Qma,U,y,h))));a=Oc.iia(De,a,U);ja.push(U,"RenderBlob");return{returnValue:Db,GFa:a,vYj:Xg,uYj:ni}}YMd(a,b,c){b.length?(Sys.UI.DomElement.addCssClass(a,wb.a.GJc),Y.a.Lv(a,wb.a.IUd,b)):Sys.UI.DomElement.removeCssClass(a,wb.a.GJc);c.length&&Y.a.Lv(a,wb.a.EUd,c)}VBf(a,b,c){a=rb.GraphIterator.nb(a);a.gf();a.Ng(11);if(b=a.currentNode.sc(b.Ma))b.htmlElement.style.zIndex=
c?"1":""}EVk(a,b,c,h){let m=La.a.C3i(c,Oc.RBh);5===a.blob.Sq&&h?(m||(m=b.hp(wa.a.span),m.id=Oc.RBh,Sys.UI.DomElement.addCssClass(m,Qb.Yzj),Sys.UI.DomElement.addCssClass(m,Qb.G3),c.appendChild(m)),this.SWf(b,m,h.zp,Qb.Szj),this.SWf(b,m,h.Do,Qb.Wzj)):m&&c.removeChild(m)}SWf(a,b,c,h){c&&!La.a.x4b(b,h)&&(a=a.hp(wa.a.span),a.className=h,a.style.borderBottom="2px solid #000",b.appendChild(a))}BVk(a,b,c,h,m,y,G,U,ja,va,Ta){a=b.formatting||a;b=Ta?this.lLc(a,c,y,G,va,ja):this.y0b(h.peek("CreateFormattingSpan5"),
a,c,y,G,U,va,ja);h.push(b,"RenderFormattingSpan");m.PVf=!0;return{returnValue:b,KQa:a}}KFk(a,b,c,h,m,y,G,U,ja,va,Ta,fb,Db,gc,hc,Gc,Pc,yc,Vd,De,Wd,Ve,$e,Qf){yc<hc&&hc<Vd&&(yc=ta.a.substring(gc,yc,hc),La.a.Ix(a,yc),Pc=Oc.iia(Ta,Pc,a),b.pop("ProcessSelectionBegins"),a=this.kXd(b.peek("CreateTextOverlaySpan2"),c,h,m,y,G,U,va,fb,Db,yc,!0,De,Wd,!1,Ve,$e,Qf),b.push(a,"TextOverlaySpan2"),yc=hc,ja.A_e=!0);yc<Gc&&Gc<Vd&&(gc=ta.a.substring(gc,yc,Gc),La.a.Ix(a,gc),Pc=Oc.iia(Ta,Pc,a),b.pop("ProcessSelectionEnds"),
a=this.kXd(b.peek("CreateTextOverlaySpan3"),c,h,m,y,G,U,va,fb,Db,gc,!1,De,Wd,!1,Ve,$e,Qf),b.push(a,"TextOverlaySpan3"),yc=Gc,ja.A_e=!0);return{returnValue:yc,GFa:Pc}}FVk(a,b,c,h,m,y,G,U,ja,va,Ta,fb,Db,gc,hc){if(0<a.Ra.length){const Gc=a.Ra.last;let Pc;Pc=!!u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.ka("TextRunForHyperlinkInTableCellEnabled");a=rb.GraphIterator.nb(a);!Gc.en||Pc&&a.rc(16)||(gc=!1,c=null);if(this.RN?Gc.x_:Gc.fieldRangeEnd)gc=!1,c=null;if(Gc.Q3){c||(c=Gc.formatting);y=this.aIf(b,
c,h,G,U,fb,va,Ta);b=La.a.t9a(y);for(let yc of b)Db=Oc.iia(ja,Db,yc);m.Ndg=!0}else!gc&&hc&&(c||(c=Gc.formatting),y=this.y0b(b,c,h,G,U,va,fb,Ta),y.appendChild(G.ownerDocument.createTextNode("")),y.className+=" EmptyTextRun",Db=Oc.iia(ja,Db,y),m.xNc=!0)}else ba.ULS.sendTraceTag(18482315,324,15,"CharacterProperties has no elements");return{returnValue:gc,r0c:y,GFa:Db}}yVk(a,b,c,h,m,y,G,U,ja,va,Ta){var fb=Oc.V2i(a,va);b=this.KHf(b,h,U,fb);ya.a.instance.shipAssertTag(25519712,8,0<m.Ra.length,"Chps should never be empty");
U=null;m.Ra&&0<m.Ra.length&&(U=m.Ra.last);this.hob&&U&&(U.zp||U.Do||U.Ns)&&(b.className+=" "+Qb.G3);let Db;({HJc:fb,DJc:Db}=Oc.QYf(U));this.YMd(b,fb,Db);this.eTe(Ta,b,U?U.cp:0,-1);va&&(b.className+=" "+Hc.a.sYd);this.fqh(h,m,b);a.appendChild(b);G(b);Oc.iia(y,ja,b);c.PRi=!0}fqh(a,b,c){if(a.Vl&&this.Qpa.jgd&&this.Qpa.Cdl(c)){if((a=this.Qpa.nta(b))&&0<Da.a.count(a))try{c.setAttribute("data-ccp-props",JSON.stringify(a))}catch(h){ba.ULS.sendTraceTag(23639749,307,15,"SetParagraphPropertiesOnHtmlElement for CCP - Cannot serialize object contains circular reference.")}(b=
this.Qpa.Mkj(b))&&0<b.length&&c.setAttribute("data-indent",b)}}FGi(a,b,c,h){c=c.hp(wa.a.span);switch(b.changeType){case 2:c.className=Qb.HAh+" "+Qb.G3;c.style.color="#000";break;case 1:c.className=Qb.JAh+" "+Qb.G3;c.style.color="#000";break;case 3:c.className=Qb.G3}a.appendChild(c);h(c);return c}Dyl(a,b,c){a&&!b?c.notify(1):!a&&b&&c.notify(2)}yzl(a,b,c){a.VXj=c.count;a.xAj=b;this.pYh(a)}lDi(a,b,c,h,m,y,G){c=c.hp(wa.a.a);c.className=wb.a.zag;b.Tta&&b.lqc&&!J.a.instance.ga(61)&&(b.url.endsWith(u.AFrameworkApplication.fa.Ha("UserPrincipalName"))?
c.className+=" "+wb.a.pHi:c.className+=" "+wb.a.qHi);this.Wv.juh()&&(c.style["pointer-events"]="all");this.Wv.Gth(this.n4a.PBl,!0)&&this.hSk(c);this.AP.pb(ra.a.Qma,c,m,b.url);this.AP.pb(ra.a.Rma,c,y);h.add(c);b.url&&ta.a.V8(b.url)&&!v.a.Ni&&(Wa.d(c,oa.a.href,b.url),Wa.d(c,oa.a.target,"_blank"),Wa.d(c,oa.a.rel,"noreferrer"));a.appendChild(c);G(c);return c}hSk(a){a.style.textDecoration="none";a.style.color="inherit"}y0b(a,b,c,h,m,y,G,U){b=this.lLc(b,c,h,m,G,U);a.appendChild(b);y(b);return b}lLc(a,b,
c,h,m,y){if(this.cAf){var G=a?a.nm.toString():pa.a.nil.toString();if(G in this.Qxc)a=this.Qxc[G];else{let U=a?a.cache:Kc.FormattingCacheManager.r4b(h,pa.a.nil);a=this.gWd(a,U,b,c,h,m);this.Qxc[G]=a}b=a.cloneNode();Y.a.oKc(a,b)}else G=a?a.cache:Kc.FormattingCacheManager.r4b(h,pa.a.nil),b=this.gWd(a,G,b,c,h,m);this.Kvf(b,y);return b}gWd(a,b,c,h,m,y){const G=h.hp(wa.a.span);b=this.Wv.wZf(h,b,m)||b;this.qdi(h,G,b,m);this.udi(G,b,m,h,y);this.Ddi(G,a);this.LNa.Gdi(G,m,c,h.Ld,b.fontSize,b.zN);return G}qdi(a,
b,c,h){a=this.Wv.vZf(a,h,c);for(let m of a.keys)b.setAttribute(m,a.ga(m))}aIf(a,b,c,h,m,y,G,U){var ja=b?b.cache:Kc.FormattingCacheManager.r4b(m,pa.a.nil);ja=this.lNh(ja,m);b=this.gWd(b,ja,c,h,m,y);this.Kvf(b,U);ja.isSuperscript||ja.LF?(h=h.hp(wa.a.span),this.Gvf(h,ja,!0),b.appendChild(h),La.a.Ix(h,""),G(h)):La.a.Ix(b,"");a.appendChild(b);G(b);return b}udi(a,b,c,h,m){var y=b.Zs;const G=[];Array.add(G,wb.a.yLa);var U=this.Wv.Q5d(c,b,this.n4a.QBl,y);var ja=null;b.p$a&&(ja=b.FR,ja=ja===hb.a.auto?"transparent":
hb.a.oI(ja));b.wTa&&(ja=b.highlight,ja=ja===hb.a.auto?"transparent":hb.a.oI(ja));c.D_g!==hb.a.nil&&(U=hb.a.oI(c.D_g));m!==hb.a.nil&&(ja=hb.a.oI(m));La.a.aCa(a);b.Y9f&&(a.style.opacity=b.qVf.toString());b.Z$a&&(a.title=Box4Intl.Box4Strings.l_DeadWordLink);U?(a.style.color=U,Wa.d(a,oa.a.eKf,"WindowText"===U?"auto":"none")):Wa.d(a,oa.a.eKf,"auto");ja?(a.style.backgroundColor=ja,"transparent"!==ja&&Array.add(G,"Highlight")):Sys.UI.DomElement.removeCssClass(a,"Highlight");m=b.fontSize;if(b.isSuperscript||
b.LF)m=Math.floor(m*this.Wv.h9d());U=this.Wv.O_f(m,c,h.Ld);ja=this.Wv.O4b(b);m=this.FV&&this.FV.bZi?this.FV.t4h(b.zN):this.GOh(ja);this.n4a.nie&&m&&ka.FontUtils.szb(ja)&&(m=this.Wv.Mvf(ja,m));let va=b.qTa&&b.isBold;void 0===va&&(va=!1);let Ta=b.m$a&&b.isItalic;void 0===Ta&&(Ta=!1);m=this.Wv.dch(new la.a(ja,va,Ta),m,c);!this.dvl(ja,b,a.style)&&b.qTa&&(b.isBold?(a.style.fontWeight="bold",v.a.uk&&v.a.Uj&&Array.add(G,"MacChromeBold")):a.style.fontWeight="normal");b.m$a&&(a.style.fontStyle=b.isItalic?
"italic":"normal");(b.pxb||y&&this.Wv.Ith()||b.oxb||b.T6b)&&this.KPe(a,b,c,G);U&&(a.style.fontSize=U);if(m&&(a.style.fontFamily=m,J.a.instance.ga(118))){ya.a.instance.J(51676058,8,4,"UseQuotesWithFontFamily is Enabled.");c=new Sys.StringBuilder("");y=m.split(",");for(m=0;m<y.length-1;m++)c.append('"'+y[m].trim()+'",');0<y.length&&c.append('"'+y[y.length-1].trim()+'"');a.style.fontFamily=c.toString()}b.rTa&&(1===b.capitalization?a.style.fontVariant="small-caps":2===b.capitalization?a.style.textTransform=
"uppercase":a.style.fontVariant="normal");if(h=this.Wv.sYf(b,h.Ld))a.style.letterSpacing=h;if(b=this.Wv.P0f(b))a.style.fontKerning=b,v.a.wT&&(a.style.fontFeatureSettings="normal"===b?'"kern" 1':'"kern" 0');a.className=G.join(" ")}dvl(a,b,c){return J.a.instance.ga(116)&&v.a.uk&&v.a.Uj?"Community Light"===a?(c.fontWeight=b.isBold?"400":"300",!0):"Community Semibold"===a?(c.fontWeight=b.isBold?"bold":"600",!0):"Community Slab Medium"===a?(c.fontWeight=b.isBold?"bold":"500",!0):"Community Slab Semibold"===
a?(c.fontWeight=b.isBold?"bold":"600",!0):!1:!1}Kvf(a,b){this.fd.hg&&b&&!b.Mj&&(b.zp||b.Do)&&(a.style.color="#000")}Ddi(a,b){if(b=b?this.hRh(b):0){const c=Fa.a.ue(b);c?(a.setAttribute("xml:lang",c.name),a.setAttribute("lang",c.name)):this.iof.contains(b)||(ba.ULS.sendTraceTag(18482318,324,15,"Unknown LCID encountered in file: {0}",b),this.iof.add(b))}}KPe(a,b,c,h){c="";const m=b.dE,y=b.KF;b=b.w_;m&&(c="underline",h[h.length]="Underlined");if(y||b)c=m?c+" line-through":"line-through",h[h.length]="Strikethrough";
m||y||b||(c="none");0<c.length&&(a.style.textDecoration=c)}Gvf(a,b,c){b.isSuperscript&&(a.style.verticalAlign="super",a.className+=" Superscript");b.LF&&(a.style.verticalAlign="sub",a.className+=" Subscript");c&&(a.style.backgroundColor="inherit");(b.isSuperscript||b.LF)&&Wa.d(a,oa.a.gKf,(b.fontSize/2).toString())}kXd(a,b,c,h,m,y,G,U,ja,va,Ta,fb,Db,gc,hc,Gc,Pc,yc){const Vd=b?b.cache:Kc.FormattingCacheManager.r4b(c,pa.a.nil);Ta=!h||Db||this.BRa(h,Ta)?0:h.Gh.proofingType;Db=!!m;const De=!!y,Wd=!!G;
y=this.Wv.buh(Vd,fb,m,y,G);if(gc.R9b||Gc&&Ad(Gc))y=!1;this.cAf?(m=this.Pkj(Vd,Ta,Db,De,Wd,fb,y,Pc),this.NDc.Hb(m)?fb=this.NDc.ga(m):(fb=this.jJf(U,Vd,Ta,Db,De,Wd,fb,y,Pc),this.NDc.$(m,fb)),U=fb.cloneNode(),Y.a.oKc(fb,U)):U=this.jJf(U,Vd,Ta,Db,De,Wd,fb,y,Pc);this.Abi(a,U,Vd);this.NOd(a,U);this.Ctf(U);this.Btf(a,U);this.Qpa.Zzi&&this.Bbi(U,b,c);this.apb&&0!==Ta&&this.apb.OKk(U,c,(Ve,$e,Qf,lg)=>{ja.add(this.oJb(Ve,$e,Qf,lg))},h);gc.R9b&&hc&&gc.span&&(this.zPd(null,gc.span),gc.span=null);if((b=gc.R9b?
U:null)||gc.span)this.zPd(b,gc.span),gc.span=b,gc.span&&(b=(b=Y.a.ye(a,S.a.N0c))?b:-1,0<b&&(gc.span.style.lineHeight=String.format("{0}px",b+3)));Gc&&!Gc.isEmpty&&(bc(U,Gc),this.apb&&this.apb.Cdh(U,c,(Ve,$e,Qf,lg)=>{ja.add(this.oJb(Ve,$e,Qf,lg))},Gc,0));yc&&Sys.UI.DomElement.addCssClass(U,wb.a.oHi);a.appendChild(U);va(U);return U}BRa(a,b){b=a&&a.Gh&&a.Gh.token?a.Gh.token:b;return 0!==a.Gh.errorType&&!!this.uNa&&this.uNa.contains(b,a.Gh.lcid)}Pkj(a,b,c,h,m,y,G,U){b|=0;y&&(b|=16);G&&(b|=32);c&&(b|=
64);h&&(b|=128);m&&(b|=256);U&&(b|=2048);a.isSuperscript&&(b|=512);a.LF&&(b|=1024);return b}jJf(a,b,c,h,m,y,G,U,ja){a=a.hp(wa.a.span);const va=[];if(0!==c){if(!this.n4a.TEl)switch(c){case 1:va[va.length]=wb.a.tLc;break;case 2:va[va.length]=wb.a.rLc;break;case 3:va[va.length]=wb.a.qLc}b.isSuperscript&&(va[va.length]=wb.a.EXd)}else ja&&(va[va.length]=wb.a.gHi);G&&(va[va.length]=wb.a.R7);h&&(va[va.length]=wb.a.zXd);m&&(va[va.length]=wb.a.BXd);y&&(va[va.length]=wb.a.sLc);a.className=0<va.length?va.join(" "):
wb.a.Y0b;this.Gvf(a,b,U);return a}Bbi(a,b,c){if(b&&a){if(b=uc.a.Kvb(b))if(b=Ya.StyleReader.tQ(b)){a.setAttribute("data-ccp-charstyle",b);return}(c=Ob.ParagraphReader.Yd(c)?Ya.StyleReader.XD(c):null)&&(c=Ya.StyleReader.tQ(c))&&c!==Ya.StyleReader.iMa&&c!==Ya.StyleReader.hJh&&a.setAttribute("data-ccp-parastyle",c)}}Abi(a,b,c){(c=this.Wv.j5f(c))&&a.style&&a.style.fontSize&&""!==a.style.fontSize&&(a=a.style.fontSize,a=parseFloat(ta.a.substring(a,0,a.indexOf("px"))),isNaN(a)||(b.style.verticalAlign=a/this.Wv.h9d()*
c/100+"px"))}NOd(){}Ctf(){}Btf(){}lCi(a,b,c,h){b=b.hp(wa.a.span);b.className=wb.a.H1d;this.CDc&&this.CDc.NIl(h,b);a.appendChild(b);c(b);return b}KHf(a,b,c,h){b=b.hp(wa.a.span);b.className=wb.a.vN;a&&(b.style.fontSize=a.style.fontSize,b.style.lineHeight=this.q5d(a),b.style.fontFamily=a.style.fontFamily);a="";for(let m=0;m<h;m++)a+=c;b.innerText=a;return b}q5d(a){return a.style.lineHeight}zPd(a,b){a?(Sys.UI.DomElement.addCssClass(a,"Highlight"),Sys.UI.DomElement.addCssClass(a,wb.a.kHi),b||Sys.UI.DomElement.addCssClass(a,
wb.a.AXd)):b&&((a=Sys.UI.DomElement.containsCssClass(b,wb.a.AXd))&&Sys.UI.DomElement.removeCssClass(b,wb.a.AXd),Sys.UI.DomElement.addCssClass(b,a?wb.a.mHi:wb.a.lHi))}static iia(a,b,c){Y.a.Lv(c,S.a.FFa,b);b<a.count?a.$(b,c):a.add(c);return b+1}static QYf(a){let b,c;b=[];c=[];if(a&&a.zg)for(let h=0;h<a.zg.length;h++){const m=a.zg.ga(h);Array.add(m.vk?b:c,m.nI)}return{HJc:b,DJc:c}}static Tii(a,b){const c=new Jb.a;for(const m of b){var h=a.ye(m);b=h.eb(jb.a.F_b);if(h=h.sa(jb.a.EJc,null)){let y;({value:y}=
c.Uf(h)).returnValue||(y=new Qa.a,c.$(h,y));y.add(b)}}return c}static SYf(a,b,c){const h=new Qa.a,m=Oc.Tii(a,b);for(const y of b){const G=a.ye(y),U=G.eb(jb.a.F_b),ja=G.sa(jb.a.hyi,!1),va=G.sa(jb.a.QEf,!1);G.sa(jb.a.Jie,!1)&&!va&&(c.add(y),ja||m.Hb(U)||h.add(G.id))}return Na.JRk(b,h)}static Ixl(a,b,c,h){const m=new Qa.a,y=new Qa.a;b=Oc.SYf(a,b,m);a=Oc.SYf(a,c,y);c=new Qa.a;c.addRange(h);c.addRange(m);c=Na.KRk(c,y);return{HJc:b,DJc:a,EHi:c,mNj:0<y.count}}static V2i(a,b){var c=1;if(v.a.IF&&!b){a=La.a.nQc(a,
!1);for(let h of a)"IMG"===h.tagName?c+=3:Sys.UI.DomElement.containsCssClass(h,"PageBreakBlob")&&(c+=Za.KMc+Za.zZd)}return c}}Oc.$Yi=.8;Oc.RBh="TrackChangeImageOverlay";Object(n.a)(Oc,"ParagraphContentRenderer",null,[1420]);var Wb=d(74),Ab=d(599),Xb=d(1200),vb=d(55);class $c{constructor(a){this._element=null;this.hi=a;this.oyc=[]}get ownerDocument(){return this.hi}get element(){return this._element}Ejb(a){this._element=a}Q_g(){var a=Sys.EventArgs.Empty;if(this.oyc)for(let b=0;b<this.oyc.length;b++)(0,this.oyc[b])(this,
a)}dispose(){this.oyc=this._element=this.hi=null}}Object(n.a)($c,"APresenter",null,[1519,106]);class fd extends $c{constructor(a,b){super(b.htmlElement.ownerDocument);this.mob=null;this.FUb=a;this.w2h=b}FWf(a){this.element&&a.r0c===this.mob||(this.mob=a.r0c,this.Ejb(this.FUb.KHf(this.mob,this.w2h.Md,S.a.GNc,1)),this.element.className=wb.a.aac,this.element.style.lineHeight=this.mob.style.lineHeight,a=""+Y.a.ye(this.mob,S.a.nNb),Y.a.Lv(this.element,S.a.nNb,a),a=Xb.a.createElement(this.ownerDocument,
wa.a.span),a.innerText=S.a.Ioi,La.a.tu(this.element),this.element.appendChild(a),a=Xb.a.createElement(this.ownerDocument,wa.a.br),this.element.appendChild(a))}wdg(){}dispose(){super.dispose();this.mob=null}}Object(n.a)(fd,"LineBreakPresenter",$c,[]);class Bd{constructor(a){this.FUb=a}create(a){return new fd(this.FUb,a)}}Object(n.a)(Bd,"LineBreakPresenterFactory",null,[1482]);class gd extends $c{constructor(a,b){super(a.ownerDocument);this.OLd=b;this.Qba=a}FWf(){this.element||(this.Ejb(this.Qba.hp(wa.a.span)),
19===this.OLd.kind||18===this.OLd.kind?Sys.UI.DomElement.addCssClass(this.element,wb.a.yXd):(Sys.UI.DomElement.addCssClass(this.element,wb.a.Z0b),this.element.title=Box4Intl.Box4Strings.l_UnsupportedTooltip),this.element.innerText=this.OLd.D7a,this.Q_g())}wdg(){this.Ejb(null);this.Q_g()}}Object(n.a)(gd,"UnsupportedObjectPresenter",$c,[]);class Pd{create(a,b){return new gd(a,b)}}Object(n.a)(Pd,"UnsupportedObjectPresenterFactory",null,[1481]);class cd{constructor(a=!1,b=!1,c=!1,h=!1,m=!1,y=!1,G=!1){this.ix=
a;this.VNi=b;this.PBl=c;this.QBl=h;this.ruc=m;this.nie=y;this.TEl=G}}Object(n.a)(cd,"ParagraphContentRendererSettings",null,[]);var lf=d(111);class Jd{constructor(a,b,c){this.EV=a;this.qZ=b;this.lRb=c}h9a(a){return a}O_f(a,b,c){return c.Via(a)}sYf(){return null}P0f(){return v.a.Uj&&window.chrome?"none":null}uCf(){return!1}JCh(){return!1}Mvf(){return""}pHh(){}mFf(){}guh(a){return a===D.a.underline||a===D.a.uoa||a===D.a.strikethrough||a===D.a.Vs||a===D.a.Q5}kLe(a,b){this.EV&&this.EV.isEnabled&&this.EV.createFontUrl(a);
this.qZ&&this.qZ.isEnabled&&(b=ka.FontUtils.Eqb(b,a,!1,!1,!0),this.qZ.createFontUrl(a));return b}dch(a,b,c=null){if(!a)return b;b=this.kLe(a.fontName,b);this.lRb&&this.lRb.isEnabled&&(b=ka.FontUtils.Eqb(b,a.fontName,!1,!0),this.lRb.QHl(a)||this.lRb.$Gl(c),this.lRb.jHl(a));return b}lYc(){return!1}Q5d(a,b,c,h){a=null;!c&&h||!b.C3||(b=b.fontColor,a=b===hb.a.auto?"WindowText":hb.a.oI(b));return a}buh(a,b,c,h,m){return!b&&!c&&!h&&!m}j5f(){return 0}h9d(){return.8}Gth(a,b){return a||!b}juh(){return!1}Ith(){return!1}vZf(){return new Jb.a}wZf(){return null}O4b(a){return lf.Font.MDa(a.zN)}}
Object(n.a)(Jd,"TextRenderingStrategy",null,[1377]);class Xf{get name(){return"Box4.ParagraphRenderElements"}$b(a){a.register(Bd,"Box4.LineBreakPresenterFactory").as("Box4.ILineBreakPresenterFactory").ma().oa(()=>new Bd(a.resolve("Box4.IParagraphContentRenderer")));a.register(Pd,"Box4.UnsupportedObjectPresenterFactory").as("Box4.IUnsupportedObjectPresenterFactory").ma();a.register(Jd,"Box4.TextRenderingStrategy").as("Box4.ITextRenderingStrategy").ma().oa(()=>new Jd(a.rb("Box4.IFontService"),a.rb("Box4.CustomFontService"),
a.rb("Box4.IEmbeddedFontService")));a.register(cd,"Box4.ParagraphContentRendererSettings").ma().oa(()=>new cd(Wb.ListReader.ix,u.AFrameworkApplication.fa.ka("DragDropSelectionIsEnabled"),J.a.instance.ga(49),J.a.instance.ga(53),u.AFrameworkApplication.fa.ka("WordEditorCommentImprovementIsEnabled"),u.AFrameworkApplication.fa.ka(ka.FontUtils.hEf),u.AFrameworkApplication.fa.ka("WordEditorIdeasCardsIsEnabled")));a.register(Oc,"Box4.ParagraphContentRenderer").as("Box4.IParagraphContentRenderer").ma().oa(()=>
new Oc(na.InteractiveViewManager.instance,ha.a.instance,a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,a.resolve("Box4.IFormattingPropertyTransitStrategy"),a.rb("Box4.Proofing.IProofingFeatureConfiguration"),a.resolve("Box4.Proofing.IIgnoreAllKeywords"),a.resolve("Box4.ITextRenderingStrategy"),a.resolve("Box4.ParagraphContentRendererSettings"),a.resolve("Box4.ILineSpacingHelper"),a.rb("Box4.IFeatureHelper"),ka.FontUtils.Uia,a.rb("Box4.IFontSlotProvider"),Object(F.a)(a.resolve("Box4.IEditStateEventManager"),
a.resolve("Box4.IEditStateEventManager").Ldh,"raiseParagraphContentUpdatedEvent"),uc.a.language,a.rb("Box4.ITableOfContentRenderHelper"),Ab.a.qyf))}init(){}dispose(){}static main(){r.a.instance.Dc(new Xf)}}Object(n.a)(Xf,"Box4ParagraphRenderElementsPackage",null,[2,3]);class ee{constructor(a,b,c,h,m,y,G){this.rje=a;this.XVj=b;this.hZc=c;this.wQj=h;this.tTj=m;this.ix=y;this.QTj=b&&G||h}}Object(n.a)(ee,"TableCellViewElementSettings",null,[]);class Ra{get name(){return"Box4.TableViewElements"}$b(a){a.register(ee,
"Box4.TableCellViewElementSettings").ma().oa(()=>new ee(u.AFrameworkApplication.fa.ka("OneNoteSpannedTableCellRenderIsEnabled"),J.a.instance.ga(63),J.a.instance.ga(30),J.a.instance.ga(77),J.a.instance.ga(71),Wb.ListReader.ix,u.AFrameworkApplication.fa.ka("WordEditorTableCellWidthIsEnabled")))}init(){}dispose(){}static main(){r.a.instance.Dc(new Ra)}}Object(n.a)(Ra,"Box4TableViewElementsPackage",null,[2,3]);var sb=d(1185),ec=d(383),Lc=d(1209),nd=d(223),Fd=d(161),Ja=d(177),db=d(1141);class ic{ye(a,
b){return Y.a.ye(a,b)}Lv(a,b,c){Y.a.Lv(a,b,c)}Rna(a,b){Y.a.Rna(a,b)}VJa(a){Y.a.VJa(a)}oKc(a,b){Y.a.oKc(a,b)}}Object(n.a)(ic,"CustomDataProxy",null,[1564]);var id=d(348),qd=d(63),Fc=d(27);class Ze{constructor(){this.Oa=new bd.a}wIk(a){this.Oa.raiseEvent("OnBackspaceDelete",a)}}Object(n.a)(Ze,"BackspaceDeleteEventSource",null,[1442,1443]);class df extends Sys.EventArgs{constructor(a,b){super();this.JM=a;this.QU=b}}df.eventId="AEV.AVLD";Object(n.a)(df,"EditingViewOnAfterValidateEventArgs",Sys.EventArgs,
[]);class ve extends bd.a{constructor(){super()}esf(a){this.addHandler(df.eventId,a)}yTk(a){this.removeHandler(df.eventId,a)}}ve.Ayi="AEV.CR";Object(n.a)(ve,"ContentEditableViewEventSource",bd.a,[]);var md=d(49);class Kf{constructor(){this.RBc=null;this.Sh=0}mdj(a){if(!this.RBc){var b=a.Nb?md.a.createTextRange(a.node,0,a.Nb):md.a.Kj(a.node,a.Nb);this.RBc=Ib.HyperlinkReader.hC(b,!1);this.Sh=this.RBc.length-1}for(;0<=this.Sh;)if(b=this.RBc[this.Sh],a.Nb<=b.Qa)--this.Sh;else return b.Nb<=a.Qa?null:b;
return null}}Object(n.a)(Kf,"OverlappingHyperlinkHelper",null,[]);class oe{constructor(a,b,c,h,m){this.G0a=a;this.DD=b;this.Dra=c;this.Xbd=h;this.Ybd=m}}Object(n.a)(oe,"PersistActiveSpanEditState",null,[]);class Hf{constructor(a,b){this.Cg=a;this.Zg=b;this.uBc=[];this.VH=this.UH=-1}SPe(){if(-1!==this.UH&&-1!==this.VH&&this.Zg){this.uBc.reverse();const a=this.uBc.join("");let b,c;this.UH===this.VH?(b=md.a.Kj(this.Cg,this.UH),c=!!a.length):(b=md.a.createTextRange(this.Cg,this.UH,this.VH),c=this.VH-
this.UH!==a.length||this.z9d(b)!==a);c&&this.Zg.replaceTextRange(b,a,!0,void 0,D.a.typing)}this.VH=this.UH=-1;Array.clear(this.uBc)}edi(a,b){this.UH=a.Qa;-1===this.VH&&(this.VH=a.Nb);0<b.length&&Array.add(this.uBc,b)}z9d(a){return Ob.ParagraphReader.text(a.node).substring(a.Qa,a.Nb)}}Object(n.a)(Hf,"ReplacementTextRangeBuilder",null,[]);var xb=d(39);class hg{constructor(a,b,c,h,m,y,G,U,ja,va,Ta,fb){this.Dh=a;this.rD=b;this.fqa=c;this.eg=h;this.ld=m;this.yn=y;this.yd=G;this.Rm=ja;this.nd=va;this.tf=
Ta;this.$a=fb;this.rzc=this.$a.ka("TextLayoutServiceUseResponse");this.eef=this.$a.ka("TextLayoutServiceEnableActiveContentSpanFix")}Ttl(){let a,b;a=b=null;if(this.yd&&this.yd.dV){var c=this.Rm.getSelection(this.nd.contentWindow);if(c){a=b=c.focusNode;for(c=null;b&&"span"!==(c=b.nodeName.toLowerCase())&&!Sys.UI.DomElement.containsCssClass(b,wb.a.mfa);)b=b.parentNode;"span"!==c&&(b=null);return{returnValue:!!b,lVf:a,mVf:b}}}return{returnValue:!1,lVf:a,mVf:b}}Mcj(a){let b=0;for(let c of La.a.t9a(a))"span"===
c.nodeName.toLowerCase()&&b++;return b}g2k(a){if(!a.parentNode||!a.parentNode.parentNode)return null;for(var b=a.parentNode;!Sys.UI.DomElement.containsCssClass(b,wb.a.mfa)&&!Sys.UI.DomElement.containsCssClass(b,wb.a.g9);){if("font"===b.nodeName.toLowerCase()){a=b.previousSibling;if(!a)break;if("a"===a.nodeName.toLowerCase()){b=null;for(let c of La.a.t9a(a))"span"===c.nodeName.toLowerCase()&&(b=c);return b}}b=b.parentNode}return null}q5i(a,b,c,h,m){let y=La.a.sv(c);const G=La.a.V3d(c,wb.a.mfa);m=this.Mcj(G)+
this.Dh.Ei.length-m.gt.length;2>m?h.nextSibling&&"span"!==h.nextSibling.nodeName.toLowerCase()&&"br"!==h.nextSibling.nodeName.toLowerCase()?y=La.a.sv(h)+La.a.sv(h.nextSibling):"span"!==c.nodeName.toLowerCase()&&c.nextSibling?y=La.a.sv(h):"#text"===c.nodeName.toLowerCase()&&c.parentNode!==h&&(y=La.a.sv(h)):2===m?h.nextSibling&&"span"===h.nextSibling.nodeName.toLowerCase()&&(y=La.a.sv(h)+La.a.sv(h.nextSibling)):2<m&&(y=b.innerText,ba.ULS.sendTraceTag(541172697,323,50,"GetCorrectLastActiveSpanTextForCompleteOvertype: SpanCountDiff > 2"));
a.M_b||!b.innerText.endsWith(" ")||y.endsWith(" ")||(y+=b.innerText.substr(b.innerText.trimEnd().length));return y}Azk(a,b,c,h,m){const y=new oe(null,null,!0,null,null);let G=null,U=null;if(1===this.tf.mode||2===this.tf.mode)({lVf:G,mVf:U}=this.Ttl());let ja=!1,va=!1;const Ta=new Kf,fb=new Hf(a,h),Db=0<this.Dh.Ei.length&&this.Dh.Ei[0].M_b;let gc=null;G&&this.$a.ka("TextLayoutServiceEnableHyperLinkDataLossFix")&&(gc=this.g2k(G));for(let Gc=this.Dh.Ei.length-1;0<=Gc;Gc--){const Pc=this.Dh.Ei[Gc],yc=
Pc.tF;let Vd=!1;if(this.eef&&this.rzc&&U&&!La.a.s2b(yc)){var hc=!1;Db&&Gc===this.Dh.Ei.length-1&&!La.a.V3d(G,wb.a.vN)?Vd=hc=!0:1===this.Dh.Ei.length&&(hc=!0);hc&&(yc.innerText=this.q5i(Pc,yc,G,U,c),y.Dra=!1)}y.DD=La.a.sv(yc);this.rD.e7&&this.bQi(y.DD)&&(y.DD=ta.a.substr(y.DD,0,y.DD.length-1));hc=this.Z4i(a,Gc);this.oik(a,b,Gc,y);va=!!y.G0a||va;gc===yc&&(y.Ybd=yc.innerText+La.a.sv(G),G.nodeValue="",y.Dra=!1,ba.ULS.sendTraceTag(541172698,323,50,"PersistActiveSpanEdits: Moved text from bare node to sibling span"));
y.Xbd||(y.Xbd=this.AWi(a,hc,Ta));const De=!!m&&m.Myi(hc);this.Qwl(a,b,yc,Gc,y,Vd);De&&0<y.DD.length?(fb.SPe(),this.replaceTextRange(h,y,"",hc),this.Adi(m,De,y,hc)):this.Svi(Pc,y.DD,hc,fb);ja=yc===U||ja}fb.SPe();this.Gyl(a,y);G&&La.a.sv(G)&&!ja&&!va&&(this.ld.Wb("ValidTextDropped",{["Reason"]:"TextLostDuringOvertype"}),hg.Xff||(ba.ULS.sendTraceTag(23909632,323,50,"PersistActiveSpanEdits: browser created new span with text that are is lost during OverType"),hg.Xff=!0));return y.Dra}Svi(a,b,c,h){if(c.contextId!==
xb.a.Of&&!a.M_b&&0<=a.Hfd){let m=a.Hfd,y=a.JHe;a=m!==y?md.a.createTextRange(c.node,m,y):md.a.Kj(c.node,m);b=b.substring(m-c.Qa,b.length-(c.Nb-y))}else a=c;a.Nb-a.Qa!==b.length||b!==this.z9d(a)?h.edi(a,b):h.SPe()}bQi(a){return a.charAt(a.length-1)===Za.VGb||v.a.to&&a.charCodeAt(a.length-1)===z.a.QOb}z9d(a){return Ob.ParagraphReader.text(a.node).substring(a.Qa,a.Nb)}replaceTextRange(a,b,c,h){b.DD!==c&&a&&a.replaceTextRange(h,b.DD,!0,!0)}Adi(a,b,c,h){b&&0<c.DD.length&&(b=md.a.createTextRange(h.node,
h.Qa,h.Nb+c.DD.length),a.Cdi(b))}Gyl(a,b){b.Xbd&&(b=Ib.HyperlinkReader.hC(b.Xbd,!0),1===b.length&&this.yn&&this.yn.F$k(a,b[0]))}Qwl(a,b,c,h,m,y){const G=La.a.H3f(c);this.Dh.Ei[h].M_b&&G?y||this.Upj(b,h,m,G):m.G0a&&!Sys.UI.DomElement.containsCssClass(c,wb.a.hN)?(this.ld.Wb("MomentaryIncorrectFormatting",{["Reason"]:"MoveEopTextIntoSpan"}),this.eg.bc++,m.DD+=m.G0a,m.G0a=null,La.a.Ix(this.Dh.Ei[h].tF,m.DD)):m.Ybd?(m.DD=m.Ybd,m.Ybd=null):this.rzc&&this.eef&&(a=Ob.ParagraphReader.text(a),b=this.Dh.Ei[h],
c=b.Hfd,y=b.JHe,h+1<this.Dh.Ei.length&&!La.a.s2b(this.Dh.Ei[h+1].tF)&&c===y&&0<c&&" "===a.charAt(c-1)&&(m.DD=m.DD.substr(0,c-1)+" "+m.DD.substr(c-1),m.Dra=!1),b.tF.innerText.endsWith(" ")||" "!==a.charAt(y)||b.SYa+b.aTa!==y+1||(m.DD+=" ",m.Dra=!1))}Upj(a,b,c,h){!b&&c.G0a?(this.ld.Wb("MomentaryIncorrectFormatting",{["Reason"]:"MoveEopTextIntoSpan0"}),this.eg.bb++,c.DD=c.G0a,La.a.Ix(this.Dh.Ei[b].tF,c.DD),this.yd.MF&&(a=a.lastChild,this.rzc&&Sys.UI.DomElement.containsCssClass(a,wb.a.g9)&&(a=a.lastChild),
a&&a.parentNode&&a.parentNode.insertBefore(h,a)),c.G0a=null):(this.ld.Wb("ValidTextDropped",{["Reason"]:"EopTextLostDuringOvertype"}),this.eg.bd++,c.DD="",La.a.Ix(this.Dh.Ei[b].tF,c.DD))}Z4i(a,b){b=this.Dh.Ei[b];return b.SYa?md.a.createTextRange(a,b.aTa,b.aTa+b.SYa):md.a.Kj(a,b.aTa)}oik(a,b,c,h){if(this.Dh.Ei[c].aTa+this.Dh.Ei[c].SYa===Ob.ParagraphReader.textLength(a)&&(a=b.lastChild,this.rzc&&Sys.UI.DomElement.containsCssClass(a,wb.a.g9)&&(a=a.lastChild),c=La.a.sv(a),c.length>this.fqa.v0d)){this.eg.ba++;
this.rD.rjb(!1,b,this.Dh);h.G0a=ta.a.substr(c,0,c.length-this.fqa.v0d);b="";for(c=0;c<this.fqa.v0d;c++)b+=S.a.GNc;a.innerText=b;h.Dra=!1}}AWi(a,b,c){return(b=c.mdj(b))&&hg.cIj(b)?md.a.Kj(a,b.Qa):null}static cIj(a){return!!a.hyperlink&&a.hyperlink.url===Ob.ParagraphReader.text(a.paragraph).substring(a.Qa,a.Nb)}}hg.Xff=!1;Object(n.a)(hg,"ActiveContentSpansPersistanceManager",null,[1441]);class rf{constructor(a){this.Rs=a}Zlk(a){a&&this.Rs.SY()}}Object(n.a)(rf,"AppFrameResizeEventProcessor",null,[]);
class nf{constructor(){this.tXb=new Qa.a}ya(a){this.tXb.add(a)}Xsa(a){return this.tXb.count>a?this.tXb.ga(a):null}get IFa(){return this.tXb.count}isEmpty(){return!this.tXb.count}}Object(n.a)(nf,"AggregatedAutoCorrectActions",null,[618]);var kd=d(233);class If{constructor(a,b,c,h,m,y,G,U,ja,va,Ta,fb,Db,gc,hc,Gc){this.tR=this.yn=this.ryc=this.Ue=null;this.Zu=a;this.fK=b;this.yh=c;this.Ob=h;this.Dh=m;this.oZ=y;this.Bp=G;this.Ui=U;this.vha=ja;this.Rs=va;this.tf=Ta;this.XR=fb;this.yk=Db;this.Tc=gc;this.fd=
hc;this.$o=Gc}FS(a){this.Ue=a}get OYb(){return this.fK}get hyperlinkEditor(){return this.yn||(this.yn=vb.a.instance.rb("Box4.IHyperlinkEditor"))}get Jyj(){return this.ryc||(this.ryc=vb.a.instance.rb("Box4.IHyperlinkActionFactory"))}AGj(a){if(this.Zu.instance&&a&&2===this.yh.mode)if(this.Ue.Ps(!0),this.vha.value.kw(),a.ex)this.Zu.instance.yGj(a),this.vha.value.kw();else{var b=this.Ui.m8(this.yh.mode,this.Ob.Hi);a.xag.innerText=a.xag.innerText;this.XR.aoc();this.Bp.raiseEvent(kd.a.autoCorrect);1===
this.Zu.instance.zGj(a)&&(this.tf.oaa(!0),b>=a.qR&&(b+=a.K0c),this.Ui.XS(b,this.Ob.Vh),this.Ue.Ps(!0),this.vha.value.kw(),this.Rs.SY())}}RBe(a,b){if(!this.Zu.instance||!this.Jyj||!this.hyperlinkEditor)return null;this.Ue.Ps(!0);a=this.oZ.fta(b).Ua;b=a.Qa;if(0>=b||!this.Dh.Ei.length)return null;if(a=this.Zu.instance.RBe(a.node,b))this.tR||(this.tR=new nf),this.tR.ya(a);return a}IMi(a,b){if(2===this.yh.mode&&this.Dh.Ei.length){var c=this.Ui.m8(this.yh.mode,this.Ob.Hi);!this.tR&&this.Zu.instance&&(b=
this.oZ.fta(b).Ua,0>c||!this.Dh.Ei.length||(this.tR=new nf,this.tR=this.Zu.instance.pHf(b.node,c,c-this.Dh.Ei[0].vHc,this.Dh.Ei[0].tF,!this.Dh.Ei[0].vHc,a),this.tR.IFa||(this.tR=null)))}}rzk(){if(2===this.yh.mode){if(0<this.tR.IFa){this.Ue.Ps(!0);for(var a=0;a<this.tR.IFa;a++)this.tR.Xsa(a).cIh();for(a=0;a<this.tR.IFa;a++)this.AGj(this.tR.Xsa(a))}this.tR=null}}}Object(n.a)(If,"AutocorrectActionExecutor",null,[]);var og=d(314);class pf{constructor(a,b,c,h,m,y,G,U,ja,va){this.X1h=y;this.oZ=a;this.kj=
b;this.wD=c;this.hf=h;this.nK=m;this.f5e=G;this.fd=U;this.uD=ja;this.Dza=!!va;this.Zu=va}eul(a,b,c,h,m,y,G){if(!h)return!1;h=this.oZ.fta(m);if(!h||!this.hf.gx(h)||!h.Ua.el)return!1;m=h.Ua;if(this.NPj(m)||this.sNj(a,m)||this.yab(m))return!1;if(Fc.App.rgi){if(this.MPj(y))return!1}else if(this.LPj(y))return!1;return this.nK&&this.nK.Fyb(h)||!this.Tni(a,this.kj,G,La.a.sv(c),b)||this.Dza&&!a&&this.Zu.instance&&this.Zu.instance.bxj()?!1:!0}MPj(a){if(this.f5e&&a&&Sys.UI.DomElement.containsCssClass(a,wb.a.mfa)){const b=
La.a.Pca(a,wb.a.g9);b&&(a=b)}return La.a.Pca(a,pf.C_g)?!0:!1}LPj(a){if(this.f5e&&a&&Sys.UI.DomElement.containsCssClass(a,wb.a.mfa)){const b=La.a.Pca(a,wb.a.g9);b&&(a=b)}return La.a.Pca(a,og.a.pbb)||La.a.Pca(a,pf.C_g)?!0:!1}yab(a){return this.uD.yab(a).returnValue}NPj(a){return this.kj&&(!this.X1h.BZb(a.node)||J.a.instance.ga(14)&&this.wD.v8g(a.node))?!0:!1}sNj(a,b){return J.a.instance.ga(14)&&this.wD.$Nj(b,!a)}Tni(a,b,c,h,m){if(!h||""===h)return!1;var y=this.fd.hg&&this.fd.Ny;y=a&&!y?0:1;!a&&1<c&&
ta.a.jx(h,c-1)?y=2:c<h.length&&ta.a.jx(h,c)&&(y=1);if(a){if(a=c+y,a>=h.length-2||!this.Uni(c,h,y))return!1}else{a=c-y;if(b){if(0>a)return!1}else if(0>=a)return!1;if(1===a&&ta.a.Xy(h.charCodeAt(0))&&(h.length===c||ta.a.Xy(h.charCodeAt(c))))return!1}b=W.a.dEa(m,a,!0,!0);return Sys.UI.DomElement.containsCssClass(b,S.a.iHi)||Sys.UI.DomElement.containsCssClass(b,wb.a.vN)||Sys.UI.DomElement.containsCssClass(b,wb.a.hN)||Sys.UI.DomElement.containsCssClass(b,S.a.eW)?!1:!0}Uni(a,b,c){return ta.a.Xy(b.charCodeAt(a+
c))&&(!a&&b.length===1+c||1===a&&ta.a.Xy(b.charCodeAt(0)))?!1:!0}}pf.C_g="NoteTagContainer";Object(n.a)(pf,"BackspaceInBrowserHandler",null,[]);var ig=d(1196),Oe=d(197);class Ag{constructor(a,b,c){this.point=a;this.width=b;this.height=c}}Object(n.a)(Ag,"UnroundedRectangle",null,[]);var ce=d(1051),me=d(62),Je=d(144);class ie{constructor(a,b,c,h,m,y,G,U,ja){this.zh=null;this.Sfa=!1;this.uba=a;this.nd=b;this.uZ=c;this.d2=h;this.yd=m;this.Lf=y;this.tf=G;this.Ob=U;this.HP=ja}UYb(a){this.zh=a}SY(){if(2===
this.tf.mode&&this.Ob.Dg){var a=this.Ob.uW,b=this.Ob.Vh;if(a&&b){if(!this.nd.Ag&&(u.AFrameworkApplication.fk("Microsoft.Office.Web.SessionSettings.IWacWordBoundsSynchronizerHeaderFooterEarlyReturnSettings"),u.AFrameworkApplication.fa.ka("BoundsSynchronizerHeaderFooterEarlyReturnIsEnabled"))){ba.ULS.sendTraceTag(51667991,317,50,"Null EditingDom in SynchronizeBounds. ViewId: {0}",this.zh.Ma);return}this.nd.Ag.bEe(a);b=this.nd.Ag.nu;var c=this.e_f(a.htmlElement,b.parentNode);if(c&&c.point){var h=c.point;
a=c.width;c=c.height;0>a&&(a=0);var m=ig.a.create();try{b.style.top=h.y.toString()+"px",b.style.left=h.x.toString()+"px",b.style.width=a.toString()+"px",b.style.height=c.toString()+"px",b.style.paddingRight=""}finally{m&&m.dispose()}this.quh()&&(h=this.nd.om(),this.HVj()?h.style.clip="":(b.style.height=c+100+"px",h.style.clip="rect(0px,"+a+"px,"+c+"px,0px)"));this.uba.instance.czl(b.parentNode,this.Ob.uca,!!this.zh&&this.zh.Vl&&this.zh.evb)}}}}quh(){return this.yd.MF&&!this.yd.Ni&&J.a.instance.ga(30)}GKj(a){return La.a.kUa(a)}HVj(){return Je.c(this.zh.yg)}ii(a){return qd.a.ii(a)}lzh(a){var b=
me.a.instance.Pa.mb;if(1===this.tf.mode){var c=(b.yf?b.Ye:b.Ua).node;b=c.sc(this.Lf.Rd.Ma);a=c.sc(a);if(b&&a){this.nd.Ag.bEe(b);a=this.nd.Ag.nu;var h=this.e_f(b.htmlElement,a.parentNode);if(h&&h.point){b=h.point;c=h.width;h=h.height;0>h&&(h=1);0>c&&(c=1);a=a.style;if(this.yd.Yib)this.d2.X$f();else{const m=b.x+"px";c+="px";h+="px";if(a.left!==m||a.width!==c||a.height!==h)a.left=m,a.width=c,a.height=h}b=b.y+"px";a.top!==b&&(a.top=b)}}}}e_f(a,b){if(!this.GKj(a))return null;var c=this.ii(a),h=this.ii(b);
let m=c.x-h.x;h=c.y-h.y;var y=ig.a.create();try{m+=b.scrollLeft,h+=b.scrollTop}finally{y&&y.dispose()}b=c.width;c=c.height;this.uZ&&this.uZ.instance&&this.uZ.instance.chg(a)&&(y=this.uZ.instance.Y2,b/=y,c/=y);if(this.HP.pzb(a)){var G=Oe.a.Qt(a);G&&(y=parseFloat(G.width),G=parseFloat(G.height),isNaN(y)||isNaN(G)||(b=y,c=G))}0>=b&&(b=a.scrollWidth);0>=c&&(c=a.scrollHeight);if(this.yd.mUa||this.yd.to)b+=.001,m+=.001,h+=.001;c+=1.001;return new Ag(new ce.a(m,h),b,c)}}Object(n.a)(ie,"BoundsSynchronizer",
null,[1440]);var Tf=d(557),He=d(79);class Sg{constructor(a,b,c,h,m,y,G,U,ja,va,Ta,fb,Db){this.ZVh=new Tf.a(RegExp("\r\n","g"),"\n");this.YBd=null;this.MDd=0;this.zHd=!1;this.Dyc=!0;this.ld=b;this.eg=c;this.Jzc=a;this.nd=h;this.Wo=m;this.yd=y;this.Lf=G;this.Wd=U;this.kj=ja;this.Rm=va;this.QId=Ta;this.Nqa=Db}get pfg(){null==this.YBd&&(this.YBd=u.AFrameworkApplication.fa?u.AFrameworkApplication.fa.ka("CursorPositionFixForIMEInMacIsEnabled"):!1);return this.YBd}get XUa(){return this.MDd}get iLk(){return this.zHd}get EFj(){return this.Dyc}FQc(a,
b){var c=this.nd.KDa();if(1===a||0===a)return 0;if(this.yd.dV){var h=this.IDa();if(h){this.zHd=!this.JZc(h);c=this.Rm.xTc(h);var m=this.Rm.S4f(h),y=m;u.AFrameworkApplication.fk("Microsoft.Office.Web.SessionSettings.IWacWordCursorPositionFixForIMEInMacSettings");this.pfg&&this.yd.uk&&(h=this.Rm.i_f(h),m!==h&&(y=h));return this.Wo.A7d(c,b,y,this.eg,this.ld,this.kj)}ba.ULS.sendTraceTag(51463631,324,50,"GetCaretPosition could not find IP, rangeObject is null")}else if(this.yd.IF)try{return m=c.selection.createRange(),
y=this.nd.om().innerText,b=0,""!==y&&(b=Math.abs(this.Rm.moveStart(m.range,-1E5)),m=c.selection.createRange(),h=Math.abs(this.Rm.moveEnd(m.range,-1E5)),this.zHd=b!==h),y=this.ZVh.mJa(y),b>=y.length&&(b=y.length-1),b}catch(G){this.ld.Wb("IncorrectIpPosition",{["Reason"]:"OldIeGetCaretPositionException"}),this.eg.bg++,ba.ULS.sendTraceTag(51463190,324,15,"Incorrect IP position, message: {0}, Exception: {1}",G.message,G.toString())}else ba.ULS.sendTraceTag(51463191,324,15,"GetCaretPosition could not find IP, returned 0");
this.eg.bh++;return 0}JZc(a){return qd.a.JZc(a)}IDa(){return qd.a.IDa(this.nd.contentWindow)}gel(a,b,c,h,m){if(!u.AFrameworkApplication.fa||!u.AFrameworkApplication.fa.ka("TextLayoutServiceEnableSelectionCursorFix")||c!==m+h||a===b.gt.length-1||Sys.UI.DomElement.containsCssClass(b.gt[a+1],wb.a.vN))return!1;a=b.gt[a];b=La.a.V3d(a,wb.a.g9);if(!b)return!1;b=La.a.t9a(b).toArray();return b[b.length-1]!==a?!1:!0}XS(a,b){var c=this.nd.contentWindow;this.Dyc=!0;this.MDd=a;try{if(this.yd.dV){const y=b.gt;
let G;var h=0;const U=this.Rm.getSelection(c);if(U)for(G=0;G<b.gt.length;G++){const ja=b.gt;ba.ULS.shipAssertTag(18437200,315,y===ja);let va=ja[G],Ta=this.Wo.BI(va,this.eg,this.ld,this.kj);var m=a<=Ta+h;const fb=Sys.UI.DomElement.containsCssClass(va,wb.a.hN),Db=Sys.UI.DomElement.containsCssClass(va,S.a.eW),gc=this.gel(G,b,a,h,Ta);if(m&&!fb&&!Db&&!gc){b=G+1;if(a===Ta+h&&b<ja.length){const hc=ja[b];!this.Wo.BI(hc,this.eg,this.ld,this.kj)&&La.a.s2b(hc)&&(va=hc,h=a)}a-=h;this.Jzc.value.B_b(va,c);for(c=
va;c.firstChild;)c=c.firstChild;this.uIj(U,c,a)||(c=this.zRi(c,this.nd.KDa()),this.pfg&&this.yd.uk?2!==this.Lf.editingView.Ftb&&this.WPf(c,a,U):this.WPf(c,a,U));break}h+=Ta}}else this.yd.IF&&(h=this.QId.create(this.Lf.Rd),m=this.Rm.createRange(this.nd.om()),this.Rm.collapse(m,!0),this.Rm.moveStart(m,a),m.select(),h.dispose())}catch(y){ba.ULS.shipAssertTag(4203852,315,!1)}}zRi(a,b){"SPAN"===a.nodeName&&(b=b.Rl.createTextNode(""),a.appendChild(b),a=b);return a}WPf(a,b,c){if(this.Wo.Ofg(a)){this.Rm.removeAllRanges(c);
var h=this.Rm.createRange(a.ownerDocument);this.Rm.kLb(h,!0,a,b);this.Rm.kLb(h,!1,a,b);try{this.Rm.addRange(c,h)}catch(m){this.eg.bl++,this.ld.Wb("PossibleNoIp",{["Reason"]:"AddRangeException"}),ba.ULS.shipAssertTag(1708946,315,!1)}this.Rm.collapse(h,!0)}else ba.ULS.sendTraceTag(541172696,324,50,"EnsureCaretPositionToTextObject: Detached element")}updateCaretPosition(a,b){this.MDd=this.FQc(a,b)}mouseDown(){return this.Dyc=!1}xJ(){this.Dyc=!0;return!1}m8(a,b){this.Nqa&&this.Nqa.OCl(this.XUa,this.FQc(a,
b));return this.XUa}uIj(a,b,c){const h=a.focusNode,m=!!h&&3===h.nodeType,y=a.focusOffset;return a.isCollapsed&&m&&h===b&&y===c}WKf(a,b){const c=new He.a(0,1,0,()=>{b.UUa(a.mode)&&this.updateCaretPosition(a.mode,b.Hi)},28);this.Wd.Eb(c)}}Object(n.a)(Sg,"CaretPositionManager",null,[1439]);var jc=d(264);class be{constructor(){this.mI=jc.a.instance.t4d()}}Object(n.a)(be,"CevUsageDataTracker",null,[]);class Md{constructor(a,b){this.rwc=null;this.Zha=0;this.Dg=this.uW=null;this.uca=!1;this.iBa=a;this.Lf=
b}init(a){this.Zha=a}get gxj(){return!!this.Dg&&!!this.Dg.tg(this.Zha)}get JQa(){ba.ULS.shipAssertTag(18437208,315,!!this.Dg);return this.Vh?this.Vh.htmlElement:null}get Hi(){return this.Vh?this.Vh.Hi:null}get Vh(){return this.rwc}set Vh(a){this.rwc=a;a=null;this.iBa.instance&&(a=this.iBa.instance.hDh());this.rwc&&a&&a.kJl(this.rwc.x8g)}UUa(a){return 1!==a||me.a.instance.Pa.Fda?this.Dg&&this.Vh&&this.uW?(a=this.Lf.Rd)&&Ob.ParagraphReader.Yd(this.Dg)&&this.Vh===this.Dg.sc(this.Zha)&&this.uW===this.Dg.sc(a.Ma)?
!0:!1:!1:!0}}Object(n.a)(Md,"CevViewContentManager",null,[1438]);var de=d(1203),Zc=d(373);class Yf{constructor(a,b,c,h,m,y,G,U,ja,va,Ta,fb,Db,gc,hc){this.Ue=null;this.kK=a;this.VKd=b;this.ld=c;this.wBd=h;this.Nqa=m;this.Pha=y;this.Mk=G;this.yh=U;this.Yr=ja;this.tf=va;this.xNa=Ta;this.Zaa=fb;this.RB=Db;this.LV=gc;this.Epb=hc}FS(a){this.Ue=a}XUd(a,b,c){if(this.xNa.wAj||this.kK.N7b||!b)return!1;if(this.VKd.Rsh)return!0;b=this.ld.Vp(D.a.typing);b.properties.$(de.a.source,"Composition");a=this.xvi(a,c);
b.end();return a}xvi(a,b){this.wBd.correctBadImeState()&&this.Nqa.Wnc(D.a.rvl);this.Pha.fixupAfterMagnifierDrag();if(this.LV.Ifd(a))return!1;this.Mk.Nle=(new Date).getTime();if(1===this.yh.mode){let c;({B3:b,CMb:c}=this.LV.kDh(a,b));if(b)return c}this.Yr.isComposing=!0;this.Epb||this.tf.oaa(!0);a.eventName===ra.a.YUd&&this.Zaa.raiseEvent(Zc.a.sFf,a);this.RB.kPa(a);return!1}Q_b(a,b,c){this.Epb&&this.Ue&&this.Ue.Ps(!0,!0);return this.XUd(a,b,c)}P_b(a,b,c){this.XUd(a,b,c);return this.Yr.isComposing=
!1}}Object(n.a)(Yf,"CompositionEventProcessor",null,[]);class Vc{constructor(a,b,c){this.VBd=!1;this.Zaa=a;this.Bp=b;this.R6=c}get isComposing(){return this.VBd}set isComposing(a){(this.VBd=a)?(this.Zaa.raiseEvent(Zc.a.yvi),this.Bp.raiseEvent(kd.a.qAj)):(this.Zaa.raiseEvent(Zc.a.vvi),this.Bp.raiseEvent(kd.a.oAj))}get tFa(){return!this.isComposing&&!this.R6.rbg}}Object(n.a)(Vc,"CompositionStateManager",null,[]);var zc=d(133),vf=d(89);class Tg{constructor(a,b,c){this.XSh=u.AFrameworkApplication.fa.ka("AccessibilityNotificationEnabledViaAriaLiveRegion");
this.rBa=this.gzd=this.rMd=this.$za=this.wyd=null;this.jqb=a;this.PH=b;this.zpa=c;this.render();this.zpa.jcd&&this.PH.IK(Object(F.a)(this,this.Wbd,"modeSwitched"))}Wbd(){this.zpa.Pth&&this.lnd(!0);this.cQf()}get nu(){return this.rMd}get contentWindow(){return qd.a.Ldj(this.jqb.ownerDocument)}get contentDocument(){return this.jqb.ownerDocument}get xza(){return this.jqb}get Qn(){return this.gzd}get mJh(){return this.rBa}get isValid(){return!0}initialize(a,b){this.$za=a;this.$za.gRd=Object(F.a)(this,
this.onBlur,"onBlur");b()}tkh(){this.nu.style.left="0px";this.nu.style.top="0px"}xQi(){this.$za&&this.$za.pRi(this,this.PH)}Ona(){}vsd(){C.FocusManager.Sr(this.contentWindow)}XCh(){C.FocusManager.Wul(this.Qn)}get Njb(){return!qd.a.OGj(this.Qn)}set Njb(a){}USe(a,b,c){this.Qn.setAttribute(zc.a.gs,a);this.wyd&&(this.wyd.innerText=b);this.hpc(c)}hpc(a){a&&this.Qn.setAttribute(zc.a.af,a)}lnd(a){if(v.a.Dj||a)a=!this.zpa.Yge&&a,this.Qn.setAttribute("contenteditable",a?"true":"false"),this.zpa.Pth?(Sys.UI.DomElement.addCssClass(this.Qn,
"WACEditing"),Sys.UI.DomElement.addCssClass(this.Qn,I.AppFrame.sOf),Sys.UI.DomElement.addCssClass(this.Qn,"EditingSurfaceBody")):(Sys.UI.DomElement.removeCssClass(this.Qn,"WACEditing"),Sys.UI.DomElement.removeCssClass(this.Qn,I.AppFrame.sOf),Sys.UI.DomElement.removeCssClass(this.Qn,"EditingSurfaceBody"))}dispose(){this.twl();this.nu&&(this.nu.parentNode&&this.nu.parentNode.removeChild(this.nu),this.gzd=this.rMd=null)}render(){const a=String.format("{0}_EditingElement",this.jqb.id),b=String.format("{0}_WrappingDiv",
a);this.rMd=document.createElement("div");this.nu.id=b;this.nu.style.height="0px";this.nu.style.width="0px";this.nu.style.display="none";Fc.App.instance.gYc&&Sys.UI.DomElement.addCssClass(this.nu,"NoPointer");this.gzd=document.createElement("div");this.Qn.id=a;this.Qn.setAttribute("contenteditable",!this.zpa.Yge);this.Qn.setAttribute("spellcheck","false");v.a.Eka&&this.contentDocument.execCommand("AutoUrlDetect",!1,!1);this.N4k();this.cQf();vf.c(this.Qn,!0);vf.c(this.nu,!0);this.rBa=document.createElement("div");
this.nu.appendChild(this.Qn);this.jqb.appendChild(this.nu)}cQf(){if(this.Qn){const a=String.format("{0}_WACEditing_DescribedByElement",this.jqb.id),b=this.zpa.Y2h;this.zpa.Yge?this.Qn.setAttribute("tabindex","0"):this.Qn.removeAttribute("tabindex");if(!this.XSh){const c=J.a.instance.ga(81)?Box4Intl.Box4Strings.l_EditingSurfaceF2ScreenReaderDescribedByMessage:zc.a.k3i();this.wyd=zc.a.xuf(this.nu,this.Qn,a,c);this.USe(b,c,null)}}}N4k(){v.a.Dj?Sys.UI.DomElement.addCssClass(this.Qn,"InternetExplorer"):
v.a.fg?Sys.UI.DomElement.addCssClass(this.Qn,"FireFox"):v.a.zua&&Sys.UI.DomElement.addCssClass(this.Qn,"Safari");v.a.Ni?Sys.UI.DomElement.addCssClass(this.Qn,"iPad"):Sys.UI.DomElement.addCssClass(this.Qn,"usehover")}twl(){this.$za&&(this.$za.swl(this,this.PH),this.$za=null)}onBlur(a){this.$za.bpg(a);this.$za.Fxf(a)}Ahk(){this.nu.style.width="0px";this.nu.style.height="0px"}bEe(a){a=a.htmlElement;this.nu.parentNode!==a.parentNode&&a.parentNode&&a.parentNode.insertBefore(this.nu,a)}Ntl(a){if(a&&"DIV"===
a.tagName){var b=a.childNodes;for(let c=0;c<b.length;c++)if("TBODY"===b[c].tagName||"TR"===b[c].tagName){for(b=a.ownerDocument.createElement("TABLE");a.hasChildNodes();)b.appendChild(a.firstChild);La.a.aCa(a);a.appendChild(b);break}}}}Object(n.a)(Tg,"ContentEditableDiv",null,[1469,106]);class bb{create(a,b,c){return new Tg(a,b,c)}}Object(n.a)(bb,"ContentEditableDomFactory",null,[1437]);var Vb=d(75);class Ub{constructor(a,b){this.yd=a;Ub.$a=b}dYc(a){return Sys.UI.DomElement.containsCssClass(a,"PageBreakBlob")}bPi(a,
b){a=La.a.sv(a);const c=ta.a.EFa(a,b-1);return(b=a.substr(c+1,b-c-1))&&(ta.a.V8(b)||ta.a.R8b(b))?!0:!1}n5d(a,b,c){try{if(3===a.nodeType)return a.nodeValue}catch(m){return b.Wb("FailedToRetrieveText",{["Reason"]:"GetTextCrashed"}),c.o++,""}if("IMG"===a.tagName)return Za.nbg;if("BR"===a.tagName)return Za.Qxf;if(this.Ugg(a)&&(u.AFrameworkApplication.CL("Microsoft.Office.Web.SessionSettings.IWacWoncaSkipPictureDescriptionWhenGettingElementTextSettings"),Ub.$a.ka("SkipPictureDescriptionWhenGettingElementTextIsEnabled")))return"";
let h="";for(let m=0;m<a.childNodes.length;m++)h+=this.n5d(a.childNodes[m],b,c);return h}H5f(a,b,c,h){try{if(3===a.nodeType){var m=a.nodeValue;m=a.nodeValue;return m.length}}catch(y){return ba.ULS.sendTraceTag(51463192,324,15,y.message),c.Wb("PossibleIncorrectIpPosition",{["Reason"]:"TextLengthForSelectionRecursiveBadNode"}),b.bs++,-1}if(Ub.YYc(a))return this.jaj(a);if(Sys.UI.DomElement.containsCssClass(a,"LineBreakBlob"))return 1;m=0;"IMG"===a.tagName&&(m=h?m+1:m+3);if(this.Ugg(a)&&(u.AFrameworkApplication.CL("Microsoft.Office.Web.SessionSettings.IWacWoncaSkipPictureDescriptionWhenGettingElementTextSettings"),
Ub.$a.ka("SkipPictureDescriptionWhenGettingElementTextIsEnabled")))return 0;this.dYc(a)&&(m+=Za.KMc+Za.zZd);for(let y=0;y<a.childNodes.length;y++){const G=this.H5f(a.childNodes[y],b,c,h);if(0<=G)m+=G;else return a.innerText.length}return m}Ugg(a){return void 0===a.parentNode||null===a.parentNode?!1:Sys.UI.DomElement.containsCssClass(a.parentNode,"WACImageContainer")&&"SPAN"===a.tagName&&Sys.UI.DomElement.containsCssClass(a,"WACAltTextDescribedBy")}NTj(a){return Sys.UI.DomElement.containsCssClass(a,
wb.a.knl)}jaj(a){return(a=a.querySelector(".RawEquation"))?parseInt(a.getAttribute("data-length")):Vb.AParagraphNode.f_.length}BI(a,b,c,h){try{if(3===a.nodeType){let m=a.nodeValue;m=a.nodeValue;return m.length}}catch(m){return c.Wb("PossibleIncorrectIpPosition",{["Reason"]:"TextLengthForSelectionBadNode"}),b.br++,0}return this.H5f(a,b,c,h)}qYf(a,b,c,h,m){let y=0;const G=a.gt;for(let U=0;U<G.length;U++){a=G[U];const ja=this.BI(a,h,c,m);if(b<y+ja)return b-=y,c=a.innerText,b>=c.length?0:ta.a.charCodeAt(c,
b);y+=ja}h.bt++;return 0}A7d(a,b,c,h,m,y){if(void 0===a||null===a)return m.Wb("IncorrectIpPosition",{["Reason"]:"NoOffsetFromNullElement"}),h.bi++,ba.ULS.sendTraceTag(51463193,324,15,"NoOffsetFromNullElement when trying to get position"),0;if(!b)return ba.ULS.sendTraceTag(18437279,324,15,"GetParagraphCpFromElementOffset found null ParagraphElement when trying to get position"),0;let G=0;if(3===a.nodeType)G=c;else for(var U=0;U<c;U++)G+=this.BI(a.childNodes[U],h,m,y);for(;a!==b;){U=a;a=a.parentNode;
if(!a){ba.ULS.sendTraceTag(51463195,324,15,"GetParagraphCpFromElementOffset found null parent when trying to get position");m.Wb("IncorrectIpPosition",{["Reason"]:"NoOffsetFromNullParent"});h.bj++;if(u.AFrameworkApplication.fa&&(u.AFrameworkApplication.fk("Microsoft.Office.Web.SessionSettings.IWacWordInvalidCaretPositionFixSettings"),u.AFrameworkApplication.fa.ka("InvalidCaretPositionFixIsEnabled")))return 0;break}this.dYc(U)&&(G+=Za.KMc);let ja=0;for(;ja<a.childNodes.length&&a.childNodes[ja]!==U;)G+=
this.BI(a.childNodes[ja],h,m,y),ja++;if(ja===a.childNodes.length)if(3===U.nodeType)G=c;else return m.Wb("IncorrectIpPosition",{["Reason"]:"NoOffsetFromSelectionNotInDom"}),h.bk++,ba.ULS.sendTraceTag(51463196,324,15,"The current selection is in a non-text node that is not in the editing view's DOM."),0}return G}Ofg(a){return La.a.s2b(a)}static get instance(){Ub.Ka||(Ub.Ka=new Ub(Lc.a.instance,u.AFrameworkApplication.fa));return Ub.Ka}static YYc(a){return Sys.UI.DomElement.containsCssClass(a,wb.a.Rfk)||
Sys.UI.DomElement.containsCssClass(a,wb.a.RRi)||Sys.UI.DomElement.containsCssClass(a,wb.a.BOi)}}Ub.Ka=null;Ub.$a=null;Object(n.a)(Ub,"ContentEditableViewDomUtils",null,[1434]);class Jc{constructor(a,b){this.gBd=null;this.nd=a;this.Mk=b}Zsd(){return 1<this.u7i()||this.P9f(this.gBd,this.c_f())}aoc(){const a=this.c_f();this.gBd=a?a.cloneNode(!0):null}u7i(){if(this.nd){const a=this.nd.om();if(a&&a.childNodes)return a.childNodes.length}return 0}c_f(){if(this.nd){const a=this.nd.om();if(a)return a.firstChild}return null}P9f(a,
b){if(!a&&!b)return!1;if(!a||!b)return!0;try{return this.fwj(a,b)}catch(c){return ba.ULS.sendTraceTag(17134560,324,15,"HasDifferentHtmlStructure ex: {0}",c),!0}}fwj(a,b){if(ta.a.og(a.nodeName)!==ta.a.og(b.nodeName))return!0;if(a.childNodes.length!==b.childNodes.length&&(!v.a.fg||a.childNodes.length!==b.childNodes.length-1||"BR"!==ta.a.FB(b.childNodes[b.childNodes.length-1].nodeName))){var c=!a.childNodes.length||3===a.childNodes[0].nodeType;for(var h=0;c&&h<b.childNodes.length;h++)c=3===b.childNodes[h].nodeType&&
c;if(c)return!1;c=b.childNodes.length;for(h=0;h<b.childNodes.length;h++)3!==b.childNodes[h].nodeType||b.childNodes[h].nodeValue.length||c--;return c!==a.childNodes.length}for(c=0;c<a.childNodes.length;c++)if((!Ub.YYc(a.childNodes[c])||!Ub.YYc(b.childNodes[c]))&&this.P9f(a.childNodes[c],b.childNodes[c]))return!0;return!1}OXi(a,b){if(v.a.JI&&J.a.instance.ga(98)){b.Wb("PossiblyIncorrectTypedText",{["Reason"]:"FixEOPSpanforAndroidChrome"});b=La.a.Pca(this.gBd,"EOP");const c=La.a.Pca(a.firstChild,"EOP");
b&&!c&&a.firstChild&&a.firstChild.appendChild(b.cloneNode(!0))}}}Object(n.a)(Jc,"ContentEditableHtmlStructureUtils",null,[]);class Mc{constructor(){this.OVh=u.AFrameworkApplication.fa.ka("MoveToIpModeInReadOnlyView")}get mode(){return u.AFrameworkApplication.Ta.mode}get jcd(){return this.OVh}get Pth(){return this.jcd?!0:1!==u.AFrameworkApplication.Ta.mode||Fc.App.jzb&&u.AFrameworkApplication.yT}get Y2h(){switch(this.mode){case 3:return Box4Intl.Box4Strings.l_EditingSurfaceScreenReaderTitleMessage;
case 2:return Box4Intl.Box4Strings.l_ReviewingSurfaceScreenReaderTitleMessage}return Box4Intl.Box4Strings.l_ReadingSurfaceScreenReaderTitleMessage}get Yge(){return this.jcd?1===u.AFrameworkApplication.Ta.mode||Fc.App.jzb&&u.AFrameworkApplication.yT:Fc.App.jzb&&u.AFrameworkApplication.yT?!(Fc.App.DZb||Fc.App.T9b):1===u.AFrameworkApplication.Ta.mode}get Xod(){return this.jcd?1===u.AFrameworkApplication.Ta.mode||Fc.App.jzb&&u.AFrameworkApplication.yT:Fc.App.jzb&&u.AFrameworkApplication.yT}}Object(n.a)(Mc,
"ContentEditableModeHelper",null,[1386]);var ed=d(189),dd=d(33);class je{static wAi(a){const b={};for(let c of a)a=0,c in b&&(a=b[c]),b[c]=a+1;return dd.c(b)}}Object(n.a)(je,"CommonActivityAggregationMethods",null,[]);var Nd=d(1006),Ld=d(1019),Xe=d(568),pe=d(286),fe=d(265),wd=d(91);class Ue{constructor(){this.gRd=this.bpg=this.Fxf=this.eNc=this.Ffa=this.PCe=this.Mfb=this.BKb=this.n_a=this.POd=this.u0e=this.v0e=this.bC=this.K7a=this.ZB=this.W1b=this.i0b=this.XXd=this.Gkc=this.b2b=this.XCa=this.YCa=
this.Ikb=this.P_b=this.ZUd=this.Q_b=this.fbb=this.BFa=this.Sz=null;this.Q6=this.Rvd=this.Vyd=this.IId=this.GBd=this.WKd=this.Mxd=!1}pRi(a,b){if(!this.Q6){this.Q6=!0;var c=Xe.a.instance,h=b.kG,m=b.LR,y=b.Okb,G=b.By,U=pe.a.instance,ja=b.mga,va=fe.a.instance,Ta=b.Brd,fb=b.yrd;v.a.Ni&&(Fd.EventHandlerManager.instance.VPk(this.POd),this.Rvd=!0);b.nia(this.Ffa);this.bPk(a.Qn,h,m,G,y,va,ja,U,c,Ta,fb)}}swl(a,b){if(this.Q6){var c=Xe.a.instance,h=b.kG,m=b.LR,y=b.Okb,G=b.By,U=pe.a.instance,ja=b.mga,va=fe.a.instance,
Ta=b.Brd,fb=b.yrd;this.Rvd&&(Fd.EventHandlerManager.instance.vwl(this.POd),this.Rvd=!1);b.PZa(this.Ffa);this.pwl(a.Qn,h,m,G,y,va,ja,U,c,Ta,fb);this.Q6=!1}}bPk(a,b,c,h,m,y,G,U,ja,va,Ta){b.Kp(a);c.Kp(a);h.Kp(a);m.Kp(a);y.Kp(a);wd.a.addHandler(a,ra.a.paste,this.Gkc);wd.a.addHandler(a,ra.a.cut,this.XXd);wd.a.addHandler(a,ra.a.copy,this.i0b);!Ue.uRj&&v.a.fg&&(wd.a.addHandler(a,ra.a.VZd,this.W1b),this.Vyd=!0);wd.a.addHandler(a,ra.a.blur,this.gRd);h.pb(ra.a.click,a,this.ZB);2===Fc.App.mode?G.GJ(a,this.eNc,
!0):G.GJ(a,this.eNc);U.pb(a,this.bC);m.pb(ra.a.o6,a,this.v0e);m.pb(ra.a.z1,a,this.u0e);c.pb(ra.a.mouseDown,a,this.Mfb,null);c.pb(ra.a.xJ,a,this.PCe,null);b.pb(ra.a.Hl,a,this.BFa);b.pb(ra.a.ey,a,this.fbb);b.pb(ra.a.Zf,a,this.Sz);b.pb(ra.a.KPa,a,this.Sz);h.pb(ra.a.doubleClick,a,this.K7a);wd.a.addHandler(a,ra.a.scroll,this.n_a);if(v.a.dZe||v.a.fg)Ta.pb(ra.a.rFf,a,this.Q_b,this),Ta.pb(ra.a.YUd,a,this.ZUd,this),Ta.pb(ra.a.WUd,a,this.P_b,this),this.Mxd=!0;Fc.App.pRd&&v.a.Lyh||v.a.to?(va.pb(ra.a.input,a,
this.Ikb,this),this.GBd=!0):v.a.hZe&&(va.pb(ra.a.v_e,a,this.Ikb,this),this.WKd=!0);ja.pb(ra.a.drop,a,this.YCa);v.a.pua&&(ja.pb(ra.a.L7a,a,this.XCa),ja.pb(ra.a.ZNf,a,this.b2b),this.IId=!0);ja.pb(ra.a.AKb,a,this.BKb)}pwl(a,b,c,h,m,y,G,U,ja,va,Ta){wd.a.removeHandler(a,ra.a.paste,this.Gkc);wd.a.removeHandler(a,ra.a.cut,this.XXd);wd.a.removeHandler(a,ra.a.copy,this.i0b);this.Vyd&&(wd.a.removeHandler(a,ra.a.VZd,this.W1b),this.Vyd=!1);wd.a.removeHandler(a,ra.a.blur,this.gRd);h.yb(ra.a.click,a,this.ZB);G.XE(a,
this.eNc);U.yb(a,this.bC);m.yb(ra.a.o6,a,this.v0e);m.yb(ra.a.z1,a,this.u0e);c.yb(ra.a.mouseDown,a,this.Mfb);c.yb(ra.a.xJ,a,this.PCe);b.Vq(a);c.Vq(a);h.Vq(a);m.Vq(a);y.Vq(a);b.yb(ra.a.Hl,a,this.BFa);b.yb(ra.a.ey,a,this.fbb);b.yb(ra.a.Zf,a,this.Sz);b.yb(ra.a.KPa,a,this.Sz);h.yb(ra.a.doubleClick,a,this.K7a);wd.a.removeHandler(a,ra.a.scroll,this.n_a);this.Mxd&&(Ta.yb(ra.a.rFf,a,this.Q_b),Ta.yb(ra.a.YUd,a,this.ZUd),Ta.yb(ra.a.WUd,a,this.P_b),this.Mxd=!1);this.WKd&&(va.yb(ra.a.v_e,a,this.Ikb),this.WKd=
!1);this.GBd&&(va.yb(ra.a.input,a,this.Ikb),this.GBd=!1);ja.yb(ra.a.drop,a,this.YCa);this.IId&&(ja.yb(ra.a.L7a,a,this.XCa),ja.yb(ra.a.ZNf,a,this.b2b),this.IId=!1);ja.yb(ra.a.AKb,a,this.BKb)}static get uRj(){null==Ue.RCd&&(Ue.RCd=u.AFrameworkApplication.fa.ka("RemoveDomSubtreeModifiedEventHandlerIsEnabled"));return Ue.RCd}}Ue.RCd=null;Object(n.a)(Ue,"ContentEditableSurfaceEventHandlers",null,[]);var rd=d(60),Ud=d(118),qe=d(827),Nf=d(136),sf=d(257);class tf extends Ld.a{constructor(a,b,c,h,m,y,G,U,
ja,va,Ta,fb,Db,gc,hc,Gc,Pc,yc,Vd,De,Wd,Ve,$e,Qf,lg,Hg,Qg,Sf,sh,Xg,ni,Ri,uj,dj,ej){super(dj);this.PBc=null;this.rNc=this.evb=this.u1b=this.QU=!1;this.Lf=a;this.Tc=b;this.Nk=c;this.Gt=G.create(this);this.Nmb=Qg;this.nd=U;this.zpa=ej;y.ya(D.a.eMf,xb.a.application,ed.ActionManager.Jg);y.ya(D.a.fMf,xb.a.application,ed.ActionManager.Jg);h.execute(Ei=>{Ei.jIi(D.a.typing,de.a.O9g);Ei.WSe(D.a.typing,de.a.source,je.wAi)});m&&m.execute(Ei=>{Ei.qIl(Object(F.a)(this,this.axa,"onZoomChanged"))});this.Bp=va;this.Ipa=
yc;this.hJd=Db;this.kK=Ta;this.zK=gc;this.zK.init(this.Ma);this.d2=hc;this.tf=Gc;this.Mk=fb;this.Ob=ja;this.Ob.init(this.Ma);this.yh=Vd;this.Z3a=De;this.Rs=Pc;this.oOa=Wd;this.RH=Qf;this.Yr=Ve;this.RB=lg;this.xNa=$e;this.LV=Hg;this.tOh=Sf;this.uOh=sh;this.MPh=Xg;this.sOh=ni;this.qha=Ri;this.rOh=uj;this.qha.L8h(Object(F.a)(this,this.F1g,"onBindEditingDom"));this.qha.c9h(Object(F.a)(this,this.N6g,"onUnbindEditingDom"));this.qha.t8h(Object(F.a)(this,this.Ach,"pushViewElementValidationStates"));this.qha.s8h(Object(F.a)(this,
this.G3g,"onInteractiveViewOnAfterLoadContent"));this.k7e=!!u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.ka("ChromiumEdgeUIPasteForPPTIsEnabled")&&v.a.IXc;this.K9e=!!u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.ka("ElectronClipboardAccessFix")&&v.a.uT}get Ld(){return this.If.Ld}dispose(){this.qha.wTk(Object(F.a)(this,this.F1g,"onBindEditingDom"));this.qha.ITk(Object(F.a)(this,this.N6g,"onUnbindEditingDom"));this.qha.pTk(Object(F.a)(this,this.Ach,"pushViewElementValidationStates"));
this.qha.oTk(Object(F.a)(this,this.G3g,"onInteractiveViewOnAfterLoadContent"));this.sOh.dispose();super.dispose()}axa(){this.Sfa=!0}get ownerDocument(){const a=this.nd.KDa();return a?a.Rl:null}get container(){return this.lRa}get rVd(){return this.Qn}createElement(a){a=this.ownerDocument.createElement(a);this.nd.Ag.mJh.appendChild(a);return a}hp(a){a=Xb.a.createElement(this.ownerDocument,a);this.nd.Ag.mJh.appendChild(a);return a}RBa(){throw Error.notImplemented("BindToContainer doesnt mean anything for ContentEditableView yet--we shouldn't be calling it!");
}OEe(){this.Bp.raiseEvent(kd.a.FOi);this.rNc=!0}get lRa(){return this.nd.Ag?this.nd.Ag.nu:null}get Qn(){return this.nd.om()}get Jyb(){return!0}zsi(){this.d2.bJc()}get QZc(){return this.Yr.tFa}get isComposing(){return this.Yr.isComposing}ODk(){this.k7e||this.K9e?this.oOa.Rah(!0,""):(this.disable(!1,24),this.lnd(!0),v.a.hx&&(this.lRa.style.overflow="hidden"),this.lRa.style.width="0px",this.lRa.style.height="0px",this.lRa.style.display="block",this.Bp.raiseEvent(kd.a.wyk),this.d2.bJc(),this.zK.oKa(this.yh.mode,
this.Ob.Hi,this.Ob.Dg,this.Ob.Vh,this.Nk.value.isEditingAllowed||this.Nk.value.Wy))}Hol(){this.k7e||this.K9e?this.oOa.Mkh("none"):v.a.hx&&this.lRa&&(this.lRa.style.overflow="none")}Ps(a,b=!1){this.RH.Ps(a,b)}SY(){this.Rs.SY()}get Vl(){return!0}rga(a,b){if(1===this.mode&&17!==a.ri){const c=a.currentNode;if(!me.a.instance.Pa.eH&&!c.ezb(me.a.instance.Pa.Pr)&&6!==a.role)return!1}return super.rga(a,b)}get GF(){let a=super.GF;switch(this.mode){case 2:a|=450;break;case 1:a|=448;break;case 0:a|=511}return a}get Ftb(){const a=
u.AFrameworkApplication.fa.ka("EditingViewDelayUpdateFixIsEnabled");return a&&!this.QZc?2:this.root&&this.ownerDocument&&this.isActive&&!this.Ipa.b9?a||this.QZc?1:2:3}fY(a){return this.uOh.fY(a)}J0(a){return this.tOh.J0(a)}rXd(){return new qe.a(this.Ma)}TEe(a){!u.AFrameworkApplication.Tg&&0!==this.mode&&this.If&&this.If.so&&(this.P0j(a),this.Tc.tge())}P0j(a){if(a){var b=a.KA;a=this.lXf(a.Ou,!0);b=this.lXf(b,!1);ba.ULS.sendTraceTag(38396191,324,50,"Parent : [{0}] Child : [{1}]",a,b)}}lXf(a,b){let c=
"";a&&(a=a.node)&&(c+="nodeId : "+a.id+"; type : "+a.type+"; ",Ob.ParagraphReader.Yd(a)&&(c+="paraId : "+Ob.ParagraphReader.f5b(a)+"; ",c+="hasImage : "+Ud.a(a,5)+";"),b&&(b=rb.GraphIterator.nb(a),b.gf(),c+="inTable : "+rd.TableReader.ys(b)+";"));return c}hGe(a){!u.AFrameworkApplication.Tg&&1===this.mode&&a&1&&this.If&&this.If.so&&this.Tc.TGe()}lnd(a){this.nd.F_a(a)}kbb(a,b,c){this.Nmb.kbb(a,b,c)}PNc(){this.xNa.PNc()}i9k(){this.hJd.$Rf(me.a.instance.Pa)}Uib(){this.zK.Uib(this.mode,this.Ob.Hi,this.Ob.Dg,
this.Ob.Vh,this.Nk.value.isEditingAllowed||this.Nk.value.Wy)}oKa(){this.zK.oKa(this.mode,this.Ob.Hi,this.Ob.Dg,this.Ob.Vh,this.Nk.value.isEditingAllowed||this.Nk.value.Wy)}get Dg(){return this.isActive?this.Ob.Dg:null}get mode(){return this.yh.mode}get isActive(){return this.tf.isActive}get cUa(){return this.tf.W4b(this.Ob.Dg)}get ike(){return this.tf.O0f(this.Ob.Dg)}get If(){return this.Lf.Rd}get GHe(){return this.Z3a.nGf}get uya(){return this.xNa.uya}set uya(a){this.xNa.uya=a}get Sfa(){return this.Rs.Sfa}set Sfa(a){this.Rs.Sfa=
a}get Rhe(){return!0}get EPe(){return 2}get Xod(){const a=this.Nk.value.isEditingAllowed||this.Nk.value.Wy;return this.zpa.Xod?a:!0}get jJa(){return this.oOa.jJa}get htb(){return this.Mk}get vvl(){return this.RB}get Cyi(){return this.Nmb}get nAj(){return this.xNa}get nwk(){return this.LV}gac(a){return sf.a.tng(a,this)}EJb(a){return sf.a.Lih(a,this)}Pnc(a){return sf.a.Zih(a,this)}Zhc(a){return sf.a.jYg(a,this)}jsb(a){return sf.a.yAf(a,this)}Uoc(a){return sf.a.Tnh(a,this)}J3b(a){return sf.a.VUf(a,this)}LYb(a){return sf.a.Rwf(a,
this)}CKj(){switch(this.mode){case 2:if(this.Ob.Dg)return this.DKj(this.Ob.Dg)}return!1}DKj(a){a=Nf.a.nb(this.Ma,a.node);return a.Tq&&a.gf()?a.OQa.dY(510&~this.GF):!0}F1g(a,b){this.vxf(b.Ag)}N6g(){this.nd.Ivl()}MCj(a,b,c,h){a=this.rOh.create(a,b,this.zpa);b=new Ue;b.eNc=c;this.MPh.IAk(b);a.initialize(b,h);return a}vxf(a){this.nd.fhi(a,this)}disable(a,b){this.yh.naa(0,a,b)}A0a(){this.yh.A0a()}suspend(){this.Ipa.suspend()}resume(){this.Ipa.resume()}Ach(a,b){this.Lf.Rd===b.If&&(this.PBc=this.fMa,this.fMa=
new Nd.a(0))}AAk(){const a=this.PBc,b=this.fMa;for(let c=0;c<b.keys.length;++c){const h=b.keys.ga(c);let m;a.$(m=h,a.ga(m)|b.ga(h))}this.fMa=a;this.PBc=null}FDf(){this.PBc=null}kWe(a){return 1!==this.mode||a.wy||this.If.Lb.Pa.eH?!1:!0}hle(a,b){return this.If.Lb&&!this.If.Lb.Pa.eH&&b?a.wy!==b.Fke:!0}G3g(a,b){this.Lf.Rd===b.If?this.AAk():this.Lf.Rd||this.FDf()}}Object(n.a)(tf,"ContentEditableView",Ld.a,[565,167,106,1436]);class Lf{constructor(a,b,c,h,m,y){this.ld=a;this.eg=b;this.kj=c;this.Wo=h;this.Lf=
m;this.pr=y}afg(a){return Sys.UI.DomElement.containsCssClass(a,wb.a.ZFf)}}Object(n.a)(Lf,"ContentEditableViewContentControlHelper",null,[1385]);var kf=d(398),Ed=d(126),Cd=d(117),oh=d(828);class Kg{constructor(a,b,c,h,m){this.M_b=!1;this.JHe=this.Hfd=-1;this.tF=a;this.lge=b;this.vHc=c;this.aTa=h;this.SYa=m}}Object(n.a)(Kg,"ActiveContentSpan",null,[]);class ri{constructor(a,b,c,h,m,y,G,U,ja,va,Ta,fb,Db,gc,hc,Gc,Pc,yc,Vd,De,Wd,Ve,$e){this.cha=this.hRb=null;this.f9=!1;this.Rmf=0;this.iyd=Wd;this.Lf=a;
this.ld=b;this.eg=c;this.kj=h;this.Tc=m;this.hf=y;this.nK=G;this.yh=U;this.Ob=ja;this.Nk=va;this.lpa=Ta;this.tf=fb;this.Wd=Db;this.yd=gc;this.Ui=hc;this.Wo=Gc;this.Dh=Pc;this.kK=yc;this.nd=Vd;this.rD=De;this.yA=$e}get Mca(){return this.cha||(this.cha=vb.a.instance.rb("Box4.IFormatPainter"))}ghi(a){this.hRb=a}get yxh(){return this.Rmf}PHi(a,b,c){const h=this.Lf.Rd;if(!h)return!1;h.OFe();if(2!==this.yh.mode)return this.ld.Wb("PossibleFocusWeirdness",{["Reason"]:"ClickOnHiddenEditingFrame"}),this.eg.be++,
!1;if(this.kj&&b)return this.ld.Wb("DisallowedClickDuringDictation",{["Reason"]:"CursorPositioningClick"}),this.eg.bf++,!0;if(3!==a.Yf&&a.lA===Sys.UI.MouseButton.rightButton&&this.yd.fg)return Fc.App.Kb.Aaa.yXi(a.pc.rawEvent),!0;if(!h)return!1;b=h.Hja(a);if(3===a.Yf){var m=this.Tc.Pa.mb;if(this.hf.gx(m)){var y=m.Ua.node.tg(h.Ma);m=this.yA?this.yA.tQa(m.Ua,!0):m.Ua.Qa;y=W.a.QZ(m,y,!!m,!1,!1);y=new Sys.UI.Bounds(y.x-7,y.y,14,y.height);if(kf.a.Ggd(b,y))return Fc.App.Kb.V5(b,3),!0}}if(!c)return!0;this.Ui.WKf(this.yh,
this.Ob);C.FocusManager.KM()&&(C.FocusManager.instance().xf(h.vI),this.kK.setFocus(this.yh.mode,this.Ob.Hi,this.Ob.Dg,this.Ob.Vh,this.Nk.value.isEditingAllowed||this.Nk.value.Wy));(c=vf.a(a.Cc))?(this.hRb.Ps(!0),h.r6(a.clientPoint,c,c.gb,h,a.pc.rawEvent.shiftKey,a.XZ,a.Yf)):h.r6(b,null,null,h,a.shiftKey,a.XZ,a.Yf);this.Mca&&this.Mca.oL&&this.lpa.processAction(D.a.Bja,2);this.hRb.kbb(a.shiftKey,b,a.Yf);h.kFe(new oh.a(a));this.yd.JI&&(a=new He.a(0,1,0,()=>{this.tf.CKa(!0);this.fixupAfterCursor(5)},
27),this.Wd.Eb(a));return!0}yZe(a,b=!1){if(2===this.yh.mode&&this.Ob.Vh){var c=this.nd.Ag.nu;if("0px"!==c.style.height&&"0px"!==c.style.width||!this.yd.bke){c=this.Tc.Pa.mb;var h=!!this.nK&&this.nK.C$a();this.kj&&a?(this.ld.Wb("MomentaryIncorrectIpPosition",{["Reason"]:"NoSynchronizeCursorDuringDictation"}),this.eg.bm++):(this.r5k(b||h,this.Ob.Vh.gt,this.Tc.Pa.mb.Ua),h&&this.nK.RZe(c))}}}r5k(a,b,c){let h=0,m=0;c=c.Qa;let y=!1;for(let G=0;G<b.length;G++){const U=b[G],ja=this.Wo.BI(U,this.eg,this.ld,
this.kj);if(Sys.UI.DomElement.containsCssClass(U,S.a.eW))h+=ja;else if(y||(this.Rmf=h,y=!0),Sys.UI.DomElement.containsCssClass(U,wb.a.hN))c--,h+=ja,m++;else{if(c<=ja){a||this.Ui.XS(h+c,this.Ob.Vh);this.Ymd(b,G,h,m,c);break}c-=ja;h+=ja;m+=ja}}}fixupAfterCursor(){if(2===this.yh.mode){var a=this.Ui.m8(this.yh.mode,this.Ob.Hi),b=0,c=0,h=this.Ob.Vh.gt,m;for(m=0;m<h.length;m++){const y=this.Wo.BI(h[m],this.eg,this.ld,this.kj);let G,U,ja;({K3:G,Aka:ja,ryb:U}=this.Tpi(h,m));if(a<=y&&this.aYi(h,m,a,G,ja,b,
c,U))return;a-=y;b+=y;G?c++:U||(c+=y)}this.ld.Wb("ActiveContentSpansOutOfSync",{["Reason"]:"FixupAfterCursorFailed"});this.eg.bq++}}aYi(a,b,c,h,m,y,G,U){const ja=a[b],va=this.Wo.BI(ja,this.eg,this.ld,this.kj);if(h||this.kj&&m)if(m||!this.f9&&c!==va){if(this.eg.bo++,this.Ui.XS(y,this.Ob.Vh),c=this.Wo.BI(a[b-1],this.eg,this.ld,this.kj),this.Ymd(a,b-1,y-c,G-c,c),m)return!0}else this.eg.bn++,this.Ui.XS(y+va,this.Ob.Vh),this.Ymd(a,b+1,y+va,G+1,0);else if(!U)return ta.a.jx(La.a.sv(ja),c)&&(this.eg.bp++,
this.Ui.XS(y+c+(this.f9?1:-1),this.Ob.Vh)),this.Ymd(a,b,y,G,c),!0;return!1}Tpi(a,b){let c,h;c=Sys.UI.DomElement.containsCssClass(a[b],wb.a.hN);h=Sys.UI.DomElement.containsCssClass(a[b],S.a.eW);a=Sys.UI.DomElement.containsCssClass(a[b],wb.a.vN);return{K3:c,Aka:a,ryb:h}}Ymd(a,b,c,h,m){const y=this.Ob.uW,G=a[b];Sys.UI.DomElement.containsCssClass(G,wb.a.vN)&&(ba.ULS.shipAssertTag(4318915,315,!1),this.ld.Wb(Ed.a.C1,{["Reason"]:Cd.a.KQf}));Sys.UI.DomElement.containsCssClass(G,wb.a.hN)&&(ba.ULS.shipAssertTag(4318916,
315,!1),this.ld.Wb(Ed.a.C1,{["Reason"]:Cd.a.zxf}));a=this.QDi(a,b,c,h,m,y);b=a.length!==this.Dh.Ei.length;for(c=0;!b&&c<this.Dh.Ei.length;)this.Dh.Ei[c].tF!==a[c].tF&&(b=!0),this.Dh.Ei[c].SYa!==a[c].SYa&&(b=!0),c++;b&&(this.hRb.cUa&&this.hRb.Ps(!0),this.Dh.Ei=a)}QDi(a,b,c,h,m,y){const G=a[b];var U=this.Wo.BI(G,this.eg,this.ld,this.kj);const ja=[];let va=null;b<a.length-1&&m===U&&(va=a[b+1]);var Ta=null;0<b&&!m&&(Ta=a[b-1]);a=this.iyd.ye(G,S.a.FFa);a=y.gt[a];Array.add(ja,new Kg(G,a,c,h,U-(this.rD.e7?
1:0)));!va||Sys.UI.DomElement.containsCssClass(va,wb.a.vN)||Sys.UI.DomElement.containsCssClass(va,wb.a.hN)?!Ta||Sys.UI.DomElement.containsCssClass(Ta,wb.a.vN)||Sys.UI.DomElement.containsCssClass(Ta,wb.a.hN)||Sys.UI.DomElement.containsCssClass(Ta,S.a.eW)||(a=this.iyd.ye(Ta,S.a.FFa),a=y.gt[a],U=this.Wo.BI(Ta,this.eg,this.ld,this.kj),Array.insert(ja,0,new Kg(Ta,a,c-U,h-U,U))):(a=this.iyd.ye(va,S.a.FFa),a=y.gt[a],Ta=this.Wo.BI(va,this.eg,this.ld,this.kj),Array.add(ja,new Kg(va,a,c+U,h+U,Ta)));return ja}}
Object(n.a)(ri,"ContentEditableViewCursorManager",null,[1435]);class Af{}Object(n.a)(Af,"ContentEditableViewDebugLogger",null,[]);class Zg{constructor(a,b,c,h,m,y,G){this.fqa=a;this.RB=b;this.Dh=c;this.qxc=h;this.eg=m;this.Zaa=y;this.yh=G}dispose(){this.fqa.rDf();this.RB.dispose();this.Dh.dDf();this.qxc.Imd();jc.a.instance.O_j(this.eg);this.Zaa.raiseEvent(Zc.a.i1j);this.yh.dispose()}}Object(n.a)(Zg,"ContentEditableViewDisposer",null,[]);class gi{constructor(){this.GMc=!0}kbb(a,b,c){a&&(this.GMc=!1,
Fc.App.Kb.V5(b,c))}}Object(n.a)(gi,"ContentEditableViewFloatieHandler",null,[1421]);var jg=d(1096),Hh=d(143);class hj{constructor(a,b,c,h,m,y,G){this.Qef=0;this.SYc=this.N7b=this.$be=this.dce=!1;this.nd=a;this.Lf=b;this.nK=c;this.kj=h;this.Jn=m;this.Lwd=y;this.Od=G}Ahi(){this.kj&&!this.N7b&&100<(new Date).getTime()-this.Qef&&(Hh.GrippersManager.instance.k7b=!0,this.SYc=!1)}setFocus(a,b,c,h,m){const y=this.Lf.Rd;this.Qef=(new Date).getTime();this.nK&&this.nK.C$a()||(1===a?this.k6k(m):this.kj&&!this.Jn.fce&&
Fd.EventHandlerManager.instance.VQf!==ra.a.click||!this.nd.Ag.Njb||(m=new jg.a(y),this.nd.Ag.vsd(),this.kj&&(this.N7b=!0,this.nd.om().blur(),this.N7b=!1),this.nd.Ag.XCh(),c&&h&&""!==b.innerText&&b.focus(),this.Lwd.Y8&&(this.SYc=!0),m&&m.dispose(),this.Lwd.Dj&&0!==a&&(this.nd.Ag.Njb=!1)))}k6k(a){if(!this.kj||a){a=null;v.a.Dj&&(a=new jg.a(this.Lf.Rd));this.nd.Ag.Njb&&(this.nd.Ag.vsd(),this.nd.Ag.XCh(),v.a.Dj&&(this.nd.Ag.Njb=!1),this.Lwd.Y8&&this.Jn.fce&&(this.SYc=!0));var b=this.nd.om();this.nd.Ag.Njb&&
b.firstChild&&3!==b.firstChild.nodeType&&b.firstChild.focus();a&&a.dispose()}}DQi(a){2!==a&&1!==a||this.nd.Ag.vsd()}mie(){const a=this.Od.Be;return!!a&&this.Lf.Rd.vI===a.name}}Object(n.a)(hj,"ContentEditableViewFocusHelper",null,[1422]);class Hk{constructor(a,b,c){this.x7b=a;this.qhb=b;this.Dra=c}}Object(n.a)(Hk,"GraphUpdateState",null,[]);var yd=d(51),ef=d(107);class yh{constructor(a,b,c,h,m,y,G,U,ja,va,Ta,fb,Db,gc,hc,Gc,Pc,yc,Vd,De,Wd,Ve,$e,Qf,lg,Hg,Qg,Sf,sh,Xg,ni){this.Ue=this.NQb=null;this.yk=
Xg;this.pr=sh;this.Vga=a;this.yh=b;this.ld=c;this.Tc=h;this.nK=m;this.hf=y;this.tf=G;this.rK=U;this.Ob=ja;this.Mk=va;this.rD=Ta;this.Dh=fb;this.nd=Db;this.tV=gc;this.XR=hc;this.Ipa=Gc;this.oZ=Pc;this.Pha=Vd;this.Ui=De;this.Z3a=Wd;this.Rs=Ve;this.eg=$e;this.R6=Qf;this.Wd=lg;this.yd=Hg;this.nha=Qg;this.NLh=Sf;this.Zg=yc;this.Fz=ni}FS(a){this.Ue=a}get nUc(){const a=this.oZ.fta(this.tV.f9);return a?a.Ua.Qa:0}get fii(){return this.nUc}Ps(a,b=!1){ba.ULS.shipAssertTag(18437283,315,!!this.Zg);if(this.Ue.cUa||
this.Ue.ike)if(this.Ue.vvl.typingProcess(),this.Ue.isActive&&2===this.yh.mode&&(this.Ue.cUa||this.Ue.ike)){var c=this.ld.Vp(D.a.Ps);this.Vga.cG(()=>{this.Ayl(a,b)},"ContentEditableView:UpdateGraphInternal");c.end()}}w6k(a,b=!1){const c=this.hf.yz;this.Tc.setSelection(a,void 0,void 0,b);this.hf.yz=c}Ayl(a,b=!1){ef.c(36226527,306,100,"UpdateGraphInternalCalled");this.tf.EXk();if(this.Ob.Vh){a=new Hk(!1,a,!1);a.qhb&&this.Ipa.suspend();this.Pha.fixupAfterMagnifierDrag();var c=this.rK.zSa();c.set(this.Ob.Dg.node);
var h=this.yk.le(b?12:15,D.a.Ps);h.jd=this.Mk.I2?D.a.QBa:D.a.typing;h.yy(c);this.rD.ndl(a.qhb,this.Ue.QZc,this.Dh)&&(this.eg.v++,this.rD.rjb(!1,this.Ob.Hi,this.Dh));var m=!!this.nK&&this.nK.C$a(),y=m?me.a.instance.Pa.mb:this.Hri();this.Bzk(a);this.wzl();this.rerenderWhenNeeded(b,a,c);m||this.lYi(b,y);this.Dh.dDf();h.dispose();this.jnl(a);this.Rs.Sfa&&(this.Rs.SY(),this.Rs.Sfa=!1);a.qhb&&this.Ipa.resume();this.Mk.H5();ef.c(18437313,306,100,"UpdateGraphInternalExited")}else ba.ULS.shipAssertTag(17884510,
315,!1,"CurrentEditingViewElement is NULL. Bail out updateGraph early!")}jnl(a){a.x7b||this.tV.yZe(this.Mk.wda,a.Dra)}rerenderWhenNeeded(a,b,c){!b.x7b||this.Mk.blg()||a||(this.yh.naa(0,!0,5),b.qhb&&(this.Ipa.resume(),b.qhb=!1),this.o8b(c.currentNode))}Hri(){this.Ui.updateCaretPosition(this.yh.mode,this.Ob.Hi);this.Z3a.Z2e();this.XR.OXi(this.nd.om(),this.ld);return this.oZ.fta(this.tV.f9)}lYi(a,b){const c=this.pr.textLength(b.Ua.node);b.Ua.Qa>c&&(b=yd.SelectionFactory.Qg(b.Ua.node,c));this.w6k(b,a);
a=!!this.nK&&this.nK.Fyb(b);this.Mk.blg()&&!a&&this.Ui.XS(this.Ui.XUa,this.Ob.Vh)}o8b(a){J.a.instance.ga(70)&&Fc.App.MR.o8b(a)}wzl(){if(J.a.instance.ga(2)){const a=mc.OutlineElementNavigator.PA(this.Ue.Dg);a&&Wb.ListReader.oUa(a)}}AYd(){if(this.Ue.cUa||this.Ue.ike)this.NQb?this.Wd.G5(this.NQb,yh.XKf):(this.NQb=new He.a(0,1,yh.XKf,Object(F.a)(this,this.delayUpdateGraphCallback,"delayUpdateGraphCallback"),26),this.Wd.Eb(this.NQb))}delayUpdateGraphCallback(){this.NQb=null;this.Ob.UUa(this.yh.mode)&&
this.Ps(!0)}LSk(){let a;if(this.Mk.I2){var b=this.nUc;a=this.Mk.uKc}else if(this.Mk.esa)b=this.nUc,a=b+(this.Mk.vrd-La.a.sv(this.Ob.JQa).length);else return;if(b===a)this.ld.Wb("PossibleDropACharDeletion",{["Reason"]:"LostBrowserSelection"});else{ba.ULS.shipAssertTag(18437315,315,b<=a);var c=this.pr.text(this.Ue.Dg),h="";this.pr.pSa(this.Ue.Dg,a);if(!b&&a<c.length&&" "===c.charAt(a)||0<b&&a<c.length&&" "===c.charAt(b-1)&&" "===c.charAt(a))a+=1,h+=Za.VGb;this.wsi(this.Ue.Dg);b=md.a.createTextRange(this.Ue.Dg,
b,a);this.Zg.replaceTextRange(b,h,void 0,void 0,D.a.RQd)}}wsi(a){J.a.instance.ga(70)&&this.Fz.ZIc(a)}Bzk(a){let b=!0;if(this.R6.rbg)this.R6.RPi();else{const c=1<this.nd.om().childNodes.length;a.x7b=this.XR.Zsd();if(a.x7b||this.Mk.esa||this.Mk.I2){a.x7b&&this.eg.w++;c&&(this.ld.Wb("PossibleValidTextDropped",{["Reason"]:"ExtraParagraphsFound"}),this.eg.x++,b=!1);if(this.Mk.I2||this.Mk.esa)this.LSk(),this.XR.aoc(),b=!1;a.qhb&&(this.ld.Wb("PossibleImeAutoDetermine",{["Reason"]:"StopPreseveringBrowserState"}),
this.eg.z++,this.Ipa.resume(),a.qhb=!1);this.Dh.Gri(this.Ob.Vh)}}a.Dra=!0;b&&(a.Dra=this.NLh.Azk(this.Ob.Dg,this.Ob.Hi,this.Ob.Vh,this.Zg,this.nha.instance))}}yh.XKf=250;Object(n.a)(yh,"ContentEditableViewGraphUpdater",null,[]);class Bg{constructor(){this.Bel=this.zgg=!1;this.$8g=null}}Object(n.a)(Bg,"OnPastedFloatieStatusChangeEventArgs",null,[]);var Kd=d(57);class Rj{constructor(a,b,c,h,m,y,G,U,ja,va,Ta,fb,Db,gc,hc,Gc,Pc,yc,Vd,De,Wd,Ve,$e,Qf,lg,Hg,Qg,Sf){this.Ue=null;this.tmg=0;this.Wff=!1;this.Oa=
a;this.yh=b;this.Ob=c;this.Lf=h;this.nd=m;this.Rga=y;this.Rs=G;this.rD=ja;this.yd=va;this.eg=Ta;this.pr=fb;this.Dh=Db;this.XR=gc;this.XKd=hc;this.fqa=Gc;this.kK=Pc;this.Z3a=yc;this.Tc=Vd;this.kj=De;this.zK=Wd;this.Nk=Ve;this.Mk=$e;this.Bp=Qf;this.rK=lg;this.SOa=Hg;this.iqa=Qg;this.hd=Sf}FS(a){this.Ue=a}Llk(a){this.Oa.raiseEvent(df.eventId,new df(a.JM,this.Ue.QU),this.Ue);if(1===this.yh.mode)return this.Mlk(a);if(0===this.yh.mode||!this.gyl(a))return!1;this.rD.sDf();if(this.fyl())return!0;this.hYi();
this.fqa.Kxh(this.Ob.Vh);this.fYi();!this.Wff&&this.Ob.Vh&&0<this.Ob.Vh.Qqd&&(this.Wff=!0,u.AFrameworkApplication.CL("Microsoft.Office.Web.SessionSettings.IWacWordEditorInlineTabsSettings"));this.hd&&this.hd.isFeatureEnabled(84)&&this.Sih(this.Ob.Vh);this.Z3a.Z2e();this.iqa.kNe(Object.assign(new Bg,{Bel:!0}));this.hd&&this.hd.isFeatureEnabled(84)||this.Sih(this.Ob.Vh);return!0}Sih(a){a&&a.Qqd&&(this.SOa?this.SOa.yIl(a,!0):ba.ULS.sendTraceTag(23708818,323,10,"TabRenderer is null."))}gyl(a){if(!this.Ob.Dg)return!1;
this.Ob.Vh=this.Ob.Dg.sc(this.Ue.Ma);this.Ob.Vh||ba.ULS.sendTraceTag(18437322,324,15,"current editing view element is set to null!");this.Ob.uW=this.Ob.Dg.sc(this.Lf.Rd.Ma);if(!this.Ob.uW)return!1;this.nd.Ag.bEe(this.Ob.uW);const b=this.nd.om(),c=this.Ob.JQa;(b?b.firstChild:null)!==c&&c&&(La.a.tu(b),b.appendChild(c));if(!a.JM&&!this.Ue.rNc){this.Ue.QU&&this.Rga.yZe(this.Mk.wda);this.Ue.QU=!1;if(this.Rs.Sfa||!a.aJa)this.Rs.SY(),this.Rs.Sfa=!1;return!1}this.Ue.rNc&&(this.Ue.rNc=!1,this.Ue.evb=!0);return!0}fYi(){this.Rs.SY();
if(this.Ue.evb){this.kK.setFocus(this.yh.mode,this.Ob.Hi,this.Ob.Dg,this.Ob.Vh,this.Nk.value.isEditingAllowed||this.Nk.value.Wy);if(this.yd.fg){const a=this.nd.om(),b=a?a.firstChild:null;b&&3===b.nodeType&&(this.eg.bv++,a.removeChild(b))}this.Ue.evb=!1}this.Rga.yZe(this.Mk.wda)}hYi(){if(this.yd.fg){var a=this.nd.om();const b=a?a.firstChild:null;b&&"BR"===b.tagName&&(this.eg.bu++,a.removeChild(b))}this.yd.UMb||(a=this.rK.Nc(this.Ob.Dg),this.pr.isEmpty(a)&&!this.pr.Xhe(a)&&this.rD.rjb(!0,this.Ob.Hi,
this.Dh));this.XKd.value.B_b(this.nd.om(),this.nd.contentWindow);this.XR.aoc()}fyl(){var a=this.Ob.uW;const b=this.nd.om().style;if(this.Ue.evb){if(!a)return!0;a=this.Ob.Vh.htmlElement;this.Rs.quh()&&(b.position="absolute",b.width="100%");a.style.width="auto";a.style.height="auto"}this.Ob.uca=this.qPj();return!1}qPj(){return Kd.OutlineElementReader.um(mc.OutlineElementNavigator.PA(this.Ob.Dg.node))}Qt(a){return Oe.a.Qt(a)}Mlk(a){if(!this.Tc.Pa||!this.Tc.Pa.mb)return ba.ULS.sendTraceTag(19711041,324,
15,"Attempt to validate selection with empty selection."),!1;if(!this.Ue.QU&&(!a.JM||Fc.App.Tge&&a.aJa))return this.Rs.Sfa&&(this.Rs.lzh(this.Ue.Ma),this.Rs.Sfa=!1),!1;this.Ue.QU=!1;a=(new Date).getTime();const b=this.Tc.Moa;!this.kj&&!b.nje&&!b.ale&&250<a-this.tmg?this.TKf(null):(this.Bp.raiseEvent(kd.a.Sjk),b.I7k(Object(F.a)(this,this.TKf,"delayOnAfterValidateSelection")));return!0}TKf(){1===this.yh.mode&&(this.Tc.Pa.Fda&&this.Ob.Dg&&(this.Ob.Vh=this.Ob.Dg.sc(this.Ue.Ma),this.Ob.Vh||ba.ULS.sendTraceTag(18437327,
324,15,"current editing view element is set to null!"),this.Ob.uW=this.Ob.Dg.sc(this.Lf.Rd.Ma)),this.Tc.Pa.Fda&&this.nd.om().firstChild!==this.Ob.JQa&&this.Ob.JQa&&(La.a.tu(this.nd.om()),this.nd.om().appendChild(this.Ob.JQa)),this.nd.om().firstChild&&(this.Tc.Pa.Fda?this.nd.om().style.direction=this.Qt(this.nd.om().firstChild).direction:Sys.UI.DomElement.containsCssClass(this.nd.om().firstChild,"Rtl")?this.nd.om().style.direction="rtl":this.nd.om().style.direction="ltr",this.Tc.Pa.Fda&&this.fqa.Kxh(this.Ob.Vh),
this.Rs.lzh(this.Ue.Ma),this.zK.Uib(this.yh.mode,this.Ob.Hi,this.Ob.Dg,this.Ob.Vh,this.Nk.value.isEditingAllowed||this.Nk.value.Wy)),this.tmg=(new Date).getTime(),this.Bp.raiseEvent(kd.a.wXi))}J0(a){const b=this.Llk(a);this.Bp.raiseEvent(!a.JM||Fc.App.Tge&&a.aJa?kd.a.kGc:kd.a.w8g);return b}}Object(n.a)(Rj,"ContentEditableViewOnAfterValidateHandler",null,[]);class Ia{constructor(a,b,c,h,m){this.Ue=null;this.Rs=a;this.Yr=c;this.nd=h;this.Bp=m}FS(a){this.Ue=a}fY(a){const b=this.Ue.Ftb;let c=3===b;c||
2!==b||(this.Ue.root.Lbe(510),c=!0,this.Rs.SY());if(c)return a.cancel=!0,!1;this.Bp.xIk(a);return!1}}Object(n.a)(Ia,"ContentEditableViewOnBeforeValidateHandler",null,[]);class nb{constructor(a,b,c,h,m){this.e7=!1;this.zAa=null;this.Bp=a;this.ld=b;this.eg=c;this.nd=h;this.hkf=m}sDf(){this.e7=!1}rjb(a,b,c){const h=this.nd.KDa();a&&(this.e7=La.a.sv(b)!==S.a.GNc);if(a&&!this.e7){for(b=this.nd.om();b.firstChild;)b=b.firstChild,this.hkf&&Sys.UI.DomElement.containsCssClass(b,wb.a.yLa)&&Sys.UI.DomElement.addCssClass(b,
wb.a.NHe);3!==b.nodeType?(this.zAa=h.Rl.createTextNode(Za.VGb),b.appendChild(this.zAa)):(this.zAa=b,this.zAa.nodeValue=Za.VGb);this.e7=!0;this.Bp.Kdh(!0)}if(!a&&this.e7){a=this.zAa;b=null;try{b=this.zAa.parentNode,b||""!==a.nodeValue||(this.zAa=null)}catch(m){this.eg.i++,this.zAa=null}this.zAa&&b!==h||(this.ld.Wb("PossibleExtraSpace",{["Reason"]:"LostPadding"}),this.eg.j++,c.Ei.length&&(a=this.OTf(c.Ei[c.Ei.length-1].tF)));if(a&&(a.nodeValue.endsWith(" ")||a.nodeValue.endsWith(Za.VGb))){if(this.hkf)for(c=
a;(c=c.parentNode)&&c.tagName&&"P"!==c.tagName.toUpperCase();)if(Sys.UI.DomElement.containsCssClass(c,wb.a.NHe)){Sys.UI.DomElement.removeCssClass(c,wb.a.NHe);break}c=a.nodeValue;a.nodeValue=c.substring(0,c.length-1)}this.e7=!1;this.Bp.Kdh(!1)}}ndl(a,b,c){return!this.e7||a||(v.a.MF&&!v.a.Uj||v.a.IF)&&!b?!1:c.Gpf()}OTf(a){if(a.className===wb.a.vN)return null;var b=a.childNodes?a.childNodes.length:0;if(b)for(--b;0<=b;--b){const c=this.OTf(a.childNodes[b]);if(c)return c}else if("#text"===a.nodeName&&
(b=a.nodeValue,b.endsWith(" ")||b.endsWith(Za.VGb)))return a;return null}}Object(n.a)(nb,"ContentEditableViewPaddingManager",null,[1419]);class Kb{constructor(a){this.FYd=this.w_e=this.esa=this.I2=!1;this.x0c=this.vrd=this.uKc=-1;this.$Bd=!1;this.Nle=0;this.lpa=a}get wda(){return this.$Bd}set wda(a){a!==this.$Bd&&this.lpa.processAction(a?D.a.eMf:D.a.fMf,2);this.$Bd=a}blg(){return this.w_e||this.esa||this.I2}H5(){this.FYd=this.w_e=this.esa=this.I2=!1;this.x0c=this.vrd=this.uKc=-1}}Object(n.a)(Kb,"ContentEditableViewTypingState",
null,[]);class dc{constructor(a,b,c,h,m,y,G){this.Ui=a;this.eg=b;this.ld=c;this.Wo=h;this.tf=m;this.Ob=y;this.kj=G}fta(a){if(!this.Ob.Vh||1===this.tf.mode&&!this.Fda())return null;const b=this.Ui.m8(this.tf.mode,this.Ob.Hi);let c=b,h=0;const m=this.Ob.Vh.gt;let y,G=!1;for(y=0;y<m.length;y++){var U=m[y];if(!this.Wo.Ofg(U)){G=!0;continue}const ja=this.Wo.BI(U,this.eg,this.ld,this.kj),va=Sys.UI.DomElement.containsCssClass(U,wb.a.hN);U=Sys.UI.DomElement.containsCssClass(U,S.a.eW);if(c<=ja)return va?c=
a||c===ja?1:0:U&&(c=0),this.Qg(this.Ob.Dg,h,c);c-=ja;va?h++:U||(h+=ja)}return G?this.Qg(this.Ob.Dg,0,b):this.Qg(this.Ob.Dg,0,0)}Qg(a,b,c){return yd.SelectionFactory.Qg(a,b+c)}Fda(){return me.a.instance.Pa.Fda}}Object(n.a)(dc,"CurrentEditSelectionProvider",null,[1418]);class Ic{constructor(a,b,c){this.qPb=[];this.XEc=null;this.ld=a;this.uS=b;this.XKd=c}get Ei(){return this.qPb}set Ei(a){this.qPb=a}Gpf(){return this.qPb.length?1<this.qPb.length||1<this.qPb[0].tF.innerText.length:!1}QUf(a,b,c){const h=
Y.a.ye(a,S.a.FFa),m=b?a.firstChild:a.lastChild;let y=null;b&&0<h?y=c.gt[h-1]:!b&&h<c.gt.length&&(y=c.gt[h+1]);if(y)for(this.ld.Wb("MomentaryNonLinkFormatting",{["Reason"]:"MoveSafariStrayTextNode"}),this.uS.u++,a.removeChild(m),b?y.appendChild(m):y.insertBefore(m,y.firstChild),a=0;a<this.Ei.length;a++);}Gri(a){for(let b=0;b<this.Ei.length;b++){const c=this.Ei[b].tF;v.a.MF&&0<c.getElementsByTagName("A").length&&(3===c.firstChild.nodeType?this.QUf(c,!0,a):3===c.lastChild.nodeType&&this.QUf(c,!1,a));
La.a.Ix(c,c.innerText)}}Gjk(a){for(let b=0;b<this.Ei.length;b++)this.XKd.B_b(this.Ei[b].tF,a)}xRk(){for(let a=0;a<this.Ei.length;++a){const b=this.Ei[a].tF;if(Sys.UI.DomElement.containsCssClass(b,wb.a.tLc)||Sys.UI.DomElement.containsCssClass(b,wb.a.rLc)||Sys.UI.DomElement.containsCssClass(b,wb.a.qLc)||Sys.UI.DomElement.containsCssClass(b,wb.a.sLc)){const c=this.Ei[a].SYa;c&&c!==b.innerText.length&&(b.className=wb.a.Y0b)}}}ofk(a,b){for(let c=0;c<this.Ei.length;c++){const h=this.Ei[c],m=a<=h.aTa,y=
h.aTa+h.SYa,G=y<=b;h.Hfd=m?h.aTa:a;h.JHe=G?y:b;m&&G&&(h.M_b=!0)}}dDf(){Array.clear(this.Ei)}}Object(n.a)(Ic,"CurrentlyActiveContentSpans",null,[1417]);class Id{constructor(a,b,c,h,m,y,G,U,ja,va,Ta,fb,Db,gc,hc,Gc,Pc,yc,Vd){this.kyd=!1;this.hf=a;this.Tc=b;this.ld=c;this.tf=h;this.Bp=m;this.Lf=y;this.Dh=G;this.Ob=U;this.yd=ja;this.zK=va;this.Nk=Ta;this.Kza=fb;this.WPb=Db;this.hPh=gc;this.hk=hc;this.nd=Gc;this.Ca=yc;this.fd=Vd;this.TSh=Pc.ka("ChromeSingleTextRunCopyImprovementIsEnabled");this.USb=Pc.ka("PasteKeepSourceFontSizeFixIsEnabled");
this.pTh=(this.gYh=Pc.ka("ProtectInClient"))||Pc.ka("ProtectedFile");this.dTh=Pc.ka("EnableExtractForProtectedFile");this.ySb=Pc?Pc.ka("ImageDataURLSkippedForSafari12IsEnabled"):!1;this.fTb=Pc?Pc.ka("TextLayoutServiceUseResponse"):!1;this.Pkf=this.Okf=!1}get TZ(){return this.Kza.instance}get Xab(){return this.fd.hg&&this.fd.Ny}R7f(a,b,c,h){this.FDk(a,b,c,h)}FDk(a,b,c,h){this.pTh&&!this.dTh?a.preventDefault():!b||this.Nk.value.isEditingAllowed||this.Nk.value.Wy&&this.Xab?1!==this.tf.mode||this.kyd||
!c||h||(this.TZ?b&&!this.hf.XXc(this.Tc.Qj)?(ba.ULS.sendTraceTag(3994324,307,50,"Cut not allowed"),this.ld.Wb(Ed.a.wh,{["Reason"]:Cd.a.YXd}),this.WPb.show(),a.preventDefault()):(this.Tc.Moa.g3d(),this.kyd=!0,b&&this.Bp.raiseEvent(kd.a.VHi),v.a.oua&&a.rawEvent&&a.rawEvent.currentTarget&&(u.AFrameworkApplication.fk("Microsoft.Office.Web.SessionSettings.IWacWoncaImageDataURLSkippedSettings"),this.ySb&&this.hk.Akd(a.rawEvent.currentTarget,"data-src","data-srcurl")),this.yd.Uj&&this.TSh&&this.WXi(a),this.USb&&
(this.Okf=this.SXi(a)),this.fTb&&(this.Pkf=this.gSk(a)),a=this.hPh.create(null,Object(F.a)(this,this.ZLi,"dispatchCutCopy"),b),a.Nl("Browser "+(b?"Cut":"Copied")),a.run()):(ba.ULS.sendTraceTag(3994323,307,50,"Clipboard command not available"),this.Ca.nne(b?D.a.cut:D.a.copy),a.preventDefault())):a.preventDefault()}WXi(a){const b=a&&a.rawEvent?a.rawEvent.clipboardData:null;if(b&&b.setData){var c=null;c=this.U2i();({CLc:c}=this.hk.utl(c));c&&(a.preventDefault(),b.setData("text/html",Wa.c(c)),b.setData("text/plain",
c.innerText))}}SXi(a){const b=a&&a.rawEvent?a.rawEvent.clipboardData:null;if(b&&b.setData){const c=b.getData("text/html").toString();if(c&&0<c.length)return a=this.hk.UYa(c),this.hk.LZb(a,this.Lf.Rd.Ld,!0)?(b.setData("text/html",a.innerHTML),!0):!1}return this.hk.LZb(a.rawEvent.currentTarget,this.Lf.Rd.Ld,!0)}gSk(a){const b=a&&a.rawEvent?a.rawEvent.clipboardData:null;if(b&&b.setData){const c=b.getData("text/html").toString();a=c&&0<c.length?this.hk.UYa(c):a.rawEvent.currentTarget;if(this.hk.ttd(a,
!1))return b.setData("text/html",Wa.c(a)),b.setData("text/plain",a.innerText),!0}return!1}U2i(){if(this.yd.dV){const a=this.nd.KDa();if(a&&a.Rl)return a.Rl.getSelection()}return null}ZLi(a,b){this.kyd=!1;if(this.Lf.Rd.so&&1!==u.AFrameworkApplication.Aa.state){if(b){if(this.yd.fg){for(b=0;b<this.Dh.Ei.length;b++){const c=this.Dh.Ei[b].tF,h=c.getElementsByTagName("BR");for(let m=0;m<h.length;m++)c.removeChild(h[m])}this.zK.oKa(this.tf.mode,this.Ob.Hi,this.Ob.Dg,this.Ob.Vh,this.Nk.value.isEditingAllowed||
this.Nk.value.Wy)}this.TZ.gii(a)}else this.TZ.eii(a);v.a.oua&&this.ySb&&this.Lf&&this.hk.Akd(this.Lf.Rd.Ag.Qn,"data-srcurl","data-src");this.USb&&this.Okf&&this.Lf&&this.Lf.Rd&&this.hk.LZb(this.Lf.Rd.Ag.Qn,this.Lf.Rd.Ld,!1);this.fTb&&this.Pkf&&this.Lf&&this.Lf.Rd&&this.hk.ttd(this.Lf.Rd.Ag.Qn,!0)}}}Object(n.a)(Id,"CutCopyHandler",null,[1416]);class ae{constructor(a,b,c,h,m,y,G,U){this.yd=a;this.yh=b;this.Yr=c;this.ld=h;this.tf=m;this.rha=y;this.Rs=G;this.Epb=U}W1b(a,b){this.yd.fg&&2===this.yh.mode&&
b&&this.Yr.isComposing&&(a=this.ld.Vp(D.a.typing),a.properties.$(de.a.source,"DomChange"),this.xNi(),a.end())}xNi(){this.Epb||this.tf.oaa(!0);this.rha.rFb();this.Rs.SY()}}Object(n.a)(ae,"DomChangeEventProcessor",null,[]);class Od{constructor(a,b,c,h){this.Ui=a;this.yh=b;this.Ob=c;this.Lf=h}ngb(a,b){if(!b)return!1;this.Ui.WKf(this.yh,this.Ob);return this.Lf.Rd?this.Lf.Rd.ngb(a):!1}}Object(n.a)(Od,"DoubleClickProcessor",null,[]);class Hd{constructor(a,b,c){this.yd=a;this.onb=b;this.izd=c}XCa(){this.onb.n7a=
!0;return!1}b2b(){return this.onb.n7a=!1}YCa(a){this.onb.n7a=!1;this.izd.cancelEventAndRestoreEditingSurface(a.pc);return!0}}Object(n.a)(Hd,"DragEventsProcessor",null,[]);class Bf{constructor(a){this.y9e=0;this.fyd=!1;this.yd=a}get n7a(){return this.fyd}set n7a(a){this.fyd=a;window.clearTimeout(this.y9e);this.fyd&&(this.y9e=window.setTimeout(Object(F.a)(this,this.Alk,"onAfterDragInactivity"),1E3))}Alk(){this.n7a=!1}}Object(n.a)(Bf,"DragStateManager",null,[]);class Of extends Tb{constructor(){super();
this.f_g=this.jlk=0}}Object(n.a)(Of,"SetModeEditEventArgs",Tb,[]);class ph extends Tb{constructor(){super();this.updates=null;this.gza=new Qa.a}}Object(n.a)(ph,"BeforeValidateEditEventArgs",Tb,[]);class Qh{constructor(){this.v2k=this.yNi=null}}Object(n.a)(Qh,"EditStateFactoryManager",null,[]);class Lg extends Tb{constructor(){super();this.charCode=0;this.AOj=this.isComposing=!1}}Object(n.a)(Lg,"KeyDownEditEventArgs",Tb,[]);class Fg extends Tb{constructor(){super();this.charCode=0;this.isComposing=
!1}}Object(n.a)(Fg,"KeyPressEditEventArgs",Tb,[]);class dg extends Tb{constructor(){super();this.Hwj=!1}}Object(n.a)(dg,"PaddingChangedEventArgs",Tb,[]);class hi{constructor(a){this.Oa=new bd.a;this.w2a=Object.assign(new Qh,{yNi:()=>a.om(),v2k:()=>qd.a.IDa(a.contentWindow)})}addHandler(a,b){this.Oa.addHandler(a,b)}removeHandler(a,b){this.Oa.removeHandler(a,b)}raiseEvent(a){this.Oa.raiseEvent(a,Object.assign(new Tb,{N7a:this.w2a}))}kKk(a,b){0===a&&0===b||this.Oa.raiseEvent(kd.a.x7k,Object.assign(new Of,
{jlk:a,f_g:b,N7a:this.w2a}))}xIk(a){this.Oa.raiseEvent(kd.a.Igi,Object.assign(new ph,{N7a:this.w2a,updates:a.updates,gza:a.gza}))}Ldh(a){a.N7a=this.w2a;this.Oa.raiseEvent(kd.a.w8g,a)}jNe(a,b){this.Oa.raiseEvent(kd.a.ey,Object.assign(new Fg,{charCode:a.pc.charCode,isComposing:b,N7a:this.w2a}))}oJk(a,b,c){this.Oa.raiseEvent(kd.a.Zf,Object.assign(new Lg,{charCode:a.pc.charCode,isComposing:b,AOj:c,N7a:this.w2a}))}Kdh(a){this.Oa.raiseEvent(kd.a.pwk,Object.assign(new dg,{N7a:this.w2a,Hwj:a}))}}Object(n.a)(hi,
"EditStateEventManager",null,[1415]);class Mg{constructor(a){this.YCd=this.Jyc=!1;this.mff=null;this.T7e=0;this.KVc=!1;this.Oa=a;this.G9e=0;this.ZDd=2}get mode(){return this.G9e}kjb(a,b){0===a?(0===b&&(b=1),this.mff=(new Date).toISOString(),this.ZDd=b):this.ZDd=0;this.G9e=a}get w0c(){return this.ZDd}get fXj(){return this.mff}get isActive(){return 0!==this.mode}get Dyi(){return this.T7e}CKa(a){this.YCd=a}W4b(a){return this.isActive&&!!a&&this.Jyc}oaa(a){!this.Jyc&&a&&this.Oa.raiseEvent(ve.Ayi);this.Jyc=
a;this.skk(a);a&&(this.T7e=(new Date).getTime())}O0f(a){return this.isActive&&!!a&&this.YCd}skk(a){a&&Hh.GrippersManager.instance.setVisibility(!1)}EXk(){this.YCd=this.Jyc=!1}}Object(n.a)(Mg,"EditViewStateManager",null,[1414]);var ne=d(903);class Bh{constructor(a,b,c,h,m,y){this.nd=a;this.rD=b;this.Bp=c;this.zK=h;this.$a=m;this.Lf=y;this.$a&&(this.$a.ka("WordEditorImageOverflowIsEnabled")||this.$a.ka("WordEditorImageUseRelativeHeightAsZIndexDirectlyIsEnabled"))&&(Bh.lNc=-1*Math.pow(2,31))}bJc(){this.rD.sDf();
La.a.tu(this.nd.om())}d0d(a){const b=this.nd.om();if(2===a){var c=Za.EOi;a=Bh.DOi;b.style.overflow="visible"}else if(1===a)c=v.a.Yib?0:Bh.lNc,a="0",b.style.overflow="hidden";else return;const h=this.nd.Ag.nu;h.style.position="absolute";this.$a&&(this.$a.ka("WordEditorImageOverflowIsEnabled")||this.$a.ka("WordEditorImageUseRelativeHeightAsZIndexDirectlyIsEnabled"))&&0<c?(c=document.createElement("div"),h.style.zIndex=String(c.style.zIndex)):h.style.zIndex=String(c);h.style.display="block";h.style.visibility=
"visible";h.style.maxHeight="none";h.style.maxWidth="";b.style.visibility="visible";h.style.opacity=a}dQf(a){if(this.nd&&this.nd.Ag&&this.nd.Ag.nu){var b=this.nd.Ag.nu;b.style.zIndex=String(v.a.Yib?0:Bh.lNc);v.a.Yib&&!a&&(b.style.visibility="hidden",this.nd.om().style.visibility="hidden")}}LDk(a){this.Bp.raiseEvent(kd.a.GGj);this.bJc();this.nd.F_a(!0);this.nd.om().style.direction="";this.d0d(a);this.nd.Ag.Ahk()}HDk(a){this.nd.F_a(!0);this.d0d(a);v.a.Yib&&this.X$f();v.a.IF&&Sys.UI.DomElement.addCssClass(this.nd.om(),
"NonStandardIEClipboard")}KDk(a){this.d0d(a);v.a.IF&&Sys.UI.DomElement.removeCssClass(this.nd.om(),"NonStandardIEClipboard")}JDk(a,b,c,h,m,y,G){this.Bp.raiseEvent(kd.a.endEditing);const U=this.nd.om();U&&(La.a.tu(U),v.a.XW&&b&&a&&(this.nd.F_a(!0),U.innerText=" ",this.zK.oKa(c,h,m,y,G)),a||qd.a.ADf(U),this.nd.F_a(!1),this.dQf(b))}IDk(a){this.nd.F_a(!1);v.a.IF&&Sys.UI.DomElement.removeCssClass(this.nd.om(),"NonStandardIEClipboard");this.dQf(a);this.Bp.raiseEvent(kd.a.$si)}MDk(){const a=Sys.UI.DomElement.getBounds(this.Lf.Rd.OJ),
b=this.nd.Ag.nu;Sys.UI.DomElement.getBounds(b).y<a.y&&(b.style.top=Math.max(this.Lf.Rd.scrollTop,ne.a)+"px");b.style.opacity="0";b.style.zIndex=String(Bh.lNc);v.a.Dj&&(b.style.visibility="Hidden",this.nd.om().style.visibility="Hidden")}X$f(){const a=1E3-this.Lf.Rd.container.getBoundingClientRect().left+this.Lf.Rd.scrollLeft+1,b=this.nd.Ag.nu;b.style.left="-11000px";b.style.paddingRight=a+"px";b.style.width=1E4+a+"px"}}Bh.lNc=-1E3;Bh.DOi="1";Object(n.a)(Bh,"EditingDomDisplayManipulator",null,[]);class Vh{constructor(a){this.qYh=
a}get range(){return this.qYh}select(){this.range.select()}execCommand(a,b,c){return this.range.execCommand(a,b,c)}queryCommandEnabled(a){return this.range.queryCommandEnabled(a)}queryCommandIndeterm(a){return this.range.queryCommandIndeterm(a)}queryCommandState(a){return this.range.queryCommandState(a)}queryCommandSupported(a){return this.range.queryCommandSupported(a)}queryCommandValue(a){return this.range.queryCommandValue(a)}scrollIntoView(a){this.range.scrollIntoView(a)}}Object(n.a)(Vh,"RangeProxy",
null,[1529]);class ij{constructor(a){this.JCc=a}get selection(){return this.JCc}get type(){return this.selection.type}createRange(){return new Vh(this.selection.createRange())}clear(){this.selection.clear()}empty(){this.selection.empty()}}Object(n.a)(ij,"SelectionProxy",null,[1518]);class Ij{constructor(a){this.BPh=a}get Rl(){return this.BPh}get body(){return this.Rl.body}get activeElement(){return this.Rl.activeElement}get documentElement(){return this.Rl.documentElement}get document(){return this.Rl.cookie}get selection(){return new ij(this.Rl.selection)}get designMode(){return this.Rl.designMode}get doctype(){return this.Rl.doctype}get domain(){return this.Rl.domain}get hidden(){return this.Rl.hidden}get implementation(){return this.Rl.implementation}get parentWindow(){return this.Rl.parentWindow}get referrer(){return this.Rl.referrer}get title(){return this.Rl.title}get URL(){return this.Rl.URL}get visibilityState(){return this.Rl.visibilityState}createAttribute(a){return this.Rl.createAttribute(a)}open(){this.Rl.open()}close(){this.Rl.close()}attachEvent(a,
b){return this.Rl.attachEvent(a,b)}detachEvent(a,b){this.Rl.detachEvent(a,b)}createAttributeNS(a,b){return this.Rl.createAttributeNS(a,b)}createDocumentFragment(){return this.Rl.createDocumentFragment()}createElement(a){return this.Rl.createElement(a)}createElementNS(a,b){return this.Rl.createElementNS(a,b)}createEvent(a){return this.Rl.createEvent(a)}createTextNode(a){return this.Rl.createTextNode(a)}dispatchEvent(a){return this.Rl.dispatchEvent(a)}execCommand(a,b,c){return this.Rl.execCommand(a,
b,c)}hasFocus(){return this.Rl.hasFocus()}focus(){this.Rl.focus()}getElementById(a){return this.Rl.getElementById(a)}getElementsByTagName(a){return this.Rl.getElementsByTagName(a)}getElementsByTagNameNS(a,b){return this.Rl.getElementsByTagNameNS(a,b)}getElementsByName(a){return this.Rl.getElementsByName(a)}write(a){this.Rl.write(a)}querySelector(a){return this.Rl.querySelector(a)}querySelectorAll(a){return this.Rl.querySelectorAll(a)}queryCommandEnabled(a){return this.Rl.queryCommandEnabled(a)}queryCommandIndeterm(a){return this.Rl.queryCommandIndeterm(a)}queryCommandState(a){return this.Rl.queryCommandState(a)}queryCommandSupported(a){return this.Rl.queryCommandSupported(a)}queryCommandValue(a){return this.Rl.queryCommandValue(a)}}
Object(n.a)(Ij,"DOMDocumentProxy",null,[1563]);class Yj{constructor(){this.y2a=null}get isValid(){return this.Ag.isValid}get contentWindow(){return this.Ag?this.Ag.contentWindow:null}get Ag(){return this.y2a}fok(a){sf.a.rXg(a,this.Ag.nu)}eok(){sf.a.d2e(this.Ag.nu)}jQf(){this.Ag.xQi()}Rdj(a){if(!v.a.fg)return a.innerHTML;this.Ag.Ntl(a);return a.innerHTML}Ivl(){this.Ag?(this.eok(),this.y2a=null):ba.ULS.sendTraceTag(18437346,323,15,"UnbindFromEditingDom: View not currently bound to Dom.")}fhi(a,b){this.y2a=
a;this.fok(b)}om(){return this.Ag?this.Ag.Qn:null}F_a(a){this.Ag&&this.Ag.lnd(a)}KDa(){return this.Ag?new Ij(this.Ag.contentDocument):null}}Object(n.a)(Yj,"EditingDomManager",null,[1413]);var ii=d(145);class Wh{constructor(a,b,c,h,m,y,G,U,ja,va,Ta,fb,Db,gc,hc,Gc,Pc,yc,Vd){this.Rha=0;this.Ue=null;this.Ob=a;this.yk=b;this.d2=c;this.Bp=h;this.Ipa=m;this.Wd=y;this.nd=G;this.tf=U;this.kK=ja;this.Nk=va;this.yd=Ta;this.rD=fb;this.Tc=Db;this.nK=gc;this.Dh=hc;this.Lf=Gc;this.hf=Pc;this.fd=Vd;this.qha=yc;this.qha.kai(Object(F.a)(this,
this.r6g,"onSynchronizeMode"))}dispose(){this.qha.cVk(Object(F.a)(this,this.r6g,"onSynchronizeMode"))}UYb(a){(this.Ue=a)||ba.ULS.sendTraceTag(22122889,323,50,"Bind ContentEditableView resolve failed as null.")}get mode(){return this.tf.mode}endClipboard(){if(1===this.mode){var a=this.yk.le(2);a.kd(this.Ue.root);this.Ue.detach();this.Ob.Dg&&!this.Zge&&this.Ob.Dg.sda(this.Lf.Rd.Ma,4,!0);this.tf.kjb(0,3);this.Ob.Dg=null;this.Ob.Vh=null;this.Ob.uW=null;this.d2.IDk(this.Ue.jJa);a.dispose()}}naa(a,b,c){this.Ue.cUa&&
this.Ob.Vh?this.Ue.Ps(!1):this.Ue.cUa&&!this.Ob.Vh&&ba.ULS.shipAssertTag(17884511,315,!1,"Content is dirty when CurrentEditingViewElement is still NULL");this.Bp.kKk(this.mode,a);let h=!0;switch(a){case 2:this.endClipboard();this.tf.kjb(a,c);h=this.startEditing(this.OHi);break;case 1:if(this.mode!==a||this.Tc.Pa.Pr!==this.Rha)this.endEditing(!0),this.tf.kjb(a,c),h=this.Fkl(),this.Rha=this.Tc.Pa.Pr;break;case 0:this.mode!==a&&(2===this.mode&&Hh.GrippersManager.instance.setVisibility(!1),this.endEditing(b),
this.endClipboard(),this.tf.kjb(a,c))}h||this.tf.kjb(0,7)}F5k(){this.tf.kjb(2,0)}get OHi(){return this.Tc.Pa.mb.Ua.node}startEditing(a){if(1===this.Hpf)return!1;this.nd.jQf();this.Ue.uya?this.Ue.Ps(!0):(this.Ue.nAj.lQf(!1),this.tf.W4b(this.Ob.Dg)&&this.Ue.Ps(!1));this.Ue.uya=!1;if(this.Ob.Dg===a)return a=rb.GraphIterator.nb(a.node),this.k0d(a),this.Ob.gxj&&(this.yd.Ni&&this.Ue.htb.wda||this.kK.setFocus(this.mode,this.Ob.Hi,this.Ob.Dg,this.Ob.Vh,this.Nk.value.isEditingAllowed||this.Nk.value.Wy)),!0;
const b=this.yk.le(2,D.a.startEditing);b.kd(a.node);this.Ue.detach();this.Ob.Dg&&this.Ob.Dg.sda(this.Lf.Rd.Ma,4,!0);this.Ob.Dg=a;this.Ob.Dg.sda(this.Lf.Rd.Ma,4,!0);if(this.fd.hg){const c=Ud.j(this.Ob.Dg,5);for(let h=0;h<c.length;h++)c[h].hNf(this.Ue)}this.Ue.evb=!0;this.d2.LDk(this.mode);this.Ue.Tx(a.node);this.rD.rjb(!1,this.Ob.Hi,this.Dh);this.tf.oaa(!1);this.tf.CKa(!1);a=rb.GraphIterator.nb(this.Ob.Dg.node);this.k0d(a);b.dispose();return!0}endEditing(a){if(2===this.mode&&(this.Ue.PNc(),this.Ue.Ps(!0),
!this.Zge)){var b=this.yk.le(2);b.kd(this.Ue.root);this.Ue.detach();this.Ob.Dg&&this.Lf.Rd&&this.Ob.Dg.sda(this.Lf.Rd.Ma,20,!0);this.tf.kjb(0,4);this.Ob.Dg=null;this.Ob.Vh=null;this.Ob.uW=null;this.d2.JDk(a,this.Ue.jJa,this.mode,this.Ob.Hi,this.Ob.Dg,this.Ob.Vh,this.Nk.value.isEditingAllowed||this.Nk.value.Wy);b.dispose()}}Fkl(){if(this.Zge||J.a.instance.ga(11)&&1===this.Hpf)return!1;this.Bp.raiseEvent(kd.a.Zsi);this.nd.jQf();const a=this.yk.le(2);a.kd(this.Tc.Nkb);this.tf.W4b(this.Ob.Dg)&&this.Ue.Ps(!1);
this.Ue.detach();this.Ob.Dg=null;this.Ob.Vh=null;this.Ob.uW=null;if(this.Tc.Pa.Fda){const b=this.Tc.Pa.mb.Ua.node;this.Ue.Tx(b);const c=rb.GraphIterator.nb(b);this.Ob.Dg=b;this.Ob.uca=this.sJj(b);this.k0d(c);this.Ob.Dg.sda(this.Lf.Rd.Ma,4,!0)}else this.Ue.Tx(this.Tc.Nkb);this.d2.HDk(this.mode);this.rD.rjb(!1,this.Ob.Hi,this.Dh);a.dispose();return!0}r6g(){this.A0a()}A0a(){if(!this.Ipa.b9&&!u.AFrameworkApplication.we.mw&&this.Lf.Rd&&this.Lf.Rd.isActive){var a=this.Tc.Pa.mb;a&&this.kK.mie()?this.nK&&
this.nK.C$a()?this.naa(2,!0,10):this.hf.gx(a)?Fc.App.Kb.Jd.isEditingAllowed||Fc.App.Kb.Jd.Wy?this.naa(2,!0,0):this.Ue.Xod?(this.naa(1,!0,0),this.naa(0,!0,15)):this.naa(2,!0,0):this.naa(1,!0,0):this.naa(0,!1,a?9:8)}}get Zge(){return u.AFrameworkApplication.Tg}get Hpf(){return u.AFrameworkApplication.Aa.state}k0d(a){a.gf();ii.OutlineNavigator.TQe(a)}sJj(a){return Kd.OutlineElementReader.um(mc.OutlineElementNavigator.PA(a))}}Object(n.a)(Wh,"EditingModeTransitionManager",null,[1412]);class Zj{constructor(a,
b,c,h,m,y,G,U,ja,va,Ta,fb,Db,gc,hc,Gc,Pc,yc,Vd,De,Wd,Ve){this.Ue=null;this.Wd=a;this.tf=b;this.Ob=c;this.rUh=h;this.Mk=m;this.qUh=y;this.oUh=G;this.Lxd=U;this.c1h=ja;this.nnb=va;this.oOa=Ta;this.l8e=fb;this.APh=Db;this.kK=gc;this.Rga=hc;this.LWb=Gc;this.FPh=Pc;this.DWh=yc;this.rMh=Vd;this.cVh=De;this.Pha=Wd;this.Ui=Ve}FS(a){this.Ue=a}get NY(){return!this.Wd.mw&&this.tf.isActive&&this.Ob.UUa(this.tf.mode)?!0:!1}IAk(a){a.BFa=b=>this.rUh.BFa(b,this.NY);a.fbb=b=>this.qUh.fbb(b,this.NY);a.Sz=b=>this.oUh.Sz(b,
this.NY,this.Ue.u1b);a.Q_b=b=>this.Lxd.Q_b(b,this.NY,this.Ue.u1b);a.ZUd=b=>this.Lxd.XUd(b,this.NY,this.Ue.u1b);a.P_b=b=>this.Lxd.P_b(b,this.NY,this.Ue.u1b);a.Ikb=b=>this.c1h.Ikb(b,this.NY&&this.Ue.Xod);a.YCa=Object(F.a)(this.nnb,this.nnb.YCa,"dropHandler");a.XCa=Object(F.a)(this.nnb,this.nnb.XCa,"dragOverHandler");a.b2b=Object(F.a)(this.nnb,this.nnb.b2b,"dragLeaveHandler");a.Gkc=b=>{this.oOa.handlePaste(b,this.Ue.root,this.tf.KVc)};a.XXd=b=>{this.l8e.R7f(b,!0,this.NY,this.tf.KVc)};a.i0b=b=>{this.l8e.R7f(b,
!1,this.NY,this.tf.KVc)};a.W1b=b=>{this.APh.W1b(b,this.NY)};a.Fxf=()=>{this.kK.Ahi()};a.ZB=b=>this.Rga.PHi(b,this.Mk.wda,this.NY);a.bC=b=>this.LWb.onContextMenu(b,this.Ue.Dg);a.v0e=Object(F.a)(this.LWb,this.LWb.Vjc,"onTouchMove");a.u0e=Object(F.a)(this.LWb,this.LWb.JGb,"onTouchEnd");a.POd=()=>{this.kK.DQi(this.tf.mode)};a.K7a=b=>this.FPh.ngb(b,this.NY);a.n_a=b=>{this.DWh.onScroll(b,this.NY,this.Ue.ownerDocument.documentElement)};a.Ffa=()=>{this.rMh.Zlk(this.NY)};a.bpg=b=>{this.cVh.lostFocus(b,this.NY)};
a.BKb=()=>this.Pha.Auj(this.NY,this.Ue.Dg);a.Mfb=b=>this.Ui.mouseDown(b);a.PCe=b=>this.Ui.xJ(b)}}Object(n.a)(Zj,"EditingSurfaceEventHandlerManager",null,[]);class Hi{constructor(a,b,c){this.ld=a;this.eg=b;this.yh=c}cancelEventAndRestoreEditingSurface(a){this.ld.Wb("DisallowedDragAndDrop",{["Reason"]:"CancelEventAndRestoreEditingSurface"});this.eg.bx++;wd.a.An(a);this.yh.naa(0,!0,6);this.yh.A0a()}}Object(n.a)(Hi,"EditingSurfaceEventHandlerUtils",null,[]);class $i{constructor(){this.bBa=0}get b9(){return 0<
this.bBa}suspend(){this.bBa++}resume(){0<this.bBa&&this.bBa--}}Object(n.a)($i,"EditingSurfaceStateManager",null,[]);class Ai{constructor(a=30){this.tbd=this.Xhc=-1;this.Ukb=Array(a);this.Mbd=Array(a-1)}SBh(){this.fNk();this.lzl()}Imd(){const a=this.E3k();ba.ULS.sendTraceTag(18437392,324,50,"Duration Values: "+a)}fNk(){var a=(new Date).getTime();if(this.Xhc<this.Ukb.length-1)this.Xhc++;else for(let b=0;b<this.Ukb.length-1;b++)this.Ukb[b]=this.Ukb[b+1];this.Ukb[this.Xhc]=a}lzl(){const a=this.Xhc+1;
for(let b=2;b<=a;b++)this.kvl(b,this.q7i(b))}q7i(a){const b=this.Xhc;return this.Ukb[b]-this.Ukb[b-(a-1)]}kvl(a,b){a-=2;this.tbd<a?(this.tbd++,this.Mbd[this.tbd]=b):b<this.Mbd[a]&&(this.Mbd[a]=b)}E3k(){const a=this.gWi();return Sys.Serialization.JavaScriptSerializer.serialize(a)}gWi(){const a=Array(this.tbd+1);for(let b=0;b<a.length;b++)a[b]=Math.round(this.Mbd[b]/(b+1));return a}}Object(n.a)(Ai,"EventFrequencyTracker",null,[]);var si=d(1068),Ni=d(1070);class ak{constructor(a){this.At=null;this.Ep=
0;this.cK=a;this.Jj=new Date;this.lvc=u.AFrameworkApplication.Aa.mode}end(a){this.Ep=a;this.At=new Date}get startTime(){return this.Jj}get endTime(){return this.At}get actionId(){return this.cK}get behavior(){return 2}get mHc(){return this.lvc}get KJ(){return null}get rd(){return null}get telemetryData(){return null}get response(){return this.Ep}get oT(){return 1}get wq(){return 30}get Ora(){return null}get Oi(){return!0}}Object(n.a)(ak,"TypingActionOperation",null,[1433,369,370]);class Sj{constructor(a,
b,c,h,m,y,G,U,ja,va,Ta,fb,Db,gc,hc,Gc,Pc,yc){this.Ue=this.qyc=this.Pnb=null;this.VWh=a;this.yh=b;this.Bp=c;this.vha=h;this.d2=m;this.yk=y;this.Ob=G;this.Lf=U;this.Wd=ja;this.Nk=va;this.tf=Ta;this.Ui=fb;this.Dh=Db;this.Rs=gc;this.rha=hc;this.XR=Gc;this.Tc=Pc;this.wD=yc}FS(a){this.Ue=a}get rbg(){return!!this.Pnb}startHybridTransition(){if(this.Nk.value.isEditingAllowed||this.Nk.value.Wy){this.yh.F5k();this.Bp.raiseEvent(kd.a.mwk);this.C6k(D.a.overtype);this.vha.value.kw();this.d2.KDk(this.yh.mode);
var a=this.yk.le(2);a.kd(this.Ue.root);this.Ob.Dg&&!u.AFrameworkApplication.Tg&&this.Ob.Dg.sda(this.Lf.Rd.Ma,4,!0);a.dispose();this.XR.aoc();this.tf.CKa(!0);this.Ui.updateCaretPosition(this.yh.mode,this.Ob.Hi);this.VWh.bYi(this.Ob.Vh,this.Ob.Dg,this.Ob.uW);this.Dh.ofk(this.Tc.Pa.mb.Ua.Qa,this.Tc.Pa.mb.Ua.Nb);this.Rs.SY();this.rha.rFb();this.d5h();this.Bp.raiseEvent(kd.a.kwk)}else this.yh.naa(0,!0,12)}RPi(){this.XR.aoc();this.Pnb.end(32);si.a.getInstance().gnc(this.Pnb);Ni.a.getInstance().fnc(this.Pnb);
this.Pnb=null}d5h(){this.qyc||(this.qyc=new He.a(2,1,20,Object(F.a)(this,this.hybridCleanup,"hybridCleanup"),24),this.Wd.Eb(this.qyc))}C6k(a){this.Pnb=new ak(a)}hybridCleanup(){this.qyc=null;this.Ob.UUa(this.yh.mode)&&this.Ue.Ps(!0)}iWe(){if(!this.Tc.Pa.Fda)return!1;const a=this.Tc.Pa.mb.Ua,b=Ib.HyperlinkReader.hC(a,!1);for(const c of b)if(c.Qa===a.Qa&&c.Nb<=a.Nb)return!1;return this.wD.oSj(a)?!1:!Ud.d(a.node,a.Qa)&&!Ud.d(a.node,a.Nb-1)&&!a.node.kyi}}Object(n.a)(Sj,"HybridTransitionManager",null,
[1411]);class ti{constructor(a,b,c,h,m){this.yBd=this.uya=!1;this.Yr=a;this.yh=b;this.nd=c;this.Dh=h;this.Lf=m}get wAj(){return this.yBd}PNc(){this.lQf(!0)}lQf(a){this.Yr.isComposing&&2===this.yh.mode&&(ba.ULS.sendTraceTag(18437401,323,50,"EnsureImeDetermined"),this.yBd=!0,this.nd.Ag.Ona(),this.Dh.Gjk(this.nd.contentWindow),this.yBd=!1,this.Yr.isComposing=!1,a&&this.Lf.Rd.so&&(this.Lf.Rd.Jsb()&&ba.ULS.sendTraceTag(38602073,323,50,"Selection is reset to view top by EnsureImeDetermined."),this.yh.A0a()))}}
Object(n.a)(ti,"ImeManager",null,[]);class Ii{constructor(a,b,c,h,m,y,G,U){this.zh=null;this.yd=a;this.nd=b;this.yh=c;this.yk=h;this.ld=m;this.eg=y;this.Rm=U}UYb(a){this.zh=a}get uAj(){if(this.yd.fg){const a=qd.a.IDa(this.nd.contentWindow);if(a&&this.Rm.xTc(a)===this.nd.om())return!0}return!1}correctBadImeState(){if(!this.uAj)return!1;this.ld.Wb("PossibleIncorrectImeBehavior",{["Reason"]:"CorrectBadImeState"});this.eg.bz++;const a=this.yk.le(3);a.kd(this.zh.root);this.yh.naa(0,!0,11);this.yh.A0a();
a.dispose();return!0}}Object(n.a)(Ii,"ImeRecoveryUtils",null,[]);class bg{constructor(a,b,c,h,m,y,G,U,ja){this.Dh=a;this.eg=b;this.ld=c;this.kj=h;this.rK=m;this.Wo=y;this.Lf=G;this.Ob=ja}rFb(){for(let a=0;a<this.Dh.Ei.length;a++)this.Wo.BI(this.Dh.Ei[a].tF,this.eg,this.ld,this.kj)?Sys.UI.DomElement.removeCssClass(this.Dh.Ei[a].lge,"EmptyTextRun"):Sys.UI.DomElement.addCssClass(this.Dh.Ei[a].lge,"EmptyTextRun"),La.a.h0b(this.Dh.Ei[a].tF,this.Dh.Ei[a].lge)}}Object(n.a)(bg,"InteractiveViewSynchronizer",
null,[]);var xa=d(14),Ma=d(199),$a=d(239);class Eb{constructor(){}}Object(n.a)(Eb,"OnBackspaceDeleteEventArgs",null,[]);class ac{constructor(a){this.rTf=a}}Object(n.a)(ac,"OnDisMissFloatieEventArgs",null,[]);var tc=d(542),aa=d(99);class sa{constructor(a,b,c,h,m,y,G,U,ja,va,Ta,fb,Db,gc,hc,Gc,Pc,yc,Vd,De,Wd,Ve,$e,Qf,lg,Hg,Qg,Sf,sh,Xg,ni,Ri,uj,dj,ej,Ei,Dk,vj,tk,Fl,rl,Gl,Vj,Ek,Wj,fk){this.Qha=null;this.fdf=this.G5e=!1;this.nTb=new xa.ScriptSharpLegacyMap;this.iBa=a;this.kj=b;this.Wd=c;this.nd=h;this.ld=
m;this.eg=y;this.Nqa=G;this.Pha=U;this.Rga=ja;this.Ob=va;this.Ui=Ta;this.yd=fb;this.Rm=Db;this.oZ=gc;this.hf=hc;this.XR=Gc;this.RH=Pc;this.Ypa=yc;this.Tc=Vd;this.tf=De;this.Yr=Wd;this.vha=Ve;this.RB=$e;this.Zg=Qf;this.Nk=lg;this.zK=Hg;this.Nmb=Qg;this.Mk=Sf;this.xNa=sh;this.LV=Xg;this.VMh=ni;this.Epb=Ri;this.yk=uj;this.Ca=dj;this.fd=ej;this.$o=Ei;this.BD=Dk;this.uRb=vj;this.HP=tk;this.z4a=Fl;this.iqa=rl;this.Bp=Gl;this.UMh=Vj;this.Dza=!!Ek;this.Zu=Ek;this.$a=Wj;this.yn=fk}get ntc(){return this.iBa.instance?
this.iBa.instance.hDh():null}get zYd(){return this.uRb||(this.uRb=vb.a.instance.rb("Common.IEventTimingMeter"))}get u_a(){return this.Qha||(this.Qha=vb.a.instance.rb("Box4.ISelectionCommands"))}BWj(a,b){let c=this.P$d(a);c||(c=this.Frj(a,b));return c}Frj(a,b){const c=a.pc,h=c.keyCode,m=a.eventName===ra.a.KPa;if(this.Dza&&m&&this.Zu.instance&&this.Zu.instance.pmk(h===z.a.MH))return wd.a.An(c),!0;if(h===z.a.v1a&&c.shiftKey&&c.ctrlKey)return m&&(u.AFrameworkApplication.Ta.processAction(D.a.xJf,2),ba.ULS.sendTraceTag(41738320,
323,50,"CtrlShiftV triggered.")),!1;if(m&&c.ctrlKey){if(h===z.a.dud||h===z.a.gud)return this.pne(D.a.wJf),!1;if(h===z.a.eud||h===z.a.Ztc)return this.pne(D.a.vJf),!1;if(h===z.a.T4e)return this.pne(D.a.uHi),!1}this.kj&&(this.Wd.VKf(sa.uol),this.nd.Ag.vsd());if(1===this.tf.mode)return this.Opk(a,b);if(this.kj&&this.Mk.wda)return this.ld.Wb("DisallowedKeyDownDuringDictation",{["Reason"]:"KeyDownHandler"}),this.eg.bw++,wd.a.An(c),this.Nqa.Wnc(D.a.typing),!0;this.Pha.fixupAfterMagnifierDrag();this.nd.om().scrollTop=
0;this.Rga.f9=!this.Ob.uca&&h===z.a.lP||this.Ob.uca&&h===z.a.PR||h===z.a.Nw;this.Ui.updateCaretPosition(this.tf.mode,this.Ob.Hi);this.yd.Dj&&(c.ctrlKey||c.altKey)&&h!==z.a.cud&&h!==z.a.bMa&&h!==z.a.Clb&&h!==z.a.avd&&this.xNa.PNc();return this.Erj(a)}Erj(a){var b=a.pc.keyCode;const c=b===z.a.bpa,h=b===z.a.MH;let m=!1,y=!1,G=!1;switch(b){case z.a.Nw:case z.a.YE:G=!0;u.AFrameworkApplication.fk("Microsoft.Office.Web.SessionSettings.IWacWordBrowserHandledNavigationSettings");b=this.$a.ka("BrowserHandledNavigationIsEnabled");
a.pc.altKey||a.pc.ctrlKey||a.pc.shiftKey||this.yd.uk||!b&&this.yd.Uj||(y=!0);break;case z.a.PR:case z.a.lP:G=!0;this.yd.uk&&this.Rm.B1f(a.pc.rawEvent)&&!a.pc.altKey&&!a.pc.shiftKey?y=!0:this.yd.Dj&&this.u_a?a.pc.altKey||a.pc.ctrlKey||a.pc.shiftKey||(y=!0):m=!0;this.$a&&this.$a.ka("EditSurfaceKeyboardNavImprovementsIsEnabled")&&this.tf.CKa(!0);break;case z.a.K1:case z.a.I1:G=!0;this.yd.Dj&&this.u_a?y=this.sqj(a):m=!0;this.$a&&this.$a.ka("EditSurfaceKeyboardNavImprovementsIsEnabled")&&(this.hf.YZc(this.z4a.mb)||
this.hf.gKa(),this.tf.CKa(!0));break;case z.a.bpa:case z.a.MH:if(!this.Nk.value.isEditingAllowed&&this.Nk.value.Wy)m=!0;else if(this.hqj(a,c,h))return!0;break;case z.a.ZHh:this.ld.Wb("InsertKeyPressed");m=!0;break;default:if(a.pc.keyCode===z.a.avd||a.pc.keyCode===z.a.hud||this.yd.$Od)this.Yr.isComposing=!0,this.Epb||this.tf.oaa(!0)}(this.Mk.I2&&!h||this.Mk.esa&&!c)&&this.RH.Ps(!0);2!==this.tf.mode&&(G=y=!1);a.eventName===ra.a.KPa&&this.Bp.oJk(a,this.Yr.isComposing,G);y&&(this.vha.value.kw(),this.RB.kPa(a));
m&&wd.a.An(a.pc);return y}P$d(a){return u.AFrameworkApplication.fa.ka("PPTOTextPredictionIsEnabled")?tc.a.P$d(a,this.z4a.y3b):!1}iqj(a){const b=this.z4a.y3b;var c=b.node;const h=b.Qa,m=Ob.ParagraphReader.text(c);let y=!1;if(a){if(h<Ob.ParagraphReader.textLength(c)){a=this.yk.le(15);try{a.kd(c),c=h+1,ta.a.jx(m,c)&&c++,this.yn.YFb(b,null),this.Ca.processAction(D.a.rightArrow,2)}finally{a&&a.dispose()}y=!0}}else if(0<h){a=this.yk.le(15);try{a.kd(c),c=h-1,ta.a.jx(m,c)&&c--,this.yn.YFb(b,null),this.Ca.processAction(D.a.leftArrow,
2)}finally{a&&a.dispose()}y=!0}return y}fhj(a){return uc.a.ps(a.Ua).cache.fontSize}sqj(a){var b=!1;if(!(a.pc.altKey||a.pc.ctrlKey||a.pc.shiftKey||(a=Ud.f(this.Ob.Dg),Ma.a.any(a,c=>5===c.Sq||8===c.Sq)))){if(this.nd.Ag&&this.HP.pzb(this.nd.Ag.Qn))return!1;this.RB.mlb&&this.RB.typingProcess();b=this.oZ.fta(this.Rga.f9);a=this.hf.Cia(b);a=this.Ob.uca?a.x+a.width:a.x;-1===this.hf.yz?(this.hf.yz=a,b=!0):b=Math.abs(this.hf.yz-a)<=this.fhj(b)}return b}hqj(a,b,c){if(!a.pc.altKey&&!a.pc.ctrlKey&&!a.pc.shiftKey&&
(this.kj&&this.Mk.I2&&this.XR.Zsd()&&this.RH.Ps(!1),this.VMh.eul(b,this.Ob.Vh,this.Ob.JQa,this.Ob.Dg,this.Rga.f9,this.Ob.uW.Hi,this.RH.fii))){if(this.fd.hg&&this.fd.Ny)return(b=this.iqj(b))&&wd.a.An(a.pc),b;const h=this.ld.Vp(D.a.RQd);this.ntc&&this.ntc.HWj();const m=new Eb(a,c,b);this.UMh.wIk(m);(c&&!this.Mk.I2||b&&!this.Mk.esa)&&this.RH.Ps(!1);J.a.instance.ga(50)&&this.Ypa.value&&this.Ypa.value.lw&&this.Tc.qXb();La.a.h0b(this.Ob.Vh.Hi,this.Ob.uW.Hi);this.RB.kPa(a);this.hf.gKa();this.tf.oaa(!0);
this.Mk.esa=b;this.Mk.I2=c;this.Mk.I2&&-1===this.Mk.uKc?this.Mk.uKc=this.RH.nUc:this.Mk.esa&&-1===this.Mk.vrd&&(this.Mk.vrd=La.a.sv(this.Ob.JQa).length);h.end();return!0}return!1}Sz(a,b,c){const h=this.zYd;try{h&&h.keyDownEventHandlerStart(a.pc.rawEvent);0===this.tf.mode&&a.pc.keyCode!==z.a.tq&&1!==this.Ca.mode&&this.j1j(this.tf,a.eventName);if(!b||!this.Zg)return!1;(a.pc.keyCode!==z.a.Clb||this.Nmb.GMc)&&this.Nk.value.rr.tN();if(!this.Dcl(a)){const G=new ac(!0);this.iqa.NIk(G)}if(!this.tf.isActive)return!1;
this.Mk.Nle=(new Date).getTime();const m=this.ld.Vp(D.a.typing);m.properties.$(de.a.source,"KeyDown");m.properties.$(de.a.O9g,"KeyDown");const y=this.BWj(a,c);y&&wd.a.toi(a.pc);m.end();return y}finally{h&&h.keyDownEventHandlerEnd(a.pc.rawEvent)}}Dcl(a){switch(a.pc.keyCode){case z.a.yga:case z.a.YHh:case z.a.x6:case z.a.aZ:case z.a.Naa:case z.a.zga:case z.a.hud:case z.a.iud:return!0}return!1}j1j(a,b){b={["EventName"]:b};u.AFrameworkApplication.Aa&&(b.Mode=u.AFrameworkApplication.Aa.mode);if(a)if(b.Trigger=
a.w0c,b.TriggeredTime=a.fXj,this.nTb.Hb(a.w0c)){let c,h;(c=this.nTb).$(h=a.w0c,c.ga(h)+1)}else this.nTb.$(a.w0c,1);b.Msg="BadEditSurfaceState";this.G5e?ba.ULS.sendTraceTag(18437408,323,50,"{0}",b):(ba.ULS.shipAssertTag(18437408,323,!1,"{0}",b),u.AFrameworkApplication.cga(()=>{this.k1j()}));this.G5e=!0}k1j(){if(!this.fdf){var a="";for(let b of this.nTb.keys)a+=" Trigger "+b+" - "+this.nTb.ga(b)+",";ba.ULS.sendTraceTag(50421966,323,10,"Total keyinput lost in UnknownMode:"+a);this.fdf=!0}}Opk(a,b){this.kj&&
this.zK.Uib(this.tf.mode,this.Ob.Hi,this.Ob.Dg,this.Ob.Vh,this.Nk.value.isEditingAllowed||this.Nk.value.Wy);if(this.fd.hg&&(w.KeyInputManager.fVc(a.pc)===w.KeyInputManager.Na(z.a.yza,w.KeyInputManager.Le)||w.KeyInputManager.fVc(a.pc)===w.KeyInputManager.Na(z.a.Juc,w.KeyInputManager.Le))&&(u.AFrameworkApplication.yR||u.AFrameworkApplication.EJ)&&!u.AFrameworkApplication.tRa)return wd.a.An(a.pc),!0;const c=this.z4a.y3b,h=c.node;if(a.pc.keyCode===z.a.tq){if($a.EmbeddedFileReader.nQj(h))return wd.a.An(a.pc),
!0;if(aa.ImageReader.dH(h)||!$a.EmbeddedFileReader.fab(h))if(aa.ImageReader.dH(h)||aa.ImageReader.dFa(c))return u.AFrameworkApplication.Ta.mi(c,D.a.rB,2,!1,null,null),wd.a.An(a.pc),!0}switch(a.pc.keyCode){case z.a.avd:case z.a.hud:if({B3:a,CMb:b}=this.LV.kDh(a,b),a)return b}return!1}pne(a){u.AFrameworkApplication.Ta.processAction(a,2)}}sa.uol=2E3;Object(n.a)(sa,"KeyDownProcessor",null,[]);class Oa{constructor(a,b,c,h,m,y,G,U,ja,va,Ta,fb,Db,gc,hc){this.Wo=a;this.Ob=b;this.eg=c;this.ld=h;this.kj=m;
this.rD=y;this.RH=G;this.XR=U;this.yh=ja;this.Ui=va;this.oZ=Ta;this.tV=fb;this.hf=Db;this.Mk=gc;this.tf=hc}get bIe(){return this.Wo.BI(this.Ob.Hi,this.eg,this.ld,this.kj)-(this.rD.e7?1:0)-this.Wo.BI(this.Ob.Hi.lastChild,this.eg,this.ld,this.kj)}qFk(a,b){switch(b.keyCode){case z.a.YE:case z.a.PR:if(this.$xj(a,b))return!0;break;case z.a.Nw:case z.a.lP:if(this.NPi(a,b))return!0;break;case z.a.K1:case z.a.I1:if(this.Owl(a,b))return!0;break;case z.a.MH:if(this.sgi())return!0}return!1}sgi(){return this.Mk.I2&&
this.XR.Zsd()?(this.RH.Ps(!1,!0),!0):!1}Owl(a,b){a.VXc=!0;var c=this.bIe;const h=this.Ui.m8(this.yh.mode,this.Ob.Hi);h>=c&&(this.Ui.XS(c,this.Ob.Vh),a.mb=this.oZ.fta(this.tV.f9));if(h===b.j1b)a.p7a=b.keyCode===z.a.aZ?1:3;else{if(h<c&&ta.a.Xy(this.Wo.qYf(this.Ob.Vh,h-1,this.ld,this.eg,this.kj))){c=this.hf.Nsa(a.mb,!1,!1,!1,!0);c=this.hf.Cia(c);var m=a.mb.Ua;a=this.hf.Cia(a.mb);m=uc.a.ps(m);a.y>c.y&&Math.abs(a.x-this.hf.yz)>2*m.cache.fontSize&&this.Ui.XS(h-1,this.Ob.Vh)}this.tf.CKa(!0);this.tV.fixupAfterCursor(b.keyCode===
z.a.aZ?1:3);this.RH.AYd();return!0}return!1}NPi(a,b){a.VXc=!0;const c=this.bIe;this.hf.gKa();const h=this.Ui.m8(this.yh.mode,this.Ob.Hi);h>=c&&(this.Ui.XS(c,this.Ob.Vh),a.mb=this.oZ.fta(this.tV.f9));if(b.keyCode===z.a.lP&&(b.j1b>=c&&!this.Ob.uca||b.j1b===this.tV.yxh&&this.Ob.uca))a.p7a=2;else return this.tf.CKa(!0),b.keyCode===z.a.Nw&&h<c&&ta.a.Xy(this.Wo.qYf(this.Ob.Vh,h-1,this.ld,this.eg,this.kj))&&this.Ui.XS(h-1,this.Ob.Vh),this.tV.fixupAfterCursor(this.Ob.uca?4:2),this.RH.AYd(),!0;return!1}$xj(a,
b){a.VXc=!0;const c=this.bIe;this.hf.gKa();if(b.keyCode===z.a.PR&&(b.j1b===this.tV.yxh&&!this.Ob.uca||b.j1b>=c&&this.Ob.uca))a.p7a=4;else return this.tf.CKa(!0),this.tV.fixupAfterCursor(this.Ob.uca?2:4),this.RH.AYd(),!0;return!1}}Object(n.a)(Oa,"KeyEntryProcessor",null,[]);var ib=d(1192),Gb=d(128),Bb=d(42);class Cc{constructor(a,b,c,h,m,y,G,U,ja,va,Ta,fb,Db,gc,hc,Gc,Pc,yc,Vd,De,Wd,Ve,$e,Qf,lg,Hg,Qg,Sf){this.Kza=this.ujf=null;this.yd=a;this.Rm=b;this.ld=c;this.Pha=h;this.Nk=m;this.LV=y;this.R6=G;this.Yr=
U;this.tf=ja;this.Tc=va;this.nd=Ta;this.qxc=fb;this.Ui=Db;this.Kga=gc;this.Wo=hc;this.Ob=Gc;this.Rga=Pc;this.Dh=yc;this.Ypa=Vd;this.Bp=De;this.RB=Wd;this.Zaa=Ve;this.iBa=$e;this.B0h=Qf;this.Tga=lg;this.fd=Hg;this.$o=Qg;this.uRb=Sf}get ntc(){return this.iBa&&this.iBa.instance?this.iBa.instance.hDh():null}get Xab(){return this.fd.hg&&this.fd.Ny}get TZ(){return this.Kza||(this.Kza=vb.a.instance.rb("Box4.IClipboardCommands"))}get zYd(){return this.uRb||(this.uRb=vb.a.instance.rb("Common.IEventTimingMeter"))}fbb(a,
b){if(!b)return!1;b=this.zYd;try{b&&b.keyPressedEventHandlerStart(a.pc.rawEvent);if(this.yd.MF&&this.yd.uk&&this.Rm.B1f(a.pc.rawEvent))return!1;this.ntc&&!w.KeyInputManager.Xgg(a)&&this.ntc.HWj();const c=this.ld.Vp(D.a.typing);c.properties.$(de.a.source,"KeyPress");const h=this.GWj(a);c.end();return h}finally{b&&b.keyPressedEventHandlerEnd(a.pc.rawEvent)}}ivj(){if((this.B0h||this.Xab)&&this.Tga.F2(this.Tc.Qj,14)){var a=Object(ua.a)(ib.a,this.Tga.a4b(this.Tc.Qj,16,!1));if(a&&1<a.length){const b=[],
c=this.Tc.Pa.ga(0);a=a.getContext(0).node;for(let h=0;h<c.length;++h){const m=c.ga(h).node;if(!rb.GraphIterator.nb(m).Faa(a))break;Array.add(b,c.ga(h))}0<b.length&&this.Tc.setSelection(new Gb.Selection(b,!0))}}}qJk(a,b){if(1===this.tf.mode)return!1;this.Bp.jNe(a,this.Yr.isComposing);let c;(c=this.RB).c0c=c.c0c+1;v.a.to||Fc.App.pRd&&v.a.Lyh||(this.RB.Lth(this.Yr.tFa)||this.RB.kPa(a),this.tf.oaa(!0));this.Yr.isComposing&&J.a.instance.ga(50)&&this.Ypa.value&&this.Ypa.value.lw&&this.Tc.qXb();this.Dh.XEc=
"";0<this.Dh.Ei.length&&(this.yd.fg||" "===b)&&(this.Dh.XEc=La.a.sv(this.Dh.Ei[0].tF));this.Zaa.raiseEvent(Zc.a.Cle,a);this.qxc.SBh();return!1}JMi(a){let b=!1;this.Yr.tFa&&this.Kga.OYb.instance&&(" "===a&&this.Wo.bPi(this.Ob.Hi,this.Ui.m8(this.tf.mode,this.Ob.Hi))&&(b=!!this.Kga.RBe(this.Yr.tFa,this.Rga.f9)),!b&&this.Kga.OYb.instance.KUj(a)&&this.Kga.IMi(a,this.Rga.f9))}Grj(a){if(1!==this.tf.mode||(this.yd.Dj||this.yd.to)&&a.pc.ctrlKey&&!a.pc.altKey||this.yd.Eka&&a.pc.charCode===z.a.J1)return!1;if(this.LV.Gfd(a))return!0;
var b=this.LV.NVe();const c=this.LV.Gcl();if(b||c||!this.R6.iWe())return b&&!c&&this.Tc.setSelection(yd.SelectionFactory.Qg(this.Tc.Pa.mb.Ua.node,this.Tc.Pa.mb.Ua.Qa)),b=this.gab(),this.ivj(),this.TZ&&(this.TZ.g9g(String.fromCharCode(a.pc.charCode),b),this.Zaa.raiseEvent(Zc.a.Cle,a)),wd.a.An(a.pc),!0;if(this.LV.KHe(a))return!0;if(this.Xab){b=this.fd.Hrb();try{this.Bp.jNe(a,this.Yr.isComposing),this.yd.to&&this.TZ?(this.TZ.g9g(String.fromCharCode(a.pc.charCode)),wd.a.An(a.pc)):(this.RB.kPa(a),this.tf.oaa(!0))}finally{b&&
b.dispose()}}else this.R6.startHybridTransition(),this.Bp.jNe(a,this.Yr.isComposing),this.RB.kPa(a),this.tf.oaa(!0);this.Zaa.raiseEvent(Zc.a.Cle,a);this.qxc.SBh();return!1}gab(){if(this.Tc&&this.Tc.Pa&&this.Tc.Pa.mb){const a=this.Tc.Pa.mb;return Bb.SelectionEditor.Wl(a.ga(a.length-1))||a.ga(a.length-1).contextId===xb.a.paragraph}return!1}GWj(a){this.Pha.fixupAfterMagnifierDrag();if(!(this.Nk.value.isEditingAllowed||this.Nk.value.Wy&&this.Xab))return wd.a.An(a.pc),!0;if(this.LV.Ifd(a))return!1;if(1===
this.tf.mode)return this.Grj(a);this.nd.om().scrollTop=0;this.yd.fg&&this.tf.W4b(this.Ob.Dg)&&" "===this.ujf&&this.RB.typingProcess();const b=ta.a.charAt(ta.a.fromCharCode(a.pc.charCode),0);this.ujf=b;this.Yr.isComposing||(w.KeyInputManager.Xgg(a)&&(this.Yr.isComposing=!0),this.Ui.iLk&&(this.Yr.isComposing=!0));this.JMi(b);if(this.yd.fg&&!this.yd.uk){const c=a.pc;if(c.ctrlKey&&122===this.Rm.pYf(c)||c.ctrlKey&&121===this.Rm.pYf(c))return!0}return this.qJk(a,b)}}Object(n.a)(Cc,"KeyPressProcessor",null,
[]);class cc{constructor(a,b){this.Xi=a;this.keyCode=this.Xi.pc.keyCode;this.j1b=b}get rwj(){return!(void 0===this.keyCode||null===this.keyCode)}}Object(n.a)(cc,"KeyQueueEntry",null,[]);class Qd{constructor(a,b,c,h,m,y,G){this.oTb=[];this.Qha=null;this.pUh=a;this.tf=b;this.Ob=c;this.hf=h;this.Tc=m;this.RH=y;this.Ui=G}get u_a(){return this.Qha||(this.Qha=vb.a.instance.rb("Box4.ISelectionCommands"))}Nah(a){let b=-1;if(w.KeyInputManager.rhg(a.eventName)&&2===this.tf.mode)switch(a.pc.keyCode){case z.a.YE:case z.a.Nw:case z.a.PR:case z.a.lP:case z.a.K1:case z.a.I1:J.a.instance.ga(45)&&
this.tf.W4b(this.Ob.Dg)&&this.RH.Ps(!1,!1);Hh.GrippersManager.instance.DTa();b=this.Ui.m8(this.tf.mode,this.Ob.Hi);break;default:Hh.GrippersManager.instance.restoreAfterCursoring()}Array.add(this.oTb,new cc(a,b))}rFk(a){for(;0<this.oTb.length;){const b=this.oTb[0];Array.removeAt(this.oTb,0);const c=w.KeyInputManager.rhg(b.Xi.eventName);if(!(c&&(b.Xi.pc.altKey||b.Xi.pc.ctrlKey||b.Xi.pc.shiftKey)||this.oTb.length)){if(c)if(b.rwj){if(this.pUh.qFk(a,b))return!0}else this.hf.gKa();if(this.Iul(a))return!0}}return!1}Iul(a){if(5!==
a.p7a){if(this.tf.O0f(this.Ob.Dg))if(1===a.p7a||3===a.p7a){const b=this.hf.yz;this.Tc.setSelection(a.mb);this.hf.yz=b}else this.Tc.setSelection(a.mb);this.u_a.cik(a.p7a);if(2!==this.tf.mode)return!0}return!1}}Object(n.a)(Qd,"KeyQueueProcessor",null,[]);class re{constructor(a,b,c,h,m,y,G,U,ja,va,Ta,fb){this.Qha=null;this.ld=a;this.zK=b;this.yh=c;this.Yr=h;this.Ob=m;this.Nk=y;this.rha=G;this.Rs=U;this.vzc=ja;this.nd=va;this.Nmb=Ta;this.RB=fb}get u_a(){return this.Qha||(this.Qha=vb.a.instance.rb("Box4.ISelectionCommands"))}BFa(a,
b){if(!b)return!1;b=this.ld.Vp(D.a.typing);b.properties.$(de.a.source,"KeyUp");a=this.JWj(a);b.end();return a}JWj(a){a.pc.keyCode===z.a.Clb&&(this.Nmb.GMc=!0);a.pc.ctrlKey&&this.zK.PLf(this.yh.mode,me.a.instance.Pa,this.u_a,this.Ob.Vh,this.Ob.Hi,this.Ob.Dg,this.Nk.value.isEditingAllowed||this.Nk.value.Wy);this.Yr.isComposing&&(this.rha.rFb(),this.Rs.SY());this.RB.Lth(this.Yr.tFa)&&(this.vzc.Nah(a),this.RB.mlb=!0,this.RB.typingProcess());this.nd.om().scrollTop=0;return!1}}Object(n.a)(re,"KeyUpProcessor",
null,[]);class Ca{constructor(a){this.Cxd=this.kwd=this.pG=null;this.Wd=a}get H7(){return this.pG||(this.pG=vb.a.instance.resolve("Common.Utils.IAriaNotifier"))}Ckk(a){a&&(this.Cxd=a,this.kwd=new He.a(2,1,500,Object(F.a)(this,this.tryAriaNotifyParagraphLockedTask,"tryAriaNotifyParagraphLockedTask"),29),this.Wd.Eb(this.kwd))}tryAriaNotifyParagraphLockedTask(a){this.Cxd&&a&&this.kwd===a&&this.H7.sendNotification(String.format(Box4Intl.Box4Strings.l_ScreenReaderBlockEditing,this.Cxd),!0)}}Object(n.a)(Ca,
"LockedParagraphAriaNotifier",null,[]);class ob{constructor(a){this.RH=a}lostFocus(a,b){u.AFrameworkApplication.Tg||b&&this.RH.Ps(!0,!1)}}Object(n.a)(ob,"LostFocusEventProcessor",null,[]);class Hb{constructor(a,b,c,h){this.eg=a;this.yh=b;this.rha=c;this.Rs=h}onScroll(a,b,c){b&&(c.scrollLeft||c.scrollTop)&&(this.eg.h++,c.scrollLeft=0,c.scrollTop=0,2===this.yh.mode&&(this.rha.rFb(),this.Rs.SY()))}}Object(n.a)(Hb,"OnScrollProcessor",null,[]);var rc=d(1097);class td{constructor(a,b,c,h){this.html=a;this.text=
b;this.Fpl=c;this.vVd=h}dispose(){this.vVd=null}}Object(n.a)(td,"OriginalElementContent",null,[106]);class sc{constructor(a,b,c){this.uUb=[];this.c$e=0;this.ld=a;this.uS=b;this.Wo=c}get v0d(){return this.c$e}get D7g(){return this.uUb}rDf(){for(let a=0;a<this.uUb.length;a++)this.uUb[a]&&(this.uUb[a].dispose(),this.uUb[a]=null)}Kxh(a){this.rDf();a=a.gt;for(let c=0;c<a.length;c++){const h=a[c];var b=!1;h.parentNode&&h.parentNode.parentNode&&(b=Sys.UI.DomElement.containsCssClass(h.parentNode.parentNode,
wb.a.H1d));if(b||Sys.UI.DomElement.containsCssClass(h,wb.a.hN)||Sys.UI.DomElement.containsCssClass(h,S.a.eW)||Sys.UI.DomElement.containsCssClass(h,wb.a.vN)){let m=b=null,y=null;1===h.childNodes.length&&3===h.firstChild.nodeType?b=La.a.sv(h):(m=this.Wo.n5d(h,this.ld,this.uS),y=new rc.a(h));this.D7g[c]=new td(h.innerHTML,b,m,y)}Sys.UI.DomElement.containsCssClass(h,wb.a.vN)&&(this.c$e=La.a.e9a(h))}}}Object(n.a)(sc,"OriginalElementContentArray",null,[1409]);class Tc{constructor(a,b,c,h,m,y,G){this.Dh=
a;this.eg=m;this.ld=h;this.kj=G;this.rD=b;this.Tc=c;this.Wo=y}bYi(a,b,c){var h=this.Tc.Pa.mb.Ua;const m=h.Qa;h=h.Nb;let y=0,G=0;a=a.gt;Array.clear(this.Dh.Ei);for(let Ta=0;Ta<a.length;Ta++){var U=a[Ta],ja=this.Wo.BI(U,this.eg,this.ld,this.kj);if(Sys.UI.DomElement.containsCssClass(U,wb.a.hN))G<m?y+=ja:G<h&&(ja=Ud.d(b,G))&&!ja.WBa&&(ja=Y.a.ye(U,S.a.FFa),Array.add(this.Dh.Ei,new Kg(U,c.gt[ja],y,G,1))),G++;else if(Sys.UI.DomElement.containsCssClass(U,S.a.eW))y+=ja;else if(!Sys.UI.DomElement.containsCssClass(U,
wb.a.vN)){if(G+ja>=m&&G<=h){let fb=Y.a.ye(U,S.a.FFa);var va=c.gt[fb];Sys.UI.DomElement.removeCssClass(va,wb.a.R7);Array.add(this.Dh.Ei,new Kg(U,va,y,G,ja-(this.rD.e7?1:0)));for(U=this.Wo.BI(va,this.eg,this.ld,this.kj);U<ja&&!(fb+1>=c.gt.length);)va=c.gt[fb+1],U+=this.Wo.BI(va,this.eg,this.ld,this.kj),va.parentNode.removeChild(va),Array.removeAt(c.gt,fb+1)}else if(G>h)break;y+=ja;G+=ja}}}}Object(n.a)(Tc,"OvertypeDomPreparer",null,[]);var Dc=d(120),xc=d(59);class pg{constructor(a,b,c,h,m,y,G,U,ja,va,
Ta,fb,Db,gc,hc,Gc){this.IGd=!1;this.Kza=null;this.XUh=a;this.yh=b;this.yd=c;this.Tc=h;this.Nqa=m;this.hf=y;this.Nk=G;this.Lf=U;this.Yr=ja;this.R6=va;this.kj=Ta;this.Ob=fb;this.zK=Db;this.RB=gc;this.fd=hc;this.$o=Gc}get TZ(){return this.Kza||(this.Kza=vb.a.instance.rb("Box4.IClipboardCommands"))}Bul(){return 1===this.yh.mode?(this.IGd&&this.yd.fg&&this.YQd(),this.IGd=!1,!0):!1}YQd(){if(this.TZ){const a=new E.DictionaryPropertySet;a.setValue(xc.a.FU,"<span></span>");this.TZ.Cra(null,a,!1)}}KHe(a){const b=
this.Tc.Moa;return b.ale||b.nje?(wd.a.An(a.pc),this.Nqa.Wnc(D.a.lwk),!0):!1}Gfd(a){if(!this.hf.Rta(me.a.instance.Pa.mb))return!1;wd.a.An(a.pc);this.Nqa.Wnc(D.a.Gfd);return!0}Ifd(a){if(!J.a.instance.ga(14))return!1;var b=me.a.instance.Pa.ga(0);if(!Dc.a.instance.s2k(b))return!1;b=this.hf.Wtc(me.a.instance.Pa);this.XUh.Ckk(b);wd.a.An(a.pc);this.Nqa.Wnc(2===this.yh.mode?D.a.svl:D.a.Ifd);return!0}kDh(a,b){let c,h;h=c=!1;if(!this.Nk.value.isEditingAllowed)return wd.a.An(a.pc),{B3:!0,CMb:!0};if(!b)return{B3:!0,
CMb:!0};if(this.Gfd(a)||this.Lf.Rd.Lb.Pa.eH&&a.pc.type===ra.a.WUd)return{B3:!0,CMb:h};this.Yr.isComposing=!0;b=this.NVe();if(!b&&this.R6.iWe()){if(this.KHe(a))return{B3:!0,CMb:h};this.kj&&this.zK.Uib(this.yh.mode,this.Ob.Hi,this.Ob.Dg,this.Ob.Vh,this.Nk.value.isEditingAllowed||this.Nk.value.Wy);this.fd.hg&&this.fd.Ny?(wd.a.An(a.pc),h=c=!0):this.R6.startHybridTransition()}else b&&this.Tc.setSelection(yd.SelectionFactory.Qg(me.a.instance.Pa.mb.Ua.node,me.a.instance.Pa.mb.Ua.Qa)),this.Tc.Moa.tsb(),this.fd.hg&&
this.fd.Ny?(wd.a.An(a.pc),h=c=!0):this.yd.fg?(this.IGd=!0,this.RB.kPa(a),c=!0):(this.YQd(),wd.a.An(a.pc));return{B3:c,CMb:h}}NVe(){if(!this.Tc.Pa.Fda)return!1;var a=me.a.instance.Pa.mb.Ua;return a.Qa!==a.Nb-1?!1:(a=Ud.d(a.node,a.Qa))&&5===a.Sq?!0:!1}Gcl(){if(!this.Tc.Pa.Fda)return!1;const a=this.Tc.Pa.mb.Ua;return!Ud.d(a.node,a.Nb)||0<a.Qa&&!Ud.d(a.node,a.Qa-1)||a.Qa===a.Nb?!1:!0}}Object(n.a)(pg,"OvertypeUtils",null,[]);class Ih{constructor(a,b,c,h,m,y){this.k2a=null;this.nd=a;this.COh=b;this.Lf=
c;this.yh=h;this.Ob=m;this.sGd=y}get nGf(){return this.COh}Z2e(){if(2===this.yh.mode&&this.Lf.Rd.np&&this.Ob.UUa(this.yh.mode)){var a=this.Ob.Vh,b=this.nGf.x7d(a.gb);this.sGd.Hih(b,this.k2a,a,this.nd.Ag.nu,!1,!0);this.k2a=b}}}Object(n.a)(Ih,"ParagraphOverlayPositioner",null,[]);class vh{constructor(a,b){this.Fyk=this.location=null;this.vv=a;this.isRtl=b}}Object(n.a)(vh,"OnShowFloatieEventArgs",null,[]);class Ti{constructor(){this.type=0;this.payload=this.FHe=null;this.L0c=!1;this.iQa=this.style=this.lLe=
null}}Object(n.a)(Ti,"PasteDataContext",null,[]);class ai{constructor(a,b,c,h,m,y,G,U,ja,va,Ta,fb,Db,gc,hc,Gc,Pc,yc,Vd,De,Wd,Ve,$e,Qf,lg,Hg,Qg){this.LGd=this.Qif=this.Ln=null;this.uJd=Hg;this.Aqa=Qg;this.Pif=a.ka("PasteClipboardImageInChromeIsEnabled");this.iXh=a.ka("PasteFromPlainTextKeepEmptyLinesIsEnabled");this.EHd=a.ka("ReadImageBlobForIE11UpIsEnabled");this.RNh=a.Fc("ClipboardDataImageBlobLimitaton",10);this.WVb=a.ka("GatherMetadataAboutExternalPastedHTMLContentIsEnabled");this.ymf=a.ka("PasteInBootLoadingUIIsEnabled");
this.zJd=a.ka("ParseStyleFromRawHtmlHeadIsEnabled");this.Wd=b;this.ld=c;this.yk=h;this.Tc=m;this.yh=y;this.nd=G;this.d2=U;this.Lf=ja;this.yd=va;this.zK=Ta;this.Ob=fb;this.Kga=Db;this.Nk=gc;this.Kza=hc;this.hk=Gc;this.gPh=yc;this.NOa=Vd;this.nS=De;this.Ca=Wd;this.Gga=Ve;this.kqa=$e;this.iqa=Qf;this.fBa=lg;this.p7e=[Object(F.a)(this,this.Kzj,"imageClipboardDataHandler"),Object(F.a)(this,this.$zk,"plainTextClipboardDataHandler"),Object(F.a)(this,this.zyj,"htmlClipboardDataHandler")]}get TZ(){return this.Kza.instance}get jJa(){return this.LGd}Qdj(a){switch(a){case "image/png":a=
1;break;case "text/plain":a=2;break;case "text/html":a=3;break;default:a=0}return a}get s_h(){return this.zJd||this.WVb}Nrj(a){const b=new Ti;b.type=this.Qdj(a.type);b.payload=a.data;b.L0c=!0;this.Ylh(b)}Rah(a,b){this.Tc.Moa.tsb();this.yh.naa(0,!0,13);this.nd.F_a(!0);const c=this.nd.Ag.nu.style;c.display="block";a&&(b=c.overflow,c.overflow="hidden");this.d2.MDk();this.Lf.Rd.uza();this.yd.pua?this.zK.oKa(this.yh.mode,this.Ob.Hi,this.Ob.Dg,this.Ob.Vh,this.Nk.value.isEditingAllowed||this.Nk.value.Wy):
this.d2.bJc();return b}Mkh(a){this.nd.Ag.nu.style.overflow=a}handlePaste(a,b,c){if(!c&&!this.jJa&&!this.Wd.mw)if(this.TZ||this.ymf){this.Kga.tR&&(this.Kga.tR=null);this.LGd=this.yk.le(3);this.jJa.kd(b);b=new Ti;b.iQa=this.fBa.lYe();b.iQa.GGc("pasteHandler");b.L0c=!1;b.FHe=this.Rah(this.nS.Rod,b.FHe);if(c=this.hk.Rca(a)){this.s_h&&this.Sxk(c,b);for(let h=0;h<this.p7e.length&&this.p7e[h](a,c,b);++h);}this.Aqa&&a.preventDefault();u.AFrameworkApplication.fk("Microsoft.Office.Web.SessionSettings.IWacLoadingPasteBootUISettings");
!this.TZ&&this.ymf?this.Ylh(b):this.Xlh(b)}else ba.ULS.sendTraceTag(3994320,307,50,"Clipboard command not available"),this.ld.Wb(Ed.a.wh,{["Reason"]:Cd.a.YKf}),this.Ca.nne(D.a.Cra),a.preventDefault()}Ylh(a){ba.ULS.sendTraceTag(24492118,307,50,"Clipboard commands unavailable. Loading Paste dialog is showing.");this.Boa();this.Gga.Dk(6,()=>{this.ULi(a)})}Boa(){this.Ln=this.kqa();this.Ln.yr=!1;this.Ln.xd=5;this.Ln.Boa(null,null,null)}ULi(a){this.Ln&&(this.Ln.close(),this.Ln=null);ba.ULS.sendTraceTag(24492119,
307,50,"Clipboard commands available. Dismissing progress dialog.");this.Xlh(a)}Xlh(a){a=this.gPh.create(null,Object(F.a)(this,this.YMi,"doPasteOperation"),a);a.Nl("Browser Pasted (Editing Surface)");a.run()}Kzj(a,b,c){if((this.Pif||this.EHd)&&(b=this.hk.D4d(a.rawEvent))&&this.hk.Wtd(this.nd.om())){let h=null;if(({J7b:h}=this.hk.zsd(b,this.RNh,this.nS.Uhc)).returnValue)return c.type=1,c.payload=h,this.EHd&&this.yd.XW&&a.preventDefault(),!1}return!0}$zk(a,b,c){return this.iXh&&this.hk.YPj(b)&&(a=this.hk.L7d(b))?
(c.type=2,c.payload=a,!1):!0}zyj(a,b,c){return this.uJd&&(a=this.hk.Q4b(b))?(c.type=3,c.payload=a,this.zJd&&c.style&&(c.payload+=c.style),!1):!0}YMi(a,b){var c=this.nd.Ag.nu.style;b&&this.nS.Rod&&"hidden"===c.overflow&&this.Mkh(b.FHe);if(c=this.nd.om()){if(this.yd.zua)for(var h=c.firstChild;h&&1===c.childNodes.length&&vf.a(h);)c=h,h=h.firstChild;if(b&&(this.Pif||this.EHd)&&1===b.type&&this.hk.Wtd(c)&&(h=b.payload)){this.Qif=a;this.nS.e0b(h,m=>{this.wNf(this.Qif,m,b)});return}this.wNf(a,this.nd.Rdj(c),
b)}}mpf(a){a=this.NOa.create(a,Object(F.a)(this,this.rAh,"teardownPaste"),null);a.Nl("Aborting Paste in ContentEditableView");a.run()}wNf(a,b,c){this.yd.Dj&&(La.a.tu(this.nd.om()),this.yd.Eka||this.nd.Ag.Ona());if(this.Aqa&&!c)ba.ULS.sendTraceTag(541172694,307,10,"No pasteDataContext"),this.mpf(a);else{c.L0c&&(b="",1!==c.type&&(b=c.payload));var h=!b&&!c.L0c;this.Aqa&&(h=!c.payload&&h);h?(ba.ULS.sendTraceTag(18437454,307,15,""),this.mpf(a)):(c.style&&(b+=c.style),this.nd.F_a(!0),h=new E.DictionaryPropertySet,
h.setValue(xc.a.FU,b),h.setValue(jb.a.Eie,!0),h.setValue(kb.a.UN,!0),1===c.type&&this.nS.oqc?h.setValue(xc.a.QVc,b):2===c.type&&c.payload?h.setValue(xc.a.Pgb,c.payload):3===c.type&&c.payload&&(this.Aqa?h.setValue(xc.a.FU,c.payload):h.setValue(xc.a.rIe,c.payload)),this.WVb&&c.lLe&&h.setValue(xc.a.v9g,c.lLe),c.iQa&&h.setValue(xc.a.iQa,c.iQa),a=this.NOa.create(a,Object(F.a)(this,this.Cni,"callPasteAction"),h),a.Nl("Paste in ContentEditableView"),a.run())}}Cni(a,b){this.TZ.Cra(a,b,!0);a.$g(Object(F.a)(this,
this.rAh,"teardownPaste"));return!0}rAh(a){this.yh.A0a();this.jJa&&(this.jJa.SU(a),this.jJa.dispose(),this.LGd=null);a.$g(Object(F.a)(this,this.Dni,"callPasteFloatie"));return!0}Dni(a,b){a=Object(ua.a)(E.DictionaryPropertySet,b);if(!a||a.sa(xc.a.Pgb,null)||a.sa(xc.a.QVc,null))return!1;b=new vh(1,u.AFrameworkApplication.isRtl);b.Fyk=a.sa(xc.a.FU,null);this.iqa.GKk(b);return!1}Sxk(a,b){if(a=this.hk.WRf(a)){u.AFrameworkApplication.fk("Microsoft.Office.Web.SessionSettings.IWacWordGatherMetadataAboutPastedHTMLContentSettings");
if(this.WVb){let c=this.hk.XRf(a);null===c?c="inaccessible":""===c&&(c="unknown");b.lLe=c}this.zJd&&(b.style=this.hk.CTi(a))}}}Object(n.a)(ai,"PasteHandler",null,[1408]);class Il{constructor(a,b,c,h,m){this.dhf=new Tf.a(RegExp("\u00a0","g")," ");this.Fnf=new Tf.a(new RegExp("["+Za.Qxf+Za.nbg+"]","g"),"");this.ld=a;this.eg=b;this.Ui=c;this.Wo=h;this.yd=m}Ari(a,b,c,h,m){if(m){m=!1;for(let ja=0;ja<a.length;++ja){const va=b.D7g[ja];if(!va)continue;const Ta=a[ja];var y=Ta.innerHTML,G=va.html;if(y.length===
G.length||y===G)continue;if(Ub.YYc(Ta))continue;m=!0;y=Sys.UI.DomElement.containsCssClass(Ta,S.a.eW);G=Sys.UI.DomElement.containsCssClass(Ta,wb.a.hN);const fb=Sys.UI.DomElement.containsCssClass(Ta,wb.a.vN);let Db=!1,gc=!1;Ta.parentNode&&Ta.parentNode.parentNode&&Sys.UI.DomElement.containsCssClass(Ta.parentNode.parentNode,wb.a.H1d)&&(Db=Ta.parentNode.parentNode.firstChild===Ta.parentNode,gc=Ta.parentNode.parentNode.lastChild===Ta.parentNode);var U=void 0;let hc;va.text?(U=La.a.sv(Ta),hc=va.text):(U=
this.Wo.n5d(Ta,this.ld,this.eg),hc=va.Fpl);const Gc=this.dhf.mJa(U).indexOf(this.dhf.mJa(hc));if(0<=Gc){const Pc=this.Fnf.mJa(ta.a.substring(U,0,Gc));U=this.Fnf.mJa(ta.a.right(U,Gc+hc.length));0<Pc.length&&((fb||G||Db)&&0<ja?(this.hcd(a[ja-1],Pc,!0,this.eg),this.Wo.dYc(Ta)&&(h-=Za.KMc)):y&&ja!==a.length-1&&this.hcd(a[ja+1],Pc,!1,this.eg));0<U.length&&((G||gc||y)&&ja!==a.length-1?(this.hcd(a[ja+1],U,!1,this.eg),this.Wo.dYc(Ta)&&(h+=Za.zZd)):fb&&0<ja&&this.hcd(a[ja-1],U,!0,this.eg))}else fb&&(this.yd.Dj||
this.yd.to)&&1===hc.length&&!U.length?ba.ULS.sendTraceTag(18437455,315,50,"Possible Ins/Overtype"):fb&&this.yd.fg||ba.ULS.shipAssertTag(18437456,315,!1,"CleanReadOnlyObjects failed."),y=hc?hc.length:0,G=U.length,G>y&&(h-=G-y);va.text?La.a.Ix(Ta,va.text):(this.Wo.NTj(Ta)||va.vVd.restore(),va.vVd=new rc.a(Ta))}m&&this.Ui.XS(h,c)}}hcd(a,b,c,h){h.n++;c?La.a.Ix(a,La.a.sv(a)+b):La.a.Ix(a,b+La.a.sv(a))}}Object(n.a)(Il,"ReadOnlyObjectsCleaner",null,[]);class ui{constructor(a,b,c,h,m,y,G,U,ja,va,Ta,fb,Db,
gc,hc,Gc,Pc,yc,Vd,De){this.Zha=0;this.nd=a;this.hJd=b;this.kK=c;this.eg=h;this.ld=m;this.Jzc=y;this.Tc=G;this.Ui=U;this.Wo=ja;this.yd=va;this.$e=Ta;this.hf=fb;this.Lf=Db;this.kj=gc;this.QId=hc;this.Rm=Gc;this.pr=Pc;this.rTh=yc;this.MQh=De}init(a){this.Zha=a}Uib(a,b,c,h,m){if(this.nd.isValid){var y=this.nd.om();y&&y.firstChild&&1!==u.AFrameworkApplication.Aa.state&&(this.hJd.$Rf(this.Tc.Pa),this.gSe(a,b,c,h,m))}}oKa(a,b,c,h,m){if(this.kK.mie()&&(!this.kj||this.$e.fch))if(this.kK.setFocus(a,b,c,h,m),
this.yd.dV){a="Window.getSelection";b=this.nd.om();if(this.yd.wT){if("none"===b.style.display){ba.ULS.sendTraceTag(19702473,324,15,"Editing element is not displayed");return}if(!La.a.Zta(this.nd.Ag.xza,b)){ba.ULS.sendTraceTag(19702474,324,15,"Editing element is not attached to view panel");return}}try{var y=this.Rm.getSelection(this.nd.contentWindow);y&&(a="Selection.removeAllRanges",this.Rm.removeAllRanges(y),a="Selection.selectAllChildren",this.Rm.U1k(y,b))}catch(G){y=La.a.H3f(b),ba.ULS.sendTraceTag(18437461,
324,10,"{{'BrowserAPI':'{0}','HTML':'{1}','Stack':'{2}','Display':{3},'RootElement':{4}}}",a,b?qd.a.g_d(b):"",G.stack,b?b.style.display:"",y?y.tagName+","+y.id+","+y.className:"")}}else this.Rm.gSe(this.nd.KDa().Rl)}gSe(a,b,c,h,m){const y=this.Tc.Pa.mb;try{if(this.kK.mie()&&(!this.kj||this.$e.fch)){var G=y.Ua,U=y.Ye,ja=this.QId.create(this.Lf.Rd);this.oKa(a,b,c,h,m);a=null;var va=this.nd.KDa();if(this.yd.dV){a=this.Rm.getSelection(this.nd.contentWindow);if(!a)return;if(this.Rm.afj(a)){var Ta=this.Rm.getRangeAt(a,
0);this.Rm.removeAllRanges(a)}else Ta=this.Rm.createRange(va.Rl)}else if(this.yd.IF)Ta=va.selection.createRange();else return;this.rTh&&this.r7k(Ta);(this.hf.ek(G)||this.hf.Wl(G))&&this.YXi(G,Ta);this.hf.ek(U)&&this.ZXi(U,Ta);this.yd.dV?this.Rm.addRange(a,Ta):this.yd.IF&&Ta.select();ja.dispose()}}catch(fb){G=this.nd.om(),ba.ULS.sendTraceTag(18437463,324,10,"{{'Message':'{0}','Stack':'{1}','HTML':'{2}'}}",fb.message,fb.stack,G?qd.a.g_d(G):"")}}ZXi(a,b){var c=a.node.sc(this.Zha).gt;let h=0,m=0,y=0;
a=a.Nb;for(var G=!1;h<c.length;){const U=this.Wo.BI(c[h],this.eg,this.ld,this.kj);if(G)y+=U;else if(Sys.UI.DomElement.containsCssClass(c[h],wb.a.hN))m++;else if(!Sys.UI.DomElement.containsCssClass(c[h],S.a.eW)){if(a<=m+U)if(G=a-m,this.yd.dV){c=c[h];this.Jzc.value.B_b(c,this.nd.contentWindow);this.zqh(b,c,G,!1);break}else y=U-G,G=!0;m+=U}h++}this.yd.IF&&this.Rm.moveEnd(b,-y)}YXi(a,b){var c=a.node.sc(this.Zha).gt;let h=0;var m=0;let y=0,G=a.Qa;for(this.hf.Wl(a)&&(G=this.pr.textLength(a.node));h<c.length;)if(a=
this.Wo.BI(c[h],this.eg,this.ld,this.kj),Sys.UI.DomElement.containsCssClass(c[h],wb.a.hN))m++,h++,y+=a;else if(Sys.UI.DomElement.containsCssClass(c[h],S.a.eW))h++,y+=a;else if(this.MQh&&Sys.UI.DomElement.containsCssClass(c[h],wb.a.E_d))h++,y+=a;else{if(G<=m+a){m=G-m;this.yd.dV?(c=c[h],this.Jzc.value.B_b(c,this.nd.contentWindow),this.zqh(b,c,m,!0)):this.Rm.moveStart(b,y+m);break}m+=a;y+=a;h++}}zqh(a,b,c,h){b.childNodes.length?(1<b.childNodes.length||b.firstChild&&3!==b.firstChild.nodeType)&&ba.ULS.sendTraceTag(18437465,
324,50,"Span is not normalized"):ba.ULS.sendTraceTag(18437464,324,10,"Trying to set selection in an empty span");let m=0,y=null;b=La.a.nQc(b,!0);for(let G of b)if(3===G.nodeType){b=G.nodeValue.length;if(c<=m+b){this.Rm.kLb(a,h,G,c-m);return}y=G;m+=b}y?(ba.ULS.sendTraceTag(18437467,324,15,"CP ({0}) was greater than length of all text nodes ({1}), setting at end",c,m),this.Rm.kLb(a,h,y,c-m)):ba.ULS.sendTraceTag(18437466,324,15,"Span contained no text nodes")}PLf(a,b,c,h,m,y,G){var U=this.Tc.Moa;if(U.ale||
U.nje)return!1;var ja=this.nd.om();if(!ja.innerHTML.length)return!1;U=!1;if(this.yd.dV)(b=qd.a.IDa(this.nd.contentWindow))&&(this.Rm.xTc(b)===ja?U=!0:this.kj&&qd.a.cRj(b)&&qd.a.bRj(b)&&(U=!0));else if(this.yd.IF){var va=this.nd.KDa().selection.createRange();va=this.Rm.J9i(va.range);va=va.replace(ta.a.Nzc,"");ja=ja.innerHTML;ja=ja.replace(ta.a.Nzc,"");if(va===ja)switch(a){case 2:U=!0;break;case 1:1<b.length||!(this.hf.Du(b.mb.Ua)||this.hf.Wl(b.mb.Ua)||this.hf.Du(b.mb.Ye)||this.hf.Wl(b.mb.Ye))||(U=
!0)}}if(!U)return!1;this.eg.by++;this.kj&&c?c.Bsa():2===a?this.Ui.XS(this.Ui.XUa,h):1===a&&this.Uib(a,m,y,h,G);return!0}r7k(a){a=La.a.nQc(a.commonAncestorContainer,!0);for(let b of a)b&&(a=La.a.Ija(b),a.startsWith("OutlineElement")&&(-1!==a.toLowerCase().indexOf("rtl")?b.style.direction="rtl":b.style.direction="ltr"),a.toLowerCase().startsWith("paragraph")&&b.parentNode&&b.parentNode.tagName.toLowerCase().startsWith("li")&&(b.style.margin=""))}}Object(n.a)(ui,"SelectContentHelper",null,[]);class Cg{constructor(a,
b,c,h,m,y,G,U,ja,va,Ta,fb,Db,gc,hc,Gc){this.Qha=this.Mpa=this.Ue=null;this.yh=a;this.Ui=b;this.eg=Db;this.Ob=c;this.tf=h;this.nd=m;this.Wd=y;this.Rm=G;this.Wo=U;this.ld=fb;this.Tc=ja;this.kj=hc;this.zK=va;this.tV=Ta;this.Nk=gc;this.XR=Gc}get u_a(){return this.Qha||(this.Qha=vb.a.instance.rb("Box4.ISelectionCommands"))}FS(a){this.Ue=a}Auj(a,b){if(!a)return!1;var c=this.yh.mode;if(2===c)if(!this.Ui.EFj)this.eg.b++,this.Ui.XS(this.Ui.XUa,this.Ob.Vh);else if(this.kj){if(500>(new Date).getTime()-this.tf.Dyi)return this.Ue.htb.wda=
!1;a=qd.a.IDa(this.nd.contentWindow);if(!a)return!1;if(qd.a.JZc(a)){b=this.Ui.FQc(c,this.Ob.Hi);if(this.Ui.XUa===b&&!this.Ue.htb.wda)return this.Mpa&&(this.Wd.Rg(this.Mpa),this.Wd.Eb(this.Mpa)),!1;if(this.XR.Zsd())return this.eg.c++,this.Ue.htb.wda=!0,!1;if(this.Ue.htb.wda)return this.eg.d++,this.tf.oaa(!0),this.Ue.Ps(!0),this.Ue.htb.wda=!1;this.Mpa||this.Ue.Ps(!0);Hh.GrippersManager.instance.setVisibility(!1);this.a6k();return!1}if(this.zK.PLf(c,me.a.instance.Pa,this.u_a,this.Ob.Vh,this.Ob.Hi,this.Ob.Dg,
this.Nk.value.isEditingAllowed||this.Nk.value.Wy))return this.eg.e++,!1;c=this.Wo.A7d(this.Rm.xTc(a),this.Ob.Hi,this.Rm.S4f(a),this.eg,this.ld,this.kj);a=this.Wo.A7d(this.Rm.Q7i(a),this.Ob.Hi,this.Rm.i_f(a),this.eg,this.ld,this.kj);if(0>c||a<c||Ob.ParagraphReader.textLength(b.node)<a)return!1;this.eg.f++;this.Tc.setSelection(yd.SelectionFactory.V2(b.node,c,a))}return!1}a6k(){this.Mpa?this.Wd.Rg(this.Mpa):this.Mpa=new He.a(2,1,1E3,()=>{this.fixupAfterMagnifierDrag()},23);this.Wd.Eb(this.Mpa)}fixupAfterMagnifierDrag(){if(this.Mpa){this.Mpa=
null;var a=this.yh.mode;2===a&&this.Ob.UUa(a)&&(this.eg.g++,this.Ui.updateCaretPosition(a,this.Ob.Hi),this.tf.CKa(!0),this.tV.fixupAfterCursor(5),this.Ue.Ps(!0),Hh.GrippersManager.instance.Puh())}}}Object(n.a)(Cg,"SelectionChangeHandler",null,[1407]);class hl{constructor(a,b){this.nd=a;this.RVb=b}$Rf(a){this.Fvf(this.nd.om(),this.RVb+a.Pr,v.a.lii)}Fvf(a,b,c){for(a=a.firstChild;a;a=a.nextSibling)3!==a.nodeType&&(this.pSk(a),Sys.UI.DomElement.addCssClass(a,b),Sys.UI.DomElement.addCssClass(a,c),this.Fvf(a,
b,c))}pSk(a){var b=a.className;if(b){b=b.split(" ");for(let c=0;c<b.length;c++)b[c].startsWith(this.RVb)&&Sys.UI.DomElement.removeCssClass(a,b[c])}else ba.ULS.sendTraceTag(18437474,324,50,"Class string for DOMElement is null")}}Object(n.a)(hl,"SequenceCodeHelper",null,[1406]);class yj{constructor(a,b,c,h){this.eg=h;this.Ui=b;this.ld=c;this.$a=a}EGk(a,b,c,h){if(a.Ei.length){var m=a.Ei[0].tF,y=La.a.sv(m);if((a=a.XEc)&&y&&y.length===a.length+1&&y.endsWith(" ")){var G=qd.a.C6d(m);G&&((a=Y.a.ye(m,S.a.FFa),
a=b.gt[a+1],a)?qd.a.C6d(a)!==G&&(c=this.Ui.m8(c,h),h=La.a.sv(a),this.ld.Wb("MomentaryIncorrectLinkLength",{["Reason"]:"MovedSpaceOutOfLink"}),this.eg.q++,La.a.Ix(m,y.substring(0,y.length-1)),La.a.Ix(a," "+h),this.Ui.XS(c,b)):this.eg.p++)}}}Hoi(a,b,c){for(let h=0;h<a.childNodes.length;h++){const m=a.childNodes[h];if(m.parentNode===a)if(this.$a.ka("TextLayoutServiceEnableHyperLinkDataLossFix")&&Sys.UI.DomElement.containsCssClass(m,wb.a.g9))for(let y=0;y<m.childNodes.length;y++)this.FBf(m.childNodes[y],
y,b,a,c)&&y--;else this.FBf(m,h,b,a,c)&&h--}}FBf(a,b,c,h,m){const y=a.parentNode;h=y===h;if(3===a.nodeType){let G=-1;const U=a.nodeValue;let ja=null,va="";if(b){const Ta=y.childNodes[b-1];if(vf.a(Ta)&&(!h||Ob.ParagraphReader.Yd(vf.a(Ta).gb))){for(ja=Ta;ja.lastChild&&1===ja.lastChild.nodeType;)ja=ja.lastChild;va=ja.innerText+U}}if(!ja&&b!==y.childNodes.length-1&&(b=y.childNodes[b+1],vf.a(b)&&(!h||Ob.ParagraphReader.Yd(vf.a(b).gb)))){for(ja=b;ja.firstChild&&1===ja.firstChild.nodeType;)ja=ja.firstChild;
va=U+ja.innerText}ja?(G=this.Ui.m8(c,y),this.ld.Wb("MomentaryIncorrectFormatting",{["Reason"]:"MovedSpanlessText"}),this.eg.r++,La.a.Ix(ja,va)):(this.ld.Wb("ValidTextDropped",{["Reason"]:"DroppedSpanlessText"}),this.eg.s++);y.removeChild(a);-1!==G&&this.Ui.XS(G,m);return!0}return!1}sRk(a,b,c,h){if(v.a.fg&&a.Ei.length){var m=La.a.sv(a.Ei[0].tF),y=a.XEc;m&&y&&m.length===y.length+2?this.bhh(0,a,b,c,h):2===a.Ei.length&&this.bhh(1,a,b,c,h)}}bhh(a,b,c,h,m){c=this.Ui.m8(c,h);(h=La.a.sv(b.Ei[a].tF))&&h.endsWith("\u00a0 ")&&
(this.eg.t++,h=h.substr(0,h.lastIndexOf("\u00a0 "))+" ",b.Ei[a].tF.innerText=h,(0<a?c-(b.Ei[0].vHc+La.a.sv(b.Ei[0].tF).length):c-b.Ei[0].vHc)>h.length&&c--,this.Ui.XS(c,m))}}Object(n.a)(yj,"StrayTextCleanupUtils",null,[]);class Oi{constructor(a,b,c,h,m,y,G,U,ja,va,Ta,fb,Db,gc,hc,Gc,Pc,yc,Vd){this.cha=null;this.VKd=a;this.onb=b;this.izd=c;this.ld=h;this.Pha=m;this.yh=y;this.Tc=G;this.R6=U;this.yd=ja;this.tf=va;this.Mk=Ta;this.RB=fb;this.rha=Db;this.Rs=gc;this.LV=hc;this.Zaa=Gc;this.Ob=Pc;this.SOa=
yc;this.fd=Vd}get Mca(){return this.cha||(this.cha=vb.a.instance.rb("Box4.IFormatPainter"))}Ikb(a,b){if(!b)return!1;if(this.VKd.Rsh)return a.pc.preventDefault(),!0;if(this.onb.n7a&&this.yd.pua)return this.onb.n7a=!1,this.izd.cancelEventAndRestoreEditingSurface(a.pc),!0;this.Mca&&this.Mca.oL&&(this.Mca.oL=!1);this.gqj(a.pc);b=this.ld.Vp(D.a.typing);b.properties.$(de.a.source,"TextInput");a=this.lpl(a);b.end();return a}lpl(a){this.Pha.fixupAfterMagnifierDrag();if(1===this.yh.mode){if(this.LV.NVe())this.Tc.setSelection(yd.SelectionFactory.Qg(me.a.instance.Pa.mb.Ua.node,
me.a.instance.Pa.mb.Ua.Qa));else if(this.R6.iWe()){if(this.LV.KHe(a))return!1;this.R6.startHybridTransition()}this.yd.JI&&this.LV.YQd()}this.Zaa.raiseEvent(Zc.a.npl,a);this.tf.oaa(!0);this.Mk.w_e=!0;this.RB.kPa(a);this.SOa&&this.SOa.JIl(this.Ob.Vh);this.rha.rFb();this.Rs.SY();return!1}gqj(a){this.yd.fg||"deleteContentBackward"!==a.rawEvent.inputType||(this.Mk.FYd=!this.Mk.I2,this.Mk.FYd&&u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.ka("DeleteFromInputEventIsEnabled")&&(a=Oi.WSd.FQc(2,this.Ob.Hi),
a<Oi.WSd.XUa&&(a=yd.SelectionFactory.V2(this.Ob.Dg,a,Oi.WSd.XUa),u.AFrameworkApplication.Ta.La(D.a.XQa,2,a))))}static get WSd(){return Oi.Ui||(Oi.Ui=vb.a.instance.resolve("Box4.ICaretPositionManager"))}}Oi.Ui=null;Oi.XR=null;Oi.RH=null;Object(n.a)(Oi,"TextInputEventProcessor",null,[]);class jj{constructor(a,b,c,h,m,y){this.kK=a;this.yd=b;this.$e=c;this.Mk=h;this.Nk=m;this.fd=y}get Xab(){return this.fd.hg&&this.fd.Ny}get Rsh(){if(this.kK.N7b||!this.Nk.value.isEditingAllowed&&this.Nk.value.Wy&&!this.Xab)return!0;
if(this.yd.Y8){var a=this.$e.WWj;if(0<a){var b=(new Date).getTime();a=b-a;b-=this.Mk.Nle;if(500>a&&a<b)return!0}}return!1}}Object(n.a)(jj,"TextInputHandlerUtils",null,[]);var zh=d(512),bk=d(307);class Wk{constructor(a,b,c,h){this.Tpa=null;this.yd=a;this.kK=b;this.Lf=c;this.hf=h}onContextMenu(a,b){let c=!1;this.yd.Y8&&this.kK.SYc&&(b=this.hf.utb(this.Lf.Rd,b,this.Lf.Rd.Hja(a),!1),this.hf.gx(b)&&(c=!0));c?(this.Tpa=a.clientPoint,a=!0):(this.Tpa=null,a=this.Lf.Rd.onContextMenu(a));return a}Vjc(a){if(this.yd.Y8&&
this.Tpa){const b=bk.a.s0e;if(a.clientPoint.x>this.Tpa.x+b||a.clientPoint.x<this.Tpa.x-b||a.clientPoint.y>this.Tpa.y+b||a.clientPoint.y<this.Tpa.y-b)this.Tpa=null}return!1}JGb(a){let b=!1;this.yd.Y8&&this.Tpa&&(b=this.Lf.Rd.onContextMenu(a),this.Tpa=null);return b}}Object(n.a)(Wk,"TouchEventProcessor",null,[]);class Xk{create(a){return new ak(a)}}Object(n.a)(Xk,"TypingActionOperationFactory",null,[1404]);var he=d(71),ik=d(247);class Zf{constructor(a,b,c,h,m,y){this.cof=0;this.Kef=pa.a.nil;this.cTb=
this.Kyc=!1;this.zdf=4===Fc.App.mode;this.iBc=!1;this.F1h=new Sc.a;this.F1h.add(0,D.a.bQe);this.eEc=new Sc.a;this.eEc.add(0,0);this.rff=a;this.Mmb=b;this.Lf=c;this.Bp=h;this.G1h=m;this.lxd=y;this.tef=Object(F.a)(this,this.$Wk,"reportTypingCharCount");u.AFrameworkApplication.cga(()=>{this.N2j()});this.lxd&&this.zPk();this.yPk();u.AFrameworkApplication.Ta&&u.AFrameworkApplication.Ta.ra(D.a.bQe,he.a.frame,ed.ActionManager.Jg,96)}zPk(){this.Bp&&this.Bp.addHandler(kd.a.ey,this.tef)}yPk(){this.Mmb&&this.Mmb.esf(Object(F.a)(this,
this.iGc,"afterEditingViewValidateEventHandler"))}Wnc(a){this.rff.value&&0===this.rff.value.mode||(a=new ak(a),a.end(8),si.a.getInstance().gnc(a),Ni.a.getInstance().fnc(a))}b2g(a,b){if(!this.zdf&&Fc.App.Kb&&2===Fc.App.Kb.mode&&b&&b.graphNode&&Ob.ParagraphReader.Yd(b.graphNode)&&!Ud.a(b.graphNode,5)){if(a=b.graphNode.id,a!==this.Kef){if(this.iBc){var c;(c=this.eEc).$(0,c.ga(0)+1);u.AFrameworkApplication.Ta.processAction(D.a.bQe,2);c="Paragraph rendering is blocked";this.G1h&&(c+=", so graph transaction manager is reset",
ik.GraphTransactionManager.instance.MUe());ba.ULS.sendTraceTag(38547550,323,15,c)}this.Kef=a;this.iBc=!0}}else this.iBc=!1}iGc(a,b){this.zdf||!b.JM&&!b.QU||(!this.Kyc&&this.Lf.Rd&&(this.Lf.Rd.U8h(Object(F.a)(this,this.b2g,"onContentEditableViewClick")),this.Kyc=!0),this.iBc=!1)}$Wk(){this.cof++}OCl(a,b){a!==b&&(a=String.format("CP changed unexpectedly in browser, expected {0} but was {1}",a,b),ba.ULS.sendTraceTag(18437207,323,15,a))}N2j(){this.cTb||(this.lxd&&(ba.ULS.sendTraceTag(38114780,323,50,
""+this.cof),this.xMi(),this.lxd=!1),0<this.eEc.ga(0)&&ba.ULS.sendTraceTag(38536792,323,15,"ParagraphDisappear:{0}",this.eEc.ga(0)),this.wMi(),this.cTb=!0)}xMi(){this.Bp&&this.Bp.removeHandler(kd.a.ey,this.tef)}wMi(){this.Mmb&&this.Mmb.yTk(Object(F.a)(this,this.iGc,"afterEditingViewValidateEventHandler"));this.Kyc&&this.Lf.Rd&&(this.Lf.Rd.CTk(Object(F.a)(this,this.b2g,"onContentEditableViewClick")),this.Kyc=!1)}}Object(n.a)(Zf,"TypingLogger",null,[1384]);const em=a=>{u.AFrameworkApplication.fa.ka("TypingSurveyIsEnabled")&&
(a.execute(b=>{b.sac("WordTypingSurveyTrigger",null)}),a.execute(b=>{window.setTimeout(()=>{b.logActivity("WordTypingSurveyTrigger",null)},300)}))};class nj{constructor(a){this.VXc=!1;this.p7a=5;this.YZg=!1;this.yDe=!0;this.mb=a}}Object(n.a)(nj,"TypingProcessState",null,[]);class vk{constructor(a,b,c,h,m,y,G,U,ja,va,Ta,fb,Db,gc,hc,Gc,Pc,yc,Vd,De,Wd,Ve,$e,Qf,lg,Hg,Qg,Sf,sh,Xg,ni){this.Wha=this.Ue=null;this.mlb=!1;this.Rsd=null;this.c0c=0;this.ZRb=a;this.Ob=b;this.wBd=c;this.Ui=h;this.Z3a=m;this.Bp=
y;this.vzc=G;this.oZ=U;this.tV=ja;this.tf=va;this.Ypa=Ta;this.Tc=fb;this.nK=Db;this.rha=gc;this.ld=hc;this.eg=Gc;this.RH=Pc;this.Wd=yc;this.Mk=Vd;this.Dh=De;this.rD=Wd;this.fqa=Ve;this.Kga=$e;this.yd=Qf;this.nha=lg;this.yk=Hg;this.Rs=Qg;this.xYh=Sf;this.lKd=sh;this.Yr=Xg;this.fd=ni;this.uef=0;this.W$e=!1;this.hEj()}FS(a){this.Ue=a}get F0a(){return this.Wha||(this.Wha=vb.a.instance.rb("Box4.ITextFormattingCommands"))}uvl(){ef.c(18437507,306,100,"TypingProcessInternalCalled");const a=this.fd.Hrb();
try{this.c0c=0;if(this.Ue.nwk.Bul()||2!==this.tf.mode||!this.tf.isActive||u.AFrameworkApplication.Tg||!this.Ob.Dg||this.wBd.correctBadImeState())return;this.Ui.updateCaretPosition(this.tf.mode,this.Ob.Hi);this.Z3a.Z2e();this.Mri();this.Bp.raiseEvent(kd.a.typingProcess);if(!this.Ob.JQa||2===Fc.App.mode&&this.Yr.isComposing)return;const b=new nj(this.oZ.fta(this.tV.f9));if(this.vzc.rFk(b))return;b.VXc||(this.tf.oaa(!0),b.YZg=!0);this.yFk(b);if(!this.Ob.UUa(this.tf.mode))return;const c=this.Ob.uW.gb;
this.fd.hg&&(c.vFb=this.Tc.Pa.mb.Ua.Qa);b.YZg&&J.a.instance.ga(50)&&this.Ypa.value&&this.Ypa.value.lw&&this.Tc.qXb();if(b.yDe){try{this.rha.rFb()}catch(h){this.ld.Wb("PossibleEditSurfaceIncorrectSize",{["Reason"]:"MirrorToPageViewCrash"}),this.eg.l++,this.RH.Ps(!1,!1)}this.Rs.SY();this.Yr.tFa&&(this.RH.Ps(!0,!0),this.cqi())}}finally{a&&a.dispose()}ef.c(18437510,306,100,"TypingProcessInternalExited")}cqi(){Fc.App.Kb.dxj&&Fc.App.Kb.p_k()}kPa(a){this.vzc.Nah(a);this.mlb||(this.mlb=!0,this.Wd.Eb(this.Rsd))}nJi(){if(!this.Mk.I2&&
!this.Mk.esa)return!1;const a=!this.Ypa.value||this.Ypa.value.amIAlone?vk.roj:vk.qoj,b=this.ZRb();-1===this.Mk.x0c&&(this.Mk.x0c=b);return b-this.Mk.x0c<a?(this.Wd.Eb(this.Rsd),this.mlb=!0):!1}typingProcess(){if(this.mlb&&(this.mlb=!1,this.uef++,!this.Wd.mw&&this.Ob.UUa(this.tf.mode)&&!(this.nK&&this.nK.C$a()||this.nJi()))){var a=this.ld.Vp(D.a.typingProcess);this.uvl();a.end();this.W$e||this.uef!==vk.Dpi||((a=vb.a.instance.Ja("Common.ISystemInitiatedFeedback"))&&em(a),this.W$e=!0)}}Mri(){if(this.Yr.tFa){if(this.Dh.Gpf())if((this.yd.MF||
this.yd.to)&&this.rD.e7){const a=this.Ui.m8(this.tf.mode,this.Ob.Hi);this.rD.rjb(!1,this.Ob.Hi,this.Dh);this.Ui.XS(a,this.Ob.Vh)}else this.rD.rjb(!1,this.Ob.Hi,this.Dh);this.xYh.Ari(this.Ob.Vh.gt,this.fqa,this.Ob.Vh,this.Ui.m8(this.tf.mode,this.Ob.Hi),this.Yr.tFa);this.lKd.Hoi(this.Ob.Hi,this.tf.mode,this.Ob.Vh);this.lKd.EGk(this.Dh,this.Ob.Vh,this.tf.mode,this.Ob.Hi);this.Dh.xRk();this.lKd.sRk(this.Dh,this.tf.mode,this.Ob.Hi,this.Ob.Vh)}}yFk(a){this.Kga.tR?(this.Kga.rzk(),a.yDe=!1):this.nha.instance&&
this.nha.instance.Gae()&&!this.yd.UMb&&(this.Yr.tFa&&this.F0a?(this.Bdi(a.mb),a.yDe=!1):this.nha.instance.ZZa())}Bdi(a){if(this.F0a&&this.nha.instance){this.nha.instance.freeze();var b=me.a.instance.Pa.mb,c=this.yk.le(15);c.kd(this.Ob.Dg.node);a=yd.SelectionFactory.wN(a,b.Ua);this.F0a.$Kb(a.Ua,!0);this.nha.instance.H_e();this.nha.instance.ZZa();this.Ob.Vh&&this.Tc.setSelection(this.oZ.fta(this.tV.f9));c.dispose();this.tf.oaa(!0);this.RH.Ps(!0,!1)}}hEj(){let a=1;v.a.to&&(a=u.AFrameworkApplication.fa.Fc("Box4TypingTaskTimeEdge",
1));this.Rsd=new He.a(0,1,a,()=>{this.typingProcess()},25)}dispose(){this.Rsd=null}Lth(a){return this.yd.Y8&&a?this.Kga.tR||this.c0c>vk.kgk||this.nha.instance&&this.nha.instance.Gae()||this.rD.e7?!0:!1:!1}}vk.kgk=7;vk.qoj=250;vk.roj=2E3;vk.Dpi=500;Object(n.a)(vk,"TypingProcessManager",null,[1403,106]);class wk{constructor(){this.Oa=new bd.a}NIk(a){this.Oa.raiseEvent("OnDismissPasteFloatie",a)}TIk(){this.Oa.raiseEvent("OnExpandMenuPasteFloatie")}kNe(a){this.Oa.raiseEvent("OnPastedContentUpdated",a)}GKk(a){this.Oa.raiseEvent("OnShowPasteFloatie",
a)}}Object(n.a)(wk,"PasteFloatieEventSource",null,[1400,1401,1402]);var yl=d(868),tg=d(130),Pi=d(317),Jl=d(400),pm=d(226),hn=d(823);class Em{constructor(){this.Da=null}get name(){return"Box4.ContentEditableView"}$b(a){this.Da=a;a.register(zh.a,"Box4.TextNodeCombiner").as("Box4.ITextNodeCombiner").ma().oa(()=>new zh.a);a.register(bb,"Box4.ContentEditableDomFactory").as("Box4.IContentEditableDomFactory").ma().oa(()=>new bb);a.register(Ai,"Box4.EventFrequencyTracker").ma().oa(()=>new Ai);a.register(be,
"Box4.CevUsageDataTracker").ma().oa(()=>new be);a.register(ve,"Box4.ContentEditableViewEventSource").ma().oa(()=>new ve);a.register(Ic,"Box4.CurrentlyActiveContentSpans").as("Box4.ICurrentlyActiveContentSpans").ma().oa(()=>new Ic(ec.a.instance,jc.a.instance.t4d(),a.resolve("Box4.TextNodeCombiner")));a.register(sc,"Box4.OriginalElementContentArray").as("Box4.IOriginalElementContentArray").ma().oa(()=>new sc(ec.a.instance,jc.a.instance.t4d(),Ub.instance,a.resolve("Box4.IContentEditableViewContentControlHelper")));
a.register(Yj,"Box4.EditingDomManager").as("Box4.IEditingDomManager").ma().oa(()=>new Yj);a.register(hi,"Box4.EditStateEventManager").as("Box4.IEditStateEventManager").ma().oa(()=>new hi(a.resolve("Box4.IEditingDomManager")));a.register(nb,"Box4.ContentEditableViewPaddingManager").as("Box4.IContentEditableViewPaddingManager").ma().oa(()=>new nb(a.resolve("Box4.EditStateEventManager"),ec.a.instance,a.resolve("Box4.CevUsageDataTracker").mI,a.resolve("Box4.EditingDomManager"),a.resolve("Common.IAppSettingsManager").ka("RemovePaddingHighlightEnabled")));
a.register(1384,"Box4.ITypingLogger").ma().oa(()=>new Zf(a.re("Box4.IEditingModeTransitionManager"),a.resolve("Box4.ContentEditableViewEventSource"),na.InteractiveViewManager.instance,a.resolve("Box4.EditStateEventManager"),a.resolve("Common.IAppSettingsManager").ka("QoETypingImprovementIsEnabled"),a.resolve("Common.IAppSettingsManager").ka("QoECharCountIsEnabled")));a.register(Sg,"Box4.CaretPositionManager").as("Box4.ICaretPositionManager").ma().oa(()=>new Sg(a.re("Box4.ITextNodeCombiner"),ec.a.instance,
a.resolve("Box4.CevUsageDataTracker").mI,a.resolve("Box4.EditingDomManager"),Ub.instance,Lc.a.instance,na.InteractiveViewManager.instance,u.AFrameworkApplication.we,Lc.a.instance.Ni,yl.a.instance,a.resolve("Common.IScrollLockFactory"),a.resolve("Box4.IContentEditableViewContentControlHelper"),a.resolve("Box4.ITypingLogger")));a.register(hj,"Box4.ContentEditableViewFocusHelper").as("Box4.IContentEditableViewFocusHelper").ma().oa(()=>new hj(a.resolve("Box4.EditingDomManager"),na.InteractiveViewManager.instance,
a.resolve("Box4.IExternalSelectionManager"),Lc.a.instance.Ni,nd.a.instance,Lc.a.instance,C.FocusManager.instance()));a.register(Il,"Box4.ReadOnlyObjectsCleaner").ma().oa(()=>new Il(ec.a.instance,a.resolve("Box4.CevUsageDataTracker").mI,a.resolve("Box4.CaretPositionManager"),Ub.instance,Lc.a.instance));a.register(yj,"Box4.StrayTextCleanupUtils").ma().oa(()=>new yj(u.AFrameworkApplication.fa,a.resolve("Box4.CaretPositionManager"),ec.a.instance,a.resolve("Box4.CevUsageDataTracker").mI));a.register(1385,
"Box4.IContentEditableViewContentControlHelper").ma().oa(()=>new Lf(ec.a.instance,a.resolve("Box4.CevUsageDataTracker").mI,Lc.a.instance.Ni,Ub.instance,na.InteractiveViewManager.instance,a.resolve("Box4.IParagraphReader")));a.register(hg,"Box4.ActiveContentSpansPersistanceManager").as("Box4.IActiveContentSpansPersistanceManager").ma().oa(()=>new hg(a.resolve("Box4.ICurrentlyActiveContentSpans"),a.resolve("Box4.IContentEditableViewPaddingManager"),a.resolve("Box4.IOriginalElementContentArray"),a.resolve("Box4.CevUsageDataTracker").mI,
ec.a.instance,a.rb("Box4.IHyperlinkEditor"),Lc.a.instance,a.resolve("Box4.IContentEditableViewContentControlHelper"),yl.a.instance,a.resolve("Box4.IEditingDomManager"),a.resolve("Box4.IEditViewStateManager"),a.resolve("Common.IAppSettingsManager")));a.register(Md,"Box4.CevViewContentManager").as("Box4.ICevViewContentManager").ma().oa(()=>new Md(a.Ja("Common.ITypingSpeedMeterProvider"),na.InteractiveViewManager.instance));a.register(Kb,"Box4.ContentEditableViewTypingState").ma().oa(()=>new Kb(u.AFrameworkApplication.Ta));
a.register(Jc,"Box4.ContentEditableHtmlStructureUtils").ma().oa(()=>new Jc(a.resolve("Box4.IEditingDomManager"),a.resolve("Box4.ContentEditableViewTypingState")));a.register(hl,"Box4.SequenceCodeHelper").ma().oa(()=>new hl(a.resolve("Box4.IEditingDomManager"),a.resolve("Box4.IConstantsProvider").toh));a.register(ui,"Box4.SelectContentHelper").ma().oa(()=>new ui(a.resolve("Box4.IEditingDomManager"),a.resolve("Box4.SequenceCodeHelper"),a.resolve("Box4.ContentEditableViewFocusHelper"),a.resolve("Box4.CevUsageDataTracker").mI,
ec.a.instance,a.re("Box4.ITextNodeCombiner"),me.a.instance,a.resolve("Box4.ICaretPositionManager"),Ub.instance,Lc.a.instance,Fd.EventHandlerManager.instance,Pi.a.instance,na.InteractiveViewManager.instance,Lc.a.instance.Ni,a.resolve("Common.ScrollLockFactory"),yl.a.instance,a.resolve("Box4.IParagraphReader"),Wb.ListReader.ix,a.resolve("Box4.IContentEditableViewContentControlHelper"),a.resolve("Common.IAppSettingsManager").ka("FixUpEmptySpanInSelectionBeginIsEnabled")));a.register(Bh,"Box4.EditingDomDisplayManipulator").ma().oa(()=>
new Bh(a.resolve("Box4.IEditingDomManager"),a.resolve("Box4.IContentEditableViewPaddingManager"),a.resolve("Box4.EditStateEventManager"),a.resolve("Box4.SelectContentHelper"),u.AFrameworkApplication.fa,na.InteractiveViewManager.instance));a.register(Mg,"Box4.EditViewStateManager").as("Box4.IEditViewStateManager").ma().oa(()=>new Mg(a.resolve("Box4.ContentEditableViewEventSource")));a.register(bg,"Box4.InteractiveViewSynchronizer").ma().oa(()=>new bg(a.resolve("Box4.ICurrentlyActiveContentSpans"),
a.resolve("Box4.CevUsageDataTracker").mI,ec.a.instance,Lc.a.instance.Ni,a.resolve("Box4.Graph.IGraphIteratorFactory"),Ub.instance,na.InteractiveViewManager.instance,a.resolve("Box4.IEditViewStateManager"),a.resolve("Box4.ICevViewContentManager")));a.register(dc,"Box4.CurrentEditSelectionProvider").ma().oa(()=>new dc(a.resolve("Box4.ICaretPositionManager"),a.resolve("Box4.CevUsageDataTracker").mI,ec.a.instance,Ub.instance,a.resolve("Box4.IEditViewStateManager"),a.resolve("Box4.ICevViewContentManager"),
Lc.a.instance.Ni,a.resolve("Box4.IContentEditableViewContentControlHelper")));a.register(pf,"Box4.BackspaceInBrowserHandler").ma().oa(()=>new pf(a.resolve("Box4.CurrentEditSelectionProvider"),Lc.a.instance.Ni,Dc.a.instance,Pi.a.instance,a.resolve("Box4.IExternalSelectionManager"),pm.a.instance,u.AFrameworkApplication.fa.ka("PPTLineBoxEnabled"),a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,a.resolve("Box4.IHyperlinkStrategy"),u.AFrameworkApplication.fa.ka("AutoCorrectUndoByBackspaceIsEnabled")?
a.Ja("Box4.IAutoCorrectScheduler"):null));a.register(Tc,"Box4.OvertypeDomPreparer").ma().oa(()=>new Tc(a.resolve("Box4.ICurrentlyActiveContentSpans"),a.resolve("Box4.ContentEditableViewPaddingManager"),me.a.instance,ec.a.instance,a.resolve("Box4.CevUsageDataTracker").mI,Ub.instance,Lc.a.instance.Ni,a.resolve("Box4.IContentEditableViewContentControlHelper")));a.register(Id,"Box4.CutCopyHandler").as("Box4.ICutCopyHandler").ma().oa(()=>new Id(Pi.a.instance,me.a.instance,ec.a.instance,a.resolve("Box4.IEditViewStateManager"),
a.resolve("Box4.EditStateEventManager"),na.InteractiveViewManager.instance,a.resolve("Box4.ICurrentlyActiveContentSpans"),a.resolve("Box4.ICevViewContentManager"),Lc.a.instance,a.resolve("Box4.SelectContentHelper"),new sb.a(()=>Fc.App.Kb.Jd),a.Ja("Box4.IClipboardCommands"),a.resolve("Box4.ICannotCutDialog"),a.resolve("Common.IDelayOperationFactory"),a.resolve("Box4.IClipboardDataHelper"),a.resolve("Box4.IEditingDomManager"),u.AFrameworkApplication.fa,u.AFrameworkApplication.Ta,a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance));
a.register(wk,"Box4.PasteFloatieEventSource").as("Box4.IPasteFloatieEventSource").as("Box4.IPasteFloatieEventHandler").as("Box4.IPasteFloatieEventNotifier").ma().oa(()=>new wk);a.register(Ze,"Box4.BackspaceDeleteEventSource").as("Box4.IBackspaceDeleteEventSource").as("Box4.IBackspaceDeleteEventNotifier").ma().oa(()=>new Ze);a.register(ie,"Box4.BoundsSynchronizer").as("Box4.IBoundsSynchronizer").ma().oa(()=>new ie(a.Ja("Box4.IListMarkerUtility"),a.resolve("Box4.IEditingDomManager"),a.Ja("Common.IZoomManager"),
a.resolve("Box4.EditingDomDisplayManipulator"),Lc.a.instance,na.InteractiveViewManager.instance,a.resolve("Box4.IEditViewStateManager"),a.resolve("Box4.ICevViewContentManager"),a.resolve("Box4.IRotatingCoordinateConverter")));a.register($i,"Box4.EditingSurfaceStateManager").ma().oa(()=>new $i);a.register(Wh,"Box4.EditingModeTransitionManager").as("Box4.IEditingModeTransitionManager").ma().oa(()=>new Wh(a.resolve("Box4.ICevViewContentManager"),a.resolve("Box4.Graph.IGraphTransactionFactory"),a.resolve("Box4.EditingDomDisplayManipulator"),
a.resolve("Box4.EditStateEventManager"),a.resolve("Box4.EditingSurfaceStateManager"),u.AFrameworkApplication.we,a.resolve("Box4.IEditingDomManager"),a.resolve("Box4.EditViewStateManager"),a.resolve("Box4.ContentEditableViewFocusHelper"),new sb.a(()=>Fc.App.Kb.Jd),Lc.a.instance,a.resolve("Box4.IContentEditableViewPaddingManager"),me.a.instance,a.resolve("Box4.IExternalSelectionManager"),a.resolve("Box4.ICurrentlyActiveContentSpans"),na.InteractiveViewManager.instance,Pi.a.instance,a.resolve("Box4.IInteractiveEventHandler"),
a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance));a.register(Ih,"Box4.ParagraphOverlayPositioner").ma().oa(()=>new Ih(a.resolve("Box4.IEditingDomManager"),new hn.a,na.InteractiveViewManager.instance,a.resolve("Box4.IEditingModeTransitionManager"),a.resolve("Box4.ICevViewContentManager"),a.resolve("Box4.IParagraphOverlayControlRenderer")));a.register(Af,"Box4.ContentEditableViewDebugLogger").ma().oa(()=>new Af);a.register(Ii,"Box4.ImeRecoveryUtils").ma().oa(()=>new Ii(Lc.a.instance,
a.resolve("Box4.IEditingDomManager"),a.resolve("Box4.IEditingModeTransitionManager"),a.resolve("Box4.Graph.IGraphTransactionFactory"),ec.a.instance,a.resolve("Box4.CevUsageDataTracker").mI,a.resolve("Box4.ContentEditableViewDebugLogger"),yl.a.instance));a.register(If,"Box4.AutocorrectActionExecutor").ma().oa(()=>new If(a.Ja("Box4.IAutoCorrectScheduler"),a.Ja("Box4.IAutoCorrectRules"),a.resolve("Box4.IEditViewStateManager"),a.resolve("Box4.ICevViewContentManager"),a.resolve("Box4.ICurrentlyActiveContentSpans"),
a.resolve("Box4.CurrentEditSelectionProvider"),a.resolve("Box4.EditStateEventManager"),a.resolve("Box4.CaretPositionManager"),a.re("Box4.IUndoManager"),a.resolve("Box4.BoundsSynchronizer"),a.resolve("Box4.EditViewStateManager"),a.resolve("Box4.ContentEditableHtmlStructureUtils"),a.resolve("Box4.Graph.IGraphTransactionFactory"),me.a.instance,a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,a.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance));a.register(ai,"Box4.PasteHandler").as("Box4.IPasteHandler").ma().oa(()=>
new ai(a.resolve("Common.IAppSettingsManager"),u.AFrameworkApplication.we,ec.a.instance,a.resolve("Box4.Graph.IGraphTransactionFactory"),me.a.instance,a.resolve("Box4.IEditingModeTransitionManager"),a.resolve("Box4.IEditingDomManager"),a.resolve("Box4.EditingDomDisplayManipulator"),na.InteractiveViewManager.instance,Lc.a.instance,a.resolve("Box4.SelectContentHelper"),a.resolve("Box4.CevViewContentManager"),a.resolve("Box4.AutocorrectActionExecutor"),new sb.a(()=>Fc.App.Kb.Jd),a.Ja("Box4.IClipboardCommands"),
a.resolve("Box4.IClipboardDataHelper"),a.resolve("Box4.IFileReaderHelperFactory"),a.resolve("Common.IDelayOperationFactory"),a.resolve("Common.ISimpleOperationFactory"),a.resolve("Box4.IProcessImageStrategy"),u.AFrameworkApplication.Ta,Ja.a.get_instance(),()=>new db.a,a.resolve("Box4.IPasteFloatieEventSource"),a.resolve("Common.Utils.Telemetry.ITelemetry"),Fc.App.instance.d9b,Fc.App.instance.NLb));a.register(ri,"Box4.ContentEditableViewCursorManager").ma().oa(()=>new ri(na.InteractiveViewManager.instance,
ec.a.instance,a.resolve("Box4.CevUsageDataTracker").mI,Lc.a.instance.Ni,me.a.instance,Pi.a.instance,a.resolve("Box4.IExternalSelectionManager"),a.resolve("Box4.EditingModeTransitionManager"),a.resolve("Box4.ICevViewContentManager"),new sb.a(()=>Fc.App.Kb.Jd),u.AFrameworkApplication.Ta,a.resolve("Box4.IEditViewStateManager"),u.AFrameworkApplication.we,Lc.a.instance,a.resolve("Box4.ICaretPositionManager"),Ub.instance,a.resolve("Box4.ICurrentlyActiveContentSpans"),a.resolve("Box4.IContentEditableViewFocusHelper"),
a.resolve("Box4.IEditingDomManager"),a.resolve("Box4.IContentEditableViewPaddingManager"),new ic,a.resolve("Box4.IContentEditableViewContentControlHelper"),a.rb("Box4.CharacterPointConverter")));a.register(Cg,"Box4.SelectionChangeHandler").as("Box4.ISelectionChangeHandler").ma().oa(()=>new Cg(a.resolve("Box4.IEditingModeTransitionManager"),a.resolve("Box4.ICaretPositionManager"),a.resolve("Box4.ICevViewContentManager"),a.resolve("Box4.EditViewStateManager"),a.resolve("Box4.IEditingDomManager"),u.AFrameworkApplication.we,
yl.a.instance,Ub.instance,me.a.instance,a.resolve("Box4.SelectContentHelper"),a.resolve("Box4.ContentEditableViewCursorManager"),ec.a.instance,a.resolve("Box4.CevUsageDataTracker").mI,new sb.a(()=>Fc.App.Kb.Jd),Lc.a.instance.Ni,a.resolve("Box4.ContentEditableHtmlStructureUtils")));a.register(Sj,"Box4.HybridTransitionManager").as("Box4.IHybridTransitionManager").ma().oa(()=>new Sj(a.resolve("Box4.OvertypeDomPreparer"),a.resolve("Box4.IEditingModeTransitionManager"),a.resolve("Box4.EditStateEventManager"),
a.re("Box4.IUndoManager"),a.resolve("Box4.EditingDomDisplayManipulator"),a.resolve("Box4.Graph.GraphTransactionFactory"),a.resolve("Box4.CevViewContentManager"),na.InteractiveViewManager.instance,u.AFrameworkApplication.we,new sb.a(()=>Fc.App.Kb.Jd),a.resolve("Box4.EditViewStateManager"),a.resolve("Box4.ICaretPositionManager"),a.resolve("Box4.ICurrentlyActiveContentSpans"),a.resolve("Box4.BoundsSynchronizer"),a.resolve("Box4.InteractiveViewSynchronizer"),a.resolve("Box4.ContentEditableHtmlStructureUtils"),
me.a.instance,Dc.a.instance));a.register(Vc,"Box4.CompositionStateManager").ma().oa(()=>new Vc(a.resolve("Box4.ContentEditableViewEventSource"),a.resolve("Box4.EditStateEventManager"),a.resolve("Box4.HybridTransitionManager")));a.register(ti,"Box4.ImeManager").ma().oa(()=>new ti(a.resolve("Box4.CompositionStateManager"),a.resolve("Box4.IEditingModeTransitionManager"),a.resolve("Box4.IEditingDomManager"),a.resolve("Box4.ICurrentlyActiveContentSpans"),na.InteractiveViewManager.instance));a.register(Bf,
"Box4.DragStateManager").ma().oa(()=>new Bf(Lc.a.instance));a.register(Wk,"Box4.TouchEventProcessor").ma().oa(()=>new Wk(Lc.a.instance,a.resolve("Box4.ContentEditableViewFocusHelper"),na.InteractiveViewManager.instance,Pi.a.instance));a.register(rf,"Box4.AppFrameResizeEventProcessor").ma().oa(()=>new rf(a.resolve("Box4.BoundsSynchronizer")));a.register(Hb,"Box4.OnScrollProcessor").ma().oa(()=>new Hb(a.resolve("Box4.CevUsageDataTracker").mI,a.resolve("Box4.IEditingModeTransitionManager"),a.resolve("Box4.InteractiveViewSynchronizer"),
a.resolve("Box4.BoundsSynchronizer")));a.register(Hi,"Box4.EditingSurfaceEventHandlerUtils").ma().oa(()=>new Hi(ec.a.instance,a.resolve("Box4.CevUsageDataTracker").mI,a.resolve("Box4.IEditingModeTransitionManager")));a.register(Hd,"Box4.DragEventsProcessor").ma().oa(()=>new Hd(Lc.a.instance,a.resolve("Box4.DragStateManager"),a.resolve("Box4.EditingSurfaceEventHandlerUtils")));a.register(Od,"Box4.DoubleClickProcessor").ma().oa(()=>new Od(a.resolve("Box4.CaretPositionManager"),a.resolve("Box4.IEditingModeTransitionManager"),
a.resolve("Box4.CevViewContentManager"),na.InteractiveViewManager.instance));a.register(ae,"Box4.DomChangeEventProcessor").ma().oa(()=>new ae(Lc.a.instance,a.resolve("Box4.IEditingModeTransitionManager"),a.resolve("Box4.CompositionStateManager"),ec.a.instance,a.resolve("Box4.EditViewStateManager"),a.resolve("Box4.InteractiveViewSynchronizer"),a.resolve("Box4.BoundsSynchronizer"),u.AFrameworkApplication.fa.ka("SkipUpdateGraphWhenComposing")));a.register(jj,"Box4.TextInputHandlerUtils").ma().oa(()=>
new jj(a.resolve("Box4.IContentEditableViewFocusHelper"),Lc.a.instance,Fd.EventHandlerManager.instance,a.resolve("Box4.ContentEditableViewTypingState"),new sb.a(()=>Fc.App.Kb.Jd),a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance));a.register(yh,"Box4.ContentEditableViewGraphUpdater").ma().oa(()=>new yh(id.a.instance,a.resolve("Box4.EditingModeTransitionManager"),ec.a.instance,me.a.instance,a.resolve("Box4.IExternalSelectionManager"),Pi.a.instance,a.resolve("Box4.IEditViewStateManager"),
a.resolve("Box4.Graph.GraphIteratorFactory"),a.resolve("Box4.ICevViewContentManager"),a.resolve("Box4.ContentEditableViewTypingState"),a.resolve("Box4.IContentEditableViewPaddingManager"),a.resolve("Box4.ICurrentlyActiveContentSpans"),a.resolve("Box4.EditingDomManager"),a.resolve("Box4.ContentEditableViewCursorManager"),a.resolve("Box4.ContentEditableHtmlStructureUtils"),a.resolve("Box4.EditingSurfaceStateManager"),a.resolve("Box4.CurrentEditSelectionProvider"),a.resolve("Box4.CharacterPropertiesEditor"),
a.resolve("Box4.ISelectionChangeHandler"),a.resolve("Box4.ICaretPositionManager"),a.resolve("Box4.ParagraphOverlayPositioner"),a.resolve("Box4.BoundsSynchronizer"),a.resolve("Box4.CevUsageDataTracker").mI,a.resolve("Box4.HybridTransitionManager"),u.AFrameworkApplication.we,Lc.a.instance,a.Ja("Box4.IInsertionPointFormatting"),a.resolve("Box4.IActiveContentSpansPersistanceManager"),a.resolve("Box4.IParagraphReader"),a.resolve("Box4.Graph.GraphTransactionFactory"),a.resolve("Box4.Proofing.IModifiedRangeEditor"),
a.rb("Box4.CharacterPointConverter"),a.resolve("Box4.ITypingLogger")));a.register(Oa,"Box4.KeyEntryProcessor").ma().oa(()=>new Oa(Ub.instance,a.resolve("Box4.ICevViewContentManager"),a.resolve("Box4.CevUsageDataTracker").mI,ec.a.instance,Lc.a.instance.Ni,a.resolve("Box4.IContentEditableViewPaddingManager"),a.resolve("Box4.ContentEditableViewGraphUpdater"),a.resolve("Box4.ContentEditableHtmlStructureUtils"),a.resolve("Box4.IEditingModeTransitionManager"),a.resolve("Box4.ICaretPositionManager"),a.resolve("Box4.CurrentEditSelectionProvider"),
a.resolve("Box4.ContentEditableViewCursorManager"),Pi.a.instance,a.resolve("Box4.ContentEditableViewTypingState"),a.resolve("Box4.EditViewStateManager")));a.register(Qd,"Box4.KeyQueueProcessor").ma().oa(()=>new Qd(a.resolve("Box4.KeyEntryProcessor"),a.resolve("Box4.EditViewStateManager"),a.resolve("Box4.ICevViewContentManager"),Pi.a.instance,me.a.instance,a.resolve("Box4.ContentEditableViewGraphUpdater"),a.resolve("Box4.ICaretPositionManager")));a.register(vk,"Box4.TypingProcessManager").as("Box4.ITypingProcessManager").ma().oa(()=>
new vk(qd.a.tj,a.resolve("Box4.ICevViewContentManager"),a.resolve("Box4.ImeRecoveryUtils"),a.resolve("Box4.ICaretPositionManager"),a.resolve("Box4.ParagraphOverlayPositioner"),a.resolve("Box4.EditStateEventManager"),a.resolve("Box4.KeyQueueProcessor"),a.resolve("Box4.CurrentEditSelectionProvider"),a.resolve("Box4.ContentEditableViewCursorManager"),a.resolve("Box4.EditViewStateManager"),new sb.a(()=>Fc.App.Ih),me.a.instance,a.resolve("Box4.IExternalSelectionManager"),a.resolve("Box4.InteractiveViewSynchronizer"),
ec.a.instance,a.resolve("Box4.CevUsageDataTracker").mI,a.resolve("Box4.ContentEditableViewGraphUpdater"),u.AFrameworkApplication.we,a.resolve("Box4.ContentEditableViewTypingState"),a.resolve("Box4.ICurrentlyActiveContentSpans"),a.resolve("Box4.IContentEditableViewPaddingManager"),a.resolve("Box4.IOriginalElementContentArray"),a.resolve("Box4.AutocorrectActionExecutor"),Lc.a.instance,a.Ja("Box4.IInsertionPointFormatting"),a.resolve("Box4.Graph.GraphTransactionFactory"),a.resolve("Box4.BoundsSynchronizer"),
a.resolve("Box4.ReadOnlyObjectsCleaner"),a.resolve("Box4.StrayTextCleanupUtils"),a.resolve("Box4.CompositionStateManager"),a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance));a.register(pg,"Box4.OvertypeUtils").ma().oa(()=>new pg(new Ca(u.AFrameworkApplication.we),a.resolve("Box4.EditingModeTransitionManager"),Lc.a.instance,me.a.instance,a.resolve("Box4.ITypingLogger"),Pi.a.instance,new sb.a(()=>Fc.App.Kb.Jd),na.InteractiveViewManager.instance,a.resolve("Box4.CompositionStateManager"),
a.resolve("Box4.HybridTransitionManager"),Lc.a.instance.Ni,a.resolve("Box4.CevViewContentManager"),a.resolve("Box4.SelectContentHelper"),a.resolve("Box4.TypingProcessManager"),a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,a.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance));a.register(gi,"Box4.ContentEditableViewFloatieHandler").ma().oa(()=>new gi);a.register(re,"Box4.KeyUpProcessor").ma().oa(()=>new re(ec.a.instance,a.resolve("Box4.SelectContentHelper"),a.resolve("Box4.EditingModeTransitionManager"),
a.resolve("Box4.CompositionStateManager"),a.resolve("Box4.ICevViewContentManager"),new sb.a(()=>Fc.App.Kb.Jd),a.resolve("Box4.InteractiveViewSynchronizer"),a.resolve("Box4.IBoundsSynchronizer"),a.resolve("Box4.KeyQueueProcessor"),a.resolve("Box4.EditingDomManager"),a.resolve("Box4.ContentEditableViewFloatieHandler"),a.resolve("Box4.TypingProcessManager")));const b=!!u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.ka("TableEditingSelectIsEnabled");a.register(Cc,"Box4.KeyPressProcessor").ma().oa(()=>
new Cc(Lc.a.instance,yl.a.instance,ec.a.instance,a.resolve("Box4.ISelectionChangeHandler"),new sb.a(()=>Fc.App.Kb.Jd),a.resolve("Box4.OvertypeUtils"),a.resolve("Box4.IHybridTransitionManager"),a.resolve("Box4.CompositionStateManager"),a.resolve("Box4.EditViewStateManager"),me.a.instance,a.resolve("Box4.EditingDomManager"),a.resolve("Box4.EventFrequencyTracker"),a.resolve("Box4.ICaretPositionManager"),a.resolve("Box4.AutocorrectActionExecutor"),Ub.instance,a.resolve("Box4.ICevViewContentManager"),
a.resolve("Box4.ContentEditableViewCursorManager"),a.resolve("Box4.ICurrentlyActiveContentSpans"),new sb.a(()=>Fc.App.Ih),a.resolve("Box4.EditStateEventManager"),a.resolve("Box4.TypingProcessManager"),a.resolve("Box4.ContentEditableViewEventSource"),a.Ja("Common.ITypingSpeedMeterProvider"),b,tg.ContextSetEditor.instance,a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,a.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,a.rb("Common.IEventTimingMeter")));a.register(sa,
"Box4.KeyDownProcessor").ma().oa(()=>new sa(a.Ja("Common.ITypingSpeedMeterProvider"),Lc.a.instance.Ni,u.AFrameworkApplication.we,a.resolve("Box4.IEditingDomManager"),ec.a.instance,a.resolve("Box4.CevUsageDataTracker").mI,a.resolve("Box4.ITypingLogger"),a.resolve("Box4.ISelectionChangeHandler"),a.resolve("Box4.ContentEditableViewCursorManager"),a.resolve("Box4.ICevViewContentManager"),a.resolve("Box4.ICaretPositionManager"),Lc.a.instance,yl.a.instance,a.resolve("Box4.CurrentEditSelectionProvider"),
Pi.a.instance,a.resolve("Box4.ContentEditableHtmlStructureUtils"),a.resolve("Box4.ContentEditableViewGraphUpdater"),new sb.a(()=>Fc.App.Ih),me.a.instance,a.resolve("Box4.EditViewStateManager"),a.resolve("Box4.CompositionStateManager"),a.re("Box4.IUndoManager"),a.resolve("Box4.TypingProcessManager"),a.resolve("Box4.CharacterPropertiesEditor"),new sb.a(()=>Fc.App.Kb.Jd),a.resolve("Box4.SelectContentHelper"),a.resolve("Box4.ContentEditableViewFloatieHandler"),a.resolve("Box4.ContentEditableViewTypingState"),
a.resolve("Box4.ImeManager"),a.resolve("Box4.OvertypeUtils"),a.resolve("Box4.BackspaceInBrowserHandler"),u.AFrameworkApplication.fa.ka("SkipUpdateGraphWhenComposing"),a.resolve("Box4.Graph.IGraphTransactionFactory"),u.AFrameworkApplication.Ta,a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,a.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,a.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance,a.rb("Common.IEventTimingMeter"),a.resolve("Box4.IRotatingCoordinateConverter"),
Jl.a.instance,a.resolve("Box4.IPasteFloatieEventSource"),a.resolve("Box4.EditStateEventManager"),a.resolve("Box4.IBackspaceDeleteEventSource"),u.AFrameworkApplication.fa.ka("AutoCorrectUndoByBackspaceIsEnabled")?a.Ja("Box4.IAutoCorrectScheduler"):null,u.AFrameworkApplication.fa,a.rb("Box4.IHyperlinkEditor")));a.register(Rj,"Box4.ContentEditableViewOnAfterValidateHandler").ma().oa(()=>new Rj(a.resolve("Box4.ContentEditableViewEventSource"),a.resolve("Box4.EditingModeTransitionManager"),a.resolve("Box4.CevViewContentManager"),
na.InteractiveViewManager.instance,a.resolve("Box4.EditingDomManager"),a.resolve("Box4.ContentEditableViewCursorManager"),a.resolve("Box4.IBoundsSynchronizer"),a.resolve("Box4.ContentEditableViewDebugLogger"),a.resolve("Box4.IContentEditableViewPaddingManager"),Lc.a.instance,a.resolve("Box4.CevUsageDataTracker").mI,a.resolve("Box4.IParagraphReader"),a.resolve("Box4.ICurrentlyActiveContentSpans"),a.resolve("Box4.ContentEditableHtmlStructureUtils"),a.re("Box4.ITextNodeCombiner"),a.resolve("Box4.IOriginalElementContentArray"),
a.resolve("Box4.IContentEditableViewFocusHelper"),a.resolve("Box4.ParagraphOverlayPositioner"),me.a.instance,Lc.a.instance.Ni,a.resolve("Box4.SelectContentHelper"),new sb.a(()=>Fc.App.Kb.Jd),a.resolve("Box4.ContentEditableViewTypingState"),a.resolve("Box4.EditStateEventManager"),a.resolve("Box4.Graph.IGraphIteratorFactory"),a.rb("Box4.ITabRenderer"),a.resolve("Box4.IPasteFloatieEventSource"),a.rb("Box4.IFeatureHelper")));a.register(Ia,"Box4.ContentEditableViewOnBeforeValidateHandler").ma().oa(()=>
new Ia(a.resolve("Box4.IBoundsSynchronizer"),a.resolve("Box4.ContentEditableViewDebugLogger"),a.resolve("Box4.CompositionStateManager"),a.resolve("Box4.IEditingDomManager"),a.resolve("Box4.EditStateEventManager")));a.register(Yf,"Box4.CompositionEventProcessor").ma().oa(()=>new Yf(a.resolve("Box4.ContentEditableViewFocusHelper"),a.resolve("Box4.TextInputHandlerUtils"),ec.a.instance,a.resolve("Box4.ImeRecoveryUtils"),a.resolve("Box4.ITypingLogger"),a.resolve("Box4.SelectionChangeHandler"),a.resolve("Box4.ContentEditableViewTypingState"),
a.resolve("Box4.IEditingModeTransitionManager"),a.resolve("Box4.CompositionStateManager"),a.resolve("Box4.EditViewStateManager"),a.resolve("Box4.ImeManager"),a.resolve("Box4.ContentEditableViewEventSource"),a.resolve("Box4.TypingProcessManager"),a.resolve("Box4.OvertypeUtils"),u.AFrameworkApplication.fa.ka("SkipUpdateGraphWhenComposing")));a.register(Oi,"Box4.TextInputEventProcessor").ma().oa(()=>new Oi(a.resolve("Box4.TextInputHandlerUtils"),a.resolve("Box4.DragStateManager"),a.resolve("Box4.EditingSurfaceEventHandlerUtils"),
ec.a.instance,a.resolve("Box4.SelectionChangeHandler"),a.resolve("Box4.EditingModeTransitionManager"),me.a.instance,a.resolve("Box4.HybridTransitionManager"),Lc.a.instance,a.resolve("Box4.EditViewStateManager"),a.resolve("Box4.ContentEditableViewTypingState"),a.resolve("Box4.TypingProcessManager"),a.resolve("Box4.InteractiveViewSynchronizer"),a.resolve("Box4.IBoundsSynchronizer"),a.resolve("Box4.OvertypeUtils"),a.resolve("Box4.ContentEditableViewEventSource"),a.resolve("Box4.ICevViewContentManager"),
a.rb("Box4.ITabRenderer"),a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance));a.register(ob,"Box4.LostFocusEventProcessor").ma().oa(()=>new ob(a.resolve("Box4.ContentEditableViewGraphUpdater")));a.register(Zj,"Box4.EditingSurfaceEventHandlerManager").ma().oa(()=>new Zj(u.AFrameworkApplication.we,a.resolve("Box4.IEditViewStateManager"),a.resolve("Box4.ICevViewContentManager"),a.resolve("Box4.KeyUpProcessor"),a.resolve("Box4.ContentEditableViewTypingState"),a.resolve("Box4.KeyPressProcessor"),
a.resolve("Box4.KeyDownProcessor"),a.resolve("Box4.CompositionEventProcessor"),a.resolve("Box4.TextInputEventProcessor"),a.resolve("Box4.DragEventsProcessor"),a.resolve("Box4.PasteHandler"),a.resolve("Box4.CutCopyHandler"),a.resolve("Box4.DomChangeEventProcessor"),a.resolve("Box4.ContentEditableViewFocusHelper"),a.resolve("Box4.ContentEditableViewCursorManager"),a.resolve("Box4.TouchEventProcessor"),a.resolve("Box4.DoubleClickProcessor"),a.resolve("Box4.OnScrollProcessor"),a.resolve("Box4.AppFrameResizeEventProcessor"),
a.resolve("Box4.LostFocusEventProcessor"),a.resolve("Box4.SelectionChangeHandler"),a.resolve("Box4.CaretPositionManager")));a.register(Zg,"Box4.ContentEditableViewDisposer").ma().oa(()=>new Zg(a.resolve("Box4.IOriginalElementContentArray"),a.resolve("Box4.TypingProcessManager"),a.resolve("Box4.CurrentlyActiveContentSpans"),a.resolve("Box4.EventFrequencyTracker"),a.resolve("Box4.CevUsageDataTracker").mI,a.resolve("Box4.ContentEditableViewEventSource"),a.resolve("Box4.EditingModeTransitionManager")));
a.register(Xk,"Box4.TypingActionOperationFactory").as("Box4.ITypingActionOperationFactory").ma().oa(()=>new Xk);a.register(1386,"Box4.IContentEditableModeHelper").ma().oa(()=>new Mc);a.register(tf,"Box4.ContentEditableView").as("Box4.IEditingView").ma().oa(()=>new tf(na.InteractiveViewManager.instance,me.a.instance,new sb.a(()=>Fc.App.Kb.Jd),a.Ja("Common.IActivityAggregationInfo"),a.Ja("Common.IZoomManager"),u.AFrameworkApplication.Ta,a.resolve("Box4.IHtmlViewRootFactory"),a.resolve("Box4.IEditingDomManager"),
a.resolve("Box4.ICevViewContentManager"),a.resolve("Box4.EditStateEventManager"),a.resolve("Box4.ContentEditableViewFocusHelper"),a.resolve("Box4.ContentEditableViewTypingState"),a.resolve("Box4.SequenceCodeHelper"),a.resolve("Box4.SelectContentHelper"),a.resolve("Box4.EditingDomDisplayManipulator"),a.resolve("Box4.EditViewStateManager"),a.resolve("Box4.BoundsSynchronizer"),a.resolve("Box4.EditingSurfaceStateManager"),a.resolve("Box4.EditingModeTransitionManager"),a.resolve("Box4.ParagraphOverlayPositioner"),
a.resolve("Box4.IPasteHandler"),a.resolve("Box4.CompositionStateManager"),a.resolve("Box4.ImeManager"),a.resolve("Box4.ContentEditableViewGraphUpdater"),a.resolve("Box4.TypingProcessManager"),a.resolve("Box4.OvertypeUtils"),a.resolve("Box4.ContentEditableViewFloatieHandler"),a.resolve("Box4.ContentEditableViewOnAfterValidateHandler"),a.resolve("Box4.ContentEditableViewOnBeforeValidateHandler"),a.resolve("Box4.EditingSurfaceEventHandlerManager"),a.resolve("Box4.ContentEditableViewDisposer"),a.resolve("Box4.IInteractiveEventHandler"),
a.resolve("Box4.IContentEditableDomFactory"),Fc.App.BLa,a.resolve("Box4.IContentEditableModeHelper")))}init(){this.Da.resolve("Box4.EditingModeTransitionManager").UYb(this.Da.resolve("Box4.ContentEditableView"));this.Da.resolve("Box4.BoundsSynchronizer").UYb(this.Da.resolve("Box4.ContentEditableView"));this.Da.resolve("Box4.ImeRecoveryUtils").UYb(this.Da.resolve("Box4.ContentEditableView"));this.Da.resolve("Box4.AutocorrectActionExecutor").FS(this.Da.resolve("Box4.ContentEditableView"));this.Da.resolve("Box4.ContentEditableViewCursorManager").ghi(this.Da.resolve("Box4.ContentEditableView"));
this.Da.resolve("Box4.SelectionChangeHandler").FS(this.Da.resolve("Box4.ContentEditableView"));this.Da.resolve("Box4.HybridTransitionManager").FS(this.Da.resolve("Box4.ContentEditableView"));this.Da.resolve("Box4.ContentEditableViewGraphUpdater").FS(this.Da.resolve("Box4.ContentEditableView"));this.Da.resolve("Box4.TypingProcessManager").FS(this.Da.resolve("Box4.ContentEditableView"));this.Da.resolve("Box4.ContentEditableViewOnAfterValidateHandler").FS(this.Da.resolve("Box4.ContentEditableView"));
this.Da.resolve("Box4.ContentEditableViewOnBeforeValidateHandler").FS(this.Da.resolve("Box4.ContentEditableView"));this.Da.resolve("Box4.EditingSurfaceEventHandlerManager").FS(this.Da.resolve("Box4.ContentEditableView"));this.Da.resolve("Box4.CompositionEventProcessor").FS(this.Da.resolve("Box4.ContentEditableView"))}dispose(){}static main(){r.a.instance.Dc(new Em)}}Object(n.a)(Em,"ContentEditableViewPackage",null,[2,3]);class fm{get name(){return"PowerPointWebEditor.AutoFit"}$b(){}init(){}dispose(){}static main(){r.a.instance.Dc(new fm)}}
Object(n.a)(fm,"PPTWebEditorAutoFitPackage",null,[2,3]);class qm{constructor(a){this.Pw=a}}Object(n.a)(qm,"DynamicScriptLoaderProvider",null,[1558]);var Ik=d(349),Jk=d(236),Kl=d(310);const Fm=(a,b)=>{var c=ck(b);c=a.identifier+c+".js";let h="";h=a.isLocalized?h+(u.AFrameworkApplication.lcid+"/"):h+Ui(b);return h+c},ck=()=>u.AFrameworkApplication.fa.ka("IsCombinedBundleEnabled")?"":u.AFrameworkApplication.fa.aw("IsServerFlavorDebug")?u.AFrameworkApplication.fa.ka("IsServerFlavorDebug")?"":".min":".min",
Ui=a=>a&&u.AFrameworkApplication.fa.ka("DynamicBundlesIsEnabled")&&!u.AFrameworkApplication.fa.ka("AppChromeOverrideIsCombinedBundle")&&!u.AFrameworkApplication.fa.ka("IsCombinedBundleEnabled")?"exp/":"",Ch=(a="anonymous",b="dynamicScriptLoaderDependencies")=>{const c={resolveScript:h=>{var m=Ik.AppChromeOverrideUtilities.shg(c.knownScripts,h.identifier);if(Ik.AppChromeOverrideUtilities.isEnabled&&m)m=h.isLocalized?Ik.AppChromeOverrideUtilities.q1f(u.AFrameworkApplication.lcid):Ik.AppChromeOverrideUtilities.lKb,
h.isLocalized||(m+=Ui(!0)),h=m+h.identifier+Ik.AppChromeOverrideUtilities.POc+".js";else if(Kl.a.instance.isEnabled){var y=u.AFrameworkApplication.aga;h=Fm(h,m);Kl.a.instance.isEnabled&&(m=Kl.a.instance.a6d(u.AFrameworkApplication.f1+h))&&(y=m+u.AFrameworkApplication.f1);ba.ULS.sendTraceTag(592228695,306,50,"Dynamic loading hashed resource for "+h);h=y+h}else if(y=ck(m),u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ScriptUrlFromNameNewIsEnabled",
!1))h.isLocalized?h=u.AFrameworkApplication.Pj(h.identifier+y,3):(h=Ui(m)+h.identifier,h=u.AFrameworkApplication.Pj(h+y+".js",5));else{var G=u.AFrameworkApplication.aga;G=h.isLocalized?G+(u.AFrameworkApplication.lcid+"/"):G+Ui(m);h=G+h.identifier+y+".js"}return h},resolveSriHash:h=>{const m=Ik.AppChromeOverrideUtilities.shg(c.knownScripts,h.identifier);Kl.a.instance.isEnabled?(h=Fm(h,m),h=Kl.a.instance.Wij(u.AFrameworkApplication.f1+h)):h=null;return h}};c.crossOriginAttributeValue=a;c.knownScripts=
window[b];return c};var Ba=d(26),il=d(647);class Gg{constructor(){this.lwe=this.Lea=this.K=null;this.iCg=this.Jzg=!1}get name(){return"PowerPointWebEditor.DynamicScriptLoader"}$b(a){if(!a)throw Error.argumentNull("container");this.K=a;this.Lea=this.K.resolve("PowerPointWebEditor.IDelayLoadedScriptResourceFactory");this.K.register(qm,"Common.DynamicScriptLoaderProvider").as("Common.IDynamicScriptLoaderProvider").ma().oa(()=>{var b=window.self.EarlyDynamicScriptLoader;if(void 0===b||null===b){b=Ch();
if(il.a.tMj){const c=b.resolveScript;b.resolveScript=h=>{let m=il.a.u1e(h.identifier+(Ik.AppChromeOverrideUtilities.isEnabled?Ik.AppChromeOverrideUtilities.POc:".min")+".js");m||(m=c(h));return m}}this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptUseManagedScriptResourceLoading&&(b.loadScriptHandler=Object(F.a)(this,this.loadScript,"loadScript"));return new qm(new dynamicScriptLoader.DynamicScriptLoader(b))}u.AFrameworkApplication.fa.ka("EnableDefaultDSLImpl")||b.c5e&&b.c5e(Object(F.a)(this,
this.loadScript,"loadScript"));return new qm(b)});this.Jzg=u.AFrameworkApplication.fa.ka("EarlyLazySprite");this.iCg=u.AFrameworkApplication.fa.ka("RibbonShimmerExperimentEnabled");u.AFrameworkApplication.fa.ka("LoadSLideGridJSEarly")&&Gg.Foc.push("slidegrid");Gg.Foc.push("comment-pane-strings");Gg.Foc.push("sharedcomments");Gg.Foc.push("floatingcontainermanager")}loadScript(a,b){let c=this.lwe;c&&c.isCompleted&&(this.lwe=c=null);const h=this.Jzg&&Array.contains(Gg.Foc,a),m=u.AFrameworkApplication.fa.ka("BootFilesInDelayScriptFactory")&&
Array.contains(Gg.E_k,a)?this.Lea.cBi(b,Array.contains(Gg.nmh,a),!(this.iCg&&Array.contains(Gg.Z_k,a))):this.Lea.XWd(b,null,Array.contains(Gg.nmh,a));h||(this.lwe=m.JFa);return new Promise((y,G)=>{const U=Date.now(),ja=()=>{m.JFa.continueWith(va=>{if(6===va.status)y(a);else{let Ta=String.format("Failed to download the script with identifier: {0} at url: {1}.",a,b);va.Zi&&(Ta+=" "+va.Zi.message);G(Error.create(Ta))}});Ba.a.J(540113033,813,50,"LoadScript:: Identifier:{0}, DelayInMs:{1}",a,Date.now()-
U);Jk.a.Wx(m)};!c||h?ja():c.continueWith(()=>{ja()})})}init(){}dispose(){}}Gg.nmh=["common","powerpoint-ribbon-intl","appChrome"];Gg.Foc="ppt-ribbon-sprite-lazy ppt-ribbon-mlr-sprite-lazy powerpoint-ribbon-intl-lazy powerpoint-ribbon-mlr-intl-lazy powerpoint-ribbon-intl powerpoint-ribbon-mlr-intl appchrome".split(" ");Gg.E_k="common common50 ppt-ribbon-sprite-lazy ppt-ribbon-mlr-sprite-lazy powerpoint-ribbon-intl-lazy powerpoint-ribbon-mlr-intl-lazy powerpoint-ribbon-intl powerpoint-ribbon-mlr-intl appchrome".split(" ");
Gg.Z_k=["common","appchrome"];Object(n.a)(Gg,"DynamicScriptLoaderPackage",null,[2,3]);var zj=d(164),Mf=d(94),Ll=d(634),nc=d(50),Tm;(function(a){a[a.unknown=0]="unknown";a[a.orderlyShutdown=1]="orderlyShutdown";a[a.bootIncomplete=2]="bootIncomplete";a[a.podSessionRefreshed=3]="podSessionRefreshed";a[a.seamlessFailoverManager=4]="seamlessFailoverManager";a[a.inlineDocumentRepair=5]="inlineDocumentRepair"})(Tm||(Tm={}));Object(n.b)("RefreshDocTrigger",Tm);var Nc=d(41),qf=d(84);class gm extends Sys.EventArgs{constructor(a,
b){super();this.fSj=b}}Object(n.a)(gm,"FailoverEventArgs",Sys.EventArgs,[]);var Rh=d(242),Vf=d(108);class jn extends Vf.a{constructor(a){super();this.FailedMachineId=null;this.FailedMachineId=a}$k(){return 61}}Object(n.a)(jn,"CheckUnblockUIRequest",Vf.a,[]);var kn=d(867),M=d(28);class Gm{constructor(a,b,c,h,m,y,G,U,ja,va,Ta,fb,Db,gc,hc,Gc,Pc,yc,Vd,De,Wd,Ve){this.Rla=!1;this.lwa=this.Jye=this.kGa=this.rGa=this.WT=this.As=null;this.la=a;this.zb=b;this.Nak=c;this.ff=h;this.pa=m;this.Fa=y;this.IC=G;this.X2c=
hc;this.odb=Pc;this.Lm=U;this.h4j=ja;this.ua=va;this.Vb=Ta;this.f$=fb;this.ze=Db;this.Qd=gc;this.nGa=Gc;this.ia=yc;this.BC=Vd;this.hn=De;this.VXa=Wd;this.gj=Ve;this.g6j=this.la.podsFailoverRefreshDocSlideDrawTimeoutInMS;this.k9j=this.la.podsLegacyFailoverRefreshDocSlideDrawTimeoutInMS}vb(){this.ia.ra(M.a.hJb,nc.a.application,Object(F.a)(this,this.RNk,"refeshDoc"),64)}RNk(a,b,c,h,m){this.A1e(m.failedMachineId,m.isPlanedShutdown,"podSessionId"in m?m.podSessionId:"","isPodSessionRefreshed"in m&&m.isPodSessionRefreshed?
3:"fromSeamlessFailoverManager"in m?4:"fromInlineDocumentRepair"in m?5:0);return 32}get yi(){return this.Vb.yi}ysa(a){a.Y6b()&&a.ysa()}A1e(a,b,c,h){if(!this.ze.od.hermesFailOverImprovementIsEnabled||this.odb())return!1;if(this.Rla||this.nGa.xfg)return!0;const m=this.yi;if(!(m&&m.zi&&m.zi.Xw&&m.zi.Xw.id!==pa.a.nil&&m.contentReplicator&&this.ua.presentation&&this.ua.presentation.id.equals(Ll.a.SHe)))return!1;5===h&&this.Cpf();this.Lm.pause();this.f$.suspend();this.IC.Rd&&this.IC.Rd.endEditing(!1,14);
this.IC.forEach(Object(F.a)(this,this.ysa,"ensureGraphUpdated"));m.hT(!0)&&m.Jfa();this.pa.setSelection(null);this.Fa.Ed();this.As=Nc.a.Ik("RefreshDoc");this.As.Va("IsPlanedShutdown",b.toString());this.As.Va("PodSessionId",c);this.As.Va("RefreshDocTrigger",Tm[h]);Ba.a.J(512360801,809,50,"DocRefreshHandler::TryRefreshDoc:ActionID:{0}; ActionDetails:{1}",this.As.actionId,this.As.wNb());this.WT=a;b?(this.rGa=new Date,this.nGa.Euh(),this.X2c.Eb(this.jWd())):this.Ffh();this.BC.ydh(new gm(b,!1));this.ua.presentation.zQe();
this.ff.blockContent(this.ua.presentation,"RefreshDoc",!0);Ba.a.J(512360798,822,15,"DocRefreshHandler::TryRefeshDoc, Block Presentation");this.Qd.disabled=!0;return this.Rla=this.ze.y9a().Jdd=!0}Cpf(){this.Lm.isPaused&&(Ba.a.J(512360797,801,50,"DocRefreshHandler::ActivateReplicationScheduler:  ReplicationScheduler was paused - UnPaused it"),this.Lm.olb());try{this.Lm.lBf()}catch(a){Ba.a.J(512360796,801,15,"DocRefreshHandler::ActivateReplicationScheduler CancelBlockedOperation failed. {0}",a)}}jWd(){return this.kGa=
new Rh.a(new jn(this.WT),Object(F.a)(this,this.hFe,"onCheckUnBlockUISuccess"),Object(F.a)(this,this.gFe,"onCheckUnBlockUIFailed"),a=>0===a.StatusCode&&!a.ServerError,3)}Ffh(){this.As.Va("FailedMachineId",this.WT);this.Jye=new Date;this.Nak.hJb(this.WT,this.As,!this.ze.od.refreshDocSynchronouslyIsEnabled,!1,Object(F.a)(this,this.jNi,"docRefreshSuccessCallback"),Object(F.a)(this,this.iNi,"docRefreshFailedCallback"));this.h4j.Vwa()}hFe(){this.nGa.nVc();this.As.Va("DeploymengUIBlockingTime",(+new Date-
+this.rGa).toString());this.As.Va("CheckUnblockUISucceeded","True");this.Ffh()}gFe(a){if(142===a.ServerError.Code)return Ba.a.J(512360795,822,50,"UnBlockUI failed with ErrorBlockUIUnderDeployment, failed machine: {0}, UI blocking time in ms: {1}",this.WT,+new Date-+this.rGa),this.X2c.Eb(this.kGa),!0;this.As.Va("DeploymengUIBlockingTime",(+new Date-+this.rGa).toString());this.As.Va("CheckUnblockUISucceeded","False");this.nGa.nVc();return this.V4g(a)}jNi(){this.hn.UNd(Object(F.a)(this,this.VGe,"onSlideDrawComplete"));
this.lwa&&this.zb.Rg(this.lwa);const a=this.As.WJ("RefreshDocTrigger");this.lwa=new He.a(2,1,a&&1===a.length&&"podSessionRefreshed"===a[0]?this.g6j:this.k9j,Object(F.a)(this,this.onSlideDrawTimeout,"onSlideDrawTimeout"),90,"62");this.zb.Eb(this.lwa);a&&1===a.length&&"inlineDocumentRepair"===a[0]&&this.Cpf()}iNi(a){return this.V4g(a)}VGe(){ba.ULS.sendTraceTag(512360794,821,50,"DocRefreshHandler::OnSlideDrawComplete");this.lwa&&(this.zb.Rg(this.lwa),this.lwa=null);this.hn.gkd(Object(F.a)(this,this.VGe,
"onSlideDrawComplete"));this.As&&(this.As.Va("ReStoreStatusAfterRefreshStartTime",Nc.a.nf(new Date)),this.f$.resume(),this.As.Va("SlideDrawResult","True"),this.As.Wm("SlideDrawCompleteET",new Date),this.Lm.isPaused&&this.Lm.olb(),this.As.Va("LoadAndRenderTime",(+new Date-+this.Jye).toString()),this.ze.od.XNe||this.ze.y9a().Xwa(),this.As.Va("ReStoreStatusAfterRefreshEndTime",Nc.a.nf(new Date)),this.IGe(!0),this.VXa.Pdh(new kn.a("DocRefresh")),this.gj.Klb=2,u.AFrameworkApplication.qib(qf.a.Uh(180),
zj.a.unknown,zj.a.ttc),Mf.Health.instance.recordQosError("AppRebooted",["UnexpectedAppRefresh"],!1,!1,!0,!1,null))}onSlideDrawTimeout(){this.hn.gkd(Object(F.a)(this,this.VGe,"onSlideDrawComplete"));this.lwa&&(this.zb.Rg(this.lwa),this.lwa=null);ba.ULS.sendTraceTag(512360793,821,10,"DocRefreshHandler::OnSlideDrawTimeout");this.As.Va("SlideDrawResult","False");this.IGe(!1);this.GWk()}GWk(){this.Qd.disabled=!1;u.AFrameworkApplication.xp(qf.a.Uh(379));Mf.Health.instance.recordQosError("RefreshDocTimeout",
["UnexpectedAppRefresh"],!1,!1,!0,!0,null);u.AFrameworkApplication.Vu&&u.AFrameworkApplication.Vu.i8();this.ia.La(M.a.refresh,2,{refreshtrigger:"DocRefreshHandler::ReportErrorAndRefreshPage"})}V4g(a){ba.ULS.sendTraceTag(512360792,821,50,"DocRefreshHandler:OnRefreshFailed Original error Code:{0}, Source:{1}, ExtraParam:{2}, Correlation:{3}",a.ServerError.Code,a.ServerError.Source,a.ServerError.ExtraErrorParam?a.ServerError.ExtraErrorParam.join(","):"empty",a.Jh);this.IGe(!1);return!1}IGe(a){this.Rla=
!1;this.kGa=this.WT=null;this.Jye=new Date(0);Nc.a.V$b=new Date;this.As&&(this.As.Va("Result",a?"Success":"Failed"),this.As.finish(!0),this.As=null);this.Qd.disabled=!1;this.ze.y9a().Jdd=!1;this.ff.ZJ(this.ua.presentation)}}Object(n.a)(Gm,"DocRefreshHandler",null,[1382]);var jl=d(152);class Aj{constructor(a,b,c,h,m,y,G,U,ja,va,Ta,fb,Db){this.Rla=!1;this.kGa=this.rGa=this.WT=this.As=null;this.ia=a;this.vi=b;this.Zh=c;this.ff=h;this.pa=m;this.Fa=y;this.Lm=G;this.ua=U;this.f$=ja;this.nGa=va;this.Xa=
Ta;this.la=fb;this.odb=Db;this.la.fgg&&this.Zh.GA(Object(F.a)(this,this.vB,"onSessionEnd"))}vb(){this.ia.ra(M.a.failover,nc.a.application,Object(F.a)(this,this.Mqj,"handleFailover"),64)}vB(){this.Lm.isPaused||this.Lm.pause()}Mqj(a,b,c,h,m){if(1===c||this.odb()||this.Rla||this.nGa.xfg)return 32;this.WT=m;if(!this.WT)return 8;this.As=Nc.a.Ik("SeamlessFailover");this.Lm.pause();this.f$.suspend();this.pa.setSelection(null);this.Fa.Ed();this.ff.blockContent(this.ua.presentation,"SeamlessFailover",!0);
Ba.a.J(37106114,822,15,"SeamlessFailoverHandler::HandleFailover, Block Presentation");this.rGa=new Date;this.nGa.Euh();this.Zh.ydh(new gm(!0,!0));u.AFrameworkApplication.Bub();this.vi.dFc(this.jWd());this.Rla=!0;return 32}jWd(){return this.kGa=new Rh.a(new jn(this.WT),Object(F.a)(this,this.hFe,"onCheckUnBlockUISuccess"),Object(F.a)(this,this.gFe,"onCheckUnBlockUIFailed"),a=>0===a.StatusCode&&!a.ServerError,3)}hFe(){this.nGa.nVc();this.As.Va("DeploymengUIBlockingTime",(+new Date-+this.rGa).toString());
this.As.Va("CheckUnblockUISucceeded","True");this.As.Va("FailedMachineId",this.WT);this.Xa.Xub=this.WT;this.pLk()}gFe(a){if(142===a.ServerError.Code)return Ba.a.J(22315610,822,50,"UnBlockUI failed with ErrorBlockUIUnderDeployment, failed machine: {0}, UI blocking time in ms: {1}",this.WT,+new Date-+this.rGa),this.vi.dFc(this.kGa),!0;this.As.Va("DeploymengUIBlockingTime",(+new Date-+this.rGa).toString());this.As.Va("CheckUnblockUISucceeded","False");this.nGa.nVc();return this.pok(a)}pLk(){this.As.Va("ReStoreStatusAfterRefresh",
Nc.a.nf(new Date));this.Lm.olb();this.f$.resume();this.N2g(!0);u.AFrameworkApplication.qib(qf.a.Uh(180),zj.a.unknown,zj.a.ttc);Mf.Health.instance.recordQosError("AppRebooted",["UnexpectedAppRefresh"],!1,!1,!0,!1,null)}pok(a){ba.ULS.sendTraceTag(22315611,821,50,"SeamlessFailoverHandler:OnFailoverFailed Original error Code:{0}, Source:{1}, ExtraParam:{2}, Correlation:{3}",a.ServerError.Code,a.ServerError.Source,a.ServerError.ExtraErrorParam?a.ServerError.ExtraErrorParam.join(","):"empty",a.Jh);this.N2g(!1);
a.ServerError=Object.assign(new jl.a,{Code:157,Source:0});return!1}N2g(a){this.Rla=!1;this.kGa=this.WT=null;this.As&&(this.As.Va("Result",a?"Success":"Failed"),this.As.finish(),this.As=null);this.ff.ZJ(this.ua.presentation)}dispose(){this.la.fgg&&this.Zh.baa(Object(F.a)(this,this.vB,"onSessionEnd"))}}Object(n.a)(Aj,"SeamlessFailoverHandler",null,[106]);var Cf=d(218),Rf=d(106),jk=d(1139),ki=d(287),$n=d(821),yg=d(230),rm=d(618);class dk{constructor(a,b,c,h,m){if(!a)throw Error.argumentNull("actionManager");
this.ia=a;this.la=b;this.A9=c;this.kB=h;this.Yb=m;this.gdb=!1}nv(a,b=!1,...c){this.I1b.apply(this,[qf.a.Uh(a),this.A9.YSc(a),this.A9.H9d(a),this.A9.d7d(a),b].concat(c))}I1b(a,b,c,h,m=!1,...y){if(!Cf.a.Ww){var G=2,U=!1;if(a===qf.a.Uh(83))this.la.QSj&&(c=ResourceStrings.l_CannotPasteImageTitle,h=ResourceStrings.l_SuggestionToInsertPicture,G=3);else if(a===qf.a.Uh(8)||a===qf.a.Uh(256)||a===qf.a.Uh(257)||a===qf.a.Uh(291))G=0,U=!0;y&&0<y.length&&(h=String.format.apply(null,[h].concat(y)));this.wt(new rm.a(a,
c,h,b,G),m,U)}}wt(a,b=!1,c=!1){let h=a.vjd;var m=qf.a.vT(a.Xm)?yg.a[qf.a.nN(a.Xm)]:"";Ba.a.J(512497111,801,15,"ErrorDialog::ShowErrorDialog BSQMErrorCode: {0}; ErrorName: {1}, SuppressErrorReporting: {2}, ShowFeedbackButtonEnabled: {3}, ClientActions - None: {4}, Dismiss: {5}, Close: {6}, OpenInClient: {7}, Refresh: {8}, HideFeedback: {9}, Repair: {10}",a.Xm,m,b,u.AFrameworkApplication.OE,0===h,!!(h&1),!!(h&2),!!(h&4),!!(h&8),!!(h&16),!!(h&64));if(this.hel(a))Ba.a.J(512497110,801,50,"ErrorDialog::ShowErrorDialog Skip showing error {0} to users.",
a.Xm);else{m=new Rf.StandardDialog;var y=null,G=!1,U=this.Yb.ka("UserCanWriteRelative");h&64&&Ba.a.J(512497109,801,50,"ErrorDialog::ShowErrorDialog. User's Access level:{0}",this.Yb.Ha("DocumentPermissions")||"");var ja=!1;h&64&&this.la.pptFileRecoveryEnabled&&(ja=!0);h&64&&!U&&Ba.a.J(512497108,801,50,"ErrorDialog::ShowErrorDialog. We found a repairable error but user has no permission to write relative, but inline repair is enabled. Will try to repair.");!ja&&h&64&&(c=!1,h=this.oyl(a));U=!!(h&4)&&
!(u.AFrameworkApplication.ECh||u.AFrameworkApplication.LQ);var va=!!(h&2)&&u.AFrameworkApplication.tda;c=c?ResourceStrings.l_OpenInApp:ResourceStrings.L_OpenInPowerPoint;m.yr=va||!!(h&1);h&8?(m.xd=0,y=Object(F.a)(this,this.Bjd,"refreshActionHandler"),Array.contains(this.la.hermesRefreshErrorSuppressionList,a.Xm.toString())?m.cP(jk.a.k3(a.title),jk.a.k3(a.message),y):(Ba.a.J(512497107,801,50,"ErrorDialog::ShowErrorDialog BSQMErrorCode: {0}.",a.Xm),m.Xe(1,ResourceStrings.L_Refresh),m.zy(a.Xm,jk.a.k3(a.title),
jk.a.k3(a.message),y,b)),G=this.gdb=!0):ja?(Ba.a.J(512497106,801,50,"ErrorDialog::ShowErrorDialog. We met an error need to repair. ErrorCode: {0}",a.Xm),this.ia.processAction(M.a.repair,2)):va&&U?(m.xd=4,m.Xe(1,c),m.Xe(2,ResourceStrings.L_Close),y=Object(F.a)(this,this.kvk,"openOrCloseActionHandler"),this.gdb=!0):U?(m.xd=0,m.Xe(1,c),y=Object(F.a)(this,this.zfd,"openInClientActionHandler"),this.gdb=!0):va?(m.xd=0,m.Xe(1,ResourceStrings.L_Close),y=Object(F.a)(this,this.lti,"closeActionHandler"),this.gdb=
!0):(c=!!(h&1)||0===h,m.yr=c,m.xd=c?0:5);G||ja||(h&16&&h&32?(b||u.AFrameworkApplication.xp(a.Xm),m.e0a=!1,m.Bx(jk.a.k3(a.title),jk.a.k3(a.message),a.icon,y)):m.zy(a.Xm,jk.a.k3(a.title),jk.a.k3(a.message),y,b));this.gdb&&this.kB&&this.kB.closeSession(4);this.gdb?Mf.Health.instance.recordQosError(qf.a.Wia(a.Xm),["NonDismissibleDialog"],!1,!1,!0,!0,null):Mf.Health.instance.recordQosError(qf.a.Wia(a.Xm),["DismissibleDialog"],!1,!1,!0,!1,null)}}get dZc(){return this.gdb}oyl(a){Ba.a.J(512497105,801,15,
"ErrorDialog::UpdateErrorWhenRepairDisabled. We found a repairable error but user has no permission to repair. Falling back to generic error dialog.");a.message=a.Xm===qf.a.Uh(8)||a.Xm===qf.a.Uh(43)?ResourceStrings.errorMessage_EditSlideCorruption:ResourceStrings.errorMessage_CannotOpenDocument;a.title=ResourceStrings.errorTitle_PowerpointStandard;a.icon=2;return 6}zfd(a,b){Ba.a.J(512497104,801,50,"Button={0};DontShowAgain={1}",a,b);1===a&&this.Wbh()}kvk(a,b){Ba.a.J(512497103,801,50,"Button={0};DontShowAgain={1}",
a,b);1===a?this.Wbh():this.ia.La(M.a.jvb,2,ki.c)}lti(a,b){Ba.a.J(512497102,801,50,"Button={0};DontShowAgain={1}",a,b);this.ia.La(M.a.jvb,2,ki.c)}Bjd(a,b){Ba.a.J(512497101,801,50,"Button={0};DontShowAgain={1}",a,b);this.ia.La(M.a.refresh,2,{refreshtrigger:"ErrorDialog::RefreshActionHandler"})}Wbh(){(new $n.a(D.a.openInClient)).Gge()}hel(a){return a.Xm===qf.a.Uh(83)&&(u.AFrameworkApplication.CL("Microsoft.Office.Server.Powerpoint.Web.IPptSkipErrorCannotPastePictureNotFoundSettings"),this.la.eil)||a.Xm===
qf.a.Uh(56)&&(u.AFrameworkApplication.CL("Microsoft.Office.Server.Powerpoint.Web.IPptSkipErrorLocalChangeLostCoauthSettings"),this.la.fil)?!0:!1}}Object(n.a)(dk,"ErrorDialog",null,[1380]);var Jj=d(279),gf=d(124),Ul=d(511),Vi=d(989),Rd=d(34);class kk extends Sys.EventArgs{constructor(){super();this.cCa=this.$B=0;this.message=this.title=null}}Object(n.a)(kk,"BeforeHandleErrorEventArgs",Sys.EventArgs,[]);class Fe extends kk{constructor(a){super();this.GRa=null;this.errorCode=a;this.$B=0}}Object(n.a)(Fe,
"OnBeforeHandleClientErrorEventArgs",kk,[]);class ug extends kk{constructor(){super();this.$B=0}}Object(n.a)(ug,"OnBeforeHandleServerErrorEventArgs",kk,[]);class Kk extends Sys.EventArgs{constructor(a,b,c){super();this.AO=a;this.a6j=b;this.vh=c}get podSessionId(){return this.AO}get wOc(){return this.a6j}get errorCode(){return this.vh}}Object(n.a)(Kk,"PodSessionUnavailableEventArgs",Sys.EventArgs,[]);class zl{constructor(a,b,c,h,m,y,G,U,ja,va,Ta,fb,Db,gc){this.eue=!1;this.e7j=[8];this.Aue={["Generic"]:CommonUIStrings.l_DecryptSkipReasonGeneric,
["DecryptionDefered"]:CommonUIStrings.l_DecryptSkipReasonDecryptionDefered,["EncryptedOutsideSharepoint"]:CommonUIStrings.l_DecryptSkipReasonEncryptedOutsideSharepoint,["UnsupportedMsoDataStore"]:CommonUIStrings.l_DecryptSkipReasonUnsupportedMsoDataStore,["PasswordProtected"]:CommonUIStrings.l_DecryptSkipReasonPasswordProtected,["ContentExpiryLabel"]:CommonUIStrings.l_DecryptSkipReasonContentExpiryLabel,["InvalidLabelOwner"]:CommonUIStrings.l_DecryptSkipReasonInvalidLabelOwner,["DeletedLabel"]:CommonUIStrings.l_DecryptSkipReasonDeletedLabel,
["LabelProtectionChanged"]:CommonUIStrings.l_DecryptSkipReasonLabelProtectionChanged,["UnsupportedLabel"]:CommonUIStrings.l_DecryptSkipReasonLabelUnsupportedLabel,["DoubleKeyDisabled"]:CommonUIStrings.l_DecryptSkipReasonLabelDoubleKeyDisabled};this.disabled=!1;this.A9=a;this.z9=b;this.hl=c;this.Utg=h;this.ia=m;this.Xa=y;this.Yb=G;this.Qb=U;this.BDb=ja;this.U9e=!1;this.Lm=va;this.kB=Ta;this.Qo=Db;this.vj=gc;this.ze=fb}us(a,b,c=null,h=!1){if(this.disabled)return ba.ULS.sendTraceTag(512263053,804,50,
"Ignore server error {0}",a?a.Code:315),!0;this.kB.Yek();if(this.kB.S3)return ba.ULS.sendTraceTag(512263052,804,15,"GlobalErrorHandler:HandleServerError - Ignore server error since session is already closed. ErrorCode:{0}",a?a.Code:315),!0;let m=!1,y=0,G=0,U=null;var ja=null;c&&(ja=new ug,m=c(ja),y=ja.$B,G=ja.cCa,U=ja.title,ja=ja.message);m||(m=this.Cuj(a,b));m||(b=a?a.Code:315,a=a?a.ExtraErrorParam:null,this.UTi(b)&&(this.U9e=!0,this.Lm.pause()),a?this.zy.apply(this,[y,b,G,U,ja,h].concat(a)):this.zy(y,
b,G,U,ja,h));return m}Cuj(a,b){if(!a)return!1;ba.ULS.sendTraceTag(512263051,821,15,"{0} - Error Code:{1} Source:{2} ExtraParam:{3}","GlobalErrorHandler:HandleServerErrorInternal",a.Code,a.Source,a.ExtraErrorParam?a.ExtraErrorParam.join(","):"empty");if(153===a.Code)return Jj.a.instance.GNe(Date.now()),Jj.a.$0c(u.AFrameworkApplication.userSessionId),u.AFrameworkApplication.qib(qf.a.Uh(153),zj.a.unknown,zj.a.ttc),({W_e:c}=Jj.a.instance.$Ch()).returnValue&&ba.ULS.sendTraceTag(512263050,804,50,"{0} - Data Center Redirect - Time duration from user launch browser to redirection starting {1}",
"GlobalErrorHandler:HandleServerErrorInternal",(new Date).getTime()-c),a.ExtraErrorParam?this.KNk(a.ExtraErrorParam[0]):ba.ULS.sendTraceTag(512263049,804,10,"{0} - Data Center Redirect missing RedirectUrl","GlobalErrorHandler:HandleServerErrorInternal"),!0;if(142===a.Code&&a.ExtraErrorParam&&0<a.ExtraErrorParam.length)return(2===a.ExtraErrorParam.length?32===this.ia.La(M.a.failover,2,a.ExtraErrorParam[0]):this.Utg.A1e(a.ExtraErrorParam[0],!0,this.Xa.podSessionId||"",1))||this.zy(0,157,0,null,null),
!0;if(274===a.Code)return ba.ULS.sendTraceTag(512263048,804,10,"{0} - Pods session is locked for edit/merge. Local change could be lost","GlobalErrorHandler:HandleServerErrorInternal"),!0;if(4===a.Code&&this.Qo.instance&&!ta.a.Wa(this.Xa.NOc))return ba.ULS.sendTraceTag(512263047,801,15,"Triggering rehydration for password files from GlobalErrorHandler"),this.Qo.instance.N0e(!1,0,a.Code),!0;if(157===a.Code&&2===a.Source&&a.ExtraErrorParam&&0<a.ExtraErrorParam.length){var c=1<a.ExtraErrorParam.length?
a.ExtraErrorParam[1]:"";return this.Yb.ka("685")&&c.toLowerCase()!==this.Xa.podSessionId.toLowerCase()?(Ba.a.J(512263046,801,15,"{0} - Replication cache request boot incomplete failures were ignored, ServerReturnPodSessionSeed: {1}; SessionInfoSeed: {2}.","GlobalErrorHandler:HandleServerErrorInternal",c,b),!0):this.Yb.ka("884")&&this.eue?(Ba.a.J(512263045,801,15,"{0} - Ignore bootIncomplete error after SaveAndClose( ReleaseLock=true ).","GlobalErrorHandler:HandleServerErrorInternal"),!0):this.Utg.A1e(a.ExtraErrorParam[0],
!1,this.Xa.podSessionId||"",2)}if(223===a.Code||285===a.Code||362===a.Code||this.Yb.ka("560")&&229===a.Code||this.Yb.ka("914")&&this.Qo.instance&&this.Qo.instance.BUi(a.Code)){if(b!==this.Xa.podSessionId)return Ba.a.J(512263044,801,15,"{0} - PodSessionId mismatch, skip failover signal. FailedPodSessionId:{1}; CurrentPodSessionId:{2}","GlobalErrorHandler:HandleServerErrorInternal",b,this.Xa.podSessionId),!0;if(this.Yb.ka("914")&&this.Qo.instance&&this.Qo.instance.i_)return Ba.a.J(512263043,801,15,
"{0} - SeamlessFailover is ongoing. FailedPodSessionId:{1}; CurrentPodSessionId:{2}","GlobalErrorHandler:HandleServerErrorInternal",b,this.Xa.podSessionId),!0;Ba.a.J(512263042,801,15,"{0} - RaisePodSessionUnavailableEvent, serverErrorCode:{1};","GlobalErrorHandler:HandleServerErrorInternal",a.Code);this.BDb.PJk(new Kk(this.Xa.podSessionId,!!a.ExtraErrorParam&&!!a.ExtraErrorParam.length&&"PodsOrderlyShutdown"===a.ExtraErrorParam[0],a.Code));return!0}if(389===a.Code||292===a.Code&&3===a.Source)return a=
this.Qb.notificationBar.uCa(ResourceStrings.L_DeepLinking_BootSlideNotFound,!1),this.Yb.ka("IsAutomation")?a.displayTimeoutSeconds=this.Yb.Fc("PodDeepLinkingToastMessageDisplayTimeMsForAutomation",a.displayTimeoutSeconds)/1E3:Ba.a.J(512263041,804,15,"{0} - Deep link - Slide not found","GlobalErrorHandler:HandleServerErrorInternal"),this.Qb.notificationBar.Yh(a),!0;if(238===a.Code&&this.Yb.ka("561")&&this.Qo.instance&&this.Qo.instance.i_)return Ba.a.J(512263040,801,50,"{0} - SessionBootInProgress during seamless failover, skipped",
"GlobalErrorHandler:HandleServerErrorInternal"),!0;if(329===a.Code)return Ba.a.J(512263011,801,15,"{0} - PreconditionFailed error due to host integration ID mismatch, silent fail","GlobalErrorHandler:HandleServerErrorInternal"),this.Svh(a.Code,null),!0;if(104===a.Code)return b=2===this.vj.tca,a.Code=b?56:105,Ba.a.J(512263010,801,15,"{0} - LocalChangeLost seen when user is {1}. Returning {2}.","GlobalErrorHandler:HandleServerErrorInternal",b?"co-authoring":"alone",yg.a[a.Code]),this.zy(0,a.Code,0,
null,null),!0;if(this.MIj(a.Code)&&2!==this.Yb.state)return Ba.a.J(512263009,801,15,"{0} - Skip check file error if it under retry","GlobalErrorHandler:HandleServerErrorInternal"),!0;if(117===a.Code){if((b=a.ExtraErrorParam)&&2===b.length&&"GB"===b[1])return this.zy.apply(this,[0,a.Code,0,null,ResourceStrings.errorMessage_CannotOpenDocumentTooLargeGB,!1].concat(b)),!0}else if(432===a.Code)return this.zy.apply(this,[1,a.Code,8,null,ResourceStrings.errorMessage_UserNetworkLocationUnauthorized,!1].concat(a.ExtraErrorParam)),
!0;return!1}YG(a,b){if(this.disabled)return ba.ULS.sendTraceTag(512263008,804,50,"Ignore client error {0}",a),!0;let c=!1,h=0,m=0,y=null,G=null;var U=null;b&&(U=new Fe(a),c=b(U),h=U.$B,m=U.cCa,y=U.title,G=U.message,U=U.GRa);c||(c=!1);c||(U?this.zy.apply(this,[h,a,m,y,G,!1].concat(U)):this.zy(h,a,m,y,G));return c}zy(a,b,c,h,m,y=!1,...G){0===a&&(a=this.A9.mfj(b));0===c&&(c=this.A9.YSc(b));h||(h=this.A9.H9d(b));m||(3===b&&this.Yb.ka("DecryptSkipReasonIRMErrorEnabled")?m=this.N6i():(Ba.a.J(512263007,
801,50,"GlobalErrorHandler::ShowError errorCode != ErrorCannotOpenDocumentIRM"),m=this.A9.d7d(b)));const U=()=>{this.Efl.apply(this,[a,b,c,h,m,y].concat(G))};2===this.Yb.state?U():this.Yb.jf(U)}N6i(){Ba.a.J(512263006,801,50,"GlobalErrorHandler::GetDetailedIRMError DecryptSkipReason = "+u.AFrameworkApplication.o1b);return u.AFrameworkApplication.o1b&&this.Aue[u.AFrameworkApplication.o1b]?this.Aue[u.AFrameworkApplication.o1b]:this.Aue.Generic}Efl(a,b,c,h,m,y,...G){if(2===a){let U;(U=this.hl).I1b.apply(U,
[b,c,h,m].concat(G))}else 3===a?this.Svh.apply(this,[b].concat(G)):this.psa.apply(this,[qf.a.Uh(b),c,h,m,y].concat(G))}psa(a,b,c,h,m,...y){0===b&&(b=this.A9.YSc(qf.a.nN(a)));if(Vi.GraphSpaceRootReplicator.sjg(qf.a.nN(a))&&y&&0<y.length){this.Xa.wkd=y[0];var G=new Qa.a;for(var U=1;U<y.length;U++)G.add(y[U]);y=G.toArray()}G=Object.assign(new Ul.a,{Type:6,Token:this.ze.od.klc,Data:{["Reason"]:"FatalError",["ErrorName"]:qf.a.Wia(a)}});Rd.a("PPT.BootstrapperMessageNewValues")&&(G.MessageId=gf.a.uFh,U=
{Reason:"FatalError"},U.ErrorName=G.Data.ErrorName,G.Values=U);window.parent.postMessage(dd.c(G),"*");ba.ULS.sendTraceTag(512263005,804,15,"GlobalErrorHandler:DisplayErrorDialog: {0}",a);let ja;(ja=this.z9).I1b.apply(ja,[a,b,c,h,m].concat(y))}KNk(a){qd.a.openWindow(1,a)}get hka(){return this.eue}set hka(a){this.eue=a;Ba.a.J(512263004,801,50,"GlobalErrorHandler::IgnoreBootIncompleteFailure is set to {0}",a)}get N_d(){return this.U9e}RNd(){}nOd(){}Svh(a,...b){const c=qf.a.Uh(a);Ba.a.J(512263003,801,
50,"GlobalErrorHandler::SilentFail BSQMErrorCode: {0}; ErrorCode:{1}, ErrorParams:{2}",c,a,b?b.join(","):"");u.AFrameworkApplication.xp(c);Mf.Health.instance.recordQosError(qf.a.Wia(c),["SilentFailure"],!1,!0,!0,!1,null)}MIj(a){return 288===a||300===a||301===a||302===a||303===a?!0:!1}UTi(a){return Array.contains(this.e7j,a)?!0:!1}}Object(n.a)(zl,"GlobalErrorHandler",null,[1383,1399]);class Dh{constructor(a){this.wcc=!1;this.QX=null;this.kt=a}get xfg(){return this.wcc}Euh(){var a=ResourceStrings.errorTitle_PowerpointEditingStandard,
b=ResourceStrings.errorMessage_BlockUIUnderDeployment;this.wcc||(this.QX=new db.a,this.QX.xd=5,this.QX.message=jk.a.k3(b),this.QX.yr=!1,Ba.a.J(22315662,822,50,"Showing UI blocking dialog to prompt user we are deploying"),this.QX.Boa(jk.a.k3(a),null,null),this.wcc=!0,this.kt.Axf(!0))}nVc(){this.wcc&&(this.QX.hide(),this.wcc=!1,this.QX=null,this.kt.Axf(!1))}}Object(n.a)(Dh,"DeployingDialog",null,[1378]);var Sh=d(1E3),oj=d(431),ag=d(640),uf=d(418),hm=d(157),lc=d(61),Lk=d(897);class Ye{constructor(a,
b,c,h,m,y,G){this.Zda=this.Pf=this.XBb=this.RBb=null;this.O3c=!1;this.f4c=this.P$c=this.J1c=null;this.Rla=!1;this.ua=a;this.Vb=b;this.Gq=c;this.Sb=h;this.X2c=m;this.Bug=y;this.Qo=G}get yi(){return this.Vb.yi}hJb(a,b,c,h,m,y){this.Rla||(this.Rla=!0,this.O3c=c,this.Pf=b,this.P$c=m,this.f4c=y,this.Qo.instance&&this.Qo.instance.yMd("abortedOnRefreshDoc"),this.Bug&&this.Bug(),this.X2c.Eb(this.TEi(a,h)))}TEi(a,b){let c=this.ua.Ba&&!lc.a.ax(this.ua.Ba.Cb)?this.ua.Ba.Cb:lc.a.empty;c=b?lc.a.empty:c;this.Pf.Va("CurrentActiveSlideId",
c.toString());this.J1c=lc.a.ax(c)?lc.a.empty:c;return new Rh.a(new Lk.a(c,a),Object(F.a)(this,this.Kok,"onGetCellSuccess"),Object(F.a)(this,this.Jok,"onGetCellFailed"),Object(F.a)(this,this.$Cl,"validateResponse"))}$Cl(a){return!a.ServerError&&0===a.StatusCode&&a&&a.Cells&&a.Cells.length?(a=a.Cells[a.Cells.length-1])&&a.RevisionList?0<a.RevisionList.length:!1:!1}Kok(a){this.Pf.Va("GetCells",a.Jh);a=new Sh.a(null,Object(F.a)(this,this.EAj,"inboundSetup"),a);a.Oi=!this.O3c;a.Nl("RefreshUIOperation");
a.run()}Jok(a){this.Pf.Va("GetCells",a.Jh);200!==a.HttpStatusCode&&this.Pf.Va("GetCellsHttpStatusCode",a.HttpStatusCode.toString());if(this.f4c&&this.f4c(a))return!0;a.ServerError=Object.assign(new jl.a,{Code:294,Source:0});Mf.Health.instance.recordQosError("RefreshDocFailed",["UnexpectedAppRefresh"],!1,!0,!0,!0,null);return!1}EAj(a,b){(this.Zda=this.Vb.Cn)&&this.Zda.NM&&this.Zda.NM.k1c();this.Zda&&this.Zda.np&&(this.Zda.NM=new ag.a(jc.a.instance,"FailoverView"));this.Pf.Va("InboundSetupStartTime",
Nc.a.nf(new Date));if(Rd.a("UseBuildIncrementalInboundOperation"))this.Vb.Ba=null,this.RBb=this.yi.contentReplicator.tyf(b);else{const c=b.Cells[b.Cells.length-1],h=this.yi.zi.Xw.id;c.RevisionList[0].BaseId=hm.a(h);this.Vb.Ba=null;this.RBb=new oj.a(c,h,!1,new Date,b.Jh,!1,!1,!1)}this.XBb=this.Gq.le(3);this.XBb.kd(this.ua.presentation);this.O3c&&this.XBb.SU(a);a.$g(Object(F.a)(this,this.lka,"inboundIncrementally"));this.Pf.Va("InboundSetupEndTime",Nc.a.nf(new Date));return!0}lka(a){this.Pf.Va("InboundIncrementallyStartTime",
Nc.a.nf(new Date));this.yi.contentReplicator.lka(this.RBb,new Date);this.RBb.DQ&&(this.XBb.dispose(),a.$g(Object(F.a)(this,this.f4k,"setActiveSlideAndRender")),this.XBb=this.RBb=null,this.Pf.Va("InboundIncrementallyEndTime",Nc.a.nf(new Date)));return!0}f4k(a){this.Pf.Va("SetActiveSlideAndRenderStartTime",Nc.a.nf(new Date));a.$g(Object(F.a)(this,this.vXi,"finishRefreshDoc"));if(lc.a.empty.equals(this.J1c))return this.Pf.Va("SetActiveSlideAndRenderEndTime",Nc.a.nf(new Date)),!0;const b=this.Sb.zl(this.J1c);
if(!b)return this.Pf.Va("SetActiveSlideAndRenderEndTime",Nc.a.nf(new Date)),!0;const c=this.Gq.le(3);try{c.kd(b),this.O3c&&c.SU(a),this.Vb.Ba=b}finally{c&&c.dispose()}this.Pf.Va("SetActiveSlideAndRenderEndTime",Nc.a.nf(new Date));return!0}vXi(){this.P$c&&this.P$c();this.Zda&&this.Zda.NM&&(this.Zda.NM.k1c(),this.Zda.NM=new uf.a);this.H5();return!1}H5(){this.Rla=!1;this.f4c=this.P$c=this.J1c=this.Zda=this.Pf=this.XBb=this.RBb=null}}Object(n.a)(Ye,"RefreshDocExecutor",null,[1381]);class im{d7d(a){switch(a){case 1:a=
ResourceStrings.errorMessage_Unknown;break;case 14:a=ResourceStrings.errorMessage_Unknown;break;case 2:a=ResourceStrings.errorMessage_CannotOpenDocumentFileType;break;case 3:a=ResourceStrings.errorMessage_CannotOpenDocumentIRM;break;case 4:a=ResourceStrings.errorMessage_CannotOpenDocumentPassword;break;case 41:a=ResourceStrings.errorMessage_CannotOpenDocumentGatekeeperFailure;break;case 33:a=ResourceStrings.errorMessage_CannotOpenDocumentMacro;break;case 34:a=ResourceStrings.errorMessage_CannotOpenDocumentFinal;
break;case 35:a=ResourceStrings.errorMessage_CannotOpenDocumentSigned;break;case 36:a=ResourceStrings.errorMessage_CannotOpenEmbeddedFonts;break;case 5:a=ResourceStrings.errorMessage_CannotOpenDocument;break;case 6:a=ResourceStrings.errorMessage_CannotInstallFonts;break;case 7:a=ResourceStrings.errorMessage_CannotConvertModifyPassword;break;case 8:a=ResourceStrings.errorMessage_CannotOpenFileCorrupted;break;case 306:a=ResourceStrings.errorMessage_CannotOpenFileCorrupted;break;case 9:a=ResourceStrings.errorMessage_CannotComposeSlideUnexpected;
break;case 10:a=ResourceStrings.errorMessage_WacConversionFailure;break;case 12:a=ResourceStrings.errorMessage_GenericSlideCorruption;break;case 15:a=ResourceStrings.errorMessage_FailedToOpenDocument;break;case 16:a=ResourceStrings.errorMessage_FailedToRetrieveResource;break;case 17:a=ResourceStrings.errorMessage_FailedToRenderDocument;break;case 18:a=ResourceStrings.errorMessage_FailedToRenderSlide;break;case 20:a=ResourceStrings.errorMessage_CannotSaveDocument;break;case 21:a=ResourceStrings.errorMessage_InvalidCommand;
break;case 22:a=ResourceStrings.errorMessage_DocVersionMismatch;break;case 23:a=ResourceStrings.errorMessage_CannotAcquirePptEditLock;break;case 58:a=ResourceStrings.errorMessage_CannotAcquirePptEditSharedLock;break;case 24:a=ResourceStrings.errorMessage_RequiresCheckout;break;case 25:a=ResourceStrings.errorMessage_LockedForOfflineCheckout;break;case 26:a=ResourceStrings.errorMessage_LockedByAnotherUser;break;case 27:a=ResourceStrings.errorMessage_AccessDenied;break;case 28:a=ResourceStrings.errorMessage_NoLicense;
break;case 29:a=ResourceStrings.errorMessage_Unknown;break;case 30:a=ResourceStrings.errorMessage_TextTooBig;break;case 31:a=ResourceStrings.errorMessage_TryAgain;break;case 37:a=ResourceStrings.errorMessage_ServiceUnavailable;break;case 32:a=ResourceStrings.errorMessage_Unexpected;break;case 11:a=ResourceStrings.errorMessage_FailedToRetrieveResource;break;case 13:a=ResourceStrings.errorMessage_FileNotFoundOrPermissionDenied;break;case 38:a=ResourceStrings.errorMessage_ServiceUnavailable;break;case 39:a=
ResourceStrings.errorMessage_PptEditExistingExclusiveLock;break;case 40:a=ResourceStrings.errorMessage_PptEditCheckedOutByAnother;break;case 42:a=ResourceStrings.errorMessage_EditWorkerTimeout;break;case 43:a=ResourceStrings.errorMessage_EditSlideCorruption;break;case 44:a=ResourceStrings.errorMessage_ServiceUnavailable;break;case 45:a=ResourceStrings.errorMessage_ClipartCannotConnect;break;case 46:a=ResourceStrings.errorMessage_ClipartCannotDownload;break;case 47:a=ResourceStrings.errorMessage_Unknown;
break;case 48:a=ResourceStrings.errorMessage_Unknown;break;case 49:a=ResourceStrings.errorMessage_Unknown;break;case 50:a=ResourceStrings.errorMessage_Unknown;break;case 51:a=ResourceStrings.errorMessage_Unknown;break;case 52:a=ResourceStrings.errorMessage_Unknown;break;case 53:a=ResourceStrings.errorMessage_Unknown;break;case 54:a=ResourceStrings.errorMessage_Unknown;break;case 55:a=ResourceStrings.errorMessage_CannotOpenODPDocumentPassword;break;case 56:a=ResourceStrings.errorMessage_LocalChangeLost;
break;case 57:a=ResourceStrings.errorMessage_NumberOfCoauthorsReachedMax;break;case 59:a=ResourceStrings.errorMessage_ServiceUnavailable;break;case 60:a=ResourceStrings.errorMessage_ImageTooLarge;break;case 61:a=ResourceStrings.errorMessage_ImageWrongFormat;break;case 62:a=ResourceStrings.errorMessage_ImageNoAccess;break;case 63:a=ResourceStrings.errorMessage_WacConversionFailure;break;case 64:a=ResourceStrings.errorMessage_WacConversionFailure;break;case 65:a=ResourceStrings.errorMessage_WacConversionFailure;
break;case 66:a=ResourceStrings.errorMessage_WacConversionFailure;break;case 67:a=ResourceStrings.errorMessage_WacConversionFailure;break;case 68:a=ResourceStrings.errorMessage_WacConversionFailure;break;case 69:a=ResourceStrings.errorMessage_WacConversionFailure;break;case 70:a=ResourceStrings.errorMessage_WacConversionFailure;break;case 71:a=ResourceStrings.errorMessage_WacConversionFailure;break;case 72:a=ResourceStrings.errorMessage_WacConversionFailure;break;case 73:a=ResourceStrings.errorMessage_WacConversionFailure;
break;case 74:a=ResourceStrings.errorMessage_WacConversionFailure;break;case 75:a=ResourceStrings.errorMessage_WacConversionFailure;break;case 76:a=ResourceStrings.errorMessage_CannotOpenDocument;break;case 77:a=ResourceStrings.errorMessage_CannotOpenDocument;break;case 78:a=ResourceStrings.errorMessage_CannotOpenDocument;break;case 79:a=ResourceStrings.errorMessage_CannotOpenDocument;break;case 80:a=ResourceStrings.errorMessage_CannotOpenDocument;break;case 254:a=ResourceStrings.errorMessage_CannotOpenDocument;
break;case 255:a=ResourceStrings.errorMessage_CannotOpenDocument;break;case 256:a=ResourceStrings.errorMessage_CannotOpenFileCorrupted;break;case 257:a=ResourceStrings.errorMessage_CannotOpenFileCorrupted;break;case 258:a=ResourceStrings.errorMessage_CannotOpenDocument;break;case 81:a=ResourceStrings.errorMessage_ClipartCannotDownload;break;case 82:a=ResourceStrings.errorMessage_ClipartCannotDownload;break;case 83:a=ResourceStrings.errorMessage_ClipartCannotDownload;break;case 84:a=ResourceStrings.errorMessage_ClipartCannotDownload;
break;case 85:a=ResourceStrings.errorMessage_ClipartCannotDownload;break;case 86:a=ResourceStrings.errorMessage_ClipartCannotDownload;break;case 87:a=ResourceStrings.errorMessage_InsertLocalPictureTooLarge;break;case 88:a=ResourceStrings.invalidCanary;break;case 89:a=ResourceStrings.imageUploadRequestError;break;case 90:a=ResourceStrings.invalidImageFileError;break;case 91:a=ResourceStrings.imageUploadRequestError;break;case 92:a=ResourceStrings.imageUploadRequestError;break;case 93:a=ResourceStrings.imageUploadRequestError;
break;case 94:a=ResourceStrings.imageUploadRequestError;break;case 95:a=ResourceStrings.errorMessage_Unknown;break;case 96:a=ResourceStrings.errorMessage_Unknown;break;case 97:a=ResourceStrings.errorMessage_Unknown;break;case 98:a=ResourceStrings.errorMessage_Unknown;break;case 99:a=ResourceStrings.errorMessage_Unknown;break;case 137:a=ResourceStrings.errorMessage_TryAgain;break;case 100:a=ResourceStrings.errorMessage_Unknown;break;case 101:a=ResourceStrings.errorMessage_Unknown;break;case 102:a=
ResourceStrings.errorMessage_Unknown;break;case 103:a=ResourceStrings.errorMessage_ServiceUnavailable;break;case 104:a=ResourceStrings.errorMessage_LocalChangeLost;break;case 105:a=ResourceStrings.errorMessage_Unknown;break;case 238:a=ResourceStrings.errorMessage_Unknown;break;case 269:a=ResourceStrings.errorMessage_Unknown;break;case 262:a=ResourceStrings.errorMessage_Unknown;break;case 288:a=ResourceStrings.errorMessage_Unknown;break;case 268:a=ResourceStrings.errorMessage_Unknown;break;case 315:a=
ResourceStrings.errorMessage_Unknown;break;case 237:a=ResourceStrings.errorMessage_Unknown;break;case 228:a=ResourceStrings.errorMessage_Unknown;break;case 233:a=ResourceStrings.errorMessage_Unknown;break;case 231:a=ResourceStrings.errorMessage_Unknown;break;case 230:a=ResourceStrings.errorMessage_Unknown;break;case 426:a=ResourceStrings.errorMessage_Unknown;break;case 19:a=ResourceStrings.errorMessage_CannotSaveDocument;break;case 106:a=ResourceStrings.errorMessage_FailedToLocalSaveDocument;break;
case 107:a=ResourceStrings.errorMessage_NumberOfSessionsPerUserReachedMax;break;case 108:a=ResourceStrings.errorMessage_Unknown;break;case 109:a=ResourceStrings.errorMessage_NullPresentationId;break;case 111:a=ResourceStrings.errorMessage_CannotInsertOnlineVideo;break;case 112:a=ResourceStrings.errorMessage_CannotInsertOnlinePicture;break;case 143:a=ResourceStrings.errorMessage_InsertOnlinePictureTooLarge;break;case 113:a=ResourceStrings.errorMessage_ImageTooLarge;break;case 114:a=ResourceStrings.errorMessage_CannotPastePicture;
break;case 115:a=ResourceStrings.errorMessage_CannotPastePicture;break;case 116:a=ResourceStrings.errorMessage_CannotPastePicture;break;case 117:a=ResourceStrings.errorMessage_CannotOpenDocumentTooLarge;break;case 118:a=ResourceStrings.errorMessage_StorageOutOfMemory;break;case 141:a=ResourceStrings.errorMessage_CannotAcquirePptEditLock;break;case 142:a=ResourceStrings.errorMessage_BlockUIUnderDeployment;break;case 135:a=ResourceStrings.errorMessage_Unknown;break;case 144:a=ResourceStrings.errorMessage_FailedToRetrieveResource;
break;case 147:a=ResourceStrings.errorMessage_CannotInsertOnlinePictureNotFound;break;case 148:a=ResourceStrings.errorMessage_CannotInsertOnlinePicture;break;case 149:a=ResourceStrings.errorMessage_CannotInsertOnlinePicture;break;case 150:a=ResourceStrings.errorMessage_CannotInsertOnlinePicture;break;case 151:a=ResourceStrings.errorMessage_CannotInsertOnlinePicture;break;case 155:a=ResourceStrings.errorMessage_Unknown;break;case 156:a=ResourceStrings.errorMessage_Unknown;break;case 159:a=ResourceStrings.errorMessage_Unknown;
break;case 154:a=ResourceStrings.errorMessage_CannotOpenZeroByteDocument;break;case 157:a=ResourceStrings.errorMessage_TryAgain;break;case 158:a=ResourceStrings.errorMessage_Unknown;break;case 160:a=ResourceStrings.errorMessage_Unknown;break;case 168:a=ResourceStrings.errorMessage_Unknown;break;case 169:a=ResourceStrings.errorMessage_TryAgain;break;case 173:a=ResourceStrings.errorMessage_TryAgain;break;case 199:a=ResourceStrings.errorMessage_Unknown;break;case 200:a=ResourceStrings.errorMessage_CannotOpenDocument;
break;case 201:a=ResourceStrings.errorMessage_Unknown;break;case 202:a=ResourceStrings.errorMessage_ClipServicePasteCopyFailed;break;case 203:a=ResourceStrings.errorMessage_Unknown;break;case 204:a=ResourceStrings.errorMessage_Unknown;break;case 205:a=ResourceStrings.errorMessage_Unknown;break;case 206:a=ResourceStrings.errorMessage_Unknown;break;case 209:a=ResourceStrings.errorMessage_Unexpected;break;case 210:a=ResourceStrings.errorMessage_Unknown;break;case 211:a=ResourceStrings.imageUploadRequestError;
break;case 212:a=ResourceStrings.imageUploadTimeoutError;break;case 213:a=ResourceStrings.errorMessage_TryAgain;break;case 214:a=ResourceStrings.errorMessage_LocalChangeLost;break;case 215:a=ResourceStrings.errorMessage_Unknown;break;case 363:a=ResourceStrings.errorMessage_Unknown;break;case 287:a=ResourceStrings.errorMessage_CannotOpenZeroByteDocument;break;case 321:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 222:a=ResourceStrings.errorMessage_SlideTooManyShapes;break;case 247:a=
ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 275:a=ResourceStrings.errorMessage_DownloadAppSettingsFailed;break;case 244:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 295:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 245:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 246:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 249:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 250:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;
break;case 322:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 329:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 243:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 251:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 252:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 242:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 241:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;
case 293:a=ResourceStrings.errorMessage_TryAgain;break;case 294:a=ResourceStrings.errorMessage_TryAgain;break;case 379:a=ResourceStrings.errorMessage_TryAgain;break;case 296:a=ResourceStrings.errorMessage_CannotOpenDocument;break;case 297:a=ResourceStrings.errorMessage_FailedToOpenDocument;break;case 298:a=ResourceStrings.errorMessage_FailedToOpenDocument;break;case 332:a=ResourceStrings.errorMessage_FailedToOpenDocument;break;case 354:a=ResourceStrings.errorMessage_FailedToOpenDocument;break;case 355:a=
ResourceStrings.errorMessage_FailedToOpenDocument;break;case 356:a=ResourceStrings.errorMessage_FailedToOpenDocument;break;case 357:a=ResourceStrings.errorMessage_FailedToOpenDocument;break;case 365:a=ResourceStrings.errorMessage_FailedToOpenDocument;break;case 364:a=ResourceStrings.errorMessage_FailedToOpenDocument;break;case 358:a=ResourceStrings.errorMessage_FailedToOpenDocument;break;case 369:a=ResourceStrings.errorMessage_FailedToOpenDocument;break;case 333:a=ResourceStrings.errorMessage_ServiceUnavailable;
break;case 299:a=ResourceStrings.imageUploadTimeoutError;break;case 304:a=ResourceStrings.errorMessage_ServiceUnavailable;break;case 305:a=ResourceStrings.errorMessage_FailedToOpenDocument;break;case 307:a=ResourceStrings.errorMessage_Unknown;break;case 353:a=ResourceStrings.errorMessage_FailedToOpenDocument;break;case 308:a=ResourceStrings.errorMessage_ServiceUnavailable;break;case 377:a=ResourceStrings.errorMessage_ServiceUnavailable;break;case 309:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;
break;case 325:a=ResourceStrings.errorMessage_CannotAcquirePptEditSharedLock;break;case 352:a=ResourceStrings.errorMessage_Unknown;break;case 328:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 330:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 331:a=ResourceStrings.errorMessage_ServiceUnavailable;break;case 334:a=ResourceStrings.errorMessage_ServiceUnavailable;break;case 373:a=ResourceStrings.errorMessage_Unknown;break;case 374:a=ResourceStrings.errorMessage_CannotOpenDocument;
break;case 384:a=ResourceStrings.errorMessage_ZeroByteFileNotFound;break;case 391:a=ResourceStrings.errorMessage_CannotOpenDocumentWrongPassword;break;case 399:a=ResourceStrings.errorMessage_Unknown;break;case 400:a=ResourceStrings.errorMessage_Unknown;break;case 401:a=ResourceStrings.errorMessage_CannotInsertStream;break;case 402:a=ResourceStrings.errorMessage_CannotInsertStream;break;case 403:a=ResourceStrings.errorMessage_CannotInsertStream;break;case 404:a=ResourceStrings.errorMessage_CannotInsertStream;
break;case 405:a=ResourceStrings.errorMessage_CannotInsertStream;break;case 416:a=ResourceStrings.errorMessage_InsertLocalAudioTooLarge;break;case 418:a=ResourceStrings.errorMessage_InvalidNumberOfAudioFilesError;break;case 417:a=ResourceStrings.errorMessage_InvalidAudioFileError;break;case 422:a=ResourceStrings.errorMessage_EmptyAudioFileError;break;case 419:a=ResourceStrings.errorMessage_AudioUploadRequestError;break;case 424:a=ResourceStrings.errorMessage_AudioInvalidFileError;break;case 427:a=
ResourceStrings.errorMessage_InvalidAudioFileExtension;break;case 433:a=ResourceStrings.errorMessage_Unknown;break;case 434:a=ResourceStrings.errorMessage_Unknown;break;case 435:a=ResourceStrings.errorMessage_Unknown;break;case 440:a=ResourceStrings.errorMessage_UploadedMediaFilesNotReceived;break;case 441:a=ResourceStrings.errorMessage_UploadedInvalidMediaFileType;break;case 442:a=ResourceStrings.errorMessage_UploadedMediaTooLarge;break;case 443:a=ResourceStrings.errorMessage_UploadedInvalidMediaFileType;
break;case 444:a=ResourceStrings.errorMessage_UploadedMediaNonStandardResponse;break;case 445:a=ResourceStrings.errorMessage_UploadedMediaFilesNotReceived;break;case 446:a=ResourceStrings.errorMessage_UploadedMediaInternalError;break;case 447:a=ResourceStrings.errorMessage_UploadedMediaFilesNotReceived;break;case 449:a=ResourceStrings.errorMessage_MediaUploadTimeout;break;case 450:a=ResourceStrings.errorMessage_UploadedVideoTooLarge;break;default:a=ResourceStrings.errorMessage_Unknown}return a}H9d(a){switch(a){case 1:a=
ResourceStrings.errorTitle_Unknown;break;case 14:a=ResourceStrings.errorTitle_Unknown;break;case 2:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 3:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 4:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 41:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 33:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 34:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 35:a=ResourceStrings.errorTitle_PowerpointStandard;
break;case 36:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 5:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 6:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 7:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 8:a=ResourceStrings.errorTitle_CannotOpenFile;break;case 306:a=ResourceStrings.errorTitle_CannotOpenFile;break;case 9:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 10:a=ResourceStrings.errorTitle_WacStandard;break;case 12:a=ResourceStrings.errorTitle_PowerpointStandard;
break;case 15:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 16:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 17:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 18:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 20:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 21:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 22:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 23:a=ResourceStrings.errorTitle_PowerpointEditingStandard;
break;case 58:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 24:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 25:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 26:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 27:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 28:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 29:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 30:a=ResourceStrings.errorTitle_PowerpointEditingStandard;
break;case 31:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 37:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 32:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 11:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 13:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 38:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 39:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 40:a=ResourceStrings.errorTitle_PowerpointEditingStandard;
break;case 42:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 43:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 44:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 45:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 46:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 47:a=ResourceStrings.errorTitle_Unknown;break;case 48:a=ResourceStrings.errorTitle_Unknown;break;case 49:a=ResourceStrings.errorTitle_Unknown;break;case 50:a=ResourceStrings.errorTitle_Unknown;
break;case 51:a=ResourceStrings.errorTitle_Unknown;break;case 52:a=ResourceStrings.errorTitle_Unknown;break;case 53:a=ResourceStrings.errorTitle_Unknown;break;case 54:a=ResourceStrings.errorTitle_Unknown;break;case 55:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 56:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 57:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 59:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 60:a=ResourceStrings.errorTitle_PasteImageFailed;
break;case 61:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 62:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 63:a=ResourceStrings.errorTitle_WacStandard;break;case 64:a=ResourceStrings.errorTitle_WacStandard;break;case 65:a=ResourceStrings.errorTitle_WacStandard;break;case 66:a=ResourceStrings.errorTitle_WacStandard;break;case 67:a=ResourceStrings.errorTitle_WacStandard;break;case 68:a=ResourceStrings.errorTitle_WacStandard;break;case 69:a=ResourceStrings.errorTitle_WacStandard;
break;case 70:a=ResourceStrings.errorTitle_WacStandard;break;case 71:a=ResourceStrings.errorTitle_WacStandard;break;case 72:a=ResourceStrings.errorTitle_WacStandard;break;case 73:a=ResourceStrings.errorTitle_WacStandard;break;case 74:a=ResourceStrings.errorTitle_WacStandard;break;case 75:a=ResourceStrings.errorTitle_WacStandard;break;case 76:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 77:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 78:a=ResourceStrings.errorTitle_PowerpointStandard;
break;case 79:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 80:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 254:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 255:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 256:a=ResourceStrings.errorTitle_CannotOpenFile;break;case 257:a=ResourceStrings.errorTitle_CannotOpenFile;break;case 258:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 81:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 82:a=
ResourceStrings.errorTitle_PowerpointStandard;break;case 83:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 84:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 85:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 86:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 87:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 88:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 89:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 90:a=ResourceStrings.errorTitle_PowerpointStandard;
break;case 91:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 92:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 93:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 94:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 95:a=ResourceStrings.errorTitle_Unknown;break;case 96:a=ResourceStrings.errorTitle_Unknown;break;case 97:a=ResourceStrings.errorTitle_Unknown;break;case 98:a=ResourceStrings.errorTitle_Unknown;break;case 99:a=ResourceStrings.errorTitle_Unknown;
break;case 137:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 100:a=ResourceStrings.errorTitle_Unknown;break;case 101:a=ResourceStrings.errorTitle_Unknown;break;case 102:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 103:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 104:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 105:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 238:a=ResourceStrings.errorTitle_PowerpointEditingStandard;
break;case 269:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 262:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 288:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 268:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 315:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 237:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 228:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 233:a=
ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 231:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 230:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 426:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 19:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 106:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 107:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 108:a=ResourceStrings.errorTitle_PowerpointStandard;
break;case 109:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 111:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 112:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 143:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 113:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 114:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 115:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 116:a=ResourceStrings.errorTitle_PowerpointStandard;
break;case 117:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 118:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 141:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 142:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 135:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 144:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 147:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 148:a=ResourceStrings.errorTitle_PowerpointEditingStandard;
break;case 149:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 150:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 151:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 155:a=ResourceStrings.errorTitle_Unknown;break;case 156:a=ResourceStrings.errorTitle_Unknown;break;case 159:a=ResourceStrings.errorTitle_Unknown;break;case 154:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 157:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;
case 158:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 160:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 168:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 169:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 173:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 199:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 200:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 201:a=ResourceStrings.errorTitle_Unknown;
break;case 202:a=ResourceStrings.errorTitle_PasteSlideFailed;break;case 203:a=ResourceStrings.errorTitle_Unknown;break;case 204:a=ResourceStrings.errorTitle_Unknown;break;case 205:a=ResourceStrings.errorTitle_Unknown;break;case 206:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 209:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 210:a=ResourceStrings.errorTitle_Unknown;break;case 211:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 212:a=ResourceStrings.errorTitle_PowerpointStandard;
break;case 213:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 214:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 215:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 363:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 287:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 321:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 222:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 247:a=ResourceStrings.errorTitle_PowerpointEditingStandard;
break;case 275:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 244:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 295:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 245:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 246:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 249:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 250:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 322:a=
ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 329:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 243:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 251:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 252:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 242:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 241:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 293:a=ResourceStrings.errorTitle_PowerpointEditingStandard;
break;case 294:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 379:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 296:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 297:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 298:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 332:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 354:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 355:a=ResourceStrings.errorTitle_PowerpointEditingStandard;
break;case 356:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 357:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 365:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 364:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 358:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 369:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 333:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 299:a=
ResourceStrings.errorTitle_PowerpointStandard;break;case 304:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 305:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 307:a=ResourceStrings.errorMessage_Unknown;break;case 353:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 308:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 377:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 309:a=ResourceStrings.errorTitle_PowerpointEditingStandard;
break;case 325:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 352:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 328:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 330:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 331:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 334:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 373:a=ResourceStrings.errorTitle_Unknown;break;case 374:a=ResourceStrings.errorTitle_PowerpointEditingStandard;
break;case 384:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 391:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 399:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 400:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 401:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 402:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 403:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 404:a=
ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 405:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 416:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 418:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 417:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 422:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 419:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 424:a=ResourceStrings.errorTitle_PowerpointStandard;
break;case 427:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 433:a=ResourceStrings.errorTitle_Unknown;break;case 434:a=ResourceStrings.errorTitle_Unknown;break;case 435:a=ResourceStrings.errorTitle_Unknown;break;case 440:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 441:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 442:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 443:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 444:a=ResourceStrings.errorTitle_PowerpointStandard;
break;case 445:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 446:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 447:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 449:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 450:a=ResourceStrings.errorTitle_PowerpointStandard;break;default:a=ResourceStrings.errorTitle_Unknown}return a}YSc(a){switch(a){case 2:a=6;break;case 3:a=6;break;case 4:a=6;break;case 41:a=6;break;case 33:a=6;break;case 34:a=6;break;case 35:a=
6;break;case 36:a=6;break;case 5:a=6;break;case 6:a=6;break;case 7:a=6;break;case 8:a=116;break;case 306:a=116;break;case 9:a=6;break;case 10:a=6;break;case 15:a=6;break;case 16:a=8;break;case 17:a=6;break;case 20:a=12;break;case 22:a=8;break;case 23:a=2;break;case 58:a=2;break;case 24:a=2;break;case 25:a=2;break;case 26:a=2;break;case 27:a=2;break;case 28:a=2;break;case 31:a=8;break;case 37:a=2;break;case 32:a=8;break;case 13:a=2;break;case 38:a=2;break;case 39:a=2;break;case 40:a=2;break;case 42:a=
6;break;case 43:a=6;break;case 44:a=2;break;case 46:a=49;break;case 55:a=2;break;case 57:a=2;break;case 59:a=2;break;case 60:a=49;break;case 63:a=6;break;case 64:a=6;break;case 65:a=6;break;case 66:a=6;break;case 67:a=6;break;case 68:a=6;break;case 69:a=6;break;case 70:a=6;break;case 71:a=6;break;case 72:a=6;break;case 73:a=6;break;case 74:a=6;break;case 75:a=6;break;case 76:a=6;break;case 77:a=6;break;case 78:a=6;break;case 79:a=6;break;case 80:a=6;break;case 254:a=6;break;case 255:a=6;break;case 256:a=
116;break;case 257:a=116;break;case 258:a=6;break;case 81:a=49;break;case 82:a=49;break;case 83:a=49;break;case 84:a=49;break;case 85:a=49;break;case 86:a=49;break;case 105:a=8;break;case 238:a=8;break;case 269:a=8;break;case 262:a=8;break;case 288:a=8;break;case 268:a=8;break;case 315:a=8;break;case 237:a=8;break;case 228:a=8;break;case 233:a=8;break;case 231:a=8;break;case 230:a=8;break;case 426:a=8;break;case 19:a=12;break;case 106:a=6;break;case 107:a=2;break;case 117:a=6;break;case 118:a=2;break;
case 141:a=6;break;case 142:a=8;break;case 156:a=8;break;case 154:a=6;break;case 157:a=8;break;case 158:a=8;break;case 199:a=8;break;case 200:a=2;break;case 202:a=49;break;case 212:a=49;break;case 287:a=4;break;case 321:a=4;break;case 222:a=5;break;case 247:a=4;break;case 275:a=8;break;case 244:a=4;break;case 295:a=4;break;case 245:a=4;break;case 246:a=4;break;case 249:a=4;break;case 250:a=4;break;case 322:a=1;break;case 243:a=4;break;case 251:a=4;break;case 252:a=4;break;case 242:a=4;break;case 241:a=
8;break;case 293:a=12;break;case 294:a=12;break;case 296:a=6;break;case 333:a=12;break;case 299:a=49;break;case 304:a=6;break;case 353:a=6;break;case 308:a=12;break;case 377:a=12;break;case 309:a=4;break;case 325:a=6;break;case 352:a=10;break;case 328:a=12;break;case 330:a=4;break;case 331:a=4;break;case 334:a=6;break;case 374:a=6;break;case 384:a=2;break;case 391:a=6;break;case 399:a=8;break;case 400:a=8;break;case 449:a=49;break;case 450:a=49;break;default:a=0}return a}mfj(a){switch(a){case 5:a=
1;break;case 137:a=3;break;case 201:a=3;break;case 203:a=3;break;case 204:a=3;break;case 205:a=3;break;case 209:a=3;break;case 210:a=3;break;case 213:a=3;break;case 215:a=3;break;case 363:a=3;break;case 329:a=3;break;case 379:a=3;break;case 296:a=1;break;case 297:a=3;break;case 298:a=3;break;case 332:a=3;break;case 354:a=3;break;case 355:a=3;break;case 356:a=3;break;case 357:a=3;break;case 365:a=3;break;case 364:a=3;break;case 358:a=3;break;case 369:a=3;break;case 305:a=3;break;case 307:a=3;break;
case 373:a=3;break;case 391:a=1;break;case 433:a=3;break;case 434:a=3;break;case 435:a=3;break;default:a=1}return a}}Object(n.a)(im,"DefaultErrorMapping",null,[1379]);var ih=d(703);class Jh{constructor(){this.K=null}get name(){return"PowerPointWebEditor.ErrorHandling"}$b(a){this.K=a;a.register(1378,"PowerPointWebEditor.ErrorHandling.IDeployingDialog").ma().oa(()=>new Dh(a.resolve("PowerPointWebEditor.Core.IPPTAppFrame")));a.register(1379,"PowerPointWebEditor.IErrorMapping").ma().oa(()=>new im);a.register(1380,
"PowerPointWebEditor.IErrorDialog").ma().oa(()=>new dk(a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.IErrorMapping"),a.resolve("PowerPointWebEditor.ISessionLifetimeManager"),a.resolve("Common.IAppSettingsManager")));const b=new sb.a(()=>new ih.a(a.resolve("PowerPointWebEditor.BootStorage.IBackgroundReplicationScheduler"),a.resolve("PowerPointWebEditor.IErrorHandler"),a.resolve("PowerPointWebEditor.Core.IPPTServerResponseHelper"),
a.resolve("PowerPointWebEditor.IReplicationTimerFactory").M0b(a.resolve("Box4.IReplicationParameters")),vb.a.instance.resolve("PowerPointWebEditor.ISessionInfoOwner"),()=>u.AFrameworkApplication.Tg));a.register(1381,"PowerPointWebEditor.ErrorHandling.IRefreshDocExecutor").ma().oa(()=>new Ye(a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.IPPTWorkspaceGraph"),a.resolve("Box4.Graph.IGraphTransactionFactory"),a.resolve("PowerPointWebEditor.IPresentationReader"),
b.value,u.AFrameworkApplication.TPf,this.K.Ja("PowerPointWebEditor.PodsPops.IPodSeamlessFailoverManager")));a.register(1382,"PowerPointWebEditor.IDocRefreshHandler").ma().oa(()=>new Gm(a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("Common.ITaskManager"),a.resolve("PowerPointWebEditor.ErrorHandling.IRefreshDocExecutor"),a.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.IFocusManager"),
a.resolve("Box4.IInteractiveViewManager"),a.resolve("Box4.IReplicationScheduler"),a.resolve("PowerPointWebEditor.BootStorage.IBackgroundReplicationScheduler"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.IPPTWorkspaceGraph"),a.resolve("Box4.IProofingManager"),a.resolve("PowerPointWebEditor.IApplicationContext"),a.resolve("PowerPointWebEditor.IErrorHandler"),b.value,a.resolve("PowerPointWebEditor.ErrorHandling.IDeployingDialog"),()=>u.AFrameworkApplication.Tg,
a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.Core.ICoreEventNotifier"),a.resolve("PowerPointWebEditor.IImageViewManager"),a.resolve("PowerPointWebEditor.ViewCore.IViewCoreEventNotifier"),a.resolve("PowerPointWebEditor.IZoomContext")));a.register(Aj,"PowerPointWebEditor.SeamlessFailoverHandler").ma().oa(()=>new Aj(a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.BootStorage.ICoreOutboundHelper"),a.resolve("PowerPointWebEditor.Core.ICoreEventSource"),
a.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("Box4.IReplicationScheduler"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("Box4.IProofingManager"),a.resolve("PowerPointWebEditor.ErrorHandling.IDeployingDialog"),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.resolve("PowerPointWebEditor.IApplicationSettings"),()=>u.AFrameworkApplication.Tg));
a.register(1383,"PowerPointWebEditor.IDelayedErrorHandler").ma().oa(()=>new zl(this.K.resolve("PowerPointWebEditor.IErrorMapping"),this.K.resolve("PowerPointWebEditor.IErrorDialog"),this.K.resolve("PowerPointWebEditor.IBusinessBarController"),this.K.resolve("PowerPointWebEditor.IDocRefreshHandler"),this.K.resolve("Common.IActionManager"),this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.K.resolve("Common.IAppSettingsManager"),this.K.resolve("Box4.IAppFrame"),this.K.resolve("PowerPointWebEditor.Core.IPodsPopsEventNotifier"),
this.K.resolve("Box4.IReplicationScheduler"),this.K.resolve("PowerPointWebEditor.ISessionLifetimeManager"),this.K.resolve("PowerPointWebEditor.IApplicationContext"),this.K.Ja("PowerPointWebEditor.PodsPops.IPodSeamlessFailoverManager"),this.K.resolve("PowerPointWebEditor.ICoauthStateGetter")))}init(){this.K.resolve("PowerPointWebEditor.IDelayedErrorHandler");this.K.resolve("PowerPointWebEditor.IDocRefreshHandler").vb();this.K.resolve("PowerPointWebEditor.SeamlessFailoverHandler").vb()}dispose(){this.K.resolve("PowerPointWebEditor.SeamlessFailoverHandler").dispose()}static main(){r.a.instance.Dc(new Jh)}}
Object(n.a)(Jh,"PPTWebEditorErrorHandlingPackage",null,[2,3]);var L=d(1208),ca=d(85),X=d(37);class qb{constructor(){this.font=null;this.wYc=this.isValid=!1}}Object(n.a)(qb,"EmbeddedFontClientStatus",null,[]);class Rb{constructor(a,b,c,h,m,y){this.Jad=this.ucb=null;this.Ga=a;this.fy=b;this.KPg=c.Ad(7);this.qc=h;this.bEb=m;this.az=y;this.KPg.ik(Object(F.a)(this,this.wgb,"onPresentationPropertyChanged"));this.fy.OEa(()=>{this.F2e(0)})}dispose(){this.KPg.Cm(Object(F.a)(this,this.wgb,"onPresentationPropertyChanged"))}get isInitialized(){return!!this.ucb}get bIh(){return this.Jad}C4d(a){return this.isInitialized?
this.ucb.Hb(a)?this.ucb.ga(a):null:null}createFontUrl(a){if(this.Ga.podsHtmlTextForEmbeddedFontsIsEnabled)if(Ba.a.J(41521309,820,50,"CreateFontUrl"),this.isInitialized||this.F2e(2),this.isInitialized){var b=this.az.$F(a);if((b=this.C4d(b))&&!b.wYc&&b.isValid){b.font.Name!==a&&Ba.a.J(41296397,820,15,"Name is not identical");a=ka.FontUtils.J4b(a);const c=this.bEb.resolve(ca.a.WYi,Rb.eZi(b.font));ta.a.Wa(a)||ta.a.Wa(c)?Ba.a.J(41296399,820,15,"FontFace name or url is invalid"):(this.az.TPa(a,String.format("url('{0}')",
c)),b.wYc=!0)}}else Ba.a.J(41296401,820,10,"Dictionary is not initialized")}wgb(a,b){b&&b.node&&b.property&&b.property===X.a.embeddedFonts&&this.F2e(1)}F2e(a){if(this.Ga.podsHtmlTextForEmbeddedFontsIsEnabled)if(Ba.a.J(41521314,820,50,"UpdateEmbeddedFontDictionary, reason: {0}",a),a=this.qc.I7i()){this.ucb?Ba.a.J(41521346,820,50,"Dictionary is updated, count: {0}",a.length):(this.ucb=new Jb.a,Ba.a.J(41296405,820,15,"Dictionary is initialized, count: {0}",a.length));for(const b of a){if(ta.a.Wa(b.Name)){Ba.a.J(41296407,
820,15,"Name is invalid");continue}if(0!==b.Style)continue;a=Rb.PLj(b);const c=this.az.$F(b.Name),h=this.C4d(c);h&&(h.isValid===a||h.wYc)||this.ucb.$(c,Object.assign(new qb,{font:b,isValid:a,wYc:!1}))}this.Jad=Rb.OGi(this.ucb);this.az.lyl(this.Jad);ka.FontUtils.F4h(this.Jad,Object(F.a)(this,this.createFontUrl,"createFontUrl"))}else Ba.a.J(41296403,820,10,"EmbeddedFonts is null")}static eZi(a){return JSON.stringify(a)}static PLj(a){return!ta.a.Wa(a.Name)&&4>a.Style&&!a.IsRestricted&&(0===a.LoadResult||
270===a.LoadResult)}static OGi(a){const b={};for(let c of a)c.value.isValid&&(a=[],a.push(new L.a("",0,0,"",[0])),b[c.key]=a);return b}}Object(n.a)(Rb,"EmbeddedFontsManager",null,[1373,106]);class Qc{}Qc.loading="loading";Qc.loaded="loaded";Qc.error="error";Object(n.a)(Qc,"FontFaceStatus",null,[]);class jd{constructor(){this.s6c=this.Rpg=!1;this.Bte=null;this.init()}get rkg(){return this.s6c}load(a){return new Promise((b,c)=>{this.s6c&&!ta.a.Wa(a)||c([]);let h;h=this.Rpg&&-1<a.indexOf("'")?String.format('48px "{0}"',
a):String.format("48px '{0}'",a);this.Bte.load(h).then(m=>{for(const y of m)ta.a.Wa(y.family)||y.status===Qc.loaded||Ba.a.J(40429085,801,15,"Font load status {0}",y.status);m.length||Ba.a.J(41494563,801,15,"No font resolved");b(m)},m=>{Ba.a.J(41739607,801,10,"Rejected: {0}",m.toString());c(m)})})}init(){const a=window.document;this.Bte=a&&a.fonts?a.fonts:null;this.s6c=!!this.Bte;this.Rpg=!!u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.ka("AllowSpecialCharacterFontsToRender");Ba.a.J(41494593,
801,50,"FontFaceSetAPIIsSupported: {0}",this.s6c)}}Object(n.a)(jd,"FontFaceSetObserver",null,[1371]);class vd{constructor(a){if(!a)throw Error.argumentNull("fontFaceSetObserver");this.Hcb=a}Mce(a){return a?a:{}}Fce(a){return a?a:()=>{}}SIh(a,b,c,h,m,y,G){if(!a)return[];b=this.Mce(b);c=this.Fce(c);h=this.Mce(h);m=this.Fce(m);y=this.Mce(y);G=this.Fce(G);const U=[];for(const ja of a)ja in h?(m(ja),U.push(this.Hcb.load(String.format("{0}_MSCustomFont",ja)))):ja in b?(c(ja),U.push(this.Hcb.load(String.format("{0}_MSFontService",
ja)))):ja in y&&(G(ja),U.push(this.Hcb.load(String.format("{0}_EmbeddedFont",ja))));return U}}Object(n.a)(vd,"FontsObserver",null,[1372]);class Xd{constructor(){this.K=null}get name(){return"PowerPointWebEditor.Fonts"}$b(a){this.K=a;this.K.register(1371,"PowerPointWebEditor.Fonts.IFontFaceSetObserver").ma().oa(()=>new jd);this.K.register(1372,"PowerPointWebEditor.Fonts.IFontsObserver").ma().oa(()=>new vd(this.K.resolve("PowerPointWebEditor.Fonts.IFontFaceSetObserver")));this.K.register(1373,"PowerPointWebEditor.Fonts.IEmbeddedFontsManager").ma().oa(()=>
new Rb(this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.IAppBootCompletedListener"),this.K.resolve("Box4.Graph.IGraphInstance"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PPTe.IResourceViewElementResolver"),this.K.resolve("PowerPointWebEditor.IFontUtilsManager")))}init(){this.K.resolve("PowerPointWebEditor.Fonts.IEmbeddedFontsManager")}dispose(){}static main(){r.a.instance.Dc(new Xd)}}Object(n.a)(Xd,"PPTWebEditorFontsPackage",
null,[2,3]);var Ke=d(427);class jf{Zth(){return!1}}Object(n.a)(jf,"DefaultParagraphViewElementSetUpdateStrategy",null,[1396]);var wf=d(220),eg=d(1062),Ng=d(240);class Ug extends wf.a{constructor(a,b,c,h,m,y,G,U,ja,va,Ta,fb,Db){super(a,b,m);this.Ezc=null;this.uTb=hb.a.nil;this.daf=this.FAd=!1;this.jZ=this.iZ=this.Qmb=this.Pmb=-1;this.bBd=this.QSb=!1;this.qAc=this.M0c=this.zGd=this.lkf=this.Lob=null;this.Qqd=0;this.G6e=this.k2a=this.Nbf=null;a.NM.GZa(b);this.hVa=c;this.AGd=y;this.mRh=G;this.lRh=U;this.eXh=
ja;this.fd=va;this.NRh=Ta;this.Wv=fb;this.a1a(!0);this.QUe(!0);this.eDd=new sb.a(Object(F.a)(this,this.IKi,"determineIsShapesAndTextboxesEnabled"));this.gt=[];this.pNa=new Qa.a;this.g7e=new Qa.a;this.$fb();this.Qc.Mh&&(b=this.Qc.ydj(this.gb))&&(b.isSelected&&(this.BR.EFb=!0),b.S8&&(this.QSb=!0),this.BR.EFb&&(this.Pmb=b.Xia,this.Qmb=b.Yia,this.iZ=b.IS,this.jZ=b.Era));a.np&&(a=Object(ua.a)(564,a))&&a.fLk(this.gb);this.FUb=h;this.sGd=Db}get Lwk(){return this.FUb}get cIe(){return this.AGd}get Tih(){return this.lkf||
(this.lkf=this.mRh())}get Pfd(){if(!this.zGd){const a=this.lRh();a&&(this.zGd=a.gJl())}return this.zGd}get Tf(){return this.fd}get r_(){return this.NRh}get smg(){return this.uTb}set smg(a){this.uTb=a}get Kyj(){return this.pNa}get x8g(){return this.Hi?La.a.gXf(this.Hi,!1):0}get Hi(){return this.Lob}get z$a(){return this.Nbf}a1a(a){let b=!1;this.Mbl(a)&&(a=this.i7a(),this.nc(a),this.Ezc=null,this.uTb=hb.a.nil,b=!0);this.Tf.hg&&this.gb.blb?Sys.UI.DomElement.addCssClass(this.htmlElement,Qb.G3):Sys.UI.DomElement.containsCssClass(this.htmlElement,
Qb.G3)&&(Sys.UI.DomElement.removeCssClass(this.htmlElement,Qb.G3),this.htmlElement.removeAttribute("title"));return b}Mbl(a){let b=!!this.htmlElement;b=b&&0<this.htmlElement.getElementsByTagName("p").length;return a||!b||!this.Hi||"p"!==ta.a.og(this.Hi.tagName)}i7a(){this.Lob=this.Md.hp(wa.a.p);this.Lob.className="Paragraph";this.Nbf=this.Md.hp(wa.a.span);this.z$a.className="WACImageGroupContainer";return this.Md.Vl?this.Lob:this.yFl()}yFl(){const a=this.Md.hp(wa.a.div);a.className="ParaWrappingDiv";
a.appendChild(this.Lob);this.Vo(this.Lob);return a}IU(a){super.IU(a);if(this.gb.UZ)return a=this.gb.UZ.sc(a.M1).xvc,this.gb.UZ=null,new Ng.a(a.Oma,a.minWidth,a.Pma);let b;b=this.G6e;a.Bb(88)&&(b=Ng.a.max(b,a.Tq.WKa),a.zc());return b}Dy(a){if(u.AFrameworkApplication.fa.ka("TextLayoutServiceUpdateLayoutLogicEnabled")&&(this.M0c=null,this.Hi)){const b=this.Hi.getElementsByClassName("LineBox");if(b&&0<b.length){this.M0c=Array(b.length);for(let c=0;c<b.length;c++)this.M0c[c]=La.a.sv(b[c]).length}}this.a1a(!1)&&
(a.currentNode.anchor.ak(this.Ma,8),a.parentNode.anchor.ak(this.Ma,8),this.Ezc=null);super.Dy(a);this.rEi(a,this.Hi)}rEi(a,b){var c=this.gb;if(this.Qc.Mh){var h=na.InteractiveViewManager.instance.Rd;h&&h.Ma===this.Qc.Ma&&h.editingView.Vl&&h.editingView.Dg===this.gb&&2===h.editingView.mode?Sys.UI.DomElement.addCssClass(this.htmlElement,Ug.D$f):Sys.UI.DomElement.removeCssClass(this.htmlElement,Ug.D$f)}if(c.UZ)c=c.UZ.sc(a.M1).htmlElement,La.a.h0b(c,b),b=this.Qc,b.Mh&&b.GF&128&&(this.gb.UZ=null);else{a=
this.zdj();h=Ya.StyleReader.i0f(a);Ya.StyleReader.H_c(a)&&h?(Wa.d(b,oa.a.role,zc.a.bwf),Wa.d(b,oa.a.dwf,h)):(b.removeAttribute(zc.a.af),b.removeAttribute(zc.a.CYb));var m="";if(J.a.instance.ga(71)||J.a.instance.ga(77))m=this.R5i(c);h=a=null;var y=Ob.ParagraphReader.R4f(c,J.a.instance.ga(53),J.a.instance.ga(71),J.a.instance.ga(77),J.a.instance.ga(54));if(this.daf||m!==this.Ezc||this.uTb!==c.UDe){a="WindowText";h="transparent";this.Ezc=m;this.daf=!1;m="";let U=null;"P"!==b.tagName&&y.l$a&&(U=ka.FontUtils.Uia(y.fontName));
if(y.C3){var G=y.fontColor;G!==hb.a.auto&&(a=hb.a.oI(G))}J.a.instance.ga(49)||(y.p$a&&(G=y.FR,G!==hb.a.auto&&(h=hb.a.oI(G))),y.wTa&&(G=y.highlight,G!==hb.a.auto&&(h=hb.a.oI(G))));if(G=Ob.ParagraphReader.language(this.gb))if(G=Fa.a.ue(G))b.setAttribute("xml:lang",G.name),b.setAttribute("lang",G.name);b.style.fontWeight=y.isBold?"bold":"normal";b.style.fontStyle=y.isItalic?"italic":"normal";b.style.verticalAlign="baseline";y.isSuperscript&&(b.style.verticalAlign="super");y.LF&&(b.style.verticalAlign=
"sub");y.dE&&(m="underline");if(y.KF||y.w_)m=0<m.length?m+" line-through":"line-through";b.style.textDecoration=m;b.style.fontFamily=U?U:"'Segoe UI',Tahoma,Verdana,'Sans-Serif'";y.rTa?1===y.capitalization?b.style.fontVariant="small-caps":2===y.capitalization?b.style.textTransform="uppercase":b.style.fontVariant="normal":b.style.textTransform=""}this.uTb=c.UDe;J.a.instance.ga(49)&&(y.p$a&&(m=y.FR,m!==hb.a.auto&&(h=hb.a.oI(m))),y.wTa&&(y=y.highlight,y!==hb.a.auto&&(h=hb.a.oI(y))));this.gb.properties.sa(kb.a.Weg,
!1)?(Sys.UI.DomElement.addCssClass(b,"Conflict"),b.setAttribute(zc.a.tra,"conflictSRDescription")):(Sys.UI.DomElement.removeCssClass(b,"Conflict"),b.removeAttribute(zc.a.tra),h?(b.style.backgroundColor=h,Ug.Crf(h,b)):J.a.instance.ga(49)&&(b.style.backgroundColor="transparent",Sys.UI.DomElement.removeCssClass(b,"Highlight")));c.UDe!==hb.a.nil?(Sys.UI.DomElement.addCssClass(b,"NoteTagHighlight"),h&&(b.style.borderColor=h,Ug.Crf(h,b))):(Sys.UI.DomElement.removeCssClass(b,"NoteTagHighlight"),Sys.UI.DomElement.removeCssClass(b,
"Highlight"));a&&(b.style.color=a);c=Kd.OutlineElementReader.um(mc.OutlineElementNavigator.PA(this.gb));this.Qc.Vl&&(c?Sys.UI.DomElement.addCssClass(b,"Rtl"):Sys.UI.DomElement.removeCssClass(b,"Rtl"));switch(Ob.ParagraphReader.BN(this.gb)){case 1:b.style.textAlign="left";b.style.Jkb="";break;case 2:b.style.textAlign="center";b.style.Jkb="";break;case 3:b.style.textAlign="right";b.style.Jkb="";break;case 6:b.style.textAlign="justify";b.style.Jkb="auto";break;case 7:b.style.textAlign="justify";b.style.Jkb=
"distribute";break;case 9:case 11:case 10:b.style.textAlign="justify";b.style.Jkb="kashida";break;case 13:b.style.textAlign="justify";b.style.Jkb="inter-cluster";break;default:b.style.textAlign="",b.style.Jkb=""}4===Fc.App.mode&&J.a.instance.ga(86)&&v.a.Dj&&"right"===b.style.textAlign.toLowerCase()&&(a=b.style.paddingRight.toLowerCase(),""===a||"0px"===a)&&(b.style.paddingRight="1px");J.a.instance.ga(54)&&(Wa.d(b,oa.a.Cx,this.gb.sa(jb.a.fo,0)),Wa.d(b,oa.a.Fwk,this.gb.id.toString()));this.cIe.eqh(this.gb,
b,c,this.Ma)}}zdj(){var a=J.a.instance.ga(71)?(a=Ya.StyleReader.XD(this.gb))?Ya.StyleReader.tQ(a):J.a.instance.ga(61)?Ya.StyleReader.iMa:Ya.StyleReader.Hoa:Ya.StyleReader.Hoa;return a}R5i(a){let b="";var c=Ya.StyleReader.XD(a);c&&(b+=c.id);Ya.StyleReader.kr&&({tableStyle:a,U6a:c}=Ya.StyleReader.kr.N9a(a),a&&(b+=a.id),c&&(b+=c.id));return b}Iaa(){this.gb.sda(this.Ma,16,!0)}$fb(){this.eDd.value&&this.gb.A$a.$fb()}$J(a){if(!this.cil()){this.$fb();var b=this.gb;this.SCf();La.a.tu(this.Hi);La.a.tu(this.z$a);
var c=this.Hi;c.style.minHeight="";this.gt=[];this.Qqd=0;var h=new Qa.a,m=0;a&&(m=this.tfi(a,b,h,c,m));if(!this.bil()){a=!1;var y=this.htmlElement.parentNode,G=this.htmlElement.nextSibling;y&&(this.wnc(y,this.htmlElement),a=!0);this.Pfd&&this.Pfd.zIl();var U=m;m=this.Lwk.KVk(b,this.Md,c,this.Kyj,h,Object(F.a)(this,this.s4g,"onOverHyperlink"),Object(F.a)(this,this.o4g,"onOutHyperlink"),Object(F.a)(this,this.FM,"takeOwnershipOfSubtree"),Object(F.a)(this,this.Vo,"takeOwnership"),S.a.GNc,this.smg,m,this.Pmb,
this.Qmb,this.QSb,Ug.I_c,!!this.BR&&this.BR.EFb,this.FAd,Fc.App.MR.MVe,Kd.OutlineElementReader.um(mc.OutlineElementNavigator.PA(this.gb)));if(!u.AFrameworkApplication.fa.ka("TextLayoutServiceDataDeletionFixEnabled")||this.Wv.uCf(b,h))this.Wv.JCh(c,this.Md,m.vpf,b,U,h,me.a.instance.Pa?me.a.instance.Pa.mb:null,this.M0c)||this.Md.np||this.Wv.pHh(b);this.gt=h.toArray();this.qAc=m.cZg;this.g7e=m.FCf;this.FAd=m.s$f;this.Pfd&&this.Pfd.uIl(this.x8g);this.Tih&&this.Tih.xIl(c);this.$Fh();this.bBd=!0;a&&y.insertBefore(this.htmlElement,
G);!this.Qc.Vl&&y&&"li"===ta.a.og(y.tagName)&&this.zfi(b,y);this.Qc.Vl||this.Wv.mFf(c)}}}zfi(a,b){if(Wb.ListReader.cna){if(b=this.nSc(a)){const c=b.sc(this.Qc.Ma);if(c){const h=La.a.Pca(this.htmlElement,"Paragraph");this.swk(a)?(a=(a=this.ndj(h))?a.nextSibling:null)?h.insertBefore(c.htmlElement,a):h.appendChild(c.htmlElement):La.a.TMd(h,c.htmlElement);b.anchor.ak(this.Ma,64)}}}else this.hVa.jHf(b,a,this.Ma)}ndj(a){for(let b=0;b<a.children.length;b++){const c=a.children[b];if(Sys.UI.DomElement.containsCssClass(c,
"PageBreakBlob"))return c}return null}swk(a){if(!a)return!1;a=a.Ra;if(!a)return!1;a=a.first;return a?(a=a.blob)?8===a.Sq:!1:!1}nSc(a){const b=new rb.GraphIterator;b.set(a);return b.gf()?(mc.OutlineElementNavigator.Oe(b),this.Tf.hg&&!b.FI(4)?b.Bb(31):b.Bb(4)):null}tfi(a,b,c,h,m){a=Nf.a.nb(a.M1,a.currentNode);if(!a.Gi())return m;let y=0,G=!1,U=0,ja=0,va=0,Ta=!1;const fb=Ob.ParagraphReader.VW(b),Db=this.eDd.value;do{const gc=a.Tq.htmlElement;Sys.UI.DomElement.containsCssClass(gc,S.a.eW)?(Db&&b.A$a.ZIl?
(Ta||(Wb.ListReader.ix&&fb||b.A$a.RIl(this.z$a),h.appendChild(this.z$a)),this.z$a.appendChild(gc)):h.appendChild(gc),Y.a.Lv(gc,S.a.FFa,m++),c.add(gc),this.Qc.Mh&&({vhk:U,Zfk:ja,Yfk:va}=Ug.w7k(b,gc,Db,a,Ta,U,ja,va)),G=Ta=!0):h.appendChild(gc)}while(a.nEa());Db?this.Qc.Vl?this.Jyl():(this.cGh(va+6,ja+6),y=ja+6):y=ja-U+6;G&&!Fc.App.instance.$zj&&this.Qc.Mh&&h.clientHeight<y&&(h.style.minHeight=y+"px");return m}cGh(a=0,b=0){this.eDd.value&&this.gb.A$a.QIl(this.z$a,a,b)}utd(){const a=new Nf.a(this.Ma);
a.set(this.gb);a.gf();mc.OutlineElementNavigator.Oe(a);Wb.ListReader.ix&&(this.cIe.eqh(this.gb,this.Hi,Kd.OutlineElementReader.um(a.currentNode),this.Ma),this.hVa.fzl(a))}$Fh(){this.r_.Bjc(this.gb,this.Hi)}IKi(){const a=vb.a.instance.rb("Box4.IFeatureHelper");return!!a&&a.isFeatureEnabled(130)}get isSelected(){return super.isSelected}set isSelected(a){super.isSelected=a;a||(this.jZ=this.iZ=this.Qmb=this.Pmb=-1)}get Xia(){return this.Qc.Vl?this.gb.sc(this.Qc.If.Ma).Xia:this.Pmb}set Xia(a){this.Pmb!==
a&&(this.Pmb=a,this.voa(16),this.gb.anchor.ak(this.Qc.Ma,16))}get Yia(){return this.Qc.Vl?this.gb.sc(this.Qc.If.Ma).Yia:this.Qmb}set Yia(a){this.Qmb!==a&&(this.Qmb=a,this.voa(48),this.gb.anchor.ak(this.Qc.Ma,48))}get IS(){return this.Qc.Vl?this.gb.sc(this.Qc.If.Ma).IS:this.iZ}set IS(a){this.iZ!==a&&(this.iZ=a,this.voa(16),this.gb.anchor.ak(this.Qc.Ma,16))}get Era(){return this.Qc.Vl?this.gb.sc(this.Qc.If.Ma).Era:this.jZ}set Era(a){this.jZ!==a&&(this.jZ=a,this.voa(48),this.gb.anchor.ak(this.Qc.Ma,
48))}get S8(){return this.Qc.Vl?this.gb.sc(this.Qc.If.Ma).S8:this.QSb}set S8(a){this.QSb!==a&&(this.QSb=a,this.voa(16),this.gb.anchor.ak(this.Qc.Ma,16))}get JQf(){return this.gt[this.gt.length-1]}dispose(){this.ERk();super.dispose();this.SCf();for(let a of this.g7e)a.hNf(this.Md)}ERk(){if(this.k2a&&this.htmlElement)for(let a of this.k2a)a.DRk(this.htmlElement)}fna(){super.fna();this.FAd&&this.Qc.notify(2)}qtd(a){const b=u.AFrameworkApplication.fa.ka("Box4DoNotRenderPresenceOutOfView"),c=this.Qc.GHe.x7d(this.gb);
this.sGd.Hih(c,this.k2a,this,this.htmlElement,b,this.odl());this.k2a=c;this.bBd||this.$Fh();this.bBd=!1;super.qtd(a)}voa(a){this.eXh.Zth(this.gb)||super.voa(a)}cil(){if(this.lhg()){const a=this.Qc;if(1!==a.editingView.Ftb)return a.HXd=!0}return!1}bil(){return this.Qc.Vl&&Bb.SelectionEditor.Rta(me.a.instance.Pa.mb)?!0:!1}Jyl(){var a=this.gb.sc(this.Qc.If.Ma);a&&(a=Sys.UI.DomElement.getBounds(a.z$a),this.cGh(a.width,a.height))}odl(){return!this.lhg()&&!this.Qc.Vl}lhg(){if(na.InteractiveViewManager.instance.Rd!==
this.Qc)return!1;const a=this.Qc.editingView;return a.Dg===this.gb&&2===a.mode}OPj(){const a=this.getBounds(),b=qd.a.ii(this.Qc.container);return a.y+a.height>=b.y&&a.y<=b.y+b.height}oCe(a){a.Sjh(this);0<this.Qqd&&a.mXk(this)}get gYa(){return this.Hi}sGh(a){this.G6e=new Ng.a(0,a,0)}getBounds(){const a=W.a.Prb(this.htmlElement.querySelector("p.Paragraph")||this.htmlElement,this.Qc.Mh?this.gb.id.toString():"");this.cIe.Xai(this.gb,a,Kd.OutlineElementReader.um(mc.OutlineElementNavigator.PA(this.gb)),
this.Qc.Ma);return a}s4g(a){wf.a.n$k(a.Cc,a.kD);if(Fc.App.DZb){const b=a.Cc,c=b.querySelector(".NormalTextRun")||b;J.a.instance.ga(8)||a.XZ?c.style.cursor="pointer":c.style.cursor="text";Sys.UI.DomElement.addCssClass(b,Ug.OCe);eg.a.instance().a9h(Object(F.a)(this,this.tFe,"onCtrlKeyDown"));eg.a.instance().b9h(Object(F.a)(this,this.vFe,"onCtrlKeyUp"))}return!0}o4g(a){Sys.UI.DomElement.removeCssClass(a.Cc,Ug.OCe);eg.a.instance().Khh(Object(F.a)(this,this.tFe,"onCtrlKeyDown"));eg.a.instance().Lhh(Object(F.a)(this,
this.vFe,"onCtrlKeyUp"));return!0}SCf(){for(let a=0;a<this.pNa.count;a++)Fc.App.Kb.LR.yb(ra.a.Qma,this.pNa.ga(a),Object(F.a)(this,this.s4g,"onOverHyperlink")),Fc.App.Kb.LR.yb(ra.a.Rma,this.pNa.ga(a),Object(F.a)(this,this.o4g,"onOutHyperlink")),eg.a.instance().Khh(Object(F.a)(this,this.tFe,"onCtrlKeyDown")),eg.a.instance().Lhh(Object(F.a)(this,this.vFe,"onCtrlKeyUp"));this.pNa.clear();if(this.qAc){for(let a of this.qAc)Fc.App.Kb.LR.yb(a.eventName,a.Cc,a.handler);this.qAc=null}}tFe(){this.iya("pointer")}vFe(){this.iya("text")}iya(a){for(let b=
0;b<this.pNa.count;b++)if(Sys.UI.DomElement.containsCssClass(this.pNa.ga(b),Ug.OCe)){const c=this.pNa.ga(b).querySelector(".NormalTextRun");if(c){c.style.cursor=a;break}}}static get I_c(){return!!me.a.instance.Pa&&!!me.a.instance.Pa.mb&&me.a.instance.Pa.mb.I_c}static Crf(a,b){"transparent"!==a?Sys.UI.DomElement.addCssClass(b,"Highlight"):Sys.UI.DomElement.removeCssClass(b,"Highlight")}static w7k(a,b,c,h,m,y,G,U){b=Sys.UI.DomElement.getBounds(b);c&&(a=a.A$a.AHl(h.currentNode),b.x=a.x,b.y=a.y,b.height&&
b.width||(b.height=a.height,b.width=a.width));a=b.y+b.height;if(!m||b.y<y)y=b.y;if(!m||a>G)G=a;b=b.x+b.width;if(!m||b>U)U=b;return{vhk:y,Zfk:G,Yfk:U}}}Ug.D$f="HiddenParagraph";Ug.OCe="MouseIsOn";Object(n.a)(Ug,"ParagraphViewElement",wf.a,[1127,1445,455,456,106]);class Ah extends wf.a{constructor(a,b,c,h,m,y){super(a,b);this.Ug=this.fd=this.uba=this.AGd=null;Wb.ListReader.cna?(this.JMf(),this.QUe(!0),this.uba=c,this.AGd=m,this.fd=y,this.Ug=h,this.a1a(!0)):(this.QUe(!1),a=this.Md.hp(wa.a.span),a.className=
"ListGhost",this.nc(a))}a1a(a){if(Wb.ListReader.cna){var b=this.B2f(this.gb);a&&(a=this.FWd(),this.nc(a),(b=Object(ua.a)(Ug,b.sc(this.Qc.Ma)))&&b.htmlElement&&(b=b.Hi))&&((a=La.a.x4b(b,Ah.pbb))?b.replaceChild(this.htmlElement,a):La.a.TMd(b,this.htmlElement))}}get tme(){return La.a.x4b(this.htmlElement,Ah.fac)}Dy(){this.a1a(!1);if(!this.Qc.Vl&&Wb.ListReader.cna)if(this.fd.hg)this.j7k(this.htmlElement,this.tme,this.gb);else{const a=this.uba.lAb(this.gb);this.tme.innerText=a}}$J(a){this.Qc.Vl||Wb.ListReader.cna&&
a.currentNode.anchor.ak(this.Ma,64)}oCe(a){Wb.ListReader.cna&&a.Sjh(this)}get gYa(){return this.htmlElement}sGh(){}utd(){this.k7k()}k1f(){return-1}j7k(a,b,c){var h=this.Ug.K6d(c);if(h)if(12!==h.type)ya.a.instance.shipAssertTag(34930713,8,!1,"the node associated with the list is type [{0}]",h.type);else{var m=h.Ra,y=m?m.last.Do:null;m=m?m.last.zp:null;var G=h.blb,U=h.$Hb,ja=h.s8();h=!!G&&U.QZf(ja).Sa(jb.a.listID);G=null;h&&(G=U.Sa(jb.a.listID)&&ja.Sa(jb.a.listID)?3:U.Sa(jb.a.listID)?2:1);U=this.uba.lAb(c);
c=this.uba.lAb(c);y=!!y||h&&(1===G||3===G);m=!!m||h&&(2===G||3===G);G=!y&&!m&&""!==U&&U!==c;for(ja=!y&&!m&&!G;b.hasChildNodes();)b.removeChild(b.firstChild);b.innerText="";b.style.color="";b.title="";Sys.UI.DomElement.removeCssClass(b,Qb.rme);Sys.UI.DomElement.removeCssClass(a,Qb.G3);if(ja)b.innerText=c;else{if(m||G)ja=Xb.a.createElement(b.ownerDocument,wa.a.span),Sys.UI.DomElement.addCssClass(ja,Qb.HAh),ja.innerText=U,b.appendChild(ja);if(y||G)U=Xb.a.createElement(b.ownerDocument,wa.a.span),Sys.UI.DomElement.addCssClass(U,
Qb.JAh),U.innerText=c,b.appendChild(U);y||m?b.style.color="#000":Sys.UI.DomElement.addCssClass(b,Qb.rme);h&&Sys.UI.DomElement.addCssClass(a,Qb.G3)}}else ya.a.instance.shipAssertTag(34930712,8,!1,"No paragraph is found with a list node")}B2f(a){if(!a)return null;const b=new rb.GraphIterator;b.set(a);b.gf();return mc.OutlineElementNavigator.Oe(b)?b.Bb(2):null}FWd(){const a=this.Md.hp(wa.a.span);Sys.UI.DomElement.addCssClass(a,Ah.pbb);this.WKc(a);return a}WKc(a){const b=Xb.a.createElement(a.ownerDocument,
wa.a.span);Sys.UI.DomElement.addCssClass(b,Ah.fac);b.style.textIndent="0px";b.style.textAlign="left";a.appendChild(b);return b}k7k(){if(!this.Qc.Vl){var a=this.B2f(this.gb),b=a.sc(this.Qc.Ma).htmlElement.parentNode;!this.Qc.Vl&&b&&"li"===ta.a.og(b.tagName)&&this.uba.qGh(b,a,this.Ma,this.tme,!1)}}}Ah.pbb="ListMarkerWrappingSpan";Ah.fac="ListMarker";Object(n.a)(Ah,"NumberListViewElement",wf.a,[1445,455,456,106]);var We=d(386),lk=d(1081);class jm{constructor(a,b){this.offsetWidth=a;this.offsetHeight=
b}}Object(n.a)(jm,"ListMarkerOffset",null,[]);class Kh{constructor(){this.t9j="ListMarkerMeasuringPad";this.Cec=new Nd.a}Daj(a){let b=a.innerHTML;if(!b.length)return new jm(0,0);var c=null;window.getComputedStyle&&(c=window.getComputedStyle(a,null))&&(b+=["",c.fontFamily,c.fontSize,c.fontStyle,c.fontWeight,c.fontVariant,c.textDecoration].join("_"));this.Cec.Hb(b)||(a=a.cloneNode(!0),c&&(a.style.fontFamily=c.fontFamily,a.style.fontSize=c.fontSize,a.style.fontStyle=c.fontStyle,a.style.fontWeight=c.fontWeight,
a.style.fontVariant=c.fontVariant,a.style.textDecoration=c.textDecoration),lk.a.RYb(),lk.a.F9a(this.t9j).appendChild(a),{width:c,height:a}=qd.a.yRc(a),this.Cec.$(b,new jm(c,a)),lk.a.E2b());return this.Cec.ga(b)}}Object(n.a)(Kh,"ListMarkerOffsetCache",null,[1375]);var $d=d(1194),xk=d(1211),Ie=d(81),Yd=d(254),Pe=d(181),so=d(487);class Bj{constructor(a,b){this.fd=this.uZ=this.tK=null;this.Ug=a;this.yG=b;this.tG=Wb.ListReader.ix;this.hx=v.a.hx||v.a.to}get Sf(){return this.Ug}get nM(){return this.yG}get BL(){return this.tK||
(this.tK=vb.a.instance.rb("Box4.List.ListSettings"))}get Eja(){return this.uZ||(this.uZ=vb.a.instance.Ja("Common.IZoomManager"))}set Eja(a){this.uZ=a}get Tf(){return this.fd||(this.fd=vb.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}get enabled(){return this.tG}lAb(a){const b=this.Sf.u9a(a);return b&&b.propertySet.sa(kb.a.Ri,null)?1===b.listType?this.Ryf(b):0===b.listType?this.i0g(b,a):"":""}ezl(a,b){if(this.enabled&&b&&(this.Sf.zda(b)||this.Tf.hg&&63===b.type)&&this.Ryb(a)){a.style.display=
"block";var c=this.owb(a);this.Fnd(a,b);c&&(a=this.lAb(b),c.innerText=a)}}jHf(a,b,c){if(this.enabled&&this.Ryb(a)){var h=this.owb(a);h&&this.qGh(a,b,c,h)}}qGh(a,b,c,h,m=!1){var y=rb.GraphIterator.nb(b);y.gf();mc.OutlineElementNavigator.Oe(y);if(Wb.ListReader.tk(y)||this.Tf.hg&&Wb.ListReader.a$b(y)){const U=y.currentNode;var G=Kd.OutlineElementReader.um(U);this.Tf.hg?this.Sf.sZg(y):this.Sf.Sma(y);y=y.currentNode;if(!Wb.ListReader.cna){const ja=this.lAb(y);h.innerText=ja}h.setAttribute(zc.a.JK,zc.a.XB);
12!==b.type?so.a.UYc(b)&&(a=h.parentNode,h.style.height="auto",b=c=0,{width:c,height:b}=this.$vb(h),h.style.height="",c=-1*(Math.ceil(c)+13),h.style.marginLeft=G?"13px":c+"px",h.style.marginRight=G?c+"px":"13px",La.a.M5k(h,G?"right":"left"),G=0,{height:G}=this.$vb(a.parentNode),h.style.marginTop=Math.max((G-b)/2,0)+"px"):(this.J9k(a,h,b,U,y,c),this.P2e(b,h,c,y,G,m))}}fzl(a){this.enabled&&a&&a.Tq&&Kd.OutlineElementReader.um(a.currentNode)}O2e(a,b,c,h,m=-1){this.enabled&&(Ob.ParagraphReader.VW(a)||
this.Tf.hg&&Ob.ParagraphReader.kMj(a))&&this.oGh(a,b,c,m,null)}czl(a,b,c){if(this.enabled&&this.Ryb(a)){var h=La.a.vYf(a,Bj.HOi);if(h&&(h=La.a.vYf(h,Bj.GOi))&&(h=La.a.o8(h,Bj.mfa))&&h.style&&(v.a.fg||(h.style.marginTop="0px"),(a=La.a.o8(a,Bj.Jwk))&&(a=La.a.o8(a,Bj.mfa))&&h.className.startsWith(Bj.mfa))){if(this.Tf.hg){var m=La.a.Lvb(a,Bj.yLa);var y=La.a.Lvb(h,Bj.yLa)}else m=this.w2d(a,Bj.yLa),y=La.a.o8(h,Bj.yLa);m&&y&&(h.style.marginLeft!==a.style.marginLeft&&(h.style.marginLeft=""===a.style.marginLeft?
"0px":a.style.marginLeft),h.style.marginRight!==a.style.marginRight&&(h.style.marginRight=""===a.style.marginRight?"0px":a.style.marginRight),{FUf:b,tUf:c}=this.mGh(a,h,m,y,b,c),this.nbi(b,c,h))}}}w2d(a,b){return La.a.o8(a,b)}mGh(a,b,c,h,m,y){var G;""!==a.style.textIndent&&(y&&this.Sf.qbb||""===b.style.textIndent)&&(y=a.style.textIndent,this.Sf.qbb&&(G=this.mSc(a))&&(y=this.Wmi(G,y)),b.style.textIndent=y);y=this.Xvb(c);G=this.Xvb(h);Math.floor(G.x)!==Math.floor(y.x)?(a=this.hni(m,y,G),a=isNaN(a)?
0:a,""!==b.style.textIndent&&(m=b.style.textIndent,y=m.lastIndexOf("px"),0<y&&(m=m.substring(0,y),a+=parseInt(m))),b.style.textIndent=a+"px",y=this.Xvb(c),G=this.Xvb(h)):""===b.style.textIndent&&(b.style.textIndent=a.style.textIndent);return{FUf:y,tUf:G}}hni(a,b,c){let h=0;10>Math.abs(c.x-b.x)?this.BL.VNj||(h=this.C2f(a,b,c)):h=this.C2f(a,b,c);return h}C2f(a,b,c){return a?c.x-b.x:b.x-c.x}Wmi(a,b){let c=b,h;({width:h}=this.$vb(a));if(h){var m=a.style.marginLeft,y=a.style.marginRight;const G=m.lastIndexOf("px"),
U=y.lastIndexOf("px");a=c.lastIndexOf("px");0<a&&0<G&&0<U&&(m=this.gIe(m,G),y=this.gIe(y,U),(b=this.gIe(b,a))||m||y)&&(c=b+h+m+y+"px")}return c}gIe(a,b){a=a.substring(0,b);a=parseFloat(a);return a=isNaN(a)?0:a}nbi(a,b,c){if(v.a.fg){if(.1<Math.abs(a.y-b.y)){let h=parseFloat(c.style.marginTop);h=isNaN(h)?0:h;c.style.marginTop=a.y-b.y+h+"px"}}else c.style.marginTop=a.y-b.y+"px"}k1f(a,b=!1){return(a=this.owb(a))?({width:a}=this.$vb(a),b?a+0:a):0}owb(a){return this.enabled&&this.Ryb(a)?(a=so.a.Maj(a))?
this.i1f(a):null:null}Fnd(a,b,c=!1){if(this.enabled&&this.Ryb(a)){if(this.Tf.hg){var h="1";var m=this.Sf.G6d(b)}else h=this.Caj(b),m=this.Sf.u9a(b);b=this.X4b(b,m);c?(Wa.d(a,oa.a.bIi,b),Wa.d(a,oa.a.role,zc.a.DPa),Wa.d(a,oa.a.aIi,h)):(Wa.d(a,oa.a.Yei,b),Wa.d(a,oa.a.role,zc.a.DPa),Wa.d(a,oa.a.dwf,h))}}i1f(a){if(!this.enabled||!a)return null;let b=null;(a=this.mSc(a))&&(b=La.a.o8(a,Bj.fac)||this.WKc(a));return b}Ryb(a){return!!a&&"li"===ta.a.og(a.tagName)}oGh(){}GZf(){return 720}$vb(a){let b,c;({width:b,
height:c}=qd.a.yRc(a));this.Eja&&this.Eja.instance&&this.Eja.instance.chg(a)&&(b/=this.Eja.instance.Y2,c/=this.Eja.instance.Y2);return{width:b,height:c}}Xvb(a){const b=qd.a.yRc(a).returnValue;this.Eja&&this.Eja.instance&&this.Eja.instance.chg(a)&&(b.x/=this.Eja.instance.Y2,b.y/=this.Eja.instance.Y2);return b}Oja(a,b){switch(a.Oja()){case 0:return b+"";case 4:return ta.a.DGf(b-1,!0);case 2:return ta.a.FGf(b,!0);case 3:return ta.a.DGf(b-1,!1);case 1:return ta.a.FGf(b,!1);case 22:return 10>b?"0"+b:b+
"";default:return b+""}}Ryf(a){if(1!==a.listType)return"";a=this.Ocj(a.listType,a.listStyle);return Yd.a.iyf(a[0])}i0g(a,b){b=this.X4b(b,a);return this.Oja(a,b)+"."}Ocj(a,b){return Pe.a.pN(a,b).propertySet.sa(kb.a.Ri,null)}X4b(a,b){const c=b.oja;return c!==Yd.a.Hw?c:this.nni(a,b)}nni(a,b){if(b.eX!==Yd.a.Hw)return b.eX;if(b.qA!==Yd.a.Hw)return b.qA;let c=1;const h=new rb.GraphIterator;h.set(a);h.gf();for(mc.OutlineElementNavigator.Oe(h);h.oEa();)if(Wb.ListReader.tk(h)){const m=this.Sf.fw(h);if(m&&
b&&m.listType===b.listType&&m.listStyle===b.listStyle){if(m.eX!==Yd.a.Hw)return c+m.eX;if(m.qA!==Yd.a.Hw)return c+m.qA;if(a.Sa(jb.a.listID)&&h.currentNode.Sa(jb.a.listID)&&h.currentNode.eb(jb.a.listID)!==a.eb(jb.a.listID))break;c++}}return c}EAl(a,b){Fc.App.obb&&(a.Sa(kb.a.fontColor)&&(b.fontColor=a.eb(kb.a.fontColor)),a.Sa(kb.a.fontSize)&&(b.fontSize=a.eb(kb.a.fontSize)),a.Sa(kb.a.font)&&(b.fontName=a.eb(kb.a.font)),a.Sa(kb.a.bold)&&(b.isBold=a.eb(kb.a.bold)),a.Sa(kb.a.italic)&&(b.isItalic=a.eb(kb.a.italic)),
a.Sa(kb.a.superscript)&&(b.isSuperscript=a.eb(kb.a.superscript)),a.Sa(kb.a.subscript)&&(b.LF=a.eb(kb.a.subscript)),a.Sa(kb.a.strikethrough)&&(b.KF=a.eb(kb.a.strikethrough)),a.Sa(Ie.a.Vs)&&(b.w_=a.eb(Ie.a.Vs)))}B7d(a,b){a=Ob.ParagraphReader.R4f(a,J.a.instance.ga(53),J.a.instance.ga(71),J.a.instance.ga(77),J.a.instance.ga(54));this.EAl(b,a);return a}xZf(){return null}pGh(a,b,c,h){const m=c.parentNode;let y=h.sa(kb.a.fontSize,lf.Font.pI);if(a.LF||a.isSuperscript)Wa.d(c,oa.a.gKf,(y/2).toString()),y=Math.floor(y*
Oc.$Yi),m&&(m.style.fontSize=y/2+"pt"),c.style.fontSize=y/2+"pt";else if(Wb.ListReader.cna){if(c.style.fontSize=y/2+"pt",!h.Sa(kb.a.fontSize)&&(a=La.a.Lvb(b,"EOP")))c.style.fontSize=a.style.fontSize}else c.style.fontSize=b.style.fontSize}J9k(a,b,c,h,m,y){b&&this.Ryb(a)&&(b.style.verticalAlign=a.style.verticalAlign,h&&m&&Fc.App.obb&&(y=h.tg(y)))&&(h=this.B7d(c,m,J.a.instance.ga(53),J.a.instance.ga(71),J.a.instance.ga(77),J.a.instance.ga(54)),h=this.xZf(y.Md,c)||h,this.O4b(a,b,m),!this.Tf.hg||""===
b.style.color&&!Sys.UI.DomElement.containsCssClass(b,Qb.rme)?(c="",h.C3&&(y=h.fontColor,y!==hb.a.auto&&(c=hb.a.oI(y))),b.style.color=c,c=this.Sf.u9a(m)):c=this.Sf.G6d(m),b.style.fontWeight=h.isBold&&1!==c.listType?"bold":"normal",b.style.fontStyle=h.isItalic&&1!==c.listType?"italic":"normal",h.isSuperscript?b.style.verticalAlign="super":h.LF&&(b.style.verticalAlign="sub"),this.pGh(h,a,b,m),h.KF||h.w_)&&(b.style.textDecoration=0<b.style.textDecoration.length?b.style.textDecoration+" line-through":
"line-through")}O4b(a,b){b.style.fontFamily=a.style.fontFamily}mSc(a){return a?La.a.x4b(a,og.a.pbb)||this.FWd(a):null}WKc(a){const b=Xb.a.createElement(a.ownerDocument,wa.a.span);Sys.UI.DomElement.addCssClass(b,Bj.fac);b.style.textIndent="0px";b.style.textAlign="left";a.appendChild(b);return b}FWd(a){if(!a)return null;const b=Xb.a.createElement(a.ownerDocument,wa.a.span);Sys.UI.DomElement.addCssClass(b,og.a.pbb);La.a.TMd(a,b);this.WKc(b);return b}P2e(a,b,c){this.O2e(a,b.parentNode.parentNode,this.nM.cwb(a).ROb,
this.nM.j9a(a).ROb,c)}}Bj.mfa="Paragraph";Bj.Jwk="ParaWrappingDiv";Bj.GOi="_EditingElement";Bj.HOi="_EditingElement_WrappingDiv";Bj.yLa="TextRun";Bj.fac="ListMarker";Object(n.a)(Bj,"AListMarkerUtility",null,[1376]);var Qe=d(64),ln=d(802);class Yk{}Yk.IRd=8226;Yk.Pyf="Arial";Yk.UXd=65532;Yk.JIa=65533;Object(n.a)(Yk,"PptListConstants",null,[]);var xf=d(58),Vg=d(231);class mn extends Bj{constructor(a,b,c,h,m,y,G,U,ja,va,Ta,fb,Db,gc,hc,Gc,Pc,yc){super(a,b);this.l3j=[12295,19968,20108,19977,22235,20116,
20845,19971,20843,20061];this.Nne=c;this.Cec=h;this.Ea=m;this.Xl=y;this.nck=G;this.Pb=U;this.QC=ja;this.Hh=va;this.gJ=Ta;this.oH=fb;this.IC=Db;this.opg=gc;this.EWa=hc;this.dA=yc;this.sva=Gc;this.Xdc=Pc}Caj(a){const b=new rb.GraphIterator;b.set(a);b.gf();mc.OutlineElementNavigator.Oe(b);return b.currentNode.sa(jb.a.listLevel,0)+1+""}oGh(a,b,c,h,m=null){const y=this.Nne.Vp(M.a.dzl);m=new Nf.a(h);m.set(a);m.gf();mc.OutlineElementNavigator.Oe(m);if(Wb.ListReader.tk(m)){if(!b){this.Nne.Wb(Ed.a.wh,{["Reason"]:"ParagraphElementNull"});
y.end();return}h=this.i1f(b);if(!h){this.Nne.Wb(Ed.a.wh,{["Reason"]:"ListMarkerNotFound"});y.end();return}let G=this.$vb(h).width;const U=m.Tq.Md.Ld;a=U.XJ(this.nM.v8(a).MM,0);c=U.XJ($d.a.rfa(c,0),0);this.dA&&Object(za.a)(526,this.IC.Rd)&&(c=0);m=Kd.OutlineElementReader.um(m.currentNode);this.g7k(b,h,a,c,G,m)}y.end()}$vb(a){a=this.Cec.Daj(a);return{width:a.offsetWidth,height:a.offsetHeight}}mSc(a){let b=a;this.EWa&&a&&0<=a.className.indexOf(wb.a.mfa)&&(a=La.a.Pca(a,wb.a.g9))&&(b=a);return super.mSc(b)}w2d(a,
b){return this.EWa?La.a.o8(a,wb.a.g9)?La.a.Lvb(a,b):La.a.o8(a,b):super.w2d(a,b)}mGh(a,b,c,h){b.style.textIndent=a.style.textIndent;a=this.Xvb(c);h=this.Xvb(h);return{FUf:a,tUf:h}}Oja(a,b){switch(a.Oja()){case 18:return 21>b?ta.a.fromCharCode(b-1+9312):b.toString();case 19:return this.A0i(b)}return super.Oja(a,b)}Ryf(a){let b="";if(1===a.listType){const c=a.propertySet.sa(kb.a.Ri,null);c&&c.length&&c[0]&&(b=ta.a.dw(c[0],4))}b=this.Ebi(b?b:"2022",a);if(Rd.a("FixEvalSecurityBugForListMarkerUtility")&&
String.fromCodePoint)return String.fromCodePoint(String.format("0x{0}",b));Ba.a.J(512496919,809,15,"Use of Eval in ListMarkerUtility");return Object(xk.a)(String.format("'\\u{0}'",b))}i0g(a,b){b=this.X4b(b,a);return this.Oja(a,b)+this.Ncj(a)}g7k(a,b,c,h,m,y){h?this.i7k(a,b,h,c,m,y):this.h7k(a,b,m,y)}i7k(a,b,c,h,m,y){const G=Math.max(Math.abs(c),m);a.style.textIndent=0<c?G+"px":Math.max(G-h,0)+"px";this.Uph(G-m,-1*G,b,y)}h7k(a,b,c,h){a.style.textIndent=c+"px";this.Uph(0,-1*c,b,h)}Uph(a,b,c,h){c.style.marginLeft=
h?a+"px":b+"px";c.style.marginRight=h?b+"px":a+"px"}Ncj(a){a=a.h9;for(let b=0;b<a.length;b++)if(a[b]===Yk.JIa){if(b+2>=a.length)break;return a[b+2]?ta.a.fromCharCode(a[b+2]):""}return"."}A0i(a){let b="";for(;0<a;)b=ta.a.fromCharCode(this.l3j[a%10])+b,a=parseInt(String(a/10));return b}Ebi(a,b){let c=a;1===b.listType&&b.k$a&&0<=Array.indexOf(mn.A_k,b.font)&&!a.indexOf("0")&&(c="f"+a.substr(1));return c}B7d(a,b,c,h,m,y){if(!this.opg)return super.B7d(a,b,c,h,m,y);h=this.Pb.Nc(b);h.rc(11);h.Ng(11);m=this.gJ.nQ(h,
this.oH.Wca(h));c=new ln.ParagraphStandardProperties;(y=this.Xl.wka(b))||this.nck.OIj(b)?(c.fontColor=hb.a.SQa,c.fontSize=y?xf.a.H_g:Ob.ParagraphReader.wja(a,kb.a.fontSize,lf.Font.pI)):(b.Sa(kb.a.fontColor)?c.fontColor=b.eb(kb.a.fontColor):m&&m.Sa(kb.a.fontColor)&&!Qe.isTableCellOrInside(h)?c.fontColor=m.eb(kb.a.fontColor):c.fontColor=this.Hh.wja(a,kb.a.fontColor,hb.a.nil),h=this.Hh.wja(a,kb.a.fontSize,lf.Font.pI),a=this.Ea.FDa(this.Ea.Zm(a)),a*=h,b.Sa(X.a.ivb)&&(a*=b.eb(X.a.ivb)),c.fontSize=a);return c}pGh(a,
b,c){this.opg&&(b=this.QC.zI(b))&&a.Ata&&(c.style.fontSize=b.Md.Ld.Via(a.fontSize),c.style.lineHeight="0.1")}M_f(a,b){let c="";const h=this.Sf.u9a(b);1===h.listType&&h.k$a?c=h.font&&-1===h.font.indexOf(",")?ka.FontUtils.Uia(h.font):h.font:19===h.Oja()||18===h.Oja()&&21>this.X4b(b,h)?c=ka.FontUtils.Uia("Dengxian"):(b=null,a&&a.parentNode&&a.parentNode.parentNode&&(b=a.parentNode.parentNode.children[1]),b&&(c=b.style.fontFamily));return c}O4b(a,b,c){a=this.M_f(b,c);b.style.fontFamily=a;b.style.fontFamily||
!v.a.Uj&&!v.a.to||("Wingdings 3,Sans-Serif"===a?b.style.fontFamily="'Wingdings 3','Sans-Serif'":"Wingdings 2,Sans-Serif"===a&&(b.style.fontFamily="'Wingdings 2','Sans-Serif'"))}P2e(a,b,c,h,m,y=!1){if(this.EWa){if(b=b.parentNode.parentNode)b=0<=b.className.indexOf(wb.a.g9)?b.parentNode:b,this.O2e(a,b,this.nM.cwb(a).ROb,this.nM.j9a(a).ROb,c)}else super.P2e(a,b,c,h,m,y)}owb(a){return super.owb(a)}uaj(a,b){return this.X4b(b,a)}Fnd(a,b,c=!1){if(this.sva){const m=this.Pb.Nc(b);m.rc(11);m.Ng(11);m.Bb(2);
if(c){if(b&&b.Sa(X.a.tfg)&&!b.eb(X.a.tfg)){var h=b.sa(kb.a.Ri,null);h&&0<h.length&&a.setAttribute("data-charcodes",h.toString());h=this.owb(a);h=this.M_f(h,b);ta.a.Wa(h)||a.setAttribute("data-font",h);a.setAttribute("data-buAutoNum",b.sa(X.a.autonumberBulletType,8))}this.Xdc&&m.currentNode.Sa(X.a.Khe)&&!m.currentNode.eb(X.a.Khe)&&a.setAttribute("data-margin",m.currentNode.sa(jb.a.Zl,Vg.a.leftMargin).toString())}}super.Fnd(a,b,c)}xZf(a,b){return this.dA&&a&&b&&(Object(za.a)(526,a)||Object(za.a)(526,
this.IC.Rd)&&a.Vl)?(a=new ln.ParagraphStandardProperties,a.fontName=lf.Font.QS,a.fontColor=hb.a.SQa,a.fontSize=xf.a.fjl,a):null}}mn.A_k="Symbol;Wingdings;Wingdings 2;Wingdings 3;Webdings;Wingdings,Sans-Serif".split(";");Object(n.a)(mn,"ListMarkerUtility",Bj,[925]);class Hm{static G1j(){"GetSpecialIndentWithTabs"in Hm.rmh||(Hm.rmh.GetSpecialIndentWithTabs=!0,Ba.a.J(40649491,817,15,"{0}:{1}","GetSpecialIndentWithTabs","Invalid tab size"))}}Hm.rmh={};Object(n.a)(Hm,"SessionLogger",null,[]);class Im{constructor(a,
b,c,h,m,y){this.i7c=a;this.X9=b;this.Hh=c;this.Pb=h;this.gJ=m;this.zsg=y}eqh(a,b,c,h=-1){let m=this.zsg;0<=h&&(m=this.TZf(a,h)||m);this.X7k(a,b,c,m);this.Y7k(a,b,m,h)}TZf(a,b){let c=null;(a=a.sc(b))&&a.Md&&(c=a.Md.Ld);return c}X7k(a,b,c,h){let m=0;this.Hh.VW(a)||(m=h.XJ(this.X9.v8(a).MM,0));c?(b.style.marginLeft="",b.style.marginRight=m+"px"):(b.style.marginLeft=m+"px",b.style.marginRight="")}Y7k(a,b,c,h=-1){var m=this.X9.HRc(a).MM;a.anchor&&this.Hh.VW(a)&&0<=h?this.i7c.O2e(a,b,$d.a.XJ(m,0),0,h):
(h=c.XJ(m,0),m=c.XJ(this.X9.v8(a).MM,0),b.style.textIndent=this.Sij(h,m,this.yAi(a),this.A6i(a),c)+"px")}yAi(a){let b=0;if(void 0!==a&&null!==a&&(a=a.characterData))for(;b<a.length;)if("\t"===a.charAt(b))b++;else break;return b}A6i(a){let b=a.sa(jb.a.Ptb,Im.XHc);if(!a.Sa(jb.a.Ptb)){const c=this.Pb.Nc(a);c.set(a);c.rc(11);c.Ng(11);(a=this.gJ.nQ(c,a.sa(jb.a.listLevel,Vg.a.zEa)))&&(b=a.sa(jb.a.Ptb,Im.XHc))}return b}Sij(a,b,c,h,m){a=-1*a<b?a:-1*b;if(!c)return a;0>a&&(c--,a=0);0>=h&&(c=0,Hm.G1j());0<c&&
(h=m.XJ(h,0),a=(Math.floor((a+b)/h)+c)*h-b);return a}Xai(a,b,c,h=-1){var m=this.zsg;0<=h&&(m=this.TZf(a,h)||m);a=this.X9.HRc(a).MM;m=m.XJ(a,0);0>m&&(c||(b.x+=m),b.width-=m)}}Im.XHc=1440;Object(n.a)(Im,"ParagraphViewIndentationStrategy",null,[1444]);var ff=d(423),to=d(635),nn=d(363),Uf=d(147),Cj=d(229),ao=d(262);class bo{constructor(a,b,c){this.success=a;this.cwk=b;this.wEk=c}}Object(n.a)(bo,"AddSpansForThisLinePerTextLayoutPropertyResult",null,[]);var Um=d(808);class Wf{constructor(){this.Km=new E.DictionaryPropertySet}eb(a){return this.Km.eb(a)}sa(a,
b){return this.Km.sa(a,b)}Sa(a){return this.Km.Sa(a)}get propertySet(){return this.Km.clone()}get zN(){return this.Km.sa(kb.a.font,lf.Font.QS)}get hV(){return this.Km.sa(jb.a.hV,-1)}get fieldInstruction(){return this.Km.sa(jb.a.fieldInstruction,"")}get Ata(){return this.Km.Sa(kb.a.fontSize)}get fontSize(){return this.Km.sa(kb.a.fontSize,lf.Font.pI)}get C3(){return this.Km.Sa(kb.a.fontColor)}get fontColor(){return this.Km.sa(kb.a.fontColor,hb.a.nil)}get Y9f(){return this.Km.Sa(Um.a.y_b)}get qVf(){return this.Km.sa(Um.a.y_b,
1)}get wTa(){return this.Km.Sa(kb.a.highlight)}get highlight(){return this.Km.sa(kb.a.highlight,hb.a.nil)}get p$a(){return this.Km.Sa(Ie.a.FR)}get FR(){return this.Km.sa(Ie.a.FR,hb.a.nil)}get $9f(){return this.Km.Sa(kb.a.$s)}get language(){return this.Km.sa(kb.a.$s,0)}get qTa(){return this.Km.Sa(kb.a.bold)}get isBold(){return this.Km.sa(kb.a.bold,!1)}get m$a(){return this.Km.Sa(kb.a.italic)}get isItalic(){return this.Km.sa(kb.a.italic,!1)}get pxb(){return this.Km.Sa(kb.a.underline)}get dE(){return this.Km.sa(kb.a.underline,
!1)}get dVc(){return this.Km.Sa(kb.a.Lw)}get Lw(){return this.Km.sa(kb.a.Lw,lf.Font.pV)}get oxb(){return this.Km.Sa(kb.a.strikethrough)}get KF(){return this.Km.sa(kb.a.strikethrough,!1)}get T6b(){return this.Km.Sa(Ie.a.Vs)}get w_(){return this.Km.sa(Ie.a.Vs,!1)}get isSuperscript(){return this.Km.sa(kb.a.superscript,!1)}get LF(){return this.Km.sa(kb.a.subscript,!1)}get JG(){return this.Km.sa(jb.a.JG,null)}get Zs(){return this.Km.sa(kb.a.Zs,!1)}get z_(){return this.Km.sa(kb.a.z_,!1)}get an(){return this.Km.sa(kb.a.an,
!1)}get Z$a(){return this.Km.sa(jb.a.Z$a,!1)}get wUa(){return this.Km.sa(xc.a.Jwa,!1)}get rTa(){return this.Km.Sa(Ie.a.capitalization)}get capitalization(){return this.Km.sa(Ie.a.capitalization,0)}get QEa(){return this.Km.sa(jb.a.QEa,!1)}Xp(a,b){b.Sa(a)&&this.Km.setValue(a,b.Lh(a))}static BHc(a){const b=new Wf;b.Km.setValue(kb.a.fontSize,xf.a.cjl);b.Xp(kb.a.superscript,a.propertySet);b.Xp(kb.a.subscript,a.propertySet);a.Zs&&b.Km.setValue(kb.a.underline,!0);return b}}Object(n.a)(Wf,"PptSmartArtFormattingCache",
null,[1190]);class on{constructor(a,b,c,h){this.Ygi=a;this.ahi=b;this.Zgi=c;this.$gi=h}}Object(n.a)(on,"SelectionImageProperty",null,[]);var vg=d(148),Td=d(69);class Kj{constructor(a,b,c,h,m,y,G,U,ja,va,Ta,fb,Db,gc,hc,Gc,Pc,yc,Vd,De,Wd,Ve,$e,Qf,lg,Hg){this.xxg=this.wxg=!1;if(!lg)throw Error.argumentNull("graphTopologyManager");this.IC=a;this.Ea=b;this.jc=c;this.G4j=h;this.No=m;this.QC=y;this.Jfc=G;this.zC=U;this.Zy=ja;this.xX=va;this.ua=lg;this.adb=Ta;this.d6c=fb;this.uCb=Db&&!Vd;this.EWa=gc;this.LWa=
hc;this.ECb=Gc;this.Adc=Pc;this.Had=yc&&!Vd;this.dA=De;this.Pla=Wd;this.e6c=Ve;this.Xcf=$e;this.T8j=Qf;this.ua=lg;this.K8j=Hg}h9a(a,b){if(b.sa(X.a.hFa,!1))return xf.a.H_g;b=this.Ea.FDa(this.Ea.Zm(b));return kf.a.Uy(b,1)?a:2*Math.round(a*b/2)}Mvf(a,b){if(!this.Xcf||!a)return b;Kj.N_f(a);return b}phj(a){if(!this.K8j||ta.a.Wa(a))return null;const b=this.ua.presentation.$2d;if(!b)return null;for(const c of b)if(c.Font===a)return c.SubstitutedByFont;return null}O_f(a,b,c){return c.Via(this.h9a(a,b))}sYf(a,
b){return a.Sa(X.a.Gsb)?b.tfa(a.eb(X.a.Gsb)/ff.a.plc,0)+"px":null}P0f(a){if(a.Sa(X.a.Tzb)){const b=a.eb(X.a.Tzb)/ff.a.plc;a=a.fontSize;return 0<b&&a*ff.a.v$a>=b?"normal":"none"}return null}Q5d(a,b,c,h){let m=null;this.adb?m=hb.a.oI(0):!c&&h||!b.C3?this.uCb&&h&&(m=J.a.instance.ga(119)?b.sa(X.a.z7b,!1)?this.p0f(a):hb.a.oI(b.fontColor):this.p0f(a)):(a=b.fontColor,m=a===hb.a.auto?"WindowText":hb.a.oI(a));return m}buh(a,b,c,h,m){return!b&&!c&&!h&&!m&&(!this.d6c||a.isSuperscript||a.LF)}j5f(a){return a.Sa(X.a.gN)?
a.eb(X.a.gN)/1E3:0}h9d(){return 2/3}p0f(a){let b=null;var c=Object.assign(new to.a,{schemeClrField:Object.assign(new nn.a,{valField:10})});a=Object(ua.a)(115,this.jc.mg(a));(c=this.G4j.LJ(c,a?a.Ne:null))&&(b=Uf.Box4ColorHelper.Poa(c).jV());return b}Gth(a,b){return this.uCb||a||!b}juh(){return!0}Ith(){return this.uCb}TAl(a,b,c,h){if(!c||!c.Ua||!h||1>h.length)return b;let m=0,y=0;for(let G=0;G<h.length;G++){if(c.Ua.Qa>=y&&c.Ua.Qa<y+h[G]||c.Ua.Qa===y+h[G]&&h[G]>b.Lines[G]){m=G;break}y+=h[G]}c=0;for(const G of b.Lines)c+=
G;a=a.Ra.ga(a.Ra.length-1).cp;a+1!==c&&(b.Lines[m]+=a+1-c);return b}uCf(a,b){a=Object(ua.a)(Vb.AParagraphNode,a);if(!a||!a.Ra)return!1;let c=0;for(let h of b)if(0>h.className.indexOf("EOP")){if(h.innerText!==a.characterData.substr(c,h.innerText.length))return!1;c+=h.innerText.length}return!0}JCh(a,b,c,h,m,y,G,U){if(!(this.EWa&&a&&c&&c.length&&b))return!1;var ja=this.Ea.Zm(h);if(!ja)return!1;ja=this.LWa&&ja.HBb;if(!b.np&&!ja)return!1;h=Object(ua.a)(Vb.AParagraphNode,h);if(!h||!h.Ra||!ja&&this.Jfc.z7a(h))return!1;
c=this.w5i(c,h,!b.np);if(this.yKi(a,c))return!1;if(0<=a.style.textAlign.indexOf("justify")){if(!this.No||this.No.pua)return!1;Sys.UI.DomElement.addCssClass(a,"JustifyAlign")}else Sys.UI.DomElement.removeCssClass(a,"JustifyAlign");return this.ECb?this.jtl(h,a,b,m,y,G,U):this.htl(a,b,c)}pHh(a){this.LWa&&a&&(a=this.Ea.Zm(a))&&a.HBb&&(Ba.a.J(512496915,820,50,"UpdateUseTextLayoutService - Fallback to HTML Text Layout for this shape."),a.wlb(!1))}qaj(a,b){const c=vg.a.ui(a,X.a.oNb,null);if(!c||!c.Lines)return null;
if(!b){if(!a.Ra.length)return Ba.a.J(512496914,820,50,"GetLineInfoIfValid - CharacterProperties length 0, TextLayout {0}",c.Lines.length),null;b=0;for(const h of c.Lines)b+=h;if(a.Ra.ga(a.Ra.length-1).cp+1!==b)return null}return c}htl(a,b,c){if(!c)return!1;const h=new Qa.a;for(const m of c){c=b.hp(wa.a.span);Sys.UI.DomElement.addCssClass(c,wb.a.g9);h.add(c);let y=!1;for(let G=0;G<m;G++)if(a.firstChild)c.appendChild(a.firstChild);else{Ba.a.J(512496913,820,10,"Span count not match between paragraph and countOfSpanInLine");
y=!0;break}if(y)break}b=Object(ua.a)(1127,this.QC.zI(a));if(!b)return Ba.a.J(512496912,820,10,"Line Box is not added because the ownership of paragraph dom is null"),!1;for(let m of h)b.Vo(m),a.appendChild(m);return!0}jtl(a,b,c,h,m,y,G){if(!b||!c)return!1;let U=vg.a.ui(a,X.a.oNb,null);if(!U||!U.Lines||!U.Lines.length)return!1;for(this.T8j&&(U=this.TAl(a,U,y,G));m.count>h;)m.removeAt(h);a=new Qa.a;G=y=h=null;for(let ja=0;ja<U.Lines.length;ja++){h=c.hp(wa.a.span);Sys.UI.DomElement.addCssClass(h,wb.a.g9);
a.add(h);const va=this.K6h(U.Lines[ja],b,h,y,G,m);y=va.cwk;G=va.wEk;this.C2j(ja,U.Lines.length,h.lastChild);if(!va.success){Ba.a.J(512496911,820,50,"TryAddLineBoxWithSpanUpdatePerTextLayoutProperty - Number of chars specified by text layout not available in paragraph");break}}for(this.xFc(y,h,m);b.firstChild;)this.xFc(b.firstChild,h,m);return this.itl(b,a)}C2j(a,b,c){Kj.zxg||(Mf.Health.instance.recordKpiUsage("TextLineBreakWordBreakTelemetry",0,"pptotext",null),Kj.zxg=!0);!c||!c.innerText||1>c.innerText.length||
(a=a+1===b,b=-1<c.innerText.indexOf(" "),c=" "!==c.innerText.charAt(c.innerText.length-1),!Kj.yxg&&!a&&b&&c&&(Mf.Health.instance.recordKpiFailure("TextLineBreakWordBreakTelemetry","TLSWordBreakError",!1,!0,null),Kj.yxg=!0))}K6h(a,b,c,h,m,y){let G=!0;for(;0<a;){if(!(h&&h.innerText.length||b.firstChild)){Ba.a.J(512496910,820,10,"TryAddLineBoxSpanPerTextLayoutProperty - Number of chars specified not available");G=!1;break}let U;h?(m=U=h,h=null):(U=b.firstChild,m&&!Sys.UI.DomElement.containsCssClass(U,
wb.a.vN)&&(m.style.lineHeight=U.style.lineHeight),m=null);const ja=U.innerText.length;a>=ja?(this.xFc(U,c,y),a-=ja):(h=U.cloneNode(!1),this.kkl(U,h,a),this.xFc(U,c,y),a-=U.innerText.length)}return new bo(G,h,m)}kkl(a,b,c){a=a.childNodes;let h=-1;for(let m=0;m<a.length;m++){const y=a[m];if(c)if(c>=y.innerText.length)c-=y.innerText.length;else{const G=y.cloneNode(!0);G.innerText=y.innerText.substring(c,y.innerText.length+1);b.appendChild(G);y.innerText=y.innerText.substring(0,c);c=0}else{h=m;break}}for(;-1!==
h&&h<a.length;)b.appendChild(a[h])}xFc(a,b,c){if(a&&b&&c){b.appendChild(a);a=La.a.t9a(a);for(let h of a)c.add(h),Y.a.Lv(h,"leafEltIdx",c.count-1)}}itl(a,b){const c=Object(ua.a)(1127,this.QC.zI(a));if(!c)return Ba.a.J(512496909,820,10,"Line Box is not added because the ownership of paragraph dom is null"),!1;for(let h of b)c.Vo(h),a.appendChild(h);return!0}w5i(a,b,c){const h=this.Hzi(this.qaj(b,c));if(!h||!h.length)return null;c=h.length;const m=Array(c);let y=0,G=1;for(let U=0;U<b.Ra.length;U++)G<
c&&b.Ra.ga(U).cp===h[G]&&(m[y]=a[U],y++,G++);m[c-1]=a[a.length-1];if(G!==c)return Ba.a.J(512496908,820,50,"indexOfLineStartCp and countOfLine( TextLayout property) do not match"),null;a=Array(c);a[0]=m[0];for(b=1;b<c;b++)a[b]=m[b]-m[b-1];return a}Hzi(a){a=a?a.Lines:null;if(!a||!a.length)return a;const b=Array(a.length);b[0]=0;for(let c=1;c<a.length;c++)b[c]=b[c-1]+a[c-1];return b}yKi(a,b){if(!b)return!1;a=a.childNodes;let c=0;for(const h of b){b=!0;for(let m=c;m<h+c&&m<a.length;m++)Sys.UI.DomElement.containsCssClass(a[m],
wb.a.hN)||Sys.UI.DomElement.containsCssClass(a[m],wb.a.E_d)||(b=!1);if(b)return!0;c+=h}return!1}vZf(a,b,c){const h=new Jb.a;if(!a||!b||!c)return Ba.a.J(512496907,826,15,"GetCustomAttributes: htmlViewInstance={0}, paragraphNode={1}, formattingCache={2}.",a?"not null":"null",b?"not null":"null",c?"not null":"null"),h;this.vbl(a,b)&&(a=null,c.Sa(X.a.schemeColor)&&(a=c.eb(X.a.schemeColor),a=this.Ecj(b,a)),ta.a.Wa(a)||h.$("data-scheme-color",a),this.e6c&&c.Sa(X.a.YXc)&&(c.eb(X.a.YXc)?h.$("data-usefontface",
"false"):h.$("data-usefontface","true")));return h}Ecj(a,b){if(ta.a.Wa(b))return"";const c=ao.SchemeColor.parse(b);if(c&&c.color&&!c.zta){a=Object(ua.a)(115,this.jc.mg(a));a=c.resolve(a?a.Ne:null);if(!a)return"";c.WP=Cj.g(a.f_a);return c.toString()}return b}vbl(a,b){return this.Adc&&a.Vl&&Kj.BTj(b)}mFf(a){if(this.Had){a=a.querySelectorAll("."+Kj.DXd);const c=a.length,h=Array(c);for(var b=0;b<c;++b)h[b]=this.SVk(a[b]);for(b=0;b<c;++b)Td.a.FEj(a[b],h[b].Ygi,h[b].ahi,h[b].Zgi,h[b].$gi)}}QVk(a){return new on("linear-gradient(to right, "+
Td.a.wJc+", "+Td.a.wJc+")",Td.a.HYe,"0px "+a.style.verticalAlign,Td.a.tqd)}cHj(a){for(a=a.firstChild;a;){if(!Sys.UI.DomElement.containsCssClass(a,wb.a.R7))return!1;a=a.nextSibling}return!0}RVk(a){let b=Number.MAX_VALUE,c=0,h=0;const m=a.querySelectorAll("span."+wb.a.R7);for(let y=0;y<m.length;y++){const G=m[y];h+=this.F7i(G);b=Math.min(b,G.offsetLeft);c=Math.max(c,G.offsetLeft+G.offsetWidth)}return new on("linear-gradient(to right, "+Td.a.wJc+", "+Td.a.wJc+")",0<c-a.offsetLeft?h+"px 100%":Td.a.HYe,
b-a.offsetLeft+"px "+a.style.verticalAlign,Td.a.tqd)}SVk(a){return this.cHj(a)?this.QVk(a):this.RVk(a)}F7i(a){let b=0;if((a=a.getClientRects())&&0<a.length)for(const c of a)b+=c.width;return b}wZf(a,b,c){return this.dA&&a&&b&&c&&(Object(za.a)(526,a)||Object(za.a)(526,this.IC.Rd)&&a.Vl)?Wf.BHc(b):null}guh(){return!1}O4b(a){let b=a.sa(X.a.latinFont,lf.Font.QS);b.startsWith("+")&&(b=a.sa(kb.a.font,lf.Font.QS));let c=new Qa.a;c.add(b);var h=[X.a.eastAsianFont,X.a.complexScriptFont,X.a.$Mb];for(var m of h)a.Sa(m)&&
(h=a.eb(m),!h||h.startsWith("+")||c.contains(h)||c.add(h));if(a=this.phj(b))m=new Qa.a,m.add(b),Rd.a("UseServerFallbackFontFirst")?m.insert(0,a):m.add(a),this.l2j(a,c),c=m;return c.toArray().join(",")}l2j(a,b){this.wxg||ka.FontUtils.isMissingFont(b.ga(0))?this.xxg||b.contains(a)||(Ba.a.J(512496905,820,15,"Server fallback font mismatches browser fallback(s)."),this.xxg=!0):(Ba.a.J(512496906,820,15,"Browser-used font available, but server-provided fallback mismatches."),this.wxg=!0)}kLe(a,b){if(a){var c=
a.indexOf(",");0<c&&(a=a.substring(0,c))}c=!!this.zC&&this.zC.isEnabled;const h=!!this.Zy&&this.Zy.isEnabled;if(h||c||this.Pla)b=ka.FontUtils.Eqb(b,a,c,this.Pla,h);h&&this.Zy.createFontUrl(a);c&&(this.Xcf&&a?(c=Kj.N_f(a),this.zC.createFontUrl(a),c&&this.zC.createFontUrl(c)):this.zC.createFontUrl(a));this.Pla&&this.xX.createFontUrl(a);return b}dch(a,b){return a?this.kLe(a.fontName,b):b}lYc(){return this.Pla}static J5d(a){if(ta.a.Wa(a))return null;const b=a.indexOf(",");-1<b&&(a=a.substring(0,b).trim());
return a}static N_f(a){if(ta.a.Wa(a))return null;a=Kj.J5d(a);let b=a.toLowerCase();for(;b;){let c=!1;b=b.trim();for(const h of Kj.cZi){let m=h;b.endsWith("\u200b")&&(m+="\u200b");b.endsWith(m)&&(c=!0,b=b.substring(0,b.lastIndexOf(m)+1))}if(!c)break}return a.substring(0,b.length)}static BTj(a){return a.sa(X.a.hFa,!1)?!1:!0}}Kj.DXd="Selection";Kj.uJf="SelectionShadow";Kj.cZi=" bold; italic; demibold; extrablack; extrabold; extralight; heavy; light; medium; regular; semibold; thin".split(";");Kj.zxg=
!1;Kj.yxg=!1;Object(n.a)(Kj,"TextRenderingStrategy",null,[1377]);class uo{constructor(){this.vxb=[]}nOe(a){a&&!Array.contains(this.vxb,a)&&(a.r_=this,Array.add(this.vxb,a))}Bjc(a,b){for(let c=0;c<this.vxb.length;c++){const h=this.vxb[c];h.wxb&&h.Bjc(a,b)}}}Object(n.a)(uo,"AHighlightManager",null,[1374]);class co extends uo{constructor(){super();this.TDg=this.Nbc=null}get aja(){return this.Nbc}get jbb(){return this.TDg}ond(a){if(a&&((this.Nbc=a)&&0===this.Nbc.action&&(this.TDg=this.Nbc),a.jda||a.rhb)){var b=
[];for(let c=0;c<this.vxb.length;c++){const h=this.vxb[c];h.wxb&&Array.addRange(b,h.qCh(a.jda,a.rhb))}}}}Object(n.a)(co,"HighlightManager",uo,[]);class Ml{constructor(a,b){this.Hva=a;this.ncc=b;this.Hva.ik(Object(F.a)(this,this.hh,"onPropertyChanged"))}dispose(){this.Hva.Cm(Object(F.a)(this,this.hh,"onPropertyChanged"))}hh(a,b){a=b.node;b.property.id===X.a.oNb.id&&a.isConnected&&!this.ncc.isComposing&&a.anchor.Ar(208)}}Object(n.a)(Ml,"ParagraphNodeViewBehavior",null,[106]);class Jm{constructor(a){this.ncc=
a}Zth(a){if(a=Object(ua.a)(5,a)){if(this.ncc.isComposing){if(!a.s_c)return Ba.a.J(22586562,822,50,"Skip paragraph view validation because CEV is in IME composing"),!0;Ba.a.J(22586564,822,50,"invalidate paragraph view element because text changed in new revision")}a.s_c=!1}return!1}}Object(n.a)(Jm,"ParagraphViewElementCEVSetUpdateStrategy",null,[1396]);class Cn{constructor(a){this.d8c=[X.a.gX,X.a.ox,X.a.Kda,X.a.Xka,X.a.Jda,X.a.Wka,jb.a.Zl,jb.a.pY,jb.a.$n,jb.a.WGb,jb.a.listLevel,kb.a.Il,kb.a.XI];this.mXh=
a.uje;this.NYc=a.NYc;this.lXh=a.pptCopyPasteMarginAndIndentationEnabled}get jgd(){return this.mXh}get Zzi(){return!1}get i9g(){return this.lXh}get Rwk(){return this.d8c}Cdl(a){return!!a.tagName&&"p"===ta.a.og(a.tagName)&&Sys.UI.DomElement.containsCssClass(a,wb.a.mfa)}nta(a){const b={};for(const c of this.d8c)b[c.id.toString()]=a.Lh(c);return b}qoa(a,b){if(b){const c=Ob.ParagraphReader.VW(a);this.r8k(a,b,this.d8c,this.Dig(a),c);a.setValue(xc.a.F9b,!0)}}Dig(a){let b=!1;(a=rb.GraphIterator.nb(a).parentNode)&&
Kd.OutlineElementReader.Z8(a)&&(b=Wb.ListReader.oUa(a));return b}ahk(a,b,c,h){this.i9g||(h=!0);if(this.jgd){const m=a.sa(xc.a.F9b,!1),y=b.sa(xc.a.F9b,!1),G=m||!h&&!y&&!m?b:a;this.cAi(G,m||!h&&!y&&!m?a:b,this.d8c,this.Dig(G),c)}}Mkj(a){return this.i9g&&a?Ob.ParagraphReader.VW(a)&&a.Sa(X.a.Jhe)&&!a.eb(X.a.Jhe)&&a.Sa(jb.a.$n)?a.eb(jb.a.$n).toString():"":""}r8k(a,b,c,h,m){for(const y of c)this.Xth(y,h,m)||(c=b[y.id.toString()],void 0!==c?a.setValue(y,c):a.removeProperty(y))}cAi(a,b,c,h,m){for(const y of c)this.Xth(y,
h,m)||(c=b.Lh(y),void 0!==c?a.te(y,c):a.removeProperty(y))}Xth(a,b,c){return this.NYc&&!b&&c&&(a===jb.a.Zl||a===jb.a.$n)}}Object(n.a)(Cn,"PptFormattingPropertyTransitStrategy",null,[1395]);class Zk{}Zk.BEh="UnderlineColor";Zk.Wsd="UnderlinePositionInEm";Zk.Xsd="UnderlineThicknessInEm";Zk.BPc="FontSizePx";Object(n.a)(Zk,"ParagraphViewElementProperties",null,[]);class Km extends Oc{constructor(a,b,c,h,m,y,G,U,ja,va,Ta,fb,Db,gc,hc,Gc,Pc,yc,Vd,De,Wd,Ve,$e){super(a,b,c,h,m,y,G,U,ja,va,Ta,fb,Db,gc,hc,Gc);
this.Gac=Pc;this.UCg=yc;this.uAg=Vd&&!Wd;this.Had=De&&!Wd;this.VCg=Ve;this.n$c=$e}NOd(a,b){this.Gac?a.style&&!ta.a.Wa(a.style.verticalAlign)&&(ta.a.Wa(b.style.verticalAlign)?(b.style.verticalAlign=a.style.verticalAlign.startsWith("-")?a.style.verticalAlign.substring(1,a.style.verticalAlign.length):"-"+a.style.verticalAlign,this.gbi(a)):a.style.verticalAlign="",b.style.lineHeight="0px"):super.NOd(a,b)}gbi(a){if(null!==a.style&&!ta.a.Wa(a.style.verticalAlign)){if(this.UCg&&this.EMj(a)){const b=a.style.backgroundColor;
a.style.backgroundColor=null;Td.a.wuf(a,String.format("linear-gradient(to right, {0}, {0})",b),Td.a.HYe,String.format("0px {0}",a.style.verticalAlign),Td.a.tqd)}if(this.Had||this.UCg)a.style.verticalAlign.startsWith("-")?a.style.paddingTop=a.style.verticalAlign.substring(1,a.style.verticalAlign.length):a.style.paddingBottom=a.style.verticalAlign}}q5d(a){return this.Gac?"0px":super.q5d(a)}Ctf(a){a.style.position=Td.a.prc}EMj(a){return Sys.UI.DomElement.containsCssClass(a,"Highlight")&&null!==a.style&&
a.style.backgroundColor!==Td.a.lui}KPe(a,b,c,h){if(this.uAg&&b.Zs){if(b.KF||b.w_)a.style.textDecoration=Td.a.hml,h[h.length]="Strikethrough";b.dE&&(h[h.length]="Underlined");let m,y;this.n$c&&({Wsd:m,Xsd:y}=this.Olj(b.zN)).returnValue?(Y.a.Lv(a,Zk.BEh,this.Nlj(c,b)),Y.a.Lv(a,Zk.Wsd,m),Y.a.Lv(a,Zk.Xsd,y)):ta.a.Wa(a.style.textDecoration)?a.style.textDecoration=Td.a.xyh:a.style.textDecoration+=" "+Td.a.xyh}else super.KPe(a,b,c,h)}Nlj(a,b){a=this.Wv.Q5d(a,b,!1,!0);return String.format("linear-gradient(to right, {0}, {0})",
a)}Olj(a){return{returnValue:"Calibri"===a,Wsd:1.1133,Xsd:.0654}}NIj(a,b){if(!a||!b)return!1;for(a=a.firstChild;a;){if(Sys.UI.DomElement.containsCssClass(a,wb.a.R7))return!0;a=a.nextSibling}return!1}Btf(a,b){this.Had&&(Sys.UI.DomElement.containsCssClass(b,wb.a.R7)||this.NIj(a,wb.a.R7)?(Sys.UI.DomElement.addCssClass(a,Kj.DXd),this.VCg&&v.a.Uj&&Sys.UI.DomElement.addCssClass(a,Kj.uJf)):(Sys.UI.DomElement.removeCssClass(a,Kj.DXd),this.VCg&&v.a.Uj&&Sys.UI.DomElement.removeCssClass(a,Kj.uJf)));if(this.uAg&&
Sys.UI.DomElement.containsCssClass(a.parentNode,wb.a.zag)){const c=Y.a.ye(a,Zk.BEh),h=Y.a.ye(a,Zk.Xsd);let m=Y.a.ye(a,Zk.Wsd);if(c&&h&&m){if(!ta.a.Wa(a.style.fontSize)&&a.style.fontSize.endsWith("px")&&!ta.a.Wa(b.style.verticalAlign)&&b.style.verticalAlign.endsWith("px")){a=parseFloat(a.style.fontSize);const y=parseFloat(b.style.verticalAlign);isNaN(a)||!a||isNaN(y)||(m-=y/a)}Td.a.wuf(b,c,String.format("100% {0}em",h),String.format("0% {0}em",m),Td.a.tqd);b.style.textDecoration=Td.a.iml}}}}Object(n.a)(Km,
"PptParagraphContentRenderer",Oc,[]);class kl{constructor(){this.K=null}get name(){return"PowerPointWebEditor.Paragraph"}$b(a){this.K=a;this.pOe();this.wOe();this.cQk();this.sOe();this.jQk();this.kQk();this.bQk()}init(){this.K.register(1374,"Box4.Highlight.IHighlightManager").ma().oa(()=>new co);this.K.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementFactoryHelper").extend(393230,new Ke.a((a,b)=>new Ug(a,b,this.K.resolve("Box4.IListMarkerUtility"),this.K.resolve("PowerPointWebEditor.PptParagraphContentRenderer"),
new Hc.a(a,b),this.K.resolve("Box4.IParagraphViewIndentationStrategy"),()=>null,()=>null,a.Vl&&u.AFrameworkApplication.fa.ka("SkipUpdateContentEditableViewWhenComposing")?this.K.resolve("PowerPointWebEditor.Paragraph.ParagraphViewElementCEVSetUpdateStrategy"):this.K.resolve("Box4.DefaultParagraphViewElementSetUpdateStrategy"),this.K.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,this.K.resolve("Box4.Highlight.IHighlightManagerFactory").instance,this.K.resolve("Box4.ITextRenderingStrategy"),
this.K.resolve("Box4.IParagraphOverlayControlRenderer"))));this.K.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementFactoryHelper").extend(393234,new Ke.a((a,b)=>new Ah(a,b,this.K.resolve("Box4.IListMarkerUtility"),this.K.resolve("Box4.List.IListReader"),this.K.resolve("Box4.IParagraphViewIndentationStrategy"),this.K.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)));this.K.resolve("PowerPointWebEditor.ParagraphNodeViewBehavior")}dispose(){this.K.resolve("PowerPointWebEditor.ParagraphNodeViewBehavior").dispose()}pOe(){this.K.register(1375,
"PowerPointWebEditor.IListMarkerOffsetCache").ma().oa(()=>new Kh);this.K.register(1376,"Box4.IListMarkerUtility").ma().oa(()=>new mn(this.K.resolve("Box4.List.IListReader"),this.K.resolve("Box4.IParagraphIndentationReader"),ec.a.instance,this.K.resolve("PowerPointWebEditor.IListMarkerOffsetCache"),this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("PowerPointWebEditor.Graph.INotesReader"),this.K.resolve("PowerPointWebEditor.Graph.ISmartArtReader"),this.K.resolve("Box4.Graph.IGraphIteratorFactory"),
this.K.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementUtility"),this.K.resolve("PowerPointWebEditor.IPPTParagraphReader"),this.K.resolve("PowerPointWebEditor.IPptListEditor"),this.K.resolve("PowerPointWebEditor.IPptListCore"),this.K.resolve("Box4.IInteractiveViewManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptRenderListBulletStyleInBox4Enabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").Dab,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptCopyPasteListMarkerEnabled,
this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptCopyPasteMarginAndIndentationEnabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointEditSmartArtTextPaneIsEnabled))}wOe(){this.K.register(1377,"Box4.ITextRenderingStrategy").ma().oa(()=>new Kj(this.K.resolve("Box4.IInteractiveViewManager"),this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.resolve("PowerPointWebEditor.IBox4ColorHelper"),this.K.resolve("Common.IBrowserUtils"),
this.K.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementUtility"),this.K.resolve("PowerPointWebEditor.IPPTParagraphReader"),this.K.rb("Box4.CloudFontService"),this.K.rb("Box4.CustomFontService"),this.K.resolve("PowerPointWebEditor.Fonts.IEmbeddedFontsManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").Aeg,this.K.resolve("PowerPointWebEditor.IApplicationSettings").Xig,this.K.resolve("PowerPointWebEditor.IApplicationSettings").Uig,this.K.resolve("PowerPointWebEditor.IApplicationSettings").Dab,
this.K.resolve("PowerPointWebEditor.IApplicationSettings").pNb,this.K.resolve("PowerPointWebEditor.IApplicationSettings").LAh,this.K.resolve("PowerPointWebEditor.IApplicationSettings").DZc,this.K.resolve("PowerPointWebEditor.IApplicationSettings").Wig,this.K.resolve("Common.Utils.IHighContrastDetector").isInHighContrastMode,this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointEditSmartArtTextPaneIsEnabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").podsHtmlTextForEmbeddedFontsIsEnabled,
this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptCopyPasteFontFamilyEnabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").QLj,this.K.resolve("PowerPointWebEditor.IApplicationSettings").zpl,this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").K3k))}cQk(){this.K.register(jf,"Box4.DefaultParagraphViewElementSetUpdateStrategy").ma();this.K.register(Jm,"PowerPointWebEditor.Paragraph.ParagraphViewElementCEVSetUpdateStrategy").ma().oa(()=>
new Jm(this.K.resolve("Box4.IEditingView")))}sOe(){this.K.register(Im,"PowerPointWebEditor.ParagraphViewIndentationStrategy").as("Box4.IParagraphViewIndentationStrategy").ma().oa(()=>new Im(this.K.resolve("Box4.IListMarkerUtility"),this.K.resolve("Box4.IParagraphIndentationReader"),this.K.resolve("Box4.IParagraphReader"),this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.IPptListEditor"),new We.a))}jQk(){this.K.register(Cn,"PowerPointWebEditor.Paragraph.PptFormattingPropertyTransitStrategy").as("Box4.IFormattingPropertyTransitStrategy").ma().oa(()=>
new Cn(this.K.resolve("PowerPointWebEditor.IApplicationSettings")))}kQk(){this.K.register(Km,"PowerPointWebEditor.PptParagraphContentRenderer").as("Box4.IParagraphContentRenderer").ma().oa(()=>new Km(na.InteractiveViewManager.instance,ha.a.instance,this.K.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,this.K.resolve("Box4.IFormattingPropertyTransitStrategy"),this.K.resolve("Box4.Proofing.IProofingFeatureConfiguration"),this.K.rb("Box4.Proofing.IIgnoreAllKeywords"),this.K.resolve("Box4.ITextRenderingStrategy"),
this.K.resolve("Box4.ParagraphContentRendererSettings"),this.K.resolve("Box4.ILineSpacingHelper"),this.K.rb("Box4.IFeatureHelper"),ka.FontUtils.kzi,this.K.rb("Box4.IFontSlotProvider"),Object(F.a)(this.K.resolve("Box4.IEditStateEventManager"),this.K.resolve("Box4.IEditStateEventManager").Ldh,"raiseParagraphContentUpdatedEvent"),uc.a.language,this.K.rb("Box4.ITableOfContentRenderHelper"),Ab.a.qyf,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptEditorDifferentLineHeightEnabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").Xig,
this.K.resolve("PowerPointWebEditor.IApplicationSettings").Uig,this.K.resolve("PowerPointWebEditor.IApplicationSettings").Wig,this.K.resolve("Common.Utils.IHighContrastDetector").isInHighContrastMode,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptTextSelectionShadowFixIsEnabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").lcl))}bQk(){this.K.register(Ml,"PowerPointWebEditor.ParagraphNodeViewBehavior").ma().oa(()=>new Ml(this.K.resolve("Box4.Graph.IGraphInstance").Ad(12),
this.K.resolve("Box4.IEditingView")))}static main(){r.a.instance.Dc(new kl)}}Object(n.a)(kl,"PPTWebEditorParagraphPackage",null,[2,3]);var Eh=d(104),mk=d(492),eo=d(617);class fo extends Sys.EventArgs{constructor(a){super();this.Kk=a}}Object(n.a)(fo,"PopSessionClosedEventArgs",Sys.EventArgs,[]);class Dj{constructor(a,b,c,h,m,y,G,U,ja,va,Ta,fb,Db,gc,hc,Gc,Pc,yc,Vd){this.oxe=this.Nva=null;this.Ce=a;this.tw=b;this.Qd=c;this.mc=h;this.la=m;this.yhc=y;this.t8c=G;this.fy=U;this.Ze=ja;this.Dea=va;this.pa=
Ta;this.ff=fb;this.ua=Db;this.ia=gc;this.zb=hc;this.z9=Gc;this.Qo=yc;this.BC=Vd;G.kOd(Object(F.a)(this,this.zGb,"onPodSessionUnavailable"));G.Fqb(Object(F.a)(this,this.gfa,"onPodSessionRefreshed"));Pc.WB(Object(F.a)(this,this.Bo,"onSessionRehydrated"));this.dye=new He.a(4,2,2E3,Object(F.a)(this,this.detectFailoverTimeout,"detectFailoverTimeout"),90,"18")}get isEnabled(){return this.la.wg}get K9b(){return!!this.Nva}dej(a,b){const c=Nc.a.Ik("GetPodSessionInfo");try{const h=this.Ce.podSessionId,m=Eh.a.create().toString(),
y=String.format("{0}PodHandler.ashx?action=GetPodSessionInfo",this.la.podsWebServiceBase),G={};G.PodSID=h;G["X-UserSessionId"]=this.yhc();G["X-CorrelationID"]=m;c.Va("PodSessionId",h);c.Va("Cid",m);this.tw.YV(y,2,null,G,[ca.a.v5],0,U=>{try{if(h!==this.Ce.podSessionId)c.Va("ExpectedPodSessionId",h),c.Va("ActualPodSessionId",this.Ce.podSessionId),c.Va("Result","PodSessionIdUnexpected"),c.finish(!0),a&&a();else{var ja=!0;if(U.data){if(c.Va("HttpStatus",U.data.Te.toString()),c.Va("RequestStatus",mk.a[U.data.status]),
U.data.rj){const va=U.data.rj[ca.a.v5];va&&"errorCannotFindSession"===va&&(c.Va("ErrorCode",va),ja=!1)}}else c.Va("HttpStatus","UNKNOWN"),c.Va("RequestStatus","UNKNOWN");ja?(c.Va("Result","Succeeded"),c.finish(),a&&a()):(c.Va("Result","Failed"),c.finish(!0),b&&b())}}catch(va){Ba.a.J(512496143,801,10,"PodSessionManager::GetPodSessionInfo - Exception: {0}",va),b&&b()}},U=>{try{if(h!==this.Ce.podSessionId)c.Va("ExpectedPodSessionId",h),c.Va("ActualPodSessionId",this.Ce.podSessionId),c.Va("Result","PodSessionIdUnexpected"),
c.finish(!0),a&&a();else{if(U.data){if(c.Va("HttpStatus",U.data.Te.toString()),c.Va("RequestStatus",mk.a[U.data.status]),U.data.rj){const ja=U.data.rj[ca.a.v5];ja&&c.Va("ErrorCode",ja)}}else c.Va("HttpStatus","UNKNOWN"),c.Va("RequestStatus","UNKNOWN");c.Va("Result","Failed");c.finish(!0);b&&b()}}catch(ja){Ba.a.J(512496142,801,10,"PodSessionManager::GetPodSessionInfo - Exception: {0}",ja),b&&b()}},null,void 0,void 0,this.la.fej,this.la.gej,"GetPodSessionInfo",void 0,!0)}catch(h){Ba.a.J(512496141,801,
10,"PodSessionManager::GetPodSessionInfo - Exception: {0}",h),c.Va("Result","Failed"),c.finish(!0),b&&b()}}zGb(a,b){a=!1;this.Nva?Ba.a.J(512496140,801,15,"PodSessionManager::OnPodSessionUnavailable - Already unavailable. PresentationId:{0}; IsBootCompleted:{1}; PopSessionInitialized:{2}; PopSessionId:{3}; PodSessionId:{4}; ReadOnly mode:{5}; PodsUnavailableStartTime:{6}; PodSeamlessRehydrationManager:{7}; FPodsOrderlyShutdown:{8}",this.Ce.presentationId.string,this.fy.uka,this.Ze.pA,this.Ce.Kk,this.Ce.podSessionId,
!this.mc.Fn,Nc.a.nf(this.Nva),!!this.Qo.instance,b.wOc):(this.Nva=new Date,a=!0,Ba.a.J(512496139,801,15,"PodSessionManager::OnPodSessionUnavailable - Unavailable is detected. PresentationId:{0}; IsBootCompleted:{1}; PopSessionInitialized:{2}; PopSessionId:{3}; PodSessionId:{4}; ReadOnly mode:{5}; PodsUnavailableStartTime:{6}; PodSeamlessRehydrationManager:{7}; FPodsOrderlyShutdown:{8}",this.Ce.presentationId.string,this.fy.uka,this.Ze.pA,this.Ce.Kk,this.Ce.podSessionId,!this.mc.Fn,Nc.a.nf(this.Nva),
!!this.Qo.instance,b.wOc));this.z9.instance&&this.z9.instance.dZc?Ba.a.J(512496138,801,15,"PodSessionManager::OnPodSessionUnavailable - IsNonDismissibleDialogShown is TRUE, ignore Pods unavailable signal. PopSessionId:{0}; PodSessionId:{1}",this.Ce.Kk,this.Ce.podSessionId):this.fy.uka&&this.la.podsSeamlessFailoverEnabled&&this.Qo.instance?this.Qo.instance.N0e(b.wOc,4,b.errorCode):(this.Qd.hka=!1,this.fy.uka?this.Ze.pA?(a&&this.zb.Eb(this.dye),this.Dea.FSc(this.Ce.presentationId.string,this.Ce.Kk,
this.Ce.podSessionId,b.wOc,c=>{this.mZk(c,this.Ce.Kk)},c=>{this.lZk(c,this.Ce.Kk)}),this.pa.setSelection(null),this.ff.blockContent(this.ua.presentation,"OnPodSessionUnavailable",!0),Ba.a.J(512496136,817,15,"PodSessionManager::OnPodSessionUnavailable, Block Presentation")):this.nsj():Ba.a.J(512496137,801,15,"PodSessionManager::OnPodSessionUnavailable - Skip since session is not ready. PodSessionId:{0}",this.Ce.podSessionId))}nsj(){this.oxe||(this.oxe=new Date);const a=+new Date-+this.oxe;a>this.la.podsNullSrmWaitTimeInMs?
(Ba.a.J(512496135,801,15,"PodSessionManager::OnPodSessionUnavailable - Already wait {0}ms, won't wait anymore. PodSessionId:{1}",a,this.Ce.podSessionId),u.AFrameworkApplication.xp(qf.a.Uh(305)),Mf.Health.instance.recordQosError("ErrorCannotFailoverRehydration",["UnexpectedAppRefresh"],!1,!1,!0,!0,null),this.ia.La(M.a.refresh,2,{refreshtrigger:"PodSessionManager::HandleNullPodFailoverManager"})):Ba.a.J(512496134,801,15,"PodSessionManager::OnPodSessionUnavailable - Skip since PodFailoverManager is not ready. MaxWaitTime:{0}ms; ElapsedTime:{1}ms. PodSessionId:{2}",
this.la.podsNullSrmWaitTimeInMs,a,this.Ce.podSessionId)}detectFailoverTimeout(){if(this.Nva){var a=+new Date-+this.Nva;a>this.la.podsFailoverBrowserWaitTimeoutInMs&&(this.zb.Rg(this.dye),Ba.a.J(512496133,801,15,"PodSessionManager::DetectFailoverTimeout - Won't wait for failover any longer. ElapsedTimeInMs:{0}, PodSessionId:{1}, PopSessionId:{2}",a,this.Ce.podSessionId,this.Ce.Kk),a=Object.assign(new jl.a,{Code:293,Source:6}),this.Qd.us(a,this.Ce.podSessionId,b=>{b.$B=1;b.cCa=8;return!1}))}}mZk(a,
b){a&&(this.Ce.Kk!==b?Ba.a.J(512496132,801,15,"PodSessionManager::RetrievePODSInfoSucceeded - Ignore failure since PopSessionId is changed. CurrentPopSession:{0}; RequestPopSession:{1}; PodSessionId:{2}",this.Ce.Kk,b,this.Ce.podSessionId):(b=a.result)?(Ba.a.J(512496131,817,50,"PodSessionManager::RetrievePODSInfoSucceeded - OldPodSessionId:{0}; NewPodSessionId:{1};",this.Ce.podSessionId,b.DocumentSessionID),this.Ce.podSessionId!==b.DocumentSessionID&&(a=this.Ce.podSessionId,this.Ce.podSessionId=b.DocumentSessionID,
this.t8c.Ndh(new eo.a(a,b.DocumentSessionID)))):Ba.a.J(512496130,801,10,"Return type: {0}. PodSessionId:{1}, PopSessionId:{2}",a.result?Object.getType(a.result):null,this.Ce.podSessionId,this.Ce.Kk))}lZk(a,b){if(this.Ce.Kk!==b)Ba.a.J(512496129,801,15,"PodSessionManager::RetrievePODSInfoFailed - Ignore failure since PopSessionId is changed. CurrentPopSession:{0}; RequestPopSession:{1}; PodSessionId:{2}",this.Ce.Kk,b,this.Ce.podSessionId);else{b=316;var c=-1;a&&a.error&&(b=qf.a.nN(a.error.Xm),c=a.error.Xm);
Ba.a.J(512496128,801,15,"PodSessionManager::RetrievePODSInfoFailed - PresentationId:{0}; PopSessionId:{1}; OldDocumentSessionID:{2}; NewDocumentSessionID:{3}; ResponseRecievedTime:{4}; BSQMErrorCode:{5}; ServerErrorCode:{6}",this.Ce.presentationId.string,this.Ce.Kk,this.Ce.podSessionId,"",Nc.a.nf(new Date),c,b);c===qf.a.Uh(241)&&(this.Ze.pA=!1,this.Ze.xga&&this.BC.lNe(new fo(this.Ze.Hda)))}}gfa(a,b){Nc.a.cAb=new Date;Nc.a.Ird=[];this.Ce.podSessionId!==b.eY?Ba.a.J(512496099,801,15,"PodSessionManager::OnPodSessionRefreshed - PodSessionId should not change when we get the event! ExpectedPodSessionId:{0}; NewPodSessionId:{1}; PopSessionId:{2}",
this.Ce.podSessionId,b.eY,this.Ce.Kk):(this.zb.Rg(this.dye),Ba.a.J(512496098,801,15,"PodSessionManager::OnPodSessionRefreshed - PresentationId:{0}; PopSessionId:{1}; OldDocumentSessionID:{2}; NewDocumentSessionID:{3}; PodsUnavailableStartTime:{4}; PodsRefreshedTime:{5}",this.Ce.presentationId.string,this.Ce.Kk,b.hGb,b.eY,Nc.a.nf(this.Nva||new Date),Nc.a.nf(new Date)),this.Qd.hka=!1,this.la.podsSeamlessFailoverEnabled&&this.Qo.instance?Ba.a.J(512496097,801,15,"PodSessionManager::OnPodSessionRefreshed - Skip refresh Doc since seamless failover is on."):
(a={failedMachineId:null,isPlanedShutdown:!1,isPodSessionRefreshed:!0},a.podSessionId=b.eY,this.ia.La(M.a.hJb,2,a)),this.Nva=null)}Bo(){this.Nva=null}}Object(n.a)(Dj,"PodSessionManager",null,[1369]);var Vm;(function(a){a[a.active=0]="active";a[a.passive=1]="passive";a[a.hidden=2]="hidden";a[a.frozen=3]="frozen"})(Vm||(Vm={}));Object(n.b)("AppVisibilityState",Vm);class Ki{constructor(){this.IsTabHidden=!1;this.PresentationID=this.PopSessionID=null}}Object(n.a)(Ki,"GetHostSessionInfoParams",null,[]);
class ek{constructor(a,b,c,h,m,y,G,U,ja,va){this.w9c=0;this.cHa=this.Ula=this.Zye=null;this.RRg=0;this.BBe=!1;this.Xa=b;this.DDb=a;this.Ze=c;this.la=h;this.z9=m;this.BO=y;this.Cea=G;this.mc=U;this.vO=ja;this.Bwa=va;this.$Ab=0;this.yDb=this.la.getHostSessionInfoRequestTimeoutInMs;this.Y$j=this.la.getHostSessionInfoRequestMaxTimeoutInMs;this.cak=this.la.getHostSessionInfoPingIntervalForFailedResponseInMs;this.N4j=h.maxPopsRehydrationCount;this.FDb=this.la.z$g;this.EDb=this.la.podsPopSessionDisconnectedTimeLimitInMS;
this.nla=!1;this.QCb=this.Xa.Kk;this.ADg="";this.Lkd();this.lKa(0,!0)}Lkd(){this.w9c=0;this.cHa=new Date}Ani(a){if(this.xka&&!u.AFrameworkApplication.Tg&&this.mc.rL){var b=!1;this.Bwa&&this.Bwa.instance&&(b=2===this.Bwa.instance.R5a,this.BBe||(this.BBe=!0,this.Bwa.instance.TFc(Object(F.a)(this,this.FIh,"visiblityChanged"))));var c=Object.assign(new Ki,{PopSessionID:this.Xa.Kk,PresentationID:this.Xa.presentationId.string,IsTabHidden:b});this.Zye=new Date;b=Math.min(this.yDb+2E3*this.w9c,this.Y$j);
var h=Da.a.JH("RequestTimeout",b.toString());this.DDb.VRc(c,()=>{this.Sok(c.PopSessionID,a)},m=>{this.Rok(m,c.PopSessionID,a)},null,h,this.la.getHostSessionInfoRequestTimeoutInMs,b+2E3)}else this.mc.rL&&(Ba.a.J(24655577,801,50,"HostSessionInfoCaller::CallGetHostSessionInfo - Skipped. IsClientActive:{0}; IsShuttingDown:{1}; IsNonDismissibleDialogShown:{2}; AppInReadMode:{3};",this.xka,u.AFrameworkApplication.Tg,!!this.z9.instance&&this.z9.instance.dZc,!this.mc.Fn),this.close(this.xka?this.mc.rL?"AppShuttingDown":
"TransitionedToReadingMode":"ClientDisabled"))}lKa(a,b){this.Ula=new Date;this.RRg=window.setTimeout(()=>{this.Ani(b)},a)}KAl(a){Ba.a.J(24655581,801,50,"HostSessionInfoCaller::OnGetHostSessionInfoSucceeded - popSessionId:{0}, TimeTakenInMs:{1}",a,+new Date-+this.Zye);this.Lkd();this.$Ab=0;this.Ze.Vle=this.cHa;this.Ze.Ule=a}Sok(a,b){this.vO.Vnc();this.BO.wSf(a,"HostSessionInfoCaller::OnGetHostSessionInfoSucceeded")?this.lKa(0,b):(this.KAl(a),b&&this.lKa(this.la.getHostSessionInfoPingIntervalInMs,!0))}FIh(a,
b){Ba.a.J(592852376,801,50,"HostSessionInfoCaller.VisiblityChanged - Old:{0},  New:{1} ",Vm[b.oldState],Vm[b.newState]);this.lKa(0,!1)}hoi(){return this.Cea.K9b||!this.xka?(Ba.a.J(36320459,801,15,"HostSessionInfoCaller.CanRehydrateHostSession - Skip POPS Rehydration. IsPodSessionUnavailable:{0}; IsClientActive:{1}; Now:{2}",this.Cea.K9b,this.xka,Nc.a.nf(new Date)),!1):this.$Ab>this.N4j?(Ba.a.J(36996355,801,10,"HostSessionInfoCaller::CanRehydrateHostSession: Skip POPS rehydration, abort the ping client and raise an ACE error because we exceeded max rehydration threshold. Total number of POPS created so far:{0}; Max Allowed:{1};",
this.$Ab,this.la.maxPopsRehydrationCount),this.close("POPSRehydrationThresholdReached"),this.BO.S$d(qf.a.Uh(328),"HostSessionInfoCaller::CanRehydrateHostSession"),!1):!0}Bfa(a){this.hoi()&&(++this.$Ab,this.BO.Bfa(a),this.Lkd())}kdl(a){if(qf.a.vT(a))switch(qf.a.nN(a)){case 326:case 240:case 103:return!0;case 329:return this.la.TQk}return!1}S7i(a){if(qf.a.vT(a))switch(qf.a.nN(a)){case 326:return 10;case 240:return 1;case 103:return 12;case 329:return 13;default:return 14}else return 14}Rok(a,b,c){a.yY&&
200===a.yY.Te&&this.vO.Vnc();if(this.BO.wSf(b,"HostSessionInfoCaller::OnGetHostSessionInfoFailed"))this.lKa(0,c);else{++this.w9c;var h=+new Date-+this.cHa,m=44,y=-1;a&&a.error&&(m=qf.a.vT(a.error.Xm)?qf.a.nN(a.error.Xm):44,y=a.error.Xm);a=Da.a.JH("PopSessionId",b,"ServerErrorCode",m,"BSQMErrorCode",y,"TimeTakenInMs",+new Date-+this.Zye,"RetryCount",this.w9c,"PopSessionDisconnectedTimeLimitInMS",this.EDb,"PopsIdleTimeLimitInMS",this.FDb,"Now",Nc.a.nf(new Date),"CurrentDisconnectedTimeInMs",h,"PopSessionCreatedCount",
this.$Ab,"LastPingScheduledTime",Nc.a.nf(this.Ula),"LastSuccessfulEnsureHostSessionId",this.Ze.Tle);b="";try{b=Sys.Serialization.JavaScriptSerializer.serialize(a)}catch(G){Ba.a.J(36320455,801,15,"HostSessionInfoCaller::OnGetHostSessionInfoFailed - Exception thrown while serializing the log string:{0};",G)}Ba.a.J(24655583,801,15,"HostSessionInfoCaller::OnGetHostSessionInfoFailed - Ping request failed: "+b);+new Date-+this.Ula>this.EDb?this.lKa(0,c):this.kdl(y)?this.Bfa(this.S7i(y),y):y===qf.a.Uh(370)?
h<this.FDb?this.lKa(this.la.getHostSessionInfoPingIntervalInMs,c):this.Bfa(11,y):h>=this.EDb?this.Bfa(3,y):this.lKa(this.cak,c)}}dne(a){const b=Da.a.JH("LastUsedPopSessionId",this.QCb,"LastClientClosedReason",this.ADg,"IsClientActive",this.xka,"AppInEditingMode",this.mc.Fn,"PopSessionDisconnectedTimeLimitInMS",this.EDb,"PopsIdleTimeLimitInMS",this.FDb,"Now",Nc.a.nf(new Date),"ConsecutivelyTriggeredPopsRehydrationCount",this.$Ab,"LastPingScheduledTime",Nc.a.nf(this.Ula),"LastSuccessfulEnsureHostSessionId",
this.Ze.Tle);let c;try{c=Sys.Serialization.JavaScriptSerializer.serialize(b)}catch(h){Ba.a.J(51421313,801,15,"HostSessionInfoCaller::LogPopsState - Exception thrown while serializing the log string:{0};",h),c=""}Ba.a.J(51421315,801,15,"HostSessionInfoCaller::LogPopsState:{0} - {1}",a,c)}QJa(a){Ba.a.J(36282957,801,15,"HostSessionInfoCaller.Reboot - Reason:{0}. Restarted on PopSession {1}. LastUsedPopSession:{2}; IsClientActive:{3};",a,this.Xa.Kk,this.QCb,this.xka);this.xka&&this.QCb===this.Xa.Kk||
(this.QCb=this.Xa.Kk,this.Lkd(),this.nla?(this.nla=!1,this.lKa(0,!0)):Ba.a.J(51421318,801,15,"HostSessionInfoCaller.Reboot did not schedule a ping request as the client was not closed previously - Reason:{0}; PopSession:{1}; LastUsedPopSession:{2}; IsClientActive:{3};",a,this.Xa.Kk,this.QCb,this.xka))}close(a){this.nla||(Ba.a.J(36536660,801,15,"HostSessionInfoCaller.Close - PopSession:{0}; Now:{1}; Reason:{2};",this.Xa.Kk,Nc.a.nf(new Date),a),this.BBe&&this.Bwa&&this.Bwa.instance&&this.Bwa.instance.uUk(Object(F.a)(this,
this.FIh,"visiblityChanged")),this.nla=!0,this.QCb="",this.ADg=a,window.clearTimeout(this.RRg))}get xka(){return!this.nla}}Object(n.a)(ek,"HostSessionInfoCaller",null,[]);class Dn{constructor(a,b,c,h,m,y,G,U,ja,va,Ta,fb){this.fma=null;this.DDb=a;this.Xa=b;this.Oc=c;this.Ze=h;this.la=m;this.z9=y;this.BO=G;this.Cea=U;this.mc=ja;this.vO=Ta;this.Bwa=fb;this.Oc.lOd(Object(F.a)(this,this.ugb,"onPopSessionClosed"));this.Oc.GA(Object(F.a)(this,this.Zwa,"onSessionEnded"));this.Ze.xga&&this.Oc.mOd(Object(F.a)(this,
this.FYa,"onPopSessionInitialized"))}$Cj(){Ba.a.J(24655587,801,50,"PopSessionInfoClient::InitializeGetHostSessionInfoClient");this.Ze.pA?this.CGe():this.Ze.xga||this.Ze.$kc.task.continueWith(()=>{this.CGe()})}FYa(){this.CGe()}CGe(){this.Ze.xga?!this.fma&&this.Ze.pA?this.fma=new ek(this.DDb,this.Xa,this.Ze,this.la,this.z9,this.BO,this.Cea,this.mc,this.vO,this.Bwa):this.QJa("PopSessionInitialized"):this.Ze.pA&&(this.rrc(),this.fma=new ek(this.DDb,this.Xa,this.Ze,this.la,this.z9,this.BO,this.Cea,this.mc,
this.vO,this.Bwa))}ugb(){this.close("PopSessionClosed")}Zwa(){this.dne("SessionClosed")}dne(a){this.fma&&this.fma.dne(a)}rrc(){this.Ze.$kc.task.continueWith(()=>{this.DGe()})}DGe(){this.Ze.pA&&this.QJa("PopSessionInitialized");this.rrc()}QJa(a){this.fma&&this.fma.QJa(a)}close(a){this.fma&&this.fma.close(a)}get xka(){return!!this.fma&&this.fma.xka}dispose(){this.Oc.dih(Object(F.a)(this,this.ugb,"onPopSessionClosed"));this.Ze.xga&&this.Oc.pPe(Object(F.a)(this,this.FYa,"onPopSessionInitialized"))}}Object(n.a)(Dn,
"PopSessionInfoClient",null,[1370,106]);var wg=d(282),Vl=d(222),lh=d(112),sm=d(648),vo=d(322),yk=d(854),pn=d(841);const $k=a=>{if(qf.a.vT(a)){a=qf.a.nN(a);if(pn.a(a))return 1;switch(a){case 103:case 44:case 370:return 0;case 309:case 311:case 27:case 320:case 244:case 245:case 372:return 1;case 326:return 2;default:return 3}}else switch(a){case qf.a.nDa:case qf.a.Q_c:return 0;default:return 3}};class kj{constructor(a,b,c,h,m,y,G,U,ja,va,Ta,fb){this.Xa=a;this.Ze=b;this.Qd=c;this.la=h;this.Fv=m;this.BC=
y;this.b$=G;this.Dea=Ta;this.mc=fb;this.Cea=ja;this.lFg=this.la.hermesNotRefreshErrorList;this.Swe=this.la.podsMaxRetryTimesForEnsureHostSession;this.HEg=this.la.podsMaxRetryDurationForEnsureHostSessionInMs;this.la.wg&&(U.jai(Object(F.a)(this,this.Jtk,"onSyncLoopStatusNotified")),va.$9h(Object(F.a)(this,this.Htk,"onSuccessfulOutbound")),va.z7(Object(F.a)(this,this.Aw,"onUnifiedAppStateChanged")));u.AFrameworkApplication.Rz&&va.ZFc(Object(F.a)(this,this.kfa,"onWopiTokenRefreshed"))}Bfa(a,b=null,c=
null){var h=this.b$.N8a(this.Xa.presentationId.string);h=Object.assign(new sm.a,{ForceCreatePods:!1,DoRehydrate:!0,IsRetrySession:!1,PodSessionID:this.Xa.podSessionId,PresentationID:this.Xa.presentationId.string,PodEndpointUrl:this.la.podsWebServiceBase,PopSessionID:h,UrlOverrides:this.la.sfa,IsCoauthSession:u.AFrameworkApplication.Vg.IsCoauthSession,IsCreateNewSession:this.la.tT,UseSharedHostFile:this.la.NOb});this.b$.eIc(h,b,c,a)}HFe(a,b){if(this.xSf(b,"PopSessionManager::OnEnsureHostSessionSucceeded"))this.tgh();
else{var c=new Date;this.Xa.Kk=b.xB.PopSessionID;this.Ze.pA=!0;this.Ze.Zkc=!0;this.Ze.Tle=b.xB.PopSessionID;this.Ze.Qka=c;this.Ze.xga&&this.BC.QJk();Ba.a.J(22934494,801,15,"PopSessionManager::OnEnsureHostSessionSucceeded - OldPopSessionID: {0}, ExpectedPopSessionId: {1}, ExpectedPodSessionId: {2}, CurrentPodSessionId:{3}, Trigger: {4}, Retries: {5}, StartTime: {6}, EndTime: {7}, Duration: {8}ms, ActionId: {9},",b.wYa,b.xB.PopSessionID,b.xB.PodSessionID,this.Xa.podSessionId,yk.a[b.trigger],b.retryCount,
Nc.a.nf(b.startTime),Nc.a.nf(c),+c-+b.startTime,b.actionId);b.EH&&b.EH(a)}}qGb(a,b){let c=a.error.Xm;const h=new Date;if(this.xSf(b,"PopSessionManager::OnEnsureHostSessionFailed -"))this.tgh();else{if(b.retryCount<this.Swe&&+h-+b.startTime<=this.HEg){if(0===$k(c)||c===qf.a.Uh(252)){b.retryCount++;a=this.b$.N8a(this.Xa.presentationId.string);Ba.a.J(23349401,801,50,"{0} OldPopSessionID: {1}, ExpectedPopSessionId: {2}, ExpectedPodSessionId: {3}, CurrentPodSessionId:{4}, Trigger: {5}, Retries: {6}, StartTime: {7}, Now: {8}, Duration: {9}ms, bSqmErrorCode: {10}, ActionId: {11},",
"PopSessionManager::OnEnsureHostSessionFailed -",b.wYa,b.xB.PopSessionID,b.xB.PodSessionID,this.Xa.podSessionId,yk.a[b.trigger],b.retryCount,Nc.a.nf(b.startTime),Nc.a.nf(h),+h-+b.startTime,c,b.actionId);b.xB.PopSessionID=a;b.xB.IsRetrySession=!0;this.b$.CAf(b);return}this.Ze.Qka=h;var m="FatalError"}else this.Ze.Qka=h,m=b.retryCount>=this.Swe?String.format("Exceeded the limit of {0} times of retrying",this.Swe):String.format("EnsureHostSession duration exceeded the limit of {0}ms. ElapsedTime: {1}ms",
this.HEg,+h-+b.startTime);c===qf.a.nDa&&(c=0===b.trigger?qf.a.Uh(375):qf.a.Uh(309));Ba.a.J(23667161,801,10,"{0} OldPopSessionID: {1}, ExpectedPopSessionId: {2}, ExpectedPodSessionId: {3}, CurrentPodSessionId:{4}, Trigger: {5}, Retries: {6}, StartTime: {7}, EndTime: {8}, Duration: {9}, bSqmErrorCode: {10}, AbortReason: {11}, ActionId:{12},","PopSessionManager::OnEnsureHostSessionFailed -",b.wYa,b.xB.PopSessionID,b.xB.PodSessionID,this.Xa.podSessionId,yk.a[b.trigger],b.retryCount,Nc.a.nf(b.startTime),
Nc.a.nf(h),+h-+b.startTime,c,m,b.actionId);b.Ws&&b.Ws(a)||this.S$d(c,"PopSessionManager::OnEnsureHostSessionFailed -")}}xSf(a,b){return a.xB.PodSessionID!==this.Xa.podSessionId?(Ba.a.J(512262810,801,15,"EnsureHostSession - Ignore response since PodSessionId is changed. CurrentPodsSession:{0}; RequestPodsSession:{1}; functionName:{2} Need to trigger another request immediately.",this.Xa.podSessionId,a.xB.PodSessionID,b),!0):!1}tgh(){this.Ze.Qka=new Date;this.Bfa(8)}Jtk(a,b){a=qf.a.Uh(b.izh);Ba.a.J(512262809,
801,10," {0} - ServerErrorCode:{1}, bSqmErrorCode:{2}, PopSessionId:{3}, PodSessionId:{4}","PopSessionManager::OnSyncLoopStatusNotified",b.izh,a,this.Xa.Kk,this.Xa.podSessionId);this.Ze.pA=!1;this.Ze.xga&&this.BC.lNe(new fo(this.Ze.Hda));this.S$d(a,"PopSessionManager::OnSyncLoopStatusNotified",b.nTi)}kfa(a,b){try{b.x_c?(Ba.a.J(512262808,814,50,"PopSessionManager::OnWopiTokenRefreshed Token refresh succeeded."),b.oQj||(this.ksb(()=>{},()=>{}),this.Bfa(9))):Ba.a.J(512262807,814,15,"PopSessionManager::OnWopiTokenRefreshed Token refresh failed.")}catch(c){Ba.a.J(512262806,
814,10,"PopSessionManager::OnWopiTokenRefreshed Exception: {0}",c)}}wSf(a,b){return a&&this.Xa.Kk&&this.Xa.Kk!==a?(Ba.a.J(512262805,801,15,"PopSessionManager::FStaleResponse - RequestingFunctionName:{0} - Ignore response since PopSessionId is changed. CurrentPopSessionId:{1}; RequestPopSessionId:{2}; LastAttemptedEnsureHostSessionId:{3};",b,this.Xa.Kk,a,this.Ze.Hda),!0):!1}S$d(a,b,c=null){Ba.a.J(512262804,801,10,"PopSessionManager::HandlePOPSErrors:{0}; SourceFunction:{1};",a,b);if(!this.Lqj(a)){if(u.AFrameworkApplication.Rz&&
a===qf.a.Uh(320)){const h=wg.a.instance.A6a();if(h){Ba.a.J(512262803,801,15,"PopSessionManager::HandlePOPSErrors:{0}; SessionExpired fTriggered:{1};",a,h);return}}this.Fv.$$d(a,b)||this.CZd(a,b,c)}}ksb(a,b,c=!1){Ba.a.J(512262802,801,15,"PopSessionManager::CallClosePopSession - PopSessionID: {0}, PodSessionId: {1}, PopSessionInitialized: {2}, LastAttemptedEnsureHostSessionId:{3}, PopSessionForceClosed:{4}",this.Xa.Kk,this.Xa.podSessionId,this.Ze.pA,this.Ze.Hda,this.Ze.Pgd);if(this.Ze.pA||!this.Ze.Pgd){if(this.G1e(c,
""))a(new vo.a(null)),Ba.a.J(512262801,801,50,"sendBeacon request sent Time:{0}",Date.now());else{const h={};h["X-UsePopsRole"]=u.AFrameworkApplication.fa.ka("UsePopsRole").toString();this.Dea.jJc(this.Ze.Hda,this.Xa.podSessionId,this.Xa.presentationId.string,u.AFrameworkApplication.fa.appSettings["361"],this.Xa.V$,c,a,b,null,h)}this.Ze.pA=!1;this.Ze.Pgd=!0;this.BC.lNe(new fo(this.Ze.Hda))}}G1e(a,b){if(!v.a.Srb())return!1;try{const c=this.A2i(a,b),h=this.l4d();u.AFrameworkApplication.Je.rKa(h,c);
return!0}catch(c){return Ba.a.J(512262800,801,10,"Failed to send beacon request for ClosePopWacSession"),!1}}A2i(a,b){const c={};c.popSessionID=this.Ze.Hda;c.podSessionID=b.length?b:this.Xa.podSessionId;c.presentationID=this.Xa.presentationId.string;c.podUrl=u.AFrameworkApplication.fa.appSettings["361"];c.podInstance=this.Xa.V$;c.fTimeoutOrUserClose=a;return lh.c(c)}l4d(){var a=u.AFrameworkApplication.fa.Ha("368")+u.AFrameworkApplication.fa.Ha("367")+"/ClosePopWacSession";a=new Vl.QueryStringBuilder(a);
a.Jz(u.AFrameworkApplication.p1a,u.AFrameworkApplication.userSessionId);a.Jz(u.AFrameworkApplication.uRd,u.AFrameworkApplication.buildVersion);a.Jz("waccluster",this.Xa.nk);a.Jz("WacUserType",u.AFrameworkApplication.userType);a.Jz(u.AFrameworkApplication.rAb,u.AFrameworkApplication.c1c);a.Jz(u.AFrameworkApplication.VV,u.AFrameworkApplication.accessToken);a.Jz(u.AFrameworkApplication.Rba,u.AFrameworkApplication.hm.toString());a.Jz("X-UsePopsRole",this.Xa.sza.toString());a.Jz("X-PopsAffinityRoutingEnabled",
this.Xa.nFa.toString());return a=a.toString()}Lqj(a){if(a!==qf.a.Uh(245))return!1;if(this.Ze.mmg>this.Ze.Qka&&this.Ze.pA)return Ba.a.J(512262799,801,15,"PopSessionManager::HandleFailedToGetPodsLatestBase - Got FailedToGetPodsLatestBase again."),!1;this.Ze.mmg=new Date;this.vCf(0);return!0}vCf(a){const b=this.Xa.podSessionId;this.Cea.dej(()=>{if(b!==this.Xa.podSessionId)Ba.a.J(512262798,801,15,"{0} - Skip. PodSession is changed. Requested:{1}, Current:{2}","PopSessionManager::CheckPodSessionStateForFailedToGetPodsLatestBase",
b,this.Xa.podSessionId);else{var c=qf.a.Uh(245);this.Fv.$$d(c,"PopSessionManager::CheckPodSessionStateForFailedToGetPodsLatestBase")||this.CZd(c,"PopSessionManager::CheckPodSessionStateForFailedToGetPodsLatestBase")}},()=>{b!==this.Xa.podSessionId?Ba.a.J(512262797,801,15,"{0} - Skip. PodSession is changed. Requested:{1}, Current:{2}","PopSessionManager::CheckPodSessionStateForFailedToGetPodsLatestBase",b,this.Xa.podSessionId):this.Cea.K9b?Ba.a.J(512262796,801,15,"{0} - Skip. PODS unhealthy already",
"PopSessionManager::CheckPodSessionStateForFailedToGetPodsLatestBase"):a<this.la.eej?(Ba.a.J(512262795,801,15,"{0} - Retry getting PODS health state. CurrentRetryCount:{1}","PopSessionManager::CheckPodSessionStateForFailedToGetPodsLatestBase",a),this.vCf(a+1)):(Ba.a.J(512262794,801,10,"{0} - PODS is unhealthy. Trigger rehydration.","PopSessionManager::CheckPodSessionStateForFailedToGetPodsLatestBase"),this.Qd.us(Object.assign(new jl.a,{Code:223,Source:6}),b))})}CZd(a,b,c=null){Ba.a.J(512262793,801,
10,"PopSessionManager::DisplayPOPSErrors:{0}; RequestingFunction:{1};",a,b);const h=qf.a.nN(a);qf.a.vT(a)?(a=Object.assign(new jl.a,{Code:qf.a.nN(a),Source:5,ExtraErrorParam:c}),this.Qd.us(a,this.Xa.podSessionId,m=>{m.$B=1;Array.contains(this.lFg,yg.a[h].toUpperCase())||(m.cCa=8);399===h?(m.title=ResourceStrings.errorTitle_PowerpointEditingStandard,m.message=ResourceStrings.errorMessage_Unknown):384!==h&&(m.title=ResourceStrings.errorTitle_PowerpointEditingStandard,m.message=ResourceStrings.errorMessage_FailedToEnsurePopSession);
return!1})):(b=0,Array.contains(this.lFg,yg.a[h].toUpperCase())||(b=8),this.Qd.psa(a,b,ResourceStrings.errorTitle_PowerpointEditingStandard,ResourceStrings.errorMessage_FailedToEnsurePopSession))}Htk(){this.Ze.pA||(Ba.a.J(512262792,801,15,"PopSessionManager::OnSuccessfulOutbound - PopSession not initialized. OldPopSessionID:{0}, PresentationID Null?:{1}",this.Xa.Kk,!this.Xa.presentationId.string),this.Bfa(5))}Aw(a,b){Rd.a("Pops.CloseSessionDueToReadonly")&&b.Hie&&!this.mc.rL&&this.Ze.pA&&(Ba.a.J(512262791,
801,50,"PopSessionManager::OnUnifiedAppStateChanged - Close Pop session due to readonly"),this.ksb(()=>{},()=>{}))}}Object(n.a)(kj,"PopSessionManager",null,[1368]);class Ej{get name(){return"PowerPointWebEditor.PodsPops"}$b(a){a.register(1368,"PowerPointWebEditor.PodsPopsCore.IPopSessionManager").ma().oa(()=>new kj(a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.resolve("PowerPointWebEditor.IPopSessionState"),a.resolve("PowerPointWebEditor.IErrorHandler"),a.resolve("PowerPointWebEditor.IApplicationSettings"),
a.resolve("PowerPointWebEditor.Application.IReadOnlyManager"),a.resolve("PowerPointWebEditor.Core.ICoreEventNotifier"),a.resolve("PowerPointWebEditor.PodsPopsCore.IPopSessionCoreManager"),a.resolve("PowerPointWebEditor.Core.IPodsPopsEventHandler"),a.resolve("PowerPointWebEditor.PodsPopsCore.IPodSessionManager"),a.resolve("PowerPointWebEditor.Core.ICoreEventSource"),a.resolve("PowerPointWebEditor.IPopWebService"),a.resolve("PowerPointWebEditor.Core.IUnifiedAppState")));a.register(1369,"PowerPointWebEditor.PodsPopsCore.IPodSessionManager").ma().oa(()=>
new Dj(a.resolve("PowerPointWebEditor.ISessionInfoOwner"),u.AFrameworkApplication.Je,a.resolve("PowerPointWebEditor.IErrorHandler"),a.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),a.resolve("PowerPointWebEditor.IApplicationSettings"),()=>u.AFrameworkApplication.userSessionId,a.resolve("PowerPointWebEditor.Core.IPodsPopsEventSource"),a.resolve("PowerPointWebEditor.IAppBootCompletedListener"),a.resolve("PowerPointWebEditor.IPopSessionState"),a.resolve("PowerPointWebEditor.IPopWebService"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),
a.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("Common.IActionManagerExtended"),a.resolve("Common.ITaskManager"),a.Ja("PowerPointWebEditor.IErrorDialog"),a.resolve("PowerPointWebEditor.Core.ICoreEventSource"),a.Ja("PowerPointWebEditor.PodsPops.IPodSeamlessFailoverManager"),a.resolve("PowerPointWebEditor.Core.ICoreEventNotifier")));a.register(1370,"PowerPointWebEditor.PodsPops.IPopSessionInfoClient").ma().oa(()=>
new Dn(a.resolve("PowerPointWebEditor.IPopWebService"),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),a.resolve("PowerPointWebEditor.IPopSessionState"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.Ja("PowerPointWebEditor.IErrorDialog"),a.resolve("PowerPointWebEditor.PodsPopsCore.IPopSessionManager"),a.resolve("PowerPointWebEditor.PodsPopsCore.IPodSessionManager"),a.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),a.resolve("PowerPointWebEditor.NotificationManager"),
a.resolve("PowerPointWebEditor.Core.INetworkHealthManager"),a.Ja("Common.App.VisibilityManagement.IVisibilityManager")))}init(){}dispose(){}static main(){r.a.instance.Dc(new Ej)}}Object(n.a)(Ej,"PPTWebEditorPodsPopsPackage",null,[2,3]);class nk{constructor(a,b,c,h,m){this.R9=new Qa.a;this.Bbc=this.Cbc=null;this.aug=this.lcc=0;this.Due=this.Cue=!1;this.PBb=$d.a.tfa(2,0,!1);this.UXa=$d.a.tfa(2,1,!1);this.F$c=a;this.Zcc=c;this.jl=h;this.Kq=b;this.BEg=m}get Ic(){return this.Zcc.Ic}u5g(a,b,c,h){if(!b)return!1;
this.Cue||(this.lcc=Date.now(),this.Cue=!0);b=!1;try{if(this.jl.Xvf(c.shapeNode)){this.R9.clear();this.fni();const m=this.J4i(c);if(a){const G=this.jl.Kij(this.jl.yI(c,a),this.nSa(m),this.Ic,this.PBb,this.UXa);if(G.top||G.bottom||G.left||G.right)b=!0,this.jl.Wqc(c,G);if(this.BEg){const U=this.jl.V7i(this.jl.yI(c,a),m,this.PBb,this.UXa,h);if(U.top||U.bottom||U.left||U.right)b=!0,this.jl.Wqc(c,U);const ja=this.jl.W7i(this.jl.yI(c,a),m,this.Ic,this.UXa,h,a);if(ja.top||ja.bottom||ja.left||ja.right)b=
!0,this.jl.Wqc(c,ja);const va=this.jl.hbj(this.jl.yI(c,a),m,this.Ic,this.UXa,h,a);if(va.top||va.bottom||va.left||va.right)b=!0,this.jl.Wqc(c,va)}}else b=this.jl.qjl(c,this.jl.yI(c,a),this.nSa(m),this.Ic,this.PBb,this.UXa);this.R9.addRange(this.jl.Omi(this.jl.yI(c,a),this.nSa(m),this.Ic));const y=this.jl.fsb(this.jl.yI(c,a),this.nSa(m));if(y.count)this.R9.addRange(y);else if(!b){let G;G=a?this.jl.pjl(this.jl.yI(c,!0),this.nSa(m),c):this.jl.ojl(this.jl.yI(c,!1),this.nSa(m),c,this.UXa,this.PBb);this.R9.addRange(G);
b=!!G&&0<G.count}if(this.BEg)if(a)this.R9.addRange(this.jl.nSd(this.jl.yI(c,a),this.jl.jSa(m),this.Ic,h,a)),this.R9.addRange(this.jl.s6a(this.jl.yI(c,a),this.jl.jSa(m),this.Ic,h,a)),this.R9.addRange(this.jl.Xmi(this.jl.yI(c,a),this.jl.jSa(m),h));else{const G=this.jl.s6a(this.jl.yI(c,a),this.jl.jSa(m),this.Ic,h,a);if(G.count)this.R9.addRange(G);else if(!b){const ja=this.jl.Hwh(this.jl.yI(c,!1),this.nSa(m),c,this.Ic,this.UXa,this.PBb);this.R9.addRange(this.jl.s6a(this.jl.yI(c,a),this.jl.jSa(m),this.Ic,
h,a));b=ja}const U=this.jl.nSd(this.jl.yI(c,a),this.jl.jSa(m),this.Ic,h,a);if(U.count)this.R9.addRange(U);else if(!b){const ja=this.jl.Hwh(this.jl.yI(c,!1),this.nSa(m),c,this.Ic,this.UXa,this.PBb);this.R9.addRange(this.jl.nSd(this.jl.yI(c,a),this.jl.jSa(m),this.Ic,h,a));b=ja}}this.F$c.gOf(this.R9.toArray());this.F$c.visible=!0}}catch(m){this.Due||(Ba.a.J(8959958,815,10,"SmartGuide - moving error {0}",m.toString()),this.Due=!0)}return b}y5g(a){a&&(this.F$c.visible=!1,this.Bbc=this.Cbc=null,this.R9.clear(),
this.F$c.gOf([]),this.aug=Date.now(),this.Due=this.Cue=!1,Ba.a.J(8959960,815,50,"SmartGuide - moving timespan {0}",(this.aug-this.lcc).toString()))}fni(){this.jl.q0g=this.Kq.Pm(this.Ic.CU.offsetLeft-this.Ic.Qc.scrollLeft);this.jl.r0g=this.Kq.Pm(this.Ic.CU.offsetTop-this.Ic.Qc.scrollTop)}J4i(a){return this.Cbc?this.Cbc:this.Cbc=this.jl.I4i(this.jl.Xhj(this.Ic,this.Ic.Ma),a)}nSa(a){return this.Bbc?this.Bbc:this.Bbc=this.jl.jSa(a)}}Object(n.a)(nk,"SmartGuideManager",null,[1358]);var pj=d(131),ke=d(165),
yi=d(193),ad=d(56),Lh=d(160);class kg{constructor(){this.$2c=this.dGa=null;this.F4c=0;this.vcb=this.Xeb=null;this.Zcf=!1}get color(){return this.dGa}set color(a){this.dGa=a}get dashStyle(){return this.$2c}set dashStyle(a){this.$2c=a}get w6b(){return this.F4c}set w6b(a){this.F4c=a}get Mf(){return this.Xeb}set Mf(a){this.Xeb=a}get Eg(){return this.vcb}set Eg(a){this.vcb=a}get cH(){return this.Zcf}set cH(a){this.Zcf=a}length(){let a=-1;this.Xeb&&this.vcb&&(a=Math.sqrt(Math.pow(this.vcb._x-this.Xeb._x,
2)+Math.pow(this.vcb._y-this.Xeb._y,2)));return a}reset(){const a=new kg;this.dGa=a.dGa;this.$2c=a.$2c;this.F4c=a.F4c;this.Xeb=a.Xeb;this.vcb=a.vcb}}Object(n.a)(kg,"SmartGuideLine",null,[1480]);class ok{constructor(a,b,c,h){this.distance=a;this.VQd=b;this.S_d=c;this.direction=h}}Object(n.a)(ok,"DistancePair",null,[]);class Fn{constructor(a,b){this.shape=a;this.Ek=b}}Object(n.a)(Fn,"LightSet",null,[]);class Nl{constructor(a,b,c,h){this.begin=a;this.end=b;this.shape=c;this.distance=h}}Object(n.a)(Nl,
"LightSetItem",null,[]);class Gn{constructor(){this.ocb={};this.vDg=[]}ga(a){return this.ocb[a]}$(a,b){a in this.ocb||this.vDg.push(a);return this.ocb[a]=b}get keys(){return this.vDg}}Object(n.a)(Gn,"NumberDictionary",null,[]);class bi{constructor(a,b){this.first=a;this.second=b}}Object(n.a)(bi,"NumberPair",null,[]);var zk=d(654);class aj{constructor(a,b){this.Aze=[];this.xg=5;this.Y3=this.yw=2;this.tO=4;this.iB=3;this.T7c=this.S7c=0;this.Kq=a;this.AEb=b}Xhj(a,b){a=rb.GraphIterator.nb(a.gb);const c=
[];for(var h=a.Bb(1);h;h=a.Af(1))h=Lh.a(h,b),c.push(h);return c}yI(a,b){for(const c of this.Aze)if(c.gG(a))return c.yI(a,b);return null}addHandler(a){this.Aze.push(a)}ojl(a,b,c,h,m){h=this.Ypd(h,aj.NHc);m=this.Ypd(m,aj.NHc);for(var y of h){h=a.copy();h.move(0,0-y);h=this.fsb(h,b);if(h.count)return this.ZKa(c,0,-y),h;h=a.copy();h.move(0,y);h=this.fsb(h,b);if(h.count)return this.ZKa(c,0,y),h}for(let G of m){y=a.copy();y.move(0-G,0);y=this.fsb(y,b);if(y.count)return this.ZKa(c,-1*G,0),y;y=a.copy();y.move(G,
0);y=this.fsb(y,b);if(y.count)return this.ZKa(c,G,0),y}return new Qa.a}Ypd(a,b){const c=new Qa.a;a/=b;let h=0;for(let m=0;m<b;++m)h+=a,c.add(h);return c}pjl(a,b,c){var h=[];for(const m of h)if(h=a.copy(),h.setOffsets(m),h=this.fsb(h,b),h.count)return this.Wqc(c,m),h;return new Qa.a}jSa(a){const b=[];for(const c of a)b.push(new zk.a(c.ls()));return b}qjl(a,b,c,h,m,y){const G=new ad.a(Number.MAX_VALUE,Number.MAX_VALUE);let U=Number.MAX_VALUE;var ja=Number.MAX_VALUE;let va=[];for(const Ta of c)va.push(Ta);
this.AEb&&(va=this.F6h(va,h));for(const Ta of va)c=this.Cbj(b,Ta,U),Math.abs(G.y)>Math.abs(c)&&(G.y=c),U=Math.abs(c),c=this.Abj(b,Ta,ja),Math.abs(G.x)>Math.abs(c)&&(G.x=c),ja=Math.abs(c);ja=this.s7i(b,U,h);Math.abs(G.y)>Math.abs(ja)&&(G.y=ja);ja=this.r7i(b,U,h);Math.abs(G.x)>Math.abs(ja)&&(G.x=ja);Math.abs(G.x)>m&&(G.x=0);Math.abs(G.y)>y&&(G.y=0);return G.x||G.y?(this.ZKa(a,G.x,G.y),!0):!1}F6h(a,b){var c=this.Kq.Pm(b.me.width);b=this.Kq.Pm(b.me.height);var h=new zk.a(new pj.a(new ad.a(0,0),new ad.a(c,
0),new ad.a(c,b),new ad.a(0,b)));a.push(h);h=new zk.a(new pj.a(new ad.a(0,0),new ad.a(c,0),new ad.a(c,b/2),new ad.a(0,b/2)));a.push(h);c=new zk.a(new pj.a(new ad.a(0,0),new ad.a(c/2,0),new ad.a(c/2,b),new ad.a(0,b)));a.push(c);return a}Wqc(a,b){this.SUc(a,c=>{c.setOffsets(a,b)})}ZKa(a,b,c){this.SUc(a,h=>{h.setPosition(a,b,c)})}SUc(a,b){for(const c of this.Aze)if(c.gG(a)){b(c);break}}Kij(a,b,c,h,m){let y=Number.MAX_VALUE,G=Number.MAX_VALUE,U=Number.MAX_VALUE,ja=Number.MAX_VALUE;var va=[];for(var Ta of b)va.push(Ta.copy());
b=this.Kq.Pm(c.me.width);c=this.Kq.Pm(c.me.height);Ta=new zk.a(new pj.a(new ad.a(0,0),new ad.a(b,0),new ad.a(b,c),new ad.a(0,c)));va.push(Ta);this.AEb&&(Ta=new zk.a(new pj.a(new ad.a(0,0),new ad.a(b,0),new ad.a(b,c/2),new ad.a(0,c/2))),va.push(Ta),b=new zk.a(new pj.a(new ad.a(0,0),new ad.a(b/2,0),new ad.a(b/2,c),new ad.a(0,c))),va.push(b));for(const fb of va)va=this.umd([fb.Xb-a.kc,fb.kc-a.kc,fb.Xf().y-a.kc],m),this.BT(va,m)&&Math.abs(va)<Math.abs(y)&&(y=va),va=this.umd([fb.Xb-a.Xb,fb.kc-a.Xb,fb.Xf().y-
a.Xb],m),this.BT(va,m)&&Math.abs(va)<Math.abs(G)&&(G=va),va=this.umd([fb.hc-a.hc,fb.Zb-a.hc,fb.Xf().x-a.hc],h),this.BT(va,h)&&Math.abs(va)<Math.abs(U)&&(U=va),va=this.umd([fb.hc-a.Zb,fb.Zb-a.Zb,fb.Xf().x-a.Zb],h),this.BT(va,h)&&Math.abs(va)<Math.abs(ja)&&(ja=va);a=new yi.a;a.top=y===Number.MAX_VALUE?a.top:y;a.bottom=G===Number.MAX_VALUE?a.bottom:G;a.left=U===Number.MAX_VALUE?a.left:U;a.right=ja===Number.MAX_VALUE?a.right:ja;return a}Xvf(a){return a.nua||a.Ej||a.gl||a.ar||a.Rf}c7i(a,b){return Math.abs(a-
b)}Cbj(a,b,c){a=[new bi(a.kc,b.kc),new bi(a.kc,b.Xb),new bi(a.kc,b.Xf().y),new bi(a.Xb,b.kc),new bi(a.Xb,b.Xb),new bi(a.Xb,b.Xf().y),new bi(a.Xf().y,b.kc),new bi(a.Xf().y,b.Xb),new bi(a.Xf().y,b.Xf().y)];return this.sSc(a,c)}Abj(a,b,c){a=[new bi(a.hc,b.hc),new bi(a.hc,b.Zb),new bi(a.hc,b.Xf().x),new bi(a.Zb,b.hc),new bi(a.Zb,b.Zb),new bi(a.Zb,b.Xf().x),new bi(a.Xf().x,b.hc),new bi(a.Xf().x,b.Zb),new bi(a.Xf().x,b.Xf().x)];return this.sSc(a,c)}s7i(a,b,c){c=this.Kq.Pm(c.me.height);a=[new bi(a.kc,0),
new bi(a.kc,c),new bi(a.Xb,0),new bi(a.Xb,c),new bi(a.Xf().y,0),new bi(a.Xf().y,c)];return this.sSc(a,b)}r7i(a,b,c){c=this.Kq.Pm(c.me.width);a=[new bi(a.hc,0),new bi(a.hc,c),new bi(a.Zb,0),new bi(a.Zb,c),new bi(a.Xf().x,0),new bi(a.Xf().x,c)];return this.sSc(a,b)}sSc(a,b){let c=Number.MAX_VALUE;for(const h of a)a=this.c7i(h.first,h.second),a<b&&(b=a,c=h.second-h.first);return c}BT(a,b){a=Math.abs(a);return.2<a&&a<b}umd(a,b){let c=Number.MAX_VALUE;for(const h of a)this.BT(h,b)&&Math.abs(c)>Math.abs(h)&&
(c=h);return c}I4i(a,b){const c=new Qa.a;for(const h of a)this.Xvf(h.shapeNode)&&h.gb!==b.gb&&c.add(h);return c.toArray()}fsb(a,b){var c=new Qa.a;c.add(a);var h=new Qa.a;h.add(a);var m=new Qa.a;m.add(a);var y=new Qa.a;y.add(a);for(const G of b)G.Xb<a.kc||G.kc>a.Xb||(G.hc<a.hc&&this.$Ec(c,G,2),G.Zb>a.Zb&&this.$Ec(h,G,3)),G.Zb<a.hc||G.hc>a.Zb||(G.kc<a.kc&&this.$Ec(m,G,0),G.Xb>a.Xb&&this.$Ec(y,G,1));a=this.xSc(c,2);h=this.xSc(h,3);b=this.xSc(m,0);c=this.xSc(y,1);y=new Gn;this.XKc(y,a[0]);this.XKc(y,
h[0]);m=new Gn;this.XKc(m,b[0]);this.XKc(m,c[0]);this.QOc(y,a,2);this.QOc(y,h,3);this.QOc(m,b,0);this.QOc(m,c,1);a=new Qa.a;h=new Qa.a;this.fIf(y,a,h);this.fIf(m,a,h);this.t0a(a,1);this.t0a(h,2);a.addRange(h);for(let G of a)this.Kv(G);return a}xSc(a,b){const c=new Qa.a;for(let m=0;m<a.count;++m){var h=new Nl(this.l6i(a,m,b),this.D6i(a,m,b),null,-1);h=new Fn(a.ga(m),[h]);for(let y=m+1;y<a.count;++y){const G=h.Ek.length;let U=G;for(let ja=0;ja<G;++ja)if(!h.Ek[ja].shape&&-1===h.Ek[ja].distance&&h.Ek[ja].end>
h.Ek[ja].begin){const va=this.d7i(a,m,y,b);U+=this.hFk(a,y,ja,U,m,va,h,b);U+=this.jFk(a,y,ja,U,m,va,h,b);U+=this.YFk(a,y,ja,U,m,va,h,b);U+=this.iFk(a,y,ja,m,va,h,b)}}c.add(h)}return c.toArray()}fIf(a,b,c){for(const m of a.keys){var h=a.ga(m);if(1<h.count){const y=new Qa.a;for(let G of h){h=!1;for(let U of y)if(this.Aei(G,U)){h=!0;y.remove(U);break}h||y.add(G)}for(let G of y)this.kDi(G,b,c)}}}Aei(a,b){return this.Svf(a.VQd,b.VQd)&&this.Svf(a.S_d,b.S_d)}Svf(a,b){return a.hc===b.hc&&a.Zb===b.Zb&&a.kc===
b.kc&&a.Xb===b.Xb}$Ec(a,b,c){const h=a.count;for(let m=0;m<h;m++){const y=a.ga(m);if(3===c&&(b.hc<a.ga(0).Zb?b.Zb:b.hc)<(y.hc<a.ga(0).Zb?y.Zb:y.hc)||2===c&&(b.Zb>a.ga(0).hc?b.hc:b.Zb)>(y.Zb>a.ga(0).hc?y.hc:y.Zb)||0===c&&(b.Xb>a.ga(0).kc?b.kc:b.Xb)>(y.Xb>a.ga(0).kc?y.kc:y.Xb)||1===c&&(b.kc<a.ga(0).Xb?b.Xb:b.kc)<(y.kc<a.ga(0).Xb?y.Xb:y.kc)){a.insert(m,b);return}}a.add(b)}XKc(a,b){for(const c of b.Ek)0<c.distance&&a.$(Math.round(100*c.distance)/100,new Qa.a)}QOc(a,b,c){const h=new Gn;for(const m of b){for(const y of a.keys)h.$(y,
0);for(const y of m.Ek)if(0<y.distance&&y.shape)for(const G of a.keys)if(b=G,this.Bu(y.distance,b)){const U=h.ga(G);1>U&&(a.ga(G).add(new ok(b,m.shape,y.shape,c)),h.$(G,U+1));break}}}l6i(a,b,c){b=a.ga(b);a=a.ga(0);switch(c){case 2:case 3:return Math.max(b.kc,a.kc);case 0:case 1:return Math.max(b.hc,a.hc);default:return-1}}D6i(a,b,c){b=a.ga(b);a=a.ga(0);switch(c){case 2:case 3:return Math.min(b.Xb,a.Xb);case 0:case 1:return Math.min(b.Zb,a.Zb);default:return-1}}hFk(a,b,c,h,m,y,G,U){const ja=a.ga(b);
m=a.ga(m);switch(U){case 3:case 2:if(ja.Xb>=G.Ek[c].begin&&ja.Xb<=G.Ek[c].end&&ja.kc<=G.Ek[c].begin)return a=new Nl(G.Ek[c].begin,ja.Xb,a.ga(b),3===U?y-m.Zb:m.hc-y),G.Ek[h]=a,G.Ek[c].begin=ja.Xb,1;break;case 0:case 1:if(ja.Zb>=G.Ek[c].begin&&ja.Zb<=G.Ek[c].end&&ja.hc<=G.Ek[c].begin)return a=new Nl(G.Ek[c].begin,ja.Zb,a.ga(b),0===U?m.kc-y:y-m.Xb),G.Ek[h]=a,G.Ek[c].begin=ja.Zb,1}return 0}jFk(a,b,c,h,m,y,G,U){const ja=a.ga(b);m=a.ga(m);switch(U){case 3:case 2:if(ja.kc>=G.Ek[c].begin&&ja.kc<=G.Ek[c].end&&
ja.Xb>=G.Ek[c].end)return a=new Nl(ja.kc,G.Ek[c].end,a.ga(b),3===U?y-m.Zb:m.hc-y),G.Ek[h]=a,G.Ek[c].end=ja.kc,1;break;case 0:case 1:if(ja.hc>=G.Ek[c].begin&&ja.hc<=G.Ek[c].end&&ja.Zb>=G.Ek[c].end)return a=new Nl(ja.hc,G.Ek[c].end,a.ga(b),0===U?m.kc-y:y-m.Xb),G.Ek[h]=a,G.Ek[c].end=ja.hc,1}return 0}YFk(a,b,c,h,m,y,G,U){const ja=a.ga(b);m=a.ga(m);switch(U){case 3:case 2:if(ja.kc>G.Ek[c].begin&&ja.kc<G.Ek[c].end&&ja.Xb>G.Ek[c].begin&&ja.Xb<G.Ek[c].end)return a=new Nl(ja.kc,ja.Xb,a.ga(b),3===U?y-m.Zb:
m.hc-y),G.Ek[h]=a,a=new Nl(ja.Xb,G.Ek[c].end,null,-1),G.Ek[++h]=a,G.Ek[c].end=ja.kc,2;break;case 0:case 1:if(ja.hc>G.Ek[c].begin&&ja.hc<G.Ek[c].end&&ja.Zb>G.Ek[c].begin&&ja.Zb<G.Ek[c].end)return a=new Nl(ja.hc,ja.Zb,a.ga(b),0===U?m.kc-y:y-m.Xb),G.Ek[h]=a,a=new Nl(ja.Zb,G.Ek[c].end,null,-1),G.Ek[++h]=a,G.Ek[c].end=ja.hc,2}return 0}iFk(a,b,c,h,m,y,G){const U=a.ga(b);h=a.ga(h);switch(G){case 3:case 2:U.kc<y.Ek[c].begin&&U.Xb>y.Ek[c].end&&(y.Ek[c].shape=a.ga(b),y.Ek[c].distance=3===G?m-h.Zb:h.hc-m);break;
case 0:case 1:U.hc<y.Ek[c].begin&&U.Zb>y.Ek[c].end&&(y.Ek[c].shape=a.ga(b),y.Ek[c].distance=0===G?h.kc-m:m-h.Xb)}return 0}d7i(a,b,c,h){let m=-1;c=a.ga(c);a=a.ga(b);switch(h){case 3:c.hc<a.Zb&&c.Zb>=a.Zb&&(m=c.Zb);c.hc>=a.Zb&&(m=c.hc);break;case 2:c.Zb>a.hc&&c.hc<=a.hc&&(m=c.hc);c.Zb<=a.hc&&(m=c.Zb);break;case 0:c.Xb>a.kc&&c.kc<=a.kc&&(m=c.kc);c.Xb<=a.kc&&(m=c.Xb);break;case 1:c.kc<a.Xb&&c.Xb>=a.Xb&&(m=c.Xb),c.kc>=a.Xb&&(m=c.kc)}return m}kDi(a,b,c){const h=a.VQd;var m=a.S_d;switch(a.direction){case 3:var y=
Math.max(h.Xb,m.Xb),G=new kg;G.Mf=new ad.a(h.Zb-this.iB,h.kc);G.Eg=new ad.a(h.Zb-this.iB,y+this.xg);b.add(G);G=new kg;G.Mf=new ad.a(h.Zb+a.distance-this.iB,m.kc);G.Eg=new ad.a(h.Zb+a.distance-this.iB,y+this.xg);b.add(G);b=new kg;b.Mf=new ad.a(h.Zb-this.iB,y+this.xg);b.Eg=new ad.a(h.Zb+a.distance-this.iB,y+this.xg);c.add(b);break;case 2:y=Math.max(h.Xb,m.Xb);G=new kg;G.Mf=new ad.a(h.hc-a.distance-this.iB,m.kc);G.Eg=new ad.a(h.hc-a.distance-this.iB,y+this.xg);b.add(G);m=new kg;m.Mf=new ad.a(h.hc-this.iB,
h.kc);m.Eg=new ad.a(h.hc-this.iB,y+this.xg);b.add(m);b=new kg;b.Mf=new ad.a(h.hc-a.distance-this.iB,y+this.xg);b.Eg=new ad.a(h.hc-this.iB,y+this.xg);c.add(b);break;case 0:y=Math.max(h.Zb,m.Zb);G=new kg;G.Mf=new ad.a(h.hc,h.kc-this.yw);G.Eg=new ad.a(y+this.xg,h.kc-this.yw);b.add(G);G=new kg;G.Mf=new ad.a(m.hc,h.kc-a.distance-this.yw);G.Eg=new ad.a(y+this.xg,h.kc-a.distance-this.yw);b.add(G);b=new kg;b.Mf=new ad.a(y+this.xg,h.kc-this.yw);b.Eg=new ad.a(y+this.xg,h.kc-a.distance-this.yw);c.add(b);break;
case 1:y=Math.max(h.Zb,m.Zb),G=new kg,G.Mf=new ad.a(h.hc,h.Xb-this.yw),G.Eg=new ad.a(y+this.xg,h.Xb-this.yw),b.add(G),G=new kg,G.Mf=new ad.a(m.hc,h.Xb+a.distance-this.yw),G.Eg=new ad.a(y+this.xg,h.Xb+a.distance-this.yw),b.add(G),b=new kg,b.Mf=new ad.a(y+this.xg,h.Xb-this.yw),b.Eg=new ad.a(y+this.xg,h.Xb+a.distance-this.yw),c.add(b)}}Xmi(a,b,c){const h=new Qa.a;if(!c)return h;let m=!1;var y=!1;const G=c.equals(ke.a.west)||c.equals(ke.a.Ku)||c.equals(ke.a.IH),U=c.equals(ke.a.east)||c.equals(ke.a.yE)||
c.equals(ke.a.RE),ja=c.equals(ke.a.north)||c.equals(ke.a.Ku)||c.equals(ke.a.yE);c=c.equals(ke.a.south)||c.equals(ke.a.IH)||c.equals(ke.a.RE);for(const Ta of b){if(this.ckg(a,Ta,!0,b)&&(G||U)){m=!0;var va=new kg;va.Mf=new ad.a(Ta.hc,Ta.Xf()._y);va.Eg=new ad.a(Ta.Zb-this.iB,Ta.Xf()._y);va.cH=!0;h.add(this.Kv(va))}this.ckg(a,Ta,!1,b)&&(ja||c)&&(y=!0,va=new kg,va.Mf=new ad.a(Ta.Xf()._x,Ta.kc),va.Eg=new ad.a(Ta.Xf()._x,Ta.Xb-this.Y3),va.cH=!1,h.add(this.Kv(va)))}m&&(b=new kg,b.Mf=new ad.a(a.hc,a.Xf()._y),
b.Eg=new ad.a(a.Zb-this.iB,a.Xf()._y),b.cH=!0,h.add(this.Kv(b)));y&&(y=new kg,y.Mf=new ad.a(a.Xf()._x,a.kc),y.Eg=new ad.a(a.Xf()._x,a.Xb-this.Y3),y.cH=!1,h.add(this.Kv(y)));this.t0a(h,2);return h}j5(a,b,c){var h=this.mda(a,b,!1),m=this.mda(a,b,!0);if(!h&&!m)return!1;let y=[];if(h){if(a.Zb<=b.hc||a.Zb<=b.Zb){var G;var U=b.kc>a.kc?b.kc:a.kc;var ja=b.Xb<a.Xb?b.Xb:a.Xb;h=G=b.hc;a.Zb>b.hc&&(h=G=b.Zb);h=new zk.a(new pj.a(new ad.a(h,U),new ad.a(G,U),new ad.a(G,ja),new ad.a(h,ja)));Array.add(y,h)}if(a.hc>=
b.Zb||a.hc>=b.hc)U=b.kc>a.kc?b.kc:a.kc,ja=b.Xb<a.Xb?b.Xb:a.Xb,h=G=b.Zb,a.hc<b.Zb&&(h=G=b.hc),h=new zk.a(new pj.a(new ad.a(h,U),new ad.a(G,U),new ad.a(G,ja),new ad.a(h,ja))),Array.add(y,h)}if(m){if(a.Xb<=b.kc||a.Xb<=b.Xb)m=b.hc>a.hc?b.hc:a.hc,U=b.Zb<a.Zb?b.Zb:a.Zb,h=G=b.kc,a.Xb>b.kc&&(h=G=b.Xb),m=new zk.a(new pj.a(new ad.a(m,h),new ad.a(U,h),new ad.a(U,G),new ad.a(m,G))),Array.add(y,m);if(a.kc>=b.Xb||a.kc>=b.kc)m=b.hc>a.hc?b.hc:a.hc,U=b.Zb<a.Zb?b.Zb:a.Zb,h=G=b.Xb,a.kc<b.Xb&&(h=G=b.kc),m=new zk.a(new pj.a(new ad.a(m,
h),new ad.a(U,h),new ad.a(U,G),new ad.a(m,G))),Array.add(y,m)}for(const va of c)this.k$f(va,a)||this.k$f(va,b)||(y=this.$yl(a,va,y));return 0<y.length?!0:!1}$yl(a,b,c){let h=[];for(const m of c)c=!0,m.hc===m.Zb?(this.mda(m,b,!1)||(c=!1),a.Zb<=m.hc&&b.Zb<=a.Zb&&(c=!1),a.Zb<=m.hc&&b.hc>=m.Zb&&(c=!1),a.hc>=m.Zb&&b.hc>=a.hc&&(c=!1),a.hc>=m.Zb&&b.Zb<=m.hc&&(c=!1),c?b.kc<=m.kc&&b.Xb<m.Xb?h=this.AOb(h,!0,!0,!1,m,b):b.Xb>=m.Xb&&b.kc>m.kc?h=this.AOb(h,!0,!1,!1,m,b):b.kc>m.kc&&b.Xb<m.Xb&&(h=this.AOb(h,!0,!1,
!0,m,b)):Array.add(h,m)):m.kc===m.Xb&&(this.mda(m,b,!0)||(c=!1),a.Xb<=m.kc&&b.Xb<=a.Xb&&(c=!1),a.Xb<=m.kc&&b.kc>=m.Xb&&(c=!1),a.kc>=m.Xb&&b.kc>=a.kc&&(c=!1),a.kc>=m.Xb&&b.Xb<=m.kc&&(c=!1),c?b.hc<=m.hc&&b.Zb<m.Zb?h=this.AOb(h,!1,!0,!1,m,b):b.Zb>=m.Zb&&b.hc>m.hc?h=this.AOb(h,!1,!1,!1,m,b):b.hc>m.hc&&b.Zb<m.Zb&&(h=this.AOb(h,!1,!1,!0,m,b)):Array.add(h,m));return h}AOb(a,b,c,h,m,y){let G,U,ja,va,Ta,fb,Db;if(c)b?(c=U=m.hc,G=y.Xb,ja=m.Xb):(G=ja=m.kc,c=y.Zb,U=m.Zb);else if(c||h){if(b?(c=U=va=fb=m.hc,G=m.kc,
ja=y.kc,Ta=y.Xb,Db=m.Xb):(G=ja=Ta=Db=m.kc,c=m.hc,U=y.hc,va=y.Zb,fb=m.Zb),h&&b&&!this.Bu(Ta,Db)||h&&!b&&!this.Bu(va,fb))h=new zk.a(new pj.a(new ad.a(va,Ta),new ad.a(fb,Ta),new ad.a(fb,Db),new ad.a(va,Db))),Array.add(a,h)}else b?(c=U=m.hc,G=m.kc,ja=y.kc):(G=ja=m.kc,c=m.hc,U=y.hc);if(b&&!this.Bu(G,ja)||!b&&!this.Bu(c,U))b=new zk.a(new pj.a(new ad.a(c,G),new ad.a(U,G),new ad.a(U,ja),new ad.a(c,ja))),Array.add(a,b);return a}k$f(a,b){return a.Zb!==b.Zb||a.hc!==b.hc||a.kc!==b.kc||a.Xb!==b.Xb?!1:!0}ckg(a,
b,c,h){if(c)return c=this.Bu(a.hc,b.hc)&&this.Bu(a.Zb,b.Zb),this.Bu(a.Zb-a.hc,b.Zb-b.hc)&&!c&&this.j5(a,b,h);c=this.Bu(a.kc,b.kc)&&this.Bu(a.Xb,b.Xb);return this.Bu(a.Xb-a.kc,b.Xb-b.kc)&&!c&&this.j5(a,b,h)}V7i(a,b,c,h,m){const y=new yi.a;if(!m)return y;let G=Number.MAX_VALUE,U=Number.MAX_VALUE,ja=Number.MAX_VALUE,va=Number.MAX_VALUE;const Ta=m.equals(ke.a.west)||m.equals(ke.a.Ku)||m.equals(ke.a.IH),fb=m.equals(ke.a.east)||m.equals(ke.a.yE)||m.equals(ke.a.RE),Db=m.equals(ke.a.north)||m.equals(ke.a.Ku)||
m.equals(ke.a.yE);m=m.equals(ke.a.south)||m.equals(ke.a.IH)||m.equals(ke.a.RE);const gc=[];for(const hc of b)gc.push(new zk.a(hc.ls()));for(const hc of gc)b=hc.Xb-hc.kc-(a.Xb-a.kc),this.BT(b,h)&&Math.abs(b)<Math.abs(G)&&this.j5(a,hc,gc)&&Db&&(G=-1*b),this.BT(b,h)&&Math.abs(b)<Math.abs(U)&&this.j5(a,hc,gc)&&m&&(U=b),b=hc.Zb-hc.hc-(a.Zb-a.hc),this.BT(b,c)&&Math.abs(b)<Math.abs(ja)&&this.j5(a,hc,gc)&&Ta&&(ja=-1*b),this.BT(b,c)&&Math.abs(b)<Math.abs(va)&&this.j5(a,hc,gc)&&fb&&(va=b);y.top=G===Number.MAX_VALUE?
y.top:G;y.bottom=U===Number.MAX_VALUE?y.bottom:U;y.left=ja===Number.MAX_VALUE?y.left:ja;y.right=va===Number.MAX_VALUE?y.right:va;return y}W7i(a,b,c,h,m,y){let G=Number.MAX_VALUE,U=Number.MAX_VALUE,ja=Number.MAX_VALUE,va=Number.MAX_VALUE,Ta=!0,fb=!0,Db=!0,gc=!0;y&&m&&(Ta=m.equals(ke.a.west)||m.equals(ke.a.Ku)||m.equals(ke.a.IH),fb=m.equals(ke.a.east)||m.equals(ke.a.yE)||m.equals(ke.a.RE),Db=m.equals(ke.a.north)||m.equals(ke.a.Ku)||m.equals(ke.a.yE),gc=m.equals(ke.a.south)||m.equals(ke.a.IH)||m.equals(ke.a.RE));
m=[];for(var hc of b)m.push(new zk.a(hc.ls()));b=this.Kq.Pm(c.me.width);c=this.Kq.Pm(c.me.height);for(const Gc of m)Gc.hc>b/2&&Gc.hc<3*b/4&&a.Zb<b/2&&fb&&(hc=b/2-a.Zb-(Gc.hc-b/2),this.BT(hc,h)&&Math.abs(hc)<Math.abs(va)&&this.j5(a,Gc,m)&&(va=hc)),Gc.Zb<b/2&&Gc.Zb>b/4&&a.hc>b/2&&Ta&&(hc=b/2-Gc.Zb-(a.hc-b/2),this.BT(hc,h)&&Math.abs(hc)<Math.abs(ja)&&this.j5(a,Gc,m)&&(ja=hc)),Gc.kc>c/2&&Gc.kc<3*c/4&&a.Xb<c/2&&gc&&(hc=c/2-a.Xb-(Gc.kc-c/2),this.BT(hc,h)&&Math.abs(hc)<Math.abs(U)&&this.j5(a,Gc,m)&&(U=hc)),
Gc.Xb<c/2&&Gc.Xb>c/4&&a.kc>c/2&&Db&&(hc=c/2-Gc.Xb-(a.kc-c/2),this.BT(hc,h)&&Math.abs(hc)<Math.abs(G)&&this.j5(a,Gc,m)&&(G=hc));a=new yi.a;a.top=G===Number.MAX_VALUE?a.top:G;a.bottom=U===Number.MAX_VALUE?a.bottom:U;a.left=ja===Number.MAX_VALUE?a.left:ja;a.right=va===Number.MAX_VALUE?a.right:va;return a}Hwh(a,b,c,h,m,y){m=this.Ypd(m,aj.NHc);y=this.Ypd(y,aj.NHc);for(var G of m){m=a.copy();m.move(0,0-G);if(this.s6a(m,b,h,null,!1).count)return this.ZKa(c,0,-G),!0;m=a.copy();m.move(0,G);if(this.s6a(m,b,
h,null,!1).count)return this.ZKa(c,0,G),!0}for(let U of y){G=a.copy();G.move(0-U,0);if(this.s6a(G,b,h,null,!1).count)return this.ZKa(c,-1*U,0),!0;G=a.copy();G.move(U,0);if(this.s6a(G,b,h,null,!1).count)return this.ZKa(c,U,0),!0}return!1}mda(a,b,c){return c?a.hc>=b.hc&&a.hc<=b.Zb||a.Zb>=b.hc&&a.Zb<=b.Zb||b.hc>=a.hc&&b.hc<=a.Zb||b.Zb>=a.hc&&b.Zb<=a.Zb:a.kc>=b.kc&&a.kc<=b.Xb||a.Xb>=b.kc&&a.Xb<=b.Xb||b.kc>=a.kc&&b.kc<=a.Xb||b.Xb>=a.kc&&b.Xb<=a.Xb}nSd(a,b,c,h,m){const y=new Qa.a,G=new Qa.a,U=new Qa.a;
let ja=!1,va=!1,Ta=!1,fb=!1,Db=!0,gc=!0,hc=!0,Gc=!0;m&&h&&(Db=h.equals(ke.a.west)||h.equals(ke.a.Ku)||h.equals(ke.a.IH),gc=h.equals(ke.a.east)||h.equals(ke.a.yE)||h.equals(ke.a.RE),hc=h.equals(ke.a.north)||h.equals(ke.a.Ku)||h.equals(ke.a.yE),Gc=h.equals(ke.a.south)||h.equals(ke.a.IH)||h.equals(ke.a.RE));h=this.Kq.Pm(c.me.width);c=this.Kq.Pm(c.me.height);m=new kg;m.Mf=new ad.a(h/2-this.tO,0-this.yw);m.Eg=new ad.a(h/2-this.tO,c-this.yw);const Pc=new kg;Pc.Mf=new ad.a(0-this.tO,c/2-this.yw);Pc.Eg=new ad.a(h-
this.tO,c/2-this.yw);Pc.cH=!0;for(const yc of b)yc.hc>h/2&&yc.hc<3*h/4&&a.Zb<h/2&&this.j5(a,yc,b)&&gc&&this.Bu(h/2-a.Zb,yc.hc-h/2)&&(ja=!0,0>yc.kc&&(m.Mf=new ad.a(h/2,yc.kc)),yc.Xb>c&&(m.Eg=new ad.a(h/2,yc.Xb+this.xg)),y.add(this.hPa(yc,!1,!1)),G.add(this.dPa(yc,!1,!1,h,c))),yc.Zb<h/2&&yc.Zb>h/4&&a.hc>h/2&&this.j5(a,yc,b)&&Db&&this.Bu(a.hc-h/2,h/2-yc.Zb)&&(va=!0,0>yc.kc&&(m.Mf=new ad.a(h/2,yc.kc)),yc.Xb>c&&(m.Eg=new ad.a(h/2,yc.Xb+this.xg)),y.add(this.hPa(yc,!1,!0)),G.add(this.dPa(yc,!1,!0,h,c))),
yc.kc>c/2&&yc.kc<3*c/4&&a.Xb<c/2&&this.j5(a,yc,b)&&Gc&&this.Bu(c/2-a.Xb,yc.kc-c/2)&&(Ta=!0,0>yc.hc&&(Pc.Mf=new ad.a(yc.hc,c/2)),yc.Zb>h&&(Pc.Eg=new ad.a(yc.Zb+this.xg,c/2)),y.add(this.hPa(yc,!0,!1)),G.add(this.dPa(yc,!0,!1,h,c))),yc.Xb<c/2&&yc.Xb>c/4&&a.kc>c/2&&this.j5(a,yc,b)&&hc&&this.Bu(a.kc-c/2,c/2-yc.Xb)&&(fb=!0,0>yc.hc&&(Pc.Mf=new ad.a(yc.hc,c/2)),yc.Zb>h&&(Pc.Eg=new ad.a(yc.Zb+this.xg,c/2)),y.add(this.hPa(yc,!0,!0)),G.add(this.dPa(yc,!0,!0,h,c)));(ja||va)&&y.add(this.Kv(m));(Ta||fb)&&y.add(this.Kv(Pc));
Ta&&(a.hc<Pc.Mf._x&&(Pc.Mf=new ad.a(a.hc,c/2)),a.Zb>Pc.Eg._x&&(Pc.Eg=new ad.a(a.Zb,c/2+this.xg)),y.add(this.hPa(a,!0,!0)),G.add(this.dPa(a,!0,!0,h,c)));fb&&(a.hc<Pc.Mf._x&&(Pc.Mf=new ad.a(a.hc,c/2)),a.Zb>Pc.Eg._x&&(Pc.Eg=new ad.a(a.Zb,c/2+this.xg)),y.add(this.hPa(a,!0,!1)),G.add(this.dPa(a,!0,!1,h,c)));ja&&(a.kc<m.Mf._y&&(m.Mf=new ad.a(h/2,a.kc)),a.Xb>m.Eg._y&&(m.Eg=new ad.a(h/2,a.Xb+this.xg)),y.add(this.hPa(a,!1,!0)),G.add(this.dPa(a,!1,!0,h,c)));va&&(a.kc<m.Mf._y&&(m.Mf=new ad.a(h/2,a.kc)),a.Xb>
m.Eg._y&&(m.Eg=new ad.a(h/2,a.Xb+this.xg)),y.add(this.hPa(a,!1,!1)),G.add(this.dPa(a,!1,!1,h,c)));this.t0a(y,1);this.t0a(G,2);for(let yc of y)U.add(yc);for(let yc of G)U.add(yc);return U}hPa(a,b,c){const h=b&&c,m=b&&!c,y=!b&&!c;return!b&&c?(b=new kg,b.Mf=new ad.a(a.Zb-this.iB,a.Xb),b.Eg=new ad.a(a.Zb-this.iB,a.Xb+this.xg),this.Kv(b)):y?(b=new kg,b.Mf=new ad.a(a.hc-this.tO,a.Xb),b.Eg=new ad.a(a.hc-this.tO,a.Xb+this.xg),this.Kv(b)):h?(b=new kg,b.Mf=new ad.a(a.Zb,a.Xb-this.Y3),b.Eg=new ad.a(a.Zb+this.xg,
a.Xb-this.Y3),this.Kv(b)):m?(b=new kg,b.Mf=new ad.a(a.Zb,a.kc-this.yw),b.Eg=new ad.a(a.Zb+this.xg,a.kc-this.yw),this.Kv(b)):null}dPa(a,b,c,h,m){const y=b&&c,G=b&&!c,U=!b&&!c;return!b&&c?(m=new kg,m.cH=!0,m.Mf=new ad.a(h/2-this.tO,a.Xb+this.xg),m.Eg=new ad.a(a.Zb-this.iB,a.Xb+this.xg),this.Kv(m)):U?(m=new kg,m.cH=!0,m.Mf=new ad.a(h/2-this.tO,a.Xb+this.xg),m.Eg=new ad.a(a.hc-this.tO,a.Xb+this.xg),this.Kv(m)):y?(h=new kg,h.cH=!0,h.Mf=new ad.a(a.Zb+this.xg,m/2-this.yw),h.Eg=new ad.a(a.Zb+this.xg,a.Xb-
this.Y3),this.Kv(h)):G?(h=new kg,h.cH=!0,h.Mf=new ad.a(a.Zb+this.xg,m/2-this.yw),h.Eg=new ad.a(a.Zb+this.xg,a.kc-this.yw),this.Kv(h)):null}hbj(a,b,c,h,m,y){let G=Number.MAX_VALUE,U=Number.MAX_VALUE,ja=Number.MAX_VALUE,va=Number.MAX_VALUE,Ta=!0,fb=!0,Db=!0,gc=!0;y&&m&&(Ta=m.equals(ke.a.west)||m.equals(ke.a.Ku)||m.equals(ke.a.IH),fb=m.equals(ke.a.east)||m.equals(ke.a.yE)||m.equals(ke.a.RE),Db=m.equals(ke.a.north)||m.equals(ke.a.Ku)||m.equals(ke.a.yE),gc=m.equals(ke.a.south)||m.equals(ke.a.IH)||m.equals(ke.a.RE));
m=[];for(const hc of b)m.push(new zk.a(hc.ls()));b=this.Kq.Pm(c.me.width);c=this.Kq.Pm(c.me.height);for(const hc of m)hc.Zb>3*b/4&&hc.Zb<b&&a.hc<b/4&&0<a.hc&&this.mda(a,hc,!1)&&Ta&&(m=b-hc.Zb-a.hc,this.BT(m,h)&&Math.abs(m)<Math.abs(ja)&&(ja=m)),hc.hc<b/4&&0<hc.hc&&a.Zb>3*b/4&&a.Zb<b&&this.mda(a,hc,!1)&&fb&&(m=b-a.Zb-hc.hc,this.BT(m,h)&&Math.abs(m)<Math.abs(va)&&(va=m)),hc.Xb>3*c/4&&hc.Xb<c&&a.kc<c/4&&0<a.kc&&this.mda(a,hc,!0)&&Db&&(m=c-hc.Xb-a.kc,this.BT(m,h)&&Math.abs(m)<Math.abs(G)&&(G=m)),hc.kc<
c/4&&0<hc.kc&&a.Xb>3*c/4&&a.Xb<c&&this.mda(a,hc,!0)&&gc&&(m=c-a.Xb-hc.kc,this.BT(m,h)&&Math.abs(m)<Math.abs(U)&&(U=m));a=new yi.a;a.top=G===Number.MAX_VALUE?a.top:G;a.bottom=U===Number.MAX_VALUE?a.bottom:U;a.left=ja===Number.MAX_VALUE?a.left:ja;a.right=va===Number.MAX_VALUE?a.right:va;return a}s6a(a,b,c,h,m){const y=new Qa.a,G=new Qa.a,U=new Qa.a;var ja=!1,va=!1,Ta=!1,fb=!1,Db=!0;let gc=!0,hc=!0,Gc=!0;m&&h&&(Db=h.equals(ke.a.west)||h.equals(ke.a.Ku)||h.equals(ke.a.IH),gc=h.equals(ke.a.east)||h.equals(ke.a.yE)||
h.equals(ke.a.RE),hc=h.equals(ke.a.north)||h.equals(ke.a.Ku)||h.equals(ke.a.yE),Gc=h.equals(ke.a.south)||h.equals(ke.a.IH)||h.equals(ke.a.RE));h=this.Kq.Pm(c.me.width);c=this.Kq.Pm(c.me.height);for(const Pc of b)Pc.Zb>3*h/4&&Pc.Zb<h&&a.hc<h/4&&0<a.hc&&this.mda(a,Pc,!1)&&Db&&this.Bu(a.hc,h-Pc.Zb)&&(ja=!0,b=new kg,b.Mf=new ad.a(Pc.Zb-this.iB,Pc.Xb),b.Eg=new ad.a(Pc.Zb-this.iB,Pc.Xb+this.xg),y.add(this.Kv(b)),b=new kg,b.cH=!0,b.Mf=new ad.a(h-this.iB,Pc.Xb+this.xg),b.Eg=new ad.a(Pc.Zb-this.iB,Pc.Xb+this.xg),
G.add(this.Kv(b))),Pc.hc<h/4&&0<Pc.hc&&a.Zb>3*h/4&&a.hc<h&&this.mda(a,Pc,!1)&&gc&&this.Bu(h-a.Zb,Pc.hc)&&(va=!0,b=new kg,b.Mf=new ad.a(Pc.hc-this.tO,Pc.Xb),b.Eg=new ad.a(Pc.hc-this.tO,Pc.Xb+this.xg),y.add(this.Kv(b)),b=new kg,b.cH=!0,b.Mf=new ad.a(0-this.tO,Pc.Xb+this.xg),b.Eg=new ad.a(Pc.hc-this.tO,Pc.Xb+this.xg),G.add(this.Kv(b))),Pc.Xb>3*c/4&&Pc.Xb<c&&a.kc<c/4&&0<a.kc&&this.mda(a,Pc,!0)&&hc&&this.Bu(a.kc,c-Pc.Xb)&&(Ta=!0,b=new kg,b.Mf=new ad.a(Pc.Zb,Pc.Xb-this.Y3),b.Eg=new ad.a(Pc.Zb+this.xg,Pc.Xb-
this.Y3),y.add(this.Kv(b)),m=new kg,b.cH=!0,m.Mf=new ad.a(Pc.Zb+this.xg,Pc.Xb-this.Y3),m.Eg=new ad.a(Pc.Zb+this.xg,c-this.Y3),G.add(this.Kv(m))),Pc.kc<c/4&&0<Pc.kc&&a.Xb>3*c/4&&a.Xb<c&&this.mda(a,Pc,!0)&&Gc&&this.Bu(c-a.Xb,Pc.kc)&&(fb=!0,b=new kg,b.Mf=new ad.a(Pc.Zb,Pc.kc-this.yw),b.Eg=new ad.a(Pc.Zb+this.xg,Pc.kc-this.yw),y.add(this.Kv(b)),m=new kg,b.cH=!0,m.Mf=new ad.a(Pc.Zb+this.xg,0-this.yw),m.Eg=new ad.a(Pc.Zb+this.xg,Pc.kc-this.yw),G.add(this.Kv(m)));Ta&&(Ta=new kg,Ta.Mf=new ad.a(a.Zb,a.kc-
this.yw),Ta.Eg=new ad.a(a.Zb+this.xg,a.kc-this.yw),y.add(this.Kv(Ta)),Db=new kg,Ta.cH=!0,Db.Mf=new ad.a(a.Zb+this.xg,0-this.yw),Db.Eg=new ad.a(a.Zb+this.xg,a.kc-this.yw),G.add(this.Kv(Db)));fb&&(fb=new kg,fb.Mf=new ad.a(a.Zb,a.Xb-this.Y3),fb.Eg=new ad.a(a.Zb+this.xg,a.Xb-this.Y3),y.add(this.Kv(fb)),Ta=new kg,fb.cH=!0,Ta.Mf=new ad.a(a.Zb+this.xg,c-this.Y3),Ta.Eg=new ad.a(a.Zb+this.xg,a.Xb-this.Y3),G.add(this.Kv(Ta)));ja&&(ja=new kg,ja.Mf=new ad.a(a.hc-this.tO,a.Xb),ja.Eg=new ad.a(a.hc-this.tO,a.Xb+
this.xg),y.add(this.Kv(ja)),ja=new kg,ja.cH=!0,ja.Mf=new ad.a(0-this.tO,a.Xb+this.xg),ja.Eg=new ad.a(a.hc-this.tO,a.Xb+this.xg),G.add(this.Kv(ja)));va&&(va=new kg,va.Mf=new ad.a(a.Zb-this.iB,a.Xb),va.Eg=new ad.a(a.Zb-this.iB,a.Xb+this.xg),y.add(this.Kv(va)),va=new kg,va.cH=!0,va.Mf=new ad.a(h-this.iB,a.Xb+this.xg),va.Eg=new ad.a(a.Zb-this.iB,a.Xb+this.xg),G.add(this.Kv(va)));this.t0a(y,1);this.t0a(G,2);for(let Pc of y)U.add(Pc);for(let Pc of G)U.add(Pc);return U}Omi(a,b,c){var h=new kg;const m=new kg,
y=new kg,G=new kg,U=new kg,ja=new kg,va=new Qa.a;va.add(h);va.add(m);va.add(y);va.add(G);va.add(U);va.add(ja);this.t0a(va,0);this.pEj(h,m,y,G,U,ja,a);for(const Ta of b)this.c3(a.kc,Ta.kc,Ta.Xb,h,Ta),this.c3(a.Xb,Ta.kc,Ta.Xb,m,Ta),this.c3(a.hc,Ta.hc,Ta.Zb,y,Ta),this.c3(a.Zb,Ta.hc,Ta.Zb,G,Ta),this.AEb&&(this.c3(a.kc,Ta.Xf()._y,null,h,Ta),this.c3(a.Xb,Ta.Xf()._y,null,m,Ta),this.c3(a.hc,Ta.Xf()._x,null,y,Ta),this.c3(a.Zb,Ta.Xf()._x,null,G,Ta),this.c3(a.Xf()._y,Ta.kc,null,U,Ta),this.c3(a.Xf()._y,Ta.Xb,
null,U,Ta),this.c3(a.Xf()._x,Ta.hc,null,ja,Ta),this.c3(a.Xf()._x,Ta.Zb,null,ja,Ta)),this.c3(a.Xf()._y,Ta.Xf()._y,null,U,Ta),this.c3(a.Xf()._x,Ta.Xf()._x,null,ja,Ta);0<h.length()&&0<m.length()&&(this.AEb?(U.Mf=new ad.a(a.hc-this.xg,a.Xf()._y),U.Eg=U.Mf.copy()):U.reset());0<y.length()&&0<G.length()&&(this.AEb?(ja.Mf=new ad.a(a.Xf()._x,a.hc-this.tO),ja.Eg=ja.Mf.copy()):ja.reset());if(this.AEb&&c){b=this.Kq.Pm(c.me.width);c=this.Kq.Pm(c.me.height);if(this.Bu(a.kc,c/2)||Math.abs(a.kc)<=aj.n6a||this.Bu(a.kc,
c))h.Mf._x=Math.min(h.Mf._x,-1*this.xg),h.Eg._x=Math.max(h.Eg._x,b+this.xg);if(this.Bu(a.Xb,c/2)||Math.abs(a.Xb)<=aj.n6a||this.Bu(a.Xb,c))m.Mf._x=Math.min(m.Mf._x,-1*this.xg),m.Eg._x=Math.max(m.Eg._x,b+this.xg);if(this.Bu(a.Xf()._y,c/2)||Math.abs(a.Xf()._y)<=aj.n6a||this.Bu(a.Xf()._y,c))U.Mf._x=Math.min(U.Mf._x,-1*this.xg),U.Eg._x=Math.max(U.Eg._x,b+this.xg);if(this.Bu(a.Zb,b/2)||Math.abs(a.Zb)<=aj.n6a||this.Bu(a.Zb,b))G.Mf._y=Math.min(G.Mf._y,-1*this.xg),G.Eg._y=Math.max(G.Eg._y,c+this.xg);if(this.Bu(a.hc,
b/2)||Math.abs(a.hc)<=aj.n6a||this.Bu(a.hc,b))y.Mf._y=Math.min(y.Mf._y,-1*this.xg),y.Eg._y=Math.max(y.Eg._y,c+this.xg);if(this.Bu(a.Xf()._x,b/2)||Math.abs(a.Xf()._x)<=aj.n6a||this.Bu(a.Xf()._x,b))ja.Mf._y=Math.min(ja.Mf._y,-1*this.xg),ja.Eg._y=Math.max(ja.Eg._y,c+this.xg)}h=new Qa.a;for(let Ta of va)Ta.Mf&&0<Ta.length()&&(this.LRf(Ta,a),h.add(this.Kv(Ta)));return h}c3(a,b,c,h,m){(this.Bu(a,b)||this.Bu(a,c))&&this.LRf(h,m)}LRf(a,b){a.cH?(a.Mf._x=Math.min(a.Mf._x,b.hc-this.xg),a.Eg._x=Math.max(a.Eg._x,
b.Zb+this.xg)):(a.Mf._y=Math.min(a.Mf._y,b.kc-this.xg),a.Eg._y=Math.max(a.Eg._y,b.Xb+this.xg))}Kv(a){let b;(b=a.Mf).x=b.x+this.S7c;let c;(c=a.Mf).y=c.y+this.T7c;let h;(h=a.Eg).x=h.x+this.S7c;let m;(m=a.Eg).y=m.y+this.T7c;return a}Bu(a,b){var c=aj.n6a;return!!a&&!!b&&Math.abs(a-b)<=c}pEj(a,b,c,h,m,y,G){a.Mf=new ad.a(G.hc-this.xg,G.kc-this.yw);a.Eg=a.Mf.copy();a.cH=!0;b.Mf=new ad.a(G.hc-this.xg,G.Xb-this.Y3);b.Eg=b.Mf.copy();b.cH=!0;c.Mf=new ad.a(G.hc-this.tO,G.kc-this.xg);c.Eg=c.Mf.copy();h.Mf=new ad.a(G.Zb-
this.iB,G.kc-this.xg);h.Eg=h.Mf.copy();b=G.Xf();m.Mf=new ad.a(a.Mf._x-this.xg,b._y-this.yw);m.Eg=m.Mf.copy();m.cH=!0;y.Mf=new ad.a(b._x-this.xg,c.Mf._y-this.xg);y.Eg=y.Mf.copy()}t0a(a,b){for(let c of a)0===b?(c.color=Td.a.kui,c.dashStyle="4,4",c.w6b=0):1===b?(c.color=Td.a.jui,c.dashStyle="4,4",c.w6b=1):2===b&&(c.color=Td.a.zEf,c.dashStyle="4,4",c.w6b=2)}get q0g(){return this.S7c}set q0g(a){this.S7c=a}get r0g(){return this.T7c}set r0g(a){this.T7c=a}}aj.n6a=.4;aj.NHc=5;Object(n.a)(aj,"SmartGuideUtility",
null,[1360]);var xo=d(137),Dd=d(206),ch=d(167),Le=d(194);class km{constructor(a,b,c,h,m){this.CEb=this.DEb=this.xb=null;this.Vla=new Sys.UI.Bounds(0,0,0,0);this.vIa=1;this.Db=!1;this.Mg=a;this.Bi=b;this.qd=h;this.Kc=c;this.qd.VXb(Object(F.a)(this,this.onResize,"onResize"));m&&this.qd.lPa(Object(F.a)(this,this.I0,"onActiveSlideDomDisplayed"));this.Im()}get visible(){return!!this.xb&&this.Db}set visible(a){this.xb||this.Im();this.Db!==a&&(this.xb.Pd(a),this.Db=a)}gOf(a){this.CEb&&this.DEb.xa.removeChild(this.CEb.xa);
this.CEb=new Dd.a;let b=0;for(;b<a.length;b++){const c=a[b],h=new ch.a,m=km.gYj(km.Eeh(ad.a.scale(c.Mf,this.vIa,this.vIa)),km.Eeh(ad.a.scale(c.Eg,this.vIa,this.vIa)));h.ut(m);h.Su(this.eXf(c.color));h.roa(c.dashStyle);h.jr(1);this.CEb.appendChild(h);2===c.w6b&&this.XNi(m[0],m[1])}this.DEb.appendChild(this.CEb)}XNi(a,b){a._y===b._y?a._x<b._x?this.nHf(a,b):this.nHf(b,a):a._y>b._y?this.oHf(a,b):this.oHf(b,a)}nHf(a,b){const c=this.sAf(b._x-a._x);this.xKc([new ad.a(a._x,a._y),new ad.a(a._x+c,a._y-c/2),
new ad.a(a._x+c,a._y+c/2)]);this.xKc([new ad.a(b._x,b._y),new ad.a(b._x-c,b._y-c/2),new ad.a(b._x-c,b._y+c/2)])}oHf(a,b){const c=this.sAf(a._y-b._y);this.xKc([new ad.a(a._x,a._y),new ad.a(a._x-c/2,a._y-c),new ad.a(a._x+c/2,a._y-c)]);this.xKc([new ad.a(b._x,b._y),new ad.a(b._x-c/2,b._y+c),new ad.a(b._x+c/2,b._y+c)])}sAf(a){return Math.min(a,10)/2}xKc(a){const b=new ch.a,c=this.eXf(Td.a.zEf);b.ut(a);b.Su(c);b.jr(1);b.KE(c);b.Pd(!0);this.CEb.appendChild(b)}eXf(a){return this.Bi&&this.Bi.highContrastColors?
this.Bi.highContrastColors.foregroundTextColor:a}Im(){this.xb=new xo.a;this.xb.qr("SmartGuideView");this.xb.Yj(0);this.xb.Pd(!1);this.Mg.xa.appendChild(this.xb.xa);this.DEb=new Le.a;this.DEb.xa.style.overflow="visible";this.xb.appendChild(this.DEb);this.Ur(this.Kc.Ic)}onResize(a,b){b&&this.Ur(b.iG)}I0(a,b){b&&this.Ur(b.iG)}Ur(a){this.xb&&a&&a.me&&a===this.Kc.Ic&&(this.Vla.x!==a.me.x||this.Vla.y!==a.me.y||this.Vla.width!==a.me.width||this.Vla.height!==a.me.height)&&(this.Vla=new Sys.UI.Bounds(a.me.x,
a.me.y,a.me.width,a.me.height),this.xb.setPosition(a.me.x,a.me.y),this.DEb.ih(a.me.width,a.me.height),this.xb.ih(a.me.width,a.me.height))}static gYj(a,b){b._y===a._y||Math.abs(b._y-a._y)%2||(b._y+=1);b._x===a._x||Math.abs(b._x-a._x)%2||(b._x+=1);return[a,b]}static Eeh(a){return new ad.a(Math.floor(a.x)+.5,Math.floor(a.y)+.5)}}Object(n.a)(km,"SmartGuideView",null,[1359]);class ze{setPosition(a,b,c){a.setPosition(a.x+b,a.y+c,!0)}setOffsets(a,b){a.setOffsets(yi.a.add(a.vYa,b),!0)}yI(a){return new zk.a(a.ls())}gG(a){return!a.shapeNode.Yx}}
Object(n.a)(ze,"DefaultShapeMoveResizeHandler",null,[715]);class Hn{constructor(){this.K=null}get name(){return"PowerPointWebEditor.SmartGuide"}$b(a){this.K=a;this.K.register(1358,"PowerPointWebEditor.ISmartGuideManager").ma().oa(()=>new nk(this.K.resolve("PowerPointWebEditor.ISmartGuideView"),this.K.resolve("PowerPointWebEditor.IPPTUnitConversion"),this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.K.resolve("PowerPointWebEditor.ISmartGuideUtility"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptoSmartGuidesMarginCenterEquisizing));
this.K.register(1359,"PowerPointWebEditor.ISmartGuideView").ma().oa(()=>new km(this.K.resolve("PowerPointWebEditor.ISlidePane"),this.K.resolve("Common.Utils.IHighContrastDetector"),this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").rua));this.K.register(1360,"PowerPointWebEditor.ISmartGuideUtility").ma().oa(()=>new aj(this.K.resolve("PowerPointWebEditor.IPPTUnitConversion"),
this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptoSmartGuidesAlignToSlideAndCenterEdge))}init(){this.K.resolve("PowerPointWebEditor.ISmartGuideUtility").addHandler(new ze)}dispose(){}static main(){r.a.instance.Dc(new Hn)}}Object(n.a)(Hn,"PPTWebEditorSmartGuidePackage",null,[2,3]);class ci{}ci.Rng=[D.a.backspace,D.a.Ctb,D.a.TK,D.a.$0b,D.a.JCa,D.a.enter,D.a.Iod,D.a.rB,D.a.tab,D.a.eqc,D.a.pageDown,D.a.pageUp,D.a.mYa,D.a.eDe,D.a.lYa,D.a.dDe];ci.l_j=[D.a.backspace,D.a.Ctb,D.a.TK,D.a.$0b,D.a.JCa,
D.a.enter,D.a.Iod,D.a.rB,D.a.tab,D.a.eqc,D.a.font,D.a.A5,D.a.jKa,D.a.ir,D.a.AJa,D.a.e_a,D.a.DI,D.a.UJ,D.a.bold,D.a.setItalic,D.a.underline,D.a.strikethrough,D.a.Ls,D.a.Q5,D.a.Kra,D.a.jP,D.a.NR,D.a.MD,D.a.qz,D.a.Iia,D.a.Uka,D.a.eoa,D.a.yDa,M.a.una,M.a.S0,M.a.R0,M.a.Q0,D.a.LCa,D.a.ika,D.a.Vya,D.a.Wya,D.a.Xya,D.a.qLa,D.a.rLa,D.a.Y7b,D.a.Z7b,D.a.L$a,D.a.NTa,D.a.QTa,D.a.Pta,D.a.Y7,M.a.BHb,D.a.deleteRow,M.a.olc,D.a.ICa,M.a.bhd,D.a.insertTable,M.a.HJe,D.a.MZ,D.a.LZ,M.a.y5,M.a.xJa,M.a.R_a,M.a.JKa,M.a.soa,
M.a.KKa,M.a.Wpd,M.a.Vpd,D.a.sM,D.a.STa,D.a.centerJustify,D.a.leftJustify,D.a.rightJustify,D.a.fullJustify,D.a.M1b,D.a.J$b,D.a.Jpc,M.a.akb,M.a.bkb,M.a.ckb,M.a.dkb,D.a.$Yb];ci.q2k=[D.a.leftArrow,D.a.rightArrow,D.a.upArrow,D.a.downArrow,D.a.Y_a,D.a.X_a,D.a.ACa,D.a.zCa,D.a.IQa,D.a.HQa,D.a.KLb,D.a.Ljb,D.a.a1b,D.a.Dtb,D.a.j7a,D.a.GQa,D.a.mYa,D.a.FRa,D.a.Ofb,D.a.Nfb,D.a.d8a,D.a.lYa,D.a.ERa,D.a.c8a,D.a.Bsa,D.a.Jod,M.a.Poc,M.a.iOb,M.a.g0a,M.a.pMb];Object(n.a)(ci,"ActionIdList",null,[]);class Og{constructor(){this.ActionTime=
this.ActionName=this.ActionId=null}}Object(n.a)(Og,"ActionInformation",null,[]);class qn{constructor(a,b,c,h,m,y){this.Bbb=[];this.Pac=[];this.YI=a;this.Kne=b||[];this.ia=c;this.ia.Lna(this);this.Xa=h;this.zX=m;this.jH=y}N$(a){this.duh(a)&&this.yoa(a.actionId)&&(this.Bbb.push(a.actionId),this.Pac.push(Date.now()))}M$(a){this.duh(a)&&this.yoa(a.actionId)&&(this.Bbb.pop(),this.Pac.pop())}yoa(a){if(Array.contains(this.Kne,a))return!0;a=this.ia.$S(a);return!!a&&!(a.flags[32]||a.flags[64])}duh(a){return 2===
a.behavior&&a.Oi?!0:!1}getCommandName(a,b=""){return(a=this.YI?this.YI.I5(a):null)?a:b}dY(a){a&&a.dsa&&Ba.a.J(23594504,822,50,"ClientRevisionId:{0}, ActionName:{1}, PodSID:{2}, UndoAction:{3}",a.dsa.toString(),this.actionName||(this.zX.jd===D.a.typing||this.zX.jd===D.a.QBa||this.zX.jd===D.a.WQa?"Typing":null)||(this.jH.KXc?"ClosingTextUndoStack":""),this.Xa.podSessionId||"",this.YI.I5(this.zX.jd));return!!this.Bbb.length}update(a,b){a=new Og;a.ActionId=this.X0f();a.ActionName=this.Y0f();a.ActionTime=
this.eaj().toString();vg.a.Co(b,X.a.h3h,a);b.setValue(X.a.Q7b,!0);b.setValue(X.a.lld,1)}get actionName(){return this.Y0f()}get actionId(){return this.X0f()}x6d(){return this.Bbb[this.Bbb.length-1]}X0f(){return this.Bbb.length?this.x6d().toString():null}Y0f(){return this.Bbb.length?this.getCommandName(this.x6d(),this.x6d().toString()):null}eaj(){return this.Pac.length?this.Pac[this.Pac.length-1]:Number.MAX_VALUE}}Object(n.a)(qn,"ActionInfoRevisionMetaDataUpdater",null,[1393,141]);class tm{constructor(){this.va=
new bd.a}weh(a){this.va.raiseEvent("UCI",a)}zai(a){this.va.addHandler("UCI",a)}mVk(a){this.va.removeHandler("UCI",a)}}Object(n.a)(tm,"CcpEventSource",null,[1452,1453,1454]);class um{constructor(a,b){this.sbc=this.Uoe=this.Toe=null;this.Voe=a;this.lU=b;this.Voe.zai(Object(F.a)(this,this.M1g,"onCcpPropertyChanged"))}M1g(a,b){this.Toe=b.Gp;this.Uoe=b.Poi;this.sbc=b.Qoi}dY(a){a=this.lU.YDa(a.Uxa);!this.sbc&&a.Sa(X.a.J6a)&&(a.removeProperty(X.a.lN),a.removeProperty(X.a.YP),a.removeProperty(X.a.J6a));return!!this.sbc}update(a,
b){b.setValue(X.a.lN,this.Toe);b.setValue(X.a.YP,this.Uoe);b.setValue(X.a.J6a,this.sbc);this.sbc=this.Uoe=this.Toe=null}dispose(){this.Voe&&this.Voe.mVk(Object(F.a)(this,this.M1g,"onCcpPropertyChanged"))}}Object(n.a)(um,"CcpInfoRevisionMetaDataUpdater",null,[1366,1393,106]);var yo=d(320);class zo extends Vf.a{constructor(a,b,c,h,m,y,G){super();this.ShapeId=this.Sid=this.Cid=0;this.FetchImageData=!1;this.AuthToken=this.Origin=this.SessionUrl=null;this.Cid=a;this.Sid=b;this.ShapeId=c;this.FetchImageData=
h;this.SessionUrl=m;this.Origin=y;this.AuthToken=G}$k(){return 108}}Object(n.a)(zo,"AugmentImageRequest",Vf.a,[]);class Wm extends Vf.a{constructor(){super()}$k(){return 81}}Object(n.a)(Wm,"FlushRequest",Vf.a,[]);class pk extends Vf.a{constructor(a,b,c,h,m,y){super();this.AgendaSid=this.AgendaCid=0;this.Hints=this.DeckSuggestionId=this.SessionId=this.CorrelationId=null;this.AgendaCid=a;this.AgendaSid=b;this.CorrelationId=c;this.SessionId=h;this.DeckSuggestionId=m;this.Hints=y}$k(){return 111}}Object(n.a)(pk,
"GenerateAgendaDeckSuggestionRequest",Vf.a,[]);class ll extends Vf.a{constructor(a,b,c,h,m){super();this.AgendaSid=this.AgendaCid=0;this.Hints=this.OutlineJson=this.CorrelationId=null;this.AgendaCid=a;this.AgendaSid=b;this.CorrelationId=c;this.OutlineJson=h;this.Hints=m}$k(){return 110}}Object(n.a)(ll,"GenerateAgendaSuggestionRequest",Vf.a,[]);class Wl extends Vf.a{constructor(a,b,c,h,m,y,G,U,ja,va){super();this.ShapeViewHeight=this.ShapeViewWidth=this.ShapeId=this.Sid=this.Cid=0;this.SubNodeId=null;
this.SubNodeHeight=this.SubNodeWidth=0;this.Trigger=this.CorrelationId=null;this.Cid=a;this.Sid=b;this.ShapeId=c;this.ShapeViewWidth=h;this.ShapeViewHeight=m;this.SubNodeId=y;this.SubNodeWidth=G;this.SubNodeHeight=U;this.CorrelationId=ja;this.Trigger=va}$k(){return 99}}Object(n.a)(Wl,"GenerateIconSuggestionRequest",Vf.a,[]);class $g extends Vf.a{constructor(a,b,c,h){super();this.ImageKey=this.GraphNodeId=null;this.IsGenerateSuggestion=this.IsSVGBlipFill=!1;this.GraphNodeId=hm.a(a);this.ImageKey=b;
this.IsSVGBlipFill=c;this.IsGenerateSuggestion=h}$k(){return 91}}Object(n.a)($g,"GenerateImageDescriptionRequest",Vf.a,[]);class vm extends Vf.a{constructor(a,b,c,h,m,y,G){super();this.Sid=this.Cid=0;this.Hints=this.LastShownCorrelationId=this.Trigger=this.TermCorrelationId=this.CorrelationId=null;this.Cid=a;this.Sid=b;this.CorrelationId=c;this.TermCorrelationId=h;this.Trigger=m;this.LastShownCorrelationId=y;this.Hints=G}$k(){return 66}}Object(n.a)(vm,"GenerateSuggestionRequest",Vf.a,[]);class Th extends vm{constructor(a,
b,c,h,m,y,G,U){super(a,b,h,null,m,y,"");this.ShapeViewHeight=this.ShapeViewWidth=this.ShapeId=0;this.ShapeId=c;this.ShapeViewWidth=G;this.ShapeViewHeight=U}$k(){return 83}}Object(n.a)(Th,"GenerateReplaceObjectRequest",vm,[]);class Xl extends Vf.a{constructor(a,b,c){super();this.m_shapeid=this.m_cid=this.m_slideid=0;this.m_slideid=a;this.m_cid=b;this.m_shapeid=c}$k(){return 57}}Object(n.a)(Xl,"GetPictureCropInfoRequest",Vf.a,[]);class Ol extends Vf.a{constructor(){super();this.SlideCid=this.SlideSid=
this.Scenario=0;this.ShapeIds=null}$k(){return 109}}Object(n.a)(Ol,"ImageTransformRequest",Vf.a,[]);class Re extends Vf.a{constructor(a,b){super();this.JsonString=this.CorrelationId=null;this.CorrelationId=a;this.JsonString=b}$k(){return 84}}Object(n.a)(Re,"ReportReplaceObjectInfoRequest",Vf.a,[]);class qk extends Vf.a{constructor(a,b){super();this.JsonString=this.CorrelationId=null;this.CorrelationId=a;this.JsonString=b}$k(){return 67}}Object(n.a)(qk,"ReportSuggestionSessionInfoRequest",Vf.a,[]);
class qj extends Vf.a{constructor(a,b,c){super();this.SlideId=null;this.ShapeId=0;this.Base64OfSnapshot=null;this.SlideId=a;this.ShapeId=b;this.Base64OfSnapshot=c}$k(){return 59}}Object(n.a)(qj,"UpdateContentAddinSnapshotInfoRequest",Vf.a,[]);class ml{constructor(a,b,c){this.jH=a;this.Vb=b;this.bsg=c}get KXc(){return this.jH.KXc}N6a(a,b=!1){this.jH.N6a(a,b)}forceOutbound(){this.jH.forceOutbound()}Mfa(a,b,c=!1){this.jH.Mfa(a,b,c)}dFc(a){this.jH.dFc(a)}jwb(a){return this.jH.jwb(a)}Eb(a){this.jH.Eb(a)}J2f(a,
b,c,h=null,m=null,y=!1){a=new Rh.a(new Xl(a,b,c),h,m,G=>0===G.StatusCode);this.jH.Mfa(a,this.Vb,y)}Fja(a,b,c,h,m,y,G,U=null,ja=null){a=new Rh.a(new vm(a,b,c,h,m,y,G),U,ja,va=>0===va.StatusCode);this.jH.Mfa(a,this.Vb)}generateImageDescription(a,b,c,h){a=new Rh.a(new $g(a,b,c,h),null,null,m=>0===m.StatusCode);this.jH.Mfa(a,this.Vb)}Zna(a,b,c){a=new Rh.a(new qk(a,b),null,()=>!0,h=>0===h.StatusCode);this.jH.Mfa(a,this.Vb,c)}MWf(a,b,c,h,m,y,G,U=null,ja=null){a=new Rh.a(new Th(a,b,c,h,m,null,y,G),U,ja,
va=>0===va.StatusCode);this.jH.Mfa(a,this.Vb)}UWk(a,b,c=null,h=null){a=new Rh.a(new Re(a,b),c,h,m=>0===m.StatusCode);this.jH.Mfa(a,this.Vb)}s0i(a,b,c,h,m,y,G,U,ja=null,va=null){a=new Rh.a(new Wl(a,b,c,h,m,y,74,74,G,U),ja,va,Ta=>0===Ta.StatusCode);this.jH.Mfa(a,this.Vb)}augmentImage(a,b,c,h,m,y,G,U=null,ja=null){a=new Rh.a(new zo(a,b,c,h,m,y,G),U,ja,va=>0===va.StatusCode);this.jH.Mfa(a,this.Vb)}generateAgendaSuggestion(a,b,c,h,m,y=null,G=null){a=new Rh.a(new ll(a,b,c,h,m),y,G,U=>0===U.StatusCode);
this.jH.Mfa(a,this.Vb)}generateAgendaDeckSuggestion(a,b,c,h,m,y,G=null,U=null){a=new Rh.a(new pk(a,b,c,h,m,y),G,U,ja=>0===ja.StatusCode);this.jH.Mfa(a,this.Vb)}EFh(a,b,c,h=null,m=null){const y=new Rh.a(new qj(a,b,c),h,m,ja=>0===ja.StatusCode),G=()=>{this.rSi(y)};a=this.jH.jwb(this.Vb.Cf);const U=new yo.a;a?a.forceOutbound(()=>{G()},m?()=>{m(U)}:null,null):(Ba.a.J(20460503,823,10,"Can't find graph space replicator when trying to do outbound"),m&&m(U))}flush(a=null,b=null){a=new Rh.a(new Wm,a,b,c=>
0===c.StatusCode,3);this.jH.Asa(a)}Asa(a){this.jH.Asa(a)}iRc(){return this.jwb(this.Vb.Cf)}rSi(a){this.bsg.Eb(a);this.bsg.forceOutbound(null,null,null)}}Object(n.a)(ml,"OutboundHelper",null,[1363,18,1398]);var vi=d(258),zi=d(166);class pp{constructor(a,b,c,h,m){this.VL=[];this.Edb=new vi.a;this.ead=null;this.wpg=[];this.J4=null;this.va=new bd.a;this.awg=this.fDb=this.H$c=!1;this.Sb=a;this.la=b;this.ua=c;this.$ak=m;this.Eva=h;this.N9j=this.la.kua?1:4;h.ik(Object(F.a)(this,this.led,"onMainMastersLoaded"));
this.la.kua&&h.ik(Object(F.a)(this,this.a4g,"onMasterIdListChanged"))}get Pfk(){if(this.la.kua&&this.ua.Ba){const a=this.ua.Ba.hj;a&&Array.contains(this.VL,a)&&this.$Ce(a)}return this.VL.slice(0,Math.min(this.N9j,this.VL.length))}mSk(a){Array.remove(this.VL,a)}get jol(){return this.ead}get KO(){return this.Edb}get oXb(){return this.wpg}get GAj(){return!this.ead}get ozk(){return 0<this.VL.length&&(!this.la.IUa||this.H$c)}get wDe(){return this.fDb}set wDe(a){this.fDb=a}Qkl(a){a&&this.nDh(a.hj)}wxh(){this.H$c=
!0;this.Ejd(!0);this.eKb()}nDh(a){this.H$c=!0;a&&(Array.remove(this.VL,a),Array.insert(this.VL,0,a));this.eKb()}kYe(a){this.la.kua?this.nDh(a):this.wxh()}v1f(a){if(!a||!this.Edb)return null;a=a.hj;if(!a)return null;let b=null;return({value:b}=this.Edb.Uf(a)).returnValue?b:null}a4g(a,b){b.property.id===X.a.qbd.id&&(Ba.a.J(38847373,824,50,"MasterIdList update, need load master id list: {0}",this.fDb),this.fDb&&(this.fDb=!1,this.H$c&&(this.Ejd(!1),this.eKb())),this.nCf())}led(a,b){a=b.property;if(this.la.kua)if(a.id===
X.a.kFb.id){a=this.Sb.aaj();const h=this.Sb.xI();if(h&&h.length)if(a&&a.length){for(var c=b=0;b<a.length&&c<h.length;){const m=a[b],y=h[c];m.Id<y.Id?(this.HFh(m.Id),b++):y.Id<m.Id?(this.W2e(y.Id),c++):(dd.c(m)!==dd.c(y)&&this.eyl(y.Id),c++,b++)}if(c<h.length)for(;c<h.length;c++)this.W2e(h[c].Id);if(b<a.length)for(;b<a.length;b++)this.HFh(a[b].Id);this.eKb()}else zi.b(h,null,m=>{this.W2e(m.Id)})}else a.id===X.a.xY.id&&(Ba.a.J(38847375,824,50,"Slide size changed, need to reload the resources."),this.Ejd(!0),
this.eKb());else if(a.id===X.a.kFb.id||a.id===X.a.xY.id)Ba.a.J(19240846,824,50,"MainMasters are reloaded, need to reload the resources"),this.Ejd(!0),this.eKb()}W2e(a){this.$Ce(a)}eyl(a){this.$Ce(a)}$Ce(a){Array.contains(this.VL,a)&&Array.remove(this.VL,a);Array.insert(this.VL,0,a)}HFh(a){this.Edb.remove(a);-1!==Array.indexOf(this.VL,a)&&Array.remove(this.VL,a)}eKb(){this.J4=this.J4||this.$ak(this);this.J4.yF(null,null,null)}Ejd(a){if(this.la.kua){Ba.a.J(38847378,824,50,"RefreshMastersToLoad, need clean cache: {0} ",
a);var b=this.Sb.Cvb();a&&(Array.clear(this.VL),this.clearCache());if(b&&0<b.length)for(const c of b)-1===Array.indexOf(this.VL,c.idField)&&Array.add(this.VL,c.idField);else this.fDb=!0,(a=this.Sb.mC(0))&&(a=a.hj)&&Array.add(this.VL,a)}else if(a=this.Sb.xI(),Array.clear(this.VL),this.clearCache(),a)for(b of a)this.Edb.remove(b.Id),-1===Array.indexOf(this.VL,b.Id)&&Array.add(this.VL,b.Id)}iqk(a){if(a){for(const b of a)b&&(Ba.a.J(38847381,824,50,"PresentationResourcesManager::OnMainMasterResoucesLoaded master {0} resources loaded.",
b.MasterId),this.Edb.$(b.MasterId,b),this.ead=this.ead||b.TableStyleGallery,this.la.kua||Array.remove(this.VL,b.MasterId));this.nCf();this.va.raiseEvent("MainMasterResourcesLoaded")}else Ba.a.J(19240848,824,10,"PresentationResourcesManager::OnMainMasterResoucesLoaded mainMasterResouces returned is null")}nCf(){!this.awg&&this.twf()&&(this.awg=!0,Ba.a.J(38892514,824,50,"PresentationResourcesManager::CheckFirstMasterRetrieved first master retrieved."),Rd.a("RaiseFirstMasterRetrievedEvent")&&this.va.raiseEvent("FirstMasterRetrieved"))}olk(a){this.la.powerPointEnableAccCheck&&
(a&&a.length?(this.wpg=a,this.va.raiseEvent("AccCheckRuleInfoListLoaded")):Ba.a.J(19240850,824,10,"PresentationResourcesManager::OnAccRuleInfoListLoaded accRuleInfoList returned is null as acc-checker is enabled"))}twf(){if(!this.la.kua)return!0;const a=this.Sb.Cvb();if(a&&0<a.length)for(const b of this.Sb.Cvb())if(0<b.layoutCountField&&this.KO.Hb(b.idField)&&this.KO.ga(b.idField).LayoutIcons.length===b.layoutCountField)return Ba.a.J(38892545,813,50,"LayoutDialogReady: master ID: {0}, layout count: {1}",
b.idField,b.layoutCountField),!0;return!1}MFc(a){this.va.addHandler("MainMasterResourcesLoaded",a)}YTk(a){this.va.removeHandler("MainMasterResourcesLoaded",a)}n9h(a){this.va.addHandler("FirstMasterRetrieved",a)}K8h(a){this.va.addHandler("AccCheckRuleInfoListLoaded",a)}vTk(a){this.va.removeHandler("AccCheckRuleInfoListLoaded",a)}clearCache(){this.Edb=new vi.a}dispose(){this.Eva.Cm(Object(F.a)(this,this.led,"onMainMastersLoaded"));this.la.kua&&this.Eva.Cm(Object(F.a)(this,this.a4g,"onMasterIdListChanged"));
this.va.dispose();this.J4&&this.J4.dispose()}}Object(n.a)(pp,"PresentationResourcesManager",null,[1365,106]);var Xh=d(384);class Yl extends Vf.a{constructor(){super();this.MasterIds=null;this.NeedLoadingMasterIdList=this.IncludeTableStyle=!1}$k(){return 52}static fVd(a,b,c){const h=new Yl;h.MasterIds=a;h.IncludeTableStyle=b;h.NeedLoadingMasterIdList=c;return h}}Object(n.a)(Yl,"GetEditPresResourcesRequest",Vf.a,[]);class Kp extends Xh.a{constructor(a,b,c,h){super();this.aBb=0;this.aeb=this.h4=!1;this.Lm=
a;this.iXa=b;this.vO=h;this.enabled=2;this.Cw=c.hCi();this.Lm.register(this)}yF(){this.Cw.uZi();this.Cw.D$a();this.Lm.kaa()}forceOutbound(){}dka(){return this.iXa.ozk||this.iXa.wDe}IN(){return!1}sTa(){return this.Ud&&2===this.Ud.status?!0:this.h4||this.aeb?!1:this.dka()&&this.Cw.Z6b()}IJb(){if(1===this._state){var a=this.iXa.Pfk;this.Ud.DH=Yl.fVd(a,this.iXa.GAj,this.iXa.wDe);for(const b of a)this.iXa.mSk(b);this.Ud.status=1;this._state=3}else 3===this._state&&this.Ud&&2===this.Ud.status&&(this.aeb?
(this._state=4,this.dispose()):(200===this.Ud.tv&&this.vO.Vnc(),this.Cw.ULa(),2!==this.Ud.statusCode?this.xH():this.Ud.Or&&1===this.Ud.Or.length?(a=this.Ud.Or[0],0===a.StatusCode?(this.iXa.iqk(dd.a(a.MainMasterResources)),this.iXa.olk(dd.a(a.AccRuleInfoList)),this.K0()):this.xH()):this.xH()))}get wca(){return this.dka()?this.Cw.rib():super.wca}dispose(){1===this._state||4===this._state?(this.h4||this.Lm.unregister(this),this.h4=!0):this.aeb=!0}K0(){this.aBb=0;this._state=1;this.dka()||this.Cw.h0a()}xH(){4<
++this.aBb?(this._state=4,Ba.a.J(19240853,824,10,"PresentationResourcesReplicator quit after {0} failures",this.aBb)):(Ba.a.J(19240855,824,15,"PresentationResourcesReplicator will retry on failure"),this._state=1)}}Object(n.a)(Kp,"PresentationResourcesReplicator",Xh.a,[106]);class al{constructor(a,b){this.lbk=a;this.lU=b}esk(a){if(!a)throw Error.argumentNull("dataStorePusher is null!");const b=a.Uxa;let c=null,h=!1;for(const m of this.lbk)if(m.dY(a)){if(!c&&(c=this.lU.YDa(b),!c)){Ba.a.J(23594507,
817,50,"revisionMetadata is null");return}m.update(a,c);h=!0}h&&this.lU.yNd(b,a,c)}}Object(n.a)(al,"RevisionMetaDataUpdateListener",null,[1367]);var bj=d(407);class Pl{YDa(a){if(!a)return null;const b=a.gL(4);return b&&!b.equals(pa.a.nil)?a.ye(b):new bj.a}f3e(a,b,c,h,m,y,G,U,ja){if(a&&h){a.ao.apply(a,Pl.M_k);a.setValue(X.a.Lig,b);a.setValue(X.a.Q7b,!0);a.setValue(X.a.lld,1);a.setValue(X.a.sid,h.sid);a.setValue(X.a.cid,h.cid);c&&a.setValue(X.a.hFa,!0);m&&a.setValue(X.a.shapeId,m.get_shapeId());y&&
(a.setValue(X.a.aq,!0),a.setValue(X.a.Mzh,y.cellId),a.setValue(X.a.rowId,y.rowId));if(G&&0<G.length){b=G.length;c=Array(b);h=Array(b);for(m=0;m<b;m++)c[m]=G[m].rowId,h[m]=G[m].cellId;a.setValue(X.a.aq,!0);a.setValue(X.a.Dkb,h);a.setValue(X.a.Zzh,c)}a.setValue(X.a.E_e,U);a.setValue(X.a.D_e,ja)}}yNd(a,b,c){if(a&&b&&c){var h=!1;a.ye(Pl.Hfa)||(a.CE(c,Pl.Hfa),h=!0);b.ara(c);h&&b.nya(c.id,4)}}QGh(a,b){if(a){var c=a.Uxa,h=this.YDa(c);h.setValue(X.a.lld,b);this.yNd(c,a,h)}}Zzl(a){if(a){var b=a.Uxa,c=this.YDa(b);
c.setValue(X.a.yZk,0);this.yNd(b,a,c)}}}Pl.Hfa=pa.a.Hf("{B3AB583C-77CD-428D-9371-02C2EA7C058B}{1}");Pl.M_k=[X.a.Lig,X.a.shapeId,X.a.aq,X.a.hFa,X.a.Mzh,X.a.rowId,X.a.Dkb,X.a.Zzh,X.a.E_e,X.a.D_e];Object(n.a)(Pl,"RevisionMetadataHelper",null,[1394]);var bl=d(655),Wo=d(843);class rn extends Vf.a{constructor(a,b,c,h){super();this.ShouldWaitForSave=this.ShouldReleaseLock=!1;this.SessionCloseReason=0;this.SessionKey=null;this.ShouldReleaseLock=a;this.ShouldWaitForSave=b;this.SessionCloseReason=c;this.SessionKey=
h}$k(){return 32}}Object(n.a)(rn,"SaveAndCloseRequest",Vf.a,[]);class Xm{constructor(a,b,c,h,m,y,G,U,ja){this.vi=a;this.M9c=b;this.BC=c;this.Xa=h;this.la=m;this.kB=y;this.Qd=G;this.mc=U;this.Lm=ja}wZi(a){this.Xa.xzb=!0;a=new rn(!0,!1,a,this.Xa.podSessionId);this.Qd.hka=!0;const b=this.vi.iRc();b&&b.IN()&&this.mc.Fn?this.la.ECa?(ba.ULS.sendTraceTag(509436876,844,50,"SaveAndCloseHandler: forceSaveOnUnload - application is unloading, forceOutbound to save any remaining changes."),b.forceOutbound(null,
null,null),this.M9c.O0d(a,null,null)):b.E8a(null,null,null,a):this.M9c.O0d(a,null,null)}j3(a=!1,b=!0,c=null,h=null,m=1){Ba.a.J(509691458,823,50,"SaveAndCloseHandler::ForceSave Start, fReleaseLock: {0}, fWaitForSave: {1}, fSaveToHost: {2}",a,!0,b);const y=new rn(a,!0,m,this.Xa.podSessionId);if(a&&this.la.markSessionClosingAtForceSave)this.kB.markSessionClosingAtForceSave(m),this.Lm.pause(),this.M9c.E8a(y,G=>{Ba.a.J(509691457,823,50,"SaveAndCloseHandler::ForceSave Succeeded. Closing session");this.la.IRf?
this.kB.closeSession(m):this.BC.jjd(new bl.a(m));c(G)},()=>{Ba.a.J(509691456,823,15,"SaveAndCloseHandler::ForceSave Failed.");this.Lm.olb();h&&h(null);return!0});else{a=this.vi.iRc();const G=U=>{this.Fok(y,c,h,ja=>0===ja.StatusCode,U,b,m)};a?a.forceOutbound(()=>{G(!0)},()=>{G(!1)},null):(Ba.a.J(509691427,823,10,"Can't find graph space replicator when trying to do outbound"),G(!1))}}Fok(a,b,c,h,m,y,G){Ba.a.J(509691426,823,50,"SaveAndCloseHandler::OnForceSaveOutboundComplete Start, fReleaseLock: {0}, fOutboundSuccess: {1}, fSaveToHost: {2}",
a.ShouldReleaseLock,m,y);m&&y||a.ShouldReleaseLock?(a.ShouldReleaseLock&&(this.Qd.hka=!0),this.M9c.Asa(a,U=>{a.ShouldReleaseLock&&(this.la.IRf?this.kB.closeSession(G):this.BC.jjd(new bl.a(G)));b(U)},c,h)):m&&b?b(new Wo.a):!m&&c&&c(new yo.a)}}Object(n.a)(Xm,"SaveAndCloseHandler",null,[1364]);var ho=d(1015),li=d(100);class xe{constructor(a,b,c,h){this.vi=a;this.fBe=b;this.ahc=c;this.vwa=h}dY(a){let b=null,c=!0;if(this.vi.KXc)b=a.dsa,c=!1;else if(this.fBe.jd===D.a.typing||this.fBe.jd===D.a.QBa||this.fBe.jd===
D.a.WQa)b=a.dsa;b&&(this.vwa&&this.IGi(b.toString()),Nc.a.cbb(),this.ahc.WBh(b,c),Ba.a.J(23594510,822,50,"ClientRevisionId:{0}, GenerateTime:{1}",a.dsa.toString(),Nc.a.nf(new Date)));return!1}update(){}IGi(a){const b=new ho.ActionContext(li.a.kEh,1,null);b.Nj=!0;b.pF=new Date;b.Va(li.a.zY,Nc.a.D9a(a).toString());b.Qr=!0;Nc.a.zfa(b)}}Object(n.a)(xe,"TextEditingRevisionInfoMetaDataUpdater",null,[1393]);class sn{constructor(){this.K=null}get name(){return"PowerPointWebEditor.Storage"}$b(a){this.K=a;
const b=()=>new ih.a(a.resolve("Box4.IReplicationScheduler"),a.resolve("PowerPointWebEditor.IErrorHandler"),a.resolve("PowerPointWebEditor.Core.IPPTServerResponseHelper"),a.resolve("PowerPointWebEditor.IReplicationTimerFactory").M0b(a.resolve("Box4.IReplicationParameters")),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),()=>u.AFrameworkApplication.Tg);a.register(1363,"PowerPointWebEditor.Storage.IOutboundHelper").ma().oa(()=>new ml(a.resolve("PowerPointWebEditor.BootStorage.ICoreOutboundHelper"),
a.resolve("PowerPointWebEditor.IPPTWorkspaceGraph"),b()));a.register(1364,"PowerPointWebEditor.Storage.ISaveAndCloseHandler").ma().oa(()=>new Xm(a.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),a.resolve("PowerPointWebEditor.BootStorage.ISaveAndCloseTaskExecutor"),a.resolve("PowerPointWebEditor.Core.ICoreEventNotifier"),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.ISessionLifetimeManager"),a.resolve("PowerPointWebEditor.IErrorHandler"),
a.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),a.resolve("Box4.IReplicationScheduler")));a.register(1365,"PowerPointWebEditor.IPresentationResourcesManager").ma().oa(()=>new pp(a.resolve("PowerPointWebEditor.IPresentationReader"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("Box4.Graph.IGraphInstance").Ad(7),c=>new Kp(a.resolve("PowerPointWebEditor.BootStorage.IBackgroundReplicationScheduler"),c,a.resolve("PowerPointWebEditor.IReplicationTimerFactory"),
this.K.resolve("PowerPointWebEditor.Core.INetworkHealthManager"))));this.gxi()}gxi(){this.K.register(Pl,"PowerPointWebEditor.RevisionMetadataHelper").as("PowerPointWebEditor.IRevisionMetadataHelper").ma();this.K.register(tm,"PowerPointWebEditor.CcpEventSource").as("PowerPointWebEditor.ICcpEventSource").as("PowerPointWebEditor.ICcpEventNotifier").as("PowerPointWebEditor.ICcpEventHandlers").ma();this.K.register(1366,"PowerPointWebEditor.ICcpInfoRevisionMetaDataUpdater").ma().oa(()=>new um(this.K.resolve("PowerPointWebEditor.ICcpEventHandlers"),
this.K.resolve("PowerPointWebEditor.IRevisionMetadataHelper")));this.K.register(1367,"PowerPointWebEditor.IRevisionMetaDataUpdateListener").ma().oa(()=>new al([new qn(this.K.resolve("PowerPointWebEditor.IActionNameResolver"),ci.Rng,this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.K.resolve("Box4.Graph.IGraphTransactionManager"),this.K.resolve("PowerPointWebEditor.BootStorage.ICoreOutboundHelper")),new xe(this.K.resolve("PowerPointWebEditor.BootStorage.ICoreOutboundHelper"),
this.K.resolve("Box4.Graph.IGraphTransactionManager"),this.K.resolve("PowerPointWebEditor.ITextEditingRevisionInfoTracker"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").podThumbnailUpdateTelemetryEnabled),this.K.resolve("PowerPointWebEditor.ICcpInfoRevisionMetaDataUpdater")],this.K.resolve("PowerPointWebEditor.IRevisionMetadataHelper")))}init(){this.K.resolve("PowerPointWebEditor.IRevisionMetaDataUpdateListener")}dispose(){this.K.resolve("PowerPointWebEditor.IPresentationResourcesManager").dispose();
this.K.resolve("PowerPointWebEditor.ICcpInfoRevisionMetaDataUpdater").dispose()}static main(){r.a.instance.Dc(new sn)}}Object(n.a)(sn,"PPTWebEditorStoragePackage",null,[2,3]);class qc{constructor(a,b,c){this.vLh=a;this.TOh=b;this.uZh=c}get LCID(){return this.vLh}get p1k(){return this.uZh}get yJf(){return this.TOh}get whe(){return!!(this.yJf&qc.BKh)}get N8b(){return!!(this.yJf&qc.CKh)}static fWc(){qc.DRe={["20490"]:new qc(20490,4215112,"Latn"),["8251"]:new qc(8251,4215112,"Latn"),["17418"]:new qc(17418,
4215112,"Latn"),["17417"]:new qc(17417,4215112,"Latn"),["8218"]:new qc(8218,4215304,"Cyrl"),["8204"]:new qc(8204,4215112,"Latn"),["8202"]:new qc(8202,4215112,"Latn"),["8201"]:new qc(8201,4215112,"Latn"),["8193"]:new qc(8193,4493640,"Arab"),["6154"]:new qc(6154,4215112,"Latn"),["7227"]:new qc(7227,4215112,"Latn"),["19466"]:new qc(19466,4215112,"Latn"),["16394"]:new qc(16394,4215112,"Latn"),["16393"]:new qc(16393,4215112,"Latn"),["16385"]:new qc(16385,4493640,"Arab"),["7194"]:new qc(7194,4215048,"Cyrl"),
["7180"]:new qc(7180,20808,"Latn"),["7178"]:new qc(7178,4215112,"Latn"),["7177"]:new qc(7177,4215112,"Latn"),["7169"]:new qc(7169,4493640,"Arab"),["12289"]:new qc(12289,4493640,"Arab"),["6203"]:new qc(6203,4215080,"Latn"),["15372"]:new qc(15372,4215112,"Latn"),["15370"]:new qc(15370,4215112,"Latn"),["15369"]:new qc(15369,4215112,"Latn"),["15361"]:new qc(15361,4493640,"Arab"),["6170"]:new qc(6170,4215304,"Latn"),["6156"]:new qc(6156,4215112,"Latn"),["18442"]:new qc(18442,4215112,"Latn"),["6153"]:new qc(6153,
4215112,"Latn"),["6145"]:new qc(6145,4493640,"Arab"),["4155"]:new qc(4155,4215080,"Latn"),["11274"]:new qc(11274,4215112,"Latn"),["5179"]:new qc(5179,4215112,"Latn"),["14348"]:new qc(14348,4215112,"Latn"),["14346"]:new qc(14346,4215112,"Latn"),["14345"]:new qc(14345,20808,"Latn"),["14337"]:new qc(14337,4493640,"Arab"),["5146"]:new qc(5146,4215048,"Latn"),["5132"]:new qc(5132,4215112,"Latn"),["5130"]:new qc(5130,4215112,"Latn"),["5129"]:new qc(5129,4215112,"Latn"),["5127"]:new qc(5127,4215112,"Latn"),
["5124"]:new qc(5124,4281672,"Hant"),["5121"]:new qc(5121,4493640,"Arab"),["31770"]:new qc(31770,4210820,""),["31748"]:new qc(31748,4277380,""),["10266"]:new qc(10266,4215048,"Cyrl"),["10252"]:new qc(10252,4215112,"Latn"),["10250"]:new qc(10250,4215112,"Latn"),["10249"]:new qc(10249,4215112,"Latn"),["13324"]:new qc(13324,4215112,"Latn"),["13322"]:new qc(13322,4215112,"Latn"),["13321"]:new qc(13321,4215112,"Latn"),["10241"]:new qc(10241,4493640,"Arab"),["13313"]:new qc(13313,4493640,"Arab"),["4122"]:new qc(4122,
4215048,"Latn"),["4108"]:new qc(4108,4215112,"Latn"),["4106"]:new qc(4106,4215112,"Latn"),["4105"]:new qc(4105,4215112,"Latn"),["4103"]:new qc(4103,4215112,"Latn"),["4100"]:new qc(4100,4282696,"Hans"),["3179"]:new qc(3179,4215048,"Latn"),["4097"]:new qc(4097,4493640,"Arab"),["1085"]:new qc(1085,299432,"Hebr"),["1144"]:new qc(1144,4280616,"Yiii"),["21514"]:new qc(21514,4215112,"Latn"),["2145"]:new qc(2145,5132616,"Deva"),["3131"]:new qc(3131,4215112,"Latn"),["2143"]:new qc(2143,4215432,"Latn"),["12314"]:new qc(12314,
4215048,"Cyrl"),["1070"]:new qc(1070,4215080,"Latn"),["1130"]:new qc(1130,4215080,"Latn"),["12300"]:new qc(12300,4215112,"Latn"),["1091"]:new qc(1091,4215080,"Latn"),["12298"]:new qc(12298,4215112,"Latn"),["12297"]:new qc(12297,4215112,"Latn"),["2055"]:new qc(2055,4215112,"Latn"),["2052"]:new qc(2052,4282664,"Hans"),["2115"]:new qc(2115,4215368,"Cyrl"),["9242"]:new qc(9242,4215304,"Latn"),["3098"]:new qc(3098,4215048,"Cyrl"),["2107"]:new qc(2107,4215112,"Latn"),["9228"]:new qc(9228,4215112,"Latn"),
["3084"]:new qc(3084,4215112,"Latn"),["9226"]:new qc(9226,4215112,"Latn"),["3082"]:new qc(3082,4215080,"Latn"),["3081"]:new qc(3081,4215112,"Latn"),["2094"]:new qc(2094,4215080,"Latn"),["3079"]:new qc(3079,4215112,"Latn"),["2092"]:new qc(2092,4215368,"Cyrl"),["1064"]:new qc(1064,4215080,"Cyrl"),["3076"]:new qc(3076,4281640,"Hant"),["2155"]:new qc(2155,4215048,"Latn"),["3073"]:new qc(3073,4493640,"Arab"),["1153"]:new qc(1153,4215080,"Latn"),["1119"]:new qc(1119,299400,"Arab"),["1086"]:new qc(1086,
4215080,"Latn"),["2144"]:new qc(2144,938632,"Deva"),["2077"]:new qc(2077,4215112,"Latn"),["1053"]:new qc(1053,4215080,"Latn"),["2141"]:new qc(2141,4215336,"Latn"),["2074"]:new qc(2074,4215304,"Latn"),["2073"]:new qc(2073,20808,"Cyrl"),["2072"]:new qc(2072,4215112,"Latn"),["2137"]:new qc(2137,4493896,"Arab"),["2070"]:new qc(2070,4215048,"Latn"),["2068"]:new qc(2068,4215048,"Latn"),["2067"]:new qc(2067,4215112,"Latn"),["1073"]:new qc(1073,4215080,"Latn"),["2064"]:new qc(2064,4215112,"Latn"),["2129"]:new qc(2129,
414016,"Tibt"),["2128"]:new qc(2128,4608584,"Mong"),["2060"]:new qc(2060,4215112,"Latn"),["1132"]:new qc(1132,4215080,"Latn"),["1097"]:new qc(1097,5132584,"Taml"),["2057"]:new qc(2057,4215080,"Latn"),["1164"]:new qc(1164,4493608,"Arab"),["106"]:new qc(106,4210820,""),["2118"]:new qc(2118,4493640,"Arab"),["2117"]:new qc(2117,5132584,"Beng"),["2049"]:new qc(2049,4493640,"Arab"),["1156"]:new qc(1156,4215080,"Latn"),["2110"]:new qc(2110,4215112,"Latn"),["1054"]:new qc(1054,4608296,"Thai"),["2108"]:new qc(2108,
4215048,"Latn"),["1083"]:new qc(1083,4215080,"Latn"),["136"]:new qc(136,4210820,""),["1114"]:new qc(1114,4493608,"Syrc"),["1148"]:new qc(1148,4215080,"Latn"),["1145"]:new qc(1145,20776,"Latn"),["11290"]:new qc(11290,4215304,"Latn"),["1075"]:new qc(1075,20776,"Latn"),["1106"]:new qc(1106,4215080,"Latn"),["1140"]:new qc(1140,4215080,"Latn"),["120"]:new qc(120,4276356,""),["1136"]:new qc(1136,4215080,"Latn"),["1066"]:new qc(1066,4215080,"Latn"),["1098"]:new qc(1098,5132584,"Telu"),["1169"]:new qc(1169,
4215048,"Latn"),["11276"]:new qc(11276,4215112,"Latn"),["61"]:new qc(61,295044,"Hebr"),["1060"]:new qc(1060,4215080,"Latn"),["11273"]:new qc(11273,4215112,"Latn"),["1058"]:new qc(1058,4215080,"Cyrl"),["128"]:new qc(128,4489348,""),["1160"]:new qc(1160,4215080,"Latn"),["1159"]:new qc(1159,4215080,"Latn"),["1158"]:new qc(1158,20776,"Latn"),["1157"]:new qc(1157,4215080,"Cyrl"),["11265"]:new qc(11265,4493640,"Arab"),["1155"]:new qc(1155,4215080,"Latn"),["1154"]:new qc(1154,4215080,"Latn"),["1117"]:new qc(1117,
4215080,"Cans"),["1152"]:new qc(1152,4493608,"Arab"),["1115"]:new qc(1115,5132584,"Sinh"),["1150"]:new qc(1150,4215080,"Latn"),["1113"]:new qc(1113,938280,"Deva"),["1112"]:new qc(1112,938280,"Beng"),["51"]:new qc(51,16516,""),["1146"]:new qc(1146,4215080,"Latn"),["1109"]:new qc(1109,5132584,"Mymr"),["115"]:new qc(115,4210820,""),["1143"]:new qc(1143,4215080,"Latn"),["1142"]:new qc(1142,20872,"Latn"),["1141"]:new qc(1141,4215080,"Latn"),["1104"]:new qc(1104,4215080,"Cyrl"),["2058"]:new qc(2058,4215112,
"Latn"),["1102"]:new qc(1102,5132584,"Deva"),["1137"]:new qc(1137,20776,"Latn"),["1100"]:new qc(1100,5132584,"Mlym"),["1135"]:new qc(1135,4215080,"Latn"),["1134"]:new qc(1134,4215080,"Latn"),["1133"]:new qc(1133,4215080,"Cyrl"),["1096"]:new qc(1096,5132584,"Orya"),["1131"]:new qc(1131,4215048,"Latn"),["1094"]:new qc(1094,5132584,"Guru"),["1129"]:new qc(1129,20872,"Latn"),["1128"]:new qc(1128,4215080,"Latn"),["1127"]:new qc(1127,20776,"Latn"),["1126"]:new qc(1126,20776,"Latn"),["1125"]:new qc(1125,
4493608,"Thaa"),["1124"]:new qc(1124,4215080,"Latn"),["1123"]:new qc(1123,4493608,"Arab"),["1122"]:new qc(1122,4215080,"Latn"),["1121"]:new qc(1121,5132584,"Deva"),["1120"]:new qc(1120,299400,"Arab"),["1118"]:new qc(1118,4215080,"Ethi"),["1082"]:new qc(1082,4215080,"Latn"),["1116"]:new qc(1116,4215080,"Cher"),["1080"]:new qc(1080,4215080,"Latn"),["1079"]:new qc(1079,4215080,"Geor"),["1078"]:new qc(1078,4215080,"Latn"),["1077"]:new qc(1077,4215080,"Latn"),["1111"]:new qc(1111,5132584,"Deva"),["1110"]:new qc(1110,
4215080,"Latn"),["1074"]:new qc(1074,4215080,"Latn"),["1108"]:new qc(1108,4608296,"Laoo"),["1107"]:new qc(1107,4608296,"Khmr"),["1071"]:new qc(1071,4215080,"Cyrl"),["1105"]:new qc(1105,4608296,"Tibt"),["1069"]:new qc(1069,4215080,"Latn"),["1103"]:new qc(1103,5132584,"Deva"),["1067"]:new qc(1067,4215080,"Armn"),["1101"]:new qc(1101,5132584,"Beng"),["1065"]:new qc(1065,4493608,"Arab"),["1099"]:new qc(1099,5132584,"Knda"),["1063"]:new qc(1063,4215080,"Latn"),["1062"]:new qc(1062,4215080,"Latn"),["1061"]:new qc(1061,
4215080,"Latn"),["1095"]:new qc(1095,5132584,"Gujr"),["1059"]:new qc(1059,4215080,"Cyrl"),["1093"]:new qc(1093,5132584,"Beng"),["1092"]:new qc(1092,4215080,"Cyrl"),["1056"]:new qc(1056,4493608,"Arab"),["1090"]:new qc(1090,4215080,"Latn"),["1089"]:new qc(1089,4215080,"Latn"),["1088"]:new qc(1088,4215080,"Cyrl"),["1087"]:new qc(1087,4215080,"Cyrl"),["1052"]:new qc(1052,4215080,"Latn"),["1051"]:new qc(1051,4215080,"Latn"),["1050"]:new qc(1050,4215048,"Latn"),["1049"]:new qc(1049,4215080,"Cyrl"),["1048"]:new qc(1048,
4215080,"Latn"),["1081"]:new qc(1081,5132584,"Deva"),["1046"]:new qc(1046,4215048,"Latn"),["1045"]:new qc(1045,4215080,"Latn"),["1044"]:new qc(1044,4215048,"Latn"),["1043"]:new qc(1043,4215080,"Latn"),["1076"]:new qc(1076,4215080,"Latn"),["1041"]:new qc(1041,4280616,"Jpan"),["1040"]:new qc(1040,4215080,"Latn"),["119"]:new qc(119,4210820,""),["1072"]:new qc(1072,4215176,"Latn"),["1037"]:new qc(1037,4493608,"Hebr"),["1036"]:new qc(1036,4215080,"Latn"),["1035"]:new qc(1035,4215080,"Latn"),["1068"]:new qc(1068,
4215080,"Latn"),["1033"]:new qc(1033,4215048,"Latn"),["1032"]:new qc(1032,4215080,"Grek"),["1031"]:new qc(1031,4215080,"Latn"),["1030"]:new qc(1030,4215080,"Latn"),["1029"]:new qc(1029,4215080,"Latn"),["1028"]:new qc(1028,4281672,"Hant"),["1027"]:new qc(1027,4215080,"Latn"),["1026"]:new qc(1026,4215080,"Cyrl"),["140"]:new qc(140,4489348,""),["1057"]:new qc(1057,4215080,"Latn"),["50"]:new qc(50,4210820,""),["1055"]:new qc(1055,4215080,"Latn"),["135"]:new qc(135,4210820,""),["134"]:new qc(134,16516,
""),["133"]:new qc(133,4210820,""),["132"]:new qc(132,4210820,""),["131"]:new qc(131,4210820,""),["130"]:new qc(130,4210820,""),["129"]:new qc(129,4210820,""),["1047"]:new qc(1047,4215080,"Latn"),["126"]:new qc(126,4210820,""),["89"]:new qc(89,5128324,""),["124"]:new qc(124,4210820,""),["1042"]:new qc(1042,4280616,"Hang"),["122"]:new qc(122,4210820,""),["121"]:new qc(121,16516,""),["1039"]:new qc(1039,4215080,"Latn"),["1038"]:new qc(1038,4215080,"Latn"),["118"]:new qc(118,16516,""),["117"]:new qc(117,
4210820,""),["116"]:new qc(116,4210820,""),["1034"]:new qc(1034,4219176,"Latn"),["114"]:new qc(114,4210820,""),["113"]:new qc(113,16516,""),["112"]:new qc(112,4210820,""),["111"]:new qc(111,4210820,""),["110"]:new qc(110,4210820,""),["109"]:new qc(109,4210820,""),["108"]:new qc(108,4210820,""),["107"]:new qc(107,4210820,""),["1025"]:new qc(1025,4493608,"Arab"),["105"]:new qc(105,16516,""),["104"]:new qc(104,4210820,""),["103"]:new qc(103,4210820,""),["102"]:new qc(102,16516,""),["101"]:new qc(101,
4489348,""),["100"]:new qc(100,4210820,""),["99"]:new qc(99,4489348,""),["98"]:new qc(98,4210820,""),["97"]:new qc(97,5128324,""),["96"]:new qc(96,966788,""),["95"]:new qc(95,4505732,""),["94"]:new qc(94,4210820,""),["93"]:new qc(93,4210820,""),["92"]:new qc(92,4210820,""),["91"]:new qc(91,5128324,""),["90"]:new qc(90,4489348,""),["85"]:new qc(85,5128324,""),["88"]:new qc(88,934020,""),["87"]:new qc(87,5128324,""),["86"]:new qc(86,4210820,""),["9275"]:new qc(9275,4215112,"Latn"),["84"]:new qc(84,
4604036,""),["83"]:new qc(83,4604036,""),["82"]:new qc(82,4210820,""),["81"]:new qc(81,4604036,""),["80"]:new qc(80,4604036,""),["79"]:new qc(79,5128324,""),["78"]:new qc(78,5128324,""),["77"]:new qc(77,5128324,""),["76"]:new qc(76,5128324,""),["75"]:new qc(75,5128324,""),["74"]:new qc(74,5128324,""),["73"]:new qc(73,5128324,""),["72"]:new qc(72,4210820,""),["71"]:new qc(71,4210820,""),["70"]:new qc(70,5128324,""),["69"]:new qc(69,5128324,""),["68"]:new qc(68,4210820,""),["67"]:new qc(67,4210820,
""),["66"]:new qc(66,4210820,""),["65"]:new qc(65,4210820,""),["64"]:new qc(64,4210820,""),["63"]:new qc(63,4210820,""),["62"]:new qc(62,4210820,""),["18441"]:new qc(18441,4215112,"Latn"),["59"]:new qc(59,4210820,""),["58"]:new qc(58,4210820,""),["57"]:new qc(57,5128324,""),["56"]:new qc(56,4210820,""),["55"]:new qc(55,4210820,""),["54"]:new qc(54,4210820,""),["53"]:new qc(53,4210820,""),["52"]:new qc(52,4210820,""),["31"]:new qc(31,4210820,""),["47"]:new qc(47,4210820,""),["49"]:new qc(49,4210820,
""),["48"]:new qc(48,4210820,""),["44"]:new qc(44,4210820,""),["46"]:new qc(46,4210820,""),["45"]:new qc(45,4210820,""),["41"]:new qc(41,4489348,""),["43"]:new qc(43,4210820,""),["42"]:new qc(42,4210820,""),["38"]:new qc(38,4210820,""),["40"]:new qc(40,4210820,""),["39"]:new qc(39,4210820,""),["35"]:new qc(35,4210820,""),["37"]:new qc(37,4210820,""),["36"]:new qc(36,4210820,""),["9225"]:new qc(9225,4215112,"Latn"),["34"]:new qc(34,4210820,""),["33"]:new qc(33,4210820,""),["32"]:new qc(32,4489348,
""),["29"]:new qc(29,4210820,""),["30"]:new qc(30,4604036,""),["27"]:new qc(27,4210820,""),["28"]:new qc(28,4210820,""),["9217"]:new qc(9217,4493640,"Arab"),["26"]:new qc(26,4210820,""),["25"]:new qc(25,4210820,""),["24"]:new qc(24,4210820,""),["23"]:new qc(23,4210820,""),["22"]:new qc(22,4210820,""),["21"]:new qc(21,4210820,""),["20"]:new qc(20,4210820,""),["19"]:new qc(19,4210820,"Latn"),["18"]:new qc(18,4276356,""),["17"]:new qc(17,4276356,""),["16"]:new qc(16,4210820,""),["15"]:new qc(15,4210820,
""),["14"]:new qc(14,4210820,""),["13"]:new qc(13,4489348,""),["12"]:new qc(12,4210820,""),["11"]:new qc(11,4210820,""),["10"]:new qc(10,4210820,""),["9"]:new qc(9,4210820,""),["8"]:new qc(8,4210820,""),["7"]:new qc(7,4210820,""),["6"]:new qc(6,4210820,""),["5"]:new qc(5,4210820,""),["4"]:new qc(4,4278404,""),["3"]:new qc(3,4210820,""),["2"]:new qc(2,4210820,""),["1"]:new qc(1,4489348,""),["0"]:new qc(0,1,"")}}static ue(a){qc.DRe||qc.fWc();return qc.DRe[a.toString()]}}qc.DRe=null;qc.BKh=262144;qc.CKh=
65536;Object(n.a)(qc,"ExtendedCultureInfo",null,[]);class Nk{TU(a,b){var c=a.sa(kb.a.$s,1033);Fa.a.ue(c)&&(c=qc.ue(c))&&(c.N8b?a.setValue(X.a.eastAsianFont,b):c.whe&&a.setValue(X.a.complexScriptFont,b));a.setValue(X.a.latinFont,b)}static nvi(a,b,c){b.baselineFieldSpecified&&(0>b.baselineField?a.te(kb.a.subscript,!0):0<b.baselineField?a.te(kb.a.superscript,!0):(a.te(kb.a.subscript,!1),a.te(kb.a.superscript,!1)));b.bFieldSpecified&&a.te(kb.a.bold,b.bField);b.noProofFieldSpecified&&a.te(jb.a.noProof,
b.noProofField);b.iFieldSpecified&&a.te(kb.a.italic,b.iField);b.strikeFieldSpecified&&a.te(kb.a.strikethrough,b.strikeField);b.uFieldSpecified&&a.te(kb.a.underline,b.uField);if(b.langField){var h=Fa.a.ue(b.langField);h?a.te(kb.a.$s,h.LCID):Ba.a.J(8958996,820,50," FormattingHelper::ComposeCharacterProperties - Unable to get culture info for "+b.langField)}b.altLangField&&((h=Fa.a.ue(b.altLangField))?a.te(X.a.rGc,h.LCID):Ba.a.J(8958998,820,50," FormattingHelper::ComposeCharacterProperties - Unable to get culture info for "+
b.altLangField));b.hlinkClickField&&(a.te(kb.a.Zs,!0),a.te(kb.a.z_,!0));Nk.qvi(a,b,c)}static uGf(a){a>ff.a.ubd?a=ff.a.ubd:a<ff.a.Nbd&&(a=ff.a.Nbd);return Nk.kPi(a)}static qvi(a,b,c){b.szFieldSpecified&&a.te(kb.a.fontSize,Nk.uGf(b.szField));(c=Uf.Box4ColorHelper.OJb(b,c))&&a.setValue(kb.a.fontColor,c.lD);b.latinField&&a.te(X.a.latinFont,b.latinField.typefaceField);b.eaField&&a.te(X.a.eastAsianFont,b.eaField.typefaceField);b.csField&&a.te(X.a.complexScriptFont,b.csField.typefaceField);b.capFieldSpecified&&
a.te(Ie.a.capitalization,b.capField);b.symField&&a.te(X.a.$Mb,b.symField.typefaceField)}static kPi(a){return a/(ff.a.plc*ff.a.v$a)}static Mxf(a){return a*ff.a.v$a}}Object(n.a)(Nk,"FormattingHelper",null,[1200]);class In{k4i(a,b,c){let h="";const m=a.sa(jb.a.L_,[]);m&&0<=b&&b<m.length&&(a=a.Fh)&&(b=a.ye(m[b]))&&b.Sa(X.a.schemeColor)&&((b=ao.SchemeColor.parse(b.eb(X.a.schemeColor)))?b.zta?h=Cj.i(b.WP):b.ZNe(c)&&(h=Cj.i(b.WP)):Ba.a.J(38606471,826,50,"schemeClr is null."));return h}m4i(a,b){let c="";
(a=a.Cod)||Ba.a.J(38088800,826,50,"This shapeNode don't have shapeFont");a&&!a.schemeClrField&&Ba.a.J(38088802,826,50,"The shapeFont don't have schemeClrField.");a&&a.schemeClrField&&(14===a.schemeClrField.valField?Ba.a.J(38549282,826,50,"The color of shapeFont is W"):13===a.schemeClrField.valField?Ba.a.J(38549312,826,50,"The color of shapeFont is B"):Ba.a.J(38549314,826,50,"The color of shapeFont is unexpected color"),b=Uf.Box4ColorHelper.wib(a,b),b=Cj.g(b.f_a),c=Cj.i(b),"000000"===c?Ba.a.J(38549316,
826,50,"The resolved color of shapeFont is B"):"FFFFFF"===c?Ba.a.J(38549318,826,50,"The resolved color of shapeFont is W"):Ba.a.J(38549320,826,50,"The resolved color of shapeFont is unexpected color"));return c}}Object(n.a)(In,"NonTableThemeColorHelper",null,[1362]);class Zl{constructor(){this.charsetField=0;this.panoseField=null;this.pitchFamilyField=0;this.typefaceField=null}}Object(n.a)(Zl,"CT_TextFont",null,[]);class Lj{constructor(){this.WRa=this.a_a=null}}Object(n.a)(Lj,"ThemeFont",null,[]);
class Se{static isThemeFont(a){return Se.b0k.hasOwnProperty(a)}static X8i(a){let b="",c,h;({p8a:c,fkb:h}=Se.P8i(a)).returnValue&&(0===c?0===h?b="+Heading":1===h?b="+Heading Asian":2===h&&(b="+Heading CS"):1===c&&(0===h?b="+Body":1===h?b="+Body Asian":2===h&&(b="+Body CS")));return b}static vki(a,b,c){const h=[];if(!c||!c.FontScheme)return h;var m=Se.K_,y=Se.K_,G=Se.K_;({Bmg:m,nOf:y,tJf:G}=Se.HHh(m,y,G,a));({Bmg:m,nOf:y,tJf:G}=Se.HHh(m,y,G,b));a=c.FontScheme;m!==Se.K_?(Se.mIb(a,0,m,Se.fbd,h),Se.mIb(a,
1,m,Se.Tbd,h)):(m=Se.Q9a(a,0,0),b=Se.Q9a(a,1,0),Se.Wa(m)||Se.Wa(b)||(h.push(Object.assign(new Lj,{a_a:m,WRa:Se.fbd})),h.push(Object.assign(new Lj,{a_a:b,WRa:Se.Tbd}))));y!==Se.K_?(Se.mIb(a,0,y,Se.ebd,h),Se.mIb(a,1,y,Se.Sbd,h)):(y=Se.Q9a(a,0,1),m=Se.Q9a(a,1,1),Se.Wa(y)||Se.Wa(m)||(h.push(Object.assign(new Lj,{a_a:y,WRa:Se.ebd})),h.push(Object.assign(new Lj,{a_a:m,WRa:Se.Sbd}))));G!==Se.K_?(Se.mIb(a,0,G,Se.dbd,h),Se.mIb(a,1,G,Se.Rbd,h)):(G=Se.Q9a(a,0,2),y=Se.Q9a(a,1,2),Se.Wa(G)||Se.Wa(y)||(h.push(Object.assign(new Lj,
{a_a:G,WRa:Se.dbd})),h.push(Object.assign(new Lj,{a_a:y,WRa:Se.Rbd}))));return h}static Wa(a){return!a||!a.length}static mIb(a,b,c,h,m){a&&c!==Se.K_&&(c=Se.Klj(a,b,c),Se.Wa(c)&&(c=Se.Q9a(a,b,0),Se.Wa(c)&&(c="Arial")),m.push(Object.assign(new Lj,{a_a:c,WRa:h})))}static Q9a(a,b,c){let h="";switch(b){case 0:a.majorFontField&&(h=Se.i6f(a.majorFontField,c));break;case 1:a.minorFontField&&(h=Se.i6f(a.minorFontField,c))}return h}static i6f(a,b){let c="";if(a)switch(b){case 0:a.latinField&&(c=a.latinField.typefaceField);
break;case 1:a.eaField&&(c=a.eaField.typefaceField);break;case 2:a.csField&&(c=a.csField.typefaceField)}return c}static Klj(a,b,c){if(!a||c===Se.K_)return"";let h="";if(1066===c)h="Viet";else if(1152===c)h="Uigh";else if(c=qc.ue(c))h=c.p1k;return Se.Llj(a,b,h)}static Llj(a,b,c){let h="";if(a&&c)switch(b){case 0:a.majorFontField&&(h=Se.h6f(a.majorFontField,c));break;case 1:a.minorFontField&&(h=Se.h6f(a.minorFontField,c))}return h}static h6f(a,b){let c="";if(a&&a.fontField&&b){a=a.fontField;for(let h=
0;h<a.length;h++){const m=a[h];if(m.scriptField&&m.scriptField.toLowerCase()===b.toLowerCase()){m.typefaceField&&(c=m.typefaceField);break}}}return c}static HHh(a,b,c,h){if(h!==Se.K_){const m=qc.ue(h);m&&(m.N8b?b===Se.K_&&(b=h):m.whe?c===Se.K_&&(c=h):a===Se.K_&&(a=h))}return{Bmg:a,nOf:b,tJf:c}}static P8i(a){switch(a){case Se.dbd:return{returnValue:!0,p8a:0,fkb:2};case Se.ebd:return{returnValue:!0,p8a:0,fkb:1};case Se.fbd:return{returnValue:!0,p8a:0,fkb:0};case Se.Rbd:return{returnValue:!0,p8a:1,fkb:2};
case Se.Sbd:return{returnValue:!0,p8a:1,fkb:1};case Se.Tbd:return{returnValue:!0,p8a:1,fkb:0}}return{returnValue:!1,p8a:2,fkb:0}}static Btb(a,b){let c=null;if(0===a)switch(b){case 2:c=Se.dbd;break;case 1:c=Se.ebd;break;case 0:c=Se.fbd}else if(1===a)switch(b){case 2:c=Se.Rbd;break;case 1:c=Se.Sbd;break;case 0:c=Se.Tbd}null===c&&(Ba.a.J(8959518,820,10,"TextFontHelper::CreateTextFont - Invalid text font encountered"),c="");return Object.assign(new Zl,{typefaceField:c,charsetField:1})}}Se.dbd="+mj-cs";
Se.ebd="+mj-ea";Se.fbd="+mj-lt";Se.Rbd="+mn-cs";Se.Sbd="+mn-ea";Se.Tbd="+mn-lt";Se.K_=0;Se.b0k={["+mj-cs"]:"",["+mj-ea"]:"",["+mj-lt"]:"",["+mn-cs"]:"",["+mn-ea"]:"",["+mn-lt"]:""};Object(n.a)(Se,"TextFontHelper",null,[]);class cj{constructor(a,b,c){this.ua=a;this.jc=b;this.E8c=c}jYk(a,b){let c="";var h=a.sa(kb.a.$s,Se.K_),m=a.sa(X.a.rGc,Se.K_),y=qc.ue(h===Se.K_?1033:h);if(y){let G="";a.Sa(X.a.$Mb)?G=a.eb(X.a.$Mb):y.whe&&a.Sa(X.a.complexScriptFont)?G=a.eb(X.a.complexScriptFont):y.N8b&&a.Sa(X.a.eastAsianFont)?
G=a.eb(X.a.eastAsianFont):a.Sa(X.a.latinFont)&&(G=a.eb(X.a.latinFont));if(Se.isThemeFont(G)){y=!1;let U=null;if(this.E8c){if(b=Object(ua.a)(115,this.jc.mg(b)))U=b.Ne}else{if(!this.ua.Ba)throw Error.argumentNull("ActiveSlide is null");U=this.ua.Ba.Ne}if(U&&(h=Se.vki(h,m,U)))for(m=0;m<h.length;m++)if(G===h[m].WRa){c=h[m].a_a;y=!0;break}y||(c=Se.X8i(G))}else c=G}c&&a.te(kb.a.font,c)}}Object(n.a)(cj,"FontResolver",null,[1361]);class io{constructor(a){this.z6j=a}Rzi(a,b,c){a(kb.a.$s);a(X.a.latinFont);
a(X.a.eastAsianFont);a(X.a.complexScriptFont);a(X.a.$Mb);a(X.a.rGc);a(X.a.Ne);a(X.a.Gsb);a(X.a.Tzb);a(X.a.gN);a(X.a.schemeColor);a(X.a.YXc);a(X.a.qYd);a(X.a.nYd);a(X.a.kYd);a(X.a.uYd);a(X.a.z7b);this.z6j.jYk(b(),c)}}Object(n.a)(io,"PptFormattingCacheCopyPropertyStrategy",null,[1391]);class Mj{constructor(){this.K=null}get name(){return"PowerPointWebEditor.TextFormatting"}$b(a){this.K=a;a.register(1361,"Box4.IFontResolver").ma().oa(()=>new cj(a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
a.resolve("PowerPointWebEditor.ISlideReader"),a.resolve("PowerPointWebEditor.IApplicationSettings").pptTableFontWithinMultipleThemesFix));a.register(1200,"PowerPointWebEditor.IFormattingHelper").ma().oa(()=>new Nk);a.register(io,"PowerPointWebEditor.PptFormattingCacheCopyPropertyStrategy").as("Box4.IFormattingCacheCopyPropertyStrategy").ma().oa(()=>new io(a.resolve("Box4.IFontResolver")));a.register(1362,"PowerPointWebEditor.INonTableThemeColorHelper").ma().oa(()=>new In)}init(){this.K.resolve("PowerPointWebEditor.IFormattingHelper");
this.K.resolve("PowerPointWebEditor.INonTableThemeColorHelper")}dispose(){}static main(){r.a.instance.Dc(new Mj)}}Object(n.a)(Mj,"PPTWebEditorTextFormattingPackage",null,[2,3]);class Jn{constructor(a){this.fd=a;this.FNh=J.a.instance.ga(115)}fig(a){return this.Jgg(a)?!0:this.FNh?1074135161===a.Se||1074135162===a.Se:!1}Igg(a){return this.Jgg(a)||131162===a.Se||4325465===a.Se||1179729===a.Se}Jgg(a){return 131140===a.Se||this.fd.hg&&131120===a.Se}FNf(a){return Da.a.any(a.MJ,(b,c)=>!this.Igg(c)&&!this.fig(c))}}
Object(n.a)(Jn,"UndoRevisionValidator",null,[1470]);class jo{constructor(){this.hd=vb.a.instance.rb("Box4.IFeatureHelper")}LLb(){return u.AFrameworkApplication.fa.ka("AllowMultiUserUndo")}Z_a(){return this.LLb()&&u.AFrameworkApplication.fa.ka("AllowSmartUndoMerge")}}Object(n.a)(jo,"UndoSettingsManager",null,[1468]);var Ym=d(341),Li=d(1014),Kn=d(200);class Ln{Sa(a){return a.Sa(void 0)}h3f(a,b){return a.sa(b,null)}VSc(a,b){a=(a=a.sa(b,null))?Array.clone(a):[];return new Li.a(a)}k3f(a,b){return a.sa(b,
"")}vqh(a,b,c){a.setValue(b,c)}}Object(n.a)(Ln,"MergeableObjectUtilities",null,[577]);class Ao{constructor(a,b,c,h,m){this.Fb=a;this.ua=b;this.Ea=c;this.pa=h;this.e0=m}hdd(a,b,c){if(a)if("PowerPointGroupShapes"===b&&c)for(a=a.MJ,b=[],c=0;c<a.length;++c){var h=a[c];if(h&&393227===h.Se&&h.Sa(X.a.C8)){h=(new Ln).VSc(h,X.a.C8);for(var m=0;m<h.length;m++){var y=this.ua.Ba;if(!y)throw Error.argumentNull("ActiveSlide is null");const G=this.e0.Zca(h.ga(m));y=y.kC(G.get_shapeId());b.push(y)}this.Dxj(b)}}else if("PowerPointUngroupShapes"===
b&&!c)for(a=a.MJ,b=0;b<a.length;++b)if((c=a[b])&&393227===c.Se&&c.Sa(X.a.Uoa))for(c=(new Ln).VSc(c,X.a.Uoa),h=0;h<c.length;h++){m=this.ua.Ba;if(!m)throw Error.argumentNull("ActiveSlide is null");y=this.e0.Zca(c.ga(h));m=m.kC(y.get_shapeId());this.Cxj(m)}}lVc(a){if(a){const b=a.tg(this.Fb.Ma);b.gka();b.sKb=!0;this.pa.Z7(a)}else Ba.a.J(595359873,815,10,"GroupUngroupUndoRedoActionController::HideAndDeselectShape Trying to Hide and Deselect Null shape.")}Dxj(a){if(a.length){var b=this.Ea.rs(a[0]);this.lVc(b);
for(const c of a)this.lVc(c)}}Cxj(a){this.lVc(a);if(a.Jf){a=this.Ea.Yw(a);for(const b of a)this.lVc(b)}}}Object(n.a)(Ao,"GroupUngroupUndoRedoActionController",null,[1355]);class Xo{V1g(){}hdd(){}w1g(){}X0g(){}B_c(){return!1}}Object(n.a)(Xo,"NoOpTablePartialEditController",null,[1356]);class Bo{constructor(a,b,c,h,m,y){this.Wdb=null;this.vi=a;this.Ea=b;this.ahc=c;this.Vb=h;this.pa=m;this.Udc=y}V1g(){this.Yke()&&this.xYe()}hdd(a){a&&this.Yke()&&(a=this.Wdb,this.xYe(),this.Jxh(a))}w1g(a,b,c,h){this.Yke()&&
!this.RPj(a,b,c,h)&&this.xYe()}X0g(a,b,c){if(a&&b&&c){this.Wdb=null;a=this.pa.Xd();c=new Nd.a;b=b.MJ;for(let m=0;m<b.length;++m){var h=b[m];393230===h.Se&&h.Sa(X.a.cellId)&&(h=this.Ea.Zm(h),Array.contains(a,h)&&c.$(h.get_shapeId(),h))}0<c.count&&this.Jxh(c.values.ga(0))}}RPj(a,b,c,h){let m=!1;b&&this.B_c(a)&&(h=b.sT&&h,m=(c||h)&&b.actionId===a,this.Udc||(m=(b.actionId===a||this.B_c(b.actionId))&&1===this.ahc.Vwb(b.b6)||m));return m}B_c(a){let b=a===D.a.QBa||a===D.a.WQa||a===D.a.typing;this.Udc||(b=
a===D.a.rB||a===D.a.enter||b);return b}Jxh(a){this.Wdb=a}xYe(){if(this.Wdb){const a=this.Vb.yi.zi.Xw.id;0!==this.ahc.Vwb(a)&&this.ahc.WBh(a,!1);this.vi.N6a(this.Wdb,!0)}this.Wdb=null}Yke(){return!!this.Wdb}}Object(n.a)(Bo,"TablePartialEditController",null,[1356]);var qp=d(910);class Co{constructor(a,b,c,h){this.Hv=a;this.Edk=c;this.ia=h;this.vb()}vb(){this.ia.ra(M.a.zhb,nc.a.application,Object(F.a)(this,this.zhb,"queryIsShapeTextEditHappened"),96)}zhb(a,b,c,h,m){m.$ta=this.$ta(m.Xrc,m.YWj);return 32}Boj(a,
b,c){this.Edk.Bql(new qp.a(a,b,c))}$ta(a,b){let c=!1;a&&(c=!this.Hv.WYc()&&a.DFa!==b,this.Hv.WYc()||a.DFa!==b||Ba.a.J(512493777,820,15,"{0}ViewElement::EndEditing - IsEditingHappened: false. Find localUndoStack is not empty but lastContentSavedTimeBeforeEnterTextEditing not changed",Object(za.a)(4,a)?"Shape":"Notes"));return c}}Object(n.a)(Co,"PPTUndoActionBehavior",null,[1467]);class ko extends Sys.EventArgs{constructor(a){super();this.actionId=a}}Object(n.a)(ko,"OnUndoEventArgs",Sys.EventArgs,[]);
var tn=d(719),un=d(135);class nl extends tn.a{constructor(a=null,b=null,c=null){super(a,b);this.PEd=c||new Ln}dIb(){super.dIb();const a=new Li.a,b=new Ea.a;b.add(pa.a.nil);this.Hib.forEach((m,y)=>{b.add(y);a.add(y);return!0});for(this.objects.forEach(m=>{b.add(m);a.add(m);return!0});0<a.length;){var c=a.ga(0);a.BYd(0);var h=this.objects.ga(c)||this.a_.qwb(c);if(h){c=h;h=c.Tz();for(let m=0;m<h.length;m++){const y=h[m],G=un.a.L5b(un.a.fWf(y));8===G?this.Yqf(this.PEd.h3f(c,y),a,b):9===G&&this.PEd.VSc(c,
y).forEach(U=>{this.Yqf(U,a,b);return!0})}}else ya.a.instance.shipAssertTag(17409040,2,!1,"Failed to find [revisedObjectId: {0}]",c)}}Yqf(a,b,c){c.contains(a)||(c.add(a),this.mig(a)&&(c=this.a_.qwb(a),this.pEe(c),b.add(a)))}}Object(n.a)(nl,"ReferenceFollowingRevisionDiffer",tn.a,[]);class wm{gFi(a,b){return new nl(a,b)}}Object(n.a)(wm,"UndoDifferFactory",null,[1455]);var rk=d(284),Wg=d(582);class f{constructor(a,b,c,h,m,y,G){a||rk.a.argument("revisionStore cannot be null","revisionStore");b||rk.a.argument("undoRevisionValidator cannot be null",
"undoRevisionValidator");c||rk.a.argument("undoSettingsManager cannot be null","undoSettingsManager");h||rk.a.argument("undoDifferFactory cannot be null","undoDifferFactory");m||rk.a.argument("revisedObjectSpace cannot be null","revisedObjectSpace");y||rk.a.argument("undoRevisionMergeStrategy cannot be null","undoRevisionMergeStrategy");this.fZh=a;this.hEc=b;this.Oba=c;this.M1h=h;this.vVb=m;this.Q1h=y;this.icf=G}VKc(a,b){const c=this.M1h.gFi(a,b);c.dIb();const h=new Wg.a;h.rYe(this.vVb,a);c.Hib.forEach((G,
U)=>{h.nya(U,G);return!0});const m=new Li.a,y=a.DT<b.DT;c.objects.forEach((G,U)=>{if(this.hEc.fig(U))return!0;if(y&&!this.hEc.Igg(U)&&!b.D_(G)&&!a.D_(G))return m.add(G),!0;h.ara(U);return!0});0<m.length&&ba.ULS.sendTraceTag(22607311,365,100,"Skipping Objects because they're not referenced in base {0} or revised {1}: {2}",a.id,b.id,m.Cr());this.icf&&this.icf.Qyl(h);return h.fPc()}hFi(a,b,c,h){b=this.VKc(a,b);if(!b)return null;if(a.id===c.id)return ba.ULS.sendTraceTag(22607312,365,this.Oba.Z_a()?15:
50,"Undo merge attempted with base and current were the same revision. [AllowSmartUndoMerge: {0}]",this.Oba.Z_a()),b;a=this.VKc(a,c);if(!a)return null;var m=b;this.hEc.FNf(a)?(ba.ULS.sendTraceTag(22607313,365,100,"Merge determined to be necessary for undo."),m=new Li.a,m.add(a),a=new Li.a,a.add(b),m=this.Q1h.chk(h,a,m,c.jld).LO.last()):ba.ULS.sendTraceTag(22607314,365,this.Oba.Z_a()?15:50,"Undo merge determined to be not needed because base and current are equivalent. [AllowSmartUndoMerge: {0}]",
this.Oba.Z_a());return this.VKc(c,m)}iFi(a,b,c,h,m){let y=null;h||(this.Oba.Z_a()||!this.Oba.LLb()?y=this.VKc(c,b):(ba.ULS.sendTraceTag(22607315,365,10,"Trying to skip merge when multi user undo is enabled and smart merge is disabled."),h=!0));h&&(y=this.hFi(a,b,c,m));return y&&this.Rll(y)?y:null}Rll(a){return this.hEc.FNf(a)?(this.fZh.qkb(a),!0):!1}}Object(n.a)(f,"UndoRevisionManager",null,[1392]);var x=d(158);class N{constructor(a){this.igf=null;this.Oa=new bd.a;this.cmb=null;this.hqb=[];this.R1h=
a}dispose(){for(;0<this.hqb.length;)this.vhh(this.hqb[0])}get FK(){return this.cmb}set FK(a){this.cmb&&(this.cmb.isActive=!1);if(this.cmb=a)this.cmb.isActive=!0}register(a){if(!this.Lka(a)){const b=this.R1h.JGi(a);b.zrh(c=>{this.Oa.raiseEvent(N.euk,new ko(c))});a.addListener(this);Array.add(this.hqb,b)}}unregister(a){if(a=this.Xwb(a))a===this.FK&&(this.FK=null),this.vhh(a)}setActive(a){this.FK=this.Xwb(a)}cJc(){const a=this.Xwb(void 0);a&&(a.doa(void 0),this.gEe())}get LW(){return this.EI?this.FK.LW:
!1}get PXd(){return this.EI?this.FK.PXd:null}get fka(){return this.EI?this.FK.fka:!1}get fFa(){return this.EI?this.FK.fFa():!1}iYe(a,b){this.EI&&this.FK.iYe(a,b)}kw(){this.EI&&this.FK.kw()}GW(){return this.EI?this.FK.GW():null}undo(){return this.EI?this.FK.undo():!1}redo(){return this.EI?this.FK.redo():!1}dYa(a,b,c=!1){this.EI&&this.FK.dYa(a,b,c)&&(this.gEe(),this.igf&&this.igf())}kHe(){this.EI&&this.FK.kHe()}vhh(a){a.graphSpace.removeListener(this);a.zrh(null);a.dispose();Array.remove(this.hqb,a)}Lka(a){return!!this.Xwb(a)}get EI(){return!!this.FK}Xwb(a){for(let b=
0;b<this.hqb.length;b++){const c=this.hqb[b];if(c.MHj(a))return c}return null}gEe(){Fc.App.Kb.updateCommandUI()}Tdd(a){this.unregister(a)}onBeforeLoadContent(a){const b=this.Xwb(a);if(b)b.onBeforeLoadContent(a)}onAfterLoadContent(a){const b=this.Xwb(a);if(b)b.onAfterLoadContent(a);this.FK===b&&(this.FK.LW||this.FK.fka)&&this.gEe()}onAfterFirstSaveContent(){}}N.euk="OnUndo";Object(n.a)(N,"UndoManager",null,[1465,797,106,1466]);class ea extends N{constructor(a,b,c){super(a);this.U4j=b;this.Qad=c;this.U4j.k8h(Object(F.a)(this,
this.qok,"onFailoverSucceeded"));this.Qad.VNd(Object(F.a)(this,this.xpk,"onInitialSelectionSet"))}get uxa(){return this.FK}UJj(a){return this.EI?this.uxa.nfg(a):!1}GTd(){this.EI&&this.uxa.Nri()}$4d(a){return this.EI?this.uxa.$4d(a):null}kRc(a){return this.EI?this.uxa.kRc(a):0}wZe(){this.EI&&this.uxa.wZe()}get LW(){return this.EI?this.uxa.vwj:!1}doa(){this.EI&&this.uxa.doa(!0)}qok(a,b){b.fSj&&this.doa()}xpk(){this.dYa(D.a.LTa,null)}x2e(a){this.EI&&this.uxa.x2e(a)}WYc(){return this.EI?this.uxa.WYc():
!1}rab(){return this.EI?this.uxa.rab():!1}}Object(n.a)(ea,"PPTUndoManager",N,[1464,1465,797,106,1466]);class ma{chk(a,b,c,h){return a?a.Fbd(b,c,null,h,1,!1,5):null}}Object(n.a)(ma,"PPTUndoRevisionMergeStrategy",null,[1463]);var Ha=d(139),Ua=d(47);class mb{constructor(a,b,c,h,m,y,G,U,ja,va,Ta,fb,Db,gc,hc,Gc,Pc,yc,Vd){this.Kve=!1;if(Vd&&!yc)throw Error.argumentNull("viewElementEventNotifier");this.Goe=a;this.mB=b;this.gTg=c;this.zXa=h;this.WHa=m;this.Neb=y;this.dhc=G;this.vJ=yc;this.R4=Vd;U===Ua.a.uz&&
(U=Ua.a.Hp);this.owg=U;this.pa=ja;this.Sb=va;this.a7j=Ta;this.Vb=fb;this.Fa=Db;this.ia=gc;this.Wdc=hc;this.Hgc=Gc;this.Fb=Pc}YYk(){this.aEh();if(this.mB){var a=this.Sb.zl(this.mB);a&&this.a7j.Ba!==a&&(this.Vb.Ba=a)}if(this.Wdc){if(this.zXa&&0<this.zXa.length){a=[];for(const b of this.zXa){let c=this.Sb.zl(b);c&&a.push(c)}if(0<a.length){let b;(b=this.pa).WU.apply(b,a)}}this.ia.processAction(M.a.o_a,2)}this.R4&&this.vJ&&this.vJ.Sdh()}LU(a=!1,b=null){this.YYk();if(this.Kve||this.feg())return this.Kve=
!1,null;b||(b=this.isb());this.setSelection(a,b);return b}isb(){let a=null;if(0<this.Neb.length){const b=this.Sb.zl(this.mB);if(b){const c=[];for(const h of this.Neb){if(!h)continue;const m=b.eT(h);if(m){const y=m.tg(this.Fb.Ma);y&&!y.sKb&&c.push(yd.SelectionFactory.wl(m))}}0<c.length&&(a=new Ha.SelectionCollection(c,c.length-1))}}a||(a=this.Goe.isb(!0));!a&&this.dhc&&(a=this.dhc.OWf());return a}setSelection(a=!1,b=null){this.Goe.setSelection(a,b);b&&this.dhc&&Ba.a.J(509445784,816,50,"Selection restore to IP level");
b||this.owg!==Ua.a.rg?this.Fa.xf(this.owg):(this.pa.Qh(),this.Fa.Ed())}EHc(){return this.Goe.EHc()}aEh(){this.mB=this.M1e(this.mB,this.gTg);const a=[];let b=0;for(const c of this.zXa)a.push(this.M1e(c,this.WHa[b++]));this.zXa=a}M1e(a,b){let c=a;a&&lc.a.ax(a)&&(a=this.Sb.H5b(b),a||(b=this.Hgc.gij(b),null!=b&&(a=this.Sb.cEa(b))),a&&(c=a.Cb));return c}jvl(){this.mB=this.M1e(this.mB,this.gTg);this.Wdc&&this.aEh();if(this.Neb.length&&Array.contains(this.Neb,0)){Array.clear(this.Neb);var a=this.isb();if(this.pa.F_(a))for(let b of a)(a=
Object(ua.a)(4,b.Ua.node))&&this.Neb.push(a.get_shapeId())}}lAl(){this.Kve=this.feg()}feg(){const a=this.Sb.zl(this.mB);if(!a)return!1;var b=this.dhc?[this.dhc.hVd]:this.Neb;for(const c of b)if((b=a.eT(c))&&b.$p)return!0;return!1}}Object(n.a)(mb,"PPTUndoSelectionReference",null,[561,1462]);class gb{constructor(a,b,c,h,m){this.qc=a;this.Fpe=b;this.J2c=c;this.Zgc=h;this.Ygc=m}OWf(){var a=this.qc.zl(this.Fpe);if(!a)return null;a=a.eT(this.J2c);if(!a)return null;a=a.CTc();if(!a)return null;var b=a.sa(kb.a.Tya,
0);const c=a.sa(kb.a.kga,0);if(!this.Zgc||!this.Ygc||this.Zgc.pLa>=b||this.Zgc.oLa>=c||this.Ygc.pLa>=b||this.Ygc.oLa>=c)return null;b=rb.GraphIterator.nb(a.qf(this.Zgc.pLa,this.Zgc.oLa));b.rc(14);a=rb.GraphIterator.nb(a.qf(this.Ygc.pLa,this.Ygc.oLa));a.rc(14);return yd.SelectionFactory.N0b(b,a)}get hVd(){return this.J2c}}Object(n.a)(gb,"PPTUndoTableCellSelectionPos",null,[1479]);class Cb{constructor(a,b,c,h,m,y,G,U){this.Pb=a;this.qc=b;this.XX=c;this.O4j=h;this.Fpe=m;this.J2c=y;this.Z$c=G;this.bdk=
U}OWf(){var a=this.qc.zl(this.fyi);if(!a)return null;let b=null;if(10===this.containerType||16===this.containerType)if(b=a.eT(this.hVd),!b)return null;var c=[];switch(this.containerType){case 10:c=this.H3d(b);break;case 16:a=this.Pb.Nc(b);if(!a.Gi()||!a.Gi())return null;if(0>this.pLa||0>this.oLa||this.pLa>=a.currentNode.sa(kb.a.Tya,0)||this.oLa>=a.currentNode.sa(kb.a.kga,0)){this.XX.uZg(a,0,0);c.push(yd.SelectionFactory.sj(a.currentNode,!0));break}this.XX.uZg(a,this.pLa,this.oLa);c=this.H3d(a.currentNode);
break;case 60:c=a.GSa();if(!c)return null;c=this.H3d(c);break;default:return null}return 0<c.length?new Ha.SelectionCollection(c,0):null}get hVd(){return this.J2c}H3d(a){const b=[];for(const c of this.ipl){const h=c.I0i(a);h&&b.push(h)}b.length||b.push(yd.SelectionFactory.sj(a,!0));return b}get containerType(){return this.O4j}get fyi(){return this.Fpe}get oLa(){return this.Z$c?this.Z$c.oLa:-1}get pLa(){return this.Z$c?this.Z$c.pLa:-1}get ipl(){return this.bdk}}Object(n.a)(Cb,"PPTUndoTextSelectionPos",
null,[1479]);class zb{constructor(a,b){this.Mck=a;this.Uck=b}get oLa(){return this.Mck}get pLa(){return this.Uck}}Object(n.a)(zb,"TableCellIndex",null,[]);class Pb{constructor(a,b,c,h,m,y){this.Pb=a;this.Hh=b;this.Q$j=c;this.R4j=h;this.M7j=m;this.L7j=y}get contextId(){return this.R4j}get paragraphIndex(){return this.Q$j}get t8b(){return this.M7j}get s8b(){return this.L7j}I0i(a){a=this.Pb.Nc(a);if(!a.n$d(this.paragraphIndex)||11!==a.xq.type||!a.Bb(2)||12!==a.xq.type&&21!==a.xq.type||this.t8b>this.s8b||
-1>this.t8b||this.s8b>this.Hh.textLength(a.currentNode))return null;switch(this.contextId){case xb.a.Of:return yd.SelectionFactory.V2(a.currentNode,this.t8b,this.s8b);case xb.a.textRange:return yd.SelectionFactory.V2(a.currentNode,this.t8b,this.s8b);case xb.a.endOfParagraph:return yd.SelectionFactory.pca(a.currentNode);case xb.a.paragraph:return yd.SelectionFactory.wu(md.a.xQa(this.t8b,this.s8b,!1,a.currentNode))}return null}}Object(n.a)(Pb,"TextContextRecord",null,[]);class oc{constructor(a,b,c,
h,m,y,G,U,ja,va,Ta,fb,Db,gc,hc,Gc){if(Gc&&!hc)throw Error.argumentNull("viewElementEventNotifier");this.o4j=a;this.pa=b;this.oxg=c;this.Vb=h;this.Pb=m;this.Fa=y;this.qc=G;this.Ea=U;this.Hh=ja;this.XX=va;this.ia=Ta;this.Wdc=fb;this.Hgc=Db;this.Fb=gc;this.vJ=hc;this.R4=Gc}Yra(){const a=this.o4j.Yra();let b=null,c=pa.a.nil;const h=this.oxg.Ba;h&&(b=h.Cb,c=h.id);const m=[],y=[];if(this.Wdc){var G=this.pa.We();for(var U of G)m.push(U.Cb),y.push(U.id)}G=[];U=null;h&&(this.pa.bH()&&this.rNk(G),this.pa.pC()&&
(U=this.wNk(b)));return new mb(a,b,c,m,y,G,U,this.Fa.S7,this.pa,this.qc,this.oxg,this.Vb,this.Fa,this.ia,this.Wdc,this.Hgc,this.Fb,this.vJ,this.R4)}fZc(a){return 10===a.type||60===a.type||16===a.type}rNk(a){const b=this.pa.Xd();for(const c of b)a.push(c.get_shapeId())}wNk(a){return this.pa.Pa.mb.kg?this.uNk(a):this.vNk(this.pa.Pa,a)}vNk(a,b){var c=Object(ua.a)(5,a.mb.Ua.node),h=this.Pb.Nc(c);if(h.q6(Object(F.a)(this,this.fZc,"isOEContainerNode")))if(h.zc()&&11===h.currentNode.type){if(h.zc()){c=(c=
this.Ea.Xca(c))?c.get_shapeId():0;const m=h.xq.type;h=16===m?this.q9d(Object(ua.a)(123,h.xq)):null;const y=a.mb,G=[];this.Euf(y,G);for(let U of a)U!==y&&this.Dei(U,y)&&this.Euf(U,G);return new Cb(this.Pb,this.qc,this.XX,m,b,c,h,G)}}else Ba.a.J(509445783,816,15,"Find text selection but its container is not OutlineElement");return null}uNk(a){var b=this.pa.Pa.ga(0),c=this.pa.Pa.last,h=b.kg;b=16===h.Ua.node.type?this.q9d(Object(ua.a)(123,h.Ua.node)):null;h=c.kg;c=16===h.Ye.node.type?this.q9d(Object(ua.a)(123,
h.Ye.node)):null;h=(h=this.Ea.Xca(h.Ua.node))?h.get_shapeId():0;return new gb(this.qc,a,h,b,c)}q9d(a){return a?new zb(a.pi,a.rowIndex):null}Euf(a,b){for(let c of a){if(!Object(za.a)(102,c.node))continue;a=this.Pb.Nc(c.node);if(!a.q6(Object(F.a)(this,this.fZc,"isOEContainerNode")))continue;a.zc();const h=a.currentNode;a.zc();a=a.mSa(h);b.push(new Pb(this.Pb,this.Hh,a,c.contextId,c.Qa,c.Nb))}}Dei(a,b){a=this.Pb.Nc(a.Ua.node);b=this.Pb.Nc(b.Ua.node);return a.q6(Object(F.a)(this,this.fZc,"isOEContainerNode"))&&
b.q6(Object(F.a)(this,this.fZc,"isOEContainerNode"))&&a.zc()&&11===a.currentNode.type&&b.zc()&&11===b.currentNode.type&&a.zc()&&b.zc()?a.currentNode===b.currentNode:!1}}Object(n.a)(oc,"PPTUndoSelectionReferenceFactory",null,[483]);class Ec{constructor(){this.eWa=this.$Rg=this.wze=this.QVg=null;this.h6c=!1;this.lBe=null}J1e(){if(!this.eWa.zyb&&this.eWa.y0c)for(const a of this.eWa.y0c)if(a.equals(this.QVg)){this.wze.LU(!1,this.$Rg);Ba.a.J(22684815,813,50,"Undo/Redo Success, and E2E time is: {0}ms",
+new Date-+this.lBe);this.eWa.Fnc(Object(F.a)(this,this.J1e,"trySetSelectionWhenServerUndoRedoFinish"));this.h6c=!0;break}}tQk(a,b,c,h){a&&(this.QVg=b,this.$Rg=h,(this.wze=Object(ua.a)(1462,c))?(this.i2e(),this.lBe=new Date,this.eWa=a,this.eWa.IFc(Object(F.a)(this,this.J1e,"trySetSelectionWhenServerUndoRedoFinish")),this.h6c=!1):Ba.a.J(21051018,816,15,"The selectionreference is not the type of PPTUndoSelectionReference"))}i2e(){this.eWa&&!this.h6c&&(Ba.a.J(22684818,813,50,"Undo/Redo Fail, and E2E time is: {0}ms",
+new Date-+this.lBe),this.eWa.Fnc(Object(F.a)(this,this.J1e,"trySetSelectionWhenServerUndoRedoFinish")),this.h6c=!0)}}Object(n.a)(Ec,"PPTUndoSelectionRestoreExecutor",null,[1354]);class Xc{constructor(){this.Cck=new Nd.a(!1);this.Gdk=new Nd.a(!1);this.CEg=new Nd.a(!1);this.init()}init(){this.CBj()}CBj(){this.CEg.add(M.a.qI,!0)}tAi(a){return a&&this.Cck.Hb(a)?!0:!1}sAi(a){return a&&this.Gdk.Hb(a)?!1:!0}Rcl(a){return a&&this.CEg.Hb(a)?!0:!1}}Object(n.a)(Xc,"PPTUndoSettings",null,[1461]);class Ac{constructor(a){this.Jj=
null;this.Z6e=a}start(a){this.Jj=a}gwj(){var a=new Date;return this.Z6e?+a-+this.Jj>this.Z6e:!1}}Object(n.a)(Ac,"UndoTimer",null,[1478]);var zd=d(474),ue=d(515);class bf{constructor(a){this.gba=this.u2=null;this.Aub=this.irc=a}get irc(){return this.u2}set irc(a){this.u2&&(this.u2.TO&=-2);this.u2=a;this.u2.TO|=1}get Aub(){return this.gba}set Aub(a){this.gba&&(this.gba.TO&=-3);this.gba=a;this.gba.TO|=2}get b6(){return this.u2?this.u2.id:pa.a.nil}get Q_d(){return this.gba?this.gba.id:pa.a.nil}get MJ(){return this.u2?
this.u2.dng():[]}combineWithPrevious(){}dispose(){this.u2&&(this.u2.TO&=-2);this.gba&&(this.gba.TO&=-3)}}Object(n.a)(bf,"Box4UndoRecordData",null,[1492,106]);class Ce{constructor(a,b,c,h,m,y){this.dya=a;this.Wib=b;this.N1h=c;this.actionId=h;this.sT=m;this.fKa=y}get B1(){return this.N1h}get b6(){return this.B1.b6}dispose(){this.B1&&this.B1.dispose()}}Object(n.a)(Ce,"UndoRecord",null,[106]);class qg{constructor(){this.Oqa=[]}ga(a){return this.Oqa[a]}get length(){return this.Oqa.length}add(a){this.Oqa.push(a)}clear(){for(let a=
0;a<this.Oqa.length;a++)this.Oqa[a].dispose();Array.clear(this.Oqa)}remove(a){const b=Array.remove(this.Oqa,a);b&&a.dispose();return b}removeAt(a){0<=a&&a<this.Oqa.length&&(this.Oqa[a].dispose(),Array.removeAt(this.Oqa,a))}}Object(n.a)(qg,"UndoRecordsArray",null,[]);class Df{constructor(a,b,c,h,m,y,G,U,ja,va,Ta,fb,Db,gc,hc,Gc,Pc,yc,Vd,De,Wd,Ve,$e){this.G4a=!0;this.Z2a=this.Qaf=this.azc=this.ypb=!1;this.unb=null;this.IFd=this.xhf=0;this.jMd=null;this.Emf=!0;this.isActive=!1;this.Dz=a;this.gxd=b;this.FUh=
c;this.kAd=h;this.N2h=m;this.RWh=y;this.yk=G;this.PH=U;this.skf=ja;this.DZh=va;this.Wd=Ta;this.E1h=fb;this.NZh=Db;this.Gjf=gc;this.O1h=Gc;this.fof=Pc;this.S1h=yc;this.hof=Vd;this.Oba=De;this.Jy=Ve;this.Og=new qg;this.ks=this.sh=-1;this.Ybf=Object(F.a)(this,this.YHf,"createInitialUndoRecord");this.qCc=hc;this.qCc.D$h(Object(F.a)(this,this.uhh,"removeUndoRecordForRevision"));this.Emf=$e}dispose(){this.Ybf=null;this.cJc();this.Dz=null;this.qCc.HUk(Object(F.a)(this,this.uhh,"removeUndoRecordForRevision"))}get graphSpace(){return this.Dz}get Tlc(){return this.FUh.value}MHj(a){return this.Dz===
a?!0:!1}cJc(){this.Og.clear();this.ks=this.sh=-1;this.G4a=!0}lsi(){if(this.sh===this.Og.length-1)this.cJc();else{let a=0;for(;a<this.sh;)this.Og.removeAt(0),a++;this.sh=0;this.ks=1}}get LW(){return 0<this.sh}get PXd(){return this.LW?this.Og.ga(this.sh).actionId:null}get QXd(){return 0<=this.sh&&this.sh<this.Og.length?this.Og.ga(this.sh).B1:null}iYe(a,b){this.Z2a?(this.csc(),this.doa()):(this.Gjf&&this.Tlc.suspend(),this.Z2a=!0,this.unb=a,this.xhf=b,this.IFd=0)}csc(){this.Z2a=!1;this.Gjf&&this.Tlc.resume()}Pvl(){this.NZh(new pa.a(this.unb,
1));this.csc()}dYa(a,b,c=!1){if(!this.gxd()||a===D.a.LTa&&this.Og.length)return!1;var h=this.Dz.hT();if(!h&&a!==D.a.LTa&&!c||!this.Dz||!this.Dz.zi)return!1;h&&(this.Qaf||(ba.ULS.sendTraceTag(39102051,305,50,"Real Edit occurred"),this.Qaf=!0),this.kAd.execute(y=>{y.s_d()}));if(this.Z2a){ba.ULS.sendTraceTag(23171273,365,50,"Incremental action {0} interrupted by user edits. Cancelling action.",this.unb);this.csc();for(c=this.Og.length-2;0<=c;c--)this.Og.removeAt(c);this.sh=0;this.ks=-1}c=this.GW();h=
this.mLc(h,a);this.aub();b=this.tui(a,h,b);const m=this.Oba.LLb()&&!this.Oba.Z_a();a=new Ce(b,c,h,a,this.ypb,m);this.Og.add(a);this.sh=this.Og.length-1;return!0}mLc(a,b){return this.O1h(a,b)}tui(a,b,c){if(0<=this.sh){switch(a){case D.a.QBa:case D.a.WQa:case D.a.typing:this.G4a&&this.Og.ga(this.sh).actionId===a?(a=this.Og.ga(this.sh),c=a.dya,b.combineWithPrevious(a.B1),this.Og.removeAt(this.sh)):u.AFrameworkApplication.fa.ka("OtelSendTypingUserActionDisabled")||(b=this.E1h.create(a),b.end(32),this.N2h.gnc(b),
this.RWh.fnc(b))}this.G4a=!0}return c}kHe(){this.S1h(this)}ALi(){this.Emf&&!this.G4a||!this.Oba.LLb()||(this.G4a=!1,this.ypb=!0)}xfk(){if(this.Oba.Z_a())for(let a=0;a<this.Og.length;a++)this.Og.ga(a).fKa=!0}aub(){if(this.sh<this.Og.length-1){for(let a=this.Og.length-1;a>this.sh;a--)this.Og.removeAt(a);this.ks=-1}}Rzl(){var a=x.ObjectSpace.r8(this.Dz.zi);a=new bf(a);const b=this.GW(),c=this.Og.ga(this.sh).dya;a=new Ce(c,b,a,D.a.dtd,this.Og.ga(this.sh).sT,this.Og.ga(this.sh).fKa);this.Og.removeAt(this.Og.length-
1);this.Og.add(a)}thb(a,b,c,h){return a.thb(b,c,h)}GIe(a,b,c){this.azc=!0;a.xme();this.azc=!1;b.LU(void 0,c)}undo(){if(!this.LW)return!1;this.kAd.execute(va=>{va.s_d()});var a=!0;let b=!1;var c=!1;const h=this.yk.le(7);h.kd(this.Dz);let m=0,y=!1,G=this.GW(),U=null;const ja=this.fof(!0);for(this.hof.start(new Date);this.LW&&a;){const va=this.Og.ga(this.sh),Ta=this.Og.ga(this.sh-1);a=va.sT&&Ta.sT;ba.ULS.sendTraceTag(22607296,365,50,"Performing Undo [IsContinuation: {0}], [AppMode: {1}]",a,ue.a[this.Jy]);
this.ks=this.sh;try{if(b=this.thb(ja,va.B1,Ta.B1,va.fKa||Ta.fKa))G=this.Og.ga(this.sh).dya,U=this.Og.ga(this.ks).Wib,this.jMd&&this.jMd(this.Og.ga(this.sh).actionId)}catch(fb){ba.ULS.sendTraceTag(22607297,365,10,"Undo hit an exception: {0}. Callstack: {1}",fb.message,fb.stack),b=!1,c=!0}m++;b?this.sh--:(ba.ULS.sendTraceTag(22607298,365,15,"Undo failed. [HitException: {0}] [AppMode: {1}]",c,ue.a[this.Jy]),this.lsi(),a=!1);if(this.hof.gwj()){y=!0;break}}b&&this.GIe(ja,G,null,U,!0);h.dispose();this.kw();
this.Z2a&&(this.Pvl(),this.aub());this.PH.updateCommandUI();this.skf.kaa();if(0<this.sh&&y&&this.Og.ga(this.sh).sT){a=this.sh;for(c=0;0<a&&this.Og.ga(a).sT;)c++,a--;this.Og.ga(this.sh).sT=!1;ba.ULS.sendTraceTag(22607299,365,50,"Cascading undos exceed the time limit, [MergesDone: {0}], [MergesToBeDone: {1}].",m,c)}else 1<m&&ba.ULS.sendTraceTag(22607300,365,50,"Cascading undos within the time limit, [MergesDone: {0}]",m);return b}kw(){this.ypb=this.G4a=!1}get fka(){return 0<this.ks}redo(){if(!this.fka)return!1;
this.kAd.execute(G=>{G.s_d()});var a=!0;let b=!1,c=!1;const h=this.yk.le(7);h.kd(this.Dz);let m=this.GW();const y=this.fof(!1);for(;this.fka&&a;){a=this.Og.ga(this.ks);const G=this.Og.ga(this.sh);ba.ULS.sendTraceTag(22607301,365,50,"Performing Redo [IsContinuation: {0}] [AppMode: {1}]",this.Og.ga(this.ks).sT&&this.Og.ga(this.sh).sT,ue.a[this.Jy]);try{if(b=this.thb(y,a.B1,G.B1,a.fKa||G.fKa))m=this.Og.ga(this.ks).Wib}catch(U){ba.ULS.sendTraceTag(22607302,365,10,"Redo hit an exception: {0}. Callstack: {1}",
U.message,U.stack),b=!1,c=!0}b?(this.sh=this.ks,this.ks<this.Og.length-1?(this.ks++,a=this.Og.ga(this.ks).sT&&this.Og.ga(this.sh).sT):(this.ks=-1,a=!1)):(ba.ULS.sendTraceTag(22607303,365,15,"Redo failed. [HitException: {0}] [AppMode: {1}]",c,ue.a[this.Jy]),this.doa(),a=!1)}b&&this.GIe(y,m,null,null,!1);h.dispose();this.kw();this.PH.updateCommandUI();this.skf.kaa();return b}GW(){return this.gxd()?this.DZh.Yra():null}IFk(a){return this.Z2a&&Eh.a.compare(a.Aq,this.unb)?(ba.ULS.sendTraceTag(512362002,
365,50,"Incremental Action in progress"),this.Rzl(),this.IFd=a.n,this.IFd===this.xhf&&(ba.ULS.sendTraceTag(23171274,365,100,"Incremental Action {0} was completed successfully",this.unb),this.csc()),!0):!1}onBeforeLoadContent(){}onAfterLoadContent(a){if(!this.azc&&!this.IFk(a.zi.Xw.id))if(this.Z2a&&(ba.ULS.sendTraceTag(23171276,365,50,"Incremental action {0} terminated due to inbound revision with ID {1}",this.unb,this.Dz.zi.Xw.id),this.csc()),!this.Oba.LLb())this.doa();else if(this.fka||this.LW)this.ALi(),
this.xfk()}doa(a=!1){this.cJc();a?this.YHf(null):(a=new He.a(2,1,0,this.Ybf,50),this.Wd.Eb(a))}uhh(a,b){if(b&&(1===(b.TO&1)||2===(b.TO&2))){a=this.fka;const h=this.LW;for(var c=this.Og.length-1;0<=c;c--){const m=Object(ua.a)(bf,this.Og.ga(c).B1);!m||m.irc!==b&&m.Aub!==b||(this.Og.removeAt(c),-1!==this.sh&&this.sh--,-1!==this.ks&&this.ks--)}b=this.fka;c=this.LW;!this.isActive||a===b&&h===c||(ba.ULS.sendTraceTag(36218332,365,15,"UndoRedo status is changed by revision removal:{0},{1},{2},{3}.",a,b,h,
c),this.PH.updateCommandUI())}}YHf(){this.gxd()&&this.dYa(D.a.LTa,this.GW())}fFa(){return this.azc}zrh(a){this.jMd=a}}Object(n.a)(Df,"UndoStack",null,[1493,106]);var Bi=d(789);class wi extends Sys.EventArgs{constructor(a){super();this.state=a}}Object(n.a)(wi,"RevisionStateArgs",Sys.EventArgs,[]);class Pf{constructor(a,b,c,h,m,y){this.dya=a;this.Wib=b;this.b6=c;this.actionId=h;this.sT=m;this.fKa=y}}Object(n.a)(Pf,"PPTLocalUndoRecord",null,[]);class Ci extends Df{constructor(a,b,c,h,m,y,G,U,ja,va,Ta,
fb,Db,gc,hc,Gc,Pc,yc,Vd,De,Wd,Ve,$e,Qf,lg,Hg,Qg,Sf,sh,Xg,ni,Ri,uj,dj,ej){super(a,b,c,h,m,y,G,U,ja,va,Ta,fb,Db,gc,hc,Gc,Pc,yc,Vd,Qg,dj,4,ej);this.x6c=!1;this.Ffc=-1;this.UL=[];this.lU=De;this.oye=Wd;this.mye=Ve;this.Pb=$e;this.la=Qf;this.Dma=lg;this.Fa=Hg;this.dWa=Sf;this.dWa.Nsf(Object(F.a)(this,this.DGb,"onRevisionProcessed"));this.hfb=sh;this.pa=Xg;this.kBe=ni;this.kDg=Ri;this.RVg=uj;this.iFg=Qg.LLb()&&!Qg.Z_a()}dYa(a,b,c=!1){let h=!1;b=this.RVg.iAl(b);var m=this.sh;this.oye.Rcl(a)?h=this.Kfk(a,
b):this.oye.sAi(a)?(h=this.Bni(a,b,c))&&this.ttl(a):this.doa();b=null;h?(m=this.sh-m,b=this.c6b(this.sh),this.bNk(b,!m),this.rab()||this.r0d()):this.RVg.JFj();m=null;this.la.designerSendActionDuration&&b&&b.B1&&b.B1.Q_d!==pa.a.nil&&(m=b.B1.Q_d);this.mye.Boj(a,h,m);return h}mLc(a,b){const c=0<=this.sh?this.Og.ga(this.sh):null;this.hfb.w1g(b,c,this.G4a,this.ypb);b=super.mLc(a,b);this.hfb.X0g(c,b,a);return b}nfg(a){let b=!1,c=null;a&&this.LW?c=this.Og.ga(this.sh):!a&&this.fka&&(c=this.Og.ga(this.ks));
c&&(b=this.MYc(c.b6));return b&&this.rab()}thb(a,b,c,h){let m=!1;if(this.nfg(a.$ab))(m=super.thb(a,b,c,h))&&this.Efk(a.Tka);else{const y=a.$ab?2:3;m=a.wch(G=>{this.lU.QGh(G,y)});this.sfk(a.Tka);this.dWa.njd(new wi(0))}return m}onBeforeLoadContent(a){super.onBeforeLoadContent(a);this.x6c&&this.dWa.njd(new wi(2))}onAfterLoadContent(a){super.onAfterLoadContent(a);this.x6c&&(this.dWa.njd(new wi(3)),this.x6c=!1)}dispose(){this.dWa.jih(Object(F.a)(this,this.DGb,"onRevisionProcessed"));super.dispose()}GIe(a,
b,c,h,m){a&&a.Tka!=pa.a.nil&&(this.kDg&&(h&&this.$Gh(h),b&&this.$Gh(b)),0<this.UL.length&&(h=new Pf(this.GW(),b,a.Tka,m?M.a.hZa:M.a.gZa,!1,this.iFg),Array.add(this.UL,h)),a.xme(),b&&0<this.UL.length?b.LU(void 0,c):(Nc.a.Ib&&(Nc.a.zfa(Nc.a.Ib),Nc.a.Ib.GB(li.a.zY,Nc.a.D9a(a.Tka.toString()).toString())),this.kDg&&(h=Object(ua.a)(134,this.Dz.contentReplicator))&&b&&this.kBe.tQk(h,a.Tka,b,c)))}DGb(a,b){b&&(!(a=b.faa)||2!==a.RevisionSource&&3!==a.RevisionSource||(this.x6c=!0,this.la.sfg||(b=2===a.RevisionSource?
Object(ua.a)(1462,this.Og.ga(0<this.ks?this.ks:this.Og.length-1).dya):Object(ua.a)(1462,this.Og.ga(this.sh).Wib))&&b.lAl(),this.UQi(a.ServerUndoStackLength,a.ServerRedoStackLength,a.LastServerUndoFail,a.LastServerRedoFail),this.dWa.njd(new wi(1))))}UQi(a,b,c,h){a!==this.sh&&Ba.a.J(512362001,823,50,"Undo stack length not synced. Server length: {0}, client: {1}",a,this.sh);if(a<this.sh||h){do this.Og.removeAt(this.sh--);while(this.sh>a);this.ks=0<this.ks?this.sh+1:-1;this.kBe.i2e()}if(!(0>this.ks)&&
(b!==this.Og.length-this.ks&&Ba.a.J(512362E3,823,50,"Redo stack length not synced. Server length: {0}, client: {1}",b,this.Og.length-this.ks),b<this.Og.length-this.ks||c)){do this.Og.removeAt(this.ks);while(this.Og.length-this.ks>b);if(!b||this.ks>=this.Og.length)this.ks=-1;this.kBe.i2e()}}$Gh(a){(a=Object(ua.a)(1462,a))&&a.jvl()}Nri(){if(this.la.Syb&&this.UL.length){var a=this.c6b(this.sh);if(a){var b=a.dya;if(this.MYc(a.b6)){for(let c=this.sh-1;0<c;c--){const h=this.c6b(c);if(!h)break;if(this.MYc(h.b6))b=
h.dya,this.Og.removeAt(c),this.sh--;else break}this.aub()}else this.Og.add(a),this.sh++,this.ks=-1;a.dya=b;a.sT=!1;this.Okd();this.r0d()}else this.aub(),this.Okd()}}wZe(){if(this.la.Syb){var a=this.c6b(this.sh);if(a){if(0<(-1===this.Ffc?0:this.Og.length-this.Ffc)){for(var b=this.Og.length-1;b>=this.Ffc;b--)this.Og.removeAt(b);for(b=0;0<=b&&b<this.UL.length;){var c=b;let h=!0;for(;h&&b<this.UL.length;)b<this.UL.length-1?(h=this.UL[b].sT&&this.UL[b+1].sT,b++):(h=!1,b=-1);c=this.UL[c];this.Og.add(new Ce(c.dya,
this.UL[0>b?this.UL.length-1:b-1].Wib,a.B1,c.actionId,!1,c.fKa))}this.sh=this.Og.length-1}this.ks=-1;this.Okd();this.r0d()}else this.aub(),this.Okd()}}get vwj(){if(this.la.Syb&&this.rab()){const a=this.c6b(this.sh);if(!a||0<this.UL.length&&!this.MYc(a.b6))return!1}return this.LW}r0d(){var a=this.la.Agk;if(this.sh>a){var b=0;for(a=this.sh-a-1;0<=a;a--)this.Og.removeAt(a),b++;this.sh-=b;b=this.ks-b;this.ks=0<b?b:-1}}Bni(a,b,c){const h=0<=this.sh?this.Og.ga(this.sh):null;this.ypb=!!h&&this.hfb.B_c(a)&&
h.actionId===a&&this.ypb;return super.dYa(a,b,c)}bNk(a,b){this.la.Syb&&a&&(this.rab()||this.oye.tAi(a.actionId))&&(this.UL.length||(this.Ffc=this.sh),b&&Array.removeAt(this.UL,this.UL.length-1),Array.add(this.UL,new Pf(a.dya,a.Wib,a.b6,a.actionId,a.sT,a.fKa)))}c6b(a){return 0<a&&a<=this.sh?this.Og.ga(a):null}$4d(a){a=a?this.sh:this.ks;return 0<=a&&a<this.Og.length?this.Og.ga(a).B1:null}kRc(a){a=a?this.sh:this.ks;return 0<=a&&a<this.Og.length?this.Og.ga(a).actionId:0}Okd(){Array.clear(this.UL);this.Ffc=
-1}rab(){const a=this.Fa.Be;return a?a.name!==Ua.a.rg&&a.name!==Ua.a.bna&&a.name!==Ua.a.HR&&a.name!==Ua.a.Sya&&a.name!==Ua.a.VO||!this.pa.pC()||this.XIj()?!1:!0:!1}qkb(a){x.ObjectSpace.p3(this.graphSpace.zi,!1).qkb(a)}ttl(a){this.la.Syb||this.qtl(a);this.ptl(a)}qtl(a){if(1<=this.sh&&this.clg(a)){const b=this.sh-1,c=this.Og.ga(b),h=c.actionId;h!==a&&!this.clg(h)||1!==this.Dma.Vwb(c.b6)||(this.Og.removeAt(b),this.sh=this.Og.length-1)}}ptl(a){if(1<=this.sh&&this.BHj(a)){const b=this.sh-1,c=this.Og.ga(b).actionId;
if(c===a||this.eKj(c))this.Og.removeAt(b),this.sh=this.Og.length-1}}clg(a){return a===D.a.rB||a===D.a.QBa||a===D.a.WQa||a===D.a.typing||a===D.a.enter}eKj(a){return a===M.a.IBa||a===M.a.ngd}BHj(a){return a===M.a.grb||a===M.a.Ikc||a===M.a.kHb}Kfk(a,b){const c=this.mLc(this.Dz.hT(),a);this.aub();a=new Ce(b,null,c,a,!1,this.iFg);this.Og.add(a);this.sh=this.Og.length-1;return!0}Efk(a){let b=null;this.pa.Hka()?b=this.pa.W3f():this.pa.pC()&&(b=this.pa.Jp());b&&this.dWa.veh(new Bi.a(b,a))}sfk(a){const b=
this.Pb.Nc(this.graphSpace);b.Bb(80);Object(ua.a)(388,b.xq).isDirty=!0;this.dWa.veh(new Bi.a(b.currentNode,a))}x2e(a){0>this.sh||(this.Og.ga(this.sh).Wib=a)}WYc(){return!this.UL.length}MYc(a){for(const b of this.UL)if(b.b6===a)return!0;return!1}XIj(){for(const a of this.pa.Xd())if(a.eb(X.a.clearFormatting))return!0;return!1}}Object(n.a)(Ci,"PPTUndoStack",Df,[]);class Tj{constructor(a){this.Fdk=a}JGi(a){const b=this.Fdk.pJf(a);return new Ci(a,()=>!!na.InteractiveViewManager.instance.Rd,new sb.a(()=>
Fc.App.MR),vb.a.instance.Ja("Common.Interface.IEditNotificationManager"),si.a.getInstance(),Ni.a.getInstance(),vb.a.instance.resolve("Box4.Graph.IGraphTransactionFactory"),vb.a.instance.resolve("Box4.IAppFrame"),vb.a.instance.resolve("Box4.IReplicationScheduler"),vb.a.instance.resolve("Box4.ISelectionReferenceFactory"),vb.a.instance.resolve("Common.ITaskManager"),vb.a.instance.resolve("Box4.ITypingActionOperationFactory"),()=>{},J.a.instance.ga(70),zd.a.instance,b.CEh,b.DEh,b.HEh,new Ac(Fc.App.GBf),
vb.a.instance.resolve("PowerPointWebEditor.IRevisionMetadataHelper"),vb.a.instance.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoSettings"),vb.a.instance.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoActionBehavior"),vb.a.instance.resolve("Box4.Graph.IGraphIteratorFactory"),vb.a.instance.resolve("PowerPointWebEditor.IApplicationSettings"),vb.a.instance.resolve("PowerPointWebEditor.ITextEditingRevisionInfoReader"),vb.a.instance.resolve("Common.IFocusManager"),vb.a.instance.resolve("Box4.UndoRedo.IUndoSettingsManager"),
vb.a.instance.resolve("PowerPointWebEditor.Graph.IGraphOperationEventSource"),vb.a.instance.resolve("PowerPointWebEditor.ITablePartialEditController"),vb.a.instance.resolve("PowerPointWebEditor.IPptSelectionManager"),vb.a.instance.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoSelectionRestoreExecutor"),vb.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").hermesUndoRedoNavigateSlideToRestoreSelectionIsEnabled,vb.a.instance.resolve("PowerPointWebEditor.UndoRedo.IUndoSelectionUpdater"),
vb.a.instance.re("Box4.ICoauthCashTelemetry"),Object(Rd.a)("SkipEnablingCascadeUndoIfNotCombiningUndoRecords"))}}Object(n.a)(Tj,"PPTUndoStackFactory",null,[1460]);class qh{constructor(){this.h3c=new bd.a}Bql(a){this.h3c.raiseEvent("MU",a)}RXb(a){this.h3c.addHandler("MU",a)}cPe(a){this.h3c.removeHandler("MU",a)}dispose(){this.h3c.dispose()}}Object(n.a)(qh,"UndoEventSource",null,[1457,1458,1459,106]);class Uj{constructor(a,b){this.pfb=0;this.V9c=null;this.Jve=!1;this.Hv=a;this.Rk=b;this.Rk.Zrf(Object(F.a)(this,
this.v1g,"onBeforeForceOutboundGraphTransactionInitialize"));this.Rk.Yrf(Object(F.a)(this,this.Qdd,"onForceOutboundGraphTransactionDisposed"))}dispose(){this.Rk.Chh(Object(F.a)(this,this.v1g,"onBeforeForceOutboundGraphTransactionInitialize"));this.Rk.lTk(Object(F.a)(this,this.Qdd,"onForceOutboundGraphTransactionDisposed"))}iAl(a){return 1===this.pfb&&this.V9c?this.V9c:a}JFj(){1===this.pfb&&(this.Jve=!0)}v1g(a,b){this.elg(b.transaction.gza)&&(this.pfb+=1,1===this.pfb&&(this.V9c=this.Hv.GW()))}Qdd(a,
b){this.elg(b.transaction.gza)&&(1===this.pfb&&(this.V9c=null,this.Jve||(a=this.Hv.GW(),this.Hv.x2e(a)),this.Jve=!1),--this.pfb)}elg(a){return 8===(a&8)}}Object(n.a)(Uj,"UndoSelectionUpdater",null,[1357,106]);var ol=d(587);class pl{constructor(a,b,c){this.Dz=a;this.nDd=b;this.FLd=c;this.pZ=x.ObjectSpace.r8(this.Dz.zi)}thb(a,b,c){a=this.FLd.iFi(this.nDd?a.irc:b.Aub,this.nDd?b.Aub:a.irc,this.pZ,c,Fc.App.ALa);if(b=!!a)this.pZ=a;return b}wch(a){const b=new Wg.a;b.rYe(this.Dz.zi,this.pZ);a(b);a=b.fPc();
x.ObjectSpace.p3(this.Dz.zi,!1).qkb(a);this.pZ=a;return!!a}xme(){const a=new ol.a(x.ObjectSpace.r8(this.Dz.zi),this.pZ);this.Dz.nAb(a)}get $ab(){return this.nDd}get Tka(){return this.pZ.id}}Object(n.a)(pl,"Box4UndoRedoPerformer",null,[1491]);class Lp{constructor(a,b){this.CEh=c=>{c&&this.Dz.Jfa();c=x.ObjectSpace.r8(this.Dz.zi);return new bf(c)};this.DEh=c=>new pl(this.Dz,c,this.FLd);this.HEh=c=>{if(c.QXd&&(this.Dz.hT()&&this.Dz.Jfa(),c.QXd&&(c=c.QXd))){var h=x.ObjectSpace.r8(this.Dz.zi);c.Aub=h}};
this.Dz=a;this.FLd=b}}Object(n.a)(Lp,"Box4UndoStackDataSyncHelper",null,[1477]);class Do{constructor(a){this.P1h=a}pJf(a){return new Lp(a,this.P1h(a.zi))}}Object(n.a)(Do,"Box4UndoStackDataSyncHelperFactory",null,[1456]);class Mp{constructor(a,b,c){this.Aeb=[];this.XEb=a;this.y9c=b;this.Xec=c}get b6(){return this.y9c}get Q_d(){return this.y9c}get MJ(){return this.Aeb}perform(){try{if(this.XEb){const a=this.XEb.perform();this.XEb=a.undoOperation;this.Aeb=k(a.sUc,this.Xec);return a}}catch(a){ba.ULS.sendTraceTag(0,
844,10,"FluidUndoRecordData.tryPerform exception: {0}.",a)}return null}combineWithPrevious(a){a&&a.XEb&&this.XEb.combineWithPrevious(a.XEb)}dispose(){}}Object(n.a)(Mp,"FluidUndoRecordData",null,[1492,106]);class rp{constructor(a,b){this.$cc=[];this.Lcb=a;this.Y8j=b}thb(a){return a?(a=a.perform(),this.Kbh(a)):!1}wch(a){const b=this.Lcb.zi.gNi.IKc();b.start(this.Lcb.zi);a(b);a=b.finish();return this.Kbh(a)}xme(){this.$cc.forEach(a=>{this.Lcb.nAb(a)})}get $ab(){return this.Y8j}get Tka(){return 0<this.$cc.length?
this.$cc[this.$cc.length-1].Ska:pa.a.nil}Kbh(a){return a?(a.sUc&&this.$cc.push(...a.sUc),!0):!1}}Object(n.a)(rp,"FluidUndoRedoPerformer",null,[1491]);class vn{constructor(a){this.CEh=b=>{var c,h;let m=null;b&&(m=this.Lcb.Jfa());return new Mp(null!==(c=null===m||void 0===m?void 0:m.undoOperation)&&void 0!==c?c:null,null!==(h=null===m||void 0===m?void 0:m.revisionId)&&void 0!==h?h:pa.a.nil,this.Lcb.zi)};this.DEh=b=>new rp(this.Lcb,b);this.HEh=()=>{};this.Lcb=a}}Object(n.a)(vn,"FluidUndoStackDataSyncHelper",
null,[1477]);class $l{pJf(a){return new vn(a)}}Object(n.a)($l,"FluidUndoStackDataSyncHelperFactory",null,[1456]);class Eo{constructor(a){this.lU=a}Qyl(a){this.lU.QGh(a,1);this.lU.Zzl(a)}}Object(n.a)(Eo,"PPTInverseRevisionUpdater",null,[1390]);class Fo{constructor(){this.K=null}get name(){return"PowerPointWebEditor.UndoRedo"}$b(a){this.K=a;a.register(jo,"Box4.UndoRedo.UndoSettingsManager").as("Box4.UndoRedo.IUndoSettingsManager").ma();a.register(Jn,"Box4.UndoRedo.UndoRevisionValidator").as("Box4.UndoRedo.IUndoRevisionValidator").ma().oa(()=>
new Jn(a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance));a.register(483,"Box4.ISelectionReferenceFactory").ma().oa(()=>{const b=a.resolve("PowerPointWebEditor.IApplicationSettings");return b.hermesUndoRedoNavigateSlideToRestoreSelectionIsEnabled?new oc(Ym.SelectionReferenceFactory.instance,a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.IPPTWorkspaceGraph"),a.resolve("PowerPointWebEditor.Graph.IPptGraphIteratorFactory"),
a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IPresentationReader"),a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("Box4.IParagraphReader"),a.resolve("Box4.ITableNavigator"),a.resolve("Common.IActionManager"),b.tC,a.resolve("PowerPointWebEditor.ISidUpdater"),a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventNotifier"),b.Ks):Ym.SelectionReferenceFactory.instance});a.register(ma,"PowerPointWebEditor.UndoRedo.PPTUndoRevisionMergeStrategy").as("Box4.UndoRedo.IUndoRevisionMergeStrategy").ma();
a.register(Xc,"PowerPointWebEditor.UndoRedo.PPTUndoSettings").as("PowerPointWebEditor.UndoRedo.IPPTUndoSettings").ma();a.resolve("PowerPointWebEditor.IApplicationSettings").ECa?a.register($l,"PowerPointWebEditor.UndoRedo.FluidUndoStackDataSyncHelperFactory").as("Box4.UndoRedo.IUndoStackDataSyncHelperFactory").ma():a.register(Do,"Box4.UndoRedo.Box4UndoStackDataSyncHelperFactory").as("Box4.UndoRedo.IUndoStackDataSyncHelperFactory").ma().oa(()=>new Do(b=>new f(x.ObjectSpace.p3(b,a.resolve("PowerPointWebEditor.IApplicationSettings").ECa),
a.resolve("Box4.UndoRedo.IUndoRevisionValidator"),a.resolve("Box4.UndoRedo.IUndoSettingsManager"),new wm,b,a.resolve("Box4.UndoRedo.IUndoRevisionMergeStrategy"),new Eo(a.resolve("PowerPointWebEditor.IRevisionMetadataHelper")))));a.register(Tj,"PowerPointWebEditor.UndoRedo.PPTUndoStackFactory").as("Box4.UndoRedo.IUndoStackFactory").ma().oa(()=>new Tj(a.resolve("Box4.UndoRedo.IUndoStackDataSyncHelperFactory")));a.register(Co,"PowerPointWebEditor.UndoRedo.PPTUndoActionBehavior").as("PowerPointWebEditor.UndoRedo.IPPTUndoActionBehavior").ma().oa(()=>
new Co(a.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoManager"),a.resolve("PowerPointWebEditor.BootStorage.ICoreOutboundHelper"),a.resolve("PowerPointWebEditor.UndoRedo.UndoEventSource"),a.resolve("Common.IActionManagerExtended")));a.register(ea,"PowerPointWebEditor.UndoRedo.PPTUndoManager").as("Box4.UndoRedo.UndoManager").as("Box4.IUndoManager").as("PowerPointWebEditor.UndoRedo.IPPTUndoManager").as("Box4.StorageObjectSpace.IUndoRevisionLoadingState").ma().oa(()=>new ea(a.resolve("Box4.UndoRedo.IUndoStackFactory"),
a.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),a.resolve("PowerPointWebEditor.View.IViewEventHandlers")));a.register(1354,"PowerPointWebEditor.UndoRedo.IPPTUndoSelectionRestoreExecutor").ma().oa(()=>new Ec);a.register(qh,"PowerPointWebEditor.UndoRedo.UndoEventSource").as("PowerPointWebEditor.UndoRedo.IUndoEventSource").as("PowerPointWebEditor.UndoRedo.IUndoEventNotifier").as("PowerPointWebEditor.UndoRedo.IUndoEventHandlers").ma();this.oxi(a);this.sxi(a);a.register(1355,"PowerPointWebEditor.IGroupUngroupUndoRedoActionController").ma().oa(()=>
new Ao(a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.Graph.GraphHierarchyHelper")))}oxi(a){a.register(1356,"PowerPointWebEditor.ITablePartialEditController").ma().oa(()=>{const b=a.resolve("PowerPointWebEditor.IApplicationSettings");return b.ZTj?new Bo(a.resolve("PowerPointWebEditor.BootStorage.ICoreOutboundHelper"),
a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.ITextEditingRevisionInfoTracker"),a.resolve("Box4.IWorkspace"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),b.Syb):new Xo})}sxi(a){a.register(1357,"PowerPointWebEditor.UndoRedo.IUndoSelectionUpdater").ma().oa(()=>new Uj(a.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoManager"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers")))}init(){const a=this.K.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoManager");
var b=this.K.resolve("Box4.IPageView");b.yg&&(b=b.yg.Ko(),a.register(b),a.setActive(b),a.dYa(D.a.LTa,null))}dispose(){this.K.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoManager").dispose();this.K.resolve("PowerPointWebEditor.UndoRedo.IUndoSelectionUpdater").dispose()}static main(){r.a.instance.Dc(new Fo)}}Object(n.a)(Fo,"PPTWebEditorUndoRedoPackage",null,[2,3]);class Mh{constructor(a=!1,b,c=!1,h=!1,m=!1,y=!1,G=!1){this.rUa=a;this.Zie=c;this.j$a=h;this.P8b=m;this.U8b=y;this.rYc=G}}Object(n.a)(Mh,
"DocModeSwitcherData",null,[]);var gt=d(842);class ht{constructor(a,b,c,h,m){this.iCb=!1;this.Fye=null;this.dCd=this.qDd=this.CCd=this.MCd=this.FCd=this.$Cd=this.vCd=this.cDd=this.kAa=this.mCd=this.sCd=this.JCd=this.jCd=this.BCd=this.Lcf=!1;this.mc=a;this.hl=b;this.Oc=c;this.Fv=m;this.Uzg=h.wMj;this.gva=h.pptOnlineFallbackToReadOnlyAfterBootEnabled;this.kdb=h.njg;this.Oak=u.AFrameworkApplication.Rz;this.reset()}initialize(){this.Oc.z7(Object(F.a)(this,this.Aw,"onUnifiedAppStateChanged"));this.Oc.mPa(Object(F.a)(this,
this.Ajc,"onOutboundReplication"));this.Fye=[Object(F.a)(this,this.Aqi,"checkIsInlineRepairedDocument"),Object(F.a)(this,this.xqi,"checkIrmProtection"),Object(F.a)(this,this.cri,"checkUserPermission"),Object(F.a)(this,this.Zpi,"checkFileFormats"),Object(F.a)(this,this.$pi,"checkFileLock"),Object(F.a)(this,this.Jqi,"checkPasswordProtection"),Object(F.a)(this,this.bqi,"checkFontRestriction"),Object(F.a)(this,this.Bqi,"checkIsMarkedFinal"),Object(F.a)(this,this.Cqi,"checkIsMarkedReadOnlyRecommended"),
Object(F.a)(this,this.Oqi,"checkSessionRestriction"),Object(F.a)(this,this.Nqi,"checkSessionAccessTokenExpired"),Object(F.a)(this,this.Gqi,"checkNetworkIssueHappened"),Object(F.a)(this,this.Kqi,"checkPopsHostIssueHappened"),Object(F.a)(this,this.jri,"checkWopiAccessTokenOutOfRefreshRange"),Object(F.a)(this,this.zqi,"checkIsEmergencyViewMode")];this.Qlh(this.Fye)}dispose(){this.Oc.jib(Object(F.a)(this,this.Aw,"onUnifiedAppStateChanged"))}reset(){this.dCd=this.sCd=this.qDd=this.CCd=this.MCd=this.FCd=
this.$Cd=this.vCd=this.cDd=this.mCd=this.JCd=this.kAa=this.jCd=this.BCd=this.Lcf=!1}Aw(a,b){Ba.a.J(22930964,809,50,"ReadOnlyUIManager::OnUnifiedAppStateChanged");this.reset();b.dab&&this.mc.Fn||(this.hl.TMf(),this.Qlh(this.Fye))}Ajc(){this.gva&&!this.iCb&&(this.iCb=!0);this.mc.rL||Ba.a.J(38633602,801,15,"Outbound on RO mode")}Qlh(a){if(a)for(const b of a)if(b())break}Zpi(){if(this.mLj||!this.mc.gg(64)||this.Uzg&&!(this.mc.gg(4)&&this.mc.gg(16)&&this.mc.gg(8)))return!0;if(!this.mc.getState(64))return!1;
if(this.Uzg&&this.mc.getState(4)&&!this.mc.getState(16)&&!this.mc.getState(8)){var a=u.AFrameworkApplication.Ta.La(M.a.RCa,2,Object.assign(new Mh,{rYc:!0,j$a:this.mc.getState(1)}));Ba.a.J(577524062,809,50,"ReadOnlyUIManager::CheckFileFormats - callout display (FormatConvertible)"+a.toString());this.hl.VK(10);Ba.a.J(24142428,809,50,"ReadOnlyUIManager::CheckFileFormats - business bar displayed (FormatConvertible)")}else a=u.AFrameworkApplication.Ta.La(M.a.RCa,2,Object.assign(new Mh,{U8b:!0,j$a:this.mc.getState(1)})),
Ba.a.J(578351494,809,50,"ReadOnlyUIManager::CheckFileFormats - callout display (FormatNotEditable)"+a.toString());return this.jCd=!0}xqi(){return this.wNj||!this.mc.gg(32768)?!0:this.mc.getState(32768)?(this.hl.VK(14),this.vCd=!0,Ba.a.J(24761164,809,50,"ReadOnlyUIManager::CheckIrmProtection - business bar displayed for FileIrmProtected"),!0):!1}$pi(){return this.oLj?!0:this.mc.gg(128)&&this.mc.getState(128)?(this.hl.VK(3),this.kAa=!0,Ba.a.J(24761166,809,50,"ReadOnlyUIManager::CheckFileLock - business bar displayed for PptEditCheckedOutByAnother"),
!0):this.mc.gg(256)&&this.mc.getState(256)?(this.hl.VK(4),this.kAa=!0,Ba.a.J(24761168,809,50,"ReadOnlyUIManager::CheckFileLock - business bar displayed for RequiresCheckout"),!0):this.mc.gg(512)&&this.mc.getState(512)?(this.hl.VK(5),this.kAa=!0,Ba.a.J(24761170,809,50,"ReadOnlyUIManager::CheckFileLock - business bar displayed for LockedForOfflineCheckout"),!0):this.mc.gg(1024)&&this.mc.getState(1024)?(this.hl.VK(6),this.kAa=!0,Ba.a.J(24761172,809,50,"ReadOnlyUIManager::CheckFileLock - business bar displayed for CannotAcquirePptEditLock"),
!0):this.mc.gg(2048)&&this.mc.getState(2048)?(this.hl.VK(7),this.kAa=!0,Ba.a.J(24761174,809,50,"ReadOnlyUIManager::CheckFileLock - business bar displayed for CannotAcquirePptEditSharedLock"),!0):this.mc.gg(4096)&&this.mc.getState(4096)?(this.hl.VK(8),this.kAa=!0,Ba.a.J(24761176,809,50,"ReadOnlyUIManager::CheckFileLock - business bar displayed for NumberOfCoauthorsReachedMax"),!0):this.mc.gg(8192)&&this.mc.getState(8192)?(this.hl.VK(9),this.kAa=!0,Ba.a.J(24761178,809,50,"ReadOnlyUIManager::CheckFileLock - business bar displayed for PptEditExistingExclusiveLock"),
!0):!1}Bqi(){if(this.fOj||!this.mc.gg(2)||!this.mc.gg(16))return!0;if(!this.mc.getState(2)&&this.mc.getState(16)){const a=u.AFrameworkApplication.Ta.La(M.a.RCa,2,Object.assign(new Mh,{rUa:!0,j$a:this.mc.getState(1)}));Ba.a.J(578351455,809,50,"ReadOnlyUIManager::CheckIsMarkedFinal - Callout display "+a.toString());return this.BCd=!0}return!1}Cqi(){if(!this.kdb)return!1;if(this.gOj||!this.mc.gg(2)||!this.mc.gg(524288))return!0;if(!this.mc.getState(2)&&this.mc.getState(524288)){const a=u.AFrameworkApplication.Ta.La(M.a.RCa,
2,Object.assign(new Mh,{Zie:!0,j$a:this.mc.getState(1)}));Ba.a.J(578351452,809,50,"ReadOnlyUIManager::CheckIsMarkedReadOnlyRecommended - Callout displayed "+a.toString());return this.CCd=!0}return!1}Jqi(){if(this.SPj||!this.mc.gg(2)||!this.mc.gg(32))return!0;if(!this.mc.getState(2)&&this.mc.getState(32)){const a=u.AFrameworkApplication.Ta.La(M.a.RCa,2,Object.assign(new Mh,{P8b:!0,j$a:this.mc.getState(1)}));Ba.a.J(578351449,809,50,"ReadOnlyUIManager::CheckPasswordProtection - Callout display "+a.toString());
return this.JCd=!0}return!1}Aqi(){return this.bNj||!this.mc.gg(2097152)?!0:this.mc.getState(2097152)?(this.hl.VK(22),this.sCd=!0,Ba.a.J(42824021,809,50,"ReadOnlyUIManager:: - Inline repaired document business bar displayed"),!0):!1}zqi(){var a=!1;if(this.PKj||!this.mc.gg(4194304))return!0;this.mc.getState(4194304)&&(a="NotAvailable",this.Fv&&(a=this.Fv.Yvb(),a=gt.a[a]),Mf.Health.instance.recordQosError("EmergencyViewModeEnabledReason"+a,["ViewByDefault"],!0,!0,!1,!1,null),32===u.AFrameworkApplication.Ta.processAction(M.a.Crc,
1)?(a=u.AFrameworkApplication.Ta.processAction(M.a.Crc,2),Ba.a.J(578351445,809,15,"ReadOnlyUIManager:: EmergencyViewMode Emergency View Mode displayed in Doc Mode Switcher "+a.toString())):(this.hl.VK(23),Ba.a.J(593295554,809,15,"ReadOnlyUIManager:: EmergencyViewMode business bar displayed")),this.dCd=a=!0);return a}bqi(){return!this.LLj&&this.mc.gg(2)&&this.mc.gg(8)?!this.mc.getState(2)&&this.mc.getState(8)?(this.hl.VK(12),this.mCd=!0,Ba.a.J(24142434,809,50,"ReadOnlyUIManager::CheckFontRestriction - business bar displayed"),
!0):!1:!0}cri(){if(this.zKj||!this.mc.gg(1))return!0;if(!this.mc.getState(1)){const a=u.AFrameworkApplication.Ta.La(M.a.RCa,2,new Mh);Ba.a.J(578351441,809,50,"ReadOnlyUIManager::CheckUserPermission - Callout display "+a.toString());return!0}return!1}Oqi(){return this.BSj?!0:this.mc.gg(16384)&&this.mc.getState(16384)?(this.hl.VK(13),this.cDd=!0,Ba.a.J(24761184,809,50,"ReadOnlyUIManager::CheckSessionRestriction - business bar displayed"),!0):!1}Nqi(){return this.zSj?!0:this.mc.gg(65536)&&this.mc.getState(65536)?
(Mf.Health.instance.recordQosError("SessionAccessTokenExpired",["SessionExpired"],!1,!1,!0,!0,null),this.gva?this.hl.LMc(15,this.iCb):this.hl.VK(15),this.$Cd=!0,Ba.a.J(37066185,809,50,"ReadOnlyUIManager::CheckSessionAccessTokenExpired - business bar displayed"),!0):!1}Kqi(){return this.tQj?!0:this.mc.gg(262144)&&this.mc.getState(262144)&&this.gva?(this.hl.LMc(17,this.iCb),this.MCd=!0,Ba.a.J(37310543,809,50,"ReadOnlyUIManager::CheckPopsHostIssueHappened - business bar displayed"),!0):!1}jri(){return this.PVj?
!0:this.mc.gg(1048576)&&this.mc.getState(1048576)&&this.gva&&this.Oak?(this.hl.LMc(21,this.iCb),this.qDd=!0,Ba.a.J(39327011,809,50,"ReadOnlyUIManager::CheckWopiAccessTokenOutOfRefreshRange - business bar displayed"),!0):!1}Gqi(){return this.COj?!0:this.mc.gg(131072)&&this.mc.getState(131072)&&this.gva?(this.hl.LMc(16,this.iCb),this.FCd=!0,Ba.a.J(37310545,809,50,"ReadOnlyUIManager::CheckNetworkIssueHappened - business bar displayed"),!0):!1}get zKj(){return this.Lcf}get fOj(){return this.BCd}get mLj(){return this.jCd}get SPj(){return this.JCd}get bNj(){return this.sCd}get LLj(){return this.mCd}get oLj(){return this.kAa}get BSj(){return this.cDd}get wNj(){return this.vCd}get zSj(){return this.$Cd}get COj(){return this.FCd}get tQj(){return this.MCd}get gOj(){return this.CCd}get PVj(){return this.qDd}get PKj(){return this.dCd}}
Object(n.a)(ht,"ReadOnlyUIManager",null,[1352,106]);class it{constructor(a,b,c,h){this.Vzg=!1;this.Aw=()=>{Ba.a.J(509367064,809,50,"FilterPrivacyUIManager::OnUnifiedAppStateChanged");this.bNf()};this.qLj=()=>!this.Yb.ka("FilterPrivacyBusinessBarEnabled")||this.Vzg?!1:this.mc.gg(16777216)?this.mc.getState(16777216):(Ba.a.J(509367063,809,50,"FilterPrivacyUIManager::IsFilterPrivacyEnabled - business bar not displayed, filterPrivacyEnabled field not ready"),!1);this.bNf=()=>{this.qLj()&&(this.hl.VK(27),
this.Vzg=!0,Ba.a.J(509366796,809,15,"FilterPrivacyUIManager::DisplayFilterPrivacyBusinessBar - business bar displayed"))};if(!h)throw Error.argumentNull("appSettingsManager");this.mc=a;this.hl=b;this.Oc=c;this.Yb=h}initialize(){this.Oc.z7(this.Aw);this.bNf()}dispose(){this.Oc.jib(this.Aw)}}Object(n.a)(it,"FilterPrivacyUIManager",null,[1353,106]);class sp{constructor(){this.lte=this.Xfc=this.K=null}get name(){return"PowerPointWebEditor.UnifiedApp"}$b(a){this.K=a;this.K.register(1352,"PowerPointWebEditor.UnifiedApp.IReadOnlyUIManager").ma().oa(()=>
new ht(this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),this.K.resolve("PowerPointWebEditor.IBusinessBarController"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.Application.IReadOnlyManager")));this.K.register(1353,"PowerPointWebEditor.UnifiedApp.IFilterPrivacyUIManager").ma().oa(()=>new it(this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),this.K.resolve("PowerPointWebEditor.IBusinessBarController"),
this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("Common.IAppSettingsManager")))}init(){this.K.resolve("PowerPointWebEditor.IApplicationSettings").ZEa&&(this.Xfc=this.K.resolve("PowerPointWebEditor.UnifiedApp.IReadOnlyUIManager"),this.lte=this.K.resolve("PowerPointWebEditor.UnifiedApp.IFilterPrivacyUIManager"),this.Xfc.initialize(),this.lte.initialize())}dispose(){this.Xfc&&this.Xfc.dispose();this.Xfc&&this.lte.dispose()}static main(){r.a.instance.Dc(new sp)}}Object(n.a)(sp,
"PPTWebEditorUnifiedAppPackage",null,[2,3]);var mi=d(273);class Eq{constructor(a,b,c,h){this.Fb=a;this.hr=b;this.vE=c;this.iva=h}Lja(){const a=new Nd.a;a.$(0,Object(F.a)(this,this.tableBorderAndResizeHandlesClickHandler,"tableBorderAndResizeHandlesClickHandler"));a.$(1,Object(F.a)(this,this.pptTableColumnHandleClickHandler,"pptTableColumnHandleClickHandler"));a.$(2,Object(F.a)(this,this.pptTableRowHandleClickHandler,"pptTableRowHandleClickHandler"));a.$(3,Object(F.a)(this,this.backgroundClickHandler,
"backgroundClickHandler"));a.$(4,Object(F.a)(this,this.shapeClickHandler,"shapeClickHandler"));return a}tableBorderAndResizeHandlesClickHandler(a){return this.hr.U3(a.Cc)||this.hr.LUa(a.Cc)||this.hr.p_c(a.Cc)?(this.Fb.Eub(),mi.a.Tl(!0)):mi.a.notHandled}pptTableColumnHandleClickHandler(a){if(this.hr.vua(a.Cc)){const b=this.hr.s9d(a.Cc);if(!b||!b.Ck)return Ba.a.J(22577752,822,15,"Clicked on a table column handle but failed to get a ShapeViewElement."),mi.a.Tl(!1);b.Ck.$p||this.hr.zJc(a.Cc,a.eV,a.Yi.Yf);
return mi.a.Tl(!0)}return mi.a.notHandled}pptTableRowHandleClickHandler(a){if(this.hr.r$b(a.Cc)){const b=this.hr.s9d(a.Cc);if(!b||!b.Ck)return Ba.a.J(41209868,822,15,"Clicked on a table row handle but failed to get a ShapeViewElement."),mi.a.Tl(!1);b.Ck.$p||this.hr.WZk(a.Cc,a.eV,a.Yi.Yf);return mi.a.Tl(!0)}return mi.a.notHandled}backgroundClickHandler(a){return this.Fb.i$b(a)?(this.iva.setVisibility(!1),mi.a.Tl(!0)):mi.a.notHandled}shapeClickHandler(a){let b=mi.a.notHandled;this.vE.b$b||(b=this.vE.ZUe(a));
this.vE.b$b=!1;if((a=this.vE.Mvb(a))&&!a.ZN||a&&a.shapeNode&&a.shapeNode.ud&&a.ZN)return mi.a.Tl(!0);this.iva.setVisibility(!1);return b}}Object(n.a)(Eq,"ClickHandlers",null,[]);var lo=d(421),Al=d(426);class tp{constructor(a,b,c,h,m,y){this.Fb=a;this.pa=b;this.Fa=c;this.ia=h;this.vE=m;this.HDb=y}Lja(){const a=new Nd.a;a.$(0,Object(F.a)(this,this.noContextMenuHandler,"noContextMenuHandler"));a.$(1,Object(F.a)(this,this.slideBackgroundContextMenuHandler,"slideBackgroundContextMenuHandler"));a.$(2,Object(F.a)(this,
this.shapeContextMenuHandler,"shapeContextMenuHandler"));return a}noContextMenuHandler(a){return this.Fb.Oth(a)?lo.a.notHandled:lo.a.Tl(null)}slideBackgroundContextMenuHandler(a){return this.Fb.i$b(a)?(this.pa.Vx(),this.pa.Qh(),this.Fa.Ed(),this.ia.La(M.a.AVd,2,a.Yi),lo.a.Tl(null)):lo.a.notHandled}shapeContextMenuHandler(a){var b=this.vE.Mvb(a);if(this.Zdl(b,a))b.fDa(),this.HDb?b.$x||this.ia.La(M.a.LPa,2,new Al.a(b.shapeNode,!0,a.Yi)):this.ia.La(M.a.LPa,2,new Al.a(b.shapeNode,!0,a.Yi));else if(this.Wdl(b))return this.pa.Vx(),
(b=this.vE.Uhj(b,a))&&this.pa.selectShape(b,!0),this.Fa.Ed(),this.ia.La(M.a.zVd,2,a.Yi),lo.a.Tl(null);return lo.a.notHandled}Zdl(a,b){return!!a&&!!a.shapeNode&&a.shapeNode.isConnected&&a.shapeNode.Skg&&!a.syb(b.Yi)}Wdl(a){return!!a||this.pa.bH()||!this.pa.Pa.length}}Object(n.a)(tp,"ContextMenuClickHandlers",null,[]);class kr{constructor(a,b,c,h,m){this.Fb=a;this.hr=b;this.vE=c;this.ia=h;this.Qdc=m}Lja(){const a=new Nd.a;a.$(0,Object(F.a)(this,this.tableBorderAndHandlesDoubleClickHandler,"tableBorderAndHandlesDoubleClickHandler"));
a.$(1,Object(F.a)(this,this.shapeDoubleClickHandler,"shapeDoubleClickHandler"));a.$(2,Object(F.a)(this,this.backgroundDoubleClickHandler,"backgroundDoubleClickHandler"));return a}tableBorderAndHandlesDoubleClickHandler(a){return this.hr.U3(a.Cc)||this.hr.LUa(a.Cc)||this.hr.p_c(a.Cc)?(this.Fb.Eub(),mi.a.Tl(!0)):this.hr.vua(a.Cc)||this.hr.r$b(a.Cc)?(this.Fb.Eub(),mi.a.Tl(!1)):mi.a.notHandled}shapeDoubleClickHandler(a){return this.vE.Mvb(a)?(this.Fb.Eub(),mi.a.Tl(!1)):mi.a.notHandled}backgroundDoubleClickHandler(a){return this.Fb.i$b(a)?
(this.Fb.Eub(),this.Qdc||this.ia.processAction(M.a.JEa,2,{DoubleClickInsert:"true"}),mi.a.Tl(!0)):mi.a.notHandled}}Object(n.a)(kr,"DoubleClickHandlers",null,[]);class lr{constructor(a,b,c,h,m){this.vE=a;this.QC=b;this.ia=c;this.Ea=h;this.lO=m}K1f(){return Object(F.a)(this,this.acd,"mouseUpHandlerFilter")}acd(a){return a?(a=this.QC.i8d(a.Cc))&&a.gb&&this.Ea.Zm(a.gb)&&this.lO.PUa&&this.vE.LVe?(this.ia.processAction(D.a.Bja,2),!0):this.vE.LVe=!1:!1}}Object(n.a)(lr,"MouseInputHandlers",null,[]);var xm=
d(274);class mr{constructor(a,b,c,h){this.vE=a;this.Qb=b;this.n0=c;this.Ie=h}Lja(){const a=new Nd.a;a.$(0,Object(F.a)(this,this.backgroundPointerDownHandler,"backgroundPointerDownHandler"));a.$(1,Object(F.a)(this,this.shapePointerDownHandler,"shapePointerDownHandler"));a.$(2,Object(F.a)(this,this.defaultPointerDownHandler,"defaultPointerDownHandler"));return a}backgroundPointerDownHandler(a){this.Qul();return this.vE.exf(a)}Qul(){this.Ie.Qge()||Nc.a.M0d("ScrollActiveThumbnailIntoView",M.a.Pib,()=>
{this.Ie.Zld();return 32})}shapePointerDownHandler(a){this.Qb.YW&&this.n0.show(3,-1);const b=this.vE.Mvb(a);if(b&&b.shapeNode&&b.shapeNode.Rf&&!b.shapeNode.Kg)return mi.a.Tl(!1);if((Sys.UI.DomElement.containsCssClass(a.Cc,xm.a.rya)||Sys.UI.DomElement.containsCssClass(a.Cc,xm.a.HLb)||Sys.UI.DomElement.containsCssClass(a.Cc,xm.a.eVe)||Sys.UI.DomElement.containsCssClass(a.Cc,xm.a.$qd)||Sys.UI.DomElement.containsCssClass(a.Cc,xm.a.Nzh)||Sys.UI.DomElement.containsCssClass(a.Cc,xm.a.aAh))&&b.isSelected&&
!b.ZN||void 0!==b&&null!==b&&b.shapeNode.Mp)return this.vE.b$b=!1,mi.a.Tl(!0);this.vE.b$b=!0;a=this.vE.ZUe(a);a.B3&&(this.vE.LVe=!0);return a}defaultPointerDownHandler(){return mi.a.Tl(!0)}}Object(n.a)(mr,"PointerDownHandlers",null,[]);class nr{constructor(a){this.vE=a}Lja(){const a=new Nd.a;a.$(0,Object(F.a)(this,this.backgroundPointerUpHandler,"backgroundPointerUpHandler"));a.$(1,Object(F.a)(this,this.shapePointerUpHandler,"shapePointerUpHandler"));a.$(1,Object(F.a)(this,this.shapePointerUpHandler,
"shapePointerUpHandler"));a.$(2,Object(F.a)(this,this.defaultPointerUpHandler,"defaultPointerUpHandler"));return a}backgroundPointerUpHandler(a){return this.vE.exf(a)}shapePointerUpHandler(a){const b=this.vE.Mvb(a);return b&&b.shapeNode&&b.shapeNode.Rf&&!b.shapeNode.Kg?mi.a.Tl(!1):this.vE.ZUe(a)}defaultPointerUpHandler(){return mi.a.Tl(!0)}}Object(n.a)(nr,"PointerUpHandlers",null,[]);class Np extends Sys.EventArgs{constructor(){super()}}Object(n.a)(Np,"SlideBackgroundClickedEventArgs",Sys.EventArgs,
[]);class Op{constructor(a,b,c,h,m,y,G,U){this.Fb=a;this.hr=b;this.pa=c;this.iva=h;this.Fa=m;this.vJ=y;this.vma=G;this.Ea=U;this.LVe=this.b$b=!1}exf(a){return this.Fb.i$b(a)?(this.pa.Vx(),a=a.Yi,this.vJ.keh(new Np(!1)),(a.ctrlKey||a.shiftKey)&&a.lA===Sys.UI.MouseButton.leftButton?this.pa.ij():this.pa.Qh(),this.iva.setVisibility(!1),this.Fa.Ed(),mi.a.Tl(!0)):mi.a.notHandled}ZUe(a){const b=this.Mvb(a);b&&this.pa.Vx();const c=Sys.UI.DomElement.containsCssClass(a.Cc,xm.a.rya)||Sys.UI.DomElement.containsCssClass(a.Cc,
xm.a.HLb)||Sys.UI.DomElement.containsCssClass(a.Cc,xm.a.eVe),h=this.hr.p_c(a.Cc)||this.hr.U3(a.Cc)||this.hr.LUa(a.Cc);Nc.a.xk("isEventFromHandlers",c.toString());Nc.a.xk("isEventFromTableHandlers",h.toString());return c&&!h&&b&&b.ZN?(this.pa.ij(),this.iva.setVisibility(!1),this.Fa.Ed(),mi.a.Tl(!0)):h&&b&&!b.ZN?(b.r1g(a.Yi),mi.a.Tl(!0)):!b||b.ZN&&!this.Wge(a)?mi.a.notHandled:(b.Msk(a.Yi),mi.a.Tl(!0))}Mvb(a){let b=this.hr.zI(a.Cc);if(!b){var c=a.Cc,h=Wa.a(c,oa.a.role);h=h?h.toString()===zc.a.DYb:!1;
if(Sys.UI.DomElement.containsCssClass(c,"ListMarker")||h)for(;!b&&c;){b=this.hr.zI(c);if(Sys.UI.DomElement.containsCssClass(c,"Outline")&&Sys.UI.DomElement.containsCssClass(c,"OutlineSized"))break;c=c.parentNode}}if(b){c=Object(ua.a)(117,b);if(!c&&(this.hr.p_c(a.Cc)||this.hr.U3(a.Cc)||this.hr.LUa(a.Cc))&&(c=this.vma.B4b(this.Ea.Zm(b.gb)),!c))return Ba.a.J(39322434,822,15,"Clicked on a table resize handle but failed to get its ContainerShapeViewElement."),null;if(c||(c=this.vma.B4b(this.Ea.Zm(b.gb)))&&
c.XA&&!(c.$x||c.$p||c.Wke))return c}return null}Wge(a){return a&&a.Cc?a.Cc.id.startsWith(xf.a.Xqb):!1}Uhj(a,b){return a?this.Thj(a):this.Shj(b.graphNode)}Thj(a){let b=null;a.isSelected&&this.pa.bH()||(b=Object(ua.a)(4,a.gb));return b}Shj(a){let b=null;if(a){const c=rb.GraphIterator.nb(a);c.rc(10)?(a=Object(ua.a)(4,c.Ng(10)),this.pa.cX(a)||(b=a)):Ba.a.J(22577757,808,15,"Unexpected type of graph node gets clicked, type: {0}, Id {1}",a.type,a.id)}return b}}Object(n.a)(Op,"ViewEventHandlerHelper",null,
[1389]);class or{constructor(){this.K=null}get name(){return"PowerPointWebEditor.ViewEventHandler"}$b(a){this.K=a;a.register(Eq,"PowerPointWebEditor.ViewEventHandler.ClickHandlers").ma().oa(()=>new Eq(a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IViewElementHelper"),a.resolve("PowerPointWebEditor.ViewEventHandler.IViewEventHandlerHelper"),a.resolve("Box4.IGrippersManager")));a.register(kr,"PowerPointWebEditor.ViewEventHandler.DoubleClickHandlers").ma().oa(()=>
new kr(a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IViewElementHelper"),a.resolve("PowerPointWebEditor.ViewEventHandler.IViewEventHandlerHelper"),a.resolve("Common.IActionManager"),a.resolve("PowerPointWebEditor.IApplicationSettings").Yxb));a.register(tp,"PowerPointWebEditor.ViewEventHandler.ContextMenuClickHandlers").ma().oa(()=>new tp(a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.IFocusManager"),
a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.ViewEventHandler.IViewEventHandlerHelper"),a.resolve("PowerPointWebEditor.IApplicationSettings").pptContextMenuCrashFix));a.register(mr,"PowerPointWebEditor.ViewEventHandler.PointerDownHandlers").ma().oa(()=>new mr(a.resolve("PowerPointWebEditor.ViewEventHandler.IViewEventHandlerHelper"),a.resolve("Box4.IAppFrame"),a.resolve("PowerPointWebEditor.IOfflineModalCallout"),a.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView")));
a.register(nr,"PowerPointWebEditor.ViewEventHandler.PointerUpHandlers").ma().oa(()=>new nr(a.resolve("PowerPointWebEditor.ViewEventHandler.IViewEventHandlerHelper"),a.resolve("Box4.IAppFrame"),a.resolve("PowerPointWebEditor.IOfflineModalCallout")));a.register(lr,"PowerPointWebEditor.ViewEventHandler.MouseInputHandlers").ma().oa(()=>new lr(a.resolve("PowerPointWebEditor.ViewEventHandler.IViewEventHandlerHelper"),a.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementUtility"),a.resolve("Common.IActionManagerExtended"),
a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.ViewCore.IFormatPainterContext")));a.register(Op,"PowerPointWebEditor.ViewEventHandler.ViewEventHandlerHelper").as("PowerPointWebEditor.ViewEventHandler.IViewEventHandlerHelper").ma().oa(()=>new Op(a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IViewElementHelper"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("Box4.IGrippersManager"),a.resolve("PowerPointWebEditor.IFocusManager"),
a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventNotifier"),a.resolve("PowerPointWebEditor.View.IShapeViewHelper"),a.resolve("PowerPointWebEditor.IShapeReader")))}init(){const a=this.K.resolve("PowerPointWebEditor.View.IPPTPageView");a.P3h(this.K.resolve("PowerPointWebEditor.ViewEventHandler.ClickHandlers").Lja());a.C4h(this.K.resolve("PowerPointWebEditor.ViewEventHandler.DoubleClickHandlers").Lja());a.q4h(this.K.resolve("PowerPointWebEditor.ViewEventHandler.ContextMenuClickHandlers").Lja());
a.X5h(this.K.resolve("PowerPointWebEditor.ViewEventHandler.PointerDownHandlers").Lja());a.$5h(this.K.resolve("PowerPointWebEditor.ViewEventHandler.PointerUpHandlers").Lja());this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptTextFormatPainterIsEnabled&&this.K.resolve("Common.MouseInputManager").pb(ra.a.xJ,a.container,this.K.resolve("PowerPointWebEditor.ViewEventHandler.MouseInputHandlers").K1f())}dispose(){this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptTextFormatPainterIsEnabled&&
this.K.resolve("Common.MouseInputManager").yb(ra.a.xJ,this.K.resolve("PowerPointWebEditor.View.IPPTPageView").container,this.K.resolve("PowerPointWebEditor.ViewEventHandler.MouseInputHandlers").K1f())}static main(){r.a.instance.Dc(new or)}}Object(n.a)(or,"PPTWebEditorViewEventHandlerPackage",null,[2,3]);var ng=d(78),Yo;(function(a){a[a.notLoaded=1]="notLoaded";a[a.loaded=2]="loaded";a[a.failed=3]="failed"})(Yo||(Yo={}));Object(n.b)("WebSocketCompressionHelperLoadState",Yo);var ql=d(87),Fq=d(343),
Zo;(function(a){a[a.connecting=0]="connecting";a[a.open=1]="open";a[a.closing=2]="closing";a[a.closed=3]="closed"})(Zo||(Zo={}));Object(n.b)("WebSocketState",Zo);class pr{constructor(a,b,c,h,m){this.nfc=this.Ml=this.aFb=null;this.zHa=-1;this.ydb=this.qla=0;this.xbc=-1;this.KCb=0;this.LCb=null;this.IVa=0;if(!a)throw Error.argumentNull("webSocketClient");this.Iv=a;this.Xa=b;this.tE=c;this.Oc=h;a=document.createElement("a");a.href=this.Iv.AEl;a.protocol="http:"===a.protocol?"ws":"wss";Rd.a("PodsWebSocketFrontDoor.UseQueryString")?
(a=new Vl.QueryStringBuilder(a.href),Rd.a("PodsWebSocketFrontDoor.UseWacClusterQueryString")&&a.Ki(ca.a.M8g,b.nk),Rd.a("PodsWebSocketFrontDoor.UseUsidQueryString")&&a.Ki(ca.a.pxk,u.AFrameworkApplication.userSessionId),a.Ki(ca.a.Ekc,m.toString()),this.aFb=a.toString()):this.aFb=a.href;this.Cdb=ng.a.UD(this.aFb);this.S_b(2);this.qma=this.Iv.Tkh;this.bpe=this.Iv.wti;this.XUe();this.Oc.qPa(Object(F.a)(this,this.ygb,"onSessionEnding"));this.Oc.WB(Object(F.a)(this,this.Bo,"onSessionRehydrated"))}dispose(){this.Oc.qPe(Object(F.a)(this,
this.ygb,"onSessionEnding"));this.Oc.Dfa(Object(F.a)(this,this.Bo,"onSessionRehydrated"))}S_b(a){this.Ml&&this.Ml.close();this.Ml=new WebSocket(this.aFb,[]);this.Ml.onopen=Object(F.a)(this,this.onOpen,"onOpen");this.Ml.onerror=Object(F.a)(this,this.onError,"onError");this.Ml.onclose=Object(F.a)(this,this.onClose,"onClose");this.Ml.onmessage=Object(F.a)(this,this.onMessage,"onMessage");this.IVa=a;Ba.a.J(556541794,this.Iv.MQ,50,"WebSocketFetcher::ConnectWebSocket - WebSocket connected WebSocketDomain:{0}, WacCluster:{1}, ConnectionReason:{2}",
this.Cdb,this.Xa.nk,this.IVa)}ping(){if(this.Ml)if(1===this.Ml.readyState){const a=this.Iv.CEi();this.Ml.send(a)}else Ba.a.J(559284698,this.Iv.MQ,10,"WebSocketFetcher::Ping. Wrong WebSocket state {0}",this.Ml.readyState),this.Txa(4);else Ba.a.J(559284697,this.Iv.MQ,50,"WebSocketFetcher::Ping Websocket is unavailable.")}Dti(){this.Ml.close()}onOpen(){Ba.a.J(591208995,this.Iv.MQ,50,"WebSocketFetcher::OnOpen WebSocketDomain:{0}, WacCluster:{1}",this.Cdb,this.Xa.nk);this.boc();this.KCb=0;this.LCb=null;
this.Iv.lnk()}onError(a){Ba.a.J(591208993,this.Iv.MQ,10,"WebSocketFetcher::OnError {0}, WebSocketDomain:{1}, WacCluster:{2}",JSON.stringify(a),this.Cdb,this.Xa.nk)}onClose(a){Ba.a.J(591208991,this.Iv.MQ,50,"WebSocketFetcher::OnClose WebSocketDomain:{0}, WacCluster:{1}, EventInfo:{2}, CloseEventCode:{3}, CloseEventReason:{4}",this.Cdb,this.Xa.nk,JSON.stringify(a),a.code,a.reason);this.KCb=a.code;this.LCb=a.reason}onMessage(a){try{a&&a.data&&this.Iv.nqk(a)}catch(b){Ba.a.J(559284699,this.Iv.MQ,10,"WebSocketFetcher::OnMessage",
b.toString())}}XUe(){this.nfc=()=>{"visible"===window.document.visibilityState?(window.clearTimeout(this.xbc),this.Ml||(Ba.a.J(559284700,this.Iv.MQ,50,"WebSocketFetcher::PageVisibilityEventHandler Reconnecting after visibility regained."),this.Txa(1))):this.xbc=window.setTimeout(()=>{this.Ml&&(Ba.a.J(559284701,this.Iv.MQ,50,"WebSocketFetcher::PageVisibilityEventHandler Closing due to visibility lost."),this.KCb=1E3,this.LCb="Lost visibility",this.Ml.close(this.KCb,this.LCb),this.Ml=null,window.clearTimeout(this.zHa))},
this.bpe)};window.self.addEventListener("visibilitychange",this.nfc)}boc(){this.qla=0}VOd(){0<this.Iv.Obd&&(new Date).getTime()-this.ydb>this.Iv.Obd&&(this.boc(),Ba.a.J(559284702,this.Iv.MQ,50,"WebSocketFetcher::Retry connect to server after long pause."))}NSd(){const a=!!this.tE&&!!this.tE.instance&&!this.tE.instance.S3,b=(new Date).getTime()-this.ydb>this.qma,c=this.qla<this.Iv.PXg,h=!this.Ml||3===this.Ml.readyState||2===this.Ml.readyState,m=a&&b&&c&&h;Ba.a.J(557181E3,this.Iv.MQ,50,"WebSocketFetcher::CanRetry: canRetry:{0}, isPodsSessionAlive:{1}, retryTimeReached:{2}, retryAttemptsAvailable:{3}, noWebSocket:{4}",
m,a,b,c,h);return m}fUe(){this.ydb=(new Date).getTime();this.qma=Math.pow(2,this.qla)*this.Iv.Tkh;0<this.Iv.Obd&&(this.qma=Math.min(this.qma,this.Iv.Obd));window.setTimeout(()=>{this.Txa(3)},this.qma)}Txa(a){this.VOd();this.NSd()&&(this.S_b(a),this.fUe(),this.qla++,a!==this.IVa&&Ba.a.J(541671620,this.Iv.MQ,10,"WebSocketFetcher::ReconnectionReasonMismatch ReconnectionReason:{0}, m_reconnectionReason{1}",a,this.IVa),Ba.a.J(559284703,this.Iv.MQ,50,"WebSocketFetcher::Retry connect to server. ReconnectionReason:{0}",
this.IVa),this.qla===this.Iv.PXg&&Ba.a.J(559284704,this.Iv.MQ,50,"WebSocketFetcher::Max retries reached. ReconnectionReason:{0}",this.IVa))}sendMessage(a,b){if(!this.Ml)return Ba.a.J(559284705,this.Iv.MQ,50,"WebSocketFetcher::SendMessage Websocket is unavailable. RequestType:{0}, LastCloseCode:{1}, LastCloseReason:{2}",b,this.KCb,this.LCb),1;Ba.a.J(559284706,this.Iv.MQ,50,"WebSocketFetcher::SendMessage. WebSocket state {0}, RequestType:{1}, LastCloseCode:{2}, LastCloseReason:{3}",Zo[this.Ml.readyState],
b,this.KCb,this.LCb);if(1===this.Ml.readyState)return this.Ml.send(a),0;this.Txa(5);return 2}P$k(){this.Ml.binaryType="arraybuffer"}yGb(){-1!==this.zHa&&window.clearTimeout(this.zHa);this.zHa=window.setTimeout(()=>{this.ping()},this.Iv.Wzk)}$ri(){this.IVa=0}ygb(){this.Ml&&(Ba.a.J(557352418,this.Iv.MQ,50,"WebSocketFetcher::OnSessionEnding: closing due to session ending."),this.Ml.close(),this.Ml=null)}Bo(){this.Ml||(Ba.a.J(557352419,this.Iv.MQ,50,"WebSocketFetcher::OnSessionRehydrated: reconnecting after session rehydrated."),
this.Txa(6))}}Object(n.a)(pr,"WebSocketFetcher",null,[1410,106]);var Gq;(function(a){a[a.none=0]="none";a[a.visibilityRegainedReconnection=1]="visibilityRegainedReconnection";a[a.initialConnection=2]="initialConnection";a[a.timeoutReconnection=3]="timeoutReconnection";a[a.webSocketNotOpenOnPingReconnection=4]="webSocketNotOpenOnPingReconnection";a[a.webSocketNotOpenedReconnection=5]="webSocketNotOpenedReconnection";a[a.sessionRehydrationReconnection=6]="sessionRehydrationReconnection"})(Gq||(Gq={}));
Object(n.b)("ConnectionReason",Gq);var qr;(function(a){a[a.success=0]="success";a[a.nullWebSocket=1]="nullWebSocket";a[a.webSocketNotOpened=2]="webSocketNotOpened"})(qr||(qr={}));Object(n.b)("SendMessageStatusCode",qr);class Pp extends Sys.EventArgs{constructor(a,b,c){super();this.response=a;this.IYk=b;this.pJj=c}}Object(n.a)(Pp,"WebSocketFrontDoorEventArgs",Sys.EventArgs,[]);var Pg=d(646);class wn{constructor(a,b,c,h,m){this.Nm=window.performance.now();this.cze=new bd.a;this.Jre=this.Dcc=!0;this.qBb=
null;this.gFb=1;this.Xa=b;this.q7c=a.yEl;this.bye=a.zEl;this.c$j=a.wEl;this.hbk=a.xEl;this.C4j=a.uEl;this.QDb=a.zud;this.Iad=a.OBl;this.GBe=a.vEl;this.Cdb=ng.a.UD(this.GBe);this.Dwa=new pr(this,b,c,h,new Fq.a(a.sfa));this.evg=a.PJc;if(m)this.qBb=m;else throw Error.argumentNull("dynamicScriptLoader");}dispose(){this.Dwa.dispose()}ping(){this.Dwa.ping()}Gx(a){const b=new Map,c=this.Rmj(a);a.smartArtEditOpRequest&&(b.set("requestType",c),b.set("correlationId",a.smartArtEditOpRequest.commonData?a.smartArtEditOpRequest.commonData.correlationId:
null),Mf.Health.instance.recordKpiUsage("DeltaEdit",1,"gc2smartart",b));this.QDb?(a=this.Dwa.sendMessage(JSON.stringify(a),c),0!==a&&(b.set("SendMessageStatusCode",qr[a]),Mf.Health.instance.recordKpiFailure("DeltaEdit","SendRequestFailure",!1,!0,Object.assign(new ql.a,{extendedProperties:b})))):Mf.Health.instance.recordKpiFailure("DeltaEdit","WebSocketProtobufBRSDisabled",!0,!0,Object.assign(new ql.a,{extendedProperties:b}))}C$h(a){this.cze.addHandler("ResponseReceivedEventId",a)}GUk(a){this.cze.removeHandler("ResponseReceivedEventId",
a)}lnk(){if(this.QDb){var a=Nc.a.Ib?Nc.a.Ib.actionId:Eh.a.create().toString(),b=u.AFrameworkApplication.userSessionId,c=this.Xa.nk;this.Jre=!0;b=Pg.p(a,b,this.Xa.podSessionId,c);b=this.Dwa.sendMessage(JSON.stringify(b),"validateSession");Ba.a.J(557175649,839,0===b?50:10,"PodsFrontDoorWebSocket::OnConnectionOpened ValidateSessionRequest correlationId:{0}, SendMessageStatusCode:{1}, WebSocketDomain:{2}, WacCluster:{3}",a,qr[b],this.Cdb,c)}}nqk(a){if(this.QDb)try{const b=this.xTi(a);if(b.pong)this.yGb(b.pong.pingTimestamp);
else if(b.validateSessionResponse)this.suk(b.validateSessionResponse);else if(b.compressionHandshakeResponse)this.gnk(b.compressionHandshakeResponse);else{const c=Object.getType(a.data)!==String;this.cze.raiseEvent("ResponseReceivedEventId",new Pp(b,this.Kfj(a,c),c))}}catch(b){Ba.a.J(541618382,839,10,"PodsFrontDoorWebSocket Failed to parse WebSocketFrontDoorServiceResponse")}else this.yGb(a.data)}xTi(a){let b=Object.getType(a.data)===String?a.data:null;if(b)return JSON.parse(b);if(2===this.gFb)return a=
new Uint8Array(a.data),b=WebSocketCompressionHelper.WebSocketCompressionHelper.decompressTextWithDeflateRaw(a),JSON.parse(b);Ba.a.J(541349337,839,10,"PodsFrontDoorWebSocket: ExtractMessageReceive could not decompress data because WebSocketCompressionHelper is not loaded");return JSON.parse("")}Kfj(a,b){return b?(new Uint8Array(a.data)).byteLength:a.data.length}suk(a){if(a.isValid){if(this.evg){a=Nc.a.Ib?Nc.a.Ib.actionId:Eh.a.create().toString();const b=u.AFrameworkApplication.userSessionId,c=this.Xa.podSessionId,
h=this.Xa.nk;Ba.a.J(541161497,839,50,"PodsWebSocketFrontDoor::OnValidateSessionResponse - WebSocketCompressionHelperLoadState:{0}",Yo[this.gFb]);1===this.gFb?this.XZj(a,b,c,h):2===this.gFb&&this.boh(a,b,c,h)}this.ping()}else Ba.a.J(556541795,839,10,"PodsWebSocketFrontDoor::OnMessageReceived - Closing WebSocket because session not valid. WebSocketDomain:{0}, WacCluster:{1}",this.Cdb,this.Xa.nk),this.Dwa.Dti()}XZj(a,b,c,h){this.evg&&this.qBb.loadScript("WebSocketCompressionHelper").then(()=>{this.gFb=
2;this.boh(a,b,c,h)}).catch(()=>{Ba.a.J(541710233,839,10,"PodsFrontDoorWebSocket WebSocketCompressionHelper failed to load");this.gFb=3})}boh(a,b,c,h){a=Pg.a(a,b,c,!0,h);a=this.Dwa.sendMessage(JSON.stringify(a),"compressionHandshake");Ba.a.J(541710232,839,50,"PodsFrontDoorWebSocket WebSocketCompressionHelper loaded and sent compression handshake with status code {0}",a)}gnk(a){a=a.clientReadyForCompression;Ba.a.J(541710234,839,50,"PodsFrontDoorWebSocket WebSocket compression handshake received with value {0}",
a);a&&this.Dwa.P$k()}Rmj(a){return a.ping?"ping":a.validateSessionRequest?"validateSession":a.compressionHandshakeRequest?"compressionHandshake":a.smartArtEditOpRequest&&a.smartArtEditOpRequest.editOps&&a.smartArtEditOpRequest.editOps[0].resizeEditOp?"resizeEditOp":"unknown"}yGb(a){this.Dwa.yGb(a);ta.a.Wa(a)?Ba.a.J(561639837,839,10,"PodsFrontDoorWebSocket::OnPingReply Invalid pingTimestampStr"):(a=parseFloat(a),isNaN(a)?Ba.a.J(591208987,839,10,"PodsFrontDoorPing::OnMessage Ping response not a number. m_protobufEnabled:{0}",
this.QDb):(a={["PingTime"]:window.performance.now()-this.Nm-a,MeasurementType:"Performance.Now"},a.First=this.Dcc?1:0,a.WebSocketFrontDoorProtobufEnabled=this.QDb,a.PostConnectionPing=this.Jre,a.ConnectionReason=Gq[this.Dwa.IVa],this.Dwa.$ri(),this.Jre=this.Dcc=!1,Ba.a.J(591208985,839,50,Da.a.toJSON(a))))}CEi(){var a=(window.performance.now()-this.Nm).toString();if(!this.QDb)return a;a=Pg.q(Pg.l(a),null,null,null,this.Xa.nk);return JSON.stringify(a)}get AEl(){return this.Iad&&!ta.a.Wa(this.GBe)?this.GBe:
u.AFrameworkApplication.fa.appSettings.WebServiceBase+"WebSocketFrontDoorServiceHandler.ashx"}get MQ(){return 839}get Wzk(){return this.bye}get PXg(){return this.q7c}get Tkh(){return this.hbk}get Obd(){return this.c$j}get wti(){return this.C4j}}Object(n.a)(wn,"PodsWebSocketFrontDoor",null,[1350,106,1388]);class Ql{constructor(){this.K=null}get name(){return"PowerPointWebEditor.WebSocketFrontDoor"}$b(a){if(!a)throw Error.create("PPTWebEditorWebSocketFrontDoorPackage : container is null");this.K=a;
a.register(1350,"PowerPointWebEditor.WebSocketFrontDoor.IWebSocketFrontDoor").ma().oa(()=>{try{return new wn(a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.Ja("PowerPointWebEditor.ISessionLifetimeManager"),a.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),a.resolve("Common.IDynamicScriptLoaderProvider").Pw)}catch(b){return Ba.a.J(591208983,839,10,"exception creating PodsWebSocketFrontDoor: "+b),null}})}init(){}dispose(){this.K.resolve("PowerPointWebEditor.WebSocketFrontDoor.IWebSocketFrontDoor").dispose()}static main(){r.a.instance.Dc(new Ql)}}
Object(n.a)(Ql,"PPTWebEditorWebSocketFrontDoorPackage",null,[2,3]);var rr=d(1133),Hq=d(1142);class uu{constructor(a=null){this.jo=null;this.reset();this.CVb=a}aYb(a,b){if(!this.CVb||this.CVb.zVe())b in this.jo||(this.jo[b]=[]),this.jo[b].push(a)}getData(){return Da.a.count(this.jo)?this.jo:null}reset(){this.jo={}}}Object(n.a)(uu,"NamedValuesAggregator",null,[1522]);class Go{constructor(){this.jo=new Qa.a}get MMk(){return this.jo.count}aYb(a){this.jo.add(a)}getData(){return this.MMk?Sa.toArray(this.jo):
null}reset(){this.jo=new Qa.a}}Object(n.a)(Go,"BatchDataAggregator",null,[1522]);var $o;(function(a){a[a.LanguageInfo=0]="LanguageInfo";a[a.FeedbackLoop=1]="FeedbackLoop";a[a.Config=2]="Config"})($o||($o={}));Object(n.b)("ApiType",$o);class Iq{constructor(a,b){this.ei=a;this.qHd=b}Gx(a,b,c){if(c){a=$o[a];var h={"Content-Type":"application/json; charset=utf-8"};h["X-StatelessPopsAffinityRoutingEnabled"]=u.AFrameworkApplication.fa.ka("PPTStatelessPOPSRequestAffinityEnabled").toString();this.ei.Aj(this.qHd()+
"&apitype="+a,2,b,h,!1,3,Object(F.a)(this,this.eKa,"requestSucceeded"),Object(F.a)(this,this.cKa,"requestFailed"),c,void 0,void 0,void 0,void 0,"28")}}eKa(a){if(!u.AFrameworkApplication.Tg&&a&&a.data){var b=a.data.state;b&&b.PUc(b,a.data.Zd)}}cKa(a){!u.AFrameworkApplication.Tg&&a&&a.data&&(a=a.data.state)&&a.AUc(a)}}Object(n.a)(Iq,"EditorServiceRequestManager",null,[1296]);class fs extends Sys.EventArgs{constructor(a){super();this.nodeId=a}}Object(n.a)(fs,"ErrorRangesChangedEventArgs",Sys.EventArgs,
[]);var Ak=d(272);class ap{constructor(a,b,c){this.begin=a;this.end=b;this.Gh=c}}Object(n.a)(ap,"ErrorRange",null,[237]);class sr{constructor(a,b){this.Kn=a;this.eQh=b}get Ee(){return this.Kn}get Gh(){return this.eQh}$d(a){return new sr(a||this.Kn,this.Gh)}}Object(n.a)(sr,"SpellingErrorObject",null,[146]);class mo{constructor(a,b,c){this.Oa=new bd.a;this.pr=a;this.UZh=b;this.GTh=c}oqf(a,b){b=this.Kwh(a,b);if(!Ma.a.Wa(b)){for(var c=this.BF(a),h=[],m=0,y=0;m<b.length&&y<c.length;){const G=c[y],U=b[m];
U.end<=G.begin?++m:(G.end>U.begin&&Array.add(h,G),++y)}c=a.y0a();try{const G=a.gja();try{this.Lgh(a,h),this.pqf(a,b)}finally{G&&G.dispose()}}finally{c&&c.dispose()}this.Ocd(a)}}YJa(a,b,c=!1){if(!Ma.a.Wa(b)){c=c?null:a.y0a();try{const h=a.gja();try{this.Lgh(a,b)}finally{h&&h.dispose()}}finally{c&&c.dispose()}this.Ocd(a)}}eWk(a,b){const c=a.y0a();try{const h=a.gja();try{this.JTd(a),b=this.Kwh(a,b),Ma.a.Wa(b)||this.pqf(a,b)}finally{h&&h.dispose()}}finally{c&&c.dispose()}}JTd(a){const b=a.y0a();try{const c=
a.gja();try{const h=a.Ra;for(a=0;a<h.length;a++){const m=h.ga(a);m.Up&&(m.Up=null);m.yL=!1}}finally{c&&c.dispose()}}finally{b&&b.dispose()}}BF(a,b=null){const c=[];let h=0,m=null;var y=!1;a=a.Ra;for(let G=0;G<a.length;G++){const U=a.ga(G);if(U.yL){const ja=U.cp;m?(y=new ap(h,ja,m),b&&!b(y)||Array.add(c,y)):y?ba.ULS.sendTraceTag(41300895,324,10,"Encountered CHP SpellingError without ErrorDetails set"):ba.ULS.sendTraceTag(41300896,324,10,"Encountered SpellingErrorEnd without the begin: Begin CP {0}, End CP {1}",
h,ja);y=!1}U.Up&&(y=!0,h=U.cp,m=U.Up.Gh)}return c}vSa(a){if(!a||!Bb.SelectionEditor.ek(a)&&!Bb.SelectionEditor.Sg(a))return null;const b=a.node;let c=a.Qa,h=a.Nb;a=Bb.SelectionEditor.Sg(a);const m=this.pr.text(b);for(const y of this.BF(b))if(a){if(y.begin<=c&&y.end>=h)return y}else if(y.begin<=c&&y.end>=c&&ta.a.ryi(m,y.end,h))return y;return null}Toc(a){if(!this.GTh||!a||!(a.lca||2===a.length&&Bb.SelectionEditor.Wl(a.Ye)))return!1;a=this.vSa(a.Ua);if(!a)return!1;if(a=Object(ua.a)(287,a.Gh))if(a.OIh=
!0,a.Die())return!1;return!a||5!==a.proofingType}Kwh(a,b){if(Ma.a.Wa(b))return b;b=Array.clone(b);for(var c=b.length-1;0<=c;c--){var h=b[c];h&&h.Gh||(ba.ULS.sendTraceTag(41300897,324,15,"Received malformed ErrorRange: {0}. Filtering it out.",h?"Null error details":"Null range"),Array.removeAt(b,c))}if(!b.length)return b;Ak.d(b);c=[];this.UZh&&Array.addRange(c,this.pr.xSa(a));c=Ak.a(c);for(h=a=0;h<b.length&&a<c.length;){let m=b[h];const y=c[a];m.begin<y.end&&y.begin<m.end?Array.removeAt(b,h):m.end<
y.end?h++:a++}return b}pqf(a,b){let c=!1;for(const h of b){b=h.Gh;c=1===b.proofingType||c;let m=a.Cub(h.begin);m.Up=new sr(m,b);m.isFromErrorRangeSplit=!0;m=a.Cub(h.end);m.yL=!0;m.isFromErrorRangeSplit=!0}c&&(a.wyb=!1)}Lgh(a,b){if(!Ma.a.Wa(b)){a=a.Ra;for(const c of b){b=a.aT(c.begin);const h=a.aT(c.end);b&&b.Up&&h&&h.yL?(b.Up=null,h.yL=!1):(b=String.format("Could not find and remove ErrorRange from CHPs. Cp Begin: {0}, Cp End: {1}",c.begin,c.end),ba.ULS.sendTraceTag(37532355,324,10,b))}}}j9h(a){this.Oa.addHandler("OnErrorRangesChanged",
a)}Ocd(a){if(this.Oa.b7b){const b=this.BF(a);this.Oa.raiseEvent("OnErrorRangesChanged",new fs(a.id.toString(),b))}}}Object(n.a)(mo,"ErrorRangeEditor",null,[1295]);var Mn=d(211);class gs{constructor(){this.Mbf=new Mn.a}contains(a,b){return a?this.Mbf.contains(ta.a.tBh(a,b)):!1}add(a,b){a&&this.Mbf.add(ta.a.tBh(a,b))}}Object(n.a)(gs,"IgnoreAllKeywords",null,[1261]);var Bk=d(212);class Qp extends Bk.a{constructor(a,b,c){super(b,c);this.xG=a;this.uJa=this.Y$=-1;this.kTd=0;this.textUnit=2}get lcid(){return this.xG}}
Object(n.a)(Qp,"ModifiedRange",Bk.a,[]);class Nn{constructor(a,b,c,h){this.I2h=a;this.xK=b;this.$M=c;this.Ijf=h}get Bhd(){return this.Ijf?this.Ijf.instance:null}Sxf(a,b){const c=[];if(Ma.a.Wa(a)||Ma.a.Wa(b))return c;if(1===b.length){b=b[0].lcid;for(var h of a)Array.add(c,new Qp(b,h.begin,h.end))}else{a=Array.clone(a);a.reverse();h=0;do{var m=b[h];let y=m.lcid;for(m=m.end;0<a.length&&m>a[a.length-1].begin;){const G=a.pop(),U=G.end,ja=Math.min(U,m);U>m&&a.push(new Bk.a(m,U));Array.add(c,new Qp(y,G.begin,
ja))}h++}while(0<a.length&&h<b.length);ba.ULS.shipAssertTag(37836432,324,!a.length,"Did not process all modified ranges in the stack")}return c}RSi(a,b,c,h){let m,y;({yCe:m,fCe:y}=Nn.dUf(a,c,b));c=0;let G=a.begin,U=a.end;const ja=this.Bhd;let va=!1;ja?(c=ja.findEndBoundary(b,U-1,y),h||-1!==c||this.u$f(b,a)?c=-1===c?y:c:va=!0):va=!0;if(va)return this.l_f(a,b,this.$M.k0g,m,y);if(!m)for(;" "===b.charAt(m)&&m<b.length;)m++;a=Math.max(ja.findBeginBoundary(b,G,m),m);return Bk.a.createTextRange(a,c)}QSi(a,
b,c){return this.ERf(a,b,c,this.$M.k0g)}PSi(a,b){if(!a||Ma.a.Wa(b))return a;let c=a.begin,h=a.end,m=!1;for(const y of b){if(a.end<=y.begin)break;a.begin>y.begin&&a.begin<y.end&&(c=y.begin,m=!0);a.end>y.begin&&a.end<y.end&&(h=y.end,m=!0)}return m?Bk.a.createTextRange(c,h):a}gdl(a,b){if(!a||!b)return!1;const c=a.begin;a=a.end;return!ta.a.bzb(b.substring(c,a))&&!ta.a.qyi(b,c,a)}v3i(a,b,c){if(!a||!c||Ma.a.Wa(b))return 0;a=Ak.c([a],b);b=0;for(const h of a)b+=this.I2h.A6f(c,h.begin,h.end);return b}I4h(a,
b,c,h){if(a&&b){var m=a.begin,y=a.end,G=this.$M.Qkk;if(0>=G)a.Y$=m,a.uJa=y;else if(G=this.ERf(a,b,h,G)){b=a.lcid;h=G.begin;G=G.end;if(0>h||this.lth(h,m,b,c))h=m;this.lth(y,G,b,c)&&(G=y);a.Y$=h;a.uJa=G}else a.Y$=m,a.uJa=y}}u$f(a,b){return this.Bhd?-1!==this.Bhd.findEndBoundary(a,b.begin,b.end):!1}lth(a,b,c,h){if(a>=b)return!0;if(1>=h.length)return!1;a=this.Sxf([new Bk.a(a,b)],h);return 1!==a.length||a[0].lcid!==c}ERf(a,b,c,h){if(!a||!b||0>h)return null;let m;({yCe:c,fCe:m}=Nn.dUf(a,c,b));return this.l_f(a,
b,h,c,m)}l_f(a,b,c,h,m){return Bk.a.createTextRange(this.xK.NWi(b,c,a.begin,h),this.xK.tWi(b,c,a.end,m))}static dUf(a,b,c){let h;h=0;c=c.length;if(Ma.a.Wa(b))return{yCe:h,fCe:c};let m=a.begin;a=a.end;let y=!1,G=!1;for(const U of b)if(!y&&U.end<=m?h=U.end:y=!0,!G&&U.begin>=a&&(c=U.begin,G=!0),y&&G)break;return{yCe:h,fCe:c}}}Object(n.a)(Nn,"ModifiedExpandRangeHelper",null,[1293]);var Wi=d(344);class hs{constructor(a,b){this.LBd=null;this.Cg=a;this.xK=b;this.BG=Ob.ParagraphReader.text(this.Cg);this.Djf=
[]}tmj(a,b){return this.WTc(this.xK.w3b(this.BG,a,b))}WTc(a){return a?this.T9d(a.begin,a.end):null}T9d(a,b){this.LBd=this.LBd||this.xK.sRc(this.Cg);return this.xK.WTc(a,b,this.BG,this.LBd)}iEa(a,b){(a=this.T9d(a,b))&&Array.add(this.Djf,a)}l5b(){return Array.clone(this.Djf)}}Object(n.a)(hs,"ValidatedRangeContainer",null,[]);class bp{constructor(a,b,c,h,m,y){this.Gm=a;this.xK=b;this.Tc=c;this.$M=h;this.r_h=m;this.$Xh=y}Qvb(a){return new hs(a,this.xK)}Jbi(a){const b=a.YYd.currentNode;var c=a.Pwh.currentNode;
const h=a.E7g;a=this.kta(b);const m=this.Qvb(b);c=this.kta(c);for(var y of c)m.iEa(h+y.begin,h+y.end);Array.addRange(a,m.l5b());if(y=m.tmj(h,h))Array.add(a,y),this.POe(b,y,0);b.G0=a}Kbi(a,b,c){var h=a.G0;if(Ma.a.Wa(h)||h[h.length-1].end<=c)this.ZIc(b);else{var m=[],y=this.Qvb(a),G=this.Qvb(b);for(const U of h)if(h=U.end,h>c){const ja=U.begin;ja<c?(y.iEa(ja,c),G.iEa(0,h-c)):G.iEa(ja-c,h-c)}else Array.add(m,U);c=y.l5b();Array.addRange(c,m);a.G0=c;b.G0=G.l5b();a.kpc();b.kpc()}}W7k(a){Ob.ParagraphReader.Yd(a)&&
!this.xK.$Ta(a)&&(this.Gm.JTd(a),this.PPe(a,[new Bk.a(0,Ob.ParagraphReader.textLength(a))]))}yqh(a,b){b&&a&&Ob.ParagraphReader.Yd(a)&&!this.xK.$Ta(a)&&!a.aC&&this.sYg(a,this.Qvb(a).WTc(b),D.a.typing)}Brh(a,b,c){a&&this.yqh(a,this.xK.w3b(Ob.ParagraphReader.text(a),b,c))}PPe(a,b){if(Ob.ParagraphReader.Yd(a))if(Ma.a.Wa(b))this.ZIc(a);else{const c=this.Qvb(a);for(const h of b)c.iEa(h.begin,h.end);a.G0=c.l5b()}}ZIc(a){Ob.ParagraphReader.Yd(a)&&(a.G0=null)}Pnd(a,b,c=null){if(Ob.ParagraphReader.Yd(a)&&!a.aC&&
!Ma.a.Wa(b)){Ak.d(b);var h=null;if(this.$M.myb||this.$M.WTa)h=U=>1===U.Gh.proofingType;h=this.Gm.BF(a,h);for(var m=[],y=0,G=0;G<h.length&&y<b.length;){const U=b[y],ja=h[G];U.end<=ja.begin?y++:(ja.end<=U.begin||ja.begin>=U.begin&&ja.end<=U.end&&(0!==ja.Gh.errorType||ja.begin!==U.begin)&&Array.add(m,ja),G++)}this.Gm.YJa(a,m);h=this.kta(a);b=Ak.b(h,b);c&&(c=Ak.c(h,[c]),0<c.length&&(b=Ak.e(b,c)));this.PPe(a,b)}}kta(a){return Ob.ParagraphReader.Yd(a)?a.G0||[]:[]}Pdi(a,b,c,h,m=0){const y=a.node;if(Ob.ParagraphReader.Yd(y)&&
!this.xK.$Ta(y)&&!y.aC){var G=Ob.ParagraphReader.text(y),U=a.Qa,ja=a.Nb+h;this.r_h?(U=a.Qa+b,ja=a.Nb-c+h):this.$Xh&&(b=this.Tc.Qj,0<=h&&b&&Bb.SelectionEditor.Sg(b)&&(b=b.Qa,0<=b&&b<=G.length&&(b=this.xK.w3b(G,b,b))&&b.begin>=U&&b.end<=ja&&(U=b.begin,ja=b.end)));b=this.Qvb(y);c=null;0<=h&&(c=b.T9d(U,ja));c||(c=this.xK.w3b(G,U,ja));0<=h?this.sYg(y,c,m):this.mzl(y,a.Qa,a.Nb,c,b,h,m)}}sYg(a,b,c){if(b){var h=this.kta(a);Array.add(h,b);a.G0=h;a.kpc();this.POe(a,b,c)}}mzl(a,b,c,h,m,y,G){const U=this.kta(a),
ja=[];if(U.length)if(U[U.length-1].end<b)if(h)Array.addRange(ja,U);else return;else{for(const va of U)va.end<b?Array.add(ja,va):va.begin>=c?m.iEa(va.begin+y,va.end+y):va.begin<b?va.end>c?m.iEa(va.begin,va.end+y):m.iEa(va.begin,b):va.end>c&&m.iEa(b,va.end+y);Array.addRange(ja,m.l5b())}h&&(Array.add(ja,h),this.POe(a,h,G));a.G0=ja;a.kpc();this.Gm.Ocd(a)}POe(a,b,c){const h=this.Gm.BF(a,y=>y.begin<=b.end&&y.end>=b.begin);if((c===D.a.RQd||c===D.a.typing||c===D.a.cut||c===D.a.paste)&&1===h.length&&h[0].Gh){c=
h[0].Gh;var m=Fa.a.ue(c.lcid);m=m?m.name:bp.AKh;const y=Object(za.a)(Wi.a,c)?c.typeId:bp.PKh;ba.ULS.sendTraceTag(40486211,375,50,"ManualEdits CritiqueId:{0}, CultureTag:{1}",y,m);c.OIh&&ba.ULS.sendTraceTag(40486212,375,50,"ClickNoAction CritiqueId:{0}, CultureTag:{1}",y,m)}this.Gm.YJa(a,h)}}bp.PKh="";bp.AKh="UNKNOWN";Object(n.a)(bp,"ModifiedRangeEditor",null,[1292]);class up{constructor(a,b,c,h,m,y,G,U,ja,va,Ta=null){this.Gm=a;this.Fz=b;this.UWb=c;this.rK=h;this.p3a=m;this.ZNa=y;this.xK=G;this.z4a=
U;this.O7e=ja;this.Waf=Ta||up.EIi;this.Ulf=!1;va.execute(fb=>{this.Ulf=!!fb})}CFh(a){if(a&&Ob.ParagraphReader.Yd(a)&&a.aVc){let b=null;this.O7e.fua&&(b=c=>!!c.Gh&&1===c.Gh.proofingType);a.wyb=Ma.a.Wa(this.Fz.kta(a))&&Ma.a.Wa(this.Gm.BF(a,b))}}Mbj(a,b){var c=this.Obj(a,b);if(Ma.a.Wa(c))return[];const h=Ob.ParagraphReader.text(a).replace("\u00a0"," "),m=this.Gm.BF(a),y=this.D3k(a,m),G=y&&this.rAi(a),U=this.xK.wTf(a),ja=Ak.e(this.xK.vTf(a),U);c=this.d8i(c,b,h,ja,m,y,G);if(Ma.a.Wa(c))return[];b=this.p3a.X$i(a);
c=this.ZNa.Sxf(c,b);if(Ma.a.Wa(c))return[];this.AGk(a,h,c);a=this.Fz.kta(a);for(const va of c)this.ZNa.I4h(va,h,b,U),va.kTd=this.ZNa.v3i(va,a,h),y&&(G||this.ZNa.u$f(h,va))&&(va.textUnit=4);return c}lWi(a){if(this.Waf()||!a||""===a.sa(kb.a.pq,""))return null;var b=this.z4a.y3b;if(!b||!Bb.SelectionEditor.Sg(b)||b.node!==a||!this.wwj(a))return null;b=b.Qa;return this.xK.w3b(Ob.ParagraphReader.text(a),b,b)}Odi(a,b,c,h,m,y,G=0){this.rK.Nc(a.node).gf()&&(this.Fz.Pdi(a,b,c,y,G),this.UWb.hBl(a,h,m))}wwj(a){const b=
Ak.a(this.Fz.kta(a));if(!b.length)return!1;a=Ak.a(this.Gm.BF(a));let c=0,h=0;for(;c<a.length&&h<b.length;){const m=b[h],y=a[c];m.begin>=y.begin&&m.end<=y.end?h++:c++}return h!==b.length}Obj(a,b){if(!a||a.vhe)return null;a=this.Fz.kta(a);return a.length&&b?Ak.b(a,[b]):a}D3k(a,b){return this.Ulf&&this.O7e.fua?a.TSb||!b.length||Ma.a.any(b,c=>!!c.Gh&&2===c.Gh.Ing):!1}rAi(a){if(!a.TSb||this.Waf())return!0;var b;(b=this.z4a.y3b)&&b.node===a?(a=this.Fz.kta(a),b=b.Qa<a[a.length-1].begin):b=!0;return b}d8i(a,
b,c,h,m,y,G){let U=[];for(const ja of a)a=y?this.ZNa.RSi(ja,c,h,G):this.ZNa.QSi(ja,c,h),(a=this.ZNa.PSi(a,m))&&Array.add(U,a);U=Ak.a(U);b=Ak.f(h,b);return Ak.b(U,b)}AGk(a,b,c){const h=[];for(let m=c.length-1;0<=m;m--){const y=c[m];this.ZNa.gdl(y,b)||(Array.removeAt(c,m),Array.add(h,y))}this.Fz.Pnd(a,h)}static EIi(){return kf.a.$wj(Fc.App.Kb.kG.pmg)}}Object(n.a)(up,"ParagraphProofingFacade",null,[1294]);var rj=d(1047);class no{constructor(){this.AUc=this.PUc=this.activity=null}endActivity(a){this.activity&&
(this.activity.properties.$("EndReason",a),this.activity.end())}}Object(n.a)(no,"EditorServiceAPIRequest",null,[]);class tr extends no{constructor(){super();this.Yya=this.request=null}}Object(n.a)(tr,"ProofingConfigV2Request",no,[]);class is{constructor(a,b,c,h,m){this.Lcid=a;this.AppId=b;this.LanguageId=c;this.LanguageUXId=h;this.Descriptors=m}}Object(n.a)(is,"ProofingConfigV2RequestObject",null,[]);var Jq;(function(a){a[a.success=0]="success";a[a.partialSuccess=1]="partialSuccess";a[a.error=2]=
"error";a[a.disabled=3]="disabled"})(Jq||(Jq={}));Object(n.b)("ResponseStatus",Jq);var Ge=d(2);class Zm{constructor(a,b,c,h,m){this.iRb=a;this.ld=b;this.$Ub=c;this.YXh=h;this.Gof=u.AFrameworkApplication.lcid;this.Hga=Fc.App.mode;this.qwc={};this.sUb=new Jb.a;this.SXh=m}init(){this.Rgd(this.Gof)}Rgd(a){if(!(a.toString()in this.qwc||u.AFrameworkApplication.Tg))try{this.YXh.Dqi(a).continueWith(b=>{!b.result||this.sUb.Hb(a.toString())&&this.sUb.ga(a.toString())||this.J2k(a)},3)}catch(b){ba.ULS.sendTraceTag(36782929,
375,10,"PopulateConfigByLanguageId failed with exception: {0}",b)}}J2k(a){var b=new rj.a;const c=Fa.a.ue(a).name,h=Fa.a.ue(this.Gof).name;c&&c.length&&h&&h.length&&(b=Object.assign(new tr,{request:new is(a,this.c4d(),c,h,this.$Ub.descriptors),activity:this.ld.Vp(D.a.iXk),Yya:b,PUc:Object(F.a)(this,this.Slc,"processSuccessResponse"),AUc:Object(F.a)(this,this.Qlc,"processFailResponse")}),this.sUb.$(a.toString(),!0),this.iRb.Gx(2,dd.c(b.request),b))}Slc(a,b){if(!a||!a.request)return!1;this.sUb.$(a.request.Lcid.toString(),
!1);if(a.request.Lcid.toString()in this.qwc)return a.endActivity("RequestSucceeded"),!0;let c=null;if(b&&b.length)try{c=dd.a(b)}catch(h){ba.ULS.sendTraceTag(36811152,375,10,"Parse failed with exception: {0}",h)}if(!c||1===c.ResponseStatus)return b=c?Jq[c.ResponseStatus]:"EmptyResponse",ba.ULS.sendTraceTag(37343687,375,50,"Failed to get proofing config, language {0}, Reason {1}",a.request.LanguageId,b),a.endActivity(b),!1;a.endActivity("RequestSucceeded");b=c.CritiqueCategoryInfoList;this.SXh.filter(b);
ba.ULS.sendTraceTag(35240099,375,50,"Get proofing config. CritiqueCategoryInfoList is null: {0}, Length of CritiqueCategoryInfoList: {1}, languageId: {2}",!b,b?b.length:0,a.request.LanguageId);this.qwc[a.request.Lcid.toString()]=b;return!0}Qlc(a){a&&(a.request&&this.sUb.$(a.request.Lcid.toString(),!1),a.Yya.Fg(!1),ba.ULS.sendTraceTag(35240128,375,10,"Failed to get proofing config, language {0}",a.request.LanguageId),a.endActivity("RequestFailed"))}request(a){return Ge.Task.Nt(this.qwc[a.toString()])}c4d(){const a=
ue.a[this.Hga];return a.charAt(0).toUpperCase()+a.substr(1)+"_Online"}}Object(n.a)(Zm,"ProofingConfigV2Manager",null,[1265]);class $m{constructor(){this.Value=this.Name=null}static create(a,b){return Object.assign(new $m,{Name:a,Value:b})}static Lce(){Object.assign(new $m,{Name:"IsCompliant",Value:void 0});Object.assign(new $m,{Name:"LicenseType",Value:"NoLicense"});Object.assign(new $m,{Name:"IsGoLocal",Value:void 0})}}Object(n.a)($m,"Descriptor",null,[]);class jt{constructor(a,b){this.Xza=[];this.$a=
a;this.w$e=b}get descriptors(){if(!this.Xza.length)try{this.Lce()}catch(a){const b=String.format("Message: {0}. Stack: {1}",a.message,a.stack);ba.ULS.sendTraceTag(33952285,375,10,b)}return this.Xza}Lce(){Array.clear(this.Xza);var a=this.$a.ka("ProofingWithEditorServiceInboundaryCloudSuggestionsIsEnabled").toString();Array.add(this.Xza,Object.assign(new $m,{Name:"IsGoLocal",Value:this.$a.ka("IsGoLocalEnvironment").toString()}));Array.add(this.Xza,Object.assign(new $m,{Name:"IsCompliant",Value:a}));
if(this.w$e.tle||this.w$e.WTa)a=this.$a.ka("IsSubscriptionForProofingUser")?"Subscription":"NoLicense",Array.add(this.Xza,Object.assign(new $m,{Name:"LicenseType",Value:a}));this.Uci();this.adi()}adi(){var a=dd.b(this.$a.appSettings.SessionStartInfoJson.toString());var b=a.Host||"";const c=a.Ring||"";a=a.WACDatacenter||"";""!==c&&""!==b&&(b=c+"-"+b,Array.add(this.Xza,Object.assign(new $m,{Name:"CustomAudience",Value:b})));""!==a&&Array.add(this.Xza,Object.assign(new $m,{Name:"Origin",Value:a}))}Uci(){const a=
this.SVi(this.$a.Ha("FlightId"));let b;0<a.length&&(b=Ma.a.join(a,";"),Array.add(this.Xza,Object.assign(new $m,{Name:"FlightIds",Value:b})),ba.ULS.sendTraceTag(33952287,375,50,"FlightCount: [{0}], flightIds: [{1}]",a.length,b))}SVi(a){const b=[];if(a&&""!==a){a=a.split(";");for(let c=0;c<a.length;c++)-1<a[c].toLowerCase().indexOf("editorservice")&&Array.add(b,a[c])}return b}}Object(n.a)(jt,"ProofingDescriptors",null,[1260]);class Rp{constructor(a,b){this.WTa=this.myb=this.gJd=!1;this.PFd=this.OFd=
0;this.JBc=a.ka("ProofingWithEditorServiceIsEnabled");this.zRh=a.ka("GrammarCheckIsEnabled");this.AUa=a.ka("ProofingSettingIsEnabled");this.Kje=a.ka("ProofingSecondaryContextualMenuIsEnabled");this.Myc=a.ka("EditorServiceSuggestionDescriptionsIsEnabled");a.ka("NewProofingExperienceEnabled");this.M2h=a.ka("WritingStyleIsEnabled");this.xPh=a.ka("DoNotCheckThisIssueEnabled");this.jTh=a.ka("IgnoreProofingCommandIsEnabled");this.fua&&(this.gJd=!1,b.execute(()=>{this.gJd=!0}));2===this.xfa?(this.PFd=2,
this.OFd=3):(this.PFd=a.Fc("NumberOfWordsToProofAroundModifiedRanges",1),this.OFd=a.Fc("NumberOfWordsAsContextAroundProofedRanges",0))}get Sgg(){return this.jTh}get fua(){return 2===this.xfa&&this.zRh}get tle(){return this.fua&&this.M2h}get Phe(){return this.xPh&&this.Kje&&this.AUa}get nKj(){return this.Myc}get xfa(){return this.JBc?2:0}get Qkk(){return this.OFd}get k0g(){return this.PFd}get isLoaded(){return!this.JBc||!this.fua||this.gJd}}Object(n.a)(Rp,"ProofingFeatureConfiguration",null,[1291]);
class vp extends no{constructor(){super();this.request=null}}Object(n.a)(vp,"ProofingFeedbackLoopRequest",no,[]);class Sp{constructor(a,b,c){this.iRb=a;this.ld=b;this.$Ub=c}N2k(a){a.Descriptors=this.$Ub.descriptors;a=Object.assign(new vp,{request:a,activity:this.ld.Vp(D.a.h3k),PUc:Object(F.a)(this,this.Slc,"processSuccessResponse"),AUc:Object(F.a)(this,this.Qlc,"processFailResponse")});this.iRb.Gx(1,dd.c(a.request),a)}Slc(a){if(!a)return!1;a.endActivity("RequestSucceeded");return!0}Qlc(a){a&&(ba.ULS.sendTraceTag(38847138,
375,15,"Proofing feedback failed"),a.endActivity("RequestFailed"))}}Object(n.a)(Sp,"ProofingFeedbackLoopManager",null,[1290]);class Kq extends no{constructor(){super();this.Yya=this.request=null}}Object(n.a)(Kq,"ProofingLanguageInfoRequest",no,[]);class ur{constructor(a){this.AppId=a}}Object(n.a)(ur,"ProofingLanguageInfoRequestObject",null,[]);class On{constructor(a,b){this.iRb=a;this.ld=b;this.Hga=Fc.App.mode;this.Wpa=new xa.ScriptSharpLegacyMap;this.Oga=null;this.o4a=0}Dqi(a){if(this.Wpa.Hb(a))return Ge.Task.Nt(!0);
this.WRe();return this.Oga.CWRCo(()=>!!this.Oga.result&&this.Oga.result.Hb(a),3)}Eqi(a,b){if(this.Wpa.Hb(a))return Ge.Task.Nt(this.k5f(a,b));this.WRe();return this.Oga.CWRCo(()=>this.k5f(a,b),3)}F5i(a){if(0<this.Wpa.count)return Ge.Task.Nt(this.kZf(a));this.WRe();return this.Oga.CWRCo(()=>this.kZf(a),3)}cXk(){const a=new rj.a;u.AFrameworkApplication.Tg&&a.Fg(null);const b=Object.assign(new Kq,{request:new ur(ue.a[this.Hga]+"_Online"),activity:this.ld.Vp(D.a.jXk),Yya:a,PUc:Object(F.a)(this,this.Slc,
"processSuccessResponse"),AUc:Object(F.a)(this,this.Qlc,"processFailResponse")});this.iRb.Gx(0,dd.c(b.request),b);this.o4a+=1;return a.task}Slc(a,b){let c=null;if(!a)return!1;try{c=dd.a(b)}catch(m){ba.ULS.sendTraceTag(37025730,375,10,"Failed to parse language info response with exception {0}",m)}if(c&&0===c.ResponseStatus&&c.SupportedLanguages&&0<c.SupportedLanguages.length){for(var h of c.SupportedLanguages)(b=Fa.a.ue(h.LanguageId))&&0!==h.SupportedTextUnit&&this.Wpa.$(b.LCID,h);a.Yya.Fg(this.Wpa);
a.endActivity("RequestSucceeded");return!0}a.Yya.Fg(null);h=c?Jq[c.ResponseStatus]:"EmptyResponse";ba.ULS.sendTraceTag(38847139,375,15,h);a.endActivity(h);return!1}Qlc(a){a&&(a.Yya.Fg(null),ba.ULS.sendTraceTag(38847168,375,15,"RequestFailed"),a.endActivity("RequestFailed"))}k5f(a,b){if(!this.Wpa||!this.Wpa.Hb(a))return 0;a=this.Wpa.ga(a).SupportedTextUnit;return 0!==(b&a)?b:this.i8i(b,a)}i8i(a,b){for(a=b&(a|a-1);a;){b=a&a-1;if(!b)break;a=b}return a}kZf(a){const b=new Qa.a;if(!this.Wpa)return b;for(let c of this.Wpa)c.value.SupportedCritiqueTag&
a&&b.add(c.key);return b}WRe(){if(!this.Oga||5===this.Oga.status||4===this.Oga.status||6===this.Oga.status&&!this.Oga.result)this.Oga=this.cXk(),ba.ULS.sendTraceTag(38319180,375,1===this.o4a?50:15,"Schedule a new task for LanguageInfo request. IsRetried: {0}, Count: {1}",1!==this.o4a,this.o4a)}}Object(n.a)(On,"ProofingLanguageInfoManager",null,[1289]);class kt{constructor(a,b){this.dUh=a;this.Vob=b}track(a,b=null){this.dUh&&this.Vob.track(a(),b)}}Object(n.a)(kt,"ProofingMetricsAggregator",null,[1264]);
class Bl{Nrf(a,b){a&&Ob.ParagraphReader.Yd(a)&&!Ma.a.Wa(b)&&(Ak.d(b),a.kOb=Ak.e(a.kOb,b))}hBl(a,b,c){if(b){var h=a.Nb;a=a.node.kOb;for(let y=0;y<a.length;y++){var m=a[y];const G=m.begin;m=m.end;0>b?m>c&&(G>=h?a[y]=new Bk.a(G+b,m+b):G>=c&&m<=h?(Array.removeAt(a,y),y--):a[y]=new Bk.a(G<c?G:c,m<=h?c:m+b)):a[y]=new Bk.a(G>h?G+b:G,m>h?m+b:m)}}}}Object(n.a)(Bl,"UnsupportedLanguageRangeEditor",null,[1288]);var vu=d(1240),Te=d(462),vr=d(246),wu=d(448),wr=d(1074),xu=d(658);class Tp{constructor(){this.Ay=this.XZa=
null}}Object(n.a)(Tp,"ClientRequestManagerStateObject",null,[]);class js{constructor(a,b){this.request=a;this.response=b}}Object(n.a)(js,"SpellCheckRequestResponseTuple",null,[]);class lt{constructor(){this.VHh=0;this.SJf=this.tna=this.paragraphNode=this.range=null;this.userAction=0;this.rI=null;this.xfa=0;this.overriddenCritiqueTypeOptions=this.descriptors=null}dhg(){const a=Ob.ParagraphReader.text(this.paragraphNode);if(!a||!this.tna)return a===this.tna;let b=this.range.begin,c=this.range.end;return ta.a.dQd(a.substring(b,
c),this.tna.substring(b,c))}isValid(){return this.paragraphNode.isConnected&&this.dhg()}}Object(n.a)(lt,"SpellCheckRequest",null,[]);var ks=d(657),xr=d(834),ls=d(835);class Qi{constructor(a,b,c,h,m,y,G,U,ja,va,Ta,fb,Db,gc,hc,Gc,Pc,yc,Vd,De,Wd){this.NLd=new Ea.a;this.NUb=[];this.bxc=0;this.hCc={};this.Uaa=null;this.d7e=Number.POSITIVE_INFINITY;this.$vc=0;this.l7=Qi.I$a;this.h4a=null;this.wDc=0;this.Qpb=[];this.ywc=null;this.MYh=!1;this.qUb=[];this.NHd=[];this.TXh=0;this.XXh=c.ka(Qi.hGk);this.bYh=c.ka(Qi.oGk);
this.UXh=c.appSettings[Qi.fGk];this.RXh=c.ka(Qi.eGk);this.aYh=c.ka(Qi.mGk);this.PH=h;this.Hga=Fc.App.mode;this.Gm=a;this.Fz=b;this.UWb=va;this.ei=m;this.wVh=c.Fc(Qi.kGk,Qi.jGk);this.ZXh=Db;this.yk=y;this.hf=G;this.rK=U;this.xK=ja;this.qHd=Ta;this.HBc=fb;this.Xh=new vu.a;this.WXh=c.ka(Qi.gGk);this.GBc=hc;this.iGk=Gc;this.GOc=gc;this.JBc=c.ka(Qi.nGk);this.$Ub=Pc;this.QXh=yc;this.Rmb=Vd;this.Gga=De;this.Wd=Wd}get $6g(){return this.qUb}set $6g(a){this.qUb=a}get iQc(){return u.AFrameworkApplication.Tg}get W0b(){return this.Rmb.instance}suspend(){this.wDc++}resume(){if(0>=
--this.wDc&&(this.wDc=0,0<this.Qpb.length&&!this.ywc)){const a=this.Gga.isCompleted(4)?0:1;this.ywc=new He.a(a,1,1,Object(F.a)(this,this.Rjl,"spellCheckSuspendedNodes"),74);this.Wd.Eb(this.ywc)}}Rjl(){this.ywc=null;const a=Ma.a.clone(this.Qpb);Array.clear(this.Qpb);Date.now();let b=null;for(const c of a)b=this.TDh(c,!0,b);b&&b.dispose();this.MYh||Date.now()}IR(a,b=!1){(a=this.TDh(a,b,null))&&a.dispose()}TDh(a,b,c){switch(this.Xsa(a,b)){case 1:Ma.a.contains(this.Qpb,a)||Array.add(this.Qpb,a);break;
case 2:c=this.doSpellCheck(a,c);this.executeNextRequest();break;case 3:this.executeNextRequest()}return c}Xsa(a,b){return!a||this.iQc||!this.PH.Jd.isEditingAllowed&&!this.PH.Jd.Wy?0:!b&&0<this.wDc||!this.GOc.isLoaded?1:!Ob.ParagraphReader.Yd(a)||!a.isConnected||a.anchor.QI||a.vhe||a.QW||a.aC?3:this.Uaa&&Ma.a.any(this.Uaa,c=>c.paragraphNode===a)?0:Ma.a.any(this.NUb,c=>c.paragraphNode===a)||!this.hf.xt(this.rK.Nc(a))?3:2}doSpellCheck(a,b){const c=(va,Ta)=>{this.Fz.Pnd(va,Ta)};var h=this.xK.sRc(a);let m=
0<h.length;b=this.XKe(b,a,h,c);(h=this.GBc.lWi(a))&&this.qEi(a);const y=this.GBc.Mbj(a,h),G=Ob.ParagraphReader.text(a),U=a.TSb,ja=[];for(let va=y.length-1;0<=va;va--){const Ta=y[va];Ta.begin!==Ta.end&&(this.NLd.contains(Ta.lcid)?Array.add(ja,Ta):(this.EAi(a,G,h,Ta,U),Array.removeAt(y,va)))}m=0<ja.length||0<y.length||m;b=this.XKe(b,a,ja,Object(F.a)(this.UWb,this.UWb.Nrf,"addUnsupportedRanges"));b=this.XKe(b,a,y,c);m&&this.GBc.CFh(a);return b}le(a){const b=this.yk.le(7,D.a.c3e);b.kd(a);return b}XKe(a,
b,c,h){Ma.a.Wa(c)||(a=a||this.le(b),h(b,c));return a}qEi(a){const b=new He.a(4,1,500,Object(F.a)(this,this.recheckParagraphTask,"recheckParagraphTask"),48);b.customData=a;this.Wd.Eb(b)}Ujk(a,b){b="b"+b.range.begin+"e"+b.range.end+"i"+b.range.lcid+"l"+b.tna.length+b.paragraphNode.id;this.hCc[b]=(this.hCc[b]||0)+1;this.bxc=Math.max(this.hCc[b],this.bxc);return this.bxc>Qi.cgk?(ba.ULS.sendTraceTag(22390425,324,15,"Infinite proofing loop detected, cleaning paragraph proof state"),this.bxc=0,this.hCc=
{},this.Fz.ZIc(a),!1):!0}EAi(a,b,c,h,m){const y=new lt;y.VHh=u.AFrameworkApplication.lcid;y.tna=b;y.range=h;y.paragraphNode=a;y.SJf=c;y.userAction=m?1:0;const G=this.GOc.AUa;G&&this.W0b&&(y.overriddenCritiqueTypeOptions=this.W0b.T4d());this.Ujk(a,y)&&this.Tjj(y.range.lcid,y.range.textUnit).continueWith(U=>{U=U.result;y.xfa=2===this.GOc.xfa?0!==U?2:0:this.TXh;y.range.textUnit=U;y.descriptors=this.$Ub.descriptors;this.fQi(y);G&&2===y.xfa&&this.QXh.Rgd(y.range.lcid)},8).continueWith(()=>{this.executeNextRequest()})}Tjj(a,
b){return 2===this.GOc.xfa?this.iGk.Eqi(a,b):Ge.Task.Nt(b)}fQi(a){a.rI=new Date;Array.enqueue(this.NUb,a)}recheckParagraphTask(a){this.IR(a.customData)}executeNextRequest(){if(!this.iQc&&!this.Uaa){var a=[];do{if(!this.NUb.length)break;const b=Array.dequeue(this.NUb);b.isValid()&&Array.add(a,b)}while(a.length<this.wVh);0>=a.length?(this.Uaa=null,this.Sjl()):(this.Uaa=a,this.Uaa.sort((b,c)=>+b.rI-+c.rI),a=this.Uaa[0],this.HBc.track(+new Date-+a.rI,"ProofingRequestInQueue."+ks.a[a.userAction]),this.executeRequest(this.Uaa))}}Sjl(){for(var a=
0;a<this.qUb.length;a++)(0,this.qUb[a])();Array.clear(this.qUb);for(a=0;a<this.NHd.length;a++)(0,this.NHd[a])();Array.clear(this.NHd)}executeRequest(a){if(a&&a.length){var b=[];for(let c=0;c<a.length;++c){const h=xu.a.nhj(this.XXh,a[c],this.Hga,this.bYh,this.aYh,this.RXh,this.UXh,this.JBc);Array.add(b,h)}b=xr.a.Sxi(b,Fc.App.mode);this.ei.Aj(this.qHd(),2,b,{"Content-Type":"application/json; charset=utf-8"},!1,3,Object(F.a)(this,this.Pjl,"spellCheckSucceeded"),Object(F.a)(this,this.Ojl,"spellCheckFailed"),
Object.assign(new Tp,{XZa:a,Ay:this.Xh.Ci("WebServiceCall","Proofing")}),void 0,void 0,void 0,void 0,"29")}}Pjl(a){if(!this.iQc){a=a.data;this.HBc.track(a.state.Ay.Rq,"ProofingRequestRoundtrip");var b=this.Xh.Ci("DOMUpdate","Proofing");this.Qjl(a);this.HBc.track(b.Rq,"UpdateProofingResults")}}Qjl(a){Te.a.mark(7798);this.Uaa=null;var b=a.state.XZa;if(({group:c}=ls.a.QCh(a.Zd)).returnValue){var c=c.Responses;var h=({tZk:b,L3k:c}=this.Kjj(b,c)).returnValue;if(0<h.length){const m=this.le(h[0].request.paragraphNode);
try{for(const y of h){const G=y.request;this.PH.hQi(G.paragraphNode,()=>{this.Gfk(y.response,G)})}}finally{m&&m.dispose()}}b.length?(this.UQd(a),this.HKe(b),this.O_d()):this.SXk();this.UQd(a);for(const m of c)vr.PageStats.LXb(m);this.O_d();this.executeNextRequest()}else this.HKe(b);Te.a.mark(7799)}Kjj(a,b){let c,h;const m=[];c=[];h=[];for(let y=0;y<a.length;y++){const G=a[y];if(!G.paragraphNode.isConnected)continue;const U=b[y];if(5===U.classId){const ja=U.Fault;if(ja)switch(ja.Type){case 1:ba.ULS.sendTraceTag(22390429,
324,15,"Previous proofing char limit: {0}; char limit returned by server: {1}; proofing word length we tried {2}",this.d7e,ja.Limit,ja.AttemptedValue);this.d7e=ja.Limit;break;default:ba.ULS.sendTraceTag(22390431,324,10,"Unknown limit type violated")}else c.push(G)}else m.push(new js(G,U));U.ServerPageStatsTrace&&h.push(U.ServerPageStatsTrace)}return{returnValue:m,tZk:c,L3k:h}}Gfk(a,b){const c=b.paragraphNode;if(c.isConnected)if(c.aC)this.executeNextRequest();else{var h=this.le(c),m=this.ZXh.nYk(a);
if(b.dhg()){var y=b.range;const G=[y];m.Ykd(a)?(y=Ak.a(this.Gm.BF(c)),1!==b.userAction&&c.rei()&&this.WXh&&(a=m.pTf(a,b,y)),this.Fz.Pnd(c,G,b.SJf),a=m.BTi(a,b,y),this.Gm.oqf(c,a)):this.tvj(c,y);this.GBc.CFh(c)}c.kpc();h.dispose();this.IR(c)}else this.executeNextRequest()}tvj(a,b){const c=[b];b=b.lcid;this.NLd.contains(b)||(ba.ULS.sendTraceTag(42004739,324,50,"LCID {0} unsupported for proofing",b),this.NLd.add(b));this.Fz.Pnd(a,c);this.UWb.Nrf(a,c)}Ojl(a){a=a.data;if(!this.iQc){var b=a.state;this.HBc.track(b.Ay.Rq,
"ProofingRequestRoundtrip");this.HKe(b.XZa);this.UQd(a);this.O_d()}}HKe(a){this.Uaa=a;a=new He.a(3,1,this.l7,Object(F.a)(this,this.retryCurrentRequest,"retryCurrentRequest"),49);this.Wd.Eb(a);++this.$vc;this.l7*=Qi.QQe;this.l7>Qi.Whc&&(this.l7=Qi.Whc);4!==this.$vc||this.ei.gFa||(this.h4a=Fc.App.Kb.notificationBar.uCa(Box4Intl.Box4Strings.l_NotificationBarProofingUnavailave,!0),Fc.App.Kb.notificationBar.Yh(this.h4a),u.AFrameworkApplication.jj.F$a(Qi.zKh,1),ba.ULS.sendTraceTag(7390529,324,15,"Proofing unavailable"),
this.ei.oFc(this))}SXk(){this.$vc&&(this.$vc=0,this.l7=Qi.I$a);this.h4a&&(Fc.App.Kb.notificationBar.removeEntry(this.h4a),this.h4a=null,this.ei.Zjd(this))}retryCurrentRequest(){this.executeRequest(this.Uaa)}NFb(){Fc.App.Kb.notificationBar.removeEntry(this.h4a);this.h4a=null;this.ei.Zjd(this)}Fic(){}get Dke(){return!this.Qpb.length&&!this.Uaa&&!this.NUb.length}UQd(a){vr.PageStats.e6a("SpellCheck",a.St);(a=a.rj?a.rj[wu.a.oCa]:null)&&vr.PageStats.B5a(wr.a.Jh,a)}O_d(){vr.PageStats.dDa("SpellCheck")}}
Qi.kGk="ProofingRequestsBatched";Qi.jGk=1;Qi.eGk="ProofingContextualResultsIsEnabled";Qi.mGk="ProofingTrackMetricsIsEnabled";Qi.hGk="ProofingInstrumentedAndContextualIsEnabled";Qi.oGk="ProofingWithOneSpellerIsEnabled";Qi.fGk="ProofingExperimentId";Qi.nGk="ProofingWithEditorServiceIsEnabled";Qi.gGk="ProofingFilterSpellCheckResultIsEnabled";Qi.zKh=11093;Qi.cgk=30;Qi.I$a=1E3;Qi.QQe=5;Qi.Whc=72E6;Object(n.a)(Qi,"ProofingCheckOperator",null,[292,1287]);var Lq=d(517);class Mq{constructor(a){this.Vob=a}BTi(a,
b,c){if(this.KQe(a)){const h={};a=this.aSf(b,a,c,h);this.Wbi(b,h);return a}b&&this.Xbi(b);return[]}Wbi(a,b){this.Vob.track(()=>Object.assign(new Lq.a,{E:a.xfa,C:a.range.kTd,F:b}))}Xbi(a){this.Vob.track(()=>Object.assign(new Lq.a,{E:a.xfa,C:a.range.kTd}))}Thg(a,b,c){return!a||Ma.a.all(a,h=>h.begin!==b||h.end!==c)}zlg(a,b,c){return!!a&&Ma.a.any(a,h=>b>=h.begin&&c<=h.end)}}Object(n.a)(Mq,"AProofingResultsManager",null,[1303]);var Up=d(516),ym;(function(a){a[a.none=0]="none";a[a.spelling=1]="spelling";
a[a.grammatical=2]="grammatical";a[a.advanced=3]="advanced";a[a.informational=4]="informational";a[a.consistency=5]="consistency"})(ym||(ym={}));Object(n.b)("ProofingType",ym);class Nq extends Mq{constructor(a,b,c,h=null){super(a);this.$a=h;this.fQh=b;this.$M=c}Ykd(a){return a&&63===a.classId?!0:(ba.ULS.sendTraceTag(20993182,375,10,"null response or unexpected response"),!1)}KQe(a){return this.Ykd(a)&&!!a.Critiques&&0<a.Critiques.length}aSf(a,b,c,h){const m=[];b=b.Critiques;for(const U of b)if(this.Bwj(b,
U)&&this.xbl(U)){var y=0<=a.range.Y$?a.range.Y$+U.Start:a.range.begin+U.Start;const ja=y+U.Length;var G=a.tna.substring(y,ja);const va=this.fQh.create(U,this.Vob,this.$a);va.lcid=a.range.lcid;va.token=G;va.originalText=a.tna;va.Y$=a.range.Y$;va.uJa=a.range.uJa;a.range.end>=ja&&(G=new ap(y,ja,va),Array.add(m,G));this.Thg(c,y,ja)&&(y=1===va.proofingType?ym[va.proofingType]:va.typeId,h[y]=y in h?h[y]+1:1)}return m}pTf(a,b,c){if(!this.KQe(a))return a;const h=[];for(const m of a.Critiques){const y=0<=
b.range.Y$?b.range.Y$+m.Start:b.range.begin+m.Start;this.zlg(c,y,y+m.Length)&&Array.add(h,m)}a.Critiques=h;return a}xbl(a){return 2!==Up.b(a)||!this.$M.WTa}Bwj(a,b){if(a)for(let c=0;c<a.length;c++)if(b.Start<=a[c].Start+a[c].Length&&b.Start+b.Length>=a[c].Start&&a[c].Priority<b.Priority)return!1;return!0}}Object(n.a)(Nq,"ProofingCheckResultsManager",Mq,[]);var t=d(48),P=d(92);class ia{constructor(a,b,c,h,m,y,G){this.ZAd=!1;G&&c.IK(Object(F.a)(this,this.nMk,"recheckAllParagraphs"));b.J7h(Object(F.a)(this,
this.Glk,"onAfterParagraphMerge"));m&&m.Ad(12).y7(Object(F.a)(this,this.hrk,"onParagraphDisconnected"));this.Fz=a;this.ZUb=h;this.Gm=y}hrk(a,b){Ob.ParagraphReader.Yd(b.node)&&this.Gm&&this.Gm.Ocd(b.node)}Glk(a,b){this.Fz.Jbi(b);this.IR(b.YYd.currentNode)}o8b(a){this.Fz.W7k(a);this.IR(a)}nMk(a){if(2===a.mode&&(a=this.z5f(a)))for(a=P.a.Mz(a);a.moveNext();)Ob.ParagraphReader.fl(a.iterator)&&this.IR(a.currentNode)}suspend(){this.ZUb.suspend()}resume(){this.ZUb.resume()}get Dke(){return this.ZUb.Dke}get MVe(){return this.ZAd}set MVe(a){if(this.ZAd!==
a&&(this.ZAd=a,a=this.z5f(Fc.App.Kb))){var b=new t.GraphTransaction(2);try{b.set(a.Tj);const c=P.a.Mz(a);for(;c.moveNext();)Ob.ParagraphReader.fl(c.iterator)&&c.currentNode.wv(16,!0)}finally{b&&b.dispose()}}}z5f(a){return(a.Jd.isEditingAllowed||a.Jd.Wy)&&a.Jd.Cn.so?a.Jd.Cn.yg:null}e6h(a){Array.add(this.ZUb.$6g,a)}IR(a){this.ZUb.IR(a,!1)}}Object(n.a)(ia,"ProofingManager",null,[1263]);var Aa=d(1195),Ka=d(656);class pb extends Ka.a{constructor(a){super(a);this.rWb=null}get proofingType(){return 1}get suggestions(){return this.rWb?
Array.clone(this.rWb):null}P9k(a){this.rWb=a}JLa(a,b=0){this.Hjf.track(()=>Object.assign(new Lq.a,{E:0,T:1,A:a,I:b}))}}Object(n.a)(pb,"OfficeSpellerErrorDetails",Ka.a,[]);class Nb extends Mq{constructor(a){super(a)}Ykd(a){return!!a.Errors}KQe(a){return this.Ykd(a)&&0<a.Errors.length}aSf(a,b,c,h){let m=0;const y=[],G=b.Errors;for(let va=0;va<G.length;va++){var U=G[va],ja=Object.assign(new pb(this.Vob),{token:U.Word,errorType:U.Type,lcid:a.range.lcid});ja.P9k(Aa.a.pIh(b.Suggestions,va*Aa.a.cmg));const Ta=
U.Offset+a.range.begin;U=Ta+U.Word.length;ja=new ap(Ta,U,ja);Array.add(y,ja);this.Thg(c,Ta,U)&&m++}h.spelling=m;return y}pTf(a,b,c){if(Ma.a.Wa(c)||!a)return a;const h=[],m=[];for(let G=0;G<a.Errors.length;++G){const U=a.Errors[G];var y=U.Offset+b.range.begin;this.zlg(c,y,y+U.Word.length)&&(y=G*Aa.a.cmg,Array.add(h,Aa.a.CWj(a.Suggestions,y)),Array.add(h,Aa.a.pIh(a.Suggestions,y)),Array.add(m,U))}a.Suggestions=h;a.Errors=m;return a}}Object(n.a)(Nb,"ProofingResultsManager",Mq,[]);class kc{constructor(a,
b,c){this.IBc=new Nd.a;this.u8e=b;a.ka("ProofingWithEditorServiceIsEnabled")&&this.IBc.add(63,c.value);this.IBc.add(4,this.u8e)}nYk(a){if(this.IBc.Hb(a.classId))return this.IBc.ga(a.classId);ba.ULS.sendTraceTag(20747157,375,50,"Fallback ProofingResultsManager is resolved for response: {0}",a.classId);return this.u8e}}Object(n.a)(kc,"ProofingResultsManagerResolver",null,[1262]);class Rc{constructor(a=null,b=null){this.BD=this.fd=null;this.ALd=a;this.BLd=b}get Tf(){!this.fd&&this.ALd&&this.ALd.instance&&
(this.fd=this.ALd.instance.instance);return this.fd}get Usc(){!this.BD&&this.BLd&&this.BLd.instance&&(this.BD=this.BLd.instance.instance);return this.BD}NWi(a,b,c,h){if(!b)return c;" "!==a.charAt(c)&&(c=a.lastIndexOf(" ",c));if(0<=c)for(let m=0;m<b;m++){c=a.lastIndexOf(" ",c-1);if(c<=h)break;" "===a.charAt(c+1)&&m--}c=Math.max(c,h);return" "===a.charAt(c)?c+1:c}tWi(a,b,c,h){if(!b)return c;0<c&&" "!==a.charAt(c-1)&&(c=a.indexOf(" ",c));if(0<=c)for(let m=0;m<b;m++){c=a.indexOf(" ",c+1);if(-1===c)break;
" "===a.charAt(c-1)&&m--}return c=-1===c?h:Math.min(c,h)}$Ta(a){return a.properties.sa(kb.a.$Ta,!1)}vTf(a){a=Ob.ParagraphReader.text(a);let b;const c=[];for(;b=Rc.Dzj.exec(a);)Array.add(c,new Bk.a(b.index+b[1].length,b.index+b[0].length));return c}wTf(a,b=!0,c=!1){let h=[],m=!1,y=!1,G=!1,U=!1,ja=-1;a=a.Ra;for(let Ta=0;Ta<a.length;Ta++){var va=a.ga(Ta);va.hyperlink?y=!0:va.en&&(y=!1);b&&va.formatting&&(G=va.formatting.cache.wUa);if(c&&(va.yL&&(U=!1),va.Up)){const fb=Object(ua.a)(287,va.Up.Gh);fb&&
(U=fb.wEa)}m!==(y||G||U||!!va.blob)&&(va=va.cp,m?Array.add(h,new Bk.a(ja,va)):ja=va,m=!m)}m&&(b=Bk.a.createTextRange(ja,a.last.cp))&&Array.add(h,b);return h}sRc(a,b=!0,c=!1){return Ak.e(this.vTf(a),this.wTf(a,b,c))}w3b(a,b,c){if(b===a.length)for(;0<b&&" "===a.charAt(b-1);)b--;b=a.lastIndexOf(" ",b-1)+1;c=a.indexOf(" ",c);0>c&&(c=a.length);return Bk.a.createTextRange(b,c)}WTc(a,b,c,h){if(!c||""===c||0>a||a>=b||b>c.length)return null;h=h||[];a=Rc.JXf(a,b,c);for(var m=0;m<h.length;m++){var y=h[m];if(a<
y.begin)break;a<y.end&&(a=Rc.JXf(y.end,b,c))}b=Rc.h_f(b,c);for(m=h.length-1;0<=m;m--){y=h[m];if(b>y.end)break;b>y.begin&&(b=Rc.h_f(y.begin,c))}return(a=Bk.a.createTextRange(a,b))&&a.wVj()?a:null}static JXf(a,b,c){for(;a<b&&ta.a.Xy(c.charCodeAt(a));)a++;return a}static h_f(a,b){for(;0<a&&Rc.fIj(a,b);)a--;return a}static fIj(a,b){a=b.charAt(a-1).toString();return a===Vb.AParagraphNode.uNc||a===Vb.AParagraphNode.f_}}Rc.Dzj=RegExp("(^| )(?:[a-z+.-]+://\\S+|[a-z]:[/\\\\]\\S+|\\\\\\\\\\S+|mailto:\\S+)",
"ig");Object(n.a)(Rc,"ProofingTextUtility",null,[1286]);class Yc{constructor(){this.Da=null}get name(){return"Box4.Proofing"}$b(a){this.Da=a;this.Da.register(mo,"Box4.Proofing.ErrorRangeEditor").as("Box4.Proofing.IErrorRangeEditor").ma().oa(()=>new mo(this.Da.resolve("Box4.IParagraphReader"),J.a.instance.ga(14),J.a.instance.ga(70)));this.Da.register(bp,"Box4.Proofing.ModifiedRangeEditor").as("Box4.Proofing.IModifiedRangeEditor").ma().oa(()=>new bp(this.Da.resolve("Box4.Proofing.IErrorRangeEditor"),
this.Da.resolve("Box4.Proofing.IProofingTextUtility"),this.Da.resolve("Box4.ISelectionManager"),this.Da.resolve("Box4.Proofing.IProofingFeatureConfiguration"),u.AFrameworkApplication.fa.ka("MinimizeProofedRangesIsEnabled"),u.AFrameworkApplication.fa.ka("ProofingSetCentralWordRangeIsEnabled")));this.Da.register(Bl,"Box4.Proofing.UnsupportedLanguageRangeEditor").as("Box4.Proofing.IUnsupportedLanguageRangeEditor").ma().oa(()=>new Bl);this.Da.register(Nn,"Box4.Proofing.ModifiedExpandRangeHelper").as("Box4.Proofing.IModifiedExpandRangeHelper").ma().oa(()=>
new Nn(rr.a.instance,this.Da.resolve("Box4.Proofing.IProofingTextUtility"),this.Da.resolve("Box4.Proofing.IProofingFeatureConfiguration"),this.Da.Ja("Box4.Proofing.IProofingSentenceSeparator")));this.Da.register(up,"Box4.Proofing.ParagraphProofingFacade").as("Box4.Proofing.IParagraphProofingFacade").ma().oa(()=>new up(this.Da.resolve("Box4.Proofing.IErrorRangeEditor"),this.Da.resolve("Box4.Proofing.IModifiedRangeEditor"),this.Da.resolve("Box4.Proofing.IUnsupportedLanguageRangeEditor"),this.Da.resolve("Box4.Graph.IGraphIteratorFactory"),
this.Da.resolve("Box4.ILanguageReader"),this.Da.resolve("Box4.Proofing.IModifiedExpandRangeHelper"),this.Da.resolve("Box4.Proofing.IProofingTextUtility"),Jl.a.instance,this.Da.resolve("Box4.Proofing.IProofingFeatureConfiguration"),this.Da.Ja("Box4.Proofing.IProofingSentenceSeparator")));this.Da.register(Rc,"Box4.Proofing.ProofingTextUtility").as("Box4.Proofing.IProofingTextUtility").ma().oa(()=>new Rc(this.Da.Ja("Box4.TrackChange.ITrackChangeManagerFactory"),this.Da.Ja("Box4.TrackChange.ITrackChangeReaderFactory")));
const b=()=>{const c=u.AFrameworkApplication.fa.Ha("ProofingWebServiceBase");return(void 0===c?Fc.App.webServiceBase:c)+"proofing.ashx?"+u.AFrameworkApplication.jh};this.Da.register(Iq,"Box4.Proofing.EditorServiceRequestManager").as("Box4.Proofing.IEditorServiceRequestManager").ma().oa(()=>new Iq(u.AFrameworkApplication.Je,b));this.Da.register(On,"Box4.Proofing.ProofingLanguageInfoManager").as("Box4.Proofing.IProofingLanguageInfoManager").ma().oa(()=>new On(this.Da.resolve("Box4.Proofing.IEditorServiceRequestManager"),
ec.a.instance));this.Da.register(Sp,"Box4.Proofing.ProofingFeedbackLoopManager").as("Box4.Proofing.IProofingFeedbackLoopManager").ma().oa(()=>new Sp(this.Da.resolve("Box4.Proofing.IEditorServiceRequestManager"),ec.a.instance,this.Da.resolve("Box4.Proofing.IProofingDescriptors")));this.Da.register(Rp,"Box4.Proofing.ProofingFeatureConfiguration").as("Box4.Proofing.IProofingFeatureConfiguration").ma().oa(()=>new Rp(u.AFrameworkApplication.fa,this.Da.Ja("Box4.Proofing.IProofingSentenceSeparator")));this.Da.register(1260,
"Box4.Proofing.IProofingDescriptors").ma().oa(()=>new jt(u.AFrameworkApplication.fa,this.Da.resolve("Box4.Proofing.IProofingFeatureConfiguration")));this.Da.register(Qi,"Box4.Proofing.ProofingCheckOperator").as("Box4.Proofing.IProofingCheckOperator").ma().oa(()=>new Qi(this.Da.resolve("Box4.Proofing.IErrorRangeEditor"),this.Da.resolve("Box4.Proofing.IModifiedRangeEditor"),u.AFrameworkApplication.fa,Fc.App.Kb,u.AFrameworkApplication.Je,this.Da.resolve("Box4.Graph.IGraphTransactionFactory"),Pi.a.instance,
this.Da.resolve("Box4.Graph.IGraphIteratorFactory"),this.Da.resolve("Box4.Proofing.IProofingTextUtility"),this.Da.resolve("Box4.Proofing.IUnsupportedLanguageRangeEditor"),b,Hq.a.EW(4,1,new uu),this.Da.resolve("Box4.Proofing.IProofingResultsManagerResolver"),this.Da.resolve("Box4.Proofing.IProofingFeatureConfiguration"),this.Da.resolve("Box4.Proofing.IParagraphProofingFacade"),this.Da.resolve("Box4.Proofing.IProofingLanguageInfoManager"),this.Da.resolve("Box4.Proofing.IProofingDescriptors"),this.Da.resolve("Box4.Proofing.IProofingConfigV2Manager"),
this.Da.Ja("Box4.Proofing.ICritiqueTypeSettings"),Ja.a.get_instance(),u.AFrameworkApplication.we));this.Da.register(Nb,"Box4.Proofing.ProofingResultsManager").ma().oa(()=>new Nb(this.Da.resolve("Common.Utils.Aggregators.IAggregator<System.Func<Box4.Proofing.ProofingTraceMetrics>>")));this.Da.register(1261,"Box4.Proofing.IIgnoreAllKeywords").ma().oa(()=>new gs);this.Da.register(Nq,"Box4.Proofing.ProofingCheckResultsManager").ma().oa(()=>new Nq(this.Da.resolve("Common.Utils.Aggregators.IAggregator<System.Func<Box4.Proofing.ProofingTraceMetrics>>"),
this.Da.resolve("Box4.Proofing.IEditorServiceErrorDetailsFactory"),this.Da.resolve("Box4.Proofing.IProofingFeatureConfiguration"),u.AFrameworkApplication.fa));this.Da.register(1262,"Box4.Proofing.IProofingResultsManagerResolver").ma().oa(()=>new kc(u.AFrameworkApplication.fa,this.Da.resolve("Box4.Proofing.ProofingResultsManager"),this.Da.re("Box4.Proofing.ProofingCheckResultsManager")));this.Da.register(1263,"Box4.IProofingManager").ma().oa(()=>new ia(this.Da.resolve("Box4.Proofing.IModifiedRangeEditor"),
this.Da.resolve("Box4.IParagraphEditor"),this.Da.resolve("Box4.IAppFrame"),this.Da.resolve("Box4.Proofing.IProofingCheckOperator"),this.Da.rb("Box4.INotebookManager").fV,this.Da.rb("Box4.Proofing.IErrorRangeEditor"),4!==Fc.App.mode));this.Da.register(1264,"Common.Utils.Aggregators.IAggregator<System.Func<Box4.Proofing.ProofingTraceMetrics>>").ma().oa(()=>new kt(u.AFrameworkApplication.fa.ka("ProofingTrackMetricsIsEnabled"),Hq.a.EW(15,1,new Go)));this.Da.register(1265,"Box4.Proofing.IProofingConfigV2Manager").ma().oa(()=>
new Zm(this.Da.resolve("Box4.Proofing.IEditorServiceRequestManager"),ec.a.instance,this.Da.resolve("Box4.Proofing.IProofingDescriptors"),this.Da.resolve("Box4.Proofing.IProofingLanguageInfoManager"),this.Da.resolve("Box4.Proofing.IProofingCritiqueCategoryInfoFilter")))}init(){this.Da.resolve("Box4.IProofingManager")}dispose(){}static main(){r.a.instance.Dc(new Yc)}}Object(n.a)(Yc,"Box4ProofingPackage",null,[2,3]);var hd=d(173);class se{constructor(a){this.U_e=0;this.u$a=this.iIb=this.nkb=null;this.waa=
u.AFrameworkApplication.Aa.gV;this.BQ=a;this.BQ.pu(gf.a.gph);this.BQ.zB(gf.a.gph,Object(F.a)(this,this.Ork,"onReceivedCustomAuthConfig"))}getCustomAuthConfig(){if(this.u$a)return ba.ULS.sendTraceTag(589050652,344,100,"Returning existing promise"),this.u$a;this.nkb=this.waa.Ci("ComponentAttach","getCustomAuthConfig");return this.u$a=new Promise((a,b)=>{const c={};let h=!1,m=!1,y=0;this.U_e=window.setInterval(()=>{4>y?(y++,this.BQ.sendMessage(gf.a.getCustomAuthConfig,c)):(window.clearInterval(this.U_e),
h=!0,ba.ULS.sendTraceTag(588087303,344,10,dd.c({["error"]:"Request timeout after 4 retries."})),b("Request timeout."))},1E3);this.iIb=(G,U)=>{window.clearInterval(this.U_e);h||m||(m=!0,G?(ba.ULS.sendTraceTag(589050653,344,50,"Resolving Promise with authConfig"),a(G)):(ba.ULS.sendTraceTag(589050654,369,10,dd.c({["error"]:U.toString()})),b(U)))};this.BQ.sendMessage(gf.a.getCustomAuthConfig,c)})}Ork(a){try{const b=dd.a(a.Values[hd.a.Dmi]);let c=u.AFrameworkApplication.fa.Ha("Application")||"";c=ta.a.og(c);
b.appSignInUrl="https://www.office.com/login?ru=%2Flaunch%2F"+c+"%3Facctsw%3D1&prompt=select_account";b.appSignInToUrl="https://www.office.com/login?ru=%2Flaunch%2F"+c+"%3Facctsw%3D1";b.appSwitchUrl="https://www.office.com/login?ru=%2Flaunch%2F"+c+"%3Facctsw%3D1&prompt=select_account";b.appSwitchToUrl="https://www.office.com/login?ru=%2Flaunch%2F"+c+"%3Facctsw%3D1";this.nkb&&(this.nkb.stop(),this.nkb=null);this.iIb(b,"")}catch(b){ba.ULS.sendTraceTag(589050655,344,10,dd.c({["error"]:b.message,["stack"]:b.stack})),
this.iIb(null,b.message)}}}Object(n.a)(se,"AccountSwitchingManager",null,[1305]);class Ae{get name(){return"Common.App.AccountSwitching"}$b(a){a.register(se,"Common.App.AccountSwitching.AccountSwitchingManager").as("Common.App.AccountSwitching.IAccountSwitching").ma().oa(()=>new se(a.resolve("Postmessage.IHostPostmessenger")))}init(){}dispose(){}static main(){r.a.instance.Dc(new Ae)}}Object(n.a)(Ae,"AccountSwitchingPackage",null,[2,3]);class we{constructor(){this.Oa=new bd.a}JFc(a){this.Oa.addHandler("OnEditHappenedEvent",
a)}OIk(){this.Oa.raiseEvent("OnEditHappenedEvent")}}Object(n.a)(we,"EditNotificationEventSource",null,[]);var Jf=d(102);class Yh{constructor(a,b,c,h,m,y,G=0){this.fzd=!1;this.ezd=this.Q3a=null;this.Aof=!1;this.Wd=b;this.CAc=a;this.oNa=c;this.$ga=h;this.yof=m;this.LPh=y;this.dxc=0;this.cyc=!1;try{0<G&&(this.dxc=G,3E5>this.dxc&&(this.dxc=3E5),this.Wd&&!this.ezd&&(this.ezd=new He.a(3,2,this.dxc,Object(F.a)(this,this.FWk,"reportEditDocumentUserActionTelemetryIfNecessary")),this.Wd.Eb(this.ezd)))}catch(U){ba.ULS.sendTraceTag(51246176,
383,50,"Hit an exception while trying to queue up the EditDocument user action reporting interval: "+U)}}get aCl(){return this.Aof}s_d(){this.aCl?this.cyc=!0:(this.Aof=!0,Mf.Health.instance.addQosPillar("Save"),Mf.Health.instance.addQosPillar("ContentCreation"),Jf.c(H.a.editDocument));this.fzd=!0;this.yof&&this.yof.Mpf();this.$ga&&this.$ga.OIk();u.AFrameworkApplication.Vg&&u.AFrameworkApplication.Vg.mfk();this.LPh&&!this.Q3a&&(this.bpc(null),this.Q3a=new He.a(3,2,this.CAc,Object(F.a)(this,this.bpc,
"sendPostMessageIfNecessary"),113),this.Wd.Eb(this.Q3a))}bpc(){this.fzd&&(this.oNa.CWR(()=>this.oNa.result.sendMessage(gf.a.editNotification,null)),ba.ULS.sendTraceTag(38086292,209,50,"EditNotificationManager: sending post message to the host."),this.fzd=!1)}FWk(){try{this.cyc&&(Jf.c(H.a.editDocument),this.cyc=!1)}catch(a){this.cyc=!1,ba.ULS.sendTraceTag(51246177,383,50,"Hit an exception while trying to send the EditDocument user action: "+a)}}}Object(n.a)(Yh,"EditNotificationManager",null,[1304]);
class Me{constructor(a,b,c,h,m){this.GAd=this.Q3a=null;this.Hnb=this.Bvd=!1;this.Wd=b;this.CAc=a;this.oNa=c;this.AP=h;this.aGd=m;this.agh(null)}agh(){const a=document.getElementById(u.AFrameworkApplication.sYb);!this.Hnb&&this.AP&&a&&(this.AP.pb(ra.a.mq,a,Object(F.a)(this,this.NCe,"mouseActivityHandler"),null),this.Hnb=!0);this.aGd(()=>{this.dispose()})}NCe(){this.Hnb&&(this.AP.yb(ra.a.mq,document.getElementById(u.AFrameworkApplication.sYb),Object(F.a)(this,this.NCe,"mouseActivityHandler")),this.Hnb=
!1);this.Mpf();return!1}Mpf(){this.Bvd=!0;this.GAd||(this.GAd=new He.a(3,2,this.CAc,Object(F.a)(this,this.agh,"registerHandlerTask"),112),this.Wd.Eb(this.GAd));this.Q3a||(this.bpc(null),this.Q3a=new He.a(3,2,this.CAc,Object(F.a)(this,this.bpc,"sendPostMessageIfNecessary"),111),this.Wd.Eb(this.Q3a))}bpc(){this.Bvd&&(this.oNa.CWR(()=>this.oNa.result.sendMessage(gf.a.RBl,null)),ba.ULS.sendTraceTag(38405446,209,50,"UserActivityHostNotificationManager: sending post message to the host."),this.Bvd=!1)}dispose(){this.Hnb&&
(this.AP.yb(ra.a.mq,document.getElementById(u.AFrameworkApplication.sYb),Object(F.a)(this,this.NCe,"mouseActivityHandler")),this.Hnb=!1)}}Object(n.a)(Me,"UserActivityHostNotificationManager",null,[1302,106]);var mh=d(132),af=d(288);class sk{constructor(){this.Da=null}get name(){return"Common.App.EditNotification"}init(){u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.jf(Object(F.a)(this,this.Om,"onFullAppSettingsReady"))}Om(){sk.vOi&&0<sk.t_d&&(this.Da.register(we,"Common.App.HostNotification.EditNotificationEventSource").ma(),
this.Da.register(Me,"Common.App.HostNotification.UserActivityHostNotificationManager").as("Common.Interface.IUserActivityHostNotificationManager").ma().oa(()=>new Me(6E4,mh.a.instance,af.a.Uu(this.Da.Ja("Postmessage.IHostPostmessenger")),ha.a.instance,u.AFrameworkApplication.cga)),this.Da.register(Yh,"Common.App.HostNotification.EditNotificationManager").as("Common.Interface.IEditNotificationManager").ma().oa(()=>new Yh(sk.t_d,mh.a.instance,af.a.Uu(this.Da.Ja("Postmessage.IHostPostmessenger")),this.Da.resolve("Common.App.HostNotification.EditNotificationEventSource"),
this.Da.rb("Common.Interface.IUserActivityHostNotificationManager"),sk.wOi,sk.tOi)),this.Da.resolve("Common.Interface.IEditNotificationManager"),ba.ULS.shipAssertTag(38086291,209,0<sk.t_d,"EditNotification Interval is less than or equal to 0."))}$b(a){this.Da=a}dispose(){}static get t_d(){return u.AFrameworkApplication.fa?parseInt(u.AFrameworkApplication.fa.appSettings.EditNotificationTimeIntervalMs||"300000"):3E5}static get tOi(){return u.AFrameworkApplication.fa?parseInt(u.AFrameworkApplication.fa.appSettings.EditDocumentUserActionTelemetryReportingIntervalInMilliseconds||
"0"):0}static get vOi(){return!!u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.ka("EditNotificationIsEnabled")}static get wOi(){return!!u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.ka("EditNotificationPostMessageIsEnabled")}static main(){r.a.instance.Dc(new sk)}}Object(n.a)(sk,"CommonHostNotificationPackage",null,[2,3]);class Nj{}Nj.Cbd="ReactSharedHeaderMeControlFlexPane";Nj.tEa="headerui";Nj.WZb="chat_wrapper_pane";Object(n.a)(Nj,"ReactSharedHeaderConstants",null,[]);class an{constructor(a){this.tjf=
0;this.oxd=null;this.uYh=a}get chat(){return window.swc}get isInitialized(){return!!this.chat}get oVe(){return this.uYh.value}vb(){this.isInitialized?this.Gjd():this.WPk(Object(F.a)(this,this.Gjd,"registerActionsInternal"))}Gjd(){ba.ULS.sendTraceTag(50595938,333,50,"Registering for chat events");try{this.isInitialized&&(this.chat.getContainerProvider().then(a=>{a.getChatsContainer(Object(F.a)(this,this.Emk,"onChatContainerReady"))}).catch(a=>{ba.ULS.sendTraceTag(50960143,333,10,"Failed to register for chat container {0}",
a)}),this.chat.getChatsCounter().then(a=>{a.onChatsCountChange(Object(F.a)(this,this.Fpi,"chatCountChanged"))}).catch(a=>{ba.ULS.sendTraceTag(50595939,333,10,"Failed to register chat counter callback {0}",a)}),this.chat.getKeyboard().then(a=>{a.onKeyDown(Object(F.a)(this,this.Hmk,"onChatKeyPress"))}).catch(a=>{ba.ULS.sendTraceTag(50595968,333,10,"Failed to register chat ctrlF6 callback {0}",a)}))}catch(a){ba.ULS.sendTraceTag(50595969,333,10,"Failed to register chat events: {0}",a)}}Fpi(a){ba.ULS.sendTraceTag(50595970,
333,50,"Chat count:{0}",a);if(!a)this.oVe.Dmk();else if(1===a&&!this.tjf){const b=document.getElementById(this.oxd?this.oxd:Nj.WZb);b?this.oVe.Imk(b,Object(F.a)(this,this.Vrl,"transferFocusToChat")):ba.ULS.sendTraceTag(50595971,333,10,"Chat parent is null")}this.tjf=a}Emk(a){this.oxd=a}Hmk(a){a.ctrlKey&&"f6"===a.key.toLowerCase()&&this.Trl(a.shiftKey)}WPk(a){Xe.a.instance.pb(ra.a.Xml,window.self,()=>{a();return!0})}Vrl(){ba.ULS.sendTraceTag(50595972,333,50,"Transferring focus to chat");try{this.isInitialized&&
this.chat.getFocuser().then(a=>{a.focusConversationInput()}).catch(a=>{ba.ULS.sendTraceTag(50595973,333,10,"Failed to transfer focus to chat: {0}",a)})}catch(a){ba.ULS.sendTraceTag(50595974,333,10,"Failed to transfer focus to chat: {0}",a)}}Trl(a){ba.ULS.sendTraceTag(50595975,333,50,"Transferring focus from chat");this.oVe.Fmk(a)}}Object(n.a)(an,"ChatManager",null,[1301]);class oo{constructor(){this.Oa=new bd.a;this.Snf=!1}a$h(a){this.Oa.addHandler("OnTopRowControlsCreatedEvent",a)}J9h(a){this.Oa.addHandler("OnRenameTextboxStatusChangedEventKey",
a)}get lrl(){return this.Snf}DJk(){this.Snf=!1;this.Oa.raiseEvent("OnTopRowControlsDisposingEvent")}Udh(a){this.Oa.raiseEvent("OnRenameTextboxStatusChangedEventKey",a?"true":"false")}}Object(n.a)(oo,"HeaderEventSource",null,[]);var Ho=d(198);class Pn{constructor(a,b,c,h,m){this.bEc=null;this.Od=a;this.oK=b;this.AP=c;this.r1h=h;this.Ca=m}$fh(a,b,c,h=null){const m=this.Od.Gc(b);m.parent=c;m.zL=!0;h&&m.Uba(h);this.AP.v7(b,a,!1);this.r1h.v7(b,a,!1);b=new Ho.DOMFocusListing(()=>a);b.Eo(2);b.Eo(1);b.Eo(8);
b.Eo(5);b.Eo(3);b.Eo(6);this.Od.Eia(()=>a,m,b).kX=!0;b=w.KeyInputManager.Na(z.a.Pq,0);c=w.KeyInputManager.Na(z.a.Pq,4);m.Ap(b);m.Ap(c)}onFlexPaneOpen(a){this.$fh(a,Nj.Cbd,Nj.tEa);this.Od.xf(Nj.Cbd);this.oK.w2(Nj.Cbd)}onFlexPaneClose(){this.oK.Ho(Nj.Cbd);this.Od.xf(Nj.tEa)}Imk(a,b){this.bEc||(this.bEc=b,this.$fh(a,Nj.WZb,A.AFrame.GD,Object(F.a)(this,this.Gmk,"onChatFocus")));this.Od.xf(Nj.WZb);this.oK.w2(Nj.WZb)}Gmk(){this.bEc&&this.bEc()}Dmk(){this.oK.Ho(Nj.WZb);this.Od.IPc(A.AFrame.wW)}Fmk(a){this.Ca.processAction(a?
H.a.a1d:H.a.Uud,2)}}Object(n.a)(Pn,"ReactSharedHeaderFocusManager",null,[663]);var Io=d(518);class Cl{constructor(a){this.Ca=a}vb(){this.Ca.ya(H.a.WPc,he.a.frame,Object(F.a)(this,this.TZg,"navigateToUpsellPage"));this.Ca.ya(H.a.XZi,he.a.frame,Object(F.a)(this,this.launchUpsellExperience,"launchUpsellExperience"));this.Ca.ya(H.a.LWk,he.a.frame,ed.ActionManager.Jg);this.Ca.ya(H.a.kjh,he.a.frame,ed.ActionManager.Jg)}TZg(a,b,c,h,m){if(1===c)return 32;a=8;2===c&&(c=this.M4d(m,"experience","gopremiumribbon"),
m=ng.a.HW("2116536"),m=ng.a.G5a(m,"ocid",Io.b(u.AFrameworkApplication.Aa.hb.Vk,u.AFrameworkApplication.Aa.hb.KIa,c)),qd.a.un(m,"_blank",void 0,"NavigateToUpsellPage"),a=32,this.Ca.processAction(H.a.kjh,2),ba.ULS.sendTraceTag(38929747,340,50,"User directed to POC"));return a}launchUpsellExperience(a,b,c,h,m){if(1===c)return 32;var y=8;2===c&&(ba.ULS.sendTraceTag(592721857,340,50,"LaunchUpsellExperience from Ribbon"),(y=vb.a.instance.rb("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"))?
(a=this.M4d(m,"experience","gopremium"),m=this.M4d(m,"dimeCampaignId",null),y.launchUpsellExperience(a,m),y=32):(ba.ULS.sendTraceTag(594874952,340,15,"ApplicationFeatureHelper not available"),y=this.TZg(a,b,c,h,m)));return y}M4d(a,b,c){a&&a[b]&&(c=Object(ua.a)(String,a[b]));return c}}Object(n.a)(Cl,"UpsellActor",null,[1299]);class Ck{constructor(){this.Da=null}get name(){return"Common.App.Header"}init(){vb.a.instance.resolve("Common.App.Header.IUpsellActor").vb();vb.a.instance.resolve("Common.App.Header.IChatManager").vb()}dispose(){}$b(a){this.Da=
a;this.Da.register(oo,"Common.App.Header.HeaderEventSource").ma();this.Da.register(Cl,"Common.App.Header.UpsellActor").as("Common.App.Header.IUpsellActor").ma().oa(()=>new Cl(u.AFrameworkApplication.Ta));this.Da.register(Pn,"Common.App.Header.ReactSharedHeaderFocusManager").as("Common.App.Header.IReactSharedHeaderFocusManager").ma().oa(()=>new Pn(u.AFrameworkApplication.Aa.Rr,u.AFrameworkApplication.Aa.Jw,u.AFrameworkApplication.Aa.LR,u.AFrameworkApplication.Aa.Okb,u.AFrameworkApplication.Ta));this.Da.register(an,
"Common.App.Header.ChatManager").as("Common.App.Header.IChatManager").ma().oa(()=>new an(this.Da.re("Common.App.Header.IReactSharedHeaderFocusManager")))}static main(){r.a.instance.Dc(new Ck)}}Object(n.a)(Ck,"CommonAppHeaderPackage",null,[2,3]);class Vp{constructor(a,b,c,h=null,m=null){this.jF=a;this.cSb=b;this.$Rb=c;this.kjf=h;this.VUb=m}jOc(a){const b=new Sys.StringBuilder(this.jF.soc);b.append("RoamingServiceHandler.ashx?action=");b.append("getFirstRunExperienceSettings");b.append("&");b.append(this.V7d(a));
b.append("&");b.append(u.AFrameworkApplication.jh);u.AFrameworkApplication.Je.Aj(b.toString(),1,null,null,!0,2,Object(F.a)(this,this.XDa,"getRequestSuccessCallback"),Object(F.a)(this,this.Tja,"getRequestFailureCallback"),null)}Jub(a){var b=new Sys.StringBuilder(this.jF.soc);b.append("RoamingServiceHandler.ashx?action=");b.append("saveFirstRunExperienceSettings");b.append("&");b.append(u.AFrameworkApplication.jh);b=b.toString();a=dd.c(a);u.AFrameworkApplication.Je.Aj(b,2,a,null,!0,4,Object(F.a)(this,
this.HBk,"postRequestSuccessCallback"),Object(F.a)(this,this.W$,"postRequestFailureCallback"),null)}XDa(a){let b=!1,c=null;try{if(0<a.data.Zd.length){const h=Object(ua.a)(Object,dd.a(a.data.Zd)),m=h?h[this.jF.jPd]:null;m&&(c=Object(ua.a)(Object,dd.a(m.toString())))}b=!0}catch(h){this.Tja(null)}b&&this.cSb&&this.cSb(a.data,c)}Tja(a){this.$Rb&&this.$Rb(a?a.data:null)}HBk(a){this.kjf&&this.kjf(a?a.data:null)}W$(a){this.VUb&&this.VUb(a?a.data:null)}V7d(a){const b=new Sys.StringBuilder("requestedsettings=");
for(let c=0;c<a.count;c++)b.append(a.ga(c)),c<a.count-1&&b.append(";");return b.toString()}}Object(n.a)(Vp,"FirstRunExperienceRequestHandler",null,[]);var Wp=d(399);class bn{constructor(){this.KRb=this.Hxc=this.jF=null}xWe(a){a?(this.jF=a,this.lOj()&&(ba.ULS.sendTraceTag(51675532,306,50,"Initiating call to get FRE data for current user from Roaming Settings Service"),a=new Qa.a,a.add(this.jF.jPd),this.Hxc=new Vp(this.jF,Object(F.a)(this,this.XDa,"getRequestSuccessCallback"),Object(F.a)(this,this.Tja,
"getRequestFailureCallback"),null,Object(F.a)(this,this.W$,"postRequestFailureCallback")),this.Hxc.jOc(a)),(this.jF.Pkg||u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceUITest",!1))&&this.yWe()):ba.ULS.sendTraceTag(51675531,306,10,"Invalid launcherSettings")}lOj(){try{if(this.jF.Pkg)return!0;if(!u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceEnabled",!0)||u.AFrameworkApplication.fa.ka("IsAnonymousUser"))return!1;
if(this.jF.cKj||this.jF.Ozb||u.AFrameworkApplication.fa.ka("IsO365ConsumerHost"))return!0;const a=u.AFrameworkApplication.fa.Ha("FlightId");return-1!==(a?a.toString().toLowerCase():"").indexOf("firstrunexperienceui")}catch(a){ba.ULS.sendTraceTag(576582624,306,10,"Error checking setting {0}",a?a.toString():null)}return!1}Pmh(a){const b={},c={};c.FREDisplayedDate=(new Date).toUTCString();c.VersionDisplayed=a;c.RemindMeLater=!1;b[this.jF.jPd]=dd.c(c);ba.ULS.sendTraceTag(51675533,306,50,"Initiating call to save FRE data for current user from Roaming Settings Service");
this.Hxc&&this.Hxc.Jub(b)}XDa(a,b){a=a?+a.hv-+a.St:-1;a>this.jF.olh?ba.ULS.sendTraceTag(51675534,306,50,"Call to Roaming Settings Service took {0}ms. This is more than the {1}ms threshold. A new attempt will be made next time the user starts a new session.",a,this.jF.olh):b?this.Nel(b)?(ba.ULS.sendTraceTag(51675536,306,50,"FRE data already exists for current user. FRE UI should be displayed again. User selected 'Remind me later' option more than {0} hours ago.",this.jF.BYg),this.yWe()):(this.xZd(!1),
ba.ULS.sendTraceTag(51675537,306,100,"Current user has already seen this version of the FRE. No further action required.")):(ba.ULS.sendTraceTag(51675535,306,50,"No FRE data found for current user. FRE UI should be displayed."),this.yWe())}Tja(a){this.xZd(!1);ba.ULS.sendTraceTag(51675541,306,10,"First Run Experience failed to GET data from Roaming Settings Service with status: {0}",a?a.Te:-1)}W$(a){ba.ULS.sendTraceTag(51675542,306,10,"First Run Experience failed to POST data to Roaming Settings Service with status: {0}",
a?a.Te:-1)}yWe(){this.xZd(!0);var a=vb.a.instance.rb("Common.ISystemInitiatedFeedback");a?this.Kuh(a):(ba.ULS.sendTraceTag(51675543,306,50,"Error resolving ISystemInitiatedFeedback"),u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceUIResolveFuture",!0)&&((a=vb.a.instance.Ja("Common.ISystemInitiatedFeedback"))?a.execute(b=>{this.Kuh(b)}):ba.ULS.sendTraceTag(539494111,306,50,"Error resolving ISystemInitiatedFeedback Future")))}Kuh(a){if(a){var b=this.jF.rYi;
b&&(u.AFrameworkApplication.fk(b),u.AFrameworkApplication.Aac(b));ba.ULS.sendTraceTag(51675544,306,50,"Attempting to display First Run Experience UI using floodgate.",b);a.logActivity("ShowFirstRunExperienceUIV2",null);window.addEventListener?(this.KRb=Object(F.a)(this,this.uok,"onFirstRunExperienceCampaignEvent"),window.addEventListener("FGWebSurfaceEvent",this.KRb,!0),window.addEventListener("FRELaunchedEvent",this.KRb,!0)):(ba.ULS.sendTraceTag(51675545,306,50,"FRE V2 UI triggered. Attempting to save FRE data."),
this.Pmh(this.jF.currentVersion))}else ba.ULS.sendTraceTag(539494112,306,50,"Invalid ISystemInitiatedFeedback")}uok(a){if(a){var b=a.detail;a=a.type;var c=this.jF&&this.jF.EAf?this.jF.EAf.split("-")[0]:null;if("FRELaunchedEvent"===a||c&&b&&b.id&&-1!==b.id.indexOf(c))b.success&&(ba.ULS.sendTraceTag(51675546,306,50,"FRE V2 UI has been launched. Attempting to save FRE data."),this.Pmh(this.jF.currentVersion)),window.removeEventListener&&(window.removeEventListener("FGWebSurfaceEvent",this.KRb,!0),window.removeEventListener("FRELaunchedEvent",
this.KRb,!0))}}Nel(a){if("RemindMeLater"in a&&"FREDisplayedDate"in a){if("true"===a.RemindMeLater.toString()&&(+new Date-+new Date(a.FREDisplayedDate.toString()))/36E5>this.jF.BYg)return!0}else if(u.AFrameworkApplication.fa.ka("WacShowVersionBasedFREToAllUsers")&&"VersionDisplayed"in a&&a.VersionDisplayed<this.jF.currentVersion)return ba.ULS.sendTraceTag(528262853,306,50,"Current version is higher so FRE V2 UI should be displayed again."),!0;return!1}xZd(a){u.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.DispatchFREDecisionEvent")&&
Wp.a.dispatch("FREDecisionEvent",{["show"]:a})}}Object(n.a)(bn,"FirstRunExperienceLauncher",null,[1280]);class mt{constructor(){this.Da=null}get name(){return"Common.App.FirstRunExperienceLauncher"}$b(a){this.Da=a;this.Da.register(1280,"Common.App.FirstRunExperienceLauncher.IFirstRunExperienceLauncher").ma().oa(()=>new bn)}init(){}dispose(){}static main(){r.a.instance.Dc(new mt)}}Object(n.a)(mt,"FirstRunExperienceLauncherPackage",null,[2,3]);class Oq{constructor(){this.yvd={}}r3h(a){this.yvd[a.id.toString()]=
a}lkk(a){const b=this.yvd;for(let c in b)b[c].notify(a,!1);this.yvd={}}ZGk(a,b){b&&this.r3h(b);return this.h5g(a,b)}A_d(a){this.lkk(a)}aPf(a,b){a.notify(b,!0)}}Object(n.a)(Oq,"AEventEmitter",null,[1298]);var Jo;(function(a){a[a.notStarted=0]="notStarted";a[a.waiting=1]="waiting";a[a.shouldRetry=2]="shouldRetry";a[a.complete=3]="complete"})(Jo||(Jo={}));Object(n.b)("EventResultState",Jo);class ms{constructor(){this._state=0}get state(){return this._state}set state(a){ba.ULS.sendTraceTag(5849616,202,
50,"Changing event result state. {0}",{["OldState"]:Jo[this._state],["NewState"]:Jo[a]},"ResultType",this.D3f());this._state=a}}Object(n.a)(ms,"AEventResult",null,[1346]);class Xv extends ms{constructor(){super();this.jKd=this.RUb=null;this.state=0;this.MBd=this.ccf=!1}get vR(){return this.RUb}get gLa(){return this.jKd}get DFj(){return this.ccf}D3f(){return"GetMoreInfo Result"}}Object(n.a)(Xv,"GetMoreInfoResult",ms,[1345,1346]);var Yv=d(435),Zv=d(519);class cp{constructor(a,b,c,h,m,y,G,U){this.Ca=
a;this.ei=b;this.PH=c;this.Iga=h;this.Wd=m;this.ZRb=y;this.GRh=G;this.tDc=U}KOk(){this.OFb.ya(H.a.QGb,he.a.frame,Object(F.a)(this,this.QGb,"openUrlInNewTab"));this.OFb.ya(H.a.uHe,he.a.frame,Object(F.a)(this,this.uHe,"openDocumentUrl"));u.AFrameworkApplication.yca?this.tog():this.OFb.ra(H.a.ZMc,he.a.frame,Object(F.a)(this,this.ZMc,"documentLoaded"),96)}QGb(a,b,c,h,m){m&&m.MenuItemId&&(ba.ULS.sendTraceTag(5849678,202,50,"Opening new tab {0}",{["Id"]:m.SourceControlId,["AppType"]:Zv.a[this.Wma]}),qd.a.un(m.MenuItemId.toString(),
"_blank",void 0,"NewAndOpenCommonHelpers:OpenUrlInNewTab"));return 32}uHe(a,b,c,h,m){if(m&&m.MenuItemId){const y=u.AFrameworkApplication.fa.ka("WacInTabOpenMRUIsEnabledForUiHost"),G=u.AFrameworkApplication.fa.ka("UiHostSupportsDocRebootFeatures");ba.ULS.sendTraceTag(592237459,202,50,"[InTabOpenMRUIsEnabledForUiEmbed: {0}][UiEmbedSupportsDocReboot: {1}]",y,G);if(y&&G){ba.ULS.sendTraceTag(592237458,202,50,"Opening new tab {0}",{["Id"]:m.SourceControlId,["AppType"]:Zv.a[this.Wma]});a=m.MenuItemId.toString();
const U={};U[hd.a.cJb]="1";U[hd.a.documentUrl]=a;U[hd.a.reason]=Yv.a.open;ba.ULS.sendTraceTag(592237460,202,50,"Send PostMessage to the Ui host to reboot a document");u.AFrameworkApplication.gT().execute(ja=>{ja.sendMessage(gf.a.VCa,U)})}else this.QGb(a,b,c,h,m)}return 32}ZMc(){this.tog();return 32}vbb(a,b,c=""){if(b&&b.St){const h=mk.a[b.status];b=b.St.getTime();const m=this.zF()-b;ba.ULS.sendTraceTag(5849679,202,50,"Making request to the WAC server {0}",{["Caller"]:a,["RequestStatus"]:h,["ElapsedMs"]:m,
["StartTime"]:b,["Notes"]:c})}else ba.ULS.sendTraceTag(5849680,202,50,"Attempted to make a request to the WAC server with null request item {0}",{["Caller"]:a})}tog(){var a=u.AFrameworkApplication.fa.ka("QPGVCI"),b=ng.a.dT(document.URL,"wdNewAndOpenCt",a);if(b){b=parseInt(b);var c=ng.a.dT(document.URL,"wdPreviousSession",a);a=ng.a.dT(document.URL,"wdPreviousCorrelation",a);var h=u.AFrameworkApplication.fa.ka("NAOPLP");if(u.AFrameworkApplication.yca){var m=u.AFrameworkApplication.yca.getTime();!b||
b>m?ba.ULS.sendTraceTag(5849682,202,15,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Invalid timestamp {0}",{["ClickTimestamp"]:b,["DocumentLoadedTime"]:m,["SessionId"]:c,["Correlation"]:a}):ba.ULS.sendTraceTag(5849683,202,h?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Click-to-load perf {0}",{["ClickToLoadTime"]:m-b,["ClickTimestamp"]:b,["SessionId"]:c,["Correlation"]:a})}else ba.ULS.sendTraceTag(5849681,202,h?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Not logging because document loaded time has not been set {0}",
{["ClickTimestamp"]:b,["SessionId"]:c,["Correlation"]:a})}}get OFb(){return this.Ca.value}get Gic(){return this.ei.value}get $Zg(){return this.PH.value}get Wma(){return this.Iga.value}get scd(){return this.Wd.value}get zF(){return this.ZRb}get Vma(){return this.GRh.value}get iLa(){return this.tDc.value}static get instance(){return cp.Ka||(cp.Ka=cp.ur())}static ur(){return new cp(new sb.a(()=>u.AFrameworkApplication.Ta),new sb.a(()=>u.AFrameworkApplication.Je),new sb.a(()=>u.AFrameworkApplication.Aa),
new sb.a(()=>u.AFrameworkApplication.Aa.hb.Vk),new sb.a(()=>u.AFrameworkApplication.we),()=>(new Date).getTime(),new sb.a(()=>u.AFrameworkApplication.Aa.hb.Vma),new sb.a(()=>u.AFrameworkApplication.iLa))}}cp.Ka=null;Object(n.a)(cp,"NewAndOpenCommonHelpers",null,[1297]);class Zx{constructor(a,b,c){this.OCc=this.Tm=null;this.nId=0;this.JZh=a;this.Wd=b;this.C8e=c}Hbi(){this.nId=this.XJb+1}yQe(a){this.Tm&&(this.Wd.Rg(this.Tm),this.Tm=null);a&&(this.nId=0)}Ukl(a){const b=this.nql;0<=b?(this.Hbi(),this.yQe(!1),
this.Tm=new He.a(4,1,b,a,107),this.Wd.Eb(this.Tm)):(this.yQe(!0),ba.ULS.sendTraceTag(5849676,202,50,"Retries exhausted {0}",{["Action"]:this.C8e}))}get XJb(){return this.nId}get nql(){return this.XJb>=this.yoh.length?-1:this.yoh[this.XJb]}get yoh(){if(!this.OCc){const a=(this.JZh.value||"0").split(",");this.OCc=[];for(let b=0;b<a.length;b++){const c=parseInt(a[b]);isNaN(c)?ba.ULS.sendTraceTag(5849677,202,15,"Retry interval list contains non-number element {0}",{["Action"]:this.C8e,["Entry"]:a[b]}):
Array.add(this.OCc,c)}}return this.OCc}}Object(n.a)(Zx,"RetryHelper",null,[]);class Lm extends Oq{constructor(a,b){super();this.yha=a;this.uVb=new Zx(b,this.lic.scd,"GetMoreInfo");this.Px=new Xv}Nek(){this.QBe("Document opened")}BDi(a){return()=>{this.QBe(a,!0)}}h5g(a,b=null){ba.ULS.sendTraceTag(5849617,202,50,"Attempting to get GetMoreInfo properties {0}",{["Trigger"]:a});3===this.Px.state?(b&&this.aPf(b,this.Px),ba.ULS.sendTraceTag(5849619,202,50,"GetMoreInfo already populated. {0}",{["Trigger"]:a})):
this.QBe(a);return this.Px}QBe(a,b=!1){this.uVb.yQe(!b);1===this.Px.state?ba.ULS.sendTraceTag(5849620,202,50,"Not starting new request, because one is already in progress {0}",{["Trigger"]:a,["RetryIndex"]:this.uVb.XJb}):(ba.ULS.sendTraceTag(5849621,202,50,"Making GetMoreInfo request {0}",{["Trigger"]:a,["RetryIndex"]:this.uVb.XJb}),this.Px.state=1,b=String.format("{0}GetMoreInfoHandler.ashx?{1}",this.lic.Vma,u.AFrameworkApplication.jh),this.lic.Gic.YV(b,1,null,null,[Lm.Zif,Lm.bnf],5,this.ECi(),this.DCi(a),
null))}ECi(){return a=>{var b=!1;let c=!1;var h=!1,m;u.AFrameworkApplication.fa.ka("GetMoreInfoDataFromResponseBody")&&(a.data.Zd?({kv:m}=dd.d(a.data.Zd)).returnValue?m?(h=!0,this.Px.jKd=m.StorageServiceDisplayName,this.Px.RUb=Lm.slg(m.PersonalFileStorageUrl)?m.PersonalFileStorageUrl:"",""===this.Px.vR&&"SharePointOnlineConsumer"===u.AFrameworkApplication.fa.Ha("FileSource")&&(this.Px.RUb=ng.a.Nna(u.AFrameworkApplication.breadcrumbFolderUrl)),b=""===this.Px.vR&&""!==this.Px.gLa):ba.ULS.sendTraceTag(25298113,
202,15,"Response body could not be casted into a GetMoreInfoResponseData type. Will fallback to reading the data from the headers"):ba.ULS.sendTraceTag(25298112,202,15,"Failed to deserialize GetMoreInfo response body. Will fallback to reading the data from the headers"):ba.ULS.sendTraceTag(25298083,202,15,"Could not find GetMoreInfo data on the response body. Will fallback to reading the data from the headers"));h||((m=a.data.rj)?(this.Px.jKd=(m[Lm.bnf]||"").toString(),b=(m[Lm.Zif]||"").toString(),
this.Px.RUb=Lm.slg(b)?b:"",""===this.Px.vR&&"SharePointOnlineConsumer"===u.AFrameworkApplication.fa.Ha("FileSource")?(this.Px.RUb=ng.a.Nna(u.AFrameworkApplication.breadcrumbFolderUrl),b=""===this.Px.vR&&""!==this.Px.gLa):b=""===b&&""!==this.Px.gLa):(ba.ULS.sendTraceTag(5849622,202,50,"Null response headers received."),c=!0));h=String.format("Success at RetryIndex: {0}, InvalidResponse: {1}, InstantiatingPersonalStorage: {2}, InfoFoundInResponseBody: {3}",this.uVb.XJb,c,b,h);this.lic.vbb("GetMoreInfoActor.CreateGetMoreInfoFromServerSuccessCallback",
a.data,h);this.Loh(3,b,c)}}DCi(a){return b=>{this.lic.vbb("GetMoreInfoActor.CreateGetMoreInfoFromServerFailureCallback",b.data,"Failure");this.Loh(2);this.uVb.Ukl(this.BDi(a))}}Loh(a,b=!1,c=!1){this.Px.state=a;this.Px.ccf=b;this.Px.MBd=c;this.A_d(this.Px)}get lic(){return this.yha.value}static get instance(){return Lm.Ka||(Lm.Ka=Lm.ur())}static ur(){return new Lm(new sb.a(()=>cp.instance),new sb.a(()=>u.AFrameworkApplication.Sbj))}static slg(a){if(!a)return ba.ULS.sendTraceTag(5849624,202,50,"Attempted to check an empty url for validity as a StorageHostUrl."),
!1;if(ta.a.og(a).startsWith("https://"))return!0;ba.ULS.sendTraceTag(5849625,202,10,"StorageUrl has invalid scheme.");return!1}}Lm.Zif="PersonalFileStorageUrl";Lm.bnf="StorageServiceDisplayName";Lm.Ka=null;Object(n.a)(Lm,"GetMoreInfoActor",Oq,[]);class wp{constructor(a,b,c,h,m){this.iSh=6E4;this.sbg="inactive";this.Epf="active";this.sha=!0;this.Wd=a;this.iRh=b;this.ZRb=c;this.VDc=h;this.Oa=new bd.a;m&&this.Mkl();this.Fef=this.Z0f()}Upf(a){this.Oa.addHandler(this.Epf,a)}I5h(a){this.Oa.addHandler(this.sbg,
a)}Mkl(){const a=new He.a(5,2,this.iSh,Object(F.a)(this,this.BAj,"inactiveLoop"),108);this.CAj.Eb(a)}BAj(){const a=this.Z0f(),b=this.zF()-a;b>this.Nrd&&this.sha&&(ba.ULS.sendTraceTag(5849626,202,50,"User went inactive {0}",{["TimeSinceLastActive"]:b}),this.sha=!1,this.Oa.raiseEvent(this.sbg));a-this.Fef>this.Nrd&&(this.sha=!0,this.Oa.raiseEvent(this.Epf));this.Fef=a}get CAj(){return this.Wd.value}get Z0f(){return this.iRh}get zF(){return this.ZRb}get Nrd(){return this.VDc.value}static get instance(){return wp.Ka||
(wp.Ka=wp.ur())}static ur(){return new wp(new sb.a(()=>mh.a.instance),()=>u.AFrameworkApplication.Xle.getTime(),()=>(new Date).getTime(),new sb.a(()=>u.AFrameworkApplication.Nrd),!0)}}wp.Ka=null;Object(n.a)(wp,"InactivityManager",null,[]);var nt=d(911);class yu extends ms{constructor(){super();this.PVh=this.Vgf=this.Ugf=null;this.state=this.Onf=0;this.MBd=!1}get rDe(){return this.Ugf}get zZg(){return this.Vgf}get qql(){return this.Onf}D3f(){return"MruActor Result"}}Object(n.a)(yu,"MruResult",ms,[1348,
1346]);var Xp=d(174);class zu{constructor(a,b,c){this.task=null;this.I$a=a;this.ugk=b;this.taskManager=c;this.retryCount=this.j8b=0;this.lHd=this.Q$b=null}aQj(a,b){return a===Xp.a.c3d||20===b||18===b||3===b}DRj(a){return 3===a||5===a||6===a||7===a||9===a||10===a||11===a||12===a||13===a||14===a||15===a||16===a||23===a||26===a||27===a||28===a}get thd(){return this.lHd}reset(){this.j8b=this.retryCount=0;this.lHd=this.Q$b=null;this.task&&(this.taskManager.Rg(this.task),this.task=null)}rEj(a,b,c,h){this.lHd=
String.format("{0}_{1}",c,h);if(this.retryCount>=this.ugk)return ba.ULS.sendTraceTag(562656907,202,50,"Max retries exceeded"),!1;if(this.aQj(c,h))return ba.ULS.sendTraceTag(562656908,202,50,"Encountered permanent error. Not retrying"),!1;if(this.DRj(h)&&1<=this.j8b)return this.Q$b=c,!1;b=Math.max(b,this.I$a*Math.pow(2,this.j8b));if(26===h)b=Math.max(b,3E4);else if(27===h||28===h)b=Math.max(b,6E4);9===h||412===c&&(null==this.Q$b||412!==this.Q$b)?b=500:this.j8b+=1;this.Q$b=c;this.retryCount+=1;this.task&&
this.taskManager.Rg(this.task);ba.ULS.sendTraceTag(562656909,202,50,"Scheduling next retry after {0} ms.",b);this.task=new He.a(2,1,b,a,107);this.taskManager.Eb(this.task);return!0}}Object(n.a)(zu,"RetryManager",null,[]);var Pq=d(219),Dg=d(70);class Au{constructor(){this.mruItemId=this.app=this.documentExt=this.documentName=this.folderName=this.documentUrl=null}}Object(n.a)(Au,"WriteOptions",null,[]);class Mm extends Oq{constructor(a,b,c,h,m,y,G){super();this.yha=a;this.WUh=b;this.yOa=new zu(u.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruReadRetryIntervalMs",
5E3),u.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruMaxReadRetry",3),this.PO.scd);this.bPa=new zu(u.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruWriteRetryIntervalMs",15E3),u.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruMaxWriteRetry",3),this.PO.scd);this.yYh=c;this.epf=h;this.L2h={};this.Z6=new yu;this.eRh=m;this.tAc="";this.cF=y;this.T9e=G}get Lud(){return this.L2h}PQk(){this.PO.OFb.ya(H.a.zih,he.a.frame,
Object(F.a)(this,this.oVk,"renameMruEntry"))}oVk(){return this.w4e("Rename")}Vek(){this.kXg("File Opened")}Wek(){this.kXg("IntervalUpdate")}kXg(a){ba.ULS.sendTraceTag(5849670,202,50,"Starting update of MRU entry {0}",{["Trigger"]:a});this.w4e(a)}bT(a){(a=ta.a.bT(a))&&a.startsWith(".")&&(a=a.substring(1,a.length));return a}uXf(){switch(this.PO.Wma){case 3:return"Word";case 1:return"Excel";case 2:return"PowerPoint";case 5:return"Visio";case 4:return"OneNote";default:return"Unknown"}}pmj(a){var b=this.eRh();
if(!b)return null;const c=new Au;c.documentUrl=this.T9e.value?encodeURI(b):b;c.mruItemId=this.tAc;c.app=this.uXf();if(b=this.cF())c.folderName=b.breadcrumbFolderName,b=b.Uw,c.documentName=ta.a.TG(b),c.documentExt=this.bT(b);a&&(c.documentName?c.documentName.length?255<=c.documentName.length?a.set("DocumentNameLength","Long"):2084<=c.documentName.length&&a.set("DocumentNameLength","VeryLong"):a.set("DocumentNameLength","0"):a.set("DocumentNameLength","Null"));return JSON.stringify(c)}w4e(a,b=!1){if(4===
this.PO.Wma&&!u.AFrameworkApplication.YMc)return 2;var c=Pq.a.Lz();c&&(c.set("Trigger",a),c.set("IsRetry",b?"true":"false"),c.set("MruIdSent",this.tAc?"true":"false"),c.set("URLEncoded",this.T9e.value?"true":"false"));Mf.Health.instance.recordKpiUsage("WriteMru",0,"smartfio",c);a=this.pmj(c);if(!a)return b=!u.AFrameworkApplication.Ilb,c&&(c.set("WebEditingIsEnabled",u.AFrameworkApplication.Ilb?"true":"false"),c.set("ProtectedFile",u.AFrameworkApplication.yR?"true":"false")),Mf.Health.instance.recordKpiFailure("WriteMru",
"MissingDocumentUrl",b,!1,Object.assign(new ql.a,{extendedProperties:c})),2;this.bPa&&!b&&this.bPa.reset();c=String.format("{0}MruV2ServiceHandler.ashx?rs={1}",this.PO.Vma,this.Lng);this.epf?this.Lud["X-FileId"]=u.AFrameworkApplication.jh:c+=String.format("&{0}",u.AFrameworkApplication.jh);u.AFrameworkApplication.gd&&(this.Lud["X-Office-AudienceGroup"]=Object(ua.a)(String,u.AFrameworkApplication.gd.AudienceGroup)||"");this.Lud["X-Timeout"]=15E3;return this.PO.Gic.Aj(c,2,a,this.Lud,!0,5,Object(F.a)(this,
this.CFl,"writeMruV2EntryOnServerSuccessCallback"),Object(F.a)(this,this.ZGi,"createWriteMruV2EntryOnServerFailureCallback"),null,void 0,void 0,void 0,void 0,"4")}CFl(a){this.x8f(a.data)}x8f(a){const b=Pq.a.Lz();this.bPa&&(b&&this.bPa.thd&&(b.set("LastError",this.bPa.thd),b.set("NumRetries",this.bPa.retryCount.toString())),this.bPa.reset());const c=nt.c(a.Zd);c&&c.diagnostics_data&&(this.tAc=c.diagnostics_data.mru_id);a=+a.hv-+a.St;b&&b.set("RequestDuration",a.toString());Mf.Health.instance.recordKpiSuccess("WriteMru",
Object.assign(new ql.a,{extendedProperties:b}))}ZGi(a){if(a.data.Te===Xp.a.T0b)this.x8f(a.data);else{var b=a.data.Te===Xp.a.Hlc,c=Pq.a.Lz();this.U8f(this.bPa,a,this.NGi(),c);c&&(c.set("StatusCode",a.data.Te.toString()),b||this.cNd(a.data,c));Mf.Health.instance.recordKpiFailure("WriteMru",String.format("RequestFailed_{0}",a.data.Te),b,!1,Object.assign(new ql.a,{extendedProperties:c}))}}NGi(){return()=>{this.w4e("Retry",!0)}}Ybj(){this.hbd("Polling")}Xbj(){this.hbd("Retry",!0)}Pek(){this.hbd("Open")}Oek(){this.hbd("Activity")}hbd(a,
b=!1){ba.ULS.sendTraceTag(5849674,202,50,"Making GetMru request {0}",{["Trigger"]:a});const c=Pq.a.Lz();c&&(c.set("Trigger",a),c.set("IsRetry",b?"true":"false"));Mf.Health.instance.recordKpiUsage("GetMru",0,"smartfio",c);this.yOa&&!b&&this.yOa.reset();this.FCi(Object(F.a)(this,this.$bj,"getMruV2FromServerSuccessCallback"),Object(F.a)(this,this.Wbj,"getMruFromServerFailureCallback"))}cNd(a,b){a&&a.rj&&(a=a.rj["X-CorrelationId"])&&b.set("ServerCorrelationId",a)}O0j(a,b){a&&(b&&b.set("RequestDuration",
(+a.hv-+a.St).toString()),Mf.Health.instance.recordKpiSuccess("GetMru",Object.assign(new ql.a,{extendedProperties:b})))}$bj(a){this.acj(a)}acj(a){var b="";let c=null,h=null,m=null;const y=nt.c(a.data.Zd);y&&(c=y.places?y.places.items:[],h=y.documents?y.documents.items:[],(m=nt.a(y,!1))&&(b=dd.c(m)));u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.hb.qFa&&Dg.c()&&appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(b,!0));b=Pq.a.Lz();this.yOa&&(b&&this.yOa.thd&&(b.set("LastError",this.yOa.thd),
b.set("NumRetries",this.yOa.retryCount.toString())),this.yOa.reset());m||c||h?(this.PO.vbb("MruActor.GetMruV2FromServerSuccessCallback",a.data,"Success"),this.ytd(3,m,c,h),this.O0j(a.data,b)):(this.PO.vbb("MruActor.GetMruV2FromServerSuccessCallback",a.data,"Failure: Invalid JSON"),b&&this.cNd(a.data,b),Mf.Health.instance.recordKpiFailure("GetMru","JsonParseFailed",!1,!1,Object.assign(new ql.a,{extendedProperties:b})),this.ytd(3,null,null,null,!0));this.A_d(this.Z6)}U8f(a,b,c,h){let m=0,y=0;const G=
nt.c(b.data.Zd);G&&(null!=G.response_code&&(m=G.response_code,h&&h.set("MruResponseCode",m.toString()),9===m&&(this.tAc="")),G.error_data&&null!=G.error_data.retry_after_ms&&(y=G.error_data.retry_after_ms,h&&h.set("ExpectedRetryAfter",y.toString())));a&&(b=a.rEj(c,y,b.data.Te,m),h&&(h.set("CurrentRetryCount",a.retryCount.toString()),h.set("RetryScheduled",b?"true":"false")))}Wbj(a){this.Zbj(a)}Zbj(a){const b=a.data.Te===Xp.a.Hlc,c=Pq.a.Lz();c&&(c.set("StatusCode",a.data.Te.toString()),b||this.cNd(a.data,
c));this.PO.vbb("MruActor.GetMruFromServerFailureCallback",a.data,"Failure");this.ytd(2);this.U8f(this.yOa,a,Object(F.a)(this,this.Xbj,"getMruFromServerRetryTask"),c);Mf.Health.instance.recordKpiFailure("GetMru",String.format("RequestFailed_{0}",a.data.Te),b,!1,Object.assign(new ql.a,{extendedProperties:c}));this.A_d(this.Z6);u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.hb.qFa&&Dg.c()&&(appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson("",!1)),appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson("",
!1)))}ytd(a,b=null,c=null,h=null,m=!1){if(3!==this.Z6.state||3===a)this.Z6.Ugf=b,this.Z6.Vgf=c,this.Z6.PVh=h,this.Z6.state=a,this.Z6.MBd=m,this.Z6.Onf=this.PO.zF()}h5g(a,b){ba.ULS.sendTraceTag(6029918,202,50,"MRU result requested {0}",{["Trigger"]:a,["ResultState"]:this.Z6.state});b&&3===this.Z6.state&&this.aPf(b,this.Z6);return this.Z6}FCi(a,b){this.ytd(1);let c;const h={};c=String.format(this.PO.Vma+"MruV2ServiceHandler.ashx?sort=Date&show={0}&apps={1}&rs={2}",10,this.uXf(),this.Lng);this.yYh.value||
(c+="&entity=docs");u.AFrameworkApplication.gd&&(h["X-Office-AudienceGroup"]=Object(ua.a)(String,u.AFrameworkApplication.gd.AudienceGroup)||"");this.epf?h["X-FileId"]=u.AFrameworkApplication.jh:c+=String.format("&{0}",u.AFrameworkApplication.jh);this.PO.Gic.Aj(c,1,null,h,!0,5,a,b,null)}get PO(){return this.yha.value}get Lng(){return this.WUh.value}static get instance(){return Mm.Ka||(Mm.Ka=Mm.ur())}static ur(){return new Mm(new sb.a(()=>cp.instance),new sb.a(()=>Fa.a.ue(u.AFrameworkApplication.lcid).name),
new sb.a(()=>u.AFrameworkApplication.Aa.hb.uC),u.AFrameworkApplication.fa.ka("MruWriteFileIdInHeader"),()=>u.AFrameworkApplication.Aa.hb.ica,()=>u.AFrameworkApplication.xu,new sb.a(()=>u.AFrameworkApplication.fa.ka("OICEncodeUrlIsEnabled")))}}Mm.Ka=null;Object(n.a)(Mm,"MruActor",Oq,[]);class $v{constructor(){this.VWb=this.Wjf=this.Da=null;this.mo=!1}get name(){return"Common.App.NewAndOpen.Core"}$b(a){this.Da=a;a.register(1297,"Common.INewAndOpenCommonHelpers").ma().oa(()=>cp.instance);a.register(1298,
"Common.IEventEmitter<Common.IGetMoreInfoResult>").ma().oa(()=>Lm.instance);a.register(1298,"Common.IEventEmitter<Common.IMruResult>").ma().oa(()=>Mm.instance)}init(){u.AFrameworkApplication.fa.jf(()=>{this.BEa()})}BEa(){this.Da.resolve("Common.INewAndOpenCommonHelpers");this.Da.resolve("Common.IEventEmitter<Common.IGetMoreInfoResult>");this.Da.resolve("Common.IEventEmitter<Common.IMruResult>");var a=!1;cp.instance.KOk();u.AFrameworkApplication.Iwa&&(a=!0);u.AFrameworkApplication.ANe&&(Mm.instance.Pek(),
0<u.AFrameworkApplication.AZg&&this.Eqf(),this.yal(),a=!0);u.AFrameworkApplication.iLa&&a&&Lm.instance.Nek();u.AFrameworkApplication.nzl&&(a=Mm.instance,a.PQk(),a.Vek(),mh.a.instance.Eb(this.ozl))}yal(){wp.instance.Upf(Object(F.a)(Mm.instance,Mm.instance.Oek,"makeGetMruRequestActivityTrigger"));wp.instance.Upf(Object(F.a)(this,this.Eqf,"addGetMruFromServerTask"));wp.instance.I5h(Object(F.a)(this,this.CJi,"deleteGetMruFromServerTask"))}CJi(){mh.a.instance.Rg(this.BZg)}Eqf(){mh.a.instance.Eb(this.BZg)}get BZg(){return this.Wjf||
(this.Wjf=new He.a(5,2,u.AFrameworkApplication.AZg,Object(F.a)(Mm.instance,Mm.instance.Ybj,"getMruFromServerTask"),109))}get ozl(){return this.VWb||(this.VWb=new He.a(2,2,6E4*u.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruUpdateIntervalInMinutes",1440),Object(F.a)(Mm.instance,Mm.instance.Wek,"makeUpdateMruTask"),197))}dispose(){this.mo||(this.mo=!0,this.VWb&&(mh.a.instance.Rg(this.VWb),this.VWb=null))}}Object(n.a)($v,"CorePackageManager",null,[2,3,106]);var Di=d(122);
class Yp{constructor(a,b,c,h,m,y,G,U,ja,va){this.OEg=new Qa.a;this.tSg=null;this.Vb=h;this.ua=m;this.Fa=c;this.Lua=G;this.ela=U;this.IC=y;this.pa=b;this.la=ja;this.Lq=a;this.qd=va;this.la.cSj&&(this.pa&&this.pa.GG(Object(F.a)(this,this.yH,"onSelectionChanged")),U&&U.QPk(this),this.Lq.GFc(Object(F.a)(this,this.AU,"onFocusChanged")),this.qd.Ysf(Object(F.a)(this,this.Mjc,"onShapeViewElementUnlocked")),this.qd.oai(Object(F.a)(this,this.G6g,"onThumbnailsSetFakeImage")),this.qd.pai(Object(F.a)(this,this.H6g,
"onThumbnailsSetFocus")),this.qd.qai(Object(F.a)(this,this.I6g,"onThumbnailsSetSelected")),this.la.EYc&&this.Lq.Z9h(Object(F.a)(this,this.b6g,"onSlideshowNavigationToolbarClickedHandler")),this.la.wg&&this.Lq.Y9h(Object(F.a)(this,this.$5g,"onSlideshowContextMenuFocusedHandler")))}dispose(){this.Lq.fkd(Object(F.a)(this,this.AU,"onFocusChanged"));this.Lq.cTk(Object(F.a)(this,this.Cnk,"onDesignerClickSuggestion"));this.qd.sih(Object(F.a)(this,this.Mjc,"onShapeViewElementUnlocked"));this.qd.fVk(Object(F.a)(this,
this.G6g,"onThumbnailsSetFakeImage"));this.qd.gVk(Object(F.a)(this,this.H6g,"onThumbnailsSetFocus"));this.qd.hVk(Object(F.a)(this,this.I6g,"onThumbnailsSetSelected"));this.la.EYc&&this.Lq.qUk(Object(F.a)(this,this.b6g,"onSlideshowNavigationToolbarClickedHandler"));this.la.wg&&this.Lq.pUk(Object(F.a)(this,this.$5g,"onSlideshowContextMenuFocusedHandler"))}yH(a,b){if(b&&b.ll&&this.pa.F_(b.ll))try{this.tuj(b.ll)}catch(c){a=String.format("AriaManager failed to handle the select changed event. Message: {0}. Stack: {1}",
c.message,c.stack),Ba.a.J(17367906,822,10,a)}}tuj(a){var b=this.pa.sg();if(1===a.length||1===b.length&&b[0].Kg){if(a=this.pa.Jp()){b=new Qa.a;let c=this.l3f(a,b,Object(F.a)(this,this.Fhj,"getShapeName"));c||b.count||(c=this.ela.h4f(a,b));!c&&a.get_smartArtModelId()?c=ResourceStrings.l_AccMessageSmartArtSubIcon:ta.a.Wa(c)||(c+=ResourceStrings.L_ShapeSelected);const h=this.ela.Nhj(a);({gwf:c,I4e:b}=this.Auf(h,c,b));!a.vs&&a.isUnread&&({gwf:c,I4e:b}=this.Auf(this.ela.Ohj(a,this.tSg),c,b));0<b.count?
this.Peh(b):this.yfa(c||"")}}else 1<a.length&&(a=this.ela.ccj(this.pa.Xd()),this.yfa(a||""))}Auf(a,b,c){a&&(c.count?c.add(document.createTextNode(a)):b=String.format(ResourceStrings.l_ShapeAndPresenceInfo,b,a));return{gwf:b,I4e:c}}AU(a,b){b=b.Zfb;if(b===Di.a.JD||b===Ua.a.rg){a=this.ua.Ba;let c=null;b===Di.a.JD?c=(a=this.Vb.vsc.Ida)?String.format(ResourceStrings.l_ThumbnailPanelWithSlideInfo,this.w9a()+this.ela.B9d(a)):String.format(ResourceStrings.l_ThumbnailPanelWithSlideInfo,this.w9a()):b!==Ua.a.rg||
!this.pa.xs()&&this.pa.J3()||(this.IC&&this.IC.value&&(b=this.IC.value.Rd)&&a&&b.np&&Lh.e(a,b.Ma),c=this.ela.nij());this.yfa(c||"")}}setAttribute(a,b,c){a&&zc.a.bP(a,b,c)}D5(a){this.OEg.add(a)}l3f(a,b,c=null){try{if(a&&this.Fa)for(let h of this.OEg)if(h){const m=h(a,this.Fa.Be?this.Fa.Be.name:null,b,c);if(m||b&&0<b.count)return m}}catch(h){a=String.format("AriaManager failed to get provider message. Message: {0}. Stack: {1}",h.message,h.stack),Ba.a.J(17662480,822,10,a)}return null}Peh(a){if(this.Lua&&
this.Lua.value){const b=this.Lua.value.Naj();if(b&&a&&0<a.count){b.firstChild&&b.removeChild(b.firstChild);const c=document.createElement("p");for(let h of a)c.appendChild(h);b.appendChild(c)}}}Seh(a,b){if(a){const c=new Qa.a;let h=this.l3f(a,c);h||c.count||(h=this.ela.h4f(a,c));0<c.count?(b&&c.add(document.createTextNode(b)),this.Peh(c)):(b&&(h+=" "+b),this.yfa(h||""))}}yfa(a){this.Lua&&this.Lua.value&&this.Lua.value.sendNotification(a,!0)}Mjc(a,b){b.presenceUser&&b.kSj&&this.yfa(String.format(ResourceStrings.L_EditorLeavingHint,
b.presenceUser.userName))}Cnk(a,b){this.yfa(this.ela.K6i(b.o2k,b.zml))}G6g(a,b){this.setAttribute(b.n6.image,zc.a.af,zc.a.DPa)}H6g(a,b){b.hasFocus&&b.n6.isSelected&&this.yfa(this.w9a()+this.ela.B9d(b.n6));this.setAttribute(b.n6.Qkb,zc.a.X5a,b.hasFocus&&b.n6.isSelected?"true":"false")}I6g(a,b){b.n6.isSelected&&b.hasFocus?this.yfa(this.w9a()+this.ela.B9d(b.n6)):b.n6.isSelected||this.yfa(this.w9a());this.setAttribute(b.n6.Qkb,zc.a.X5a,b.n6.isSelected?"true":"false")}b6g(a,b){this.yfa(b.text)}Fhj(a){this.tSg=
a||ResourceStrings.l_Object}$5g(a,b){this.yfa(b.text)}w9a(){let a="";const b=this.pa.We();b&&1<b.length&&(b.sort((c,h)=>c.oe-h.oe),this.orb(b)&&(a=this.ela.w9a(b[0].oe+1,b[b.length-1].oe+1)));return a}orb(a){if(!a||1>=a.length)return!1;const b=a.length;return a[b-1].oe-a[0].oe+1===b?!0:!1}}Object(n.a)(Yp,"AriaManager",null,[1259,106]);var $x=d(912);class Bu{constructor(){this.K=null}get name(){return"PowerPointWebEditor.Aria"}$b(a){this.K=a;this.K.register(1016,"PowerPointWebEditor.IAriaMessageHelper").ma().oa(()=>
new $x.a(this.K.Ja("PowerpointPresence.IPresenceUserManager"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("PowerPointWebEditor.Graph.INotesReader"),this.K.Ja("PowerPointWebEditor.Graph.ICommentReader"),this.K.Ja("PowerPointWebEditor.IAppForOfficeManager"),this.K.re("PowerPointWebEditor.IAppforOfficeClassFactory"),this.K.resolve("Box4.IParagraphReader"),this.K.resolve("PowerPointWebEditor.IApplicationSettings")));this.K.register(1259,
"PowerPointWebEditor.IAriaManager").ma().oa(()=>new Yp(this.K.resolve("PowerPointWebEditor.View.IViewEventHandlers"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("PowerPointWebEditor.IPPTWorkspace"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.re("Box4.IInteractiveViewManager"),this.K.re("Common.Utils.IAriaNotifier"),this.K.resolve("PowerPointWebEditor.IAriaMessageHelper"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),
this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers")))}init(){}dispose(){this.K.resolve("PowerPointWebEditor.IAriaManager").dispose()}static main(){r.a.instance.Dc(new Bu)}}Object(n.a)(Bu,"PptAriaPackage",null,[2,3]);var aw=d(1025);class ot{constructor(){this.Priority=0;this.Context=null;this.Length=this.StartInContext=this.Start=0;this.Metadata=ot.gPi;this.Suggestions=this.TypeId=this.TraceId=null;this.CritiqueActions=this.SupportedActions=0;this.RevisionId=this.TileId=this.Explanation=
this.ExplanationLabel=this.ExplanationTitle=this.CategoryTitle=null;this.Tag=this.Status=this.BucketId=0}}ot.gPi=[];Object(n.a)(ot,"Critique",null,[]);class ay{constructor(){this.Text=null;this.Level=0;this.Source=null;this.BucketId=this.Action=0;this.Description=null;this.NumberOfInstances=0}}Object(n.a)(ay,"Suggestion",null,[]);class bw{sGf(a){if(!a)return null;const b=[];for(const c of a)a=Object.assign(new ot,{TraceId:c.traceId,CategoryTitle:c.categoryTitle,ExplanationTitle:c.explanationTitle||
"",ExplanationLabel:c.explanationLabel||"",Explanation:c.explanation||"",TileId:c.tileId,RevisionId:c.revisionId,BucketId:c.bucketId,Status:c.status,Tag:c.tags?this.Bzi(c.tags):0,Start:c.start,Length:c.length,Priority:c.priority,TypeId:c.critiqueTypeId}),c.supportedActions&&(a.SupportedActions=this.hzi(c.supportedActions)),c.suggestions&&(a.Suggestions=this.Azi(c.suggestions)),b.push(a);return b}Azi(a){if(!a)return null;const b=[];for(const c of a)(a=this.yzi(c))&&b.push(a);return b}yzi(a){if(!a)return null;
const b=Object.assign(new ay,{BucketId:a.bucketId,Description:a.description,NumberOfInstances:a.numberOfInstances,Source:a.source,Text:a.text,Level:this.gzi(a.confidenceLevel)});a.actions&&(b.Action=this.zzi(a.actions));return b}gzi(a){return 1===a?0:2===a?1:2}zzi(a){let b=0;a.autoCorrect&&(b|=4);a.changeOnce&&(b|=1);a.changeAll&&(b|=2);a.readAloud&&(b|=8);return b}Bzi(a){return a.consistency?1:0}hzi(a){let b=0;a.addToDictionary&&(b|=16);a.deleteText&&(b|=1);a.ignore&&(b|=2);a.ignoreAll&&(b|=4);a.ignoreCritiqueType&&
(b|=8);a.showDetails&&(b|=32);return b}}Object(n.a)(bw,"CloudALResponseTransformer",null,[1278]);var $f=d(82),by=d(521);class cw{constructor(a,b,c,h,m,y,G,U,ja,va,Ta){this.Hva=a;this.Idb=b;this.vSg=c;this.ua=h;this.Jb=m;this.ia=y;this.jc=U;this.Xl=ja;this.Hh=va;this.Oc=G;this.eA=Ta;this.Hva.CBa(Object(F.a)(this,this.PIa,"onBeforeParagraphDisconnect"));this.Hva.ik(Object(F.a)(this,this.onParagraphPropertyChanged,"onParagraphPropertyChanged"));this.Oc.A8h(Object(F.a)(this,this.O3g,"onLanguageOnRangeChanged"));
this.Idb.CBa(Object(F.a)(this,this.y1g,"onBeforeNumberListDisconnect"));this.Idb.ik(Object(F.a)(this,this.onNumberListPropertyChanged,"onNumberListPropertyChanged"));this.vSg.FG(Object(F.a)(this,this.onShapeChildTopologyChanged,"onShapeChildTopologyChanged"))}isEnabled(a){const b=this.ua.Ba;if(!b||!b.isConnected)return!1;const c=Object.assign(new by.a,{slideId:b.Cb});this.ia.La(M.a.AZa,2,c);return 0<c.Rqc?(Ba.a.J(37025884,375,50,"{0}, current slide {1} is locked due to one more people are here. Skipping",
a,b.id),!1):!0}initialize(){this.oge(this.ua.Ba)}dispose(){this.Hva.ZJa(Object(F.a)(this,this.PIa,"onBeforeParagraphDisconnect"));this.Hva.Cm(Object(F.a)(this,this.onParagraphPropertyChanged,"onParagraphPropertyChanged"));this.Oc.rTk(Object(F.a)(this,this.O3g,"onLanguageOnRangeChanged"));this.Idb.ZJa(Object(F.a)(this,this.y1g,"onBeforeNumberListDisconnect"));this.Idb.Cm(Object(F.a)(this,this.onNumberListPropertyChanged,"onNumberListPropertyChanged"));this.vSg.ZO(Object(F.a)(this,this.onShapeChildTopologyChanged,
"onShapeChildTopologyChanged"))}PIa(a,b){this.etc(Object(ua.a)(Vb.AParagraphNode,b.node),!1)}onParagraphPropertyChanged(a,b){b.property!==kb.a.pq&&b.property!==jb.a.listLevel||this.etc(Object(ua.a)(Vb.AParagraphNode,b.node),!1)}O3g(a,b){this.etc(b.paragraphNode,!0)}y1g(a,b){b.node&&Object(za.a)($f.a,b.node)&&this.etc(this.eA.K6d(Object(ua.a)($f.a,b.node)),!0)}onNumberListPropertyChanged(a,b){b.node&&Object(za.a)($f.a,b.node)&&b.node.isConnected&&b.property===kb.a.Ri&&this.etc(this.eA.K6d(Object(ua.a)($f.a,
b.node)),!0)}onShapeChildTopologyChanged(a,b){if(a=Object(ua.a)(4,b.node))a=this.jc.mg(a),this.oge(a)}etc(a,b){!this.Hcl(a)||b&&this.hwj(a)||(a=Object(ua.a)(116,this.jc.mg(a)),this.oge(a))}oge(a){if(a&&a.isConnected&&a.isSlideCritiqueReady){var b=this.Jb.le(7,D.a.c3e);b.nc(a);a.isSlideCritiqueReady=!1;b.dispose()}}Hcl(a){return!!a&&a.isConnected&&this.Hh.Yd(a)&&!this.Xl.wka(a)&&!a.sa(X.a.xT,!1)}hwj(a){a=a.sa(kb.a.pq,"");return!a||!a.length}}Object(n.a)(cw,"ConsistencyCheckManager",null,[1251,106]);
var zm=d(159),Zp=d(520);class $p{constructor(){this.d=this.p=this.w=null}}Object(n.a)($p,"ProofingDashboardTraceMetrics",null,[]);class Ok{}Ok.Gle="bs";Ok.h0c="bd";Ok.LIh="was";Ok.MIh="wad";Ok.BRj="rm";Ok.vFl="wd";Ok.iEl="ad";Ok.LYk="rs";Object(n.a)(Ok,"TelemetryFieldNames",null,[]);class Dl{}Dl.cql="tcw";Dl.Krd="tcc";Dl.fmg="bs";Dl.UWj="bd";Dl.emg="bpc";Dl.tXg="md";Object(n.a)(Dl,"TelemetryValues",null,[]);class yr{constructor(){this.wn=this.i=null}}Object(n.a)(yr,"Workflow",null,[]);class Qq{constructor(a,
b,c,h,m,y,G,U,ja,va,Ta,fb){this.ua=a;this.FC=b;this.Dye=c;this.Jb=h;this.M5j=m;this.WPg=y;this.c$=G;this.Ea=U;this.Xl=ja;this.Ga=va;this.dpe=Ta;this.e$=fb}initialize(){this.c$.execute(a=>{a.addEventHandler(Zp.a.Lwf,Object(F.a)(this,this.kpj,"handleAugResults"));this.Ga.pptAugmentationLoopCloudALEnabled&&a.addEventHandler(Zp.a.pUd,Object(F.a)(this,this.Opj,"handleCloudALResults"))})}kpj(a,b,c,h){Ba.a.J(36962498,375,50,"Handle WAC AL results");if(b&&h&&b&&h){a=String.format("{0}, MarkStart:{1}",h.Telemetry,
(new Date).getTime().toString());var m=this.AXf(b.Content);c=this.v7i(h.Payload);if(m&&c){var y=!1;if(this.Ga.pptRegisterSingleProofingWorkflowEnabled||!this.Ga.pptAugmentationLoopCloudALEnabled||this.Ga.pptAugmentationLoopShadowCloudALEnabled)this.uXg(c.Critiques,m),y=!0;m=(new Date).getTime();if(h=this.e$.NYd(h.DashboardTelemetry))try{const G={};G[Ok.LYk]=c.ResponseStatus;G[Ok.BRj]=y;G[Ok.vFl]=m-h.d[Ok.Gle];G[Ok.iEl]=h.d[Ok.MIh]-h.d[Ok.LIh];h.d=G;h.p=Dl.tXg;this.e$.track(h)}catch(G){Ba.a.J(37487777,
375,15,"trace metrics exception {0}",G.message)}a=String.format("{0}, MarkDone:{1}",a,m.toString());Ba.a.J(36702229,375,50,"Marked: {0}, TileID: {1}, critique count: {2}, {3}",y,b.Id,c.Critiques?c.Critiques.length:0,a)}else Ba.a.J(36577357,375,10,c?"Aug slide is null":"Result is null")}}Opj(a,b,c,h){Ba.a.J(36962502,375,50,"Handle Cloud AL results");c=(new Date).getTime();if(b&&h&&b&&h){h.partialSuccess&&Ba.a.J(37057568,375,15,"Get partial success response");a=String.format("MarkStart:{0}",c.toString());
var m=this.AXf(b.Content);if(m){var y=!1;if(this.Ga.pptRegisterSingleProofingWorkflowEnabled||!this.Ga.pptAugmentationLoopShadowCloudALEnabled)y=this.dpe.sGf(h.critiques),this.uXg(y,m),y=!0;m=(new Date).getTime();c=Object.assign(new $p,{w:Object.assign(new yr,{wn:Dl.Krd,i:b.Id}),p:Dl.tXg,d:{["ms"]:c,["md"]:m,["rm"]:y,["rs"]:h.partialSuccess?1:0}});this.e$.track(c);a=String.format("{0}, MarkDone:{1}",a,m.toString());Ba.a.J(36783304,375,50,"Marked: {0}, Cloud AL tileID: {1}, critique count: {2}, {3}",
y,b.Id,h.critiques?h.critiques.length:0,a)}else Ba.a.J(36783302,375,10,"Aug slide is null")}}AXf(a){let b=null;try{b=dd.a(a)}catch(c){return Ba.a.J(36577355,375,10,"Try parse aug slide failed"),null}return b}v7i(a){let b=null;try{b=dd.a(a)}catch(c){return Ba.a.J(36525519,375,10,"ApplyEditorServiceResults - Try parse aug response failed {0}",c.message),null}if(!b)return Ba.a.J(38545173,375,15,"ApplyEditorServiceResults - Parsed response is null"),null;if(1!==b.ResponseStatus&&0!==b.ResponseStatus)return Ba.a.J(36525521,
375,15,"ApplyEditorServiceResults - Failed editor service call {0}",b.ResponseStatus),null;1===b.ResponseStatus&&Ba.a.J(37057603,375,15,"Get partial success response");return b}uXg(a,b){try{const G=this.ua.Ba;if(!this.fel(b,G)){var c=this.z2f(a,!1);if(c){var h=this.ua.Ba.Hia,m=new Qa.a,y=this.Jb.le(7,D.a.c3e);y.nc(G);for(const U of b.drawingElems)if(U.text&&U.text.paragraphs)for(const ja of U.text.paragraphs){const va=ja.id;m.add(va);const Ta=Object(ua.a)(Vb.AParagraphNode,h.ye(pa.a.Hf(va)));if(Ta&&
!Ta.sa(zm.a.Cda,!1)){if(this.Ga.pptEditorGrammarAndWritingStyleIsEnabled)if(va in c){const fb=Array.isArray(c[va])?c[va]:null;if(!fb||!fb.length||fb[0].RevisionId!==Ta.sa(zm.a.v0c,0).toString())continue;this.zfk(Ta,fb,this.rgj(ja.cfRuns))}else this.nSk(Ta);Ta.setValue(zm.a.Cda,!0)}}if(this.Ga.pptEditorConsistencyCheckIsEnabled){const U=String.format("Start:{0}",(new Date).getTime().toString());b=0;const ja=G.isSlideCritiqueReady;c=!1;if(!ja){const va=new Qa.a,Ta=this.z2f(a,!0);(c=this.$Vi(Ta,m,G,
va))&&(b=this.Wdi(Ta,m,G,va))}Ba.a.J(37298713,375,50,"{0}, End:{1}, IsReady:{2}, ShouldApply:{3}, Count:{4}",U,(new Date).getTime().toString(),ja,c,b)}G.setValue(zm.a.$fg,!0);y.dispose()}}}catch(G){Ba.a.J(36525523,375,10,"MarkEditorServiceResults failed {0}",G.message)}}rgj(a){const b=new xa.ScriptSharpLegacyMap;if(!a)return b;let c=0;for(const h of a)h.cf&&b.add(c,h.cf.lang),c+=h.len;return b}zfk(a,b,c){var h=this.FC.BF(a,y=>!!y.Gh);const m=[];for(const y of h)1===y.Gh.proofingType&&Array.add(m,
y);b=this.ZVi(a,b,m);h=this.YVi(b,h);this.FC.YJa(a,h);this.sXg(b,a,c);a.setValue(zm.a.Cda,!0)}nSk(a){const b=this.FC.BF(a,c=>!!c.Gh&&1!==c.Gh.proofingType);this.FC.YJa(a,b);a.setValue(zm.a.Cda,!0)}Wdi(a,b,c,h){const m=c.Hia,y=new Nd.a;let G=0;this.XXk(c);for(let ja in a){var U=a[ja];const va=Object(ua.a)(Vb.AParagraphNode,m.ye(pa.a.Hf(ja)));U=Array.isArray(U)?U:null;if(!(va&&va.isConnected&&U&&U.length))continue;const Ta=[];for(const fb of U)this.Xeg(fb)&&!h.contains(fb.BucketId)&&Ta.push(fb);0<Ta.length&&
(this.sXg(Ta,va),y.Hb(va.id.toString())||y.$(va.id.toString(),va),G+=Ta.length)}if(0<y.count)for(let ja of b)y.Hb(ja)&&(a=y.ga(ja))&&c.YKa.add(a);c.isSlideCritiqueReady=!0;return G}$Vi(a,b,c,h){var m=this.vdj(c);if(b.count!==m.count)return this.h1c(String.format("Topology changed from {0} to {1}",b.count,m.count)),!1;c=c.Hia;for(var y of b){if(!m.contains(y))return this.h1c("ParaId changed"),!1;b=Object(ua.a)(Vb.AParagraphNode,c.ye(pa.a.Hf(y)));if(!b||!b.isConnected)return this.h1c("Invalid ParaId"),
!1;if(!b.sa(zm.a.Cda,!1))return this.h1c("Para pending proofing"),!1}for(let G in a){y=a[G];m=Object(ua.a)(Vb.AParagraphNode,c.ye(pa.a.Hf(G)));y=Array.isArray(y)?y:null;if(!y||!y.length)continue;b=this.FC.BF(m,ja=>!!ja.Gh&&(1===ja.Gh.proofingType||2===ja.Gh.proofingType||3===ja.Gh.proofingType));const U=this.FC.BF(m,ja=>{ja=Object(ua.a)(287,ja.Gh);return!!ja&&5===ja.proofingType&&ja.wEa});m=this.Dye.sRc(m,!1,!0);for(const ja of y)if(this.Xeg(ja)){if(this.TXc(ja,b)||this.QJj(ja,y))h.add(ja.BucketId),
Ba.a.J(37298716,375,50,"Overlap critique: {0}",ja.BucketId);(this.TXc(ja,m)||this.TXc(ja,U))&&h.add(ja.BucketId)}}return!0}h1c(a){Ba.a.J(37298718,375,50,"Skip apply: {0}",a)}ZVi(a,b,c){const h=[];for(const m of b){if(this.awj(b,m)||a.characterData.length<m.Start+m.Length||this.TXc(m,c))continue;const y=Up.b(m);2!==y&&3!==y||h.push(m)}return h}YVi(a,b){const c=[];for(const h of b)this.Icl(a,h)||Array.add(c,h);return c}Icl(a,b){const c=b.Gh.proofingType;if(1===c)return!0;if(2===c||3===c)return!1;if(5===
c){for(const h of a)if(this.KZc(h.Start,h.Start+h.Length,b.begin,b.end))return!1;return!0}return!1}TXc(a,b){const c=a.Start;a=a.Start+a.Length;for(const h of b)if(this.KZc(c,a,h.begin,h.end))return!0;return!1}z2f(a,b){const c={};if(a)for(const h of a)if(0!==h.Priority||b)h.TileId in c?Array.add(c[h.TileId],h):c[h.TileId]=[h];return c}BSa(a,b){let c=0;for(let h of a)if(b>=h.key)c=h.value;else break;return c}sXg(a,b,c=null){if(a&&a.length&&b){var h={},m=[];for(const G of a){var y=G.Start;const U=y+
G.Length,ja=b.characterData.substring(y,U);a=this.M5j.create(G,this.WPg);a.token=ja;c&&(a.lcid=this.BSa(c,y));y=new ap(y,U,a);Array.add(m,y);a=1===a.proofingType?ym[a.proofingType]:a.typeId;h[a]=a in h?h[a]+1:1}this.FC.oqf(b,m);this.WPg.track(()=>Object.assign(new Lq.a,{E:2,C:this.zAi(b.characterData),F:h}))}}awj(a,b){const c=b.Start,h=b.Start+b.Length;for(const m of a)if(this.KZc(c,h,m.Start,m.Start+m.Length)&&Up.a(m)>Up.a(b))return!0;return!1}QJj(a,b){const c=a.Start,h=a.Start+a.Length;for(const m of b)if(m!==
a&&this.KZc(c,h,m.Start,m.Start+m.Length))return!0;return!1}KZc(a,b,c,h){return a>=c&&a<h||c>=a&&c<b}zAi(a){return rr.a.instance.A6f(a,0,a.length-1)}fel(a,b){return!a||!b||!b.isConnected||a.id!==b.id.toString()}Xeg(a){return!!a&&5===Up.b(a)}vdj(a){const b=new Qa.a;a=a?a.Pk():[];for(const c of a)this.Xl.iFa(c)||this.Ea.DJ(c,h=>{b.add(h.id.toString())});return b}XXk(a){for(let b of a.YKa){const c=b;if(c){const h=this.FC.BF(c,m=>{m=Object(ua.a)(287,m.Gh);return!!m&&5===m.proofingType&&!m.wEa});this.FC.YJa(c,
h)}}a.YKa.clear()}}Object(n.a)(Qq,"EditorServiceResultsManager",null,[]);class dw extends Wi.a{constructor(a,b,c,h,m,y=null){super(a,b,c,h,y);this.XF=m}get proofingType(){const a=super.proofingType;return this.XF.WTa||2!==a?a:1}}Object(n.a)(dw,"PPTEditorServiceErrorDetails",Wi.a,[]);class Cu{constructor(a,b,c){this.A8j=a;this.Cak=b;this.XF=c}create(a,b,c=null){return new dw(a,b,this.A8j,this.Cak,this.XF,c)}}Object(n.a)(Cu,"PPTEditorServiceErrorDetailsFactory",null,[1248]);class Du{constructor(a){this.Ga=
a}filter(a){if(a&&(!this.Ga.pptEditorConsistencyCheckIsEnabled||!this.Ga.pptEditorGrammarAndWritingStyleIsEnabled))for(let c=a.length-1;0<=c;--c){const h=a[c].CritiqueTypeInfoList;for(let m=h.length-1;0<=m;--m){var b=h[m];b=Up.c(b.CritiquePriority,b.CritiqueTag);this.Ga.pptEditorConsistencyCheckIsEnabled||5!==b||Array.removeAt(h,m);this.Ga.pptEditorGrammarAndWritingStyleIsEnabled||2!==b&&3!==b||Array.removeAt(h,m)}h.length||Array.removeAt(a,c)}}}Object(n.a)(Du,"PPTProofingCritiqueCategoryInfoFilter",
null,[1249]);class ew extends Ka.a{constructor(a,b){super(null);this.sHd=a;this.errorType=2;this.Ing=b}get proofingType(){return this.sHd}get suggestions(){return[]}JLa(){}}Object(n.a)(ew,"UnknownErrorDetails",Ka.a,[]);class Eu{constructor(a,b,c,h,m){this.H6e=this.E6e=null;this.MLd=this.aFd=0;this.byd=!1;this.Ii=a;this.aVb=b;this.Fz=c;this.Gm=h;this.$M=m;this.zwc=0}lfh(a,b,c){return{mch:a,J0g:b,I0g:c}}LDh(){}Dme(a,b,c,h,m,y,G,U){!y&&(c=!!c&&c[a],h=!!h&&h[a],b&&b[a]||c||h)&&(b=this.Ii.Ra.last.cp,y=
this.Ii.characterData.length,Array.add(G,new Bk.a(b,y)),(c||h)&&Array.add(U,new ap(b,y,new ew(this.$M.tle?m?m[a]:0:h?2:1,c?1:2))))}xzl(a,b){this.Fz.PPe(this.Ii,a);b&&this.Gm.eWk(this.Ii,b);this.lch()}lch(){this.aVb.IR(this.Ii)}B0k(a,b,c,h){this.Nmh(this.zwc,b,c,h);this.LRe(a,this.byd)}Nmh(a,b,c,h){b.add(1===a);c.add(2===a||3===a);h.add(this.$M.tle?a:0)}LRe(a,b){a.add(b)}FZj(a){let b,c,h,m;b=this.Ii.sa(kb.a.Kwa,null);c=this.Ii.sa(kb.a.dLa,null);h=this.Ii.sa(jb.a.Y9a,null);m=this.Ii.sa(jb.a.kZa,null);
this.Ii.wyb=this.Ii.sa(Ie.a.Mic,!1);({Kwa:b,dLa:c,Y9a:h,kZa:m}=this.oIh(b,c,h,m,a,"loading"));return{Kwa:b,dLa:c,Y9a:h,kZa:m}}NRe(a,b,c,h,m){({Kwa:a,dLa:b,Y9a:c,kZa:h}=this.oIh(a,b,c,h,m,"saving"));this.XTe(kb.a.Kwa,a);this.XTe(kb.a.dLa,b);this.XVe()&&this.XTe(jb.a.Y9a,c);this.L7k(jb.a.kZa,h);this.Ii.wyb?this.Ii.te(Ie.a.Mic,!0):this.Ii.removeProperty(Ie.a.Mic)}XVe(){return!0}XTe(a,b){b&&Array.contains(b,!0)?this.Ii.te(a,b):this.Ii.removeProperty(a)}L7k(a,b){!b||Ma.a.all(b,c=>0===c)?this.Ii.removeProperty(a):
this.Ii.te(a,b)}eti(a,b){(b=this.Ii.Ra.ga(b).formatting)?(a.formatting=b.$d(a),J.a.instance.ga(57)&&(this.Ii.Yu(),-1!==a.formatting.ng&&this.Ii.wordRunProperties.Uxb(b.ng,64))):(ba.ULS.shipAssertTag(18109325,324,!1,"There is a Chp that has spelling error, but its formatting object is null"),ec.a.instance.Wb("CloneFormattingObjectError",{["Reason"]:"There is a Chp that has spelling error, but its formatting object is null"}))}oIh(a,b,c,h,m,y){const G=ec.a.instance.Vp(D.a.ZCl);G.properties.$(de.a.source,
y);let U=!1;a&&a.length!==m&&(ba.ULS.sendTraceTag(18109326,324,10,"NotProofedRuns has inconstant length with expected. Length: [{0}], expected: [{1}], context:[{2}]",a.length,m,y),U=!0);b&&b.length!==m&&(ba.ULS.sendTraceTag(18109327,324,10,"SpellErrorRuns has inconstant length with expected: Length: [{0}], expected: [{1}], context:[{2}]",b.length,m,y),U=!0);this.XVe()&&c&&c.length!==m&&(ba.ULS.sendTraceTag(20784798,324,10,"GrammarErrorRuns has inconstant length with expected: Length: [{0}], expected: [{1}], context:[{2}]",
c.length,m,y),U=!0);h&&h.length!==m&&(ba.ULS.sendTraceTag(25274201,324,10,"ProofingErrorHints has inconstant length with expected: Length: [{0}], expected: [{1}], context:[{2}]",h.length,m,y),U=!0);if(U)for(h=c=b=null,a=[],y=0;y<m;y++)Array.add(a,!0);G.end();return{returnValue:!U,Kwa:a,dLa:b,Y9a:c,kZa:h}}m6g(){}REe(){this.zwc=0;this.E6e=this.Ii.G0||[];this.H6e=this.Ii.kOb||[];this.MLd=this.aFd=0;this.byd=!1}UEe(a,b){a.Up&&a.Up.Gh?this.zwc=a.Up.Gh.proofingType:a.yL&&(this.zwc=0);a=a.cp;b=b?b.cp:a;
this.byd=({sYe:this.aFd}=this.jfg(a,b,this.E6e,this.aFd)).returnValue||({sYe:this.MLd}=this.jfg(a,b,this.H6e,this.MLd)).returnValue}jfg(a,b,c,h){for(;h<c.length;){const m=c[h];if(m.end<=a)++h;else return{returnValue:b>m.begin,sYe:h}}return{returnValue:!1,sYe:h}}}Object(n.a)(Eu,"ProofingDataHandler",null,[1327]);var cy=d(505);class dy extends Eu{constructor(a,b,c,h,m,y,G,U,ja){super(a,b,c,h,U);this.Qzg=!1;this.mbc=null;this.nJ=m;this.ia=y;this.Ea=G;this.jc=ja;this.I2c=null}m6g(){this.nJ.Pul(this.Ii)}lfh(a,
b,c){this.Ii.vhe||(a=!1,c=this.Gm.BF(this.Ii));this.I2c=this.Gm.BF(this.Ii,h=>{h=Object(ua.a)(287,h.Gh);return!!h&&5===h.proofingType&&!h.wEa});return{mch:a,J0g:b,I0g:c}}LDh(a,b,c,h,m){const y=Object(ua.a)(116,this.jc.mg(this.Ii));this.Ii&&y&&y.isConnected&&y.isSlideCritiqueReady&&ta.a.dQd(this.Ii.characterData,b)&&this.I2c&&0<this.I2c.length&&(Array.addRange(m,this.I2c),m.sort((G,U)=>G.end-U.end));if(!a&&c&&0<c.length&&ta.a.dQd(this.Ii.characterData,b)&&h&&0<h.length){for(const G of c)this.kjg(G,
h)&&!this.kjg(G,m)&&Array.add(m,G);m.sort((G,U)=>G.end-U.end)}}kjg(a,b){a=Ak.c([a],b);return!Ma.a.Wa(a)&&Ma.a.any(a,c=>c.begin<c.end)}lch(){this.nJ.TQj(this.Ii)&&this.aVb.IR(this.Ii)}XVe(){return!1}LRe(a,b){this.Qzg=!0;super.LRe(a,b);b&&(this.Ii.te(zm.a.Cda,!1),this.Ii.te(zm.a.v0c,(new Date).getTime()))}Nmh(a,b){this.mbc||(this.mbc=this.Gm.BF(this.Ii));b.add(1===a)}REe(){super.REe();this.mbc=null}Dme(a,b,c,h,m,y,G,U){y||(b=!!b&&b[a],a=!!c&&c[a],c=this.Ii.Ra.ga(this.Ii.Ra.length-1),b?(Array.add(G,
new Bk.a(c.cp,this.Ii.characterData.length)),this.A0k()):(b=this.e3i(c.cp,this.Ii.characterData.length,this.Ii.characterData,ja=>{ja=ja.Gh.proofingType;return 2===ja||3===ja}))&&0<b.length&&Array.addRange(U,b),a&&(Array.add(G,new Bk.a(c.cp,this.Ii.characterData.length)),Array.add(U,new ap(c.cp,this.Ii.characterData.length,new ew(1,1)))))}NRe(a,b,c,h,m){this.Qzg||this.Uwj()||Ba.a.J.apply(null,[37368030,375,50,"notProofedRuns:{0}, spellErrorRuns:{1}, grammarErrorRuns:{2}",a,b].concat(c));super.NRe(a,
b,c,null,m)}Uwj(){if(!this.Ii)return Ba.a.J(37368032,375,10,"ParagraphNode is null"),!1;var a=this.Ea.Zm(this.Ii);if(!a)return Ba.a.J(37368034,375,10,"ShapeNode is null"),!1;a=new cy.a(a,Fc.App.Um);this.ia.La(M.a.zhb,2,a);return a.$ta}A0k(){const a=new t.GraphTransaction(4);a.kd(this.Ii);this.Ii.te(zm.a.Cda,!1);this.Ii.te(zm.a.v0c,(new Date).getTime());a.dispose()}e3i(a,b,c,h){const m=[];if(this.mbc)for(const y of this.mbc){const G=Object(ua.a)(ap,y);G&&G.Gh&&G.Gh.token===c.substring(G.begin,G.end)&&
G.end>a&&G.end<=b&&h(G)&&Array.add(m,G)}return m}}Object(n.a)(dy,"PPTProofingDataHandler",Eu,[]);class ey{constructor(a,b,c,h,m,y,G,U){this.f$=a;this.f$j=b;this.FC=c;this.nJ=h;this.XF=G;this.ia=m;this.jc=U;this.Ea=y}nEi(a){return new dy(a,this.f$,this.f$j,this.FC,this.nJ,this.ia,this.Ea,this.XF,this.jc)}}Object(n.a)(ey,"PPTProofingDataHandlerFactory",null,[1252]);class Fu{constructor(a,b){this.c$=a;this.vqg=b}initialize(){this.c$.execute(a=>{if(this.vqg)for(const b of this.vqg)this.OQk(a,b)})}OQk(a,
b){a.registerSimpleRemoteWorkflow(b.nG,b.Frb,b.pJb,b.Pqb)}}Object(n.a)(Fu,"ProofingAugLoopRuntimeManager",null,[]);class Gu{constructor(a,b,c,h,m,y,G,U,ja,va,Ta,fb,Db,gc,hc,Gc,Pc,yc){this.Ea=a;this.Xl=b;this.jc=c;this.Ll=h;this.Jb=m;this.Pb=y;this.Rk=G;this.ua=U;this.f$=ja;this.FC=va;this.vi=fb;this.Hh=Db;this.vma=gc;this.zb=hc;this.qd=Pc;this.oLg=yc;this.QXa=new Qa.a;this.Rk.wai(Object(F.a)(this,this.O6g,"onUndoRevisionStateChanged"));this.fU=Ta.Ad(12);this.fU.ik(Object(F.a)(this,this.onParagraphPropertyChanged,
"onParagraphPropertyChanged"));this.cM=Ta.Ad(10);this.cM.FG(Object(F.a)(this,this.H5g,"onShapeTopologyChanged"));this.gbk=new He.a(3,1,0,Object(F.a)(this,this.resumeProofingAfterUndo,"resumeProofingAfterUndo"),90,"14");this.Ggc=this.VGa=!1;this.qd.$V(Object(F.a)(this,this.onActiveSlideDomReady,"onActiveSlideDomReady"))}dispose(){this.Rk.lVk(Object(F.a)(this,this.O6g,"onUndoRevisionStateChanged"));this.fU.Cm(Object(F.a)(this,this.onParagraphPropertyChanged,"onParagraphPropertyChanged"));this.cM.ZO(Object(F.a)(this,
this.H5g,"onShapeTopologyChanged"));this.qd.Una(Object(F.a)(this,this.onActiveSlideDomReady,"onActiveSlideDomReady"))}rpc(a,b){this.Ea.DJ(a,c=>{this.hqh(c,b)})}iqh(a,b){this.Xl.Glc(a,c=>{this.hqh(c,b)})}Mzl(a,b){b?this.Ea.DJ(a,c=>{c&&this.FC.JTd(c)}):this.Ea.DJ(a,c=>{c&&(c.dYb=!0)})}MDh(a){if(a&&a.isConnected&&!a.$p){var b=this.Jb.le(4);try{let c=!1;const h=this.Pb.Nc(a);b.nc(h);const m=this.Ll.Xra(a);for(;m.moveNext();){const y=m.currentNode;this.udl(y)&&(c=!0,y.Ped(),y.Ulc=!0)}c&&this.AXg(a)}finally{b&&
b.dispose()}this.vi.forceOutbound()}}Pul(a){if(this.gua(a)&&a.dYb)if(this.Ggc&&!this.QXa.contains(a))this.QXa.add(a);else{var b=this.Jb.le(4);try{b.nc(a),a.Ped(),a.Ulc=!0,this.Afk(a)}finally{b&&b.dispose()}a.dYb=!1}}zhd(a){this.gua(a)&&this.Ea.DJ(a,b=>{this.f$.IR(b)})}dGk(a){this.gua(a)&&this.Xl.Glc(a,b=>{this.f$.IR(b)})}TQj(a){return this.gua(a)&&(this.VQj(a)||this.UQj(a))}AXg(a){a&&a.isConnected&&this.Ea.wFa(a)&&this.sqh(a)}Afk(a){const b=this.Ea.Zm(a);this.AXg(b);this.Xl.wka(a)&&(a=this.Xl.Awb(a))&&
a.isConnected&&this.Xl.iFa(a)&&this.sqh(a)}O6g(a,b){if(b)switch(b.state){case 0:this.Ggc=!0;break;case 3:this.Ggc=!1,this.VGa||(this.zb.Eb(this.gbk),this.VGa=!0)}}udl(a){return this.gua(a)?a.sa(kb.a.Kwa,null)?!0:a.sa(kb.a.dLa,null)?!0:!1:!1}onParagraphPropertyChanged(a,b){this.Ggc&&b&&b.node&&(12!==b.node.type||this.QXa.contains(b.node)||this.QXa.add(b.node))}H5g(a,b){this.Ggc&&b&&b.node&&(10!==b.node.type||this.QXa.contains(b.node)||this.QXa.add(b.node))}resumeProofingAfterUndo(){this.VGa=!1;for(let b of this.QXa)if(this.gua(b))if(this.Ea.wFa(b)){var a=
b;a&&(this.rpc(a,!0),this.zhd(a))}else this.Hh.Yd(b)&&(a=b)&&(a.dYb=!0,this.f$.IR(a));this.QXa.clear()}hqh(a,b){a&&(a.dYb=b&&a.G0&&0<a.G0.length?!0:!1)}VQj(a){if(this.oLg){const b=this.ua.Ba;if(!this.gua(b))return!1;a=this.Ea.Xca(a);return this.jc.mg(a)===b}return this.vma.tJj(a)}UQj(a){var b=this.ua.Ba;if(!this.gua(b))return!1;a=this.Xl.Awb(a);b=b.GSa();return this.gua(a)&&this.gua(b)&&pa.a.SP(a.id,b.id)}sqh(a){a.setValue(X.a.Ahd,a.sa(X.a.Ahd,0)+1)}gua(a){return!!a&&a.isConnected}onActiveSlideDomReady(){if(this.oLg){var a=
this.ua.Ba;if(a&&(a=a.Pk())&&0<a.length)for(const b of a)this.Ea.XA(b)&&this.zhd(b)}}}Object(n.a)(Gu,"ProofingBehaviorController",null,[1253,106]);class ns extends Hq.a{constructor(a,b,c,h,m,y=!0,G=!1,U=50){super(a,b,c,h,m,y);this.U8j=G;this.GEg=U}qoh(a){a=Array.isArray(a)?a:null;if(!Ma.a.Wa(a))if(a.length<=this.GEg)this.logTrace(a);else{const b=[];for(const c of a)Array.add(b,c),b.length===this.GEg&&(this.logTrace(b),Array.clear(b));0<b.length&&this.logTrace(b)}}logTrace(a){a&&Ba.a.J(37325012,375,
this.U8j?15:50,"{0}",lh.c(a))}}Object(n.a)(ns,"DashboardAggregator",Hq.a,[]);class fw{constructor(a){this.e$=new ns(new sb.a(()=>u.AFrameworkApplication.we),u.AFrameworkApplication.cga,15,a.pptProofingDashboardTraceIntervalInMinutes,new Go,!0,a.pptProofingDashboardTraceAsMonitorableEnabled,a.pptProofingDashboardMaxCountInEachLog)}track(a){this.e$.track(a,"")}NYd(a){let b=null;try{b=dd.a(a)}catch(c){Ba.a.J(37325010,375,15,"Try parse dashboardTelemetry failed")}return b}}Object(n.a)(fw,"ProofingDashboardAggregator",
null,[1250]);class gw{track(){}NYd(){return null}}Object(n.a)(gw,"ProofingDashboardNonOperationAggregator",null,[1250]);var hw=d(437),pt=d(436);class aq{constructor(a){this.abk=a}Gx(a,b,c){this.abk(b,c);return!0}}Object(n.a)(aq,"NonOpProofingALRequestManager",null,[1325]);class Hu{constructor(a,b,c){this.t0=this.R_=null;this.gBe=a;this.Fbc=b.pptEditorConsistencyCheckIsEnabled;this.Iwe=b.pptProofingLogWorkflowExceptionEnabled;this.e$=c;this.Cye=new aq(Object(F.a)(this,this.eQe,"requestAL"))}get nG(){return"ProofingTileCheckCloudALWorkflow"}get proto(){return""}get Frb(){this.R_||
(this.R_=Object.assign(new pt.a,{name:"LambdaBefore_ProofingTileCheckCloudAL",inputSchema:hw.a.Sqc,outputSchema:Zp.a.gEf,func:Object(F.a)(this,this.hbb,"lambdaBeforeFunc")}));return this.R_}get Pqb(){return null}get pJb(){this.t0||(this.t0=Object.assign(new pt.a,{name:"LambdaRemote_ProofingTileCheckCloudAL",inputSchema:Zp.a.gEf,outputSchema:Zp.a.pUd,func:null}));return this.t0}eQe(a,b){b(a)}hbb(a,b,c){try{Ba.a.J(36962511,375,50,"{0}:LambdaBeforeStart",this.nG);const G=Object.assign(new $p,{d:{["bs"]:(new Date).getTime()},
w:Object.assign(new yr,{wn:Dl.Krd})});this.e$.track(Object.assign(new $p,{w:Object.assign(new yr,{wn:Dl.Krd}),p:Dl.fmg}));let U=String.format("LambdaBeforeStart:{0}",G.d[Ok.Gle].toString());if(a){G.w.i=a.Id;try{var h=dd.a(a.Content)}catch(ja){Ba.a.J(36763234,375,10,"Try parse tile response failed");c(null);return}if(h){var m=h.isSlideCritiqueReady;b=!1;var y=({pFa:b}=this.gBe.Pil(h)).returnValue;y?b&&(!this.Fbc||this.Fbc&&m)?(c(null),this.e$.track(Object.assign(new $p,{w:Object.assign(new yr,{wn:Dl.Krd}),
p:Dl.emg})),Ba.a.J(36962520,375,50,"{0}:LambdaBeforeDone,{1},isProofingClean:{2},isSlideCritiqueReady:{3}",this.nG,a.Id,b,m)):(G.d[Ok.h0c]=(new Date).getTime(),G.p=Dl.UWj,U=String.format("TileId:{0}, {1}, LambdaBeforeDone:{2}",a.Id,U,G.d[Ok.h0c].toString()),this.e$.track(G),Ba.a.J(36783312,375,50,U),this.Cye.Gx(h.id,y,c)):(c(null),Ba.a.J(36962518,375,50,"{0}:LambdaBeforeDone,RequestNull,{1}",this.nG,a.Id))}else c(null)}else c(null),Ba.a.J(36962513,375,50,"{0}:LambdaBeforeDone,InputNull",this.nG)}catch(G){a=
"CloudAL LambdaBefore Exception",this.Iwe&&(a=String.format("CloudAL LambdaBefore Exception Message: {0}, Stack: {1}",G.message,G.stack)),Ba.a.J(37835201,375,10,a),c(null)}}}Object(n.a)(Hu,"ProofingTileCheckCloudALWorkflow",null,[981,1274]);class iw{}Object(n.a)(iw,"AugEditorServiceTileCheckRequest",null,[]);class jw{constructor(){this.contextId=this.i0c=null}}Object(n.a)(jw,"RequestStateObject",null,[]);class Iu{constructor(a,b,c,h){this.bbk=0;this.t0=this.R_=null;this.gBe=a;this.MT=b;this.Fbc=c.pptEditorConsistencyCheckIsEnabled;
this.Iwe=c.pptProofingLogWorkflowExceptionEnabled;this.e$=h;this.Cye=new aq(Object(F.a)(this,this.eQe,"requestAL"))}get nG(){return"ProofingTileCheckWacALWorkflow"}get proto(){return'syntax="proto3";message AugEditorServiceTileCheckRequest { string Topic = 1; string Data = 2; string ContextId = 3; string Telemetry = 4; string DashboardTelemetry = 5; };message AugEditorServiceTileCheckResponse { string  Topic = 1; string Payload = 2; string AppId = 3; string SessionId = 4; string ContextId = 5; string Telemetry = 6; string DashboardTelemetry = 7; }; '}get Frb(){this.R_||
(this.R_=Object.assign(new pt.a,{name:"LambdaBefore_ProofingTileCheckWacAL",inputSchema:hw.a.Sqc,outputSchema:Zp.a.Kwf,func:Object(F.a)(this,this.hbb,"lambdaBeforeFunc")}));return this.R_}get Pqb(){return null}get pJb(){this.t0||(this.t0=Object.assign(new pt.a,{name:"LambdaRemote_ProofingTileCheckWacAL",inputSchema:Zp.a.Kwf,outputSchema:Zp.a.Lwf,func:Object(F.a)(this,this.Hle,"lambdaRemoteFunc")}));return this.t0}eQe(a,b){if(b){var c=this.e$.NYd(a.DashboardTelemetry);c&&(c.d[Ok.LIh]=(new Date).getTime());
var h=String.format("{0}, LambdaRemoteStart:{1}",a.Telemetry,(new Date).getTime());this.MT.execute(m=>{h=String.format("{0}, RequestWacALStart:{1}",h,(new Date).getTime().toString());m.Xnc(a.Topic,a.Data,a.ContextId,y=>{this.eKa(y,h,c)},y=>{this.cKa(y,h)},Object.assign(new jw,{contextId:a.ContextId,i0c:b}))})}}hbb(a,b,c){try{Ba.a.J(36962523,375,50,"{0}:LambdaBeforeStart",this.nG);const G=Object.assign(new $p,{d:{["bs"]:(new Date).getTime()},w:Object.assign(new yr,{wn:Dl.cql})});let U=String.format("LambdaBeforeStart:{0}",
G.d[Ok.Gle].toString());this.e$.track(Object.assign(new $p,{w:G.w,p:Dl.fmg}));if(a){try{var h=dd.a(a.Content)}catch(ja){c(null);Ba.a.J(36525525,375,10,"Try parse tile response failed");return}if(h){var m=h.isSlideCritiqueReady;b=!1;var y=({pFa:b}=this.gBe.Qil(h,++this.bbk)).returnValue;y?b&&(!this.Fbc||this.Fbc&&m)?(c(null),this.e$.track(Object.assign(new $p,{w:G.w,p:Dl.emg})),Ba.a.J(36962560,375,50,"{0}:LambdaBeforeDone,{1},isProofingClean:{2},isSlideCritiqueReady:{3}",this.nG,a.Id,b,m)):(G.d[Ok.h0c]=
(new Date).getTime(),U=String.format("{0}, LambdaBeforeDone:{1}",U,G.d[Ok.h0c].toString()),c(Object.assign(new iw,{Topic:Zp.a.TOi,Data:dd.c(y),ContextId:h.id,Telemetry:U,DashboardTelemetry:lh.c(G)})),Ba.a.J(36962562,375,50,"{0}:LambdaBeforeDone,{1}",this.nG,a.Id)):(c(null),Ba.a.J(36962530,375,50,"{0}:LambdaBeforeDone,RequestNull{1},",this.nG,a.Id))}else c(null)}else c(null),Ba.a.J(36962525,375,50,"{0}:LambdaBeforeDone,InputNull",this.nG)}catch(G){a="WACAL LambdaBefore Exception",this.Iwe&&(a=String.format("WACAL LambdaBefore Exception Message: {0}, Stack: {1}",
G.message,G.stack)),Ba.a.J(37835210,375,10,a),c(null)}}Hle(a,b,c){Ba.a.J(36962564,375,50,"{0}:LambdaRemoteStart",this.nG);a?this.Cye.Gx(a.ContextId,a,c):(c(null),Ba.a.J(36962566,375,50,"{0}:LambdaRemoteDone,InputNull",this.nG))}eKa(a,b,c){if(!u.AFrameworkApplication.Tg&&a&&a.data){var h=(new Date).getTime(),m=a.data.state;if(m){try{var y=dd.a(a.data.Zd)}catch(G){m.i0c(null);Ba.a.J(36525527,375,10,"Try parse aug response failed:{0}",G.message);return}y&&(y.Telemetry=String.format("{0}, LambdaRemoteDoneAndSucceed:{1}",
b,h.toString()),c&&(c.d[Ok.MIh]=h,y.DashboardTelemetry=lh.c(c)));m.i0c(y);Ba.a.J(36962571,375,50,"{0}:LambdaRemoteDone,Succeeded",this.nG)}}}cKa(a,b){!u.AFrameworkApplication.Tg&&a&&a.data&&(b=String.format("{0}, LambdaRemoteDoneAndFailed: {1}",b,(new Date).getTime().toString()),Ba.a.J(36525529,375,10,"Tile check request failed with: {0}, time: {1}",a.data.Zd,b),(a=a.data.state)&&a.i0c(null))}}Object(n.a)(Iu,"ProofingTileCheckWacALWorkflow",null,[981,1274]);class Ju{constructor(){this.groupType=0}}
Object(n.a)(Ju,"AnalyzerData",null,[]);class qt{constructor(){this.nodes=this.metadata=null}}Object(n.a)(qt,"TopologyNode",null,[]);class kw{constructor(){this.TileElements=this.AnalyzerData=this.RevisionId=this.TileId=null}}Object(n.a)(kw,"Content",null,[]);class lw{constructor(){this.value=this.typeName=this.name=this.languageId=this.id=null}}Object(n.a)(lw,"CritiqueTypeOption",null,[]);class mw{constructor(){this.isCompliant=!1;this.licenseType=0}}Object(n.a)(mw,"Descriptors",null,[]);class sj{constructor(){this.AppId=
this.SessionId=null;this.RequestOrderInSession=0;this.OverriddenCritiqueTypeOptions=this.Descriptors=this.Topology=this.Content=this.LanguageUxId=null}}Object(n.a)(sj,"EditorServiceTileCheckRequest",null,[]);class Ko{constructor(){this.indentationLevel=this.listLevel=this.listType=0;this.listTag=null;this.listElementIndex=this.listNumeration=0}}Object(n.a)(Ko,"ListMetadata",null,[]);var rt;(function(a){a[a.Undefined=0]="Undefined";a[a.AlphaLcParenBoth=1]="AlphaLcParenBoth";a[a.AlphaUcParenBoth=2]=
"AlphaUcParenBoth";a[a.AlphaLcParenR=3]="AlphaLcParenR";a[a.AlphaUcParenR=4]="AlphaUcParenR";a[a.AlphaLcPeriod=5]="AlphaLcPeriod";a[a.AlphaUcPeriod=6]="AlphaUcPeriod";a[a.ArabicParenBoth=7]="ArabicParenBoth";a[a.ArabicParenR=8]="ArabicParenR";a[a.ArabicPeriod=9]="ArabicPeriod";a[a.ArabicPlain=10]="ArabicPlain";a[a.RomanLcParenBoth=11]="RomanLcParenBoth";a[a.RomanUcParenBoth=12]="RomanUcParenBoth";a[a.RomanLcParenR=13]="RomanLcParenR";a[a.RomanUcParenR=14]="RomanUcParenR";a[a.RomanLcPeriod=15]="RomanLcPeriod";
a[a.RomanUcPeriod=16]="RomanUcPeriod";a[a.CircleNumDbPlain=17]="CircleNumDbPlain";a[a.CircleNumWdBlackPlain=18]="CircleNumWdBlackPlain";a[a.CircleNumWdWhitePlain=19]="CircleNumWdWhitePlain";a[a.ArabicDbPeriod=20]="ArabicDbPeriod";a[a.ArabicDbPlain=21]="ArabicDbPlain";a[a.Ea1ChsPeriod=22]="Ea1ChsPeriod";a[a.Ea1ChsPlain=23]="Ea1ChsPlain";a[a.Ea1ChtPeriod=24]="Ea1ChtPeriod";a[a.Ea1ChtPlain=25]="Ea1ChtPlain";a[a.Ea1JpnChsDbPeriod=26]="Ea1JpnChsDbPeriod";a[a.Ea1JpnKorPlain=27]="Ea1JpnKorPlain";a[a.Ea1JpnKorPeriod=
28]="Ea1JpnKorPeriod";a[a.Arabic1Minus=29]="Arabic1Minus";a[a.Arabic2Minus=30]="Arabic2Minus";a[a.Hebrew2Minus=31]="Hebrew2Minus";a[a.ThaiAlphaPeriod=32]="ThaiAlphaPeriod";a[a.ThaiAlphaParenR=33]="ThaiAlphaParenR";a[a.ThaiAlphaParenBoth=34]="ThaiAlphaParenBoth";a[a.ThaiNumPeriod=35]="ThaiNumPeriod";a[a.ThaiNumParenR=36]="ThaiNumParenR";a[a.ThaiNumParenBoth=37]="ThaiNumParenBoth";a[a.HindiAlphaPeriod=38]="HindiAlphaPeriod";a[a.HindiNumPeriod=39]="HindiNumPeriod";a[a.HindiNumParenR=40]="HindiNumParenR"})(rt||
(rt={}));Object(n.b)("ListNumeration",rt);var os;(function(a){a[a.Undefined=0]="Undefined";a[a.Bullet=1]="Bullet";a[a.Numbered=2]="Numbered"})(os||(os={}));Object(n.b)("ListType",os);class Ku{constructor(){this.tileContextDictionary=this.readingOrderTopology=this.tiles=this.overriddenCritiqueTypeOptions=this.languageUxId=this.documentSessionId=this.documentId=this.descriptors=null}}Object(n.a)(Ku,"ProofingRequest",null,[]);class st{constructor(){this.Id=null;this.Type=0;this.NumberOfChildren=this.Children=
this.AnalyzerData=null;this.AreChildrenOrdered=!1}}Object(n.a)(st,"TopologyNode",null,[]);class dp{constructor(){this.nodes=null}}Object(n.a)(dp,"ReadingOrderTopology",null,[]);class nw{constructor(){this.Length=this.Start=0;this.LanguageId=null;this.DoNotCheck=!1}}Object(n.a)(nw,"Span",null,[]);class ow{constructor(){this.elements=this.metadata=null;this.subType=0}}Object(n.a)(ow,"TextTile",null,[]);class pw{constructor(){this.text=null;this.textUnit=0;this.spans=this.listMetadata=this.languageId=
null;this.isClean=!1}}Object(n.a)(pw,"TextTileElement",null,[]);class qw{constructor(){this.doNotProcess=!1;this.languageId=null;this.start=this.length=0}}Object(n.a)(qw,"TextTileElementSpan",null,[]);class tt{constructor(){this.analyzerData=null;this.numberOfChildrenOnClient=0}}Object(n.a)(tt,"TileContext",null,[]);class rw{constructor(){this.AnalyzerData=this.Text=null;this.TextUnit=0;this.LanguageId=null;this.IsClean=!1;this.Spans=null}}Object(n.a)(rw,"TileElement",null,[]);class zr{constructor(){this.tileId=
this.revisionId=null;this.tileType=0}}Object(n.a)(zr,"TileMetadata",null,[]);class ut{constructor(a,b,c,h,m,y){this.UPg=a;this.P2c=b;this.TPg=c;this.XF=h;this.Ga=m;this.qc=y;this.g3c=null}get qkg(){return u.AFrameworkApplication.fa.ka("IsSubscriptionForProofingUser")&&this.XF.WTa}get descriptors(){this.g3c||(this.g3c=this.J6i(),Ba.a.J(37090579,375,50,"Descriptors: {0}",dd.c(this.g3c)));return this.g3c}Qil(a,b){let c;c=!0;var h=Fa.a.ue(u.AFrameworkApplication.lcid);if(!h)return{returnValue:null,pFa:c};
var m=new st,y=new st;b=Object.assign(new sj,{Descriptors:this.descriptors,AppId:"powerPoint_Online",LanguageUxId:h.name,RequestOrderInSession:b,SessionId:u.AFrameworkApplication.userSessionId,Content:[],Topology:m,OverriddenCritiqueTypeOptions:this.P2c.T4d()});this.Ga.powerPointTopologyAndListInfoInSlideTileIsEnabled&&(m.Id=Eh.a.S0b(u.AFrameworkApplication.fa.Ha("ServerDocId")).toString(),m.Type=4,m.AnalyzerData=null,m.Children=[],m.NumberOfChildren=this.qc.Lj(),m.AreChildrenOrdered=!1,y.Id=a.id,
y.Type=3,y.AnalyzerData=null,y.Children=[],y.NumberOfChildren=null,y.AreChildrenOrdered=!0,Array.add(m.Children,y));for(var G of a.drawingElems)if(this.Ga.powerPointTopologyAndListInfoInSlideTileIsEnabled&&Array.add(y.Children,this.Yrl(G)),G.text&&G.text.paragraphs)for(const ja of G.text.paragraphs){if(null===ja.chars||!ja.cfRuns||!ja.cfRuns.length)continue;a=new kw;a.TileId=ja.id;a.TileElements=[];m=new rw;m.Text=ja.chars;m.TextUnit=8;if(ja.pfRuns&&ja.pfRuns.length&&ja.pfRuns[0].pf){h=ja.pfRuns[0].pf;
m.AnalyzerData={};if(this.Ga.powerPointTopologyAndListInfoInSlideTileIsEnabled)if(16!==h.listType){m.AnalyzerData.ListLevel=h.lvl;var U=os[this.E4d(h.listType)];1===h.listType?(m.AnalyzerData.ListType=U,m.AnalyzerData.ListTag=h.listTag):0===h.listType&&(m.AnalyzerData.ListType=U,m.AnalyzerData.ListNumeration=rt[this.EYf(h.listNumeration)],m.AnalyzerData.ListElementIndex=h.listElementIndex)}else m.AnalyzerData.IndentLevel=h.lvl;else m.AnalyzerData.ListLevel=h.lvl;m.IsClean=!h.proofingDirty;a.RevisionId=
h.revisionId}c=c&&m.IsClean;U=0;const va=[];let Ta=null;for(const fb of ja.cfRuns)if(fb)if(h=Fa.a.ue(fb.cf.lang)){this.TPg.Rgd(fb.cf.lang);h=Object.assign(new nw,{Start:U,Length:fb.len,LanguageId:h.name,DoNotCheck:fb.cf.noProof});Ta||(Ta=h.LanguageId);if(Ta!==h.LanguageId||fb.cf.noProof)0<=h.Start&&0<h.Length&&h.Start+h.Length<=m.Text.length?va.push(h):(h.Length||h.Start!==m.Text.length)&&Ba.a.J(36823815,375,10,"Invalid span, start: {0}, length: {1}, paragraph length: {2}",h.Start,h.Length,m.Text.length);
U+=fb.len}else U+=fb.len;!m.IsClean&&0<va.length&&(m.Spans=Array.clone(va));m.LanguageId=Ta;ta.a.Wa(m.LanguageId)?Ba.a.J(38385410,375,15,"Empty LanguageId, span length {0}",va.length):(a.TileElements.push(m),b.Content.push(a))}for(y=b.Content.length-1;0<=y;y--)G=b.Content[y],G.TileElements.length&&null!==G.TileElements[0].Text||(Ba.a.J(37091085,375,50,"Empty TileElements or empty text in tile {0}",G.TileId),Array.removeAt(b.Content,y));b.Content.length||Ba.a.J(37091087,375,50,"Empty tiles");return{returnValue:b,
pFa:c}}Yrl(a){const b=Object.assign(new st,{Id:a.id,Type:2,AnalyzerData:{},Children:[],NumberOfChildren:a.text.paragraphs.length,AreChildrenOrdered:!0});b.AnalyzerData.GroupType=a.mk.type;for(const c of a.text.paragraphs)a=Object.assign(new st,{Id:c.id,Type:1,NumberOfChildren:null,AreChildrenOrdered:!1}),Array.add(b.Children,a);return b}Pil(a){let b;b=!0;var c=Fa.a.ue(u.AFrameworkApplication.lcid);if(!c)return{returnValue:null,pFa:b};var h={};c=Object.assign(new Ku,{descriptors:this.Y3i(this.descriptors),
languageUxId:c.name,documentSessionId:u.AFrameworkApplication.userSessionId,tiles:[],overriddenCritiqueTypeOptions:this.X3i(this.P2c.T4d()),tileContextDictionary:h,documentId:Eh.a.S0b(u.AFrameworkApplication.fa.Ha("ServerDocId")).toString(),readingOrderTopology:Object.assign(new dp,{nodes:[]})});const m=this.G6h(a,c.readingOrderTopology,h);for(var y of a.drawingElems)if(y.text&&y.text.paragraphs){a=this.a5h(y,m,h);for(const G of y.text.paragraphs)({pFa:b}=this.c7h(c.tiles,G,b)),this.Q5h(G,a,h)}for(h=
c.tiles.length-1;0<=h;h--)y=c.tiles[h],y.elements.length&&null!==y.elements[0].text||(Ba.a.J(37091090,375,50,"Empty TileElements or empty text in tile {0}",y.metadata?y.metadata.tileId:""),Array.removeAt(c.tiles,h));c.tiles.length||Ba.a.J(37091092,375,50,"Empty tiles");return{returnValue:c,pFa:b}}J6i(){if(!this.UPg.descriptors)return null;const a=Array.clone(this.UPg.descriptors);for(const b of a)if(this.qkg&&"licensetype"===b.Name.toLowerCase())return b.Value="Subscription",a;this.qkg&&Array.add(a,
Object.assign(new $m,{Name:"LicenseType",Value:"Subscription"}));return a}Y3i(a){const b=new mw;for(const c of a)"iscompliant"===c.Name.toLowerCase()&&(b.isCompliant="true"===c.Value.toLowerCase()),"licensetype"===c.Name.toLowerCase()&&(b.licenseType="subscription"===c.Value.toLowerCase()?2:0);return b}E4d(a){switch(a){case 0:return 2;case 1:return 1;default:return 0}}X3i(a){const b=[];for(const c of a)a=Object.assign(new lw,{id:c.Id,languageId:c.LanguageId,value:c.Value}),b.push(a);return b}EYf(a){return a+
1}Z3i(a){switch(a){case 0:return 0;case 1:return 1;case 2:return 2;case 3:return 3;case 4:return 4;case 5:return 5;default:return 0}}c7h(a,b,c){if(null===b.chars||!b.cfRuns||!b.cfRuns.length)return{returnValue:null,pFa:c};const h=new ow;h.metadata=new zr;h.metadata.tileId=b.id;h.metadata.tileType=1;h.elements=[];const m=new pw;m.text=b.chars;m.textUnit=4;m.listMetadata=new Ko;var y=m.isClean=!1;if(b.pfRuns&&b.pfRuns.length&&b.pfRuns[0].pf){y=b.pfRuns[0].pf;if(this.Ga.powerPointTopologyAndListInfoInSlideTileIsEnabled)if(16!==
y.listType){m.listMetadata.listLevel=y.lvl;var G=this.E4d(y.listType);1===y.listType?(m.listMetadata.listType=G,m.listMetadata.listTag=y.listTag):0===y.listType&&(m.listMetadata.listType=G,m.listMetadata.listNumeration=this.EYf(y.listNumeration),m.listMetadata.listElementIndex=y.listElementIndex)}else m.listMetadata.indentationLevel=y.lvl;else m.listMetadata.listLevel=b.pfRuns[0].pf.lvl,m.listMetadata.listType=this.E4d(b.pfRuns[0].pf.listType);h.metadata.revisionId=b.pfRuns[0].pf.revisionId;m.isClean=
y=!b.pfRuns[0].pf.proofingDirty;c=c&&y}G=0;const U=[];let ja=null;for(const va of b.cfRuns)if(va)if(b=Fa.a.ue(va.cf.lang)){this.TPg.Rgd(va.cf.lang);b=Object.assign(new qw,{start:G,length:va.len,languageId:b.name,doNotProcess:va.cf.noProof});ja||(ja=b.languageId);if(ja!==b.languageId||va.cf.noProof)0<=b.start&&0<b.length&&b.start+b.length<=m.text.length?U.push(b):(b.length||b.start!==m.text.length)&&Ba.a.J(36823817,375,10,"Invalid span, start: {0}, length: {1}, paragraph length: {2}",b.start,b.length,
m.text.length);G+=va.len}else G+=va.len;!y&&0<U.length&&(m.spans=Array.clone(U));m.languageId=ja;if(ta.a.Wa(m.languageId))return Ba.a.J(38385415,375,15,"Empty LanguageId, span length {0}",U.length),{returnValue:null,pFa:c};h.elements.push(m);a.push(h);return{returnValue:h,pFa:c}}G6h(a,b,c){const h=Object.assign(new qt,{metadata:Object.assign(new zr,{tileId:a.id,tileType:2}),nodes:[]});Array.add(b.nodes,h);b=Object.assign(new tt,{analyzerData:new Ju,numberOfChildrenOnClient:a.drawingElems.length});
c[a.id]=b;return h}a5h(a,b,c){const h=Object.assign(new qt,{metadata:Object.assign(new zr,{tileId:a.id}),nodes:[]});Array.add(b.nodes,h);b=Object.assign(new tt,{analyzerData:Object.assign(new Ju,{groupType:this.Z3i(a.mk.type)}),numberOfChildrenOnClient:a.text.paragraphs.length});c[a.id]=b;return h}Q5h(a,b,c){const h=Object.assign(new qt,{metadata:Object.assign(new zr,{tileId:a.id,tileType:1}),nodes:[]});Array.add(b.nodes,h);b=Object.assign(new tt,{numberOfChildrenOnClient:0});c[a.id]=b}}Object(n.a)(ut,
"TileToTileCheckRequestTransformer",null,[1273]);class sw{constructor(){this.XF=this.K=null}get name(){return"PowerPointWebEditor.Proofing"}$b(a){this.K=a;this.cxi();this.dxi();this.K.register(1248,"Box4.Proofing.IEditorServiceErrorDetailsFactory").ma().oa(()=>new Cu(u.AFrameworkApplication.fa.ka("ProofingFeedbackLoopIsEnabled"),this.K.resolve("Box4.Proofing.IProofingFeedbackLoopManager"),this.K.resolve("Box4.Proofing.IProofingFeatureConfiguration")));this.K.register(1249,"Box4.Proofing.IProofingCritiqueCategoryInfoFilter").ma().oa(()=>
new Du(this.K.resolve("PowerPointWebEditor.IApplicationSettings")));a.register(1250,"PowerPointWebEditor.Proofing.IProofingDashboardAggregator").ma().oa(()=>this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptProofingDashboardTraceEnabled?new fw(this.K.resolve("PowerPointWebEditor.IApplicationSettings")):new gw);this.K.register(Qq,"PowerPointWebEditor.Proofing.EditorServiceResultsManager").ma().oa(()=>new Qq(this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("Box4.Proofing.IErrorRangeEditor"),
this.K.resolve("Box4.Proofing.IProofingTextUtility"),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("Box4.Proofing.IEditorServiceErrorDetailsFactory"),this.K.resolve("Common.Utils.Aggregators.IAggregator<System.Func<Box4.Proofing.ProofingTraceMetrics>>"),this.K.Ja("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("PowerPointWebEditor.Graph.INotesReader"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),
this.K.resolve("PowerPointWebEditor.Proofing.ICloudALResponseTransformer"),this.K.resolve("PowerPointWebEditor.Proofing.IProofingDashboardAggregator"),this.K.resolve("PowerPointWebEditor.Proofing.ProofingTileCheckCloudALWorkflow")));this.K.register(1251,"PowerPointWebEditor.Proofing.IConsistencyCheckManager").ma().oa(()=>new cw(this.K.resolve("Box4.Graph.IGraphInstance").Ad(12),this.K.resolve("Box4.Graph.IGraphInstance").Ad(22),this.K.resolve("Box4.Graph.IGraphInstance").Ad(10),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.resolve("PowerPointWebEditor.Graph.INotesReader"),this.K.resolve("Box4.IParagraphReader"),this.K.resolve("Box4.List.IListReader")));this.K.register(ut,"PowerPointWebEditor.Proofing.TileToTileCheckRequestTransformer").as("PowerPointWebEditor.Proofing.ITileToTileCheckRequestTransformer").ma().oa(()=>
new ut(this.K.resolve("Box4.Proofing.IProofingDescriptors"),this.K.resolve("Box4.Proofing.ICritiqueTypeSettings"),this.K.resolve("Box4.Proofing.IProofingConfigV2Manager"),this.K.resolve("Box4.Proofing.IProofingFeatureConfiguration"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.IPresentationReader")));this.K.register(bw,"PowerPointWebEditor.Proofing.CloudALResponseTransformer").as("PowerPointWebEditor.Proofing.ICloudALResponseTransformer").ma().oa(()=>
new bw);this.K.register(Iu,"PowerPointWebEditor.Proofing.ProofingTileCheckWacALWorkflow").as("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopWorkflow").ma().oa(()=>new Iu(this.K.resolve("PowerPointWebEditor.Proofing.ITileToTileCheckRequestTransformer"),this.K.Ja("PowerPointWebEditor.AugmentationLoop.IPPTAugmentationManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.Proofing.IProofingDashboardAggregator")));this.K.register(Hu,"PowerPointWebEditor.Proofing.ProofingTileCheckCloudALWorkflow").as("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopWorkflow").ma().oa(()=>
new Hu(this.K.resolve("PowerPointWebEditor.Proofing.ITileToTileCheckRequestTransformer"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.Proofing.IProofingDashboardAggregator")));this.K.register(Fu,"PowerPointWebEditor.Proofing.ProofingAugLoopRuntimeManager").ma().oa(()=>{const b=[],c=this.K.resolve("Common.IAppSettingsManager").ka("576");this.K.resolve("Common.IAppSettingsManager").ka("772")?b.push(c?this.K.resolve("PowerPointWebEditor.Proofing.ProofingTileCheckCloudALWorkflow"):
this.K.resolve("PowerPointWebEditor.Proofing.ProofingTileCheckWacALWorkflow")):(b.push(this.K.resolve("PowerPointWebEditor.Proofing.ProofingTileCheckWacALWorkflow")),c&&b.push(this.K.resolve("PowerPointWebEditor.Proofing.ProofingTileCheckCloudALWorkflow")));return new Fu(this.K.Ja("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),b)});this.K.register(aw.a,"Box4.Proofing.CritiqueTypeSettings").as("Box4.Proofing.ICritiqueTypeSettings").ma().oa(()=>new aw.a(this.K.resolve("Box4.IRoamingServiceRequestManager"),
u.AFrameworkApplication.fa.Ha("PptRoamingServiceGetActionName"),u.AFrameworkApplication.fa.Ha("PptRoamingServiceSaveActionName")))}init(){this.K.resolve("PowerPointWebEditor.IPPTProofingDataHandlerFactory");const a=this.K.resolve("Common.IAppSettingsManager");a.jf(()=>{this.XF=this.K.resolve("Box4.Proofing.IProofingFeatureConfiguration");this.XF.WTa=a.ka("810");this.XF.myb=a.ka("809");this.XF.AUa=a.ka("299");if(this.XF.WTa||this.XF.myb)this.K.resolve("Box4.Proofing.IProofingDescriptors").Lce(),this.K.resolve("PowerPointWebEditor.Proofing.ProofingAugLoopRuntimeManager").initialize(),
this.K.resolve("PowerPointWebEditor.Proofing.EditorServiceResultsManager").initialize();this.XF.AUa&&(this.K.resolve("Box4.Proofing.IProofingConfigV2Manager").init(),this.K.resolve("Box4.Proofing.ICritiqueTypeSettings").init());this.XF.myb&&(this.K.resolve("PowerPointWebEditor.Proofing.IConsistencyCheckManager"),this.K.resolve("PowerPointWebEditor.Proofing.IConsistencyCheckManager").initialize())});this.K.resolve("Box4.IProofingManager").suspend()}dispose(){this.K.resolve("PowerPointWebEditor.Proofing.IProofingBehaviorController").dispose();
this.XF.myb&&this.K.resolve("PowerPointWebEditor.Proofing.IConsistencyCheckManager").dispose()}cxi(){this.K.register(1252,"PowerPointWebEditor.IPPTProofingDataHandlerFactory").ma().oa(()=>new ey(this.K.resolve("Box4.IProofingManager"),this.K.resolve("Box4.Proofing.IModifiedRangeEditor"),this.K.resolve("Box4.Proofing.IErrorRangeEditor"),this.K.resolve("PowerPointWebEditor.Proofing.IProofingBehaviorController"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IShapeReader"),
this.K.resolve("Box4.Proofing.IProofingFeatureConfiguration"),this.K.resolve("PowerPointWebEditor.ISlideReader")))}dxi(){this.K.register(1253,"PowerPointWebEditor.Proofing.IProofingBehaviorController").ma().oa(()=>new Gu(this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("PowerPointWebEditor.Graph.INotesReader"),this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.resolve("PowerPointWebEditor.Graph.ITraverserFactory"),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("PowerPointWebEditor.Graph.IPptGraphIteratorFactory"),
this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("Box4.IProofingManager"),this.K.resolve("Box4.Proofing.IErrorRangeEditor"),this.K.resolve("Box4.Graph.IGraphInstance"),this.K.resolve("PowerPointWebEditor.BootStorage.ICoreOutboundHelper"),this.K.resolve("Box4.IParagraphReader"),this.K.resolve("PowerPointWebEditor.View.IShapeViewHelper"),this.K.resolve("Common.ITaskManager"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),
this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").zQj))}static main(){r.a.instance.Dc(new sw)}}Object(n.a)(sw,"PPTWebEditorProofingPackage",null,[2,3]);class vt{constructor(a,b,c,h,m,y,G,U,ja,va){this.qd=a;this.qd.XFc(Object(F.a)(this,this.B6g,"onTextEditViewClose"));this.qd.UXb(Object(F.a)(this,this.C6g,"onTextEditViewOpen"));this.qd.N$h(Object(F.a)(this,this.D1g,"onBeforeTextEditViewClose"));this.qd.R$h(Object(F.a)(this,
this.D6g,"onTextEditViewUpdate"));this.mpe=b;this.vi=m;this.Hv=y;this.nJ=c;this.hfb=h;this.adc=G;this.ncc=U;this.u$c=ja;this.tE=va}get oJc(){return this.mpe.instance}dispose(){this.qd.rPe(Object(F.a)(this,this.B6g,"onTextEditViewClose"));this.qd.okd(Object(F.a)(this,this.C6g,"onTextEditViewOpen"));this.qd.NUk(Object(F.a)(this,this.D1g,"onBeforeTextEditViewClose"));this.qd.QUk(Object(F.a)(this,this.D6g,"onTextEditViewUpdate"))}D6g(){this.ncc.SY()}C6g(a,b){a=b.Gw.shapeNode;this.nJ.rpc(a,!1);this.nJ.zhd(a);
this.oJc&&this.oJc.Qsk(a)}D1g(a,b){this.adc.f0d(b.Gw.Md)}B6g(a,b){a=b.Gw;const c=b.Gw.shapeNode,h=!!c&&c.isConnected;b.$ta?this.tE.instance&&((this.tE.instance.xzb||this.tE.instance.S3)&&2===this.tE.instance.fG||this.tE.instance.c_c)?Ba.a.J(38836432,822,15,"ShapeViewElementTextEditHandler::onTextEditViewClose skipped when session is closing reason:{0}, ForceSave:{1}",this.tE.instance.fG,this.tE.instance.c_c):(h&&c.$nd(),c.ud?(this.nJ.MDh(c),this.hfb.V1g(),this.Hv.wZe()):(this.vi.N6a(c),this.Hv.GTd())):
this.u$c||this.nJ.MDh(c);this.nJ.rpc(b.Gw.shapeNode,h&&c.pYc);this.oJc&&!a.$p&&this.oJc.Psk(c)}}Object(n.a)(vt,"ShapeViewElementTextEditHandler",null,[106]);class Lu{constructor(a){this.nhc=null;this.S8j=a;this.reset()}WBh(a,b){a&&this.nhc.$(a,b)}Vwb(a){let b=0;this.nhc.Hb(a)&&(b=this.nhc.ga(a)?1:2);return b}xDe(a){return this.S8j?1===this.Vwb(a):!1}reset(){const a=this.nhc;this.nhc=new Nd.a(!1);return a}}Object(n.a)(Lu,"TextEditingRevisionInfoTracker",null,[1275,1276]);var Ar=d(1053),te=d(575),fy=
d(415),tw=d(840),Mu=d(319);class gy{constructor(){this.typeField=this.startAtField=0}}Object(n.a)(gy,"CT_TextAutonumberBullet",null,[]);class wt{constructor(){this.charField=null}}Object(n.a)(wt,"CT_TextCharBullet",null,[]);class Nu{}Object(n.a)(Nu,"CT_TextNoAutofit",null,[]);class ei{}Object(n.a)(ei,"CT_TextNoBullet",null,[]);class uw{constructor(){this.lnSpcReductionField=this.fontScaleField=0}}Object(n.a)(uw,"CT_TextNormalAutofit",null,[]);class Ou{constructor(){this.itemField=null}}Object(n.a)(Ou,
"CT_TextSpacing",null,[]);class bq{constructor(){this.valField=0}}Object(n.a)(bq,"CT_TextSpacingPercent",null,[]);class Pu{constructor(){this.tField=this.rPrField=null}}Object(n.a)(Pu,"CT_WebRegularTextRun",null,[]);class vw{constructor(){this.pField=this.lstStyleField=this.bodyPrField=null}}Object(n.a)(vw,"CT_WebTextBody",null,[]);class xt{constructor(){this.lInsField=this.horzOverflowField=this.bInsField=this.anchorField=0;this.normAutofitField=this.noAutofitField=null;this.rotField=this.rInsField=
0;this.spAutoFitField=null;this.spcFirstLastParaField=!1;this.wrapField=this.vertOverflowField=this.vertField=this.tInsField=0}}Object(n.a)(xt,"CT_WebTextBodyProperties",null,[]);class xp{constructor(){this.altLangField=null;this.baselineField=0;this.bFieldSpecified=this.bField=this.baselineFieldSpecified=!1;this.blipFillField=null;this.capField=0;this.capFieldSpecified=!1;this.defsymField=this.deflatinField=this.defeaField=this.defcsField=this.csField=null;this.dirtyField=!1;this.embedImgLocField=
this.effectLstField=this.effectDagField=this.eaField=null;this.errField=!1;this.hlinkMouseOverField=this.hlinkClickField=this.highlightField=this.grpFillField=this.gradFillField=null;this.isDefFontFieldSpecified=this.isDefFontField=this.iFieldSpecified=this.iField=!1;this.kernField=0;this.kernFieldSpecified=!1;this.noFillField=this.lnField=this.latinField=this.langField=null;this.normalizeHFieldSpecified=this.normalizeHField=this.noProofFieldSpecified=this.noProofField=!1;this.pattFillField=null;
this.proofErrField=0;this.rawSolidFillField=null;this.rtlFieldSpecified=this.rtlField=!1;this.solidFillField=null;this.spcField=0;this.spcFieldSpecified=!1;this.stField=0;this.strikeFieldSpecified=this.strikeField=this.stFieldSpecified=!1;this.symField=null;this.szField=0;this.uFieldSpecified=this.uField=this.szFieldSpecified=!1;this.uLnTxField=this.uLnField=this.uFillTxField=this.uFillField=null;this.utField=0;this.utFieldSpecified=!1}}Object(n.a)(xp,"CT_WebTextCharacterProperties",null,[]);class hy{constructor(){this.pPrField=
this.itemsField=this.endParaRPrField=null}}Object(n.a)(hy,"CT_WebTextParagraph",null,[]);class cq{constructor(){this.algnField=0;this.algnFieldSpecified=!1;this.buSzTxField=this.buSzPtsField=this.buSzPctField=this.buNoneField=this.buFontTxField=this.buFontField=this.buClrTxField=this.buClrField=this.buCharField=this.buAutoNumField=null;this.defIndentFieldSpecified=this.defIndentField=!1;this.defIndentValueField=0;this.defListFieldSpecified=this.defListField=this.defIndentValueFieldSpecified=!1;this.defLnSpcField=
null;this.defMarginFieldSpecified=this.defMarginField=!1;this.defMarLValueField=0;this.defMarLValueFieldSpecified=!1;this.defSpcBefField=this.defSpcAftField=this.defRPrField=null;this.defTabSzField=0;this.eaLnBrkFieldSpecified=this.eaLnBrkField=this.defTabSzFieldSpecified=!1;this.fontAlgnField=0;this.hangingPunctFieldSpecified=this.hangingPunctField=this.fontAlgnFieldSpecified=!1;this.indentField=0;this.latinLnBrkFieldSpecified=this.latinLnBrkField=this.indentFieldSpecified=!1;this.lnSpcField=null;
this.lvlField=0;this.lvlFieldSpecified=!1;this.marLField=0;this.marLFieldSpecified=!1;this.marRField=0;this.rtlFieldSpecified=this.rtlField=this.marRFieldSpecified=!1;this.spcBefField=this.spcAftField=null}}Object(n.a)(cq,"CT_WebTextParagraphProperties",null,[]);class ww{constructor(a,b){this.shapeText=a;this.bPb=b}}Object(n.a)(ww,"ShapeTextState",null,[]);class xw{constructor(){this.chngTyp=0;this.repChar=this.delChar=this.insChar=this.bodyPrChng=this.paraFrmtChng=this.charFrmtChng=null}}Object(n.a)(xw,
"IncrementalRequestTextOperation",null,[]);class tj{constructor(a,b){this.len=this.cp=0;this.cp=a;this.len=b}LG(){return this.cp+this.len}contains(a){return this.cp<=a&&a<this.LG()}fxa(a){return this.contains(a.cp)||a.contains(this.cp)}NEa(a){const b=Math.max(a.cp,this.cp);return new tj(b,Math.max(0,Math.min(a.LG(),this.LG())-1-b+1))}static copy(a){return new tj(a.cp,a.len)}}Object(n.a)(tj,"TextRange",null,[]);class El{constructor(a){this.Jq=a}}Object(n.a)(El,"ChangeState",null,[]);const iy=(a,b)=>
{if(!(a&&b&&a.rPrField&&b.rPrField))return null;let c=!1;const h=new xp;a.rPrField.bField!==b.rPrField.bField&&(c=!0,h.bField=b.rPrField.bField,h.bFieldSpecified=b.rPrField.bFieldSpecified);a.rPrField.iField!==b.rPrField.iField&&(c=!0,h.iField=b.rPrField.iField,h.iFieldSpecified=b.rPrField.iFieldSpecified);a.rPrField.uField!==b.rPrField.uField&&(c=!0,h.uField=b.rPrField.uField,h.uFieldSpecified=b.rPrField.uFieldSpecified);a.rPrField.strikeField!==b.rPrField.strikeField&&(c=!0,h.strikeField=b.rPrField.strikeField,
h.strikeFieldSpecified=b.rPrField.strikeFieldSpecified);a.rPrField.szField!==b.rPrField.szField&&(c=!0,h.szField=b.rPrField.szField,h.szFieldSpecified=b.rPrField.szFieldSpecified);a.rPrField.spcField!==b.rPrField.spcField&&(c=!0,h.spcField=b.rPrField.spcField,h.spcFieldSpecified=b.rPrField.spcFieldSpecified);a.rPrField.kernField!==b.rPrField.kernField&&(c=!0,h.kernField=b.rPrField.kernField,h.kernFieldSpecified=b.rPrField.kernFieldSpecified);a.rPrField.capField!==b.rPrField.capField&&(c=!0,h.capField=
b.rPrField.capField,h.capFieldSpecified=b.rPrField.capFieldSpecified);a.rPrField.baselineField!==b.rPrField.baselineField&&(c=!0,h.baselineField=b.rPrField.baselineField,h.baselineFieldSpecified=b.rPrField.baselineFieldSpecified);!b.rPrField.latinField||a.rPrField.latinField&&a.rPrField.latinField.typefaceField===b.rPrField.latinField.typefaceField||(c=!0,h.latinField=b.rPrField.latinField);!b.rPrField.eaField||a.rPrField.eaField&&a.rPrField.eaField.typefaceField===b.rPrField.eaField.typefaceField||
(c=!0,h.eaField=b.rPrField.eaField);return c?h:null},yw=(a,b)=>{if(!(a&&b&&a.pPrField&&b.pPrField))return null;a=a.pPrField;b=b.pPrField;const c=new cq;let h=!1;ps(a.lnSpcField,b.lnSpcField)&&(c.lnSpcField=b.lnSpcField,h=!0);ps(a.defLnSpcField,b.defLnSpcField)&&(c.defLnSpcField=b.defLnSpcField,h=!0);ps(a.spcBefField,b.spcBefField)&&(c.spcBefField=b.spcBefField,h=!0);ps(a.defSpcBefField,b.defSpcBefField)&&(c.defSpcBefField=b.defSpcBefField,h=!0);ps(a.spcAftField,b.spcAftField)&&(c.spcAftField=b.spcAftField,
h=!0);ps(a.defSpcAftField,b.defSpcAftField)&&(c.defSpcAftField=b.defSpcAftField,h=!0);dd.c(a.defRPrField)!==dd.c(b.defRPrField)&&(c.defRPrField=b.defRPrField,h=!0);!a.buNoneField!==!b.buNoneField&&(c.buNoneField=b.buNoneField,h=!0);dd.c(a.buCharField)!==dd.c(b.buCharField)&&(c.buCharField=b.buCharField,h=!0);dd.c(a.buAutoNumField)!==dd.c(b.buAutoNumField)&&(c.buAutoNumField=b.buAutoNumField,h=!0);dd.c(a.buFontField)!==dd.c(b.buFontField)&&(c.buFontField=b.buFontField,h=!0);if(a.marLFieldSpecified!==
b.marLFieldSpecified||a.marLField!==b.marLField)c.marLFieldSpecified=b.marLFieldSpecified,c.marLField=b.marLField,h=!0;if(a.defMarLValueFieldSpecified!==b.defMarLValueFieldSpecified||a.defMarLValueField!==b.defMarLValueField)c.defMarLValueFieldSpecified=b.defMarLValueFieldSpecified,c.defMarLValueField=b.defMarLValueField,h=!0;if(a.marRFieldSpecified!==b.marRFieldSpecified||a.marRField!==b.marRField)c.marRFieldSpecified=b.marRFieldSpecified,c.marRField=b.marRField,h=!0;if(a.lvlFieldSpecified!==b.lvlFieldSpecified||
a.lvlField!==b.lvlField)c.lvlFieldSpecified=b.lvlFieldSpecified,c.lvlField=b.lvlField,h=!0;if(a.indentFieldSpecified!==b.indentFieldSpecified||a.indentField!==b.indentField)c.indentFieldSpecified=b.indentFieldSpecified,c.indentField=b.indentField,h=!0;if(a.defIndentFieldSpecified!==b.defIndentFieldSpecified||a.defIndentField!==b.defIndentField)c.defIndentFieldSpecified=b.defIndentFieldSpecified,c.defIndentField=b.defIndentField,h=!0;if(a.algnFieldSpecified!==b.algnFieldSpecified||a.algnField!==b.algnField)c.algnFieldSpecified=
b.algnFieldSpecified,c.algnField=b.algnField,h=!0;if(a.defTabSzFieldSpecified!==b.defTabSzFieldSpecified||a.defTabSzField!==b.defTabSzField)c.defTabSzFieldSpecified=b.defTabSzFieldSpecified,c.defTabSzField=b.defTabSzField,h=!0;if(a.rtlFieldSpecified!==b.rtlFieldSpecified||a.rtlField!==b.rtlField)c.rtlFieldSpecified=b.rtlFieldSpecified,c.rtlField=b.rtlField,h=!0;if(a.defListFieldSpecified!==b.defListFieldSpecified||a.defListField!==b.defListField)c.defListFieldSpecified=b.defListFieldSpecified,c.defListField=
b.defListField,h=!0;if(a.defMarginFieldSpecified!==b.defMarginFieldSpecified||a.defMarginField!==b.defMarginField)c.defMarginFieldSpecified=b.defMarginFieldSpecified,c.defMarginField=b.defMarginField,h=!0;if(a.eaLnBrkFieldSpecified!==b.eaLnBrkFieldSpecified||a.eaLnBrkField!==b.eaLnBrkField)c.eaLnBrkFieldSpecified=b.eaLnBrkFieldSpecified,c.eaLnBrkField=b.eaLnBrkField,h=!0;if(a.fontAlgnFieldSpecified!==b.fontAlgnFieldSpecified||a.fontAlgnField!==b.fontAlgnField)c.fontAlgnFieldSpecified=b.fontAlgnFieldSpecified,
c.fontAlgnField=b.fontAlgnField,h=!0;if(a.latinLnBrkFieldSpecified!==b.latinLnBrkFieldSpecified||a.latinLnBrkField!==b.latinLnBrkField)c.latinLnBrkFieldSpecified=b.latinLnBrkFieldSpecified,c.latinLnBrkField=b.latinLnBrkField,h=!0;return h?c:null},ps=(a,b)=>a||b?a&&b?a.itemField.valField!==b.itemField.valField:!0:!1;class ep{constructor(){this.Yn=this.tHa=null}}Object(n.a)(ep,"TextParaRange",null,[]);class yt{constructor(){this.Yn=this.kIa=null}}Object(n.a)(yt,"TextRunRange",null,[]);class zw{constructor(a,
b,c,h,m,y){this.Hea=this.lma=null;this.O4=this.fla=0;this.HL=this.e4=null;this.$va=this.$Fa=0;this.aGa=c;this.JHa=h;this.gla=m;this.h$=y;this.Ond(new tj(0,a.shapeText.length),new tj(0,b.shapeText.length))}Ond(a,b){this.lma=a;this.Hea=b;for(a=Math.max(0,this.$Fa-1);a<this.aGa.length;a++)if(this.aGa[a].Yn.fxa(this.lma)||this.lma.LG()<=this.aGa[a].Yn.cp){this.$Fa=a;break}for(a=Math.max(0,this.$va-1);a<this.JHa.length;a++)if(this.JHa[a].Yn.fxa(this.Hea)||this.Hea.LG()<=this.JHa[a].Yn.cp){this.$va=a;break}this.HL=
this.e4=null;for(a=Math.max(0,this.fla-1);a<this.gla.length;a++)if(this.gla[a].Yn.fxa(this.lma)||this.lma.LG()<=this.gla[a].Yn.cp){this.fla=a;break}for(a=Math.max(0,this.O4-1);a<this.h$.length;a++)if(this.h$[a].Yn.fxa(this.Hea)||this.Hea.LG()<=this.h$[a].Yn.cp){this.O4=a;break}}FJf(){return this.$Fa>=this.aGa.length?null:Object.assign(new ep,{tHa:this.aGa[this.$Fa].tHa,Yn:this.aGa[this.$Fa].Yn.NEa(this.lma)})}GJf(){return this.$va>=this.JHa.length?null:Object.assign(new ep,{tHa:this.JHa[this.$va].tHa,
Yn:this.JHa[this.$va].Yn.NEa(this.Hea)})}IJf(){return this.Ihe()&&this.e4?Object.assign(new yt,{kIa:this.gla[this.fla].kIa,Yn:this.e4}):null}JJf(){return this.K8b()&&this.HL?Object.assign(new yt,{kIa:this.h$[this.O4].kIa,Yn:this.HL}):null}Hhe(){return this.lfg()&&this.J8b()}lfg(){return this.$Fa>=this.aGa.length?!1:this.aGa[this.$Fa].Yn.fxa(this.lma)}J8b(){return this.$va>=this.JHa.length?!1:this.JHa[this.$va].Yn.fxa(this.Hea)}Ihe(){return!this.lfg()||this.fla>=this.gla.length?!1:this.gla[this.fla].Yn.fxa(this.aGa[this.$Fa].Yn)&&
this.gla[this.fla].Yn.fxa(this.lma)}K8b(){return!this.J8b()||this.O4>=this.h$.length?!1:this.h$[this.O4].Yn.fxa(this.JHa[this.$va].Yn)&&this.h$[this.O4].Yn.fxa(this.Hea)}uDh(){this.Hhe()&&(this.$Fa++,this.$va++);return this.Hhe()}vDh(){this.J8b()&&this.$va++;return this.J8b()}uul(){if(!this.Ihe()||!this.K8b())return!1;if(this.e4&&this.HL){this.e4.LG()===this.gla[this.fla].Yn.LG()&&this.fla++;this.HL.LG()===this.h$[this.O4].Yn.LG()&&this.O4++;if(!this.Ihe()||!this.K8b())return!1;var a=this.gla[this.fla].Yn.NEa(this.lma);
this.e4.cp=Math.max(a.cp,this.e4.LG());this.e4.len=a.LG()-this.e4.cp;a=this.h$[this.O4].Yn.NEa(this.Hea);this.HL.cp=Math.max(a.cp,this.HL.LG());this.HL.len=a.LG()-this.HL.cp}else this.e4=this.gla[this.fla].Yn.NEa(this.lma),this.HL=this.h$[this.O4].Yn.NEa(this.Hea);a=Math.min(this.e4.len,this.HL.len);this.e4.len=a;this.HL.len=a;return 0<a}vul(){if(!this.K8b())return!1;this.e4||(this.e4=this.gla[this.fla].Yn.NEa(this.lma));if(this.HL){if(this.HL.LG()===this.h$[this.O4].Yn.LG()&&(this.O4++,!this.K8b()))return!1;
const a=this.h$[this.O4].Yn.NEa(this.Hea);this.HL.cp=Math.max(a.cp,this.HL.LG());this.HL.len=a.LG()-this.HL.cp}else this.HL=this.h$[this.O4].Yn.NEa(this.Hea);return 0<this.HL.len}}Object(n.a)(zw,"TextFormatIterator",null,[]);class Aw{constructor(){this.txt=this.txtrng=null}}Object(n.a)(Aw,"TextModificationData",null,[]);class Br{constructor(a,b){this.textRange=new tj(a.cp,a.len);this.text=b}}Object(n.a)(Br,"TextModificationInfo",null,[]);class Qu{constructor(){this.len=this.cp=0}}Object(n.a)(Qu,"TextRangeData",
null,[]);class Bw{constructor(){this.charPrp=this.txtrng=null}}Object(n.a)(Bw,"WebTextCharFormatChange",null,[]);class qs{constructor(){this.paraPrp=this.txtrng=null}}Object(n.a)(qs,"WebTextParaFormatChange",null,[]);class Cr{constructor(a,b){this.Dqg=this.TWa=this.TCb=this.Xla=this.eU=-1;this.Lxe=this.Xoe=null;this.MVa=new tj(0,0);this.sla=new tj(0,0);this.k0=null;if(!a)throw Error.create("InputBaseTextStateNull");if(!b)throw Error.create("InputRevisedTextStateNull");this.LAb=a;this.zeb=b;let c,
h;({rRe:a,YHe:c}=this.J5f(a.bPb));1<a.length&&(this.Dqg=a[a.length-1].Yn.LG());({rRe:b,YHe:h}=this.J5f(b.bPb));this.kO=new zw(this.LAb,this.zeb,c,h,a,b)}Jvi(){this.Avi();this.Bvi();this.Lvi();const a=[],b=this.Rvi();b&&a.push(b);a.push.apply(a,this.Hvi());a.push.apply(a,this.Gvi());a.push.apply(a,this.Ivi());return a}J5f(a){const b=[],c=[];var h=[];var m=[];let y=0;if(!a.pField)return{rRe:h,YHe:m};for(const G of a.pField)if(a=new ep,a.tHa=G,a.Yn=new tj(y,0),h=0,G.itemsField&&G.itemsField.length){for(const U of G.itemsField)U.tField&&
U.tField.length&&(m=new yt,m.Yn=new tj(y,U.tField.length),m.kIa=U,y+=U.tField.length,h+=U.tField.length,b.push(m));y+=1;a.Yn.len=h;c.push(a)}return{rRe:b,YHe:c}}Avi(){this.eU=this.sbd(!0)}Bvi(){this.eU===this.LAb.shapeText.length?this.Xla=0:(this.Xla=this.sbd(!1),this.eU+this.Xla>this.LAb.shapeText.length?this.Xla=this.LAb.shapeText.length-this.eU:this.eU+this.Xla>this.zeb.shapeText.length&&(this.Xla=this.zeb.shapeText.length-this.eU))}Lvi(){this.TCb=this.LAb.shapeText.length-this.eU-this.Xla;this.TWa=
this.zeb.shapeText.length-this.eU-this.Xla}Hvi(){const a=[];if(!this.eU)return a;this.kO.Ond(new tj(0,this.eU),new tj(0,this.eU));do this.k0=this.SCh(),0!==this.k0.Jq&&a.push(this.JQc(this.k0));while(0!==this.k0.Jq);return a}Rvi(){if(!this.TCb&&!this.TWa)return null;this.MVa=new tj(this.eU,this.TCb);this.sla=new tj(this.eU,this.TWa);this.k0=!this.TCb&&0<this.TWa?new El(4):0<this.TCb&&!this.TWa?new El(5):new El(6);return this.JQc(this.k0)}Gvi(){const a=[];if(!this.TWa)return a;const b=new tj(this.eU-
1,1);b.cp=Math.max(0,b.cp);b.cp=Math.min(b.cp,this.Dqg-1);this.kO.Ond(b,new tj(this.eU,this.TWa));do this.k0=this.Ltl(),0!==this.k0.Jq&&a.push(this.JQc(this.k0));while(0!==this.k0.Jq);return a}Ivi(){const a=[];if(!this.Xla)return a;this.k0=null;this.kO.Ond(new tj(this.eU+this.TCb,this.Xla),new tj(this.eU+this.TWa,this.Xla));do this.k0=this.SCh(),0!==this.k0.Jq&&a.push(this.JQc(this.k0));while(0!==this.k0.Jq);return a}JQc(a){if(!a)return null;const b=new xw;b.chngTyp=a.Jq;switch(a.Jq){case 3:b.charFrmtChng=
Object.assign(new Bw,{txtrng:this.sla,charPrp:this.Xoe});break;case 2:b.paraFrmtChng=Object.assign(new qs,{txtrng:this.sla,paraPrp:this.Lxe});break;case 4:b.insChar=Cr.z_e(new Br(this.MVa,this.zeb.shapeText.substring(this.sla.cp,this.sla.LG())));break;case 5:b.delChar=Cr.z_e(new Br(this.MVa,""));break;case 6:b.repChar=Cr.z_e(new Br(this.MVa,this.zeb.shapeText.substring(this.sla.cp,this.sla.LG())))}return b}sbd(a){const b=this.LAb.shapeText,c=this.zeb.shapeText,h=new tj(0,b.length),m=new tj(0,c.length);
let y=a?0:b.length-1,G=a?0:c.length-1;for(;h.contains(y)&&m.contains(G)&&b.charAt(y)===c.charAt(G);)y=a?y+1:y-1,G=a?G+1:G-1;return a?y:b.length-y-1}Ltl(){do{for(;this.kO.vul();){var a=this.kO.IJf(),b=this.kO.JJf();if(a&&b){var c=iy(a.kIa,b.kIa);this.MVa=tj.copy(a.Yn);this.sla=tj.copy(b.Yn);if(c)return this.Xoe=c,new El(3)}}if(this.kO.J8b()&&(a=this.kO.FJf(),b=this.kO.GJf(),a&&b&&(c=yw(a.tHa,b.tHa),this.MVa=tj.copy(a.Yn),this.sla=tj.copy(b.Yn),c)))return this.Lxe=c,this.kO.vDh(),new El(2)}while(this.kO.vDh());
return new El(0)}SCh(){do{for(;this.kO.uul();){var a=this.kO.IJf(),b=this.kO.JJf();if(a&&b){var c=iy(a.kIa,b.kIa);this.MVa=tj.copy(a.Yn);this.sla=tj.copy(b.Yn);if(c)return this.Xoe=c,new El(3)}}if(this.kO.Hhe()&&(a=this.kO.FJf(),b=this.kO.GJf(),a&&b&&(c=yw(a.tHa,b.tHa),this.MVa=tj.copy(a.Yn),this.sla=tj.copy(b.Yn),c)))return this.Lxe=c,this.kO.uDh(),new El(2)}while(this.kO.uDh());return new El(0)}static z_e(a){return Object.assign(new Aw,{txt:a.text,txtrng:Cr.Apl(a.textRange)})}static Apl(a){return Object.assign(new Qu,
{cp:a.cp,len:a.len})}}Object(n.a)(Cr,"IncrementalChangeIterator",null,[]);class Cw{constructor(){this.rh=this.bh=this.increq=null}}Object(n.a)(Cw,"TextLayoutDeltaClientRequestData",null,[]);class Dw{constructor(){this.tb=null;this.h=this.w=0}}Object(n.a)(Dw,"TextLayoutFullClientRequest",null,[]);class Am{constructor(){this.corr=this.id=null;this.h={};this.delta=this.full=null}}Object(n.a)(Am,"TextLayoutRequest",null,[]);class Qn{constructor(a,b,c,h,m,y){this.nfc=this.Ml=null;this.Dcc=!0;this.zHa=
-1;this.dak=(new Date).getTime();this.ydb=this.qla=0;this.xbc=-1;this.bpe=5E3;const G=document.createElement("a");G.href=a;G.protocol="http:"===G.protocol?"ws":"wss";this.aFb=G.href;this.u4=b;this.S_b();this.uEg=c;this.GFg=h;this.D$j=m;this.bye=y.vpl;this.q7c=y.upl;this.fRg=y.rpl;this.v9c=y.qpl;this.qma=this.fRg;this.XUe()}onMessage(a){if(a&&a.data)if(a.data.startsWith("pong"))this.yGb(a.data);else if(a=JSON.parse(a.data)){a.h||(a.h={});a.h.bEnd=(new Date).getTime().toString();try{this.GFg&&this.GFg(a)}catch(b){Ba.a.J(578828128,
824,50,(this.u4?"Dark Traffic ":"")+"Exception in OnTextLayoutReceived: {0}",b.toString())}if(this.uEg){const b={Caller:"WebSocketTextLayoutFetcher.OnMessage"};b.Telemetry=a.h;b.Response=a.resp;b.First=this.Dcc;this.uEg(b)}this.Dcc=!1}else Ba.a.J(592304271,820,50,(this.u4?"Dark Traffic ":"")+"WebSocketTextLayoutFetcher::OnMessage Empty Response")}onClose(a){Ba.a.J(592840414,820,50,(this.u4?"Dark Traffic ":"")+"WebSocketTextLayoutFetcher::OnClose {0}",JSON.stringify(a))}onError(a){Ba.a.J(592840412,
820,10,(this.u4?"Dark Traffic ":"")+"WebSocketTextLayoutFetcher::OnError {0}",JSON.stringify(a))}onOpen(){Ba.a.J(592840410,820,50,(this.u4?"Dark Traffic ":"")+"WebSocketTextLayoutFetcher::OnOpen");this.boc();this.ping();this.D$j()}XUe(){this.nfc=()=>{"visible"===window.document.visibilityState?(window.clearTimeout(this.xbc),this.Ml||(Ba.a.J(587522389,820,50,(this.u4?"Dark Traffic ":"")+"WebSocketTextLayoutFetcher::PageVisibilityEventHandler Reconnecting after visibility regained."),this.Txa())):this.xbc=
window.setTimeout(()=>{this.Ml&&(Ba.a.J(587522387,820,50,(this.u4?"Dark Traffic ":"")+"WebSocketTextLayoutFetcher::PageVisibilityEventHandler Closing due to visibility lost."),this.Ml.close(),this.Ml=null,window.clearTimeout(this.zHa))},this.bpe)};window.self.addEventListener("visibilitychange",this.nfc)}S_b(){this.Ml&&this.Ml.close();this.Ml=new WebSocket(this.aFb,[]);this.Ml.onopen=Object(F.a)(this,this.onOpen,"onOpen");this.Ml.onerror=Object(F.a)(this,this.onError,"onError");this.Ml.onclose=Object(F.a)(this,
this.onClose,"onClose");this.Ml.onmessage=Object(F.a)(this,this.onMessage,"onMessage")}boc(){this.qla=0}VOd(){0<this.v9c&&(new Date).getTime()-this.ydb>this.v9c&&(this.boc(),Ba.a.J(587337758,820,50,(this.u4?"Dark Traffic ":"")+"WebSocketTextLayoutFetcher::Retry connect to server after long pause."))}NSd(){return(new Date).getTime()-this.ydb>this.qma&&this.qla<this.q7c&&(!this.Ml||3===this.Ml.readyState||2===this.Ml.readyState)}fUe(){this.ydb=(new Date).getTime();this.qma=Math.pow(2,this.qla)*this.fRg;
0<this.v9c&&(this.qma=Math.min(this.qma,this.v9c));window.setTimeout(()=>{this.Txa()},this.qma)}Txa(){this.VOd();this.NSd()&&(this.S_b(),this.fUe(),this.qla++,Ba.a.J(588071072,820,50,(this.u4?"Dark Traffic ":"")+"WebSocketTextLayoutFetcher::Retry connect to server."),this.qla===this.q7c&&Ba.a.J(588071070,820,50,(this.u4?"Dark Traffic ":"")+"WebSocketTextLayoutFetcher::Max retries reached."))}fetch(a){this.Ml?(Ba.a.J(587804674,820,50,(this.u4?"Dark Traffic ":"")+"WebSocketTextLayoutFetcher::Fetch. WebSocket state {0}",
Zo[this.Ml.readyState]),1===this.Ml.readyState?this.Ml.send(dd.c(a)):this.Txa()):Ba.a.J(587522383,820,50,(this.u4?"Dark Traffic ":"")+"WebSocketTextLayoutFetcher::Fetch Websocket is unavailable.")}ping(){this.Ml?1===this.Ml.readyState?this.Ml.send("ping"+((new Date).getTime()-this.dak).toString()):(Ba.a.J(588294232,820,10,(this.u4?"Dark Traffic ":"")+"WebSocketTextLayoutFetcher::Ping. Wrong WebSocket state {0}",this.Ml.readyState),this.Txa()):Ba.a.J(587522380,820,50,(this.u4?"Dark Traffic ":"")+"WebSocketTextLayoutFetcher::Ping Websocket is unavailable.")}yGb(){-1!==
this.zHa&&window.clearTimeout(this.zHa);this.zHa=window.setTimeout(()=>{this.ping()},this.bye)}}Object(n.a)(Qn,"WebSocketTextLayoutFetcher",null,[1300]);class Dr{constructor(a,b,c,h,m,y,G){this.sEb=this.Oeb=this.Wvg=this.Vvg=null;this.nextId=1;this.ipe=-1;this.hpe=0;this.Ise=!0;if(!a)throw Error.argumentNull("shapeReader");if(!b)throw Error.argumentNull("topologyManager");if(!c)throw Error.argumentNull("clientRequestManager");if(!h)throw Error.argumentNull("walls");if(!m)throw Error.argumentNull("appSettings");
if(!y)throw Error.argumentNull("shapeViewLineBreakTelemetry");this.Ea=a;this.jq=b;this.Uea=h;this.la=m;this.uU=-1;y.execute(U=>{this.Oeb=U});this.la.xpl&&(this.Vvg=new Qn(this.la.tpl,!1,Object(F.a)(this,this.F1j,"logOnResponseReceived"),Object(F.a)(this,this.Ptk,"onTextLayoutReceived"),Object(F.a)(this,this.$1g,"onConnectionOpen"),this.la),this.la.Eah&&(this.Wvg=new Qn(this.la.spl,!0,Object(F.a)(this,this.E1j,"logOnDarkTrafficResponseReceived"),null,Object(F.a)(this,this.$1g,"onConnectionOpen"),this.la)));
this.Eea=G}lM(a,b,c){Ba.a.J(512495621,820,50,"TextLayoutManager::OnTimeout - Fallback to HTML Text Layout for this shape ");if(-1!==this.uU){window.clearTimeout(this.uU);this.uU=-1;var h=this.jq.presentation;h?(a=Object(ua.a)(116,h.lC(lc.a.PE(a,b))))?(c=a.eT(c))?c.wlb(!1):Ba.a.J(512495618,820,50,"TextLayoutManager::OnTimeout, IShapeNode is null"):Ba.a.J(512495619,820,50,"TextLayoutManager::OnTimeout, ISlide is null"):Ba.a.J(512495620,820,50,"TextLayoutManager::OnTimeout, IPageManifestNode is null")}}D1j(){this.hpe++;
-1===this.ipe&&(this.ipe=window.setTimeout(Object(F.a)(this,this.Ymk,"onCoauthLogTimer"),3E5))}Ymk(){this.ipe=-1;Ba.a.J(512495617,820,50,"TextLayoutManager::LogOnCoAuth, CoAuthRequestCount {0}",this.hpe);this.hpe=0}n4f(a){let b="";a.DJ(c=>{(c=Object(ua.a)(Vb.AParagraphNode,c))&&(b+=Ob.ParagraphReader.text(c)+"\n")});return b.substr(0,b.length-1)}Kvi(a){try{var b=Object,c=b.assign,h=new Cw,m=this.sEb;const va=[];var y,G=m.bPb.bodyPrField,U=a.bPb.bodyPrField;let Ta=!1;G.anchorField!==U.anchorField&&
(Ta=!0);G.bInsField!==U.bInsField&&(Ta=!0);G.tInsField!==U.tInsField&&(Ta=!0);G.lInsField!==U.lInsField&&(Ta=!0);G.rInsField!==U.rInsField&&(Ta=!0);G.horzOverflowField!==U.horzOverflowField&&(Ta=!0);G.vertOverflowField!==U.vertOverflowField&&(Ta=!0);dd.c(G.normAutofitField)!==dd.c(U.normAutofitField)&&(Ta=!0);dd.c(G.spAutoFitField)!==dd.c(U.spAutoFitField)&&(Ta=!0);G.rotField!==U.rotField&&(Ta=!0);G.spcFirstLastParaField!==U.spcFirstLastParaField&&(Ta=!0);G.wrapField!==U.wrapField&&(Ta=!0);(y=Ta?
U:null)&&va.push(Object.assign(new xw,{chngTyp:1,bodyPrChng:y}));const fb=new Cr(m,a);var ja=va.concat.apply(va,fb.Jvi());const Db=c.call(b,h,{increq:ja});Ba.a.J(512495616,820,50,"TextLayoutManager::FetchLineBreakInfo Incremental request size {0}",dd.c(Db).length);return Db}catch(va){Ba.a.J(512493795,820,10,"TextLayoutManager::Generate Incremental Requests Exception {0}",va.message)}return null}C1d(a,b){if(this.la.KAh&&a)if(b&&Ba.a.J(512493794,820,50,"TextLayoutManager::FetchLineBreakInfo, TextLayout- First request for this shape sent on Begin Edit."),
this.Uea.Kni())if(0!==this.Uea.Vqi(a,this.Ea))a.wlb(!1);else{if(!a.HBb)if(b)a.wlb(this.la.pNb);else return;if(!a.sC&&a.$ca().length&&(a.wLa||4===a.KK))try{const c=this.Z9d(a),h=Object.assign(new Am,{id:this.nextId.toString(),corr:Eh.a.create().toString()});if(this.la.wpl)if(!this.sEb||b||this.Ise)this.sEb=new ww(this.n4f(a),c),this.Ise=!1;else{const y=this.n4f(a),G=new ww(y,c),U=Ar.a.Bvb(dd.c(this.sEb.bPb));h.delta=this.Kvi(G);h.delta&&(h.delta.bh=U,h.delta.rh=Ar.a.Bvb(dd.c(G.bPb)));if(h.delta&&!h.delta.increq.length)if(this.la.y_e)h.delta=
null;else return;if(h.delta&&h.delta.increq.length)for(const ja of h.delta.increq)if(ja.repChar){ja.repChar.txtrng.len===this.sEb.shapeText.length&&(h.delta=null);break}this.sEb=G}h.delta&&h.delta.increq.length&&!this.la.y_e||(h.full=Object.assign(new Dw,{tb:c,w:a.wLa?a.wLa.Right:a.get_widthPersisted(),h:a.wLa?a.wLa.Bottom:a.get_heightPersisted()}));this.nextId+=1;-1!==this.uU&&window.clearTimeout(this.uU);this.uU=window.setTimeout(()=>{this.lM(a.slideId.sid,a.slideId.cid,a.get_shapeId())},this.la.ypl);
h.h={["bStart"]:(new Date).getTime().toString()};h.h.shapeId=a.get_shapeId();h.h.sid=a.slideId.sid;h.h.cid=a.slideId.cid;h.h.timeoutId=this.uU;h.h.reqHash=Ar.a.Bvb(dd.c(c));h.h.reqSz=dd.c(h).length;h.h.firstRequest=b;h.h.deltaCompare=this.la.y_e;const m=a.Nkj();b&&m&&(h.h.initialTextLayout=m.toString());this.Vvg.fetch(h);this.la.Eah&&this.Wvg.fetch(h)}catch(c){Ba.a.J(512493793,820,10,"WebSocketTextLayoutFetcher::FetchLineBreakInfo Exception {0}",c.message)}}else this.D1j(),a.wlb(!1)}yGf(a,b){switch(a.listType){case 16:b.buNoneField=
new ei;b.buCharField=null;b.buAutoNumField=null;break;case 0:b.buNoneField=null;b.buCharField=null;b.buAutoNumField=Object.assign(new gy,{startAtField:a.qA});b.buAutoNumField.typeField=8;break;default:b.buNoneField=null,b.buCharField=new wt,b.buCharField.charField="\u2022",b.buAutoNumField=null,b.buFontField=new Zl,b.buFontField.typefaceField=a.font}}JSa(a){const b=new bq;b.__type=Dr.rYj;b.valField=Math.floor(1E5*a);return b}qzi(a){const b=new cq;var c=new rb.GraphIterator;c.set(a);c.rc(11);c.Ng(11);
a.Sf.fw(c)?this.yGf(a.Sf.fw(c),b):this.yGf(Pe.a.pN(16,0),b);c=a.sa(jb.a.Zl,Vg.a.leftMargin);const h=a.sa(jb.a.pY,Vg.a.rightMargin);b.indentField=te.a.Psd(a.sa(jb.a.$n,Vg.a.indent));b.indentFieldSpecified=!0;b.marLField=te.a.Psd(c);b.marLFieldSpecified=!0;b.marRField=te.a.Psd(h);b.marRFieldSpecified=!0;b.defTabSzField=te.a.Psd(a.sa(jb.a.Ptb,Dr.XHc));b.defTabSzFieldSpecified=!0;b.lvlField=a.sa(jb.a.listLevel,Vg.a.zEa);b.lvlFieldSpecified=!0;b.algnField=this.opl(a.sa(kb.a.Il,1));b.algnFieldSpecified=
!0;2===this.Eea.JW(a).lineSpacing.Vf&&(b.lnSpcField=new Ou,b.lnSpcField.itemField=this.JSa(this.Eea.JW(a).lineSpacing.value));2===this.Eea.JW(a).beforeSpacing.Vf&&(b.spcBefField=new Ou,b.spcBefField.itemField=this.JSa(this.Eea.JW(a).beforeSpacing.value));2===this.Eea.JW(a).afterSpacing.Vf&&(b.spcAftField=new Ou,b.spcAftField.itemField=this.JSa(this.Eea.JW(a).afterSpacing.value));a=mc.OutlineElementNavigator.PA(a);a.properties.Sa(kb.a.oY)&&(b.rtlField=a.Lh(kb.a.oY));return b}opl(a){switch(a){case 2:return 1;
case 1:return 0;case 3:return 2;case 4:return 3;default:return 0}}Z9d(a){try{const b=Object.assign(new vw,{bodyPrField:new xt,pField:[]});b.bodyPrField.noAutofitField=a.H$?new Nu:null;a.Sa(X.a.G2)&&(b.bodyPrField.normAutofitField=new uw,b.bodyPrField.normAutofitField.fontScaleField=Math.floor(1E5*a.G2));a.Sa(X.a.yra)&&(b.bodyPrField.normAutofitField||(b.bodyPrField.normAutofitField=new uw),b.bodyPrField.normAutofitField.lnSpcReductionField=Math.floor(1E5*a.yra));b.bodyPrField.rotField=Math.floor(a.B_e);
b.bodyPrField.vertField=a.l6;b.bodyPrField.lInsField=Math.floor($d.a.DFb(a.zia));b.bodyPrField.tInsField=Math.floor($d.a.DFb(a.Bia));b.bodyPrField.rInsField=Math.floor($d.a.DFb(a.Aia));b.bodyPrField.bInsField=Math.floor($d.a.DFb(a.yia));b.bodyPrField.anchorField=a.Loa;b.bodyPrField.wrapField=a.u_c?0:1;this.Ea.DJ(a,c=>{if(c=Object(ua.a)(Vb.AParagraphNode,c)){var h=Object.assign(new hy,{itemsField:[]});h.pPrField=this.qzi(c);for(var m=Ob.ParagraphReader.text(c),y=0;y<c.Ra.length;){const U=new Pu;U.__type=
"CT_WebRegularTextRun:#Microsoft.Office.Server.Powerpoint.Interface.Edit";var G=c.Ra.ga(y);const ja=G.cp,va=y<c.Ra.length-1?c.Ra.ga(y+1).cp:Ob.ParagraphReader.textLength(c);y++;G.formatting?U.rPrField=this.K5f(G.formatting.cache):(G=fy.c(c.Ra,G.cp).q0c,U.rPrField=G?this.K5f(G.cache):this.Qkj(a));U.tField=ta.a.substring(m,ja,va);h.itemsField.push(U)}b.pField.push(h)}});return b}catch(b){throw Ba.a.J(512493792,820,50,"WebSocketTextLayoutFetcher::GetWebTextBody Exception {0}",b.message),Error.create("GetWebTextBodyException");
}}K5f(a){const b=new xp;b.bField=a.isBold;b.bFieldSpecified=a.qTa;b.iField=a.isItalic;b.iFieldSpecified=a.m$a;b.uField=a.dE;b.uFieldSpecified=a.pxb;b.strikeFieldSpecified=a.oxb;b.strikeField=a.KF;b.szField=a.fontSize*ff.a.plc*ff.a.v$a;b.szFieldSpecified=a.Ata;b.baselineFieldSpecified=a.Sa(X.a.gN);b.baselineField=a.eb(X.a.gN);b.capFieldSpecified=a.rTa;b.capField=a.capitalization;if(a.$9f){const c=Fa.a.ue(a.language);b.langField=c?c.ovb:"en-US"}a.Sa(X.a.latinFont)&&(b.latinField=Object.assign(new Zl,
{typefaceField:a.eb(X.a.latinFont)}));a.Sa(X.a.eastAsianFont)&&(b.eaField=Object.assign(new Zl,{typefaceField:a.eb(X.a.eastAsianFont)}));a.C3&&(b.rawSolidFillField=Object.assign(new Mu.a,{srgbClrField:Object.assign(new tw.a,{valField:hb.a.Irb(a.fontColor)})}));a.wTa&&(b.highlightField=Object.assign(new to.a,{srgbClrField:Object.assign(new tw.a,{valField:hb.a.Irb(a.highlight)})}));a.Sa(X.a.Gsb)&&(b.spcField=a.eb(X.a.Gsb),b.spcFieldSpecified=!0);a.Sa(X.a.Tzb)&&(b.kernField=a.eb(X.a.Tzb),b.kernFieldSpecified=
!0);return b}Qkj(a){const b=new xp;b.bField=a.isBold;b.bFieldSpecified=!0;b.iField=a.isItalic;b.iFieldSpecified=!0;b.uField=a.dE;b.uFieldSpecified=!0;b.strikeFieldSpecified=!0;b.strikeField=a.KF;b.szField=a.zaa*ff.a.plc;b.szFieldSpecified=!!b.szField;const c=Fa.a.ue(a.BSa());b.langField=c?c.ovb:"en-US";a.Sa(X.a.latinFont)&&(b.latinField=Object.assign(new Zl,{typefaceField:a.eb(X.a.latinFont)}));a.Sa(X.a.eastAsianFont)&&(b.eaField=Object.assign(new Zl,{typefaceField:a.eb(X.a.eastAsianFont)}));b.baselineField=
a.gN;b.baselineFieldSpecified=!0;return b}F1j(a){if(a){Ba.a.J(512493790,820,50,lh.c(a));var b=new Map;for(let m in a){var c=m,h=a[m];"First"===c&&b.set(c,h.toString());"Telemetry"===c&&b.set(c,JSON.stringify(h))}Mf.Health.instance.recordKpiUsage("TextLayoutServiceResponse",0,"pptotext",b)}else Ba.a.J(512493791,820,50,"response data null")}E1j(a){a?Ba.a.J(512493788,820,50,"Dark Traffic"+lh.c(a)):Ba.a.J(512493789,820,50,"Dark Traffic response data null")}$1g(){this.Ise=!0}tZf(a){var b=this.jq.presentation;
if(!b)throw Error.argumentNull("Presentation is null");const c=this.jlb(a,"cid"),h=this.jlb(a,"sid");a=this.jlb(a,"shapeId");if(!c||!h||!a)return Ba.a.J(512493787,820,50,"GetCurrentShapeNode - slideId or shapeId is not present in Hints"),null;b=Object(ua.a)(116,b.lC(lc.a.PE(Number.parseInvariant(h),Number.parseInvariant(c))));return b?b.eT(Number.parseInvariant(a)):(Ba.a.J(512493786,820,50,"GetCurrentShapeNode - ISlide is null"),null)}Ptk(a){if(!a||!a.l||!a.h)if(a&&7===a.resp&&a.h)Ba.a.J(512493785,
820,50,"OnTextLayoutReceived - State out of sync"),(a=this.tZf(a.h))?this.C1d(a,!0):Ba.a.J(512493784,820,10,"OnTextLayoutReceived - shapenode null");else{if(Ba.a.J(512493783,820,50,"OnTextLayoutReceived - Response data layout is null"),a&&!a.l){var b=new Map;b.set("CorrelationId",a.corr);4===a.resp?Mf.Health.instance.recordKpiFailure("TextLayoutServiceResponse","TextLayoutServiceWorkerFailure",!1,!0,Object.assign(new ql.a,{extendedProperties:b})):(b.set("ResponseCode",a.resp.toString()),Mf.Health.instance.recordKpiFailure("TextLayoutServiceResponse",
"TextLayoutServiceFailureResponse",!1,!0,Object.assign(new ql.a,{extendedProperties:b})))}}else if(this.la.pNb){b=this.jlb(a.h,"timeoutId");var c=this.jlb(a.h,"firstRequest");if(b&&-1!==this.uU&&this.uU===Number.parseInvariant(b))window.clearTimeout(this.uU),this.uU=-1;else if(!c||!Boolean.parse(c))return;if(b=this.tZf(a.h)){var h=this.jlb(a.h,"initialTextLayout");c&&Boolean.parse(c)?h&&h!==a.l.toString()?(c=new Map,c.set("CorrelationId",a.corr),c.set("ResponseCode",a.resp.toString()),c.set("InitialTextLayoutValue",
h),c.set("ResponseLayout",a.l.toString()),Mf.Health.instance.recordKpiFailure("TextLayoutServiceResponse","ResponseMismatchForFirstShapeRequest",!1,!0,Object.assign(new ql.a,{extendedProperties:c})),Ba.a.J(512493781,820,50,"Fallback to HTML Text Layout for this shape - different service response on begin edit."),b.wlb(!1)):b.wlb(!0):(h=this.jlb(a.h,"reqHash"))?(c=this.Z9d(b),Ar.a.Bvb(dd.c(c))!==h?Ba.a.J(512493779,820,50,"OnTextLayoutReceived - Response hash doesn't match the current shapetextbody"):
(this.Oeb&&this.Oeb.N7k(h,a.l,b),b.Mtd(a.l))):Ba.a.J(512493780,820,50,"OnTextLayoutReceived - missing request hash")}else Ba.a.J(512493782,820,50,"OnTextLayoutReceived - IShapeNode is null")}}jlb(a,b){return b in a?a[b].toString():null}}Dr.rYj="CT_TextSpacingPercent:#Microsoft.Office.Server.Powerpoint.Interface.Edit";Dr.XHc=1440;Object(n.a)(Dr,"TextLayoutManager",null,[1257]);var rs;(function(a){a[a.noWall=0]="noWall";a[a.coauth=1]="coauth";a[a.lineBreakBlobs=2]="lineBreakBlobs";a[a.table=3]="table";
a[a.smartArt=4]="smartArt";a[a.nonRectShape=5]="nonRectShape"})(rs||(rs={}));Object(n.b)("TextLayoutWall",rs);var jy=d(860);class Ew{constructor(a,b){this.Kwe=new Nd.a(0);if(!a)throw Error.argumentNull("coauthManager");if(!b)throw Error.argumentNull("applicationSettings");this.HVa=a;this.Uea=b.NAh}F$b(a){switch(a){case 1:return!!this.Uea.COAUTH;case 2:return!!this.Uea.LINEBREAKBLOBS;case 3:return!!this.Uea.TABLE;case 4:return!!this.Uea.SMARTART;case 5:return!!this.Uea.NONRECTSHAPE}return!1}Kni(){return!this.F$b(1)||
this.HVa.ADa}iri(a,b){return a?this.F$b(2)&&jy.a.sSf(a,b)?2:this.F$b(3)&&a.ud?3:this.F$b(4)&&a.Rf?4:this.F$b(5)&&4!==a.KK?5:0:0}Vqi(a,b){b=this.iri(a,b);if(!this.Kwe.Hb(a.RLa)||this.Kwe.ga(a.RLa)!==b){const c=new Map;c.set("ShapeType",a.get_shapeTypeString());c.set("ShapeId",a.RLa.toString());c.set("IsShapeWalled",rs[b]);Mf.Health.instance.recordKpiUsage("TextLayoutServiceBlockedShapes",0,"pptotext",c);0!==b&&(c.set("TextLayoutWall",rs[b]),Mf.Health.instance.recordKpiFailure("TextLayoutServiceBlockedShapes",
"TextLayoutClientWall",!1,!0,Object.assign(new ql.a,{extendedProperties:c})))}this.Kwe.$(a.RLa,b);return b}}Object(n.a)(Ew,"TextLayoutServiceWalls",null,[1256]);class Ru{constructor(a,b,c,h){this.lq=a;this.Re=b.Ma;this.pO=c;this.A5c=h}initialize(){this.lq.lPa(Object(F.a)(this,this.xtf,"adjustShapeViews"))}dispose(){this.lq.AJb(Object(F.a)(this,this.xtf,"adjustShapeViews"))}xtf(a,b){if((a=b.iG)&&a.Fd&&(a=a.Fd.s3(c=>c.isEditable&&c.IQ))&&a.length)for(const c of a)if(a=Object(ua.a)(117,c.tg(this.Re)))a.jHh(),
c.ud&&a.Tn&&a.nAl(),!this.A5c||this.pO&&!b.g_c||a.ZN||!a.XA||a.azh()}}Object(n.a)(Ru,"TextLocalRenderAdjustManager",null,[106]);class Su{constructor(){this.rhc=this.ADb=null;this.$rg=-1;this.Jbc=Date.now()}B9f(){return 0<=this.$rg}}Object(n.a)(Su,"LineBreakComparison",null,[]);class Fw{constructor(a){this.kH=new Nd.a;this.EDg=0;this.qzf="TextLayoutServiceAccuracy";this.bhc=a}M7k(a,b){try{if(a&&b){var c=a.WD(),h=Ar.a.Bvb(dd.c(b.Z9d(a)));if(!(0>c.length)){b=[];for(let m=0;m<c.length;m++){const y=vg.a.ui(c[m],
X.a.oNb,null);y&&(b.push.apply(b,y.Lines),b.push(-1))}if(b.length){if(!this.kH.Hb(h))this.kH.add(h,new Su);else if(this.kH.ga(h).B9f())return;this.kH.ga(h).ADb=b;this.kFf(h,a)}}}}catch(m){Ba.a.J(512493704,820,10,m.message)}}N7k(a,b,c){try{if(!this.kH.Hb(a))this.kH.add(a,new Su);else if(this.kH.ga(a).B9f())return;this.kH.ga(a).rhc=b;this.kFf(a,c)}catch(h){Ba.a.J(512493703,820,10,h.message)}}kFf(a,b){if(this.kH.ga(a)&&this.kH.ga(a).ADb&&this.kH.ga(a).rhc){var c=!0;if(this.kH.ga(a).ADb.length!==this.kH.ga(a).rhc.length)c=
!1;else for(var h=0;h<this.kH.ga(a).ADb.length;h++)if(this.kH.ga(a).ADb[h]!==this.kH.ga(a).rhc[h]){c=!1;break}Ba.a.J(512493702,820,50,JSON.stringify({["UniFiedResponseMatchWithLayoutServiceResponse"]:c}));h=new Map;h.set("UniFiedResponseMatchWithLayoutServiceResponse",String.format("{0}",c));b=0<=b.$ca().indexOf("\u00a0");h.set("HasNoBreakSpace",b.toString());Mf.Health.instance.recordKpiUsage(this.qzf,0,"pptotext",h);c||(h.set("UnifiedResponseLineCount",this.kH.ga(a).ADb.length.toString()),h.set("TextLayoutResponseLineCount",
this.kH.ga(a).rhc.length.toString()),Mf.Health.instance.recordKpiFailure(this.qzf,"TextLayoutServiceResponseMismatchWithUnifiedResponse",!1,!0,Object.assign(new ql.a,{extendedProperties:h})));this.kH.ga(a).$rg=Date.now()}this.xri()}xri(){const a=Date.now();a-this.EDg<this.bhc||(this.kH.keys.forEach(b=>{a-this.kH.get(b).Jbc>this.bhc&&this.kH.remove(b);return!0}),this.EDg=a)}}Object(n.a)(Fw,"ServiceComparisonLineBreakTelemetry",null,[1258]);class ss{constructor(){this.K=null}get name(){return"PowerPointWebEditor.TextEditing"}$b(a){this.K=
a;this.K.register(Lu,"PowerPointWebEditor.TextEditingRevisionInfoTracker").as("PowerPointWebEditor.ITextEditingRevisionInfoTracker").as("PowerPointWebEditor.ITextEditingRevisionInfoReader").ma().oa(()=>new Lu(!a.resolve("Common.IAppSettingsManager").ka("DataSyncUseFluid")));this.K.register(vt,"PowerPointWebEditor.ShapeViewElementTextEditHandler").ma().oa(()=>new vt(a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),a.Ja("PowerpointPresence.ICoauthStateChangesHandler"),a.resolve("PowerPointWebEditor.Proofing.IProofingBehaviorController"),
a.resolve("PowerPointWebEditor.ITablePartialEditController"),a.resolve("PowerPointWebEditor.BootStorage.ICoreOutboundHelper"),a.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoManager"),a.resolve("PowerPointWebEditor.IGraphUpdateStrategy"),a.resolve("Box4.IEditingView"),a.resolve("PowerPointWebEditor.IApplicationSettings").skipProofingSaveWithNoEditHappened,a.Ja("PowerPointWebEditor.ISessionLifetimeManager")));this.K.register(Ru,"PowerPointWebEditor.TextLocalRenderAdjustManager").ma().oa(()=>new Ru(a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),
a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IApplicationSettings").pptLayoutThrashingFixEnabled,a.resolve("PowerPointWebEditor.IApplicationSettings").zfg));const b=a.resolve("PowerPointWebEditor.IApplicationSettings").KAh;Ba.a.J(590444175,820,50,"PPTWebEditorTextEditingPackage::Configure TextLayoutEnabled:{0}",b);b&&(this.K.register(1256,"PowerPointWebEditor.ITextLayoutServiceWallManager").ma().oa(()=>new Ew(a.resolve("PowerPointWebEditor.CoauthManager"),a.resolve("PowerPointWebEditor.IApplicationSettings"))),
this.K.register(1257,"PowerPointWebEditor.ITextLayoutManager").ma().oa(()=>{try{return new Dr(a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),u.AFrameworkApplication.Je,a.resolve("PowerPointWebEditor.ITextLayoutServiceWallManager"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.Ja("PowerPointWebEditor.ITextLayoutLineBreakTelemetry"),a.resolve("PowerPointWebEditor.Graph.IPPTLineSpacingHelper"))}catch(c){return Ba.a.J(593892503,820,
10,"PPTWebEditorTextEditingPackage::Configure Exception creating TextLayoutManager: "+c),null}}),this.K.resolve("PowerPointWebEditor.ITextLayoutManager"),this.K.register(1258,"PowerPointWebEditor.ITextLayoutLineBreakTelemetry").ma().oa(()=>new Fw(this.K.resolve("PowerPointWebEditor.IApplicationSettings").ppl)),this.K.resolve("PowerPointWebEditor.ITextLayoutLineBreakTelemetry"))}init(){this.K.resolve("PowerPointWebEditor.ITextEditingRevisionInfoTracker");this.K.resolve("PowerPointWebEditor.ShapeViewElementTextEditHandler");
this.K.resolve("PowerPointWebEditor.TextLocalRenderAdjustManager").initialize()}dispose(){const a=this.K.resolve("PowerPointWebEditor.IApplicationSettings");this.K.resolve("PowerPointWebEditor.ShapeViewElementTextEditHandler").dispose();a.zfg&&this.K.resolve("PowerPointWebEditor.TextLocalRenderAdjustManager").dispose()}static main(){r.a.instance.Dc(new ss)}}Object(n.a)(ss,"PPTWebEditorTextEditingPackage",null,[2,3]);class Tu{constructor(){this.capabilities=2}}Object(n.a)(Tu,"IExternalPeopleAPI",null,
[]);class ky{constructor(a,b){this.OperationResult=a;this.Details=b}}Object(n.a)(ky,"ExternalGrantAccessResponse",null,[]);class Uu{constructor(a,b,c,h){this.authorImageURL=this.authorColor=this.authorID=this.authorName=null;this.authorName=a;this.authorID=b;this.authorColor=c;this.authorImageURL=h}}Object(n.a)(Uu,"PersonaIconProperties",null,[]);var Gw=d(913),yp=d(659),ly=d(523);class Vu extends Tu{constructor(a,b,c,h,m){super();this.MV=a;this.qXh=b;this.waf=c;this.fMh=m}Q7g(a){this.MV.eya=a}atMentionsEnabledAsync(){return new Promise((a,
b)=>{this.MV.ueg.continueWith(c=>{c.Sn||c.rm?(ba.ULS.sendTraceTag(39068098,380,10,"AtMentionsEnabledAsync failed"),b(yp.a.vu(-2130915318))):a(this.MV.ueg.result)})})}checkUserAccess(a){return new Promise((b,c)=>{const h=this.MV.checkUserAccess([a]);h.continueWith(m=>{m.Sn||m.rm?(ba.ULS.sendTraceTag(36287067,380,10,"PeopleManager CheckUserAccess Failed"),c(yp.a.vu(-2130915318))):b(h.result.Result[0])})})}grantUsersAccess(a){ba.ULS.sendTraceTag(37582727,380,15,"PeopleManager CheckUserAccessAndGrantPermissions usage");
return new Promise((b,c)=>{const h=this.MV.ZBa(a);h.continueWith(m=>{if(m.Sn||m.rm)ba.ULS.sendTraceTag(36287068,380,10,"PeopleManager CheckUserAccessAndGrantPermissions Failed"),c(yp.a.vu(-2130915318));else{m=h.result;var y=!m.Canceled;for(var G of m.Result)if(!G.UserCanWrite&&!G.UserCanReview){y=!1;break}G=new ky(y,m);b(G)}})})}getContactsForMentions(a,b,c){return new Promise((h,m)=>{const y=this.MV.getUserContacts(a,b,0,c,"AtMentions");y.continueWith(G=>{G.Sn||G.rm?(ba.ULS.sendTraceTag(36287069,
380,10,"PeopleManager GetUserContacts Failed"),m(yp.a.vu(-2130915318))):h(y.result)})})}getAuthToken(){ba.ULS.sendTraceTag(539100293,380,15,"PeopleManager GetAuthToken usage");return new Promise((a,b)=>{this.waf.continueWith(c=>{c.Sn||c.rm?(ba.ULS.sendTraceTag(51658781,380,10,"getLokiTokenManagerTask Failed"),b(yp.a.vu(-2130915318))):this.waf.result.Uaj().then(h=>{h.isSuccess&&h.token&&0<h.token.length?(ba.ULS.sendTraceTag(539100294,380,15,"PeopleManager GetAuthToken use AAD token"),a(h.token)):u.AFrameworkApplication.fa.Ha("LokiUserDataSignature")?
(ba.ULS.sendTraceTag(539100295,380,15,"PeopleManager GetAuthToken trying alternateauth token"),this.fMh.execute(m=>{m.R1i().then(y=>{void 0!==y&&null!==y&&0<y.length?(ba.ULS.sendTraceTag(544556298,380,15,"Using LokiUserDataSignature from AlternateAuthHelper"),a(y)):0<u.AFrameworkApplication.fa.Ha("LokiUserDataSignature").length&&(ba.ULS.sendTraceTag(544556299,380,15,"Using boot LokiUserDataSignature since fail to get one from AlternateAuthHelper"),a(u.AFrameworkApplication.fa.Ha("LokiUserDataSignature")))})})):
h.isSuccess?h.token&&h.token.length||(ba.ULS.sendTraceTag(51658783,380,10,"Token is null: {0}",JSON.stringify(h)),b(yp.a.vu(-2130915318))):(ba.ULS.sendTraceTag(51658782,380,10,"GetLokiToken Failed : {0}",JSON.stringify(h)),b(yp.a.vu(-2130915318)))}).catch(h=>{ba.ULS.sendTraceTag(51658784,380,10,"Unexpected exception received from lokiTokenManager: {0}",JSON.stringify(h));b(yp.a.vu(-2130915318))})})})}getPersonaIconPropertiesArray(a){return new Promise(b=>{const c=[];for(const m of a){let y=null;var h=
m;let G=m.Email;G&&""!==G||!m.UserId||""===m.UserId||"AD"!==m.Provider||(G=ly.a.h8a(m.UserId));G&&""!==G&&(y=this.MV.R0b(G,m.Provider,u.AFrameworkApplication.jh,0),h=new Gw.a(G,void 0,m.DisplayName));h=this.qXh.hEa(h,2);Array.add(c,new Uu(m.DisplayName,m.UserId,h,y))}b(c)})}}Object(n.a)(Vu,"ExternalPeopleAPI",Tu,[]);class Wu{constructor(){this.n5a={};this.gnb={};this.lFd={}}get(a){let b=null;const c=this.normalize(a.DisplayName);a.UserId&&a.UserId in this.n5a?(b=this.n5a[a.UserId],!c||c in this.gnb||
(this.gnb[c]=b)):c&&c in this.gnb&&(b=this.gnb[c],a.UserId&&(c in this.lFd?(delete this.lFd[c],this.n5a[a.UserId]=b):a.UserId in this.n5a||(b=null)));return b}add(a,b){a.UserId&&(this.n5a[a.UserId]=b);const c=this.normalize(a.DisplayName);!c||c in this.gnb||(this.gnb[c]=b,a.UserId||(this.lFd[c]=!0))}b4i(a){a=Array(a.yJc.length);for(var b=0;b<a.length;b++)a[b]=0;for(const c of Da.a.fL(this.n5a))b=this.n5a[c],b.sources.contains(1)&&a[b.wEf]++;return a}normalize(a){return a?a.toLowerCase():null}}Object(n.a)(Wu,
"ColorLookupDict",null,[]);class Xu{constructor(a,b){this.wEf=a;this.sources=new Qa.a;this.sources.add(b)}J6h(a){this.sources.contains(a)||this.sources.add(a)}}Object(n.a)(Xu,"ColorSource",null,[]);class ts{constructor(a){this.kQb=a;this.XLd=new Wu;this.Hef=-1;this.oMh=0}hEa(a,b,c=!0){if(!this.kQb||!this.kQb.yJc.length)return ba.ULS.sendTraceTag(37053532,380,10,"Color table is null or empty"),null;if(a.IsAnonymous)a.UserId=a.ClientId||a.UserId||this.R_i();else if(!a.UserId&&!a.DisplayName)return ba.ULS.sendTraceTag(37009498,
380,100,"GetUserColor: Both userId and displayName are null"),null;const h=this.XLd.get(a);if(h)c=h.wEf,h.J6h(b);else{if(!c)return null;c=this.ocj();this.XLd.add(a,new Xu(c,b));this.Hef=c}return this.h4i(this.kQb.yJc[c])}ocj(){const a=this.kQb.yJc.length,b=this.XLd.b4i(this.kQb),c=this.xbg(this.Hef,a);let h=c,m=!1;for(;h!==c||!m;)if(b[h])(h=this.xbg(h,a))||(m=!0);else break;m&&ba.ULS.sendTraceTag(37009497,380,50,"GetNextColorIndex: relooped the color table.");return h}xbg(a,b){return(a+1)%b}R_i(){return"anonymous"+
++this.oMh}h4i(a){return 16777215>=a?"#"+ta.a.dw((a&255)<<16|a&65280|(a&16711680)>>>16,6):null}}Object(n.a)(ts,"PeopleColorUtils",null,[1314]);class zt{constructor(a,b,c,h,m,y){this.veg=new rj.a;this.rqa=a;this.m5a=b;this.zof=h;this.$a=c;this.Gga=m;this.Dof=y;this.$a.jf(()=>{this.fullAppSettingsReady()})}fullAppSettingsReady(){const a=u.AFrameworkApplication.Alb||u.AFrameworkApplication.LQ,b=this.$a.ka("PeopleEndPointIsEnabled");let c=b&&!a&&(this.Nkc||this.RMb&&this.SMb);const h=this.$a.ka("DisableAtmentionsForTeams"),
m=this.$a.ka("ConsumerMentionsHostIsEnabled")||this.zof.Iyh;c=c&&m&&this.Gyh&&this.Fyh&&!h;this.$a.ka("ConsumerMentionsHostIsEnabled")&&(c=c&&this.$a.ka("OneDriveConsumerMentionsIsEnabled"));ba.ULS.sendTraceTag(37083014,380,50,"isAtMentionsEnabled:{0}, PeopleEndPointIsEnabled:{1}, PermissionsPostMessage:{2}, SupportsCheckUserAccess:{3}, SupportsGrantUserAccess:{4}, SupportsAddActivities:{5}, IsAnonymousUser:{6}, SupportsActivitiesNotification:{7}",c,b,this.Nkc,this.RMb,this.SMb,this.Gyh,a,this.Fyh);
this.veg.Fg(c);c&&this.Gga&&this.Gga.Dk(4,Object(F.a)(this,this.gGe,"onInteractiveReady"))}gGe(){const a=this.$a.Fc("NumberOfContactsToFetchOnBoot",100);0>=a||this.getUserContacts("",a,0,!1,"AtMentions").continueWith(b=>{(b.rm||b.Sn)&&ba.ULS.sendTraceTag(50402056,380,50,"Failed to prefetch contacts on boot")})}get RMb(){return this.m5a.RMb}get cle(){return this.Dof.cle}get SMb(){return this.m5a.SMb}get Nkc(){return this.m5a.Nkc}get Gyh(){return this.$a.ka("SupportsAddActivities")}get Fyh(){return this.$a.ka("SupportsActivitiesNotification")}ZBa(a){return this.m5a.ZBa(a)}E0b(a,
b){return this.m5a.E0b(a,b)}get ueg(){return this.veg.task}get eya(){return this.rqa.eya}set eya(a){this.rqa.eya=a}checkUserAccess(a){ba.ULS.sendTraceTag(37083015,380,50,"CheckUserAccess");return this.m5a.checkUserAccess(a)}grantUserAccess(a,b,c,h,m){return this.m5a.grantUserAccess(a,b,c,h,m)}getUserContacts(a,b,c,h,m){return this.zof.getUserContacts(a,b,c,h,m)}R0b(a,b,c,h){return this.Dof.R0b(a,b,c,h)}supportsExchangeRestApis(){const a=new rj.a,b=this.rqa.supportsExchangeRestApis();b.continueWith(()=>
{b.rm||b.Sn?a.Fg(!1):a.Fg(!0)});return a.task}}Object(n.a)(zt,"PeopleManager",null,[1313,1311]);var dq=d(374);class eq{}Object(n.a)(eq,"CheckUserAccessRequestItem",null,[]);class my extends dq.a{constructor(a,b,c){super(a,b);this.Users=null;this.Users=this.kWd(c)}kWd(a){const b=[];for(const c of a)Array.add(b,Object.assign(new eq,{Id:c.UserId,Provider:c.Provider}));return b}$k(){return 1}}Object(n.a)(my,"CheckUserAccessRequest",dq.a,[]);class Rq extends dq.a{constructor(a,b,c,h,m,y,G){super(a,b);
this.Filter=null;this.Skip=this.Limit=0;this.SearchGal=!1;this.Scenario=null;this.Filter=c;this.Limit=h;this.SearchGal=y;this.Skip=m;this.Scenario=G}$k(){return 2}}Object(n.a)(Rq,"GetUserContactsRequest",dq.a,[]);class Yu extends dq.a{constructor(a,b,c,h,m,y,G){super(a,b);this.Scenario=this.Users=null;this.GrantReviewAccess=this.GrantWriteAccess=this.GrantReadAccess=!1;this.Users=this.kWd(c);this.Scenario=h;this.GrantReadAccess=m;this.GrantWriteAccess=y;this.GrantReviewAccess=G}kWd(a){const b=[];
for(const c of a)Array.add(b,Object.assign(new eq,{Id:c.UserId,Provider:c.Provider}));return b}$k(){return 4}}Object(n.a)(Yu,"GrantUserAccessRequest",dq.a,[]);class Er extends dq.a{constructor(a,b){super(a,b)}$k(){return 5}}Object(n.a)(Er,"SupportsExchangeRestApisRequest",dq.a,[]);var At=d(522);class Bt{constructor(a,b,c,h){this.eya=null;this.PYh=a;this.P1a=b;this.$a=c;this.$1a=h}get kXk(){return this.$a.Fc("GetUserContactsRequestSentTimeoutMs",6E4)}checkUserAccess(a){if(!a||!a.length)return ba.ULS.sendTraceTag(37757202,
380,15,"no user in the request"),a=new rj.a,a.setException(Error.argumentNull("Can't pass empty list to checkUserAccess calls")),a.task;ba.ULS.sendTraceTag(37757203,380,50,"CheckUserAccess: num people:{0}",a.length);const b=new rj.a,c=this.$1a.execute(new my(this.P1a(),null,a),(h,m,y)=>this.QMc(h,m,y,"CheckUserAccess"),this.eya);c.continueWith(()=>{if(c.Sn||c.rm)b.lG(c.Zi);else{var h=this.pyk(c.result.Xi);b.Fg(h)}});return b.task}grantUserAccess(a,b,c,h,m){if(!a||!a.length)return ba.ULS.sendTraceTag(37757204,
380,15,"no user in the request"),a=new rj.a,a.Fg(null),a.task;ba.ULS.sendTraceTag(37757205,380,15,"GrantUserAccess: num people:{0}, scenario:{1}, read:{2}, write:{3}, review:{4}",a.length,b,c,h,m);const y=new rj.a,G=this.$1a.execute(new Yu(this.P1a(),null,a,b,c,h,m),(U,ja,va)=>this.QMc(U,ja,va,"GrantUserAccess"),this.eya);G.continueWith(()=>{if(G.Sn||G.rm)ba.ULS.sendTraceTag(37028121,380,15,"GetUserAccess: request failed: {0}",G.Zi),y.lG(G.Zi);else{var U=this.Rxk(G.result.Xi);y.Fg(U)}});return y.task}pyk(a){if(!a.data)return ba.ULS.sendTraceTag(24749450,
380,10,"CheckUserAccessResponse: Data is null"),null;if(!a.data.Zd)return ba.ULS.sendTraceTag(24749451,380,10,"CheckUserAccessResponse: ResponseData is null"),null;a=At.a.x7a(a.data.Zd);return a?a.Result?a.Result:(ba.ULS.sendTraceTag(24749453,380,10,"CheckUserAccessResponse: Result field is null."),null):(ba.ULS.sendTraceTag(24749452,380,10,"CheckUserAccessResponse: Failed parsing the response"),null)}Rxk(a){if(!a.data)return ba.ULS.sendTraceTag(33645598,380,10,"GrantUserAccessResponse: Data is null"),
null;if(!a.data.Zd)return ba.ULS.sendTraceTag(33645599,380,10,"GrantUserAccessResponse: ResponseData is null"),null;a=At.a.x7a(a.data.Zd);return a?a.Result?a.Result:(ba.ULS.sendTraceTag(33645601,380,10,"GrantUserAccessResponse: Result field is null."),null):(ba.ULS.sendTraceTag(33645600,380,10,"GrantUserAccessResponse: Failed parsing the response"),null)}getUserContacts(a,b,c,h,m){const y=new rj.a,G=this.$1a.execute(new Rq(this.P1a(),null,a,b,c,h,m),(U,ja,va)=>this.QMc(U,ja,va,"GetUserContacts"),
this.eya);G.continueWith(()=>{if(G.Sn||G.rm)y.lG(G.Zi);else{var U=G.result;try{const ja=this.oyk(U.Xi);y.Fg(ja.Result)}catch(ja){y.lG(ja)}}});return y.task}oyk(a){if(!a.data)throw Error.create("ParseUserContactsFromResponse: Data is null");if(!a.data.Zd)throw Error.create("ParseUserContactsFromResponse: ResponseData is null");a=At.a.x7a(a.data.Zd);if(!a)throw Error.create("ParseUserContactsFromResponse: Failed parsing the response");if(!a.Result)throw Error.create("ParseUserContactsFromResponse: Result field is null.");
return a}supportsExchangeRestApis(){const a=new rj.a,b=this.$1a.execute(new Er(this.P1a(),null),(c,h,m)=>this.QMc(c,h,m,"SupportsExchangeRestApisRequest"),this.eya);b.continueWith(()=>{b.Sn||b.rm?(a.lG(b.Zi),ba.ULS.sendTraceTag(50657307,380,50,"SupportsExchangeRestApis: false")):(ba.ULS.sendTraceTag(50657308,380,50,"SupportsExchangeRestApis: true"),a.HM(!0))});return a.task}QMc(a,b,c,h){return this.PYh.vqb(a,2,c,b,2,h,null,!1,null,this.kXk)}}Object(n.a)(Bt,"PeopleRequestHandler",null,[1312]);class Hw{constructor(a,
b){this.MV=a;this.Ca=b;this.Ca.ya(H.a.bri,he.a.frame,Object(F.a)(this,this.Xqi,"checkUserAccessAction"));this.Ca.ya(H.a.dmj,he.a.frame,Object(F.a)(this,this.cmj,"getUserContactsAction"));this.Ca.ya(H.a.ari,he.a.frame,Object(F.a)(this,this.Zqi,"checkUserAccessAndGrantPermissionsAction"));this.Ca.ya(H.a.hmj,he.a.frame,Object(F.a)(this,this.gmj,"getUserProfilePictureAction"));this.Ca.ya(H.a.Fml,he.a.frame,Object(F.a)(this,this.Gml,"supportsExchangeRestApisTestAction"))}Gml(){this.supportsExchangeRestApis();
return 32}Xqi(){const a=prompt("Check User Access:Enter user names separated by ;");this.checkUserAccess(a);return 32}cmj(){const a=prompt("Get user contacts:filter;limit;skip;searchGal");this.getUserContacts(a);return 32}Zqi(){const a=prompt("CheckUserAccessAndGrantPermissions PostMessage: u1;u2;u3");this.ZBa(a);return 32}gmj(){const a=prompt("Get user profile picture: userid;provider;dimension (e.g 48, 64, 96)");this.p6f(a);return 32}Wlh(){const a=prompt("What's the operation you want to do:\r\n1) Check User Access \r\n2) Grant user access \r\n3) Check User Access And Grant Permissions \r\n4) GetUserContacts \r\n5) Get User Profile Picture \r\n6) SupportsExchangeRestApis \r\n7) Exit");
try{switch(a){case "1":this.checkUserAccess(prompt("Check User Access: u1;u2;u3"));break;case "2":this.grantUserAccess();break;case "3":this.ZBa(prompt("CUAGP: u1;u2;u3"));break;case "4":this.getUserContacts(prompt("Get User Contacts:filter;limit;skip;searchGal"));break;case "5":this.p6f(prompt("Get User profile picture:userid;provider;dimension;"));break;case "6":this.supportsExchangeRestApis();break;case "7":return}}catch(b){alert(b.message)}Ge.Task.delay(5E3).continueWith(()=>{this.Wlh()})}o_k(){window.setTimeout(Object(F.a)(this,
this.Wlh,"runOperations"),1E4)}supportsExchangeRestApis(){const a=this.MV.supportsExchangeRestApis();a.continueWith(b=>{if(b.rm)alert("Exception: "+b.Zi.message);else{b=a.result;var c=new Rf.StandardDialog;c.xd=0;c.Xe(1,"Close");document.createElement("pre").innerText=b.toString();c.Bx("SupportsExchangeRestApis check returned",b.toString(),3,null)}})}p6f(a){a=a.split(";");const b=a[0],c=a[1];a=a[2];let h;try{h=this.V6i(a)}catch(m){alert("Invalid dimension value");return}vb.a.instance.Ja("Common.App.People.IPeopleManager").execute(m=>
{var y=m.R0b(b,c,u.AFrameworkApplication.jh,h);m=document.createElement("img");m.src=y;y=new Rf.StandardDialog;y.xd=0;y.Xe(1,"Close");y.Bx("Profile photo",null,3,null,m)})}V6i(a){if(!a)return 0;switch(a){case "48":return 1;case "64":return 2;case "96":return 3;case "120":return 4;case "240":return 5;case "360":return 6;case "432":return 7;case "504":return 8;case "default":return 0;default:throw Error.argumentOutOfRange("unknown dimension");}}checkUserAccess(a){a=a.split(";");a=this.MV.E0b(a,"O365");
const b=this.MV.checkUserAccess(a);b.continueWith(c=>{if(c.rm)alert("Exception: "+c.Zi.message);else{var h=b.result;c="";for(var m of h.Result)c+=m.Id+"=>"+(m.UserCanWrite?"Write":"No Write")+"\r\n";m=new Rf.StandardDialog;m.xd=0;m.Xe(1,"Close");h=document.createElement("pre");h.innerText=c;m.Bx("Check User Access Results",null,3,null,h)}})}grantUserAccess(){var a=prompt("GRANT_USER_ACCESS\n\nEnter semicolon-separated user names.\n\nInclude CantGrant or NotExist in names to return CannnotGrantPermission and UserDoesNotExist on Blue Chicken.\n");
const b=prompt("Enter scenario (mention or share):"),c=prompt("Enter the list of permissions to grant (e.g. Read Write Review).");a=a.split(";");a=this.MV.E0b(a,"O365");const h=0<=c.toUpperCase().indexOf("READ"),m=0<=c.toUpperCase().indexOf("WRITE"),y=0<=c.toUpperCase().indexOf("REVIEW"),G=this.MV.grantUserAccess(a,b,h,m,y);G.continueWith(U=>{if(U.rm)alert("Exception: "+U.Zi.message);else{U=G.result;var ja="RESULTS OF GRANT_USER_ACCESS CALL\n==========================\nScenario: "+b+"\nRequested Permissions: "+
(h?"READ":"")+(m?h?" WRITE":"WRITE":"")+(y?h||m?" REVIEW":"REVIEW":"")+"\n==========================\n\n";for(const va of U.Result)ja+="User: "+va.Id+"\nMessage: "+va.Message+"\nStatus Code: "+va.Status+"\nProvider: "+va.Provider+"\n\n";alert(ja)}})}getUserContacts(a){var b=a.split(";");a=0<b.length?b[0]:"";var c=2<b.length?b[2]:"0",h=3<b.length?b[3]:"false";b=Number.parseInvariant(1<b.length?b[1]:"10");c=Number.parseInvariant(c);h=Boolean.parse(h);const m=this.MV.getUserContacts(a,b,c,h,"AtMentions");
m.continueWith(y=>{if(y.rm)alert("Something went wrong"+y.Zi.message);else if(y.Sn)alert("Task was canceled");else{var G=m.result;y="";for(var U of G)G="ID => "+U.Id+" \n",G+="Provider => "+U.Provider+" \n",G+="DisplayName => "+U.DisplayName+" \n",G+="GivenName => "+U.GivenName+" \n",G+="Surname => "+U.Surname+" \n",G+="Email => "+U.Email+" \n",G+="Title => "+U.Title+" \n",y+=G+"----------------------\n";U=new Rf.StandardDialog;U.xd=0;U.Xe(1,"Close");G=document.createElement("pre");G.innerText=y;
U.Bx("Contacts",null,3,null,G)}})}ZBa(a){a=a.split(";");a=this.MV.E0b(a,"O365");const b=this.MV.ZBa(a);b.continueWith(c=>{if(c.rm)alert("Exception: "+c.Zi.message);else{c=b.result;var h="";for(var m of c.Result){var y=[];Array.add(y,m.UserCanRead?"Read YES":"Read NO");Array.add(y,m.UserCanReview?"Review YES":"Review NO");Array.add(y,m.UserCanWrite?"Write YES":"Write NO");y=m.Id+"=>"+y.join(" | ");h+=y+"\r\n"}m=new Rf.StandardDialog;m.xd=0;m.Xe(1,"Close");c=h+"\r\nDialog Canceled="+c.Canceled;h=document.createElement("pre");
h.innerText=c;m.Bx("Check User Access And Grant Permissions Post GrantUserAccessPrompt Results",null,3,null,h)}})}}Object(n.a)(Hw,"PeopleTestHook",null,[]);var Ct=d(210);class Iw{constructor(a,b,c){this.Id=a;this.Persons=b;this.UserPermissionsVerified=c}}Object(n.a)(Iw,"ShowSharingUiRequestBody",null,[]);class Fr{constructor(a,b){this.J4a=null;this.lCc=new rj.a;this.aWb=new Iw(this.TDi(),a,b);ba.ULS.sendTraceTag(25036160,380,50,"Creating request with {0} persons and UserPermissionsVerified {1}",this.aWb.Persons?
this.aWb.Persons.length:0,this.aWb.UserPermissionsVerified)}get HYk(){return this.lCc.task}get id(){return this.aWb.Id}get payload(){return this.aWb}H8k(a){this.J4a=a;this.lDl()?this.lCc.HM(this.J4a):this.lCc.lG(Error.format("Format of the "+gf.a.ATd+" body is not valid"))}setException(a){ba.ULS.sendTraceTag(37515586,380,10,"message:{0}",a.message);this.lCc.lG(a)}TDi(){return Fr.$Rh++}mDl(a){if(void 0===a.Id)return ba.ULS.sendTraceTag(25036161,380,10,"Persons.Id field is missing from the postmessage showSharingUiResponse of the host"),
!1;if(void 0===a.Provider)return ba.ULS.sendTraceTag(25036162,380,10,"Persons.Provider field is missing from the postmessage showSharingUiResponse of the host"),!1;void 0===a.Reason&&(ba.ULS.sendTraceTag(25036163,380,50,"Persons.Reason field is missing from the postmessage showSharingUiResponse of the host"),a.Reason=null);return void 0===a.Status?(ba.ULS.sendTraceTag(25036164,380,10,"Person.Status field is undefined"),!1):ta.a.bzb(a.Status)?!0:(ba.ULS.sendTraceTag(25036165,380,10,"Person.Status field is not a number"),
!1)}lDl(){if(void 0===this.J4a.Persons)return ba.ULS.sendTraceTag(25036166,380,10,"Persons field is missing from the postmessage showSharingUiResponse of the host"),!1;if(!Ma.a.isArray(this.J4a.Persons))return ba.ULS.sendTraceTag(25036167,380,10,"Persons field is not an array"),!1;for(let a=0;a<this.J4a.Persons.length;a++)if(!this.mDl(this.J4a.Persons[a]))return!1;return void 0===this.J4a.DialogCanceled?(ba.ULS.sendTraceTag(25036168,380,10,"DialogCanceled field is missing from the postmessage showSharingUiResponse of the host"),
!1):void 0===this.id?(ba.ULS.sendTraceTag(25036169,380,10,"Id field is undefined"),!1):ta.a.bzb(this.id)?!0:(ba.ULS.sendTraceTag(25036170,380,10,"ID field is not a number"),!1)}}Fr.$Rh=0;Object(n.a)(Fr,"PostmessageRequestState",null,[]);class us{constructor(a){this.YHd=new Ct.a;this.CSb=this.S2a=null;this.Vbf=!1;this.oNa=a}eBj(){ba.ULS.sendTraceTag(25036171,380,50,"ShowSharingUiPostMessageHandler.InitAsync");if(this.CSb)return this.CSb.task;this.CSb=new rj.a;this.oNa.continueWith(()=>{ba.ULS.sendTraceTag(25036172,
380,50,"hostPostMessenger Resolved successfully");this.S2a=this.oNa.result;this.yce();this.CSb.Fg(!0)});return this.CSb.task}yce(){this.Vbf||(ba.ULS.sendTraceTag(25190624,380,50,"InitHostPostmessenger"),this.Vbf=!0,this.S2a.pu(gf.a.ATd),this.S2a.zB(gf.a.ATd,Object(F.a)(this,this.$qi,"checkUserAccessAndGrantPermissionsPostmessageReceived")))}$qi(a){if(a=a.Values)if(void 0===a.Id||null===a.Id)ba.ULS.sendTraceTag(25036176,380,15,"ResponseBodyTask ID is null or undefined",a.Id);else{var b=null;({value:b}=
this.YHd.Uf(a.Id)).returnValue?(ba.ULS.sendTraceTag(25036178,380,50,"Detected ResponseBodyTask for message id {0}",a.Id),b.H8k(a),this.YHd.remove(a.Id)):ba.ULS.sendTraceTag(25036177,380,15,"Response does not match any postmessageRequestState in the queue. ID:{0}",a.Id)}else ba.ULS.sendTraceTag(25036175,380,15,"Postmessage ResponseBodyTask is null")}Yqi(a,b){const c=new Fr(a,b);this.eBj().continueWith(()=>{const h=Eh.a.create().toString(),m=String.format("PostMessageId:{0}, CorrelationId:{1}",c.id,
h);ba.ULS.sendTraceTag(25036179,380,50,m);this.S2a.sendMessage(gf.a.ZBa,c.payload,h)||c.setException(Error.create("Failed to send the postmessage"));this.YHd.add(c.id,c)});return c.HYk}}Object(n.a)(us,"ShowSharingUiPostMessageHandler",null,[]);class Jw{}Object(n.a)(Jw,"GrantUserAccessResponse",null,[]);var Nh=d(80);class fp extends Sys.EventArgs{constructor(a,b,c,h){super();this.result=b;this.Ezk=a;this.uLa=c;this.scenario=h}}Object(n.a)(fp,"ShareAndNotifyEventArgs",Sys.EventArgs,[]);class Dt{static TBi(a){return Nh.a.gC(Dt.ro,
CommonUIStrings.l_ShareAndNotifyDialogText,a)}}Dt.ro="<span id='ShareAndNotifyDialogText' class='WACDialogSpan'>{0}</span> <br/> <br/> <span id='ShareAndNotifyDialogListOfUsers' class='WACDialogSpan'>{1}</span>";Object(n.a)(Dt,"ShareAndNotifyDialogHtml",null,[]);class vs extends Nh.a{constructor(a,b,c){super();this.XMa=!1;this.Oa=new bd.a;this.sXh=a;this.l2h=vs.DZi(a);this.Vv=b;this.zZ=c}T$h(a){this.Oa.addHandler("SNEK",a)}$We(){this.qg=Dt.TBi(this.l2h);this.xd=8;this.ig="ShareAndNotifyDialog";this.showDialog(CommonUIStrings.l_ShareAndNotifyDialogTitle,
Object(F.a)(this,this.Yal,"shareAndNotifyDialogResultHandler"));this.O5("ShareAndNotifyDialogTextId")}Rwa(){}dispose(){this.XMa||(super.dispose(),this.XMa=!0)}Yal(a){this.Oa.raiseEvent("SNEK",new fp(this.sXh,a,this.Vv,this.zZ))}static DZi(a){const b=new Sys.StringBuilder;for(const c of a)b.append(0<c.DisplayName.length?c.DisplayName:c.Id),b.append(", ");return b.toString().substring(0,b.toString().length-2)}}Object(n.a)(vs,"ShareAndNotifyDialog",Nh.a,[]);class Zu{constructor(a,b,c){this.Id=a;this.Provider=
b;this.DisplayName=c}}Object(n.a)(Zu,"ShowSharingUiRequestPerson",null,[]);class ws{constructor(a,b,c,h,m,y){this.rqa=a;this.$a=b;this.F_h=c;this.TV=h;this.jNh=m;this.Wd=y}get RMb(){return this.$a.ka("SupportsCheckUserAccess")}get SMb(){return this.$a.ka("SupportsGrantUserAccess")}get Nkc(){return this.$a.ka("PermissionsPostMessage")&&!this.$a.ka("CrossDocumentMessengerDisabled")&&this.jNh()}ZBa(a){const b=new rj.a;if(Ma.a.Wa(a))return b.Fg(this.TV.wQa([])),b.task;let c;const h=({zZb:c}=this.TV.K3e(a)).returnValue,
m=ws.rzi(h);0<h.length?this.Nkc?this.fgl(h,b,c,m):this.RMb&&this.SMb&&this.$We(m,b,"mention"):b.Fg(this.TV.wQa(a));return b.task}fgl(a,b,c,h){const m=Date.now();ba.ULS.sendTraceTag(37822867,380,15,"ShowHostSharingUi-Usage");const y=this.F_h.Yqi(h,c);c=new He.a(4,1,this.$a.Fc("GrantPermissionSharingDialogWatchdogInternal",12E4),Object(F.a)(this,this.checkToMakeSureDialogWasOpened,"checkToMakeSureDialogWasOpened"),100);this.Wd.Eb(c);c.customData=y;y.continueWith(G=>{if(G.rm)ba.ULS.sendTraceTag(36300673,
380,15,"CheckUserAccessAndGrantPermissions via PostMessage failed with exception. {0}",G.Zi?G.Zi.message:"No inner exception"),b.lG(G.Zi);else{G=y.result;this.TV.vxl(G);var U=this.TV.wQa(a);U.Canceled=G.DialogCanceled;b.Fg(U);ba.ULS.sendTraceTag(37791043,380,15,"CheckUserAccessAndGrantPermissions finished in {0}ms",Date.now()-m)}})}checkToMakeSureDialogWasOpened(a){ba.ULS.sendTraceTag(37822868,380,15,"ShowHostSharingUi-WatchDog-Usage");(a=a.customData)?a.Sn?ba.ULS.sendTraceTag(37791045,380,10,"Show Sharing UI task is canceled"):
a.rm?ba.ULS.sendTraceTag(37791046,380,10,"Show Sharing UI task has faulted"):a.isCompleted||ba.ULS.sendTraceTag(37791047,380,10,"We have not got a response from host in long time"):ba.ULS.sendTraceTag(37791044,380,10,"Response of Sharing UI is null")}$We(a,b,c){a=new vs(a,b,c);a.T$h(Object(F.a)(this,this.dtk,"onShareAndNotify"));a.$We()}dtk(a,b){let c;const h=ws.vzi(b.Ezk);switch(b.result){case 1:this.grantUserAccess(h,b.scenario,!0,!0,!0).continueWith(m=>{m.rm?(ba.ULS.sendTraceTag(36300674,380,15,
"GrantUserAccess from OnShareAndNotify failed with exception. {0}",m.Zi?m.Zi.message:"No inner exception"),b.uLa.lG(m.Zi)):(ba.ULS.sendTraceTag(36300675,380,50,"GrantUserAccess from OnShareAndNotify succeeded."),c=this.TV.wQa(h),c.Canceled=!1,b.uLa.Fg(c))});break;default:ba.ULS.sendTraceTag(36300676,380,50,"User cancelled Share and Notify dialog"),c=this.TV.wQa(h),c.Canceled=!0,b.uLa.Fg(c)}}checkUserAccess(a){const b=new rj.a;if(!this.RMb)return ba.ULS.sendTraceTag(36300677,380,15,"Performing a CheckUserAccess call on a host that doesn't support the operation."),
b.setException(Error.invalidOperation("CheckUserAccess is not supported on this host")),b.task;if(!a||!a.length)return b.Fg(this.TV.wQa([])),b.task;let c;const h=({zZb:c}=this.TV.K3e(a)).returnValue;if(c)ba.ULS.sendTraceTag(36300680,380,50,"CheckUserAccess response populated from cache."),b.Fg(this.TV.wQa(a));else{const m=this.rqa.checkUserAccess(h);m.continueWith(()=>{if(m.Sn||m.rm)ba.ULS.sendTraceTag(36300678,380,10,"CheckUserAccess call failed."),b.setException(Error.create("CheckUserAccess Call failed."));
else{ba.ULS.sendTraceTag(36300679,380,50,"CheckUserAccess call succeeded.");var y=m.result;y&&this.TV.txl(y);y=this.TV.wQa(a);b.Fg(y)}})}return b.task}grantUserAccess(a,b,c,h,m){const y=new rj.a;if(!this.SMb)return ba.ULS.sendTraceTag(36300681,380,15,"Performing a GrantUserAccess call on a host that doesn't support the operation."),y.setException(Error.invalidOperation("GrantUserAccess is not supported on this host")),y.task;if(!a||!a.length)return y.Fg(this.TV.SHf([])),y.task;let G;const U=({zZb:G}=
this.TV.K3e(a)).returnValue;if(G)ba.ULS.sendTraceTag(36300684,380,50,"GrantUserAccess response populated from cache."),y.Fg(this.TV.SHf(a));else{const ja=this.rqa.grantUserAccess(U,b,c,h,m);ja.continueWith(()=>{if(ja.Sn||ja.rm)ba.ULS.sendTraceTag(36300682,380,10,"GrantUserAccess call failed."),y.setException(Error.create("GrantUserAccess Call failed."));else{ba.ULS.sendTraceTag(36300683,380,50,"GrantUserAccess call succeeded.");var va=ja.result;this.TV.uxl(va,c,h,m);va=Object.assign(new Jw,{Result:va});
y.Fg(va)}})}return y.task}E0b(a,b){const c=[];for(const h of a)c.push(new Gw.a(h,b));return c}static rzi(a){const b=[];for(const c of a)a=new Zu(c.UserId,c.Provider,""),b.push(a);return b}static vzi(a){const b=[];for(const c of a)a=new Gw.a(c.Id,c.Provider),b.push(a);return b}}Object(n.a)(ws,"UserAccessUtils",null,[1311]);class $u{constructor(a=null){a&&(this.Id=a.Id,this.Provider=a.Provider,this.Email=a.Email,this.DisplayName=a.DisplayName,this.GivenName=a.GivenName,this.Surname=a.Surname,this.Title=
a.Title)}}Object(n.a)($u,"PersonaProperties",null,[]);class Et{constructor(a,b){this.Clf=[];this.Xwd=[];this.wff=-1;this.$a=a;this.rqa=b}get Iyh(){return this.$a.ka("IsContactsResolutionEnabled")}getUserContacts(a,b,c,h,m){ba.ULS.sendTraceTag(37611683,380,15,"GetUserContacts: limit:{0}, searchGal:{1}, scenario:{2}",b,h,m);const y=new Map;y.set("Limit",b.toString());y.set("SearchGal",h.toString());y.set("Scenario",m);Mf.Health.instance.recordKpiUsageForAlertableKpi("PeopleEndPointGetUserContactsBrowser",
"wackpitesting",y);if(!this.Iyh)return ba.ULS.sendTraceTag(39145936,380,10,"Trying to get user contacts when hosts doesn't support it"),Mf.Health.instance.recordKpiFailure("PeopleEndPointGetUserContactsBrowser","TriedToGetUserContactsWhenHostDoesNotSupportIt",!0,!1,null),a=new rj.a,a.lG(Error.invalidOperation("People operations not supported by this host")),a.task;if(0>=b)return ba.ULS.sendTraceTag(39145937,380,10,"Limit should be > 0"),Mf.Health.instance.recordKpiFailure("PeopleEndPointGetUserContactsBrowser",
"LimitShouldBeGreaterThanZero",!1,!0,null),a=new rj.a,a.lG(Error.invalidOperation("Limit should be > 0")),a.task;"Unknown"===m&&ba.ULS.sendTraceTag(37611712,380,15,"Scenario Name was not specified");if(b<=this.wff&&!a&&!h)return a=new rj.a,c=this.Xwd.slice(0,Math.max(b-1,this.Xwd.length-1)),c=this.oYg(this.Clf,c),a.Fg(c),a.task;const G=new rj.a;let U;try{U=this.rqa.getUserContacts(a,b,c,h,m)}catch(ja){return G.lG(ja),G.task}if(h||"AtMentions"!==m)return U;U.continueWith(ja=>{if(ja.Sn||ja.rm){ja=ja.Sn?
"Canceled":ja.Zi.message;ba.ULS.sendTraceTag(39145938,380,10,"Failed to get contacts from host {0}",ja);var va=new Map;y.set("ErrorMessage",ja);va=Object.assign(new ql.a,{extendedProperties:va});Mf.Health.instance.recordKpiFailure("PeopleEndPointGetUserContactsBrowser","FailedToGetContactsFromHost",!1,!0,va);G.lG(Error.create(ja))}else this.Xwd=ja=U.result,this.wff=b,ja=this.oYg(this.Clf,ja),G.Fg(ja)});return G.task}oYg(a,b){if(!a&&!b)return[];if(!b)return a;if(!a)return b;const c={};a.forEach(h=>
{this.Hrf(h,c)});b.forEach(h=>{this.Hrf(h,c)});a=[];for(let h in c)Array.add(a,c[h]);return a}Hrf(a,b){if(a&&(a=new $u(a),a.Email&&a.DisplayName&&a.Id&&a.Provider)){const c=b[this.CIf(a)];c&&(a.Surname||(a.Surname=c.Surname),a.GivenName||(a.Surname=c.GivenName),a.Title||(a.Surname=c.Title));b[this.CIf(a)]=a}}CIf(a){return(a.Email+a.Provider).toLocaleLowerCase()}}Object(n.a)(Et,"UserContactsUtils",null,[1310]);class Kw{}Object(n.a)(Kw,"CheckUserAccessResponse",null,[]);class av{}Object(n.a)(av,"GrantUserAccessResponseItem",
null,[]);class bv{}Object(n.a)(bv,"UserPermissions",null,[]);class cn{constructor(){this.RM=new Jb.a;this.$Ye=0}K3e(a){let b;const c=[];if(!a)return ba.ULS.sendTraceTag(36299549,380,15,"UsersNotInCacheOrInCacheWithNoWriteOrReviewPermissions called with null people argument."),{returnValue:c,zZb:!1};if(!a.length)return ba.ULS.sendTraceTag(36299550,380,15,"UsersNotInCacheOrInCacheWithNoWriteOrReviewPermissions called with empty IPerson array."),{returnValue:c,zZb:!1};b=!0;const h={};for(const m of a){a=
cn.hWd(m);if(a in h)continue;h[a]=!0;const y=({value:a}=this.RM.Uf(cn.hWd(m))).returnValue;y&&(!a||a.UserCanWrite||a.UserCanReview)||Array.add(c,m);b=b&&y}return{returnValue:c,zZb:b}}txl(a){if(!a)throw Error.argumentNull("result");for(const b of a){if(void 0===b.Id||null===b.Id||!b.Id.length)throw Error.argument("item.Id");if(void 0===b.Provider||null===b.Provider||!b.Provider.length)throw Error.argument("item.Provider");this.RM.remove(cn.BKc(b));this.RM.add(cn.BKc(b),b)}}uxl(a,b,c,h){if(!a)throw Error.argumentNull("result");
for(const m of a){if(void 0===m.Id||null===m.Id||!m.Id.length)throw Error.argument("item.Id");if(void 0===m.Provider||null===m.Provider||!m.Provider.length)throw Error.argument("item.Provider");if(0===m.Status){const y=cn.iWd(m.Id,m.Provider);({value:a}=this.RM.Uf(y)).returnValue?(a.UserCanRead=b,a.UserCanWrite=c,a.UserCanReview=h):(a=Object.assign(new bv,{Id:m.Id,Provider:m.Provider,UserCanRead:b,UserCanWrite:c,UserCanReview:h}),this.RM.remove(y),this.RM.add(y,a))}}}vxl(a){if(!a)throw Error.argumentNull("showSharingUiResponse");
a=a.Persons;if(!a)throw Error.argumentNull("showSharingUiResponse.Persons");for(let b=0;b<a.length;b++){const c=new bv,h=a[b];if(void 0===h.Id||null===h.Id)throw Error.argument("showSharingUiRepsonePerson.Id");void 0===h.Status||null===h.Status?ba.ULS.sendTraceTag(25036183,380,15,"ShowSharingUiResponsePerson.Status is null or undefined"):(c.UserCanRead=h.Status===this.$Ye,c.UserCanWrite=h.Status===this.$Ye,c.UserCanReview=h.Status===this.$Ye,c.Id=h.Id,c.Provider=h.Provider,this.RM.remove(cn.BKc(c)),
this.RM.add(cn.BKc(c),c))}}o6f(a){const b=[];for(const c of a)a=cn.hWd(c),this.RM.Hb(a)&&Array.add(b,this.RM.ga(a));return b}wQa(a){a=this.o6f(a);return Object.assign(new Kw,{Result:a,Canceled:!1})}SHf(a){a=this.o6f(a);const b=[];for(const c of a)b.push(Object.assign(new av,{Id:c.Id,Provider:c.Provider,Message:"Success. User already exists in cache with requested permissions.",Status:0}));return Object.assign(new Jw,{Result:b,Canceled:!1})}static BKc(a){return cn.iWd(a.Id,a.Provider)}static hWd(a){return cn.iWd(a.UserId,
a.Provider)}static iWd(a,b){return b+a}}Object(n.a)(cn,"UserPermissionsCache",null,[1309]);class cv{constructor(a,b,c,h){this.rqa=a;this.$a=b;this.o2h=c;this.m2h=h}R0b(a,b,c,h){var m=this.rqa.eya;m=m?String.format("{0}/{1}",m,"people.ashx"):"people.ashx";m=new Vl.QueryStringBuilder(m);m.Ki("oid","3");m.Ki("bdqs",c);(c=this.jzi(h))&&2<=c.length&&(h=c[1],m.Ki("w",c[0]),m.Ki("h",h));m.Ki("uid",a);m.Ki("p",b);m.Ki("usid",this.o2h);m.Ki("WacUserType",this.m2h);return m.toString()}jzi(a){switch(a){case 1:return["48",
"48"];case 2:return["64","64"];case 3:return["96","96"];case 4:return["120","120"];case 5:return["240","240"];case 6:return["360","360"];case 7:return["432","432"];case 8:return["504","504"];case 0:return[];default:throw Error.argumentOutOfRange("unknown dimension");}}get cle(){return this.$a.ka("IsUserProfilePictureResolutionEnabled")}}Object(n.a)(cv,"UserProfilePictureUtils",null,[1307,1308]);var ny=d(566);class dv{get name(){return"Common.App.People"}$b(a){a.register(Bt,"Common.App.People.PeopleRequestHandler").as("Common.App.People.IPeopleRequestHandler").ma().oa(()=>
new Bt(u.AFrameworkApplication.Je,()=>u.AFrameworkApplication.jh,u.AFrameworkApplication.fa,new At.a));a.register(cn,"Common.App.People.UserPermissionsCache").as("Common.App.People.IUserPermissionsCache").ma();a.register(us,"Common.App.People.ShowSharingUiPostMessageHandler").ma().oa(()=>new us(af.a.Uu(a.Ja("Postmessage.IHostPostmessenger"))));a.register(ws,"Common.App.People.UserAccessUtils").as("Common.App.People.IUserAccessUtils").ma().oa(()=>new ws(a.resolve("Common.App.People.PeopleRequestHandler"),
u.AFrameworkApplication.fa,a.resolve("Common.App.People.ShowSharingUiPostMessageHandler"),a.resolve("Common.App.People.IUserPermissionsCache"),ny.a,mh.a.instance));a.register(Et,"Common.App.People.UserContactsUtils").as("Common.App.People.IUserContactsUtils").ma().oa(()=>new Et(u.AFrameworkApplication.fa,a.resolve("Common.App.People.PeopleRequestHandler")));a.register(cv,"Common.App.People.UserProfilePictureUtils").as("Common.App.People.IUserProfilePictureUtilsV2").as("Common.App.People.IUserProfilePictureUtils").ma().oa(()=>
new cv(a.resolve("Common.App.People.PeopleRequestHandler"),u.AFrameworkApplication.fa,u.AFrameworkApplication.userSessionId,u.AFrameworkApplication.userType));a.register(ts,"Common.App.People.PeopleColorUtils").as("Common.App.People.IPeopleColorUtils").ma().oa(()=>new ts(a.rb("Common.IColorTable")));a.register(zt,"Common.App.People.PeopleManager").as("Common.App.People.IPeopleManager").ma().oa(()=>new zt(a.resolve("Common.App.People.PeopleRequestHandler"),a.resolve("Common.App.People.IUserAccessUtils"),
u.AFrameworkApplication.fa,a.resolve("Common.App.People.IUserContactsUtils"),Ja.a.get_instance(),a.resolve("Common.App.People.IUserProfilePictureUtilsV2")));a.register(Vu,"Common.App.People.ExternalPeopleAPI").as("Common.App.People.IExternalPeopleAPI").ma().oa(()=>new Vu(a.resolve("Common.App.People.IPeopleManager"),a.resolve("Common.App.People.IPeopleColorUtils"),af.a.Uu(a.Ja("Common.ILokiTokenManager")),u.AFrameworkApplication.fa,a.Ja("Common.App.ApplicationFeatureHelper.IAlternateAuthHelper")))}init(){u.AFrameworkApplication.fa&&
u.AFrameworkApplication.fa.jf(Object(F.a)(this,this.Om,"onFullAppSettingsReady"))}Om(){const a=vb.a.instance.resolve("Common.App.People.IPeopleManager");vb.a.instance.resolve("Common.App.People.IExternalPeopleAPI");u.AFrameworkApplication.fa.ka("GetUserContactsTestHookIsEnabled")&&(new Hw(a,u.AFrameworkApplication.Ta)).o_k()}dispose(){}static main(){r.a.instance.Dc(new dv)}}Object(n.a)(dv,"PeoplePackage",null,[2,3]);var fq={};fq.hPb=function(){function a(){return G()&&(hc()||3<=(fb()?Gc("version/"):
0))}function b(){return 0<=window.navigator.userAgent.indexOf("Windows")}function c(){return 0<=window.navigator.userAgent.indexOf("Windows Phone")}function h(xd){xd=(new RegExp(xd+"\\s+(\\d+(\\.\\d*)?)")).exec(window.navigator.userAgent);var Ne=-1;null!=xd&&2<=xd.length&&(Ne=parseFloat(xd[1]),isNaN(Ne)&&(Ne=-1));return Ne}function m(){Fk||(Fk=!0,Sl=h("Windows Phone"));return 8<=Sl}function y(){return"function"==typeof navigator.msLaunchUri&&!c()&&!gc()&&!U()}function G(){return 0<=window.navigator.userAgent.indexOf("Macintosh")}
function U(){return 0<=window.navigator.userAgent.indexOf("Edge/")}function ja(){return 0<=window.navigator.userAgent.indexOf(" MSIE ")||0<=window.navigator.userAgent.indexOf("Trident/")}function va(){return ja()?8==window.document.documentMode:!1}function Ta(){return 0<=window.navigator.userAgent.indexOf(" Firefox/")}function fb(){return 0<=window.navigator.userAgent.indexOf(" AppleWebKit/")}function Db(){return 0<=window.navigator.userAgent.toLowerCase().indexOf("chrome")}function gc(){var xd=window.navigator.userAgent.toLowerCase();
return 0<=xd.indexOf("android")&&0<=xd.indexOf("chrome")}function hc(){return 3<=(Ta()?Gc("firefox/"):0)}function Gc(xd){var Ne=window.navigator.userAgent.toLowerCase(),le=Ne.indexOf(xd);return 0<=le?parseInt(Ne.substring(le+xd.length,Ne.length)):0}function Pc(xd,Ne,le,yf,Eg){if(yf&&null!=Ne)Ne();else if(y())navigator.msLaunchUri(xd,Ne,le);else if(!(Db()||0<=window.navigator.userAgent.indexOf("iPhone")||0<=window.navigator.userAgent.indexOf("iPad")||0<navigator.maxTouchPoints&&G())||U())Vd(xd,Ne,
le);else if(Db()&&Eg)a:{try{window.open(xd,"_self")}catch(Fi){null!=le&&le();break a}null!=Ne&&Ne()}else yc(xd,Ne,le)}function yc(xd,Ne,le){var yf=document.getElementById("OICLinkTag");null==yf&&(yf=document.createElement("a"),yf.id="OICLinkTag",yf.style.visibility="hidden",yf.href="",0==(dh.Options&xi.SupportsTopTargetNavigation)||dh.NoBrowserModalDialogs?yf.target="_blank":yf.target="_top",document.body.appendChild(yf),null!=yf.addEventListener&&yf.addEventListener("click",function(Eg){null!=Eg.stopPropagation&&
Eg.stopPropagation()},!1));try{yf.href=xd,yf.click()}catch(Eg){null!=le&&le();return}null!=Ne&&Ne()}function Vd(xd,Ne,le){var yf=document.getElementById("OICFrame");null==yf&&(yf=document.createElement("iframe"),yf.className="ObjectInDialog",yf.style.visibility="hidden",yf.src="about:blank",document.body.appendChild(yf),yf.id="OICFrame");try{yf.contentWindow.location.href=xd}catch(Eg){null!=le&&le();return}null!=Ne&&Ne()}function De(xd){return 0!=(xd.Options&xi.SkipProtocolHandler)||va()}function Wd(xd){return xd===
Xi.ReadOnly||xd===Xi.ReadWrite}function Ve(xd,Ne,le,yf){var Eg;try{var Fi=new ActiveXObject("SharePoint.OpenDocuments.4");return(Eg=Fi.ViewDocument3(window.self,xd,Ne,yf))?(Dk(eh.O14ActiveX),mg.None):mg.Failed}catch(Oj){}if(xi.O14Only===(le&xi.O14Only))return dh.DescriptiveUnattemptedEnums?mg.O14AttemptFailure:mg.Unattempted;try{return Fi=new ActiveXObject("SharePoint.OpenDocuments.3"),(Eg=Fi.ViewDocument3(window.self,xd,Ne,yf))?(Dk(eh.O12ActiveX),mg.None):mg.Failed}catch(Oj){}if(xi.O12UpOnly===(le&
xi.O12UpOnly))return dh.DescriptiveUnattemptedEnums?mg.O12UpOnlyFail:mg.Unattempted;try{return Fi=new ActiveXObject("SharePoint.OpenDocuments.2"),(Eg=Wd(Ne)?Fi.ViewDocument2(window.self,xd,yf):Fi.EditDocument2(window.self,xd,yf))?(Dk(eh.O11ActiveX),mg.None):mg.Failed}catch(Oj){}return dh.DescriptiveUnattemptedEnums?mg.ActiveXUnattempted:mg.Unattempted}function $e(xd,Ne,le,yf,Eg){xd==jh.Visio&&le==Xi.ReadWrite&&(le=Xi.WriteOnly);yf=yf||c()&&!m();yf||(yf="",yf=Wd(le)?xd==jh.PowerPoint&&rl.has(dh.DocumentExtension)?
yf+"nft|ofc|":yf+"ofv|ofc|":yf+"ofe|",Eg+=lg(yf+"u|"));Eg+=lg(Ne);dh.NewTelemetryDataIsEnabled&&(xd=dh.SessionOrigin?"|or|"+dh.SessionOrigin:"",xd+=dh.ClickTime?"|ct|"+dh.ClickTime:"",xd+=dh.CorrelationId?"|cid|"+dh.CorrelationId:"",Eg+=lg(xd));xd=window.location.href;Ne=xd.toLowerCase().indexOf("&wdlor=");-1!=Ne?(Ne+=7,le=xd.indexOf("&",Ne),xd=-1==le?xd.substr(Ne):xd.substring(Ne,le)):xd=void 0;if(null!=xd&&"undefined"!=typeof xd){Ne="";try{Ne=decodeURIComponent(xd)}catch(Fi){}0<Ne.length&&RegExp("(c|t)[\\w]{8}-[\\w]{4}-[\\w]{4}-[\\w]{4}-[\\w]{12}").test(Ne)&&
(Eg=Eg+"|f|"+Ne)}return Eg}function Qf(xd,Ne,le,yf,Eg,Fi){var Oj=dj(xd);if(null==Oj)return vj(dh.DescriptiveUnattemptedEnums?mg.ProtocolHandlerIsNull:mg.Unattempted,dh.Application),!1;xd=$e(xd,Ne,le,yf,Oj);Pc(xd,Hg,Qg,Eg,Fi);return!0}function lg(xd){if(G()&&Db()){var Ne="";try{Ne=decodeURI(xd)}catch(le){}if(Ne==xd)return encodeURI(xd)}return xd}function Hg(){Dk(eh.ProtocolHandler)}function Qg(){dh.Options|=xi.SkipProtocolHandler;Ei(dh,Wj,fk)}function Sf(){null!=Fj&&Fj(eh.RoamingProtocolHandler)}function sh(){null!=
sl&&sl(mg.ControlNeeded)}function Xg(){var xd=document.getElementById("npSharePointPlugin");if(null==xd){xd="application/x-sharepoint";G()&&3<=(fb()?Gc("version/"):0)&&ni("application/x-sharepoint-webkit",!0)&&(xd="application/x-sharepoint-webkit");if(!ni(xd,!0))if(G()&&ni("application/officelive",!0))xd="application/officelive";else return null;var Ne=document.createElement("object");Ne.id="npSharePointPlugin";Ne.type=xd;Ne.style.width="0px";Ne.style.height="0px";Ne.style.setProperty("visibility",
"hidden","");document.body.appendChild(Ne);xd=document.getElementById("npSharePointPlugin")}return xd}function ni(xd,Ne){var le=window.navigator.mimeTypes;if(null==le)return!1;xd=le[xd];return!xd||Ne&&!xd.enabledPlugin?!1:!0}function Ri(xd){try{if(null!=new ActiveXObject(xd))return!0}catch(Ne){}return!1}function uj(xd){switch(xd){case jh.OneNote:return"OneNote.Notebook";default:return""}}function dj(xd){if(xd!=jh.OneNote&&c()&&!m())return"office:";switch(xd){case jh.Excel:return"ms-excel:";case jh.OneNote:return"onenote:";
case jh.PowerPoint:return"ms-powerpoint:";case jh.Visio:return"ms-visio:";case jh.Word:return"ms-word:";case jh.Project:return"ms-project:";case jh.Publisher:return"ms-publisher:";case jh.Infopath:return"ms-infopath:";case jh.Access:return"ms-access:";default:return""}}function ej(xd){switch(xd){case jh.Excel:return"root\\office15\\excel.exe";case jh.PowerPoint:return"root\\office15\\powerpnt.exe";case jh.Visio:return"root\\office15\\visio.exe";case jh.Word:return"root\\office15\\winword.exe";case jh.Project:return"root\\office15\\winproj.exe";
case jh.Publisher:return"root\\office15\\mspub.exe";case jh.Infopath:return"root\\office15\\infopath.exe";case jh.Access:return"root\\office15\\msaccess.exe";default:return null}}function Ei(xd,Ne,le){dh=xd;Wj=Ne;fk=le;if(xd.DocumentUrl){var yf=le=Ne=xd.DocumentUrl;try{yf=decodeURIComponent(xd.DocumentUrl)}catch(po){}try{le=encodeURI(xd.DocumentUrl)}catch(po){}Ne=Ne+""+xd.CorrelationIdForWinClient;yf+=xd.CorrelationIdForWinClient;le+=xd.CorrelationIdForWinClient;xd.Mode===Xi.ReadWrite&&xi.CheckoutRequired===
(xd.Options&xi.CheckoutRequired)&&(xd.Mode=Xi.ForceCheckout);xi.HostIsEditOnly===(xd.Options&xi.HostIsEditOnly)&&(xd.Mode=Xi.WriteOnly);if(De(xd)?0:G()&&(xd.Application==jh.OneNote||ni("application/x-sharepoint-protocolhandler",!1)||ni("application/x-sharepoint-webkit-protocolhandler",!1))||y()||gc()||!(a()||hc()||"ActiveXObject"in window&&!c()||Db())||15<=tk())Qf(xd.Application,xd.EncodeUrl?le:Ne,xd.Mode,xd.Application==jh.OneNote,xd.SilentExternalHandler,xd.NavigateUsingWindowOpen);else{var Eg;
if(Eg=va())a:{var Fi=xd.EncodeUrl?Ne:yf,Oj=xd.Mode,Lo=uj(xd.Application);try{Eg=(new ActiveXObject("SharePoint.OpenDocuments.5")).ViewDocument3(window.self,Fi,Oj,Lo);break a}catch(po){}Eg=!1}if(Eg)Dk(eh.O15ActiveX);else{if(a()||hc()){var uk=xd.EncodeUrl?Ne:yf;yf=xd.Mode;Eg=uj(xd.Application);Fi=Xg();if(null==Fi)uk=dh.DescriptiveUnattemptedEnums?mg.PluginIsNull:mg.Unattempted;else{Oj=!1;try{Oj=Fi.ViewDocument3(window.self,uk,yf,Eg)}catch(po){}if(!Oj)try{Oj=Wd(yf)?Fi.ViewDocument2(window.self,uk,Eg):
Fi.EditDocument2(window.self,uk,Eg)}catch(po){}Oj?(Dk(eh.NpapiPlugin),uk=mg.None):uk=mg.Failed}}else{try{uk=new ActiveXObject("IDBHO.IDBHOCtrl"),null!=uk&&uk.SaveSSOCreds()}catch(po){}uk=Ve(xd.EncodeUrl?Ne:yf,xd.Mode,xd.Options,uj(xd.Application))}if(uk!=mg.None){if(yf=xd.CouldUseRoamingApps)Rl||(Rl=!0,lm=h("Windows NT")),yf=6.1<=lm&&!(0<=window.navigator.userAgent.indexOf("ARM;"))&&(ja()||hc()||Db());if(yf&&xd.Application!=jh.OneNote){if(!fq.hPb.kGl()){vj(mg.ControlNeeded,dh.Application);return}if(xd.RoamingAppsLauncher){"undefined"==
typeof xd.RoamingAppsLauncher||null==xd.RoamingAppsLauncher?vj(dh.DescriptiveUnattemptedEnums?mg.RoamingLauncherIsNull:mg.Unattempted,dh.Application):"undefined"==typeof xd.RoamingBitsUrl||null==xd.RoamingBitsUrl?fq.hPb.zGl(xd.DocumentUrl,xd.RoamingAppsLauncher,xd.Application,xd.ApplicationParameters,Wj,fk):fq.hPb.MKh(xd.DocumentUrl,xd.RoamingAppsLauncher,xd.RoamingApplicationExe,xd.ApplicationParameters,xd.RoamingPlatform,xd.RoamingBitsUrl,Wj,fk);return}if(!xd.ContinueIfLauncherIsNull){vj(mg.LauncherNeeded,
dh.Application);return}}xi.NoProtocolHandlerFallback==(xd.Options&xi.NoProtocolHandlerFallback)||De(xd)||ja()||G()&&!(dh.DescriptiveUnattemptedEnums?uk>=mg.O14Unattempted&&uk<=mg.DocumentUrlIsNull:uk==mg.Unattempted)?vj(uk,dh.Application):Qf(xd.Application,xd.EncodeUrl?le:Ne,xd.Mode,xd.Application==jh.OneNote,xd.SilentExternalHandler,xd.NavigateUsingWindowOpen)}}}}else vj(dh.DescriptiveUnattemptedEnums?mg.DocumentUrlIsNull:mg.Unattempted,dh.Application)}function Dk(xd){null!=Wj&&Wj(xd)}function vj(xd,
Ne){"undefined"==typeof Ne&&(Ne=null);null!=fk&&fk(xd,Ne)}function tk(){var xd=0;if(a()||hc()||Db()){var Ne=Xg();try{null!=Ne&&(xd=Ne.GetOfficeVersion())}catch(le){}}else Ri("SharePoint.OpenDocuments.5")?xd=15:Ri("SharePoint.OpenDocuments.4")?xd=14:Ri("SharePoint.OpenDocuments.3")?xd=12:Ri("SharePoint.OpenDocuments.2")&&(xd=11);return xd}function Fl(){return G()&&(ni("application/x-sharepoint",!0)||ni("application/x-sharepoint-webkit",!0))}var rl=new Set([".pot",".potm",".potx"]),Gl="",Vj="",Ek="",
Wj,fk,Fj,sl,dh,Rl,lm,Fk,Sl,Xi={ReadWrite:0,ReadOnly:1,WriteOnly:2,ForceCheckout:3,WriteLocalCopy:4,OpenInBrowser:5},xi={None:0,CheckoutRequired:1,O14Only:2,HostIsEditOnly:4,O12UpOnly:8,SkipProtocolHandler:16,NoProtocolHandlerFallback:32,SupportsTopTargetNavigation:64},mg={None:0,Failed:1,Unattempted:2,LauncherNeeded:3,ControlNeeded:4,PopupBlocked:5,O14Unattempted:6,O12UpOnlyUnattempted:7,PluginIsNull:8,ActiveXUnattempted:9,ProtocolHandlerIsNull:10,ProtocolHandlerNoCallbackIsNull:11,RoamingLauncherIsNull:12,
DocumentUrlIsNull:13},eh={Unknown:0,NpapiPlugin:1,O10ActiveX:2,O11ActiveX:3,O12ActiveX:4,O14ActiveX:5,ProtocolHandler:6,RoamingActiveX:7,RoamingFFExtension:8,RoamingProtocolHandler:9,O15ActiveX:10},jh={Unknown:0,Excel:1,OneNote:2,PowerPoint:3,Visio:4,Word:5,Project:6,Publisher:7,Infopath:8,Access:9};return{OpenDocumentMode:Xi,OpenDocumentOptions:xi,OpenDocumentFailureType:mg,OpenDocumentControl:eh,OfficeApplication:jh,EditDocumentInClient:Ei,EditDocumentInClientParams:function(){this.DocumentUrl=
"";this.Options=this.Mode=0;this.Application=jh.Unknown;this.CouldUseRoamingApps=!1;this.RoamingAppsLauncher="";this.ContinueIfLauncherIsNull=!1;this.RoamingBitsUrl=this.RoamingApplicationExe=this.RoamingPlatform=this.ApplicationParameters="";this.EncodeUrl=this.SilentExternalHandler=!1;this.CorrelationIdForWinClient="";this.NewTelemetryDataIsEnabled=this.NoBrowserModalDialogs=this.DescriptiveUnattemptedEnums=this.NavigateUsingWindowOpen=!1;this.DocumentExtension=this.SessionOrigin=this.ClickTime=
this.CorrelationId=""},OfficeVersionInstalled:tk,IsO14MacPluginInstalled:Fl,OfferOfficeInDialog:function(){return b()&&11>=tk()},OfferOfficeNoIntrusive:function(){return b()&&15>tk()},OfferMacOffice:function(){return G()&&!(0<=window.navigator.userAgent.indexOf("PPC Mac"))&&!Fl()},InstallRoamingControl:function(){Ta()?window.InstallTrigger.install({Office:{URL:Vj}}):Vd(Ek,null,null)},CanUseRoamingControl:function(){if(y())return!0;if(Db())return"undefined"!=typeof navigator.plugins.refresh&&navigator.plugins.refresh(!1),
!!navigator.mimeTypes["application/x-vnd.officeondemand"];if(Ta()){var xd=document.createElement("RoamingExtensionElement");document.documentElement.appendChild(xd);var Ne=document.createEvent("Events");Ne.initEvent("RoamingOfficeInstalled",!0,!1);xd.dispatchEvent(Ne);return!!xd.getAttribute("installed")}if(ja())try{return(new ActiveXObject("RoamingOfficeActiveX.RoamingOffice")).HrExists()}catch(le){}return!1},InitUrls:function(xd,Ne,le){Gl=xd;Vj=le;Ek=Ne},LaunchRoamingApps:function(xd,Ne,le,yf,Eg,
Fi){fq.hPb.MKh(xd,Ne,ej(le),yf,"x86",Gl,Eg,Fi)},LaunchRoamingApps2:function(xd,Ne,le,yf,Eg,Fi,Oj,Lo){var uk="";null!=yf&&(uk+=" "+yf);null!=xd&&(uk+=' "'+xd+'"');if(y()||Db())Fj=Oj,sl=Lo,Oj='office: "'+(Fi+'" "')+(le+'" "ROAMING"'),Oj+=' "'+Ne+'"',Oj+=' "'+Eg+'"',Oj+=" "+uk,Pc(Oj,Sf,sh,!1,!1);else if(Ta())xd=document.createElement("RoamingExtensionElement"),xd.setAttribute("cabUrl",Fi),xd.setAttribute("app",le),xd.setAttribute("licensingEntitlements",Ne),xd.setAttribute("platform",Eg),xd.setAttribute("args",
uk),document.documentElement.appendChild(xd),Ne=document.createEvent("Events"),Ne.initEvent("RoamingOfficeLaunch",!0,!1),xd.dispatchEvent(Ne),null!=Oj&&Oj(eh.RoamingFFExtension);else if(ja()){if(xd=new ActiveXObject("RoamingOfficeActiveX.RoamingOffice"),null!=xd)try{xd.HrConfigureSingle(Fi,le,Ne,Eg,uk),null!=Oj&&Oj(eh.RoamingActiveX)}catch(po){}}else null!=Lo&&Lo(mg.Failed)},ShouldShowDialog:function(){return!c()},NavigateToUrlUsingClickingOnATag:yc,OpenDocumentWithProtocolHandler:Qf,OpenDocumentWithProtocolHandlerNoCallBack:function(xd,
Ne,le,yf){var Eg=dj(xd);if(null==Eg)return vj(dh.DescriptiveUnattemptedEnums?mg.ProtocolHandlerNoCallbackIsNull:mg.Unattempted,dh.Application),!1;xd=$e(xd,Ne,le,yf,Eg);Pc(xd,null,null,!1,!1);return!0}}}();fq.ClientUtils=fq.hPb;class Ft{constructor(a,b,c){this.Ca=a;this.vTh=b;this.xG=c}vb(){this.Ca.ya(H.a.tryMacOffice,he.a.frame,Object(F.a)(this,this.cuk,"onTryMacOffice"));this.Ca.ya(H.a.qDh,he.a.frame,Object(F.a)(this,this.L6g,"onTryMacOfficeFromViewer"));this.Ca.ya(H.a.pDh,he.a.frame,Object(F.a)(this,
this.L6g,"onTryMacOfficeFromViewer"))}cuk(a,b,c,h,m){if(1===c)return 32;m?(a=m.SourceControlId,"btnjTryMacOfficeForWordEditor"===a?qd.a.un(ng.a.NDa(12),"_blank",void 0,"MacOfficeOffer.TriggerFromWordEditor"):"PptJewel.About.TryMacOffice"===a&&qd.a.un(ng.a.NDa(22),"_blank",void 0,"MacOfficeOffer.TriggerFromPPTEditor")):this.Kmg();return 32}L6g(a,b,c){if(1===c)return 32;switch(a){case H.a.qDh:qd.a.un(ng.a.NDa(15),"_blank",void 0,"MacOfficeOffer.TriggerFromWordViewer");break;case H.a.pDh:qd.a.un(ng.a.NDa(25),
"_blank",void 0,"MacOfficeOffer.TriggerFromPPTViewer")}return 32}Kmg(){qd.a.un(Ft.zek,"_blank",void 0,"LaunchMacTrialWindow")}get mqc(){return this.vTh&&v.a.uk&&!v.a.Fje&&!MSOJS.ClientUtils.IsO14MacPluginInstalled()}get yth(){const a=this.mqc;a||u.AFrameworkApplication.jj.I4k();return a}get Wcl(){return this.mqc}static get zek(){return ng.a.HW("522401")}}Object(n.a)(Ft,"MacOfficeOffer",null,[1330]);class ev{constructor(a,b,c){this.Ca=a;this.yTh=b;this.hwd=null;(this.qEc=u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",
!1))&&vb.a.instance.Ja("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(h=>{this.hwd=h});this.xG=c}vb(){this.Ca.ya(H.a.tryOffice,he.a.frame,Object(F.a)(this,this.duk,"onTryOffice"));this.Ca.ya(H.a.w1e,he.a.frame,Object(F.a)(this,this.w1e,"tryOfficeThroughTellMe"));this.Ca.ya(H.a.yDh,he.a.frame,Object(F.a)(this,this.zDh,"tryOfficeThroughViewer"));this.Ca.ya(H.a.xDh,he.a.frame,Object(F.a)(this,this.zDh,"tryOfficeThroughViewer"))}duk(a,b,c,h,m){if(this.qEc&&1===c)return this.isFreemiumUpsellEnabled&&
this.nqc?32:8;2===c&&(m?(a=m.SourceControlId,"btnjTryOfficeForWordEditor"===a?qd.a.un(ng.a.NDa(11),"_blank",void 0,"OfficeTrial.TriggerFromWordEditor"):"PptJewel.About.TryOffice"===a?qd.a.un(ng.a.NDa(21),"_blank",void 0,"OfficeTrial.TriggerFromPPTViewer"):this.bme()):this.bme());return 32}w1e(a,b,c,h,m){if(this.qEc&&1===c)return this.isFreemiumUpsellEnabled&&this.nqc?32:8;2===c&&(m?(a=m.SourceControlId,qd.a.un(ng.a.HW("862405")+this.Cdj(a),"_blank",void 0,"TryOfficeThroughTellMe.WithSourceControlId")):
qd.a.un(ng.a.HW("522402"),"_blank",void 0,"TryOfficeThroughTellMe.Legacy"));return 32}zDh(a,b,c){if(this.qEc&&1===c)return this.isFreemiumUpsellEnabled&&this.nqc?32:8;if(2===c)switch(a){case H.a.yDh:qd.a.un(ng.a.NDa(14),"_blank",void 0,"TryOfficeThroughViewer.Word");break;case H.a.xDh:qd.a.un(ng.a.NDa(24),"_blank",void 0,"TryOfficeThroughViewer.PPT")}return 32}get s0g(){return this.nqc}get $kk(){return this.nqc&&MSOJS.ClientUtils.OfferOfficeInDialog()}get nqc(){return this.yTh&&!v.a.uk}get isFreemiumUpsellEnabled(){let a=
!1;this.hwd&&(a=this.hwd.isFreemiumUpsellEnabled());return a}bme(a=null){let b=0;a&&(b=a);qd.a.un(ev.taj(b),"_blank",void 0,"LaunchOfficeOffer")}Cdj(a){let b=0;switch(a){case "jbtnTryOfficeThroughTellMeForWordTrackChanges":b=1;break;case "jbtnTryOfficeThroughTellMeForWordShapes":b=2;break;case "jbtnTryOfficeThroughTellMeForWordLabel":b=3;break;case "jbtnTryOfficeThroughTellMeForWordCitations":b=4;break;case "jbtnTryOfficeThroughTellMeForWordTextBox":b=5;break;case "jbtnTryOfficeThroughTellMeForWordTableOfContent":b=
6;break;case "jbtnTryOfficeThroughTellMeForWordSmartArt":b=7;break;case "jbtnTryOfficeThroughTellMeForWordWordArt":b=8;break;case "jbtnTryOfficeThroughTellMeForWordMultiColumnLayout":b=9;break;case "jbtnTryOfficeThroughTellMeForWordEquation":b=10;break;case "jbtnTryOfficeThroughTellMeForPPTGroupShapes":b=16;break;case "jbtnTryOfficeThroughTellMeForPPTWordArt":b=17;break;case "jbtnTryOfficeThroughTellMeForPPTSpellCheckDict":b=18;break;case "jbtnTryOfficeThroughTellMeForPPTInsertAudio":b=19;break;case "jbtnTryOfficeThroughTellMeForPPTInsertChart":b=
20;break;case "TellMe.TryOfficeThroughTellMeForXLSSpellCheck":b=26;break;case "TellMe.TryOfficeThroughTellMeForXLSMacros":b=27;break;case "TellMe.TryOfficeThroughTellMeForXLSPivotTable":b=28;break;case "TellMe.TryOfficeThroughTellMeForXLSHeaderFooter":b=29}return 0===b?"":String.format("&pc={0:D}",b)}static taj(a){if(v.a.Ni)switch(a){case 1:return ng.a.HW("393806");case 2:return ng.a.HW("393810");case 3:return ng.a.HW("393809");case 5:return ng.a.HW("393805")}else if(v.a.JI)switch(a){case 1:return ng.a.HW("521979");
case 3:return ng.a.HW("521980");case 5:return ng.a.HW("521978");case 2:return ng.a.HW("522490")}else{if(2===a)return ng.a.HW("517778");if(1===a)return ng.a.NDa(30)}return ng.a.HW("522402")}}Object(n.a)(ev,"OfficeTrialExperience",null,[1326]);class fv{$b(a){a.register(ev,"Common.App.OpenInClient.OfficeTrialExperience").as("Common.IOfficeTrialExperience").ma().oa(()=>new ev(u.AFrameworkApplication.Ta,u.AFrameworkApplication.mje,u.AFrameworkApplication.lcid));a.register(Ft,"Common.App.OpenInClient.MacOfficeOffer").as("Common.IMacOfficeOffer").ma().oa(()=>
new Ft(u.AFrameworkApplication.Ta,u.AFrameworkApplication.Jhg,u.AFrameworkApplication.lcid))}}Object(n.a)(fv,"OpenInClientConfiguration",null,[3]);var Rn=d(172),cf=d(46);class gv{constructor(a,b,c){this.HX=this.Yt=this.K=null;this.kf=a;this.TF=b;this.Gze=c}XHf(a,b,c){if(!this.kf)return null;if(!this.K){this.K=cf.a.Fe();this.K.id=this.TF;this.K.className="HTMLSpinnerIndicator";const h=cf.a.Fe();h.className="HtmlspinnerOverlay";this.Yt=cf.a.Fe();this.Yt.className="HtmlspinnerInner";const m=cf.a.Nn();
m.className="BootSpinner";this.Yt.appendChild(m);this.Gze&&(this.HX=cf.a.Nn(),this.HX.id="htmlspinner_label",this.Yt.appendChild(this.HX));this.K.appendChild(h);this.K.appendChild(this.Yt);this.kf.appendChild(this.K)}this.Gze&&(this.HX.innerText=a||ResourceStrings.l_Loading);this.JOd(b,c);return this.K}uOb(a){this.HX&&(this.HX.innerText=a)}JOd(a,b){this.K.style.left=cf.a.Pc(a);this.K.style.top=cf.a.Pc(b);this.Yt.style.bottom=this.Gze?cf.a.Pc(this.kf.clientHeight/2+16):cf.a.Pc(this.kf.clientHeight/
2+24)}}Object(n.a)(gv,"HtmlSpinnerIndicator",null,[]);class Lw extends gv{constructor(a,b,c){super(a,b,!1);this.Ize=c}XHf(a,b,c){if(!this.kf)return null;if(!this.K){this.K=cf.a.Fe();this.K.id=this.TF;this.K.className="HTMLProgressIndicator";const h=cf.a.Fe();h.className="HtmlprogressOverlay";this.Yt=cf.a.Fe();this.Yt.className="HtmlprogressInner";if(this.Ize){const m=cf.a.eC();m.src=Rn.a.RK(xf.a.Bna);m.width=xf.a.hIb;m.height=xf.a.yhd;this.Yt.appendChild(m)}this.HX=cf.a.Nn();this.Yt.appendChild(this.HX);
this.K.appendChild(h);this.K.appendChild(this.Yt);this.kf.appendChild(this.K)}this.HX.innerText=a||ResourceStrings.l_Loading;this.JOd(b,c);return this.K}JOd(a,b){this.K.style.left=cf.a.Pc(a);this.K.style.top=cf.a.Pc(b);this.K.style.display=Td.a.Xk;this.Yt.style.position=Td.a.Ioa;a=this.Yt.clientWidth;this.Yt.style.top=cf.a.Pc(this.kf.clientHeight/2-this.Yt.clientHeight/2);u.AFrameworkApplication.isRtl?(this.Yt.style.right=cf.a.Pc(this.kf.clientWidth/2-a/2),this.Yt.style.direction=Td.a.s0a):(this.Yt.style.left=
cf.a.Pc(this.kf.clientWidth/2-a/2),this.Yt.style.direction=Td.a.tyh);this.K.style.display=Td.a.Gf}}Object(n.a)(Lw,"HtmlProgressIndicator",gv,[]);class xs{constructor(a,b){this.qJ=this.HO=this.K=null;this.Db=!0;this.Uxg=a;this.YI=b}eMb(a,b,c,h,m){u.AFrameworkApplication.Fzb()||(this.K=this.Uxg.XHf(a,c,h),b?(this.HO&&(window.clearTimeout(this.HO),this.HO=null),this.qJ&&(window.clearTimeout(this.qJ),this.qJ=null),this.GWe(m)):this.HO||this.qJ||(this.HO=window.setTimeout(()=>{this.fXe(m)},200)))}qVc(){this.HO&&
(window.clearTimeout(this.HO),this.HO=null);this.qJ&&(window.clearTimeout(this.qJ),this.qJ=null);this.K&&(this.K.style.display=Td.a.Gf,this.K.style.opacity="0")}uOb(a){this.Uxg.uOb(a)}GWe(a){this.K&&(this.K.style.opacity="1.0",this.K.style.visibility=Td.a.xz,this.Db&&(this.K.style.display=Td.a.Xk),Ba.a.J(512496862,811,15,"HtmlProgressIndicatorView::spinner shows up. actionName={0}",this.ftc(a)))}fXe(a){this.HO=null;this.K&&(this.K.style.visibility=Td.a.xz,this.Db&&(this.K.style.display=Td.a.Xk),this.K.style.opacity=
"0.0",this.qJ||(this.qJ=window.setTimeout(()=>{this.eXe(a)},1800)))}eXe(a){this.qJ=null;this.K&&(this.K.style.opacity="1.0",this.Db&&(this.K.style.display=Td.a.Xk),Ba.a.J(512496861,811,15,"HtmlProgressIndicatorView::spinner shows up. actionName={0}",this.ftc(a)))}ftc(a){return a?Object.getType(a)===String?a:Object.getType(a)===Number?this.YI.I5(a):null:null}get visible(){return this.Db}set visible(a){this.Db=a;this.K&&(this.K.style.display=a?Td.a.Xk:Td.a.Gf)}}Object(n.a)(xs,"HtmlProgressIndicatorView",
null,[1277]);class Mw{constructor(){this.PresentationID=this.PodSessionID=this.PodEndpointUrl=null}}Object(n.a)(Mw,"UploadConvertedFileToHostParams",null,[]);var Sq=d(996),zp=d(73);const gq=a=>{for(let b=0;b<a.children.length;b++){const c=a.children[b];c.style.position="relative";c.style.top=(c.parentNode.offsetHeight-c.offsetHeight)/2+"px"}},hv=a=>a.pc.keyCode===z.a.tq||a.pc.keyCode===z.a.mP?(a.Cc.click(),!0):!1,Gt=(a,b,c,h,m,y,G)=>{const U=document.createElement("a");U.className="ProtocolLaunchingDialogButtonAnchor";
U.className+=" OICDialog";U.id=a;U.setAttribute(zc.a.af,zc.a.ru);U.style.padding="0";U.style.margin="0";h&&oy(m,b,c,h,U);a=document.createElement("span");a.className="ProtocolLaunchingDialogButtonLabel";a.innerText=m;U.appendChild(a);U.tabIndex=0;y&&nd.a.instance.pb(ra.a.click,U,y);G&&w.KeyInputManager.instance.pb(ra.a.Hl,U,G);return U},oy=(a,b,c,h,m)=>{var y=document.createElement("img");y.alt=a;y.className=zp.getImageClassWithCluster(c,h);y.src=b;y.setAttribute(zc.a.af,zc.a.fN);a=document.createElement("span");
a.className="ProtocolLaunchingDialogImg32Container";a.appendChild(y);y=document.createElement("span");y.className="ProtocolLaunchingDialogIconContainer";y.appendChild(a);m.appendChild(y)};class ys{static get qg(){return Nh.a.gC(ys.ro,CommonUIStrings.l_OICLaunchDialogTitle)}}ys.ro="<div class='ProtocolLaunchingDialogBody' id='PLDDlgBody'> <div class='ProtocolLaunchingDialogTitle UIFontDialogTitle OICDialog' id='ProtocolLaunchingDialogTitle'> <div class='WACDialogSectionTitle'>{0}</div> </div> <div class='OICDialogRow' id='OICDialog'> <div class='OICDialogButtons' id='Buttons'> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonLaunchRichClient'> <div id='OICLaunchRichClient' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonReturn'> <div id='OICReturnToApp' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> </div> </div> </div>";
Object(n.a)(ys,"OICLaunchDialogHtml",null,[]);class Ht extends Nh.a{constructor(a){super();this.zmb=this.T1a=null;this.XMa=!1;this.Qw=a;this.qg=ys.qg;this.xd=5;this.ig="OICLaunchDialog";this.showDialog("",Object(F.a)(this,this.glk,"oicLaunchDialogResultHandler"));this.Nph();this.O5("ProtocolLaunchingDialogTitle");4!==u.AFrameworkApplication.Aa.hb.vsa&&(document.getElementById("ProtocolLaunchingDialogTitle").innerText=CommonUIStrings.l_OICLaunchDialogTitleForView);this.DR(this.T1a);ba.ULS.sendTraceTag(22140865,
211,50,"OIC launch dialog opened");document.getElementById("WACDialogTitlePanel").className+=" OICDialog"}Rwa(){this.T1a=Gt("BtnRichClient",this.Qw.dub,this.Qw.B$a,this.Qw.Vbe,CommonUIStrings.l_OICLaunchRichClient,Object(F.a)(this,this.l5g,"onRichClientButtonClick"),hv);document.getElementById("OICLaunchRichClient").appendChild(this.T1a);gq(this.T1a);this.zmb=Gt("BtnReturn",this.Qw.dub,this.Qw.B$a,this.Qw.lbg,CommonUIStrings.l_OICReturnToOnlineClient,Object(F.a)(this,this.j5g,"onReturnButtonClick"),
hv);document.getElementById("OICReturnToApp").appendChild(this.zmb);gq(this.zmb)}j5g(){this.hide();this.Qw.c_a();return!0}l5g(){ba.ULS.sendTraceTag(22140866,211,50,"OIC dialog: launch rich client");this.hide();u.AFrameworkApplication.Ta.processAction(H.a.Cib,2);return!0}glk(){this.Qw.c_a()}dispose(){this.XMa||(this.T1a&&(nd.a.instance.yb(ra.a.click,this.T1a,Object(F.a)(this,this.l5g,"onRichClientButtonClick")),w.KeyInputManager.instance.yb(ra.a.Hl,this.T1a,hv)),this.zmb&&(nd.a.instance.yb(ra.a.click,
this.zmb,Object(F.a)(this,this.j5g,"onReturnButtonClick")),w.KeyInputManager.instance.yb(ra.a.Hl,this.zmb,hv)),super.dispose(),this.XMa=!0)}}Object(n.a)(Ht,"OICLaunchDialog",Nh.a,[]);class iv{static get qg(){return Nh.a.gC(iv.ro,CommonUIStrings.l_OICDialogTitle)}}iv.ro="<div class='ProtocolLaunchingDialogBody' id='PLDDlgBody'> <div class='ProtocolLaunchingDialogTitle UIFontDialogTitle OICDialog' id='ProtocolLaunchingDialogTitle'> <div class='WACDialogSectionTitle'>{0}</div> </div> <div class='ProtocolLaunchingDialogIssues OICDialog' id='ProtocolhandlerGetHelp'> <div class='UIFontDialogText OICDialog' id='Issues'> </div> <div class='ProtocolLaunchingDialogHelpButtons' id='Buttons'> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonEdit'> <div id='ProtocolHandlerDialogEditInApp' class='UIFontDialogButton WACGlyph'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonGiveFeedback'> <div id='ProtocolHandlerDialogGiveFeedbackInApp' class='UIFontDialogButton WACGlyph'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonRetryOIC'> <div id='ProtocolHandlerDialogRetryOIC' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> </div> </div> </div>";
Object(n.a)(iv,"ProtocolLaunchingDialogV2Html",null,[]);var Nw=d(195);class Ow extends Nh.a{constructor(a){super();this.ymb=this.Hza=null;this.XMa=!1;this.CMa=null;this.Qw=a;this.qg=iv.qg;this.xd=5;this.ig="ProtocolLaunchingDialog";this.Gwc="OICRetryDialog";u.AFrameworkApplication.we.Bta&&u.AFrameworkApplication.we.b_a();u.AFrameworkApplication.we.Eb(new He.a(2,1,5E3,()=>{this.switchToBackupMode()},101));this.showDialog("",Object(F.a)(this,this.Vlc,"protocolLaunchingDialogResultHandler"));this.Nph();
this.O5("Issues");this.iVf();ba.ULS.sendTraceTag(19239262,211,50,"OIC dialog launched");document.getElementById("WACDialogTitlePanel").className+=" OICDialog"}Rwa(){const a=document.getElementById("Issues");if(a){oy("",this.Qw.dub,this.Qw.B$a,this.Qw.Vbe,a);const b=document.createElement("span");b.className="WACDialogSectionTitle";b.innerText=5===this.Qw.e7g?CommonUIStrings.l_OICBrowserDialogTitle:CommonUIStrings.l_OICDialogSectionTitle;a.appendChild(b);gq(a);a.style.display="none"}u.AFrameworkApplication.Aa.hb.T6f?
(this.ymb=Gt("GiveFeedback",this.Qw.dub,this.Qw.B$a,"",CommonUIStrings.l_OICDialogSectionGiveFeedback,Object(F.a)(this,this.Rdd,"onGiveFeedbackClick"),Object(F.a)(this,this.o3g,"onGiveFeedbackKeyUp")),document.getElementById("ProtocolHandlerDialogGiveFeedbackInApp").appendChild(this.ymb),gq(this.ymb)):document.getElementById("ButtonGiveFeedback").style.display="none";0===u.AFrameworkApplication.Aa.hb.vsa||u.AFrameworkApplication.DLi?document.getElementById("ButtonEdit").style.display="none":(this.Hza=
Gt("Edit",this.Qw.dub,this.Qw.B$a,"",2===u.AFrameworkApplication.Aa.hb.Vk?4===u.AFrameworkApplication.Aa.hb.vsa?CommonUIStrings.l_OICResumeEditing:CommonUIStrings.l_OICReturnToOnlineClient:4===u.AFrameworkApplication.Aa.hb.vsa?CommonUIStrings.l_OICResumeEditing:CommonUIStrings.l_OICContinueInBrowser,Object(F.a)(this,this.B2g,"onEditClick"),Object(F.a)(this,this.F2g,"onEditKeyUp")),document.getElementById("ProtocolHandlerDialogEditInApp").appendChild(this.Hza),gq(this.Hza));0===u.AFrameworkApplication.Aa.hb.vsa&&
!u.AFrameworkApplication.mje&&a&&(a.style.display="none")}jVf(){return this.CMa?(this.DR(this.CMa),!0):!1}iVf(){return this.Hza?(this.DR(this.Hza),!0):!1}F2g(a){return this.bFe(a,0)}o3g(a){return this.bFe(a,2)}i5g(a){return this.bFe(a,1)}bFe(a,b){let c=!1;if(a.pc.keyCode===z.a.tq||a.pc.keyCode===z.a.mP)a.Cc.click(),c=!0;else if(a.pc.keyCode===Sys.UI.Key.down||a.pc.keyCode===Sys.UI.Key.up)switch(b){case 1:c=this.iVf();break;case 0:c=this.jVf()}return c}B2g(){this.hide();4===u.AFrameworkApplication.Aa.hb.vsa?
(ba.ULS.sendTraceTag(18715411,211,50,"Restart the App and continue editing"),this.Qw.c_a()):(ba.ULS.sendTraceTag(18715412,211,50,"Switch to edit doc in browser"),this.Qw.z6b());return!0}Rdd(){ba.ULS.sendTraceTag(37339423,211,50,"Open give feedback dialog");return!0}Ued(){ba.ULS.sendTraceTag(19239263,211,50,"OIC dialog retry");document.getElementById("WACDialogPanel").style.display="none";u.AFrameworkApplication.Ta.processAction(H.a.Cib,2);return!0}Vlc(){this.Qw.c_a()}switchToBackupMode(){var a=document.getElementById("ProtocolLaunchingDialogTitle");
if(a){a.innerText=CommonUIStrings.l_OICDialog2ndTitle;if(a=document.getElementById("Issues"))a.style.display="block";(a=document.getElementById("ProtocolHandlerDialogRetryOIC"))&&!a.children.length&&(this.CMa=Gt("RetryOIC","","","",CommonUIStrings.l_OICDialogRetry,Object(F.a)(this,this.Ued,"onRetryOICClick"),Object(F.a)(this,this.i5g,"onRetryOICKeyUp")),a.appendChild(this.CMa),gq(this.CMa),this.Hza||this.jVf())}}dispose(){this.XMa||(this.Hza&&(nd.a.instance.yb(ra.a.click,this.Hza,Object(F.a)(this,
this.B2g,"onEditClick")),w.KeyInputManager.instance.yb(ra.a.Hl,this.Hza,Object(F.a)(this,this.F2g,"onEditKeyUp"))),this.ymb&&(nd.a.instance.yb(ra.a.click,this.ymb,Object(F.a)(this,this.Rdd,"onGiveFeedbackClick")),w.KeyInputManager.instance.yb(ra.a.Hl,this.ymb,Object(F.a)(this,this.o3g,"onGiveFeedbackKeyUp"))),this.CMa&&(nd.a.instance.yb(ra.a.click,this.CMa,Object(F.a)(this,this.Ued,"onRetryOICClick")),w.KeyInputManager.instance.yb(ra.a.Hl,this.CMa,Object(F.a)(this,this.i5g,"onRetryOICKeyUp"))),super.dispose(),
this.XMa=!0)}}Object(n.a)(Ow,"ProtocolLaunchingDialog",Nh.a,[]);class hq extends Rf.StandardDialog{constructor(a){super();this.Qw=a;this.ig="ProtocolLaunchingDialog";u.AFrameworkApplication.we.Bta&&u.AFrameworkApplication.we.b_a();u.AFrameworkApplication.Aa.hb.T6f&&this.jNd(CommonUIStrings.l_OICStandardDialogSectionGiveFeedback,Object(F.a)(this,this.Rdd,"onGiveFeedbackClick"));hq.F9f?(this.xd=12,this.Xe(1,CommonUIStrings.l_CloseFile),this.Xe(2,CommonUIStrings.l_OICDialogContinueHere),this.Xe(3,CommonUIStrings.l_OICDialogLaunchAgain)):
(this.xd=4,this.Xe(1,CommonUIStrings.l_OICDialogContinueHere),this.Xe(2,CommonUIStrings.l_OICDialogLaunchAgain));this.qFb(CommonUIStrings.l_OICDialog2ndTitle,5===this.Qw.e7g?CommonUIStrings.l_OICBrowserDialogTitle:CommonUIStrings.l_OICStandardDialogSectionTitle,null,null,Object(F.a)(this,this.Vlc,"protocolLaunchingDialogResultHandler"),null)}Rdd(a){ba.ULS.sendTraceTag(595342858,211,50,"Open give feedback dialog");this.S2g(a)}Ued(){ba.ULS.sendTraceTag(595342857,211,50,"OIC dialog retry");u.AFrameworkApplication.Ta.processAction(H.a.Cib,
2)}Vlc(a){hq.F9f?3===a?this.Vkh():2===a||0===a?this.continueEditing():1===a&&this.closeDocument():2===a?this.Vkh():(1===a||0===a)&&this.continueEditing()}closeDocument(){ba.ULS.sendTraceTag(577783557,211,50,"Closing the document");u.AFrameworkApplication.Ta.La(H.a.close,2,ki.a)}Vkh(){ba.ULS.sendTraceTag(593602691,211,50,"OIC dialog retry");window.setTimeout(Object(F.a)(this,this.Ued,"onRetryOICClick"),0)}continueEditing(){4===u.AFrameworkApplication.Aa.hb.vsa||u.AFrameworkApplication.fa.ka("WordConsumptionViewToEditRedirectIsEnabled")&&
1===u.AFrameworkApplication.Aa.mode?(ba.ULS.sendTraceTag(593602690,211,50,"Restart the App and continue editing"),this.Qw.c_a()):(ba.ULS.sendTraceTag(593602689,211,50,"Switch to edit doc in browser"),this.Qw.z6b())}static get F9f(){return u.AFrameworkApplication.fa.ka("OICDialogThreeActions")&&32===u.AFrameworkApplication.Ta.processAction(H.a.close,1)}}Object(n.a)(hq,"StandardProtocolLaunchingDialog",Rf.StandardDialog,[]);var rh=d(660);class l{}Object(n.a)(l,"EditDocumentInClientParams",null,[]);
class B{static pOf(a,b,c,h,m,y,G=!1,U=!1,ja="",va=!1,Ta=!1,fb=!1,Db="",gc="",hc="",Gc=!1,Pc=""){const yc=new l;yc.DocumentUrl=a;yc.DocumentExtension=Pc;yc.Mode=b;yc.Options=c;yc.Application=h;yc.SilentExternalHandler=G;yc.EncodeUrl=U;yc.CorrelationIdForWinClient=ja;yc.NavigateUsingWindowOpen=va;yc.DescriptiveUnattemptedEnums=Ta;yc.NoBrowserModalDialogs=fb;yc.SessionOrigin=Db;yc.CorrelationId=gc;yc.ClickTime=hc;yc.NewTelemetryDataIsEnabled=Gc;MSOJS.ClientUtils.EditDocumentInClient(yc,m,y)}}Object(n.a)(B,
"ClientUtils",null,[]);var V=d(560),qa=d(524),Ga=d(129);class Va{constructor(a){this.FAa=this.aRb=this.fQb=null;this.PRb=!1;this.Ryd=this.BEd=this.Nhf=null;this.Lvc=this.Bpa=this.QCc="";this.application=this.Jy=0;this.Oml=this.jZe=!1;this.CBl=a&&u.AFrameworkApplication.fa.ka("OICLaunchDialogIsEnabled");u.AFrameworkApplication.Ta.$S(H.a.Cib)||u.AFrameworkApplication.Ta.ya(H.a.Cib,he.a.frame,Object(F.a)(this,this.qZk,"retryOpenInClientAction"));this.Rvh=!!u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.ka("SilentExternalHandler")}get e7g(){return this.Jy}Y9k(a,
b="",c=""){this.Bpa=c||Eh.a.create().toString();this.QCc=b||V.a.Y1f();this.Lvc=a}qZk(a,b,c){return b.contextId!==he.a.frame?2:1===c?32:this.Cib()}get options(){let a=0;u.AFrameworkApplication.requiresCheckout&&(a|=1);u.AFrameworkApplication.j7g&&(a|=4);this.Mml()&&(a|=64);return a}Mml(){return!(2===this.application&&u.AFrameworkApplication.fa.ka("IsEmbeddedScenario"))}get dub(){return u.AFrameworkApplication.qm}get B$a(){return u.AFrameworkApplication.KN}get lbg(){return""}get Vbe(){return""}get Nml(){return u.AFrameworkApplication.fa.ka("OneNoteMobileViewerIsEnabled")}get Hpl(){return this.Nhf||
(this.Nhf=vb.a.instance.resolve("Common.IOfficeTrialExperience"))}closeApplication(){this.jZe||this.nSi()}c_a(){this.Oml||this.wRf()}dMk(a){return this.CBl&&v.a.Ni?(new Ht(this),32):this.btb(a)}btb(a){const b=({L0a:a}=this.mXj(a)).returnValue;ba.ULS.sendTraceTag(34198736,211,50,"OICLaunchClient,{0},{1}",32===b,a);return b}begin(a,b,c,h,m,y,G=""){this.fQb=a;this.Ryd=G;this.aRb=b;this.FAa=y;this.application=c;this.Jy=h;return u.AFrameworkApplication.PNf?(this.Fmg(),32):u.AFrameworkApplication.LQ&&!u.AFrameworkApplication.fag?
(u.AFrameworkApplication.vvh(),8):this.kxf(m)}get flk(){return!!u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OicAshaLoggingIsEnabled",!1)}Cib(){this.flk&&this.J_j();return this.btb(this.PRb)}joh(){const a=new qa.a(gf.a.openInClient);a.Values["ui-language"]=u.AFrameworkApplication.lcid.toString();a.Values[rh.a.MJf]=u.AFrameworkApplication.userSessionId;return this.FAa.value.send(a)?32:8}J_j(){Mf.Health.instance.recordQosError("UserClickedRetryOpenInDesktop",
["OpenInClientFailed"],!1,!1,!1,!1,Object.assign(new ql.a,{inStaging:!0}))}q3k(a){const b=new qa.a(gf.a.$Dl);b.Values["ui-language"]=u.AFrameworkApplication.lcid.toString();b.Values[rh.a.MJf]=u.AFrameworkApplication.userSessionId;b.Values[hd.a.ZDl]=a;this.FAa.value.send(b)}mXj(a){this.PRb=a;this.q3k(5===this.Jy?Va.Wuk:Va.bvk);return 5===this.Jy?this.lXj():this.nXj()}lXj(){this.Lmg();return{returnValue:32,L0a:"HostEditUrl,"}}nXj(){let a;var b=a="";u.AFrameworkApplication.vrf&&(b="|f|"+u.AFrameworkApplication.userSessionId);
const c=u.AFrameworkApplication.fa.ka("IsAssignmentMode")&&u.AFrameworkApplication.fa.ka("UseWindowOpenForOpenInClientInChromeAssignmentsIsEnabled")||u.AFrameworkApplication.y$b||v.a.zFa,h=u.AFrameworkApplication.fa.ka("UnattemptedEnumIsEnabled"),m=u.AFrameworkApplication.fa.ka("NoBrowserModalDialogs");if(u.AFrameworkApplication.Ta.xcd){var y=u.AFrameworkApplication.Ta.HTc(3588168074);y&&this.Y9k(y.epochClickTime,y.sessionOrigin,y.correlationId);this.xog()}if(u.AFrameworkApplication.Lah){a+="NewOrder,";
y=8;this.FAa&&this.FAa.value&&this.FAa.value.isEnabled()&&u.AFrameworkApplication.Qtc&&(a+="Post,",y=this.joh());if(32===y)return{returnValue:y,L0a:a};ba.ULS.sendTraceTag(4994821,211,50,"AOpenInclientOperation.LaunchClient: cannot send postmessage");return u.AFrameworkApplication.xu.bxa?(ba.ULS.shipAssertTag(5566816,211,!!u.AFrameworkApplication.xu.bxa),a+="HostUrl,",{returnValue:u.AFrameworkApplication.Aa.MO(!0,u.AFrameworkApplication.xu.bxa),L0a:a}):this.fQb?(ba.ULS.sendTraceTag(18715405,211,15,
"Try to open doc in rich client, SessionId {0}",u.AFrameworkApplication.userSessionId),a+="DocUrl,",B.pOf(this.fQb,this.Jy,this.options,this.application,Object(F.a)(this,this.E2g,"onEditInClientSuccess"),Object(F.a)(this,this.D2g,"onEditInClientFailure"),this.Rvh,u.AFrameworkApplication.fa.ka("OICEncodeUrlIsEnabled"),b,c,h,m,this.QCc,this.Bpa,this.Lvc,u.AFrameworkApplication.Ta.xcd,this.Ryd),{returnValue:32,L0a:a}):{returnValue:8,L0a:a}}a+="OldOrder,";if(!this.fQb&&u.AFrameworkApplication.xu.bxa)return this.FAa&&
this.FAa.value&&this.FAa.value.isEnabled()&&u.AFrameworkApplication.Qtc?(a+="Post,",b=this.joh()):(ba.ULS.sendTraceTag(22595483,211,50,"AOpenInclientOperation.LaunchClient: cannot send postmessage"),b=8),32!==b?(ba.ULS.shipAssertTag(22595484,211,!!u.AFrameworkApplication.xu.bxa),a+="HostUrl,",{returnValue:u.AFrameworkApplication.Aa.MO(!0,u.AFrameworkApplication.xu.bxa),L0a:a}):{returnValue:b,L0a:a};ba.ULS.sendTraceTag(22595485,211,15,"Try to open doc in rich client, SessionId {0}",u.AFrameworkApplication.userSessionId);
a+="DocUrl,";B.pOf(this.fQb,this.Jy,this.options,this.application,Object(F.a)(this,this.E2g,"onEditInClientSuccess"),Object(F.a)(this,this.D2g,"onEditInClientFailure"),this.Rvh,u.AFrameworkApplication.fa.ka("OICEncodeUrlIsEnabled"),b,c,h,m,this.QCc,this.Bpa,this.Lvc,u.AFrameworkApplication.Ta.xcd,this.Ryd);return{returnValue:32,L0a:a}}DWk(a){u.AFrameworkApplication.jj.setDw(8981,a)}E2g(a){this.DWk(a);ba.ULS.sendTraceTag(18715406,211,50,"Open in rich client succeed");6===a&&MSOJS.ClientUtils.ShouldShowDialog()?
(this.Nml||this.Lmg(),this.xog()):this.jZe||this.closeApplication()}D2g(a,b=0){ba.ULS.sendTraceTag(18715407,211,10,"Fail to open doc in rich client. Failure Type: {0:D2}, Application: {1}",a,b);if(5===a)alert(CommonUIStrings.l_OICErrorPopupBlockerForSafari);else{const c=!!this.aRb&&!this.PRb;let h=0;1===a&&(h=2);6<=a&&13>=a&&(h=1,1===b&&(this.jZe=!0));this.Hpl.$kk?(ba.ULS.sendTraceTag(18715408,211,50,"Open OICErrorDialogWithTrial. Dialog cause: {0}",h),Sq.a.instance.dEi(this.PRb?Object(F.a)(this,
this.C0g,"oicErrorDialogHandlerCloseForced"):Object(F.a)(this,this.D0g,"oicErrorDialogHandlerNoCloseForced"),c?Object(F.a)(this,this.P3g,"onLaunchDownload"):null,this.uMf(!1)?Object(F.a)(this,this.Oyj,"iHaveOfficeButtonHandler"):null,h,b)):(ba.ULS.sendTraceTag(18715409,211,50,"Open OICErrorDialog. Dialog cause: {0}",h),Sq.a.instance.bEi(this.PRb?Object(F.a)(this,this.C0g,"oicErrorDialogHandlerCloseForced"):Object(F.a)(this,this.D0g,"oicErrorDialogHandlerNoCloseForced"),c?Object(F.a)(this,this.P3g,
"onLaunchDownload"):null,h))}}xog(){try{const a=[Object.assign(new Ga.a,{name:"CorrelationId",string:this.Bpa}),Object.assign(new Ga.a,{name:"SessionOrigin",string:this.QCc}),Object.assign(new Ga.a,{name:"ClickTime",string:this.Lvc}),Object.assign(new Ga.a,{name:"ProtocolHandlerFinishedTimestamp",double:(new Date).getTime()})];Jf.a("OpenInClientCompleted",!0,0,a)}catch(a){ba.ULS.sendTraceTag(537773316,306,15,"Record OIC attempt failed: "+a.toString())}}Lmg(){u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.hb.uC&&
u.AFrameworkApplication.fa.ka("StandardProtocolDialogIsEnabled")?new hq(this):new Ow(this)}C0g(){this.closeApplication()}D0g(){this.c_a()}P3g(){this.Fmg()}Oyj(){return this.uMf(!0)}uMf(a){const b=(v.a.mUa||v.a.to)&&!!u.AFrameworkApplication.xMc;b&&a&&(qd.a.un(u.AFrameworkApplication.xMc,"_blank",void 0,"OpenInClient"),this.closeApplication());return b}}Va.bvk="OpenInDesktop";Va.Wuk="OpenInBrowser";Object(n.a)(Va,"AOpenInClientOperation",null,[]);class tb extends Va{constructor(a,b,c=!1){super(c);
this.hSh=a;this.gSh=b}get lbg(){return this.gSh}get Vbe(){return this.hSh}nSi(){u.AFrameworkApplication.Ta.La(H.a.close,2,ki.a)}wRf(){}kxf(a){return this.dMk(a)}Fmg(){ba.ULS.shipAssertTag(5566817,211,!!this.aRb);u.AFrameworkApplication.tda?u.AFrameworkApplication.Aa.MO(!0,this.aRb):qd.a.un(this.aRb,void 0,void 0,"LaunchDownload")}z6b(){u.AFrameworkApplication.Aa.hb.z6b()}}Object(n.a)(tb,"OpenInClientOperation",Va,[]);class $b extends tb{constructor(a,b,c,h){super("PowerPoint_32x32x32","EditInPowerPointWebApp_32x32x32");
if(!a)throw Error.argumentNull("pathManager");this.CFg=b;this.je=a;this.Mo=c;this.ia=h}get dub(){return this.je.pk(this.B$a+".png")}get B$a(){return"prt2"}kxf(a){return this.CFg?this.CFg(a):this.btb(a)}wRf(){Ba.a.J(512496860,801,50,"OpenInPowerPointOperation - restarting edit session");this.ia.La(M.a.refresh,2,{refreshtrigger:"OpenInPowerPointOperation::ExecuteRestartApplication"})}btb(a){this.Mo.x9b=!0;return super.btb(a)}}Object(n.a)($b,"OpenInPowerPointOperation",tb,[]);class vc{constructor(a,
b,c,h,m,y,G,U,ja,va,Ta,fb,Db,gc,hc,Gc,Pc,yc,Vd,De,Wd,Ve){this.Rxg=null;this.rE=y;this.ia=a;this.Fa=b;this.pa=c;this.je=h;this.xFg=new $b(this.je,Object(F.a)(this,this.Qgi,"beginSaveBeforeOpenInClient"),fb,a);G.execute($e=>{this.Rxg=new sb.a(()=>$e)});this.Ttg=m;this.Iu=U;this.tek=ja;this.ua=va;this.fc=Ta;this.Ga=Db;this.Xa=gc;this.Dea=hc;this.Qb=Gc;this.Qd=Pc;this.Lm=yc;this.Fv=Vd;this.ieb=De;this.b$=Wd;this.BO=Ve}vb(){this.ia.ya(M.a.openInClient,nc.a.application,Object(F.a)(this,this.f7g,"openExternal"));
this.ia.ya(H.a.wHe,nc.a.application,Object(F.a)(this,this.f7g,"openExternal"));this.ia.ya(M.a.convertAndEdit,nc.a.application,Object(F.a)(this,this.dzi,"convertBinaryFormat"));this.ia.ya(M.a.repair,nc.a.application,Object(F.a)(this,this.$Vk,"repairCorruptedFile"));this.ia.ya(M.a.Rnc,nc.a.application,Object(F.a)(this,this.Rnc,"replaceOriginalFile"));this.ia.ya(M.a.iKb,nc.a.application,Object(F.a)(this,this.iKb,"saveRepairedFile"));this.ia.ya(M.a.h2b,nc.a.application,Object(F.a)(this,this.h2b,"editAnyway"));
this.ia.ya(M.a.l6b,nc.a.application,Object(F.a)(this,this.l6b,"goToEditMode"));this.ia.he(M.a.openInClient,12288)}Qgi(a){if(this.Lm.isPaused)return this.Fa.Ed(),this.KRe(a),32;this.pa.Qh();this.Fa.Ed();if(1===this.Qb.mode&&this.Ga.isReadOnlyFilesForceEditingViaOICDisabled)return this.jUf(a),32;this.rE.j3(a,!0,()=>{this.KRe(a)},()=>{this.KRe(a);return!0},3);this.Iu.show(!1,"OpenInClient");return 32}KRe(a){this.Iu.hide();this.jUf(a)}jUf(a){Nc.a.usd();this.xFg.btb(a)}f7g(a,b,c){if(b.contextId!==nc.a.application)return 2;
b=!(!this.je.documentUrl&&!this.Ttg.bxa&&!u.AFrameworkApplication.Qtc);if(1===c)return b?32:8;if(!b)return 8;this.C1j();if(this.fc.$c(this.tek.Cf))return 16;a=a===H.a.wHe?5:2;1===this.Qb.mode&&this.Ga.isReadOnlyFilesForceEditingViaOICDisabled&&(a=1);return this.xFg.begin(this.je.documentUrl,u.AFrameworkApplication.eRa,3,a,this.Ga.YOj,this.Rxg,Rd.a("OpenPPTTemplateInDesktopAppAsNFT")?ta.a.bT(this.Ttg.Uw):"")}C1j(){try{let a="";const b=this.ua.$j;b&&(a=b.toString());Ba.a.J(509372432,801,50,"User clicked OpenInClient. Slide index: {0}. Slide stats:{1}",
this.ua.currentSlideIndex,a)}catch(a){Ba.a.J(509372431,801,10,"Exception caught while logging slide stats for OpenInClient: {0}",a)}}dzi(a,b,c){Ba.a.J(509372430,801,50,"PowerPointAppFrameCommandUIActor - ConvertBinaryFormat");if(b.contextId!==nc.a.application)return 2;if(1===c)return 32;const h=Object.assign(new Mw,{PodEndpointUrl:this.Ga.podsWebServiceBase,PodSessionID:this.Xa.podSessionId,PresentationID:this.Xa.presentationId.string});this.Dea.Rtd(h,Object(F.a)(this,this.muk,"onUploadConvertedFileToHostSucceeded"),
m=>{this.luk(m,h.PodSessionID)});this.Iu.mXe(!0,ResourceStrings.L_FileConverting,a);return 32}muk(a){Ba.a.J(509372429,801,50,"PowerPointAppFrameCommandUIActor - OnUploadConvertedFileToHostSucceeded");this.Iu.hide();if(this.Qb)if(a=a.result,a.EditUrl){var b=!1,c=!1,h=!1;u.AFrameworkApplication.fa&&(b=u.AFrameworkApplication.fa.ka("IsUIEmbedMode"),c=u.AFrameworkApplication.fa.ka("UiHostSupportsDocRebootFeatures"),h=u.AFrameworkApplication.fa.ka("UiHostSupportsPPTConvertScenarios"));if(b&&c&&h){Ba.a.J(509372426,
801,50,"PowerPointAppFrameCommandUIActor - OnUploadConvertedFileToHostSucceeded Sending DocumentRefresh post message.");const m={};m[hd.a.cJb]="1";m[hd.a.documentUrl]=a.EditUrl;m[hd.a.mode]="edit";m[hd.a.reason]=Yv.a.convert;u.AFrameworkApplication.gT().execute(y=>{y.sendMessage(gf.a.VCa,m)})}else this.Qb.MO(!0,a.EditUrl)}else Ba.a.J(509372427,801,15,"PowerPointAppFrameCommandUIActor - OnUploadConvertedFileToHostSucceeded no EditUrl");else Ba.a.J(509372428,801,15,"PowerPointAppFrameCommandUIActor - OnUploadConvertedFileToHostSucceeded no available app frame")}luk(a,
b){a=qf.a.nN(a.error.Xm);Ba.a.J(509372425,801,10,"PowerPointAppFrameCommandUIActor - OnUploadConvertedFileToHostFailed error: {0}",a);this.Iu.hide();a=Object.assign(new jl.a,{Code:a,Source:5});this.Qd.us(a,b,c=>{c.$B=1;c.cCa=6;c.title=ResourceStrings.L_FileConversionTitle;c.message=ResourceStrings.L_FileConversionError;return!1})}$Vk(a,b,c){if(b.contextId!==nc.a.application)return 2;if(1===c)return 32;Ba.a.J(509372424,801,50,"PowerPointAppFrameCommandUIActor - Start to repairCorruptedFile");this.bWk();
return 32}bWk(){const a=new Date;Ba.a.J(509372423,801,50,"PowerPointAppFrameCommandUIActor::RepairFileInline: Starting Document repair. Start-time {0}",a);const b=Nc.a.Ik("PowerPointAppFrameCommandUIActor.InlineDocumentRepair");this.BO.ksb(()=>{Ba.a.J(509372422,801,50,"PowerPointAppFrameCommandUIActor::RepairFileInline: Closed the pop session early that was triggered due to late detection (after open early success) of corruption. To avoid lock mismatch while writing to host for overwrite case is the reason we do proactively.")},
()=>{Ba.a.J(509372421,801,15,"PowerPointAppFrameCommandUIActor::RepairFileInline: Closing the pop session early failed. This might lead to overwrite the file  issues with a lock mismatch error.")});this.ieb.$ih(b,()=>{Ba.a.J(509372420,801,50,"PowerPointAppFrameCommandUIActor::RepairFileInline: Operation Successfull,Time-Taken {0}",+new Date-+a);b.finish();this.usl()},c=>{Ba.a.J(509372419,801,10,"PowerPointAppFrameCommandUIActor::RepairFileInline: Operation Failed,Time-Taken {0}, Error: {1}",+new Date-
+a,c);b.finish();this.GFk(c,this.Xa.podSessionId);return!0})}usl(){var a={failedMachineId:null,isPlanedShutdown:!1};a.podSessionId=this.Xa.podSessionId;a.fromInlineDocumentRepair=!0;this.Fv.oTe();a=this.ia.La(M.a.hJb,2,a);Ba.a.J(509372418,801,50,"PowerPointAppFrameCommandUIActor::TriggerDocRefresh: Response-{0}",a)}GFk(a,b){a=Object.assign(new jl.a,{Code:a,Source:5});this.Qd.us(a,b,c=>{c.$B=1;c.cCa=52;c.title=ResourceStrings.l_RepairFailDialogTitle;c.message=ResourceStrings.l_RepairFailedMessage;
return!1})}h2b(a,b,c,h,m){if(b.contextId!==nc.a.application)return 2;if(1===c)return 32;Ba.a.J(509372417,801,50,"PowerPointAppFrameCommandUIActor - EditAnyway");a=this.Fv.Yvb();0!==a&&(Ba.a.J(509372416,801,15,"PowerPointAppFrameCommandUIActor::EditAnyway - Creating Pop session as emergencyViewModeEnabledReason: {0}",a),this.FIf());if(20===m)this.Fv.dyl();else return Ba.a.J(509372387,801,10,"PowerPointAppFrameCommandUIActor - Unexpected EditAnyway operation"),8;return 32}iKb(a,b,c,h,m){if(b.contextId!==
nc.a.application)return Ba.a.J(509372386,801,15,"PowerPointAppFrameCommandUIActor - SaveRepairedFile. Context id don't match with Application. ContextId: {0}",b.contextId),2;if(1===c)return this.ia.processAction(m,1);Ba.a.J(509372385,801,50,"PowerPointAppFrameCommandUIActor - SaveRepairedFile - saveAsActionId : {0}",m);this.J4f(1,m);return 32}J4f(a,b){Ba.a.J(509372384,801,50,"GetSnappedDownloadUrl for saving the repaired file");const c=String.format("{0}PodHandler.ashx?action=GetSnappedDownloadLink&PodSID={1}",
this.Ga.podsWebServiceBase,this.Xa.podSessionId),h={"Content-Type":"application/json; charset=utf-8",WaitForSessionTimeoutMs:"0"};h["X-UserSessionId"]=u.AFrameworkApplication.userSessionId;const m=new Date;u.AFrameworkApplication.Je.Aj(c,1,"",h,!1,0,y=>{this.VFe(y,m,b)},y=>{this.UFe(y,a,b)},null,null)}VFe(a,b,c){Ba.a.J(509372383,801,50,"PowerPointAppFrameCommandUIActor - OnGettingSnappedUrlSucceeded. Time-Taken : {0}",+new Date-+b);a=JSON.parse(a.data.Zd).downloadUrl;ta.a.Wa(a)?(Ba.a.J(509372382,
801,10,"PowerPointAppFrameCommandUIActor - OnGettingSnappedUrlSucceeded but downloadUrl is null or empty"),this.Jwh()):(b={SkipSaveToHost:"true"},b.FileDownloadUrl=a,this.ia.La(c,2,b))}UFe(a,b,c){a=a.data?a.data.Te:-1;a===Xp.a.ugi&&0<b--?(Ba.a.J(509372381,801,15,"PowerPointAppFrameCommandUIActor - OnGettingSnappedUrlFailed : Retrying to Get Snapped Download Url. Current Retry Count: {0}, HttpStatus: {1}",a),this.J4f(b,c)):(Ba.a.J(509372380,801,10,"PowerPointAppFrameCommandUIActor - OnGettingSnappedUrlFailed : HttpStatus: {0} , SaveAsActionId : {1}",
a,c),this.Jwh())}Jwh(){const a=Object.assign(new jl.a,{Code:20,Source:6});this.Qd.us(a,this.Xa.podSessionId,b=>{b.$B=1;b.cCa=1;b.title=ResourceStrings.L_BizBarInlineRepairSaveAsFailedDialogTitle;b.message=ResourceStrings.L_BizBarInlineRepairSaveAsFailedDialogMessage;return!1})}Rnc(a,b,c){if(b.contextId!==nc.a.application)return Ba.a.J(509372379,801,15,"PowerPointAppFrameCommandUIActor - ReplaceOriginalFile. Context id don't match with Application. ContextId: {0}",b.contextId),2;if(1===c)return a=
u.AFrameworkApplication.fa.Ha("DocumentPermissions")||"",b=this.Xa.T7g&&-1<a.indexOf("W"),Ba.a.J(509372378,801,b?50:15,"PowerPointAppFrameCommandUIActor::ReplaceOriginalFile- InlineRepairedFile case: IsReplaceRepairedEnabled : {0}, Document Permission : {1} ",this.Xa.T7g,a),b?32:8;Ba.a.J(509372377,801,50,"PowerPointAppFrameCommandUIActor - ReplaceOriginalFile");this.Xa.Kk=this.b$.N8a(this.Xa.presentationId.string);a=Object.assign(new sm.a,{ForceCreatePods:!1,DoRehydrate:!1,IsRetrySession:!1,PodSessionID:this.Xa.podSessionId,
PresentationID:this.Xa.presentationId.string,PodEndpointUrl:this.Ga.podsWebServiceBase,PopSessionID:this.Xa.Kk,UrlOverrides:this.Ga.sfa,IsCreateNewSession:this.Ga.tT,UseSharedHostFile:this.Ga.NOb});this.b$.eIc(a,()=>{this.kok()},Object(F.a)(this,this.qGb,"onEnsureHostSessionFailed"),0,!0);return 32}kok(){Ba.a.J(509372376,801,50,"PowerPointAppFrameCommandUIActor - OnEnsureHostSessionSuccess");this.Fv.DXk();this.Xa.RXk();0!==this.Fv.Yvb()&&this.Fv.pTe(!1)}qGb(){Ba.a.J(509372375,801,10,"PowerPointAppFrameCommandUIActor - OnEnsureHostSessionFailed");
this.Fv.oTe();0!==this.Fv.Yvb()&&this.Fv.pTe(!0);return!1}l6b(a,b,c){if(b.contextId!==nc.a.application)return Ba.a.J(509372374,801,15,"PowerPointAppFrameCommandUIActor - GoToEditMode. Context id don't match with Application. ContextId: {0}",b.contextId),2;if(1===c)return 32;a=new Date;this.FIf();Ba.a.J(509372373,801,15,"PowerPointAppFrameCommandUIActor::GoToEditMode. Time-Taken to create pop session : {0}",+new Date-+a);return 32}FIf(){this.Xa.Kk=this.b$.N8a(this.Xa.presentationId.string);const a=
Object.assign(new sm.a,{ForceCreatePods:!1,DoRehydrate:!1,IsRetrySession:!1,PodSessionID:this.Xa.podSessionId,PresentationID:this.Xa.presentationId.string,PodEndpointUrl:this.Ga.podsWebServiceBase,PopSessionID:this.Xa.Kk,UrlOverrides:this.Ga.sfa,IsCreateNewSession:this.Ga.tT,UseSharedHostFile:this.Ga.NOb});this.b$.eIc(a,()=>{this.lok()},null,15,!0);this.Fv.pTe(!1)}lok(){Ba.a.J(509372372,801,15,"PowerPointAppFrameCommandUIActor - OnEnsureHostSessionSuccessForEmergencyViewMode")}}Object(n.a)(vc,"PowerPointAppFrameCommandUIActor",
null,[]);var Uc=d(500);class ld{constructor(a,b,c){this.Hqg=a;this.d0=b;this.rCb=c}show(a,b){this.rCb?(b=new Uc.a(b),b.message=ResourceStrings.l_Saving,b.Cgg=!0,b.bMb=a,this.d0.MJa(b)):this.mXe(a,ResourceStrings.l_Saving,b)}mXe(a,b,c){this.rCb?(c=new Uc.a(c),c.message=b,c.bMb=a,this.d0.MJa(c)):this.Hqg.eMb(b,a,0,0,c)}hide(){this.rCb?this.d0.MJa(Object.assign(new Uc.a(null),{Bgg:!0})):this.Hqg.qVc()}}Object(n.a)(ld,"SaveBlockingUI",null,[1255]);var ge=d(237);class Ee{constructor(a,b,c,h,m,y,G,U,ja){this.zec=
Fc.App.Um;this.eEg=pa.a.nil;this.zb=a;this.ua=b;this.Oc=c;this.Rk=h;this.OL=m;this.N9c=y;this.kB=U;this.kt=G;this.B9j=ja.K0k;this.r$j=ja.pptNotShowSavingStatusOfProofingOnlyRevision;this.Oc.GA(Object(F.a)(this,this.vB,"onSessionEnd"));this.Rk.bOd(Object(F.a)(this,this.XGh,"updateSavingStatus"));this.Rk.Nsf(Object(F.a)(this,this.WGh,"updateSavedStatus"));this.kt.IK(Object(F.a)(this,this.Xoa,"updateSaveStatusDisplay"));this.Kdk=new He.a(3,1,ja.J0k,Object(F.a)(this,this.updateSaveStatusText,"updateSaveStatusText"),
90,"28");this.MUa=!1;this.z8c=ja.powerPointTextEditOnlyMode}initialize(){this.Xoa(this.kt)}WGh(){this.MUa||this.kB.S3||this.kB.Ujg||(this.zb.Eb(this.Kdk),this.MUa=!0)}XGh(a,b){this.kB.S3||this.kB.Ujg||(this.r$j&&Ee.WQj(b.node)||this.N9c.updateSaveStatusText(!1),this.zec=new Date,this.eEg=b?b.revisionId:pa.a.nil)}updateSaveStatusText(){this.MUa=!1;const a=!this.OL.SW(this.ua.presentation);this.N9c.updateSaveStatusText(a);a&&(this.ljh(0,0),this.zec=Fc.App.Um);this.z8c&&Ee.syl(a)}Xoa(a){this.N9c.Xoa(!1,
1===a.mode?1:3)}vB(a,b){this.N9c.updateSaveStatusText(!0);this.ljh(1,b.fG);this.zec=Fc.App.Um}ljh(a,b){if(this.zec!==Fc.App.Um){var c=+new Date-+this.zec;c>=this.B9j&&(c=String.format("SavingTime {0};Type {1};Revision {2};",c,a,this.eEg),1===a&&(c+=String.format("CloseReason {0};",b)),Ba.a.J(21604228,811,50,c))}}dispose(){this.Oc.baa(Object(F.a)(this,this.vB,"onSessionEnd"));this.Rk.fPe(Object(F.a)(this,this.XGh,"updateSavingStatus"));this.Rk.jih(Object(F.a)(this,this.WGh,"updateSavedStatus"));this.kt.wY(Object(F.a)(this,
this.Xoa,"updateSaveStatusDisplay"))}static syl(a){const b=document.getElementById("TipStatus"),c=document.getElementById("TipStatusIcon"),h=document.getElementById("TipStatusText");b.style.display="block";a?(c.setAttribute("class","TipStatusSaved"),h.innerText=ResourceStrings.l_SavedShort):(c.setAttribute("class","TipStatusLoading"),h.innerText=ResourceStrings.l_SavingShort)}static WQj(a){return a.Sa(X.a.Ahd)&&!a.Sa(ge.a.Sld)}}Object(n.a)(Ee,"SaveStatusManager",null,[106]);class Ff{constructor(){this.K=
null;this.Ive=!1}get name(){return"PowerPointWebEditor.Actors"}$b(a){(new fv).$b(a);this.K=a;a.register(vc,"PowerPointWebEditor.PowerPointAppFrameCommandUIActor").ma().oa(()=>new vc(a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPoint.IPathManager"),a.resolve("Common.IDocPropertiesProvider"),a.resolve("PowerPointWebEditor.Storage.ISaveAndCloseHandler"),a.Ja("Postmessage.IHostPostmessenger"),
a.resolve("PowerPointWebEditor.ISaveBlockingUI"),a.resolve("PowerPointWebEditor.IPPTWorkspaceGraph"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),a.resolve("PowerPointWebEditor.IApplicationContext"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.resolve("PowerPointWebEditor.IPopWebService"),a.resolve("Box4.IAppFrame"),a.resolve("PowerPointWebEditor.IErrorHandler"),
a.resolve("Box4.IReplicationScheduler"),a.resolve("PowerPointWebEditor.Application.IReadOnlyManager"),a.resolve("PowerPointWebEditor.PodsPopsCore.IPodSessionCoreManager"),a.resolve("PowerPointWebEditor.PodsPopsCore.IPopSessionCoreManager"),a.resolve("PowerPointWebEditor.PodsPopsCore.IPopSessionManager")));a.register(1255,"PowerPointWebEditor.ISaveBlockingUI").ma().oa(()=>new ld(new xs(new Lw(a.resolve("PowerPointWebEditor.IPaneManager").xa,"SaveBlockingUI",!0),a.resolve("PowerPointWebEditor.IActionNameResolver")),
a.resolve("PowerPointWebEditor.IGraphActionBlockingEventNotifier"),a.resolve("PowerPointWebEditor.IApplicationSettings").iig));a.register(Ee,"PowerPointWebEditor.SaveStatusManager").ma().oa(()=>new Ee(a.resolve("Common.ITaskManager"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),a.resolve("PowerPointWebEditor.IGraphHotColdManager"),a.resolve("Common.App.SaveStatus.ISaveStatusUIHandler"),
a.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),a.resolve("PowerPointWebEditor.ISessionLifetimeManager"),a.resolve("PowerPointWebEditor.IApplicationSettings")))}init(){(this.Ive=this.K.resolve("PowerPointWebEditor.IApplicationSettings").BQj)&&this.K.resolve("PowerPointWebEditor.SaveStatusManager").initialize();this.K.resolve("PowerPointWebEditor.PowerPointAppFrameCommandUIActor").vb();this.K.resolve("Common.IOfficeTrialExperience").vb();this.K.resolve("Common.IMacOfficeOffer").vb()}dispose(){this.Ive&&
this.K.resolve("PowerPointWebEditor.SaveStatusManager").dispose()}static main(){r.a.instance.Dc(new Ff)}}Object(n.a)(Ff,"PowerPointActorsPackage",null,[2,3]);var kh=d(1022),uh=d(1087);class Ji{constructor(){this.aPa=this.wS=this.uAa=null;this.qmf=!1;this.n5e=null;this.o5e=this.VTb=0}get messageId(){return this.uAa}get values(){return this.wS}get userSessionId(){return this.aPa}get shouldRetry(){return this.qmf}get KEc(){return this.n5e}get Ewa(){return this.VTb}get b3h(){return this.o5e}static dFi(a,
b){var c=gf.a.uIi;const h=new Ji;h.uAa=a;h.wS={};h.aPa=b;h.qmf=!0;h.n5e=c;h.VTb=3;h.o5e=1E3;return h}}Object(n.a)(Ji,"PostMessageData",null,[]);class ji{constructor(a,b,c){this.rKd={};this.$a=a;this.eBd=c;this.OZj();this.pOk(b)}OZj(){if(this.$a.ka("DocRebootIsSupported")||this.$a.ka("UiHostSupportsDocRebootFeatures"))this.rKd[uh.a.refresh]=()=>this.e3k(gf.a.VCa)}pOk(a){a.ya(H.a.odh,he.a.frame,Object(F.a)(this,this.G2k,"sendActionToHostIfSupported"))}G2k(a,b,c,h,m){if(2!==c)return 32;if(!m)return ba.ULS.sendTraceTag(41972610,
204,15,"HostActionExecutionManager - No actionData provided"),16;a=m.toLowerCase();return this.rKd[a]?(ba.ULS.sendTraceTag(41972611,204,50,"HostActionExecutionManager - executing host action for action id {0}",a),this.rKd[a]()):2}e3k(a){const b=Ji.dFi(a,u.AFrameworkApplication.userSessionId);this.eBd.execute(c=>{c.postMessage(b)});return 32}}Object(n.a)(ji,"HostActionExecutionManager",null,[]);var hk=d(116),hh=d(721);class om extends rh.a{constructor(a,b,c,h){super(a,b,c);this.mSb=this.O6=0;this.lbf=
!1;this.oSb=0;this.dBd=this.myc=null;this.mbf=this.nbf=!1;this.Ca=h;this._name="HostIntegrationMessenger";this.create()}myj(a){const b=a.message,c=a.Yi.origin;u.AFrameworkApplication.wopiHostOriginFromPostMessage||(u.AFrameworkApplication.wopiHostOriginFromPostMessage=c);switch(b.MessageId){case gf.a.fRd:case gf.a.hRd:this.gyj(b);break;case gf.a.p$d:case gf.a.q$d:this.Bsd();break;case gf.a.ube:this.oyj(b);break;case gf.a.bbb:this.jWj(b);break;case gf.a.a4e:this.Hgi(a);break;case gf.a.e4e:this.awl()}}zvl(a){switch(a.MessageId){case gf.a.qbe:u.AFrameworkApplication.Ta.La(H.a.$kd,
2,a.Values[hd.a.direction]);break;case gf.a.zxb:ba.ULS.sendTraceTag(42481157,204,50,"Host_Unload Received");u.AFrameworkApplication.Ta.La(H.a.zxb,2,(new Date).getTime());break;case gf.a.rbe:ba.ULS.sendTraceTag(544221062,204,50,"We received HostBackButtonPressed message in WAC");break;case gf.a.sbe:ba.ULS.sendTraceTag(543459140,204,50,"Host_GetClientUrl Recieved");u.AFrameworkApplication.Ta.processAction(H.a.O3i,2);break;case gf.a.s7b:ba.ULS.sendTraceTag(541894173,204,50,"Host_CopyLink Recieved");
u.AFrameworkApplication.Ta.processAction(H.a.s7b,2);break;case gf.a.tbe:ba.ULS.sendTraceTag(539760468,204,50,"Host_GetWebUrl Received");u.AFrameworkApplication.Ta.processAction(H.a.Smj,2);break;case gf.a.xbe:ba.ULS.sendTraceTag(537424842,204,50,"Host_SendChannelId Received")}}Bsd(){C.FocusManager.instance()&&C.FocusManager.instance().Be&&C.FocusManager.instance().Be.name===u.AFrameworkApplication.bhb&&C.FocusManager.instance().x5(C.FocusManager.instance().Be.name)}gyj(a){C.FocusManager.instance().tY(u.AFrameworkApplication.bhb,
!1);if(hd.a.cqc in a.Values){const b={};b[hd.a.cqc]=a.Values[hd.a.cqc];ba.ULS.sendTraceTag(38278996,204,50,dd.c(b))}}oyj(a){if(!ng.a.dT(document.URL,u.AFrameworkApplication.Vbd)&&a.Values){var b=0,c=0;try{b=a.Values[hd.a.pyj],c=a.Values[hd.a.qyj],hd.a.kag in a.Values?this.myc=a.Values[hd.a.kag]:hd.a.lag in a.Values&&(this.myc=a.Values[hd.a.lag]),hd.a.mag in a.Values&&(this.dBd=a.Values[hd.a.mag])}catch(h){return}this.mSb=b;this.oSb=c;this.O6&&this.iog()}}jWj(a){ba.ULS.sendTraceTag(37536415,204,50,
"JsApiDiagnostics");var b=a.Values[hd.a.lyj];b&&Jj.a.instance.VMk(b);(b=a.Values[hd.a.aUd])&&Jj.a.instance.IMk(b);(a=a.Values[hd.a.bbb])&&Jj.a.instance.$Mk(a)}Hgi(a){ba.ULS.sendTraceTag(40433733,338,50,"Receive Wac_BeforeUnloadApp. Timestamp: {0}",Date.now());u.AFrameworkApplication.Azb=!0;u.AFrameworkApplication.Aa.w1.PEe(a.Yi.pc)}awl(){ba.ULS.sendTraceTag(40433734,338,50,"Receive Wac_UnloadApp. Timestamp: {0}",Date.now());u.AFrameworkApplication.Aa.w1.rGe(null,Sys.EventArgs.Empty)}iog(){this.Q0j();
this.R0j();null!=this.myc&&Jj.a.instance.WMk(this.myc);null!=this.dBd&&Jj.a.instance.XMk(this.dBd)}Q0j(){this.O6&&this.mSb&&!this.lbf&&(this.lbf=!0,this.mSb>this.O6||(u.AFrameworkApplication.jj.setDw(10324,this.O6-this.mSb),Jj.a.instance.pfh(this.mSb)))}R0j(){this.O6&&this.oSb&&!this.nbf&&(this.nbf=!0,this.oSb>this.O6||(u.AFrameworkApplication.jj.setDw(10325,this.O6-this.oSb),Jj.a.instance.BNk(this.oSb)))}BWk(){var a=qd.a.z6f();if(a){var b=0;a=a.fetchStart;void 0!==a&&null!==a&&(b=a);0>=b||b>this.O6||
u.AFrameworkApplication.jj.setDw(11045,this.O6-b)}}create(){u.AFrameworkApplication.kfg&&this.disable();this.sLa!==hh.a.jYb&&this.uBa(this.sLa);this.Ca.ra(H.a.tMi,he.a.frame,Object(F.a)(this,this.yMi,"disposeInstance"),96);this.pu(gf.a.fRd);this.pu(gf.a.hRd);this.pu(gf.a.p$d);this.pu(gf.a.q$d);this.pu(gf.a.ube);this.pu(gf.a.wbe);this.pu(gf.a.lPd);const a=Object(F.a)(this,this.myj,"hostMessageHandler");this.KZa(gf.a.fRd,a);this.KZa(gf.a.hRd,a);this.KZa(gf.a.p$d,a);this.KZa(gf.a.q$d,a);this.KZa(gf.a.ube,
a);u.AFrameworkApplication.fa.ka("OneNoteEmbedUnloadIsEnabled")&&(this.Qpf(gf.a.a4e),this.Qpf(gf.a.e4e),this.KZa(gf.a.a4e,a),this.KZa(gf.a.e4e,a));if(u.AFrameworkApplication.fa.ka("PostMessageEmbedded")||u.AFrameworkApplication.fa.ka("IsJsApi")){this.pu(gf.a.zxb);const b=Object(F.a)(this,this.zvl,"uiHostMessageHandler");u.AFrameworkApplication.fa.ka("SupportsAccessibilityLoop")&&(this.pu(gf.a.qbe),this.zB(gf.a.qbe,b));this.zB(gf.a.zxb,b);u.AFrameworkApplication.fa.ka("MobileEmbedViewerIsEnabled")&&
(this.pu(gf.a.sbe),this.zB(gf.a.sbe,b),this.pu(gf.a.rbe),this.zB(gf.a.rbe,b),this.pu(gf.a.s7b),this.zB(gf.a.s7b,b),this.pu(gf.a.tbe),this.zB(gf.a.tbe,b));u.AFrameworkApplication.fa.ka("OneNotePageLevelConversationInTeamsIsEnabled")&&(this.pu(gf.a.xbe),this.zB(gf.a.xbe,b))}u.AFrameworkApplication.fa.ka("IsJsApi")&&(this.pu(gf.a.bbb),this.KZa(gf.a.bbb,a))}yMi(a,b,c){if(2!==c)return 32;hk.a.Fx(this);return 32}reportDocumentLoadedTime(a){this.mbf||(this.O6=a,this.BWk(),this.sLa!==hh.a.jYb&&this.sendMessage(gf.a.Eci,
{["DocumentLoadedTime"]:a}),this.iog(),this.mbf=!0)}}Object(n.a)(om,"HostIntegrationMessenger",rh.a,[975,867,106]);class wo{constructor(){this.Da=null}get name(){return"Common.App.Postmessengers"}init(){u.AFrameworkApplication.fa.jf(()=>{this.yce(this.Da)})}yce(a){u.AFrameworkApplication.BQ=a.resolve("Common.App.Postmessengers.HostIntegrationMessenger");u.AFrameworkApplication.fa.ka("HostActionExecutionIsEnabled")&&a.resolve("Common.App.HostActionExecutionManager")}dispose(){}$b(a){this.Da=a;a.register(om,
"Common.App.Postmessengers.HostIntegrationMessenger").as("Postmessage.IHostPostmessenger").ma().oa(()=>{u.AFrameworkApplication.fa.vda||ba.ULS.sendTraceTag(5886165,204,10,"HostIntegrationMessenger instantiated before full app settings ready");const b=u.AFrameworkApplication.xna?u.AFrameworkApplication.xna:hh.a.jYb;ba.ULS.sendTraceTag(536987587,204,50,"HostIntegrationMessenger instantiating");return new om(window.parent,b,kh.a.instance,u.AFrameworkApplication.Ta)});a.register(ji,"Common.App.HostActionExecutionManager").ma().oa(()=>
{u.AFrameworkApplication.fa.vda||ba.ULS.sendTraceTag(41972612,204,10,"HostSupportedActionManager instantiated before full app settings ready");return new ji(u.AFrameworkApplication.fa,u.AFrameworkApplication.Ta,a.Ja("Postmessage.IHostPostmessenger"))})}}Object(n.a)(wo,"PostmessengersPackage",null,[2,3]);var En=d(404),Mk=d(312),di=d(271),zf=d(213);class go extends zf.a{constructor(){super();this.PersonaId=this.DisplayName=null;this.IsAnonymous=!1}get ControlType(){return 4}}Object(n.a)(go,"PersonaButtonProps",
zf.a,[]);class op{G0b(a,b){if(a&&!(1>a.length)&&b){var c=Object.assign(new di.a,{ExternalId:"msPresenceOuter",ControlList:[]});this.qCi(a,c.ControlList);b.push(c)}}qCi(a,b){const c=Object.assign(new En.a,{ExternalId:"ContextCoauthors",LabelText:CommonUIStrings.l_PresenceMenuSectionTitle,Menu:Object.assign(new Mk.a,{ExternalId:"msPresenceInner",UpdateDynamically:!0,ShouldAutoOpen:!1,MenuSectionList:[]})});Array.add(b,c);b=Object.assign(new di.a,{Title:"",ControlList:[]});Array.add(c.Menu.MenuSectionList,
b);this.yEi(a,b.ControlList)}yEi(a,b){for(let c=0;c<a.length;c++){const h=Object.assign(new go,{ExternalId:String.format("CoauthorPersona_{0}",c),Command:"336231556",DisplayName:a[c].userName,LabelText:a[c].userName,ImageBackColor:a[c].color,PersonaId:a[c].email,IsAnonymous:a[c].isAnonymous});Array.add(b,h)}}}Object(n.a)(op,"PresenceContextMenuSectionBuilder",null,[448]);var jr=d(350);class et{constructor(a,b,c,h){this.hZ=this.ho=this.Tm=this.zf=this.qpa=null;this.dDc=a;this.D_h=h;this.dDc.ahe&&(this.Tm=
new He.a(3,2,5E3,Object(F.a)(this,this.Xfi,"authenticationCheckTask"),2),u.AFrameworkApplication.we.Eb(this.Tm),this.vb(b,c));this.dDc.S7h(()=>{this.Yic()});this.dDc.Urf(()=>{this.Zic()})}get businessBar(){return this.ho||(this.ho=vb.a.instance.rb("CommonUI.IBusinessBar"))}get Yyf(){return this.hZ||(this.hZ=vb.a.instance.rb("CommonUI.IBusinessBarEntryFactory"))}vb(a,b){const c=u.AFrameworkApplication.Ta;c.ra(H.a.Owf,he.a.frame,a,96);c.ra(H.a.Pwf,he.a.frame,b,96);c.ya(H.a.uBf,he.a.frame,ed.ActionManager.ov);
c.ya(H.a.vBf,he.a.frame,ed.ActionManager.ov);c.ya(H.a.dme,he.a.frame,ed.ActionManager.ov)}Yic(){this.showDialog(CommonUIStrings.l_AuthenticationLostMessage);u.AFrameworkApplication.Ta.processAction(H.a.Owf,2)}Zic(){this.Jol();u.AFrameworkApplication.Ta.processAction(H.a.Pwf,2)}Xfi(){this.dDc.authenticationCheck()}Jol(){this.zf&&(this.zf.hide(),this.zf.dispose(),this.zf=null);this.qpa&&this.businessBar&&(u.AFrameworkApplication.Tg||this.businessBar.removeEntry(this.qpa),this.qpa.dispose(),this.qpa=
null)}showDialog(a){hk.a.Fx(this.zf);this.zf=new Rf.StandardDialog;this.D_h||(this.zf.yr=!1,this.zf.xd=0);this.zf.Xe(1,CommonUIStrings.l_SignIn);this.zf.cP(CommonUIStrings.l_DefaultDialogTitle,a,Object(F.a)(this,this.Z2,"dialogHandler"))}Z2(a){1===a?(jr.a.xgd(),this.showDialog(CommonUIStrings.l_AuthenticationLostSigninInProgressMessage),u.AFrameworkApplication.Ta.processAction(H.a.dme,2)):(this.$el(),u.AFrameworkApplication.Ta.processAction(H.a.vBf,2))}$el(){this.businessBar&&this.Yyf&&(this.qpa=
this.Yyf.create(CommonUIStrings.l_AuthenticationLostTitle,CommonUIStrings.l_AuthenticationLostMessage,null),this.qpa.closeable=!0,this.qpa.addButton(CommonUIStrings.l_SignIn,et.Hki,""),this.qpa.P2=Object(F.a)(this,this.Iki,"businessBarEntryCloseHandler"),this.businessBar.Yh(this.qpa,!1))}Iki(){this.KLi();u.AFrameworkApplication.Ta.processAction(H.a.uBf,2)}KLi(){this.Tm&&(u.AFrameworkApplication.we.Rg(this.Tm),this.Tm=null)}dispose(){this.Tm=this.zf=this.qpa=null}static Hki(){jr.a.xgd();u.AFrameworkApplication.Ta.processAction(H.a.dme,
2)}}Object(n.a)(et,"SignOutResponseUI",null,[106]);class Vo{get name(){return"Common.App.UI"}$b(a){a.register(op,"Common.App.UI.PresenceContextMenuSectionBuilder").as("Common.App.UI.IPresenceContextMenuSectionBuilder").ma()}init(){}dispose(){hk.a.Fx(Vo.Iba);Vo.Iba=null}static main(){r.a.instance.Dc(new Vo)}static YBj(a,b,c){Vo.Mel()&&(Vo.Iba=new et(jr.a.instance,a,b,c))}static Mel(){return u.AFrameworkApplication.ZZg&&!u.AFrameworkApplication.isEmbedded}}Vo.Iba=null;Object(n.a)(Vo,"CommonAppUIPackage",
null,[2,3]);class ft{constructor(a){this.QAa=this.KAa=this.VAa=this.UAa=null;this.Taf=this.Tef=this.zP=this.qba=!1;this.XHd=this.jff=null;this.dff=0;this.$a=this.iff=null;this.$ga=a;this.eK=3;this.MSb=!0}initialize(a,b,c){this.UAa=this.q8d(a,b);this.VAa=CommonUIStrings.l_SavingStatus;this.KAa=CommonUIStrings.l_ReadOnlyStatus;this.QAa=CommonUIStrings.l_ReviewModeStatus;this.$ga&&this.$ga.execute(h=>{h.JFc(Object(F.a)(this,this.Itc,"updateToSavingStatus"))});this.zP=!0;this.$a=c;return!0}Xoa(a,b){this.qba=
a;this.eK=b;this.updateSaveStatusText(this.MSb)}updateSaveStatusText(a){!this.MSb&&a&&(this.iff=new Date);this.MSb=a;a=null;3===this.eK&&(a=this.MSb?this.UAa:this.VAa);this.aMi(a)}q8d(a,b){return a?String.format(CommonUIStrings.l_SavedToStatus,CommonUIStrings.l_OneDriveName):b&&b.length?String.format(CommonUIStrings.l_SavedToStatus,b):CommonUIStrings.l_SavedStatus}Itc(){this.updateSaveStatusText(!1)}Hbj(){switch(this.eK){case 1:return this.KAa;case 2:return this.QAa;default:return null}}mKj(a){return this.Tef===
this.qba&&this.dff===this.eK&&this.jff===a}uZd(a){appChrome.getHeaderApi().then(b=>{b.updateDocumentTitleStatus(this.qba,a,this.Hbj(),this.iff,this.MSb);this.Taf=!0;return null});this.XHd=null}aMi(a){this.zP&&Dg.c()&&!this.mKj(a)&&(!this.Taf&&this.$a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExpediteFirstSaveStatusAction",!1)?this.uZd(a):qd.a.iQe()?(this.XHd&&ba.ULS.sendTraceTag(595146389,340,50,"Previous UpdateDocumentTitleStatus idle callback can be cancelled."),this.XHd=window.requestIdleCallback(()=>
{this.uZd(a)})):window.requestAnimationFrame(()=>{this.uZd(a)}),this.Tef=this.qba,this.jff=a,this.dff=this.eK)}}Object(n.a)(ft,"ReactSaveStatusUIHandler",null,[1328]);class Wv{constructor(a,b){this.BQ=null;this.UAa=CommonUIStrings.l_SavedStatus;this.VAa=CommonUIStrings.l_SavingStatus;this.KAa=CommonUIStrings.l_ReadOnlyStatus;this.QAa=CommonUIStrings.l_ReviewModeStatus;this.iAa=b;this.$ga=a;this.eK=3;this.FOa=!0}HJ(){this.$ga&&this.$ga.execute(a=>{a.JFc(Object(F.a)(this,this.Itc,"updateToSavingStatus"))});
this.iAa.execute(a=>{this.BQ=a})}Xoa(a,b){this.eK=b;3===b?this.updateSaveStatusText(this.FOa):2===b?this.H1e(this.QAa):this.H1e(this.KAa)}Itc(){this.updateSaveStatusText(!1)}updateSaveStatusText(a){this.FOa=a;this.H1e(this.FOa?this.UAa:this.VAa)}H1e(a){this.BQ&&this.BQ.sendMessage(gf.a.xvl,this.Yxi(a))}Yxi(a){const b={};b.StatusText=a;return b}}Object(n.a)(Wv,"SaveStatusPostMessageHandler",null,[1328]);var mm=d(263);class nA{constructor(a,b,c,h){this.QAa=this.KAa=this.VAa=this.UAa=null;this.E3a=0;
this.IP=this.LId=this.J1a=this.cwd=this.jLd=null;this.$e=a;this.Spa=b;this.$ga=c;this.Vi=h;this.Tcf=!0;this.qba=!1;this.eK=3;this.FOa=!0}initialize(a,b){if(!this.$e)return!1;this.UAa=this.q8d(a,b);this.VAa=CommonUIStrings.l_SavingStatus;this.KAa=CommonUIStrings.l_ReadOnlyStatus;this.QAa=CommonUIStrings.l_ReviewModeStatus;this.HJ();return!0}q8d(a,b){return a?String.format(CommonUIStrings.l_SavedToStatus,CommonUIStrings.l_OneDriveName):b&&b.length?String.format(CommonUIStrings.l_SavedToStatus,b):CommonUIStrings.l_SavedStatus}HJ(){this.Spa&&
this.Spa.execute(a=>{a.a$h(Object(F.a)(this,this.dJf,"createStatusAndModeElements"));a.J9h(Object(F.a)(this,this.dgl,"showHideSaveStatusElement"));a.lrl&&this.dJf(null,null)});this.$ga&&this.$ga.execute(a=>{a.JFc(Object(F.a)(this,this.Itc,"updateToSavingStatus"))})}nza(){this.IP&&this.$e&&this.$e.btd(this.IP)}dgl(a,b){this.Xoa("true"===b,this.eK)}Xoa(a,b){this.qba=a;this.eK=b;this.cwd&&(this.cwd.style.display=this.qba||3===this.eK||!this.jLd?"none":"");this.J1a&&(this.J1a.style.display=this.qba||
3===this.eK?"none":"",this.J1a.innerText=1===this.eK?this.KAa:this.QAa,this.J1a.title=1===this.eK?CommonUIStrings.l_ReadOnlyStatusTooltip:CommonUIStrings.l_ReviewModeStatusTooltip);this.LId&&(this.LId.style.display=this.qba||1===this.eK||!this.jLd&&!this.J1a?"none":"");this.IP&&(this.IP.style.display=this.qba||1===this.eK?"none":"",this.updateSaveStatusText(this.FOa),this.IP.title=CommonUIStrings.l_SaveStatusTooltip)}dJf(a,b){a=document.getElementById(mm.CuiHelper.oxj);b&&b.FEl||!a||""===this.UAa||
""===this.VAa||""===this.KAa||""===this.QAa||(this.jLd=document.getElementById(mm.CuiHelper.tRd),this.cwd=mm.CuiHelper.AKc(a,"BreadcrumbAppModeDash","-"),this.J1a=mm.CuiHelper.AKc(a,"BreadcrumbAppModeStatus",1===this.eK?this.KAa:this.QAa),this.OFh(this.J1a),this.LId=mm.CuiHelper.AKc(a,"BreadcrumbSaveStatusDash","-"),this.IP=mm.CuiHelper.AKc(a,"BreadcrumbSaveStatus",this.UAa),this.OFh(this.IP),this.Xoa(this.qba,this.eK))}Itc(){this.updateSaveStatusText(!1)}updateSaveStatusText(a){this.FOa=a;this.gAl(this.FOa?
this.UAa:this.VAa)}gAl(a){!this.IP||3!==this.eK&&2!==this.eK||(this.Tcf&&!this.FOa?(this.E3a=this.IP.offsetWidth<this.E3a?this.E3a:this.IP.offsetWidth,this.dxl(this.VAa),this.Tcf=!1):this.IP.innerText=a)}OFh(a){a.style.direction=this.Vi?"rtl":"ltr";a.style.width="auto";a.style.textAlign=this.Vi?"right":"left";a.style.display=this.qba?"none":"";a.setAttribute("Unselectable","on")}dxl(a){this.IP&&(this.IP.style.width="",this.IP.innerText=a,this.E3a=this.IP.offsetWidth<this.E3a?this.E3a:this.IP.offsetWidth,
a=Oe.a.Qt(this.IP),this.IP.style.width=this.E3a-La.a.oM(a.paddingLeft)-La.a.oM(a.paddingRight)+1+"px")}}Object(n.a)(nA,"SaveStatusUIHandler",null,[1328]);class gF{constructor(){this.MId=this.CHd=this.EVb=this.Da=null}get name(){return"Common.App.SaveStatus"}$b(a){this.Da=a;u.AFrameworkApplication.fa.ka("PostMessageEmbedded")&&u.AFrameworkApplication.zQ?this.Da.register(Wv,"Common.App.SaveStatus.SaveStatusPostMessageHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").ma().oa(()=>new Wv(this.Da.Ja("Common.App.HostNotification.EditNotificationEventSource"),
this.Da.Ja("Postmessage.IHostPostmessenger"))):u.AFrameworkApplication.Aa.hb.ykg||(u.AFrameworkApplication.Aa.hb.WN?this.Da.register(ft,"Common.App.SaveStatus.ReactSaveStatusUIHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").ma().oa(()=>new ft(this.Da.Ja("Common.App.HostNotification.EditNotificationEventSource"))):this.Da.register(nA,"Common.App.SaveStatus.SaveStatusUIHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").ma().oa(()=>new nA(Fd.EventHandlerManager.instance,this.Da.Ja("Common.App.Header.HeaderEventSource"),
this.Da.Ja("Common.App.HostNotification.EditNotificationEventSource"),u.AFrameworkApplication.isRtl)))}init(){u.AFrameworkApplication.fa.jf(Object(F.a)(this,this.Om,"onFullAppSettingsReady"))}Om(){const a=u.AFrameworkApplication.fa,b=!!u.AFrameworkApplication.Aa.hb&&4===u.AFrameworkApplication.Aa.hb.Vk;if(a.ka("WordEditorAutoSaveImprovementIsEnabled")||a.ka("PptEditorSaveStatusInHeaderEnabled")||b&&a.ka("SimplifiedReactRibbonUxIsEnabled")||a.ka("ExcelSaveStatusInHeaderEnabled")||a.ka("VisioSaveStatusInHeaderEnabled"))u.AFrameworkApplication.fa.ka("PostMessageEmbedded")&&
u.AFrameworkApplication.zQ?(this.MId=this.Da.resolve("Common.App.SaveStatus.SaveStatusPostMessageHandler"))&&this.MId.HJ():u.AFrameworkApplication.Aa.hb.ykg||a.ka("PreventSaveStatusInitializationWithHiddenHeader")&&u.AFrameworkApplication.hideHeader||(u.AFrameworkApplication.Aa.hb.WN?(this.CHd=this.Da.resolve("Common.App.SaveStatus.ReactSaveStatusUIHandler"))&&this.CHd.initialize(a.ka("IsSkyDrive"),a.Ha("HostNameToIncludeInSavedStatus"),u.AFrameworkApplication.fa):(this.EVb=this.Da.resolve("Common.App.SaveStatus.SaveStatusUIHandler"))&&
this.EVb.initialize(a.ka("IsSkyDrive"),a.Ha("HostNameToIncludeInSavedStatus")))}dispose(){this.EVb&&this.EVb.nza()}}Object(n.a)(gF,"PackageManager",null,[2,3]);window.PPTCampaignsObj_FromAppPackage=[{CampaignId:"7BC32D60-19AD-41B5-A039-4408D47C5884",LauncherType:"customervoice",StartTimeUtc:"2020-01-01T00:00:00Z",EndTimeUtc:"2022-09-30T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:0,NominationScheme:{Type:0,PercentageNumerator:2,PercentageDenominator:100,
NominationPeriod:{Type:0,IntervalSeconds:2592E3},CooldownPeriod:{Type:0,IntervalSeconds:7776E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:4,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"AppUsageNPS",IsAggregate:!0,Count:300},{Type:0,Activity:"AppUsageTimeSatisfiedNPS",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"nps_Title",Question:"nps_OneClickPromptQuestion",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"nps_RatingQuestion_PowerPoint",RatingValuesAscending:["nps_OneClickRating_Values_1",
"nps_OneClickRating_Values_2","nps_OneClickRating_Values_3","nps_OneClickRating_Values_4","nps_OneClickRating_Values_5"]},Question:{Question:"nps_QuestionQuestion"},CVSurveyParams:{CustomerVoiceFormId:"OQWcQhU2qEGdoz_3ZmewCrD2WXeriEdEnzV6LlcPT5JURFhIWVJFRVVSTDRCSExHUEdXMzQ3OFoyMy4u"}}}},{CampaignId:"281ff77f-ec20-4b5b-88dc-674ede3473ee",LauncherType:"customervoice",StartTimeUtc:"2018-09-04T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],
PrimaryPriority:0,NominationScheme:{Type:0,PercentageNumerator:22,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1296E3},CooldownPeriod:{Type:0,IntervalSeconds:7776E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:4,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"AppUsageNPS",IsAggregate:!0,Count:300},{Type:0,Activity:"AppUsageTimeSatisfiedNPS",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"nps_Title",Question:"nps_PromptQuestion",YesLabel:"Sure",NoLabel:"Not now"},
Rating:{Question:"nps_RatingQuestion_PowerPoint",RatingValuesAscending:["nps_Rating_Values_1","nps_Rating_Values_2","nps_Rating_Values_3","nps_Rating_Values_4","nps_Rating_Values_5"]},Question:{Question:"nps_QuestionQuestion"},CVSurveyParams:{CustomerVoiceFormId:"OQWcQhU2qEGdoz_3ZmewCpFge6Cl3sRFoOMTPf8V7pNUMFpIMk1RSVo3WDhFQ0tPM0JPQ0VZOFc0Ty4u"}}}},{CampaignId:"39c281be-953d-4788-8878-2361b1574fe6",StartTimeUtc:"2019-02-25T00:00:00Z",EndTimeUtc:"2025-12-30T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],
PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:25,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1209600},CooldownPeriod:{Type:0,IntervalSeconds:2592E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"CoauthContentMerge",IsAggregate:!0,Count:1}]},Content:{Prompt:{Title:"Another person is editing the file with you right now.",Question:"We have just 2 questions.",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"Please rate your experience working with others at the same time in PowerPoint Online.",
RatingValuesAscending:["1 - Not satisfied","2","3","4","5 - Very satisfied"]},Question:{Question:"Please describe how we can make real-time collaboration better for you."}}}},{CampaignId:"092b8d95-cf3f-4172-a11b-f5bbc03077ac",LauncherType:"customervoice",StartTimeUtc:"2019-04-01T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:0,NominationScheme:{Type:0,PercentageNumerator:2,PercentageDenominator:100,NominationPeriod:{Type:0,
IntervalSeconds:2592E3},CooldownPeriod:{Type:0,IntervalSeconds:7776E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:4,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"SuiteUsageNPS",IsAggregate:!0,Count:300},{Type:0,Activity:"SuiteUsageTimeSatisfiedNPS",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"nps_Title",Question:"nps_PromptQuestion",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"nps_Suite_RatingQuestion",RatingValuesAscending:["nps_Rating_Values_1","nps_Rating_Values_2",
"nps_Rating_Values_3","nps_Rating_Values_4","nps_Rating_Values_5"]},Question:{Question:"nps_Suite_QuestionQuestion"},CVSurveyParams:{CustomerVoiceFormId:"OQWcQhU2qEGdoz_3ZmewCrD2WXeriEdEnzV6LlcPT5JURDNVQ1BHVkxLUUpKTk80UDZDMk1TMFlPOC4u"}}}},{CampaignId:"99e8783d-e51c-401f-843f-b59f8ef58754",StartTimeUtc:"2019-03-01T00:00:00Z",EndTimeUtc:"2020-09-01T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,
NominationPeriod:{Type:0,IntervalSeconds:86400},CooldownPeriod:{Type:0,IntervalSeconds:2419200},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"VersionHistoryExited",IsAggregate:!0,Count:1},{Type:0,Activity:"VersionHistoryCheckExited",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"We'd love your feedback on Version History.",Question:"We have two questions for you.",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"How would you rate your experience with using Version History?",
RatingValuesAscending:["1 - Extremely negative","2 - Somewhat negative","3 - Neither negative nor positive","4 - Somewhat positive","5 - Extremely positive"]},Question:{Question:"Please tell us why you chose that answer."}}}},{CampaignId:"75fcdcee-a30b-4545-969e-1e24599c8ceb",StartTimeUtc:"2020-09-23T00:00:00Z",EndTimeUtc:"2021-10-01T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:50,PercentageDenominator:100,
NominationPeriod:{Type:0,IntervalSeconds:1209600},CooldownPeriod:{Type:0,IntervalSeconds:2592E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"VersionHistoryRestoreCoauthFailed",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"VHRestore_Title",Question:"VHRestore_PromptQuestion",YesLabel:"VHRestore_Sure",NoLabel:"VHRestore_NotNow"},Rating:{Question:"VHRestore_SurveyQuestion",RatingValuesAscending:["VHRestore_Answer_Options_1","VHRestore_Answer_Options_2",
"VHRestore_Answer_Options_3","VHRestore_Answer_Options_4"]},Question:{Question:"VHRestore_WhyQuestion"}}}},{CampaignId:"254748d4-1af8-4c34-ab56-303ae10e6719",StartTimeUtc:"2019-03-11T00:00:00Z",EndTimeUtc:"2022-08-26T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:0,NominationScheme:{Type:0,PercentageNumerator:25,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:604800},CooldownPeriod:{Type:0,IntervalSeconds:5184E3},FallbackSurveyDurationSeconds:120},
SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"LinkedInWACUsage",IsAggregate:!0,Count:300},{Type:0,Activity:"LinkedInWACUsageTimeSatisfied",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"Hey LinkedIn, we need your help to make Office better!",Question:"We have two questions for you.",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"How satisfied are you with PowerPoint Online?",RatingValuesAscending:["1 - Extremely dissatisfied","2 - Somewhat dissatisfied","3 - Neither satisfied nor dissatisfied",
"4 - Somewhat satisfied","5 - Extremely satisfied"]},Question:{Question:"Tell us why you gave this rating"}}}},{CampaignId:"278833a1-5538-4739-8fe7-9a7e23336414",StartTimeUtc:"2019-02-25T00:00:00Z",EndTimeUtc:"2025-12-30T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592E3},CooldownPeriod:{Type:0,IntervalSeconds:7776E3},FallbackSurveyDurationSeconds:120},
SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"TranscriptionUsed",IsAggregate:!0,Count:1}]},Content:{Prompt:{Title:"We'd love your feedback on live captions & subtitles.",Question:"It will only take a few seconds.",YesLabel:"AtMentionFS_YesLabel",NoLabel:"AtMentionFS_NoLabel"},Rating:{Question:"How satisfied were you and your audience with the live captions or subtitles experience?",RatingValuesAscending:["1 - Not satisfied","nps_Rating_Values_2","nps_Rating_Values_3",
"nps_Rating_Values_4","5 - Very satisfied"]},Question:{Question:"Please tell us what you liked or didn't like."}}}},{CampaignId:"b698805c-10fa-46d5-a06b-9a41620c5427",StartTimeUtc:"2019-08-13T00:00:00Z",EndTimeUtc:"2024-12-31T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1209600},CooldownPeriod:{Type:0,IntervalSeconds:2592E3},FallbackSurveyDurationSeconds:120},
SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"CatchUpChangesFeedback",IsAggregate:!0,Count:3}]},Content:{Prompt:{Title:"CatchUpFPS_Title",Question:"CatchUpFPS_Question",YesLabel:"CatchUpFPS_YesLabel",NoLabel:"CatchUpFPS_NoLabel"},Rating:{Question:"CatchUpFPS_RatingQuestion",RatingValuesAscending:["CatchUpFPS_RatingValue_1","CatchUpFPS_RatingValue_2","CatchUpFPS_RatingValue_3","CatchUpFPS_RatingValue_4","CatchUpFPS_RatingValue_5"]},Question:{Question:"CatchUpFPS_WhyQuestion"}}}},
{CampaignId:"ceef766d-7ae7-4f83-bf61-a2254bb05e45",StartTimeUtc:"2022-02-21T00:00:00Z",EndTimeUtc:"2022-08-21T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592E3},CooldownPeriod:{Type:0,IntervalSeconds:7776E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"PPTWebCommitNewCommentActivity",
IsAggregate:!0,Count:5}]},Content:{Prompt:{Title:"Please tell us about your experience using the Comments feature in PowerPoint",Question:"We have just two questions for you.",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"How satisfied are you with the Comments feature in PowerPoint for the web?",RatingValuesAscending:["1 - Extremely dissatisfied","2 - Dissatisfied","3 - Neither satisfied nor dissatisfied","4 - Satisfied","5 - Extremely satisfied"]},Question:{Question:"Please tell us why you chose that rating."}}}},
{CampaignId:"fbff816d-e00a-4269-89eb-21ed37f0b20d",StartTimeUtc:"2020-06-08T00:00:00Z",EndTimeUtc:"2021-08-31T00:00:00Z",GovernedChannelType:0,PrimaryPriority:0,NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:86400},CooldownPeriod:{Type:0,IntervalSeconds:31536E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:4,ActivationEvent:{Type:0,Activity:"UsageForWebAsDefaultFileOpenTeams",IsAggregate:!0,Count:1},Content:{Prompt:{Title:"TeamsOpen_GreetingQuestion",
Question:"TeamsOpen_PromptTitle",YesLabel:"TeamsOpen_GreetingAnswer_Sure",NoLabel:"TeamsOpen_GreetingAnswer_NotNow"},Rating:{Question:"TeamsOpen_RatingQuestion_PowerPoint",RatingValuesAscending:["TeamsOpen_Rating_Browser","TeamsOpen_Rating_Teams"]},Question:{Question:"TeamsOpen_PromptQuestion"}}}},{CampaignId:"e7155ff8-0e35-49c8-ab37-4e230d9548e6",StartTimeUtc:"2020-10-05T00:00:00Z",EndTimeUtc:"2021-10-31T00:00:00Z",GovernedChannelType:0,PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:30,
PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:604800},CooldownPeriod:{Type:0,IntervalSeconds:604800},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"ConvertWordToPresentationActivity",IsAggregate:!0,Count:1}]},Content:{Prompt:{Title:"We'd love to get some quick feedback from you",Question:"We have two questions for you.",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"How satisfied are you with the experience of converting your document to a presentation?",
RatingValuesAscending:["1 - Not satisfied enough","2","3","4","5 - Very satisfied"]},Question:{Question:"What else would you like to share? We'll use your feedback to help improve the experience."}}}},{CampaignId:"826063c4-f637-4317-9dd4-ec099224b8cd",StartTimeUtc:"2021-04-01T00:00:00Z",EndTimeUtc:"2021-10-31T00:00:00Z",GovernedChannelType:0,PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:604800},CooldownPeriod:{Type:0,
IntervalSeconds:604800},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"AgendaToPresentationActivity",IsAggregate:!0,Count:1}]},Content:{Prompt:{Title:"We'd love to get some quick feedback from you",Question:"We have two questions for you.",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"How satisfied are you with the experience of adding slides automatically?",RatingValuesAscending:["1 - Not satisfied enough","2","3","4","5 - Very satisfied"]},
Question:{Question:"What else would you like to share? We'll use your feedback to help improve the experience."}}}},{CampaignId:"f4aa2c06-b017-4702-a6db-83036ab55495",StartTimeUtc:"2021-04-23T00:00:00Z",EndTimeUtc:"2021-10-23T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592E3},CooldownPeriod:{Type:0,IntervalSeconds:7776E3},FallbackSurveyDurationSeconds:120},
SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"PPTWebCommitTaskActivity",IsAggregate:!0,Count:3}]},Content:{Prompt:{Title:"Please tell us about your experience using Tasks in PowerPoint",Question:"We have just two questions for you.",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"How satisfied are you with Tasks in PowerPoint for Web?",RatingValuesAscending:["1 - Extremely dissatisfied","2 - Dissatisfied","3 - Neither satisfied nor dissatisfied","4 - Satisfied","5 - Extremely satisfied"]},
Question:{Question:"Please tell us why you chose that rating."}}}},{CampaignId:"0fd1d222-ab1e-49a2-9c18-3cba5d97c7e6",StartTimeUtc:"2021-08-18T18:30:00Z",EndTimeUtc:"2025-06-30T18:30:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592E3},CooldownPeriod:{Type:0,IntervalSeconds:2592E3}},SurveyTemplate:{Type:2,ActivationEvent:{Type:0,Activity:"ModernFontPickerExperience",
IsAggregate:!0,Count:4},Content:{Prompt:{Title:"FontPicker_FloodgatePromptTitle",Question:"FontPicker_FloodgatePromptQuestion",YesLabel:"FontPicker_FloodgatePromptYesLabel",NoLabel:"FontPicker_FloodgatePromptNoLabel"},Rating:{Question:"FontPicker_FloodgateRatingQuestion",RatingValuesAscending:["FontPicker_FloodgateRating1","FontPicker_FloodgateRating2","FontPicker_FloodgateRating3","FontPicker_FloodgateRating4","FontPicker_FloodgateRating5"]},Question:{Question:"FontPicker_FloodgateCommentQuestion"}}}},
{CampaignId:"8e91c8ee-c5c1-4db3-85d2-bad66e6ddb05",StartTimeUtc:"2021-06-03T00:00:00Z",EndTimeUtc:"2028-06-03T00:00:00Z",GovernedChannelType:0,PrimaryPriority:2,Scope:{Languages:[{Type:0,Value:"cs-CZ"},{Type:0,Value:"de-DE"},{Type:0,Value:"en-GB"},{Type:0,Value:"es-ES"},{Type:0,Value:"fr-FR"},{Type:0,Value:"ja-JP"},{Type:0,Value:"nl-NL"},{Type:0,Value:"pl-PL"},{Type:0,Value:"ru-RU"}],Type:1},NominationScheme:{Type:0,PercentageNumerator:1,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592E3},
CooldownPeriod:{Type:0,IntervalSeconds:7776E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:3,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"AppUsageNLQS",IsAggregate:!0,Count:300},{Type:0,Activity:"AppUsageTimeSatisfiedNLQS",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"FloodgateNLQSPromptTitle",Question:"FloodgateNLQSPromptSubtitle",YesLabel:"FloodgateNLQSPromptYes",NoLabel:"FloodgateNLQSPromptNo"},Rating:{Question:"FloodgateNLQSRatingQuestion",RatingValuesAscending:["FloodgateNLQSRating1",
"FloodgateNLQSRating2","FloodgateNLQSRating3","FloodgateNLQSRating4","FloodgateNLQSRating5"]},Question:{Question:"FloodgateNLQSDetailsQuestion"}}}},{CampaignId:"8e91c8ee-c5c1-4db3-85d2-bad66e6ddb05",StartTimeUtc:"2021-06-03T00:00:00Z",EndTimeUtc:"2028-06-03T00:00:00Z",GovernedChannelType:0,PrimaryPriority:2,Scope:{Languages:[{Type:0,Value:"ar-SA"},{Type:0,Value:"da-DK"},{Type:0,Value:"es-MX"},{Type:0,Value:"fi-FL"},{Type:0,Value:"he-IL"},{Type:0,Value:"hr-HR"},{Type:0,Value:"it-IT"},{Type:0,Value:"ko-KR"},
{Type:0,Value:"nb-NO"},{Type:0,Value:"pt-BR"},{Type:0,Value:"pt-PT"},{Type:0,Value:"sv-SE"},{Type:0,Value:"tr-TR"},{Type:0,Value:"zh-CN"}],Type:1},NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592E3},CooldownPeriod:{Type:0,IntervalSeconds:7776E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:3,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"AppUsageNLQS",IsAggregate:!0,Count:300},{Type:0,Activity:"AppUsageTimeSatisfiedNLQS",
IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"FloodgateNLQSPromptTitle",Question:"FloodgateNLQSPromptSubtitle",YesLabel:"FloodgateNLQSPromptYes",NoLabel:"FloodgateNLQSPromptNo"},Rating:{Question:"FloodgateNLQSRatingQuestion",RatingValuesAscending:["FloodgateNLQSRating1","FloodgateNLQSRating2","FloodgateNLQSRating3","FloodgateNLQSRating4","FloodgateNLQSRating5"]},Question:{Question:"FloodgateNLQSDetailsQuestion"}}}},{CampaignId:"8e91c8ee-c5c1-4db3-85d2-bad66e6ddb05",StartTimeUtc:"2021-06-03T00:00:00Z",
EndTimeUtc:"2028-06-03T00:00:00Z",GovernedChannelType:0,PrimaryPriority:2,Scope:{Languages:[{Type:0,Value:"af-ZA"},{Type:0,Value:"am-ET"},{Type:0,Value:"as-IN"},{Type:0,Value:"az-Latn-AZ"},{Type:0,Value:"be-BY"},{Type:0,Value:"bg-BG"},{Type:0,Value:"bn-BD"},{Type:0,Value:"bn-IN"},{Type:0,Value:"bs-Latn-BA"},{Type:0,Value:"ca-ES"},{Type:0,Value:"chr-Cher-US"},{Type:0,Value:"cy-GB"},{Type:0,Value:"el-GR"},{Type:0,Value:"et-EE"},{Type:0,Value:"eu-ES"},{Type:0,Value:"fa-IR"},{Type:0,Value:"fil-PH"},{Type:0,
Value:"fr-CA"},{Type:0,Value:"ga-IE"},{Type:0,Value:"gd-GB"},{Type:0,Value:"gl-ES"},{Type:0,Value:"gu-IN"},{Type:0,Value:"ha-Latn-NG"},{Type:0,Value:"he-IN"},{Type:0,Value:"hu-HU"},{Type:0,Value:"hy-AM"},{Type:0,Value:"id-ID"},{Type:0,Value:"ig-NG"},{Type:0,Value:"is-IS"},{Type:0,Value:"ka-GE"},{Type:0,Value:"kk-KZ"},{Type:0,Value:"km-KH"},{Type:0,Value:"kn-IN"},{Type:0,Value:"kok-IN"},{Type:0,Value:"ku-Arab-IQ"},{Type:0,Value:"ky-KG"},{Type:0,Value:"lb-LU"},{Type:0,Value:"lo-LA"},{Type:0,Value:"lt-LT"},
{Type:0,Value:"lv-LV"},{Type:0,Value:"mi-NZ"},{Type:0,Value:"mk-MK"},{Type:0,Value:"ml-IN"},{Type:0,Value:"mn-MN"},{Type:0,Value:"mr-IN"},{Type:0,Value:"ms-MY"},{Type:0,Value:"mt-MT"},{Type:0,Value:"ne-NP"},{Type:0,Value:"nn-NO"},{Type:0,Value:"nso-ZA"},{Type:0,Value:"mso-ZA"},{Type:0,Value:"or-IN"},{Type:0,Value:"pa-IN"},{Type:0,Value:"prs-AF"},{Type:0,Value:"ps-AF"},{Type:0,Value:"quc-Latn-GT"},{Type:0,Value:"quz-PE"},{Type:0,Value:"ro-RO"},{Type:0,Value:"rw-RW"},{Type:0,Value:"sd-Arab-PK"},{Type:0,
Value:"si-LK"},{Type:0,Value:"sk-SK"},{Type:0,Value:"sl-SL"},{Type:0,Value:"sq-AL"},{Type:0,Value:"sr-Cyrl-BA"},{Type:0,Value:"sr-Cyrl-RS"},{Type:0,Value:"sr-Latn-RS"},{Type:0,Value:"sw-KE"},{Type:0,Value:"ta-IN"},{Type:0,Value:"te-IN"},{Type:0,Value:"tg-Cyrl-TJ"},{Type:0,Value:"th-TH"},{Type:0,Value:"ti-ET"},{Type:0,Value:"tk-TM"},{Type:0,Value:"tn-ZA"},{Type:0,Value:"tt-RU"},{Type:0,Value:"ug-CN"},{Type:0,Value:"uk-UA"},{Type:0,Value:"ur-PK"},{Type:0,Value:"uz-Latn-UZ"},{Type:0,Value:"vi-VN"},{Type:0,
Value:"wo-SN"},{Type:0,Value:"xh-ZA"},{Type:0,Value:"yo-NG"},{Type:0,Value:"zh-TW"},{Type:0,Value:"zu-ZA"}],Type:1},NominationScheme:{Type:0,PercentageNumerator:50,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:5184E3},CooldownPeriod:{Type:0,IntervalSeconds:15552E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:3,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"AppUsageNLQS",IsAggregate:!0,Count:300},{Type:0,Activity:"AppUsageTimeSatisfiedNLQS",IsAggregate:!1,Count:1}]},
Content:{Prompt:{Title:"FloodgateNLQSPromptTitle",Question:"FloodgateNLQSPromptSubtitle",YesLabel:"FloodgateNLQSPromptYes",NoLabel:"FloodgateNLQSPromptNo"},Rating:{Question:"FloodgateNLQSRatingQuestion",RatingValuesAscending:["FloodgateNLQSRating1","FloodgateNLQSRating2","FloodgateNLQSRating3","FloodgateNLQSRating4","FloodgateNLQSRating5"]},Question:{Question:"FloodgateNLQSDetailsQuestion"}}}},{CampaignId:"c551d75c-10b1-4de2-83cc-cce22d7c06bd",LauncherType:"coachingux",StartTimeUtc:"2021-08-15T00:00:00Z",
EndTimeUtc:null,GovernedChannelType:3,Tags:["FirstRunExperienceV2"],PrimaryPriority:5,Scope:{Type:1,Languages:[{Type:0,Value:"en-US"},{Type:0,Value:"en-GB"},{Type:0,Value:"en-AU"},{Type:0,Value:"en-CA"},{Type:0,Value:"en-IN"}]},NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592E3},CooldownPeriod:{Type:0,IntervalSeconds:7776E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:22,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"ShowFirstRunExperienceUIV2",
Count:1,IsAggregate:!0}]},Metadata:{ContentMetadata:{itemCount:3,surfaceType:"sequence",preFetchDelay:500,preventAutoDismiss:!0,backgroundColor:"#b7472a",buttonHoverColor:"#a92b1a",closeButtonAriaLabel:"Close",position:"left",anchorHint:5,surfaceType1:"teaching",anchorElementSelectors1:"#BreadcrumbSaveStatus #documentTitle #documentTitleContainer #WACRibbon-QATRowCenter #BreadcrumbSaveStatusDash #ResponsiveCenterRegion #AppHeaderPanel div[role='toolbar'] div[class*='cui-topBar1-transistionalHeaderUI'] #o365header #O365_NavHeader".split(" "),
title1:"Never lose your work",description1:"Your file is automatically saved online. Just click the title to rename or change the save location.",illustrationImage1:"https://query.prod.cms.rt.microsoft.com/cms/api/am/binary/RE4yjj0",primaryButtonText1:"Next",delayLoad1:1E3,retryTimes1:3,retryInterval1:500,surfaceType2:"teaching",anchorElementSelectors2:["button[data-unique-id='Share']","button[aria-label='Share']"],title2:"Share and collaborate",description2:"Share your presentation so others can leave comments and feedback, even if they don't have Office themselves.",
illustrationImage2:"https://query.prod.cms.rt.microsoft.com/cms/api/am/binary/RE4yrdA",primaryButtonText2:"Next",surfaceType3:"teaching",anchorElementSelectors3:["button[data-unique-id='Present']","button[aria-label='Present']"],title3:"Start presenting",description3:"When you're ready, click Present to start your slideshow.",illustrationImage3:"https://query.prod.cms.rt.microsoft.com/cms/api/am/binary/RE4ytEj",primaryButtonText3:"Got it"}}}},{CampaignId:"7f5167e4-54e6-4353-a9d7-686741f379b7",LauncherType:"coachingux",
StartTimeUtc:"2022-01-20T00:00:00Z",EndTimeUtc:null,Tags:["ShowTeachingUIForAddinTab"],PrimaryPriority:5,GovernedChannelType:3,Scope:{Type:1,Languages:[{Type:0,Value:"en-US"},{Type:0,Value:"en-GB"},{Type:0,Value:"en-AU"},{Type:0,Value:"en-CA"},{Type:0,Value:"en-IN"}]},NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,FallbackSurveyDurationSeconds:120,NominationPeriod:{Type:0,IntervalSeconds:86400},CooldownPeriod:{Type:0,IntervalSeconds:3600}},SurveyTemplate:{Type:22,MaxLaunches:25,
ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"ShowTeachingUIForAddinTab",Count:1,IsAggregate:!0}]},Metadata:{ContentMetadata:{isAA:!1,isControl:"False",telemetryEventName:"8bf7d424",position:"Left",hasCoachMark:"False",userNativeRender:!1,delayLoad:"1500",retryTimes:"5",retryInterval:500,anchorElementSelectors:"[\"button[lpp-id='latestAddin']\"]",title:"New add-in from your admin\u200b",description:"An add-in was installed to add new capabilities and improve your experience with Office.",primaryButtonText:"Show add-in",
primaryButtonAction:"event:LaunchAddinTaskpane",secondaryButtonText:"Not now",secondaryButtonAction:"event:DismissCallout",closeButtonAction:"event:CloseCallout",closeButtonAriaLabel:"Close"}}}},{CampaignId:"d7f1cbbb-3631-4cae-bc2d-177774aa1190",LauncherType:"coachingux",StartTimeUtc:"2022-01-20T00:00:00Z",EndTimeUtc:null,Tags:["ShowTeachingUIForAddinButton"],PrimaryPriority:5,GovernedChannelType:3,Scope:{Type:1,Languages:[{Type:0,Value:"en-US"},{Type:0,Value:"en-GB"},{Type:0,Value:"en-AU"},{Type:0,
Value:"en-CA"},{Type:0,Value:"en-IN"}]},NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,FallbackSurveyDurationSeconds:120,NominationPeriod:{Type:0,IntervalSeconds:86400},CooldownPeriod:{Type:0,IntervalSeconds:3600}},SurveyTemplate:{Type:22,MaxLaunches:25,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"ShowTeachingUIForAddinButton",Count:1,IsAggregate:!0}]},Metadata:{ContentMetadata:{isAA:!1,isControl:"False",telemetryEventName:"8bf7d424",position:"Left",hasCoachMark:"False",
userNativeRender:!1,delayLoad:"1500",retryTimes:"5",retryInterval:500,anchorElementSelectors:"[\"button[lpp-id='latestAddin']\"]",title:"New add-in from your admin",description:"An add-in was installed to add new capabilities and improve your experience with Office.",primaryButtonText:"Try it",primaryButtonAction:"event:LaunchAddinTaskpane",secondaryButtonText:"Not now",secondaryButtonAction:"event:DismissCallout",closeButtonAction:"event:CloseCallout",closeButtonAriaLabel:"Close"}}}},{CampaignId:"cbb7eaa0-6e95-422d-9647-2be7d2737d4a",
LauncherType:"coachingux",StartTimeUtc:"2022-01-20T08:00:00Z",EndTimeUtc:null,Tags:["ShowTeachingUIForContentAddin"],PrimaryPriority:5,GovernedChannelType:3,Scope:{Type:1,Languages:[{Type:0,Value:"en-US"},{Type:0,Value:"en-GB"},{Type:0,Value:"en-AU"},{Type:0,Value:"en-CA"},{Type:0,Value:"en-IN"}]},NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,FallbackSurveyDurationSeconds:120,NominationPeriod:{Type:0,IntervalSeconds:86400},CooldownPeriod:{Type:0,IntervalSeconds:3600}},
SurveyTemplate:{Type:22,MaxLaunches:25,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"ShowTeachingUIForContentAddin",Count:1,IsAggregate:!0}]},Metadata:{ContentMetadata:{isAA:!1,isControl:"False",telemetryEventName:"8bf7d424",position:"Left",hasCoachMark:"False",userNativeRender:!1,delayLoad:"1500",retryTimes:"5",retryInterval:500,anchorElementSelectors:"[\"button[data-unique-id='Ribbon-InsertAppsForOffice']\", \"button[data-unique-id='Ribbon-InsertAddIns']\", \"button[data-unique-id='Overflow-RibbonOverflowMenu-overflow']\"]",
title:"New add-in from your admin",description:"An add-in was installed to add new capabilities and improve your experience with Office.",primaryButtonText:"Try it",primaryButtonAction:"event:LaunchContentAddin",secondaryButtonText:"Not now",secondaryButtonAction:"event:DismissCallout",closeButtonAction:"event:CloseCallout",closeButtonAriaLabel:"Close"}}}},{CampaignId:"974882c6-f67e-47be-9ba4-4db5c2374610",StartTimeUtc:"2022-04-01T00:00:00Z",EndTimeUtc:"2023-02-01T00:00:00Z",GovernedChannelType:0,
PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1209600},CooldownPeriod:{Type:0,IntervalSeconds:2592E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"MultipleGuestsCoauthoring",IsAggregate:!0,Count:1}]},Content:{Prompt:{Title:"GuestCoauthoring_FloodgatePromptTitle",Question:"GuestCoauthoring_FloodgatePromptQuestion",YesLabel:"GuestCoauthoring_FloodgateYesLabel",
NoLabel:"GuestCoauthoring_FloodgateNoLabel"},Rating:{Question:"GuestCoauthoring_FloodgateQuestion",RatingValuesAscending:["GuestCoauthoring_FloodgateRatingValue_1","GuestCoauthoring_FloodgateRatingValue_2","GuestCoauthoring_FloodgateRatingValue_3","GuestCoauthoring_FloodgateRatingValue_4","GuestCoauthoring_FloodgateRatingValue_5"]},Question:{Question:"GuestCoauthoring_FloodgateRatingQuestion"}}}},{CampaignId:"21c77b4d-1446-4cfe-8881-fa67502a0f14",StartTimeUtc:"2022-05-04T00:00:00Z",EndTimeUtc:"2023-1-31T00:00:00Z",
GovernedChannelType:0,PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:604800},CooldownPeriod:{Type:0,IntervalSeconds:604800}},SurveyTemplate:{Type:2,ActivationEvent:{Type:0,Activity:"CollabCornerSurveyLogDownloadACopyCommandActivity",IsAggregate:!0,Count:1},Content:{Prompt:{Title:"CollabCorner_Survey_DownloadCopies_Prompt_Line_1",Question:"CollabCorner_Survey_DownloadCopies_Prompt_Line_2",YesLabel:"CollabCorner_Survey_DownloadCopies_Prompt_YesLabel",
NoLabel:"CollabCorner_Survey_DownloadCopies_Prompt_NoLabel"},Rating:{Question:"CollabCorner_Survey_DownloadCopies_Rating_Question",RatingValuesAscending:["CollabCorner_Survey_DownloadCopies_Rating_Scale_1","CollabCorner_Survey_DownloadCopies_Rating_Scale_2","CollabCorner_Survey_DownloadCopies_Rating_Scale_3","CollabCorner_Survey_DownloadCopies_Rating_Scale_4","CollabCorner_Survey_DownloadCopies_Rating_Scale_5"]},Question:{Question:"CollabCorner_Survey_DownloadCopies_Comment_Question"}}}},{CampaignId:"bf20f28c-af0a-4d43-a87b-239b0419c65f",
StartTimeUtc:"2022-09-01T00:00:00Z",EndTimeUtc:"2023-06-30T00:00:00Z",GovernedChannelType:0,PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:5,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:604800},CooldownPeriod:{Type:0,IntervalSeconds:2592E3}},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"SimplicityEaseOfUseSurvey",IsAggregate:!0,Count:360},{Type:0,Activity:"SimplicityEaseOfUseSurveyTimeSatisfied",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"EaseOfUse_Floodgate_Prompt_Line1",
Question:"EaseOfUse_Floodgate_Prompt_Line2",YesLabel:"EaseOfUse_Floodgate_Prompt_Affirmative_Answer",NoLabel:"EaseOfUse_Floodgate_Prompt_Negative_Answer"},Rating:{Question:"EaseOfUse_Floodgate_Rating_Question",RatingValuesAscending:["EaseOfUse_Floodgate_Rating_Scale_1","EaseOfUse_Floodgate_Rating_Scale_2","EaseOfUse_Floodgate_Rating_Scale_3","EaseOfUse_Floodgate_Rating_Scale_4","EaseOfUse_Floodgate_Rating_Scale_5"]},Question:{Question:"EaseOfUse_Floodgate_Comment_Question"}}}},{CampaignId:"6e859e5f-99be-48cd-9a9a-da52d6ff7203",
StartTimeUtc:"2022-09-19T00:00:00Z",EndTimeUtc:"2023-05-01T00:00:00Z",GovernedChannelType:0,PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:50,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:604800},CooldownPeriod:{Type:0,IntervalSeconds:1209600}},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"Fluent2StyleEnabledFPS",IsAggregate:!0,Count:3}]},Content:{Prompt:{Title:"Fluent2Survey_Title",Question:"Fluent2Survey_Question",YesLabel:"Fluent2Survey_YesLabel",
NoLabel:"Fluent2Survey_NoLabel"},Rating:{Question:"Fluent2Survey_RatingQuestion",RatingValuesAscending:["Fluent2Survey_RatingValue_1","Fluent2Survey_RatingValue_2","Fluent2Survey_RatingValue_3","Fluent2Survey_RatingValue_4","Fluent2Survey_RatingValue_5"]},Question:{Question:"Fluent2Survey_WhyQuestion"}}}},{CampaignId:"e9434f43-d475-4b79-8213-88636e007433",StartTimeUtc:"2022-09-19T00:00:00Z",EndTimeUtc:"2023-05-01T00:00:00Z",GovernedChannelType:0,PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:100,
PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:604800},CooldownPeriod:{Type:0,IntervalSeconds:1209600}},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"Fluent2StyleOptOutFPS",IsAggregate:!0,Count:2}]},Content:{Prompt:{Title:"Fluent2OptOutSurvey_Title",Question:"Fluent2OptOutSurvey_Question",YesLabel:"Fluent2OptOutSurvey_YesLabel",NoLabel:"Fluent2OptOutSurvey_NoLabel"},Rating:{Question:"Fluent2OptOutSurvey_RatingQuestion",RatingValuesAscending:["Fluent2OptOutSurvey_RatingValue_1",
"Fluent2OptOutSurvey_RatingValue_2"]},Question:{Question:"Fluent2OptOutSurvey_WhyQuestion"}}}},{CampaignId:"26b1466b-2ac8-4d6f-8ee0-cd06c7594ce5",StartTimeUtc:"2022-09-01T00:00:00Z",EndTimeUtc:"2024-12-31T00:00:00Z",GovernedChannelType:0,PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:50,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1296E3},CooldownPeriod:{Type:0,IntervalSeconds:2592E3}},SurveyTemplate:{Type:2,ActivationEvent:{Type:0,Activity:"AddPenStrokePPTO",
IsAggregate:!0,Count:4},Content:{Prompt:{Title:"PenInkSurvey_Prompt",Question:"PenInkSurvey_PromptQuestion",YesLabel:"PenInkSurvey_Prompt_Sure",NoLabel:"PenInkSurvey_Prompt_NoNow"},Rating:{Question:"PenInkSurvey_RatingQuestion",RatingValuesAscending:["PenInkSurvey_QuestionChoice_5","PenInkSurvey_QuestionChoice_4","PenInkSurvey_QuestionChoice_3","PenInkSurvey_QuestionChoice_2","PenInkSurvey_QuestionChoice_1"]},Question:{Question:"PenInkSurvey_WhyQuestion"}}}},{CampaignId:"c855ff69-ff13-48f9-83b8-e76d1b65ee6a",
StartTimeUtc:"2023-01-01T00:00:00Z",EndTimeUtc:"2024-01-01T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592E3},CooldownPeriod:{Type:0,IntervalSeconds:7776E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"InsertPicture",IsAggregate:!0,Count:1}]},Content:{Prompt:{Title:"PPTO_Picture_FloodgatePromptTitle",
Question:"PPTO_Picture_FloodgatePromptQuestion",YesLabel:"PPTO_Picture_FloodgatePrompt_YesLabel",NoLabel:"PPTO_Picture_FloodgatePrompt_NoLabel"},Rating:{Question:"PPTO_Picture_FloodgateRatingQuestion",RatingValuesAscending:["PPTO_Picture_FloodgateRating_1","PPTO_Picture_FloodgateRating_2","PPTO_Picture_FloodgateRating_3","PPTO_Picture_FloodgateRating_4","PPTO_Picture_FloodgateRating_5"]},Question:{Question:"PPTO_Picture_FloodgateWhyQuestion"}}}}];var SO=d(661);class hF{rXf(){return null}j3i(){return dd.c(window.PPTCampaignsObj_FromAppPackage)}Q9d(a){return SO.a.Q9d(a,
"PPTUserInitiatedSurveysDictionary_FromAppPackage")}}Object(n.a)(hF,"PowerPointFeedbackAppData",null,[1254]);class oA{constructor(){this.Da=null}$b(a){this.Da=a;a.register(1254,"Common.App.IAppSpecificFeedbackData").ma().oa(()=>new hF)}init(){this.Da.rb("Common.App.IAppSpecificFeedbackData")}dispose(){}get name(){return"PPTWebEditor.Feedback"}static main(){r.a.instance.Dc(new oA)}}Object(n.a)(oA,"PPTWebEditorFeedbackPackage",null,[2,3]);class pA{get name(){return"Box4.ListEditors"}$b(){}init(){}dispose(){}static main(){r.a.instance.Dc(new pA)}}
Object(n.a)(pA,"Box4ListEditorsPackage",null,[2,3]);var fj=d(140),cl=d(123);const qA=a=>{a=document.createElement(a);a.setAttribute("unselectable","on");return a};class iF{constructor(a){this.dMd=this.MAd=!1;this.MMa=null;this.R6e=!1;this.z6=null;this.pba=!1;this.tYh=a;ha.a.instance.pb(ra.a.mouseDown,this.D4b(),Object(F.a)(this,this.nnk,"onContextualUIMouseDown"));(a=vb.a.instance.Ja("Common.IActionContextProvider"))&&a.execute(b=>{this.z6=b});u.AFrameworkApplication.fa.ka("InitializeContextualUIAftereHeaderInteractiveIsEnabled")&&
u.AFrameworkApplication.Aa.hb.WN?Ja.a.get_instance().Dk(16,()=>{this.gg?this.initializeContextualUI(this.D4b()):Ja.a.get_instance().Dk(7,()=>{this.initializeContextualUI(this.D4b())})}):Ja.a.get_instance().Dk(7,()=>{this.initializeContextualUI(this.D4b())})}get Hyb(){return this.pba}get gg(){return u.AFrameworkApplication.fa.ka("InitializeContextualUIAftereHeaderInteractiveIsEnabled")&&u.AFrameworkApplication.Aa.hb.WN?Ja.a.get_instance().isCompleted(16)&&Ja.a.get_instance().isCompleted(7):Ja.a.get_instance().isCompleted(7)}$ni(){if(this.R6e)return!0;
try{return Promise.resolve(null),this.R6e=!0}catch(a){return!1}}Y1e(a){if(!this.gg||this.dMd)return this.lne("Unable to launch contextual ui because ribbon hasn't loaded yet"),!0;if(!this.$ni())return this.lne("Unable to launch contextual ui because promise.resolve is not defined"),!0;if(u.AFrameworkApplication.XMc)return this.lne("Unable to launch contextual ui because the feature to show contextual ui is disabled"),!0;this.dMd=!0;let b=H.a.qe;switch(a){case 1:b=H.a.showContextMenu;break;case 0:b=
H.a.showFloatie;break;case 2:b=H.a.jpd}window.requestAnimationFrame(()=>{window.setTimeout(()=>{this.dMd=!1;Jf.c(b)},0)});return!1}y6f(a){return fj.UISurfaces.GDa().then(b=>{if(appChrome.api.isSmallDevice()&&b.getBlockedSmallScreenFloatieGroupList){b=b.getBlockedSmallScreenFloatieGroupList();const c=[];for(const h of a)Array.contains(b,h)||c.push(h);return c}return a})}showFloatie(a,b,c,h=null){this.Y1e(0)||this.y6f(b).then(m=>{if(0>=m.length)return null;this.TUe(m).then(()=>{const y={};y.target=
a;fj.UISurfaces.GDa().then(G=>{appChrome.api.dispatch(G.showFloatie(y,c,void 0,this.c7d(),h));this.pba=!0;u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.LogFloatieMenuContextIsEnabled",!1)&&u.AFrameworkApplication.Ta&&u.AFrameworkApplication.Ta.processAction(H.a.Q_j,2);return null})});return null})}showContextMenu(a,b,c=null,h=null){this.Y1e(1)||this.zuh(a,b,c,h)}zuh(a,b,c=null,h=null){this.TUe(null).then(()=>{const m={};m.target=a;h&&(m.directionalHint=h);fj.UISurfaces.GDa().then(y=>
{appChrome.api.dispatch(y.showContextMenu(m,b,c,void 0,this.c7d()));return null})})}yya(a,b,c){this.Y1e(2)||this.y6f(b).then(h=>{0>=h.length?this.zuh(a,c,null):this.TUe(h).then(()=>{const m={};m.target=a;const y={};y.target=a;fj.UISurfaces.GDa().then(G=>{appChrome.api.dispatch(G.showContextualUI(m,y,c,void 0,null,this.c7d()));this.pba=!0;return null})});return null})}lne(a){ba.ULS.sendTraceTag(561394519,340,15,a)}rZd(){this.gg&&fj.UISurfaces.isLoaded()&&fj.UISurfaces.GDa().then(a=>{appChrome.api.dispatch(a.hideContextMenu());
return null})}tN(){this.gg&&fj.UISurfaces.isLoaded()&&fj.UISurfaces.GDa().then(a=>{this.pba=!1;appChrome.api.dispatch(a.hideFloatie());return null})}H1b(){this.gg&&fj.UISurfaces.isLoaded()&&fj.UISurfaces.GDa().then(a=>{appChrome.api.dispatch(a.hideContextualUI());this.pba=!1;return null})}initializeContextualUI(a){return fj.UISurfaces.GDa().then(b=>{this.MAd||(b.initializeContextualUI(a),this.MAd=!0);return null})}TUe(a){if(!this.MAd)return this.initializeContextualUI(this.D4b()).then(()=>{this.setActiveFloatieGroups(a);
return null});this.setActiveFloatieGroups(a);return Promise.resolve(null)}setActiveFloatieGroups(a){if(a&&a.length){var b=[];b.push(appChrome.actions.setActiveFloatieGroups(a));appChrome.api.dispatch(b);var c=[];fj.UISurfaces.GDa().then(h=>{c.push.apply(c,this.tYh.$Ib.STc(h.selectors.getFloatieOnlyControlsMap(),9));0<c.length&&appChrome.api.dispatch(c);return null})}}D4b(){if(this.MMa)return this.MMa;this.MMa=qA("div");this.MMa.id="ReactContextualUIDiv";this.MMa.style.position="absolute";this.MMa.style.zIndex=
"1001";document.body.insertBefore(this.MMa,document.body.firstChild);return this.MMa}nnk(a){a.pc&&a.pc.target&&"input"===a.pc.target.tagName.toLowerCase()&&C.FocusManager.instance().bD("ribbon");return!1}c7d(){return this.z6?this.z6.contentType:"Unknown"}}Object(n.a)(iF,"ReactContextualUILauncher",null,[566]);var gj=d(134);class rA{constructor(a){this.oVb=a}create(a,b){const c=new Sys.StringBuilder;this.L0b(c,a,b);this.zWd(c,a);return c.toString()}Lt(a,b){const c=[];this.fXd(c,a,b);this.AWd(c,a);
return c}L0b(a,b,c){switch(b.errorType){case 0:a.append(this.oVb.build());break;case 1:case 2:a.append(this.ARd(b,c))}}fXd(a,b,c){switch(b.errorType){case 0:a.push(this.oVb.Fyf());break;case 1:case 2:a.push(this.Zii(b,c))}}zWd(a,b){J.a.instance.ga(92)||(a.append('<MenuSection Id="msIgnoreSpellingError" DisplayMode="Menu16"><Controls>'),a.append(gj.a("btnIgrnoreSpellingError",(2===b.errorType?D.a.dtd:D.a.ika).toString(),Box4Intl.Box4Strings.l_IgnoreSpellingError,null)),a.append("</Controls></MenuSection>"))}AWd(a,
b){if(!J.a.instance.ga(92)){var c=Object.assign(new di.a,{ControlList:[]});b=2===b.errorType?"UnknownSpellingError":"IgnoreSpellingError";Array.add(c.ControlList,Object.assign(new zf.a,{ExternalId:b}));a.push(c)}}ARd(a,b){a=this.L0i(a.suggestions,b);return 0<a.length?gj.e("msUnknownWord",gj.c(null,a),"Menu16"):gj.e("msUnknownWord",gj.c(null,[gj.a("btnNoSuggestions","3587447601",Box4Intl.Box4Strings.l_NoSuggestions,null)]),"Menu16")}L0i(a,b){const c=[];if(a){const h=Math.min(b.length,a.length);for(let m=
0;m<h;++m)a[m]&&c.push(gj.a("btnCorrectWord"+m,b[m].toString(),a[m]))}return c}Zii(a,b){const c=Object.assign(new di.a,{Id:"Suggestions",ControlList:[]});this.K0i(a.suggestions,b,c.ControlList);0>=c.ControlList.length&&(a=Object.assign(new zf.a,{ExternalId:"NoSuggestions"}),Array.add(c.ControlList,a));return c}K0i(a,b,c){if(a){const h=Math.min(b.length,a.length);for(let m=0;m<h;++m){if(!a[m])continue;const y=Object.assign(new zf.a,{ExternalId:"btnCorrectWord"+m,Command:b[m].toString(),LabelText:a[m]});
Array.add(c,y)}}}}Object(n.a)(rA,"DefaultProofingContextMenuCreator",null,[]);class sA{constructor(a,b){this.q8e=a;this.I9e=b;this.QOa=[D.a.Vya,D.a.Wya,D.a.Xya,D.a.qLa,D.a.rLa]}create(a,b){return b?Object(za.a)(Wi.a,b)?this.I9e.create(a,b,this.QOa):this.q8e.create(b,this.QOa):""}G0b(a,b){return b?Object(za.a)(Wi.a,b)?this.I9e.Lt(a,b,this.QOa):this.q8e.Lt(b,this.QOa):null}}Object(n.a)(sA,"ProofingContextMenuSectionFactory",null,[654]);class jF{build(){const a=[gj.a("btnDeleteRepeatedWord","2023591105",
Box4Intl.Box4Strings.l_DeleteRepeatedWord,null)];return gj.e("msRepeatedWord",gj.c(null,a),"Menu16")}Fyf(){const a=Object.assign(new di.a,{ControlList:[]}),b=Object.assign(new zf.a,{ExternalId:"DeleteRepeatedWord"});Array.add(a.ControlList,b);return a}}Object(n.a)(jF,"ProofingRepeatedWordSectionBuilder",null,[652]);var tA=d(1104);class jv{constructor(a,b){this.h2a=a;this.xn=b}get isVisible(){return this.h2a.Hyb}get controls(){return null}tN(){this.h2a.tN();return!0}Luh(a,b){this.h2a.showFloatie(Object.assign(new tA.a,
{x:a.x,y:a.y}),this.jQc(b),b,null)}osa(){return this.tN()}jQc(){return[]}}Object(n.a)(jv,"ReactFloatie",null,[380,381]);class kF{constructor(a){this.vwc=null;this.h2a=a}dispose(){}osa(){this.h2a.H1b();return!0}showContextMenu(a,b){this.U5(a,b.clientPoint,b.Yf)}U5(a,b,c){this.ipd(a,new Sys.UI.Bounds(b.x,b.y,0,0),c);ba.ULS.sendTraceTag(39195875,207,50,"React ContextMenu launched for Id: {0}",a)}ipd(a,b,c,h=null){this.vwc?this.h2a.yya(Object.assign(new tA.a,{x:b.x,y:b.y}),this.vwc.jQc(c),c):this.h2a.showContextMenu(Object.assign(new tA.a,
{x:b.x,y:b.y}),c,void 0,h);this.vwc=null}jpd(a,b,c,h){this.vwc=Object(ua.a)(jv,c);h.saa(a,b);return!0}}Object(n.a)(kF,"ReactContextMenuController",null,[567,106]);var Gr=d(438);class py{static get qg(){return Nh.a.gC(py.ro,Box4Intl.Box4Strings.l_AutoCorrectCorrectAndCapitalize,Box4Intl.Box4Strings.l_ReplaceTextAsYouType,Box4Intl.Box4Strings.l_ReplaceTextAsYouTypeTooltip,Box4Intl.Box4Strings.l_CapitalizeFirstLetterOfSentences,Box4Intl.Box4Strings.l_AutoCorrectFormat,Box4Intl.Box4Strings.l_ReplaceOrdianalsWithSuperscript,
Box4Intl.Box4Strings.l_ReplaceHyphensWithDash,Box4Intl.Box4Strings.l_ReplaceFractionsWithFractionCharacter)}}py.ro="<div class='WACDialogRow' id='AutoCorrectCorrectAndCapitalizeDiv'> <div class='WACDialogSectionTitle UIFontBold'>{0}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectOptionsDiv'> <table cellpadding=5 cellspacing=5 role='autocorrectoptions'> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='ReplaceTextAsYouType' class='WACDialogCheckBox' title='{2}'></input> <label id='\"\"' class='WACDialogLabel' for='ReplaceTextAsYouType' >{1}</label> </td> </tr> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='CapitalizeFirstLetterOfSentences' class='WACDialogCheckBox' title='{3}'></input> <label id='\"\"' class='WACDialogLabel' for='CapitalizeFirstLetterOfSentences' >{3}</label> </td> </tr> </table> </div> <div class='WACDialogRow' id='AutoCorrectFormatTitleDiv'> <div class='WACDialogSectionTitle UIFontBold'>{4}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectFormatDiv'> <table cellpadding=5 cellspacing=5 role='autocorrectoptions'> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='ReplaceOrdianalsWithSuperscript' class='WACDialogCheckBox' title='{5}'></input> <label id='\"\"' class='WACDialogLabel' for='ReplaceOrdianalsWithSuperscript' >{5}</label> </td> </tr> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='ReplaceHyphensWithDash' class='WACDialogCheckBox' title='{6}'></input> <label id='\"\"' class='WACDialogLabel' for='ReplaceHyphensWithDash' >{6}</label> </td> </tr> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='ReplaceFractionsWithFractionCharacter' class='WACDialogCheckBox' title='{7}'></input> <label id='\"\"' class='WACDialogLabel' for='ReplaceFractionsWithFractionCharacter' >{7}</label> </td> </tr> </table> </div>";
Object(n.a)(py,"AutoCorrectOptionsDialogHTML",null,[]);class qy{static get qg(){return Nh.a.gC(qy.ro,Box4Intl.Box4Strings.l_AutoCorrectCorrectAndCapitalize,Box4Intl.Box4Strings.l_ReplaceTextAsYouType,Box4Intl.Box4Strings.l_ReplaceTextAsYouTypeTooltip,Box4Intl.Box4Strings.l_CapitalizeFirstLetterOfSentences,Box4Intl.Box4Strings.l_AutoCorrectFormat,Box4Intl.Box4Strings.l_ReplaceOrdianalsWithSuperscript,Box4Intl.Box4Strings.l_ReplaceHyphensWithDash,Box4Intl.Box4Strings.l_ReplaceFractionsWithFractionCharacter,
Box4Intl.Box4Strings.l_ReplaceQuoteWithSmartQuote)}}qy.ro="<div class='WACDialogRow' id='AutoCorrectCorrectAndCapitalizeDiv'> <div class='WACDialogSectionTitle UIFontBold'>{0}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectOptionsDiv'> <table cellpadding=5 cellspacing=5 role='autocorrectoptions'> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='ReplaceTextAsYouType' class='WACDialogCheckBox' title='{2}'></input> <label id='\"\"' class='WACDialogLabel' for='ReplaceTextAsYouType' >{1}</label> </td> </tr> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='CapitalizeFirstLetterOfSentences' class='WACDialogCheckBox' title='{3}'></input> <label id='\"\"' class='WACDialogLabel' for='CapitalizeFirstLetterOfSentences' >{3}</label> </td> </tr> </table> </div> <div class='WACDialogRow' id='AutoCorrectFormatTitleDiv'> <div class='WACDialogSectionTitle UIFontBold'>{4}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectFormatDiv'> <table cellpadding=5 cellspacing=5 role='autocorrectoptions'> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='ReplaceOrdianalsWithSuperscript' class='WACDialogCheckBox' title='{5}'></input> <label id='\"\"' class='WACDialogLabel' for='ReplaceOrdianalsWithSuperscript' >{5}</label> </td> </tr> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='ReplaceHyphensWithDash' class='WACDialogCheckBox' title='{6}'></input> <label id='\"\"' class='WACDialogLabel' for='ReplaceHyphensWithDash' >{6}</label> </td> </tr> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='ReplaceFractionsWithFractionCharacter' class='WACDialogCheckBox' title='{7}'></input> <label id='\"\"' class='WACDialogLabel' for='ReplaceFractionsWithFractionCharacter' >{7}</label> </td> </tr> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='ReplaceQuoteWithSmartQuote' class='WACDialogCheckBox' title='{8}'></input> <label id='\"\"' class='WACDialogLabel' for='ReplaceQuoteWithSmartQuote' >{8}</label> </td> </tr> </table> </div>";
Object(n.a)(qy,"AutoCorrectOptionsDialogHTML2",null,[]);class lF extends Nh.a{constructor(a,b){super();this.QR=a;this.r2=b;this.ig="AutoCorrectOptionsDialog"}Fqc(){ba.ULS.sendTraceTag(24417873,324,50,"Autocorrect options dialog opens.");this.qg=this.r2?qy.qg:py.qg;const a={};a.ReplaceTextAsYouType=this.QR.mib;a.CapitalizeFirstLetterOfSentences=this.QR.sIc;a.ReplaceOrdianalsWithSuperscript=this.QR.Bkd;a.ReplaceHyphensWithDash=this.QR.Qnc;a.ReplaceFractionsWithFractionCharacter=this.QR.zkd;this.r2&&
(a.ReplaceQuoteWithSmartQuote=this.QR.QPe);this.$i(Box4Intl.Box4Strings.l_AutoCorrectOptions,Object(F.a)(this,this.C4k,"setAutoCorrectOptionsHandler"),a)}C4k(a,b){J.a.instance.ga(70)&&(1!==a?ba.ULS.sendTraceTag(24417874,324,50,"User close the option dialog or cancle it without save any changes."):b.ReplaceTextAsYouType!==this.QR.mib||b.CapitalizeFirstLetterOfSentences!==this.QR.sIc||b.ReplaceOrdianalsWithSuperscript!==this.QR.Bkd||b.ReplaceHyphensWithDash!==this.QR.Qnc||b.ReplaceFractionsWithFractionCharacter!==
this.QR.zkd||this.r2&&b.ReplaceQuoteWithSmartQuote!==this.QR.QPe?(a={},a.ReplaceTextAsYouType=b.ReplaceTextAsYouType,a.CapitalizeFirstLetterOfSentences=b.CapitalizeFirstLetterOfSentences,a.ReplaceOrdianalsWithSuperscript=b.ReplaceOrdianalsWithSuperscript,a.ReplaceHyphensWithDash=b.ReplaceHyphensWithDash,a.ReplaceFractionsWithFractionCharacter=b.ReplaceFractionsWithFractionCharacter,this.r2&&(a.ReplaceQuoteWithSmartQuote=b.ReplaceQuoteWithSmartQuote),this.QR.s0k(a),ba.ULS.sendTraceTag(24523524,324,
50,"User close the option dialog and trigger to save the setting: {0}"+{["ReplaceTextAsYouType"]:b.ReplaceTextAsYouType,["CapitalizeFirstLetterOfSentences"]:b.CapitalizeFirstLetterOfSentences,["ReplaceOrdianalsWithSuperscript"]:b.ReplaceOrdianalsWithSuperscript,["ReplaceHyphensWithDash"]:b.ReplaceHyphensWithDash,["ReplaceFractionsWithFractionCharacter"]:b.ReplaceFractionsWithFractionCharacter,["ReplaceQuoteWIthSmartQuoteIsEnabled"]:this.r2,["ReplaceQuoteWithSmartQuote"]:this.r2&&b.ReplaceQuoteWithSmartQuote}),
Fc.App.Kb.updateCommandUI(!0)):ba.ULS.sendTraceTag(24523523,324,50,"User close the option dialog or cancle it without do any changes."))}}Object(n.a)(lF,"AutoCorrectOptionsDialog",Nh.a,[570]);class ry{static get qg(){return Nh.a.gC(ry.ro,CommonUIStrings.l_AlternativeTextTitleCaption,CommonUIStrings.l_AlternativeTextDescriptionCaption)}}ry.ro="<div class='WACDialogRow' id='block3'> <label id='label3' class='WACDialogLabel' for='titleText' aria-hidden='true' >{0}</label> </div> <div class='WACDialogRow' id='block1'> <input type='text' id='titleText' class='WACAltTextInput' maxlength='65536' aria-labelledby='label3' role='textbox' aria-multiline='false' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='block4'> <label id='label4' class='WACDialogLabel' for='descriptionText' aria-hidden='true' >{1}</label> </div> <div class='WACDialogRow' id='block5'> <textarea id='descriptionText' class='WACAltTextTextArea' maxlength='65536' aria-labelledby='label4' role='textbox' aria-multiline='true' autocomplete=\"off\"></textarea> </div>";
Object(n.a)(ry,"AltTextDialogWithDescriptionHtml",null,[]);class iq extends Nh.a{constructor(a=!1){super(!1,!1,a);this.qg=ry.qg;this.ig=a?"AltTextDialog":"BaseAltTextDialogWithDescription"}JAi(a){this.$i(CommonUIStrings.l_AlternativeTextDialogTitle,Object(F.a)(this,this.XOd,"altTextDialogHandler"),this.nRc(a));a=document.getElementById(iq.ZOd);a.focus();a.select()}KAi(a){a={["id"]:"AltTextDialog",["bodyControls"]:this.nRc(a)};this.$i(CommonUIStrings.l_AlternativeTextDialogTitle,Object(F.a)(this,this.XOd,
"altTextDialogHandler"),a)}nRc(a){const b={};b[iq.ZOd]=this.getAltText(a);b[iq.WOd]=this.IZf(a)||"";return b}sN(a){return a.Cc.id===iq.WOd?!1:super.sN(a)}}iq.ZOd="titleText";iq.WOd="descriptionText";Object(n.a)(iq,"BaseAltTextDialogWithDescription",Nh.a,[]);class It extends iq{constructor(a,b=!1){super(b);this.ig=It.Xyj;b&&u.AFrameworkApplication.fa.ka("ReactAltTextDialogIsEnabled")?this.KAi(a):this.JAi(a)}}It.Xyj="AAltTextDialogWithDescription";Object(n.a)(It,"AAltTextDialogWithDescription",iq,[]);
class mF extends It{constructor(a,b,c,h,m){super(a);this.Tpb=this.vQb=null;this.AD=b;this.Qga=c;this.yk=h;this.fd=m}IZf(a){this.vQb=a.node;this.Tpb=rd.TableReader.s5f(a);return rd.TableReader.n9d(this.Tpb)}getAltText(a){this.vQb=a.node;this.Tpb=rd.TableReader.s5f(a);return rd.TableReader.o9d(this.Tpb)}XOd(a){if(1===a){rd.TableReader.o9d(this.Tpb);rd.TableReader.n9d(this.Tpb);this.hide();a=this.yk.le(15);try{a.kd(this.vQb)}finally{a&&a.dispose()}}J.a.instance.ga(50)&&this.Qga.lw&&this.Qga.WY.Tqa(this.vQb)}}
Object(n.a)(mF,"TableAltTextDialog",It,[]);class uA{constructor(a,b,c){this.AD=a;this.yk=b;this.fd=c}create(a){return new mF(a,this.AD,Fc.App.Ih,this.yk,this.fd)}}Object(n.a)(uA,"TableAltTextDialogFactory",null,[]);const TO=()=>{Fc.App.kci=!0;return 32},UO=(a,b,c,h,m)=>{if(1===c)return 32;if(!({point:a,vv:b}=nF(m)).returnValue)return 16;Fc.App.Kb.yya(a,b);return 32},VO=(a,b,c,h,m)=>{if(1===c)return 32;if(!({point:a,vv:b}=nF(m)).returnValue)return 16;Fc.App.Kb.V5(a,b);return 32},nF=a=>{let b,c;b=null;
c=0;if(!a)return{returnValue:!1,point:b,vv:c};a=a.split(",");if(3>a.length)return{returnValue:!1,point:b,vv:c};b=new Sys.UI.Point(parseInt(a[0]),parseInt(a[1]));c=parseInt(a[2]);return{returnValue:!0,point:b,vv:c}};var WO=d(1105);class oF extends Sys.EventArgs{constructor(a,b,c,h,m,y=0,G=0,U=null){super();this.controlId=a;this.commandId=h;this.time=m;this.commandSurface=y;this.vv=G;this.contentType=U}}Object(n.a)(oF,"CommandClickEventArgs",Sys.EventArgs,[]);class pF{constructor(a,b){this.mba=a.M5i();
this.BQb=a;this.rMa=b}xRf(a,b,c,h=null,m=null){c&&(this.rMa.wq=c.CommandLocation,this.rMa.oT=c.InvocationMethod,this.rMa.Ora=c.CommandTabName);let y=this.BQb.k_f(parseInt(a),b,c);y.ZF&&(y=this.BQb.k_f(y.Vm,b,c));if(void 0!==y.XK&&null!==y.XK)return y.XK;if(y.Rae)m=32;else{var G=null;this.mba&&this.mba.VJe&&(G=this.mba.VJe(y,m));y.aX||y.Mje?y.Wq?m=16:(m=this.rMa.La(y.Vm,y.Lje?2:1,y.rd,m),2===m&&(m=32)):y.Wq?m=this.rMa.vhd(null,y.Vm,y.rd,U=>{h&&h(U.response)},m):(m=this.rMa.La(y.Vm,2,y.rd,m),h&&h(m));
this.mba&&this.mba.rJe&&this.mba.rJe(y,m,G);if(b&&c&&-1!==c.InvocationMethod&&0!==c.InvocationMethod){c=b.LegacyId;if(void 0===c||null===c)c="";G=b.ParentMenuId;void 0!==G&&null!==G||!b.MenuId||(G=b.MenuId);let U=b.SqmControlId;void 0!==U&&null!==U||!b.SourceControlId||(U=b.SourceControlId);(void 0!==U&&null!==U||void 0!==G&&null!==G)&&WO.a.CIk(new oF(U,c,G,a,Date.now()))}}y.aX&&32===m&&this.mba&&this.mba.xYb&&this.mba.xYb(y,b);y.Mje&&32===m&&this.mba&&this.mba.JPd&&this.mba.JPd(y,b);return 32===
m||1===m}W9b(a,b=null){if(u.AFrameworkApplication.Tg||mh.a.instance.mw)return!1;const c=parseInt(a);b&&b.UILocation&&(this.rMa.wq=b.UILocation);if(!a||c===ed.ActionManager.w2b)return!0;a=this.BQb.CRc(c,b);a.ZF&&(a=this.BQb.CRc(a.Vm,b));if(void 0!==a.XK&&null!==a.XK)return a.XK;c===H.a.F5a&&b&&(a.rd=b);return 32===this.rMa.La(a.Vm,1,a.rd)}clearCache(){this.BQb.clearCache()}}Object(n.a)(pF,"GeneralCuiUser",null,[568,649]);class qF{constructor(a,b,c,h){this.Enf=a;this.Wha=b;this.ivc=c;this.p3a=h}V3f(){let a;
a=this.p3a.Hej(this.Enf);return{returnValue:this.p3a.iSc(this.Enf),nch:a}}Pqh(a,b){if(this.Wha){var c=new E.DictionaryPropertySet;this.ivc.execute(h=>{h.G2b(a)});c.setValue(kb.a.$s,a);c.setValue(J.a.instance.ga(20)?jb.a.noProof:xc.a.Jwa,b);b=new t.GraphTransaction(15);b.set(Fc.App.iP.fV);this.Wha.VU(c);b.dispose()}}}Object(n.a)(qF,"LanguageEditor",null,[569]);var oi=d(208);class Tq{constructor(a=!1,b=0){this.Vvd=null;this.DDd=Tq.K4f(Fa.a.O5i());this.Kzc=new Ct.a;this.oqa=[];this.$ob=new Ea.a;this.$jf=
a;this.akf=0>=b?7:b;this.Zjf=this.KHd=0;this.Naf=!1;a&&(this.IDj(),u.AFrameworkApplication.cga(()=>{this.X1j()}))}get languages(){return this.DDd}IDj(){for(var a of this.DDd)this.Kzc.$(a.LCID,a);a=[];try{var b=oi.a.get("RecentlyUsedLcids");if(b&&""!==b){const h=decodeURIComponent(b).split(",").slice(0,this.akf);for(const m of h){let y;({value:y}=this.Kzc.Uf(parseInt(m))).returnValue&&a.push(y)}}}catch(h){ba.ULS.sendTraceTag(38385057,324,15,"Error occurred while loading LCIDs from cookie, loading default LCID. Message: {0}",
h.message),Array.clear(a)}if(a.length)for(var c of a)b=c.LCID,this.$ob.contains(b)||(this.oqa.push(c),this.$ob.add(b));else c=u.AFrameworkApplication.lcid,({value:b}=this.Kzc.Uf(c)).returnValue&&(this.oqa.push(b),this.$ob.add(c));this.Smh()}Smh(){const a=Sa.toArray(Sa.select(Sa.asEnumerable(this.oqa),b=>b.LCID)).join(",");oi.a.SJ("RecentlyUsedLcids",a,180)}$Ak(a,b){if(a&&!(0<a.options.length)){var c=-1,h=Tq.K4f(this.oqa);this.$jf&&0<h.length&&(c=Tq.zyf(h),c=Tq.Zqf(a,c,b),a.add(Tq.dji(),null));this.Vvd||
(this.Vvd=Tq.zyf(this.DDd));b=Tq.Zqf(a,this.Vvd,b);-1===c&&(c=b);a.selectedIndex=c}}$6k(a,b){if(this.$jf&&({value:c}=this.Kzc.Uf(a)).returnValue){b=a!==b;if(this.$ob.contains(a))a=Array.indexOf(this.oqa,c),0<=a&&(Array.removeAt(this.oqa,a),this.oqa.push(c)),b&&this.KHd++;else{this.$ob.add(a);this.oqa.push(c);if(this.oqa.length>this.akf){var c=this.oqa.shift();this.$ob.remove(c.LCID)}b&&this.Zjf++}this.Smh()}}X1j(){const a=this.KHd+this.Zjf;!this.Naf&&0<a&&(ba.ULS.sendTraceTag(39662593,324,50,"Recently Used Languages Hit Rate: {0}%",
100*this.KHd/a),this.Naf=!0)}static zyf(a){return Sa.toArray(Sa.select(Sa.asEnumerable(a),b=>{const c=document.createElement("OPTION");let h=b.displayName;c.value=b.LCID.toString();c.text=h;return c}))}static dji(){const a=document.createElement("OPTION");a.text="\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500";
a.value="-1";a.disabled=!0;return a}static Zqf(a,b,c){c=c.toString();let h=-1;for(const m of b)a.add(m,null),m.value===c&&(h=a.options.length-1);return h}static K4f(a){a=Array.clone(a);a.sort((b,c)=>b.displayName.localeCompare(c.displayName));return a}}Object(n.a)(Tq,"LanguageListHelper",null,[647]);var vA=d(251);class Jt extends vA.a{constructor(){super();this.Type=this.Number=0}get ControlType(){return 10}}Object(n.a)(Jt,"NumberButtonProps",vA.a,[]);class Hr{static get Gjl(){return Hr.Lmf||(Hr.Lmf=
vb.a.instance.rb("Box4.ISpacingCommands"))}static get Cth(){return!!Hr.Gjl}static vb(){const a=u.AFrameworkApplication.Ta;a.ya(D.a.sJa,xb.a.view,Hr.sJa);a.he(D.a.sJa,1126)}static sJa(a,b,c,h,m){if(1===c||!Hr.Cth)return Hr.Cth?32:8;if(u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.hb.Np)a=[],a.push(Object.assign(new Jt,{ExternalId:"LineSpacing1_00",Number:1,Type:0})),a.push(Object.assign(new Jt,{ExternalId:"LineSpacing1_15",Number:1.15,Type:0})),a.push(Object.assign(new Jt,{ExternalId:"LineSpacing1_50",
Number:1.5,Type:0})),a.push(Object.assign(new Jt,{ExternalId:"LineSpacing2_00",Number:2,Type:0})),a.push(Object.assign(new Jt,{ExternalId:"LineSpacing2_50",Number:2.5,Type:0})),a.push(Object.assign(new Jt,{ExternalId:"LineSpacing3_00",Number:3,Type:0})),m.MenuItems=gj.d(a);else{a=gj.g("buttonLineSpacing1_00","1.00","2759860553","4080183461",1,0);b=gj.g("buttonLineSpacing1_15","1.15","2759860553","4080183461",1.15,0);c=gj.g("buttonLineSpacing1_50","1.50","2759860553","4080183461",1.5,0);h=gj.g("buttonLineSpacing2_00",
"2.00","2759860553","4080183461",2,0);const y=gj.g("buttonLineSpacing2_50","2.50","2759860553","4080183461",2.5,0),G=gj.g("buttonLineSpacing3_00","3.00","2759860553","4080183461",3,0),U=gj.a("buttonParagraphDialog","2465215107",Box4Intl.Box4Strings.L_LineSpacingOptions);a=gj.c("LineSpacing.Menu.Controls",[a,b,c,h,y,G,U]);a=gj.e("msLineSpacing",a,"Menu");a=gj.f([a]);m.PopulationXML=a}return 32}}Hr.Lmf=null;Object(n.a)(Hr,"LineSpacingRibbonMenu",null,[]);var XO=d(1103),YO=d(921);const ZO=(a,b,c)=>{if(1===
c)return 32;a=Fc.App.Kb.notificationBar.uCa("Automation test",!1);a.image=3;Fc.App.Kb.notificationBar.Yh(a);return 32},aP=(a,b,c,h,m)=>{let y;if(!({OHh:y}=$O(m)).returnValue)return 16;fj.UISurfaces.CN().then(G=>{let U=null;var ja=Object.assign(new XO.a,{label:"OK",onExecute:()=>{U&&G.removeNotification(U)}});ja=Object.assign(new YO.a,{target:"#"+I.AppFrame.hlh,content:"Here's the text for the callout",title:"Your title",primaryButtonProps:ja,useTeachingStyles:y});ja=G.callout(ja);U=G.addNotification(ja);
return null},G=>{ba.ULS.sendTraceTag(541172639,383,15,"Failed to GetNotificationsAPIAsync: {0}",G);return null});return 32},$O=a=>{let b;b=!1;if(!a)return{returnValue:!1,OHh:b};b=Boolean.parse(a);return{returnValue:!0,OHh:b}};class wA{constructor(a){this.PH=a}qOb(a){this.PH&&this.PH.mG(a)}}Object(n.a)(wA,"RibbonButtonUpdater",null,[593]);var rF=d(292);class xA{constructor(){this.K6=this.Da=null}get name(){return"Box4.UI"}$b(a){this.Da=a;a.register(566,"Common.IReactContextualUILauncher").ma().oa(()=>
new iF(a.resolve("CommandUI.ReactRibbonRoot"),a.resolve("Common.IExternalUICommandDefinitionMapping")));a.register(567,"Box4.IContextMenuController").ma().oa(()=>new kF(a.resolve("Common.IReactContextualUILauncher")));a.register(568,"Box4.IGeneralCuiUser").oa(()=>new pF(a.resolve("Box4.UI.CuiActionBridge"),u.AFrameworkApplication.Ta)).ma();a.register(uA,"Box4.UI.TableAltTextDialogFactory").ma().oa(()=>new uA(a.resolve("Box4.ITableEditor"),new rF.a,a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance));
a.register(569,"Box4.UI.ILanguageEditor").oa(()=>new qF(me.a.instance.Qj,a.rb("Box4.ITextFormattingCommands"),a.Ja("Box4.IAutoCorrectRules"),a.resolve("Box4.ILanguageReader")));a.register(570,"Box4.UI.IAutoCorrectOptionsDialog").oa(()=>new lF(a.resolve("Box4.IAutoCorrectOptionsInfo"),u.AFrameworkApplication.fa.ka("ReplaceQuoteWithSmartQuoteIsEnabled")));a.register(Tq,"Box4.UI.LanguageListHelper").as("Box4.UI.ILanguageListHelper").ma().oa(()=>new Tq(u.AFrameworkApplication.fa.ka("RecentlyUsedLanguagesListIsEnabled")));
a.register(jF,"Box4.UI.ProofingRepeatedWordSectionBuilder").as("Box4.UI.IProofingRepeatedWordSectionBuilder").ma();a.register(rA,"Box4.UI.DefaultProofingContextMenuCreator").ma().oa(()=>new rA(a.resolve("Box4.UI.IProofingRepeatedWordSectionBuilder")));a.register(sA,"Box4.UI.ProofingContextMenuSectionFactory").as("Box4.UI.IProofingContextMenuSectionFactory").ma().oa(()=>new sA(a.resolve("Box4.UI.DefaultProofingContextMenuCreator"),a.resolve("Box4.UI.EditorServiceProofingContextMenuCreator")));a.register(wA,
"Box4.RibbonButtonUpdater").as("Common.IRibbonButtonUpdater").ma().oa(()=>new wA(this.Da.resolve("Box4.IAppFrame")))}init(){var a=Fc.App.Kb;const b=a.hb;Vo.YBj(Object(F.a)(b,b.Yic,"onAuthenticationLost"),Object(F.a)(b,b.Zic,"onAuthenticationRestored"),a.loi);Gr.a.vb();a=u.AFrameworkApplication.Ta;a.ya(D.a.nEk,xb.a.application,TO);a.ra(D.a.qfl,xb.a.application,UO,96);a.ra(D.a.Qfl,xb.a.application,VO,96);a=u.AFrameworkApplication.Ta;a.ra(D.a.Chl,xb.a.application,ZO,96);a.ra(D.a.ffl,xb.a.application,
aP,96);Hr.vb();this.K6=this.Da.rb("Box4.IContextMenuController")}dispose(){this.K6&&(this.K6.dispose(),this.K6=null)}static main(){r.a.instance.Dc(new xA,6)}}Object(n.a)(xA,"Box4UIPackage",null,[2,3]);var sF=d(456),bP=d(872),zs=d(201),cP=d(537),kv=d(371),Nm=d(313),Yi=d(72);class tF{constructor(a){this.ana=a}}Object(n.a)(tF,"ValidParentData",null,[]);var sy=d(365),dP=d(805),lv=d(290),uF=d(804),mv=d(598),nm=d(243),vF=d(352),jq=d(225);class wF{constructor(){this.Ttb=0}}Object(n.a)(wF,"BelowOutlineElementData",
null,[]);var As=d(416),eP=d(586),fP=d(473);class xF extends As.a{constructor(a,b,c,h){super(4,h);this.lPh=a;this.jvd=b;this.Ewd=c}get $Lc(){return this.lPh}get mXb(){return this.jvd}get WQd(){return this.Ewd}Ywb(){var a=this.$Lc;if(!a)return ba.ULS.shipAssertTag(16819992,300,!1,"IParagraphStateWithChps not provided for DeletePara GetUpdateHintsForOperation"),null;const b=[],c=new eP.a(this.$Lc.id,this.$Lc.fo,this.mXb?this.mXb.id:null);""!==a.characterData&&a.characterData&&(a=new fP.DeleteTextUpdateHint(this.$Lc.id,
0,a.characterData),Array.add(b,a));Array.add(b,c);return b}}Object(n.a)(xF,"DeleteParagraphOperation",As.a,[]);var gP=d(585),hP=d(472);class yA extends As.a{constructor(a,b,c,h,m){super(3,m);this.TFd=a;this.UFd=b;this.jUb=h}get LIa(){return this.TFd}get fGb(){return this.UFd}get DIa(){return this.jUb}Ywb(){const a=[];var b=new gP.AddParagraphUpdateHint(this.DIa.id,this.DIa.fo,this.LIa?this.LIa.id:null);Array.add(a,b);""!==this.DIa.characterData&&this.DIa.characterData&&(b=new hP.a(this.DIa.id,0,this.DIa.characterData),
Array.add(a,b));return a}}Object(n.a)(yA,"InsertNewParagraphOperation",As.a,[]);var iP=d(584);class yF extends As.a{constructor(a,b,c,h){super(2,h);this.TFd=a;this.UFd=b;this.JVh=c}get LIa(){return this.TFd}get fGb(){return this.UFd}get xYg(){return this.JVh}Ywb(){const a=[],b=new iP.MergeParagraphUpdateHint(this.LIa.id,this.LIa.fo,this.LIa.characterData.length,this.fGb.id,this.fGb.fo,this.xYg.id,this.xYg.fo);Array.add(a,b);return a}}Object(n.a)(yF,"MergeParagraphOperation",As.a,[]);var jP=d(583);
class zF extends As.a{constructor(a,b,c,h,m){super(1,m);this.WFd=a;this.$_h=b;this.jvd=c;this.Ewd=h}get MIa(){return this.WFd}get mXb(){return this.jvd}get WQd(){return this.Ewd}get ekl(){return this.$_h}Ywb(){const a=[],b=new jP.a(this.MIa.id,this.MIa.fo,this.ekl,this.mXb.id,this.mXb.fo,this.WQd.id,this.WQd.fo);Array.add(a,b);return a}}Object(n.a)(zF,"SplitParagraphOperation",As.a,[]);var AF=d(316);class Pj{constructor(a,b,c,h,m,y=null){this.$o=this.fd=null;this.Nx=a;this.Xo=b;this.Ug=c;this.LOh=
h;this.GVh=m;this.Qpa=y}c3h(a){J.a.instance.ga(50)&&Fc.App.Ih&&Fc.App.Ih.lw&&Fc.App.Ih.WY.Tqa(a)}mjb(a,b,c){mc.OutlineElementNavigator.wi(a);Ob.ParagraphReader.fl(a)?Pj.paragraphEditor.uv.mjb(a,b,c):rd.TableReader.aq(a)&&14===a.ri&&(b=(new lv.a(1,c)).MM,this.V9k(Object(ua.a)(sy.a,a.currentNode),b));mc.OutlineElementNavigator.Oe(a)}V9k(a,b){a&&Object(za.a)(sy.a,a)&&(a.Zl=b)}get uv(){return kv.a.vwb}get Tf(){return this.fd||(this.fd=vb.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}get p6(){return this.$o||
(this.$o=vb.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}get eq(){return this.Xo.value}get Sf(){return this.Ug.value}get wB(){return this.Nx.value}get aj(){return Dc.a.instance}NWd(){const a=cP.a.instance.createInstance(393229);a.setValue(kb.a.BE,Nm.a.first);a.setValue(kb.a.bHi,new Date);a.std();return a}lEi(){const a=new bP.a;a.setValue(kb.a.BE,Nm.a.first);return a}gnd(a,b,c){const h=a.Fh;if(h){h.id.equals(Pj.D6e)||(Pj.D6e=h.id,Pj.uvc={});var m=Pj.uvc[b];b in Pj.uvc&&
h.o$a(m.id)&&h.Xw&&h.Xw.D_(m.id)||(m=new jq.a,m.setValue(kb.a.author,b),m=h.UJa(m));a.properties.setValue(c,m.id);Pj.uvc[b]=m}}dLb(a,b){a.properties.setValue(kb.a.lastModifiedTime,b)}q2e(a,b=null){const c=new t.GraphTransaction(7);c.kd(a);b||(b=new Date);this.dLb(a,b);this.gnd(a,this.VTc(),kb.a.MYb);""===Kd.OutlineElementReader.wQc(a,kb.a.bHc)&&this.gnd(a,this.VTc(),kb.a.bHc);c.dispose()}VTc(){return Fc.App.K_e.name}l_d(a,b,c=!1){if(J.a.instance.ga(56))Kd.OutlineElementReader.$je(a)?(a=Kd.OutlineElementReader.isRtl(a),
c?this.Rnd(b,a):this.HKa(b,a)):this.ESk(b);else if(J.a.instance.ga(26)||J.a.instance.ga(89))a=Kd.OutlineElementReader.isRtl(a),c?this.Rnd(b,a):this.HKa(b,a)}zLb(a,b){var c=new rb.GraphIterator;c.set(a);c.rc(11);c=c.Ng(11);Kd.OutlineElementReader.um(c)!==b&&(this.HKa(c,b),J.a.instance.ga(54)?a.anchor.Ar(4):(c=1,b&&(c=3),a.setValue(kb.a.Il,c),a.setValue(kb.a.XI,c)))}HKa(a,b){const c=new t.GraphTransaction(7);c.kd(a);this.Rnd(a,b);if(J.a.instance.ga(26)){var h=new rb.GraphIterator;h.set(a);h.Bb(2)&&
Ob.ParagraphReader.fl(h)&&(h=h.currentNode,b?(h.te(Ie.a.tjd,!0),Pj.paragraphEditor.RJ(h,3)):(h.removeProperty(Ie.a.tjd),Pj.paragraphEditor.RJ(h,1)))}h=new rb.GraphIterator;h.set(a);AF.a.instance.XFj(h);if(h.rc(10)){const m=h.Ng(10);h.Bb(1)===a&&this.wB.HKa(m,b)}c.dispose()}Rnd(a,b){let c=null,h=null;if(this.Tf.hg&&a.isConnected){c=Ob.ParagraphReader.NSc(a,!0,!0);h=new Qa.a;for(let m=0;m<c.count;m++)12===c.ga(m).type&&h.add(c.ga(m).s8())}b?a.properties.setValue(kb.a.oY,!0):J.a.instance.ga(56)?a.properties.setValue(kb.a.oY,
!1):(J.a.instance.ga(26)||J.a.instance.ga(89))&&a.properties.removeProperty(kb.a.oY);if(this.Tf.hg&&c&&h)if(c.count!==h.count)ba.ULS.shipAssertTag(35973010,376,!1,"Paragraph count [{0}] doesn't match PreviousFormatProp count [{1}]",c.count,h.count);else for(a=0;a<c.count;a++)c.ga(a),h.ga(a)}ESk(a){a.properties.removeProperty(kb.a.oY)}qca(a,b=null,c=!1){let h=null,m=null;if(!Kd.OutlineElementReader.Wg(a))return ba.ULS.sendTraceTag(40502923,307,15,"GraphIterator does not point to an outline element."),
null;var y=null;let G=null,U=0;b&&(y=b.formatting,G=b.style,U=b.languageId);c||({LIa:h,fGb:m}=this.XWf(a));b=zs.a.instance.createInstance(393230);b.setValue(kb.a.pq,"");a.Cl(b,2);a.Qk(b);Pj.paragraphEditor.xnc(b);Pj.paragraphEditor.Jek(b);Pj.paragraphEditor.COb(b);this.c3h(b);y&&(b.Ra.first.formatting.nm=y);U||(U=u.AFrameworkApplication.lcid);a.currentNode.te(kb.a.Eib,a.currentNode.sa(kb.a.Eib,U));J.a.instance.ga(54)&&a.currentNode.setValue(jb.a.tkc,0);!J.a.instance.ga(71)||J.a.instance.ga(61)||G||
(y=Ya.StyleReader.iL(b))&&(G=y.WG(Ya.StyleReader.Hoa));this.LOh.dTi(a);G&&Pj.gP.paa(G,b,!0);!c&&h&&(c=new yA(h,m,h,new mv.a(b),b.dRa),a.currentNode.UG().graphTransactionOperations.FZ(c));return b}XWf(a){let b;const c=new rb.GraphIterator;c.Rc(a);b=null;c.tgg?c.currentNode.UG().graphTransactionOperations.xia(6):(mc.OutlineElementNavigator.Hwa(c,!0,!1),b=this.PRc(c));c.Rc(a);a=this.KXf(c);return{LIa:b,fGb:a}}KXf(a){const b=new rb.GraphIterator;b.Rc(a);a=null;b.Oyb||(mc.OutlineElementNavigator.yJ(b,
!0,!1),a=this.PRc(b));return a}PRc(a,b=!1){a=mc.OutlineElementNavigator.wi(a,!0);return a?this.c0f(a,b):(ba.ULS.sendTraceTag(8451733,355,15,"No paragraph node below OutlineElement"),null)}c0f(a,b=!1){if(12===a.type)return b?new mv.a(a):new uF.a(a);a.UG().graphTransactionOperations.xia(5);return new dP.a(a)}dti(a,b){var c=b.currentNode.clone();a.nL(c,null,1);a.Qk(c);c.UZ=b.currentNode;mc.OutlineElementNavigator.wi(b);b.PW&1&&b.currentNode.q1a(null);c=b.currentNode.clone();c.aV=b.currentNode.aV;a.nL(c,
null,2);a.Qk(c);a.nT(1);c.UZ=b.currentNode;J.a.instance.ga(55)&&c.setValue(jb.a.fo,kf.a.EZa());b.AB(11)}xnc(a){a.Bb(2)&&a.Mi()}cjh(a,b){const c=a.currentNode;mc.OutlineElementNavigator.wi(a);const h=a.currentNode;mc.OutlineElementNavigator.Oe(a);b.TA(1);mc.OutlineElementNavigator.wi(b);a.Cl(b.currentNode,2);b.Mi();var m=new rb.GraphIterator;m.Rc(b);if(m.Bb(1)){const y=new rb.GraphIterator;y.Rc(a);const G=new tF(null);if(!this.rmj(y,m.currentNode,G))return;nm.h(y,null,1,1,m,-1)}b.Mi();m=null;a.FF(1)&&
(m=a.currentNode);for(a.zc();ii.OutlineNavigator.F$(b);)a.nL(b.currentNode,m,1),m=b.currentNode,b.Mi();a.Qk(c);a.Qk(h);a.Mi()}yMb(a,b,c,h,m,y=!1){this.xnc(b);const G=b.ri;var U=a.currentNode;let ja=null;var va=null;let Ta=null,fb=!1;mc.OutlineElementNavigator.wi(a);const Db=a.ri;if(Ob.ParagraphReader.fl(a)){var gc=a.currentNode;(va=Object(ua.a)(Vb.AParagraphNode,gc))?va.Ra&&va.Ra.length||ba.ULS.sendTraceTag(38925760,307,15,"srcParaNode: {0}. srcParaNode has no characterProperties",va):ba.ULS.sendTraceTag(38925731,
307,15,"srcParaNode is null");va=new mv.a(va);(fb=c.Qa===Ob.ParagraphReader.textLength(gc))&&(Ta=this.KXf(b));var hc=b.currentNode;ja=this.qca(b,void 0,!0);Pj.paragraphEditor.$Xe(a,b,c,m,!0,y);J.a.instance.ga(71)&&(h?(m=Ya.StyleReader.XD(gc))&&Pj.gP.paa(m,ja,!0):fb&&(m=Ya.StyleReader.XD(gc))&&((gc=m.sa(Ie.a.o_g,null))?(m=Ya.StyleReader.iL(ja).WG(gc),Pj.gP.paa(m,ja,!1)):Pj.gP.paa(m,ja,!0)));this.l_d(U,hc);this.eq.j_d(U,hc)}mc.OutlineElementNavigator.Oe(a);mc.OutlineElementNavigator.Oe(b);U=Kd.OutlineElementReader.isEmpty(a,
!0);hc=Kd.OutlineElementReader.isEmpty(b,!0);J.a.instance.ga(27)&&U&&!hc&&(b.PW&1&&(U=new vF.a,U.Rc(b),b.currentNode.q1a(U)),this.gnd(b.currentNode,Kd.OutlineElementReader.wQc(a.currentNode,kb.a.MYb),kb.a.MYb),this.gnd(b.currentNode,Kd.OutlineElementReader.wQc(a.currentNode,kb.a.bHc),kb.a.bHc),this.dLb(b.currentNode,Kd.OutlineElementReader.baj(a.currentNode)));mc.OutlineElementNavigator.wi(a);(U=Object(ua.a)(Vb.AParagraphNode,a.currentNode))?U.Ra&&U.Ra.length||ba.ULS.sendTraceTag(38925762,307,15,
"srcParaNode: {0}. srcParaNode has no characterProperties",U):ba.ULS.sendTraceTag(38925761,307,15,"srcPara is null");U=new mv.a(U);mc.OutlineElementNavigator.Oe(a);(a=ja)?a.Ra&&a.Ra.length||ba.ULS.sendTraceTag(38925764,307,15,"paragraphNode: {0}. paragraphNode has no characterProperties.",a):(ba.ULS.sendTraceTag(38925763,307,15,"paragraphNode is null"),ba.ULS.sendTraceTag(40425482,307,50,"SplitAtIp state. {0}",{["splittingAtEnd"]:fb,["moveText"]:!0,["overrideParagraphStyle"]:h,["sourceOutlineElementContentNodeType"]:Db,
["destinationOutlineElementNodeType"]:G,["alwaysMoveEopToDestinationPara"]:y}));fb?(c=new yA(va,Ta,U,new mv.a(a),a.dRa),b.currentNode.UG().graphTransactionOperations.FZ(c)):(c=new zF(va,c.Qa,U,new mv.a(a),a.dRa),b.currentNode.UG().graphTransactionOperations.FZ(c))}NAf(a,b){mc.OutlineElementNavigator.wi(a);let c=Ob.ParagraphReader.hs(a.currentNode);const h=a.currentNode;J.a.instance.ga(14)&&(c=b?c&&!this.aj.Twk(h):c&&!this.aj.Nwk(h));mc.OutlineElementNavigator.Oe(a);return c}merge(a,b,c,h,m=null,y=
!1,G=!1,U=!1){if(a.currentNode.id===b.currentNode.id)return!1;let ja,va;var Ta=new rb.GraphIterator;Ta.Rc(b);ja=this.PRc(Ta);Ta.Rc(a);va=this.PRc(Ta,!0);if(!this.NAf(b,!0)||!this.NAf(a,!1))return!1;if(this.Sf.Xlc){var fb=Object(ua.a)(Vb.AParagraphNode,a.currentNode);fb=(c||!fb||!fb.characterData.length)&&!Wb.ListReader.tk(a)}else fb=this.GVh.LBl(c,a);U||this.eq.merge(a,b,fb,m);mc.OutlineElementNavigator.wi(a);m=a.currentNode.dRa;mc.OutlineElementNavigator.wi(b);if(Ob.ParagraphReader.fl(b)){if(J.a.instance.ga(50)&&
Fc.App.Ih.lw){U=b.currentNode;fb=a.currentNode;const Db=sF.CoauthLockEditor.getInstance();if(Db.ULb(this.aj.z4b(U))||Db.ULb(this.aj.z4b(fb)))return b.zc(),a.zc(),!1}U=!1;Wb.ListReader.ix&&(fb=a.parentNode)&&Kd.OutlineElementReader.Z8(fb)&&(U=Wb.ListReader.oUa(fb));J.a.instance.ga(71)&&(fb=(fb=Ob.ParagraphReader.isEmpty(a)||c)&&!U)&&(fb=Ya.StyleReader.b5f(b))&&Pj.gP.paa(fb,a.currentNode,!0);c&&this.Qpa.ahk(b.currentNode,a.currentNode,U,G);c=Pj.paragraphEditor.merge(a,b,c,h,y);h=Ta.currentNode;Ta=a.currentNode;
a.zc();c&&Kd.OutlineElementReader.isEmpty(b,!0)&&this.PCa(b);a=new yF(va,ja,new uF.a(h),m);Ta.UG().graphTransactionOperations.FZ(a);return!0}b.zc();a.zc();return!1}aFj(a){const b=new rb.GraphIterator;b.set(a.node);b.gf();mc.OutlineElementNavigator.Oe(b);const c=this.g8b(b),h=this.g8b(b);this.yMb(b,c,a,!1,!0);Kd.OutlineElementReader.isEmpty(b,!1)&&(this.eq.Qna(b),b.Mi());Kd.OutlineElementReader.isEmpty(c,!1)&&!Kd.OutlineElementReader.Aab(c)&&(this.eq.Qna(c),c.Mi());return h}pda(a,b,c,h=null,m=!1){if(!this.coi(a))return null;
const y=a.currentNode,G=Wb.ListReader.tk(a);b||m||Kd.OutlineElementReader.isEmpty(a,!1);m=this.eq.qel(G);b=b?a.FF(1):a.currentNode;a.zc();c=this.wB.f8b(a,b,c,h);if(!c)return null;this.l_d(y,c);this.eq.j_d(y,c);m&&this.eq.Wrl(a,y);return c}coi(a){return Kd.OutlineElementReader.Wg(a)&&(a=a.parentNode,Yi.OutlineReader.B9b(a)||Kd.OutlineElementReader.Z8(a)||Kd.OutlineElementReader.mua(a))?!0:!1}BRk(a){const b=new rb.GraphIterator;b.set(a);b.gf();b.AB(11);let c,h;({LIa:c,fGb:h}=this.XWf(b));let m=-1;12===
a.type&&(m=a.dRa);b.currentNode.UG().graphTransactionOperations.FZ(new xF(this.c0f(a,!0),c,h,m));this.PCa(b)}PCa(a){if(a.FI(1)){const b=new wF,c=new rb.GraphIterator;c.Rc(a);this.D2i(c,b)&&this.uv.eMc(a,-b.Ttb)}a.Mi();rd.TableReader.ys(a)&&this.EBk(a)}nde(a,b,c){if(!Yi.OutlineReader.Ut(a)&&!Kd.OutlineElementReader.Wg(a))return null;const h=this.lEi();0<c&&c<Nm.a.last&&h.setValue(kb.a.BE,Math.min(Nm.a.nil,c));a.nL(h,b,1);return h}cFj(a,b){if(!Kd.OutlineElementReader.Wg(a)&&!Kd.OutlineElementReader.OI(a)||
!Yi.OutlineReader.ZW(a.parentNode)&&!Kd.OutlineElementReader.Z8(a.parentNode))return null;const c=a.currentNode;let h;h=a.currentNode;a.zc();b=this.nde(a,h,b);a.Qk(c);return b}EBk(a){Kd.OutlineElementReader.OI(a)&&(a.FI(1)||a.Mi());this.LUf(a,!1);this.utf(a)}LUf(a,b){var c,h=null;for(c=a.Bb(1);c;){var m=!1;Kd.OutlineElementReader.mua(c)&&!a.FI(1)&&(m=!0);var y=c;c=a.Cj(1);if(m)m=new rb.GraphIterator,m.set(y),m.gf(),m.Mi();else if(Kd.OutlineElementReader.mua(y)){if(h){m=new rb.GraphIterator;m.set(h);
var G=new rb.GraphIterator;G.set(y);G.gf();m.Cl(G.currentNode,1);G.Mi();G=Kd.OutlineElementReader.q3(y);G===Nm.a.nil&&(G=1);(G=Math.max(0,Kd.OutlineElementReader.q3(y)-G))?y.setValue(kb.a.BE,Math.min(Nm.a.nil,G)):(m.Qk(y),a.Bb(1),nm.e(m),m.zc());b&&this.LUf(m,!0)}}else h=y}b=null;h=Nm.a.last+1;for(c=a.Bb(1);c;c=a.Cj(1))if(Kd.OutlineElementReader.OI(a))y=Kd.OutlineElementReader.q3(c),h>y&&(h=y,b=c);else{a.zc();return}if(b){for(c=a.Bb(1);c;c=a.Cj(1))c!==b&&a.currentNode.setValue(kb.a.BE,Math.min(Nm.a.nil,
Kd.OutlineElementReader.q3(c)-h));h+=Kd.OutlineElementReader.q3(a.currentNode);a.currentNode.setValue(kb.a.BE,Math.min(Nm.a.nil,h));c=new rb.GraphIterator;c.Rc(a);c.Qk(b);c.Bb(1);nm.e(c)}}rmj(a,b,c){var h=Kd.OutlineElementReader.q3(a.currentNode);if(1===h)return!0;if(Kd.OutlineElementReader.OI(a))return!1;if(!a.p8(1)||this.kPj(a,b))return a.currentNode.setValue(kb.a.BE,Math.min(Nm.a.nil,1)),!0;if(c.ana&&a.Qk(c.ana)){if(Kd.OutlineElementReader.OI(a)&&1===h+Kd.OutlineElementReader.q3(a.currentNode))return c.ana=
a.TA(1),a.zc(),!0;a.zc()}if(c.ana&&a.Qk(c.ana)||!c.ana&&a.Bb(1)){if(a.currentNode!==b&&a.Af(1)&&Kd.OutlineElementReader.OI(a)&&1===h+Kd.OutlineElementReader.q3(a.currentNode))return c.ana=null,!0;a.zc()}if(a.tTa(b)&&this.jPj(a,b)){for(c=a.Bb(1);c;c=a.Cj(1))c!==b&&c.setValue(kb.a.BE,Math.min(Nm.a.nil,Kd.OutlineElementReader.q3(c)+(h-1)));a.currentNode.setValue(kb.a.BE,Math.min(Nm.a.nil,1));return!0}if(1>h)return h=this.nde(a,c.ana,1-h),a.Qk(h),c.ana=null,!0;if(1<h){a.currentNode.setValue(kb.a.BE,Math.min(Nm.a.nil,
1));b=null;let m=a.Bb(1);for(;m;){if(Kd.OutlineElementReader.OI(a)){m.setValue(kb.a.BE,Math.min(Nm.a.nil,h-1+Kd.OutlineElementReader.q3(m)));m=a.Cj(1);continue}b||(b=this.cFj(a,h-1));const y=m;m=nm.j(a,b,1);m===b&&(m=a.Cj(1));c.ana===y&&(c.ana=b,b=null)}return!0}return!1}kPj(a,b){return rb.GraphIterator.Hca(()=>{if(1===a.p8(1)){const c=a.Bb(1);a.zc();if(c===b)return!0}return!1})}jPj(a,b){return rb.GraphIterator.Hca(()=>{let c;for(c=a.Bb(1);c;c=a.Cj(1))if(c!==b&&!Kd.OutlineElementReader.OI(a))return a.zc(),
!1;return!0})}D2i(a,b){b.Ttb=0;do{const c=a.currentNode;if(a.Bb(1))b.Ttb-=Kd.OutlineElementReader.q3(c);else{if(Yi.OutlineReader.Ut(a)||null===a.currentNode)return!1;if(3!==a.role||!a.$ja(1))for(;!a.Cj(1);)if(b.Ttb+=Kd.OutlineElementReader.q3(a.currentNode),Yi.OutlineReader.Ut(a)||null===a.currentNode)return!1}}while(Kd.OutlineElementReader.OI(a));return!0}g8b(a,b=!1){return this.mde(a,!1,b)}mde(a,b,c=!1){const h=new rb.GraphIterator;h.Rc(a);a=new rb.GraphIterator;a.Rc(h);this.pda(a,b,!1,null,c);
a.currentNode.setValue(kb.a.BE,Math.min(Nm.a.nil,Kd.OutlineElementReader.q3(h.currentNode)));h.Bb(1)&&nm.h(a,null,1,1,h,-1);return a}utf(a){if(Kd.OutlineElementReader.qXk(a)){1!==Kd.OutlineElementReader.q3(a.currentNode)&&a.currentNode.setValue(kb.a.BE,Nm.a.first);for(var b=a.Bb(1);b;)if(Kd.OutlineElementReader.OI(a)){b=new rb.GraphIterator;b.Rc(a);b.zc();const c=new rb.GraphIterator;c.Rc(a);c.Bb(1);nm.h(b,a.currentNode,1,1,c,-1);b=a.aRa(1)}else this.utf(a),b=a.Cj(1)}}static get gP(){return Pj.BK||
(Pj.BK=vb.a.instance.resolve("Box4.Styles.IStyleEditor"))}static set gP(a){Pj.BK=a}static get paragraphEditor(){return Pj.Rw||(Pj.Rw=vb.a.instance.resolve("Box4.IParagraphEditor"))}static set paragraphEditor(a){Pj.Rw=a}}Pj.BK=null;Pj.Rw=null;Pj.D6e=null;Pj.uvc=null;Object(n.a)(Pj,"OutlineElementEditor",null,[619]);var Pw=d(110),Qw=d(408),BF=d(589),kq=d(255);class Sn{constructor(a){this.yif=a}mEi(){const a=zs.a.instance.createInstance(393228);a.setValue(kb.a.BE,Nm.a.first);a.setValue(kb.a.Chi,0);a.setValue(kb.a.nx,
Yi.OutlineReader.EKf);(new BF.OutlineIndentInfo(!0)).Wmh(a);return a}JZ(a,b,c=null){const h=a.currentNode;if(!a.TA(1))return this.f8b(a,null,b,c);Kd.OutlineElementReader.OI(a)&&mc.OutlineElementNavigator.nDe(a,!0);return Kd.OutlineElementReader.Wg(a)?Sn.Ph.pda(a,!1,b,c):(a.moc(h),null)}boi(a){return Yi.OutlineReader.sje(a.currentNode)||Kd.OutlineElementReader.Wg(a)||Kd.OutlineElementReader.OI(a)||Qe.isTableCell(a)}f8b(a,b=null,c=!1,h=null){if(!this.boi(a))return null;const m=Sn.Ph.NWd();this.Q8k(m,
a);a.sWc(m,b,1,this.yif.JWf());a.Qk(m);c&&(Sn.Ph.qca(a,h),mc.OutlineElementNavigator.Oe(a));J.a.instance.ga(25)&&Sn.Ph.q2e(a.currentNode);return m}Q8k(a,b){if(b=this.ogj(b))switch(b.type){case 11:Sn.Ph.l_d(b,a,!0);break;case 8:b=Sn.Jk.isRtl(b),Sn.Ph.Rnd(a,b)}}ogj(a){return this.yif.o8d(a)}x6i(a,b){a=Sn.Jk.rSc(a);return new Qw.a(a.x+Yi.OutlineReader.NLc*(b?-1:1),a.y+Yi.OutlineReader.MKf)}Jnd(a){if(J.a.instance.ga(17)){var b=new rb.GraphIterator;b.set(a);b.Xu();b=this.x6i(b.origin,Yi.OutlineReader.um(a));
kq.c(a,b.x,b.y)}}HKa(a,b){J.a.instance.ga(43)&&Je.c(a)||a.setValue(kb.a.XI,b?11:9)}static get Jk(){return Pw.PageReader.instance}static get Ph(){return Sn.Di||(Sn.Di=vb.a.instance.resolve("Box4.IOutlineElementEditor"))}static set Ph(a){Sn.Di=a}}Sn.Di=null;Sn.Kf=null;Object(n.a)(Sn,"OutlineEditor",null,[620]);const kP=a=>{a.register(Sn,"Box4.OutlineLevelEditors.OutlineEditor").as("Box4.IOutlineEditor").ma().oa(()=>new Sn(a.resolve("Box4.IOutlineElementNodeIdFactory")));a.register(Pj,"Box4.OutlineLevelEditors.OutlineElementEditor").as("Box4.IOutlineElementEditor").ma().oa(()=>
new Pj(a.re("Box4.IOutlineEditor"),a.re("Box4.List.IListEditor"),a.re("Box4.List.IListReader"),a.resolve("Box4.ICreateParagraphStrategy"),a.resolve("Box4.IMergeListEditorInOutlineElementStrategy"),a.resolve("Box4.IFormattingPropertyTransitStrategy")))};class zA{get name(){return"Box4.OutlineLevelEditors"}$b(a){kP(a)}init(){}dispose(){}static main(){r.a.instance.Dc(new zA)}}Object(n.a)(zA,"Box4OutlineLevelEditorsPackage",null,[2,3]);class AA{get name(){return"Box4.TableEditors"}$b(){}init(){}dispose(){}static main(){r.a.instance.Dc(new AA)}}
Object(n.a)(AA,"Box4TableEditorsPackage",null,[2,3]);class BA{get name(){return"Box4.TextLevelEditors"}$b(){}init(){}dispose(){}static main(){r.a.instance.Dc(new BA)}}Object(n.a)(BA,"Box4TextLevelEditorsPackage",null,[2,3]);class Ir{constructor(a,b,c){this.YFd=this.m4a=this.VFd=this.l4a=this.UDd=null;this.pG=a;this.OPh=b;this.Tc=c;this.init()}init(){this.OPh.pb(Object(F.a)(this,this.Bqj,"handleEditingViewUpdatesSafe"));this.l4a=new Nd.a;this.VFd=new Nd.a;this.m4a=new Nd.a;this.YFd=new Li.a}JZa(a){this.l4a.add(a.key,
a)}vOe(a){this.m4a.add(a.key,a)}Bqj(a){try{this.Aqj(a)}catch(b){a=String.format("Accessibility Manager failed to handle the EditingView event. Message: {0}. Stack: {1}",b.message,b.stack),ba.ULS.sendTraceTag(5285580,334,10,a)}}Aqj(a){let b;({OXd:b}=Ir.cul(this.Tc.Pa.mb)).returnValue&&(a=Ir.a5i(a,this.UDd,b),this.ZEk(a,b),this.UDd=b)}ZEk(a,b){a=this.D1i(a,b);let c;({notification:c}=Ir.Wtl(a)).returnValue&&this.pG.sendNotification(c,!1)}D1i(a,b){const c=new Nd.a;c.$(1,new Li.a);c.$(0,new Li.a);a.forEach(h=>
{3===h?(aa.ImageReader.dH(b.node)||this.vXk(b),this.xdj(c,b)):0===h&&this.B5i(c,b);return!0});return c}vXk(a){this.l4a.forEach((b,c)=>{c.reset(a);return!0})}B5i(a,b){let c=new Nd.a;aa.ImageReader.dH(b.node)||(c=this.y5i(b.Qa));this.z5i(a,this.VFd,c,Ir.Rnh(this.UDd,b));this.VFd=c}y5i(a){const b=new Nd.a;this.l4a.forEach((c,h)=>{c=null;({tBa:c}=h.dtc(a)).returnValue&&b.$(h.key,c);return!0});return b}z5i(a,b,c,h){const m=Box4Intl.Box4Strings.l_AccessibleContentDetailsFormat;b.forEach((y,G)=>{const U=
this.l4a.ga(y).O7||G.title;let ja;({value:ja}=c.Uf(y)).returnValue?h&&ja.ZP!==G.ZP&&(U&&a.ga(1).add(U),y=this.l4a.ga(y).O7,y=String.format(m,ja.title,y),ja.description&&(y+=", "+ja.description),a.ga(0).add(y)):U&&a.ga(1).add(U);return!0});c.forEach((y,G)=>{b.Hb(y)||(y=this.l4a.ga(y).O7,y=String.format(m,G.title,y),G.description&&(y+=", "+G.description),a.ga(0).add(y));return!0})}xdj(a,b){b=this.mjj(b.node);b=this.aui(b);this.njj(a,this.YFd,b);this.YFd=b}mjj(a){const b=new rb.GraphIterator;b.set(a);
if(!b.rc(1))return null;const c=new Li.a;for(;1!==b.ri;)this.m4a.forEach((h,m)=>{let y;({gtb:y}=m.h1e(b)).returnValue&&c.add(y);return!0}),b.zc();c.reverse();return c}aui(a){a=a.toArray();let b=0;for(;b<a.length-1;){var c=a[b];if(c.T0===a[b+1].T0&&(this.m4a.ga(c.T0),({dui:c}={returnValue:!1,dui:null}).returnValue)){a.splice(b,2,c);continue}b++}return new Li.a(a)}njj(a,b,c){var h;for(h=0;h<Math.min(c.length,b.length)&&c.ga(h).contentId.equals(b.ga(h).contentId);h++){var m=this.m4a.ga(c.ga(h).T0).gRc(c.ga(h),
b.ga(h));m&&(c.ga(h).description&&(m+=", "+c.ga(h).description),a.ga(0).add(m))}for(m=h;m<c.length;m++){let y=this.m4a.ga(c.ga(m).T0).gRc(c.ga(m),null);y&&(c.ga(m).description&&(y+=", "+c.ga(m).description),a.ga(0).add(y))}for(c=h;c<b.length;c++)(h=this.m4a.ga(b.ga(c).T0).O7)&&a.ga(1).add(h)}static a5i(a,b,c){const h=new Li.a;(a=a||Ir.w2k(b,c))?(h.add(3),h.add(0)):Ir.Rnh(b,c)&&h.add(0);return h}static w2k(a,b){return!a||!a.node.id.equals(b.node.id)}static Rnh(a,b){return!a||!a.equals(b)}static cul(a){let b;
b=null;if(!a||!(Bb.SelectionEditor.gx(a)||(a=Bb.SelectionEditor.Ql(a,!0,!1),Bb.SelectionEditor.gx(a)||a.Ua&&aa.ImageReader.dH(a.Ua.node))))return{returnValue:!1,OXd:b};b=a.Ua;return{returnValue:!!b,OXd:b}}static Wtl(a){const b=new Li.a;a.ga(1).forEach(c=>{c=String.format(Box4Intl.Box4Strings.l_ContentTypeLeavingNotificationFormat,c);b.add(c);return!0});a.ga(0).forEach(c=>{c=String.format(Box4Intl.Box4Strings.l_ContentTypeEnteringNotificationFormat,c);b.add(c);return!0});a=b.toArray().join(" ");return{returnValue:0<
b.length,notification:a}}}Object(n.a)(Ir,"AccessibilityContextManager",null,[592]);class Rw{constructor(a,b){this.Edf=!1;this.GVb=null;this.KCc=this.oEc=!1;this.H9e=null;this.Wd=a;this.Mmb=b}get Rwj(){return!!this.GVb}pb(a){this.Edf||(this.Mmb.esf(Object(F.a)(this,this.iGc,"afterEditingViewValidateEventHandler")),this.Edf=!0);this.H9e=a}iGc(a,b){(b.JM||b.QU)&&this.tkk(b.JM,b.QU)}tkk(a,b){this.Rwj&&this.Wd.Rg(this.GVb);this.oEc=this.oEc||a;this.KCc=this.KCc||b;this.GVb=new He.a(4,1,Rw.gSi,()=>{this.H9e(this.oEc,
this.KCc);this.reset()},126);this.Wd.Eb(this.GVb)}reset(){this.GVb=null;this.KCc=this.oEc=!1}}Rw.gSi=100;Object(n.a)(Rw,"EditingViewOnAfterValidateEventsConsolidator",null,[591]);class CA{constructor(){this.Da=null}get name(){return"Box4.Accessibility"}init(){Fc.App.ewf&&this.Da.resolve("Box4.Accessibility.IAccessibilityContextManager")}dispose(){}$b(a){this.Da=a;a.register(Rw,"Box4.Accessibility.EditingViewOnAfterValidateEventsConsolidator").as("Box4.Accessibility.IEditingViewOnAfterValidateEventsConsolidator").ma().oa(()=>
new Rw(u.AFrameworkApplication.we,a.resolve("Box4.ContentEditableViewEventSource")));a.register(Ir,"Box4.Accessibility.AccessibilityContextManager").as("Box4.Accessibility.IAccessibilityContextManager").ma().oa(()=>new Ir(a.resolve("Common.Utils.IAriaNotifier"),a.resolve("Box4.Accessibility.IEditingViewOnAfterValidateEventsConsolidator"),me.a.instance))}static main(){r.a.instance.Dc(new CA)}}Object(n.a)(CA,"Box4AccessibilityPackage",null,[2,3]);class DA{constructor(a,b){this.Tkf=a;this.r2=b;this.pkf=
this.mkf=this.nkf=this.okf=this.Y6e=this.qkf=!0}get mib(){return this.qkf}get sIc(){return this.Y6e}get Bkd(){return this.okf}get Qnc(){return this.nkf}get zkd(){return this.mkf}get QPe(){return this.pkf}aAf(a){if(a)for(let c in a){var b=c;const h=Boolean.parse(a[c].toString()||"false");switch(b){case "ReplaceTextAsYouType":this.qkf=h;break;case "CapitalizeFirstLetterOfSentences":this.Y6e=h;break;case "ReplaceOrdianalsWithSuperscript":this.okf=h;break;case "ReplaceHyphensWithDash":this.nkf=h;break;
case "ReplaceFractionsWithFractionCharacter":this.mkf=h;break;case "ReplaceQuoteWithSmartQuote":this.pkf=this.r2&&h}}}p2i(){this.Tkf.R9d("getAutoCorrectOptionsSettings","ReplaceTextAsYouType CapitalizeFirstLetterOfSentences ReplaceOrdianalsWithSuperscript ReplaceHyphensWithDash ReplaceFractionsWithFractionCharacter ReplaceQuoteWithSmartQuote".split(" ")).continueWith(Object(F.a)(this,this.Vok,"onGetRequestFinished"),8);ba.ULS.sendTraceTag(24523491,324,50,"Load to get autocorrect options from Roaming Service.")}s0k(a){this.Tkf.urh("saveAutoCorrectOptionsSettings",
a);ba.ULS.sendTraceTag(24523520,324,50,"Try to save autocorrect options to Roaming Service.");this.aAf(a)}Vok(a){a.rm?ba.ULS.sendTraceTag(24523522,324,15,"Fail to get autocorrect options from Roaming Service."):((a=a.result)&&this.aAf(a),ba.ULS.sendTraceTag(24523521,324,50,"Load to get autocorrect options from Roaming Service successfully, isUserSettingsEmpty: {0}",!a||!Da.a.count(a)))}}Object(n.a)(DA,"AutoCorrectOptionsInfo",null,[1012]);var ty=d(215);class lj{static get Swf(){lj.GPb||(lj.GPb=[],
lj.oFb(Fa.a.ue("ar-sa")),lj.oFb(Fa.a.ue("de-de")),lj.oFb(Fa.a.ue("es-es")),lj.pR(Fa.a.ue("en-029"),Fa.a.ue("en-us")),lj.pR(Fa.a.ue("en-au"),Fa.a.ue("en-us")),lj.pR(Fa.a.ue("en-bz"),Fa.a.ue("en-us")),lj.pR(Fa.a.ue("en-ca"),Fa.a.ue("en-us")),lj.pR(Fa.a.ue("en-gb"),Fa.a.ue("en-us")),lj.pR(Fa.a.ue("en-id"),Fa.a.ue("en-us")),lj.pR(Fa.a.ue("en-my"),Fa.a.ue("en-us")),lj.pR(Fa.a.ue("en-ph"),Fa.a.ue("en-us")),lj.pR(Fa.a.ue("zh-tw"),Fa.a.ue("en-us")),lj.oFb(Fa.a.ue("fr-fr")),lj.pR(Fa.a.ue("hr-ba"),Fa.a.ue("hr-hr")),
lj.pR(Fa.a.ue("it-ch"),Fa.a.ue("it-it")),lj.pR(Fa.a.ue("nb-no"),Fa.a.ue("nn-no")),lj.oFb(Fa.a.ue("nl-nl")),lj.pR(Fa.a.ue("ro-md"),Fa.a.ue("ro-ro")),lj.pR(Fa.a.ue("ru-md"),Fa.a.ue("ru-ru")),lj.pR(Fa.a.ue("sr-latn-ba"),Fa.a.ue("sr-latn-cs")),lj.pR(Fa.a.ue("sr-latn-me"),Fa.a.ue("sr-latn-cs")),lj.pR(Fa.a.ue("sr-latn-rs"),Fa.a.ue("sr-latn-cs")),lj.oFb(Fa.a.ue("sr-cyrl-cs")),lj.pR(Fa.a.ue("sv-fi"),Fa.a.ue("sv-se")));return lj.GPb}static oFb(a){lj.GPb[a.languageId]=a.LCID}static pR(a,b){lj.GPb[a.LCID]=b.LCID}static q_f(a){var b=
Fa.a.ue(a);if(!b)return 0;b=lj.Swf[b.LCID]||lj.Swf[b.languageId]||0;return b===a?0:b}}lj.GPb=null;Object(n.a)(lj,"AutoCorrectListFallback",null,[]);class Tn{constructor(a,b,c,h,m){this.Qcf=!1;this.uff=0;this.kNa=null;this.EZh=!1;this.nff=this.ehf=!0;this.hcf=null;this.Izc=!0;this.Onb=a;this.lNa=b;this.D3a=c;this.X6=h;this.Zg=m;this.xUb=a?a.innerText:Ob.ParagraphReader.text(b)}get ex(){throw Error.notImplemented("The inherit class should have the default value.");}set ex(a){}get K0c(){return this.uff}Mrh(a){this.uff=
a}get mb(){return this.kNa}set mb(a){this.kNa=a}get xag(){return this.Onb}get y7f(){return this.lNa}get kA(){return this.D3a}get qR(){return this.X6}get MFb(){return this.ehf}set MFb(a){this.ehf=a}get mgg(){return this.Qcf}get flg(){return!1}get tna(){return this.xUb}invoke(){this.Qcf=!0;if(this.Onb&&this.Onb.parentNode&&!this.ex){var a=this.Onb.innerText;if(this.MFb&&ta.a.substring(this.xUb,this.D3a,this.X6)!==ta.a.substring(a,this.D3a,this.X6))return 0;this.E7a(this.Onb);this.Mrh(this.Onb.innerText.length-
a.length);return 1}this.Izc||ec.a.instance.Wb("MatchTextIsNotTheSame",{["Reason"]:"MatchTextIsNotTheSame"});if(!this.nff)return ec.a.instance.Wb("AbortedAction",{["Reason"]:this.hcf}),0;var b=Ob.ParagraphReader.text(this.lNa);a=b.length;var c=this.xUb.length,h=ta.a.substring(this.xUb,this.D3a,this.X6).trimEnd();b=ta.a.substring(b,this.D3a,this.X6).trimEnd();h===b&&this.X6>c&&(this.X6=c);if(this.MFb&&h!==b)if(c=h.replace(RegExp('"',"g"),""),c===ta.a.substr(b,0,c.length))this.X6-=2;else return 0;if(J.a.instance.ga(50)&&
Fc.App.Ih.lw&&sF.CoauthLockEditor.getInstance().ULb(Tn.aj.z4b(this.lNa)))return 0;c=new t.GraphTransaction(15);c.kd(this.lNa);c.jd=this.commandId;this.a8(this.lNa);this.Mrh(Ob.ParagraphReader.textLength(this.lNa)-a);this.kNa&&!this.EZh&&Bb.SelectionEditor.gx(this.kNa)&&(b=this.kNa.Ua,a=b.Qa,h=b.Nb,b=b.node,b===this.lNa&&this.K0c&&(a>=this.X6&&(a+=this.K0c),h>=this.X6&&(h+=this.K0c),this.kNa=yd.SelectionFactory.V2(b,a,h)));c.dispose();return 2}cIh(){this.Izc=this.sCf()}E7a(){}sCf(){var a=Ob.ParagraphReader.text(this.lNa);
const b=ta.a.substring(this.xUb,this.D3a,this.X6).trimEnd();a=ta.a.substring(a,this.D3a,this.X6).trimEnd();return b===a}static get aj(){return Dc.a.instance}}Object(n.a)(Tn,"AutoCorrectAction",null,[653]);class Un extends Tn{constructor(a,b,c,h,m,y){super(a,b,c,h,y);this.Dff=null;this.Mma=m;this.uV=y}get fVa(){return this.Dff||(this.Dff=vb.a.instance.rb("Box4.List.IListCommands"))}get eq(){return Un.Xo||(Un.Xo=vb.a.instance.resolve("Box4.List.IListEditor"))}get ex(){return!0}get commandId(){return D.a.GQd}set ex(a){super.ex=
a}}Un.Xo=null;Object(n.a)(Un,"RegexCorrectAction",Tn,[]);const nv={[0]:{"a)":{autonumberBulletType:2,Ri:[65533,4,41]},"a.":{autonumberBulletType:4,Ri:[65533,4,46]},"A.":{autonumberBulletType:5,Ri:[65533,3,46]},"1)":{autonumberBulletType:7,Ri:[65533,0,41]},"1.":{autonumberBulletType:8,Ri:[65533,0,46]},"i.":{autonumberBulletType:14,Ri:[65533,2,46]},"I.":{autonumberBulletType:15,Ri:[65533,1,46]}},[1]:{"*":{Ri:[8226],font:"Arial"},"-":{Ri:[45],font:"Calibri"},"--":{Ri:[167],font:"Wingdings"},">":{Ri:[216],
font:"Wingdings"},"<>":{Ri:[118],font:"Wingdings"}}};class Mo extends Un{constructor(a,b,c,h,m,y){super(a,b,c,h,m,y);Mo.IMa=y}get commandId(){return D.a.yQd}a8(a){if(this.fVa){var b=rb.GraphIterator.nb(a);b.gf();mc.OutlineElementNavigator.Oe(b);var c=Mo.Sf.fw(b),h=this.Mma[0];switch(ta.a.charAt(h,0)){case "*":var m=Pe.a.pN(1,1);m.zra="*";break;default:m=Pe.a.pN(1,0)}c&&m.yae(c)||(c=new t.GraphTransaction(15),c.yy(b),b=this.Y2i(m.listType,m.listStyle,h),null!=b&&this.fVa.Gki(b)&&(ba.ULS.sendTraceTag(509747285,
393,50,"Found list insert matching string "+h),Mo.IMa.replaceTextRange(md.a.createTextRange(a,this.kA,this.qR+1),"",!0,!1)),c.dispose())}}Y2i(a,b,c){var h;let m=null===(h=null===nv||void 0===nv?void 0:nv[a])||void 0===h?void 0:h[c];if(null==m)return null;c=new E.DictionaryPropertySet;c.setValue(xc.a.fE,a);c.setValue(xc.a.Mda,b);c.setValue(kb.a.Ri,m.Ri);c.setValue(kb.a.font,m.font);return c}static get characterPropertiesEditor(){return Mo.IMa||(Mo.IMa=vb.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static get Sf(){return Mo.Ug||
(Mo.Ug=vb.a.instance.resolve("Box4.List.IListReader"))}static dC(a,b,c,h,m){return new Mo(null,a,b,c,h,m)}static aQ(a,b,c,h,m){return new Mo(a,vf.a(a).gb,b,c,h,m)}}Mo.IMa=null;Mo.Ug=null;Object(n.a)(Mo,"BulletListAction",Un,[]);class ah extends Un{constructor(a,b,c,h,m,y){super(a,b,c,h,m,y);this.SSb=!1;this.ex=!a;this.IMa=y;ah.pl=new Jb.a}get ex(){return this.SSb}set ex(a){this.SSb=a}E7a(a){this.vTd(a.innerText,(b,c,h)=>{a.innerText=ta.a.substring(a.innerText,0,b)+h+ta.a.right(a.innerText,c)})}a8(a){this.vTd(Ob.ParagraphReader.text(a).substring(this.kA,
this.qR),(b,c,h)=>{this.IMa.replaceTextRange(md.a.createTextRange(a,this.kA+b,this.kA+c),h,!0,!1)})}vTd(a,b){if(!(2>this.Mma.length)&&this.Mma[1]){var c=this.Mma[1];ah.pl.count||this.K$g();ah.pl.Hb(c)&&(a=a.lastIndexOf(c),-1!==a&&b(a,a+c.length,ah.pl.ga(c)))}}}ah.pl=null;Object(n.a)(ah,"DictionarySequenceReplacerAction",Un,[]);class Sw extends ah{constructor(a,b,c,h,m,y){super(a,b,c,h,m,y)}get commandId(){return D.a.NYb}K$g(){ah.pl.$("--","\u2014");ah.pl.$(" -- "," \u2013 ");ah.pl.$(" - "," \u2013 ");
ah.pl.$("-- ","\u2014");ah.pl.$(" --"," \u2013");ah.pl.$(" -"," \u2013")}static dC(a,b,c,h,m){return new Sw(null,a,b,c,h,m)}static aQ(a,b,c,h,m){return new Sw(a,vf.a(a).gb,b,c,h,m)}}Object(n.a)(Sw,"DashAction",ah,[]);class Kt extends ah{constructor(a,b,c,h,m,y,G){super(a,b,c,h,m,y);this.Ca=G}get commandId(){return D.a.AQd}K$g(){ah.pl.$(":)","\ud83d\ude0a");ah.pl.$(":-)","\ud83d\ude0a");ah.pl.$(":|","\ud83d\ude10");ah.pl.$(":-|","\ud83d\ude10");ah.pl.$(":(","\ud83d\ude41");ah.pl.$(":-(","\ud83d\ude41");
ah.pl.$(";)","\ud83d\ude09");ah.pl.$(";-)","\ud83d\ude09");ah.pl.$(":D","\ud83d\ude00");ah.pl.$(":-D","\ud83d\ude00");ah.pl.$(":')","\ud83d\ude02");ah.pl.$("=D","\ud83d\ude03");ah.pl.$(":>","\ud83d\ude06");ah.pl.$(":->","\ud83d\ude06");ah.pl.$(":3","\ud83d\ude0a");ah.pl.$(":-3","\ud83d\ude0a");ah.pl.$("B-)","\ud83d\ude0e");ah.pl.$("*-*","\ud83d\ude0d");ah.pl.$(":*","\ud83d\ude19");ah.pl.$(":-*","\ud83d\ude19");ah.pl.$(":X","\ud83d\ude36");ah.pl.$(":-X","\ud83d\ude36");ah.pl.$(":O","\ud83d\ude2e");
ah.pl.$(":-O","\ud83d\ude2e");ah.pl.$(":#","\ud83e\udd10");ah.pl.$(":-#","\ud83e\udd10");ah.pl.$(":P","\ud83d\ude1b");ah.pl.$(":-P","\ud83d\ude1b");ah.pl.$(";P","\ud83d\ude1c");ah.pl.$(";-P","\ud83d\ude1c");ah.pl.$(":-/","\ud83d\ude15");ah.pl.$("$-$","\ud83e\udd11");ah.pl.$(":S","\ud83d\ude16");ah.pl.$(":-S","\ud83d\ude16");ah.pl.$(":[","\ud83d\ude1f");ah.pl.$(":-[","\ud83d\ude1f");ah.pl.$(":\u2019(","\ud83d\ude22");ah.pl.$(":'(","\ud83d\ude22");ah.pl.$("@-@","\ud83d\ude31")}a8(a){this.vTd(Ob.ParagraphReader.text(a).substring(this.kA,
this.qR),(b,c,h)=>{b=md.a.createTextRange(a,this.kA+b,this.kA+c);c={};c.MenuItemId=h;this.Ca.mi(b,D.a.LEj,2,!1,null,c,null)})}static dC(a,b,c,h,m,y){return new Kt(null,a,b,c,h,m,y)}static aQ(a,b,c,h,m,y){return new Kt(a,vf.a(a).gb,b,c,h,m,y)}}Object(n.a)(Kt,"EmojiAction",ah,[]);class Ap{constructor(a,b,c,h){this.lK=a;this.dEc=b;this.zef=h;this.Gz=c}Aig(){if(!this.Gz)return!1;this.lK=this.lK.trimStart();return this.lK===this.Gz?!0:!1}UVj(){if(!this.lK)return!1;const a=this.lK.lastIndexOf(" ");return-1!==
a&&"."===this.lK.charAt(a-1)&&"."===this.lK.charAt(a-3)?!0:!1}TVj(){if(!this.lK)return!1;const a=this.lK.lastIndexOf(" ");return-1!==a&&"."===this.lK.charAt(this.lK.substring(0,a-1).lastIndexOf(" ")+2)?!0:!1}cPj(){return this.Aig()&&(1===this.Gz.length&&"."===this.dEc||"."===this.lK.charAt(1))?!0:!1}dPj(){return this.Gz?0<="\\/".indexOf(this.dEc)||3===this.Gz.length&&0<="\\/".indexOf(this.Gz.charAt(1))?!0:!1:!1}dOj(){return this.Gz?0<=this.Gz.indexOf("@")?!0:!1:!1}Zs(){if(!this.Gz)return!1;for(const a of Ap.g$d())if(ta.a.startsWith(this.Gz+
this.dEc,a))return!0;return!1}NNj(){return this.Gz?"i"===this.Gz&&0<=Ap.quotes.indexOf(this.dEc)?!0:!1:!1}mJj(){if(!this.lK)return!1;const a=ta.a.EFa(this.lK,this.lK.length-1);if(-1!==a&&this.lK.substring(a+1,this.lK.length)===this.Gz){const b=this.lK.charAt(a-1);if(0<=Ap.KSe.indexOf(b)||0<=Ap.quotes.indexOf(b)&&0<=Ap.KSe.indexOf(this.lK.charAt(a-2)))return!0}return!1}Upi(){return!this.lK||this.UVj()||this.cPj()||this.dPj()||this.TVj()||this.dOj()||this.Zs()?!1:this.Aig()||this.NNj()||this.mJj()?
!0:!1}static g$d(){return Ap.Cff||(Ap.Cff="http: https: ftp:// mailto: \\\\ www.".split(" "))}}Ap.KSe=".!?";Ap.quotes="'\"";Ap.Cff=null;Object(n.a)(Ap,"FirstLetterUpperCaseRules",null,[]);class lq{constructor(a){this.Gz=a}KZi(){if(!this.Gz)return null;for(let a=0;a<lq.K6f().length;a++)if(this.Gz===lq.K6f()[a])return lq.pnj()[a];return null}static K6f(){return lq.naf||(lq.naf=["1/2","1/4","3/4"])}static pnj(){return lq.maf||(lq.maf=["\u00bd","\u00bc","\u00be"])}}lq.naf=null;lq.maf=null;Object(n.a)(lq,
"FractionsCollection",null,[]);class EA extends Tn{constructor(a,b,c,h,m,y){super(a,b,c,h,y);this.zQb=m;this.uV=y}get ex(){return!0}get commandId(){return D.a.BQd}E7a(a){a.innerText=ta.a.substring(a.innerText,0,this.kA)+this.zQb+ta.a.right(a.innerText,this.qR)}a8(a){this.uV.replaceTextRange(md.a.createTextRange(a,this.kA,this.qR),this.zQb,!0,!1)}set ex(a){super.ex=a}static dC(a,b,c,h,m){return new EA(null,a,b,c,h,m)}}Object(n.a)(EA,"FractionsReplaceCorrectAction",Tn,[]);class Bs extends Un{constructor(a,
b,c,h,m,y){super(a,b,c,h,m,y)}get commandId(){return D.a.DQd}a8(a){if(this.fVa){var b=rb.GraphIterator.nb(a);b.gf();mc.OutlineElementNavigator.Oe(b);var c=this.Mma[0],h=Bs.Kkk(c),m=ta.a.A$b(c.charAt(0))?4:2,y=md.a.createTextRange(a,this.kA,this.qR+1);this.eq.GPa(a,b,m,h,y,c,this.fVa)}}static dC(a,b,c,h,m){return new Bs(null,a,b,c,h,m)}static aQ(a,b,c,h,m){return new Bs(a,vf.a(a).gb,b,c,h,m)}static Kkk(a){if(!a)return 0;a=ta.a.og(a);if(!ta.a.wXc(a.charAt(0)))return 0;const b=a.charCodeAt(0)-97+1;let c;
for(c=1;c<a.length&&a.charAt(c)===a.charAt(0);c++);return 26*(c-1)+b}}Object(n.a)(Bs,"LetterListAction",Un,[]);class Tw extends Un{constructor(a,b,c,h,m,y){super(a,b,c,h,m,y)}get commandId(){return D.a.GPa}a8(a){if(this.fVa){var b=rb.GraphIterator.nb(a);b.gf();mc.OutlineElementNavigator.Oe(b);var c=this.Mma[0],h=parseInt(c);if(!(99999999<=h)){var m=md.a.createTextRange(a,this.kA,this.qR+1);this.eq.GPa(a,b,1,h,m,c,this.fVa)}}}static dC(a,b,c,h,m){return new Tw(null,a,b,c,h,m)}static aQ(a,b,c,h,m){return new Tw(a,
vf.a(a).gb,b,c,h,m)}}Object(n.a)(Tw,"NumberListAction",Un,[]);class Bp extends Tn{constructor(a,b,c,h,m){super(a,b,c,h,m);Bp.uV=m}get ex(){return!0}get commandId(){return D.a.EQd}E7a(){}a8(a){const b=md.a.createTextRange(a,this.qR-2,this.qR),c=new t.GraphTransaction(15);c.kd(a);let h=!1,m=null,y=0;for(;y<a.Ra.length;){var G=a.Ra.ga(y),U=!!G.Io||G.Eda;let ja=!!G.fieldRangeEnd||G.x_;if(G.cp>=b.Qa){G.cp>b.Qa||!G.formatting?m=h?G.formatting:Bp.uV.Zfa(a,y,b.Qa,m):(m=G.formatting,ja&&(h=!1),U&&(h=!0));
y++;break}G.formatting&&(m=G.formatting);ja&&(h=!1);U&&(h=!0);y++}for(;y<a.Ra.length;){U=a.Ra.ga(y);if(U.cp>=b.Nb){if(U.cp>b.Nb||!U.formatting&&!U.Mj)h||Bp.uV.Zfa(a,y,b.Nb,m);h||Bp.kh.IY(m,!0);break}U.formatting&&(h||Bp.kh.IY(m,!0),m=U.formatting);G=!!U.Io||U.Eda;U=!!U.fieldRangeEnd||U.x_;G&&(h=!0);!G&&U&&(h=!1);y++}c.dispose()}set ex(a){super.ex=a}static get kh(){return Bp.Kf||(Bp.Kf=vb.a.instance.resolve("Box4.IFormattingEditor"))}static dC(a,b,c,h){return new Bp(null,a,b,c,h)}}Bp.uV=null;Bp.Kf=
null;Object(n.a)(Bp,"OrdinalsReplaceCorrectAction",Tn,[]);class tl extends Un{constructor(a,b,c,h,m,y){super(a,b,c,h,m,y);tl.Zob||tl.nll();this.IMa=y}get commandId(){return D.a.FQd}a8(a){if(!a.I9f){var b=this.kNa.Ua.node===a,c=-1,h=3;this.Mma[2]&&(c=parseInt(this.Mma[2]));this.Mma[1]&&(h=parseInt(this.Mma[1]));if(!(20<c||100<h)){a.UG().graphTransactionOperations.xia(7);var m=rb.GraphIterator.nb(a);m.gf();mc.OutlineElementNavigator.Oe(m);tl.Ph.pda(m,!1,!1);tl.Ph.qca(m);for(let U=0;U<h;++U){const ja=
[];var y=U%tl.Zob.length,G=0<c?c:tl.Zob[y].length;for(let va=0;va<G;++va)Array.add(ja,tl.Zob[y][va%tl.Zob[y].length]);y=md.a.Kj(m.currentNode,0);G=uc.a.ps(y);2!==Fc.App.mode?tl.kh.I_a(G,1142):tl.kh.Dm(G,jb.a.noProof,!0);this.IMa.replaceTextRange(y,ja.join(" "),!0,!1);U<h-1&&(mc.OutlineElementNavigator.Oe(m),tl.Ph.pda(m,!1,!1),tl.Ph.qca(m))}c=m.currentNode;m=rb.GraphIterator.nb(a);m.gf();mc.OutlineElementNavigator.Oe(m);m.Mi();b&&(this.kNa=yd.SelectionFactory.Qg(c,Ob.ParagraphReader.textLength(c)))}}}static get Ph(){return tl.Di||
(tl.Di=vb.a.instance.resolve("Box4.IOutlineElementEditor"))}static get kh(){return tl.Kf||(tl.Kf=vb.a.instance.resolve("Box4.IFormattingEditor"))}static nll(){tl.Zob=[["Lorem ipsum dolor sit amet, consectetuer adipiscing elit.","Maecenas porttitor congue massa.","Fusce posuere, magna sed pulvinar ultricies, purus lectus malesuada libero, sit amet commodo magna eros quis urna."],["Nunc viverra imperdiet enim.","Fusce est.","Vivamus a tellus."],["Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas.",
"Proin pharetra nonummy pede.","Mauris et orci."]]}static dC(a,b,c,h,m){return new tl(null,a,b,c,h,m)}static aQ(a,b,c,h,m){return new tl(a,vf.a(a).gb,b,c,h,m)}}tl.Zob=null;tl.Di=null;tl.Kf=null;Object(n.a)(tl,"RandAction",Un,[]);class CF{constructor(a,b,c,h){this.pattern=h&8?new RegExp(a,"i"):new RegExp(a);this.Byj=b;this.koj=c;this.flags=h}}Object(n.a)(CF,"RegexAutoCorrectEntry",null,[]);class dn extends Un{constructor(a,b,c,h,m,y){super(a,b,c,h,m,y)}get commandId(){return D.a.HQd}a8(a){if(this.fVa){var b=
rb.GraphIterator.nb(a);b.gf();mc.OutlineElementNavigator.Oe(b);var c=this.Mma[0],h=ta.a.substring(c,0,c.indexOf("."));h=dn.Lkk(h);if(!(0>=h)){var m=ta.a.A$b(c.charAt(0))?5:3,y=md.a.createTextRange(a,this.kA,this.qR+1);this.eq.GPa(a,b,m,h,y,c,this.fVa)}}}static dC(a,b,c,h,m){return new dn(null,a,b,c,h,m)}static aQ(a,b,c,h,m){return new dn(a,vf.a(a).gb,b,c,h,m)}static sRi(){dn.uqa||(dn.uqa={},dn.uqa.M=1E3,dn.uqa.D=500,dn.uqa.C=100,dn.uqa.L=50,dn.uqa.X=10,dn.uqa.V=5,dn.uqa.I=1)}static Lkk(a){if(!a)return 0;
dn.sRi();a=ta.a.FB(a);let b=0,c=0;for(let h=a.length-1;0<=h;h--){const m=dn.uqa[ta.a.charAt(a,h).toString()];c=m<b?c-m:c+m;b=m}return c}}dn.uqa=null;Object(n.a)(dn,"RomanListAction",Un,[]);class Uw extends Tn{constructor(a,b,c,h,m,y){super(a,b,c,c+1,y);this.uV=y;this.D1h=h;this.Y7e=m;this.MFb=!1}get ex(){return!1}get commandId(){return D.a.Zfi}E7a(a){a.innerText=ta.a.substring(a.innerText,0,this.kA)+this.Y7e+ta.a.right(a.innerText,this.qR)}a8(a){this.uV.replaceTextRange(md.a.createTextRange(a,this.kA,
this.qR),this.D1h,!0,!1);this.uV.replaceTextRange(md.a.createTextRange(a,this.kA,this.kA+1),this.Y7e,!0,!1)}set ex(a){super.ex=a}static dC(a,b,c,h,m,y){if("'"!==c&&'"'!==c)return null;var G=rb.GraphIterator.nb(a);G.gf();mc.OutlineElementNavigator.Oe(G);if(Kd.OutlineElementReader.um(G.currentNode))return null;h=!b||ta.a.ple(h)||-1!==Array.indexOf(Uw.Nuk,h);G="'"===c;return new Uw(y,a,b,c+"",h?G?"\u2018":"\u201c":G?"\u2019":"\u201d",m)}}Uw.Nuk=["[","{","("];Object(n.a)(Uw,"SmartQuoteCorrectAction",
Tn,[]);class Cs extends Tn{constructor(a,b,c,h,m,y){super(a,b,c,h,y);this.zQb=m;this.uV=y}get ex(){return Cs.SSb}set ex(a){Cs.SSb=a}get commandId(){return D.a.JQd}cIh(){this.Izc=this.sCf();this.Izc||(this.nff=!1,this.hcf="MatchTextIsNotTheSame")}E7a(a){a.innerText=ta.a.substring(a.innerText,0,this.kA)+this.zQb+ta.a.right(a.innerText,this.qR)}a8(a){this.uV.replaceTextRange(md.a.createTextRange(a,this.kA,this.qR),this.zQb,!0,!1)}static aQ(a,b,c,h,m){const y=vf.a(a);return new Cs(a,y?y.gb:null,b,c,h,
m)}static dC(a,b,c,h,m){return new Cs(null,a,b,c,h,m)}}Cs.SSb=!1;Object(n.a)(Cs,"StringReplaceCorrectAction",Tn,[]);class uy extends Tn{constructor(a,b,c,h,m,y,G,U){super(a,b,c,h,m);this.uV=m;this.wD=y;this.uTh=G;this.BD=U}get ex(){return!0}get commandId(){return D.a.LQd}E7a(a){let b=ta.a.substring(a.innerText,this.kA,this.qR);b.charAt(0)!==b.charAt(0).toUpperCase()&&(b=b.charAt(0).toUpperCase()+b.substring(1,b.length));a.innerText=ta.a.substring(a.innerText,0,this.kA)+b+ta.a.right(a.innerText,this.qR)}a8(a){const b=
this.kA,c=this.kA+1,h=a.characterData.substring(b,c).charAt(0);ta.a.A$b(h)||(a=md.a.createTextRange(a,b,c),this.DJj(a)||this.uV.replaceTextRange(a,h.toUpperCase().toString(),!0,!1))}DJj(a){return this.uTh?!!this.wD&&this.wD.hua(a):!1}set ex(a){super.ex=a}static aQ(a,b,c,h){const m=vf.a(a);return new uy(a,m?m.gb:null,b,c,h,null,!1,null)}static dC(a,b,c,h,m,y,G){return new uy(null,a,b,c,h,m,y,G)}}Object(n.a)(uy,"UpperFirstLetterAutoCorrect",Tn,[]);class Jr{constructor(a,b){this.zef=b;this.Gz=a}RCl(){const a=
Number.parseInvariant(this.Gz.substring(0,this.Gz.length-2));switch(Number.parseInvariant(this.Gz.charAt(this.Gz.length-3).toString())){case 1:return 11===a?"th":"st";case 2:return 12===a?"th":"nd";case 3:return 13===a?"th":"rd";case 4:case 5:case 6:case 7:case 8:case 9:case 0:return"th";default:return""}}nPj(){var a=Fa.a.ue(this.zef);if(!a||!a.name.toLowerCase().startsWith("en")||!this.Gz||2>=this.Gz.length)return!1;for(a=0;a<Jr.eUc().length;a++)if(this.Gz.toLowerCase().endsWith(Jr.eUc()[a])){if(RegExp("^\\d+$").test(this.Gz.substr(0,
this.Gz.length-2))){const b=this.RCl();if(this.Gz.toLowerCase().endsWith(Jr.eUc()[a])&&b===Jr.eUc()[a])return!0}break}return!1}static eUc(){return Jr.kif||(Jr.kif=["st","nd","rd","th"])}}Jr.kif=null;Object(n.a)(Jr,"ValidateOrdinalsRule",null,[]);class Om{constructor(a,b,c,h,m,y,G){this.k4a=[];this.umb=[];this.FPb=[];this.rwd=[];this.Upa=-1;this.Dbf=this.r2=this.ixc=!1;this.ryc=a;this.Zg=b;this.wD=c;this.Ca=h;this.QR=y;this.BD=G;m?(this.ixc=m.ka("WordEditorEmoticonAutoCorrectIsEnabled")||m.ka("OneNoteInsertEmojiIsEnabled"),
this.r2=m.ka("ReplaceQuoteWithSmartQuoteIsEnabled"),this.Dbf=m.ka("HyperlinkUrlValidationIsEnabled"),ba.ULS.sendTraceTag(23418953,324,50,"{0}",{["WordEditorEmoticonAutoCorrectIsEnabled"]:this.ixc,["ReplaceQuoteWithSmartQuoteIsEnabled"]:this.r2})):(ba.ULS.sendTraceTag(23418954,324,50,"appSettingsManager is null.  Auto correct is disabled for: emoticons and smart quotes."),this.r2=this.ixc=!1)}Lhe(a){return 0<=Om.zQd.indexOf(a)}KUj(a){return 0<=Om.KQd.indexOf(a)}Hhg(a){return a.toLowerCase()===a}A$b(a){return a.toUpperCase()===
a}wXc(a){return a.toLowerCase()!==a.toUpperCase()}uLj(a,b,c,h){return(new Ap(a,b,c,h)).Upi()}N5i(a){do{if(a.getAttribute("xml:lang"))return Fa.a.ue(a.getAttribute("xml:lang"))||Fa.a.q8b;if(a.getAttribute("lang"))return Fa.a.ue(a.getAttribute("lang"))||Fa.a.q8b;a=a.parentNode}while(a&&1===a.nodeType);return Fa.a.q8b}Y4d(a){return Fa.a.ue(uc.a.language(uc.a.ps(a)))||Fa.a.q8b}$Oc(a,b){0>b&&(b=0);let c=-1;const h=Om.zQd.length;for(let m=0;m<h;++m){const y=a.lastIndexOf(ta.a.charAt(Om.zQd,m),b);y>c&&(c=
y)}a=ta.a.EFa(a,b);a>c&&(c=a);return c}rWi(a){for(let b=0;b<a.length;++b)if(this.wXc(ta.a.charAt(a,b)))return b;return-1}fUf(a,b){if(!a||0>b)return-1;let c=b;c=c?this.$Oc(a,c-1):-1;c=c>ta.a.EFa(a,b-1)?c:ta.a.EFa(a,b-1);c++;return c}ZTf(a,b,c){if(!J.a.instance.ga(70))return null;this.G2b(b);if(!this.umb[b])if(b=lj.q_f(b),0<b){if(this.G2b(b),!this.umb[b])return null}else return null;if(c&&this.FPb[b]&&Array.contains(this.FPb[b],a+c))return null;c=this.umb[b][ta.a.og(a)];if("string"!==typeof c||c===
a)return null;if(c){var h=this.rWi(a);if(0>h||this.Hhg(ta.a.charAt(a,h)))return c;b=!0;for(h+=1;h<a.length;++h){const m=ta.a.charAt(a,h);b&&!this.A$b(m)&&(b=!1)}return b?ta.a.FB(c):ta.a.FB(ta.a.substring(c,0,1))+ta.a.right(c,1)}return null}zWi(a,b,c,h){Te.a.mark(4666);const m=this.N5i(b).LCID;let y=0,G=a;const U=b.innerText;if(this.bie(U.substring(U.lastIndexOf(" ",a)+1,a)))return Te.a.mark(4667),null;let ja=null;var va=!1;do{G=G?this.$Oc(U,G-1):-1;if(-1===G&&!c){va=b;var Ta=null;if(!this.Lhe(U.charAt(0))){do{for(;va&&
!va.previousSibling;)va=va.parentNode;va&&(va=va.previousSibling,Ta=va.innerText)}while(va&&!Ta);if(va&&Ta&&!this.Lhe(ta.a.charAt(Ta,Ta.length-1)))return Te.a.mark(4667),null}va=!0}Ta=ta.a.substring(U,G+1,a);++y;var fb=this.ZTf(Ta,m,h.toString());if(fb)ja=Cs.aQ(b,G+1,a,fb,this.Zg);else for(fb=0;fb<this.k4a.length;++fb){const Db=this.k4a[fb];if(!(Db.flags&1&&!(c&&1>G)||Db.flags&4||Db.flags&2&&" "!==h)){const gc=Db.pattern.exec(Ta);if(gc){ja=Db.Byj(b,G+1,a,gc,this.Zg,this.Ca);break}}}}while(!va&&!ja&&
y<Om.NXg&&0<=G);Te.a.mark(4667);return ja}vWi(a,b,c){const h=a.node;let m=Ob.ParagraphReader.text(h);0>b&&(b=a.Qa);a=this.Y4d(a).LCID;if(this.bie(m.substring(ta.a.EFa(m,b)+1,b)))return null;var y=-1,G=Ib.HyperlinkReader.S4b(h);for(var U=0;U<G.length;U++)if(b>G[U].Nb)y=G[U].Nb;else{if(b>G[U].Qa)return null;break}G=null;U=(U=b)?this.$Oc(m,U-1):-1;U<y&&(U=y-1);y=ta.a.substring(m,U+1,b);y=y.trimStart();if(1>U)for(let ja=0;ja<this.k4a.length;++ja){const va=this.k4a[ja];let Ta=m;" "!==c&&(Ta=m+c);if(va.pattern.exec(Ta))return null}m=
m.substring(0,b);if(!this.uLj(m,c.toString(),y,a))return null;y.charAt(0).toUpperCase()!==y.charAt(0)&&(G=uy.dC(h,U+1,b,this.Zg,this.wD,J.a.instance.ga(14),this.BD));return G}DTf(a,b,c){a=yd.SelectionFactory.sj(a,!1);if(!a)return null;a=a.Ye;return Bb.SelectionEditor.Sg(a)?this.vWi(a,b,c):null}bie(a){return ta.a.V8(a)}f2d(a,b,c,h){Te.a.mark(4666);const m=a.node,y=this.Y4d(a).LCID,G=Ob.ParagraphReader.text(m);0>b&&(b=a.Qa);if(c&&!this.Lhe(ta.a.charAt(G,b))||this.bie(G.substring(ta.a.EFa(G,b)+1,b)))return Te.a.mark(4667),
null;a=-1;c=Ib.HyperlinkReader.S4b(m);for(var U=0;U<c.length;U++)if(b>c[U].Nb)a=c[U].Nb;else{if(b>c[U].Qa)return null;break}c=0;U=b;let ja=null;do{U=U?this.$Oc(G,U-1):-1;U<a&&(U=a-1);const Ta=ta.a.substring(G,U+1,b);++c;var va=this.ZTf(Ta,y,h==z.a.dMa?".":null);if(va)this.QR.mib&&(ja=Cs.dC(m,U+1,b,va,this.Zg));else for(va=0;va<this.k4a.length;++va){const fb=this.k4a[va];if(!(fb.flags&1&&!(0>U)||fb.flags&4&&h!==z.a.tq||fb.flags&2&&h!==z.a.mP)){const Db=fb.pattern.exec(Ta);if(Db){ja=fb.koj(m,U+1,b,
Db,this.Zg,this.Ca);if(ja.commandId!==D.a.NYb&&!this.QR.mib||ja.commandId===D.a.NYb&&!this.QR.Qnc)ja=null;break}}}}while(0<=U&&U>=a&&!ja&&c<Om.NXg);Te.a.mark(4667);return ja}CTf(a,b,c){a=yd.SelectionFactory.sj(a,!1);if(!a)return null;a=a.Ye;return Bb.SelectionEditor.Sg(a)?this.f2d(a,b,!1,c):null}JTf(a,b){a=yd.SelectionFactory.sj(a,!1);if(!a)return null;a=a.Ye;if(!Bb.SelectionEditor.Sg(a)||Ib.HyperlinkReader.Fka(a,!1))return null;var c=Ob.ParagraphReader.text(a.node);const h=0<b?ta.a.EFa(c,b-1)+1:
ta.a.EFa(c,c.length-1)+1;b=0<b?b:c.length;c=ta.a.substring(c,h,b);return!c||this.Dbf&&!Ib.HyperlinkReader.jle(c)||!ta.a.V8(c)&&!ta.a.R8b(c)||!Om.hyperlinkEditor.tSk(a,h,b)?null:this.ryc.TCi(a.node,h,b)}NTf(a,b){var c=yd.SelectionFactory.sj(a,!1);if(!c)return null;var h=c.Ye;if(!Bb.SelectionEditor.Sg(h))return null;0>b&&(b=h.Qa);var m=Ob.ParagraphReader.text(h.node);c=this.fUf(m,b);const y=Om.KQd.length;for(let G=0;G<y;++G){const U=m.lastIndexOf(ta.a.charAt(Om.KQd,G),b-1);U>c&&(c=U+1)}m=ta.a.substring(m,
c,b);if(!m)return null;h=this.Y4d(h).LCID;return(new Jr(m,h)).nPj()?Bp.dC(a,c,b,this.Zg):null}BTf(a,b){var c=yd.SelectionFactory.sj(a,!1);if(!c)return null;c=c.Ye;if(!Bb.SelectionEditor.Sg(c))return null;0>b&&(b=c.Qa);var h=Ob.ParagraphReader.text(c.node);c=this.fUf(h,b);h=ta.a.substring(h,c,b);return h?(h=(new lq(h)).KZi())?EA.dC(a,c,b,h,this.Zg):null:null}eXi(a,b,c,h,m){var y=yd.SelectionFactory.sj(a,!1);if(!y)return null;y=y.Ye;if(c>b||!Bb.SelectionEditor.Sg(y))return null;0>b&&(b=y.Qa);if(0>b)return null;
y=Ob.ParagraphReader.text(y.node);return Uw.dC(a,c,m,b?y.charAt(b-1):"\x00",this.Zg,h)}ABa(a,b,c,h){Array.add(this.k4a,new CF("^"+a+"$",b,c,h))}tCe(a){if(this.umb[this.Upa]){const b=this.umb[this.Upa];for(let c in a)b[c]=a[c]}else this.umb[this.Upa]=a}uCe(a){this.FPb[this.Upa]?Array.addRange(this.FPb[this.Upa],a):this.FPb[this.Upa]=a}uQe(){this.Upa=-1}IQd(){this.zQi(this.Upa);this.Upa=-1}UYj(a,b){this.rwd[b]||(this.rwd[b]=!0,this.Upa=b,b=document.createElement("script"),b.type="text/javascript",b.src=
a,b.setAttribute("onload","ResetListLcid();"),b.setAttribute("onerror","AutoCorrectRulesFallbackLogic();"),document.body.appendChild(b))}zQi(a){a=lj.q_f(a);0<a&&this.G2b(a)}dZj(){J.a.instance.ga(70)&&(this.G2b(1033),this.ABa("=rand\\((?:(\\d+)(?:, ?(\\d+))?)?\\)",tl.aQ,tl.dC,5),this.ABa("(\\d+)[\\.|\\)]",Tw.aQ,Tw.dC,3),this.ABa("(L|l|C|c|D|d|M|m){1}\\.",Bs.aQ,Bs.dC,3),this.ABa("^M{0,4}(CM|CD|D?C{0,3})(XC|XL|L?X{0,3})(IX|IV|V?I{0,3})\\.",dn.aQ,dn.dC,11),this.ABa("([A-Za-z]){1}[\\.|\\)]",Bs.aQ,Bs.dC,
3),this.ABa("\\*{1}$|^\\-{1,2}$|^>{1}$|^<>",Mo.aQ,Mo.dC,3),this.ABa("[\\w\\d]+( ?\\-{1,2} ?)[\\w\\d]+",Sw.aQ,Sw.dC,0),this.ixc&&(this.ABa("(?:.*)([\\:\\;\\=][\\'\\-]??[DOPSX3>\\(\\)\\*#\\|\\[\\/])",Kt.aQ,Kt.dC,0),this.ABa("(?:.*)([\\@\\*\\$][\\-][\\@\\*\\$])",Kt.aQ,Kt.dC,0)))}G2b(a){this.rwd[a]||this.UYj(ty.a.Yhi(String.format("Acl/Acl{0}.js",a)),a)}static get hyperlinkEditor(){return Om.yn||(Om.yn=vb.a.instance.resolve("Box4.IHyperlinkEditor"))}}Om.zQd=" ,;:()[]{}<>\"'-~`@#$%^&*_+=|\u00a9\u00ae\u2122\ufffc\uc2a0\u2013\u2014";
Om.KQd=" ,;:()[]{}<>\"'-~`@#$%^&*_+=|\u00a9\u00ae\u2122\ufffc\uc2a0\u2013\u2014/\\.!?\"'";Om.KSe=".!?";Om.NXg=5;Om.yn=null;Object(n.a)(Om,"AutoCorrectRules",null,[1013]);class FA{constructor(a,b,c,h,m,y){this.Xpa=this.mF=null;this.fK=a;this.Tc=b;this.ld=c;this.b6e=h.ka("AutoCorrectFirstLetterUpperCaseEnabled");this.e6e=h.ka("AutoFormatOrdinalNumberAndFractionsEnabled");this.r2=h.ka("ReplaceQuoteWithSmartQuoteIsEnabled");this.Cba=m;this.Dza=!!y;this.Us=y;this.CYh=new Ct.a;this.Dza&&this.Tc.GG(Object(F.a)(this,
this.FGb,"onSetSelectionFinished"))}gtc(a,b,c=-1){if(this.Cba.mib||this.Cba.Qnc)if(b=this.fK.JTf(a,c)||this.fK.CTf(a,c,b))this.mF||(this.mF=new nf),this.mF.ya(b);this.b6e&&this.Cba.sIc&&(b=this.fK.DTf(a,c," "))&&(this.mF||(this.mF=new nf),0<this.mF.IFa&&(this.mF.Xsa(0).ex=!0,b.MFb=!1),this.mF.ya(b));this.e6e&&(this.Cba.Bkd&&4!==Fc.App.mode&&(b=this.fK.NTf(a,c))&&(this.mF||(this.mF=new nf),this.mF.ya(b),ba.ULS.sendTraceTag(8271383,324,50,"Ordinal number autoformat action is created.")),this.Cba.zkd&&
(a=this.fK.BTf(a,c))&&(this.mF||(this.mF=new nf),this.mF.ya(a),ba.ULS.sendTraceTag(8271384,324,50,"Fractions autoformat action is created.")))}pHf(a,b,c,h,m,y){const G=new nf;if(0<b){if(!this.b6e&&this.Cba.mib){var U=this.fK.zWi(c,h,m,y);U&&G.ya(U)}else{if(this.Cba.mib||this.Cba.Qnc)if(U=0," "===y?U=z.a.mP:"."===y&&(U=z.a.dMa),U=this.fK.CTf(a,b,U))U.ex=!0,G.ya(U);this.Cba.sIc&&(U=this.fK.DTf(a,b,y))&&(0<G.IFa&&(U.MFb=!1),G.ya(U))}this.e6e&&(this.Cba.Bkd&&4!==Fc.App.mode&&(U=this.fK.NTf(a,b))&&(G.ya(U),
ba.ULS.sendTraceTag(8704786,324,50,"Ordinal number autoformat action is created.")),this.Cba.zkd&&(U=this.fK.BTf(a,b))&&(G.ya(U),ba.ULS.sendTraceTag(8271385,324,50,"Fractions autoformat action is created.")))}0<=b&&("'"===y||'"'===y)&&this.r2&&this.Cba.QPe&&(U=this.fK.eXi(a,b,c,h,y))&&(G.ya(U),ba.ULS.sendTraceTag(37363807,324,50,"Smart quote action is created."));for(let ja of this.CYh.values)if((U=ja.pHf(a,b,c,h,m,y))&&!U.isEmpty())for(let va=0;va<U.IFa;va++)G.ya(U.Xsa(va));return G}RBe(a,b){return this.fK.JTf(a,
b)}gnh(a){this.mF||(this.mF=new nf);this.mF.ya(a)}xGj(a){if(this.mF){var b=!1;for(var c=0;c<this.mF.IFa;c++){var h=this.mF.Xsa(c);if(!h)return;if(!h.mgg){b=!0;break}}if(b){b=this.Xpa=null;c=new t.GraphTransaction(15);c.jd=a;a=!1;for(h=0;h<this.mF.IFa;h++){let m=this.mF.Xsa(h);if(!m)return;if(m.mgg)continue;this.Dza&&m.ex&&m.flg&&(b=m);a||(a=!0,c.kd(m.y7f));m.mb=this.Tc.Pa.mb;const y=this.ld.Vp(m.commandId);m.invoke();y.end();this.Tc.setSelection(m.mb)}this.mF=null;this.Xpa=b?b.commandId:null;a&&c.dispose()}}}yGj(a){this.Xpa=
null;const b=new t.GraphTransaction(15);b.kd(a.y7f);b.jd=a.commandId;a.mb=this.Tc.Pa.mb;const c=this.ld.Vp(a.commandId);a.invoke();c.end();this.Tc.setSelection(a.mb);this.Dza&&a.ex&&a.flg&&(this.Xpa=a.commandId);b.dispose()}zGj(a){this.Xpa=null;return a.invoke()}bxj(){return this.Dza&&!!this.Xpa}pmk(a){if(!this.Dza||!this.Xpa)return!1;const b=this.Xpa;this.Xpa=null;if(!a||!this.Us.LW||this.Us.PXd!==b)return!1;this.Us.undo();return!0}FGb(){this.Xpa=null}}Object(n.a)(FA,"AutoCorrectScheduler",null,
[590]);class Kr extends Tn{constructor(a,b,c,h,m,y){super(a,b,c,h,m);this.jjf=this.i2=null;this.uV=m;this.fd=y}get L8(){return this.i2||(this.i2=vb.a.instance.rb("Box4.IInternalLinkManager"))}get S$g(){return this.jjf||(this.jjf=vb.a.instance.rb("Box4.AutoCorrect.IPostHyperlinkAutoCorrectStrategy"))}get ex(){return!0}get commandId(){return D.a.CQd}a8(a){Te.a.mark(7012);const b=new t.GraphTransaction(15);b.kd(a);var c=this.kA,h=this.qR,m=Ob.ParagraphReader.text(a),y=m.substring(c,h);const G=({Iic:U}=
ta.a.DYe(y)).returnValue;y!==G&&(c+=U,h=c+G.length);y=md.a.createTextRange(a,c,h);var U=m.substring(c,h);Kr.jNj(m,c,h)&&(this.uV.replaceTextRange(md.a.createTextRange(a,c-1,h+1),U,!0,!1),--c,--h,y=md.a.createTextRange(a,c,h),c=yd.SelectionFactory.Qg(a,h),me.a.instance.setSelection(c));c=Ib.HyperlinkReader.ZDa(U);Kr.hyperlinkEditor.Zia(y,c,!1);m=U="";h=!1;this.L8&&({wgh:U,$Zi:m}=this.L8.MCh(c,!0)).returnValue&&(c=U,h=!0,U=Ib.HyperlinkReader.hC(y,!1),Kr.hyperlinkEditor.sM(U[0].paragraph,U[0].hyperlink),
""!==m&&(this.uV.replaceTextRange(y,m,!0,!1),y=md.a.createTextRange(a,this.kA,this.kA+m.length),a=yd.SelectionFactory.Qg(a,this.kA+this.kA+m.length),me.a.instance.setSelection(a)),Kr.hyperlinkEditor.Zia(y,c,!1));b.dispose();!h&&this.S$g&&this.S$g.kIl(y,c);Te.a.mark(7013)}set ex(a){super.ex=a}static get hyperlinkEditor(){return Kr.yn||(Kr.yn=vb.a.instance.resolve("Box4.IHyperlinkEditor"))}static jNj(a,b,c){c=c!==a.length&&('"'===a.charAt(c)||"\u201d"===a.charAt(c));return!!b&&('"'===a.charAt(b-1)||
"\u201c"===a.charAt(b-1))&&c}}Kr.yn=null;Object(n.a)(Kr,"HyperlinkAction",Tn,[]);class GA{constructor(a,b){this.Zg=a;this.fd=b}TCi(a,b,c){return new Kr(null,a,b,c,this.Zg,this.fd)}}Object(n.a)(GA,"Factory",null,[589]);class HA{constructor(){this.Da=null}get name(){return"Box4.AutoCorrect"}$b(a){this.Da=a;a.register(Om,"Box4.AutoCorrect.AutoCorrectRules").as("Box4.IAutoCorrectRules").ma().oa(()=>new Om(a.resolve("Box4.IHyperlinkActionFactory"),a.resolve("Box4.ICharacterPropertiesEditor"),Dc.a.instance,
u.AFrameworkApplication.Ta,u.AFrameworkApplication.fa,a.resolve("Box4.IAutoCorrectOptionsInfo"),a.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance));a.register(DA,"Box4.AutoCorrect.AutoCorrectOptionsInfo").as("Box4.IAutoCorrectOptionsInfo").ma().oa(()=>new DA(a.resolve("Box4.IRoamingServiceRequestManager"),u.AFrameworkApplication.fa.ka("ReplaceQuoteWithSmartQuoteIsEnabled")));a.register(FA,"Box4.AutoCorrect.AutoCorrectScheduler").as("Box4.IAutoCorrectScheduler").ma().oa(()=>new FA(a.resolve("Box4.IAutoCorrectRules"),
me.a.instance,ec.a.instance,u.AFrameworkApplication.fa,a.resolve("Box4.IAutoCorrectOptionsInfo"),u.AFrameworkApplication.fa.ka("AutoCorrectUndoByBackspaceIsEnabled")?a.resolve("Box4.IUndoManager"):null));a.register(GA,"Box4.AutoCorrect.HyperlinkAction.Factory").as("Box4.IHyperlinkActionFactory").ma().oa(()=>new GA(a.resolve("Box4.ICharacterPropertiesEditor"),a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance))}init(){this.Da.resolve("Box4.IAutoCorrectRules").dZj();const a=u.AFrameworkApplication.fa;
a.ka("AutoCorrectOptionSettingIsEnabledForWordOnline")&&a.ka("IsRoamingServiceEnabled")&&this.Da.resolve("Box4.IAutoCorrectOptionsInfo").p2i()}dispose(){}static main(){r.a.instance.Dc(new HA)}}Object(n.a)(HA,"Box4AutoCorrectPackage",null,[2,3]);class IA{get name(){return"Box4.Clipboard"}init(){}dispose(){}$b(){}static main(){r.a.instance.Dc(new IA)}}Object(n.a)(IA,"Box4ClipboardPackage",null,[2,3]);var JA=d(576),Vw=d(490),No=d(324);class Lr{}Lr.fontSize=0;Lr.bold=!1;Lr.italic=!1;Lr.spacing=0;Object(n.a)(Lr,
"DefaultTextCharPropertyBag",null,[]);class KA{constructor(a,b,c,h,m,y,G,U){this.h2c=[kb.a.fontColor,X.a.ivb];this.j7c=[kb.a.Ri,kb.a.font,X.a.autonumberBulletType,kb.a.iVa,xc.a.gVa];this.p9j=[new Vw.a(X.a.gX,X.a.ox),new Vw.a(X.a.Xka,X.a.Kda),new Vw.a(X.a.Wka,X.a.Jda)];this.Gva=a;this.gJ=b;this.Bec=c;this.ki=h;this.rWa=m;this.FWa=y;this.Pb=G;this.Ea=U}qsb(a){return this.MSd(a,-1)}iIc(a){return this.MSd(a,1)}MSd(a,b){return rb.GraphIterator.Hca(()=>this.FWa?Kd.OutlineElementReader.Wg(a)&&!a.R6b(14)&&
a.R6b(12)&&!this.YMj(a)&&this.$Af(a,b):Wb.ListReader.tk(a)&&this.$Af(a,b))}YMj(a){return(a=this.Ea.Zm(a.currentNode))?a.V3:!1}$Af(a,b){return rb.GraphIterator.Hca(()=>{const c=a.currentNode.sa(jb.a.listLevel,Vg.a.zEa)+b;if(0>c||c>=No.a.K7||!this.gJ.nQ(a,c))return!1;this.FWa||(mc.OutlineElementNavigator.wi(a),mc.OutlineElementNavigator.Oe(a));return!0})}uhb(a,b){this.K7g(a,b)}eMc(a,b){this.K7g(a,b)}K7g(a,b){if(this.MSd(a,b)&&(this.FWa||Wb.ListReader.tk(a))){var c=a.Bb(2);a.zc();(new rb.GraphIterator).Rc(a);
const h=a.currentNode.sa(jb.a.listLevel,Vg.a.zEa);(0>h||h>=No.a.K7)&&Ba.a.J(8959444,820,10,"OutlineElementIndentationEditor::OutlineElementPromoteDemote - level-{0} is out of bounds",h);(0>h+b||h+b>=No.a.K7)&&Ba.a.J(8959447,820,10,"OutlineElementIndentationEditor::OutlineElementPromoteDemote - level-{0} + depth-{1} is out of bounds",h,b);const m=this.gJ.nQ(a,h),y=this.gJ.nQ(a,h+b);if(m&&y){a.currentNode.setValue(jb.a.listLevel,h+b);c.setValue(jb.a.listLevel,h+b);for(b=0;b<c.Ra.length;b++)c.Ra.ga(b).formatting&&
c.Ra.ga(b).formatting.pge();this.mbi(c,m,y);this.ebi(c,m,y);this.jbi(c,m,y);c=a.Bb(4);a.zc();c&&this.Zai(c,m,y)}}}ebi(a,b,c){b=c.sa(kb.a.fontSize,Lr.fontSize)-b.sa(kb.a.fontSize,Lr.fontSize);a.Sa(kb.a.fontSize)&&a.setValue(kb.a.fontSize,a.eb(kb.a.fontSize)+b);for(c=0;c<a.Ra.length;++c){const h=a.Ra.ga(c);h||Ba.a.J(8959450,820,10,"OutlineElementIndentationEditor::AdjustFontSizeBasedOnIndentLevel - paraNode.CharacterProperties[{0}] is null",c);h&&h.formatting&&h.formatting.Pz&&h.formatting.Pz.Sa(kb.a.fontSize)&&
this.ki.ir(h.formatting,h.formatting.Pz.eb(kb.a.fontSize)+b)}this.rWa&&this.rWa.Sa(kb.a.fontSize)&&(a=this.rWa.fontSize(),this.rWa.ir(a+b))}mbi(a,b,c){if(a.Sa(jb.a.Zl)){var h=a.eb(jb.a.Zl);let m=b.sa(jb.a.Zl,Vg.a.leftMargin),y=c.sa(jb.a.Zl,Vg.a.leftMargin);const G=this.Ea.Zm(a);G&&!G.ud&&(m=b.sa(X.a.r1b,Vg.a.leftMargin),y=c.sa(X.a.r1b,Vg.a.leftMargin));h=h+y-m;0>h&&a.setValue(jb.a.$n,a.sa(jb.a.$n,Vg.a.indent)+h);this.Gva.uv.Cnd(a,1,h)}this.uOc(a,b,jb.a.$n)&&this.dWc(a,c,jb.a.$n)}jbi(a,b,c){for(const h of this.p9j)this.uOc(a,
b,h.first,h.second)&&this.dWc(a,c,h.first,h.second)}Zai(a,b,c){if(this.uOc(a,b,kb.a.Ri,kb.a.font)){if(0===this.Bec.pwb(a)&&a.sa(X.a.autonumberBulletType,8)!==b.sa(X.a.autonumberBulletType,8))return;if(c.sa(kb.a.Ri,null))this.Bec.i_b(a),a.ao.apply(a,this.j7c),this.dWc.apply(this,[a,c].concat(this.j7c));else{const h=this.Pb.Nc(a);h.rc(11);h.Mi()}}for(const h of this.h2c)this.uOc(a,b,h)&&(a.removeProperty(h),this.dWc(a,c,h))}uOc(a,b,...c){for(const h of c)if(a.Sa(h)||b.Sa(h))if(!a.Sa(h)||!b.Sa(h)||!JA.APropertySet.nZa(h.type,
a.Lh(h),b.Lh(h)))return!1;return!0}dWc(a,b,...c){for(const h of c)b.Sa(h)&&a.te(h,b.Lh(h))}}Object(n.a)(KA,"OutlineElementIndentationEditor",null,[1020]);var vy=d(151);class gp{constructor(a,b){this.$o=this.fd=this.Bt=null;this.Xo=b;gp.Ug=a}get eq(){return this.Xo.value}get insertionPointFormatting(){return this.Bt||(this.Bt=vb.a.instance.rb("Box4.IInsertionPointFormatting"))}get Tf(){return this.fd||(this.fd=vb.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}get p6(){return this.$o||
(this.$o=vb.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}a9d(a){const b=a.node;var c=this.insertionPointFormatting?this.insertionPointFormatting.tYf():null;if(c&&!c.equals(pa.a.nil)){a=b.Fh;if(!a)return null;c=a.ye(c);if(!c||c&&1!==Ya.StyleReader.tta(c))return null}else c=uc.a.ps(a),c=uc.a.Kvb(c);return c}paa(a,b,c){if(Ob.ParagraphReader.Yd(b))if(a)if(Ya.StyleReader.J_c(a))if(2!==Ya.StyleReader.tta(a))ba.ULS.shipAssertTag(7467991,324,!1);else{var h=Ya.StyleReader.iL(b);
if(h){var m=Ya.StyleReader.tQ(a);if(!m)ba.ULS.shipAssertTag(7467993,324,!1);else if(h.WG(m)){m=null;this.Tf.hg&&b.s8();c||(m=this.eq.fMk(m),gp.paragraphEditor.j_b(b,!0));this.Ftc(b,h);J.a.instance.ga(61)||(a=h.WG(Ya.StyleReader.tQ(a)));b.properties.setValue(Ie.a.paragraphStyle,a.id);b.aV=a;for(c=0;c<b.Ra.length;c++)b.Ra.ga(c).formatting&&b.Ra.ga(c).formatting.pge();gp.n1c.V1b(a)&&(m||(m=new rb.GraphIterator,m.set(b),m.gf(),mc.OutlineElementNavigator.Oe(m)),Wb.ListReader.tk(m)||(b.ao(jb.a.Zl,jb.a.hxa,
jb.a.$n,jb.a.cJa,jb.a.tkc,jb.a.n8g),this.APd(m,a)))}}else ba.ULS.shipAssertTag(7467992,324,!1)}else ba.ULS.shipAssertTag(7467990,324,!1);else ba.ULS.shipAssertTag(7467989,324,!1);else ba.ULS.shipAssertTag(7467988,324,!1)}APd(){}$Ic(a,b=!1){let c;c=Je.c(a)?Je.d(a)?Ya.StyleReader.iL(a).WG(Ya.StyleReader.vqd):Ya.StyleReader.iL(a).WG(Ya.StyleReader.xqd):Ya.StyleReader.iL(a).WG(J.a.instance.ga(61)?Ya.StyleReader.iMa:Ya.StyleReader.Hoa);this.paa(c,a,b)}tUe(a,b){const c=Ya.StyleReader.iL(b);c&&c.WG(Ya.StyleReader.tQ(a))&&
(this.Ftc(b,c),this.insertionPointFormatting&&(this.insertionPointFormatting.ZZa(),this.insertionPointFormatting.Pfa(a,b)))}Ftc(a,b){return(a=gp.Yl.LFb(a))?b.L9k(a):!1}static get paragraphEditor(){return gp.Rw||(gp.Rw=vb.a.instance.resolve("Box4.IParagraphEditor"))}static set paragraphEditor(a){gp.Rw=a}static get n1c(){return gp.Ug||(gp.Ug=vb.a.instance.resolve("Box4.List.IListReader"))}static get Yl(){return vy.PageNavigator.instance}}gp.Rw=null;gp.Ug=null;Object(n.a)(gp,"StyleEditor",null,[1019]);
class Uq{static h$d(){return Uq.s3j}static ORf(a){return new pa.a(a,1)}static GGf(a){a=a.toString();a=a.split("-")[0]+"-0000-0000-0000-000000000000";return Eh.a.Hf(a)}}Uq.s3j=[X.a.ixa,X.a.cellId,X.a.rowId,X.a.shapeId];Object(n.a)(Uq,"TransformHelper",null,[]);class LA{constructor(a,b){this.f2c=new gp(a,b);this.eA=a;this.gJ=b.value}a9d(a){return this.f2c.a9d(a)}tUe(a,b){this.f2c.tUe(a,b)}paa(a,b){const c=new rb.GraphIterator;c.set(b);c.Xu();c.zc();nm.d(a,c.currentNode,[jb.a.listLevel]);nm.d(a,b,[kb.a.Il,
kb.a.XI,jb.a.$n,jb.a.Zl,X.a.ox,X.a.gX,X.a.Xka,X.a.Kda,X.a.Wka,X.a.Jda]);if(this.eA.V1b(a)&&!Wb.ListReader.tk(c)){a=Pe.a.wCa(a,a);const h=Pe.a.pN(a.listType,a.listStyle);h.qA=a.qA;a.propertySet.Sa(kb.a.Ri)&&h.propertySet.setValue(kb.a.Ri,a.propertySet.eb(kb.a.Ri));a.propertySet.Sa(kb.a.font)&&h.propertySet.setValue(kb.a.font,a.propertySet.eb(kb.a.font));a.propertySet.Sa(X.a.autonumberBulletType)&&h.propertySet.setValue(X.a.autonumberBulletType,a.propertySet.eb(X.a.autonumberBulletType));this.gJ.xPa(c,
h,!1,!1,0);a=c.Bb(4);nm.b(b,a,Uq.h$d());c.zc()}}$Ic(a,b=!1){this.f2c.$Ic(a,b)}Ftc(a,b){return this.f2c.Ftc(a,b)}}Object(n.a)(LA,"StyleEditor",null,[1019]);class MA{constructor(a){this.hxg=a;this.hxg.gra(Object(F.a)(this,this.zYa,"onBeforeValidatePersistence"))}dispose(){this.hxg.Gnc(Object(F.a)(this,this.zYa,"onBeforeValidatePersistence"))}zYa(a,b){10!==b.node.type&&60!==b.node.type||b.node.jGh()}}Object(n.a)(MA,"LockableGraphNodeEditBehavior",null,[106]);class NA{constructor(){}dTi(a){const b=a.parentNode.eb(X.a.shapeId),
c=a.parentNode.eb(X.a.ixa);let h=null,m=null;const y=Object(ua.a)(5,a.currentNode);y&&y.ys()&&(h=a.parentNode.eb(X.a.rowId),m=a.parentNode.eb(X.a.cellId));this.bUe(a.currentNode,b,c,h,m)}bUe(a,b,c,h,m){a.te(X.a.shapeId,b);a.te(X.a.ixa,c);m&&(a.te(X.a.rowId,h),a.te(X.a.cellId,m))}}Object(n.a)(NA,"PptCreateParagraphStrategy",null,[588]);var lP=d(29);class OA{constructor(a){this.Xt=a;this.Xt.gra(Object(F.a)(this,this.zYa,"onBeforeValidatePersistence"))}dispose(){this.Xt.Gnc(Object(F.a)(this,this.zYa,
"onBeforeValidatePersistence"))}zYa(a,b){Nc.a.Ib&&(a=Nc.a.Ib,a.Qr&&Nc.a.zfa(Nc.a.Ib),b.revisionId&&(b=Nc.a.D9a(b.revisionId.toString()),"ReplicateOutbound"===a.actionName?ba.ULS.sendTraceTag(41714057,305,50,"Refuse to override RevisionId for ReplicateOutbound. RevisionId={0}; StackTrace={1}",b.toString(),lP.Debug.Ot()):a.GB(li.a.zY,b.toString())))}}Object(n.a)(OA,"PresentationNodeEditBehavior",null,[106]);class PA{gpc(a,b,c){let h;({value:h}=a.Uf(b)).returnValue||(h=new Qa.a,a.$(b,h));h.add(c)}Osd(a,
b,c,h){if(a.count)for(let m of a)m&&m!==pa.a.nil&&(a=b.ESc(m,pa.a.nil),a=h.ga(a))&&(b.$(m,a),this.gpc(c,a,m))}Lsd(a,b,c){a.Hb(b)&&pa.a.SP(a.ga(b),c)&&a.remove(b)}}Object(n.a)(PA,"GraphHotColdHelper",null,[587]);var Mr=d(204),wy;(function(a){a[a.presentation=0]="presentation";a[a.slide=1]="slide";a[a.slideChildren=2]="slideChildren";a[a.shapeLevel=3]="shapeLevel"})(wy||(wy={}));Object(n.b)("GraphNodeModificationType",wy);class DF{constructor(a,b,c,h,m,y){this.dXa=a;this.xma=b;this.uma=c;this.mU=h;
this.$Q=m;this.Dma=y;this.xfc=pa.a.nil}gG(a){return!!a&&(7===a.type||68===a.type)}mjc(a,b){this.dXa.$(a.id,b);this.Dma.xDe(b)?this.xfc=a.id:this.$Q.gpc(this.mU,b,a.id)}e3e(a){if(this.xfc&&this.xfc!==pa.a.nil){let b;this.$Q.Osd((b=new Qa.a,b.add(this.xfc),b),this.dXa,this.mU,a);this.xfc=pa.a.nil}}DGb(a,b){this.$Q.Lsd(this.dXa,a,b)}Xta(a){return this.dXa.Hb(a.id)}SW(a){return this.Xta(a)||0<this.xma.count||0<this.uma.count}}Object(n.a)(DF,"PresentationHotColdHandler",null,[610,585]);class EF extends Sys.EventArgs{constructor(a,
b){super();this.revisionId=a;this.node=b}}Object(n.a)(EF,"RevisionPersistArgs",Sys.EventArgs,[]);var FF=d(895);class GF{constructor(a,b,c,h,m,y,G){this.jwa=a;this.uma=b;this.mU=c;this.$Q=h;this.Dma=m;this.jc=y;this.Ea=G;this.h8c=new Qa.a;this.yHa=new Qa.a}gG(a){return!!a&&(10===a.type||60===a.type||39===a.type)}mjc(a,b){let c=a;const h=this.jc.mg(a);60!==a.type&&39!==a.type&&(c=this.Ea.Zm(a));h&&c&&(this.uma.$(c.id,b),this.jwa.$(h.id,b),this.Dma.xDe(b)?(this.h8c.contains(c.id)||this.h8c.add(c.id),
this.yHa.contains(h.id)||this.yHa.add(h.id)):(this.$Q.gpc(this.mU,b,c.id),this.$Q.gpc(this.mU,b,h.id)))}e3e(a){this.$Q.Osd(this.h8c,this.uma,this.mU,a);this.$Q.Osd(this.yHa,this.jwa,this.mU,a);this.h8c.clear();this.yHa.clear()}DGb(a,b){this.$Q.Lsd(this.uma,a,b);this.$Q.Lsd(this.jwa,a,b)}Xta(a){return this.gG(a)&&this.uma.Hb(a.id)}SW(a){return this.Xta(a)}}Object(n.a)(GF,"ShapeLevelHotColdHandler",null,[610,585]);class HF{constructor(a,b,c,h,m){this.xma=a;this.jwa=b;this.mU=c;this.$Q=h;this.Dma=m;
this.yHa=new Qa.a}gG(a){return!!a&&8===a.type}mjc(a,b){this.xma.$(a.id,b);this.Dma.xDe(b)&&!this.yHa.contains(a.id)?this.yHa.add(a.id):this.$Q.gpc(this.mU,b,a.id)}e3e(a){this.$Q.Osd(this.yHa,this.xma,this.mU,a);this.yHa.clear()}DGb(a,b){this.$Q.Lsd(this.xma,a,b)}Xta(a){return this.xma.Hb(a.id)}SW(a){return this.Xta(a)||this.QIj(a)}QIj(a){return this.jwa.Hb(a.id)}}Object(n.a)(HF,"SlideHotColdHandler",null,[610,585]);class xy{constructor(a,b,c,h,m,y,G,U,ja,va=null,Ta=null,fb=null){this.Bl=this.mU=this.uma=
this.jwa=this.xma=this.dXa=null;this.jc=a;this.Ea=b;this.Oc=c;this.zs=h;this.$Q=m;this.Xt=y;this.Rxe=!1;this.d0=G;this.ua=U;this.Dma=ja;this.zs.VFc(Object(F.a)(this,this.Ved,"onRevisionProcessedOnServerHandler"));this.zs.vai(Object(F.a)(this,this.Sdd,"onGraphNodePersistHandler"));this.Xt.gra(Object(F.a)(this,this.Sdd,"onGraphNodePersistHandler"));this.Oc.GA(Object(F.a)(this,this.vB,"onSessionEnd"));this.Oc.j8h(Object(F.a)(this,this.O2g,"onFailoverHandler"));this.Oc.WB(Object(F.a)(this,this.Bo,"onSessionRehydrated"));
this.initialize(va,Ta,fb);this.iWa=new Nd.a}reset(){this.initialize();this.zs.Xdh(new FF.a(null));this.bEh()}initialize(a=null,b=null,c=null){a||this.gbj();this.mU=b||new Nd.a;this.Bl=c||this.Lja()}O2g(){this.reset()}Ved(a,b){b&&(a=b.faa)&&this.OGe(a)}Sdd(a,b){this.mjc(b.node,b.revisionId)}mjc(a,b){if(!this.Rxe&&(a.isDirty||10===a.type||60===a.type||39===a.type))for(const c of this.Bl)if(c.gG(a)){c.mjc(a,b);this.zs.HIk(new EF(b,a));break}}OGe(a){const b=pa.a.Hf(a.Id),c=this.mU.ga(b);if(c&&c.count){for(let h of c)for(const m of this.Bl)m.DGb(h,
b);this.mU.remove(b);this.zs.Xdh(new FF.a(a));this.bEh()}}iOi(){const a={},b=xy.jEj(a);b(0,this.dXa);b(1,this.xma);b(2,this.jwa);b(3,this.uma);Da.a.isEmpty(a)||Ba.a.J(21112097,811,50,Da.a.toJSON(a))}SW(a){for(const b of this.Bl)if(b.gG(a))return b.SW(a);return!1}Xta(a){for(const b of this.Bl)if(b.gG(a))return b.Xta(a);return!1}iHh(a){if(0<a.count)for(const b of this.Bl)b.e3e(a)}dispose(){this.Oc.baa(Object(F.a)(this,this.vB,"onSessionEnd"));this.Oc.hTk(Object(F.a)(this,this.O2g,"onFailoverHandler"));
this.Xt.Gnc(Object(F.a)(this,this.Sdd,"onGraphNodePersistHandler"));this.zs.kih(Object(F.a)(this,this.Ved,"onRevisionProcessedOnServerHandler"));this.zs.kVk(Object(F.a)(this,this.Sdd,"onGraphNodePersistHandler"));this.Oc.Dfa(Object(F.a)(this,this.Bo,"onSessionRehydrated"));this.iWa&&0<this.iWa.count&&Ba.a.J(22153251,822,15,String.format("Disposed with {0} listening node",this.iWa.count))}vB(){this.Rxe=!0;this.iOi();this.reset()}Bo(){this.ua.presentation.zQe();this.reset();this.Rxe=!1;this.d0.MJa(new Uc.a("SessionRehydrated"))}Lja(){return[new GF(this.jwa,
this.uma,this.mU,this.$Q,this.Dma,this.jc,this.Ea),new HF(this.xma,this.jwa,this.mU,this.$Q,this.Dma),new DF(this.dXa,this.xma,this.uma,this.mU,this.$Q,this.Dma)]}gbj(){this.dXa=new Nd.a;this.xma=new Nd.a;this.jwa=new Nd.a;this.uma=new Nd.a}N1b(a,b){var c=Object(ua.a)(583,a);c.Dta+=1;({value:c}=this.iWa.Uf(b.id)).returnValue||(c=new Qa.a,this.iWa.add(b.id,c));c.add(a)}bEh(){if(this.iWa.count&&this.ua.presentation&&this.ua.presentation.Fh){var a=this.ua.presentation.Fh;this.iWa.forEach((b,c)=>{if(!this.Xta(Object(ua.a)(9,
a.ye(b)))){for(let h of c)if(c=Object(ua.a)(583,h))--c.Dta,this.Yyb(c)&&(this.d0.MJa(new Uc.a("SessionRehydrated")),this.Fkd(h));this.iWa.remove(b)}return!0})}}Yyb(a){return a?!a.Dta&&!a.Aja:!1}Fkd(a){var b=Object(ua.a)(583,a);a&&b&&(b=+new Date-+b.Ria,12E4<b&&Ba.a.J(22153281,822,15,String.format("{0} been blocked {1}",a.type,b)))}static jEj(a){return(b,c)=>{c=Mr.b(c.values.toArray(),h=>h.toString());c.length&&(a[wy[b]]=c)}}}Object(n.a)(xy,"GraphHotColdManager",null,[584,585,106,586]);class QA{constructor(){this.K=
null}get name(){return"PowerPointWebEditor.GraphEditor"}$b(a){this.K=a;this.K.register(MA,"PowerPointWebEditor.GraphEditor.LockableGraphNodeEditBehavior").ma().oa(()=>new MA(this.K.resolve("Box4.Graph.IGraphInstance").eSa));this.K.register(OA,"PowerPointWebEditor.GraphEditor.PresentationNodeEditBehavior").ma().oa(()=>new OA(this.K.resolve("Box4.Graph.IGraphInstance").Ad(7)));this.K.register(KA,"PowerPointWebEditor.OutlineElementIndentationEditor").as("Box4.IOutlineElementIndentationEditor").oa(()=>
new KA(this.K.resolve("Box4.IParagraphEditor"),this.K.resolve("PowerPointWebEditor.IPptListEditor"),this.K.resolve("PowerPointWebEditor.IListInfoHelper"),this.K.resolve("Box4.IFormattingEditor"),this.K.resolve("Box4.IInsertionPointFormatting"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").isPromoteDemoteOnParagraphEnabled,this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.IShapeReader")));this.K.register(LA,"PowerPointWebEditor.StyleEditor").as("Box4.Styles.IStyleEditor").ma().oa(()=>
new LA(this.K.resolve("Box4.List.IListReader"),this.K.re("Box4.List.IListEditor")));this.K.register(PA,"PowerPointWebEditor.GraphHotColdHelper").as("PowerPointWebEditor.IGraphHotColdHelper").oa(()=>new PA);this.K.register(xy,"PowerPointWebEditor.GraphHotColdManager").as("PowerPointWebEditor.IGraphHotColdManager").as("PowerPointWebEditor.IGraphBlockContentHandler").ma().oa(()=>new xy(a.resolve("PowerPointWebEditor.ISlideReader"),a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),
a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventSource"),a.resolve("PowerPointWebEditor.IGraphHotColdHelper"),a.resolve("Box4.Graph.IGraphInstance").eSa,a.resolve("PowerPointWebEditor.IGraphActionBlockingEventNotifier"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.ITextEditingRevisionInfoReader")));this.K.register(NA,"PowerPointWebEditor.PptCreateParagraphStrategy").as("Box4.ICreateParagraphStrategy").ma().oa(()=>new NA(this.K.resolve("Box4.ITableCellReader")))}init(){this.K.resolve("PowerPointWebEditor.GraphEditor.LockableGraphNodeEditBehavior");
this.K.resolve("PowerPointWebEditor.GraphEditor.PresentationNodeEditBehavior");this.K.resolve("PowerPointWebEditor.IGraphHotColdManager");this.K.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager").addHandler(this.K.resolve("PowerPointWebEditor.IGraphBlockContentHandler"))}dispose(){this.K.resolve("PowerPointWebEditor.GraphEditor.LockableGraphNodeEditBehavior").dispose();this.K.resolve("PowerPointWebEditor.GraphEditor.PresentationNodeEditBehavior").dispose()}static main(){r.a.instance.Dc(new QA)}}
Object(n.a)(QA,"PPTWebEditorGraphEditorPackage",null,[2,3]);var mP=d(767),yy=d(769),nP=d(768),Vn=d(449);const IF=a=>{a.element.style.top=""};var ov=d(778);class JF{constructor(a,b,c){this.s7=!1;this.RMa=0;this.Sga=this.qif=null;this.sS=a;this.I0h=b;this.ho=c;this.wP=a.ownerDocument.createElement("div");this.htmlElement.className="WACBusinessBar";(this.k2=!!u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.hb.rFa)&&!this.ho.NMc&&Sys.UI.DomElement.addCssClass(this.htmlElement,"regionComposer");
this.htmlElement.id="WACBusinessBar";v.a.fg&&Sys.UI.DomElement.addCssClass(this.htmlElement,"FireFox")}get htmlElement(){return this.wP}get visible(){return this.s7}set_visible(a){if(this.s7!==a)return(this.s7=a)?this.vQd():this.A1b(),a}dispose(){this.visible&&this.A1b();La.a.aCa(this.htmlElement);this.sS=this.wP=null}Iuh(a,b){const c=a.htmlElement||a.createElement();b===this.htmlElement.childNodes.length?this.htmlElement.appendChild(c):this.htmlElement.insertBefore(c,this.htmlElement.childNodes[b]);
a.Akh();this.RMa+=a.htmlElement.clientHeight;var h=this.htmlElement.childNodes,m=a.Ztf,y=Object(F.a)(this,this.Klk,"onAfterShowEntry");Vn.WacAirSpace.z_a(c,"Shared_BasicClass");var G=new nP.a(c);G.hYb(0,1);const U=new yy.a(c);U.iYb(c.clientTop-30,c.clientTop);m?(Vn.WacAirSpace.kYa(G,null,null),Vn.WacAirSpace.kYa(U,null,y)):(Vn.WacAirSpace.animate(G,null,null),Vn.WacAirSpace.animate(U,null,y));for(b+=1;b<h.length;b++)y=h[b],Vn.WacAirSpace.z_a(y,"Shared_BasicClass"),G=new yy.a(y),G.iYb(y.clientTop-
c.clientHeight,y.clientTop),m?Vn.WacAirSpace.kYa(G,null,null):Vn.WacAirSpace.animate(G,null,null);a.Dfl();this.set_visible(!0)}L$f(a){const b=a.htmlElement;if(La.a.kUa(b)){this.RMa-=a.htmlElement.clientHeight;var c=b.parentNode.children;a=a.Ztf;var h=Object(F.a)(this,this.Flk,"onAfterHideEntry");Vn.WacAirSpace.z_a(b,"Shared_BasicClass");var m=new mP.a(b);m.hYb(1,0);a?Vn.WacAirSpace.kYa(m,null,h):Vn.WacAirSpace.animate(m,null,h);h=!1;for(m=0;m<c.length;m++){if(h){const y=c[m];Vn.WacAirSpace.z_a(y,
"Shared_BasicClass");const G=new yy.a(y);G.iYb(y.clientTop,-b.clientHeight);a?Vn.WacAirSpace.kYa(G,null,IF):Vn.WacAirSpace.animate(G,null,IF)}h||c[m]!==b||(h=!0)}}}Klk(a){a.element.style.top="";u.AFrameworkApplication.Aa.Mq()}Flk(a){a.element.parentNode.removeChild(a.element);this.htmlElement.hasChildNodes()||this.set_visible(!1);u.AFrameworkApplication.Aa.Mq()}vQd(){""===this.sS.style.top.trim()&&(this.sS.style.top=this.sS.offsetTop+"px");this.htmlElement.style.left=this.sS.style.left;this.htmlElement.style.top=
this.sS.style.top;this.htmlElement.style.height="auto";this.htmlElement.style.visibility="visible";var a=Sys.UI.DomElement.getBounds(this.htmlElement);this.qif=this.sS.style.top;this.RMa=a.height;this.Ktd();u.AFrameworkApplication.Aa.nia(Object(F.a)(this,this.onResize,"onResize"));wd.a.addHandler(this.htmlElement,ra.a.xmd,wd.a.ssb);this.Sga=Object(F.a)(this,this.bC,"contextMenuHandler");u.AFrameworkApplication.Aa.Aaa.pb(this.htmlElement,this.Sga,null);if(C.FocusManager.KM()){var b=C.FocusManager.instance();
a=b.Gc(ov.a.l6a);a.parent=A.AFrame.nj;const c=new Ho.DOMFocusListing(()=>this.htmlElement);c.Eo(1);c.Eo(2);c.Eo(8);b.Eia(()=>this.htmlElement,a,c);b=b.rQ(ov.a.l6a);b.$hb();b.kX=!0;b.rQa=!0;const h=u.AFrameworkApplication.Aa.Jw;a.D5a(()=>{h.Ho(ov.a.l6a)});h.Yqa(ov.a.l6a);(c.zja||u.AFrameworkApplication.fa.ka("ReactBusinessBarIsEnabled"))&&h.EK(ov.a.l6a)}}A1b(){this.luh()&&(this.sS.style.top=this.qif);this.htmlElement.style.visibility="hidden";u.AFrameworkApplication.Aa&&(C.FocusManager.KM()&&C.FocusManager.instance().wJb(ov.a.l6a),
this.Sga&&(u.AFrameworkApplication.Aa.Aaa.yb(this.htmlElement,this.Sga),this.Sga=null));wd.a.removeHandler(this.htmlElement,ra.a.xmd,wd.a.ssb)}Ktd(){if(this.luh()&&this.visible){var a=this.sS,b=this.RMa+this.I0h;const c=La.a.oM(a.style.top);Vn.WacAirSpace.z_a(a,"Shared_BasicClass");a=new yy.a(a);a.iYb(c,b);Vn.WacAirSpace.animate(a,null,null)}}luh(){return!this.k2&&!this.ho.NMc}onResize(){const a=this.ho.entries.length,b=Sys.UI.DomElement.getBounds(this.htmlElement).height;let c;for(let h=0;h<a;++h)c=
this.ho.entries[h],c.htmlElement&&c.Akh();this.RMa=Sys.UI.DomElement.getBounds(this.htmlElement).height;b!==this.RMa&&this.Ktd()}bC(){return!0}}Object(n.a)(JF,"BusinessBarDom",null,[447,106]);var Lt;(function(a){a[a.none=0]="none";a[a.corruptPage=1]="corruptPage";a[a.currentPageStatus=2]="currentPageStatus";a[a.documentMarkedAsFinal=3]="documentMarkedAsFinal";a[a.documentSigned=4]="documentSigned";a[a.fileAccess=5]="fileAccess";a[a.kickoutWithDataLoss=6]="kickoutWithDataLoss";a[a.lostSession=7]="lostSession";
a[a.malformedHyperlinkUris=8]="malformedHyperlinkUris";a[a.odt=9]="odt";a[a.readonlyRecommended=10]="readonlyRecommended";a[a.saveReplaySuccess=11]="saveReplaySuccess";a[a.saveReplayFailed=12]="saveReplayFailed";a[a.unsupportedObjects=13]="unsupportedObjects";a[a.word11Compat=14]="word11Compat";a[a.unsupportedBrowser=15]="unsupportedBrowser";a[a.applicationNotification=16]="applicationNotification";a[a.skypeDocChatFailed=17]="skypeDocChatFailed";a[a.showDialogInNewWindowInfo=18]="showDialogInNewWindowInfo";
a[a.sessionExpired=19]="sessionExpired";a[a.irmPolicyDescription=20]="irmPolicyDescription";a[a.policyWarningMessage=21]="policyWarningMessage";a[a.thirdPartyAddinDisabled=22]="thirdPartyAddinDisabled";a[a.gdprPrivacyNotice=23]="gdprPrivacyNotice";a[a.datacenterDecommissionWarning=24]="datacenterDecommissionWarning";a[a.graphMergePrompt=25]="graphMergePrompt";a[a.readOnlyDocument=26]="readOnlyDocument";a[a.dictationSilence=27]="dictationSilence";a[a.autoSensitivityLabel=28]="autoSensitivityLabel";
a[a.recommendedSensitivityLabel=29]="recommendedSensitivityLabel";a[a.dictationDebugInfo=30]="dictationDebugInfo";a[a.oneNoteCovid19Message=31]="oneNoteCovid19Message";a[a.citationStylePrompt=32]="citationStylePrompt";a[a.oneNoteViewModeMessage=33]="oneNoteViewModeMessage";a[a.oneNotePrintImagesDownloading=34]="oneNotePrintImagesDownloading";a[a.oneNotePagePrintReady=35]="oneNotePagePrintReady";a[a.irmPolicyCausedFeatureDisabled=36]="irmPolicyCausedFeatureDisabled";a[a.mandatoryLabel=37]="mandatoryLabel";
a[a.policyTip=38]="policyTip";a[a.minorVersionLimit=39]="minorVersionLimit";a[a.testEntry1=40]="testEntry1";a[a.testEntry2=41]="testEntry2";a[a.testEntry3=42]="testEntry3";a[a.testEntry4=43]="testEntry4";a[a.testEntry5=44]="testEntry5";a[a.testEntry6=45]="testEntry6";a[a.testEntry7=46]="testEntry7"})(Lt||(Lt={}));Object(n.b)("BusinessBarId",Lt);class mq{constructor(a,b=0,c=null,h=null){this.Cdf=this.c9e=!1;this.Rob=null;this.tP=[];this.Iza=h||new JF(a,b,this);this.EDj(c)}EDj(a){if(a){this.Rob={};
a=a.ranking;for(let b=0;b<a.length;b++)this.Rob[Lt[a[b]]]=b}}dispose(){this.Iza.dispose();hk.a.Rld(this.tP);this.tP=null}get htmlElement(){return this.Iza.htmlElement}get visible(){return this.Iza.visible}get NMc(){return this.c9e}set NMc(a){this.c9e=a}get Oje(){return this.Cdf}set Oje(a){this.Cdf=a}get entries(){return this.tP}set entries(a){this.tP=a}uda(a){for(let b=0;b<this.tP.length;b++)if(this.tP[b].id===a)return!0;return!1}Yh(a,b=!1,c=null){a.businessBar=this;let h=this.f$i(a.id);b&&!this.Rob&&
(h=0);h<mq.Gfb&&(this.Iza.Iuh(a,h),this.tP.length>=mq.Gfb&&this.Iza.L$f(this.tP[mq.Gfb-1]),this.Iza.Ktd());Array.insert(this.tP,h,a);ba.ULS.sendTraceTag(38111390,207,50,"Add BusinessBar Entry. Id: {0}, ContainerID: {1}.",Lt[a.id],void 0===a.kCa||null===a.kCa?"":a.kCa);a.errorCode&&u.AFrameworkApplication.xp(a.errorCode,c,null,null)}removeEntry(a){const b=Array.indexOf(this.tP,a);-1!==b&&b<mq.Gfb&&(this.tP.length>mq.Gfb&&this.Iza.Iuh(this.tP[mq.Gfb],mq.Gfb),this.Iza.L$f(a),this.Iza.Ktd());Array.remove(this.tP,
a);a.businessBar=null;a.dispose()}f$i(a){if(!this.Rob||0===a)return this.tP.length;a=this.Rob[Lt[a]];if(void 0===a||null===a)return this.tP.length;for(let b=0;b<this.tP.length;b++)if(a<this.Rob[Lt[this.tP[b].id]])return b;return this.tP.length}}mq.Gfb=2;Object(n.a)(mq,"BusinessBar",null,[425,106,426]);class RA{constructor(a){this.ALc=null;this.y0g=a.Ha("OfficeOnlineChromeExtensionId");this.H0g=a.Ha("ChromeClipboardAccessExtensionId");this.AIj=a.ka("OfficeOnlineChromeExtensionIsEnabled");this.kmf=
!this.bPj();this.ALc=this.tya?this.H0g:this.y0g}DRc(){return this.ALc}rQe(){this.ALc===this.y0g&&this.Bhg&&(localStorage.removeItem("IsOfficeOnlineExtensionInstalled"),localStorage.removeItem("IsCopyPasteSupported"));this.ALc=this.H0g;this.kmf=!0}get tya(){return this.kmf}bPj(){if(this.AIj&&this.Bhg){var a=localStorage.getItem("IsOfficeOnlineExtensionInstalled");if(a&&"true"===a)return a=localStorage.getItem("IsCopyPasteSupported"),!!a&&"true"===a}return!1}get Bhg(){let a=!1;try{localStorage.setItem("LocalStorageAccessiblityTest",
"LocalStorageAccessiblityTest"),a="LocalStorageAccessiblityTest"===localStorage.getItem("LocalStorageAccessiblityTest"),localStorage.removeItem("LocalStorageAccessiblityTest")}catch(b){ba.ULS.sendTraceTag(19452045,307,50,b.toString())}return a}}Object(n.a)(RA,"ChromeExtensionHelper",null,[1021]);class KF{constructor(a=null,b=null,c=null){this.Eaa=a||{};this.FCh=b||[];this.dtl=c||{}}}Object(n.a)(KF,"RibbonTrimmingProperties",null,[]);var oP=d(453);class LF{create(a,b,c){return new oP.a(a,b,c)}}Object(n.a)(LF,
"Factory",null,[446]);class MF{constructor(){u.AFrameworkApplication.Ta.ya(H.a.eAb,he.a.frame,Object(F.a)(this,this.tLk,"reactFileMenuOpenFromTellMe"))}tLk(a,b,c,h,m){if(1===c||!m)return 32;a=m.SourceControlId;17!==m.UILocation||"New"!==a&&"Open"!==a||(m=[],Dg.d("setFileMenuSelectedPage")&&("New"===a&&u.AFrameworkApplication.Aa?2===u.AFrameworkApplication.Aa.hb.Vk?m.push(appChrome.actions.setFileMenuSelectedPage("PptFileNewPage")):m.push(appChrome.actions.setFileMenuSelectedPage("FileNewPage")):"Open"===
a&&u.AFrameworkApplication.Aa&&(2===u.AFrameworkApplication.Aa.hb.Vk?m.push(appChrome.actions.setFileMenuSelectedPage("PptFileOpenPage")):m.push(appChrome.actions.setFileMenuSelectedPage("FileOpenPage")))),m.push(appChrome.actions.updateFileMenuExpandedValue(!0)),appChrome.api.dispatch(m));return 32}pXj(){appChrome.api.dispatch(appChrome.actions.updateFileMenuExpandedValue(!0))}}Object(n.a)(MF,"ReactFileMenu",null,[1067]);class NF{createFileMenu(){const a=new MF,b=[];b.push(appChrome.actions.updateFileMenuExpandedValue(!1));
b.push(appChrome.actions.updateFileMenuDisabledValue(!1));appChrome.api.dispatch(b);return a}}Object(n.a)(NF,"ReactFileMenuFactory",null,[1024]);var Zh=d(527);class OF{constructor(a,b,c,h,m,y,G){this.LGa=!1;this.Yz=null;this.Kla=this.U$c=this.GWa=!1;this.YBb="Edit";this.HRg=!1;this.mc=h;this.ia=a;this.Fv=b;this.Qb=m;this.Hk=G;this.Qb.IK(Object(F.a)(this,this.Wbd,"modeSwitched"));this.Ga=c;this.vb()}vb(){this.ia.ya(M.a.VYg,he.a.frame,Object(F.a)(this,this.Mhk,"modeSwitcherHandler"));this.ia.ya(M.a.Arc,
he.a.frame,Object(F.a)(this,this.Arc,"switchToDocumentEditMode"));this.ia.ya(M.a.Crc,he.a.frame,Object(F.a)(this,this.Crc,"switchToEmergencyViewMode"));this.ia.ya(M.a.Brc,he.a.frame,Object(F.a)(this,this.Brc,"switchToDocumentViewMode"));this.ia.ra(M.a.uMe,he.a.frame,Object(F.a)(this,this.Hch,"queryDocumentModeSwitchMenuItem"),96);this.ia.ra(M.a.vMe,he.a.frame,Object(F.a)(this,this.Hch,"queryDocumentModeSwitchMenuItem"),96);this.ia.ya(M.a.RCa,nc.a.application,Object(F.a)(this,this.RCa,"displayCallout"));
this.ia.ya(H.a.Xyh,he.a.frame,Object(F.a)(this,this.Yml,"switchFromViewModeToEditMode"))}dispose(){this.Qb.wY(Object(F.a)(this,this.Wbd,"modeSwitched"))}De(){}Mhk(){return 32}Brc(a,b,c){if(1===c||"View"===this.b9a())return 32;this.Fv.czh();this.Omd("View");this.U$c=!0;return 32}Arc(a,b,c){if(u.AFrameworkApplication.GQ)return 8;a=this.b9a();if(1===c){if("Edit"===a||this.LGa||this.U$c||this.GWa&&this.mc.getState(1))return 32;ba.ULS.sendTraceTag(512500510,306,10,"ModeSwitcherControlActor:SwitchToDocumentEditMode:: DocModeSwitcher Editing Option Disabled");
return 8}if("Edit"===a)return 32;this.Fv.z$k();c=this.GWa?this.ia.La(M.a.h2b,2,20):this.ia.processAction(M.a.l6b,2);this.LGa=this.GWa=this.U$c=!1;this.Omd("Edit");return c}Yml(a,b,c){if(u.AFrameworkApplication.GQ)return 8;a=this.b9a();if(1===c){if("Edit"===a||this.LGa||this.U$c||this.GWa&&this.mc.getState(1))return 32;ba.ULS.sendTraceTag(512500509,306,10,"ModeSwitcherControlActor:SwitchFromViewModeToEditMode:: DocModeSwitcher Editing Option Disabled");return 8}if("Edit"===a)return 32;if(2!==c)return ba.ULS.sendTraceTag(512500508,
306,15,String.format("Unexpected ActionBehavior {0} for switching to edit mode",c)),2;this.ia.La(M.a.refresh,2,{refreshtrigger:"SwitchFromViewModeToEditMode"});return 32}Crc(a,b,c){if(1===c)return 32;this.LGa=!0;return this.initialize()}Hch(a,b,c,h,m){b=this.b9a();m[Zh.a.On]=a===M.a.uMe&&"Edit"===b||a===M.a.vMe&&"View"===b?!0:!1;return 32}RCa(a,b,c,h,m){if(!m||!Object(za.a)(Mh,m))return 8;this.Yz=m;this.initialize();this.Hk&&!this.HRg&&"View"===this.YBb&&(this.Hk.S0e(),this.HRg=!0);return this.initialize()}initialize(){if(!Dg.c())return ba.ULS.sendTraceTag(512500507,
306,10,"ModeSwitcherControlActor:Initialize:: Failed to Initialize DocModeSwitcher - AppChrome Actions being Null"),8;this.YBb=this.H0f();!this.Kla&&this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ModeSwitcherInitialRenderIsEnabled",!1)&&this.b9a()!==this.YBb&&ba.ULS.sendTraceTag(512500506,306,50,"ModeSwitcher was initially rendered in the incorrect mode. Expected: {0}, Actual: {1}",this.YBb,this.b9a());var a=this.Yz?this.Yz.P8b||this.Yz.U8b:!1,b=this.Yz?this.Yz.rUa:this.mc.getState(16);
this.GWa=this.Yz?this.Yz.Zie:this.mc.getState(524288);var c=this.Yz?this.Yz.j$a:this.mc.getState(1);const h=this.LGa||a||this.GWa||b||!c,m={hidden:!1};m.hasEditPermission=c;m.activeMode=this.YBb;m.isMarkedAsFinal=b;m.isMarkedAsOpenReadOnly=this.GWa;m.isReviewer=!1;m.isServiceDefaultedToView=this.LGa||a;m.forceShowNotificationByExternalTrigger=this.Yz&&this.Yz.rYc?!this.Yz.rYc:h;a&&(a={},c={},c.title=ResourceStrings.L_BizBarTitle_Readonly,this.Yz.P8b?c.text=ResourceStrings.L_BizBarMessage_PasswordProtected:
this.Yz.U8b&&(c.text=ResourceStrings.L_BizBarMessage_FileFormatNotEditable),c.confirmationButtonText=ResourceStrings.L_InsertTableDialogButtonText,c.icon="pptEditorSprite.CancelGlyph_16",c.label=ResourceStrings.L_Close,a.serviceDefaultedToViewCallout=c,m.notificationCalloutProps=a);a=appChrome.actions.updateModeSwitcher(m);if(!a)return ba.ULS.sendTraceTag(512500505,306,10,"ModeSwitcherControlActor:Initialize:: Failed to Initialize DocModeSwitcher - Redux Action being Null"),8;ba.ULS.sendTraceTag(512500504,
306,50,"ModeSwitcherControlActor:Initialize:: Dispatching Mode switcher action. ActionDataAvailable:{0}, HasEditPerm: {1}, Mode:{2}, MarkedFinal: {3}, MarkedOpenRO: {4}, EditProtected: {5}, FormatUnsupported: {6}, EmergencyMode: {7}, InReadingMode: {8}",!!this.Yz,m.hasEditPermission,this.YBb,b,this.GWa,!!this.Yz&&this.Yz.P8b,!!this.Yz&&this.Yz.U8b,this.LGa,this.heg());b=this.tZd(a);this.Kla=!0;return b}tZd(a){if(appChrome.api)return appChrome.api.dispatch(a),32;ba.ULS.sendTraceTag(512500503,306,10,
"ModeSwitcherControlActor:DispatchAction:: Failed to Initialize DocModeSwitcher - PPT App Chrome API being Null");return 8}heg(){return!!u.AFrameworkApplication.Aa&&1===u.AFrameworkApplication.Aa.mode}H0f(){return this.Yz?this.LGa||this.Yz.rUa||this.Yz.Zie||this.Yz.P8b||this.Yz.U8b||this.Yz.rYc?"View":this.Yz.j$a?"Edit":"View":this.LGa||this.heg()?"View":"Edit"}b9a(){if(Dg.c())switch(appChrome.selectors.getModeSwitcherMode()){case null:case "Edit":break;case "View":return"View";default:ba.ULS.sendTraceTag(512500502,
306,15,"ModeSwitcherControlActor:GetCurrentDocumentMode:: ModeSwitcher Actor received an invalid active mode from the control.")}return"Edit"}Omd(a){if(Dg.c()&&this.b9a()!==a){var b={};b.activeMode=a;ba.ULS.sendTraceTag(512500501,306,50,"ModeSwitcherControlActor:SendUpdateModeReduxAction:: ModeSwitcher control switching to mode {0}",a);a=appChrome.actions.updateModeSwitcher(b);this.tZd(a)}}Wbd(a){this.Kla&&(1===a.mode?this.Omd("View"):2===a.mode&&this.Omd("Edit"))}wVk(){const a={hidden:!1};a.activeMode=
this.H0f();this.tZd(appChrome.actions.updateModeSwitcher(a))}}Object(n.a)(OF,"ModeSwitcherControlActor",null,[554]);var PF=d(250);class SA{constructor(a,b,c,h){this.jBa=this.z$e=this.Gob=this.V8e=this.UMa=this.Z7e=null;this.jof=!1;this.ho=a;this.hZ=b;this.Ca=c;this.$a=h}vzk(){this.YZb();this.ZZb();this.Wqi()}YZb(){const a=Fc.App.Kb.Jd.yi;a&&(this.Z7e=this.Ltd(this.Z7e,1,2===Fc.App.Kb.mode&&a.SXc,Box4Intl.Box4Strings.l_BusinessBarReadonlyCorruptContent))}get SUj(){if(!Fc.App.fFh)return!1;v.a.XW&&u.AFrameworkApplication.fk("Microsoft.Office.SharedOnline.IE11SoftBlockConsumerIsEnabled");
return v.a.Dj}Wqi(){this.SUj&&!this.Gob&&(this.Gob=this.hZ.create("",CommonUIStrings.l_UnsupportedBrowserDeadline,null),this.Gob.id=15,this.Gob.closeable=!0,this.Gob.addButton(Box4Intl.Box4Strings.L_DownloadNow,I.AppFrame.Lwl,""),Jf.a("NewBrowserSuggestionShown"),this.ho.Yh(this.Gob,!1))}ZZb(){let a=null;const b=Fc.App.Kb.Jd.Sba;if(b){const c=b.hkc;PF.a.z8b(c)?22===c?a=Box4Intl.Box4Strings.l_BusinessBarQuotaExceeded:19===c||20===c?a=v.a.Ni?Box4Intl.Box4Strings.l_BusinessBarVirusNoCopy:Box4Intl.Box4Strings.l_BusinessBarVirus:
21===c?a=Box4Intl.Box4Strings.l_BusinessBarMinorVersionLimitExceeded:23===c?a=v.a.Ni?Box4Intl.Box4Strings.l_BusinessBarFileSizeExceededNoCopy:Box4Intl.Box4Strings.l_BusinessBarFileSizeExceeded:7===c&&(a=Box4Intl.Box4Strings.l_BusinessBarWriteAccessDenied):2!==Fc.App.Kb.mode||PF.a.eVc(b.pXb)||Fc.App.T9b||(a=Box4Intl.Box4Strings.l_SectionLockedInfoText)}this.z$e=this.Ltd(this.z$e,5,!!a,a)}A$k(a){!!this.jBa===a||this.jof||(a?(this.jBa=this.hZ.create("",Box4Intl.Box4Strings.l_BusinessBarUnsupportedObjectsOnPage,
null),this.jBa.id=13,this.jBa.closeable=!0,this.jBa.P2=()=>{this.jof=!0;this.jBa=null},this.ho.Yh(this.jBa)):(this.ho.removeEntry(this.jBa),this.jBa=null))}Ouh(a,b,c,h){a=this.hZ.create(null,a,null);a.closeable=!0;a.id=23;a.image=3;a.Uqf(b,()=>{qd.a.openWindow(4,"https://go.microsoft.com/fwlink/?linkid="+c)});h&&(a.P2=h);this.ho.Yh(a,!0)}Xfl(a,b,c){this.Ouh(a,b,c,null)}ufl(a){a=this.hZ.create(null,a,null);a.closeable=!0;a.id=24;a.image=1;this.ho.Yh(a,!0)}hgl(a){a=this.hZ.create(null,a,null);a.closeable=
!0;a.id=20;this.ho.Yh(a)}zfl(){var a=Box4Intl.Box4Strings.L_DictationSilenceBusinessBarTitle,b=Box4Intl.Box4Strings.L_DictationSilenceBusinessBarMessage;this.UMa||(this.UMa=this.hZ.create(a,b,null),this.UMa.closeable=!0,this.UMa.id=27,this.ho.Yh(this.UMa))}Gxj(){this.UMa&&(this.UMa=this.Ltd(this.UMa,27,!1,""))}tWe(a){this.V8e=this.Ltd(this.V8e,30,!0,a)}Ltd(a,b,c,h){c?a?a.message=h:(a=this.hZ.create("",h,null),a.id=b,a.closeable=!1,this.ho.Yh(a,!1)):a&&(this.ho.removeEntry(a),a=null);return a}}Object(n.a)(SA,
"BusinessBarController",null,[1023]);class TA extends SA{constructor(a,b,c,h,m,y,G,U){super(a,b,h,y);this.yne=this.Cxg=!1;this.Wfc=[];this.SFa=0;this.Xye=null;this.tne=c;this.ia=h;this.A9=m;this.Fa=G;this.cA=U.ZEa;this.Gfc=U.powerPointDragInsertMultipleImageQuantityLimit}initialize(){this.tne.IK(Object(F.a)(this,this.Mu,"onAppFrameModeSwitched"))}dispose(){this.tne.wY(Object(F.a)(this,this.Mu,"onAppFrameModeSwitched"))}nv(a,...b){this.I1b.apply(this,[a,this.A9.YSc(a),this.A9.H9d(a),this.A9.d7d(a)].concat(b))}I1b(a,
b,c,h){0===a||this.Xye||(c=this.hZ.create(c,h||"",null),c.closeable=!0,c.errorCode=qf.a.Uh(a),c.P2=Object(F.a)(this,this.URi,"errorEntryClosedHandler"),a=!!(b&8),b=!!(b&4),a&&c.addButton(ResourceStrings.L_Refresh,Object(F.a)(this,this.Bjd,"refreshActionHandler"),""),b&&(a?c.BNd(ResourceStrings.L_OpenInPowerPoint,Object(F.a)(this,this.zfd,"openInClientActionHandler")):c.addButton(ResourceStrings.L_OpenInPowerPoint,Object(F.a)(this,this.zfd,"openInClientActionHandler"),"")),this.Xye=c,this.zXb(c))}VK(a){var b=
"";let c="",h=null,m="",y=null;var G=!1;switch(a){case 0:b=ResourceStrings.L_BizBarTitle_MarkedAsFinal;a=ResourceStrings.L_BizBarMessage_MarkedAsFinal;G=!0;break;case 20:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.l_BizBarMessage_MarkedAsReadOnlyRecommended;G=!0;break;case 1:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_EditPermissionDenied;G=!0;break;case 2:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_FileFormatNotEditable;
G=!0;break;case 3:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_PptEditCheckedOutByAnother;G=!0;break;case 4:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_RequiresCheckout;G=!0;break;case 5:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_LockedForOfflineCheckout;G=!0;break;case 6:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_CannotAcquirePptEditLock;G=!0;break;case 7:b=ResourceStrings.L_BizBarTitle_Readonly;
a=ResourceStrings.L_BizBarMessage_CannotAcquirePptEditSharedLock;G=!0;break;case 8:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_NumberOfCoauthorsReachedMax;G=!0;break;case 9:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_PptEditExistingExclusiveLock;G=!0;break;case 10:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_FileFormatConvertible;c=ResourceStrings.L_BizBarButton_Convert;h=Object(F.a)(this,this.azi,"convertActionHandler");
G=!0;break;case 11:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_PasswordProtected;G=!0;break;case 12:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_FontRestricted;G=!0;break;case 13:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_SessionRestricted;G=!0;break;case 14:b=u.AFrameworkApplication.fa.appSettings.IrmPolicyTitle?u.AFrameworkApplication.fa.appSettings.IrmPolicyTitle:"";a=u.AFrameworkApplication.fa.appSettings.IrmPolicyDescription?
u.AFrameworkApplication.fa.appSettings.IrmPolicyDescription:"";G=!0;break;case 15:b=ResourceStrings.L_BizBarTitle_SessionExpired;a=ResourceStrings.L_BizBarMessage_SessionAccessTokenExpired;G=!0;break;case 18:b=ResourceStrings.L_BizBarTitle_DragDropNotSupportFormat;a=ResourceStrings.L_BizBarMessage_DragDropNotSupportFormat;G=!1;break;case 19:b=String.format(ResourceStrings.L_BizBarTitle_DragDropMoreFilesThanLimite,this.Gfc);a=String.format(ResourceStrings.L_BizBarMessage_DragDropMoreFilesThanLimite,
this.Gfc);G=!1;break;case 22:b=ResourceStrings.L_BizBarTitle_Readonly;a=this.Bgj();G=!1;a&&(this.SFa=a,a=this.ia.La(M.a.iKb,1,this.SFa),8!==a&&16!==a&&(G=!0,c=ResourceStrings.L_BizBarInlineRepairSaveAsText,h=Object(F.a)(this,this.cWk,"repairSaveCopyHandler")));32===this.ia.processAction(M.a.Rnc,1)&&(G?(m=ResourceStrings.L_BizBarInlineRepairOverwriteFileText,y=Object(F.a)(this,this.fjh,"replaceOriginalFileHandler")):(G=!0,c=ResourceStrings.L_BizBarInlineRepairOverwriteFileText,h=Object(F.a)(this,this.fjh,
"replaceOriginalFileHandler")));a=G?ResourceStrings.L_BizBarInlineRepairWithSaveMessage:ResourceStrings.L_BizBarInlineRepairWithoutSaveMessage;G=!0;break;case 23:b=ResourceStrings.L_BizBarTitle_ViewOnly;a=ResourceStrings.L_BizBarEmergencyViewingModeMessage2;c=ResourceStrings.L_BizBarEmergencyViewingModeEditButton;h=Object(F.a)(this,this.Znj,"goToEditModeHandler");G=!0;break;case 24:b=ResourceStrings.L_BizBarTitle_MinorVersionLimitReached;a=ResourceStrings.L_BizBarInlineMinorVersionLimitReached;c=
ResourceStrings.L_LearnMore;h=Object(F.a)(this,this.svk,"openVersioningPageHandler");break;case 25:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_UserNetworkLocationUnauthorized;break;case 26:a=ResourceStrings.L_BizBarMessage_CannotCropCurrentSelection;G=!1;break;case 27:a=ResourceStrings.L_BizBarInlineFilterPrivacy;break;default:return}b=this.hZ.create(b,a,null);b.image=3;b.closeable=!0;b.P2=G?Object(F.a)(this,this.Neh,"readOnlyInfoEntryClosedHandler"):Object(F.a)(this,
this.Gbg,"infoEntryClosedHandler");h&&b.addButton(c,h,"");y&&b.BNd(m,y);this.zXb(b);G&&Array.add(this.Wfc,b)}SCa(a){let b;switch(a){case 22:var c=CommonUIStrings.l_ThirdPartyAddinDisabledTitle;b=CommonUIStrings.l_ThirdPartyAddinDisabledMessage;break;case 36:c=CommonUIStrings.l_IrmProtectedDocumentAddinsDisabledTitle;b=CommonUIStrings.l_IrmProtectedDocumentAddinsDisabledMessage;break;default:return}c=this.hZ.create(c,b,null);c.id=a;c.image=1;c.closeable=!0;this.zXb(c)}LMc(a,b){let c,h=!1,m=!1,y=!1,
G=!1;switch(a){case 1:a=ResourceStrings.L_BizBarTitle_Readonly;c=ResourceStrings.L_BizBarMessage_EditPermissionDenied;b=1;break;case 0:a=ResourceStrings.L_BizBarTitle_MarkedAsFinal;c=b?ResourceStrings.L_BizBarMessage_MarkedAsFinal_DocIsEdited:ResourceStrings.L_BizBarMessage_MarkedAsFinal;m=b;b=1;break;case 20:a=ResourceStrings.L_BizBarTitle_Readonly;c=ResourceStrings.l_BizBarMessage_MarkedAsReadOnlyRecommended;y=!0;b=3;break;case 16:a=ResourceStrings.L_BizBarTitle_CannotConnectToInternet;c=ResourceStrings.L_BizBarMessage_CannotConnectToInternet;
h=!0;b=1;break;case 17:a=b?ResourceStrings.L_BizBarTitle_ChangesCannotBeSavedInThisFile:ResourceStrings.L_BizBarTitle_Readonly;c=b?ResourceStrings.L_BizBarMessage_ServerError_UserHasEditedDoc_Download:ResourceStrings.L_BizBarMessage_ServerError_UserNotEditedDoc;G=b;b=1;break;case 15:a=ResourceStrings.L_BizBarTitle_SessionExpired;c=ResourceStrings.L_BizBarMessage_SessionAccessTokenExpired;h=!0;b=1;break;case 21:a=ResourceStrings.L_BizBarTitle_WopiTokenOutOfRefreshRange;c=ResourceStrings.L_BizBarMessage_WopiTokenOutOfRefreshRange;
h=!0;b=1;break;default:return}a=this.hZ.create(a,c||"",null);a.closeable=!0;a.P2=Object(F.a)(this,this.Neh,"readOnlyInfoEntryClosedHandler");a.image=b;h?(Ba.a.J(512263711,801,15,"Refresh button is show"),a.addButton(ResourceStrings.L_Refresh,Object(F.a)(this,this.Bjd,"refreshActionHandler"),"")):m?(Ba.a.J(512263710,801,15,"SaveACopy button is show"),a.addButton(ResourceStrings.L_BizBarButton_SaveACopy,Object(F.a)(this,this.k0k,"saveAsActionHandler"),"")):G?(Ba.a.J(512263709,801,15,"DownloadACopy button is show"),
a.addButton(ResourceStrings.L_DownloadCopy,Object(F.a)(this,this.CNi,"downloadACopyActionHandler"),"")):y&&(Ba.a.J(512263708,801,15,"EditAnyway button is show"),a.addButton(ResourceStrings.l_BizBarButton_EditAnyway,Object(F.a)(this,this.pOi,"editAnywayActionHandler"),""));this.zXb(a);Array.add(this.Wfc,a)}uda(a){return this.ho.uda(a)}Bgj(){let a=0;if(this.$a.ka("IsUIEmbedMode")||this.$a.ka("DisablePrint")||!this.$a.Ha("DownloadACopyUrl")||"true"===this.$a.Ha("ProtectInClient")||v.a.Ni)return a;let b=
!0;this.$a.ka("SaveToAnotherFolderBrsIsEnabled")&&this.$a.ka("SupportsGetMoreInfoForPersonalStorage")||(b=!1);let c=!0;this.$a.ka("SaveACopyBrsIsEnabled")||(c=!1);let h=!0;this.$a.ka("SaveAsToHostBrsIsEnabled")&&this.$a.ka("UserCanWriteRelative")&&this.$a.ka("SupportsEditing")||(h=!1);a=b?H.a.Nib:c?H.a.Ioc:a;Ba.a.J(512263707,801,(b||c)&&(b||h)&&(c||h)?15:50,"BusinessBarController::GetSaveAsCommand saveToSharePoint:{0}, saveACopy:{1}, saveAsToHost:{2}, CommandName: {3} ",b,c,h,a);return a}zXb(a){const b=
this.ho.visible;this.ho.Yh(a);b||this.Fa.Bj(Di.a.SRd,!0)}Bjd(a){Ba.a.J(512263706,801,15,"Refresh button is clicked, ErrorCode:{0}",a.errorCode);this.ia.processAction(M.a.refresh,2)}Gbg(){this.ho.entries.length||this.Fa.Bj(Di.a.SRd,!1)}URi(){this.Xye=null;this.ho.entries.length||this.Fa.Bj(Di.a.SRd,!1)}Neh(a){Array.remove(this.Wfc,a);this.Gbg(a);Ba.a.J(512263705,801,50,"Read-only info entry is closed")}zfd(){this.ia.La(M.a.openInClient,2,!0)}azi(){this.ia.La(M.a.convertAndEdit,2,!1)}cWk(){u.AFrameworkApplication.EJ?
this.XWe(CommonUIStrings.l_SensitivitySaveDocumentError):this.ia.La(M.a.iKb,2,this.SFa)}fjh(){this.ia.processAction(M.a.Rnc,2)}Znj(){this.ia.processAction(M.a.l6b,2)}k0k(){Ba.a.J(512263704,801,15,"SaveACopy button is clicked");u.AFrameworkApplication.EJ?this.XWe(CommonUIStrings.l_SensitivitySaveDocumentError):this.ia.La(H.a.Nib,2,!0)}CNi(){Ba.a.J(512263703,801,15,"DownloadACopy button is clicked");u.AFrameworkApplication.EJ?this.XWe(CommonUIStrings.l_SensitivityDownloadDocumentError):this.ia.La(H.a.downloadACopy,
2,!0)}XWe(a){Ba.a.J(512263702,801,50,"Unable to save/download ppt from business bar as document is protected");const b=new Rf.StandardDialog;b.xd=0;b.zy(qf.a.nNi,jk.a.k3(ResourceStrings.l_GenericDialogTitle),jk.a.k3(a),null)}pOi(){Ba.a.J(512263701,801,50,"EditAnyway button is clicked");this.ia.La(M.a.h2b,2,20)}svk(){Ba.a.J(512263700,801,50,"Learn More button is clicked");Nw.Redirect.showHelp("0f6cd105-974f-44a4-aadb-43ac5bdfd247")}rTd(){if(this.tne.h$a&&!this.yne&&!this.Cxg){this.yne=!0;var a=this.hZ.create("",
CommonUIStrings.l_OdfFileCompatWarningBusinessBar,null);a.closeable=!0;a.P2=()=>{this.Cxg=!0;this.yne=!1};a.addButton(CommonUIStrings.l_OdfFileCompatWarningBusinessBarButton,Object(F.a)(this,this.enk,"onCompatWarningButtonClick"),"");this.zXb(a)}}enk(){Nw.Redirect.showHelp("PPTODF")}TMf(){for(const a of this.Wfc)this.ho.removeEntry(a);Array.clear(this.Wfc)}Mu(a){this.cA&&2===a.mode&&this.TMf()}}Object(n.a)(TA,"BusinessBarController",SA,[1022,1023,106]);class QF{constructor(a,b){this.Obb=null;this.Kak=
b;this.qb=document.createElement("div");this.qb.className="BusinessBarPanel";this.qb.id="BusinessBarPanel";this.Khc=document.createElement("div");this.Khc.id="BusinessBarPanelWorking";this.qb.insertBefore(this.Khc,this.qb.firstChild);a.execute(c=>{this.Obb=c;this.Kak&&this.Obb&&(this.Obb.NMc=!0);this.Khc.insertBefore(this.Obb.htmlElement,this.Khc.firstChild)});this.qb.style.position=Td.a.prc}dispose(){}layout(a,b){if(!this.Obb||!this.Obb.visible)return this.zr(),a;this.kMi(b);this.qb.style.height=
cf.a.Pc(this.Obb.htmlElement.offsetHeight);return a}zr(){"none"!==this.qb.style.display&&(this.qb.style.display="none")}kMi(a){this.qb.style.display.length&&(this.qb.style.display="");a&&(this.qb.style.direction=Td.a.s0a)}get xa(){return this.qb}get wFl(){return this.Khc}get order(){return 2}}Object(n.a)(QF,"BusinessBarPane",null,[558,461,106]);var Ww=d(564);class Oo{}Oo.Value="value";Oo.MinValue="MinValue";Oo.MaxValue="MaxValue";Oo.Text="Text";Object(n.a)(Oo,"SliderCommandProperties",null,[]);var Cp=
d(1107);class nq{constructor(){this.iconSet=null;this.hidden=this.disabled=!1;this.customTooltip=this.keytip=this.fullDescriptionLabel=this.iconColor=null;this.shouldTakeFocus=!1}}Object(n.a)(nq,"CommonOptionalButtonProperties",null,[]);class pv extends nq{constructor(){super();this.role=this.commandValueId=null;this.supportsPreview=this.hideLabel=!1;this.lang=null}}Object(n.a)(pv,"OptionalButtonProperties",nq,[]);class RF extends pv{constructor(){super();this.animateTransition=!1}}Object(n.a)(RF,
"AdditionalInkButtonProperties",pv,[]);class zy extends nq{constructor(){super();this.menuModel=null;this.hideLabel=!1;this.downChevronIcon=null;this.hideIcon=this.hideChevron=!1;this.labelInMenu=this.lang=null;this.toggled=!1;this.roleInMenu=null}}Object(n.a)(zy,"OptionalFlyoutAnchorProperties",nq,[]);class SF extends zy{constructor(){super();this.animateTransition=!1}}Object(n.a)(SF,"AdditionalInkFlyoutAnchorProperties",zy,[]);class TF{constructor(){this.selected=!1;this.iconColor=null}}Object(n.a)(TF,
"InkControlState",null,[]);class UF{constructor(){this.keytip=this.vEa=this.label=null}}Object(n.a)(UF,"InkFlyoutAnchorResources",null,[]);class Ds{constructor(){this.CAb=[]}ya(a){this.CAb.push(a)}commit(){appChrome.api.dispatch(this.CAb);Array.clear(this.CAb)}}Object(n.a)(Ds,"AppChromeTransaction",null,[]);class Zd{}Zd.WA="InkPen1";Zd.$D="InkPen2";Zd.ZD="InkHighlighter";Zd.Lta="InkRuler";Zd.K$a="InkColorPicker1";Zd.oda="InkColorPicker2";Zd.Kta="InkColorPicker3";Zd.oka="InkColorPickerMRU1";Zd.pka=
"InkColorPickerMRU2";Zd.DEa="InkColorPickerMRU3";Zd.GEa="InkThicknessSlider1";Zd.HEa="InkThicknessSlider2";Zd.IEa="InkThicknessSlider3";Zd.EEa="InkDrawWithTouch";Zd.I8="InkEraser";Zd.J8="InkLasso";Zd.FEa="InkSelect";Zd.eVf="label";Zd.cVf="iconName";Zd.dVf="keytip";Zd.bde=4;Object(n.a)(Zd,"InkRibbonManagerConstants",null,[]);class oq{constructor(a,b,c,h,m){this.WWa=this.YWa=this.XWa=oq.LHc;this.E8=(y,G,U,ja,va)=>{if(1===U)return this.rcb?8:32;G=this.Lla.ga(Zd.Lta).selected;y!==M.a.tmd&&this.XIc(y===
M.a.pKa);U=new Ds;if(this.yVe(this.zje(va)))switch(y){case M.a.rmd:case M.a.smd:case M.a.pmd:case M.a.omd:case M.a.qmd:case M.a.imd:case M.a.jmd:case M.a.kmd:case M.a.lmd:case M.a.mmd:case M.a.nmd:this.QJ(Zd.EEa,!0,!1,U,!1)}switch(y){case M.a.rmd:this.QJ(Zd.WA,!0,!0,U,!0);this.ia.La(M.a.WA,2,va);this.cB=Zd.WA;break;case M.a.lmd:this.QJ(Zd.WA,!0,!0,U,!0);this.qKb(Zd.WA,this.lWa,Zd.oda,[Zd.oka,Zd.pka],"#000000",va,U);this.ia.La(M.a.oka,2,va);this.cB=Zd.WA;break;case M.a.imd:this.QJ(Zd.WA,!0,!0,U,!0);
this.qKb(Zd.WA,this.lWa,Zd.oda,[Zd.oka,Zd.pka],"#000000",va,U);this.ia.La(M.a.K$a,2,va);this.cB=Zd.WA;break;case M.a.smd:this.QJ(Zd.$D,!0,!0,U,!0);this.ia.La(M.a.$D,2,va);this.cB=Zd.$D;break;case M.a.mmd:this.QJ(Zd.$D,!0,!0,U,!0);this.qKb(Zd.$D,this.lWa,Zd.oda,[Zd.oka,Zd.pka],"#e71224",va,U);this.ia.La(M.a.pka,2,va);this.cB=Zd.$D;break;case M.a.jmd:this.qKb(Zd.$D,this.lWa,Zd.oda,[Zd.oka,Zd.pka],"#e71224",va,U);this.QJ(Zd.$D,!0,!0,U,!0);this.ia.La(M.a.oda,2,va);this.cB=Zd.$D;break;case M.a.pmd:this.QJ(Zd.ZD,
!0,!0,U,!0);this.ia.La(M.a.ZD,2,va);this.cB=Zd.ZD;break;case M.a.nmd:this.QJ(Zd.ZD,!0,!0,U,!0);this.qKb(Zd.ZD,this.aCb,Zd.Kta,[Zd.DEa],"#fffc00",va,U);this.ia.La(M.a.DEa,2,va);this.cB=Zd.ZD;break;case M.a.kmd:this.QJ(Zd.ZD,!0,!0,U,!0);this.qKb(Zd.ZD,this.aCb,Zd.Kta,[Zd.DEa],"#fffc00",va,U);this.ia.La(M.a.Kta,2,va);this.cB=Zd.ZD;break;case M.a.omd:this.QJ(Zd.I8,!0,!1,U,!1);this.ia.La(M.a.I8,2,va);break;case M.a.tmd:this.QJ(Zd.Lta,!G,!1,U,!1);this.ia.La(M.a.Lta,2,va);break;case M.a.qmd:this.QJ(Zd.J8,
!0,!1,U,!1);this.ia.La(M.a.J8,2,va);break;case M.a.pKa:this.QJ(Zd.FEa,!0,!1,U,!1),this.QJ(Zd.EEa,!1,!1,U,!1),this.ia.processAction(M.a.FEa,2)}U.commit();this.O8j&&Ww.ShyRibbon.cQa(1,2);return 32};this.ia=a;this.O8j=h;this.la=m;this.Lla=new Jb.a;this.nea=new Jb.a;for(const y of oq.Yce){a="";switch(y){case Zd.WA:a="#000000";break;case Zd.$D:a="#E71224";break;case Zd.ZD:a="#FFFC00"}this.Lla.$(y,Object.assign(new TF,{selected:!1,iconColor:a}))}u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.hb&&
u.AFrameworkApplication.Aa.hb.Np&&this.vb();this.lWa=new Qa.a;this.lWa.add("#FFC114");this.lWa.add("#F6630D");this.lWa.add("#FF0066");this.lWa.add("#5B2D90");this.aCb=new Qa.a;this.aCb.add("#00F900");this.aCb.add("#00FDFF");this.aCb.add("#FF40FF");this.aCb.add("#FF8517");this.cB=Zd.WA;b.NFc(Object(F.a)(this,this.AU,"onFocusChanged"));this.rcb=!c||!c.Ic}vb(){this.ia.ra(M.a.Zce,xb.a.application,Object(F.a)(this,this.yPi,"enableMRUPenAndDisableDrawWithTouch"),4);this.ia.ra(M.a.rcg,xb.a.application,Object(F.a)(this,
this.Ttj,"handleRefreshInkUIValues"),4);this.ia.ra(M.a.nWc,xb.a.application,Object(F.a)(this,this.prj,"handleInkSetInkRibbonManagerDisabledState"),4);this.ia.ra(M.a.rmd,xb.a.application,this.E8,4);this.ia.ra(M.a.smd,xb.a.application,this.E8,4);this.ia.ra(M.a.pmd,xb.a.application,this.E8,4);this.ia.ra(M.a.tmd,xb.a.application,this.E8,4);this.ia.ra(M.a.imd,xb.a.application,this.E8,4);this.ia.ra(M.a.jmd,xb.a.application,this.E8,4);this.ia.ra(M.a.kmd,xb.a.application,this.E8,4);this.ia.ra(M.a.lmd,xb.a.application,
this.E8,4);this.ia.ra(M.a.mmd,xb.a.application,this.E8,4);this.ia.ra(M.a.nmd,xb.a.application,this.E8,4);this.ia.ra(M.a.nSe,xb.a.application,Object(F.a)(this,this.gae,"handleThicknessSliderChanged"),4);this.ia.ra(M.a.oSe,xb.a.application,Object(F.a)(this,this.gae,"handleThicknessSliderChanged"),4);this.ia.ra(M.a.pSe,xb.a.application,Object(F.a)(this,this.gae,"handleThicknessSliderChanged"),4);this.ia.ra(M.a.mSe,xb.a.application,Object(F.a)(this,this.nrj,"handleInkDrawWithTouchSelected"),4);this.ia.ra(M.a.omd,
xb.a.application,this.E8,4);this.ia.ra(M.a.qmd,xb.a.application,this.E8,4);this.ia.ra(M.a.pKa,xb.a.application,this.E8,4)}prj(a,b,c,h,m){if(1===c)return 32;this.rcb=m;return 32}Ttj(a,b,c){if(1===c)return 32;a=new Ds;this.bLb(Zd.GEa,this.XWa,a);this.bLb(Zd.HEa,this.YWa,a);this.bLb(Zd.IEa,this.WWa,a);a.commit();this.nea.count||this.sZj();return 32}nrj(a,b,c,h,m){if(1===c)return this.rcb?8:32;a=m&&m.forceDisable?m.forceDisable:!1;this.Lla.ga(Zd.EEa).selected||a?(this.XIc(!1),this.BMf()):(this.XIc(!1),
a=new Ds,this.QJ(Zd.EEa,!0,!1,a,!1),this.QJ(this.cB,!0,!0,a,!0),a.commit(),this.ia.La(M.a.Xce,2,{enable:!0}));return 32}gae(a,b,c,h,m){if(1===c)return 32;b=new Ds;this.QJ(Zd.EEa,!0,!1,b,!1);m&&m&&(m[oq.Uil]=Oo.Value);switch(a){case M.a.nSe:this.ia.La(M.a.GEa,2,m);this.XWa=this.P9a(m);this.bLb(Zd.GEa,this.XWa,b);this.cB=Zd.WA;break;case M.a.oSe:this.ia.La(M.a.HEa,2,m);this.YWa=this.P9a(m);this.bLb(Zd.HEa,this.YWa,b);this.cB=Zd.$D;break;case M.a.pSe:this.ia.La(M.a.IEa,2,m),this.WWa=this.P9a(m),this.bLb(Zd.IEa,
this.WWa,b),this.cB=Zd.ZD}b.commit();return 32}isEnabled(a){return this.Lla.ga(a).selected}yPi(a,b,c){if(1===c)return 32;if(!Dg.c())return Ba.a.J(512493019,801,15,"Ribbon should be initialized when calling EnableMRUPenAndDisableDrawWithTouch."),8;if(!this.nea.count)return 32;this.XIc(!1);this.BMf();this.Lla.ga(this.cB).selected=!1;a=new Ds;this.QJ(this.cB,!0,!0,a,!0);this.ia.processAction(M.a.qcg,2);a.commit();return 32}sZj(){for(const a of oq.Yce)switch(a){case Zd.WA:this.iac(Zd.WA);break;case Zd.$D:this.iac(Zd.$D);
break;case Zd.ZD:this.iac(Zd.ZD);break;case Zd.I8:this.iac(Zd.I8);break;case Zd.J8:this.iac(Zd.J8)}}iac(a){const b=appChrome.selectors.getInkButtonState(a);this.nea.$(a,Object.assign(new UF,{label:Zd.eVf in b?Object(ua.a)(String,b[Zd.eVf]):"",vEa:Zd.cVf in b?Object(ua.a)(String,b[Zd.cVf]):"",keytip:Zd.dVf in b?Object(ua.a)(String,b[Zd.dVf]):""}))}XIc(a){const b=new Ds;for(const c of oq.Yce)if(c!==Zd.Lta)switch(this.QJ(c,!1,!1,b,!0),c){case Zd.WA:this.atb(Zd.WA,b,!0,a);break;case Zd.$D:this.atb(Zd.$D,
b,!0,a);break;case Zd.ZD:this.atb(Zd.ZD,b,!0,a);break;case Zd.I8:this.atb(Zd.I8,b,!0,a);break;case Zd.J8:this.atb(Zd.J8,b,!0,a)}b.commit()}mHh(a,b,c){c.ya(appChrome.actions.toggleButton(a,b));this.Lla.ga(a).selected=b}QJ(a,b,c,h,m){c?b?(b&&!this.Lla.ga(a).selected&&this.Yui(a,h,m),this.mHh(a,b,h)):this.atb(a,h,m,a!==Zd.FEa):this.mHh(a,b,h)}atb(a,b,c,h){if(this.nea.Hb(a)){var m=this.nea.ga(a).vEa,y=this.nea.ga(a).keytip,G=this.nea.ga(a).label,U=this.J4d(a);a=appChrome.api.createInkButtonModel(a,U?
U:G,Object.assign(new RF,{iconSet:(new Cp.a(m)).iconSet,iconColor:this.Lla.ga(a).iconColor,keytip:y,animateTransition:c&&!h}));b.ya(appChrome.actions.addControls([a]))}}Yui(a,b,c){if(this.nea.Hb(a)){var h=this.J4d(a),m=this.nea.ga(a).vEa,y=this.nea.ga(a).keytip,G=this.nea.ga(a).label;a=appChrome.api.createInkFlyoutAnchorModel(a,h?h:G,Object.assign(new SF,{iconSet:(new Cp.a(m)).iconSet,iconColor:this.Lla.ga(a).iconColor,keytip:y,menuModel:appChrome.getInkFlyoutAnchorMenuModel(a),animateTransition:c}));
b.ya(appChrome.actions.addControls([a]))}}J4d(a){if(this.la.ka("InkColorLabelEnabled")){var b=void 0;switch(a){case Zd.WA:case Zd.$D:var c=appChrome.selectors.getColorPickerState(Zd.oda);break;case Zd.ZD:c=appChrome.selectors.getColorPickerState(Zd.Kta)}c&&(c=this.uHf(Array.isArray(c.colorCells)?c.colorCells:null),b=this.nea.ga(a).label,b=`${b.split(":")[0]}: ${c[this.Lla.ga(a).iconColor].label}`);return b}}Q6k(a,b,c){c.ya(appChrome.actions.updateIconColor(a,b));this.R6k(a,c)}R6k(a,b){let c=this.J4d(a);
c&&b.ya(appChrome.actions.setControlLabel(a,c))}S6k(a,b,c){c.ya(appChrome.actions.populateColorPickerCells(a,b))}bLb(a,b,c){c.ya(appChrome.actions.updateSliderSelectedValue(a,b))}aBk(a,b,c,h){if(a=appChrome.selectors.getColorPickerState(a)){a=this.uHf(Array.isArray(a.colorCells)?a.colorCells:null);for(const m of b)this.S6k(m,this.abj(a,c),h)}}bbj(a,b){const c=a.indexOf(b);-1===c?a.removeAt(a.count-1):a.removeAt(c);a.insert(0,b)}uHf(a){const b={};for(const c of a)b[c.id]=c;return b}abj(a,b){const c=
[];for(let h of b)h in a&&Array.add(c,a[h]);return c}zje(a){return a&&a.InputMethod?a.InputMethod===Zd.bde:!1}yVe(a){return!a||v.a.Ni||v.a.D8b}Ogj(a,b){a&&a.Color&&(b=6===Object(ua.a)(String,a.Color).length?"#"+a.Color:Object(ua.a)(String,a.Color));return b}qKb(a,b,c,h,m,y,G){m=this.Ogj(y,m);this.Lla.ga(a).iconColor=m;this.Q6k(a,m,G);this.bbj(b,m);this.aBk(c,h,b,G)}BMf(){const a=new Ds;this.QJ(Zd.EEa,!1,!1,a,!1);this.ia.La(M.a.Xce,2,{enable:!1});a.commit()}AU(a,b){b.YHb===Ua.a.VO&&b.Zfb!==Ua.a.VO&&
this.ia.processAction(M.a.pcg,2);b.YHb!==Ua.a.rg&&b.Zfb===Ua.a.rg&&this.ia.processAction(M.a.tcg,2)}P9a(a){return a&&a[Oo.Value]?a[Oo.Value]:oq.LHc}}oq.Uil="SliderCommandPropertiesValueKey";oq.LHc=3;oq.Yce=[Zd.WA,Zd.$D,Zd.EEa,Zd.I8,Zd.ZD,Zd.Lta,Zd.J8,Zd.FEa];Object(n.a)(oq,"InkRibbonManager",null,[560]);class VF{constructor(a){this.Zoe=a}get tya(){return this.Zoe.tya}DRc(){return this.Zoe.DRc()}rQe(){this.Zoe.rQe()}}Object(n.a)(VF,"PPTChromeExtensionHelper",null,[553,1021]);var Pa=d(526);class Yg{constructor(a,
b){this.populateQueryCommandId=null;this.populateOnlyOnce=!1;this.populateQueryCommandId=a;this.populateOnlyOnce=b}}Object(n.a)(Yg,"MenuPopulationProperties",null,[]);class Xw{constructor(){this.jwc={};this.gwc={};this.pnf={};this.hwc={};this.CAd={};this.DAd={};this.lBd={};this.R3h()}EDa(a){return this.gwc[a]}u5d(a){return this.hwc[a]}p9i(a){return this.CAd[a]}getCommandByExternalUxId(a){return this.jwc[a]}m9d(a){return this.pnf[a]}n_f(a){if(a in this.lBd)return this.lBd[a];ba.ULS.sendTraceTag(39946131,
306,15,"ReactCommandDefinitionMapping.GetExternalIconIdByLegacyIconId: can't find mapping for legacy icon {0}",a);return"MissingIcon_20"}o9i(a){return this.DAd[a]}Ppf(a){this.addCommandToMaps(a)}addCommandToMaps(a){var b=this.jwc[a.externalUxCommand];if(b){delete this.jwc[b.externalUxCommand];const c=this.gwc[b.commandId];for(let h=0;h<c.length;h++)if(c[h].externalUxCommand===b.externalUxCommand){Array.remove(c,c[h]);break}}this.jwc[a.externalUxCommand]=a;b=this.gwc[a.commandId];if(void 0===b||null===
b)b=[],this.gwc[a.commandId]=b;b.push(a);a.legacyControlId&&(this.hwc[a.legacyControlId]||(this.hwc[a.legacyControlId]=new Qa.a),this.hwc[a.legacyControlId].add(a.externalUxCommand))}addTabToMap(a,b){this.pnf[a]=b}addIconToMap(a,b){this.lBd[b]=a}Fi(a){if(a.legacyGroupId){var b=this.CAd[a.legacyGroupId];b||(b=[],this.CAd[a.legacyGroupId]=b);b.push(a)}a.externalUxGroupId&&(b=this.DAd[a.externalUxGroupId],b||(b=[],this.DAd[a.externalUxGroupId]=b),b.push(a))}R3h(){this.addCommandToMaps(Object.assign(new Pa.a("AccessibilityHelp",
"3276527670"),{legacyControlId:"jbtnAccessibilityHelp"}));this.addCommandToMaps(new Pa.a("AlwaysShowRibbon","336231556"));this.addCommandToMaps(new Pa.a("CoauthorsRendered","691867605"));this.addCommandToMaps(Object.assign(new Pa.a("CopyLink","981334692"),{legacyControlId:"CopyLink"}));this.addCommandToMaps(Object.assign(new Pa.a("ShareMenu","336231556"),{legacyControlId:"jbtnFileSharing"}));this.addCommandToMaps(Object.assign(new Pa.a("CatchUpWithChanges","3418267371"),{legacyControlId:"CatchUpWithChanges",
queryCommandId:"1059068017"}));this.addCommandToMaps(Object.assign(new Pa.a("CheckAccessibility","2529583086"),{legacyControlId:"btnOpenAccCheckerPane",queryCommandId:"1949220702"}));this.addCommandToMaps(Object.assign(new Pa.a("ContactSupport","2918242107"),{legacyControlId:"btnContactSupport"}));this.addCommandToMaps(Object.assign(new Pa.a("DocChat","2288458806"),{legacyControlId:"DocChat",queryCommandId:"1478537812"}));this.addCommandToMaps(Object.assign(new Pa.a("DownloadACopy","3555692408"),
{legacyControlId:"jbtnDownloadACopy"}));this.addCommandToMaps(new Pa.a("FileMenuLauncher","1784018444"));this.addCommandToMaps(Object.assign(new Pa.a("GiveFeedback","802602464"),{legacyControlId:"jbtnGiveFeedback"}));this.addCommandToMaps(Object.assign(new Pa.a("Help","1454393937"),{legacyControlId:"jbtnHelp"}));this.addCommandToMaps(new Pa.a("HideRibbon","336231556"));this.addCommandToMaps(new Pa.a("InsertAddIns","1945259303"));this.addCommandToMaps(new Pa.a("InsertMoreAddInsFromFooter","1945259303"));
this.addCommandToMaps(new Pa.a("InsertAddInsFromBackstage","1945259303"));this.addCommandToMaps(new Pa.a("InsertAddinTransitionEntry","1095658066"));this.addCommandToMaps(new Pa.a("InsertComment","2423504651"));this.addCommandToMaps(Object.assign(new Pa.a("InsertComment","2423504651"),{legacyControlId:"btnInsertComment"}));this.addCommandToMaps(new Pa.a("ManageAccess","981334692"));this.addCommandToMaps(new Pa.a("MenuClose","336231556"));this.addCommandToMaps(new Pa.a("MenuOpen","336231556"));this.addCommandToMaps(new Pa.a("MenuPopulate",
"336231556"));this.addCommandToMaps(new Pa.a("MoveToFolder","1182470434"));this.addCommandToMaps(new Pa.a("NavigateToCoauthor","4033456482"));this.addCommandToMaps(new Pa.a("New","1056925771"));this.addCommandToMaps(new Pa.a("NewBrowserSuggestionClicked","3734060499"));this.addCommandToMaps(Object.assign(new Pa.a("NewComment","2423504651"),{legacyControlId:"btnNewComment"}));this.addCommandToMaps(Object.assign(new Pa.a("PeopleWell","929022654"),{queryCommandId:"3798167515",populationProps:new Yg("1285265560",
!1)}));this.addCommandToMaps(Object.assign(new Pa.a("Privacy","1208554566"),{legacyControlId:"jbtnPrivacy"}));this.addCommandToMaps(Object.assign(new Pa.a("Rename","2382951455"),{legacyControlId:"jbtnRenameDialog"}));this.addCommandToMaps(Object.assign(new Pa.a("SaveAs","4246497969"),{legacyControlId:"jbtnSaveACopy"}));this.addCommandToMaps(Object.assign(new Pa.a("SaveAsToHost","2316717900"),{legacyControlId:"jbtnSaveAsToHost"}));this.addCommandToMaps(Object.assign(new Pa.a("SaveToSharePoint","3050207199"),
{legacyControlId:"jbtnSaveToSharePoint"}));this.addCommandToMaps(Object.assign(new Pa.a("SearchHelp","2918242107"),{legacyControlId:"btnHelp"}));this.addCommandToMaps(Object.assign(new Pa.a("Share","981334692"),{legacyControlId:"jbtnFileSharing"}));this.addCommandToMaps(Object.assign(new Pa.a("ShareTopBar","981334692"),{legacyControlId:"jbtnFileSharing"}));this.addCommandToMaps(Object.assign(new Pa.a("SmartLookUp","1435347209"),{legacyControlId:"btnInsights"}));this.addCommandToMaps(new Pa.a("TabSwitch",
"336231556"));this.addCommandToMaps(Object.assign(new Pa.a("TermsOfUse","2349775795"),{legacyControlId:"jbtnTermsOfUse"}));this.addCommandToMaps(Object.assign(new Pa.a("Training","2918242107"),{legacyControlId:"btnShowTraining"}));this.addCommandToMaps(Object.assign(new Pa.a("VersionHistory","3681556347"),{legacyControlId:"jbtnVersion"}));this.addCommandToMaps(Object.assign(new Pa.a("WhatsNew","2918242107"),{legacyControlId:"btnWhatsNew"}));this.addCommandToMaps(Object.assign(new Pa.a("Zoom","1738002952"),
{legacyControlId:"btnViewZoomDialog"}));this.addCommandToMaps(Object.assign(new Pa.a("ToggleRibbonUXDialog","1342108365"),{legacyControlId:"toggleBtnSimpleRibbon",queryCommandId:"1536028887"}));this.addCommandToMaps(new Pa.a("CommitNewDocumentTitle","1808554760"));this.addCommandToMaps(new Pa.a("RibbonModeToggledToMLR","536345575"));this.addCommandToMaps(new Pa.a("RibbonModeToggledToSLR","4031133701"));this.addCommandToMaps(new Pa.a("Workflow","2988588587"));this.addCommandToMaps(new Pa.a("ToggleVNextLook",
"1650341290"));this.addCommandToMaps(Object.assign(new Pa.a("DefinitionsParameterized","2114287254"),{legacyControlId:"btnInsights"}));this.addCommandToMaps(Object.assign(new Pa.a("GetHelpFromTellMe","2918242107"),{legacyControlId:"bSearchHelp"}));this.addCommandToMaps(Object.assign(new Pa.a("GetHelpFromTellMe1","2918242107"),{legacyControlId:"bSearchHelp"}));this.addCommandToMaps(Object.assign(new Pa.a("GetHelpFromTellMe2","2918242107"),{legacyControlId:"bSearchHelp"}));this.addCommandToMaps(Object.assign(new Pa.a("GetHelpWithDescriptionFromTellMe1",
"2918242107"),{legacyControlId:"bSearchHelp"}));this.addCommandToMaps(Object.assign(new Pa.a("GetHelpWithDescriptionFromTellMe2","2918242107"),{legacyControlId:"bSearchHelp"}));this.addCommandToMaps(new Pa.a("AnswerForSearch","1914896509"));this.addCommandToMaps(new Pa.a("AnswerForSearchSingleLine","1914896509"));this.addCommandToMaps(new Pa.a("ReuseFileQuickActionForSearch","1914896509"));this.addCommandToMaps(new Pa.a("PeopleSuggestion1","2133437452"));this.addCommandToMaps(new Pa.a("PeopleSuggestion2",
"2133437453"));this.addCommandToMaps(new Pa.a("PeopleSuggestion3","2133437454"));this.addCommandToMaps(new Pa.a("FileSuggestion1","2260671807"));this.addCommandToMaps(new Pa.a("FileSuggestion2","2260671810"));this.addCommandToMaps(new Pa.a("FileSuggestion3","2260671809"));this.addCommandToMaps(new Pa.a("FileSuggestion4","2260671804"));this.addCommandToMaps(new Pa.a("FileSuggestion5","2260671803"));this.addCommandToMaps(new Pa.a("NotesSuggestion1","1914896509"));this.addCommandToMaps(new Pa.a("NotesSuggestion2",
"1914896509"));this.addCommandToMaps(new Pa.a("NotesSuggestion3","1914896509"));this.addCommandToMaps(new Pa.a("OnenoteNotesSuggestion1","4083547050"));this.addCommandToMaps(new Pa.a("OnenoteNotesSuggestion2","4083547053"));this.addCommandToMaps(new Pa.a("OnenoteNotesSuggestion3","4083547052"));this.addCommandToMaps(new Pa.a("TellMeFeedback","2230755196"));this.addCommandToMaps(new Pa.a("TemplateForSearch","57037313"));this.addCommandToMaps(new Pa.a("AddinSuggestion1","1385019911"));this.addCommandToMaps(new Pa.a("AddinSuggestion2",
"981735384"));this.addCommandToMaps(new Pa.a("AddinSuggestion3","2547819325"));this.addCommandToMaps(new Pa.a("LaunchAddinDialogFromTellMe","1421877154"));u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.hb.RLb?(this.addCommandToMaps(new Pa.a("FindWithMatchesParameterized","1914896509")),this.addCommandToMaps(new Pa.a("FindParameterized","1914896509")),this.addCommandToMaps(new Pa.a("FindInDocumentSuggestion1","1914896509")),this.addCommandToMaps(new Pa.a("FindInDocumentSuggestion2","1914896509")),
this.addCommandToMaps(new Pa.a("FindInDocumentSuggestion3","1914896509"))):(this.addCommandToMaps(new Pa.a("FindWithMatchesParameterized","1540292897")),this.addCommandToMaps(new Pa.a("FindParameterized","1540292897")),this.addCommandToMaps(new Pa.a("FindInDocumentSuggestion1","1540292897")),this.addCommandToMaps(new Pa.a("FindInDocumentSuggestion2","1540292897")),this.addCommandToMaps(new Pa.a("FindInDocumentSuggestion3","1540292897")));this.addCommandToMaps(new Pa.a("ImageForSearch","1914896509"));
this.addCommandToMaps(new Pa.a("LearningForSearch","1006342541"));this.addCommandToMaps(new Pa.a("SmartLookupFromTellMe","1914896509"));this.addCommandToMaps(new Pa.a("SmartLookupFromTellMeQueryTermAtTop","1914896509"));this.addCommandToMaps(new Pa.a("SmartLookupFromTellMeZeroTerm","3359903192"));this.addCommandToMaps(new Pa.a("ActionAIFromTellMe","1914896509"));!u.AFrameworkApplication.MEa||u.AFrameworkApplication.Eya||u.AFrameworkApplication.fa.ka("SmartLookupEnableNativePane")||(this.addCommandToMaps(Object.assign(new Pa.a("SmartLookupFromTellMe",
"3317204163"),{legacyControlId:"btnInsights"})),this.addCommandToMaps(Object.assign(new Pa.a("SmartLookupFromTellMeQueryTermAtTop","3317204163"),{legacyControlId:"btnInsights"})),this.addCommandToMaps(new Pa.a("AnswerForSearch","3317204163")),this.addCommandToMaps(new Pa.a("AnswerForSearchSingleLine","3317204163")));this.addCommandToMaps(Object.assign(new Pa.a("SynonymsParameterized","2114287254"),{legacyControlId:"btnInsights"}));this.addCommandToMaps(new Pa.a("TellMeLogMenuClose","4266170064"));
this.addCommandToMaps(new Pa.a("TellMeLogMenuOpen","2480888384"));this.addCommandToMaps(new Pa.a("TellMeMenuItemExecuted","878547493"));this.addCommandToMaps(new Pa.a("TellMeSearchResultChange","2652476189"));this.addCommandToMaps(new Pa.a("TellMeSuggestion_1","1404166600"));this.addCommandToMaps(new Pa.a("TellMeSuggestion_2","1404166600"));this.addCommandToMaps(new Pa.a("TellMeSuggestion_3","1404166600"));this.addCommandToMaps(new Pa.a("TellMeSuggestion_4","1404166600"));this.addCommandToMaps(new Pa.a("TellMeSuggestion_5",
"1404166600"));this.addCommandToMaps(new Pa.a("TryOfficeUpsell","215809929"));this.addCommandToMaps(Object.assign(new Pa.a("TellMeControl","336231556"),{legacyControlId:"TellMeControl"}));this.addCommandToMaps(Object.assign(new Pa.a("DiagnosticsSection","336231556"),{legacyControlId:"AboutInformationMenuSectionDiagnostics"}));this.addCommandToMaps(Object.assign(new Pa.a("FileAboutPage","336231556"),{legacyControlId:"faAbout"}));this.addCommandToMaps(Object.assign(new Pa.a("FileHelpPage","336231556"),
{legacyControlId:"faHelp"}));this.addCommandToMaps(Object.assign(new Pa.a("FileHomePage","2074131365"),{legacyControlId:"faHome"}));this.addCommandToMaps(Object.assign(new Pa.a("FileGetAddinsPage","336231556"),{legacyControlId:"faGetAddinsFromBackstage"}));this.addCommandToMaps(Object.assign(new Pa.a("FileInfoPage","336231556"),{legacyControlId:"faInfo"}));this.addCommandToMaps(Object.assign(new Pa.a("FileNewPage","2074131365"),{legacyControlId:"faNew"}));this.addCommandToMaps(Object.assign(new Pa.a("FileOpenPage",
"2799130311"),{legacyControlId:"faOpen"}));this.addCommandToMaps(Object.assign(new Pa.a("FilePrintPage","336231556"),{legacyControlId:"faPrint"}));this.addCommandToMaps(Object.assign(new Pa.a("FileSaveAsPage","336231556"),{legacyControlId:"faSaveAs"}));this.addCommandToMaps(Object.assign(new Pa.a("FileSharePage","336231556"),{legacyControlId:"faShare"}));this.addCommandToMaps(Object.assign(new Pa.a("FileTransformPage","336231556"),{legacyControlId:"faTransform"}));this.addCommandToMaps(new Pa.a("NewDocument",
"1056925771"));this.addCommandToMaps(new Pa.a("OpenUrlInNewTab","1959943459"));this.addCommandToMaps(new Pa.a("OpenDocumentUrl","2155708348"));this.addCommandToMaps(Object.assign(new Pa.a("ReplyWithChanges","1197060601"),{legacyControlId:"jbtnShareRWC"}));this.addCommandToMaps(Object.assign(new Pa.a("ReportAbuse","3237171630"),{legacyControlId:"jbtnReportAbuse"}));this.addCommandToMaps(Object.assign(new Pa.a("ThirdPartyNotices","2220417879"),{legacyControlId:"jbtnThirdPartyNotices"}));this.addCommandToMaps(Object.assign(new Pa.a("TrustCenter",
"2583751502"),{legacyControlId:"jbtnTrustCenter"}));this.addCommandToMaps(Object.assign(new Pa.a("TryOfficeForWordEditor","1773624819"),{legacyControlId:"btnjTryMacOfficeForWordEditor"}));this.addCommandToMaps(Object.assign(new Pa.a("TryMacOfficeForWordEditor","3901198658"),{legacyControlId:"btnjTryOfficeForWordEditor"}));this.addCommandToMaps(Object.assign(new Pa.a("PreviousVersions","466976539"),{legacyControlId:"btnjVersionHistory"}));this.addCommandToMaps(Object.assign(new Pa.a("FileVersionHistory",
"466976539"),{legacyControlId:"btnjVersionHistory"}));this.addCommandToMaps(Object.assign(new Pa.a("FilePreviousVersions","3681556347"),{legacyControlId:"jbtnVersion"}));this.addCommandToMaps(Object.assign(new Pa.a("HostConversation","710925581"),{legacyControlId:"HostConversation"}));this.addCommandToMaps(Object.assign(new Pa.a("HostClose","3033402446"),{legacyControlId:"HostClose"}));this.addCommandToMaps(Object.assign(new Pa.a("HostDownload","3555692408"),{legacyControlId:"HostDownload"}));this.addCommandToMaps(Object.assign(new Pa.a("HostOpenInBrowser",
"2596942163"),{legacyControlId:"HostOpenInBrowser"}));this.addCommandToMaps(Object.assign(new Pa.a("HostMoreOptions","336231556"),{legacyControlId:"HostMoreOptions"}));this.addCommandToMaps(Object.assign(new Pa.a("Sensitivity","941487903"),{legacyControlId:"flySensitivity",queryCommandId:"3134802707",populationProps:new Yg("1145315516",!0)}));this.addCommandToMaps(Object.assign(new Pa.a("InsertAddInFlyout","2749373765"),{populationProps:new Yg("1230970894",!1)}));this.addCommandToMaps(Object.assign(new Pa.a("ReloadAddInPicker",
"2502873265"),{populationProps:new Yg("1230970894",!1)}));this.addCommandToMaps(Object.assign(new Pa.a("OpenDocumentLabelPane","3427834559"),{queryCommandId:"497870830"}));this.addCommandToMaps(new Pa.a("FreemiumUpsellEligible","1274543852"));this.addCommandToMaps(new Pa.a("FreemiumUpsellDialogShowUI","4180531998"));this.addCommandToMaps(new Pa.a("ReportFreemiumUpsellEligibleDisplayed","2539564555"));this.addCommandToMaps(new Pa.a("HandleDiscoverPremiumButtonClick","2280081216"));this.addCommandToMaps(new Pa.a("RequestFontInfo",
"3169500754"));this.addCommandToMaps(new Pa.a("PinOrUnpinFont","1500655301"));this.addCommandToMaps(new Pa.a("FontPickerMenuClose","146595126"));this.addCommandToMaps(new Pa.a("ShowAccessibilitySettingsDialog","2236763780"));this.addCommandToMaps(Object.assign(new Pa.a("ShowZoomDialog","1738002952"),{queryCommandId:"433063458",legacyControlId:"buttonShowZoomDialog"}));this.addCommandToMaps(Object.assign(new Pa.a("ZoomToPercentage","3745693956"),{queryCommandId:"2901130581",legacyControlId:"ZoomSlider"}));
this.addCommandToMaps(new Pa.a("ZoomToPercentageCompleted","3139946409"));this.addCommandToMaps(Object.assign(new Pa.a("RecentLinks","2535492938"),{queryCommandId:"2535492938",populationProps:new Yg("860679239",!1)}));this.addCommandToMaps(Object.assign(new Pa.a("InsertLinkFlyout","1052791248"),{queryCommandId:"1052791248",populationProps:new Yg("276140882",!1)}))}}Object(n.a)(Xw,"ReactCommandDefinitionMapping",null,[1528]);class fg{constructor(a){this.externalUxCommandIds=this.commandId=this.externalUxGroupId=
this.legacyGroupId=null;this.legacyGroupId=a}}Object(n.a)(fg,"GroupMetadata",null,[]);class UA extends Xw{constructor(a){super();this.R3j="AnimationNone AnimationAppear AnimationFadeIn AnimationFlyIn AnimationSplit AnimationWipe AnimationRandomBars AnimationGrowAndTurn AnimationZoom AnimationBasicZoom AnimationBlinds AnimationBox AnimationCheckerboard AnimationExpand AnimationPeekIn AnimationRiseUp AnimationStretch AnimationStrips AnimationEmphasis_Spin AnimationEmphasis_GrowShrink AnimationEmphasis_Transparency AnimationEmphasis_LineColor AnimationEmphasis_FillColor AnimationEmphasis_FontColor AnimationExit_Disappear AnimationExit_Fade AnimationExit_FlyOut AnimationExit_Split AnimationExit_Wipe AnimationExit_RandomBars AnimationExit_Zoom AnimationExit_BasicZoom AnimationExit_Blinds AnimationExit_Box AnimationExit_Checkerboard AnimationExit_PeekOut AnimationExit_Stretchy AnimationExit_Strips AnimationGalleryNone AnimationGalleryEntrance AnimationGalleryEmphasis AnimationGalleryExit".split(" ");
this.O3j=26;this.N3j="AnimationEffectOptionsDataSpin_Quarter AnimationEffectOptionsDataSpin_Half AnimationEffectOptionsDataSpin_Full AnimationEffectOptionsDataSpin_Two AnimationEffectOptionsDataTransparency_25 AnimationEffectOptionsDataTransparency_50 AnimationEffectOptionsDataTransparency_75 AnimationEffectOptionsDataTransparency_100 AnimationEffectOptionsDataGrowShrink_Tiny AnimationEffectOptionsDataGrowShrink_Smaller AnimationEffectOptionsDataGrowShrink_Larger AnimationEffectOptionsDataGrowShrink_Huge".split(" ");
this.Q3j=31;this.P3j="AnimationEffectOptionsDirectionFromBottom AnimationEffectOptionsDirectionFromBottomLeft AnimationEffectOptionsDirectionFromLeft AnimationEffectOptionsDirectionFromTopLeft AnimationEffectOptionsDirectionFromTop AnimationEffectOptionsDirectionFromTopRight AnimationEffectOptionsDirectionFromRight AnimationEffectOptionsDirectionFromBottomRight AnimationEffectOptionsDirectionToBottom AnimationEffectOptionsDirectionToBottomLeft AnimationEffectOptionsDirectionToLeft AnimationEffectOptionsDirectionToTopLeft AnimationEffectOptionsDirectionToTop AnimationEffectOptionsDirectionToTopRight AnimationEffectOptionsDirectionToRight AnimationEffectOptionsDirectionToBottomRight AnimationEffectOptionsDirectionHorizontal AnimationEffectOptionsDirectionHorizontalIn AnimationEffectOptionsDirectionHorizontalOut AnimationEffectOptionsDirectionVertical AnimationEffectOptionsDirectionVerticalIn AnimationEffectOptionsDirectionVerticalOut AnimationEffectOptionsDirectionLeftDown AnimationEffectOptionsDirectionLeftUp AnimationEffectOptionsDirectionRightDown AnimationEffectOptionsDirectionRightUp AnimationEffectOptionsDirectionIn AnimationEffectOptionsDirectionInBottom AnimationEffectOptionsDirectionInCenter AnimationEffectOptionsDirectionInSlightly AnimationEffectOptionsDirectionOut AnimationEffectOptionsDirectionOutBottom AnimationEffectOptionsDirectionOutCenter AnimationEffectOptionsDirectionOutSlightly AnimationEffectOptionsDirectionFloatUp AnimationEffectOptionsDirectionFloatDown AnimationEffectOptionsDirectionObjectCenter AnimationEffectOptionsDirectionSlideCenter AnimationEffectOptionsDirectionObjectCenterOut AnimationEffectOptionsDirectionSlideCenterOut AnimationEffectOptionsDirectionClockwise AnimationEffectOptionsDirectionCounterClockwise AnimationEffectOptionsDirectionAcross AnimationEffectOptionsDirectionUp AnimationEffectOptionsDirectionDown AnimationEffectOptionsDirectionGrowShrinkHorizontal AnimationEffectOptionsDirectionGrowShrinkVertical AnimationEffectOptionsDirectionGrowShrinkBoth".split(" ");
this.Bdk=23;this.Adk="TransitionEffectOptionsTransitionExisting TransitionEffectOptionsTransitionExistingInMenu TransitionEffectOptionsTransitionNone TransitionEffectOptionsTransitionFade TransitionEffectOptionsTransitionFadeSmoothly TransitionEffectOptionsTransitionFadeThroughBlack TransitionEffectOptionsTransitionPush TransitionEffectOptionsTransitionPushFromBottom TransitionEffectOptionsTransitionPushFromLeft TransitionEffectOptionsTransitionPushFromRight TransitionEffectOptionsTransitionPushFromTop TransitionEffectOptionsTransitionCut TransitionEffectOptionsTransitionCutNone TransitionEffectOptionsTransitionCutThroughBlack TransitionEffectOptionsTransitionWipe TransitionEffectOptionsTransitionWipeFromRight TransitionEffectOptionsTransitionWipeFromTop TransitionEffectOptionsTransitionWipeFromLeft TransitionEffectOptionsTransitionWipeFromBottom TransitionEffectOptionsTransitionWipeFromTopRight TransitionEffectOptionsTransitionWipeFromBottomRight TransitionEffectOptionsTransitionWipeFromTopLeft TransitionEffectOptionsTransitionWipeFromBottomLeft TransitionEffectOptionsTransitionMorph TransitionEffectOptionsTransitionMorphByObject TransitionEffectOptionsTransitionMorphByWord TransitionEffectOptionsTransitionMorphByChar TransitionEffectOptionsTransitionSplit TransitionEffectOptionsTransitionSplitVerticalOut TransitionEffectOptionsTransitionSplitHorizontalIn TransitionEffectOptionsTransitionSplitHorizontalOut TransitionEffectOptionsTransitionSplitVerticalIn TransitionEffectOptionsTransitionRandom TransitionEffectOptionsTransitionRandomBars TransitionEffectOptionsTransitionRandomBarsVertical TransitionEffectOptionsTransitionRandomBarsHorizontal TransitionEffectOptionsTransitionShape TransitionEffectOptionsTransitionShapeCircle TransitionEffectOptionsTransitionShapeDiamond TransitionEffectOptionsTransitionShapePlus TransitionEffectOptionsTransitionShapeIn TransitionEffectOptionsTransitionShapeOut TransitionEffectOptionsTransitionCombHorizontal TransitionEffectOptionsTransitionCombVertical TransitionEffectOptionsTransitionWheelClockwise TransitionEffectOptionsTransitionWheelCounterclockwise TransitionEffectOptionsTransitionWheelWedge TransitionEffectOptionsTransitionRevealFromLeft TransitionEffectOptionsTransitionRevealFromRight TransitionEffectOptionsTransitionRevealSmoothlyFromLeft TransitionEffectOptionsTransitionRevealSmoothlyFromRight TransitionEffectOptionsTransitionDissolve TransitionEffectOptionsTransitionBlindsHorizontal TransitionEffectOptionsTransitionBlindsVertical TransitionEffectOptionsTransitionCurtains TransitionEffectOptionsTransitionCoverFromBottom TransitionEffectOptionsTransitionCoverFromBottomLeft TransitionEffectOptionsTransitionCoverFromBottomRight TransitionEffectOptionsTransitionCoverFromLeft TransitionEffectOptionsTransitionCoverFromRight TransitionEffectOptionsTransitionCoverFromTop TransitionEffectOptionsTransitionCoverFromTopLeft TransitionEffectOptionsTransitionCoverFromTopRight TransitionEffectOptionsTransitionUncoverFromBottom TransitionEffectOptionsTransitionUncoverFromBottomLeft TransitionEffectOptionsTransitionUncoverFromBottomRight TransitionEffectOptionsTransitionUncoverFromLeft TransitionEffectOptionsTransitionUncoverFromRight TransitionEffectOptionsTransitionUncoverFromTop TransitionEffectOptionsTransitionUncoverFromTopLeft TransitionEffectOptionsTransitionUncoverFromTopRight TransitionEffectOptionsTransitionRippleCenter TransitionEffectOptionsTransitionRippleBottomLeft TransitionEffectOptionsTransitionRippleBottomRight TransitionEffectOptionsTransitionRippleTopRight TransitionEffectOptionsTransitionRippleTopLeft TransitionEffectOptionsTransitionCubeFromBottom TransitionEffectOptionsTransitionCubeFromLeft TransitionEffectOptionsTransitionCubeFromRight TransitionEffectOptionsTransitionCubeFromTop TransitionEffectOptionsTransitionBoxFromBottom TransitionEffectOptionsTransitionBoxFromLeft TransitionEffectOptionsTransitionBoxFromRight TransitionEffectOptionsTransitionBoxFromTop TransitionEffectOptionsTransitionSwitchLeft TransitionEffectOptionsTransitionSwitchRight TransitionEffectOptionsTransitionFallOverLeft TransitionEffectOptionsTransitionFallOverRight TransitionEffectOptionsTransitionDrapeLeft TransitionEffectOptionsTransitionDrapeRight TransitionEffectOptionsTransitionFlipLeft TransitionEffectOptionsTransitionFlipRight TransitionEffectOptionsTransitionWindLeft TransitionEffectOptionsTransitionWindRight TransitionEffectOptionsTransitionPrestige TransitionEffectOptionsTransitionFracture TransitionEffectOptionsTransitionCrush TransitionEffectOptionsTransitionPeelOffLeft TransitionEffectOptionsTransitionPeelOffRight TransitionEffectOptionsTransitionPageCurlSingleLeft TransitionEffectOptionsTransitionPageCurlSingleRight TransitionEffectOptionsTransitionPageCurlDoubleLeft TransitionEffectOptionsTransitionPageCurlDoubleRight TransitionEffectOptionsTransitionAirplaneLeft TransitionEffectOptionsTransitionAirplaneRight TransitionEffectOptionsTransitionOrigamiLeft TransitionEffectOptionsTransitionOrigamiRight TransitionEffectOptionsTransitionCheckerFromLeft TransitionEffectOptionsTransitionCheckerFromTop TransitionEffectOptionsTransitionVortexFromLeft TransitionEffectOptionsTransitionVortexFromTop TransitionEffectOptionsTransitionVortexFromRight TransitionEffectOptionsTransitionVortexFromBottom TransitionEffectOptionsTransitionCurtains TransitionEffectOptionsTransitionGlitterHexagonLeft TransitionEffectOptionsTransitionGlitterHexagonTop TransitionEffectOptionsTransitionGlitterHexagonRight TransitionEffectOptionsTransitionGlitterHexagonBottom TransitionEffectOptionsTransitionGlitterDiamondLeft TransitionEffectOptionsTransitionGlitterDiamondTop TransitionEffectOptionsTransitionGlitterDiamondRight TransitionEffectOptionsTransitionGlitterDiamondBottom TransitionEffectOptionsTransitionOrbitFromTop TransitionEffectOptionsTransitionOrbitFromBottom TransitionEffectOptionsTransitionOrbitFromLeft TransitionEffectOptionsTransitionOrbitFromRight TransitionEffectOptionsTransitionRotateFromTop TransitionEffectOptionsTransitionRotateFromBottom TransitionEffectOptionsTransitionRotateFromLeft TransitionEffectOptionsTransitionRotateFromRight TransitionEffectOptionsTransitionConveyorFromRight TransitionEffectOptionsTransitionConveyorFromLeft TransitionEffectOptionsTransitionGalleryIconFromRight TransitionEffectOptionsTransitionGalleryIconFromLeft TransitionEffectOptionsTransitionPanFromBottom TransitionEffectOptionsTransitionPanFromLeft TransitionEffectOptionsTransitionPanFromRight TransitionEffectOptionsTransitionPanFromTop TransitionEffectOptionsTransitionDoorsVertical TransitionEffectOptionsTransitionDoorsHorizontal TransitionEffectOptionsTransitionWindowVertical TransitionEffectOptionsTransitionWindowHorizontal TransitionEffectOptionsTransitionZoomIn TransitionEffectOptionsTransitionZoomOut TransitionEffectOptionsTransitionZoomAndRotate TransitionEffectOptionsTransitionFlyThroughIn TransitionEffectOptionsTransitionFlyThroughOut TransitionEffectOptionsTransitionFlyThroughInWithBounce TransitionEffectOptionsTransitionFlyThroughOutWithBounce".split(" ");
this.$$j="PictureStyles_SimpleFrameWhite_15505 PictureStyles_BeveledMatteWhite_15506 PictureStyles_MetalFrame_15507 PictureStyles_DropShadowRectangle_15508 PictureStyles_ReflectedRoundedRectangle_15509 PictureStyles_SoftEdgeRectangle_15510 PictureStyles_DoubleFrameBlack_15511 PictureStyles_ThickMatteBlack_15512 PictureStyles_SimpleFrameBlack_15513 PictureStyles_BeveledOvalBlack_15514 PictureStyles_CompoundFrameBlack_15515 PictureStyles_ModerateFrameBlack_15516 PictureStyles_CenterShadowRectangle_15517 PictureStyles_RoundedDiagonalCornerWhite_15518 PictureStyles_SnipDiagonalCornerWhite_15519 PictureStyles_ModerateFrameWhite_15520 PictureStyles_RotatedWhite_15521 PictureStyles_PerspectiveShadowWhite_15522 PictureStyles_RelaxedPerspectiveWhite_15523 PictureStyles_SoftEdgeOval_15524 PictureStyles_BevelEdgeRectangle_15525 PictureStyles_BevelPerspective_15526 PictureStyles_ReflectedPerspectiveRight_15527 PictureStyles_BevelPerspectiveLeftWhite_15528 PictureStyles_ReflectedBevelBlack_15529 PictureStyles_ReflectedBevelWhite_15530 PictureStyles_MetalRoundedRectangle_15531 PictureStyles_MetalOval_15532".split(" ");
this.Z$j="PictureCrop_ShapeAlternateProcess_126 PictureCrop_ShapeArc_84 PictureCrop_ShapeBentArrow_28 PictureCrop_ShapeBentUpArrow_31 PictureCrop_ShapeBevel_74 PictureCrop_ShapeBlockArc_77 PictureCrop_ShapeCan_7 PictureCrop_ShapeCard_139 PictureCrop_ShapeChevron_38 PictureCrop_ShapeChord_66 PictureCrop_ShapeCircularArrow_45 PictureCrop_ShapeCloud_83 PictureCrop_ShapeCloudCallout_93 PictureCrop_ShapeCollate_143 PictureCrop_ShapeConnector_137 PictureCrop_ShapeCross_72 PictureCrop_ShapeCube_8 PictureCrop_ShapeCurvedArrowConnector_153 PictureCrop_ShapeCurvedConnector_25 PictureCrop_ShapeCurvedDoubleArrowConnector_154 PictureCrop_ShapeCurvedDownArrow_46 PictureCrop_ShapeCurvedDownRibbon_120 PictureCrop_ShapeCurvedLeftArrow_33 PictureCrop_ShapeCurvedRightArrow_32 PictureCrop_ShapeCurvedUpArrow_34 PictureCrop_ShapeCurvedUpRibbon_119 PictureCrop_ShapeData_128 PictureCrop_ShapeDecagon_63 PictureCrop_ShapeDecision_127 PictureCrop_ShapeDelay_148 PictureCrop_ShapeDiagonalStripe_71 PictureCrop_ShapeDiamond_58 PictureCrop_ShapeDirectAccessStorage_151 PictureCrop_ShapeDisplay_152 PictureCrop_ShapeDocument_131 PictureCrop_ShapeDodecagon_64 PictureCrop_ShapeDonut_75 PictureCrop_ShapeDoubleBrace_86 PictureCrop_ShapeDoubleBracket_85 PictureCrop_ShapeDoubleWave_124 PictureCrop_ShapeDownArrow_0 PictureCrop_ShapeDownArrowCallout_40 PictureCrop_ShapeDownRibbon_118 PictureCrop_ShapeElbowArrowConnector_155 PictureCrop_ShapeElbowConnector_26 PictureCrop_ShapeElbowDoubleArrowConnector_156 PictureCrop_ShapeEllipse_9 PictureCrop_ShapeExplosion1_106 PictureCrop_ShapeExplosion2_107 PictureCrop_ShapeExtract_145 PictureCrop_ShapeFoldedCorner_78 PictureCrop_ShapeFrame_68 PictureCrop_ShapeGallery PictureCrop_ShapeHalfFrame_69 PictureCrop_ShapeHeart_18 PictureCrop_ShapeHeptagon_61 PictureCrop_ShapeHexagon_60 PictureCrop_ShapeHorizontalScroll_122 PictureCrop_ShapeInternalStorage_130 PictureCrop_ShapeLeftArrow_1 PictureCrop_ShapeLeftArrowCallout_41 PictureCrop_ShapeLeftBrace_89 PictureCrop_ShapeLeftBracket_87 PictureCrop_ShapeLeftRightArrow_2 PictureCrop_ShapeLeftRightArrowCallout_43 PictureCrop_ShapeLeftRightUpArrow_27 PictureCrop_ShapeLeftUpArrow_30 PictureCrop_ShapeLightningBolt_80 PictureCrop_ShapeLineCallout1_94 PictureCrop_ShapeLShape_70 PictureCrop_ShapeMagneticDisk_150 PictureCrop_ShapeManualInput_135 PictureCrop_ShapeManualOperation_136 PictureCrop_ShapeMathDivide_22 PictureCrop_ShapeMathEqual_23 PictureCrop_ShapeMathMinus_20 PictureCrop_ShapeMathMultiply_21 PictureCrop_ShapeMathNotEqual_24 PictureCrop_ShapeMathPlus_19 PictureCrop_ShapeMerge_146 PictureCrop_ShapeMoon_82 PictureCrop_ShapeMultidocument_132 PictureCrop_ShapeNoSymbol_76 PictureCrop_ShapeNotchedRightArrow_36 PictureCrop_ShapeOctagon_62 PictureCrop_ShapeOffpageConnector_138 PictureCrop_ShapeOr_142 PictureCrop_ShapeOvalCallout_92 PictureCrop_ShapeParallelogram_56 PictureCrop_ShapePentagon_37 PictureCrop_ShapePie_65 PictureCrop_ShapePlaque_73 PictureCrop_ShapePredefinedProcess_129 PictureCrop_ShapePreparation_134 PictureCrop_ShapeProcess_125 PictureCrop_ShapePunchedTape_140 PictureCrop_ShapeQuadArrow_47 PictureCrop_ShapeQuadArrowCallout_44 PictureCrop_ShapeRectangle_10 PictureCrop_ShapeRectangularCallout_91 PictureCrop_ShapeRightArrow_3 PictureCrop_ShapeRightArrowCallout_39 PictureCrop_ShapeRightBrace_90 PictureCrop_ShapeRightBracket_88 PictureCrop_ShapeRightTriangle_55 PictureCrop_ShapeRoundDiagonalCornerRectangle_48 PictureCrop_ShapeRoundedRectangle_11 PictureCrop_ShapeRoundedRectangleCallout_6 PictureCrop_ShapeRoundSameSideCornerRectangle_49 PictureCrop_ShapeRoundSingleCornerRectangle_50 PictureCrop_ShapeSequentialActionStorage PictureCrop_ShapeSequentialActionStorage_149 PictureCrop_ShapeSmileyFace_79 PictureCrop_ShapeSnipDiagonalCornerRectangle_52 PictureCrop_ShapeSnipRoundSingleCornerRectangle_51 PictureCrop_ShapeSnipSameSideCornerRectangle_53 PictureCrop_ShapeSnipSingleCornerRectangle_54 PictureCrop_ShapeSort_144 PictureCrop_ShapeSPentagon_59 PictureCrop_ShapeStar10_112 PictureCrop_ShapeStar12_113 PictureCrop_ShapeStar16_114 PictureCrop_ShapeStar24_115 PictureCrop_ShapeStar32_116 PictureCrop_ShapeStar4_108 PictureCrop_ShapeStar5_15 PictureCrop_ShapeStar6_109 PictureCrop_ShapeStar7_110 PictureCrop_ShapeStar8_111 PictureCrop_ShapeStoredData_147 PictureCrop_ShapeStraightConnector_12 PictureCrop_ShapeStraightConnectorArrow_13 PictureCrop_ShapeStraightConnectorTwoArrow_14 PictureCrop_ShapeStripedRightArrow_35 PictureCrop_ShapeSummingJunction_141 PictureCrop_ShapeSun_81 PictureCrop_ShapeTeardrop_67 PictureCrop_ShapeTerminator_133 PictureCrop_ShapeTrapezoid_57 PictureCrop_ShapeTriangle_17 PictureCrop_ShapeUpArrow_4 PictureCrop_ShapeUpArrowCallout_42 PictureCrop_ShapeUpDownArrow_5 PictureCrop_ShapeUpRibbon_117 PictureCrop_ShapeUTurnArrow_29 PictureCrop_ShapeVerticalScroll_121 PictureCrop_ShapeWave_123".split(" ");
this.B6j=["FormatBackgroundStandardColorsFromCanvas","FormatBackgroundThemeColorsFromCanvas","FormatBackgroundThemeColorsMCUFromCanvas"];this.wTg="SmartArtLayouts__orgChart1__hierarchy SmartArtLayouts__hList1__list SmartArtLayouts__vList2__list SmartArtLayouts__hierarchy1__hierarchy SmartArtLayouts__chevron2__process SmartArtLayouts__process3__process SmartArtLayouts__hProcess4__process SmartArtLayouts__process5__process SmartArtLayouts__default__list SmartArtLayouts__chevron1__process SmartArtLayouts__cycle2__cycle SmartArtLayouts__process1__process SmartArtLayouts__pyramid1__pyramid SmartArtLayouts__hProcess11__process SmartArtLayouts__cycle5__cycle SmartArtLayouts__lProcess3__process SmartArtLayouts__bProcess2__process SmartArtLayouts__hChevron3__process SmartArtLayouts__hProcess3__process SmartArtLayouts__hProcess9__process SmartArtLayouts__cycle3__cycle SmartArtLayouts__arrow5__relationship SmartArtLayouts__hProcess7__process SmartArtLayouts__arrow1__relationship SmartArtLayouts__equation1__relationship SmartArtLayouts__lProcess2__list SmartArtLayouts__hierarchy3__hierarchy SmartArtLayouts__hierarchy2__hierarchy SmartArtLayouts__hierarchy5__hierarchy SmartArtLayouts__pyramid3__pyramid SmartArtLayouts__hierarchy6__hierarchy SmartArtLayouts__venn3__relationship SmartArtLayouts__cycle7__cycle SmartArtLayouts__cycle6__cycle SmartArtLayouts__hProcess6__process SmartArtLayouts__lProcess1__process SmartArtLayouts__pyramid2__pyramid SmartArtLayouts__radial2__relationship SmartArtLayouts__bProcess3__process SmartArtLayouts__process4__process SmartArtLayouts__hList9__list SmartArtLayouts__hierarchy4__hierarchy SmartArtLayouts__hList3__list SmartArtLayouts__cycle1__cycle SmartArtLayouts__hList6__list SmartArtLayouts__arrow2__process SmartArtLayouts__vList6__process SmartArtLayouts__bProcess4__process SmartArtLayouts__list1__list SmartArtLayouts__equation2__relationship SmartArtLayouts__process2__process SmartArtLayouts__BasicTimeline__timeline SmartArtLayouts__HexagonTimeline__timeline SmartArtLayouts__RoundedRectangleTimeline__timeline SmartArtLayouts__DropPinTimeline__timeline SmartArtLayouts__HorizontalLabelsTimeline__timeline SmartArtLayouts__HorizontalPathTimeline__timeline SmartArtLayouts__AccentHomeChevronProcess__timeline".split(" ");
this.la=a;this.XMd();this.l4h();this.V3h();this.U3h();this.Y3h();this.a4h();this.c4h();this.k4h();this.d4h();this.$3h();this.X3h();this.h4h();this.e4h();this.f4h();this.j4h();this.HNd();this.Y4h();this.i4h();this.f5h();this.S3h();this.Z3h();this.W3h();this.T3h();this.b4h();this.g4h()}f5h(){this.addIconToMap("CheckMark_20","per_QuickSearchCompletedToday_16x16x32");this.addIconToMap("Info_20","per_Info_16x16x32")}XMd(){this.addCommandToMaps(new Pa.a("AddSection",M.a.I5a.toString()));this.addCommandToMaps(new Pa.a("AlternativeText",
M.a.Wqb.toString()));this.addCommandToMaps(new Pa.a("AlignAnchor",M.a.Otf.toString()));this.addCommandToMaps(Object.assign(new Pa.a("AlwaysUseSubtitles",M.a.HLa.toString()),{legacyControlId:"AlwaysUseSubtitles",queryCommandId:M.a.BZa.toString()}));this.addCommandToMaps(new Pa.a("ArrangeAnchor",M.a.srb.toString()));this.addCommandToMaps(Object.assign(new Pa.a("AudioSettings",M.a.mpd.toString()),{queryCommandId:M.a.NIb.toString()}));this.addCommandToMaps(new Pa.a("LivePollTaskPane",M.a.opd.toString()));
this.addCommandToMaps(new Pa.a("ArrangeShapeAnchor",M.a.srb.toString()));this.addCommandToMaps(new Pa.a("BeginEditShapeText",M.a.Grb.toString()));this.addCommandToMaps(Object.assign(new Pa.a("Bold",M.a.yHb.toString()),{queryCommandId:M.a.yIb.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("BottomOverlaid",M.a.ENb.toString()),{legacyControlId:"PptRibbon.View.Subtitles.SubtitlesPositionBottomOverlay",queryCommandId:M.a.Khb.toString()}));this.addCommandToMaps(new Pa.a("BringToFrontFlyout",
M.a.Vxf.toString()));this.addCommandToMaps(new Pa.a("BringForward",M.a.bringForward.toString()));this.addCommandToMaps(new Pa.a("BringToFront",M.a.bringToFront.toString()));this.addCommandToMaps(Object.assign(new Pa.a("BulletLibrary",M.a.yna.toString()),{legacyControlId:"PptRibbon.Home.Paragraph.BulletGallery",queryCommandId:M.a.zIb.toString(),populationProps:new Yg(M.a.slc.toString(),!1)}));this.addCommandToMaps(Object.assign(new Pa.a("CatchUpWithChanges",H.a.ABh.toString()),{legacyControlId:"CatchUpWithChanges",
queryCommandId:H.a.ldh.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("ChangeCaseCapitalizeEachWord",D.a.w6a.toString()),{legacyControlId:"PptRibbon.Home.Font.ChangeCase.Capitalization"}));this.addCommandToMaps(Object.assign(new Pa.a("ChangeCaseLower",D.a.Bsb.toString()),{legacyControlId:"PptRibbon.Home.Font.ChangeCase.Lower"}));this.addCommandToMaps(Object.assign(new Pa.a("ChangeCaseMenuEnabled",M.a.TBf.toString()),{legacyControlId:"PptRibbon.Home.Font.ChangeCase"}));this.addCommandToMaps(Object.assign(new Pa.a("ChangeCaseSentence",
D.a.JZb.toString()),{legacyControlId:"PptRibbon.Home.Font.ChangeCase.SentenceCase"}));this.addCommandToMaps(Object.assign(new Pa.a("ChangeCaseToggle",D.a.KZb.toString()),{legacyControlId:"PptRibbon.Home.Font.ChangeCase.ToggleCase"}));this.addCommandToMaps(Object.assign(new Pa.a("ChangeCaseUpper",D.a.Csb.toString()),{legacyControlId:"PptRibbon.Home.Font.ChangeCase.Upper"}));this.addCommandToMaps(new Pa.a("ChangeLayout",M.a.Jia.toString()));this.addCommandToMaps(Object.assign(new Pa.a("ChangeGraphicContextMenu",
M.a.cTd.toString()),{legacyControlId:"PptRibbon.Graphics.ContextMenu.FlyChangeGraphic"}));this.addCommandToMaps(Object.assign(new Pa.a("ChangeGraphicFlyout",M.a.cTd.toString()),{legacyControlId:"PptRibbon.Graphics.ShapeStyles.FlyChangeGraphic"}));this.addCommandToMaps(Object.assign(new Pa.a("ChangePicture",M.a.BIc.toString()),{legacyControlId:"PptRibbon.PictureFormat.Adjust.ChangePicture"}));this.addCommandToMaps(Object.assign(new Pa.a("ChangePictureContextMenu",M.a.hTd.toString()),{legacyControlId:"PptRibbon.Pictures.ContextMenu.FlyChangePicture"}));
this.addCommandToMaps(Object.assign(new Pa.a("ChangePictureContextMenuBing",M.a.NZb.toString()),{legacyControlId:"PptRibbon.Pictures.ContextMenu.FlyChangePicture.FromSearch"}));this.addCommandToMaps(Object.assign(new Pa.a("ChangePictureContextMenuM365",M.a.Esb.toString()),{legacyControlId:"PptRibbon.Pictures.ContextMenu.FlyChangePicture.FromM365Picture"}));this.addCommandToMaps(Object.assign(new Pa.a("ChangePictureContextMenuIcons",M.a.x6a.toString()),{legacyControlId:"PptRibbon.Pictures.ContextMenu.FlyChangePicture.FromM365Icon"}));
this.addCommandToMaps(Object.assign(new Pa.a("ChangePictureContextMenuDevice",M.a.BIc.toString()),{legacyControlId:"PptRibbon.Pictures.ContextMenu.FlyChangePicture.FromDevice"}));this.addCommandToMaps(Object.assign(new Pa.a("ChangePictureContextMenuOneDrive",M.a.OZb.toString()),{legacyControlId:"PptRibbon.Pictures.ContextMenu.FlyChangePicture.FromHost",queryCommandId:M.a.imc.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("ChangePictureContextMenuMobileDevice",M.a.QZb.toString()),{legacyControlId:"ChangePictureFromMobileDevice"}));
this.addCommandToMaps(Object.assign(new Pa.a("ChangePictureFlyout",M.a.hTd.toString()),{legacyControlId:"PptRibbon.PictureFormat.Adjust.FlyChangePicture"}));this.addCommandToMaps(Object.assign(new Pa.a("ChangePictureFlyoutBing",M.a.NZb.toString()),{legacyControlId:"PptRibbon.PictureFormat.Adjust.FlyChangePicture.FromSearch"}));this.addCommandToMaps(Object.assign(new Pa.a("ChangePictureFlyoutM365",M.a.Esb.toString()),{legacyControlId:"PptRibbon.PictureFormat.Adjust.FlyChangePicture.FromM365Picture"}));
this.addCommandToMaps(Object.assign(new Pa.a("ChangePictureFlyoutIcons",M.a.x6a.toString()),{legacyControlId:"PptRibbon.PictureFormat.Adjust.FlyChangePicture.FromM365Icon"}));this.addCommandToMaps(Object.assign(new Pa.a("ChangePictureFlyoutDevice",M.a.BIc.toString()),{legacyControlId:"PptRibbon.PictureFormat.Adjust.FlyChangePicture.FromDevice"}));this.addCommandToMaps(Object.assign(new Pa.a("ChangePictureFlyoutOneDrive",M.a.OZb.toString()),{legacyControlId:"PptRibbon.PictureFormat.Adjust.FlyChangePicture.FromHost",
queryCommandId:M.a.imc.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("ChangePictureFlyoutMobileDevice",M.a.QZb.toString()),{legacyControlId:"ChangePictureFromMobileDevice"}));this.addCommandToMaps(Object.assign(new Pa.a("ChangeSmartArtColorAnchor",M.a.XBf.toString()),{populationProps:new Yg(M.a.L$g.toString(),!1)}));this.addCommandToMaps(new Pa.a("CheckAccessibility",M.a.vJe.toString()));this.addCommandToMaps(Object.assign(new Pa.a("ClearFormatting",M.a.clearFormatting.toString()),{legacyControlId:"PptRibbon.Home.Font.ClearFormatting"}));
this.addCommandToMaps(new Pa.a("ClearTableFormatting",D.a.H6a.toString()));this.addCommandToMaps(Object.assign(new Pa.a("CommentsPane",M.a.W5.toString()),{queryCommandId:M.a.OIb.toString()}));this.addCommandToMaps(new Pa.a("CopyHyperlink",D.a.mKc.toString()));this.addCommandToMaps(Object.assign(new Pa.a("ContextMenu",D.a.Xtf.toString()),{populationProps:new Yg(D.a.Sgd.toString(),!1)}));this.addCommandToMaps(Object.assign(new Pa.a("SelectionPane",M.a.X5.toString()),{queryCommandId:M.a.KIb.toString()}));
this.addCommandToMaps(Object.assign(new Pa.a("RenderFooterPane",M.a.PY.toString()),{queryCommandId:M.a.gmc.toString()}));this.addCommandToMaps(new Pa.a("InsertSlideNumber",M.a.RTa.toString()));this.addCommandToMaps(Object.assign(new Pa.a("RenderSelectionPane",M.a.X5.toString()),{queryCommandId:M.a.KIb.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("CommentsShowMarkUp",M.a.$Lb.toString()),{queryCommandId:M.a.Eid.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("CommentsShowAdvancedMarkUp",
M.a.Bqc.toString()),{queryCommandId:M.a.nMe.toString()}));this.addCommandToMaps(new Pa.a("Copy",M.a.zHb.toString()));this.addCommandToMaps(new Pa.a("CopyInVersionHistory",M.a.sIh.toString()));this.addCommandToMaps(new Pa.a("ClickVersionHistoryRestore",M.a.n_b.toString()));this.addCommandToMaps(new Pa.a("ClickVersionHistorySaveACopy",M.a.YTd.toString()));this.addCommandToMaps(new Pa.a("ClickVersionHistoryDownloadVersion",M.a.XTd.toString()));this.addCommandToMaps(new Pa.a("Cut",M.a.AHb.toString()));
this.addCommandToMaps(new Pa.a("Delete",M.a.deleteObject.toString()));this.addCommandToMaps(new Pa.a("DeleteAllCommentsInPresentation",M.a.Qtb.toString()));this.addCommandToMaps(new Pa.a("DeleteAllCommentsInSlide",M.a.VQa.toString()));this.addCommandToMaps(new Pa.a("DeleteAllResolvedComments",M.a.Rtb.toString()));this.addCommandToMaps(Object.assign(new Pa.a("DeleteComment",M.a.deleteComment.toString()),{queryCommandId:M.a.NGk.toString()}));this.addCommandToMaps(new Pa.a("DeleteRepeatedWord",D.a.LCa.toString()));
this.addCommandToMaps(new Pa.a("DeleteSlide",M.a.qI.toString()));this.addCommandToMaps(Object.assign(new Pa.a("DesignerHome",M.a.Dqc.toString()),{legacyControlId:"PptRibbon.Home.ShowHide.Designer",queryCommandId:M.a.Gmc.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("DesignerNew",M.a.ppd.toString()),{legacyControlId:"PptRibbon.Design.ShowHide.Designer.New",queryCommandId:M.a.Gmc.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("Dictation",D.a.ANb.toString()),{legacyControlId:"btnStartDictation",
queryCommandId:D.a.Ihd.toString(),populationProps:new Yg(D.a.blc.toString(),!0)}));this.addCommandToMaps(Object.assign(new Pa.a("DocChat",H.a.BBh.toString()),{legacyControlId:"DocChat",queryCommandId:H.a.Gch.toString()}));this.addCommandToMaps(new Pa.a("DoNotCheckThisCritiqueType",D.a.eub.toString()));this.addCommandToMaps(new Pa.a("Duplicate",M.a.k_d.toString()));this.addCommandToMaps(new Pa.a("DuplicateSlide",M.a.gQ.toString()));this.addCommandToMaps(new Pa.a("EditHyperlink",M.a.insertHyperlink.toString()));
this.addCommandToMaps(Object.assign(new Pa.a("EditInApp",M.a.openInClient.toString()),{legacyControlId:"btnOpenInClient"}));this.addCommandToMaps(Object.assign(new Pa.a("EditInAppWithIcon",M.a.openInClient.toString()),{legacyControlId:"btnOpenInClient"}));this.addCommandToMaps(Object.assign(new Pa.a("EditorPane",M.a.yJe.toString()),{legacyControlId:"PptRibbon.Review.Proofing.EditorPane",queryCommandId:M.a.fMe.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("EditorPaneSplitButton",M.a.yJe.toString()),
{legacyControlId:"PptRibbon.Review.Proofing.ProofingSplitButton",queryCommandId:M.a.gMe.toString()}));this.la.YLf&&this.addCommandToMaps(Object.assign(new Pa.a("DexLitePane",M.a.npd.toString()),{queryCommandId:M.a.Khd.toString()}));this.addCommandToMaps(new Pa.a("Find",M.a.find.toString()));this.addCommandToMaps(new Pa.a("FitToWindow",M.a.vuc.toString()));this.addCommandToMaps(Object.assign(new Pa.a("FixIt",M.a.fixIt.toString()),{legacyControlId:"FixIt",queryCommandId:M.a.HLe.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("FontColor",
M.a.qxa.toString()),{populationProps:new Yg(M.a.GHb.toString(),!1)}));this.addCommandToMaps(Object.assign(new Pa.a("FontPicker",D.a.font.toString()),{legacyControlId:"fontPicker",queryCommandId:D.a.Mhd.toString(),populationProps:new Yg(D.a.clc.toString(),!0)}));this.la.ka("FontPreviewEnabled")?(this.addCommandToMaps(Object.assign(new Pa.a("FontName",M.a.aZa.toString()),{queryCommandId:M.a.Ahb.toString(),populationProps:new Yg(M.a.ehb.toString(),!1),commandPreviewId:M.a.IHb.toString(),commandRevertId:M.a.LHb.toString()})),
this.addCommandToMaps(Object.assign(new Pa.a("FontSize",M.a.bZa.toString()),{queryCommandId:M.a.Bhb.toString(),commandPreviewId:M.a.JHb.toString(),commandRevertId:M.a.MHb.toString()}))):(this.addCommandToMaps(Object.assign(new Pa.a("FontName",M.a.aZa.toString()),{queryCommandId:M.a.Ahb.toString(),populationProps:new Yg(M.a.ehb.toString(),!1)})),this.addCommandToMaps(Object.assign(new Pa.a("FontSize",M.a.bZa.toString()),{queryCommandId:M.a.Bhb.toString()})));this.addCommandToMaps(Object.assign(new Pa.a("FormatBackgroundApplyToAll",
M.a.LPc.toString()),{legacyControlId:"PptRibbon.Design.Customize.FormatBackgroundAnchor"}));this.addCommandToMaps(Object.assign(new Pa.a("FormatBackgroundPicture",M.a.m3d.toString()),{legacyControlId:"PptRibbon.Design.Customize.FormatBackgroundAnchor"}));this.addCommandToMaps(Object.assign(new Pa.a("FormatBackgroundSolidFill",M.a.Ssa.toString()),{legacyControlId:"PptRibbon.Design.Customize.FormatBackgroundAnchor",populationProps:new Yg(M.a.jJe.toString(),!1)}));this.addCommandToMaps(Object.assign(new Pa.a("FormatBackgroundReset",
M.a.MPc.toString()),{legacyControlId:"PptRibbon.Design.Customize.FormatBackgroundAnchor"}));this.addCommandToMaps(Object.assign(new Pa.a("FormatBackgroundStandardColors",M.a.Ssa.toString()),{legacyControlId:"PptRibbon.Design.Customize.FormatBackgroundAnchor"}));this.addCommandToMaps(Object.assign(new Pa.a("FormatBackgroundThemeColors",M.a.Ssa.toString()),{legacyControlId:"PptRibbon.Design.Customize.FormatBackgroundAnchor"}));this.addCommandToMaps(Object.assign(new Pa.a("FormatBackgroundThemeColorsMCU",
M.a.Ssa.toString()),{legacyControlId:"PptRibbon.Design.Customize.FormatBackgroundAnchor"}));this.addCommandToMaps(new Pa.a("FormatBackgroundRecentColors",M.a.ehd.toString()));this.addCommandToMaps(Object.assign(new Pa.a("FormatPainter",M.a.YRa.toString()),{queryCommandId:M.a.$hd.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("HideProofingErrors",M.a.W$f.toString()),{legacyControlId:"PptRibbon.Review.Proofing.HideProofingErrors",queryCommandId:M.a.Ohd.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("GiveFeedback",
H.a.mKb.toString()),{legacyControlId:"btnFeedback"}));this.addCommandToMaps(Object.assign(new Pa.a("GrammarOptions",D.a.OGb.toString()),{legacyControlId:"PptRibbon.Review.Proofing.GrammarOptions"}));this.addCommandToMaps(Object.assign(new Pa.a("ProofingOptions",D.a.OGb.toString()),{legacyControlId:"PptRibbon.Review.Proofing.ProofingSplitButtonFallback"}));this.addCommandToMaps(Object.assign(new Pa.a("Grow",M.a.chb.toString()),{legacyControlId:"PptRibbon.Home.Font.Grow"}));this.addCommandToMaps(Object.assign(new Pa.a("HideSlide",
M.a.l7b.toString()),{queryCommandId:M.a.Gid.toString()}));this.la.fbe&&this.addCommandToMaps(new Pa.a("UnhideSlide",M.a.a2e.toString()));this.addCommandToMaps(Object.assign(new Pa.a("Highlight",M.a.DHb.toString()),{legacyControlId:"PptRibbon.Home.Font.FontBackgroundColor"}));this.addCommandToMaps(new Pa.a("HighlighterColor",D.a.Q5.toString()));this.addCommandToMaps(new Pa.a("IgnoreSpellingError",D.a.ika.toString()));this.addCommandToMaps(new Pa.a("Indent",M.a.CHb.toString()));this.addCommandToMaps(new Pa.a("InsertAddIns",
M.a.Txb.toString()));this.addCommandToMaps(new Pa.a("InsertAddInsFromBackstage",M.a.Txb.toString()));this.addCommandToMaps(new Pa.a("InsertMoreAddInsFromFooter",M.a.Txb.toString()));this.addCommandToMaps(new Pa.a("InsertComment",M.a.OTa.toString()));this.addCommandToMaps(Object.assign(new Pa.a("InsertIcons",M.a.vWc.toString()),{legacyControlId:"InsertIconDialog"}));this.addCommandToMaps(new Pa.a("InsertLink",M.a.insertHyperlink.toString()));this.addCommandToMaps(new Pa.a("InsertSocialMediaVideo",
M.a.Ucg.toString()));this.addCommandToMaps(new Pa.a("InsertPicturesFlyoutDalle",M.a.dde.toString()));this.addCommandToMaps(new Pa.a("InsertPicturesDalle",M.a.ede.toString()));this.addCommandToMaps(new Pa.a("InsertLiveFeed",M.a.Lcg.toString()));this.addCommandToMaps(Object.assign(new Pa.a("InsertOnlineVideo",M.a.Ota.toString()),{legacyControlId:"PptRibbon.InsertTab.Media.OnlineVideo"}));this.la.xWc&&this.addCommandToMaps(new Pa.a("InsertVideoFromDevice",M.a.dMb.toString()));this.addCommandToMaps(Object.assign(new Pa.a("InsertPicturesFlyout",
M.a.Qcg.toString()),{legacyControlId:"PptRibbon.InsertTab.Images.FlyPicture"}));this.addCommandToMaps(Object.assign(new Pa.a("InsertPicturesFlyoutBing",M.a.insertOnlinePicture.toString()),{legacyControlId:"PptRibbon.InsertTab.Images.FlyPicture.FromSearch"}));var a;this.addCommandToMaps((a=new Pa.a("InsertPicturesFlyoutM365",M.a.e8b.toString()),a.legacyControlId="PptRibbon.InsertTab.Images.FlyPicture.FromM365Picture",a));let b;this.addCommandToMaps((b=new Pa.a("InsertPicturesM365",M.a.BWc.toString()),
b.legacyControlId="PptRibbon.InsertTab.Images.FlyPicture.FromM365Picture",b));let c;this.addCommandToMaps((c=new Pa.a("InsertPicturesFlyoutDevice",M.a.insertPicture.toString()),c.legacyControlId="PptRibbon.InsertTab.Images.FlyPicture.FromDevice",c));let h;this.addCommandToMaps((h=new Pa.a("InsertPicturesFlyoutOneDrive",M.a.Wxb.toString()),h.legacyControlId="PptRibbon.InsertTab.Images.FlyPicture.FromHost",h.queryCommandId=M.a.imc.toString(),h));let m;this.addCommandToMaps((m=new Pa.a("InsertPicturesFlyoutMobileDevice",
M.a.GWc.toString()),m.legacyControlId="InsertPictureFromMobileDevice",m));this.addCommandToMaps(new Pa.a("InsertSlides",M.a.Xma.toString()));let y;this.addCommandToMaps((y=new Pa.a("NewSlideSplit",M.a.vHb.toString()),y.populationProps=new Yg(M.a.vHb.toString(),!1),y));let G;this.addCommandToMaps((G=new Pa.a("InsertSlideSplit",M.a.vHb.toString()),G.populationProps=new Yg(M.a.vHb.toString(),!1),G));this.addCommandToMaps(new Pa.a("NewDefaultSlide",M.a.m5.toString()));let U;this.addCommandToMaps((U=new Pa.a("ChangeLayoutFlyout",
M.a.gJe.toString()),U.populationProps=new Yg(M.a.gJe.toString(),!1),U));this.addCommandToMaps(new Pa.a("InsertTextBox",M.a.JEa.toString()));this.addCommandToMaps(new Pa.a("InsertAudio",M.a.gvh.toString()));let ja;this.addCommandToMaps((ja=new Pa.a("InsertFooterFlyout",M.a.M$a.toString()),ja.legacyControlId="PptRibbon.InsertTab.FooterFlyout",ja));let va;this.addCommandToMaps((va=new Pa.a("InsertSymbol",D.a.Nqd.toString()),va.populationProps=new Yg(D.a.Zgb.toString(),!0),va));this.addCommandToMaps(new Pa.a("InsertTable",
D.a.insertTable.toString()));this.addCommandToMaps(new Pa.a("InvokeFilesSerplet",H.a.eyb.toString()));let Ta;this.addCommandToMaps((Ta=new Pa.a("Italic",M.a.EHb.toString()),Ta.queryCommandId=M.a.CIb.toString(),Ta));this.addCommandToMaps(new Pa.a("LeftToRight",M.a.llc.toString()));let fb;this.addCommandToMaps((fb=new Pa.a("LineSpacing",M.a.dhb.toString()),fb.legacyControlId="PptRibbon.Home.Paragraph.LineSpacing",fb.populationProps=new Yg(M.a.HHb.toString(),!1),fb));let Db;this.addCommandToMaps((Db=
new Pa.a("LineSpacingButton1_00",M.a.sxa.toString()),Db.queryCommandId=M.a.Axa.toString(),Db.menuItemId="1.00",Db));let gc;this.addCommandToMaps((gc=new Pa.a("LineSpacingButton1_50",M.a.sxa.toString()),gc.queryCommandId=M.a.Axa.toString(),gc.menuItemId="1.50",gc));let hc;this.addCommandToMaps((hc=new Pa.a("LineSpacingButton2_00",M.a.sxa.toString()),hc.queryCommandId=M.a.Axa.toString(),hc.menuItemId="2.00",hc));let Gc;this.addCommandToMaps((Gc=new Pa.a("LineSpacingButton2_50",M.a.sxa.toString()),Gc.queryCommandId=
M.a.Axa.toString(),Gc.menuItemId="2.50",Gc));let Pc;this.addCommandToMaps((Pc=new Pa.a("LineSpacingButton3_00",M.a.sxa.toString()),Pc.queryCommandId=M.a.Axa.toString(),Pc.menuItemId="3.00",Pc));this.addCommandToMaps(new Pa.a("LineSpacingOptionsForParagraphDialog",M.a.fAb.toString()));this.addCommandToMaps(new Pa.a("MarkActivitiesAsRead",M.a.XBe.toString()));let yc;this.addCommandToMaps((yc=new Pa.a("ModeSwitcherEditing",M.a.Arc.toString()),yc.queryCommandId=M.a.uMe.toString(),yc.legacyControlId="ModeSwitcherModeEditing",
yc));let Vd;this.addCommandToMaps((Vd=new Pa.a("ModeSwitcherViewing",M.a.Brc.toString()),Vd.queryCommandId=M.a.vMe.toString(),Vd.legacyControlId="ModeSwitcherModeViewing",Vd));this.addCommandToMaps(new Pa.a("ModeSwitcher",M.a.VYg.toString()));this.addCommandToMaps(new Pa.a("MoreSymbols",D.a.yWc.toString()));let De;this.addCommandToMaps((De=new Pa.a("MoreVariantsAnchor",M.a.YBa.toString()),De.queryCommandId=M.a.Tmc.toString(),De.populationProps=new Yg(M.a.Wgd.toString(),!1),De.previewControlIds=["Variant1",
"Variant2","Variant3","Variant4"],De));this.addCommandToMaps(new Pa.a("MoveSectionDown",M.a.gDe.toString()));this.addCommandToMaps(new Pa.a("MoveSectionUp",M.a.hDe.toString()));let Wd;this.addCommandToMaps((Wd=new Pa.a("NewComment",M.a.OTa.toString()),Wd.queryCommandId=M.a.dHk.toString(),Wd));this.addCommandToMaps(new Pa.a("NewSlide",M.a.Xma.toString()));this.addCommandToMaps(new Pa.a("NewSlideWithoutDialog",M.a.m5.toString()));let Ve;this.addCommandToMaps((Ve=new Pa.a("NextComment",M.a.KDe.toString()),
Ve.queryCommandId=M.a.iHk.toString(),Ve));this.addCommandToMaps(new Pa.a("NoHighlight",D.a.Kra.toString()));let $e;this.addCommandToMaps(($e=new Pa.a("Notes",M.a.SKa.toString()),$e.queryCommandId=M.a.Uhd.toString(),$e));let Qf;this.addCommandToMaps((Qf=new Pa.a("NumberingLibrary",M.a.vJa.toString()),Qf.legacyControlId="PptRibbon.Home.Paragraph.NumberedGallery",Qf.queryCommandId=M.a.DIb.toString(),Qf.populationProps=new Yg(M.a.tlc.toString(),!1),Qf));this.addCommandToMaps(new Pa.a("OpenHyperlink",
D.a.ZIa.toString()));this.addCommandToMaps(new Pa.a("OpenPowerPointLanguageDialog",M.a.Afd.toString()));let lg;this.addCommandToMaps((lg=new Pa.a("OpenSetSlideSizeDialog",M.a.xHe.toString()),lg.queryCommandId=M.a.rMe.toString(),lg));this.addCommandToMaps(new Pa.a("OpenVersionHistory",M.a.y7g.toString()));this.addCommandToMaps(new Pa.a("Outdent",M.a.KHb.toString()));this.addCommandToMaps(new Pa.a("ParagraphOptions",M.a.fAb.toString()));this.addCommandToMaps(new Pa.a("Paste",M.a.wJa.toString()));this.addCommandToMaps(new Pa.a("PasteGalleryIcon",
M.a.wJa.toString()));this.addCommandToMaps(new Pa.a("PasteKeepingDestinationTheme",M.a.gJa.toString()));this.addCommandToMaps(new Pa.a("PasteKeepingSourceFormatting",M.a.hJa.toString()));let Hg;this.addCommandToMaps((Hg=new Pa.a("PasteTextOnlyGalleryIcon",M.a.FHb.toString()),Hg.legacyControlId="PptRibbon.Home.Clipboard.NewPaste",Hg));this.addCommandToMaps(new Pa.a("PasteAsImage",M.a.VYa.toString()));let Qg;this.addCommandToMaps((Qg=new Pa.a("PasteSlideKeepDestinationFromClipService",M.a.Ikc.toString()),
Qg.queryCommandId=M.a.dMe.toString(),Qg));let Sf;this.addCommandToMaps((Sf=new Pa.a("PasteSlideKeepSourceFromClipService",M.a.kHb.toString()),Sf.queryCommandId=M.a.dMe.toString(),Sf));let sh;this.addCommandToMaps((sh=new Pa.a("PasteTextOnly",M.a.FHb.toString()),sh.legacyControlId="PptRibbon.Home.Clipboard.NewPaste",sh));this.addCommandToMaps(new Pa.a("PlayFromBeginning",M.a.AMb.toString()));this.addCommandToMaps(new Pa.a("PlayFromBeginningTopBar",M.a.Rkc.toString()));this.addCommandToMaps(new Pa.a("PlayFromCurrentSlide",
M.a.Gya.toString()));let Xg;this.addCommandToMaps((Xg=new Pa.a("PresentLive",M.a.eZa.toString()),Xg.legacyControlId="PresentLive",Xg));let ni;this.addCommandToMaps((ni=new Pa.a("PresentLiveTopBar",M.a.Llc.toString()),ni.legacyControlId="PresentLiveTopBar",ni));let Ri;this.addCommandToMaps((Ri=new Pa.a("PresentLiveSetAccessControlAnyone",M.a.fZa.toString()),Ri.legacyControlId="PresentLiveSetAccessControlAnyone",Ri.queryCommandId=M.a.GIb.toString(),Ri));let uj;this.addCommandToMaps((uj=new Pa.a("PresentLiveSetAccessControlOrganization",
M.a.Klc.toString()),uj.legacyControlId="PresentLiveSetAccessControlOrganization",uj.queryCommandId=M.a.HIb.toString(),uj));let dj;this.addCommandToMaps((dj=new Pa.a("PresentLiveConsumer",M.a.eZa.toString()),dj.legacyControlId="PresentLiveConsumer",dj));let ej;this.addCommandToMaps((ej=new Pa.a("PresentLiveEnterprise",M.a.eZa.toString()),ej.legacyControlId="PresentLiveEnterprise",ej));let Ei;this.addCommandToMaps((Ei=new Pa.a("PresentToTeams",M.a.phb.toString()),Ei.legacyControlId="PresentToTeams",
Ei));let Dk;this.addCommandToMaps((Dk=new Pa.a("PresentToTeamsTopBar",M.a.jKe.toString()),Dk.legacyControlId="PresentToTeamsTopBar",Dk));let vj;this.addCommandToMaps((vj=new Pa.a("PreviousComment",M.a.pKe.toString()),vj.queryCommandId=M.a.tHk.toString(),vj));this.addCommandToMaps(new Pa.a("ReadingView",M.a.sjd.toString()));let tk;this.addCommandToMaps((tk=new Pa.a("PictureCrop",M.a.wXd.toString()),tk.queryCommandId=M.a.eMe.toString(),tk));this.addCommandToMaps(new Pa.a("PictureCropAnchor",M.a.uXd.toString()));
let Fl;this.addCommandToMaps((Fl=new Pa.a("PictureCropMoreOptions",M.a.rpd.toString()),Fl.queryCommandId=M.a.Hmc.toString(),Fl));this.addCommandToMaps(new Pa.a("Redo",M.a.ulc.toString()));let rl;this.addCommandToMaps((rl=new Pa.a("RehearsalFeedbackSettings",M.a.tpd.toString()),rl.legacyControlId="PptRibbon.View.Coach.Menu.FeedbackSettings",rl.queryCommandId=M.a.Fid.toString(),rl));let Gl;this.addCommandToMaps((Gl=new Pa.a("RehearsePresentation",M.a.Afa.toString()),Gl.legacyControlId="PptRibbon.View.Coach.RehearseWithCoach",
Gl));let Vj;this.addCommandToMaps((Vj=new Pa.a("RehearsePresentationTopBar",M.a.qnc.toString()),Vj.legacyControlId="PptRibbon.View.Coach.RehearseWithCoachTopBar",Vj));let Ek;this.addCommandToMaps((Ek=new Pa.a("RehearsePresentationDropDown",M.a.pnc.toString()),Ek.legacyControlId="PptRibbon.View.Coach.RehearseWithCoachSplit",Ek));this.addCommandToMaps(new Pa.a("RemoveHyperlink",D.a.sM.toString()));this.addCommandToMaps(new Pa.a("RemoveSection",M.a.VOe.toString()));this.addCommandToMaps(new Pa.a("RenameSection",
M.a.rkd.toString()));this.addCommandToMaps(new Pa.a("Replace",M.a.$0.toString()));this.addCommandToMaps(new Pa.a("ResetPicture",M.a.Pkd.toString()));this.addCommandToMaps(new Pa.a("ResetPictureAndSize",M.a.qkh.toString()));this.addCommandToMaps(new Pa.a("ResetPictureSplitButton",M.a.rkh.toString()));this.addCommandToMaps(new Pa.a("RightToLeft",M.a.mlc.toString()));this.addCommandToMaps(new Pa.a("RotateAnchor",M.a.vlh.toString()));this.addCommandToMaps(new Pa.a("RotateShapeAnchor",M.a.wlh.toString()));
let Wj;this.addCommandToMaps((Wj=new Pa.a("RotateLeft",M.a.e1.toString()),Wj.commandPreviewId=M.a.mKe.toString(),Wj.commandRevertId=M.a.XQe.toString(),Wj));let fk;this.addCommandToMaps((fk=new Pa.a("RotateRight",M.a.yld.toString()),fk.commandPreviewId=M.a.nKe.toString(),fk.commandRevertId=M.a.XQe.toString(),fk));this.addCommandToMaps(new Pa.a("RotateFlipVertical",M.a.voc.toString()));this.addCommandToMaps(new Pa.a("RotateFlipHorizontal",M.a.uoc.toString()));this.addCommandToMaps(new Pa.a("SelectHyperlink",
D.a.hmd.toString()));this.addCommandToMaps(new Pa.a("SendBackward",M.a.sendBackward.toString()));this.addCommandToMaps(new Pa.a("SendToBack",M.a.sendToBack.toString()));this.addCommandToMaps(new Pa.a("SendToBackFlyout",M.a.ooh.toString()));this.la.qT&&Rd.a("AnimationGalleryActionAIEnabled")&&this.addCommandToMaps(new Pa.a("AnimationGalleryActionAI",M.a.cPd.toString()));this.la.Yqb?(this.addCommandToMaps(Object.assign(new Pa.a("SetAnimationDelay",M.a.YSe.toString()),{queryCommandId:M.a.oZa.toString()})),
this.addCommandToMaps(Object.assign(new Pa.a("SetAnimationDuration",M.a.ZSe.toString()),{queryCommandId:M.a.qZa.toString()})),this.addCommandToMaps(Object.assign(new Pa.a("AnimationStart",M.a.ePd.toString()),{queryCommandId:M.a.Zlc.toString()})),a=new Pa.a("AnimationPane",M.a.Uuh.toString()),a.queryCommandId=M.a.Ylc.toString(),this.addCommandToMaps(a),this.addCommandToMaps(new Pa.a("MoveEarlier",M.a.SCe.toString())),this.addCommandToMaps(new Pa.a("MoveLater",M.a.TCe.toString()))):(this.addCommandToMaps(new Pa.a("MoveEarlier",
M.a.LPe.toString())),this.addCommandToMaps(new Pa.a("MoveLater",M.a.MPe.toString())));let Fj;this.addCommandToMaps((Fj=new Pa.a("SetHeight",M.a.Wmd.toString()),Fj.queryCommandId=M.a.vhb.toString(),Fj));let sl;this.addCommandToMaps((sl=new Pa.a("SetWidth",M.a.Xmd.toString()),sl.queryCommandId=M.a.whb.toString(),sl));let dh;this.addCommandToMaps((dh=new Pa.a("SetSlideSize",M.a.Dpc.toString()),dh.legacyControlId="PptRibbon.Design.Customize.SetSlideSizeAnchor",dh));let Rl;this.addCommandToMaps((Rl=new Pa.a("SetSlideSize4x3",
M.a.cod.toString()),Rl.queryCommandId=M.a.Iid.toString(),Rl));let lm;this.addCommandToMaps((lm=new Pa.a("SetSlideSize16x9",M.a.bod.toString()),lm.queryCommandId=M.a.Hid.toString(),lm));let Fk;this.addCommandToMaps((Fk=new Pa.a("SetTransitionApplyAll",M.a.Bjb.toString()),Fk.queryCommandId=M.a.YIb.toString(),Fk));this.addCommandToMaps(Object.assign(new Pa.a("SetTransitionDuration",M.a.Cjb.toString()),{queryCommandId:M.a.Cxa.toString()}));this.addCommandToMaps(new Pa.a("ShapeAlignAnchor",M.a.Wrh.toString()));
this.addCommandToMaps(new Pa.a("ShapeAlignLeft",M.a.uod.toString()));this.addCommandToMaps(new Pa.a("ShapeAlignRight",M.a.Upc.toString()));this.addCommandToMaps(new Pa.a("ShapeAlignTop",M.a.vod.toString()));this.addCommandToMaps(new Pa.a("ShapeAlignBottom",M.a.Rpc.toString()));this.addCommandToMaps(new Pa.a("ShapeAlignCenter",M.a.Spc.toString()));this.addCommandToMaps(new Pa.a("ShapeAlignMiddle",M.a.Tpc.toString()));this.addCommandToMaps(Object.assign(new Pa.a("ShapeAlignToSlide",M.a.Msc.toString()),
{queryCommandId:M.a.MIb.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("ShapeAlignToSelectedObjects",M.a.Lsc.toString()),{queryCommandId:M.a.LIb.toString()}));this.addCommandToMaps(new Pa.a("ShareSlide",M.a.Fod.toString()));this.addCommandToMaps(new Pa.a("DistributeShapesVertically",M.a.TCa.toString()));this.addCommandToMaps(Object.assign(new Pa.a("ImmersiveReader",M.a.immersiveReader.toString()),{legacyControlId:"fseaImmersiveReader"}));this.addCommandToMaps(Object.assign(new Pa.a("ImmersiveReaderRibbon",
M.a.Xbe.toString()),{legacyControlId:"fseaImmersiveReader"}));this.addCommandToMaps(new Pa.a("DistributeShapesHorizontally",M.a.L1b.toString()));this.addCommandToMaps(new Pa.a("ShareSlide",M.a.Fod.toString()));this.addCommandToMaps(Object.assign(new Pa.a("Shrink",M.a.fhb.toString()),{legacyControlId:"PptRibbon.Home.Font.Shrink"}));this.addCommandToMaps(Object.assign(new Pa.a("ShowCommentsTopBar",H.a.zNb.toString()),{legacyControlId:"ShowCommentsTopBar",queryCommandId:H.a.UMe.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("ShowComments",
M.a.W5.toString()),{queryCommandId:M.a.OIb.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("ShowEditTriPaneView",M.a.QKa.toString()),{queryCommandId:M.a.oIb.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("ShowHideChanges",M.a.Wjb.toString()),{queryCommandId:M.a.oMe.toString()}));let Sl;this.addCommandToMaps((Sl=new Pa.a("ShowHideComments",M.a.W5.toString()),Sl.legacyControlId="PptRibbon.View.ShowHide.CommentsSplitButton",Sl.queryCommandId=M.a.OIb.toString(),Sl));let Xi;this.addCommandToMaps((Xi=
new Pa.a("ShowHideCommentsInReview",M.a.W5.toString()),Xi.queryCommandId=M.a.OIb.toString(),Xi));let xi;this.addCommandToMaps((xi=new Pa.a("ShowHideRuler",M.a.upd.toString()),xi.legacyControlId="btnShowHideRuler",xi.queryCommandId=M.a.fid.toString(),xi));this.addCommandToMaps(new Pa.a("ShowRevisionTrackingWithUrlOverrides",M.a.Epd.toString()));let mg;this.addCommandToMaps((mg=new Pa.a("ShowMarkup",M.a.$Lb.toString()),mg.queryCommandId=M.a.Eid.toString(),mg));let eh;this.addCommandToMaps((eh=new Pa.a("ShowTranslatePane",
M.a.Dhl.toString()),eh.legacyControlId="PptRibbon.Review.Show.Translate",eh));let jh;this.addCommandToMaps((jh=new Pa.a("ShowSmartLookupPane",H.a.pXc.toString()),jh.legacyControlId="PptRibbon.Review.Show.SmartLookup",jh));this.addCommandToMaps(new Pa.a("SmartLookupContextMenu",H.a.oXc.toString()));this.addCommandToMaps(new Pa.a("SmartLookupSynonyms",H.a.rXc.toString()));let xd;this.addCommandToMaps((xd=new Pa.a("ShowSorterView",M.a.Xfa.toString()),xd.queryCommandId=M.a.QIb.toString(),xd));let Ne;
this.addCommandToMaps((Ne=new Pa.a("ShowVersionHistoryDialog",H.a.Kqc.toString()),Ne.legacyControlId="PptJewel.Info.VersionHistory",Ne));let le;this.addCommandToMaps((le=new Pa.a("SpokenLanguage",M.a.$gb.toString()),le.legacyControlId="PptRibbon.View.Subtitles.PopulateTranscriptionSpokenLanguage",le.queryCommandId=M.a.$gb.toString(),le.populationProps=new Yg(M.a.$gb.toString(),!0),le));this.addCommandToMaps(new Pa.a("StandardFontColorPicker",M.a.qxa.toString()));let yf;this.addCommandToMaps((yf=new Pa.a("Strikethrough",
M.a.OHb.toString()),yf.legacyControlId="PptRibbon.Home.Font.Strikethrough",yf.queryCommandId=M.a.EIb.toString(),yf));let Eg;this.addCommandToMaps((Eg=new Pa.a("SubtitleLanguage",M.a.ahb.toString()),Eg.legacyControlId="PptRibbon.View.Subtitles.PopulateTranscriptionSubtitleLanguage",Eg.queryCommandId=M.a.ahb.toString(),Eg.populationProps=new Yg(M.a.ahb.toString(),!0),Eg));let Fi;this.addCommandToMaps((Fi=new Pa.a("SubtitleSettingsAnchor",M.a.Jid.toString()),Fi.legacyControlId="PptRibbon.View.Subtitles.SubtitleSettings",
Fi));let Oj;this.addCommandToMaps((Oj=new Pa.a("Subscript",M.a.PHb.toString()),Oj.legacyControlId="PptRibbon.Home.Font.Subscript",Oj.queryCommandId=M.a.xZa.toString(),Oj));this.addCommandToMaps(new Pa.a("SummarizeSlides",M.a.wrc.toString()));let Lo;this.addCommandToMaps((Lo=new Pa.a("Superscript",M.a.QHb.toString()),Lo.legacyControlId="PptRibbon.Home.Font.Superscript",Lo.queryCommandId=M.a.yZa.toString(),Lo));this.addCommandToMaps(new Pa.a("TabSwitch",H.a.klh.toString()));this.addCommandToMaps(new Pa.a("TextAlignmentAnchor",
M.a.F7a.toString()));let uk;this.addCommandToMaps((uk=new Pa.a("TextAlignmentCenterJustify",M.a.pxa.toString()),uk.queryCommandId=M.a.EJa.toString(),uk));let po;this.addCommandToMaps((po=new Pa.a("TextAlignmentFullJustify",M.a.cZa.toString()),po.legacyControlId="PptRibbon.Home.Paragraph.FullJustify",po.queryCommandId=M.a.Chb.toString(),po));let Mt;this.addCommandToMaps((Mt=new Pa.a("TextAlignmentLeftJustify",M.a.rxa.toString()),Mt.queryCommandId=M.a.FJa.toString(),Mt));let Nt;this.addCommandToMaps((Nt=
new Pa.a("TextAlignmentRightJustify",M.a.txa.toString()),Nt.queryCommandId=M.a.HJa.toString(),Nt));let Ot;this.addCommandToMaps((Ot=new Pa.a("TextAnchoringBottom",M.a.Q0.toString()),Ot.queryCommandId=M.a.IJa.toString(),Ot));let Pt;this.addCommandToMaps((Pt=new Pa.a("TextAnchoringMiddle",M.a.R0.toString()),Pt.queryCommandId=M.a.JJa.toString(),Pt));let Qt;this.addCommandToMaps((Qt=new Pa.a("TextAnchoringTop",M.a.S0.toString()),Qt.queryCommandId=M.a.KJa.toString(),Qt));this.addCommandToMaps(new Pa.a("ThemeFontColorPicker",
M.a.qxa.toString()));this.addCommandToMaps(new Pa.a("ThemeFontColorPickerMCU",M.a.qxa.toString()));let Es;this.addCommandToMaps((Es=new Pa.a("TopOverlaid",M.a.FNb.toString()),Es.legacyControlId="PptRibbon.View.Subtitles.SubtitlesPositionTopOverlay",Es.queryCommandId=M.a.Lhb.toString(),Es));let Rt;this.addCommandToMaps((Rt=new Pa.a("Underline",M.a.RHb.toString()),Rt.queryCommandId=M.a.FIb.toString(),Rt));this.addCommandToMaps(new Pa.a("Undo",M.a.Alc.toString()));let VA;this.addCommandToMaps((VA=new Pa.a("UsePresenterView",
M.a.B3e.toString()),VA.queryCommandId=M.a.ZIb.toString(),VA));this.addCommandToMaps(new Pa.a("Zoom",M.a.zHe.toString()));let Ay;this.addCommandToMaps((Ay=new Pa.a("ToggleUseSubtitles",M.a.HLa.toString()),Ay.legacyControlId="PptRibbon.View.Subtitles.UseSubtitles",Ay.queryCommandId=M.a.BZa.toString(),Ay));let WA;this.addCommandToMaps((WA=new Pa.a("ToggleShapeAlignToSlide",M.a.Msc.toString()),WA.queryCommandId=M.a.MIb.toString(),WA));let XA;this.addCommandToMaps((XA=new Pa.a("ToggleShapeAlignToSelectedObjects",
M.a.Lsc.toString()),XA.queryCommandId=M.a.LIb.toString(),XA));let By;this.addCommandToMaps((By=new Pa.a("ToggleSubtitlesBottomOverlay",M.a.ENb.toString()),By.legacyControlId="PptRibbon.View.Subtitles.SubtitlesPositionBottomOverlay",By.queryCommandId=M.a.Khb.toString(),By));let Cy;this.addCommandToMaps((Cy=new Pa.a("ToggleSubtitlesTopOverlay",M.a.FNb.toString()),Cy.legacyControlId="PptRibbon.View.Subtitles.SubtitlesPositionTopOverlay",Cy.queryCommandId=M.a.Lhb.toString(),Cy));let Dy;this.addCommandToMaps((Dy=
new Pa.a("ToggleRehearsalVisionEnabled",M.a.BNb.toString()),Dy.legacyControlId="PptRibbon.View.Coach.Menu.Vision",Dy.queryCommandId=M.a.JIb.toString(),Dy));let YA;this.addCommandToMaps((YA=new Pa.a("HostOpenInClient",M.a.openInClient.toString()),YA.legacyControlId="HostOpenInClient",YA));let Ey;this.addCommandToMaps((Ey=new Pa.a("ToggleSubtitlesBelowSlide",M.a.DNb.toString()),Ey.legacyControlId="PptRibbon.View.Subtitles.SubtitlesPositionBelowSlide",Ey.queryCommandId=M.a.Jhb.toString(),Ey));let Fy;
this.addCommandToMaps((Fy=new Pa.a("ToggleSubtitlesAboveSlide",M.a.CNb.toString()),Fy.legacyControlId="PptRibbon.View.Subtitles.SubtitlesPositionAboveSlide",Fy.queryCommandId=M.a.Ihb.toString(),Fy));let Gy;this.addCommandToMaps((Gy=new Pa.a("BelowSlide",M.a.DNb.toString()),Gy.legacyControlId="PptRibbon.View.Subtitles.SubtitlesPositionBelowSlide",Gy.queryCommandId=M.a.Jhb.toString(),Gy));let Hy;this.addCommandToMaps((Hy=new Pa.a("AboveSlide",M.a.CNb.toString()),Hy.legacyControlId="PptRibbon.View.Subtitles.SubtitlesPositionAboveSlide",
Hy.queryCommandId=M.a.Ihb.toString(),Hy));let ZA;this.addCommandToMaps((ZA=new Pa.a("PreviousVersions",H.a.Aqc.toString()),ZA.legacyControlId="PptJewel.Info.FileVersion",ZA));this.addCommandToMaps(new Pa.a("Present",M.a.XHb.toString()));this.addCommandToMaps(new Pa.a("PresentDropDown",M.a.ohb.toString()))}b4h(){this.addCommandToMaps(Object.assign(new Pa.a("CenterJustify",M.a.pxa.toString()),{queryCommandId:M.a.EJa.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("FullJustify",M.a.cZa.toString()),
{queryCommandId:M.a.Chb.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("LeftJustify",M.a.rxa.toString()),{queryCommandId:M.a.FJa.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("RightJustify",M.a.txa.toString()),{queryCommandId:M.a.HJa.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("TextAnchoringAnchor",M.a.hhd.toString()),{queryCommandId:M.a.hhd.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("AlignBottom",M.a.Q0.toString()),{queryCommandId:M.a.IJa.toString()}));
this.addCommandToMaps(Object.assign(new Pa.a("AlignMiddle",M.a.R0.toString()),{queryCommandId:M.a.JJa.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("AlignTop",M.a.S0.toString()),{queryCommandId:M.a.KJa.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("UseSubtitles",M.a.HLa.toString()),{legacyControlId:"AlwaysUseSubtitles",queryCommandId:M.a.BZa.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("SubtitleSettings",M.a.Jid.toString()),{legacyControlId:"PptRibbon.View.Subtitles.SubtitleSettings"}));
this.addCommandToMaps(new Pa.a("NewBringForwardAnchorMLR",M.a.srb.toString()));this.addCommandToMaps(new Pa.a("NewSendBackwardAnchorMLR",M.a.srb.toString()));this.addCommandToMaps(new Pa.a("PowerPointGroupFlyoutAnchorMLR",M.a.zJe.toString()));this.addCommandToMaps(Object.assign(new Pa.a("SetLockAspectRatio",M.a.opc.toString()),{queryCommandId:M.a.lmc.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("SetTableHeight",M.a.soa.toString()),{queryCommandId:M.a.Smc.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("SetTableWidth",
M.a.KKa.toString()),{queryCommandId:M.a.Oid.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("SetTableColumnWidth",M.a.JKa.toString()),{queryCommandId:M.a.RIb.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("SetTableRowHeight",M.a.R_a.toString()),{queryCommandId:M.a.SIb.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("UpdatePictureCropWidth",M.a.Ftd.toString()),{queryCommandId:M.a.wIb.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("UpdatePictureCropHeight",
M.a.Ctd.toString()),{queryCommandId:M.a.uIb.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("UpdatePictureCropLeft",M.a.Dtd.toString()),{queryCommandId:M.a.vIb.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("UpdatePictureCropTop",M.a.Etd.toString()),{queryCommandId:M.a.pmc.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("Paste_MLR",M.a.wJa.toString()),{queryCommandId:M.a.aid.toString()}));this.addCommandToMaps(new Pa.a("PasteKeepingDestinationThemeMLR",M.a.gJa.toString()));
this.addCommandToMaps(new Pa.a("PasteKeepingSourceFormattingMLR",M.a.hJa.toString()));this.addCommandToMaps(new Pa.a("PasteAsImageMLR",M.a.VYa.toString()));this.addCommandToMaps(Object.assign(new Pa.a("TableCellBottomAnchoringMLR",M.a.Q0.toString()),{queryCommandId:M.a.IJa.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("TableCellCenterJustifyMLR",M.a.pxa.toString()),{queryCommandId:M.a.EJa.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("TableCellLeftJustifyMLR",M.a.rxa.toString()),
{queryCommandId:M.a.FJa.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("TableCellMiddleAnchoringMLR",M.a.R0.toString()),{queryCommandId:M.a.JJa.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("TableCellRightJustifyMLR",M.a.txa.toString()),{queryCommandId:M.a.HJa.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("TableCellTopAnchoringMLR",M.a.S0.toString()),{queryCommandId:M.a.KJa.toString()}));this.addCommandToMaps(new Pa.a("ParagraphOptionsMLR",M.a.fAb.toString()));
this.addCommandToMaps(new Pa.a("Delete_MLR",M.a.deleteObject.toString()));this.addCommandToMaps(new Pa.a("SmartArtStylesMLR",M.a.LK.toString()));this.addCommandToMaps(new Pa.a("PictureCropMLR",M.a.vXd.toString()))}HNd(){this.addTabToMap("FormatShape",M.a.hOf.toString());this.addTabToMap("FormatPicture",M.a.h$g.toString());this.addTabToMap("SmartArtDesign",M.a.Cwh.toString());this.addTabToMap("Table",M.a.iMe.toString());this.addTabToMap("Graphics",M.a.Jch.toString());this.addTabToMap("Playback",M.a.Iwf.toString());
this.addTabToMap("AudioFormat",M.a.Gwf.toString());this.addTabToMap("Audio",M.a.Jwf.toString());this.addTabToMap("AccessibleAuthoring",M.a.CMd.toString())}i4h(){this.addCommandToMaps(Object.assign(new Pa.a("PptJewelDownloadACopyAsOdp",M.a.X1b.toString()),{legacyControlId:"PptJewel.DownloadAs.DownloadACopyAsOdp"}));this.addCommandToMaps(Object.assign(new Pa.a("PptJewelDownloadACopyAsPdf",M.a.Y1b.toString()),{legacyControlId:"PptJewel.DownloadAs.DownloadACopyAsPdf"}));this.addCommandToMaps(Object.assign(new Pa.a("PptJewelDownloadACopy",
M.a.downloadACopy.toString()),{legacyControlId:"PptJewel.DownloadAs.DownloadACopy"}));this.addCommandToMaps(Object.assign(new Pa.a("PptJewelDownloadAsImages",M.a.Z1b.toString()),{legacyControlId:"PptJewel.DownloadAs.DownloadAsImages"}));this.addCommandToMaps(Object.assign(new Pa.a("PptJewelNew",H.a.eAb.toString()),{legacyControlId:"PptJewel.New"}));this.addCommandToMaps(Object.assign(new Pa.a("PptJewelOpen",H.a.eAb.toString()),{legacyControlId:"PptJewel.Open"}));this.addCommandToMaps(Object.assign(new Pa.a("New",
H.a.eAb.toString()),{legacyControlId:"PptJewel.New"}));this.addCommandToMaps(Object.assign(new Pa.a("Open",H.a.eAb.toString()),{legacyControlId:"PptJewel.Open"}));this.addCommandToMaps(Object.assign(new Pa.a("PptJewelPrintFullSlide",M.a.print.toString()),{legacyControlId:"PptJewel.Print.PrintFullSlide"}));this.addCommandToMaps(Object.assign(new Pa.a("PptJewelPrintHandouts",M.a.sKe.toString()),{legacyControlId:"PptJewel.Print.PrintHandouts"}));this.addCommandToMaps(Object.assign(new Pa.a("PptJewelPrintNotes",
M.a.uKe.toString()),{legacyControlId:"PptJewel.Print.PrintNotes"}));this.addCommandToMaps(Object.assign(new Pa.a("PptJewelPrintToPdf",M.a.print.toString()),{legacyControlId:"PptJewel.Print.PrintToPdf"}));this.addCommandToMaps(Object.assign(new Pa.a("PptJewelRename",H.a.WWe.toString()),{legacyControlId:"PptJewel.Rename.RenameDialog"}));this.addCommandToMaps(Object.assign(new Pa.a("PptJewelSaveACopy",M.a.vlc.toString()),{legacyControlId:"PptJewel.SaveACopy.SaveACopy"}));this.addCommandToMaps(Object.assign(new Pa.a("PptJewelSaveAsToHost",
M.a.FJe.toString()),{legacyControlId:"PptJewel.SaveACopy.SaveAsToHost"}));this.addCommandToMaps(Object.assign(new Pa.a("PptJewelSaveToSharePoint",M.a.GJe.toString()),{legacyControlId:"PptJewel.SaveACopy.SaveToSharePoint"}));this.addCommandToMaps(Object.assign(new Pa.a("PptJewelTrustCenter",H.a.jMb.toString()),{legacyControlId:"PptJewel.About.TrustCenter"}));this.addCommandToMaps(Object.assign(new Pa.a("PptJewelVersionHistory",H.a.Kqc.toString()),{legacyControlId:"PptJewel.Info.VersionHistory"}));
this.addCommandToMaps(Object.assign(new Pa.a("PptJewelPreviousVersions",H.a.Aqc.toString()),{legacyControlId:"PptJewel.Info.FileVersion"}))}e4h(){this.addCommandToMaps(Object.assign(new Pa.a("ApplyShapeStyleAnchor",M.a.IPd.toString()),{populationProps:new Yg(M.a.nJe.toString(),!1)}));this.addCommandToMaps(Object.assign(new Pa.a("ApplyShapeStylePreviewGallery",M.a.lrb.toString()),{queryCommandId:M.a.xid.toString(),populationProps:new Yg(M.a.nJe.toString(),!1),previewControlIds:"ApplyShapeStyle0 ApplyShapeStyle1 ApplyShapeStyle2 ApplyShapeStyle3 ApplyShapeStyle4 ApplyShapeStyle5 ApplyShapeStyle6".split(" ")}));
this.addCommandToMaps(Object.assign(new Pa.a("ApplyGraphicsStyleAnchor",M.a.yPd.toString()),{populationProps:new Yg(M.a.kJe.toString(),!1)}));this.addCommandToMaps(new Pa.a("FontRecentColors",M.a.qlc.toString()));this.addCommandToMaps(Object.assign(new Pa.a("GraphicsStylePreviewGallery",M.a.wYb.toString()),{queryCommandId:M.a.Nhd.toString(),populationProps:new Yg(M.a.kJe.toString(),!1),previewControlIds:"ApplyGraphicsStyle0 ApplyGraphicsStyle1 ApplyGraphicsStyle2 ApplyGraphicsStyle3 ApplyGraphicsStyle4 ApplyGraphicsStyle5 ApplyGraphicsStyle6".split(" ")}));
this.addCommandToMaps(Object.assign(new Pa.a("GraphicsFill",M.a.irb.toString()),{populationProps:new Yg(M.a.mJe.toString(),!1)}));this.addCommandToMaps(new Pa.a("GraphicNoFill",M.a.KOe.toString()));this.addCommandToMaps(new Pa.a("GraphicNoOutline",M.a.LOe.toString()));this.addCommandToMaps(Object.assign(new Pa.a("GraphicsOutline",M.a.jrb.toString()),{populationProps:new Yg(M.a.Vgd.toString(),!1)}));this.addCommandToMaps(new Pa.a("MoreFillColors",M.a.JCe.toString()));this.addCommandToMaps(new Pa.a("MoreFontColors",
M.a.aZg.toString()));this.addCommandToMaps(new Pa.a("MoreFormatBackgroundColors",M.a.KCe.toString()));this.addCommandToMaps(new Pa.a("MoreOutlineColors",M.a.LCe.toString()));this.addCommandToMaps(Object.assign(new Pa.a("ShowHideFormatShapePane",M.a.Cqc.toString()),{queryCommandId:M.a.pIb.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("MoreRotationOptions",M.a.Cqc.toString()),{queryCommandId:M.a.pIb.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("PictureBorders",M.a.ria.toString()),
{populationProps:new Yg(M.a.Vgd.toString(),!1)}));this.addCommandToMaps(Object.assign(new Pa.a("ShapeFill",M.a.KBa.toString()),{populationProps:new Yg(M.a.mJe.toString(),!1),commandPreviewId:M.a.ZHb.toString(),commandRevertId:M.a.$Jb.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("ShapeFillRecentColors",M.a.MGc.toString()),{commandPreviewId:M.a.ZHb.toString(),commandRevertId:M.a.$Jb.toString()}));this.addCommandToMaps(new Pa.a("ShapeNoFill",M.a.akd.toString()));this.addCommandToMaps(new Pa.a("ShapeNoOutline",
M.a.bkd.toString()));this.addCommandToMaps(Object.assign(new Pa.a("ShapeOutline",M.a.ria.toString()),{populationProps:new Yg(M.a.Vgd.toString(),!1)}));this.addCommandToMaps(new Pa.a("ShapeOutlineRecentColors",M.a.NGc.toString()));this.addCommandToMaps(Object.assign(new Pa.a("ShapeOutlineDashStyle_1",M.a.T5a.toString()),{menuItemId:"ShapeOutlineDashStyle,1"}));this.addCommandToMaps(Object.assign(new Pa.a("ShapeOutlineDashStyle_2",M.a.T5a.toString()),{menuItemId:"ShapeOutlineDashStyle,2"}));this.addCommandToMaps(Object.assign(new Pa.a("ShapeOutlineDashStyle_4",
M.a.T5a.toString()),{menuItemId:"ShapeOutlineDashStyle,4"}));this.addCommandToMaps(new Pa.a("ShapeOutlineDashStyleAnchor",M.a.OGc.toString()));this.addCommandToMaps(Object.assign(new Pa.a("ShapeOutlineSketchStyle_1",M.a.U5a.toString()),{menuItemId:"ShapeOutlineSketchStyle,1"}));this.addCommandToMaps(Object.assign(new Pa.a("ShapeOutlineSketchStyle_2",M.a.U5a.toString()),{menuItemId:"ShapeOutlineSketchStyle,2"}));this.addCommandToMaps(Object.assign(new Pa.a("ShapeOutlineSketchStyle_3",M.a.U5a.toString()),
{menuItemId:"ShapeOutlineSketchStyle,3"}));this.addCommandToMaps(Object.assign(new Pa.a("ShapeOutlineSketchStyle_4",M.a.U5a.toString()),{menuItemId:"ShapeOutlineSketchStyle,4"}));this.addCommandToMaps(new Pa.a("ShapeOutlineSketchStyleAnchor",M.a.QGc.toString()));this.addCommandToMaps(Object.assign(new Pa.a("ShapeOutlineEndStyle_1",M.a.sia.toString()),{menuItemId:"ShapeOutlineEndStyle,1"}));this.addCommandToMaps(Object.assign(new Pa.a("ShapeOutlineEndStyle_2",M.a.sia.toString()),{menuItemId:"ShapeOutlineEndStyle,2"}));
this.addCommandToMaps(Object.assign(new Pa.a("ShapeOutlineEndStyle_3",M.a.sia.toString()),{menuItemId:"ShapeOutlineEndStyle,3"}));this.addCommandToMaps(Object.assign(new Pa.a("ShapeOutlineEndStyle_4",M.a.sia.toString()),{menuItemId:"ShapeOutlineEndStyle,4"}));this.addCommandToMaps(Object.assign(new Pa.a("ShapeOutlineEndStyle_5",M.a.sia.toString()),{menuItemId:"ShapeOutlineEndStyle,5"}));this.addCommandToMaps(Object.assign(new Pa.a("ShapeOutlineEndStyle_6",M.a.sia.toString()),{menuItemId:"ShapeOutlineEndStyle,6"}));
this.addCommandToMaps(Object.assign(new Pa.a("ShapeOutlineEndStyle_7",M.a.sia.toString()),{menuItemId:"ShapeOutlineEndStyle,7"}));this.addCommandToMaps(new Pa.a("ShapeOutlineEndStyleAnchor",M.a.PGc.toString()));this.addCommandToMaps(Object.assign(new Pa.a("ShapeOutlineWidth_1",M.a.zPa.toString()),{menuItemId:"ShapeOutlineWidth,1"}));this.addCommandToMaps(Object.assign(new Pa.a("ShapeOutlineWidth_2",M.a.zPa.toString()),{menuItemId:"ShapeOutlineWidth,2"}));this.addCommandToMaps(Object.assign(new Pa.a("ShapeOutlineWidth_3",
M.a.zPa.toString()),{menuItemId:"ShapeOutlineWidth,3"}));this.addCommandToMaps(Object.assign(new Pa.a("ShapeOutlineWidth_4",M.a.zPa.toString()),{menuItemId:"ShapeOutlineWidth,4"}));this.addCommandToMaps(new Pa.a("ShapeOutlineWidthAnchor",M.a.RGc.toString()));this.addCommandToMaps(new Pa.a("StandardGraphicFillColorPicker",M.a.irb.toString()));this.addCommandToMaps(new Pa.a("StandardGraphicOutlineColorPicker",M.a.jrb.toString()));this.addCommandToMaps(Object.assign(new Pa.a("StandardShapeFillColorPicker",
M.a.KBa.toString()),{commandPreviewId:M.a.ZHb.toString(),commandRevertId:M.a.$Jb.toString()}));this.addCommandToMaps(new Pa.a("StandardShapeOutlineColorPicker",M.a.ria.toString()));this.addCommandToMaps(new Pa.a("ThemeGraphicFillColorPicker",M.a.irb.toString()));this.addCommandToMaps(new Pa.a("ThemeGraphicFillColorPickerMCU",M.a.irb.toString()));this.addCommandToMaps(new Pa.a("ThemeGraphicOutlineColorPicker",M.a.jrb.toString()));this.addCommandToMaps(new Pa.a("ThemeGraphicOutlineColorPickerMCU",M.a.jrb.toString()));
this.addCommandToMaps(Object.assign(new Pa.a("ThemeShapeFillColorPickerMCU",M.a.KBa.toString()),{commandPreviewId:M.a.ZHb.toString(),commandRevertId:M.a.$Jb.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("ThemeShapeFillColorPicker",M.a.KBa.toString()),{commandPreviewId:M.a.ZHb.toString(),commandRevertId:M.a.$Jb.toString()}));this.addCommandToMaps(new Pa.a("ThemeShapeOutlineColorPicker",M.a.ria.toString()));this.addCommandToMaps(new Pa.a("ThemeShapeOutlineColorPickerMCU",M.a.ria.toString()))}j4h(){this.addCommandToMaps(Object.assign(new Pa.a("Themes",
M.a.$v.toString()),{queryCommandId:M.a.rz.toString(),previewControlIds:"ThemesOfficeTheme ThemesAtlas ThemesMadison ThemesIon ThemesOrganic ThemesFrame".split(" ")}));this.addCommandToMaps(Object.assign(new Pa.a("ThemesOfficeTheme",M.a.$v.toString()),{queryCommandId:M.a.rz.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("ThemesAtlas",M.a.$v.toString()),{queryCommandId:M.a.rz.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("ThemesMadison",M.a.$v.toString()),{queryCommandId:M.a.rz.toString()}));
this.addCommandToMaps(Object.assign(new Pa.a("ThemesIon",M.a.$v.toString()),{queryCommandId:M.a.rz.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("ThemesOrganic",M.a.$v.toString()),{queryCommandId:M.a.rz.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("ThemesFrame",M.a.$v.toString()),{queryCommandId:M.a.rz.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("ThemesIonBoardroom",M.a.$v.toString()),{queryCommandId:M.a.rz.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("ThemesMesh",
M.a.$v.toString()),{queryCommandId:M.a.rz.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("ThemesRetrospect",M.a.$v.toString()),{queryCommandId:M.a.rz.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("ThemesSlice",M.a.$v.toString()),{queryCommandId:M.a.rz.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("ThemesSavon",M.a.$v.toString()),{queryCommandId:M.a.rz.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("ThemesBanded",M.a.$v.toString()),{queryCommandId:M.a.rz.toString()}));
this.addCommandToMaps(Object.assign(new Pa.a("ThemesQuotable",M.a.$v.toString()),{queryCommandId:M.a.rz.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("ThemesWoodType",M.a.$v.toString()),{queryCommandId:M.a.rz.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("ThemesBasis",M.a.$v.toString()),{queryCommandId:M.a.rz.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("ThemesIntegral",M.a.$v.toString()),{queryCommandId:M.a.rz.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("ThemesWisp",
M.a.$v.toString()),{queryCommandId:M.a.rz.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("ThemesDividend",M.a.$v.toString()),{queryCommandId:M.a.rz.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("ThemesCelestial",M.a.$v.toString()),{queryCommandId:M.a.rz.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("ThemesParallax",M.a.$v.toString()),{queryCommandId:M.a.rz.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("ThemesMetropolitan",M.a.$v.toString()),{queryCommandId:M.a.rz.toString()}));
this.addCommandToMaps(Object.assign(new Pa.a("ThemesFacet",M.a.$v.toString()),{queryCommandId:M.a.rz.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("ThemesViewTheme",M.a.$v.toString()),{queryCommandId:M.a.rz.toString()}))}l4h(){this.addCommandToMaps(Object.assign(new Pa.a("Transitions",M.a.Rj.toString()),{queryCommandId:M.a.yj.toString(),previewControlIds:"TransitionExisting TransitionNone TransitionMorph TransitionCut TransitionFade TransitionPush TransitionWipe".split(" ")}));this.addCommandToMaps(Object.assign(new Pa.a("TransitionExisting",
M.a.toa.toString()),{legacyControlId:"TransitionExisting",queryCommandId:M.a.Fna.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("TransitionExistingInMenu",M.a.pya.toString()),{legacyControlId:"TransitionExistingInMenu",queryCommandId:M.a.Dxa.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("TransitionNone",M.a.Rj.toString()),{legacyControlId:"TransitionNone",queryCommandId:M.a.yj.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("TransitionMorph",M.a.Rj.toString()),
{legacyControlId:"TransitionMorph",queryCommandId:M.a.yj.toString()}));this.la.qT&&Rd.a("MorphTransitionActionAIEnabled")&&this.addCommandToMaps(Object.assign(new Pa.a("TransitionMorphActionAI",M.a.Rj.toString()),{legacyControlId:"TransitionMorph",queryCommandId:M.a.yj.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("TransitionCut",M.a.Rj.toString()),{legacyControlId:"TransitionCut",queryCommandId:M.a.yj.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("TransitionFade",M.a.Rj.toString()),
{legacyControlId:"TransitionFade",queryCommandId:M.a.yj.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("TransitionPush",M.a.Rj.toString()),{legacyControlId:"TransitionPush",queryCommandId:M.a.yj.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("TransitionWipe",M.a.Rj.toString()),{legacyControlId:"TransitionWipe",queryCommandId:M.a.yj.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("TransitionSplit",M.a.Rj.toString()),{legacyControlId:"TransitionSplit",queryCommandId:M.a.yj.toString()}));
this.addCommandToMaps(Object.assign(new Pa.a("TransitionRandomBars",M.a.Rj.toString()),{legacyControlId:"TransitionRandomBars",queryCommandId:M.a.yj.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("TransitionShape",M.a.Rj.toString()),{legacyControlId:"TransitionShape",queryCommandId:M.a.yj.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("TransitionComb",M.a.Rj.toString()),{legacyControlId:"TransitionComb",queryCommandId:M.a.yj.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("TransitionBlinds",
M.a.Rj.toString()),{legacyControlId:"TransitionBlinds",queryCommandId:M.a.yj.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("TransitionBox",M.a.Rj.toString()),{legacyControlId:"TransitionBox",queryCommandId:M.a.yj.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("TransitionCover",M.a.Rj.toString()),{legacyControlId:"TransitionCover",queryCommandId:M.a.yj.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("TransitionCube",M.a.Rj.toString()),{legacyControlId:"TransitionCube",
queryCommandId:M.a.yj.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("TransitionCurtains",M.a.Rj.toString()),{legacyControlId:"TransitionCurtains",queryCommandId:M.a.yj.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("TransitionDissolve",M.a.Rj.toString()),{legacyControlId:"TransitionDissolve",queryCommandId:M.a.yj.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("TransitionOrbit",M.a.Rj.toString()),{legacyControlId:"TransitionOrbit",queryCommandId:M.a.yj.toString()}));
this.addCommandToMaps(Object.assign(new Pa.a("TransitionPageCurl",M.a.Rj.toString()),{legacyControlId:"TransitionPageCurl",queryCommandId:M.a.yj.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("TransitionPeelOff",M.a.Rj.toString()),{legacyControlId:"TransitionPeelOff",queryCommandId:M.a.yj.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("TransitionRandom",M.a.Rj.toString()),{legacyControlId:"TransitionRandom",queryCommandId:M.a.yj.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("TransitionReveal",
M.a.Rj.toString()),{legacyControlId:"TransitionReveal",queryCommandId:M.a.yj.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("TransitionRotate",M.a.Rj.toString()),{legacyControlId:"TransitionRotate",queryCommandId:M.a.yj.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("TransitionUncover",M.a.Rj.toString()),{legacyControlId:"TransitionUncover",queryCommandId:M.a.yj.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("TransitionWheel",M.a.Rj.toString()),{legacyControlId:"TransitionWheel",
queryCommandId:M.a.yj.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("TransitionRipple",M.a.Rj.toString()),{legacyControlId:"TransitionRipple",queryCommandId:M.a.yj.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("TransitionBox",M.a.Rj.toString()),{legacyControlId:"TransitionBox",queryCommandId:M.a.yj.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("TransitionCube",M.a.Rj.toString()),{legacyControlId:"TransitionCube",queryCommandId:M.a.yj.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("TransitionSwitch",
M.a.Rj.toString()),{legacyControlId:"TransitionSwitch",queryCommandId:M.a.yj.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("TransitionFallOver",M.a.Rj.toString()),{legacyControlId:"TransitionFallOver",queryCommandId:M.a.yj.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("TransitionDrape",M.a.Rj.toString()),{legacyControlId:"TransitionDrape",queryCommandId:M.a.yj.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("TransitionFlip",M.a.Rj.toString()),{legacyControlId:"TransitionFlip",
queryCommandId:M.a.yj.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("TransitionWind",M.a.Rj.toString()),{legacyControlId:"TransitionWind",queryCommandId:M.a.yj.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("TransitionPrestige",M.a.Rj.toString()),{legacyControlId:"TransitionPrestige",queryCommandId:M.a.yj.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("TransitionFracture",M.a.Rj.toString()),{legacyControlId:"TransitionFracture",queryCommandId:M.a.yj.toString()}));
this.addCommandToMaps(Object.assign(new Pa.a("TransitionCrush",M.a.Rj.toString()),{legacyControlId:"TransitionCrush",queryCommandId:M.a.yj.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("TransitionAirplane",M.a.Rj.toString()),{legacyControlId:"TransitionAirplane",queryCommandId:M.a.yj.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("TransitionOrigami",M.a.Rj.toString()),{legacyControlId:"TransitionOrigami",queryCommandId:M.a.yj.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("TransitionChecker",
M.a.Rj.toString()),{legacyControlId:"TransitionChecker",queryCommandId:M.a.yj.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("TransitionVortex",M.a.Rj.toString()),{legacyControlId:"TransitionVortex",queryCommandId:M.a.yj.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("TransitionGlitter",M.a.Rj.toString()),{legacyControlId:"TransitionGlitter",queryCommandId:M.a.yj.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("TransitionPan",M.a.Rj.toString()),{legacyControlId:"TransitionPan",
queryCommandId:M.a.yj.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("TransitionGalleryIcon",M.a.Rj.toString()),{legacyControlId:"TransitionGalleryIcon",queryCommandId:M.a.yj.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("TransitionConveyor",M.a.Rj.toString()),{legacyControlId:"TransitionConveyor",queryCommandId:M.a.yj.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("TransitionZoom",M.a.Rj.toString()),{legacyControlId:"TransitionZoom",queryCommandId:M.a.yj.toString()}));
this.addCommandToMaps(Object.assign(new Pa.a("TransitionFlyThrough",M.a.Rj.toString()),{legacyControlId:"TransitionFlyThrough",queryCommandId:M.a.yj.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("TransitionWindow",M.a.Rj.toString()),{legacyControlId:"TransitionWindow",queryCommandId:M.a.yj.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("TransitionDoors",M.a.Rj.toString()),{legacyControlId:"TransitionDoors",queryCommandId:M.a.yj.toString()}))}V3h(){this.addCommandToMaps(Object.assign(new Pa.a("Animations",
M.a.vz.toString()),{queryCommandId:M.a.Cna.toString(),previewControlIds:["AnimationExisting","AnimationNone","AnimationAppear","AnimationFadeIn","AnimationFlyIn"]}));this.addCommandToMaps(Object.assign(new Pa.a("AnimationExisting",M.a.PKb.toString()),{queryCommandId:M.a.Cna.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("AnimationExistingInMenu",M.a.C_a.toString()),{queryCommandId:M.a.Cna.toString()}));for(const a of this.R3j)this.addCommandToMaps(Object.assign(new Pa.a(a,M.a.vz.toString()),
{queryCommandId:M.a.Cna.toString()}))}U3h(){this.addCommandToMaps(Object.assign(new Pa.a("AnimationEffectOptions",M.a.CLe.toString()),{populationProps:new Yg(M.a.Xgb.toString(),!1)}));for(const a of this.N3j)this.addCommandToMaps(Object.assign(new Pa.a(a,M.a.B_a.toString()),{queryCommandId:M.a.rZa.toString(),menuItemId:a.slice(this.O3j)}));for(const a of this.P3j)this.addCommandToMaps(Object.assign(new Pa.a(a,M.a.A_a.toString()),{queryCommandId:M.a.pZa.toString(),menuItemId:a.slice(this.Q3j)}));this.addCommandToMaps(new Pa.a("AnimationEffectOptionsThemeColorPickerMCU",
M.a.hya.toString()));this.addCommandToMaps(new Pa.a("AnimationEffectOptionsThemeColorPicker",M.a.hya.toString()));this.addCommandToMaps(new Pa.a("AnimationEffectOptionsStandardColorPicker",M.a.hya.toString()));this.addCommandToMaps(Object.assign(new Pa.a("AnimationEffectOptionsSequenceAsOneObject",M.a.cnd.toString()),{queryCommandId:M.a.Dna.toString(),menuItemId:"AsOneObject"}));this.addCommandToMaps(Object.assign(new Pa.a("AnimationEffectOptionsSequenceAllAtOnce",M.a.bnd.toString()),{queryCommandId:M.a.Dna.toString(),
menuItemId:"AllAtOnce"}));this.addCommandToMaps(Object.assign(new Pa.a("AnimationEffectOptionsSequenceByParagraph",M.a.dnd.toString()),{queryCommandId:M.a.Dna.toString(),menuItemId:"ByParagraph"}));this.addCommandToMaps(Object.assign(new Pa.a("AnimationEffectOptionsSequenceOneByOne",M.a.fnd.toString()),{queryCommandId:M.a.Dna.toString(),menuItemId:"OneByOne"}))}Y3h(){this.addCommandToMaps(Object.assign(new Pa.a("FormatBackgroundSolidFillFromCanvas",M.a.NPc.toString()),{legacyControlId:"PptRibbon.Design.Customize.FormatBackgroundAnchor",
populationProps:new Yg(M.a.H$g.toString(),!1)}));for(const a of this.B6j)this.addCommandToMaps(Object.assign(new Pa.a(a,M.a.NPc.toString()),{legacyControlId:"PptRibbon.Design.Customize.FormatBackgroundAnchor"}));this.addCommandToMaps(Object.assign(new Pa.a("FormatBackgroundApplyToAllFromCanvas",M.a.KVf.toString()),{legacyControlId:"PptRibbon.Design.Customize.FormatBackgroundAnchor"}));this.addCommandToMaps(Object.assign(new Pa.a("FormatBackgroundResetFromCanvas",M.a.MVf.toString()),{legacyControlId:"PptRibbon.Design.Customize.FormatBackgroundAnchor"}));
this.addCommandToMaps(Object.assign(new Pa.a("FormatBackgroundPictureFromCanvas",M.a.LVf.toString()),{legacyControlId:"PptRibbon.Design.Customize.FormatBackgroundAnchor"}))}k4h(){this.addCommandToMaps(Object.assign(new Pa.a("TransitionEffectOptions",M.a.Mhb.toString()),{populationProps:new Yg(M.a.wHb.toString(),!1)}));for(const a of this.Adk)this.addCommandToMaps(Object.assign(new Pa.a(a,M.a.Kpc.toString()),{queryCommandId:M.a.Qid.toString(),menuItemId:a.slice(this.Bdk)}))}d4h(){this.addCommandToMaps(new Pa.a("PictureStyles",
M.a.Fra.toString()));for(const a of this.$$j){const b=a.split("_")[2];this.addCommandToMaps(Object.assign(new Pa.a(a,M.a.Fra.toString()),{queryCommandId:M.a.wc.toString(),menuItemId:b}))}}f4h(){this.addCommandToMaps(new Pa.a("ChangeSmartArtLayoutAnchor",H.a.bRa.toString()));for(const a of this.wTg){const b=a.split("__");this.addCommandToMaps(Object.assign(new Pa.a("Change"+a,M.a.TZb.toString()),{queryCommandId:M.a.wc.toString(),menuItemId:b[1]+","+b[2]}))}this.addCommandToMaps(Object.assign(new Pa.a("SmartArtEditText",
M.a.wOf.toString()),{queryCommandId:M.a.Jhd.toString()}));this.addCommandToMaps(new Pa.a("SmartArtDemote",M.a.wlc.toString()));this.addCommandToMaps(new Pa.a("SmartArtPromote",M.a.NHb.toString()));this.addCommandToMaps(new Pa.a("SmartArtResetGraphic",M.a.Qxa.toString()));this.addCommandToMaps(Object.assign(new Pa.a("SmartArtReverse",M.a.VQe.toString()),{queryCommandId:M.a.eid.toString()}));this.addCommandToMaps(new Pa.a("SmartArtStyles",M.a.LK.toString()));this.addCommandToMaps(Object.assign(new Pa.a("SmartArtStyle__simple1__simple",
M.a.LK.toString()),{queryCommandId:M.a.wc.toString(),menuItemId:"simple1,simple"}));this.addCommandToMaps(Object.assign(new Pa.a("SmartArtStyle__simple2__simple",M.a.LK.toString()),{queryCommandId:M.a.wc.toString(),menuItemId:"simple2,simple"}));this.addCommandToMaps(Object.assign(new Pa.a("SmartArtStyle__simple3__simple",M.a.LK.toString()),{queryCommandId:M.a.wc.toString(),menuItemId:"simple3,simple"}));this.addCommandToMaps(Object.assign(new Pa.a("SmartArtStyle__simple4__simple",M.a.LK.toString()),
{queryCommandId:M.a.wc.toString(),menuItemId:"simple4,simple"}));this.addCommandToMaps(Object.assign(new Pa.a("SmartArtStyle__simple5__simple",M.a.LK.toString()),{queryCommandId:M.a.wc.toString(),menuItemId:"simple5,simple"}));this.addCommandToMaps(Object.assign(new Pa.a("SmartArtStyle__3d1__3D",M.a.LK.toString()),{queryCommandId:M.a.wc.toString(),menuItemId:"3d1,3D"}));this.addCommandToMaps(Object.assign(new Pa.a("SmartArtStyle__3d2__3D",M.a.LK.toString()),{queryCommandId:M.a.wc.toString(),menuItemId:"3d2,3D"}));
this.addCommandToMaps(Object.assign(new Pa.a("SmartArtStyle__3d3__3D",M.a.LK.toString()),{queryCommandId:M.a.wc.toString(),menuItemId:"3d3,3D"}));this.addCommandToMaps(Object.assign(new Pa.a("SmartArtStyle__3d4__3D",M.a.LK.toString()),{queryCommandId:M.a.wc.toString(),menuItemId:"3d4,3D"}));this.addCommandToMaps(Object.assign(new Pa.a("SmartArtStyle__3d5__3D",M.a.LK.toString()),{queryCommandId:M.a.wc.toString(),menuItemId:"3d5,3D"}));this.addCommandToMaps(Object.assign(new Pa.a("SmartArtStyle__3d6__3D",
M.a.LK.toString()),{queryCommandId:M.a.wc.toString(),menuItemId:"3d6,3D"}));this.addCommandToMaps(Object.assign(new Pa.a("SmartArtStyle__3d7__3D",M.a.LK.toString()),{queryCommandId:M.a.wc.toString(),menuItemId:"3d7,3D"}));this.addCommandToMaps(Object.assign(new Pa.a("SmartArtStyle__3d8__3D",M.a.LK.toString()),{queryCommandId:M.a.wc.toString(),menuItemId:"3d8,3D"}));this.addCommandToMaps(Object.assign(new Pa.a("SmartArtStyle__3d9__3D",M.a.LK.toString()),{queryCommandId:M.a.wc.toString(),menuItemId:"3d9,3D"}))}a4h(){this.addCommandToMaps(new Pa.a("InsertSmartArtAnchor",
M.a.ige.toString()));for(const a of this.wTg){const b=a.split("__");this.addCommandToMaps(Object.assign(new Pa.a(a,M.a.KEa.toString()),{queryCommandId:M.a.wc.toString(),menuItemId:b[1]+","+b[2]}))}}c4h(){this.addCommandToMaps(new Pa.a("PictureCropToShapeAnchor",M.a.f$g.toString()));for(const a of this.Z$j)this.addCommandToMaps(Object.assign(new Pa.a(a,M.a.e$g.toString()),{queryCommandId:M.a.wc.toString()}))}$3h(){this.addCommandToMaps(new Pa.a("InsertShapesAll",M.a.Scg.toString()));this.addCommandToMaps(Object.assign(new Pa.a("InsertShapeStraightConnector",
M.a.QWc.toString()),{queryCommandId:M.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("InsertShapeStraightConnectorArrow",M.a.RWc.toString()),{queryCommandId:M.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("InsertShapeStraightConnectorTwoArrow",M.a.SWc.toString()),{queryCommandId:M.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("InsertShapeElbowConnector",M.a.OWc.toString()),{queryCommandId:M.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("InsertShapeElbowArrowConnector",
M.a.NWc.toString()),{queryCommandId:M.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("InsertShapeElbowDoubleArrowConnector",M.a.PWc.toString()),{queryCommandId:M.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("InsertShapeCurvedConnector",M.a.LWc.toString()),{queryCommandId:M.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("InsertShapeCurvedArrowConnector",M.a.KWc.toString()),{queryCommandId:M.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("InsertShapeCurvedDoubleArrowConnector",
M.a.MWc.toString()),{queryCommandId:M.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("InsertShapeRectangle",M.a.qfe.toString()),{queryCommandId:M.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("InsertShapeRoundedRectangle",M.a.Afe.toString()),{queryCommandId:M.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("InsertShapeSnipSingleCornerRectangle",M.a.Ife.toString()),{queryCommandId:M.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("InsertShapeSnipSameSideCornerRectangle",
M.a.Hfe.toString()),{queryCommandId:M.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("InsertShapeSnipDiagonalCornerRectangle",M.a.Ffe.toString()),{queryCommandId:M.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("InsertShapeSnipRoundSingleCornerRectangle",M.a.Gfe.toString()),{queryCommandId:M.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("InsertShapeRoundSingleCornerRectangle",M.a.zfe.toString()),{queryCommandId:M.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("InsertShapeRoundSameSideCornerRectangle",
M.a.yfe.toString()),{queryCommandId:M.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("InsertShapeRoundDiagonalCornerRectangle",M.a.xfe.toString()),{queryCommandId:M.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("InsertShapeTextBox",M.a.JEa.toString()),{queryCommandId:M.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("InsertShapeEllipse",M.a.fee.toString()),{queryCommandId:M.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("InsertShapeTriangle",
M.a.age.toString()),{queryCommandId:M.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("InsertShapeRightTriangle",M.a.wfe.toString()),{queryCommandId:M.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("InsertShapeParallelogram",M.a.gfe.toString()),{queryCommandId:M.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("InsertShapeTrapezoid",M.a.$fe.toString()),{queryCommandId:M.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("InsertShapeDiamond",
M.a.Ude.toString()),{queryCommandId:M.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("InsertShapeSPentagon",M.a.Cfe.toString()),{queryCommandId:M.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("InsertShapeHexagon",M.a.oee.toString()),{queryCommandId:M.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("InsertShapeHeptagon",M.a.nee.toString()),{queryCommandId:M.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("InsertShapeOctagon",M.a.cfe.toString()),
{queryCommandId:M.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("InsertShapeDecagon",M.a.Qde.toString()),{queryCommandId:M.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("InsertShapeDodecagon",M.a.Yde.toString()),{queryCommandId:M.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("InsertShapePie",M.a.ife.toString()),{queryCommandId:M.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("InsertShapeChord",M.a.Bde.toString()),{queryCommandId:M.a.wc.toString()}));
this.addCommandToMaps(Object.assign(new Pa.a("InsertShapeTeardrop",M.a.Yfe.toString()),{queryCommandId:M.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("InsertShapeFrame",M.a.kee.toString()),{queryCommandId:M.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("InsertShapeHalfFrame",M.a.lee.toString()),{queryCommandId:M.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("InsertShapeLShape",M.a.ree.toString()),{queryCommandId:M.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("InsertShapeDiagonalStripe",
M.a.Tde.toString()),{queryCommandId:M.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("InsertShapeCross",M.a.Hde.toString()),{queryCommandId:M.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("InsertShapePlaque",M.a.jfe.toString()),{queryCommandId:M.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("InsertShapeCan",M.a.yde.toString()),{queryCommandId:M.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("InsertShapeCube",M.a.Ide.toString()),
{queryCommandId:M.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("InsertShapeBevel",M.a.wde.toString()),{queryCommandId:M.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("InsertShapeDonut",M.a.Zde.toString()),{queryCommandId:M.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("InsertShapeNoSymbol",M.a.afe.toString()),{queryCommandId:M.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("InsertShapeBlockArc",M.a.xde.toString()),{queryCommandId:M.a.wc.toString()}));
this.addCommandToMaps(Object.assign(new Pa.a("InsertShapeFoldedCorner",M.a.jee.toString()),{queryCommandId:M.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("InsertShapeSmileyFace",M.a.Efe.toString()),{queryCommandId:M.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("InsertShapeHeart",M.a.mee.toString()),{queryCommandId:M.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("InsertShapeLightningBolt",M.a.Bee.toString()),{queryCommandId:M.a.wc.toString()}));
this.addCommandToMaps(Object.assign(new Pa.a("InsertShapeSun",M.a.Xfe.toString()),{queryCommandId:M.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("InsertShapeMoon",M.a.Zee.toString()),{queryCommandId:M.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("InsertShapeCloud",M.a.Dde.toString()),{queryCommandId:M.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("InsertShapeArc",M.a.tde.toString()),{queryCommandId:M.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("InsertShapeDoubleBracket",
M.a.aee.toString()),{queryCommandId:M.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("InsertShapeDoubleBrace",M.a.$de.toString()),{queryCommandId:M.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("InsertShapeLeftBracket",M.a.wee.toString()),{queryCommandId:M.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("InsertShapeRightBracket",M.a.vfe.toString()),{queryCommandId:M.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("InsertShapeLeftBrace",
M.a.vee.toString()),{queryCommandId:M.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("InsertShapeRightBrace",M.a.ufe.toString()),{queryCommandId:M.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("InsertShapeRightArrow",M.a.sfe.toString()),{queryCommandId:M.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("InsertShapeLeftArrow",M.a.see.toString()),{queryCommandId:M.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("InsertShapeUpArrow",M.a.cge.toString()),
{queryCommandId:M.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("InsertShapeDownArrow",M.a.cee.toString()),{queryCommandId:M.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("InsertShapeLeftRightArrow",M.a.xee.toString()),{queryCommandId:M.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("InsertShapeUpDownArrow",M.a.ege.toString()),{queryCommandId:M.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("InsertShapeQuadArrow",M.a.ofe.toString()),
{queryCommandId:M.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("InsertShapeLeftRightUpArrow",M.a.zee.toString()),{queryCommandId:M.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("InsertShapeBentArrow",M.a.ude.toString()),{queryCommandId:M.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("InsertShapeUTurnArrow",M.a.bge.toString()),{queryCommandId:M.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("InsertShapeLeftUpArrow",M.a.Aee.toString()),
{queryCommandId:M.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("InsertShapeBentUpArrow",M.a.vde.toString()),{queryCommandId:M.a.wc.toString()}));let a;this.addCommandToMaps((a=new Pa.a("InsertShapeCurvedRightArrow",M.a.Mde.toString()),a.queryCommandId=M.a.wc.toString(),a));let b;this.addCommandToMaps((b=new Pa.a("InsertShapeCurvedLeftArrow",M.a.Lde.toString()),b.queryCommandId=M.a.wc.toString(),b));let c;this.addCommandToMaps((c=new Pa.a("InsertShapeCurvedUpArrow",M.a.Nde.toString()),
c.queryCommandId=M.a.wc.toString(),c));let h;this.addCommandToMaps((h=new Pa.a("InsertShapeCurvedDownArrow",M.a.Jde.toString()),h.queryCommandId=M.a.wc.toString(),h));let m;this.addCommandToMaps((m=new Pa.a("InsertShapeStripedRightArrow",M.a.Vfe.toString()),m.queryCommandId=M.a.wc.toString(),m));let y;this.addCommandToMaps((y=new Pa.a("InsertShapeNotchedRightArrow",M.a.bfe.toString()),y.queryCommandId=M.a.wc.toString(),y));let G;this.addCommandToMaps((G=new Pa.a("InsertShapePentagon",M.a.hfe.toString()),
G.queryCommandId=M.a.wc.toString(),G));let U;this.addCommandToMaps((U=new Pa.a("InsertShapeChevron",M.a.Ade.toString()),U.queryCommandId=M.a.wc.toString(),U));let ja;this.addCommandToMaps((ja=new Pa.a("InsertShapeRightArrowCallout",M.a.tfe.toString()),ja.queryCommandId=M.a.wc.toString(),ja));let va;this.addCommandToMaps((va=new Pa.a("InsertShapeDownArrowCallout",M.a.dee.toString()),va.queryCommandId=M.a.wc.toString(),va));let Ta;this.addCommandToMaps((Ta=new Pa.a("InsertShapeLeftArrowCallout",M.a.uee.toString()),
Ta.queryCommandId=M.a.wc.toString(),Ta));let fb;this.addCommandToMaps((fb=new Pa.a("InsertShapeUpArrowCallout",M.a.dge.toString()),fb.queryCommandId=M.a.wc.toString(),fb));let Db;this.addCommandToMaps((Db=new Pa.a("InsertShapeLeftRightArrowCallout",M.a.yee.toString()),Db.queryCommandId=M.a.wc.toString(),Db));let gc;this.addCommandToMaps((gc=new Pa.a("InsertShapeQuadArrowCallout",M.a.pfe.toString()),gc.queryCommandId=M.a.wc.toString(),gc));let hc;this.addCommandToMaps((hc=new Pa.a("InsertShapeCircularArrow",
M.a.Cde.toString()),hc.queryCommandId=M.a.wc.toString(),hc));let Gc;this.addCommandToMaps((Gc=new Pa.a("InsertShapeMathPlus",M.a.Xee.toString()),Gc.queryCommandId=M.a.wc.toString(),Gc));let Pc;this.addCommandToMaps((Pc=new Pa.a("InsertShapeMathMinus",M.a.Uee.toString()),Pc.queryCommandId=M.a.wc.toString(),Pc));let yc;this.addCommandToMaps((yc=new Pa.a("InsertShapeMathMultiply",M.a.Vee.toString()),yc.queryCommandId=M.a.wc.toString(),yc));let Vd;this.addCommandToMaps((Vd=new Pa.a("InsertShapeMathDivide",
M.a.Ree.toString()),Vd.queryCommandId=M.a.wc.toString(),Vd));let De;this.addCommandToMaps((De=new Pa.a("InsertShapeMathEqual",M.a.Tee.toString()),De.queryCommandId=M.a.wc.toString(),De));let Wd;this.addCommandToMaps((Wd=new Pa.a("InsertShapeMathNotEqual",M.a.Wee.toString()),Wd.queryCommandId=M.a.wc.toString(),Wd));let Ve;this.addCommandToMaps((Ve=new Pa.a("InsertShapeProcess",M.a.mfe.toString()),Ve.queryCommandId=M.a.wc.toString(),Ve));let $e;this.addCommandToMaps(($e=new Pa.a("InsertShapeAlternateProcess",
M.a.sde.toString()),$e.queryCommandId=M.a.wc.toString(),$e));let Qf;this.addCommandToMaps((Qf=new Pa.a("InsertShapeDecision",M.a.Rde.toString()),Qf.queryCommandId=M.a.wc.toString(),Qf));let lg;this.addCommandToMaps((lg=new Pa.a("InsertShapeData",M.a.Pde.toString()),lg.queryCommandId=M.a.wc.toString(),lg));let Hg;this.addCommandToMaps((Hg=new Pa.a("InsertShapePredefinedProcess",M.a.kfe.toString()),Hg.queryCommandId=M.a.wc.toString(),Hg));let Qg;this.addCommandToMaps((Qg=new Pa.a("InsertShapeInternalStorage",
M.a.qee.toString()),Qg.queryCommandId=M.a.wc.toString(),Qg));let Sf;this.addCommandToMaps((Sf=new Pa.a("InsertShapeDocument",M.a.Xde.toString()),Sf.queryCommandId=M.a.wc.toString(),Sf));let sh;this.addCommandToMaps((sh=new Pa.a("InsertShapeMultidocument",M.a.$ee.toString()),sh.queryCommandId=M.a.wc.toString(),sh));let Xg;this.addCommandToMaps((Xg=new Pa.a("InsertShapeTerminator",M.a.Zfe.toString()),Xg.queryCommandId=M.a.wc.toString(),Xg));let ni;this.addCommandToMaps((ni=new Pa.a("InsertShapePreparation",
M.a.lfe.toString()),ni.queryCommandId=M.a.wc.toString(),ni));let Ri;this.addCommandToMaps((Ri=new Pa.a("InsertShapeManualInput",M.a.Pee.toString()),Ri.queryCommandId=M.a.wc.toString(),Ri));let uj;this.addCommandToMaps((uj=new Pa.a("InsertShapeManualOperation",M.a.Qee.toString()),uj.queryCommandId=M.a.wc.toString(),uj));let dj;this.addCommandToMaps((dj=new Pa.a("InsertShapeConnector",M.a.Gde.toString()),dj.queryCommandId=M.a.wc.toString(),dj));let ej;this.addCommandToMaps((ej=new Pa.a("InsertShapeOffpageConnector",
M.a.dfe.toString()),ej.queryCommandId=M.a.wc.toString(),ej));let Ei;this.addCommandToMaps((Ei=new Pa.a("InsertShapeCard",M.a.zde.toString()),Ei.queryCommandId=M.a.wc.toString(),Ei));let Dk;this.addCommandToMaps((Dk=new Pa.a("InsertShapePunchedTape",M.a.nfe.toString()),Dk.queryCommandId=M.a.wc.toString(),Dk));let vj;this.addCommandToMaps((vj=new Pa.a("InsertShapeSummingJunction",M.a.Wfe.toString()),vj.queryCommandId=M.a.wc.toString(),vj));let tk;this.addCommandToMaps((tk=new Pa.a("InsertShapeOr",M.a.efe.toString()),
tk.queryCommandId=M.a.wc.toString(),tk));let Fl;this.addCommandToMaps((Fl=new Pa.a("InsertShapeCollate",M.a.Fde.toString()),Fl.queryCommandId=M.a.wc.toString(),Fl));let rl;this.addCommandToMaps((rl=new Pa.a("InsertShapeSort",M.a.Jfe.toString()),rl.queryCommandId=M.a.wc.toString(),rl));let Gl;this.addCommandToMaps((Gl=new Pa.a("InsertShapeExtract",M.a.iee.toString()),Gl.queryCommandId=M.a.wc.toString(),Gl));let Vj;this.addCommandToMaps((Vj=new Pa.a("InsertShapeMerge",M.a.Yee.toString()),Vj.queryCommandId=
M.a.wc.toString(),Vj));let Ek;this.addCommandToMaps((Ek=new Pa.a("InsertShapeStoredData",M.a.Ufe.toString()),Ek.queryCommandId=M.a.wc.toString(),Ek));let Wj;this.addCommandToMaps((Wj=new Pa.a("InsertShapeDelay",M.a.Sde.toString()),Wj.queryCommandId=M.a.wc.toString(),Wj));let fk;this.addCommandToMaps((fk=new Pa.a("InsertShapeSequentialActionStorage",M.a.Dfe.toString()),fk.queryCommandId=M.a.wc.toString(),fk));let Fj;this.addCommandToMaps((Fj=new Pa.a("InsertShapeMagneticDisk",M.a.Oee.toString()),Fj.queryCommandId=
M.a.wc.toString(),Fj));let sl;this.addCommandToMaps((sl=new Pa.a("InsertShapeDirectAccessStorage",M.a.Vde.toString()),sl.queryCommandId=M.a.wc.toString(),sl));let dh;this.addCommandToMaps((dh=new Pa.a("InsertShapeDisplay",M.a.Wde.toString()),dh.queryCommandId=M.a.wc.toString(),dh));let Rl;this.addCommandToMaps((Rl=new Pa.a("InsertShapeExplosion1",M.a.gee.toString()),Rl.queryCommandId=M.a.wc.toString(),Rl));let lm;this.addCommandToMaps((lm=new Pa.a("InsertShapeExplosion2",M.a.hee.toString()),lm.queryCommandId=
M.a.wc.toString(),lm));let Fk;this.addCommandToMaps((Fk=new Pa.a("InsertShapeStar4",M.a.Pfe.toString()),Fk.queryCommandId=M.a.wc.toString(),Fk));this.addCommandToMaps(Object.assign(new Pa.a("InsertShapeStar5",M.a.Qfe.toString()),{queryCommandId:M.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("InsertShapeStar6",M.a.Rfe.toString()),{queryCommandId:M.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("InsertShapeStar7",M.a.Sfe.toString()),{queryCommandId:M.a.wc.toString()}));
this.addCommandToMaps(Object.assign(new Pa.a("InsertShapeStar8",M.a.Tfe.toString()),{queryCommandId:M.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("InsertShapeStar10",M.a.Kfe.toString()),{queryCommandId:M.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("InsertShapeStar12",M.a.Lfe.toString()),{queryCommandId:M.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("InsertShapeStar16",M.a.Mfe.toString()),{queryCommandId:M.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("InsertShapeStar24",
M.a.Nfe.toString()),{queryCommandId:M.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("InsertShapeStar32",M.a.Ofe.toString()),{queryCommandId:M.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("InsertShapeUpRibbon",M.a.fge.toString()),{queryCommandId:M.a.wc.toString()}));let Sl;this.addCommandToMaps((Sl=new Pa.a("InsertShapeDownRibbon",M.a.eee.toString()),Sl.queryCommandId=M.a.wc.toString(),Sl));let Xi;this.addCommandToMaps((Xi=new Pa.a("InsertShapeCurvedUpRibbon",M.a.Ode.toString()),
Xi.queryCommandId=M.a.wc.toString(),Xi));let xi;this.addCommandToMaps((xi=new Pa.a("InsertShapeCurvedDownRibbon",M.a.Kde.toString()),xi.queryCommandId=M.a.wc.toString(),xi));let mg;this.addCommandToMaps((mg=new Pa.a("InsertShapeVerticalScroll",M.a.gge.toString()),mg.queryCommandId=M.a.wc.toString(),mg));let eh;this.addCommandToMaps((eh=new Pa.a("InsertShapeHorizontalScroll",M.a.pee.toString()),eh.queryCommandId=M.a.wc.toString(),eh));let jh;this.addCommandToMaps((jh=new Pa.a("InsertShapeWave",M.a.hge.toString()),
jh.queryCommandId=M.a.wc.toString(),jh));let xd;this.addCommandToMaps((xd=new Pa.a("InsertShapeDoubleWave",M.a.bee.toString()),xd.queryCommandId=M.a.wc.toString(),xd));let Ne;this.addCommandToMaps((Ne=new Pa.a("InsertShapeRectangularCallout",M.a.rfe.toString()),Ne.queryCommandId=M.a.wc.toString(),Ne));let le;this.addCommandToMaps((le=new Pa.a("InsertShapeRoundedRectangleCallout",M.a.Bfe.toString()),le.queryCommandId=M.a.wc.toString(),le));let yf;this.addCommandToMaps((yf=new Pa.a("InsertShapeOvalCallout",
M.a.ffe.toString()),yf.queryCommandId=M.a.wc.toString(),yf));let Eg;this.addCommandToMaps((Eg=new Pa.a("InsertShapeCloudCallout",M.a.Ede.toString()),Eg.queryCommandId=M.a.wc.toString(),Eg));let Fi;this.addCommandToMaps((Fi=new Pa.a("InsertShapeLineCallout1BorderAccent",M.a.Eee.toString()),Fi.queryCommandId=M.a.wc.toString(),Fi));let Oj;this.addCommandToMaps((Oj=new Pa.a("InsertShapeLineCallout2BorderAccent",M.a.Iee.toString()),Oj.queryCommandId=M.a.wc.toString(),Oj));let Lo;this.addCommandToMaps((Lo=
new Pa.a("InsertShapeLineCallout3BorderAccent",M.a.Mee.toString()),Lo.queryCommandId=M.a.wc.toString(),Lo));let uk;this.addCommandToMaps((uk=new Pa.a("InsertShapeLineCallout1Accent",M.a.Dee.toString()),uk.queryCommandId=M.a.wc.toString(),uk));let po;this.addCommandToMaps((po=new Pa.a("InsertShapeLineCallout2Accent",M.a.Hee.toString()),po.queryCommandId=M.a.wc.toString(),po));let Mt;this.addCommandToMaps((Mt=new Pa.a("InsertShapeLineCallout3Accent",M.a.Lee.toString()),Mt.queryCommandId=M.a.wc.toString(),
Mt));let Nt;this.addCommandToMaps((Nt=new Pa.a("InsertShapeLineCallout1",M.a.Cee.toString()),Nt.queryCommandId=M.a.wc.toString(),Nt));let Ot;this.addCommandToMaps((Ot=new Pa.a("InsertShapeLineCallout2",M.a.Gee.toString()),Ot.queryCommandId=M.a.wc.toString(),Ot));let Pt;this.addCommandToMaps((Pt=new Pa.a("InsertShapeLineCallout3",M.a.Kee.toString()),Pt.queryCommandId=M.a.wc.toString(),Pt));let Qt;this.addCommandToMaps((Qt=new Pa.a("InsertShapeLineCallout1NoBorder",M.a.Fee.toString()),Qt.queryCommandId=
M.a.wc.toString(),Qt));let Es;this.addCommandToMaps((Es=new Pa.a("InsertShapeLineCallout2NoBorder",M.a.Jee.toString()),Es.queryCommandId=M.a.wc.toString(),Es));let Rt;this.addCommandToMaps((Rt=new Pa.a("InsertShapeLineCallout3NoBorder",M.a.Nee.toString()),Rt.queryCommandId=M.a.wc.toString(),Rt));this.addCommandToMaps(new Pa.a("InsertShapeTextBoxBig",M.a.JEa.toString()))}X3h(){this.addCommandToMaps(Object.assign(new Pa.a(Zd.J8,M.a.qmd.toString()),{queryCommandId:M.a.NLe.toString()}));this.addCommandToMaps(Object.assign(new Pa.a(Zd.WA,
M.a.rmd.toString()),{queryCommandId:M.a.OLe.toString()}));this.addCommandToMaps(Object.assign(new Pa.a(Zd.$D,M.a.smd.toString()),{queryCommandId:M.a.PLe.toString()}));this.addCommandToMaps(Object.assign(new Pa.a(Zd.ZD,M.a.pmd.toString()),{queryCommandId:M.a.MLe.toString()}));this.addCommandToMaps(Object.assign(new Pa.a(Zd.Lta,M.a.tmd.toString()),{queryCommandId:M.a.Mch.toString()}));this.addCommandToMaps(Object.assign(new Pa.a(Zd.K$a,M.a.imd.toString()),{queryCommandId:M.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Pa.a(Zd.oda,
M.a.jmd.toString()),{queryCommandId:M.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Pa.a(Zd.Kta,M.a.kmd.toString()),{queryCommandId:M.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Pa.a(Zd.oka,M.a.lmd.toString()),{queryCommandId:M.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Pa.a(Zd.pka,M.a.mmd.toString()),{queryCommandId:M.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Pa.a(Zd.DEa,M.a.nmd.toString()),{queryCommandId:M.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Pa.a(Zd.EEa,
M.a.mSe.toString()),{queryCommandId:M.a.KLe.toString()}));this.addCommandToMaps(Object.assign(new Pa.a(Zd.I8,M.a.omd.toString()),{queryCommandId:M.a.LLe.toString()}));this.addCommandToMaps(Object.assign(new Pa.a(Zd.FEa,M.a.pKa.toString()),{queryCommandId:M.a.QLe.toString()}));this.addCommandToMaps(Object.assign(new Pa.a(Zd.GEa,M.a.nSe.toString()),{queryCommandId:M.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Pa.a(Zd.HEa,M.a.oSe.toString()),{queryCommandId:M.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Pa.a(Zd.IEa,
M.a.pSe.toString()),{queryCommandId:M.a.wc.toString()}))}h4h(){this.addCommandToMaps(Object.assign(new Pa.a("Select",H.a.bRa.toString()),{legacyControlId:"idTableSelect"}));this.addCommandToMaps(Object.assign(new Pa.a("SelectTable",D.a.uKb.toString()),{legacyControlId:"btnSelectTable"}));this.addCommandToMaps(Object.assign(new Pa.a("SelectColumn",D.a.gmd.toString()),{legacyControlId:"btnSelectColumn"}));this.addCommandToMaps(Object.assign(new Pa.a("SelectRow",D.a.Roc.toString()),{legacyControlId:"btnSelectRow"}));
this.addCommandToMaps(Object.assign(new Pa.a("TableDelete",H.a.bRa.toString()),{legacyControlId:"idTableDelete"}));this.addCommandToMaps(Object.assign(new Pa.a("PowerPointDeleteTableColumn",M.a.bhd.toString()),{legacyControlId:"btnColumnDelete"}));this.addCommandToMaps(Object.assign(new Pa.a("PowerPointDeleteTableRow",M.a.olc.toString()),{legacyControlId:"btnRowDelete"}));this.addCommandToMaps(Object.assign(new Pa.a("DeleteTable",D.a.Y7.toString()),{legacyControlId:"btnTableDelete"}));this.addCommandToMaps(Object.assign(new Pa.a("InsertRowAbove",
D.a.QTa.toString()),{legacyControlId:"btnInsertRowAbove"}));this.addCommandToMaps(Object.assign(new Pa.a("InsertRowBelow",D.a.Pta.toString()),{legacyControlId:"btnInsertRowBelow"}));this.addCommandToMaps(Object.assign(new Pa.a("InsertColumnLeft",D.a.Y7b.toString()),{legacyControlId:"btnInsertColumnLeft"}));this.addCommandToMaps(Object.assign(new Pa.a("InsertColumnRight",D.a.Z7b.toString()),{legacyControlId:"btnInsertColumnRight"}));this.addCommandToMaps(new Pa.a("ApplyTableStyleOptionAnchor",H.a.bRa.toString()));
this.addCommandToMaps(Object.assign(new Pa.a("ApplyTableStyleOptionHeaderRow",D.a.MZ.toString()),{legacyControlId:"buttonFirstRow",queryCommandId:D.a.Ena.toString(),menuItemId:"buttonFirstRow"}));this.addCommandToMaps(Object.assign(new Pa.a("ApplyTableStyleOptionFirstColumn",D.a.MZ.toString()),{legacyControlId:"buttonFirstColumn",queryCommandId:D.a.Ena.toString(),menuItemId:"buttonFirstColumn"}));this.addCommandToMaps(Object.assign(new Pa.a("ApplyTableStyleOptionTotalRow",D.a.MZ.toString()),{legacyControlId:"buttonLastRow",
queryCommandId:D.a.Ena.toString(),menuItemId:"buttonLastRow"}));this.addCommandToMaps(Object.assign(new Pa.a("ApplyTableStyleOptionLastColumn",D.a.MZ.toString()),{legacyControlId:"buttonLastColumn",queryCommandId:D.a.Ena.toString(),menuItemId:"buttonLastColumn"}));this.addCommandToMaps(Object.assign(new Pa.a("ApplyTableStyleOptionBandedRows",D.a.MZ.toString()),{legacyControlId:"buttonBandedRow",queryCommandId:D.a.Ena.toString(),menuItemId:"buttonBandedRow"}));this.addCommandToMaps(Object.assign(new Pa.a("ApplyTableStyleOptionBandedColumns",
D.a.MZ.toString()),{legacyControlId:"buttonBandedColumn",queryCommandId:D.a.Ena.toString(),menuItemId:"buttonBandedColumn"}));this.addCommandToMaps(Object.assign(new Pa.a("PowerPointCellShadingMenuOpen",M.a.y5.toString()),{legacyControlId:"cellShadingColor",populationProps:new Yg(M.a.kah.toString(),!1),menuItemId:"cellShadingColor"}));this.addCommandToMaps(new Pa.a("StandardCellShadingColorPicker",M.a.y5.toString()));this.addCommandToMaps(new Pa.a("ThemeCellShadingColorPicker",M.a.y5.toString()));
this.addCommandToMaps(new Pa.a("ThemeCellShadingColorPickerMCU",M.a.y5.toString()));this.addCommandToMaps(new Pa.a("NoCellShading",M.a.xJa.toString()));this.addCommandToMaps(new Pa.a("CellShadingMoreColors",M.a.hah.toString()));this.addCommandToMaps(new Pa.a("CellShadingRecentColors",M.a.ahd.toString()));this.addCommandToMaps(Object.assign(new Pa.a("SetSizeAnchor",M.a.Eqc.toString()),{queryCommandId:M.a.IIb.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("MergeTableCells",M.a.mergeTableCells.toString()),
{legacyControlId:"btnMergeTableCells"}));this.addCommandToMaps(Object.assign(new Pa.a("SplitTableCells",M.a.splitTableCells.toString()),{legacyControlId:"btnSplitTableCells"}));this.addCommandToMaps(new Pa.a("TableAnchor",M.a.Vcg.toString()));this.addCommandToMaps(Object.assign(new Pa.a("TableStyles",D.a.LZ.toString()),{legacyControlId:"fsfaMoreTableStyles",queryCommandId:D.a.TIb.toString(),populationProps:new Yg(D.a.uHb.toString(),!1),previewControlIds:"buttonTableStyleRibbon0 buttonTableStyleRibbon1 buttonTableStyleRibbon2 buttonTableStyleRibbon3 buttonTableStyleRibbon4 buttonTableStyleRibbon5 buttonTableStyleRibbon6".split(" ")}));
this.addCommandToMaps(new Pa.a("TableAlignmentAnchor",M.a.Y$g.toString()));this.addCommandToMaps(Object.assign(new Pa.a("TableCellBottomAnchoring",M.a.Q0.toString()),{legacyControlId:"btnTableCellBottomAnchoring",queryCommandId:M.a.IJa.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("TableCellCenterJustify",M.a.pxa.toString()),{legacyControlId:"btnTableCellCenterJustify",queryCommandId:M.a.EJa.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("TableCellLeftJustify",M.a.rxa.toString()),
{legacyControlId:"btnTableCellLeftJustify",queryCommandId:M.a.FJa.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("TableCellMiddleAnchoring",M.a.R0.toString()),{legacyControlId:"btnTableCellMiddleAnchoring",queryCommandId:M.a.JJa.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("TableCellRightJustify",M.a.txa.toString()),{legacyControlId:"btnTableCellRightJustify",queryCommandId:M.a.HJa.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("TableCellTopAnchoring",M.a.S0.toString()),
{legacyControlId:"btnTableCellTopAnchoring",queryCommandId:M.a.KJa.toString()}));this.addCommandToMaps(new Pa.a("TableAlternativeText",M.a.Wqb.toString()));this.addCommandToMaps(new Pa.a("DistributeRows",M.a.qNf.toString()));this.addCommandToMaps(new Pa.a("DistributeColumns",M.a.pNf.toString()));this.addCommandToMaps(new Pa.a("TableDistribute",M.a.Szh.toString()));this.addCommandToMaps(Object.assign(new Pa.a("SetCellBorderColor",M.a.uzh.toString()),{populationProps:new Yg(M.a.A$g.toString(),!1)}));
this.addCommandToMaps(new Pa.a("CellBorderColorPickerMCU",M.a.B0a.toString()));this.addCommandToMaps(new Pa.a("CellBorderColorPicker",M.a.B0a.toString()));this.addCommandToMaps(new Pa.a("StandardCellBorderColorPicker",M.a.B0a.toString()));this.addCommandToMaps(new Pa.a("CellBorderRecentColors",M.a.aah.toString()));this.addCommandToMaps(new Pa.a("CellBorderMoreColors",M.a.$Yg.toString()));this.addCommandToMaps(new Pa.a("TableBorderWidthAnchor",M.a.Izh.toString()));this.addCommandToMaps(Object.assign(new Pa.a("TableBorderWidth_1",
M.a.Oya.toString()),{queryCommandId:M.a.JMe.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("TableBorderWidth_2",M.a.Oya.toString()),{queryCommandId:M.a.KMe.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("TableBorderWidth_3",M.a.Oya.toString()),{queryCommandId:M.a.LMe.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("TableBorderWidth_4",M.a.Oya.toString()),{queryCommandId:M.a.MMe.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("TableBorderWidth_5",M.a.Oya.toString()),
{queryCommandId:M.a.NMe.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("TableBorderWidth_6",M.a.Oya.toString()),{queryCommandId:M.a.OMe.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("TableBorderWidth_7",M.a.Oya.toString()),{queryCommandId:M.a.PMe.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("TableBorderWidth_8",M.a.Oya.toString()),{queryCommandId:M.a.QMe.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("TableBorderWidth_9",M.a.Oya.toString()),{queryCommandId:M.a.RMe.toString()}));
this.addCommandToMaps(new Pa.a("TableBorderTypeAnchor",M.a.Hzh.toString()));this.addCommandToMaps(Object.assign(new Pa.a("TableBordersNoBorder",M.a.Koa.toString()),{queryCommandId:M.a.FMe.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("TableBordersAllBorders",M.a.Koa.toString()),{queryCommandId:M.a.xMe.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("TableBordersOutsideBorders",M.a.Koa.toString()),{queryCommandId:M.a.GMe.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("TableBordersInsideBorders",
M.a.wzh.toString()),{queryCommandId:M.a.BMe.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("TableBordersTopBorder",M.a.Koa.toString()),{queryCommandId:M.a.IMe.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("TableBordersBottomBorder",M.a.Koa.toString()),{queryCommandId:M.a.yMe.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("TableBordersLeftBorder",M.a.Koa.toString()),{queryCommandId:M.a.EMe.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("TableBordersRightBorder",
M.a.Koa.toString()),{queryCommandId:M.a.HMe.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("TableBordersInsideHorizontalBorder",M.a.vzh.toString()),{queryCommandId:M.a.CMe.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("TableBordersInsideVerticalBorder",M.a.xzh.toString()),{queryCommandId:M.a.DMe.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("TableBordersDiagonalUpBorder",M.a.Koa.toString()),{queryCommandId:M.a.AMe.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("TableBordersDiagonalDownBorder",
M.a.Koa.toString()),{queryCommandId:M.a.zMe.toString()}));this.addCommandToMaps(new Pa.a("TableCellMarginAnchor",M.a.FZe.toString()));this.addCommandToMaps(Object.assign(new Pa.a("ApplyTableCellMarginNormal",M.a.Jrc.toString()),{queryCommandId:M.a.Mid.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("ApplyTableCellMarginNone",M.a.Irc.toString()),{queryCommandId:M.a.Lid.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("ApplyTableCellMarginNarrow",M.a.Hrc.toString()),{queryCommandId:M.a.Kid.toString()}));
this.addCommandToMaps(Object.assign(new Pa.a("ApplyTableCellMarginWide",M.a.Mrc.toString()),{queryCommandId:M.a.Nid.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("TableCellMarginCustom",M.a.Eqc.toString()),{queryCommandId:M.a.IIb.toString()}))}Y4h(){this.Fi(Object.assign(new fg("ContextualTabs.Tables.Design.Shading"),{externalUxCommandIds:["PowerPointCellShadingMenuOpen"]}));this.Fi(Object.assign(new fg("ContextualTabs.Tables.Design.TableStyleOptions"),{externalUxGroupId:"TableTableStyleOptions"}));
this.Fi(Object.assign(new fg("ContextualTabs.Tables.Design.TableStyles"),{externalUxGroupId:"TableStyles"}));this.Fi(Object.assign(new fg("ContextualTabs.Tables.Layout.Alignment"),{externalUxGroupId:"Alignment"}));this.Fi(Object.assign(new fg("ContextualTabs.Tables.Layout.CellSize"),{externalUxCommandIds:["SetSizeAnchor"]}));this.Fi(Object.assign(new fg("ContextualTabs.Tables.Layout.Properties"),{externalUxCommandIds:["AlternativeText"]}));this.Fi(Object.assign(new fg("ContextualTabs.Tables.Layout.RowColumn"),
{externalUxCommandIds:["TableDelete","InsertRowAbove","InsertRowBelow","InsertColumnLeft","InsertColumnRight"]}));this.Fi(Object.assign(new fg("ContextualTabs.Tables.Layout.Table"),{externalUxCommandIds:["Select"]}));this.Fi(Object.assign(new fg("ContextualTabs.Tables.Layout.TableSize"),{externalUxGroupId:"TableSize"}));this.Fi(Object.assign(new fg("PptRibbon.Animation.Gallery"),{externalUxGroupId:"AnimationGallery"}));this.Fi(Object.assign(new fg("PptRibbon.Animation.Timing"),{externalUxGroupId:"Timing"}));
this.Fi(Object.assign(new fg("PptRibbon.Design.Customize"),{externalUxGroupId:"Customize"}));this.Fi(Object.assign(new fg("PptRibbon.Design.Designer"),{externalUxGroupId:"Designer"}));this.Fi(Object.assign(new fg("PptRibbon.Design.Designer.New"),{externalUxGroupId:"DesignerNew"}));this.Fi(Object.assign(new fg("PptRibbon.Home.Designer"),{externalUxGroupId:"DesignerHome"}));this.Fi(Object.assign(new fg("PptRibbon.Home.Ideas"),{externalUxGroupId:"Ideas"}));this.la.qT&&this.addCommandToMaps(new Pa.a("ChatPPTPane",
M.a.XZb.toString()));this.Fi(Object.assign(new fg("PptRibbon.Design.ThemeVariants"),{externalUxGroupId:"MoreVariants"}));this.Fi(Object.assign(new fg("PptRibbon.DrawingFormat.InsertShapes"),{externalUxGroupId:"InsertShapes"}));this.Fi(Object.assign(new fg("PptRibbon.DrawingFormat.ShapeStyles"),{externalUxGroupId:"ShapeStyles"}));this.Fi(Object.assign(new fg("PptRibbon.Home.ClipboardCutEnabled"),{externalUxCommandIds:["Cut"]}));this.Fi(Object.assign(new fg("PptRibbon.Home.Delete"),{externalUxGroupId:"Delete"}));
this.Fi(Object.assign(new fg("PptRibbon.Home.Dictation"),{externalUxGroupId:"Dictation"}));this.Fi(Object.assign(new fg("PptRibbon.Home.Drawing"),{externalUxGroupId:"Drawing"}));this.Fi(Object.assign(new fg("PptRibbon.Home.Editing"),{externalUxGroupId:"Editing"}));this.Fi(Object.assign(new fg("PptRibbon.Home.Font"),{externalUxGroupId:"Font"}));this.Fi(Object.assign(new fg("PptRibbon.Home.Slides"),{externalUxGroupId:"Slides"}));this.Fi(Object.assign(new fg("PptRibbon.Home.UndoRedo"),{externalUxGroupId:"Undo"}));
this.Fi(Object.assign(new fg("PptRibbon.InsertTab.AppForOffice"),{externalUxCommandIds:["InsertAddIns"]}));this.Fi(Object.assign(new fg("PptRibbon.InsertTab.Comments"),{externalUxCommandIds:["InsertComment"]}));this.Fi(Object.assign(new fg("PptRibbon.InsertTab.Illustrations"),{externalUxCommandIds:["InsertShapesAll","InsertIconDialog","InsertSmartArtAnchor"]}));this.Fi(Object.assign(new fg("PptRibbon.InsertTab.Images"),{externalUxCommandIds:["Picture","OnlinePictures"]}));this.Fi(Object.assign(new fg("PptRibbon.InsertTab.InsertHyperlink"),
{externalUxCommandIds:["InsertLink"]}));this.Fi(Object.assign(new fg("PptRibbon.InsertTab.InsertSlides"),{externalUxCommandIds:["InsertSlides"]}));this.Fi(Object.assign(new fg("PptRibbon.InsertTab.InsertTables"),{externalUxCommandIds:["TableAnchor"]}));this.Fi(Object.assign(new fg("PptRibbon.InsertTab.InvokeFilesSerplet"),{externalUxCommandIds:["InvokeFilesSerplet"]}));this.Fi(Object.assign(new fg("PptRibbon.InsertTab.Media"),{externalUxCommandIds:["InsertOnlineVideo"]}));this.Fi(Object.assign(new fg("PptRibbon.InsertTab.Symbols"),
{externalUxCommandIds:["InsertSymbol"]}));this.Fi(Object.assign(new fg("PptRibbon.InsertTab.Text"),{externalUxCommandIds:["InsertTextBox"]}));this.Fi(Object.assign(new fg("PptRibbon.PictureFormat.Adjust"),{externalUxGroupId:"Adjust"}));this.Fi(Object.assign(new fg("PptRibbon.PictureFormat.Size"),{externalUxCommandIds:["PictureCropAnchor"]}));this.Fi(Object.assign(new fg("PptRibbon.PictureFormat.Style"),{externalUxGroupId:"PictureStyles"}));this.Fi(Object.assign(new fg("PptRibbon.Review.Comments"),
{externalUxGroupId:"Comments"}));this.Fi(Object.assign(new fg("PptRibbon.Review.Inspect"),{externalUxGroupId:"Accessibility"}));this.Fi(Object.assign(new fg("PptRibbon.Review.Translate "),{externalUxGroupId:"Translate"}));this.Fi(Object.assign(new fg("PptRibbon.Review.Activity"),{externalUxGroupId:"Activity"}));this.Fi(Object.assign(new fg("PptRibbon.SmartArt.CreateGraphic"),{externalUxGroupId:"SmartArtCreateGraphic"}));this.Fi(Object.assign(new fg("PptRibbon.SmartArt.Layouts"),{externalUxGroupId:"SmartArtLayouts"}));
this.Fi(Object.assign(new fg("PptRibbon.SmartArt.Reset"),{externalUxGroupId:"SmartArtReset"}));this.Fi(Object.assign(new fg("PptRibbon.SmartArt.Styles"),{externalUxGroupId:"SmartArtStyles"}));this.Fi(Object.assign(new fg("PptRibbon.Transition.AllSlides"),{externalUxGroupId:"TransitionAllSlides"}));this.Fi(Object.assign(new fg("PptRibbon.Transition.Gallery"),{externalUxGroupId:"Transitions"}));this.Fi(Object.assign(new fg("PptRibbon.Transition.Timing"),{externalUxGroupId:"TransitionTiming"}));this.Fi(Object.assign(new fg("PptRibbon.Review.Proofing"),
{externalUxGroupId:"Proofing"}));this.Fi(Object.assign(new fg("PptRibbon.View.PresentationViews"),{externalUxCommandIds:["ReadingView"]}));this.Fi(Object.assign(new fg("PptRibbon.View.ShowHide"),{externalUxCommandIds:["Notes","ShowHideComments"]}));this.Fi(Object.assign(new fg("PptRibbon.View.StartSlideShow"),{externalUxGroupId:"StartSlideShow"}));this.Fi(Object.assign(new fg("PptRibbon.View.Zoom"),{externalUxGroupId:"Zoom"}));this.Fi(Object.assign(new fg("PptRibbon.View.Subtitles"),{externalUxGroupId:"Subtitles"}));
this.Fi(Object.assign(new fg("PptRibbon.Help.GroupHelp"),{externalUxGroupId:"Help"}));this.Fi(Object.assign(new fg("PptRibbon.PictureFormat.PictureBorders"),{externalUxGroupId:"PictureBorders"}));this.Fi(Object.assign(new fg("PptRibbon.DrawingFormat.NewArrange"),{externalUxGroupId:"Arrange"}));this.Fi(Object.assign(new fg("PptRibbon.PictureFormat.NewArrange"),{externalUxGroupId:"Arrange"}));this.Fi(Object.assign(new fg("PptRibbon.Graphics.NewArrange"),{externalUxGroupId:"GraphicsArrange"}));this.Fi(Object.assign(new fg("PptRibbon.DrawingFormat.FormatOptions"),
{externalUxGroupId:"Properties"}));this.Fi(Object.assign(new fg("PptRibbon.PictureFormat.FormatOptions"),{externalUxGroupId:"Size"}));this.Fi(Object.assign(new fg("PptRibbon.Graphics.FormatOptions"),{externalUxGroupId:"Properties"}))}S3h(){this.addCommandToMaps(Object.assign(new Pa.a("PptFileMenuEmbed",M.a.Ujb.toString()),{legacyControlId:"PptJewel.Share.Embed"}));this.addCommandToMaps(Object.assign(new Pa.a("PptFileMenuShare",H.a.Ksa.toString()),{legacyControlId:"PptJewel.Share.ShareWithPeople"}));
this.addCommandToMaps(Object.assign(new Pa.a("PptFileMenuTermsOfUse",H.a.PGb.toString()),{legacyControlId:"PptJewel.About.TermsOfUse"}));this.addCommandToMaps(Object.assign(new Pa.a("PptFileMenuThirdPartyNotices",H.a.iMb.toString()),{legacyControlId:"PptJewel.About.ThirdPartyNotices"}));this.addCommandToMaps(Object.assign(new Pa.a("PptFileMenuPrivacy",H.a.bIb.toString()),{legacyControlId:"PptJewel.About.Privacy"}));this.addCommandToMaps(Object.assign(new Pa.a("PptFileAboutPage",H.a.qe.toString()),
{legacyControlId:"PptJewel.About"}));this.addCommandToMaps(Object.assign(new Pa.a("PptFileHomePage",H.a.hlc.toString()),{legacyControlId:"PptJewel.Home"}));this.addCommandToMaps(Object.assign(new Pa.a("PptFileAddinPage",H.a.qe.toString()),{legacyControlId:"PptJewel.Addin"}));this.addCommandToMaps(Object.assign(new Pa.a("PptFileInfoPage",H.a.qe.toString()),{legacyControlId:"PptJewel.Info"}));this.addCommandToMaps(Object.assign(new Pa.a("PptFileNewPage",H.a.hlc.toString()),{legacyControlId:"PptJewel.New"}));
this.addCommandToMaps(Object.assign(new Pa.a("PptFileOpenPage",H.a.Ugd.toString()),{legacyControlId:"PptJewel.Open"}));this.addCommandToMaps(Object.assign(new Pa.a("PptFilePrintPage",H.a.qe.toString()),{legacyControlId:"PptJewel.Print"}));this.addCommandToMaps(Object.assign(new Pa.a("PptFileSaveAsPage",H.a.qe.toString()),{legacyControlId:"PptJewel.SaveACopy"}));this.addCommandToMaps(Object.assign(new Pa.a("PptFileSharePage",H.a.qe.toString()),{legacyControlId:"PptJewel.Share"}))}Z3h(){this.addCommandToMaps(new Pa.a("GroupAnchor",
M.a.zJe.toString()));this.addCommandToMaps(new Pa.a("GroupShapes",M.a.AJe.toString()));this.addCommandToMaps(new Pa.a("UngroupShapes",M.a.IJe.toString()))}W3h(){this.addCommandToMaps(new Pa.a("AudioPlay",M.a.$Gc.toString()));this.addCommandToMaps(new Pa.a("AudioPause",M.a.IYb.toString()));this.addCommandToMaps(Object.assign(new Pa.a("SetAudioOptions",M.a.Poh.toString()),{queryCommandId:M.a.$lc.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("PlayAcrossSlides",M.a.playAcrossSlides.toString()),
{queryCommandId:M.a.qmc.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("LoopUntilStopped",M.a.loopUntilStopped.toString()),{queryCommandId:M.a.mmc.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("HideDuringShow",M.a.hideDuringShow.toString()),{queryCommandId:M.a.hmc.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("RewindAfterPlaying",M.a.rewindAfterPlaying.toString()),{queryCommandId:M.a.vmc.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("PlayInBackground",
M.a.playInBackground.toString()),{queryCommandId:M.a.rmc.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("NoAudioStyle",M.a.noAudioStyle.toString()),{queryCommandId:M.a.nmc.toString()}));this.addCommandToMaps(new Pa.a("SetVolume",M.a.setVolume.toString()));this.addCommandToMaps(Object.assign(new Pa.a("SetVolumeLow",M.a.pod.toString()),{queryCommandId:M.a.zmc.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("SetVolumeMedium",M.a.qod.toString()),{queryCommandId:M.a.Amc.toString()}));
this.addCommandToMaps(Object.assign(new Pa.a("SetVolumeHigh",M.a.ood.toString()),{queryCommandId:M.a.ymc.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("SetVolumeMute",M.a.rod.toString()),{queryCommandId:M.a.Bmc.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("StartAudio",M.a.jxh.toString()),{queryCommandId:M.a.Jmc.toString()}))}g4h(){this.addCommandToMaps(Object.assign(new Pa.a("GetSlideInformation",H.a.E7.toString()),{queryCommandId:M.a.PIb.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("OpenLanguageDialog",
M.a.Afd.toString()),{legacyControlId:"PptEditingStatusBar.LanguageButton",queryCommandId:M.a.sIb.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("OpenDocumentLabelPane",H.a.tHe.toString()),{queryCommandId:H.a.xIb.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("TextForOfficeOnlineInGallatin",H.a.E7.toString()),{legacyControlId:"PptEditingStatusBar.MiddleStatus"}));this.addCommandToMaps(Object.assign(new Pa.a("GetEnvironmentName",H.a.E7.toString()),{legacyControlId:"EnvironmentLabel",
queryCommandId:H.a.FLe.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("GetSlideScore",H.a.E7.toString()),{legacyControlId:"SlideScoreLabel",queryCommandId:M.a.ddh.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("GetCoAuthStatus",H.a.E7.toString()),{legacyControlId:"CoauthStatusLabel",queryCommandId:M.a.Ech.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("GetDataSyncMode",H.a.E7.toString()),{legacyControlId:"DataSyncModeLabel",queryCommandId:M.a.Fch.toString()}));
this.addCommandToMaps(Object.assign(new Pa.a("GetOfflineStatus",H.a.E7.toString()),{legacyControlId:"PptEditingStatusBar.OfflineModeStatusLabel",queryCommandId:M.a.Tch.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("ShowAddInCommandsLoadStatusCallout",H.a.mWe.toString()),{legacyControlId:"PptEditingStatusBar.AddInCommandsLoadStatus",queryCommandId:H.a.nIb.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("OpenFeedbackDialog",H.a.giveFeedback.toString()),{legacyControlId:"PptEditingStatusBar.GiveFeedback"}));
this.addCommandToMaps(Object.assign(new Pa.a("GiveFeedbackPane",H.a.mKb.toString()),{legacyControlId:"PptEditingStatusBar.GiveFeedbackPane"}));this.addCommandToMaps(Object.assign(new Pa.a("ShowHidePerfStats",M.a.qpd.toString()),{legacyControlId:"PptEditingStatusBar.PerfStats",queryCommandId:M.a.omc.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("ShowHideNotes",M.a.SKa.toString()),{legacyControlId:"PptEditingStatusBar.Notes",queryCommandId:M.a.Uhd.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("ShowEditTriPaneViewInStatusBar",
M.a.QKa.toString()),{legacyControlId:"PptEditingStatusBar.Edit",queryCommandId:M.a.oIb.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("ShowSorterViewInStatusBar",M.a.Xfa.toString()),{legacyControlId:"PptEditingStatusBar-SlideSorterView",queryCommandId:M.a.QIb.toString()}));this.addCommandToMaps(Object.assign(new Pa.a("SwitchToReadingMode",M.a.sjd.toString()),{legacyControlId:"PptEditingStatusBar.Reading"}));this.addCommandToMaps(Object.assign(new Pa.a("StartSlideShowFromCurrentSlide",
M.a.Gya.toString()),{legacyControlId:"PptEditingStatusBar.SlideShow"}));this.addCommandToMaps(new Pa.a("ZoomOut",H.a.Ltb.toString()));this.addCommandToMaps(Object.assign(new Pa.a("OpenZoomConfig",M.a.zHe.toString()),{legacyControlId:"PptEditingStatusBar.ZoomScale",queryCommandId:M.a.YMe.toString()}));this.addCommandToMaps(new Pa.a("ZoomIn",H.a.Mxb.toString()));this.addCommandToMaps(Object.assign(new Pa.a("ZoomToFit",M.a.vuc.toString()),{legacyControlId:"PptEditingStatusBar.FitToWindow"}))}T3h(){this.addCommandToMaps(new Pa.a("AccessibleAuthoringHelp",
M.a.upf.toString()));this.addCommandToMaps(new Pa.a("AddHiddenSlideTitle",M.a.Hqf.toString()));this.addCommandToMaps(new Pa.a("AddSlideTitle",M.a.addSlideTitle.toString()));this.addCommandToMaps(new Pa.a("EditSlideTitle",M.a.editSlideTitle.toString()));this.addCommandToMaps(new Pa.a("InsertCaptions",M.a.Ecg.toString()));this.addCommandToMaps(new Pa.a("InsertCaptionsSplitButton",M.a.Fcg.toString()));this.addCommandToMaps(new Pa.a("LinkText",M.a.eah.toString()));this.addCommandToMaps(new Pa.a("RemoveAllCaptions",
M.a.Cgh.toString()));this.addCommandToMaps(new Pa.a("SetAsSlideTitle",M.a.setAsSlideTitle.toString()));this.addCommandToMaps(new Pa.a("SlideTitle",M.a.nqf.toString()))}}Object(n.a)(UA,"PPTWebEditReactCommandDefinitionMapping",Xw,[]);class Iy{}Iy.mzh="TabId";Object(n.a)(Iy,"RibbonSQMProperties",null,[]);class $A{constructor(a){this.Ca=a;this.Ca.ya(H.a.Gkd,he.a.frame,Object(F.a)(this,this.Gkd,"reportTabSwitch"));this.Ca.ya(H.a.Gjh,he.a.frame,ed.ActionManager.Jg);this.Ca.ya(H.a.Ijh,he.a.frame,ed.ActionManager.Jg)}Gkd(a,
b,c,h,m){this.Ca.processAction(this.Qfj(m[Iy.mzh]),2);return 32}}Object(n.a)($A,"RibbonSQMInformation",null,[559]);class th{}th.hFc="PptRibbon.AddIns";th.cW="PptRibbon.Animation";th.design="PptRibbon.Design";th.nMc="PptRibbon.Developer";th.uUc="PptRibbon.Graphics";th.help="PptRibbon.Help";th.home="PptRibbon.Home";th.insert="PptRibbon.InsertTab";th.picture="PptRibbon.PictureFormat";th.review="PptRibbon.Review";th.shape="PptRibbon.DrawingFormat";th.slideShow="PptRibbon.SlideShow";th.smartArt="PptRibbon.SmartArt";
th.Rzh="ContextualTabs.Tables.Design";th.tableLayout="ContextualTabs.Tables.Layout";th.M0a="PptRibbon.Transition";th.view="PptRibbon.View";Object(n.a)(th,"MLRTabIds",null,[]);class mj{}mj.hFc="AddIns";mj.cW="Animations";mj.design="Design";mj.nMc="Developer";mj.draw="Draw";mj.uUc="Graphics";mj.help="Help";mj.home="Home";mj.insert="Insert";mj.picture="FormatPicture";mj.review="Review";mj.shape="FormatShape";mj.slideShow="SlideShow";mj.smartArt="SmartArtDesign";mj.table="Table";mj.M0a="Transitions";
mj.view="View";Object(n.a)(mj,"SLRTabIds",null,[]);class WF extends $A{constructor(a){super(a)}vQk(){this.Ca.ya(H.a.sjh,he.a.frame,ed.ActionManager.Jg);this.Ca.ya(M.a.tjh,he.a.frame,ed.ActionManager.Jg);this.Ca.ya(M.a.ujh,he.a.frame,ed.ActionManager.Jg);this.Ca.ya(H.a.vjh,he.a.frame,ed.ActionManager.Jg);this.Ca.ya(M.a.xjh,he.a.frame,ed.ActionManager.Jg);this.Ca.ya(H.a.yjh,he.a.frame,ed.ActionManager.Jg);this.Ca.ya(H.a.zjh,he.a.frame,ed.ActionManager.Jg);this.Ca.ya(H.a.Ajh,he.a.frame,ed.ActionManager.Jg);
this.Ca.ya(M.a.Bjh,he.a.frame,ed.ActionManager.Jg);this.Ca.ya(H.a.Cjh,he.a.frame,ed.ActionManager.Jg);this.Ca.ya(M.a.Djh,he.a.frame,ed.ActionManager.Jg);this.Ca.ya(M.a.Ejh,he.a.frame,ed.ActionManager.Jg);this.Ca.ya(M.a.Fjh,he.a.frame,ed.ActionManager.Jg);this.Ca.ya(M.a.aQe,he.a.frame,ed.ActionManager.Jg);this.Ca.ya(M.a.Hjh,he.a.frame,ed.ActionManager.Jg);this.Ca.ya(H.a.Jjh,he.a.frame,ed.ActionManager.Jg)}Qfj(a){let b=H.a.Ijh,c="PptRibbon.Unknown";switch(a){case th.hFc:case mj.hFc:c=th.hFc;b=H.a.sjh;
break;case th.cW:case mj.cW:c=th.cW;b=M.a.tjh;break;case th.design:case mj.design:c=th.design;b=M.a.ujh;break;case th.nMc:case mj.nMc:c=th.nMc;b=H.a.vjh;break;case mj.draw:c=a;b=M.a.wjh;break;case th.uUc:case mj.uUc:c=th.uUc;b=M.a.xjh;break;case th.help:case mj.help:c=th.help;b=H.a.yjh;break;case th.home:case mj.home:c=th.home;b=H.a.zjh;break;case th.insert:case mj.insert:c=th.insert;b=H.a.Ajh;break;case th.picture:case mj.picture:c=th.picture;b=M.a.Bjh;break;case th.review:case mj.review:c=th.review;
b=H.a.Cjh;break;case th.shape:case mj.shape:c=th.shape;b=M.a.Djh;break;case th.slideShow:case mj.slideShow:c=th.slideShow;b=M.a.Ejh;break;case th.smartArt:case mj.smartArt:c=th.smartArt;b=M.a.Fjh;break;case th.Rzh:case th.tableLayout:c=a;b=M.a.aQe;break;case mj.table:c=th.Rzh;b=M.a.aQe;break;case th.M0a:case mj.M0a:c=th.M0a;b=M.a.Hjh;break;case th.view:case mj.view:c=th.view,b=H.a.Jjh}if(a=Nc.a.Ib)a.actionName=c,a.Nj=!0,a.Qr=!1;return b}}Object(n.a)(WF,"PPTWebEditorRibbonSQMInformation",$A,[]);var qv=
d(916);class aB{constructor(){this.nPb=null}Nul(){this.nPb||(this.nPb=vb.a.instance.rb("Common.App.AccountSwitching.IAccountSwitching"))||ba.ULS.sendTraceTag(589050651,1300,10,"Unable to resolve IAccountSwitching")}d1i(){this.Nul();return this.nPb?this.nPb.getCustomAuthConfig():null}static XJj(){return u.AFrameworkApplication.fa.ka("UiHostSupportsCustomAuthConfig")}}Object(n.a)(aB,"ReactSharedHeaderAccountSwitchingUtils",null,[]);class bB{constructor(){this.P$b=this.cultureName=null}}Object(n.a)(bB,
"HeaderCultureInfo",null,[]);var Jy=d(665);class XF{constructor(){this.getTokenRequestDictionary=this.userRing=this.loadTellMeResources=null}}Object(n.a)(XF,"SearchInitializationSettings",null,[]);class YF{constructor(){this.saveStatus=this.documentTitle=null;this.isVersionHistoryEnabled=!1;this.breadcrumbFolderUrl=this.breadcrumbFolderName=this.breadcrumbBrandUrl=this.breadcrumbBrandName=null;this.hideDocumentTitleInput=!1;this.getCalloutAppProps=this.onFirstRender=this.onGetSuggestedTitle=this.documentExtension=
null;this.isShared=!1}}Object(n.a)(YF,"DocumentTitleAppProps",null,[]);class ZF{constructor(){this.documentExtension=this.breadcrumbFolderUrl=this.breadcrumbFolderName=this.breadcrumbBrandUrl=this.breadcrumbBrandName=null;this.isMoveEnabled=this.isVersionHistoryEnabled=this.hideDocumentTitleInput=!1;this.renameDisableReason=this.message=this.onMove=null;this.openBreadcrumbsInNewTab=!1}}Object(n.a)(ZF,"DocumentTitleCalloutAppProps",null,[]);class $F{constructor(){this.language=this.culture=this.userID=
this.emailAddress=this.userDisplayName=this.appName=null;this.defaultDocumentTitleToLeft=this.hideUserName=this.showDiscoverPremiumButton=this.showMeControl=this.showAppLauncher=this.isConsumer=!1;this.documentTitleAppProps=this.controls=this.assetsContainerOverride=null;this.showGoPremiumControl=this.enableSearchControl=this.showSearchControl=this.showChatControl=!1;this.onFlexPaneClose=this.onFlexPaneOpen=this.getTokenRequestDictionary=this.signOutLink=this.signInLink=null;this.enableTheming=!1;
this.userRing=null;this.testTraffic=!1;this.onLoadFailed=this.onFullyLoaded=this.onFirstRender=this.loadTellMeResources=null;this.showDocumentTitleControl=this.showRibbonToggle=this.showWorkflowButton=this.enableVanillaSearchBox=!1;this.shellAuthProviderConfigPromise=null;this.enableUpdatedRUMReporting=!1}}Object(n.a)($F,"HeaderAppProps",null,[]);class aG{constructor(){this.workflowButton=this.ribbonToggleId=null}}Object(n.a)(aG,"HeaderControls",null,[]);class bG{constructor(){this.command=this.label=
null}}Object(n.a)(bG,"WorkflowButtonAppProps",null,[]);var Ky;(function(a){a[a.none=0]="none";a[a.readOnly=1]="readOnly";a[a.insufficientPermission=2]="insufficientPermission";a[a.incompatibleEditorsPresent=3]="incompatibleEditorsPresent";a[a.editorsPresent=4]="editorsPresent";a[a.notSupported=5]="notSupported"})(Ky||(Ky={}));Object(n.b)("RenameDisableReason",Ky);class cG{constructor(a=""){this.aSe=this.documentTitleAppProps=this.t4e=null;this.g0h=""!==a?a:Rn.a.fP}dfj(a){const b=vb.a.instance.rb("Common.IExternalUICommandDefinitionMapping").EDa(a);
if(b&&0<b.length)return b[0].externalUxCommand;ba.ULS.sendTraceTag(594929363,340,10,String.format("GetReactCommand cannot find the command mapping for {0}",a));return null}c$d(){if(!this.t4e){const a=qv.a();if(a){const b=this.dfj(a.command);b&&(this.t4e=Object.assign(new bG,{command:b,label:a.label}))}}return this.t4e}j5i(){return Object.assign(new aG,{workflowButton:this.c$d()})}aok(){Ja.a.get_instance().PJ(17)}onMove(){const a={};a.MoveButtonClickedTime=new Date;u.AFrameworkApplication.Ta.La(H.a.Tfb,
2,a)}Dfj(a){switch(a){case 1:return CommonUIStrings.l_CalloutRenameReadOnlyError;case 2:return CommonUIStrings.l_CalloutRenamePermissionError;case 3:case 4:return CommonUIStrings.l_CalloutRenameCoauthError;case 5:return null;default:return CommonUIStrings.l_CalloutRenameGenericError}}h7i(){let a=null,b=null;var c=vb.a.instance.rb("Common.IRenameProps");c?(c=c.u3f(),0!==c&&(a=this.Dfj(c),b=Ky[c])):ba.ULS.sendTraceTag(572375621,340,15,"IRenameProps not yet initialized");return Object.assign(new ZF,
{breadcrumbBrandName:u.AFrameworkApplication.xu.breadcrumbBrandName,breadcrumbBrandUrl:u.AFrameworkApplication.xu.breadcrumbBrandUrl,breadcrumbFolderName:u.AFrameworkApplication.xu.breadcrumbFolderName,breadcrumbFolderUrl:u.AFrameworkApplication.xu.breadcrumbFolderUrl,hideDocumentTitleInput:u.AFrameworkApplication.Aa.hb.Hxj,isVersionHistoryEnabled:this.$dl(),documentExtension:ta.a.bT(u.AFrameworkApplication.fileName),isMoveEnabled:32===u.AFrameworkApplication.Ta.processAction(H.a.Tfb,1),onMove:Object(F.a)(this,
this.onMove,"onMove"),message:a,renameDisableReason:b,openBreadcrumbsInNewTab:u.AFrameworkApplication.fa.ka("OpenLinksInNewWindow")})}XZf(){if(!this.documentTitleAppProps){const a=u.AFrameworkApplication.xu.Uw;this.documentTitleAppProps=Object.assign(new YF,{documentTitle:u.AFrameworkApplication.YMc?a:ta.a.TG(a),onFirstRender:Object(F.a)(this,this.aok,"onDocumentTitleFirstRender"),getCalloutAppProps:Object(F.a)(this,this.h7i,"getDocumentFlyoutProperties"),isShared:!1})}return this.documentTitleAppProps}$dl(){return!!u.AFrameworkApplication.Aa&&
u.AFrameworkApplication.Aa.hb.$jg}ecl(){return!!u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.hb.JSj}Ldl(){const a=!qv.b()&&!u.AFrameworkApplication.hideHeader&&!u.AFrameworkApplication.I$f&&(u.AFrameworkApplication.fa.ka("SkypeWebControlIsEnabled")||u.AFrameworkApplication.fa.ka("TeamsChatIsEnabled"));ba.ULS.sendTraceTag(592315859,215,50,"ShowChat is {0}",a);return a}Uyi(a){appChrome.getHeaderApi().then(b=>{b.setNavBarData(a.result);return null});ba.ULS.sendTraceTag(50602782,215,50,"SetHeaderNavBarData has been dispatched.")}JOk(){appChrome.getHeaderApi().then(a=>
{const b=vb.a.instance.resolve("Common.App.Header.IReactSharedHeaderFocusManager");a.setHeaderCommandHandler("OnFirstRender",()=>{this.onFirstRender()});a.setHeaderCommandHandler("OnFullyLoaded",()=>{this.onFullyLoaded()});a.setHeaderCommandHandler("OnFlexPaneOpen",c=>{b.onFlexPaneOpen(c)});a.setHeaderCommandHandler("OnFlexPaneClose",c=>{b.onFlexPaneClose(c)});a.setHeaderCommandHandler("SetCookie",c=>oi.a.set(c.cookieName,c.value));a.setHeaderCommandHandler("GetCookie",c=>this.k5i(c));a.setHeaderCommandHandler("QueryWorkflowButtonSettings",
Object(F.a)(this,this.c$d,"getWorkflowButtonAppProps"));a.setHeaderCommandHandler("QueryDocumentTitleAppProps",Object(F.a)(this,this.XZf,"getDocumentTitleAppProps"));a.setHeaderCommandHandler("OnDocumentTitleReducerReady",()=>{this.bok();return null});Jy.a.SZc()&&a.setHeaderCommandHandler("QuerySearchInitializationSettings",Object(F.a)(this,this.S3f,"getSearchInitializationSettings"))})}bok(){vb.a.instance.Ja("Common.App.SaveStatus.ISaveStatusUIHandler").execute(a=>{a.Xoa(!1,u.AFrameworkApplication.Ta.mode)})}k5i(a){a=
oi.a.get(a);void 0!==a&&null!==a&&0<a.length&&(a=decodeURIComponent(a));return a}Sjj(){return Ik.AppChromeOverrideUtilities.isEnabled?Ik.AppChromeOverrideUtilities.getPath("suiteux-shell",!1):this.g0h+u.AFrameworkApplication.f1+"suiteux-shell"}onFirstRender(){vb.a.instance.Ja("Common.App.O365Shell.IO365ShellActor").execute(a=>{a.qbl.continueWith(Object(F.a)(this,this.Uyi,"continueShellServiceDataAsync"),3)});Ja.a.get_instance().PJ(15)}onFullyLoaded(){Ja.a.get_instance().PJ(16)}Oej(){a:{try{var a=
Fa.a.ue(u.AFrameworkApplication.lcid);if(a){var b=Object.assign(new bB,{cultureName:a.name,P$b:a.P$b});break a}}catch(c){ba.ULS.sendTraceTag(592318981,340,15,"Header language cannot be determined, LCID:"+u.AFrameworkApplication.lcid.toString())}b=Object.assign(new bB,{cultureName:"en-us",P$b:"en"})}a=vb.a.instance.resolve("Common.App.Header.IReactSharedHeaderFocusManager");b=Object.assign(new $F,{appName:CommonUIStrings.l_AppNameShort,culture:b.cultureName,language:b.P$b,isConsumer:!u.AFrameworkApplication.Ytd,
showAppLauncher:qv.f(),showMeControl:qv.e(),hideUserName:u.AFrameworkApplication.$ae,defaultDocumentTitleToLeft:u.AFrameworkApplication.vKf,assetsContainerOverride:this.Sjj(),controls:this.j5i(),documentTitleAppProps:this.XZf(),showDocumentTitleControl:!0,showWorkflowButton:!!this.c$d(),showChatControl:this.Ldl(),showGoPremiumControl:qv.g(),showDiscoverPremiumButton:qv.d(),enableSearchControl:Jy.a.hSj(),onFlexPaneOpen:Object(F.a)(a,a.onFlexPaneOpen,"onFlexPaneOpen"),onFlexPaneClose:Object(F.a)(a,
a.onFlexPaneClose,"onFlexPaneClose"),enableTheming:this.ecl(),testTraffic:u.AFrameworkApplication.fa.ka("SharedHeaderTestTrafficIsEnabled"),onFirstRender:Object(F.a)(this,this.onFirstRender,"onFirstRender"),onFullyLoaded:Object(F.a)(this,this.onFullyLoaded,"onFullyLoaded"),enableUpdatedRUMReporting:u.AFrameworkApplication.fcl()});!u.AFrameworkApplication.Alb||u.AFrameworkApplication.qXe?(b.userDisplayName=u.AFrameworkApplication.userName,b.emailAddress=u.AFrameworkApplication.fa.Ha("UserPrincipalName"),
b.userID=u.AFrameworkApplication.fa.Ha("Puid")||"",b.signOutLink=u.AFrameworkApplication.qXe):u.AFrameworkApplication.signInUrl&&(b.signInLink=u.AFrameworkApplication.signInUrl);Jy.a.SZc()&&(a=this.S3f(),b.loadTellMeResources=a.loadTellMeResources,b.getTokenRequestDictionary=a.getTokenRequestDictionary,b.enableVanillaSearchBox=u.AFrameworkApplication.fa.ka("VanillaSearchUxInHeaderIsEnabled"),b.userRing=a.userRing);aB.XJj()&&(a=new aB,b.shellAuthProviderConfigPromise=Object(F.a)(a,a.d1i,"getAccountSwitchingConfig"));
this.JOk();return b}S3f(){if(!this.aSe){const a=new Jy.a;let b=u.AFrameworkApplication.fa.Ha("Microsoft365Ring");b&&b.length||(b="generalAudience");this.aSe=Object.assign(new XF,{loadTellMeResources:a.PZj(),getTokenRequestDictionary:Object(F.a)(a,a.klj,"getTokenRequestDict"),userRing:b})}return this.aSe}}Object(n.a)(cG,"ReactSharedHeaderPropsHelper",null,[662]);var rg=d(342),pP=d(1212),qP=d(1060);d(917);var dG=d(664);const St=(a,b)=>{let c=0;for(;b()&&c<a.length;)a[c](),c++},eG=(a,b,c,h)=>{if(a&&
a.parentNode&&a.parentNode.parentNode){var m=(m=Oe.a.Qt(a))?La.a.oM(m.paddingLeft)+La.a.oM(m.paddingRight):0;var y=Oe.a.Qt(a.parentNode);y=y?La.a.oM(y.paddingLeft)+La.a.oM(y.paddingRight):0;let G=0,U=a;for(;U.nextSibling;)U=U.nextSibling,G+=U.offsetWidth;m=m+y+G;"auto"!==a.parentNode.style.width&&(a.style.width=a.parentNode.offsetWidth-m+"px");y=h?c:b;c=h?b:c;h=qd.a.ii(a.parentNode.parentNode);b=y?qd.a.ii(y):new Sys.UI.Bounds(h.x,0,0,0);c=c?qd.a.d9a(c):new Sys.UI.Point(h.x+h.width,0);"absolute"===
a.parentNode.style.position?b=c.x-(b.x+b.width)-m-1:(h=qd.a.ii(a.nextSibling?a.parentNode:a),h=h.x+h.width/2,b=2*Math.min(h-(b.x+b.width),c.x-h)-m-1);a.style.maxWidth=b+"px"}},Ly=a=>{a&&Vq(a)&&(a.style.display="",a._isHidden="0")},dl=a=>{a&&!Vq(a)&&(a.style.display="none",a._isHidden="1")},Vq=a=>{if(!a)return!0;a=a._isHidden;return!(void 0===a||null===a||"0"===a)},Fs=(a,b,c)=>{if(a&&!Vq(a)){var h=Oe.a.Qt(a);h=La.a.oM(h.paddingLeft)+La.a.oM(h.paddingRight);c=a.offsetWidth-c-h;let m=0;for(;b&&b!==a;)(h=
Oe.a.Qt(b))&&(m+=La.a.oM(h.paddingLeft)+La.a.oM(h.paddingRight)),b=b.parentNode;c=Math.max(c,75+m);a.style.width=c+"px"}},Nr=a=>{a&&(a.style.width="auto",a.style.maxWidth="none")},rP=(a,b,c)=>{if(a&&b){let h=0,m=0;({left:h,top:m}=qd.a.d_f(b,h,m));b=c?h-a.offsetWidth:h+b.offsetWidth;a&&(a.style.position="absolute",a.style.left=b+"px")}},pq=(a,b,c)=>!a||!b||Vq(a)||Vq(b)?!1:qd.a.Smg(qd.a.ii(a),qd.a.ii(b),c),Gs=(a,b,c)=>{let h=0;a&&b&&(h=qd.a.hme(qd.a.ii(a),qd.a.ii(b),c));return h};var Or=d(359);class My{constructor(a,
b,c){this.vub=this.v2b=this.uub=this.R7a=this.sNc=this.u2b=this.OG=this.t2b=this.qRa=this.jQ=this.tNc=this.pRa=this.Cca=this.pv=this.YK=this.WS=this.oRa=this.Q7a=this.P7a=this.aDa=null;this.bS=a;this.jRb=b;this.Vi=c}T0k(a){this.bS=a;this.jRb=null;this.q2d(this.bS);this.FEh();this.bnh()}m_a(){this.bS&&this.jRb&&this.jRb.clientHeight&&(this.q2d(this.bS),this.FEh(),this.bnh(),-1!==this.jRb.parentNode.parentNode.className.indexOf("cui-ribbon")&&(this.bUf(this.jRb),this.Rvl(),this.X0k()))}q2d(a){if(a)for(let c=
0;c<a.childNodes.length;c++){const h=a.childNodes[c],m=La.a.Ija(h),y=!!h.id;if(-1!==m.indexOf("cui-QATRowLeft"))this.aDa=h;else if(-1!==m.indexOf("OfficeOnlineBrandBreadcrumbSeparator"))this.P7a=h;else if(h.id===mm.CuiHelper.rRd)this.Q7a=h;else if(h.id===mm.CuiHelper.oVf)this.oRa=h;else if(h.id===mm.CuiHelper.sRd)this.WS=h;else if(-1!==m.indexOf("cui-QATRowCenter"))this.YK=h;else if(h.id===mm.CuiHelper.tRd)this.pv=h;else if(-1!==m.indexOf("cui-QATRowRight"))this.Cca=h;else{var b;if(b=y)b=h,b=!!b.id&&
(b.id.startsWith(mm.CuiHelper.iVe)||b.id.startsWith(mm.CuiHelper.Ekd));b?this.pRa=h:y&&h.id.startsWith(mm.CuiHelper.jil)?this.tNc=h:-1!==m.indexOf("UsernameNameContainer")?this.jQ=h:-1!==m.indexOf("UsernameNameItem")&&(this.qRa=h)}this.q2d(h)}}FEh(){var a=[this.YK,this.pv,this.jQ],b=[this.P7a,this.Q7a,this.oRa,this.WS,this.YK,this.pv,this.Cca,this.pRa,this.tNc,this.jQ];for(const c of b)Ly(c);for(const c of a)Nr(c);if(a=this.YK)a.style.position="static",a.style.left="auto"}bnh(){this.DVd()?this.V0k():
this.W0k();var a=this.oRa,b=this.WS;a&&b&&(a.style.marginTop=(b.offsetHeight-a.offsetHeight)/2+"px")}V0k(){let a;const b=this.I5d();a=[()=>{Fs(this.WS,this.WS,Gs(this.aDa,b,this.Vi))},()=>{dl(this.P7a);dl(this.Q7a);dl(this.oRa);dl(this.WS)}];St(a,()=>pq(this.WS,b,this.Vi));pq(this.OG,this.YK,this.Vi)&&rP(this.YK,this.OG,this.Vi);this.Fkh();a=[()=>{Fs(this.jQ,this.qRa,Gs(this.OG,this.Cca,this.Vi))},()=>{dl(this.pRa)}];this.Gkh();Vq(this.YK)||Vq(this.pv)||eG(this.pv,this.OG,this.Cca,this.Vi)}W0k(){const a=
!!this.WS,b=!!this.pv;let c=0;if((a||b)&&0<(c=Gs(this.aDa,this.YK,this.Vi))){let h=a;b&&(!a||this.pv.offsetWidth>this.WS.offsetWidth)&&(h=!1);Fs(h?this.WS:this.pv,h?this.WS:this.pv,h?c:2*c);a&&b&&0<(c=Gs(this.aDa,this.YK,this.Vi))&&(h=!h,Fs(h?this.WS:this.pv,h?this.WS:this.pv,h?c:2*c))}St([()=>{dl(this.P7a);dl(this.Q7a);dl(this.oRa);dl(this.WS);Nr(this.pv)},()=>{Fs(this.pv,this.pv,2*Gs(this.aDa,this.YK,this.Vi))},()=>{dl(this.pv)}],()=>pq(this.aDa,this.YK,this.Vi));this.Fkh();this.Gkh();Vq(this.YK)||
Vq(this.pv)||eG(this.pv,this.aDa,this.Cca,this.Vi)}Fkh(){const a=Vq(this.pv);St([()=>{this.FQe()},()=>{dl(this.pRa);Nr(this.pv);Nr(this.jQ);a||Ly(this.pv)},()=>{this.FQe()},()=>{dl(this.tNc);Nr(this.pv);Nr(this.jQ);a||Ly(this.pv)},()=>{this.FQe()}],()=>pq(this.YK,this.Cca,this.Vi))}FQe(){const a=!!this.pv,b=!!this.jQ;let c=0;if((a||b)&&0<(c=Gs(this.YK,this.Cca,this.Vi))){const h=!!this.YK&&"absolute"!==this.YK.style.position;let m=a;b&&(!a||this.jQ.offsetWidth>this.pv.offsetWidth)&&(m=!1);Fs(m?this.pv:
this.jQ,m?this.pv:this.qRa,m&&h?2*c:c);a&&b?(0<(c=Gs(this.YK,this.Cca,this.Vi))&&(m=!m,Fs(m?this.pv:this.jQ,m?this.pv:this.qRa,m&&h?2*c:c)),pq(this.YK,this.Cca,this.Vi)&&(dl(this.YK),Nr(this.jQ))):a&&pq(this.YK,this.Cca,this.Vi)&&dl(this.pv)}}Gkh(){const a=()=>{Fs(this.jQ,this.qRa,Gs(this.aDa,this.Cca,this.Vi))};St([a,()=>{dl(this.pRa);Nr(this.jQ)},a,()=>{dl(this.tNc);Nr(this.jQ)},a,()=>{dl(this.jQ)}],()=>pq(this.aDa,this.Cca,this.Vi))}DVd(){if(!this.OG)return!1;for(let a=0;a<this.OG.childNodes.length;a++)if(-1!==
La.a.Ija(this.OG.childNodes[a]).indexOf("cui-cg"))return!0;return!1}I5d(){if(!this.OG)return null;let a=null;for(let b=this.OG.childNodes.length-1;0<=b;b--){const c=this.OG.childNodes[b];if(-1===La.a.Ija(c).indexOf("cui-cg"))break;a=c}return a}bUf(a){if(a)for(let b=0;b<a.childNodes.length;b++){const c=a.childNodes[b],h=La.a.Ija(c),m=!!c.id;-1!==h.indexOf("cui-jewel-container")?this.t2b=c:-1!==h.indexOf("cui-tts")?this.OG=c:-1!==h.indexOf("cui-TabRowInline")?this.u2b=c:-1!==h.indexOf("cui-separator")?
this.sNc=c:m&&c.id.startsWith(mm.CuiHelper.i7g)?this.R7a=c:m&&c.id.startsWith(mm.CuiHelper.XSf)?this.uub=c:-1!==h.indexOf("cui-TabRowRight")?this.v2b=c:m&&c.id.startsWith(mm.CuiHelper.zIe)&&(this.vub=c);this.bUf(c)}}Rvl(){var a=[this.OG,this.u2b,this.sNc,this.R7a,this.uub,this.v2b,this.vub];for(const b of a)Ly(b);this.xLb(0)}X0k(){let a;a=[()=>{dl(this.sNc);dl(this.R7a)},()=>{this.xLb(1)},()=>{this.xLb(2)},()=>{dl(this.u2b);this.xLb(0)}];St(a,()=>pq(this.OG,this.u2b,this.Vi));a=[()=>{dl(this.sNc);
dl(this.R7a)},()=>{dl(this.uub)},()=>{dl(this.vub)},()=>{dl(this.v2b)}];St(a,()=>pq(this.u2b,this.v2b,this.Vi)||pq(this.OG,this.v2b,this.Vi));a=[()=>{this.xLb(1)},()=>{this.xLb(2)},()=>{dl(this.OG)}];St(a,()=>pq(this.t2b,this.OG,this.Vi))}xLb(a){this.OG&&(this.OG.className=My.lnl[a],this.OG._scaleStep=a)}}My.lnl=["cui-tts","cui-tts-scale-1","cui-tts-scale-2"];Object(n.a)(My,"TopBarScalingManager",null,[]);class fG{constructor(a,b){this.bS=this.gAa=null;this._clientId=a;this.ykf=b}DRi(){if(!cl.b(this.bS))return this.bS;
this.HQi();this.bS.style.display="block";this.ykf&&this.ykf.nia(Object(F.a)(this,this.onResize,"onResize"));return this.bS}onResize(){this.m_a()}m_a(){this.cQi()?(document.getElementById("application").style.minWidth="0px",(new My(this.bS,null,u.AFrameworkApplication.isRtl)).T0k(this.bS)):u.AFrameworkApplication.Aa.hb.WN||dG.a.U0k(this.bS,u.AFrameworkApplication.isRtl)}cQi(){return u.AFrameworkApplication.fa?u.AFrameworkApplication.fa.ka("EnhancedMobileViewIsEnabled"):!1}HQi(){if(cl.b(this.gAa)){var a;
({g7b:a}=Or.a.ZNb(!u.AFrameworkApplication.zQ)).returnValue&&(this.gAa=qA("div"),this.gAa.className=Or.a.iTi,this.gAa.id=mm.CuiHelper.Z0d,a.appendChild(this.gAa),this.yQi(),u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.hb.DUa&&!u.AFrameworkApplication.zQ&&this.BQi(),this.CRi())}}CRi(){cl.b(this.bS)&&(this.bS=qA("div"),this.bS.className=Or.a.krl,this.bS.style.display="none",this.gAa.appendChild(this.bS))}yQi(){Sys.UI.DomElement.addCssClass(this.gAa,Or.a.jTi);if(u.AFrameworkApplication.isRtl){var a=
this.gAa;if(!cl.b(a)){var b=a.className;if(cl.b(b)||-1===b.indexOf("cui-rtl"))b=b.trim()+" cui-rtl",b=b.trim(),a.className=b}}}BQi(){Sys.UI.DomElement.addCssClass(this.gAa,"FlexBoxLayout")}}Object(n.a)(fG,"HeaderSkeleton",null,[]);var sP=d(1238),cB=d(1188);class dB{constructor(){this.commandId=0;this.externalUxCommand=null}}Object(n.a)(dB,"CommandDefinition",null,[]);class gG{constructor(){this.addTabToMap=this.addIconToMap=this.addCommandToMaps=this.getDoNothingCommand=this.getCommandByExternalUxId=
null}}Object(n.a)(gG,"CommandDefinitionMapping",null,[]);const tP=a=>Object.assign(new gG,{getCommandByExternalUxId:b=>{const c=a.getCommandByExternalUxId(b);return c?Object.assign(new dB,{commandId:parseInt(c.commandId),externalUxCommand:c.externalUxCommand}):Object.assign(new dB,{externalUxCommand:b})},getDoNothingCommand:()=>parseInt(H.a.qe),addCommandToMaps:Object(F.a)(a,a.addCommandToMaps,"addCommandToMaps"),addIconToMap:Object(F.a)(a,a.addIconToMap,"addIconToMap"),addTabToMap:Object(F.a)(a,
a.addTabToMap,"addTabToMap")});var hG=d(928);class iG{}Object(n.a)(iG,"RibbonInitState",null,[]);var uP=d(394),jG=d(508);let Hs;class hp{static ctl(a){u.AFrameworkApplication.Aa.hb.Veg||(a.ShowCommentsTopBar=!0);u.AFrameworkApplication.Aa.hb.Jeg||(a.CatchUpWithChanges=!0)}static BCh(a){for(let b of hp.ORh)a[b]=!0}static eBl(a,b){var c=u.AFrameworkApplication.u7b;if(u.AFrameworkApplication.fa.aw(c)&&u.AFrameworkApplication.fa.Ha(c)){hp.BCh(b);c=u.AFrameworkApplication.fa.RA("HostDefinedUIControls");
for(let h=0;h<c.length;h++)hp.fBl(a,b,c[h]);hp.Ysl(b);hp.Xsl(b)}}static fBl(a,b,c){if(c.id in a){a=a[c.id];for(let h of a)1===c.visibility?b[h]=!1:c.visibility||(b[h]=!0)}}static Ysl(a){a.HostMoreOptions=a.HostOpenInBrowser&&a.HostOpenInClient&&a.HostDownload?!0:!1}static wua(){const a=u.AFrameworkApplication.fa.Ha(u.AFrameworkApplication.YJ);return!!a&&"teams"===a.toLowerCase()}static Qdl(){return u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeamsCollabDeclutterIsEnabled",
!1)}static vel(){return u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeamsCollabDeclutterIsEnabled",!1)||u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IsPeripheralOverflowScalingEnabled",!1)}static Xsl(a){hp.wua()&&(hp.Qdl()&&(a.HostOpenInClient=!1),hp.vel()&&(a.HostMoreOptions=!0))}}hp.ORh=(Hs=new Qa.a,Hs.add("HostOpenInClient"),Hs.add("HostConversation"),Hs.add("HostClose"),Hs.add("HostDownload"),Hs.add("HostOpenInBrowser"),Hs.add("HostMoreOptions"),
Hs);Object(n.a)(hp,"CommandTrimmer",null,[]);class kG{constructor(){}flatten(a){const b=[];for(const c of a)b.push.apply(b,c);return b}}Object(n.a)(kG,"ReactAsyncDispatcher",null,[]);class eB{}eB.mkc="PageId";Object(n.a)(eB,"FileMenuSQMProperties",null,[]);class lG{constructor(a,b){this.vq=null;this.bCc=!1;this.VNa=0;this.Ief="";this.bxd={};this.XEd=a;this.Od=b;this.Yhf=Object(F.a)(this,this.qGe,"onModalMouseWheel");this.Rdf=!!u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.hb.a9;this.k2=!!u.AFrameworkApplication.Aa&&
u.AFrameworkApplication.Aa.hb.rFa}tGb(){0<this.VNa?this.VNa++:(this.VNa++,u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DelayMenuFocusActionsUntilNextFrame",!1)?window.requestAnimationFrame(()=>{window.setTimeout(Object(F.a)(this,this.ych,"pushTransientFocusScope"),0)}):this.ych(),this.showModal())}ych(){this.Od&&this.Od.tY(A.AFrame.VO,!0)}f3i(){const a=Dg.f(),b=appChrome.selectors.getShyState();return String.format("{0}{1}",a,this.Rdf&&b.isActive&&1===b.state?"_ShyRibbon":
"")}qlj(a){var b=0;if(this.k2){if(this.bxd[a])return this.bxd[a];(b=document.getElementById("BusinessBar"))||ba.ULS.sendTraceTag(524142489,340,10,"Failed to propertly get region composer Business Bar Region for setting up Modal Div");b=b?b.offsetTop:0;this.bxd[a]=b}return b}showModal(){if(!this.vq)if(this.vq=this.createElement("div"),this.vq.setAttribute("id","ReactModalDiv"),this.vq.style.position="absolute",this.vq.style.bottom="0px",this.vq.style.left="0px",this.vq.style.right="0px",this.vq.style.backgroundColor=
"white",this.vq.style.opacity="0.0",this.k2){var a=document.getElementById("regionComposerRoot");a&&a.appendChild(this.vq)}else this.XEd.appendChild(this.vq);a=this.f3i();if(a!==this.Ief){const b=this.qlj(a),c=appChrome.selectors.getShyState();this.Rdf&&c.isActive&&1===c.state&&Dg.a("getRibbonHeight")?this.vq.style.top=String.format("{0}px",b+appChrome.api.getRibbonHeight(Dg.f())):this.vq.style.top=String.format("{0}px",b);this.Ief=a}this.vq.style.display="block";this.vq.style.visibility="visible";
this.vq.style.zIndex="1000";this.bCc||(window.addEventListener("wheel",this.Yhf,!0),this.ZYc()?fe.a.instance.pb(ra.a.xR,this.vq,Object(F.a)(this,this.sed,"onModalPointerUp")):fe.a.instance.pb(ra.a.pointerDown,this.vq,Object(F.a)(this,this.qed,"onModalPointerDown")),this.bCc=!0)}kqk(){this.VNa--;0<this.VNa||(0>this.VNa?this.VNa=0:this.S$f())}mFe(){this.VNa=0;this.rZd();this.S$f()}createElement(a){a=document.createElement(a);a.setAttribute("unselectable","on");return a}R$f(){this.Od&&this.Od.Be&&this.Od.Be.name===
A.AFrame.VO&&!u.AFrameworkApplication.we.mw&&this.Od.x5(A.AFrame.VO,!1);this.vq&&(this.vq.style.zIndex="-1",this.vq.style.visibility="hidden",this.vq.style.display="none");this.bCc&&(window.removeEventListener("wheel",this.Yhf,!0),this.ZYc()?fe.a.instance.yb(ra.a.xR,this.vq,Object(F.a)(this,this.sed,"onModalPointerUp")):fe.a.instance.yb(ra.a.pointerDown,this.vq,Object(F.a)(this,this.qed,"onModalPointerDown")),this.bCc=!1)}S$f(){this.ZYc()?window.requestAnimationFrame(()=>{window.setTimeout(()=>{this.R$f()},
0)}):this.R$f()}qed(){this.H1b();this.VMf();this.mFe();this.zKa();return!0}sed(){this.H1b();this.VMf();this.mFe();window.requestAnimationFrame(()=>{window.setTimeout(()=>{this.zKa()},0)});return!0}zKa(){4===u.AFrameworkApplication.Aa.hb.Vk&&u.AFrameworkApplication.fa.ka("OneNoteAutoSwitchToTypeWhileInkingIsEnabled")?u.AFrameworkApplication.Aa.zKa():this.Od.xf(A.AFrame.wW)}qGe(a){a.stopPropagation()}H1b(){const a=vb.a.instance.rb("Common.IReactContextualUILauncher");a&&a.H1b()}rZd(){const a=vb.a.instance.rb("Common.IReactContextualUILauncher");
a&&a.rZd()}VMf(){u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.hb.qFa&&(this.ZYc()?appChrome.selectors.getFileMenuExpanded():1)&&appChrome.api.dispatch(appChrome.actions.updateFileMenuExpandedValue(!1))}ZYc(){return u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ReactModalDivPerfImprovements",!1)}}Object(n.a)(lG,"ReactModalDiv",null,[]);var en=d(528);class mG{constructor(a,b){this.M_h=a;this.cOh=b}}Object(n.a)(mG,"ReactExecuteCommandContext",null,[]);class rv{}
rv.Color="Color";rv.IndexColorSelected="ColorSelected";Object(n.a)(rv,"ColorPickerCommandProperties",null,[]);var Wn=d(923);class Xn{}Xn.SelectedFont="SelectedFont";Xn.Formatting="Format";Xn.RequestUpdateMru="RequestUpdateMru";Xn.FontPickerId="fontPickerId";Xn.IsPinned="IsPinned";Xn.Trigger="Trigger";Object(n.a)(Xn,"FontPickerCommandProperties",null,[]);class Po{}Po.Trigger="FontTrigger";Po.Name="FontName";Po.Action="FontAction";Po.Level="FontLevel";Po.IsPinned="FontIsPinned";Object(n.a)(Po,"FontPickerLogProperties",
null,[]);class Yw{}Yw.Rows="Rows";Yw.Columns="Columns";Object(n.a)(Yw,"InsertTableCommandProperties",null,[]);class Pm{}Pm.Alt="Alt";Pm.Number="Number";Pm.UnitType="UnitType";Pm.Text="Text";Pm.MaxValue="MaxValue";Object(n.a)(Pm,"SpinnerCommandProperties",null,[]);class nG{constructor(a,b,c,h,m,y,G,U,ja,va=null,Ta=null){this.G3a=null;this.lmf=!1;this.szd=[];this.uwc=-1;this.JDc=!1;this.v0h=0;this.nQb=null;this.vjf=!1;this.GP=a;this.xOa=b;this.Ykf=Object(ua.a)(1526,a);this.xn=c;this.Od=h;m&&(this.G3a=
new lG(m,h));this.gZh=y;this.zQh=G;this.rS=va;this.Ca=U;this.s3a={};this.$a=ja;this.g5e=Ta;ja&&(ja.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnqueueTasksWhenTaskMgrIsYielding",!1)||ja.ka("EnqueueTasksWhenTaskMgrIsYielding"))&&Jj.a.instance.juf.CWR(()=>this.lmf=!0);ja&&(a=this.$a.Ha("CommandControlIdPairsForLoggingOverride")||"")&&0<=a.trim().length&&({kv:this.nQb}=dd.d(a));this.nQb||(this.nQb={})}get Fmd(){return!!window.appChrome&&!!appChrome.selectors}inh(){-1!==this.uwc&&window.clearTimeout(this.uwc);
this.uwc=window.setTimeout(()=>{for(this.uwc=-1;0<this.szd.length;){if(mh.a.instance.mw){this.inh();break}const a=this.szd.shift();a&&this.executeCommand(a.M_h,a.cOh)}},0)}executeCommand(a,b){if(mh.a.instance.mw){if(this.lmf){this.szd.push(new mG(a,b));this.inh();return}ba.ULS.sendTraceTag(561394496,207,15,"React.ExecuteCommandHandler.ExecuteCommand: TaskManager.Instance.IsYielding, simplifiedUxCommand: {0}, commandHandlerData.ModelType: {1}, commandHandlerData.ModelType.Payload: {2}",a,b.modelType,
Da.a.toJSON(b.payload));if(this.$a.ka("WordEditorReactExecuteYieldReturnIsEnabled"))return}if(b){const c=this.xn.getCommandByExternalUxId(a),h=b.modelType;this.g5e&&this.g5e.V_j(a,b);c?this.pSi(a,c,h,b):this.qSi(a,h,b);this.dqi(b);this.Xek(a,b)}}qSi(a,b,c){switch(b){case "GalleryModel":case "PreviewGalleryModel":this.kRf(c,a)}}Azl(a,b,c,h,m){if(c.payload)switch(c.payload.type){case "CoauthorMenuPayload":a.MenuItemId=c.payload.coauthorId;break;case "ButtonPayload":a.MenuItemId=b.menuItemId;a.CommandValueId=
c.payload.commandValueId;this.M6a();break;case "ButtonPreviewPayload":a.MenuItemId=b.menuItemId;a.CommandValueId=c.payload.commandValueId;m=b.commandPreviewId;break;case "ButtonRevertPreviewPayload":a.MenuItemId=b.menuItemId;a.CommandValueId=c.payload.commandValueId;m=b.commandRevertId;break;default:a.MenuItemId=b.menuItemId}else a.MenuItemId=b.menuItemId;a.SourceControlId=h;return m}Bzl(a,b,c){if(b.payload)switch(b.payload.type){case "MenuOpenPayload":a=this.xn.getCommandByExternalUxId("TellMeLogMenuOpen").commandId;
break;case "MenuClosePayload":a=this.xn.getCommandByExternalUxId("TellMeLogMenuClose").commandId;break;case "TellMeMenuItemExecuted":c.CommandId=b.payload.executedControl;c.ControlId=b.payload.executedControl;c.ParentControlId=b.payload.parentControl;c.CloseAllMenus=!0;this.M6a();break;case "TellMeSearchResultChangePayload":c.Value=b.payload.searchText;break;case "SmartLookupPayload":c.CommandValueId=b.payload.selectionContextJson}return a}pSi(a,b,c,h){var m=this.KAk(h,c),y=b.commandId;const G={},
U={};switch(c){case "SplitButtonModel":if(this.C6b(h.payload,Object(F.a)(this,this.CAl,"updateSplitButtonMenuState"),m))return;G.MenuItemId=b.menuItemId;this.BUe(h,G);break;case "StatefulSplitButtonModel":if(this.C6b(h.payload,Object(F.a)(this,this.GAl,"updateStatefulSplitButtonMenuState"),m))return;c=h.payload.statefulData;m=h.payload.statefulMode;"color"===m?G.Color=c:"icon"===m&&(c=this.xn.getCommandByExternalUxId(c))&&(G.MenuItemId=c.menuItemId);break;case "FileMenu":G.MenuItemId=b.menuItemId;
G.SourceControlId=a;h.payload&&"FileMenuPageSwitchPayload"===h.payload.type&&this.Pqj(y,h.payload,a);break;case "TellMe":y=this.Bzl(y,h,G);G.SourceControlId=a;G.Location=h.payload.location;break;case "ButtonModel":h.payload&&"TabSwitchPayload"===h.payload.type?this.evj(G,h):y=this.Azl(G,b,h,a,y);break;case "CompoundButtonModel":G.MenuItemId=b.menuItemId;G.CommandValueId=h.payload.commandValueId;G.SourceControlId=a;this.BUe(h,G);this.M6a();break;case "ToggleButtonModel":case "InkButtonModel":G.MenuItemId=
b.menuItemId;G.SourceControlId=a;this.BUe(h,G);this.M6a();break;case "FontPickerModel":switch(h.payload.type){case "MenuOpenPayload":return;case "MenuClosePayload":y=this.xn.getCommandByExternalUxId("FontPickerMenuClose").commandId;G[Xn.FontPickerId]=h.payload.launcherId;break;case "FontPickerFontSelectedPayload":c=h.payload.font;m=null;"string"===typeof c?(m=ka.FontUtils.$F(c),G.CommandValueId=m,m=ka.FontUtils.ZKc(m)):(c.data?(G.CommandValueId=c.data.fontToApply,G.MenuItemId=c.data.themeIndex,G[Xn.Formatting]=
c.data):G.CommandValueId=c.name,m=c);G.SourceControlId=a;G[Xn.RequestUpdateMru]=m;U[Po.Name]=h.payload.nameToLog?h.payload.nameToLog:"string"===typeof c?ka.FontUtils.NXc(c)?"*"+c:ka.FontUtils.Whe(c)?"[EF]":"[MF]":"";U[Po.IsPinned]=h.payload.isPinned;U[Po.Level]=h.payload.level;this.Tme();break;case "FontPickerFontInfoRequestedPayload":G.CommandValueId=h.payload.font.name;G[Xn.Trigger]=h.payload.trigger;U[Po.Trigger]=h.payload.trigger;U[Po.Name]=h.payload.nameToLog;this.Tme();break;case "FontPickerFontPinningPayload":c=
h.payload.isPinned;G.CommandValueId=h.payload.fontKey;G[Xn.IsPinned]=c;U[Po.Name]=h.payload.nameToLog;U[Po.Action]=c?"pin":"unpin";U[Po.Level]=h.payload.level;this.Tme();break;default:return}break;case "ComboBoxModel":var ja=h.payload.type;switch(ja){case "MenuOpenPayload":case "MenuPopulatePayload":this.VLb(h.payload.launcherId,m)&&(y={},y[h.payload.launcherId]=c,this.xOa.Xkc(y,Dg.g(h.payload)),this.s3a[a]=new Date);return;case "MenuClosePayload":return;case "ComboBoxPayload":case "ComboBoxPreviewPayload":c=
h.payload.newValue;if(!c)return;c.value?(G[Wn.a.Value]=c.value,G[Wn.a.IsFreeForm]=!0):(G[Wn.a.Value]=c.text,G.MenuItemId=c.key,G.CommandValueId=c.commandValueId);"ComboBoxPreviewPayload"===ja&&(y=b.commandPreviewId);break;case "ComboBoxRevertPreviewPayload":y=b.commandRevertId;break;default:return}break;case "FlyoutAnchorModel":switch(h.payload.type){case "ZeroTermContextMenuClosePayload":c=Da.a.fL(h.payload);for(ja of c)G[ja]=h.payload[ja];break;default:this.C6b(h.payload,Object(F.a)(this,this.tyl,
"updateFlyoutAnchorMenuState"),m),G.launcherId=h.payload.launcherId}break;case "InkFlyoutAnchorModel":this.C6b(h.payload,Object(F.a)(this,this.Nyl,"updateInkFlyoutAnchorMenuState"),m);G.launcherId=h.payload.launcherId;break;case "ColorPickerModel":switch(h.payload.type){case "ColorPickerPayload":G[rv.Color]=h.payload.selectedColorId;break;case "ColorPickerPreviewPayload":y=b.commandPreviewId;G[rv.Color]=h.payload.selectedColorId;break;case "ColorPickerRevertPreviewPayload":y=b.commandRevertId;break;
default:return}break;case "SpinButtonModel":G[Pm.Number]=h.payload.value;G[Pm.UnitType]=te.a.f0b(h.payload.unitType.toLowerCase());G[Pm.Text]=h.payload.reservedValue;break;case "SliderModel":G[Oo.Value]=h.payload.value;break;case "InsertTableModel":G[Yw.Rows]=h.payload.rows;G[Yw.Columns]=h.payload.columns;break;case "CheckboxModel":G[Zh.a.On]=h.payload.checked;G.MenuItemId=b.menuItemId;break;case "PreviewGalleryModel":if(this.C6b(h.payload,Object(F.a)(this,this.Lzl,"updatePreviewGalleryMenuState"),
m)){G.launcherId=h.payload.launcherId;break}this.kRf(h,a);return;case "DocumentTitleModel":switch(h.payload.type){case "DocumentTitleRenamePayload":G.getNewDocumentTitle=h.payload.getNewDocumentTitle;break;case "MenuOpenPayload":y={};y[h.payload.launcherId]=c;this.xOa.Xkc(y,Dg.g(h.payload));this.s3a[a]=new Date;return;case "MenuClosePayload":return;default:return}break;case "MRUCompoundButtonModel":G.MenuItemId=h.payload.url;this.B0j(h.payload.pageId);break;case "NewBlankDocumentModel":case "CustomTemplateModel":G.MenuItemId=
h.payload.assetId;G.SourceControlId=a;u.AFrameworkApplication.fa.ka("BackstagePremiumTemplateExperienceEnabled")&&(G.IsPremium=h.payload.isPremium||!1);this.C0j(h.payload.pageId);break;case "CoauthorGallery":G.RenderTime=h.triggerTime;break;case "PeopleWell":G.RenderTime=h.triggerTime;break;case "SyncStatus":G.SourceControlId=a;break;case "InputBoxModel":G.Text=h.payload.newValue;break;case "PersonaButtonModel":G.CommandValueId=h.payload.commandValueId;this.Osj(h.payload);break;default:return}y&&
!this.isShadowMenuOpen(h.payload)&&(G.CommandValueId||(G.CommandValueId=G.MenuItemId),b.legacyControlId&&(G.LegacyId=b.legacyControlId),G.SourceControlId||(G.SqmControlId=a),this.$a&&this.$a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",!1)&&G.launcherId&&(b=this.xn.getCommandByExternalUxId(G.launcherId))&&(G.launcherCommandId=parseInt(b.commandId)),h.payload&&!cl.b(h.payload.PRIReadinessCheck)&&(G.PRIReadinessCheck=h.payload.PRIReadinessCheck,this.vjf=!0),h.payload&&
!cl.b(h.payload.shouldTakeFocus)&&(G[en.a.Rfa]=h.payload.shouldTakeFocus),b=this.Lqf(h,G),cl.b(h.triggerTime)||(U.TriggerTime=h.triggerTime),h.payload&&!cl.b(h.payload.userActionKey)&&(U.userActionKey=h.payload.userActionKey),this.eph(U,h,a,y),this.Ykf.executeCommand(y,G,this.getSelectedTabId(),b,!0,()=>{this.gZg(G,a)},U,Dg.g(h.payload)))}eph(a,b,c,h){this.$a&&this.$a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableControlIdLoggingInUserActions",!1)&&c&&h&&(c=b.payload&&!cl.b(b.payload.launcherId)?
b.payload.launcherId:c,a.ControlId=this.Dmh(this.Fcj(c,h),h,!1));this.$a&&this.$a.ka("TerminalParentControlIdLoggingInUserActionsIsEnabled")&&b.payload&&"terminalParentControlId"in b.payload&&(a.TerminalParentControlId=this.Dmh(b.payload.terminalParentControlId,h,!0))}Dmh(a,b,c){if(RegExp("^[a-zA-Z0-9_]*$").test(a))return a;ba.ULS.sendTraceTag(510247689,207,15,c?"CommandId: "+b+" has a parentControlId that is non-alphanumeric and may need to be changed":"CommandId: "+b+" has a controlId that is non-alphanumeric and may need to be changed");
return"MalformedId"}Fcj(a,b){b=parseInt(b);b=ed.ActionManager.xUd(b)||ed.ActionManager.v5a(b)||"";return!cl.b(b)&&b in this.nQb?this.nQb[b]:100<a.length?"":a}Tme(){this.rS&&this.rS.execute(a=>{a.Kme("ModernFontPickerExperience")})}Lqf(a,b){let c=2;a.payload&&"inputMethod"in a.payload&&a.payload.inputMethod&&(c=a.payload.inputMethod,b[en.a.vv]=c);return c}gZg(a,b){const c=Object(ua.a)(A.AFrame,u.AFrameworkApplication.Aa);if(this.Od&&this.wth(a)){if(!this.Od.Be&&c){let h="null";if(a){const m=a.Value;
delete a.Value;h=Da.a.toJSON(a);cl.b(m)||(a.Value=m)}ba.ULS.sendTraceTag(561394506,207,50,"Excel React unexpectly calling the callback with, simplifiedUxCommand: {0}, commandHandlerData.ModelType.Payload: {1}, focus scope name: {2}",b,h,c.kKa)}this.Od.PYi()}(this.Od&&this.Od.Be&&this.Od.Be.name!==A.AFrame.VO&&c&&this.Od.Be.name!==c.kKa||this.wth(a))&&this.cui(a)}wth(a){return!!a&&!cl.b(a[en.a.Rfa])&&a[en.a.Rfa]}cui(a){en.a.vv in a&&1===a[en.a.vv]&&Ww.ShyRibbon.cQa(1,0)}evj(a,b){Dg.a("isSharedUxGateEnabled")&&
appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.CloseMenuOnUnmount")&&this.M6a();this.GP.Wkc();if(this.gZh&&this.Ca){const c={};c[Iy.mzh]=b.payload.tabId;this.Ca.La(H.a.Gkd,2,c,this.HTc(b));cl.b(b.payload.inputMethod)||(this.Ca.processAction(H.a.Gjh,2),this.JDc||this.xhl(b.payload.tabId))}b=b.payload.tabId;a.NewContextId=b;a.NewContextCommand=this.xn.m9d(b);ba.ULS.sendTraceTag(561394507,340,50,"HandleTabSwitch tabId: "+b);if(this.rS&&b){const c=b+"TabSwitchActivity";this.rS.execute(h=>
{h.Kme(c)})}}C6b(a,b,c){const h=a.type;return"MenuClosePayload"===h?!0:"MenuOpenPayload"===h?(b(a,c),!0):!1}Osj(a){a=a.type;"MenuOpenPayload"===a?u.AFrameworkApplication.Oyh=!0:"MenuClosePayload"===a&&(u.AFrameworkApplication.Oyh=!1)}KAk(a,b){if(!a.payload||!a.payload.launcherId||"MenuOpenPayload"!==a.payload.type&&"MenuPopulatePayload"!==a.payload.type)return!1;const c=a.payload.launcherId,h=this.xn.getCommandByExternalUxId(c);return h&&h.populationProps?((a=this.xOa.iJe(h,b,a.payload))&&c in this.s3a&&
delete this.s3a[c],a):!1}tyl(a,b){const c=a.launcherId;this.VLb(c,b)&&(b=appChrome.selectors.getFlyoutAnchorMenuItems(c),this.wOb(b,c,Dg.g(a)))}Nyl(a,b){const c=a.launcherId;this.VLb(c,b)&&(b=Dg.j("getInkFlyoutAnchorMenuItems")?appChrome.selectors.getInkFlyoutAnchorMenuItems(c):appChrome.selectors.getFlyoutAnchorMenuItems(c),this.wOb(b,c,Dg.g(a)))}Lzl(a,b){const c=a.launcherId;this.VLb(c,b)&&(b=appChrome.selectors.getPreviewGalleryMenuItems(c),this.wOb(b,c,Dg.g(a)))}CAl(a,b){const c=a.launcherId;
this.VLb(c,b)&&(b=appChrome.selectors.getSplitButtonMenuItems(c),this.wOb(b,c,Dg.g(a)))}GAl(a,b){const c=a.launcherId;this.VLb(c,b)&&(b=appChrome.selectors.getStatefulSplitButtonMenuItems(c),this.wOb(b,c,Dg.g(a)))}getSelectedTabId(){return this.Fmd?appChrome.selectors.getSelectedTabId():null}wOb(a,b,c){this.xOa.Xkc(a,c);this.s3a[b]=new Date}VLb(a,b){let c=!0;a in this.s3a&&(c=this.s3a[a].getTime()<this.GP.s0c.getTime());return c&&!b&&this.Fmd}kRf(a,b){const c={};var h=a.payload.selectedGalleryId;
const m=this.xn.getCommandByExternalUxId(h);if(m){c.SourceControlId=h;c.MenuItemId=m.menuItemId;c.SqmControlId=b;m.legacyControlId&&(c.LegacyId=m.legacyControlId);a.payload&&!cl.b(a.payload.shouldTakeFocus)&&(c[en.a.Rfa]=a.payload.shouldTakeFocus);this.Edj(a.payload,c);(h=this.HTc(a))||(h={});this.eph(h,a,b,m.commandId);const y=this.Lqf(a,c);this.Ykf.executeCommand(m.commandId,c,this.getSelectedTabId(),y,!0,()=>{this.gZg(c,b)},h,Dg.g(a.payload))}}Edj(a,b){"CharacterGalleryPayload"===a.type&&(b.MenuItemId=
a.character)}BUe(a,b){a.payload&&"toggled"in a.payload&&(b[Zh.a.On]=a.payload.toggled)}Xek(a,b){"MenuOpen"===a?!this.G3a||"isShadowRendering"in b.payload&&b.payload.isShadowRendering||this.G3a.tGb():"MenuClose"===a&&this.G3a&&this.G3a.kqk()}M6a(){this.G3a&&this.G3a.mFe()}HTc(a){let b=null;cl.b(a.triggerTime)||(b={},b.TriggerTime=a.triggerTime);return b}Pqj(a,b,c){if(this.zQh&&this.Ca){const h={};h[eB.mkc]=c;this.Ca.La(H.a.IWk,2,h)}this.wOb(b.pageControlIdMap,a,Dg.g(b))}C0j(a){if(this.Ca)switch(a){case "FileHomePage":this.Ca.processAction(H.a.XWk,
2);break;case "FileNewPage":this.Ca.processAction(H.a.YWk,2)}}B0j(a){if(this.Ca)switch(a){case "FileHomePage":this.Ca.processAction(H.a.QWk,2);break;case "FileOpenPage":this.Ca.processAction(H.a.RWk,2)}}isShadowMenuOpen(a){return!!a&&"MenuOpenPayload"===a.type&&a.isShadowRendering}xhl(a){if(u.AFrameworkApplication.fa.ka("TellMeHelpCoachMarkActivityEnabled")&&"Help"===a)this.rS.execute(b=>{b.logActivity("TellMeHelpCoachMarkActivity",null)}),this.JDc=!0;else{if(u.AFrameworkApplication.fa.ka("TellMe3TabSwitchCoachMarkActivityEnabled")&&
(this.rS.execute(b=>{b.logActivity("TellMe3TabSwitchCoachMarkActivity",null)}),3===++this.v0h)){this.JDc=!0;return}u.AFrameworkApplication.fa.ka("TellMe1TabSwitchCoachMarkActivityEnabled")&&32===this.Ca.processAction(H.a.Zjb,2)&&(this.JDc=!0)}}dqi(a){a&&a.payload&&a.payload.PRIReadinessCheck&&!this.vjf&&appChrome.PRIToastManager.dismissToast()}}Object(n.a)(nG,"ReactExecuteCommandHandler",null,[]);class oG{constructor(){this.fileMenu=null}get r3e(){return 0}m_a(){}osa(){return!1}E1(){return!1}get Pnh(){return null}N5(){}Bhe(){return!1}MPa(){}wRa(){}refresh(){}get controls(){return null}JJc(){}Wkc(){}get jaa(){return null}set jaa(a){}get inKeytipMode(){return!1}enterKeytipMode(){}exitKeytipMode(){}}
Object(n.a)(oG,"ReactRibbonExternal",null,[556,1510,1511]);var vP=d(269);class pG{constructor(a,b,c,h){this.Od=a;this.Ca=b;this.Vof=c;this.lpb=h}initialize(){this.Ca.ya(H.a.qoc,he.a.frame,Object(F.a)(this,this.glh,"ribbonMoveForwardAction"));this.Ca.ya(H.a.poc,he.a.frame,Object(F.a)(this,this.flh,"ribbonMoveBackwardAction"));this.Ca.ya(H.a.mld,he.a.frame,Object(F.a)(this,this.elh,"ribbonEscAction"));var a=Or.a.Kce(this.lpb,null,this.Vof,!1);a.zL=!0;this.bJb(a,H.a.qoc,H.a.poc);a.bindAction(w.KeyInputManager.Na(z.a.J1,
0),H.a.mld);a=this.Od.Gc(A.AFrame.VO);a.zL=!0;this.bJb(a,H.a.rsa,H.a.rsa);ha.a.instance.pb(ra.a.mouseDown,this.Vof,Object(F.a)(this,this.gsk,"onRibbonMouseDown"));a=vP.a.instance;Dg.a("enterKeytipMode")&&a.hLb(this.lpb,()=>{appChrome.api.enterKeytipMode(!1)});Dg.a("exitKeytipMode")&&a.qpc(this.lpb,()=>{appChrome.api.exitKeytipMode();Ww.ShyRibbon.cQa(1,0)});u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.hb.a9&&(a=Object(ua.a)(C.FocusManager,this.Od))&&a.p9h(Object(F.a)(this,this.Cok,"onFocusScopeChanged"))}Cok(a,
b){if((a=Object(ua.a)(A.AFrame,u.AFrameworkApplication.Aa))&&b.m_g&&u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.hb.a9){const c=appChrome.selectors.getShyState();c.isActive&&b.m_g.name===a.kKa&&Ww.ShyRibbon.cQa(c.state,1)}}glh(){return 4}flh(){return 4}elh(){Dg.a("inKeytipMode")&&!appChrome.api.inKeytipMode()&&(u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.hb.a9&&appChrome.selectors.getShyState().isActive&&Ww.ShyRibbon.cQa(1,0),this.Od.xf(A.AFrame.wW));return 4}bJb(a,b,c){const h=
w.KeyInputManager.Na(z.a.Pq,0),m=w.KeyInputManager.Na(z.a.Pq,4);a.Ap(h);a.Ap(m);a.bindAction(h,b);a.bindAction(m,c)}gsk(a){a.pc&&a.pc.target&&"input"!==a.pc.target.tagName.toLowerCase()&&a.pc.preventDefault();return!1}dispose(){this.Ca.WO(H.a.qoc,he.a.frame,Object(F.a)(this,this.glh,"ribbonMoveForwardAction"));this.Ca.WO(H.a.poc,he.a.frame,Object(F.a)(this,this.flh,"ribbonMoveBackwardAction"));this.Ca.WO(H.a.mld,he.a.frame,Object(F.a)(this,this.elh,"ribbonEscAction"))}}Object(n.a)(pG,"ReactRibbonFocusManager",
null,[106]);class fB{constructor(){this.CommandLocation=0;this.CommandTabName=null;this.InvocationMethod=0}}Object(n.a)(fB,"CommandSqmInfo",null,[]);var Zw=d(351),$w;(function(a){a[a.UnspecifiedGallery=0]="UnspecifiedGallery";a[a.CharacterCodeGallery=1]="CharacterCodeGallery";a[a.FontStyleGallery=2]="FontStyleGallery";a[a.InkThicknessGallery=3]="InkThicknessGallery";a[a.IconGallery=4]="IconGallery";a[a.ListGallery=5]="ListGallery";a[a.TableStyleGallery=6]="TableStyleGallery";a[a.PageNumberGallery=
7]="PageNumberGallery";a[a.ChangeColorsGallery=8]="ChangeColorsGallery"})($w||($w={}));Object(n.b)("GalleryType",$w);class qo{constructor(){this.title=this.style=this.hidden=this.disabled=null}}Object(n.a)(qo,"CommonGalleryButtonProps",null,[]);class Ny extends qo{constructor(){super();this.tableStyles=this.tableCellStyles=null;this.columns=0}}Object(n.a)(Ny,"AdditionalTableStyleGalleryButtonProps",qo,[]);class qG extends Ny{constructor(){super()}}Object(n.a)(qG,"AdditionalChangeColorsGalleryButtonProps",
Ny,[]);class rG extends qo{constructor(){super();this.character=null}}Object(n.a)(rG,"AdditionalCharacterCodeGalleryButtonProps",qo,[]);class sG extends qo{constructor(){super();this.previewStyleLabel=this.styleDisplayName=null}}Object(n.a)(sG,"AdditionalFontStyleGalleryButtonProps",qo,[]);class tG{constructor(){this.selectedId=this.sections=this.hidden=this.disabled=null;this.level=this.columns=0;this.styles=null;this.galleryType="TableStyleGallery"}}Object(n.a)(tG,"AdditionalGalleryProperties",
null,[]);class uG extends qo{constructor(){super();this.largePreviewIconStyle=this.largeFullIconStyle=this.keytip=this.previewIconStyle=this.fullIconStyle=this.label=this.icon=null}}Object(n.a)(uG,"AdditionalIconButtonProperties",qo,[]);class vG extends qo{constructor(){super();this.styleDisplayName=null}}Object(n.a)(vG,"AdditionalInkThicknessGalleryButtonProps",qo,[]);class wG extends qo{constructor(){super();this.ariaLabel=this.infoAtLevel=null}}Object(n.a)(wG,"AdditionalListGallerButtonProps",
qo,[]);class xG extends qo{constructor(){super();this.text=null}}Object(n.a)(xG,"AdditionalPageNumberGalleryButtonProps",qo,[]);var Oy=d(663),am=d(924),yG=d(1106);class gB{}gB.Text="Text";Object(n.a)(gB,"TextBoxCommandProperties",null,[]);var bm=d(302);const wP=(a,b)=>{var c=appChrome.selectors.getActiveControlStates();if(c=Object(ua.a)(Object,c[a])){if((a=Object(ua.a)(String,c.value))&&a===b)return!1;a=Object(ua.a)(String,c.selectedKey);if(!b&&!a)return!1;if(a){c=Array.isArray(c.options)?c.options:
null;let h=null;for(let m=0;m<c.length;m++){const y=Object(ua.a)(Object,c[m]);if(Object(ua.a)(String,y.key)===a){h=y;break}}if(h&&Object(ua.a)(String,h.text)===b)return!1}}return!0},AG=(a,b,c,h)=>{if(0<(h&2)){h=[];switch(b){case "ToggleButtonModel":case "InkButtonModel":h.push(Py(a,c[Zh.a.On]));break;case "CheckboxModel":h.push(appChrome.actions.toggleCheckbox(a,c[Zh.a.On]));break;case "ComboBoxModel":if(u.AFrameworkApplication.fa&&(u.AFrameworkApplication.fa.ka("ReactRibbonDispatchActionFilter")||
u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ReactRibbonDispatchActionFilter",!1))&&!wP(a,c[Wn.a.Value]))break;(b=c[Wn.a.Key])?h.push(appChrome.actions.updateComboBoxKey(a,b,c[Wn.a.Value])):h.push(appChrome.actions.updateComboBoxValue(a,c[Wn.a.Value]));break;case "FontPickerModel":h.push(appChrome.actions.updateFontPickerSelectedFont(a,c[Xn.SelectedFont]));break;case "SplitButtonModel":h.push(Py(a,c[yG.a.On]));break;case "SpinButtonModel":h.push(appChrome.actions.updateSpinButton(a,
c[Pm.Number],te.a.g0b(c[Pm.UnitType]),c[Pm.Text],c[Pm.MaxValue],c[Pm.Alt]));break;case "ColorPickerModel":h.push(appChrome.actions.updateColorPickerSelectedColor(a,c[rv.IndexColorSelected]));break;case "PageNumberGalleryButtonModel":h.push(appChrome.actions.updatePageNumberGalleryButtonText(a,c[am.a.Text]));break;case "CompoundButtonModel":c[Zh.a.Description]&&h.push(appChrome.actions.updateCompoundButtonDescription(a,c[Zh.a.Description]));Zh.a.On in c&&h.push(Py(a,c[Zh.a.On]));break;case "SliderModel":c.snapToStep?
h.push(appChrome.actions.updateSliderSelectedValue(a,c[Oo.Value])):h.push(appChrome.actions.updateSliderValue(a,c[Oo.Value],c[Oo.MinValue]||0,c[Oo.MaxValue],c[Oo.Text]));break;case "FlyoutAnchorModel":Oy.a.ImageIsVisible in c&&h.push(appChrome.actions.hideFlyoutAnchorIcon(a,!c[Oy.a.ImageIsVisible]));Zh.a.On in c&&h.push(Py(a,c[Zh.a.On]));break;case "InputBoxModel":h.push(appChrome.actions.updateInputBoxValue(a,c[gB.Text]))}b=h;var m=Object(ua.a)(String,c[bm.a.iconColor]);void 0!==m&&null!==m&&b.push(appChrome.actions.updateIconColor(a,
m));zG(a,c,h);b=h;(m=Object(ua.a)(Object,c[bm.a.IconSet]))&&b.push(appChrome.actions.setControlIconSet(a,m));b=h;m=Object(ua.a)(String,c[bm.a.customTooltip]);void 0!==m&&null!==m&&b.push(appChrome.actions.setControlCustomTooltip(a,m));a=h;(c=Array.isArray(c[bm.a.Bfh])?c[bm.a.Bfh]:null)&&a.push.apply(a,c);return h}return null},Tt=(a,b)=>appChrome.actions.updateControlEnabledDisabledState(a,b),Py=(a,b)=>appChrome.actions.toggleButton(a,b),zG=(a,b,c)=>{b=Object(ua.a)(String,b[bm.a.Icon]);void 0!==b&&
null!==b&&c.push(appChrome.actions.setControlIcon(a,b))};class BG{constructor(a,b,c,h){this.xn=h;this.vqa=a;this.yK=b;this.mpb=c;this.lTb={}}UAk(a,b,c,h,m=null){const y=a.ExternalGalleryId||a.ExternalId;var G=a.ExternalId;h.push(y);if(appChrome.selectors.isControlDefined(y))a.GalleryStyle&&Dg.d("setGalleryStyles")&&b.push(appChrome.actions.setGalleryStyles(y,a.GalleryStyle));else{if(4!==a.Type)return;c.push(appChrome.api.createGalleryModel(y,Object.assign(new tG,{columns:a.Width,sections:[appChrome.api.gallerySection([],
G)],styles:a.GalleryStyle,galleryType:"IconGallery"})))}c=0;h=!!u.AFrameworkApplication.fa&&(u.AFrameworkApplication.fa.ka("ReactRibbonDispatchActionFilter")||u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ReactRibbonDispatchActionFilter",!1));if(Dg.d("setGallerySections")&&a.GallerySections&&0<a.GallerySections.length){G=[];const ja=[],va=[],Ta={};for(var U of a.GallerySections){G.push(appChrome.api.gallerySection([],U.SectionId,U.Title));0===c&&U.GalleryButtons&&
0<U.GalleryButtons.length&&(c=U.GalleryButtons[0].Type);h&&this.T2f(U.GalleryButtons,m,Ta);const fb=this.mNd(ja,U.GalleryButtons,Ta);ja.push.apply(ja,this.S7d(fb,y,U.SectionId,!1,c,m,!0,Ta));va.push.apply(va,fb)}b.push(appChrome.actions.setGallerySections(y,G));b.push.apply(b,ja);b.push.apply(b,this.Y5d(y,$w[c],va,null,5===a.Type,!0,null,Ta))}else a.GalleryItems&&0<a.GalleryItems.length&&(c=a.GalleryItems[0].Type),U=h?this.T2f(a.GalleryItems,m,null):null,b.push.apply(b,this.S7d(this.mNd(b,a.GalleryItems,
U),y,G,!1,c,m,!1,U))}Aej(a,b){const c=[];let h=null,m=!1;if(!a)return null;const y=this.vqa.Vkc(this.yK,a.commandId,b);c.push(Tt(a.externalUxCommand,!y));if(a.previewControlIds){const ja=[];for(let va=0;va<a.previewControlIds.length;va++){var G={},U=a.previewControlIds[va];G.SourceControlId=U;const Ta=this.xn.getCommandByExternalUxId(U);this.RSc(Ta||a,G);G[am.a.On]&&(h=G.SourceControlId,G[am.a.HighlightOn]&&(m=!0));zG(U,G,c);if(G=Object(ua.a)(Zw.a,G[am.a.GalleryButtonProps]))ja.push(G),y&&(U=this.vqa.Vkc(this.yK,
G.Command,b),G.IsDisabled=!U)}0<ja.length&&c.push.apply(c,this.S7d(this.mNd(c,ja),a.externalUxCommand,a.externalUxCommand,!0,ja[0].Type));c.push(appChrome.actions.updateGallerySelectedId(a.externalUxCommand,h));m&&(ba.ULS.sendTraceTag(561394453,340,50,"HighlightSelectedFontStyle fired for {0} button",h),c.push(appChrome.actions.highlightSelectedFontStyle(h)))}return c}mNd(a,b,c=null){const h=[],m=[];for(let G=0;G<b.length;G++){const U=b[G],ja=cl.a(U.ExternalId)?U.Id:U.ExternalId;h.push(ja);const va=
c&&c[ja]?c[ja].result:-1;switch(U.Type){case 1:var y=U;m.push(appChrome.api.createCharacterCodeGalleryButtonModel(ja,Object.assign(new rG,{disabled:-1!==va?1>(va&1):y.IsDisabled,character:y.Character,style:y.Style,title:y.Alt})));break;case 2:y=U;m.push(appChrome.api.createFontStylesGalleryButtonModel(ja,Object.assign(new sG,{disabled:-1!==va?1>(va&1):y.IsDisabled,styleDisplayName:y.LabelText,style:y.Style,title:y.Alt,previewStyleLabel:y.PreviewStyleLabel})));break;case 3:y=U;m.push(appChrome.api.createInkThicknessGalleryButtonModel(ja,
Object.assign(new vG,{disabled:-1!==va?1>(va&1):y.IsDisabled,styleDisplayName:y.LabelText,style:y.Style,title:y.Alt})));break;case 4:y=U;m.push(appChrome.api.createIconGalleryButtonModel(ja,Object.assign(new uG,{disabled:-1!==va?1>(va&1):y.IsDisabled,icon:[y.Icon],fullIconStyle:y.FullIconStyle,previewIconStyle:y.PreviewIconStyle,largePreviewIconStyle:y.LargePreviewIconStyle,label:y.LabelText,title:y.Alt})));break;case 5:y=U;m.push(appChrome.api.createListGalleryButtonModel(ja,Object.assign(new wG,
{disabled:-1!==va?1>(va&1):y.IsDisabled,infoAtLevel:y.LevelInfo,ariaLabel:y.Alt})));break;case 6:y=U;m.push(appChrome.api.createTableStyleGalleryButtonModel(ja,Object.assign(new Ny,{disabled:-1!==va?1>(va&1):y.IsDisabled,tableCellStyles:y.TableCellStyles,tableStyles:y.TableStyles,title:y.Alt,columns:y.columns})));break;case 8:y=U;m.push(appChrome.api.createChangeColorsGalleryButtonModel(ja,Object.assign(new qG,{disabled:-1!==va?1>(va&1):y.IsDisabled,tableCellStyles:y.TableCellStyles,tableStyles:y.TableStyles,
title:y.Alt})));break;case 7:y=U,m.push(appChrome.api.createPageNumberGalleryButtonModel(ja,Object.assign(new xG,{disabled:-1!==va?1>(va&1):y.IsDisabled,text:y.Text,title:y.Alt})))}this.xn.addCommandToMaps(Object.assign(new Pa.a(ja,U.Command),{queryCommandId:U.QueryCommand,menuItemId:U.MenuItemId}))}a.push(appChrome.actions.addControls(m));return h}S7d(a,b,c,h,m,y=null,G=!1,U=null){const ja=[];h?ja.push(appChrome.actions.populateGalleryItems(b,a)):(this.lTb[b]=!1,G||(h=!0,appChrome.selectors.isControlDefined(b)&&
(h=appChrome.selectors.getGalleryState(b),h=h.disableIndividualButtons?h.disableIndividualButtons:!0),ja.push.apply(ja,this.Y5d(b,$w[m],a,null,5===m,h,y,U))),ja.push(appChrome.actions.updateGallerySectionItems(b,c,a)));return ja}c9i(a){return this.Y5d(a.ExternalUxId,a.galleryType,a.items,a.sections,a.isListGallery,a.disableIndividualButtons?a.disableIndividualButtons:!0)}Y5d(a,b,c,h,m,y=!0,G=null,U=null){const ja=[];if(a in this.lTb){if(this.lTb[a])return delete this.lTb[a],ja;this.lTb[a]=!0}let va=
null,Ta=-1;if(c)({xWf:Ta,returnValue:va}=this.Cqf(b,c,ja,y,G,U));else if(h)for(const fb of h)(c=({xWf:Ta}=this.Cqf(b,fb.galleryButtons,ja,y,null,U)).returnValue)&&(va=c);ja.push(appChrome.actions.updateGallerySelectedId(a,va));y&&ja.push(Tt(a,!1));m&&0<Ta&&ja.push(appChrome.actions.updateListGalleryTextDirection(a,2===Ta));return ja}S2f(a,b=null){const c={},h={};h.SourceControlId=a;h.Location=b;a=this.xn.getCommandByExternalUxId(a);if(!a)return c.result=-1,c.props=h,c;a=this.RSc(a,h);c.result=a;c.props=
h;return c}T2f(a,b=null,c=null){c||(c={});for(const h of a)a=cl.a(h.ExternalId)?h.Id:h.ExternalId,c[a]=this.S2f(a,b);return c}Cqf(a,b,c,h,m=null,y=null){let G,U=null;G=-1;let ja=!1;for(const Ta of b){var va=this.a9i(a);b=y&&y[Ta]&&-1!==y[Ta].result?y[Ta]:this.S2f(Ta,m);const fb=b.result;b=b.props;h&&c.push(Tt(Ta,1>(fb&1)));(va=AG(Ta,va,b,fb))&&c.push.apply(c,va);b[am.a.On]&&(U=Ta,b[am.a.HighlightOn]&&b[am.a.HighlightOn]&&(ja=!0));void 0!==b[bm.a.labelText]&&null!==b[bm.a.labelText]&&(va=this.xn.getCommandByExternalUxId(Ta),
c.push(appChrome.actions.setControlLabel(va.externalUxCommand,b[bm.a.labelText])));b[am.a.IsRtl]&&0>G&&(G=b[am.a.IsRtl])}ja&&(ba.ULS.sendTraceTag(561394456,340,50,"HighlightSelectedFontStyle fired for {0} button",U),c.push(appChrome.actions.highlightSelectedFontStyle(U)));return{returnValue:U,xWf:G}}a9i(a){switch(a){case "CharacterCodeGallery":return"CharacterCodeGalleryButtonModel";case "FontStyleGallery":return"FontStyleGalleryButtonModel";case "InkThicknessGallery":return"InkThicknessGalleryButtonModel";
case "IconGallery":return"IconGalleryButtonModel";case "ListGallery":return"ListGalleryButtonModel";case "TableStyleGallery":return"TableStyleGalleryButtonModel";case "ChangeColorsGallery":return"ChangeColorsGalleryButtonModel";case "PageNumberGallery":return"PageNumberGalleryButtonModel"}return"None"}RSc(a,b){b.MenuItemId=a.menuItemId;return this.vqa.Ogd(this.yK,this.mpb,a.commandId,a.queryCommandId,b)}}Object(n.a)(BG,"ReactGalleryPoller",null,[]);var xP=d(579),Qy=d(785),yP=d(787);class hB extends zf.a{constructor(){super()}get ControlType(){return 3}}
Object(n.a)(hB,"CompoundButtonProps",zf.a,[]);var zP=d(925),qq=d(578);class CG{constructor(){this.initialPinnedFontKeys=this.mruList=this.fonts=this.commandId=null;this.isSubscriber=!1;this.previewFontFamily=null}}Object(n.a)(CG,"PopulateFontPickerDataProps",null,[]);var Pr=d(405);class DG extends nq{constructor(){super();this.ariaDescription=this.lang=this.roleInMenu=this.styles=this.commandValueId=null}}Object(n.a)(DG,"OptionalCompoundButtonProperties",nq,[]);class EG extends nq{constructor(){super();
this.onRetryCommandId=this.retryButtonTitle=null}}Object(n.a)(EG,"OptionalErrorViewProperties",nq,[]);class FG extends pv{constructor(){super();this.styles=this.secondaryText=null;this.flipIconInRtl=!1}}Object(n.a)(FG,"OptionalPersonaButtonProperties",pv,[]);class Ry extends nq{constructor(){super();this.toggled=!1;this.roleInMenu=null;this.toggleUsingIcon=!1}}Object(n.a)(Ry,"OptionalToggleButtonProperties",nq,[]);var AP=d(927),BP=d(926),Sy=d(469);class GG{constructor(){this.NEf=this.actions=null;
this.PIh=!1}}Object(n.a)(GG,"PopulateActions",null,[]);class iB{W4f(a,b){switch(b){case "ColorPickerModel":return appChrome.selectors.getColorPickerState(a);case "ToggleButtonModel":return this.Sej(a);case "InkButtonModel":return this.Rej(a);case "GalleryModel":return appChrome.selectors.getGalleryState(a);case "SplitButtonModel":return appChrome.selectors.getSplitButtonState(a);case "SliderModel":return appChrome.selectors.getSliderState(a)}return{}}Sej(a){const b={};b[Zh.a.On]=appChrome.selectors.getButtonToggleState(a);
return b}Rej(a){const b={};b[Zh.a.On]=Dg.j("getInkButtonToggleState")?appChrome.selectors.getInkButtonToggleState(a):appChrome.selectors.getButtonToggleState(a);return b}}Object(n.a)(iB,"ReactStatePropsSelector",null,[]);class Ty{constructor(a,b,c,h,m){this.vqa=a;this.yK=b;this.mpb=c;this.xn=h;this.qKd={};this.vYh=new iB;this.j4a=m}Yvh(a){const b=a.populationProps.populateQueryCommandId;return a.populationProps.populateOnlyOnce&&b in this.qKd}ofj(a,b,c=null){const h=[],m={};if(!this.Yvh(a)){const y=
a.populationProps.populateQueryCommandId,G={};G.MenuId=a.externalUxCommand;G.IsShadowMenuOpen=this.isShadowMenuOpen(c);if(0<(this.vqa.Ogd(this.yK,this.mpb,y,y,G,this.o$i(c))&1))if("FontPickerModel"===b)this.qKd[y]=!0,h.push(Ty.lej(a,G)),m[a.externalUxCommand]="FontPickerModel";else if(G.MenuItems)switch(this.qKd[y]=!0,b){case "ComboBoxModel":h.push(Ty.jej(a,G));m[a.externalUxCommand]="ComboBoxModel";break;case "FlyoutAnchorModel":case "InkFlyoutAnchorModel":case "PreviewGalleryModel":case "SplitButtonModel":case "StatefulSplitButtonModel":h.push.apply(h,
this.k6f(a.externalUxCommand,b,G.MenuItems,m,c&&"location"in c?c.location:null))}}return Object.assign(new GG,{actions:h,NEf:m,PIh:this.isShadowMenuOpen(c)})}y1f(a,b,c,h,m,y,G,U,ja=null){let va=null;const Ta=[];cl.b(a.Title)||(va=a.Title);for(let fb=0;fb<a.ControlList.length;fb++){const Db=Object(ua.a)(vA.a,a.ControlList[fb]);if(!Db||Db.ExternalId)y&&this.z4i(Db,y),b.push.apply(b,this.kej(Db,G,Ta,m,c,h,ja))}return U?appChrome.api.menuSection(Ta,va,a.Lang):null}k6f(a,b,c,h,m=null){const y=[],G=[],
U=[],ja=[];for(var va=0;va<c.MenuSectionList.length;va++){var Ta=Object(ua.a)(di.a,c.MenuSectionList[va]);Ta&&(Ta=this.y1f(Ta,y,a,b,ja,h,G,c.UpdateDynamically,m),c.UpdateDynamically&&U.push(Ta))}va=null;c.MenuFooterSection&&(va=this.y1f(c.MenuFooterSection,y,a,b,ja,h,G,c.UpdateDynamically,m));c.UpdateDynamically&&y.push(appChrome.actions.updateMenu(a,U,c.Title,c.AriaLabel,c.ShouldAutoOpen,c.AriaRoleDescription,c.MenuTargetDescriptor,va));0<G.length&&y.splice(0,0,appChrome.actions.addControls(G));
0<ja.length&&Dg.d("setStatefulSplitButtonMruBypassControls")&&y.push(appChrome.actions.setStatefulSplitButtonMruBypassControls(a,ja));return y}z4i(a,b){switch(a.ControlType){case 1:case 3:b[a.ExternalId]=1===a.ControlType?"ButtonModel":"CompoundButtonModel";break;case 2:b[a.ExternalId]="ToggleButtonModel";break;case 6:b[a.ExternalId]="CheckboxModel";break;case 7:b[a.ExternalId]="ColorPickerModel";a=Object(ua.a)(Qy.a,a);a.McuLayout&&(b[a.McuExternalId]="ColorPickerModel");break;case 9:b[a.ExternalId]=
"FlyoutAnchorModel"}}kej(a,b,c,h,m,y,G=null){const U=[];switch(a.ControlType){case 1:case 3:h=Object(ua.a)(zf.a,a);this.CAk(h,U,b,c);h.MenuItemsStatefulData&&Dg.d("setStatefulSplitButtonMenuItemsStatefulData")&&U.push(appChrome.actions.setStatefulSplitButtonMenuItemsStatefulData(m,h.MenuItemsStatefulData));break;case 2:this.rBk(Object(ua.a)(Sy.a,a),U,b,c);break;case 6:this.FAk(Object(ua.a)(xP.a,a),U,b,c);break;case 4:this.jBk(Object(ua.a)(go,a),U,b,c);break;case 7:this.GAk(Object(ua.a)(Qy.a,a),U,
b,c);break;case 12:this.MAk(Object(ua.a)(zP.a,a),U,c);break;case 9:m=Object(ua.a)(En.a,a);this.PAk(m,U,b,c);"StatefulSplitButtonModel"===y&&h.push(m.ExternalId);break;case 8:this.j4a.UAk(Object(ua.a)(qq.a,a),U,b,c,G)}return U}CAk(a,b,c,h){h.push(a.ExternalId);appChrome.selectors.isControlDefined(a.ExternalId)?(a.LabelText&&b.push(appChrome.actions.setControlLabel(a.ExternalId,a.LabelText)),a.Description&&b.push(appChrome.actions.updateCompoundButtonDescription(a.ExternalId,a.Description)),a.CommandValueId&&
b.push(appChrome.actions.setButtonCommandValueId(a.ExternalId,a.CommandValueId)),this.qGc()&&((c=this.hta(a))&&0<c.length&&b.push(appChrome.actions.setControlIconSet(a.ExternalId,(new Cp.a(c)).iconSet)),a.LabelText!==a.Alt&&b.push(appChrome.actions.setControlCustomTooltip(a.ExternalId,a.Alt)))):(a.Description||Object(za.a)(hB,a)?c.push(appChrome.api.createCompoundButtonModel(a.ExternalId,a.LabelText,a.Description,Object.assign(new DG,{iconSet:(new Cp.a(this.hta(a))).iconSet,keytip:a.KeyTip,roleInMenu:a.RoleInMenu,
ariaDescription:a.AriaDescription,customTooltip:a.LabelText!==a.Alt?a.Alt:null}))):c.push(appChrome.api.createButtonModel(a.ExternalId,a.LabelText,Object.assign(new pv,{iconSet:(new Cp.a(this.hta(a))).iconSet,keytip:a.KeyTip,supportsPreview:!!a.CommandPreviewId&&!!a.CommandRevertId,customTooltip:a.LabelText!==a.Alt?a.Alt:null,commandValueId:a.CommandValueId,shouldTakeFocus:a.ShouldTakeFocus}))),this.xn.addCommandToMaps(Object.assign(new Pa.a(a.ExternalId,a.Command),{menuItemId:a.MenuItemId,queryCommandId:a.QueryCommand,
commandPreviewId:a.CommandPreviewId,commandRevertId:a.CommandRevertId})));a.Lang&&Dg.d("setControlLanguage")&&b.push(appChrome.actions.setControlLanguage(a.ExternalId,a.Lang))}FAk(a,b,c,h){h.push(a.ExternalId);appChrome.selectors.isControlDefined(a.ExternalId)?(a.LabelText&&b.push(appChrome.actions.setControlLabel(a.ExternalId,a.LabelText)),this.qGc()&&((c=this.hta(a))&&0<c.length&&b.push(appChrome.actions.setControlIconSet(a.ExternalId,(new Cp.a(c)).iconSet)),a.IsChecked&&b.push(appChrome.actions.toggleButton(a.ExternalId,
a.IsChecked)),a.LabelText!==a.Alt&&b.push(appChrome.actions.setControlCustomTooltip(a.ExternalId,a.Alt)))):(c.push(appChrome.api.createToggleButtonModel(a.ExternalId,a.LabelText,Object.assign(new Ry,{iconSet:(new Cp.a(this.hta(a))).iconSet,keytip:a.KeyTip,toggled:a.IsChecked,fullDescriptionLabel:a.Description,roleInMenu:a.AriaLabel,customTooltip:a.LabelText!==a.Alt?a.Alt:null,toggleUsingIcon:!!a.CheckedImageClass}))),this.xn.addCommandToMaps(Object.assign(new Pa.a(a.ExternalId,a.Command),{menuItemId:a.MenuItemId,
queryCommandId:a.QueryCommand})))}MAk(a,b,c){c.push(a.ExternalId);appChrome.selectors.isControlDefined(a.ExternalId)?(a.Label&&b.push(appChrome.actions.setControlLabel(a.ExternalId,a.Label)),a.IconName&&0<a.IconName.length&&b.push(appChrome.actions.setControlIcon(a.ExternalId,a.IconName))):appChrome.api.createErrorViewModel(a.ExternalId,a.Label,a.IconName,Object.assign(new EG,{retryButtonTitle:a.RetryButtonTitle,onRetryCommandId:a.OnRetryCommandId}))}rBk(a,b,c,h){h.push(a.ExternalId);appChrome.selectors.isControlDefined(a.ExternalId)?
(a.LabelText&&b.push(appChrome.actions.setControlLabel(a.ExternalId,a.LabelText)),this.qGc()&&((c=this.hta(a))&&0<c.length&&b.push(appChrome.actions.setControlIconSet(a.ExternalId,(new Cp.a(c)).iconSet)),u.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.ToggleButtonTooltip")&&a.LabelText!==a.Alt&&b.push(appChrome.actions.setControlCustomTooltip(a.ExternalId,a.Alt)))):(u.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.ToggleButtonTooltip")?
c.push(appChrome.api.createToggleButtonModel(a.ExternalId,a.LabelText,Object.assign(new Ry,{iconSet:(new Cp.a(this.hta(a))).iconSet,iconColor:a.IconColor,keytip:a.KeyTip,fullDescriptionLabel:a.Description,roleInMenu:a.AriaLabel,customTooltip:a.LabelText!==a.Alt?a.Alt:null}))):c.push(appChrome.api.createToggleButtonModel(a.ExternalId,a.LabelText,Object.assign(new Ry,{iconSet:(new Cp.a(this.hta(a))).iconSet,iconColor:a.IconColor,keytip:a.KeyTip,fullDescriptionLabel:a.Description,roleInMenu:a.AriaLabel}))),
this.xn.addCommandToMaps(Object.assign(new Pa.a(a.ExternalId,a.Command),{menuItemId:a.MenuItemId,queryCommandId:a.QueryCommand})))}jBk(a,b,c,h){h.push(a.ExternalId);h=this.Wdj(a);appChrome.selectors.isControlDefined(a.ExternalId)?a.LabelText&&b.push(appChrome.actions.setPersonaButtonCoauthor(a.ExternalId,h,a.LabelText)):Dg.a("createPersonaButtonModel")&&c.push(appChrome.api.createPersonaButtonModel(a.ExternalId,h,a.LabelText,Object.assign(new FG,{role:a.RoleInMenu,fullDescriptionLabel:a.AriaDescription,
iconSet:{["default"]:"doughboywhiteglyph_20"}})))}PAk(a,b,c,h){h.push(a.ExternalId);if(appChrome.selectors.isControlDefined(a.ExternalId))a.LabelText&&b.push(appChrome.actions.setControlLabel(a.ExternalId,a.LabelText)),this.qGc()&&((c=this.hta(a))&&0<c.length&&b.push(appChrome.actions.setControlIconSet(a.ExternalId,(new Cp.a(c)).iconSet)),void 0!==a.ImageIsVisible&&null!==a.ImageIsVisible&&b.push(appChrome.actions.hideFlyoutAnchorIcon(a.ExternalId,!a.ImageIsVisible)),void 0!==a.Toggled&&null!==a.Toggled&&
b.push(appChrome.actions.toggleButton(a.ExternalId,a.Toggled)));else{h=!(void 0===a.ImageIsVisible||null===a.ImageIsVisible)&&!a.ImageIsVisible;const m=!(void 0===a.Toggled||null===a.Toggled)&&a.Toggled;c.push(appChrome.api.createFlyoutAnchorModel(a.ExternalId,a.LabelText,Object.assign(new zy,{iconSet:(new Cp.a(this.hta(a))).iconSet,keytip:a.KeyTip,hideIcon:h,toggled:m,roleInMenu:a.AriaLabel,customTooltip:a.LabelText!==a.Alt?a.Alt:null})));this.xn.addCommandToMaps(Object.assign(new Pa.a(a.ExternalId,
a.Command),{queryCommandId:a.QueryCommand,populationProps:new Yg(a.PopulateQueryCommand,a.PopulateOnlyOnce)}))}a.Menu&&b.push.apply(b,this.k6f(a.ExternalId,"FlyoutAnchorModel",a.Menu,null));a.Lang&&b.push(appChrome.actions.setControlLanguage(a.ExternalId,a.Lang))}GAk(a,b,c,h){a.McuLayout&&h.push(a.McuExternalId);h.push(a.ExternalId);h=0;appChrome.selectors.isControlDefined(a.ExternalId)?a.McuLayout&&(h=this.vYh.W4f(a.ExternalId,"ColorPickerModel").columnCount):(a.McuLayout&&(c.push(appChrome.api.createColorPickerModel(a.McuExternalId,
a.Width)),this.xn.addCommandToMaps(Object.assign(new Pa.a(a.McuExternalId,a.Command),{commandPreviewId:a.CommandPreviewId,commandRevertId:a.CommandRevertId})),h=a.Width),c.push(appChrome.api.createColorPickerModel(a.ExternalId,a.Width)),this.xn.addCommandToMaps(Object.assign(new Pa.a(a.ExternalId,a.Command),{commandPreviewId:a.CommandPreviewId,commandRevertId:a.CommandRevertId})));c=[];const m=[];for(let y=0;y<a.Colors.length;y++){const G=a.Colors[y];y<h?c.push(appChrome.api.colorPickerCell(G.Color,
G.DisplayColor,G.Alt)):m.push(appChrome.api.colorPickerCell(G.Color,G.DisplayColor,G.Alt))}0<c.length&&b.push(appChrome.actions.populateColorPickerCells(a.McuExternalId,c));b.push(appChrome.actions.populateColorPickerCells(a.ExternalId,m));a.SelectedColorId&&(0<c.length&&b.push(appChrome.actions.updateColorPickerSelectedColor(a.McuExternalId,a.SelectedColorId)),b.push(appChrome.actions.updateColorPickerSelectedColor(a.ExternalId,a.SelectedColorId)))}hta(a){return a.Image32by32Class?this.xn.n_f(a.Image32by32Class):
a.Image16by16Class?this.xn.n_f(a.Image16by16Class):a.ExternalImageId}Wdj(a){return a?Object.assign(new BP.a,{displayName:a.DisplayName,personaCoinColor:a.ImageBackColor,isUnauthenticatedSender:a.IsAnonymous,identifiers:Object.assign(new AP.a,{PersonaType:"User",Smtp:a.PersonaId})}):null}o$i(a){let b=2;a&&"inputMethod"in a&&a.inputMethod&&(b=a.inputMethod);return b}isShadowMenuOpen(a){return!!a&&a.isShadowRendering}qGc(){return u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AllowFullPropPopulation",
!1)}static lej(a,b){return appChrome.actions.populateFontPickerDataAsync(new Promise((c,h)=>{vb.a.instance.Ja("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(m=>{m.isFeatureEnabled(Pr.a.$Ua,!1).then(y=>{let G=b.fonts;y||m.isFreemiumUpsellEnabled()||(G=Ma.a.gpa(G,U=>U.fontType!==Pr.a.$Je));y=Object.assign(new CG,{commandId:a.externalUxCommand,fonts:G,isSubscriber:y,mruList:b.mruList,initialPinnedFontKeys:b.initialPinnedFontKeys,previewFontFamily:"msofp_hier_MSFontService"});
c(y)}).catch(h)})}))}static jej(a,b){const c=[];for(let h=0;h<b.MenuItems.MenuSectionList.length;h++){const m=b.MenuItems.MenuSectionList[h];m.Title&&c.push(appChrome.api.comboBoxHeader("Header-"+h.toString(),m.Title));for(let y=0;y<m.ControlList.length;y++){const G=Object(ua.a)(yP.a,m.ControlList[y]);G&&c.push(appChrome.api.comboBoxItem(G.MenuItemId,G.LabelText,G.Styles,G.CommandValueId,G.AriaLabel,G.Data,G.Disabled))}h<b.MenuItems.MenuSectionList.length-1&&c.push(appChrome.api.comboBoxDivider("Divider-"+
h.toString()))}return appChrome.actions.populateComboBoxOptions(a.externalUxCommand,c)}}Object(n.a)(Ty,"ReactPopulateQueryCommandPoller",null,[]);class HG{constructor(a,b,c,h,m){this.xn=c;this.vqa=a;this.yK=b;this.mpb=h;this.j4a=m}nfj(a,b,c){const h=[];if(this.rJj(b))a=this.cjj(a,b,c),void 0!==a&&null!==a&&h.push.apply(h,a);else if(a){var m=this.RSc(a,c);bm.a.visible in c&&h.push(appChrome.actions.updateControlHiddenState(a.externalUxCommand,!c[bm.a.visible]));h.push(Tt(a.externalUxCommand,1>(m&1)));
void 0!==c[bm.a.labelText]&&null!==c[bm.a.labelText]&&h.push(appChrome.actions.setControlLabel(a.externalUxCommand,c[bm.a.labelText]));void 0!==b&&null!==b&&(m=AG(a.externalUxCommand,b,c,m),void 0!==m&&null!==m&&h.push.apply(h,m),"PeopleWell"===b&&this.V5h(a.externalUxCommand,c,h))}return h}L7i(a,b,c){const h=[];switch(b){case "FlyoutAnchorModel":var m=appChrome.selectors.getFlyoutAnchorMenuItems(a);break;case "SplitButtonModel":var y=appChrome.selectors.getSplitButtonState(a);if(y=this.xn.getCommandByExternalUxId(y.command))c=
this.vqa.Vkc(this.yK,y.commandId,c),h.push(appChrome.actions.updateSplitButtonPrimaryDisabledState(a,!c)),h.push(Tt(a,!1));return h;default:return null}b=!1;for(y in m)if(m=this.xn.getCommandByExternalUxId(y),cl.b(m))b=!0;else if(c.SourceControlId=m.externalUxCommand,this.vqa.Vkc(this.yK,m.commandId,c))return h.push(Tt(a,!1)),h;h.push(Tt(a,!b));return h}cjj(a,b,c){switch(b){case "PreviewGalleryModel":return this.j4a.Aej(a,c);case "GalleryModel":return this.j4a.c9i(c)}return null}rJj(a){return"GalleryModel"===
a||"PreviewGalleryModel"===a}RSc(a,b){b.MenuItemId=a.menuItemId;return this.vqa.Ogd(this.yK,this.mpb,a.commandId,a.queryCommandId,b)}V5h(a,b,c){const h=b[Oy.a.LabelTextUserGeneratedPlaceholderReplacements];b=b[Oy.a.LabelText];h&&0<h.length&&(b=String.format.apply(null,[b].concat(h)));c.push(this.Ulj(a,b))}Ulj(a,b){return appChrome.actions.updatePeopleWell(this.f4i(a),b)}f4i(a){const b=[];var c={};a=this.xn.getCommandByExternalUxId(a).populationProps.populateQueryCommandId;this.vqa.Ogd(this.yK,this.mpb,
"1285265560",a,c);c=c.MenuItems;if(!c)return b;c=c.MenuSectionList[0];for(a=0;a<c.ControlList.length;a++){const h=c.ControlList[a],m={};m.name=h.Alt;m.id=h.MenuItemId;m.description=h.Description;m.color=h.ImageBackColor;m.joinTime=h.JoinTimeInMS;m.imageUrl=h.ImageUrl;m.activeStatus=h.ActiveStatus;m.isAnonymous=h.IsAnonymous;m.canJump=h.CanJump;m.upn=h.Upn;b.push(m)}return b}}Object(n.a)(HG,"ReactQueryCommandPoller",null,[]);class IG{Ogd(a,b,c,h,m,y){let G=0;a&&(this.Vkc(a,c,m)&&(G|=1),c=new fB,c.CommandLocation=
b,void 0!==y&&null!==y&&(c.InvocationMethod=y),!cl.b(h)&&a.xRf(h,m,c)&&(G|=2));return G}Vkc(a,b,c=null){return a?a.W9b(b,c):!1}}Object(n.a)(IG,"RootPoller",null,[]);class JG{constructor(a,b,c){this.xn=a;this.yK=b;a=new IG;this.e0h=new iB;this.j4a=new BG(a,this.yK,c,this.xn);this.Tjf=new Ty(a,this.yK,c,this.xn,this.j4a);this.Ojf=new HG(a,this.yK,this.xn,c,this.j4a)}KSa(){const a=[];if(!Dg.c())return a;a.push.apply(a,this.Slj());var b=this.$6i();if(0<b.length)a.push.apply(a,b);else if(b=appChrome.selectors.getActiveControlIds(),
Object.keys(b).length){const c=this.a7i();for(const h of c)a.push(appChrome.actions.updateControlEnabledDisabledState(h,!0)),delete b[h];a.push.apply(a,this.STc(b))}return a}Xkc(a,b){Dg.c()&&(a=this.STc(a,b),appChrome.api.dispatch(a))}iJe(a,b,c=null){if(!cl.b(a)&&a.populationProps&&!this.Tjf.Yvh(a)){a=this.Tjf.ofj(a,b,c);if(!a.PIh){let h;(h=a.actions).push.apply(h,this.STc(a.NEf,Dg.g(c)))}if(0<a.actions.length)return appChrome.api.dispatch(a.actions),!0}return!1}STc(a,b=0){const c=[],h={};if(Dg.a("isSharedUxGateEnabled")&&
appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.DefaultRibbinUILocationPolling")&&""!==appChrome.selectors.getSelectedTabId())for(var m of appChrome.selectors.getActiveGroupIds())for(var y of appChrome.selectors.getVisibleControlsInGroup(m))h[y]=!0;for(let G in a)m=G,y=a[G],0===b&&h[m]&&(b=2),c.push.apply(c,this.Rlj(m,y,b));return c}Rlj(a,b,c=0){const h=[],m=this.xn.getCommandByExternalUxId(a);let y={};appChrome.selectors.isControlDefined(a)&&(y=this.e0h.W4f(a,b));y[en.a.qEh]=c;cl.b(m)?
(y.ExternalUxId=a,(a=this.Ojf.L7i(a,b,y))&&0<a.length&&h.push.apply(h,a)):(y.MenuItemId=m.menuItemId,y.SourceControlId=a);h.push.apply(h,this.Ojf.nfj(m,b,y));return h}Slj(){const a=[],b=!!u.AFrameworkApplication.fa&&(u.AFrameworkApplication.fa.ka("ReactRibbonDispatchActionFilter")||u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ReactRibbonDispatchActionFilter",!1)),c=appChrome.selectors.getContextualTabIds();let h=[];b&&(h=appChrome.selectors.getActiveContextualTabIds());
for(let y=0;y<c.length;y++){var m=this.xn.m9d(c[y]);if(m){m=this.yK.W9b(m);let G=!0;b&&(G=0<=Array.indexOf(h,c[y]));b&&G===m||a.push(appChrome.actions.activateDeactivateContextualTab(c[y],m))}}return a}$6i(){var a=appChrome.selectors.getSelectedTabId();const b=[],c=this.xn.m9d(a);c&&(this.yK.W9b(c)||b.push(appChrome.actions.updateDisabledEnabledStateForControlsInTab(a,!0)));return b}a7i(){var a=appChrome.selectors.getActiveGroupIds();const b=[];for(const c of a)if(a=this.xn.o9i(c))for(const h of a)this.yK.W9b(h.commandId)||
((a=h.externalUxCommandIds)||(a=appChrome.selectors.getVisibleControlsInGroup(h.externalUxGroupId)),b.push.apply(b,a));return b}}Object(n.a)(JG,"ReactRibbonRootPoller",null,[1525]);class ax{constructor(a,b,c=null){this.yK=this.wTb=this.xOa=null;this.sYh=b;a.xqb(this);this.jaa=c}get s0c(){this.wTb||(this.wTb=new Date,this.wTb.setTime(0));return this.wTb}set s0c(a){this.wTb=a}get PZk(){return 2}get jaa(){return this.yK}set jaa(a){this.yK=a}get $Ib(){this.xOa||(this.xOa=new JG(this.sYh,this.jaa,this.PZk));
return this.xOa}JJc(){const a=document.activeElement;La.a.isEditable(a)&&a.blur()}executeCommand(a,b,c,h,m,y,G,U=2){cl.b(this.jaa)||(m=new fB,m.CommandLocation=U,m.InvocationMethod=h,m.CommandTabName=c,b[en.a.qEh]=U,this.jaa.xRf(a,b,m,y,G),this.T_j(a,b))}KSa(){return cl.b(this.jaa)?[]:this.$Ib.KSa()}Wkc(){const a=this.KSa();0<a.length&&(this.s0c=new Date,appChrome.api.dispatch(a))}xOb(){Dg.c()&&this.$Ib.Xkc({PeopleWell:"PeopleWell"},18)}T_j(a,b){try{const c=vb.a.instance.rb("Common.ISystemInitiatedFeedback");
if(c&&b){const h=b.SourceControlId||b.launcherId||b.LegacyId||b.NewContextId;let m=(h?"_"+h:"")+(b.SqmControlId?"_"+b.SqmControlId:"");m=m.length?m:"_"+a;c.Kme("Ribbon"+m)}}catch(c){ba.ULS.sendTraceTag(527247309,356,10,"LogCommandActivity failed: "+(c?c.toString():""))}}}Object(n.a)(ax,"ReactRibbonRoot",null,[1511,1526]);class jB{constructor(){this.wqa=[]}xqb(a){a&&!Array.contains(this.wqa,a)&&Array.add(this.wqa,a)}mhh(a){Array.remove(this.wqa,a)}JJc(){for(const a of this.wqa)a.JJc()}dispose(){this.wqa=
null}}Object(n.a)(jB,"RootManagerBase",null,[290,106]);class Qr extends jB{constructor(){super()}static get instance(){return Qr.Ka||Qr.ODj()}static ODj(){Qr.Ka=new Qr;return Qr.Ka}}Qr.Ka=null;Object(n.a)(Qr,"ReactRootManager",jB,[289,290]);class ip{constructor(a,b,c,h,m,y,G,U=null,ja=!0,va=null,Ta=null){this.ERb=this.jEc=this.Ixd=this.GP=null;this.cmf=[];this.sCc=null;this.r4a=a;this.XEd=b;this.lpb=c;this.Od=h;this.Ca=m;this.xn=y;this.GP=va?va:new ax(Qr.instance,this.xn);this.n3a=G;this.Skf=new oG;
this.DOa=U;this.AJd=ja;new kG;this.C$e=Ta;Ja.a.get_instance().Dk(7,Object(F.a)(this,this.M8k,"setRibbonPostInteractiveReady"));Ja.a.get_instance().Dk(7,Object(F.a)(this,this.d2j,"logRibbonLoadedActivity"));Ja.a.get_instance().Dk(19,Object(F.a)(this,this.H_j,"logAppLoadedActivity"));u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GeneralizedRibbonTTVRReporting",!1)&&Ja.a.get_instance().Dk(7,Object(F.a)(this,this.BQk,"registerSubComponentReporting"));Ja.a.get_instance().Dk(7,
Object(F.a)(this,this.dIk,"queueSettingsDependentActions"))}initialize(a,b,c=null){this.AJd||this.PJ(5);c?c.then(()=>{this.Mih()}).catch(()=>ba.ULS.sendTraceTag(561394319,340,10,"Failed to load the resources for the Ribbon")):jG.a.bBh(jG.a.bBh(Ge.Task.WAA(this.Bng(a),this.Ang(ip.gOh)),()=>this.Ang(ip.pMh)),()=>this.Bng(b)).continueWith(()=>{this.Mih()},11)}dispose(){this.Kvl();this.sCc&&this.sCc.dispose();for(const a of this.cmf)Ja.a.get_instance().Sri(a);u.AFrameworkApplication.Ta.WO(H.a.SWk,he.a.frame,
ed.ActionManager.Jg)}Ang(a){return vb.a.instance.resolve("Common.ISharedDependencyLoader").pAb(u.AFrameworkApplication.Pj(a,2))}Bng(a){return""===a?Ge.Task.Nt(!0):vb.a.instance.resolve("Common.ISharedDependencyLoader").pAb(u.AFrameworkApplication.Pj(a,3))}icg(){(this.DOa||this.n3a)&&appChrome.api.dispatch(this.g6f());this.GUe();Dg.a("setWebpackPublicPath")&&appChrome.api.setWebpackPublicPath(u.AFrameworkApplication.aga);this.GP.Wkc()}Mih(){this.icg();this.AJd&&(appChrome.renderAppChrome(this.r4a,
Dg.e()),this.PJ(10));this.Wpf();this.AHc();this.AJd&&this.PJ(5);this.lWc()}lWc(){this.Od&&this.Ca&&this.lpb&&(this.sCc=new pG(this.Od,this.Ca,this.r4a,this.lpb),this.sCc.initialize())}get BZk(){return this.Skf}setCommandDefinitionMapping(){if(Dg.a("setCommandDefinitionMapping")){const a=tP(this.xn);appChrome.api.setCommandDefinitionMapping(a)}}registerOnShyRibbonStateChange(){u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.hb.a9&&Dg.a("registerOnShyRibbonStateChange")&&appChrome.api.registerOnShyRibbonStateChange((a,
b)=>{0===b&&this.rHb()})}Wpf(){this.setCommandDefinitionMapping();this.registerOnShyRibbonStateChange();const a=Object(ua.a)(ax,this.GP);this.Ixd=new nG(this.GP,a.$Ib,this.xn,this.Od,this.XEd,vb.a.instance.rb("Common.IRibbonSQMInformation"),vb.a.instance.rb("Common.IFileMenuSQMInformation"),u.AFrameworkApplication.Ta,u.AFrameworkApplication.fa,vb.a.instance.Ja("Common.ISystemInitiatedFeedback"),null);this.khi();this.rpj()}khi(){this.jEc=appChrome.api.bindCommandHandler((a,b)=>{this.Ixd.executeCommand(a,
b)})}Kvl(){this.jEc&&(this.jEc(),this.jEc=null)}GUe(){appChrome.api.initializeLogger(new uP.a)}KSa(){return this.GP?this.GP.KSa():[]}rHb(){id.a.instance.cG(()=>{let a=null;id.a.instance.cG(()=>{a=this.KSa()},"RB:GA");a&&0<a.length&&(this.GP.s0c=new Date,id.a.instance.cG(()=>{appChrome.api.dispatch(a)},"RB:DA"));this.ERb&&id.a.instance.cG(()=>{},"RB:J")},"RB:PFSU")}xOb(){this.GP.xOb()}m3h(a){a=[appChrome.actions.activateDeactivateContextualTab(a,!0),appChrome.actions.setCurrentTab(a)];appChrome.api.dispatch(a)}setCurrentTab(a){a=
[appChrome.actions.setCurrentTab(a)];appChrome.api.dispatch(a)}g6f(){var a=u.AFrameworkApplication.fa;const b=[];a.ka("EnableTellMeForOneLineRibbonIsEnabled")?a.ka("OcpsIsEnabled")&&vb.a.instance.Ja("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(c=>{c.isFeatureEnabled("ConnectedServices",!0).then(h=>{h&&appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("TellMeControl",!1));return null})}):b.push(appChrome.actions.updateControlHiddenState("TellMeControl",!0));
b.push.apply(b,this.s_f());a=new hG.a(this.xn);this.DOa.Eaa&&(hp.ctl(this.DOa.Eaa),b.push.apply(b,a.O3d(this.DOa.Eaa)));if(this.DOa.FCh)for(const c of this.DOa.FCh)b.push(appChrome.actions.updateGallerySectionHiddenState(c.J_i,c.GE,c.etl));b.push.apply(b,a.h1i(this.DOa.dtl));return b}s_f(){const a=[];if(this.n3a&&this.n3a.Eaa){const c=this.n3a.Eaa;for(let h in c){var b=c[h];const m=this.xn.u5d(h);if(m)for(let y of m)a.push(appChrome.actions.updateControlHiddenState(y,b))}}return a}qOb(a){a&&this.GP.$Ib.Xkc(a,
0)}iJe(a){this.GP.$Ib.iJe(this.xn.getCommandByExternalUxId(a),appChrome.selectors.getModelType(a),{inputMethod:0})}Rel(a){Ja.a.get_instance().Dk(5,null).continueWith(()=>{appChrome.api.dispatch(this.eij(a))})}bMi(){const a=u.AFrameworkApplication.fa.ka("ShareMenuIsEnabled")?"ShareMenu":"Share",b=u.AFrameworkApplication.fa.appSettings;b&&appChrome.api.dispatch(this.pAl(a,"Shared"===(b.SharingStatus||"")))}dIk(){u.AFrameworkApplication.fa.jf(()=>{this.bMi()})}pAl(a,b){return appChrome.actions.updateSharingStatusIndicator(a,
b)}eij(a){return appChrome.actions.updateControlHiddenState(a,!1)}fij(){return appChrome.actions.updateControlHiddenState("CopyLink",!1)}PJ(a){Ja.a.get_instance().PJ(a);this.cmf.push(a)}M8k(){Dg.d("updateRibbonInitializationState")&&appChrome.api.dispatch(appChrome.actions.updateRibbonInitializationState(Object.assign(new iG,{postRibbonInteractiveReady:!0})))}AHc(){this.n3a&&this.C$e&&(this.ERb=this.C$e.createFileMenu(this.n3a,this.GP.jaa),this.Skf.fileMenu=this.ERb)}tXj(){this.ERb&&this.ERb.pXj()}old(a,
b,c){if(1===c)return 32;this.vpc(!0);this.rHb();u.AFrameworkApplication.Aa.updateCommandUI();return 32}pld(a,b,c){if(1===c)return 32;this.vpc(!1);this.R8k();this.rHb();u.AFrameworkApplication.Aa.updateCommandUI();return 32}R8k(){oi.a.SJ(u.AFrameworkApplication.fa.Ha("IsSimplifiedRibbonOnCookieName"),"true",oi.a.wJ)}vpc(a){oi.a.SJ(u.AFrameworkApplication.fa.Ha("ReactRibbonMLRPreferenceCookieName"),a.toString(),oi.a.wJ)}d2j(){if(u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.hb.Lo){const a=
vb.a.instance.Ja("Common.ISystemInitiatedFeedback");"SingleLine"===appChrome.selectors.getRibbonMode()?(a.execute(b=>{b.logActivity("SingleRibbonModeActivity",null)}),u.AFrameworkApplication.CL("d79fg304;61jba833;h856e313;f5i2f477")):"Multiline"===appChrome.selectors.getRibbonMode()&&(a.execute(b=>{b.logActivity("MultiRibbonModeActivity",null)}),u.AFrameworkApplication.CL("69a7h198;dfd7j584"));u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DefaultToMLR",!1)&&vb.a.instance.Ja("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(b=>
{b.isFreemiumUpsellEnabled()&&u.AFrameworkApplication.CL("5fjej882;e0jjh200")})}}H_j(){const a=oi.a.n8(u.AFrameworkApplication.fa.Ha("VNextStyleOptOutCookieName"),!1);window.setTimeout(()=>{const b=vb.a.instance.Ja("Common.ISystemInitiatedFeedback");b&&(u.AFrameworkApplication.fa.ka("Fluent2StyleIsEnabled")?(b.execute(c=>{c.logActivity("VNextStylesOn",null)}),b.execute(c=>{c.logActivity("Fluent2StyleEnabledFPS","Fluent2StyleFloodgateSurveyIsEnabled")})):u.AFrameworkApplication.fa.ka("Fluent2StyleFGOnlyIsEnabled")&&
a&&b.execute(c=>{c.logActivity("Fluent2StyleOptOutFPS","Fluent2StyleFloodgateSurveyIsEnabled")}))},5E3)}BQk(){Ja.a.get_instance().Dk(19,()=>{appChrome.api.setAsyncRequestStatus("appBoot",!1)});const a=appChrome.api.getRibbonSubComponentMappings();for(let c in a){var b=c;const h=a[c];if(h)for(const m of h)u.AFrameworkApplication.Ta.$S(m)?appChrome.api.reportRibbonSubComponentBehaviorMapped(b):u.AFrameworkApplication.Ta.H7k(m,this.fEi(b));else appChrome.api.reportRibbonSubComponentBehaviorMapped(b)}}fEi(a){return()=>
{appChrome.api.reportRibbonSubComponentBehaviorMapped(a)}}rpj(){if(u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",!1)&&Dg.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.UnifyPRIToastDismissal")&&u.AFrameworkApplication.nHb.IMd){const a=u.AFrameworkApplication.nHb.IMd,b=u.AFrameworkApplication.nHb.Fpf;b.payload||(b.payload={});const c=b.payload.launcherId?b.payload.launcherId:
a;ip.qld.Hb(c)?ip.qld.ga(c)():"StatefulSplitButtonModel"===b.modelType?appChrome.PRIToastManager.dismissToast():(b.payload.PRIReadinessCheck=!0,this.Ixd.executeCommand(a,b))}}}ip.gOh="common";ip.pMh="appChrome";ip.qld=new sP.a(cB.a.M6f());Object(n.a)(ip,"ReactRibbonUser",null,[229,282,106]);class kB{constructor(){this.label=this.value=null}}Object(n.a)(kB,"TextInfoSectionField",null,[]);class KG{constructor(a,b){this.Eaa=b}}Object(n.a)(KG,"ReactRibbonJewelProperties",null,[]);class lB extends ip{constructor(a,
b,c,h,m,y,G,U,ja=null,va=!0,Ta=null,fb=null){super(a,b,h,m,y,G,U,ja,va,Ta,fb);this.Uxc=null;this.Vxc=c;this.Vxc.execute(Db=>{this.Uxc=Db});this.Vxc.execute(Db=>{this.GP.jaa=Db})}KSa(){return this.Uxc?(this.Uxc.clearCache(),super.KSa()):[]}}Object(n.a)(lB,"ReactRibbonUser",ip,[]);var mB=d(887),Uy=d(245),nB=d(370),LG=d(709),oB=d(1102);class bx{static get Gkg(){return"teams"===(u.AFrameworkApplication.fa.Ha(u.AFrameworkApplication.YJ)||"").toLowerCase()}static get Ysh(){return bx.Gkg?(Ba.a.J(576030427,
811,50,"FileShareEnabled: {0}, CopyLinkForTeamsIsEnabled: {1}",u.AFrameworkApplication.RRa,u.AFrameworkApplication.otb),u.AFrameworkApplication.RRa&&u.AFrameworkApplication.otb):u.AFrameworkApplication.RRa}}Object(n.a)(bx,"CopyLinkHelper",null,[]);class MG{constructor(a,b){this.$Ae=null;this.la=a;this.Ibk=b}dispose(){this.$Ae&&(mm.CuiHelper.EMi(this.$Ae),this.$Ae=null)}rlj(){if(u.AFrameworkApplication.workflowEnabled){let a="";switch(u.AFrameworkApplication.suc){case "Assign":a=CommonUIStrings.l_Assign;
break;case "Submit":a=CommonUIStrings.l_Submit}if(a.length)return Object.assign(new oB.a,{command:"2988588587",label:a,id:"btnWorkflow"})}return u.AFrameworkApplication.Vje&&u.AFrameworkApplication.RZa||u.AFrameworkApplication.Rtc?Object.assign(new oB.a,{command:"1197060601",label:ResourceStrings.L_ReplyWithChanges,id:mm.CuiHelper.Ekd}):u.AFrameworkApplication.RRa?Object.assign(new oB.a,{command:"981334692",label:ResourceStrings.L_Share,image:mm.CuiHelper.Zal,id:mm.CuiHelper.iVe}):null}Idl(){if(bx.Gkg&&
!this.Ibk)return!1;const a=this.rlj();return a&&"981334692"===a.command?this.la.bjg||this.la.DQj:!1}Mdl(){Ba.a.J(512496021,820,50,"FileShareEnabled: {0}, CopyLinkForTeamsIsEnabled: {1}",u.AFrameworkApplication.RRa,u.AFrameworkApplication.otb);return u.AFrameworkApplication.RRa&&(u.AFrameworkApplication.otb||u.AFrameworkApplication.fa.ka("ShareMenuIsEnabled"))}}Object(n.a)(MG,"CuiControlUser",null,[106]);var Vy=d(294);class NG extends lB{constructor(a,b,c,h,m,y,G,U,ja,va,Ta,fb,Db,gc,hc,Gc,Pc,yc,Vd){super(b,
a.nja,h,Ua.a.iaa,m,y,G,null,va,!0,null,Db);this.xrg=this.Sac=this.Eqg=this.ABb=this.Hk=this.mHa=this.la=this.nh=this.EVa=this.C9c=this.Kpe=this.Xte=null;this.hCg=!1;this.T7=0;this.Uue=this.U5c=this.L9=!1;this.Gu=this.k8c=this.keb=null;this.zzf="hideTellMeWrapper";b=new nB.a("ReactRibbonUser::InitPptReactRibbon",!1);try{this.mHa=fb,this.la=Ta,this.Kpe=new MG(this.la,Gc.ka("ShareMenuIsEnabled")),this.Xte=a,this.C9c=ja,this.ABb=G,this.EVa=U||new LG.a,this.nh=this.EVa.OWd(2,"ReactRibbonUser"),this.T7=
0,this.Eqg=va.Eaa,this.L9=!!window.performance&&!!window.performance.now,this.Hk=gc,this.U5c=hc,this.keb=Gc,this.Uue=Pc,this.k8c=yc,this.Gu=Vd,this.qVk(),Ja.a.get_instance().Dk(10,Object(F.a)(this,this.XCj,"initializeFullPptRibbon"),11),Ja.a.get_instance().Dk(10,Object(F.a)(this,this.createHeader,"createHeader"),3)}finally{b&&b.dispose()}}hcg(){rg.a.instance.ic("InitRibbon",(new Date).getTime());Ba.a.J(512496020,801,50,"Initialize SLR Iteration: {0}; IsReactMLRRendered: {1}",this.la.WCk?"2":"1",this.la.zoa);
this.la.qT&&this.la.ka("ActionAIRibbonLoadOn1stTimeEnabled")&&!this.la.ka("ActionAIRibbonLoadedOn1stTime")&&this.c4k();this.la.podsRibbonEarlyRendererExposureControl&&!this.la.UKf?PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.RegisterOrInvokeOnInitializeEarlyRenderedPptRibbon(Object(F.a)(this,this.LCj,"initializeEarlyRenderedPptRibbon")):(rg.a.instance.ic("RenderRibbonStart",Date.now()),this.Oaj(Uy.a(vb.a.instance)).catch(()=>{Ba.a.J(512496019,801,10,"Failed to load the resources for the Ribbon.")}).then(()=>
{rg.a.instance.ic("AppChromeReadyTime",Date.now());appChrome.setScriptLoader(Uy.a(vb.a.instance));Dg.a("setCookieWithExpirationCallback")&&Dg.a("setGetCookieValueCallback")&&(appChrome.api.setCookieWithExpirationCallback((a,b)=>oi.a.SJ(a,b,oi.a.wJ)),appChrome.api.setGetCookieValueCallback(a=>oi.a.get(a)));appChrome.setAppSettings(u.AFrameworkApplication.fa.appSettings);if(this.la.ka("DynamicBundlesIsEnabled")){const a=u.AFrameworkApplication.aga+"exp/";appResourceLoader.init(pP.a.resolveScript,a);
appChrome.api.setWebpackPublicPath(a)}PowerPointWebEditor.AppChromeSettingsLoadedHandler.OnAppChromeSettingsLoaded();this.GUe();Rd.a("ReactMLRPerfOptimisationRemoveAppChromeDependency")?appChrome.initializeRibbonStore(this.la.zoa):appChrome.initializeRibbonStore();this.icg();this.la.getBooleanFeatureGate("Microsoft.Office.SharedOnline.PerceivedRibbonInteractiveIsEnabled",!1)&&1!==u.AFrameworkApplication.Aa.mode&&(this.la.getBooleanFeatureGate("Microsoft.Office.SharedOnline.PRIOnlyAfterInteractivityIsEnabled",
!1)?this.egh():this.Wce());this.la.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ModeSwitcherInitialRenderIsEnabled",!1)&&this.mHa&&this.mHa.wVk();appChrome.renderAppChrome(this.r4a,Dg.e());this.la.AIa&&Rd.a("ModernRibbonShimmerCGEnabled")&&PowerPointWebEditor.MinimalBoot.SetRealRibbon("ContentEditable");Ja.a.get_instance().PJ(5);Ja.a.get_instance().PJ(10);Rd.a("React.SetRibbonBehaviorAttached")&&Ja.a.get_instance().PJ(6);this.Eog();rg.a.instance.ic("Stage1Ribbon",mB.a.t1d&&void 0!==PowerPointWebEditor.FakeRibbon.ShowTime&&
null!==PowerPointWebEditor.FakeRibbon.ShowTime?PowerPointWebEditor.FakeRibbon.ShowTime:(new Date).getTime())}))}egh(){Ja.a.get_instance().Dk(4,()=>{Ja.a.get_instance().isCompleted(7)||this.Wce()})}c4k(){oi.a.SJ("PPTActionAIRibbonLoadedOnIstTime",(!0).toString(),oi.a.wJ)}Oaj(a){return Rd.a("ReactMLRPerfOptimisationRemoveAppChromeDependency")?this.la.zLk?a(this.la.zoa?"powerpoint-ribbon-mlr-intl":"powerpoint-ribbon-intl").catch(()=>{}).then(()=>a("appChrome")):this.la.zoa?a("powerpoint-ribbon-intl").catch(()=>
{}).then(()=>a("powerpoint-ribbon-mlr-intl")).catch(()=>{}).then(()=>a("appChrome")):a("powerpoint-ribbon-intl").catch(()=>{}).then(()=>a("appChrome")):a("appChrome")}LCj(){void 0!==PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.RenderStartTime&&null!==PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.RenderStartTime&&rg.a.instance.ic("RenderRibbonStart",PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.RenderStartTime);void 0!==PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.AppChromeReadyTime&&null!==
PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.AppChromeReadyTime&&rg.a.instance.ic("AppChromeReadyTime",PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.AppChromeReadyTime);void 0!==PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.ShowTime&&null!==PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.ShowTime&&rg.a.instance.ic("Stage1Ribbon",PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.ShowTime);PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.UnbindPerceivedRibbonInteractive?(PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.UnbindPerceivedRibbonInteractive(),
this.Wce()):this.la.getBooleanFeatureGate("Microsoft.Office.SharedOnline.PRIOnlyAfterInteractivityIsEnabled",!1)&&this.egh();PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.ActiveBlockedCommand&&PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.ActiveCommandHandlerData&&this.k8c.Hoh(PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.ActiveBlockedCommand,PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.ActiveCommandHandlerData);void 0!==PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.SkeletonDismissedTime&&null!==
PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.SkeletonDismissedTime?rg.a.instance.ic("AppInitStatus_ribbonSkeletonDismissed",PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.SkeletonDismissedTime):this.Eog();for(const a of PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.LogMessageCache)4===a.length&&ba.ULS.sendTraceTag(a[0],a[1],a[2],a[3]);PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.LogMessageCache.length=0;this.GUe();Ja.a.get_instance().PJ(5);Ja.a.get_instance().PJ(10);Rd.a("React.SetRibbonBehaviorAttached")&&
Ja.a.get_instance().PJ(6);Wp.a.dispatch("RibbonVisible")}XCj(){rg.a.instance.ic("InitFullRibbon",(new Date).getTime());appChrome.getLazyRibbonInitializationActions().then(a=>{rg.a.instance.ic("RibbonLazyPromiseFulfilled",(new Date).getTime());u.AFrameworkApplication.fa.jf(()=>{this.Kpe.Mdl()?Ja.a.get_instance().Dk(7,()=>{Ba.a.J(512496018,801,50,"Render CopyLink button on Teams session after the full app settings and Chrome ready!");appChrome.api.dispatch(this.fij())}):Ja.a.get_instance().Dk(7,()=>
{appChrome.api.dispatch(appChrome.actions.removePeripheralControl("CopyLink"))})});this.DOa&&a.push.apply(a,this.g6f());if(u.AFrameworkApplication.Aa.hb.a9){const b=[];b.push(document.getElementById("WACDocumentPanel"));a.push(appChrome.actions.setShyState(Object.assign(new qP.a,{shyDismissalRegions:b})))}appChrome.api.dispatch(a);this.GQk();this.Vxc.execute(b=>{if(void 0===this.GP.jaa||null===this.GP.jaa)this.GP.jaa=b;this.Wpf()});this.nOk();this.AHc();this.createFileMenu();this.mHa&&(a=this.mHa.initialize(),
Ba.a.J(512496017,801,50,"Doc Mode Switcher Initialize response: "+a.toString()));this.lWc();Ja.a.get_instance().PJ(7);rg.a.instance.ic("Stage3Ribbon",(new Date).getTime());this.L9&&rg.a.instance.ic("RibbonInteractivePerfMark",window.performance.now());this.e2j();this.LRk();this.YCj();La.a.sI(this.Xte.AF(),"ScrollableRibbon");return null})}e2j(){if(rg.a.instance.n$a)Ba.a.J(512496016,813,15,"Ribbon Perf metrics: Cannot import metrics from PageLoadPerfRecorder since it has been logged and disposed.");
else{var a={};rg.a.instance.Fo("Stage1Ribbon")&&(a.RibbonDisplayed=rg.a.instance.ah("Stage1Ribbon"));rg.a.instance.Fo("Stage3Ribbon")&&(a.RibbonInteractive=rg.a.instance.ah("Stage3Ribbon"));rg.a.instance.Fo("InitRibbon")&&(a.InitRibbon=rg.a.instance.ah("InitRibbon"));rg.a.instance.Fo("InitFullRibbon")&&(a.InitFullRibbon=rg.a.instance.ah("InitFullRibbon"));rg.a.instance.Fo("RibbonLazyPromiseFulfilled")&&(a.RibbonLazyPromiseFulfilled=rg.a.instance.ah("RibbonLazyPromiseFulfilled"));rg.a.instance.Fo("RenderRibbonStart")&&
(a.RenderRibbonStart=rg.a.instance.ah("RenderRibbonStart"));rg.a.instance.Fo("AppChromeReadyTime")&&(a.AppChromeReadyTime=rg.a.instance.ah("AppChromeReadyTime"));rg.a.instance.Fo("AppInitStatus_ribbonSkeletonDismissed")&&(a.RibbonSkeletonDismissed=rg.a.instance.ah("AppInitStatus_ribbonSkeletonDismissed"));Ba.a.J(512496015,809,50,"Ribbon Perf metrics: "+Da.a.toJSON(a))}}n1j(){if(rg.a.instance.n$a)Ba.a.J(512496014,813,15,"Lazy Ribbon Perf metrics: Cannot import metrics from PageLoadPerfRecorder since it has been logged and disposed.");
else{var a={};rg.a.instance.Fo("Stage2Ribbon")&&(a.RibbonEnabled=rg.a.instance.ah("Stage2Ribbon"));rg.a.instance.Fo("Stage4Ribbon")&&(a.RibbonFull=rg.a.instance.ah("Stage4Ribbon"));Ba.a.J(512496013,809,50,"Lazy Ribbon Perf metrics: "+Da.a.toJSON(a))}}YCj(){appChrome.getExtRibbonInitializationActions().then(a=>{appChrome.api.dispatch(a);rg.a.instance.ic("Stage4Ribbon",(new Date).getTime());this.n1j();return null})}rHb(){this.Uxc&&Ja.a.get_instance().isCompleted(7)&&(Te.a.mark(4893),super.rHb(),Te.a.mark(4894),
this.hCg||(rg.a.instance.ic("Stage2RibbonStart",Date.now()),appChrome.api.dispatch(appChrome.actions.setControlBehaviorAttached(!0)),rg.a.instance.ic("Stage2Ribbon",Date.now()),this.hCg=!0))}BH(){this.rHb()}selectRibbonTabById(a){const b=oi.a.n8(Vy.a.hhb,!0);this.la.qT&&b&&Rd.a("RemoveContextualFromActionAiRibbonMode")||this.m3h(a)}get Pnh(){return appChrome.selectors.getSelectedTabId()}GPi(){this.iEb||Ba.a.J(509637252,801,10,"Ribbon top bar1 is set to null");this.iEb.classList.remove(this.zzf)}GMf(){this.iEb||
Ba.a.J(509637251,801,10,"Ribbon top bar1 is set to null");this.iEb.classList.add(this.zzf)}XLi(){appChrome.getHeaderApi().then(a=>a.dismissPlaceholder())}createHeader(){const a=(new Date).getTime();u.AFrameworkApplication.fa.jf(()=>{if(!Rd.a("PPTOHideLegacySharedHeaderBugFix")||!u.AFrameworkApplication.zQ){var b=(new Date).getTime(),c=this.nh.su("createHeader"),h=u.AFrameworkApplication.Aa.hb.WN,m=document.getElementById("HeaderPlaceholder");this.iEb=(new fG(xf.a.xOi,this.Xte)).DRi();this.la.qT&&
"SingleLine".match(appChrome.selectors.getRibbonMode())&&this.GMf();if(h)try{Ba.a.J(512496012,801,50,"Shared Header - Calling RenderSharedHeader");var y=new cG;appChrome.renderSharedHeader(this.iEb,y.Oej()).then(()=>{this.B_j(b,a);m&&this.XLi()})}catch(G){Ba.a.J(512496011,801,10,"Exception while trying to render shared header {0}",G)}else throw Ba.a.J(512496010,801,10,"Invalid request to render legacy Shared Header."),Error.invalidOperation("Invalid request to render legacy Shared Header");u.AFrameworkApplication.zQ||
(y=Or.a.Kce(I.AppFrame.tEa,null,this.iEb,!0),h&&(y.zL=!0,this.bJb(y,H.a.qoc,H.a.poc),y.bindAction(w.KeyInputManager.Na(z.a.J1,0),H.a.mld)));!m&&mB.a.QSf&&PowerPointWebEditor.FakeHeader.RemoveFakeHeader();this.nh.yu(c);this.T7|=1;this.ltc()}})}B_j(a,b){var c=(new Date).getTime();const h={};h.headerCallbackRegistrationTime=b;h.headerCallbackInvokedTime=a;h.headerRenderCompleteTime=c;Ba.a.J(512496009,809,50,"Create Header Perf metrics: "+Da.a.toJSON(h))}bJb(a,b,c){const h=w.KeyInputManager.Na(z.a.Pq,
0),m=w.KeyInputManager.Na(z.a.Pq,4);a.Ap(h);a.Ap(m);a.bindAction(h,b);a.bindAction(m,c)}AHc(){const a=()=>{const b=this.nh.su("createJewel");this.n3a=this.HDj();ip.prototype.AHc.call(this);this.nh.yu(b);this.T7|=2;this.ltc()};this.U5c&&this.keb?this.keb.hyb(a):u.AFrameworkApplication.fa.jf(a)}createFileMenu(){const a=(new Date).getTime(),b=()=>{const c=(new Date).getTime(),h=this.nh.su("createFileMenu"),m=[];if(this.la.ka("DiagnosticsInfoInJewelAboutMenuIsEnabled")){var y=[Object.assign(new kB,{label:CommonUIStrings.L_DiagnosticsSessionId,
value:u.AFrameworkApplication.userSessionId}),Object.assign(new kB,{label:CommonUIStrings.L_DiagnosticsBuild,value:u.AFrameworkApplication.buildVersion})];m.push(appChrome.actions.setFileMenuSessionDetails("AboutTextSection",y))}m.push.apply(m,this.s_f());y=document.createElement("div");document.body.appendChild(y);appChrome.renderFileMenu(y,m);this.A_j(c,a);this.nh.yu(h);this.T7|=22;this.ltc()};this.U5c&&this.keb?this.keb.hyb(b):u.AFrameworkApplication.fa.jf(b)}A_j(a,b){var c=(new Date).getTime();
const h={};h.fileMenuCallbackRegistrationTime=b;h.fileMenuCallbackInvokedTime=a;h.fileMenuRenderCompleteTime=c;Ba.a.J(512496008,809,50,"File Menu Perf metrics: "+Da.a.toJSON(h))}nOk(){const a=()=>{const b=this.nh.su("refreshRibbon");this.Sac||(this.Sac={},hp.BCh(this.Sac),this.C9c.nHh(this.Sac),this.xrg=this.u3i(this.Eqg,this.Sac));const c=new hG.a(this.ABb);appChrome.api.dispatch(c.O3d(this.xrg));this.nh.yu(b);this.T7|=4;this.ltc()};this.U5c&&this.keb?this.keb.hyb(a):u.AFrameworkApplication.fa.jf(a)}u3i(a,
b){const c={};for(let m in b){var h=b[m];const y=m;h!==a[y]&&(c[y]=h,Ba.a.J(512496007,801,50,"TrimedId changed after full settings ready, TrimId:{0} PreviousValue:{1} CurrentValue:{2}",y,a[y],h))}return c}HDj(){const a={};this.C9c.Y6k(a);this.C9c.nHh(a);return new KG(null,a,"jewelPPTEditor")}LRk(){mB.a.t1d&&PowerPointWebEditor.FakeRibbon.RemoveFakeRibbon()}rhh(a){Ja.a.get_instance().Dk(7,()=>{appChrome.api.dispatch(appChrome.actions.removePeripheralControl(a))})}qVk(){const a=this.la.ka("ShareMenuIsEnabled"),
b=a?"ShareTopBar":"Share";u.AFrameworkApplication.otb?this.rhh(b):u.AFrameworkApplication.fa.jf(()=>{const c=this.nh.su("createShareAction"),h=this.Kpe.Idl();h?this.Rel(b):(this.rhh(b),this.la.Jib&&this.Hk.K$(this.Hk.K5,this.Hk.God));a&&(h?this.la.Jib&&Ja.a.get_instance().Dk(7,()=>{this.Hk.L$(this.Hk.K5,this.Hk.God);this.Hk.J$(this.Hk.K5,this.Hk.God)}):Ja.a.get_instance().Dk(7,()=>{appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("ShareMenu",!h))}));this.nh.yu(c);this.T7|=8;this.ltc()})}ltc(){31===
this.T7&&(this.EVa.j1c(2),this.T7=0)}Wce(){this.k8c.jhi();appChrome.api.dispatch(appChrome.actions.setControlBehaviorAttached(!0));Ja.a.get_instance().Dk(7,()=>{this.k8c.Jvl();Dg.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.UnifyPRIToastDismissal")&&this.Uue||appChrome.PRIToastManager.dismissToast()},11)}Eog(){Ja.a.get_instance().PJ(18);Wp.a.dispatch("RibbonVisible")}hXg(){return()=>{this.Gu.MFc(()=>{appChrome.PRIToastManager.dismissToast()})}}GQk(){this.Uue&&
(ip.qld.$("NewDefaultSlide",this.hXg()),ip.qld.$("ChangeLayoutFlyout",this.hXg()))}}Object(n.a)(NG,"ReactRibbonUser",lB,[555,282,106]);class OG{constructor(a,b,c,h,m,y,G){this.MCb=null;this.zb=a;this.eGg=b;this.pa=c;this.hB=h;this.lO=m;this.ia=y;this.Sp=G;this.eGg.ik(Object(F.a)(this,this.dlh,"ribbonChangeTabHandler"))}dispose(){this.eGg.Cm(Object(F.a)(this,this.dlh,"ribbonChangeTabHandler"))}get NF(){return this.MCb}set NF(a){this.MCb!==a&&a&&(this.MCb=a,this.lO.E_?this.lO.E_=!1:this.Sp&&this.lO.PUa&&
this.ia.processAction(D.a.Cja,2))}dlh(a,b){b.node.Sa(X.a.shapeId)&&(a=b.node.eb(X.a.shapeId),this.MCb&&this.MCb.id===b.node.id&&a&&(this.zb.Eb(new He.a(2,1,0,()=>{const c=this.pa.Mgj(this.hB.Pnh,b.node);0<c.length&&this.hB.selectRibbonTabById(c)},90,"10")),this.MCb=null))}}Object(n.a)(OG,"RibbonChangeManager",null,[557]);class PG{constructor(a,b,c){this.J_i=a;this.GE=b;this.etl=c}}Object(n.a)(PG,"GallerySectionData",null,[]);let pB,qB,Wy,rB,cx,sB,tB,uB,vB;class sv{constructor(a,b,c,h,m,y){this.la=
a;this.V7c=b;this.o7c=c;this.BNg=h;this.CBb=m;this.Hk=y}lod(a){this.la.Qhg&&(a["PptRibbon.Home.Drawing.TextBox"]=!0,a["PptRibbon.Home.Drawing.Rectangle"]=!0,a["PptRibbon.Home.Drawing.RoundedRectangle"]=!0,a["PptRibbon.Home.Drawing.Ellipse"]=!0,a["PptRibbon.Home.Drawing.RoundedRectangleCallout"]=!0,a["PptRibbon.Home.Drawing.Star5"]=!0,a["PptRibbon.Home.Drawing.Triangle"]=!0,a["PptRibbon.Home.Drawing.Can"]=!0,a["PptRibbon.Home.Drawing.Cube"]=!0,a["PptRibbon.Home.Drawing.StraightConnector"]=!0,a["PptRibbon.Home.Drawing.StraightConnectorArrow"]=
!0,a["PptRibbon.Home.Drawing.StraightConnectorTwoArrow"]=!0,a["PptRibbon.Home.Drawing.RightArrow"]=!0,a["PptRibbon.Home.Drawing.DownArrow"]=!0,a["PptRibbon.Home.Drawing.LeftArrow"]=!0,a["PptRibbon.Home.Drawing.UpArrow"]=!0,a["PptRibbon.Home.Drawing.UpDownArrow"]=!0,a["PptRibbon.Home.Drawing.LeftRightArrow"]=!0,a["PptRibbon.Home.Drawing.MoreShapes"]=!0,a["PptRibbon.Home.Font.ChangeCase"]=!this.la.jpi,a["PptRibbon.InsertTab.Illustrations.TextBox"]=!0,a["PptRibbon.InsertTab.Illustrations.Rectangle"]=
!0,a["PptRibbon.InsertTab.Illustrations.RoundedRectangle"]=!0,a["PptRibbon.InsertTab.Illustrations.Ellipse"]=!0,a["PptRibbon.InsertTab.Illustrations.RoundedRectangleCallout"]=!0,a["PptRibbon.InsertTab.Illustrations.Star5"]=!0,a["PptRibbon.InsertTab.Illustrations.Triangle"]=!0,a["PptRibbon.InsertTab.Illustrations.Can"]=!0,a["PptRibbon.InsertTab.Illustrations.Cube"]=!0,a["PptRibbon.InsertTab.Illustrations.StraightConnector"]=!0,a["PptRibbon.InsertTab.Illustrations.StraightConnectorArrow"]=!0,a["PptRibbon.InsertTab.Illustrations.StraightConnectorTwoArrow"]=
!0,a["PptRibbon.InsertTab.Illustrations.RightArrow"]=!0,a["PptRibbon.InsertTab.Illustrations.DownArrow"]=!0,a["PptRibbon.InsertTab.Illustrations.LeftArrow"]=!0,a["PptRibbon.InsertTab.Illustrations.UpArrow"]=!0,a["PptRibbon.InsertTab.Illustrations.UpDownArrow"]=!0,a["PptRibbon.InsertTab.Illustrations.LeftRightArrow"]=!0,a["PptRibbon.InsertTab.Illustrations.MoreShapes"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.TextBox"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.Rectangle"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.RoundedRectangle"]=
!0,a["PptRibbon.DrawingFormat.InsertShapes.Ellipse"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.RoundedRectangleCallout"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.Star5"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.Triangle"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.Can"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.Cube"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.StraightConnector"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.StraightConnectorArrow"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.StraightConnectorTwoArrow"]=
!0,a["PptRibbon.DrawingFormat.InsertShapes.RightArrow"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.DownArrow"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.LeftArrow"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.UpArrow"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.UpDownArrow"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.LeftRightArrow"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.MoreShapes"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.Duplicate"]=!0);this.la.Qhg||(a["PptRibbon.Home.Drawing.AllShapes"]=
!0,a["PptRibbon.InsertTab.Illustrations.AllShapes"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.AllShapes"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.TextBoxBig"]=!0);this.la.Pke||(a["PptRibbon.InsertTab.InsertTables"]=!0);a["ContextualTabs.Tables.Design"]=!0;a["ContextualTabs.Tables.Design.TableStyleOptions"]=!0;a.buttonFirstRow=!0;a.buttonFirstColumn=!0;a.buttonLastRow=!0;a.buttonLastColumn=!0;a.buttonBandedRow=!0;a.buttonBandedColumn=!0;a["ContextualTabs.Tables.Design.TableStyles"]=!0;a.buttonTableStyleRibbon0=
!0;a.buttonTableStyleRibbon1=!0;a.buttonTableStyleRibbon2=!0;a.buttonTableStyleRibbon3=!0;a.buttonTableStyleRibbon4=!0;a.buttonTableStyleRibbon5=!0;a.buttonTableStyleRibbon6=!0;a.fsfaMoreTableStyles=!0;a.fsfaTableStyleTheme=!0;a["ContextualTabs.Tables.Design.Shading"]=!0;a.cellShadingColor=!0;a["ContextualTabs.Tables.Design.TableBorderStyle"]=!0;a["ContextualTabs.Tables.Design.DrawBorders"]=!0;a.TableBorders=!0;a.TableBordersPenColor=!0;a.TableBorderPenWeight=!0;a["ContextualTabs.Tables.Layout"]=
!0;a["ContextualTabs.Tables.Layout.Table"]=!0;a.idTableSelect=!0;a.btnSelectTable=!0;a.btnSelectColumn=!0;a.btnSelectRow=!0;a["ContextualTabs.Tables.Layout.RowColumn"]=!0;a.idTableDelete=!0;a.btnTableDelete=!0;a.btnColumnDelete=!0;a.btnRowDelete=!0;a["ContextualTabs.Tables.Layout.MergeSplit"]=!0;a.btnMergeTableCells=!0;a.btnSplitTableCells=!0;a.btnInsertRowAbove=!0;a.btnInsertRowBelow=!0;a.btnInsertColumnLeft=!0;a.btnInsertColumnRight=!0;a.btnDistributeRows=!0;a.btnDistributeColumns=!0;a["ContextualTabs.Tables.Layout.Alignment"]=
!0;a["ContextualTabs.Tables.Layout.Alignment.Controls"]=!0;a.btnTableCellLeftJustify=!0;a.btnTableCellCenterJustify=!0;a.btnTableCellRightJustify=!0;a.btnTableCellTopAnchoring=!0;a.btnTableCellMiddleAnchoring=!0;a.btnTableCellBottomAnchoring=!0;if(this.la.Nke){if(this.la.Oke||this.la.Kzb||this.la.Mke)a["ContextualTabs.Tables.Layout"]=!1;this.la.Mke&&(a["ContextualTabs.Tables.Layout.Alignment"]=!1,a["ContextualTabs.Tables.Layout.Alignment.Controls"]=!1,a.btnTableCellLeftJustify=!1,a.btnTableCellCenterJustify=
!1,a.btnTableCellRightJustify=!1,a.btnTableCellTopAnchoring=!1,a.btnTableCellMiddleAnchoring=!1,a.btnTableCellBottomAnchoring=!1);a["ContextualTabs.Tables.Design"]=!1;this.la.Oke&&(a["ContextualTabs.Tables.Layout.Table"]=!1,a.idTableSelect=!1,a.btnSelectTable=!1,a.btnSelectColumn=!1,a.btnSelectRow=!1);this.la.Kzb&&(a["ContextualTabs.Tables.Layout.RowColumn"]=!1,a.idTableDelete=!1,a.btnTableDelete=!1,a.btnColumnDelete=!1,a.btnRowDelete=!1,a.btnInsertRowAbove=!1,a.btnInsertRowBelow=!1,a.btnInsertColumnLeft=
!1,a.btnInsertColumnRight=!1);a["ContextualTabs.Tables.Design.Shading"]=!1;a.cellShadingColor=!1;a["ContextualTabs.Tables.Design.TableStyleOptions"]=!1;a.buttonFirstRow=!1;a.buttonFirstColumn=!1;a.buttonLastRow=!1;a.buttonLastColumn=!1;a.buttonBandedRow=!1;a.buttonBandedColumn=!1;a["ContextualTabs.Tables.Design.TableStyles"]=!1;a.buttonTableStyleRibbon0=!1;a.buttonTableStyleRibbon1=!1;a.buttonTableStyleRibbon2=!1;a.buttonTableStyleRibbon3=!1;a.buttonTableStyleRibbon4=!1;a.buttonTableStyleRibbon5=
!1;a.buttonTableStyleRibbon6=!1;a.fsfaMoreTableStyles=!1;this.la.X$&&(a["ContextualTabs.Tables.Design.TableBorderStyle"]=!1,a.TableBorders=!1,this.la.UHb&&(a["ContextualTabs.Tables.Design.DrawBorders"]=!1,a.TableBorderPenWeight=!1),this.la.ihb&&(a["ContextualTabs.Tables.Design.DrawBorders"]=!1,a.TableBordersPenColor=!1));this.la.o_c&&(a["ContextualTabs.Tables.Layout.MergeSplit"]=!1,a.btnMergeTableCells=!1);this.la.Rke&&(a["ContextualTabs.Tables.Layout.MergeSplit"]=!1,a.btnSplitTableCells=!1);this.la.Dlc&&
(a.btnDistributeRows=!1,a.btnDistributeColumns=!1)}this.la.powerPointFullTextJustifyIsEnabled||(a["PptRibbon.Home.Paragraph.FullJustify"]=!0);this.la.powerPointSmartLookupIsEnabled||(a["PptRibbon.Review.SmartLookup"]=!0,a["PptRibbon.Review.Show.SmartLookup"]=!0,a["PptRibbon.Review.ShowHide.SmartLookup"]=!0);this.la.powerPointFormatBackgroundEnabled||(a["PptRibbon.Design.Customize.FormatBackgroundAnchor"]=!0);a["PptRibbon.InsertTab.Symbols"]=!u.AFrameworkApplication.fa.ka("InsertSymbolIsEnabled");
this.la.Tig||(a["PptRibbon.Home.Font.Shrink"]=!0,a["PptRibbon.Home.Font.Grow"]=!0);this.la.vQj||(a["PptRibbon.Home.Font.Strikethrough"]=!0);this.la.rhe||(a["PptRibbon.InsertTab.Images.Clipart"]=!0);this.DCh(a,!0,!0,!0);this.CCh(a,!0);this.la.pptInsertOnlineVideoEnabled||(a["PptRibbon.InsertTab.Media.OnlineVideo"]=!0);this.la.pptInsertOnlineVideoEnabled||(a["PptRibbon.InsertTab.Media"]=!0);this.la.Aah||(a["PptRibbon.AudioPlayback"]=!0);this.la.SHb||(a["PptRibbon.AudioFormat"]=!0);if(u.AFrameworkApplication.nsa||
!this.la.pptEditInsertAppsForOfficeEnabled||this.la.C9b)a["PptRibbon.InsertTab.AppForOffice"]=!0;this.la.Byb||(a["PptRibbon.View.Zoom"]=!0);this.la.PNj||(a["PptRibbon.Home.Paragraph.LineSpacing"]=!0);this.la.ceg||(a["ContextualTabs.Tables.Layout.Properties"]=!0,a["PptRibbon.PictureFormat.Properties"]=!0,a["PptRibbon.DrawingFormat.Properties"]=!0,a["PptRibbon.SmartArt.Properties"]=!0,a["PptRibbon.AudioFormat.Properties"]=!0);var b=[];this.la.LLa&&(b=this.la.LLa.split(","));for(const c of b){const h=
c.trim().substring(0,1).toUpperCase()+c.trim().substring(1,c.length);a["Transition"+h]=!0}Array.contains(b,"Wipe")&&Array.contains(b,"Shape")&&Array.contains(b,"Split")&&Array.contains(b,"RandomBars")&&(a.TransitionMore=!0);this.la.XPd||(a.AnimationMore=!0);this.la.JUj?a["PptRibbon.Transition.AllSlides"]=!0:a["PptRibbon.Transition.Timing"]=!0;this.la.powerPointEnableAccCheck||(a["PptRibbon.Review"]=!0);this.la.wg&&(a["PptRibbon.View.PresentationViews"]=!0);this.BNg?a["PptRibbon.Home.Clipboard.Paste"]=
!0:a["PptRibbon.Home.Clipboard.NewPaste"]=!0;this.la.Uhg?a["PptRibbon.Design.OldThemes"]=!0:a["PptRibbon.Design.Themes"]=!0;a["PptRibbon.View.ShowHide.CommentsSplitButton"]=!0;this.la.pptEditorConsistencyCheckIsEnabled||(a["PptRibbon.Review.Proofing.EditorPane"]=!0);this.la.proofingSettingIsEnabled||(a["PptRibbon.Review.Proofing.GrammarOptions"]=!0);this.la.pptHideProofingErrorIsEnabled||(a["PptRibbon.Review.Proofing.HideProofingErrors"]=!0);this.la.pje||(a["PptRibbon.Review.Activity"]=!0);a["PptRibbon.Review.Proofing.EditorPane"]?
a["PptRibbon.Review.Proofing.GrammarOptions"]?a["PptRibbon.Review.Proofing"]=!0:a["PptRibbon.Review.Proofing.ProofingSplitButton"]=!0:a["PptRibbon.Review.Proofing.ProofingSplitButtonFallback"]=!0;(b=u.AFrameworkApplication.fa.ka("HelpTabIsEnabled")&&!u.AFrameworkApplication.WMb&&!u.AFrameworkApplication.nsa)||(a["PptRibbon.Help"]=!0);a.btnContactSupport=!(b&&u.AFrameworkApplication.fa.ka("HelpTabContactSupportIsEnabled"));a.btnShowTraining=!(b&&u.AFrameworkApplication.fa.ka("HelpTabShowTrainingIsEnabled"));
a.btnWhatsNew=!(b&&u.AFrameworkApplication.fa.ka("HelpTabWhatsNewIsEnabled"));a.btnFeedbackPane=!0;this.la.N$a&&this.la.AWc&&this.la.AWc.length||(a.InsertIconDialog=!0);a["PptRibbon.View.Subtitles.UseSubtitles"]=!0;a["PptRibbon.View.Subtitles.SubtitleSettings"]=!0;a["PptRibbon.View.Subtitles.SubtitlesPositionTopOverlay"]=!0;a["PptRibbon.View.Subtitles.SubtitlesPositionBottomOverlay"]=!0;a["PptRibbon.View.Subtitles.SubtitlesPositionBelowSlide"]=!0;a["PptRibbon.View.Subtitles.SubtitlesPositionAboveSlide"]=
!0;a["PptRibbon.View.Subtitles.PopulateTranscriptionSpokenLanguage"]=!0;a["PptRibbon.View.Subtitles.PopulateTranscriptionSubtitleLanguage"]=!0;a.AlwaysUseSubtitles=!0;a.UseSubtitles=!0;a["PptRibbon.View.Coach"]=!0;a["PptRibbon.View.Coach.RehearseWithCoach"]=!0;a["PptRibbon.View.Coach.RehearseWithCoachSplit"]=!0;a["PptRibbon.View.Coach.RehearseWithCoachTopBar"]=!0;a["PptRibbon.View.Coach.Menu.Vision"]=!0;a["PptRibbon.View.Coach.Menu.FeedbackSettings"]=!0;a["PptRibbon.View.Coach.Menu"]=!0;a["PptRibbon.View.StartSlideShow.PresentLive"]=
!0;a.PresentLive=!0;a.PresentLiveConsumer=!0;a.PresentLiveEnterprise=!0;a.PresentLiveTopBar=!0;u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.CacheDictateVisibility",!1)||(a["PptRibbon.Home.Dictation"]=!0,a.btnStartDictation=!0);this.CBb&&(a["PptRibbon.Review.Comments.Markers"]=!0);u.AFrameworkApplication.fa.ka("OcpsIsEnabled")&&(a.TellMeControl=!0);a["PptRibbon.Review.Translate"]=!this.la.o$g;a["PptRibbon.Review.Activity.ShowVersionHistory"]=!this.la.nDk;a["PptRibbon.Graphics.ShapeStyles.FlyChangeGraphic"]=
!this.la.yJa;a["PptRibbon.Graphics.ContextMenu.FlyChangeGraphic"]=!this.la.yJa;a["PptRibbon.Pictures.ContextMenu.FlyChangePicture"]=!this.la.yJa;a["PptRibbon.PictureFormat.Adjust.FlyChangePicture"]=!this.la.yJa;a["PptRibbon.PictureFormat.Adjust.ChangePicture"]=this.la.yJa;a.FixIt=!this.la.oPc}x$k(a){if(!u.AFrameworkApplication.fa.ka("HelpTabIsEnabled")||u.AFrameworkApplication.WMb||u.AFrameworkApplication.nsa)a.Help=!0;a.Draw=!this.la.wg}Hlj(){const a=new Qa.a;if(this.la.LLa){var b=this.la.LLa.split(",");
for(const c of b)b=c.trim(),"MenuSection"===b.substring(0,11)&&a.add(new PG("TransitionMore","Transition"+b,!0))}return a.toArray()}Y6k(a){a["PptJewel.Menu"]=!0;u.AFrameworkApplication.fa.ka("WheresSaveButtonBrsIsEnabled")||(a["PptJewel.SaveACopy.WheresTheSaveButton"]=!0);this.la.printingEnabled||(a["PptJewel.Print"]=!0,a["PptJewel.SaveACopy"]=!0,a["PptJewel.DownloadAs"]=!0,a["PptJewel.SaveACopy.SaveACopy"]=!0,a["PptJewel.SaveACopy.SaveAsToHost"]=!0,a["PptJewel.SaveACopy.SaveToSharePoint"]=!0,a["PptJewel.DownloadAs.DownloadACopy"]=
!0,a["PptJewel.DownloadAs.DownloadACopyAsPdf"]=!0,a["PptJewel.DownloadAs.DownloadAsImages"]=!0,a["PptJewel.DownloadAs.DownloadACopyAsOdp"]=!0);a["PptJewel.Print.PrintToPdf"]=!0;this.V7c&&this.V7c.s0g||(a["PptJewel.About.TryOffice"]=!0);this.o7c&&this.o7c.yth||(a["PptJewel.About.TryMacOffice"]=!0);u.AFrameworkApplication.fa.ka("DocumentNameInJewelInfoMenuIsEnabled")&&u.AFrameworkApplication.xu.Uw||(a.lblBreadcrumbDocName=!0);u.AFrameworkApplication.fa.ka("HelpTabIsEnabled")&&!u.AFrameworkApplication.WMb&&
(a["PptJewel.Help"]=!0)}nHh(a){delete a["PptJewel.Menu"];const b=u.AFrameworkApplication.fa.Ha(u.AFrameworkApplication.YJ);if(b&&"teams"===b.toLowerCase()){a["PptJewel.Share"]=!0;a["PptJewel.Share.Embed"]=!0;var c=u.AFrameworkApplication.fa.ka("SaveACopyIsEnabledForUiHost");const h=u.AFrameworkApplication.fa.ka("UiHostSupportsDocRebootFeatures");c&&h||(a["PptJewel.SaveACopy.SaveACopy"]=!0,a["PptJewel.SaveACopy.SaveAsToHost"]=!0,a["PptJewel.SaveACopy.SaveToSharePoint"]=!0)}u.AFrameworkApplication.Iwa||
(a["PptJewel.New"]=!0);u.AFrameworkApplication.ANe||(a["PptJewel.Open"]=!0);u.AFrameworkApplication.OE||(a["PptJewel.Help.GiveFeedback"]=!0,a.btnFeedback=!0,a.btnFeedbackPane=!0);u.AFrameworkApplication.ECh&&(a["PptJewel.Info.OpenInClient"]=!0,a.btnOpenInClient=!0);u.AFrameworkApplication.RZa||(a["PptJewel.Share.ReplyWithChanges"]=!0);u.AFrameworkApplication.U1d||u.AFrameworkApplication.y3e||(a["PptJewel.Info.FileVersion"]=!0);u.AFrameworkApplication.Czb?(a["PptJewel.Info.FileVersion"]=!0,u.AFrameworkApplication.fk("Microsoft.Office.PPT.Server.Flighting.PPTOneDriveConsumerSharedVersionHistoryIsEnabled"),
ba.ULS.sendTraceTag(512262734,832,15,"PPT external version history menu item for OneDriveConsummer trimmed.")):u.AFrameworkApplication.K_c()?this.la.dAk?(a["PptJewel.Info.VersionHistory"]=!0,ba.ULS.sendTraceTag(512262732,832,15,"PPT shared version history menu item trimmed for internet explorer.")):u.AFrameworkApplication.fa.ka("DisableAnonymousUserCheckForBlueChickenForVH")?u.AFrameworkApplication.fa.ka("IsAnonymousUserCheckSupportedForVH")&&u.AFrameworkApplication.fa.ka("IsAnonymousUser")&&(a["PptJewel.Info.VersionHistory"]=
!0,ba.ULS.sendTraceTag(512262731,832,15,"PPT shared version history menu item due to anonymous user.")):u.AFrameworkApplication.fa.ka("IsAnonymousUser")&&(a["PptJewel.Info.VersionHistory"]=!0,ba.ULS.sendTraceTag(512262730,832,15,"PPT shared version history menu item due to anonymous user.")):(a["PptJewel.Info.VersionHistory"]=!0,ba.ULS.sendTraceTag(512262733,832,15,"PPT shared version history menu item trimmed."));a["PptJewel.Info.OpenInClient"]&&a["PptJewel.Info.FileVersion"]&&a["PptJewel.Info.VersionHistory"]&&
(a["PptJewel.Info"]=!0);u.AFrameworkApplication.RRa||(a["PptJewel.Share.ShareWithPeople"]=!0);if(u.AFrameworkApplication.yR||!u.AFrameworkApplication.w3e&&!u.AFrameworkApplication.yxb&&!u.AFrameworkApplication.K1d)a["PptJewel.Share.Embed"]=!0;a["PptJewel.Share.ShareWithPeople"]&&a["PptJewel.Share.Embed"]&&a["PptJewel.Share.ReplyWithChanges"]&&(a["PptJewel.Share"]=!0);u.AFrameworkApplication.$sl&&(a["PptJewel.SaveACopy"]=!0,a["PptJewel.DownloadAs"]=!0,a["PptJewel.SaveACopy.SaveACopy"]=!0,a["PptJewel.SaveACopy.SaveAsToHost"]=
!0,a["PptJewel.SaveACopy.SaveToSharePoint"]=!0,a["PptJewel.DownloadAs.DownloadACopy"]=!0,a["PptJewel.DownloadAs.DownloadACopyAsPdf"]=!0,a["PptJewel.DownloadAs.DownloadAsImages"]=!0,a["PptJewel.DownloadAs.DownloadACopyAsOdp"]=!0);u.AFrameworkApplication.fa.ka("DisablePrint")&&(a["PptJewel.Print"]=!0,a["PptJewel.SaveACopy"]=!0,a["PptJewel.DownloadAs"]=!0,a["PptJewel.SaveACopy.SaveACopy"]=!0,a["PptJewel.SaveACopy.SaveAsToHost"]=!0,a["PptJewel.SaveACopy.SaveToSharePoint"]=!0,a["PptJewel.DownloadAs.DownloadACopy"]=
!0,a["PptJewel.DownloadAs.DownloadACopyAsPdf"]=!0,a["PptJewel.DownloadAs.DownloadAsImages"]=!0,a["PptJewel.DownloadAs.DownloadACopyAsOdp"]=!0);u.AFrameworkApplication.yR&&(a["PptJewel.Print"]=!0,a["PptJewel.Share"]=!0);u.AFrameworkApplication.fa.ka("SaveACopyBrsIsEnabled")||(a["PptJewel.SaveACopy.SaveACopy"]=!0);u.AFrameworkApplication.fa.ka("SaveAsToHostBrsIsEnabled")&&u.AFrameworkApplication.fa.ka("UserCanWriteRelative")&&u.AFrameworkApplication.fa.ka("SupportsEditing")||(a["PptJewel.SaveACopy.SaveAsToHost"]=
!0);u.AFrameworkApplication.fa.ka("SaveToAnotherFolderBrsIsEnabled")&&u.AFrameworkApplication.fa.ka("SupportsGetMoreInfoForPersonalStorage")||(a["PptJewel.SaveACopy.SaveToSharePoint"]=!0);a["PptJewel.SaveACopy.SaveAsToHost"]&&a["PptJewel.SaveACopy.SaveACopy"]&&a["PptJewel.SaveACopy.SaveToSharePoint"]&&(a["PptJewel.SaveACopy"]=!0);this.la.AQj||(a["PptJewel.DownloadAs.DownloadACopyAsPdf"]=!0);this.la.ajg&&this.la.wg||(a["PptJewel.DownloadAs.DownloadAsImages"]=!0);if(!u.AFrameworkApplication.fa.ka("153")||
".odp"===u.AFrameworkApplication.fa.appSettings["152"].toLowerCase()||u.AFrameworkApplication.yR)a["PptJewel.DownloadAs.DownloadACopyAsOdp"]=!0;u.AFrameworkApplication.fa.ka("RenameDialogIsEnabled")&&u.AFrameworkApplication.Q9b()&&!u.AFrameworkApplication.yR||(a["PptJewel.Rename"]=!0);u.AFrameworkApplication.Unc||(a["PptJewel.Help.ReportAbuse"]=!0);c=!u.AFrameworkApplication.Lbd||!u.AFrameworkApplication.fa.ka("1072");u.AFrameworkApplication.cIb||!c||u.AFrameworkApplication.dsc||this.V7c&&this.V7c.s0g||
this.o7c&&this.o7c.yth||u.AFrameworkApplication.fa.ka("DiagnosticsInfoInJewelAboutMenuIsEnabled")||(a["PptJewel.About"]=!0);u.AFrameworkApplication.cIb||(a["PptJewel.About.Privacy"]=!0);a["PptJewel.About.TrustCenter"]=c;u.AFrameworkApplication.dsc||(a["PptJewel.About.TermsOfUse"]=!0);u.AFrameworkApplication.fa.ka("DiagnosticsInfoInJewelAboutMenuIsEnabled")||(a["PptJewel.About.DiagnosticsSection"]=!0);u.AFrameworkApplication.tda||(a["PptJewel.SecondaryMenu"]=!0);c=!u.AFrameworkApplication.fa.ka("248");
a["PptRibbon.Design.Designer.New"]=c;a["PptRibbon.Design.ShowHide.Designer.New"]=c;a["PptRibbon.Home.Designer"]=c;(a["PptRibbon.Home.ShowHide.Designer"]=c)&&this.Hk&&this.Hk.K$(this.Hk.K5,this.Hk.VYd);c=!u.AFrameworkApplication.fa.ka("822");a["PptRibbon.Review.SmartLookup"]=c;a["PptRibbon.Review.Show.SmartLookup"]=c;(c=(a["PptRibbon.Review.ShowHide.SmartLookup"]=c)||!sv.ERj())||ba.ULS.sendTraceTag(512262729,1303,15,"ReuseSlides is not trimmed");a["PptRibbon.Home.Slides.InvokeFilesSerplet"]=c;a["PptRibbon.InsertTab.InvokeFilesSerplet"]=
c;ba.ULS.sendTraceTag(512262728,352,50,"IsInsertOnlinePictureFromHostSupported: {0}; InsertOnlinePictureFromHostEnabled: {1}; HostSupportsInsertOnlinePictureFromHost: {2}; IsSkyDrive: {3}; AppSupportsInsertOnlinePictureFromHost: {4}; AppSupportsInsertOnlinePictureFromSharePoint: {5}",u.AFrameworkApplication.k9b(),u.AFrameworkApplication.insertOnlinePictureFromHostEnabled,u.AFrameworkApplication.BVc,u.AFrameworkApplication.Czb,u.AFrameworkApplication.FGc,u.AFrameworkApplication.nYb);u.AFrameworkApplication.fa.ka("671")&&
this.DCh(a,this.la.pptInsertOnlinePictureEnabled,u.AFrameworkApplication.k9b(),this.la.N$a);this.CCh(a,this.la.HWc);u.AFrameworkApplication.fa.ka("670")&&(c=!u.AFrameworkApplication.fa.ka("124"),a["PptRibbon.InsertTab.Media.OnlineVideo"]=c,a["PptRibbon.InsertTab.Media"]=!!c);a["PptRibbon.Review.Proofing.EditorPane"]=!u.AFrameworkApplication.fa.ka("809");a["PptRibbon.Review.Proofing.GrammarOptions"]=!u.AFrameworkApplication.fa.ka("299");a["PptRibbon.Review.Proofing.HideProofingErrors"]=!u.AFrameworkApplication.fa.ka("619");
a["PptRibbon.Review.Proofing.EditorPane"]?a["PptRibbon.Review.Proofing.GrammarOptions"]?(a["PptRibbon.Review.Proofing"]=!0,a["PptRibbon.Review.Proofing.ProofingSplitButtonFallback"]=!0,a["PptRibbon.Review.Proofing.ProofingSplitButton"]=!0):(a["PptRibbon.Review.Proofing"]=!1,a["PptRibbon.Review.Proofing.ProofingSplitButton"]=!0,a["PptRibbon.Review.Proofing.ProofingSplitButtonFallback"]=!1):(a["PptRibbon.Review.Proofing"]=!1,a["PptRibbon.Review.Proofing.ProofingSplitButtonFallback"]=!0,a["PptRibbon.Review.Proofing.ProofingSplitButton"]=
!1);c=u.AFrameworkApplication.fa.ka("LiveSubtitlesEnabled");this.la.Pka&&c&&(a["PptRibbon.View.Subtitles.UseSubtitles"]=!1,Rd.a("ReactMLRSubtitleSettingsTeamsFix")||(a["PptRibbon.View.Subtitles.SubtitleSettings"]=!1),a["PptRibbon.View.Subtitles.SubtitlesPositionTopOverlay"]=!1,a["PptRibbon.View.Subtitles.SubtitlesPositionBottomOverlay"]=!1,a["PptRibbon.View.Subtitles.PopulateTranscriptionSpokenLanguage"]=!1,a["PptRibbon.View.Subtitles.PopulateTranscriptionSubtitleLanguage"]=!1,a["PptRibbon.View.Subtitles.SubtitlesPositionBelowSlide"]=
!1,a["PptRibbon.View.Subtitles.SubtitlesPositionAboveSlide"]=!1);this.la.w$b&&this.la.pjg&&(a["PptRibbon.View.Coach"]=!1,a["PptRibbon.View.Coach.RehearseWithCoachTopBar"]=!1,this.la.pptRehearsalVisionEnabled||this.la.THb?(a["PptRibbon.View.Coach.Menu"]=!1,a["PptRibbon.View.Coach.RehearseWithCoachSplit"]=!1,this.la.pptRehearsalVisionEnabled&&(a["PptRibbon.View.Coach.Menu.Vision"]=!1),this.la.THb&&(a["PptRibbon.View.Coach.Menu.FeedbackSettings"]=!1)):a["PptRibbon.View.Coach.RehearseWithCoach"]=!1);
this.la.HUj&&this.la.Pka&&c&&(!b||"teams"!==b.toLowerCase())&&(a.AlwaysUseSubtitles=!1,a.UseSubtitles=!1,Rd.a("ReactMLRSubtitleSettingsTeamsFix")&&(a["PptRibbon.View.Subtitles.SubtitleSettings"]=!1));this.la.powerPointLiveBroadcastEnabled&&(a["PptRibbon.View.StartSlideShow.PresentLive"]=!1,a.PresentLive=!1,a.PresentLiveTopBar=!1);u.AFrameworkApplication.fa.ka("WacLabelingPoliciesIsEnabled")&&u.AFrameworkApplication.fa.ka("WacApplyManualPolicyLabelIsEnabled")&&this.la.pptLabelingGetPolicyLabelsIsEnabled&&
this.la.pptApplyManualPolicyLabelIsEnabled&&u.AFrameworkApplication.fa.ka("SupportsPolicies")||(a["PptRibbon.Home.Sensitivity"]=!0,a.flySensitivity=!0,this.Hk&&this.Hk.K$(this.Hk.K5,this.Hk.soh));this.la.dictationIsEnabled&&v.a.Nyh&&u.AFrameworkApplication.fa.ka("UserCanUseDictation")?(a["PptRibbon.Home.Dictation"]=!1,a.btnStartDictation=!1):this.Hk&&this.Hk.K$(this.Hk.K5,this.Hk.dMf);a["PptJewel.Open"]&&a["PptJewel.New"]&&(a["PptJewel.Home"]=!0);a["PptJewel.SaveACopy.SaveAsToHost"]&&a["PptJewel.SaveACopy.SaveACopy"]&&
a["PptJewel.SaveACopy.SaveToSharePoint"]&&a["PptJewel.Rename"]&&a["PptJewel.DownloadAs.DownloadACopy"]&&a["PptJewel.DownloadAs.DownloadACopyAsPdf"]&&a["PptJewel.DownloadAs.DownloadACopyAsOdp"]&&a["PptJewel.DownloadAs.DownloadAsImages"]?a["PptJewel.SaveACopy"]=!0:a["PptJewel.SaveACopy"]&&delete a["PptJewel.SaveACopy"];a["PptRibbon.Review.Translate"]=!this.la.o$g;a.FixIt=!this.la.oPc;u.AFrameworkApplication.fa.aw("IsPresentToTeamsSupportedHost")&&!u.AFrameworkApplication.fa.ka("IsPresentToTeamsSupportedHost")?
(a.PresentToTeams=!0,a.PresentToTeamsTopBar=!0):b&&"sharepointcom"!==b&&(a.PresentToTeams=!0,a.PresentToTeamsTopBar=!0);u.AFrameworkApplication.fa.ka("IsAnonymousUser")&&(a.CatchUpWithChanges=!0);hp.eBl(sv.jyj,a);if(u.AFrameworkApplication.nsa||!this.la.pptEditInsertAppsForOfficeEnabled||this.la.C9b)a["PptJewel.Addin"]=!0}DCh(a,b,c,h){a["PptRibbon.InsertTab.Images.FlyPicture"]=!1;a["PptRibbon.InsertTab.Images.FlyPicture.FromHost"]=!c;a["PptRibbon.InsertTab.Images.FlyPicture.FromSearch"]=!b;a["PptRibbon.InsertTab.Images.FlyPicture.FromM365Picture"]=
!h;a["PptRibbon.Graphics.ShapeStyles.FlyChangeGraphic.FromDevice"]=!1;a["PptRibbon.Graphics.ShapeStyles.FlyChangeGraphic.FromHost"]=!c;a["PptRibbon.Graphics.ShapeStyles.FlyChangeGraphic.FromSearch"]=!b;a["PptRibbon.Graphics.ShapeStyles.FlyChangeGraphic.FromM365Picture"]=!h;a["PptRibbon.Graphics.ShapeStyles.FlyChangeGraphic.FromM365Icon"]=!h;a["PptRibbon.PictureFormat.Adjust.FlyChangePicture.FromDevice"]=!1;a["PptRibbon.PictureFormat.Adjust.FlyChangePicture.FromHost"]=!c;a["PptRibbon.PictureFormat.Adjust.FlyChangePicture.FromSearch"]=
!b;a["PptRibbon.PictureFormat.Adjust.FlyChangePicture.FromM365Picture"]=!h;a["PptRibbon.PictureFormat.Adjust.FlyChangePicture.FromM365Icon"]=!h;a["PptRibbon.Pictures.ContextMenu.FlyChangePicture.FromDevice"]=!1;a["PptRibbon.Pictures.ContextMenu.FlyChangePicture.FromHost"]=!c;a["PptRibbon.Pictures.ContextMenu.FlyChangePicture.FromSearch"]=!b;a["PptRibbon.Pictures.ContextMenu.FlyChangePicture.FromM365Picture"]=!h;a["PptRibbon.Pictures.ContextMenu.FlyChangePicture.FromM365Icon"]=!h}CCh(a,b){a.InsertPictureFromMobileDevice=
!b;a.ChangePictureFromMobileDevice=!b}static ERj(){const a=u.AFrameworkApplication.fa.Ha("SovereignEnvironmentName"),b=u.AFrameworkApplication.fa.ka("IsTellMeUpSellEnterpriseEnabled");var c=u.AFrameworkApplication.fa.Ha(u.AFrameworkApplication.YJ);c=!!c&&"teams"===c.toLowerCase();return(!a||!a.length)&&b&&!c}}sv.jyj={["ellipsisOpenInApp"]:(vB=new Qa.a,vB.add("HostOpenInClient"),vB),["ellipsisOpenInBrowser"]:(uB=new Qa.a,uB.add("HostOpenInBrowser"),uB),["ellipsisDownload"]:(tB=new Qa.a,tB.add("HostDownload"),
tB),["conversation"]:(sB=new Qa.a,sB.add("HostConversation"),sB),["close"]:(cx=new Qa.a,cx.add("HostClose"),cx.add("btnjClose"),cx.add("msJewelSecondary"),cx),["copyLink"]:(rB=new Qa.a,rB.add("CopyLink"),rB),["share"]:(Wy=new Qa.a,Wy.add("jbtnFileSharing"),Wy.add("btnFileSharing"),Wy),["docChat"]:(qB=new Qa.a,qB.add("DocChat"),qB),["openInApp"]:(pB=new Qa.a,pB.add("btnOpenInClient"),pB)};Object(n.a)(sv,"RibbonCommandTrimmer",null,[582]);class wB{constructor(){this.mHa=this.hl=this.K=null}get name(){return"PowerPointWebEditor.Ribbon"}$b(a){this.K=
a;a.register(UA,"PowerPointWebEditor.Ribbon.PPTWebEditReactCommandDefinitionMapping").as("Common.IExternalUICommandDefinitionMapping").ma().oa(()=>new UA(a.resolve("PowerPointWebEditor.IApplicationSettings")));a.register(553,"PowerPointWebEditor.Ribbon.IPPTChromeExtensionHelper").ma().oa(()=>new VF(new RA(u.AFrameworkApplication.fa)));let b=this.K.resolve("PowerPointWebEditor.IApplicationSettings").dzb;v.a.Uj&&(b=b&&!this.K.resolve("PowerPointWebEditor.Ribbon.IPPTChromeExtensionHelper").tya);var c=
this.K.resolve("PowerPointWebEditor.IFileInfo").Pia;let h=2===c||3===c||0===c;c=1===c;const m=a.resolve("PowerPointWebEditor.IApplicationSettings").Jib?a.resolve("PowerPointWebEditor.IPPTRumTracker"):null;h=h&&!c;a.register(sv,"PowerPointWebEditor.Ribbon.RibbonCommandTrimmer").ma().oa(()=>new sv(a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("Common.IOfficeTrialExperience"),a.resolve("Common.IMacOfficeOffer"),b,h,m));a.register(554,"PowerPointWebEditor.IModeSwitcherControlActor").ma().oa(()=>
new OF(a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.Application.IReadOnlyManager"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),a.resolve("Box4.IAppFrame"),Ja.a.get_instance(),m));a.register(555,"PowerPointWebEditor.IRibbonUser").ma().oa(()=>{const y=a.resolve("PowerPointWebEditor.IApplicationSettings"),G=a.resolve("PowerPointWebEditor.Ribbon.RibbonCommandTrimmer");var U={};G.lod(U);var ja={};G.x$k(ja);U=
new KF(U,G.Hlj(),ja);ja=new NF;const va=a.resolve("Common.IAppSettingsManager"),Ta=new NG(a.resolve("PowerPointWebEditor.AppFrame"),a.resolve("PowerPointWebEditor.IRibbonPane").xa,a.resolve("PowerPoint.IPathManager"),a.Ja("Box4.IGeneralCuiUser"),a.resolve("Common.IFocusManager"),a.resolve("Common.IActionManagerExtended"),a.resolve("Common.IExternalUICommandDefinitionMapping"),a.rb("PowerPointWebEditor.Core.IBundleMetricRecorder"),G,U,y,a.resolve("PowerPointWebEditor.IModeSwitcherControlActor"),ja,
m,va.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.InvokeFullAppSettingsCallbackImmediately",!1),Object(za.a)(108,va)?va:null,va.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",!1),u.AFrameworkApplication.nHb,a.resolve("PowerPointWebEditor.IPresentationResourcesManager"));y.UKf?this.K.resolve("PowerPointWebEditor.IAppBootCompletedListener").gyb(()=>{Ta.hcg()}):Ta.hcg();return Ta});a.register(556,"Common.IRibbonExternal").ma().oa(()=>a.resolve("PowerPointWebEditor.IRibbonUser").BZk);
a.register(557,"PowerPointWebEditor.IRibbonChangeManager").ma().oa(()=>new OG(a.resolve("Common.ITaskManager"),a.resolve("Box4.Graph.IGraphInstance").Ad(10),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.IRibbonUser"),a.resolve("PowerPointWebEditor.ViewCore.IFormatPainterContext"),a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.IApplicationSettings").pptTextFormatPainterIsEnabled));a.register(TA,"PowerPointWebEditor.BusinessBarController").as("PowerPointWebEditor.IBusinessBarController").as("Box4.IBusinessBarController").ma().oa(()=>
new TA(a.resolve("CommonUI.IBusinessBar"),new LF,a.resolve("PowerPointWebEditor.AppFrame"),a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.IErrorMapping"),u.AFrameworkApplication.fa,a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IApplicationSettings")));a.register(558,"PowerPointWebEditor.IBusinessBarPane").ma().oa(()=>new QF(a.Ja("CommonUI.IBusinessBar"),a.resolve("PowerPointWebEditor.IApplicationSettings").Zmc));a.register(mq,"CommonUI.BusinessBar").as("CommonUI.IBusinessBar").ma().oa(()=>
new mq(a.resolve("PowerPointWebEditor.IBusinessBarPane").wFl));a.register(559,"Common.IRibbonSQMInformation").ma().oa(()=>{const y=new WF(u.AFrameworkApplication.Ta);y.vQk();return y});a.register(560,"PowerPointWebEditor.IInkRibbonManager").ma().oa(()=>{const y=a.resolve("PowerPointWebEditor.IApplicationSettings");return new oq(a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.View.IViewEventHandlers"),a.resolve("PowerPointWebEditor.IActiveSlideViewManager"),u.AFrameworkApplication.Aa.hb.a9,
y)})}init(){this.mHa=this.K.resolve("PowerPointWebEditor.IModeSwitcherControlActor");this.K.resolve("PowerPointWebEditor.BusinessBarController").vzk();this.hl=this.K.resolve("PowerPointWebEditor.IBusinessBarController");this.hl.initialize();u.AFrameworkApplication.fa.ka("EarlyInitRibbonUser")?(this.K.resolve("PowerPointWebEditor.IRibbonUser"),this.K.resolve("Common.IRibbonExternal")):this.K.Ja("PowerPointWebEditor.IRibbonUser").execute(()=>{this.K.resolve("Common.IRibbonExternal")});const a=this.K.resolve("PowerPointWebEditor.IBusinessBarPane"),
b=this.K.resolve("PowerPointWebEditor.IPaneManager");var c=document.getElementById("WACDocumentAndTaskPanel");this.K.resolve("PowerPointWebEditor.IApplicationSettings").jnc?(c=document.getElementById("BusinessBarRegion"),b.iPa(a,c,null)):c?b.iPa(a,this.K.resolve("PowerPointWebEditor.AppFrame").N1,c):b.OP(a);this.K.resolve("CommonUI.IBusinessBar");this.K.resolve("PowerPointWebEditor.IInkRibbonManager")}dispose(){this.hl&&this.hl.dispose();this.mHa&&this.mHa.dispose()}static main(){r.a.instance.Dc(new wB)}}
Object(n.a)(wB,"PPTWebEditorRibbonPackage",null,[2,3]);var dx=d(666);class QG{get name(){return"Box4.Insights"}init(){}dispose(){}$b(a){a.register(dx.a,"Box4.Insights.Box4InsightsSelection").as("Common.App.Insights.IInsightsSelection").as("Box4.Insights.IBox4InsightsSelection").ma().oa(()=>new dx.a)}}Object(n.a)(QG,"Box4InsightsPackage",null,[2,3]);class xB{constructor(a,b){this.xFd=0;this.Dha=new Qa.a;this.Ca=a;this.ld=b}get Wc(){return this.ld}get cce(){return 0<this.xFd}N$(a){this.Whg(a)&&this.xFd++;
this.cce?this.Wc.enabled=!1:this.Dha.add(this.Wc.Vp(a.actionId))}M$(a){!this.cce&&0<this.Dha.count&&(this.Dha.ga(this.Dha.count-1),this.uPf(this.Dha.count-1));this.Whg(a)&&this.xFd--;this.cce||(this.Wc.enabled=!0)}uPf(a){if(0<this.Dha.count&&0<=a&&a<this.Dha.count){const b=this.Dha.ga(a);this.Dha.removeAt(a);b.end()}}kti(){let a=this.Dha.count-1;for(;0<=a;){var b=this.Dha.ga(a);(b=this.Ca.$S(b.activityName))&&b.flags[128]&&this.uPf(a);a--}}Whg(a){if(2!==a.behavior)return!0;a=this.Ca.$S(a.actionId);
return!!a&&a.flags[32]}}Object(n.a)(xB,"ActivityActionListener",null,[141]);var Xy;(function(a){a[a.timeOut=0]="timeOut";a[a.appClose=1]="appClose";a[a.appError=2]="appError"})(Xy||(Xy={}));Object(n.b)("ActivityAutoEndReason",Xy);class yB{constructor(a){this.Xha=new vi.a;this.vPb=a}$fi(){for(let a of this.Xha.keys)this.agi(a)}BVf(a){if(this.vPb.dHc)for(let b of this.Xha.keys){const c=Array.clone(this.Xha.ga(b));for(let h=0;h<c.length;h++){const m=c[h];m.d3d();this.gfh(b,a,m.uniqueID)}}}agi(a){var b=
this.Xha.ga(a);b=this.Zaj(b);for(let c=0;c<b.length;c++){const h=b[c];h.d3d();this.gfh(a,0,h.uniqueID)}}Zaj(a){const b=[];for(let c=0;c<a.length;c++){const h=a[c];(new Date).getTime()-h.startTime>h.MXg&&Array.add(b,h)}return b}gfh(a,b,c){const h={};h.AID=c;h.A=a;h.AE=Xy[b];ec.a.instance.Wb("AutoEnded",h)}oal(){if(this.vPb.dHc){var a=new He.a(2,2,this.vPb.bgi,Object(F.a)(this,this.$fi,"autoEndLongRunningActivities"),67);u.AFrameworkApplication.we.Eb(a)}}register(a){if(this.vPb.dHc){var b=a.activityName;
this.Xha.Hb(b)&&this.Xha.ga(b)||this.Xha.$(b,[]);Array.add(this.Xha.ga(b),a)}}unregister(a){if(this.vPb.dHc){var b=a.activityName;this.Xha.Hb(b)&&this.Xha.ga(b)&&Array.remove(this.Xha.ga(b),a)}}}Object(n.a)(yB,"ActivityAutoEndHelper",null,[623]);class Ut{constructor(a){this.u5e=null;this.Zzc=0;this.rzd=this.tG=!1;this.HLd=0;this.Ox=new Jb.a;this.pvb=new Jb.a;this.OLh=a}get MMd(){return this.u5e||(this.u5e=this.OLh())}get properties(){return this.Ox}get MXg(){return this.Zzc}get enabled(){return this.tG}get ended(){return this.rzd}get uniqueID(){return this.HLd}jXg(){const a=
{};a.ID=this.uniqueID;a.A=this.activityName;a.ST=this.startTime;a.ET=this.endTime;Sa.Ct(this.properties.keys)&&(a.P=Ut.i3f(this.properties));Sa.Ct(this.pvb.keys)&&(a.FP=Ut.i3f(this.pvb));return a}static i3f(a){const b={};for(let c of a)b[c.key]=c.value;return b}}Object(n.a)(Ut,"AActivity",null,[650,651]);class zB extends Ut{constructor(a,b,c,h,m,y,G,U){super(G);this.At=0;this.QLh=a;this.iQh=b;this.Fga=c;this.Jj=(new Date).getTime();this.UVh=h;this.zvd=y;this.Zzc=m;this.zvd.register(this);this.HLd=
U()}get activityName(){return this.Fga}get startTime(){return this.Jj}get endTime(){return this.At}DPf(a){this.At=(new Date).getTime();this.ended?this.dNk():(this.rzd=!0,this.At=(new Date).getTime(),this.At<this.Jj&&(ba.ULS.sendTraceTag(8184544,213,50,String.format("EndTime ({0}) is less than StartTime ({1}) for Activity ({2}).",this.At,this.Jj,this.Fga)),this.At=this.Jj),this.zvd.unregister(this),this.UVh&&(!a&&this.MMd&&this.MMd.enabled?this.Cqb():this.L_b()))}end(){this.DPf(!1)}d3d(){this.DPf(!0)}dNk(){const a=
{};a.AN=this.activityName;a.AT=(new Date).getTime();a.AID=this.uniqueID;this.iQh("AlreadyEnded",this.endTime,a)}Cqb(){this.MMd.Cqb()}L_b(){this.QLh(this.jXg())}cancel(){this.ended||(this.rzd=!0,this.zvd.unregister(this))}}Object(n.a)(zB,"ActivityImpl",Ut,[]);class RG extends Sys.EventArgs{constructor(){super();this.name=this.properties=null}}Object(n.a)(RG,"ActivityRecordedEventArgs",Sys.EventArgs,[]);class Vt{constructor(a,b,c){this.Oa=new bd.a;this.tG=!0;this.settings=a;this.Avd=b;this.Evd=c}get enabled(){return this.tG&&
this.settings.enabled}set enabled(a){this.tG=a}Vp(a,b=-1){-1===b&&(b=this.settings.KIi);return this.Avd(Object(F.a)(this,this.L_b,"completeActivity"),Object(F.a)(this,this.hfh,"recordEventInternal"),a,this.SGj(a.toString()),b)}Wb(a,b=null){this.hfh(a,(new Date).getTime(),b);this.Oa.raiseEvent("HHR",Object.assign(new RG,{name:a,properties:b}))}hfh(a,b,c){this.Vfg(a)&&(a=this.d4f(a,c,b),ba.ULS.sendTraceTag(6068304,213,100,a))}Hna(a,b=null){this.Vfg(a.toString())&&(a=this.d4f(a.toString(),b,(new Date).getTime()),
ba.ULS.sendTraceTag(6415520,213,100,a))}SGj(a){return this.enabled&&!this.TGj(a)}Vfg(a){return this.enabled&&!this.bLj(a)}TGj(a){return this.settings.NLi.contains(a)}bLj(a){return this.settings.OLi.contains(a)}L_b(a){if(this.Evd.WAf(a.A.toString())){var b=[];Array.add(b,a);a=dd.c(b);ba.ULS.sendTraceTag(5894867,213,100,a)}}d4f(a,b,c){const h={};h.ID=Vt.J3d();h.V=a;h.VT=c;b&&(h.P=b);a=[];Array.add(a,h);return dd.c(a)}static J3d(){return Vt.U1h++}}Vt.U1h=0;Object(n.a)(Vt,"ActivityManagerImpl",null,[612]);
class Qo{constructor(){this.tG=!1;this.t8e=this.d6e=0;this.c6e=!1;this.Z8e=new Mn.a;this.$8e=new Mn.a}$2b(a){this.tG=Boolean.parse(a[Qo.WKj]||"false");this.Z8e=this.P8g(a[Qo.MLi]);this.$8e=this.P8g(a[Qo.PLi]);this.qTi(a)}get enabled(){return this.tG}get NLi(){return this.Z8e}get OLi(){return this.$8e}qTi(a){this.c6e=Boolean.parse(a[Qo.SHj]||"false");this.d6e=parseInt(a[Qo.cgi]||"60000");this.t8e=parseInt(a[Qo.LIi]||"5000")}get bgi(){return this.d6e}get KIi(){return this.t8e}get dHc(){return this.c6e}P8g(a){const b=
new Mn.a;for(const c of(a||"").split(","))""!==c&&b.add(c);return b}}Qo.WKj="ActivityLoggingIsEnabled";Qo.MLi="DisabledClientActivityNames";Qo.PLi="DisabledClientActivityEventNames";Qo.SHj="ActivityAutoEndEnabled";Qo.cgi="ActivityAutoEndTaskInterval";Qo.LIi="ActivityDefaultMaxDuration";Object(n.a)(Qo,"ActivitySettings",null,[622]);class tv{constructor(a){this.Oyd=new Mn.a;this.BVb=new Jb.a;this.TDc=a;this.pal()}pal(){this.TDc.enabled&&(tv.Inf=new He.a(2,2,this.TDc.interval,Object(F.a)(this,this.bNi,
"doThrottle"),65),u.AFrameworkApplication.we.Eb(tv.Inf))}bNi(){this.WXk()}WXk(){this.BVb=new Jb.a;this.Oyd=new Mn.a}UGj(a){return this.Oyd.contains(a)}otl(a){if(this.BVb.Hb(a)){if(this.BVb.ga(a)>=this.TDc.Wfk)return this.Oyd.add(a),ba.ULS.sendTraceTag(7696902,213,50,"Activity {0} will be throttled due to too much logging.",a),!1;let b;(b=this.BVb).$(a,b.ga(a)+1)}else this.BVb.add(a,1);return!0}WAf(a){return this.TDc.enabled?!this.UGj(a)&&this.otl(a):!0}}tv.Inf=null;Object(n.a)(tv,"ActivityThrottler",
null,[621]);class Rr{constructor(){this.tG=!1;this.fcf=this.mgf=0}$2b(a){this.tG=Boolean.parse(a[Rr.K_d]||"false");this.mgf=parseInt(a[Rr.Xfk]||"600");this.fcf=parseInt(a[Rr.KFj]||"600000")}get enabled(){return this.tG}get Wfk(){return this.mgf}get interval(){return this.fcf}}Rr.K_d="ActivityThrottlerEnabled";Rr.Xfk="ActivityThrottlerMaxActivities";Rr.KFj="ActivityThrottlerInterval";Object(n.a)(Rr,"ActivityThrottlerSettings",null,[617]);class AB{constructor(){this.Da=null}get name(){return"Common.App.Activities"}init(){this.qCj()}qCj(){const a=
this.Da.resolve("Common.App.Activities.IActivitySettings"),b=u.AFrameworkApplication.fa.appSettings;a.$2b(b);this.Da.resolve("Common.App.Activities.IActivityThrottlerSettings").$2b(b);if(a.enabled){ec.a.instance=new Vt(this.Da.resolve("Common.App.Activities.IActivitySettings"),(m,y,G,U,ja)=>new zB(m,y,G,U,ja,this.Da.resolve("Common.App.Activities.IActivityAutoEndHelper"),()=>this.Da.rb("Common.App.Activities.IActivityAggregationManager"),Vt.J3d),this.Da.resolve("Common.App.Activities.IActivityThrottler"));
var c=this.Da.resolve("Common.App.Activities.ActivityAutoEndHelper"),h=this.Da.resolve("Common.App.Activities.ActivityActionListener");c.oal();u.AFrameworkApplication.cga(()=>{h.kti();c.BVf(1)});u.AFrameworkApplication.Ta.Lna(h);u.AFrameworkApplication.FFc((m,y)=>{ec.a.instance.Hna(y.errorCode,{["ErrorCause"]:y.w0d,["ErrorResolution"]:y.x0d});c.BVf(2)})}}dispose(){}$b(a){this.Da=a;a.register(Qo,"Common.App.Activities.ActivitySettings").as("Common.App.Activities.IActivitySettings").ma();a.register(yB,
"Common.App.Activities.ActivityAutoEndHelper").as("Common.App.Activities.IActivityAutoEndHelper").ma().oa(()=>new yB(a.resolve("Common.App.Activities.IActivitySettings")));a.register(xB,"Common.App.Activities.ActivityActionListener").oa(()=>new xB(u.AFrameworkApplication.Ta,a.resolve("Common.IActivityManager")));a.register(Rr,"Common.App.Activities.ActivityThrottlerSettings").as("Common.App.Activities.IActivityThrottlerSettings").ma().oa(()=>new Rr);a.register(tv,"Common.App.Activities.ActivityThrottler").as("Common.App.Activities.IActivityThrottler").ma().oa(()=>
new tv(a.resolve("Common.App.Activities.IActivityThrottlerSettings")))}static main(){r.a.instance.Dc(new AB)}}Object(n.a)(AB,"ActivitiesPackage",null,[2,3]);class SG{constructor(){this.opa=new Jb.a}WSe(a,b){this.opa.$(a,b)}S3d(a){({value:a}=this.opa.Uf(a));return a}}Object(n.a)(SG,"AggregationMethodsForActivityName",null,[]);class BB{constructor(){this.CBc=new vi.a;this.opa=new vi.a}WSe(a,b,c){this.opa.Hb(a)&&this.opa.ga(a)||this.opa.$(a,new SG);this.opa.ga(a).WSe(b,c)}S3d(a,b){return this.opa.Hb(a)&&
this.opa.ga(a)?this.opa.ga(a).S3d(b):null}k5b(a){this.CBc.Hb(a)&&this.CBc.ga(a)||this.CBc.$(a,new Mn.a);return this.CBc.ga(a)}jIi(a,b){this.k5b(a).add(b)}}Object(n.a)(BB,"ActivityAggregationInfo",null,[616]);class ex extends Ut{constructor(a,b){super(a);this.HLd=(this.PLh=b)?b.K8i():Vt.J3d()}get cia(){return this.PLh}get activityName(){return this.cia.name}get startTime(){return this.cia.startTime}get endTime(){return this.cia.endTime}end(){}cancel(){}d3d(){}xyl(){this.pvb.$("AM",this.cia.mode.toString());
this.pvb.$("C",this.cia.count.toString());this.pvb.$("DA",this.cia.jOf.toFixed(2));this.pvb.$("DV",this.cia.jOi.toFixed(2))}U7d(a){return this.cia.U7d(a)}t8d(){return this.cia.t8d()}Cqb(){for(let a of this.cia.dia)a.Cqb()}}Object(n.a)(ex,"AggregatedActivity",Ut,[]);class TG{constructor(a,b){this.Svd=0;this.Fga=a;this.Cza=b}Ybi(a,b){this.Svd=b;for(b=0;b<a.count;b++){const c=a.ga(b);this.Zbi(c)}}Zbi(a){const b=Object(ua.a)(ex,a);if(b)if(1===this.Svd)this.Vbi(b);else if(2===this.Svd){this.$bi(b);for(let c of this.Cza.k5b(this.Fga)){const h=
b.cia.dia.ga(0);h.properties.Hb(c)&&a.properties.$(c,h.properties.ga(c))}}}Vbi(a){for(let b of this.Cza.k5b(this.Fga))this.Olh(a,b)}$bi(a){for(let b of a.t8d())this.Olh(a,b)}Olh(a,b){const c=this.Cza.S3d(this.Fga,b);if(c){const h=a.U7d(b);a.properties.$(b,c(h))}}}Object(n.a)(TG,"PropertyAggregationHelper",null,[]);class CB{constructor(a,b,c,h,m){this.imb=a;this.Cza=b;this.M7e=m;this.Evd=h;this.yUh=c}get Lpf(){return this.yUh.value}L_b(a){if(Object(za.a)(zB,a))a.L_b();else if(Object(za.a)(ex,a)&&this.Evd.WAf(a.activityName.toString())){a=
Object(ua.a)(ex,a);a.xyl();a=a.jXg();var b=[];Array.add(b,a);a=dd.c(b);ba.ULS.sendTraceTag(6907266,213,50,a)}}aYb(a,b){const c=(new Date).getTime();var h=this.M7e.list.ga(a);const m=({aci:h}=this.C1i(h)).returnValue;this.M7e.list.$(a,new Qa.a);b&&(h=this.oAi(h,c,this.imb.k7f));0<h.count&&(new TG(a,this.Cza)).Ybi(h,m)}oAi(a,b,c){const h=new Qa.a;for(let m=0;m<a.count;m++){const y=a.ga(m);y.startTime>b-c?y.Cqb():h.add(y)}return h}C1i(a){const b=this.Lpf.kBh(a);a=this.Lpf.iql(a);const c=this.bci(b,a);
return{returnValue:c,aci:1===c?b:a}}bci(a,b){return a.count*this.imb.TYg<b.count?1:2}get enabled(){return this.imb.enabled}Cqb(){}}Object(n.a)(CB,"ActivityAggregationManager",null,[615]);class ro{constructor(a){this.enabled=!1;this.TXg=500;this.zYg=2;this.ird=6E4;this.TYg=5;this.k7f=3E4;this.$2b(a.appSettings)}$2b(a){this.enabled=Boolean.parse(a[ro.K_d]||"false");this.TXg=parseInt(a[ro.lgk]||"500");this.zYg=parseInt(a[ro.xhk]||"2");this.ird=parseInt(a[ro.wol]||"60000");this.TYg=parseInt(a[ro.Lhk]||
"5");this.k7f=parseInt(a[ro.hoj]||"30000")}}ro.K_d="ActivityAggregationEnabled";ro.lgk="ActivityAggregationMaxInterval";ro.xhk="ActivityAggregationMinChain";ro.wol="ActivityAggregationTaskInterval";ro.Lhk="ActivityAggregationModeFactor";ro.hoj="ActivityAggregationGraceWindow";Object(n.a)(ro,"ActivityAggregationParams",null,[]);class DB{constructor(a,b){this.Cza=a;this.v5e=b}kBh(a,b=1){if(!a||!a.count)return a;const c=new Qa.a;var h=null;for(let m=0;m<a.count;m++){const y=a.ga(m);if(!y)continue;const G=
y.activityName;h?h.OVj(y)?h.add(y):(h=h.process(),c.addRange(h),h=this.v5e(G,b),h.add(y)):(h=this.v5e(G,b),h.add(y))}h&&(a=h.process(),c.addRange(a));return c}iql(a){if(!a||!a.count)return a;const b={};var c=null;for(let m=0;m<a.count;m++){const y=a.ga(m);if(y){if(!c){c=new Qa.a;var h=this.Cza.k5b(y.activityName);for(let G of h)c.add(G)}h=this.Nej(y,c);null!==h&&(h in b&&b[h]||(b[h]=new Qa.a),b[h].add(y))}}a=new Qa.a;for(const m of Da.a.fL(b))c=this.kBh(b[m],2),a.addRange(c);return a}Nej(a,b){let c=
"";for(let h of b)c+=h,c=a.properties.Hb(h)&&void 0!==a.properties.ga(h)&&null!==a.properties.ga(h)?c+a.properties.ga(h):c+"null";return c}}Object(n.a)(DB,"ActivityAggregationSchemes",null,[614]);class UG{constructor(a,b,c,h,m){this.At=this.Jj=0;this.imb=c;this.Avd=h;this.Cza=m;this.name=a;this.Jy=b;this.dia=new Qa.a}get mode(){return this.Jy}get count(){return this.dia.count}get startTime(){return this.Jj}get endTime(){return this.At}get jOf(){if(!this.count)return 0;let a=0;for(let b of this.dia)a+=
b.endTime-b.startTime;return a/this.count}get jOi(){if(!this.count)return 0;let a=0;const b=this.jOf;for(let c of this.dia){const h=c.endTime-c.startTime;a+=(h-b)*(h-b)}return a/this.count}add(a){this.count?this.At=a.endTime>this.endTime?a.endTime:this.endTime:(this.Jj=a.startTime,this.At=a.endTime);this.dia.add(a)}OVj(a){return 0>=this.count?!1:a.startTime-this.endTime<=this.imb.TXg}process(){if(this.count>=this.imb.zYg){const a=new Qa.a,b=this.Avd(this);a.add(b);return a}return this.dia}U7d(a){const b=
new Qa.a;for(let c of this.dia)if(c.properties.Hb(a)){const h=c.properties.ga(a);b.add(h)}else b.add(null);return b}t8d(){const a=this.Cza.k5b(this.name),b=new Mn.a;for(let c of this.I1i())a.contains(c)||b.add(c);return b}I1i(){const a=new Mn.a;if(!this.dia)return a;for(let b of this.dia)for(let c of b.properties.keys)a.add(c);return a}K8i(){return this.dia.ga(0).uniqueID}}Object(n.a)(UG,"ActivityCollection",null,[613]);class EB{constructor(){this.a2a=new vi.a}get list(){return this.a2a}add(a){const b=
a.activityName;if(this.a2a.Hb(b)&&this.a2a.ga(b)){const c=this.e$i(this.a2a.ga(b),a);this.a2a.ga(b).insert(c,a)}else this.a2a.$(b,new Qa.a),this.a2a.ga(b).add(a)}e$i(a,b){for(let c=a.count-1;0<=c;c--)if(b.startTime>a.ga(c).startTime)return c+1;return 0}}Object(n.a)(EB,"CompletedActivitiesHelper",null,[611]);class FB{constructor(){this.Da=null}get name(){return"Common.App.ActivityAggregator"}init(){u.AFrameworkApplication.cga(()=>{this.Da.resolve("Common.App.ActivityAggregator.ActivityAggregationManager")})}dispose(){}$b(a){this.Da=
a;const b=h=>new ex(()=>a.rb("Common.App.Activities.IActivityAggregationManager"),h),c=(h,m)=>new UG(h,m,a.resolve("Common.App.ActivityAggregator.ActivityAggregationParams"),b,a.resolve("Common.IActivityAggregationInfo"));a.register(CB,"Common.App.ActivityAggregator.ActivityAggregationManager").as("Common.App.Activities.IActivityAggregationManager").ma().oa(()=>new CB(a.resolve("Common.App.ActivityAggregator.ActivityAggregationParams"),a.resolve("Common.IActivityAggregationInfo"),a.re("Common.App.ActivityAggregator.IActivityAggregationSchemes"),
a.resolve("Common.App.Activities.IActivityThrottler"),a.resolve("Common.App.ActivityAggregator.CompletedActivitiesHelper")));a.register(ro,"Common.App.ActivityAggregator.ActivityAggregationParams").ma().oa(()=>new ro(u.AFrameworkApplication.fa));a.register(BB,"Common.App.ActivityAggregator.ActivityAggregationInfo").as("Common.IActivityAggregationInfo").ma().oa(()=>new BB);a.register(DB,"Common.App.ActivityAggregator.ActivityAggregationSchemes").as("Common.App.ActivityAggregator.IActivityAggregationSchemes").ma().oa(()=>
new DB(a.resolve("Common.IActivityAggregationInfo"),c));a.register(EB,"Common.App.ActivityAggregator.CompletedActivitiesHelper").ma().oa(()=>new EB)}static main(){r.a.instance.Dc(new FB)}}Object(n.a)(FB,"ActivityAggregatorPackage",null,[2,3]);var VG=d(15);class Wq{constructor(){this.LZk="getAddinShortcutsPreference";this.MZk="saveAddinShortcutsPreference";this.NZk="{0}RoamingServiceHandler.ashx?action={1}&{2}";this.v1i=6E4;this.ycd=this.V7=this.LY=null}G3f(a){return String.format(this.NZk,u.AFrameworkApplication.fa.appSettings.RoamingServiceHandlerWebServiceBase||
"",a,u.AFrameworkApplication.jh)}executeRequest(a,b,c,h,m=null){return Wq.hca.vqb(a,b,m,null,2,c,h,!1,null,this.v1i)}saveSetting(a,b,c,h,m){return this.Tmh(a,b,c,null,h,m)}startBatchUpdateScope(){this.ycd=[]}saveShortcutInfoArrayBatch(a,b,c){this.C0k(c,a,b)}C0k(a,b,c){const h={action:"",addinId:"",ownerType:0};h.timestamp=(new Date).toUTCString();const m=this.getShortcutInfoArray(b.toString(),c.toString());a?(h.shortcutInfoArray=a,this.$Md(b,c,a)):m&&(h.shortcutInfoArray=m);a={};a[b.toString()]=h;
b=new VG.a(c.toString(),a);this.ycd.push(b)}commitBatchUpdateScope(){return this.wqc()?this.E0k().then(()=>{this.Vrb();return Promise.resolve(!0)}):this.G0k().then(()=>{this.Vrb();return Promise.resolve(!0)})}E0k(){return this.getSetting().then(a=>{let b=null;if(a&&!({kv:b}=dd.d(a)).returnValue)return ba.ULS.sendTraceTag(522739852,0,10,"SaveSettingToLocalStorageBatch failed due to failed to deserialize the settings"),Promise.resolve(!1);b||(b={});for(const c of this.ycd){(a=b[c.key])||(a={});const h=
c.value;for(const m of Da.a.fL(h))a[m]=h[m];b[c.key]=a}this.LY=b;try{return localStorage.setItem("AddinShortcutPreferenceData",dd.c(b)),Promise.resolve(!0)}catch(c){return ba.ULS.sendTraceTag(522739853,0,10,"SaveSettingToLocalStorageBatch failed",c),Promise.resolve(!1)}})}G0k(){return this.G3k().then(a=>this.Uld(a))}G3k(){return this.z8d().then(a=>{let b=null;a&&(({kv:b}=dd.d(a)).returnValue||ba.ULS.sendTraceTag(522739854,0,10,"SerializeNewSettingWithSavedRoamingSettingsBatch failed due to failed to deserialize the settings"));
b||(b={});for(const c of this.ycd){(a=b[c.key])||(a={});const h=c.value;for(const m of Da.a.fL(h))a[m]=h[m];b[c.key]=a}this.LY=b;return dd.c(b)})}saveShortcutInfoArray(a,b,c){return this.Tmh(0,"","",c,a,b)}Tmh(a,b,c,h,m,y){const G=this.wqc(),U={};U.action=c;U.addinId=b;U.ownerType=a;U.timestamp=(new Date).toUTCString();b=this.getShortcutInfoArray(m.toString(),y.toString());0===a&&h?(U.shortcutInfoArray=h,this.$Md(m,y,h)):b&&(U.shortcutInfoArray=b);a={};a[m.toString()]=U;m=new VG.a(y.toString(),a);
return G?this.D0k(m):this.F0k(m)}D0k(a){return this.getSetting().then(b=>{let c=null;if(b&&!({kv:c}=dd.d(b)).returnValue)return ba.ULS.sendTraceTag(522739855,0,10,"SaveSettingToLocalStorage failed due to failed to deserialize the settings"),Promise.resolve(!1);c||(c={});c[a.key]=a.value;this.LY=c;try{return localStorage.setItem("AddinShortcutPreferenceData",dd.c(c)),Promise.resolve(!0)}catch(h){return ba.ULS.sendTraceTag(522739856,0,10,"SaveSettingToLocalStorage failed",h),Promise.resolve(!1)}})}F0k(a){return this.F3k(a).then(b=>
this.Uld(b))}F3k(a){return this.z8d().then(b=>{let c=null;b&&(({kv:c}=dd.d(b)).returnValue||ba.ULS.sendTraceTag(522739857,0,10,"SerializeNewSettingWithSavedRoamingSettings failed due to failed to deserialize the settings"));c||(c={});c[a.key]=a.value;this.LY=c;return dd.c(c)})}saveSettings(a){this.LY=dd.a(a);this.Vrb();return this.wqc()?this.Umh(a):this.Uld(a)}Umh(a){try{return localStorage.setItem("AddinShortcutPreferenceData",a),Promise.resolve(!0)}catch(b){return ba.ULS.sendTraceTag(522739858,
0,10,"SaveSettingToLocalStorage failed",b),Promise.resolve(!1)}}Uld(a){const b={};b.Wac=a;const c=dd.c(b);return new Promise(h=>{try{if(void 0===c||null===c||!c.length||1E6<=c.length)h(!1);else{var m=this.executeRequest(this.G3f(this.MZk),2,"SaveAddinShortcutsPreferenceRequest","38",c);m.continueWith(()=>{if(m.Sn||m.rm)ba.ULS.sendTraceTag(522739859,0,10,"SaveAddinShortcutsPreference: Request failure"),h(!1);else{var y=m.result;void 0!==y.Xi&&null!==y.Xi&&void 0!==y.Xi.data&&null!==y.Xi.data&&y.Xi.data.Te===
Xp.a.Ey?h(!0):h(!1)}})}}catch(y){ba.ULS.sendTraceTag(522739860,0,10,"SaveAddinShortcutPerferrenceSettings: Exception = {0}",y.toString()),h(!1)}})}getSetting(){const a=this.wqc();return this.LY?Promise.resolve(dd.c(this.LY)):a?this.xhj():this.z8d()}wqc(){const a=u.AFrameworkApplication.fa.ka("IsAnonymousUser"),b=u.AFrameworkApplication.fa.ka("IsRoamingServiceEnabled");return a||!b}xhj(){try{const a=localStorage.getItem("AddinShortcutPreferenceData");return Promise.resolve(a)}catch(a){return ba.ULS.sendTraceTag(522739861,
0,10,"GetSettingFromLocalStorage failed",a),Promise.resolve("")}}z8d(){return new Promise((a,b)=>{try{const c=this.executeRequest(this.G3f(this.LZk),1,"GetSettingRequest","37");c.continueWith(()=>{if(c.Sn||c.rm)ba.ULS.sendTraceTag(522739862,0,10,"GetSettingFromRoaming : Request failure");else{let m="";var h=c.result;h&&h.Xi&&h.Xi.data?h.Xi.data.Te!==Xp.a.Ey?ba.ULS.sendTraceTag(522739864,0,10,"GetSettingFromRoaming : Received error response {0}",h.Xi.data.Te):h.Xi.data.Zd?(h=dd.a(h.Xi.data.Zd),h.Wac&&
(m=h.Wac)):ba.ULS.sendTraceTag(522739865,0,10,"GetSettingFromRoaming : ResponseData is null"):ba.ULS.sendTraceTag(522739863,0,10,"GetSettingFromRoaming : Data is null");a(m)}})}catch(c){ba.ULS.sendTraceTag(522739866,0,10,"GetSettingFromRoaming Exception handling request {0}",c.toString()),b("GetSettingFromRoaming Request Exception")}})}clearSettingByAddinId(a){const b=this.wqc(),c=this;return this.getSetting().then(h=>{let m=null;h&&(m=dd.a(h));if(!m)return ba.ULS.sendTraceTag(522739867,0,50,"savedRoamingSetting is empty and nothing to clear "),
Promise.resolve(!0);for(const y of Da.a.fL(m)){h=m[y.toString()];for(const G of Da.a.fL(h)){const U=h[G];if(U.addinId===a)delete h[G.toString()];else if(0===U.ownerType&&U.shortcutInfoArray){const ja=U.shortcutInfoArray,va=new Qa.a;for(let Ta=0;Ta<ja.length;++Ta)ja[Ta].addinId!==a&&va.add(ja[Ta]);U.shortcutInfoArray=va.toArray()}}Da.a.count(h)||delete h[y]}c.LY=m;c.FRk(a);return b?c.Umh(dd.c(m)):c.Uld(dd.c(m))})}Vrb(){if(this.LY){this.V7=null;const c=this.LY;for(let h in c){var a=h;const m=c[h];for(let y in m){var b=
y;const G=m[y];G.shortcutInfoArray&&this.$Md(parseInt(b),parseInt(a),G.shortcutInfoArray)}}}}loadShortcutsPreferenceMappingTable(){return this.getSetting().then(a=>{let b=null;if(a&&!({kv:b}=dd.d(a)).returnValue)return ba.ULS.sendTraceTag(522739868,0,10,"LoadShortcutsPreferenceMappingTable is failed since savedRoamingSetting cannot be deserialized"),Promise.resolve(!1);this.LY=b;this.Vrb();return Promise.resolve(!0)})}getShortcutsPreferenceInfoByAddinId(a,b,c){return this.LY&&(c=this.LY[c])&&(b=c[b])&&
b.addinId===a?b:null}getShortcutInfoArray(a,b){return this.LY&&(b=this.LY[b])&&(a=b[a])&&a.shortcutInfoArray?a.shortcutInfoArray:null}setShortcutInfoWithinBatchUpdateScope(a,b,c){this.saveShortcutInfoArrayBatch(parseInt(a),parseInt(b),c)}setShortcutInfoArray(a,b,c){return this.saveShortcutInfoArray(parseInt(a),parseInt(b),c).then(()=>{this.Vrb();return Promise.resolve(!0)})}removeActionFromShortcutInfoArray(a,b){if(!this.V7)return Promise.resolve(!0);var c=this.V7[a];if(!c)return Promise.resolve(!0);
var h=c[b];c=h.modifiers;h=h.keyCode;const m=this.getShortcutInfoArray(c.toString(),h.toString());if(!m||!m.length)return Promise.resolve(!0);let y=0;for(const G of m){if(G.addinId===a&&G.action===b)break;++y}if(y>=m.length)return Promise.resolve(!0);m.splice(y,1);return this.saveShortcutInfoArray(c,h,m).then(()=>{this.Vrb();return Promise.resolve(!0)})}$Md(a,b,c){this.V7||(this.V7={});for(const h of c){c=h.addinId;const m=h.action;let y=this.V7[c];y||(y={});const G={};G.modifiers=a;G.keyCode=b;y[m]=
G;this.V7[c]=y}}FRk(a){a in this.V7&&delete this.V7[a]}isActionCustomized(a,b){return this.V7&&(a=this.V7[a])&&a[b]?!!a[b]:!1}getShortcutByCustomizedAction(a,b){return this.V7&&(a=this.V7[a])?a[b]:null}getShortcutsPreferenceMappingTable(){return this.LY}static instance(){Wq.COd||(ba.ULS.sendTraceTag(522739851,0,50,"AddinShortcutsPreferenceSettingHelper"),Wq.COd=new Wq,Wq.hca=u.AFrameworkApplication.Je);return Wq.COd}}Wq.COd=null;Wq.hca=null;Object(n.a)(Wq,"AddinShortcutsPreferenceSettingHelper",null,
[]);class WG{constructor(){this.WinOrientation=this.DocElemClientHeight=this.DocElemClientWidth=this.DocElemOffsetHeight=this.DocElemOffsetWidth=this.ScreenAvailWidth=this.ScreenAvailHeight=this.ScreenLogicalYdpi=this.ScreenLogicalXdpi=this.ScreenDeviceYdpi=this.ScreenDeviceXdpi=this.CalculatedDevicePixelRatio=this.WinDevicePixelRatio=this.WinOuterWidth=this.WinOuterHeight=this.WinInnerHeight=this.WinInnerWidth=this.ScreenHeight=this.ScreenWidth=0;this.SupportsTouch=!1;this.Error=this.NavLanguage=
this.NavAppVersion=this.NavAppName=this.NavPlatform=this.NavUserAgent=this.NavPlugins=null}}Object(n.a)(WG,"BrowserInfo",null,[]);class XG{constructor(){this.Version=this.Name=null}}Object(n.a)(XG,"PluginInfo",null,[]);class Xj{static e1j(){if(u.AFrameworkApplication.fa.ka("LogBrowserInfoIsEnabled")){var a=Xj.M_i();try{const b=JSON.stringify(a);ba.ULS.sendTraceTag(6903563,102,50,b)}catch(b){ba.ULS.sendTraceTag(6903564,102,15,b.message)}}else ba.ULS.sendTraceTag(6903562,102,50,"Detailed browser info logging is turned off")}static cej(){const a=
window.navigator.plugins;if(!a||!a.length)return null;const b=[];for(let c=0;c<a.length;c++){const h=a[c].name,m=a[c].version;Array.add(b,Object.assign(new XG,{Name:h,Version:m}))}return b}static M_i(){const a=new WG,b=new Sys.StringBuilder;Xj.QA(c=>{a.DocElemClientHeight=c},()=>document.documentElement.clientHeight,b);Xj.QA(c=>{a.DocElemClientWidth=c},()=>document.documentElement.clientWidth,b);Xj.QA(c=>{a.DocElemOffsetHeight=c},()=>document.documentElement.offsetHeight,b);Xj.QA(c=>{a.DocElemOffsetWidth=
c},()=>document.documentElement.offsetWidth,b);Xj.QA(c=>{a.ScreenAvailHeight=c},()=>window.screen.availHeight,b);Xj.QA(c=>{a.ScreenAvailWidth=c},()=>window.screen.availWidth,b);Xj.QA(c=>{a.ScreenWidth=c},()=>window.screen.width,b);Xj.QA(c=>{a.ScreenHeight=c},()=>window.screen.height,b);Xj.QA(c=>{a.ScreenLogicalXdpi=c},()=>window.screen.logicalXDPI,b);Xj.QA(c=>{a.ScreenLogicalYdpi=c},()=>window.screen.logicalYDPI,b);Xj.QA(c=>{a.ScreenDeviceXdpi=c},()=>window.screen.deviceXDPI,b);Xj.QA(c=>{a.ScreenDeviceYdpi=
c},()=>window.screen.deviceYDPI,b);Xj.QA(c=>{a.WinInnerHeight=c},()=>window.self.innerHeight,b);Xj.QA(c=>{a.WinInnerWidth=c},()=>window.self.innerWidth,b);Xj.QA(c=>{a.WinOuterHeight=c},()=>window.self.outerHeight,b);Xj.QA(c=>{a.WinOuterWidth=c},()=>window.self.outerWidth,b);Xj.QA(c=>{a.WinOrientation=c},()=>window.self.orientation,b);Xj.QA(c=>{a.WinDevicePixelRatio=c},()=>window.self.devicePixelRatio,b);Xj.QA(c=>{a.SupportsTouch=c},()=>v.a.jLa,b);Xj.QA(c=>{a.NavAppName=c},()=>window.navigator.appName,
b);Xj.QA(c=>{a.NavAppVersion=c},()=>window.navigator.appVersion,b);Xj.QA(c=>{a.NavLanguage=c},()=>window.navigator.browserLanguage||window.navigator.language,b);Xj.QA(c=>{a.NavUserAgent=c},()=>window.navigator.userAgent,b);Xj.QA(c=>{a.NavPlatform=c},()=>window.navigator.platform,b);Xj.QA(c=>{a.NavPlugins=c},Xj.cej,b);Xj.QA(c=>{a.CalculatedDevicePixelRatio=c},()=>Xj.devicePixelRatio,b);a.Error=b.toString();return a}static get devicePixelRatio(){const a=window.devicePixelRatio;return isNaN(a)?window.screen.deviceXDPI/
window.screen.logicalXDPI:a}static QA(a,b,c){try{const h=b();a(h)}catch(h){c.isEmpty()||c.append(" | "),c.append(h.message||"null")}}}Object(n.a)(Xj,"BrowserInfoLogger",null,[]);class GB{get name(){return"Common.App.BrowserInfoLogger"}$b(){}init(){Xj.e1j()}dispose(){}static main(){r.a.instance.Dc(new GB)}}Object(n.a)(GB,"BrowserInfoLoggerPackage",null,[2,3]);class HB{get name(){return"Common.App.DialogWithLinkToResource"}$b(){}init(){}dispose(){}static main(){r.a.instance.Dc(new HB)}}Object(n.a)(HB,
"CommonAppDialogWithLinkToResourcePackage",null,[2,3]);var CP=d(705);class IB{get name(){return"Common.App.EventsCachePackage"}$b(){}init(){CP.a.instance.init()}dispose(){}static main(){r.a.instance.Dc(new IB)}}Object(n.a)(IB,"EventsCachePackage",null,[2,3]);class JB{constructor(a,b,c){this.I4a=null;this.Wd=a;this.Ca=b;this.V$e=c.create()}onc(){this.I4a?ba.ULS.sendTraceTag(23674911,207,50,"The current task is not null, re-use it."):(ba.ULS.sendTraceTag(23674910,207,50,"The current sho pane task is null, create new one."),
this.I4a=new He.a(2,1,3E4,Object(F.a)(this,this.lpd,"showFloatPane"),67),this.Wd.Eb(this.I4a))}lpd(){this.I4a=null;ba.ULS.sendTraceTag(23674912,207,50,"The float pane is shown after the task is executed.");this.V$e.display()}Gxa(){this.Ca.ya(H.a.lpd,he.a.frame,Object(F.a)(this,this.Ofl,"showFloatPaneHandler"))}Ofl(a,b,c,h,m){if(a!==H.a.lpd)return 2;if(1===c)return 32;if(2===c&&m){ba.ULS.sendTraceTag(23674913,207,50,"The application wants to show or hide float pane with argument {0}.",m);if(m)this.onc();
else this.I4a?(ba.ULS.sendTraceTag(23674914,207,50,"Hide float pane via removing show task!"),this.Wd.Rg(this.I4a)):(ba.ULS.sendTraceTag(23674915,207,50,"Hide float pane immediately!"),this.V$e.remove(null)),this.I4a=null;return 32}return 8}}Object(n.a)(JB,"FloatPaneActor",null,[606]);class YG{constructor(a,b,c,h,m){this.iEd=this.kSb=this.eCc=this.MAa=this.o2=this.Lza=this.Mwd=this.xZ=this.EUb=this.ITb=this.JTb=this.Yzd=null;this.Wd=b;this.$a=a;this.Jn=c;this.Da=m;this.Iga=h}zHf(){this.xZ=document.createElement("div");
this.xZ.className=String.format("{0} {1}","WACFloatPane","WACFloatPaneFadeIn");this.xZ.style.width=this.o2.width+"px";(this.iEd=this.Qcj(this.Iga))?(this.MAa=document.createElement("a"),this.MAa.setAttribute(zc.a.af,zc.a.fN),this.Jn.pb(ra.a.click,this.MAa,Object(F.a)(this,this.U4g,"onRedirectClick")),this.MAa.href=this.iEd,this.MAa.target="_blank",this.MAa.appendChild(this.o2),this.xZ.appendChild(this.MAa)):this.xZ.appendChild(this.o2);this.Lza=document.createElement("a");this.Lza.setAttribute(zc.a.af,
zc.a.ru);this.Lza.className="StandardButton WACFloatPaneCloseButton";this.Lza.title=CommonUIStrings.l_Close;this.Lza.tabIndex=-1;this.Mwd=zp.createClusteredImage(16,16,"ClosePaneGlyph_16x16x32","StandardButtonImage clip16x16 StandardButtonImageNoText",!0,null);this.Mwd.setAttribute(zc.a.af,zc.a.fN);this.Lza.appendChild(this.Mwd);this.Jn.pb(ra.a.click,this.Lza,Object(F.a)(this,this.onClose,"onClose"));this.xZ.appendChild(this.Lza);this.EUb.appendChild(this.xZ)}pk(a){const b=this.$a.ka("O365PromotionHasStarted");
switch(a){case 2:return Rn.a.RK(String.format("adppt{0}.png",b?"sale":""));case 1:return Rn.a.RK(String.format("adxls{0}.png",b?"sale":""));case 3:return Rn.a.RK(String.format("addoc{0}.png",b?"sale":""))}return null}Qcj(a){const b=this.$a.Ha("O365AdPaneRedirectedURL");switch(a){case 1:return String.format(b,"Excel");case 2:return String.format(b,"PowerPoint");case 3:return String.format(b,"Word")}return null}hide(a=null){this.kSb=null;this.xZ&&!this.eCc&&(a?ba.ULS.sendTraceTag(23674904,207,50,"The float pane is closed automatically."):
ba.ULS.sendTraceTag(23674903,207,50,"User clicks button to close the float pane."),this.xZ.className=String.format("{0} {1}","WACFloatPane","WACFloatPaneFadeOut"),this.xZ.style.height="0px",this.eCc=new He.a(2,1,1E3,Object(F.a)(this,this.remove,"remove"),67),this.Wd.Eb(this.eCc))}remove(){this.xZ&&this.EUb&&(this.MAa&&this.Jn.yb(ra.a.click,this.MAa,Object(F.a)(this,this.U4g,"onRedirectClick")),this.Jn.yb(ra.a.click,this.Lza,Object(F.a)(this,this.onClose,"onClose")),this.EUb.removeChild(this.xZ),this.xZ=
null);this.eCc=null}display(){if(this.Yzd=this.Da.rb("Common.IFloatPaneContainer"))if(this.EUb=this.Yzd.container){var a=this.pk(this.Iga);a?(ba.ULS.sendTraceTag(23674908,207,50,"Begin downloading image from server: {0}.",a),this.o2=document.createElement("img"),this.o2.className="WACFloatPaneImage",this.JTb=Object(F.a)(this,this.dqk,"onLoadImageFinish"),wd.a.addHandler(this.o2,ra.a.load,this.JTb),this.ITb=Object(F.a)(this,this.cqk,"onLoadImageError"),wd.a.addHandler(this.o2,ra.a.error,this.ITb),
this.o2.src=a):ba.ULS.sendTraceTag(23674907,207,15,"The target image is empty, can't show the float pane.")}else ba.ULS.sendTraceTag(23674906,207,15,"The container is empty, so the float pane can't be shown.");else ba.ULS.sendTraceTag(23674905,207,50,"The IFloatPaneContainer is not registered and the float pane can't be shown.")}dqk(){const a=this.$a.Fc("O365AdPaneShowingDuration",60);this.zHf();this.xZ.style.display="block";this.xZ.style.height=this.o2.height+"px";this.kSb=new He.a(2,1,1E3*a,Object(F.a)(this,
this.hide,"hide"),67);this.Wd.Eb(this.kSb);this.Wgh()}cqk(){ba.ULS.sendTraceTag(23674909,207,15,"The image can't be downloaded, the float pane can't be shown.");this.Wgh();this.o2=null}Wgh(){this.JTb&&this.o2&&wd.a.removeHandler(this.o2,ra.a.load,this.JTb);this.JTb=null;this.ITb&&this.o2&&wd.a.removeHandler(this.o2,ra.a.error,this.ITb);this.ITb=null}U4g(){ba.ULS.sendTraceTag(35698659,207,50,"User click the float pane and a new web page will be opened.");return!1}onClose(){this.kSb&&this.Wd.Rg(this.kSb);
this.hide();return!0}dispose(){this.hide()}}Object(n.a)(YG,"FloatPane",null,[630]);class KB{constructor(a,b,c,h,m){this.Wd=b;this.$a=a;this.Jn=c;this.Da=m;this.Iga=h}create(){return new YG(this.$a,this.Wd,this.Jn,this.Iga,this.Da)}}Object(n.a)(KB,"FloatPaneFactory",null,[605]);class LB{constructor(){this.Da=null}get name(){return"Common.App.FloatPane"}get xgg(){return u.AFrameworkApplication.fa.ka("O365AdvertisementIsEnabled")&&u.AFrameworkApplication.fa.ka("IsShowAdvertisementPaneEnabled")}init(){this.xgg&&
(ba.ULS.sendTraceTag(23674944,207,50,"Setup task to show the float pane."),this.Da.resolve("Common.App.FloatPane.IFloatPaneActor").onc(),ba.ULS.sendTraceTag(23674945,207,50,"Setup action for excel to show the float pane."),this.Da.resolve("Common.App.FloatPane.IFloatPaneActor").Gxa())}$b(a){this.Da=a;this.xgg&&(this.Da.register(KB,"Common.App.FloatPane.FloatPaneFactory").as("Common.App.FloatPane.IFloatPaneFactory").oa(()=>new KB(u.AFrameworkApplication.fa,u.AFrameworkApplication.we,nd.a.instance,
u.AFrameworkApplication.Aa.hb.Vk,this.Da)).ma(),this.Da.register(JB,"Common.App.FloatPane.FloatPaneActor").as("Common.App.FloatPane.IFloatPaneActor").oa(()=>new JB(u.AFrameworkApplication.we,u.AFrameworkApplication.Ta,this.Da.resolve("Common.App.FloatPane.IFloatPaneFactory"))).ma())}dispose(){}static main(){r.a.instance.Dc(new LB)}}Object(n.a)(LB,"FloatPanePackage",null,[2,3]);const ZG=(a,b)=>{a=Math.atan2(b.y-a.y,b.x-a.x);0>a&&(a+=2*Math.PI);return a};class DP{constructor(a,b,c){this.EP=this.rnb=
this.Lpb=null;this.Fza=this.hyd=this.upa=0;this.wG=this.Yyc=this.Jxc=this.Ixc=!1;this.tBd=this.Obf=this.Qbf=0;this.wNa=a;this.Ca=b;this.EZ=c}xv(a){return Fc.App.Kb.Jd.isEditingAllowed?""!==this.TRc(a.Cc):!1}Nu(a){if(!this.xv(a))return!1;this.Fza=this.wNa.uHl();this.E8k(a);this.F8k();({Aie:this.Yyc,kle:this.wG}=this.Dqh(this.hyd));this.G8k();this.Lpb=a.EE;this.EP=new Sys.UI.Point(0,0);({width:this.Qbf,height:this.Obf}=this.wNa.rRc());ba.ULS.sendTraceTag(16802335,322,50,"Image resize drag started");
return!0}zw(a){this.rnb=a.EE;this.Nmi();var b=this.EP.x,c=this.EP.y;a=this.Qbf;var h=this.Obf,m=this.Yyc,y=this.wG,G=1;(b||c)&&a&&h&&(m&&y?(G=a+b,m=h+c,b=1/a,c=1/h,y=b>c?b:c,1>G?G=1:1920<G&&(G=1920),1>m?m=1:1280<m&&(m=1280),b=G-a,c=m-h,G=Math.abs(b/a)>Math.abs(c/h)?G/a:m/h,G<y&&(G=y)):m?(b=a+b,1>b?b=1:1920<b&&(b=1920),G=b/a):y&&(b=h+c,1>b?b=1:1280<b&&(b=1280),G=b/h));a=G;this.tBd=a;this.wNa.lJl(this.tBd,this.Yyc,this.wG);return!0}Zn(){this.ih();ba.ULS.sendTraceTag(16802336,322,50,"Image resize drag succeeded")}iu(){this.wNa.AIl();
ba.ULS.sendTraceTag(16802337,322,50,"Image resize drag canceled")}F8k(){this.hyd=(Math.floor((this.Fza+22)/45)%8+this.upa)%8}Dqh(a){let b,c;if(this.Fza&&90!==this.Fza&&180!==this.Fza&&270!==this.Fza&&360!==this.Fza||this.nNj(a))return{Aie:!0,kle:!0};c=b=!1;switch(a){case 1:case 5:c=!0;break;case 3:case 7:b=!0}return{Aie:b,kle:c}}G8k(){this.Jxc=this.Ixc=!1;switch(this.hyd){case 0:this.Jxc=this.Ixc=!0;break;case 1:case 2:this.Jxc=!0;break;case 7:case 6:this.Ixc=!0}}nNj(a){return!(a%2)}TRc(a){var b=
a.className;-1===b.indexOf("WACImageResizeHandle")&&a.parentNode&&(b=a.parentNode.className);a=b.split(" ");for(b=0;b<a.length;b++){const c=a[b].toString();if(c.startsWith("WACImageResizeHandle")&&"WACImageResizeHandles"!==c)return c}return""}E8k(a){switch(this.TRc(a.Cc)){case "WACImageResizeHandleNW":this.upa=0;break;case "WACImageResizeHandleN":this.upa=1;break;case "WACImageResizeHandleNE":this.upa=2;break;case "WACImageResizeHandleE":this.upa=3;break;case "WACImageResizeHandleSE":this.upa=4;break;
case "WACImageResizeHandleS":this.upa=5;break;case "WACImageResizeHandleSW":this.upa=6;break;case "WACImageResizeHandleW":this.upa=7}}Nmi(){var a=1;this.EZ.instance&&(a=this.EZ.instance.Y2);const b=(this.rnb.x-this.Lpb.x)/a;a=(this.rnb.y-this.Lpb.y)/a;this.EP.x=this.Ixc?-b:b;this.EP.y=this.Jxc?-a:a}ih(){const a=new E.DictionaryPropertySet;a.setValue(xc.a.eAj,100*this.tBd);a.setValue(xc.a.fAj,!0);if(90===this.Fza||270===this.Fza){let b,c;({Aie:b,kle:c}=this.Dqh(this.upa));a.setValue(xc.a.fbg,b);a.setValue(xc.a.gbg,
c)}else a.setValue(xc.a.fbg,this.Yyc),a.setValue(xc.a.gbg,this.wG);this.Ca.La(D.a.cAj,2,a)}}Object(n.a)(DP,"ImageResizeDragAdapter",null,[244]);class MB{constructor(a,b){this.Ca=a;this.EZ=b}}Object(n.a)(MB,"ImageResizeDragAdapterFactory",null,[576]);class $G{constructor(a,b,c,h,m,y){this.npb=this.wCc=this.xBd=this.rnb=this.Lpb=this.xCc=null;this.ZAc=this.GEc=0;this.Ox=null;this.mo=!1;this.Ca=a;this.Tc=b;this.Ig=c;this.wNa=h;this.EZ=m;this.Iff=this.Oha=0;this.tpb=y}xv(a){return Fc.App.Kb.Jd.isEditingAllowed&&
a?(this.xCc=this.Tc.Qj)?!0:!1:!1}Nu(a){if(!this.xv(a))return!1;this.xCc=this.Tc.Qj;if(this.Ox=aa.ImageReader.PDa(this.xCc))return this.Lpb=this.cta(a),this.xBd=Sys.UI.DomElement.getBounds(this.tpb),this.GEc=0<aa.ImageReader.u0f(this.Ox)?aa.ImageReader.u0f(this.Ox):0,this.ZAc=aa.ImageReader.W9i(this.Ox),ba.ULS.sendTraceTag(22052886,322,50,"Image rotate drag event started."),!0;ba.ULS.sendTraceTag(24496074,322,15,"Drag start cancelled. Attempted to rotate with null img. properties.");return!1}zw(a){this.rnb=
this.cta(a);this.Pmi();if(this.wNa)return this.wNa.aAl(this.Oha,this.Iff),ba.ULS.sendTraceTag(25179723,322,50,"Image rotate drag move is happening."),!0;ba.ULS.sendTraceTag(25179724,322,50,"Image rotate drag move aborted because img presenter is null.");return!1}Zn(){var a=this.Oha;a%=360;0>a&&(a+=360);this.GEc=this.Oha=a;this.setRotation();ba.ULS.sendTraceTag(22052887,322,50,"Image rotate drag event ended.")}iu(){this.wNa.aAl(this.ZAc,0);ba.ULS.sendTraceTag(22052888,322,50,"Image rotate drag event canceled.")}cta(a){return this.Ig.Hja(a)}Pmi(){var a=
1;this.EZ&&this.EZ.instance&&(a=this.EZ.instance.Y2);var b=new Sys.UI.Point(this.xBd.x+this.tpb.clientWidth/2*a,this.xBd.y+this.tpb.clientHeight/2*a);a=ZG(this.Lpb,b);b=ZG(this.rnb,b);this.Oha=Math.round(te.a.UO(b-a));0<this.GEc&&(this.Oha+=this.GEc-this.ZAc);this.Iff=this.Oha;this.Oha+=this.ZAc}setRotation(){const a=new E.DictionaryPropertySet;a.setValue(xc.a.dAj,0);a.setValue(xc.a.K7b,this.Oha);this.Ca.La(D.a.imageRotate,2,a)}dispose(){ba.ULS.sendTraceTag(50597973,322,50,"ImageRotateDragAdapter is disposed.");
this.mo||(this.npb&&(this.wCc&&this.npb.contains(this.wCc)&&(this.npb.removeChild(this.wCc),this.wCc=null),this.tpb&&this.tpb.contains(this.npb)&&(this.tpb.removeChild(this.npb),this.npb=null)),this.mo=!0)}}Object(n.a)($G,"ImageRotateDragAdapter",null,[602,244,106]);class NB{constructor(a,b,c){this.Ca=a;this.Tc=b;this.EZ=c}create(a,b,c){return new $G(this.Ca,this.Tc,a,b,this.EZ,c)}}Object(n.a)(NB,"ImageRotateDragAdapterFactory",null,[575]);class OB{constructor(){this.Da=null}get name(){return"Box4.Images"}$b(a){this.Da=
a;this.Da.register(MB,"Box4.Images.ImageResizeDragAdapterFactory").as("Box4.Images.IImageResizeDragAdapterFactory").ma().oa(()=>new MB(u.AFrameworkApplication.Ta,vb.a.instance.Ja("Common.IZoomManager")));this.Da.register(NB,"Box4.Images.ImageRotateDragAdapterFactory").as("Box4.Images.IImageRotateDragAdapterFactory").ma().oa(()=>new NB(u.AFrameworkApplication.Ta,me.a.instance,vb.a.instance.Ja("Common.IZoomManager")))}init(){this.Da.resolve("Box4.Images.IImageRotateDragAdapterFactory")}dispose(){}static main(){r.a.instance.Dc(new OB)}}
Object(n.a)(OB,"Box4ImagesPackage",null,[2,3]);class aH{create(a){return new rc.a(a)}}Object(n.a)(aH,"Factory",null,[1030]);var Yy=d(439);class bH{constructor(){this.Ii=null}get key(){return"COMMENTTEXTANCHOR"}get O7(){return Box4Intl.Box4Strings.l_CommentContentTitle}reset(a){this.Ii=Object(ua.a)(Vb.AParagraphNode,a.node)}dtc(a){a=(a=this.B4i(a))?Object.assign(new Yy.a,{T0:this.key,ZP:a}):null;return{returnValue:!!a,tBa:a}}B4i(a){if(!this.Ii.Ra)return null;const b=new Qa.a;for(let c=0;c<this.Ii.Ra.length;c++){const h=
this.Ii.Ra.ga(c);if(h.cp>a)break;if(h.zg)for(let m=0;m<h.zg.length;m++){const y=h.zg.ga(m);y.vk?b.add(y.nI.Aq.toString()):b.remove(y.nI.Aq.toString())}}return 0<b.count?b.ga(0):null}}Object(n.a)(bH,"CommentTextAnchorDetailsProvider",null,[701,384]);class fx{constructor(){this.Ii=null}get O7(){return null}getTitle(){return null}HZf(){return null}reset(a){this.Ii=a.node}dtc(a){const b=Ud.d(this.Ii,a);a=null;if(!b||b.Sq!==this.Sq)return{returnValue:!1,tBa:a};a=Object.assign(new Yy.a,{T0:this.key,ZP:b,
title:this.getTitle(b),description:this.HZf(b)});return{returnValue:!0,tBa:a}}}Object(n.a)(fx,"BlobDetailsProvider",null,[701,384]);class cH extends fx{constructor(){super()}get key(){return"EQUATION"}get Sq(){return 11}get O7(){return Box4Intl.Box4Strings.l_EquationContentTitle}}Object(n.a)(cH,"EquationDetailsProvider",fx,[]);class dH{constructor(){this.Cbf=null}get key(){return"LINK"}get O7(){return Box4Intl.Box4Strings.l_HyperlinkContentTitle}reset(a){this.Cbf=Ib.HyperlinkReader.S4b(a.node)}dtc(a){let b;
b=null;for(const c of this.Cbf)if(c.Qa<=a&&a<c.Nb)return b=Object.assign(new Yy.a,{T0:this.key,ZP:c.hyperlink}),{returnValue:!0,tBa:b};return{returnValue:!1,tBa:b}}}Object(n.a)(dH,"HyperlinkDetailsProvider",null,[701,384]);class eH extends fx{constructor(){super()}get key(){return"IMAGE"}get Sq(){return 5}get O7(){return Box4Intl.Box4Strings.l_ImageContentTitle}getTitle(a){return aa.ImageReader.XRc(a.properties)}HZf(a){return aa.ImageReader.j6d(a.properties)}}Object(n.a)(eH,"ImageDetailsProvider",
fx,[]);class Zy{constructor(){this.description=this.contentId=this.ZP=this.T0=null}}Object(n.a)(Zy,"StructuralContentDetails",null,[407]);class fH{get key(){return"IMAGENODE"}get O7(){return Box4Intl.Box4Strings.l_ImageContentTitle}h1e(a){let b;b=null;if(!a||!aa.ImageReader.dH(a.currentNode))return{returnValue:!1,gtb:b};b=Object.assign(new Zy,{T0:this.key,contentId:a.currentNode.id,ZP:a.currentNode});return{returnValue:!0,gtb:b}}gRc(a,b){a=a.ZP;const c=Box4Intl.Box4Strings.l_AccessibleContentDetailsFormat;
let h="";b&&a.id===b.ZP.id||(h=String.format(c,aa.ImageReader.XRc(a.properties),Box4Intl.Box4Strings.l_ImageContentTitle));return h}}Object(n.a)(fH,"ImageNodeDetailsProvider",null,[383,384]);let gx,hx;class Sr{constructor(a,b){this.f$e=null;this.Gm=b;this.sHd=a;this.mTb=Sr.keys.ga(a);this.wOh=Sr.Kyi.ga(a)}get key(){return this.mTb}get O7(){return this.wOh}reset(a){this.f$e=this.Gm.BF(a.node)}dtc(a){var b=Sr.EXi(this.f$e||[],c=>this.PJj(a,c));b=this.EBi(b);return{returnValue:!!b,tBa:b}}PJj(a,b){return b.begin<=
a&&a<b.end&&(!b.Gh||this.sHd===b.Gh.proofingType)}EBi(a){return a?Object.assign(new Yy.a,{T0:this.key,ZP:a.Gh,description:this.Q4d()}):null}Q4d(){return u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.ka("WordEditorIdeasCardsIsEnabled")?Box4Intl.Box4Strings.l_ShowIntentSuggestionTooltipClickOrPress:null}static EXi(a,b){for(const c of a)if(b(c))return c;return null}}Sr.keys=(hx=new Sc.a,hx.add(1,"SPELLINGERROR"),hx.add(2,"GRAMMATICALERROR"),hx.add(3,"ADVANCEDERROR"),hx);Sr.Kyi=(gx=new Sc.a,
gx.add(1,Box4Intl.Box4Strings.l_SpellingErrorContentTitle),gx.add(2,Box4Intl.Box4Strings.l_GrammaticalErrorContentTitle),gx.add(3,Box4Intl.Box4Strings.l_AdvancedProofingIssueContentTitle),gx);Object(n.a)(Sr,"ProofingDetailsProvider",null,[701,384]);class gH{constructor(){this.tableNode=null;this.pJc=this.Ald=this.columns=this.rows=0}}Object(n.a)(gH,"TableInfo",null,[]);var xn=d(146),Gd=d(83),gk=d(125);class hH{get key(){return"TABLE"}get O7(){return Box4Intl.Box4Strings.l_TableContentTitle}h1e(a){var b=
null;if(!Qe.isTableCell(a))return{returnValue:!1,gtb:b};b=new rb.GraphIterator;b.Rc(a);a=new gH;a.Ald=gk.c(b)+1;a.pJc=xn.a(b)+1;Gd.returnToContainingTable(b);a.tableNode=b.currentNode;a.columns=rd.TableReader.Ai(a.tableNode);a.rows=rd.TableReader.rk(a.tableNode);b=Object.assign(new Zy,{T0:this.key,contentId:a.tableNode.id,ZP:a});return{returnValue:!0,gtb:b}}gRc(a,b){a=a.ZP;const c=new Li.a;b||c.add(String.format(Box4Intl.Box4Strings.l_TableContentDetailsFormat,a.columns,a.rows));b&&b.ZP.pJc===a.pJc||
c.add(String.format(Box4Intl.Box4Strings.l_TableContentDetailsColumnFormat,a.pJc));b&&b.ZP.Ald===a.Ald||c.add(String.format(Box4Intl.Box4Strings.l_TableContentDetailsRowFormat,a.Ald));return c.toArray().join(" ")}}Object(n.a)(hH,"TableDetailsProvider",null,[383,384]);class PB{constructor(a,b){this.bRh=a;this.Gm=b}kOe(){this.bRh.execute(a=>{a.JZa(new dH);a.JZa(new Sr(1,this.Gm));a.JZa(new Sr(2,this.Gm));a.JZa(new Sr(3,this.Gm));a.JZa(new cH);a.JZa(new eH);a.JZa(new bH);a.vOe(new hH);a.vOe(new fH)})}}
Object(n.a)(PB,"AccessibilityActor",null,[]);class QB{constructor(a,b,c){this.zWb=a;this.ld=b;this.QMh=c}vb(){this.zWb.ra(D.a.Luk,xb.a.view,Object(F.a)(this,this.Muk,"openAutoCorrectOptionsView"),1028)}Muk(a,b,c){if(1===c)return 32;this.QMh().Fqc();return 32}}Object(n.a)(QB,"AutoCorrectActor",null,[]);class RB{constructor(a){this.BTh=a}DPj(a){if(!a||!a.iw||1>a.iw.count)return!1;const b=[wb.a.sHi,wb.a.rHi];return!!this.PQc(a.iw,1,c=>this.WJc(c,b))}Jfg(a){return!a||!a.iw||1>a.iw.count?!1:!!this.PQc(a.iw,
1,b=>this.WJc(b,[wb.a.vN]))}WMj(a){return!a||!a.iw||1>a.iw.count?!1:!!this.PQc(a.iw,2,b=>this.WJc(b,[wb.a.aac]))}fl(a){return!a||!a.iw||1>a.iw.count?!1:!!this.PQc(a.iw,1,b=>this.WJc(b,[wb.a.mfa]))}zYc(a){if(!a||!a.iw)return!1;a=a.iw;for(let b=0;b<a.count;++b)if(!a.ga(b)||0<a.ga(b).Nfi)return!1;return!0}YRi(a,b){return this.Jfg(b)||this.WMj(b)?"":a}get uZc(){return this.BTh}PQc(a,b,c){if(a&&0<a.count)for(let h=a.count-1;0<=h;--h){if(c(a.ga(h)))return a.ga(h);if(a.count-h>=b)break}return null}WJc(a,
b){a=a&&a.sag?a.sag.split(" "):null;if(!a)return!1;for(const c of b)if(0<=Array.indexOf(a,c))return!0;return!1}}Object(n.a)(RB,"Box4PasteStewardUtils",null,[1129]);class iH{constructor(){this.$Y=0;this.jAb=Array(9)}}Object(n.a)(iH,"FullListMetadata",null,[]);class $y{constructor(){this.level=0;this.hMa=null;this.$Y=0;this.MUi=this.ekc=null;this.jHb=!1}}Object(n.a)($y,"ListItemMetadata",null,[]);class Wt{constructor(){this.eZ=[]}fZf(){const a=new Wt;for(let b=0;b<this.eZ.length;b++)a.add(this.ga(b));
return a}get count(){return this.eZ.length}ga(a){return this.eZ[a]}$(a,b){return this.eZ[a]=b}add(a){Array.add(this.eZ,a)}clear(){Array.clear(this.eZ)}contains(a){return Array.contains(this.eZ,a)}indexOf(a){return Array.indexOf(this.eZ,a)}insert(a,b){Array.insert(this.eZ,a,b)}remove(a){return Array.remove(this.eZ,a)}removeAt(a){Array.removeAt(this.eZ,a)}removeRange(a,b){for(let c=0;c<b;c++)Array.removeAt(this.eZ,a)}reverse(){this.eZ.reverse()}sort(){this.eZ.sort()}toArray(){return Array.clone(this.eZ)}}
Object(n.a)(Wt,"List",null,[]);class jH{constructor(){this.level=0;this.tagName="UL";this.jYa=null;this.ignore=!1;this.Qic=0;this.listStyle="BulletListStyle1";this.i9=new Wt;this.font=this.levelText=""}}Object(n.a)(jH,"ListLevelMetadata",null,[]);class SB{constructor(){this.ung={};this.zLc=-1}}Object(n.a)(SB,"LevelLists",null,[]);class TB{constructor(a){this.nodes=a;this.W2=0;this.lists={};this.i9=[];this.Zzb=null;this.cja=[];this.cja[0]=new SB}}Object(n.a)(TB,"WordConverterArguments",null,[]);class kH{constructor(){this.y=
this.x=0;this.top=this.left=null}}Object(n.a)(kH,"AbsolutePosition",null,[]);class Qm{constructor(a,b,c,h,m){this.cultureName=this.t5=this.iw=this.BU=null;a&&(this.BU=a);b&&(this.iw=b);this.t5=c?c:new Qa.a;h&&""!==h&&(this.cultureName=h);this.aia=m}}Object(n.a)(Qm,"GlobalAttributesArgs",null,[]);class Xt{constructor(a,b,c="",h=0){this.Tv=!1;this.sbf=this.tbf=null;let m=!1;Xt.sMj(a)&&(m=!0,this.tbf=a);Xt.HMj(b)&&(this.sbf=b);this.TRh=c;this.LMh=h;this.Tv=m&&this.w7b?!0:!1}get isValid(){return this.Tv}get vag(){return this.tbf}get w7b(){return this.sbf}get sag(){return this.TRh}get Nfi(){return this.LMh}static sMj(a){return a?
-1===a.indexOf(" ")&&0<a.length:!0}static HMj(a){return a?-1===a.indexOf(" ")&&0<a.length:!1}}Object(n.a)(Xt,"HtmlElementInfo",null,[]);class lH{constructor(a){this.next=null;this.data=a}}Object(n.a)(lH,"StackNode",null,[]);class ix{constructor(){this.ev=null;this.Yk=0}get count(){return this.Yk}get isEmpty(){return!this.Yk||!this.ev}push(a){a=new lH(a);a.next=this.ev;this.ev=a;this.Yk++}peek(){return this.isEmpty?null:this.ev.data}pop(){if(this.isEmpty)return null;const a=this.ev;this.ev=a.next;
this.Yk--;return a.data}clear(){this.ev=null;this.Yk=0}toArray(){const a=Array(this.count);let b=this.ev;for(let c=this.count-1;0<=c&&b;c--)a[c]=b.data,b=b.next;return a}}Object(n.a)(ix,"Stack",null,[]);class fh{constructor(a){this.TRb=this.QAc=null;this.exc=!1;this.Hg=a}get KQa(){return this.TRb.peek()}reset(){this.Hg.reset();this.QAc=new ix;this.TRb=new ix;this.TRb.push(this.Hg.q1b);this.exc=!1}edd(){this.exc=!1}aD(a){this.exc||(this.QAc.push(null),this.exc=!0);this.QAc.push(a)}onClose(){for(;;){const a=
this.QAc.pop();if(!a)break;a()}}tph(){return!1}wkk(){this.Bq(()=>!0)}Bq(a){const b=this.KQa.clone();return a(b)?(this.TRb.push(b),this.Hg.jna(b),this.aD(Object(F.a)(this,this.Gok,"onFormattingEnd")),!0):!1}C$d(a){return a.style?this.Bq(b=>this.tph(b,a))?1:2:2}Gok(){this.TRb.pop();this.Hg.jna(this.KQa)}N0(){}Xcd(){return 2}wEe(){return 2}xEe(){return 2}zEe(){return 2}GEe(){return 3}JEe(){}cdd(){return 2}KEe(){}LEe(){}MEe(){return 2}idd(){return 2}jdd(){return 2}YEe(){return 2}kdd(){}cFe(){return 2}ldd(){return 2}ndd(){return 2}rdd(){return 2}tdd(){return 2}oFe(){}pFe(){return 2}wdd(){return 2}xdd(){return 2}zdd(){return 2}Add(){return 2}Cdd(){return 2}Ddd(){return 2}Edd(){return 2}Hdd(){return 2}KFe(){return 2}Pdd(){return 2}QFe(){return 2}RFe(){}SFe(){return 2}Udd(){return 2}Vdd(){return 2}Wdd(){return 2}Xdd(){return 2}Ydd(){return 2}Zdd(){return 2}WFe(){return 3}$dd(){}YFe(){return 2}aed(){return 2}$Fe(){return 3}bed(){}bGe(){}ced(){return 2}iGe(){return 3}ded(){return 2}fed(){return 2}hed(){return 2}ied(){return 2}lGe(){}mGe(){return 3}ned(){return 2}tGb(){return 2}pGe(){}sGe(){return 2}tGe(){return 2}uGe(){return 3}ved(){return 2}vGe(){return 2}zed(){return 2}Ced(){return 2}wGe(){}Oed(){return 2}GGe(){return 2}Wed(){return 2}Xed(){return 2}RGe(){return 3}SGe(){return 2}ffd(){return 2}gfd(){return 2}hfd(){return 2}ifd(){return 2}YGe(){return 3}jfd(){return 2}kfd(){return 2}ofd(){return 2}aHe(){return 2}Sjc(){return 2}cHe(){return 2}dHe(){return 2}pfd(){return 2}eHe(){return 2}gHe(){return 3}qfd(){return 2}tfd(){return 2}ufd(){return 2}vfd(){return 2}xfd(){return 2}static ota(a){return a&&
-1!==a.indexOf("px")&&(a=parseInt(ta.a.substring(a,0,a.indexOf("px"))),!isNaN(a))?a:0}static lij(a){if(!a||""===a)return-1;const b=ta.a.og(a);if(-1!==b.indexOf("pt")){if(a=parseFloat(ta.a.substring(a,0,b.indexOf("pt"))),!isNaN(a))return a}else if(-1!==b.indexOf("px")&&(a=parseFloat(ta.a.substring(a,0,b.indexOf("px"))),!isNaN(a)))return 3*a/4;return-1}static V2f(a){return a&&""!==a?fh.ota(a):null}static uy(a){let b=null,c=null,h=null,m=null;a&&a.Wf&&(b=fh.gta(a.Wf,"id"),c=fh.gta(a.Wf,"lang"),h=a.Wf.tagName,
a.idi&&(m=Object.assign(new kH,{x:fh.ota(a.Wf.style.left),y:fh.ota(a.Wf.style.top),left:fh.V2f(a.Wf.style.left),top:fh.V2f(a.Wf.style.top)})),void 0===b&&(b=""),void 0===c&&(c=""));return new Qm(new Xt(b,h),a.iw,null,c,m)}static gta(a,b){return a[b]}}Object(n.a)(fh,"AHtmlTranslator",null,[1166]);class mH extends Qm{constructor(a,b,c,h=0,m=0,y=null){super(y?y.BU:null,y?y.iw:null,y?y.t5:null,y?y.cultureName:null,y?y.aia:null);this.width=h;this.height=m}}Object(n.a)(mH,"AugmentationSemanticArgs",Qm,
[]);class nH{constructor(){this.stop=this.color=null}}Object(n.a)(nH,"ColorStopPair",null,[]);class az{constructor(a,b){this.value=a;this.a_i=b}get AYc(){return this.a_i}}Object(n.a)(az,"ElementValueWrapper",null,[]);class oH extends az{constructor(a,b,c){super(a,b);this.rjg=c}}Object(n.a)(oH,"DimensionWrapper",az,[]);class UB{constructor(a=0,b=0,c=0,h=0,m="",y="",G="",U="",ja="0pt",va="0pt",Ta="0pt",fb="0pt"){this.borderTopStyle=a;this.borderRightStyle=b;this.borderBottomStyle=c;this.borderLeftStyle=
h;this.borderTopColor=m;this.borderRightColor=y;this.borderBottomColor=G;this.borderLeftColor=U;this.borderTopWidth=ja;this.borderRightWidth=va;this.borderBottomWidth=Ta;this.borderLeftWidth=fb}}Object(n.a)(UB,"TableCellBorderProperties",null,[]);class VB{constructor(a="",b="",c="",h=""){this.$oi=a;this.Zoi=b;this.Xoi=c;this.Yoi=h}}Object(n.a)(VB,"TableCellMarginProperties",null,[]);class Rg{static get uag(){return Rg.VRh}static get Wqd(){return Rg.z0h}static get Sqd(){return Rg.x0h}static U9d(a,
b,...c){b=Rg.s6f(b);let h=!1;b||(b=Rg.xmj.apply(null,[a].concat(c)),h=!!b);return new az(b,h)}static s6f(a){for(const b of a)if(void 0!==b&&null!==b&&""!==b)return b.trim();return null}static xmj(a,...b){for(const c of b)if(b=a.getAttribute(c),void 0!==b&&null!==b&&(b+="",void 0!==b&&null!==b&&""!==b))return b.trim();return null}static Ydj(a,b){b=parseFloat(b);if(isNaN(b))return 0;switch(a){case "px":return Math.round(b);case "pt":return Math.round($d.a.tfa(b,0,!1));case "in":return Math.round($d.a.t_(b,
0,!1));case "cm":return Math.round($d.a.t_(te.a.RBf(b),0,!1));case "mm":return Math.round($d.a.t_(te.a.RBf(.1*b),0,!1));default:return b}}static dld(a,b,...c){a=Rg.U9d.apply(null,[a,b].concat(c));c=0;b=!1;if(a.value){b=a.value.endsWith("%");let h;b?(c="%",h=ta.a.substring(a.value,0,a.value.length-1)):a.AYc?(c="px",h=a.value):(c=a.value.substr(a.value.length-2),isNaN(parseFloat(c))?h=ta.a.substring(a.value,0,a.value.length-2):(c="px",h=a.value));c=Rg.Ydj(c,h)}return new oH(c,a.AYc,b)}static Zwb(a){return Rg.dld(a,
[a.style.width],"width","WIDTH","Width")}static k9a(a){return Rg.dld(a,[a.style.height],"height","HEIGHT","Height")}static W6d(a){return Rg.dld(a,[a.style.marginLeft],"leftmargin","LEFTMARGIN","LeftMargin")}static X6d(a){return Rg.dld(a,[a.style.marginRight],"rightmargin","RIGHTMARGIN","RightMargin")}static Dmj(a){a=Rg.U9d(a,[a.style.verticalAlign],"vAlign","valign","VALIGN","VAlign");return a.value&&a.value in Rg.Wqd&&void 0!==Rg.Wqd[a.value]&&null!==Rg.Wqd[a.value]?Rg.Wqd[a.value]:0}static PTj(a){a=
Rg.s6f([a.style.borderCollapse]);return!!a&&!(void 0===a||null===a)&&("collapse"===a||"COLLAPSE"===a||"Collapse"===a)}static u2i(a){return Rg.U9d(a,[a.style.backgroundColor,a.style.background],"bgcolor","BGCOLOR","BgColor","BGColor").value}static uzi(a){const b=ta.a.substring(a,0,1),c=ta.a.substring(a,1,2);a=ta.a.substring(a,2,3);return b+b+c+c+a+a}static Tia(a){let b="";if(!a||""===a)return b;b=a.trim();if(b.startsWith("rgb")){b=ta.a.substring(b,b.indexOf("(")+1,b.length-1);a=b.split(",");if(3!==
a.length)return"";b="";for(let h=0;h<a.length;h++){var c=parseInt(a[h]);if(isNaN(c)||0>c||255<c)return"";c=c.toString(16);1===c.length&&(c="0"+c);b+=c}return ta.a.FB(b)}if(Rg.uag[ta.a.og(b)])return Rg.uag[ta.a.og(b)];b.startsWith("#")&&(b=ta.a.substring(b,1,b.length));if(isNaN(parseInt(b,16)))return"";3===b.length&&(b=Rg.uzi(b));return 6!==b.length?"":b}static Yxk(a){var b=a.indexOf("mso-tab-count");if(-1===b)return 0;const c=RegExp("([\\d])");let h="";for(b=b+13+1;b<a.length;b++){const m=a.charAt(b).toString();
if(c.test(m))h+=m;else break}a=0;""!==h&&(a=parseInt(h));return a}static yUc(a,b){const c=Rg.u2i(a);c&&""!==c&&b.Bq(h=>h.jnd(Rg.Tia(c)))}static hYf(a){a=a.style;if(!a)return null;const b=Rg.Sqd[a.borderTopStyle],c=Rg.Tia(a.borderTopColor),h=a.borderTopWidth,m=Rg.Sqd[a.borderRightStyle],y=Rg.Tia(a.borderRightColor),G=a.borderRightWidth,U=Rg.Sqd[a.borderBottomStyle],ja=Rg.Tia(a.borderBottomColor),va=a.borderBottomWidth,Ta=Rg.Sqd[a.borderLeftStyle],fb=Rg.Tia(a.borderLeftColor);return new UB(b,m,U,Ta,
c,y,ja,fb,h,G,va,a.borderLeftWidth)}static o3i(a){const b=a.firstChild;return(a=b&&b.className&&-1!==b.className.indexOf("TableCellContent")?a.firstChild.style:a.style)?new VB(a.paddingTop,a.paddingRight,a.paddingBottom,a.paddingLeft):null}}Rg.VRh=Da.a.JH("aliceblue","F0F8FF","antiquewhite","FAEBD7","aqua","00FFFF","aquamarine","7FFFD4","azure","F0FFFF","beige","F5F5DC","bisque","FFE4C4","black","000000","blanchedalmond","FFEBCD","blue","0000FF","blueviolet","8A2BE2","brown","A52A2A","burlywood",
"DEB887","cadetblue","5F9EA0","chartreuse","7FFF00","chocolate","D2691E","coral","FF7F50","cornflowerblue","6495ED","cornsilk","FFF8DC","crimson","DC143C","cyan","00FFFF","darkblue","00008B","darkcyan","008B8B","darkgoldenrod","B8860B","darkgray","A9A9A9","darkgrey","A9A9A9","darkgreen","006400","darkkhaki","BDB76B","darkmagenta","8B008B","darkolivegreen","556B2F","darkorange","FF8C00","darkorchid","9932CC","darkred","8B0000","darksalmon","E9967A","darkseagreen","8FBC8F","darkslateblue","483D8B",
"darkslategray","2F4F4F","darkslategrey","2F4F4F","darkturquoise","00CED1","darkviolet","9400D3","deeppink","FF1493","deepskyblue","00BFFF","dimgray","696969","dimgrey","696969","dodgerblue","1E90FF","firebrick","B22222","floralwhite","FFFAF0","forestgreen","228B22","fuchsia","FF00FF","gainsboro","DCDCDC","ghostwhite","F8F8FF","gold","FFD700","goldenrod","DAA520","gray","808080","grey","808080","green","008000","greenyellow","ADFF2F","honeydew","F0FFF0","hotpink","FF69B4","indianred","CD5C5C","indigo",
"4B0082","ivory","FFFFF0","khaki","F0E68C","lavender","E6E6FA","lavenderblush","FFF0F5","lawngreen","7CFC00","lemonchiffon","FFFACD","lightblue","ADD8E6","lightcoral","F08080","lightcyan","E0FFFF","lightgoldenrodyellow","FAFAD2","lightgray","D3D3D3","lightgrey","D3D3D3","lightgreen","90EE90","lightpink","FFB6C1","lightsalmon","FFA07A","lightseagreen","20B2AA","lightskyblue","87CEFA","lightslategray","778899","lightslategrey","778899","lightsteelblue","B0C4DE","lightyellow","FFFFE0","lime","00FF00",
"limegreen","32CD32","linen","FAF0E6","magenta","FF00FF","maroon","800000","mediumaquamarine","66CDAA","mediumblue","0000CD","mediumorchid","BA55D3","mediumpurple","9370D8","mediumseagreen","3CB371","mediumslateblue","7B68EE","mediumspringgreen","00FA9A","mediumturquoise","48D1CC","mediumvioletred","C71585","midnightblue","191970","mintcream","F5FFFA","mistyrose","FFE4E1","moccasin","FFE4B5","navajowhite","FFDEAD","navy","000080","oldlace","FDF5E6","olive","808000","olivedrab","6B8E23","orange","FFA500",
"orangered","FF4500","orchid","DA70D6","palegoldenrod","EEE8AA","palegreen","98FB98","paleturquoise","AFEEEE","palevioletred","D87093","papayawhip","FFEFD5","peachpuff","FFDAB9","peru","CD853F","pink","FFC0CB","plum","DDA0DD","powderblue","B0E0E6","purple","800080","red","FF0000","rosybrown","BC8F8F","royalblue","4169E1","saddlebrown","8B4513","salmon","FA8072","sandybrown","F4A460","seagreen","2E8B57","seashell","FFF5EE","sienna","A0522D","silver","C0C0C0","skyblue","87CEEB","slateblue","6A5ACD",
"slategray","708090","slategrey","708090","snow","FFFAFA","springgreen","00FF7F","steelblue","4682B4","tan","D2B48C","teal","008080","thistle","D8BFD8","tomato","FF6347","turquoise","40E0D0","violet","EE82EE","wheat","F5DEB3","white","FFFFFF","whitesmoke","F5F5F5","yellow","FFFF00","yellowgreen","9ACD32");Rg.z0h=Da.a.JH("",0,"unset",1,"top",1,"middle",2,"bottom",3,"start",2,"baseline",1,"sub",3,"super",1,"initial",1,"inherit",2,"text-top",1,"text-bottom",3);Rg.x0h=Da.a.JH("",0,"initial",3,"inherit",
11,"nil",1,"dotted",5,"dashed",4,"solid",11,"double",6,"groove",7,"ridge",10,"inset",8,"outset",9,"none",1,"hidden",2);Object(n.a)(Rg,"DefaultHtmlTranslatorHelper",null,[]);class pH{constructor(){this.direction=null;this.A_b=new Wt}Q9f(){return!!this.direction&&0<this.direction.length}}Object(n.a)(pH,"LinearGradient",null,[]);class WB{constructor(){this.xyb=!1}}Object(n.a)(WB,"HtmlTranslatorContext",null,[]);class XB{constructor(a=!1,b=!1,c=!1,h=!1,m=!1,y=!1,G=!0,U=!1,ja=!0,va=!0,Ta=!0,fb=!1,Db=!1,
gc=!1,hc=!1,Gc=!1,Pc=!1,yc=!1,Vd=null,De=null,Wd=null,Ve=null,$e=null,Qf=null,lg=null){this.xyb=!1;this.kXh=a;this.pXh=b;this.hXh=c;this.oXh=h;this.c_h=m;this.a_h=y;this.WZh=G;this.XZh=U;this.ZZh=ja;this.$Zh=va;this.YZh=Ta;this.l_h=fb;this.A_h=Db;this.k_h=gc;this.o0h=hc;this.f_h=Gc;this.rSh=Pc;this.bTh=yc;this.e_h=Vd;this.j_h=De;this.b_h=$e;this.h_h=Wd;this.d_h=Ve;this.g_h=Qf;this.i_h=lg}get WYa(){return this.kXh}get Qyk(){return this.pXh}get a9g(){return this.hXh}get Pyk(){return this.oXh}get eth(){return this.c_h}get dth(){return this.a_h}get mcl(){return this.WZh}get ncl(){return this.XZh}get pcl(){return this.ZZh}get rcl(){return this.$Zh}get ocl(){return this.YZh}get a0a(){return this.f_h}get yEj(){return this.rSh}get ith(){return this.l_h}get bel(){return this.A_h}get zcl(){return this.k_h}get Dml(){return this.o0h}get gUa(){return this.bTh}get fth(){return this.e_h||
Object(F.a)(this,this.hld,"returnFalse")}get ycl(){return this.j_h||Object(F.a)(this,this.hld,"returnFalse")}get xcl(){return this.h_h||Object(F.a)(this,this.UQe,"returnTrue")}get tcl(){return this.d_h||Object(F.a)(this,this.UQe,"returnTrue")}get scl(){return this.b_h||Object(F.a)(this,this.hld,"returnFalse")}get wcl(){return this.g_h||Object(F.a)(this,this.UQe,"returnTrue")}get hth(){return this.i_h||Object(F.a)(this,this.hld,"returnFalse")}UQe(){return!0}hld(){return!1}}Object(n.a)(XB,"HtmlTranslatorSettings",
null,[303]);class qH extends Qm{constructor(a,b,c,h,m=null,y=0,G=0,U=null,ja=null){super(m?m.BU:null,m?m.iw:null,m?m.t5:null,m?m.cultureName:null,m?m.aia:null);this.src=a;this.alt=b;this.width=c;this.height=h;this.maxWidth=y;this.maxHeight=G;this.href=U;this.desc=ja}}Object(n.a)(qH,"ImageSemanticArgs",Qm,[]);class rH{constructor(a,b){this.Ejl=a;this.Djl=b}}Object(n.a)(rH,"IndentationProperties",null,[]);class jx extends Qm{constructor(a,b,c,h=0,m=-1,y=!1,G=!1,U="",ja="",va=null,Ta=-1){super(c?c.BU:
null,c?c.iw:null,c?c.t5:null,c?c.cultureName:null,c?c.aia:null);this.nif=a;this.FTb=0;this.aKd=b;this.JSb=1===b&&-1===m&&!this.B2a;this.jEd=h;this.kEd=m;this.HGd=y;this.B2a=G;this.u3a=U;this.znb=ja;this.Hvc=va;this.rvc=Ta;this.Xmb=-1;this.sEc=!0}get listStyleType(){return this.TNj?this.FTb:this.nif}get TNj(){return 0!==this.FTb}get Vkl(){return this.aKd}get listLevel(){return this.kEd}set listLevel(a){this.kEd=a}get listId(){return this.jEd}set listId(a){this.jEd=a}get jHb(){return this.HGd}set jHb(a){this.HGd=
a}get g8a(){return this.B2a}set g8a(a){this.B2a=a}get levelText(){return this.u3a}set levelText(a){this.u3a=a}get font(){return this.znb}set font(a){this.znb=a}get dQa(){return this.Hvc}set dQa(a){this.Hvc=a}get Trb(){return this.rvc}set Trb(a){this.rvc=a}get xhg(){return 6<=this.listStyleType}get THj(){return this.JSb}get GHi(){return this.sEc?this.aKd+this.Xmb:this.Xmb}clone(){const a=new jx(this.nif,this.aKd,new Qm(this.BU,this.iw,this.t5,this.cultureName,this.aia),this.jEd,this.kEd,this.HGd,this.B2a);
a.FTb=this.FTb;a.JSb=this.JSb;a.Xmb=this.Xmb;a.sEc=this.sEc;a.u3a=this.u3a;a.znb=this.znb;a.Hvc=this.Hvc;a.rvc=this.rvc;return a}Hdi(a,b,c){this.FTb=a;0<b?(this.JSb=!1,this.Xmb=b,this.sEc=!1):(this.Xmb++,this.JSb=!c)}}Object(n.a)(jx,"ListSemanticArgs",Qm,[]);class bz extends Qm{constructor(a,b,c,h,m=null,y=0,G=null,U=null,ja=!1,va=!1,Ta=69905,fb=null){super(fb?fb.BU:null,fb?fb.iw:null,fb?fb.t5:null,fb?fb.cultureName:null,fb?fb.aia:null);this.colSpan=a;this.rowSpan=b;this.width=c;this.Bzb=va;this.height=
h;this.sFa=ja;this.Ppc=m;this.verticalAlignment=y;this.f6=G;this.Tqd=U;this.vIc=Ta}}Object(n.a)(bz,"TableCellSemanticArgs",Qm,[]);class YB extends Qm{constructor(a,b=null){super(b?b.BU:null,b?b.iw:null,b?b.t5:null,b?b.cultureName:null,b?b.aia:null);this.height=a}}Object(n.a)(YB,"TableRowSemanticArgs",Qm,[]);class ZB extends Qm{constructor(a,b,c,h,m,y,G,U,ja,va=null,Ta=-1,fb=null){super(fb?fb.BU:null,fb?fb.iw:null,fb?fb.t5:null,fb?fb.cultureName:null,fb?fb.aia:null);this.lQa=null;this.BY=a;this.Nra=
b;this.width=c;if(m)for(this.lQa=Array(m.length),a=0;a<m.length;++a)this.lQa[a]=m[a];this.Beg=y;this.EZe=U;this.lIj=G;this.sFa=h;this.rce=ja;this.uyh=va;this.tableLook=Ta}}Object(n.a)(ZB,"TableSemanticArgs",Qm,[]);let Tr;class ul extends fh{constructor(a,b=null,c=null,h=null){super(a);this.z3a=null;this.SUh=Da.a.JH("none",1,"disc",3,"circle",4,"square",5,"1",7,"A",10,"a",8,"I",11,"i",9,"armenian",7,"decimal",7,"decimal-leading-zero",7,"georgian",7,"lower-alpha",8,"lower-greek",8,"lower-latin",8,"lower-roman",
9,"upper-alpha",10,"upper-latin",10,"upper-roman",11);this.Jc=b||new XB;this.zt=c||new WB;this.mEd=h}get ong(){return this.SUh}n1f(a,b){var c;if((c=a.style?a.style.listStyleType:"")&&""!==c&&(c=this.ong[ta.a.og(c)])||(c=fh.gta(a,"type"))&&""!==c&&(c=this.ong[c]))return c;if(this.Jc.WYa&&(c=a.tagName.toLowerCase())&&("ol"===c||"ul"===c)&&(a=a.className)&&""!==a)if("ul"===c)switch(a=ul.PTc(a,"BulletListStyle"),a){case "BulletListStyle1":return 3;case "BulletListStyle2":return 4;case "BulletListStyle3":return 5}else if("ol"===
c)switch(a=ul.PTc(a,"NumberListStyle"),a){case "NumberListStyle1":return 7;case "NumberListStyle2":return 8;case "NumberListStyle3":return 9;case "NumberListStyle4":return 10;case "NumberListStyle5":return 11}return b}g1f(a){let b=-1,c=a.tagName.toLowerCase();if("ol"===c||"ul"===c){a=La.a.y_f(a,"li");if(!a)return b;c="li"}if("li"===c){b=(b=this.vQc(a,"data-aria-level",0))?b:-1;if(0<b)return b-1;if(a=La.a.y_f(a,"p"))return ul.zaj(a)-1}return b}vQc(a,b,c){a=this.Jc.WYa?a.getAttribute(b):fh.gta(a,b);
a=parseInt(a);return isNaN(a)||0>a?c:a}Zpk(){this.z3a.pop();this.Hg.mna()}B6b(a,b){this.Bq(m=>m.FKa(0,0));const c=this.n1f(a.Wf,b?6:2);let h=1;b&&(h=this.vQc(a.Wf,"start",1));b=!1;this.Jc.WYa&&(b=a.Wf.getAttribute("data-pasteFromRc"),(b=!!b&&"true"===b)&&a.Wf.removeAttribute("data-pasteFromRc"),(v.a.wT||v.a.fg)&&ul.YIc(a.Wf));a=new jx(c,h,fh.uy(a),0,-1,b,this.Jc.WYa);this.z3a.push(a);this.Hg.ona(a);this.aD(Object(F.a)(this,this.Zpk,"onListElementClose"));return 1}reset(){super.reset();this.z3a=new ix}tph(a,
b){let c=!1;try{var h=b.getAttribute("xml:lang")||fh.gta(b,"lang")}catch(U){h=null}h&&""!==h&&(c=a.HTe(h)||c);(h=fh.gta(b,"dir"))&&(c=a.zLb(h)||c);if(h=b.style){if(h.fontWeight){var m=ta.a.FB(h.fontWeight),y=parseInt(m);isNaN(y)?"BOLD"===m?c=a.GH(!0)||c:"NORMAL"===m&&(c=a.GH(!1)||c):c=600<=y?a.GH(!0)||c:a.GH(!1)||c}this.Jc.dth&&!this.zt.xyb&&h.fontSize&&(m=fh.lij(h.fontSize),0<m&&(c=a.NKb(Math.floor(2*m))||c));this.Jc.xcl(this.zt)&&(this.Jc.ith&&b.getAttribute?(m=b.getAttribute("data-indent"))&&0<
m.length&&(m=$d.a.XJ(parseInt(m),0)+"px",c=a.god(m)||c):h.textIndent&&(c=a.god(h.textIndent)||c));this.Jc.tcl(this.zt)&&h.marginLeft&&(this.Jc.ith&&b.getAttribute?(m=b.getAttribute("data-margin"))&&0<m.length&&(c=a.ppc(h.marginLeft)||c):"TABLE"!==b.tagName&&(c=a.ppc(h.marginLeft)||c));this.Jc.scl(this.zt)&&h.lineHeight&&(c=a.m1(h.lineHeight)||c);if(this.Jc.ocl)if(m=h.fontVariantCaps?ta.a.og(h.fontVariantCaps):null,y=h.fontVariant?ta.a.og(h.fontVariant):null,"uppercase"===(h.textTransform?ta.a.og(h.textTransform):
null))c=a.fod("uppercase")||c;else if("small-caps"===m||y&&0<=y.indexOf("small-caps"))c=a.fod("small-caps")||c;this.Jc.wcl(this.zt)&&h.textAlign&&(c=a.Ajb(ta.a.og(h.textAlign))||c);h.fontStyle&&(m=ta.a.FB(h.fontStyle),"ITALIC"===m||"OBLIQUE"===m?c=a.H_a(!0)||c:"NORMAL"===m&&(c=a.H_a(!1)||c));m=ul.Ekj(b);if(h.textDecoration||m){y=ta.a.og(h.textDecoration||"");m=ta.a.og(m||"");if(b.parentNode&&b.parentNode.tagName&&"a"===ta.a.og(b.parentNode.tagName)){var G=(b.querySelector(".TextRun")||b).className;
G&&-1<G.indexOf("Underlined")&&(c=a.JY(!0)||c)}else if(h.fJl||ul.dE(y)||ul.dE(m))c=a.JY(!0)||c;if(h.eJl||ul.whg(y)||ul.whg(m))c=a.GY(!0)||c}if(h.verticalAlign){m=ta.a.FB(h.verticalAlign);if("SUB"===m||this.Jc.hth(this.zt)&&b.className&&-1<b.className.indexOf("Subscript"))c=a.R5(!0)||c;else if("SUPER"===m||this.Jc.hth(this.zt)&&b.className&&-1<b.className.indexOf("Superscript"))c=a.IY(!0)||c;this.Jc.dth&&("SUB"===m||"SUPER"===m)&&b.getAttribute&&(m=parseFloat(b.getAttribute("data-fontsize")),isNaN(m)||
(c=a.xTe(Math.floor(2*m))||c))}this.Jc.rcl&&h.fontFamily&&(this.Jc.gUa?c=this.wTe(a,h.fontFamily,c):this.Jc.zcl&&b.getAttribute?(m=b.getAttribute("data-usefontface"))&&"true"===m&&(c=this.wTe(a,h.fontFamily,c)):c=this.wTe(a,h.fontFamily,c));m=null;this.Jc.pcl&&h.color&&(m=Rg.Tia(h.color));y=!!m;this.Jc.ycl(this.zt)&&b.getAttribute&&(y=b.getAttribute("data-scheme-color"),m=null!==y?y:m,y="inherit"!=h.color&&(""!==m||!this.zt.xyb||ul.lUj(b)));y&&(c=a.Ls(m)||c);this.Jc.mcl&&!this.zt.xyb&&h.backgroundColor&&
(this.Jc.Qyk&&b.tagName&&ul.pol.contains(ta.a.FB(b.tagName))||(c=a.noa(Rg.Tia(h.backgroundColor))||c));if(this.Jc.ncl&&h.backgroundImage&&b.className&&-1<b.className.indexOf("Highlight")&&(h=ul.ymj(h.backgroundImage))&&0<h.A_b.count){m=h.A_b.ga(0).color;y=!0;for(G=0;G<h.A_b.count&&(y=y&&m===h.A_b.ga(G).color,y);G++);y&&(ba.ULS.sendTraceTag(41707206,307,50,"Paste text with highlight"),c=a.noa(Rg.Tia(m))||c)}}this.Jc.fth(this.zt)&&b.getAttribute&&(h=b.getAttribute("data-ccp-props"))&&(c=a.qoa(h)||c);
if(b.getAttribute){if(h=b.getAttribute("data-ccp-charstyle"))u.AFrameworkApplication.fk("Microsoft.Office.Web.SessionSettings.IWacWordCopyPasteParagraphCharacterStyleIdSettings"),this.Jc.a0a&&(c=a.Pfa(h)||c);if(b=b.getAttribute("data-ccp-parastyle"))u.AFrameworkApplication.fk("Microsoft.Office.Web.SessionSettings.IWacWordCopyPasteParagraphCharacterStyleIdSettings"),this.Jc.a0a&&(c=a.Lnd(b)||c)}return c}ael(a){if(this.Jc.bel)for(a=a.parentNode;a&&a.tagName;){if(a.className&&Object.getType(a.className)===
String&&-1<ta.a.FB(a.className).indexOf("MSOCOM"))return!0;if("DIV"===ta.a.FB(a.tagName))break;a=a.parentNode}return!1}wTe(a,b,c){b=this.K_f(b);return a.AKa(b,this.Jc.Dml)||c}N0(a,b){"\u200b"===a&&(a="\u00a0");b&&b.Wf&&this.ael(b.Wf)&&(a="");this.Hg.N0(a,fh.uy(b))}Xcd(a){const b=fh.gta(a.Wf,"href");return b&&""!==b?(this.Hg.Owa(b,fh.uy(a)),this.aD(Object(F.a)(this.Hg,this.Hg.Nwa,"onAnchorEnd")),1):2}cdd(){return this.Bq(a=>a.GH(!0))?1:2}idd(){return this.Bq(a=>a.z$d())?1:2}jdd(a){this.Hg.nA(fh.uy(a));
this.aD(Object(F.a)(this.Hg,this.Hg.mA,"onParagraphEnd"));return 1}kdd(a){this.Hg.lna(fh.uy(a))}ldd(a){this.Hg.nA(fh.uy(a));this.aD(Object(F.a)(this.Hg,this.Hg.mA,"onParagraphEnd"));return 1}rdd(){return this.Bq(a=>a.H_a(!0))?1:2}ndd(a){this.Bq(b=>b.Ajb("center"));this.Hg.nA(fh.uy(a));this.aD(Object(F.a)(this.Hg,this.Hg.mA,"onParagraphEnd"));return 1}tdd(){return this.Bq(a=>a.AKa("consolas"))?1:2}xdd(){return this.Bq(a=>a.GY(!0))?1:2}wdd(a){return this.B6b(a,!1)}zdd(){return this.Bq(a=>a.H_a(!0))?
1:2}Add(a){return this.B6b(a,!1)}Cdd(a){var b=a.Wf.getAttribute("data-render-src");const c=a.Wf.getAttribute("data-render-method");if(b&&""!==b&&c&&""!==c){const G=a.Wf.getAttribute("data-render-fallback");let U=0,ja=0;if(a.Wf.currentStyle){var h=a.Wf.currentStyle.width,m=a.Wf.currentStyle.height;h&&-1!==h.indexOf("px")&&(h=parseInt(ta.a.substring(h,0,h.indexOf("px"))),isNaN(h)||(U=h));m&&-1!==m.indexOf("px")&&(m=parseInt(ta.a.substring(m,0,m.indexOf("px"))),isNaN(m)||(ja=m))}a=new mH(b,c,G,U,ja,
fh.uy(a));this.Hg.IYa(a);return 2}this.Jc.WYa&&(v.a.wT||v.a.fg)&&(b=a.Wf.className.match(RegExp("^SCX[0-9a-zA-Z]+$")),this.Jc.WYa&&b&&b.length&&ul.YIc(a.Wf));const y=a.Wf.getAttribute("align");this.Bq(G=>G.Ajb(y));this.Hg.nA(fh.uy(a));this.aD(Object(F.a)(this.Hg,this.Hg.mA,"onParagraphEnd"));return 1}Ddd(a){this.Hg.nA(fh.uy(a));this.aD(Object(F.a)(this.Hg,this.Hg.mA,"onParagraphEnd"));return 1}Edd(a){this.Hg.nA(fh.uy(a));this.aD(Object(F.a)(this.Hg,this.Hg.mA,"onParagraphEnd"));return 1}Hdd(){return this.Bq(a=>
a.H_a(!0))?1:2}Pdd(a){return this.Bq(b=>{var c=this.K_f(a.Wf.getAttribute("face"));c=b.AKa(c);b=b.Ls(Rg.Tia(a.Wf.getAttribute("color")));return c||b})?1:2}Udd(a){this.Bq(b=>this.Jc.a0a?b.M_a(1):b.N_a(1));this.Hg.nA(fh.uy(a));this.aD(Object(F.a)(this.Hg,this.Hg.mA,"onParagraphEnd"));return 1}Vdd(a){this.Bq(b=>this.Jc.a0a?b.M_a(2):b.N_a(2));this.Hg.nA(fh.uy(a));this.aD(Object(F.a)(this.Hg,this.Hg.mA,"onParagraphEnd"));return 1}Wdd(a){this.Bq(b=>this.Jc.a0a?b.M_a(3):b.N_a(3));this.Hg.nA(fh.uy(a));this.aD(Object(F.a)(this.Hg,
this.Hg.mA,"onParagraphEnd"));return 1}Xdd(a){this.Bq(b=>this.Jc.a0a?b.M_a(4):b.N_a(4));this.Hg.nA(fh.uy(a));this.aD(Object(F.a)(this.Hg,this.Hg.mA,"onParagraphEnd"));return 1}Ydd(a){this.Bq(b=>this.Jc.a0a?b.M_a(5):b.N_a(5));this.Hg.nA(fh.uy(a));this.aD(Object(F.a)(this.Hg,this.Hg.mA,"onParagraphEnd"));return 1}Zdd(a){this.Bq(b=>this.Jc.a0a?b.M_a(6):b.N_a(6));this.Hg.nA(fh.uy(a));this.aD(Object(F.a)(this.Hg,this.Hg.mA,"onParagraphEnd"));return 1}$dd(a){this.Hg.lna(fh.uy(a))}bed(a){var b=a.Wf;const c=
b.src,h=b.alt,m=b.UHl;let y=0,G=0;b.style&&(y=fh.ota(b.style.width),G=fh.ota(b.style.height));y&&G||(y=b.width,G=b.height);let U=b=0;a.Wf.currentStyle&&(y||G||(y=fh.ota(a.Wf.currentStyle.width),G=fh.ota(a.Wf.currentStyle.height)),b=fh.ota(a.Wf.currentStyle.maxWidth),U=fh.ota(a.Wf.currentStyle.maxHeight));a=new qH(c,h,y,G,fh.uy(a),b,U,m);this.Hg.kna(a)}aed(){return this.Bq(a=>a.H_a(!0))?1:2}ced(){return this.Bq(a=>a.JY(!0))?1:2}ded(){return this.Bq(a=>a.AKa("consolas"))?1:2}fed(a){this.Hg.nA(fh.uy(a));
this.aD(Object(F.a)(this.Hg,this.Hg.mA,"onParagraphEnd"));return 1}hed(a){this.Hg.nA(fh.uy(a));this.aD(Object(F.a)(this.Hg,this.Hg.mA,"onParagraphEnd"));return 1}ied(a){let b;const c=this.n1f(a.Wf,0);let h=this.vQc(a.Wf,"value",0);var m=!1;0<this.z3a.count?b=this.z3a.peek():(b=new jx(2,1,fh.uy(a)),h||(h=1));if(this.Jc.WYa){m=b.listLevel;let ja=b.listId;this.Jc.eth?(m=this.g1f(a.Wf),m=0>m&&0>b.listLevel&&0<this.z3a.count?b.listLevel=this.z3a.count-1:b.listLevel=0<=m?m:b.listLevel,this.mEd&&this.mEd.b<
m&&(this.mEd.b=m)):0>m&&(m=b.listLevel=this.g1f(a.Wf));1>ja&&(ja=b.listId=this.vQc(a.Wf,"data-listid",0));a.Wf.getAttribute("data-leveltext")&&(b.levelText=a.Wf.getAttribute("data-leveltext"));var y=a.Wf.getAttribute("data-font");y&&(b.font=y);y=!1;u.AFrameworkApplication.fa&&(y=u.AFrameworkApplication.fa.ka("FollowDestinationThemePasteIsEnabled"));if(y){var G=a.Wf.getAttribute("data-charcodes");y=[];if(G&&""!==G)if(-1<G.indexOf(",")){G=G.split(",");for(var U=0;U<G.length;U++)Array.add(y,parseInt(G[U]))}else Array.add(y,
parseInt(G));if(y&&0<y.length){G=Array(y.length);for(U=0;U<y.length;U++)G[U]=y[U];b.dQa=G}(y=a.Wf.getAttribute("data-buAutoNum"))&&0<y.length&&(b.Trb=parseInt(y))}(m=0<=m&&0<ja)&&ul.YIc(a.Wf)}b.Hdi(c,h,m);this.Hg.Swa(b.clone());this.aD(Object(F.a)(this.Hg,this.Hg.nna,"onListItemEnd"));return 1}tGb(a){return this.B6b(a,!1)}ned(a){if(this.Bq(b=>b.gLb(!0))){const b=a.Wf.getAttribute("OuterHtml");this.Hg.Twa(b,fh.uy(a));this.aD(Object(F.a)(this.Hg,this.Hg.WIa,"onMathEnd"))}return 1}ved(a){return this.B6b(a,
!0)}zed(a){this.Hg.nA(fh.uy(a));this.aD(Object(F.a)(this.Hg,this.Hg.mA,"onParagraphEnd"));return 1}Ced(a){const b=a.Wf.getAttribute("align");this.Bq(c=>c.Ajb(b));if(this.Jc.WYa){const c=a.Wf.parentNode;c&&c.tagName.toLowerCase().startsWith("li")&&ul.YIc(a.Wf,v.a.wT||v.a.fg)}this.Hg.nA(fh.uy(a));this.aD(Object(F.a)(this.Hg,this.Hg.mA,"onParagraphEnd"));return 1}Oed(){this.Bq(a=>a.AKa("consolas"));this.Hg.HYa();this.aD(Object(F.a)(this.Hg,this.Hg.GYa,"onPreFormattedTextEnd"));return 1}Wed(){return this.Bq(a=>
a.GY(!0))?1:2}Xed(){return this.Bq(a=>a.AKa("consolas"))?1:2}ffd(){return this.Bq(a=>a.oXe())?1:2}gfd(a){var b=a.Wf.attributes.getNamedItem("style"),c="";b&&b.value&&(c=b.value);b=Rg.Yxk(c);if(0<b&&this.Jc.yEj){for(c=0;c<b;c++)this.Hg.NYa(fh.uy(a));return 3}return 2}hfd(){return this.Bq(a=>a.GY(!0))?1:2}ifd(){return this.Bq(a=>a.GH(!0))?1:2}jfd(){return this.Bq(a=>a.R5(!0))?1:2}kfd(){return this.Bq(a=>a.IY(!0))?1:2}ofd(a){this.Bq(Ta=>Ta.clearFormatting()&&Ta.tQe());Rg.yUc(a.Wf,this);const b=Rg.Zwb(a.Wf),
c=Rg.hYf(a.Wf),h=Rg.W6d(a.Wf),m=Rg.X6d(a.Wf),y=!parseInt(fh.gta(a.Wf,"border")),G=Rg.PTj(a.Wf);let U=-1,ja="";var va=-1;a.Wf.attributes.hasOwnProperty("style")&&-1!==(va=a.Wf.attributes.getNamedItem("style").value.indexOf("mso-yfti-tbllook:"))?U=parseInt(a.Wf.attributes.getNamedItem("style").value.substr(va+17)):a.Wf.attributes.hasOwnProperty(oa.a.cYd.toString())&&(U=parseInt(a.Wf.attributes.getNamedItem(oa.a.cYd.toString()).value));va=-1;a.Wf.attributes.hasOwnProperty("class")&&-1!==(va=a.Wf.attributes.getNamedItem("class").value.indexOf("Mso"))?
ja=a.Wf.attributes.getNamedItem("class").value.substr(va).split(" ")[0]:a.Wf.attributes.hasOwnProperty(oa.a.dYd.toString())&&(ja=a.Wf.attributes.getNamedItem(oa.a.dYd.toString()).value);this.Hg.mY(new ZB(0,0,b.value,b.rjg,null,y,G,c,new rH(h.value,m.value),ja,U,fh.uy(a)));this.aD(Object(F.a)(this.Hg,this.Hg.jY,"onTableEnd"));u.AFrameworkApplication.fk("Microsoft.Office.Web.SessionSettings.IWacWordPasteTableCellMarginImprovementsSettings");return 1}Sjc(a){const b=Rg.k9a(a.Wf),c=Rg.Zwb(a.Wf);if(!c.value&&
c.AYc&&(u.AFrameworkApplication.fk("Microsoft.Office.Web.SessionSettings.IWacWordPasteComplexTablesSettings"),this.Jc.a9g))return 3;let h=parseInt(fh.gta(a.Wf,"colSpan"));if(void 0===h||null===h||""===h+"")h=c.value?1:0;let m=parseInt(fh.gta(a.Wf,"rowSpan"));if(void 0===m||null===m||""===m+"")m=b.value?1:0;let y=!1;a.Wf.attributes.hasOwnProperty("style")&&(y=-1!==a.Wf.attributes.getNamedItem("style").value.indexOf("mso-cell-special:placeholder")||-1!==a.Wf.attributes.getNamedItem("style").value.indexOf("mso-cell-special: placeholder"));
!y&&a.Wf.attributes.hasOwnProperty("class")&&(y=-1!==a.Wf.attributes.getNamedItem("class").value.indexOf("SkippedGhostCell"));let G=69905;if(a.Wf.attributes.hasOwnProperty(oa.a.bYd.toString())){var U=parseInt(a.Wf.attributes.getNamedItem(oa.a.bYd.toString()).value);isNaN(U)||(G=U)}U=Rg.Tia(a.Wf.style.backgroundColor);const ja=Rg.Dmj(a.Wf);this.Bq(fb=>fb.FKa(0,0));Rg.yUc(a.Wf,this);const va=Rg.hYf(a.Wf),Ta=this.Jc.Pyk?Rg.o3i(a.Wf):null;a=new bz(h,m,c.value,b.value,U,ja,va,Ta,c.rjg,y,G,fh.uy(a));this.Hg.iY(a);
this.aD(Object(F.a)(this.Hg,this.Hg.hY,"onTableCellEnd"));this.wkk();return 1}pfd(a){const b=this.Sjc(a);if(3===b)return b;this.Bq(c=>{const h=c.GH(!0);c=c.Ajb("center");return h||c});Rg.yUc(a.Wf,this);return 1}qfd(a){Rg.yUc(a.Wf,this);const b=Rg.k9a(a.Wf);if(b.AYc&&!b.value&&(u.AFrameworkApplication.fk("Microsoft.Office.Web.SessionSettings.IWacWordPasteComplexTablesSettings"),this.Jc.a9g))return 3;this.Hg.lY(new YB(b.value,fh.uy(a)));this.aD(Object(F.a)(this.Hg,this.Hg.kY,"onTableRowEnd"));return 1}tfd(){return this.Bq(a=>
a.AKa("consolas"))?1:2}ufd(){return this.Bq(a=>a.JY(!0))?1:2}vfd(a){return this.B6b(a,!1)}xfd(){return this.Bq(a=>a.JY(!0))?1:2}E7i(a){if(!a)return null;a=a.split(",");return this.Jc.gUa&&a[0].startsWith("WordVisi")&&1<a.length?a[1].trim():a[0]}static Zsl(a){if(!a)return null;a=ta.a.XOe(a,'"');return a=ta.a.XOe(a,"'")}K_f(a){if(!a)return null;a=this.E7i(a);return a=ul.Zsl(a)}static Arf(a,b){b=b.trim();var c=b.match(RegExp("^-?[0-9]+deg$"));if(c&&0<c.length){if(a.Q9f())return!1;a.direction=b;return!0}if((c=
b.match(RegExp("^to +(left|right|top|bottom|lefttop|leftbottom|righttop|rightbottom)$")))&&0<c.length){if(a.Q9f())return!1;a.direction=b;return!0}var h=(c=b.match(RegExp("^rgb\\(.*\\)")))&&0<c.length?b.indexOf(")")+1:b.indexOf(" ");c=-1===h?b:Rg.Tia(b.substr(0,h).trim());if(!c||""===c)return!1;b=-1===h?"":b.substr(h).trim();h=new nH;h.color=c;h.stop=b;a.A_b.add(h);return!0}static ymj(a){try{if(!a)return null;a=a.trim();if(!a.startsWith("linear-gradient(")||!a.endsWith(")"))return null;let b=a.substr(16);
b=b.substr(0,b.lastIndexOf(")"));const c=new pH;for(;0<b.trim().length;){let h=b.indexOf(",");const m=b.indexOf("(");if(0<m&&m<h){const y=b.indexOf(")");if(y<m)return null;h=b.indexOf(",",y)}if(-1===h){if(!ul.Arf(c,b))return null;b=""}else{const y=b.substr(0,h);b=b.substr(h+1);if(!ul.Arf(c,y))return null}}return c}catch(b){return null}}static PTc(a,b){a=a.split(" ");if(0<a.length)for(let c=0;c<a.length;c++)if(0<=a[c].indexOf(b))return a[c];return""}static YIc(a,b=!1){a&&3!==a.nodeType&&(a.style.margin=
"",b&&ul.gDf(a,b))}static gDf(a,b){if(a)for(a=a.firstChild;a;)3!==a.nodeType&&(a.style&&(a.style.margin=""),b&&ul.gDf(a,b)),a=a.nextSibling}static zaj(a){if("p"!==a.tagName.toLowerCase())return-1;if((a=a.getAttribute("style"))&&0<a.length&&-1!==a.indexOf("mso-list")){a=a.split(";");for(let c=0;c<a.length;c++){var b=a[c].split(":");if(2===b.length&&"mso-list"===b[0].trim()&&(b=b[1].trim().split(" "),3===b.length))return Number.parseInvariant(b[1].substr(5))}}return-1}static lUj(a){return!(void 0===
a.className||null===a.className)&&a.className.startsWith("TextRun")}static Ekj(a){a=a.style.textDecorationLine;return void 0===a||null===a?null:a}static whg(a){return 0<=a.indexOf("line-through")}static dE(a){return 0<=a.indexOf("underline")}}ul.pol=(Tr=new Qa.a,Tr.add("TABLE"),Tr.add("THEAD"),Tr.add("TBODY"),Tr.add("TFOOT"),Tr.add("TR"),Tr.add("TH"),Tr.add("TD"),Tr);Object(n.a)(ul,"DefaultHtmlTranslator",fh,[]);var Bm=d(309);class Qj{constructor(a=null){this.uS=a||Bm.a.b$d("");this.xAc=Number.parseInvariant((new Date).format("HHmmss"))}get Mb(){return this.uS}process(a,
b){if(a&&a.querySelectorAll){const y=a.querySelectorAll("p");if(y&&0<y.length){for(var c=0,h=!1,m=y[0].parentNode;5>c&&m&&m!==a;){c++;const G=m.id.toLowerCase();if(G&&G.length&&-1!==G.indexOf("_editingelement")&&Sys.UI.DomElement.containsCssClass(m,"WACEditing")&&Sys.UI.DomElement.containsCssClass(m,"EditingSurfaceBody")){h=!0;break}m=m.parentNode}if(h&&m!==a){c=a.firstChild;for(h=!1;0<m.children.length&&m.children[0]!==c;)a.insertBefore(m.children[0],c),h=!0;if(h)for(;c;)m=c.nextSibling,a.removeChild(c),
c=m}a=new Sh.a(b,Object(F.a)(this,this.QKe,"processNodesDiscovery"),new TB(y));a.Nl("Word Converter Operation");a.Oi=!b||b.Oi;a.run()}}}QKe(a,b){const c=b.nodes[b.W2];var h=Qj.H6d(c);if(h){let y=h.hMa.replace(RegExp("level[0-9]"),"").trim();y=y&&y.length?y:h.hMa;let G=b.lists[y];G||(G=new iH,G.$Y=this.xAc++);let U=G.jAb[h.level-1];U||(U=new jH,U.level=h.level);var m=c.parentNode;if(m&&"li"===m.tagName.toLowerCase()){if(m=m.parentNode)!(m=m.tagName.toUpperCase())||"OL"!==m&&"UL"!==m||(U.tagName=m)}else U.jYa=
Qj.p_f(c,5),U.jYa&&U.jYa.length||(U.jYa=Qj.i9d(c,5)),U.ignore=!U.jYa||!U.jYa.length,U.tagName=Qj.ERc(U.jYa);h.$Y=G.$Y;U.Qic++;U.ignore||"li"===c.parentNode.tagName.toLowerCase()||(m=(m=Qj.i9d(c,5))?m:U.jYa)&&m.length&&(h.MUi=m,(m=Qj.n7k(c,m,U.listStyle,h.level-1))&&m.length&&(U.listStyle=m));b.i9[b.i9.length]=h;U.i9.contains(h)||U.i9.add(h);if(void 0===G.jAb[h.level-1]||null===G.jAb[h.level-1]||G.jAb[h.level-1]!==U)G.jAb[h.level-1]=U;b.lists[y]&&b.lists[y]===G||(b.lists[y]=G);b.Zzb=c}else if((h=b.Zzb)&&
Qj.p5b(c)===h&&c.tagName===h.tagName&&c.className===h.className){h.appendChild(h.ownerDocument.createElement("BR"));for(h.appendChild(h.ownerDocument.createElement("BR"));c.firstChild;)h.appendChild(c.firstChild);c.parentNode.removeChild(c)}b.W2++;if(b.nodes.length<=b.W2){if(!b.i9.length)return!1;b.W2=0;a.$g(Object(F.a)(this,this.PKe,"processNodeConvert"))}return!0}PKe(a,b){a=b.i9[b.W2];var c=a.ekc,h=a.hMa.replace(RegExp("level[0-9]"),"").trim();h=h&&h.length?h:a.hMa;h=b.lists[h];var m=h.jAb[a.level-
1],y=c.parentNode.tagName.toLowerCase();if(!m.ignore&&c.parentNode&&"li"!==y){if(y=Qj.pDi(c,m)){Qj.e_b(c,5);const G=c.ownerDocument.createElement("LI");G.setAttribute("data-aria-level",String.format("{0}",a.level));for(G.setAttribute("data-listid",String.format("{0}",h.$Y));c.firstChild;)G.appendChild(c.firstChild);y.appendChild(G);c.parentNode.removeChild(c);"UL"===m.tagName?this.Mb.b++:this.Mb.c++}}else"li"===y&&(m=m.tagName,c=c.parentNode,a.jHb&&(a=c.parentNode)&&a.tagName.toUpperCase()===m&&a.setAttribute("data-pasteFromRc",
"true"),c.setAttribute("data-listid",String.format("{0}",h.$Y)),"UL"===m?this.Mb.b++:this.Mb.c++);b.W2++;return b.W2<b.i9.length}static pDi(a,b){a=Qj.mDi(a,b.tagName);return Qj.HVd(a,b)}static HVd(a,b){if(b.tagName!==a.tagName){for(b=a.ownerDocument.createElement(b.tagName);a.firstChild;)b.appendChild(a.firstChild);a.parentNode.insertBefore(b,a);a.parentNode.removeChild(a);a=b}return a}static mDi(a,b){b=a.ownerDocument.createElement(b?b:"UL");var c=a.getAttribute("start");c&&0<c.length&&(b.setAttribute("start",
c),a.removeAttribute("start"));(c=a.className)&&0<c.length&&(c="OL"===b.tagName?ul.PTc(c,"NumberListStyle"):ul.PTc(c,"BulletListStyle"),0<c.length&&(Sys.UI.DomElement.addCssClass(b,c),Sys.UI.DomElement.removeCssClass(a,c)));a.parentNode.insertBefore(b,a);return b}static e_b(a,b){for(let c=0;c<a.childNodes.length;c++){const h=a.childNodes[c];1===h.nodeType&&1<b&&Qj.e_b(h,b-1);if(Qj.Yhe(h)||Qj.f9b(h))a.removeChild(h),c--}}static H6d(a){if(1===a.nodeType){var b=Qj.O5b(a,"mso-list");if(b&&0<b.length)try{var c=
b.split(" ");if(3===c.length){var h=new $y;h.level=Number.parseInvariant(c[1].substr(5));h.hMa=b;h.ekc=a;h.jHb=!0;return h}}catch(m){}else if((c=a.parentNode)&&"li"===c.tagName.toLocaleLowerCase()&&(b=c.getAttribute("data-"+zc.a.CYb),c=c.getAttribute("data-listid"),b&&c&&0<b.length&&0<c.length))return h=new $y,h.level=Number.parseInvariant(b),h.hMa=c+" level"+b,h.ekc=a,h.jHb=!1,h}return null}static n7k(a,b,c,h){if("p"===a.tagName.toLowerCase()&&b&&b.length){if("UL"===Qj.ERc(b))return c=Qj.Z2i(b),
Sys.UI.DomElement.addCssClass(a,c),c;var m;return(m=b.match(RegExp("^[0-9]+")))&&m.length?(c="NumberListStyle1",Sys.UI.DomElement.addCssClass(a,c),a.setAttribute("start",m[0]),c):(m=b.match(RegExp("^[a-zA-Z]+")))&&m.length&&(m=m[0],h=(b=m.match(RegExp("^[ivxlcdmIVXLCDM]+")))&&b.length?Qj.Vfj(c,h):1,1!==h&&((c=Qj.gKc(a,m,RegExp("^[ivxlcdm]+"),ta.a.wGf,"NumberListStyle3"))||(c=Qj.gKc(a,m,RegExp("^[IVXLCDM]+"),ta.a.wGf,"NumberListStyle5")))||h&&((c=Qj.gKc(a,m,RegExp("^[a-z]+"),ta.a.vGf,"NumberListStyle2"))||
(c=Qj.gKc(a,m,RegExp("^[A-Z]+"),ta.a.vGf,"NumberListStyle4"))))?c:"NumberListStyle1"}return null}static Z2i(a){switch(a){case "o":return"BulletListStyle2";case "\u00a7":return"BulletListStyle3";default:return"BulletListStyle1"}}static Vfj(a,b){a&&a.length||(a="");switch(a){case "NumberListStyle2":case "NumberListStyle4":a=1;break;case "NumberListStyle3":case "NumberListStyle5":a=0;break;default:a=-1}if(0>a)switch(b%3){case 0:a=0;break;case 1:a=1;break;case 2:a=0;break;default:a=0}return a}static gKc(a,
b,c,h,m){return(b=b.match(c))&&b.length?(h=h(b[0]),h=1>h?1:h,Sys.UI.DomElement.addCssClass(a,m),a.setAttribute("start",h+""),m):null}static ERc(a){return a&&"o"!==a&&"\u00b7"!==a&&"\u00a7"!==a&&"-"!==a?"OL":"UL"}static i9d(a,b){let c=null;var h;let m,y;for(let G=-1;!c&&G<a.childNodes.length;G++){const U=-1===G?a:a.childNodes[G];if(U)if((h=U.innerHTML)&&0<h.length){if(m=h.indexOf("\x3c!--[if !supportLists]--\x3e"),0<=m&&(y=h.indexOf("\x3c!--[endif]--\x3e"),0<=y)){h=h.substring(m,y+14);U.innerHTML=
U.innerHTML.replace(h,"");if(h.length){a=a.ownerDocument.createElement("span");a.innerHTML=h;c=a.innerText.trim();break}c&&c.length||(c="o")}}else 0<=G&&1===U.nodeType&&1<b&&(c=Qj.i9d(U,b-1))}return c}static p_f(a,b){let c=null;for(let h=0;!c&&h<a.childNodes.length;h++){const m=a.childNodes[h];Qj.f9b(m)?(c="string"===typeof m.innerText?m.innerText.trim():m.textContent.trim(),c.length||(c="o"),m.parentNode.removeChild(m)):1===m.nodeType&&1<b&&(c=Qj.p_f(m,b-1))}return c}static f9b(a){return 1===a.nodeType&&
(a=Qj.O5b(a,"mso-list"))&&0<a.length&&"ignore"===a.trim().toLowerCase()?!0:!1}static Yhe(a){return 1===a.nodeType&&!a.firstChild&&"SPAN"===a.tagName.toUpperCase()}static O5b(a,b){if((a=a.getAttribute("style"))&&0<a.length&&-1!==a.indexOf(b)){a=a.split(";");for(let c=0;c<a.length;c++){const h=a[c].split(":");if(2===h.length&&h[0].trim()===b)return h[1].trim()}}return null}static p5b(a){do a=a.previousSibling;while(a&&Qj.S8b(a));return a}static S8b(a){return a?3===a.nodeType?(a=a.nodeValue,a=a.replace(Qj.hEd,
""),!a.trim().length):1!==a.nodeType||a.firstChild!==a.lastChild||"SPAN"!==a.tagName&&"FONT"!==a.tagName?!1:Qj.S8b(a.firstChild):!0}}Qj.hEd=RegExp("[\n|\r]","gi");Object(n.a)(Qj,"WacAndRichClientWordConverter",null,[1148]);class sH{constructor(){this.$Y=0;this.tagName="UL";this.z3b=null;this.ignore=!1;this.Qic=0}}Object(n.a)(sH,"ListMetadata",null,[]);class el{constructor(a=null){this.xAc=1;this.uS=a||Bm.a.b$d("")}get Mb(){return this.uS}process(a,b){a&&a.querySelectorAll&&(a=a.querySelectorAll("p"))&&
0<a.length&&(a=new Sh.a(b,Object(F.a)(this,this.QKe,"processNodesDiscovery"),new TB(a)),a.Nl("Word Converter Operation"),a.Oi=!b||b.Oi,a.run())}QKe(a,b){const c=b.nodes[b.W2];var h=el.H6d(c);if(h){let m=b.cja[h.level-1];m||(m=new SB,b.cja[h.level-1]=m);b.Zzb&&el.p5b(c)!==b.Zzb&&el.BXk(b);let y=m.ung[h.hMa];if(!y)y=new sH,y.$Y=this.xAc++,y.z3b=el.w5d(c,5),y.ignore=!y.z3b||!y.z3b.length,y.tagName=el.ERc(y.z3b),m.ung[h.hMa]=y,b.lists[y.$Y.toString()]=y;else if(!y.ignore&&1===y.Qic){const G=el.w5d(c,
5);y.tagName=y.z3b===G?"UL":"OL"}h.$Y=y.$Y;y.ignore||"OL"===y.tagName&&0<y.Qic&&m.zLc!==h.$Y?(y.ignore=!0,b.cja[0].zLc=-1,b.cja=b.cja.slice(0,1)):(b.cja.length>h.level&&(b.cja=b.cja.slice(0,h.level)),m.zLc=h.$Y,b.i9[b.i9.length]=h,y.Qic++);b.Zzb=c}else if((h=b.Zzb)&&el.p5b(c)===h&&c.tagName===h.tagName&&c.className===h.className){h.appendChild(h.ownerDocument.createElement("BR"));for(h.appendChild(h.ownerDocument.createElement("BR"));c.firstChild;)h.appendChild(c.firstChild);c.parentNode.removeChild(c)}b.W2++;
if(b.nodes.length<=b.W2){if(!b.i9.length)return!1;b.W2=0;a.$g(Object(F.a)(this,this.PKe,"processNodeConvert"))}return!0}PKe(a,b){var c=b.i9[b.W2];a=c.ekc;const h=b.lists[c.$Y.toString()];if(!h.ignore&&(c=el.cdj(a,c,h))){el.e_b(a,5);const m=a.ownerDocument.createElement("LI");for(;a.firstChild;)m.appendChild(a.firstChild);c.appendChild(m);a.parentNode.removeChild(a);"UL"===h.tagName?this.Mb.b++:this.Mb.c++}b.W2++;return b.W2<b.i9.length}static cdj(a,b,c){let h=el.wfh(a,b.level,c);const m=Y.a.ye(h,
"UniqueListId");if(m&&m!==b.$Y||!m&&h.firstChild)a=a.ownerDocument.createElement(c.tagName),h.parentNode.insertBefore(a,h.nextSibling),h=a;Y.a.Lv(h,"UniqueListId",b.$Y);return el.HVd(h,c)}static HVd(a,b){if(b.tagName!==a.tagName){b=a.ownerDocument.createElement(b.tagName);for(Y.a.Lv(b,"UniqueListId",Y.a.ye(a,"UniqueListId"));a.firstChild;)b.appendChild(a.firstChild);a.parentNode.insertBefore(b,a);a.parentNode.removeChild(a);a=b}return a}static wfh(a,b,c){let h=null,m;1===b?m=el.p5b(a):(h=el.wfh(a,
b-1,null),m=h.lastChild);if(m&&1===m.nodeType){const y=m.tagName.toUpperCase();if("UL"===y||"OL"===y)return m}c=a.ownerDocument.createElement(c?c.tagName:"UL");1===b?a.parentNode.insertBefore(c,a):h.appendChild(c);return c}static e_b(a,b){for(let c=0;c<a.childNodes.length;c++){const h=a.childNodes[c];1===h.nodeType&&1<b&&el.e_b(h,b-1);if(el.Yhe(h)||el.f9b(h))a.removeChild(h),c--}}static H6d(a){if(1===a.nodeType){const b=el.O5b(a,"mso-list");if(b&&0<b.length)try{const c=b.split(" ");if(3===c.length){const h=
new $y;h.level=Number.parseInvariant(c[1].substr(5));h.hMa=b;h.ekc=a;return h}}catch(c){}}return null}static ERc(a){return"o"!==a&&"\u00b7"!==a&&"\u00a7"!==a&&"-"!==a?"OL":"UL"}static w5d(a,b){let c=null;for(let h=0;!c&&h<a.childNodes.length;h++){const m=a.childNodes[h];el.f9b(m)?(c="string"===typeof m.innerText?m.innerText.trim():m.textContent.trim(),c.length||(c="o")):1===m.nodeType&&1<b&&(c=el.w5d(m,b-1))}return c}static f9b(a){return 1===a.nodeType&&(a=el.O5b(a,"mso-list"))&&0<a.length&&"ignore"===
a.trim().toLowerCase()?!0:!1}static Yhe(a){return 1===a.nodeType&&!a.firstChild&&"SPAN"===a.tagName.toUpperCase()}static O5b(a,b){if((a=a.getAttribute("style"))&&0<a.length&&-1!==a.indexOf(b)){a=a.split(";");for(let c=0;c<a.length;c++){const h=a[c].split(":");if(2===h.length&&h[0].trim()===b)return h[1].trim()}}return null}static p5b(a){do a=a.previousSibling;while(a&&el.S8b(a));return a}static S8b(a){return a?3===a.nodeType?(a=a.nodeValue,a=a.replace(el.hEd,""),!a.trim().length):1!==a.nodeType||
a.firstChild!==a.lastChild||"SPAN"!==a.tagName&&"FONT"!==a.tagName?!1:el.S8b(a.firstChild):!0}static BXk(a){for(let b=0;b<a.cja.length;b++){const c=a.cja[b];c&&(c.zLc=-1)}}}el.hEd=RegExp("[\n|\r]","gi");Object(n.a)(el,"WordConverter",null,[1148]);class $B{constructor(a){this.B2a=a.ka("ExternalPasteImprovementsEnabled")&&a.ka("ListMarkerIsEnabled")}get g8a(){return this.B2a}create(a=null){return this.B2a?new Qj(a):new el(a)}}Object(n.a)($B,"Box4WordConverterFactory",null,[1130]);var tH=d(698);class uH{constructor(a,
b,c,h,m){this.$9e=0;this.ld=a;this.yd=b;this.uxd=m;this.BZ=c;this.NOa=h}Uqi(a,b,c){ba.ULS.sendTraceTag(9037318,307,50,"ClipboardOperation ran into Setup: {0}; {1}; {2}",b,c,this.yd.Ly);a.Oi&&this.yd.Uj&&window.chrome&&ba.ULS.sendTraceTag(18354842,307,15,"ClipboardOperation isn't called async when using system clipboard and Chrome extension: {0}",b);this.BZ.Fca(!!(b&16));this.NOa.create(a,Object(F.a)(this,this.g4e,"waitingForEnsureAccessOperationResult"),null).Nl("ClipboardPreProcess");this.$9e=Date.now()}aYk(){this.BZ.reset()}g4e(a){let b=
!0;const c=this.BZ.lRi,h=null==this.BZ.SQi;null!=c?(a.r5=c,b=!1):Date.now()-this.$9e>this.uxd&&!h&&(ba.ULS.sendTraceTag(18354843,307,50,null),this.ld.Wb(Ed.a.vja,{["Reason"]:Cd.a.z7g}),b=a.r5=!1);return b}}Object(n.a)(uH,"ClipboardOperationClipboardAccessHelper",null,[1033]);class cz{constructor(a,b,c,h,m,y,G,U,ja,va,Ta,fb,Db,gc,hc){this.Ca=a;this.ld=b;this.Zr=c;this.Di=h;this.Tc=m;this.BZ=y;this.pr=G;this.hf=U;this.Eha=ja;this.rK=va;this.Fha=Ta;this.bpb=fb;this.x4a=Db;this.hk=hc;this.ySb=gc?gc.ka("ImageDataURLSkippedForSafari12IsEnabled"):
!1;this.USb=gc?gc.ka("PasteKeepSourceFontSizeFixIsEnabled"):!1;this.fTb=gc?gc.ka("TextLayoutServiceUseResponse"):!1}get Ph(){return this.Di}get Wc(){return this.ld}jEl(a){a.hpa();return!0}KGf(a,b){a=b.Sw;ba.ULS.shipAssertTag(18130960,307,!!(a&16));if(a&256){v.a.oua&&u.AFrameworkApplication.fk("Microsoft.Office.Web.SessionSettings.IWacWoncaImageDataURLSkippedSettings");let c=null;b.If&&b.If.Ag&&(c=b.If.Ag.Qn);let h=!1;this.ySb&&v.a.oua&&this.hk.Akd(c,"data-src","data-srcurl");this.USb&&(h=this.hk.LZb(b.If.Ag.Qn,
b.If.Ld,!0));this.fTb&&this.hk.ttd(c,!1);a=this.BZ.copy();this.ySb&&v.a.oua&&this.hk.Akd(c,"data-srcurl","data-src");this.USb&&h&&this.hk.LZb(b.If.Ag.Qn,b.If.Ld,!1);this.fTb&&this.hk.ttd(c,!0);if(!a)return ba.ULS.sendTraceTag(6305540,307,50,"SystemClipboard didn't copy"),this.Wc.Wb(Ed.a.l8a,{["Reason"]:Cd.a.CZe}),b.P0&&b.P0.fail("SystemClipboard did not copy",!1),b.failed=!0,!1}return!0}j0b(a,b){const c=b.If;ba.ULS.shipAssertTag(18130961,307,!!(b.Sw&16));b.$hl?this.Zr.mDf():this.Zr.OVd(c,a);return!0}VLc(a,
b){var c=b.context,h=b.rd;const m=b.KJ;var y=!1;a=this.Tc.Pa.mb.Ye;if(this.pr.tm(a)||this.hf.Wl(a)){const G=this.rK.Nc(a.node);let U=G.gf();ba.ULS.shipAssertTag(18130962,307,U);this.Eha.Oe(G);this.Fha.Aab(G)&&(y=!0)}h=b.Sw&64?new E.DictionaryPropertySet:h||new E.DictionaryPropertySet;h.setValue(xc.a.fub,!1);c=this.Ca.mi(c,D.a.TK,2,!0,m,h);8===c&&(ba.ULS.sendTraceTag(18130963,307,50,"DeleteKey failed"),this.Wc.Wb(Ed.a.vja,{["Reason"]:Cd.a.gLf}),b.P0&&b.P0.fail("DeleteKey failed",!1),b.failed=!0);32===
c&&y&&(b=this.Tc.Pa.mb,this.hf.gx(b)&&b.Ua.node===a.node&&!this.pr.textLength(b.Ua.node)&&(b=this.rK.Nc(b.Ua.node),a=this.hf.xt(b),ba.ULS.shipAssertTag(18130964,307,a),this.Eha.Oe(b),this.Fha.Gyb(b)||(a=this.bpb.create(),a.Rc(b),this.Eha.Hwa(a,!1,!1),y=this.Eha.wi(a),this.pr.Yd(y)&&(this.Eha.Oe(a),this.Ph.merge(a,b,!1,!1),this.Tc.setSelection(this.x4a.Qg(y,this.pr.textLength(y)))))));return!0}}Object(n.a)(cz,"ClipboardOperationCutCopy",null,[408]);class vH{constructor(a,b,c,h,m,y,G,U,ja,va,Ta,fb,
Db,gc,hc){this.Ca=a;this.ld=b;this.Zr=c;this.BZ=y;this.Tc=m;this.Di=h;this.pr=G;this.hf=U;this.Eha=ja;this.rK=va;this.Fha=Ta;this.bpb=fb;this.x4a=Db;this.$a=gc;this.hk=hc}create(){return new cz(this.Ca,this.ld,this.Zr,this.Di,this.Tc,this.BZ,this.pr,this.hf,this.Eha,this.rK,this.Fha,this.bpb,this.x4a,this.$a,this.hk)}}Object(n.a)(vH,"Factory",null,[291]);class wH{Vsh(){return!0}}Object(n.a)(wH,"ClipboardOperationCutStrategy",null,[311]);var Is=d(461),aC=d(1207),bC=d(227);class Ro{constructor(a,b,
c,h,m,y=null,G="",U=!0){this.Lsa=this.gqd=this.mZa=this.Dkd=null;this.j9b=!1;this.jce=null;this.mEe=0;this.context=a;this.If=a.view;this.Sw=b;this.rd=m;this.P0=c;this.KJ=h;this.tKb=this.failed=!1;this.Dfd=null;this.gab=this.czb=!1;this.$hl=Ro.wVd(a);this.browserName=G;this.NHh=U;this.$La=!1;this.vQa=0;this.fUd=pa.a.create().toString();if(a=Object(za.a)(10,m)?m:null){this.mZa=new E.DictionaryPropertySet;this.mZa.Ux(a);if(a.sa(xc.a.pgd,!1)){this.czb=!0;this.gab=a.sa(xc.a.gab,!1);this.Dfd=y;for(y=this.If.Lb.Qj;y.$w;)y=
y.getContext(0);if(m=Object(ua.a)(Vb.AParagraphNode,y.node)){c=0;h=Ob.ParagraphReader.textLength(m);switch(y.contextId){case xb.a.textRange:c=y.Qa;h=y.Nb;break;case xb.a.endOfParagraph:c=h}this.Dkd=uc.a.z8i(y.node,c);ba.ULS.shipAssertTag(6305503,307,!!this.Dkd);m=Ib.HyperlinkReader.S4b(m);for(const ja of m)ja.Nb<=c||ja.Qa>=h||Ro.hyperlinkEditor.sM(y.node,ja.hyperlink)}}this.tKb=a.sa(xc.a.tKb,!1);this.$La=a.sa(xc.a.$La,!1)}b&64&&(this.tKb=!0)}static get Wc(){return ec.a.instance}static get hyperlinkEditor(){return Ro.yn||
(Ro.yn=vb.a.instance.resolve("Box4.IHyperlinkEditor"))}static wVd(a){if(a){if(a.$w){for(let b=0;b<a.length;b++)if(Ro.wVd(a.getContext(b)))return!0;return!1}if(Object(za.a)(bC.a,a))return Ro.wVd(a.xE);if(Ob.ParagraphReader.Yd(a.node)&&a.node.aC)return!0}return!1}}Ro.yn=null;Object(n.a)(Ro,"ClipboardActionArguments",null,[]);var uv;(function(a){a[a.paste=1]="paste";a[a.textOnly=2]="textOnly";a[a.overtype=4]="overtype";a[a.copy=16]="copy";a[a.deleteSelection=32]="deleteSelection";a[a.move=64]="move";
a[a.useSystemClipboard=256]="useSystemClipboard";a[a.forceInternalClipboard=512]="forceInternalClipboard";a[a.reformatPastedContent=4096]="reformatPastedContent";a[a.pasteAsPlainText=8192]="pasteAsPlainText";a[a.showPlaceholderGlossary=65536]="showPlaceholderGlossary"})(uv||(uv={}));Object(n.b)("ClipboardActionFlags",uv);const xH=a=>{a=a.Pa.clone();const b=[];for(let c=0;c<a.length;c++)Array.addRange(b,a.ga(c).toArray());return b},yH=a=>{const b={};let c;for(let h=0;h<a.length;h++)c=Object.getType(a[h].node).getName(),
b[c]=b[c]?b[c]+1:1;a="";for(let h in b)a+=b[h]+" "+h+" elements,";return a=a.substring(0,a.length-1)};class zH extends Is.a{constructor(a,b,c,h,m,y,G,U,ja,va,Ta,fb,Db,gc,hc,Gc,Pc,yc,Vd,De,Wd,Ve,$e,Qf,lg,Hg,Qg=!0){super();this.ZId=this.Bba=this.H6=this.QB=null;this.init(a);this.Nl("ClipboardOperation");this.AEa(ja,b,m,y,G);this.ld=va;this.hf=Ta;this.yd=fb;this.yk=Db;this.q7e=gc;this.t7e=hc;this.r7e=Gc;this.u7e=Pc;this.Nvc=yc;this.Axd=Vd;this.eQb=U;this.WPb=De;this.NOa=Wd;this.g2h=Qg;this.BD=Ve;this.fd=
$e;this.Us=Qf;this.iqa=lg;this.zt=h;this.fBa=Hg;G&&Object(za.a)(10,G)&&(this.Bba=Object(ua.a)(1159,G.sa(xc.a.iQa,null)));this.Bba||(this.Bba=this.fBa.lYe());this.C1a=void 0===c||null===c?"NotAvailable":Object(aC.a)(uv,c);this.Bba.Xci(this.C1a.split(", "));a=this.zt;a.view.Mh?(this.Ig=a.view,this.Ig.Lb?(this.dI=0,this.rV=c,this.Vpb=Pc.lHb,!Qg||this.Vpb&&this.Vpb.mb&&this.Vpb.length?(Pc=Bb.SelectionEditor.gx(this.Vpb.mb),Pc=!(this.rV&16&&Pc),Pc=Vd.bJj(c,this.Qj)&&Pc,1!==this.behavior&&Pc||(Pc||this.Bba.fail("Clipboard operation disabled for selection",
!0),this.Ep=Pc?32:8,this.EY())):(this.ld.Wb(Ed.a.wh,{["Reason"]:Cd.a.noSelection}),this.Bba.fail("No selection when one required",!0),this.Ep=8,this.finish())):(this.ld.Wb(Ed.a.wh,{["Reason"]:Cd.a.noSelection}),this.Bba.fail("No selection manager",!1),this.Ep=8,this.finish())):(this.ld.Wb(Ed.a.wh,{["Reason"]:Cd.a.Hcd}),this.Bba.fail("Not in interactive view",!0),this.Ep=8,this.finish())}get Qj(){this.ZId||(this.ZId=me.a.Wrb(this.Vpb));return this.ZId}Y0(){super.Y0();this.Vpb=null}run(){0===this.dI&&
this.setup();1===this.dI&&this.process();2===this.dI&&this.teardownSync();3===this.dI&&this.teardownAsync();4===this.dI&&this.finish()}setup(){if(this.rV&256&&this.eQb){this.Oy||this.Nvc.Uqi(this,this.rV,this.C1a);this.Oy.run();if(this.Oy.inProgress)return;const a=this.Oy.r5;this.SIc();if(!a){this.Bba.fail("No access to system clipboard",!0);this.Ep=8;this.dI=4;this.a0j();return}}else ba.ULS.sendTraceTag(9037319,307,50,"ClipboardOperation ran into Setup: {0}; {1}; {2}",this.rV,this.C1a,this.yd.Ly);
this.rV&32&&!this.hf.XXc(this.Ig.Lb.Qj)?(ba.ULS.sendTraceTag(6305506,307,50,"Cut not allowed"),this.ld.Wb(Ed.a.wh,{["Reason"]:Cd.a.YXd}),this.Bba.fail("Cut not allowed",!0),this.WPb.show(),this.Ep=8,this.dI=4):(this.rV&4096&&(this.iqa.kNe(Object.assign(new Bg,{zgg:!0,$8g:this.C1a})),this.Us.undo()),this.Axd.PDk(this.rV),this.QB=this.yk.le(15),this.QB.kd(this.Ig.yg),this.dI=1)}process(){if(!this.Oy){ba.ULS.sendTraceTag(9037320,307,50,"ClipboardOperation ran into Process: {0}; {1}; {2}",this.rV,this.C1a,
this.yd.Ly);ba.ULS.shipAssertTag(6305507,307,!this.H6);this.H6=new Ro(this.zt,this.rV,this.Bba,this.KJ,this.qV,void 0,this.yd.Ly,this.g2h);let a;a=this.rV&65536?Object(F.a)(this.q7e,this.q7e.process,"process"):this.rV&64?Object(F.a)(this.t7e,this.t7e.process,"process"):this.rV&1?Object(F.a)(this.u7e,this.u7e.process,"process"):Object(F.a)(this.r7e,this.r7e.process,"process");this.rV&16&&this.Ig.Lb.Moa.g3d();this.NOa.create(this,a,this.H6).Nl("ClipboardAction")}ba.ULS.shipAssertTag(6305536,307,!!this.Oy);
this.Oy.run();this.Oy.inProgress||(this.SIc(),this.dI=this.Oi?2:3)}teardownSync(){this.H6.czb&&(this.QB.jd=D.a.typing);this.H6.j9b&&this.QB.ibd(this.H6.jce,this.H6.mEe);this.QB.dispose();this.Ep=this.H6.failed?8:32;this.dI=4}teardownAsync(){if(this.Oy){if(this.Oy.run(),this.Oy.inProgress)return}else if(this.H6.czb&&(this.QB.jd=D.a.typing),this.QB.SU(this),this.H6.j9b&&this.QB.ibd(this.H6.jce,this.H6.mEe),this.QB.dispose(),this.WEc)return;this.Ep=this.H6.failed?8:32;this.dI=4}finish(){this.iqa.kNe(Object.assign(new Bg,
{zgg:!1}));this.EY();32===this.response?ba.ULS.sendTraceTag(6305537,307,50,"ClipboardOperation Succeeded after {0} milliseconds: {1}; {2}; {3} ",+this.endTime-+this.startTime,this.rV,this.C1a,this.yd.Ly):ba.ULS.sendTraceTag(6305538,307,50,"ClipboardOperation Failed after {0} milliseconds: {1}; {2}; {3}",+this.endTime-+this.startTime,this.rV,this.C1a,this.yd.Ly);this.fBa.dDa(this.Bba)}a0j(){var a=!!(this.rV&1),b=this.zt.view;if(b){var c=b.Lb;b=this.yd.Ly;u.AFrameworkApplication.Ta.processAction(D.a.YJf,
2);a?ba.ULS.sendTraceTag(18617483,307,50,"CopyPasteShortcutDialog showed for paste operation in {0}.",b):(ba.ULS.sendTraceTag(18617484,307,50,"CopyPasteShortcutDialog showed for copy operation in {0}.",b),a=xH(c),1===a.length?ba.ULS.sendTraceTag(18425100,307,50,"CopyPasteShortcutDialog showed for copying 1 {0} element in {1}.",Object.getType(a[0].node).getName(),b):(c=yH(a),ba.ULS.sendTraceTag(18425101,307,50,"CopyPasteShortcutDialog showed for copying {0} elements: {1} in {2}.",a.length,c,b)))}}}
Object(n.a)(zH,"ClipboardOperation",Is.a,[]);class AH{constructor(a,b){this.awc=null;this.Zr=a;this.wV=b;this.LB=0}process(a,b){this.LB||(this.awc=[Object(F.a)(this,this.Uzi,"copyGlossarySelection"),Object(F.a)(this.wV,this.wV.Eyk,"pasteGlossaryPlaceholder")]);let c=!0;this.LB<this.awc.length&&(c=this.awc[this.LB++](a,b));return c?this.LB<this.awc.length:!1}Uzi(a,b){if(!Object(za.a)(10,b.rd))return!1;const c=Object(ua.a)(10,b.rd);if(!c.Sa(xc.a.U6f))return!1;const h=c.eb(xc.a.U6f),m=b.If,y=m.Lb;this.Zr.NBl();
y.Gld(()=>{y.setSelection(h,void 0,!0);this.Zr.OVd(m,a)},!0);return!0}}Object(n.a)(AH,"ClipboardOperationContentControlShowPlaceholderProcessor",null,[1158]);class BH{constructor(a){this.m2a=null;this.UR=a;this.LB=-1}process(a,b){-1===this.LB&&(this.WHi(a,b),this.LB=0);let c=!1;this.LB<this.m2a.length&&(c=this.m2a[this.LB++](a,b));return c?this.LB<this.m2a.length:!1}WHi(a,b){v.a.Y8||b.Sw&512?(this.m2a=[Object(F.a)(this.UR,this.UR.j0b,"copyInternal")],ba.ULS.sendTraceTag(18158306,307,50,"ClipboardOperationCutCopyProcessor: setup actions as CopyInternal.")):
!a.Oi&&b.Sw&256?(this.m2a=[Object(F.a)(this.UR,this.UR.jEl,"waitBeforeCopy"),Object(F.a)(this.UR,this.UR.KGf,"copyExternal"),Object(F.a)(this.UR,this.UR.j0b,"copyInternal")],ba.ULS.sendTraceTag(18158307,307,50,"ClipboardOperationCutCopyProcessor: setup actions as WaitBeforeCopy, CopyExternal, CopyInternal.")):(this.m2a=[Object(F.a)(this.UR,this.UR.KGf,"copyExternal"),Object(F.a)(this.UR,this.UR.j0b,"copyInternal")],ba.ULS.sendTraceTag(18158336,307,50,"ClipboardOperationCutCopyProcessor: setup actions as CopyExternal, CopyInternal."));
b.Sw&32&&(a=Object(F.a)(this.UR,this.UR.VLc,"deleteForCut"),this.m2a.push(a),ba.ULS.sendTraceTag(18158337,307,50,"ClipboardOperationCutCopyProcessor: setup actions add DeleteForCut for cut."));a=b.browserName;ba.ULS.sendTraceTag(18617485,307,50,"Copy operation in {0}.",a);if(b.If)if(b=xH(b.If.Lb),1===b.length)ba.ULS.sendTraceTag(18425102,307,50,"Copy 1 {0} element in {1}.",Object.getType(b[0].node).getName(),a);else{const c=yH(b);ba.ULS.sendTraceTag(18425103,307,50,"Copy {0} elements: {1} in {2}.",
b.length,c,a)}}}Object(n.a)(BH,"ClipboardOperationCutCopyProcessor",null,[1157]);class CH{constructor(a,b,c,h){this.sAc=null;this.Zr=a;this.Tc=b;this.UR=c;this.wV=h;this.LB=0}process(a,b){this.LB||(this.sAc=[Object(F.a)(this,this.Yzi,"copyMovedSelection"),Object(F.a)(this.UR,this.UR.VLc,"deleteForCut"),Object(F.a)(this,this.iZg,"moveIp"),Object(F.a)(this.wV,this.wV.h9g,"pasteInternal"),Object(F.a)(this.wV,this.wV.Rqh,"setSelectionAfterPaste")]);let c=!0;this.LB<this.sAc.length&&(c=this.sAc[this.LB++](a,
b));return c?this.LB<this.sAc.length:!1}Yzi(a,b){b=b.If;this.Zr.ABl();this.Zr.OVd(b,a);return!0}iZg(a,b){b=new Gb.Selection([b.rd],!0);this.Tc.setSelection(b,a);return!0}}Object(n.a)(CH,"ClipboardOperationMoveProcessor",null,[1146]);class DH{constructor(a,b,c,h,m,y){this.GGd=null;this.njf=0;this.ld=h;this.yd=b;this.wV=m;this.hBd=c;this.eQb=u.AFrameworkApplication.epd()&&!(v.a.uT&&u.AFrameworkApplication.fa.ka("ElectronClipboardAccessFix"));this.uxd=a.appSettings.ChromeClipboardAccessOperationTimeout;
this.LB=0;this.QNh=y}get lHb(){return this.wV.lHb}process(a,b){if(0===this.LB)return this.Myk(b);if(1===this.LB)return this.prepareForPaste(a,b);if(2===this.LB)return this.LB=3,this.GGd(a,b);3===this.LB&&this.wV.Rqh(a,b);return!1}Myk(a){this.yd.Y8||a.Sw&512?(this.GGd=a.Sw&2?Object(F.a)(this.wV,this.wV.paste,"paste"):Object(F.a)(this.wV,this.wV.h9g,"pasteInternal"),this.LB=2):(this.eQb?(this.LB=1,this.njf=Date.now()):this.LB=2,this.GGd=Object(F.a)(this.wV,this.wV.paste,"paste"));ba.ULS.sendTraceTag(18617486,
307,50,"Paste operation in {0}.",a.browserName);return!0}prepareForPaste(a,b){a=!0;if(this.hBd.value.Oah())this.LB=2;else{const c=Date.now()-this.njf;c>this.uxd&&(ba.ULS.sendTraceTag(18158340,307,50,"prepareTime : {0}",c),this.ld.Wb(Ed.a.vja,{["Reason"]:Cd.a.z7g}),b.P0&&b.P0.fail("Prepare for paste timed out",!1),b.failed=!0,a=!1,this.QNh.aYk())}return a}}Object(n.a)(DH,"ClipboardOperationPasteProcessor",null,[1145]);class EH{constructor(a,b,c,h,m,y,G,U,ja,va,Ta,fb,Db,gc,hc,Gc,Pc,yc){this.Zr=a;this.Ca=
b;this.eQb=c;this.ld=h;this.hf=m;this.yd=y;this.yk=G;this.UNh=U;this.SNh=ja;this.Nvc=va;this.Axd=Ta;this.WPb=fb;this.NOa=Db;this.BD=gc;this.fd=hc;this.Us=Gc;this.iqa=Pc;this.fBa=yc}create(a,b,c,h,m,y,G,U,ja=!0){const va=this.UNh.create(h,Object(ua.a)(10,U));var Ta=this.SNh.create();const fb=new AH(this.Zr,va),Db=new CH(this.Zr,me.a.instance,Ta,va);Ta=new BH(Ta);h=new DH(u.AFrameworkApplication.fa,Lc.a.instance,h,ec.a.instance,va,this.Nvc);return new zH(a,b,c,m,y,G,U,this.eQb,this.Ca,this.ld,this.hf,
this.yd,this.yk,fb,Db,Ta,h,this.Nvc,this.Axd,this.WPb,this.NOa,this.BD,this.fd,this.Us,this.iqa,this.fBa,ja)}}Object(n.a)(EH,"Factory",null,[1035]);class dz{constructor(a,b){this.Z9a=a.RRc(b);this.XVd=a.C5i(b);this.D6a=a.MQc(b);this.NPa=a.zQc(b)}static EW(a){return dz.ur(a)}static ur(a){return new dz(jc.a.instance,a)}}Object(n.a)(dz,"CpUsageHelper",null,[]);var Js=d(175);class FH{constructor(a,b,c,h,m,y,G,U,ja,va,Ta,fb){this.ld=a;this.Zr=b;this.KUb=c;this.Pba=h;this.Tc=m;this.Ca=y;this.hBd=G;this.SWb=
ja;this.JGd=U;this.Tyd=va;this.zxd=Ta;this.fd=fb}get In(){return this.SWb.value}get Laa(){return this.Pba}get Wc(){return this.ld}get lHb(){return this.JGd.lHb}paste(a,b){const c=this.fd.Hrb();try{const h=b.If;ba.ULS.shipAssertTag(18131010,307,!!(b.Sw&1));Object(za.a)(10,b.rd)&&b.rd.setValue(Js.a.k2b,h.Ag.Qn.clientWidth);this.zxd.avl(a,b);let m;if(!({cKc:m}=this.hBd.value.aDh()).returnValue)return b.P0&&b.P0.fail("HTML import strategy failed",!1),b.failed=!0,!1;this.In.kw();let y=!0,G=null;const U=
this.Tyd.create(m),ja=b.NHh;h.Lb.Gld(()=>{ja&&2===this.Ca.processAction(D.a.JCa,2)?y=!1:(G=ja?this.Tc.Pa.mb.Ua:b.rd,ba.ULS.shipAssertTag(18158338,307,Bb.SelectionEditor.Sg(G)),this.rog(G,"paste"))},this.JGd.Kig);if(!y)return!1;h.editingView.disable(!0,25);U.restore();this.KUb.zyk(m,G,a);return!0}finally{c&&c.dispose()}}Eyk(a,b){this.In.kw();const c=(new rF.a).le(15);c.kd(this.Zr.I_e);b=Object(ua.a)(10,b.rd).eb(xc.a.Snj);ba.ULS.shipAssertTag(20492440,307,Bb.SelectionEditor.Sg(b));this.KUb.ldg(b,a);
this.Zr.mDf();c.dispose();return!0}h9g(a){this.In.kw();this.Ca.processAction(D.a.JCa,2);const b=this.Tc.Pa.mb.Ua;ba.ULS.shipAssertTag(18158339,307,Bb.SelectionEditor.Sg(b));this.rog(b,"intPaste");this.KUb.ldg(b,a);return!0}rog(a,b){b=dz.EW(b);this.Laa.OMk(b,a.node,a.Qa);this.Laa.b0j(b.XVd);this.Laa.Ume(b.Z9a);this.Laa.Ome(b.D6a);this.Laa.Nme(b.NPa)}Rqh(a,b){if(!b.NHh)return!1;b.Sw&64&&this.Zr.MBl();if(!b.Lsa)return ba.ULS.sendTraceTag(3994450,307,50,"No selection after paste"),this.Wc.Wb(Ed.a.C1,
{["Reason"]:Cd.a.rdg}),b.P0&&b.P0.fail("No selection after paste",!1),b.failed=!0,!1;this.JGd.sBl(b);this.In.kw();return!1}}Object(n.a)(FH,"ClipboardOperationPaste",null,[1143]);class GH{constructor(a,b,c,h,m,y,G,U,ja,va,Ta){this.ld=a;this.Zr=b;this.KUb=c;this.Pba=h;this.Tc=m;this.Ca=y;this.SWb=U;this.nXh=G;this.Tyd=ja;this.zxd=va;this.fd=Ta}create(a,b){b=this.nXh.create(this.Tc,b);return new FH(this.ld,this.Zr,this.KUb,this.Pba,this.Tc,this.Ca,a,b,this.SWb,this.Tyd,this.zxd,this.fd)}}Object(n.a)(GH,
"Factory",null,[1032]);class HH{constructor(a,b){this.l0h=a;this.cXh=b}get stylePropertySet(){return this.l0h}get vxk(){return this.cXh}}Object(n.a)(HH,"ParagraphFormatStore",null,[]);class IH{constructor(a,b,c,h){this.Tc=a;this.pr=b;this.CK=c;this.STh=h}avl(a,b){if(b.czb&&this.STh){b=a.r5;var c=this.Tc.Pa.mb.Ua.node,h=null;this.pr.Yd(c)&&(h=this.CK.XD(c),c=this.pr.nta(c),h=new HH(h,c));b=new Ro(b.context,b.Sw,b.P0,b.KJ,b.rd,h);a.r5=b}}}Object(n.a)(IH,"ClipboardOperationPasteOvertypeStrategy",null,
[1031]);class kx{constructor(a){this.nEd=null;this.Tc=a;a.Gld(b=>{this.nEd=b},!1)}get Kig(){return!1}sBl(a){a=this.$Xb(a);this.setSelection(this.Tc,a)}$Xb(a){let b=a.Lsa;(a.$La||a.tKb)&&a.gqd&&(b=yd.SelectionFactory.wN(a.gqd,b.Ua));return b}setSelection(a,b){a.setSelection(b)}}Object(n.a)(kx,"AClipboardOperationPasteStrategy",null,[1160]);class JH extends kx{constructor(a){super(a)}get lHb(){return this.nEd}}Object(n.a)(JH,"ClipboardOperationPasteToLiveSelectionStrategy",kx,[]);class KH extends kx{constructor(a,
b){super(a);this.cMd=null;this.bUb=b;a.Gld(c=>{this.cMd=c},!0)}get Kig(){return!0}get lHb(){return this.cMd}$Xb(a){let b=super.$Xb(a);a.rd.setValue(xc.a.Syk,b);return b=this.bUb.yHl(this.nEd.mb,this.cMd.mb,b)}}Object(n.a)(KH,"ClipboardOperationPasteToVirtualSelectionStrategy",kx,[]);class LH{constructor(a){this.bUb=null;this.bMd=a.ka("EnableVirtualSelectionInSelectionManager")}create(a,b){return b&&b.sa(xc.a.$La,!1)&&this.bMd?new KH(a,this.PDl):new JH(a)}get PDl(){this.bUb||(this.bUb=vb.a.instance.rb("Box4.Actors.IVirtualSelectionMerger"));
return this.bUb}}Object(n.a)(LH,"ClipboardOperationPasteStrategyFactory",null,[1034]);class cC{constructor(a,b,c,h,m,y){this.ld=a;this.Tc=b;this.Qga=c;this.wD=h;this.tTh=m;this.gUh=y}PDk(a){this.gUh&&(a&1||a&32)&&this.Qga.lw&&this.Tc.qXb()}bJj(a,b){return this.tTh?a&1&&this.wD.Z6a(b)?(this.ld.Wb(Ed.a.wh,{["Reason"]:Cd.a.LD}),!1):!0:!0}}Object(n.a)(cC,"ClipboardOperationWordStrategy",null,[]);class MH{constructor(a){this.QOh=a.ka("CssConverterFidelityImprovementIsEnabledIsEnabled")}xzi(a,b){if(b)if(b=
b.sheet)if(b=b.cssRules){var c=Array.clone(b);u.AFrameworkApplication.fk("Microsoft.Office.Web.SessionSettings.IWacWordCssConverterFidelityImprovementIsEnabledSettings");this.QOh&&c.reverse();var h=b=0,m=0,y=0;for(const U of c){c=U.style;var G=U.selectorText;c=c?c.cssText:null;G=G?G.split(","):null;if(c&&G&&U.type===U.STYLE_RULE){y+=G.length;for(const ja of G){0<=ja.indexOf("#")&&b++;0<=ja.indexOf(".")&&h++;0>ja.indexOf("#")&&0>ja.indexOf(".")&&m++;G=null;try{G=a.querySelectorAll(ja)}catch(va){ba.ULS.sendTraceTag(41427107,
307,10,"ConvertStyleDomToInlineStyle failed to query selector: {0}. Exception: {1}",ja,va.message)}if(G)for(let va=0;va<G.length;va++)G[va].setAttribute("style",c+(G[va].getAttribute("style")||""))}}}ba.ULS.sendTraceTag(51245663,307,50,"selectorCount: {0}; idSelectorCount: {1}; classSelectorCount: {2}; tagSelectorCount: {3}",y,b,h,m)}else this.Kog();else this.Kog()}Kog(){ba.ULS.sendTraceTag(41211202,307,15,"Could not access {0} for Style DOMElement in ConvertStyleDomToInlineStyle and abort the conversion. Browser: {1} ",
v.a.Ly)}}Object(n.a)(MH,"ExternalPasteCssConverter",null,[1039]);var ez=d(1214);class lx{constructor(a){this.AV=this.jTb=null;this.wWb=a.currentNode;const b=new rb.GraphIterator;b.Rc(a);this.nGd=new rb.GraphIterator;this.nGd.Rc(a);this.kGd=b.origin;this.rxd=Array(b.depth);this.Hmb=Array(b.depth);this.sxd=Array(b.depth);for(a=b.depth-1;0<=a;--a){const c=b.currentNode;this.Hmb[a]=b.role;this.sxd[a]=c;b.zc();this.rxd[a]=b.G3i(c,this.Hmb[a])}}$l(a,b){this.jTb=a;this.AV=b}restore(a){const b=new ez.a,c=
new ez.a;this.Lkh(a,b,c);return c.value}Lkh(a,b,c){b.value=!0;if(this.nGd.isValid)a.Rc(this.nGd),c.value=!1;else{for(let h=this.sxd.length-1;0<=h;--h){const m=this.sxd[h];if(m.anchor&&!m.anchor.QI&&(a.set(m),a.Faa(this.kGd)||this.kGd.xie&&a.YDh())){c.value=this.MRf(a,h+1);return}b.value=!1}a.set(this.kGd);c.value=this.MRf(a,0)}}MRf(a,b){let c=!1,h,m;h=this.rxd[b];m=this.Hmb[b];const y=a.p8(m);if(h<y)a.Zp(h,m);else if(c=!0,!a.TA(m))return!0;if(!this.nZg(a,m))return c;for(b+=1;b<this.rxd.length;++b){if(c){if(!a.TA(this.Hmb[b]))return!0}else if(!a.Bb(this.Hmb[b]))return!1;
if(!this.nZg(a,this.Hmb[b]))break}return c}nZg(a,b){if(this.jTb&&!this.jTb(a,this.AV)){const c=new rb.GraphIterator;c.Rc(a);let h=!0;do if(!a.Af(b)){h=!1;break}while(!this.jTb(a,this.AV));if(!h){a.Rc(c);do if(!a.FF(b))return a.zc(),!1;while(!this.jTb(a,this.AV))}}return!0}}Object(n.a)(lx,"NodeReference",null,[]);var fn=d(182);class wj{constructor(a,b,c,h){this.bpb=this.MGd=this.HMa=this.fd=this.BD=this.$o=this.IBh=this.eWb=this.Xo=this.Ug=this.Rw=this.BK=this.eI=null;this.kyb=a;this.U2d=this.jhb=
null;this.ph=b;this.transaction=c;this.$ha=h}get fa(){return u.AFrameworkApplication.fa}get gP(){return this.BK||(this.BK=vb.a.instance.resolve("Box4.Styles.IStyleEditor"))}get paragraphEditor(){return this.Rw||(this.Rw=vb.a.instance.resolve("Box4.IParagraphEditor"))}get BJ(){return this.eI||(this.eI=vb.a.instance.resolve("Box4.Pages.IPageContentEditor"))}get wB(){return wj.Nx||(wj.Nx=vb.a.instance.resolve("Box4.IOutlineEditor"))}get Sf(){return this.Ug||(this.Ug=vb.a.instance.resolve("Box4.List.IListReader"))}get eq(){return this.Xo||
(this.Xo=vb.a.instance.resolve("Box4.List.IListEditor"))}get Pqc(){return this.eWb||(this.eWb=vb.a.instance.rb("Box4.List.ISingleLevelListEditor"))}get p6(){return this.$o||(this.$o=vb.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}get Usc(){return this.BD||(this.BD=vb.a.instance.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance)}get Tf(){return this.fd||(this.fd=vb.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}get eTd(){return this.HMa||
(this.HMa=vb.a.instance.resolve("Box4.CatchUpActivity.IChangeIdEditor"))}get ogd(){return this.MGd||(this.MGd=vb.a.instance.rb("Box4.IPastedParagraphSpaceHandler"))}set ogd(a){this.MGd=a}get B9g(){return!1}get gth(){return this.fa.ka("WordEditorAutoResizeImageIsEnabled")}qRf(){}m9g(a){var b=void 0===this.ph.Sw||null===this.ph.Sw?"not available":Object(aC.a)(uv,this.ph.Sw);ba.ULS.sendTraceTag(8765522,307,50,"PasteSetup: {0} [{1}].",this.ph.Sw,b);ba.ULS.shipAssertTag(6305487,307,Bb.SelectionEditor.Sg(this.kyb));
if(this.Lcd)return ba.ULS.sendTraceTag(6305488,307,50,"NothingToPaste"),this.ph.Lsa=yd.SelectionFactory.wu(this.kyb),a.$g(Object(F.a)(this,this.XYa,"pasteTeardown")),!0;b=new rb.GraphIterator;b.set(this.kyb.node);Bb.SelectionEditor.xt(b);mc.OutlineElementNavigator.Oe(b);this.IBh=b.origin;if(this.B9g)return b.AB(10),this.qRf(b,a),a.$g(Object(F.a)(this,this.e9k,"setSelectionAfterPastingOutlines")),!0;if(Je.b(b)){if(this.cfg)return this.ph.Lsa=this.Lyk(this.kyb,this.XFf),a.$g(Object(F.a)(this,this.XYa,
"pasteTeardown")),!0;this.kyb=this.gik(b).ga(0)}this.ikl(this.kyb);const c=new fn.a;c.Rc(b);mc.OutlineElementNavigator.yJ(c,!1,!1);this.jhb=new lx(b);this.U2d=new lx(c);a.$g(Object(F.a)(this,this.Cyk,"pasteExecution"));return!0}Cyk(a){Te.a.mark(5568);this.pRf(a);let b=Object(F.a)(this,this.Igk,"mergeAfterPaste");if(this.Nhg){const c=this.Wth();c&&(b=Object(F.a)(this,this.XYa,"pasteTeardown"));ba.ULS.sendTraceTag(40387030,307,50,"ExecutePaste: shouldSkipMerge: {0}.",c)}a.$g(b);return!0}Wth(){return!1}get Nhg(){return this.fa.ka("PptCcpFix2IsEnabled")}get vcl(){return this.fa.ka("CopyAndPasteOneParagraphIndentationFixIsEnabled")}Igk(a){Te.a.mark(5569);
var b=new rb.GraphIterator;this.jhb.restore(b);this.jhb=null;var c=new rb.GraphIterator;this.U2d.restore(c);this.U2d=null;ba.ULS.shipAssertTag(6305489,307,Kd.OutlineElementReader.Wg(b));ba.ULS.shipAssertTag(6305490,307,Kd.OutlineElementReader.Wg(c));mc.OutlineElementNavigator.wi(b);Ob.ParagraphReader.fl(b)&&Ob.ParagraphReader.textLength(b.currentNode);mc.OutlineElementNavigator.Oe(b);mc.OutlineElementNavigator.wi(c);ba.ULS.shipAssertTag(6305491,307,Ob.ParagraphReader.fl(c));var h=Ob.ParagraphReader.textLength(c.currentNode);
mc.OutlineElementNavigator.Oe(c);const m=this.uth;var y=new fn.a;y.Rc(b);mc.OutlineElementNavigator.yJ(y,!1,!1);var G=y.currentNode===c.currentNode;var U=!!this.ph&&!!(this.ph.Sw&8192);let ja=!1;!U&&this.ph.rd&&Object(za.a)(E.DictionaryPropertySet,this.ph.rd)&&2===Fc.App.mode&&(U=(U=this.ph.rd.Lh(xc.a.Pgb))&&""!==U?!0:!1);if(G)y=rb.GraphIterator.nb(b.currentNode),Ob.ParagraphReader.hs(mc.OutlineElementNavigator.wi(y))||(b=c),b.currentNode.id!==c.currentNode.id&&(ba.ULS.sendTraceTag(40691869,307,50,
"MergeAfterPaste NothingPasted: precedingIteratorIsList: {0}, followingIteratorIsList: {1}",Wb.ListReader.tk(b),Wb.ListReader.tk(c)),y=wj.Ph.merge(b,c,!0,U),ba.ULS.shipAssertTag(6305492,307,y)),c=b,U=!0;else{var va=!!(this.ph.Sw&4);G=this.Tf.hg&&this.Tf.Ny&&va&&this.ph.gab;this.ogd&&this.ph&&2===Fc.App.mode&&!va&&(this.ogd.Vuj(b,!1),this.ogd.Vuj(c,!0));mc.OutlineElementNavigator.wi(y);Ob.ParagraphReader.fl(y)&&Ob.ParagraphReader.textLength(y.currentNode);mc.OutlineElementNavigator.Oe(y);this.jei(y,
b,c);if(this.eTd.HZb||this.vcl)if(va=new fn.a,va.Rc(y),mc.OutlineElementNavigator.yJ(va,!1,!1),va.xq.id!==c.xq.id){for(;y.currentNode.id!==c.currentNode.id;)mc.OutlineElementNavigator.wi(y,!1),md.a.create(y.currentNode),y.zc(),mc.OutlineElementNavigator.yJ(y,!1,!1);y.Rc(b);mc.OutlineElementNavigator.yJ(y,!1,!1)}else ja=!0;if(this.ph.Dkd&&(ba.ULS.shipAssertTag(6305493,307,this.ph.czb),va=new rb.GraphIterator,va.Rc(y),va=mc.OutlineElementNavigator.wi(va))){var Ta=this.ph.Dkd.$d(va.Ra.ga(0));va.Ra.ga(0).formatting=
Ta}Wb.ListReader.tk(b)?(wj.BL.d$b&&this.Pqc&&this.Pqc.IHl(b),va=Wb.ListReader.tk(y)?this.vth:!0):Kd.OutlineElementReader.isEmpty(b,!0)?(wj.Ph.PCa(b),va=!1):va=Wb.ListReader.ix||!Wb.ListReader.tk(y);this.ph.gqd=null;if(this.ph.tKb||this.ph.$La)this.ph.gqd=this.Zij(va?b.currentNode:y.currentNode,va);if(va&&(Ta=Wb.ListReader.tk(b),ba.ULS.sendTraceTag(40691870,307,50,"MergeAfterPaste MergeBeforeContent, precedingIsList: {0}, firstPastedOeIsList: {1}",Ta,Wb.ListReader.tk(c)),wj.Ph.merge(b,y,!0,U,c,void 0,
ja,G),Wb.ListReader.tk(b)&&this.Sf.Xlc)){var fb=new fn.a;fb.Rc(b);mc.OutlineElementNavigator.yJ(fb,!1,!1);if(fb.xq.id!==c.xq.id){var Db=this.Sf.fw(b);this.Sf.Sma(b);const Gc=b.currentNode.sa(jb.a.listID,0);b.zc();for(Db.qA=Yd.a.Hw;fb.currentNode.id!==c.currentNode.id;){if(!Wb.ListReader.tk(fb))({G$a:Db}=this.eq.frb(Db.propertySet,fb,Db));else if(Ta){var gc=this.Sf.Aaj(fb),hc=this.Sf.L6d(b.currentNode,Gc,gc);hc=hc?Pe.a.wCa(hc,null):Db;gc=Pe.a.pN(hc.listType,Db.listStyle,null,0,gc,"","");gc.Ykk=b.currentNode;
this.eq.c8k(gc);this.eq.KTe(fb,!0)}mc.OutlineElementNavigator.yJ(fb,!1,!1)}}}m?(Ta=new fn.a,Ta.Rc(c),mc.OutlineElementNavigator.Hwa(Ta,!1,!1),fb=Wb.ListReader.tk(Ta),Db=Wb.ListReader.tk(c),U=wj.Ph.merge(Ta,c,!0,U,void 0,!0,void 0,G),ba.ULS.sendTraceTag(40691871,307,50,"MergeAfterPaste MergeAfterContent, lastPastedOeIsList: {0}, followingIteratorIsList: {1}, MergeSucceeded: {2}",fb,Db,U?"True":"False, will cause IP to reset to zero."),c=U?Ta:c):(U=!1,ba.ULS.sendTraceTag(51463189,307,50,"No merge, will cause IP to reset to zero."));
this.eTd.HZb&&ja&&(va?(y=new rb.GraphIterator,y.Rc(b),mc.OutlineElementNavigator.wi(y)):m?(b=new rb.GraphIterator,b.Rc(y),mc.OutlineElementNavigator.wi(b)):(b=new rb.GraphIterator,b.Rc(y),b=mc.OutlineElementNavigator.wi(b),md.a.create(b)))}ba.ULS.shipAssertTag(6305494,307,c.isValid);b=mc.OutlineElementNavigator.wi(c);h=U?Ob.ParagraphReader.textLength(b)-h:0;y=!1;Object(za.a)(10,this.ph.rd)&&(y=this.ph.rd.sa(xc.a.KYc,!1));y&&J.a.instance.ga(11)?this.ph.Lsa=yd.SelectionFactory.V2(b,h-1,h):this.ph.Lsa=
yd.SelectionFactory.Qg(b,h);J.a.instance.ga(71)&&this.ph&&this.ph.czb&&Ob.ParagraphReader.Yd(b)&&this.ph.Dfd&&((h=this.ph.Dfd.stylePropertySet)&&this.gP.paa(h,b,!0),(h=this.ph.Dfd.vxk)&&this.paragraphEditor.uvf(b,h));a.$g(Object(F.a)(this,this.XYa,"pasteTeardown"));return!0}jei(a,b,c){var h=!1;this.Tf.hg&&this.Tf.Ny&&(h=!0);if(h){for(;a.currentNode!==c.currentNode;){mc.OutlineElementNavigator.wi(a,!1);h=this.Usc.bkl(md.a.create(a.currentNode));h.j6f();for(let m=0;m<h.length;m++){let y;const G=({Zkg:y}=
h.getContext(m)).returnValue;y&&wj.hyperlinkEditor.YFb(G,1)}a.zc();mc.OutlineElementNavigator.yJ(a,!1,!1)}a.Rc(b);mc.OutlineElementNavigator.yJ(a,!1,!1)}}Zij(a,b){a=rb.GraphIterator.nb(a);mc.OutlineElementNavigator.wi(a);return Ob.ParagraphReader.Yd(a.currentNode)?(b=b?Ob.ParagraphReader.textLength(a.currentNode):0,yd.SelectionFactory.Qg(a.currentNode,b)):rd.TableReader.Vab(a.currentNode)?yd.SelectionFactory.wl(a.currentNode):null}e9k(a){const b=rb.GraphIterator.nb(this.IBh);b.TA(1);this.ph.Lsa=yd.SelectionFactory.sj(b.currentNode,
!1);a.$g(Object(F.a)(this,this.XYa,"pasteTeardown"));return!0}XYa(){var a=void 0===this.ph.Sw||null===this.ph.Sw?"not available":Object(aC.a)(uv,this.ph.Sw);ba.ULS.sendTraceTag(8765523,307,50,"PasteTeardown: {0} [{1}].",this.ph.Sw,a);ba.ULS.shipAssertTag(6305497,307,!!this.ph.Lsa);this.transaction.dispose();a=this.$ha.GK;if(!a.Mh||!a.editingView.Vl)return!1;a.editingView.Hol();return!1}Ibl(a,b){const c=new rb.GraphIterator;c.Rc(a);a=mc.OutlineElementNavigator.wi(c);b=Ob.ParagraphReader.Yd(a)&&b===
Ob.ParagraphReader.textLength(a);ba.ULS.sendTraceTag(50384992,307,50,"IsPasteAtEndofParagraph: {0}",b);return b}ikl(a){ba.ULS.shipAssertTag(6305498,307,Bb.SelectionEditor.Sg(a));const b=rb.GraphIterator.nb(a.node);var c=b.gf();mc.OutlineElementNavigator.Oe(b);ba.ULS.sendTraceTag(40425481,307,50,"sourceOE GraphIterator setup. {0}",{["tryToRootAtOutlineAncestorSuccess"]:c,["ipContextNodeType"]:a.node.type});c=wj.Ph.g8b(b,!0);const h=this.Ibl(b,a.Qa);wj.Ph.yMb(b,c,a,!1,!1,h)}Lyk(a,b){ba.ULS.shipAssertTag(6305500,
307,a.contextId===xb.a.Of);const c=a.node;b=b.replace(ta.a.Nzc," ");wj.characterPropertiesEditor.replaceTextRange(a,b);return yd.SelectionFactory.Qg(c,a.Qa+b.length)}gik(a){a.Xu();wj.Yl.iKa(a);const b=wj.Jk.q2f(a),c=this.BJ.D0b(a);b?kq.c(a.currentNode,b+1,b+2):this.wB.Jnd(c,Fc.App.Kb.Jd.Cn.h6b());this.wB.f8b(a,null,!0);return yd.SelectionFactory.sj(a.currentNode,!0)}static get Yl(){return vy.PageNavigator.instance}static get characterPropertiesEditor(){return wj.Zg||(wj.Zg=vb.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static get hyperlinkEditor(){return wj.yn||
(wj.yn=vb.a.instance.resolve("Box4.IHyperlinkEditor"))}static get Jk(){return Pw.PageReader.instance}static get Ph(){return wj.Di||(wj.Di=vb.a.instance.resolve("Box4.IOutlineElementEditor"))}static get BL(){return wj.tK||(wj.tK=vb.a.instance.rb("Box4.List.ListSettings"))}static get xe(){return wj.hd||(wj.hd=vb.a.instance.rb("Box4.IFeatureHelper"))}}wj.Nx=null;wj.hd=null;wj.Di=null;wj.Zg=null;wj.yn=null;wj.tK=null;Object(n.a)(wj,"APasteExecutionManager",null,[]);var EP=d(1213);class NH{constructor(){this.Sw=
0;this.k0b=6;this.w3d=this.v3d=this.UVf=this.u3d=this.t3d=this.r3d=this.q3d=!1;this.mLe=null;this.TVf=this.H8a=this.W3b=this.SVf=this.WVf=!1;this.u9g=this.iHb=0;this.BHe=this.platform=null;this.U2a={}}get PXe(){if(this.w3d)return"Word Online";if(this.u3d)return"Google Docs";if(this.v3d||this.r3d||this.t3d)return"PowerPoint Online";if(this.q3d)return"Excel Online";switch(this.mLe){case "Word.Document":return"Word";case "OneNote.File":return"OneNote";case "Excel.Sheet":return"Excel";case "PowerPoint.Slide":return"PowerPoint"}return"Other"}U0j(){ba.ULS.sendTraceTag(51406241,
307,50,JSON.stringify(this.uji()))}V0j(){const a=this.U2a;for(let c in a){var b=c;const h=a[c];h&&(h.SourceApp=this.PXe,h.Browser=EP.a[this.iHb],h.TagName=b,h.OperationId=this.BHe,ba.ULS.sendTraceTag(51406242,307,50,JSON.stringify(h)))}}MAj(a,b){a&&a.length&&b&&b.length&&(a=a.toLowerCase(),b=b.toLowerCase(),a in this.U2a||(this.U2a[a]={}),this.U2a[a][b]=this.tjj(a,b)+1)}tjj(a,b){if(!(a&&a.length&&b&&b.length&&this.U2a&&a in this.U2a))return 0;a=a.toLowerCase();b=b.toLowerCase();return(a=this.U2a[a])&&
b in a?a[b]:0}uji(){const a={};a.ActionIdFlags=this.Sw;a.FoundDataCcpTimestampAttribute=this.q3d;a.FoundDataClipserviceCcpidAttribute=this.r3d;a.FoundDataShapeIdsAttribute=this.t3d;a.FoundGoogleDocsInternalGuidId=this.u3d;a.FoundOneNoteOnlineSequenceClass=this.UVf;a.FoundPowerPointOnlineSequenceClass=this.v3d;a.FoundWordOnlineSequenceClass=this.w3d;a.ProgId=this.mLe;a.SourceApp=this.PXe;a.FoundText=this.WVf;a.FoundEquation=this.SVf;a.FoundList=this.W3b;a.FoundTable=this.H8a;a.FoundImage=this.TVf;
a.CopySourceBrowser=this.k0b;a.PasteBrowser=this.iHb;a.IsSameBrowserPaste=this.URj(this.k0b,this.iHb);a.IsCrossBrowserPaste=this.SJj(this.k0b,this.iHb);a.IsUncategorizedBrowserPaste=this.OUj(this.k0b,this.iHb);a.Platform=this.platform;a.PastedHtmlLength=this.u9g;a.OperationId=this.BHe;return a}URj(a,b){return 5===a||6===a?!1:a===b}SJj(a,b){return 6===a?!1:a!==b}OUj(a,b){return 5===a&&5===b}}Object(n.a)(NH,"HtmlContentMetadata",null,[]);class fz{constructor(a,b,c=!1){this.Wf=a;this.iw=b;this.idi=c}}
Object(n.a)(fz,"TagEventParam",null,[]);class dC{constructor(a,b=null){this.Wwc=this.Ljf=this.DLd=this.Sof=null;this.Mc=a;this.uS=b||Bm.a.o0f("");this.C$k()}get Mb(){return this.uS}Ikk(a,b,c){this.DLd[b]?this.X_g():(this.Mb.e++,(b=this.Wwc[b])&&b(new fz(a,c,!1)),this.Mb.b++)}X_g(){this.Mb.d++}Bkk(){this.Mb.c++}ukk(a,b,c){if(this.DLd[b])this.X_g();else{if(b=this.Wwc[b])return this.Mb.b++,b(new fz(a,c,!1));this.Mb.f++}return 2}C$k(){this.Sof=Da.a.JH("AREA",!0,"BASE",!0,"BASEFONT",!0,"BR",!0,"COL",!0,
"FRAME",!0,"HR",!0,"IMG",!0,"INPUT",!0,"LINK",!0,"META",!0,"PARAM",!0);this.DLd=Da.a.JH("ABBR",!0,"ACRONYM",!0,"ADDRESS",!0,"BDO",!0,"BODY",!0,"BUTTON",!0,"FIELDSET",!0,"FORM",!0,"FRAMESET",!0,"HTML",!0,"NOFRAMES",!0,"NOSCRIPT",!0,"OPTGROUP",!0,"Q",!0,"SELECT",!0,"TEXTAREA",!0);this.Ljf=Da.a.JH("APPLET",!0,"AREA",!0,"BASE",!0,"BASEFONT",!0,"FRAME",!0,"HEAD",!0,"IFRAME",!0,"INPUT",!0,"ISINDEX",!0,"LINK",!0,"MAP",!0,"META",!0,"OBJECT",!0,"PARAM",!0,"SCRIPT",!0,"STYLE",!0,"TITLE",!0);let a=this.Mc,b=
this.Mc,c=this.Mc,h=this.Mc,m=this.Mc,y=this.Mc,G=this.Mc,U=this.Mc,ja=this.Mc,va=this.Mc,Ta=this.Mc,fb=this.Mc,Db=this.Mc,gc=this.Mc,hc=this.Mc,Gc=this.Mc,Pc=this.Mc,yc=this.Mc,Vd=this.Mc,De=this.Mc;this.Wwc=Da.a.JH("A",Object(F.a)(this.Mc,this.Mc.Xcd,"onAOpen"),"ABBR",Object(F.a)(this.Mc,this.Mc.wEe,"onAbbrOpen"),"ACRONYM",Object(F.a)(this.Mc,this.Mc.xEe,"onAcronymOpen"),"ADDRESS",Object(F.a)(this.Mc,this.Mc.zEe,"onAddressOpen"),"APPLET",Object(F.a)(this.Mc,this.Mc.GEe,"onAppletOpen"),"AREA",Object(F.a)(this.Mc,
this.Mc.JEe,"onAreaTag"),"B",Object(F.a)(this.Mc,this.Mc.cdd,"onBOpen"),"BASE",Object(F.a)(this.Mc,this.Mc.KEe,"onBaseTag"),"BASEFONT",Object(F.a)(this.Mc,this.Mc.LEe,"onBasefontTag"),"BDO",Object(F.a)(this.Mc,this.Mc.MEe,"onBdoOpen"),"BIG",Object(F.a)(this.Mc,this.Mc.idd,"onBigOpen"),"BLOCKQUOTE",Object(F.a)(this.Mc,this.Mc.jdd,"onBlockquoteOpen"),"BODY",Object(F.a)(this.Mc,this.Mc.YEe,"onBodyOpen"),"BR",Object(F.a)(this.Mc,this.Mc.kdd,"onBrTag"),"BUTTON",Object(F.a)(this.Mc,this.Mc.cFe,"onButtonOpen"),
"CAPTION",Object(F.a)(this.Mc,this.Mc.ldd,"onCaptionOpen"),"CENTER",Object(F.a)(this.Mc,this.Mc.ndd,"onCenterOpen"),"CITE",Object(F.a)(this.Mc,this.Mc.rdd,"onCiteOpen"),"CODE",Object(F.a)(this.Mc,this.Mc.tdd,"onCodeOpen"),"COL",Object(F.a)(this.Mc,this.Mc.oFe,"onColTag"),"COLGROUP",Object(F.a)(this.Mc,this.Mc.pFe,"onColgroupOpen"),"DD",Object(F.a)(this.Mc,this.Mc.wdd,"onDdOpen"),"DEL",Object(F.a)(this.Mc,this.Mc.xdd,"onDelOpen"),"DFN",Object(F.a)(this.Mc,this.Mc.zdd,"onDfnOpen"),"DIR",Object(F.a)(this.Mc,
this.Mc.Add,"onDirOpen"),"DIV",Object(F.a)(this.Mc,this.Mc.Cdd,"onDivOpen"),"DL",Object(F.a)(this.Mc,this.Mc.Ddd,"onDlOpen"),"DT",Object(F.a)(this.Mc,this.Mc.Edd,"onDtOpen"),"EM",Object(F.a)(this.Mc,this.Mc.Hdd,"onEmOpen"),"FIELDSET",Object(F.a)(this.Mc,this.Mc.KFe,"onFieldsetOpen"),"FONT",Object(F.a)(this.Mc,this.Mc.Pdd,"onFontOpen"),"FORM",Object(F.a)(this.Mc,this.Mc.QFe,"onFormOpen"),"FRAME",Object(F.a)(this.Mc,this.Mc.RFe,"onFrameTag"),"FRAMESET",Object(F.a)(this.Mc,this.Mc.SFe,"onFramesetOpen"),
"H1",Object(F.a)(this.Mc,this.Mc.Udd,"onH1Open"),"H2",Object(F.a)(this.Mc,this.Mc.Vdd,"onH2Open"),"H3",Object(F.a)(this.Mc,this.Mc.Wdd,"onH3Open"),"H4",Object(F.a)(this.Mc,this.Mc.Xdd,"onH4Open"),"H5",Object(F.a)(this.Mc,this.Mc.Ydd,"onH5Open"),"H6",Object(F.a)(this.Mc,this.Mc.Zdd,"onH6Open"),"HEAD",Object(F.a)(this.Mc,this.Mc.WFe,"onHeadOpen"),"HR",Object(F.a)(this.Mc,this.Mc.$dd,"onHrTag"),"HTML",Object(F.a)(this.Mc,this.Mc.YFe,"onHtmlOpen"),"I",Object(F.a)(this.Mc,this.Mc.aed,"onIOpen"),"IFRAME",
Object(F.a)(this.Mc,this.Mc.$Fe,"onIframeOpen"),"IMG",Object(F.a)(this.Mc,this.Mc.bed,"onImgTag"),"INPUT",Object(F.a)(this.Mc,this.Mc.bGe,"onInputTag"),"INS",Object(F.a)(this.Mc,this.Mc.ced,"onInsOpen"),"ISINDEX",Object(F.a)(this.Mc,this.Mc.iGe,"onIsindexOpen"),"KBD",Object(F.a)(this.Mc,this.Mc.ded,"onKbdOpen"),"LABEL",Object(F.a)(this.Mc,this.Mc.fed,"onLabelOpen"),"LEGEND",Object(F.a)(this.Mc,this.Mc.hed,"onLegendOpen"),"LI",Object(F.a)(this.Mc,this.Mc.ied,"onLiOpen"),"LINK",Object(F.a)(this.Mc,
this.Mc.lGe,"onLinkTag"),"MAP",Object(F.a)(this.Mc,this.Mc.mGe,"onMapOpen"),"MATH",Object(F.a)(this.Mc,this.Mc.ned,"onMathOpen"),"MENU",Object(F.a)(this.Mc,this.Mc.tGb,"onMenuOpen"),"META",Object(F.a)(this.Mc,this.Mc.pGe,"onMetaTag"),"NOFRAMES",Object(F.a)(this.Mc,this.Mc.sGe,"onNoframesOpen"),"NOSCRIPT",Object(F.a)(this.Mc,this.Mc.tGe,"onNoscriptOpen"),"OBJECT",Object(F.a)(this.Mc,this.Mc.uGe,"onObjectOpen"),"OL",Object(F.a)(this.Mc,this.Mc.ved,"onOlOpen"),"OPTGROUP",Object(F.a)(this.Mc,this.Mc.vGe,
"onOptgroupOpen"),"OPTION",Object(F.a)(this.Mc,this.Mc.zed,"onOptionOpen"),"P",Object(F.a)(this.Mc,this.Mc.Ced,"onPOpen"),"PARAM",Object(F.a)(this.Mc,this.Mc.wGe,"onParamTag"),"PRE",Object(F.a)(this.Mc,this.Mc.Oed,"onPreOpen"),"Q",Object(F.a)(this.Mc,this.Mc.GGe,"onQOpen"),"S",Object(F.a)(this.Mc,this.Mc.Wed,"onSOpen"),"SAMP",Object(F.a)(this.Mc,this.Mc.Xed,"onSampOpen"),"SCRIPT",Object(F.a)(this.Mc,this.Mc.RGe,"onScriptOpen"),"SELECT",Object(F.a)(this.Mc,this.Mc.SGe,"onSelectOpen"),"SMALL",Object(F.a)(a,
a.ffd,"onSmallOpen"),"SPAN",Object(F.a)(b,b.gfd,"onSpanOpen"),"STRIKE",Object(F.a)(c,c.hfd,"onStrikeOpen"),"STRONG",Object(F.a)(h,h.ifd,"onStrongOpen"),"STYLE",Object(F.a)(m,m.YGe,"onStyleOpen"),"SUB",Object(F.a)(y,y.jfd,"onSubOpen"),"SUP",Object(F.a)(G,G.kfd,"onSupOpen"),"TABLE",Object(F.a)(U,U.ofd,"onTableOpen"),"TBODY",Object(F.a)(ja,ja.aHe,"onTbodyOpen"),"TD",Object(F.a)(va,va.Sjc,"onTdOpen"),"TEXTAREA",Object(F.a)(Ta,Ta.cHe,"onTextareaOpen"),"TFOOT",Object(F.a)(fb,fb.dHe,"onTfootOpen"),"TH",
Object(F.a)(Db,Db.pfd,"onThOpen"),"THEAD",Object(F.a)(gc,gc.eHe,"onTheadOpen"),"TITLE",Object(F.a)(hc,hc.gHe,"onTitleOpen"),"TR",Object(F.a)(Gc,Gc.qfd,"onTrOpen"),"TT",Object(F.a)(Pc,Pc.tfd,"onTtOpen"),"U",Object(F.a)(yc,yc.ufd,"onUOpen"),"UL",Object(F.a)(Vd,Vd.vfd,"onUlOpen"),"VAR",Object(F.a)(De,De.xfd,"onVarOpen"))}}Object(n.a)(dC,"AHtmlProcessor",null,[]);class eC{constructor(a,b){this.childNodes=a.childNodes;this.iw=b;this.FXd=0;this.UXc=!1}}Object(n.a)(eC,"HtmlProcessorArguments",null,[]);class Xq extends dC{constructor(a,
b=null){super(a,b);this.KCd=null}get WPj(){null==this.KCd&&(this.KCd=u.AFrameworkApplication.fa?u.AFrameworkApplication.fa.ka("CopyAndPasteTextFromWordWin32FixIsEnabled"):!1);return this.KCd}process(a,b=null){a&&(this.Mc.reset(),this.Gbh(new eC(a,new Wt),b))}Gbh(a,b){a.childNodes.length&&(a=new Sh.a(b,Object(F.a)(this,this.WEk,"processChild"),a),a.Nl("HTML Processing Operation"),b||(a.Oi=!0),a.run())}WEk(a,b){const c=b.childNodes[b.FXd];if(3===c.nodeType)return this.Mc.edd(),this.Mc.N0(c.nodeValue,
new fz(c,b.iw.fZf())),Xq.eOb(b);if(1!==c.nodeType)return Xq.eOb(b);if(!b.UXc){const m=ta.a.FB(c.tagName);if(!Xq.Wvj(c))if(this.Ljf[m])this.Bkk();else{Xq.kfk(c);this.Mc.edd();var h=c.id;const y=c.tagName,G=b.iw.fZf(),U=c.getAttribute?c.getAttribute("class"):null;h=new Xt(h,y,U?U:"",c.attributes?c.attributes.length:0);h.isValid&&G.add(h);if(this.Sof[m])return this.Ikk(c,m,G),Xq.eOb(b);h=!1;switch(this.ukk(c,m,G)){case 1:h=!0;break;case 3:return Xq.eOb(b)}switch(this.Mc.C$d(c)){case 1:h=!0}b.UXc=h;this.Gbh(new eC(c,
G),a);if(!a.Oi)return!0}}if(b.UXc){if(this.WPj&&!this.Wwc[ta.a.FB(c.tagName)])return Xq.eOb(b);this.Mc.onClose()}return Xq.eOb(b)}static kfk(a){3!==a.nodeType&&Y.a.Lv(a,"alreadyPasted",!0)}static Wvj(a){return 3!==a.nodeType&&Y.a.ye(a,"alreadyPasted")}static eOb(a){a.FXd++;a.UXc=!1;return a.FXd<a.childNodes.length}}Object(n.a)(Xq,"HtmlProcessor",dC,[]);var Ur=d(930);class OH{constructor(a,b=null,c=null,h=null){this.ee=a;this.uS=b||Bm.a.n0f(v.a.j6a,"");this.uq=c;this.Bqa=h?h.ka("ParseStyleForHtmlTagEventIsEnabled"):
!1}get Mb(){return this.uS}get Mn(){return this.uq}Ef(a){return a?a+1:1}reset(){this.ee.reset()}edd(){this.ee.edd()}C$d(a){if(a&&this.Mn&&(a.getAttribute&&(a.getAttribute(Ur.a.cKf)&&(this.Mn.q3d=!0),a.getAttribute(Ur.a.dKf)&&(this.Mn.r3d=!0),a.getAttribute(Ur.a.hKf)&&(this.Mn.t3d=!0)),a.id&&a.id.startsWith&&a.id.startsWith(Ur.a.i7f)&&(this.Mn.u3d=!0),a.className&&a.className.split))for(const b of a.className.split(" ")){b.startsWith(Ur.a.Y6g)&&(this.Mn.UVf=!0);b.startsWith(Ur.a.iah)&&(this.Mn.v3d=
!0);b.startsWith(Ur.a.eJh)&&(this.Mn.w3d=!0);if(b.startsWith(v.a.ZYb)&&b.length===v.a.ZYb.length+1){const c=parseInt(ta.a.substring(b,b.length-1,b.length));isNaN(c)||(this.Mn.k0b=c)}if(b===Ur.a.KZg||b===Ur.a.LZg)this.Mn.W3b=!0}return this.ee.C$d(a)}onClose(){this.ee.onClose()}N0(a,b){this.Mn&&(this.Mn.WVf=!0);this.Mb.d=this.Ef(this.Mb.d);this.Bqa&&this.kxa(b);this.ee.N0(a,b)}Xcd(a){this.Mb.e=this.Ef(this.Mb.e);this.Bqa&&this.kxa(a);return this.ee.Xcd(a)}wEe(a){this.Mb.f=this.Ef(this.Mb.f);return this.ee.wEe(a)}xEe(a){this.Mb.g=
this.Ef(this.Mb.g);return this.ee.xEe(a)}zEe(a){this.Mb.h=this.Ef(this.Mb.h);return this.ee.zEe(a)}GEe(a){this.Mb.i=this.Ef(this.Mb.i);return this.ee.GEe(a)}JEe(a){this.Mb.j=this.Ef(this.Mb.j);this.ee.JEe(a)}cdd(a){this.Mb.k=this.Ef(this.Mb.k);return this.ee.cdd(a)}KEe(a){this.Mb.l=this.Ef(this.Mb.l);this.ee.KEe(a)}LEe(a){this.Mb.m=this.Ef(this.Mb.m);this.ee.LEe(a)}MEe(a){this.Mb.n=this.Ef(this.Mb.n);return this.ee.MEe(a)}idd(a){this.Mb.o=this.Ef(this.Mb.o);return this.ee.idd(a)}jdd(a){this.Mb.p=
this.Ef(this.Mb.p);return this.ee.jdd(a)}YEe(a){this.Mb.q=this.Ef(this.Mb.q);return this.ee.YEe(a)}kdd(a){this.Mb.r=this.Ef(this.Mb.r);this.ee.kdd(a)}cFe(a){this.Mb.s=this.Ef(this.Mb.s);return this.ee.cFe(a)}ldd(a){this.Mb.t=this.Ef(this.Mb.t);return this.ee.ldd(a)}ndd(a){this.Mb.u=this.Ef(this.Mb.u);return this.ee.ndd(a)}rdd(a){this.Mb.v=this.Ef(this.Mb.v);return this.ee.rdd(a)}tdd(a){this.Mb.w=this.Ef(this.Mb.w);return this.ee.tdd(a)}oFe(a){this.Mb.x=this.Ef(this.Mb.x);this.ee.oFe(a)}pFe(a){this.Mb.y=
this.Ef(this.Mb.y);return this.ee.pFe(a)}wdd(a){this.Mb.z=this.Ef(this.Mb.z);return this.ee.wdd(a)}xdd(a){this.Mb.ba=this.Ef(this.Mb.ba);return this.ee.xdd(a)}zdd(a){this.Mb.bb=this.Ef(this.Mb.bb);return this.ee.zdd(a)}Add(a){this.Mb.bc=this.Ef(this.Mb.bc);return this.ee.Add(a)}Cdd(a){this.Mb.bd=this.Ef(this.Mb.bd);return this.ee.Cdd(a)}Ddd(a){this.Mb.be=this.Ef(this.Mb.be);return this.ee.Ddd(a)}Edd(a){this.Mb.bf=this.Ef(this.Mb.bf);return this.ee.Edd(a)}Hdd(a){this.Mb.bg=this.Ef(this.Mb.bg);return this.ee.Hdd(a)}KFe(a){this.Mb.bh=
this.Ef(this.Mb.bh);return this.ee.KFe(a)}Pdd(a){this.Mb.bi=this.Ef(this.Mb.bi);return this.ee.Pdd(a)}QFe(a){this.Mb.bj=this.Ef(this.Mb.bj);return this.ee.QFe(a)}RFe(a){this.Mb.bk=this.Ef(this.Mb.bk);this.ee.RFe(a)}SFe(a){this.Mb.bl=this.Ef(this.Mb.bl);return this.ee.SFe(a)}Udd(a){this.Mb.bm=this.Ef(this.Mb.bm);return this.ee.Udd(a)}Vdd(a){this.Mb.bm=this.Ef(this.Mb.bm);return this.ee.Vdd(a)}Wdd(a){this.Mb.bm=this.Ef(this.Mb.bm);return this.ee.Wdd(a)}Xdd(a){this.Mb.bm=this.Ef(this.Mb.bm);return this.ee.Xdd(a)}Ydd(a){this.Mb.bm=
this.Ef(this.Mb.bm);return this.ee.Ydd(a)}Zdd(a){this.Mb.bm=this.Ef(this.Mb.bm);return this.ee.Zdd(a)}WFe(a){this.Mb.bn=this.Ef(this.Mb.bn);return this.ee.WFe(a)}$dd(a){this.Mb.bo=this.Ef(this.Mb.bo);this.ee.$dd(a)}YFe(a){this.Mb.bp=this.Ef(this.Mb.bp);return this.ee.YFe(a)}aed(a){this.Mb.bq=this.Ef(this.Mb.bq);return this.ee.aed(a)}$Fe(a){this.Mb.br=this.Ef(this.Mb.br);return this.ee.$Fe(a)}bed(a){this.Mn&&(this.Mn.TVf=!0);this.Bqa&&this.kxa(a);this.Mb.bs=this.Ef(this.Mb.bs);this.ee.bed(a)}bGe(a){this.Mb.bt=
this.Ef(this.Mb.bt);this.ee.bGe(a)}ced(a){this.Mb.bu=this.Ef(this.Mb.bu);return this.ee.ced(a)}iGe(a){this.Mb.bv=this.Ef(this.Mb.bv);return this.ee.iGe(a)}ded(a){this.Mb.bw=this.Ef(this.Mb.bw);return this.ee.ded(a)}fed(a){this.Mb.bx=this.Ef(this.Mb.bx);return this.ee.fed(a)}hed(a){this.Mb.by=this.Ef(this.Mb.by);return this.ee.hed(a)}ied(a){this.Mn&&(this.Mn.W3b=!0);this.Mb.bz=this.Ef(this.Mb.bz);this.Bqa&&this.kxa(a);return this.ee.ied(a)}lGe(a){this.Mb.ca=this.Ef(this.Mb.ca);this.ee.lGe(a)}mGe(a){this.Mb.cb=
this.Ef(this.Mb.cb);return this.ee.mGe(a)}ned(a){this.Mn&&(this.Mn.SVf=!0);this.Mb.cc=this.Ef(this.Mb.cc);return this.ee.ned(a)}tGb(a){this.Mb.cd=this.Ef(this.Mb.cd);return this.ee.tGb(a)}pGe(a){this.Mb.ce=this.Ef(this.Mb.ce);this.ee.pGe(a)}sGe(a){this.Mb.cf=this.Ef(this.Mb.cf);return this.ee.sGe(a)}tGe(a){this.Mb.cg=this.Ef(this.Mb.cg);return this.ee.tGe(a)}uGe(a){this.Mb.ch=this.Ef(this.Mb.ch);return this.ee.uGe(a)}ved(a){this.Mn&&(this.Mn.W3b=!0);this.Mb.ci=this.Ef(this.Mb.ci);this.Bqa&&this.kxa(a);
return this.ee.ved(a)}vGe(a){this.Mb.cj=this.Ef(this.Mb.cj);return this.ee.vGe(a)}zed(a){this.Mb.ck=this.Ef(this.Mb.ck);return this.ee.zed(a)}Ced(a){this.Mb.cl=this.Ef(this.Mb.cl);this.Bqa&&this.kxa(a);return this.ee.Ced(a)}wGe(a){this.Mb.cm=this.Ef(this.Mb.cm);this.ee.wGe(a)}Oed(a){this.Mb.cn=this.Ef(this.Mb.cn);return this.ee.Oed(a)}GGe(a){this.Mb.co=this.Ef(this.Mb.co);return this.ee.GGe(a)}Wed(a){this.Mb.cp=this.Ef(this.Mb.cp);return this.ee.Wed(a)}Xed(a){this.Mb.cq=this.Ef(this.Mb.cq);return this.ee.Xed(a)}RGe(a){this.Mb.cr=
this.Ef(this.Mb.cr);return this.ee.RGe(a)}SGe(a){this.Mb.cs=this.Ef(this.Mb.cs);return this.ee.SGe(a)}ffd(a){this.Mb.ct=this.Ef(this.Mb.ct);return this.ee.ffd(a)}gfd(a){this.Mb.cu=this.Ef(this.Mb.cu);this.Bqa&&this.kxa(a);return this.ee.gfd(a)}hfd(a){this.Mb.cv=this.Ef(this.Mb.cv);return this.ee.hfd(a)}ifd(a){this.Mb.cw=this.Ef(this.Mb.cw);return this.ee.ifd(a)}YGe(a){this.Mb.cx=this.Ef(this.Mb.cx);return this.ee.YGe(a)}jfd(a){this.Mb.cy=this.Ef(this.Mb.cy);return this.ee.jfd(a)}kfd(a){this.Mb.cz=
this.Ef(this.Mb.cz);return this.ee.kfd(a)}ofd(a){this.Mn&&(this.Mn.H8a=!0);this.Mb.da=this.Ef(this.Mb.da);this.Bqa&&this.kxa(a);return this.ee.ofd(a)}aHe(a){this.Mn&&(this.Mn.H8a=!0);this.Mb.db=this.Ef(this.Mb.db);this.Bqa&&this.kxa(a);return this.ee.aHe(a)}Sjc(a){this.Mn&&(this.Mn.H8a=!0);this.Mb.dc=this.Ef(this.Mb.dc);this.Bqa&&this.kxa(a);return this.ee.Sjc(a)}cHe(a){this.Mb.dd=this.Ef(this.Mb.dd);return this.ee.cHe(a)}dHe(a){this.Mb.de=this.Ef(this.Mb.de);return this.ee.dHe(a)}pfd(a){this.Mn&&
(this.Mn.H8a=!0);this.Mb.df=this.Ef(this.Mb.df);return this.ee.pfd(a)}eHe(a){this.Mn&&(this.Mn.H8a=!0);this.Mb.dg=this.Ef(this.Mb.dg);return this.ee.eHe(a)}gHe(a){this.Mb.dh=this.Ef(this.Mb.dh);return this.ee.gHe(a)}qfd(a){this.Mn&&(this.Mn.H8a=!0);this.Mb.di=this.Ef(this.Mb.di);return this.ee.qfd(a)}tfd(a){this.Mb.dj=this.Ef(this.Mb.dj);return this.ee.tfd(a)}ufd(a){this.Mb.dk=this.Ef(this.Mb.dk);return this.ee.ufd(a)}vfd(a){this.Mn&&(this.Mn.W3b=!0);this.Mb.dl=this.Ef(this.Mb.dl);return this.ee.vfd(a)}xfd(a){this.Mb.dm=
this.Ef(this.Mb.dm);return this.ee.xfd(a)}kxa(a){if((a=a.Wf)&&a.style&&this.Mn){var b=a.style;if(b)for(const c of b)c&&0<c.length&&this.Mn.MAj(a.tagName,c)}}}Object(n.a)(OH,"HtmlEventUsageCollector",null,[1166]);class PH{constructor(a,b=null,c=null){this.ee=a;this.uS=b||Bm.a.b4f("");this.E0h=c||Bm.a.c4f("")}get Mb(){return this.uS}get OZe(){return this.E0h}mY(a){this.OZe.b++;this.ee.mY(a)}jY(){this.ee.jY()}lY(a){this.OZe.c++;this.ee.lY(a)}kY(){this.ee.kY()}iY(a){this.OZe.d++;this.ee.iY(a)}hY(){this.ee.hY()}reset(){this.ee.reset()}get q1b(){return this.ee.q1b}N0(a,
b){this.Mb.b++;this.ee.N0(a,b)}lna(a){this.Mb.c++;this.ee.lna(a)}NYa(a){this.Mb.b++;this.ee.NYa(a)}kna(a){this.Mb.d++;this.ee.kna(a)}jna(a){this.Mb.f++;this.ee.jna(a)}Owa(a,b){this.Mb.g++;this.ee.Owa(a,b)}Nwa(){this.ee.Nwa()}nA(a){this.Mb.h++;this.ee.nA(a)}mA(){this.ee.mA()}HYa(){this.ee.HYa()}GYa(){this.ee.GYa()}Twa(a,b){this.Mb.i++;this.ee.Twa(a,b)}WIa(){this.ee.WIa()}ona(a){this.Mb.j++;this.ee.ona(a)}mna(){this.ee.mna()}Swa(a){this.Mb.k++;this.ee.Swa(a)}nna(){this.ee.nna()}IYa(a){this.Mb.l++;this.ee.IYa(a)}}
Object(n.a)(PH,"SemanticEventUsageCollector",null,[1106,386]);class fC{constructor(a){this.xh=a}reset(){this.xh.reset()}get q1b(){return this.xh.q1b}N0(a,b){this.xh.N0(a,b)}lna(a){this.xh.lna(a)}NYa(a){this.xh.NYa(a)}kna(a){this.xh.kna(a)}jna(a){this.xh.jna(a)}Owa(a,b){this.xh.Owa(a,b)}Nwa(){this.xh.Nwa()}nA(a){this.xh.nA(a)}mA(){this.xh.mA()}HYa(){this.xh.HYa()}GYa(){this.xh.GYa()}ona(a){this.xh.ona(a)}mna(){this.xh.mna()}Swa(a){this.xh.Swa(a)}nna(){this.xh.nna()}IYa(a){this.xh.IYa(a)}mY(a){this.xh.mY(a)}jY(){this.xh.jY()}lY(a){this.xh.lY(a)}kY(){this.xh.kY()}iY(a){this.xh.iY(a)}hY(){this.xh.hY()}Twa(a,
b){this.xh.Twa(a,b)}WIa(){this.xh.WIa()}}Object(n.a)(fC,"AHtmlNormalizer",null,[1106,386]);class gC extends fC{constructor(a){super(a);this.$C=!1}N0(a,b){this.$C?this.dG.uF(()=>{this.iLe(a,b)}):this.iLe(a,b)}iLe(a,b){this.xh.N0(a,b)}lna(a){this.$C?this.dG.uF(()=>{this.JKe(a)}):this.JKe(a)}JKe(a){this.xh.lna(a)}kna(a){this.$C?this.dG.uF(()=>{this.Rlc(a)}):this.Rlc(a)}Rlc(a){this.xh.kna(a)}jna(a){this.$C?this.dG.uF(()=>{this.IKe(a)}):this.IKe(a)}IKe(a){this.xh.jna(a)}Owa(a,b){this.$C?this.dG.uF(()=>
{this.DKe(a,b)}):this.DKe(a,b)}DKe(a,b){this.xh.Owa(a,b)}Nwa(){this.$C?this.dG.uF(Object(F.a)(this,this.CKe,"processAnchorEnd")):this.CKe()}CKe(){this.xh.Nwa()}nA(a){this.$C?this.dG.uF(()=>{this.TKe(a)}):this.TKe(a)}TKe(a){this.xh.nA(a)}mA(){this.$C?this.dG.uF(Object(F.a)(this,this.SKe,"processParagraphEnd")):this.SKe()}SKe(){this.xh.mA()}HYa(){this.$C?this.dG.uF(Object(F.a)(this,this.VKe,"processPreFormattedTextStart")):this.VKe()}VKe(){this.xh.HYa()}GYa(){this.$C?this.dG.uF(Object(F.a)(this,this.UKe,
"processPreFormattedTextEnd")):this.UKe()}UKe(){this.xh.GYa()}ona(a){this.$C?this.dG.uF(()=>{this.NKe(a)}):this.NKe(a)}NKe(a){this.xh.ona(a)}mna(){this.$C?this.dG.uF(Object(F.a)(this,this.KKe,"processListEnd")):this.KKe()}KKe(){this.xh.mna()}Swa(a){this.$C?this.dG.uF(()=>{this.MKe(a)}):this.MKe(a)}MKe(a){this.xh.Swa(a)}nna(){this.$C?this.dG.uF(Object(F.a)(this,this.LKe,"processListItemEnd")):this.LKe()}LKe(){this.xh.nna()}mY(a){this.$C?this.dG.uF(()=>{this.hLe(a)}):this.hLe(a)}hLe(a){this.xh.mY(a)}jY(){this.$C?
this.dG.uF(Object(F.a)(this,this.eLe,"processTableEnd")):this.eLe()}eLe(){this.xh.jY()}lY(a){this.$C?this.dG.uF(()=>{this.gLe(a)}):this.gLe(a)}gLe(a){this.xh.lY(a)}kY(){this.$C?this.dG.uF(Object(F.a)(this,this.fLe,"processTableRowEnd")):this.fLe()}fLe(){this.xh.kY()}iY(a){this.$C?this.dG.uF(()=>{this.dLe(a)}):this.dLe(a)}dLe(a){this.xh.iY(a)}hY(){this.$C?this.dG.uF(Object(F.a)(this,this.cLe,"processTableCellEnd")):this.cLe()}cLe(){this.xh.hY()}Twa(a,b){this.$C?this.dG.uF(()=>{this.OKe(a,b)}):this.OKe(a,
b)}OKe(a,b){this.xh.Twa(a,b)}WIa(){this.$C?this.dG.uF(Object(F.a)(this,this.Tbh,"processMathEnd")):this.Tbh()}Tbh(){this.xh.WIa()}}Object(n.a)(gC,"AQueuingHtmlNormalizer",fC,[]);class QH{constructor(a){this.next=null;this.data=a}}Object(n.a)(QH,"QueueNode",null,[]);class hC{constructor(){this.H2a=this.O1a=null;this.Yk=0}get count(){return this.Yk}get isEmpty(){return!this.Yk||!this.O1a||!this.H2a}enqueue(a){a=new QH(a);this.isEmpty?this.H2a=this.O1a=a:this.O1a=this.O1a.next=a;this.Yk++}back(){return this.isEmpty?
null:this.O1a.data}dequeue(){if(this.isEmpty)return null;const a=this.H2a;this.H2a=a.next;this.Yk--;this.H2a||(this.O1a=null);return a.data}clear(){this.H2a=this.O1a=null;this.Yk=0}toArray(){const a=Array(this.count);let b=this.H2a;for(let c=0;c<this.count&&b;c++)a[c]=b.data,b=b.next;return a}}Object(n.a)(hC,"Queue",null,[]);class mx{constructor(){this.yHd=new hC}uF(a){this.yHd.enqueue(a)}flush(a=!1){for(a&&this.mnd();!this.yHd.isEmpty;)this.yHd.dequeue()();a&&this.Mkd()}mnd(){}Mkd(){}}Object(n.a)(mx,
"QueuedEventManager",null,[]);class gz extends mx{constructor(a){super();this.id=void 0;this.KXd=null;this.QYc=!1;this.xkc="";this.PYc=this.FZc=!1;this.IXd=this.Gtb=null;this.Eic=0;this.m9b=this.x$b=this.$ke=!1;this.table=null;this.ADe=0;this.BP=a}get fYb(){return!!this.table}mnd(){this.BP.RGb.push(this.BP.currentState);this.BP.currentState=this}Mkd(){this.BP.currentState=this.BP.RGb.pop()}}gz.nextId=void 0;Object(n.a)(gz,"ContentState",mx,[]);class RH{constructor(a,b,c){this.colSpan=a.colSpan;this.rowSpan=
a.rowSpan;this.width=a.width;this.height=a.height;this.sFa=a.sFa;this.Ppc=a.Ppc;this.verticalAlignment=a.verticalAlignment;this.f6=a.f6;this.Tqd=a.Tqd;this.Bzb=a.Bzb;this.vIc=a.vIc;this.contents=c;this.Qnj=b}}Object(n.a)(RH,"TableCell",null,[]);class SH extends mx{constructor(a,b){super();this.BP=a;this.tnf=new Wt;this.rG=new Wt;this.QEd=[];this.yCc=[];this.Epa=-1;this.Qza=0;this.QSh=b.Beg;this.PSh=b.lIj;this.w0h=b.EZe;this.s5a=b.width;this.Fdf=b.sFa;this.xRh=new Qm(new Xt(b.BU.vag,b.BU.w7b),b.iw,
b.t5,b.cultureName,b.aia);this.nSh=b.rce;this.EDc=b.uyh;this.C0h=b.tableLook}get xh(){return this.BP.xh}YDk(a){this.Epa++;this.tnf.add(a);this.yCc[this.Epa]=a.height;this.Qza=0}get CHi(){for(;this.Qza>=this.rG.count;)this.rG.add(Array(this.Epa+1));return this.rG.ga(this.Qza)}VMd(a,b,c,h,m,y,G){if(0>this.Epa)return!1;for(;this.QEd[this.Qza]>=this.Epa;)this.Qza++;a=new RH(a,new Qm(b,c,h,m,y),G);this.CHi[this.Epa]=a;if(1<a.rowSpan)for(b=this.Epa+a.rowSpan-1,h=this.Qza,c=this.Qza+a.colSpan-1;h<=c;h++)this.QEd[h]>=
b||(this.QEd[h]=b);this.Qza+=a.colSpan;this.yCc[this.Epa]<a.height&&(this.yCc[this.Epa]=a.height);return!0}mnd(){this.BP.currentState.table=this}Mkd(){this.BP.currentState.table=null}bVf(){this.flush(!0);const a=this.Epa+1;var b=Array(a);for(var c=0;c<a;c++)b[c]=Array(this.rG.count);c=!0;var h=0;for(var m=0;m<this.rG.count;m++){var y=this.rG.ga(m),G=!0;for(var U=0;U<a;U++){var ja=y[U];ja&&(G=!1,b[U][m+h]=new bz(ja.colSpan,ja.rowSpan,ja.width,ja.height,void 0,void 0,void 0,void 0,ja.sFa,ja.Bzb))}G?
(this.rG.removeAt(m),m--,++h):c=!1}if(!c){(b=this.Fdf?this.BP.zAf(b,this.s5a/100):this.BP.zAf(b))&&b.length!==this.rG.count&&(b=null);this.BP.eDa(!0);this.BP.iJc();this.xh.mY(new ZB(a,this.rG.count,this.s5a,this.Fdf,b,this.QSh,this.PSh,this.w0h,this.nSh,this.EDc,this.C0h,this.xRh));for(b=0;b<a;b++){c=this.tnf.ga(b);this.xh.lY(new YB(this.yCc[b],new Qm(c.BU,c.iw,c.t5,c.cultureName,c.aia)));for(c=0;c<this.rG.count;c++){h=this.rG.ga(c)[b];var va=!!this.EDc&&""!==this.EDc&&"Custom"!==this.EDc;m=h?h.colSpan:
0;y=h?h.rowSpan:0;G=h?h.width:0;U=h?h.height:0;ja=h?h.vIc:0;const Ta=h?h.sFa:!1,fb=h&&(65536&ja||!va)?h.Ppc:"",Db=h?h.verticalAlignment:0,gc=h?h.Bzb:!1;va=h?this.BP.Icj(h.f6,c,b,this.rG,va,h.vIc):new UB;const hc=h?h.Tqd:new VB,Gc=h?h.Qnj:null;this.xh.iY(new bz(m,y,G,U,fb,Db,va,hc,Ta,gc,ja,new Qm(Gc?Gc.BU:null,Gc?Gc.iw:null,Gc?Gc.t5:null,Gc?Gc.cultureName:null,Gc?Gc.aia:null)));h&&!h.Bzb&&(h.contents.mnd(),h.contents.flush(),this.BP.eDa(!1),this.BP.iJc(),h.contents.Mkd());this.xh.hY()}this.xh.kY()}this.xh.jY();
this.BP.currentState.m9b=!1;this.BP.pQf(!1)}}}Object(n.a)(SH,"NormalizedTable",mx,[]);class iC{constructor(a=!1,b=!1){this.nTh=a;this.hI=b}get cNj(){return this.nTh}get YU(){return this.hI}}Object(n.a)(iC,"HtmlNormalizerSettings",null,[302]);class Vr extends gC{constructor(a,b=null){super(a);this.currentState=null;this.RGb=new ix;this.Nnb=b||new iC}reset(){super.reset();this.currentState=new gz(this);this.RGb.clear();this.$C=!1}get dG(){return this.currentState&&this.currentState.fYb?this.currentState.table:
this.currentState}UNc(a=!1){this.currentState.QYc||(this.iJc(),this.xh.nA(this.currentState.KXd),this.currentState.QYc=!0,this.currentState.m9b=!1);a||!this.currentState.Gtb||this.currentState.PYc||(this.xh.Owa(this.currentState.Gtb,this.currentState.IXd),this.currentState.PYc=!0)}L2b(){this.currentState.PYc&&(this.xh.Nwa(),this.currentState.PYc=!1)}mRi(){this.currentState.QYc&&(this.xh.mA(),this.currentState.QYc=!1,this.currentState.xkc="")}pQf(a){this.currentState.x$b&&(this.currentState.m9b?a||
(this.xh.nA(null),this.xh.mA(),this.xh.nna(),this.currentState.x$b=!1):(this.xh.nna(),this.currentState.x$b=!1,this.currentState.m9b=!0))}eDa(a){this.L2b();this.mRi();this.pQf(a)}jvk(a){this.xh.ona(new jx(2,1,a));this.currentState.Eic++;this.currentState.$ke=!0}iJc(){!this.currentState.x$b&&this.currentState.$ke&&(this.xh.mna(),this.currentState.Eic--,this.currentState.$ke=!1)}iLe(a,b){a=this.Ojk(a);if(""!==a)if(this.UNc(),this.currentState.FZc)this.jLe(a,b);else{a=a.split(Vr.qmi);for(let c=0;c<a.length-
1;c++)this.jLe(a[c],b),this.xh.NYa(b);this.jLe(a[a.length-1],b)}}OKe(a,b){""!==a&&(this.UNc(),this.xh.Twa(a,b))}JKe(a){this.Nnb.YU||this.L2b();this.UNc(!0);this.xh.lna(a)}IKe(a){this.currentState.fYb||this.xh.jna(a)}Rlc(a){this.currentState.Gtb&&(a.href=this.currentState.Gtb);super.Rlc(a)}DKe(a,b){this.L2b();this.currentState.Gtb=a;this.currentState.IXd=b}CKe(){this.L2b();this.currentState.Gtb=null;this.currentState.IXd=null}TKe(a){this.currentState.KXd=a;this.eDa(!0)}SKe(){this.currentState.KXd=
null;this.eDa(!0)}VKe(){this.currentState.FZc=!0}UKe(){this.currentState.FZc=!1}NKe(a){this.eDa(!1);this.iJc();this.xh.ona(a);this.currentState.Eic++}KKe(){this.eDa(!1);this.xh.mna();this.currentState.Eic--}MKe(a){this.eDa(!1);this.currentState.Eic||this.jvk(a);this.xh.Swa(a);this.currentState.x$b=!0;this.currentState.m9b=!0}LKe(){this.eDa(!1)}mY(a){this.currentState.fYb||(this.$C=!0,this.currentState.table=new SH(this,a))}hLe(){}jY(){if(this.currentState.table){var a=this.currentState.table;this.currentState.table=
null;this.RGb.isEmpty?(this.$C=!1,a.bVf()):this.dG.uF(Object(F.a)(a,a.bVf,"flushTable"))}}eLe(){}lY(a){this.currentState.fYb&&this.currentState.table.YDk(a)}gLe(){}kY(){}fLe(){}iY(a){let b=!1;if(this.currentState.fYb){const c=new gz(this);this.currentState.table.VMd(a,new Xt(a.BU.vag,a.BU.w7b),a.iw,a.t5,a.cultureName,a.aia,c)?(this.RGb.push(this.currentState),this.currentState=c):b=!0}else b=!0;b&&this.currentState.ADe++}dLe(){}hY(){0<this.currentState.ADe?this.currentState.ADe--:this.currentState=
this.RGb.pop()}cLe(){}zAf(a,b=1){if(!a)return null;const c=a.length;if(!c)return null;const h=a[0].length;for(var m=1;m<c;m++)if(a[m].length!==h)return null;m=Array(h+1);m[0]=0;const y=Array(h+1);for(var G=0;G<y.length;G++)y[G]=!1;G=new Qa.a;for(let ja=0;ja<h;ja++){for(var U=0;U<c;U++)if(a[U][ja]&&0<a[U][ja].width){const va=Math.min(ja+a[U][ja].colSpan,h);m[va]=m[ja]+a[U][ja].width*(a[U][ja].sFa?b:1);y[va]=!0}if(y[ja+1]){U=m[ja+1]-m[ja];if(0>=U)return null;G.add(U)}else m[ja+1]=m[ja]}return G.toArray()}Ifk(a,
b){1&b||(a.borderTopStyle=12);16&b||(a.borderRightStyle=12);256&b||(a.borderBottomStyle=12);4096&b||(a.borderLeftStyle=12);return a}Icj(a,b,c,h,m,y){if(!a)return null;m&&(a=this.Ifk(a,y));if(0>c||0>b||b>h.count-1)return a;0<=b-1&&c<=h.ga(b-1).length-1&&1===a.borderLeftStyle&&(m=h.ga(b-1)[c])&&1!==m.f6.borderRightStyle&&(a.borderLeftStyle=m.f6.borderRightStyle,a.borderLeftColor=m.f6.borderRightColor,a.borderLeftWidth=m.f6.borderRightWidth);0<=c-1&&c<=h.ga(b).length-1&&1===a.borderTopStyle&&(b=h.ga(b)[c-
1])&&1!==b.f6.borderBottomStyle&&(a.borderTopStyle=b.f6.borderBottomStyle,a.borderTopColor=b.f6.borderBottomColor,a.borderTopWidth=b.f6.borderBottomWidth);return a}Ojk(a){this.currentState.FZc||(a=this.Nnb.cNj?a.replace(Vr.Hyj," "):a.replace(Vr.Gyj," "));a.startsWith(" ")&&(this.currentState.xkc.endsWith(" ")||""===this.currentState.xkc)&&(a=ta.a.substring(a,1,a.length));return a}jLe(a,b){""!==a&&(this.xh.N0(a,b),this.currentState.xkc+=a)}}Vr.Gyj=RegExp("[ \t\f\u200b\r\n]+","g");Vr.Hyj=RegExp("[ \f\u200b\r\n]+",
"g");Vr.qmi="\t";Object(n.a)(Vr,"DefaultHtmlNormalizer",gC,[]);class TH extends Vr{constructor(a,b,c){super(a,c);this.abf=!1;this.X2a=b}Rlc(a){this.X2a.Agd&&(u.AFrameworkApplication.LQ?this.abf||(a=new Rf.StandardDialog,a.xd=0,a.Xe(1,CommonUIStrings.l_DialogClose),a.Bx(CommonUIStrings.l_DefaultDialogTitle,Box4Intl.Box4Strings.l_SignInToPasteImages,1,null),this.abf=!0):this.X2a.rgk?this.X2a.WXg=!0:a.src&&""!==a.src?ng.a.pQ(a.src)===ng.a.pQ(window.location.href)?u.AFrameworkApplication.Ta.processAction(D.a.z9g,
2):a.src.startsWith("data:")&&19922944<a.src.length?u.AFrameworkApplication.Ta.processAction(D.a.x9g,2):a.src.startsWith("webkit-fake-url")?u.AFrameworkApplication.Ta.processAction(D.a.w9g,2):(J.a.instance.ga(1)?this.eDa(!1):J.a.instance.ga(11)&&(this.L2b(),this.UNc(!0)),this.xh.kna(a)):u.AFrameworkApplication.Ta.processAction(D.a.y9g,2))}}Object(n.a)(TH,"Box4HtmlNormalizer",Vr,[]);class UH{constructor(a,b,c,h,m,y,G,U,ja,va){this.htmlProcessor=a;this.Ube=b;this.dJh=c;this.IZi=h;this.D2k=m;this.E2k=
y;this.DVc=G;this.Ayj=U;this.Cyj=ja;this.OYj=va}}Object(n.a)(UH,"ExecutePasteArguments",null,[]);class VH extends wj{constructor(a,b,c,h,m,y,G,U,ja,va,Ta,fb,Db){super(b,c,h,Ta);this.S6=null;this.Kha=a;this.Iwd=m;this.uBd=y;this.FKd=G;this.nMd=U;this.pSb=ja;this.Nnb=Db;this.$a=va;this.vbf=Object.assign(new WB,{xyb:2===this.ph.vQa||3===this.ph.vQa});this.Gzd=fb;this.WVb=va.ka("GatherMetadataAboutExternalPastedHTMLContentIsEnabled");this.TZh=va.ka("ParseStyleFromRawHtmlHeadIsEnabled")}get Lcd(){return!1}get cfg(){return!ta.a.bpl(ta.a.Nzc,
this.Kha.innerText)}get XFf(){return this.Kha.innerText}pRf(a){this.S6=new rb.GraphIterator;this.jhb.restore(this.S6);ba.ULS.shipAssertTag(6305550,307,Kd.OutlineElementReader.Wg(this.S6));this.ph.P0&&this.ph.P0.GGc("external");var b=this.ph.Sw&8192?1:0,c=this.uBd.value.create(b,this.S6);const h=this.FKd.value.create(b,this.S6),m=Bm.a.b$d(u.AFrameworkApplication.userSessionId),y=Bm.a.V5d(v.a.j6a,this.ph.fUd),G=Bm.a.b4f(u.AFrameworkApplication.userSessionId),U=Bm.a.c4f(u.AFrameworkApplication.userSessionId),
ja=this.WVb?this.eDj():null,va=Bm.a.n0f(v.a.j6a,this.ph.fUd),Ta=Bm.a.o0f(u.AFrameworkApplication.userSessionId),fb=this.pSb.eth?Bm.a.Laj(u.AFrameworkApplication.userSessionId):null;b=this.Iwd.value.create(b,this.S6,c,h,null,y);b=new PH(b,G,U);b=new TH(b,c,this.Nnb);b=new ul(b,this.pSb,this.vbf,fb);b=new OH(b,va,ja,this.$a);b=new Xq(b,Ta);c=new UH(b,c,m,y,G,U,ja,va,Ta,fb);c=new Sh.a(a,Object(F.a)(this,this.$Dk,"preprocessStyle"),c);c.Nl("paste and request pictures");c.Oi=!a||a.Oi;c.run()}$Dk(a){if(this.TZh){const b=
this.Kha.getElementsByTagName("style");if(b&&0<b.length){ba.ULS.sendTraceTag(41211203,307,50,"Detect <style> tags in pasted content and start converting to inline style.");for(let c=0;c<b.length;c++)this.Gzd.xzi(this.Kha,b[c]),b[c]&&(b[c].parentNode.removeChild(b[c]),c--)}}a.$g(Object(F.a)(this,this.Pzi,"convertWordListHtml"));return!0}Pzi(a,b){this.nMd.value.create(b.dJh).process(this.Kha,a);a.$g(Object(F.a)(this,this.kFk,"processHtml"));return!0}kFk(a,b){b.htmlProcessor.process(this.Kha,a);b=b.Ube&&
b.Ube.Agd?Object(F.a)(this,this.Kkd,"requestImages"):Object(F.a)(this,this.FPf,"endPasteOperation");a.$g(b);return!0}Kkd(a,b){if(b=b.Ube){let c=!1,h=!1,m=!1,y=!1,G=-1;const U=new E.DictionaryPropertySet,ja=RegExp('imagedata\\s+src="file:.*AppData\\/Local\\/Temp');if(Object(za.a)(10,this.ph.rd)){c=this.ph.rd.sa(jb.a.Eie,!1);const va=this.ph.rd.sa(xc.a.FU,"");m=this.ph.rd.sa(xc.a.KYc,!1);y=this.ph.rd.sa(kb.a.UN,!1);ja.test(va)&&(h=!0);this.gth&&(G=this.ph.rd.sa(Js.a.k2b,-1))}else this.ph.Sw&256&&this.Kha&&
(c=!0,ja.test(this.Kha.innerHTML)&&(h=!0));U.setValue(jb.a.Eie,c);U.setValue(xc.a.WUj,h);U.setValue(xc.a.KYc,m);U.setValue(Js.a.k2b,G);U.setValue(kb.a.UN,y);b.e0g&&(this.ph.j9b=!0,this.ph.jce=b.jMc,this.ph.mEe=b.e0g,u.AFrameworkApplication.Ta.processAction(D.a.Kkd,2))}a.$g(Object(F.a)(this,this.FPf,"endPasteOperation"));return!0}FPf(a,b){Bm.a.W2j(b.dJh);Bm.a.X0j(b.Cyj);Bm.a.j2j(b.D2k);Bm.a.k2j(b.E2k);Bm.a.p1j(b.OYj);a="Others";b.DVc&&(b.DVc.U0j(),b.DVc.V0j(),a=b.DVc.PXe);Bm.a.W0j(b.Ayj,a);Bm.a.L0j(b.IZi,
a);return!1}eDj(){const a=new NH;a.iHb=v.a.j6a;this.ph&&(a.Sw=this.ph.Sw,a.BHe=this.ph.fUd,this.ph.rd&&(a.mLe=this.ph.rd.sa(xc.a.v9g,"")));this.Kha&&this.Kha.innerHTML&&(a.u9g=this.Kha.innerHTML.length);u.AFrameworkApplication.gd&&(a.platform=u.AFrameworkApplication.gd.Platform);return a}get vth(){return!0}get uth(){ba.ULS.shipAssertTag(6305551,307,!!this.S6);if(this.pSb.fth(this.vbf)){let a=!1;Kd.OutlineElementReader.Wg(this.S6)&&(this.S6.n6b(),a=!0);const b=Ob.ParagraphReader.fl(this.S6)&&!this.S6.currentNode.sa(xc.a.Tfg,
!1);a&&this.S6.zc();return b}return Ob.ParagraphReader.fl(this.S6)}}Object(n.a)(VH,"ExternalPasteExecutionManager",wj,[]);class WH{constructor(a,b,c,h,m,y,G,U){this.Iwd=a;this.uBd=b;this.FKd=c;this.nMd=h;this.pSb=m;this.$a=y;this.Gzd=G;this.Nnb=U}create(a,b,c,h){return new VH(a,b,c,h,this.Iwd,this.uBd,this.FKd,this.nMd,this.pSb,this.$a,Fc.App.Kb.Jd,this.Gzd,this.Nnb)}}Object(n.a)(WH,"Factory",null,[1036]);class hz{constructor(a){this.ska=a.x$i();this.Z9a=a.RRc("intCopy");this.Sfd=a.E7d("intCopy");
this.D6a=a.MQc("intCopy");this.NPa=a.zQc("intCopy")}static EW(){return hz.ur()}static ur(){return new hz(jc.a.instance)}}Object(n.a)(hz,"InternalCopyUsageHelper",null,[]);class nx{constructor(a,b,c){this.dN=hz.EW();this.LIc=null;this.Ood=this.Vtd=!1;this.v$e=null;this.source=a;this.target=b;this.$He=c}get w6(){return this.dN}get $K(){return this.v$e}set $K(a){this.v$e=a}}Object(n.a)(nx,"InternalCopyArguments",null,[]);class XH extends nx{constructor(a,b,c,h){super(a,b,{});this.wKb=[];for(a=0;a<c.length;a++)Array.addRange(this.wKb,
c.ga(a).toArray());this.Tra=0;this.poj=h}}Object(n.a)(XH,"BasicInternalCopyArguments",nx,[]);class YH extends Sys.EventArgs{constructor(a){super();this.$K=a}}Object(n.a)(YH,"BeforePasteArguments",Sys.EventArgs,[]);class iz extends nx{constructor(a,b){super(a.source,a.target,a.$He);this.ph=a;this.insertAfter=b}get w6(){return this.ph.w6}get $K(){return this.ph.$K}set $K(a){this.ph.$K=a}}Object(n.a)(iz,"CoreInternalCopyArguments",nx,[]);class jz{constructor(a,b,c,h,m=null){this.source=a;this.target=
b;this.insertAfter=c;this.Ffd=h;this.$K=m||{}}}Object(n.a)(jz,"CoreInternalPasteArguments",null,[]);class ZH{constructor(a,b,c,h,m,y,G,U,ja){this.cNb=a;this.source=b;this.target=c;this.Ffd=h;this.rowIndex=m;this.Oia=y;this.j9g=U;this.If=ja}}Object(n.a)(ZH,"CoreInternalTablePasteArguments",null,[]);class kz extends Sys.EventArgs{constructor(a,b,c,h,m){super();this.operation=a;this.clone=h;this.$K=m}}Object(n.a)(kz,"ParagraphCopyPasteArguments",Sys.EventArgs,[]);var Yq=d(203);class pi{static mr(){pi.cKb=
new Sc.a;pi.cKb.$(88,!0);pi.cKb.$(4,!0)}static Vsa(a,b,c){const h=[];if(J.a.instance.ga(104)&&a.Gl&&yd.SelectionFactory.VTj(a))a=rb.GraphIterator.nb(a.mb.kg.Ua.node),a.rc(14),c=md.a.create(a.origin),c=pi.WGc(c,!0,!0,null),a.set(c),Bb.SelectionEditor.xt(a),pi.cSa(a,h);else for(let va=0;va<a.length&&!(c&&0<h.length);++va){var m=a.ga(va),y=pi.JRc(m,!0),G=pi.JRc(m,!1);if(!y||!G)continue;if(y===G&&y.contextId===xb.a.Of){m=rb.GraphIterator.nb(y.node);m.rc(11)&&pi.cSa(m,h);continue}var U=void 0;U=m=null;
var ja=-1;let Ta;if(y.node===G.node)Ta=y.node,G=G.node;else{U=pi.fXf(y.node);m=pi.fXf(G.node);for(ja=0;ja<U.length&&ja<m.length&&U[ja]===m[ja];++ja);U=U[ja-1];--ja;Ta=pi.WGc(y,!0,!1,U);G=pi.WGc(G,!1,!0,U)}if(Ta===G)m=Ta===y.node?y:md.a.create(Ta),m=pi.WGc(m,!0,!0,null),y=new fn.a,y.set(m),Bb.SelectionEditor.xt(y),pi.cSa(y,h);else{y=new fn.a;y.set(Ta);Bb.SelectionEditor.xt(y);Ta===U&&y.Gi();for(pi.cSa(y,h);y.parentNode!==U;){for(;y.kp();)pi.cSa(y,h);y.zc()}if(G===U)for(;y.kp();)pi.cSa(y,h);else{y.kp();
for(U=ja+1;U<m.length;++U){for(;y.currentNode!==m[U];)pi.cSa(y,h),y.kp();if(G===m[U])break;y.Gi()}pi.cSa(y,h)}}}if(0>=h.length)return null;if(b)for(b=new rb.GraphIterator,a=0;a<h.length;++a)b.set(h[a].node),mc.OutlineElementNavigator.wi(b),h[a]=md.a.create(b.currentNode);return ib.a.EQa(h)}static JRc(a,b){if(b)for(b=0;b<a.length;++b){if(a.ga(b).el)return a.ga(b);if(a.ga(b).$w){var c=a.ga(b);for(var h=0;h<c.length;++h)if(c.getContext(h).el)return c.getContext(h)}}else for(b=a.length-1;0<=b;--b){if(a.ga(b).el)return a.ga(b);
if(a.ga(b).$w)for(c=a.ga(b),h=c.length-1;0<=h;--h)if(c.getContext(h).el)return c.getContext(h)}return null}static cSa(a,b){pi.Gig(a)?pi.hWi(a,b):pi.cKb.Hb(a.role)||(a=a.Mw(11),!a||b.length&&b[b.length-1].node===a||Array.add(b,md.a.create(a)))}static fXf(a){const b=[],c=new rb.GraphIterator;c.set(a);Bb.SelectionEditor.xt(c);for(Array.add(b,a);c.zc();)Array.add(b,c.currentNode);b.reverse();return b}static WGc(a,b,c,h){let m=a.node;if(Bb.SelectionEditor.ek(a)&&(b&&0<a.Qa||c&&a.Nb<Ob.ParagraphReader.textLength(m))||
Bb.SelectionEditor.Wl(a)&&b&&0<Ob.ParagraphReader.textLength(m))return m;a=new fn.a;a.set(m);for(Bb.SelectionEditor.xt(a);!a.$q;){m=a.currentNode;if(h===m||b&&!pi.xLj(a)||c&&!pi.GNj(a))return m;a.zc()}return a.currentNode}static GNj(a){let b=!0;if(a.kp())for(b=!1;pi.cKb.Hb(a.role)||J.a.instance.ga(77)&&16===a.ri&&Qe.isGhostCell(a);)if(!a.kp()){b=!0;break}return b}static xLj(a){const b=a.currentNode;let c=!0;if(a.oEa())for(c=!1;pi.cKb.Hb(a.role);)if(!a.oEa()){c=!0;break}a.zc();a.Qk(b);return c}static hWi(a,
b){a=P.a.jv(a);for(a.$l(pi.XVi,null);a.moveNext();)Kd.OutlineElementReader.Z8(a.currentNode)&&Array.add(b,md.a.create(a.currentNode))}static XVi(a){return pi.Gig(a)}static Gig(a){return a.$q||1===a.role||27===a.role}}pi.cKb=null;Object(n.a)(pi,"OutlineElementGeneralizer",null,[]);pi.mr();class $H{constructor(){this.controlCell=this.gp=null;this.colSpan=this.rowSpan=0;this.response=2}}Object(n.a)($H,"ComplexCellData",null,[]);var ox=d(176);class jC{constructor(a){this.Sm=a;a.r_j()}dispose(){this.Sm.fwl()}static nb(a){return new jC(a.Tj)}}
Object(n.a)(jC,"TempGraphAlgorithmLock",null,[106]);class Fh{constructor(a,b,c){this.l9e=this.eI=null;this.jBc=[];this.Lwc=[];this.yDc=[];this.lQb={};this.XFd={};this.bwd={};this.AD=null;this.W4a=Fh.plj(a);this.W4a.Nfk();this.X0h=jC.nb(this.W4a);Fh.Wmb=this;this.i7=1;this.tyd=b;this.p2a=c}get Oq(){return this.AD||(this.AD=vb.a.instance.resolve("Box4.ITableEditor"))}get BJ(){return this.eI||(this.eI=vb.a.instance.resolve("Box4.Pages.IPageContentEditor"))}normalize(){if(!(0<--this.i7)){var a=new t.GraphTransaction(7);
a.kd(this.W4a);this.zGk();this.Kgk();this.NXi();J.a.instance.ga(63)&&this.Iri();this.PXi();a.dispose();this.M2()}}R9k(a){this.l9e=a}PXi(){var a=rb.GraphIterator.nb(this.W4a);if(!a.rEa()){const b=this.BJ.D0b(a);Fh.wB.JZ(a,!0);a=Fc.App.Kb.Jd.Cn;a.np&&Fh.wB.Jnd(b,a.h6b())}}cancel(){if(!(0<--this.i7)){var a=ox.a.Mz(this.W4a);for(a.$l(Fh.Q6e,null);a.moveNext();)a.iterator.$q||a.iterator.bZ(16,!1);this.M2()}}M2(){this.W4a.gwl();this.X0h.dispose();Fh.Wmb=null}Qoa(a){a.el?(Fh.RUj(a)&&Array.add(this.jBc,a.node),
this.VBh(a.node)):a.$w&&this.Arl(a)}Arl(a){for(let b=0;b<a.length;++b)this.Qoa(a.getContext(b))}VBh(a){a.anchor.nT(16)}Kgk(){for(let b=0;b<this.jBc.length;++b){var a=this.jBc[b];if(!a.anchor||a.anchor.QI)continue;const c=new rb.GraphIterator;c.set(a);if(!Bb.SelectionEditor.xt(c))continue;mc.OutlineElementNavigator.Oe(c);if(this.p2a.Wni(c)){Fh.Ph.PCa(c);continue}a=new fn.a;a.Rc(c);if(!mc.OutlineElementNavigator.yJ(a,!1,!1))continue;if(36===a.role)continue;mc.OutlineElementNavigator.wi(a);if(a.currentNode.QW)continue;
if(rd.TableReader.aq(a))continue;mc.OutlineElementNavigator.Oe(a);const h=new rb.GraphIterator;h.Rc(a);h.zc();Fh.Ph.merge(c,a,!1,!1);Kd.OutlineElementReader.OI(h)&&!h.rEa()&&a.Mi()}Array.clear(this.jBc)}Iri(){for(let a=0;a<this.yDc.length;++a){const b=this.yDc[a];if(!b.anchor||b.anchor.QI)continue;if(Qe.isGhostCellNode(b))continue;const c=new rb.GraphIterator;c.set(b);c.TA(1);c.Bb(2);rd.TableReader.aq(c)&&(c.zc(),Fh.Ph.pda(c,!1,!0,null))}Array.clear(this.yDc)}o4i(a){const b=a.id.toString();if(this.lQb[b])return this.lQb[b];
const c=Array(rd.TableReader.Ai(a));for(let h=0;h<rd.TableReader.Ai(a);++h)c[h]=0;this.lQb[b]=c;this.XFd[b]=rd.TableReader.rk(a);return c}zGk(){const a=ox.a.Mz(this.W4a);a.$l(Fh.Q6e,null);var b=a.moveNext();const c=new rb.GraphIterator;let h=0;for(;b;)if(a.iterator.$q)this.vri(a.iterator),b=a.moveNext();else if(this.p2a.QPj(a.iterator)&&Array.add(this.Lwc,a.iterator.currentNode),J.a.instance.ga(63)&&Qe.isTableCell(a.iterator)&&Array.add(this.yDc,a.iterator.currentNode),Fh.doi(a.iterator))switch(a.iterator.ri){case 16:b=
Gd.getContainingTable(a.iterator);if(this.tyd&&!rd.TableReader.Cu(b)&&!Qe.isGhostCell(a.iterator)){b=this.o4i(b);var m=xn.a(a.iterator);++b[m]}b=a.moveNext();break;case 15:b=Gd.getContainingTable(a.iterator);this.tyd&&!rd.TableReader.Cu(b)?(this.bwd[b.id.toString()]=!0,c.Rc(a.iterator),b=a.moveNext(),this.Oq.WLc(c)):b=a.moveNext();break;case 14:a.iterator.currentNode!==this.l9e?(a.moveNext(),c.Rc(a.iterator),b=a.moveNext(),Fh.Ph.PCa(c)):(a.iterator.bZ(16,!1),b=a.moveNext());break;case 23:c.Rc(a.iterator);
b=a.moveNext();c.Mi();break;case 11:h++;Je.b(a.iterator)?(a.iterator.bZ(16,!1),b=a.moveNext()):(c.Rc(a.iterator),Wb.ListReader.tk(c)&&!this.p2a.KVe(c,h)&&Fh.eq.Qna(c),c.FI(2)?this.p2a.Jcl(c,h)?b=a.moveNext():(c.Rc(a.iterator),b=a.moveNext(),Fh.Ph.PCa(c)):(b=a.moveNext(),Fh.Ph.PCa(c)));break;case 12:b=a.moveNext();break;default:b=a.moveNext()}else{m=!0;if(rd.TableReader.aq(a.iterator)&&this.tyd){var y=a.currentNode;let G=y.id.toString();const U=this.lQb[G];let ja=!1;if(U){const va=this.XFd[G];for(y=
rd.TableReader.Ai(y)-1;0<=y;--y)U[y]===va&&(this.Oq.ULc(a.iterator,y),ja=!0)}rd.TableReader.Ai(a.iterator.currentNode)?J.a.instance.ga(30)&&(ja||this.bwd[G])&&rd.TableReader.tke(a.iterator.currentNode)&&(c.Rc(a.iterator),Gd.moveToFirstRow(c),Gd.moveToFirstColumn(c),b=a.moveNext(),Fh.Ph.cjh(a.iterator,c)):(a.moveNext(),c.Rc(a.iterator),b=a.moveNext(),c.Mi(),m=!1)}m&&(a.iterator.bZ(16,!1),b=a.moveNext())}this.lQb={};this.XFd={};this.bwd={}}vri(a){if(a.Gi()){do a.bZ(16,!1);while(a.nEa())}}NXi(){for(let b=
0;b<this.Lwc.length;++b){var a=this.Lwc[b];if(a.anchor&&!a.anchor.QI){const c=new rb.GraphIterator;c.set(a);ii.OutlineNavigator.F$(c)||(c.currentNode.setValue(kb.a.BE,Nm.a.first),J.a.instance.ga(41)&&10===c.ri&&(a=Fh.Ph.nde(c,null,1),c.Qk(a)),Fh.wB.JZ(c,!0))}}Array.clear(this.Lwc)}static get eq(){return Fh.Xo||(Fh.Xo=vb.a.instance.resolve("Box4.List.IListEditor"))}static get wB(){return Fh.Nx||(Fh.Nx=vb.a.instance.resolve("Box4.IOutlineEditor"))}static get Ph(){return Fh.Di||(Fh.Di=vb.a.instance.resolve("Box4.IOutlineElementEditor"))}static get LH(){return pm.a.instance}static get aj(){return Dc.a.instance}static ASc(a,
b){Fh.Wmb?Fh.Wmb.i7++:Fh.Wmb=new Fh(a,b,vb.a.instance.resolve("Box4.Actors.IDeleteOutlineElementNodeStrategy"));return Fh.Wmb}static plj(a){a=rb.GraphIterator.nb(a);Bb.SelectionEditor.xt(a);a.ZJb(b=>b.u$b);return a.currentNode}static RUj(a){let b=!1;Bb.SelectionEditor.Wl(a)&&(b=!J.a.instance.ga(14)||!Fh.aj.mYc(a));!b&&Ob.ParagraphReader.tm(a)&&(b=!J.a.instance.ga(14)||!Fh.aj.pZc(a)&&!a.node.sa(jb.a.Mab,!1));return b}static doi(a){switch(a.ri){case 12:return a.currentNode.hIc}if(!a.Gi())return Fh.LH.ilg(a)?
Fh.LH.CSd(a.currentNode):!0;let b=!0;do{switch(a.role){case 2:case 1:case 3:case 86:case 87:a.PW&16||16===a.ri&&Qe.isGhostCell(a)||(b=!1)}a.bZ(16,!0)}while(a.nEa());b&&Fh.LH.ilg(a)&&(b=Fh.LH.CSd(a.currentNode));return b}static Vni(a){return a.$q||!!(a.PW&16)}}Fh.Q6e=Fh.Vni;Fh.Wmb=null;Fh.Oa=new bd.a;Fh.Nx=null;Fh.Xo=null;Fh.Di=null;Object(n.a)(Fh,"GraphStructureNormalizer",null,[]);class Yt{constructor(){this.mMb=this.gp=this.ZC=null;this.dgb=0;this.response=2}}Object(n.a)(Yt,"TableGeneralizeData",
null,[]);class $h{static get jm(){return tg.ContextSetEditor.instance}static w5(a,b,c,h,m,y,G){let U=!1;y&&y[$h.UOb]&&y[$h.UOb]&&(U=!0);if(!b.view.Mh)return 2;const ja=b.view;var va=ja.Lb;if(1===c){if(!va||!va.Pa.mb)return 8;b=0===G?b.xE:$h.jm.a4b(b.xE,G,!0);return u.AFrameworkApplication.Ta.mi(b,a,c,!0,h,m)}y&&y[$h.epa]&&Te.a.mark(y[$h.epa]);const Ta=Ym.SelectionReferenceFactory.instance.Yra(),fb=va.Pa.mb.Ua;va=new t.GraphTransaction(15);va.kd(fb.node);va.gya();b=0===G?b.xE:$h.jm.a4b(b.xE,G);a=u.AFrameworkApplication.Ta.mi(b,
a,c,!0,h,m);32===a&&Ta.LU(U);C.FocusManager.instance().xf(ja.vI);va.dispose();Fc.App.Kb.updateCommandUI();y&&y[$h.dpa]&&Te.a.mark(y[$h.dpa]);return a}static Rgb(a,b,c,h,m,y){var G=me.a.instance;let U,ja=!1;y&&y[$h.UOb]&&y[$h.UOb]&&(ja=!0);if(1===c)return G&&G.Pa.mb?(U=pi.Vsa(G.Pa,!1,!0))?u.AFrameworkApplication.Ta.mi(U,a,c,!0,h,m):8:8;y&&y[$h.epa]&&Te.a.mark(y[$h.epa]);const va=Ym.SelectionReferenceFactory.instance.Yra(),Ta=G.Pa.mb.Ua;U=pi.Vsa(G.Pa,!1);if(!U)return 8;G=new t.GraphTransaction(15);
G.kd(Ta.node);G.gya();a=u.AFrameworkApplication.Ta.mi(U,a,c,!0,h,m);32===a&&va.LU(ja);(b=b.view)&&C.FocusManager.instance().xf(b.vI);G.dispose();Fc.App.Kb.updateCommandUI();y&&y[$h.dpa]&&Te.a.mark(y[$h.dpa]);return a}}$h.epa="PerfMarkStart";$h.dpa="PerfMarkEnd";$h.UOb="CollapseIp";Object(n.a)($h,"ViewActionHandler",null,[]);var aI=d(553);class bI{constructor(){this.controlCell=null;this.sEf=this.Clh=0;this.uUf=this.vUf=null}}Object(n.a)(bI,"MergedCellInfo",null,[]);var px=d(315),cI=d(667),FP=d(716),
yn=d(361);class vv extends Ng.a{constructor(a){super(0,0,0);this.N7=a;this.JMa=Array(a)}r4i(a){return this.JMa[a]}$oh(a,b){this.JMa[a]=b}copy(){const a=new vv(this.N7);for(let b=0;b<this.N7;++b)a.JMa[b]=this.JMa[b];return a}Sgk(){let a=yn.a.Ckb;for(let b=0;b<this.N7;++b)a+=this.JMa[b]+1;return a}static nui(a,b){const c=new vv(a.N7);for(let h=0;h<c.N7;h++)c.JMa[h]=Math.max(a.JMa[h],b.JMa[h]);return c}}Object(n.a)(vv,"TableRowViewSizeConstraints",Ng.a,[]);class Zt extends wf.a{constructor(a,b,c,h,m,
y=null){super(a,b,c);this.N1a=null;this.Txd=0;this.Gvc=-1;this.hd=h;this.fd=m;this.nc(this.Md.hp(wa.a.tr));this.htmlElement.className="TableRow";Wa.d(this.htmlElement,oa.a.role,"row");this.Rih();this.x9e=y}Dy(){this.gb.A8g=[];this.htmlElement.style.height=this.Alh;this.Rih()}Rih(){this.hd&&this.hd.WEa(65)&&(this.gb.$_b?Sys.UI.DomElement.addCssClass(this.htmlElement,Qb.G3):Sys.UI.DomElement.removeCssClass(this.htmlElement,Qb.G3))}X4k(a){const b=this.Gvc!==a;this.Gvc=a;return b}cAl(){this.htmlElement.style.height=
this.Blh+"px"}get Blh(){let a=0>=this.Gvc?Zt.MYg:this.Gvc;this.gb.Sa(jb.a.mu)&&(a=Math.max(a,this.Md.Ld.Me(this.gb.eb(jb.a.mu),1)));return a}get Alh(){return this.gb.Sa(jb.a.mu)?this.Md.Ld.Me(this.gb.eb(jb.a.mu),1)+"px":"auto"}IU(a){super.IU(a);var b=rd.TableReader.Ai(Gd.getContainingTable(a));let c=0;b=new vv(b);if(a.Bb(1)){do b.$oh(c,a.Tq.WKa.total),c++;while(a.Cj(1))}return b}$J(a){super.$J(a);this.BR.vU(this.htmlElement)}get author(){return this.N1a}r2e(a){let b=!0;if(this.Qc.np&&this.Qc.QHj){a=
P.a.jv(a);for(var c={};a.moveNext();){if(!Kd.OutlineElementReader.Wg(a.iterator)||Kd.OutlineElementReader.Mae(a.iterator))continue;const h=Kd.OutlineElementReader.wQc(a.currentNode,kb.a.MYb);h&&(c[h]="")}a=Da.a.join(c,Box4Intl.Box4Strings.l_UserInitialsDelimeter,"");c=Sys.UI.DomElement.getBounds(this.htmlElement);0<c.height&&(this.N1a=a,this.Txd=c.height,b=!1)}b&&(this.N1a="",this.Txd=-1)}get tVd(){return this.Txd}vVk(){this.x9e&&this.x9e.iJl(this)}}Zt.MYg=20;Object(n.a)(Zt,"TableRowViewElement",
wf.a,[479]);class Gh{constructor(a,b){Gh.Nx=a;Gh.Di=b}UXk(a){const b=a.Zqd.currentNode;this.yyl(b);let c=this.uAi(b);var h=this.nkj(b,c);let m=h.length;a.aMc=this.UWi(h);a.ZLc=this.kWi(h);h=a.aMc.toArray().length;const y=a.ZLc.toArray().length;if(0<h||0<y)m-=h,c-=y,this.MAl(a);this.jLb(Object(ua.a)($f.a,b),m);this.UKb(Object(ua.a)($f.a,b),c);this.zXk(a)}kWi(a){const b=new Qa.a;for(let c=0;c<a[0].length;c++){let h=!0;for(let m=0;m<a.length;m++)if(1===a[m][c]){h=!1;break}h&&b.add(c)}return b}UWi(a){const b=
new Qa.a;for(let c=0;c<a.length;c++){let h=!0;for(let m=0;m<a[c].length;m++)if(1===a[c][m]){h=!1;break}h&&b.add(c)}return b}uAi(a){let b=0;a=rb.GraphIterator.nb(a);Gd.moveToFirstRow(Object(ua.a)(rb.GraphIterator,a));Gd.moveToFirstColumn(Object(ua.a)(rb.GraphIterator,a));let c=Object(ua.a)(124,a.xq),h=!1;for(;c;)!c.isGhostCell||Qe.isSkippedCell(Object(ua.a)($f.a,c))?(b+=c.g$a?c.colSpan:1,h=!0):h||b++,c=Object(ua.a)(124,Gd.moveToNextColumn(Object(ua.a)(rb.GraphIterator,a)));return b}MAl(a){const b=
rb.GraphIterator.nb(a.Zqd.xq);let c=0;Gd.moveToFirstRow(Object(ua.a)(rb.GraphIterator,b));var h=b.xq;const m=$d.a.rf(Zt.MYg,1);for(;h;){for(;a.aMc.contains(c);)c++;var y=1,G=a.Yqc?a.Yqc.rowIndex:0,U=a.Qwh[G+c];for(U<m&&(U=m);a.aMc.contains(c+y);){var ja=a.Qwh[G+c+y];ja<m&&(ja=m);U+=ja;y++}h.setValue(jb.a.mu,U);h=y-1;y=0;Gd.moveToFirstColumn(Object(ua.a)(rb.GraphIterator,b));for(G=Object(ua.a)(124,b.xq);G;){U=G.g$a?G.colSpan:1;if(!G.isGhostCell||1<U){0<h&&(G.rowSpan-=h,1>G.rowSpan&&(G.rowSpan=1));
ja=0;for(let va=1;va<U;va++)a.ZLc.contains(y+va)&&ja++;0<ja&&(G.colSpan-=ja,1>G.colSpan&&(G.colSpan=1))}y+=U;G=Object(ua.a)(124,Gd.moveToNextColumn(Object(ua.a)(rb.GraphIterator,b)))}c++;Gd.moveToFirstColumn(Object(ua.a)(rb.GraphIterator,b));b.zc();h=Gd.moveToNextRow(Object(ua.a)(rb.GraphIterator,b))}}yyl(a){const b=new Qa.a;a=rb.GraphIterator.nb(a);Gd.moveToFirstRow(Object(ua.a)(rb.GraphIterator,a));for(var c=a.xq;c;){c=!1;let m=0;Gd.moveToFirstColumn(Object(ua.a)(rb.GraphIterator,a));for(var h=
Object(ua.a)(px.TableCellNode,a.currentNode);h;){if(h.isGhostCell)h.g$a?(c=!0,b.contains(m)||(h.isGhostCell=!1,h.ITd())):Qe.isSkippedCell(Object(ua.a)($f.a,h))||b.contains(m)&&(c||J.a.instance.ga(77))||(h.isGhostCell=!1,h.ITd());else{c=!0;h=h.g$a?h.colSpan:1;for(let y=0;y<h;y++)b.contains(m+y)||b.add(m+y)}m++;h=Object(ua.a)(px.TableCellNode,Gd.moveToNextColumn(Object(ua.a)(rb.GraphIterator,a)))}Gd.moveToFirstColumn(Object(ua.a)(rb.GraphIterator,a));a.zc();c=Gd.moveToNextRow(Object(ua.a)(rb.GraphIterator,
a))}}nkj(a,b){const c=[];let h=0;a=rb.GraphIterator.nb(a);Gd.moveToFirstRow(Object(ua.a)(rb.GraphIterator,a));for(var m=a.xq;m;){m=0;Gd.moveToFirstColumn(Object(ua.a)(rb.GraphIterator,a));for(var y=Object(ua.a)(124,a.xq);y;){if(!y.isGhostCell||Qe.isSkippedCell(Object(ua.a)($f.a,y))){const G=y.g$a?y.colSpan:1;for(y=y.Hae?y.rowSpan:1;h<c.length&&2===c[h][m];)m++,(m%=b)||h++;for(let U=0;U<y;U++){const ja=h+U;ja===c.length&&Array.add(c,Array(b));for(let va=0;va<G;va++)c[ja][m+va]=0<U||0<va?2:1}m+=G}y=
Object(ua.a)(124,Gd.moveToNextColumn(Object(ua.a)(rb.GraphIterator,a)))}Gd.moveToFirstColumn(Object(ua.a)(rb.GraphIterator,a));a.zc();m=Gd.moveToNextRow(Object(ua.a)(rb.GraphIterator,a));h++}return c}zXk(a){if(rd.TableReader.aq(a.Zqd)&&a.Yqc&&a.Owh){var b=Object(ua.a)(130,a.Zqd.xq),c=a.Owh,h=Array(b.N7),m=a.Yqc.Oia;for(let y=0;y<h.length;y++)for(h[y]=c[m],m++;a.ZLc.contains(m-a.Yqc.Oia);)h[y]+=c[m],m++;b.oQa=h}}pza(a){if(J.a.instance.ga(77)||J.a.instance.ga(63))Gd.forEachCellInTable(a,b=>{b.currentNode.zIa=
null;return!0}),Gd.forEachCellInTable(a,b=>{const c=b.currentNode;if(!c.isGhostCell){const h=c.rowSpan,m=c.colSpan;1<h||1<m?this.HDi(b,h,m):c.pQe()}return!0})}HDi(a,b,c){const h=a.currentNode,m=new rb.GraphIterator;m.Rc(a);Gd.forEachCell(m,b,c,(y,G,U)=>{const ja=y.currentNode;if(ja!==h){ja.isGhostCell=!0;let Ta=!1;var va=!0;const fb=Gh.xe;fb&&(Ta=fb.isFeatureEnabled(136),fb.wbb(136));do{y.Bb(1);if(Object(za.a)(aI.a,y.currentNode)){if((va=va&&Kd.OutlineElementReader.isEmpty(y,!1))||!Ta)va=rb.GraphIterator.nb(y.xq),
va.rc(16),va=!va.Af(1);va||a.Cl(y.currentNode,1);y.Mi()}va=!1}while(Ta&&y.FI(1))}ja.zIa=Object.assign(new bI,{controlCell:h,Clh:G,sEf:U});1!==G||U||(h.zIa.uUf=ja);G||1!==U||(h.zIa.vUf=ja);ja.pQe();U||(ja.colSpan=c)});h.rowSpan=b;h.colSpan=c}gde(a){const b=new rb.GraphIterator;b.Rc(a);Gd.returnToContainingRow(b);var c=b.currentNode;b.Bb(1);const h=new rb.GraphIterator;h.Rc(a);Gd.returnToContainingTable(h);a=h.currentNode;this.pza(h);const m=zs.a.instance.createInstance(393251);this.h8b(h,m,c,c,!1);
h.Qk(m);c=rd.TableReader.Ai(a);for(let y=0;y<c;++y){const G=b.currentNode,U=this.asa();this.BXb(h,U,G,!1,!0);if(!U.isGhostCell)if(G.isGhostCell){let ja;(ja=G.zIa.controlCell).rowSpan=ja.rowSpan+1}else G.rowSpan=2;b.Af(1)}this.jLb(a,rd.TableReader.rk(a)+1);Gd.returnToContainingTable(h);this.pza(h);return m}fde(a){const b=rb.GraphIterator.nb(a.GHh());let c=rd.TableReader.Ai(b.currentNode);a=xn.a(a);const h=a+1;this.pza(b);b.Bb(1);do{const y=b.Zp(a,1);b.zc();const G=this.asa();this.X7b(b,G,y,!1,!1);
if(!G.isGhostCell)if(y.isGhostCell){var m=void 0;(m=y.zIa.controlCell).colSpan=m.colSpan+1}else y.colSpan=2}while(b.Cj(1));this.pza(b);(m=b.currentNode.sa(kb.a.Tu,null))&&(m=Ma.a.clone(m));this.UKb(b.currentNode,++c);m&&(Array.insert(m,h,m[a]),b.currentNode.setValue(kb.a.Tu,m));this.ojc(b.currentNode,h,!1,1,null)}Xjd(a,b){rd.TableReader.Cu(a.currentNode)&&J.a.instance.ga(63)&&this.Igh(a,c=>this.w9i(c,b),(c,h)=>{c.te(jb.a.mu,h)},jb.a.complexTable)}trj(a,b,c,h){let m=b;const y=b.zIa;J.a.instance.ga(77)&&
(a.isGhostCell=!1);if(y)if(Gh.CSc(y,!h))a.isGhostCell=!0;else{const G=Gh.Jvb(y.controlCell,h);!b.isGhostCell&&c||!c&&Gh.CSc(y,h)===G-1?(m=y.controlCell,!h&&m.Hae&&(a.rowSpan=m.rowSpan)):(a.isGhostCell=!0,Gh.fjb(y.controlCell,h,G+1));h&&m.g$a&&(a.colSpan=m.colSpan)}return m}eqj(a,b,c){var h=a.zIa;if(h)if(a.isGhostCell)this.$qj(h,b);else if(h=Gh.Jvb(a,b),1<h){const m=Gh.Jvb(a,!b),y=new rb.GraphIterator;y.set(a);y.rc(14);a=new rb.GraphIterator;a.Rc(y);const G=b?Gd.moveToNextRow(a):a.Af(1);Gh.fjb(G,b,
h-1);Gh.fjb(G,!b,m);c(a,y)}}$qj(a,b){Gh.CSc(a,!b)||Gh.fjb(a.controlCell,b,Gh.Jvb(a.controlCell,b)-1)}vOb(a,b){let c=!1;Gd.forEachCellInTable(a,h=>Qe.isGhostCell(h)?(c=!0,!1):!0);a.currentNode.te(b,c)}Igh(a,b,c,h){var m=rd.TableReader.rk(a.currentNode);const y=rd.TableReader.Ai(a.currentNode);if(m&&y){var G=!1,U=!1,ja=Array(m);Gd.forEachCellInTable(a,(gc,hc,Gc)=>{Gc||(ja[hc]=Array(y));gc=gc.currentNode;gc.isGhostCell?Qe.isSkippedCell(gc)?ja[hc][Gc]=2:ja[hc][Gc]=1:ja[hc][Gc]=0;return!0});var va=Array(m),
Ta=Array(m);for(var fb=0;fb<m;fb++){var Db=!!fb;let gc=!0;for(let hc=0;hc<y;hc++)if(ja[fb][hc])1===ja[fb][hc]?gc=!1:fb&&2===ja[fb-1][hc]||(Db=!1);else{gc=Db=!1;break}va[fb]=Db;Ta[fb]=gc}for(--m;0<=m;m--)Ta[m]?(a.Zp(m,1),this.WLc(a),Array.removeAt(ja,m),G=!0):va[m]&&b&&(a.Zp(m,1),G=a.j5b(1),fb=b(a.currentNode),Db=b(G),c(G,fb+Db),this.WLc(a),Array.removeAt(ja,m),G=!0);m=ja.length;if(0<m){va=Array(y);Ta=Array(y);for(b=0;b<y;b++){c=!!b;fb=!0;for(Db=0;Db<m;Db++)if(ja[Db][b])1===ja[Db][b]?fb=!1:b&&2===
ja[Db][b-1]||(c=!1);else{fb=c=!1;break}va[b]=c;Ta[b]=fb}b=a.currentNode.sa(kb.a.Tu,null);c=!1;if(b)for(c=!0,b=Array.clone(b),m=0;m<b.length;m++)if(!b[m]){c=!1;break}for(m=y-1;0<=m;m--)Ta[m]?(b&&Array.removeAt(b,m),this.ULc(a,m),U=!0):va[m]&&c&&(b[m-1]+=b[m],Array.removeAt(b,m),this.ULc(a,m),U=!0);U&&b&&a.currentNode.setValue(kb.a.Tu,b)}(G||U)&&this.vOb(a,h)}}w9i(a,b){let c=gk.b(a);c||(a=a.sc(b))&&(c=te.a.AH(a.htmlElement.offsetHeight));return c}jLb(a,b){rd.TableReader.rk(a)!==b&&a.properties.setValue(kb.a.Tya,
b)}UKb(a,b){const c=rd.TableReader.Ai(a);c!==b&&(b&&c&&a.properties.ao(kb.a.Tu,kb.a.C0a),a.properties.setValue(kb.a.kga,b))}U2(a,b,c,h=null,m=!1,y=!1){a=this.gJf(a);J.a.instance.ga(71);this.hUf(a,b,c,h,m,y);J.a.instance.ga(71);return a}gJf(a){J.a.instance.ga(63)&&rd.TableReader.ys(a)&&Gd.getContainingTable(a);const b=zs.a.instance.createInstance(393250);a.Cl(b,2);a.Qk(b);return b}ENk(a,b,c,h,m){a=this.gJf(a);J.a.instance.ga(71);this.hUf(a,b,c,h,!1,m);ba.ULS.sendTraceTag(50373653,324,50,String.format("Table pasted: TableId={0}, RowCount={1}, ColumnCount={2}",
a.id.toString(),b,c));return a}hUf(a,b,c,h=null,m=!1,y=!1){const G=rb.GraphIterator.nb(a);this.OIf(G,b,c,h,m);this.jLb(a,b);this.UKb(a,c);J.a.instance.ga(63);a.setValue(kb.a.Bkb,!y)}OIf(a,b,c,h=null,m=!1){for(var y=0;y<b;++y){var G=new FP.a;a.Cl(G,1);J.a.instance.ga(55)&&G.setValue(jb.a.fo,kf.a.EZa())}b=null;y=!0;a.Bb(1);do for(G=0;G<c;++G){const U=this.asa();a.Cl(U,1);({vnh:b,isFirst:y}=this.gUf(a,U,m,h,b,y));Gd.returnToContainingRow(a)}while(a.Cj(1))}gUf(a,b,c,h,m,y){a.Qk(b);m&&c?Gh.Di.dti(a,m):
(Gh.Nx.JZ(a,!0,h),!y&&c&&(m=new rb.GraphIterator,m.Rc(a)),y=!1);return{vnh:m,isFirst:y}}rde(a,b,c,h){const m=new rb.GraphIterator;m.Rc(a);var y=m.currentNode;m.Bb(1);let G=gk.c(a);if(b)var U=a.FF(1);else U=a.currentNode,G++;const ja=a.zc();J.a.instance.ga(63);this.pza(a);let va=null,Ta=null;for(var fb=0;fb<c;++fb){var Db=zs.a.instance.createInstance(393251);Ta||(Ta=Db);va=Db;this.h8b(a,Db,U,y,b)}y=rd.TableReader.Ai(a.currentNode);U=!0;do{U?(a.Qk(va),U=!1):a.Af(1);for(fb=0;fb<y;++fb){Db=this.asa();
const gc=this.BXb(a,Db,m.currentNode,b,!0);this.Buf(a,Db,h(gc));m.Af(1)}m.$ja(1)}while(a.currentNode!==Ta);this.jLb(ja,rd.TableReader.rk(ja)+c);this.dGe(ja,b,G,c)}WLc(a){const b=gk.c(a);var c=b+1;a.zc();J.a.instance.ga(63);this.pza(a);for(--c;c>=b;--c){a.Zp(c,1);let h=a.Bb(1);for(;h;)this.eFe(h,!0),h=a.Cj(1);a.Mi()}this.jLb(a.currentNode,rd.TableReader.rk(a.currentNode)-1);this.yFe(a,b,1)}Gcg(a,b,c,h,m){J.a.instance.ga(63);this.pza(a);let y=rd.TableReader.Ai(a.currentNode);-1===b&&(b=y);const G=c?
b:b-1;a.Bb(1);do{const U=a.Zp(G,1);a.zc();for(let ja=0;ja<h;++ja){const va=this.asa(),Ta=this.X7b(a,va,U,c,!1);this.Buf(a,va,m(Ta))}}while(a.Cj(1));this.qMk(a,y+h,h,b,c);this.ojc(a.currentNode,b,c,h,m)}qMk(a,b,c,h,m){let y=a.currentNode.sa(kb.a.C0a,null),G=a.currentNode.sa(kb.a.Tu,null);y&&(y=Ma.a.clone(y));G&&(G=Ma.a.clone(G));this.UKb(a.currentNode,b);if(J.a.instance.ga(30)&&y){const U=Array(b);let ja=0;for(;ja<h;++ja)U[ja]=y[ja];for(;ja<h+c;++ja)U[ja]=!1;for(;ja<b;++ja)U[ja]=y[ja-c];a.currentNode.setValue(kb.a.C0a,
U)}G&&(b=this.Ntf(a,G,b,h,m,c),a.currentNode.setValue(kb.a.Tu,b))}Ntf(a,b,c,h,m,y){a=Array(c);let G=m=0;for(;m<h;++m)a[m]=b[m],G+=a[m];for(;m<c;++m)a[m]=0>m-y?b[0]:b[m-y],G+=a[m];if(J.a.instance.ga(63)&&0<G)for(b=0/G,m=0;m<c;++m)a[m]=Math.max($d.a.rf(yn.a.Uqd,0),a[m]*b);return a}ojc(){}dGe(){}h8b(a,b,c){a.sWc(b,c,1,Gh.J2a?Gh.J2a():null)}X7b(a,b,c,h){a.Qk(c);h=h?a.j5b(1):c;a.zc();a.sWc(b,h,1,Gh.J2a?Gh.J2a():null);return c}BXb(a,b,c){a.aqf(b,1,Gh.J2a?Gh.J2a():null);return c}Buf(a,b,c){Qe.isGhostCellNode(b)||
(a.Qk(b),Gh.Nx.JZ(a,!0,c),Gd.returnToContainingRow(a))}ULc(a,b){J.a.instance.ga(63);this.pza(a);let c=rd.TableReader.Ai(a.currentNode);-1===b&&(b=c-1);a.Bb(1);do for(let h=b+1-1;h>=b;--h)a.Zp(h,1),this.eFe(a.currentNode,!1),a.Mi();while(a.Cj(1));this.pMk(a,c-1,b);this.xFe(a,b,1)}pMk(a,b,c){var h=a.currentNode.sa(kb.a.C0a,null);let m=a.currentNode.sa(kb.a.Tu,null);h&&(h=Ma.a.clone(h));m&&(m=Ma.a.clone(m));this.UKb(a.currentNode,b);if(h){var y=Array(b);let G=0;for(;G<c;++G)y[G]=h[G];for(;G<b;++G)y[G]=
h[G+1];a.currentNode.setValue(kb.a.C0a,y)}if(m){h=Array(b);for(y=0;y<c;++y)h[y]=m[y];for(;y<b;++y)h[y]=m[y+1];a.currentNode.setValue(kb.a.Tu,h)}}mergeCells(){}eFe(){}yFe(){}xFe(){}yJi(a){const b=xn.a(a);a.zc();a.zc();this.ULc(a,b)}asa(){const a=zs.a.instance.createInstance(393252);a.setValue(kb.a.BE,Nm.a.first);(new BF.OutlineIndentInfo(!0)).Wmh(a);return a}RJ(a,b){a.setValue(kb.a.Il,b);a.setValue(kb.a.XI,b)}iDf(){}E_a(a,b,c){const h=rd.TableReader.Ai(a);let m=a.sa(kb.a.C0a,null);m=m?Ma.a.clone(m):
Array(h);let y=a.sa(kb.a.Tu,null);y=y?Ma.a.clone(y):Array(h);m[b]=!0;y[b]=c;a.setValue(kb.a.Tu,y);a.setValue(kb.a.C0a,m)}static get kh(){return Gh.Kf||(Gh.Kf=vb.a.instance.resolve("Box4.IFormattingEditor"))}static get xe(){return Gh.hd||(Gh.hd=vb.a.instance.rb("Box4.IFeatureHelper"))}static s2f(a,b=!0){const c=new cI.a;if(a){let h=null;a=yd.SelectionFactory.sj(a,b);if(!a)ba.ULS.sendTraceTag(19244694,315,10,"Unexpected null selection.");else for(b=0;b<a.length;b++)if(uc.a.KFf(a.ga(b))){h=a.ga(b);break}h&&
(a=uc.a.ps(h),a.cache.Zs&&(a=a.$d(null),Gh.kh.IJ(a)),c.formatting=a.nm,c.languageId=uc.a.language(a),J.a.instance.ga(71)&&(c.style=Ya.StyleReader.XD(h.node)))}return c}static fjb(a,b,c){b?a.rowSpan=c:a.colSpan=c}static Jvb(a,b){return b?a.rowSpan:a.colSpan}static CSc(a,b){return b?a.Clh:a.sEf}static A8i(a,b){return b?a.vUf:a.uUf}static Zri(a,b,c){let h=a.sa(kb.a.Tu,null);h=h?Ma.a.clone(h):Array(c);h[b]=0;a.setValue(kb.a.Tu,h)}}Gh.Kf=null;Gh.hd=null;Gh.Nx=null;Gh.Di=null;Gh.J2a=null;Object(n.a)(Gh,
"TableEditor",null,[468]);class Zq{constructor(a){this.Emb=this.EP=0;Bb.SelectionEditor.gx(a)||(a=Bb.SelectionEditor.Ql(a,!0,!1));a=a.Ua;const b=new rb.GraphIterator;b.set(a.node);Bb.SelectionEditor.xt(b);Bb.SelectionEditor.Sg(a)&&(this.EP=a.Qa,this.Emb=a.IS);Bb.SelectionEditor.N8(a)&&b.Ng(12);this.qhf=new lx(b)}restore(){var a=new rb.GraphIterator;this.qhf.$l(Object(F.a)(this,this.j2k,"selectableFilter"),null);var b=new ez.a;const c=new ez.a;this.qhf.Lkh(a,c,b);if(Ob.ParagraphReader.hs(a.currentNode)){if(!c.value&&
b.value)return yd.SelectionFactory.sj(a.currentNode,!1);b=md.a.Kj(a.currentNode,this.EP);-1!==this.Emb&&(a=Ob.ParagraphReader.pSa(a.currentNode,this.EP),0<this.Emb&&this.Emb<=a&&(b.IS=this.Emb,b.Era=this.Emb));return yd.SelectionFactory.wu(b)}return a.currentNode.YA?Bb.SelectionEditor.Ql(yd.SelectionFactory.wl(a.currentNode),!b.value,!1):(a=Bb.SelectionEditor.xja(a,!b.value))?Ob.ParagraphReader.hs(a)?yd.SelectionFactory.Qg(a,b.value?Ob.ParagraphReader.textLength(a):0):yd.SelectionFactory.wl(a):null}j2k(a){return a.currentNode.uFa||
a.currentNode.RI}}Object(n.a)(Zq,"IpReference",null,[]);class dI{constructor(){this.tableNode=null;this.columns=this.rows=0;this.HRj=!1}}Object(n.a)(dI,"TableActionData",null,[]);var GP=d(180);class Ks{constructor(){this.V3b=!1}}Object(n.a)(Ks,"TrackChangeDeletionActionData",null,[]);class wc{static get $ba(){return wc.Zu||(wc.Zu=vb.a.instance.rb("Box4.IAutoCorrectScheduler"))}static get nM(){return wc.yG||(wc.yG=vb.a.instance.resolve("Box4.IParagraphIndentationReader"))}static get onl(){return wc.rnf||
(wc.rnf=vb.a.instance.rb("Box4.UI.TableAltTextDialogFactory"))}static get IJi(){return wc.y8e||(wc.y8e=vb.a.instance.resolve("Box4.Actors.IDeleteTableSegmentStrategy"))}static Zq(){return wc.Hm||(wc.Hm=vb.a.instance.Ja("Box4.IExternalSelectionManager"))}static get swb(){return wc.L2a||(wc.L2a=a=>Gh.s2f(a))}static set swb(a){wc.L2a=a}static get a8d(){return wc.uAd||(wc.uAd=wc.wfj)}static set a8d(a){wc.uAd=a}static get Y7d(){return wc.rAd||(wc.rAd=wc.qfj)}static set Y7d(a){wc.rAd=a}static get Z7d(){return wc.sAd||
(wc.sAd=wc.sfj)}static set Z7d(a){wc.sAd=a}static get $7d(){return wc.tAd||(wc.tAd=wc.ufj)}static set $7d(a){wc.tAd=a}static get b8d(){return wc.vAd||(wc.vAd=wc.yfj)}static set b8d(a){wc.vAd=a}static get o$d(){return wc.xAd||(wc.xAd=wc.goj)}static set o$d(a){wc.xAd=a}static get m8d(){return wc.wAd||(wc.wAd=wc.igj)}static set m8d(a){wc.wAd=a}static get qzb(){return wc.UCd||(wc.UCd=wc.NRj)}static set qzb(a){wc.UCd=a}static get xe(){return wc.hd||(wc.hd=vb.a.instance.rb("Box4.IFeatureHelper"))}static get kh(){return wc.Kf||
(wc.Kf=vb.a.instance.resolve("Box4.IFormattingEditor"))}static get Tf(){return wc.fd||(wc.fd=vb.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static get p6(){return wc.$o||(wc.$o=vb.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}static get eTd(){return wc.HMa||(wc.HMa=vb.a.instance.resolve("Box4.CatchUpActivity.IChangeIdEditor"))}static get LH(){return pm.a.instance}static get aj(){return Dc.a.instance}static get Sf(){return wc.Ug||(wc.Ug=
vb.a.instance.resolve("Box4.List.IListReader"))}static get eq(){return wc.Xo||(wc.Xo=vb.a.instance.resolve("Box4.List.IListEditor"))}static get Ph(){return wc.Di||(wc.Di=vb.a.instance.resolve("Box4.IOutlineElementEditor"))}static get jm(){return wc.Tga||(wc.Tga=tg.ContextSetEditor.instance)}static set jm(a){wc.Tga=a}static get Wc(){return ec.a.instance}static get Oq(){return wc.AD||(wc.AD=vb.a.instance.resolve("Box4.ITableEditor"))}static get yv(){null==wc.iF&&(wc.iF=u.AFrameworkApplication.fa.ka("UnblockComplexTableIsEnabled")&&
!J.a.instance.ga(30));return wc.iF}static vb(a){const b=y=>pi.Vsa(y.Pa,!1),c=(y,G,U,ja,va)=>{const Ta=Fc.App.zLa.CHf(b);va[wc.BJf]={};return Ta(y,G,U,ja,va)};wc.pCj();const h=u.AFrameworkApplication.Ta;a=a.DHf();h.ya(D.a.U2,xb.a.view,wc.wGi);h.ya(D.a.U2,xb.a.Of,wc.U2);h.he(D.a.U2,1028);h.ya(D.a.Pta,xb.a.view,wc.qde);h.ya(D.a.Pta,xb.a.tableRow,wc.insertRow);h.he(D.a.Pta,1028);h.ya(D.a.QTa,xb.a.view,wc.qde);h.ya(D.a.QTa,xb.a.tableRow,wc.insertRow);h.he(D.a.QTa,1028);h.ya(D.a.NTa,xb.a.view,wc.$7b);h.ya(D.a.NTa,
xb.a.tableCell,wc.insertColumn);h.he(D.a.NTa,4);h.ya(D.a.Z7b,xb.a.view,wc.$7b);h.he(D.a.Z7b,4);h.ya(D.a.L$a,xb.a.view,wc.$7b);h.ya(D.a.L$a,xb.a.tableCell,wc.insertColumn);h.he(D.a.L$a,4);h.ya(D.a.Y7b,xb.a.view,wc.$7b);h.he(D.a.Y7b,4);h.ya(D.a.ICa,xb.a.view,wc.pLf);h.ya(D.a.ICa,xb.a.tableCell,wc.ICa);h.he(D.a.ICa,4);h.ya(D.a.deleteRow,xb.a.view,wc.pLf);h.ya(D.a.deleteRow,xb.a.tableRow,wc.deleteRow);h.he(D.a.deleteRow,1028);h.ya(D.a.Y7,xb.a.view,wc.JJi);h.ya(D.a.Y7,xb.a.table,wc.Y7);h.he(D.a.Y7,1028);
h.ya(D.a.Q6a,xb.a.table,wc.Q6a);h.ya(D.a.Q6a,xb.a.view,a);h.he(D.a.Q6a,4);h.ya(D.a.insertTable,xb.a.view,wc.pFj);h.ya(D.a.insertTable,xb.a.Of,wc.insertTable);h.he(D.a.insertTable,1036);h.ya(D.a.mergeCells,xb.a.view,wc.Ngk);h.ya(D.a.mergeCells,xb.a.tableCell,wc.mergeCells);h.he(D.a.mergeCells,4);h.ya(D.a.splitCells,xb.a.view,wc.fkl);h.ya(D.a.splitCells,xb.a.tableCell,wc.splitCells);h.he(D.a.splitCells,4);h.ra(D.a.RHk,xb.a.view,Gr.a.W0,96);h.ra(D.a.THk,xb.a.view,Gr.a.W0,96);h.ya(D.a.Qnl,xb.a.view,Gr.a.ZG);
h.ya(D.a.dol,xb.a.view,Gr.a.ZG);h.ya(D.a.VWc,xb.a.view,wc.VWc);h.he(D.a.VWc,1124);h.ya(D.a.kNc,xb.a.view,wc.kNc);h.he(D.a.kNc,100);h.ya(D.a.uKb,xb.a.view,wc.uKb);h.ya(D.a.Roc,xb.a.view,wc.e2k);h.ya(D.a.gmd,xb.a.view,wc.gmd);h.ya(D.a.iSe,xb.a.view,wc.iSe);h.ya(D.a.Jsc,xb.a.view,a);h.ya(D.a.Jsc,xb.a.table,wc.Jsc);h.he(D.a.Jsc,4);h.ya(D.a.bmc,xb.a.view,a);h.ya(D.a.bmc,xb.a.table,wc.bmc);h.he(D.a.bmc,96);J.a.instance.ga(30)&&(h.ya(D.a.j0a,xb.a.view,wc.$7b),h.ya(D.a.j0a,xb.a.Of,wc.insertColumn),h.he(D.a.j0a,
4),h.ya(D.a.$qc,xb.a.Of,wc.insertRow),h.ya(D.a.$qc,xb.a.view,wc.qde),h.he(D.a.$qc,4));h.ya(D.a.UIb,xb.a.view,wc.UIb);J.a.instance.ga(63)?h.he(D.a.UIb,96):h.he(D.a.UIb,1124);a=[D.a.Vlg,D.a.Tlg,D.a.Xlg,D.a.Ulg,D.a.Ylg,D.a.Wlg,D.a.Slg,D.a.$_c,D.a.Z_c,D.a.a0c,D.a.X_c,D.a.W_c,D.a.Y_c,D.a.T_c,D.a.S_c,D.a.U_c];for(var m of a)h.ya(m,xb.a.view,wc.Gja),h.ya(m,xb.a.tableCell,wc.bei),h.he(m,4);m=[D.a.YLe,D.a.XLe,D.a.ZLe,D.a.VLe,D.a.ULe,D.a.WLe,D.a.SLe,D.a.RLe,D.a.TLe];for(const y of m)h.ya(y,xb.a.view,c),h.ya(y,
xb.a.paragraph,wc.QGk),h.he(y,68)}static pCj(){wc.nD.$(D.a.Ylg,wc.nD.$(D.a.$_c,wc.nD.$(D.a.Z_c,wc.nD.$(D.a.a0c,wc.nD.$(D.a.YLe,wc.nD.$(D.a.XLe,wc.nD.$(D.a.ZLe,wc.HBh)))))));wc.nD.$(D.a.Wlg,wc.nD.$(D.a.X_c,wc.nD.$(D.a.W_c,wc.nD.$(D.a.Y_c,wc.nD.$(D.a.VLe,wc.nD.$(D.a.ULe,wc.nD.$(D.a.WLe,wc.uhk)))))));wc.nD.$(D.a.Slg,wc.nD.$(D.a.T_c,wc.nD.$(D.a.S_c,wc.nD.$(D.a.U_c,wc.nD.$(D.a.SLe,wc.nD.$(D.a.RLe,wc.nD.$(D.a.TLe,wc.Rhi)))))));wc.KB.$(D.a.Vlg,wc.KB.$(D.a.$_c,wc.KB.$(D.a.X_c,wc.KB.$(D.a.T_c,wc.KB.$(D.a.YLe,
wc.KB.$(D.a.VLe,wc.KB.$(D.a.SLe,1)))))));wc.KB.$(D.a.Tlg,wc.KB.$(D.a.Z_c,wc.KB.$(D.a.W_c,wc.KB.$(D.a.S_c,wc.KB.$(D.a.XLe,wc.KB.$(D.a.ULe,wc.KB.$(D.a.RLe,2)))))));wc.KB.$(D.a.Xlg,wc.KB.$(D.a.a0c,wc.KB.$(D.a.Y_c,wc.KB.$(D.a.U_c,wc.KB.$(D.a.ZLe,wc.KB.$(D.a.WLe,wc.KB.$(D.a.TLe,3)))))));wc.KB.$(D.a.Ulg,6)}static kNc(a,b,c){if(1===c)return 32;if(!b.view.Mh)return 2;a=b.view;if(!a.Lb)return wc.Wc.Wb(Ed.a.wh,{["Reason"]:Cd.a.$ma}),8;a=a.Lb.Qj;a=wc.jm.F2(a,14);if(!a)return wc.Wc.Wb(Ed.a.wh,{["Reason"]:Cd.a.Gsa}),
8;wc.onl.create(a);return 32}static uKb(a,b,c){Te.a.mark(5756);if(!b.view.Mh)return 2;const h=b.view;if(!h.Lb)return wc.Wc.Wb(Ed.a.wh,{["Reason"]:Cd.a.$ma}),8;a=h.Lb.Qj;a=wc.jm.F2(a,14);if(!a)return wc.Wc.Wb(Ed.a.wh,{["Reason"]:Cd.a.Gsa}),8;if(2===c){let m=null;b=a.node;c=rd.TableReader.Cu(b);const y=wc.yv;if(!J.a.instance.ga(104)||c&&!y)m=yd.SelectionFactory.wl(a.node);else if(J.a.instance.ga(77))c=yd.SelectionFactory.iLc(b,y),h.Lb.lLb(c,null);else{a=rb.GraphIterator.nb(b);a.Bb(1);for(b=[Yq.TableNodeContext.create(a.currentNode)];a.Af(1);)c&&
gk.h(a)||Array.add(b,Yq.TableNodeContext.create(a.currentNode));m=new Gb.Selection(b,!0)}m&&(c=new Sh.a(null,G=>{h.Lb.setSelection(m,G);return!1},null),c.Nl("SelectTable"),c.run())}Te.a.mark(5757);return 32}static e2k(a,b,c){Te.a.mark(5752);if(!b.view.Mh)return 2;a=b.view;if(!a.Lb)return wc.Wc.Wb(Ed.a.wh,{["Reason"]:Cd.a.$ma}),8;b=a.Lb.Pa;if(!b)return wc.Wc.Wb(Ed.a.wh,{["Reason"]:Cd.a.noSelection}),2;b=wc.b8d(b);if(32!==b.response)return wc.Wc.Wb(Ed.a.wh,{["Reason"]:Cd.a.Gsa}),b.response;if(2===c){var h=
b.ZC;b=c=h[0].node;var m=rb.GraphIterator.nb(c);m.rc(14);let U=null;var y=Gd.getContainingTable(m);y=rd.TableReader.Cu(y);var G=wc.yv;G=J.a.instance.ga(104)&&(!y||G);const ja=[];for(let va=0;va<h.length;++va){const Ta=m.currentNode===h[va].node;if(Ta||y&&gk.d(m))b=m.currentNode,!G||y&&gk.h(m)||Array.add(ja,Yq.TableNodeContext.create(m.currentNode)),Gd.moveToNextRow(m),Ta||--va}h=a.Lb.Pa.mb;m=null;G?J.a.instance.ga(77)?(m=new rb.GraphIterator,G=new rb.GraphIterator,h.yf?(m.set(c),G.set(b)):(m.set(b),
G.set(c)),m.rc(14),Gd.moveToFirstColumn(m),G.rc(14),Gd.moveToLastColumn(G),m=y?yd.SelectionFactory.N0b(m,G):yd.SelectionFactory.eJf(m,G)):U=new Gb.Selection(ja,J.a.instance.ga(63)||h.yf):U=yd.SelectionFactory.RIf(c,b);U&&(m=new Ha.SelectionCollection([U],0));a.Lb.lLb(m,null)}Te.a.mark(5753);return 32}static gmd(a,b,c){Te.a.mark(5754);if(!b.view.Mh)return 2;a=b.view;if(!a.Lb)return wc.Wc.Wb(Ed.a.wh,{["Reason"]:Cd.a.$ma}),8;b=a.Lb.Pa;if(!b)return wc.Wc.Wb(Ed.a.wh,{["Reason"]:Cd.a.noSelection}),2;b=
wc.$7d(b);if(32!==b.response)return wc.Wc.Wb(Ed.a.wh,{["Reason"]:Cd.a.Gsa}),b.response;if(2===c){c=[];var h=b.ZC,m=new rb.GraphIterator;m.set(h[0].node);m.rc(14);b=Gd.getContainingTable(m);var y=Number.MAX_VALUE,G=0;if(h.length===rd.TableReader.Ai(Gd.getContainingTable(m)))G=null,J.a.instance.ga(104)&&(G=yd.SelectionFactory.iLc(b,wc.yv))?c=G.toArray():(G=yd.SelectionFactory.wl(b),Array.add(c,G)),y=0,G=rd.TableReader.Ai(b)-1;else{for(m=0;m<h.length;++m){var U=rb.GraphIterator.nb(h[m].node);U.rc(14);
U=xn.a(U);y=Math.min(y,U);G=Math.max(G,U)}h=rb.GraphIterator.nb(b);Gd.moveToFirstRow(h);Gd.moveToColumnByIndex(h,y);m=new rb.GraphIterator;m.Rc(h);Gd.moveToColumnByIndex(m,G);var ja;U=b.Lp();U=J.a.instance.ga(104)&&(!U||wc.yv);do(ja=U?yd.SelectionFactory.fLc(h,m,!0,!0):yd.SelectionFactory.RIf(h.currentNode,m.currentNode))&&Array.add(c,ja),ja=!Gd.moveToNextRow(h),Gd.moveToNextRow(m);while(!ja)}h=rb.GraphIterator.nb(b);Gd.moveToCell(h,0,y);y=rd.TableReader.rk(b);b=rb.GraphIterator.nb(b);Gd.moveToCell(b,
y-1,G);c=new Ha.SelectionCollection(c,c.length-1,0,h,b);a.Lb.lLb(c,null)}Te.a.mark(5751);return 32}static iSe(a,b,c){Te.a.mark(5750);if(!b.view.Mh)return 2;a=b.view;if(!a.Lb)return wc.Wc.Wb(Ed.a.wh,{["Reason"]:Cd.a.$ma}),8;b=a.Lb.Qj;if(!b)return wc.Wc.Wb(Ed.a.wh,{["Reason"]:Cd.a.noSelection}),2;var h=wc.jm.HA(b);b={};for(var m=0;m<h.length;++m)if(h[m].el){var y=rb.GraphIterator.nb(h[m].node);y.gf();if(!Qe.isTableCellOrInside(y))return 8;Gd.returnToCell(y);b[y.currentNode.id.toString()]=y}if(2===c){if(J.a.instance.ga(104)){c=
a.Lb.Pa;if(c.mb.kg)return Te.a.mark(5751),32;h=c.mb;y=h.yf?h.Ua:h.Ye;m=h.yf?h.Ye:h.Ua;c=new rb.GraphIterator;c.set(y.node);c.gf();y=new rb.GraphIterator;y.set(m.node);y.gf();m=null;if((m=Gd.returnToLowestCommonTable(c,y))&&!m.Lp()){var G=Bb.SelectionEditor.Ql(h,!0,!1);G=Yq.TableNodeContext.create(c.currentNode,G.Ua);G=yd.SelectionFactory.J0b(yd.SelectionFactory.wu(G));a.Lb.ME(G);Te.a.mark(5751);return 32}}c=[];for(G in b)h=yd.SelectionFactory.wl(b[G].currentNode),Array.add(c,h);0<c.length&&(G=new Ha.SelectionCollection(c,
c.length-1),a.Lb.lLb(G,null))}Te.a.mark(5751);return 32}static bkj(){return u.AFrameworkApplication.fa.ka("WacTableCellAlignmentIsEnabled")}static bei(a,b,c,h,m){h=wc.dci();if(1===c)return h?32:8;if(!(m&&h&&b&&b.node))return 2;b=b.node;if(Qe.isGhostCellNode(b))return 32;wc.nD.Hb(a)&&(c=wc.nD.ga(a),b.te(jb.a.HZe,c));wc.KB.Hb(a)&&(a=wc.KB.ga(a),wc.ovf(b,a));return 32}static ovf(a,b){if(!Qe.isGhostCellNode(a)&&(a=rb.GraphIterator.nb(a),ii.OutlineNavigator.F$(a))){do if(a.Bb(2)){const c=a.currentNode;
12===c.type?c.te(kb.a.Il,b):14===c.type?rd.TableReader.IVf(c,h=>{wc.ovf(h,b)}):ba.ULS.sendTraceTag(8439839,324,50,"Unsupported node type for justification set:{0}",GP.a[c.type]);a.zc()}while(a.kp())}}static QGk(a,b,c,h,m){if(!m)return 2;if(1===c)return 32;c=m[wc.BJf];if(wc.dVd in c&&!c[wc.dVd])return 32;h=wc.KB.ga(a);a=wc.nD.ga(a);if(!b||!b.node)return 2;var y=b.node;b=Ob.ParagraphReader.BN(y);y=rb.GraphIterator.nb(y);y.rc(16);y.Ng(16);y=y.currentNode.sa(jb.a.HZe,wc.HBh);c[wc.dVd]=m[Zh.a.On]=h===
b&&a===y;return 32}static JJi(a,b,c,h,m){if(!b.view.Mh)return 2;a=b.view;if(!a.Lb)return wc.Wc.Wb(Ed.a.wh,{["Reason"]:Cd.a.$ma}),8;let y=a.Lb.Qj;y=wc.jm.F2(y,14);if(!y)return wc.Wc.Wb(Ed.a.wh,{["Reason"]:Cd.a.Gsa}),8;if(1===c)return u.AFrameworkApplication.Ta.mi(y,D.a.Y7,c,!0,h,m);Te.a.mark(7117);const G=new Zq(Bb.SelectionEditor.Ql(yd.SelectionFactory.wu(y),!0,!1)),U=new t.GraphTransaction(15);try{U.kd(b.view.yg);const ja=Fh.ASc(y.node,!0);ja.Qoa(y);const va=Object(ua.a)(Ks,m)||new Ks;let Ta=u.AFrameworkApplication.Ta.mi(y,
D.a.Y7,c,!0,h,wc.Tf.hg?va:m);const fb=!wc.Tf.hg||!wc.Tf.Ny||va.V3b;32===Ta&&2===c&&fb?(ja.normalize(),a.Lb.setSelection(G.restore()),C.FocusManager.instance().xf(a.vI)):ja.cancel()}finally{U&&U.dispose()}Te.a.mark(7118);return 32}static wGi(a,b,c,h,m){Te.a.mark(4943);let y=null;2===c&&(y=new t.GraphTransaction(15),y.kd(b.view.yg));a=u.AFrameworkApplication.Ta.mi(b.xE,a,c,!0,h,m);if(32===a&&2===c){if(!b.view.Mh)return 2;b=b.view;c=b.Lb.Qj;c=wc.jm.F2(c,16);h=new rb.GraphIterator;h.set(c.node);h.rc(14);
Gd.moveToNextOrPreviousCell(h,!1);b.Lb.setSelection(yd.SelectionFactory.sj(h.currentNode,!0))}y&&y.dispose();Te.a.mark(4944);return a}static $7b(a,b,c,h){if(!b.view.Mh)return 2;var m=b.view;if(!m.Lb||!m.Lb.Pa.mb)return wc.Wc.Wb(Ed.a.wh,{["Reason"]:Cd.a.noSelection}),8;Te.a.mark(4945);var y=m.Lb.Qj;if(!y)return wc.Wc.Wb(Ed.a.wh,{["Reason"]:Cd.a.noSelection}),8;m=a===D.a.NTa||a===D.a.j0a;var G=wc.jm.HA(y);if(!G||0>=G.length)return wc.Wc.Wb(Ed.a.wh,{["Reason"]:Cd.a.noSelection}),8;G=G[0].node;if(!G)return wc.Wc.Wb(Ed.a.wh,
{["Reason"]:Cd.a.noSelection}),8;m=rd.TableReader.um(G)?a===D.a.Y7b||m:a===D.a.Z7b||m;const U=wc.Y7d(y,m);if(32!==U.response)return U.response;y=U.gp;G=rd.TableReader.Cu(y);const ja=a;let va;va=m?Object(ua.a)(203,U.ZC[U.ZC.length-1]):Object(ua.a)(203,U.ZC[0]);a!==D.a.j0a&&(a=m?D.a.NTa:D.a.L$a);m=null;2===c&&(m=new t.GraphTransaction(15),m.kd(b.view.yg));a=u.AFrameworkApplication.Ta.mi(va,a,c,!0,h,U.dgb);m&&m.dispose();2===c&&ba.ULS.sendTraceTag(9011547,324,50,String.format("ActionId={0}, ActionName={1}, IsPptTable={2}, IsComplexTable={3}, Response={4}, TableId={5}, ColumnCount={6}",
ja,D.a.Qz(ja)||"Unknown",J.a.instance.ga(77),G,a,y.id.toString(),rd.TableReader.Ai(y)));Te.a.mark(4946);return a}static qde(a,b,c,h){if(!b.view.Mh)return 2;const m=a===D.a.$qc,y=a===D.a.QTa;Te.a.mark(4947);var G=b.view;if(!G.Lb)return wc.Wc.Wb(Ed.a.wh,{["Reason"]:Cd.a.$ma}),8;const U=G.Lb.Qj;if(!U)return wc.Wc.Wb(Ed.a.wh,{["Reason"]:Cd.a.noSelection}),8;G=wc.a8d(U,y);if(32!==G.response)return wc.Wc.Wb(Ed.a.wh,{["Reason"]:Cd.a.Gsa}),G.response;const ja=rd.TableReader.Cu(G.gp);let va=null;2===c&&(va=
new t.GraphTransaction(15),va.kd(b.view.yg));b=y?Object(ua.a)(203,G.ZC[0]):Object(ua.a)(203,G.ZC[G.ZC.length-1]);h=u.AFrameworkApplication.Ta.mi(m?U:b,a,c,!1,h,G.dgb);va&&va.dispose();2===c&&ba.ULS.sendTraceTag(9011548,324,50,String.format("ActionId={0}, ActionName={1}, IsPptTable={2}, IsComplexTable={3}, Response={4}, TableId={5}, RowCount={6}",a,D.a.Qz(a)||"Unknown",J.a.instance.ga(77),ja,h,G.gp.id.toString(),rd.TableReader.rk(G.gp)));Te.a.mark(4948);return h}static oZg(a){for(Gd.moveToFirstColumn(a);Qe.isGhostCell(a)&&
Gd.moveToPreviousRow(a););}static qik(a){for(Gd.moveToFirstRow(a);Qe.isGhostCell(a)&&Gd.moveToPreviousColumn(a););}static Ngk(a,b,c,h){if(J.a.instance.ga(30)||!b.view.Mh)return 2;const m=b.view;if(!m.Lb||!m.Lb.Pa.mb)return wc.Wc.Wb(Ed.a.wh,{["Reason"]:Cd.a.noSelection}),8;const y=wc.obj(m.Lb.Qj);if(32!==y.response)return wc.Wc.Wb(Ed.a.wh,{["Reason"]:Cd.a.Gsa}),y.response;let G=null,U=null;2===c&&(G=new Zq(m.Lb.Pa.mb),G.restore(),U=new t.GraphTransaction(15),U.kd(b.view.yg));a=u.AFrameworkApplication.Ta.mi(md.a.create(y.controlCell),
a,c,!1,h,y);2===c&&32===a&&(b=rb.GraphIterator.nb(y.gp),b.gf()&&wc.Oq.Xjd(b,m.Ma),G&&(m.Lb.setSelection(yd.SelectionFactory.sj(y.controlCell,!0)),C.FocusManager.instance().xf(m.vI)));U&&U.dispose();2===c&&ba.ULS.sendTraceTag(38397411,324,50,String.format("Merge Cells command run. Response={0}",a));return a}static obj(a){const b=new $H;b.gp=null;b.controlCell=null;if(!a)return b.response=8,b;var c=wc.jm.HA(a);if(1>=c.length)return b.response=2,b;const h=new Qa.a;a={};for(let U=0;U<c.length;++U)if(c[U].el){const ja=
rb.GraphIterator.nb(c[U].node);ja.gf();if(!Qe.isTableCellOrInside(ja))return b.response=8,b;var m=Object(ua.a)(Vb.AParagraphNode,ja.currentNode);if(m&&!m.sa(jb.a.uie,!0))return b.response=8,b;Gd.returnToCell(ja);m=ja.currentNode;if(!h.contains(m.id.toString())){h.add(m.id.toString());var y=Gd.getContainingTable(ja),G=Gd.getContainingTableRow(ja).id.toString();if(b.gp)if(b.gp!==y)if(ja.oTa(b.gp))continue;else if(rb.GraphIterator.nb(b.gp).Faa(y))a={},b.gp=y,b.controlCell=m,a[G]=m.colSpan;else return b.response=
8,b;else a[G]=G in a?a[G]+m.colSpan:m.colSpan;else a={},b.gp=y,b.controlCell=m,a[G]=m.colSpan;for(y=1;y<m.rowSpan;y++)Gd.moveToNextRow(ja),G=Gd.getContainingTableRow(ja).id.toString(),a[G]=G in a?a[G]+m.colSpan:m.colSpan}}if(!b.controlCell)return b.response=2,b;c=Object.keys(a);b.rowSpan=c.length;b.colSpan=a[c[0]];for(const U of c)if(b.colSpan!==a[U])return b.response=2,b;b.response=32;return b}static fkl(a,b,c,h,m){if(J.a.instance.ga(30)||!b.view.Mh)return 2;const y=b.view;if(!y.Lb||!y.Lb.Pa.mb)return wc.Wc.Wb(Ed.a.wh,
{["Reason"]:Cd.a.noSelection}),8;if(Bb.SelectionEditor.gx(y.Lb.Pa.mb))var G=y.Lb.Pa.mb.Ua.node;else{G=y.Lb.Qj;if(!G)return wc.Wc.Wb(Ed.a.wh,{["Reason"]:Cd.a.Gsa}),8;G=wc.jm.HA(G);if(1!==G.length||!Object(za.a)(md.a,G[0]))return wc.Wc.Wb(Ed.a.wh,{["Reason"]:Cd.a.PFf}),8;G=G[0].node}G=rb.GraphIterator.nb(G);G.gf();if(!Qe.isInTableCell(G))return 2;Gd.returnToContainingCell(G);G=G.currentNode;let U=null,ja=null;2===c&&(U=new Zq(y.Lb.Pa.mb),U.restore(),ja=new t.GraphTransaction(15),ja.kd(b.view.yg));b=
md.a.create(G);a=u.AFrameworkApplication.Ta.mi(b,a,c,!1,h,m);2===c&&32===a&&U&&(y.Lb.setSelection(yd.SelectionFactory.sj(G,!0)),C.FocusManager.instance().xf(y.vI));ja&&ja.dispose();2===c&&ba.ULS.sendTraceTag(38397440,324,50,String.format("Split Cells command run. Response={0}",a));return a}static pLf(a,b,c,h,m){if(!b.view.Mh)return 2;const y=a===D.a.deleteRow;y?Te.a.mark(4951):Te.a.mark(4949);const G=b.view;if(!G.Lb||!G.Lb.Pa.mb)return wc.Wc.Wb(Ed.a.wh,{["Reason"]:Cd.a.noSelection}),8;var U=G.Lb.Qj;
const ja=wc.m8d(U,y,G.Lb);if(32!==ja.response)return wc.Wc.Wb(Ed.a.wh,{["Reason"]:Cd.a.Gsa}),ja.response;const va=rd.TableReader.Cu(ja.gp);var Ta=null,fb=null,Db=null;let gc=!1;var hc=!1;2===c&&(Ta=new Zq(G.Lb.Pa.mb),hc=Ta.restore(),Db=rb.GraphIterator.nb(hc.Ua.node),Db.rc(14),Gd.returnToContainingCell(Db),hc=Qe.isLastCellInRow(Db),Gd.returnToContainingRow(Db),gc=gk.j(Db),fb=Fh.ASc(b.view.yg,!0),va&&(U=wc.IJi.cRf(U)),fb.Qoa(U),Db=new t.GraphTransaction(15),Db.kd(b.view.yg));b=Object(ua.a)(Ks,m)||
new Ks;h=u.AFrameworkApplication.Ta.mi(ib.a.EQa(ja.ZC),a,c,!1,h,wc.Tf.hg&&y?b:m);U=!wc.Tf.hg||!wc.Tf.Ny||!y||b.V3b;b=m=!1;if(2===c&&32===h&&U){let Gc=rb.GraphIterator.nb(ja.gp);Gc.gf()&&wc.Oq.Xjd(Gc,G.Ma)}2===c&&32===h&&J.a.instance.ga(30)&&rd.TableReader.tke(ja.gp)&&U&&rb.GraphIterator.nb(ja.gp).gf()&&(Ta=y?new Zq(yd.SelectionFactory.sj(ja.gp,!gc)):new Zq(yd.SelectionFactory.sj(ja.gp,!hc)),G.Lb.setSelection(Bb.SelectionEditor.Ql(yd.SelectionFactory.wl(ja.gp),!1,!1)),u.AFrameworkApplication.Ta.processAction(D.a.Q6a,
2),b=m=!0);if(32===h&&2===c&&U){if(!m&&0>=rd.TableReader.Ai(ja.gp)||0>=rd.TableReader.rk(ja.gp))m=!0;fb.normalize();if(Ta){Ta=Ta.restore();if(m)Ta=b&&!y?yd.SelectionFactory.sj(Ta.Ua.node,!hc):yd.SelectionFactory.sj(Ta.Ua.node,!0);else if(fb=rb.GraphIterator.nb(Ta.Ua.node),fb.rc(14),y)Gd.returnToContainingRow(fb),gc&&!J.a.instance.ga(77)?(fb.gf(),mc.OutlineElementNavigator.Oe(fb),wc.Ph.pda(fb,!1,!0)):wc.oZg(fb),Ta=yd.SelectionFactory.sj(fb.currentNode,!0);else if(Gd.returnToCell(fb),hc&&J.a.instance.ga(30))Gd.moveToLastRow(fb),
Ta=yd.SelectionFactory.sj(fb.currentNode,!1);else if(J.a.instance.ga(63)||J.a.instance.ga(77))wc.qik(fb),Ta=yd.SelectionFactory.sj(fb.currentNode,!0);G.Lb.setSelection(Ta);C.FocusManager.instance().xf(G.vI)}}else fb&&fb.cancel();Db&&Db.dispose();2===c&&ba.ULS.sendTraceTag(9011549,324,50,String.format("ActionId={0}, ActionName={1}, IsPptTable={2}, IsComplexTable={3}, Response={4}, TableId={5}",a,D.a.Qz(a)||"Unknown",J.a.instance.ga(77),va,h,ja.gp.id.toString()));y?Te.a.mark(4952):Te.a.mark(4950);return h}static goj(a,
b){Gd.moveToFirstRow(a);const c=Object(ua.a)(px.TableCellNode,a.currentNode).colSpan;if(b)for(b=0;b<c;b++)Gd.moveToNextColumn(a);else Gd.moveToPreviousColumn(a)}static wfj(a){return wc.b4b(a,!1,!0)}static qfj(a){return wc.b4b(a,!0,!0)}static sfj(a,b){let c=xn.a(a);b&&(c+=a.currentNode.colSpan-1);return c}static ufj(a){a=me.a.Wrb(a);return wc.b4b(a,!0,J.a.instance.ga(104)&&wc.yv)}static yfj(a){a=me.a.Wrb(a);return wc.b4b(a,!1,J.a.instance.ga(104)&&wc.yv)}static igj(a,b){return wc.b4b(a,!b,!0)}static b4b(a,
b,c){const h=new Yt;h.gp=null;if(!a)return h.response=8,h;var m={};let y=[],G=!1;a=wc.jm.HA(a);1===a.length&&(G=!0);for(let Ta=0;Ta<a.length;++Ta)if(a[Ta].el){const fb=[];let Db=rb.GraphIterator.nb(a[Ta].node);Db.gf();if(!Qe.isTableCellOrInside(Db))return h.response=8,h;if(b)Gd.returnToCell(Db),c&&1<Qe.getColSpan(Db.currentNode)?Qe.foreachMergedCells(Db.currentNode,gc=>{gc=rb.GraphIterator.nb(gc);gc.gf();Gd.moveToFirstRow(gc);Array.add(fb,gc)},2):Array.add(fb,Db),Gd.moveToFirstRow(Db);else{Qe.isTableCell(Db)||
Gd.returnToCell(Db);var U=Db.currentNode.rowSpan;Gd.returnToContainingRow(Db);if(1<U)for(var ja=1;ja<U;ja++){var va=rb.GraphIterator.nb(Db.currentNode);va.gf();Array.add(fb,va);Gd.moveToNextRow(Db)}Array.add(fb,Db)}for(U=0;U<fb.length;++U)if(Db=fb[U],ja=Gd.getContainingTable(Db),va=Db.currentNode.id.toString(),!m[va])if(m[va]=!0,h.gp)if(h.gp!==ja)if(Db.oTa(h.gp))wc.zWf(Db,h.gp,b),va=Db.currentNode.id.toString(),m[va]||(m[va]=!0,Array.add(y,Db));else if(m[va]=!1,rb.GraphIterator.nb(h.gp).Faa(ja)){const gc=
[];for(let hc=0;hc<y.length;hc++){const Gc=y[hc];wc.zWf(Gc,ja,b);va=Gc.currentNode.id.toString();m[va]||(m[va]=!0,Array.add(gc,Gc))}va=Db.currentNode.id.toString();m[va]||(m[va]=!0,Array.add(gc,Db));h.gp=ja;Array.clear(y);y=gc}else return h.response=8,h;else Array.add(y,Db);else h.gp=ja,Array.add(y,Db);Array.clear(fb)}if(!y.length)return h.response=8,h;h.mMb=y[0].currentNode;b=[];for(m=0;m<y.length;m++){a=y[m];if(!c&&rd.TableReader.Kyb(a))return h.response=8,h;Array.add(b,md.a.create(a.currentNode))}h.dgb=
G?1:b.length;h.ZC=b;h.response=32;return h}static zWf(a,b,c){do c?Gd.returnToContainingCell(a):Gd.returnToContainingRow(a);while(Gd.getContainingTable(a)!==b);c&&Gd.moveToFirstRow(a)}static VWc(a,b,c,h,m){return 1===c?(a=b.xE)&&Bb.SelectionEditor.Sg(a)?u.AFrameworkApplication.Ta.mi(a,D.a.insertTable,c,!0,h,m):2:32}static pFj(a,b,c,h,m){h.eQ=0;h.W7=0;let y=-1,G=null,U=null,ja=null;if(!b.view.Mh)return 2;const va=b.view;if(!va.Lb)return wc.Wc.Wb(Ed.a.wh,{["Reason"]:Cd.a.$ma}),8;Te.a.mark(4941);if(2===
c){const Ta=va.Lb.Qj;Ta.el&&(ja=new t.GraphTransaction(15),U=AF.a.instance.Elj(Ta.node),ja.yy(U),G=new rb.GraphIterator,G.Rc(U),G.zc(),y=G.mSa(U.currentNode))}a=u.AFrameworkApplication.Ta.mi(b.xE,a,c,!0,h,m);32===a&&2===c&&(U.isValid?(mc.OutlineElementNavigator.yJ(U,!1,!1),mc.OutlineElementNavigator.wi(U),c=yd.SelectionFactory.sj(U.currentNode,!0)):(G.n$d(y),mc.OutlineElementNavigator.wi(G),c=yd.SelectionFactory.sj(G.currentNode,!0)),va.Lb.setSelection(c),C.FocusManager.instance().xf(va.vI));ja&&
ja.dispose();Te.a.mark(4942);return a}static UIb(a,b){if(!b.view.Mh)return 8;a=b.view;if(!a.Lb)return 8;a=wc.jm.HA(a.Lb.Qj);if(0>=a.length)return 8;b=new rb.GraphIterator;for(let c=0;c<a.length;++c)if(b.set(a[c].node),b.gf(),!rd.TableReader.ys(b))return 8;return 32}static U2(a,b,c){var h=b.contextId===xb.a.Of;let m=null,y=null;if(h){m=b;if(Ib.HyperlinkReader.Fka(m,!0))return wc.Wc.Wb(Ed.a.wh,{["Reason"]:Cd.a.LFf}),8;y=new rb.GraphIterator;y.set(m.node);Bb.SelectionEditor.xt(y);Je.b(y)&&(wc.Wc.Wb(Ed.a.To,
{["Reason"]:Cd.a.nVd}),h=!1);!m.Qa&&y.tgg&&(wc.Wc.Wb(Ed.a.To,{["Reason"]:Cd.a.tdg}),h=!1)}if(1===c||!h)return h?32:8;Te.a.mark(4929);b=new t.GraphTransaction(7);b.yy(y);mc.OutlineElementNavigator.Oe(y);c=y.currentNode;wc.Ph.pda(y,!1,!1);h=wc.Oq.U2(y,1,2);const G=new rb.GraphIterator;G.set(c);G.gf();Gd.moveToCellContent(y,0,1);wc.Ph.yMb(G,y,m,!0,!0);Gd.returnToContainingTable(y);Gd.moveToCellContent(y,0,0);y.Mi();nm.i(G,y,null,G.role);wc.eq.xPa(G,null);Gd.returnToContainingTable(y);mc.OutlineElementNavigator.Oe(y);
G.Bb(1)&&nm.h(y,null,1,1,G,-1);wc.$ba&&wc.$ba.gtc(c,z.a.Pq);b.dispose();ba.ULS.sendTraceTag(42505434,324,50,String.format("ActionId={0}, ActionName={1}, IsPptTable={2}, TableId={3}",a,D.a.Qz(a)||"Unknown",J.a.instance.ga(77),h.id.toString()));Te.a.mark(4930);return 32}static insertColumn(a,b,c,h,m){u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.TestEcsFeatureIsEnabled",!1)?ba.ULS.sendTraceTag(541172701,324,50,"PPTO TestEcsFeature Client Flight Enabled. Box4."):
ba.ULS.sendTraceTag(541172702,324,50,"PPTO TestEcsFeature Client Flight Disabled. Box4.");var y=Bb.SelectionEditor.Sg(b)&&a===D.a.j0a||b.contextId===xb.a.tableCell;h=null;if(y&&(h=new rb.GraphIterator,h.set(b.node),h.rc(14),Qe.isTableCellOrInside(h)||(wc.Wc.Wb(Ed.a.To,{["Reason"]:Cd.a.Z_b}),y=!1),y&&!wc.qzb(h,a)&&(wc.Wc.Wb(Ed.a.To,{["Reason"]:Cd.a.Y_b}),y=!1),y)){Gd.returnToContainingCell(h);var G=J.a.instance.ga(63)?63:255;if(rd.TableReader.Ai(Gd.getContainingTable(h))>=G)return wc.Wc.Wb(Ed.a.To,
{["Reason"]:Cd.a.OXg}),8}if(1===c||!y)return y?32:8;Te.a.mark(4931);c=a!==D.a.L$a;y=new t.GraphTransaction(15);y.yy(h);b.node.UG().graphTransactionOperations.xia(2);G=new rb.GraphIterator;G.set(h.currentNode);G.rc(15);Gd.returnToContainingTable(h);let U=wc.Z7d(G,c);c&&U++;wc.Oq.Gcg(h,U,!c,m?m:1,wc.swb);h.set(b.node);h.rc(16);a===D.a.j0a?(Gd.moveToNextColumn(G),ii.OutlineNavigator.F$(G),mc.OutlineElementNavigator.Oe(h),wc.Ph.xnc(G),wc.Ph.yMb(h,G,b,!0,!0),wc.$ba&&wc.$ba.gtc(h.currentNode,z.a.Pq)):(a=
Fc.App.Kb.Jd,b=rb.GraphIterator.nb(b.node),b.gf(),wc.o$d(b,c),a.Cn.Lb.setSelection(yd.SelectionFactory.sj(b.currentNode,!0)));y.dispose();Te.a.mark(4932);return 32}static NRj(a){return!(J.a.instance.ga(14)&&rd.TableReader.XMj(a))&&!(J.a.instance.ga(30)&&rd.TableReader.Kyb(a))}static insertRow(a,b,c,h,m){const y=a===D.a.$qc;h=a===D.a.QTa;var G=b.node;const U=new rb.GraphIterator;U.set(G);U.gf();let ja=!0;gk.m(G)||rd.TableReader.ys(U)||(wc.Wc.Wb(Ed.a.To,{["Reason"]:Cd.a.TZd}),ja=!1);ja&&!wc.qzb(U,a)&&
(wc.Wc.Wb(Ed.a.To,{["Reason"]:Cd.a.Y_b}),ja=!1);if(1===c||!ja)return ja?32:8;Te.a.mark(4933);a=new t.GraphTransaction(15);a.yy(U);b.node.UG().graphTransactionOperations.xia(2);y?(m=new rb.GraphIterator,m.Rc(U),mc.OutlineElementNavigator.Oe(m),Gd.returnToContainingRow(U),wc.Oq.rde(U,h,1,wc.swb),Gd.moveToFirstColumn(U),ii.OutlineNavigator.F$(U),wc.Ph.yMb(m,U,b,!1,!0),Gd.returnToContainingRow(U),wc.$ba&&wc.$ba.gtc(m.currentNode,z.a.Pq)):wc.Oq.rde(U,h,m?m:1,wc.swb);b=Fc.App.Kb.Jd;G=rb.GraphIterator.nb(G);
G.rc(14);gk.l(G)||Gd.returnToContainingRow(G);h?Gd.moveToPreviousRow(G):Gd.moveToNextRow(G);wc.oZg(G);b.Cn.Lb.setSelection(yd.SelectionFactory.sj(G.currentNode,!0));a.dispose();Te.a.mark(4934);return 32}static Gja(a,b,c,h,m){b=$h.w5(a,b,c,h,m,{},16);2===c&&wc.yoa(a)&&ba.ULS.sendTraceTag(8791561,324,50,String.format("ActionId={0}, ActionName={1}, Response={2}",a,D.a.Qz(a)||"Unknown",b));return b}static yoa(a){return a===D.a.$_c||a===D.a.Z_c||a===D.a.a0c||a===D.a.X_c||a===D.a.W_c||a===D.a.Y_c||a===
D.a.T_c||a===D.a.S_c||a===D.a.U_c}static ICa(a,b,c){const h=new rb.GraphIterator;let m=b.isValid;m&&(h.set(b.node),h.gf()||(wc.Wc.Wb(Ed.a.C1,{["Reason"]:Cd.a.COc}),m=!1),Qe.isTableCellNode(b.node)||(wc.Wc.Wb(Ed.a.To,{["Reason"]:Cd.a.Z_b}),m=!1));m&&!wc.qzb(h,a)&&(wc.Wc.Wb(Ed.a.To,{["Reason"]:Cd.a.Y_b}),m=!1);if(m&&!wc.LH.YPd()){a=new rb.GraphIterator;a.Rc(h);do if(!wc.LH.BZb(a.currentNode)){wc.Wc.Wb(Ed.a.To,{["Reason"]:Cd.a.bKc});m=!1;break}while(Gd.moveToNextRow(a))}if(m&&(a=new rb.GraphIterator,
a.Rc(h),1!==c&&J.a.instance.ga(50)&&Fc.App.Ih.lw)){do for(b=P.a.Mz(a.currentNode);b.moveNext();){const y=b.currentNode;Ob.ParagraphReader.Yd(y)&&Fc.App.Ih.WY.Tqa(y)}while(Gd.moveToNextRow(a))}if(1===c)return m?32:8;if(m){Te.a.mark(4935);c=new t.GraphTransaction(7);try{c.yy(h),wc.Oq.yJi(h)}finally{c&&c.dispose()}Te.a.mark(4936);return 32}return 2}static mergeCells(a,b,c,h,m){a=new rb.GraphIterator;if(h=b.isValid){a.set(b.node);a.gf()||(wc.Wc.Wb(Ed.a.C1,{["Reason"]:Cd.a.COc}),h=!1);Qe.isTableCellNode(b.node)||
(wc.Wc.Wb(Ed.a.To,{["Reason"]:Cd.a.Z_b}),h=!1);if(h&&!wc.LH.YPd()){b=new rb.GraphIterator;b.Rc(a);var y=new rb.GraphIterator;y.Rc(a);for(var G=0;G<m.rowSpan;G++){for(var U=0;U<m.colSpan;U++){if(!wc.LH.BZb(b.currentNode)){wc.Wc.Wb(Ed.a.To,{["Reason"]:Cd.a.bKc});h=!1;break}b.Af(1)}if(!h)break;Gd.moveToNextRow(y);b.Rc(y)}}if(h&&1!==c&&J.a.instance.ga(50)&&Fc.App.Ih.lw)for(b=new rb.GraphIterator,b.Rc(a),y=new rb.GraphIterator,y.Rc(a),G=0;G<m.rowSpan;G++){for(U=0;U<m.colSpan;U++)Fc.App.Ih.WY.Tqa(b.currentNode),
b.Af(1);if(!h)break;Gd.moveToNextRow(y);b.Rc(y)}}if(1===c)return h?32:8;if(h){c=new t.GraphTransaction(7);try{c.yy(a),wc.Oq.mergeCells(a,m.rowSpan,m.colSpan)}finally{c&&c.dispose()}return 32}return 2}static splitCells(a,b,c){a=new rb.GraphIterator;let h=b.isValid;h&&(a.set(b.node),a.gf()||(wc.Wc.Wb(Ed.a.C1,{["Reason"]:Cd.a.COc}),h=!1),Qe.isTableCellNode(b.node)||(wc.Wc.Wb(Ed.a.To,{["Reason"]:Cd.a.Z_b}),h=!1),h&&1!==c&&J.a.instance.ga(50)&&Fc.App.Ih.lw&&(b=new rb.GraphIterator,b.Rc(a),Fc.App.Ih.WY.Tqa(b.currentNode)));
if(1===c)return h?32:8;if(h){c=new t.GraphTransaction(7);try{c.yy(a)}finally{c&&c.dispose()}return 32}return 2}static Y7(a,b,c,h,m){b=b.node;h=!0;rd.TableReader.Vab(b)||(wc.Wc.Wb(Ed.a.To,{["Reason"]:Cd.a.$Jc}),h=!1);wc.LH.BZb(b)||(wc.Wc.Wb(Ed.a.To,{["Reason"]:Cd.a.bKc}),h=!1);h&&(J.a.instance.ga(14)||J.a.instance.ga(63))&&wc.aj.Qke(b)&&(wc.Wc.Wb(Ed.a.To,{["Reason"]:Cd.a.LD}),h=!1);if(1===c)return h?32:8;if(h){if(J.a.instance.ga(50)&&Fc.App.Ih.lw)for(c=P.a.Mz(b);c.moveNext();)h=c.currentNode,12===
h.type&&Fc.App.Ih.WY.Tqa(h);m=Object(ua.a)(Ks,m);c=new t.GraphTransaction(7);c.kd(b);h=new rb.GraphIterator;h.set(b);h.gf();h.zc();wc.Ph.PCa(h);c.dispose();m&&(m.V3b=!0);ba.ULS.sendTraceTag(42505435,324,50,String.format("ActionId={0}, ActionName={1}, IsPptTable={2}, TableId={3}",a,D.a.Qz(a)||"Unknown",J.a.instance.ga(77),b.id.toString()));return 32}return 2}static deleteRow(a,b,c,h,m){b=b.node;if(!wc.LH.BZb(b))return 8;h=new rb.GraphIterator;h.set(b);h.gf();let y=gk.m(b);y||wc.Wc.Wb(Ed.a.To,{["Reason"]:Cd.a.SFf});
y&&!wc.qzb(h,a)&&(wc.Wc.Wb(Ed.a.To,{["Reason"]:Cd.a.Y_b}),y=!1);if(1===c)return y?32:8;if(y){if(J.a.instance.ga(50)&&!Fc.App.Ih.amIAlone)for(a=P.a.Mz(b);a.moveNext();)c=a.currentNode,12===c.type&&Fc.App.Ih.WY.Tqa(c);Te.a.mark(4937);m=Object(ua.a)(Ks,m);a=new t.GraphTransaction(7);a.kd(b);wc.Oq.WLc(h);a.dispose();m&&(m.V3b=!0);Te.a.mark(4938);return 32}return 2}static Q6a(a,b,c){let h=!1;a=null;b.el&&(a=new rb.GraphIterator,a.set(b.node),(h=rd.TableReader.aq(a)&&rd.TableReader.tke(a.currentNode))?
a.gf():wc.Wc.Wb(Ed.a.To,{["Reason"]:Cd.a.RFf}));return 1===c?h?32:8:h?(Te.a.mark(4939),b=new rb.GraphIterator,b.Rc(a),Gd.moveToCell(b,0,0),mc.OutlineElementNavigator.Oe(a),c=new t.GraphTransaction(7),c.yy(b),wc.Ph.cjh(a,b),c.dispose(),Te.a.mark(4940),32):2}static insertTable(a,b,c,h,m){if(!b.el||!Bb.SelectionEditor.Sg(b))return 2;if(J.a.instance.ga(14)&&wc.aj.hua(b))return wc.Wc.Wb(Ed.a.To,{["Reason"]:Cd.a.LD}),2;if(wc.Zq()&&wc.Zq().instance&&wc.Zq().instance.UW(b))return 2;var y=new rb.GraphIterator;
y.set(b.node);Bb.SelectionEditor.xt(y);if(Je.b(y))return wc.Wc.Wb(Ed.a.To,{["Reason"]:Cd.a.nVd}),2;if(1===c)return 32;c=1;y=2;m&&(c=m.rows,y=m.columns);h.eQ=y;h.W7=c;if(Bb.SelectionEditor.Sg(b)){h=new t.GraphTransaction(7);Te.a.mark(4927);h.kd(b.node);b.node.UG().graphTransactionOperations.xia(2);const U=new cI.a;J.a.instance.ga(50)&&Fc.App.Ih.lw&&Fc.App.Ih.WY.Tqa(b.node);var G=uc.a.ps(b);J.a.instance.ga(49)&&(G.cache.Zs&&(G=G.$d(null),wc.kh.IJ(G)),U.formatting=G.nm);U.languageId=uc.a.language(G);
J.a.instance.ga(71)&&(U.style=Ya.StyleReader.XD(b.node),wc.Sf.V1b(U.style)&&(G=Ya.StyleReader.iL(b.node)))&&(U.style=G.WG(Ya.StyleReader.iMa));J.a.instance.ga(54)?(G=rb.GraphIterator.nb(b.node),G.rc(11),wc.nM.v8(G.currentNode)):new lv.a(1,-1);b=wc.Ph.aFj(b);G=m&&m.HRj?wc.Oq.U2(b,c,y,U):wc.Oq.U2(b,c,y,U,!0);m&&(m.tableNode=G);mc.OutlineElementNavigator.Oe(b);J.a.instance.ga(56)&&U.style&&!Kd.OutlineElementReader.$je(b.currentNode)&&U.style.sa(kb.a.oY,!1)&&wc.Ph.HKa(b.currentNode,!0);wc.eq.xPa(b,null,
!0,!1,-1);Kd.OutlineElementReader.Aab(b)&&wc.Ph.pda(b,!1,!0,U);h.dispose();ba.ULS.sendTraceTag(42505436,324,50,String.format("ActionId={0}, ActionName={1}, IsPptTable={2}, TableId={3}, RowCount={4}, ColumnCount={5}",a,D.a.Qz(a)||"Unknown",J.a.instance.ga(77),G.id.toString(),c,y));Te.a.mark(4928);u.AFrameworkApplication.CL("Microsoft.Office.Web.SessionSettings.IWacWordWordEditorGridTableDefaultStyleSettings");return 32}return 2}static Jsc(a,b,c){if(1===c)return 32;Te.a.mark(5748);a=b.node;b=new t.GraphTransaction(15);
b.kd(a);a.setValue(kb.a.Bkb,!a.sa(kb.a.Bkb,!0));b.dispose();Te.a.mark(5749);return 32}static bmc(a,b,c,h,m){m.setValue(kb.a.Bkb,!b.node.sa(kb.a.Bkb,!0));return 32}}wc.HBh="top";wc.uhk="center";wc.Rhi="bottom";wc.BJf="__cumulative__";wc.dVd="__consistent__";wc.KB=new vi.a;wc.nD=new vi.a;wc.Di=null;wc.Zu=null;wc.yG=null;wc.rnf=null;wc.y8e=null;wc.iF=null;wc.Hm=null;wc.L2a=null;wc.dci=wc.bkj;wc.uAd=null;wc.rAd=null;wc.sAd=null;wc.tAd=null;wc.vAd=null;wc.xAd=null;wc.wAd=null;wc.UCd=null;wc.hd=null;wc.Kf=
null;wc.fd=null;wc.$o=null;wc.HMa=null;wc.Ug=null;wc.Xo=null;wc.Tga=null;wc.AD=null;Object(n.a)(wc,"TableActor",null,[]);var eI=d(308),HP=d(816),fI=d(875),IP=d(402),JP=d(801);class gI{constructor(a,b,c,h){this.aMc=this.ZLc=null;this.Yqc=a;this.Zqd=b;this.Owh=c;this.Qwh=h}}Object(n.a)(gI,"TableSimplificationInformation",null,[]);var wv=d(417),KP=d(450),$t=d(253),rq=d(214);class Oh{constructor(a,b,c,h,m,y,G,U,ja,va,Ta,fb,Db,gc,hc){this.Ug=this.L2a=this.dN=this.Fp=null;this.vFd=!1;this.lWh=y;this.yG=
G;this.Qnb=a;this.AD=b;this.Nx=c;this.Di=h;this.Xo=m;this.$a=U;this.yk=va;this.WLd=ja.create(2097162);this.jOe(this.WLd);this.z9e=ja.create(2097162);this.jOe(this.z9e);this.Oof=ja.create(2097162);this.jOe(this.Oof);this.W1=this.WLd;this.DKd=Ta;this.BD=fb;this.fd=Db;this.RVb=gc;this.HZh=gc.substr(0,3);this.Qpa=hc}get Sf(){return this.Ug||(this.Ug=vb.a.instance.resolve("Box4.List.IListReader"))}get Pr(){return this.Fp?this.Fp.Pr:0}get W6a(){return this.Fp.mb.W6a}get rja(){return this.Fp.mb.rja}get I_e(){return this.W1}get lVd(){return this.Fp.eH&&
!this.vFd}Frh(){this.vFd=!0}get a7g(){return!this.Fp.eH}get Laa(){return jc.a.instance}get VPj(){return this.$a.ka("InternalPasteTableWithReplacingCellIsEnabled")&&J.a.instance.ga(63)||J.a.instance.ga(77)}jOe(a){var b=new KP.a(-1);this.lWh.fV.xqb(b);const c=new rb.GraphIterator;c.set(b);b=this.yk.le(3);b.yy(c);c.Cl(a,80);b.dispose()}OVd(a,b=null){a=a.Lb;this.Fp=a.Pa.clone();this.vFd=!1;a=rb.GraphIterator.nb(a.Nkb);const c=rb.GraphIterator.nb(this.W1),h=this.yk.le(3);h.yy(c);a.Bb(82);do a.currentNode.q1a(null);
while(a.Cj(82));a=new Sh.a(b,Object(F.a)(this,this.nsi,"clearInternalClipboard"),new XH(a,c,this.Fp,h));a.Nl("InternalCopy");a.Oi=!b||b.Oi;a.run()}nsi(a,b){Te.a.mark(5566);b=b.target;if(b.Gi())return b.Mi(),!0;a.$g(Object(F.a)(this,this.gOc,"executeCopy"));return!0}gOc(a,b){b=new iz(b,null);b=new Sh.a(a,Object(F.a)(this,this.m0b,"coreCopySetup"),b);b.Nl("ExecuteCoreCopyToInternalClipboard");b.run();a.$g(Object(F.a)(this,this.btl,"trimNewText"));return!0}m0b(a,b){if(!b.source.Gi())return b.ph&&(b.ph.LIc=
null),ba.ULS.shipAssertTag(6305560,307,!1),!1;a.$g(Object(F.a)(this,this.TGf,"coreCopyIteration"));return!0}TGf(a,b){const c=b.insertAfter,h=b.source,m=b.target,y=h.currentNode;var G=this.a7g;if(!y.Aje)return a.$g(Object(F.a)(this,this.qKc,"coreCopyIncrement")),!0;b.ph.Ood&&(b.Ood=!0);if(!b.Ood&&(y.U2b()&&b.w6.ska.c++,y.U2b()||G&&!y.ezb(this.Pr)))return a.$g(Object(F.a)(this,this.qKc,"coreCopyIncrement")),!0;if(!b.Ood&&G&&!y.wy)return h.rEa()&&(b.Vtd=!0,b=new Sh.a(a,Object(F.a)(this,this.m0b,"coreCopySetup"),
new iz(b,c)),b.Nl("RecursiveCoreCopyToInternalClipboard"),b.run()),a.$g(Object(F.a)(this,this.qKc,"coreCopyIncrement")),!0;G=m.currentNode.Ko().zi;G=nm.a(y,G,!0);this.Laa.enc(b.w6.Z9a,G);m.nL(G,c,18===h.parentNode.type?1:h.role);m.Qk(G);b.insertAfter=G;Ob.ParagraphReader.Yd(G)&&(this.bFk(a,Object(F.a)(this,this.m0b,"coreCopySetup"),y,G,b),this.aFk(y,G));this.BQf(y,G);h.rEa()&&(ba.ULS.shipAssertTag(6305562,307,!b.Vtd),b=new Sh.a(a,Object(F.a)(this,this.m0b,"coreCopySetup"),new iz(b,null)),b.Nl("RecursiveCoreCopyToInternalClipboard"),
b.run());a.$g(Object(F.a)(this,this.hAi,"coreCopyIterationPostProcessing"));return!0}hAi(a,b){var c=b.source;const h=b.target;var m=h.currentNode,y=c.currentNode;Ob.ParagraphReader.fl(h)&&(b.$He[y.id.toString()]=m);if(J.a.instance.ga(54)&&Ob.ParagraphReader.Yd(m)){if(0<Ob.ParagraphReader.m5f(y))if(0<this.yG.j9a(y).MM)y.setValue(jb.a.tkc,0);else{var G=this.yG.cwb(y).MM;Oh.paragraphEditor.uv.ljb(m,G)}if(!this.W$a&&this.Qpa.jgd){c.zc();if(!rd.TableReader.ys(h)&&c.Oyb&&!this.rja)for(var U of this.Qpa.Rwk)m.removeProperty(U);
c.Qk(y)}}if(J.a.instance.ga(57)&&Ob.ParagraphReader.Yd(m)){G=[];U=[];for(let ja=0;ja<m.wordRunProperties.length;ja++)m.wordRunProperties.CY.$(ja,eI.CharacterPropertiesEditor.$ea),m.wordRunProperties.lfa.$(ja,eI.CharacterPropertiesEditor.Zea),G[ja]=!0,U[ja]=!1;m.te(jb.a.Acd,G);ba.ULS.shipAssertTag(6305563,307,G.length===m.wordRunProperties.length);ba.ULS.shipAssertTag(6305564,307,J.a.instance.ga(50));ba.ULS.shipAssertTag(6305565,307,!!Fc.App.Ih);J.a.instance.ga(50)&&Fc.App.Ih.lw&&(m.te(Js.a.Dw,U),
ba.ULS.shipAssertTag(6305566,307,U.length===m.wordRunProperties.length));(this.fd.hg&&this.fd.Ny||J.a.instance.ga(45)&&Fc.App.HD.NNb)&&m.setValue(jb.a.s9b,!0);J.a.instance.ga(14)&&m.ao(jb.a.G1d,jb.a.Gwk,jb.a.Iwk);J.a.instance.ga(45)&&Ob.ParagraphReader.Yd(m)&&m.ao(jb.a.Mab)}this.Z6g(h)&&(G=h.currentNode.UG(),m=aa.ImageReader.PSc(h.currentNode.properties,G.zi,!1),G=aa.ImageReader.PSc(h.currentNode.properties,G.zi,!0),U=null,$a.EmbeddedFileReader.jYc(h)&&(U=$a.EmbeddedFileReader.zRc(h.currentNode)),
this.I1d(m,y),this.I1d(G,y),this.I1d(U,y));this.a7g&&(this.AQf(h),rd.TableReader.aq(h)&&(y=this.Fp.sW(),y.moveNext(),(y=Qe.getCellLocation(c,y.current.node))||(y=new JP.a(0,0)),c=new gI(y,h,rd.TableReader.s4i(c),rd.TableReader.fgj(c)),this.AD.UXk(c)));Kd.OutlineElementReader.Wg(h)&&!h.FI(2)&&(this.Di.qca(h),h.zc());h.zc();b.ph&&(b.ph.LIc=b.insertAfter);a.$g(Object(F.a)(this,this.qKc,"coreCopyIncrement"));return!0}qKc(a,b){b.Vtd&&(b.insertAfter=b.LIc,b.Vtd=!1);if(!b.source.nEa()){b.ph&&(b.ph.LIc=b.insertAfter);
const c=b.source;11!==c.ri||c.zSc(-1)||this.vFk(a,c.currentNode,b.target.currentNode,b);return!1}a.$g(Object(F.a)(this,this.TGf,"coreCopyIteration"));return!0}aFk(a,b){a=Ud.f(a);Ud.f(b);for(b=0;b<a.length;b++)Object(F.a)(this,this.m0b,"coreCopySetup")}btl(a,b){if(b.Tra>=b.wKb.length)return a.$g(Object(F.a)(this,this.gAi,"copyTeardown")),!0;a=b.wKb[b.Tra];var c=a.node,h=a.Qa,m=a.Nb;if(!Bb.SelectionEditor.Du(a))if(!b.Tra&&Bb.SelectionEditor.Wl(a))m=h=Ob.ParagraphReader.textLength(c);else if(Ob.ParagraphReader.tm(a))h=
0,m=Ob.ParagraphReader.textLength(c);else if(Bb.SelectionEditor.N8(a)){ba.ULS.shipAssertTag(6305568,307,!b.Tra);var y=rb.GraphIterator.nb(c);h=y.rc(12);ba.ULS.shipAssertTag(6305569,307,h);c=y.origin;m=h=Ob.ParagraphReader.textLength(c)}else{if(Yi.OutlineReader.z9b(a))for(a=ox.a.Mz(a.node);a.moveNext();)y=a.currentNode,Ob.ParagraphReader.Yd(y)&&Array.add(b.wKb,md.a.createTextRange(y,0,Ob.ParagraphReader.textLength(y)));b.Tra++;return!0}y=b.$He[c.id.toString()];ba.ULS.shipAssertTag(6305570,307,!!y);
if(!y)return ba.ULS.sendTraceTag(21041548,307,15,"TrimNewTextParagraphCloneNull: {0}",{["ContextIndex"]:b.Tra,["SelectedContextsLength"]:b.wKb.length,["SelectedNodeType"]:c.type,["ContextId"]:a.contextId}),b.Tra++,!0;c=Ud.f(y);let G,U=!1;for(G=c.length-1;0<=G;G--)if(!c[G].gIc)if(4===c[G].Sq)c[G].Ee.blob=null,c[G].Ee.blob=new wv.a(c[G].Ee,wv.a.OLc),b.w6.ska.e++;else{c[G].Ee.blob=null;if(J.a.instance.ga(57)&&-1!==c[G].ng){var ja=c[G].Ee.formatting,va=void 0,Ta=void 0;ja&&-1===ja.ng?(Ta=c[G].ng+1,va=
c[G].I$-1,ja.ng=c[G].ng):(va=c[G].I$,Ta=c[G].ng);for(ja=0;ja<va;ja++)y.wordRunProperties.removeAt(Ta,16);0<va&&(U=!0)}va="";$t.f(c[G])?(va=" ",b.w6.ska.f++):$t.g(c[G])&&(Ta=$t.b(c[G]))&&(va=$t.a(Ta),b.w6.ska.g++);Ta=c[G].Ee.cp;Ta>=h&&Ta<m&&(Oh.characterPropertiesEditor.replaceTextRange(md.a.createTextRange(y,Ta,Ta+1),va),m=m-1+va.length,b.w6.ska.i++)}U&&y.Yu();this.uSk(y);c=Ob.ParagraphReader.textLength(y);m<c&&Oh.characterPropertiesEditor.replaceTextRange(md.a.createTextRange(y,m,c),"");0<h&&Oh.characterPropertiesEditor.replaceTextRange(md.a.createTextRange(y,
0,h),"");h=0;m=rb.GraphIterator.nb(y);for(m.Bb(6);!m.$q;)c=m.currentNode,m.Cj(6),aa.ImageReader.dH(c)?aa.ImageReader.Wje(c)?(Oh.paragraphEditor.pGf(c,md.a.Kj(y,h)),h++,b.w6.ska.d++):(c=rb.GraphIterator.nb(c),c.rc(12),c.Mi(),b.w6.ska.h++):ba.ULS.shipAssertTag(6305571,307,!1);!Ob.ParagraphReader.textLength(y)&&b.Tra===b.wKb.length-1&&Bb.SelectionEditor.Du(a)&&(a=rb.GraphIterator.nb(y),a.rc(25)&&(mc.OutlineElementNavigator.Oe(a),this.Di.PCa(a),b.Tra&&(this.Fp.mb.rja=!0)));this.Laa.GZa(b.w6.Sfd,b.w6.D6a,
b.w6.NPa,y);b.Tra++;return!0}uSk(a){const b=J.a.instance.ga(14),c=!this.fd.hg&&J.a.instance.ga(45),h=Oh.RN,m=a.Ra;if(J.a.instance.ga(57)&&m&&(b||c)){var y=new Qa.a,G=new Qa.a;for(let ja=0;ja<m.length;ja++){const va=m.ga(ja);if(b){va.xl&&y.add(va);if(h){if(va.Wh){for(var U=0;U<va.Wh.length;U++)G.add(va.Wh.ga(U).ng);va.Wh=null}}else va.fieldRangeEnd&&(G.add(va.fieldRangeEnd.ng),va.fieldRangeEnd=null),va.Io&&(G.add(va.Io.ng),va.Io=null);if(va.kk){for(U=0;U<va.kk.length;U++)G.add(va.kk.ga(U).ng);va.kk=
null}}if(c){if(Fc.App.HD.NNb){va.formatting&&Oh.kh.IJ(va.formatting);if(va.hyperlink){for(U=0;U<va.hyperlink.I$;U++)G.add(va.hyperlink.ng+U);va.hyperlink=null}va.en=!1}va.trackedChange=null;va.SI=!1}}a.WJa(!0,G);for(let ja of y)ja.xl=null;c&&1<m.length&&(a=m.first,a.trackedChange=new HP.a(a),m.last.SI=!0)}}gAi(a,b){this.W1.q1a(null);b.poj.dispose();Te.a.mark(5567);this.Ijk();this.dN=b.w6;this.Yng("Copy");this.cJj&&ba.ULS.sendTraceTag(6305600,307,50,"Empty ClipboardRoot");return!1}get cJj(){return!rb.GraphIterator.nb(this.W1).Gi()}NBl(){this.W1=
this.Oof}MBl(){this.W1=this.WLd}ABl(){this.W1=this.z9e}mDf(){const a=rb.GraphIterator.nb(this.W1);for(;a.Gi();)a.Mi()}Yng(a){const b=this.dN.ska.b;a+="-"+b;this.dN.ska.b=a;this.dN.Z9a.b=a;this.dN.Sfd.b=a;this.dN.D6a.b=a;this.dN.NPa.b=a;this.Laa.g1j(this.dN.ska);this.Laa.Ume(this.dN.Z9a);this.Laa.yog(this.dN.Sfd);this.Laa.Ome(this.dN.D6a);this.Laa.Nme(this.dN.NPa);this.dN.ska.b=b;this.dN.Z9a.b=b;this.dN.Sfd.b=b;this.dN.D6a.b=b;this.dN.NPa.b=b}e9g(a,b,c,h,m=null,y=null){this.Yng("Paste");b=rb.GraphIterator.nb(b);
const G=rb.GraphIterator.nb(this.W1);var U=null;m&&(U=new Qw.a(Yi.OutlineReader.NLc,Yi.OutlineReader.MKf),U=m.equals(new Qw.a(-1,-1))?new Qw.a(0,0):m.bV(U));if(this.aXc())if(G.Gi(),aa.ImageReader.dH(G.currentNode))m=G.currentNode,G.zc(),G.nL(this.Di.NWd(),null,1),G.Gi(),G.nL(m,null,2),G.zc(),G.Qk(m),G.Mi(),this.Qnb.yok(),this.Frh();else if($a.EmbeddedFileReader.lab(G.currentNode)){m=G.currentNode;G.zc();G.nL(this.Di.NWd(),null,1);G.Gi();var ja=this.Di.qca(G);ja=md.a.Kj(ja,0);Oh.characterPropertiesEditor.replaceTextRange(ja,
"<<"+$a.EmbeddedFileReader.ARc(m)+">>");G.zc();G.zc();G.Qk(m);G.Mi();this.Frh()}this.VPj&&this.Ykg(G,b)?(G.currentNode.q1a(null),ba.ULS.sendTraceTag(7869376,307,50,"Begin internal paste table in table"),this.iWk(y,G,b,U,a),ba.ULS.sendTraceTag(39699553,307,50,"The call to ReplaceTableCellsFromClipboardTable ended.")):(Te.a.mark(5564),G.currentNode.q1a(null),a={},a[Oh.aAj]=h,Wb.ListReader.oUa(c)&&this.Sf.Xlc&&(a[fI.a.jdg]=!0),c=new jz(G,b,c,U,a),h=new Sh.a(y,Object(F.a)(this,this.n0b,"corePasteSetup"),
c),h.Nl("ExecuteCorePasteFromInternalClipboard"),h.Oi=!y||y.Oi,this.SEk(c),h.run())}Bkg(a){if(a&&a.isValid){const b=rb.GraphIterator.nb(this.W1);return this.Ykg(b,a)}return!1}Ykg(a,b){if(Qe.isTableCellOrInside(b)&&1===a.X8a()){a.Bb(1);if(Kd.OutlineElementReader.Wg(a)){mc.OutlineElementNavigator.wi(a);if(rd.TableReader.aq(a)){rd.TableReader.Cu(a.currentNode)&&ba.ULS.sendTraceTag(17835601,307,50,"Source table is a complex table.");if(b.rc(14)&&!rd.TableReader.Cu(Gd.getContainingTable(b)))return ba.ULS.sendTraceTag(19269659,
307,50,"Target table is not a complex table."),!0;ba.ULS.sendTraceTag(19269660,307,50,"Target table is a complex table.");if(this.W$a)return!0}mc.OutlineElementNavigator.Oe(a)}a.zc()}return!1}iWk(a,b,c,h,m){c.rc(14);const y=gk.c(c),G=xn.a(c);c.Ng(14);var U=rd.TableReader.rk(c.currentNode);const ja=rd.TableReader.Ai(c.currentNode),va=rd.TableReader.rk(b.currentNode),Ta=rd.TableReader.Ai(b.currentNode);ba.ULS.sendTraceTag(8716373,307,50,"Target and source table row column counts: target: {0},{1}; source: {2},{3};",
U,ja,va,Ta);this.L2a=wc.swb;if(this.STj(y+va,G+Ta)){var fb=y+va-U;0<fb&&(Gd.moveToLastRow(c),ba.ULS.sendTraceTag(8716374,307,50,"Begin insert rows: "+fb),this.AD.rde(c,!1,fb,this.L2a),ba.ULS.sendTraceTag(8716375,307,50,"Completed inserting rows."),c.Ng(14));fb=G+Ta-ja;if(0<fb){ba.ULS.sendTraceTag(8716376,307,50,"Begin insert columns: "+fb);try{this.AD.Gcg(c,ja,!1,fb,this.L2a)}catch(Db){throw ba.ULS.sendTraceTag(19269661,307,10,"Insert columns failed: {0}",Db.toString()),Db;}ba.ULS.sendTraceTag(8716377,
307,50,"Completed inserting columns.")}U=this.t3i(U,ja,va,Ta,y,G);ba.ULS.sendTraceTag(8716378,307,50,"Begin paste cell contents");a=new Sh.a(this.W$a?a:null,Object(F.a)(this,this.Ryk,"pasteTableOperationRun"),new ZH(null,b,c,h,y,G,U,null,m));a.Nl("ExecuteCorePasteTableInTable");a.Oi=!1;a.run()}}STj(a,b){if(!this.Yhg)return!0;const c={};a>Oh.QHc&&(c.rowCount=a,c.c_maxTableRowColCount=Oh.QHc);b>Oh.QHc&&(c.columnCount=b,c.c_maxTableRowColCount=Oh.QHc);const h=a*b;h>Oh.Kzf&&(c.rowCount=a,c.columnCount=
b,c.cellsCount=h,c.c_maxTableCellCount=Oh.Kzf);0<rq.a(c).length&&ba.ULS.sendTraceTag(39716808,307,10,"IsTableDimensionValid: {0}",c);return!rq.a(c).length}Ryk(a,b){if(b.cNb){if(b.cNb.inProgress)return!0;Qe.isTableCell(b.source)||b.source.Ng(16);this.Yhg&&Qe.isFirstCellInTable(b.source)&&this.$Xb(b.If,b.target.currentNode);if(Qe.isLastCellInTable(b.source))return this.Kjk(Gd.getContainingTable(b.target)),ba.ULS.sendTraceTag(7869377,307,50,"End of internal paste table in table"),!1;Qe.isTableCell(b.target)||
b.target.Ng(16);const c=!this.W$a;Qe.isLastCellInRow(b.source)?(Gd.moveToNextRow(b.target),Gd.moveToColumnByIndex(b.target,b.Oia),ba.ULS.sendTraceTag(8716379,307,50,"Move to next row to replace cell contents")):Gd.moveToNextOrPreviousCell(b.target,!1,c);Gd.moveToNextOrPreviousCell(b.source,!1,c)}else rd.TableReader.aq(b.target)||b.target.Ng(14),rd.TableReader.aq(b.source)||b.source.Ng(14),Gd.moveToCell(b.target,b.rowIndex,b.Oia),Gd.moveToCell(b.source,0,0);for(;b.target.Gi();)b.target.Mi();b.cNb=
new Sh.a(a,b.j9g?b.j9g:Object(F.a)(this,this.n0b,"corePasteSetup"),new jz(b.source,b.target,null,b.Ffd));b.cNb.Nl("ExecuteCorePasteCellContentInCell");b.cNb.Oi=!1;b.cNb.run();return!0}Ijk(){if(this.W$a){for(var a=rb.GraphIterator.nb(this.I_e),b=a.currentNode;14!==a.ri;)if(b=a.Gi(),!b){ba.ULS.sendTraceTag(39716809,307,50,"NormalizeCopiedTable: Couldn't find any Table graph node under this.TheClipboardRoot.");return}this.A_g(b)}}Kjk(a){this.W$a&&this.A_g(a)}uql(a){const b=rb.GraphIterator.nb(a);this.Nx.f8b(b,
null,!0);a.isGhostCell=!1;a.rowSpan=1;a.colSpan=1}A_g(a){if(a&&14===a.type){ba.ULS.sendTraceTag(39716810,307,50,"NormalizeTable: start to normalize.");var b={},c=rd.TableReader.rk(a),h=rd.TableReader.Ai(a),m=rb.GraphIterator.nb(a);Gd.forEachCellInTable(m,(y,G,U)=>{const ja={};y=y.currentNode;if(16===y.type)if(y.isGhostCell)Oh.qFf(G,U)in b||(this.uql(y),ja.IsGhostCell="->false");else{J.a.instance.ga(77);Oh.WNk(a,y,G,U,c,(Ta,fb,Db)=>{ja.rowSpan=String.format("{0}:{1}->{2}",Ta,fb,Db)});Oh.VNk(a,y,U,
G,h,(Ta,fb,Db)=>{ja.colSpan=String.format("{0}:{1}->{2}",Ta,fb,Db)});const va=String.format("{0},{1}-{2},{3}",G,U,G+y.rowSpan,U+y.colSpan);for(let Ta=0;Ta<y.rowSpan;Ta++)for(let fb=0;fb<y.colSpan;fb++)if(Ta||fb)b[Oh.qFf(G+Ta,U+fb)]=va}if(0<rq.a(ja).length){if(void 0===ja.IsGhostCell||null===ja.IsGhostCell){if(void 0===ja.rowSpan||null===ja.rowSpan)ja.rowSpan=y.rowSpan;if(void 0===ja.colSpan||null===ja.colSpan)ja.colSpan=y.colSpan}ba.ULS.sendTraceTag(39175904,307,50,"NormalizeTable: [{0},{1}]: {2}.",
G,U,ja)}return!0});Oh.eOi(b)}}get Yhg(){return J.a.instance.ga(77)}get W$a(){return!!this.$a&&this.$a.ka("ComplexTableCellPasteWithFormattingIsEnabled")}$Xb(a,b){a?(b=rb.GraphIterator.nb(b),b.TA(1)?(b=b.Bb(2))?(b=yd.SelectionFactory.Qg(b,0),a.Lb.setSelection(b)):ba.ULS.sendTraceTag(38843739,307,50,"AdjustSelectionAfterPaste: no child paragraph node was found."):ba.ULS.sendTraceTag(38843740,307,50,"AdjustSelectionAfterPaste: no child OE node was found.")):ba.ULS.sendTraceTag(38843738,307,50,"AdjustSelectionAfterPaste: interactiveView is null, abort.")}t3i(a,
b,c,h,m,y){const G=[];for(let U=0;U<Math.max(m+c,a);U++){let ja=0,va=y+h;for(U<m?ja=b:U>=m&&U<Math.min(m+c,a)?ja=y:U>=m+c&&U<a?ja=b:va=Math.max(y+h,b);ja<va;ja++)Array.add(G,Array(2)),G[G.length-1][0]=U,G[G.length-1][1]=ja}return G}n0b(a,b){if(!b.source.Gi())return a.$g(Object(F.a)(this,this.XYa,"pasteTeardown")),!0;a.$g(Object(F.a)(this,this.UGf,"corePasteIteration"));return!0}rWk(a,b){if(this.W$a)if(!b||!a)ba.ULS.sendTraceTag(39175905,307,50,"ReplicateTableCellProperties: {0}",{["source"]:a,["table"]:b});
else if(16===b.currentNode.type&&16===a.parentNode.type){b=b.currentNode;a=a.parentNode;var c={};b.isGhostCell!==a.isGhostCell&&(b.isGhostCell=a.isGhostCell,c.IsGhostCell=b.isGhostCell);b.isSkippedCell!==a.isSkippedCell&&(b.isSkippedCell=a.isSkippedCell,c.IsSkippedCell=b.isSkippedCell);b.Ojb!==a.Ojb&&(b.Ojb=a.Ojb,c.ShouldRenderCell=b.Ojb);b.colSpan!==a.colSpan&&(c.ColSpan=String.format("{0}<={1}.",b.colSpan,a.colSpan),b.colSpan=a.colSpan);b.rowSpan!==a.rowSpan&&(c.RowSpan=String.format("{0}<={1}.",
b.rowSpan,a.rowSpan),b.rowSpan=a.rowSpan);rq.a(c)}}UGf(a,b){const c=b.source,h=b.target,m=c.currentNode;if(!m.Aje||!m.osb)return a.$g(Object(F.a)(this,this.rKc,"corePasteIncrement")),!0;if(this.fd.hg&&Kd.OutlineElementReader.Wg(c)){if(!mc.OutlineElementNavigator.wi(c).osb)return mc.OutlineElementNavigator.Oe(c),a.$g(Object(F.a)(this,this.rKc,"corePasteIncrement")),!0;mc.OutlineElementNavigator.Oe(c)}ba.ULS.shipAssertTag(6305608,307,!m.U2b());var y=h.currentNode.Ko().zi;y=nm.a(m,y,!0);y.igb();this.rWk(c,
h);h.nL(y,b.insertAfter,c.role);h.Qk(y);b.insertAfter=y;J.a.instance.ga(50)&&Fc.App.Ih.lw&&Fc.App.Ih.WY.Tqa(y);this.BQf(m,y);b=new Sh.a(a,Object(F.a)(this,this.n0b,"corePasteSetup"),new jz(c,h,null,b.Ffd,b.$K));b.Nl("RecursiveCorePasteOperation");b.run();a.$g(Object(F.a)(this,this.lAi,"corePasteIterationPostProcessing"));return!0}BFk(a,b,c){b=Ud.f(b);c=Ud.f(c);for(let h=b.length-1;0<=h;h--)b[h].WEe(c[h],a,Object(F.a)(this,this.n0b,"corePasteSetup"))}I1d(a,b){a&&(ba.ULS.shipAssertTag(6305610,307,a.Sa(ge.a.fkc)),
a.Sa(ge.a.fkc)||a.setValue(ge.a.fkc,a.sa(ge.a.m0g,"")),b=(b=IP.SectionNavigator.T3f(b))?b.fileId:Fc.App.Kb.Jd.Sba?Fc.App.Kb.Jd.Sba.fileId:null,!a.Sa(ge.a.fileId)&&b&&a.setValue(ge.a.fileId,b))}J1d(a){a&&this.Qnb.C7k()}lAi(a,b){const c=b.target,h=c.currentNode,m=b.source.currentNode;Ob.ParagraphReader.Yd(h)&&(this.CFk(a,Object(F.a)(this,this.n0b,"corePasteSetup"),m,h,b),this.BFk(a,m,h));h.Z0g();b.$K[fI.a.jdg]&&22===h.type&&h.setValue(jb.a.listID,Number.MAX_VALUE);if(J.a.instance.ga(11)&&Ob.ParagraphReader.Yd(h)){var y=
Ud.j(h,5);if(0<y.length){for(var G of y)!G.properties.Sa(jb.a.i$g)&&G.properties.Sa(jb.a.g$g)&&G.properties.setValue(jb.a.i$g,G.properties.eb(jb.a.g$g)),aa.ImageReader.Tje(G.properties)||this.Qnb.S0k();h.Ko().contentReplicator.forceOutbound(null,null,null)}}J.a.instance.ga(25)&&Kd.OutlineElementReader.Wg(c)&&this.Di.q2e(c.currentNode);J.a.instance.ga(10)&&Yi.OutlineReader.kZc(h)&&(y=kq.b(h),b=b.Ffd,kq.c(h,y.x+b.x,y.y+b.y));if(this.Z6g(c)){b=c.currentNode.UG();y=aa.ImageReader.PSc(c.currentNode.properties,
b.zi,!1);G=aa.ImageReader.PSc(c.currentNode.properties,b.zi,!0);let U=null;$a.EmbeddedFileReader.jYc(c)&&(U=$a.EmbeddedFileReader.zRc(c.currentNode));this.J1d(y);this.J1d(G);this.J1d(U);if(y||G||U)b.gPj=!0,b.hPj=!0}J.a.instance.ga(24)&&$a.EmbeddedFileReader.jYc(c)&&(b=c.currentNode,$a.EmbeddedFileReader.CLj(c)?(c.zc(),y=this.Nx.mEi(),y.setValue(kb.a.XI,Oh.Jk.isRtl(b)?11:9),G=kq.b(h),kq.c(y,G.x,G.y),c.nL(y,b,1),c.Qk(b),c.QMf(),this.Nx.JZ(c,!1)):c.Mi(),y=this.Di.qca(c),y=md.a.Kj(y,0),Oh.characterPropertiesEditor.replaceTextRange(y,
"<<"+$a.EmbeddedFileReader.ARc(b)+">>"));this.AQf(c);this.NAl(m,h);c.zc();a.$g(Object(F.a)(this,this.rKc,"corePasteIncrement"));return!0}Z6g(a){return J.a.instance.ga(1)&&aa.ImageReader.g9b(a)||J.a.instance.ga(24)&&$a.EmbeddedFileReader.jYc(a)}NAl(a,b){if(this.fd.hg&&rd.TableReader.Vab(a)){let c=0;const h=rd.TableReader.rk(a);for(let m of rd.TableReader.bTc(a,0,h-1))m.Vsc&&c++;a=this.yk.le(4);a.kd(b);b.properties.setValue(kb.a.Tya,h-c);a.dispose()}}rKc(a,b){if(!b.source.nEa())return a.$g(Object(F.a)(this,
this.XYa,"pasteTeardown")),!0;a.$g(Object(F.a)(this,this.UGf,"corePasteIteration"));return!0}XYa(){Te.a.mark(5565);return!1}Lcd(){return!rb.GraphIterator.nb(this.W1).Gi()}aXc(){return this.lVd?1===rb.GraphIterator.nb(this.W1).X8a():!1}FFj(){const a=rb.GraphIterator.nb(this.W1);this.aXc()&&a.Gi();return 1===a.X8a()&&(a.Gi(),Kd.OutlineElementReader.Wg(a)&&1===a.X8a()&&a.Bb(2))?Ob.ParagraphReader.fl(a)&&!Oh.LH.TFf(a):!1}S3i(){const a=rb.GraphIterator.nb(this.W1);this.aXc()&&a.Gi();a.Gi();a.Gi();ba.ULS.shipAssertTag(6305614,
307,Ob.ParagraphReader.fl(a));return Ob.ParagraphReader.text(a.currentNode)}hZf(a){try{return this.p5i(a)}catch(b){return ba.ULS.sendTraceTag(23643968,307,10,"GetCopySourceFromDOMTree failed with exception:{0}",b.message),0}}p5i(a){let b=0;if(a&&(b=this.o5i(a),0===b&&a.childNodes))for(let c=0;c<a.childNodes.length&&(b=this.hZf(a.childNodes[c]),0===b);c++);return b}o5i(a){if(1===a.nodeType&&a.getAttribute){a=(a.getAttribute("class")||"").split(" ");for(const b of a)if(b.startsWith(this.HZh))return b.startsWith(this.RVb)?
this.Pr&&b===this.RVb+this.Pr?3:2:1}return 0}bFk(a,b,c,h,m){m.$K||(m.$K={});Oh.Oa.raiseEvent("OnParagraphCopy",new kz(a,b,c,h,m.$K))}vFk(a,b,c,h){h.$K||(h.$K={});Oh.Oa.raiseEvent("OnCopyComplete",new kz(a,null,b,c,h.$K))}SEk(a){a.$K||(a.$K={});Oh.Oa.raiseEvent("BeforePaste",new YH(a.$K))}CFk(a,b,c,h,m){Oh.Oa.raiseEvent("OnParagraphPaste",new kz(a,b,c,h,m.$K))}AQf(a){Qe.isTableCell(a)&&(a.Bb(1)||this.Nx.JZ(a,!0),a.zc())}BQf(a,b){this.DKd.isTableCellNode(b)&&(b.width=a.width)}static get kh(){return Oh.Kf||
(Oh.Kf=vb.a.instance.resolve("Box4.IFormattingEditor"))}static get characterPropertiesEditor(){return Oh.Zg||(Oh.Zg=vb.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static get paragraphEditor(){return Oh.Rw||(Oh.Rw=vb.a.instance.resolve("Box4.IParagraphEditor"))}static get RN(){const a=vb.a.instance.rb("Box4.IFeatureHelper");return!!a&&a.isFeatureEnabled(79)}static get LH(){return pm.a.instance}static get Jk(){return Pw.PageReader.instance}static eOi(a){const b={};for(const c of rq.a(a)){const h=
a[c];b[h]=h in b?String.format("{0}|{1}",b[h],c):c}1<=rq.a(b).length&&ba.ULS.sendTraceTag(39204995,307,50,"NormalizeTable: ghostCells - {0}",b)}static VNk(a,b,c,h,m,y){b.colSpan>m-c&&(y&&y("A",b.colSpan,m-c),b.colSpan=m-c);a=Oh.Ohl(a,b,h,c);b.colSpan!==a&&(y&&y("B",b.colSpan,a),b.colSpan=a)}static WNk(a,b,c,h,m,y){b.rowSpan>m-c&&(y&&y("A",b.rowSpan,m-c),b.rowSpan=m-c);a=Oh.Phl(a,b,c,h);b.rowSpan!==a&&(y&&y("B",b.rowSpan,a),b.rowSpan=a)}static Ohl(a,b,c,h){return Oh.Kvh(a,b.colSpan,(m,y)=>{Gd.moveToCell(m,
c,h+y)})}static Phl(a,b,c,h){return Oh.Kvh(a,b.rowSpan,(m,y)=>{Gd.moveToCell(m,c+y,h)})}static Kvh(a,b,c){if(14!==a.type)throw Error.argument("tableNode is not a Table.");if(!c)throw Error.argumentNull("MoveToCellAction");for(let m=1;m<b;m++){var h=rb.GraphIterator.nb(a);c(h,m);h=h.currentNode;if(!h||16!==h.type||!h.isGhostCell)return m}return b}static qFf(a,b){return a+","+b}}Oh.Oa=new bd.a;Oh.Kf=null;Oh.Zg=null;Oh.Rw=null;Oh.QHc=50;Oh.Kzf=1225;Oh.aAj="PasteConstrainingWidth";Object(n.a)(Oh,"InternalClipboard",
null,[]);class hI extends wj{constructor(a,b,c,h,m,y){super(a,b,c,m);this.Zr=h;this.cEd=y}get qcl(){return u.AFrameworkApplication.fa.ka("AutoResizeDragDropImageIsEnabled")}get qh(){return this.cEd.value}get Lcd(){return this.Zr.Lcd()}get B9g(){const a=this.Zr;return a.lVd&&!a.aXc()}qRf(a,b){ba.ULS.shipAssertTag(6305616,307,Yi.OutlineReader.Ut(a));const c=kq.b(a.currentNode);if(Yi.OutlineReader.isEmpty(a)){var h=md.a.create(a.currentNode);a.AB(8);u.AFrameworkApplication.Ta.mi(h,D.a.TK,2,!0,null,null)}else a.AB(8);
(h=a.TA(1))&&a.zc();this.Zr.e9g(this.ph.If,a.currentNode,h,-1,c,b)}get cfg(){return this.Zr.FFj()}get XFf(){return this.Zr.S3i()}pRf(a){const b=new rb.GraphIterator;this.jhb.restore(b);ba.ULS.shipAssertTag(6305618,307,Kd.OutlineElementReader.Wg(b));this.ph.P0&&this.ph.P0.GGc("internal");let c=-1;if(this.gth&&Object(za.a)(10,this.ph.rd))c=this.ph.rd.sa(Js.a.k2b,-1);else if(this.qcl){const h=this.f6i(b.currentNode);c=h?h.clientWidth:c}this.Zr.e9g(this.ph.If,b.parentNode,b.currentNode,c,null,a);this.Nhg&&
(this.jhb.restore(b),Kd.OutlineElementReader.Wg(b)&&this.Zr.Bkg(b)&&(a=mc.OutlineElementNavigator.wi(b)))&&(this.ph.Lsa=yd.SelectionFactory.Qg(a,0))}f6i(a){return a?(a=a?a.sc(this.qh.Ma):null)?a.htmlElement:null:null}Wth(){const a=new rb.GraphIterator;this.jhb.restore(a);return this.Zr.Bkg(a)}get vth(){return Wb.ListReader.ix}get uth(){return!this.Zr.rja&&!this.Zr.lVd}}Object(n.a)(hI,"InternalPasteExecutionManager",wj,[]);class iI{constructor(a,b){this.Zr=a;this.cEd=b}create(a,b,c){return new hI(a,
b,c,this.Zr,Fc.App.Kb.Jd,this.cEd)}}Object(n.a)(iI,"Factory",null,[1037]);var lz;(function(a){a[a.unknown=0]="unknown";a[a.differentBox4App=1]="differentBox4App";a[a.sameBox4AppDifferentSession=2]="sameBox4AppDifferentSession";a[a.sameBox4AppSameSession=3]="sameBox4AppSameSession"})(lz||(lz={}));Object(n.b)("CopySource",lz);class Wr{constructor(a,b,c){this.Zr=a;this.dcf=b;this.lQh=c}zyk(a,b,c){ba.ULS.shipAssertTag(6305620,307,!!a);ba.ULS.shipAssertTag(6305621,307,Bb.SelectionEditor.Sg(b));ba.ULS.shipAssertTag(6305622,
307,!!c);ba.ULS.shipAssertTag(6305623,307,Object(za.a)(Ro,c.r5));const h=c.r5;h.vQa=this.Zr.hZf(a);this.f1j(a,h);const m=this.Lie(a,b,h);if(m||this.BVe(a,b,h)){var y=new t.GraphTransaction(7);y.kd(b.node);b.node.UG().graphTransactionOperations.xia(8);m?(ba.ULS.sendTraceTag(40706500,307,50,"Internal paste operation starts. {0}; {1}",h.Sw,h.browserName),a=this.dcf.create(b,h,y)):(ba.ULS.sendTraceTag(40706501,307,50,"External paste operation starts. {0}; {1}; {2}",h.Sw,h.vQa,h.browserName),Wr.Z0j(a),
a=this.lQh.create(a,b,h,y));c=new Sh.a(c,Object(F.a)(a,a.m9g,"pasteSetup"),null);c.Nl("Paste");c.run()}else h.Lsa=yd.SelectionFactory.wu(b)}Lie(a,b,c){return!this.Jig(c)&&3===c.vQa}BVe(){return!0}Jig(a){return 1===(a.Sw&8192?1:0)}ldg(a,b){ba.ULS.shipAssertTag(6305624,307,Bb.SelectionEditor.Sg(a));ba.ULS.shipAssertTag(6305625,307,!!b);ba.ULS.shipAssertTag(6305626,307,Object(za.a)(Ro,b.r5));const c=new t.GraphTransaction(7);c.kd(a.node);a=this.dcf.create(a,b.r5,c);b=new Sh.a(b,Object(F.a)(a,a.m9g,"pasteSetup"),
null);b.Nl("InternalPasteAtIp");b.run()}f1j(a,b){if(a){let c=!1,h=!1;a.innerHTML&&0<=a.innerHTML.indexOf("mso-tab-count")?h=!0:a.innerText&&0<=a.innerText.indexOf("\t")&&(c=!0);if(c||h)u.AFrameworkApplication.CL("Microsoft.Office.Web.SessionSettings.IWacWordWordEditorInlineTabInsertionSettings"),ba.ULS.sendTraceTag(42471960,307,50,"User pasted InlineTabs. Source: {0}, Contains tab character (u0009): {1}, IsFromRichClient: {2}",lz[b.vQa],c,h)}}static Z0j(a){a&&Wr.D2h.test(a.innerText)&&ba.ULS.sendTraceTag(6350173,
307,50,"External paste operation starts on WebUrl")}}Wr.D2h=RegExp("^[\\s]*(((http|https):\\/\\/)|(www\\.))[\\w\\-_]+(\\.[\\w\\-_]+)+[\\w\\-\\.,@?^=%&amp;:/~\\+#]*[\\s]*$");Object(n.a)(Wr,"PasteCoordinator",null,[]);class kC{constructor(a,b){this.hk=a;this.J6=b}}Object(n.a)(kC,"PasteFloatieFeatureSetBuilder",null,[]);class Yn{constructor(a,b){this.RQb=a;this.PNh=b}get titleText(){return CommonUIStrings.l_ClipboardUseShortcutTitle}get QVf(){return CommonUIStrings.l_ClipboardUseShortcutMessage}get FLc(){return CommonUIStrings.l_ClipboardCut}get MBe(){return CommonUIStrings.l_ClipboardCut_Mac}get pKc(){return CommonUIStrings.l_ClipboardCopy}get LBe(){return CommonUIStrings.l_ClipboardCopy_Mac}get iJa(){return CommonUIStrings.l_ClipboardPaste}get NBe(){return CommonUIStrings.l_ClipboardPaste_Mac}get nxa(){return CommonUIStrings.l_ClipboardPasteText}get OBe(){return CommonUIStrings.l_ClipboardPasteText_Mac}get eUd(){return this.PNh}get ODf(){return CommonUIStrings.l_ClipboardExtensionLink}get hQa(){return CommonUIStrings.l_ClipboardExtensionSuggestion}SRf(){ba.ULS.sendTraceTag(8716421,
307,50,null);qd.a.un(this.eUd,"_blank",void 0,"ClipboardAccessExtensionLink")}c1(a,b){let c=v.a.uk;u.AFrameworkApplication.fa.ka("CcpFixIPadShortcutStringsIsEnabled")&&(c=v.a.Ni||c);return c?String.format(b,"\u2318"):a}dispose(){this.RQb=null}yNe(a){this.NGf(a)}$Xj(a){this.NGf(a)}NGf(a){this.RQb&&this.RQb(a)}}Yn.id="CopyPasteShortcutDialog";Yn.IAh="CopyPasteText";Object(n.a)(Yn,"ACopyPasteShortcutDialog",null,[106]);class jI extends Yn{constructor(a,b,c){super(a,b);a=document.createElement("span");
a.className="WACCopyPasteShortcutDialogTextPanel";b=document.createElement("span");b.id=Yn.IAh;var h=document.createElement("span");h.innerText=this.QVf;var m=document.createElement("span");m.className="UIFontBold";m.innerText=this.c1(this.FLc,this.MBe);const y=document.createElement("span");y.className="UIFontBold";y.innerText=this.c1(this.pKc,this.LBe);const G=document.createElement("span");G.className="UIFontBold";G.innerText=this.c1(this.iJa,this.NBe);b.appendChild(h);b.appendChild(document.createElement("br"));
b.appendChild(m);b.appendChild(y);b.appendChild(G);c.ka("PasteTextOnlyShortcutDialogIsEnabled")&&(v.a.Uj||v.a.fg)&&(c=document.createElement("span"),c.className="UIFontBold",c.innerText=this.c1(this.nxa,this.OBe),b.appendChild(c));a.appendChild(b);this.eUd?(ba.ULS.sendTraceTag(8716420,307,50,null),c=document.createElement("span"),b=document.createElement("a"),b.href="#",b.innerText=this.ODf,wd.a.addHandler(b,"click",Object(F.a)(this,this.SRf,"extensionLinkHandler")),c.appendChild(b),m=this.hQa.indexOf("{0}"),
-1!==m&&(h=this.hQa.substring(m+3,this.hQa.length),m=document.createTextNode(this.hQa.substring(0,m)),h=document.createTextNode(h),c.insertBefore(m,b),c.appendChild(h)),a.appendChild(document.createElement("br")),a.appendChild(c)):ba.ULS.sendTraceTag(8716422,307,50,null);c=new Rf.StandardDialog;c.xd=0;c.ig=Yn.id;c.Bx(this.titleText,null,0,Object(F.a)(this,this.$Xj,"legacyCopyPasteShortcutDialogHandler"),a);c.O5(Yn.IAh)}}Object(n.a)(jI,"CopyPasteShortcutDialog",Yn,[]);class kI extends Yn{constructor(a,
b){super(a,b);b={};a=this.BFj;b.extensionStartText=this.hTi;b.extensionLink=null;b.extensionEndText=null;b.shortcutsMessageText=this.ubl;b.cutText=this.c1(this.FLc,this.MBe);b.copyText=this.c1(this.pKc,this.LBe);b.pasteText=this.c1(this.iJa,this.NBe);4!==u.AFrameworkApplication.Aa.hb.Vk&&(b.pasteTextOnly=this.c1(this.nxa,this.OBe));b={["id"]:"CopyPasteInstallDialog",["bodyControls"]:b};const c=new Nh.a(!1,!1,!0);c.ig="CopyPasteInstallDialog";c.xd=0;c.Xe(1,this.AFj);c.jya(1);c.$i(a,Object(F.a)(this,
this.yNe,"reactCopyPasteShortcutDialogHandler"),b)}get ubl(){return CommonUIStrings.l_ClipboardInstallDialogShortcutsMessage}get AFj(){return CommonUIStrings.l_ClipboardInstallDialogInstallButton}get BFj(){return CommonUIStrings.l_ClipboardInstallDialogTitle}get hTi(){return CommonUIStrings.l_ClipboardInstallDialogExtensionMessage}}Object(n.a)(kI,"ReactCopyPasteInstallDialog",Yn,[]);class lI extends Yn{constructor(a){super(a,null);this.Qmg="https://prod.support.services.microsoft.com/en-us/office/troubleshoot-copy-and-paste-errors-in-powerpoint-for-the-web-0dc01da6-6988-40e5-96ea-0567c151ae2f?preview=true";
var b={};a=this.vjk;var c="";let h="";this.messageText&&(c=this.messageText.split(" {")[0],h=this.messageText.split("} ")[1]);b.startText=c;b.endText=h;b.cutText=this.ZHi;b.copyText=this.Xzi;b.pasteText=this.Hyk;b.cutShortcutText=this.c1(this.$Hi,this.yek);b.copyShortcutText=this.c1(this.eAi,this.xek);b.pasteShortcutText=this.c1(this.Nyk,this.Aek);b.imageSrc=Rn.a.RK("NoClipboardAccessDialogImage.svg");b.imageAltText=this.yEa;b.primaryButtonLabel=this.aIb;this.Qmg&&(ba.ULS.sendTraceTag(527986756,307,
50,"Learn more link is available"),b.learnMoreLink={["type"]:"AppLinkProps",["id"]:"learnMoreLink",["text"]:this.ZUa,["onExecute"]:()=>{this.XXj()}});b={["id"]:"CopyPasteNoClipboardAccessDialog",["bodyControls"]:b};c=new Nh.a(!1,!1,!0);c.xd=0;c.ig="CopyPasteNoClipboardAccessDialog";c.$i(a,Object(F.a)(this,this.yNe,"reactCopyPasteShortcutDialogHandler"),b)}get vjk(){return CommonUIStrings.l_NoClipboardAccessDialogTitle}get messageText(){return CommonUIStrings.l_NoClipboardAccessDialogMessage}get ZUa(){return CommonUIStrings.l_NoClipboardAccessDialogLearnMoreMessage}get yEa(){return CommonUIStrings.l_NoClipboardAccessDialogImageAltText}get aIb(){return CommonUIStrings.l_DialogOk}get ZHi(){return CommonUIStrings.l_CutString}get $Hi(){return CommonUIStrings.l_CutShortcut}get yek(){return CommonUIStrings.l_CutShortcut_Mac}get Xzi(){return CommonUIStrings.l_CopyString}get eAi(){return CommonUIStrings.l_CopyShortcut}get xek(){return CommonUIStrings.l_CopyShortcut_Mac}get Hyk(){return CommonUIStrings.l_PasteString}get Nyk(){return CommonUIStrings.l_PasteShortcut}get Aek(){return CommonUIStrings.l_PasteShortcut_Mac}XXj(){ba.ULS.sendTraceTag(527986757,
307,50,"Learn more link is clicked");qd.a.un(this.Qmg,"_blank",void 0,"learnMoreLink")}}Object(n.a)(lI,"ReactCopyPasteNoClipboardAccessDialog",Yn,[]);class mI extends Yn{constructor(a,b,c){super(a,b);a={};a.forwardElementText=this.QVf;a.cutText=this.c1(this.FLc,this.MBe);a.copyText=this.c1(this.pKc,this.LBe);a.pasteText=this.c1(this.iJa,this.NBe);c.ka("PasteTextOnlyShortcutDialogIsEnabled")&&(v.a.Uj||v.a.fg)&&(a.pasteTextOnly=this.c1(this.nxa,this.OBe));this.eUd?(ba.ULS.sendTraceTag(40726914,307,
50,null),a.extensionLink={["type"]:"AppLinkProps",["id"]:"extensionLink",["text"]:this.ODf,["onExecute"]:h=>{this.SRf(h)}},c=this.hQa.indexOf("{0}"),-1!==c&&(a.suggestionPrefixElement=this.hQa.substring(0,c),a.suggestionSuffixElement=this.hQa.substring(c+3,this.hQa.length))):ba.ULS.sendTraceTag(40726915,307,50,null);c={["id"]:Yn.id,["bodyControls"]:a};a=new Nh.a(!1,!1,!0);a.xd=0;a.ig=Yn.id;a.$i(this.titleText,Object(F.a)(this,this.yNe,"reactCopyPasteShortcutDialogHandler"),c)}}Object(n.a)(mI,"ReactCopyPasteShortcutDialog",
Yn,[]);class sq{constructor(){this.Vpa=!!u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.hb.uC}stb(a,b,c=!1,h=!1){ba.ULS.sendTraceTag(594882645,307,50,String.format("_isReactDialogEnabled={0}, useInstallDialog={1}",this.Vpa,c));h?new lI(a):this.Vpa?c?new kI(a,b):new mI(a,b,u.AFrameworkApplication.fa):new jI(a,b,u.AFrameworkApplication.fa)}static get instance(){return sq.Ka||(sq.Ka=new sq)}}sq.Ka=null;Object(n.a)(sq,"CopyPasteShortcutDialogFactory",null,[422]);class nI{constructor(a,b,c,h,m,
y,G){this.adf=this.eKd=!1;this.tWb=a;this.Lf=b;this.$ha=c;this.Od=h;this.nd=m;this.tf=y;this.yd=G}get DM(){return this.tWb}get bFa(){return this.adf}set bFa(a){this.adf=a;this.tf.KVc=a}Fca(a){this.DM.Fca(a);a||this.vLa(!0)}C6a(a){this.DM.C6a(a)}get lRi(){return this.DM.J5}get SQi(){return this.DM.ay}prepareForPaste(a){this.bFa=!0;this.DM.prepareForPaste(a,!1,this.SZe)}Rca(a,b){this.DM.Rca(a,!1,b)}reset(){this.bFa=!1}paste(){var a=this.Lf.Rd;a&&this.Od.xf(a.vI);var b=this.$ha.GK;if(!b.Mh||!b.editingView.Vl)return null;
a=b.editingView;let c=this.nd.om();this.bFa=!0;b.uza();b=null;try{a.ODk(),b=c=this.DM.Z7a(this.SZe,c)}catch(h){ba.ULS.shipAssertTag(6305672,307,!1),this.y6b(!0)}this.bFa=!1;return b}copy(){var a=this.Lf.Rd;a&&this.Od.xf(a.vI);a=this.$ha.GK;if(!a.Mh||1!==a.editingView.mode)return!1;this.bFa=!0;let b;try{this.DM.hOc(this.SZe),b=!0}catch(c){ba.ULS.shipAssertTag(6305673,307,v.a.fg),ba.ULS.sendTraceTag(17148117,307,50,"Known blocked access attempt handle in SystemClipboard: copy, {0}",v.a.Ly),b=!1}this.bFa=
!1;return b?!0:!1}vLa(a){if(this.eKd)return!0;var b=this.$ha.GK;if(!b.Mh||!b.editingView.Vl)return!1;const c=b.editingView;b=this.nd.om();this.bFa=!0;const h=new rc.a(b);let m=!1;try{m=this.DM.vLa(b,()=>{c.zsi()},()=>{c.oKa()})}catch(y){ba.ULS.shipAssertTag(6305674,307,!v.a.Dj)}h.restore();this.bFa=!1;m?this.eKd=!0:(ba.ULS.sendTraceTag(42517522,307,50,"Known blocked access attempt handle in SystemClipboard: paste, {0}",v.a.Ly),v.a.Dj||this.y6b(a));return m}y6b(){this.eKd=!1;if(u.AFrameworkApplication.wacCopyPasteShortcutDialogIsEnabled)sq.instance.stb(null,
null);else{const a=new Rf.StandardDialog;a.xd=0;a.cP(CommonUIStrings.l_ClipboardAccessDeniedTitle,CommonUIStrings.l_ClipboardAccessDenied,null)}}get SZe(){const a=this.nd.KDa();return a?a.Rl:null}}Object(n.a)(nI,"SystemClipboard",null,[1027]);class lC{constructor(a){this.Qlb=2147483647;this.gQb=null;this.Nm=0;this.pBg=!0;this.ahf=window.navigator.clipboard;this.bhf=window.navigator.permissions;this.nS=a}getData(a,b){ba.ULS.sendTraceTag(538240020,307,50,"GetData: Started");try{if(this.gQb){var c=this.T3i(this.gQb,
a);c?this.gQb[0].getType(c).then(h=>{"image/png"===c?this.nS.e0b([h],m=>{this.aGe(m,b,c)}):h.text().then(m=>{m="text/html"===c?this.QXi(m):m;ba.ULS.sendTraceTag(528859362,307,50,"GetData: Retrieved data with type: {0} and size: {1}",c,m.length);b(a,m)}).catch(()=>{this.jX(!1,"getDataFailed");b(a,null)})}).catch(()=>{this.jX(!1,"getDataFailed");b(a,null)}):(this.jX(!1,"unSupportedType"),b(a,null))}else this.jX(!1,"invalidClipboardItems"),b(a,null)}catch(h){this.jX(!1,"getDataFailed"),b(a,null)}}T3i(a,
b){let c=null;a&&0<a.length&&(a=a[0].types,b?c=Array.contains(a,b)?b:null:Array.contains(a,"text/html")?c="text/html":Array.contains(a,"image/png")?c="image/png":Array.contains(a,"text/plain")&&(c="text/plain"));return c}aGe(a,b,c){a&&this.nS.oqc&&(a=String.format('<img src="{0}">',a));ba.ULS.sendTraceTag(528818690,307,50,"OnImageConverted: Retrieved data with type: {0} and size: {1}",c,a.length);b("image/png",a)}QXi(a){return this.trim(a,"\n")}trim(a,b){if(!a)return null;let c=0;for(;c<a.length&&
a.charAt(c)===b;)c++;let h=a.length-1;for(;h>c&&a.charAt(h)===b;)h--;return a.substr(c,h-c+1)}v1e(a,b,c){this.gQb=b;a(c)}Gsd(a){try{this.gQb=null,this.ahf.read().then(b=>{let c;this.Nm&&(c=Date.now()-this.Nm,ba.ULS.sendTraceTag(526952409,307,50,"Time taken to read data: {0}",c));this.jX(!0,"none");this.v1e(a,b,!0)},()=>{this.jX(!1,"clipboardReadFailed");this.v1e(a,null,!1)}).catch(()=>{this.jX(!1,"clipboardReadFailed");this.v1e(a,null,!1)})}catch(b){this.jX(!1,"clipboardReadNotSupported"),a(!1)}}xCf(a,
b){this.pBg=a?!0:!1;if(this.ahf)if(this.bhf)try{this.bhf.query({name:"clipboard-read"}).then(c=>{c?(c=c.state,"granted"===c?(this.Nm=Date.now(),this.Gsd(b)):"prompt"===c&&a?this.Gsd(b):(this.jX(!1,"permissionDenied"),b(!1))):(this.jX(!1,"invalidPermissionStatus"),b(!1))},()=>{this.jX(!1,"permissionQueryFailed");a?this.Gsd(b):b(!1)}).catch(()=>{this.jX(!1,"permissionQueryFailed");b(!1)})}catch(c){this.jX(!1,"permissionQueryNotSupported"),b(!1)}else this.jX(!1,"navigatorPermissionNotSupported"),a&&
this.Gsd(b);else this.jX(!1,"navigatorClipboardNotSupported"),b(!1)}jX(a,b){const c={};c.AsyncAPISuccess=a.toString();c.IsPasteEvent=this.pBg;"none"!==b&&(c.AsyncAPIFailureReason=b);ba.ULS.sendTraceTag(522814493,307,50,JSON.stringify(c))}}Object(n.a)(lC,"AsyncClipboardAPI",null,[]);class mz{constructor(){this.pptObjectData=this.pptObjectMetaData=this.pptSlide=this.text=this.html=this.img=null;this.isImageAvailable=!1}}Object(n.a)(mz,"ExtensionClipboardData",null,[]);class oI{constructor(a,b,c,h){this.l2=
this.Iz=this.cff=this.wpa=null;this.Jvc=a.ka("ChromeClipboardAccessExtensionSuggestionIsEnabled");a.ka("ChromeClipboardAccessRichFormatContentIsEnabled");a.ka("ChromeSingleTextRunCopyImprovementIsEnabled");this.yRh=a.Ha("ChromeClipboardAccessExtensionLink");this.bNa=b;this.hk=c;this.qWh=a.Ha("ChromeClipboardAccessExtensionId");this.nS=h;this.Q1=new lC(this.nS);this.wRb=null;this.Z9e=a.ka("EnhancedTextCCPEnabled");this.pcf=m=>!!m.tagName&&"a"===m.tagName.toLowerCase()}Fca(a){a?this.Iz=!0:(this.l2=
this.Iz=null,chrome.runtime&&chrome.runtime.sendMessage?(this.wRb=this.bNa.DRc(),this.bNa.tya?this.mCf(!0,null):(this.Iz=!0,ba.ULS.sendTraceTag(19256732,307,50,pa.a.create().toString()))):this.Q1?this.Isb(!0,null):(this.oJe(),this.Iz=!1))}C6a(a){this.l2=this.Iz=null;chrome.runtime&&chrome.runtime.sendMessage?(this.wRb=this.bNa.DRc(),this.bNa.tya?this.mCf(!1,a):(this.Iz=!0,ba.ULS.sendTraceTag(19256732,307,50,pa.a.create().toString()),a(this.J5))):this.Q1?this.Isb(!1,a):(this.Iz=!1,a(this.J5))}get J5(){return this.Iz}get ay(){return this.l2}vLa(){return!0}hOc(a){ba.ULS.sendTraceTag(24402115,
307,50,"Execute chrome copy");qd.a.Y7a(a,"copy")||ba.ULS.sendTraceTag(24402116,307,10,String.format("In Chrome {0} execute copy failed",window.navigator.userAgent.split("/")[3].substring(0,2)))}Z7a(a,b){this.wpa&&(a=document.implementation.createHTMLDocument("doc"),a.body.innerHTML=this.wpa,b=a.body,this.wpa=null);return b}i6i(a){var b=this.hk.M3f(a.html);if(null!=b&&""!=b)return b;b=a.img;if(null!=b&&""!=b)return b;a=a.text;if(null!=a&&""!=a)return a}yZf(a,b){const c=pa.a.create();this.cff=c;this.bNa.tya?
ba.ULS.sendTraceTag(7377737,307,50,c.toString()):ba.ULS.sendTraceTag(19256735,307,50,c.toString());const h={};h.command=b;chrome.runtime&&chrome.runtime.sendMessage?chrome.runtime.sendMessage(this.wRb,h,m=>{c.equals(this.cff)?this.wpa=this.Z9e?this.i6i(m):m:ba.ULS.sendTraceTag(7385868,307,50,null);ba.ULS.sendTraceTag(7377738,307,50,c.toString());chrome.runtime.lastError&&(this.aOi(),this.bNa.tya?ba.ULS.sendTraceTag(7377739,307,10,chrome.runtime.lastError.message):ba.ULS.sendTraceTag(19256737,307,
10,chrome.runtime.lastError.message));a(m)}):(ba.ULS.sendTraceTag(509666774,307,10,"ChromeApi.RuntimeSendMessage not supported"),a(null))}prepareForPaste(a,b){const c=()=>{a(!1)},h=(m,y)=>{this.wpa=y;a(!0)};null!=this.ay&&this.ay?this.Q1.getData(b?"image/png":null,h):this.yZf(c,this.Z9e?"getClipboardData":"paste")}Rca(a,b,c){a=(h,m)=>{const y=new mz;"image/png"==h?y.img=m:y.html=m;c(y)};null!=this.ay&&this.ay?this.Q1.getData(b?"image/png":null,a):this.yZf(c,"getClipboardData")}oJe(){ba.ULS.sendTraceTag(8716423,
307,50,null);sq.instance.stb(Object(F.a)(this,this.wBk,"popupInstallDialogHandler"),this.Jvc?this.yRh+this.wRb:null)}wBk(a){1===a?ba.ULS.sendTraceTag(9013382,307,50,String.format("SuggestionEnabled={0}",this.Jvc)):0===a&&ba.ULS.sendTraceTag(9013383,307,50,String.format("SuggestionEnabled={0}",this.Jvc))}tBk(){ba.ULS.sendTraceTag(509666773,307,50,null);sq.instance.stb(Object(F.a)(this,this.uBk,"popupClipboardAccessDialogHandler"),null,!1,!0)}uBk(){ba.ULS.sendTraceTag(509666772,307,50,String.format("ClipboardAccessDialog OK Clicked",
this.Jvc))}aOi(){this.bNa.rQe();this.oJe()}noh(a,b){const c={command:"test",object:"ping"};chrome.runtime&&chrome.runtime.sendMessage?chrome.runtime.sendMessage(a,c,b):(ba.ULS.sendTraceTag(509666771,307,10,"ChromeApi.RuntimeSendMessage not supported"),b(null))}Isb(a,b){ba.ULS.sendTraceTag(509666770,307,50,"CheckAsyncClipboardApiSupport");this.Q1.xCf(a,c=>{this.l2=c;this.Iz=this.ay;a&&this.yfl();b&&b(this.J5)})}yfl(){null==this.ay||this.ay||this.tBk()}mCf(a,b){const c=pa.a.create();ba.ULS.sendTraceTag(7726105,
307,50,c.toString());this.noh(this.wRb,h=>{ba.ULS.sendTraceTag(7726106,307,50,c.toString());h&&"ping"===h?this.Iz=!0:(h?"ping"!==h&&ba.ULS.sendTraceTag(7726107,307,10,"ChromeApi has unexpected response: {0}. ErrorMsg: {1}",h,chrome.runtime.lastError?chrome.runtime.lastError.message:null):ba.ULS.sendTraceTag(39190680,307,50,"ChromeApi has null response. ErrorMsg: {0}",chrome.runtime.lastError?chrome.runtime.lastError.message:null),this.Q1?this.Isb(a,b):(a&&this.oJe(),this.Iz=!1));b&&b(this.J5)})}nog(a,
b){const c={};c.OfficeOnlineExtensionInstallationStatus=a;c.OfficeClipboardExtensionInstallationStatus=b;ba.ULS.sendTraceTag(51144839,307,50,JSON.stringify(c))}u0j(){if(chrome.runtime&&chrome.runtime.sendMessage){var a=!this.bNa.tya;this.noh(this.qWh,b=>{this.nog(a,!!b)})}else this.nog(!1,!1)}}Object(n.a)(oI,"ChromeSystemClipboardAccessManager",null,[1026]);class pI{constructor(a,b,c,h){this.l2=this.Iz=this.PDc=this.wpa=this.Q1=null;this.yd=a;this.$a=b;this.o6e=!this.$a.ka("UseSyncCopyCutCommandOnFirefoxIsEnabled")&&
this.$a.ka("BlockCopyCutOnFirefoxIsEnabled");this.nS=c;this.hk=h;this.IEd=b.Fc("ClipboardDataImageBlobLimitaton",10);v.a.eZe||(this.Q1=new lC(this.nS))}Fca(a){this.o6e&&a&&this.yd.fg?(sq.instance.stb(null,null),this.Iz=!1):(this.Iz=!0,this.l2=!1,this.Q1&&(this.l2=this.Iz=null,this.Isb(!0,null)))}C6a(a){this.o6e&&this.yd.fg&&(this.Iz=!1,a(this.J5));this.Iz=!0;this.l2=!1;this.Q1?(this.l2=this.Iz=null,this.Isb(!1,a)):a(this.J5)}Isb(a,b){ba.ULS.sendTraceTag(512356674,307,50,"CheckAsyncClipboardApiSupport");
this.Q1.xCf(a,c=>{this.l2=c;this.Iz=this.ay;a&&this.Wel();b&&b(this.J5)})}Wel(){null==this.ay||this.ay||this.sBk()}sBk(){sq.instance.stb(null,null)}get J5(){return this.Iz}get ay(){return this.l2}hOc(a){qd.a.Y7a(a,"copy")}Z7a(a,b){if(this.wpa&&null!=this.ay&&this.ay)return a=document.implementation.createHTMLDocument("doc"),a.body.innerHTML=this.wpa,b=a.body,this.wpa=null,b;const c=Date.now(),h=qd.a.Y7a(a,"paste");b&&""===b.innerHTML&&(this.P3i(a),b.innerHTML=this.PDc?this.PDc:"",this.PDc="");ba.ULS.sendTraceTag(512356673,
307,50,"ExecutePasteCommand: time taken: {0}, result: {1}",Date.now()-c,h);return b}P3i(a){const b=c=>{if(c){c=c.clipboardData;const h=this.hk.Q4b(c);this.PDc=h&&""!==h?h:this.hk.L7d(c)}};window.addEventListener("paste",b,!1);qd.a.Y7a(a,"paste");window.removeEventListener("paste",b,!1)}prepareForPaste(a,b){const c=(h,m)=>{this.wpa=m;a(!0)};null!=this.ay&&this.ay?this.Q1.getData(b?"image/png":null,c):a(!1)}Rca(a,b,c){if(c){var h=(m,y)=>{const G=new mz;"image/png"==m?G.img=y:G.html=y;c(G)};null!=this.ay&&
this.ay?this.Q1.getData(null,h):v.a.eZe&&this.Q3i(a,b,c)}else ba.ULS.sendTraceTag(512356672,307,10,"GetClipboardData: null callback")}Q3i(a,b,c){ba.ULS.sendTraceTag(512356643,307,50,"GetClipboardDataViaExecCommand: called");a=a.contentWindow.document;La.a.tu(a.body);try{const h=m=>{const y=new mz;m=m.clipboardData;if(b){var G=null;({J7b:G}=this.hk.zsd(m,this.IEd,this.nS.Uhc));G&&0<G.length&&(y.isImageAvailable=!0)}else G=this.hk.getData(m,"ppt/slides"),y.pptSlide=G,G&&""!==G||(m=(G=this.hk.Q4b(m))&&
""!==G?G:this.hk.L7d(m),y.html=m);c(y)};a.addEventListener("paste",h,!1);qd.a.Y7a(a,"paste");a.removeEventListener("paste",h,!1)}catch(h){ba.ULS.sendTraceTag(512356642,307,10,"GetClipboardDataViaExecCommand: failed to extract the data using exec command with exception : {0}",h)}}vLa(a,b,c){if(this.yd.uT&&!this.$a.ka("ElectronClipboardAccessFix"))return this.Iz=!1;b();c();a=this.Z7a(a.ownerDocument,a);b=a.innerHTML;a.innerHTML=Eh.a.create().toString();c();a=this.Z7a(a.ownerDocument,a);a=b===a.innerHTML;
this.Q1?a&&(this.Iz=!0):this.Iz=a;return a}}Object(n.a)(pI,"DefaultSystemClipboardAccessManager",null,[1026]);class qI{constructor(a,b,c,h){this.l2=this.Iz=this.HV=this.Pob=this.g7=this.CAa=this.Mvc=null;this.hk=b;this.nS=c;this.IEd=a.Fc("ClipboardDataImageBlobLimitaton",10);this.WSh=a.ka("EdgeSystemClipboardSelectionEnsureStrategyIsEnabled");this.JPh=h;this.m_h=a.ka("ShouldGrantEdgeSystemClipboardAccessForCopyCut")}Fca(a){this.m_h&&a&&(this.Iz=!0);this.l2=!1}C6a(a){a(!0)}get J5(){return this.Iz}get ay(){return this.l2}hOc(a){a&&
qd.a.Y7a(a,ra.a.copy)}Z7a(a,b){this.CAa&&(b=this.CAa,this.CAa=null);return b}Rca(a,b,c){c?c(null):ba.ULS.sendTraceTag(540553600,307,10,"GetClipboardData null callback")}prepareForPaste(a,b,c=null){if(a&&c){this.Mvc=a;this.Pob=c;$addHandler(this.Pob,ra.a.paste,Object(F.a)(this,this.F4g,"onPasteEvent"));this.HV=this.g7=null;this.WSh&&this.JPh.N2b();if(this.Hsd(this.Pob)){if(this.HV&&0<this.HV.length&&(!this.g7||this.hk.Wtd(this.g7))){this.nS.e0b(this.HV,Object(F.a)(this,this.aGe,"onImageConverted"));
this.CAa&&!this.CAa.hasChildNodes()&&ba.ULS.sendTraceTag(42592151,307,50,"pastedContentDom has no child nodes.");return}this.g7&&this.g7.innerHTML&&((this.CAa=this.wag(this.g7.innerHTML))&&!this.CAa.hasChildNodes()&&ba.ULS.sendTraceTag(42592152,307,50,"pastedContentDom has no child nodes."),La.a.tu(this.g7))}this.kUf()}else a&&a(!1)}vLa(a){return this.Iz=a=this.Hsd(a.ownerDocument)}F4g(a){try{a&&a.rawEvent&&((this.g7=a.rawEvent.target)&&this.g7.id&&-1<this.g7.id.indexOf("Paste")?(ba.ULS.sendTraceTag(40690080,
307,15,"The pasted target element of paste event: "+this.g7.id),this.g7=null):this.HV=this.R9i(a.rawEvent))}catch(b){ba.ULS.sendTraceTag(22073952,307,15,"Exception while processing context menu paste event: "+b.toString())}}aGe(a){a&&(this.nS.oqc&&(a=String.format('<img src="{0}">',a)),this.CAa=this.wag(a));this.kUf()}kUf(){this.Pob&&($removeHandler(this.Pob,ra.a.paste,Object(F.a)(this,this.F4g,"onPasteEvent")),this.Pob=null);this.Mvc&&(this.Mvc(!1),this.Mvc=null)}R9i(a){let b=null;(a=this.hk.D4d(a))&&
({J7b:b}=this.hk.zsd(a,this.IEd,this.nS.Uhc));return b}Hsd(a){return qd.a.Y7a(a,ra.a.paste)}wag(a){const b=document.implementation.createHTMLDocument("doc");b.body.innerHTML=a;return b.body}}Object(n.a)(qI,"EdgeSystemClipboardAccessManager",null,[1026]);class rI{constructor(a,b,c,h){this.$a=a;this.MNh=b;this.hk=c;this.yd=h}create(){var a=null;a=this.yd.uT&&this.$a.ka("ElectronClipboardAccessFix"),u.AFrameworkApplication.epd()&&this.yd.Uj&&window.chrome&&!a?(ba.ULS.sendTraceTag(7377743,307,50,"ChromeSystemClipboardAccessManager"),
a=new oI(this.$a,this.MNh,this.hk,vb.a.instance.resolve("Box4.IProcessImageStrategy")),this.$a.ka("LogChromeExtensionInstallationStatusIsEnabled")&&a.u0j()):this.$a.ka("EdgeContextMenuPasteFixIsEnabled")&&this.yd.to?(ba.ULS.sendTraceTag(22073953,307,50,"EdgeSystemClipboardAccessManager"),a=new qI(this.$a,vb.a.instance.resolve("Box4.IClipboardDataHelper"),vb.a.instance.resolve("Box4.IProcessImageStrategy"),vb.a.instance.resolve("Box4.Clipboard.IEdgeSystemClipboardSelectionEnsureStrategy"))):(ba.ULS.sendTraceTag(7377744,
307,50,"DefaultSystemClipboardAccessManager"),a=new pI(this.yd,this.$a,vb.a.instance.resolve("Box4.IProcessImageStrategy"),this.hk));return a}}Object(n.a)(rI,"SystemClipboardAccessManagerFactory",null,[1025]);class sI{cRf(a){return a}}Object(n.a)(sI,"DeleteTableSegmentStrategy",null,[312]);var LP=d(1197),MP=d(632);class tq{constructor(a,b){this.Zk=new E.DictionaryPropertySet;this.oCd=!1;this.Wha=this.Iha=this.e2a=null;this.FV=a;this.RQh=b}get F0a(){return this.Wha||(this.Wha=vb.a.instance.rb("Box4.ITextFormattingCommands"))}get kh(){return tq.Kf||
(tq.Kf=vb.a.instance.resolve("Box4.IFormattingEditor"))}ZZa(){this.oCd||(this.Zk.EOe(),this.e2a=null,this.dSk())}dAi(a){a=uc.a.ps(a);if(!a.cache.Zs){var b=a.Pz;if(b){var c=new E.DictionaryPropertySet;c.Ux(b);c.Ux(this.Zk);c.Sa(Ie.a.L2)&&(this.e2a=a.paragraph.Fh);this.Zk=c}}}Sa(a){return this.Zk.Sa(a)}Gae(){return 0<this.Zk.U1}get S$a(){return this.Zk}freeze(){this.oCd=!0}H_e(){this.oCd=!1}AI(a,b){return this.S$a.sa(a,b)}ir(a){this.Zk.setValue(kb.a.fontSize,this.kh.U_b(a));this.ER()}fontSize(){return this.Zk.sa(kb.a.fontSize,
lf.Font.pI)}xnd(a){this.Zk.setValue(kb.a.font,a);this.RQh.xnd(this.Zk,a);this.FV&&this.FV.enabled&&(ef.c(40506690,306,50,"InsertionPointFomatting: Set font slot values"),this.FV.PIl(this.Zk,a));this.ER()}MKa(a){this.Zk.setValue(jb.a.hV,a);this.FV&&this.FV.enabled&&(ef.c(40506691,306,50,"InsertionPointFomatting: Set font theme slot values"),this.FV.TIl(this.Zk,a));this.ER()}Ls(a){a=MP.a.instance.vUd(me.a.instance.Pa.mb.Ua.node,a);this.Zk.setValue(kb.a.fontColor,a);this.ER()}lW(){this.Zk.setValue(kb.a.fontColor,
hb.a.auto);this.ER()}fontColor(){return this.Zk.sa(kb.a.fontColor,hb.a.nil)}noa(a){this.Zk.setValue(kb.a.highlight,parseInt(a,16));this.ER()}h_b(){this.Zk.setValue(kb.a.highlight,hb.a.auto);this.ER()}isBold(){return this.Zk.sa(kb.a.bold,!1)}GH(a){this.Zk.setValue(kb.a.bold,a);this.ER()}isItalic(){return this.Zk.sa(kb.a.italic,!1)}setItalic(a){this.Zk.setValue(kb.a.italic,a);this.ER()}dE(){return this.Zk.sa(kb.a.underline,!1)}JY(a){this.Zk.setValue(kb.a.underline,a);this.Zk.setValue(kb.a.Lw,a?lf.Font.Ysd:
lf.Font.pV);this.ER()}Lw(){return this.Zk.sa(kb.a.Lw,lf.Font.pV)}uoa(a){a<lf.Font.Ysd||a>lf.Font.pV||(this.Zk.setValue(kb.a.underline,a!==lf.Font.pV),this.Zk.setValue(kb.a.Lw,a),this.ER())}isSuperscript(){return this.Zk.sa(kb.a.superscript,!1)}IY(a){this.Zk.setValue(kb.a.superscript,a);a&&this.isSuperscript()&&this.Zk.setValue(kb.a.subscript,!1);this.ER()}LF(){return this.Zk.sa(kb.a.subscript,!1)}R5(a){this.Zk.setValue(kb.a.subscript,a);a&&this.LF()&&this.Zk.setValue(kb.a.superscript,!1);this.ER()}KF(){return this.Zk.sa(kb.a.strikethrough,
!1)}GY(a){this.Zk.setValue(kb.a.strikethrough,a);this.ER()}w_(){return this.Zk.sa(Ie.a.Vs,!1)}jjb(a){this.Zk.setValue(Ie.a.Vs,a);this.ER()}tYf(){return this.Zk.sa(Ie.a.L2,null)}Pfa(a,b){this.Zk.EOe();this.Zk.setValue(Ie.a.L2,a.id);this.e2a=b.Fh;this.ER()}VU(a){let b=kb.a.$s;if(J.a.instance.ga(13)){const c=LP.a.Y$b(a);switch(c){case 1:b=jb.a.Vzb;break;case 2:b=jb.a.Wzb}this.Zk.setValue(jb.a.languageHint,c)}this.Zk.setValue(b,a);this.ER()}language(){let a=kb.a.$s;if(J.a.instance.ga(13))switch(this.Zk.sa(jb.a.languageHint,
0)){case 1:a=jb.a.Vzb;break;case 2:a=jb.a.Wzb}return this.Zk.sa(a,0)}E7k(a){this.Zk.setValue(tq.ODe,a);this.ER()}wUa(){return this.Zk.sa(tq.ODe,!1)}QOj(){return this.Zk.Sa(tq.ODe)}ENj(){return J.a.instance.ga(13)?this.Zk.Sa(kb.a.$s)||this.Zk.Sa(jb.a.Vzb)||this.Zk.Sa(jb.a.Wzb):this.Zk.Sa(kb.a.$s)}ER(){if(v.a.UMb){var a=me.a.instance.Pa.mb.Ua,b=a.node;if(b===this.Iha)this.Iha.wv(16,!0);else{this.Iha=b;b=this.Iha.y0a();try{this.Iha.Cub(a.Qa).Q3=!0}finally{b&&b.dispose()}}}}dSk(){if(v.a.UMb&&this.Iha){var a=
0,b=this.Iha.y0a();try{for(let c=this.Iha.Ra.length-1;0<=c;c--){const h=this.Iha.Ra.ga(c);h.Q3&&(h.Q3=!1,a++,h.isEmpty&&this.Iha.Ra.removeAt(c))}}finally{b&&b.dispose()}this.Iha=null}}Myi(a){if(a.Qa!==a.Nb)return!1;a=a.node.Ra.aT(a.Qa);return!!a&&a.Q3}Cdi(a){if(this.F0a){this.freeze();var b=new t.GraphTransaction(7);b.kd(a.node);this.F0a.$Kb(a);this.H_e();this.ZZa();b.dispose()}}x5b(a){const b=Ob.ParagraphReader.text(a.node);return a.Qa&&a.Qa!==b.length&&!ta.a.Xy(b.charCodeAt(a.Qa))&&rr.a.instance.NRc(b,
a.Qa-1)!==a.Qa&&Bb.SelectionEditor.wzb(a)?(a=Bb.SelectionEditor.DRa(a,!1))?1<a.length||Bb.SelectionEditor.ek(a.Ua)?a:null:null:null}static get ODe(){return J.a.instance.ga(20)?jb.a.noProof:xc.a.Jwa}}tq.Kf=null;Object(n.a)(tq,"InsertionPointFormatting",null,[300]);class tI{constructor(a){this.Ca=a}get zn(){return this.Ca}Gki(a){return 32===this.zn.La(D.a.jP,2,a)}numbering(a){return 32===this.zn.La(D.a.NR,2,a)}}Object(n.a)(tI,"ListCommands",null,[1038]);class mC{constructor(a){this.hf=a}B6a(a){a=Object(ua.a)(bC.a,
a);return!!a&&!!a.view&&a.view.Mh}Ibh(){return!0}RKe(){return!0}Jbh(){}Vwh(a){if(a.$q)return!0;a=a.role;return 1===a||2===a||3===a||4===a||5===a}Kej(a){if(!a||!this.hf)return a;const b=new fn.a;b.set(a);if(this.hf.xt(b)){for(;!b.$q;)b.zc();return b.currentNode}return a}}Object(n.a)(mC,"SimpleProofingWholeDocumentCallBacks",null,[1161]);class uI{constructor(a){this.value=a}}Object(n.a)(uI,"RefBool",null,[]);class nz{constructor(){this.bOc=this.SFb=null;this.AEh=new uI(!1)}}Object(n.a)(nz,"FindNextErrorOperationParam",
null,[]);class vI extends mC{constructor(a,b){super(b);this.Gm=a}Ibh(a,b){return!this.Hme(a.node,a.Qa,b)}RKe(a,b){return!this.Hme(a,0,b)}Jbh(a,b){this.Hme(a.node,0,b);Object(ua.a)(nz,b)}Hme(a,b,c){c=Object(ua.a)(nz,c);if(Ob.ParagraphReader.Yd(a)&&!a.QW)if(uc.a.ps(md.a.Kj(a,b)).cache.wUa)c.AEh.value=!0;else{const h=u.AFrameworkApplication.fa.ka("SkipIgnoredProofingErrorsFromRibbon"),m=this.Gm.BF(a);for(let y=0;y<m.length;y++){const G=m[y],U=h&&G.Gh.Die();if(G.begin>=b&&!U)return c.SFb=G,c.bOc=a,!0}}return!1}}
Object(n.a)(vI,"FindNextErrorCallbackSteps",mC,[]);class wI extends Is.a{constructor(a,b,c,h,m,y,G,U,ja,va,Ta){super();this.Wob=this.Ji=this.Sza=null;this.init(a);this.Nl(Ta);this.AEa(U,b,h,m,y);this.qV=y;this.zt=c;this.Tc=ja;this.hf=va;this.lqa=G;this.dI=0}run(){this.B6a();0===this.dI&&this.YUe();1===this.dI&&this.aLe();2===this.dI&&this.XZe();3===this.dI&&this.s2d()}B6a(){this.Tc.Pa&&this.Tc.Pa.mb?1===this.behavior&&(this.lqa.B6a(this.zt)?this.Ep=32:this.Ep=2,this.dI=3):(ba.ULS.sendTraceTag(20321351,
324,15,"No selection for ignore all"),this.Ep=2,this.dI=3)}YUe(){this.Wji();this.tji();this.dI=1}aLe(){this.Oy||new Sh.a(this,Object(F.a)(this,this.cFk,"processCurrentNodeAtBegin"),this.qV);do if(this.Oy.run(),this.Oy.inProgress&&!this.Oi)return;while(this.Oy.inProgress);this.SIc();this.dI=2}XZe(){this.Ep=32;this.dI=3}s2d(){this.EY()}cFk(a,b){b=this.lqa.Ibh(this.Sza,b);a.$g(Object(F.a)(this,this.j_i,"fromHereToEnd"));return b}j_i(a,b){if(this.Ji.moveNext())return a=this.Ji.currentNode,12!==a.type||
a===this.Sza.node?!0:this.lqa.RKe(a,b);this.lki();a.$g(Object(F.a)(this,this.t_i,"fromStartToHere"));return!0}t_i(a,b){if(this.Ji.moveNext()){const c=this.Ji.currentNode;return 12!==c.type?!0:c===this.Sza.node?(a.$g(Object(F.a)(this,this.dFk,"processCurrentNodeAtEnd")),!0):this.lqa.RKe(c,b)}return!1}dFk(a,b){this.lqa.Jbh(this.Sza,b);return!1}Wji(){let a=this.Tc.Pa.mb;if(a=this.hf.Ql(a,!0,!1))this.Sza=a.Ua;this.Sza&&this.Sza.node&&(this.Wob=this.lqa.Kej(this.Sza.node))}tji(){if(!this.Wob)throw Error.argumentNull("_proofingWholeDocumentRootNode");
const a=new fn.a;a.set(this.Sza.node);a.rc(this.Wob.type);this.Ji=ox.a.T2(a,this.Wob);this.Ji.$l(Object(F.a)(this.lqa,this.lqa.Vwh,"spellErrorFilter"),null)}lki(){if(!this.Wob)throw Error.argumentNull("_proofingWholeDocumentRootNode");const a=new fn.a;a.set(this.Wob);this.Ji=ox.a.jv(a);this.Ji.$l(Object(F.a)(this.lqa,this.lqa.Vwh,"spellErrorFilter"),null)}}Object(n.a)(wI,"ProofingWholeDocumentOperation",Is.a,[]);class nC{constructor(a,b,c,h,m,y,G,U,ja,va,Ta,fb,Db,gc,hc){this.Ca=b;this.Gm=a;this.tUh=
c;this.Zg=h;this.yk=m;this.Tc=y;this.Hm=G;this.hf=U;this.w4a=ja;this.wD=va;this.ld=Ta;this.gzc=Db.Kje;this.Fjf=gc;this.oP=hc;this.Nuc=new Sc.a;this.Nuc.$(1,D.a.Wwh);this.Nuc.$(2,D.a.l7f);this.Nuc.$(3,D.a.iyh);this.dCc=new Sc.a;this.dCc.$(1,D.a.Xwh);this.dCc.$(2,D.a.m7f);this.dCc.$(3,D.a.jyh)}vb(){const a=this.Ca,b=Object(F.a)(this,this.nAi,"correctError"),c=Object(F.a)(this,this.$ti,"collapseIp");a.ra(D.a.evk,xb.a.view,Object(F.a)(this,this.fvk,"openLanguageDialogView"),1028);a.ya(D.a.LCa,xb.a.Of,
Object(F.a)(this,this.LCa,"deleteRepeatedWord"));a.ya(D.a.ika,xb.a.Of,Object(F.a)(this,this.ika,"ignoreSpellingError"));a.ya(D.a.Vya,xb.a.Of,b);a.ya(D.a.Wya,xb.a.Of,b);a.ya(D.a.Xya,xb.a.Of,b);a.ya(D.a.qLa,xb.a.Of,b);a.ya(D.a.rLa,xb.a.Of,b);a.ya(D.a.LCa,xb.a.view,c);a.ya(D.a.ika,xb.a.view,c);a.ya(D.a.Vya,xb.a.view,c);a.ya(D.a.Wya,xb.a.view,c);a.ya(D.a.Xya,xb.a.view,c);a.ya(D.a.qLa,xb.a.view,c);a.ya(D.a.rLa,xb.a.view,c);a.he(D.a.LCa,1028);a.he(D.a.ika,1028);a.he(D.a.Vya,1028);a.he(D.a.Wya,1028);a.he(D.a.Xya,
1028);a.he(D.a.qLa,1028);a.he(D.a.rLa,1028);a.ya(D.a.erd,he.a.frame,ed.ActionManager.Jg);this.gzc&&a.ra(D.a.lJe,xb.a.view,Object(F.a)(this,this.lJe,"populateProofingSecondaryMenu"),1124);u.AFrameworkApplication.fa.ka("WordEditorIdeasIsEnabled")&&u.AFrameworkApplication.fa.ka("WordEditorIdeasCardsIsEnabled")||a.ra(D.a.Ccd,xb.a.view,Object(F.a)(this,this.JWi,"findNextProofingError"),1028);this.PPk([D.a.Tjl,D.a.Wwh,D.a.Xwh,D.a.ioj,D.a.l7f,D.a.m7f,D.a.bml,D.a.iyh,D.a.jyh])}PPk(a){for(let b=0;b<a.length;b++)this.Ca.ra(a[b],
xb.a.view,ed.ActionManager.ov,1028)}$ti(a,b,c,h,m){b=this.Tc.Pa.mb;if(!b)return this.ld.Wb(Ed.a.wh,{["Reason"]:Cd.a.noSelection}),2;b=this.hf.Ql(b,!0,!1);return this.Ca.mi(b.Ua,a,c,!1,h,m)}fvk(a,b,c){if(1===c)return this.Ca.processAction(D.a.VU,1);this.tUh().Fqc();return 32}p1e(a){return a?a.Gh?!1:(ba.ULS.sendTraceTag(7660829,324,10,"Ignore Spelling Error: No suggestions on flagged word"),this.ld.Wb(Ed.a.l8a,{["Reason"]:"ErrorRangeMissingErrorDetails"}),Te.a.mark(4671),!0):(ba.ULS.sendTraceTag(7660828,
324,10,"Ignore Spelling Error: No flagged word"),this.ld.Wb(Ed.a.l8a,{["Reason"]:"RequestedErrorRangeNotFound"}),Te.a.mark(4671),!0)}LCa(a,b,c){if(1===c)return 32;Te.a.mark(4670);c=this.Gm.vSa(b);if(this.p1e(c))return 8;b=b.node;const h=this.yk.le(15);let m=c.begin;" "===Ob.ParagraphReader.text(b).charAt(m-1)&&m--;h.kd(b);const y=this.Zg.replaceTextRange(md.a.createTextRange(b,0<c.begin?c.begin-1:0,c.end),"",!0,!1);this.Tc.setSelection(yd.SelectionFactory.Qg(b,y+m));h.dispose();c.Gh.JLa(a);Te.a.mark(4671);
return 32}Y1j(a){let b;({value:b}=this.dCc.Uf(a.Gh.proofingType,0)).returnValue&&this.Ca.processAction(b,2)}ika(a,b,c){if(1===c)return 32;ba.ULS.sendTraceTag(7660830,324,50,"Ignore spelling error triggerred");Te.a.mark(4670);c=this.Gm.vSa(b);if(this.p1e(c))return 8;b=b.node;const h=this.yk.le(15);h.kd(b);this.Gm.YJa(b,[c],!0);b.setValue(kb.a.NFf,!0);h.dispose();c.Gh.JLa(a,1);Te.a.mark(4671);ba.ULS.sendTraceTag(7692317,324,50,"Ignore spelling error action succeeded");this.Y1j(c);return 32}t5i(a){switch(a){case D.a.Vya:return 0;
case D.a.Wya:return 1;case D.a.Xya:return 2;case D.a.qLa:return 3;case D.a.rLa:return 4;default:return-1}}s_j(a){let b;({value:b}=this.Nuc.Uf(a.Gh.proofingType,0)).returnValue&&this.Ca.processAction(b,2)}nAi(a,b,c){var h=!0;this.oP.ga(14)&&(h=!this.wD.hua(b));this.Hm&&this.Hm.instance&&this.Hm.instance.UW(b)&&(h=!1);if(1===c||!h)return h?32:8;this.Ca.processAction(D.a.erd,2);Te.a.mark(4670);h=this.t5i(a);if(0>h)return 8;c=this.Gm.vSa(b);if(this.p1e(c))return 8;b=b.node;var m=c.Gh.suggestions;if(!m)return this.ld.Wb(Ed.a.l8a,
{["Reason"]:"NoSuggestionsFound"}),Te.a.mark(4671),8;h=h<m.length?m[h]:null;if(!h)return this.ld.Wb(Ed.a.l8a,{["Reason"]:"RequestedSuggestionIsNull"}),Te.a.mark(4671),8;this.oP.ga(50)&&Fc.App.Ih.lw&&Fc.App.Ih.WY.Tqa(b);h=h.replace("  "," \u00a0");m=this.yk.le(15);m.kd(b);const y=this.Zg.replaceTextRange(md.a.createTextRange(b,c.begin,c.end),h,!0,!1,D.a.erd);this.Tc.setSelection(yd.SelectionFactory.Qg(b,c.begin+h.length+y));m.dispose();c.Gh.JLa(a);Te.a.mark(4671);this.s_j(c);return 32}x1k(a,b,c,h){a.aya();
(a=c.sc(a.Ma))?(h=W.a.Kt(a,u.AFrameworkApplication.isRtl?h.begin:h.end),this.w4a.saa(new Sys.UI.Point(h.x,h.y+h.height),b)):ba.ULS.sendTraceTag(5902807,324,50,"Failed to pop up proofing context menu")}JWi(a,b,c,h,m){if(!b.view.Mh)return 2;const y=b.view;if(!this.Tc.Pa.mb)return this.ld.Wb(Ed.a.wh,{["Reason"]:Cd.a.noSelection}),2;if(1===c)return 32;const G=new nz,U=new vI(this.Gm,this.hf);b=new wI(null,a,b,c,h,G,U,this.Ca,this.Tc,this.hf,null);b.Oi=!0;b.run();if(b.isCompleted&&G.SFb){if(b=yd.SelectionFactory.Qg(G.bOc,
G.SFb.begin),b=yd.SelectionFactory.wN(b,md.a.Kj(G.bOc,G.SFb.end)),!this.Fjf.instance||!this.Fjf.instance.lIl(G.SFb,b,y)){this.Tc.setSelection(b);let ja=0;m&&(ja=m.vv);y.Vod=!1;mh.a.instance.Eb(new He.a(1,1,1,()=>{this.x1k(y,ja,G.bOc,G.SFb)}))}}else{const ja=new Rf.StandardDialog;ja.xd=0;Fc.App.MR.Dke?ja.Yjb(CommonUIStrings.l_DefaultDialogTitle,G.AEh.value?Box4Intl.Box4Strings.l_ProofingCompleteNoErrorsWithIgnoredRanges:Box4Intl.Box4Strings.l_ProofingCompleteNoErrors,null):(ja.Yjb(CommonUIStrings.l_DefaultDialogTitle,
Box4Intl.Box4Strings.l_ProofingInProgress,null),Fc.App.MR.e6h(()=>{ja.HQ&&(ja.hide(),this.Ca.processAction(a,2))}))}return 32}lJe(){return 32}}Object(n.a)(nC,"ProofingActor",null,[]);var xI=d(713),NP=d(1083);class gh{static Anj(){gh.CM||(gh.CM=Array(gh.fml),gh.CM[0]=kb.a.fontColor,gh.CM[1]=Ie.a.FR,gh.CM[2]=kb.a.$s,gh.CM[3]=kb.a.underline,gh.CM[4]=kb.a.Lw,gh.CM[5]=Ie.a.Vs,gh.CM[6]=kb.a.font,gh.CM[7]=kb.a.fontSize,gh.CM[8]=kb.a.superscript,gh.CM[9]=kb.a.subscript,gh.CM[10]=kb.a.an,gh.CM[11]=jb.a.noProof,
gh.CM[12]=xc.a.Jwa,gh.CM[13]=Ie.a.capitalization,gh.CM[14]=kb.a.bold,gh.CM[15]=kb.a.italic,gh.CM[16]=kb.a.underline);return gh.CM}static ynj(){gh.YC||(gh.YC=Array(gh.Owk),gh.YC[0]=jb.a.$n,gh.YC[1]=jb.a.cJa,gh.YC[2]=jb.a.Zl,gh.YC[3]=jb.a.hxa,gh.YC[4]=jb.a.pY,gh.YC[5]=jb.a.Jgb,gh.YC[6]=jb.a.WGb,gh.YC[7]=jb.a.Igb,gh.YC[8]=Ie.a.fHb,gh.YC[9]=Ie.a.eHb,gh.YC[10]=jb.a.bHb,gh.YC[11]=jb.a.ZGb,gh.YC[12]=jb.a.bVa,gh.YC[13]=jb.a.ox,gh.YC[14]=jb.a.Mgb,gh.YC[15]=jb.a.Lgb,gh.YC[16]=jb.a.skc,gh.YC[17]=jb.a.rkc,gh.YC[18]=
kb.a.Il,gh.YC[19]=kb.a.XI,gh.YC[20]=Ie.a.tjd,gh.YC[21]=kb.a.oY);return gh.YC}}gh.fml=17;gh.Owk=22;gh.CM=null;gh.YC=null;Object(n.a)(gh,"StyleConstants",null,[]);class $q{static get tGk(){return $q.qP||($q.qP=new NP.a)}static gke(a,b){if(!a||!a.node||!b)return!1;const c=uc.a.ps(a);if($q.Egg(c?c.Pz:null,b,gh.Anj()))return ba.ULS.sendTraceTag(51218398,324,50,"Difference in formatting attributes b/w text selection and style"),!0;a=a.node.s8();return $q.Egg(a,b,gh.ynj())?(ba.ULS.sendTraceTag(51218399,
324,50,"Difference in paragraph attributes b/w text selection and style"),!0):!1}static Egg(a,b,c){let h=!1;if(a)for(const m of c)h=(a.Sa(m)?b.Sa(m)?!$q.tGk.compare(a,b,m):!0:!1)||h;return h}}$q.qP=null;Object(n.a)($q,"StyleUtils",null,[]);class oC{constructor(a,b,c,h,m,y,G,U,ja,va){this.j3a=this.MMb=null;this.Zg=a;this.BK=b;this.CK=c;this.Kf=h;this.Tga=m;this.Bt=y;this.wD=G;this.ld=U;this.TOa=ja;this.u2h=va}get characterPropertiesEditor(){return this.Zg}get gP(){return this.BK}get c6(){return this.CK}get jm(){return this.Tga}get insertionPointFormatting(){return this.Bt}get kh(){return this.Kf}get aj(){return this.wD}get Wc(){return this.ld}get t_e(){return this.TOa}get iuc(){return this.u2h}get iUa(){null==
this.j3a&&(u.AFrameworkApplication.fk("Microsoft.Office.Web.SessionSettings.IWacWordHighlightStyleWhenDifferentFromSelectionSettings"),this.j3a=u.AFrameworkApplication.fa?u.AFrameworkApplication.fa.ka("HighlightStyleWhenDifferentFromSelectionIsEnabled"):!1);return this.j3a}vb(){const a=u.AFrameworkApplication.Ta,b=Fc.App.zLa.HKc(12);J.a.instance.ga(61)&&(a.ya(D.a.V5a,xb.a.textRange,Object(F.a)(this,this.Zdi,"applyStyleToTextRange")),a.ya(D.a.Lmc,xb.a.textRange,Object(F.a)(this,this.LHk,"queryStyleTextRange")),
a.ya(D.a.V5a,xb.a.Of,Object(F.a)(this,this.Xdi,"applyStyleToIp")),a.ya(D.a.Lmc,xb.a.Of,Object(F.a)(this,this.JHk,"queryStyleIp")));a.ya(D.a.V5a,xb.a.paragraph,Object(F.a)(this,this.Ydi,"applyStyleToParagraph"));a.ya(D.a.V5a,xb.a.view,Object(F.a)(this,this.$di,"applyStyleView"));a.he(D.a.V5a,1036);a.ya(D.a.Lmc,xb.a.view,Object(F.a)(this,this.MHk,"queryStyleView"));a.ya(D.a.Lmc,xb.a.paragraph,Object(F.a)(this,this.KHk,"queryStyleParagraph"));a.he(D.a.Lmc,99|(J.a.instance.ga(7)?0:4));a.ya(D.a.glc,xb.a.view,
b);a.ya(D.a.glc,xb.a.paragraph,Object(F.a)(this,this.glc,"populateMenuMoreStyles"));a.he(D.a.glc,1127);a.ra(D.a.KPd,xb.a.view,Object(F.a)(this,this.pra,"applyStyleShortcut"),4);a.ra(D.a.LPd,xb.a.view,Object(F.a)(this,this.pra,"applyStyleShortcut"),4);a.ra(D.a.MPd,xb.a.view,Object(F.a)(this,this.pra,"applyStyleShortcut"),4);a.ra(D.a.NPd,xb.a.view,Object(F.a)(this,this.pra,"applyStyleShortcut"),4);a.ra(D.a.OPd,xb.a.view,Object(F.a)(this,this.pra,"applyStyleShortcut"),4);a.ra(D.a.PPd,xb.a.view,Object(F.a)(this,
this.pra,"applyStyleShortcut"),4);a.ra(D.a.QPd,xb.a.view,Object(F.a)(this,this.pra,"applyStyleShortcut"),4);a.ra(D.a.Cvf,xb.a.view,Object(F.a)(this,this.pra,"applyStyleShortcut"),4);a.ra(D.a.Dvf,xb.a.view,Object(F.a)(this,this.pra,"applyStyleShortcut"),4);a.ra(D.a.Evf,xb.a.view,Object(F.a)(this,this.pra,"applyStyleShortcut"),4);this.MMb=Array(10);this.c6.sUe(this.MMb)}sjj(a){switch(a){case D.a.KPd:return 0;case D.a.LPd:return 1;case D.a.MPd:return 2;case D.a.NPd:return 3;case D.a.OPd:return 4;case D.a.PPd:return 5;
case D.a.QPd:return 6;case D.a.Cvf:return 7;case D.a.Dvf:return 8;case D.a.Evf:return 9;default:return-1}}pra(a,b,c,h){a=this.sjj(a);return 0>a||a>this.MMb.length?2:(a=this.MMb[a])?u.AFrameworkApplication.Ta.mi(b,D.a.V5a,c,!0,h,a):2}glc(a,b,c,h,m){a=!0;b.contextId!==xb.a.paragraph&&b.contextId!==xb.a.textRange&&b.contextId!==xb.a.Of&&(a=!1);if(1===c||!a)return a?32:8;if(2===c&&!m)return 8;b=this.c6.iL(b.node);c=J.a.instance.ga(61);u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.hb.Np&&(m.MenuItems=
xI.StylePreviewGenerator.I1f(b,c));m.PopulationXML=xI.StylePreviewGenerator.y0i(b,c);return 32}KHk(a,b,c,h,m){a=!0;b.contextId!==xb.a.paragraph&&(a=!1);if(1===c&&!a)return 8;c=b.node;a=this.c6.XD(c);if(!a||!m)return ba.ULS.sendTraceTag(51218391,324,10,"actionData : {}, graphNode : {}, paragraphStyle : {}",m,c,a),8;m.RYe.Ux(a);this.iUa&&(m.zie=$q.gke(b,a));return 32}Ydi(a,b,c,h,m){if(b.contextId!==xb.a.paragraph)return 8;if(J.a.instance.ga(14)&&this.aj.mFa(b))return this.Wc.Wb(Ed.a.To,{["Reason"]:Cd.a.LD}),
8;if(1===c)return 32;a=b.node;if(!m)return 8;b=this.d9d(m,a);if(!b)return this.Wc.Wb(Ed.a.C1,{["Reason"]:Cd.a.g3b}),8;if(2!==this.c6.tta(b))return 2;c=new t.GraphTransaction(15);c.kd(a);this.insertionPointFormatting.ZZa();this.gP.paa(b,a,!1);c.dispose();m=ta.a.iN(m);h.eQ=m>>>16^m&65535;return 32}LHk(a,b,c,h,m){a=!0;b.contextId!==xb.a.textRange&&(a=!1);if(1===c&&!a)return 2;c=b.node;a=uc.a.ps(b);a=uc.a.Kvb(a);if(this.iUa){if(!m||!c)return ba.ULS.sendTraceTag(51218393,324,10,"actionData : {}, graphNode : {}",
m,c),8;a=a||this.c6.XD(c);if(!a)return ba.ULS.sendTraceTag(51218394,324,10,"No paragraph style for Text range context is found"),2;m.zie=$q.gke(b,a)}else{if(!a)return 2;if(!m)return 8}m.RYe.Ux(a);return 32}Zdi(a,b,c,h,m){if(b.contextId!==xb.a.textRange||!J.a.instance.ga(61))return 8;if(this.aj.mFa(b))return this.Wc.Wb(Ed.a.To,{["Reason"]:Cd.a.LD}),8;if(1===c)return 32;a=b.node;if(!m)return 8;const y=this.d9d(m,b.node);if(!y)return this.Wc.Wb(Ed.a.C1,{["Reason"]:Cd.a.g3b}),8;if(1!==this.c6.tta(y))return 2;
c=this.c6.iL(a);if(!c)return this.Wc.Wb(Ed.a.C1,{["Reason"]:Cd.a.JSf}),8;if(!c.WG(this.c6.tQ(y)))return this.Wc.Wb(Ed.a.C1,{["Reason"]:Cd.a.g3b}),8;const G=new t.GraphTransaction(7);try{G.kd(a),this.gP.Ftc(a,c),this.t_e.JGc(b,U=>{this.kh.$Ba(U);this.kh.Pfa(U,y)})}finally{G&&G.dispose()}b=ta.a.iN(m);h.eQ=b>>>16^b&65535;return 32}JHk(a,b,c,h,m){a=!0;b.contextId!==xb.a.Of&&(a=!1);if(1===c&&!a)return 2;c=this.gP.a9d(b);a=b.node;if(this.iUa){if(!m||!a)return ba.ULS.sendTraceTag(51218396,324,10,"actionData : {}, graphNode : {}",
m,a),8;c=c||this.c6.XD(a);if(!c)return ba.ULS.sendTraceTag(51218397,324,10,"No paragraph style for I/P context is found"),2;m.zie=$q.gke(b,c)}else{if(!c)return 2;if(!m)return 8}m.RYe.Ux(c);return 32}Xdi(a,b,c,h,m){if(b.contextId!==xb.a.Of||!J.a.instance.ga(61))return 8;if(this.aj.mFa(b))return this.Wc.Wb(Ed.a.To,{["Reason"]:Cd.a.LD}),8;if(1===c)return 32;c=b.node;if(!m)return 8;const y=this.d9d(m,b.node);if(!y)return this.Wc.Wb(Ed.a.C1,{["Reason"]:Cd.a.g3b}),8;const G=this.c6.tta(y);if(1!==G&&2!==
G)return 2;(b=this.insertionPointFormatting.x5b(b))?(c=me.a.AQa(b),a=u.AFrameworkApplication.Ta.mi(c,a,2,!1,h,m)):(a=new t.GraphTransaction(7),a.kd(c),this.gP.tUe(y,c),a.dispose(),a=32);m=ta.a.iN(m);h.eQ=m>>>16^m&65535;return a}MHk(a,b,c,h,m){if(J.a.instance.ga(61)){const y=this.iuc.w5(a,b,c,h,m,null,0);if(2!==y)return y}return this.iuc.w5(a,b,c,h,m,null,12)}$di(a,b,c,h,m){const y={};y[this.iuc.epa]=6168;y[this.iuc.dpa]=6169;let G=12;if(J.a.instance.ga(61)){if(!b.view.Mh)return 2;var U=b.view.Lb,
ja=U?U.Qj:null;if(!ja)return this.Wc.Wb(Ed.a.wh,{["Reason"]:Cd.a.noSelection}),8;if(J.a.instance.ga(11)&&this.jm.Sra(aa.ImageReader.pyb,ja))return this.Wc.Wb(Ed.a.wh,{["Reason"]:Cd.a.X_b}),8;if(J.a.instance.ga(14)&&this.aj.RXc(ja))return this.Wc.Wb(Ed.a.wh,{["Reason"]:Cd.a.LD}),8;ja=this.c6.Twb();if(m&&ja){var va=ja.WG(m);va&&(ja=this.c6.D6d(va,ja),va=this.c6.tta(va),ja&&(U=U.Pa.ga(0),U.lca&&U.Ua.contextId===xb.a.textRange||2===U.length&&U.Ua.contextId===xb.a.textRange&&U.Ye.contextId===xb.a.endOfParagraph)&&
(va=1,m=ja.eb(Ie.a.gHb)),1===va?G=0:3===va&&(G=14))}}return this.iuc.w5(a,b,c,h,m,y,G)}d9d(a,b){if(a&&b&&Ob.ParagraphReader.Yd(b))b=this.c6.iL(b);else return null;return b.WG(a)}}Object(n.a)(oC,"StyleActor",null,[]);const yI=a=>a.contextId===xb.a.H2d;class xg{static get jm(){return tg.ContextSetEditor.instance}static get aj(){return Dc.a.instance}static get Wc(){return ec.a.instance}static get xe(){return xg.hd||(xg.hd=vb.a.instance.resolve("Box4.IFeatureHelper"))}static Zq(){return xg.Hm||(xg.Hm=
vb.a.instance.Ja("Box4.IExternalSelectionManager"))}static get nM(){return xg.yG||(xg.yG=vb.a.instance.resolve("Box4.IParagraphIndentationReader"))}static M9b(a){return u.AFrameworkApplication.fa.ka("FontPreviewEnabled")&&(a===D.a.AJa||a===D.a.e_a||a===D.a.A5||a===D.a.jKa)}static F7(a,b,c,h,m){var y=!0;if(!b.view.Mh)return 2;var G=b.view,U=G.Lb;U&&U.Pa.mb||(xg.Wc.Wb(Ed.a.wh,{["Reason"]:Cd.a.noSelection}),y=!1);if(J.a.instance.ga(11)&&(xg.jm.Sra(aa.ImageReader.h9b,G.Lb.Qj)&&(xg.Wc.Wb(Ed.a.wh,{["Reason"]:Cd.a.kVd}),
y=!1),xg.jm.Sra(aa.ImageReader.pyb,G.Lb.Qj)))return xg.Wc.Wb(Ed.a.wh,{["Reason"]:Cd.a.X_b}),8;J.a.instance.ga(14)&&xg.aj.RXc(G.Lb.Qj)&&(xg.Wc.Wb(Ed.a.wh,{["Reason"]:Cd.a.LD}),y=!1);xg.jm.Sra(aa.ImageReader.kie,G.Lb.Qj)&&(xg.Wc.Wb(Ed.a.wh,{["Reason"]:Cd.a.IFf}),y=!1);xg.jm.Sra($t.c,G.Lb.Qj)&&(xg.Wc.Wb(Ed.a.wh,{["Reason"]:Cd.a.JFf}),y=!1);xg.jm.Sra(yI,G.Lb.Qj)&&(xg.Wc.Wb(Ed.a.wh,{["Reason"]:Cd.a.HFf}),y=!1);xg.Zq()&&xg.Zq().instance&&xg.Zq().instance.UW(G.Lb.Qj)&&(xg.Wc.Wb(Ed.a.wh,{["Reason"]:Cd.a.externalSelection}),
y=!1);a!==D.a.m1||J.a.instance.ga(54)||J.a.instance.ga(84)||(y=!1);var ja=null;U&&U.Pa.mb&&(ja=U.Pa.mb);a===D.a.Kjl&&ja&&ja.lca&&Ob.ParagraphReader.VW(ja.Ua.node)&&!Wb.ListReader.ix&&(y=!1);if(1===c||!y||!ja)return y?32:8;y=a===D.a.Uka||a===D.a.Iia||a===D.a.eoa||a===D.a.yDa;G=a===D.a.bGk||a===D.a.MJi||a===D.a.Rgh;const va=a===D.a.yjb||a===D.a.zjb||a===D.a.m1,Ta=new t.GraphTransaction(15);Ta.kd(ja.Ua.node);ja=new Qa.a;let fb=!1;if(y||G||va)Te.a.mark(7121),b=xg.jm.P_i(b.xE);else{Te.a.mark(7119);b=pi.Vsa(U.Pa,
!0);if(!b)return xg.Wc.Wb(Ed.a.vja,{["Reason"]:Cd.a.BOc}),Ta.dispose(),8;U=a===D.a.OAj||a===D.a.PAj;b.$w&&U&&(fb=xg.ywj(ja,b))}b.$w&&1<b.length&&xg.zwj(b)&&(m||(m={}),m.InContextSet=!0);u.AFrameworkApplication.Ta.mi(b,a,c,!0,h,m);fb&&xg.Jjk(ja,b,m);Ta.dispose();Fc.App.Kb.updateCommandUI();y||G||va?Te.a.mark(7122):Te.a.mark(7120);return 32}static ywj(a,b){if(!b.$w)return!1;let c=!1,h=!1;for(let y=0;y<b.length;y++)if(b.getContext(y).el){var m=b.getContext(y).node;if(m)if(m=xg.nM.kwb(m),2===m.specialIndentType)c=
!0,a.add(y);else if(1===m.specialIndentType||0===m.specialIndentType)h=!0}return h&&c}static Jjk(a,b,c){if(b.$w)for(let m=0;m<a.count;m++){var h=b.getContext(a.ga(m));if(!h.el)continue;h=h.node;const y=xg.nM.kwb(h);2!==y.specialIndentType||kf.a.Uy(c.value,y.LN)||h.setValue(jb.a.Zl,y.LN-y.xMb)}}static icl(a,b){let c=!0;b.contextId!==xb.a.paragraph?c=!1:J.a.instance.ga(14)&&xg.aj.mFa(b)?(xg.Wc.Wb(Ed.a.To,{["Reason"]:Cd.a.LD}),c=!1):xg.Zq()&&xg.Zq().instance&&xg.Zq().instance.UW(b)&&(xg.Wc.Wb(Ed.a.To,
{["Reason"]:Cd.a.externalSelection}),c=!1);return{returnValue:1!==a&&c,qF:c?32:8}}static $sh(a,b){let c=!0;b.contextId!==xb.a.image&&b.contextId!==xb.a.embeddedFile&&(c=!1);J.a.instance.ga(11)&&(c=!1);return{returnValue:1!==a&&c,qF:c?32:8}}static zwj(a){if(!a.$w)return!1;let b=1;for(let h=0;h<a.length;h++)if(a.getContext(h).el){var c=a.getContext(h).node;if(c)if(c=Ob.ParagraphReader.BN(c),!h)b=c;else if(c!==b)return!0}return!1}}xg.hd=null;xg.Hm=null;xg.yG=null;Object(n.a)(xg,"FormattingActionHelper",
null,[]);class Ls extends Is.a{constructor(a,b,c,h,m,y,G,U){super();this.Olf=this.QB=null;this.init(a);this.Nl("FormattingViewOperation");this.AEa(u.AFrameworkApplication.Ta,b,h,m,y);this.zt=c;this.oMa=0;this.NB=!0;this.KQh=G;this.Hm=U}get Csa(){return this.Hm.instance}run(){const a=this.zt.view;var b=null;a.Mh&&(b=a.Lb);if(b){var c=b.Pa.mb;!c||J.a.instance.ga(14)&&Ls.aj.lke(c)?(Ls.Wc.Wb(Ed.a.wh,{["Reason"]:Cd.a.LD}),this.NB=!1):this.Csa&&this.Csa.Fyb(c)&&(Ls.Wc.Wb(Ed.a.wh,{["Reason"]:Cd.a.externalSelection}),
this.NB=!1)}else Ls.Wc.Wb(Ed.a.wh,{["Reason"]:Cd.a.$ma}),this.NB=!1;1!==this.behavior&&this.NB||(this.NB&&(c=b.Pa.mb,1===b.Pa.length&&1===c.length&&Bb.SelectionEditor.ek(c.Ua)&&Ud.b(c.Ua)&&(Ls.Wc.Wb(Ed.a.wh,{["Reason"]:Cd.a.YJc}),this.NB=!1)),(c=this.NB)&&this.actionId===D.a.VU&&((c=Sa.AT(b.Pa.mb,uc.a.KFf))||Ls.Wc.Wb(Ed.a.wh,{["Reason"]:Cd.a.SZd})),this.Ep=c?32:8,this.oMa=3);0===this.oMa&&(Te.a.mark(5730),this.Olf=Ym.SelectionReferenceFactory.instance.Yra(),c=b.Pa.mb.Ua,this.QB=new t.GraphTransaction(15),
this.QB.kd(c.node),this.oMa=1);if(1===this.oMa){this.Oy||this.ijb(this.zt.xE);if(1===this.Ana())return;this.oMa=2}if(2===this.oMa){if(this.actionId===D.a.VU)if(b=b.Qj,b.$w)for(c=0;c<b.length;c++){let h=b.getContext(c);this.UDh(h)}else this.UDh(b);b=this.actionId===D.a.Q5||this.actionId===D.a.Kra||this.actionId===D.a.clearFormatting||this.actionId===D.a.lW;xg.M9b(this.actionId)||this.Olf.LU(b);(b=Object(ua.a)(1128,this.rd))&&!b.Rfa||C.FocusManager.instance().xf(a.vI);this.QB.dispose();this.QB=null;
xg.M9b(this.actionId)||Fc.App.Kb.updateCommandUI();Te.a.mark(5731);this.oMa=3;this.Ep=32}3===this.oMa&&(this.KQh.process(this.actionId,this.zt,this.behavior,this.response),this.EY())}UDh(a){(Bb.SelectionEditor.Du(a)||Bb.SelectionEditor.Wl(a))&&Fc.App.MR.IR(a.node)}static get aj(){return Dc.a.instance}static get Wc(){return ec.a.instance}}Object(n.a)(Ls,"FormattingViewOperation",Is.a,[]);var OP=d(476),PP=d(410);class sd{constructor(a,b,c,h,m){this.nAa=new xa.ScriptSharpLegacyMap;this.y$k=y=>{y=Ib.HyperlinkReader.K9i(y,
this.uD);for(let G of y)(y=G.paragraph)&&y.Ra&&(y=y.Ra.aT(G.Qa))&&y.formatting&&sd.kh.Bkh(y.formatting)};this.WQh=a;this.b$e=b;this.Wv=c;this.uD=h;if(!m)throw Error.argumentNull("interactiveViewManager");sd.Lf=m;this.Xnb=!!u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.ka("FontPreviewEnabled")}vb(){const a=u.AFrameworkApplication.Ta,b=Object(F.a)(this,this.kHk,"queryNonParagraphFormatting");J.a.instance.ga(105)&&(sd.xe?sd.xe.WEa(55):u.AFrameworkApplication.fa.ka("Box4EndOfParagraphFormattingIsEnabled"))?
(a.ya(D.a.font,xb.a.endOfParagraph,Object(F.a)(this,this.RP,"applyFormattingEOP")),a.ya(D.a.ir,xb.a.endOfParagraph,Object(F.a)(this,this.RP,"applyFormattingEOP")),a.ya(D.a.DI,xb.a.endOfParagraph,Object(F.a)(this,this.RP,"applyFormattingEOP")),a.ya(D.a.UJ,xb.a.endOfParagraph,Object(F.a)(this,this.RP,"applyFormattingEOP")),a.ya(D.a.Ls,xb.a.endOfParagraph,Object(F.a)(this,this.RP,"applyFormattingEOP")),a.ya(D.a.lW,xb.a.endOfParagraph,Object(F.a)(this,this.RP,"applyFormattingEOP")),a.ya(D.a.Q5,xb.a.endOfParagraph,
Object(F.a)(this,this.RP,"applyFormattingEOP")),a.ya(D.a.Kra,xb.a.endOfParagraph,Object(F.a)(this,this.RP,"applyFormattingEOP")),a.ya(D.a.bold,xb.a.endOfParagraph,Object(F.a)(this,this.RP,"applyFormattingEOP")),a.ya(D.a.setItalic,xb.a.endOfParagraph,Object(F.a)(this,this.RP,"applyFormattingEOP")),a.ya(D.a.underline,xb.a.endOfParagraph,Object(F.a)(this,this.RP,"applyFormattingEOP")),a.ya(D.a.uoa,xb.a.endOfParagraph,Object(F.a)(this,this.RP,"applyFormattingEOP")),a.ya(D.a.superscript,xb.a.endOfParagraph,
Object(F.a)(this,this.RP,"applyFormattingEOP")),a.ya(D.a.subscript,xb.a.endOfParagraph,Object(F.a)(this,this.RP,"applyFormattingEOP")),a.ya(D.a.strikethrough,xb.a.endOfParagraph,Object(F.a)(this,this.RP,"applyFormattingEOP")),a.ya(D.a.Vs,xb.a.endOfParagraph,Object(F.a)(this,this.RP,"applyFormattingEOP")),a.ya(D.a.VU,xb.a.endOfParagraph,Object(F.a)(this,this.RP,"applyFormattingEOP")),a.ya(D.a.clearFormatting,xb.a.endOfParagraph,Object(F.a)(this,this.RP,"applyFormattingEOP"))):Fc.App.obb&&(a.ya(D.a.font,
xb.a.endOfParagraph,Object(F.a)(this,this.Yba,"applyListFormattingEOP")),a.ya(D.a.ir,xb.a.endOfParagraph,Object(F.a)(this,this.Yba,"applyListFormattingEOP")),a.ya(D.a.Ls,xb.a.endOfParagraph,Object(F.a)(this,this.Yba,"applyListFormattingEOP")),a.ya(D.a.lW,xb.a.endOfParagraph,Object(F.a)(this,this.Yba,"applyListFormattingEOP")),Wb.ListReader.ix&&(a.ya(D.a.bold,xb.a.endOfParagraph,Object(F.a)(this,this.Yba,"applyListFormattingEOP")),a.ya(D.a.setItalic,xb.a.endOfParagraph,Object(F.a)(this,this.Yba,"applyListFormattingEOP")),
a.ya(D.a.superscript,xb.a.endOfParagraph,Object(F.a)(this,this.Yba,"applyListFormattingEOP")),a.ya(D.a.subscript,xb.a.endOfParagraph,Object(F.a)(this,this.Yba,"applyListFormattingEOP")),a.ya(D.a.strikethrough,xb.a.endOfParagraph,Object(F.a)(this,this.Yba,"applyListFormattingEOP")),a.ya(D.a.Vs,xb.a.endOfParagraph,Object(F.a)(this,this.Yba,"applyListFormattingEOP"))),J.a.instance.ga(94)||J.a.instance.ga(96))&&(a.ya(D.a.DI,xb.a.endOfParagraph,Object(F.a)(this,this.Yba,"applyListFormattingEOP")),a.ya(D.a.UJ,
xb.a.endOfParagraph,Object(F.a)(this,this.Yba,"applyListFormattingEOP")));const c=Fc.App.zLa.CHf(h=>pi.Vsa(h.Pa,!0));a.ra(D.a.Vrd,xb.a.textRange,Object(F.a)(this,this.Vrd,"toggleChangeCase"),1028);J.a.instance.ga(77)||a.ya(D.a.yxa,xb.a.table,Object(F.a)(this,this.SHk,"queryTableFormatting"));a.ya(D.a.qIb,xb.a.view,Object(F.a)(this,this.Dch,"queryCharacterFormatting"));a.ya(D.a.JLe,xb.a.view,Object(F.a)(this,this.Dch,"queryCharacterFormatting"));a.ya(D.a.yxa,xb.a.view,c);a.ya(D.a.yxa,xb.a.paragraph,
Object(F.a)(this,this.yxa,"queryParagraphFormatting"));a.ya(D.a.yxa,xb.a.image,Object(F.a)(this,this.cHk,"queryImageFormatting"));a.ya(D.a.yxa,xb.a.unsupportedObject,b);a.he(D.a.qIb,99|(J.a.instance.ga(7)?0:1028));a.he(D.a.JLe,1127);a.he(D.a.yxa,97|(J.a.instance.ga(7)?0:1028));u.AFrameworkApplication.fa.ka("RulerEnabled")&&(a.ya(D.a.tIb,xb.a.view,c),a.ya(D.a.tIb,xb.a.paragraph,Object(F.a)(this,this.tIb,"queryParagraphIndentation")),a.he(D.a.tIb,97|(J.a.instance.ga(7)?0:1028)));this.TB(a,D.a.font);
this.TB(a,D.a.ir);this.Xnb&&(this.TB(a,D.a.AJa),this.TB(a,D.a.e_a),this.TB(a,D.a.A5),this.TB(a,D.a.jKa));if(J.a.instance.ga(94)||J.a.instance.ga(96))this.TB(a,D.a.DI),this.TB(a,D.a.UJ);a.vBa(D.a.sVf,xb.a.view,Object(F.a)(this,this.wPd,"applyCharacterFormattingViewAsync"));a.he(D.a.sVf,1092);this.TB(a,D.a.Ls);this.TB(a,D.a.lW);this.TB(a,D.a.Q5);this.TB(a,D.a.JZb);this.TB(a,D.a.Bsb);this.TB(a,D.a.Csb);this.TB(a,D.a.w6a);this.TB(a,D.a.KZb);this.TB(a,D.a.Kra);this.TB(a,D.a.bold);a.ajb(D.a.bold,Object(F.a)(this,
this.K8a,"generateActionArguments"));this.TB(a,D.a.setItalic);a.ajb(D.a.setItalic,Object(F.a)(this,this.K8a,"generateActionArguments"));this.TB(a,D.a.underline);a.ajb(D.a.underline,Object(F.a)(this,this.K8a,"generateActionArguments"));this.TB(a,D.a.uoa);this.TB(a,D.a.superscript);a.ajb(D.a.superscript,Object(F.a)(this,this.K8a,"generateActionArguments"));this.TB(a,D.a.subscript);a.ajb(D.a.subscript,Object(F.a)(this,this.K8a,"generateActionArguments"));this.TB(a,D.a.strikethrough);a.ajb(D.a.strikethrough,
Object(F.a)(this,this.K8a,"generateActionArguments"));this.TB(a,D.a.Vs);a.ajb(D.a.Vs,Object(F.a)(this,this.K8a,"generateActionArguments"));a.ra(D.a.S$a,xb.a.textRange,Object(F.a)(this,this.IGc,"applyCharacterFormatting"),96);a.vBa(D.a.VU,xb.a.view,Object(F.a)(this,this.wPd,"applyCharacterFormattingViewAsync"));a.ya(D.a.VU,xb.a.paragraph,Object(F.a)(this,this.DPd,"applyParagraphFormatting"));a.ya(D.a.VU,xb.a.textRange,Object(F.a)(this,this.IGc,"applyCharacterFormatting"));a.ya(D.a.VU,xb.a.Of,Object(F.a)(this,
this.xPd,"applyFormattingIp"));a.ya(D.a.clearFormatting,xb.a.view,Object(F.a)(this,this.ksi,"clearFormattingView"));a.ya(D.a.clearFormatting,xb.a.paragraph,Object(F.a)(this,this.jsi,"clearFormattingParagraph"));a.ya(D.a.clearFormatting,xb.a.textRange,Object(F.a)(this,this.IGc,"applyCharacterFormatting"));a.ya(D.a.clearFormatting,xb.a.Of,Object(F.a)(this,this.xPd,"applyFormattingIp"));a.he(D.a.clearFormatting,1028);a.ya(D.a.F6a,xb.a.textRange,Object(F.a)(this,this.F6a,"clearFormattingParagraphLevel"));
a.ya(D.a.F6a,xb.a.Of,Object(F.a)(this,this.F6a,"clearFormattingParagraphLevel"));a.ya(D.a.MTd,xb.a.view,Object(F.a)(this,this.MTd,"clearFormattingMultiParagraphLevel"));a.ya(D.a.LKa,xb.a.view,xg.F7);a.ya(D.a.LKa,xb.a.paragraph,Object(F.a)(this,this.DPd,"applyParagraphFormatting"));a.ya(D.a.LKa,xb.a.image,Object(F.a)(this,this.Hvf,"applyTextDirectionToImage"));a.ya(D.a.LKa,xb.a.unsupportedObject,Object(F.a)(this,this.Ivf,"applyTextDirectionToNonParagraph"));a.he(D.a.LKa,1028);a.ya(D.a.S_a,xb.a.view,
xg.F7);a.ya(D.a.S_a,xb.a.paragraph,Object(F.a)(this,this.DPd,"applyParagraphFormatting"));a.ya(D.a.S_a,xb.a.image,Object(F.a)(this,this.Hvf,"applyTextDirectionToImage"));a.ya(D.a.S_a,xb.a.unsupportedObject,Object(F.a)(this,this.Ivf,"applyTextDirectionToNonParagraph"));a.he(D.a.S_a,1028)}TB(a,b){a.vBa(b,xb.a.view,Object(F.a)(this,this.wPd,"applyCharacterFormattingViewAsync"));a.ya(b,xb.a.textRange,Object(F.a)(this,this.IGc,"applyCharacterFormatting"));a.ya(b,xb.a.Of,Object(F.a)(this,this.xPd,"applyFormattingIp"));
a.he(b,1028)}K8a(){return new T(2)}Vrd(a,b,c){if(1===c)return 32;a=b.node.characterData.substr(b.Qa,b.Nb-b.Qa);return sd.Jke(a,0,a.length)?this.yIc(b,D.a.Bsb):sd.uTj(a)?this.yIc(b,D.a.w6a):this.yIc(b,D.a.Csb)}Dch(a,b,c,h,m){h=!0;b.contextId!==xb.a.view&&(h=!1);if(1===c&&!h)return 8;if(a===D.a.JLe)a=m.formatting,m=m.aJl;else{if(!b.view||!b.view.Mh)return 2;b=b.view;if(!b.Lb||!b.Lb.Pa.mb)return 8;a=m;m=b.Lb.Pa}this.Dvi(m,a);return 32}Dvi(a,b){for(let m of a){a=m.Gl;for(let y of m){let G=null;if(y.contextId===
xb.a.textRange){if(Ud.b(y))continue;G=[];var c=y.node.Ra;if(c){var h=c.length-1;const U=y.Qa,ja=y.Nb;let va=!1;for(let Ta=0;Ta<h;Ta++){const fb=c.ga(Ta).cp,Db=c.ga(Ta+1).cp;if(c.ga(Ta).formatting&&Math.max(fb,U)<Math.min(Db,ja))va=!0,Array.add(G,c.ga(Ta).formatting);else if(va)break}c.ga(h).formatting&&y.Nb>c.ga(h).cp&&Array.add(G,c.ga(h).formatting)}}else if(y.contextId===xb.a.paragraph){if(G=[],c=y.node.Ra)for(h=0;h<c.length;h++)c.ga(h).formatting&&Array.add(G,c.ga(h).formatting)}else if(y.contextId===
xb.a.endOfParagraph)G=[uc.a.ps(y)];else if(y.contextId===xb.a.Of){this.KGk(y,b);return}if(G&&0<G.length)for(const U of G)if(uc.a.jtd(b,U.cache,y,a))return}}}KGk(a,b){var c=uc.a.ps(a);if(c){c=c.cache;var h=sd.insertionPointFormatting.AI(kb.a.bold,c.isBold);b.bold=h?1:0;h=sd.insertionPointFormatting.AI(kb.a.italic,c.isItalic);b.italic=h?1:0;h=sd.insertionPointFormatting.AI(kb.a.underline,c.dE);b.underline=h?1:0;b.Lw=sd.insertionPointFormatting.AI(kb.a.Lw,c.Lw);h=sd.insertionPointFormatting.AI(kb.a.superscript,
c.isSuperscript);b.superscript=h?1:0;h=sd.insertionPointFormatting.AI(kb.a.subscript,c.LF);b.subscript=h?1:0;h=sd.insertionPointFormatting.AI(kb.a.strikethrough,c.KF);b.strikethrough=h?1:0;h=sd.insertionPointFormatting.AI(Ie.a.Vs,c.w_);b.Vs=h?1:0;b.fontName=lf.Font.MDa(sd.insertionPointFormatting.AI(kb.a.font,c.zN));b.Noa=c.hV;b.fontSize=this.Wv.h9a(sd.insertionPointFormatting.AI(kb.a.fontSize,c.fontSize),a.node);b.fontColor=sd.insertionPointFormatting.AI(kb.a.fontColor,c.fontColor);b.highlight=sd.insertionPointFormatting.AI(kb.a.highlight,
c.highlight)}}wPd(a,b,c,h,m,y){return new Ls(a,b,c,h,m,y,this.WQh,sd.Zq())}IGc(a,b,c,h,m){h=!0;let y=b;b.contextId!==xb.a.textRange&&b.contextId!==xb.a.Of?h=!1:(J.a.instance.ga(14)&&sd.aj.hua(y)&&(sd.Wc.Wb(Ed.a.To,{["Reason"]:Cd.a.LD}),h=!1),sd.Zq()&&sd.Zq().instance&&sd.Zq().instance.UW(y)&&(h=!1),h&&Bb.SelectionEditor.ek(b)&&Ud.b(y)&&(sd.Wc.Wb(Ed.a.To,{["Reason"]:Cd.a.YJc}),h=!1));if(1===c||!h)return h?32:8;if(b.contextId===xb.a.Of)return 2;this.Wv.guh(a)&&(b=Bb.SelectionEditor.WNb(y),Bb.SelectionEditor.Sg(b)||
(y=b));b=y.node;xg.M9b(a)&&(b.Joa=!0);a==D.a.Ls&&J.a.instance.ga(119)&&u.AFrameworkApplication.fa.isChangeGateEnabled("HyperlinkPartialColorSupported")&&this.y$k(y);sd.t_e.JGc(y,G=>{this.Xoh(G,a,m,y.Nb)});xg.M9b(a)&&(b.Joa=!1);this.JIj(a)&&this.yIc(y,a);return 32}MSc(a){if(!this.Xnb||!a||!a.paragraph)return null;const b=sd.Lf.Rd;if(!b)return null;a=Object(ua.a)(455,a.paragraph.tg(b.Ma));return a?(a=Object(ua.a)(1127,a))?a:null:null}cVc(a){return this.Xnb&&!!a&&!!a.Hi}pph(a,b,c){if(a&&a.rd){var h=
b.cache,m=a.rd,y=-1;if("string"===typeof m)this.Xnb&&c===D.a.A5&&this.r6a(b,h.zN,kb.a.font),a=m;else if(this.Xnb&&c===D.a.A5&&(this.r6a(b,h.zN,kb.a.font),this.r6a(b,h.hV,jb.a.hV)),a=m.fontName,y=m.Noa,lf.Font.uUa()){this.Xnb&&c===D.a.A5&&(this.r6a(b,h.isBold,kb.a.bold),this.r6a(b,h.isItalic,kb.a.italic));const G=1===m.bold;m=1===m.italic;if(G||m)sd.kh.GH(b,G),sd.kh.setItalic(b,m)}a=a.substr(0,31);sd.kh.TU(b,a);J.a.instance.ga(53)&&(c===D.a.A5&&this.r6a(b,h.hV,jb.a.hV),sd.kh.MKa(b,y))}}r6a(a,b,c){this.nAa.Hb(a.Ee.cp)||
this.nAa.$(a.Ee.cp,new xa.ScriptSharpLegacyMap);this.nAa.ga(a.Ee.cp).Hb(c)||this.nAa.ga(a.Ee.cp).$(c,b)}s4b(a,b){if(!this.nAa.Hb(a.Ee.cp))return null;const c=this.nAa.ga(a.Ee.cp).ga(b);this.nAa.ga(a.Ee.cp).remove(b);this.nAa.ga(a.Ee.cp).count||this.nAa.remove(a.Ee.cp);return c}Xoh(a,b,c,h){var m=a.cache,y=Object(ua.a)(1128,c);switch(b){case D.a.bold:2===c.value&&(c.value=m.isBold?0:1);sd.kh.GH(a,1===c.value);break;case D.a.setItalic:2===c.value&&(c.value=m.isItalic?0:1);sd.kh.setItalic(a,1===c.value);
break;case D.a.underline:2===c.value&&(c.value=m.dE?0:1);sd.kh.JY(a,1===c.value);break;case D.a.uoa:sd.kh.uoa(a,c);break;case D.a.superscript:2===c.value&&(c.value=m.isSuperscript?0:1);sd.kh.IY(a,1===c.value);break;case D.a.subscript:2===c.value&&(c.value=m.LF?0:1);sd.kh.R5(a,1===c.value);break;case D.a.strikethrough:2===c.value&&(c.value=m.KF?0:1);sd.kh.GY(a,1===c.value);break;case D.a.Vs:2===c.value&&(c.value=m.w_?0:1);sd.kh.jjb(a,1===c.value);break;case D.a.font:this.pph(y,a,D.a.font);break;case D.a.A5:c=
this.MSc(a);this.cVc(c)&&(this.pph(y,a,D.a.A5),c.$J(null));break;case D.a.jKa:c=this.MSc(a);this.cVc(c)&&(y=this.s4b(a,kb.a.font))&&(m=this.s4b(a,kb.a.bold),h=this.s4b(a,kb.a.italic),m&&sd.kh.GH(a,m),h&&sd.kh.setItalic(a,h),y=y.substr(0,31),sd.kh.TU(a,y),m=this.s4b(a,jb.a.hV),J.a.instance.ga(53)&&m&&sd.kh.MKa(a,m),c.$J(null));break;case D.a.Ls:sd.kh.Ls(a,c,null);break;case D.a.lW:sd.kh.lW(a);break;case D.a.Q5:sd.kh.noa(a,c);break;case D.a.Kra:sd.kh.h_b(a);break;case D.a.ir:sd.kh.ir(a,y.rd);break;
case D.a.AJa:c=this.MSc(a);this.cVc(c)&&(this.r6a(a,m.fontSize,kb.a.fontSize),sd.kh.ir(a,y.rd),c.$J(null));break;case D.a.e_a:c=this.MSc(a);this.cVc(c)&&(m=this.s4b(a,kb.a.fontSize))&&(sd.kh.ir(a,m),c.$J(null));break;case D.a.DI:sd.kh.wUc(a);break;case D.a.UJ:sd.kh.Jpd(a);break;case D.a.VU:m=J.a.instance.ga(20)?jb.a.noProof:xc.a.Jwa;sd.kh.mpc(a,c.eb(kb.a.$s),h,c.sa(m,!1));break;case D.a.S$a:sd.kh.$Kb(a);break;case D.a.clearFormatting:sd.kh.$Ba(a);break;case D.a.Bsb:case D.a.Csb:case D.a.JZb:case D.a.w6a:case D.a.KZb:m.rTa&&
2===m.capitalization&&sd.kh.HTd(a)}}F6a(a,b,c){a=!0;b.contextId!==xb.a.textRange&&b.contextId!==xb.a.Of?a=!1:(J.a.instance.ga(14)&&sd.aj.hua(b)&&(sd.Wc.Wb(Ed.a.To,{["Reason"]:Cd.a.LD}),a=!1),a&&Bb.SelectionEditor.ek(b)&&Ud.b(b)&&(sd.Wc.Wb(Ed.a.To,{["Reason"]:Cd.a.YJc}),a=!1));if(1===c||!a)return a?32:8;sd.paragraphEditor.j_b(b.node,!1);return 32}MTd(a,b,c,h,m){a={};a[$h.epa]=6168;a[$h.dpa]=6169;const y=b.view;var G=null;y.np&&(G=y);var U=!0;let ja=32;G&&(G=G.Lb.Pa.mb)&&J.a.instance.ga(14)&&(sd.aj.lke(G)?
(sd.Wc.Wb(Ed.a.wh,{["Reason"]:Cd.a.LD}),ja=8,U=!1):1===c&&(ja=32,U=!1));U&&J.a.instance.ga(54)&&(U=new t.GraphTransaction(1===c?3:15),U.kd(y.root),ja=$h.w5(D.a.F6a,b,c,h,m,a,12),U.dispose());return ja}xPd(a,b,c,h,m){var y=!0,G=32;b.contextId!==xb.a.Of?y=!1:J.a.instance.ga(14)&&sd.aj.hua(b)&&(sd.Wc.Wb(Ed.a.To,{["Reason"]:Cd.a.LD}),y=!1);if(1===c||!y)return y?32:8;c=b.node;y=null;if(J.a.instance.ga(54)&&J.a.instance.ga(61)&&a===D.a.clearFormatting){sd.eq.Qsb(c);sd.paragraphEditor.HDf(c);const U=Ya.StyleReader.iL(c).WG(Ya.StyleReader.iMa);
sd.gP.paa(U,c,!0)}if(a!==D.a.clearFormatting||J.a.instance.ga(49))y=sd.insertionPointFormatting.x5b(b);if(y)G=me.a.AQa(y),G=u.AFrameworkApplication.Ta.mi(G,a,2,!1,h,m);else switch(h=Object(ua.a)(1128,m),b=uc.a.ps(b).cache,a){case D.a.font:h&&h.rd&&(m=h.rd,h=-1,"string"===typeof m?b=m:(b=m.fontName,h=m.Noa),sd.insertionPointFormatting.xnd(b),J.a.instance.ga(53)&&sd.insertionPointFormatting.MKa(h));break;case D.a.Ls:sd.insertionPointFormatting.Ls(m);break;case D.a.lW:sd.insertionPointFormatting.lW();
break;case D.a.Q5:sd.insertionPointFormatting.noa(m);break;case D.a.Kra:sd.insertionPointFormatting.h_b();break;case D.a.ir:sd.insertionPointFormatting.ir(h.rd);break;case D.a.DI:m=sd.insertionPointFormatting.AI(kb.a.fontSize,b.fontSize);sd.insertionPointFormatting.ir(sd.kh.DI(m));break;case D.a.UJ:m=sd.insertionPointFormatting.AI(kb.a.fontSize,b.fontSize);sd.insertionPointFormatting.ir(sd.kh.UJ(m));break;case D.a.bold:sd.insertionPointFormatting.GH(!sd.insertionPointFormatting.AI(kb.a.bold,b.isBold));
break;case D.a.setItalic:sd.insertionPointFormatting.setItalic(!sd.insertionPointFormatting.AI(kb.a.italic,b.isItalic));break;case D.a.underline:sd.insertionPointFormatting.JY(!sd.insertionPointFormatting.AI(kb.a.underline,b.dE));break;case D.a.uoa:sd.insertionPointFormatting.uoa(m);break;case D.a.superscript:sd.insertionPointFormatting.IY(!sd.insertionPointFormatting.AI(kb.a.superscript,b.isSuperscript));break;case D.a.subscript:sd.insertionPointFormatting.R5(!sd.insertionPointFormatting.AI(kb.a.subscript,
b.LF));break;case D.a.strikethrough:sd.insertionPointFormatting.GY(!sd.insertionPointFormatting.AI(kb.a.strikethrough,b.KF));break;case D.a.Vs:sd.insertionPointFormatting.jjb(!sd.insertionPointFormatting.AI(Ie.a.Vs,b.w_));break;case D.a.clearFormatting:sd.insertionPointFormatting.ZZa();J.a.instance.ga(54)||(sd.eq.Qsb(c),sd.paragraphEditor.j_b(c,!0),J.a.instance.ga(71)&&sd.gP.$Ic(c));break;case D.a.VU:m.Sa(kb.a.$s)&&sd.insertionPointFormatting.VU(m.eb(kb.a.$s)),b=J.a.instance.ga(20)?jb.a.noProof:xc.a.Jwa,
m.Sa(b)&&sd.insertionPointFormatting.E7k(m.eb(b))}xg.M9b(a)||Fc.App.Kb.updateCommandUI();return G}ASk(a,b){D.a.clearFormatting===b&&mc.OutlineElementNavigator.PA(a).properties.removeProperty(kb.a.oY)}RP(a,b,c,h,m){h=sd.Wc.Vp(D.a.P5k);var y=!0;b.contextId!==xb.a.endOfParagraph&&(y=!1);if(1===c||!y)return y?32:8;c=b.node;b=rb.GraphIterator.nb(b.node);b.gf();y=b.$ja(4);if((b=!!y&&sd.Sf.zda(y))&&!Fc.App.obb)return 8;const G=!Ob.ParagraphReader.textLength(c);h.properties.$("Action",a.toString());h.properties.$("ListContext",
b.toString());h.properties.$("IsEmptyParagraph",G.toString());ba.ULS.sendTraceTag(8700679,324,50,"Apply format to EOP: Action - {0}, InList - {1}, IsEmpty - {2}.",a,b,G);this.b$e.Myh(b)?this.nGh(a,m,y):(b=c.Ra.last,this.ASk(c,a),y=b.formatting,c=sd.characterPropertiesEditor.e0d(c),this.b$e.jig(y)&&(c.$d(c.Ee),this.Xoh(c,a,m,b.cp)));h.end();return 32}nGh(a,b,c){const h=Object(ua.a)(1128,b);switch(a){case D.a.Ls:sd.Lda.Ls(c,b);break;case D.a.ir:sd.Lda.ir(c,h.rd);break;case D.a.lW:sd.Lda.lW(c);break;
case D.a.DI:sd.Lda.DI(c);break;case D.a.UJ:sd.Lda.UJ(c);break;case D.a.font:sd.Lda.n6k(c,h.rd);break;case D.a.bold:a=this.PJb(b,kb.a.bold,c);sd.Lda.GH(c,a);break;case D.a.setItalic:a=this.PJb(b,kb.a.italic,c);sd.Lda.setItalic(c,a);break;case D.a.subscript:a=this.PJb(b,kb.a.subscript,c);sd.Lda.R5(c,a);break;case D.a.superscript:a=this.PJb(b,kb.a.superscript,c);sd.Lda.IY(c,a);break;case D.a.strikethrough:a=this.PJb(b,kb.a.strikethrough,c);sd.Lda.GY(c,a);break;case D.a.Vs:a=this.PJb(b,Ie.a.Vs,c),sd.Lda.jjb(c,
a)}}PJb(a,b,c){2===a.value&&(a.value=c?c.sa(b,!1)?0:1:0);return 1===a.value}Yba(a,b,c,h,m){h=!0;const y=rb.GraphIterator.nb(b.node);y.gf();b.contextId===xb.a.endOfParagraph&&y.$ja(4)||(sd.Wc.Wb(Ed.a.To,{["Reason"]:Cd.a.ume}),h=!1);b=y.currentNode;if(!sd.Sf.zda(b))return 8;if(1===c||!h)return h?32:8;this.nGh(a,m,b);return 32}yxa(a,b,c,h,m){a=!0;b.contextId!==xb.a.paragraph&&(a=!1);if(1===c&&!a)return 8;c=b.node;-1!==m.Il?m.Il!==Ob.ParagraphReader.BN(c)&&(m.Il=0):m.Il=Ob.ParagraphReader.BN(c);J.a.instance.ga(54)&&
(J.a.instance.ga(59)||J.a.instance.ga(34))&&(a=sd.nM.kwb(c),m.VA?(!m.FHl&&this.Awj(m.VA,a)&&2===m.VA.specialIndentType&&(m.VA.specialIndentType=0),m.VA.$Vc===a.$Vc&&kf.a.Uy(m.VA.LN,a.LN)||(m.VA.LN=Number.MAX_VALUE),m.VA.bWc===a.bWc&&kf.a.Uy(m.VA.Oxb,a.Oxb)||(m.VA.Oxb=Number.MAX_VALUE)):m.VA=a,b=sd.jm.Bwf(b.xE),void 0!==b&&null!==b&&(b=b.node,void 0!==b&&null!==b&&(b=OP.WordSectionNavigator.instance.uDe(b),void 0!==b&&null!==b&&(b=sd.p4e.mta(b)-(sd.p4e.W6d(b)+sd.p4e.X6d(b)+Fc.App.UEl),a.aWc=b-a.LN,
a.ZVc=b-a.Oxb,m.VA.ZVc=Math.min(m.VA.ZVc,a.ZVc),m.VA.aWc=Math.min(m.VA.aWc,a.aWc)))));if(J.a.instance.ga(54)&&J.a.instance.ga(59)||J.a.instance.ga(84))b=sd.qYj.JW(c),m.spacing?(m.spacing.beforeSpacing=sd.otf(b.beforeSpacing,m.spacing.beforeSpacing),m.spacing.afterSpacing=sd.otf(b.afterSpacing,m.spacing.afterSpacing),m.spacing.lineSpacing.Vf===b.lineSpacing.Vf&&kf.a.Uy(m.spacing.lineSpacing.value,b.lineSpacing.value)||(m.spacing.lineSpacing.Vf=0,m.spacing.lineSpacing.value=0)):m.spacing=b;b=new rb.GraphIterator;
b.set(c);b.rc(11);if(c=b.Ng(11))m.isRtl=Kd.OutlineElementReader.um(c);c=sd.Sf.fw(b);b=16;void 0!==c&&null!==c&&(b=c.listType);m.listType=sd.P5i(m.listType,b);m.GT=16===m.listType?null:c;return 32}Awj(a,b){return this.Vvf(a,b)||this.Vvf(b,a)}Vvf(a,b){return(1===a.specialIndentType||0===a.specialIndentType)&&2===b.specialIndentType}kHk(a,b,c,h,m){a=mc.OutlineElementNavigator.PA(b.node);m.isRtl=Kd.OutlineElementReader.um(a);return 32}Ivf(a,b,c){if(a===D.a.S_a)a=!0;else if(a===D.a.LKa)a=!1;else return 2;
a&&this.gne(b);if(1===c)return 32;b=mc.OutlineElementNavigator.PA(b.node);sd.Ph.HKa(b,a);return 32}cHk(a,b,c,h,m){a=b.node;b=mc.OutlineElementNavigator.PA(a);m.isRtl=Kd.OutlineElementReader.isRtl(b);m.Il=aa.ImageReader.BN(a);return 32}SHk(a,b,c,h,m){a=b.node;b=mc.OutlineElementNavigator.PA(a);m.isRtl=Kd.OutlineElementReader.isRtl(b);m.Il=rd.TableReader.BN(a);if(-1===m.Il||0===m.Il)m.Il=m.isRtl?3:1;return 32}Hvf(a,b,c){if(!({qF:c}=xg.$sh(c,b)).returnValue)return c;c=b.node;switch(a){case D.a.LKa:case D.a.S_a:c=
mc.OutlineElementNavigator.PA(c);let h=!0;a===D.a.LKa&&(h=!1);sd.Ph.HKa(c,h);h&&this.gne(b)}return 32}DPd(a,b,c,h,m){let y;if(!({qF:y}=xg.icl(c,b)).returnValue)return y;const G=b.node;switch(a){case D.a.LKa:sd.Ph.zLb(G,!1);break;case D.a.S_a:this.gne(b);sd.Ph.zLb(G,!0);break;case D.a.VU:y=u.AFrameworkApplication.Ta.mi(b.xE,a,c,!0,h,m),32===y&&Ob.ParagraphReader.tm(b)&&sd.Tlc&&sd.Tlc.IR(G)}return 32}ksi(a,b,c,h,m){const y={};y[$h.epa]=6168;y[$h.dpa]=6169;var G=b.view;const U=new t.GraphTransaction(1===
c?3:15);U.kd(G.root);let ja=$h.w5(a,b,c,h,m,y,0),va=null;G.np&&(va=G);G=!0;let Ta=null;va&&(Ta=va.Lb.Pa.mb)&&J.a.instance.ga(14)&&(sd.aj.lke(Ta)?(sd.Wc.Wb(Ed.a.wh,{["Reason"]:Cd.a.LD}),ja=8,G=!1):1===c&&(ja=32,G=!1));G&&this.yTj(Ta)&&(ja=J.a.instance.ga(54)?$h.w5(D.a.F6a,b,c,h,m,y,12):$h.w5(a,b,c,h,m,y,12));U.dispose();return ja}jsi(a,b,c){a=!0;b.contextId!==xb.a.paragraph&&b.contextId!==xb.a.Of?a=!1:J.a.instance.ga(14)&&sd.aj.mFa(b)&&(sd.Wc.Wb(Ed.a.To,{["Reason"]:Cd.a.LD}),a=!1);if(1===c||!a)return a?
32:8;b=b.node;c=new t.GraphTransaction(15);c.kd(b);sd.eq.Qsb(b);sd.paragraphEditor.j_b(b,!0);sd.gP.$Ic(b);c.dispose();return 2}tIb(a,b,c,h,m){a=b.contextId===xb.a.paragraph;if(1===c&&!a)return 8;m.VA||(b=b.node,c=sd.nM.kwb(b),m.VA=c,c=new rb.GraphIterator,c.set(b),c.rc(11),b=c.Ng(11),m.isRtl=b?Kd.OutlineElementReader.um(b):!1);return 32}yTj(a){return!a||Bb.SelectionEditor.gx(a)||1===a.length&&Bb.SelectionEditor.ek(a.Ua)&&!Bb.SelectionEditor.Dyb(a.Ua)?!1:!0}gne(a){sd.ilf.Hb(a.contextId)||(ba.ULS.sendTraceTag(42276747,
340,50,"RTL Usage : {0}",a.contextId),sd.ilf.$(a.contextId,!0))}JIj(a){return a===D.a.JZb||a===D.a.Bsb||a===D.a.Csb||a===D.a.w6a||a===D.a.KZb}yIc(a,b){const c=a.node;b=sd.hpl(c.characterData.substr(a.Qa,a.Nb-a.Qa),b);c.characterData=c.characterData.substr(0,a.Qa)+b+c.characterData.substr(a.Nb);return 32}static get kh(){return sd.Kf||(sd.Kf=vb.a.instance.resolve("Box4.IFormattingEditor"))}static get characterPropertiesEditor(){return sd.Zg||(sd.Zg=vb.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static get paragraphEditor(){return sd.Rw||
(sd.Rw=vb.a.instance.resolve("Box4.IParagraphEditor"))}static get qYj(){return sd.LNa||(sd.LNa=vb.a.instance.resolve("Box4.ILineSpacingHelper"))}static get gP(){return sd.BK||(sd.BK=vb.a.instance.resolve("Box4.Styles.IStyleEditor"))}static get Ph(){return sd.Di||(sd.Di=vb.a.instance.resolve("Box4.IOutlineElementEditor"))}static get insertionPointFormatting(){return sd.Bt||(sd.Bt=vb.a.instance.resolve("Box4.IInsertionPointFormatting"))}static get Lda(){return sd.sob||(sd.sob=vb.a.instance.resolve("Box4.List.IListFormattingEditor"))}static get nM(){return sd.yG||
(sd.yG=vb.a.instance.resolve("Box4.IParagraphIndentationReader"))}static Zq(){return sd.Hm||(sd.Hm=vb.a.instance.Ja("Box4.IExternalSelectionManager"))}static get jm(){return tg.ContextSetEditor.instance}static get aj(){return Dc.a.instance}static get Wc(){return ec.a.instance}static get xe(){return sd.hd||(sd.hd=vb.a.instance.rb("Box4.IFeatureHelper"))}static get Tlc(){return Fc.App.MR}static get Tf(){return sd.fd||(sd.fd=vb.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static get p6(){return sd.$o||
(sd.$o=vb.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}static get t_e(){return sd.TOa||(sd.TOa=vb.a.instance.resolve("Box4.TextFormattingHelper"))}static get Sf(){return sd.Ug||(sd.Ug=vb.a.instance.resolve("Box4.List.IListReader"))}static get eq(){return sd.Xo||(sd.Xo=vb.a.instance.resolve("Box4.List.IListEditor"))}static get p4e(){return PP.a.instance}static P5i(a,b){return 42===a?b:a!==b||16===a?16:a}static otf(a,b){a.efg||(b.efg?b=a:b.Vf===a.Vf&&kf.a.Uy(b.value,a.value)||
(b.value=-1));return b}static hpl(a,b){switch(b){case D.a.Bsb:return a.toLowerCase();case D.a.Csb:return a.toUpperCase();case D.a.JZb:case D.a.w6a:return sd.zpi(a,b===D.a.w6a);case D.a.KZb:return sd.Rql(a);default:return a}}static Rql(a){let b="";for(let c=0;c<a.length;c++)b=a.charAt(c)===a.charAt(c).toUpperCase()?b+a.charAt(c).toLowerCase():b+a.charAt(c).toUpperCase();return b}static zpi(a,b){let c,h,m=!0,y=a.length,G=0,U=sd.Jke(a,G,y);for(;0<y;){h=c=!1;var ja=y;let Ta;var va=void 0;for(va=0;0<ja&&
sd.kri(a.charAt(G+va));va++,ja--)h=sd.ZZc(a.charAt(G+va));for(Ta=va;0<ja&&!(c=sd.ZZc(a.charAt(G+va)))&&" "!==a.charAt(G+va)&&"/"!==a.charAt(G+va);va++,ja--);ja=va-Ta;if(0>=ja)break;G+=Ta;va=a.substr(G,ja);va=va===va.toUpperCase();if(U||!va)a=m||h||b?a.substr(0,G)+a.charAt(G).toUpperCase()+a.substr(G+1,ja-1).toLowerCase()+a.substr(G+ja):a.substr(0,G)+a.substr(G,ja).toLowerCase()+a.substr(G+ja);y-=ja+Ta;G+=ja;if(m=c)G++,y--,U=sd.Jke(a,G,y)}return a}static Jke(a,b,c){for(;0<c&&!sd.ZZc(a.charAt(b));){if(a.charAt(b)!==
a.charAt(b).toUpperCase())return!1;b++;c--}return!0}static uTj(a){for(var b=0;b<a.length&&!sd.ZZc(a.charAt(b));){if(a.charAt(b)!==a.charAt(b).toLowerCase())return!1;b++}return!0}static ZZc(a){return"."===a||"!"===a||"?"===a?!0:!1}static kri(a){return-1==="0123456789".indexOf(a)&&a.toUpperCase()===a.toLowerCase()}}sd.Kf=null;sd.Di=null;sd.ilf=new vi.a;sd.Lf=null;sd.LNa=null;sd.Zg=null;sd.Rw=null;sd.BK=null;sd.Bt=null;sd.sob=null;sd.yG=null;sd.Hm=null;sd.hd=null;sd.fd=null;sd.$o=null;sd.TOa=null;sd.Ug=
null;sd.Xo=null;Object(n.a)(sd,"TextFormattingActor",null,[]);class zI{constructor(a){this.Ca=a}get zn(){return this.Ca}$Kb(a,b=!1){this.zn.mi(a,D.a.S$a,2,!0,null,b)}VU(a){this.zn.La(D.a.VU,2,a)}}Object(n.a)(zI,"TextFormattingCommands",null,[1041]);class au{get epa(){return $h.epa}get dpa(){return $h.dpa}get UOb(){return $h.UOb}w5(a,b,c,h,m,y,G){return $h.w5(a,b,c,h,m,y,G)}Rgb(a,b,c,h,m,y){return $h.Rgb(a,b,c,h,m,y)}static get instance(){au.Ka||(au.Ka=new au);return au.Ka}}au.Ka=null;Object(n.a)(au,
"ViewActionHandlerProxy",null,[1126]);class AI{constructor(a){this.Ca=a}get zn(){return this.Ca}cik(a){if(4===a)a=D.a.leftArrow;else if(2===a)a=D.a.rightArrow;else if(1===a)a=D.a.upArrow;else if(3===a)a=D.a.downArrow;else return;this.zn.processAction(a,2)}Bsa(){this.zn.processAction(D.a.Bsa,2)}}Object(n.a)(AI,"SelectionCommands",null,[1040]);class BI{Qg(a,b){return yd.SelectionFactory.Qg(a,b)}wN(a,b){return yd.SelectionFactory.wN(a,b)}wu(a,b=!0){return yd.SelectionFactory.wu(a,b)}V2(a,b,c){return yd.SelectionFactory.V2(a,
b,c)}wl(a){return yd.SelectionFactory.wl(a)}$Nb(a,b,c=!1){return yd.SelectionFactory.$Nb(a,b,c)}}Object(n.a)(BI,"SelectionFactoryProxy",null,[1028]);var QP=d(874),qx=d(248),oz=d(992);class CI extends oz.a{constructor(a,b,c,h,m,y,G=null,U=null){super(a,y,G,U);this.lo=this.Rw=this.i2=null;this.Ppa=!1;this.F2a=u.AFrameworkApplication.fa.ka("FollowDestinationFormattingPasteIsEnabled");this.L3a=0;this.JKd=new Qa.a;ef.a(8128527,307,Kd.OutlineElementReader.Wg(a));this.nF=b;this.nF.Krb(this);this.CBd=c;this.Xo=
h;this.Ug=m;this.Fzk=U;this.NGd=Wb.ListReader.tk(this.Ab)}get L8(){return this.i2||(this.i2=vb.a.instance.rb("Box4.IInternalLinkManager"))}get paragraphEditor(){return this.Rw||(this.Rw=vb.a.instance.resolve("Box4.IParagraphEditor"))}get KQa(){return null}get $6a(){return this.NGd&&!this.nF.vca}get o7a(){return 0<this.L3a}get uv(){return this.CBd}get eq(){return this.Xo}get Sf(){return this.Ug}get tHc(){return this.Fzk}N0(a,b){if(!this.gZ.o1e(b)){ef.a(8701077,307,Ob.ParagraphReader.fl(this.Ab));var c=
this.Ab.currentNode,h=md.a.zQa(c);this.F2a&&this.lo.G8a&&(c=c.Ra.last,this.Ppa&&(c.formatting=this.lo.G8a.$d(c),this.Ppa=!1),a=this.gZ.T$d(a,b),this.gZ.qoa(this.Ab.currentNode,this.lo.nfa,b));this.characterPropertiesEditor.replaceTextRange(h,a)}}lna(){ef.a(8701078,307,Ob.ParagraphReader.fl(this.Ab));const a=md.a.zQa(this.Ab.currentNode);this.characterPropertiesEditor.qWc(a,b=>new wv.a(b,wv.a.OLc),Vb.AParagraphNode.f_)}NYa(){}jna(){this.F2a&&(this.Ppa=!0)}Owa(){ef.a(8701079,307,Ob.ParagraphReader.fl(this.Ab))}Nwa(){ef.a(8701080,
307,Ob.ParagraphReader.fl(this.Ab))}nA(a){this.nF.vca||(this.F2a?(this.pPd(a),this.lo.ssd(this.Ab.currentNode),a&&"P"===a.BU.w7b&&this.tHc.FKa(this.Ab.currentNode,this.lo.Qfd),this.gZ.qoa(this.Ab.currentNode,this.lo.nfa,a)):this.Mgi(a))}mA(){this.nF.vca||this.d3()}Twa(){}WIa(){}ona(){ef.a(8701081,307,Kd.OutlineElementReader.Wg(this.Ab)||Yi.OutlineReader.Ut(this.Ab)||Ob.ParagraphReader.fl(this.Ab)&&this.nF.vca);let a=!1;this.o7a||(a=this.$6a||!0);a||(this.pM+=1);this.L3a++}mna(){this.L3a--;let a=!1;
this.o7a||(a=this.$6a||!0);a||--this.pM}Swa(a){ef.a(8701082,307,Kd.OutlineElementReader.Wg(this.Ab)||Yi.OutlineReader.Ut(this.Ab)||Ob.ParagraphReader.fl(this.Ab)&&this.nF.vca);ef.a(8701083,307,0!==a.listStyleType)}nna(){ef.a(8701084,307,Kd.OutlineElementReader.Wg(this.Ab)||Ob.ParagraphReader.fl(this.Ab)&&this.nF.vca);this.nF.vca||ef.a(8701085,307,this.Ab.FI(2))}mY(a){this.nF.mY(a)}jY(){this.nF.jY()}esd(a){this.JKd.add(a)}lY(a){this.nF.lY(a)}kY(){this.nF.kY()}iY(a){this.nF.iY(a)}hY(){this.nF.hY()}Mgi(a){this.CFb(!1);
(new rb.GraphIterator).Rc(this.Ab);a=oz.a.Ph.qca(this.Ab,this.DSa(a));ef.a(8128534,307,a===this.Ab.currentNode);ef.a(8128535,307,Ob.ParagraphReader.Yd(a))}d3(){ef.a(8128536,307,Ob.ParagraphReader.fl(this.Ab));mc.OutlineElementNavigator.Oe(this.Ab)}reset(){this.F2a&&(super.reset(),this.lo=this.f5d(!0))}pPd(a){this.CFb(!1);(new rb.GraphIterator).Rc(this.Ab);a=oz.a.Ph.qca(this.Ab,this.DSa(a));ef.a(36577367,307,a===this.Ab.currentNode);ef.a(36577368,307,Ob.ParagraphReader.Yd(a));-1!==this.lo.eE&&this.paragraphEditor.RJ(a,
this.lo.eE);this.lo.lineSpacing&&this.tHc.m1(a,this.lo.lineSpacing);this.lo.Yfa&&this.tHc.Yqh(a,this.lo.Yfa);this.lo.I0c&&this.tHc.Pph(a,this.lo.I0c);this.Ppa=!0;this.lo.paragraph=a}static IVd(a,b){let c=0;switch(b){case 3:c=te.a.Ita(a);break;case 7:c=$d.a.rfa(a,0);break;case 1:c=te.a.aTd(a);break;case 5:c=te.a.Ita(te.a.Mgd(a));break;default:ba.ULS.sendTraceTag(36577369,307,50,"ConvertToTwips unable to convert inputValue {0} and inputUnit {1} to twips, returning 0",a,b)}return c}}Object(n.a)(CI,"TextOnlyBox4PasteSteward",
oz.a,[]);class pC{constructor(a,b,c,h){this.zUb=a;this.Xo=b;this.Ug=c;this.gZ=h}create(a,b,c,h,m=null,y=null){return 1===a?new CI(b,h,this.zUb,this.Xo,this.Ug,m,y,this.gZ):new qx.Box4PasteSteward(b,c,h,this.zUb,this.Xo,this.Ug,m,y,this.gZ)}}Object(n.a)(pC,"Box4PasteStewardFactory",null,[1070]);class Ig{static get yyj(){return Ig.URh}static get Eyj(){return Ig.XRh}static get Dyj(){return Ig.WRh}static tFk(a,b){const c=a.currentNode;Gd.forEachCell(a,b.rowSpan,b.colSpan,(h,m,y)=>{const G=h.currentNode;
G!==c&&(G.isGhostCell=!0,Ig.JLf(h),!y&&1<=b.colSpan&&(G.colSpan=b.colSpan),Ig.vph(h,b.f6,m,y,b.rowSpan,b.colSpan))})}static NFk(a,b){Gd.forEachCell(a,b.rowSpan,b.colSpan,c=>{Ig.Vdi(c);Ig.JLf(c)})}static Vdi(a){a=a.currentNode;a.isGhostCell=!0;a.isSkippedCell=!0;a.Ojb=!0}static JLf(a){a&&(a.Bb(1),Object(za.a)(aI.a,a.currentNode)&&a.Mi())}static mei(a,b,c){0<b&&(a=Object(ua.a)(px.TableCellNode,a.currentNode))&&(a.width=c?b:$d.a.rf(b,0))}static zdi(a,b,c){if(a=Object(ua.a)(sy.a,a.currentNode))0<b&&(a.Zl=
$d.a.rfa(b,0)),0<c&&(a.pY=$d.a.rfa(c,0))}static Lvf(a,b){void 0!==b&&null!==b&&a.currentNode.properties.setValue(jb.a.HZe,Ig.Eyj[b+""])}static yvf(a,b){void 0!==b&&null!==b&&""!==b&&a.currentNode.properties.setValue(kb.a.wIc,parseInt(qx.Box4PasteSteward.b7a(b),16))}static Zlj(a){const b=new rb.GraphIterator;b.Rc(a);return(a=ii.OutlineNavigator.ild(b))&&Yi.OutlineReader.Ut(b)?a.Lh(jb.a.uR)-a.Lh(jb.a.marginLeft)-a.Lh(jb.a.marginRight):0}static vRj(a){return!(void 0===a||null===a||1===a)}static L4k(a,
b,c,h,m){if(void 0===b||null===b||""!==b){switch(b){case "thin":b=te.a.Lgd(.25);break;case "initial":case "medium":b=te.a.Lgd(.5);break;case "thick":b=te.a.Lgd(1);break;default:b=Ig.hjj(b,c,h)}m.currentNode.properties.setValue(a,b)}}static cTe(a,b,c){void 0!==b&&null!==b&&0!==b&&c.currentNode.properties.setValue(a,Ig.Dyj[b+""])}static K4k(a,b,c){void 0!==b&&null!==b&&""!==b&&c.currentNode.properties.setValue(a,parseInt(qx.Box4PasteSteward.b7a(b),16))}static hjj(a,b,c){let h=0;const m=({Vf:a}=qx.Box4PasteSteward.$fd(a)).returnValue;
switch(a){case 5:h=te.a.Lgd(m);break;case 1:h=te.a.gpi(m);break;case 3:h=te.a.vbg(m);break;case 7:h=$d.a.Yzk(m,c)}if(6===b||7===b||10===b)h/=3;return Math.round(h)}static ijj(a,b){let c=0;const h=({Vf:a}=qx.Box4PasteSteward.$fd(a)).returnValue;switch(a){case 5:c=te.a.AH(h);break;case 1:c=te.a.hpi(h);break;case 3:c=te.a.MW(h);break;case 7:c=$d.a.rf(h,b)}return c}static hnd(a,b,c,h,m,y,G){if(m&&(!G||16===m.ri||G||14!==m.ri)&&12!==c){if(G)switch(h){case 7:h=jb.a.Ezh;var U=jb.a.Gzh;var ja=jb.a.Fzh;var va=
0;break;case 6:h=jb.a.Bzh;U=jb.a.Dzh;ja=jb.a.Czh;va=1;break;case 0:h=jb.a.rzh;U=jb.a.tzh;ja=jb.a.szh;va=0;break;case 5:h=jb.a.yzh;U=jb.a.Azh;ja=jb.a.zzh;va=1;break;default:return}else switch(h){case 7:h=jb.a.Lnl;U=jb.a.Nnl;ja=jb.a.Mnl;va=0;break;case 6:h=jb.a.Inl;U=jb.a.Knl;ja=jb.a.Jnl;va=1;break;case 0:h=jb.a.Cnl;U=jb.a.Enl;ja=jb.a.Dnl;va=0;break;case 5:h=jb.a.Fnl;U=jb.a.Hnl;ja=jb.a.Gnl;va=1;break;default:return}void 0!==m.currentNode&&null!==m.currentNode&&(Ig.vRj(c)?(Ig.K4k(h,a,m),Ig.cTe(U,c,m),
Ig.L4k(ja,b,c,va,m)):y||G||m.currentNode.properties.setValue(U,"nil"))}}static vph(a,b,c,h,m,y){h||(Ig.svf(b,a,!1,!1),Ig.GPd(b,a,!0,!1));h===y-1&&Ig.GPd(b,a,!0,!1);c||Ig.Jvf(b,a,!0,!1);c===m-1&&Ig.mvf(b,a,!0,!1)}static kvf(a,b,c,h){a&&(Ig.Jvf(a,b,c,h),Ig.GPd(a,b,c,h),Ig.mvf(a,b,c,h),Ig.svf(a,b,c,h))}static Jvf(a,b,c,h){Ig.hnd(a.borderTopColor,a.borderTopWidth,a.borderTopStyle,7,b,c,h)}static GPd(a,b,c,h){Ig.hnd(a.borderRightColor,a.borderRightWidth,a.borderRightStyle,6,b,c,h)}static mvf(a,b,c,h){Ig.hnd(a.borderBottomColor,
a.borderBottomWidth,a.borderBottomStyle,0,b,c,h)}static svf(a,b,c,h){Ig.hnd(a.borderLeftColor,a.borderLeftWidth,a.borderLeftStyle,5,b,c,h)}static ind(a,b,c){if(c&&16===c.ri&&""!==a){switch(b){case 3:b=jb.a.eNb;var h=0;break;case 2:b=jb.a.dNb;h=1;break;case 0:b=jb.a.aNb;h=0;break;case 1:b=jb.a.bNb;h=1;break;default:return}(a=Ig.ijj(a,h))&&c.currentNode.properties.setValue(b,a)}}static jdi(a,b){b&&(Ig.hei(b,a),Ig.Qdi(b,a),Ig.kdi(b,a),Ig.Edi(b,a))}static hei(a,b){Ig.ind(a.$oi,3,b)}static Qdi(a,b){Ig.ind(a.Zoi,
2,b)}static kdi(a,b){Ig.ind(a.Xoi,0,b)}static Edi(a,b){Ig.ind(a.Yoi,1,b)}}Ig.Uik=8;Ig.ZIi="Table Grid";Ig.URh=Da.a.JH("MsoNormalTable","Normal Table","MsoTableGrid",Ig.ZIi,"MsoTableGridLight","Grid Table Light","MsoTable15Plain1","Plain Table 1","MsoTable15Plain2","Plain Table 2","MsoTable15Plain3","Plain Table 3","MsoTable15Plain4","Plain Table 4","MsoTable15Plain5","Plain Table 5","MsoTable15Grid1Light","Grid Table 1 Light","MsoTable15Grid1LightAccent1","Grid Table 1 Light Accent 1","MsoTable15Grid1LightAccent2",
"Grid Table 1 Light Accent 2","MsoTable15Grid1LightAccent3","Grid Table 1 Light Accent 3","MsoTable15Grid1LightAccent4","Grid Table 1 Light Accent 4","MsoTable15Grid1LightAccent5","Grid Table 1 Light Accent 5","MsoTable15Grid1LightAccent6","Grid Table 1 Light Accent 6","MsoTable15Grid2","Grid Table 2","MsoTable15Grid2Accent1","Grid Table 2 Accent 1","MsoTable15Grid2Accent2","Grid Table 2 Accent 2","MsoTable15Grid2Accent3","Grid Table 2 Accent 3","MsoTable15Grid2Accent4","Grid Table 2 Accent 4","MsoTable15Grid2Accent5",
"Grid Table 2 Accent 5","MsoTable15Grid2Accent6","Grid Table 2 Accent 6","MsoTable15Grid3","Grid Table 3","MsoTable15Grid3Accent1","Grid Table 3 Accent 1","MsoTable15Grid3Accent2","Grid Table 3 Accent 2","MsoTable15Grid3Accent3","Grid Table 3 Accent 3","MsoTable15Grid3Accent4","Grid Table 3 Accent 4","MsoTable15Grid3Accent5","Grid Table 3 Accent 5","MsoTable15Grid3Accent6","Grid Table 3 Accent 6","MsoTable15Grid4","Grid Table 4","MsoTable15Grid4Accent1","Grid Table 4 Accent 1","MsoTable15Grid4Accent2",
"Grid Table 4 Accent 2","MsoTable15Grid4Accent3","Grid Table 4 Accent 3","MsoTable15Grid4Accent4","Grid Table 4 Accent 4","MsoTable15Grid4Accent5","Grid Table 4 Accent 5","MsoTable15Grid4Accent6","Grid Table 4 Accent 6","MsoTable15Grid5Dark","Grid Table 5 Dark","MsoTable15Grid5DarkAccent1","Grid Table 5 Dark Accent 1","MsoTable15Grid5DarkAccent2","Grid Table 5 Dark Accent 2","MsoTable15Grid5DarkAccent3","Grid Table 5 Dark Accent 3","MsoTable15Grid5DarkAccent4","Grid Table 5 Dark Accent 4","MsoTable15Grid5DarkAccent5",
"Grid Table 5 Dark Accent 5","MsoTable15Grid5DarkAccent6","Grid Table 5 Dark Accent 6","MsoTable15Grid6Colorful","Grid Table 6 Colorful","MsoTable15Grid6ColorfulAccent1","Grid Table 6 Colorful Accent 1","MsoTable15Grid6ColorfulAccent2","Grid Table 6 Colorful Accent 2","MsoTable15Grid6ColorfulAccent3","Grid Table 6 Colorful Accent 3","MsoTable15Grid6ColorfulAccent4","Grid Table 6 Colorful Accent 4","MsoTable15Grid6ColorfulAccent5","Grid Table 6 Colorful Accent 5","MsoTable15Grid6ColorfulAccent6","Grid Table 6 Colorful Accent 6",
"MsoTable15Grid7Colorful","Grid Table 7 Colorful","MsoTable15Grid7ColorfulAccent1","Grid Table 7 Colorful Accent 1","MsoTable15Grid7ColorfulAccent2","Grid Table 7 Colorful Accent 2","MsoTable15Grid7ColorfulAccent3","Grid Table 7 Colorful Accent 3","MsoTable15Grid7ColorfulAccent4","Grid Table 7 Colorful Accent 4","MsoTable15Grid7ColorfulAccent5","Grid Table 7 Colorful Accent 5","MsoTable15Grid7ColorfulAccent6","Grid Table 7 Colorful Accent 6","MsoTable15List1Light","List Table 1 Light","MsoTable15List1LightAccent1",
"List Table 1 Light Accent 1","MsoTable15List1LightAccent2","List Table 1 Light Accent 2","MsoTable15List1LightAccent3","List Table 1 Light Accent 3","MsoTable15List1LightAccent4","List Table 1 Light Accent 4","MsoTable15List1LightAccent5","List Table 1 Light Accent 5","MsoTable15List1LightAccent6","List Table 1 Light Accent 6","MsoTable15List2","List Table 2","MsoTable15List2Accent1","List Table 2 Accent 1","MsoTable15List2Accent2","List Table 2 Accent 2","MsoTable15List2Accent3","List Table 2 Accent 3",
"MsoTable15List2Accent4","List Table 2 Accent 4","MsoTable15List2Accent5","List Table 2 Accent 5","MsoTable15List2Accent6","List Table 2 Accent 6","MsoTable15List3","List Table 3","MsoTable15List3Accent1","List Table 3 Accent 1","MsoTable15List3Accent2","List Table 3 Accent 2","MsoTable15List3Accent3","List Table 3 Accent 3","MsoTable15List3Accent4","List Table 3 Accent 4","MsoTable15List3Accent5","List Table 3 Accent 5","MsoTable15List3Accent6","List Table 3 Accent 6","MsoTable15List4","List Table 4",
"MsoTable15List4Accent1","List Table 4 Accent 1","MsoTable15List4Accent2","List Table 4 Accent 2","MsoTable15List4Accent3","List Table 4 Accent 3","MsoTable15List4Accent4","List Table 4 Accent 4","MsoTable15List4Accent5","List Table 4 Accent 5","MsoTable15List4Accent6","List Table 4 Accent 6","MsoTable15List5Dark","List Table 5 Dark","MsoTable15List5DarkAccent1","List Table 5 Dark Accent 1","MsoTable15List5DarkAccent2","List Table 5 Dark Accent 2","MsoTable15List5DarkAccent3","List Table 5 Dark Accent 3",
"MsoTable15List5DarkAccent4","List Table 5 Dark Accent 4","MsoTable15List5DarkAccent5","List Table 5 Dark Accent 5","MsoTable15List5DarkAccent6","List Table 5 Dark Accent 6","MsoTable15List6Colorful","List Table 6 Colorful","MsoTable15List6ColorfulAccent1","List Table 6 Colorful Accent 1","MsoTable15List6ColorfulAccent2","List Table 6 Colorful Accent 2","MsoTable15List6ColorfulAccent3","List Table 6 Colorful Accent 3","MsoTable15List6ColorfulAccent4","List Table 6 Colorful Accent 4","MsoTable15List6ColorfulAccent5",
"List Table 6 Colorful Accent 5","MsoTable15List6ColorfulAccent6","List Table 6 Colorful Accent 6","MsoTable15List7Colorful","List Table 7 Colorful","MsoTable15List7ColorfulAccent1","List Table 7 Colorful Accent 1","MsoTable15List7ColorfulAccent2","List Table 7 Colorful Accent 2","MsoTable15List7ColorfulAccent3","List Table 7 Colorful Accent 3","MsoTable15List7ColorfulAccent4","List Table 7 Colorful Accent 4","MsoTable15List7ColorfulAccent5","List Table 7 Colorful Accent 5","MsoTable15List7ColorfulAccent6",
"List Table 7 Colorful Accent 6");Ig.XRh=Da.a.JH("0","center","1","top","2","center","3","bottom");Ig.WRh=Da.a.JH("0","nil","1","none","2","nil","3","single","5","dotted","4","dashed","11","single","6","double","7","double","10","double","8","inset","9","outset");Object(n.a)(Ig,"Box4TableStewardHelper",null,[]);class rx{constructor(a,b,c,h=!1,m=!1,y=!1){this.Pv=null;this.M3a=0;this.Ab=a;this.eq=b;this.Oq=c;this.Spb=h;this.JUb=m;this.KGd=y}Krb(a){this.Pv=a}get vca(){return 0<this.M3a}mY(a){ef.a(7869459,
307,!!this.Pv);ef.a(7869460,307,Kd.OutlineElementReader.Wg(this.Ab)||Yi.OutlineReader.Ut(this.Ab));ef.c(38563978,307,50,"Table pasting started");this.Pv.CFb(!0);const b=new rb.GraphIterator;b.Rc(this.Ab);Object(ua.a)(String,Ig.yyj[a.uyh]);const c=this.Oq.ENk(this.Ab,a.BY,a.Nra,this.Pv.DSa(a),a.Beg);if(this.Spb&&(ef.c(23938568,307,50,a.lQa?"Table-widths exist":"Table-widths missing, table may be invalid"),a.EZe&&Ig.kvf(a.EZe,this.Ab,!1,!0),Ig.zdi(this.Ab,a.rce.Ejl,a.rce.Djl),a.lQa)){var h=0;const U=
Array(a.lQa.length);var m=0;a.sFa&&J.a.instance.ga(63)&&(m=(m=te.a.fEh(Ig.Zlj(this.Ab)))?m:1);for(var y=0;y<a.lQa.length;y++)U[y]=0<m?m/100*a.lQa[y]:$d.a.rf(a.lQa[y],0),h+=U[y];m=c.eb(kb.a.Tu);var G=new rb.GraphIterator;G.Rc(this.Ab);a=0;if(Qe.isInTableCell(G)){if(m=Gd.returnToContainingCell(G))a=m.width;y=xn.a(G);G=Gd.returnToContainingTable(G);if(-1!==y&&y<=G.oQa.length){let ja=0;for(let va=y;va<y+m.colSpan&&va<G.oQa.length;va++)ja+=G.oQa[va];a=Math.min(a,ja);a===ja&&(a-=$d.a.rf(Ig.Uik,0))}}else if(m)for(y=
0;y<m.length;y++)a+=m[y];if(0<a&&h>a&&h)for(h=a/h,a=0;a<U.length;a++)U[a]*=h;c.setValue(kb.a.Tu,U)}this.Pv.LGc(b,!1);this.M3a++;J.a.instance.ga(63)&&Wb.ListReader.tk(b)&&this.Pv.esd(b.currentNode);ef.a(7869461,307,rd.TableReader.aq(this.Ab))}jY(){ef.a(7869462,307,!!this.Pv);ef.a(7869463,307,gk.l(this.Ab));ef.c(38563979,307,50,"Table pasting finished");mc.OutlineElementNavigator.Oe(this.Ab);this.M3a--}lY(a){ef.a(7869464,307,!!this.Pv);rd.TableReader.aq(this.Ab)?Gd.moveToFirstRow(this.Ab):gk.l(this.Ab)&&
Gd.moveToNextRow(this.Ab);this.Spb&&a.height&&this.Ab.currentNode.setValue(jb.a.mu,$d.a.rf(a.height,1));ef.a(7869465,307,gk.l(this.Ab))}kY(){ef.a(7869466,307,!!this.Pv);ef.a(7869467,307,Qe.isTableCell(this.Ab));Gd.returnToContainingRow(this.Ab)}iY(a){ef.a(7869468,307,!!this.Pv);ef.a(7869469,307,!this.Pv.pM);gk.l(this.Ab)?Gd.moveToFirstColumn(this.Ab):Qe.isTableCell(this.Ab)?Gd.moveToNextColumn(this.Ab):ef.a(7869471,307,!1);u.AFrameworkApplication.fk("Microsoft.Office.Web.SessionSettings.IWacWordPasteComplexTablesSettings");
if(this.JUb){if(!this.Ab.currentNode)return;var b=Object(ua.a)(px.TableCellNode,this.Ab.currentNode);ef.a(50689760,307,!b&&16!==this.Ab.currentNode.type||!!b&&16===this.Ab.currentNode.type);if(!b)return;let c=new rb.GraphIterator;c.Rc(this.Ab);if(!a.colSpan||!a.rowSpan)return;if(a.Bzb){Ig.NFk(c,a);return}if(1<a.colSpan||1<a.rowSpan){const h=Gd.returnToContainingTable(c);if(!h)return;h.setValue(jb.a.complexTable,!0);c.Rc(this.Ab);Ig.tFk(c,a);b.rowSpan=a.rowSpan;b.colSpan=a.colSpan}}this.Spb&&(Ig.yvf(this.Ab,
a.Ppc),Ig.Lvf(this.Ab,a.verticalAlignment),this.KGd&&Ig.jdi(this.Ab,a.Tqd));this.JUb&&Ig.kvf(a.f6,this.Ab,!a.colSpan&&!a.rowSpan,!1);this.Spb&&(this.JUb||(b=new rb.GraphIterator,b.Rc(this.Ab),Gd.forEachCell(b,a.rowSpan,a.colSpan,(c,h,m)=>{Ig.yvf(c,a.Ppc);Ig.Lvf(c,a.verticalAlignment);Ig.vph(c,a.f6,h,m,a.rowSpan,a.colSpan)})),Ig.mei(this.Ab,a.width,a.sFa));ef.a(7869472,307,Yi.OutlineReader.Ut(this.Ab))}hY(){ef.a(7869473,307,!!this.Pv);ef.a(7869474,307,Kd.OutlineElementReader.Wg(this.Ab)||Qe.isTableCell(this.Ab));
Gd.returnToCell(this.Ab);ef.a(7869475,307,0>=this.Pv.pM);this.Pv.PTd()}static get Ph(){return rx.Di||(rx.Di=vb.a.instance.resolve("Box4.IOutlineElementEditor"))}}rx.Di=null;Object(n.a)(rx,"Box4TableSteward",null,[385,386]);class bu{constructor(a,b,c){this.Pv=null;this.M3a=0;this.Ab=a;this.eq=b;this.Oq=c}Krb(a){this.Pv=a}get vca(){return 0<this.M3a}mY(){this.vca&&(ef.a(8787101,307,Ob.ParagraphReader.fl(this.Ab)),mc.OutlineElementNavigator.Oe(this.Ab));ef.a(8701086,307,!!this.Pv);ef.a(8701087,307,Kd.OutlineElementReader.Wg(this.Ab)||
Yi.OutlineReader.Ut(this.Ab));this.M3a++}jY(){ef.a(8701088,307,!!this.Pv);mc.OutlineElementNavigator.Oe(this.Ab);this.M3a--;if(this.vca){this.Pv.CFb(!0);const a=bu.Ph.qca(this.Ab);ef.a(8787102,307,a===this.Ab.currentNode);ef.a(8787103,307,Ob.ParagraphReader.fl(this.Ab))}}lY(a){ef.a(8701089,307,!!this.Pv);this.Pv.CFb(!0);const b=new rb.GraphIterator;b.Rc(this.Ab);this.Pv.LGc(b,!1);J.a.instance.ga(63)&&Wb.ListReader.tk(b)&&this.Pv.esd(b.currentNode);a=bu.Ph.qca(this.Ab,this.Pv.DSa(a));ef.a(8701090,
307,a===this.Ab.currentNode);ef.a(8701091,307,Ob.ParagraphReader.fl(this.Ab))}kY(){ef.a(8701120,307,!!this.Pv);ef.a(8701121,307,Ob.ParagraphReader.fl(this.Ab));mc.OutlineElementNavigator.Oe(this.Ab)}iY(){ef.a(8701122,307,!!this.Pv);ef.a(8701123,307,Ob.ParagraphReader.fl(this.Ab));ef.a(8701124,307,!this.Pv.pM);var a=this.Ab.currentNode;Ob.ParagraphReader.textLength(a)&&(a=md.a.zQa(a),this.Pv.characterPropertiesEditor.replaceTextRange(a,", "))}hY(){ef.a(8701125,307,!!this.Pv);ef.a(8701126,307,Ob.ParagraphReader.fl(this.Ab));
ef.a(8701127,307,0>=this.Pv.pM);this.Pv.PTd()}static get Ph(){return bu.Di||(bu.Di=vb.a.instance.resolve("Box4.IOutlineElementEditor"))}}bu.Di=null;Object(n.a)(bu,"TextOnlyBox4TableSteward",null,[385,386]);class qC{constructor(a,b,c=!1,h=!1,m=!1){this.Xo=a;this.AD=b;this.Spb=c;this.JUb=h;this.KGd=m}create(a,b){return 1===a?new bu(b,this.Xo,this.AD):new rx(b,this.Xo,this.AD,this.Spb,this.JUb,this.KGd)}}Object(n.a)(qC,"Box4TableStewardFactory",null,[361]);class DI{create(){return new fn.a}}Object(n.a)(DI,
"Factory",null,[1029]);class EI{$b(a){a.register(pC,"Box4.Actors.Box4PasteStewardFactory").as("Box4.Actors.IBox4PasteStewardFactory").ma().oa(()=>new pC(kv.a.vwb,a.resolve("Box4.List.IListEditor"),a.resolve("Box4.List.IListReader"),a.resolve("Box4.Actors.IBox4PasteStewardBridge")));a.register(RB,"Box4.Actors.Box4PasteStewardUtils").as("Box4.Actors.IBox4PasteStewardUtils").ma().oa(()=>new RB(u.AFrameworkApplication.fa.ka("WacPasteBrAsNewParagraphIsEnabled")));a.register(tH.ClipboardActor,"Box4.Actors.ClipboardActor").ma().oa(()=>
new tH.ClipboardActor(a.re("Box4.Actors.IClipboardOperationFactory"),a.resolve("Box4.Actors.ISystemClipboard"),ec.a.instance,a.resolve("Box4.IClipboardDataHelper"),me.a.instance,u.AFrameworkApplication.Ta,a.resolve("Box4.IUndoManager"),u.AFrameworkApplication.fa));a.register(1021,"Common.App.ChromeExtensionHelper.IChromeExtensionHelper").ma().oa(()=>new RA(u.AFrameworkApplication.fa));a.register(1025,"Box4.Clipboard.ISystemClipboardAccessManagerFactory").ma().oa(()=>new rI(u.AFrameworkApplication.fa,
a.resolve("Common.App.ChromeExtensionHelper.IChromeExtensionHelper"),a.resolve("Box4.IClipboardDataHelper"),Lc.a.instance));a.register(1026,"Box4.Clipboard.ISystemClipboardAccessManager").ma().oa(()=>a.resolve("Box4.Clipboard.ISystemClipboardAccessManagerFactory").create());a.register(1027,"Box4.Actors.ISystemClipboard").ma().oa(()=>new nI(a.resolve("Box4.Clipboard.ISystemClipboardAccessManager"),na.InteractiveViewManager.instance,Fc.App.Kb.Jd,C.FocusManager.instance(),a.resolve("Box4.IEditingDomManager"),
a.resolve("Box4.IEditViewStateManager"),Lc.a.instance));a.register(311,"Box4.Clipboard.IClipboardOperationCutStrategy").ma().oa(()=>new wH);a.register(312,"Box4.Actors.IDeleteTableSegmentStrategy").ma().oa(()=>new sI);a.register(1028,"Box4.ISelectionFactory").ma().oa(()=>new BI);a.register(1029,"Box4.IRenderOrderGraphIteratorFactory").ma().oa(()=>new DI);a.register(1030,"Common.IDomElementContentStateFactory").ma().oa(()=>new aH);a.register(1031,"Box4.Actors.IClipboardOperationPasteOvertypeStrategy").ma().oa(()=>
new IH(me.a.instance,a.resolve("Box4.IParagraphReader"),a.resolve("Box4.Styles.IStyleReader"),J.a.instance.ga(71)));a.register(kC,"Box4.Actors.PasteFloatieFeatureSetBuilder").ma().oa(()=>new kC(a.resolve("Box4.IClipboardDataHelper"),Fc.App.HD.KS));a.register(1032,"Box4.Actors.IClipboardOperationPasteFactory").ma().oa(()=>new GH(ec.a.instance,a.resolve("Box4.Actors.InternalClipboard"),a.resolve("Box4.Actors.PasteCoordinator"),jc.a.instance,me.a.instance,u.AFrameworkApplication.Ta,a.resolve("Box4.Actors.IClipboardOperationPasteStrategyFactory"),
a.re("Box4.IUndoManager"),a.resolve("Common.IDomElementContentStateFactory"),a.resolve("Box4.Actors.IClipboardOperationPasteOvertypeStrategy"),a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance));a.register(291,"Box4.Actors.IClipboardOperationCutCopyFactory").ma().oa(()=>new vH(u.AFrameworkApplication.Ta,ec.a.instance,a.resolve("Box4.Actors.InternalClipboard"),a.resolve("Box4.IOutlineElementEditor"),me.a.instance,a.resolve("Box4.Actors.ISystemClipboard"),a.resolve("Box4.IParagraphReader"),
Pi.a.instance,a.resolve("Box4.IOutlineElementNavigator"),a.resolve("Box4.Graph.IGraphIteratorFactory"),a.resolve("Box4.IOutlineElementReader"),a.resolve("Box4.IRenderOrderGraphIteratorFactory"),a.resolve("Box4.ISelectionFactory"),a.resolve("Common.IAppSettingsManager"),a.resolve("Box4.IClipboardDataHelper")));a.register(1033,"Box4.Actors.IClipboardOperationClipboardAccessHelper").ma().oa(()=>new uH(ec.a.instance,Lc.a.instance,a.resolve("Box4.Actors.ISystemClipboard"),a.resolve("Common.ISimpleOperationFactory"),
u.AFrameworkApplication.fa.appSettings.ChromeClipboardAccessOperationTimeout));a.register(1034,"Box4.Actors.IClipboardOperationPasteStrategyFactory").ma().oa(()=>new LH(u.AFrameworkApplication.fa));a.register(1035,"Box4.Actors.IClipboardOperationFactory").ma().oa(()=>new EH(a.resolve("Box4.Actors.InternalClipboard"),u.AFrameworkApplication.Ta,u.AFrameworkApplication.epd()&&!(v.a.uT&&u.AFrameworkApplication.fa.ka("ElectronClipboardAccessFix")),ec.a.instance,Pi.a.instance,Lc.a.instance,a.resolve("Box4.Graph.IGraphTransactionFactory"),
a.resolve("Box4.Actors.IClipboardOperationPasteFactory"),a.resolve("Box4.Actors.IClipboardOperationCutCopyFactory"),a.resolve("Box4.Actors.IClipboardOperationClipboardAccessHelper"),a.resolve("Box4.Actors.ClipboardOperationWordStrategy"),a.resolve("Box4.ICannotCutDialog"),a.resolve("Common.ISimpleOperationFactory"),a.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance,a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,a.resolve("Box4.IUndoManager"),a.resolve("Box4.IPasteFloatieEventSource"),
a.resolve("Common.Utils.Telemetry.ITelemetry")));a.register(1036,"Box4.Actors.IExternalPasteExecutionManagerFactory").ma().oa(()=>new WH(a.re("Box4.Actors.IBox4PasteStewardFactory"),a.re("Box4.Actors.IBox4ImageStewardFactory"),a.re("Box4.Actors.IBox4TableStewardFactory"),a.re("Box4.Actors.IBox4WordConverterFactory"),a.resolve("HtmlImport.IHtmlTranslatorSettings"),a.resolve("Common.IAppSettingsManager"),a.resolve("Box4.Actors.IExternalPasteCssConverter"),a.resolve("HtmlImport.IHtmlNormalizerSettings")));
a.register(Oh,"Box4.Actors.InternalClipboard").ma().oa(()=>new Oh(a.resolve("Box4.Images.IImageEditor"),a.resolve("Box4.ITableEditor"),a.resolve("Box4.IOutlineEditor"),a.resolve("Box4.IOutlineElementEditor"),a.resolve("Box4.List.IListEditor"),Fc.App.iP,a.resolve("Box4.IParagraphIndentationReader"),u.AFrameworkApplication.fa,a.resolve("Box4.Graph.IGraphNodeFactory"),a.resolve("Box4.Graph.IGraphTransactionFactory"),a.resolve("Box4.ITableCellReader"),a.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance,
a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,a.resolve("Box4.IConstantsProvider").toh,a.resolve("Box4.IFormattingPropertyTransitStrategy")));a.register(1037,"Box4.Actors.IInternalPasteExecutionManagerFactory").ma().oa(()=>new iI(a.resolve("Box4.Actors.InternalClipboard"),new sb.a(()=>Fc.App.Kb.Jd.Cn)));a.register(1038,"Box4.List.IListCommands").ma().oa(()=>new tI(u.AFrameworkApplication.Ta));a.register(Wr,"Box4.Actors.PasteCoordinator").ma().oa(()=>new Wr(a.resolve("Box4.Actors.InternalClipboard"),
a.resolve("Box4.Actors.IInternalPasteExecutionManagerFactory"),a.resolve("Box4.Actors.IExternalPasteExecutionManagerFactory")));J.a.instance.ga(78)||a.register(qC,"Box4.Actors.Box4TableStewardFactory").as("Box4.Actors.IBox4TableStewardFactory").ma().oa(()=>new qC(vb.a.instance.resolve("Box4.List.IListEditor"),vb.a.instance.resolve("Box4.ITableEditor"),a.resolve("Common.IAppSettingsManager").ka("TablePasteRefactoringAndFixesIsEnabled"),a.resolve("Common.IAppSettingsManager").ka("PasteComplexTablesIsEnabled"),
a.resolve("Common.IAppSettingsManager").ka("PasteTableCellMarginImprovementsIsEnabled")));a.register(cC,"Box4.Actors.ClipboardOperationWordStrategy").ma().oa(()=>new cC(ec.a.instance,me.a.instance,Fc.App.Ih,Dc.a.instance,J.a.instance.ga(14),J.a.instance.ga(50)));a.register($B,"Box4.Actors.Box4WordConverterFactory").as("Box4.Actors.IBox4WordConverterFactory").ma().oa(()=>new $B(u.AFrameworkApplication.fa));a.register(1039,"Box4.Actors.IExternalPasteCssConverter").ma().oa(()=>new MH(u.AFrameworkApplication.fa));
a.register(1040,"Box4.ISelectionCommands").ma().oa(()=>new AI(u.AFrameworkApplication.Ta));a.register(1041,"Box4.ITextFormattingCommands").ma().oa(()=>new zI(u.AFrameworkApplication.Ta));a.register(PB,"Box4.Actors.AccessibilityActor").ma().oa(()=>new PB(a.Ja("Box4.Accessibility.IAccessibilityContextManager"),a.resolve("Box4.Proofing.IErrorRangeEditor")));a.register(tq,"Box4.Actors.InsertionPointFormatting").as("Box4.IInsertionPointFormatting").ma().oa(()=>new tq(a.rb("Box4.IFontSlotProvider"),a.resolve("Box4.Actors.IFontNameFormattingStrategy")));
a.register(nC,"Box4.Actors.ProofingActor").ma().oa(()=>new nC(vb.a.instance.resolve("Box4.Proofing.IErrorRangeEditor"),u.AFrameworkApplication.Ta,()=>vb.a.instance.resolve("Box4.UI.ILanguageDialog"),vb.a.instance.resolve("Box4.ICharacterPropertiesEditor"),vb.a.instance.resolve("Box4.Graph.IGraphTransactionFactory"),me.a.instance,vb.a.instance.Ja("Box4.IExternalSelectionManager"),Pi.a.instance,vb.a.instance.resolve("Box4.ISelectionContextMenuProvider"),Dc.a.instance,ec.a.instance,vb.a.instance.resolve("Box4.IContextMenuController"),
vb.a.instance.resolve("Box4.Proofing.IProofingFeatureConfiguration"),vb.a.instance.Ja("Box4.Actors.IProofingErrorPresenter"),J.a.instance));a.register(oC,"Box4.Actors.StyleActor").ma().oa(()=>new oC(vb.a.instance.resolve("Box4.ICharacterPropertiesEditor"),vb.a.instance.resolve("Box4.Styles.IStyleEditor"),QP.a.instance,vb.a.instance.resolve("Box4.IFormattingEditor"),tg.ContextSetEditor.instance,vb.a.instance.resolve("Box4.IInsertionPointFormatting"),Dc.a.instance,ec.a.instance,vb.a.instance.resolve("Box4.TextFormattingHelper"),
au.instance));a.register(sd,"Box4.Actors.TextFormattingActor").ma().oa(()=>new sd(a.resolve("Box4.Actors.IFormattingViewOperationFinishedStageProcessor"),a.resolve("Box4.Actors.IEopFormattingStrategy"),a.resolve("Box4.ITextRenderingStrategy"),a.resolve("Box4.IHyperlinkStrategy"),na.InteractiveViewManager.instance));a.register(QB,"Box4.Actors.AutoCorrectActor").ma().oa(()=>new QB(u.AFrameworkApplication.Ta,ec.a.instance,()=>vb.a.instance.resolve("Box4.UI.IAutoCorrectOptionsDialog")))}}Object(n.a)(EI,
"Box4ActorsComponentConfiguration",null,[3]);const SP=(a,b,c)=>Fc.App.lZd?8:2===c?(a=new Rf.StandardDialog,a.xd=4,a.jya(1),a.Xe(1,Box4Intl.Box4Strings.l_DownloadEmbeddedFileYesButton),a.Xe(2,Box4Intl.Box4Strings.l_DownloadEmbeddedFileNoButton),a.Xgl(RP),32):2,RP=a=>{1===a&&u.AFrameworkApplication.Ta.processAction(D.a.YZd,2)},FI=(a,b,c)=>{if(Fc.App.lZd)return 8;if(1===c)return b.node.Sa(kb.a.embeddedFileContainer)?32:2;if(2===c&&(b.contextId===xb.a.view&&b.view.Lb&&(b=b.view.Lb.Qj),$a.EmbeddedFileReader.MKj(b))){a=
$a.EmbeddedFileReader.E5d(b.node);oi.a.T$k();try{TP(a)}catch(h){ba.ULS.sendTraceTag(37515617,339,15,"Window.Open failed with error: {0}",h)}}return 32},TP=a=>{if(1!==Fc.App.mode||!u.AFrameworkApplication.fa.ka("OneNoteSaveFileThroughRequest")||u.AFrameworkApplication.fa.ka("IsTeamsSession")&&v.a.uT)window.open(a);else{var b=(new Vl.QueryStringBuilder(a)).Bdj(),c=new XMLHttpRequest;c.onloadstart=()=>{c.responseType="blob"};c.open("GET",a,!0);c.onload=()=>{try{const G=c.response;let U=b;U||(U="GetImage",
G.type&&-1!=G.type.indexOf("image/")&&"bmp gif ico jpeg png svg tiff webp".split(" ").forEach(ja=>{-1!=G.type.indexOf(ja)&&(U="GetImage."+ja)}));U=decodeURIComponent(escape(U));if(v.a.wT)"undefined"!==typeof navigator.msSaveBlob?navigator.msSaveBlob(G,U):window.open(a);else{var h=window.URL||window.webkitURL,m=h.createObjectURL(G),y=document.createElement("a");y.href=m;y.download=U;document.body.appendChild(y);y.click();setTimeout(()=>{document.body.removeChild(y);h.revokeObjectURL(m)},0)}}catch(G){window.open(a)}};
c.send()}};var UP=d(549),uq=d(1215),xv;(function(a){a[a.automatic=1]="automatic";a[a.clear=2]="clear";a[a.themeColors=3]="themeColors";a[a.standardColors=4]="standardColors";a[a.recentColors=5]="recentColors"})(xv||(xv={}));Object(n.b)("ColorMenuControls",xv);class sx{constructor(a){this.ZTb=this.$Tb=null;this.Wvc={};this.n2=a}m8b(){this.ZTb=this.$Tb=null}CWf(a,b){if(this.ZTb)return this.ZTb;if(!a)return null;const c=Object.assign(new Mk.a,{Id:String.format("menu{0}Color",this.n2),ExternalId:String.format("{0}Color",
this.n2)});c.MenuSectionList=[];Array.add(c.MenuSectionList,this.F3h());Array.add(c.MenuSectionList,this.O3h());Array.add(c.MenuSectionList,this.d7h(a,b));Array.add(c.MenuSectionList,this.M6h());return this.ZTb=c}qBi(a,b){if(this.$Tb)return this.$Tb;a=this.CWf(a,b);return this.$Tb=gj.l(a)}lFc(a,b){xv[a]in this.Wvc||(this.Wvc[xv[a]]=b)}h7h(a){a.Zpf(Object(F.a)(this,this.m8b,"invalidateMenu"),1)}F3h(){if(!({actionId:b}=this.wsd(1)).returnValue)return null;const a=Object.assign(new di.a,{Id:String.format("{0}Color",
this.n2),ControlsId:String.format("{0}.Color.Menu.Controls",this.n2),DisplayMode:"Menu16",ControlList:[]});var b=Object.assign(new zf.a,{Command:b.toString(),LabelText:ta.a.pe(Box4Intl.Box4Strings.L_Automatic),Image16by16:u.AFrameworkApplication.qm,Image16by16Class:zp.getImageClass("Automatic_16x16x32"),Id:"automatic",KeyTip:CommonUIStrings.l_AutomaticKeytip});Array.add(a.ControlList,b);return a}O3h(){if(!({actionId:b}=this.wsd(2)).returnValue)return null;const a=Object.assign(new di.a,{Id:String.format("{0}Color",
this.n2),ControlsId:String.format("{0}.Color.Menu.Controls",this.n2),DisplayMode:"Menu16",ControlList:[]});var b=Object.assign(new zf.a,{Command:b.toString(),LabelText:ta.a.pe(Box4Intl.Box4Strings.L_BtnClearShading),Image16by16:u.AFrameworkApplication.qm,Image16by16Class:zp.getImageClass("NoHighlight_16x16x32"),Id:"clear",KeyTip:CommonUIStrings.l_NoHighlightKeytip});Array.add(a.ControlList,b);return a}d7h(a,b){if(!({actionId:h}=this.wsd(3)).returnValue)return null;const c=Object.assign(new di.a,{Id:"Colors",
ControlsId:String.format("{0}.Color.Menu.Controls",this.n2),ControlList:[]});var h=Object.assign(new Qy.a,{Id:String.format("Theme{0}ColorPicker",this.n2),ExternalId:String.format("Theme{0}ColorPicker",this.n2),McuExternalId:String.format("Theme{0}ColorPickerMCU",this.n2),McuLayout:!0,Command:h.toString(),Width:10});h.Colors=sx.Ukj(a,b);Array.add(c.ControlList,h);return c}M6h(){if(!({actionId:b}=this.wsd(4)).returnValue)return null;const a=Object.assign(new di.a,{Id:String.format("{0}Colors",this.n2),
ControlsId:String.format("{0}.Color.Menu.Controls",this.n2),Title:ta.a.pe(Box4Intl.Box4Strings.L_MenuStandardColors),ControlList:[]});var b=Object.assign(new Qy.a,{Id:String.format("Standard{0}ColorPicker",this.n2),ExternalId:String.format("Standard{0}ColorPicker",this.n2),Command:b.toString(),Width:10,Colors:[]});b.Colors=sx.Yij();Array.add(a.ControlList,b);return a}wsd(a){a=xv[a];return a in this.Wvc?{returnValue:!0,actionId:this.Wvc[a]}:{returnValue:!1,actionId:0}}static Yij(){const a=[];a.push(Object.assign(new uq.a,
{Color:"0000C0",Alt:ta.a.pe(Box4Intl.Box4Strings.L_FontColorDarkRed),DisplayColor:"#C00000"}));a.push(Object.assign(new uq.a,{Color:"0000FF",Alt:ta.a.pe(Box4Intl.Box4Strings.L_FontColorRed),DisplayColor:"#FF0000"}));a.push(Object.assign(new uq.a,{Color:"00C0FF",Alt:ta.a.pe(Box4Intl.Box4Strings.L_FontColorOrange),DisplayColor:"#FFC000"}));a.push(Object.assign(new uq.a,{Color:"00FFFF",Alt:ta.a.pe(Box4Intl.Box4Strings.L_FontColorYellow),DisplayColor:"#FFFF00"}));a.push(Object.assign(new uq.a,{Color:"50D092",
Alt:ta.a.pe(Box4Intl.Box4Strings.L_FontColorLightGreen),DisplayColor:"#92D050"}));a.push(Object.assign(new uq.a,{Color:"50B000",Alt:ta.a.pe(Box4Intl.Box4Strings.L_FontColorDarkGreen),DisplayColor:"#00B050"}));a.push(Object.assign(new uq.a,{Color:"F0B000",Alt:ta.a.pe(Box4Intl.Box4Strings.L_FontColorLightBlue),DisplayColor:"#00B0F0"}));a.push(Object.assign(new uq.a,{Color:"C07000",Alt:ta.a.pe(Box4Intl.Box4Strings.L_FontColorBlue),DisplayColor:"#0070C0"}));a.push(Object.assign(new uq.a,{Color:"602000",
Alt:ta.a.pe(Box4Intl.Box4Strings.L_FontColorDarkBlue),DisplayColor:"#002060"}));a.push(Object.assign(new uq.a,{Color:"A03070",Alt:ta.a.pe(Box4Intl.Box4Strings.L_FontColorPurple),DisplayColor:"#7030A0"}));return a}static Ukj(a,b){const c=a.properties.sa(jb.a.themeColors,null);a=a.properties.eb(jb.a.aBh).split(" ");const h=Array(10);h[0]=Box4Intl.Box4Strings.l_ThemeLabel1;h[1]=Box4Intl.Box4Strings.l_ThemeLabel2;h[2]=Box4Intl.Box4Strings.l_ThemeLabel3;h[3]=Box4Intl.Box4Strings.l_ThemeLabel4;h[4]=Box4Intl.Box4Strings.l_ThemeLabel5;
h[5]=Box4Intl.Box4Strings.l_ThemeLabel6;h[6]=Box4Intl.Box4Strings.l_ThemeLabel7;h[7]=Box4Intl.Box4Strings.l_ThemeLabel8;h[8]=Box4Intl.Box4Strings.l_ThemeLabel9;h[9]=Box4Intl.Box4Strings.l_ThemeLabel10;const m=[];for(let U=0;6>U;U++)for(let ja=0;10>ja;ja++){var y=10*U+ja,G=c[y];y=y+1<<24;G=G&4278190080|(G&255)<<16|G&65280|(G&16711680)>>>16;const va=sx.hrl(h,U,ja,b[a[ja]],c[ja]);m.push(Object.assign(new uq.a,{Color:ta.a.dw(y,8),DisplayColor:"#"+ta.a.dw(G,6),Alt:ta.a.pe(va)}))}return m}static hrl(a,
b,c,h,m){if(b){var y=m&255,G=(m&65280)>>>8;m=(m&16711680)>>>16;y=Math.floor((Math.min(Math.min(y,G),m)+Math.max(Math.max(y,G),m))/2);--b;y?255===y?(y=!0,b=[242,217,191,166,127][b]):204<y?(y=!1,b=[229,191,127,64,25][b]):51>y?(y=!0,b=[25,64,127,191,229][b]):(G=[51,102,153],m=[191,127],b=(y=b<G.length)?G[b]:m[b-G.length]):(y=!1,b=[127,166,191,217,242][b]);b=255-b;return String.format(y?Box4Intl.Box4Strings.l_ColorPickerTooltipTint:Box4Intl.Box4Strings.l_ColorPickerTooltipShade,h,a[c],Math.round(100*
b/255))}return String.format(Box4Intl.Box4Strings.l_ColorPickerTooltipBase,h,a[c])}}Object(n.a)(sx,"ColorMenu",null,[1068]);class ar{constructor(a){this.Vvc=null;this.EVh=a}get rVf(){this.Vvc||(this.Vvc=new sx(ar.hui),this.oDj(this.Vvc));return this.Vvc}oDj(a){a.lFc(1,D.a.lW);a.lFc(3,D.a.Ls);a.lFc(4,D.a.Ls);a.lFc(5,D.a.Ls);a.h7h(this.EVh)}vb(){const a=u.AFrameworkApplication.Ta;a.ya(D.a.sHb,xb.a.view,Object(F.a)(this,this.sHb,"populateFontColor"));a.he(D.a.sHb,1127)}sHb(a,b,c,h,m){if(1===c)return 32;
if(2===c&&!m)return 8;a=ar.Jk.odj(b);if(u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.hb.Np){b=this.rVf.CWf(a,Fc.App.xEf);if(!b)return 8;m.MenuItems=b}a=this.rVf.qBi(a,Fc.App.xEf);if(!a)return 8;m.PopulationXML=a;return 32}static Q8i(){return new ar(UP.a.instance)}static get instance(){return ar.Ht||(ar.Ht=ar.Q8i())}static get Jk(){return Pw.PageReader.instance}}ar.hui="Font";ar.Ht=null;Object(n.a)(ar,"FontColorActor",null,[]);class of{constructor(a){this.eha=this.$o=this.i2=null;this.OSb=
!1;this.Ig=na.InteractiveViewManager.instance.Rd;this.Sj=a;of.yS&&Bb.SelectionEditor.ek(a)&&(a=Bb.SelectionEditor.$sc(this.Sj),Bb.SelectionEditor.ek(a)?this.Sj=a:ba.ULS.sendTraceTag(41522313,324,15,"Should not reach here, the selectedContext should be textRangeContext after trimleadinglinebreak."));a=Bb.SelectionEditor.WNb(this.Sj);Bb.SelectionEditor.ek(a)&&(this.Sj=a)}get L8(){return this.i2||(this.i2=vb.a.instance.rb("Box4.IInternalLinkManager"))}get p6(){return this.$o||(this.$o=vb.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}get titleText(){return Box4Intl.Box4Strings.l_InsertLinkTitle}get Dcg(){return Box4Intl.Box4Strings.l_InsertLinkButtonText}dispose(){}FRf(a,
b,c){if(b!==this.Sj.Nb||a!==this.Sj.Qa)a=yd.SelectionFactory.V2(c,a,b),this.Ig.Lb.setSelection(a),this.Sj=Bb.SelectionEditor.WNb(a.Ua.clone())}MZf(a){let b,c,h,m;m=Ib.HyperlinkReader.w5b(this.Sj);c=this.Sj.Qa;h=this.Sj.Nb;b="";if(!m.length)return this.eha=a.substring(this.Sj.Qa,this.Sj.Nb),{returnValue:!0,Cmd:b,lOc:c,mOc:h,HVc:m};if(m[0].hyperlink){let y,G=0,U=Math.max(0,a.length-1),ja=0;for(let va=0;va<m.length;va++)m[va].Qa>=G&&({Qa:y,Nb:G}=of.Rt.l_(this.Sj,m[va]),U=Math.min(y,U),ja=Math.max(G,
ja));c=Math.min(U,c);h=Math.max(ja,h);this.eha=a.substring(c,h);c===U&&(b=m[0].hyperlink.url);return{returnValue:!0,Cmd:b,lOc:c,mOc:h,HVc:m}}return{returnValue:!1,Cmd:b,lOc:c,mOc:h,HVc:m}}wWc(a,b){if(this.Ig.so){var c=of.Gta?Ib.HyperlinkReader.w5b(this.Sj):Ib.HyperlinkReader.hC(this.Sj,!0);var h=this.Ig.Lb.Pa.mb;if(h){h=h.Ua;Ob.ParagraphReader.tm(h)&&(h=md.a.createTextRange(h.node,0,Ob.ParagraphReader.textLength(h.node)));if(of.yS&&Bb.SelectionEditor.ek(h)){var m=Bb.SelectionEditor.$sc(h);Bb.SelectionEditor.ek(m)?
h=m:ba.ULS.sendTraceTag(41522316,324,15,"Should not reach here, the selectedContext should be textRangeContext after trimleadinglinebreak.")}m=Bb.SelectionEditor.WNb(h);Bb.SelectionEditor.ek(m)&&(h=m);0===a||J.a.instance.ga(22)&&32!==u.AFrameworkApplication.Ta.mi(h,D.a.insertHyperlink,1,!0,null,null)||this.qNj(c)||!this.Sj.equals(h)?this.Ig.KR():(Te.a.mark(5562),J.a.instance.ga(50)&&Fc.App.Ih&&Fc.App.Ih.lw&&this.Ig.Lb.qXb(),a=new t.GraphTransaction(15),a.kd(this.Sj.node),this.Sj.node.UG().graphTransactionOperations.xia(4),
h=b.txtDisplay,b=b.txtLink.trim(),this.insertLink(h,b,c),a.dispose(),Te.a.mark(5563),this.M2())}else ba.ULS.sendTraceTag(41522314,324,50,"InsertLinkDialog:InsertLinkDialogHandler - CurrentSelection is null.")}}qNj(a){return of.Gta?!1:1<a.length||1===a.length&&(a[0].Qa>this.Sj.Qa||a[0].Nb<this.Sj.Nb)}insertLink(a,b,c){var h=null;a||(a=b);if(b&&(!c.length||b!==c[0].hyperlink.url)){b=Ib.HyperlinkReader.ZDa(b);var m="";this.L8&&({wgh:m}=this.L8.MCh(b,!1)).returnValue&&(b=m)}this.OSb||(a=of.hyperlinkEditor.nWk(a));
if((!c.length||of.Gta)&&b)(h=0<c.length)&&of.Rt.tJb(this.Sj,c),c=!0,of.BNj&&(c=Ob.ParagraphReader.text(this.Sj.node).substring(this.Sj.Qa,this.Sj.Nb)!==a),c&&of.characterPropertiesEditor.replaceTextRange(this.Sj,a,!0),c=md.a.createTextRange(this.Sj.node,this.Sj.Qa,this.Sj.Qa+a.length),of.hyperlinkEditor.Zia(c,b,h,!1),h=yd.SelectionFactory.Qg(this.Sj.node,this.Sj.Qa+a.length);else if(0<c.length){m=c[0];let y;const G=({Qa:c,Nb:y}=of.Rt.l_(this.Sj,m)).returnValue;if(b)if(m.hyperlink.vTa){if(b!==m.hyperlink.url)if(of.Tf.MNb){let U=
md.a.createTextRange(this.Sj.node,c,c+a.length);of.hyperlinkEditor.uOi(U,m.hyperlink,b)}else of.Rt.bGh(b,G);a!==this.eha&&(of.Rt.vDe()&&of.Rt.tJb(this.Sj,G),of.characterPropertiesEditor.replaceTextRange(md.a.createTextRange(this.Sj.node,c,y),a,!0),h=md.a.createTextRange(this.Sj.node,c,c+a.length),of.Rt.vDe()&&of.hyperlinkEditor.Zia(h,b,!1),h=yd.SelectionFactory.Qg(this.Sj.node,c+a.length))}else of.Rt.tJb(this.Sj,G),of.characterPropertiesEditor.replaceTextRange(md.a.createTextRange(this.Sj.node,c,
y),a,!0),h=md.a.createTextRange(this.Sj.node,c,c+a.length),of.hyperlinkEditor.Zia(h,b,!1),h=yd.SelectionFactory.Qg(this.Sj.node,c+a.length);else of.hyperlinkEditor.sM(m.paragraph,m.hyperlink)}h&&this.Ig.Lb.setSelection(h)}static get hyperlinkEditor(){return of.yn||(of.yn=vb.a.instance.resolve("Box4.IHyperlinkEditor"))}static get characterPropertiesEditor(){return of.Zg||(of.Zg=vb.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static get Tf(){return of.fd||(of.fd=vb.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static get Rt(){return of.uD||
(of.uD=vb.a.instance.resolve("Box4.IHyperlinkStrategy"))}static get Gta(){null==of.y1a&&(of.y1a=u.AFrameworkApplication.fa?u.AFrameworkApplication.fa.ka("HyperlinkExpandEditEnabled"):!1);return of.y1a}static get BNj(){null==of.wCd&&(of.wCd=u.AFrameworkApplication.fa?u.AFrameworkApplication.fa.ka("KeepHyperlinkFormatFixIsEnabled"):!1);return of.wCd}static get pab(){null==of.k3a&&(of.k3a=u.AFrameworkApplication.fa?u.AFrameworkApplication.fa.ka("HyperlinkUrlValidationIsEnabled"):!1);return of.k3a}static get yS(){null==
of.PM&&(of.PM=u.AFrameworkApplication.fa?u.AFrameworkApplication.fa.ka("AddHyperlinkWhenSelectionContainsLineBreak"):!1);return of.PM}}of.yn=null;of.Zg=null;of.fd=null;of.uD=null;of.y1a=null;of.wCd=null;of.k3a=null;of.PM=null;of.source="Source";of.MEf="CommandingInterface";of.D7a="DisplayText";of.url="Url";of.id="InsertLinkDialog";Object(n.a)(of,"AInsertLinkDialog",null,[106]);class tx{static get qg(){return Nh.a.gC(tx.ro,Box4Intl.Box4Strings.l_InsertLinkDisplayText,Box4Intl.Box4Strings.l_InsertLinkAddress)}}
tx.ro="<div class='WACDialogRow' id='block2'> <label id='label2' class='WACDialogLabel' for='txtDisplay' >{0}</label> <input type='text' id='txtDisplay' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='block1'> <label id='label1' class='WACDialogLabel' for='txtLink' >{1}</label> <input type='text' id='txtLink' class='WACDialogInput' autocomplete=\"off\"/> </div>";Object(n.a)(tx,"InsertLinkDialogHtml",null,[]);class GI extends of{constructor(a,b){super(a,b);this.zf=
new Nh.a;this.zf.ig=of.id;var c=this.eha="";const h=Ob.ParagraphReader.text(this.Sj.node);let m=this.Sj.Qa,y=this.Sj.Nb,G;of.Gta?{Cmd:c,lOc:m,mOc:y,HVc:G}=this.MZf(h):(G=Ib.HyperlinkReader.hC(this.Sj,!0),1===G.length&&G[0].Qa<=this.Sj.Qa&&G[0].Nb>=this.Sj.Nb&&G[0].hyperlink?(this.eha=of.Rt.WRc(a,G[0],h),c=G[0].hyperlink.url):G.length||(this.eha=h.substring(this.Sj.Qa,this.Sj.Nb)));(b=Object(ua.a)(Object,b))&&(b[of.source]&&b[of.source]===of.MEf||b[of.url]&&b[of.D7a])?this.insertLink(b[of.D7a],b[of.url],
G):(of.Gta&&G[0]&&this.FRf(m,y,G[0].paragraph),this.zf.qg=tx.qg,""===c.trim()&&this.zf.Xe(1,this.Dcg),c={["txtLink"]:c,["txtDisplay"]:this.eha},this.zf.sMc=Object(F.a)(this,this.sN,"dialogDefaultEnterKeyHandler"),this.zf.rMc=Object(F.a)(this,this.sN,"dialogDefaultEnterKeyHandler"),this.zf.$i(this.titleText,Object(F.a)(this,this.wWc,"insertLinkDialogHandler"),c),of.pab&&(c=document.getElementById("txtLink"),wd.a.addHandler(c,ra.a.input,Object(F.a)(this,this.VIa,"onLinkChanged")),wd.a.addHandler(c,
ra.a.change,Object(F.a)(this,this.VIa,"onLinkChanged"))),document.getElementById("txtLink").focus(),of.yS?0<Ud.h(md.a.xQa(m,y,!1,this.Sj.node)).length&&(this.OSb=!0,document.getElementById("txtDisplay").disabled=!0):1>=G.length&&of.Rt.iVd(a,G[0],1===G.length)&&(this.OSb=!0,document.getElementById("txtDisplay").disabled=!0))}VIa(){if(this.zf){const a=document.getElementById("txtLink");this.zf.cD(1,!a||!a.value.length||Ib.HyperlinkReader.jle(a.value))}}sN(a){return this.zf?of.pab?this.zf.UXf(this.zf.cnb)?
this.zf.sN(a):!1:this.zf.sN(a):!1}M2(){if(of.pab){const a=document.getElementById("txtLink");a&&(wd.a.removeHandler(a,ra.a.change,Object(F.a)(this,this.VIa,"onLinkChanged")),wd.a.removeHandler(a,ra.a.input,Object(F.a)(this,this.VIa,"onLinkChanged")))}this.zf&&(this.zf=null)}}Object(n.a)(GI,"InsertLinkDialog",of,[]);class HI extends of{constructor(a,b,c){super(a,b);const h=new Nh.a(!1,!1,!0),m={};m.displayTextLabel=Box4Intl.Box4Strings.l_InsertLinkDisplayText;m.addressLabel=Box4Intl.Box4Strings.l_InsertLinkAddress;
m.textDisplayInitialFocus=c;c=this.eha="";const y=Ob.ParagraphReader.text(this.Sj.node);let G=this.Sj.Qa,U=this.Sj.Nb,ja;of.Gta?{Cmd:c,lOc:G,mOc:U,HVc:ja}=this.MZf(y):(ja=Ib.HyperlinkReader.hC(this.Sj,!0),1===ja.length&&ja[0].Qa<=this.Sj.Qa&&ja[0].Nb>=this.Sj.Nb&&ja[0].hyperlink?(this.eha=of.Rt.WRc(a,ja[0],y),c=ja[0].hyperlink.url):ja.length||(this.eha=y.substring(this.Sj.Qa,this.Sj.Nb)));(b=Object(ua.a)(Object,b))&&(b[of.source]&&b[of.source]===of.MEf||b[of.url]&&b[of.D7a])?this.insertLink(b[of.D7a],
b[of.url],ja):(of.Gta&&ja[0]&&this.FRf(G,U,ja[0].paragraph),b=CommonUIStrings.l_DialogOk,""===c.trim()&&(b=this.Dcg),h.Xe(1,b),m.txtLink=c,m.txtDisplay=this.eha,of.yS?0<Ud.h(md.a.xQa(G,U,!1,this.Sj.node)).length&&(this.OSb=!0,m.textDisplayDisabled=!0):1>=ja.length&&of.Rt.iVd(a,ja[0],1===ja.length)&&(this.OSb=!0,m.textDisplayDisabled=!0),a={["id"]:of.id,["bodyControls"]:m},h.$i(this.titleText,Object(F.a)(this,this.wWc,"insertLinkDialogHandler"),a))}M2(){}}Object(n.a)(HI,"ReactInsertLinkDialog",of,
[]);class cu{constructor(){this.Vpa=!!u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.hb.uC}$Hf(a,b,c){this.Vpa?new HI(a,b,c):new GI(a,b)}static get instance(){return cu.Ka||(cu.Ka=new cu)}}cu.Ka=null;Object(n.a)(cu,"InsertLinkDialogFactory",null,[1069]);class Pk extends Nh.a{constructor(a){super();this.AK=a;this.Ig=na.InteractiveViewManager.instance.Rd;this.JCc=this.Ig.Lb.Pa.mb;this.u2d=a[0].Qa;this.Mle=a[a.length-1].Nb;this.ig="InsertMultiParagraphLinkDialog";a=this.pyl();this.showDialog("",
a)}showDialog(a,b){ba.ULS.sendTraceTag(41261264,324,50,"Insert multiple paragraph link dialog shows.");this.qg=tx.qg;""===b.trim()&&this.Xe(1,Box4Intl.Box4Strings.l_InsertLinkButtonText);a={["txtLink"]:b,["txtDisplay"]:a};this.$i(Box4Intl.Box4Strings.l_InsertLinkTitle,Object(F.a)(this,this.wWc,"insertLinkDialogHandler"),a);document.getElementById("txtLink").focus();document.getElementById("txtDisplay").disabled=!0;Pk.pab&&(a=document.getElementById("txtLink"),wd.a.addHandler(a,ra.a.input,Object(F.a)(this,
this.VIa,"onLinkChanged")),wd.a.addHandler(a,ra.a.change,Object(F.a)(this,this.VIa,"onLinkChanged")))}hide(){if(Pk.pab){const a=document.getElementById("txtLink");a&&(wd.a.removeHandler(a,ra.a.change,Object(F.a)(this,this.VIa,"onLinkChanged")),wd.a.removeHandler(a,ra.a.input,Object(F.a)(this,this.VIa,"onLinkChanged")))}super.hide()}VIa(){const a=document.getElementById("txtLink");this.cD(1,!a||!a.value.length||Ib.HyperlinkReader.jle(a.value))}sN(a){return Pk.pab?this.UXf(this.cnb)?super.sN(a):!1:
super.sN(a)}pyl(){let a;let b;a="";const c=this.AK.length,h=Ib.HyperlinkReader.hC(this.AK[0],!1);0<h.length&&({Qa:m,Nb:b}=Pk.Rt.l_(this.AK[0],h[0]),m<=this.AK[0].Qa&&(a=h[0].hyperlink.url),this.u2d=Math.min(this.u2d,m));var m=Ib.HyperlinkReader.hC(this.AK[c-1],!1);0<m.length&&({Qa:m,Nb:b}=Pk.Rt.l_(this.AK[c-1],m[m.length-1]),this.Mle=Math.max(this.Mle,b));this.Atl(this.u2d,this.Mle);return a}Atl(a,b){const c=this.AK.length;if(a!==this.AK[0].Qa||b!==this.AK[c-1].Nb){a=md.a.Kj(this.AK[0].node,a);a=
yd.SelectionFactory.wu(a);b=md.a.Kj(this.AK[c-1].node,b);b=yd.SelectionFactory.wN(a,b);a=this.I5f(b.Ua.clone());const h=this.I5f(b.Ye.clone());a&&h&&(this.AK[0]=a,this.AK[c-1]=h,this.Ig.Lb.setSelection(b),this.JCc=b)}}wWc(a,b){if(this.Ig.so){var c=this.Ig.Lb.Pa.mb;if(c)if(c.equals(this.JCc)&&0!==a){a=new t.GraphTransaction(15);a.kd(this.AK[0].node);for(c=0;c<this.AK.length;c++)this.AK[c].node.UG().graphTransactionOperations.xia(4);b=b.txtLink.trim();this.tJi();this.QEj(b);this.hide();a.dispose()}else this.Ig.KR()}}QEj(a){if(a){a=
Ib.HyperlinkReader.ZDa(a);for(let c=0;c<this.AK.length;c++){var b=this.AK[c];if(Pk.yS&&Bb.SelectionEditor.ek(b)&&(b=Bb.SelectionEditor.$sc(b),!Bb.SelectionEditor.ek(b)))continue;b=md.a.createTextRange(this.AK[c].node,b.Qa,b.Nb);Pk.hyperlinkEditor.Zia(b,a,!1)}}}I5f(a){return Ob.ParagraphReader.tm(a)&&!Bb.SelectionEditor.RW(a)&&Ob.ParagraphReader.textLength(a.node)?md.a.createTextRange(a.node,0,Ob.ParagraphReader.textLength(a.node)):Bb.SelectionEditor.ek(a)?a:null}tJi(){let a=!1;for(const b of this.AK){const c=
Ib.HyperlinkReader.hC(b,!1);c&&(a=Pk.Rt.tJb(b,c)||a)}}static get Rt(){return Pk.uD||(Pk.uD=vb.a.instance.resolve("Box4.IHyperlinkStrategy"))}static get Tf(){return Pk.fd||(Pk.fd=vb.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static get hyperlinkEditor(){return Pk.yn||(Pk.yn=vb.a.instance.resolve("Box4.IHyperlinkEditor"))}static get yS(){null==Pk.PM&&(Pk.PM=u.AFrameworkApplication.fa?u.AFrameworkApplication.fa.ka("AddHyperlinkWhenSelectionContainsLineBreak"):!1);return Pk.PM}static get pab(){null==
Pk.k3a&&(Pk.k3a=u.AFrameworkApplication.fa?u.AFrameworkApplication.fa.ka("HyperlinkUrlValidationIsEnabled"):!1);return Pk.k3a}}Pk.uD=null;Pk.fd=null;Pk.yn=null;Pk.PM=null;Pk.k3a=null;Object(n.a)(Pk,"InsertMultiParagraphLinkDialog",Nh.a,[]);class Be{static get aj(){return Dc.a.instance}static get hyperlinkEditor(){return Be.yn||(Be.yn=vb.a.instance.resolve("Box4.IHyperlinkEditor"))}static get Rt(){return Be.uD||(Be.uD=vb.a.instance.resolve("Box4.IHyperlinkStrategy"))}static Zq(){return Be.Hm||(Be.Hm=
vb.a.instance.Ja("Box4.IExternalSelectionManager"))}static get Tf(){return Be.fd||(Be.fd=vb.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static get Usc(){return Be.BD||(Be.BD=vb.a.instance.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance)}static get VOb(){null==Be.hvd&&(Be.hvd=u.AFrameworkApplication.fa?u.AFrameworkApplication.fa.ka("ViewAndOpenImageHyperlinksIsEnabled"):!1);return Be.hvd}static get Gta(){null==Be.y1a&&(Be.y1a=u.AFrameworkApplication.fa?
u.AFrameworkApplication.fa.ka("HyperlinkExpandEditEnabled"):!1);return Be.y1a}static get zic(){null==Be.z1a&&(Be.z1a=u.AFrameworkApplication.fa?u.AFrameworkApplication.fa.ka("MultiParagraphHyperlinkEditEnabled"):!1);return Be.z1a}static get yS(){null==Be.PM&&(Be.PM=u.AFrameworkApplication.fa?u.AFrameworkApplication.fa.ka("AddHyperlinkWhenSelectionContainsLineBreak"):!1);return Be.PM}static vb(){const a=u.AFrameworkApplication.Ta;a.ya(D.a.insertHyperlink,xb.a.view,Be.Axb);a.ya(D.a.insertHyperlink,
xb.a.Of,Be.insertLink);a.ya(D.a.insertHyperlink,xb.a.textRange,Be.insertLink);a.he(D.a.insertHyperlink,1028);a.ya(D.a.sM,xb.a.view,Be.Axb);a.ya(D.a.sM,xb.a.Of,Be.ahh);a.ya(D.a.sM,xb.a.textRange,Be.ahh);a.he(D.a.sM,1028);a.ya(D.a.hmd,xb.a.view,Be.Axb);a.ya(D.a.hmd,xb.a.Of,Be.Inh);a.ya(D.a.hmd,xb.a.textRange,Be.Inh);a.ya(D.a.ZIa,xb.a.view,Be.Axb);a.ya(D.a.ZIa,xb.a.Of,Be.x7g);a.ya(D.a.ZIa,xb.a.textRange,Be.x7g);a.ya(D.a.ZIa,xb.a.image,Be.vHe);a.ya(D.a.ZIa,xb.a.I3b,Be.vHe);a.ya(D.a.B7b,xb.a.view,Be.Axb);
a.ya(D.a.B7b,xb.a.Of,Be.linkText);a.ya(D.a.B7b,xb.a.textRange,Be.linkText);a.he(D.a.B7b,1028);Be.VOb&&a.ya(D.a.ZIa,xb.a.anchoredObject,Be.vHe);a.ya(D.a.mKc,xb.a.view,Be.Axb)}static Axb(a,b,c,h,m){if(Be.zic)return Be.Myj(a,b,c,h,m);if(!b.view.Mh)return 2;var y=b.view.Lb;if(!y||!y.Pa||!y.Pa.length)return 8;var G=y.Pa.mb;let U=G.Ua.clone();if(2===G.length){if(G=G.ga(1),!Bb.SelectionEditor.ek(U)||!Bb.SelectionEditor.Wl(G)||U.node!==G.node)return 8}else if(2<G.length)return 8;if(y.Pa.eH)return 8;Ob.ParagraphReader.tm(U)&&
!Bb.SelectionEditor.RW(U)&&(y=U.node,U=md.a.createTextRange(y,0,Ob.ParagraphReader.textLength(y)));return a===D.a.mKc?Be.LGf(b,U,c,h,m):u.AFrameworkApplication.Ta.mi(U,a,c,!0,h,m)}static Myj(a,b,c,h,m){if(!b.view.Mh)return 2;var y=b.view.Lb;if(!y||!y.Pa||!y.Pa.length||y.Pa.eH)return 8;var G=y.Pa.mb;if(y=Be.f$b(G))G=Be.y9d(G.Ua.clone(),!0);else{let U=G.ga(0).clone(),ja=1;for(;ja<G.length&&(!Ob.ParagraphReader.textLength(U.node)||Bb.SelectionEditor.Wl(U)||Be.yS&&Ud.m(U));)U=G.ga(ja).clone(),ja++;G=
Be.y9d(U,!1)}return Be.yS&&Bb.SelectionEditor.ek(G)&&Ud.m(G)||!Bb.SelectionEditor.ek(G)&&!y?8:a===D.a.mKc?Be.LGf(b,G,c,h,m):u.AFrameworkApplication.Ta.mi(G,a,c,!0,h,m)}static f$b(a){if(1===a.length)return!0;if(2===a.length){const b=a.Ua.clone();a=a.ga(1);return Bb.SelectionEditor.ek(b)&&Bb.SelectionEditor.Wl(a)&&b.node===a.node?!0:!1}return!1}static pFf(a){let b;b=null;const c=[];for(let h=0;h<a.length;h++){const m=Be.y9d(a.ga(h).clone(),!1);if(Bb.SelectionEditor.ek(m))Be.yS&&Ud.m(m)||Array.add(c,
m);else if(!Bb.SelectionEditor.Wl(m)&&!Ob.ParagraphReader.tm(m))return{returnValue:!1,CVd:b}}b=Ma.a.xNb(c);return{returnValue:!Be.yS||0<b.length?!0:!1,CVd:b}}static Kcg(a,b,c,h){if(Be.zic)return Be.VEj(a,b,c,h);if(!Be.KSd()||!Be.lIc(a)||me.a.instance.Pa.eH)return 8;if(Be.VOb&&Bb.SelectionEditor.dFa(a))return 2;let m;if(!({hyperlink:m}=Be.TUa(a,!0)).returnValue||Be.XJc())return 8;if(1===b)return 32;if(!m&&Bb.SelectionEditor.Sg(a)&&Bb.SelectionEditor.wzb(a)&&(b=Bb.SelectionEditor.DRa(a,!1))&&(me.a.instance.setSelection(b),
a=b.Ua,Be.XJc()))return 8;cu.instance.$Hf(a,c,h);return 32}static VEj(a,b,c,h){var m=me.a.instance.Pa.mb;const y=Be.f$b(m);if(y)a=[a];else if(!({CVd:a}=Be.pFf(m)).returnValue)return 8;if(!Be.KSd())return 8;for(m=0;m<a.length;m++)if(!Be.lIc(a[m]))return 8;if(me.a.instance.Pa.eH)return 8;m=Array(a.length);let G=null;for(let U=0;U<a.length;U++)if(m[U]=a[U],!({hyperlink:G}=Be.TUa(m[U],!0)).returnValue||Be.XJc())return 8;if(h&&!Be.xVj(m[0]))return 8;if(1===b)return 32;if(!G&&1===m.length&&y&&Bb.SelectionEditor.Sg(m[0])&&
Bb.SelectionEditor.wzb(m[0])&&(b=Bb.SelectionEditor.DRa(m[0],!1))&&(me.a.instance.setSelection(b),m[0]=b.Ua,Be.XJc()))return 8;y?cu.instance.$Hf(m[0],c,h):new Pk(m,c);return 32}static insertLink(a,b,c,h,m){return Be.Kcg(b,c,m,!1)}static linkText(a,b,c,h,m){return Be.Kcg(b,c,m,!0)}static ahh(a,b,c){if(Be.zic)return Be.iSk(a,b,c);if(!Be.lIc(b)||Be.VOb&&Bb.SelectionEditor.dFa(b))return 2;let h;if(!({hyperlink:h}=Be.TUa(b,!1)).returnValue)return 2;if(2===c){c=new t.GraphTransaction(15);try{c.jd=a,c.kd(h.paragraph),
Be.Gta?Be.phh(b):Be.Rt.sM(b,h)}finally{c&&c.dispose()}}return 32}static iSk(a,b,c){var h=me.a.instance.Pa.mb;if(Be.f$b(h))b=[b];else if(!({CVd:b}=Be.pFf(h)).returnValue)return 8;if(!Be.KSd())return 8;for(h=0;h<b.length;h++)if(!Be.lIc(b[h]))return 8;if(1===c&&!Be.TUa(b[0],!1).returnValue)return 2;if(2===c){for(c=0;c<b.length;c++)if(!Be.TUa(b[c],!0).returnValue)return 2;c=new t.GraphTransaction(15);try{let m=b[0];c.jd=a;c.kd(m.node);for(a=0;a<b.length;a++)Be.phh(b[a])}finally{c&&c.dispose()}}return 32}static phh(a){const b=
Ib.HyperlinkReader.w5b(a);let c=0;for(let h=0;h<b.length;h++)if(b[h].Qa>=c){const m=({Nb:c}=Be.Rt.l_(a,b[h])).returnValue;Be.Rt.tJb(a,m)}}static Inh(a,b,c){if(Be.VOb&&aa.ImageReader.qyb(b)||!({hyperlink:a}=Be.TUa(b,!1)).returnValue)return 2;2===c&&({Qa:b,Nb:c}=Be.Rt.l_(b,a),me.a.instance.setSelection(yd.SelectionFactory.V2(a.paragraph,b,c)));return 32}static x7g(a,b,c){let h;if(Be.VOb&&({hyperlink:h}=Be.lVj(b)).returnValue)ba.ULS.sendTraceTag(50934737,324,50,"Logging for image blob object with hyperlink");
else if(!({hyperlink:h}=Be.TUa(b,!1)).returnValue)return 2;2===c&&Fc.App.Q3b(h.hyperlink.url);return 32}static vHe(a,b,c){a=aa.ImageReader.l_(b.node);if(!a)return 2;2===c&&Fc.App.Q3b(a);return 32}static LGf(a,b,c,h,m){if(Be.VOb&&aa.ImageReader.qyb(b))return 2;const y=na.InteractiveViewManager.instance.editingView;if(!y.Vl)return 2;let G;if(!({hyperlink:G}=Be.TUa(b,!1)).returnValue)return 2;if(1===c)return 32;({Qa:b,Nb:c}=Be.Rt.l_(b,G));me.a.instance.setSelection(yd.SelectionFactory.V2(G.paragraph,
b,c));var U=y.ownerDocument;c=y.Qn;b=new rc.a(c);La.a.tu(c);U=U.createElement("span");c.appendChild(U);U.innerText=G.hyperlink.url;y.oKa();y.i9k();a=u.AFrameworkApplication.Ta.mi(a,D.a.copy,2,!0,h,m);b.restore();return a}static TUa(a,b){let c;c=null;if(Bb.SelectionEditor.ek(a)){var h=Ud.h(a);const m=Ma.a.all(h,y=>6===y.Sq);if(0<h.length&&(!Be.yS||!m))return{returnValue:!1,hyperlink:c}}if(Be.Gta)return Be.hVj(a,b);h=Ib.HyperlinkReader.hC(a,!0);return 1===h.length&&h[0].Qa<=a.Qa&&h[0].Nb>=a.Nb&&h[0].hyperlink?
(c=h[0],{returnValue:!0,hyperlink:c}):{returnValue:!h.length&&b,hyperlink:c}}static lVj(a){let b;b=null;return aa.ImageReader.qyb(a)&&(b=Ib.HyperlinkReader.YRc(a))?{returnValue:!0,hyperlink:b}:{returnValue:!1,hyperlink:b}}static hVj(a,b){let c;c=null;const h=Ib.HyperlinkReader.w5b(a);return h.length?h[0].hyperlink?(c=h[0],a.Qa<h[0].Qa?{returnValue:b,hyperlink:c}:{returnValue:!0,hyperlink:c}):{returnValue:!1,hyperlink:c}:{returnValue:b,hyperlink:c}}static xVj(a){if(Bb.SelectionEditor.ek(a)){var b=
Ud.h(a),c=Ma.a.all(b,h=>6===h.Sq);if(0<b.length&&!c)return!1}b=Ib.HyperlinkReader.hC(a,!0);if(!(1===b.length&&b[0].Qa<=a.Qa&&b[0].Nb>=a.Nb&&b[0].hyperlink))return!1;c=Ob.ParagraphReader.text(a.node);a=Be.Rt.WRc(a,b[0],c);return!(0<=a.indexOf("\r")||0<=a.indexOf("\n")||0<=a.indexOf("\x0B")||0<=a.indexOf("\ufffc"))}static XJc(){if(Be.Tf.hg)for(let a=0;a<null.count;++a)if(2===null.ga(a).cHl.changeType)return!0;return!1}static KSd(){return Be.Tf.hg?!0:!J.a.instance.ga(45)||!Fc.App.HD.NNb}static lIc(a){return J.a.instance.ga(14)&&
Be.aj.Z6a(a)||Be.Zq()&&Be.Zq().instance&&Be.Zq().instance.UW(a)?!1:!0}static y9d(a,b){return Ob.ParagraphReader.tm(a)&&!Bb.SelectionEditor.RW(a)&&(Ob.ParagraphReader.textLength(a.node)||b)?md.a.createTextRange(a.node,0,Ob.ParagraphReader.textLength(a.node)):a}}Be.yn=null;Be.uD=null;Be.Hm=null;Be.fd=null;Be.BD=null;Be.hvd=null;Be.y1a=null;Be.z1a=null;Be.PM=null;Object(n.a)(Be,"HyperlinkActor",null,[]);class Jg{static get uv(){return kv.a.vwb}static get jm(){return tg.ContextSetEditor.instance}static get aj(){return Dc.a.instance}static get Wc(){return ec.a.instance}static Zq(){return Jg.Hm||
(Jg.Hm=vb.a.instance.Ja("Box4.IExternalSelectionManager"))}static get paragraphEditor(){return Jg.Rw||(Jg.Rw=vb.a.instance.resolve("Box4.IParagraphEditor"))}static get u5(){return Jg.pr||(Jg.pr=vb.a.instance.resolve("Box4.IParagraphReader"))}static get nM(){return Jg.yG||(Jg.yG=vb.a.instance.resolve("Box4.IParagraphIndentationReader"))}static get Pwk(){return Jg.paragraphEditor.uv}static get Sf(){return Jg.Ug||(Jg.Ug=vb.a.instance.resolve("Box4.List.IListReader"))}static vb(){const a=u.AFrameworkApplication.Ta;
a.ya(D.a.qz,xb.a.view,Jg.wvf);a.ya(D.a.qz,xb.a.outlineElement,Jg.vvf);a.he(D.a.qz,1028);a.ya(D.a.MD,xb.a.view,Jg.wvf);a.ya(D.a.MD,xb.a.outlineElement,Jg.vvf);a.he(D.a.MD,1028)}static wvf(a,b,c,h,m){var y=b.view;if(!y.Mh)return 2;const G=y.Lb;if(!G)return Jg.Wc.Wb(Ed.a.wh,{["Reason"]:Cd.a.$ma}),8;var U=G.Qj;if(!U)return Jg.Wc.Wb(Ed.a.wh,{["Reason"]:Cd.a.noSelection}),8;if(J.a.instance.ga(62)&&1===c)return 32;if(J.a.instance.ga(11)&&Jg.jm.Sra(Jg.aPd,U))return Jg.Wc.Wb(Ed.a.wh,{["Reason"]:Cd.a.X_b}),
8;if(J.a.instance.ga(14)&&Jg.aj.RXc(U))return Jg.Wc.Wb(Ed.a.wh,{["Reason"]:Cd.a.LD}),8;if(Jg.Zq()&&Jg.Zq().instance&&Jg.Zq().instance.UW(U))return Jg.Wc.Wb(Ed.a.wh,{["Reason"]:Cd.a.externalSelection}),8;U={};U[$h.epa]=5794;U[$h.dpa]=5795;let ja=2;if(u.AFrameworkApplication.fa.ka("Box4PartialPromoteDemoteIsEnabled")){y=Jg.aBf(a===D.a.qz,b,!0);if(1===c)return y?32:8;y&&(ja=$h.Rgb(a,b,c,h,m,U))}else ja=$h.Rgb(a,b,1,h,m,U),1!==c&&32===ja?(y.Lb.TGe(),y=new t.GraphTransaction(15),y.kd(b.view.yg),ja=Jg.aBf(a===
D.a.qz,b,!1)?$h.Rgb(a,b,c,h,m,U):8,y.dispose()):1!==c&&8===ja&&(y.Lb.TGe(),Jg.hvi(a,b,G));return ja}static aBf(a,b,c){b=b.view.Lb;if(!b||!b.Pa.mb)return Jg.Wc.Wb(Ed.a.wh,{["Reason"]:Cd.a.Hcd}),!1;if(b.Pa.eH)return Jg.Wc.Wb(Ed.a.wh,{["Reason"]:Cd.a.QFf}),!1;b=pi.Vsa(b.Pa,!1);if(!b)return Jg.Wc.Wb(Ed.a.wh,{["Reason"]:Cd.a.BOc}),!1;let h=!1;for(let m=0;m<b.length;m++){const y=b.getContext(m),G=new rb.GraphIterator;G.set(y.node);Bb.SelectionEditor.xt(G);if(!Kd.OutlineElementReader.Wg(G))if(c)continue;
else return Jg.Wc.Wb(Ed.a.wh,{["Reason"]:Cd.a.zca}),!1;if(a?!Jg.uv.qsb(G):!Jg.uv.iIc(G))if(c)continue;else return Jg.Wc.Wb(Ed.a.Q1b,{["Reason"]:Cd.a.zBf}),!1;h=!0}return c?h:!0}static vvf(a,b,c,h,m){if(b.contextId!==xb.a.outlineElement)return 2;if(J.a.instance.ga(14))if(h=b.clone().VXe(),rd.TableReader.Ckg(h)){if(Jg.aj.Dkg(h))return Jg.Wc.Wb(Ed.a.To,{["Reason"]:Cd.a.LD}),8}else if(Jg.aj.mFa(h))return Jg.Wc.Wb(Ed.a.To,{["Reason"]:Cd.a.LD}),2;h=new rb.GraphIterator;h.set(b.node);Bb.SelectionEditor.xt(h);
if(!Kd.OutlineElementReader.Wg(h))return 2;switch(a){case D.a.qz:b=Jg.uv.qsb(h);break;case D.a.MD:b=Jg.uv.iIc(h);break;default:return 2}if(1===c||!b)return b?32:8;c=0;a===D.a.MD&&m&&m.sa(xc.a.Twf,!1)&&(c|=2);switch(a){case D.a.qz:Jg.uv.uhb(h,-1,c);break;case D.a.MD:Jg.uv.eMc(h,1)}return 32}static hvi(a,b,c){const h=new t.GraphTransaction(15);try{h.kd(b.view.yg);b=!0;var m=pi.Vsa(c.Pa,!1);for(let y=0;y<m.length;y++){const G=m.getContext(y);let U=new rb.GraphIterator;U.set(G.node);Bb.SelectionEditor.xt(U);
if(!Kd.OutlineElementReader.Wg(U))b=!1;else if(a===D.a.qz?Jg.uv.qsb(U):Jg.uv.iIc(U))switch(b=!1,a){case D.a.qz:Jg.uv.uhb(U,-1,0);break;case D.a.MD:Jg.uv.eMc(U,1)}}if(b){const y=c.Pa.mb;for(c=0;c<y.length;c++){const G=y.ga(c);if(G.el){const U=Jg.nM.kwb(G.node),ja=U.xMb;if(a===D.a.qz?U.LN>ja:U.LN<18*ja){let va=new rb.GraphIterator;va.set(G.node);m=ja;m=a===D.a.qz?U.LN>=2.5*ja?U.LN-2*ja:ja:U.LN<16*ja?U.LN+2*ja:18*ja;Jg.Pwk.mjb(va,1,m)}}}}}finally{h&&h.dispose()}}}Jg.Hm=null;Jg.Rw=null;Jg.pr=null;Jg.yG=
null;Jg.Ug=null;Jg.aPd=aa.ImageReader.pyb;Object(n.a)(Jg,"IndentationActor",null,[]);class gg{static get Rbe(){return gg.Qnb||(gg.Qnb=vb.a.instance.resolve("Box4.Images.IImageEditor"))}static get paragraphEditor(){return gg.Rw||(gg.Rw=vb.a.instance.resolve("Box4.IParagraphEditor"))}static get Oq(){return gg.AD||(gg.AD=vb.a.instance.resolve("Box4.ITableEditor"))}static get aj(){return Dc.a.instance}static get Wc(){return ec.a.instance}static Zq(){return gg.Hm||(gg.Hm=vb.a.instance.Ja("Box4.IExternalSelectionManager"))}static vb(){const a=
u.AFrameworkApplication.Ta;J.a.instance.ga(77)||(a.ya(D.a.leftJustify,xb.a.table,gg.RPd),a.ya(D.a.centerJustify,xb.a.table,gg.RPd),a.ya(D.a.rightJustify,xb.a.table,gg.RPd));a.ya(D.a.leftJustify,xb.a.view,xg.F7);a.ya(D.a.leftJustify,xb.a.paragraph,gg.qia);a.ya(D.a.leftJustify,xb.a.image,gg.JBa);a.ya(D.a.leftJustify,xb.a.embeddedFile,gg.JBa);a.he(D.a.leftJustify,1028);a.ya(D.a.centerJustify,xb.a.view,xg.F7);a.ya(D.a.centerJustify,xb.a.paragraph,gg.qia);a.ya(D.a.centerJustify,xb.a.image,gg.JBa);a.ya(D.a.centerJustify,
xb.a.embeddedFile,gg.JBa);a.he(D.a.centerJustify,1028);a.ya(D.a.rightJustify,xb.a.view,xg.F7);a.ya(D.a.rightJustify,xb.a.paragraph,gg.qia);a.ya(D.a.rightJustify,xb.a.image,gg.JBa);a.ya(D.a.rightJustify,xb.a.embeddedFile,gg.JBa);a.he(D.a.rightJustify,1028);J.a.instance.ga(54)&&(a.ya(D.a.fullJustify,xb.a.view,xg.F7),a.ya(D.a.fullJustify,xb.a.paragraph,gg.qia),a.he(D.a.fullJustify,1028),a.ya(D.a.M1b,xb.a.view,xg.F7),a.ya(D.a.M1b,xb.a.paragraph,gg.qia),a.he(D.a.M1b,1028),a.ya(D.a.J$b,xb.a.view,xg.F7),
a.ya(D.a.J$b,xb.a.paragraph,gg.qia),a.he(D.a.J$b,1028),a.ya(D.a.Jpc,xb.a.view,xg.F7),a.ya(D.a.Jpc,xb.a.paragraph,gg.qia),a.he(D.a.Jpc,1028));a.ya(D.a.Uka,xb.a.view,xg.F7);a.ya(D.a.Uka,xb.a.paragraph,gg.qia);a.ya(D.a.Uka,xb.a.image,gg.JBa);a.he(D.a.Uka,1028);a.ya(D.a.Iia,xb.a.view,xg.F7);a.ya(D.a.Iia,xb.a.paragraph,gg.qia);a.ya(D.a.Iia,xb.a.image,gg.JBa);a.he(D.a.Iia,1028);a.ya(D.a.eoa,xb.a.view,xg.F7);a.ya(D.a.eoa,xb.a.paragraph,gg.qia);a.ya(D.a.eoa,xb.a.image,gg.JBa);a.he(D.a.eoa,1028);J.a.instance.ga(54)&&
(a.ya(D.a.yDa,xb.a.view,xg.F7),a.ya(D.a.yDa,xb.a.paragraph,gg.qia),a.he(D.a.yDa,1028))}static RPd(a,b,c){let h=!0;if(!b)return 8;rd.TableReader.Ckg(b)?J.a.instance.ga(14)&&gg.aj.Dkg(b)?(gg.Wc.Wb(Ed.a.To,{["Reason"]:Cd.a.LD}),h=!1):gg.Zq()&&gg.Zq().instance&&gg.Zq().instance.UW(b)&&(gg.Wc.Wb(Ed.a.To,{["Reason"]:Cd.a.externalSelection}),h=!1):(gg.Wc.Wb(Ed.a.To,{["Reason"]:Cd.a.TZd}),h=!1);if(1===c||!h)return h?32:8;b=b.node;switch(a){case D.a.leftJustify:gg.Oq.RJ(b,1);break;case D.a.centerJustify:gg.Oq.RJ(b,
2);break;case D.a.rightJustify:gg.Oq.RJ(b,3)}return 32}static JBa(a,b,c){if(!({qF:c}=xg.$sh(c,b)).returnValue)return c;b=b.node;switch(a){case D.a.leftJustify:case D.a.Uka:gg.Rbe.RJ(b,1);break;case D.a.centerJustify:case D.a.Iia:gg.Rbe.RJ(b,2);break;case D.a.rightJustify:case D.a.eoa:gg.Rbe.RJ(b,3)}return 32}static qia(a,b,c,h,m){h=!0;b.contextId!==xb.a.paragraph?h=!1:J.a.instance.ga(14)&&gg.aj.mFa(b)?(gg.Wc.Wb(Ed.a.To,{["Reason"]:Cd.a.LD}),h=!1):gg.Zq()&&gg.Zq().instance&&gg.Zq().instance.UW(b)&&
(gg.Wc.Wb(Ed.a.To,{["Reason"]:Cd.a.externalSelection}),h=!1);if(1===c||!h)return h?32:8;b=b.node;c=Ob.ParagraphReader.BN(b);switch(a){case D.a.leftJustify:case D.a.Uka:gg.paragraphEditor.RJ(b,1===c&&gg.w_c(m)?6:1);break;case D.a.centerJustify:case D.a.Iia:gg.paragraphEditor.RJ(b,2===c&&gg.w_c(m)?1:2);break;case D.a.rightJustify:case D.a.eoa:gg.paragraphEditor.RJ(b,3===c&&gg.w_c(m)?1:3);break;case D.a.fullJustify:case D.a.yDa:gg.paragraphEditor.RJ(b,6===c&&gg.w_c(m)?1:6);break;case D.a.J$b:gg.paragraphEditor.RJ(b,
11);break;case D.a.M1b:gg.paragraphEditor.RJ(b,7);break;case D.a.Jpc:gg.paragraphEditor.RJ(b,13)}return 32}static w_c(a){let b=!1;null!==a&&Object.getType(a)===Object&&a.hasOwnProperty("InContextSet")&&(b=a.InContextSet);return!b&&J.a.instance.ga(110)}}gg.Qnb=null;gg.AD=null;gg.Rw=null;gg.Hm=null;Object(n.a)(gg,"JustificationActor",null,[]);class du{vb(){const a=u.AFrameworkApplication.Ta;a.ya(D.a.activateRibbonTab,xb.a.view,Object(F.a)(this,this.activateRibbonTab,"activateRibbonTab"));a.he(D.a.activateRibbonTab,
5);a.ya(D.a.Jlg,xb.a.view,Object(F.a)(this,this.uXj,"launchJewelOpenMenuShortcut"))}activateRibbonTab(){return 32}uXj(){u.AFrameworkApplication.CL("Microsoft.Office.Web.SessionSettings.IWacWordTransformToWebPageSettings");Fc.App.HD.KS.Ilg();return 32}static get instance(){return du.Ka||(du.Ka=du.iC())}static iC(){return new du}}du.Ka=null;Object(n.a)(du,"RibbonActor",null,[]);class zn{constructor(a,b,c){this.Vnf=!1;this.Ca=a;this.$a=b;this.byc=c}vb(){this.Ca.ra(H.a.GM,xb.a.view,Object(F.a)(this,this.trl,
"touchStartHandler"),4);this.Ca&&this.$a&&(this.$a.ka("TouchImageGrippiesResizedIsEnabled")&&(this.Ca.ra(D.a.PBh,xb.a.view,Object(F.a)(this,this.oFk,"processImageOnTouchSelection"),4),this.Ca.ra(D.a.QBh,xb.a.view,Object(F.a)(this,this.nFk,"processImageOnClickSelection"),4)),this.$a.ka("HideGrippersWhenPinchingIsEnabled")&&(this.Ca.ra(H.a.Xkl,xb.a.application,Object(F.a)(this,this.PFk,"processStartPinchToZoom"),4),this.Ca.ra(H.a.UPi,xb.a.application,Object(F.a)(this,this.gFk,"processEndPinchToZoom"),
4)))}trl(a,b,c){if(2!==c)return 2;this.Vnf||(this.Vnf=!0);u.AFrameworkApplication.fk("Microsoft.Office.Web.SessionSettings.IWacWordPinchZoomSettings");u.AFrameworkApplication.fk("Microsoft.Office.Web.SessionSettings.IWacWordViewerPinchZoomSettings");v.a.Uj&&u.AFrameworkApplication.fk("Microsoft.Office.Web.SessionSettings.IWacWordForceSelectionIntoTopWhenTouchSettings");return 32}oFk(a,b,c,h,m){if(2!==c)return 2;this.Pbh(m,!0);return 32}nFk(a,b,c,h,m){if(2!==c)return 2;this.Pbh(m,!1);return 32}Pbh(a,
b){if(a)for(a=a.firstChild;a;){if("SPAN"===a.tagName&&Sys.UI.DomElement.containsCssClass(a,zn.gAj)){for(a=a.firstChild;a;)this.ibi(a,b),a=a.nextSibling;break}a=a.nextSibling}}ibi(a,b){if(Sys.UI.DomElement.containsCssClass(a,zn.ebg)){b&&!Sys.UI.DomElement.containsCssClass(a,zn.RVc)?Sys.UI.DomElement.addCssClass(a,zn.RVc):!b&&Sys.UI.DomElement.containsCssClass(a,zn.RVc)&&Sys.UI.DomElement.removeCssClass(a,zn.RVc);const c="WACImageResizeHandleTouch"+this.r9i(a);b&&!Sys.UI.DomElement.containsCssClass(a,
c)?Sys.UI.DomElement.addCssClass(a,c):!b&&Sys.UI.DomElement.containsCssClass(a,c)&&Sys.UI.DomElement.removeCssClass(a,c)}}TRc(a){a=a.className.split(" ");for(let b=0;b<a.length;b++){const c=a[b].toString();if(c.startsWith("WACImageResizeHandle")&&c!==zn.ebg)return c}return""}r9i(a){a=this.TRc(a);return""!==a?ta.a.substring(a,20,a.length):""}PFk(a,b,c){if(2!==c)return 2;if(!this.byc)return 8;this.byc.Lxj();return 32}gFk(a,b,c){if(2!==c)return 2;if(!this.byc)return 8;this.byc.TYk();return 32}static zlj(){return new zn(u.AFrameworkApplication.Ta,
u.AFrameworkApplication.fa,Hh.GrippersManager.instance)}static get instance(){return zn.Ht||(zn.Ht=zn.zlj())}}zn.ebg="WACImageResizeHandles";zn.RVc="WACImageResizeHandlesTouch";zn.gAj="WACImgSelection";zn.Ht=null;Object(n.a)(zn,"TouchInputActor",null,[]);class br{constructor(a){this.Us=null;this.CZ=a}get In(){return this.Us||(this.Us=this.CZ())}vb(){const a=u.AFrameworkApplication.Ta,b=Object(F.a)(this,this.undoRedo,"undoRedo");a.ra(D.a.undo,xb.a.view,b,1028);a.ra(D.a.redo,xb.a.view,b,1028)}undoRedo(a,
b,c,h,m){b=b.view;if(!b.Mh)return br.Wc.Wb(Ed.a.wh,{["Reason"]:Cd.a.Hcd}),8;h=a===D.a.undo?this.In.LW:this.In.fka;if(1===c)return h?32:8;if(!h)return ba.ULS.sendTraceTag(17069441,365,50,"User attempted {0} without an undo stack",a===D.a.undo?"undo":"redo"),br.Wc.Wb(Ed.a.wh,{["Reason"]:Cd.a.Ovl}),2;c=new t.GraphTransaction(3);c.kd(b.yg);c.cjb();a=a===D.a.undo?this.In.undo():this.In.redo();c.dispose();m&&Hh.GrippersManager.instance.j1a(m.vv);if(a)return 32;br.Wc.Wb(Ed.a.Q1b,{["Reason"]:Cd.a.s_g});return 8}static get instance(){return br.Ka||
(br.Ka=br.iC())}static iC(){const a=vb.a.instance;return new br(()=>a.resolve("Box4.IUndoManager"),a.re("Box4.ICoauthCashTelemetry"))}static get Wc(){return ec.a.instance}}br.Ka=null;Object(n.a)(br,"UndoActor",null,[]);class rC{constructor(){this.Da=null}get name(){return"Box4.Actors"}$b(a){this.Da=a;(new EI).$b(a)}init(){this.Da.resolve("Box4.Actors.ClipboardActor").vb();u.AFrameworkApplication.Ta.ya(D.a.GNi,xb.a.embeddedFile,SP);u.AFrameworkApplication.Ta.ya(D.a.YZd,xb.a.embeddedFile,FI);u.AFrameworkApplication.Ta.ya(D.a.YZd,
xb.a.H3b,FI);ar.instance.vb();Be.vb();Jg.vb();gg.vb();zn.instance.vb();this.Da.resolve("Box4.ISelectAllHandlers").vb();J.a.instance.ga(70)&&this.Da.resolve("Box4.Actors.ProofingActor").vb();du.instance.vb();const a=this.Da.rb("Box4.IFeatureHelper");a?a.loj.continueWith(()=>{this.jgh()}):this.jgh();wc.vb(Fc.App.zLa);this.Da.resolve("Box4.Actors.TextFormattingActor").vb();br.instance.vb();this.Da.resolve("Box4.Actors.AccessibilityActor").kOe();this.Da.resolve("Box4.IClipboardCommands");Fc.App.Kb.updateCommandUI()}jgh(){J.a.instance.ga(71)&&
this.Da.resolve("Box4.Actors.StyleActor").vb()}dispose(){}static main(){r.a.instance.Dc(new rC)}}Object(n.a)(rC,"Box4ActorsPackage",null,[2,3]);class Cm{constructor(a,b){this.a7=this.MUh=null;this.OUh=a;this.znb=b}get shd(){return this.levelText}get $$b(){return this.MUh}get levelText(){return this.OUh}get listStyle(){return 6}get eE(){return"left"}get Tma(){return this.a7}get font(){return this.znb}}Object(n.a)(Cm,"ListMarkerBullet",null,[603]);class Gf{static get eq(){return Gf.Xo||(Gf.Xo=vb.a.instance.resolve("Box4.List.IListEditor"))}static get Sf(){return Gf.Ug||
(Gf.Ug=vb.a.instance.resolve("Box4.List.IListReader"))}static get insertionPointFormatting(){return Gf.Bt||(Gf.Bt=vb.a.instance.resolve("Box4.IInsertionPointFormatting"))}static Zq(){return Gf.Hm||(Gf.Hm=vb.a.instance.Ja("Box4.IExternalSelectionManager"))}static get jm(){return tg.ContextSetEditor.instance}static get aj(){return Dc.a.instance}static get Wc(){return ec.a.instance}static get BL(){return Gf.tK||(Gf.tK=vb.a.instance.rb("Box4.List.ListSettings"))}static get Pqc(){return Gf.eWb||(Gf.eWb=
vb.a.instance.rb("Box4.List.ISingleLevelListEditor"))}static vb(){const a=u.AFrameworkApplication.Ta;a.ya(D.a.jP,xb.a.view,Gf.vYb);a.ya(D.a.jP,xb.a.outlineElement,Gf.frb);a.he(D.a.jP,1036);a.ya(D.a.NR,xb.a.view,Gf.vYb);a.ya(D.a.NR,xb.a.outlineElement,Gf.frb);a.he(D.a.NR,1036);Gf.Sf.qbb&&(a.ya(D.a.pYa,xb.a.view,Gf.vYb),a.ya(D.a.pYa,xb.a.outlineElement,Gf.frb),a.he(D.a.pYa,1036));a.ya(D.a.tvf,xb.a.view,ed.ActionManager.Jg);a.ya(D.a.nDf,xb.a.view,ed.ActionManager.Jg);a.ya(D.a.joinList,xb.a.view,ed.ActionManager.Jg);
a.ya(D.a.vPd,xb.a.view,ed.ActionManager.Jg);a.ya(D.a.CPd,xb.a.view,ed.ActionManager.Jg);a.ya(D.a.Vyh,xb.a.view,ed.ActionManager.Jg);a.ya(D.a.Wyh,xb.a.view,ed.ActionManager.Jg);a.ya(D.a.V1e,xb.a.view,ed.ActionManager.Jg)}static vYb(a,b,c,h,m){if(!b.view.Mh)return 2;const y=Gf.Wc.Vp(D.a.vYb);h.eQ=42;h.W7=42;const G={};G[$h.epa]=5796;G[$h.dpa]=5797;var U=b.view;if(J.a.instance.ga(11)){if(Gf.jm.Sra(Gf.Jzj,U.Lb.Qj))return Gf.Wc.Wb(Ed.a.wh,{["Reason"]:Cd.a.kVd}),y.end(),8;if(Gf.jm.Sra(Gf.aPd,U.Lb.Qj))return Gf.Wc.Wb(Ed.a.wh,
{["Reason"]:Cd.a.X_b}),y.end(),8}if(J.a.instance.ga(14)&&Gf.aj.RXc(U.Lb.Qj))return Gf.Wc.Wb(Ed.a.wh,{["Reason"]:Cd.a.LD}),y.end(),8;if(Gf.Zq()&&Gf.Zq().instance&&Gf.Zq().instance.UW(b))return Gf.Wc.Wb(Ed.a.wh,{["Reason"]:Cd.a.externalSelection}),y.end(),8;if(1===c)return y.end(),32;m||(m=new E.DictionaryPropertySet);let ja=null;var va=2;if(2===c){ja=new t.GraphTransaction(15);ja.kd(b.view.yg);Gf.p$b=!1;const fb=pi.Vsa(U.Lb.Pa,!1);if(!fb)return ja.dispose(),Gf.Wc.Wb(Ed.a.vja,{["Reason"]:Cd.a.BOc}),
y.end(),8;u.AFrameworkApplication.fk("Microsoft.Office.Web.SessionSettings.IWacWordSwitchListByRangeSelectionImprovementSettings");1<fb.length&&m.setValue(xc.a.MZg,null);const Db=m.sa(xc.a.HT,-1),gc=m.sa(xc.a.fE,-1);Gf.BL.d$b&&Gf.Pqc&&Gf.Pqc.dHl(fb);if(Gf.Sf.Uyh){var Ta=Gf.Gbl(Db,gc,fb);Ta&&(m.setValue(xc.a.fE,16),m.setValue(xc.a.Mda,0));if(!Bb.SelectionEditor.Sg(U.Lb.Qj)&&!Ta&&a!==D.a.pYa&&0<fb.length&&Db){U=new rb.GraphIterator;Ta=Array(fb.length);for(let hc=0;hc<fb.length;hc++)U.set(fb.getContext(hc).node),
Ta[hc]=Gf.Sf.fw(U);Gf.Fbl(Ta,m)&&(va=new E.DictionaryPropertySet,va.setValue(xc.a.fE,16),va.setValue(xc.a.Mda,0),va=$h.w5(a,b,c,h,va,G,11),u.AFrameworkApplication.Ta.processAction(D.a.Wyh,2),ba.ULS.sendTraceTag(38544075,393,50,"List Actions: Switch List Style - Range Select"),Gf.p$b=!0)}}U=new rb.GraphIterator;U.set(fb.getContext(0).node);U=Gf.Sf.fw(U);Gf.o1j(Db,gc,U,fb.length)}J.a.instance.ga(63)||J.a.instance.ga(77)?va=$h.w5(a,b,c,h,m,G,11):J.a.instance.ga(30)&&(va=$h.Rgb(a,b,c,h,m,G));32===va&&
m.sa(xc.a.Twf,!1)&&(J.a.instance.ga(62)?va=$h.w5(D.a.MD,b,c,h,m,G,11):J.a.instance.ga(29)?va=$h.Rgb(D.a.MD,b,c,h,m,G):J.a.instance.ga(76));ja&&ja.dispose();y.end();return va}static Fbl(a,b){let c=null;var h=!1;for(let m=a.length-1;0<=m&&(c?(h=a[m],h=-1!==b.sa(xc.a.HT,-3)?h?c.listType!==h.listType||c.listStyle!==h.listStyle:!0:h?c.listType!==h.listType:!0):c=a[m],!h);m--);return c&&(a=!1,h||(a=b.sa(xc.a.HT,-3),a=b.sa(xc.a.fE,42)!==c.listType||0<a),h||a)?!0:!1}static o1j(a,b,c,h){0>=h||Gf.p$b||(a?c?
(c=c.listType,-1===a&&b===c?(u.AFrameworkApplication.Ta.processAction(D.a.V1e,2),ba.ULS.sendTraceTag(39715535,393,50,"List Actions: Clean List Style - Ribbon button")):0<a&&(0===b||1===b)&&(u.AFrameworkApplication.Ta.processAction(0===b?D.a.CPd:D.a.vPd,2),ba.ULS.sendTraceTag(39715536,393,50,"List Actions: Apply {0} List Style",0===b?"Numbering":"Bullet"))):(u.AFrameworkApplication.Ta.processAction(0===b?D.a.CPd:D.a.vPd,2),ba.ULS.sendTraceTag(39715534,393,50,"List Actions: Apply {0} List Style",0===
b?"Numbering":"Bullet")):(u.AFrameworkApplication.Ta.processAction(D.a.V1e,2),ba.ULS.sendTraceTag(39715533,393,50,"List Actions: Clean List Style - None list style")))}static Gbl(a,b,c){if(-1!==a&&a||!c.length)return!1;a=new rb.GraphIterator;let h=null;for(let m=c.length-1;0<=m&&!(a.set(c.getContext(m).node),h=Gf.Sf.fw(a));m--);return h&&b===h.listType?!0:!1}static frb(a,b,c,h,m){if(b.contextId!==xb.a.outlineElement)return 2;if(J.a.instance.ga(14)){var y=b.clone().VXe();if(Gf.aj.mFa(y))return Gf.Wc.Wb(Ed.a.To,
{["Reason"]:Cd.a.LD}),2}const G=new rb.GraphIterator;G.set(b.node);Bb.SelectionEditor.xt(G);if(!Kd.OutlineElementReader.Wg(G))return 2;if(1===c)switch(a){case D.a.jP:return 32;case D.a.NR:return 32;case D.a.pYa:return 32;default:return 2}y=Gf.Sf.fw(G);let U=m;if(!U)return 8;!Wb.ListReader.ix&&a===D.a.NR&&G.oEa()&&(G.FI(4)||U.setValue(xc.a.gVa,1),G.kp());Gf.Sf.qbb?(a===D.a.NR||a===D.a.jP?(U=Gf.eq.DQf(a,U),b=Pe.a.pN(U.eb(xc.a.fE),U.eb(xc.a.Mda))):b=a===D.a.pYa?Pe.a.pN(0,1):null,Gf.NQ(a,U),Gf.m7k(b,
U)):(U=Gf.eq.DQf(a,U),b=Pe.a.pN(U.eb(xc.a.fE),U.eb(xc.a.Mda)));Wb.ListReader.ix||(b.qA=U.sa(kb.a.iVa,Yd.a.Hw));Gf.s8k(U,G);if(!({G$a:b}=Gf.eq.frb(U,G,b,!1)).returnValue)return Gf.Wc.Wb(Ed.a.To,{["Reason"]:Cd.a.ume}),2;2===c&&(u.AFrameworkApplication.fk("Microsoft.Office.Web.SessionSettings.IWacWordSwitchListByRangeSelectionImprovementSettings"),a=m.sa(xc.a.fE,-1),b&&-1!==a&&((m=m.sa(jb.a.N_,"Invalid MultiLevel Type"),y)?0!==b.listType&&1!==b.listType||Gf.p$b||(u.AFrameworkApplication.Ta.processAction(D.a.Vyh,
2),ba.ULS.sendTraceTag(38544078,393,50,"List Actions: Switch Style - IP Select - {0}, {1}",a?"Bullet":"Numbering",m)):16===b.listType?(u.AFrameworkApplication.Ta.processAction(D.a.nDf,2),ba.ULS.sendTraceTag(38544076,393,50,"List Actions: ClearList Style - {0}, {1}",a?"Bullet":"Numbering",m)):0!==b.listType&&1!==b.listType||Gf.p$b||(u.AFrameworkApplication.Ta.processAction(D.a.tvf,2),ba.ULS.sendTraceTag(38544077,393,50,"List Actions: ApplyList Style - {0}, {1}",a?"Bullet":"Numbering",m))),m=C.FocusManager.instance(),
m.Be.name===I.AppFrame.nld&&m.bD(A.AFrame.wW));h.eQ=b.listType;h.W7=b.listStyle;return 32}static s8k(a,b){var c=new rb.GraphIterator;c.Rc(b);(b=c.Bb(2))&&Ob.ParagraphReader.Yd(b)&&(c=me.a.instance.Pa.mb)&&c.Ua&&c.Ua.node===b&&Bb.SelectionEditor.YZc(c)&&(Gf.o6k(a),Gf.m6k(a))}static m7k(a,b){b.Sa(jb.a.N_)&&a.l7k(b.eb(jb.a.N_));a.HT=b.sa(xc.a.HT,-1);a.Gke?(b=Gf.Baj(a,b),Gf.p8k(a,b)):Gf.x5k(a)}static x5k(a){if(a.jZc)a.XUc&&-1===a.HT||(a.levelText="%1.",a.propertySet.Sa(kb.a.Ri)||a.mya(0,1));else if(1===
a.listType)a.XUc&&-1===a.HT||(a.font=Yd.a.xIi,a.levelText=Yd.a.defaultBullet,a.propertySet.Sa(kb.a.Ri)||a.mya(1,6));else return;a.eE="left"}static p8k(a,b){1===a.N_?Gf.A7k(a,b):Gf.B6k(a,b)}static A7k(a,b){a.Tma=b.Tma}static B6k(a,b){a.levelText=b.levelText;a.jZc?a.mya(0,b.listStyle):(a.font=b.font,a.mya(1,1));a.eE=b.eE}static Baj(a,b){let c=null;2===a.N_?c=a.jZc?vb.a.instance.rb("Box4.ListMarkerGallery.ListMarkerNumberingLoader"):vb.a.instance.rb("Box4.ListMarkerGallery.ListMarkerBulletLoader"):1===
a.N_&&(c=vb.a.instance.rb("Box4.ListMarkerGallery.ListMarkerMultilevelLoader"));let h=c.jng.value;a=a.HT+"";a in h||(h=c.GYj);return a in h||!b.Sa(kb.a.font)?h[a]:new Cm(ta.a.fromCharCode(parseInt(a)),b.sa(kb.a.font,""))}static m6k(a){Gf.insertionPointFormatting.Sa(kb.a.fontColor)&&a.setValue(kb.a.fontColor,Gf.insertionPointFormatting.fontColor())}static o6k(a){Gf.insertionPointFormatting.Sa(kb.a.fontSize)&&a.setValue(kb.a.fontSize,Gf.insertionPointFormatting.fontSize())}static NQ(a,b){ba.ULS.sendTraceTag(22923024,
324,50,"{ListType:%1, ListStyleId:%2}",a===D.a.jP?0:a===D.a.NR?1:a===D.a.pYa?2:-1,b.sa(xc.a.HT,-1))}}Gf.Jzj=aa.ImageReader.h9b;Gf.aPd=aa.ImageReader.pyb;Gf.Xo=null;Gf.Ug=null;Gf.Bt=null;Gf.Hm=null;Gf.tK=null;Gf.eWb=null;Gf.p$b=!1;Object(n.a)(Gf,"ListActor",null,[]);var II=d(1189);class eu{constructor(){this.PUh=new sb.a(Object(F.a)(this,this.EWd,"createListMarkerDictionary"));this.QUh={}}get jng(){return this.PUh}get GYj(){return this.QUh}}Object(n.a)(eu,"AListMarkerGalleryLoader",null,[604]);var JI=
d(1216);class pz extends Zw.a{constructor(){super();this.LevelInfo=null}get Type(){return 5}}Object(n.a)(pz,"ListGalleryButtonProps",Zw.a,[]);class Ms{constructor(a,b,c,h){this.ETb=null;this.Qyf="BulletLibraryGallery";this.Skk="NumberingLibraryGallery";this.Bik="MultilevelGallery";this.A3a=a;this.RUh=b;switch(a){case 0:this.ETb="BulletStyle";break;case 1:this.ETb="NumberingStyle";break;case 2:this.ETb="MultilevelStyle";break;default:this.ETb="BulletStyle"}this.PTh=h}get HYj(){return this.RUh}Vqf(a){let b;
var c=1;switch(this.A3a){case 0:var h=Box4Intl.Box4Strings.L_BulletsLibraryTitle;var m=b="BulletsLibrary";break;case 1:h=Box4Intl.Box4Strings.L_NumberingLibraryTitle;b="NumberingLibrary";c=5;m="NumberingLibrary";break;case 2:h=Box4Intl.Box4Strings.L_ListLibraryTitle;b="MultilevelLibrary";c=5;m="Multilevel";break;default:h=Box4Intl.Box4Strings.L_BulletsLibraryTitle,m=b="BulletsLibrary"}h=Object.assign(new di.a,{Id:String.format("msListMarkersPosition{0}",b),Title:h,ShowMenuSectionSeparator:!1,DisplayMode:"Menu16",
ControlList:[]});var y=0===this.A3a?"Size40by40":"Size48by48";c=Object.assign(new qq.a,{Id:String.format("galleryListMarkersPosition{0}",b),ExternalId:m,ExternalGalleryId:this.X5d(this.A3a),Type:c,Width:6,ElementDimensions:y,GalleryItems:[]});m=this.HYj.jng.value;y=rq.a(m);const G=Math.min(18,y.length);for(let U=0;U<G;U++){const ja=m[y[U]];this.PTh&&a&&((1===this.A3a||2===this.A3a)&&!ja.$$b||0===this.A3a&&ja.levelText===Box4Intl.Box4Strings.L_ListStyleNone)||c.GalleryItems.push(this.W5d(this.ETb+
b+"_"+U,ja,this.A3a))}Array.add(h.ControlList,c);return h}X5d(a){switch(a){case 0:return this.Qyf;case 1:return this.Skk;case 2:return this.Bik;default:return this.Qyf}}P_f(a){const b={},c=ka.FontUtils.Uia(a.font);b.fontFamily=ka.FontUtils.Eqb(c,a.font,!0,!1,!1);return b}W5d(a,b,c){var h="";let m=!1;0===c&&b.levelText!==Box4Intl.Box4Strings.L_ListStyleNone&&(h=ta.a.dw(b.levelText.charCodeAt(0),4),h=Ms.KHj(b.font)&&!h.indexOf("f")?" 0x0"+h.substr(1):" 0x"+h,h=b.font+h,m=!0);let y,G;switch(c){case 0:c=
D.a.jP;y=D.a.Sch;G=Object.assign(new JI.a,{Character:b.levelText,Style:this.P_f(b)});break;case 1:c=D.a.NR;y=D.a.gHk;G=Object.assign(new pz,{LevelInfo:b.$$b});break;case 2:c=D.a.pYa;y=D.a.fHk;G=Object.assign(new pz,{LevelInfo:b.$$b});b.Tma&&(h=b.Tma.description,m=!0);break;default:c=D.a.jP,y=D.a.Sch,G=Object.assign(new JI.a,{Character:b.levelText,Style:this.P_f(b)})}G.Id=a;G.Command=c.toString();G.QueryCommand=y.toString();G.Alt=h;G.InnerHTML=ta.a.pe(this.EYj(b));G.ShouldSetTitle=m.toString();return G}EYj(a){return String.format('<DIV class="ListMarkerPreview" style="{0}">{1}</DIV>',
this.J6d(a),this.I6d(a))}J6d(a){const b=new Sys.StringBuilder;b.append("position: relative; ");if(a.shd===Box4Intl.Box4Strings.L_ListStyleNone&&a.font===Ms.pdg)b.append("font-size: 12pt; "),b.append("top: 22%;");else{b.append("font-family: ");const c=ka.FontUtils.Uia(a.font);b.append(ka.FontUtils.Eqb(c,a.font,!0,!1,!1));b.append("; ");b.append("font-size: 24pt;")}return b.toString()}I6d(a){return a.shd}static KHj(a){for(let b=0;b<Ms.lwf.length;b++)if(a===Ms.lwf[b])return!0;return!1}}Ms.pdg="EXYdHRyjlYTe8nDSGfyW";
Ms.lwf=["Symbol","Wingdings","Wingdings 2","Wingdings 3","Webdings"];Object(n.a)(Ms,"ListMarkerGalleryUtility",null,[]);class sC extends eu{constructor(){super();new II.a(cB.a.jp())}EWd(){const a={};a["0"]=new Cm(Box4Intl.Box4Strings.L_ListStyleNone,Ms.pdg);a["1"]=new Cm(String.fromCharCode(61623),"Symbol");a["2"]=new Cm(String.fromCharCode(111),"Courier New");a["3"]=new Cm(String.fromCharCode(61607),"Wingdings");a["4"]=new Cm(String.fromCharCode(9643),"Courier New");a["5"]=new Cm(String.fromCharCode(61611),
"Wingdings");a["6"]=new Cm(String.fromCharCode(61614),"Symbol");a["7"]=new Cm(String.fromCharCode(61483),"Symbol");a["8"]=new Cm(String.fromCharCode(61485),"Symbol");a["9"]=new Cm(String.fromCharCode(9830),"Courier New");a["10"]=new Cm(String.fromCharCode(61664),"Symbol");a["11"]=new Cm(String.fromCharCode(61558),"Wingdings");a["12"]=new Cm(String.fromCharCode(61656),"Wingdings");a["13"]=new Cm(String.fromCharCode(61514),"Wingdings");a["14"]=new Cm(String.fromCharCode(61516),"Wingdings");a["15"]=
new Cm(String.fromCharCode(61692),"Wingdings");a["16"]=new Cm(String.fromCharCode(61691),"Wingdings");a["17"]=new Cm(String.fromCharCode(61553),"Wingdings");return a}}Object(n.a)(sC,"ListMarkerBulletLoader",eu,[]);class Qk{constructor(){this.styleAtLevel=this.textAtLevel=null}}Object(n.a)(Qk,"InfoAtLevel",null,[]);class fu{constructor(a){this.a7=a}get font(){return"Calibri"}get listStyle(){return 42}get eE(){return"left"}get Tma(){return this.a7}get shd(){return this.a7?this.pEk():this.rEk()}get $$b(){return this.a7?
this.qEk():null}get levelText(){return""}E8i(a){switch(a){case 1:return"1";case 2:return"a";case 3:return"i";case 4:return"A";case 5:return"I";case 0:return"";default:return"1"}}pEk(){let a="";for(let b=0;3>b;b++)a+=this.WDa(b);return String.format('<DIV class="ListMultilevelPreview" style="{0}">{1}</DIV>',fu.W4d(),a)}qEk(){const a=[];for(let b=0;3>b;b++)a.push(Object.assign(new Qk,{textAtLevel:this.Z2f(b),styleAtLevel:this.ujj(b)}));return a}rEk(){return String.format('<DIV class="ListMultilevelPreview" style="{0}">{1}</DIV>',
fu.X4d(),Box4Intl.Box4Strings.L_ListStyleNone)}Z2f(a){a=this.a7.Vmg[a];for(let b=0;9>b;b++)a=ta.a.replaceAll(a,"%"+(b+1),this.E8i(this.a7.P0c[b]));return a}ujj(a){const b={};b.fontFamily=6===this.a7.P0c[a]?this.a7.pVf[a]:this.font;return b}WDa(a){const b=this.Z2f(a),c=new Sys.StringBuilder;6===this.a7.P0c[a]&&c.append(String.format("font-family:{0};",this.a7.pVf[a]));return String.format('<DIV class="level{0}" style="position: relative;">\r\n\t\t\t\t\t<SPAN style="{1}">{2}</SPAN>\r\n\t\t\t\t\t<SPAN style="height: 2px; margin-left: 4px; margin-right: 4px; background-color: #aaaaaa; width: 100%; position: absolute; top: 50%; outline: 1px solid transparent;"></SPAN>\r\n\t\t\t\t</DIV>',
a,c.toString(),b)}static W4d(){const a=new Sys.StringBuilder;a.append("padding-left: 2pt; ");a.append("font-size: 9pt; ");return a}static X4d(){const a=new Sys.StringBuilder;a.append("text-align: center; ");a.append("margin-top: 22%; ");a.append("font-size: 12pt; ");return a}}Object(n.a)(fu,"ListMarkerMultilevel",null,[603]);class qz{constructor(a,b,c,h,m){this.Vmg=a;this.P0c=b;this.qWj=h;this.pVf=c;this.description=m}}Object(n.a)(qz,"MultilevelDefInfo",null,[]);class KI{MBi(){var a=Box4Intl.Box4Strings.L_MultilevelListLabelNumericalStyle;
let b="";const c=Array(9),h=Array(9),m=Array(9),y=Array(9);for(let G=0;9>G;G++)b+="%"+(G+1)+".",c[G]=b,h[G]=1,m[G]="left";return new qz(c,h,y,m,a)}ZDi(){var a=Box4Intl.Box4Strings.L_MultilevelListLabelAlphanumericalStyle;const b=Array(9),c=Array(9);for(let h=0;9>h;h++)b[h]=2===h%3?"right":"left";return new qz("%1) %2) %3) (%4) (%5) (%6) %7. %8. %9.".split(" "),[1,2,3,1,2,3,1,2,3],c,b,a)}dBi(){var a=[61558,61656,61607,61623,9830,61656,61607,61623,9830],b=Box4Intl.Box4Strings.L_MultilevelListLabelBulletedStyle;
const c=Array(9),h=Array(9),m=Array(9);for(let y=0;9>y;y++)m[y]=String.fromCharCode(a[y]),c[y]=6,h[y]="left";return new qz(m,c,"Wingdings;Wingdings;Wingdings;Symbol;Courier New;Wingdings;Wingdings;Symbol;Courier New".split(";"),h,b)}}Object(n.a)(KI,"MultilevelDefInfoAdaptor",null,[]);class tC extends eu{constructor(){super()}EWd(){const a=new KI,b={};b["0"]=new fu(null);b["1"]=new fu(a.MBi());b["2"]=new fu(a.ZDi());b["3"]=new fu(a.dBi());return b}}Object(n.a)(tC,"ListMarkerMultilevelLoader",eu,[]);
class Rm{constructor(a,b){this.a7=null;this.u3a=a;this.Ozc=b}get font(){return"Calibri"}get listStyle(){return this.Ozc}get eE(){switch(this.Ozc){case 3:case 5:return"right";default:return"left"}}get Tma(){return this.a7}get shd(){switch(this.Ozc){case 1:return this.BJa("1","2","3");case 2:return this.BJa("a","b","c");case 3:return this.BJa("i","ii","iii");case 4:return this.BJa("A","B","C");case 5:return this.BJa("I","II","III");case 0:return this.sEk();default:return this.BJa("1","2","3")}}get $$b(){const a=
[],b={};b.fontFamily=ka.FontUtils.Uia(this.font);switch(this.Ozc){case 1:return a.push(Object.assign(new Qk,{textAtLevel:this.DN("1"),styleAtLevel:b})),a.push(Object.assign(new Qk,{textAtLevel:this.DN("2"),styleAtLevel:b})),a.push(Object.assign(new Qk,{textAtLevel:this.DN("3"),styleAtLevel:b})),a;case 2:return a.push(Object.assign(new Qk,{textAtLevel:this.DN("a"),styleAtLevel:b})),a.push(Object.assign(new Qk,{textAtLevel:this.DN("b"),styleAtLevel:b})),a.push(Object.assign(new Qk,{textAtLevel:this.DN("c"),
styleAtLevel:b})),a;case 3:return a.push(Object.assign(new Qk,{textAtLevel:this.DN("i"),styleAtLevel:b})),a.push(Object.assign(new Qk,{textAtLevel:this.DN("ii"),styleAtLevel:b})),a.push(Object.assign(new Qk,{textAtLevel:this.DN("iii"),styleAtLevel:b})),a;case 4:return a.push(Object.assign(new Qk,{textAtLevel:this.DN("A"),styleAtLevel:b})),a.push(Object.assign(new Qk,{textAtLevel:this.DN("B"),styleAtLevel:b})),a.push(Object.assign(new Qk,{textAtLevel:this.DN("C"),styleAtLevel:b})),a;case 5:return a.push(Object.assign(new Qk,
{textAtLevel:this.DN("I"),styleAtLevel:b})),a.push(Object.assign(new Qk,{textAtLevel:this.DN("II"),styleAtLevel:b})),a.push(Object.assign(new Qk,{textAtLevel:this.DN("III"),styleAtLevel:b})),a;case 0:return null;default:return a.push(Object.assign(new Qk,{textAtLevel:this.DN("1"),styleAtLevel:b})),a.push(Object.assign(new Qk,{textAtLevel:this.DN("2"),styleAtLevel:b})),a.push(Object.assign(new Qk,{textAtLevel:this.DN("3"),styleAtLevel:b})),a}}get levelText(){return this.u3a}BJa(a,b,c){return String.format('<DIV class="ListNumberPreview" style="{0}">{1}{2}{3}</DIV>',
Rm.W4d(),this.WDa(a),this.WDa(b),this.WDa(c))}sEk(){return String.format('<DIV class="ListNumberPreview" style="{0}">{1}</DIV>',Rm.X4d(),Box4Intl.Box4Strings.L_ListStyleNone)}WDa(a){a=this.DN(a);return String.format('<DIV style="position: relative;"><SPAN>{0}</SPAN><SPAN class="ListMarkerGalleryPreviewLine"></SPAN></DIV>',a)}DN(a){return ta.a.replaceAll(this.u3a,"%1",a)}static W4d(){const a=new Sys.StringBuilder;a.append("padding-left: 2pt; ");a.append("font-size: 9pt; ");return a}static X4d(){const a=
new Sys.StringBuilder;a.append("text-align: center; ");a.append("margin-top: 22%; ");a.append("font-size: 12pt; ");return a}}Object(n.a)(Rm,"ListMarkerNumbering",null,[603]);class uC extends eu{constructor(){super();new II.a(cB.a.jp())}EWd(){const a={};a["0"]=new Rm(Box4Intl.Box4Strings.L_ListStyleNone,0);a["1"]=new Rm("%1.",5);a["2"]=new Rm("%1.",4);a["3"]=new Rm("%1.",1);a["4"]=new Rm("%1.",2);a["5"]=new Rm("%1.",3);a["6"]=new Rm("%1)",5);a["7"]=new Rm("%1)",4);a["8"]=new Rm("%1)",1);a["9"]=new Rm("%1)",
2);a["10"]=new Rm("%1)",3);a["11"]=new Rm("(%1)",5);a["12"]=new Rm("(%1)",4);a["13"]=new Rm("(%1)",1);a["14"]=new Rm("(%1)",2);a["15"]=new Rm("(%1)",3);return a}}Object(n.a)(uC,"ListMarkerNumberingLoader",eu,[]);class vC{constructor(){this.Da=null}get name(){return"Box4.ListMarker"}init(){Gf.vb()}dispose(){}$b(a){this.Da=a;this.Da.register(sC,"Box4.ListMarkerGallery.ListMarkerBulletLoader").ma().oa(()=>new sC);this.Da.register(uC,"Box4.ListMarkerGallery.ListMarkerNumberingLoader").ma().oa(()=>new uC);
this.Da.register(tC,"Box4.ListMarkerGallery.ListMarkerMultilevelLoader").ma().oa(()=>new tC)}static main(){r.a.instance.Dc(new vC)}}Object(n.a)(vC,"Box4ListMarkerPackage",null,[2,3]);class wC{constructor(a){this.Xvd=a}Ffg(a){if(!this.Xvd)return!0;a=ng.a.URc(a);if(!a)return!1;a=a.toLowerCase();for(let b=0;b<this.Xvd.length;b++)if(a.endsWith(this.Xvd[b]))return!0;return!1}}Object(n.a)(wC,"DomainAllowListManager",null,[]);class LI{constructor(a,b){this.VXd=null;this.iLd=a;this.url=b}get t3e(){return ng.a.Nna(this.url)}get EB(){return this.iLd}d0e(){const a=
{},b=this.EB;a.a=this.t3e;a.b=this.round(b.navigationStart);a.c=this.round(b.unloadEventStart);a.d=this.round(b.unloadEventEnd);a.e=this.round(b.redirectStart);a.f=this.round(b.redirectEnd);a.g=this.round(b.fetchStart);a.h=this.round(b.domainLookupStart);a.i=this.round(b.domainLookupEnd);a.j=this.round(b.connectStart);a.k=this.round(b.connectEnd);a.l=void 0!==b.secureConnectionStart&&null!==b.secureConnectionStart?this.round(b.secureConnectionStart):0;a.m=this.round(b.requestStart);a.n=this.round(b.responseStart);
a.o=this.round(b.responseEnd);a.q=this.round(b.domInteractive);a.r=this.round(b.domContentLoadedEventStart);a.s=this.round(b.domContentLoadedEventEnd);a.t=this.round(b.domComplete);a.u=this.round(b.loadEventStart);a.v=this.round(b.loadEventEnd);a.w=this.VXd;return a}round(a){return Math.round(1E3*a)/1E3}}Object(n.a)(LI,"PerformanceTimingEntry",null,[]);const MI=(a,b)=>{const c={};let h=null;switch(a){case 0:h="ResourceTiming";a=b.a;null!=a&&(c.Url=a);a=b.b;null!=a&&(c.InitiatorType=a);a=null==b.c?
null:b.c.toString();null!=a&&(c.RedirectStart=a);a=null==b.d?null:b.d.toString();null!=a&&(c.RedirectEnd=a);a=null==b.e?null:b.e.toString();null!=a&&(c.FetchStart=a);a=null==b.f?null:b.f.toString();null!=a&&(c.DomainLookupStart=a);a=null==b.g?null:b.g.toString();null!=a&&(c.DomainLookupEnd=a);a=null==b.h?null:b.h.toString();null!=a&&(c.ConnectStart=a);a=null==b.i?null:b.i.toString();null!=a&&(c.ConnectEnd=a);a=null==b.j?null:b.j.toString();null!=a&&(c.SecureConnectionStart=a);a=null==b.k?null:b.k.toString();
null!=a&&(c.RequestStart=a);a=null==b.l?null:b.l.toString();null!=a&&(c.ResponseStart=a);a=null==b.m?null:b.m.toString();null!=a&&(c.ResponseEnd=a);a=b.n;null!=a&&(c.CustomText=a);a=null==b.o?null:b.o.toString();null!=a&&(c.DecodedBodySize=a);a=null==b.p?null:b.p.toString();null!=a&&(c.EncodedBodySize=a);b=null==b.q?null:b.q.toString();null!=b&&(c.TransferSize=b);break;case 1:h="PerformanceTiming",a=b.a,null!=a&&(c.Url=a),a=null==b.b?null:b.b.toString(),null!=a&&(c.NavigationStart=a),a=null==b.c?
null:b.c.toString(),null!=a&&(c.UnloadEventStart=a),a=null==b.d?null:b.d.toString(),null!=a&&(c.UnloadEventEnd=a),a=null==b.e?null:b.e.toString(),null!=a&&(c.RedirectStart=a),a=null==b.f?null:b.f.toString(),null!=a&&(c.RedirectEnd=a),a=null==b.g?null:b.g.toString(),null!=a&&(c.FetchStart=a),a=null==b.h?null:b.h.toString(),null!=a&&(c.DomainLookupStart=a),a=null==b.i?null:b.i.toString(),null!=a&&(c.DomainLookupEnd=a),a=null==b.j?null:b.j.toString(),null!=a&&(c.ConnectStart=a),a=null==b.k?null:b.k.toString(),
null!=a&&(c.ConnectEnd=a),a=null==b.l?null:b.l.toString(),null!=a&&(c.SecureConnectionStart=a),a=null==b.m?null:b.m.toString(),null!=a&&(c.RequestStart=a),a=null==b.n?null:b.n.toString(),null!=a&&(c.ResponseStart=a),a=null==b.o?null:b.o.toString(),null!=a&&(c.ResponseEnd=a),a=null==b.p?null:b.p.toString(),null!=a&&(c.DomLoading=a),a=null==b.q?null:b.q.toString(),null!=a&&(c.DomInteractive=a),a=null==b.r?null:b.r.toString(),null!=a&&(c.DomContentLoadedEventStart=a),a=null==b.s?null:b.s.toString(),
null!=a&&(c.DomContentLoadedEventEnd=a),a=null==b.t?null:b.t.toString(),null!=a&&(c.DomComplete=a),a=null==b.u?null:b.u.toString(),null!=a&&(c.LoadEventStart=a),a=null==b.v?null:b.v.toString(),null!=a&&(c.LoadEventEnd=a),b=b.w,null!=b&&(c.CustomText=b)}c.Table=h;return Sys.Serialization.JavaScriptSerializer.serialize(c)};var Uh=d(285);class Xr{constructor(a,b=null,c=null){this.oi=a;this.s3e=this;this.fRh=b||(()=>window.location.href);this.Wyd=new wC(c)}run(){if(Xr.TBa(window.performance))try{const m=
this.fRh();if(Xr.u1h.exec(m)&&this.Wyd.Ffg(m)){var a=new LI(window.performance.timing,m);Jj.a.instance.FMk(a.EB.fetchStart);Jj.a.instance.HMk(a.EB.navigationStart);Jj.a.instance.fYa(Uh.a.MZi,"connectStart","requestStart");Jj.a.instance.fYa(Uh.a.SZi,"requestStart","responseStart");Jj.a.instance.fYa(Uh.a.UZi,"responseStart","responseEnd");this.s3e.tbb(1,a.d0e());this.oi.ic(Uh.a.vDa,a.EB.fetchStart);this.oi.ic(Uh.a.QZi,a.EB.domainLookupStart);this.oi.ic(Uh.a.XVf,a.EB.domainLookupEnd);this.oi.ic(Uh.a.OZi,
a.EB.connectStart);this.oi.ic(Uh.a.VZi,a.EB.secureConnectionStart);this.oi.ic(Uh.a.NZi,a.EB.connectEnd);this.oi.ic(Uh.a.ZVf,a.EB.requestStart);this.oi.ic(Uh.a.UPc,a.EB.responseStart);this.oi.ic(Uh.a.YVf,a.EB.responseEnd-a.EB.responseStart);this.oi.ic(Uh.a.TZi,a.EB.responseStart-a.EB.requestStart);var b=0,c=0,h=0;({transferSize:b,M_d:c,fYd:h}=this.xul(m)).returnValue&&(this.oi.ic(Uh.a.WZi,b),this.oi.ic(Uh.a.PZi,h),this.oi.ic(Uh.a.RZi,c));this.oi.ic(Uh.a.Y3b,a.EB.navigationStart)}}catch(m){ba.ULS.sendTraceTag(4551814,
306,10,"Exception caught in PerformanceTimingLogger.Run: {0}",m)}}xul(a){let b,c,h;h=c=b=-1;if(void 0===window.performance.getEntriesByName||null===window.performance.getEntriesByName)return{returnValue:!1,transferSize:b,M_d:c,fYd:h};a=window.performance.getEntriesByName(a,"navigation");if(void 0===a||null===a||1!==a.length)return{returnValue:!1,transferSize:b,M_d:c,fYd:h};a=a[0];var m=a.transferSize;void 0!==b&&null!==b&&(b=m);m=a.decodedBodySize;void 0!==m&&null!==m&&(h=m);a=a.encodedBodySize;void 0!==
a&&null!==a&&(c=a);return{returnValue:!0,transferSize:b,M_d:c,fYd:h}}tbb(a,b){ba.ULS.sendTraceTag(4551815,306,50,MI(a,b))}static get instance(){return Xr.Ka||(Xr.Ka=new Xr(rg.a.instance,null,u.AFrameworkApplication.fa.ka("PerfTimingLoggerFilterDomainsIsEnabled")?u.AFrameworkApplication.fa.RA("ResourceLoggerDomainAllowList"):null))}static TBa(a){return!(void 0===a||null===a)&&!(void 0===a.timing||null===a.timing)}}Xr.Ka=null;Xr.u1h=RegExp("^https?://.*","i");Object(n.a)(Xr,"PerformanceTimingLogger",
null,[601]);class Ns{constructor(a,b){this.VXd=null;this.iLd=a;this.behavior=b;this.url=this.EB.name}get t3e(){return 2===this.behavior?this.url:ng.a.Nna(this.url)}get EB(){return this.iLd}d0e(){const a={},b=this.EB;a.a=this.t3e;a.b=b.initiatorType;a.c=this.round(b.redirectStart);a.d=this.round(b.redirectEnd);a.e=this.round(b.fetchStart);a.f=this.round(b.domainLookupStart);a.g=this.round(b.domainLookupEnd);a.h=this.round(b.connectStart);a.i=this.round(b.connectEnd);a.j=void 0!==b.secureConnectionStart&&
null!==b.secureConnectionStart?this.round(b.secureConnectionStart):0;a.k=this.round(b.requestStart);a.l=this.round(b.responseStart);a.m=this.round(b.responseEnd);a.o=this.round(Ns.Gwb(b,"decodedBodySize"));a.p=this.round(Ns.Gwb(b,"encodedBodySize"));a.q=this.round(Ns.Gwb(b,"transferSize"));a.n=this.VXd;return a}round(a){return Math.round(1E3*a)/1E3}static Gwb(a,b){return a[b]}}Object(n.a)(Ns,"ResourceTimingEntry",null,[629]);class NI{constructor(a,b=null,c=100){this.O5e=a;this.kDc=b;this.hmb={};this.tNh=
c}ktl(a){var b=a.name.toLowerCase();const c=ng.a.y7d(b);this.FYk(c,b)&&(c in this.hmb?ba.ULS.sendTraceTag(51652509,306,50,"AppStaticResourceManager: file downloaded multiple times {0}",c):(b={},b.fetchstart=a.fetchStart,b.responseend=a.responseEnd,b.iscached=this.sUj(a),b.encodedsize=Ns.Gwb(a,"encodedBodySize"),b.decodedsize=Ns.Gwb(a,"decodedBodySize"),this.hmb[c]=b))}FYk(a,b){if(this.O5e)return Array.contains(this.O5e,a);if(this.kDc)for(a=ng.a.UD(b),b=0;b<this.kDc.length;b++)if(this.kDc[b]&&a.endsWith(this.kDc[b]))return!0;
return!1}sUj(a){try{const b=Ns.Gwb(a,"transferSize");if(void 0!==b&&null!==b)return!b;ba.ULS.sendTraceTag(51652510,306,50,"AppStaticResourceManager: No transfersize found, basing cache status from duration");return a.responseEnd-a.fetchStart<this.tNh}catch(b){ba.ULS.sendTraceTag(51652511,306,50,"AppStaticResourceManager: Error attempting to get cache value of resource [error: {0}]",b.message)}return!1}tNk(){if(Da.a.Wa(this.hmb))ba.ULS.sendTraceTag(575931855,306,15,"Aggregated Static Resource Metric Dictionary is null or empty");
else{var a=u.AFrameworkApplication.ZS?u.AFrameworkApplication.ZS.split(";"):[],b=Object.assign(new ql.a,{extendedProperties:Pq.a.Lz()});b.extendedProperties.set("Flights",dd.c(a));this.l1j(b,this.hmb,Mf.Health.instance)}}R3d(a){let b=0,c=0,h=0,m=0;const y=this.hmb;for(let U in y){var G=y[U];U.endsWith(".js")&&(G=Object(ua.a)(Object,G),G.responseend<a&&(b+=1,c+=G.decodedsize,m+=G.encodedsize,h+=G.iscached?0:G.encodedsize))}a={};a.filesLoaded=b;a.decodedBytes=c;a.transferredBytes=h;a.encodedBytes=m;
return a}l1j(a,b,c){if(b){var h=0,m=0,y=0,G=0,U=0,ja=0,va=0,Ta=0,fb=0,Db=0,gc=0;for(let Gc in b){var hc=b[Gc];try{const Pc=Object(ua.a)(Object,hc);if(!Pc)continue;const yc=Pc.iscached?Boolean.parse(Pc.iscached.toString()):!1,Vd=Pc.fetchstart?this.parseFloat(Pc.fetchstart.toString()):0,De=(Pc.responseend?this.parseFloat(Pc.responseend.toString()):0)-Vd,Wd=Pc.encodedsize?this.parseFloat(Pc.encodedsize.toString()):0,Ve=Pc.decodedsize?this.parseFloat(Pc.decodedsize.toString()):0;h+=De;G+=Wd;va+=Ve;Db++;
yc?(y+=De,ja+=Wd,fb+=Ve,gc++):(m+=De,U+=Wd,Ta+=Ve)}catch(Pc){ba.ULS.sendTraceTag(575931856,306,10,"AppStaticResourceManager: Error attempting to log KPI [error: {0}]",Pc.message)}}a.extendedProperties.set("StaticResources",dd.c(b));a.extendedProperties.set("TotalResourceDownloadLatency",h.toString());a.extendedProperties.set("TotalResourceDownloadLatencyForCacheMiss",m.toString());a.extendedProperties.set("TotalResourceDownloadLatencyForCacheHit",y.toString());a.extendedProperties.set("TotalSizeOfEncodedDataDownloaded",
G.toString());a.extendedProperties.set("TotalSizeOfEncodedDataDownloadedForCacheMiss",U.toString());a.extendedProperties.set("TotalSizeOfEncodedDataDownloadedForCacheHit",ja.toString());a.extendedProperties.set("TotalSizeOfDecodedDataDownloaded",va.toString());a.extendedProperties.set("TotalSizeOfDecodedDataDownloadedForCacheMiss",Ta.toString());a.extendedProperties.set("TotalSizeOfDecodedDataDownloadedForCacheHit",fb.toString());a.extendedProperties.set("TotalNumberOfResourcesDownloaded",Db.toString());
a.extendedProperties.set("TotalNumberOfCachedResourcesDownloaded",gc.toString());c.recordKpiUsageForAlertableKpi("StaticResourceDownloadLatencyAggregated","wacbootmonitoring",null);c.recordKpiSuccess("StaticResourceDownloadLatencyAggregated",a)}}parseFloat(a){if(!a)return 0;a=parseFloat(a);return isNaN(a)?0:a}}Object(n.a)(NI,"AppStaticResourceManager",null,[]);class OI extends Sys.EventArgs{constructor(a){super();this.entries=a}}Object(n.a)(OI,"EntriesAvailableEventArgs",Sys.EventArgs,[]);class yv{constructor(a,
b,c=null,h=null,m=100){this.lDd=!1;this.Tm=null;this.CQb=0;this.Oa=new bd.a;this.omb=null;this.sha=!1;this.Nnf=0;this.Wd=a;this.p8e=0;this.s3e=this;this.Wyd=new wC(c);this.yD=b;h&&(this.omb=new NI(null,h,m))}get fyf(){try{return!(void 0===this.yD||null===this.yD)&&!(void 0===this.yD.getEntriesByType||null===this.yD.getEntriesByType)}catch(a){return ba.ULS.sendTraceTag(50873240,306,10,"Exception caught in ResourceTimingLogger.BrowserSupportsPerformanceTimeline: {0}",a),!1}}get vIi(){return this.p8e}get isActive(){return this.sha}get V_e(){return this.Nnf}Xrf(a){this.Oa.addHandler(yv.t0d,
a)}Bhh(a){this.Oa.removeHandler(yv.t0d,a)}$b(a,b){const c=this.V_e!==a;this.Nnf=a;this.isActive&&this.Wd&&c&&(this.Rg(),this.Eb());this.p8e=b}activate(){!this.isActive&&this.fyf&&(this.Eb(),this.sha=!0)}deactivate(a){this.isActive&&(this.Rg(),a&&this.flush(),this.sha=!1)}flush(){if(this.isActive&&this.fyf)try{var a=window.performance.getEntriesByType("resource");0<a.length-this.CQb&&ba.ULS.sendTraceTag(19506833,306,100,"ResourceTimingLogger.Flush: Start executing command. Number of new entries to flash: {0}",
a.length-this.CQb);const b=!(void 0===window.performance.clearResourceTimings||null===window.performance.clearResourceTimings);b&&(window.performance.clearResourceTimings(),this.CQb=0);const c=[];for(let h=this.CQb;h<a.length;h++)this.Wyd.Ffg(a[h].name)&&(this.omb&&this.omb.ktl(a[h]),c.push(new Ns(a[h],this.vIi)));b||(this.CQb=a.length);this.Oa.raiseEvent(yv.t0d,new OI(c));for(a=0;a<c.length;a++)0!==c[a].behavior&&2!==c[a].behavior||this.s3e.tbb(0,c[a].d0e());0<c.length&&ba.ULS.sendTraceTag(19506834,
306,100,"ResourceTimingLogger.Flush: Successfully ended. Number of new logged entries: {0}",c.length)}catch(b){ba.ULS.sendTraceTag(4310803,306,10,"Exception caught in ResourceTimingLogger.Flush: {0}",b)}}tbb(a,b){ba.ULS.sendTraceTag(4310804,306,50,MI(a,b))}AMk(){this.omb.tNk()}R3d(a){return this.omb.R3d(a)}Eb(){this.Wd&&0<this.V_e&&(this.Tm=new He.a(3,2,1E3*this.V_e,()=>{this.flush()},5),this.Wd.Eb(this.Tm),this.lDd=!0)}Rg(){this.lDd&&(this.Wd.Rg(this.Tm),this.Tm=null,this.lDd=!1)}}yv.t0d="EntriesAvailable";
Object(n.a)(yv,"ResourceTimingLogger",null,[574,601]);class xC{constructor(){this.Da=null}get name(){return"Common.ResourceTiming"}init(){this.Da.resolve("Common.NetworkTiming.IResourceTimingLogger");Xr.instance.run()}dispose(){}$b(a){this.Da=a;let b=null;if(u.AFrameworkApplication.fa.ka("ResourceLoggerFilterDomainsIsEnabled"))try{b=u.AFrameworkApplication.fa.RA("ResourceLoggerDomainAllowList")}catch(m){ba.ULS.sendTraceTag(51652512,306,50,"ResourceTimingPackage - failed to get logger domain allowlist")}const c=
[];c.push(ng.a.UD(Rn.a.fP).toLowerCase());c.push(ng.a.UD(Rn.a.JLb).toLowerCase());const h=u.AFrameworkApplication.fa.Fc("AppStaticResourceMonitorCacheThresholdInMs",100);a.register(574,"Common.NetworkTiming.IResourceTimingLogger").ma().oa(()=>new yv(u.AFrameworkApplication.we,window.performance,b,c,h))}static main(){r.a.instance.Dc(new xC)}}Object(n.a)(xC,"ResourceTimingPackage",null,[2,3]);class zv{}zv.visible="visible";zv.hidden="hidden";Object(n.a)(zv,"PlatformVisibilityState",null,[]);var rz=
d(196);class PI extends Sys.EventArgs{constructor(a,b){super();this.Nff={};this.tWh=a;this.bWh=b}get oldState(){return this.tWh}get newState(){return this.bWh}oib(a,b){this.Nff[a]=b}toString(){return dd.c(this.Nff)}}Object(n.a)(PI,"VisibilityStateChangeEventArgs",Sys.EventArgs,[]);class yC{constructor(a,b,c,h){this.Lnf=this.ZOa=null;this.nmf=!0;this.Oa=new bd.a;this.Wd=a;this.qAd=b;this.w8e=c;this.z2h=h;this.Bdf=!1;u.AFrameworkApplication.fa&&(this.Bdf=u.AFrameworkApplication.fa.ka("WordPriorityTaskLoggingOnComingOutOfFrozenIsEnabled"),
this.nmf=u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.ListenToResumeEvents",!0));this.Q5e=0;this.Knf=new Date;this.qAd()===zv.hidden&&this.gHf();$addHandler(window,"focus",Object(F.a)(this,this.I4g,"onPlatformFocusHandler"));$addHandler(window,"blur",Object(F.a)(this,this.Ked,"onPlatformBlurHandler"));$addHandler(document,"freeze",Object(F.a)(this,this.J4g,"onPlatformFreezeHandler"));$addHandler(document,"visibilitychange",Object(F.a)(this,this.K4g,"onPlatformVisibilityChangeHandler"));
this.nmf&&($addHandler(document,"pageshow",Object(F.a)(this,this.Ked,"onPlatformBlurHandler")),$addHandler(document,"resume",Object(F.a)(this,this.Ked,"onPlatformBlurHandler")))}get R5a(){return this.Q5e}get isVisible(){return 2!==this.R5a}TFc(a){this.Oa.addHandler("VST",a)}uUk(a){this.Oa.removeHandler("VST",a)}Ked(a){this.RNb(a.type,this.W9d())}I4g(a){this.RNb(a.type,0)}J4g(a){3!==this.R5a&&(this.DDf(),this.RNb(a.type,2),this.RNb(a.type,3),u.AFrameworkApplication.Vg.Hfk())}W9d(){return this.qAd()===
zv.hidden?2:document.hasFocus()?0:1}RNb(a,b){const c=this.R5a;this.Q5e=b;if(c!==this.R5a){3===c&&this.Bdf&&this.f1k();const h=new Date,m=new PI(c,this.R5a);m.oib("FromState",Vm[c]);m.oib("ToState",Vm[b]);m.oib("OriginatingEvent",a);m.oib("TimeInState",(+h-+this.Knf).toString());this.Knf=h;this.z2h.Pog(m);this.Oa.raiseEvent("VST",m)}}K4g(a){this.qAd()===zv.hidden?this.ZOa?this.Wd.G5(this.ZOa,this.w8e):this.gHf():(this.DDf(),this.RNb(a?a.type:"",this.W9d()))}dispose(){$removeHandler(window,"focus",
Object(F.a)(this,this.I4g,"onPlatformFocusHandler"));$removeHandler(window,"blur",Object(F.a)(this,this.Ked,"onPlatformBlurHandler"));$removeHandler(document,"freeze",Object(F.a)(this,this.J4g,"onPlatformFreezeHandler"));$removeHandler(document,"visibilitychange",Object(F.a)(this,this.K4g,"onPlatformVisibilityChangeHandler"))}DDf(){this.ZOa&&(this.Wd.Rg(this.ZOa),this.ZOa=null)}gHf(){this.ZOa=new He.a(4,1,this.w8e,Object(F.a)(this,this.Evj,"handleVisibilityUpdate"),157);this.Wd.Eb(this.ZOa)}Evj(){this.ZOa=
null;this.RNb("TaskItem",this.W9d())}H2j(a){ba.ULS.sendTraceTag(557977793,324,50,"Time to execute task with Priority {0}:{1} Emergency View State: {2}",a.Xog,+new Date-+this.Lnf,rz.SessionStatusManager.instance.eka)}f1k(){this.Lnf=new Date;this.Wd.Eb(this.O0b(0,"Realtime"));this.Wd.Eb(this.O0b(1,"AboveNormal"));this.Wd.Eb(this.O0b(2,"Normal"));this.Wd.Eb(this.O0b(3,"Background"));this.Wd.Eb(this.O0b(4,"Low"))}O0b(a,b){return new He.a(a,1,0,Object(F.a)(this,this.H2j,"logTimeToExecuteTask"),0,b)}}Object(n.a)(yC,
"VisibilityManager",null,[607,106]);class VP{Pog(){}}Object(n.a)(VP,"NullVisibilityManagerTelemetry",null,[600]);class sz{constructor(){this.Oa=new bd.a}Pog(a){ba.ULS.sendTraceTag(590901976,324,50,a.toString())}static create(){return new sz}}Object(n.a)(sz,"VisibilityManagerTelemetry",null,[600]);class zC{constructor(){this.Da=null}get name(){return"Common.App.VisibilityManager"}init(){this.Da.resolve("Common.App.VisibilityManagement.IVisibilityManager")}dispose(){const a=this.Da.rb("Common.App.VisibilityManagement.VisibilityManager");
a&&a.dispose()}$b(a){this.Da=a;this.Da.register(sz,"Common.App.VisibilityManagement.VisibilityManagerTelemetry").as("Common.App.VisibilityManagement.IVisibilityManagerTelemetry").oa(()=>sz.create()).ma();this.Da.register(yC,"Common.App.VisibilityManagement.VisibilityManager").as("Common.App.VisibilityManagement.IVisibilityManager").oa(()=>new yC(u.AFrameworkApplication.we,()=>window.document.visibilityState,6E4*u.AFrameworkApplication.fa.Fc("VisibilityManagerDelayTransitionToHiddenInMin",1),this.Da.resolve("Common.App.VisibilityManagement.VisibilityManagerTelemetry"))).ma()}static main(){r.a.instance.Dc(new zC)}}
Object(n.a)(zC,"VisibilityManagerPackage",null,[2,3]);var WP=d(1204);class QI{constructor(a,b){this.s3c=new Nd.a;this.v3c=new Nd.a;this.CHa=b;this.RVa=a}Kp(a){!a||this.s3c.Hb(a.id)||this.v3c.Hb(a.id)||this.RVa.Kp(a)}Wfh(a){this.ZOk(a)}Xfh(a){this.aPk(a)}ZOk(a){var b=null;this.CHa&&a&&(this.Kp(a),b=b||Object(F.a)(this,this.EFe,"onDragOver"),this.s3c.$(a.id,b),this.RVa.pb(ra.a.drop,a,b))}aPk(a){var b=null;this.CHa&&a&&(this.Kp(a),b=b||Object(F.a)(this,this.FFe,"onDrop"),this.v3c.$(a.id,b),this.RVa.pb(ra.a.L7a,
a,b))}yb(a){this.CHa&&a&&(this.RVa.Vq(a),this.s3c.ga(a.id)&&this.RVa.yb(ra.a.L7a,a,this.s3c.ga(a.id)),this.v3c.ga(a.id)&&this.RVa.yb(ra.a.drop,a,this.v3c.ga(a.id)))}Nyj(){this.RVa&&this.RVa.dispose()}FFe(a){a=a.pc;a.preventDefault();a.stopPropagation();return!0}EFe(a){a=a.pc;a.preventDefault();a.stopPropagation();return!0}}Object(n.a)(QI,"PPTDragDropInputHelper",null,[551]);class AC{constructor(){this.K=null}get name(){return"PowerPointWebEditor.DragDrop"}$b(a){if(!a)throw Error.argumentNull("container");
this.K=a;this.K.register(551,"PowerPointWebEditor.DragDrop.IPPTDragDropInputHelper").ma().oa(()=>new QI(WP.a.instance,this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointDragInsertImageIsEnabled))}init(){const a=this.K.resolve("PowerPointWebEditor.AppFrame").qPd;a?(this.K.resolve("PowerPointWebEditor.DragDrop.IPPTDragDropInputHelper").Wfh(a),this.K.resolve("PowerPointWebEditor.DragDrop.IPPTDragDropInputHelper").Xfh(a)):(this.K.resolve("PowerPointWebEditor.DragDrop.IPPTDragDropInputHelper").Wfh(this.K.resolve("PowerPointWebEditor.AppFrame").N1),
this.K.resolve("PowerPointWebEditor.DragDrop.IPPTDragDropInputHelper").Xfh(this.K.resolve("PowerPointWebEditor.AppFrame").N1))}dispose(){this.K.resolve("PowerPointWebEditor.DragDrop.IPPTDragDropInputHelper").yb(this.K.resolve("PowerPointWebEditor.AppFrame").qPd);this.K.resolve("PowerPointWebEditor.DragDrop.IPPTDragDropInputHelper").Nyj()}static main(){r.a.instance.Dc(new AC)}}Object(n.a)(AC,"PPTWebEditorDragDropPackage",null,[2,3]);class RI{constructor(a){this.MXh=a}zVe(){return Math.random()<this.MXh}}
Object(n.a)(RI,"RandomSampler",null,[1527]);class SI{constructor(a){this.VRb=null;this.v_h=a}aYb(a,b){if("ForceSample"===b||this.v_h())this.VRb||(this.VRb=[]),Array.add(this.VRb,a)}getData(){return this.VRb}reset(){this.VRb=null}}Object(n.a)(SI,"SampleDataAggregator",null,[1522]);var TI=d(529);class UI{constructor(){this.metadata=null;this.duration=this.ths=this.timeStamp=0;this.isCoauth=null}}Object(n.a)(UI,"PPTEventTimingData",null,[]);class vq{constructor(){this.Eye=!1;this.Q9={};this.Iak=a=>{window.requestAnimationFrame(a)};
this.yBb=[];this.Q9.ArrowDown=!0;this.Q9.ArrowLeft=!0;this.Q9.ArrowRight=!0;this.Q9.ArrowUp=!0;this.Q9.Backspace=!0;this.Q9.Delete=!0;this.Q9.End=!0;this.Q9.Enter=!0;this.Q9.Home=!0;this.Q9.PageDown=!0;this.Q9.PageUp=!0;this.Q9.Tab=!0}kqc(a){return a.ctrlKey&&"Control"!==a.key||a.altKey&&"Alt"!==a.key||a.key in this.Q9}Eji(a){const b={};b.key=this.kqc(a)?a.key:" "===a.key?"Space":"Char";b.alt=(void 0===a.altKey||null===a.altKey?!1:a.altKey).toString();b.ctrl=a.ctrlKey.toString();b.shift=a.shiftKey.toString();
return b}Ixh(a){const b=new UI;b.metadata=this.Eji(a);b.ths=window.performance.now()-a.timeStamp;b.timeStamp=a.timeStamp;b.isCoauth=vq.kQa?(!vq.kQa.amIAlone).toString():"null";this.yBb.push(b);this.nQk()}Zxh(a){if(this.yBb.length)for(const b of this.yBb)if(b.timeStamp===a.timeStamp){b.duration=window.performance.now()-a.timeStamp-b.ths;break}}nQk(){this.Eye||(this.Iak(()=>{this.Eye=!1;window.dispatchEvent(TI.a.instance.create(ra.a.ROd,this.yBb.slice(0,this.yBb.length)));this.yBb=[]}),this.Eye=!0)}keyPressedEventHandlerStart(a){vq.oYc(a)&&
!this.kqc(a)&&this.Ixh(a)}keyPressedEventHandlerEnd(a){vq.oYc(a)&&!this.kqc(a)&&this.Zxh(a)}keyDownEventHandlerStart(a){vq.oYc(a)&&this.kqc(a)&&this.Ixh(a)}keyDownEventHandlerEnd(a){vq.oYc(a)&&this.kqc(a)&&this.Zxh(a)}static get kQa(){return vq.nEf||(vq.nEf=vb.a.instance.rb("PowerPointWebEditor.ICoauthStateGetter"))}static oYc(a){return!!a&&a.timeStamp<window.performance.now()}}vq.nEf=null;Object(n.a)(vq,"PPTEventTimingMeter",null,[549]);class Yr{constructor(){this.Xcc=[];this.$Cb=this.N6c=this.jHa=
this.m9c=null;this.l9c=0;this.r6c=!1}start(a){if(!this.r6c){Array.clear(this.Xcc);for(let b=0;b<Yr.X3b.length;++b)this.Xcc.push(0);this.m9c=window.setInterval(Object(F.a)(this,this.mjh,"reportMeasuredFrames"),1E3*a);this.l9c=window.performance.now();this.U2e(null);$addHandler(window,"visibilitychange",Object(F.a)(this,this.U2e,"updateMeasureCurrentFrameLoop"));this.r6c=!0}}stop(){this.r6c&&($removeHandler(window,"visibilitychange",Object(F.a)(this,this.U2e,"updateMeasureCurrentFrameLoop")),null!=
this.m9c&&(window.clearInterval(this.m9c),this.m9c=null),null!=this.jHa&&(window.cancelAnimationFrame(this.jHa),this.jHa=null),this.mjh(),this.r6c=!1)}mjh(){if(null!=this.$Cb){var a={};for(var b=0;b<Yr.X3b.length;++b)a[Yr.X3b[b].toString()]=this.Xcc[b],this.Xcc[b]=0;b=window.performance.now();var c={};c.intervalStart=this.l9c;c.duration=b-this.l9c;c.maxFrameLengthMs=this.$Cb;c.frameData=a;window.dispatchEvent(TI.a.instance.create(ra.a.$Pe,c));this.$Cb=null;this.l9c=b}}U2e(){Yr.GPj&&null==this.jHa?
(this.N6c=null,this.jHa=window.requestAnimationFrame(Object(F.a)(this,this.hYg,"measureCurrentFrame"))):null!=this.jHa&&(window.cancelAnimationFrame(this.jHa),this.jHa=null)}hYg(a){if(null!=this.N6c){const b=a-this.N6c;if(null==this.$Cb||this.$Cb<b)this.$Cb=b;for(let c=0;c<Yr.X3b.length;++c)if(b<Yr.X3b[c]){++this.Xcc[c];break}}this.N6c=a;this.jHa=window.requestAnimationFrame(Object(F.a)(this,this.hYg,"measureCurrentFrame"))}static get GPj(){return"visible"===window.document.visibilityState}}Yr.X3b=
[17,34,42,67,100,200,400,800,1E3,1500,2E3,3E3,Number.POSITIVE_INFINITY];Object(n.a)(Yr,"PPTFrameTimingMeter",null,[550]);class BC{constructor(){this.fgc=this.Vac=null;this.cAg=this.Pzg=!1}$b(a){window.performance&&window.performance.now&&window.requestAnimationFrame&&(u.AFrameworkApplication.fa.ka("PodEventTimingMeterIsEnabled")&&!v.a.Dj&&(a.register(549,"Common.IEventTimingMeter").ma().oa(()=>new vq),this.Pzg=!0),a.resolve("PowerPointWebEditor.IApplicationSettings").podsFrameTimingMeterIsEnabled&&
(a.register(550,"Common.IFrameTimingMeter").ma().oa(()=>new Yr),this.cAg=!0))}get name(){return"PowerPointWebEditor.EventTimingMeter"}init(){if(this.Pzg){var a=new RI(u.AFrameworkApplication.fa.Fc("PodEventTimingMeterEventSamplingPercent",0)/100);a=new SI(Object(F.a)(a,a.zVe,"shouldBeInSample"));const b=Hq.a.EW(16,1,a);this.Vac=c=>{if(c&&(c=c.rawEvent.detail))for(const h of c)b.track(h,"EventTimingData")};wd.a.addHandler(window.self,ra.a.ROd,this.Vac)}this.cAg&&(this.fgc=b=>{b&&(b=b.rawEvent)&&Ba.a.J(39706653,
306,50,dd.c(b.detail))},wd.a.addHandler(window.self,ra.a.$Pe,this.fgc))}dispose(){this.Vac&&(wd.a.removeHandler(window.self,ra.a.ROd,this.Vac),this.Vac=null);this.fgc&&(wd.a.removeHandler(window.self,ra.a.$Pe,this.fgc),this.fgc=null)}static main(){r.a.instance.Dc(new BC)}}Object(n.a)(BC,"PPTEventTimingMeterPackage",null,[2,3]);var CC=d(451);class VI{constructor(a){this.vgf=new Nd.a(null);this.HQh=a}ga(a){let b;({value:b}=this.vgf.Uf(a)).returnValue||(b=this.HQh(a),this.vgf.$(a,b));return b}}Object(n.a)(VI,
"MemoizedLookup",null,[1554]);var XP=d(833),YP=d(706);class DC{constructor(a){this.ryk=0;this.LO=a}}Object(n.a)(DC,"GraphMergerResponse",null,[]);var ZP=d(318);class EC extends Vf.a{constructor(){super();this.YourRevisions=this.TheirRevisions=this.MergedRevision=this.BaseRevisions=null;this.IgnoreConflictsInLastServerRevision=!1;this.MergeHint=0;this.RequestId=this.ObjectSpaceId=null;this.Reason=this.Source=0}$k(){return 33}static construct(a,b,c,h,m,y,G,U,ja){const va=new EC;va.BaseRevisions=a;va.TheirRevisions=
b;va.YourRevisions=c;va.IgnoreConflictsInLastServerRevision=h;va.MergeHint=m;va.ObjectSpaceId=y?hm.a(y):null;va.RequestId=G?hm.a(G):null;va.Source=U;va.Reason=ja;return va}}Object(n.a)(EC,"CreateGraphMergeReplayRequest",Vf.a,[]);d(826);class tz{Sa(a){return a.Sa(void 0)}h3f(a,b){return a.sa(b,null)}VSc(a,b){a=(a=a.sa(b,null))?Array.clone(a):[];return new Li.a(a)}k3f(a,b){return a.sa(b,"")}vqh(a,b,c){a.setValue(b,c)}}Object(n.a)(tz,"MergeableObjectUtilities",null,[577]);class $P{constructor(a,b=null,
c=null){this.PEd=b||new tz;c||Object(F.a)(this,this.WMi,"doParagraphMergeNoOP")}WMi(a,b){return{FIl:a,EIl:b}}}Object(n.a)($P,"GraphMergeSelectionRecordUpdater",null,[]);class WI{constructor(){this.source=0;this.Lu=this.dPb=this.CLa=null;this.cic=0;this.LVc=!1;this.uYe=0}}Object(n.a)(WI,"InputState",null,[]);class XI{constructor(){this.timeout=this.succeeded=this.crash=!1;this.LO=null}}Object(n.a)(XI,"OutputState",null,[]);class YI{constructor(){this.eQc=this.apd=this.uqc=!1;this.I0a=this.Xvl=this.VUi=
this.wCe=this.IEh=this.VSf=this.hxf=this.LJc=null}}Object(n.a)(YI,"RuntimeState",null,[]);class ZI{constructor(){this.input=new WI;this.runtime=new YI;this.output=new XI}}Object(n.a)(ZI,"MergeState",null,[]);var Wc=d(1085);class ux{constructor(a,b,c){this.dYh=a;this.uWh=b;this.cWh=c;this.aCd=new sb.a(Object(F.a)(this,this.kqi,"checkIfDifferent"))}get lIb(){return this.dYh}get oldValue(){return this.uWh}get newValue(){return this.cWh}get M8(){return!!this.newValue&&!this.oldValue}get isDeleted(){return!this.newValue&&
!!this.oldValue}get bab(){return this.M8||this.isDeleted||this.aCd.value}kqi(){return this.M8||this.isDeleted?!0:!Wc.a.Zvf(this.lIb,this.oldValue,this.newValue)}}Object(n.a)(ux,"PropertyDiff",null,[]);class vx{constructor(a,b){this.rWh=a;this.$Vh=b;this.aCd=new sb.a(()=>this.cYc(null));this.fYh=new sb.a(Object(F.a)(this,this.dSi,"evaluatePropertyDiffs"))}get gGb(){return this.rWh}get l5(){return this.$Vh}get M8(){return!!this.l5&&!this.gGb}get isDeleted(){return!this.l5&&!!this.gGb}get bab(){return this.M8||
this.isDeleted||this.aCd.value}get lZa(){return this.fYh.value}cYc(a){let b=!1;this.lZa.forEach((c,h)=>{b=h.bab&&(!a||7!==a.ga(c));return!b});return b}dSi(){const a=new Nd.a;var b=this.l5,c=this.gGb;if(this.M8){c=b.Tz();for(var h=0;h<c.length;h++){var m=c[h];a.$(Wc.a.wb(m),new ux(m,null,b.jta(m)))}}else if(this.isDeleted)for(b=c.Tz(),h=0;h<b.length;h++)m=b[h],a.$(Wc.a.wb(m),new ux(m,c.jta(m),null));else{h=c.Tz();for(m=0;m<h.length;m++){var y=h[m];a.$(Wc.a.wb(y),new ux(y,c.jta(y),b.Sa(y)?b.jta(y):
null))}h=b.Tz();for(m=0;m<h.length;m++)y=h[m],c.Sa(y)||a.$(Wc.a.wb(y),new ux(y,null,b.jta(y)))}return a}}Object(n.a)(vx,"MergeableObjectDiff",null,[]);class wx{constructor(a,b){this.g5=b?a.L6a():a;this.$Dc=new Ea.a}p$k(a){this.$Dc=a}vYg(a){(new vx(this.g5,a)).lZa.forEach((b,c)=>{c.bab&&!this.$Dc.contains(b)&&(this.$Dc.add(b),c.isDeleted?(c=this.g5,c.Sa(Wc.a.Tsa(b))&&c.removeProperty(Wc.a.Tsa(b))):this.g5.DKa(Wc.a.Tsa(b),c.newValue));return!0})}}Object(n.a)(wx,"PartialMergeResult",null,[]);class $I extends Vf.a{constructor(){super();
this.Location=null}$k(){return 34}static construct(a){const b=new $I;b.Location=a;return b}}Object(n.a)($I,"PlayGraphMergeReplayRequest",Vf.a,[]);class Av{constructor(a,b,c,h,m,y,G,U,ja,va,Ta){this.zoe=new XP.a;this.kbk=a;this.U9j=b;this.VWa=c(this.a5b());this.X6j=h;this.Y6j=m;this.x9c=y;this.t7c=G;this.Cwg=U;this.U6j=Ta;this.V6j=ja;this.W6j=va}eL(){return(new Date).getTime()}rkb(a,...b){return String.format.apply(null,[a].concat(b))}Tpl(a){throw rk.a.invalidOperation(a);}b8i(a){return String.format("Name: {0}, Message: {1}, Stack: {2}",
a.name,a.message,a.stack)}osj(a,b,c,h){h.$(a,new wx(b,!1));ba.ULS.sendTraceTag(19019783,808,50,"Merging Object: [Id: {0}] [ClassId: {1}]. Object wasn't in base revision, but was in conflict and favored.",a,c.Se);return!0}Yzl(a,b){const c=new bj.a;c.id=Ll.a.Hfa;c.DKa(X.a.lld,5===b?2:4);a.mrf(c);a.Rrd().nya(c.id,4)}H2k(a){var b=!a.output.succeeded&&(this.V6j||a.output.crash),c=!!a.input.CLa&&0<a.input.CLa.length;if(c=this.W6j&&c&&(this.U6j||b)){b=c?pa.a.create():pa.a.nil;c=c?String.format(" [Merge Request Id: {0}]",
b):"";Av.t1j(a,c);var h,m;({zgi:y,Npl:h,NFl:m}=this.xFi(a,Object(F.a)(this,this.TIf,"createSerializedRevisionFrom")));c=Av.h9i(a);b=EC.construct(y._list,h._list,m._list,a.input.LVc,a.input.cic,a.input.Lu,b,a.input.source,c);var y=a.output.LO;3===c&&0<y.length&&(b.MergedRevision=this.TIf(a.output.LO.last()));a=new ZP.a;a.DH=b;a.status=1;b=this.zoe.n4b(0,null);b.FZ(a);b.QCa()}}TIf(a){const b=a.hW,c=Fc.App.Kb.Jd.yi;return new YP.a(a,b,c.zi,null,c.snc,c.contextId,b?b.id:pa.a.nil,this.x9c,!1,!0)}Fbd(a,
b,c,h,m,y,G){c=this.IDi(a,b,h,m,y,G);h=0;const U=c.runtime.apd;try{if(U){const ja=a.length?a.getItemAt(a.length-1):null,va=b.length?b.getItemAt(b.length-1):null;ba.ULS.sendTraceTag(18641173,808,50,"MergeChanges: Begin.  [TheirChanges - Length:{0} Last:{1} Base:{2}] [YourChanges - Length:{3} Last:{4} Base:{5}] [MergeHint: {6}] [IgnoreConflictsInLastServerRevision: {7}] [MaxMergeTimeInMs: {8}] [FullPropertyLoggingIsEnabled: {9}] [Source: {10}]",a.length,ja?ja.id:pa.a.nil,ja?ja.hW?ja.hW.id:pa.a.nil:
pa.a.nil,b.length,va?va.id:pa.a.nil,va?va.hW?va.hW.id:pa.a.nil:pa.a.nil,m,y,this.t7c,this.Cwg,G)}for(a=!0;h<this.VWa.length&&a;h++)a=(0,this.VWa[h])(c);return new DC(c.output.LO)}catch(ja){const va=!c.output.timeout;c.output.crash=va;const Ta=String.format("Merge {0}!  Failing the merge.  [{1}] [Will continue: {2}]",va?"Crashed":"Timed Out",this.b8i(ja),!!c.output.LO);va?ba.ULS.sendTraceTag(18613134,808,10,"MergeChanges Crash. [Error: {0}]",Ta):ba.ULS.sendTraceTag(18613136,808,15,"MergeChanges Timeout. [Error: {0}]",
Ta);if(c.output.LO)return new DC(c.output.LO);throw ja;}finally{c.output.succeeded?U&&ba.ULS.sendTraceTag(18613138,808,50,this.K4b(c,h,"Succeeded")):c.output.timeout?ba.ULS.sendTraceTag(18641178,808,15,this.K4b(c,h,"Timeout")):c.output.crash?c.output.LO?ba.ULS.sendTraceTag(18613142,808,15,this.K4b(c,h,"Crash - Rejection")):ba.ULS.sendTraceTag(18613144,808,15,this.K4b(c,h,"Crash - Failed")):U&&ba.ULS.sendTraceTag(18613140,808,50,this.K4b(c,h,"Rejection")),this.H2k(c)}}K4b(a,b,c){const h=a.output.LO,
m=h&&h.length?h.getItemAt(h.length-1):null;return this.rkb("MergeChanges: End. {0}. [ElapsedTime: {1}ms] [Function: {2}] [MergedRevisions - Length:{3} Last:{4} Base:{5}] [Source: {6}]",c,this.eL()-a.input.uYe,b,h?h.length:0,m?m.id:pa.a.nil,m?m.hW?m.hW.id:pa.a.nil:pa.a.nil,a.input.source)}IDi(a,b,c,h,m,y){const G=new ZI,U=G.input;U.CLa=a;U.dPb=b;U.Lu=c;U.cic=h;U.LVc=m;U.uYe=this.eL();U.source=y;a=G.runtime;a.eQc=this.Cwg;a.uqc=!0;a.apd=!0;let ja="";a.I0a=va=>{if(this.t7c){var Ta=this.eL()-U.uYe,fb=
Ta>this.t7c;ja+=this.rkb(" ({0}: {1})",va,Ta);fb&&(G.output.timeout=!0,va=this.rkb("Exceeded [MaxMergeTimeInMs: {0}] when we reached [Details: {1}] [Elapsed Time: {2}] [Timeline:{3}]",this.t7c,va,Ta,ja),this.Tpl(va))}};return G}a5b(){return[Object(F.a)(this,this.Gvk,"otherAuthorsHaveChangesToMerge"),Object(F.a)(this,this.fNj,"isInputValid"),Object(F.a)(this,this.wDj,"initializeOutputMergeState"),Object(F.a)(this,this.QDj,"initializeRuntimeMergeState"),Object(F.a)(this,this.yul,"tryObjectMerge"),Object(F.a)(this,
this.C5h,"addMergeResultsToOutput")]}Gvk(a){const b=a.input.CLa;a=a.output;return b?b.length?!0:(ba.ULS.sendTraceTag(18613150,808,100,"OtherAuthorsHaveChangesToMerge: Received an empty list of changes to merge."),a.LO=b,a.succeeded=!0,!1):(ba.ULS.sendTraceTag(18613148,808,100,"OtherAuthorsHaveChangesToMerge: Didn't receive any changes to merge."),a.LO=b,a.succeeded=!0,!1)}fNj(a){var b=a.input;const c=b.CLa,h=b.dPb,m=b.Lu,y=b.cic;b=b.LVc;a=a.output;if(!h||!h.length)return a.LO=c,!1;let G=!0;if(2!==
y&&1!==y)return a.LO=c,!1;m&&m!==pa.a.nil||(G=!1);c.length<(b?2:1)&&(ba.ULS.sendTraceTag(18613155,808,100,"OtherAuthorsHaveChangesToMerge: Too few revisions. This will happen if the server failed its merge and rejected your change.  [ignoreConflictsInLastServerRevision: {0}]",b),G=!1);G||(a.LO=2===y?c:h);return G}QDj(a){var b=a.input,c=b.CLa,h=b.dPb;const m=b.cic;let y,G;({Mpl:y,MFl:G,LJc:b}=this.daj(a,c,h,b.LVc));if(!b)return ba.ULS.sendTraceTag(18613185,808,15,"MergeChanges: Couldn't find a common base change. [TheirLastChange.Id: {0}] [YourLastChange.Id: {1}]",
y.id,G.id),this.Dog(y,c.length,"TheirChanges"),this.Dog(G,h.length,"YourChanges"),a.output.LO=2===m?c:h,!1;a.runtime.LJc=b;({Vvl:c,TUi:h}=this.PKi(m,y,G));({Wvl:b,UUi:c,Agi:h}=Av.Nbj(a,c,h,b));a.runtime.hxf=h;a.runtime.IEh=b;a.runtime.VSf=c;a.runtime.wCe=new Nd.a;return!0}Dog(a,b,c){const h=new Li.a;for(;a;)h.add(a),a=a.hW;const m=new Sys.StringBuilder;m.append(this.rkb("{0} [PartialChainLength: {1}] [FullChainLength: {2}]",c,b,h.length));let y=h.length,G=0;h.forEach(U=>({Dag:y,Wog:G}=this.B6h(m,
U,h,y,G)).returnValue);ba.ULS.sendTraceTag(18613187,808,50,m.toString())}B6h(a,b,c,h,m){a.append(this.rkb(" [{0} {1} {2}]",h,b.Nka?"S":"B",b.id));h--;m++;return 50<m&&c.length!==m?(a.append(" ...Truncated."),{returnValue:!1,Dag:h,Wog:m}):{returnValue:!0,Dag:h,Wog:m}}daj(a,b,c,h){b=b.getItemAt(b.length-1-(h?1:0));c=c.getItemAt(c.length-1);h=b.$Qc(c);a.runtime.I0a("GetCommonBase");return{Mpl:b,MFl:c,LJc:h}}PKi(a,b,c){2===a?(a=b,b=c):a=c;return{Vvl:b,TUi:a}}wDj(a){const b=a.input,c=b.CLa,h=b.dPb;a.output.LO=
(2===b.cic?c:h).Eal();a.runtime.I0a("InitializeOutputMergeState");return!0}C5h(a){var b=a.input.Lu;const c=a.runtime.wCe,h=a.output.LO;b=this.JDi(a,h.getItemAt(h.length-1),b,pa.a.create());this.NVi(a,b,c);this.Yzl(b,a.input.source);h.add(b);return a.output.succeeded=!0}JDi(a,b,c,h){a.runtime.apd&&ba.ULS.sendTraceTag(18613189,808,50,"AddMergeRevisionToList: Creating mergeRevision with [objectSpaceId: {0}] [revisionId: {1}].",c,h);a=this.kbk(h);a.Ogi(b,c);return a}NVi(a,b,c){a.runtime.apd&&ba.ULS.sendTraceTag(18613191,
808,50,"FillRevision: Adding {0} objects to merged revision.",c.count);c.forEach((h,m)=>{Ll.a.Hfa.equals(h)||b.mrf(m.g5);return!0})}yul(a){const b=a.runtime,c=b.hxf,h=b.IEh,m=b.VSf,y=b.wCe;let G=!0;const U=a.runtime.uqc;let ja=0,va=0,Ta=0;h.forEach((fb,Db)=>{U&&ba.ULS.sendTraceTag(18613193,808,100,"Merging Object: [Id: {0}] [ClassId: {1}]",fb,Db.Se);va++;50===va&&(ja++,a.runtime.I0a(this.rkb("ObjectMerge [Cycles: {0}] [ComplexMerges: {1}]",ja,Ta)),va=0);if(Av.ail(Db.Se))return!0;var gc=m.get(fb);
if(!gc)return y.Hb(fb)?y.ga(fb).vYg(Db):y.$(fb,new wx(Db,!1)),!0;if(!c.ga(fb))return G=this.osj(fb,gc,Db,y);const hc=y.ESc(fb,new wx(c.ga(fb),!0));({E$:gc,returnValue:G}=this.Y6j.merge(a,this.X6j,this.U9j,hc,gc,Db));Ta++;G&&(a.runtime.I0a(this.rkb("ObjectMerge [Id: {0}] [ClassId: {1}] [ComplexMerges: {2}] [Cycles: {3}]",fb,Db.Se,Ta,ja)),gc&&(y.Hb(gc.g5.id)?y.ga(gc.g5.id).vYg(gc.g5):y.$(gc.g5.id,gc)));return G});U&&ba.ULS.sendTraceTag(18613199,808,100,"TryObjectMerge: Merged {0} objects. {1} were complex merges.",
h.count,Ta);return G}xFi(a,b){const c=new Li.a,h=new Li.a,m=new Li.a;var y=a.runtime.LJc;const G=y?y.id:pa.a.nil;this.wme(y).forEach(U=>{c.add(b(U));return!0});y=a.input.CLa.getItemAt(a.input.CLa.length-1);this.wme(y,G).forEach(U=>{h.add(b(U));return!0});a=a.input.dPb.getItemAt(a.input.dPb.length-1);this.wme(a,G).forEach(U=>{m.add(b(U));return!0});return{zgi:c,Npl:h,NFl:m}}wme(a,b=null){const c=new Li.a;b||(b=pa.a.nil);for(;a&&!b.equals(a.id);)c.add(a),a=a.hW;c.reverse();return c}vb(){}get delayedMergeOperation(){return null}set delayedMergeOperation(a){}static t1j(a,
b){ba.ULS.sendTraceTag(18613146,808,50,"Sending merge backup. [Crash: {0}] [Timeout: {1}] {2}",a.output.crash,a.output.timeout,b)}static h9i(a){return a.output.crash?2:a.output.succeeded?3:1}static Nbj(a,b,c,h){let m;({result:m}=b.Hbd(h));a.runtime.I0a("GetUnfavoredChanges");let y;new Nd.a;({result:y}=c.Hbd(h));5===a.input.source&&(a.runtime.VUi=CC.a.t3f(c.Rrd()),a.runtime.Xvl=CC.a.t3f(b.Rrd()));b=y;a.runtime.I0a("GetFavoredChanges");h=new VI(Object(F.a)(h,h.qwb,"getMergeableObject"));a.runtime.I0a("GetModifiedObjects");
return{Wvl:m,UUi:b,Agi:h}}static ail(a){switch(a){case 1074135137:case 1074135138:case 1074135140:return!0}return!1}}Object(n.a)(Av,"GraphMerger",null,[1057,548]);class aJ{get HCa(){return 8}get PJa(){return[]}get jMa(){return[Wc.a.wb(X.a.AM),Wc.a.wb(X.a.Yrc)]}get aMa(){return[]}get fQa(){return[Wc.a.wb(kb.a.NA)]}get QQa(){return[]}gG(a){return 1074135126===a.Se}R0a(){return!0}get GCa(){return[Wc.a.wb(X.a.cid),Wc.a.wb(X.a.sid)]}get b0a(){return!0}}Object(n.a)(aJ,"CommentContentNodeComplexMerge",null,
[578]);class bJ{get HCa(){return 8}get PJa(){return[]}get jMa(){return[Wc.a.wb(X.a.$sb),Wc.a.wb(X.a.LUd),Wc.a.wb(X.a.Ysb),Wc.a.wb(X.a.G_b),Wc.a.wb(X.a.gKe),Wc.a.wb(X.a.fKe),Wc.a.wb(X.a.AM),Wc.a.wb(X.a.Yrc),Wc.a.wb(X.a.$Td)]}get aMa(){return[Wc.a.wb(X.a.jca),Wc.a.wb(X.a.Qra),Wc.a.wb(X.a.BUd),Wc.a.wb(X.a.H_b),Wc.a.wb(X.a.CJc)]}get fQa(){return[]}get QQa(){return[]}gG(a){return 1074135127===a.Se}R0a(){return!0}get GCa(){return[Wc.a.wb(X.a.cid),Wc.a.wb(X.a.sid),Wc.a.wb(X.a.commentId),Wc.a.wb(X.a.jxa),
Wc.a.wb(jb.a.CUd),Wc.a.wb(X.a.DUd),Wc.a.wb(X.a.H_b),Wc.a.wb(X.a.CJc)]}get b0a(){return!0}}Object(n.a)(bJ,"CommentNodeComplexMerge",null,[578]);class cJ{constructor(a){this.h$c=a}get HCa(){return 8}get PJa(){return[]}get jMa(){return this.h$c.jMa}get aMa(){return[]}get fQa(){return[Wc.a.wb(kb.a.NA)]}get QQa(){return[]}gG(a){return 393326===a.Se}R0a(){return!0}get GCa(){const a=new Qa.a;Mr.a(a,this.h$c.PJa);Mr.a(a,this.h$c.GCa);Mr.a(a,this.h$c.aMa);Mr.a(a,[Wc.a.wb(X.a.azb),Wc.a.wb(X.a.Kcd)]);return a.toArray()}get b0a(){return!0}}
Object(n.a)(cJ,"NotesContentNodeComplexMerge",null,[578]);class dJ{get HCa(){return 8}get PJa(){return[Wc.a.wb(X.a.lNi),Wc.a.wb(X.a.fNi),Wc.a.wb(X.a.P7b),Wc.a.wb(X.a.nbl)]}get jMa(){return[Wc.a.wb(X.a.Qqb),Wc.a.wb(X.a.Rqb),Wc.a.wb(X.a.drb),Wc.a.wb(X.a.erb),Wc.a.wb(X.a.NCa),Wc.a.wb(X.a.pDe),Wc.a.wb(X.a.RCe),Wc.a.wb(X.a.qDe),Wc.a.wb(X.a.FJb),Wc.a.wb(X.a.HJb),Wc.a.wb(X.a.Hxb),Wc.a.wb(X.a.Vtb),Wc.a.wb(X.a.qHb)]}get aMa(){return[]}get fQa(){return[Wc.a.wb(kb.a.Y6a),Wc.a.wb(jb.a.appsNode)]}get QQa(){return[]}gG(a){return 393271===
a.Se}get GCa(){return[Wc.a.wb(X.a.presentationId),Wc.a.wb(X.a.slideWidth),Wc.a.wb(X.a.slideHeight),Wc.a.wb(X.a.xY),Wc.a.wb(X.a.caa),Wc.a.wb(X.a.h$a),Wc.a.wb(X.a.kFb),Wc.a.wb(X.a.F0),Wc.a.wb(X.a.ZFb),Wc.a.wb(X.a.bfa),Wc.a.wb(X.a.embeddedFonts),Wc.a.wb(X.a.zJa)]}get b0a(){return!0}R0a(){return!0}}Object(n.a)(dJ,"PresentationNodeComplexMerge",null,[578]);class eJ{get HCa(){return 8}get PJa(){return[Wc.a.wb(X.a.OJa),Wc.a.wb(X.a.aKb)]}get jMa(){return[Wc.a.wb(kb.a.font),Wc.a.wb(X.a.oC),Wc.a.wb(X.a.rIc),
Wc.a.wb(X.a.Tgb),Wc.a.wb(X.a.AM),Wc.a.wb(X.a.n0a),Wc.a.wb(X.a.tn),Wc.a.wb(X.a.YYa),Wc.a.wb(X.a.Jxb),Wc.a.wb(X.a.kka),Wc.a.wb(X.a.d0a),Wc.a.wb(X.a.b1),Wc.a.wb(X.a.cpa),Wc.a.wb(X.a.B1b),Wc.a.wb(X.a.mvb),Wc.a.wb(X.a.Qxa),Wc.a.wb(X.a.Dya),Wc.a.wb(X.a.Coa),Wc.a.wb(X.a.Cya),Wc.a.wb(X.a.mediaType),Wc.a.wb(X.a.Tgb),Wc.a.wb(X.a.Mzb),Wc.a.wb(X.a.L7g),Wc.a.wb(X.a.N7g),Wc.a.wb(X.a.sya),Wc.a.wb(X.a.woa),Wc.a.wb(X.a.hsh),Wc.a.wb(X.a.Eod),Wc.a.wb(kb.a.Il),Wc.a.wb(kb.a.XI),Wc.a.wb(X.a.FAh),Wc.a.wb(X.a.GAh),Wc.a.wb(X.a.kNb),
Wc.a.wb(X.a.xLa),Wc.a.wb(X.a.zaa),Wc.a.wb(X.a.msc),Wc.a.wb(X.a.QO),Wc.a.wb(X.a.outlineWidth),Wc.a.wb(ge.a.Sld),Wc.a.wb(X.a.Ahd),Wc.a.wb(zm.a.C8b),Wc.a.wb(X.a.lN),Wc.a.wb(X.a.YP),Wc.a.wb(X.a.Yrc),Wc.a.wb(X.a.tMb),Wc.a.wb(X.a.f0a),Wc.a.wb(X.a.Gsb),Wc.a.wb(X.a.Tzb),Wc.a.wb(X.a.gN),Wc.a.wb(X.a.ywh),Wc.a.wb(X.a.Kxb)]}get aMa(){return[Wc.a.wb(X.a.alt),Wc.a.wb(X.a.Vqb),Wc.a.wb(X.a.H$),Wc.a.wb(X.a.Bie),Wc.a.wb(X.a.lle),Wc.a.wb(X.a.qka),Wc.a.wb(X.a.shapeType),Wc.a.wb(X.a.lNb),Wc.a.wb(X.a.rotation),Wc.a.wb(X.a.xoc),
Wc.a.wb(X.a.Bca),Wc.a.wb(X.a.Aca),Wc.a.wb(kb.a.nx),Wc.a.wb(kb.a.wC),Wc.a.wb(kb.a.qy),Wc.a.wb(kb.a.ry),Wc.a.wb(X.a.cPb),Wc.a.wb(X.a.rxb),Wc.a.wb(X.a.x4e),Wc.a.wb(X.a.y4e),Wc.a.wb(X.a.G2),Wc.a.wb(X.a.hP),Wc.a.wb(X.a.zia),Wc.a.wb(X.a.yia),Wc.a.wb(X.a.Bia),Wc.a.wb(X.a.Aia),Wc.a.wb(X.a.FXe),Wc.a.wb(X.a.Bod),Wc.a.wb(X.a.Ifa),Wc.a.wb(X.a.Dod),Wc.a.wb(X.a.Aua),Wc.a.wb(X.a.gGc)]}get fQa(){return[Wc.a.wb(kb.a.NA)]}get QQa(){return[]}gG(a){return 1074135132===a.Se}R0a(){return!0}get GCa(){return[Wc.a.wb(X.a.cid),
Wc.a.wb(X.a.sid),Wc.a.wb(X.a.shapeId),Wc.a.wb(X.a.vUa),Wc.a.wb(X.a.RYa),Wc.a.wb(X.a.FIa),Wc.a.wb(X.a.RJj),Wc.a.wb(X.a.vL),Wc.a.wb(X.a.isResizable),Wc.a.wb(X.a.isEditable),Wc.a.wb(X.a.tua),Wc.a.wb(X.a.KI),Wc.a.wb(X.a.Gj),Wc.a.wb(X.a.NU),Wc.a.wb(X.a.iRa),Wc.a.wb(X.a.jRa),Wc.a.wb(X.a.f$a),Wc.a.wb(X.a.g$b),Wc.a.wb(X.a.hasText),Wc.a.wb(X.a.pT),Wc.a.wb(X.a.ar),Wc.a.wb(X.a.isConnected),Wc.a.wb(X.a.Jf),Wc.a.wb(X.a.cFa),Wc.a.wb(X.a.Cq),Wc.a.wb(X.a.Vy),Wc.a.wb(X.a.Mp),Wc.a.wb(X.a.Bda),Wc.a.wb(X.a.gl),Wc.a.wb(X.a.xT),
Wc.a.wb(X.a.Ej),Wc.a.wb(X.a.Rf),Wc.a.wb(X.a.G_),Wc.a.wb(X.a.aq),Wc.a.wb(X.a.lx),Wc.a.wb(X.a.yra),Wc.a.wb(X.a.rGc),Wc.a.wb(X.a.Hsb),Wc.a.wb(kb.a.UN),Wc.a.wb(jb.a.L_),Wc.a.wb(X.a.P7b),Wc.a.wb(X.a.zOf),Wc.a.wb(X.a.u_d),Wc.a.wb(X.a.UVk),Wc.a.wb(X.a.skd),Wc.a.wb(X.a.fh),Wc.a.wb(X.a.Fcd),Wc.a.wb(X.a.vae),Wc.a.wb(X.a.lae),Wc.a.wb(X.a.KK),Wc.a.wb(X.a.Uta),Wc.a.wb(X.a.VYb),Wc.a.wb(X.a.IQ),Wc.a.wb(X.a.jOb),Wc.a.wb(X.a.embeddedFonts),Wc.a.wb(X.a.TEa),Wc.a.wb(X.a.ksc),Wc.a.wb(X.a.nJh),Wc.a.wb(X.a.kch),Wc.a.wb(X.a.E0c),
Wc.a.wb(X.a.Cod),Wc.a.wb(X.a.afa),Wc.a.wb(X.a.Wna),Wc.a.wb(X.a.I3),Wc.a.wb(X.a.UFb),Wc.a.wb(X.a.VFb),Wc.a.wb(X.a.WFb),Wc.a.wb(X.a.Zma),Wc.a.wb(X.a.L3)]}get b0a(){return!0}}Object(n.a)(eJ,"ShapeNodeComplexMerge",null,[578]);class xx{constructor(a,b){this.Qbk=a;this.xck=b}get HCa(){return this.xck}get PJa(){return[]}get jMa(){return[]}get aMa(){return[]}get fQa(){return[]}get QQa(){return[]}gG(a){return this.Qbk(a)}R0a(){return!1}get GCa(){return[]}get b0a(){return!1}}Object(n.a)(xx,"SimpleStrategyComplexMerge",
null,[578]);class fJ{get HCa(){return 8}get PJa(){return[]}get jMa(){return[Wc.a.wb(X.a.backgroundColor),Wc.a.wb(X.a.tsa),Wc.a.wb(X.a.L_e),Wc.a.wb(X.a.Oaa),Wc.a.wb(X.a.zna),Wc.a.wb(X.a.daa),Wc.a.wb(X.a.vz),Wc.a.wb(X.a.mra),Wc.a.wb(X.a.lN),Wc.a.wb(X.a.YP),Wc.a.wb(X.a.AM),Wc.a.wb(X.a.Fya)]}get aMa(){return[Wc.a.wb(X.a.M0a),Wc.a.wb(X.a.hj),Wc.a.wb(X.a.Bn),Wc.a.wb(X.a.Ne),Wc.a.wb(X.a.cW),Wc.a.wb(X.a.cQc),Wc.a.wb(X.a.dPd)]}get fQa(){return[Wc.a.wb(kb.a.NA),Wc.a.wb(X.a.notesContentNode),Wc.a.wb(jb.a.commentContentNode)]}get QQa(){return[]}gG(a){return 393227===
a.Se}R0a(){return!0}get GCa(){return[Wc.a.wb(X.a.cid),Wc.a.wb(X.a.sid),Wc.a.wb(X.a.DS),Wc.a.wb(X.a.awh),Wc.a.wb(kb.a.an),Wc.a.wb(X.a.QUa),Wc.a.wb(X.a.ida),Wc.a.wb(X.a.qEa),Wc.a.wb(X.a.r$a),Wc.a.wb(X.a.title),Wc.a.wb(X.a.xY),Wc.a.wb(X.a.caa),Wc.a.wb(X.a.P7b),Wc.a.wb(X.a.q$a),Wc.a.wb(X.a.i$a),Wc.a.wb(X.a.fh),Wc.a.wb(X.a.Wna)]}get b0a(){return!0}}Object(n.a)(fJ,"SlideNodeComplexMerge",null,[578]);class gJ{constructor(a,b){this.Lug=a;this.i5j=b}ga(a){return this.Lug.ESc(a,this.i5j)}get B0d(){return this.Lug}}
Object(n.a)(gJ,"PropertyMergeStrategies",null,[]);const FC=(a,b,c,h,m)=>{if(b){h=h||new tz;if(!a){a=b=b.L6a();const y=a.Tz();for(let G=0;G<y.length;G++){const U=y[G];if(un.a.fWf(U)===un.a.string){const ja=h.k3f(a,U);h.vqh(a,U,ja?"Redacted: "+ja.length:"null")}}}ba.ULS.sendTraceTag(18613206,m,50,c,b.Qrd())}else ba.ULS.sendTraceTag(18613204,m,10,c,"{0}: Node was null.",c)};class hJ{constructor(a,b,c){this.Brg=new Ea.a;this.w7c=a;this.Bva=b;this.VWa=c(this.a5b());this.T9j=new sb.a(Object(F.a)(this,this.B0d,
"evalPropertyMergeStrategies"))}v0j(a){if(!a.NIh){a.NIh=!0;var b=a.Ibd.runtime.eQc,c=a.khk;FC(b,a.d6a.value.gGb,"Base",c,808);FC(b,a.d6a.value.l5,"Favored",c,808);FC(b,a.PYb.value.l5,"Conflict",c,808)}}tul(a,b,c,h){this.kVa(a,c);const m=a.E$;if(2===h||7===h||a.eic.contains(c))return!0;if(5===h)return!1;if(4===h||3===h){if(({value:y}=a.d6a.value.lZa.Uf(c)).returnValue&&y.bab)return 4!==h;h=0}if(0===h){if(!b.isDeleted)return m.DKa(Wc.a.Tsa(c),b.newValue),!0;h=6}if(8===h){let G=a.RJc.value;b=!0;if(({value:y}=
G.lZa.Uf(c)).returnValue&&G.bab){var y=this.w7c.ohj(a.Ibd.input.source,y);void 0!==y&&null!==y?m.DKa(Wc.a.Tsa(c),y):(b=!1,h=6)}if(b)return!0}return 9===h&&(b=!0,({value:y}=a.RJc.value.lZa.Uf(c)).returnValue&&(y=this.w7c.n6f(a.Ibd.input.source,y),void 0!==y&&null!==y?m.DKa(Wc.a.Tsa(c),y):(b=!1,h=6)),b)?!0:6===h?(m.removeProperty(Wc.a.Tsa(c)),!0):1===h?this.Bva.R0a(a,c):!1}bYa(a){return a}a5b(){return[Object(F.a)(this,this.Cul,"tryPreProcessFavoredRevision"),Object(F.a)(this,this.fti,"cloneObjectAndRemoveNeededProperties"),
Object(F.a)(this,this.sul,"tryMergeNodeInternal")]}get Dhd(){return this.T9j.value}rul(a){const b=a.d6a.value;ba.ULS.sendTraceTag(18659235,808,100,"TryMergeNode: Complex merge begin for object: [Id: {0}] [ClassId: {1}]",b.l5.id,b.l5.Se);for(let c=0;c<this.VWa.length;c++)if(!(0,this.VWa[c])(a))return ba.ULS.sendTraceTag(18659265,808,50,"TryMergeNode: Complex Merge failed for object: [Id: {0}] [ClassId: {1}] [Step: {2}]",b.l5.id,b.l5.Se,c),this.v0j(a),a.E$=null,!1;ba.ULS.sendTraceTag(18659267,808,100,
"TryMergeNode: Complex Merge succeeded for object: [Id: {0}] [ClassId: {1}]",b.l5.id,b.l5.Se);return!0}Cul(a){const b=a.d6a.value;if(!b.bab)return!0;const c=this.Dhd;let h=!0;b.lZa.forEach((m,y)=>{if(!y.bab||a.eic.contains(m))return!0;y=c.ga(m);if(5===y)return ba.ULS.sendTraceTag(18659269,808,50,"TryPreProcessFavoredRevision: Failed for [ClassId: {0}] [Property: {1}] was different from the base revision, but has a [MergeStrategy: {2}].",b.gGb.Se,m,y),h=!1;6===y&&a.qLe.add(m);return!0});return h}fti(a){a.E$=
a.d6a.value.l5.L6a();const b=a.qLe,c=a.E$;b&&b.forEach(h=>{c.removeProperty(Wc.a.Tsa(h));return!0});return!0}sul(a){const b=a.PYb.value,c=b.gGb.Se,h=this.Dhd;let m=!0;b.lZa.forEach((y,G)=>{if(this.Bva.b0a&&!this.Dhd.B0d.Hb(y)){var U=String.format("prop id: {0} is missed in merge handlers for class {1}, please add it",y,c);ba.ULS.sendTraceTag(18970259,808,50,U)}U=h.ga(y);m=this.tul(a,G,y,U);m||(a.E$=null,ba.ULS.sendTraceTag(18659271,808,50,"TryMergeProperty: Failed for [ClassId: {0}] [Property: {1}] [MergeStrategy: {2}].",
c,y,U));return m});return m}P9i(){return[Wc.a.wb(kb.a.MPf),Wc.a.wb(kb.a.lastModifiedTime),Wc.a.wb(kb.a.BE),Wc.a.wb(kb.a.Eib),Wc.a.wb(kb.a.blh),Wc.a.wb(Ie.a.Mic),Wc.a.wb(jb.a.Uvi),Wc.a.wb(jb.a.yOf),Wc.a.wb(Js.a.Dw)]}B0d(){var a=this.P9i(),b=this.Bva.PJa,c=this.Bva.jMa,h=this.Bva.aMa,m=this.Bva.QQa,y=this.Bva.fQa;const G=this.Bva.GCa,U=new Nd.a(0);for(let ja=0;ja<a.length;ja++)U.$(a[ja],this.bYa(7));for(a=0;a<b.length;a++)U.$(b[a],this.bYa(8));for(b=0;b<c.length;b++)U.$(c[b],this.bYa(7));for(c=0;c<
h.length;c++)U.$(h[c],this.bYa(9));for(h=0;h<m.length;h++)U.$(m[h],this.bYa(1));for(m=0;m<y.length;m++)U.$(y[m],this.bYa(9)),this.Brg.add(y[m]);for(y=0;y<G.length;y++)U.$(G[y],this.bYa(this.Bva.HCa));return new gJ(U,this.bYa(this.Bva.HCa))}kVa(a,b){this.Brg.contains(b)&&(a=a.E$,ba.ULS.sendTraceTag(18956752,808,50,"Merge child nodes for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}] []",a.id,a.Se,b))}}Object(n.a)(hJ,"GraphNodeComplexMerge",null,[608]);class iJ{constructor(a,b){this.Bl=a;this.Q4c=
b;this.M4j=this.JCi()}JCi(){const a=[];this.Bl.forEach(b=>{a.push(new hJ(this.Q4c,b,c=>c))});return a}ICi(a){for(let b=0;b<this.Bl.length;b++)if(this.Bl[b].gG(a))return this.M4j[b];return null}}Object(n.a)(iJ,"GraphNodeComplexMergeFactory",null,[546]);class jJ{ohj(a,b){this.nIh(a);return 5===a?b.newValue:b.oldValue}n6f(a,b){this.nIh(a);return 5===a?b.oldValue:b.newValue}nIh(a){1!==a&&5!==a&&ba.ULS.sendTraceTag(18613264,808,15,"Unexpected merge source: {0}",a)}}Object(n.a)(jJ,"GraphNodeComplexMergeHelper",
null,[579]);class kJ{constructor(a,b,c,h,m,y){this.qLe=this.eic=null;this.o$b=this.NIh=!1;this.E$=null;this.uqc=a.runtime.uqc;this.Ibd=a;this.khk=b;this.d6a=c;this.PYb=h;this.RJc=m;this.s7f=y}}Object(n.a)(kJ,"GraphNodeComplexMergeState",null,[]);class lJ{constructor(a){this.VWa=a(this.a5b())}a5b(){return[Object(F.a)(this,this.Uhl,"simpleMerge"),Object(F.a)(this,this.kvi,"complexMerge")]}zal(a,b,c,h,m,y){a=new kJ(a,c,new sb.a(()=>new vx(h.g5,m)),new sb.a(()=>new vx(h.g5,y)),new sb.a(()=>new vx(y,m)),
b.ICi(m));a.eic=h.$Dc;a.qLe=new Li.a;return a}merge(a,b,c,h,m,y){a=this.zal(a,b,c,h,m,y);b=!0;for(c=0;c<this.VWa.length&&b;c++)b=(0,this.VWa[c])(a);(b=a.o$b&&a.E$?new wx(a.E$,!1):null)&&b.p$k(a.eic);return{returnValue:a.o$b,E$:b}}Uhl(a){var b=a.s7f.Dhd;return a.PYb.value.cYc(b)&&a.RJc.value.cYc(b)?a.d6a.value.cYc(b)?!0:(b=a.PYb.value.l5,a.o$b=!0,a.E$=b.L6a(),!1):(a.o$b=!0,!1)}kvi(a){const b=a.PYb.value.l5;a.uqc&&ba.ULS.sendTraceTag(18613266,808,100,"ComplexMerge: Begin [Id: {0}] [ClassId: {1}]",b.id,
b.Se);const c=a.s7f.rul(a);a.o$b=c;ba.ULS.sendTraceTag(18613268,808,c?100:50,"ComplexMerge: {0} for object: [Id: {1}] [ClassId: {2}] [MergedObject returned: {3}]",c?"Succeeded":"Failed",b.id,b.Se,!!a.E$);return c}}Object(n.a)(lJ,"GraphNodeMerge",null,[547]);class gu{constructor(a){this.w7c=a}NMi(a){const b=a.RJc.value,c=a.E$;a=a.Ibd.input.source;for(const m of gu.Pld)if(({value:h}=b.lZa.Uf(m)).returnValue){var h=this.w7c.n6f(a,h);void 0!==h&&null!==h?c.DKa(Wc.a.Tsa(m),h):c.removeProperty(Wc.a.Tsa(m))}}get PJa(){return[Wc.a.wb(X.a.xT),
Wc.a.wb(X.a.Jhe),Wc.a.wb(X.a.Khe),Wc.a.wb(X.a.khe)]}get jMa(){return[]}get aMa(){return[]}get fQa(){return[]}get QQa(){return gu.Pld}get GCa(){return[]}get b0a(){return!1}get HCa(){return 9}gG(a){return 393230===a.Se}R0a(a,b){return 0<=Array.indexOf(gu.Pld,b)?(this.NMi(a),gu.Pld.forEach(c=>{a.eic.add(c)}),!0):!1}}gu.Pld=[Wc.a.wb(kb.a.pq),Wc.a.wb(kb.a.Kkb),Wc.a.wb(kb.a.nsc),Wc.a.wb(kb.a.dLa),Wc.a.wb(kb.a.Kwa),Wc.a.wb(jb.a.kZa)];Object(n.a)(gu,"ParagraphNodeComplexMerge",null,[578]);class GC{constructor(){this.K=
null}get name(){return"PowerPointWebEditor.GraphMerge"}$b(a){this.K=a;a.register(jJ,"PowerPointWebEditor.GraphMerge.GraphNodeComplexMergeHelper").as("PowerPointWebEditor.GraphMerge.IGraphNodeComplexMergeHelper").ma();const b=[393229,393234,1074135136,131073,1179649,393252,393250,393251];a.register(546,"PowerPointWebEditor.GraphMerge.IGraphNodeComplexMergeFactory").ma().oa(()=>{const c=new eJ;return new iJ([new dJ,new fJ,c,new gu(a.resolve("PowerPointWebEditor.GraphMerge.IGraphNodeComplexMergeHelper")),
new aJ,new bJ,new cJ(c),new xx(h=>Array.contains(b,h.Se),9),new xx(h=>131140===h.Se,6),new xx(h=>131164===h.Se,8),new xx(()=>!0,5)],a.resolve("PowerPointWebEditor.GraphMerge.IGraphNodeComplexMergeHelper"))});a.register(tz,"PowerPointWebEditor.GraphMerge.MergeableObjectUtilities").as("Box4.StorageObjectSpace.IMergeableObjectUtilities").ma();a.register(547,"PowerPointWebEditor.GraphMerge.IGraphNodeMerge").ma().oa(()=>new lJ(c=>c));a.register(548,"Box4.IBrowserGraphMerger").ma().oa(()=>new Av(c=>new CC.a(c),
a.resolve("Box4.StorageObjectSpace.IMergeableObjectUtilities"),c=>c,a.resolve("PowerPointWebEditor.GraphMerge.IGraphNodeComplexMergeFactory"),a.resolve("PowerPointWebEditor.GraphMerge.IGraphNodeMerge"),(c,h,m)=>new tn.a(c,h,m),a.resolve("PowerPointWebEditor.IApplicationSettings").oUc,a.resolve("PowerPointWebEditor.IApplicationSettings").Hgg,a.resolve("PowerPointWebEditor.IApplicationSettings").jMj,a.resolve("PowerPointWebEditor.IApplicationSettings").hMj,a.resolve("PowerPointWebEditor.IApplicationSettings").iMj))}init(){const a=
this.K.resolve("Box4.IBrowserGraphMerger");Fc.App.ALa.lhi(a)}dispose(){}static main(){r.a.instance.Dc(new GC)}}Object(n.a)(GC,"PPTWebEditorGraphMergePackage",null,[2,3]);class mJ{constructor(a,b){this.Bl=a;this.lR=b}q0i(a){let b=null,c=null;if(a&&a.rootNode)for(const h of this.Bl)if(h.UHj(a)){c=h;const m=this.lR.Ci("UserAction",h.name);b=h.n0i(a);m.stop();break}b||Ba.a.J(21860568,307,15,"{0} processed {1} but did not generate any HTML",c?c.name:"NoHandler",a&&a.rootNode?a.rootNode.type:0);return b}p0i(a){if(!a||
1>a.length)return null;const b=document.createElement("div");for(const c of a)(a=this.q0i(c))&&b.appendChild(a);return b}}Object(n.a)(mJ,"HtmlExportProcessor",null,[543]);class HC{constructor(){this.vCc=null}get rootNode(){return this.vCc}clone(){return Object.assign(new HC,{vCc:this.rootNode})}}Object(n.a)(HC,"HtmlExportContext",null,[]);class nJ{o0i(a,b){const c=[];for(const h of a)b&&!b(h)||c.push(Object.assign(new HC,{vCc:h}));return c}}Object(n.a)(nJ,"HtmlExportUtils",null,[545]);class oJ{constructor(a){this.wqe=
null;this.Gq=a}get dOi(){return this.wqe=this.wqe||document.createElement("div")}r0i(a,b){if(!a||!a.rootNode||!b)return null;b.RBa(this.dOi);const c=this.Gq.le(3);try{c.kd(a.rootNode),c.NKa(b.Ma),b.Tx(a.rootNode),b.uza()}finally{c&&c.dispose()}a=b.KRf;b.detach();return a}}Object(n.a)(oJ,"HtmlGenerator",null,[544]);class IC{constructor(a,b,c){this.k7j=a;this.l7j=b;this.Pb=c}get name(){return"PPTTableHtmlExportHandler"}UHj(a){return 14===a.rootNode.type?!0:10===a.rootNode.type?(a=Object(ua.a)(4,a.rootNode),
!!a&&a.ud):!1}n0i(a){return this.l7j.r0i(this.kkj(a),this.k7j)}kkj(a){if(10===a.rootNode.type){const b=a.clone();a=this.Pb.Nc(a.rootNode);a.Bb(1);b.vCc=a.Bb(2);return b}return a}}Object(n.a)(IC,"PPTTableHtmlExportHandler",null,[1058]);class JC extends sf.a{constructor(a,b){super(new We.a,a,b)}get KRf(){return this.VAh}}Object(n.a)(JC,"AHtmlExportView",sf.a,[598,565,167,106]);class KC{}KC.aTi="ExportedPPTTable";Object(n.a)(KC,"HtmlExportConstants",null,[]);class LC extends JC{constructor(a,b){super(a,
b)}get KRf(){const a=this.VAh.getElementsByTagName("table");return 0<a.length?(Sys.UI.DomElement.addCssClass(a[0],KC.aTi),a[0]):null}get Vl(){return!0}get GF(){return 480}}Object(n.a)(LC,"PPTTableHtmlExportView",JC,[]);class MC{constructor(){this.K=null}get name(){return"PowerPointWebEditor.HtmlExport"}$b(a){this.K=a;this.K.register(543,"PowerPointWebEditor.HtmlExport.IHtmlExportProcessor").ma().oa(()=>new mJ([this.K.resolve("PowerPointWebEditor.HtmlExport.PPTTableHtmlExportHandler")],this.K.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder")));
this.K.register(544,"PowerPointWebEditor.HtmlExport.IHtmlGenerator").ma().oa(()=>new oJ(this.K.resolve("Box4.Graph.IGraphTransactionFactory")));this.K.register(545,"PowerPointWebEditor.HtmlExport.IHtmlExportUtils").ma().oa(()=>new nJ);this.Wwi()}init(){}dispose(){}Wwi(){this.K.register(LC,"PowerPointWebEditor.HtmlExport.PPTTableHtmlExportView").ma().oa(()=>new LC(this.K.resolve("Box4.IHtmlViewRootFactory"),this.K.resolve("Box4.IViewManager")));this.K.register(IC,"PowerPointWebEditor.HtmlExport.PPTTableHtmlExportHandler").ma().oa(()=>
new IC(this.K.resolve("PowerPointWebEditor.HtmlExport.PPTTableHtmlExportView"),this.K.resolve("PowerPointWebEditor.HtmlExport.IHtmlGenerator"),this.K.resolve("Box4.Graph.IGraphIteratorFactory")))}static main(){r.a.instance.Dc(new MC)}}Object(n.a)(MC,"HtmlExportPackage",null,[2,3]);class uz extends Nh.a{constructor(a,b){super();this.wwc=0;this.CDd=null;this.ro="<div class='WACDialogRow' id='IntroBlock'> <label id='IntroLabel' class='WACDialogLabel' for='LanguageList' >{0}</label> </div> <div class='LanguagesListDiv' id='LanguageListDiv'> <select class='UIFont WACDialogList' id='LanguageList' size='11'> </select> <label id='SpellingLabel' class='WACDialogLabel' >{1}</label> </div> <div class='WACDialogCheckBoxDiv' id='DoNotCheckSpellingBlock'> <input type='checkbox' id='DoNotCheckSpelling' class='WACDialogCheckBox' title='{2}'></input> <label id='\"\"' class='WACDialogLabel' for='DoNotCheckSpelling' >{2}</label> </div>";
this.Cef=a;this.Bef=b;this.ig="LanguageDialog"}Fqc(){this.qg=this.D3d();this.wwc=({nch:a}=this.Cef.V3f()).returnValue;var a={["LanguageList"]:10,["DoNotCheckSpelling"]:!a};this.$i(Box4Intl.Box4Strings.l_Language,Object(F.a)(this,this.b7k,"setLanguageHandler"),a);this.CDd=document.getElementById("LanguageList");this.Bef.$Ak(this.CDd,this.wwc)}D3d(){return Nh.a.gC(this.ro,Box4Intl.Box4Strings.l_MarkSelectedText,Box4Intl.Box4Strings.l_SpellingWillUseLanguage,Box4Intl.Box4Strings.l_DoNotCheckSpelling)}b7k(a,
b){if(J.a.instance.ga(70)){var c=ec.a.instance.Vp(D.a.a7k);1!==a?c.properties.$("canceled","true"):(a=b.DoNotCheckSpelling,0<=b.LanguageList&&(b=parseInt(this.CDd.value),this.Cef.Pqh(b,a),c.properties.$("PreviousLCID",this.wwc.toString()),c.properties.$("ChangedLCID",b.toString()),c.properties.$("NoProof",a.toString()),this.Bef.$6k(b,this.wwc)),Fc.App.Kb.updateCommandUI(!0));c.end()}}}Object(n.a)(uz,"LanguageDialog",Nh.a,[1061]);class pJ{constructor(){this.cWj=["version","xmlns","xmlns:xlink","style"]}sanitize(a){try{const b=
{};b.inputString=a;b.unsupportedContentCallback=Object(F.a)(this,this.lWj,"jsanityUnsupportedCallBack");return jSanity.sanitize(b)}catch(b){Ba.a.J(38398044,815,10,"Unexpected exception when converting svg: {0}, stack: {1}",b.message,b.stack)}return null}e0k(a){var b=this.sanitize(a);let c=null;if(b&&b.innerHTML&&b.innerHTML.startsWith("<svg")){c=b.innerHTML;if(0<a.indexOf("viewBox")&&0>c.indexOf("viewBox"))if((b=a.match(RegExp('viewBox="[^"]*')))&&1===b.length&&b[0])c=c.replace("<svg",String.format('<svg {0}"',
b[0]));else return null;if(0<a.replace(" ","").indexOf('xmlns="http://www.w3.org/'))c=0<c.indexOf("xmlns=")?c:c.replace("<svg",String.format("<svg {0}",'xmlns ="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"'));else return null}return c}lWj(a,b){b=b.toLowerCase();for(const c of this.cWj)if(b===c)return;Ba.a.J(38398046,822,50,"JSanity unsupported callback unsupportContentName: {0}, unsupportContentValue:{1} ",a,b)}}Object(n.a)(pJ,"JSanityHelper",null,[541]);class NC extends uz{constructor(a,
b,c){super(a,c);this.i6j=b}D3d(){return this.i6j.WTa?Nh.a.gC(this.ro,Box4Intl.Box4Strings.l_MarkSelectedText,ResourceStrings.l_LanguageDialogDescription,ResourceStrings.l_DoNotCheckSpellingOrGrammar):super.D3d()}}Object(n.a)(NC,"PPTLanguageDialog",uz,[]);class qJ{constructor(a,b,c,h){this.Ebk=a;this.h5j=b;this.d9j=c;this.XF=h}getInstance(a){return new NC((a?this.Ebk:this.h5j)(),this.XF,this.d9j)}}Object(n.a)(qJ,"PPTLanguageDialogFactory",null,[539]);var Gk=d(114);class rJ{constructor(){this.pZe="rect,circle,ellipse,line,polyline,polygon,path";
this.Jqd=[];this.fga=[[],[1,3],[4,3],[4,3,1,3],[8,3,1,3],[8,3],[8,3,1,3,1,3],[3,1],[1,1],[3,1,1,1],[3,1,1,1,1,1]];this.XIe=96}mvl(a,b=null){try{const c=this.p8d(a);if(!c)return null;const h=b?hb.a.oI(b.lD):"none",m=b?b.alpha:1;for(b=0;b<c.length;++b){if(!c[b])continue;const y=c[b];y.setAttribute(Gk.a.V1d,h);y.setAttribute(Gk.a.oTf,m)}return a}catch(c){return Ba.a.J(38536015,815,10,"TryUpdateSVGDomelementFillIfSupport Unexpected exception when update svg domelement fill: {0}, stack: {1}",c.message,
c.stack),null}}cEh(a,b=null){try{const c=this.p8d(a);if(!c)return null;const h=b?hb.a.oI(b.lD):"none",m=b?b.alpha:1;for(b=0;b<c.length;++b){if(!c[b])continue;const y=c[b];y.setAttribute(Gk.a.sqd,h);y.setAttribute(Gk.a.fyh,m)}return a}catch(c){return Ba.a.J(38536017,815,10,"TryUpdateSVGDomelementLineFillIfSupport Unexpected exception when update svg domelement fill: {0}, stack: {1}",c.message,c.stack),null}}nvl(a,b){try{const h=this.p8d(a);if(!h)return null;var c=this.ugj(b);let m="";for(const y of c)m+=
y+" ";for(c=0;c<h.length;++c){if(!h[c])continue;const y=h[c];y.setAttribute(Gk.a.eyh,m);y.setAttribute(Gk.a.FYe,"miter");y.setAttribute(Gk.a.aml,"4");switch(b){case 8:y.setAttribute(Gk.a.EYe,"round");break;case 2:case 0:y.setAttribute(Gk.a.EYe,"butt");break;default:y.setAttribute(Gk.a.EYe,"round")}}return a}catch(h){return Ba.a.J(38536019,815,10,"TryUpdateSVGDomelementLineDashIfSupport Unexpected exception when update svg domelement fill: {0}, stack: {1}",h.message,h.stack),null}}dEh(a,b,c,h){try{if(!a)return null;
this.crh(c,b*this.XIe*h/te.a.bDa,a);return a}catch(m){return Ba.a.J(38536021,815,10,"TryUpdateSVGDomelementLineWidthIfSupport Unexpected exception when update svg domelement fill: {0}, stack: {1}",m.message,m.stack),null}}wgj(){if(!this.Jqd||1>this.Jqd.length)this.Jqd=this.pZe.split(",");return this.Jqd}p8d(a){if(!a)return null;a=a.querySelectorAll(this.pZe);return 1>a.length?null:a}crh(a,b,c){if(c){var h=c.getAttribute(Gk.a.PNb)?c.getAttribute(Gk.a.PNb).toString():"";1<h.length?(h=h.substring(h.indexOf("(")+
1,h.indexOf(")")),h=h.split(","),6===h.length?(h=Math.sqrt(Math.abs(parseFloat(h[0])*parseFloat(h[3]))+Math.abs(parseFloat(h[1])*parseFloat(h[2]))),h*=a):h=a):h=a;a=c.tagName.toLowerCase();for(var m of this.wgj())if(m===a){c.setAttribute(Gk.a.GYe,(b/h).toString());break}if(c.children&&0<c.children.length)for(m=0;m<c.children.length;++m)this.crh(h,b,c.children[m])}}ugj(a){switch(a){case 0:return this.fga[0];case 1:return this.fga[1];case 2:return this.fga[2];case 3:return this.fga[3];case 4:return this.fga[4];
case 5:return this.fga[5];case 6:return this.fga[6];case 7:return this.fga[7];case 8:return this.fga[8];case 9:return this.fga[9];case 10:return this.fga[10];default:return Ba.a.J(38536023,815,15,"GetSVGDashArray: unsupport ST_PresetLineDashVal."),this.fga[0]}}}Object(n.a)(rJ,"SVGIconLocalEditor",null,[542]);class sJ{constructor(a,b){this.qSg=b;this.Qd=a}JF(a,b){if(!a)return!1;const c=a.s3(h=>!h.gl).length;return!this.Sbl(a.E1b,c+b)}hG(a){const b=a.oe+1;this.Qd.YG(222,c=>{c.$B=1;c.GRa=[b.toString(),
this.qSg.toString()];return!1})}Sbl(a,b){if(!a&&b<this.qSg)return!1;Ba.a.J(22410754,822,50,"Can not edit. Shape count:{0}.",b);return!0}}Object(n.a)(sJ,"ShapeCountValidator",null,[540]);class OC{constructor(a,b,c,h,m,y){this.j9j=a;this.Fa=b;this.NUg=c;this.Jb=h;this.nJ=m;this.Ea=y}get Lb(){return this.j9j.value}V3f(){let a,b=0;a=!0;const c=this.Lb.Xd();1===c.length&&c[0].HZc&&(b=this.Ea.BSa(c[0]),a=!this.Ea.l7d(c[0]));return{returnValue:b,nch:a}}Pqh(a,b){const c=this.Lb.Xd();if(1===c.length&&c[0].HZc&&
this.NUg){var h=new E.DictionaryPropertySet;h.setValue(kb.a.$s,a);h.setValue(xc.a.Jwa,b);a=this.Jb.zd(15);try{a.nc(c[0]);c[0].Rsa();const m=Object(ua.a)(4,c[0]);m&&this.nJ&&this.nJ.Mzl(m,b);this.NUg.VU(h);this.Fa.Ed()}finally{a&&a.dispose()}}}}Object(n.a)(OC,"ShapeLanguageEditor",null,[569]);class PC{constructor(){this.K=null}get name(){return"PowerPointWebEditor.ShapeEdit"}$b(a){this.K=a;const b=this.K.resolve("PowerPointWebEditor.IApplicationContext");this.K.register(uz,"Box4.UI.LanguageDialog").as("Box4.UI.ILanguageDialog").oa(()=>
new NC(this.K.resolve("Box4.UI.ILanguageEditor"),this.K.resolve("Box4.Proofing.IProofingFeatureConfiguration"),this.K.resolve("Box4.UI.ILanguageListHelper")));this.K.register(539,"PowerPointWebEditor.IPPTLanguageDialogFactory").ma().oa(()=>new qJ(()=>this.K.resolve("PowerPointWebEditor.ShapeLanguageEditor"),()=>this.K.resolve("Box4.UI.ILanguageEditor"),this.K.resolve("Box4.UI.ILanguageListHelper"),this.K.resolve("Box4.Proofing.IProofingFeatureConfiguration")));this.K.register(OC,"PowerPointWebEditor.ShapeLanguageEditor").ma().oa(()=>
new OC(this.K.re("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.rb("Box4.ITextFormattingCommands"),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("PowerPointWebEditor.Proofing.IProofingBehaviorController"),this.K.resolve("PowerPointWebEditor.IShapeReader")));this.K.register(540,"PowerPointWebEditor.ShapeEdit.IShapeCountValidator").ma().oa(()=>new sJ(vb.a.instance.resolve("PowerPointWebEditor.IErrorHandler"),b.od.powerPointEditServerEditableShapeCountThreshold));
this.K.register(541,"PowerPointWebEditor.IJSanityHelper").ma().oa(()=>new pJ);this.K.register(542,"PowerPointWebEditor.ShapeEdit.ISVGIconLocalEditor").ma().oa(()=>new rJ)}init(){this.K.resolve("PowerPointWebEditor.IJSanityHelper")}dispose(){}static main(){r.a.instance.Dc(new PC)}}Object(n.a)(PC,"PPTWebEditorShapeEditPackage",null,[2,3]);var QC=d(281);class Os{static get j_(){return document.webkitFullscreenEnabled?"webkitfullscreenchange":document.msFullscreenEnabled?"MSFullscreenChange":document.mozFullScreenEnabled?
"mozfullscreenchange":document.fullscreenEnabled?"fullscreenchange":null}static requestFullscreen(a){a.webkitRequestFullscreen?a.webkitRequestFullscreen():a.msRequestFullscreen?a.msRequestFullscreen():a.mozRequestFullScreen?a.mozRequestFullScreen():a.requestFullscreen?a.requestFullscreen():ba.ULS.sendTraceTag(7145619,210,50,"RequestFullscreen got invoked in unknown browser")}static exitFullscreen(){document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen?document.msExitFullscreen():
document.mozCancelFullScreen?document.mozCancelFullScreen():document.exitFullscreen?document.exitFullscreen():ba.ULS.sendTraceTag(7145620,210,50,"ExitFullscreen got invoked in unknown browser")}static get Y8b(){return document.webkitFullscreenEnabled||document.msFullscreenEnabled||document.mozFullScreenEnabled||document.fullscreenEnabled}static get U8(){return!!document.webkitFullscreenElement||!!document.msFullscreenElement||!!document.mozFullScreenElement||!!document.fullscreenElement}}Object(n.a)(Os,
"FullscreenUtils",null,[]);class tJ{get j_(){return Os.j_}requestFullscreen(a){Os.requestFullscreen(a)}exitFullscreen(){Os.exitFullscreen()}get Y8b(){return Os.Y8b}get U8(){return Os.U8}get UAf(){return this.Y8b&&!v.a.hx}}Object(n.a)(tJ,"FullscreenUtilsProxy",null,[531]);class uJ{m$i(a){return inkButton.InkButtonManagerFactory.createInkButtonManager(a)}}Object(n.a)(uJ,"InkButtonHelper",null,[536]);class vJ{constructor(){this.menuDefinition=null;this.autoOpenMenu=!1;this.menuHostId=null;this.autoOpenMenu=
!1;this.menuHostId="SlideshowToolbarCalloutMenuContainer"}}Object(n.a)(vJ,"FlyoutMenuExtraProps",null,[]);class yx{}yx.nli="_136_16_N_20";yx.oli="none";Object(n.a)(yx,"InkButtonConstants",null,[]);class vz{constructor(){this.menuDefinition=this.controlInMenuRendererFunction=this.menuHostId=this.selectedColor=this.selectedItem=this.icon=null}static create(){return{}}}Object(n.a)(vz,"InkButtonProps",null,[]);class RC{constructor(){this.onInkMenuActivity=null}}Object(n.a)(RC,"IInkButtonSettings",null,
[]);class wJ extends RC{constructor(){super()}}Object(n.a)(wJ,"InkButtonSettings",RC,[]);class xJ{constructor(){this.color=this.item=null}}Object(n.a)(xJ,"InkManagerActivity",null,[]);class wz{constructor(){this.Qve=!1;this.Pze=this.pAe=0;this.nqe=""}get T3(){return this.Qve}set T3(a){this.Qve=a}get startingSlideIndex(){return this.pAe}set startingSlideIndex(a){this.pAe=a}get XKa(){return this.Pze}set XKa(a){this.Pze=a}get IMf(){return this.nqe}set IMf(a){this.nqe=a}get QQk(){const a={};a.IsStartRehearsal=
this.Qve;a.StartingSlideIndex=this.pAe;a.SlideCount=this.Pze;a.DisabledRehearsalRealtimeFeaturesStr=this.nqe;return JSON.stringify(a)}}Object(n.a)(wz,"RehearsalContext",null,[534]);class xz extends Nh.a{constructor(a,b,c){super(!1,!0);this.Gxe=50001;this.kb=a;this.je=b;this.Ro=new wz;this.Xa=c;this.kb.lia(Object(F.a)(this,this.jfa,"onSlideshowExitHandler"));this.kb.TXb(Object(F.a)(this,this.ffa,"onGetCurrentPositionHandler"));this.kb.getCurrentPosition();this.UGa=!1}dispose(){super.dispose();this.UGa||
this.kb.restoreFocus()}ju(){super.ju();document.getElementById("WACDialogOverlay").style.zIndex=String(this.Gxe);const a=document.getElementById("WACDialogOuterContainer");Sys.UI.DomElement.addCssClass(a,"SlideshowSubtitleProactiveDialogContainer")}tA(){super.tA();var a=document.getElementById(this.Nh("WACDialogPanel"));a.style.minWidth=cf.a.Pc(300);a.style.width=cf.a.Pc(300);a=document.getElementById(this.Nh("WACDialogButtonPanel"));var b=document.getElementById(this.Nh("WACDialogActionButton"));
a&&b&&a.removeChild(b);if(a=document.getElementById(this.Nh("WACDialogCancelButton")))a.style.color="#ffffff",a.style.font="12pt",a.style.background="#A92B1A",a.innerText="Got it";if(a=document.getElementById(this.Nh("WACDialogPanel"))){b=cf.a.Fe();b.style.position="absolute";b.style.bottom="20px";b.style.left="20px";const c=cf.a.nca();c.setAttribute("href","https://support.office.com/en-ie/article/present-with-real-time-automatic-captions-or-subtitles-in-powerpoint-68d20e49-aec3-456a-939d-34a79e8ddd5f#OfficeVersion=Online");
c.setAttribute("target","_blank");c.innerText="More Tips";b.appendChild(c);a.appendChild(b)}}open(){Ba.a.J(512495708,830,50,"SlideshowSubtitleProactiveDialog: Open");var a=this.je.pk("SubtitleProactive_clearly.png");const b=this.je.pk("SubtitleProactive_network.png"),c=this.je.pk("SubtitleProactive_noNoise.png");this.qg="<div id='subtitleDlg'><div id='captions' class='SubtitleProactiveCaptions'><label id='captionID'></label></div><div id='sectiontitle' class='SubtitleProactiveSectionTitle '><span id='sectiontitle1'><label id='str1ID'></label></span></br><span id='sectiontitle2'><label id='str2ID'></label></span></div><div id='block' class='SubtitleProactiveBlock'><img src= '"+
a+"' style='width: 190px; height: 125px;'/><span id='block1_1' class='SubtitleProactiveBlockTitle'><label id='speakStr1ID'></label></span></br></br><span id='block1_2'><label id='speakStr2ID'></label></span></br></br></br></div><div id='block' class='SubtitleProactiveBlock'><img src= '"+c+"' style='width: 190px; height: 125px;'/><span id='block2_1' class='SubtitleProactiveBlockTitle'><label id='noiseStr1ID'></label></span></br><span id='block2_2'><label id='noiseStr2ID'></label></span></br></br></br></div><div id='block' class='SubtitleProactiveBlock'><img src= '"+
b+"' style='width: 190px; height: 125px;'/><span id='block3_1' class='SubtitleProactiveBlockTitle'><label id='networkStr1ID'></label></span></br></br><span id='block3_2'><label id='networkStr2ID'></label></span></br></br></br></div></div>";a={["captionID"]:ResourceStrings.L_SubtitleProactive_Caption,["str1ID"]:ResourceStrings.L_SubtitleProactive_Sectiontitle1,["str2ID"]:ResourceStrings.L_SubtitleProactive_Sectiontitle2,["speakStr1ID"]:ResourceStrings.L_SubtitleProactive_SpeakStr1,["speakStr2ID"]:ResourceStrings.L_SubtitleProactive_SpeakStr2,
["noiseStr1ID"]:ResourceStrings.L_SubtitleProactive_NoiseStr1,["noiseStr2ID"]:ResourceStrings.L_SubtitleProactive_NoiseStr2,["networkStr1ID"]:ResourceStrings.L_SubtitleProactive_NetworkStr1,["networkStr2ID"]:ResourceStrings.L_SubtitleProactive_NetworkStr2};this.$i("",Object(F.a)(this,this.efa,"onClickHandler"),a);this.kb.setVisibility(!0)}I7(){super.I7()}jsa(){super.jsa()}dib(){}ffa(){this.kb.eib(Object(F.a)(this,this.ffa,"onGetCurrentPositionHandler"));this.open()}jfa(){this.UGa=!0;this.kb.Cfa(Object(F.a)(this,
this.jfa,"onSlideshowExitHandler"));this.kb.eib(Object(F.a)(this,this.ffa,"onGetCurrentPositionHandler"));this.hide()}efa(a){0===a&&(a=Date.now(),this.kb.transcribe(u.AFrameworkApplication.userSessionId,this.Xa.podSessionId,this.Xa.nk,u.AFrameworkApplication.jh,3,a,this.Ro))}static Dmg(a,b,c){new xz(a,b,c)}}Object(n.a)(xz,"SlideshowSubtitleProactiveDialog",Nh.a,[]);var wh=d(669);class yJ{constructor(){this.buttonIdDictionary=null}}Object(n.a)(yJ,"SlideshowToolbarSettings",null,[]);class zx extends Sys.EventArgs{constructor(a){super();
this.text=a}}Object(n.a)(zx,"ReadOutEventArgs",Sys.EventArgs,[]);class SC{constructor(a,b,c,h,m,y,G,U,ja,va,Ta){this.$Bb=this.Ro=this.Hc=this.Wda=this.ie=this.q4c=this.eAe=this.fj=null;this.oU=this.yXa=this.AXa=this.OBb=this.gWa=this.Ste=0;this.SL=!1;this.ste=!0;this.E5c=this.bR=this.WAe=this.Qoe=!1;this.kb=c;this.kf=G;this.Zt=U;this.Xa=va;this.ia=a;this.Ga=b;this.ABe=m;this.Tb=y;this.E7j=vb.a.instance.Ja("PowerPointWebEditor.IInkButtonHelper");this.je=h;this.Wt=Ta}init(a,b){Ba.a.J(512495955,830,
50,"ReactSlideshowToolbar.Init");this.ste=!0;this.Qoe=!1;var c={};c[wh.a.MicButton]=this.Ga.isMicButtonInSlideShowToolbarEnabled;c[wh.a.PrevButton]=!0;c[wh.a.NextButton]=!0;c[wh.a.GridButton]=!0;c[wh.a.InkButton]=!0;c[wh.a.SubtitlesButton]=!0;c[wh.a.LiveButton]=!0;c[wh.a.MoreButton]=!0;c[wh.a.ExitButton]=!0;c[wh.a.CoachButton]=this.Ga.isCoachButtonInSlideShowToolbarEnabled;this.eAe=new yJ;this.eAe.buttonIdDictionary=c;if(!document.getElementById("slideshow-toolbar")){this.ie=document.createElement("div");
this.ie.id="slideshow-toolbar";this.ie.className="ReactSlideshowToolbar";this.Ga.pptEditorVoiceUXEnabled&&(this.q4c=document.getElementById("slideshowfooterContainerElement"),this.ie.className="ReactSlideshowToolbarWithFooter");c=document.createElement("div");c.id="slideshow-toolbar-accessibility";c.style.position="absolute";c.style.left="0px";c.style.top="auto";c.style.width="0px";c.style.height="0px";c.style.overflow="hidden";c.setAttribute("aria-label",ResourceStrings.l_SlideShowToolbar);this.Ga.pptEditorVoiceUXEnabled?
this.q4c.appendChild(this.ie):this.kf.appendChild(this.ie);this.fj=slideshowToolbar.SlideshowToolbarFactory.createToolbar(this.eAe,this.ie);if(!this.fj){Ba.a.J(512495954,830,10,"ReactSlideshowToolbar.Init m_slideshowToolbarManager is null.");const h=qf.a.Uh(359);u.AFrameworkApplication.xp(h);Mf.Health.instance.recordQosError(qf.a.Wia(h),["SlideShowACE"],!1,!0,!0,!1,null)}this.fj.renderToolbar();this.ie.appendChild(c);this.ie.tabIndex=0}this.Wda||(this.Wda=document.createElement("div"),this.Wda.id=
"SlideshowToolbarCalloutMenuContainer",this.Wda.className="SlideshowToolbarCalloutMenuContainer",this.Zt()&&(this.Wda.style.direction=Td.a.s0a),this.kf.appendChild(this.Wda));this.Hc=a;this.Ro=b;this.fj.registerButtonCallback(wh.a.MicButton,()=>{this.sqk()});this.fj.registerButtonCallback(wh.a.CoachButton,()=>{this.Wmk()});this.Hc.Kh||this.Tb&&this.Tb.instance&&this.Tb.instance.Yq?(this.bR=!0,this.fj.setToolbarButtonToggleState(wh.a.MicButton,this.bR),this.fj.showToolbarButton(wh.a.MicButton)):(this.bR=
!1,this.fj.setToolbarButtonToggleState(wh.a.MicButton,this.bR),this.fj.hideToolbarButton(wh.a.MicButton));this.fj.registerButtonCallback(wh.a.PrevButton,h=>{this.AGb(h)});this.fj.registerButtonCallback(wh.a.NextButton,h=>{this.vGb(h)});this.fj.registerButtonCallback(wh.a.GridButton,h=>{this.sGb(h)});this.fj.showToolbarButton(wh.a.GridButton);this.Hc.Pub&&!this.Ro.T3&&(this.fj.registerButtonCallback(wh.a.SubtitlesButton,h=>{this.rfd(h)}),this.fj.setToolbarButtonToggleState(wh.a.SubtitlesButton,this.Hc.Kh),
this.fj.showToolbarButton(wh.a.SubtitlesButton));this.fj.registerButtonCallback(wh.a.ExitButton,h=>{this.rGb(h)});this.Ga.isInkingInSlideShowEnabled&&this.Ga.isInkUIInSlideShowEnabled&&(a=vz.create(),a.icon=yx.nli,a.selectedColor=yx.oli,this.fj.updateElementProps(wh.a.InkButton,a),this.fj.registerButtonCallback(wh.a.InkButton,()=>{this.yBj()}),this.fj.showToolbarButton(wh.a.InkButton));this.Tb&&this.Tb.instance&&this.Tb.instance.sr&&!this.Ro.T3&&(this.fj.registerButtonCallback(wh.a.LiveButton,()=>
{this.aqk()}),this.fj.updateFlyoutButtonCallback(wh.a.LiveButton,this.Tb.instance.Yq),this.fj.setToolbarButtonToggleState(wh.a.LiveButton,this.Tb.instance.Yq),this.fj.showToolbarButton(wh.a.LiveButton),this.Tb.instance.Asf(Object(F.a)(this,this.ujc,"onLiveSessionStarted")),this.Tb.instance.ysf(Object(F.a)(this,this.tjc,"onLiveSessionEnded")),this.Tb.instance.wsf(Object(F.a)(this,this.sjc,"onLiveRelaunchPausedSession")),this.Tb.instance.Y8h(Object(F.a)(this,this.U3g,"onLiveCalloutMenuDefintionChanged")));
this.oOb();this.kvb();this.kb.lia(Object(F.a)(this,this.hna,"onExitHandler"));this.kb.aOd(Object(F.a)(this,this.jgb,"onBrowserEventHandler"));this.kb.LFc(Object(F.a)(this,this.Qwa,"onGetCurrentSlideDimensionsHandler"));this.kb.QFc(Object(F.a)(this,this.$wa,"onSpecialKeyHandler"));this.kb.cOd(Object(F.a)(this,this.kgb,"onContextMenuHandler"));this.kb.eOd(Object(F.a)(this,this.Idd,"onEnterEndOfShowHandler"));this.kb.fOd(Object(F.a)(this,this.ged,"onLeaveEndOfShowHandler"));wd.a.addHandler(this.ie,ra.a.mq,
Object(F.a)(this,this.sgb,"onMouseOverHandler"));wd.a.addHandler(this.ie,ra.a.Is,Object(F.a)(this,this.wjc,"onMouseOutHandler"));wd.a.addHandler(this.Wda,ra.a.click,Object(F.a)(this,this.efa,"onClickHandler"));wd.a.addHandler(this.ie,ra.a.Zf,Object(F.a)(this,this.UIa,"onKeyDownHandler"))}Agl(){window.clearTimeout(this.Ste);this.Ste=window.setTimeout(Object(F.a)(this,this.Nxj,"hideMouse"),3E3);this.kb.Vfa(!0)}Nxj(){this.SL||(window.clearTimeout(this.Ste),this.kb.Vfa(!1))}cD(a,b){b?this.fj.showToolbarButton(a):
this.fj.hideToolbarButton(a)}setToolbarButtonToggleState(a,b){this.fj.setToolbarButtonToggleState(a,b)}show(){if(this.Zt()){const a=document.getElementById("slideshow-toolbar");if(a){const b=(this.AXa+this.oU-16-this.fj.getToolbarWidth()).toString()+"px";a.style.left=b}}this.fj.showToolbar();this.fj.enterFocusTrapZone();window.clearTimeout(this.gWa);window.clearTimeout(this.OBb);this.ste?(this.gWa=window.setTimeout(Object(F.a)(this,this.hide,"hide"),2E3),this.ste=!1,this.Qoe=!0):this.gWa=window.setTimeout(Object(F.a)(this,
this.hide,"hide"),3E3);this.kb.Vfa(!0)}Gvh(){if(this.Zt()){const a=document.getElementById("slideshow-toolbar");if(a){const b=(this.AXa+this.oU-16-this.fj.getToolbarWidth()).toString()+"px";a.style.left=b}}this.fj.showToolbar();this.fj.enterFocusTrapZone();window.clearTimeout(this.gWa);window.clearTimeout(this.OBb);this.OBb=window.setTimeout(Object(F.a)(this,this.hide,"hide"),1E4)}hide(){if(!this.SL){const a=document.getElementById("slideshow-toolbar");a&&!this.fj.isAnyToolbarElementFocused()&&document.activeElement===
a&&this.S0a(ResourceStrings.l_SlideShowToolbarDismissed);window.clearTimeout(this.gWa);window.clearTimeout(this.OBb);this.fj.hideToolbar();this.kb.Vfa(!1);this.ie.style.display===Td.a.Gf&&this.kb.restoreFocus()}}kvb(){this.SL||(this.Qoe&&this.S0a(ResourceStrings.l_SlideShowToolbarDismissed),window.clearTimeout(this.gWa),window.clearTimeout(this.OBb),this.fj.forceHideToolbar(),this.kb.Vfa(!1),this.ie.style.display===Td.a.Gf&&this.kb.restoreFocus())}remove(){this.fj.closeToolbar();this.Wda.style.visibility=
Td.a.Ms;this.E5c=!1;this.kb.Cfa(Object(F.a)(this,this.hna,"onExitHandler"));this.kb.ePe(Object(F.a)(this,this.jgb,"onBrowserEventHandler"));this.kb.ikd(Object(F.a)(this,this.Qwa,"onGetCurrentSlideDimensionsHandler"));this.kb.lkd(Object(F.a)(this,this.$wa,"onSpecialKeyHandler"));this.kb.gPe(Object(F.a)(this,this.kgb,"onContextMenuHandler"));this.kb.hPe(Object(F.a)(this,this.Idd,"onEnterEndOfShowHandler"));this.kb.jPe(Object(F.a)(this,this.ged,"onLeaveEndOfShowHandler"));wd.a.removeHandler(this.ie,
ra.a.mq,Object(F.a)(this,this.sgb,"onMouseOverHandler"));wd.a.removeHandler(this.ie,ra.a.Is,Object(F.a)(this,this.wjc,"onMouseOutHandler"));wd.a.removeHandler(this.Wda,ra.a.click,Object(F.a)(this,this.efa,"onClickHandler"));wd.a.removeHandler(this.ie,ra.a.Zf,Object(F.a)(this,this.UIa,"onKeyDownHandler"));this.ie&&(this.kf.contains(this.ie)||this.q4c&&this.q4c.contains(this.ie))&&(this.SL=!1);this.Tb&&this.Tb.instance&&this.Tb.instance.sr&&(this.Tb.instance.Zhh(Object(F.a)(this,this.ujc,"onLiveSessionStarted")),
this.Tb.instance.Yhh(Object(F.a)(this,this.tjc,"onLiveSessionEnded")),this.Tb.instance.Whh(Object(F.a)(this,this.sjc,"onLiveRelaunchPausedSession")),this.Tb.instance.FTk(Object(F.a)(this,this.U3g,"onLiveCalloutMenuDefintionChanged")))}hna(){this.remove()}S0a(a){ta.a.Wa(a)?Ba.a.J(512495953,830,15,"ReactSlideshowToolbar::TryRaiseSlideshowNavigationToolbarClickedEvent, Toolbar title is null"):this.ABe.oeh(new zx(a))}Qwa(a,b){try{this.AXa=b.ewh;this.yXa=b.bwh;this.oU=b.slideWidth;if("NaN"===this.AXa.toString()||
"NaN"===this.yXa.toString()){Ba.a.J(512495952,830,10,"ReactSlideshowToolbar.OnGetCurrentSlideDimensionsHandler slide dimension info is null.");const c=qf.a.Uh(359);u.AFrameworkApplication.xp(c);Mf.Health.instance.recordQosError(qf.a.Wia(c),["SlideShowACE"],!1,!0,!0,!1,null)}else{const c=this.Tb.instance&&this.Tb.instance.Yq&&!this.E5c?26:0;if(this.Ga.pptEditorVoiceUXEnabled){const h=document.getElementById("slideshowfooterContainerElement");if(h){let m;m=this.Zt()?(this.AXa+this.oU-16-this.fj.getToolbarWidth()).toString()+
"px":(this.AXa+2).toString()+"px";h.style.left=m;if(this.Hc.Kh&&"AboveSlide"===this.Hc.Ov)h.style.bottom="0px";else{const G=La.a.ZTc();a=0;const U=document.getElementById("AppHeaderPanel");U&&(a=U.clientHeight);h.style.bottom=this.Wt.U8?(G-this.yXa-c).toString()+"px":(G-this.yXa-a-c).toString()+"px"}h.style.top="auto";const y=document.getElementById("ReactToolbarInnerContainer");y&&(y.style.position="relative")}}else{const h=document.getElementById("slideshow-toolbar");if(h){let m;m=this.Zt()?(this.AXa+
this.oU-16-this.fj.getToolbarWidth()).toString()+"px":(this.AXa+2).toString()+"px";h.style.left=m;const y=this.Tb.instance&&this.Tb.instance.Yq?(this.yXa+c).toString()+"px":this.yXa.toString()+"px";"AboveSlide"===this.Hc.Ov?(h.style.bottom="0px",h.style.top="auto"):(h.style.top=y,h.style.bottom="auto");h.style.top=y}}}this.show()}catch(c){Ba.a.J(512495951,830,10,"ReactSlideshowToolbar.OnGetCurrentSlideDimensionsHandler: Exception thrown when trying to access the OnGetCurrentSlideDimensionsEventArgs, exception: {0}",
c)}}Idd(){this.E5c=!0}ged(){this.E5c=!1}UIa(a){this.fj.isAnyCalloutMenuOpen()||(this.SL=!1);try{this.ie.style.display===Td.a.Xk&&(a.keyCode===z.a.Vlb||a.keyCode===z.a.JB||a.keyCode===z.a.K1?this.kb.prev():a.keyCode===z.a.Aza||a.keyCode===z.a.IB||a.keyCode===z.a.I1?this.kb.next():a.keyCode===z.a.PR?this.Zt()?this.kb.next():this.kb.prev():a.keyCode===z.a.lP?this.Zt()?this.kb.prev():this.kb.next():a.keyCode===z.a.cMa?(this.WAe=!0,this.kvb()):a.shiftKey&&a.keyCode===z.a.jpa||a.keyCode===z.a.kPb?this.kvb():
this.kb.ISe(a))}catch(b){Ba.a.J(512495950,822,10,"ReactSlideshowToolbar.OnKeyDownHandler Exception in KeyDownHandler : {0}.",b)}}$wa(a,b){this.fj.isAnyCalloutMenuOpen()||(this.SL=!1);if(b.key===z.a.kPb||b.shiftKey&&b.key===z.a.jpa)a="off",this.ie.style.display===Td.a.Gf?(this.Gvh(),a="on"):this.kvb(),Ba.a.J(512495949,830,50,"ReactSlideshowToolbar.OnSpecialKeyHandler: T key pressed, turned slideshow toolbar {0}",a)}kgb(){if(this.WAe)this.WAe=!1;else{var a="off";this.ie.style.display===Td.a.Gf?(this.Gvh(),
a="on"):this.fj.isAnyCalloutMenuOpen()||this.kvb();Ba.a.J(512495948,830,50,"ReactSlideshowToolbar.OnContextMenuHandler: ContextMenu event received, turned slideshow toolbar {0}",a)}}jgb(a,b){this.Agl();b.clientY<this.yXa+8+20&&b.clientY>this.yXa-20-8&&this.show()}sgb(a){(a=a.target)&&this.ie.contains(a)&&(this.SL=!0)}wjc(a){a.target&&(this.fj.isAnyCalloutMenuOpen()?this.Wda.style.visibility=Td.a.xz:(this.SL=!1,this.show()));this.fj.isAnyCalloutMenuOpen()||this.fj.enterFocusTrapZone()}efa(a){this.SL=
!1;window.clearTimeout(this.gWa);window.clearTimeout(this.OBb);this.Wda.style.visibility=Td.a.Ms;this.gWa=window.setTimeout(Object(F.a)(this,this.hide,"hide"),3E3);"SlideshowToolbarCalloutMenuContainer"===a.target.id&&this.fj.enterFocusTrapZone()}AGb(){Ba.a.J(512495947,830,50,"ReactSlideshowToolbar.OnPrevClickHandler");this.kb.prev()}vGb(){Ba.a.J(512495946,830,50,"ReactSlideshowToolbar.OnNextClickHandler");this.kb.next()}rGb(){Ba.a.J(512495945,830,50,"ReactSlideshowToolbar.OnExitClickHandler");this.fj.closeToolbar();
this.kb.exit()}k0e(a){const b=!!this.Tb&&!!this.Tb.instance&&this.Tb.instance.Yq;var c=this.Hc.hSf&&5!==a&&!b;5!==a&&(this.Hc.Kh&&(oi.a.SJ("PPTCaptionDiscoverabiltyDoNotShowAgain","true",oi.a.wJ)||Ba.a.J(512495944,822,10,"ReactSlideshowToolbar::ToggleTranscriber - Failed to set cookie for discoverability opt out to true")),this.Hc.Kh=!this.Hc.Kh);this.fj.setToolbarButtonToggleState(wh.a.SubtitlesButton,this.Hc.Kh);Ba.a.J(512495943,830,50,"ReactSlideshowToolbar.ToggleTranscriber m_subtitleContext FUseSubtitles is changed to: {0}",
this.Hc.Kh);this.Hc.Kh&&c&&xz.Dmg(this.kb,this.je,this.Xa);c||(c=Date.now(),b?this.bR||this.Tb.instance.Uub()?this.kb.toggleTranscriberUIVisibility(null):(this.Tb.instance.t8f(),this.kb.transcribe(u.AFrameworkApplication.userSessionId,this.Xa.podSessionId,this.Xa.nk,u.AFrameworkApplication.jh,a,c,this.Ro)):this.kb.transcribe(u.AFrameworkApplication.userSessionId,this.Xa.podSessionId,this.Xa.nk,u.AFrameworkApplication.jh,a,c,this.Ro));this.bR=this.Hc.Kh||b;this.wtd();this.oOb()}wtd(){this.fj.setToolbarButtonToggleState(wh.a.MicButton,
this.bR);this.bR?this.fj.showToolbarButton(wh.a.MicButton):this.fj.hideToolbarButton(wh.a.MicButton)}oOb(){const a=this.Hc.Kh,b=!!this.Tb&&!!this.Tb.instance&&this.Tb.instance.Yq,c=this.Ro.T3,h=32!==this.ia.processAction(M.a.Afa,1);a||b||c||h?this.fj.hideToolbarButton(wh.a.CoachButton):this.fj.showToolbarButton(wh.a.CoachButton)}sqk(){Ba.a.J(512495942,830,50,"ReactSlideshowToolbar.OnMicToggleHandler");this.bR=!this.bR;this.fj.setToolbarButtonToggleState(wh.a.MicButton,this.bR);this.kb.setMicrophoneState(!this.bR);
if(this.Tb&&this.Tb.instance&&this.Tb.instance.Yq&&this.bR&&!this.Tb.instance.Uub()){this.Tb.instance.t8f();const a=this.Hc.Kh;this.Tb.instance.Jca=!this.Hc.Kh;this.Hc.Kh=!0;this.kb.transcribe(u.AFrameworkApplication.userSessionId,this.Xa.podSessionId,this.Xa.nk,u.AFrameworkApplication.jh,5,Date.now(),this.Ro);this.Hc.Kh=a}}Wmk(){Ba.a.J(512495941,830,50,"ReactSlideshowToolbar.OnCoachClickHandler");32===this.ia.La(M.a.Afa,2,{entryPoint:2})?this.Ga.pptEditorRehearsalSpeechClientEnabled||(this.Ro.T3=
!0):Ba.a.J(512495940,830,10,"ReactSlideshowToolbar.OnCoachClickHandler - Failed to start Rehearsal Session")}rfd(){Ba.a.J(512495939,830,50,"ReactSlideshowToolbar.OnTranscribeHandler");this.k0e(3)}sGb(){Ba.a.J(512495938,830,50,"ReactSlideshowToolbar.OnGridViewClickHandler");this.ia.La(M.a.ZLb,2,null)}aqk(){this.Tb&&this.Tb.instance&&(Ba.a.J(512495937,830,50,"FLiveBroadcastInUse is changed to: {0}",this.Tb.instance.Yq),this.Tb.instance.Yq||(this.Tb.instance.erc(3,u.AFrameworkApplication.userSessionId,
this.Ga.podsWebServiceBase,this.Xa.podSessionId,u.AFrameworkApplication.jh),this.Tb.instance.Jca=!this.Hc.Kh,this.Hc.Pub&&!this.Hc.Kh&&(Ba.a.J(512495936,830,50,"Starting subtitle in OnLiveBroadcastHandler for starting live session."),this.Hc.Kh=!0,this.kb.transcribe(u.AFrameworkApplication.userSessionId,this.Xa.podSessionId,this.Xa.nk,u.AFrameworkApplication.jh,5,Date.now(),this.Ro),this.Hc.Kh=!1,this.bR=!0,this.wtd()),this.SL=!1,this.fj.setToolbarButtonToggleState(wh.a.LiveButton,!0)));this.oOb()}ujc(){this.fj.setToolbarButtonToggleState(wh.a.LiveButton,
!0);this.vtd(!1,!1);this.bR=!0;this.wtd();this.oOb();this.NZg()}tjc(){this.fj.setToolbarButtonToggleState(wh.a.LiveButton,!1);this.vtd(!1,!0);this.Tb&&this.Tb.instance&&this.Tb.instance.Jca&&!this.Hc.Kh&&(Ba.a.J(512495907,830,50,"Stopping subtitle for stopping live session."),this.kb.transcribe(u.AFrameworkApplication.userSessionId,this.Xa.podSessionId,this.Xa.nk,u.AFrameworkApplication.jh,5,Date.now(),this.Ro));this.Tb.instance.Jca=!1;this.Hc.Kh||(this.bR=!1,this.wtd());this.oOb()}sjc(){this.Tb&&
this.Tb.instance&&(this.SL=!0,this.show(),this.Wda.style.visibility=Td.a.xz,this.vtd(!0,!1),this.NZg());this.oOb()}NZg(){this.Ga.jhd&&!this.Tb.instance.Uub()&&(this.bR=!1,this.fj.setToolbarButtonToggleState(wh.a.MicButton,this.bR),this.Hc.Kh=!1,this.fj.setToolbarButtonToggleState(wh.a.SubtitlesButton,this.Hc.Kh))}U3g(){this.vtd(!1,!1)}vtd(a,b){if(this.Tb&&this.Tb.instance){const c=new vJ;c.menuDefinition=b?null:this.Tb.instance.getCalloutMenuDefinition();c.autoOpenMenu=a;this.fj.updateElementProps(wh.a.LiveButton,
c);this.fj.updateFlyoutButtonCallback(wh.a.LiveButton,!b)}}yBj(){this.E7j.execute(Object(F.a)(this,this.xBj,"initInkButton"));const a=new xJ;a.item="Init";this.kb.uJe(a);this.fj.registerButtonCallback(wh.a.InkButton,()=>{})}xBj(a){const b=new wJ;b.onInkMenuActivity=c=>{this.zpk(c)};this.$Bb=a.m$i(b);a=vz.create();a.icon=this.$Bb.getIcon();a.menuDefinition=this.$Bb.getControlsInMenu();a.menuHostId="SlideshowToolbarCalloutMenuContainer";this.fj.updateElementProps(wh.a.InkButton,a)}zpk(a){this.kb.uJe(a);
a=vz.create();a.selectedColor=this.$Bb.getSelectedColor();a.icon=this.$Bb.getIcon();a.menuDefinition=this.$Bb.getControlsInMenu();this.fj.updateElementProps(wh.a.InkButton,a);Rd.a("DismissToolbarOnSelection")&&this.kvb()}}Object(n.a)(SC,"ReactSlideshowToolbar",null,[572,573]);class TC{constructor(a,b){this.ai=a;this.Tcc=document.createElement("div");this.Tcc.id="slideshowfooterContainerElement";this.Tcc.className="slideshowFooterContainer";this.ia=b}init(){Ba.a.J(595198370,830,50,"SlideShowFooterContainer.Init");
this.ai&&this.ai.appendChild(this.Tcc)}remove(){this.ai&&this.ai.contains(this.Tcc)&&this.ai.removeChild(this.Tcc)}vb(){this.ia.ya(M.a.Nuh,nc.a.application,Object(F.a)(this,this.Ufl,"showFooterElements"));this.ia.ya(M.a.N$f,nc.a.application,Object(F.a)(this,this.Jxj,"hideFooterElements"))}Ufl(a,b,c){2===c&&(a=document.getElementById("slideshowfooterContainerElement"))&&(a.style.display="flex");return 32}Jxj(a,b,c){2===c&&(a=document.getElementById("slideshowfooterContainerElement"))&&(a.style.display=
Td.a.Gf);return 32}}Object(n.a)(TC,"SlideShowFooterContainer",null,[1062]);class zJ{constructor(){this.hostElement=null;this.baseZIndex=0}}Object(n.a)(zJ,"IVoiceActorSettings",null,[]);class AJ{constructor(){this.Ehc=this.ai=this.Afb=null}init(){Ba.a.J(595198290,830,50,"SlideShowVoiceNotification.Init");this.Afb=document.createElement("div");this.Afb.id="voiceNotificationContainerElement";this.Afb.className="voiceNotificationContainer";(this.ai=document.getElementById("slideshowfooterContainerElement"))&&
this.ai.insertBefore(this.Afb,this.ai.firstChild);const a=new zJ;a.baseZIndex=50002;a.hostElement=this.Afb;this.Ehc=voiceUI.VoiceActorFactory.CREATE_VOICE_ACTOR(a)}remove(){this.ai&&this.ai.contains(this.Afb)&&this.ai.removeChild(this.Afb)}show(a,b){this.Ehc&&this.Ehc.showNotification(a,b)}hide(){this.Ehc&&this.Ehc.hideNotification()}}Object(n.a)(AJ,"SlideShowVoiceNotification",null,[537]);class UC extends Nh.a{constructor(a,b){super(!1,!0);this.Jgc=null;this.mcb=this.OVa=0;this.Gxe=50001;this.GCb=
null;this.kb=a;this.v$j=b;this.kb.lia(Object(F.a)(this,this.jfa,"onSlideshowExitHandler"));this.kb.TXb(Object(F.a)(this,this.ffa,"onGetCurrentPositionHandler"));this.kb.getCurrentPosition();this.UGa=!1}get Ppd(){if(void 0===this.Jgc||null===this.Jgc)this.Jgc=document.getElementById("GotoDlgInput");return this.Jgc}HCl(){if(!RegExp("^[0-9]+$").test(this.Ppd.value))return this.Ppd.value=this.OVa.toString(),!1;this.mcb=Number.parseInvariant(this.Ppd.value);this.mcb=Math.min(this.mcb,this.v$j);this.mcb=
Math.max(this.mcb,1);return!0}dispose(){super.dispose();this.Jgc=null;this.UGa||this.kb.restoreFocus()}ju(){super.ju();document.getElementById("WACDialogOverlay").style.zIndex=String(this.Gxe);const a=document.getElementById("WACDialogOuterContainer");Sys.UI.DomElement.addCssClass(a,"SlideShowGoToDialogContainer")}tA(){super.tA();const a=document.getElementById(this.Nh("WACDialogPanel"));a.style.minWidth=cf.a.Pc(300);a.style.width=cf.a.Pc(300)}open(){Ba.a.J(24133980,830,50,"SlideshowGoToDialog: Open");
this.qg="<div id='GotoDlgLabelHolder'><label id='GotoDlgLabel'></label></div><input id='GotoDlgInput' type='text'/>";const a={["GotoDlgLabel"]:ResourceStrings.l_GotoSlideLabel,["GotoDlgInput"]:this.OVa.toString()};this.$i(ResourceStrings.L_GoTo,Object(F.a)(this,this.efa,"onClickHandler"),a);this.kb.setVisibility(!0);this.Ppd.focus()}I7(){super.I7();this.GCb=Object(F.a)(this,this.UIa,"onKeyDownHandler");u.AFrameworkApplication.Aa.kG.Jjd(ra.a.Zf,window.document,this.GCb,null)}jsa(){super.jsa();void 0!==
this.GCb&&null!==this.GCb&&u.AFrameworkApplication.Aa.kG.g2e(ra.a.Zf,window.document,this.GCb);this.GCb=null}dib(){}ffa(a,b){this.kb.eib(Object(F.a)(this,this.ffa,"onGetCurrentPositionHandler"));this.OVa=b.slideIndex+1;this.open()}jfa(){this.UGa=!0;this.kb.Cfa(Object(F.a)(this,this.jfa,"onSlideshowExitHandler"));this.kb.eib(Object(F.a)(this,this.ffa,"onGetCurrentPositionHandler"));this.hide()}UIa(a){a=a.pc.keyCode;return a===z.a.tq?(this.HCl()&&(this.$Sa(this.mcb),this.hide()),!0):a===z.a.lPb||a===
z.a.dMa||a===z.a.$Hh||a===z.a.bud?!0:!1}efa(a){1===a&&this.$Sa(this.mcb)}$Sa(a){this.kb.$Sa(a-1)}static xXj(a,b){1>=b||void 0!==Cf.a.Ww&&null!==Cf.a.Ww||new UC(a,b)}}Object(n.a)(UC,"SlideshowGoToDialog",Nh.a,[]);class VC{constructor(a,b,c,h,m,y,G,U,ja){this.C4=this.K=null;this.dCb=!1;this.l4=[];this.SVa=this.kE=this.Ycc=null;this.kb=a;this.Sb=b;this.mva=c;this.ia=h;this.ve=m;this.kf=y;this.Zt=G;this.Wt=U;this.Tb=ja}init(){this.K||(this.K=document.createElement("div"),this.K.id="SlideshowContextMenuContainer",
this.K.className="SlideshowContextMenuContainer");this.C4=document.createElement("div");this.C4.className="SlideshowContextMenu cui-menu";this.C4.tabIndex=0;const a=document.createElement("ul");a.className="SlideshowContextMenuList cui-menusection-items";const b=this.Zt();let c=this.SK(ResourceStrings.L_Next,Object(F.a)(this,this.vGb,"onNextClickHandler"),b);Array.add(this.l4,c);a.appendChild(c);c=this.SK(ResourceStrings.L_Previous,Object(F.a)(this,this.AGb,"onPrevClickHandler"),b);Array.add(this.l4,
c);a.appendChild(c);c=this.SK(ResourceStrings.l_GotoCell,Object(F.a)(this,this.jpk,"onGoToClickHandler"),b);Array.add(this.l4,c);a.appendChild(c);c=this.SK(ResourceStrings.L_GridView_SeeAllSlides,Object(F.a)(this,this.sGb,"onGridViewClickHandler"),b);Array.add(this.l4,c);a.appendChild(c);this.Wt.UAf&&(this.Ycc=this.SK(this.Wt.U8?ResourceStrings.L_ExitFullscreen:ResourceStrings.L_EnterFullscreen,Object(F.a)(this,this.TIa,"onFullscreenClickHandler"),b),Array.add(this.l4,this.Ycc),a.appendChild(this.Ycc),
this.Wt.j_&&!this.kE&&(this.kE=Object(F.a)(this,this.ljc,"onFullscreenChangeHandler"),$addHandler(this.kf,this.Wt.j_,this.kE)));c=this.SK(ResourceStrings.L_EndShow,Object(F.a)(this,this.rGb,"onExitClickHandler"),b);Array.add(this.l4,c);a.appendChild(c);this.Tb&&this.Tb.instance&&this.Tb.instance.sr&&(this.SVa=this.SK(ResourceStrings.l_EndLivePresentation,Object(F.a)(this,this.iok,"onEndLivePresentationClickHandler"),b),Array.add(this.l4,this.SVa));this.C4.appendChild(a);this.K.appendChild(this.C4);
this.kf.appendChild(this.K);this.mva.addHandler(this.K,ra.a.click,Object(F.a)(this,this.efa,"onClickHandler"));this.mva.addHandler(this.K,ra.a.contextMenu,Object(F.a)(this,this.s3g,"onHostContextMenuHandler"));this.mva.addHandler(this.C4,ra.a.mq,Object(F.a)(this,this.sgb,"onMouseOverHandler"));this.kb.cOd(Object(F.a)(this,this.kgb,"onContextMenuHandler"));this.kb.lia(Object(F.a)(this,this.hna,"onExitHandler"))}show(){if(this.Tb&&this.Tb.instance&&this.Tb.instance.Yq&&this.SVa&&!this.SVa.parentNode){const a=
this.C4.getElementsByClassName("SlideshowContextMenuList cui-menusection-items");1===a.length&&a[0].appendChild(this.SVa)}this.dCb||(this.mva.addHandler(window.document,ra.a.Zf,Object(F.a)(this,this.UIa,"onKeyDownHandler")),this.mva.addHandler(window.document,ra.a.Hl,Object(F.a)(this,this.rjc,"onKeyUpHandler")),this.dCb=!0);this.K.style.visibility=Td.a.xz}hide(){this.mva.removeHandler(window.document,ra.a.Zf,Object(F.a)(this,this.UIa,"onKeyDownHandler"));this.mva.removeHandler(window.document,ra.a.Hl,
Object(F.a)(this,this.rjc,"onKeyUpHandler"));this.dCb=!1;this.K.style.visibility=Td.a.Ms;if(this.SVa&&this.SVa.parentNode){const a=this.C4.getElementsByClassName("SlideshowContextMenuList cui-menusection-items");1===a.length&&a[0].removeChild(this.SVa)}}remove(){this.K&&(this.mva.removeHandler(this.K,ra.a.click,Object(F.a)(this,this.efa,"onClickHandler")),this.mva.removeHandler(this.K,ra.a.contextMenu,Object(F.a)(this,this.s3g,"onHostContextMenuHandler")),this.kf.contains(this.K)&&this.kf.removeChild(this.K));
this.K=null;Array.clear(this.l4)}hna(){this.kb.Cfa(Object(F.a)(this,this.hna,"onExitHandler"));this.kb.gPe(Object(F.a)(this,this.kgb,"onContextMenuHandler"));this.Ycc&&($removeHandler(this.kf,this.Wt.j_,this.kE),this.kE=null);this.remove()}efa(a){"SlideshowContextMenuContainer"===a.target.id&&(this.hide(),this.kb.restoreFocus())}kgb(a,b){this.d7g(b.clientX,b.clientY)}s3g(a){this.d7g(a.clientX,a.clientY)}sgb(a){(a=a.target)&&"li"===a.tagName.toLowerCase()&&(this.JOe(document.activeElement),this.DR(a))}UIa(a){const b=
a.keyCode,c=a.shiftKey;b===z.a.Pq||b===z.a.x6?this.PZg(!!(1^c)):b===z.a.aZ&&this.PZg(!!(0^c));a.preventDefault()}rjc(a){var b=a.keyCode;b===z.a.tq||b===z.a.mP?(b=document.activeElement,Array.contains(this.l4,b)&&b.click()):b===z.a.J1&&this.kb.exit();a.preventDefault()}d7g(a,b){this.setPosition(a,b);this.isi();this.show();this.C4.focus();this.ve.neh(new zx(ResourceStrings.L_ControlMenu))}setPosition(a,b){if(this.C4){var c=this.C4.offsetWidth,h=this.C4.offsetHeight,m=this.K.clientHeight;a+c>this.K.clientWidth&&
(a-=c);b+h>m&&(b-=h);this.C4.style.top=cf.a.Pc(b);this.C4.style.left=cf.a.Pc(a)}}SK(a,b,c){const h=document.createElement("li");h.className="SlideshowContextMenuItem cui-ctl-mediumlabel";h.innerText=a;h.style.direction=c?"rtl":"ltr";h.tabIndex=1;this.mva.addHandler(h,ra.a.click,b);return h}AGb(){Ba.a.J(24133957,830,50,"SlideshowContextMenu.OnPrevClickHandler");this.kb.prev();this.hide();this.kb.restoreFocus()}vGb(){Ba.a.J(24133959,830,50,"SlideshowContextMenu.OnNextClickHandler");this.kb.next();this.hide();
this.kb.restoreFocus()}jpk(){Ba.a.J(24133961,830,50,"SlideshowContextMenu.OnGoToClickHandler");this.hide();UC.xXj(this.kb,this.Sb.Lj())}sGb(){Ba.a.J(50602842,830,50,"SlideshowContextMenu.OnGridViewClickHandler");this.hide();this.ia.La(M.a.ZLb,2,null)}TIa(){Ba.a.J(40935580,830,50,"SlideshowContextMenu.OnFullscreenClickHandler");this.kb.h0e();this.hide();this.kb.restoreFocus()}ljc(){this.Ycc.innerText=this.Wt.U8?ResourceStrings.L_ExitFullscreen:ResourceStrings.L_EnterFullscreen}rGb(){Ba.a.J(24133963,
830,50,"SlideshowContextMenu.OnExitClickHandler");this.hide();this.kb.exit()}iok(){Ba.a.J(50619421,830,50,"SlideshowContextMenu.OnEndLivePresentationClickHandler");this.hide();this.kb.restoreFocus();this.Tb&&this.Tb.instance&&this.Tb.instance.Yq&&this.Tb.instance.showEndSessionDialog(()=>{this.Tb.instance.C2b(4)},()=>{})}PZg(a){const b=document.activeElement,c=Array.indexOf(this.l4,b);a=this.l4[((-1===c?a?0:-1:a?c+1:c-1)+this.l4.length)%this.l4.length];void 0!==a&&null!==a&&(this.JOe(b),this.DR(a))}isi(){this.l4.forEach(a=>
{this.JOe(a)})}DR(a){void 0!==a&&null!==a&&(Sys.UI.DomElement.addCssClass(a,"SlideshowContextMenuItemFocus"),a.focus(),this.ve.neh(new zx(a.innerText)))}JOe(a){void 0!==a&&null!==a&&Sys.UI.DomElement.removeCssClass(a,"SlideshowContextMenuItemFocus")}}Object(n.a)(VC,"SlideshowContextMenu",null,[573]);var aQ=d(988),Ax=d(259);class BJ{constructor(a,b,c,h,m,y,G,U,ja,va,Ta,fb,Db,gc,hc,Gc,Pc,yc,Vd,De){this.va=new bd.a;this.kE=null;this.cAe=this.dAe=this.D$c=this.Ngc=-1;this.Yqg=this.$qg=this.Zqg=this.ICb=
null;this.Qac="";this.Tad=this.I$c=-1;this.aEg=new Date(0);this.NDg="";this.Xtg=null;this.kwg=this.Rcb=this.Wse=this.Zue=!1;this.EHa=this.Ro=this.Hc=null;this.Rbc=-1;this.svg=this.Lvg=!1;this.Wt=a;this.kb=b;this.hea=c;this.Sb=ja;this.la=G;this.S4j=h;this.vi=m;this.tw=y;this.kt=U;this.Xa=va;this.hz=Ta;this.Qd=fb;this.iwa=Db;this.Oc=gc;this.$ad=hc;this.twa=Gc;this.fu=this.kt.AF();this.LTg=this.la.pptEditorHermesSlideShowStartTimeout;this.EBe=this.la.slideShowWaitForRehydrationTimeoutInMs;this.Oc.GA(Object(F.a)(this,
this.vB,"onSessionEnd"));this.hz.kOd(Object(F.a)(this,this.zGb,"onPodSessionUnavailable"));this.Oc.WB(Object(F.a)(this,this.Bo,"onSessionRehydrated"));this.la.allowDisablingSlideShowButtonDueToRehydration&&(this.hz.Fqb(Object(F.a)(this,this.gfa,"onPodSessionRefreshed")),this.hz.Isf(Object(F.a)(this,this.Med,"onPodSessionRefreshedFromBrowser")));this.ia=Pc;this.Tb=yc;this.B$c=Vd;this.Kl=De;a=document.createElement("div");a.id="HiddenFocusTrapAnchor";u.AFrameworkApplication.fa.ka("RegionComposerIsEnabled")||
u.AFrameworkApplication.fa.ka("Fluent2StyleIsEnabled")?a.style.position="absolute":a.style.position="position: absolute";a.style.left="-10000px";a.style.top="auto";a.style.width="1px";a.style.height="1px";a.style.overflow="hidden";a.tabIndex=-1;this.fu.insertBefore(a,this.fu.firstChild)}dispose(){this.Oc.baa(Object(F.a)(this,this.vB,"onSessionEnd"));this.hz.zUk(Object(F.a)(this,this.zGb,"onPodSessionUnavailable"));this.Oc.Dfa(Object(F.a)(this,this.Bo,"onSessionRehydrated"));this.la.allowDisablingSlideShowButtonDueToRehydration&&
(this.hz.hib(Object(F.a)(this,this.gfa,"onPodSessionRefreshed")),this.hz.cih(Object(F.a)(this,this.Med,"onPodSessionRefreshedFromBrowser")))}$Bj(a,b,c,h){this.Xtg=b;"Legacy"==this.kb.y8()&&this.kb.init(a,b,c,this.Xa.podSessionId);this.Hc=h;this.Ro=new wz}y8(){return this.kb.y8()}j$b(){return!ta.a.Wa(this.Qac)}get gbe(){return this.Rcb}set gbe(a){this.Rcb=a}z7k(){this.svg=!0}cqd(a,b,c,h,m,y,G,U,ja,va,Ta,fb,Db){Mf.Health.instance.addQosPillar("Present");this.j$b()&&Ba.a.J(512495816,830,15,"SlideshowManager:StartFrom starting a new SlideShow while one is already running");
u.AFrameworkApplication.fa.ka("PptPresenterViewEnabled")&&(this.EHa=vb.a.instance.resolve("PowerPointWebEditor.PresenterView.IPresenterViewManager"))&&this.EHa.qdb&&(this.Rbc=b,this.ia.processAction(M.a.Cpd,2,null),this.EHa.D9h(Object(F.a)(this,this.zrk,"onPresenterViewSyncMessageReceivedHandler")));const gc=c;this.la.pptEditorRehearsalSpeechClientEnabled&&(c=!1);this.Ngc=va;this.D$c=Date.now();const hc=document.createElement("div");hc.id="startingSlideshowHiddenDiv";hc.style.position="position: absolute";
hc.style.left="-10000px";hc.style.top="auto";hc.style.width="1px";hc.style.height="1px";hc.style.overflow="hidden";hc.tabIndex=-1;hc.setAttribute("aria-live","assertive");this.fu.insertBefore(hc,this.fu.firstChild);hc.innerText=ResourceStrings.l_StartingSlideShow;const Gc=U+va.toString();this.Qac=Gc;this.iwa&&this.iwa.Cpc(!0);this.la.XSj&&this.$ad&&this.$ad.Cpc(!0);this.Ro&&(this.Ro.T3=c,this.Ro.startingSlideIndex=b,this.Ro.XKa=this.Sb.Lj(),this.Ro.IMf=this.la.RQk);this.la.pptEditorVoiceUXEnabled&&
this.B$c&&this.B$c.init();this.la.pptEditorVoiceUXEnabled&&this.Kl&&this.Kl.execute(yc=>{yc.init()});this.hea.execute(yc=>{yc.init(this.Hc,this.Ro)});this.Zqg=this.fu.style.top;this.fu.style.top=cf.a.Pc(0);this.la.yUa&&(this.$qg=this.fu.style.width,this.Yqg=this.fu.style.height,this.fu.style.width="100%",this.fu.style.height="100%");this.kb.show();this.Gmg();this.la.jwh&&Or.a.ZNb(!1);u.AFrameworkApplication.fa.ka("PptPresenterViewEnabled")&&this.EHa&&this.EHa.qdb&&this.kb.nPa(Object(F.a)(this,this.bfd,
"onSlideChangedHandler"));this.kb.lia(Object(F.a)(this,this.hna,"onExitHandler"));this.kb.rsf(Object(F.a)(this,this.TIa,"onFullscreenClickHandler"));this.kb.PFc(Object(F.a)(this,this.d6g,"onSlideshowReadyHandler"));this.kb.osf(Object(F.a)(this,this.Kdd,"onErrorHandler"));this.kb.QFc(Object(F.a)(this,this.$wa,"onSpecialKeyHandler"));this.kb.gOd(Object(F.a)(this,this.Led,"onPodSessionExpiredHandler"));this.kb.vsf(Object(F.a)(this,this.ked,"onLogEndOfTranscriptionSessionHandler"));this.kb.usf(Object(F.a)(this,
this.jed,"onLiveSubtitlesDockedViewHandler"));this.kb.Msf(Object(F.a)(this,this.yjd,"recordQosErrorHandler"));this.la.allowDisablingSlideShowButtonDueToRehydration||(this.hz.Fqb(Object(F.a)(this,this.gfa,"onPodSessionRefreshed")),this.hz.Isf(Object(F.a)(this,this.Med,"onPodSessionRefreshedFromBrowser")));this.x9h(Object(F.a)(this,this.eed,"onKeydownHandler"));c=Date.now();let Pc=!this.la.Qig||Ta;Pc||(Pc=this.vi.iRc().IN());this.Lvg=Pc;va=Date.now();Ba.a.J(512495815,830,50,"SlideshowManager: Outbound decision time in {0} ms, fWaitForForceOutbound is {1}, fFailOverInProgress is {2}.",
va-c,Pc?"True":"False",Ta?"True":"False");this.dAe=Date.now();this.vi.iRc().forceOutbound(()=>{Ba.a.J(512495814,830,50,"SlideshowManager: Will notify Replication Cache to flush unsaved revisions.");this.vi.flush(()=>{this.cAe=Date.now();Ba.a.J(512495813,830,50,"SlideshowManager: Finished flushing in {0} ms.",this.cAe-this.dAe);this.Qac===Gc&&Pc&&(Ta&&fb&&(Ba.a.J(512495812,830,50,"SlideshowManager: Refreshing the pod sessionId."),m=fb.nk,y=fb.podSessionId),this.uxh(a,b,h,m,y,G,U,ja,Db,gc),Ba.a.J(512495811,
830,50,"SlideshowManager: Launched slideshow after ForceOutbound response."))},yc=>{Ba.a.J(512495810,830,10,"SlideshowManager: Failed to make Replication Cache flush unsaved revisions. {0}",yc.ServerError);return!1})},(yc,Vd)=>{Ba.a.J(512495809,830,10,"SlideshowManager: Failed to force outbound. {0}",Vd)},null);this.Qac!==Gc||Pc||(this.uxh(a,b,h,m,y,G,U,ja,Db,gc),Ba.a.J(512495808,830,50,"SlideshowManager: Launched slideshow without waiting for ForceOutbound."))}uxh(a,b,c,h,m,y,G,U,ja,va=!1){const Ta=
Eh.a.create().toString();this.la.Pgg&&this.hzk(c,m,G,Ta);const fb={};fb.SlideShowKind=this.kb.y8();fb.IsFrameNull=this.kb?"false":"true";fb.slideshowClickTimeMs=this.Ngc;void 0!==window.performance.timing&&null!==window.performance.timing&&(fb.slideshowClickTimePerformanceAPI=this.Ngc-window.performance.timing.navigationStart);Ba.a.J(590976135,830,15,JSON.stringify(fb));this.kb.cqd(a,b,h,m,y,G,U,Ta,this.Ngc);0<this.LTg&&(this.I$c=window.setTimeout(Object(F.a)(this,this.Btk,"onStartSlideshowTimeoutHandler"),
this.LTg));this.Tb&&this.Tb.instance&&this.Tb.instance.efd(a,b,c,h,m,y,G,u.AFrameworkApplication.jh,ja);this.Hc&&this.Hc.I0k();va&&(this.Hc.Kh=!1);Rd.a("PresenterCoachTabFix")&&this.kb.moh()}$wa(a,b){if(b.key===z.a.J1)Ba.a.J(512495779,830,50,"SlideshowManager.OnSpecialKeyHandler Esc key"),this.hea.execute(c=>{c.remove()}),this.kb.exit();else if(b.key===z.a.iPb)this.ia.La(M.a.Xrd,2,null);else if(b.key===z.a.bvd&&this.la.Pka&&this.Hc&&this.Hc.kDa&&this.Ro&&this.Sb&&!this.Ro.T3&&this.la.EUj&&this.Hc.jSf)try{this.Hc.Kh&&
(oi.a.SJ("PPTCaptionDiscoverabiltyDoNotShowAgain","true",oi.a.wJ)||Ba.a.J(512495778,822,10,"SlideShowManager::OnSpecialKeyHandler - Failed to set cookie for discoverability opt out to true"));this.Hc.Kh=!this.Hc.Kh;Ba.a.J(512495777,830,50,"SlideshowManager.OnSpecialKeyHandler m_subtitleContext FUseSubtitles is changed to: {0}",this.Hc.Kh);const c=document.getElementById("buttonSubtitle");if(c){const m=c.getElementsByTagName("span")[0].getElementsByTagName("img")[0];m&&(m.className=this.Hc.Kh?"prt2_SubtitleSlideShowToggleHover_40x40x32":
"prt2_SubtitleSlideShowToggleOff_40x40x32")}const h=!!this.Tb&&!!this.Tb.instance&&this.Tb.instance.Yq;if(h)this.kb.toggleTranscriberUIVisibility(null);else{let m=Date.now();this.kb.transcribe(u.AFrameworkApplication.userSessionId,this.Xa.podSessionId,this.Xa.nk,u.AFrameworkApplication.jh,4,m,this.Ro)}this.hea.execute(m=>{m.setToolbarButtonToggleState(wh.a.SubtitlesButton,this.Hc.Kh);m.cD(wh.a.CoachButton,!this.Hc.Kh&&!h)})}catch(c){Ba.a.J(512495776,830,50,"SlideshowManager.OnSpecialKeyHandler Exception thrown when pressing the J key: {0}",
c)}else if(b.key===z.a.Huc&&this.Tb&&this.Tb.instance&&this.Tb.instance.kDa&&this.Tb.instance.KTi&&this.Ro&&!this.Ro.T3)try{if(this.Tb.instance.Yq)this.Tb.instance.showWelcomeScreen();else{this.Tb.instance.Jca=!this.Hc.Kh;if(this.Hc.Pub&&!this.Hc.Kh){this.Hc.Kh=!0;let c=Date.now();this.kb.transcribe(u.AFrameworkApplication.userSessionId,this.Xa.podSessionId,this.Xa.nk,u.AFrameworkApplication.jh,5,c,this.Ro);this.Hc.Kh=!1}this.Tb.instance.erc(4,u.AFrameworkApplication.userSessionId,this.la.podsWebServiceBase,
this.Xa.podSessionId,u.AFrameworkApplication.jh)}}catch(c){Ba.a.J(512495775,830,50,"SlideshowManager.OnSpecialKeyHandler Exception thrown when pressing the L key: {0}",c)}}zrk(a,b){b&&(a=b.slideIndex,a!==this.Rbc&&(this.Rbc=a,this.kb.$Sa(a)))}PYa(){Ba.a.J(512495774,830,50,"OnVisibilityChangeHandler: Full screen exited due to tab visibility change.");this.Zue=!0}hzk(a,b,c,h){Ba.a.J(512495773,830,50,"SlideshowManager.PauseResumeMerge. correlationId: {0}",h);a=String.format("{0}PodHandler.ashx?action=LockUnlockSession&PodSID={1}&locked={2}",
a,b,!0);b={WaitForSessionTimeoutMs:"0"};b["X-UserSessionId"]=c;b["X-CorrelationID"]=h;b["X-WacCluster"]=this.Xtg;this.tw.Aj(a,2,null,b,!1,2,()=>{Ba.a.J(512495772,830,50,"SlideshowManager.PauseResumeMerge: Pause/resume merge succeeded. isPaused: {0}, userSessionId: {1}, correlationId: {2} ",!0,c,h)},()=>{Ba.a.J(512495771,830,10,"SlideshowManager.PauseResumeMerge: Pause/resume merge failed. isPaused: {0}, userSessionId: {1}, correlationId: {2} ",!0,c,h)},null,void 0,void 0,void 0,void 0,Ax.a("14"))}lia(a){this.va.addHandler("OnExitSlideshow",
a)}Cfa(a){this.va.removeHandler("OnExitSlideshow",a)}nPa(a){this.va.addHandler("OnPositionChangeEventId",a)}fib(a){this.va.removeHandler("OnPositionChangeEventId",a)}x9h(a){this.ICb||(this.ICb=a,wd.a.addHandler(window.document.body,"keydown",this.ICb))}iPe(){this.ICb&&(wd.a.removeHandler(window.document.body,"keydown",this.ICb),this.ICb=null)}ljc(){if(this.Wt.U8)Ba.a.J(512495770,830,50,"SlideshowManager.OnFullscreenChangeHandler still in full screen");else{this.ZCf();this.kb.oPe(Object(F.a)(this,
this.PYa,"onVisibilityChangeHandler"));Ba.a.J(512495769,830,50,"SlideshowManager.OnFullscreenChangeHandler: Leaving full screen mode.");var a=u.AFrameworkApplication.fa.Ha(u.AFrameworkApplication.YJ);a=!!a&&"teams"===a.toLowerCase();this.Zue||this.Wse||!document.hasFocus()||a||(Ba.a.J(512495768,830,50,"SlideshowManager.OnFullscreenChangeHandler: Exiting SlideshowFrame"),this.hea.execute(b=>{b.remove()}),this.kb.exit());this.Zue=!1}this.Wse=!1}bfd(a,b){b&&this.Rbc!==b.slideIndex&&(this.Rbc=b.slideIndex,
this.EHa.p3k(b))}hna(a,b){Ba.a.J(512495767,830,50,"SlideshowManager.OnExitHandler Exiting SlideShow.");this.BDf();var c=["WACInnerFrame","WACStatusBarContainer","WACDebugPanelFrame","ClipboardTarget","application_AssertiveNotifier"];for(var h of c)(c=document.getElementById(h))&&Sys.UI.DomElement.removeCssClass(c,"SlideShowAXItemNavigationFocusTrap");this.Qac="";this.iwa&&this.iwa.Cpc(!1);this.$ad&&this.$ad.Cpc(!1);this.Hc&&this.Hc.ZYk();this.kb.Cfa(Object(F.a)(this,this.hna,"onExitHandler"));this.kb.Shh(Object(F.a)(this,
this.TIa,"onFullscreenClickHandler"));this.kb.kkd(Object(F.a)(this,this.d6g,"onSlideshowReadyHandler"));this.kb.Phh(Object(F.a)(this,this.Kdd,"onErrorHandler"));this.kb.lkd(Object(F.a)(this,this.$wa,"onSpecialKeyHandler"));this.kb.oPe(Object(F.a)(this,this.PYa,"onVisibilityChangeHandler"));this.kb.kPe(Object(F.a)(this,this.Led,"onPodSessionExpiredHandler"));this.kb.Uhh(Object(F.a)(this,this.ked,"onLogEndOfTranscriptionSessionHandler"));this.kb.Thh(Object(F.a)(this,this.jed,"onLiveSubtitlesDockedViewHandler"));
this.kb.iih(Object(F.a)(this,this.yjd,"recordQosErrorHandler"));this.iPe(Object(F.a)(this,this.eed,"onKeydownHandler"));(h=document.getElementById("startingSlideshowHiddenDiv"))&&h.parentNode.removeChild(h);this.la.allowDisablingSlideShowButtonDueToRehydration||(this.hz.hib(Object(F.a)(this,this.gfa,"onPodSessionRefreshed")),this.hz.cih(Object(F.a)(this,this.Med,"onPodSessionRefreshedFromBrowser")));this.la.jwh&&(Or.a.ZNb(!0),this.Wt.U8||dG.a.m_a(u.AFrameworkApplication.isRtl));this.ZCf();Os.exitFullscreen();
this.fu.style.top=this.Zqg;this.la.yUa&&(this.fu.style.width=this.$qg,this.fu.style.height=this.Yqg);this.kt.Mq();this.va.raiseEvent("OnExitSlideshow",b,a);this.Tb&&this.Tb.instance&&this.Tb.instance.mtk();this.Ro&&this.Ro.T3&&b.summary&&this.ia.La(M.a.VKa,2,b.summary);u.AFrameworkApplication.fa.ka("PptPresenterViewEnabled")&&this.EHa&&this.EHa.qdb&&this.ia.processAction(M.a.lJc,2,null);this.Ro&&(this.Ro.T3=!1);this.la.pptEditorVoiceUXEnabled&&this.Kl&&this.Kl.instance&&this.Kl.instance.remove();
this.la.pptEditorVoiceUXEnabled&&this.B$c&&this.B$c.remove();this.msl()}msl(){u.AFrameworkApplication.fa.ka("798")&&vb.a.instance.Ja("Common.ISystemInitiatedFeedback").execute(a=>{window.setTimeout(()=>{Ba.a.J(512495766,830,15,"Trigger NPS after slideshow");a.logActivity("AppUsageTimeSatisfiedNPS",null)},1E3)})}TIa(){this.Wse=!0;this.Wt.U8?Os.exitFullscreen():this.Gmg()}Gmg(){this.Wt.Y8b&&(this.Wt.j_&&!this.kE&&(this.kE=Object(F.a)(this,this.ljc,"onFullscreenChangeHandler"),$addHandler(this.fu,this.Wt.j_,
this.kE)),this.Wt.requestFullscreen(this.fu),this.kb.Fsf(Object(F.a)(this,this.PYa,"onVisibilityChangeHandler")))}d6g(){this.BDf();var a=["WACInnerFrame","WACStatusBarContainer","WACDebugPanelFrame","ClipboardTarget","application_AssertiveNotifier"];for(var b of a)(a=document.getElementById(b))&&Sys.UI.DomElement.addCssClass(a,"SlideShowAXItemNavigationFocusTrap");if(-1!==this.D$c){b=Date.now();Ba.a.J(23098073,830,15,"slideshow ready in {0} ms",b-this.D$c);a={};a.SlideshowClickTimeMs=this.Ngc;a.SlideshowStartTimeMs=
this.D$c;a.SlideshowStartFlushTimeMs=this.dAe;a.SlideshowFinishFlushTimeMs=this.cAe;a.SlideShowFinishedTimeMs=b;a.NoBlockingOutBoundSetting=this.la.Qig;a.NoBlockingOutBound=!this.Lvg;Ba.a.J(512495765,830,50,JSON.stringify(a));this.hea.execute(()=>{this.la.t9b&&this.kb.getCurrentSlideDimensions()});!this.la.wg||!this.la.zah&&this.la.t9b||this.S4j.init(this.Hc,this.Ro);b=!!this.Tb&&!!this.Tb.instance&&this.Tb.instance.sr&&this.Tb.instance.jDa;a=!!this.Tb&&!!this.Tb.instance&&(this.Tb.instance.LRa||
this.Tb.instance.Yq);if((this.la.Pka||this.la.w$b)&&this.Hc&&this.Ro&&this.Sb&&(this.Hc.Kh||this.Ro.T3||b||a)&&this.Hc.jSf){const c=Date.now();let h=2;u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.hb.Np&&(h=1);const m=this.Hc.Kh;b||a?(this.Hc.Kh||(h=5),this.Tb.instance.Jca=!this.Hc.Kh,this.Hc.Kh=!0):this.Tb&&this.Tb.instance&&(this.Tb.instance.Jca=!1);this.kb.transcribe(u.AFrameworkApplication.userSessionId,this.Xa.podSessionId,this.Xa.nk,u.AFrameworkApplication.jh,h,c,this.Ro);this.Hc.Kh=
m}b&&(this.Tb.instance.jDa=!1);this.iPe(Object(F.a)(this,this.eed,"onKeydownHandler"));this.kb.Vfa(!1);this.kb.setOsfLocalStorage()}}eed(a){27===a.keyCode&&(Ba.a.J(512495764,830,50,"SlideshowManager.OnKeydownHandler: Esc"),this.iPe(Object(F.a)(this,this.eed,"onKeydownHandler")),this.hea.execute(b=>{b.remove()}),this.kb.exit())}ked(a,b){a={};try{const c=Da.a.fL(b.Hx);for(const h of c)try{a[h]=b.Hx[h]}catch(m){Ba.a.J(512495763,830,10,"SlideshowManager.OnLogEndOfTranscriptionSessionHandler: Exception thrown when adding transcription session telemetry value for key: {0}, exception: {1}",
h,m)}}catch(c){Ba.a.J(512495762,830,10,"SlideshowManager.OnLogEndOfTranscriptionSessionHandler: Exception thrown when logging transcription telemetry. Exception: {0}",c)}Ba.a.J(512495761,830,15,JSON.stringify(a));try{!(this.Ro&&this.Ro.T3||!this.la.aDk||this.kwg)&&a.WebSocketConnectionDurationMS&&6E4<parseInt(a.WebSocketConnectionDurationMS.toString())&&(Ba.a.J(512495760,830,50,"Floodgate survey triggered for transcription."),this.kwg=!0,this.twa.continueWith(()=>{this.twa.result.logActivity("TranscriptionUsed",
"PPTTranscriptionFloodgateSurveyEnabled")}))}catch(c){Ba.a.J(512495759,830,10,"SlideshowManager.OnLogEndOfTranscriptionSessionHandler: Exception thrown when trying to trigger floodgate survey. Exception: {0}",c)}}jed(a,b){this.la.t9b||((a=document.getElementById("slideshow-toolbar"))?b.l$b?"BelowSlide"===b.Ov?(a.style.bottom="15%",a.style.left="8%"):"AboveSlide"===b.Ov?(a.style.bottom="6px",a.style.left="8%"):(a.style.left="0%",a.style.bottom="6px",a.style.top="auto"):(a.style.left="0%",a.style.bottom=
"6px",a.style.top="auto"):Ba.a.J(512495758,830,10,"SlideshowManager.OnLiveSubtitlesDockedViewHandler: Can't find pptViewerAnchor-Met or slideshow-toolbar"))}Led(a,b){Ba.a.J(512495757,830,50,"SlideshowManager.OnPodSessionExpiredHandler ErrorCode: {0}, Reason: {1}, request PodSessionId: {2}",b.code,b.reason,b.podSessionId);if(b.podSessionId!==this.Xa.podSessionId)Ba.a.J(512495756,830,15,"SlideshowManager.OnPodSessionExpiredHandler: Failing request PODS ID and m_sessionInfoOwner PODS ID do not match, so will return. m_sessionInfoOwner has a newer PODS ID: {0}, and this failing request is coming from an old PODS ID: {1}.",
this.Xa.podSessionId,b.podSessionId);else{if((a=this.la.slideShowErrorsThatTriggerRehydration)&&0<a.length&&a[0]){var c=new Date(this.aEg.getTime()+1E3*this.la.slideShowMinimumTimeBetweenRehydrationAttemptsInSec);const h=new Date,m=h>c;Ba.a.J(512495755,830,50,"SlideshowManager.OnPodSessionExpiredHandler: currentTime: {0} time after which rehydration is allowed: {1} canTriggerRehydration: {2}",h,c,m);if(m)for(c=0;c<a.length;c++){if(a[c]===b.code.toString()&&(Ba.a.J(512495754,830,10,"SlideshowManager.OnPodSessionExpiredHandler: Error from Slideshow: {0}",
b.code),this.Qd.us(Object.assign(new jl.a,{Code:223,Source:4}),b.podSessionId),0<this.EBe)){Ba.a.J(512495753,830,10,"SlideshowManager.OnPodSessionExpiredHandler: Triggered rehydration and will wait for {0} ms before calling the timeout handler.",this.EBe);this.aEg=new Date;this.NDg=b.podSessionId;this.Tad=window.setTimeout(Object(F.a)(this,this.VQk,"rehydrationTimeout"),this.EBe);return}}else if(this.NDg===b.podSessionId){Ba.a.J(512495752,830,50,"SlideshowManager.OnPodSessionExpiredHandler: A request to rehydrate the session based on the pod session id: {0} has already been sent. Wait for rehydration to complete.",
b.podSessionId);return}}u.AFrameworkApplication.xp(qf.a.Uh(359));Mf.Health.instance.recordQosError("SlideShowFailure",["SlideShowACE"],!1,!1,!0,!1,null);this.la.podExitSlideshowOnError&&(Ba.a.J(512495751,830,10,"SlideshowManager.OnPodSessionExpiredHandler: Will exit slideshow. Error from Slideshow: {0}",b.code),this.hea.execute(h=>{h.remove()}),this.kb.exit())}}Kdd(a,b){a=String.format("Category: {0}, Code: {1}, SessionId: {2}, CorrelationId: {3}, Message: {4}, ExtraInfo: {5}, IsApiError: {6}",b.category,
b.code,b.sessionId,b.correlationId,b.message,b.Py,b.xHj.toString());Ba.a.J(512495750,830,10,"SlideshowManager.OnErrorHandler: Error from Slideshow: {0}",a);u.AFrameworkApplication.xp(qf.a.Uh(359));Mf.Health.instance.recordQosError("SlideShowFailure",["SlideShowACE"],!1,!0,!0,!0,null);this.la.podExitSlideshowOnError&&(Ba.a.J(512495749,830,10,"SlideshowManager.OnErrorHandler: Will exit slideshow. Error from Slideshow: {0}",b.code),this.hea.execute(c=>{c.remove()}),this.kb.exit())}ZCf(){this.kE&&(Ba.a.J(512495748,
830,50,"SlideshowManager.CleanupFullscreenChangeHandler"),$removeHandler(this.fu,this.Wt.j_,this.kE),this.kE=null)}Btk(){Ba.a.J(512495747,830,15,"SlideshowManager.OnStartSlideshowTimeoutHandler");u.AFrameworkApplication.xp(qf.a.Uh(360));Mf.Health.instance.recordQosError("SlideShowTimeout",["SlideShowACE"],!1,!0,!0,!0,null);this.hea.execute(a=>{a.remove()});this.kb.exit()}VQk(){Ba.a.J(512495746,830,15,"SlideshowManager.RehydrationTimeout");u.AFrameworkApplication.xp(qf.a.Uh(371));Mf.Health.instance.recordQosError("SlideShowWaitForRehydrationTimedOut",
["SlideShowACE"],!1,!0,!0,!0,null);this.hea.execute(a=>{a.remove()});this.kb.exit()}yjd(a,b){a=0<b.durationMs?Object.assign(new ql.a,{durationMs:b.durationMs}):null;Mf.Health.instance.recordQosError(b.errorName,[b.vetoName],b.isIntentional,b.isInternal,b.alertOnPillar,b.isSessionEndingError,a)}gfa(a,b){Ba.a.J(512495745,830,50,"SlideshowManager.OnPodSessionRefreshed: Enabling the SlideShow button. AllowDisablingSlideShowButtonDueToRehydration: {0}",this.la.allowDisablingSlideShowButtonDueToRehydration);
this.Rcb=!1;this.GDf();this.j$b()||"Legacy"!=this.kb.y8()?(Ba.a.J(512495715,830,15,"SlideshowManager.OnPodSessionRefreshed: Refreshing PodSession. PodSessionId:{0}, WacCluster:{1}",b.eY,this.Xa.nk),this.kb.refreshPodSession(b.eY,this.Xa.nk)):Ba.a.J(512495744,830,50,"SlideshowManager.OnPodSessionRefreshed: Skip updating due to not active.")}Med(a,b){Ba.a.J(512495714,830,50,"SlideshowManager.OnPodSessionRefreshedFromBrowser: Enabling the SlideShow button. AllowDisablingSlideShowButtonDueToRehydration: {0}",
this.la.allowDisablingSlideShowButtonDueToRehydration);this.Rcb=!1;this.GDf();this.j$b()||"Legacy"!=this.kb.y8()?(Ba.a.J(512495712,830,15,"SlideshowManager.OnPodSessionRefreshedFromBrowser: Refreshing PodSession. PodSessionId:{0}, WacCluster:{1}",b.eY,this.Xa.nk),this.kb.refreshPodSession(b.eY,this.Xa.nk)):Ba.a.J(512495713,830,50,"SlideshowManager.OnPodSessionRefreshedFromBrowser: Skip updating due to not active.")}Bo(){this.Rcb=!1;Ba.a.J(512495711,830,50,"SlideshowManager.OnSessionRehydrated: Enabling the SlideShow button. AllowDisablingSlideShowButtonDueToRehydration: {0}",
this.la.allowDisablingSlideShowButtonDueToRehydration)}vB(){this.Rcb=!0;Ba.a.J(512495710,830,50,"SlideshowManager.OnSessionEnd: Disabling the SlideShow button. AllowDisablingSlideShowButtonDueToRehydration: {0}",this.la.allowDisablingSlideShowButtonDueToRehydration)}zGb(){this.Rcb=!0;Ba.a.J(512495709,830,50,"SlideshowManager.OnPodSessionUnavailable: Disabling the SlideShow button. AllowDisablingSlideShowButtonDueToRehydration: {0}",this.la.allowDisablingSlideShowButtonDueToRehydration)}BDf(){-1!==
this.I$c&&(window.clearTimeout(this.I$c),this.I$c=-1)}GDf(){-1!==this.Tad&&(window.clearTimeout(this.Tad),this.Tad=-1)}}Object(n.a)(BJ,"SlideshowManager",null,[538]);class WC{constructor(a,b,c,h,m,y,G,U,ja,va,Ta){this.yva=this.bdc=this.bfb=this.zBb=this.ycb=this.TVa=this.hDb=this.MDb=this.Ro=this.Hc=this.ie=null;this.edc=0;this.SL=!1;this.kE=null;this.kb=c;this.je=h;this.ABe=m;this.kf=G;this.Zt=U;this.Xa=va;this.Wt=Ta;this.ia=a;this.Ga=b;this.Dwe=null;this.u8c=ja;this.Tb=y}init(a,b){this.ie=document.createElement("div");
this.ie.id="slideshow-toolbar";this.ie.className="SlideshowToolbar";this.kf.appendChild(this.ie);this.Hc=a;this.Ro=b;this.Zt()?(this.MDb=this.Wra("buttonPrevSlide","navigationButton navigationButtonRtl","SlideShowNextServer",ResourceStrings.L_Next),this.hDb=this.Wra("buttonNextSlide","navigationButton navigationButtonRtl","SlideShowPrevServer",ResourceStrings.L_Previous)):(this.MDb=this.Wra("buttonPrevSlide","navigationButton navigationButtonLtr","SlideShowPrevServer",ResourceStrings.L_Previous),
this.hDb=this.Wra("buttonNextSlide","navigationButton navigationButtonLtr","SlideShowNextServer",ResourceStrings.L_Next));this.ie.appendChild(this.MDb);this.ie.appendChild(this.hDb);wd.a.addHandler(this.MDb,ra.a.click,Object(F.a)(this,this.AGb,"onPrevClickHandler"));wd.a.addHandler(this.hDb,ra.a.click,Object(F.a)(this,this.vGb,"onNextClickHandler"));this.bdc=this.Wra("buttonEnterGridView","navigationButton navigationButtonLtr","GridView",ResourceStrings.L_GridView_SeeAllSlides);this.ie.appendChild(this.bdc);
wd.a.addHandler(this.bdc,ra.a.click,Object(F.a)(this,this.sGb,"onGridViewClickHandler"));this.ycb=this.TVa=null;this.Wt.UAf&&(this.TVa=this.Wra("buttonEnterFullscreen","navigationButton navigationButtonLtr","SlideShowFullscreen",ResourceStrings.L_EnterFullscreen),this.ycb=this.Wra("buttonExitFullscreen","navigationButton navigationButtonLtr","SlideShowBackToWindow",ResourceStrings.L_ExitFullscreen),a=this.Wt.U8,this.TVa.style.display=a?Td.a.Gf:Td.a.Xk,this.ycb.style.display=a?Td.a.Xk:Td.a.Gf,this.ie.appendChild(this.TVa),
this.ie.appendChild(this.ycb),wd.a.addHandler(this.TVa,ra.a.click,Object(F.a)(this,this.TIa,"onFullscreenClickHandler")),wd.a.addHandler(this.ycb,ra.a.click,Object(F.a)(this,this.TIa,"onFullscreenClickHandler")),this.Wt.j_&&!this.kE&&(this.kE=Object(F.a)(this,this.ljc,"onFullscreenChangeHandler"),$addHandler(this.kf,this.Wt.j_,this.kE)));this.bfb=null;this.Hc.Pub&&!this.Ro.T3&&(this.bfb=this.Wra("buttonSubtitle","navigationButton navigationButtonLtr","SubtitleSlideShowToggleOff",ResourceStrings.L_UseSubtitles),
this.ie.appendChild(this.bfb),wd.a.addHandler(this.bfb,ra.a.click,Object(F.a)(this,this.rfd,"onTranscribeHandler")));this.zBb=this.Wra("buttonExitSlideShow","navigationButton navigationButtonLtr","ExitSlideShowServer",ResourceStrings.L_EndShow);this.ie.appendChild(this.zBb);wd.a.addHandler(this.zBb,ra.a.click,Object(F.a)(this,this.rGb,"onExitClickHandler"));this.yva=null;this.Tb&&this.Tb.instance&&this.Tb.instance.sr&&!this.Ro.T3&&(this.Tb.instance.Asf(Object(F.a)(this,this.ujc,"onLiveSessionStarted")),
this.Tb.instance.ysf(Object(F.a)(this,this.tjc,"onLiveSessionEnded")),this.Tb.instance.X8h(Object(F.a)(this,this.T3g,"onLiveCalloutDismissed")),this.Tb.instance.wsf(Object(F.a)(this,this.sjc,"onLiveRelaunchPausedSession")),this.Tb.instance.i8a?this.gIf():this.Tb.instance.N9h(Object(F.a)(this,this.V3g,"onLivePresenterResourcesLoaded")));this.SL=!1;this.hide();this.kb.lia(Object(F.a)(this,this.hna,"onExitHandler"));this.kb.aOd(Object(F.a)(this,this.jgb,"onBrowserEventHandler"));wd.a.addHandler(this.ie,
ra.a.mq,Object(F.a)(this,this.sgb,"onMouseOverHandler"));wd.a.addHandler(this.ie,ra.a.Is,Object(F.a)(this,this.wjc,"onMouseOutHandler"))}show(){this.ie.style.display=Td.a.Xk;window.clearTimeout(this.edc);this.edc=window.setTimeout(Object(F.a)(this,this.hide,"hide"),3E3);this.kb.Vfa(!0)}hide(){this.SL||(window.clearTimeout(this.edc),this.ie.style.display=Td.a.Gf,this.kb.Vfa(!1))}remove(){this.ie&&this.kf.contains(this.ie)&&(this.kf.removeChild(this.ie),this.Tb&&this.Tb.instance&&this.Tb.instance.sr&&
(this.Tb.instance.Zhh(Object(F.a)(this,this.ujc,"onLiveSessionStarted")),this.Tb.instance.Yhh(Object(F.a)(this,this.tjc,"onLiveSessionEnded")),this.Tb.instance.ETk(Object(F.a)(this,this.T3g,"onLiveCalloutDismissed")),this.Tb.instance.hUk(Object(F.a)(this,this.V3g,"onLivePresenterResourcesLoaded")),this.Tb.instance.Whh(Object(F.a)(this,this.sjc,"onLiveRelaunchPausedSession"))),this.SL=!1)}cD(){}setToolbarButtonToggleState(){}hna(){this.kb.Cfa(Object(F.a)(this,this.hna,"onExitHandler"));this.kb.ePe(Object(F.a)(this,
this.jgb,"onBrowserEventHandler"));wd.a.removeHandler(this.ie,ra.a.mq,Object(F.a)(this,this.sgb,"onMouseOverHandler"));wd.a.removeHandler(this.ie,ra.a.Is,Object(F.a)(this,this.wjc,"onMouseOutHandler"));wd.a.removeHandler(this.MDb,ra.a.click,Object(F.a)(this,this.AGb,"onPrevClickHandler"));wd.a.removeHandler(this.hDb,ra.a.click,Object(F.a)(this,this.vGb,"onNextClickHandler"));wd.a.removeHandler(this.zBb,ra.a.click,Object(F.a)(this,this.rGb,"onExitClickHandler"));this.yva&&wd.a.removeHandler(this.yva,
ra.a.click,Object(F.a)(this,this.S3g,"onLiveBroadcastHandler"));this.bfb&&wd.a.removeHandler(this.bfb,ra.a.click,Object(F.a)(this,this.rfd,"onTranscribeHandler"));this.TVa&&(wd.a.removeHandler(this.TVa,ra.a.click,Object(F.a)(this,this.TIa,"onFullscreenClickHandler")),wd.a.removeHandler(this.ycb,ra.a.click,Object(F.a)(this,this.TIa,"onFullscreenClickHandler")),$removeHandler(this.kf,this.Wt.j_,this.kE),this.kE=null);this.bdc&&wd.a.removeHandler(this.bdc,ra.a.click,Object(F.a)(this,this.sGb,"onGridViewClickHandler"));
this.remove()}jgb(){this.show()}ljc(){const a=this.Wt.U8;this.TVa.style.display=a?Td.a.Gf:Td.a.Xk;this.ycb.style.display=a?Td.a.Xk:Td.a.Gf}sgb(a){if(a=a.target)a.className.startsWith("prt2_SubtitleSlideShowToggle")?a.className.startsWith("prt2_SubtitleSlideShowToggleOff_40x40x32")&&(a.className=a.className.replace("Off_40x40x32","Hover_40x40x32")):a.className.startsWith("prt2_PresentLiveSlideshowToolbarToggle")?a.className.startsWith("prt2_PresentLiveSlideshowToolbarToggle_40x40x32")&&(a.className=
a.className.replace("_40x40x32","Hover_40x40x32")):a.className=a.className.replace("_40x40x32","Hvr_40x40x32"),this.SL=!0}wjc(a){if(a=a.target)a.className.startsWith("prt2_SubtitleSlideShowToggle")?!this.Hc.Kh&&a.className.startsWith("prt2_SubtitleSlideShowToggleHover_40x40x32")&&(a.className=a.className.replace("Hover_40x40x32","Off_40x40x32")):a.className.startsWith("prt2_PresentLiveSlideshowToolbarToggle")?this.Tb&&!this.Tb.instance.Yq&&a.className.startsWith("prt2_PresentLiveSlideshowToolbarToggleHover_40x40x32")&&
(a.className=a.className.replace("Hover_40x40x32","_40x40x32")):a.className=a.className.replace("Hvr_40x40x32","_40x40x32"),this.f1d()||(this.SL=!1);this.f1d()||this.kb.restoreFocus()}AGb(){Ba.a.J(23954837,830,50,"SlideshowToolbar.OnPrevClickHandler");this.S0a(this.MDb.title);this.kb.prev();this.kb.restoreFocus()}vGb(){Ba.a.J(23954839,830,50,"SlideshowToolbar.OnNextClickHandler");this.S0a(this.hDb.title);this.kb.next();this.kb.restoreFocus()}rGb(){Ba.a.J(23954841,830,50,"SlideshowToolbar.OnExitClickHandler");
this.S0a(this.zBb.title);this.kb.exit()}TIa(){Ba.a.J(40449118,830,50,"SlideshowToolbar.OnFullscreenClickHandler");this.kb.h0e()}S3g(){this.Tb&&this.Tb.instance&&(this.S0a(this.yva.title),Ba.a.J(41231116,830,50,"FLiveBroadcastInUse is changed to: {0}",this.Tb.instance.Yq),this.Tb.instance.Yq?(this.kb.pausePresentation(),this.Tb.instance.showCallout(this.yva)):(this.Tb.instance.erc(3,u.AFrameworkApplication.userSessionId,this.u8c,this.Xa.podSessionId,u.AFrameworkApplication.jh),this.Tb.instance.Jca=
!this.Hc.Kh,this.Hc.Pub&&!this.Hc.Kh&&(Ba.a.J(41682897,830,50,"Starting subtitle in OnLiveBroadcastHandler for starting live session."),this.Hc.Kh=!0,this.kb.transcribe(u.AFrameworkApplication.userSessionId,this.Xa.podSessionId,this.Xa.nk,u.AFrameworkApplication.jh,5,Date.now(),this.Ro),this.Hc.Kh=!1)),this.Q2e())}k0e(a,b){this.S0a(this.bfb.title);const c=!!this.Tb&&!!this.Tb.instance&&this.Tb.instance.Yq,h=this.Hc.hSf&&5!==a&&!c;5!==a&&(this.Hc.Kh=!this.Hc.Kh);Ba.a.J(39682065,830,50,"SlideshowToolbar.ToggleTranscriber m_subtitleContext FUseSubtitles is changed to: {0}",
this.Hc.Kh);b&&(this.Hc.Kh?(b.className="prt2_SubtitleSlideShowToggleHover_40x40x32",h&&xz.Dmg(this.kb,this.je,this.Xa)):b.className="prt2_SubtitleSlideShowToggleOff_40x40x32");h||(b=Date.now(),c?this.kb.toggleTranscriberUIVisibility(null):this.kb.transcribe(u.AFrameworkApplication.userSessionId,this.Xa.podSessionId,this.Xa.nk,u.AFrameworkApplication.jh,a,b,this.Ro))}rfd(a){this.k0e(3,a.target)}sGb(){Ba.a.J(595204312,830,50,"SlideshowToolbar.OnGridViewClickHandler");this.ia.La(M.a.ZLb,2,null)}gIf(){this.yva||
(this.yva=this.Wra("buttonLiveBroadcast","navigationButton navigationButtonLtr","PresentLiveSlideshowToolbarToggle",ResourceStrings.L_UseLiveBroadcast),this.ie.insertBefore(this.yva,this.zBb),wd.a.addHandler(this.yva,ra.a.click,Object(F.a)(this,this.S3g,"onLiveBroadcastHandler")))}Wra(a,b,c,h){const m=document.createElement("div");m.id=a;m.className=b;if("buttonSubtitle"===a)return a=zp.createClusteredImageFromCluster(40,40,"SubtitleSlideShowToggle"+(this.Hc.Kh?"Hover_40x40x32":"Off_40x40x32"),"prt2",
this.je.pk("prt2.png"),null,null,!0,null),m.appendChild(a),m.title=h,m;if("buttonLiveBroadcast"===a)return a=zp.createClusteredImageFromCluster(40,40,"PresentLiveSlideshowToolbarToggle"+(this.Tb&&this.Tb.instance&&this.Tb.instance.Yq?"Hover_40x40x32":"_40x40x32"),"prt2",this.je.pk("prt2.png"),null,null,!0,null),m.appendChild(a),m.title=h,1===a.children.length&&(this.Dwe=a.children[0]),m;a=zp.createClusteredImageFromCluster(40,40,c+"_40x40x32","prt2",this.je.pk("prt2.png"),null,null,!0,null);m.appendChild(a);
m.title=h;return m}S0a(a){ta.a.Wa(a)?Ba.a.J(23396621,830,15,"SlideshowToolbar::RaiseSlideshowNavigationToolbarClickedEvent, Toolbar title is null"):this.ABe.oeh(new zx(a))}f1d(){return!!this.Tb&&!!this.Tb.instance&&this.Tb.instance.ZTi}Q2e(){this.Tb&&this.Tb.instance&&this.Dwe&&(this.Dwe.className="prt2_PresentLiveSlideshowToolbarToggle"+(this.Tb.instance.Yq?"Hover_40x40x32":"_40x40x32"))}V3g(){this.gIf()}ujc(){this.Q2e()}tjc(){this.Tb&&this.Tb.instance&&this.Tb.instance.Jca&&!this.Hc.Kh&&(Ba.a.J(41682899,
830,50,"Stopping subtitle for stopping live session."),this.kb.transcribe(u.AFrameworkApplication.userSessionId,this.Xa.podSessionId,this.Xa.nk,u.AFrameworkApplication.jh,5,Date.now(),this.Ro));this.Tb.instance.Jca=!1;this.Q2e()}sjc(){this.Tb&&this.Tb.instance&&(this.SL=!0,this.show(),this.kb.pausePresentation(),this.Tb.instance.showCallout(this.yva))}T3g(){this.SL=this.f1d();this.SL||(window.clearTimeout(this.edc),this.edc=window.setTimeout(Object(F.a)(this,this.hide,"hide"),3E3))}}Object(n.a)(WC,
"SlideshowToolbar",null,[572,573]);class hu{constructor(a){this.QBb=this.ZX=this.bFb=null;this.xAe="BelowSlide";this.Acb=this.hvg=!1;this.Icc=!0;this.e4c=-1;this.Jvg=this.vcc=this.Tse=!1;this.Aye=this.yAe=this.AAe=this.zAe=null;this.la=a;u.AFrameworkApplication.fa.jf(Object(F.a)(this,this.Om,"onFullAppSettingsReady"));a=dd.b(u.AFrameworkApplication.fa.appSettings.SessionStartInfoJson.toString());this.tqg=a.Ring||"Unknown";this.Pqg=u.AFrameworkApplication.buildVersion||"Unknown";this.qEg=this.la.rJa||
"Unknown";this.BWg=a.Host||"Unknown";this.AWg=a.WACDatacenter||"Unknown";this.ETg=this.z6i();this.ohc=this.C6i();this.AVg=this.XTc();this.GBb=hu.z3e;switch(this.la.Orl){case "ByUIHostName":a=u.AFrameworkApplication.fa.Ha(u.AFrameworkApplication.YJ);this.Acb=!(!a||"teams"!==a.toLowerCase());break;case "ByAppIsEmmbeded":this.Acb=u.AFrameworkApplication.isEmbedded;break;default:this.Acb=u.AFrameworkApplication.fa.ka("IsUIEmbedMode")}Ba.a.J(40977669,822,50,"Initialized SubtitleContext with cookie: {0}, default position:{1}",
this.GBb,this.xAe)}Om(){this.bFb=this.getUserId();this.ZX=u.AFrameworkApplication.fa.Ha("TenantId");this.QBb=this.la.hostAuthType||u.AFrameworkApplication.fa.Ha("HostAuthType")||"Unknown"}getUserId(){let a=u.AFrameworkApplication.fa.Ha("PptEditingUserId");ta.a.Wa(a)&&(a=u.AFrameworkApplication.fa.Ha("LoggableUserId"),Ba.a.J(593793674,822,50,"GetUserId PptEditingUserId is empty. LoggableUserId is null or empty {0}",ta.a.Wa(a)));return a}get b3b(){return this.hvg}set b3b(a){Ba.a.J(40407360,830,50,"SubtitleContext: Update FEnabledInBaseDoc to {0}",
a);this.hvg=a}get Kh(){return this.la.Pka&&this.b3b&&this.GBb&&!this.Acb}set Kh(a){this.GBb!==a&&(this.GBb=a,hu.z3e=this.GBb)}get a3b(){return this.la.Pka&&this.vcc}set a3b(a){this.vcc!==a&&(this.vcc=a)}get CSf(){return this.Jvg}get jSf(){return!this.Acb}get Wub(){return this.Tse}set Wub(a){this.Tse!==a&&(this.Tse=a)}get Pub(){return this.la.Pka&&this.b3b&&this.la.BUj&&!this.Acb}get hSf(){const a=oi.a.get("PPTLiveSubtitleEnabled");return this.la.Pka&&this.la.GUj&&ta.a.Wa(a)&&!this.Acb}get cZe(){if(!this.yAe){const b=
new Qa.a;var a=this.la.oah;if(!ta.a.Wa(a)){a=a.split(",");for(const c of a)c.endsWith("*")||b.add(c)}this.yAe=hu.Ttf(b)}return this.yAe}get bZe(){if(!this.Aye){const b=new Qa.a;var a=this.la.oah;if(!ta.a.Wa(a)){a=a.split(",");for(const c of a)c.endsWith("*")&&b.add(c.replace("*"," ").trim())}this.Aye=hu.Ttf(b)}return this.Aye}get QMb(){this.zAe||(this.zAe=ta.a.Wa(this.la.pah)?{}:Sys.Serialization.JavaScriptSerializer.deserialize(this.la.pah,!0));return this.zAe}get OXe(){this.AAe||(this.AAe=hu.lci(this.QMb));
return this.AAe}I0k(){this.e4c=this.GBb?1:0}ZYk(){-1!==this.e4c&&(this.Kh=1===this.e4c?!0:!1,this.e4c=-1)}z6i(){try{const a=Fa.a.ue(u.AFrameworkApplication.lcid);if(!a)return Ba.a.J(41158484,822,15,"SubtitleContext::GetDefaultSpeechLanguage Getting the culture info returned null. Language lcid: {0}: ",u.AFrameworkApplication.lcid),"en-us";const b=a.name.toLowerCase();for(let c of this.cZe)if(0<=c.toLowerCase().indexOf(b.toLowerCase()))return b;for(let c of this.bZe)if(0<=c.toLowerCase().indexOf(b.toLowerCase()))return b;
this.vcc=!0;return"en-us"}catch(a){Ba.a.J(41158486,822,10,"SubtitleContext::GetDefaultSpeechLanguage Exception thrown when trying to get the culture info for language lcid: {0}, exception: {1}.",u.AFrameworkApplication.lcid,a)}this.vcc=!0;return"en-us"}C6i(){try{const a=Fa.a.ue(u.AFrameworkApplication.lcid);if(!a||ta.a.Wa(a.name))return Ba.a.J(41158488,822,15,"SubtitleContext::GetDefaultTranslationLanguage Getting the culture info or culture info name returned null. Language lcid: {0}: ",u.AFrameworkApplication.lcid),
"en";const b=a.name.toLowerCase();if(!ta.a.Wa(b)&&this.QMb[b])return b;const c=Fa.a.ue(a.languageId);if(!c||ta.a.Wa(c.name))return Ba.a.J(41158490,822,15,"SubtitleContext::GetDefaultTranslationLanguage Getting the two-letter culture info returned null. Language lcid: {0}: ",u.AFrameworkApplication.lcid),"en";let h=c.name.toLowerCase();this.QMb[h]||(Ba.a.J(41972259,822,15,"SubtitleContext::GetDefaultTranslationLanguage No matching default language was found for the user's locale. Will default to English. User's culture info name: {0} User's culture info two letter name: {1} Language lcid: {2}: ",
b,h,u.AFrameworkApplication.lcid),h="en");return h}catch(a){Ba.a.J(41158492,822,10,"SubtitleContext::GetDefaultTranslationLanguage Exception thrown when trying to get the culture info for language lcid: {0}, exception: {1}.",u.AFrameworkApplication.lcid,a)}return"en"}XTc(){try{if(ta.a.Wa(this.ohc))return Ba.a.J(41972290,822,10,"SubtitleContext::GetValueForTranslationLanguage m_translationLanguages is null. Language lcid: {0}",u.AFrameworkApplication.lcid),"en-us";const a=this.QMb[this.ohc.toLowerCase()];
if(!ta.a.Wa(a))return a}catch(a){Ba.a.J(41972292,822,10,"SubtitleContext::GetValueForTranslationLanguage Exception thrown when trying to get the value for key: {0} language lcid: {1}, exception: {2}.",this.ohc,u.AFrameworkApplication.lcid,a)}return"en-us"}W3i(a){if(ta.a.Wa(a))return Ba.a.J(595140824,822,10,"SubtitleContext::GetClosestTranslationLanguageFromSpeechLanguage Null or empty speech language code passed in."),null;var b=a.split("-");if(!b.length)return Ba.a.J(595140822,822,10,"SubtitleContext::GetClosestTranslationLanguageFromSpeechLanguage Incorrect speech language code passed in: {0}.",
a),null;b=b[0];const c=this.QMb;var h=this.OXe;for(let m of h)if(h=c[m.toLowerCase()],h.startsWith(b))return h;Ba.a.J(595140820,822,10,"SubtitleContext::GetClosestTranslationLanguageFromSpeechLanguage No matching translation language code found for speech language code: {0}.",a);return null}get Eoa(){return this.ETg}set Eoa(a){this.ETg=a;this.Jvg=!0}get userId(){return this.bFb}set userId(a){this.bFb=a}get locale(){return this.qEg}set locale(a){this.qEg=a}get audienceGroup(){return this.tqg}set audienceGroup(a){this.tqg=
a}get buildVersion(){return this.Pqg}set buildVersion(a){this.Pqg=a}get identityProvider(){return this.QBb}set identityProvider(a){this.QBb=a}get wacHost(){return this.BWg}set wacHost(a){this.BWg=a}get wacDatacenter(){return this.AWg}set wacDatacenter(a){this.AWg=a}get tenantId(){return this.ZX}set tenantId(a){this.ZX=a}get hza(){return this.ohc}set hza(a){this.ohc=a}get clb(){return this.AVg}set clb(a){this.AVg=a}get Ov(){return this.xAe}set Ov(a){this.xAe=a}get rml(){const a={};a.UserId=this.userId;
a.TenantId=this.tenantId;a.AudienceGroup=this.audienceGroup;a.BuildVersion=this.buildVersion;a.IdentityProvider=this.identityProvider;a.Locale=this.locale;a.WacHost=this.wacHost;a.WacDatacenter=this.wacDatacenter;a.SubtitlesPosition=this.Ov;a.SpeechLanguage=this.Eoa;a.TranslationLanguages=this.clb;a.FUseSubtitles=this.Kh;return JSON.stringify(a)}get kDa(){return this.Icc}set kDa(a){this.Icc=a}get RTi(){return 0<=this.la.pptEditorTranscribeRTLTranslationLanguages.indexOf(this.hza)}static get z3e(){const a=
oi.a.get("PPTLiveSubtitleEnabled");return a?"true"===a.toLowerCase():!1}static set z3e(a){oi.a.SJ("PPTLiveSubtitleEnabled",a.toString(),oi.a.wJ)||Ba.a.J(40977672,822,10,"Failed to set cookie for use live subtitle to {0}",a.toString())}static Ttf(a){const b={},c=new Qa.a;for(let h of a)try{const m=Fa.a.ue(h).displayName;c.add(m);b[m]=h}catch(m){Ba.a.J(40423770,822,10,"SubtitleContext::AlphabetizeSpokenLanguagesByLocale Exception when trying to show language: {0}, e: {1}.",h,m)}c.Sc((h,m)=>h.localeCompare(m));
a=new Qa.a;for(let h of c)h&&0<h.length&&a.add(b[h]);return a}static lci(a){const b=Da.a.fL(a);a={};const c=new Qa.a;for(var h of b)try{const m=Fa.a.ue(h).displayName;ta.a.Wa(m)?Ba.a.J(41972252,822,10,"SubtitleContext::AlphabetizeSubtitleLanguagesByLocale Couldn't get display name for language code: {0}, language lcid: {1}.",h,u.AFrameworkApplication.lcid):(c.add(m),a[m]=h)}catch(m){Ba.a.J(40423772,822,10,"SubtitleContext::AlphabetizeSubtitleLanguagesByLocale Exception when trying to show language: {0}, e: {1}.",
h,m)}c.Sc((m,y)=>m.localeCompare(y));h=new Qa.a;for(let m of c)m&&0<m.length&&h.add(a[m]);return h}}Object(n.a)(hu,"SubtitleContext",null,[533]);const XC=()=>{var a=window.navigator.userAgent.toLowerCase();(a=-1!==a.indexOf("windows nt 6.3")&&-1!==a.indexOf("rv:11.0"))||(a=window.navigator.userAgent.toLowerCase(),-1!==a.indexOf("windows")?(a=CJ(a,"msie (\\d+)"),a=!isNaN(a)&&10>=a):a=!1);a||(a=window.navigator.userAgent.toLowerCase(),-1!==a.indexOf("iphone")||-1!==a.indexOf("ipad")||-1!==a.indexOf("ipod")?
(a=CJ(a,"os (\\d+)_"),a=!isNaN(a)&&9>=a):a=!1);if(a||-1!==window.navigator.userAgent.indexOf("Windows NT 6.3; ARM"))return!1;try{const b=document.createElement("canvas");if(window.self.WebGLRenderingContext&&(b.getContext("webgl")||b.getContext("experimental-webgl")))return!0}catch(b){}return!1},CJ=(a,b)=>(a=(new RegExp(b)).exec(a))&&2<=a.length?parseInt(a[1]):Number.NaN;class DJ{constructor(a){this.No=a}yii(){return XC()}xii(){let a=!1;const b=this.yii();if(b&&!this.No.YN(1))try{const c=document.createElement("canvas"),
h=c.getContext("2d");if(h){const m=new Image;m.src="data:image/svg+xml;charset=utf8,%3Csvg xmlns='http://www.w3.org/2000/svg'%3E%3C/svg%3E";h.drawImage(m,0,0,10,10);c.toDataURL("image/png");a=!0}}catch(c){}Ba.a.J(33595541,830,50,"IsRenderingSVGInWebGLSupported - {0}",{["Browser"]:this.No.Ly,["SupportWebGL"]:b,["SupportSVGInWebGL"]:a});return a}}Object(n.a)(DJ,"WebGLHelperProxy",null,[532]);var EJ=d(638),bQ=d(722);class YC{constructor(){this.la=this.qb=this.K=null}get name(){return"PowerPointWebEditor.SlideShow"}$b(a){this.K=
a;const b=this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame");this.qb=b.AF();this.la=this.K.resolve("PowerPointWebEditor.IApplicationSettings");this.K.register(531,"PowerPointWebEditor.IFullscreenHelper").ma().oa(()=>new tJ);this.K.register(532,"PowerPointWebEditor.IWebGLHelper").ma().oa(()=>new DJ(this.K.resolve("Common.IBrowserUtils")));this.K.register(533,"PowerPointWebEditor.ISubtitleContext").ma().oa(()=>new hu(this.la));this.K.register(534,"PowerPointWebEditor.IRehearsalContext").ma().oa(()=>
new wz);this.Cac({["Type"]:"CheckBrowserStart"});a={};var c=this.xIj(a);const h=XC()&&this.la.FUa&&c&&this.wIj(),m=this.la.FUa&&this.vIj(),y=!h&&m;this.Cac({["Type"]:"CheckBrowserEnd",["IsSupportedBrowser"]:h||m,["IsModernWebGLSupportedBrowser"]:h,["IsModernSupportedBrowser"]:m,["IsBrowserShapeBuilderCompatible"]:c,["log"]:a,["useSvg"]:y});if(this.la.ka("DefaultToModernSlideShow")&&(h||m)){this.K.register(535,"PowerPointWebEditor.ISlideshowFrame").ma().oa(()=>new bQ.SlideShowCoreFrame(this.qb,this.la,
this.K.resolve("PowerPointWebEditor.ISubtitleContext"),this.K.resolve("Common.IDynamicScriptLoaderProvider").Pw,this.K.Ja("PowerPointWebEditor.ISlideShowVoiceNotification"),this.K.Ja("PowerPointLive.ILivePresenter"),this.K.resolve("PowerPointWebEditor.IFullscreenHelper"),this.K.resolve("PowerPointWebEditor.Core.IAudioSettingsContext"),y,this.K.resolve("PowerPoint.IPathManager"),this.K.Ja("Common.App.HostNotification.EditNotificationEventSource"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventSource"),
this.K.resolve("PowerPointWebEditor.ISessionInfoOwner").podSessionId,u.AFrameworkApplication.Je));const va={};va.loadScriptStart=Date.now();a=QC.a.create(u.AFrameworkApplication.Pj("powerpoint-slideshow-strings",3));Jk.a.Wx(a);Promise.all([new Promise((Ta,fb)=>{const Db=document.createElement("script");Db.async=!1;Db.src=u.AFrameworkApplication.Pj(String.format("slideshowcore{0}.js",".min"),5);Db.addEventListener("load",()=>{Ba.a.J(509636759,830,50,"Loaded slideshowcore");Ta(Db)});Db.addEventListener("error",
()=>{Ba.a.J(509636758,830,50,"Failed to load slideshowcore");fb(Db)});document.head.appendChild(Db)}),new Promise((Ta,fb)=>{const Db=document.createElement("script");Db.async=!1;Db.src=u.AFrameworkApplication.Pj(String.format("podsproxy{0}.js",".min"),5);Db.addEventListener("load",()=>{Ba.a.J(509636757,830,50,"Loaded podsproxy");Ta(Db)});Db.addEventListener("error",()=>{Ba.a.J(509636756,830,50,"Failed to load podsproxy");fb(Db)});document.head.appendChild(Db)}),new Promise((Ta,fb)=>{const Db=document.createElement("script");
Db.async=!1;Db.src=u.AFrameworkApplication.Pj(String.format("pptspeechclient{0}.js",".min"),5);Db.addEventListener("load",()=>{Ba.a.J(509636755,830,50,"Loaded pptspeechclient");Ta(Db)});Db.addEventListener("error",()=>{Ba.a.J(509636754,830,50,"Failed to load pptspeechclient");fb(Db)});document.head.appendChild(Db)})]).then(()=>{va.loadScriptEnd=Date.now();const Ta={Type:"LoadedJS"};Da.a.forEach(va,(fb,Db)=>{Ta[fb]=Db},null);this.Cac(Ta);this.K.resolve("PowerPointWebEditor.ISlideshowManager").svg||
(Ba.a.J(509636753,830,50,"Initializing SlideShowCoreFrame on package registration"),this.K.resolve("PowerPointWebEditor.ISlideshowFrame").preloadShaders(),this.K.resolve("PowerPointWebEditor.ISlideshowFrame").init(u.AFrameworkApplication.buildVersion,this.K.resolve("PowerPointWebEditor.ISessionInfoOwner").nk,u.AFrameworkApplication.userSessionId,this.K.resolve("PowerPointWebEditor.ISessionInfoOwner").podSessionId),this.K.resolve("PowerPointWebEditor.ISlideshowManager").z7k());return null}).catch(Ta=>
{this.Cac({["Type"]:"Error",["Reason"]:"FailedDownloadingResources"});Ba.a.J(512309318,830,10,"LoadSlideShowResources Failed to load the resources for SlideShowCore: {0}",Ta)})}else this.la.ka("DefaultToModernSlideShow")?this.Cac({["Type"]:"Fallback",["Reason"]:"UnSupportedBrowser"}):Ba.a.J(512309319,830,50,"PptDefaultToModernSlideShow is disabled"),this.K.register(535,"PowerPointWebEditor.ISlideshowFrame").ma().oa(()=>new aQ.SlideshowFrame(this.K.resolve("PowerPointWebEditor.IWebGLHelper"),this.qb,
this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.ISubtitleContext"),this.K.Ja("PowerPointLive.ILivePresenter"),this.K.resolve("PowerPointWebEditor.Core.IAudioSettingsContext"),this.K.Ja("PowerPointWebEditor.ISlideShowVoiceNotification"),this.K.resolve("Common.IDynamicScriptLoaderProvider").Pw));this.K.register(TC,"PowerPointWebEditor.SlideShowFooterContainer").oa(()=>new TC(this.qb,u.AFrameworkApplication.Ta));this.K.resolve("PowerPointWebEditor.SlideShowFooterContainer").vb();
let G;if(!this.la.t9b||this.la.zah)this.K.register(WC,"PowerPointWebEditor.SlideshowToolbar").as("PowerPointWebEditor.ISlideshowToolbar").ma().oa(()=>new WC(u.AFrameworkApplication.Ta,this.la,this.K.resolve("PowerPointWebEditor.ISlideshowFrame"),this.K.resolve("PowerPoint.IPathManager"),this.K.resolve("PowerPointWebEditor.View.IViewEventNotifier"),this.K.Ja("PowerPointLive.ILivePresenter"),this.qb,()=>u.AFrameworkApplication.isRtl,this.la.podsWebServiceBase,this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),
this.K.resolve("PowerPointWebEditor.IFullscreenHelper"))),this.K.resolve("PowerPointWebEditor.ISlideshowToolbar");else{a=Uy.a(this.K);c=new Qa.a;c.add(a("slideshowToolbar"));this.la.LCk&&c.add(a("uiFabricLazy"));Promise.all(c.toArray()).catch(Ta=>Ba.a.J(50907106,830,10,"Failed to load the resources for the slideshowToolbar feature: {0}",Ta)).then(()=>this.utk()).catch(Ta=>Ba.a.J(50907136,830,10,"Failed to load the React slideshowToolbar: {0}",Ta));this.la.isInkUIInSlideShowEnabled&&(a("inkButton").catch(Ta=>
Ba.a.J(51218050,830,10,"Failed to load the resources for the ink button feature: {0}",Ta)).then(()=>this.Apk()).catch(Ta=>Ba.a.J(51218052,830,10,"Failed to load the React ink button: {0}",Ta)),this.K.register(536,"PowerPointWebEditor.IInkButtonHelper").ma().oa(()=>new uJ));if(this.la.pptEditorVoiceUXEnabled){const Ta=this;a("voiceUI").catch(fb=>Ba.a.J(595198419,830,10,"Failed to load the resources for the voice UI feature: {0}",fb)).then(()=>Ta.vtk()).catch(fb=>Ba.a.J(595198417,830,10,"Failed to load the voice UI script: {0}",
fb));this.K.register(537,"PowerPointWebEditor.ISlideShowVoiceNotification").ma().oa(()=>new AJ)}const va=this;this.K.register(SC,"PowerPointWebEditor.ReactSlideshowToolbar").as("PowerPointWebEditor.ISlideshowToolbar").ma().oa(()=>new SC(u.AFrameworkApplication.Ta,va.la,va.K.resolve("PowerPointWebEditor.ISlideshowFrame"),va.K.resolve("PowerPoint.IPathManager"),va.K.resolve("PowerPointWebEditor.View.IViewEventNotifier"),va.K.Ja("PowerPointLive.ILivePresenter"),va.qb,()=>u.AFrameworkApplication.isRtl,
va.la.podsWebServiceBase,va.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),va.K.resolve("PowerPointWebEditor.IFullscreenHelper")))}G=this.K.Ja("PowerPointWebEditor.ISlideshowToolbar");const U=this;this.K.register(VC,"PowerPointWebEditor.SlideshowContextMenu").oa(()=>new VC(U.K.resolve("PowerPointWebEditor.ISlideshowFrame"),U.K.resolve("PowerPointWebEditor.IPresentationReader"),U.K.resolve("PowerPointWebEditor.IInputHandlerManager"),u.AFrameworkApplication.Ta,U.K.resolve("PowerPointWebEditor.View.IViewEventNotifier"),
U.qb,()=>u.AFrameworkApplication.isRtl,U.K.resolve("PowerPointWebEditor.IFullscreenHelper"),U.K.Ja("PowerPointLive.ILivePresenter")));const ja=this;this.K.register(538,"PowerPointWebEditor.ISlideshowManager").ma().oa(()=>new BJ(ja.K.resolve("PowerPointWebEditor.IFullscreenHelper"),ja.K.resolve("PowerPointWebEditor.ISlideshowFrame"),G,ja.K.resolve("PowerPointWebEditor.SlideshowContextMenu"),ja.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),u.AFrameworkApplication.Je,ja.la,b,ja.K.resolve("PowerPointWebEditor.IPresentationReader"),
ja.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),ja.K.resolve("PowerPointWebEditor.Core.IPodsPopsEventHandler"),ja.K.resolve("PowerPointWebEditor.IErrorHandler"),vb.a.instance.resolve("PowerPointWebEditor.ISlideCacheManager"),ja.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),ja.K.resolve("PowerPointWebEditor.IZoomContentFetcher"),af.a.Uu(vb.a.instance.Ja("Common.ISystemInitiatedFeedback")),u.AFrameworkApplication.Ta,vb.a.instance.Ja("PowerPointLive.ILivePresenter"),ja.K.resolve("PowerPointWebEditor.SlideShowFooterContainer"),
ja.K.Ja("PowerPointWebEditor.ISlideShowVoiceNotification")))}Cac(a){Ba.a.J(594583632,830,15,JSON.stringify(a))}wIj(){const a=this.la.Ha("PptModernSlideShowWebGLBlockListForBrowserVersion").split(";"),b=JSON.parse(this.la.Ha("SessionStartInfoJson").toString());Ba.a.J(512309317,830,50,"IsBrowserModernWebGLCompatible Browser:{0}, BrowserMajorVersion:{1}",b.Browser,b.BrowserMajorVersion);for(const c of a)if(c.split(":")[0].toLowerCase()===(b.Browser||"").toLowerCase()&&parseInt(b.BrowserMajorVersion||
"",10)<parseInt(c.split(":")[1],10))return Ba.a.J(512309316,830,50,"IsBrowserModernWebGLCompatible Name {0}, Version {1}",b.Browser,b.BrowserMajorVersion),!1;return!0}vIj(){const a=this.la.Ha("PptModernSlideShowBlockListForBrowserVersion").split(";"),b=JSON.parse(this.la.Ha("SessionStartInfoJson").toString());Ba.a.J(512309315,830,50,"IsBrowserModernCompatible Browser:{0}, BrowserMajorVersion:{1}",b.Browser,b.BrowserMajorVersion);for(const c of a)if(c.split(":")[0].toLowerCase()===(b.Browser||"").toLowerCase()&&
parseInt(b.BrowserMajorVersion||"",10)<parseInt(c.split(":")[1],10))return Ba.a.J(512309314,830,50,"IsBrowserModernCompatible Name {0}, Version {1}",b.Browser,b.BrowserMajorVersion),!1;return!0}xIj(a){return EJ.a(a)}init(){this.K.resolve("Common.IAppSettingsManager").jf(Object(F.a)(this,this.Om,"onFullAppSettingsReady"))}Om(){Ja.a.get_instance().Dk(10,null).continueWith(()=>{if(!this.la.tT&&this.la.vah&&this.la.cEk)try{af.a.Uu(vb.a.instance.Ja("Common.ISystemInitiatedFeedback")).continueWith(a=>{a.result.logActivity("HasPresentButtonSeen",
"PresentTeachingUIEnabled")}),Ba.a.J(512495957,830,50,"Present Teaching UI triggered")}catch(a){Ba.a.J(512495956,830,10,"Exception thrown when trying to trigger Present teaching UI. Exception: {0}",a)}})}utk(){this.K.resolve("PowerPointWebEditor.ISlideshowToolbar");return null}Apk(){this.K.resolve("PowerPointWebEditor.IInkButtonHelper");return null}vtk(){this.K.resolve("PowerPointWebEditor.ISlideShowVoiceNotification");return null}dispose(){}static main(){r.a.instance.Dc(new YC)}}Object(n.a)(YC,"PPTWebEditorSlideShowPackage",
null,[2,3]);var cQ=d(770);class FJ{constructor(){this.gcc=null}vfl(a,b){fj.UISurfaces.CN().then(c=>{this.gcc=a.eMi(c,a.sEi(b),b,this.gcc)});Ba.a.J(527303443,843,50,"{0} Toast is displayed",Object.getType(a).toString())}GRk(a){fj.UISurfaces.CN().then(b=>{this.gcc=a.vRk(b,this.gcc)});Ba.a.J(523871965,843,50,"{0} Toast is removed",this.gcc)}}Object(n.a)(FJ,"DeferredNotificationCalloutVisibilityManager",null,[]);var GJ=d(1011);const dQ=a=>{const b={featureArea:"Partial Presentation"};b.sourceContext=
a;a={};a.telemetryGroup=b;return a},eQ=(a,b,c,h)=>{const m=new Rf.StandardDialog;m.xd=0;if(u.AFrameworkApplication.OE){const y=dQ(b);m.jNd(ResourceStrings.L_GiveFeedback,void 0,void 0,y)}m.Bx(c,h,0,a?y=>{1===y?(Ba.a.J(526989467,830,50,"User selected Present Anyway in {0}",b),a()):Ba.a.J(526989468,830,50,"User selected Cancel in {0}",b)}:null)};class ZC{constructor(a,b,c,h,m,y,G){this.s9={};this.kwa=new Nd.a;this.P8c=this.Bye=null;this.r7c=this.Pwe=0;this.jvg=!1;this.d6j=Rd.a("PartialDoc.SkipCheckGraphForPresentationDeferred");
this.b$c={};if(!G)throw Error.argumentNull("coreEventSource");this.cM=a;this.Eq=c;this.cM.ik(Object(F.a)(this,this.B5g,"onShapeNodePropertyChanged"));this.cM.mia(Object(F.a)(this,this.Kjc,"onShapeNodeLoaded"));this.cM.kia(Object(F.a)(this,this.A5g,"onShapeNodeConnected"));this.Csg=new FJ;this.mh=m;b.RNd(Object(F.a)(this,this.lFe,"onClientError"));b.nOd(Object(F.a)(this,this.UGe,"onServerError"));u.AFrameworkApplication.FFc(Object(F.a)(this,this.IFe,"onErrorDialogDisplayed"));this.Rtg=h;this.Bla=y;
this.Zh=G;this.Zh.WB(Object(F.a)(this,this.q5g,"onSessionRehydratedHandler"))}Irf(a,b){this.kwa.Hb(a)||this.kwa.$(a,new Ea.a);const c=this.kwa.ga(a);c.add(b);this.kwa.$(a,c)}Sgh(a,b){if(this.kwa.Hb(a)){var c=this.kwa.ga(a);c.remove(b);this.kwa.$(a,c);this.tae(a)||this.kwa.remove(a);rq.a(this.s9).length||Ba.a.J(520927263,843,50,"DeferredContentManager::RemoveFromSlideDeferredInfo - no more deferred content in document")}else Ba.a.J(524321747,843,15,"DeferredContentManager::RemoveFromSlideDeferredInfo - no deferred content on slideId:{0} shapeNodeId:{1}",
a,b)}tae(a){return this.kwa.Hb(a)&&0<this.kwa.ga(a).count}kCf(a){if(a.slideId&&a.slideId.sid&&a.d1c){var b=a.d1c;a.L3?(this.jvg||(this.jvg=!0,Ba.a.J(555836314,843,50,"DeferredContentManager - deferred content detected: FForceShowDeferralUI: {0}",this.Bla)),b in this.s9||(this.s9[b]=new Date),this.Irf(a.slideId.sid.toString(),b)):b in this.s9&&(delete this.s9[b],this.Sgh(a.slideId.sid.toString(),b),Ba.a.J(520927262,843,15,"DeferredContentManager - Rehydration scenario, Node already in deferred list on load/connect."))}}Kjc(a,
b){(a=Object(ua.a)(4,b.node))?this.kCf(a):Ba.a.J(557126034,843,10,"IDeferrable object is null")}A5g(a,b){(a=Object(ua.a)(4,b.node))?this.kCf(a):Ba.a.J(557126035,843,10,"IDeferrable object is null")}B5g(a,b){var c=Object(ua.a)(4,b.node);if(!c)Ba.a.J(557126873,843,10,"IDeferrable object is null");else if((b.property===X.a.L3||this.Bla&&c.d1c in this.s9&&!c.L3)&&c.slideId)if(b=c.d1c,a=c.slideId.sid.toString(),c.L3)b in this.s9?Ba.a.J(557164308,843,15,"ShapeNode is already deferred:{0}, FForceShowDeferralUI: {1}",
b,this.Bla):(Ba.a.J(527720478,843,50,"ShapeNode is deferred:{0}, FForceShowDeferralUI: {1}",b,this.Bla),this.s9[b]=new Date,this.Irf(a,b));else{if(c=this.s9[b])c=(new Date).getTime()-c.getTime(),Ba.a.J(557164309,843,50,"ShapeNode:{0}, DeferredDurationMS:{1}, FForceShowDeferralUI:{2}",b,c,this.Bla),delete this.s9[b],this.Sgh(a,b),this.r7c=c>this.r7c?c:this.r7c;this.Rtg&&!this.hasDeferredContent()&&(Ba.a.J(520471008,843,50,"All deferred blobs loaded"),this.bra("AllDeferredBlobsLoaded","true"),this.P8c&&
(Ba.a.J(520471007,843,50,"Previously called user requested actions triggered"),this.bra("PreviouslyDeferredActionsTriggeredOnBlobsLoad","true"),this.P8c(),this.Csg.GRk(this.Bye),this.Bye=this.P8c=null))}}q5g(){Ba.a.J(520722338,843,50,"Session rehydrated with {0} currently deferred blobs",rq.a(this.s9).length)}qWe(a,b,c){this.Rtg?(this.Bye=b,this.P8c=c,this.Csg.vfl(b,this.mh)):(c=Object(za.a)(GJ.a,b)?ResourceStrings.l_DeferredContentDownloadACopyWaitDialogTitle:ResourceStrings.l_DeferredContentWaitDialogTitle,
b=Object(za.a)(GJ.a,b)?ResourceStrings.l_DeferredContentDownloadACopyWaitDialogMessage:ResourceStrings.l_DeferredContentWaitDialogMessage,eQ(null,a.toString(),c,b));Ba.a.J(526989469,801,100,"ShowDeferredContentWaitUI shown for :{0}",a)}bra(a,b){this.b$c[a]&&Ba.a.J(522269249,843,15,"DeferredContentManager - This action has been requested before. Key: {0}, Value: {1}",a,this.b$c[a]);this.b$c[a]=b}lFe(a,b){this.Hna("ClientError",b)}UGe(a,b){this.Hna("ServerError",b)}IFe(a,b){(a=Object(ua.a)(cQ.a,b))&&
this.Hna("Crash",a.errorCode)}Hna(a,b){this.hasDeferredContent()&&Ba.a.J(556364418,843,15,"DeferredContentManager - Error while there is deferred content: ErrorType:{0}, ErrorInfo:{1}, FForceShowDeferralUI:{2}",a,b,this.Bla)}dispose(){this.cM.Cm(Object(F.a)(this,this.B5g,"onShapeNodePropertyChanged"));this.cM.OZa(Object(F.a)(this,this.Kjc,"onShapeNodeLoaded"));this.cM.Vna(Object(F.a)(this,this.A5g,"onShapeNodeConnected"));this.Zh.Dfa(Object(F.a)(this,this.q5g,"onSessionRehydratedHandler"));this.log()}hasDeferredContent(){const a=
rq.a(this.s9),b=(!this.d6j||this.Bla)&&0<a.length||0<this.Eq.u7a;if(b){const c={};c.DeferredNodeCount=a.length.toString();c.DeferredBlobCount=this.Eq.u7a.toString();c.FForceShowDeferralUI=this.Bla.toString();Ba.a.J(521175389,843,50,JSON.stringify(c));this.Pwe=Math.max(this.Eq.u7a,this.Pwe)}return b}cwj(a){return Ma.a.any(a,b=>b.hasDeferredContent)?(Ba.a.J(556312344,843,50,"{0} DeferredSlideCount: {1}, FForceShowDeferralUI: {2}","CutCopySlides",a.length,this.Bla),!0):!1}sae(a,b){return Ma.a.any(a,
c=>c.L3)?(Ba.a.J(556312348,843,50,"{0} DeferredShapeCount: {1}, FForceShowDeferralUI: {2}",b,a.length,this.Bla),!0):!1}log(){const a=rq.a(this.s9),b={};b.MaxDeferredTime=this.r7c.toString();b.DeferredCountOnClose=a.length.toString();b.MaxNumberOfDeferredBlobs=this.Pwe.toString();b.FForceShowDeferralUI=this.Bla.toString();Ba.a.J(556364419,843,15,"SessionLogs: {0}, PersistedLogs: {1}",JSON.stringify(b),JSON.stringify(this.b$c))}}Object(n.a)(ZC,"DeferredContentManager",null,[571]);class $C{constructor(){this.vw=
this.K=null}get name(){return"PowerPointWebEditor.PartialDoc"}$b(a){this.K=a;this.K.register(ZC,"PowerPointWebEditor.DeferredContentManager").as("PowerPointWebEditor.IDeferredContentManager").ma().oa(()=>new ZC(this.K.resolve("Box4.Graph.IGraphInstance").Ad(10),this.K.resolve("PowerPointWebEditor.IErrorHandler"),this.K.resolve("PowerPointWebEditor.ICoauthStateSetter"),this.K.resolve("Common.IAppSettingsManager").ka("UseToastForDeferredBlobsEnabled"),this.K.resolve("Common.IF6Manager"),0<this.K.resolve("Common.IAppSettingsManager").Fc("ForceShowDeferralUIMS",
0),this.K.resolve("PowerPointWebEditor.Core.ICoreEventSource")))}init(){this.vw=this.K.resolve("PowerPointWebEditor.IDeferredContentManager")}dispose(){this.vw&&this.vw.dispose()}static main(){r.a.instance.Dc(new $C)}}Object(n.a)($C,"PPTWebEditorPartialDocPackage",null,[2,3]);class Bv{constructor(a,b){this.shapeNode=a;this.position=b}}Object(n.a)(Bv,"MoveShapeData",null,[]);class HJ{constructor(a,b){this.xO=null;this.qp=a;this.ia=b}start(){this.xO=[];for(let a=0;a<this.qp.length;++a)Array.add(this.xO,
new ad.a(this.qp[a].x,this.qp[a].y)),this.qp[a].OD(!1)}ESd(a,b){if(1!==a||this.qp.length!==b.length)return!1;for(a=0;a<b.length;a++)if(!this.IKj(b[a]))return!1;return!0}IKj(a){for(let b=0;b<this.qp.length;b++)if(a.gb.equals(this.qp[b].gb))return!0;return!1}perform(a){for(let c=0;c<this.qp.length;c++){var b=new ad.a(this.qp[c].x,this.qp[c].y);b=ad.a.add(b,a);this.qp[c].setPosition(b.x,b.y,!0)}}end(){this.xO&&Ba.a.J(17597603,815,50,"ShapeKeyboardDragManager::ShapeMoveAction - moving {0} shapes by ( {1}, {2} )",
this.qp.length,this.qp[0].x-this.xO[0].x,this.qp[0].y-this.xO[0].y);const a=[];for(let b=0;b<this.qp.length;++b){const c=this.qp[b].OQc();Array.add(a,new Bv(this.qp[b].shapeNode,c));this.qp[b].Oz(!1)}this.ia.La(M.a.BIa,2,a)}}Object(n.a)(HJ,"ShapeMoveAction",null,[1199]);class yz{constructor(a,b,c=null,h=null){this.p1=a;this.b1=b;this.$1b=c;this.dZg=h}}Object(n.a)(yz,"ResizeShapeData",null,[]);class IJ{constructor(a,b){this.WFa=this.TAb=this.oAe=null;this.YF=a;this.ia=b}start(){this.oAe=[];this.TAb=
[];this.WFa=[];for(const c of this.YF){c.uL=!0;c.OD(!1);Array.add(this.oAe,c.vYa);Array.add(this.TAb,new yi.a);var a=c.Gvb(),b=ad.a.lm(a.qk(ke.a.Ku),a.qk(ke.a.yE));a=ad.a.lm(a.qk(ke.a.Ku),a.qk(ke.a.IH));Array.add(this.WFa,a?b/a:1);c.shapeNode.Jf&&c.shapeNode.isEditable&&(b=c,b.Ok&&(b.Ok.visible=!0))}}ESd(a,b){if(2!==a)return!1;for(a=0;a<b.length;a++)if(b[a].Al||!b[a].gb.equals(this.YF[a].gb))return!1;return!0}perform(a,b){for(let h=0;h<this.YF.length;h++){var c=a;let m=b;({deltaX:c,deltaY:m}=this.Xxl(c,
m,h));let y;(y=this.TAb[h]).right=y.right+c;let G;(G=this.TAb[h]).bottom=G.bottom+m;this.YF[h].setOffsets(yi.a.add(this.oAe[h],this.TAb[h]),!0);this.YF[h].shapeNode.Jf&&this.YF[h].shapeNode.isEditable&&(c=this.YF[h],c.Xae(),c.tVc())}}Xxl(a,b,c){if(!this.YF[c].shapeNode.isAspectRatioLocked)return{deltaX:a,deltaY:b};b?a=b*this.WFa[c]:b=a/this.WFa[c];return{deltaX:a,deltaY:b}}end(){const a=[];for(let b=0;b<this.YF.length;b++)this.YF[b].Al||(this.YF[b].shapeNode.Jf&&this.YF[b].shapeNode.isEditable||(this.YF[b].uL=
!1),this.YF[b].Oz(!1),Array.add(a,new yz(this.YF[b].shapeNode,this.TAb[b])));this.ia.La(M.a.vib,2,a);this.YF=null}}Object(n.a)(IJ,"ShapeResizeAction",null,[1199]);class So{constructor(a,b){this.shapeNode=a;this.wYd=b%So.Zjc}}So.Zjc=360;Object(n.a)(So,"ShapeRotateData",null,[]);class JJ{constructor(a,b){this.trg=null;this.Ine=0;this.Vd=a;this.ia=b}start(){this.Vd.OD(!1);this.trg=this.Vd.Gvb().Xf()}ESd(a,b){return 3===a&&!this.Vd.Al&&this.Vd.gb.equals(b[0].gb)}perform(a){this.Ine=(this.Vd.rotation+
a)%So.Zjc;this.Vd.setRotation(this.Ine,this.trg)}end(){if(!this.Vd.Al){this.Vd.Oz(!1);var a=new So(this.Vd.shapeNode,this.Ine);this.ia.La(M.a.toc,2,a)}}}Object(n.a)(JJ,"ShapeRotateAction",null,[1199]);class jp{constructor(a){this.oIa=this.OQ=null;this.ia=a}Htc(){this.oIa&&Nc.a.Osb(this.oIa);this.oIa=Nc.a.qaa(Object(F.a)(this,this.tPf,"endAction"),jp.smi)}W_d(a,b){this.OQ&&!this.OQ.ESd(a,b)&&(this.OQ.end(),this.OQ=null);if(!this.OQ){this.OQ=this.e1i(a,b);if(!this.OQ)throw Error.invalidOperation("Could not create keyboard action");
this.OQ.start()}this.Htc();return this.OQ}tPf(){this.OQ&&(this.OQ.end(),this.OQ=null);this.oIa=null}move(a,b){a=this.W_d(1,a);b=this.vMf(b);a.perform(b)}resize(a,b){a=this.W_d(2,a);b=this.vMf(b);a.perform(b.x,b.y)}rotate(a,b,c){a=this.W_d(3,a);c=c?jp.hmi:jp.gmi;a.perform(b?c:-1*c)}vMf(a){let b=0,c=0;a.equals(ke.a.north)?c=-1*jp.RHc:a.equals(ke.a.east)?b=jp.RHc:a.equals(ke.a.south)?c=jp.RHc:a.equals(ke.a.west)&&(b=-1*jp.RHc);return new ad.a(b,c)}e1i(a,b){return b?1===a?new HJ(b,this.ia):2===a?new IJ(b,
this.ia):3===a&&(1<b.length&&Ba.a.J(17651872,815,15,"ShapeKeyboardDragManager::GetActionForType - Currently we don't support multi-shapes rotation, will only rotate the first shape by keyboard."),3===a)?new JJ(b[0],this.ia):null:null}}jp.smi=1E3;jp.RHc=1;jp.gmi=15;jp.hmi=1;Object(n.a)(jp,"ShapeKeyboardDragManager",null,[1172]);var zg=d(153),Ps=d(510);const gn=a=>{a&&Nc.a.Ib&&(Nc.a.Ib.B7f=a.Jf,Nc.a.Ib.Ayh=a.Kg)};var wq=d(244),KJ=d(494),Bx=d(323);class aD{constructor(a,b,c,h,m,y,G,U,ja,va,Ta,fb,Db,
gc,hc,Gc,Pc,yc,Vd,De){if(!Gc)throw Error.argumentNull("ISessionInfoOwner is null");if(!Pc)throw Error.argumentNull("IPPTUnitConversion is null");if(!yc)throw Error.argumentNull("IZoomContext is null");hc||Ba.a.J(509650844,815,10,"ShapeManipulationActor constructor null WebSocketFrontDoor");this.ia=a;this.ff=b;this.jq=c;this.Fa=h;this.ob=m;this.g$c=y;this.Jb=G;this.Fb=U;this.Ea=ja;this.ve=va;this.zs=Db;this.dA=Ta;this.H9c=fb;this.Ga=gc;this.vec=new xa.ScriptSharpLegacyMap;this.YXa=hc;this.Xa=Gc;this.Pi=
Pc;this.gj=yc;this.Bi=Vd;this.hva=De}vb(){this.ia.ra(M.a.G6a,nc.a.application,Object(F.a)(this,this.jqj,"handleDeleteSelectedShapes"),4);this.ia.ra(M.a.w1b,nc.a.application,Object(F.a)(this,this.kqj,"handleDeleteShapes"),4);this.ia.ra(M.a.BIa,nc.a.application,Object(F.a)(this,this.esj,"handleMoveShapes"),4);this.ia.ra(M.a.vib,nc.a.application,Object(F.a)(this,this.iuj,"handleResizeShapes"),4);this.ia.ra(M.a.toc,nc.a.application,Object(F.a)(this,this.aae,"handleRotateShape"),4);this.ia.ra(M.a.xlh,
nc.a.application,Object(F.a)(this,this.bae,"handleRotateShapes"),4);this.ia.ra(M.a.vlh,nc.a.application,Object(F.a)(this,this.W8f,"handleRotateShapeAnchor"),4);this.ia.ra(M.a.wlh,nc.a.application,Object(F.a)(this,this.W8f,"handleRotateShapeAnchor"),4);this.ia.ra(M.a.e1,nc.a.application,Object(F.a)(this,this.X8f,"handleRotateShapeByDirection"),4);this.ia.ra(M.a.yld,nc.a.application,Object(F.a)(this,this.X8f,"handleRotateShapeByDirection"),4);Rd.a("FlipInMultiSelectEnabledV2")?(this.ia.ra(M.a.voc,nc.a.application,
Object(F.a)(this,this.e8f,"handleFlipShape"),4),this.ia.ra(M.a.uoc,nc.a.application,Object(F.a)(this,this.e8f,"handleFlipShape"),4)):(this.ia.ra(M.a.voc,nc.a.application,Object(F.a)(this,this.f8f,"handleFlipShapeForSingleSelection"),4),this.ia.ra(M.a.uoc,nc.a.application,Object(F.a)(this,this.f8f,"handleFlipShapeForSingleSelection"),4));this.ia.ra(M.a.S6a,nc.a.application,Object(F.a)(this,this.Rpj,"handleCommitKeyboardShapeManipulation"),4);this.ia.ra(M.a.qic,xb.a.view,Object(F.a)(this,this.DUc,"handleMoveShapesKeyboard"),
4);this.ia.ra(M.a.ric,xb.a.view,Object(F.a)(this,this.DUc,"handleMoveShapesKeyboard"),4);this.ia.ra(M.a.sic,xb.a.view,Object(F.a)(this,this.DUc,"handleMoveShapesKeyboard"),4);this.ia.ra(M.a.tic,xb.a.view,Object(F.a)(this,this.DUc,"handleMoveShapesKeyboard"),4);this.ia.ra(M.a.eoc,xb.a.view,Object(F.a)(this,this.LUc,"handleResizeShapesKeyboard"),4);this.ia.ra(M.a.foc,xb.a.view,Object(F.a)(this,this.LUc,"handleResizeShapesKeyboard"),4);this.ia.ra(M.a.goc,xb.a.view,Object(F.a)(this,this.LUc,"handleResizeShapesKeyboard"),
4);this.ia.ra(M.a.hoc,xb.a.view,Object(F.a)(this,this.LUc,"handleResizeShapesKeyboard"),4);this.ia.ra(M.a.eRe,xb.a.view,Object(F.a)(this,this.MUc,"handleRotateShapeKeyboard"),4);this.ia.ra(M.a.xld,xb.a.view,Object(F.a)(this,this.MUc,"handleRotateShapeKeyboard"),4);this.ia.ra(M.a.wld,xb.a.view,Object(F.a)(this,this.MUc,"handleRotateShapeKeyboard"),4);this.ia.ra(M.a.woc,xb.a.view,Object(F.a)(this,this.MUc,"handleRotateShapeKeyboard"),4);this.ia.ra(M.a.mMe,nc.a.application,Object(F.a)(this,this.O$d,
"handleIsDirectManipulationEnabled"),97);this.ia.ra(M.a.mKe,nc.a.application,Object(F.a)(this,this.L8f,"handlePreviewRotate"),4);this.ia.ra(M.a.nKe,nc.a.application,Object(F.a)(this,this.L8f,"handlePreviewRotate"),4);this.ia.ra(M.a.XQe,nc.a.application,Object(F.a)(this,this.luj,"handleRevertPreviewRotate"),4)}De(){const a=this.Fa.Gc(Ua.a.rg);a.bindAction(w.KeyInputManager.Na(z.a.x6,4),M.a.eoc);a.bindAction(w.KeyInputManager.Na(z.a.Naa,4),M.a.foc);a.bindAction(w.KeyInputManager.Na(z.a.zga,4),M.a.goc);
a.bindAction(w.KeyInputManager.Na(z.a.aZ,4),M.a.hoc);a.bindAction(w.KeyInputManager.Na(z.a.Naa,5),M.a.wld);a.bindAction(w.KeyInputManager.Na(z.a.zga,5),M.a.woc);a.bindAction(w.KeyInputManager.Na(z.a.Naa,1),M.a.eRe);a.bindAction(w.KeyInputManager.Na(z.a.zga,1),M.a.xld);a.bindAction(w.KeyInputManager.Na(z.a.bpa,0),M.a.G6a);a.bindAction(w.KeyInputManager.Na(z.a.MH,0),M.a.G6a);this.Fa.Gc(Ua.a.nj).bindAction(w.KeyInputManager.Na(z.a.Naa,1),H.a.qe)}esj(a,b,c,h,m){if(!m||!Object(za.a)(Array,m)||1>m.length)return 8;
for(const G of m)if(b=G.shapeNode,this.zRa(b),b.get_smartArtModelId()&&(b=this.Ea.vr(b)),!this.XAf(b)||this.ff.$c(G.shapeNode))return 16;if(1===c)return 32;if(Nc.a.Ib){Nc.a.Ib.Nj=!0;for(var y of m)if((c=y.shapeNode)&&(c.Jf||c.Kg)){gn(c);break}}y=this.Jb.zd(15,void 0,()=>{this.ob.ij();this.Fa.Ed()});try{y.nc(m[0].shapeNode);y.jd=a;const G=this.Fb.Ld;for(const U of m){const ja=new ad.a(G.rf(U.position.x,0),G.rf(U.position.y,1));kq.c(U.shapeNode.get_smartArtModelId()?this.Ea.vr(U.shapeNode):U.shapeNode,
ja.x,ja.y)}}finally{y&&y.dispose()}return 32}iuj(a,b,c,h,m){if(!m||!Object(za.a)(Array,m)||1>m.length)return 8;for(b=0;b<m.length;b++){if(!this.FZb(m[b].p1))return Ba.a.J(509650842,815,15,"ShapeManipulationActor::ResizeShapes - Try to execute HandleResizeShapes when {0} shape is not resizable.",m[b].p1.get_shapeId()),16;if(this.ff.$c(m[b].p1))return 16}if(1===c)return 32;if(Nc.a.Ib){Nc.a.Ib.Nj=!0;for(var y of m)if((c=y.p1)&&(c.Jf||c.Kg)){gn(c);break}}y=this.Jb.zd(15,void 0,()=>{this.ob.ij();const G=
this.Fa.Be;!G||G.name!==Ua.a.rg&&G.name!==Ua.a.uz||this.Fa.Ed()});try{for(y.nc(m[0].p1),y.jd=a,a=0;a<m.length;a++)m[a].p1.gsh=m[a].b1}finally{y&&y.dispose()}if(this.ob.xL()&&(a=this.ob.bEa(),(a=this.al(a))&&Object(za.a)(Ps.a,a.Ok)&&Object(ua.a)(Ps.a,a.Ok).clearChildSelection(),this.YXa&&this.Ga.$il))for(const G of m)this.m3k(G);return 32}m3k(a){const b=a.p1;if(b&&b.Rf&&!b.Kg){var c=Nc.a.Ib?Nc.a.Ib.actionId:Eh.a.create().toString(),h=u.AFrameworkApplication.userSessionId,m=this.Xa.podSessionId,y=this.Til,
G=this.$jb,U=G/y,ja=$d.a.qY(this.Pi.wM(a.b1.left,U),0),va=$d.a.qY(this.Pi.wM(a.b1.top,U),1),Ta=$d.a.qY(this.Pi.wM(a.b1.right,U),0);a=$d.a.qY(this.Pi.wM(a.b1.bottom,U),1);U=Math.abs(b.get_widthPersisted()+Ta-ja);var fb=Math.abs(b.get_heightPersisted()+a-va);Ta=Pg.o(b.slideCid,b.slideSid);a=Pg.b(b.get_shapeId(),null);var Db=Pg.f(Ta,a);ja=Pg.m((b.get_xPersisted()+ja).toString(),(b.get_yPersisted()+va).toString());ja=Pg.n(U,fb,ja);ja=Pg.c(Db,ja);va=null;this.Bi&&this.Bi.highContrastColors&&(va=Pg.k(Pg.j(this.Bi.highContrastColors.foregroundTextColor),
Pg.j(this.Bi.highContrastColors.backgroundColor),Pg.j(this.Bi.highContrastColors.linkColor)));h=Pg.d(Ta,a,1,b.fh,0,0,c,h,this.Bi.isInHighContrastMode,va,this.Ga.hoh&&this.hva?this.hva.N$i():null);m=Pg.e(h,[],m);m.editOps.push(ja);m=Pg.q(null,m,null,null,this.Xa.nk);h=Nc.a.YY();Nc.a.Ib&&h&&(Nc.a.Ib.Va("editOpCorrelationId",c),Nc.a.Ib.Va("editOpRequestStartTick",h.toString()));this.YXa.Gx(m);Ba.a.J(509650841,815,50,"ShapeManipulationActor::HandleResizeShapes Sent SmartArtEditOpRequest; correlationId:{0}, slideSid:{1}, slideCid:{2}, shapeId:{3}, slideZoomFactor:{4}, slideImageZoom:{5}, SendKnownGlyphsForSmartArtResizeEditOp:{6}",
c,b.slideSid,b.slideCid,b.get_shapeId(),y,G,this.Ga.hoh)}}get Til(){let a=this.gj.EG;this.jq&&this.jq.Ba&&this.jq.Ba.Ow&&null!=this.jq.Ba.Ow.Wr&&(a=this.jq.Ba.Ow.Wr);a||(Ba.a.J(509650840,815,15,"ShapeManipulationActor.SlideZoomFactor: zero slideZoomFactor"),a=1);return a}get $jb(){let a=1;if(this.jq&&this.jq.Ba){const b=Object(ua.a)(295,this.jq.Ba.tg(this.Fb.Ma));b?a=b.mT:Ba.a.J(509650839,815,15,"ShapeManipulationActor.SlideImageZoom: no active ISlideViewElement; imageZoom:{0}",a)}else Ba.a.J(509650838,
815,15,"ShapeManipulationActor.SlideImageZoom: no active slide; imageZoom:{0}",a);a||(Ba.a.J(509650837,815,15,"ShapeManipulationActor.SlideImageZoom: zero imageZoom"),a=1);return a}X8f(a,b,c,h,m){return 1===c?32:zg.a("Rotate",a,()=>{Ba.a.J(509650836,822,50,"ShapeManipulationActor::HandleRotateShapeByDirection, Rotate operation performed");const y=this.ob.sg();if(!y)return Ba.a.J(509650835,822,10,"ShapeManipulationActor::HandleRotateShapeByDirection, selected nodes: null"),16;this.H9c&&1===y.length&&
this.zRa(y[0]);switch(a){case M.a.e1:Ba.a.J(509650834,822,50,"ShapeManipulationActor::RotateLeft: Rotate Left is selected");if(Rd.a("FixForUndoRotateMultipleShapes")){var G={};G.selectedNodes=y;G.rotateLeft=!0;this.bae(a,b,c,h,G)}else for(G of y)m=new So(G,Math.round(G.get_shapeRotation()+270)),this.aae(a,b,c,h,m);break;case M.a.yld:Ba.a.J(509650833,822,50,"ShapeManipulationActor::RotateRight: Rotate Right is selected");if(Rd.a("FixForUndoRotateMultipleShapes"))G={},G.selectedNodes=y,G.rotateRight=
!0,this.bae(a,b,c,h,G);else for(const U of y)m=new So(U,Math.round(U.get_shapeRotation()+90)),this.aae(a,b,c,h,m);break;default:return 8}return 32})}bae(a,b,c,h,m){if(!m)return 8;b=m.LIl;h=m.RZk?m.RZk:[];for(const y of b){const G=this.rsb(y);if(1===c)return G?32:8;if(!G||this.ff.$c(y))return 16}if(m.e1||m.yld)for(const y of b)Nc.a.Ib&&(Nc.a.Ib.Nj=!0,y&&(y.Jf||y.Kg)&&gn(y)),c=new So(y,Math.round(y.get_shapeRotation()+(m.e1?270:90))),h.push(c);m=this.Jb.zd(15,void 0,()=>{this.ob.ij();const y=this.Fa.Be;
!y||y.name!==Ua.a.rg&&y.name!==Ua.a.uz||this.Fa.Ed()});try{for(m.nc(b[0]),m.jd=a,a=0;a<b.length;a++)b[a].set_shapeRotation(h[a].wYd)}finally{m&&m.dispose()}return 32}aae(a,b,c,h,m){if(!m||!Object(za.a)(So,m))return 8;b=m.shapeNode;h=this.rsb(b);if(1===c)return h?32:8;if(!h||this.ff.$c(b))return 16;Nc.a.Ib&&(Nc.a.Ib.Nj=!0,b&&(b.Jf||b.Kg)&&gn(b));c=this.Jb.zd(15,void 0,()=>{this.ob.ij();const y=this.Fa.Be;!y||y.name!==Ua.a.rg&&y.name!==Ua.a.uz||this.Fa.Ed()});try{c.nc(b),c.jd=a,b.set_shapeRotation(m.wYd)}finally{c&&
c.dispose()}return 32}W8f(){const a=this.ob.sg();return 0<a.length&&this.MRj(a)?32:8}L8f(a,b,c){return this.Ga.Elc?1===c?32:zg.a("HandlePreviewRotate:",a,()=>{var h=this.ob.sg();for(const m of h){if(!m){Ba.a.J(509650831,822,50,"HandlePreviewRotate, shape with shape id : {0} is null",m.get_shapeId());continue}if(m.ud)continue;this.vec.Hb(m.get_shapeId())?this.vec.$(m.get_shapeId(),m.get_shapeRotation()):this.vec.add(m.get_shapeId(),m.get_shapeRotation());h=this.al(m);if(!h){Ba.a.J(509650830,822,50,
"HandlePreviewRotate, shapeViewElement with shape id : {0} is null",m.get_shapeId());continue}const y=h.Gvb().Xf();switch(a){case M.a.mKe:h.setRotation((m.get_shapeRotation()+270)%So.Zjc,y);break;case M.a.nKe:h.setRotation((m.get_shapeRotation()+90)%So.Zjc,y)}}return 32}):2}luj(a,b,c){if(!this.Ga.Elc)return 2;if(1===c)return 32;a=this.ob.sg();for(const h of a)if(!h)Ba.a.J(509650829,822,50,"HandleRevertPreviewRotate, shape with shape id : {0} is null",h.get_shapeId());else if(!h.ud)if(a=this.al(h))if(b=
a.Gvb().Xf(),this.vec.Hb(h.get_shapeId()))a.setRotation(this.vec.ga(h.get_shapeId()),b);else return Ba.a.J(509650827,815,10,"HandleRevertPreviewRotate: Revert Preview operation on the shape failed with id : {0}",h.get_shapeId()),8;else Ba.a.J(509650828,822,50,"HandleRevertPreviewRotate, shapeViewElement with shape id : {0} is null",h.get_shapeId());return 32}jqj(a,b,c,h,m){b=this.ob.sg();if(1===b.length&&this.ob.pC())return 16;h=1===b.length&&!!b[0]&&b[0].T$a();h=0<b.length&&!h;if(1===c)return h?
32:8;if(!h)return 16;if(Nc.a.Ib){Nc.a.Ib.actionName="ClearPlaceholders";Nc.a.Ib.Nj=!0;for(const y of b)if(y.Jf||y.Kg){gn(y);break}}if(this.ob.xL()&&Rd.a("EnableSmartArtSubShapeDeletion")&&this.J$d(b[0],a,m))return 32;c=null;if(m=this.Ea.g9a(b))Rd.a("SmartArtSubNodeEditing")?c=this.Ea.vr(m):(this.ob.Ckd(m),b=this.ob.sg());return this.w1b(a,b,this.ob.sk(),c)?32:16}kqj(a,b,c,h,m){if(!m)return 1===c?8:16;b=this.jq.presentation;if(!b)throw Error.argumentNull("Presentation is null");m=Array.isArray(m.shapeNodes)?
m.shapeNodes:null;if(!m)return 1===c?8:16;if(1===c)return 32;Nc.a.Ib&&(Nc.a.Ib.actionName="DeleteShapes",Nc.a.Ib.Nj=!0);return m.length&&this.w1b(a,m,Object(ua.a)(116,b.lC(m[0].slideId)))?32:16}w1b(a,b,c,h=null){if(!c||!b.length||this.ff.qC(b))return!1;let m=!1;for(var y of b)if(y.TEa){m=!0;break}y=this.Jb.zd(15,void 0,()=>{this.ob.Qh()});try{h?y.kd(h):y.kd(c);y.jd=a;y.Py[wq.a.ixb]=m;for(const G of b)if(G&&G.Kg){const U=this.Ea.rs(G);if(U){const ja=Lh.c(U,this.Fb.Ma);ja&&(ja.Ok.visible=!1)}}h?h.thh(b):
c.KU(b)}finally{y&&y.dispose()}for(const G of b)this.zs.eeh(new KJ.a(G));return!0}f8f(a,b,c){b=this.ob.sg();const h=0<b.length?b[0]:null,m=1===b.length&&this.ISd(h);if(1===c)return m?32:8;if(!m||this.ff.$c(h))return 16;this.zRa(h);for(const y of b)if(y.Jf||y.Kg){gn(y);break}return zg.a("Rotate",a,()=>{let y,G;switch(a){case M.a.uoc:G=h.get_isVerticallyFlipped();y=!h.get_isHorizontallyFlipped();break;case M.a.voc:G=!h.get_isVerticallyFlipped();y=h.get_isHorizontallyFlipped();break;default:return 8}const U=
this.Jb.zd(15,void 0,()=>{this.ob.ij();this.Fa.Ed()});try{U.nc(h),U.jd=a,h.set_isVerticallyFlipped(G),h.set_isHorizontallyFlipped(y)}finally{U&&U.dispose()}return 32})}e8f(a,b,c){const h=this.ob.sg();b=!0;if(!h||h&&!h.length)b=!1;for(const G of h)if(b=this.ISd(G),!b)break;if(1===c)return b?32:8;if(!b)return Ba.a.J(509650822,815,10,"ShapeManipulationActor:: HandleFlipShape shape horizontal flip change with no rotateable shape selected"),16;for(const G of h){if(this.ff.$c(G))return 16;this.zRa(G)}for(const G of h)if(G.Jf||
G.Kg){gn(G);break}const m=a===M.a.uoc,y=a===M.a.voc;return m||y?zg.a("Rotate",a,()=>{const G=Array(h.length),U=Array(h.length);for(var ja=0;ja<h.length;ja++)U[ja]=!!(y^h[ja].get_isVerticallyFlipped()),G[ja]=!!(m^h[ja].get_isHorizontallyFlipped());ja=this.Jb.zd(15,void 0,()=>{this.ob.ij();this.Fa.Ed()});try{ja.nc(h[0]);ja.jd=a;for(let va=0;va<h.length;va++)h[va].set_isVerticallyFlipped(U[va]),h[va].set_isHorizontallyFlipped(G[va])}finally{ja&&ja.dispose()}return 32}):(Ba.a.J(509650821,815,10,"ShapeManipulationActor:: HandleFlipShape Invalid request"),
8)}Rpj(){this.g$c.tPf();return 32}DUc(a,b,c){const h=Lh.b(b);if(!h)return 16;b=this.ob.sg();if(!b.length)return 16;let m=!0;const y=[];for(const G of b)if(G.get_smartArtModelId()){y.push(this.Ea.vr(G));break}else y.push(G);for(const G of y)if(!this.XAf(G)){m=!1;break}if(1===c)return m?32:8;if(!m)return 16;c=Lh.d(y,h.Ma);if(this.ff.qC(b))return 16;switch(a){case M.a.qic:a=ke.a.south;break;case M.a.ric:a=ke.a.west;break;case M.a.sic:a=ke.a.east;break;case M.a.tic:a=ke.a.north;break;default:return 8}this.g$c.move(c,
a);this.dA&&this.ob.xL()&&(a=this.ob.bEa(),this.ve.Nhb(new Bx.a(a)));Nc.a.Ib&&(Nc.a.Ib.Nj=!0,Nc.a.Ib.pF=new Date);return 32}LUc(a,b,c){const h=Lh.b(b);b=this.ob.sg();const m=[];for(var y of b){if(y.get_smartArtModelId()){this.ob.Ckd(y);Array.add(m,this.Ea.vr(y));break}!y.isResizable||y.KI||y.ud||Array.add(m,y)}y=Lh.d(m,h.Ma);if(1===c)return 0<m.length?32:8;if(0>=b.length||this.ff.qC(m))return 16;switch(a){case M.a.eoc:a=ke.a.south;break;case M.a.foc:a=ke.a.west;break;case M.a.goc:a=ke.a.east;break;
case M.a.hoc:a=ke.a.north;break;default:return 8}this.g$c.resize(y,a);this.dA&&this.ob.xL()&&(a=this.ob.bEa(),this.ve.Nhb(new Bx.a(a)));Nc.a.Ib&&(Nc.a.Ib.Nj=!0,Nc.a.Ib.pF=new Date);return 32}MUc(a,b,c){var h=this.ob.sg();const m=0<h.length?h[0]:null,y=1===h.length&&this.rsb(m);if(1===c)return y?32:8;if(!y||this.ff.$c(m))return 16;b=Lh.b(b);h=Lh.d(h,b.Ma);c=a===M.a.xld||a===M.a.woc;a=a===M.a.wld||a===M.a.woc;0<h.length&&h[0].shapeNode.Jf&&h[0].shapeNode.isEditable&&(b=h[0].shapeNode.tg(b.Ma))&&b.tVc();
this.g$c.rotate(h,c,a);Nc.a.Ib&&(Nc.a.Ib.Nj=!0,Nc.a.Ib.pF=new Date);return 32}O$d(a,b,c,h,m){return m&&Object(za.a)(9,m)?this.ff.$c(m)?16:32:8}MRj(a){for(const b of a)if(!this.rsb(b)&&!this.ISd(b))return!1;return!0}XAf(a){return!!a&&a.NI&&a.YA&&!a.KI}FZb(a){return!!a&&a.isResizable&&a.YA&&!a.KI}rsb(a){return!!a&&a.vL&&!a.KI}ISd(a){return!!a&&a.BLj&&!a.KI}al(a){return a?Object(ua.a)(117,a.sc(this.Fb.Ma)):null}zRa(a){a&&a.Yx&&(a=this.al(a))&&a.h1(!1)}J$d(a,b,c){return(a=this.al(a))&&Object(za.a)(Ps.a,
a.Ok)&&(a=Object(ua.a)(Ps.a,a.Ok))?a.ugd(M.a.Qz(b),c):!1}}Object(n.a)(aD,"ShapeManipulationActor",null,[]);var Cv=d(419),Mi=d(66);class bD extends Cv.DragSelectionDragAdapter{constructor(a,b,c,h,m,y,G,U,ja,va,Ta,fb,Db){super(a,b,c);this.pa=h;this.Fa=m;this.la=U;this.Ea=y;this.iek=G;this.QC=ja;this.Pb=va;this.fq=Ta;this.Fea=fb;this.yc=Db;this.yvc=this.zvc=null}get $Hc(){return this.zvc}get ZHc(){return this.yvc}Nu(a){for(var b=this.n1e(),c=a.Cc,h=c,m=this.QC.zI(h);!m&&h;){m=this.QC.zI(h);if(Sys.UI.DomElement.containsCssClass(h,
"Outline")&&Sys.UI.DomElement.containsCssClass(h,"OutlineSized"))break;h=h.parentNode}m||Ba.a.J(39175171,820,15,"The element doesn't have a owner and it's parent don't have owner className: "+c.className+" tagName: "+c.tagName);if(!b||!m)return!1;b=b.node;m=m.gb;c=this.Pb.Nc(m);if(b===m||c.gf()&&c.o1a()===b){m=super.Nu(a);if(!m)return m;this.Ea.N3(b)&&(c=this.yc.FN(Object(ua.a)(4,b)))&&c.Lp()&&(c=this.Fea.g2d(a.clientPoint,c,null,null))&&(h=c.sc(this.If.Ma),this.If.r6(a.clientPoint,h,c,this.If,a.shiftKey));
null!==this.fq&&(a=this.Ea.ud(b),this.fq.iya(Mi.a.yaa),a&&(this.zvc=this.Fea.P6d(b),this.yvc=this.Fea.p1f(b)));return m}return!1}iu(a){super.iu(a);this.gQf();null!==this.fq&&this.fq.Lxa();this.$Hc&&(this.zvc=null);this.ZHc&&(this.yvc=null)}Zn(a){super.Zn(a);this.gQf();null!==this.fq&&this.fq.Lxa();this.$Hc&&(this.zvc=null);this.ZHc&&(this.yvc=null)}XFb(a,b,c){({Vr:b,graphNode:c}=super.XFb(a,b,c));if(this.la.Kjg&&(a=this.n1e())){const h=this.N4i(c);h&&h===a||(c=a,b=c.sc(this.If.Ma))}return{Vr:b,graphNode:c}}itc(a){let b=
super.itc(a);if(!b&&this.la.Kjg){let c=this.n1e();if(c&&this.Ea.ud(c.node)){const h=this.pa.Ym();this.Fea.JXc(a.clientPoint,h)&&(c=this.Fea.g2d(a.clientPoint,h,this.$Hc,this.ZHc))}c&&(b=c.sc(this.If.Ma))}return b}N4i(a){return a?this.Ea.Zm(a):null}n1e(){const a=this.iek.Y3f(this.If.Ma);return!a||a.eH?null:this.pa.Jp()}gQf(){(this.pa.bH()||this.pa.xs())&&this.Fa.Ed()}}Object(n.a)(bD,"PPTDragSelectionDragAdapter",Cv.DragSelectionDragAdapter,[1171,244]);class LJ{constructor(a,b,c){this.Re=a;this.u9=
b;this.yc=c}JXc(a,b){if(!a||!b)return!1;b=b.sc(this.Re);return b?(b=qd.a.ii(b.htmlElement))?!!a&&!!b&&a.x>=b.x&&a.y>=b.y&&a.x<=b.x+b.width&&a.y<=b.y+b.height:!1:!1}g2d(a,b,c=null,h=null){return(a=this.LTf(a,b,c,h))?a.Ry():null}LTf(a,b,c=null,h=null){if(!a||!b)return null;c&&h||(h=this.p1f(b),c=this.P6d(b));if(!(c&&h&&c.length&&h.length))return null;var m=b.sc(this.Re);if(!m)return null;var y=qd.a.ii(m.htmlElement);if(!y)return null;m=a.x-y.x;y=a.y-y.y;var G=0;for(a=0;a<c.length&&!(G+=c[a],G>=y);a++);
for(G=y=0;G<h.length&&!(y+=h[G],y>=m);G++);a=Math.min(a,c.length-1);G=Math.min(G,h.length-1);return 0>a||a>=c.length||0>G||G>=h.length?null:b.qf(a,G)}P6d(a){if(a){a=this.yc.Zja(a);if(!a||!a.length)return null;const c=a.length,h=Array(c);for(let m=0;m<c;m++){var b=a[m].sc(this.Re);if(!b)return null;b=qd.a.ii(b.htmlElement);h[m]=b.height}return h}return null}p1f(a){if(a){a=xn.b(Object(ua.a)($f.a,a));if(!a||!a.length)return null;const b=a.length,c=Array(b);for(let h=0;h<b;h++)c[h]=this.u9.Me(a[h],0);
return c}return null}}Object(n.a)(LJ,"PptTableDragSelectionHelper",null,[530]);var Zr=d(643),zz=d(336);class MJ{constructor(a,b,c,h,m,y,G){this.ta=this.Jm=null;if(!a)throw Error.argumentNull("actionManager");if(!b)throw Error.argumentNull("activeSlideViewManager");if(!h)throw Error.argumentNull("pageView");if(!m)throw Error.argumentNull("insertShapeOverlayViewStateManager");if(!y)throw Error.argumentNull("insertShapeOverlayViewElement");if(!G)throw Error.argumentNull("graphTopologyManager");this.ia=
a;this.Kc=b;this.Pi=c;this.Fb=h;this.qWa=m;this.qea=y;this.ua=G}xv(a){try{return a?a.lA===Sys.UI.MouseButton.rightButton?!1:2===this.qWa.Tcg?!0:!1:(Ba.a.J(512336010,822,10,"Event argument is null in isDragPossible for shapes"),!1)}catch(b){throw Ba.a.J(512336009,822,10,"Exception {0} occured in isDragPossible for shapes",b),b;}}Nu(a){try{if(!a)return Ba.a.J(512336008,822,10,"Event argument is null in OnDragStart for shapes"),!1;if(!this.xv(a))return!1;this.qea.nl(Mi.a.EMb);this.Jm=Zr.a(a.clientPoint,
this.Kc.Ic);const b=new yi.a;b.left=this.Jm.x;b.top=this.Jm.y;b.bottom=this.Jm.y+5;b.right=this.Jm.x+5;a={};a.offsets=b;a.insertShapeActionId=this.qea.Xxb;a.insertLocalShape=!0;if(32!=this.ia.La(M.a.JWc,2,a))return!1;this.ta=a.node;return!0}catch(b){throw Ba.a.J(512336007,822,10,"Exception {0} occured in OnDragStart for shapes",b),b;}}zw(a){try{if(!a)return Ba.a.J(512336006,822,10,"Event argument is null in OnDragMove for shapes"),!1;if(!this.Fb.isActive)return!1;const b=Zr.a(a.clientPoint,this.Kc.Ic),
c=Zr.b(this.Srd(Math.min(this.Jm.y,b.y)-this.Jm.y),this.Srd(Math.max(this.Jm.y,b.y)-this.Jm.y-5),this.Srd(Math.min(this.Jm.x,b.x)-this.Jm.x),this.Srd(Math.max(this.Jm.x,b.x)-this.Jm.x-5));Object(ua.a)(zz.a,this.ta.sc(0)).setOffsets(c,!0);return!0}catch(b){throw Ba.a.J(512336005,822,10,"Exception {0} occured in OnDragMove for shapes",b),b;}}Zn(a){try{if(a)if(this.Jm){var b=Zr.a(a.clientPoint,this.Kc.Ic),c=Zr.b(Math.min(this.Jm.y,b.y),Math.max(this.Jm.y,b.y),Math.min(this.Jm.x,b.x),Math.max(this.Jm.x,
b.x));a={};a.offsets=c;a.insertShapeActionId=this.qea.Xxb;a.insertLocalShape=!1;this.hLf();this.ia.La(M.a.JWc,2,a);this.NK()}else Ba.a.J(512336003,822,10,"m_dragBeginPosition should not be null in OnDragEnd for shapes");else Ba.a.J(512336004,822,10,"Event argument is null in OnDragEnd for shapes")}catch(h){throw Ba.a.J(512336002,822,10,"Exception {0} occured in OnDragEnd for shapes",h),h;}}iu(){this.NK()}dispose(){this.NK()}Srd(a){return this.Pi.zM(a,this.Kc.Ic.mT)}NK(){this.Jm=null;this.ta&&(this.hLf(),
this.qWa.i0e(0),this.ta=null)}hLf(){this.ua.Ba.KU([this.ta])}}Object(n.a)(MJ,"ShapeDrawDragAdapter",null,[244,106]);class Cx{constructor(a,b){this.cug=null;this.pBb=-1;this.Qxe=a;this.V5j=b}Nu(a){return this.A2g(a)?(this.Qxe.qgd(),!0):!1}zw(a){if(!a)return!1;this.V5j?(this.cug=a,this.b1k()):this.DFe(a);return!0}Zn(a){this.KCh()&&this.$Nf(0);this.x2g(a);this.Qxe.loc()}iu(){this.KCh();this.v2g();this.Qxe.loc()}b1k(){-1===this.pBb&&(this.pBb=window.requestAnimationFrame(Object(F.a)(this,this.$Nf,"dragMoveTask")))}KCh(){return-1!==
this.pBb?(window.cancelAnimationFrame(this.pBb),this.pBb=-1,!0):!1}$Nf(){this.DFe(this.cug);this.pBb=-1}}Object(n.a)(Cx,"ShapeDragAdapter",null,[244]);class NJ extends Cx{constructor(a,b,c,h,m,y,G,U,ja,va,Ta,fb,Db,gc,hc,Gc,Pc,yc){super(gc,Gc);this.lcc=0;this.icc=this.qp=this.xO=this.$tg=null;this.TGa=!1;this.Fb=a;this.ia=b;this.X_=c;this.Kq=h;this.Hv=m;this.HC=y;this.ob=G;this.jE=U;this.QC=ja;this.Ea=va;this.yc=Ta;this.ve=fb;this.Pgc=Db;this.fq=hc;this.dA=Pc;this.Sp=yc}xv(a){return this.LI(a).returnValue}LI(a){let b;
var c=[];b=!1;if(!a||a.lA!==Sys.UI.MouseButton.leftButton||this.HC.E_)return{returnValue:!1,nic:c,K$b:b};const h=Object(ua.a)(296,this.QC.zI(a.Cc));if(!h||!h.The(a.Cc))return{returnValue:!1,nic:c,K$b:b};if((b=h.isSelected)||h.shapeNode.Kg){c=[];a=Object(ua.a)(117,this.QC.zI(a.Cc));a.shapeNode.Jf&&this.ob.tLf(a.shapeNode);a=this.ob.sg();for(const m of a)if(m.get_smartArtModelId()){c.push(this.Ea.vr(m));break}else c.push(m);c=Lh.d(c,this.Fb.Ma);for(const m of c)if(!this.Pfg(m))return{returnValue:!1,
nic:c,K$b:b}}else{if(!this.Pfg(h))return{returnValue:!1,nic:c,K$b:b};Array.add(c,h)}return{returnValue:!0,nic:c,K$b:b}}Pfg(a){return a&&a.gb&&a.gb.NI&&a.gb.YA&&!a.shapeNode.KI&&32===this.ia.La(M.a.mMe,1,a.gb)?!0:!1}A2g(a){var b;let c;if(!({nic:b,K$b:c}=this.LI(a)).returnValue)return!1;this.ia.processAction(M.a.S6a,2);this.$tg=ad.a.bSa(a.clientPoint);this.icc=Object(ua.a)(296,this.QC.zI(a.Cc));null!==this.X_&&this.X_.nl(3);if(!this.icc||!b||!b.length)return!1;null!==this.fq&&this.fq.iya(Mi.a.Kya);
this.icc.shapeNode.Yx||(this.ob.ij(),this.jE.Ed());for(a=0;a<b.length;++a)this.mFc(b[a]);c||(this.ob.setSelection(yd.SelectionFactory.wl(this.qp[0].gb)),this.Hv.kw());for(b=0;b<this.qp.length;++b)this.qp[b].OD(!0);this.TGa=1<this.qp.length?!1:!0;this.lcc=Date.now();this.dA&&this.ob.xL()&&this.ve.sNe();this.Sp&&this.ia.processAction(D.a.Cja,2);return!0}mFc(a){this.qp||(this.qp=[]);this.xO||(this.xO=[]);Array.add(this.qp,a);Array.add(this.xO,new ad.a(a.x,a.y))}DFe(a){if(a){var b=this.wSc(ad.a.bSa(a.clientPoint),
this.$tg);a=null;var c=this.TGa&&!this.icc.shapeNode.Yx;for(let h=0;h<this.qp.length;++h)a=ad.a.add(this.xO[h],b),this.qp[h].setPosition(a.x,a.y,!c);b=this.Pgc.u5g(!1,this.TGa,this.qp[0],null);c&&!b&&a&&this.qp[0].setPosition(a.x,a.y,!0)}}wSc(a,b){a=ad.a.bV(a,b);return new ad.a(this.Kq.Pm(a.x),this.Kq.Pm(a.y))}x2g(a){const b=[];for(var c=0;c<this.qp.length;++c){var h=this.qp[c].OQc();Array.add(b,new Bv(this.qp[c].shapeNode,h));this.qp[c].Oz(!1);if(h=this.yc.FN(this.qp[c].shapeNode))h=h.Lp(),Ba.a.J(512497684,
815,50,"Drag to move table, isComplexTable:{0}",h)}this.icc.shapeNode.Yx||(c={},a&&a.pc&&a.pc.rawEvent&&(c[li.a.iDa]=a.pc.rawEvent.timeStamp),this.ia.La(M.a.BIa,2,b,c));1===b.length&&(Ba.a.J(512497683,815,50,"ShapeMoveDragAdapter - moving shape {0} - timespan by {1}",this.qp[0].shapeNode?this.qp[0].shapeNode.Cr:"",(Date.now()-this.lcc).toString()),this.dA&&this.ob.xL()&&(a=this.ob.bEa(),this.ve.Nhb(new Bx.a(a))));this.a3()}v2g(){if(this.qp){for(let a=0;a<this.qp.length;++a)this.qp[a].setPosition(this.xO[a].x,
this.xO[a].y,!0),this.qp[a].Oz(!0);this.a3()}}a3(){this.Pgc.y5g(this.TGa);null!==this.X_&&this.X_.a1();this.Fb.KR();this.xO=this.qp=null;null!==this.fq&&this.fq.Lxa()}}Object(n.a)(NJ,"ShapeMoveDragAdapter",Cx,[]);class cD{constructor(a){this.l3c=this.g0=this.E0=this.ffc=this.o0=null;this.Vd=a}O7k(a,b,c,h,m){this.o0=a;this.ffc=b;this.E0=c;this.g0=h;this.l3c=m}}Object(n.a)(cD,"ResizeShapesCalculationData",null,[]);var dD=d(619);class Rk{static rSd(a,b,c,h,m){return h?Rk.rAf(a,c):Rk.eni(a,b,c,m)}static rAf(a,
b){const c=new yi.a;if(a.equals(ke.a.Ku)||a.Xyb(ke.a.Ku))c.left=b.x,c.top=b.y;else if(a.equals(ke.a.RE)||a.Xyb(ke.a.RE))c.right=b.x,c.bottom=b.y;return c}static eni(a,b,c,h){b=a.I8b()?Rk.Vmi(a,b,c,h):Rk.gni(a,b,c);c=new yi.a;if(a.Xyb(ke.a.north)||a.equals(ke.a.north))c.top=-1*b.y;if(a.Xyb(ke.a.east)||a.equals(ke.a.east))c.right=b.x;if(a.Xyb(ke.a.south)||a.equals(ke.a.south))c.bottom=b.y;if(a.Xyb(ke.a.west)||a.equals(ke.a.west))c.left=-1*b.x;return c}static Vmi(a,b,c,h){var m=b.qk(a),y=b.qk(a.w8a()),
G=b.qk(a.sYi());a=b.qk(a.tYi());var U=new ad.a(m._x+c.x,m._y+c.y);const ja=dD.b(y,G,U);b=dD.b(y,a,U);c=Rk.xTd(y,G,ja);m=Rk.xTd(y,a,b);b=ad.a.lm(b,U);U=ad.a.lm(ja,U);G=ad.a.lm(y,G);y=ad.a.lm(y,a);h?(y||(Ba.a.J(8959632,822,10,"ResizeHelper - shape has height 0"),y=1),G||(Ba.a.J(8959634,822,10,"ResizeHelper - shape has width 0"),G=1),h=G/y,!U||b/U>h?(b<Rk.K2&&(b=Rk.K2),U=b/h,U<Rk.K2&&(U=Rk.K2,b=U*h)):(U<Rk.K2&&(U=Rk.K2),b=U*h,b<Rk.K2&&(b=Rk.K2,U=b/h))):(b<Rk.K2&&(b=Rk.K2),U<Rk.K2&&(U=Rk.K2));return new ad.a(b*
c-G,U*m-y)}static gni(a,b,c){var h=a.ySc();a=a.rwb();h=b.qk(h);var m=b.qk(a);b=b.qk(a.w8a());a=ad.a.v9a(h,m);a.hM(c.x,c.y);c=dD.b(b,h,a);a=ad.a.lm(b,c);m=ad.a.lm(h,b);a<Rk.K2&&(a=Rk.K2);h=a*Rk.xTd(b,h,c)-m;return new ad.a(h,h)}static xTd(a,b,c){return b._x!==a._x?0>(c._x-a._x)/(b._x-a._x)?-1:1:0>(c._y-a._y)/(b._y-a._y)?-1:1}}Rk.K2=6;Object(n.a)(Rk,"ResizeHelper",null,[]);class Qs extends Cx{constructor(a,b,c,h,m,y,G,U,ja,va,Ta,fb,Db,gc,hc,Gc){super(Ta,gc);this.hla=this.l0=this.aHa=this.xoe=this.yoe=
this.Vd=this.YF=null;this.TGa=!1;this.gR=this.XQ=null;this.Fb=a;this.ia=b;this.HC=c;this.rXa=h;this.jE=m;this.QC=y;this.Pi=G;this.ve=U;this.Ea=ja;this.Pgc=va;this.dA=hc;this.fq=fb;this.He=Db;this.Sp=Gc}xv(a){if(!a||a.lA===Sys.UI.MouseButton.rightButton)return!1;this.gR=[];this.Vd=Object(ua.a)(117,this.QC.zI(a.Cc));if(!this.Vd||!this.Vd.YD(a.Cc))return!1;a=this.Vd.shapeNode;if(!a||!a.isResizable||this.HC.E_)return!1;this.YF=[];if(a.Vy)Array.add(this.YF,this.Vd);else{var b=this.rXa.Xd();(b=this.Ea.g9a(b))&&
this.rXa.Ckd(b);a.Jf&&this.rXa.tLf(a);b=this.rXa.sg();this.YF=Lh.d(b,this.Fb.Ma)}if(this.Ea.N3(this.Vd.shapeNode))Array.add(this.gR,new cD(this.Vd));else for(const c of this.YF){if(!this.ESj(c))return this.gR=null,!1;c.shapeNode.isResizable&&!c.shapeNode.ud&&Array.add(this.gR,new cD(c))}return!0}ESj(a){return 32!==this.ia.La(M.a.mMe,1,a.gb)||this.HC.E_||!a.yQ?!1:!0}A2g(a){if(!a||!this.xv(a))return!1;this.rXa.ij();this.jE.Ed();this.ia.processAction(M.a.S6a,2);this.hla=this.Vd.p4b();if(!this.Vd.YD(a.Cc))return!1;
null!==this.fq&&this.fq.iya(Mi.a.EMb);this.XQ=this.f3f(this.Vd.YD(a.Cc),this.Vd,this.hla,!1);this.aHa=this.Vra(a.clientPoint);({width:this.yoe,height:this.xoe}=this.BAf(this.hla,this.Vd.shapeNode.G_));this.l0=new ad.a(0,0);for(const c of this.gR){var b=c.Vd.p4b();a=c.Vd;let h,m;({width:h,height:m}=this.BAf(b,this.Vd.shapeNode.G_));const y=this.f3f(this.XQ,a,b,!0);c.O7k(b,a.vYa,h,m,y);a.uL=!0;a.OD(!0);b=Lh.c(a.shapeNode,this.Fb.Ma);a.shapeNode.Jf&&b.Ok&&(b.Ok.visible=!0)}this.TGa=this.Ea.N3(this.Vd.shapeNode)?
!0:1<this.YF.length?!1:!0;this.dA&&this.rXa.xL()&&this.ve.sNe();this.Sp&&this.ia.processAction(D.a.Cja,2);return!0}DFe(a){if(a){var b=this.Vra(a.clientPoint),c=ad.a.bV(b,this.aHa);this.l0=ad.a.add(this.l0,this.g3f(c,this.hla,!1));var h=null;c=this.TGa&&!this.Vd.shapeNode.Yx;for(const m of this.gR){let y=new ad.a(m.E0/this.yoe*this.l0.x,m.g0/this.xoe*this.l0.y);new yi.a;if(m.Vd.shapeNode.Vy){this.Vd.shapeNode.Vy&&(y=this.l0);if(!m.l3c)continue;h=Rk.rAf(m.l3c,y)}else h=Rk.rSd(m.l3c,m.o0,this.g3f(y,
m.o0,!0),m.Vd.shapeNode.Vy,m.Vd.shapeNode.isAspectRatioLocked||a.shiftKey);h=yi.a.add(m.ffc,this.TUf(h,m.o0));m.Vd.setOffsets(h,!c);m.Vd.shapeNode.Jf&&m.Vd.shapeNode.isEditable&&m.Vd.Xae()}this.aHa=b;a=this.Pgc.u5g(!0,this.TGa,this.Vd,this.XQ);c&&!a&&h&&this.Vd.setOffsets(h,!0)}}TUf(a,b){if(this.Ea.N3(this.Vd.shapeNode))return a;const c=new yi.a;c.left=b.uYc?a.right:a.left;c.right=b.uYc?a.left:a.right;c.top=b.kab?a.bottom:a.top;c.bottom=b.kab?a.top:a.bottom;return c}x2g(a){const b=[];for(var c=0;c<
this.gR.length;c++){let h=yi.a.bV(this.gR[c].Vd.vYa,this.gR[c].ffc);h=this.TUf(h,this.gR[c].o0);Array.add(b,new yz(this.gR[c].Vd.shapeNode,h,this.XQ,this.l0));this.gR[c].Vd.shapeNode.Jf&&this.gR[c].Vd.shapeNode.isEditable||(this.gR[c].Vd.uL=!1);this.gR[c].Vd.Oz(!1)}this.Vd.shapeNode.Yx?Fc.App.Kb.updateCommandUI():(c={},a&&a.pc&&a.pc.rawEvent&&(c[li.a.iDa]=a.pc.rawEvent.timeStamp),this.Ea.N3(this.Vd.shapeNode)?(this.Vd.fDa(),this.ia.La(M.a.zkh,2,b,c)):this.ia.La(M.a.vib,2,b,c));this.dA&&this.rXa.xL()&&
(a=this.rXa.bEa(),this.ve.Nhb(new Bx.a(a)));this.NK()}v2g(){if(this.gR){for(const a of this.gR)a.Vd.setOffsets(a.ffc,!0),a.Vd.uL=!1,a.Vd.Oz(!0);this.NK()}}NK(){this.Pgc.y5g(this.TGa);this.hla=this.xoe=this.yoe=this.Vd=this.YF=this.gR=this.XQ=this.l0=this.aHa=null;null!==this.fq&&this.fq.Lxa()}BAf(a,b){let c;var h=b?this.q4d(a):a;c=ad.a.lm(h.ga(0),h.ga(1));h=ad.a.lm(h.ga(0),h.ga(3));b||(a=te.a.UO(ad.a.IG(a.ga(0),a.ga(1))),Math.floor((a+45)/90)%2&&(a=h,h=c,c=a),c||(Ba.a.J(17622149,822,10,"ShapeResizeDragAdapter - shape {0} has width 0",
this.Vd.shapeNode.Cr),c=1),h||(Ba.a.J(17622151,822,10,"ShapeResizeDragAdapter - shape {0} has height 0",this.Vd.shapeNode.Cr),h=1));return{width:c,height:h}}f3f(a,b,c,h){if(b.shapeNode.Vy){if(this.Vd.shapeNode.Vy)return a;if(a.equals(ke.a.yE)||a.equals(ke.a.IH))return null;if(a.equals(ke.a.Ku)||a.equals(ke.a.RE))return c.ga(0).x>c.ga(1).x?a.w8a():a;if(b.shapeNode.G_){h=te.a.UO(ad.a.IG(c.ga(0),c.ga(1)));if(a.equals(ke.a.north)||a.equals(ke.a.south))return Math.abs(h-90)<Qs.Nec||Math.abs(h-270)<Qs.Nec?
c.ga(0).y<c.ga(1).y?a:a.w8a():null;if(a.equals(ke.a.east)||a.equals(ke.a.west))if(Math.abs(h-180)<Qs.Nec||360-h<Qs.Nec||h<Qs.Nec)return c.ga(0).x<c.ga(1).x?a:a.w8a()}return null}c=ad.a.IG(c.ga(0),c.ga(1));c=Math.floor((c+Math.PI/4)/(Math.PI/2));for(b=0;b<c;b++)a=h?a.ySc().ySc():a.rwb().rwb();return a}g3f(a,b,c){if(this.Vd.shapeNode.Vy||this.Ea.N3(this.Vd.shapeNode))return a;var h=ad.a.IG(b.ga(0),b.ga(1));const m=Math.floor((h+Math.PI/4)/(Math.PI/2))%4;h=b.ga(3-m);b=b.ga(3>m?2-m:3);h=ad.a.IG(h,b);
return c?new ad.a(Math.cos(h)*a.x-Math.sin(h)*a.y,Math.sin(h)*a.x+Math.cos(h)*a.y):new ad.a(Math.cos(h)*a.x+Math.sin(h)*a.y,Math.cos(h)*a.y-Math.sin(h)*a.x)}Vra(a){var b=this.Vd.N2(this.Pi.Pm(a.x)),c=this.Vd.N2(this.Pi.Pm(a.y));if(this.Ea.N3(this.Vd.shapeNode)){c=this.XQ;this.XQ.I8b()||(c=c.rwb());b=this.He.ii(this.Vd.IPa);b.x+=xf.a.wod;b.y+=xf.a.wod;b.width-=2*xf.a.wod;b.height-=2*xf.a.wod;var h=pj.a.Oca(b);b=h.qk(c);h=h.qk(c.w8a());c=b.y<=h.y?Math.min(a.y,h.y):Math.max(a.y,h.y);b=this.Vd.N2(this.Pi.Pm(b.x<=
h.x?Math.min(a.x,h.x):Math.max(a.x,h.x)));c=this.Vd.N2(this.Pi.Pm(c))}return new ad.a(b,c)}q4d(a){const b=ad.a.v9a(a.ga(0),a.ga(3));a=ad.a.v9a(a.ga(1),a.ga(2));return new pj.a(new ad.a(b.x,b.y),new ad.a(a.x,b.y),new ad.a(a.x,a.y),new ad.a(b.x,a.y))}}Qs.Nec=3;Object(n.a)(Qs,"ShapeResizeDragAdapter",Cx,[]);var OJ=d(191);class Az{constructor(a,b,c,h,m,y,G,U,ja,va,Ta,fb,Db){this.hwe=this.Dxe=null;this.efc=0;this.kze=this.Agc=null;this.f3c=0;this.wFg=8;this.ZPg=4;this.M3j="AngleUIRendered";this.pE=this.Vd=
null;this.Fb=a;this.ia=b;this.HC=h;this.X_=c;this.pa=m;this.jE=y;this.QC=G;this.Pi=U;this.jc=ja;this.je=va;this.fq=Ta;this.Sp=fb;this.EGa=Db}xv(a){if(!a||a.lA!==Sys.UI.MouseButton.leftButton||this.HC.E_)return!1;this.Vd=Object(ua.a)(117,this.QC.zI(a.Cc));return this.Vd&&this.Vd.Zje(a.Cc)?(this.pE=this.Vd.shapeNode)&&this.pE.vL&&this.Vd.yQ?!0:!1:!1}Nu(a){if(!a||!this.xv(a))return!1;this.pa.ij();this.jE.Ed();this.ia.processAction(M.a.S6a,2);null!==this.fq&&this.fq.iya(cf.a.cQ(this.je.pk("rotatehandlecursor.cur"),
Mi.a.kyh));this.efc=this.pE.get_shapeRotation();this.Agc=this.Vd.p4b().Xf();this.kze=this.Vd.Gvb().Xf();this.Dxe=this.Vra(a.clientPoint);this.Vd.Mka=!0;this.EGa&&this.gUe(!0);this.Vd.OD(!0);this.Sp&&this.ia.processAction(D.a.Cja,2);return!0}zw(a){if(!a)return!1;this.hwe=this.Vra(a.clientPoint);if(!this.hwe)return!1;this.f3c=te.a.UO(ad.a.IG(this.hwe,this.Agc))-te.a.UO(ad.a.IG(this.Dxe,this.Agc));let b=this.efc+this.f3c;this.EGa&&(b=this.Iwh(b));this.Vd.setRotation(Math.round(b),this.kze);this.EGa&&
(a=this.Vra(a.clientPoint,!1),this.$zl(a,Math.round(b)));return!0}Iwh(a){return this.Wgi(a)?10*Math.round(a/10):a}Wgi(a){0>a&&(a=(a+360)%360);return(a+this.ZPg/2)%90<=this.ZPg?!0:!1}$zl(a,b){var c=this.jc.mg(this.Vd.gb);c=Lh.e(c,this.Fb.Ma);c.yoc.DB(2);c.yoc.setPosition(a.x+this.wFg,a.y+this.wFg);c.yoc.xa.style.position="absolute";0>b&&(b+=360);c.yoc.xa.innerText=(b%360).toString()+"\u00b0"}gUe(a){const b=this.jc.mg(this.Vd.gb);Lh.e(b,this.Fb.Ma).yoc.Pd(a)}Zn(a){this.EGa&&this.gUe(!1);this.Vd.Mka=
!1;this.Vd.Oz(!1);var b=this.efc+this.f3c;this.EGa&&(b=this.Iwh(b));b=new So(this.pE,Math.round(b));const c={};a&&a.pc&&a.pc.rawEvent&&(c[li.a.iDa]=a.pc.rawEvent.timeStamp);this.EGa&&(c[this.M3j]=1);this.ia.La(M.a.toc,2,b,c);this.a3()}iu(){this.Agc&&(this.Vd.setRotation(this.efc,this.kze),this.EGa&&this.gUe(!1),this.Vd.Mka=!1,this.Vd.Oz(!0),this.a3())}Vra(a,b=!0){var c=this.jc.mg(this.Vd.gb);return(c=Lh.e(c,this.Fb.Ma).BB)?(a=ad.a.bSa(OJ.a.sSa(a,c)),b?new ad.a(this.Vd.N2(this.Pi.Pm(a.x)),this.Vd.N2(this.Pi.Pm(a.y))):
a):null}a3(){null!==this.X_&&this.X_.a1();null!==this.fq&&this.fq.Lxa();this.Fb.KR();this.Dxe=null;this.efc=0;this.Agc=null;this.f3c=0;this.Vd=this.pE=null}static getInstance(a){return Az.iC(a)}static iC(a){return new Az(a,vb.a.instance.resolve("Common.IActionManagerExtended"),vb.a.instance.resolve("Common.ICursorPinningTool"),vb.a.instance.resolve("PowerPointWebEditor.ViewCore.IFormatPainterContext"),vb.a.instance.resolve("PowerPointWebEditor.IPptSelectionManager"),vb.a.instance.resolve("PowerPointWebEditor.View.IFocusManagerHelper"),
vb.a.instance.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementUtility"),vb.a.instance.resolve("PowerPointWebEditor.IPPTUnitConversion"),vb.a.instance.resolve("PowerPointWebEditor.ISlideReader"),vb.a.instance.resolve("PowerPoint.IPathManager"),vb.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").pptCursorContainerManagerIsEnabled?vb.a.instance.resolve("PowerPointWebEditor.ShapeManipulation.ICursorContainerManager"):null,vb.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").pptTextFormatPainterIsEnabled,
vb.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").UJe)}}Object(n.a)(Az,"ShapeRotateDragAdapter",null,[244]);var eD=d(326);class PJ{constructor(a,b,c,h,m){this.Jm=this.Kr=null;if(!a)throw Error.argumentNull("actionManager");if(!b)throw Error.argumentNull("activeSlideViewManager");if(!c)throw Error.argumentNull("pageView");if(!h)throw Error.argumentNull("insertShapeOverlayViewStateManager");if(!m)throw Error.argumentNull("insertShapeOverlayViewElement");this.ia=a;this.Kc=b;this.Fb=c;
this.qWa=h}eRi(){if(this.Kr)return this.Kr;this.Kr=new xo.a;this.Kr.qr("MarqueeDiv");this.Kr.Yj(0);this.Kr.xa.style.borderStyle="solid";this.Kr.xa.style.borderWidth="thin";this.Kr.xa.style.borderColor="black";this.Kr.xa.style.opacity="0.5";this.Kr.Pd(!1);return this.Kr}$Dh(a,b){this.Kr&&this.Kr.ih(a,b)}ZDh(a,b){this.Kr&&this.Kr.setPosition(a,b)}NK(){this.Jm=null;this.Kr&&(this.Kr.Pd(!1),this.Kr.yq())}uQd(a){const b=this.Kc.Ic;if(!b||!b.me||!b.me.xa)return Ba.a.J(512497682,822,10,"Unable to attach marquee element to the slide view element"),
!1;b.me.xa.appendChild(a.xa);a.DB(2+eD.a.Taa);a.Pd(!0);return!0}xv(a){try{return a?a.lA===Sys.UI.MouseButton.rightButton?!1:1===this.qWa.Tcg?!0:!1:(Ba.a.J(512497681,822,10,"Event argument is null in isDragPossible"),!1)}catch(b){throw Ba.a.J(512497680,822,10,"Exception {0} occured in isDragPossible",b),b;}}Nu(a){try{if(!a)return Ba.a.J(512497679,822,10,"Event argument is null in OnDragStart"),!1;if(!this.xv(a))return!1;this.Jm=Zr.a(a.clientPoint,this.Kc.Ic);const b=this.eRi();if(!this.uQd(b))return!1;
this.ZDh(this.Jm.x,this.Jm.y);this.$Dh(0,0);return!0}catch(b){throw Ba.a.J(512497678,822,10,"Exception {0} occured in OnDragStart",b),b;}}zw(a){try{if(!a)return Ba.a.J(512497677,822,10,"Event argument is null in OnDragMove"),!1;if(!this.Fb.isActive)return!1;const b=Zr.a(a.clientPoint,this.Kc.Ic),c=Math.min(this.Jm.x,b.x),h=Math.min(this.Jm.y,b.y),m=Math.max(this.Jm.x,b.x),y=Math.max(this.Jm.y,b.y);this.ZDh(c,h);this.$Dh(m-c,y-h);return!0}catch(b){throw Ba.a.J(512497676,822,10,"Exception {0} occured in OnDragMove",
b),b;}}Zn(a){try{if(a)if(this.Jm){var b=Zr.a(a.clientPoint,this.Kc.Ic),c=Zr.b(Math.min(this.Jm.y,b.y),Math.max(this.Jm.y,b.y),Math.min(this.Jm.x,b.x),Math.max(this.Jm.x,b.x));this.ia.La(M.a.TWc,2,c);Rd.a("TelemetryForClickAndDragOperation")&&Ba.a.J(512497673,822,50,"TextboxDrawDragAdapter::OnDragEnd");this.NK()}else Ba.a.J(512497674,822,10,"m_dragBeginPosition should not be null in OnDragEnd");else Ba.a.J(512497675,822,10,"Event argument is null in OnDragEnd")}catch(h){throw Ba.a.J(512497672,822,
10,"Exception {0} occured in OnDragEnd",h),h;}}iu(){this.NK()}dispose(){this.NK();this.Kr=null}}Object(n.a)(PJ,"TextboxDrawDragAdapter",null,[244,106]);class Rs{constructor(a,b,c){this.$7c=0;this.xO=null;this.Iac=!1;this.wxe=this.t3c=null;this.lDb=new ad.a(0,0);this.sma=1;this.gj=a;this.Kc=b;this.O5j=c;this.O5j.$V(Object(F.a)(this,this.LYa,"onSlideNavigation"))}psb(a){return a?!0:!1}LYa(){this.sma=1;this.lDb=new ad.a(0,0);this.setTransform(new ad.a(0,0))}Wyb(a){if(!a)return!1;a=this.c6f(a.pc);return!!a&&
1<a.length}hHe(a){if(!a)return!1;this.$7c=this.gj.OU;if(!this.Wyb(a))return!1;this.xO=this.QSc(a.pc);return!1}Vjc(a){if(!a)return!1;this.Wyb(a)?(a=this.QSc(a.pc),this.xO||(this.xO=a),this.Pud(this.tni(this.xO,a))):this.Ytk(a);return!0}Ytk(a){a&&(a=this.QSc(a.pc),this.Iac?(a=this.kAf(this.t3c,a),this.setTransform(a)):(this.Iac=!0,this.t3c=a))}Zn(a){if(this.Iac&&a){a=this.QSc(a.pc);var b=this.kAf(this.t3c,a);a=b.x+this.lDb.x;b=b.y+this.lDb.y;this.Iac=!1;this.lDb=new ad.a(a,b)}}kAf(a,b){return!a||1>
a.length||!b||1>b.length?new ad.a(0,0):new ad.a(b[0].x-a[0].x,b[0].y-a[0].y)}setTransform(a){if(this.Kc&&this.Kc.Ic&&this.Kc.Ic.CU){var b=this.Kc.Ic.CU;this.wxe||(this.wxe=b.style.cssText);b.style.cssText=this.wxe+"  width:100%;height:100%; transform:translate("+(a.x+this.lDb.x+"px,"+(a.y+this.lDb.y)+"px) scale("+this.sma+","+this.sma+")")}}T8k(){this.setTransform(new ad.a(0,0))}JGb(a){if(!a)return!1;this.Zn(a);this.prl();return!1}Pud(a){this.$7c&&(a*=this.$7c,a<Rs.DYg?a=Rs.DYg:a>Rs.$Xg&&(a=Rs.$Xg),
this.gj.Bka=!1,this.sma=this.gj.OU=a,this.T8k())}jAf(a){if(!a||1>=a.length)return-1;const b=a.length;return Math.sqrt(Math.pow(a[0].x-a[b-1].x,2)+Math.pow(a[0].y-a[b-1].y,2))}tni(a,b){a=this.jAf(a);b=this.jAf(b);return-1!==a&&-1!==b&&a?b/a:0}c6f(a){let b=null;if(!a)return null;a=a.rawEvent?a.rawEvent:a;a.touches&&(b=a.touches,!b.length&&a.changedTouches&&(b=a.changedTouches));return b}QSc(a){let b=null;a=this.c6f(a);if(!a)return b;b=[];for(const c of a)Array.add(b,new ad.a(c.screenX,c.screenY));return b}prl(){this.$7c=
0;this.xO=null;this.Iac=!1;this.t3c=null}}Rs.DYg=1;Rs.$Xg=5;Object(n.a)(Rs,"ZoomSettingTouchAdapter",null,[1170]);var fQ=d(420);class QJ{constructor(a,b,c,h,m,y){this.Nwe=!1;this.Jm=null;this.Lve=!1;this.Fb=a;this.vJ=b;this.ob=c;this.Kc=h;this.Fa=m;this.ua=y;this.Kr=new xo.a;this.Kr.qr("Marquee");this.Kr.Yj(0);this.Kr.xa.style.backgroundColor="darkgrey";this.Kr.xa.style.opacity="0.5";this.Kr.Pd(!1)}uQd(){this.Kr&&(this.Kc.Ic.me.xa.appendChild(this.Kr.xa),this.Nwe=!0)}NK(){this.Jm=null;this.Kr&&(this.Kr.Pd(!1),
this.Kr.yq(),this.Nwe=!1);this.Lve=!1}xv(a){if(!a||a.lA===Sys.UI.MouseButton.rightButton)return!1;a=new fQ.a(a,this.Fb);return this.Fb.i$b(a)}Nu(a){if(!a||!this.Fb.isActive||!this.xv(a))return!1;this.vJ.keh(new Np(!0));a.ctrlKey||a.shiftKey?Ba.a.J(8959586,816,50,"MarqueeSelectDragAdapter used: Ctrl {0}, Shift {1}",a.ctrlKey,a.shiftKey):this.ob.Qh();this.Fa.Ed();this.Lve=a.shiftKey?!0:!1;this.Jm=this.Vra(a.clientPoint);this.Nwe||this.uQd();this.Kr.setPosition(this.Jm.x,this.Jm.y);this.Kr.ih(0,0);this.Kr.DB(1+
eD.a.Taa);this.Kr.Pd(!0);return!0}zw(a){if(!a||!this.Fb.isActive)return!1;var b=this.Vra(a.clientPoint);a=Math.min(this.Jm.x,b.x);const c=Math.min(this.Jm.y,b.y),h=Math.max(this.Jm.x,b.x);b=Math.max(this.Jm.y,b.y);this.Kr.setPosition(a,c);this.Kr.ih(h-a,b-c);return!0}Zn(a){if(a){var b=this.Vra(a.clientPoint);a=Math.min(this.Jm.x,b.x);var c=Math.min(this.Jm.y,b.y),h=Math.max(this.Jm.x,b.x);b=Math.max(this.Jm.y,b.y);var m=this.ua.Ba,y=m?m.Pk():[];m=[];var G=[],U=this.ob.Xd();for(const ja of y)(y=Object(ua.a)(117,
ja.sc(this.Fb.Ma)))&&y.yQ&&(y.$p?y.zpd():(y=y.X9d(!1),y.hc>=a&&y.kc>=c&&y.Zb<=h&&y.Xb<=b&&(this.Lve?Array.contains(U,ja)?G.push(ja):m.push(ja):Array.contains(U,ja)||m.push(ja))));0<m.length&&this.ob.s_a(m,!1);0<G.length&&this.ob.fsa(G);this.NK()}}iu(){this.Jm&&this.NK()}Vra(a){const b=this.Kc.Ic.BB;return b?ad.a.bSa(OJ.a.sSa(a,b)):ad.a.bSa(a)}dispose(){this.Jm&&this.NK();this.Kr=null}}Object(n.a)(QJ,"MarqueeSelectDragAdapter",null,[244,106]);class RJ{constructor(a){this.uX=null;this.aji(a);this.rae=
!1}aji(a){null!==a&&(this.uX=cf.a.Fe(),this.uX.style.position=Mi.a.absolute,this.uX.style.top="0px",this.uX.style.left="0px",a.appendChild(this.uX))}iya(a){null!==a&&null!==this.uX&&null!==this.uX.parentNode&&(this.uX.style.cursor=a,this.uX.style.zIndex=String(Mi.a.OFl),this.uX.style.height="100%",this.uX.style.width="100%",this.rae=!0)}Lxa(){if(null!==this.uX||this.rae)this.uX.style.height="0px",this.uX.style.width="0px",this.uX.style.cursor=Mi.a.kyh,this.uX.style.zIndex="-1",this.rae=!1}}Object(n.a)(RJ,
"CursorContainerManager",null,[529]);class fD{constructor(){this.K=null}get name(){return"PowerPointWebEditor.ShapeManipulation"}$b(a){this.K=a;a.register(529,"PowerPointWebEditor.ShapeManipulation.ICursorContainerManager").ma().oa(()=>new RJ(a.resolve("PowerPointWebEditor.AppFrame").N1));a.register(aD,"PowerPointWebEditor.ShapeManipulationActor").ma().oa(()=>new aD(a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),new jp(a.resolve("Common.IActionManagerExtended")),a.resolve("Common.Transaction.ITransactionFactory"),a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventNotifier"),a.resolve("PowerPointWebEditor.IApplicationSettings").powerPointEditSmartArtTextPaneIsEnabled,a.resolve("PowerPointWebEditor.IApplicationSettings").fRe,
a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventSource"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.WebSocketFrontDoor.IWebSocketFrontDoor"),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.resolve("PowerPointWebEditor.IPPTUnitConversion"),a.resolve("PowerPointWebEditor.IZoomContext"),a.resolve("Common.Utils.IHighContrastDetector"),a.resolve("Gc2.IGlyphStore")));a.register(bD,"PowerPointWebEditor.ShapeManipulation.PPTDragSelectionDragAdapter").as("PowerPointWebEditor.ShapeManipulation.IPPTDragSelectionDragAdapter").ma().oa(()=>
new bD(a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("Common.IActionManagerExtended"),a.resolve("Common.IActivityManager"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IShapeReader"),na.InteractiveViewManager.instance,a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementUtility"),a.resolve("Box4.Graph.IGraphIteratorFactory"),a.resolve("PowerPointWebEditor.IApplicationSettings").pptCursorContainerManagerIsEnabled?
this.K.resolve("PowerPointWebEditor.ShapeManipulation.ICursorContainerManager"):null,a.resolve("PowerPointWebEditor.IPptTableDragSelectionHelper"),a.resolve("PowerPointWebEditor.Graph.ITableReader")));a.register(530,"PowerPointWebEditor.IPptTableDragSelectionHelper").ma().oa(()=>new LJ(a.resolve("Box4.IPageView").Ma,a.resolve("Box4.IPageView").Ld,a.resolve("PowerPointWebEditor.Graph.ITableReader")))}init(){this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointTextEditOnlyMode||this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointTouchZoomEnabled||
this.pBj();this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointTouchZoomEnabled&&this.gCj();this.dBj()}gCj(){const a=this.K.resolve("PowerPointWebEditor.IZoomContext");this.K.resolve("PowerPointWebEditor.View.IPPTPageViewDomManager").YOk(new Rs(a,this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers")))}pBj(){var a=this.K.resolve("PowerPointWebEditor.View.IPPTPageView");const b=this.K.resolve("Common.IActionManagerExtended");
var c=this.K.resolve("PowerPointWebEditor.ViewCore.IFormatPainterContext");const h=this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),m=this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptCursorContainerManagerIsEnabled?null:this.K.resolve("Common.CursorManager"),y=this.K.resolve("PowerPointWebEditor.View.IFocusManagerHelper"),G=this.K.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementUtility"),U=this.K.resolve("PowerPointWebEditor.IPPTUnitConversion"),ja=this.K.resolve("PowerPointWebEditor.ISlideReader"),
va=this.K.resolve("PowerPointWebEditor.IShapeReader"),Ta=this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventNotifier"),fb=this.K.resolve("PowerPointWebEditor.ISmartGuideManager"),Db=this.K.resolve("PowerPointWebEditor.Core.IPauseTheWorldManager"),gc=this.K.resolve("PowerPoint.IPathManager"),hc=this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptCursorContainerManagerIsEnabled?this.K.resolve("PowerPointWebEditor.ShapeManipulation.ICursorContainerManager"):null,Gc=!!window.requestAnimationFrame&&
!!window.cancelAnimationFrame;this.K.resolve("PowerPointWebEditor.View.IPPTPageViewDomManager").lJb(2,this.K.resolve("PowerPointWebEditor.ShapeManipulation.IPPTDragSelectionDragAdapter"));this.K.resolve("PowerPointWebEditor.View.IPPTPageViewDomManager").lJb(1,new NJ(a,b,m,U,this.K.resolve("Box4.IUndoManager"),c,h,y,G,va,this.K.resolve("PowerPointWebEditor.Graph.ITableReader"),Ta,fb,Db,hc,Gc,this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointEditSmartArtTextPaneIsEnabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptTextFormatPainterIsEnabled),
new Qs(a,b,c,h,y,G,U,Ta,va,fb,Db,hc,this.K.resolve("PowerPoint.IBrowserHelperManager"),Gc,this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointEditSmartArtTextPaneIsEnabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptTextFormatPainterIsEnabled),new Az(a,b,m,c,h,y,G,U,ja,gc,hc,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptTextFormatPainterIsEnabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").UJe),new QJ(a,this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventNotifier"),
h,this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager")));c=new MJ(b,this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.K.resolve("PowerPointWebEditor.IPPTUnitConversion"),a,this.K.resolve("PowerPointWebEditor.IInsertShapeOverlayViewStateManager"),this.K.resolve("PowerPointWebEditor.IInsertShapeOverlayViewElement"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"));
this.K.resolve("PowerPointWebEditor.View.IPPTPageViewDomManager").Zfh(c);this.K.resolve("PowerPointWebEditor.IApplicationSettings").Yxb&&(a=new PJ(b,this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),a,this.K.resolve("PowerPointWebEditor.IInsertShapeOverlayViewStateManager"),this.K.resolve("PowerPointWebEditor.IInsertShapeOverlayViewElement")),this.K.resolve("PowerPointWebEditor.View.IPPTPageViewDomManager").Zfh(a));Ba.a.J(509691227,813,50,"Shape manipulation drag adapter init complete")}dBj(){const a=
this.K.resolve("PowerPointWebEditor.ShapeManipulationActor");a.De();a.vb()}dispose(){}static main(){r.a.instance.Dc(new fD)}}Object(n.a)(fD,"PPTWebEditorShapeManipulationPackage",null,[2,3]);var gQ=d(1135),Dx=d(1191),cr=d(113);class Ex{constructor(a,b,c,h,m,y,G,U){this.pwe=null;this.ewe=new Date;this.OQ=a;this.X9j=b;this.udk=c;this.v4j=h;this.H9j=m;this.nHa=y;G.Eb(new He.a(U,2,this.v4j,Object(F.a)(this,this.BCf,"checkTask"),90,"61"))}BCf(){this.Ful()}Ful(){var a=new Date;const b=+new Date-+this.pwe>
this.udk;if(!(this.ewe<this.pwe)||b){if(+a-+this.ewe<this.X9j)return;this.OQ()}a=+new Date-+a;a>this.H9j&&Ba.a.J(8958035,813,10,"PrefetchManager::PrefetchThrottler::TryPrefetchIfAppropriate() took too long to check  prefetch: {0}ms for {1}",a,this.nHa)}krd(){this.pwe=new Date}grd(){this.ewe=new Date}}Object(n.a)(Ex,"PrefetchThrottler",null,[]);class Dp{constructor(a,b,c,h,m,y,G,U,ja,va,Ta,fb,Db,gc,hc,Gc,Pc){this.Qld=250;this.mdc=this.Hbc=null;this.Pdc=this.ydc=!1;this.VDb=[];this.Nli=5;this.Izf=10;
this.WDb=[];this.Oli=5;this.cXa=!1;this.ZVg=this.ZI=this.H1c=null;this.z6c=!1;this.uye=[];this.Vb=a;this.ua=b;this.mH=c;this.vj=h;this.npe=m;this.az=Pc;this.Gma=y;this.Ga=G;this.zb=U;this.jc=ja;this.Bv=va;this.dM=Ta;this.qd=fb;this.ack=Db;this.Oc=gc;this.Rk=hc;this.fy=Gc;this.Sbk=this.Ga.KQj;this.rak=u.AFrameworkApplication.fa.ka("PrefetchThrottlerNormalPriorityEnabled");this.qak=u.AFrameworkApplication.fa.ka("PrefetchLookaheadSlideEnabled");!v.a.Ni||this.Ga.LQj?this.setEnabled(this.Ga.yJj,this.Ga.RMj):
this.setEnabled(!1,!1);this.I8c=this.Ga.prefetchSlideForwardMax;this.H8c=this.Ga.prefetchSlideBackwardMax;this.q5j=u.AFrameworkApplication.fa.ka("PodDisableAlwaysPrefetchSlidesInVisibleRange");this.T_k=u.AFrameworkApplication.fa.Fc("SlidePrefetchLookaheadCount",0);this.rH=!1;this.Oc.GA(Object(F.a)(this,this.kM,"onSessionClosed"));this.Oc.rPa(Object(F.a)(this,this.L0,"onSessionRehydrating"));this.Oc.WB(Object(F.a)(this,this.Bo,"onSessionRehydrated"));u.AFrameworkApplication.fa.ka("SlidePrefetchThrottlerMinDelayReduced")&&
(this.Qld=125);this.fy&&this.fy.OEa(()=>{this.Zkl()})}Zkl(){this.ZVg=new He.a(2,1,this.Qld,Object(F.a)(this,this.updateSlidePrefetchRange,"updateSlidePrefetchRange"),90,"59");this.z6c=!1;const a=this.rak?2:3;this.Hbc=new Ex(Object(F.a)(this,this.Dul,"tryPrefetchContentModel"),this.Qld,Dp.U_k,Dp.wmh,Dp.qmh,"content model",this.zb,a);this.qd.Iqb(Object(F.a)(this,this.QYa,"onVisibleThumbnailsChanged"));this.Rk.kI(Object(F.a)(this,this.sB,"onActiveSlideChanged"));this.mdc=new Ex(Object(F.a)(this,this.Gul,
"tryPrefetchImages"),this.Qld,Dp.S_k,Dp.wmh,Dp.qmh,"image",this.zb,3);this.dM&&(this.dM.mia(Object(F.a)(this,this.Hng,"loadedHandler")),this.dM.ik(Object(F.a)(this,this.pch,"propertyChangedHandler")))}get Cf(){this.H1c&&this.H1c.isConnected||(this.H1c=this.Vb.Cf);return this.H1c}get Ba(){this.ZI||(this.ZI=this.ua.Ba);return this.ZI}setEnabled(a,b){this.ydc=a;this.Pdc=b}bdd(){this.VDb=[];this.WDb=[];this.cXa=!1}dispose(){this.qd.wih(Object(F.a)(this,this.QYa,"onVisibleThumbnailsChanged"));this.Rk.F5(Object(F.a)(this,
this.sB,"onActiveSlideChanged"));this.Oc.baa(Object(F.a)(this,this.kM,"onSessionClosed"));this.Oc.nkd(Object(F.a)(this,this.L0,"onSessionRehydrating"));this.Oc.Dfa(Object(F.a)(this,this.Bo,"onSessionRehydrated"));this.dM&&(this.dM.OZa(Object(F.a)(this,this.Hng,"loadedHandler")),this.dM.Cm(Object(F.a)(this,this.pch,"propertyChangedHandler")))}kM(){this.rH=!0}L0(){this.bdd()}Bo(){this.rH=!1}Dul(){this.ydc&&this.Dth()&&this.xDk()}xDk(){var a=this.S9d();const b=this.cXa?null:Mr.b(a,c=>c?c.Cb:null);(a=
this.Z9g(0,a))?(a=a.Cb,this.Hbc&&this.Hbc.krd(),this.Bv.prefetchSlide(a,b,()=>{this.cXa=!0}),this.CGk(a)):this.cXa||this.Bv.prefetchSlide(lc.a.empty,b,()=>{this.cXa=!0})}sB(){this.ZI=null;this.cXa=!1}QYa(){this.Ssl();this.cXa=!1}Hng(a,b){(a=Object(ua.a)(116,b.node))&&a.aE&&this.fjc(a)}pch(a,b){a=b.property;b.node&&a===X.a.cid&&(this.cXa=!1)}fjc(a){if(a.isConnected){var b=Object(ua.a)(116,a);b&&(b.oFa=!0,this.zb.Eb(new He.a(2,1,0,Object(F.a)(this.mdc,this.mdc.BCf,"checkTask"),90,"60")),u.AFrameworkApplication.fa.ka("PPTOTextPreloadServiceFonts")&&
(Array.clear(this.uye),this.JNd(b.yUf),this.JNd(b.cBh),this.JNd(b.LEh),b=new He.a(3,1,0,Object(F.a)(this,this.Eul,"tryPrefetchFonts"),90,"114"),b.customData=this.uye,this.zb.Eb(b)))}this.Hbc&&(this.Hbc.grd(),this.VDb=[]);a.cza=!0;this.Gma.O0a()}CGk(a){this.VDb.length>=this.Izf&&(this.VDb=[]);Array.add(this.VDb,a)}JNd(a){if(!ta.a.Wa(a)){a=a.split(",");for(const b of a)this.uye.push(b)}}Z9g(a,b=null){const c=this.Ba;if(!c||!c.isConnected)return null;b||(b=this.S9d());return this.scj(c,a,b)}scj(a,b,
c){for(const h of c)if(h)if(c=h.Cb,this.Vwj(c))Ba.a.J(512497862,813,50,"PrefetchManager::PickBestSlide() prefetching content model for slide={0} and fetchType={1} failed many times",c,b);else if(this.bdl(h,b)){const m=a.Cb;a=this.jc.F5b(a);const y=this.jc.F5b(h);Ba.a.J(512497861,813,50,"PrefetchManager::PickBestSlide() prefetching {0} at {1} with offset {2} from currentSlide {3} at {4} for fetchType={5}",c,y,y-a,m,a,b);return h}return null}Vwj(a){let b=0;for(const c of this.VDb)a.equals(c)&&(b+=1);
if(b>=this.Nli)return!0;b=0;for(const c of this.WDb)a.equals(c)&&(b+=1);return b>=this.Oli}bdl(a,b){if(!a)return!1;const c=a.Cb;if(lc.a.ax(c))return!1;const h=!!a&&a.aE;if(0===b)return!h;if(!h||!a.oFa)return!1;b=a.HTa(new cr.a(a.oq,a.Wk));if(null===b)return Ba.a.J(512497860,813,50,"PrefetchManager::ShouldPrefetchSlide() null images for {0}",c),!1;for(const m of b)if(!this.mH.PVc.bld(m).data)return!0;return a.oFa=!1}Gul(){if(this.Pdc&&this.Dth()){const b=this.Z9g(1);if(b){var a=b.Cb;this.mdc.krd();
this.mVi(b);this.DGk(a)}}}Eul(a){a=Array.isArray(a.customData)?a.customData:null;for(const b of a)this.az.INi(b)}Dth(){return this.rH||!this.Sbk&&2===this.vj.tca||!this.Cf||this.npe.Xta(this.Cf)||!this.Ba||this.Ba.tL?!1:!0}DGk(a){this.WDb.length>=this.Izf&&(this.WDb=[]);Array.add(this.WDb,a)}mVi(a){if(a){var b=a.HTa(new cr.a(a.oq,a.Wk));b&&0<b.length?this.mH.$ub(b,!0,()=>{this.mdc.grd();this.WDb=[];a.oFa=!1},u.AFrameworkApplication.fa.ka("FetchSlideImageBatchInRealTimeEnabled")):a.oFa=!1}}Ssl(){this.z6c||
(this.zb.Eb(this.ZVg),this.z6c=!0)}updateSlidePrefetchRange(){this.z6c=!1;this.Bv.syncCurrentSlideIdAndPrefetchRange(this.Ba,null,this.Gma.fpa,null)}smj(){return Mr.b(this.S9d(),a=>a?a.Cb:null)}S9d(){var a=this.Ba;if(!a||!a.isConnected)return[];a=this.jc.F5b(a);var b=this.ua.presentation;if(!b)throw Error.argumentNull("Presentation is null");b=b.slides||[];const c=b.length,h=[],m=[];if(!this.q5j)for(var y of this.Gma.fpa.F3)y!==a&&y<c&&(Array.add(m,b[y]),h[y]=!0);if(this.qak&&!h.length)for(y=1;y<=
this.T_k;y++){const G=this.Gma.fpa.lastIndex+y;G!==a&&G<c&&(Array.add(m,b[G]),h[G]=!0)}if(0<=a){a=this.ack.t4f(a,b.length,this.I8c,this.H8c);for(const G of a)if(void 0===h[G]||null===h[G])h[G]=!0,Array.add(m,b[G])}return m}}Dp.wmh=1E3;Dp.U_k=2E3;Dp.S_k=6E4;Dp.qmh=500;Object(n.a)(Dp,"PrefetchManager",null,[518,106]);class gD{constructor(a,b,c,h){this.vi=b;this.rE=c;this.pa=h;this.Oc=a;this.Oc.qPa(Object(F.a)(this,this.ygb,"onSessionEnding"))}ygb(a,b){if(this.pa.pC()){a=this.pa.Xd();if(!a.length){const c=
this.pa.W3f();c&&a.push(c)}for(const c of a)this.vi.N6a(c)}this.rE.wZi(b.fG)}dispose(){this.Oc.qPe(Object(F.a)(this,this.ygb,"onSessionEnding"))}}Object(n.a)(gD,"SessionCleanupHandler",null,[106]);var SJ=d(432),hQ=d(944);class hD{constructor(a,b,c,h,m,y,G,U,ja,va,Ta,fb,Db){this.bDd=this.kzc=this.Lze=!1;if(!b)throw Error.argumentNull("taskManager");if(!c)throw Error.argumentNull("context");this.Ga=a;this.tgc=a.sessionTimeoutInMs;this.zb=b;this.iE=c;this.pa=h;this.bWa=m;this.BC=y;this.Qd=G;this.ua=
U;this.fc=ja;this.Lm=va;this.oSg=Ta;this.Qo=fb;this.Urg=Db;this.sgc=0}get Sca(){return this.bWa.instance}get S3(){return u.AFrameworkApplication.Tg}get Ujg(){return 1===this.sgc}get xzb(){return this.kzc}get c_c(){return this.bDd}get fG(){return this.sgc}set fG(a){this.sgc=a}get cBf(){return this.Ga.podsSeamlessFailoverEnabled&&!!this.Qo.instance}start(){if(!this.S3){var a=new He.a(4,2,3E4,Object(F.a)(this,this.lXg,"manageLifetime$p"),90,"56");this.zb.Eb(a)}}Yek(){this.lXg(null)}lXg(){if(!this.Lze){var a=
+new Date-+Nc.a.T$b;a>this.tgc&&this.YSi(a);u.AFrameworkApplication.Rz&&u.AFrameworkApplication.fa.ka("WOPITokenRefreshStopWhenOutOfRangeIsEnabled")&&a>=this.Ga.wopiTokenRefreshMaxDurationInMs&&this.BC.gLk()}}YSi(a){this.S3||(this.bEf(2),this.cBf?this.Urg.instance&&this.Urg.instance.e$a&&(Ba.a.J(512360777,805,15,"SessionLifetimeManager::ExpireSession - ShowCustomizedTimeoutMessageForCommentDraft"),Mf.Health.instance.recordQosError("TimeoutDialogForCommentDraft",["SessionExpired"],!0,!0,!1,!0,null),
this.oSg.Ahl()):this.oSg.zhl(),this.BC.hKk(),Ba.a.J(512360776,801,15,"SessionLifetimeManager::ExpireSession - Session has expired after idle {0}, timeout {1}. CanRehydrate:{2}; ValidFailoverInstance:{3}; SeamlessFailoverEnabled:{4};",a,this.tgc,this.cBf,!!this.Qo.instance,this.Ga.podsSeamlessFailoverEnabled))}closeSession(a=1){this.bEf(a)}bEf(a){0===a&&Ba.a.J(512360775,801,50,"SessionCloseReason should not be unknown!");if(!this.S3)try{this.kzc=!0,Ba.a.J(512360774,801,15,"SessionLifetimeManager::CloseSession() - closing session, reason:{0}",
SJ.a[a]),this.sgc=a,this.pa.setSelection(null),u.AFrameworkApplication.Tg=!0,this.iE.y9a().Jdd=!0,this.Qd.disabled=!0,Cf.a.Ww&&4!==a&&Cf.a.Ww.hide(),this.BC.eNe(new hQ.a(a)),this.Sca&&0<this.Sca.oDa.count&&this.Sca.tnc(this.iE.MSa().presentationId,"instanceId",!0,!1),this.Ga.podsSeamlessFailoverEnabled&&this.Qo.instance&&(1===a?this.Qo.instance.yMd("abortedOnExitApp"):this.Qo.instance.yMd("SessionClose_"+a)),this.zb.stop(),this.Lm.isPaused||this.Lm.pause(),4!==a&&2!==a&&this.fc.blockContent(this.ua.presentation,
"CloseSession",!0),this.BC.jjd(new bl.a(a))}finally{this.bDd=this.kzc=!1}}gil(){this.Lze=!0}jZk(){this.Lze=!1}markSessionClosingAtForceSave(a){Ba.a.J(512360773,801,15,"SessionLifetimeManager::MarkSessionClosingAtForceSave reason:{0}",SJ.a[a]);this.bDd=this.kzc=!0;this.sgc=a}}Object(n.a)(hD,"SessionLifetimeManager",null,[1213]);var cg=d(422);class TJ{constructor(){this.trigger=null;this.Daa=this.kkb=this.w0a=0;this.SVd={}}}Object(n.a)(TJ,"SuggestionsInfo",null,[]);class UJ{constructor(){this.SessionID=
this.SerializedUser=this.BaseDocQueryStringWithoutVersion=null}}Object(n.a)(UJ,"StartRtcConnectionRequest",null,[]);class VJ{constructor(){this.SessionID=null}}Object(n.a)(VJ,"StopRtcConnectionRequest",null,[]);var iQ=d(283);class WJ{constructor(a,b){this.slideId=a;this.imageId=iQ.a.SKc(b)}}Object(n.a)(WJ,"ThumbnailImageId",null,[]);var Ss=d(295);const XJ=a=>{let b,c,h;var m;let y,G;b=null;h=c=0;y=m=null;G=-1;return(a=a.match(RegExp("/IncSuggestion/(.*),(\\d+),(\\d+),(\\d+),(\\d+),(.*),(\\d+)")))&&
8===a.length?(b=a[1],c=Number.parseInvariant(a[2]),h=Number.parseInvariant(a[3]),m=Object.assign(new Ss.a,{Sid:Number.parseInvariant(a[4]),Cid:Number.parseInvariant(a[5])}),m=new lc.a(m),y=a[6],G=Number.parseInvariant(a[7]),{returnValue:!0,correlationID:b,cV:c,Daa:h,slideID:m,trigger:y,kkb:G}):{returnValue:!1,correlationID:b,cV:c,Daa:h,slideID:m,trigger:y,kkb:G}},jQ=a=>{const b=new Qa.a;try{const c=dd.a(a);for(const h of c.SlideSuggestions)b.add(h.Index)}catch(c){Ba.a.J(42342594,829,10,"ContentKeyHelper:TryGetSuggestionIndexesListFromValue - parsing suggestionResults failed.")}return b};
var Bz;(function(a){a[a.none=0]="none";a[a.alone=1]="alone";a[a.coauthoring=2]="coauthoring"})(Bz||(Bz={}));Object(n.b)("CoauthorStatus",Bz);class YJ extends Sys.EventArgs{constructor(a){super();this.pia=a}}Object(n.a)(YJ,"AppliedPolicyIdEventArgs",Sys.EventArgs,[]);class ZJ extends Sys.EventArgs{constructor(a){super();this.OOc=a}}Object(n.a)(ZJ,"FileRevisionHistoryEventArgs",Sys.EventArgs,[]);class $J extends Sys.EventArgs{constructor(a,b,c,h,m){super();this.qUc=a;this.EOc=b;this.fMj=c;this.confidence=
h;this.imageDescription=m}}Object(n.a)($J,"ImageDescriptionReadyEventArgs",Sys.EventArgs,[]);class aK extends Sys.EventArgs{constructor(a){super();this.p9b=a}}Object(n.a)(aK,"IsManuallyAppliedEventArgs",Sys.EventArgs,[]);class bK extends Sys.EventArgs{constructor(){super()}}Object(n.a)(bK,"CommentsChangedEventArgs",Sys.EventArgs,[]);class cK extends Sys.EventArgs{constructor(a){super();this.p2d=a}}Object(n.a)(cK,"FindRtcSessionEventArgs",Sys.EventArgs,[]);class dK extends Sys.EventArgs{constructor(){super()}}
Object(n.a)(dK,"LastMergeEditUTCChangedEventArgs",Sys.EventArgs,[]);class eK extends Sys.EventArgs{constructor(){super()}}Object(n.a)(eK,"RealTimeEditEventArgs",Sys.EventArgs,[]);class iD extends Sys.EventArgs{constructor(a,b=null){super();this.Eck=a;this.R5j=b}get izh(){return this.Eck}get nTi(){return this.R5j}}Object(n.a)(iD,"SyncLoopStatusNotifiedEventArgs",Sys.EventArgs,[]);class fK extends Sys.EventArgs{constructor(a){super();this.gEk=a}}Object(n.a)(fK,"PresentationLastModifiedTimeReceivedEventArgs",
Sys.EventArgs,[]);var kQ=d(871);class gK extends Sys.EventArgs{constructor(a){super();this.slideId=a}}Object(n.a)(gK,"DesignerSuggestionCoauthModifiedEventArgs",Sys.EventArgs,[]);class Cz extends Sys.EventArgs{constructor(a,b,c,h,m,y,G){super();this.ice=!1;this.trc=null;this.correlationId=a;this.w0a=b;this.Daa=c;this.trigger=m;this.slideId=y;this.UCa=G;this.fLa=h}}Object(n.a)(Cz,"DesignerSuggestionsUpdatedEventArgs",Sys.EventArgs,[]);class Fx extends Sys.EventArgs{constructor(a,b,c){super();this.correlationId=
a;this.slideId=b;this.UCa=c}}Object(n.a)(Fx,"FixItSuggestionUpdatedEventArgs",Sys.EventArgs,[]);class hK extends Sys.EventArgs{constructor(a,b,c,h){super();this.slideId=a;this.QY=c;this.shapeId=b;this.UCa=h}}Object(n.a)(hK,"IconSuggestionUpdatedEventArgs",Sys.EventArgs,[]);class iK extends Sys.EventArgs{constructor(a,b,c,h,m,y){super();this.correlationId=a;this.Gda=b;this.slideId=c;this.shapeId=h;this.aKa=m;this.UCa=y}}Object(n.a)(iK,"ReplaceObjectUpdatedEventArgs",Sys.EventArgs,[]);class Dz extends Sys.EventArgs{constructor(a){super();
this.Yje=!1;this.Yje=a}}Object(n.a)(Dz,"ToggleChatPPTPaneEventArgs",Sys.EventArgs,[]);class jK extends Sys.EventArgs{constructor(a){super();this.eQj=a}}Object(n.a)(jK,"PictureRenderSuccessEventArgs",Sys.EventArgs,[]);var lQ=d(375);class jD{constructor(a,b,c,h,m,y,G,U,ja,va,Ta,fb,Db,gc,hc,Gc,Pc,yc,Vd,De,Wd,Ve,$e,Qf,lg){this.Qre=this.Ire=!1;this.GDg=null;this.jFg={};this.Gma=b;this.hl=lg;this.Eq=m;this.K2c=y;this.Vb=U;this.ua=ja;this.Bv=va;this.G8c=Ta;this.Qd=fb;this.BC=Db;this.ve=gc;this.O2c=hc;this.Fu=
Gc;this.Xa=a;this.BO=Pc;this.BDb=yc;this.Oc=Vd;this.o3c=c;this.Ga=De;this.Vt=Wd;this.zb=Ve;this.Fv=$e;this.mc=Qf;this.SAg=this.Ga.wg&&this.Ga.pptNoRtcConnectWhenReadOnlyEnabled;this.Oc.qPa(Object(F.a)(this,this.vB,"onSessionEnd"));this.Oc.GA(Object(F.a)(this,this.J2d,"flushOnSessionEnd"));this.o3c.ssf(Object(F.a)(this,this.k4g,"onNormalChannelDocNotifyClientItemsUpdated"));h&&h.ssf(Object(F.a)(this,this.k4g,"onNormalChannelDocNotifyClientItemsUpdated"));this.Ga.podsTriggerServerRtcConnectionFromBrowserIsEnabled&&
this.Oc.WB(Object(F.a)(this,this.Q$,"onPodSessionRehydrated"));this.SAg&&this.Oc.z7(Object(F.a)(this,this.Aw,"onUnifiedAppStateChanged"))}k4g(a,b){this.Xnk(b,this.K2c)}Xnk(a,b){let c=!1;const h=[],m=[],y=new TJ;for(const yc of a.items){const Vd=new Date,De=this.Vt.aFa;var G=void 0,U=void 0,ja=void 0,va=void 0,Ta=void 0,fb=void 0;if(yc.Key===cg.a.Xah)b.w6d(cg.a.Xah)>yc.TimeStamp||(Ba.a.J(512497797,813,50,"Need to reload the whole presentation."),c=!0);else{var Db=void 0;Db=null;(U=yc.Key.match(RegExp("/Thumb\\[(\\d+),(\\d+)\\]/ID\\[(\\d+),(\\d+)\\]")))&&
5===U.length?(Db=new Ss.a,Db.Sid=Number.parseInvariant(U[3]),Db.Cid=Number.parseInvariant(U[4]),Db=new lc.a(Db),U={returnValue:!0,slideId:Db}):U={returnValue:!1,slideId:Db};if(({slideId:U}=U).returnValue)U=cg.a.D9d(U.sid,U.cid),b.w6d(U)>=yc.TimeStamp||(U=Sys.Serialization.JavaScriptSerializer.deserialize(yc.Value),Array.add(h,new kQ.a(U,0<U.SnapshotTimeStamp?U.SnapshotTimeStamp:yc.TimeStamp)));else if(yc.Key.startsWith(cg.a.GOf))U=Sys.Serialization.JavaScriptSerializer.deserialize(yc.Value),this.Eq.tGh(U),
Ba.a.J(512497796,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Notify clientID to websession; clientId: {0};",U);else if(yc.Key===cg.a.XOi)U=Sys.Serialization.JavaScriptSerializer.deserialize(yc.Value),Ba.a.J(512497795,817,50,"CoauthNotificationManager::OnDocNotifyClientItemsUpdated - EditorTable; LastRequestCorrelationID:{0}; TimeStamp:{1}; EditorsCount:{2};",yc.LastRequestCorrelationID,yc.TimeStamp,U.length),this.Eq.NFh(U);else if(yc.Key===cg.a.Jti)U=Sys.Serialization.JavaScriptSerializer.deserialize(yc.Value),
Ba.a.J(512497794,817,50,"CoauthNotificationManager::OnDocNotifyClientItemsUpdated - CoauthStatus; LastRequestCorrelationID:{0}; TimeStamp:{1}; NewStatus:{2};",yc.LastRequestCorrelationID,yc.TimeStamp,Bz[U]),this.Eq.xtc(U);else if(yc.Key===cg.a.Lyi)Ba.a.J(39913162,817,50,"CoauthNotificationManager::OnDocNotifyClientItemsUpdated - Content update; LastEditorID:{0}; LastRequestCorrelationID:{1}; TimeStamp:{2}; RevisionId:{3}; IsFromRealTimeChannel:{4}",yc.LastEditorID,yc.LastRequestCorrelationID,yc.TimeStamp,
yc.Value,!1),this.BC.IIk(),this.Bv.yF(this.Vb.yi),this.Ga.qT&&Object(Rd.a)("showChatPPTPane")&&this.ve.vNe(new Dz(!1));else{if(Db=yc.Key.startsWith(cg.a.xLf)){a:{Db=void 0;U=yc.Value;try{const Wd=U?U.split(","):[];if(3!==Wd.length){Db=lc.a.PE(0,0);Ba.a.J(23089477,823,10,"ContentKeyHelper::TryGetSlideIdFromSuggestionCoauthModifiedKey - Coauth modified value member is not expected; value:{0}.",U);var gc={returnValue:!1,slideId:Db};break a}const Ve=Number.parseInvariant(Wd[0]),$e=Number.parseInvariant(Wd[1]),
Qf=Wd[2];Db=lc.a.PE(Number.parseInvariant(Wd[0]),Number.parseInvariant(Wd[1]));Ba.a.J(23089479,823,50,"ContentKeyHelper::TryGetSlideIdFromSuggestionCoauthModifiedKey - Sid:{0}, Cid:{1}, modified Guid:{2}.",Ve,$e,Qf)}catch(Wd){Ba.a.J(23089481,823,10,"ContentKeyHelper::TryGetSlideIdFromSuggestionCoauthModifiedKey - Cannot get slide id from coauth modified key. Value:{0}, exception log:{0}.",U,Wd.toString());Db=lc.a.PE(0,0);gc={returnValue:!1,slideId:Db};break a}gc={returnValue:!0,slideId:Db}}Db=({slideId:U}=
gc).returnValue}if(Db)Ba.a.J(512497793,829,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Coauth Modified notification returned, slide id:{0}",yc.Value),this.ve.MIk(new gK(U));else{if(Db=yc.Key.startsWith(cg.a.Dyh)){{var hc=void 0;let Wd;U=null;G=0;hc=Wd=null;(Db=yc.Key.match(RegExp("/Suggestion\\[(.*),(\\d+)]/ID\\[(\\d+),(\\d+),(.*),(.*)]")))&&7===Db.length?(U=Db[1],G=Number.parseInvariant(Db[2]),hc=Object.assign(new Ss.a,{Sid:Number.parseInvariant(Db[3]),Cid:Number.parseInvariant(Db[4])}),
Wd=new lc.a(hc),hc=Db[6],G={returnValue:!0,correlationID:U,cV:G,slideID:Wd,trigger:hc}):G={returnValue:!1,correlationID:U,cV:G,slideID:Wd,trigger:hc}}Db=({correlationID:G,cV:y.w0a,slideID:U,trigger:y.trigger}=G).returnValue}if(Db)Ba.a.J(512497792,829,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Designer suggestion notification returned, CorrelationId:{0}",G),U=new Cz(G,y.w0a,y.w0a,0,y.trigger,U,yc.Value),U.trc=new Qa.a,this.bLe(U);else if(this.Ga.designerIncrementalRenderEnabled&&
yc.Key.startsWith(cg.a.kce)&&({correlationID:G,cV:y.w0a,Daa:y.Daa,slideID:U,trigger:y.trigger,kkb:y.kkb}=XJ(yc.Key)).returnValue)Ba.a.J(512497763,829,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Designer incremental suggestion notification returned, CorrelationId: {0}; startIdx: {1}; Suggestions in notification: {2}; Expected total: {3}",G,y.kkb,y.w0a,y.Daa),U=new Cz(G,y.w0a,y.Daa,y.kkb,y.trigger,U,yc.Value),G in y.SVd||(y.SVd[G]=this.Njj(G,a.items)),U.trc=y.SVd[G],U.ice=!0,this.bLe(U);
else{if(Db=yc.Key.startsWith(cg.a.IUf))U=G=null,(Db=yc.Key.match(RegExp("/FixItSuggestion\\[(.*)]/ID\\[(\\d+),(\\d+),(.*)]")))&&5===Db.length?(G=Db[1],U=Object.assign(new Ss.a,{Sid:Number.parseInvariant(Db[2]),Cid:Number.parseInvariant(Db[3])}),U=new lc.a(U),G={returnValue:!0,correlationID:G,slideID:U}):G={returnValue:!1,correlationID:G,slideID:U},Db=({correlationID:G,slideID:U}=G).returnValue;if(Db)Ba.a.J(512497762,829,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - FixIt suggestion notification returned, CorrelationId:{0}",
G),this.bLe(new Fx(G,U,yc.Value));else{if(Db=yc.Key.startsWith(cg.a.adg))fb=null,ja=0,Db=null,G=U=0,(va=yc.Key.match(RegExp("/Intelligence\\[(.*),(\\d+),(\\d+),(\\d+),(\\d+),(\\d+)]")))&&7===va.length?(fb=va[1],ja=Number.parseInvariant(va[2]),G=Object.assign(new Ss.a,{Sid:Number.parseInvariant(va[3]),Cid:Number.parseInvariant(va[4])}),Db=new lc.a(G),U=Number.parseInvariant(va[5]),G=Number.parseInvariant(va[6]),ja={returnValue:!0,correlationID:fb,Gda:ja,slideID:Db,shapeId:U,aKa:G}):ja={returnValue:!1,
correlationID:fb,Gda:ja,slideID:Db,shapeId:U,aKa:G},Db=({correlationID:G,Gda:ja,slideID:U,shapeId:va,aKa:fb}=ja).returnValue;if(Db)Ba.a.J(512497761,829,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - ReplaceObject notification returned, CorrelationId:{0}",G),this.ve.ZJk(new iK(G,ja,U,va,fb,yc.Value));else if(yc.Key===cg.a.FFl)this.Ivj();else if(yc.Key===cg.a.OSf&&this.GDg!==yc.Value)this.Nqj(yc);else if(yc.Key===cg.a.jzh)!ta.a.Wa(yc.Value)&&ta.a.bzb(yc.Value)?(U=Sys.Serialization.JavaScriptSerializer.deserialize(yc.Value),
Ba.a.J(512497760,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Sync loop exited with status:{0}; PopSessionID:{1}; PodSessionID:{2}",U,this.Xa.Kk,this.Xa.podSessionId),240===U?this.BO.Bfa(1):(432!==U||this.Qre||this.eNf(),this.BDb.peh(new iD(U)))):(U=Sys.Serialization.JavaScriptSerializer.deserialize(yc.Value),Ba.a.J(512497759,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Sync loop exited with status:{0}; HasExtraErrorParams:{1}; PopSessionID:{2}; PodSessionID:{3}",
U.Code,!!U.ExtraErrorParam,this.Xa.Kk,this.Xa.podSessionId),240===U.Code?this.BO.Bfa(1):(432!==U.Code||this.Qre||this.eNf(),this.BDb.peh(new iD(U.Code,U.ExtraErrorParam))));else if(yc.Key===cg.a.Amg)this.Hrj(yc);else if(yc.Key===cg.a.uyj)Ba.a.J(512497758,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Host Session Failover notification received oldsessionId:{0};",this.Xa.Kk),this.BO.Bfa(1);else if(yc.Key===cg.a.hEk)U=Sys.Serialization.JavaScriptSerializer.deserialize(yc.Value),this.Vb.Cf.eKe=
U,this.Fu.SJk(new fK(U));else if(yc.Key.startsWith(cg.a.cFf)){Ba.a.J(512497757,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Comment has been createed or updated with key: {0}",yc.Key);a:{U=yc.Key;try{const Wd=U.match(RegExp("\\d+","g"));if(Wd&&0<Wd.length&&!(Wd.length%2)){Db=[];for(hc=0;hc<Wd.length;hc+=2)Db.push(Object.assign(new Ss.a,{Sid:Number.parseInvariant(Wd[hc]),Cid:Number.parseInvariant(Wd[hc+1])}));var Gc=Db;break a}}catch(Wd){Ba.a.J(25011930,805,10,"ContentKeyHelper::TryGetSlideIdsFromCommentPrefixKey - Cannot get slide id array from key. Key:{0}, Exception:{1}",
U,Wd)}Gc=null}(U=Gc)&&0<U.length&&this.BC.DIk(new bK(U))}else if(yc.Key.startsWith(cg.a.dbg))this.jrj(yc);else if(yc.Key===cg.a.mTf)this.O2c.VIk(new ZJ(yc.Value));else{if(Db=yc.Key.startsWith(cg.a.Fag)){a:{Ta=yc.Key;Db=null;U=0;va="";try{const Wd=Ta.match(RegExp("/IconSuggestion\\[(\\d+),(\\d+),(\\d+),{(.*)}]"));if(Wd&&5===Wd.length){const Ve=Object.assign(new Ss.a,{Sid:Number.parseInvariant(Wd[1]),Cid:Number.parseInvariant(Wd[2])});Db=new lc.a(Ve);U=Number.parseInvariant(Wd[3]);va=Wd[4];var Pc={returnValue:!0,
slideID:Db,shapeId:U,nodeId:va};break a}}catch(Wd){Ba.a.J(38279246,823,10,"ContentKeyHelper::TryGetIconSuggestionInfoFromServiceKey - Cannot get IconSuggestionInfo from key. Value:{0}, exception log:{0}.",Ta,Wd.toString())}Pc={returnValue:!1,slideID:Db,shapeId:U,nodeId:va}}Db=({slideID:U,shapeId:va,nodeId:Ta}=Pc).returnValue}if(Db)Ba.a.J(512497756,829,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - IconSuggestion notification returned."),this.ve.fJk(new hK(U,va,Ta,yc.Value));else if(yc.Key===
cg.a.VWi)this.BDb.WIk(new cK(yc.Value));else{if(Db=yc.Key.startsWith(cg.a.hBh))Db=null,(U=yc.Key.match(RegExp("/ThumbImgId\\[(\\d+),(\\d+)\\]")))&&3===U.length?(Db=new Ss.a,Db.Sid=Number.parseInvariant(U[1]),Db.Cid=Number.parseInvariant(U[2]),Db=new lc.a(Db),U={returnValue:!0,slideId:Db}):U={returnValue:!1,slideId:Db},Db=({slideId:U}=U).returnValue;if(Db)U=new WJ(U,yc.Value),U.imageId&&m.push(U);else if(yc.Key===cg.a.hNi)this.Fv.D2e(parseInt(yc.Value));else if(yc.Key===cg.a.ivf)this.O2c.uIk(new YJ(yc.Value));
else if(yc.Key===cg.a.Lhg)this.O2c.nJk(new aK("true"===yc.Value.toLowerCase()));else if(yc.Key===cg.a.d_k)this.Eq.Flh=yc.Value,this.Eq.O4g();else if(yc.Key===cg.a.b_k)try{this.Eq.Nod=Boolean.parse(yc.Value)}catch(Wd){Ba.a.J(512497755,817,15,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Can't parse the notification message: {0}",Wd)}else if(yc.Key===cg.a.rmg)U=Sys.Serialization.JavaScriptSerializer.deserialize(yc.Value),Ba.a.J(512497754,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - LastMergeEditUTC updated: {0}",
U.toString()),this.BC.sJk(new dK(U));else if(yc.Key===cg.a.Teh)U=Sys.Serialization.JavaScriptSerializer.deserialize(yc.Value),Ba.a.J(512497753,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated- Raising a RealTimeChannelEditEvent. UTC Time: {0}",U.toString()),this.BC.UJk(new eK(U));else if(yc.Key===cg.a.yAj)try{this.Eq.yhe=Boolean.parse(yc.Value),Ba.a.J(512497752,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - IsConnectedToOCS: {0}",this.Eq.yhe)}catch(Wd){Ba.a.J(512497751,
817,15,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Can't parse the notification message: {0}",Wd)}else if(yc.Key===cg.a.syj)this.Eq.alc=yc.Value,Ba.a.J(512497750,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - PopsHostProtocol: {0}",this.Eq.alc);else if(yc.Key===cg.a.PFl)Ba.a.J(512497749,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Received ZeroByteFileEnsuredOnHost notification"),this.Eq.BJh=!0;else if(yc.Key===cg.a.p_j)Ba.a.J(512497748,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Received LockId: {0}",
yc.Value),this.Eq.W3=yc.Value;else if(yc.Key===cg.a.q_j)Ba.a.J(512497747,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Received LockIsCoauthorable: {0}",yc.Value),this.Eq.Nng=Boolean.parse(yc.Value);else if(yc.Key===cg.a.QKf)try{this.Eq.u7a=Number.parseInvariant(yc.Value),Ba.a.J(512497746,843,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - DeferredBlobCount: {0}",this.Eq.u7a)}catch(Wd){Ba.a.J(512497745,843,15,"Can't parse the notification message: {0}",Wd)}else if(yc.Key===
cg.a.Rtf){let Wd;try{Wd=Boolean.parse(yc.Value),this.Eq.minorVersionLimitReached=Wd}catch(Ve){Wd=this.Eq.minorVersionLimitReached=!1}Wd&&!this.Ire&&(this.oMi(),this.Ire=!0);Ba.a.J(512497744,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Received AllowSaveAtMinorVersionLimit: {0}, m_fIsMinorVersionLimitReachedDisplayed: {1}",yc.Value,this.Ire)}else Ba.a.J(512497743,817,50,"Notification key ignored {0}",yc.Key)}}}}}}}Ba.a.J(512497742,817,50,"CoauthNotificationManager::OnDocNotifyClientItemsUpdated docItem.Key:{0}, ProcessNotificationStart:{1}, ProcessNotificationDuration:{2}",
yc.Key,Nc.a.nf(Vd),(+new Date-+Vd).toString());De&&!this.Vt.aFa&&Ba.a.J(512497741,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Dragging is stopped while processing docItem.Key:{0}",yc.Key);y.trigger===lQ.a.insertPicture&&this.DFk(new jK(!0))}this.Mxl(c,h,b,m)}Njj(a,b){const c=new Qa.a;b=zi.e(b,h=>h.Key.startsWith(cg.a.kce));for(const h of b)b=XJ(h.Key),b.returnValue&&b.correlationID===a&&(1===b.cV?c.add(b.kkb):1<b.cV&&c.addRange(jQ(h.Value)));return c}oMi(){this.hl.VK(24);Ba.a.J(512497740,
809,50,"CoauthNotificationManager::DisplayVersionLimitHitInfo reached - business bar for MinorVersionLimit")}eNf(){this.Qre=!0;this.hl.VK(25);Ba.a.J(512497739,809,15,"CoauthNotificationManager::DisplayNetworkLocationUnauthorizedInfo reached - business bar for UserNetworkLocationUnauthorized Shown")}DFk(a){this.ve.OJk(a)}bLe(a){let b;b=Object(za.a)(Fx,a)?()=>{this.ve.raiseFixItSuggestionUpdatedEvent(Object(ua.a)(Fx,a))}:()=>{this.ve.raiseDesignerSuggestionsUpdatedEvent(Object(ua.a)(Cz,a))};if(this.Vt.aFa&&
this.Ga.processSuggestionNotificationInTaskIfInDragIsEnabled){const c=new He.a(2,1,0,()=>{b()},90,Object(za.a)(Fx,a)?"114":"92");this.zb.Eb(c)}else b()}Mxl(a,b,c,h){a&&(this.Gma.Koj(),this.G8c.instance&&this.G8c.instance.bdd());b.forEach(m=>{const y=m.l2b.Id;c.Kxl(cg.a.D9d(y.Sid,y.Cid),m.Ofa)});this.Gma.Oqj(b,h)}Ivj(){Ba.a.J(512497738,817,10,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Document was already opened by antoher DC.");this.Vb.yi&&this.Vb.yi.contentReplicator&&(this.Vb.yi.contentReplicator.enabled=
0);this.Qd.YG(158,a=>{a.$B=1;return!1})}Nqj(a){Ba.a.J(512497737,829,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Failover notification received");this.BC.UIk(new gm(!1,!0));let b=null;this.G8c.instance&&(b=this.G8c.instance.smj());this.Bv.syncCurrentSlideIdAndPrefetchRange(this.ua.Ba,b,null,null);this.GDg=a.Value}Hrj(a){a=Sys.Serialization.JavaScriptSerializer.deserialize(a.Value);if(this.Xa.podSessionId!==a)if(this.Ga.ignorePodSessionRefreshedFromPops)Ba.a.J(512497736,817,50,"CoauthNotificationManager::HandleLatestPodSessionNotification - Ignore Pop rehydrated Pod session");
else{const b=this.Xa.podSessionId;this.Xa.podSessionId=a;this.BDb.Ndh(new eo.a(b,a))}else Ba.a.J(512497735,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Same PodSessionId:{0}",a)}jrj(a){a=Sys.Serialization.JavaScriptSerializer.deserialize(a.Value);try{if(a){const b=a.split(";",6);a=!0;for(let c=0;5>c;c++)if(!b[c]){a=!1;break}if(6>b.length||!a)Ba.a.J(512497733,817,15,"Invalid format of image description notification");else{const c=pa.a.Hf(b[1]),h=Boolean.parse(b[2]),m=Boolean.parse(b[3]);
this.O2c.gJk(new $J(c,h,m,parseFloat(b[4]),b[5]))}}else Ba.a.J(512497734,817,15,"Response data is null")}catch(b){Ba.a.J(512497732,817,15,"Can't parse the notification message: {0}",b)}}GYi(){let a=0;const b=[],c=(new Date).getTime(),h=this.jFg;for(let y in h){var m=y;0<c-h[y]&&(a++,delete this.jFg[m])}(0<a||0<b.length)&&Ba.a.J(512497731,817,50,"FlushDocNotifyTelemetry - normal channel only:{0}, normal channel delay:{1}",a,Ma.a.join(b,","))}J2d(){this.GYi()}Exh(){if(this.SAg&&!this.mc.rL)Ba.a.J(512497730,
801,50,"StartServerRtcConnection: Do not start server RTC in readonly mode");else{var a=vb.a.instance.resolve("PowerPointWebEditor.ISessionInfoOwner").podSessionId,b=Eh.a.create().toString(),c=String.format("{0}PodHandler.ashx?action=StartRtcConnection&source=Browser",this.Ga.podsWebServiceBase),h=Object.assign(new UJ,{BaseDocQueryStringWithoutVersion:u.AFrameworkApplication.jh,SerializedUser:this.Ga.serializedBaseUser,SessionID:a}),m={};m.PodSID=a;m["X-UserSessionId"]=u.AFrameworkApplication.userSessionId;
m["X-CorrelationID"]=b;a=dd.c(h);u.AFrameworkApplication.Je.YV(c,2,a,m,[ca.a.v5],0,y=>{this.Iog(50,String.format("EnqueueTime:{0}; InvokedTime:{1}; CompletedTime: {2}; ResponseData:{3}",y.data.rI,y.data.St,y.data.hv,y.data.Zd))},y=>{const G=vb.a.instance.resolve("PowerPointWebEditor.IJsonpHelperManager");this.Iog(10,G.Nja(y))},null,void 0,void 0,void 0,void 0,Ax.a("3"))}}Xxh(){var a=vb.a.instance.resolve("PowerPointWebEditor.ISessionInfoOwner").podSessionId;const b=Eh.a.create().toString(),c=String.format("{0}PodHandler.ashx?action=StopRtcConnection",
this.Ga.podsWebServiceBase),h={};h.PodSID=a;h["X-UserSessionId"]=u.AFrameworkApplication.userSessionId;h["X-CorrelationID"]=b;a=Object.assign(new VJ,{SessionID:a});a=dd.c(a);u.AFrameworkApplication.Je.YV(c,2,a,h,[ca.a.v5],0,()=>{Ba.a.J(38904456,801,50,"StopServerRtcConnection - request succeeded")},m=>{const y=vb.a.instance.resolve("PowerPointWebEditor.IJsonpHelperManager");Ba.a.J(38904458,801,10,"StopServerRtcConnection -  Failed with status code: {0}",y.Nja(m))},null,void 0,void 0,void 0,void 0,
Ax.a("9"))}Iog(a,b){Ba.a.J(512497729,801,a,"StartServerRtcResult: {0}",b)}Q$(){this.Exh()}Aw(a,b){b.Hie&&!this.mc.rL&&(Ba.a.J(512497728,801,50,"OnUnifiedAppStateChanged: Disconnect from server RTC in readonly mode"),this.Xxh())}vB(){this.Xxh()}}Object(n.a)(jD,"CoauthNotificationManager",null,[]);class kK{constructor(a,b){this.ZNh=a;this.A7e=b}get coauthoringStartTime(){return this.ZNh}get oEf(){return this.A7e}d5k(a){this.A7e=a}}Object(n.a)(kK,"CoauthoringDurationRecord",null,[]);var mQ=d(942);class lK extends Sys.EventArgs{constructor(a,
b,c=!1){super();this.kwf=a;this.Rmg=b;this.vLj=c}}Object(n.a)(lK,"EditorTableChangedEventArgs",Sys.EventArgs,[]);class Ez{constructor(a,b,c){this.Ima=this.Gdb=null;this.Wbb=[];this.Prg=new rj.a;this.ZEg=new rj.a;this.exe=null;this.cvg=!1;this.Xwe=0;this.rvg=this.S3c=!1;this.v8c="";this.Flh=null;this.minorVersionLimitReached=this.BJh=this.Sig=this.Nod=this.BSf=!1;this.Gwe=null;this.Nng=!1;this.u7a=0;this.GZc=!1;this.cGa=a;this.Oc=b;this.U2c=0;this.tcb=[];this.Oc.lOd(Object(F.a)(this,this.ugb,"onPopSessionClosed"));
this.i9j=c}get VC(){return this.Gdb}set VC(a){this.Gdb!==a&&(this.Gdb&&0<this.Gdb.length&&2===this.U2c&&Ba.a.J(509670560,804,10,String.format("MyEditorID is changed from {0} to {1}",this.Gdb,a)),this.Gdb=a)}get userName(){return this.Ima}get yhe(){return this.S3c}set yhe(a){(this.S3c=a)&&!this.rvg&&Mf.Health.instance&&(this.rvg=!0,Mf.Health.instance.addOrUpdatePartCDimension("IsOcsSession",this.S3c.toString()))}get alc(){return this.v8c}set alc(a){a!==this.v8c&&(this.v8c=a,Ba.a.J(509670558,804,50,
"CoauthStateCache - PopsHostProtocol:{0}",this.v8c))}get W3(){return this.Gwe}set W3(a){this.Gwe=a;(a=this.i9j.value.instance)?(a.rUd=this.Gwe,Ba.a.J(509670557,804,50,"CoauthStateCache::LockId - renameProps.CoauthLockId: {0}",a.rUd)):Ba.a.J(509670556,804,50,"CoauthStateCache::LockId - renameProps == null");this.cGa.uJk()}get e_(){const a=[];Array.addRange(a,this.tcb);return a}get YBl(){return this.e_.length?this.e_.length:1}get amIAlone(){return 2!==this.tca}get lw(){return this.Nng}get tca(){return this.U2c}set tca(a){this.U2c!==
a&&(Ba.a.J(509670554,804,50,"Coauth State Changing to: {0}",1===a?"alone":"coauthoring"),this.U2c=a)}get hCa(){return this.Prg.task}get Zbd(){return this.ZEg.task}get kPc(){return this.exe}set kPc(a){this.exe||(this.exe=a,this.ZEg.Fg(a.getTime()))}NFh(a){let b;({pQd:a,leaving:b}=this.jyl(a)).returnValue&&(a=new lK(a,b,!this.GZc),this.SMk(),this.cGa.QIk(a))}SMk(){const a=[],b=this.e_;for(const c of b)Array.add(a,c.ID)}xtc(a){const b=this.tca;2===a&&(this.kPc=new Date);0!==b||this.cvg||(Ba.a.J(509670553,
804,50,"Set coauthoring start point: {0}",1===a?"alone":"coauthoring"),this.cvg=!0,this.Prg.Fg(1===a?1:0));this.tca=a;b!==this.tca&&(this.cGa.BIk(new mQ.a(this.tca)),this.Axl(this.tca))}Axl(a){var b=new Date;2===a?(b=new kK(b,new Date(9999,12,31)),Array.add(this.Wbb,b)):(a=this.Wbb.length,0<a&&this.Wbb[a-1].d5k(b))}tGh(a){this.VC=a;Ba.a.J(509670552,814,50,"App::UpdateMyEditorID; MyClientId: {0}; EditorTableCount: {1}",this.VC,this.e_.length);this.cGa.AIk()}klb(a){let b;a&&(a=a.toLowerCase());b=null;
for(let c=0;c<this.tcb.length;c++){const h=this.tcb[c];if(a===h.ID){b=h;break}}return{returnValue:!!b,editor:b}}jyl(a){let b,c;const h=[];b=[];c=[];let m=!1;const y=a?a.length:0;for(let G=0;G<y;G++){const U=a[G];U&&U.ID&&(U.ID=U.ID.toLowerCase());let ja;({editor:ja}=this.klb(U.ID)).returnValue?(m=m||!Ez.$Oi(U,ja),Array.remove(this.tcb,ja)):(U.ID!==this.Gdb?Array.add(b,U):this.Ima=U.Name,m=!0);Array.add(h,U)}Array.addRange(c,this.tcb);m=m||0<c.length;this.tcb=h;this.Xwe=Math.max(this.Xwe,this.tcb.length);
Mf.Health.instance&&Mf.Health.instance.addOrUpdatePartCDimension("MaxNumEditors",this.Xwe.toString());return{returnValue:m,pQd:b,leaving:c}}QQc(a,b){let c=0;const h=this.Wbb.length;if(0<h&&a<this.Wbb[h-1].oEf){a=a.getTime();b=b.getTime();for(let m=0;m<h;++m){const y=Math.max(this.Wbb[m].coauthoringStartTime.getTime(),a),G=Math.min(this.Wbb[m].oEf.getTime(),b);y<G&&(c+=G-y)}}return c}O4g(){this.Sig=!0;this.cGa.RJk()}ugb(){this.alc=""}static $Oi(a,b){return a.EmailAddress===b.EmailAddress&&a.ColorIndex===
b.ColorIndex&&a.Name===b.Name&&a.ID===b.ID&&a.SIPAddress===b.SIPAddress}}Object(n.a)(Ez,"CoauthStateCache",null,[1211,1212]);var iu=d(372);class vl{constructor(){this.KeyRoot=null;this.TimeStamp=0}}Object(n.a)(vl,"KeyRootSubscription",null,[]);class Dv{constructor(a,b,c,h,m,y,G,U,ja,va,Ta,fb,Db){this.hhc=iu.a.empty;this.Es=[];this.kva=[];this.uvg=this.vre=!1;this.o3c=a;this.T4c=b;this.Ze=c;this.g2c=va.kii;this.Gma=h;this.K2c=m;this.vj=y;this.oek=G.tWd(1E3,Object(F.a)(this,this.KRi,"ensureVisibleThumbnailsSubscriptionImpl"));
this.Oc=U;this.qd=ja;this.Xa=va;Ta.SMd(this);this.Z8c=fb;this.fec=Db;this.rH=!1;this.Z8c&&this.Oc.Q8h(Object(F.a)(this,this.imk,"onBackendChanged"));this.Oc.GA(Object(F.a)(this,this.kM,"onSessionClosed"));this.Oc.WB(Object(F.a)(this,this.Bo,"onSessionRehydrated"))}Xwa(){this.rH=!1;this.K2c.reset();this.ocg()}ocg(){Array.clear(this.Es);this.hhc=iu.a.empty;this.Frd=this.Gma.fpa;this.qd.Iqb(()=>{this.Frd=this.Gma.fpa});const a=new vl;a.KeyRoot=cg.a.PXf(this.g2c);a.TimeStamp=0;this.Es.push(a);var b=new vl;
b.KeyRoot=cg.a.Wah;b.TimeStamp=0;this.Es.push(b);b=new vl;b.KeyRoot=cg.a.Iti;this.Es.push(b);var c=new vl;c.KeyRoot=cg.a.Dyh;this.Es.push(c);c=new vl;c.KeyRoot=cg.a.kce;this.Es.push(c);c=new vl;c.KeyRoot=cg.a.adg;this.Es.push(c);c=new vl;c.KeyRoot=cg.a.xLf;this.Es.push(c);c=new vl;c.KeyRoot=cg.a.OSf;this.Es.push(c);c=new vl;c.KeyRoot=cg.a.jzh;this.Es.push(c);const h=new vl;h.KeyRoot=cg.a.Amg;this.Es.push(h);const m=new vl;m.KeyRoot=cg.a.wyj;this.Es.push(m);var y=new vl;y.KeyRoot=cg.a.cFf;this.Es.push(y);
y=new vl;y.KeyRoot=cg.a.dbg;this.Es.push(y);y=Object.assign(new vl,{KeyRoot:cg.a.mTf,TimeStamp:0});this.Es.push(y);y=new vl;y.KeyRoot=cg.a.Fag;this.Es.push(y);this.fec&&(y=new vl,y.KeyRoot=cg.a.hBh,this.Es.push(y));y=new vl;y.KeyRoot=cg.a.ivf;this.Es.push(y);y=new vl;y.KeyRoot=cg.a.Lhg;this.Es.push(y);y=new vl;y.KeyRoot=cg.a.rmg;this.Es.push(y);y=new vl;y.KeyRoot=cg.a.Teh;this.Es.push(y);y=new vl;y.KeyRoot=cg.a.IUf;this.Es.push(y);y=new vl;y.KeyRoot=cg.a.Rtf;this.Es.push(y);const G=new vl;G.KeyRoot=
cg.a.QKf;this.Es.push(G);this.o3c.Fpc(this.Es);this.T4c&&(Array.clear(this.kva),this.kva.push(b),this.kva.push(a),this.kva.push(c),this.kva.push(h),this.kva.push(m),this.kva.push(y),this.Ze.pA?(this.T4c.Fpc(this.kva),this.vre=!0):this.Ze.xga?(this.Oc.mOd(Object(F.a)(this,this.FYa,"onPopSessionInitialized")),this.uvg=!0):this.Ze.$kc.task.continueWith(()=>{this.Ze.pA&&this.T4c.Fpc(this.kva)}))}FYa(){this.vre||(this.T4c.Fpc(this.kva),this.vre=!0)}get Frd(){return this.hhc}set Frd(a){iu.a.equals(this.hhc,
a)||(iu.a.equals(a,iu.a.empty)?this.hhc=iu.a.empty:this.hhc=iu.a.rvb(a.AW,a.lastIndex),this.oek.perform())}imk(a,b){this.rH||(a=b.Avk)&&0<a.length&&(Ba.a.J(512497699,817,50,"CoauthManager::OnBackendChanged - Backend machine id changed from {0} to {1}",a,this.Xa.fHc),this.Xwa())}kM(){this.rH=!0}Bo(){this.Xwa()}KRi(){const a=this.Es;var b=this.K2c;const c=[];var h=null;for(const y of this.Frd.F3){var m=cg.a.elj(y);h&&h.KeyRoot!==m&&(c.push(h),h=null);h||(h=new vl,h.KeyRoot=m,h.TimeStamp=Number.MAX_VALUE);
if(m=this.Gma.I9a(y))m=b.w6d(cg.a.D9d(m.sid,m.cid)),h.TimeStamp>m&&(h.TimeStamp=m)}h&&c.push(h);zi.d(a,Object(F.a)(this,this.pUi,"fNeedResetBrowserKeySubscription"),y=>{y.TimeStamp=0},1);b=zi.e(a,y=>y.KeyRoot.startsWith(cg.a.iBh));h=zi.a(c,b,Dv.Dle);zi.a(b,h,Dv.Dle);if(b.length||c.length)zi.a(a,b,Dv.Dle),Array.addRange(a,c),this.o3c.Fpc(a)}pUi(a){return a.KeyRoot.startsWith(cg.a.PXf(this.g2c))&&!this.vj.VC?(Ba.a.J(512497698,817,50,"CoauthSubscriptionManager::ResetBrowserKeyIfNeeded; Resetting timestamp of BrowserID Key subscription as clientId has not been received"),
!0):!1}dispose(){this.Oc.baa(Object(F.a)(this,this.kM,"onSessionClosed"));this.Oc.Dfa(Object(F.a)(this,this.Bo,"onSessionRehydrated"));this.uvg&&this.Oc.pPe(Object(F.a)(this,this.FYa,"onPopSessionInitialized"))}static Dle(a,b){return a.KeyRoot===b.KeyRoot}}Object(n.a)(Dv,"CoauthSubscriptionManager",null,[1195,106,438]);class mK extends Sys.EventArgs{constructor(){super();this.items=null}}Object(n.a)(mK,"ItemsModifiedEventArgs",Sys.EventArgs,[]);class nK{constructor(a,b,c,h,m,y){this.id=Eh.a.create();
this.t2c=a;this.Pf=b;this.Xa=c;this.Ga=m;this.Qd=h;this.UX=y}cuj(a,b){this.UX&&!this.t2c.$W&&this.UX.lMc(a.yY);a&&a.telemetry&&0<a.telemetry.length&&this.Pf.hYa(a.telemetry);Nc.a.vF(this.Pf,()=>{this.t2c.g5g(this.id,a.result,a.yY,b)})}buj(a,b,c){if(!this.t2c.$W&&(this.UX&&this.UX.lMc(a.yY),a&&a.error&&this.Ga.pptFailoverInLongPollingFailHandlerEnabled&&a.error.Xm===qf.a.Uh(223))){Ba.a.J(35497247,801,15,"LongPollingResponseHandler::HandleRequestFailedEventHandler. The server is unable to find PodSessionId:{0}.",
this.Xa.podSessionId||"NULL");this.Qd.us(Object.assign(new jl.a,{Code:223,Source:6}),c);return}Nc.a.vF(this.Pf,()=>{this.t2c.g5g(this.id,null,a.yY,b)})}}Object(n.a)(nK,"LongPollingResponseHandler",null,[]);var nQ=d(870);class kD{constructor(a,b,c,h,m,y,G,U,ja,va,Ta){this.cHa=this.ZGa=null;this.RDg=Eh.a.nil;this.FEb=this.YVa=0;this.Hsg=[10,100,1E3,1E4];this.OWa=null;this.IX=[];this.i4=Ta?"GetPopWacUpdates":"GetUpdates";this.Q4=a;this.Xa=c;this.Ze=h;this.Oc=m;this.z9=y;this.Qd=G;this.mc=U;this.UX=ja;
this.Oc.GA(Object(F.a)(this,this.kM,"onSessionClosed"));this.Oc.rPa(Object(F.a)(this,this.L0,"onSessionRehydrating"));this.Oc.WB(Object(F.a)(this,this.Bo,"onSessionRehydrated"));this.Ze.xga&&Ta&&(this.Oc.mOd(Object(F.a)(this,this.FYa,"onPopSessionInitialized")),this.Oc.lOd(Object(F.a)(this,this.ugb,"onPopSessionClosed")));this.SAe=a.fql;this.c6c=a.yPj;this.EDb=a.z$g;this.HCb=[];b.y9a().SMd(this);this.Idk=va;this.ETh=Ta;this.nla=!1;this.yDb=Ta?3E4:6E4}kM(){this.close("SessionClosed")}L0(){this.OWa&&
this.OWa.tsd()}Bo(){this.QJa("SessionRehydrated")}g5g(a,b,c,h){this.ZGa=null;const m=+new Date-+this.cHa;if(this.nla)Ba.a.J(512360732,801,50,"DocNotifyClient.PerformCall - {0} - ignore the server response since DocNotifyClient is closed.",this.i4);else if(a.equals(this.RDg))if(this.Q4.clientIgnoreClosePopsErrorCodeEnable&&this.$W&&this.nla)Ba.a.J(512360730,801,50,"DocNotifyClient.PerformCall - {0} - ignore the server response since pops is closing.",this.i4);else if(a=this.Ze.Hda,h&&h.length&&a!==
h)Ba.a.J(512360729,801,15,"DocNotifyClient.PerformCall - {0} - Ignore {1} response since PopSessionId is changed. CurrentPopSession:{2}; LastAttemptedEnsureHostSessionId:{3}; RequestPopSession:{4}; RetryAttempts:{5}. Triggering another request in {6}ms.",this.i4,b?"Success":"Failure",this.Xa.Kk,this.Ze.Hda,h,this.FEb,this.SAe),this.FEb++,this.uSf(m,this.FEb)||this.Loc(this.SAe);else if(this.FEb=0,b){this.cHa=new Date;this.YVa=0;this.Ze.Vle=this.cHa;this.Ze.Ule=h;Ba.a.J(512360727,801,50,"DocNotifyClient.OnResponseReceived - {0} - Success response. TimeSinceLastServerConnected:{1}, Now:{2}, PopSessionID:{3}",
this.i4,m,Nc.a.nf(new Date),this.$W?this.Xa.Kk:"Not Applicable");c=0;h={};for(const y of b.Items)y.TimeStamp>c&&(c=y.TimeStamp),h[y.LastRequestCorrelationID]=y.LastRequestCorrelationID in h?String.format("{0},{1}",h[y.LastRequestCorrelationID].toString(),y.Key):y.Key,zi.d(this.HCb,G=>y.Key.startsWith(G.KeyRoot),G=>{y.TimeStamp>G.TimeStamp&&(G.TimeStamp=y.TimeStamp)},1);this.Loc(this.SAe);0<Object.keys(h).length&&Nc.a.xk("RequestCorrelationIDsAndKeyRoots",lh.c(h));c=new Date;Nc.a.vF(Nc.a.Ib,()=>{const y=
Object.assign(new mK,{items:b.Items});for(const G of this.IX)try{G(this,y)}catch(U){Ba.a.J(512360726,801,15,"DocNotifyClient::OnResponseReceived - {0} - Unhandled exception notifying clients {1}, {2}",this.i4,U.toString(),U.stack)}});Nc.a.xk("ProcessItemStartTime",Nc.a.nf(c));Nc.a.xk("ProcessItemDurationInMS",(+new Date-+c).toString());Nc.a.Ib.finish()}else Ba.a.J(512360728,801,15,"DocNotifyClient.PerformCall - {0} - NULL response, TimeSinceLastServerConnected:{1}, RequestStatus:{2}, HttpStatusCode:{3}, PodSessionId:{4}, PopSessionId:{5}",
this.i4,m,c?c.status:3,c?c.Te:-1,this.Xa.podSessionId,this.$W?this.Xa.Kk:"Not Applicable"),this.uSf(m,this.YVa)||(h=3<=this.YVa?this.Hsg[3]:this.Hsg[this.YVa],this.YVa++,this.Loc(h),Nc.a.xk("FailureCountSinceLastSuccess",this.YVa.toString()),Nc.a.xk("NextDelayInMS",h.toString()),c&&(Nc.a.xk("RequestStatus",mk.a[c.status]),Nc.a.xk("HttpStatus",c.Te.toString()),Nc.a.xk("Duration",(+c.hv-+c.St).toString())),Nc.a.Ib.finish());else Ba.a.J(512360731,801,50,"DocNotifyClient.PerformCall - {0} - requestID not matched.",
this.i4)}uSf(a,b){return this.$W&&(a>=this.EDb||b>this.Q4.getHostSessionInfoMaxRetryCount)?(Ba.a.J(512360725,801,15,"DocNotifyClient.PerformCall - {0} - Failed enough times, for a time long enough. FailureCount:{1}, PopSessionId:{2}, PopSessionInitialized:{3}",this.i4,b,this.Xa.Kk,this.Ze.pA),!0):!1}close(a){Ba.a.J(512360724,801,50,"DocNotifyClient.Close - {0} - Reason: {1}",this.i4,a);this.nla=!0;this.OWa&&this.OWa.tsd()}Loc(a){const b=Nc.a.Ik(this.i4,2);b.Va("DelayInMS",a.toString());this.c6c?Nc.a.qaa(()=>
{Nc.a.vF(b,Object(F.a)(this,this.R9g,"performCall"))},a,0):window.setTimeout(()=>{Nc.a.vF(b,Object(F.a)(this,this.R9g,"performCall"))},a)}R9g(){if(!this.enabled||u.AFrameworkApplication.Tg||this.ZGa&&+new Date-+this.ZGa<this.yDb||this.$W&&!this.mc.rL||this.z9.dZc)Ba.a.J(512360723,801,50,"DocNotifyClient.PerformCall - {0} - Skipped. Enabled:{1}, IsShuttingDown:{2}, LastCallStartTime:{3}, Now:{4}, PerformCallExpireTimeInMs:{5}, IsNonDismissibleDialogShown:{6}, AppInReadMode:{7}, AppInReadModeAndCanNotEditAnyway:{8}",
this.i4,this.enabled,u.AFrameworkApplication.Tg,this.ZGa?Nc.a.nf(this.ZGa):"null",Nc.a.nf(new Date),this.yDb,this.z9.dZc,!this.mc.Fn,!this.mc.rL);else{var a=Eh.a.create().toString();Ba.a.J(512360722,801,50,"DocNotifyClient.PerformCall - {0} - Executed, LastCallStartTime:{1}, Now:{2}, PerformCallExpireTimeInMs:{3}, PopSessionId:{4}, CorrelationId:{5}",this.i4,this.ZGa?Nc.a.nf(this.ZGa):"null",Nc.a.nf(new Date),this.yDb,this.$W?this.Xa.Kk:"Not Applicable",a);if(!this.$W){var b=zi.e(this.HCb,y=>y.KeyRoot===
cg.a.Wah);b&&b.length&&Ba.a.J(512360721,801,50,"Getupdates. CurrentTimestamp:{0}",b[0].TimeStamp)}this.ZGa=new Date;b=Nc.a.Ib;var c=new nK(this,b,this.Xa,this.Qd,this.Q4,this.$W?null:this.UX);this.RDg=c.id;this.OWa=new nQ.a;var h=this.$W?this.Xa.Kk:"",m=this.$W?"":this.Xa.podSessionId;b.Va(li.a.ptb,a);this.Idk(h,this.Xa.presentationId.string,this.HCb,y=>{c.cuj(y,h)},y=>{c.buj(y,h,m)},this.OWa,{["X-CorrelationId"]:a},null,this.yDb)}}get enabled(){return 0<this.HCb.length&&!this.nla}get $W(){return this.ETh}rrc(){this.Ze.xga||
this.Ze.$kc.task.continueWith(()=>{this.DGe()})}FYa(){this.QJa("PopSessionInitialized")}ugb(){this.close("PopsUninitialized")}DGe(){this.Ze.pA?this.QJa("PopSessionInitialized"):this.close("PopsUninitialized");this.rrc()}Fpc(a){a||(a=[]);Ba.a.J(512360719,801,50,"DocNotifyClient.SetSubscriptions - {0} - {1} subscriptions.",this.i4,a.length);for(const b of a);this.HCb=a;this.cHa=new Date;this.FEb=this.YVa=0;this.$W&&!this.Ze.xga&&this.rrc();this.Loc(0)}ssf(a){Array.add(this.IX,a)}Xwa(){this.QJa("AppListener:OnReboot")}QJa(a){Ba.a.J(512360718,
801,50,"DocNotifyClient.Reboot - {0} - Reason: {1}, PopSession: {2}",this.i4,a,this.$W?this.Xa.Kk:"Not Applicable");this.$W&&"PopSessionInitialized"===a&&this.$Xk();this.nla=!1;this.ZGa=null;this.cHa=new Date;this.FEb=this.YVa=0;this.OWa&&this.OWa.tsd();this.Loc(0)}$Xk(){for(const a of this.HCb)a.TimeStamp=0}dispose(){this.Oc.baa(Object(F.a)(this,this.kM,"onSessionClosed"));this.Oc.nkd(Object(F.a)(this,this.L0,"onSessionRehydrating"));this.Oc.Dfa(Object(F.a)(this,this.Bo,"onSessionRehydrated"));this.$W&&
this.Ze.xga&&(this.Oc.dih(Object(F.a)(this,this.ugb,"onPopSessionClosed")),this.Oc.pPe(Object(F.a)(this,this.FYa,"onPopSessionInitialized")))}}Object(n.a)(kD,"DocNotifyClient",null,[503,106,504,438]);class lD{constructor(){this.u0c=0}}Object(n.a)(lD,"TimeStampData",null,[]);class oK{constructor(){this.hGa={}}reset(){this.hGa={}}copy(a){this.reset();a=a.hGa;for(let h in a){var b=h,c=a[h];const m=new lD;m.u0c=c.u0c;this.hGa[b]=m}}Kxl(a,b){var c=a in this.hGa?this.hGa[a]:new lD;this.hGa[a]=c;c=this.hGa;
for(let m in c){var h=c[m];m.startsWith(a)&&(h.u0c=b)}}w6d(a){return a in this.hGa?this.hGa[a].u0c:0}}Object(n.a)(oK,"HermesContentTimeStampManager",null,[505]);var Gx=d(301);class Hx{constructor(a,b,c,h=null){this.Qie=a;this.Xea=b;this.oic=c;this.Ba=h}}Object(n.a)(Hx,"SlideMoveData",null,[]);var oQ=d(641),Gj=d(299);class pK{constructor(a,b,c,h,m,y,G,U,ja,va,Ta,fb,Db,gc){this.jcc=this.dva=null;this.UT=0;this.RF=null;this.Hte=0;this.u2c=null;this.que=this.H6c=this.Byg=this.Dyg=0;this.ZI=this.WHa=this.wX=
null;this.tma=this.Q6c=0;this.kq=a;this.Fa=b;this.ia=c;this.Vb=h;this.ua=m;this.Vt=y;this.qc=G;this.mc=U;this.Zt=ja;this.p0=this.kq.EU;this.tva=va;this.pa=Ta;this.Gq=fb;this.jn=Db;this.Fua=gc}sCj(){this.UT=-1;this.dva=document.createElement("div");this.dva.style.visibility=Td.a.Ms;this.dva.className=Gj.a.TNi;this.p0.appendChild(this.dva);this.Hte=this.tma=this.Q6c=0;if(this.Fua){this.jcc=document.createElement("div");this.jcc.className=Gj.a.Mnj;const a=document.createElement("span");a.className=Gj.a.Nnj;
this.jcc.appendChild(a)}}dispose(){this.p0.removeChild(this.dva);this.Vt.XE(this.p0,this);this.dva=this.RF=null}xv(a){return a?this.LI(a).returnValue:!1}LI(a){var b=null;if(3===a.Yf||a.lA!==Sys.UI.MouseButton.leftButton||!this.p0.contains(a.Cc)||!this.mc.Fn)return{returnValue:!1,mub:b,E3:null};var c=a.clientPoint.y-this.q0e+this.p0.scrollTop;b=a.clientPoint.x-this.p0.offsetLeft;this.Zt&&(b-=this.p0.offsetWidth-this.p0.clientWidth);b=this.clj(b,c);if(!b||!b.QN)return{returnValue:!1,mub:b,E3:null};
if(this.Fua){a=this.pa.We();if(1>a.length)return{returnValue:!1,mub:b,E3:null};for(var h of a)if(h.ON||32!==this.ia.La(M.a.pMe,1,h.Cb))return{returnValue:!1,mub:b,E3:null};h=this.kq.XY-this.pa.We().length+1;this.Byg=Math.min(this.dYf(c),h);this.Dyg=Math.min(b.slideIndex,h-1)}else if(c=b.slideId,lc.a.ax(c)||32!==this.ia.La(M.a.pMe,1,c))return{returnValue:!1,mub:b,E3:null};return{returnValue:!0,mub:b,E3:null}}Nu(a){if(!a)return!1;this.dva||this.sCj();this.u2c=oQ.a(0,0);if(!({mub:this.wX,E3:G}=this.LI(a)).returnValue)return!1;
if(this.jn){var b=!1,c=this.wX.slideId,h=this.pa.We();for(var m of h)if(m.Cb.equals(c)){b=!0;break}if(b){if(this.ZI=this.ua.Ba,1<h.length&&!this.Fua)return!1}else this.pa.Qh(),this.ZI=this.wX.Fd,this.pa.WU(this.wX.Fd)}if(this.Fua){this.kHh();var y=this.wX.Fxb;var G=y.cloneNode(!0);b=G.getElementsByTagName("img")[0];this.xph(b,Gj.a.j$d,Gj.a.i$d,Gj.a.wUf,Gj.a.wUf);G.className=Gj.a.S6f;c=this.pa.We();h=1;if(1<c.length){for(m=0;m<c.length;m++)if(this.wX.slideIndex!==c[m].slideIndex){h++;y=this.kq.fT(c[m].slideIndex).Fxb;
y=(y=y.getElementsByTagName("img"))&&0<y.length?y[0].cloneNode(!0):b.cloneNode(!0);const U=Gj.a.i$d*h;this.xph(y,Gj.a.j$d-h,Gj.a.i$d-1,U,U);G.appendChild(y);if(3===h)break}G.appendChild(this.jcc);this.jcc.firstChild.innerText=this.pa.We().length.toString()}this.RF?this.kq.EU.replaceChild(G,this.RF):this.kq.EU.appendChild(G);this.RF=G}else b=this.wX.Fxb,this.RF?(b=this.RF.getElementsByTagName("img"),G=G.cloneNode(!0),G.style.zIndex=String(Gj.a.j$d),this.RF.replaceChild(G,b[0]),this.RF.style.zIndex=
String(Gj.a.Knj)):(this.RF=b.cloneNode(!0),this.kq.EU.appendChild(this.RF),this.RF.className=Gj.a.S6f);this.Hte=parseInt(Oe.a.Qt(this.RF).height);cf.a.moa(this.RF,Gj.a.m8g+Gj.a.I7g+Gj.a.Acg,this.Zt);this.RF.style.visibility=Td.a.xz;this.RF.style.cursor=Td.a.lrc;u.AFrameworkApplication.fk("Microsoft.Office.Server.Powerpoint.Web.IPptSlideReorderingImprovementSettings");Ba.a.J(512497671,819,50,"PPT drag slide start.");this.zw(a);return!0}kHh(){this.H6c=this.Byg;this.que=this.Dyg;let a=0;for(let b=0;b<
this.kq.XY;b++){const c=this.kq.fT(b);c.isSelected?c.Gtc(-2):(a===this.wX.slideIndex&&(a+=1),c.Gtc(a),a++)}}xph(a,b,c,h,m){a.className=Gj.a.Jnj;a.style.zIndex=String(b);a.style.borderWidth=c.toString()+"px";a.style.top=h.toString()+"px";a.style.left=m.toString()+"px"}zw(a){if(!a)return!1;var b=a.clientPoint,c=b.y-this.q0e+this.p0.scrollTop,h=this.Hte/2;if(this.tva){if(v.a.wT&&!a.pc.rawEvent.buttons)return Ba.a.J(512497670,819,50,"PPT cancel drag slide in IE/Edge because release mouse button outside of the browser window."),
!1;this.RF.style.top=Math.min(c-h,this.Fua?Gx.a.kV+(this.kq.XY-this.pa.We().length)*this.kq.qsa:Gx.a.kV+this.kq.XY*this.kq.qsa)+"px"}else{a=this.i6b(this.kq.XY)+this.kq.qsa/2;if(this.rUi(b.x)||c>a)return this.aqh(),!0;this.RF.style.top=c-h+"px"}this.wph(!0);this.Opi(b.y);this.D5k(Math.min(this.dYf(c),this.Fua?this.kq.XY-this.pa.We().length+1:this.kq.XY));this.dva.style.visibility=this.BZc(b)&&!this.Fua?Td.a.xz:Td.a.Ms;if(this.Fua&&0<=this.UT)if(this.BZc(b)){this.RF.style.visibility=Td.a.xz;if(this.H6c===
this.UT)return!0;b=this.H6c<this.UT?0>this.UT-1?0:this.UT-1:0>this.UT?0:this.UT;c=0;for(h=0;h<this.kq.XY;h++)a=this.kq.fT(h),a.isSelected||(c<b?a.Gtc(c):a.Gtc(c+1),c++);this.H6c=this.UT;this.que=b}else this.kHh(),this.RF.style.visibility=Td.a.Ms;return!0}Zn(a){if(!this.ua.presentation)throw Error.argumentNull("Presentation is null");var b=a.clientPoint;if(this.Fua){if(a=this.pa.We(),0<a.length&&0<=this.UT&&this.BZc(b)){b=[];for(const c of a)c&&b.push(Object(ua.a)(115,c));this.$pl(b,this.yij(this.que));
Ba.a.J(512497669,819,50,"PPT drag slide succeed.")}}else 0<=this.UT&&this.wX&&this.BZc(b)&&this.wX.slideIndex!==this.UT&&this.wX.slideIndex+1!==this.UT&&(this.Vpl(this.wX.slideIndex,this.UT),Ba.a.J(512497668,819,50,"PPT drag slide succeed."));this.NK()}yij(a){let b=0;for(let c=0;c<this.kq.XY;c++)if(!this.kq.fT(c).isSelected&&(b++,a===b))return c+1;return 0}BZc(a){a=a.x>=this.p0.offsetLeft&&a.x<=this.p0.offsetLeft+this.p0.offsetWidth;return!this.tva||a}iu(){this.NK()}clj(a,b){if(!this.kq.qsa)return null;
var c=Math.floor((b-Gx.a.kV)/this.kq.qsa);if(0<=c&&c<=this.kq.XY-1){c=this.kq.fT(c);if(!c)return null;const h=c.Qkb;a=this.Zt?a-parseInt(h.style.right.replace("px","")):a-parseInt(h.style.left.replace("px",""));b-=parseInt(h.style.top.replace("px",""));if(0<=a&&0<=b&&a<=h.clientWidth&&b<=h.clientHeight)return c}return null}rUi(a){return this.Zt?this.u2c.width-Gj.a.aOf>a||this.u2c.width<a:0>a||Gj.a.aOf<a}Opi(a){const b=a-this.q0e,c=this.u2c.height;if(Gj.a.Wwf>b)this.tma=-Gj.a.Vwf;else if(Gj.a.Ywf>
b)this.tma=-Gj.a.Xwf;else if(Gj.a.$wf>b)this.tma=-Gj.a.Zwf;else if(c-Gj.a.Wwf<a)this.tma=Gj.a.Vwf;else if(c-Gj.a.Ywf<a)this.tma=Gj.a.Xwf;else if(c-Gj.a.$wf<a)this.tma=Gj.a.Zwf;else{this.tma=0;return}this.Q9g()}Q9g(){if(0!==this.tma){const a=this.Q6c,b=(new Date).getTime();0<a&&(this.p0.scrollTop=Math.max(0,this.p0.scrollTop+Math.floor((b-a)*this.tma/1E3)));this.Q6c=b;window.setTimeout(Object(F.a)(this,this.Q9g,"performAutoScrolling"),Gj.a.ggi)}else this.Q6c=0}i6b(a){return this.kq.qsa*a+Gx.a.kV*(this.tva?
.75:1)}dYf(a){a+=this.kq.qsa/2;a-=Gx.a.kV;a=Math.floor(a/this.kq.qsa);return this.tva?Math.max(0,a):a}D5k(a){this.UT!==a&&(this.UT=a,0>this.UT||(this.dva.style.top=cf.a.Pc(this.i6b(a))))}aqh(){this.wph(!1)}wph(a){this.RF.style.cursor=a?Td.a.lrc:Td.a.dml}Vpl(a,b){const c=this.ua.presentation;if(!c)throw Error.argumentNull("Presentation is null");if((this.WHa=Ma.a.clone(this.ua.presentation.VJ))&&!(b>this.WHa.length||a>=this.WHa.length)){var h=null;a=c.O8d(a);b&&(h=c.O8d(b-1));b=new Hx(!1,[a],h);this.ia.La(M.a.uic,
2,b)}}$pl(a,b){const c=this.ua.presentation;if(!c)throw Error.argumentNull("Presentation is null");!(this.WHa=Ma.a.clone(this.ua.presentation.VJ))||b>this.WHa.length||!this.sOj(a,b)||(b=b?c.O8d(b-1):null,a=new Hx(!1,a,b,this.ZI),this.ia.La(M.a.uic,2,a))}sOj(a,b){const c=Object.assign(new Qa.a,{});for(var h=0;h<a.length;h++)c.add(a[h].slideIndex);c.Sc((m,y)=>m-y);a=c.count;for(h=0;h<a-1;h++)if(1!==c.ga(h+1)-c.ga(h))return!0;return c.ga(0)<=b&&c.ga(a-1)+1>=b?!1:!0}NK(){this.Rwl();this.aqh();this.RF.style.visibility=
Td.a.Ms;this.RF.style.top="0px";this.RF.style.cursor=Td.a.vA;this.dva.style.visibility=Td.a.Ms;if(this.Fua){const a=this.Gq.le(3);try{const b=this.ua.presentation;if(!b)throw Error.argumentNull("Presentation is null");a.kd(b);a.NKa(this.kq.Ma);const c=b.slides||[];for(const h of c){const m=Object(ua.a)(116,h);m&&m.anchor.ak(this.kq.Ma,16)}}finally{a&&a.dispose()}this.kq.o_a()}this.tma=0;this.wX&&(this.wX=null);this.Fa.Be&&this.Fa.Be.name===Ua.a.UE||this.Fa.xf(Ua.a.UE)}Rwl(){this.jn?this.ZI&&(this.Vb.Ba=
this.qc.zl(this.ZI.Cb)):this.wX&&(this.Vb.Ba=this.wX.Fd)}get q0e(){let a=this.p0,b=0;for(;a;)b+=a.offsetTop,a=a.offsetParent;return b}}Object(n.a)(pK,"ThumbnailNavPaneDragAdapter",null,[513,244,106]);class mD{}mD.g3h=[M.a.print,M.a.find,M.a.$0,M.a.M7a,M.a.ghd,M.a.fhd,M.a.bringForward,M.a.bringToFront,M.a.sendBackward,M.a.sendToBack,M.a.Qia,M.a.Grd,M.a.Hrd,M.a.K0a,M.a.J0a,M.a.Skb,M.a.Rkb,M.a.g0a,M.a.pMb,M.a.iOb,M.a.Poc,M.a.X5,M.a.PY,M.a.RTa,M.a.akb,M.a.bkb,M.a.ckb,M.a.dkb,M.a.eoc,M.a.foc,M.a.goc,M.a.hoc,
M.a.wld,M.a.woc,M.a.eRe,M.a.xld,M.a.G6a,M.a.YRa,M.a.Bja,M.a.O_a,M.a.P_a,M.a.Q_a,M.a.Ypc,M.a.ILb,M.a.nLb,M.a.FLb,M.a.xjb,M.a.Kjb,M.a.qI,M.a.gQ,M.a.m5,M.a.Sfb,M.a.Pfb,M.a.Rfb,M.a.Qfb,M.a.hZa,M.a.gZa,M.a.ojk,M.a.uEk,M.a.Xti,M.a.Yti,M.a.WCe,M.a.XCe,M.a.YCe,M.a.ZCe,M.a.Ouk,M.a.Eui,M.a.deleteComment,M.a.OTa,M.a.uWc,M.a.wWk,M.a.pjk,M.a.vEk,M.a.zsc,M.a.ssc,M.a.usc,M.a.tsc,M.a.xsc,M.a.wsc];Object(n.a)(mD,"ActionHandledList",null,[]);class Ts{constructor(a,b,c,h){this.z0=new vi.a;this.Bze=new vi.a;this.ia=
a;this.Ga=b;this.pa=c;this.mh=h;this.VBj();this.WBj()}rrj(a,b,c=null){this.Ga.remapShapeEditCommandEnabled&&((this.pa.bH()||this.pa.xs())&&this.z0.Hb(a)?a=this.z0.ga(a):this.pa.pC()&&this.Bze.Hb(a)&&(a=this.Bze.ga(a)));if(this.Ga.podsTableRTTEnabled&&this.Ga.podsTableCellLockEnabled&&Array.contains(Ts.F_k,a)&&(this.pa.W8()||this.pa.bOj()))return 32;if(!Array.contains(mD.g3h,a))return this.ia.La(a,2,b,c);const h=this.ia.wq,m=this.ia.oT;let y=this.ia.La(a,1,b);32===y&&(this.Ga.pptDragCancelFix&&(this.ia.wq=
h,this.ia.oT=m),y=this.ia.La(a,2,b,c));return y}jcl(a){return this.mh.Lub!==a&&this.mh.Mub!==a}dvb(a,b,c){return b&&b.name===Ua.a.rg&&!this.pa.xs()&&1===this.pa.Xd().length&&this.pa.pC()&&this.jcl(c)?a.dvb(a.Gc(b.parent),c):a.dvb(b,c)}VBj(){this.z0.$(D.a.upArrow,M.a.dkb);this.z0.$(D.a.downArrow,M.a.akb);this.z0.$(D.a.leftArrow,M.a.bkb);this.z0.$(D.a.rightArrow,M.a.ckb);this.z0.$(D.a.KLb,M.a.hoc);this.z0.$(D.a.Ljb,M.a.eoc);this.z0.$(D.a.X_a,M.a.foc);this.z0.$(D.a.Y_a,M.a.goc);this.z0.$(D.a.Bsa,M.a.Poc);
this.z0.$(D.a.mYa,M.a.Skb);this.z0.$(D.a.lYa,M.a.Rkb);this.z0.$(M.a.Qia,M.a.Grb);for(const a of Ts.X_k)this.z0.$(a,H.a.qe)}WBj(){for(const a of Ts.Y_k)this.Bze.$(a,H.a.qe)}}Ts.X_k=[D.a.zCa,D.a.ACa,D.a.a1b,D.a.Dtb,D.a.HQa,D.a.IQa,D.a.j7a,D.a.GQa,D.a.Ofb,D.a.FRa,D.a.d8a,D.a.Nfb,D.a.ERa,D.a.c8a];Ts.Y_k=[M.a.M7a,M.a.YRa,M.a.Bja,M.a.iOb];Ts.F_k=[D.a.backspace,D.a.TK,M.a.G6a];Object(n.a)(Ts,"ProcessInputStrategy",null,[510]);class qK{get yJc(){return[361033,9175267,13924352,749464,2893476,15559503,11745730,
8880899,3750201,748043,12084359,1837941,7632250,9195008,3036814,8288617,9967496,7363328]}}Object(n.a)(qK,"PPTColorTable",null,[502]);var pQ=d(943);class rK{constructor(){this.J9c={}}l5d(a){return a&&a in this.J9c?this.J9c[a]:null}Dyf(a,b){a&&b&&a!==b&&(a in this.J9c||(this.J9c[a]=b))}}Object(n.a)(rK,"PresenceEmailConverter",null,[1194]);var sK=d(889),Ix;(function(a){a[a.appInitInteractivityReady=0]="appInitInteractivityReady";a[a.appInitChromeReady=1]="appInitChromeReady";a[a.B2I=2]="B2I";a[a.fHasTabSwitch=
3]="fHasTabSwitch";a[a.presentationIdReady=4]="presentationIdReady";a[a.earlyDownloadEditorTableCount=5]="earlyDownloadEditorTableCount";a[a.earlyDownloadEditorTable=6]="earlyDownloadEditorTable";a[a.firstCoauthoringStatus=7]="firstCoauthoringStatus";a[a.presenceJsLoadStart=8]="presenceJsLoadStart";a[a.peoplesWellPackageRegister=9]="peoplesWellPackageRegister";a[a.peoplesWellPackageConfig=10]="peoplesWellPackageConfig";a[a.peoplesWellInit=11]="peoplesWellInit";a[a.peoplesWellInited=12]="peoplesWellInited";
a[a.peopleWellPageHiddenDuration=13]="peopleWellPageHiddenDuration";a[a.peoplesWellControlViewRefresh=14]="peoplesWellControlViewRefresh";a[a.peoplesWellUpdateTriggered=15]="peoplesWellUpdateTriggered";a[a.peoplesWellUpdateTriggeredAfterChromeReady=16]="peoplesWellUpdateTriggeredAfterChromeReady";a[a.peoplesWellDisplayed=17]="peoplesWellDisplayed";a[a.jquerySignalRLoadStart=18]="jquerySignalRLoadStart";a[a.jquerySignalRLoadEnd=19]="jquerySignalRLoadEnd";a[a.presence1JsLoadStart=20]="presence1JsLoadStart";
a[a.presencePackageRegister=21]="presencePackageRegister";a[a.presencePackageConfigure=22]="presencePackageConfigure";a[a.presencePackageInitInternalStart=23]="presencePackageInitInternalStart";a[a.presencePackageInit=24]="presencePackageInit";a[a.presencePackageInited=25]="presencePackageInited";a[a.usedEarlyFindSessionResult=26]="usedEarlyFindSessionResult";a[a.startRTCConnection=27]="startRTCConnection";a[a.rtcConnected=28]="rtcConnected";a[a.rehydrationCount=29]="rehydrationCount";a[a.presenceCount=
30]="presenceCount";a[a.presenceDisplayed=31]="presenceDisplayed";a[a.presencePageHiddenDuration=32]="presencePageHiddenDuration";a[a.presenceUpdateNotificationReceived=33]="presenceUpdateNotificationReceived";a[a.presenceUpdateProcessed=34]="presenceUpdateProcessed";a[a.presenceFirstMessageSent=35]="presenceFirstMessageSent";a[a.coauthoringStartTime=36]="coauthoringStartTime";a[a.isSecondUser=37]="isSecondUser";a[a.getFirstPresenceStateUserCount=38]="getFirstPresenceStateUserCount";a[a.receivedCompletePeristentState=
39]="receivedCompletePeristentState";a[a.networkConnectivityLoss=40]="networkConnectivityLoss"})(Ix||(Ix={}));Object(n.b)("EntryName",Ix);class tK{constructor(a,b,c,h){this.Qo=null;this.wye=this.j8c=0;this.Rve=this.yzg=this.kve=this.l6c=!1;this.coe=this.doe=this.Rte=this.uoe=this.qte=0;this.x2c=this.ure=null;this.N8c=new rj.a;this.bQg=new rj.a;this.HGg=new rj.a;this.kse=this.pse=!1;this.mfc=a;this.aze=b;this.vj=c;h.execute(m=>{this.Qo=m});this.RX={};Ge.Task.WAA(this.vj.hCa,this.N8c.task,this.bQg.task).continueWith(()=>
{try{this.Zoh(),this.MNc(this.RX),0<Da.a.count(this.RX)&&ba.ULS.sendTraceTag(51242144,814,15,Da.a.toJSON(this.RX)),this.pse=!0}catch(m){ba.ULS.sendTraceTag(51242145,814,10,m.toString())}});Ge.Task.WAA(this.vj.hCa,this.HGg.task).continueWith(()=>{try{this.Zoh(),this.MNc(this.RX),0<Da.a.count(this.RX)&&ba.ULS.sendTraceTag(594879178,814,15,Da.a.toJSON(this.RX)),this.kse=!0}catch(m){ba.ULS.sendTraceTag(594879177,814,10,m.toString())}});this.k3c={};this.wte={}}TQi(a){this.jFc(a,8,"g_hermesPresenceJS");
this.jFc(a,20,"g_hermesPresence1JS");this.jFc(a,18,"g_JquerySignalRMergeJS");this.jFc(a,19,"g_JquerySignalRMergeJSEnd")}jFc(a,b,c){b=Ix[b];b in a||(c=this.E$i(c),0<c&&this.fia(a,b,c))}E$i(a){a=window[a];return void 0===a||null===a?-1:a.getTime()}dispose(){this.$Uf();this.JYi();this.xEh();this.RX=this.wte=this.k3c=null}cRi(){this.Xqa(25)}bRi(){this.Xqa(12)}M1j(){this.Xqa(15);0<this.appInitChromeReady&&this.Xqa(16)}XQi(a){try{this.j8c||(this.j8c=a,this.Yh(17,this.j8c),this.Yh(13,this.k0f(this.B2I,this.j8c)),
this.HGg.HM(!0))}catch(b){ba.ULS.sendTraceTag(594879176,814,10,b.toString())}}n0j(a,b){this.Yh(6,a);this.Yh(5,b)}YQi(){this.wye||(this.wye=Date.now(),this.Yh(31,this.wye),this.$Uf())}ZQi(){this.Xqa(28)}$Qi(){this.Xqa(27)}aRi(){this.Xqa(40)}Bxk(a){const b=[];for(let h in a){var c=a[h];c&&Array.add(b,c.Presence)}return b}dRi(a){a&&(a=this.Bxk(a),this.Yh(38,a.length),this.Yh(37,0<a.length),this.Xqa(39));this.bQg.Fg(!0)}F0j(a){try{this.N8c.task.isCompleted||Da.a.Wa(a)||(this.Xqa(34),this.N8c.HM(!0))}catch(b){ba.ULS.sendTraceTag(51242146,
814,10,b.toString())}}G0j(a){if(!(Da.a.Wa(a)||"presenceUpdateNotificationReceived"in this.RX)){var b=Date.now();this.Yh(33,b);this.Rte=this.k0f(this.B2I,b);this.Yh(32,this.Rte);this.Yh(30,Da.a.count(a));this.Qo&&this.Yh(29,this.Qo.NSf)}}wUi(){return!this.N8c.task.isCompleted&&(!this.Qo||!this.Qo.NSf)&&!this.Rte}E0j(){this.Xqa(35);this.vj.kPc&&this.Yh(36,this.vj.kPc.getTime())}rRi(){this.aze&&!this.l6c&&(this.l6c=!0,this.aze.Xrf(Object(F.a)(this,this.Fjc,"onResourceTimingEntriesAvailable")))}Fjc(a,
b){try{a={};for(let c=0;c<b.entries.length;c++){const h=b.entries[c],m=ng.a.Nna(h.url);!this.kve&&m.endsWith("rtc2/signalr/negotiate")?(this.kve=!0,this.AFc(a,"Negotiate",h.EB)):m.endsWith("rtc2/signalr/connect")?(this.yzg=!0,this.AFc(a,"Connect",h.EB)):!this.Rve&&m.endsWith("rtc2/signalr/start")?(this.Rve=!0,this.AFc(a,"Start",h.EB)):m.endsWith("rtc2/findsession")&&(this.AFc(a,this.qte.toString()+"_FindSession",h.EB),this.qte++)}if(this.kve||this.yzg||this.Rve||0<this.qte)this.xEh(),this.ZUf(a)}catch(c){ba.ULS.sendTraceTag(51242147,
814,10,c.toString())}}AFc(a,b,c){this.fia(a,b+"FS",c.fetchStart);this.fia(a,b+"RS",c.responseStart);this.fia(a,b+"RE",c.responseEnd)}xEh(){this.l6c&&(this.l6c=!1,this.aze.Bhh(Object(F.a)(this,this.Fjc,"onResourceTimingEntriesAvailable")))}Xqa(a){this.Yh(a,Date.now())}Yh(a,b){this.G4h(Ix[a],b)}G4h(a,b){this.fia(this.k3c,a,b);this.fia(this.RX,a,b)}fia(a,b,c){b in a||(a[b]=c)}MNc(a){this.TQi(a);this.fia(a,"B2I",this.B2I);null!=this.fHasTabSwitch&&this.fia(a,"fHasTabSwitch",this.fHasTabSwitch);null!=
this.x2c&&this.fia(a,"firstCoauthoringStatus",this.x2c);this.appInitInteractivityReady&&this.fia(a,"appInitInteractivityReady",this.appInitInteractivityReady);this.appInitChromeReady&&this.fia(a,"appInitChromeReady",this.appInitChromeReady)}Zoh(){null==this.x2c&&(this.x2c=this.vj.hCa.result)}$Uf(){this.ZUf({})}ZUf(a){try{this.MNc(this.k3c),Da.a.forEach(this.k3c,(b,c)=>{b in this.wte||(this.wte[b]=c,a[b]=c)},null),0<Da.a.count(a)&&ba.ULS.sendTraceTag(41239941,828,50,Da.a.toJSON(a))}catch(b){ba.ULS.sendTraceTag(51242176,
814,10,b.toString())}}JYi(){ba.ULS.sendTraceTag(51242177,814,100,"FlushRecords: m_fPresenceUpdateLogged={0}, m_fPeoplesWellDisplayed={1}",this.pse,this.kse);if(!this.pse||!this.kse)try{this.MNc(this.RX),0<Da.a.count(this.RX)&&ba.ULS.sendTraceTag(51242178,814,50,Da.a.toJSON(this.RX))}catch(a){ba.ULS.sendTraceTag(51242179,814,10,a.toString())}}get B2I(){!this.uoe&&rg.a.instance.Fo(Uh.a.contentEditable)&&(this.uoe=rg.a.instance.ah(Uh.a.contentEditable));return this.uoe}get appInitInteractivityReady(){!this.doe&&
rg.a.instance.Fo("AppInitStatus_interactivityReady")&&(this.doe=rg.a.instance.ah("AppInitStatus_interactivityReady"));return this.doe}get appInitChromeReady(){!this.coe&&rg.a.instance.Fo("AppInitStatus_chromeReady")&&(this.coe=rg.a.instance.ah("AppInitStatus_chromeReady"));return this.coe}get fHasTabSwitch(){null==this.ure&&rg.a.instance.Fo(Uh.a.uud)&&(this.ure=rg.a.instance.ah(Uh.a.uud));return this.ure}k0f(a,b){return this.mfc?this.mfc.y2f(new Date(a),new Date(b)):-1}}Object(n.a)(tK,"PresencePerfLogger",
null,[507,106]);class uK{constructor(a,b,c){this.BRg=this.pcc=this.C3c=this.Ima=null;this.Rqe=!1;this.pze=null;this.ji=a;this.Q4=b;this.Eq=c}VTc(){this.Dub();return this.Ima}w7i(){this.Dub();return this.C3c}getFindSessionResponse(){return this.ji?this.ji.FindSessionResponse:null}f_f(){this.Dub();return this.pcc}ngj(){this.Dub();return this.BRg}lgj(){this.Dub();return this.pze}Nod(){this.Dub();return this.Rqe}K1j(){if(this.ji){const a=!!this.ji.PresenceException,b=!isNaN(this.ji.PresenceDownloadEditorTableHttpStatus)&&
200!==this.ji.PresenceDownloadEditorTableHttpStatus||!isNaN(this.ji.PresenceFindSessionHttpStatus)&&200!==this.ji.PresenceFindSessionHttpStatus,c={};c.EarlyFindSessionEnabled=this.Q4.presenceEarlyFindSessionEnabled;c.EditorCount=this.C3c?this.C3c.length:0;c.ShouldConnectToRtcByDefault=this.Rqe;c.EditorTableHttpStatus=this.ji.PresenceDownloadEditorTableHttpStatus;c.FindSessionHttpStatus=this.ji.PresenceFindSessionHttpStatus;c.CachedException=this.ji.PresenceException;c.IsFindSessionResponseEmpty=!this.ji.FindSessionResponse;
c.IsEditorTableResponseEmpty=!this.ji.CoauthHandlerResponse;c.RtcBootTokenContainsValue=!!this.pze;Ba.a.J(41501202,804,a||b?15:50,Da.a.toJSON(c))}}Dub(){if(this.ji&&!this.Ima)try{if(this.ji.CoauthHandlerResponse){const a=Sys.Serialization.JavaScriptSerializer.deserialize(this.ji.CoauthHandlerResponse);this.C3c=a.EditorTable;this.Ima=a.UserName;this.pcc=a.Email;this.BRg=a.RtcEndpointUrl;this.Rqe=a.FConnectByDefault;this.pze=a.RtcBootToken;this.Eq.O4g()}}catch(a){Ba.a.J(41501204,804,10,"PresencePrepCacheParser - caught exception when parse cache: "+
a)}}}Object(n.a)(uK,"PresencePrepCacheParser",null,[516]);class nD{constructor(a,b,c,h=5E3){if(!a)throw Error.create("RTCParams : ClientId is null");this.clientId=a;this.userSessionId=u.AFrameworkApplication.userSessionId;this.Eld=u.AFrameworkApplication.Eld;this.hca=u.AFrameworkApplication.Je;this.Iw=b;this.Aoh=c;this.Elh=h}}Object(n.a)(nD,"RtcParams",null,[]);class vK{constructor(a,b,c){this.q3j=a;this.mze=b;this.r1c=c}gsi(a,b,c){La.a.tu(a);La.a.tu(b);La.a.tu(c)}KOd(a,b,c,h){return h=!a&&0>b?h+
Math.abs(b):this.q3j?(c-b)/4:(c-b)/2}LOd(a,b,c){if(!this.r1c||!b)return c;if(0<=b.className.indexOf(wb.a.vN))if(b.previousSibling)b=b.previousSibling;else return c;const h=this.wTc(b,S.a.N0c),m=this.wTc(b,S.a.BPc);if(isNaN(h)||!h||isNaN(m)||!m||h>=m)return c;const y=new Sys.UI.Bounds(c.x,c.y,c.width,c.height);if(h>=.9*m)return c=(m-h)/2,y.y+=c,y.height-=2*c,y;a=this.iij(b,a);if(isNaN(a)||!a)return c;c=(a-h)/2;y.y+=c;y.height-=2*c;return y}Pij(a,b){if(!this.r1c)return 0;a=this.wTc(a,S.a.N0c);b=Math.ceil((a-
b)/2);if(isNaN(b)||0>b)b=0;return b}iij(a,b){let c=Object(ua.a)(1189,b);b||(c=Object(ua.a)(1189,this.mze.t5b(a)));if(c&&this.mze.fJj(c))return this.wTc(a,S.a.BPc);b=0;const h=a.getClientRects();h&&0<h.length&&(b=h[0],b=new Sys.UI.Bounds(Math.floor(b.left),Math.floor(b.top),Math.floor(b.width),Math.floor(b.height)),b=this.mze.pga(b,c,()=>a.offsetWidth/a.offsetHeight).height);return b}wTc(a,b){let c=a;for(a=null;!a&&c&&"P"!==c.tagName;)a=Y.a.ye(c,b),c=0<=c.className.indexOf(wb.a.aac)?c.previousSibling:
c.parentNode;b=0;a&&(b=parseInt(a.toString(),10));return b}}Object(n.a)(vK,"PptMeasureBoundsUsingSpansStrategy",null,[511]);class oD{constructor(){this.cIa=null}get Uhc(){return this.cIa?this.cIa.Uhc:0}get oqc(){return this.cIa?this.cIa.oqc:!1}get Rod(){return this.cIa?this.cIa.Rod:!1}e0b(a,b){b&&(this.cIa?this.cIa.e0b(a,b):b(null))}ihi(a){this.cIa=a}}Object(n.a)(oD,"PPTProcessImageStrategyProxy",null,[1188,372]);class pD{constructor(a,b){this.$Wh=a;this.Dif=b}get twk(){return this.$Wh}get RHe(){return this.Dif}V7k(a){this.Dif=
a}}Object(n.a)(pD,"PageHiddenRecord",null,[]);class wK{constructor(){this.cma=[];Ba.a.J(24440908,801,50,"Init PageHiddenMeter");if(this.sve=window.document.hidden){const a=new pD(new Date,new Date(9999,12,31));this.cma.push(a)}vb.a.instance.rb("Common.ITaskManager").Eb(new He.a(4,2,9E5,Object(F.a)(this,this.maintainPageHiddenRecords,"maintainPageHiddenRecords"),90,"2"));$addHandler(window,"visibilitychange",Object(F.a)(this,this.onVisibilityChange,"onVisibilityChange"))}y2f(a,b){const c=this.cma.length;
let h=0;if(0<c&&a<this.cma[c-1].RHe){a=a.getTime();b=b.getTime();for(let m=0;m<c;++m){const y=Math.max(this.cma[m].twk.getTime(),a),G=Math.min(this.cma[m].RHe.getTime(),b);y<G&&(h+=G-y)}}return h}onVisibilityChange(){Ba.a.J(24440910,801,50,"Page hidden: {0}",window.document.hidden);this.jNk()}jNk(){var a=window.document.hidden,b=new Date;this.sve!==a&&((this.sve=a)?(b=new pD(b,new Date(9999,12,31)),this.cma.push(b)):(a=this.cma.length,0<a&&this.cma[a-1].V7k(b)))}maintainPageHiddenRecords(){const a=
new Date;for(;0<this.cma.length&&9E5<+a-+this.cma[0].RHe;)Array.removeAt(this.cma,0)}}Object(n.a)(wK,"PageHiddenMeter",null,[501]);class qD{I5(a){let b=M.a.Qz(a);return b||(b=D.a.Qz(a))?b:(b=H.a.Qz(a))?b:""}}Object(n.a)(qD,"ActionNameResolver",null,[1187]);class rD{constructor(){this.va=new bd.a}AIk(){this.va.raiseEvent("CIU",Sys.EventArgs.Empty)}BIk(a){this.va.raiseEvent("CSC",a)}QIk(a){this.va.raiseEvent("ETC",a)}ueh(a){this.va.raiseEvent("TLSC",a)}RKk(a){this.va.raiseEvent("TCVEL",a)}RJk(){this.va.raiseEvent("PRTCC",
null)}uJk(){this.va.raiseEvent("LCK",null)}SNd(a){this.va.addHandler("CSC",a)}aPe(a){this.va.removeHandler("CSC",a)}TNd(a){this.va.addHandler("ETC",a)}Ahh(a){this.va.removeHandler("ETC",a)}tai(a){this.va.addHandler("TLSC",a)}jVk(a){this.va.removeHandler("TLSC",a)}lai(a){this.va.addHandler("TCVEL",a)}l$h(a){this.va.addHandler("PRTCC",a)}eih(a){this.va.removeHandler("PRTCC",a)}D8h(a){this.va.addHandler("LCK",a)}}Object(n.a)(rD,"CoauthEventSource",null,[1184,1185,1186]);class sD{constructor(){this.va=
new bd.a}HKk(){var a=new Sys.EventArgs;this.va.raiseEvent("OnShowHideAltTextPane",a)}gJk(a){this.va.raiseEvent("OnImageDescriptionReady",a)}VIk(a){this.va.raiseEvent("FRHRE",a)}uIk(a){this.va.raiseEvent("APIRE",a)}nJk(a){this.va.raiseEvent("IMARE",a)}W9h(a){this.va.addHandler("OnShowHideAltTextPane",a)}nUk(a){this.va.removeHandler("OnShowHideAltTextPane",a)}t9h(a){this.va.addHandler("OnImageDescriptionReady",a)}UTk(a){this.va.removeHandler("OnImageDescriptionReady",a)}m9h(a){this.va.addHandler("FRHRE",
a)}PTk(a){this.va.removeHandler("FRHRE",a)}O8h(a){this.va.addHandler("APIRE",a)}zTk(a){this.va.removeHandler("APIRE",a)}w9h(a){this.va.addHandler("IMARE",a)}WTk(a){this.va.removeHandler("IMARE",a)}}Object(n.a)(sD,"CoreExtEventSource",null,[1181,1182,1183]);var xK=d(1017);class tD extends xK.a{constructor(a,b,c,h,m,y,G){super(h,c,a,y,G);this.i2c=new Nd.a(0);this.EVa=b;this.Hwe=m}LBj(a,b){let c;(c=this.i2c).$(b,c.ga(b)+1);this.OPf(a.name,Object(F.a)(this,this.Rbg,"initPackageCallback"),a)}MBj(a,b){let c;
(c=this.i2c).$(b,c.ga(b)+1);this.PPf(a.name,Object(F.a)(this,this.Rbg,"initPackageCallback"),1,a)}Rbg(a){a.KBj()}ruh(a,b){return!!a&&!!b&&a.context.Vyf!==b.context.Vyf}MFe(a,b){if(b>=this.Hwe){const c=new Sys.StringBuilder;for(let h=0;h<a.length;++h)0<h&&c.append(","),c.append(String.format('{{"N":"{0}","D":{1}}}',a[h].name,kf.a.AY(a[h].duration,0)));ba.ULS.sendTraceTag(39966927,813,50,"{0}:{1}",c.toString(),kf.a.AY(b,0))}}onIdle(a){const b=[];this.i2c.forEach((c,h)=>{0<h&&(b.push(c),this.i2c.$(c,
0),this.EVa.j1c(c));return!0});ba.ULS.sendTraceTag(39966928,813,50,"[{0}]:{1}",b.join(","),kf.a.AY(a,0))}}Object(n.a)(tD,"DelayLoadedPackageInitializer",xK.a,[]);class Jx{constructor(a,b,c,h,m,y,G,U,ja){this.Kze=this.Jze=null;this.Ga=a;this.dJ=b;this.Eq=c;this.vj=h;this.ia=m;this.aJ=y;this.Qb=G;this.je=ja;this.Vbk=U;this.dJ.TNd(Object(F.a)(this,this.QOf,"editorTableUpdate"))}dispose(){this.dJ.Ahh(Object(F.a)(this,this.QOf,"editorTableUpdate"))}QOf(){const a=this.vj.e_;this.qQf();this.Eq.GZc&&(Ba.a.J(512496593,
814,50,"App::EditorTableUpdate; Refresh Peoples well; MyClientId: {0}; new editor table count: {1}",this.vj.VC,a.length),this.ia.processAction(H.a.O6a,2))}qQf(){if(!this.Eq.GZc&&this.vj.VC){Ba.a.J(23437903,814,50,"App::EnsurePresence; Presence not loaded yet. Ensure presence on editor table update");try{if(!this.Qb)throw Error.create("Presence is being loaded before the app frame");this.wsl()}catch(a){Ba.a.J(512496591,814,10,"App : EnsurePresence; Exception loading presence: {0}",a)}}}wsl(){Ba.a.J(512496590,
814,50,"App::EnsurePresence: trigger download js");if(this.Ga.stc)vb.a.instance.resolve("PowerPointWebEditor.ScriptLoader.IUnifiedScriptLoader").Gca("pptedit.presence",null,()=>d.e(11).then(d.bind(null,1231)));else{const a=Dx.a.create("pptedit.presence",this.KEi(),()=>d.e(11).then(d.bind(null,1231)));Jk.a.Wx(a)}}KEi(){this.Pvh.zS((a,b)=>{this.Vbk.qke=b.succeeded});return[this.Pvh]}get Shl(){this.Kze||(this.Kze=this.A1f());return this.Kze}get Pvh(){this.Jze||(this.Jze=this.HFi());return this.Jze}HFi(){return this.sbj()}sbj(){return QC.a.create(this.A1f(),
null,null,Fc.App.akg)}A1f(){return this.Ga.podsUseVersionLessJqueryAndSignalR?this.je.Cmj("jquery.signalr.merge.1.1"+Jx.cSd):u.AFrameworkApplication.Pj("jquery.signalr.merge.1.1",2)}}Jx.cSd=".min.js";Object(n.a)(Jx,"PresenceLoader",null,[]);class yK{constructor(a,b,c,h,m,y,G,U,ja){this.HGa=this.IGa=!1;this.wla=this.ola=null;this.Ga=a;this.fy=b;this.xX=c;this.Ea=h;this.Hcb=m;this.Cte=y;this.zb=G;this.zC=U;this.Zy=ja;this.v4=this.Ga.podsHtmlTextForEmbeddedFontsIsEnabled&&!!window.self.Promise&&this.Hcb.rkg}Ljd(a){if(this.v4&&
a&&!a.Al&&a.kzb)if(a.Zke)a.Zke=!1;else if(this.Ea.kYc(a.shapeNode)){var b=this.Ea.RTc(a.shapeNode);b.length&&(this.Zy&&this.Zy.isEnabled||this.Zy&&this.Zy.isEnabled?(this.ola=this.wla=null,this.HGa=this.IGa=!1,this.Zy&&this.Zy.isEnabled&&this.Zy.RS&&(this.Zy.Q$a(c=>{Ba.a.J(51217114,801,50,"CustomFontListDownloadAndParseCompleted");this.wla=c;this.SMc(a,b)}),this.Zy.RS.R$a(()=>{Ba.a.J(51217116,801,15,"CustomFontWebRequestFailed");this.IGa=!0;this.SMc(a,b)})),this.zC&&this.zC.isEnabled&&this.zC.RS&&
(this.zC.Q$a(c=>{Ba.a.J(41521282,801,50,"CloudFontListDownloadAndParseCompleted");this.ola=c;this.SMc(a,b)}),this.zC.RS.R$a(()=>{Ba.a.J(41494535,801,15,"CloudFontWebRequestFailed");this.HGa=!0;this.SMc(a,b)}))):this.IDh(a,b,null,null))}}UEa(a){return a?!0:!1}SMc(a,b){(this.UEa(this.ola)&&this.UEa(this.wla)||this.UEa(this.ola)&&this.IGa||this.HGa&&this.UEa(this.wla)||this.HGa&&this.IGa)&&this.IDh(a,b,this.ola,this.wla)}IDh(a,b,c,h){a&&!a.Al&&b&&b.length&&(Ba.a.J(41521286,801,50,"TryRemoveFidelityViewOnEmbeddedFontsLoaded"),
Promise.all(this.Cte.SIh(b,c,Object(F.a)(this.zC,this.zC.createFontUrl,"createFontUrl"),h,Object(F.a)(this.Zy,this.Zy.createFontUrl,"createFontUrl"),this.xX.bIh,Object(F.a)(this.xX,this.xX.createFontUrl,"createFontUrl"))).then(()=>{Ba.a.J(41521288,801,50,"WebFontsLoadCompleted");this.fy.OEa(()=>{this.zb.Eb(new He.a(2,1,0,()=>{a&&!a.Al&&(Ba.a.J(41494539,801,50,"TriggerDrawByRemoveFidelityViewOnEmbeddedFontsLoaded"),a.fDa(),a.Zke=!0,a.xA())},90,"109"))})},m=>{Ba.a.J(41494541,801,10,"WebFontsLoad failed: {0}",
m.toString());a&&!a.Al&&a.shapeNode&&(a.shapeNode.yTa=!0)}))}}Object(n.a)(yK,"RemoveShapeFidelityViewForEmbeddedFontController",null,[515]);class zK{constructor(a,b,c,h,m,y,G,U,ja){this.HGa=this.IGa=!1;this.wla=this.ola=null;this.dma=new Qa.a;this.Jua=a;this.hn=b;this.xX=c;this.Ea=h;this.Hcb=m;this.Cte=y;this.zb=G;this.zC=U;this.Zy=ja}NRk(a){window.self.Promise&&this.Hcb.rkg?this.zb.Eb(new He.a(2,1,0,()=>{try{this.removeFidelityViewOnWebFontsLoaded(a)}catch(b){Ba.a.J(40429063,801,10,"RemoveFidelityViewOnWebFontsLoaded exception {0}",
b),this.VNb(a)}},90,"102")):this.VNb(a)}VNb(a){if(a&&a.length){for(var b of a)b.Al||(b.kzb=!0,b.xA()),this.hn.lqh();b=0;rg.a.instance.Fo(Uh.a.$P)&&(b=(new Date).getTime()-rg.a.instance.ah(Uh.a.$P));Ba.a.J(560837531,801,50,"RemoveFidelityView - MissingFonts: {0}, Total Duration Since Viewable : {1}",this.dma.count,b);if(0<this.dma.count){const c=new Map;c.set("PendingFontsCount",this.dma.count.toString());c.set("FidelityViewDuration",b.toString());Mf.Health.instance.recordQosError("RemoveFidelityViewWithMissingFonts",
["MissingFont"],!1,!1,!0,!1,Object.assign(new ql.a,{extendedProperties:c}))}a.length=0;Ba.a.J(40429065,801,50,"shapeViewElementsDuringBoot draw done")}}removeFidelityViewOnWebFontsLoaded(a){Ba.a.J(40429067,801,50,"RemoveFidelityViewOnWebFontsLoadedAndBootComplete");for(var b of a)!b.Al&&b.XA&&b.fDa();b=new Date;for(const c of a)if(!c.Al){const h=this.Ea.R9a(c.shapeNode);for(const m of h)this.dma.contains(m)||this.dma.add(m)}Ba.a.J(40429069,801,50,"GetUnsupportedFontsDuration: {0}",+new Date-+b);if(this.dma.count){if(!this.Zy||
!this.Zy.isEnabled)if(!Rd.a("EnableRemoveFidelityCloudServiceCheck")||!this.zC||!this.zC.isEnabled){this.Qgh(a,this.dma,null,null);return}this.ola=this.wla=null;this.HGa=this.IGa=!1;this.Zy&&this.Zy.isEnabled&&(this.Zy.Q$a(c=>{Ba.a.J(51217157,801,50,"CustomFontListDownloadAndParseCompleted");this.wla=c;this.TMc(a,this.dma)}),this.Zy.RS&&this.Zy.RS.R$a(()=>{Ba.a.J(51217159,801,50,"CustomFontWebRequestFailed");this.IGa=!0;this.TMc(a,this.dma)}));this.zC&&this.zC.isEnabled&&(this.zC.Q$a(c=>{Ba.a.J(40429075,
801,50,"CloudFontListDownloadAndParseCompleted");this.ola=c;this.TMc(a,this.dma)}),this.zC.RS&&this.zC.RS.R$a(()=>{Ba.a.J(40429083,801,50,"CloudFontWebRequestFailed");this.HGa=!0;this.TMc(a,this.dma)}))}else Ba.a.J(40429071,801,50,"No unsupported fonts"),this.VNb(a)}UEa(a){return a?!0:!1}TMc(a,b){(this.UEa(this.ola)&&this.UEa(this.wla)||this.UEa(this.ola)&&(this.IGa||Rd.a("FidelityCustomServiceDisableCheck")&&!this.Zy.isEnabled)||this.HGa&&this.UEa(this.wla)||this.HGa&&this.IGa)&&this.Qgh(a,b,this.ola,
this.wla)}Qgh(a,b,c,h){b&&b.count?(Ba.a.J(41521300,801,50,"RemoveFidelityViewOnWebFontsLoadedInternal"),Promise.all(this.Cte.SIh(b.toArray(),c,Object(F.a)(this.zC,this.zC.createFontUrl,"createFontUrl"),h,Object(F.a)(this.Zy,this.Zy.createFontUrl,"createFontUrl"),this.xX.bIh,Object(F.a)(this.xX,this.xX.createFontUrl,"createFontUrl"))).then(m=>{Ba.a.J(40429079,801,50,"WebFontsLoadCompleted");if(m)for(let y=0;y<m.length;y++)if(m[y])for(let G=0;G<m[y].length;G++)if(m[y][G]){Ba.a.J(40429081,801,50,"Status {0}",
m[y][G].status);const U=m[y][G].family;ta.a.Wa(U)||m[y][G].status!==Qc.loaded||-1===U.lastIndexOf("_")||b.remove(U.substring(0,U.lastIndexOf("_")))}this.VNb(a)},m=>{Ba.a.J(41521304,801,10,"WebFontsLoad failed: {0}",m.toString());this.zb.Eb(new He.a(2,1,this.Jua.pptWaitForWebFontsLoadingTimeoutMs,()=>{Ba.a.J(40429073,801,50,"Check removing Fidelity View");this.VNb(a)},90,"103"))})):this.VNb(a)}}Object(n.a)(zK,"RemoveShapeFidelityViewOnBootController",null,[514]);class AK{constructor(a){this.ia=a}zhl(){this.Evh(ResourceStrings.l_SessionTimeoutErrorMessage)}Ahl(){this.Evh(ResourceStrings.l_SessionTimeoutErrorMessageForCommentDraft)}Evh(a){const b=
new Rf.StandardDialog;b.xd=4;b.ig="PPTTimeoutDialog";b.Xe(1,ResourceStrings.L_Refresh);b.Xe(2,ResourceStrings.L_Close);b.cP(ResourceStrings.l_GenericDialogTitle,a,Object(F.a)(this,this.a4k,"sessionTimeoutDialogHandler"))}a4k(a,b){1===a?(Ba.a.J(24261827,801,50,"Button={0};DontShowAgain={1}",a,b),this.idl()?(Ba.a.J(24655755,801,50,"Session Token is expired or about to expire, refresh the page."),this.ia.processAction(M.a.refreshPage,2)):this.ia.La(M.a.refresh,2,{refreshtrigger:"SessionTimeoutIndicator::SessionTimeoutDialogHandler"})):
(Ba.a.J(24261829,801,50,"Button={0};DontShowAgain={1}",a,b),this.ia.processAction(M.a.jvb,2))}idl(){const a=u.AFrameworkApplication.hm,b=u.AFrameworkApplication.bia;return 0<a&&(new Date).getTime()>=a-1E3*b}}Object(n.a)(AK,"SessionTimeoutIndicator",null,[508]);class BK{constructor(){this.q6c=!1;this.DGg=[]}get qke(){return this.q6c}set qke(a){if(!this.q6c&&(this.q6c=a)){for(const b of this.DGg)b();Array.clear(this.DGg)}}}Object(n.a)(BK,"SignalRLoadCompletedListener",null,[509]);class Fz{constructor(a,
b,c,h,m,y,G){this.pTg=this.ACg=!1;this.Pea=this.Wze=null;this.DFg=this.Pve=!1;this.qTg=this.rTg=this.gGg=this.hGg=0;this.ia=a;this.j5j=b;this.Rp=h;this.jAe=y;this.Lc=m;this.gk=G;this.Lc.asf(Object(F.a)(this,this.Ypk,"onLazySorterViewActorActionRegistrationHandler"))}vb(){this.gk||(this.ia.ya(M.a.Xfa,xb.a.application,Object(F.a)(this,this.phl,"showStatusBarSorterView")),this.ia.ya(M.a.Usb,xb.a.application,Object(F.a)(this,this.Bti,"closeStatusBarSorterView")))}phl(a,b,c,h,m){if(2!==c)return 32;if(this.Pve)return this.jAe.instance.Xfa(a,
b,c,h,m);this.Lc.asf(Object(F.a)(this,this.Nwh,"sorterViewEventHandler"));this.JZj();this.ACg||(this.Cme(),this.DFg=!0);return 32}Bti(a,b,c,h,m){if(2!==c)return 32;this.Lc.sTk(Object(F.a)(this,this.Nwh,"sorterViewEventHandler"));(this.Pea=document.getElementById("SlideSorterViewLoadingElementId"))&&document.getElementById("WACDocumentPanel").removeChild(this.Pea);return this.Pve?this.jAe.instance.Usb(a,b,c,h,m):32}Cme(){this.pTg||(this.pTg=!0,this.Wze=this.IZj(),this.Wze.zS(Object(F.a)(this,this.otk,
"onSlideSorterGridLoaded")),Jk.a.Wx(this.Wze),this.hGg=Date.now())}otk(){this.ACg=!0;this.Rp&&this.Rp.C5("SlideSoterGridDownloadFinished");this.gGg=Date.now();const a=rg.a.instance;a&&(a.ic("SlideSorterOnDemandLoad",this.DFg),a.ic("SlideSorterPkgST",this.hGg),a.ic("SlideSorterPkgET",this.gGg))}JZj(){this.ia.processAction(M.a.u_b,2);this.Pea=cf.a.Fe();this.Pea.id="SlideSorterViewLoadingElementId";this.Pea.className="sorterview-ui-loading-element-class";const a=cf.a.Fe();a.className="sorterview-ui-loading-textmessage-class";
a.innerText=ResourceStrings.l_SorterViewLoadingTextMessage;const b=cf.a.Fe();b.className="sorterview-ui-loading-spinner-class";const c=cf.a.Fe();c.className="sorterview-ui-loading-spinner-inner-class";b.appendChild(c);this.Pea.appendChild(b);this.Pea.appendChild(a);document.getElementById("WACDocumentPanel").appendChild(this.Pea);this.rTg=Date.now()}Nwh(){(this.Pea=document.getElementById("SlideSorterViewLoadingElementId"))&&document.getElementById("WACDocumentPanel").removeChild(this.Pea);this.qTg=
Date.now();this.jAe.instance.Xfa(M.a.Xfa,null,2,null,null);const a=rg.a.instance;a&&(a.ic("SlideSorterLoadingExpST",this.rTg),a.ic("SlideSorterLoadingExpET",this.qTg))}Ypk(){this.Pve=!0}IZj(){var a=u.AFrameworkApplication.Pj("slidegrid"+Fz.cSd,5);a=this.j5j.I0b(a);return Dx.a.create("pptedit.sorterGrid",this.gk?null:[a],()=>d.e(16).then(d.bind(null,1236)))}dispose(){}}Fz.cSd=".min.js";Object(n.a)(Fz,"SorterViewActorMain",null,[106,517]);class Ev{constructor(a){this.lhf=a}onBlur(a,b){this.Xme("OnBlur",
a,b);(a=na.InteractiveViewManager.instance.Rd)&&C.FocusManager.KM()&&a.endEditing(!1,20)}setFocus(a,b){this.Xme("SetFocus",a,b);const c=this.lhf();c&&!c.isActive&&(a.name!==I.AppFrame.sxj&&a.name!==I.AppFrame.jZi||b.name!==A.AFrame.wW||(c.Vod=!1),c.JRi())}onFocus(a,b){this.Xme("OnFocus",a,b);if(C.FocusManager.KM()&&(b=this.lhf())&&b.isActive){var c=!!b.editingView;a=a?a.name:"";v.a.Ni&&(a.startsWith(Cf.a.C1b)&&(Hh.GrippersManager.instance.k7b=!0),a.startsWith(Cf.a.C1b)||a===A.AFrame.Lfb||a===A.AFrame.ezh)&&
(c=!1);c&&this.IRi(b,a)}}IRi(a,b){const c=a.editingView,h=C.FocusManager.instance();h.dce=!0;a.KR();1===c.mode&&3!==u.AFrameworkApplication.Ta.mode&&b===A.AFrame.Lfb&&(a.Lb.Moa.g3d(),c.Uib());h.dce=!1}Xme(a,b,c){a=String.format("InteractiveViewFocusScopeActions.{0} called. (Scope is moving from '{1}' to '{2}')",a,b?b.name:null,c?c.name:null);mh.a.instance.mw&&ba.ULS.sendTraceTag(38293642,321,15,String.format("{0} {1}","Handling focus/blur events while TaskManager.Instance.IsYielding!",a))}static BFf(a){const b=
new Ev(()=>a),c=a.vI,h=C.FocusManager.instance();h.Gc(c).xBa(Object(F.a)(b,b.onBlur,"onBlur"));h.Gc(c).Wba(Object(F.a)(b,b.setFocus,"setFocus"));h.Gc(c).Uba(Object(F.a)(b,b.onFocus,"onFocus"))}}Object(n.a)(Ev,"InteractiveViewFocusScopeActions",null,[]);class uD extends Ev{constructor(a){super(()=>a);this.Fb=a}zwk(){this.Fb.isActive||this.Fb.nRi()}static Exi(a,b){const c=new uD(a);a=a.vI;b.Gc(a).xBa(Object(F.a)(c,c.onBlur,"onBlur"));b.Gc(a).Wba(Object(F.a)(c,c.zwk,"pageViewSetFocus"));b.Gc(a).Uba(Object(F.a)(c,
c.onFocus,"onFocus"))}}Object(n.a)(uD,"PageViewInteractiveViewFocusScopeActions",Ev,[]);class Gz{constructor(){this.Ga=this.K=null;this.gCg=!1}get name(){return"PowerPointWebEditor.CoreExt"}$b(a){this.K=a;this.Ga=a.resolve("PowerPointWebEditor.IApplicationSettings");this.Ga.Xdg&&a.register(501,"PowerPointWebEditor.IPageHiddenMeter").ma().oa(()=>new wK);Gz.axi(this.K);a.register(rD,"PowerPointWebEditor.CoreExt.CoauthEventSource").as("PowerPointWebEditor.CoreExt.ICoauthEventSource").as("PowerPointWebEditor.CoreExt.ICoauthEventNotifier").as("PowerPointWebEditor.CoreExt.ICoauthEventHandler").ma().oa(()=>
new rD);a.register(sD,"PowerPointWebEditor.CoreExt.CoreExtEventSource").as("PowerPointWebEditor.CoreExt.ICoreExtEventSource").as("PowerPointWebEditor.CoreExt.ICoreExtEventNotifier").as("PowerPointWebEditor.CoreExt.ICoreExtEventHandler").ma().oa(()=>new sD);a.register(502,"Common.IColorTable").ma().oa(()=>new qK);a.register(Ez,"PowerPointWebEditor.CoauthStateCache").as("PowerPointWebEditor.ICoauthStateGetter").as("PowerPointWebEditor.ICoauthStateSetter").ma().oa(()=>new Ez(a.resolve("PowerPointWebEditor.CoreExt.ICoauthEventNotifier"),
a.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),new sb.a(()=>vb.a.instance.Ja("Common.IRenameProps"))));a.register(503,"PowerPointWebEditor.IDocNotifyClient").ma().oa(()=>new kD(this.Ga,a.resolve("PowerPointWebEditor.IApplicationContext"),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.resolve("PowerPointWebEditor.IPopSessionState"),a.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),a.resolve("PowerPointWebEditor.IErrorDialog"),a.resolve("PowerPointWebEditor.IErrorHandler"),a.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),
this.Ga.wg?a.resolve("PowerPointWebEditor.PodsPopsCore.ISessionHealthManager"):null,(b,c,h,m,y,G)=>{a.resolve("PowerPointWebEditor.IPPTWebService").N9d(c,h,m,y,G)},!1));a.register(504,"PowerPointWebEditor.IPodsDocNotifyClient").ma().oa(()=>new kD(this.Ga,a.resolve("PowerPointWebEditor.IApplicationContext"),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.resolve("PowerPointWebEditor.IPopSessionState"),a.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),a.resolve("PowerPointWebEditor.IErrorDialog"),
a.resolve("PowerPointWebEditor.IErrorHandler"),a.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),a.resolve("PowerPointWebEditor.PodsPopsCore.ISessionHealthManager"),(b,c,h,m,y,G,U,ja,va)=>{a.resolve("PowerPointWebEditor.IPopWebService").SSc(b,c,h,m,y,G,U,ja,va)},!0));a.register(505,"PowerPointWebEditor.IContentTimeStampManager").ma().oa(()=>new oK);a.register(Dv,"PowerPointWebEditor.CoauthSubscriptionManager").as("PowerPointWebEditor.ICoauthSubscriptionManager").ma().oa(()=>new Dv(a.resolve("PowerPointWebEditor.IDocNotifyClient"),
this.Ga.wg?a.resolve("PowerPointWebEditor.IPodsDocNotifyClient"):null,a.resolve("PowerPointWebEditor.IPopSessionState"),a.resolve("PowerPointWebEditor.IThumbnailNavigationViewController"),a.resolve("PowerPointWebEditor.IContentTimeStampManager"),a.resolve("PowerPointWebEditor.ICoauthStateGetter"),a.resolve("PowerPointWebEditor.IFunctionThrottlerFactory"),a.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),
a.resolve("PowerPointWebEditor.NotificationManager"),this.Ga.XNe,this.Ga.podsPushThumbnailImageIds));a.register(jD,"PowerPointWebEditor.CoauthNotificationManager").ma().oa(()=>new jD(a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.resolve("PowerPointWebEditor.IThumbnailNavigationViewController"),a.resolve("PowerPointWebEditor.IDocNotifyClient"),this.Ga.wg?a.resolve("PowerPointWebEditor.IPodsDocNotifyClient"):null,a.resolve("PowerPointWebEditor.ICoauthStateSetter"),a.resolve("PowerPointWebEditor.IContentTimeStampManager"),
a.resolve("PowerPointWebEditor.ICoauthSubscriptionManager"),a.resolve("PowerPointWebEditor.IPPTWorkspace"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.IInboundHelper"),a.Ja("PowerPointWebEditor.IPrefetchManager"),a.resolve("PowerPointWebEditor.IErrorHandler"),a.resolve("PowerPointWebEditor.Core.ICoreEventNotifier"),a.resolve("PowerPointWebEditor.View.IViewEventNotifier"),a.resolve("PowerPointWebEditor.CoreExt.ICoreExtEventNotifier"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventNotifier"),
a.resolve("PowerPointWebEditor.PodsPopsCore.IPopSessionManager"),a.resolve("PowerPointWebEditor.Core.IPodsPopsEventNotifier"),a.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.Ga,a.resolve("Common.DragInputManager"),a.resolve("Common.ITaskManager"),a.resolve("PowerPointWebEditor.Application.IReadOnlyManager"),a.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),a.resolve("PowerPointWebEditor.IBusinessBarController")));a.register(Jx,"PowerPointWebEditor.PresenceLoader").ma().oa(()=>new Jx(this.Ga,
a.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler"),a.resolve("PowerPointWebEditor.ICoauthStateSetter"),a.resolve("PowerPointWebEditor.ICoauthStateGetter"),a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.IPPTApp"),a.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),a.resolve("PowerPointWebEditor.ISignalRLoadCompletedListener"),a.resolve("PowerPoint.IPathManager")));a.register(rK,"PowerpointPresence.PresenceEmailConverter").as("PowerpointPresence.IPresenceEmailConverter").ma();
a.register(506,"PowerpointPresence.IPresenceColorProvider").ma().oa(()=>new pQ.a(a.resolve("Common.App.People.IPeopleColorUtils"),a.resolve("PowerPointWebEditor.IApplicationSettings").fjg,a.resolve("PowerPointWebEditor.IApplicationSettings").podsDefaultToRtcForPresenceEnabled));a.register(507,"PowerpointPresence.IPresencePerfLogger").ma().oa(()=>new tK(a.rb("PowerPointWebEditor.IPageHiddenMeter"),a.resolve("PowerPointWebEditor.IApplicationSettings").podsLogRealTimeChannelResourceTiming?a.resolve("Common.NetworkTiming.IResourceTimingLogger"):
null,a.resolve("PowerPointWebEditor.ICoauthStateGetter"),a.Ja("PowerPointWebEditor.PodsPops.IPodSeamlessFailoverManager")));a.register(nD,"PowerpointPresence.RtcParams").ma().oa(()=>new nD(a.resolve("PowerPointWebEditor.ICoauthStateGetter").VC,a.resolve("PowerPointWebEditor.IApplicationContext").Y4f(),a.Ja("Common.ISessionExpirationManager"),a.resolve("Common.IAppSettingsManager").Fc("RTCReconnectionSlowDurationMilliseconds",5E3)));a.register(508,"PowerPointWebEditor.ISessionTimeoutIndicator").ma().oa(()=>
new AK(a.resolve("Common.IActionManager")));a.register(509,"PowerPointWebEditor.ISignalRLoadCompletedListener").ma().oa(()=>new BK);a.register(hD,"PowerPointWebEditor.SessionLifetimeManager").as("PowerPointWebEditor.ISessionLifetimeManager").ma().oa(()=>new hD(this.Ga,a.resolve("Common.ITaskManager"),a.resolve("PowerPointWebEditor.IApplicationContext"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.Ja("PowerPointWebEditor.IGetDocumentCopyHelper"),a.resolve("PowerPointWebEditor.Core.ICoreEventNotifier"),
a.resolve("PowerPointWebEditor.IErrorHandler"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),a.resolve("Box4.IReplicationScheduler"),a.resolve("PowerPointWebEditor.ISessionTimeoutIndicator"),a.Ja("PowerPointWebEditor.PodsPops.IPodSeamlessFailoverManager"),a.Ja("PowerPointWebEditor.ICommentSessionManager")));a.register(gD,"PowerPointWebEditor.SessionCleanupHandler").ma().oa(()=>new gD(a.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),
a.resolve("PowerPointWebEditor.BootStorage.ICoreOutboundHelper"),a.resolve("PowerPointWebEditor.Storage.ISaveAndCloseHandler"),a.resolve("PowerPointWebEditor.IPptSelectionManager")));a.register(510,"Common.IProcessInputStrategy").ma().oa(()=>new Ts(a.resolve("Common.IActionManager"),this.Ga,a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("Common.IF6Manager")));this.Ga.Ks||a.register(sK.a,"PowerpointPresence.PresenceEventSource").as("PowerpointPresence.IPresenceEventSource").as("PowerpointPresence.IPresenceEventNotifier").as("PowerpointPresence.IPresenceEventHandlers").ma().oa(()=>
new sK.a);a.register(511,"Box4.TextMetricsApi.IMeasureBoundsUsingSpansStrategy").ma().oa(()=>new vK(this.Ga.pptEditorDifferentLineHeightEnabled,a.resolve("Box4.IRotatingCoordinateConverter"),this.Ga.Vig));a.register(512,"Box4.TextMetricsApi.ITextMetricsHelper").ma().oa(()=>new da);a.register(513,"PowerPointWebEditor.IThumbnailNavPaneDragAdapter").ma().oa(()=>new pK(a.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView"),a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("Common.IActionManagerExtended"),
a.resolve("PowerPointWebEditor.IPPTWorkspace"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("Common.DragInputManager"),a.resolve("PowerPointWebEditor.IPresentationReader"),a.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),u.AFrameworkApplication.isRtl,this.Ga.djg,a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.Graph.IPptGraphTransactionFactory"),this.Ga.tC,this.Ga.Ije));a.register(514,"PowerPointWebEditor.IRemoveShapeFidelityViewOnBootController").ma().oa(()=>
new zK(a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.IImageViewManager"),a.resolve("PowerPointWebEditor.Fonts.IEmbeddedFontsManager"),a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.Fonts.IFontFaceSetObserver"),a.resolve("PowerPointWebEditor.Fonts.IFontsObserver"),a.resolve("Common.ITaskManager"),a.resolve("Box4.CloudFontService"),a.resolve("Box4.CustomFontService")));a.register(515,"PowerPointWebEditor.IRemoveShapeFidelityViewForEmbeddedFontController").ma().oa(()=>
new yK(a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.IAppBootCompletedListener"),a.resolve("PowerPointWebEditor.Fonts.IEmbeddedFontsManager"),a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.Fonts.IFontFaceSetObserver"),a.resolve("PowerPointWebEditor.Fonts.IFontsObserver"),a.resolve("Common.ITaskManager"),a.resolve("Box4.CloudFontService"),a.resolve("Box4.CustomFontService")));a.register(qD,"PowerPointWebEditor.ActionNameResolver").as("PowerPointWebEditor.IActionNameResolver").ma().oa(()=>
new qD);a.register(oD,"PowerPointWebEditor.PPTProcessImageStrategyProxy").as("PowerPointWebEditor.IPPTProcessImageStrategy").as("Box4.IProcessImageStrategy").ma().oa(()=>new oD);a.register(tD,"PowerPointWebEditor.DelayLoadedPackageInitializer").ma().oa(()=>{let b=2;const c=vb.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").pptDelayLoadedPackageInitializerTaskPriority;0<=c&&6>c?b=c:Ba.a.J(512360583,809,50,"Invalid delay loaded initializer task priority:{0}",c);return new tD(vb.a.instance.resolve("Common.ITaskManager"),
vb.a.instance.resolve("PowerPointWebEditor.Core.IBundleMetricRecorder"),vb.a.instance.resolve("PowerPointWebEditor.Core.IPerformanceHelper"),vb.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").delayLoadedPackageInitTimeSliceInMs,vb.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").pptEditorCPUMeterProfilingLogThresholdInMS,b,94)});a.register(516,"PowerpointPresence.IPresencePrepCacheParser").ma().oa(()=>new uK(window.self,a.resolve("PowerPointWebEditor.IApplicationSettings"),
a.resolve("PowerPointWebEditor.ICoauthStateSetter")));a.register(517,"PowerPointWebEditor.ISorterViewActorMain").oa(()=>new Fz(u.AFrameworkApplication.Ta,a.resolve("PowerPointWebEditor.IDelayLoadedScriptResourceFactory"),a.resolve("PowerPointWebEditor.IPPTApp").Qlg,a.resolve("PowerPointWebEditor.ISessionState"),a.resolve("PowerPointWebEditor.View.IViewEventSource"),a.Ja("PowerPointWebEditor.ISorterViewActorLazy"),a.resolve("PowerPointWebEditor.IApplicationSettings").Ks)).ma();a.resolve("PowerPointWebEditor.ISorterViewActorMain")}init(){var a=
window.g_hermesExtJS;void 0!==a&&null!==a&&rg.a.instance.ic("FirstExtJsExecTime",a);a=new nB.a("CoreExtPackage::Init");try{this.K.resolve("PowerPointWebEditor.IAppBootCompletedListener").uka&&this.G1g();this.K.resolve("PowerPointWebEditor.IAppBootCompletedListener").OEa(()=>{this.K.resolve("Common.ITaskManager").Eb(new He.a(0,1,0,Object(F.a)(this,this.wmk,"onBootComplete_DelayExecuted"),90,"21"))});this.Ga.Xdg&&this.K.resolve("PowerPointWebEditor.IPageHiddenMeter");this.K.resolve("Common.IProcessInputStrategy");
this.K.resolve("PowerPointWebEditor.SessionCleanupHandler");this.K.resolve("PowerPointWebEditor.Graph.GraphNodeDelayConnectValidator").disable();this.K.resolve("Box4.IEditingView");const b=this.K.resolve("PowerPointWebEditor.View.IPPTPageView");uD.Exi(b,this.K.resolve("Common.IFocusManager"));b.cCi(this.K.resolve("PowerPointWebEditor.ShapeManipulation.IPPTDragSelectionDragAdapter"));this.K.resolve("PowerPointWebEditor.IThumbnailNavPaneDragAdapter");this.K.resolve("PowerPointWebEditor.DelayLoadedPackageInitializer");
this.K.resolve("PowerPointWebEditor.IRemoveShapeFidelityViewForEmbeddedFontController");this.K.resolve("PowerPointWebEditor.IPPTApp").vnk()}finally{a&&a.dispose()}}dispose(){this.K.resolve("PowerPointWebEditor.IPrefetchManager").dispose();this.K.resolve("PowerPointWebEditor.SessionCleanupHandler").dispose();this.K.resolve("PowerPointWebEditor.ICoauthSubscriptionManager").dispose();this.K.resolve("PowerPointWebEditor.IDocNotifyClient").dispose();this.K.resolve("PowerPointWebEditor.IPodsDocNotifyClient").dispose();
this.K.resolve("PowerPointWebEditor.PodsPops.IPopSessionInfoClient").dispose()}G1g(){const a=new nB.a("App::DelayLoadRibbon");try{this.K.resolve("PowerPointWebEditor.IRibbonUser")}finally{a&&a.dispose()}this.gCg=!0;Rd.a("FixBootRequestForDeepLink")||this.K.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView").p_a(this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager").Ba)}Fxj(){this.K.resolve("PowerPointWebEditor.IApplicationSettings").disableRibbon&&(document.getElementById("PptEditingRibbon").parentNode.style.display=
"none");this.K.resolve("PowerPointWebEditor.IApplicationSettings").disableTitleBar&&(document.getElementById("AppHeaderPanel").style.display="none",document.getElementById("AppHeaderPanel").style.visibility="hidden");this.K.resolve("PowerPointWebEditor.IApplicationSettings").disableStatusBar&&(document.getElementById("WACStatusBarContainer").style.display="none");this.K.resolve("PowerPointWebEditor.IApplicationSettings").disableNotes&&(document.getElementById("EditingNotesPanel").parentNode.style.display=
"none")}sdi(){"bottom"===this.K.resolve("PowerPointWebEditor.IApplicationSettings").thumbnailPos&&(this.oPd("WACDocumentPanelContent","Horizontal"),this.oPd("EditingThumbnailsPanel","Horizontal"),this.oPd("EditingThumbnailsPanel","EditingThumbnailsPanelShadow"))}oPd(a,b){let c=document.getElementById(a).getAttribute("class").toString();c+=" "+b;document.getElementById(a).setAttribute("class",c)}uge(){const a=this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager").Ba;if(a){const b=new t.GraphTransaction(2);
try{b.kd(a),a.qda(16)}finally{b&&b.dispose()}}}jac(a,b){const c=this.K.resolve("PowerPointWebEditor.ISessionState");a.zS(()=>{c&&c.C5(b+"DownloadFinished")});Jk.a.Wx(a)}$Yj(){if(this.Ga.stc)this.K.resolve("PowerPointWebEditor.ScriptLoader.IUnifiedScriptLoader").Gca("pptedit.comment",null,()=>d.e(7).then(d.bind(null,1227)));else{const a=Dx.a.create("pptedit.comment",null,()=>d.e(7).then(d.bind(null,1227)));this.jac(a,"comment")}}ZYj(){if(this.Ga.stc)this.K.resolve("PowerPointWebEditor.ScriptLoader.IUnifiedScriptLoader").Gca("pptedit.chronosslim",
null,()=>d.e(5).then(d.bind(null,1223)));else{const a=Dx.a.create("pptedit.chronosslim",null,()=>d.e(5).then(d.bind(null,1223)));this.jac(a,"chronosslim")}}wmk(){this.K.resolve("PowerPointWebEditor.IPrefetchManager");this.gCg||this.G1g();this.Fxj();this.sdi();const a=this.K.resolve("PowerPointWebEditor.ISessionState");this.Ga.separateDownloadSignalREnabled&&this.K.resolve("PowerPointWebEditor.ScriptLoader.IUnifiedScriptLoader").Gca(this.K.resolve("PowerPointWebEditor.PresenceLoader").Shl,(h,m)=>{Fc.App.akg()&&
(this.K.resolve("PowerPointWebEditor.ISignalRLoadCompletedListener").qke=m.succeeded)},null);const b=()=>{Ba.a.J(512360582,809,50,"Start to download chronos.js file");this.$Yj();this.ZYj();this.Ga.mwh||this.K.resolve("PowerPointWebEditor.ISorterViewActorMain").Cme()},c=()=>{this.K.resolve("PowerPointWebEditor.IAppBootCompletedListener").Kdg(()=>{b()})};(new Fq.a(this.Ga.sfa)).QRj?this.K.resolve("PowerPointWebEditor.ShapeSVG.IShapeSVGDependencyLoader").Dng().continueWith(()=>{this.uge()}).continueWith(()=>
{c()}):c();this.K.resolve("PowerPointWebEditor.ISessionTimeUpdater").T0e();this.K.resolve("PowerPointWebEditor.ISessionLifetimeManager").start();a&&a.C5("ChronosStartDownloadTime");try{if(this.Ga.wacAirSpaceResourceLink){const h=Rn.a.J_b("wacairspaceanimationlibrary.js"),m=QC.a.create(h,null,null);Jk.a.Wx(m)}}catch(h){Ba.a.J(512360581,814,10,"App : OnBootComplete; Exception loading wacAirSpace Resource: {0}",h)}this.Ga.wg&&this.K.resolve("PowerPointWebEditor.PodsPops.IPopSessionInfoClient").$Cj();
u.AFrameworkApplication.fa.jf(()=>{gQ.a.instance.dri()});MSOJS.ClientUtils.InitUrls(u.AFrameworkApplication.JZk,u.AFrameworkApplication.HZk,u.AFrameworkApplication.IZk)}static main(){u.AFrameworkApplication.Tg&&v.a.fg?Ba.a.J(512360580,809,15,"Firefox attempts to load core ext package when App is disposing"):r.a.instance.Dc(new Gz)}static axi(a){a.register(518,"PowerPointWebEditor.IPrefetchManager").ma().oa(()=>new Dp(a.resolve("PowerPointWebEditor.IPPTWorkspace"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
a.resolve("PowerPointWebEditor.Image.IImageManager"),a.resolve("PowerPointWebEditor.ICoauthStateGetter"),a.resolve("PowerPointWebEditor.IGraphHotColdManager"),a.resolve("PowerPointWebEditor.IThumbnailNavigationViewController"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("Common.ITaskManager"),a.resolve("PowerPointWebEditor.ISlideReader"),a.resolve("PowerPointWebEditor.IInboundHelper"),a.resolve("Box4.Graph.IGraphInstance").Ad(8),a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),
a.resolve("PowerPointWebEditor.ISlideCacheStrategy"),a.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),a.resolve("PowerPointWebEditor.IAppBootCompletedListener"),a.resolve("PowerPointWebEditor.IFontUtilsManager")))}}Object(n.a)(Gz,"CoreExtPackage",null,[2,3]);class CK{constructor(){this.d3c=this.kf=this.Yc=this.qb=null;this.va=new bd.a;this.Db=!1}init(a,b){this.kf=a;this.Yc=b;this.IA()}dispose(){this.qb&&(this.visible=!1,this.Yc.yb(ra.a.click,
this.qb,Object(F.a)(this,this.OIa,"onBackgroundClick")),this.kf&&this.qb&&(this.kf.removeChild(this.qb),this.qb=null),this.va&&(this.va.dispose(),this.va=null))}IA(){this.qb=document.createElement("div");this.qb.className="EditingNotesDefaultView";u.AFrameworkApplication.isRtl&&(this.qb.style.direction=Td.a.s0a);this.kf.appendChild(this.qb);this.d3c=document.createElement("p");this.d3c.className="EditingNotesDefaultViewContent";this.d3c.innerText=ResourceStrings.l_ClickToAddNotes;this.qb.appendChild(this.d3c);
this.Yc.pb(ra.a.click,this.qb,Object(F.a)(this,this.OIa,"onBackgroundClick"))}OIa(a){this.va.raiseEvent("OnBackgroundClick",a);return!0}hsf(a){this.va.addHandler("OnBackgroundClick",a)}onResize(){}get visible(){return this.Db}set visible(a){this.Db=a;this.qb.style.display=a?Mi.a.block:Mi.a.none}get xa(){return this.qb}}Object(n.a)(CK,"NotesPromptView",null,[1177,1178,106]);class DK{constructor(a){this.X8c=this.kf=this.qb=null;this.c5c=this.Db=!1;this.C8j=a}init(a,b){b.$yb&&(this.kf=a,this.qb=document.createElement("div"),
this.qb.className="EditingNotesReadOnlyView",this.C8j&&(this.qb.style.direction=Td.a.s0a),this.kf.appendChild(this.qb),this.X8c=document.createElement("div"),this.X8c.className="EditingNotesReadOnlyViewContent",a={},a.inputString=b.Kcd,b=jSanity.sanitize(a),this.X8c.appendChild(b),this.qb.appendChild(this.X8c),this.c5c=!0)}dispose(){this.c5c&&(this.visible=!1,this.kf&&this.qb&&(this.kf.removeChild(this.qb),this.qb=null),this.c5c=!1)}get visible(){return this.Db}set visible(a){this.c5c&&(this.Db=a,
this.qb.style.display=a?Mi.a.block:Mi.a.none)}get xa(){return this.qb}}Object(n.a)(DK,"NotesReadOnlyView",null,[1175,106]);var Hz=d(486),vD=d(637);class dr extends Hz.a{constructor(a,b,c,h,m,y,G,U,ja,va,Ta,fb,Db,gc,hc,Gc,Pc,yc,Vd,De){super(a,b);this.iDb=this.jg=this.uh=this.Hdb=null;this.xWa=!1;this.vva=Fc.App.Um;this.oHa=Object(ua.a)(362,b);this.qb=this.Md.container;this.nc(this.qb);this.Yc=c;this.Fa=h;this.teb=m;this.SDb=va;this.Xl=y;this.vi=G;this.Hv=U;this.nJ=ja;this.ob=Ta;this.zbb=fb;this.J9=
Object(ua.a)(294,a);this.adc=Db;this.mc=gc;this.mye=hc;this.Ova=Gc;this.uJ=Pc;this.je=yc;this.y8c=Vd;this.Sp=De;this.u4c=this.je.pk("formatpaintertext.cur");this.Sp&&this.uJ.uOd(Object(F.a)(this,this.Ujc,"onTextFPActiveChanged"));this.uh||this.IA()}dispose(){this.Yc.yb(ra.a.click,this.qb.parentNode,Object(F.a)(this,this.OIa,"onBackgroundClick"));this.Sp&&this.uJ.vPe(Object(F.a)(this,this.Ujc,"onTextFPActiveChanged"));this.teb&&(this.teb.dispose(),this.teb=null);this.SDb&&(this.SDb.dispose(),this.SDb=
null);super.dispose()}Dy(a){super.Dy(a);this.ztc()}Iaa(a){this.PD(this.jg,a,-1)}v6(){this.Apd()}IA(){this.y8c&&(this.iDb=this.Md.createElement("div"),this.iDb.className="NotesResizeHandle",vf.c(this.iDb,!0),Sys.UI.DomElement.addCssClass(this.iDb,"NotesResizeHandle"),this.htmlElement.appendChild(this.iDb),this.Vo(this.iDb));this.Hdb=this.Md.createElement("div");this.Hdb.className="NotesContentContainer";this.Hdb.id="NotesContentContainer";this.Vo(this.Hdb);this.htmlElement.appendChild(this.Hdb);this.uh=
this.Md.createElement("div");Sys.UI.DomElement.addCssClass(this.uh,"NotesView");Sys.UI.DomElement.addCssClass(this.uh,"NotesEditViewVisible");this.Hdb.appendChild(this.uh);this.Vo(this.uh);this.jg=this.Md.createElement("div");Sys.UI.DomElement.addCssClass(this.jg,"NotesViewContent");this.uh.appendChild(this.jg);this.Vo(this.jg);u.AFrameworkApplication.isRtl&&(this.uh.style.direction=Td.a.s0a);this.Yc.pb(ra.a.click,this.qb.parentNode,Object(F.a)(this,this.OIa,"onBackgroundClick"));this.teb.init(this.qb.parentNode,
this.Yc);this.SDb.init(this.qb.parentNode,this.oHa);this.Apd();this.teb.hsf(Object(F.a)(this,this.znk,"onDefaultViewClick"))}Apd(){if(this.oHa.$yb)this.RKa(!1),this.VWe(!1),this.Ygl();else{var a=this.Xl.ije(this.oHa);a=this.xWa||!a;this.RKa(a);this.VWe(!a);this.Sp&&this.eD(dr.fea)}}Ujc(a,b){dr.fea=b.TPc;this.eD(dr.fea)}eD(a){const b=this.qb.querySelectorAll(".OutlineElement, .EditingSurfaceBody");if(2===a)for(this.qb.style.cursor=cf.a.cQ(this.u4c,Mi.a.vA),this.jg.style.cursor=cf.a.cQ(this.u4c,Mi.a.vA),
a=0;a<b.length;a++)if(b[a].style.cursor!==cf.a.cQ(this.u4c,Mi.a.vA))b[a].style.cursor=cf.a.cQ(this.u4c,Mi.a.yaa);else break;else for(this.qb.style.cursor=Mi.a.vA,this.jg.style.cursor=Mi.a.vA,a=0;a<b.length;a++)b[a].style.cursor=Mi.a.yaa}ztc(){this.htmlElement.style.zIndex="0";const a=this.Xl.ISa(this.oHa,this.Md.Ld),b=this.Xl.U4b(this.oHa,this.Md.Ld);var c=a.width-b[1]-b[3];0>c&&(b[1]+=c/2,b[3]+=c/2);c=a.height-b[0]-b[2];0>c&&(b[1]+=c/2,b[3]+=c/2);dr.YTe(this.uh,b);dr.YTe(this.teb.xa,b);dr.YTe(this.SDb.xa,
b);this.Ova.tjb(new ad.a(a.x,a.y),u.AFrameworkApplication.isRtl,this.uh,!0)}Fgb(){this.xWa=!0;this.vU();this.startEditing()}Ggb(){this.xWa=!1;this.vU();this.endEditing()}kL(){return this.xWa}startEditing(){this.Lwa.$yb?this.ob.ij():(this.Apd(),this.cig()||(this.vva=this.Lwa.DFa,this.nJ.iqh(this.oHa,!1),this.nJ.dGk(this.oHa)))}endEditing(){if(!this.Lwa.$yb&&(this.zbb.setVisibility(!1),this.Apd(),!this.cig())){this.I_g.endEditing(!0,14);this.adc.f0d(this.J9);var a=this.mye.$ta(this.Lwa,this.vva),b=
!!this.Lwa&&this.Lwa.isConnected;a&&(b&&this.Lwa.$nd(),this.vi.N6a(this.Lwa),this.Hv.GTd());this.nJ.iqh(this.oHa,b&&this.Lwa.pYc)}}znk(a,b){this.OIa(b)}OIa(){this.Fa.Bj(Di.a.J2,!0);this.RKa(!0);this.VWe(!1);this.I_g.KR();this.iXe();this.vva=this.Lwa.DFa;return!0}cig(){return!this.mc.Fn}get xa(){return this.htmlElement}get Lwa(){return this.oHa}get I_g(){return this.Qc}iXe(){this.Kaa(!0)}Ygl(){this.SDb.visible=!0}VWe(a){this.teb.visible=a}RKa(a){vD.b(a,this.Hdb,"NotesContentContainerHidden","NotesContentContainerVisible")}Kaa(a){vD.b(a,
this.uh,"NotesEditViewHidden","NotesEditViewVisible")}static YTe(a,b){a&&(a.style.paddingTop=cf.a.Pc(b[0]),a.style.paddingRight=cf.a.Pc(b[1]),a.style.paddingBottom=cf.a.Pc(b[2]),a.style.paddingLeft=cf.a.Pc(b[3]))}static UOj(a){return a?Sys.UI.DomElement.containsCssClass(a,"NotesResizeHandle"):!1}}dr.fea=0;Object(n.a)(dr,"NotesViewElement",Hz.a,[1176,465]);var $r=d(380),qQ=d(606),rQ=d(829),EK=d(484),Iz=d(483);class FK extends Iz.a{constructor(a,b){super(a,b);this.dea=[];this.kcc=0}lJb(a,...b){Array.addRange(this.dea,
b);this.kcc=a}mnc(){if(this.dea)for(const a of this.dea)this.Mt.lnc(this.container,a,this.kcc);this.Mt.GJ(this.container,this.b3)}utc(){this.Mt.XE(this.container,this.b3);for(const a of this.dea)this.Mt.XE(this.container,a)}}Object(n.a)(FK,"NotesViewDomManager",Iz.a,[]);var Jz=d(547);class GK extends Jz.ViewSelectionChangedHandler{constructor(a,b){super(a);this.pa=b}ztb(){return[Object(F.a)(this,this.Ijc,"onSetup"),Object(F.a)(this,this.gjc,"onEnsurePageViewElementsCreated"),Object(F.a)(this,this.hjc,
"onEnsureSelectedContentViewElementsCreated"),Object(F.a)(this,this.vjc,"onMainLoop"),Object(F.a)(this,this.Hqk,"onNotesContentSelect"),Object(F.a)(this,this.cjc,"onCommit"),Object(F.a)(this,this.Tjc,"onTearDown")]}Hqk(a,b){this.Qfa(b);a=Object(ua.a)(362,this.zh.yg);if(!a)return!0;a=Object(ua.a)(1176,a.sc(this.zh.Ma));if(!a)return!0;this.pa.Hka()?a.kL()||a.Fgb():a.kL()&&a.Ggb();return!0}}Object(n.a)(GK,"NotesViewSelectionChangedHandler",Jz.ViewSelectionChangedHandler,[]);class wD extends Cv.DragSelectionDragAdapter{constructor(a,
b,c,h,m,y){super(a,b,c);this.fq=h;this.Cne=y;this.Xl=m}Nu(a){if(this.Cne){var b=this.itc(a);const c=b?b.gb:null;if(c){const h=this.Xl.iFa(c)?Object(ua.a)(362,c):this.Xl.Awb(c);if(h&&this.Xl.ije(h))return!1}if(a.ctrlKey&&b&&c&&(b=this.If.T0a(a.clientPoint,b,c,this.If,!1))&&Ib.HyperlinkReader.Fka(b,!0))return!1}a=super.Nu(a);null!==this.fq&&a&&this.fq.iya(Mi.a.yaa);return a}iu(a){super.iu(a);null!==this.fq&&this.fq.Lxa()}Zn(a){super.Zn(a);null!==this.fq&&this.fq.Lxa()}LI(a){return this.If.isActive?
super.LI(a):!1}static V4b(a){return new wD(a,vb.a.instance.resolve("Common.IActionManagerExtended"),vb.a.instance.resolve("Common.IActivityManager"),vb.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").pptCursorContainerManagerIsEnabled?vb.a.instance.resolve("PowerPointWebEditor.ShapeManipulation.ICursorContainerManager"):null,vb.a.instance.resolve("PowerPointWebEditor.Graph.INotesReader"),vb.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").pptNoteDragSelectionFix)}}Object(n.a)(wD,
"NotesDragSelectionDragAdapter",Cv.DragSelectionDragAdapter,[]);var Kz=d(232);class xD{constructor(a,b,c,h,m,y,G,U,ja,va,Ta){this.WFg=this.Zec=this.Vtg=this.vxe=this.bHa=0;this.m$=this.fcc=this.N7c=null;this.nbc=this.crg=this.u7c=0;this.rqe=!1;this.J9=a;this.X_=b;this.Pi=c;this.Qb=h;this.fA=m;this.Mg=y;this.qc=G;this.Kc=U;this.Jb=ja;va.mPa(Object(F.a)(this,this.Ajc,"onOutboundReplication"));this.ia=Ta}xv(a){return a&&a.lA!==Sys.UI.MouseButton.rightButton?dr.UOj(a.Cc):!1}Nu(a){if(!this.xv(a))return!1;
this.rqe=!0;this.N7c=this.fA.xa;if(!this.N7c)return!1;this.m$=this.Kc.Ic;if(this.m$&&(this.fcc=this.Mg.xa))this.Vtg=this.fcc.clientHeight;else return!1;this.u7c=Math.floor(.75*(this.N7c.clientHeight+this.fcc.clientHeight));this.vxe=this.N7c.clientHeight;this.Zec=this.bHa=a.clientPoint.y;this.WFg=this.m$.mT;this.X_.nl(7);this.J9.endEditing(!0,14);return!0}zw(a){if(!a)return!1;this.bHa=a.clientPoint.y;a=this.tAf(this.bHa);this.fA.bfa=a;this.Qb.Mq();a=this.Vtg+this.vxe-a;this.fcc.style.height=a+"px";
this.m$.U7k(a-1);this.m$.$9k(this.WFg);return!0}Zn(a){this.X_.a1();this.J9.KR();this.nbc=this.tAf(a?a.clientPoint.y:this.bHa);this.ia.La(M.a.TTe,2,this.nbc)}iu(){this.rqe&&(this.rqe=!1,this.Zn(null))}Ajc(){this.nbc!==this.crg&&2===Fc.App.Kb.mode&&(this.crg=this.nbc,this.Ovk(this.nbc))}Ovk(a){const b=this.qc.Pn,c=this.Jb.zd(4);try{c.nc(b),b.ZFb=4320,b.bfa=this.ani(a)}finally{c&&c.dispose()}}tAf(a){a=this.vxe+this.Pi.Pm(this.Zec-a);0<this.u7c&&a>this.u7c?a=this.u7c:a<Kz.a.kRa&&a>xf.a.jNc?a=Kz.a.kRa:
a<xf.a.jNc&&(a=xf.a.tOf);return a}ani(a){return this.Pi.YIe(a,1)}static V4b(a){return new xD(a,vb.a.instance.resolve("Common.CursorManager"),vb.a.instance.resolve("PowerPointWebEditor.IPPTUnitConversion"),vb.a.instance.resolve("Box4.IAppFrame"),vb.a.instance.resolve("PowerPointWebEditor.INotesPane"),vb.a.instance.resolve("PowerPointWebEditor.ISlidePane"),vb.a.instance.resolve("PowerPointWebEditor.IPresentationReader"),vb.a.instance.resolve("PowerPointWebEditor.IActiveSlideViewManager"),vb.a.instance.resolve("Common.Transaction.ITransactionFactory"),
vb.a.instance.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),vb.a.instance.resolve("Common.IActionManagerExtended"))}}Object(n.a)(xD,"NotesResizeDragAdapter",null,[244]);class HK extends $r.a{constructor(a,b,c,h,m,y,G,U,ja,va,Ta,fb,Db,gc){super(Di.a.J2,a,b,c,h,m,G,U,fb);this.pve=!1;this.rIa=y;this.mc=ja;this.$f=va;this.lO=Ta;this.Cne=Db;this.Sp=gc}get mPd(){return u.AFrameworkApplication.fa}Tx(a,b=null){this.Sp&&this.$f.pb(ra.a.xJ,this.container,Object(F.a)(this,this.acd,"mouseUpHandlerFilter"));
super.Tx(a,b);(a=Object(ua.a)(362,a))&&a.$yb&&this.Ag&&this.Ag.Qn&&this.Ag.Qn.setAttribute("aria-readonly","true")}detach(){this.Sp&&this.so&&this.$f.yb(ra.a.xJ,this.container,Object(F.a)(this,this.acd,"mouseUpHandlerFilter"));super.detach()}cZb(a,b){return new FK(a,b)}nda(a){a=super.nda(a);a.b3=wD.V4b(this);a.lJb(1,xD.V4b(this));return a}Uwa(a){this.Dzc=a.Yf;if(!this.anc||this.isActive||!this.Cne||(a.pc.type===ra.a.mouseDown||a.pc.type===ra.a.RPa)&&a.lA!==Sys.UI.MouseButton.leftButton)return!1;var b=
a.Cc;if(b&&Sys.UI.DomElement.containsCssClass(b,"NotesResizeHandle"))return!1;let c=!1;$r.a.P7&&(c=$r.a.P7.osa());Fc.App.HD.KS&&Fc.App.HD.KS.$Qe(h=>{h&&(c=!0)});b=!Rd.a("DeprecateIE.NotesView")&&c&&v.a.XW;a=new qQ.a(a,this,!0,b);this.EFk(a);return!1}EFk(a){this.aKe();this.P5(v.a.fg||v.a.mUa);this.Ip.raiseEvent($r.a.$Wc,new rQ.a(a.graphNode));this.GPc(a.graphNode);this.Q3e();const b=[Object(F.a)(this,this.SDe,"noneClickHandler"),Object(F.a)(this,this.gkk,"notesSnapToContentClickHandler"),Object(F.a)(this,
this.bkk,"notesDefaultClickHandler")];for(const c of b)if(c(a).B3){this.pve=!0;break}}acd(){return this.pve&&this.lO.PUa?(this.Ca.processAction(D.a.Bja,2),!0):this.pve=!1}bkk(a){const b=$r.a.Wc.Vp(D.a.Rsb);b.properties.$(de.a.source,"DefaultClickHandler");this.r6(a.eV,a.Vr,a.graphNode,a.Qc,a.Yi.shiftKey,a.Yi.ctrlKey,a.Yi.Yf);b.end();a.lvb&&this.P5(!0);this.editingView.kbb(a.Yi.shiftKey,a.eV,a.Yi.Yf);return mi.a.Tl(!0)}gkk(a){if(!a.Vr){const b=a.Vr,c=a.graphNode,h=$r.a.Wc.Vp(D.a.Rsb);h.properties.$(de.a.source,
"SnapToContentClickHandler");this.r6(a.eV,b,c,this,a.Yi.shiftKey,a.Yi.ctrlKey,a.Yi.Yf);h.end();a.lvb&&this.P5(!0);this.editingView.kbb(a.Yi.shiftKey,a.eV,a.Yi.Yf);return mi.a.Tl(!0)}return mi.a.notHandled}ena(){super.ena();this.Ag&&this.Ag.Qn&&(this.mPd.ka("AccessibilityNotificationEnabledViaAriaLiveRegion")?this.Ag.hpc(zc.a.VGc):this.Ag.USe(Box4Intl.Box4Strings.l_EditingSurfaceScreenReaderTitleMessage,"",zc.a.VGc),this.Ag.Qn.setAttribute(zc.a.gs,ResourceStrings.l_NotesPane))}Iqd(){this.gF.Rd===this&&
this.suspend()}Zkd(){this.gF.Rd===this&&this.resume()}kTc(){return new GK(this,vb.a.instance.resolve("PowerPointWebEditor.IPptSelectionManager"))}NQc(){return[Object(F.a)(this,this.SDe,"noneClickHandler"),Object(F.a)(this,this.snapToContentClickHandler,"snapToContentClickHandler"),Object(F.a)(this,this.tripleClickHandler,"tripleClickHandler"),Object(F.a)(this,this.defaultClickHandler,"defaultClickHandler")]}uRc(){return[Object(F.a)(this,this.SDe,"noneClickHandler"),Object(F.a)(this,this.defaultDoubleClickHandler,
"defaultDoubleClickHandler")]}SDe(a){return this.azb(a)||this.VOj()?mi.a.Tl(!0):mi.a.notHandled}hRc(){return[Object(F.a)(this,this.noContextMenuHandler,"noContextMenuHandler"),Object(F.a)(this,this.noViewElementContextMenuHandler,"noViewElementContextMenuHandler"),Object(F.a)(this,this.domElementSelectedContextMenuHandler,"domElementSelectedContextMenuHandler")]}yya(a){this.azb(a)||super.yya(a)}noContextMenuHandler(a){return this.azb(a)?lo.a.Tl(null):lo.a.notHandled}azb(a){return!!a&&!!a.graphNode&&
60===a.graphNode.type&&a.graphNode.$yb}VOj(){return!this.mc.Fn}G9a(){return EK.a.CCe}get GF(){return super.GF|96}get PLb(){return!0}y6(a,b,c=null){this.rIa.dY(this)&&super.y6(a,b,c)}}Object(n.a)(HK,"NotesView",$r.a,[528,1173,565,167,106,294,797,937,938,939]);var IK=d(485),Lz=d(207);class yD{constructor(a,b,c,h){this.nFg=null;this.Dva=a;this.ua=b;this.Lq=c;this.Jte=h}qDj(){this.nFg=new IK.a(Lz.App.y5a.ekk,"EditingNotesPanel","EditingNotesPanel InteractiveView");this.Dva.RBa(this.nFg.xza);Ev.BFf(this.Dva);
this.vwf(this.ua.Ba);this.Lq.Q7h(Object(F.a)(this,this.p1g,"onAttachNotesView"))}p1g(a,b){this.kRi();this.vwf(b.Fd)}vwf(a){this.ua.presentation&&a&&a.isConnected&&(a=this.Jte.z_f(a,27),this.Dva.Tx(a))}kRi(){this.Dva.so&&(this.Dva.editingView.disable(!0,14),this.Dva.detach())}dispose(){this.Lq.WSk(Object(F.a)(this,this.p1g,"onAttachNotesView"))}}Object(n.a)(yD,"NotesViewHelper",null,[106]);class zD{constructor(){this.K=null}get name(){return"PowerPointWebEditor.Notes"}$b(a){this.K=a;this.K.register(528,
"PowerPointWebEditor.INotesView").ma().oa(()=>new HK(this.K.resolve("Box4.IWorkspace"),this.K.resolve("Box4.IInteractiveViewManager"),()=>this.K.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoManager"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Box4.IHtmlViewRootFactory"),this.K.resolve("PowerPointWebEditor.View.IViewValidateStrategy"),this.K.resolve("Box4.IInteractiveEventNotifier"),this.K.Ja("Box4.ITextMetricsAdapter"),this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),
this.K.resolve("Common.MouseInputManager"),this.K.resolve("PowerPointWebEditor.ViewCore.IFormatPainterContext"),this.K.resolve("Box4.IRotatingCoordinateConverter"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptNoteDragSelectionFix,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptTextFormatPainterIsEnabled));this.K.register(yD,"PowerPointWebEditor.Notes.NotesViewHelper").ma().oa(()=>new yD(this.K.resolve("PowerPointWebEditor.INotesView"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
this.K.resolve("PowerPointWebEditor.View.IViewEventHandlers"),this.K.resolve("PowerPointWebEditor.Graph.IGraphNodeHelper")))}init(){this.K.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementFactoryHelper").extend(393326,new Ke.a((a,b)=>Object(za.a)(528,a)?new dr(a,b,this.K.resolve("Common.IClickInputManager"),this.K.resolve("PowerPointWebEditor.IFocusManager"),new CK,this.K.resolve("PowerPointWebEditor.Graph.INotesReader"),this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.K.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoManager"),
this.K.resolve("PowerPointWebEditor.Proofing.IProofingBehaviorController"),new DK(u.AFrameworkApplication.isRtl),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("Box4.IGrippersManager"),this.K.resolve("PowerPointWebEditor.IGraphUpdateStrategy"),this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),this.K.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoActionBehavior"),this.K.resolve("PowerPointWebEditor.ViewCore.IPPTPositionEditor"),this.K.resolve("PowerPointWebEditor.ViewCore.IViewCoreEventHandlers"),
this.K.resolve("PowerPoint.IPathManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").cah,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptTextFormatPainterIsEnabled):null));this.K.resolve("Box4.IEditingView");this.K.resolve("PowerPointWebEditor.Notes.NotesViewHelper").qDj()}dispose(){this.K.resolve("PowerPointWebEditor.Notes.NotesViewHelper").dispose()}static main(){r.a.instance.Dc(new zD)}}Object(n.a)(zD,"PPTWebEditorNotesPackage",null,[2,3]);class AD extends Cv.DragSelectionDragAdapter{constructor(a,
b,c,h){super(a,b,c);this.fq=h}Nu(a){a=super.Nu(a);null!==this.fq&&a&&this.fq.iya(Mi.a.yaa);return a}iu(a){super.iu(a);null!==this.fq&&this.fq.Lxa()}Zn(a){super.Zn(a);null!==this.fq&&this.fq.Lxa()}LI(a){return this.If.isActive?super.LI(a):!1}static V4b(a){return new AD(a,vb.a.instance.resolve("Common.IActionManagerExtended"),vb.a.instance.resolve("Common.IActivityManager"),vb.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").pptCursorContainerManagerIsEnabled?vb.a.instance.resolve("PowerPointWebEditor.ShapeManipulation.ICursorContainerManager"):
null)}}Object(n.a)(AD,"SmartArtTextViewDragSelectionDragAdapter",Cv.DragSelectionDragAdapter,[]);class JK extends Iz.a{constructor(a,b){super(a,b);this.dea=[];this.kcc=0}lJb(a,...b){Array.addRange(this.dea,b);this.kcc=a}mnc(){if(this.dea)for(const a of this.dea)this.Mt.lnc(this.container,a,this.kcc);this.Mt.GJ(this.container,this.b3)}utc(){this.Mt.XE(this.container,this.b3);for(const a of this.dea)this.Mt.XE(this.container,a)}}Object(n.a)(JK,"SmartArtTextViewDomManager",Iz.a,[]);class KK extends Jz.ViewSelectionChangedHandler{constructor(a,
b,c,h){super(a);this.pa=b;this.Re=c;this.FO=h}ztb(){return[Object(F.a)(this,this.Ijc,"onSetup"),Object(F.a)(this,this.gjc,"onEnsurePageViewElementsCreated"),Object(F.a)(this,this.hjc,"onEnsureSelectedContentViewElementsCreated"),Object(F.a)(this,this.vjc,"onMainLoop"),Object(F.a)(this,this.xtk,"onSmartArtContentSelect"),Object(F.a)(this,this.cjc,"onCommit"),Object(F.a)(this,this.Tjc,"onTearDown")]}xtk(a,b){this.Qfa(b);b=Object(ua.a)(4,this.zh.yg);if(!b)return!1;a=Object(ua.a)(1179,b.sc(this.zh.Ma));
b=Object(ua.a)(117,b.sc(this.Re));if(!a)return!1;this.pa.JUa()?a.kL()||(a.Fgb(),this.FO.yp(!0),b&&b.Fgb()):a.kL()&&(a.Ggb(),this.FO.yp(!1),b&&b.Ggb());return!0}}Object(n.a)(KK,"SmartArtTextViewSelectionChangedHandler",Jz.ViewSelectionChangedHandler,[]);class LK extends $r.a{constructor(a,b,c,h,m,y,G,U,ja,va,Ta,fb,Db,gc){super(Ua.a.HR,a,c,h,m,G,ja,va,Ta);this.rIa=U;this.pa=b;this.Gq=y;this.Re=fb;this.FO=Db;this.Fa=gc;this.Ld.A3e=!0;this.Ld.k3d=!1}get mPd(){return u.AFrameworkApplication.fa}cZb(a,b){return new JK(a,
b)}nda(a){a=super.nda(a);a.b3=AD.V4b(this);return a}ena(){super.ena();this.Ag&&this.Ag.Qn&&(this.mPd.ka("AccessibilityNotificationEnabledViaAriaLiveRegion")?this.Ag.hpc(zc.a.VGc):this.Ag.USe(Box4Intl.Box4Strings.l_EditingSurfaceScreenReaderTitleMessage,Box4Intl.Box4Strings.l_EditingSurfaceF2ScreenReaderDescribedByMessage,zc.a.VGc),this.Ag.Qn.setAttribute(zc.a.gs,ResourceStrings.l_SmartArtTextPane))}Iqd(){this.gF.Rd===this&&this.suspend()}Zkd(){this.gF.Rd===this&&this.resume()}kTc(){return new KK(this,
vb.a.instance.resolve("PowerPointWebEditor.IPptSelectionManager"),this.Re,this.FO)}Jsb(){this.gF.Rd===this&&this.pa.uTd();return!1}NQc(){return[Object(F.a)(this,this.snapToContentClickHandler,"snapToContentClickHandler"),Object(F.a)(this,this.floatieClickHandler,"floatieClickHandler"),Object(F.a)(this,this.tripleClickHandler,"tripleClickHandler"),Object(F.a)(this,this.defaultClickHandler,"defaultClickHandler")]}uRc(){return[Object(F.a)(this,this.defaultDoubleClickHandler,"defaultDoubleClickHandler")]}hRc(){return[Object(F.a)(this,
this.noViewElementContextMenuHandler,"noViewElementContextMenuHandler"),Object(F.a)(this,this.domElementSelectedContextMenuHandler,"domElementSelectedContextMenuHandler")]}onClick(a){a=super.onClick(a);this.Fa.Bj(Ua.a.HR,!0);return a}G9a(){return EK.a.CCe}get GF(){let a=super.GF;return a=Rd.a("SmartArt.ListensToRenderOverlayInvalidations")?a|64:a|96}get PLb(){return!0}y6(a,b,c=null){this.rIa.dY(this)&&super.y6(a,b,c)}h9k(a){const b=this.Gq.le(2);try{b.kd(a);let c=null;c=yd.SelectionFactory.sj(a,!0);
this.setSelection(c)}finally{b&&b.dispose()}}}Object(n.a)(LK,"SmartArtTextView",$r.a,[526,1173,565,167,106,294,797,937,938,939]);class MK extends Hz.a{constructor(a,b,c,h,m,y,G,U,ja,va,Ta){super(a,b);this.jg=this.uh=null;this.xWa=!1;this.vva=Fc.App.Um;this.E$c=b;this.qb=this.Md.container;this.nc(this.qb);this.Yc=c;this.Fa=h;this.ia=m;this.vi=y;this.Hv=G;this.nJ=U;this.zbb=ja;this.J9=a;this.adc=va;this.qd=Ta;this.IA()}dispose(){this.Yc.yb(ra.a.click,this.qb.parentNode,Object(F.a)(this,this.OIa,"onBackgroundClick"));
this.qd.aVk(Object(F.a)(this,this.h6g,"onSmartArtTextPaneWidthChanged"));super.dispose()}Dy(a){super.Dy(a)}Iaa(a){this.PD(this.jg,a,-1)}v6(){this.RKa(!0)}IA(){this.uh=this.Md.createElement("div");Sys.UI.DomElement.addCssClass(this.uh,"SmartArtTextView");Sys.UI.DomElement.addCssClass(this.uh,"SmartArtTextViewVisible");this.htmlElement.appendChild(this.uh);this.Vo(this.uh);this.jg=this.Md.createElement("div");Sys.UI.DomElement.addCssClass(this.jg,"SmartArtTextViewContent");this.jg.style.width=cf.a.Pc(xf.a.Uqc-
2*xf.a.rMb-2*xf.a.HXe-xf.a.zwh);this.uh.appendChild(this.jg);this.Vo(this.jg);u.AFrameworkApplication.isRtl&&(this.uh.style.direction=Td.a.s0a);this.RKa(!0);this.Yc.pb(ra.a.click,this.qb.parentNode,Object(F.a)(this,this.OIa,"onBackgroundClick"));this.qd.fai(Object(F.a)(this,this.h6g,"onSmartArtTextPaneWidthChanged"))}Fgb(){this.xWa=!0;this.vU();this.startEditing()}Ggb(){this.xWa=!1;this.vU();this.endEditing()}kL(){return this.xWa}startEditing(){this.RKa(!0);this.vva=this.i0a.DFa;this.nJ.rpc(this.E$c,
!1);this.nJ.zhd(this.E$c)}endEditing(){this.zbb.setVisibility(!1);this.RKa(!0);this.Bwh.endEditing(!0,14);this.adc.f0d(this.J9);const a=new cy.a(this.i0a,this.vva);this.ia.La(M.a.zhb,2,a);const b=!!this.i0a&&this.i0a.isConnected;a.$ta&&(b&&this.i0a.$nd(),this.vi.N6a(this.i0a),this.Hv.GTd());this.nJ.rpc(this.E$c,b&&this.i0a.pYc)}OIa(){this.Fa.Bj(Ua.a.HR,!0);this.Bwh.KR();this.RKa(!0);this.vva=this.i0a.DFa;return!0}get xa(){return this.htmlElement}get i0a(){return this.E$c}get Bwh(){return this.Qc}RKa(a){vD.b(a,
this.uh,"SmartArtTextViewHidden","SmartArtTextViewVisible")}h6g(a,b){this.jg.style.width=cf.a.Pc(cf.a.En(b.width))}}Object(n.a)(MK,"SmartArtTextViewElement",Hz.a,[1179,465]);class NK{constructor(a,b,c,h,m,y,G,U,ja,va,Ta,fb){this.zTg=this.Kbb=null;this.FO=a;this.$Ha=b;this.qd=c;this.Fa=h;this.Hv=m;this.cM=y;this.pa=G;this.Fb=Object(ua.a)(294,U);this.Lq=ja;this.mh=va;this.mc=Ta;this.j0=fb}UDj(){this.zTg=new IK.a(this.FO.vOf,"SmartArtTextViewContainer","SmartArtTextViewContainer InteractiveView EditMode");
this.$Ha.RBa(this.zTg.xza);Ev.BFf(this.$Ha);this.qd.X$h(Object(F.a)(this,this.P5g,"onSingleSmartArtShapeViewElementSelected"));this.qd.Y$h(Object(F.a)(this,this.Q5g,"onSingleSmartArtShapeViewElementSelectedAndEnterTextEdit"));this.qd.eai(Object(F.a)(this,this.g6g,"onSmartArtShapeViewElementDeselected"));this.qd.VXb(Object(F.a)(this,this.cfd,"onSlideHtmlUpdated"));this.qd.Y7h(Object(F.a)(this,this.f6g,"onSmartArtCommentsVisibilityChanged"));this.cM.y7(Object(F.a)(this,this.Jjc,"onShapeDisconneted"));
this.Lq.NFc(Object(F.a)(this,this.AU,"onFocusChanged"));this.Lq.GFc(Object(F.a)(this,this.AU,"onFocusChanged"));this.Fb.pPa((a,b)=>{this.cfd(a,b)})}sua(){return!this.mc.Fn}dXe(a){if(this.j0){if(this.sua()||a.Zma)return}else if(this.sua())return;a&&a.Rf&&!a.get_smartArtModelId()&&a.isConnected?(Ba.a.J(38618783,822,50,"SmartArtTextViewHelper::ShowSmartArtTextPane - shapeNode is SmartArt"),a.EXe||(this.Kbb!==a&&(this.Kbb=a,this.n0d(),this.wwf(a)),this.FO.a3e(a),this.FO.yp(!0))):Ba.a.J(38618785,822,50,
"SmartArtTextViewHelper::ShowSmartArtTextPane - shapeNode is not SmartArt or not connected")}lhl(a){this.sua()||(a&&a.Rf&&!a.get_smartArtModelId()&&a.isConnected?(Ba.a.J(38618787,822,50,"SmartArtTextViewHelper::ShowSmartArtTextPaneForEdit - shapeNode is SmartArt"),a.EXe||(this.Kbb!==a&&(this.Kbb=a,this.n0d(),this.wwf(a)),this.Fa.Bj(Ua.a.HR,!0),this.Hv.kw(),this.$Ha.h9k(a),this.FO.a3e(a),this.FO.yp(!0))):Ba.a.J(38618817,822,50,"SmartArtTextViewHelper::ShowSmartArtTextPaneForEdit - shapeNode is not SmartArt or not connected"))}XMf(){this.FO.isVisible&&
(Ba.a.J(38618819,822,50,"SmartArtTextViewHelper::DismissSmartArtTextPane"),this.FO.yp(!1))}P5g(a,b){this.sua()||this.dXe(b.shapeNode)}Q5g(a,b){this.sua()||this.lhl(b.shapeNode)}g6g(){this.sua()||this.XMf()}cfd(){if(!this.sua()&&this.pa.xL()){const a=this.pa.bEa();Ba.a.J(38618821,822,50,"SmartArtTextViewHelper::OnSlideHtmlUpdated");a&&this.FO.a3e(a)}}AU(a,b){this.sua()||(a=b.Zfb,a===Ua.a.HR?this.mh.EK(Ua.a.HR):this.mh.V8b(a)&&this.mh.Ho(Ua.a.HR))}wwf(a){a&&a.isConnected&&this.$Ha.Tx(a)}n0d(){this.$Ha.so&&
(this.$Ha.editingView.disable(!0,14),this.$Ha.detach())}Jjc(a,b){this.sua()||b.node!==this.Kbb||(this.Kbb=null,this.n0d(),this.FO.yp(!1))}f6g(a,b){this.sua()||((a=b.Kal)?a.Rf&&this.dXe(a):(a=this.pa.bEa())?this.Kbb!==a&&this.dXe(a):this.XMf())}dispose(){this.qd.TUk(Object(F.a)(this,this.P5g,"onSingleSmartArtShapeViewElementSelected"));this.qd.UUk(Object(F.a)(this,this.Q5g,"onSingleSmartArtShapeViewElementSelectedAndEnterTextEdit"));this.qd.$Uk(Object(F.a)(this,this.g6g,"onSmartArtShapeViewElementDeselected"));
this.qd.aTk(Object(F.a)(this,this.f6g,"onSmartArtCommentsVisibilityChanged"));this.cM.$Ja(Object(F.a)(this,this.Jjc,"onShapeDisconneted"));this.Lq.lPe(Object(F.a)(this,this.AU,"onFocusChanged"));this.Lq.fkd(Object(F.a)(this,this.AU,"onFocusChanged"));this.qd.vih(Object(F.a)(this,this.cfd,"onSlideHtmlUpdated"));this.Fb.Hnc((a,b)=>{this.cfd(a,b)})}}Object(n.a)(NK,"SmartArtTextViewHelper",null,[527,106]);class BD{constructor(){this.K=null;this.dA=!1}get name(){return"PowerPointWebEditor.SmartArt"}$b(a){this.K=
a;this.K.register(526,"PowerPointWebEditor.ISmartArtTextView").ma().oa(()=>new LK(this.K.resolve("Box4.IWorkspace"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("Box4.IInteractiveViewManager"),()=>this.K.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoManager"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Box4.Graph.IGraphTransactionFactory"),this.K.resolve("Box4.IHtmlViewRootFactory"),this.K.resolve("PowerPointWebEditor.View.IViewValidateStrategy"),this.K.resolve("Box4.IInteractiveEventNotifier"),
this.K.Ja("Box4.ITextMetricsAdapter"),this.K.resolve("Box4.IRotatingCoordinateConverter"),this.K.resolve("Box4.IPageView").Ma,this.K.resolve("PowerPointWebEditor.View.ISmartArtTextPane"),this.K.resolve("PowerPointWebEditor.IFocusManager")));this.K.register(527,"PowerPointWebEditor.ISmartArtTextViewHelper").ma().oa(()=>new NK(this.K.resolve("PowerPointWebEditor.View.ISmartArtTextPane"),this.K.resolve("PowerPointWebEditor.ISmartArtTextView"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),
this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoManager"),this.K.resolve("Box4.Graph.IGraphInstance").Ad(10),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("Box4.IPageView"),this.K.resolve("PowerPointWebEditor.View.IViewEventHandlers"),this.K.resolve("Common.IF6Manager"),this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").cka))}init(){const a=this.K.resolve("Common.IAppSettingsManager");
a.jf(()=>{if(this.dA=a.ka("341"))this.K.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementFactoryHelper").extend(1074135132,new Ke.a((b,c)=>Object(za.a)(526,b)?(c=Object(ua.a)(4,c))&&c.Rf?new MK(b,c,this.K.resolve("Common.IClickInputManager"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.K.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoManager"),this.K.resolve("PowerPointWebEditor.Proofing.IProofingBehaviorController"),
this.K.resolve("Box4.IGrippersManager"),this.K.resolve("PowerPointWebEditor.IGraphUpdateStrategy"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers")):null:null)),this.K.resolve("Box4.IEditingView"),this.K.resolve("PowerPointWebEditor.ISmartArtTextViewHelper").UDj()})}dispose(){this.dA&&(this.K.resolve("PowerPointWebEditor.ISmartArtTextViewHelper").dispose(),this.K.resolve("PowerPointWebEditor.ISmartArtTextView").dispose())}static main(){r.a.instance.Dc(new BD)}}Object(n.a)(BD,
"PPTWebEditorSmartArtPackage",null,[2,3]);class OK{constructor(){this.lvl9pPrField=this.lvl8pPrField=this.lvl7pPrField=this.lvl6pPrField=this.lvl5pPrField=this.lvl4pPrField=this.lvl3pPrField=this.lvl2pPrField=this.lvl1pPrField=this.defPPrField=null}}Object(n.a)(OK,"CT_WebTextListStyle",null,[]);var To=d(339);class PK{constructor(a){this.jla=a}LZ(a,b){const c=a.tableStyle;if(c){var h=a.tableLook,m=!!(h&32)&&!!c.firstRowField,y=!!(h&64)&&!!c.lastRowField,G=!!(h&128)&&!!c.firstColField,U=!!(h&256)&&
!!c.lastColField,ja=m&&G&&!!c.nwCellField,va=m&&U&&!!c.neCellField,Ta=y&&G&&!!c.swCellField,fb=y&&U&&!!c.seCellField,Db=!!(h&512)&&!!c.band1HField,gc=!!(h&512)&&!!c.band2HField,hc=!!(h&1024)&&!!c.band1VField;h=!!(h&1024)&&!!c.band2VField;var Gc=!b.ke,Pc=b.ag===a.BY,yc=!b.fe;a=b.Nf===a.Nra;var Vd=1===b.ke%2===m;b=1===b.fe%2===G;var De=!(m&&Gc)&&!(y&&Pc),Wd=!(G&&yc)&&!(U&&a);c.wholeTblField&&this.apply(c.wholeTblField);De&&(Db&&Vd||gc&&!Vd)&&(Vd?this.apply(c.band1HField):this.apply(c.band2HField));
Wd&&(hc&&b||h&&!b)&&(b?this.apply(c.band1VField):this.apply(c.band2VField));a&&U&&this.apply(c.lastColField);yc&&G&&this.apply(c.firstColField);Pc&&y&&(this.apply(c.lastRowField),a&&fb&&this.apply(c.seCellField),yc&&Ta&&this.apply(c.swCellField));Gc&&m&&(this.apply(c.firstRowField),a&&va&&this.apply(c.neCellField),yc&&ja&&this.apply(c.nwCellField))}}apply(a){if(a.tcTxStyleField){var b=a.tcTxStyleField;a=lh.a(b);Uf.Box4ColorHelper.V$a(a)||(To.g(this.jla),this.jla.solidFillField=new Mu.a,Uf.Box4ColorHelper.xdi(this.jla.solidFillField,
a));a=b.bField;var c=b.iField;if(b.fontRefField){b=b.fontRefField.idxField;var h=this.jla;0===b||1===b?(h.latinField=Se.Btb(b,0),h.eaField=Se.Btb(b,1),h.csField=Se.Btb(b,2)):Ba.a.J(8959121,820,10,"StyleResolverHelper::ResolveToThemeFont - Invalid font collection index encountered")}else b.fontField&&(b=b.fontField,null!==b.latinField&&(this.jla.latinField=b.latinField),null!==b.eaField&&(this.jla.eaField=b.eaField),null!==b.csField&&(this.jla.csField=b.csField));if(0===a||1===a)this.jla.bFieldSpecified=
!0,this.jla.bField=0===a;if(0===c||1===c)this.jla.iFieldSpecified=!0,this.jla.iField=0===c}}}Object(n.a)(PK,"CellTextStylePartApplier",null,[]);class Us{constructor(a){this.dVg=a}get value(){return this.dVg.valField/1E5}set value(a){this.dVg.valField=Math.floor(1E5*a)}get type(){return Us.xZb}}Us.xZb="CT_TextSpacingPercent:#Microsoft.Office.Server.Powerpoint.Interface.Edit";Object(n.a)(Us,"LineSpacingPercent",null,[444,445]);class er{constructor(a){this.eVg=a}get value(){return this.eVg.valField/
100}set value(a){this.eVg.valField=Math.floor(100*a)}get type(){return er.xZb}}er.xZb="CT_TextSpacingPoint:#Microsoft.Office.Server.Powerpoint.Interface.Edit";Object(n.a)(er,"LineSpacingPoint",null,[444,445]);class sQ{constructor(){this.valField=0}}Object(n.a)(sQ,"CT_TextSpacingPoint",null,[]);class Vs{constructor(a){this.Yoe=a}get lineSpacing(){return this.Yoe}get value(){return this.Yoe.value}set value(a){this.Yoe.value=a}static C0b(a){if(a.__type===Us.xZb)return new Vs(new Us(a));if(a.__type===
er.xZb)return new Vs(new er(a));Ba.a.J(8958300,820,10,"Unsupported line spacing format {0}",a.__type);return null}}Object(n.a)(Vs,"LineSpacingWrapper",null,[]);const QK=(a,b)=>{switch(b){case 0:return a.defPPrField;case 1:return a.lvl1pPrField;case 2:return a.lvl2pPrField;case 3:return a.lvl3pPrField;case 4:return a.lvl4pPrField;case 5:return a.lvl5pPrField;case 6:return a.lvl6pPrField;case 7:return a.lvl7pPrField;case 8:return a.lvl8pPrField;case 9:return a.lvl9pPrField;default:return null}},RK=
(a,b)=>{b.baselineFieldSpecified&&(a.baselineFieldSpecified=!0,a.baselineField=b.baselineField);b.bFieldSpecified&&(a.bFieldSpecified=!0,a.bField=b.bField);b.capFieldSpecified&&(a.capFieldSpecified=!0,a.capField=b.capField);b.iFieldSpecified&&(a.iFieldSpecified=!0,a.iField=b.iField);b.noProofFieldSpecified&&(a.noProofFieldSpecified=!0,a.noProofField=b.noProofField);b.rtlFieldSpecified&&(a.rtlFieldSpecified=!0,a.rtlField=b.rtlField);b.strikeFieldSpecified&&(a.strikeFieldSpecified=!0,a.strikeField=
b.strikeField);b.szFieldSpecified&&(a.szFieldSpecified=!0,a.szField=b.szField);b.uFieldSpecified&&(a.uFieldSpecified=!0,a.uField=b.uField);b.altLangField&&(a.altLangField=b.altLangField);b.blipFillField&&(a.blipFillField=b.blipFillField);b.csField&&(a.csField=b.csField);a.dirtyField=b.dirtyField;b.eaField&&(a.eaField=b.eaField);a.errField=b.errField;b.gradFillField&&(a.gradFillField=b.gradFillField);b.grpFillField&&(a.grpFillField=b.grpFillField);b.highlightField&&(a.highlightField=b.highlightField);
b.hlinkClickField&&(a.hlinkClickField=b.hlinkClickField);b.hlinkMouseOverField&&(a.hlinkMouseOverField=b.hlinkMouseOverField);b.langField&&(a.langField=b.langField);b.latinField&&(a.latinField=b.latinField);b.noFillField&&(a.noFillField=b.noFillField);b.pattFillField&&(a.pattFillField=b.pattFillField);b.solidFillField&&(a.solidFillField=b.solidFillField);b.symField&&(a.symField=b.symField)},tQ=a=>{switch(a){case 1:return 2;case 2:return 3;case 3:return 6;case 4:return 10;case 5:return 7;case 6:return 13;
default:return 1}};class Kx{constructor(){this.Fsb=Array(Kx.LBh);this.XHe=Array(Kx.LBh)}}Kx.LBh=9;Object(n.a)(Kx,"TextListStyleCache",null,[]);class SK{constructor(){this.restartInfo=this.nextNumber=1;this.listStyle=this.nextListId=0;this.autonumberBulletType=8}}Object(n.a)(SK,"NumberingData",null,[]);class Fv{}Fv.IRd="\u2022";Fv.Cki="p";Fv.Dki="n";Object(n.a)(Fv,"ListFormats",null,[]);class TK{constructor(a,b,c,h){this.kWg=this.lWg=Fc.App.Um;this.brg=null;this.jc=a;this.Xl=b;this.YL=c;this.eA=h}get caches(){return this.brg||
(this.brg={})}jYf(a,b,c){const h=c-1;let m=a.L_;var y;const G=!!m&&!pa.a.nil.equals(m[h]);if(G&&(y=this.caches[m[h].toString()]))return y=y.clone(),b=pa.a.create(),a.Fh.CE(y,b),y;if(!G)if(m)m=Array.clone(m);else for(m=Array(9),y=0;y<m.length;y++)m[y]=pa.a.nil;const U=G?m[h]:pa.a.create();y=this.mvi(a,b,c);m[h]=U;this.caches[U.toString()]=y;G||(a.L_=m);a.Fh.CE(y,U);G&&(y=y.clone(),a.Fh.CE(y,pa.a.create()));return y}mvi(a,b,c){const h=Kn.a.instance.createInstance(131073);if(b){var m=b.ZXf(a.rowIndex,
a.pi,a.rowSpan,a.colSpan);b=(b=(b=a.listStyle)?QK(b,c):null)||new cq;if(m){var y=c-1;c=m.Fsb[y];y=m.XHe[y];if(c||y){m=b.defRPrField||new xp;if(y){const G=dd.a(dd.c(y));y=G;b.algnFieldSpecified&&(y.algnFieldSpecified=!0,y.algnField=b.algnField);b.indentFieldSpecified&&(y.indentFieldSpecified=!0,y.indentField=b.indentField);b.lvlFieldSpecified&&(y.lvlFieldSpecified=!0,y.lvlField=b.lvlField);b.marLFieldSpecified&&(y.marLFieldSpecified=!0,y.marLField=b.marLField);b.marRFieldSpecified&&(y.marRFieldSpecified=
!0,y.marRField=b.marRField);b.rtlFieldSpecified&&(y.rtlFieldSpecified=!0,y.rtlField=b.rtlField);b.buAutoNumField&&(y.buAutoNumField=b.buAutoNumField);b.buCharField&&(y.buCharField=b.buCharField);b.buClrField&&(y.buClrField=b.buClrField);b.buClrTxField&&(y.buClrTxField=b.buClrTxField);b.buFontField&&(y.buFontField=b.buFontField);b.buFontTxField&&(y.buFontTxField=b.buFontTxField);b.buNoneField&&(y.buNoneField=b.buNoneField);b.buSzPctField&&(y.buSzPctField=b.buSzPctField);b.buSzPtsField&&(y.buSzPtsField=
b.buSzPtsField);b.buSzTxField&&(y.buSzTxField=b.buSzTxField);b.defRPrField&&(y.defRPrField=b.defRPrField);b.lnSpcField&&(y.lnSpcField=b.lnSpcField);b.spcAftField&&(y.spcAftField=b.spcAftField);b.spcBefField&&(y.spcBefField=b.spcBefField);b=G}c&&(c=dd.a(dd.c(c)),RK(c,m),b.defRPrField=c)}}a=Object(ua.a)(115,this.jc.mg(a));this.uvi(h,b,a?a.Ne:null)}h.te(X.a.Q7b,!0);return h}uvi(a,b,c){this.tvi(a,b);if(b){if(b.algnFieldSpecified){var h=tQ(b.algnField);a.setValue(kb.a.Il,h);a.setValue(kb.a.XI,h)}b.marLFieldSpecified&&
a.te(jb.a.Zl,te.a.xub(b.marLField));b.marRFieldSpecified&&a.te(jb.a.pY,te.a.xub(b.marRField));b.indentFieldSpecified&&a.te(jb.a.$n,te.a.xub(b.indentField));b.defTabSzFieldSpecified&&a.setValue(jb.a.Ptb,te.a.xub(b.defTabSzField));b.spcAftField&&(h=Vs.C0b(b.spcAftField.itemField),Object(za.a)(Us,h.lineSpacing)?a.setValue(X.a.Wka,2):Object(za.a)(er,h.lineSpacing)&&a.setValue(X.a.Wka,4),a.setValue(X.a.Jda,h.value));b.spcBefField&&(h=Vs.C0b(b.spcBefField.itemField),Object(za.a)(Us,h.lineSpacing)?a.setValue(X.a.Xka,
2):Object(za.a)(er,h.lineSpacing)&&a.setValue(X.a.Xka,4),a.setValue(X.a.Kda,h.value));b.lnSpcField&&(h=Vs.C0b(b.lnSpcField.itemField),Object(za.a)(Us,h.lineSpacing)?a.setValue(X.a.gX,2):Object(za.a)(er,h.lineSpacing)&&a.setValue(X.a.gX,4),a.setValue(X.a.ox,h.value))}else Ba.a.J(8959502,820,10,"TextPropertyHelper::ComposeParagraphProperties - ParagraphProperties is null");b.defRPrField&&Nk.nvi(a,b.defRPrField,c)}xXk(a){if(a=a.L_)for(let b=0;b<a.length;b++){const c=a[b];c&&!pa.a.nil.equals(c)&&delete this.caches[c.toString()]}}tvi(a,
b){var c=this.fw(b);a.Ux(c.propertySet);b.marLFieldSpecified&&a.setValue(jb.a.Zl,te.a.xub(b.marLField));b.indentFieldSpecified&&a.setValue(jb.a.$n,te.a.xub(b.indentField));b.defRPrField&&b.defRPrField.szFieldSpecified&&a.setValue(kb.a.fontSize,Nk.uGf(b.defRPrField.szField));b.spcAftField&&(c=Vs.C0b(b.spcAftField.itemField),Object(za.a)(er,c.lineSpacing)&&(a.setValue(X.a.Wka,4),a.setValue(X.a.Jda,c.value)));b.spcBefField&&(b=Vs.C0b(b.spcBefField.itemField),Object(za.a)(er,b.lineSpacing)&&(a.setValue(X.a.Xka,
4),a.setValue(X.a.Kda,b.value)))}fw(a){let b;({sne:b,i3j:c}=this.M6d(a));var c=Pe.a.pN(b,c);0===b&&(c.qA=c.eX=a.buAutoNumField.startAtField);return c}M6d(a){let b,c;b=16;c=1;if(a)if(a.buCharField)switch(b=1,a.buCharField.charField){case Fv.Cki:case Fv.Dki:c=3}else if(a.buAutoNumField)switch(b=0,a.buAutoNumField.typeField){case 9:case 8:case 6:case 7:c=1;break;case 4:case 0:case 2:c=2;break;case 14:case 10:case 12:c=3;break;case 5:case 1:case 3:c=4;break;case 15:case 11:case 13:c=5}return{sne:b,i3j:c}}validate(a){if(Object(ua.a)($f.a,
a)&&(this.Xl.iFa(a)||Yi.OutlineReader.ZW(a))&&a.isConnected){this.lWg=new Date;var b=Array(No.a.K7);for(var c=0;c<No.a.K7;++c)b[c]=new SK;c=-1;var h=0,m=!1;a=P.a.Mz(a);for(a.$l(Object(F.a)(this,this.JYj,"listOEFilter"),null);a.moveNext();){16===a.iterator.currentNode.type&&(c=-1,h=0,m=!1,this.eXc(b,0),this.sge(b,0,0));if(11!==a.iterator.currentNode.type)continue;const y=a.iterator,G=this.Wca(y);let U=b[G].nextListId,ja=null;if(Wb.ListReader.tk(y)){this.eA.Sma(y);ja=this.eA.F6d(y);const va=this.s2i(y);
y.zc();if(!ja){ec.a.instance.Wb("PossibleIncorrectListNumbering",{["Reason"]:"ListInfoNotFound"});continue}if(0===ja.listType){if(ja.qA!==Yd.a.Hw&&b[G].restartInfo!==ja.qA||ja.listStyle!==b[G].listStyle||va!==b[G].autonumberBulletType)m=!0,b[G].restartInfo=b[G].nextNumber=ja.qA===Yd.a.Hw?1:ja.qA,U=b[G].nextListId=0,b[G].listStyle=ja.listStyle,b[G].autonumberBulletType=va;ja.eX=b[G].nextNumber;c!==G||m?(ja.oja=b[G].nextNumber,m=!1):ja.oja=Yd.a.Hw;this.YL.isEmpty(y,!1)?m=!0:b[G].nextNumber++}else 1!==
ja.listType&&ec.a.instance.Wb("PossibleUnexpectedListAlteration",{["Reason"]:"UnknownListType"});U||(U=b[G].nextListId=++h);y.currentNode.listID=U}c=G;ja?(0===ja.listType?this.eXc(b,G+1):this.eXc(b,G),this.sge(b,G+1,U)):(this.eXc(b,G),this.sge(b,G,0))}this.kWg=new Date;Ba.a.J(22344988,820,50,"ListCore::Validate {0}",+this.kWg-+this.lWg)}}Wca(a){this.YL.Wg(a)||ec.a.instance.Wb("PossibleListLevelIncorrect",{["Reason"]:Cd.a.zca});return a.currentNode.sa(jb.a.listLevel,Vg.a.zEa)}vaj(a){this.YL.Wg(a)||
ec.a.instance.Wb("PossibleLossOfAccessibilityInfoForList",{["Reason"]:Cd.a.zca});return a.currentNode.listID}JYj(a){return this.YL.Wg(a)||rd.TableReader.aq(a)||gk.l(a)||Qe.isTableCell(a)}eXc(a,b){for(;b<No.a.K7;++b)a[b].nextNumber=a[b].restartInfo=1}sge(a,b,c){for(;b<No.a.K7;++b)a[b].nextListId=c}s2i(a){return a.currentNode.sa(X.a.autonumberBulletType,8)}}Object(n.a)(TK,"ListCore",null,[522]);class Ep{constructor(a,b,c=null){this.Sf=a;this.Di=b;this.Ft=null;this.sob=c}get ldl(){return!1}fMk(a){return a}eLb(a){let b,
c,h;b=Wb.ListReader.g8a;c=a.propertySet.sa(jb.a.listID,0);h=a.propertySet.sa(jb.a.listLevel,-1);if(J.a.instance.ga(85)||b&&0<c&&0<=h)this.Ft=a;else{let m=1;const y=a.listStyle;b&&42!==y&&0<y&&(m=y);this.Ft=Pe.a.pN(a.listType,m,null,c,h,void 0,"")}}c8k(a){a&&(this.Ft=a)}j_d(){}createList(a){const b=ec.a.instance.Vp(D.a.createList);Kd.OutlineElementReader.Wg(a)||ec.a.instance.Wb("PossiblyIncorrectListCreation",{["Reason"]:Cd.a.zca});Wb.ListReader.tk(a)&&ec.a.instance.Wb("PossiblyIncorrectListCreation",
{["Reason"]:Cd.a.lyi});const c=this.sDi();a.Cl(c,4);a.Qk(c);b.end();return c}sDi(){return zs.a.instance.createInstance(393234)}Qna(a){const b=ec.a.instance.Vp(D.a.Qna);Kd.OutlineElementReader.Wg(a)||ec.a.instance.Wb("PossiblyIncorrectListRemoval",{["Reason"]:Cd.a.zca});Wb.ListReader.tk(a)&&this.oSk(a);b.end()}oSk(a){this.Sf.Sma(a);a.Mi()}frb(a,b,c,h=!1){const m=ec.a.instance.Vp(D.a.ldi);if(!this.PAf(b,c))return{returnValue:!1,G$a:c};this.Fqh(a,c,h);h=a.Sa(xc.a.MZg);var y=a.sa(xc.a.Ieg,!1);let G=!1;
1===c.N_&&c.Gke&&!c.HT&&(G=!0);const U=c.propertySet.sa(jb.a.eac,null);U&&U===Box4Intl.Box4Strings.L_ListStyleNone&&(1===c.listType?G=c.Gke&&!c.HT:0===c.listType&&(G=0===c.listStyle));y?G&&(c.mya(16,0),a.setValue(xc.a.fE,16),a.setValue(xc.a.Mda,0)):(y=this.Sf.fw(b),this.cuh(c,y,h,G,a)&&(m.properties.$("ToggledOff","true"),c.mya(16,0),this.o7k(a)),0===c.listType&&a.Sa(xc.a.gVa)&&(c.qA=a.eb(xc.a.gVa),a.removeProperty(xc.a.gVa)));if(h&&(m.properties.$("MultipleOESelection","true"),({G$a:c}=this.Uth(b,
c)).returnValue))return m.end(),{returnValue:!1,G$a:c};this.Uai(b,c,a);a.setValue(xc.a.Ieg,!0);m.end();return{returnValue:!0,G$a:c}}cuh(a,b,c,h){if(h)return!0;if(b){h=a.listType===b.listType;const m=0===a.listStyle&&a.qA===Yd.a.Hw;a=a.listStyle===b.listStyle&&a.qA===b.qA;this.Sf.qbb&&(a=a&&!c);return h&&(m||a)}return!1}o7k(a){a.setValue(xc.a.fE,16);a.setValue(xc.a.Mda,0)}Fqh(){}PAf(){return!0}Uth(a,b){return{returnValue:16!==b.listType&&Kd.OutlineElementReader.isEmpty(a,!0),G$a:b}}Qsb(a){const b=
ec.a.instance.Vp(D.a.Qsb);Ob.ParagraphReader.Yd(a)||ec.a.instance.Wb("ClearingListFromNonParagraph",{["Reason"]:Cd.a.SZd});const c=new rb.GraphIterator;c.set(a);c.gf();c.AB(12);mc.OutlineElementNavigator.Oe(c);this.xPa(c,null);b.end()}APd(){}merge(a,b,c){const h=ec.a.instance.Vp(D.a.IYj);Kd.OutlineElementReader.Wg(b)||ec.a.instance.Wb("PossibleIncorrectMergeOfOEs",{["Reason"]:"SrcIsNotOE"});Kd.OutlineElementReader.Wg(a)||ec.a.instance.Wb("PossibleIncorrectMergeOfOEs",{["Reason"]:"DestIsNotOE"});if(Wb.ListReader.tk(b)){h.properties.$("UseSourceListWithNonlistDestination",
c.toString());let m;m=Wb.ListReader.g8a;c&&this.ldl&&Wb.ListReader.tk(a)&&this.Qna(a);if(!Wb.ListReader.tk(a)||c&&m)c&&(u.AFrameworkApplication.fk("Microsoft.Office.Web.SessionSettings.IWacWordSwitchListByRangeSelectionImprovementSettings"),c=this.E6d(b),this.Sf.Uyh&&c.propertySet.te(kb.a.iVa,Yd.a.Hw),1===c.N_&&c.CCf(),this.xPa(a,c),h.properties.$("MoveListInfoFromSrcToDestOE","true")),u.AFrameworkApplication.fk("Microsoft.Office.Web.SessionSettings.IWacWordQoEListExternalPasteImprovementSettings");
Ep.BL.IZc&&this.Joi(b,a);this.Qna(b);h.properties.$("RemoveListFromSrcOE","true")}h.end();return!0}Joi(a,b){a=Ob.ParagraphReader.dwb(a.currentNode);b=this.Sf.l1f(b);this.Gnd(b,a,null)}E6d(a){return this.Sf.fw(a)}Gnd(a,b,c){if(a){b=md.a.create(b);b=uc.a.ps(b);this.K_a(a,kb.a.fontColor,c,b);this.K_a(a,kb.a.fontSize,c,b);if(this.sob){let h,m;({value:h}=this.getPropertyValue(kb.a.font,c,b,"")).returnValue&&this.sob.TU(a,h);({value:m}=this.getPropertyValue(jb.a.hV,c,b,-1)).returnValue&&this.sob.MKa(a,
m)}else this.K_a(a,kb.a.font,c,b),this.K_a(a,jb.a.hV,c,b);u.AFrameworkApplication.fk("Microsoft.Office.Web.SessionSettings.IWacWordQoEListExternalPasteImprovementSettings");Ep.BL.IZc&&(this.K_a(a,kb.a.bold,c,b),this.K_a(a,kb.a.italic,c,b),this.K_a(a,kb.a.superscript,c,b),this.K_a(a,kb.a.subscript,c,b))}}tqh(){}K_a(a,b,c,h){c&&c.Sa(b)?a.setValue(b,c.eb(b)):h&&h.cache&&(c=h.cache,c.Sa(b)&&a.setValue(b,c.eb(b)))}getPropertyValue(a,b,c,h){if(b&&b.Sa(a))return h=b.eb(a),{returnValue:!0,value:h};if(!c||
!c.cache)return{returnValue:!1,value:h};b=c.cache;return b.Sa(a)?(h=b.eb(a),{returnValue:!0,value:h}):{returnValue:!1,value:h}}DQf(a,b){b.Sa(xc.a.fE)||(a===D.a.jP?b.setValue(xc.a.fE,1):a===D.a.NR&&b.setValue(xc.a.fE,0));b.Sa(xc.a.Mda)||b.setValue(xc.a.Mda,0);return b}GPa(a,b,c,h,m,y,G){a=ec.a.instance.Vp(D.a.GPa);const U=this.Sf.fw(b);c=Pe.a.pN(0,c);c.qA=h;c.zra=y;U&&c.yae(U)&&c.qA===U.eX||(h=new t.GraphTransaction(15),h.yy(b),b=this.Pcj(c),null!=b&&G.numbering(b)&&(ba.ULS.sendTraceTag(509747284,
393,50,"Found list insert matching string "+y),Ep.characterPropertiesEditor.replaceTextRange(m,"")),h.dispose());a.end()}Pcj(a){var b;let c=null===(b=null===nv||void 0===nv?void 0:nv[a.listType])||void 0===b?void 0:b[a.zra];if(null==c)return null;b=new E.DictionaryPropertySet;b.setValue(xc.a.fE,a.listType);b.setValue(xc.a.Mda,a.listStyle);b.setValue(xc.a.gVa,a.qA);b.setValue(kb.a.Ri,c.Ri);this.D4k(b,c.autonumberBulletType);return b}static get characterPropertiesEditor(){return Ep.Zg||(Ep.Zg=vb.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static get BL(){return Ep.tK||
(Ep.tK=vb.a.instance.rb("Box4.List.ListSettings"))}}Ep.Zg=null;Ep.tK=null;Object(n.a)(Ep,"ListEditor",null,[521]);class An{}An.VBe=80640;An.WBe=0;An.nce=80640;An.oce=-80640;Object(n.a)(An,"ParagraphConstants",null,[]);var Tl=d(183);class UK extends Ep{constructor(a,b,c,h,m,y,G,U,ja,va,Ta,fb,Db,gc,hc){super(a,b);this.h2c=[kb.a.Ri,kb.a.font];this.j7c=[kb.a.Ri,kb.a.font,kb.a.fontColor,X.a.autonumberBulletType,X.a.ivb];this.Tdb=c;this.Bec=h;this.sCb=m.vig;this.YL=y;this.Xl=G;this.oH=ja;this.jA=va;this.ki=
Ta;this.Gva=fb;this.Ydc=m.uje;this.idb=m.xig;this.PL=Db;this.Pb=gc;this.Ea=hc;this.sva=m.pptCopyPasteListMarkerEnabled;this.Xdc=m.pptCopyPasteMarginAndIndentationEnabled;this.BBg=m.pptCopyPasteTextWithSpacingFromExternal}eLb(a){super.eLb(a);this.idb&&this.nKc(a.propertySet,this.Ft.propertySet)}KTe(a){if(this.sCb&&this.Ft&&this.Ft.propertySet){const b=this.Ft.propertySet.sa(jb.a.listLevel,-1);-1!==b&&this.LTe(a,b)}this.sva&&this.Ft&&(this.Ft.qvb=!0);this.BBg&&this.gqh(a);this.BPd(a,this.Ft);this.Ft=
null}Tph(a,b,c){b=this.Di.g8b(a);this.Di.yMb(a,b,c,!1,!0)}PAf(a,b){if(!a||!b)return!1;if(a.Bb(4)){var c=this.Sf.F6d(a);this.Tdb.Oe(a);if(c&&c.listType===b.listType&&(1===b.listType||0===b.listType))return!0}c=a.Bb(2);const h=c.sa(jb.a.$n,Vg.a.indent),m=c.sa(jb.a.Zl,Vg.a.leftMargin);this.Tdb.Oe(a);a=h;let y=m;({indent:a,margin:y}=this.oSd(Nk.Mxf(Ob.ParagraphReader.wja(c,kb.a.fontSize,0)),b.listType,h,m,a,y));return!!(this.eOj(y)&this.$Mj(a))}y0f(a,b,c,h){if(!a)return Ba.a.J(512496326,820,15,"ListEditor::GetIndentationFromListStyle - paragraphNode is null"),
{ime:c,mce:h};b&&(c=b.sa(X.a.r1b,Vg.a.leftMargin),h=b.sa(X.a.pYd,Vg.a.indent),(a=this.Ea.Zm(a))&&a.ud&&(c=b.sa(jb.a.Zl,Vg.a.leftMargin),h=b.sa(jb.a.$n,Vg.a.indent)));return{ime:c,mce:h}}hAf(a,b,c,h){if(!a||!this.YL.Wg(b))return Ba.a.J(512496325,820,15,"ListEditor::CalculateDefaultMarginAndIndent - paragraphNode is null or iterator is not outline element "),{$1d:c,Z1d:h};var m=this.nQ(b,this.oH.Wca(b));if(m){const y=a.sa(jb.a.Zl,Vg.a.leftMargin),G=a.sa(jb.a.$n,Vg.a.indent);c=y;h=G;let U=Vg.a.leftMargin,
ja=Vg.a.indent;({ime:U,mce:ja}=this.y0f(a,m,U,ja));m=Pe.a.wCa(m,null).listType;const va=y+(0<=G?0:G),Ta=U+(0<=ja?0:ja),fb=b.Bb(4);let Db=16;fb&&(Db=this.Bec.pwb(fb),b.zc());ja&&va===Ta&&m===Db?(c=U,h=ja):({indent:h,margin:c}=this.oSd(this.h9a(a),Db,G,y,h,c),c=Math.max(Math.min(c,An.VBe),An.WBe),h=Math.max(Math.min(h,An.nce),An.oce))}return{$1d:c,Z1d:h}}w6i(a,b){if(!a||!this.YL.Wg(b))return Ba.a.J(512496324,820,15,"ListEditor::GetDefaultMargin - paragraphNode is null or iterator is not outline element "),
Vg.a.leftMargin;let c=Vg.a.leftMargin,h=Vg.a.indent;({$1d:c,Z1d:h}=this.hAf(a,b,c,h));0<c&&Ba.a.J(512496323,820,50,"Get defaultMargin from liststyle");return c}t6i(a,b){if(!a||!this.YL.Wg(b))return Ba.a.J(512496322,820,15,"ListEditor::GetDefaultIndent - paragraphNode is null or iterator is not outline element "),Vg.a.indent;let c=Vg.a.leftMargin,h=Vg.a.indent;({$1d:c,Z1d:h}=this.hAf(a,b,c,h));0<h&&Ba.a.J(512496321,820,50,"Get defaultIndent from liststyle");return h}Uth(a,b){return{returnValue:!1,
G$a:b}}cuh(a,b,c,h,m){return h?!0:!b||m&&m.Sa(kb.a.Ri)?!1:a.listType===b.listType}eOj(a){return a<An.VBe&&a>=An.WBe}$Mj(a){return a<An.nce&&a>=An.oce}D4k(a,b){a.setValue(X.a.autonumberBulletType,b)}qel(a){return a}j_d(a,b){a.Sa(jb.a.listLevel)&&b.te(jb.a.listLevel,a.Lh(jb.a.listLevel))}Iaj(a,b){return Object(za.a)(Tl.TableCellNode,a)?this.oH.jYf(a,this.jA.FTc(a),b):this.Acj(a,b)}Acj(a,b){--b;const c=a.sa(jb.a.L_,[]);return 0>b||b>=c.length?(Ba.a.J(512496320,820,10,"ListEditor::DictionaryPropertySet - Level is out of bounds {0}",
b),ec.a.instance.Wb("PossibleLossOfListStyle",{["Reason"]:"ListLevelOutOfBounds"}),null):a.Fh.ye(c[b])}Gnd(){}LTe(a,b){if(this.YL.Wg(a)&&0<=b&&b<No.a.K7){const c=a.currentNode,h=a.Bb(2);c&&c.setValue(jb.a.listLevel,b);h&&(h.setValue(jb.a.listLevel,b),a.zc())}}F7k(a,b){if(this.YL.Wg(a)&&b&&b.propertySet){var c=a.Bb(4);c&&(b.kxb&&b.h9&&(this.idb?(this.nKc(b.propertySet,c),this.sva&&b.propertySet.Sa(X.a.autonumberBulletType)&&c.setValue(X.a.autonumberBulletType,b.propertySet.eb(X.a.autonumberBulletType))):
c.setValue(kb.a.Ri,b.h9)),a.zc())}}tqh(a){if(this.YL.Wg(a)){if(this.sCb&&this.Ft&&this.Ft.propertySet){const b=this.Ft.propertySet.sa(jb.a.listLevel,-1);-1!==b&&this.LTe(a,b);this.F7k(a,this.Ft)}this.Xdc&&this.f7k(a);this.sva&&(this.Ft&&this.Ft.propertySet?this.aMj(this.Ft)||(Ba.a.J(512496285,820,50,"Copied from external, such as website."),this.MTe(a)):(Ba.a.J(512496286,820,50,"Copied from external, such as win32 ppt."),this.MTe(a)));this.BBg&&this.gqh(a);this.Ft=null}else Ba.a.J(512496288,820,10,
"ListEditorCssVersion::SetProperPendingListInfoAfterPaste - input GraphIterator is not outline element ")}gqh(a){const b=this.oH.Wca(a),c=this.nQ(a,b),h=a.Bb(2);c&&h&&0<=b&&b<No.a.K7&&(this.Ft&&this.Ft.propertySet&&this.Ft.propertySet.Sa(X.a.ox)||(Ba.a.J(512496284,820,50,"Get master defined line-spacing "),h.setValue(X.a.ox,c.sa(X.a.HIi,Vg.a.lineSpacing)),h.setValue(X.a.gX,c.sa(X.a.IIi,2))),this.Ft&&this.Ft.propertySet&&this.Ft.propertySet.Sa(X.a.Kda)||(Ba.a.J(512496283,820,50,"Get master defined line-spacing before"),
h.setValue(X.a.Kda,c.sa(X.a.WIi,Vg.a.Ymg)),h.setValue(X.a.Xka,c.sa(X.a.XIi,4))),this.Ft&&this.Ft.propertySet&&this.Ft.propertySet.Sa(X.a.Jda)||(Ba.a.J(512496282,820,50,"Get master defined line-spacing after"),h.setValue(X.a.Jda,c.sa(X.a.UIi,Vg.a.Xmg)),h.setValue(X.a.Wka,c.sa(X.a.VIi,4))));a.zc()}aMj(a){if(a.propertySet.Sa(kb.a.Ri)){const b=a.propertySet.eb(kb.a.Ri).length;if(1===b&&a.propertySet.Sa(kb.a.font)||3===b&&a.propertySet.Sa(X.a.autonumberBulletType))return!0}return!1}f7k(a){var b=this.oH.Wca(a);
const c=this.nQ(a,b),h=a.Bb(2);c&&h&&0<=b&&b<No.a.K7&&(this.Ft&&this.Ft.propertySet&&this.Ft.propertySet.Sa(jb.a.Zl)||(Ba.a.J(512496281,820,50,"Get master defined indent-left."),c.Sa(X.a.r1b)&&h.setValue(jb.a.Zl,c.eb(X.a.r1b)),(b=this.Ea.Zm(h))&&b.ud&&h.setValue(jb.a.Zl,c.sa(jb.a.Zl,Vg.a.leftMargin))),this.Ft&&this.Ft.propertySet&&this.Ft.propertySet.Sa(jb.a.$n)||(Ba.a.J(512496280,820,50,"Get master defined firstline indent."),c.Sa(X.a.pYd)&&h.setValue(jb.a.$n,c.eb(X.a.pYd)),(b=this.Ea.Zm(h))&&b.ud&&
h.setValue(jb.a.$n,c.sa(jb.a.$n,Vg.a.leftMargin))));a.zc()}MTe(a){const b=this.oH.Wca(a),c=this.nQ(a,b),h=a.Bb(4);c&&h&&0<=b&&b<No.a.K7&&(Ba.a.J(512496279,820,50,"Get master defined list marker"),c.Sa(kb.a.Ri)?(h.setValue(kb.a.Ri,c.eb(kb.a.Ri)),c.Sa(kb.a.font)?h.setValue(kb.a.font,c.eb(kb.a.font)):c.Sa(X.a.autonumberBulletType)&&h.setValue(X.a.autonumberBulletType,c.eb(X.a.autonumberBulletType))):(h.setValue(kb.a.font,Yk.Pyf),h.setValue(kb.a.Ri,[Yk.IRd])));a.zc()}TYc(a){return a?16!==this.oH.M6d(a).sne:
!1}Qsb(){Ba.a.J(512496278,820,10,"ListEditor::ClearListFromParagraph - Ppt doesn't implement ClearFormatting command");ec.a.instance.Wb("FormattingNotCleared",{["Reason"]:Cd.a.ndg})}rRk(a){if(this.YL.Wg(a)){var b=a.Bb(4);b&&(1===this.Bec.pwb(b)&&b.removeProperty(X.a.autonumberBulletType),a.zc())}}a8k(a){this.YL.Wg(a)&&(a=a.currentNode)&&a.setValue(X.a.pPj,!0)}merge(a,b,c,h){const m=this.oH.Wca(b),y=this.nQ(a,this.oH.Wca(a)),G=this.nQ(b,m);y&&a&&(a.Bb(2),a.currentNode&&(a.currentNode.Sa(jb.a.Zl)&&
y.Sa(jb.a.Zl)&&!JA.APropertySet.nZa(jb.a.Zl.type,a.currentNode.Lh(jb.a.Zl),y.Lh(jb.a.Zl))&&y.te(jb.a.Zl,a.currentNode.Lh(jb.a.Zl)),a.currentNode.Sa(jb.a.$n)&&y.Sa(jb.a.$n)&&!JA.APropertySet.nZa(jb.a.$n.type,a.currentNode.Lh(jb.a.$n),y.Lh(jb.a.$n))&&y.te(jb.a.$n,a.currentNode.Lh(jb.a.$n))),a.zc());super.merge(a,b,c);c&&this.sCb&&(this.LTe(a,m),this.a8k(a),this.rRk(a));this.fbi(b,G,y);if(h&&(a.Bb(2),c=a.currentNode.sa(X.a.OJa,""),a.zc(),c.length))for(a=this.Pb.$5d(b);a.Af(1)&&a.currentNode!==h.currentNode;)a.Bb(2),
a.currentNode.setValue(X.a.OJa,c),a.zc();return!0}Uai(a,b,c){const h=Nc.a.Ib;h&&(h.Nj=!0);this.BPd(a,b,c)}Wrl(a,b){var c=rb.GraphIterator.nb(b);this.Sf.Sma(c);b=c.currentNode;c.zc();c=this.createList(a);a.zc();c.c7a(b,X.a.shapeId,X.a.ixa)}xPa(a,b){this.BPd(a,b)}ttf(a,b,c){this.YL.Wg(a)||ec.a.instance.Wb("PossibleIndentNotAdjusted",{["Reason"]:Cd.a.zca});const h=a.Bb(2),m=h.sa(jb.a.$n,Vg.a.indent),y=h.sa(jb.a.Zl,Vg.a.leftMargin);this.Tdb.Oe(a);if(16===b)this.Gva.uv.ljb(h,0),0>m&&(ec.a.instance.Wb("UnexpectedlyChangingLeftIdent",
{["Reason"]:"NegativeLeftIndent"}),this.Di.mjb(a,1,Math.max(y+m,0)));else{var G=this.nQ(a,this.oH.Wca(a));G||(G=new E.DictionaryPropertySet,Ba.a.J(512496273,820,50,"listStyle is null"));var U=Vg.a.indent;let ja=Vg.a.leftMargin;c?{ime:ja,mce:U}=this.y0f(h,G,ja,U):(U=G.sa(jb.a.$n,Vg.a.indent),ja=G.sa(jb.a.Zl,Vg.a.leftMargin));G=Pe.a.wCa(G,null).listType;const va=ja+(0<=U?0:U);U&&y+(0<=m?0:m)===va&&G===b?(this.Gva.uv.ljb(h,U),this.Di.mjb(a,1,ja)):(U=m,G=y,{indent:U,margin:G}=this.oSd(this.h9a(h),b,m,
y,U,G),0<this.oH.Wca(a)&&c&&(G+=ja),G=Math.max(Math.min(G,An.VBe),An.WBe),U=Math.max(Math.min(U,An.nce),An.oce),this.Gva.uv.ljb(h,U),this.Di.mjb(a,1,G))}}h9a(a){if(!a)return 0;a=this.Xl.wka(a)?this.Xl.Fkj(this.Xl.Awb(a)):Ob.ParagraphReader.wja(a,kb.a.fontSize,0);return Nk.Mxf(a)}oSd(a,b,c,h,m,y){let G=(b=1===b)?.3125:.375;0<a&&(G=12>=a?b?.1875:.25:12<a&&18>=a?b?.3125:.375:18<a&&25>=a?b?.375:.5:25<a&&35>=a?b?.5:.5625:35<a&&44>=a?b?.625:.8125:44<a&&56>=a?b?.75:1:56<a&&72>=a?b?.9375:1.25:b?1.25:1.5);
a=-1*te.a.Ita(G);0>=c&&a<c?(y=a-c,m=c+y,y=h-y):0<c&&(m=a,y=h-a);return{indent:m,margin:y}}fbi(a,b,c){if(b&&c){mc.OutlineElementNavigator.wi(a);var h=a.xq;if(Ob.ParagraphReader.fl(a)){b=b.sa(kb.a.fontSize,Lr.fontSize);c=c.sa(kb.a.fontSize,Lr.fontSize);for(let m=0;m<h.Ra.length;++m){const y=h.Ra.ga(m);y&&y.formatting&&y.formatting.Pz&&y.formatting.Pz.Sa(kb.a.fontSize)&&y.formatting.Pz.eb(kb.a.fontSize)===b&&this.ki.ir(y.formatting,c)}}mc.OutlineElementNavigator.Oe(a)}}E6d(a){if(this.sva){if(a=this.Sf.fw(a))a.qvb=
!0;return a}return super.E6d(a)}BPd(a,b,c=null){if(this.YL.Wg(a)){this.lbi(b,c,a);var h=a.Bb(4);if(!h||b&&16!==b.listType)if(b&&0!==b.listStyle){h?Pe.a.wCa(h,h).i_b():h=this.createList(a);a.zc();const m=a.Bb(2);a.zc();this.Ydc&&m.sa(xc.a.F9b,!1)||this.sva&&b.qvb?h.c7a(b.propertySet,X.a.shapeId,X.a.ixa,jb.a.listLevel,kb.a.Ri,xc.a.fE):h.c7a(b.propertySet,X.a.shapeId,X.a.ixa,jb.a.listLevel,X.a.hFa);c&&c.Sa(X.a.autonumberBulletType)&&h.setValue(X.a.autonumberBulletType,c.eb(X.a.autonumberBulletType));
this.sva&&b.qvb&&b.kxb&&(3===b.h9.length&&b.propertySet.Sa(X.a.autonumberBulletType)?(h.setValue(kb.a.Ri,b.h9),h.setValue(X.a.autonumberBulletType,b.propertySet.eb(X.a.autonumberBulletType)),Ba.a.J(512496267,826,50,"Support CCP customized number list")):1===b.h9.length&&b.k$a?(h.setValue(kb.a.Ri,b.h9),h.setValue(kb.a.font,b.font),Ba.a.J(512496266,826,50,"Support CCP customized bullet")):(Ba.a.J(512496265,826,50,"Set list use dst master liststyle."),this.MTe(a)))}else return;else a.Mi();b&&b.bWf||
(this.Ydc?(c=this.Sf.fw(a),this.ttf(a,c?c.listType:16,b?b.qvb:!1)):this.ttf(a,b?b.listType:16,b?b.qvb:!1))}else Ba.a.J(512496269,820,10,"ListEditor::ApplyListInfoInternal - iterator is not outline element "),ec.a.instance.Wb("FailedToApplyListProperties",{["Reason"]:Cd.a.zca})}lbi(a,b,c){b&&a&&(1===a.listType||0===a.listType)&&(this.PL.Ux(b,a.propertySet,this.h2c),c=this.nQ(c,this.oH.Wca(c))||new E.DictionaryPropertySet,1===a.listType&&(a.propertySet.setValue(xc.a.Mda,6),b.Sa(kb.a.Ri)||(a.propertySet.setValue(kb.a.font,
Yk.Pyf),a.propertySet.setValue(kb.a.Ri,[Yk.IRd]),c.Sa(kb.a.Ri)&&(b=c.eb(kb.a.Ri)[0],b!==Yk.UXd&&b!==Yk.JIa&&this.PL.Ux(c,a.propertySet,this.h2c)))))}nQ(a,b){this.YL.Wg(a)||ec.a.instance.Wb("PossibleLossOfListStyle",{["Reason"]:Cd.a.zca});a=this.Dkj(a);return a?this.Iaj(a,1+b):(Ba.a.J(512496263,820,10,"ListEditor::DictionaryPropertySet - Outline is null"),ec.a.instance.Wb("PossibleLossOfListStyle",{["Reason"]:Cd.a.GFf}),null)}Dkj(a){a=rb.GraphIterator.PG(a);a.q6(Yi.OutlineReader.B9b);const b=a.Mw(16);
return b?b:a.o1a()}pwb(a){return this.oH.M6d(a).sne}Fqh(a,b,c){c||0!==b.listType||(b.qA=a.sa(kb.a.iVa,Yd.a.Hw))}nKc(a,b){this.PL.bAi(a,b,this.j7c)}}Object(n.a)(UK,"ListEditor",Ep,[520,521]);class Ws{constructor(a,b){this.hZb=a;this.Xrb=b}}Object(n.a)(Ws,"BulletMarker",null,[]);class Xs{constructor(a,b){this.Syf=a;this.l0g=b}}Object(n.a)(Xs,"ListMarkerPreview",null,[]);class Ys{constructor(a,b,c){this.b0g=a;this.h0g=b;this.NQd=c}}Object(n.a)(Ys,"NumberingMarker",null,[]);class VK{constructor(a,b){this.Pb=
a;this.QEb=b;this.q9j=new sb.a(Object(F.a)(this,this.nDi,"createListBulletDictionary"));this.v9j=new sb.a(Object(F.a)(this,this.tDi,"createListNumberingDictionary"));this.u9j=new sb.a(Object(F.a)(this,this.rDi,"createListMarkerPreviewDictionary"));this.s9j=new sb.a(Object(F.a)(this,this.qDi,"createListMarkerAltTextDictionary"))}nDi(){const a=new Nd.a;a.$(3,new Ws(8226,"Arial"));a.$(4,new Ws(111,"Courier New"));a.$(5,new Ws(167,"Wingdings"));a.$(6,new Ws(113,"Wingdings"));a.$(7,new Ws(118,"Wingdings"));
a.$(8,new Ws(216,"Wingdings"));a.$(9,new Ws(252,"Wingdings"));return a}tDi(){const a=new Nd.a;a.$(11,new Ys(0,".",8));a.$(12,new Ys(0,")",7));a.$(13,new Ys(1,".",15));a.$(14,new Ys(3,".",5));a.$(15,new Ys(4,")",2));a.$(16,new Ys(4,".",4));a.$(17,new Ys(2,".",14));return a}rDi(){const a=new Nd.a;a.$(1,new Xs("\u2022",["1.","2.","3."]));a.$(2,new Xs("o",["1)","2)","3)"]));a.$(3,new Xs("\uf0a7",["I.","II.","III."]));a.$(4,new Xs("\uf071",["A.","B.","C."]));a.$(5,new Xs("\uf076",["a)","b)","c)"]));a.$(6,
new Xs("\uf0d8",["a.","b.","c."]));a.$(7,new Xs("\uf0fc",["i.","ii.","iii."]));return a}qDi(){const a=new Nd.a;a.$(3,ResourceStrings.l_ListMarkerAltText_Bullet_1);a.$(4,ResourceStrings.l_ListMarkerAltText_Bullet_2);a.$(5,ResourceStrings.l_ListMarkerAltText_Bullet_3);a.$(6,ResourceStrings.l_ListMarkerAltText_Bullet_4);a.$(7,ResourceStrings.l_ListMarkerAltText_Bullet_5);a.$(8,ResourceStrings.l_ListMarkerAltText_Bullet_6);a.$(9,ResourceStrings.l_ListMarkerAltText_Bullet_7);a.$(11,ResourceStrings.l_ListMarkerAltText_Numbered_1);
a.$(12,ResourceStrings.l_ListMarkerAltText_Numbered_2);a.$(13,ResourceStrings.l_ListMarkerAltText_Numbered_3);a.$(14,ResourceStrings.l_ListMarkerAltText_Numbered_4);a.$(15,ResourceStrings.l_ListMarkerAltText_Numbered_5);a.$(16,ResourceStrings.l_ListMarkerAltText_Numbered_6);a.$(17,ResourceStrings.l_ListMarkerAltText_Numbered_7);return a}get eVa(){return this.q9j.value}get Tcd(){return this.v9j.value}get O0c(){return this.u9j.value}get gng(){return this.s9j.value}Ovf(a,b){const c=this.Pb.Nc(a);c.set(a);
for(a=c.Bb(1);a;){var h=c.Bb(4);if(h){if(1===b){if(1!==h.sa(xc.a.fE,16))return!1}else if(2===b){if(0!==h.sa(xc.a.fE,16))return!1}else if(a=h.sa(kb.a.Ri,null),this.QEb.yXc(b)){h=h.sa(kb.a.font,"");const m=this.eVa.ga(b);if(!a||1!==a.length||m.hZb!==a[0]||m.Xrb!==h)return!1}else if(this.QEb.zXc(b)){if(h=this.Tcd.ga(b),!a||3!==a.length||h.b0g!==a[1]||h.h0g!==ta.a.fromCharCode(a[2]))return!1}else return!1;c.zc()}else if(0!==b)return!1;a=c.Af(1)}return!0}yXc(a){return this.QEb.yXc(a)}zXc(a){return this.QEb.zXc(a)}X5b(a){return this.QEb.X5b(a)}JTc(a){return this.QEb.JTc(a)}}
Object(n.a)(VK,"PptListMarkersLoader",null,[524,523]);class WK{LBl(a,b){if(!a)return!1;b.Bb(2);a=b.currentNode.sa(xc.a.F9b,!1);b.zc();return!a}}Object(n.a)(WK,"PptMergeListEditorInOutlineElementStrategy",null,[525]);class Mz{constructor(){this.Bki=[0,3,4,5,6,7,8,9];this.Rkk=[0,11,12,13,14,15,16,17]}yXc(a){return 3<=a&&9>=a}zXc(a){return 11<=a&&17>=a}X5b(a){return Mz.F5f(a,this.Bki,1)}JTc(a){return Mz.F5f(a,this.Rkk,2)}static F5f(a,b,c){return 0<=a&&a<b.length?b[a]:c}}Object(n.a)(Mz,"TextBulletTypeHelper",
null,[523]);class CD{get name(){return"PowerPointWebEditor.ListEditor"}$b(a){a.register(520,"PowerPointWebEditor.IPptListEditor").ma().oa(()=>new UK(a.resolve("Box4.List.IListReader"),a.resolve("Box4.IOutlineElementEditor"),a.resolve("Box4.IOutlineElementNavigator"),a.resolve("PowerPointWebEditor.IListInfoHelper"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("Box4.IOutlineElementReader"),a.resolve("PowerPointWebEditor.Graph.INotesReader"),a.resolve("PowerPointWebEditor.ListReader"),
a.resolve("PowerPointWebEditor.IPptListCore"),a.resolve("PowerPointWebEditor.IPPTTableStyleReader"),a.resolve("Box4.IFormattingEditor"),a.resolve("Box4.IParagraphEditor"),a.resolve("PowerPointWebEditor.IGraphUtils"),a.resolve("Box4.Graph.IGraphIteratorFactory"),a.resolve("PowerPointWebEditor.IShapeReader")));a.register(521,"Box4.List.IListEditor").ma().oa(()=>a.resolve("PowerPointWebEditor.IPptListEditor"));a.register(522,"PowerPointWebEditor.IPptListCore").ma().oa(()=>new TK(a.resolve("PowerPointWebEditor.ISlideReader"),
a.resolve("PowerPointWebEditor.Graph.INotesReader"),a.resolve("Box4.IOutlineElementReader"),a.resolve("PowerPointWebEditor.ListReader")));a.register(523,"PowerPointWebEditor.ITextBulletTypeHelper").ma().oa(()=>new Mz);a.register(524,"PowerPointWebEditor.IPptListMarkersLoader").ma().oa(()=>new VK(a.resolve("Box4.Graph.IGraphIteratorFactory"),a.resolve("PowerPointWebEditor.ITextBulletTypeHelper")));a.register(525,"Box4.IMergeListEditorInOutlineElementStrategy").ma().oa(()=>new WK)}init(){}dispose(){}static main(){r.a.instance.Dc(new CD)}}
Object(n.a)(CD,"PPTWebEditorListEditorPackage",null,[2,3]);var uQ=d(876);class XK{rk(a){return rd.TableReader.rk(a)}Ai(a){return rd.TableReader.Ai(a)}bTc(a,b,c){return rd.TableReader.bTc(a,b,c)}Cu(a){return rd.TableReader.Cu(a)}Vab(a){return rd.TableReader.Vab(a)}ys(a){return rd.TableReader.ys(a)}BN(a){return rd.TableReader.BN(a)}}Object(n.a)(XK,"TableReaderProxy",null,[1246]);class YK{uhg(){return gk.j(void 0)}ggj(a){return gk.c(a)}}Object(n.a)(YK,"TableRowReaderProxy",null,[1245]);class ZK extends wf.a{constructor(a,
b,c,h,m){super(a,b);this.kUh=m;this.CK=h;a=m&&this.gb.sa(jb.a.skippedCell,!1);b=this.Md.hp(wa.a.td);this.nc(b);a?this.htmlElement.className="SkippedGhostCell":(this.htmlElement.className=this.CK.kr?"GhostWithBorder":"Ghost",this.htmlElement.title=Box4Intl.Box4Strings.l_GhostCellTooltip);this.htmlElement.innerText="\u00a0";this.JMf()}IU(){return Ng.a.Kic}Dy(){this.kUh&&this.gb.sa(jb.a.skippedCell,!1)&&this.t9k()}t9k(){this.CK.kr&&(this.htmlElement.style.borderTop="",this.htmlElement.style.borderLeft=
"",this.htmlElement.style.borderBottom="",this.htmlElement.style.borderRight="")}}Object(n.a)(ZK,"GhostTableCellViewElement",wf.a,[1271,455,456,106]);class $K{constructor(a,b,c){this.DKd=a;this.CK=b;this.dnb=c}create(a,b){return Qe.isGhostCellNode(b.node)?Qe.shouldRenderGhostCellNode(b.node)?new ZK(a,b,this.DKd,this.CK,J.a.instance.ga(63),J.a.instance.ga(77)):null:this.dnb.create(a,b)}}Object(n.a)($K,"GhostTableCellViewElementFactory",null,[1174]);class aL{constructor(a,b,c){this.yc=a;this.Fea=b;
this.ZKg=c;this.QF=null;this.LBb=this.MBb=-1}U9k(a,b=null){this.W9k(a);this.QF&&this.t6k(b)}Asi(){this.QF=null;this.LBb=this.MBb=-1}BYf(a,b,c){if(!a||!this.QF)return{row:b,column:c};var h=this.Fea.LTf(a,this.QF,this.ZKg.$Hc,this.ZKg.ZHc);if(!h)return{row:b,column:c};let m=h.rowIndex;h=h.pi;m===b||this.Fea.JXc(a,this.QF)||(m=b);var y=0,G=this.yc.Ai(this.QF)-1;let U=0,ja=this.yc.rk(this.QF)-1;this.Fea.JXc(a,this.QF)&&b>=U&&b<=ja&&c>=y&&c<=G&&(a=(y=(y=this.QF.qf(b,c))?y.Ry():null)?y.rowSpan:0,G=y?y.colSpan:
0,y=c,G=c+G-1,U=b,ja=b+a-1);m>=U&&m<=ja&&h>=y&&h<=G&&(b=m,c=h);return{row:b,column:c}}Qik(a){a=this.r5f(a);return!!a&&14===a.type&&a.Lp()}rbi(a,b,c,h,m,y){if(!this.QF||!a||14!==a.type||this.QF!==a||!b)return{kWf:c,$Vf:h,uBh:m,rBh:y};this.QF.qf(c,h).isControllingCell&&({rowIndex:c,Oia:h}=this.Y8i(c,h));if(this.QF.qf(m,y).isControllingCell||!this.Fea.JXc(b,this.QF))({row:m,column:y}=this.BYf(b,m,y));Ba.a.J(41209862,816,50,"Drag to select table cells in complex table.");return{kWf:c,$Vf:h,uBh:m,rBh:y}}W9k(a){(a=
this.r5f(a))&&14===a.type&&(this.QF=a)}r5f(a){return 1074135132===a.Se&&a.ud?this.yc.FN(a):this.yc.T5b(a)}t6k(a){this.QF&&a&&({row:this.MBb,column:this.LBb}=this.BYf(a,this.MBb,this.LBb))}Y8i(a,b){if(!this.QF)return{rowIndex:a,Oia:b};let c=null;0<=a&&a<this.yc.rk(this.QF)&&0<=b&&b<this.yc.Ai(this.QF)&&(c=this.QF.qf(a,b));this.ZLj(c)&&(a=this.MBb,b=this.LBb);return{rowIndex:a,Oia:b}}ZLj(a){if(!this.QF)return!1;let b=0;var c=this.yc.Ai(this.QF)-1;let h=0;var m=this.yc.rk(this.QF)-1;if(a){m=a.rowIndex;
c=a.pi;const y=a.rowSpan;a=a.colSpan;b=c;c=c+a-1;h=m;m=m+y-1}return this.MBb>=h&&this.MBb<=m&&this.LBb>=b&&this.LBb<=c}}Object(n.a)(aL,"PptTableDragSelectionCellExtendStrategy",null,[489]);var bL=d(824),Sm=d(238);class cL{constructor(){this.jVc=this.colSpan=this.Bld=0}}Object(n.a)(cL,"HeightInfo",null,[]);class dL{constructor(){this.bQa=null;this.rowSpan=this.height=this.width=this.top=this.offsetTop=this.left=0;this.G9f=this.j$f=this.Zgg=this.ahg=this.$gg=!1}}Object(n.a)(dL,"TableCellInfo",null,
[]);class eL{constructor(){this.DNh=[]}get cells(){return this.DNh}VMd(a){this.cells.push(a)}}Object(n.a)(eL,"TableRowInfo",null,[]);class fL{constructor(){this.bQa=null;this.height=this.width=this.left=this.top=this.offsetTop=0;this.ngg=this.thg=this.sgg=!1}}Object(n.a)(fL,"UpdateInfo",null,[]);var vQ=d(1054),gL=d(551);class Gv extends gL.a{constructor(a,b,c,h,m,y,G,U,ja,va,Ta,fb,Db,gc){super(a,b,fb);this.DNa=!1;this.d3a=this.clf=this.wId=this.c3a=this.eGa=null;this.WEd=0;this.fpi=1;this.cpi=16;
this.Toi=256;this.Woi=4096;this.epi=65536;this.Gyc=this.$yc=this.jzc=this.szc=!1;this.r6e=this.Rnf=this.tCc=this.Mzc=this.Nga=0;this.hqe=this.iqe=null;this.y0h=Object(ua.a)(124,b);this.uba=c;this.Kba=gc;this.hd=Ta;this.RV=Db;this.CK=va;this.ADc=U;this.Fha=ja;this.Eha=G;this.pr=y;this.B5c=!!u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.ka("PPTOTableCellDiagonalBordersEnabled");a=this.Md.hp(wa.a.td);this.nc(a);this.kZ=this.Md.hp(wa.a.div);a.appendChild(this.kZ);this.kZ.className="TableCellContent";
this.Vo(this.kZ)}u4b(){return this.kZ.offsetHeight+this.kZ.offsetTop}Dtc(a,b,c,h){a=this.DNa?a:a+c;this.eGa||(this.eGa=this.EKc());this.eGa.style.left=a-2.5+"px";this.eGa.style.top=b+"px";this.eGa.style.height=h+"px"}LIf(){const a=this.Md.hp(wa.a.div);vf.c(a,!0);this.htmlElement.insertBefore(a,this.htmlElement.firstChild);return a}EKc(){const a=this.LIf();a.className="TableColumnResizeHandle";return a}WWd(){const a=this.Md.hp(wa.a.div);vf.c(a,!0);this.htmlElement.insertBefore(a,this.htmlElement.firstChild);
a.className=og.a.ZQk;return a}Cxl(a,b,c,h){h?(a=this.DNa?a:a+b,this.c3a||(this.c3a=this.rBi()),b=this.c3a.style,b.top=c+"px",b.left=a+"px"):this.c3a&&(this.aDf(this.c3a,!1),this.c3a=null);return this.c3a}rBi(){const a=this.WWd(),b=this.Md.hp(wa.a.div);vf.c(b,!0);b.className=og.a.$ce;a.appendChild(b);return a}bAl(a,b,c,h){this.tRi();const m=this.wId.style;m.top=c+"px";m.left=h+"px";c=this.clf.style;c.marginTop=b-2.5+"px";c.width=a+"px"}tRi(){if(!this.wId){const a=this.WWd(),b=this.Md.hp(wa.a.div);
vf.c(b,!0);b.className=og.a.xcg;a.appendChild(b);this.wId=a;this.clf=b}}fAl(a,b,c){c?(this.d3a||(this.d3a=this.kFi()),c=this.d3a.style,c.top=a+b-10+"px",this.DNa?c.right="-15px":c.left="-15px"):this.d3a&&(this.aDf(this.d3a,!0),this.d3a=null);return this.d3a}kFi(){const a=this.WWd(),b=this.Md.hp(wa.a.div);vf.c(b,!0);b.className=og.a.ade;a.appendChild(b);return a}Kgh(a){(a=this.htmlElement.querySelector("."+a))&&this.htmlElement.removeChild(a.parentNode)}aDf(a,b){b?Sm.a.Ori(a):Sm.a.Kri(a);this.htmlElement.removeChild(a)}fhg(a){a=
a?D.a.Pta:u.AFrameworkApplication.isRtl?D.a.L$a:D.a.NTa;return 8!==u.AFrameworkApplication.Ta.mi(md.a.create(this.gb),a,1,!0,new vQ.a,null)}IU(a){super.IU(a);const b=super.IU(a);this.WEd=this.ekj(a);if(this.Kba.ix&&!this.Qc.Vl){var c=Nf.a.nb(a.M1,a.currentNode);c.gf();this.Eha.Oe(c);a=this.ADc.getContainingTable(a);this.Fha.Wg(c)&&a&&!this.pr.lCa(a)&&(c=c.Tq)&&c.htmlElement&&this.uba.jHf(c.htmlElement,a,this.Ma)}return new Ng.a(b.Oma+this.Mzc+yn.a.Ckb,Math.max(b.minWidth,this.WEd),b.Pma+this.tCc+
yn.a.Ckb)}ekj(a){return rd.TableReader.Kyb(a)?(a=this.Kba.rje?this.gb.sa(Ie.a.YSd,1):1,a*yn.a.GZe+(a-1)*(this.Mzc+this.tCc+yn.a.Ckb)):yn.a.GZe}v6(a){this.kZ.style.paddingLeft=a.Oma-yn.a.Ckb+"px";this.kZ.style.paddingRight=a.Pma-yn.a.Ckb+"px";this.Kba.hZc&&this.Kba.rje&&(this.kZ.style.minWidth=this.WEd+"px")}Iaa(a){this.PD(this.kZ,a,1)}Dy(){this.yFh();this.Woh();var a=rb.GraphIterator.nb(this.gb);a.rc(14);const b=Gd.getContainingTable(a),c=Qe.isFirstCellInColumn(a);a=Qe.isFirstCellInRow(a);let h="";
c&&Gv.Fkg(b,32)&&(h="columnheader");a&&!c&&Gv.Fkg(b,128)&&(h="rowheader");""!==h?Wa.d(this.htmlElement,oa.a.role,h):this.htmlElement.removeAttribute(zc.a.af);this.hd&&this.hd.WEa(65)&&(this.gb.$_b?Sys.UI.DomElement.addCssClass(this.htmlElement,Qb.G3):Sys.UI.DomElement.removeCssClass(this.htmlElement,Qb.G3));this.CK.kr&&(this.htmlElement.style.border="",this.wXk(),this.V4k(b),this.htmlElement.style.verticalAlign=this.CK.kr.q3i(this.gb));this.P8k();this.Kba.hZc&&this.Kba.rje&&(this.gb.Sa(Ie.a.PBf)?
this.Kqh():this.htmlElement.removeAttribute("rowspan"),this.gb.Sa(Ie.a.YSd)?this.aph():this.htmlElement.removeAttribute("colspan"));this.Qc.Vl&&this.Kba.QTj&&(this.htmlElement.style.width=this.Md.Ld.Me(this.y0h.width,0)+"px")}P8k(){if(this.Kba.wQj||this.Kba.XVj)this.gb.Hae?this.Kqh():this.htmlElement.removeAttribute("rowspan"),this.gb.g$a?this.aph():this.htmlElement.removeAttribute("colspan")}yFh(){let a=null;if(this.hd&&this.hd.WEa(65)){var b=rb.GraphIterator.nb(this.gb);b.rc(15);b=b.Mw(15);if(b.Vsc){Sys.UI.DomElement.addCssClass(this.htmlElement,
Qb.Xzh);return}if(b.fsd){Sys.UI.DomElement.addCssClass(this.htmlElement,Qb.$zh);return}}this.gb.Sa(kb.a.wIc)?(a=hb.a.oI(this.gb.sa(kb.a.wIc,hb.a.nil)),this.Nga|=this.epi):this.Kba.tTj&&this.CK.kr&&(a=this.CK.kr.oYf(this.gb));a=a||"transparent";this.htmlElement.style.backgroundColor=a;"transparent"!==a&&4.5>hb.a.i4i(a)?this.htmlElement.className="LowContrastShading":this.htmlElement.className=this.htmlElement.className.replace("LowContrastShading","");this.hd&&this.hd.WEa(65)&&(Sys.UI.DomElement.removeCssClass(this.htmlElement,
Qb.Xzh),Sys.UI.DomElement.removeCssClass(this.htmlElement,Qb.$zh))}Kqh(){Wa.d(this.htmlElement,oa.a.rowSpan,this.Kba.hZc?this.gb.sa(Ie.a.PBf,1):this.gb.rowSpan)}aph(){Wa.d(this.htmlElement,oa.a.colSpan,this.Kba.hZc?this.gb.sa(Ie.a.YSd,1):this.gb.colSpan)}wXk(){this.Gyc=this.jzc=this.$yc=this.szc=!1}V4k(a){this.CK.kr&&(this.W6k(),this.htmlElement.style.border="0px none",this.RKb(this.gb,a,7),this.RKb(this.gb,a,5),this.RKb(this.gb,a,0),this.RKb(this.gb,a,6),this.B5c&&(this.RKb(this.gb,a,2),this.RKb(this.gb,
a,1)),Wa.d(this.htmlElement,oa.a.bYd,this.Nga),this.CVk())}Woh(){var a=new rb.GraphIterator;a.set(this.gb);a.rc(14);a.Ng(14);a=a.currentNode;this.Mzc=yn.a.ETc(this.gb,a,jb.a.bNb,this.CK.kr,jb.a.lol,0);this.tCc=yn.a.ETc(this.gb,a,jb.a.dNb,this.CK.kr,jb.a.mol,0);this.Rnf=yn.a.ETc(this.gb,a,jb.a.eNb,this.CK.kr,jb.a.nol,1);this.r6e=yn.a.ETc(this.gb,a,jb.a.aNb,this.CK.kr,jb.a.hol,1);this.kZ.style.paddingLeft=this.Mzc+"px";this.kZ.style.paddingRight=this.tCc+"px";this.kZ.style.paddingTop=this.Rnf+"px";
this.kZ.style.paddingBottom=this.r6e+"px"}W6k(){var a=rb.GraphIterator.nb(this.gb);a.rc(14);a=this.ADc.getContainingTable(a);this.DNa=rd.TableReader.um(a)}RKb(a,b,c){this.RV&&this.RV.IIj(b);a=this.CK.kr.B7i(a,c);b=a.Qhi;const h=a.voj;if(""!==b)switch(""!==h&&Sys.UI.DomElement.addCssClass(this.htmlElement,h),c){case 7:this.htmlElement.style.borderTop=b;this.HYc(b)&&(this.szc=!0);a.yMc&&(this.Nga|=this.fpi);break;case 5:this.Roh(5,b);this.HYc(b)&&(this.$yc=!0);a.yMc&&(this.Nga|=this.Woi);break;case 0:this.htmlElement.style.borderBottom=
b;this.HYc(b)&&(this.Gyc=!0);a.yMc&&(this.Nga|=this.Toi);break;case 6:this.Roh(6,b);this.HYc(b)&&(this.jzc=!0);a.yMc&&(this.Nga|=this.cpi);break;case 2:this.iqe=b;break;case 1:this.hqe=b}}HYc(a){return!a||a.startsWith("0px none")?!1:!0}Roh(a,b){if(5===a&&!this.DNa||6===a&&this.DNa)this.htmlElement.style.borderLeft=b;if(5===a&&this.DNa||6===a&&!this.DNa)this.htmlElement.style.borderRight=b}CVk(){if(this.Pdl()){var a=rb.GraphIterator.nb(this.gb);if(a.rc(14)){var b=Qe.isFirstCellInRow(a),c=Qe.isLastCellInRow(a);
this.szc||(this.htmlElement.style.borderTop="solid 1px #c8cacc",this.szc=!0);this.Gyc||(this.htmlElement.style.borderBottom="solid 1px #c8cacc",this.Gyc=!0);b=b?"solid 1px #c8cacc":"dashed 1px #c8cacc";c=c?"solid 1px #c8cacc":"dashed 1px #c8cacc";a=a.Mw(14);a=!rd.TableReader.um(a);this.$yc||(this.htmlElement.style.borderLeft=a?b:c,this.$yc=!0);this.jzc||(this.htmlElement.style.borderRight=a?c:b,this.jzc=!0)}}}Pdl(){const a=this.Qc;return a.Mh&&a.features.Xdl?!0:!1}get Sia(){return this.kZ}$J(a){super.$J(a);
this.vU()}vU(){if(!this.Md.Vl&&this.YA){const a=Object(ua.a)(453,this.BR);a&&a.yXg(this.kZ)}}get Xsb(){return this.eGa}static Fkg(a,b){return null!==a&&a.Sa(jb.a.tableLook)?!!(a.properties.eb(jb.a.tableLook)&b):!1}}Object(n.a)(Gv,"TableCellViewElement",gL.a,[475,455,456,106]);class cm extends wf.a{constructor(a,b,c,h=null){super(a,b);this.WR=null;this.pvc=!0;this.Fm=[];this.$u=[];this.mEc=this.uG=null;this.C7e=this.blf=0;cm.hVa=c;this.RV=h;b=this.Md.hp(wa.a.div);b.className="TableContainer";this.Zj=
this.Md.hp(wa.a.table);b.appendChild(this.Zj);this.Zj.className="Table";Sys.UI.DomElement.addCssClass(this.Zj,cm.Rqd);this.Lof=a;this.dBa=this.Md.hp(wa.a.div);this.dBa.id=pa.a.create().toString();this.dBa.className=cm.Rnl;this.dBa.setAttribute(zc.a.JK,zc.a.XB);b.insertBefore(this.dBa,this.Zj);vf.c(this.dBa,!0);a.Vl&&Wa.d(this.Zj,oa.a.border,this.gb.sa(kb.a.Bkb,!0)?"1":"0");this.nc(b);a.Vl||(this.WR=this.Md.hp(wa.a.Rti),this.Zj.appendChild(this.WR));this.tS=this.Md.hp(wa.a.oAh);this.Zj.appendChild(this.tS);
this.Vo(this.Zj)}get u1(){return this.tS}get table(){return this.Zj}get AJc(){return this.WR}Dy(a){this.Zj.style.borderCollapse="collapse";if(Ya.StyleReader.kr)Sys.UI.DomElement.removeCssClass(this.Zj,cm.Rqd),Sys.UI.DomElement.removeCssClass(this.Zj,cm.JZe);else{var b=this.gb.sa(kb.a.Bkb,!0);b&&!this.pvc?(Sys.UI.DomElement.removeCssClass(this.Zj,cm.JZe),Sys.UI.DomElement.addCssClass(this.Zj,cm.Rqd),this.pvc=!0):!b&&this.pvc&&(Sys.UI.DomElement.removeCssClass(this.Zj,cm.Rqd),Sys.UI.DomElement.addCssClass(this.Zj,
cm.JZe),this.pvc=!1)}J.a.instance.ga(71)&&Ya.StyleReader.kr&&(Wa.d(this.Zj,oa.a.dYd,"Custom"),Wa.d(this.Zj,oa.a.cYd,0));var c=this.WR?rd.TableReader.Ai(this.gb):0;b=this.WR?c-this.WR.childNodes.length:0;for(var h=0;h<b;++h){var m=this.Md.hp(wa.a.col);this.WR.appendChild(m)}for(h=0;h>b;--h)this.WR.removeChild(this.WR.firstChild);h=xn.b(this.gb);var y=0;this.RV&&(y=this.RV.e8d(this.gb));m=Array(c);var G=!0;b=0;for(var U=0;U<c;++U){let ja=this.w8(U);0<=h[U]?(m[U]=Math.max(ja,this.Md.Ld.Me(h[U],0)-y),
this.WR.childNodes[U].style.width=m[U]+"px",b+=m[U]):(m[U]=-1,G=!1,this.WR.childNodes[U].style.width="",b+=ja)}if(J.a.instance.ga(63)||J.a.instance.ga(77))G?Sys.UI.DomElement.addCssClass(this.Zj,cm.kJh):Sys.UI.DomElement.removeCssClass(this.Zj,cm.kJh);if(this.Fm.length===c)for(y=this.KQc(),G=0;G<c;++G)U=this.w8(G),this.Fm[G].childNodes[y].style.width=0<=h[G]?Math.max(U,m[G])+"px":U+"px";c=rd.TableReader.um(this.gb);if(this.gb.Sa(kb.a.Il))switch(rd.TableReader.BN(this.gb)){case 1:this.Zj.style.marginLeft=
"";this.Zj.style.marginRight="auto";break;case 2:this.Zj.style.marginLeft="auto";this.Zj.style.marginRight="auto";break;case 3:this.Zj.style.marginLeft="auto";this.Zj.style.marginRight="";break;case 14:this.Zj.style.marginLeft=c?"auto":"";this.Zj.style.marginRight=c?"":"auto";break;case 15:this.Zj.style.marginLeft=c?"":"auto";this.Zj.style.marginRight=c?"auto":"";break;default:this.Zj.style.marginLeft="",this.Zj.style.marginRight=""}else this.Zj.style.marginLeft="",this.Zj.style.marginRight="",J.a.instance.ga(63)&&
this.gb.Sa(jb.a.Zl)&&(h=({Vf:a}=rd.TableReader.Mja(a)).returnValue,a=(new lv.a(a,h)).ROb+"px",c?this.Zj.style.marginRight=a:this.Zj.style.marginLeft=a);(J.a.instance.ga(71)||J.a.instance.ga(77))&&this.S9k(Ya.StyleReader.kr,this.gb,this.Zj);this.gb.properties.sa(kb.a.Weg,!1)?(Sys.UI.DomElement.addCssClass(this.Zj,cm.zFf),Wa.d(this.Zj,oa.a.Uei,"conflictSRDescription")):(Sys.UI.DomElement.removeCssClass(this.Zj,cm.zFf),this.Zj.removeAttribute(zc.a.tra));(a=rd.TableReader.o9d(this.gb))&&this.Zj.setAttribute("title",
a);(a=rd.TableReader.n9d(this.gb))?this.Lof.Vl&&1===this.Lof.mode?this.Zj.removeAttribute(zc.a.tra):(this.dBa.innerText=a,this.Zj.setAttribute(zc.a.tra,this.dBa.id)):(this.dBa.innerText="",this.Zj.removeAttribute(zc.a.tra));Lc.a.instance.Uj&&!J.a.instance.ga(30)&&(this.Zj.style.width="0px");J.a.instance.ga(30)&&(this.Zj.style.minWidth=b+"px");this.Z4k();this.X9k()}Z4k(){if(this.RV){const a=this.RV.nIl(this.gb);""!==a&&(this.Zj.style["border-spacing"]=a);this.nhe&&(this.Zj.style.borderCollapse="separate")}}get nhe(){return!!this.RV&&
this.RV.IIj(this.gb)}x4d(a){return this.RV?this.RV.CHl(this.gb,a):0}X9k(){this.Zj.style.borderTop="";this.Zj.style.borderBottom="";this.Zj.style.borderLeft="";this.Zj.style.borderRight=""}w8(a){return(Ya.StyleReader.kr?Ya.StyleReader.kr.w8(this.gb,a):yn.a.Uqd)+(this.RV?this.RV.e8d(this.gb):0)}S9k(a,b,c){a&&(c.style.background=a.lkj(b))}Iaa(a){this.PD(this.htmlElement,a,88);1<this.htmlElement.children.length&&this.htmlElement.firstChild===this.Zj&&(this.wnc(this.htmlElement,this.Zj),this.htmlElement.appendChild(this.Zj));
this.PD(this.tS,a,1);let b=!1;this.tS.firstChild!==this.uG&&(this.uG=this.tS.firstChild,b=!0);J.a.instance.ga(30)&&rd.TableReader.Cu(a.currentNode)||!this.WR||(u.AFrameworkApplication.fa.ka("IsComplexTableColumnSelectionHandleFixEnabled")?(a=!1,(this.Fm&&this.Fm.length?this.Fm[0].parentNode:null)!==(this.uG?this.uG.firstChild:null)&&(a=!0),this.Eih(b||a)):this.tVk(b),Sm.a.yv||this.CPe(b))}KQc(){let a=1;(J.a.instance.ga(63)||J.a.instance.ga(30))&&rd.TableReader.Cu(this.gb)&&(a=0);return a}dispose(){J.a.instance.ga(50)&&
Fc.App.Ih&&Fc.App.Ih.lw&&this.Ggh();this.$u=this.Fm=this.Zj=this.tS=this.WR=this.dBa=this.uG=null;super.dispose()}IU(a){var b=xn.b(this.gb),c=null;if(a.Bb(1)){do{var h=a.Tq.WKa;c=c?vv.nui(c,h):h.copy()}while(a.Cj(1))}c||(c=new vv(b.length));for(h=0;h<b.length;h++)-1<b[h]&&c.$oh(h,Math.max(c.r4i(h),this.Md.Ld.Me(b[h],0)));b=yn.a.Ckb;c=new Ng.a(b,Math.max(0,c.Sgk()-2*b),b);b=new rb.GraphIterator;b.set(this.gb);h=!1;b.rc(16)&&(h=!0);c=h?new Ng.a(0,c.total,0):new Ng.a(c.Oma,c.minWidth,c.Pma);a.Bb(88)&&
(c=Ng.a.max(c,a.Tq.WKa),a.zc());return c}YFj(){this.Ggh();this.Fm=[];this.$u=[]}Ggh(){if(this.$u)for(var a=0;a<this.$u.length;++a)Y.a.VJa(this.$u[a]),La.a.XO(this.$u[a]);if(this.Fm)for(a=0;a<this.Fm.length;++a)Y.a.VJa(this.Fm[a]),this.$u&&this.$u[a]&&this.$u[a].parentNode&&La.a.XO(this.Fm[a])}Eih(a){if(this.Fm&&this.uG&&this.uG.firstChild){var b=v.a.hx||v.a.to?"":" 16 20",c=String.format("url('{0}'){1}, pointer",ty.a.box4Image("ColumnSelect.cur"),b);b=xn.b(this.gb);var h=b.length,m=this.uG.firstChild;
if(a){a=Math.min(h,this.Fm.length);for(var y=0;y<a;y++)m.insertBefore(this.Fm[y],m.firstChild)}if(h>this.Fm.length)for(a=this.Fm.length;a<h;a++){y=this.Md.createElement("div");y.className="TableColumnHandleAnchor";vf.c(y,!0);Array.add(this.Fm,y);var G=this.Md.createElement("div");G.className=Sm.a.IZe;G.style.cursor=c;y.appendChild(G);G=this.Md.createElement("div");G.className="TableColumnWidthSpacer";y.appendChild(G);m.insertBefore(this.Fm[a],m.firstChild)}if(h<this.Fm.length){for(c=h;c<this.Fm.length;c++)Y.a.VJa(this.Fm[c]),
La.a.XO(this.Fm[c]);c=[];for(m=0;m<h;m++)Array.add(c,this.Fm[m]);this.Fm=c}c=this.KQc();m=0;for(a=0;a<h;a++)y=this.w8(a),y=Math.max(y,this.Md.Ld.Me(b[a],0)),this.Fm[a].childNodes[c].style.width=y+"px",this.Fm[a].style.left=m+"px",this.Fm[a].setAttribute("ColumnIndex",a.toString()),m+=y}}tVk(a){var b=v.a.hx||v.a.to?"":" 16 20";b=String.format("url('{0}'){1}, pointer",ty.a.box4Image("ColumnSelect.cur"),b);if(a){a=this.uG.firstChild;var c=Math.min(this.uG.childNodes.length,this.Fm.length);for(var h=
0;h<c;++h)a.insertBefore(this.Fm[h],a.firstChild),a=a.nextSibling}a=this.uG.childNodes.length;if(a>this.Fm.length){c=this.uG.firstChild;for(h=0;h<this.Fm.length;++h)c.insertBefore(this.Fm[h],c.firstChild),c=c.nextSibling;for(h=this.Fm.length;h<a;++h){const y=this.Md.createElement("div");y.className="TableColumnHandleAnchor";vf.c(y,!0);Array.add(this.Fm,y);var m=this.Md.createElement("div");m.className=Sm.a.IZe;m.style.cursor=b;y.appendChild(m);m=this.Md.createElement("div");m.className="TableColumnWidthSpacer";
y.appendChild(m);c.insertBefore(y,c.firstChild);c=c.nextSibling}}else if(a<this.Fm.length){for(b=a;b<this.Fm.length;++b)Y.a.VJa(this.Fm[b]),La.a.XO(this.Fm[b]);b=[];for(c=0;c<a;++c)Array.add(b,this.Fm[c]);this.Fm=b;b=this.uG.firstChild;for(a=0;a<this.Fm.length;++a)b.insertBefore(this.Fm[a],b.firstChild),b=b.nextSibling}b=this.KQc();a=xn.b(this.gb);for(c=0;c<this.Fm.length;++c)h=this.w8(c),this.Fm[c].childNodes[b].style.width=0<=a[c]?Math.max(h,this.Md.Ld.Me(a[c],0))+"px":h+"px"}CPe(a){if(!this.$u.length){a=
this.Md.createElement("div");a.innerText="\u00a0";a.className="TableLastResizeAnchor";var b=this.Md.createElement("div");b.className=Sm.a.Yqd+" Last";a.appendChild(b);Array.add(this.$u,a);vf.c(a,!0);a=!0}if(a){a=Math.min(this.$u.length,this.uG.childNodes.length);for(b=1;b<a;++b){var c=this.uG.childNodes[b];c.insertBefore(this.$u[b],c.firstChild)}(a=this.uG.lastChild)?a.insertBefore(this.$u[0],a.firstChild):ba.ULS.sendTraceTag(38285521,324,15,"Table first row has no child")}a=this.uG.childNodes.length;
if(a>this.$u.length){for(b=1;b<this.$u.length;++b)c=this.uG.childNodes[b],c.insertBefore(this.$u[b],c.firstChild);for(b=this.$u.length;b<a;++b){c=this.Md.createElement("div");c.className=Sm.a.Yqd;vf.c(c,!0);Array.add(this.$u,c);let h=this.uG.childNodes[b];h.insertBefore(c,h.firstChild)}a=this.uG.lastChild;a.insertBefore(this.$u[0],a.firstChild)}else if(a<this.$u.length){for(b=a;b<this.$u.length;++b)Y.a.VJa(this.$u[b]),La.a.XO(this.$u[b]);b=[];for(c=0;c<a;++c)Array.add(b,this.$u[c]);this.$u=b;for(a=
1;a<this.$u.length;++a)b=this.uG.childNodes[a],b.insertBefore(this.$u[a],b.firstChild);(a=this.uG.lastChild)?a.insertBefore(this.$u[0],a.firstChild):ba.ULS.sendTraceTag(38285522,324,15,"Table first row has no child")}}jSe(a,b){let c=-1;if(rd.TableReader.um(this.gb))if(b<=Sys.UI.DomElement.getLocation(this.tS.firstChild.lastChild).x)c=this.tS.firstChild.childNodes.length-1;else for(var h=0;h<this.tS.firstChild.childNodes.length;++h){var m=Sys.UI.DomElement.getLocation(this.tS.firstChild.childNodes[h]);
if(b>=m.x){c=h;break}}else if(b<=Sys.UI.DomElement.getLocation(this.tS.firstChild.firstChild).x)c=0;else for(h=this.tS.firstChild.childNodes.length-1;0<=h;--h)if(m=Sys.UI.DomElement.getLocation(this.tS.firstChild.childNodes[h]),b>=m.x){c=h;break}c<a&&(b=c,c=a,a=b);h=[];m=rb.GraphIterator.nb(this.gb);const y=new rb.GraphIterator;b=new t.GraphTransaction(2);b.yy(m);Gd.moveToFirstRow(m);Gd.moveToColumnByIndex(m,a);y.Rc(m);Gd.moveToColumnByIndex(y,c);do(a=yd.SelectionFactory.fLc(m,y))&&Array.add(h,a),
Gd.moveToNextRow(y);while(Gd.moveToNextRow(m));a=new Ha.SelectionCollection(h,h.length-1,0);this.Qc.Lb.ME(a);b.dispose()}Hpc(a,b){const c=this.KQc();this.Fm&&a<this.Fm.length&&this.Fm[a]&&(this.Fm[a].childNodes[c].style.width=Math.max(this.w8(a),b)+"px");this.WR.childNodes[a].style.width=Math.max(1,b)+"px"}S5i(a){return this.tS.firstChild.childNodes[a]?this.tS.firstChild.childNodes[a].offsetWidth:(ba.ULS.sendTraceTag(36726402,341,10,"Column {0} does not exist in first row of table. Table Rows: {1} | First row view cells {2}",
a,this.tS.childNodes.length,this.tS.firstChild.childNodes.length),0)}RQc(a){a=parseInt(this.WR.childNodes[a].style.width);return isNaN(a)?yn.a.GZe:a}v6(a){super.v6(a);J.a.instance.ga(63)&&this.dAl();this.o3e()}o3e(){this.mEc||(this.mEc=new He.a(3,1,0,Object(F.a)(this,this.updateTableDOMElements,"updateTableDOMElements"),119),u.AFrameworkApplication.we.Eb(this.mEc))}updateTableDOMElements(){this.mEc=null;this.u1&&(J.a.instance.ga(63)?this.XFk(this.aMk()):Sm.a.yv&&this.YKe(this.h8d()),u.AFrameworkApplication.fa.ka("IsComplexTableColumnSelectionHandleFixEnabled")&&
this.Eih(!1))}qtd(){this.MVk()}r3i(a){return a.offsetWidth+this.x4d(0)/2}h8d(){const a=this.PSa(),b=a.length,c=[];let h=0,m=!1;const y=rd.TableReader.Cu(this.gb);for(let U=0;U<b;U++){const ja=a[U];if(y){let Ta;({Dld:Ta}=this.Asd(ja)).returnValue&&(m=gk.f(Ta.gb))}const va=ja.childNodes;for(let Ta=0;Ta<va.length;Ta++){var G=va[Ta];if(void 0!==G.colSpan&&null!==G.colSpan&&void 0!==G.rowSpan&&null!==G.rowSpan){let fb;({$Sd:fb}=this.f1e(G)).returnValue&&(G=Object.assign(new fL,{bQa:fb,left:G.offsetLeft,
top:this.nhe?ja.offsetTop:h,width:this.r3i(G),height:G.offsetHeight,sgg:!U,thg:U+G.rowSpan===b,ngg:!m&&!Ta}),c.push(G))}}h+=ja.offsetHeight}return c}dAl(){if(this.u1){var a=new rb.GraphIterator;a.set(this.gb);if(rd.TableReader.UFf(a)&&this.WR){a=this.WR.childNodes.length;var b=Array(a),c=[],h=this.PSa(),m=h.length,y=0;for(let G=0;G<m;G++){let U=0;const ja=h[G],va=ja.childNodes;let Ta=0;for(let fb=0;fb<a;fb++){let Db;if(b[fb]){let gc;(gc=b[fb]).jVc=gc.jVc-y;let hc;(hc=b[fb]).Bld=hc.Bld-1;Db=b[fb].colSpan;
1===b[fb].Bld&&(U=Math.max(U,b[fb].jVc),b[fb]=null)}else{const gc=va[Ta];Ta++;if(!gc)continue;let hc=0,Gc;({$Sd:Gc}=this.f1e(gc)).returnValue&&(hc=Gc.u4b());Db=gc.colSpan;1<gc.rowSpan?b[fb]=Object.assign(new cL,{colSpan:gc.colSpan,jVc:hc,Bld:gc.rowSpan}):U=Math.max(U,hc)}fb+=Db-1}({Dld:y}=this.Asd(ja)).returnValue?(y.X4k(U)&&c.push(y),y=y.Blh):y=0}for(const G of c)G.cAl()}}}MVk(){const a=this.PSa();if(Fc.App.instance.gYc&&a.length&&!(a.length<=this.blf&&a[0].childNodes.length===this.C7e)){this.blf=
a.length;this.C7e=a[0].childNodes.length;var b;for(let c=0;c<a.length;c++)!La.a.Pca(a[c].firstChild,"DragHandle")&&({Dld:b}=this.Asd(a[c])).returnValue&&b.vVk()}}Meg(a,b){b=a.querySelector("."+b);return!!b&&b.parentNode.parentNode===a}YKe(a){if(a)for(const b of a)b.bQa.Dtc(b.left,b.top,b.width,b.height,b.sgg,b.thg,b.ngg)}PSa(){return this.u1.children}f1e(a){let b;b=null;a&&(a=vf.a(a),b=Object(ua.a)(Gv,a));return{returnValue:!!b,$Sd:b}}Asd(a){let b;b=null;a&&(a=vf.a(a),b=Object(ua.a)(Zt,a));return{returnValue:!!b,
Dld:b}}aMk(){let a=0;const b=rd.TableReader.Cu(this.gb),c=this.nhe,h=this.PSa(),m=[];let y=!1;for(let U=0,ja=h.length;U<ja;U++){const va=h[U];if(!va)continue;if(b){let gc;({Dld:gc}=this.Asd(va)).returnValue&&(y=gk.f(gc.gb))}const Ta=new eL,fb=!U,Db=va.childNodes;for(let gc=0,hc=Db.length;gc<hc;gc++){var G=Db[gc];let Gc;if(({$Sd:Gc}=this.f1e(G)).returnValue){const Pc=G.offsetTop,yc=G.rowSpan,Vd=!gc;G=Object.assign(new dL,{bQa:Gc,left:G.offsetLeft,offsetTop:Pc,top:c?Pc:a,width:G.offsetWidth,height:G.offsetHeight,
rowSpan:yc,$gg:fb,ahg:U+yc===ja,Zgg:!y&&Vd,j$f:!Vd&&this.Meg(G,og.a.ade),G9f:!fb&&this.Meg(G,og.a.$ce)});Ta.VMd(G)}}a+=va.offsetHeight;m.push(Ta)}return m}XFk(a){if(a.length){var b=this.x4d(1)/2,c=this.x4d(0)/2,h=a[0].cells[0].bQa,m=h.fhg(!1);h=h.fhg(!0);var y=[];for(var G of a[0].cells){var U=G.bQa.Cxl(G.left,G.width+c,G.offsetTop,m);U&&y.push(U)}Sm.a.HOk(y);m=[];for(G=0;G<a.length;G++)y=a[G].cells[0],(U=y.bQa.fAl(y.height+b,y.offsetTop,h))&&m.push(U),1<y.rowSpan&&(G+=y.rowSpan-1);Sm.a.wQk(m);for(const ja of a)for(const va of ja.cells)a=
va.bQa,h=va.width,m=va.height,a.bAl(h,m+b,va.offsetTop,va.left),a.Dtc(va.left,va.top,h+c,m,va.$gg,va.ahg,va.Zgg),va.j$f&&a.Kgh(og.a.ade),va.G9f&&a.Kgh(og.a.$ce)}}}cm.Rqd="Border";cm.JZe="NoBorder";cm.zFf="Conflict";cm.kJh="TableWordWrap";cm.Rnl="WACAltTextDescribedBy";cm.hVa=null;Object(n.a)(cm,"TableViewElement",wf.a,[1239,455,456,106]);class Hv extends Zt{constructor(a,b,c){super(a,b,c,null,null)}yLb(a){this.htmlElement.style.height=a+"px"}get Alh(){return this.Md.Ld.Me(this.gb.sa(X.a.mu,0),1)+
"px"}static w6f(a){a=vf.a(a);let b=null;a&&(b=Object(ua.a)(Hv,a));return b}}Object(n.a)(Hv,"TableRowViewElement",Zt,[]);class Lx{constructor(a,b,c=!1){this.Qhi=a;this.voj=b;this.yMc=c}}Object(n.a)(Lx,"TableBorderProperty",null,[]);var wl=d(496);class Fp{constructor(a,b,c,h,m){this.u9=a;this.jc=c;this.Pb=b;this.NEb=h;this.k8j=m}oej(a){switch(a){case 0:a=jb.a.aNb;break;case 1:a=jb.a.bNb;break;case 2:a=jb.a.dNb;break;case 3:a=jb.a.eNb;break;default:a=null}return{returnValue:!!a,ifk:a}}ata(a,b){let c=
0;if(!a)return c;let h;({ifk:h}=this.oej(b)).returnValue&&(c=3===b||0===b?a.sa(h,.1):a.sa(h,Fp.mCk));return c}pAf(a){return.0555555555555556+this.ata(a,1)+this.ata(a,2)}pSd(a,b){const c=rd.TableReader.rk(a);if(0>b||b>=c)return.0555555555555556;a=this.Pb.Nc(a).Zp(b,1);return this.bIc(a)}bIc(a){let b=.0555555555555556;a=this.Pb.Nc(a);a.Bb(1);do{const c=a.currentNode;b=Math.max(b,.0555555555555556+this.ata(c,0)+this.ata(c,3))}while(a.Af(1));return b}gsb(a,b){var c=rd.TableReader.Ai(a);if(0>b||b>=c)return.0555555555555556;
c=.0555555555555556;a=this.Pb.Nc(a);a.Bb(1);do{const h=a.Zp(b,1);c=Math.max(c,this.pAf(h));a.zc()}while(a.Af(1));return c}F5d(a){return a&&a.tblBgField&&a.tblBgField.fillField&&(a.tblBgField.fillField.solidFillField||a.tblBgField.fillField.gradFillField)?a.tblBgField.fillField:wl.a.Otb}p9d(a,b){let c=b;if(this.k8j&&b&&b.cellShading){let h;({Vka:h}=this.k1e(a,b.cellShading)).returnValue&&(b=Object(ua.a)(115,this.jc.mg(b)),c=this.NEb.Ekh(a,b?b.Ne:null,h))}return c}o4b(a,b){let c=wl.a.Ntb;const h=Fp.LSa(b);
h.returnValue&&(a=this.p9d(b,a),a.Sa(h.OPa)&&(c=a.eb(h.OPa)));return c}C3d(a,b,c){if(c&&c.lD===hb.a.auto)return Gk.a.none;a=this.g6i(a);b=this.p4d(b);c=c.jV();return String.format("{0} {1}px {2}",a,b,c)}p4d(a){a=this.u9.Me(a,0);v.a.zua&&0<a&&1>a&&(a=1);return a}Crb(a,b,c=!1){let h=hb.a.SQa.jV();if(a.solidFillField){var m=Uf.Box4ColorHelper.LJ(Uf.Box4ColorHelper.Doa(a.solidFillField),b);c&&(m.r=m.g=m.b=255);h=m.jV()}else if(a.gradFillField){a=To.f(a.gradFillField,b);if(c)for(m of a.stops)m.color.r=
m.color.g=m.color.b=255;h=a.jV()}return h}Wnj(a){const b=a.currentNode.pi;a.zc();const c=a.FF(1);a.Zp(b,1);return c?a.currentNode:null}aoj(a){return a.FF(1)}k1e(a,b){switch(a){case 7:a=b.lnTField;break;case 0:a=b.lnBField;break;case 5:a=b.lnLField;break;case 6:a=b.lnRField;break;default:a=null}return{returnValue:!!a,Vka:a}}g6i(a){switch(a){case 2:case 3:case 4:case 5:case 6:case 7:case 9:case 10:return"dashed";case 1:case 8:return"dotted";default:return"solid"}}static LSa(a){let b,c;switch(a){case 7:a=
X.a.Qya;b=X.a.lLa;c=X.a.vnl;break;case 0:a=X.a.iga;b=X.a.gga;c=X.a.qnl;break;case 5:a=X.a.Pya;b=X.a.kLa;c=X.a.tnl;break;case 6:a=X.a.jga;b=X.a.hga;c=X.a.unl;break;case 2:a=X.a.Akb;b=X.a.ykb;c=X.a.snl;break;case 1:a=X.a.zkb;b=X.a.xkb;c=X.a.rnl;break;default:c=b=a=null}return{returnValue:!!a,OPa:a,i6a:b,Mrb:c}}}Fp.mCk=.2;Object(n.a)(Fp,"TableStyleReaderHelper",null,[452]);class DD{constructor(a,b,c=-1){this.YX=a;this.prg=b;this.xyg=c}}Object(n.a)(DD,"TableStyle",null,[]);var fr=d(327);class Nz{constructor(a,
b,c,h,m,y,G,U,ja,va,Ta,fb,Db,gc,hc,Gc,Pc,yc,Vd,De,Wd,Ve){this.YX=new Nd.a;this.cad=new Nd.a;this.bad=new Nd.a;this.X$c=new Nd.a;this.PZe=[];this.Pb=a;this.oH=c;this.jc=b;this.Uk=h;this.u9=m;this.C0=y;this.iIa=G;this.qc=U;this.CAe=ja;this.Wck=va;this.Rck=Ta;this.Ick=fb;this.yc=Db;this.MXa=gc;this.rJ=hc;this.No=Gc;this.Lq=Pc;this.adb=yc;this.t6c=Vd;this.vCb=De;this.RGa=Wd;this.JWa=Ve;this.iIa.kia(Object(F.a)(this,this.nfd,"onTableConnectedOrDisconnected"));this.iIa.y7(Object(F.a)(this,this.nfd,"onTableConnectedOrDisconnected"));
this.iIa.ik(Object(F.a)(this,this.x6g,"onTablePropertyChanged"));this.Lq.B9h(Object(F.a)(this,this.y4g,"onPageViewBeforeValidate"))}dispose(){this.iIa.Vna(Object(F.a)(this,this.nfd,"onTableConnectedOrDisconnected"));this.iIa.$Ja(Object(F.a)(this,this.nfd,"onTableConnectedOrDisconnected"));this.iIa.Cm(Object(F.a)(this,this.x6g,"onTablePropertyChanged"));this.Lq.$Tk(Object(F.a)(this,this.y4g,"onPageViewBeforeValidate"))}nYf(a){if(!a||!a.length)return null;const b=this.IQc(Object(ua.a)($f.a,a[0]));if(!b)return null;
for(let c=1;c<a.length;c++){const h=this.IQc(Object(ua.a)($f.a,a[c]));if(!h||h.lD!==b.lD)return null}return b}b9d(a){let b=null;if(a=this.U5b(a))b=new jq.a,b.te(X.a.tableStyle,new DD(a,Number.MAX_VALUE));return b}FTc(a){if(14!==a.type){a=this.Pb.Nc(a);a.rc(14);var b=a.Ng(14)}else b=a;a=b.id;this.bad.Hb(a)||(b=this.c9d(b),this.bad.$(a,this.Rck(b)));return this.bad.ga(a)}Jaj(a){return(a=this.qc.U8d(Object(ua.a)(115,this.jc.mg(a))))?a.TableListStyle:null}c9d(a){const b=Object(ua.a)(115,this.jc.mg(a));
return this.CAe(()=>a.BY,()=>a.N7,()=>a.tableLook,()=>this.Jaj(a),()=>b?b.Ne:null,()=>this.U5b(a))}nfd(a,b){this.Bdg(b.node)}x6g(a,b){a=b.property;b=b.node;if(a===X.a.Uya||a===X.a.Nrc||a===kb.a.Tya||a===kb.a.kga||a===kb.a.NA){if(a===kb.a.Tya||a===kb.a.NA)b.Orc=!1;a!==X.a.Uya&&a!==X.a.Nrc||this.Bdg(b);this.l8b(b)}}Jfk(a){Array.contains(this.PZe,a)||(this.l8b(a),this.PZe.push(a))}y4g(){Array.clear(this.PZe)}lGj(a){this.X$c.remove(a.id)}Bdg(a){a=a.id;this.YX.remove(a);this.cad.remove(a);this.bad.remove(a)}DTc(a){const b=
a.id;this.X$c.Hb(b)||this.X$c.$(b,this.Ick(this.c9d(a)));return this.X$c.ga(b)}U5b(a){const b=a.id;if(this.YX.Hb(b))return this.YX.ga(b);var c=a.sa(X.a.Uya,null);if(!c)return null;let h=null;const m=Uq.ORf(c);m&&a.Fh&&(h=a.Fh.ye(m));a=null;if(h)a=vg.a.oSa(h,X.a.tableStyle);else if(c=this.C0.t5f("{"+c.toString()+"}"))a=c.YX;a&&this.YX.$(b,a);return a}U6d(a){return a.tableLook}w8(a,b){a=this.Uk.gsb(a,b);return this.u9.Me(a,0)}q3i(a){if(a.Sa(X.a.hP))switch(a.sa(X.a.hP,0)){case 2:return"bottom";case 1:return"middle"}return"top"}oYf(a){var b=
null;if(!a)return null;if(a.cellShading){var c=To.a(a.cellShading);To.e(c)||(b=c)}b||(b=this.xta(a,X.a.cellShading,wl.a.Otb));c=Object(ua.a)(115,this.jc.mg(a));b=this.Uk.Crb(b,c?c.Ne:null,this.adb);a.rowIndex||1!==a.pi||Ba.a.J(9242778,822,50,"CellId={0} BGCss={1}",a.id.toString(),b);return b}IQc(a){var b=null;let c=null;if(!a)return null;if(a.cellShading){const h=To.a(a.cellShading);To.e(h)||(b=h)}b||(b=this.xta(a,X.a.cellShading,wl.a.Otb));a=(a=Object(ua.a)(115,this.jc.mg(a)))?a.Ne:null;(b=b.solidFillField)&&
(c=Uf.Box4ColorHelper.DDa(b,a));return c}N9a(a){var b=null;var c=Object(ua.a)(5,a);c&&(a=c.sa(jb.a.listLevel,Vg.a.zEa),c=this.Pb.Nc(c),c.rc(7)&&rd.TableReader.ys(c)&&(c=Object(ua.a)(Tl.TableCellNode,c.Ng(16))))&&(this.Qah(c),b=1+a,b=this.oH.jYf(c,this.FTc(c),b));return{tableStyle:b,U6a:null}}lkj(a){let b=vg.a.ui(a,X.a.cellShading,wl.a.Otb);if(To.e(b)){const c=this.U5b(a);c&&(b=this.Uk.F5d(c))}a=Object(ua.a)(115,this.jc.mg(a));return this.Uk.Crb(b,a?a.Ne:null)}m6i(a){return!Rd.a("PPTOEnableTableDiagonalBorders")||
2!==a&&1!==a?wl.a.Ntb:wl.a.AIi}B7i(a,b){if(this.t6c&&this.No.wT&&!this.mIj(a,b))return new Lx("","");var c=Object(ua.a)(123,a);if(({OPa:y,i6a:G,Mrb:U}=Fp.LSa(b)).returnValue)if(this.JWa&&Rd.a("TableBordersLocalRenderingFix")){var h=this.xta(c,y,this.m6i(b),!0);var m=this.xta(c,U,wl.a.Mtb,!0);var y=c.sa(y,h);h={};if(Rd.a("FixClearTableBorder")){let ja=this.Pb.Nc(c);ja.rc(14);if(ja.Ng(14).Sa(X.a.Uya)){h.Color="##T,0,0,0";h=Uf.Box4ColorHelper.oV(h);h=this.xta(c,G,h,!0);var G=vg.a.ui(c,G,h);G=Uf.Box4ColorHelper.Doa(G);
a=this.jc.mg(a);a=(a=Uf.Box4ColorHelper.LJ(G,a?a.Ne:null))?Uf.Box4ColorHelper.Poa(a):null}else h.Color="#000000",a=Uf.Box4ColorHelper.oV(h),a=Uf.Box4ColorHelper.Usa(a)}else h.Color="##T,0,0,0",h=Uf.Box4ColorHelper.oV(h),h=this.xta(c,G,h,!0),G=vg.a.ui(c,G,h),G=Uf.Box4ColorHelper.Doa(G),a=this.jc.mg(a),a=(a=Uf.Box4ColorHelper.LJ(G,a?a.Ne:null))?Uf.Box4ColorHelper.Poa(a):null;m=c.sa(U,m)}else m=this.Uk.p9d(b,c),y=m.Sa(y)?m.eb(y):this.xta(c,y,wl.a.Ntb,!0),a=this.gYf(m,c,G),m=m.Sa(U)?m.eb(U):this.xta(c,
U,wl.a.Mtb,!0);else y=wl.a.Ntb,a=wl.a.MLc,m=wl.a.Mtb;5!==b||a.lD===hb.a.auto||c.rowIndex||1!==c.pi||Ba.a.J(9242780,822,50,"CellId={0} BGR={1} Alpha={2}",c.id.toString(),a.lD,a.alpha);var U=!1;a.lD!==hb.a.auto||7!==b&&5!==b||(h=this.Pb.Nc(c),h.rc(14),7===b?(G=X.a.gga,h=this.Uk.Wnj(h)):(G=X.a.hga,h=this.Uk.aoj(h)),h&&(c=this.Uk.p9d(b,c),this.gYf(c,h,G).lD===hb.a.auto&&(m=wl.a.Mtb,y=wl.a.uoj,a=wl.a.toj,U=!0)));c=this.Uk.C3d(m,y,a);return U&&7===b?new Lx(c,"Top"):U&&5===b?new Lx(c,"Left"):new Lx(c,"")}xRc(a,
b){switch(b){case 7:b=X.a.Qya;break;case 6:b=X.a.jga;break;case 0:b=X.a.iga;break;case 5:b=X.a.Pya;break;default:b=null}const c=this.xta(a,b,wl.a.Ntb,!0);return a.sa(b,c)}mIj(a,b){if(!a||a.isGhostCell||2===b||1===b)return!0;const c=this.Pb.Nc(a);if(!c.rc(14))return!0;var h=c.Mw(14);if(!h.Lp())return!0;const m=a.rowSpan,y=a.colSpan;if(1===m&&1===y)return!0;h=this.yc.ikj(h);const G=new fr.a;G.ke=this.MXa.ggj(c);G.ag=G.ke+m;G.fe=this.rJ.SQc(Object(ua.a)(123,a));G.Nf=G.fe+y;switch(b){default:Ba.a.J(560562957,
822,15," Unknown position type: {0} ",b);break;case 5:if(!G.fe||1===m)break;if(4!==(h.ns(G.ke,G.fe-1)&4)||8!==(h.ns(G.ag-1,G.fe-1)&8))break;for(a=G.ke+1;a<G.ag;++a)if(4===(h.ns(a,G.fe-1)&4))return!1;break;case 6:if(G.Nf===h.sR||1===m)break;if(4!==(h.ns(G.ke,G.Nf)&4)||8!==(h.ns(G.ag-1,G.Nf)&8))break;for(a=G.ke+1;a<G.ag;++a)if(4===(h.ns(a,G.Nf)&4))return!1;break;case 7:if(!G.ke||1===y)break;if(1!==(h.ns(G.ke-1,G.fe)&1)||2!==(h.ns(G.ke-1,G.Nf-1)&2))break;for(a=G.fe+1;a<G.Nf;++a)if(1===(h.ns(G.ke-1,a)&
1))return!1;break;case 0:if(G.ag!==h.OO&&1!==y&&1===(h.ns(G.ag,G.fe)&1)&&2===(h.ns(G.ag,G.Nf-1)&2))for(a=G.fe+1;a<G.Nf;++a)if(1===(h.ns(G.ag,a)&1))return!1}return!0}gYf(a,b,c){if(this.JWa){const h=Uf.Box4ColorHelper.oV({Color:"##T,0,0,0"});a=vg.a.ui(a,c,h);a=Uf.Box4ColorHelper.Doa(a);b=this.jc.mg(b);b=(b=Uf.Box4ColorHelper.LJ(a,b?b.Ne:null))?Uf.Box4ColorHelper.Poa(b):null}else a.Sa(c)?(b=a.Lh(c),b=Object(za.a)(hb.a,b)?b:new hb.a(a.eb(c))):b=this.xta(b,c,wl.a.MLc,!0);this.adb&&(b=new hb.a(0,b.alpha));
return b}l8b(a){const b=this.RGa?this.Pb.O6d(a):this.Pb.Nc(a);let c=Object(ua.a)(155,b.Gi());for(a=Object(ua.a)(175,a);c;)c.zld=!1,c=Object(ua.a)(155,b.kp());this.lGj(a);this.RGa?this.VFj(a):a.qda(4)}VFj(a){if(a&&a.isConnected)for(a=this.Pb.O6d(a),a=P.a.jv(a);a.moveNext();)a.currentNode.anchor.Ar(4)}pEl(a){a&&(this.FTc(a),this.U5b(a),this.DTc(a))}xta(a,b,c,h=!1){if(!a)return c;var m=this.Pb.Nc(a);m.rc(14);m=m.Ng(14);var y=m.id;if(this.vCb&&h){if(!m.Sa(X.a.Uya))return c;y=a.rowIndex;a=a.pi;return(a=
this.DTc(m).N2i(m,y,a))&&a.Sa(b)?a.Lh(b):c}this.Qah(a);h=a.aV;if(!h){if(!m.Sa(X.a.Uya))return c;h=a.rowIndex;let G=a.pi;const U=a.rowSpan,ja=a.colSpan;this.cad.Hb(y)||this.cad.$(y,this.Wck(this.c9d(m)));h=this.cad.ga(y).u4d(h,G,U,ja);a.aV=h}return h&&h.Sa(b)?h.Lh(b):c}Mmi(a){const b=this.Pb.zSa();b.set(a);let c=0,h=Object(ua.a)(155,b.Bb(1));for(;h;)h.rowIndex=c,c++,h=Object(ua.a)(155,b.kp());a.Orc=!0}XDk(a){let b=0;const c=a.rowIndex,h=this.Pb.zSa();h.set(a);let m=Object(ua.a)(123,h.Bb(1));for(;m;)m.rowIndex=
c,m.pi=b,m.aV=null,this.oH.xXk(m),m.XPf(),m=Object(ua.a)(123,h.kp()),b++;a.zld=!0}Qah(a){var b=this.Pb.Nc(a);b.rc(14);a=Object(ua.a)(155,b.Ng(15));(b=Object(ua.a)(175,b.Ng(14)))&&!b.Orc&&this.Mmi(b);a&&!a.zld&&this.XDk(a)}}Object(n.a)(Nz,"TableStyleReader",null,[1240,1241,1242]);class Hl extends cm{constructor(a,b,c,h,m,y,G,U,ja,va,Ta,fb,Db,gc,hc,Gc,Pc,yc){super(a,b,c);this.G6c=this.ny=this.lEb=this.Wua=this.gH=null;this.Wgc=m;this.Uk=y;this.No=G;this.He=U;this.w0=[];this.qc=h;this.heb=fb;this.mc=
Db;this.jc=gc;this.gj=hc;this.ACb=va.pptIsTableColumnRowResizeHandleRenderedByCSSEnabled;this.Nue=va.pptComplexTableLayoutSyncEnabled;this.j0=va.cka;this.xOg=Ta;this.yc=Gc;this.Pb=Pc;this.Tve=va.X$;this.v6c=va.Wzh;if(yc)this.ny=yc;else throw Error.argumentNull("slideDimensionsHelper");if(this.Qc.np){if(this.gH=ja?ja(a):null)this.gH.vEh(),this.Ck&&this.Ck.RU&&(this.gH.mhi(this,this.Ck.RU,this.table),this.gH.Jx(!this.mc.Fn));Rd.a("DeprecateIE.TableViewElement.ctor")||!this.No.vab&&!this.No.xab||(this.htmlElement.style.backgroundColor=
"rgba(0,0,0,0)")}this.Ck&&(this.Ck.i9h(Object(F.a)(this,this.w5g,"onShapeEnterTextEditing")),this.Ck.Rsf(Object(F.a)(this,this.F5g,"onShapeSelectionChanged")),this.Ck.k9h(Object(F.a)(this,this.x5g,"onShapeExitTextEditing")),this.Ck.M8h(Object(F.a)(this,this.V0g,"onAfterDraw")),this.Ck.r$h(Object(F.a)(this,this.S4g,"onReadModeChanged")),this.Ck.g9h(Object(F.a)(this,this.s2g,"onDisplayOnActiveSlide")))}get nri(){return this.gH}s2g(){this.BZe()}get Ck(){if(this.Wua)return this.Wua;if(this.Qc.np){const a=
Nf.a.nb(this.Qc.Ma,this.gb);a.gf();a.d_a();this.Wua=Object(ua.a)(117,a.OQa)}return this.Wua}M7d(){if(!this.v6c)return 1;var a=this.jc.mg(this.gb);if(!a)return 1;var b=a.sc(this.Ma);if(!b)return 1;b=b.kca?b.kca.xa.style.visibility===Mi.a.visible:!1;var c=new cr.a(a.oq,a.Wk);if(!this.ny)return 1;b=this.ny.E5b(c,b).aP;c=this.gj.EG;a=this.qc.rTc(a)*c;return b/a}anh(a){if(1!==a&&this.v6c){var b=this.yc.Zja(this.gb);for(var c of b)b=this.Md.Ld.Me(c.sa(X.a.mu,0),1)*a,c.sc(this.Ma).htmlElement.style.height=
b+"px";c=xn.b(this.gb);for(b=0;b<c.length;b++){const h=this.Md.Ld.Me(c[b],0)*a;this.AJc.childNodes[b].style.width=h+"px"}}}Dy(a){super.Dy(a);this.anh(this.M7d());this.CBh(this.heb.yyb?!!this.Ck&&this.Ck.kL()&&(this.Ck.XA||this.Ck.Tn):!!this.Ck&&this.Ck.Tn)}IU(){const a=this.Wgc,b=xn.b(this.gb),c=rd.TableReader.Ai(this.gb);let h=0;for(let m=0;m<c;m++)h+=Math.max(a.w8(this.gb,m),this.Md.Ld.Me(b[m],0));return new Ng.a(0,h,0)}v6(a){super.v6(a);if(this.Qc.np&&(a=this.xOg.mTc(this.gb,this.Ma))&&0!==a.gXc){const b=
this.gb;if(b.VN)return;this.Nue?a.lGh(b):a.gXc&2?a.lGh(b):a.Yyl(b,c=>{c&&this.BZe()})}this.BZe()}BZe(){this.gH&&this.Ck&&this.Ck.Tn&&this.AZe()}krh(a,b){Object(ua.a)(Nz,Ya.StyleReader.kr);if(1!==b)for(var c=0;c<this.u1.childNodes.length;c++){var h=this.u1.childNodes[c];if(!h||"TR"!==h.tagName.toUpperCase())continue;const y=h.offsetHeight*b;var m=this.Uk.pSd(this.gb,c);m=this.Md.Ld.Me(m,1);h.style.height=(y<m?0:y)+"px"}if(1!==a)for(b=0;b<this.AJc.childNodes.length;b++)c=cf.a.En(this.AJc.childNodes[b].style.width),
h=this.Uk.gsb(this.gb,b),h=this.Md.Ld.Me(h,0),this.Hpc(b,Math.max(c*a,h))}Zfj(a){a>this.u1.childNodes.length&&Error.argumentOutOfRange("rowIdx");const b=this.u1.childNodes[a];b&&"TR"===b.tagName.toUpperCase()||Error.invalidOperation(String.format("Child node '{0}' is not a table row",a));return cf.a.En(b.style.height)}R5b(){return pj.a.Oca(this.He.ii(this.table))}get JNj(){const a=this.xOg.mTc(this.gb,this.Ma);return!a||0===a.gXc}K3f(){const a=[0];for(let b=1;b<=this.u1.childNodes.length;++b)a[b]=
a[b-1]+this.u1.childNodes[b-1].offsetHeight;return a}HYf(){const a=[0];for(let b=1;b<=this.AJc.childNodes.length;++b)a[b]=a[b-1]+this.RQc(b-1);return a}CPe(a){if(14!==this.gb.type)Ba.a.J(512497121,808,10,"The source node of the table view element is not a table node but {0}",this.gb.type);else if(this.gb.sa(X.a.complexTable,!0))Ba.a.J(512497118,808,50,"Disable column resizing for table with merged cells");else{super.CPe(a);a=new rb.GraphIterator;a.set(this.gb);Gd.moveToFirstRow(a);Gd.moveToFirstColumn(a);
let b=1;const c=this.Md.Ld.Me(this.Uk.o4b(a.currentNode,6),0);for(;!Qe.isLastCellInRow(a);){Gd.moveToNextColumn(a);const h=this.$u[b++],m=cf.a.Pc(-1*c);rd.TableReader.um(this.gb)?h.style.marginRight=m:h.style.marginLeft=m}this.$u.length!==b&&Ba.a.J(512497119,808,10,"Table has inconsistent column resize handles: {0} handles, {1} columns",this.$u.length,b)}}Iaa(a){super.Iaa(a);this.Qc.Vl||this.OVk();this.gb.sa(X.a.complexTable,!0)||Sm.a.yv||this.NVk()}dispose(){super.dispose();this.gH&&(this.gH.dispose(),
this.gH=null);this.Ck&&(this.Ck.NTk(Object(F.a)(this,this.w5g,"onShapeEnterTextEditing")),this.Ck.mih(Object(F.a)(this,this.F5g,"onShapeSelectionChanged")),this.Ck.OTk(Object(F.a)(this,this.x5g,"onShapeExitTextEditing")),this.Ck.xTk(Object(F.a)(this,this.V0g,"onAfterDraw")),this.Ck.CUk(Object(F.a)(this,this.S4g,"onReadModeChanged")),this.Ck.LTk(Object(F.a)(this,this.s2g,"onDisplayOnActiveSlide")));this.Wua=null}V0g(){this.Ck.ZN&&this.AZe(!0)}kpi(){if(this.Tve){var a=this.gb,b=a.M9a();if(a.Orc)for(const c of b){a=
c;if(!a)continue;a=a.sc(this.Ma);if(!a)continue;b=this.Wgc.xRc(c,7);const h=this.Wgc.xRc(c,6),m=this.Wgc.xRc(c,0),y=this.Wgc.xRc(c,5);0===b&&a.Fjd("Top");0===h&&a.Fjd("Right");0===m&&a.Fjd("Bottom");0===y&&a.Fjd("Left")}}}F5g(a,b){this.CBh(b.isSelected);a=this.table;this.kpi();b.isSelected?Sys.UI.DomElement.containsCssClass(a,"Selected_Table")||Sys.UI.DomElement.addCssClass(a,"Selected_Table"):Sys.UI.DomElement.containsCssClass(a,"Selected_Table")&&Sys.UI.DomElement.removeCssClass(a,"Selected_Table")}S4g(a,
b){this.gH&&this.gH.Jx(b.hRj)}CBh(a){if(this.gH)if(this.j0){const b=this.Pb.Nc(this.gb);b.gf();b.d_a().eb(X.a.isResizable)?this.gH.visible=a:this.gH.visible=!1}else this.gH.visible=a;this.Ck&&this.Ck.Rd&&this.Ck.shapeNode&&this.Ck.shapeNode.IQ&&(this.Ck.Rd.visible=a)}NVk(){if(!this.w0.length){var a=this.DQa();Sys.UI.DomElement.addCssClass(a,"First");this.w0.push(a);a=this.mFi();Sys.UI.DomElement.addCssClass(Hl.f0f(a),"Last");this.w0.push(a)}var b=this.PSa();a=b.length;var c=a+1-this.w0.length;if(!(0>=
a)){if(0<c)for(var h=0;h<c;h++){let m=this.DQa();this.w0.splice(this.w0.length-1,0,m)}if(0>c){for(h=0;h<c;h++)this.sJb(this.w0[h+1]);this.w0.splice(1,c)}for(c=0;c<a;c++)h=b[c].firstChild,h.insertBefore(this.w0[c],h.firstChild);b=b[a-1].firstChild;b.insertBefore(this.w0[a],b.firstChild);this.hbi()}}hbi(){const a=new rb.GraphIterator;a.set(this.gb);Gd.moveToFirstRow(a);Gd.moveToFirstColumn(a);let b=1;for(;b<this.w0.length;){var c=this.Md.Ld.Me(this.Uk.o4b(a.currentNode,5),0),h=this.Md.Ld.Me(this.Uk.o4b(a.currentNode,
0),1);let m=this.w0[b];Hl.$Tj(m)&&(m=Hl.f0f(m));c=cf.a.Pc(-1*c);h=cf.a.Pc(-1*h-(b===this.w0.length-1?4:0));rd.TableReader.um(this.gb)?m.style.marginRight=c:m.style.marginLeft=c;m.style.marginTop=h;Gd.moveToNextRow(a);b++}}OVk(){if(!this.lEb){const a=String.format("url('{0}'), pointer",ty.a.box4Image("RowSelect.cur"));this.lEb=this.Md.createElement("div");this.lEb.className=xm.a.fol;vf.c(this.lEb,!0);const b=this.Md.createElement("div");b.className=xm.a.KZe;b.style.cursor=a;this.lEb.appendChild(b);
this.table.appendChild(this.lEb)}}agj(){return this.PSa()}DQa(){const a=this.Md.createElement("div");a.className="TableRowResizeHandle";a.style.width="100%";vf.c(a,!0);return a}mFi(){const a=this.Md.createElement("div");a.className="TableRowResizeAnchor";const b=this.DQa();a.appendChild(b);vf.c(a,!0);return a}sJb(a){Y.a.VJa(a);La.a.XO(a)}akj(a){var b=this.jc.mg(this.gb);let c=this.gj.EG;b&&b.Ow&&null!=b.Ow.Wr&&(c=b.Ow.Wr);b=this.qc.rTc(this.jc.mg(this.gb))*c;a=a.copy();a.move(-a.hc,-a.kc);a.scale(1/
b,1/b);return a}w5g(){this.table.clientWidth&&this.AZe(!0);!this.heb.yyb&&this.gH&&(this.gH.visible=!0,this.Ck&&this.Ck.Rd&&(this.Ck.Rd.visible=!0));this.Ck&&this.Ck.kL()&&!Sys.UI.DomElement.containsCssClass(this.table,"Selected_Table")&&Sys.UI.DomElement.addCssClass(this.table,"Selected_Table")}x5g(){this.gH&&(this.gH.visible=!1);this.Ck&&this.Ck.Rd&&(this.Ck.Rd.visible=!1)}AZe(a=!1){var b=this.R5b();let c=yi.a.Oud;this.G6c&&(c=pj.a.d5b(b,this.G6c));const h=ad.a.z4e;a=!!this.Ck&&(!this.G6c||!h.equals(ad.a.z4e)||
!c.equals(yi.a.Oud)||a);this.G6c=b;if(a&&(a=this.Ck.l2e,b=pj.a.d5b(this.akj(b),a),this.Ck.setOffsets(b,!0),!Rd.a("DeprecateIE.TableViewElement.SynchronizeViews")&&this.No.vab&&0<this.u1.childNodes.length))for(b=this.u1.childNodes[0].offsetWidth,a=0;a<this.w0.length;a++)this.w0[a].style.width=b+"px";this.gH&&this.gH.Pl();this.ACb||this.o3e()}h8d(){return this.ACb?null:super.h8d()}YKe(a){if(this.ACb){var b=this.yc.rk(this.gb);a=Object(ua.a)(rb.GraphIterator,this.Pb.Nc(this.gb));Gd.forEachCellInTable(a,
(c,h,m)=>{c=c.currentNode;const y=c.sc(this.Ma);y&&y.Dtc(0,0,0,0,!h,h+c.rowSpan===b,!m);return!0})}else super.YKe(a)}gcj(a){let b=-1;var c=rd.TableReader.Ai(this.gb),h=xn.b(this.gb);const m=Array(c);for(let y=0;y<c;y++)m[y]=Math.floor(this.Md.Ld.Me(h[y],0));if(rd.TableReader.um(this.gb))if(a<=Sys.UI.DomElement.getLocation(this.u1.firstChild.lastChild).x)b=c-1;else{a-=Sys.UI.DomElement.getLocation(this.u1.firstChild.lastChild).x;for(--c;0<=c;c--)if(a>=m[c])a-=m[c];else{b=c;break}-1===b&&(b=0)}else if(a<=
Sys.UI.DomElement.getLocation(this.u1.firstChild.firstChild).x)b=0;else{a-=Sys.UI.DomElement.getLocation(this.u1.firstChild.firstChild).x;for(h=0;h<c;h++)if(a>=m[h])a-=m[h];else{b=h;break}-1===b&&(b=c-1)}return b}Mnh(a,b,c=!0){const h=rb.GraphIterator.nb(this.gb),m=new rb.GraphIterator,y=new t.GraphTransaction(2);y.yy(h);Gd.moveToFirstRow(h);c?(Gd.moveToRowByIndex(h,a),Gd.moveToFirstColumn(h)):Gd.moveToColumnByIndex(h,a);m.Rc(h);c?(Gd.moveToRowByIndex(m,b),Gd.moveToLastColumn(m)):(Gd.moveToColumnByIndex(m,
b),Gd.moveToLastRow(m));a=yd.SelectionFactory.N0b(h,m);this.Qc.Lb.ME(a);y.dispose()}static cgj(a){return Hl.dgj(a,Sm.a.yv)}static dgj(a,b){return b?Hl.bgj(a):Hl.egj(a)}static egj(a){let b=a;for(;b;){if("tr"===b.nodeName.toLowerCase()){Hl.fie(a)||Hl.Sie(a)||(b=b.previousSibling);break}b=b.parentNode}return Hv.w6f(b)}static bgj(a){let b=a;for(;b;){if("tr"===b.nodeName.toLowerCase()){if(Hl.Sie(a)){if((a=a.parentNode)&&void 0!==a.rowSpan&&null!==a.rowSpan){a=a.rowSpan;for(let c=1;c<a&&b;c++)b=b.nextSibling}}else Hl.fie(a)||
(b=b.previousSibling);break}b=b.parentNode}return b?Hv.w6f(b):null}static U3(a){return Sys.UI.DomElement.containsCssClass(a,"TableColumnResizeHandle")}static LUa(a){return Sys.UI.DomElement.containsCssClass(a,"TableRowResizeHandle")}static $Tj(a){return Sys.UI.DomElement.containsCssClass(a,"TableRowResizeAnchor")}static vua(a){return Sys.UI.DomElement.containsCssClass(a,"TableColumnHandle")}static r$b(a){return Sys.UI.DomElement.containsCssClass(a,xm.a.KZe)}static hkj(a){for(;a;){if("TABLE"===a.nodeName.toUpperCase())return a;
a=a.parentNode}return null}static fie(a){return Sys.UI.DomElement.containsCssClass(a,"First")}static Sie(a){return Sys.UI.DomElement.containsCssClass(a,"Last")}static ogg(a){return Sys.UI.DomElement.containsCssClass(a,"FirstLeft")}static f0f(a){return a.firstChild}}Object(n.a)(Hl,"TableViewElement",cm,[1237,1238,1239,455,456,106]);class hL extends bL.a{constructor(a,b,c,h,m,y,G,U,ja,va,Ta){super(a,b);this.ozf="ShowDashedLine";this.ama=this.ae=this.Vd=this.SFg=this.MFg=this.$Fg=this.Sdb=this.Cxe=this.Bxe=
this.ie=this.UFg=null;this.UQg=this.TQg=this.N4=this.M4=this.xeb=this.Iea=0;this.q$=c;this.jdb=h;this.Fs=m;this.yc=y;this.pa=G;this.jA=U;this.ia=ja;this.Sp=Ta;this.Rdc=this.Sue=!1;this.R8j=va}get CQe(){this.wCf();return this.ie.offsetLeft}set CQe(a){this.wCf();this.ie.style.left=cf.a.Pc(a)}get zoom(){return 1}Nu(a){const b=super.Nu(a);if(b&&this.aN){this.kSd(a.Cc);Sys.UI.DomElement.addCssClass(this.ie,this.ozf);if(this.oba=Hl.ogg(a.Cc))this.ni=0,this.kF=this.ul.RQc(this.ni);this.Vd=this.ul.Ck;this.ae=
this.yc.T5b(this.Vd.gb);this.Rdc=!1;this.wVe()&&this.q4i(a)}else b&&!this.aN&&(a=a.Cc,Hl.vua(a)&&(Ba.a.J(512497184,816,50,"Drag from table column handle"),this.ni=parseInt(a.parentNode.getAttribute("columnindex").toString())));b&&this.Sp&&this.ia.processAction(D.a.Cja,2);return b}zw(a){this.aN?(a=this.qAf(a.clientPoint.x),this.CQe=this.UFg+(a-this.kF)*(this.oba?-1:1)):(a=this.ul.gcj(a.clientPoint.x),this.ul.Mnh(this.ni,a,!1));return!0}Zn(a){if(this.aN){const h=this.q$.Ci("UserAction","PPTColumnResize");
a&&Ba.a.J(8959051,822,50,String.format("Start Column resize for table: {0}, IsComplex: {1}",this.ul.gb.sa(X.a.wFb,""),this.ul.gb.Lp()));const m=new t.GraphTransaction(15);m.kd(this.ul.gb);const y=this.ul.gb.sa(kb.a.Tu,null);var b=this.qAf(a.clientPoint.x),c=this.ul.Md.Ld;const G=c.rf(b,0);(this.oba||this.ni===this.rG-1)&&this.Fs.E_a(this.ul.gb,this.ni,G);if(this.oba&&b!==this.kF&&(b=this.kF-b)){this.Vd.setPosition(this.Vd.x+b,this.Vd.y,!0);b=c.rf(this.Vd.x,0);c=c.rf(this.Vd.y,1);const U=this.ul.Ck.shapeNode;
U.qy=b;U.ry=c}!this.oba&&this.ni<this.rG-1&&this.uUe(G,y);this.Rsc();m.dispose();Fc.App.Kb.updateCommandUI();this.end();this.ae?this.Fs.IZa(this.ae):Ba.a.J(512497183,822,15," OnDragEnd: m_tableNode is null. Unable to Redraw Diagonal borders.");h&&h.stop();a&&Ba.a.J(8959053,822,50,String.format("End Column resize for table: {0}, IsComplex: {1}, IsFirstColumnLeftResizeHandle: {2}",this.ul.gb.sa(X.a.wFb,""),this.ul.gb.Lp(),this.oba))}else a&&Fc.App.Kb.V5(a.clientPoint,a.Yf),super.Zn(a)}iu(a){super.iu(a);
this.aN&&this.Rsc()}o5f(){return null}wCf(){if(!this.ie)throw Error.argumentNull("m_element","Try to use the resize handle before it is initialized");if(!Sm.a.U3(this.ie))throw Error.invalidOperation("Element is not the table column resize handle");}kSd(a){this.ie=a;this.UFg=this.CQe;this.Bxe=this.ie.style.marginLeft;this.Cxe=this.ie.style.marginRight;this.Sdb=this.ie.style.height;this.$Fg=this.ie.style.top;this.MFg=this.ie.style.bottom;this.SFg=this.ie.style.left;this.ie.style.marginLeft=this.ie.style.marginRight=
"auto";this.ie.style.top="0";this.ie.style.height="auto";this.ie.style.bottom="0";this.jdb&&(a=Sm.a.V5b(a))&&(this.ie.style.top=-a.offsetTop+"px",this.ie.style.bottom=-(this.ul.getBounds().height-a.offsetTop-a.offsetHeight)+"px")}Rsc(){this.ie&&(Sys.UI.DomElement.removeCssClass(this.ie,this.ozf),this.ie.style.marginLeft=this.Bxe,this.ie.style.marginRight=this.Cxe,this.Bxe=this.Cxe="auto",this.ie.style.left=this.R8j?this.SFg:"auto",this.ie.style.top=this.$Fg,this.ie.style.height=this.Sdb,this.ie.style.bottom=
this.MFg,this.ie=null)}q4i(a){this.Rdc=this.Sue=!1;a=a.Cc;if(Sm.a.U3(a)){var b=null,c=null;({mbb:b,Fib:c}=this.p4i(a,b,c)).returnValue&&this.b5i(b,c)&&this.g8d()&&this.ae&&(a=this.yc.Ai(this.ae),b=this.yc.rk(this.ae),0<=this.Iea&&this.Iea<b&&0<=this.xeb&&this.xeb<b&&0<=this.M4&&this.M4<a&&0<=this.N4&&this.N4<a&&(this.Rdc=!0))}}p4i(a,b,c){if(!Sm.a.U3(a)||!this.ae)return{returnValue:!1,mbb:b,Fib:c};var h=Sm.a.V5b(a);h=vf.a(h);this.ama=Object(ua.a)(Tl.TableCellNode,h.gb);if(!this.ama)return{returnValue:!1,
mbb:b,Fib:c};h=this.jSc(this.ama);if(0>h||h>=this.yc.Ai(this.ae))return{returnValue:!1,mbb:b,Fib:c};const m=this.ama.rowIndex;if(0>m||m>=this.yc.rk(this.ae))return{returnValue:!1,mbb:b,Fib:c};if(Hl.ogg(a))return{returnValue:!1,mbb:null,Fib:c};b=this.ae.qf(m,h);if(h===this.yc.Ai(this.ae)-1)return{returnValue:!1,mbb:b,Fib:null};c=this.ae.qf(m,h+1);return{returnValue:!0,mbb:b,Fib:c}}b5i(a,b){if(!this.ae||!a||!b)return!1;this.Iea=a.rowIndex;if(0>this.Iea||this.Iea>=this.yc.rk(this.ae))return!1;this.xeb=
this.Iea;this.M4=this.E4b(a);if(0>this.M4||this.M4>=this.yc.Ai(this.ae))return!1;this.N4=this.jSc(b);if(0>this.N4||this.N4>=this.yc.Ai(this.ae))return!1;var c=this.Z0i(a,b);a=c?this.C2i(a,b):!1;if(c=c&&a)this.Sue=this.tKj(b.pi);return c}tKj(a){let b=!0;if(0<this.Iea)for(var c=this.Iea-1;0<=c;){var h=this.ae.qf(c,a);if(h&&!h.isGhostCell){b=!1;break}--c}if(this.xeb<this.ae.BY-1)for(c=this.Iea+1;c<=this.ae.BY-1;){if((h=this.ae.qf(c,a))&&!h.isGhostCell){b=!1;break}c+=1}return b}g8d(){if(!this.ae)return!1;
const a=this.yc.Ai(this.ae);if(0>this.M4||this.M4>=a||0>this.N4||this.N4>=a||0>this.ni||this.ni>=a||0>this.ni+1||this.ni+1>=a)return!1;this.TQg=this.$9d(this.ae,this.M4,this.ni)-this.e7d(this.ae,this.M4);this.UQg=this.$9d(this.ae,this.N4,this.ni+1)-this.e7d(this.ae,this.N4);return!0}$9d(a,b,c){if(b>c)return this.$9d(a,c,b);if(!a||0>b||b>=this.yc.Ai(a)||0>c||c>=this.yc.Ai(a))return-1;a=a.G4d;let h=0;for(;b<=c;b++)h+=a[b];return Math.floor(this.ul.Md.Ld.Me(h,0))}e7d(a,b){return Ya.StyleReader.kr?Ya.StyleReader.kr.w8(a,
b):yn.a.Uqd}SDa(a,b){return this.ul.Md.Ld.rf(this.e7d(a,b),0)}Z0i(a,b){if(!a||!b)return!1;a=a.w4b();const c=b.pi;for(b=b.w4b();b&&(!b.isGhostCell||this.E4b(b)===c);)this.Iea--,this.M4=Math.max(this.M4,this.E4b(a)),this.N4=Math.min(this.N4,this.jSc(b)),a=a.w4b(),b=b.w4b();return!0}C2i(a,b){if(!a||!b)return!1;a=a.GQc();const c=b.pi;for(b=b.GQc();b&&(!a.isGhostCell||this.E4b(b)===c);)this.xeb++,this.M4=Math.max(this.M4,this.E4b(a)),this.N4=Math.min(this.N4,this.jSc(b)),a=a.GQc(),b=b.GQc();return!0}E4b(a){return a?
(a=a.Ry())?a.pi:-1:-1}jSc(a){if(!a)return-1;let b=a;a.isGhostCell&&(b=a.Ry());a=null;b&&(a=b.t6d(2));return a?a.pi:-1}qAf(a){this.wVe()&&this.Rdc?(a=this.ul.gb.ORj?Math.floor((this.d7-a)/this.zoom)+this.kF:Math.floor((a-this.d7)/this.zoom)+this.kF,a=Math.min(a,this.kF+this.UQg),a=Math.max(a,this.kF-this.TQg)):a=this.qSd(a);return a}uUe(a,b){if(this.wVe()&&this.Rdc){if(!this.pa.bH()){var c=yd.SelectionFactory.Qg(Object(ua.a)($f.a,this.ama.A3b),0);this.pa.setSelection(c)}let h=c=-1,m=-1;({WNf:c,nNf:h,
oNf:m}=this.m7i(a-b[this.ni],b,c,h,m));this.Sue&&(c===this.ni&&Math.abs(h)>=this.SDa(this.ae,c)||c===this.ni+1&&c<this.yc.Ai(this.ae)-1&&Math.abs(m)>=this.SDa(this.ae,c+1)||c===this.ni+1&&c===this.yc.Ai(this.ae)-1)?(Ba.a.J(512497182,815,50,"DragAcrossColumn: scenario-1, _originColumn = {0}, dragEndInColumnIndex = {1}, distanceWithLeftBorder = {2}, distanceWithRightBorder = {3}",this.ni.toString(),c.toString(),h.toString(),m.toString()),a=b[this.ni]+b[this.ni+1],c===this.ni?(h=Math.max(h,this.SDa(this.ae,
c)),m=a-h):c===this.ni+1&&(m=Math.max(m,this.SDa(this.ae,c)),h=a-m),this.Fs.E_a(this.ae,this.ni,h),this.Fs.E_a(this.ae,this.ni+1,m)):(c>this.M4&&Math.abs(h)<this.SDa(this.ae,c)?(Ba.a.J(512497181,815,50,"DragAcrossColumn: scenario-2, _originColumn = {0}, dragEndInColumnIndex = {1}, distanceWithLeftBorder = {2}, distanceWithRightBorder = {3}",this.ni.toString(),c.toString(),h.toString(),m.toString()),this.Jfb(c,this.ni+1)):c<this.N4&&Math.abs(m)<this.SDa(this.ae,c+1)?(Ba.a.J(512497180,815,50,"DragAcrossColumn: scenario-3, _originColumn = {0}, dragEndInColumnIndex = {1}, distanceWithLeftBorder = {2}, distanceWithRightBorder = {3}",
this.ni.toString(),c.toString(),h.toString(),m.toString()),this.Jfb(c+1,this.ni+1)):(Ba.a.J(512497179,815,50,"DragAcrossColumn: scenario-4, _originColumn = {0}, dragEndInColumnIndex = {1}, distanceWithLeftBorder = {2}, distanceWithRightBorder = {3}",this.ni.toString(),c.toString(),h.toString(),m.toString()),this.$jl(c,h,m)),this.Fs.YOe(this.ae),a=rb.GraphIterator.nb(this.ae),this.Fs.t2e(a),this.ae.qda(511),this.jA.l8b(this.ae))}else this.Fs.E_a(this.ae,this.ni,a),this.Fs.E_a(this.ae,this.ni+1,b[this.ni]+
b[this.ni+1]-a)}m7i(a,b,c,h,m){if(!a)return c=this.ni,h=b[this.ni],{WNf:c,nNf:h,oNf:0};h=0;if(0<a){for(c=this.ni;h<=a;)c++,h+=b[c];m=h-a;h=b[c]-m}else{for(c=this.ni+1;h>a;)c--,h-=b[c];h=a-h;m=b[c]-h}return{WNf:c,nNf:h,oNf:m}}Jfb(a,b){if(b!==a){var c=this.d5i(b-1);for(let h=this.Iea;h<=this.xeb;h++){const m=this.ae.qf(h,b),y=this.ae.qf(h,a);this.VCe(c[h],m,y)}}}VCe(a,b,c){if(c.isGhostCell){var h=b.rowSpan,m=a.colSpan+c.pi-b.pi,y=a.colSpan+b.colSpan-m;nm.c(Object(ua.a)($f.a,b),Object(ua.a)($f.a,c),
this.Fs.ZSd);nm.c(Object(ua.a)($f.a,b),Object(ua.a)($f.a,c),[X.a.OJa]);var G=rb.GraphIterator.nb(c);G.gf();var U=new rb.GraphIterator;U.set(Object(ua.a)($f.a,b));U.Bb(1)&&nm.h(G,null,1,1,U,-1);c.isGhostCell=b.isGhostCell;this.A2d(G);b.ao(X.a.rowSpan,X.a.colSpan);b.isGhostCell=!0;c.isGhostCell||(c.colSpan=y,c.rowSpan=h);a.rowIndex===c.rowIndex&&(a.colSpan=m)}}A2d(a){const b=a.currentNode.eb(X.a.rowId),c=a.currentNode.eb(X.a.cellId);for(a=P.a.jv(a);a.moveNext();){const h=a.currentNode.sa(X.a.cellId,
null);a.currentNode.sa(X.a.rowId,null)&&a.currentNode.setValue(X.a.rowId,b);h&&a.currentNode.setValue(X.a.cellId,c)}}$jl(a,b,c){var h=rb.GraphIterator.nb(this.ae);Gd.moveToFirstRow(h);h.Zp(a,1);this.Fs.fde(h);if(h=this.ae.sa(kb.a.Tu,null))h=Ma.a.clone(h),b<this.SDa(this.ae,a)?(b=this.SDa(this.ae,a),c=h[a]-b):(c=Math.max(c,this.SDa(this.ae,a+1)),b=h[a]-c),h[a]=b,h[a+1]=c,this.ae.setValue(kb.a.Tu,h);b=this.ni+1;a+=1;a<=b&&(b+=1);this.Jfb(a,b)}d5i(a){const b=Array(this.yc.rk(this.ae));for(let c=this.Iea;c<=
this.xeb;c++){const h=this.ae.qf(c,a);b[c]=h.Ry()}return b}wVe(){return!!this.ae&&this.ae.Lp()&&!this.oba&&this.ni<this.rG-1}}Object(n.a)(hL,"PowerPointColumnDragAdapter",bL.a,[]);class ED{constructor(a,b){this.zx=this.Z4=null;this.Zec=this.Ndb=0;this.aEb=!1;this.J9=a;this.X_=b}xv(a){if(3===a.Yf)return!1;a=a.Cc;return Hl.LUa(a)||Hl.r$b(a)}iu(){if(this.aEb){const a=new t.GraphTransaction(3);a.kd(this.Z4.gb);this.Z4.source.wv(4,!0);a.dispose()}this.end()}end(){this.J9.KR()}dispose(){this.Z4=null}}Object(n.a)(ED,
"CommonRowHandleDragAdapter",null,[244,106]);class iL extends ED{constructor(a,b,c,h,m,y,G,U,ja,va,Ta,fb,Db,gc){super(a,b);this.gve=this.kCb=!1;this.PFg=this.bHa=0;this.ama=this.ae=this.Vd=this.Yva=this.TFg=this.RFg=this.NFg=this.QFg=this.OFg=null;this.ZFg=this.Re=this.SQg=this.RQg=this.L4=this.K4=this.IHa=this.u0=this.gA=0;this.q$=h;this.Kq=c;this.Uk=m;this.jdb=y;this.Fs=G;this.yc=U;this.pa=ja;this.jA=va;this.Nck=Ta;this.ia=Db;this.Sp=gc;this.KXa=null;this.Sdc=this.C5c=this.m5c=!1;this.hr=fb}Nu(a){if(!this.xv(a))return!1;
const b=a.Cc;if(Hl.r$b(b)){Ba.a.J(512497178,816,50,"drag from table row handle");this.aEb=!1;var c=Hl.hkj(b);if(!c)return!1;this.ae=vf.a(c).gb;this.zx=this.ae.sc(this.Re);if(!this.zx)return Ba.a.J(512497177,816,10,"OnDragStart : m_tableViewElement is null"),!1;this.ZFg=this.hr.i7d(this.zx,a.clientPoint);this.X_.Bgd(b);return!0}this.Z4=Hl.cgj(b);if(!this.Z4)return!1;c=Object(ua.a)(155,this.Z4.gb);this.Re=this.Z4.Ma;this.ae=c?c.getContainingTable():null;if(!this.ae)return!1;this.zx=this.ae.sc(this.Re);
this.KXa=this.Nck.P6d(this.ae);if(!this.zx||!this.KXa)return!1;this.kCb=Hl.fie(b);this.gve=Hl.Sie(b);this.Ndb=this.Z4.htmlElement.offsetHeight;this.Zec=this.bHa=a.clientPoint.y;this.X_.nl(21);this.J9.endEditing(!0,14);this.Vd=this.zx.Ck;this.C5c=this.m5c=this.Sdc=!1;this.aEb=!0;this.xVe()&&this.kgj(b);this.kSd(b);this.Sp&&this.ia.processAction(D.a.Cja,2);return!0}zw(a){this.aEb?(this.bHa=a.clientPoint.y,a=(this.uAf(this.bHa)-this.Ndb)*(this.kCb?-1:1)+this.PFg,this.Yva.style.top=a+"px"):(a=this.hr.i7d(this.zx,
a.clientPoint),this.zx.Mnh(this.ZFg,a));return!0}Zn(a){let b=null;a&&(b=this.q$.Ci("UserAction","PPTRowResize"),Ba.a.J(512497175,822,50,String.format("Start Row resize for table: {0}, IsComplex: {1}",this.zx.gb.sa(X.a.wFb,""),this.zx.gb.Lp())));if(this.aEb){var c=this.uAf(a?a.clientPoint.y:this.bHa),h=new t.GraphTransaction(15);if(this.xVe()&&this.Sdc&&this.C5c)Te.a.mark(11077),h.kd(this.ae),this.uUe(c);else{this.Z4.yLb(c);var m=this.Z4.htmlElement.offsetHeight;Te.a.mark(11077);var y=this.Z4.gb;h.kd(y);
c=this.J9.Ld;y.setValue(X.a.mu,c.rf(m,1));this.kCb&&m!==this.Ndb&&(m=this.Ndb-m)&&(this.Vd.setPosition(this.Vd.x,this.Vd.y+m,!0),m=c.rf(this.Vd.x,0),c=c.rf(this.Vd.y,1),y=this.zx.Ck.shapeNode,y.qy=m,y.ry=c)}this.Rsc();h.dispose();Fc.App.Kb.updateCommandUI();Te.a.mark(11078);this.end();this.ae?this.Fs.IZa(this.ae):Ba.a.J(512497174,822,15," OnDragEnd: m_tableNode is null. Unable to Redraw Diagonal borders.");b&&b.stop();a&&Ba.a.J(512497173,822,50,String.format("End Row resize for table: {0}, IsComplex: {1}",
this.zx.gb.sa(X.a.wFb,""),this.zx.gb.Lp()))}else a&&Fc.App.Kb.V5(a.clientPoint,a.Yf),this.X_.a1()}iu(a){a.U0e?(super.iu(a),this.aEb&&this.Rsc()):this.Zn(null)}end(){this.X_.a1();super.end()}uAf(a){a=this.Ndb+this.Kq.Pm(a-this.Zec)*(this.kCb?-1:1);if(this.xVe()&&this.Sdc&&this.C5c)a=Math.min(a,this.Ndb+this.SQg),a=Math.max(a,this.Ndb-this.RQg);else{var b=this.Uk.bIc(this.Z4.gb);b=this.Z4.Md.Ld.Me(b,1);a=Math.max(b,a)}return a}kSd(a){this.Yva=a;Sys.UI.DomElement.addCssClass(this.Yva,"ShowDashedLine");
this.PFg=a.offsetTop;this.TFg=a.style.marginTop;this.RFg=a.style.width;this.OFg=a.style.left;this.QFg=a.style.top;this.NFg=a.style.bottom;a.style.marginTop="auto";a.style.width="auto";a.style.right=a.style.left="0";a.style.bottom="auto";if(this.jdb){const b=Sm.a.V5b(a);b&&(a.style.left=-b.offsetLeft+"px",a.style.right=-(this.Z4.getBounds().width-b.offsetLeft-b.offsetWidth)+"px")}}Rsc(){Sys.UI.DomElement.removeCssClass(this.Yva,"ShowDashedLine");this.Yva.style.marginTop=this.TFg;this.Yva.style.width=
this.RFg;this.Yva.style.left=this.OFg;this.Yva.style.right="auto";this.Yva.style.top=this.QFg;this.Yva.style.bottom=this.NFg}kgj(a){this.Sdc=this.m5c=!1;if(this.ae&&Hl.LUa(a)){var b=null,c=null;({u5a:b,h6a:c}=this.jgj(a,b,c)).returnValue&&this.c5i(b,c)&&this.g8d()&&(a=this.yc.Ai(this.ae),b=this.yc.rk(this.ae),0<=this.u0&&this.u0<a&&0<=this.IHa&&this.IHa<a&&0<=this.K4&&this.K4<b&&0<=this.L4&&this.L4<b&&(this.Sdc=!0),this.C5c=0<this.u0||this.IHa<a-1?!0:!1)}}jgj(a,b,c){if(!Hl.LUa(a)||!this.ae)return{returnValue:!1,
u5a:b,h6a:c};a=Sm.a.V5b(a);a=vf.a(a);this.ama=Object(ua.a)(Tl.TableCellNode,a.gb);if(!this.ama)return{returnValue:!1,u5a:b,h6a:c};a=this.gA=this.ama.rowIndex-1;if(0>a||a>=this.yc.rk(this.ae))return{returnValue:!1,u5a:b,h6a:c};const h=this.ama.pi;if(0>h||h>=this.yc.Ai(this.ae))return{returnValue:!1,u5a:b,h6a:c};if(this.kCb)return{returnValue:!1,u5a:null,h6a:c};b=this.ae.qf(a,h);if(this.gve)return{returnValue:!1,u5a:b,h6a:null};c=this.ae.qf(a+1,h);return{returnValue:!0,u5a:b,h6a:c}}c5i(a,b){if(!this.ae||
!a||!b)return!1;this.u0=a.pi;if(0>this.u0||this.u0>=this.yc.Ai(this.ae))return!1;this.IHa=this.u0;var c=a.Ry();this.K4=c?c.rowIndex:-1;if(0>this.K4||this.K4>=this.yc.rk(this.ae))return!1;this.L4=this.u6d(b);if(0>this.L4||this.L4>=this.yc.rk(this.ae))return!1;a=(c=this.haj(a,b))?this.Sfj(a,b):!1;if(a=c&&a)this.m5c=this.uKj(b.rowIndex);return a}g8d(){if(!this.ae)return!1;const a=this.yc.rk(this.ae);if(0>this.K4||this.K4>=a||0>this.L4||this.L4>=a)return!1;this.RQg=this.d6d(this.ae,this.K4,this.gA)-this.CSa(this.ae,
this.K4);this.SQg=this.d6d(this.ae,this.L4,this.gA+1)-this.CSa(this.ae,this.L4);return!0}haj(a,b){if(!a||!b)return!1;a=a.W8a();const c=b.rowIndex;for(b=b.W8a();b&&a;){var h=b.Ry();if(b.isGhostCell&&h&&h.rowIndex!==c)break;this.u0--;if(h=a.Ry())this.K4=Math.max(this.K4,h.rowIndex);this.L4=Math.min(this.L4,this.u6d(b));a=a.W8a();b=b.W8a()}return!0}Sfj(a,b){if(!a||!b)return!1;a=a.k_();const c=b.rowIndex;for(b=b.k_();b&&(!b.isGhostCell||b.Ry().rowIndex===c);)this.IHa++,this.K4=Math.max(this.K4,a.Ry().rowIndex),
this.L4=Math.min(this.L4,this.u6d(b)),a=a.k_(),b=b.k_();return!0}uKj(a){let b=!0,c;if(0<this.u0)for((c=this.ae.qf(a,this.u0))&&(c=c.W8a());c;){if(!c.isGhostCell){b=!1;break}c=c.W8a()}if(this.IHa<this.ae.N7-1)for((c=this.ae.qf(a,this.IHa))&&(c=c.k_());c;){if(!c.isGhostCell){b=!1;break}c=c.k_()}return b}u6d(a){if(!a)return-1;let b=a;a.isGhostCell&&(b=a.Ry());return b&&(b=b.t6d(1))?b.rowIndex:-1}d6d(a,b,c){if(b>c)return this.d6d(a,c,b);if(!a||0>b||b>=this.yc.rk(a)||0>c||c>=this.yc.rk(a))return-1;for(a=
0;b<=c;b++)a+=this.KXa[b];return Math.floor(a)}CSa(a,b){a=this.Uk.pSd(a,b);return Math.floor(this.J9.Ld.Me(a,1))}uUe(a){if(!this.pa.bH()){var b=this.ama.w4b().Ry().A3b;b=yd.SelectionFactory.Qg(Object(ua.a)($f.a,b),0);this.pa.setSelection(b)}let c=b=-1;var h=-1;({XNf:b,lNf:c,mNf:h}=this.n7i(a-this.KXa[this.gA],this.KXa,b,c,h));if(this.m5c&&(b===this.gA&&Math.abs(c)>=this.CSa(this.ae,this.gA)||b===this.gA+1&&b<this.yc.rk(this.ae)&&Math.abs(h)>=this.CSa(this.ae,this.gA+1)||b===this.gA+1&&b===this.yc.rk(this.ae)-
1)){Ba.a.J(512497172,815,50,"DragAcrossRow: scenario-1, m_resizedRow = {0}, dragEndInRowIndex = {1}, distanceWithAboveBorder = {2}, distanceWithBelowBorder = {3}",this.gA.toString(),b.toString(),c.toString(),h.toString());h=rb.GraphIterator.nb(this.ae);this.yic(h,this.gA);a=h.currentNode;var m=this.KXa[this.gA];const G=a.sc(this.Re);Gd.moveToNextRow(h);h=h.currentNode;var y=this.KXa[this.gA+1];const U=h.sc(this.Re);y=m+y;m=this.J9.Ld;b===this.gA+1&&(c+=this.KXa[this.gA]);G.yLb(Math.floor(c));b=G.htmlElement.offsetHeight;
a.setValue(X.a.mu,m.rf(b,1));b=y-b;b=Math.max(b,this.CSa(this.ae,this.gA+1));U.yLb(Math.floor(b));h.setValue(X.a.mu,m.rf(U.htmlElement.offsetHeight,1))}else b>this.K4&&Math.abs(c)<this.CSa(this.ae,b)?(Ba.a.J(512497171,815,50,"DragAcrossRow: scenario-2, m_resizedRow = {0}, dragEndInRowIndex = {1}, distanceWithAboveBorder = {2}, distanceWithBelowBorder = {3}",this.gA.toString(),b.toString(),c.toString(),h.toString()),this.Jfb(b,this.gA+1)):b<this.L4&&Math.abs(h)<this.CSa(this.ae,b+1)?(Ba.a.J(512497170,
815,50,"DragAcrossRow: scenario-3, m_resizedRow = {0}, dragEndInRowIndex = {1}, distanceWithAboveBorder = {2}, distanceWithBelowBorder = {3}",this.gA.toString(),b.toString(),c.toString(),h.toString()),this.Jfb(b+1,this.gA+1)):(Ba.a.J(512497169,815,50,"DragAcrossRow: scenario-4, m_resizedRow = {0}, dragEndInRowIndex = {1}, distanceWithAboveBorder = {2}, distanceWithBelowBorder = {3}",this.gA.toString(),b.toString(),c.toString(),h.toString()),this.akl(b,c,h)),this.Fs.YOe(this.ae),b=rb.GraphIterator.nb(this.ae),
this.Fs.t2e(b),this.ae.qda(511),this.jA.l8b(this.ae)}n7i(a,b,c,h,m){if(!a)return c=this.gA,h=b[this.gA],{XNf:c,lNf:h,mNf:0};h=0;if(0<a){for(c=this.gA;h<a;)c++,h+=b[c];m=h-a;h=b[c]-m}else{for(c=this.gA+1;h>a;)c--,h-=b[c];h=a-h;m=b[c]-h}return{XNf:c,lNf:h,mNf:m}}Jfb(a,b){if(b!==a){var c=this.e5i(b-1);b=this.ae.qf(b,this.u0);a=this.ae.qf(a,this.u0);for(let h=this.u0;h<=this.IHa;h++)this.VCe(c[h],b,a),b=b.k_(),a=a.k_()}}VCe(a,b,c){if(c.isGhostCell){var h=b.colSpan,m=a.rowSpan+c.rowIndex-b.rowIndex,y=
a.rowSpan+b.rowSpan-m;nm.c(Object(ua.a)($f.a,b),Object(ua.a)($f.a,c),this.Fs.ZSd);nm.c(Object(ua.a)($f.a,b),Object(ua.a)($f.a,c),[X.a.OJa]);var G=rb.GraphIterator.nb(c);G.gf();var U=new rb.GraphIterator;U.set(Object(ua.a)($f.a,b));U.Bb(1)&&nm.h(G,null,1,1,U,-1);c.isGhostCell=b.isGhostCell;this.A2d(G);b.ao(X.a.rowSpan,X.a.colSpan);b.isGhostCell=!0;c.isGhostCell||(c.colSpan=h,c.rowSpan=y);a.pi===G.xq.pi&&(a.rowSpan=m)}}A2d(a){const b=a.currentNode.eb(X.a.rowId),c=a.currentNode.eb(X.a.cellId);for(a=
P.a.jv(a);a.moveNext();){const h=a.currentNode.sa(X.a.cellId,null);a.currentNode.sa(X.a.rowId,null)&&a.currentNode.setValue(X.a.rowId,b);h&&a.currentNode.setValue(X.a.cellId,c)}}akl(a,b,c){var h=rb.GraphIterator.nb(this.ae);this.yic(h,a);const m=h.currentNode;h=this.Fs.gde(h);const y=this.J9.Ld,G=m.sc(this.Re);G.yLb(Math.floor(b));m.setValue(X.a.mu,y.rf(G.htmlElement.offsetHeight,1));c=Math.max(c,this.CSa(this.ae,a+1));h.setValue(X.a.mu,y.rf(Math.floor(c),1));b=this.gA+1;a+=1;a<=b&&(b+=1);this.Jfb(a,
b)}yic(a,b){if(!(14!==a.ri||0>b||b>=this.yc.rk(a.currentNode)))for(Gd.moveToFirstRow(a);0<b--;)Gd.moveToNextRow(a)}e5i(a){a=this.ae.qf(a,this.u0);const b=Array(this.yc.Ai(this.ae));for(let c=this.u0;c<=this.IHa;c++)b[c]=a.Ry(),a=a.k_();return b}xVe(){return!!this.ae&&this.ae.Lp()&&!this.kCb&&!this.gve}}Object(n.a)(iL,"PowerpointRowHandleDragAdapter",ED,[]);class FD{constructor(a,b,c,h){this.jA=h;this.CGa=a;this.CGa.ik(Object(F.a)(this,this.hh,"onPropertyChanged"))}hh(a,b){a=b.property;(b=Object(ua.a)(123,
b.node))&&(a===X.a.colSpan||a===X.a.rowSpan)&&(b=b.getContainingTable())&&(this.jA.Jfk(b),b.TY=null)}dispose(){this.CGa.Cm(Object(F.a)(this,this.hh,"onPropertyChanged"))}}Object(n.a)(FD,"TableCellNodeBehavior",null,[106]);class jL extends Hc.a{constructor(a,b){super(a,b,"TableCellSelected")}yXg(a){this.selected&&!Sys.UI.DomElement.containsCssClass(a,this.t_a)?Sys.UI.DomElement.addCssClass(a,this.t_a):!this.selected&&Sys.UI.DomElement.containsCssClass(a,this.t_a)&&Sys.UI.DomElement.removeCssClass(a,
this.t_a)}}Object(n.a)(jL,"TableCellSelectionBehavior",Hc.a,[453,474]);class kL extends Sys.EventArgs{constructor(a){super();this.A0h=a}get tableCellNode(){return this.Pnl.tableCellNode}get Pnl(){return this.A0h}}Object(n.a)(kL,"TableCellViewElementLockedEventArgs",Sys.EventArgs,[]);class GD extends Sys.EventArgs{constructor(a){super();this.MHi=a}}Object(n.a)(GD,"TypingLockStatusChangedEventArgs",Sys.EventArgs,[]);var Gp=d(186);class Zs extends Gv{constructor(a,b,c,h,m,y,G,U,ja,va,Ta,fb,Db,gc,hc){super(a,
b,h,m,vb.a.instance.resolve("Box4.ITableCellReader"),vb.a.instance.resolve("Box4.IParagraphReader"),vb.a.instance.resolve("Box4.IOutlineElementNavigator"),vb.a.instance.resolve("Box4.ITableNavigator"),vb.a.instance.resolve("Box4.IOutlineElementReader"),vb.a.instance.resolve("Box4.Styles.IStyleReader"),vb.a.instance.rb("Box4.IFeatureHelper"),new jL(a,b),vb.a.instance.rb("Box4.Styles.ITableCellspacingReader"),vb.a.instance.resolve("Box4.TableCellViewElementSettings"));this.zwe=this.Awe=this.R$c=this.Y$c=
this.LEb=this.Ch=this.ffb=this.jO=this.sO=this.v0=null;this.Qla=!1;this.tla=null;this.mj=Object(ua.a)(123,b);this.Ea=c;this.jA=y;this.Uk=G;this.Lc=U;this.cGa=ja;this.yc=va;this.jdb=Ta;this.ACb=fb;this.j0=Db;this.u6c=gc;this.Edc=Rd.a("PPTOEnableTableDiagonalBorders");this.pa=hc;this.Wua=this.aZf();(this.jdb||this.ACb)&&Sys.UI.DomElement.addCssClass(this.htmlElement,"TableCellRelativePosition")}v6(){}Dy(a){super.Dy(a);this.jdb&&!this.Md.Vl&&this.W4k()}CDa(a,b){return a&&a.length&&"none"!==a&&b&&b.length&&
b.endsWith("px")?parseFloat(b.substr(0,b.length-2)):0}Hig(){const a=this.pa.J1i(),b=this.mj.getContainingTable();return b?Array.contains(a,b):!1}iOk(a){switch(a){case "Top":this.Ch.style.top="-0.5px";this.Ch.style.borderTopWidth="1px";break;case "Right":this.Ch.style.right="-0.5px";this.Ch.style.borderRightWidth="1px";break;case "Bottom":this.Ch.style.bottom="-0.5px";this.Ch.style.borderBottomWidth="1px";break;case "Left":this.Ch.style.left="-0.5px",this.Ch.style.borderLeftWidth="1px"}}hOk(a){switch(a){case "Top":this.Ch.style.top=
"0px";this.Ch.style.borderTopWidth="0px";break;case "Right":this.Ch.style.right="0px";this.Ch.style.borderRightWidth="0px";break;case "Bottom":this.Ch.style.bottom="0px";this.Ch.style.borderBottomWidth="0px";break;case "Left":this.Ch.style.left="0px",this.Ch.style.borderLeftWidth="0px"}}Fjd(a){this.Ch&&(this.Hig()?this.iOk(a):this.hOk(a))}U4k(a,b,c){const h=!Rd.a("TableBorderOutsideBorderHalfClippingDisabled");this.o0d();var m=rb.GraphIterator.nb(this.gb);m.rc(14);var y=m.Ng(14);m=this.yc.rk(y);y=
this.yc.Ai(y);c=c?c.jV():"";switch(a){case "Top":b=this.Md.Ld.Me(b,1);!this.mj.rowIndex&&h?(this.Ch.style.top="0px",this.Ch.style.borderTopWidth=b/2+"px"):(this.Ch.style.top=-b/2+"px",this.Ch.style.borderTopWidth=b+"px");this.Ch.style.borderTopColor=c;break;case "Bottom":b=this.Md.Ld.Me(b,1);this.mj.rowIndex+this.mj.rowSpan===m&&h?(this.Ch.style.bottom="0px",this.Ch.style.borderBottomWidth=b/2+"px"):(this.Ch.style.bottom=-b/2+"px",this.Ch.style.borderBottomWidth=b+"px");this.Ch.style.borderBottomColor=
c;break;case "Left":b=this.Md.Ld.Me(b,0);!this.mj.pi&&h?(this.Ch.style.left="0px",this.Ch.style.borderLeftWidth=b/2+"px"):(this.Ch.style.left=-b/2+"px",this.Ch.style.borderLeftWidth=b+"px");this.Ch.style.borderLeftColor=c;break;case "Right":b=this.Md.Ld.Me(b,0);this.mj.pi+this.mj.colSpan===y&&h?(this.Ch.style.right="0px",this.Ch.style.borderRightWidth=b/2+"px"):(this.Ch.style.right=-b/2+"px",this.Ch.style.borderRightWidth=b+"px");this.Ch.style.borderRightColor=c;break;case "DiagonalUp":this.Edc&&
(b=this.Md.Ld.Me(b,0),this.fOf(a,b,c));break;case "DiagonalDown":this.Edc&&(b=this.Md.Ld.Me(b,0),this.eOf(a,b,c))}this.Crh()}fOf(a,b,c){this.ZPf();this.Awe||(this.Awe=this.GHf());this.jph(this.Awe,a,b,c)}eOf(a,b,c){this.ZPf();this.zwe||(this.zwe=this.GHf());this.jph(this.zwe,a,b,c)}GHf(){const a=new ch.a;this.Y$c.appendChild(a.xa);this.Vo(a.xa);return a}jph(a,b,c,h){b=this.KBi(b);a.i1(b);a.Su(h);a.jr(c)}KBi(a){switch(a){case "DiagonalUp":return String.format("M 0 {0} L {1} 0",this.w4d(),this.y4d());
case "DiagonalDown":return String.format("M 0 0 L {0} {1}",this.y4d(),this.w4d())}Ba.a.J(571479943,822,10,"CreateDAttrib : Unknown borderType "+a);return null}ZPf(){this.o0d();this.LEb||(this.LEb=this.Md.hp(wa.a.div),this.LEb.className="PPTTableDiagonalBorder",this.ffb.appendChild(this.LEb),this.Vo(this.LEb));this.R$c||(this.R$c=new Le.a,this.Y$c=this.R$c.xa,this.LEb.appendChild(this.Y$c),this.Vo(this.Y$c));this.R$c.qya(String.format("0 0 {0} {1}",this.y4d(),this.w4d()))}o0d(){this.ffb||(this.ffb=
this.Md.hp(wa.a.div),this.ffb.className="PPTTableBorderContainer",this.htmlElement.insertBefore(this.ffb,this.htmlElement.firstChild),this.Vo(this.ffb));this.Ch||(this.Ch=this.Md.hp(wa.a.div),this.Ch.className="PPTTableBorder",this.ffb.appendChild(this.Ch),this.Vo(this.Ch))}Crh(){this.u6c&&Rd.a("MergeDifferentBordersFixEnabled")?this.Ch.style.zIndex=this.Jzb(this.mj)?"1":(this.aUa(this.mj.Qya)||this.aUa(this.mj.iga))&&(this.aUa(this.mj.Pya)||this.aUa(this.mj.jga))?"3":"2":this.Ch.style.zIndex=(this.aUa(this.mj.Qya)||
this.aUa(this.mj.iga))&&(this.aUa(this.mj.Pya)||this.aUa(this.mj.jga))?"1":"0"}Jzb(a){return 1<a.rowSpan||1<a.colSpan}hKj(a){return"DiagonalUp"===a||"DiagonalDown"===a}xKa(a,b,c,h){const m=this.u6c&&Rd.a("MergeDifferentBordersFixEnabled")&&this.Jzb(this.mj);this.u6c&&!this.hKj(a)&&this.Hig()&&0===b&&(b=1,c="rgb(255, 255, 255)");switch(a){case "Top":m&&!this.wHj()&&(b=0);this.Ch.style.borderTopWidth=b+"px";this.Ch.style.borderTopColor=c;this.Ch.style.borderTopStyle=h;this.Ch.style.top=-b/2+"px";break;
case "Right":m&&!this.vHj()&&(b=0);this.Ch.style.borderRightWidth=b+"px";this.Ch.style.borderRightColor=c;this.Ch.style.borderRightStyle=h;this.Ch.style.right=-b/2+"px";break;case "Bottom":m&&!this.pHj()&&(b=0);this.Ch.style.borderBottomWidth=b+"px";this.Ch.style.borderBottomColor=c;this.Ch.style.borderBottomStyle=h;this.Ch.style.bottom=-b/2+"px";break;case "Left":m&&!this.rHj()&&(b=0);this.Ch.style.borderLeftWidth=b+"px";this.Ch.style.borderLeftColor=c;this.Ch.style.borderLeftStyle=h;this.Ch.style.left=
-b/2+"px";break;case "DiagonalUp":this.Edc&&this.fOf(a,b,c);break;case "DiagonalDown":this.Edc&&this.eOf(a,b,c)}}y4d(){var a=0;for(let b=0;b<this.mj.colSpan;b++)a+=this.mj.getContainingTable().G4d[this.mj.pi+b];a=this.Md.Ld.Me(a,0);return Math.round(100*a)/100}w4d(){var a=this.yc.bTc(this.mj.getContainingTable(),this.mj.rowIndex,this.mj.rowIndex+this.mj.rowSpan-1);let b=0;for(let c of a)Object(za.a)(155,c)?b+=c.sa(X.a.mu,0):Ba.a.J(571479944,822,15,String.format("GetCellHeight : node {0} is not of the type ITableRowNode",
c));this.mj.marginTop+this.mj.marginBottom>b&&Ba.a.J(559724693,822,15,String.format("GetCellHeight :: degenerate case : cell height : {0} is less than sum of margins top : {1}  and bottom : {2} ",b,this.mj.marginTop,this.mj.marginBottom));b=Math.max(b,this.mj.marginTop+this.mj.marginBottom);a=this.Md.Ld.Me(b,1);return Math.round(100*a)/100}wHj(){if(!this.mj.rowIndex)return!0;const a=this.mj.getContainingTable();if(!a)return!0;const b=this.mj.rowIndex-1;var c=this.mj.pi;const h=c+this.mj.colSpan-1;
for(;c<=h;c++){const m=a.qf(b,c);if(m&&(m.isGhostCell||this.Jzb(m)))return!0}return!1}rHj(){if(!this.mj.pi)return!0;const a=this.mj.getContainingTable();if(!a)return!0;const b=this.mj.pi-1;var c=this.mj.rowIndex;const h=c+this.mj.rowSpan-1;for(;c<=h;c++){const m=a.qf(c,b);if(m&&(m.isGhostCell||this.Jzb(m)))return!0}return!1}vHj(){const a=this.mj.getContainingTable();if(!a||this.mj.pi+this.mj.colSpan===this.yc.Ai(a))return!0;const b=this.mj.pi+this.mj.colSpan;var c=this.mj.rowIndex;const h=c+this.mj.rowSpan-
1;for(;c<=h;c++){const m=a.qf(c,b);if(m&&(m.isGhostCell||this.Jzb(m)))return!0}return!1}pHj(){const a=this.mj.getContainingTable();if(!a||this.mj.rowIndex+this.mj.rowSpan===this.yc.rk(a))return!0;const b=this.mj.rowIndex+this.mj.rowSpan;var c=this.mj.pi;const h=c+this.mj.colSpan-1;for(;c<=h;c++){const m=a.qf(b,c);if(m&&(m.isGhostCell||this.Jzb(m)))return!0}return!1}W4k(){var a=!Rd.a("TableBorderOutsideBorderHalfClippingDisabled");this.o0d();if(a){a=rb.GraphIterator.nb(this.gb);a.rc(14);var b=a.Ng(14);
a=this.yc.rk(b);b=this.yc.Ai(b);var c=this.CDa(this.htmlElement.style.borderLeft,this.htmlElement.style.borderLeftWidth);this.xKa("Left",c,this.htmlElement.style.borderLeftColor,this.htmlElement.style.borderLeftStyle);this.mj.pi?this.Ch.style.left=-c/2+"px":(this.Ch.style.left="0px",this.Ch.style.borderLeftWidth=c/2+"px");c=this.CDa(this.htmlElement.style.borderRight,this.htmlElement.style.borderRightWidth);this.xKa("Right",c,this.htmlElement.style.borderRightColor,this.htmlElement.style.borderRightStyle);
this.mj.pi+this.mj.colSpan===b?(this.Ch.style.right="0px",this.Ch.style.borderRightWidth=c/2+"px"):this.Ch.style.right=-c/2+"px";b=this.CDa(this.htmlElement.style.borderTop,this.htmlElement.style.borderTopWidth);this.xKa("Top",b,this.htmlElement.style.borderTopColor,this.htmlElement.style.borderTopStyle);this.mj.rowIndex?this.Ch.style.top=-b/2+"px":(this.Ch.style.top="0px",this.Ch.style.borderTopWidth=b/2+"px");b=this.CDa(this.htmlElement.style.borderBottom,this.htmlElement.style.borderBottomWidth);
this.xKa("Bottom",b,this.htmlElement.style.borderBottomColor,this.htmlElement.style.borderBottomStyle);this.mj.rowIndex+this.mj.rowSpan===a?(this.Ch.style.bottom="0px",this.Ch.style.borderBottomWidth=b/2+"px"):this.Ch.style.bottom=-b/2+"px"}else a=this.CDa(this.htmlElement.style.borderLeft,this.htmlElement.style.borderLeftWidth),this.xKa("Left",a,this.htmlElement.style.borderLeftColor,this.htmlElement.style.borderLeftStyle),a=this.CDa(this.htmlElement.style.borderRight,this.htmlElement.style.borderRightWidth),
this.xKa("Right",a,this.htmlElement.style.borderRightColor,this.htmlElement.style.borderRightStyle),a=this.CDa(this.htmlElement.style.borderTop,this.htmlElement.style.borderTopWidth),this.xKa("Top",a,this.htmlElement.style.borderTopColor,this.htmlElement.style.borderTopStyle),a=this.CDa(this.htmlElement.style.borderBottom,this.htmlElement.style.borderBottomWidth),this.xKa("Bottom",a,this.htmlElement.style.borderBottomColor,this.htmlElement.style.borderBottomStyle);this.dOf();this.u6c&&this.Crh();
this.htmlElement.style.border=""}dOf(){this.Edc&&(this.iqe&&this.iph("DiagonalUp",this.iqe),this.hqe&&this.iph("DiagonalDown",this.hqe))}aUa(a){return!!a}iph(a,b){const c=b.split(" ");if(3!==c.length)Ba.a.J(570832849,822,10,String.format("SetDiagonalBorderProps : split of string [ {0} ] has greater or less than 3 sub-parts",b));else{var h=c[0];b=this.CDa(b,c[1]);this.xKa(a,b,c[2],h)}}Dtc(a,b,c,h,m,y,G){if(!this.j0||this.Ea.Zm(this.mj).eb(X.a.isResizable))this.ACb?this.Wzl(m,y,G):this.Vzl(a,b,c,h,
m,y,G)}Wzl(a,b,c){this.eGa||(this.eGa=this.EKc(),this.Vo(this.eGa));this.v0||(this.v0=this.DQa(),this.Vo(this.v0));a?Sys.UI.DomElement.addCssClass(this.v0,"First"):Sys.UI.DomElement.removeCssClass(this.v0,"First");b^!!this.sO&&(b?(this.sO=this.DQa(),this.Vo(this.sO)):(this.sJb(this.sO),this.sO=null));this.sO&&Sys.UI.DomElement.addCssClass(this.sO,"Last");c^!!this.jO&&(c?(this.jO=this.EKc(),this.Vo(this.jO)):(this.sJb(this.jO),this.jO=null));this.jO&&Sys.UI.DomElement.addCssClass(this.jO,"FirstLeft")}Vzl(a,
b,c,h,m,y,G){super.Dtc(a,b,c,h,m,y,G);this.Xsb&&this.Vo(this.Xsb);this.v0||(this.v0=this.DQa(),this.Vo(this.v0));this.v0.style.left=a+"px";this.v0.style.top=b+"px";this.v0.style.width=c+"px";m?Sys.UI.DomElement.addCssClass(this.v0,"First"):Sys.UI.DomElement.removeCssClass(this.v0,"First");y^!!this.sO&&(y?(this.sO=this.DQa(),this.Vo(this.sO)):(this.sJb(this.sO),this.sO=null));this.sO&&(this.sO.style.bottom="0",this.sO.style.left=a+"px",this.sO.style.width=c+"px",Sys.UI.DomElement.addCssClass(this.sO,
"Last"));G^!!this.jO&&(G?(this.jO=this.EKc(),this.Vo(this.jO)):(this.sJb(this.jO),this.jO=null));this.jO&&(this.jO.style.left="0",this.jO.style.top=b+"px",this.jO.style.height=h+"px",Sys.UI.DomElement.addCssClass(this.jO,"FirstLeft"));this.jdb&&(this.v0.style.left="0",this.v0.style.top="0",this.Xsb&&(this.Xsb.style.left=c+"px",this.Xsb.style.top="0",this.Xsb.style.height=h+"px"),this.sO&&(this.sO.style.left="0"),this.jO&&(this.jO.style.top="0"))}Woh(){var a=this.Md.Ld,b=a.Me(this.Uk.ata(this.gb,3),
1);this.Sia.style.paddingTop=b+"px";b=a.Me(this.Uk.ata(this.gb,0),1);this.Sia.style.paddingBottom=b+"px";b=a.Me(this.Uk.ata(this.gb,1),0);this.Sia.style.paddingLeft=b+"px";a=a.Me(this.Uk.ata(this.gb,2),0);this.Sia.style.paddingRight=a+"px"}Y4k(a,b){const c=this.Md.Ld;switch(b){case M.a.Lrc:a=c.t_(a.marginTop,1);this.Sia.style.paddingTop=a+"px";break;case M.a.Frc:a=c.t_(a.marginBottom,1);this.Sia.style.paddingBottom=a+"px";break;case M.a.Grc:a=c.t_(a.marginLeft,0);this.Sia.style.paddingLeft=a+"px";
break;case M.a.Krc:a=c.t_(a.marginRight,0),this.Sia.style.paddingRight=a+"px"}}IU(){var a=this.Uk.ata(this.gb,1),b=this.Uk.ata(this.gb,2);const c=this.Uk.o4b(this.gb,5),h=this.Uk.o4b(this.gb,6);var m=this.Md.Ld;a=m.Me(a+c,0);b=m.Me(b+h,0);m=m.Me(this.Uk.pAf(this.gb),0);return new Ng.a(a,m,b)}yFh(){this.htmlElement.style.background=this.jA.oYf(this.gb)}vU(){if(!this.Ch)super.vU();else if(!this.Md.Vl&&this.YA){const a=Object(ua.a)(453,this.BR);a&&a.yXg(this.Ch)}}DQa(){const a=this.LIf();a.className=
"TableRowResizeHandle";return a}sJb(a){Y.a.VJa(a);La.a.XO(a)}get tableCellNode(){return this.mj}get X0c(){return this.tla}get Ck(){this.Wua||(this.Wua=this.aZf());return this.Wua}set Ck(a){this.Wua=a}get $p(){return this.Qla}CLb(a){this.Qla=a;this.tableCellNode.tyb=a}lock(a){this.$p&&this.tla===a||(this.Ck.Kqd(),this.tla=a,this.CLb(!0),this.Lc.sz(new Gp.a(7)),this.cGa.ueh(new GD(a)),this.cGa.RKk(new kL(this)))}unlock(){this.$p&&(this.tla=null,this.CLb(!1),this.Lc.sz(new Gp.a(7)),this.cGa.ueh(new GD(null)))}aZf(){let a=
null;const b=this.Ea.Zm(this.mj);b&&(a=Object(ua.a)(117,b.tg(this.Ma)));return a}}Object(n.a)(Zs,"TableCellViewElement",Gv,[454,455,456,106]);var Oz=d(298),wQ=d(498);class dm extends Gh{constructor(a,b,c,h,m,y,G,U,ja,va,Ta){super(a,b);Gh.J2a=()=>Uq.ORf(Eh.a.create());this.Uk=c;this.Ll=h;this.rJ=y;this.MXa=m;this.yc=G;this.Y4=U;this.JXa=ja;this.vCb=va;this.Re=Ta;this.B5c=Rd.a("PPTOEnableTableDiagonalBorders")}iDf(a,b){Gh.Zri(a,b,rd.TableReader.Ai(a))}OIf(a,b,c,h=null,m=!1){const y=a.parentNode.eb(X.a.shapeId);
a.currentNode.setValue(X.a.shapeId,y);for(var G=0;G<b;++G){var U=new wQ.a;a.Cl(U,1);U.setValue(X.a.shapeId,y);U.setValue(X.a.rowId,Eh.a.create())}b=null;G=!0;a.Bb(1);do{U=a.currentNode.eb(X.a.rowId);for(let ja=0;ja<c;++ja){const va=this.asa();a.Cl(va,1);va.setValue(X.a.shapeId,y);va.setValue(X.a.rowId,U);va.setValue(X.a.cellId,Eh.a.create());({vnh:b,isFirst:G}=this.gUf(a,va,m,h,b,G));Gd.returnToContainingRow(a)}}while(a.Cj(1))}IZa(a){if(this.B5c&&a&&(a=this.yc.DF(a)))for(const b of a)b&&!b.isGhostCell&&
(a=Object(ua.a)(Zs,b.sc(this.Re)))&&a.dOf()}DQe(a,b,c,h,m){var y=this.rJ.TQc(a);for(var G=0;G<y.length;G++){const U=this.Uk.gsb(a,G);y[G]=Math.max(U,y[G]*b)}a.setValue(kb.a.Tu,y);if(1!==c)for((new rb.GraphIterator).set(a),b=a?a.firstRow:null,c=0;b;){y=m.rf(h.Zfj(c),1);G=this.Uk.pSd(a,c);y<=G&&(y=0);b.setValue(X.a.mu,y);if(b.uhg())break;else b=b.EIa;c++}this.IZa(a)}T4k(a,b){a=this.yc.DF(a);for(let c=0;c<a.length;c++){const h=a[c].cellShading;h.anchorField=b;a[c].cellShading=h;a[c].Loa=b}}S4k(a,b){for(let h=
0;h<a.length;h++){const m=a.ga(h);for(let y=0;y<m.length;y++){var c=m.ga(y).iterator;c.rc(16);c.Ng(16);c=c.xq;const G=c.cellShading;G.anchorField=b;c.cellShading=G;c.Loa=b}}}h8b(a,b,c,h,m){super.h8b(a,b,c,h,m);c=[];Array.add(c,X.a.mu);nm.b(h,b,c);c=a.currentNode.eb(X.a.shapeId);const y=a.xq.eb(X.a.sid);a=a.xq.eb(X.a.cid);const G=Uq.GGf(Eh.a.create());b.setValue(X.a.sid,y);b.setValue(X.a.cid,a);b.setValue(X.a.shapeId,c);b.setValue(X.a.rowId,G);this.eAl(h,b,m)}X7b(a,b,c,h,m){super.X7b(a,b,c,h,m);return this.mdd(a.currentNode,
b,c,h,!1,!1)}BXb(a,b,c,h,m){super.BXb(a,b,c,h,m);return this.mdd(a.currentNode,b,c,h,m,!1)}get ZSd(){if(!dm.laa){dm.laa=[];let a,b,c;for(const h of dm.d2c)if(this.B5c||2!==h&&1!==h)({OPa:b,i6a:a,Mrb:c}=Fp.LSa(h)),Array.add(dm.laa,b),Array.add(dm.laa,a),Array.add(dm.laa,c);Array.add(dm.laa,kb.a.BE);Array.add(dm.laa,X.a.cellShading);Array.add(dm.laa,jb.a.bNb);Array.add(dm.laa,jb.a.dNb);Array.add(dm.laa,jb.a.eNb);Array.add(dm.laa,jb.a.aNb);Array.add(dm.laa,X.a.hP)}return dm.laa}mdd(a,b,c,h,m,y){c=y?
this.srj(b,c,m):this.trj(b,c,h,m);nm.c(c,b,this.ZSd);h=a.eb(X.a.cid);y=a.eb(X.a.shapeId);const G=c.eb(X.a.cellId),U=a.eb(X.a.rowId);b.setValue(X.a.sid,a.eb(X.a.sid));b.setValue(X.a.cid,h);b.setValue(X.a.shapeId,y);b.setValue(X.a.rowId,U);m?b.setValue(X.a.cellId,G):b.setValue(X.a.cellId,b.id.Aq);return c}Ntf(a,b,c,h,m,y){a=a.currentNode;const G=Array(c);let U=0,ja=0,va=0;for(;U<h;U++)G[U]=b[U],ja+=G[U];for(m=m?b[h]:b[h-1];U<h+y;U++)G[U]=m,va+=G[U];for(;U<c;U++)G[U]=b[U-y],ja+=G[U];b=ja/(va+ja);for(U=
0;U<c;U++)G[U]=Math.max(G[U]*b,this.Uk.gsb(a,U));return G}ojc(a,b,c,h,m){super.ojc(a,b,c,h,m);var y=a.eb(X.a.Dkb);m=Array(y.length+h);let G=0;for(;G<b;G++)m[G]=y[G];for(;G<b+h;G++)m[G]=dm.RDi();for(;G<m.length;G++)m[G]=y[G-h];a.setValue(X.a.Dkb,m);y=c?m[b+h]:m[b-1];a=Object(ua.a)(Oz.TableNode,a);this.Bxl(a,y,m.slice(b,h+b),b,c);if(this.vCb)for(m=this.JXa.create(a),h=b+h,y=(!c||!b)&&b<this.yc.Ai(a)-1,b+=c?1:0,h+=c?1:0,c=b;c<h;c++)this.Y4.D2d(a,m,c,0,this.yc.rk(a),y)}dGe(a,b,c,h){super.dGe(a,b,c,h);
if(this.vCb){a=Object(ua.a)(175,a);const m=this.JXa.create(a);h=c+h;const y=(!b||!c)&&c<this.yc.rk(a)-1;c+=b?1:0;h+=b?1:0;for(b=c;b<h;b++)this.Y4.B2d(a,m,b,0,this.yc.Ai(a),y)}}yFe(a,b,c){super.yFe(a,b,c);this.vOb(a,X.a.complexTable);this.vCb&&(a=Object(ua.a)(175,a.currentNode),c=this.JXa.create(a),this.Y4.B2d(a,c,b,0,this.yc.Ai(a),!0))}xFe(a,b,c){super.xFe(a,b,c);const h=a.currentNode.eb(X.a.Dkb),m=Array(h.length-c);let y=0;for(;y<b;y++)m[y]=h[y];for(;y<m.length;y++)m[y]=h[y+c];a.currentNode.setValue(X.a.Dkb,
m);this.vOb(a,X.a.complexTable);this.vCb&&(a=Object(ua.a)(175,a.currentNode),c=this.JXa.create(a),this.Y4.D2d(a,c,b,0,this.yc.rk(a),!0))}eAl(a,b,c){b.setValue(X.a.NNk,a.eb(X.a.rowId));b.setValue(X.a.insertBefore,c)}Bxl(a,b,c,h,m){a=a.firstRow;do for(let y=0;y<c.length;++y){const G=rb.GraphIterator.nb(a),U=G.Zp(h+y,1);U.setValue(X.a.MNk,b);U.setValue(X.a.insertBefore,m);U.setValue(X.a.cellId,c[y]);dm.wqh(G,X.a.cellId,c[y])}while(a=a.EIa)}asa(){const a=super.asa();a.isGhostCell=!0;a.rowSpan=1;a.colSpan=
1;return a}eFe(a,b){this.eqj(a,b,c=>{c.currentNode.isGhostCell=!1;Gh.Nx.f8b(c,null,!0);const h=c.currentNode.eb(X.a.rowId),m=c.currentNode.eb(X.a.cellId);for(c=P.a.jv(c);c.moveNext();){const y=c.currentNode.sa(X.a.cellId,null);c.currentNode.sa(X.a.rowId,null)&&c.currentNode.setValue(X.a.rowId,h);y&&c.currentNode.setValue(X.a.cellId,m)}})}Xjd(a){rd.TableReader.Cu(a.currentNode)&&this.Igh(a,b=>b.Lh(X.a.mu),(b,c)=>{b.te(X.a.mu,c)},X.a.complexTable)}YOe(a){a&&(a=rb.GraphIterator.nb(a),this.Xjd(a,0))}soa(a,
b){if(a)for(a=this.Ll.Xra(a),a.$l(c=>15===c.ri,null);a.moveNext();){const c=Object(ua.a)(155,a.iterator.currentNode),h=this.MXa.k9a(c);c.setValue(X.a.mu,h*b)}}KKa(a,b){if(a&&14===a.type){const c=this.rJ.TQc(a);for(let h=0;h<c.length;h++){const m=this.Uk.gsb(a,h);c[h]=Math.max(m,c[h]*b)}a.setValue(kb.a.Tu,c)}}hrh(a,b){if(a&&0<a.length)for(const c of a)c.setValue(X.a.mu,te.a.MW(b))}grh(a,b,c){if(a&&b&&0<b.length){const h=this.rJ.TQc(a);for(let m=0;m<b.length;m++)h[b[m]]=te.a.MW(c);a.setValue(kb.a.Tu,
h)}}gde(a){const b=new rb.GraphIterator;b.Rc(a);var c=b.currentNode;b.Bb(1);const h=a.zc();this.pza(a);const m=zs.a.instance.createInstance(393251);this.h8b(a,m,c,c,!1);a.Qk(m);c=this.yc.Ai(h);for(let y=0;y<c;++y){const G=this.asa();super.BXb(a,G,b.currentNode,!1,!0);this.mdd(m,G,b.currentNode,!1,!0,!0);b.Af(1)}this.jLb(h,this.yc.rk(h)+1);return a.currentNode}fde(a){const b=rb.GraphIterator.nb(a.GHh());let c=this.yc.Ai(b.currentNode);var h=this.rJ.SQc(Object(ua.a)(123,a.currentNode));a=h+1;this.pza(b);
b.Bb(1);do{const m=b.Zp(h,1);b.zc();const y=this.asa();super.X7b(b,y,m,!1,!1);this.mdd(b.currentNode,y,m,!1,!1,!0)}while(b.Cj(1));(h=b.currentNode.sa(kb.a.Tu,null))&&(h=Ma.a.clone(h));this.UKb(b.currentNode,++c);h&&(Array.insert(h,a,0),b.currentNode.setValue(kb.a.Tu,h));this.ojc(b.currentNode,a,!1,1,null)}t2e(a){this.vOb(a,X.a.complexTable)}srj(a,b,c){let h=b;const m=b.zIa;if(m)if(b.isGhostCell)Gh.CSc(m,!c)||Gh.fjb(m.controlCell,c,Gh.Jvb(m.controlCell,c)+1);else{let y=Gh.Jvb(b,c);1<y&&(h=Gh.A8i(m,
!c));Gh.fjb(b,c,y+1)}else Gh.fjb(b,c,2);a.isGhostCell=!0;return h}static wqh(a,b,c){a.currentNode.te(b,c);let h=a.Gi();if(h){for(;h;)dm.wqh(a,b,c),h=a.kp();a.zc()}}static RDi(){return Uq.GGf(Eh.a.create())}}dm.laa=null;dm.d2c=[5,6,7,0,2,1];Object(n.a)(dm,"TableEditor",Gh,[1244]);const lL=(a,b,c,h,m)=>{const y=m.BY,G=m.Nra;var U=m.tableLook;const ja=0<(U&32);m=0<(U&128);const va=0<(U&64),Ta=0<(U&256),fb=ja?1:0,Db=m?1:0;U=a?a===y-c?va?3:(a-fb)%2+fb:(a-fb)%2+fb:0;y-c||(U=ja?0:va?3:(a-fb)%2+fb);a=b?b===
G-h?Ta?3:(b-Db)%2+Db:(b-Db)%2+Db:0;G-h||(a=m?0:Ta?3:(b-Db)%2+Db);return{dAf:U,bAf:a}};class HD{constructor(a){this.B0=a;this.k7c=Array(4);for(a=0;4>a;a++)this.k7c[a]=Array(4)}ZXf(a,b,c,h){let m,y;({dAf:m,bAf:y}=lL(a,b,c,h,this.B0));if(!this.k7c[m][y]){c=Object.assign(new fr.a,{fe:b,Nf:b+h,ke:a,ag:a+c});a=this.k7c[m];b=y;h=this.B0;var G=h.tableStyle,U=new xp;U.latinField=Se.Btb(1,0);U.eaField=Se.Btb(1,1);U.csField=Se.Btb(1,2);U.solidFillField=Object.assign(new Mu.a,{schemeClrField:Object.assign(new nn.a,
{valField:1})});G&&(new PK(U)).LZ(h,c);c=U;G=h.NYj;h=new Kx;G=G||new OK;for(U=1;9>=U;U++){var ja=QK(G,U);const va=U-1;h.XHe[va]=ja?dd.a(dd.c(ja)):new cq;ja=h.XHe[va].defRPrField;h.Fsb[va]=ja?dd.a(dd.c(ja)):new xp}for(G=1;9>=G;G++)RK(h.Fsb[G-1],c);a[b]=h}return this.k7c[m][y]}CZf(a,b,c,h,m){let y=hb.a.SQa;a&&(b=this.ZXf(b,c,h,m))&&b.Fsb&&0<b.Fsb.length&&(b=b.Fsb[0])&&(y=Uf.Box4ColorHelper.OJb(b,a));return y}}Object(n.a)(HD,"TableListStyleCache",null,[374]);class ID{constructor(a,b,c,h){this.CGa=a;
this.mUg=b;this.CGa.ik(Object(F.a)(this,this.hh,"onPropertyChanged"));this.CGa.kia(Object(F.a)(this,this.onConnected,"onConnected"));this.Re=c;this.$ue=h}onConnected(a,b){a=Object(ua.a)(175,b.node);this.mUg.tHh(a)}hh(a,b){a=b.property;b=Object(ua.a)(175,b.node);a===kb.a.Tu?this.mUg.tHh(b):a===kb.a.Tya||a===kb.a.kga||a===kb.a.NA?b.TY=null:!this.$ue||a!==X.a.vUa&&a!==X.a.isResizable&&a!==X.a.vL||b.sc(this.Re).o3e()}dispose(){this.CGa.Cm(Object(F.a)(this,this.hh,"onPropertyChanged"));this.CGa.Vna(Object(F.a)(this,
this.onConnected,"onConnected"))}}Object(n.a)(ID,"TableNodeBehavior",null,[106]);var xQ=d(184);class Iv{constructor(a,b,c,h,m,y,G,U){this.o0=this.XQ=this.Hn=this.aHa=this.l0=this.$$c=this.uGa=null;this.Sdb=this.Z7c=0;this.VFg=this.ffc=this.Vd=this.zx=null;this.lO=a;this.ia=c;this.Kq=h;this.Fs=m;this.QC=y;this.q$=b;this.fq=G;this.Sp=U}NK(){this.o0=this.XQ=this.Hn=this.l0=this.aHa=null;null!==this.fq&&this.fq.Lxa()}xv(a){if(!a||a.lA===Sys.UI.MouseButton.rightButton||this.lO.E_)return!1;this.Vd=(this.zx=
Object(ua.a)(1238,this.QC.zI(a.Cc)))?this.zx.Ck:null;if(!this.Vd)return!1;this.uGa=this.zx.nri;if(!this.uGa)return!1;this.XQ=this.uGa.Oag(a.Cc);if(!this.XQ)return!1;this.Sp&&this.ia.processAction(D.a.Cja,2);return!0}Nu(a){if(!a||!this.xv(a))return!1;this.$$c=this.zx=this.QC.zI(this.uGa.xa);if(!this.zx)return Ba.a.J(8959070,808,10,"The draggable chrome should be owned by Box4 TableViewElement"),!1;this.ia.processAction(M.a.S6a,2);this.uGa.OD(!0);this.Vd.OD(!0);null!==this.fq&&this.fq.iya(Mi.a.EMb);
this.o0=this.$$c.R5b();this.Z7c=this.Kq.Pm(ad.a.lm(this.o0.ga(0),this.o0.ga(1)));this.Sdb=this.Kq.Pm(ad.a.lm(this.o0.ga(0),this.o0.ga(3)));this.aHa=this.EGf(a.clientPoint);this.l0=new ad.a(0,0);this.Hn=new yi.a;this.VFg=new ad.a(this.Vd.x+this.Z7c,this.Vd.y+this.Sdb);return!0}zw(a){if(!a)return!1;a=this.EGf(a.clientPoint);var b=ad.a.bV(a,this.aHa);this.l0=ad.a.add(this.l0,b);b=Rk.rSd(this.XQ,this.o0,this.l0,!1,!1);this.Hn=Object.assign(new yi.a,{bottom:this.Kq.Pm(b.bottom),left:this.Kq.Pm(b.left),
right:this.Kq.Pm(b.right),top:this.Kq.Pm(b.top)});let c;({vJh:b,zJh:c}=this.vAf());const h=new xQ.a;h.Vba(b,c);h.VB(this.Hn.left,this.Hn.top);this.uGa.Nq(h);this.aHa=a;return!0}Zn(a){let b=null;a&&(b=this.q$.Ci("UserAction","PPTTableResize"),Ba.a.J(19142416,822,50,String.format("Start Table resize for table: {0}, IsComplex: {1}",this.zx.gb.sa(X.a.wFb,""),rd.TableReader.Cu(this.zx.gb))));this.uGa.Oz(!1);({vJh:m,zJh:y}=this.vAf());this.zx.krh(m,y);this.zZe();const c=new t.GraphTransaction(15);c.kd(this.zx.gb);
var h=this.zx.Md.Ld;this.Fs.DQe(Object(ua.a)(Oz.TableNode,this.zx.gb),m,y,this.$$c,h);if(Iv.PEa(this.XQ)||Iv.PEa(this.XQ,!0)){var m=this.zx.Ck.shapeNode;var y=h.rf(this.Vd.x,0);h=h.rf(this.Vd.y,1);m.qy=y;m.ry=h}this.Vd.Oz(!1);c.dispose();this.NK();Fc.App.Kb.updateCommandUI();b&&b.stop();a&&Ba.a.J(8959107,822,50,String.format("End Table resize for table: {0}, IsComplex: {1}",this.zx.gb.sa(X.a.wFb,""),rd.TableReader.Cu(this.zx.gb)))}zZe(){var a=Iv.PEa(this.XQ),b=Iv.PEa(this.XQ,!0);if(a||b){b=this.$$c.R5b();
a=this.Kq.Pm(b.Zb-b.hc);b=this.Kq.Pm(b.Xb-b.kc);const c=this.VFg;c._x+=this.Hn.right;c._y+=this.Hn.bottom;this.Vd.setPosition(c.x-a,c.y-b,!0)}}iu(){this.l0&&(this.uGa.Oz(!0),this.uGa.Nq(null),this.Vd.Oz(!0),this.NK())}vAf(){return{vJh:this.Z7c?1+(this.Hn.right-this.Hn.left)/this.Z7c:1,zJh:this.Sdb?1+(this.Hn.bottom-this.Hn.top)/this.Sdb:1}}EGf(a){a=ad.a.bSa(a);var b=this.XQ;this.XQ.I8b()||(b=b.rwb());const c=this.o0.qk(b);b=this.o0.qk(b.w8a());return a=new ad.a(c.x<=b.x?Math.min(a.x,b.x):Math.max(a.x,
b.x),c.y<=b.y?Math.min(a.y,b.y):Math.max(a.y,b.y))}static PEa(a,b=!1){return a.equals(ke.a.Ku)?!0:b?a.equals(ke.a.north)||a.equals(ke.a.yE):a.equals(ke.a.west)||a.equals(ke.a.IH)}}Object(n.a)(Iv,"TableResizeDragAdapter",null,[244]);class JD{constructor(a,b){this.B0=a;this.NEb=b;this.ji=Array(4);for(a=0;4>a;a++)this.ji[a]=Array(4);this.HBe=Array(16)}u4d(a,b,c,h){let m,y;({dAf:m,bAf:y}=lL(a,b,c,h,this.B0));this.ji[m][y]||(this.ji[m][y]=this.NEb.iYk(this.B0,a,b,c,h));c=this.ji[m][y].clone();if(a=this.Tmj(a,
b))for(const G of a.Tz())c.Sa(G)||c.te(G,a.Lh(G));return c}clear(){for(let a=0;4>a;a++)this.ji[a]=Array(4);this.HBe=Array(16)}Tmj(a,b){var c=a===this.B0.BY-1;const h=b===this.B0.Nra-1;let m=0;a||(m|=8);!b&&(m|=4);c&&(m|=2);h&&(m|=1);(c=this.HBe[m])||(this.HBe[m]=c=this.NEb.AYk(this.B0,a,b));return c}}Object(n.a)(JD,"TableStyleCache",null,[373]);class mL{constructor(a){this.JWa=a}iYk(a,b,c,h,m){const y=a.BY;var G=a.Nra,U=a.tableLook;const ja=a.tableStyle;a=a.Ne;const va=new jq.a,Ta=0<(U&32),fb=0<(U&
128),Db=!b&&Ta,gc=!c&&fb;h=b===y-h&&0<(U&64);m=c===G-m&&0<(U&256);G=!(U&512)&&!Db&&!h;U=!(U&1024)&&!gc&&!m;this.BYk(ja.wholeTblField,va);G&&this.Sxa((Ta?1!==(b&1):b&1)?ja.band2HField:ja.band1HField,a,va);U&&this.Sxa((fb?1!==(c&1):c&1)?ja.band2VField:ja.band1VField,a,va);m&&this.Sxa(ja.lastColField,a,va);gc&&this.Sxa(ja.firstColField,a,va);h&&(this.Sxa(ja.lastRowField,a,va),m&&this.Sxa(ja.seCellField,a,va),gc&&this.Sxa(ja.swCellField,a,va));Db&&(this.Sxa(ja.firstRowField,a,va),m&&this.Sxa(ja.neCellField,
a,va),gc&&this.Sxa(ja.nwCellField,a,va));return va}AYk(a,b,c){var h=a.BY;const m=a.Nra;var y=a.tableStyle;a=a.Ne;const G=new jq.a;if(y&&0<=b&&b<h&&0<=c&&c<m){const U=!c;h=b===h-1;c=c===m-1;(y=y.wholeTblField)&&y.tcStyleField&&(y=y.tcStyleField.tcBdrField)&&(this.$Za(7,b?y.insideHField:y.topField,a,G),this.$Za(0,h?y.bottomField:y.insideHField,a,G),this.$Za(5,U?y.leftField:y.insideVField,a,G),this.$Za(6,c?y.rightField:y.insideVField,a,G))}return G}Ekh(a,b,c){const h=new jq.a;this.Ckh(a,c,b,h);return h}BYk(a,
b){a&&a.tcStyleField&&a.tcStyleField.fillField&&b.te(X.a.cellShading,a.tcStyleField.fillField)}Sxa(a,b,c){a&&a.tcStyleField&&(a.tcStyleField.fillField&&c.te(X.a.cellShading,a.tcStyleField.fillField),a=a.tcStyleField.tcBdrField)&&(this.$Za(7,a.topField,b,c),this.$Za(0,a.bottomField,b,c),this.$Za(5,a.leftField,b,c),this.$Za(6,a.rightField,b,c))}$Za(a,b,c,h){b&&b.itemField&&this.Ckh(a,b.itemField,c,h)}Ckh(a,b,c,h){let m;({OPa:m,i6a:a}=Fp.LSa(a));b.wFieldSpecified&&h.te(m,te.a.F_d(b.wField));if(b.solidFillField)if(this.JWa)h.te(a,
b.solidFillField);else{if(b=Uf.Box4ColorHelper.wib(b.solidFillField,c))b=Uf.Box4ColorHelper.Poa(b),h.te(a,b)}else b.noFillField&&(this.JWa&&Rd.a("TableBordersLocalRenderingFix")?(b=Uf.Box4ColorHelper.oV({Color:"##T,0,0,0"}),h.te(a,b),h.te(m,0)):h.te(a,hb.a.SQa))}}Object(n.a)(mL,"TableStyleResolver",null,[494]);var nL=d(325),KD=d(185);class Mx{constructor(a,b,c,h=null){this.Cwa=!1;this.bB=this.Xn=this.qb=this.Erg=this.tWg=null;this.MC=[];this.Gk=this.bA=!1;this.x0=null;this.Po=this.bdb=!1;this.Fa=
b;this.sGg=a;this.Yc=h;this.YT=(this.s5c=c)?10:6;this.vze=c?2:xf.a.NE}get visible(){return this.Cwa}set visible(a){this.Cwa!==a&&(this.Cwa=a,this.Gqh())}get xa(){return this.qb.viewport.xa}mhi(a,b,c){this.tWg=a;this.Erg=c;this.Im();this.Yc.pb(ra.a.click,this.xa,Object(F.a)(this,this.W_g,"notifySelectShapeByClick"));b.appendChild(this.qb.viewport);this.tWg.FM(this.xa,!0);this.bdb=!0;this.setZIndex(2+eD.a.Taa+1)}vEh(){this.bdb&&this.qb&&this.Yc.yb(ra.a.click,this.xa,Object(F.a)(this,this.W_g,"notifySelectShapeByClick"));
this.bdb=!1}setZIndex(a){this.bdb&&this.qb.DB(a)}Im(){this.qb||(this.qb=new KD.a,this.Xn=new ch.a,this.Xn.KE(Gk.a.none),this.Xn.Su(xf.a.o1),this.Xn.jr(xf.a.NE),this.qb.nl(Mi.a.vA),this.qb.appendChild(this.Xn),this.bB=new Dd.a,this.K0b(this.bB),this.qb.appendChild(this.bB),this.qb.Pd(!1),this.qb.viewport.xa.setAttribute(Gk.a.oHb,Gk.a.none))}Pl(){if(this.bdb){var a=this.ihj(this.Erg);this.bA?(this.x0&&this.x0.El(a),this.Xn.ut(a.points)):(a=a.points,this.Xn.ut(a),a=new pj.a(a[0],a[1],a[2],a[3]));this.rY(a);
this.qb.Pl()}}K0b(a){for(let h=0;8>h;++h){var b="selectionHandle"+h;const m=new Dd.a;m.xa.id=b;if(v.a.jLa){var c=new nL.a;c.xa.id=b;c.xa.setAttribute("class",xm.a.$qd);c.setVisibility(!1);c.setPosition(-10,-10);c.ih(20,20);m.appendChild(c)}c=new nL.a;c.xa.id=b;c.xa.setAttribute("class",xm.a.$qd);b=this.YT/2*-1;c.setPosition(b,b);c.ih(this.YT,this.YT);this.s5c&&c.Jqh(this.YT/2,this.YT/2);c.KE("white");c.Su(xf.a.o1);c.jr(this.vze);c.brh();m.appendChild(c);m.Yj(1);this.MC[h]=m;a.appendChild(m)}}rY(a){for(let b=
0;8>b;++b){const c=this.MC[b];c.nl(Mx.Eoc[b]);this.BKa(c,a.qk(new ke.a(b)))}}ihj(a){return new pj.a(new ad.a(0,0),new ad.a(a.offsetWidth,0),new ad.a(a.offsetWidth,a.offsetHeight),new ad.a(0,a.offsetHeight))}JE(a){this.Po||((this.bA=a)?(this.Xn.KE(xf.a.bOf),this.Xn.Su(xf.a.o1),this.Xn.jr(xf.a.NE),this.bB.Pd(!1),this.sGg.endEditing(!0,14)):(this.Xn.KE(Gk.a.none),this.Xn.Su(xf.a.o1),this.Xn.jr(xf.a.NE),this.bB.Pd(!0),this.Fa.xf(Ua.a.rg),this.sGg.KR()))}dispose(){this.Gk||(this.vEh(),this.Xn=this.qb=
null,Array.clear(this.MC),this.bB=null,this.bdb=!1,this.Gk=!0)}Oag(a){if(!this.bdb)return null;for(let b=0;8>b;++b)if(this.MC[b].xa.id===a.id)return new ke.a(b);return null}BKa(a,b){a.setPosition(b.x,b.y)}W_g(a){return this.Oag(a.Cc)?!0:!1}OD(a){this.JE(!0,a)}Oz(){this.JE(!1)}Nq(a){this.x0&&this.x0.clear();this.x0=a;this.Pl()}Jx(a){this.Po=a;this.Gqh()}Gqh(){this.qb&&this.qb.Pd(!this.Po&&this.Cwa)}static u0b(a){return new Mx(a,vb.a.instance.resolve("PowerPointWebEditor.IFocusManager"),vb.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").pptChangeResizeHandleEnabled,
u.AFrameworkApplication.Aa.By)}}Mx.Eoc=[Mi.a.LYe,Mi.a.KYe,Mi.a.JYe,Mi.a.IYe,Mi.a.MYe,Mi.a.NYe,Mi.a.OYe,Mi.a.PYe];Object(n.a)(Mx,"DraggablePandoraChromeView",null,[1243]);class oL{}Object(n.a)(oL,"TableStyleCategoryInfo",null,[]);class Ef{static yRi(){if(Ef.Yg)return Ef.Yg;Ef.Yg=new Jb.a;Ef.Yg.$("No Style, No Grid",ResourceStrings.l_TableThemedStyle1);Ef.Yg.$("Themed Style 1 - Accent 1",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleThemed,1,1));Ef.Yg.$("Themed Style 1 - Accent 2",
String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleThemed,1,2));Ef.Yg.$("Themed Style 1 - Accent 3",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleThemed,1,3));Ef.Yg.$("Themed Style 1 - Accent 4",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleThemed,1,4));Ef.Yg.$("Themed Style 1 - Accent 5",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleThemed,1,5));Ef.Yg.$("Themed Style 1 - Accent 6",String.format(ResourceStrings.l_TableStyleName,
ResourceStrings.l_TableStyleThemed,1,6));Ef.Yg.$("No Style, Table Grid",ResourceStrings.l_TableThemedStyle2);Ef.Yg.$("Themed Style 2 - Accent 1",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleThemed,2,1));Ef.Yg.$("Themed Style 2 - Accent 2",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleThemed,2,2));Ef.Yg.$("Themed Style 2 - Accent 3",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleThemed,2,3));Ef.Yg.$("Themed Style 2 - Accent 4",
String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleThemed,2,4));Ef.Yg.$("Themed Style 2 - Accent 5",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleThemed,2,5));Ef.Yg.$("Themed Style 2 - Accent 6",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleThemed,2,6));Ef.Yg.$("Light Style 1",String.format(ResourceStrings.l_TableStyleNoAccent,ResourceStrings.l_TableStyleLight,1));Ef.Yg.$("Light Style 1 - Accent 1",String.format(ResourceStrings.l_TableStyleName,
ResourceStrings.l_TableStyleLight,1,1));Ef.Yg.$("Light Style 1 - Accent 2",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,1,2));Ef.Yg.$("Light Style 1 - Accent 3",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,1,3));Ef.Yg.$("Light Style 1 - Accent 4",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,1,4));Ef.Yg.$("Light Style 1 - Accent 5",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,
1,5));Ef.Yg.$("Light Style 1 - Accent 6",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,1,6));Ef.Yg.$("Light Style 2",String.format(ResourceStrings.l_TableStyleNoAccent,ResourceStrings.l_TableStyleLight,2));Ef.Yg.$("Light Style 2 - Accent 1",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,2,1));Ef.Yg.$("Light Style 2 - Accent 2",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,2,2));Ef.Yg.$("Light Style 2 - Accent 3",
String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,2,3));Ef.Yg.$("Light Style 2 - Accent 4",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,2,4));Ef.Yg.$("Light Style 2 - Accent 5",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,2,5));Ef.Yg.$("Light Style 2 - Accent 6",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,2,6));Ef.Yg.$("Light Style 3",String.format(ResourceStrings.l_TableStyleNoAccent,
ResourceStrings.l_TableStyleLight,3));Ef.Yg.$("Light Style 3 - Accent 1",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,3,1));Ef.Yg.$("Light Style 3 - Accent 2",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,3,2));Ef.Yg.$("Light Style 3 - Accent 3",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,3,3));Ef.Yg.$("Light Style 3 - Accent 4",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,
3,4));Ef.Yg.$("Light Style 3 - Accent 5",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,3,5));Ef.Yg.$("Light Style 3 - Accent 6",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,3,6));Ef.Yg.$("Medium Style 1",String.format(ResourceStrings.l_TableStyleNoAccent,ResourceStrings.l_TableStyleMedium,1));Ef.Yg.$("Medium Style 1 - Accent 1",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,1,1));Ef.Yg.$("Medium Style 1 - Accent 2",
String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,1,2));Ef.Yg.$("Medium Style 1 - Accent 3",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,1,3));Ef.Yg.$("Medium Style 1 - Accent 4",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,1,4));Ef.Yg.$("Medium Style 1 - Accent 5",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,1,5));Ef.Yg.$("Medium Style 1 - Accent 6",String.format(ResourceStrings.l_TableStyleName,
ResourceStrings.l_TableStyleMedium,1,6));Ef.Yg.$("Medium Style 2",String.format(ResourceStrings.l_TableStyleNoAccent,ResourceStrings.l_TableStyleMedium,2));Ef.Yg.$("Medium Style 2 - Accent 1",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,2,1));Ef.Yg.$("Medium Style 2 - Accent 2",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,2,2));Ef.Yg.$("Medium Style 2 - Accent 3",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,
2,3));Ef.Yg.$("Medium Style 2 - Accent 4",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,2,4));Ef.Yg.$("Medium Style 2 - Accent 5",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,2,5));Ef.Yg.$("Medium Style 2 - Accent 6",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,2,6));Ef.Yg.$("Medium Style 3",String.format(ResourceStrings.l_TableStyleNoAccent,ResourceStrings.l_TableStyleMedium,3));Ef.Yg.$("Medium Style 3 - Accent 1",
String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,3,1));Ef.Yg.$("Medium Style 3 - Accent 2",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,3,2));Ef.Yg.$("Medium Style 3 - Accent 3",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,3,3));Ef.Yg.$("Medium Style 3 - Accent 4",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,3,4));Ef.Yg.$("Medium Style 3 - Accent 5",String.format(ResourceStrings.l_TableStyleName,
ResourceStrings.l_TableStyleMedium,3,5));Ef.Yg.$("Medium Style 3 - Accent 6",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,3,6));Ef.Yg.$("Medium Style 4",String.format(ResourceStrings.l_TableStyleNoAccent,ResourceStrings.l_TableStyleMedium,4));Ef.Yg.$("Medium Style 4 - Accent 1",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,4,1));Ef.Yg.$("Medium Style 4 - Accent 2",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,
4,2));Ef.Yg.$("Medium Style 4 - Accent 3",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,4,3));Ef.Yg.$("Medium Style 4 - Accent 4",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,4,4));Ef.Yg.$("Medium Style 4 - Accent 5",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,4,5));Ef.Yg.$("Medium Style 4 - Accent 6",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,4,6));
Ef.Yg.$("Dark Style 1",String.format(ResourceStrings.l_TableStyleNoAccent,ResourceStrings.l_TableStyleDark,2));Ef.Yg.$("Dark Style 1 - Accent 1",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleDark,1,1));Ef.Yg.$("Dark Style 1 - Accent 2",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleDark,1,2));Ef.Yg.$("Dark Style 1 - Accent 3",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleDark,1,3));Ef.Yg.$("Dark Style 1 - Accent 4",
String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleDark,1,4));Ef.Yg.$("Dark Style 1 - Accent 5",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleDark,1,5));Ef.Yg.$("Dark Style 1 - Accent 6",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleDark,1,6));Ef.Yg.$("Dark Style 2",String.format(ResourceStrings.l_TableStyleNoAccent,ResourceStrings.l_TableStyleDark,2));Ef.Yg.$("Dark Style 2 - Accent 1/Accent 2",String.format(ResourceStrings.l_TableStyleNameAccent,
ResourceStrings.l_TableStyleDark,2,1,2));Ef.Yg.$("Dark Style 2 - Accent 3/Accent 4",String.format(ResourceStrings.l_TableStyleNameAccent,ResourceStrings.l_TableStyleDark,2,2,3));Ef.Yg.$("Dark Style 2 - Accent 5/Accent 6",String.format(ResourceStrings.l_TableStyleNameAccent,ResourceStrings.l_TableStyleDark,2,4,5));return Ef.Yg}static u5f(a){const b=Ef.yRi();return b.Hb(a)?b.ga(a):a}}Ef.Yg=null;Object(n.a)(Ef,"TableStyleNameReader",null,[]);class pL{constructor(a){this.bvg=!1;this.SAb=[];this.Zte=new Nd.a(0);
this.Ooe=[];this.WQg=a}Z_d(){this.bvg||(this.bvg=this.DAk())}DAk(){const a=this.WQg.instance?this.WQg.instance.jol:null;if(a&&a.tblStyleCategoriesField){let b=0;this.SAb=[];this.Zte=new Nd.a(0);this.Ooe=[];for(let c=0;c<a.tblStyleCategoriesField.length;c++){const h=a.tblStyleCategoriesField[c];if(h.tblStylesField&&0<h.tblStylesField.length){Array.add(this.Ooe,Object.assign(new oL,{id:h.idField,begin:b,end:b+h.tblStylesField.length-1}));for(let m=0;m<h.tblStylesField.length;m++){const y=h.tblStylesField[m],
G=new E.DictionaryPropertySet,U=new DD(y,h.idField,m);G.te(X.a.tableStyle,U);this.SAb.push(G);this.Zte.$(y.styleIdField.toLowerCase(),b++)}}}return!0}return!1}pQc(){return this.SAb}Swb(a){return 0<=a&&a<this.SAb.length?this.SAb[a]:null}ojj(a,b){let c=null;for(const h of this.Ooe)if(h.id===a){c=h;break}return c&&(a=c.begin+b,a<=c.end)?this.Swb(a):null}yjj(a){return this.N5b(a).YX.styleIdField}zjj(a){return(a=this.N5b(a).YX.styleNameField)?Rd.a("TableStyleNameLocalization")?Ef.u5f(a):a:""}rjj(a){return this.N5b(a).prg}N5b(a){return a.Lh(X.a.tableStyle)}t5f(a){return(a=
this.pkj(a))?a.Lh(X.a.tableStyle):null}pkj(a){this.Z_d();return this.SAb[this.Zte.ga(a.toLowerCase())]}}Object(n.a)(pL,"TableStyleGalleryManager",null,[495]);class qL{constructor(a,b,c,h,m){this.GL=0;h||(h=Object.assign(new fr.a,{ke:0,ag:c.OO,fe:0,Nf:c.sR}));this.Woe=a;this.Hck=b;this.Bma=c;this.oE=h;this.Wz=new fr.a;this.DO=this.GL=-1;this.j4c=m}get vjg(){return-1===this.DO||-1===this.GL}moveNext(){this.vjg&&(this.DO=this.oE.ke,this.Wz.Nf=this.oE.fe);for(;;){this.GL=this.Wz.Nf;if(this.GL>=this.oE.Nf&&
(this.GL=this.oE.fe,++this.DO>=this.oE.ag))return this.reset(),!1;this.Wz=this.Woe.uI(this.Bma,this.DO,this.GL);if(this.DO===this.oE.ke||this.DO===this.Wz.ke)if(!this.j4c||this.j4c.zMd(this))return!0}}lik(){this.vjg&&(this.GL=this.oE.fe,this.Wz.ag=this.oE.ke);for(;;){this.DO=this.Wz.ag;if(this.DO>=this.oE.ag&&(this.DO=this.oE.ke,++this.GL>=this.oE.Nf)){this.reset();break}this.Wz=this.Woe.uI(this.Bma,this.DO,this.GL);if(this.GL===this.oE.fe||this.GL===this.Wz.fe)if(!this.j4c||this.j4c.zMd(this))break}}moveTo(a,
b){this.Wz=this.Woe.uI(this.Bma,a,b);if(!this.Wz.WTi(this.oE))return this.reset(),!1;this.DO=Math.min(Math.max(a,this.oE.ke),this.oE.ag-1);this.GL=Math.min(Math.max(b,this.oE.fe),this.oE.Nf-1);return!0}reset(){this.DO=this.GL=-1}t4b(){return this.Hck.qf(this.Wz.ke,this.Wz.fe)}}Object(n.a)(qL,"CellIterator",null,[1269]);class rL{constructor(a){this.Iq=a}gDa(a,b,c,h=null){return new qL(this.Iq,a,b,c,h)}}Object(n.a)(rL,"CellIteratorFactory",null,[490]);class LD{constructor(a,b,c){this.Iq=b;this.Bma=
c;this.GC=this.Iq.nOc(this.Bma,a.oE);this.k9=Array(this.GC.sR*(this.GC.OO+1));this.DO=this.GC.ke;this.Xbb=this.GC.fe;this.XAb=this.GC.fe-1;this.Jq=0;this.Ice(a)}Ice(a){const b=a.oE;for(;a.moveNext();){const h=a.Wz;for(let m=h.fe;m<h.Nf;m++){var c=this.BDa(h.ke,m);this.k9[c]=0!==this.k9[c]?2:m<b.fe&&h.ke>b.ke?16:m>=b.Nf&&h.ke>b.ke?64:1;c=this.BDa(h.ag,m);this.k9[c]=0!==this.k9[c]?2:m<b.fe&&h.ag<b.ag?16:m>=b.Nf&&h.ag<b.ag?64:4}}}BDa(a,b){return this.GC.sR*(a-this.GC.ke)+(b-this.GC.fe)}moveNext(){this.Xbb=
this.XAb;do{this.Xbb++;this.Xbb>=this.GC.Nf&&(this.DO++,this.Xbb=this.GC.fe);if(this.DO>this.GC.ag)return!1;this.Jq=this.k9[this.BDa(this.DO,this.Xbb)]}while(0===this.Jq);for(this.XAb=this.Xbb;this.XAb+1<this.GC.Nf&&this.k9[this.BDa(this.DO,this.XAb+1)]===this.Jq;)this.XAb++;return!0}g4i(){return this.XAb+1}V8a(){return this.Jq}static uhe(a){return!!(a&87)}}Object(n.a)(LD,"HorizontalTableBorderIterator",null,[1268,595]);class sL{constructor(a){this.Iq=a}PCi(a,b){return new LD(a,this.Iq,b)}}Object(n.a)(sL,
"HorizontalTableBorderIteratorFactory",null,[491]);var Pz;(function(a){a[a.none=0]="none";a[a.firstLayout=1]="firstLayout";a[a.paragraphPropertyChange=2]="paragraphPropertyChange";a[a.cellChildTopoChange=3]="cellChildTopoChange";a[a.rowPropertyChange=4]="rowPropertyChange";a[a.cellPropertyChange=5]="cellPropertyChange";a[a.panelLayoutChange=6]="panelLayoutChange";a[a.tablePropertyChange=7]="tablePropertyChange";a[a.tableNodeConnected=8]="tableNodeConnected";a[a.tableViewElementDisconnected=9]="tableViewElementDisconnected";
a[a.tableComplexityChange=10]="tableComplexityChange";a[a.slideInvalidateRenderSize=11]="slideInvalidateRenderSize"})(Pz||(Pz={}));Object(n.b)("LayoutInvalidateTrigger",Pz);class tL{constructor(){this.Oia=this.lRd=this.Qsc=this.tVd=0}get rowSpan(){return this.lRd-this.Qsc}toString(){return String.format("C[{0}][{1}]",this.Qsc,this.Oia)}}Object(n.a)(tL,"CellInfo",null,[]);class gr{constructor(){this.AXc=!1;this.Uc=this.QBf=this.telemetry=null;this.lbb=this.rqc=!1;this.crd=null;this.dYg=0;this.tableNode=
this.eme=this.Hya=null;this.l1d=!1}}Object(n.a)(gr,"LayoutContext",null,[]);class uL{constructor(){this.Zvh=this.vud=0}}Object(n.a)(uL,"LayoutTelemtry",null,[]);class MD{constructor(){this.offset=this.hic=this.index=0}toString(){return String.format("Index {0}, H {1}, O {2}",this.index,this.hic,this.offset)}}Object(n.a)(MD,"RowSeamInfo",null,[]);class xh{constructor(a,b,c,h,m,y,G){this.LC=null;this.cCb=[];this.OHa=[];this.EX=0;this.Gk=this.Y6c=!1;this.deb=null;this.V5c=!1;this.b7c=0;this.Pf=null;
this.mz=a;this.zb=h;this.Uk=y;this.Pb=c;this.WX=G;this.k8b(1)}WFj(a,b){if(!this.Y6c&&!this.V5c)try{2!==this.EX&&(1===this.EX?this.cCb[0]!==a&&this.k8b(b):(this.cCb[this.cCb.length]=a,this.EX=1,this.b7c=b))}catch(c){this.k8b(0),Ba.a.J(512495695,808,10,"PPTTableLayoutService::InvalidateCell failed {0}",c.toString())}}k8b(a){this.V5c||2===this.EX||this.Y6c||(this.EX=2,this.cCb=[],this.b7c=a)}Eae(){return 0!==this.EX&&!this.Y6c}get gXc(){return this.EX}lGh(a){this.Eae()&&(a=Object.assign(new gr,{tableNode:a}),
this.layout(a))}Yyl(a,b){this.Eae()?this.deb||(this.deb=new He.a(3,1,0,Object(F.a)(this,this.wzk,"performLayout"),90,"9"),this.deb.customData=Object.assign(new gr,{tableNode:a,AXc:!0,eme:b}),this.zb.Eb(this.deb)):b&&b(!1)}wzk(a){this.layout(Object(ua.a)(gr,a.customData))}layout(a){this.V5c=!0;const b=new Sh.a(null,Object(F.a)(this,this.kDj,"initializeLayoutState"),a);b.Oi=!a.AXc;b.run()}kDj(a,b){b=Object(ua.a)(gr,b);try{this.VQi();b.Uc=this.Pf;b.telemetry=new uL;this.WCl();if(!this.Eae())return a.$g(Object(F.a)(this,
this.Zya,"tearDownLayout")),!0;this.EX=0;if(!b.tableNode.isConnected)return a.$g(Object(F.a)(this,this.Zya,"tearDownLayout")),!0;const c=Object(ua.a)(1238,b.tableNode.sc(this.mz));if(!c)return a.$g(Object(F.a)(this,this.Zya,"tearDownLayout")),!0;b.crd=c;b.Uc.Va(xh.pfi,b.AXc.toString());b.tableNode.Lp()?(b.Uc.Va(xh.Omg,Pz[this.b7c]),a.$g(Object(F.a)(this,this.WDk,"prepareTableMetrics"))):(b.Uc.Va(xh.Omg,"tableComplexityChange"),b.rqc=!0,b.lbb=!0,a.$g(Object(F.a)(this,this.Zya,"tearDownLayout")))}catch(c){b.Uc.Va(xh.X$b,
c.message),a.$g(Object(F.a)(this,this.Zya,"tearDownLayout"))}return!0}WDk(a,b){b=Object(ua.a)(gr,b);try{b.Hya=new Date,this.WX.Tah(b.tableNode,this.mz),b.Uc.Va(xh.RDk,(+new Date-+b.Hya).toString()),b.Uc.Va(xh.rhk,this.WX.aKj.toString()),a.$g(Object(F.a)(this,this.FXj,"layoutBaselineTable"))}catch(c){b.Uc.Va(xh.X$b,c.message),a.$g(Object(F.a)(this,this.Zya,"tearDownLayout"))}return!0}FXj(a,b){b=Object(ua.a)(gr,b);try{b.Hya=new Date;b.l1d=!0;b.dYg=xh.zgk;this.LC=[];this.LC[this.LC.length]=Object.assign(new MD,
{index:0,hic:0,offset:0});const c=new Nf.a(this.mz);c.set(b.tableNode);if(!c.Bb(1))throw Error.invalidOperation(xh.PSf);const h=b.tableNode;let m=c.currentNode,y=m,G=0,U=0,ja=0;for(;m;){15===m.type&&(y=m,ja=G=0,m=c.Bb(1));const va=m;if(!va)throw Ba.a.J(512495690,808,10,"PPTTableLayoutService::LayoutBaselineTable Cell is Null"),Error.argumentNull("Casting of GraphNode to cell is null");if(1===va.rowSpan){const Ta=Object(ua.a)(Zs,m.sc(this.mz));G=Math.max(G,this.WX.u4b(h,Ta.Sia,U,ja))}m=c.Cj(1);ja++;
if(!m){const Ta=Object.assign(new MD,{index:this.LC.length});let fb=y.sa(X.a.mu,0);fb=Math.max(fb,this.Uk.bIc(y));let Db=b.crd.Md.Ld.Me(fb,1);Db=Math.max(Db,G);Ta.offset=Db+this.LC[Ta.index-1].offset;Ta.hic=Db;this.LC[this.LC.length]=Ta;m=c.Af(1);U++}}a.$g(Object(F.a)(this,this.KXj,"layoutRowSeams"));b.Uc.Va(xh.IXj,(+new Date-+b.Hya).toString())}catch(c){b.Uc.Va(xh.X$b,c.message),b.rqc=!0,a.$g(Object(F.a)(this,this.Zya,"tearDownLayout"))}return!0}KXj(a,b){b=Object(ua.a)(gr,b);try{if(1===this.LC.length)throw Error.create(xh.JUi);
let c=b.QBf;if(!c){b.Hya=new Date;c=new Nf.a(this.mz);c.set(b.tableNode);if(!c.Bb(1))throw Error.invalidOperation(xh.PSf);b.QBf=c}const h=b.tableNode;let m=c.currentNode,y=0,G=0,U=0;for(;m&&y<b.dYg;){15===m.type&&(m=c.Bb(1),G=0);const ja=m;if(!ja)throw Ba.a.J(512495687,808,10,"PPTTableLayoutService::LayoutRowSeams Cell is Null"),Error.argumentNull("Casting of GraphNode to cell is null");y++;b.telemetry.vud++;1===ja.rowSpan||Yi.OutlineReader.isEmpty(c)?b.telemetry.Zvh++:this.MXj(this.hBi(h,ja,U,G),
b.Uc);m=c.Cj(1);G++;m||(m=c.Af(1),U++)}m||(this.gnl(),a.$g(Object(F.a)(this,this.mYi,"fixupTableMinRowHeight")),b.Uc.Va(xh.LXj,(+new Date-+b.Hya).toString()))}catch(c){b.Uc.Va(xh.X$b,c.message),b.rqc=!0,a.$g(Object(F.a)(this,this.Zya,"tearDownLayout"))}return!0}mYi(a,b){b=Object(ua.a)(gr,b);try{const m=b.crd;b.Hya=new Date;const y=[];var c=new Nf.a(this.mz);c.set(b.tableNode);for(var h=c.Bb(1);h;)y[y.length]=c.Tq,h=c.Cj(1);if(this.OHa.length===y.length){c=[];for(h=0;h<y.length;++h)c[h]=0,1<Math.abs(this.OHa[h]-
y[h].htmlElement.offsetHeight)&&(c[h]=this.OHa[h]);for(h=0;h<c.length;++h)0<c[h]&&y[h].yLb(c[h]*m.M7d())}else throw Error.invalidOperation(String.format("RowMisMatch{0},{1}",this.OHa.length,y.length));a.$g(Object(F.a)(this,this.Zya,"tearDownLayout"));b.Uc.Va(xh.iYi,(+new Date-+b.Hya).toString());b.lbb=!0}catch(m){b.Uc.Va(xh.X$b,m.message),b.rqc=!0,a.$g(Object(F.a)(this,this.Zya,"tearDownLayout"))}return!0}Zya(a,b){a=Object(ua.a)(gr,b);a.Hya=new Date;a.rqc?(this.WYk(a.Uc,a.tableNode,a.crd),a.l1d=!0):
a.Uc&&(a.Uc.Va(xh.OXj,a.telemetry.vud.toString()),a.Uc.Va(xh.NXj,a.telemetry.Zvh.toString()));this.deb&&!a.AXc&&this.zb.Rg(this.deb);this.V5c=!1;this.deb=null;this.b7c=0;a.Uc&&(a.Uc.Va(xh.lbb,a.lbb.toString()),!a.lbb&&a.Uc&&a.Uc.Va(xh.tableLayout,this.WX.i_d(a.tableNode)),a.Uc.Va(xh.Iol,(+new Date-+a.Hya).toString()),a.Uc.finish());a.lbb||(this.Y6c=!0);this.LC=null;this.cCb=[];this.Pf=null;this.WX.reset();a.eme&&a.eme(a.l1d);return!1}WYk(a,b,c){if(b.isConnected)try{const h=new Nf.a(this.mz);h.set(b);
let m=h.Bb(1);for(;m;){const y=Object(ua.a)(Hv,h.OQa);if(!y)throw Error.argument("tableRowViewElement");let G=c.Md.Ld.Me(m.sa(X.a.mu,0),1);const U=c.M7d();G*=U;y.yLb(G);m=h.Cj(1)}}catch(h){a&&a.Va(xh.VYk,h.message)}}MXj(a,b){if(!a)throw Error.create(xh.IUi);var c=this.LC[a.Qsc];const h=this.LC[a.lRd];c=Math.max(this.Bbj(c,h),a.tVd)-(h.offset-c.offset);if(!(0>=c)&&(this.tbi(h.index,c),h.offset<=this.LC[h.index-1].offset)){b.Va(xh.Voi,a.toString());for(a=0;a<=h.index;++a)b.Va(xh.y1k,this.LC[a].toString());
throw Error.create(xh.KUi);}}gnl(){if(this.LC){this.OHa=[];for(let a=1;a<this.LC.length;++a)this.OHa[this.OHa.length]=this.LC[a].offset-this.LC[a-1].offset}else this.OHa=null}tbi(a,b){if(b)for(var c=a,h=0;c<this.LC.length;){b=c===a?b:b+this.LC[c].hic-this.LC[c].offset+h;if(0>=b)break;h=this.LC[c].offset;this.LC[c].offset+=b;c++}}Bbj(a,b){if(a.index>=b.index)return 0;let c=0;for(a=a.index;a<b.index;)c+=this.LC[a+1].hic,a++;return c}hBi(a,b,c,h){if(!b||!b.isConnected)return null;const m=Object(ua.a)(Zs,
b.sc(this.mz)),y=this.Pb.Nc(b);y.rc(14);a=Object.assign(new tL,{tVd:this.WX.u4b(a,m.Sia,c,h),Qsc:gk.c(y),Oia:h});a.lRd=a.Qsc+b.rowSpan;return a}dispose(){this.Gk||(this.cCb=this.LC=this.OHa=null,this.EX=0,this.Gk=!0)}WCl(){if(this.Gk)throw Error.invalidOperation("table layout service is already disposed");}VQi(){this.Pf||(this.Pf=Nc.a.Ik("TableLayout"))}get Ma(){return this.mz}}xh.zgk=25;xh.X$b="FailureReason";xh.VYk="RestoreFailureReason";xh.tableLayout="Layout";xh.y1k="SI";xh.Voi="CI";xh.pfi="FAsync";
xh.OXj="CellVisited";xh.NXj="CellSkipped";xh.lbb="Succeeded";xh.IXj="LETD";xh.LXj="LRST";xh.iYi="FMTR";xh.Iol="TDLD";xh.RDk="PM";xh.Omg="Trigger";xh.rhk="MC";xh.IUi="CellDisconnected";xh.JUi="ChildOfTableNotLoaded";xh.KUi="SeamPositionInvariant";xh.PSf="NoRowViewElement";Object(n.a)(xh,"PPTTableLayoutService",null,[1270,106]);class vL{constructor(a,b,c,h,m){this.Pb=a;this.zb=b;this.Lck=c;this.Uk=h;this.WX=m}create(a,b){return new xh(a,b,this.Pb,this.zb,this.Lck,this.Uk,this.WX)}}Object(n.a)(vL,"PPTTableLayoutServiceFactory",
null,[497]);class wL{constructor(a,b,c,h,m,y,G,U,ja){this.nak=a;this.No=b;this.Pb=c;this.LXa=h;this.qUg=m;this.gfb=y;this.rfc=G;this.lq=U;this.p5c=!0;this.Nue=ja;this.xva=new Jb.a;this.No.MF&&!this.No.Uj&&(this.p5c=!1);this.p5c&&(this.LXa.$Nd(Object(F.a)(this,this.B1g,"onBeforeTableViewElementDisconnected")),this.LXa.kia(Object(F.a)(this,this.u6g,"onTableNodeConnected")),this.LXa.ik(Object(F.a)(this,this.w6g,"onTableNodePropertyChanged")),this.LXa.y7(Object(F.a)(this,this.v6g,"onTableNodeDisconnected")),
this.qUg.ik(Object(F.a)(this,this.y6g,"onTableRowNodePropertyChanged")),this.gfb.ik(Object(F.a)(this,this.lfd,"onTableCellNodePropertyChanged")),this.gfb.FG(Object(F.a)(this,this.t6g,"onTableCellNodeChildTopoChanged")),this.rfc.ik(Object(F.a)(this,this.B4g,"onParagraphNodePropertyChanged")),this.lq.bai(Object(F.a)(this,this.T5g,"onSlideInvalidateRenderSize")))}mTc(a,b){if(!this.p5c)return null;var c=a.id.toString();this.xva.Hb(c)||this.xva.$(c,new Ct.a);c=this.xva.ga(c);var h=a.Lp();h=this.Nue?h&&
rd.TableReader.UFf(Object(ua.a)(rb.GraphIterator,this.Pb.Nc(a))):h;if(c.Hb(b))return b=c.ga(b),h||0!==b.gXc||(this.$gh(a),b=null),b;if(h)c.$(b,this.nak.create(b,a.id));else return null;return c.ga(b)}dyb(a,b,c){a.Lp()?this.qdg(a.id.toString(),b,c):10===c&&this.qdg(a.id.toString(),b,c)}qdg(a,b,c){if(this.xva.Hb(a))for(let h of this.xva.ga(a).values)b?h.WFj(b,c):h.k8b(c)}nge(a,b,c){a.isConnected&&(a=this.Pb.Nc(a),a.rc(14)&&this.dyb(a.Mw(14),b,c))}OFj(a){a.isConnected&&(a=this.Pb.Nc(a),a.rc(14)&&this.dyb(a.Mw(14),
a.Mw(16),2))}B1g(a,b){b.Vr.Qc.np&&this.dyb(b.Vr.gb,null,9)}u6g(a,b){this.dyb(b.node,null,8);a=Object(ua.a)(Oz.TableNode,b.node);a=!!a&&a.Lp();Ba.a.J(41007133,808,50,"Render table, isComplexTable: {0}",a)}v6g(a,b){this.$gh(b.node)}$gh(a){a=a.id.toString();if(this.xva.Hb(a)){const b=this.xva.ga(a);for(let c of b.values)c&&c.dispose();this.xva.remove(a)}}w6g(a,b){a=b.property;b.node.isConnected&&(a===kb.a.Tu||a===kb.a.kga||a===kb.a.NA||a===X.a.Dkb||a===X.a.cid||a===X.a.Uya||a===X.a.Nrc?this.dyb(b.node,
null,7):a===X.a.complexTable&&this.dyb(b.node,null,10))}y6g(a,b){a=b.property;b.node.isConnected&&a===X.a.mu&&this.nge(b.node,null,4)}lfd(a,b){a=b.property;!b.node.isConnected||a!==X.a.rowSpan&&a!==X.a.colSpan||this.nge(b.node,null,5)}t6g(a,b){b.node.isConnected&&1===b.RZ&&this.nge(b.node,b.node,3)}B4g(a,b){a=Object(ua.a)(5,b.node);b=b.property;a&&a.isConnected&&a.Sa(X.a.cellId)&&!a.Ulc&&(b===kb.a.pq||b===kb.a.Kkb)&&this.OFj(a)}T5g(){for(let a of this.xva.keys)for(let b of this.xva.ga(a).values)b.k8b(11)}dispose(){this.p5c&&
(this.LXa.dPe(Object(F.a)(this,this.B1g,"onBeforeTableViewElementDisconnected")),this.LXa.Vna(Object(F.a)(this,this.u6g,"onTableNodeConnected")),this.LXa.Cm(Object(F.a)(this,this.w6g,"onTableNodePropertyChanged")),this.LXa.$Ja(Object(F.a)(this,this.v6g,"onTableNodeDisconnected")),this.qUg.Cm(Object(F.a)(this,this.y6g,"onTableRowNodePropertyChanged")),this.gfb.Cm(Object(F.a)(this,this.lfd,"onTableCellNodePropertyChanged")),this.gfb.ZO(Object(F.a)(this,this.t6g,"onTableCellNodeChildTopoChanged")),this.rfc.Cm(Object(F.a)(this,
this.B4g,"onParagraphNodePropertyChanged")),this.lq.XUk(Object(F.a)(this,this.T5g,"onSlideInvalidateRenderSize")))}}Object(n.a)(wL,"PPTTableLayoutServiceManager",null,[498,106]);class ND{constructor(a,b,c){this.Iq=b;this.Bma=c;this.GC=this.Iq.nOc(this.Bma,a.oE);this.k9=Array(this.GC.OO*(this.GC.sR+1));this.GL=this.GC.fe;this.Feb=this.GC.ke;this.kEb=this.GC.ke-1;this.Jq=0;this.Ice(a)}Ice(a){const b=a.oE;for(;a.moveNext();){const h=a.Wz;for(let m=h.ke;m<h.ag;m++){var c=this.BDa(m,h.fe);this.k9[c]=0!==
this.k9[c]?32:m<b.ke&&h.fe>b.fe?1:m>=b.ag&&h.fe>b.fe?4:16;c=this.BDa(m,h.Nf);this.k9[c]=0!==this.k9[c]?32:m<b.ke&&h.Nf<b.Nf?1:m>=b.ag&&h.Nf<b.Nf?4:64}}}BDa(a,b){return this.GC.OO*(b-this.GC.fe)+(a-this.GC.ke)}moveNext(){this.Feb=this.kEb;do{this.Feb++;this.Feb>=this.GC.ag&&(this.GL++,this.Feb=this.GC.ke);if(this.GL>this.GC.Nf)return!1;this.Jq=this.k9[this.BDa(this.Feb,this.GL)]}while(0===this.Jq);for(this.kEb=this.Feb;this.kEb+1<this.GC.ag&&this.k9[this.BDa(this.kEb+1,this.GL)]===this.Jq;)this.kEb++;
return!0}hgj(){return this.kEb+1}V8a(){return this.Jq}static uhe(a){return!!(a&117)}}Object(n.a)(ND,"VerticalTableBorderIterator",null,[594,595]);class xl{constructor(a,b,c,h,m,y,G){this.Uk=a;this.Iq=b;this.Pb=c;this.jA=h;this.Yda=m;this.g7j=y;this.$dk=G}xxl(a,b,c){const h=b.getContainingTable();h&&(this.wtl(b,h,a,c.Nf,c.ke),this.vtl(b,h,a,c.ag,c.fe))}B2d(a,b,c,h,m,y){if(c&&c!==b.OO)for(;h<m;h++)if(9===(b.ns(c-1,h)&9)&&5===(b.ns(c,h)&5)){var G=this.Iq.uI(b,c-1,h),U=this.Iq.uI(b,c,h);G=a.qf(G.ke,G.fe);
U=a.qf(U.ke,U.fe);y?this.ntb(U,G,7,0):this.ntb(G,U,0,7)}}cTe(a,b,c,h,m){m=this.Yda.gDa(a,b,c,m);c=h.O2i();if(ND.uhe(c)){let y=this.$dk.QGi(m,b);for(;y.moveNext();)0!==(c&y.V8a())&&this.JUe(a,b,y.GL,y.Feb,y.hgj(),h.Swb(y.V8a()),!0)}if(LD.uhe(c))for(m=this.g7j.PCi(m,b);m.moveNext();)0!==(c&m.V8a())&&this.DTe(a,b,m.DO,m.Xbb,m.g4i(),h.Swb(m.V8a()),!0)}JUe(a,b,c,h,m,y,G=!1){let U=this.jA.DTc(a),ja=null;0<c&&(ja=a.qf(h,c-1));let va=null;for(c<b.sR&&(va=a.qf(h,c));h<m;){if(ja){if(6===(b.ns(h,c-1)&6)){var Ta=
this.Iq.uI(b,h,c-1),fb=a.qf(Ta.ke,Ta.fe);G&&U?U=this.SKb(U,fb,Ta.ke,Ta.fe,6,y):xl.Gpc(6,fb,y)}h+1<m&&(ja=a.qf(h+1,c-1))}va&&(5===(b.ns(h,c)&5)&&(Ta=this.Iq.uI(b,h,c),fb=a.qf(Ta.ke,Ta.fe),G&&U?U=this.SKb(U,fb,Ta.ke,Ta.fe,5,y):xl.Gpc(5,fb,y)),h+1<m&&(va=a.qf(h+1,c)));h+=1}}D2d(a,b,c,h,m,y){if(c&&c!==b.sR)for(;h<m;h++)if(6===(b.ns(h,c-1)&6)&&5===(b.ns(h,c)&5)){var G=this.Iq.uI(b,h,c-1),U=this.Iq.uI(b,h,c);G=a.qf(G.ke,G.fe);U=a.qf(U.ke,U.fe);y?this.ntb(U,G,5,6):this.ntb(G,U,6,5)}}DTe(a,b,c,h,m,y,G=!1){let U=
this.jA.DTc(a),ja=null;0<c&&(ja=a.qf(c-1,h));let va=null;for(c<b.OO&&(va=a.qf(c,h));h<m;){if(ja){if(9===(b.ns(c-1,h)&9)){var Ta=this.Iq.uI(b,c-1,h),fb=a.qf(Ta.ke,Ta.fe);G&&U?U=this.SKb(U,fb,Ta.ke,Ta.fe,0,y):xl.Gpc(0,fb,y)}h+1<m&&(ja=a.qf(c-1,h))}va&&(5===(b.ns(c,h)&5)&&(Ta=this.Iq.uI(b,c,h),fb=a.qf(Ta.ke,Ta.fe),G&&U?U=this.SKb(U,fb,Ta.ke,Ta.fe,7,y):xl.Gpc(7,fb,y)),h+1<m&&(va=a.qf(c,h)));h+=1}}VCh(a,b,c,h){var m=null;if(!({ke:h}=xl.iDh(b,c,h)).returnValue)return{returnValue:!1,Vka:m};m=6;0<c&&xl.Iyb(b,
h,c-1)?(b=this.Iq.uI(b,h,c-1),a=this.Pb.Nc(a.qf(b.ke,b.fe))):(m=5,b=this.Iq.uI(b,h,c),a=this.Pb.Nc(a.qf(b.ke,b.fe)));m=this.c1f(a,m);return{returnValue:!0,Vka:m}}RCh(a,b,c,h){const m=xl.bDh(b,c,h);if(!m.returnValue)return{returnValue:!1,Vka:null};h=0;0<c&&xl.abb(b,m.fe,c-1)?(b=this.Iq.uI(b,c-1,m.fe),a=this.Pb.Nc(a.qf(b.ke,b.fe))):(h=7,b=this.Iq.uI(b,c,m.fe),a=this.Pb.Nc(a.qf(b.ke,b.fe)));return{returnValue:!0,Vka:this.c1f(a,h)}}SKb(a,b,c,h,m,y){const G=b.rowSpan;b=b.colSpan;for(let U=c;U<c+G;U++)for(let ja=
h;ja<h+b;ja++)a.SKb(U,ja,m,y);return a}c1f(a,b){a=a.xq;if(!a||!a.cellShading)return null;let c=null;({Vka:c}=this.Uk.k1e(b,a.cellShading));return c}ntb(a,b,c,h){if(a!==b&&!a.id.equals(b.id)){var m=null;b.cellShading&&(m=vg.a.oSa(b,X.a.cellShading));m&&({Vka:b}=this.Uk.k1e(h,m),xl.Gpc(c,a,b))}}wtl(a,b,c,h,m){let y;({ke:y}=xl.iDh(c,h,m)).returnValue&&(m=6,0<h&&xl.Iyb(c,y,h-1)?c=this.Iq.uI(c,y,h-1):(m=5,c=this.Iq.uI(c,y,h)),b=b.qf(c.ke,c.fe),this.ntb(a,b,6,m))}vtl(a,b,c,h,m){let y;({fe:y}=xl.bDh(c,h,
m)).returnValue&&(m=0,0<h&&xl.abb(c,y,h-1)?c=this.Iq.uI(c,h-1,y):(m=7,c=this.Iq.uI(c,h,y)),b=b.qf(c.ke,c.fe),this.ntb(a,b,0,m))}static Gpc(a,b,c){let h=null;b.cellShading&&(h=b.cellShading);if(h){switch(a){case 7:h.lnTField=c;break;case 0:h.lnBField=c;break;case 5:h.lnLField=c;break;case 6:h.lnRField=c}b.cellShading=h}}static iDh(a,b,c){let h,m;h=c;m=c+1;if(!xl.abb(a,b,c))return{returnValue:!1,ke:h,ag:m};for(;0<h&&!(0<b&&xl.Iyb(a,h,b-1))&&!(b<a.sR&&xl.Iyb(a,h,b));h--);for(;m<a.OO&&!(0<b&&xl.Iyb(a,
m,b-1))&&!(b<a.sR&&xl.Iyb(a,m,b));m++);return{returnValue:!0,ke:h,ag:m}}static bDh(a,b,c){let h;h=c;for(c+=1;0<h&&!(0<b&&xl.abb(a,h,b-1))&&!(b<a.OO&&xl.abb(a,h,b));h--);for(;c<a.sR&&!(0<b&&xl.abb(a,c,b-1))&&!(b<a.OO&&xl.abb(a,c,b));c++);return{returnValue:!0,fe:h,Nf:c}}static abb(a,b,c){return 0<b&&!(a.ns(c,b-1)&2)||b<a.sR&&!(a.ns(c,b)&1)?!1:!0}static Iyb(a,b,c){return 0<b&&!(a.ns(b-1,c)&8)||b<a.OO&&!(a.ns(b,c)&4)?!1:!0}}Object(n.a)(xl,"TableBorderEditor",null,[1235,1236]);class xL{constructor(a,
b,c,h){this.Noe=!1;this.B0=a;this.Jck=b;this.NEb=c;this.Tve=h;this.ji=Array(this.B0.BY);for(a=0;a<this.B0.BY;a++)for(this.ji[a]=Array(this.B0.Nra),b=0;b<this.B0.Nra;b++)this.ji[a][b]=new jq.a}N2i(a,b,c){this.Noe||(this.Jck.sYk(a,this.B0),this.Noe=!0);if(Rd.a("BugFixCacheInvalidIndex")){if(this.ji&&0<=b&&b<this.ji.length&&this.ji[b]&&0<=c&&c<this.ji[b].length)return this.ji[b][c];a=String.format("GetBorderStylePropertySet : Illegal cache access m_cache : {0} ,  row : {1}, col : {2} ",this.ji,b,c);
this.ji&&(a+=String.format(" m_cache.Length : {0} ",this.ji.length),a=this.ji[b]?a+String.format(" m_cache[ row ].Length : {0} ",this.ji[b].length):a+" m_cache[ row ] is null ");Ba.a.J(559724692,822,15,a);return null}return this.ji[b][c]}SKb(a,b,c,h){var m=this.NEb.Ekh(c,this.B0.Ne,h);a=this.ji[a][b];for(var y of m.Tz())a.te(y,m.Lh(y));this.Tve&&Rd.a("TableBordersLocalRenderingFix")&&({OPa:m,i6a:c,Mrb:y}=Fp.LSa(c),h.wFieldSpecified&&(h.noFillField?a.te(m,0):a.te(m,te.a.F_d(h.wField))),h.solidFillField&&
a.te(c,h.solidFillField),h.prstDashField&&a.te(y,h.prstDashField))}dispose(){this.ji=null;this.Noe=!1}}Object(n.a)(xL,"TableBorderStyleCache",null,[1234,106]);class OD{constructor(a){this.Nxe=a?1:0}zMd(a){const b=a.Wz;a=a.oE;return b.fe%2===this.Nxe&&a.Oub(b)}}Object(n.a)(OD,"BandedColumnFilter",null,[1272]);class PD{constructor(a){this.Nxe=a?1:0}zMd(a){const b=a.Wz;a=a.oE;return b.ke%2===this.Nxe&&a.Oub(b)}}Object(n.a)(PD,"BandedRowFilter",null,[1272]);class yL{constructor(){this.diagBL2TR=this.right=
this.insideVer=this.left=this.diagTL2BR=this.bottom=this.insideHor=this.top=null}O2i(){let a=0;this.top&&(a|=1);this.insideHor&&(a|=2);this.bottom&&(a|=4);this.diagTL2BR&&(a|=8);this.left&&(a|=16);this.insideVer&&(a|=32);this.right&&(a|=64);this.diagBL2TR&&(a|=128);return a}Swb(a){switch(a){case 1:return this.top;case 2:return this.insideHor;case 4:return this.bottom;case 8:return this.diagTL2BR;case 16:return this.left;case 32:return this.insideVer;case 64:return this.right;case 128:return this.diagBL2TR;
default:return null}}}Object(n.a)(yL,"TableBorderSet",null,[]);class zL{constructor(a,b){this.Y4=a;this.Pck=b}sYk(a,b){const c=b.BY,h=b.Nra;var m=b.tableLook;b=b.tableStyle;const y=this.Pck.create(a),G=!!(m&32)&&!!b.firstRowField,U=!!(m&64)&&!!b.lastRowField,ja=!!(m&128)&&!!b.firstColField,va=!!(m&256)&&!!b.lastColField,Ta=G&&ja&&!!b.nwCellField,fb=G&&va&&!!b.neCellField,Db=U&&ja&&!!b.swCellField,gc=U&&va&&!!b.seCellField;var hc=!(m&512)&&!!b.band1HField,Gc=!(m&512)&&!!b.band2HField,Pc=!(m&1024)&&
!!b.band1VField;const yc=!(m&1024)&&!!b.band2VField;m=new fr.a;b.wholeTblField&&(m.ke=0,m.ag=c,m.fe=0,m.Nf=h,this.apply(a,y,b.wholeTblField,m));m.ke=G?1:0;m.ag=c-(U?1:0);m.fe=0;m.Nf=h;hc&&(hc=new PD(G),this.apply(a,y,b.band1HField,m,hc));Gc&&(Gc=new PD(!G),this.apply(a,y,b.band2HField,m,Gc));m.ke=0;m.ag=c;m.fe=ja?1:0;m.Nf=h-(va?1:0);Pc&&(Pc=new OD(ja),this.apply(a,y,b.band1VField,m,Pc));yc&&(Pc=new OD(!yc),this.apply(a,y,b.band2VField,m,Pc));va&&(m.ke=0,m.ag=c,m.fe=h-1,m.Nf=h,this.apply(a,y,b.lastColField,
m));ja&&(m.ke=0,m.ag=c,m.fe=0,m.Nf=1,this.apply(a,y,b.firstColField,m));U&&(m.ke=c-1,m.ag=c,m.fe=0,m.Nf=h,this.apply(a,y,b.lastRowField,m),gc&&(m.fe=h-1,m.Nf=h,this.apply(a,y,b.seCellField,m)),Db&&(m.fe=0,m.Nf=1,this.apply(a,y,b.swCellField,m)));G&&(m.ke=0,m.ag=1,m.fe=0,m.Nf=h,this.apply(a,y,b.firstRowField,m),fb&&(m.fe=h-1,m.Nf=h,this.apply(a,y,b.neCellField,m)),Ta&&(m.fe=0,m.Nf=1,this.apply(a,y,b.nwCellField,m)))}apply(a,b,c,h,m=null){if(!h.JRa()&&c&&c.tcStyleField&&(c=c.tcStyleField.tcBdrField)){const y=
new yL;c.topField&&c.topField.itemField&&(y.top=c.topField.itemField);c.bottomField&&c.bottomField.itemField&&(y.bottom=c.bottomField.itemField);c.insideHField&&c.insideHField.itemField&&(y.insideHor=c.insideHField.itemField);c.leftField&&c.leftField.itemField&&(y.left=c.leftField.itemField);c.rightField&&c.rightField.itemField&&(y.right=c.rightField.itemField);c.insideVField&&c.insideVField.itemField&&(y.insideVer=c.insideVField.itemField);this.Y4.cTe(a,b,h,y,m)}}}Object(n.a)(zL,"TableBorderStyleResolver",
null,[493]);class Jv{constructor(){}Boi(a,b){const c=new fr.a;if(a.JRa())return c;const h=Jv.WTf(b,a,a.ke,!0),m=Jv.WTf(b,a,a.ag-1,!1),y=Jv.xTf(b,a,a.fe,!0);a=Jv.xTf(b,a,a.Nf-1,!1);c.ke=h;c.ag=m+1;c.fe=y;c.Nf=a+1;return c}HIj(a,b){for(var c=a.ke;c<a.ag;++c)if(!(b.ns(c,a.fe)&1&&b.ns(c,a.Nf-1)&2))return!1;for(c=a.fe;c<a.Nf;++c)if(!(b.ns(a.ke,c)&4&&b.ns(a.ag-1,c)&8))return!1;return!0}lYf(a){let b;b=null;const c=new fr.a;if(!(a&&a.Gl&&a.mb&&a.g6))return{returnValue:c,tableNode:b};var h=a.ga(0).kg.Ua,m=
Object(ua.a)(Tl.TableCellNode,h.node);m&&(b=m.getContainingTable());if(!m||!b)return{returnValue:c,tableNode:b};h=m.rowIndex;m=m.pi;var y=Object(ua.a)(Tl.TableCellNode,a.ga(0).kg.Ye.node);var G=0;y&&(G=y.pi+1);if(b.Lp()&&1!==a.length){G=Object(ua.a)(Tl.TableCellNode,a.o0a.currentNode);h=Object(ua.a)(Tl.TableCellNode,a.qja.currentNode);if(!G||!h)return{returnValue:c,tableNode:b};m=G.rowIndex;a=G.pi;y=h.rowIndex;G=h.pi;h=Math.min(m,y);y=Math.max(m,y)+1;m=Math.min(a,G);G=Math.max(G,a)+1}else y=h+a.length;
c.ke=h;c.ag=y;c.fe=m;c.Nf=G;return{returnValue:c,tableNode:b}}uI(a,b,c){b=Object.assign(new fr.a,{ke:b,ag:b+1,fe:c,Nf:c+1});return this.nOc(a,b)}nOc(a,b){const c=new fr.a;let h=b.ke,m=b.ag-1;for(var y=b.fe;y<b.Nf;y++){for(var G=b.ke;0<G&&!(a.ns(G,y)&4);G--);G<h&&(h=G);G=b.ag-1;for(var U=a.OO-1;G<U&&!(a.ns(G,y)&8);G++);G>m&&(m=G)}y=b.fe;G=b.Nf-1;for(U=b.ke;U<b.ag;U++){let ja=b.fe;for(;0<ja&&!(a.ns(U,ja)&1);ja--);ja<y&&(y=ja);ja=b.Nf-1;for(const va=a.sR-1;ja<va&&!(a.ns(U,ja)&2);ja++);ja>G&&(G=ja)}c.ke=
h;c.fe=y;c.Nf=G+1;c.ag=m+1;return c}static WTf(a,b,c,h){if(h)for(;0<c;c--)for(h=b.fe;h<b.Nf;++h){if(a.ns(c,h)&4)return c}else for(h=a.OO-1;c<h;c++)for(let m=b.fe;m<b.Nf;++m)if(a.ns(c,m)&8)return c;return c}static xTf(a,b,c,h){if(h)for(;0<c;c--)for(h=b.ke;h<b.ag;++h){if(a.ns(h,c)&1)return c}else for(h=a.sR-1;c<h;++c)for(let m=b.ke;m<b.ag;++m)if(a.ns(m,c)&2)return c;return c}}Object(n.a)(Jv,"TableCellSelectionHelper",null,[488]);class AL{constructor(a,b,c){this.SQ=null;this.h4=!1;if(!a||!a.isConnected||
14!==a.type)throw Error.argument("tableNode");this.ae=a;this.yc=b;this.WX=c;this.EX=3}O3e(){try{var a=rb.GraphIterator.nb(this.ae);Gd.forEachCellInTable(a,(b,c,h)=>{var m=Object(ua.a)(123,b.currentNode);if(m&&!m.isGhostCell){b=m.rowSpan+c;m=m.colSpan+h;for(let y=c;y<b;++y)for(let G=h;G<m;++G)y===c&&(this.SQ[y][G]|=4),y===b-1&&(this.SQ[y][G]|=8),G===h&&(this.SQ[y][G]|=1),G===m-1&&(this.SQ[y][G]|=2)}return!0})}catch(b){a=this.WX.i_d(this.ae),Ba.a.J(38043909,822,15,"TableLayoutInfo:{0}, Message:{1}",
a,b.message)}}validate(){if(this.h4)throw Error.invalidOperation("cache disposed");if(0!==this.EX){if(3===(this.EX&3)){const a=this.yc.rk(this.ae),b=this.yc.Ai(this.ae);this.SQ=Array(a);for(let c=0;c<a;++c){this.SQ[c]=Array(b);for(let h=0;h<b;++h)this.SQ[c][h]=0}}1===(this.EX&1)&&this.O3e();this.EX=0}}ns(a,b){try{this.validate();var c=this.SQ[a][b]}catch(h){c=this.WX.i_d(this.ae),Ba.a.J(38043911,822,15,"NumRows:{0} NumCols:{1} Row:{2} Col:{3}, TableLayoutInfo:{4}, Message:{5}",this.OO,this.sR,a,b,
c,h.message),c=0}return c}VTa(a){this.EX|=a}dispose(){this.h4=!0;this.SQ=null}get OO(){this.validate();return this.SQ?this.SQ.length:0}get sR(){this.validate();return this.SQ&&this.SQ.length?this.SQ[0].length:0}}Object(n.a)(AL,"TableInfoCache",null,[1267,106]);class BL{constructor(a,b){this.yc=a;this.WX=b}create(a){return new AL(a,this.yc,this.WX)}}Object(n.a)(BL,"TableInfoCacheFactory",null,[499]);class Qz{constructor(a,b,c,h,m,y){this.pbk=a;this.F4j=b;this.Sck=c;this.w9j=h;this.idk=m;this.Xck=y}get BY(){return this.pbk()}get Nra(){return this.F4j()}get tableLook(){return this.Sck()}get NYj(){return this.w9j()}get Ne(){return this.idk()}get tableStyle(){return this.Xck()}static hJf(a,
b,c,h,m,y){return new Qz(a,b,c,h,m,y)}}Object(n.a)(Qz,"TableListStyleParams",null,[371]);class CL{constructor(a){this.Kma=null;this.O5c=!1;this.BAe=this.WAb=null;this.Pb=a}get aKj(){return!!this.WAb}Tah(a,b){this.BAe=a.id.toString();this.O5c=!this.Pb.g9i(a).currentNode.sc(b).nZc();this.WAb=null;this.O5c&&(a=a.sc(b),this.iRi(),La.a.h0b(a.htmlElement,this.Kma),this.WAb=this.gXi(this.Kma))}u4b(a,b,c,h){if(a.id.toString()!==this.BAe)throw Error.argument("table","Wrong table metrics");if(this.O5c){if(!this.WAb)throw Error.invalidOperation("m_clonedTableNode is null");
a=this.WAb.rows[c].cells[h];c=a.lastChild;c.className!==b.className&&(ba.ULS.sendTraceTag(587465758,808,10,"Cell content DOM structure changed, last child {0}",c.className),c=La.a.Pca(a,b.className));if(!c)throw Error.invalidOperation("No content");b=c}return b.offsetHeight}reset(){La.a.kUa(this.Kma)&&this.Kma.parentNode.removeChild(this.Kma);this.WAb=this.Kma=null;this.O5c=!1;this.BAe=null}i_d(a){const b=new Sys.StringBuilder;try{b.append(String.format("Row:{0},Col:{1},",a.properties.sa(kb.a.Tya,
0),a.properties.sa(kb.a.kga,0)));const c=this.Pb.Nc(a);Gd.forEachCellInTable(c,(h,m,y)=>{var G=h.currentNode;h=G.rowSpan;G=G.colSpan;(1<h||1<G)&&b.append(String.format("C[{0}][{1}]:{2}|{3},",m,y,h,G));return!0});return b.toString()}catch(c){return b.append(c.message),b.toString()}}iRi(){this.Kma||(this.Kma=document.createElement("div"),this.Kma.className="TableMetricsWorkingDiv",document.body.appendChild(this.Kma));La.a.aCa(this.Kma)}gXi(a){for(a=a.firstChild;a;){if("table"===a.nodeName.toLowerCase())return a;
a=a.nextSibling}return null}}Object(n.a)(CL,"TableMetrics",null,[496]);class DL{constructor(a){this.jA=a}tYk(a,b,c){return b&&a&&c&&(a=this.jA.FTc(a).CZf(c,b.rowIndex,b.pi,b.rowSpan,b.colSpan))&&a!==hb.a.auto?a.lD:-1}}Object(n.a)(DL,"TableThemeColorHelper",null,[500]);class EL{constructor(a){this.Iq=a}QGi(a,b){return new ND(a,this.Iq,b)}}Object(n.a)(EL,"VerticalTableBorderIteratorFactory",null,[492]);class QD{constructor(){this.K=null}get name(){return"PowerPointWebEditor.Table"}$b(a){this.K=a;this.K.register(488,
"PowerPointWebEditor.ITableCellSelectionHelper").ma().oa(()=>new Jv);a.register(489,"Box4.ITableDragSelectionCellExtendStrategy").ma().oa(()=>new aL(this.K.resolve("PowerPointWebEditor.Graph.ITableReader"),this.K.resolve("PowerPointWebEditor.IPptTableDragSelectionHelper"),this.K.resolve("PowerPointWebEditor.ShapeManipulation.IPPTDragSelectionDragAdapter")));this.K.register(xl,"PowerPointWebEditor.TableBorderEditor").as("PowerPointWebEditor.ITableBorderEditor").as("PowerPointWebEditor.ITableBorderHelper").ma().oa(()=>
new xl(this.K.resolve("PowerPointWebEditor.ITableStyleReaderHelper"),this.K.resolve("PowerPointWebEditor.ITableCellSelectionHelper"),this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.IPPTTableStyleReader"),this.K.resolve("PowerPointWebEditor.ICellIteratorFactory"),this.K.resolve("PowerPointWebEditor.IHorizontalTableBorderIteratorFactory"),this.K.resolve("PowerPointWebEditor.IVerticalTableBorderIteratorFactory")));this.K.register(490,"PowerPointWebEditor.ICellIteratorFactory").ma().oa(()=>
new rL(this.K.resolve("PowerPointWebEditor.ITableCellSelectionHelper")));this.K.register(491,"PowerPointWebEditor.IHorizontalTableBorderIteratorFactory").ma().oa(()=>new sL(this.K.resolve("PowerPointWebEditor.ITableCellSelectionHelper")));this.K.register(492,"PowerPointWebEditor.IVerticalTableBorderIteratorFactory").ma().oa(()=>new EL(this.K.resolve("PowerPointWebEditor.ITableCellSelectionHelper")));this.K.register(493,"PowerPointWebEditor.ITableBorderStyleResolver").ma().oa(()=>new zL(this.K.resolve("PowerPointWebEditor.ITableBorderEditor"),
this.K.resolve("PowerPointWebEditor.ITableInfoCacheFactory")));this.K.register(dm,"PowerPointWebEditor.TableEditor").as("PowerPointWebEditor.ITableEditor").as("Box4.ITableEditor").ma().oa(()=>new dm(this.K.resolve("Box4.IOutlineEditor"),this.K.resolve("Box4.IOutlineElementEditor"),this.K.resolve("PowerPointWebEditor.ITableStyleReaderHelper"),this.K.resolve("PowerPointWebEditor.Graph.ITraverserFactory"),this.K.resolve("PowerPointWebEditor.Graph.ITableRowReader"),this.K.resolve("PowerPointWebEditor.Graph.ITableColumnReader"),
this.K.resolve("PowerPointWebEditor.Graph.ITableReader"),this.K.resolve("PowerPointWebEditor.ITableBorderEditor"),this.K.resolve("PowerPointWebEditor.ITableInfoCacheFactory"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptFixCellSizeWithBorder,this.K.resolve("Box4.IPageView").Ma));this.K.register(ID,"PowerPointWebEditor.TableNodeBehavior").ma().oa(()=>new ID(this.K.resolve("Box4.Graph.IGraphInstance").Ad(14),this.K.resolve("Box4.ITableNodeBehaviorHelper"),this.K.resolve("Box4.IPageView").Ma,
this.K.resolve("PowerPointWebEditor.IApplicationSettings").w$d));this.K.register(452,"PowerPointWebEditor.ITableStyleReaderHelper").ma().oa(()=>new Fp(this.K.resolve("Box4.IPageView").Ld,this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.resolve("PowerPointWebEditor.ITableStyleResolver"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").o_c));this.K.register(Nz,"PowerPointWebEditor.TableStyleReader").as("Box4.Styles.ITableStyleReader").as("PowerPointWebEditor.IPPTTableStyleReader").as("PowerPointWebEditor.ITableStyleCacheHelper").ma().oa(()=>
new Nz(this.K.resolve("PowerPointWebEditor.Graph.IPptGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.resolve("PowerPointWebEditor.IPptListCore"),this.K.resolve("PowerPointWebEditor.ITableStyleReaderHelper"),this.K.resolve("Box4.IPageView").Ld,this.K.resolve("PowerPointWebEditor.ITableStyleGalleryManager"),this.K.resolve("Box4.Graph.IGraphInstance").Ad(14),this.K.resolve("PowerPointWebEditor.IPresentationReader"),Qz.hJf,b=>new JD(b,a.resolve("PowerPointWebEditor.ITableStyleResolver")),
b=>new HD(b),b=>new xL(b,a.resolve("PowerPointWebEditor.ITableBorderStyleResolver"),a.resolve("PowerPointWebEditor.ITableStyleResolver"),a.resolve("PowerPointWebEditor.IApplicationSettings").X$),this.K.resolve("PowerPointWebEditor.Graph.ITableReader"),this.K.resolve("Box4.ITableRowReader"),this.K.resolve("PowerPointWebEditor.Graph.ITableColumnReader"),this.K.resolve("Common.IBrowserUtils"),this.K.resolve("PowerPointWebEditor.View.IViewEventHandlers"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").Aeg,
this.K.resolve("PowerPointWebEditor.IApplicationSettings").OTj,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptNewResolveTableBorderStyleEnabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptRenderNonActiveTableAsyncEnabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").X$));this.K.register(494,"PowerPointWebEditor.ITableStyleResolver").ma().oa(()=>new mL(this.K.resolve("PowerPointWebEditor.IApplicationSettings").X$));this.K.register(495,"PowerPointWebEditor.ITableStyleGalleryManager").ma().oa(()=>
new pL(this.K.Ja("PowerPointWebEditor.IPresentationResourcesManager")));this.K.register(496,"PowerPointWebEditor.ITableMetrics").ma().oa(()=>new CL(this.K.resolve("Box4.Graph.IGraphIteratorFactory")));this.K.register(497,"PowerPointWebEditor.IPPTTableLayoutServiceFactory").ma().oa(()=>new vL(this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("Common.ITaskManager"),this.K.resolve("Box4.ITableCellReader"),this.K.resolve("PowerPointWebEditor.ITableStyleReaderHelper"),this.K.resolve("PowerPointWebEditor.ITableMetrics")));
this.K.register(498,"PowerPointWebEditor.IPPTTableLayoutServiceManager").ma().oa(()=>new wL(this.K.resolve("PowerPointWebEditor.IPPTTableLayoutServiceFactory"),this.K.resolve("Common.IBrowserUtils"),this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("Box4.Graph.IGraphInstance").Ad(14),this.K.resolve("Box4.Graph.IGraphInstance").Ad(15),this.K.resolve("Box4.Graph.IGraphInstance").Ad(16),this.K.resolve("Box4.Graph.IGraphInstance").Ad(12),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),
this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptComplexTableLayoutSyncEnabled));this.K.register(FD,"PowerPointWebEditor.TableCellNodeBehavior").ma().oa(()=>new FD(this.K.resolve("Box4.Graph.IGraphInstance").Ad(16),this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("Box4.ITableNavigator"),this.K.resolve("PowerPointWebEditor.IPPTTableStyleReader")));this.K.register(XK,"Box4.TableReaderProxy").as("Box4.ITableReader").ma();this.K.register(YK,"Box4.TableRowReaderProxy").as("Box4.ITableRowReader").ma();
this.K.register(uQ.a,"Box4.TableCellReaderProxy").as("Box4.ITableCellReader").ma();this.K.register(499,"PowerPointWebEditor.ITableInfoCacheFactory").ma().oa(()=>new BL(this.K.resolve("Box4.ITableReader"),this.K.resolve("PowerPointWebEditor.ITableMetrics")));this.K.register(500,"PowerPointWebEditor.ITableThemeColorHelper").ma().oa(()=>new DL(this.K.resolve("PowerPointWebEditor.IPPTTableStyleReader")))}init(){const a=this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptTextFormatPainterIsEnabled,
b=this.K.resolve("Common.IActionManagerExtended");this.K.resolve("PowerPointWebEditor.ITableThemeColorHelper");this.K.resolve("PowerPointWebEditor.View.IPPTPageViewDomManager").lJb(1,new Iv(this.K.resolve("PowerPointWebEditor.ViewCore.IFormatPainterContext"),this.K.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IPPTUnitConversion"),this.K.resolve("PowerPointWebEditor.ITableEditor"),this.K.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementUtility"),
this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptCursorContainerManagerIsEnabled?this.K.resolve("PowerPointWebEditor.ShapeManipulation.ICursorContainerManager"):null,a),new iL(this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),this.K.resolve("Common.CursorManager"),this.K.resolve("PowerPointWebEditor.IPPTUnitConversion"),this.K.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),this.K.resolve("PowerPointWebEditor.ITableStyleReaderHelper"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptFixCellSizeWithBorder,
this.K.resolve("PowerPointWebEditor.TableEditor"),this.K.resolve("PowerPointWebEditor.Graph.ITableReader"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("Box4.Styles.ITableStyleReader"),this.K.resolve("PowerPointWebEditor.IPptTableDragSelectionHelper"),this.K.resolve("PowerPointWebEditor.IViewElementHelper"),b,a),new hL(this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),this.K.resolve("Common.CursorManager"),this.K.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),
this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptFixCellSizeWithBorder,this.K.resolve("PowerPointWebEditor.TableEditor"),this.K.resolve("PowerPointWebEditor.Graph.ITableReader"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("Box4.Styles.ITableStyleReader"),b,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptIsTableColumnRowResizeHandleRenderedByCSSEnabled,a));this.K.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementFactoryHelper").extend(393250,
new Ke.a((c,h)=>new Hl(c,h,this.K.resolve("Box4.IListMarkerUtility"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.IPPTTableStyleReader"),this.K.resolve("PowerPointWebEditor.ITableStyleReaderHelper"),this.K.resolve("Common.IBrowserUtils"),this.K.resolve("PowerPoint.IBrowserHelperManager"),m=>Mx.u0b(m),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.IPPTTableLayoutServiceManager"),this.K.resolve("PowerPointWebEditor.Core.IPkgLoadStatusContext"),
this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.resolve("PowerPointWebEditor.IZoomContext"),this.K.resolve("PowerPointWebEditor.Graph.ITableReader"),this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.ISlideDimensionsHelper"))));this.K.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementFactoryHelper").extend(393251,new Ke.a((c,h)=>new Hv(c,h,new Hc.a(c,h,Hc.a.eol))));this.K.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementFactoryHelper").extend(393252,
new $K(this.K.resolve("Box4.ITableCellReader"),this.K.resolve("Box4.Styles.IStyleReader"),new Ke.a((c,h)=>new Zs(c,h,this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("Box4.IListMarkerUtility"),this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.IPPTTableStyleReader"),this.K.resolve("PowerPointWebEditor.ITableStyleReaderHelper"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),this.K.resolve("PowerPointWebEditor.CoreExt.ICoauthEventNotifier"),
this.K.resolve("Box4.ITableReader"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptFixCellSizeWithBorder,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptIsTableColumnRowResizeHandleRenderedByCSSEnabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").cka,this.K.resolve("PowerPointWebEditor.IApplicationSettings").X$,this.K.resolve("PowerPointWebEditor.IPptSelectionManager")))));Ya.StyleReader.kr=this.K.resolve("Box4.Styles.ITableStyleReader");this.K.resolve("PowerPointWebEditor.TableNodeBehavior");
this.K.resolve("PowerPointWebEditor.TableCellNodeBehavior");this.K.resolve("PowerPointWebEditor.IPPTTableLayoutServiceManager")}dispose(){this.K.resolve("PowerPointWebEditor.IPPTTableLayoutServiceManager").dispose()}static main(){r.a.instance.Dc(new QD)}}Object(n.a)(QD,"PPTWebEditorTablePackage",null,[2,3]);var yQ=d(1217),Ph=d(109);class FL{constructor(){this.podsUrl=this.fileUrl=null}}Object(n.a)(FL,"IFileInfo",null,[]);class GL extends Sys.EventArgs{constructor(a){super();this.slideIndex=a.SlideIndex}}
Object(n.a)(GL,"OnPresenterViewSyncMessageEventArgs",Sys.EventArgs,[]);class HL{constructor(){this.messageType=0;this.data=this.sender=null}}Object(n.a)(HL,"IPresentationMessage",null,[]);class IL{constructor(){this.useDefaultResourceProvider=this.thumbnailsEnabled=!1;this.presenterWindowWidth=this.presenterWindowHeight=0}}Object(n.a)(IL,"IPresenterViewSettings",null,[]);class JL{constructor(){this.uiHost=this.userSessionId=null}}Object(n.a)(JL,"ISessionInfo",null,[]);var zQ=d(530);class KL{constructor(a,
b,c){this.WQ="";this.x9=null;this.qdb=!1;this.LDb=null;this.va=new bd.a;this.ia=a;this.la=b;this.Lc=c;this.NDk()}vb(){this.ia.ra(M.a.ZIb,nc.a.application,Object(F.a)(this,this.ZIb,"queryUsePresenterView"),96);this.ia.ya(M.a.B3e,nc.a.application,Object(F.a)(this,this.Uql,"toggleUsePresenterView"));this.ia.ya(M.a.Cpd,xb.a.application,Object(F.a)(this,this.Cpd,"showPresenterView"));this.ia.ya(M.a.lJc,nc.a.application,Object(F.a)(this,this.lJc,"closePresenterView"));this.qdb=u.AFrameworkApplication.fa.ka("PptPresenterViewEnabled")}ZIb(a,
b,c,h,m){(a=Object(ua.a)(Ph.a,m))&&a.Qf(this.qdb);return 32}Uql(a,b,c){if(1===c&&!u.AFrameworkApplication.fa.ka("PptPresenterViewEnabled"))return Ba.a.J(512496092,830,10,"PresenterViewManager: presenter view is not enabled but ToggleUsePresenterView is triggered."),8;2===c&&(this.qdb=!this.qdb,this.Lc.sz(new Gp.a(1)));return 32}Cpd(a,b,c){try{if(!u.AFrameworkApplication.fa.ka("PptPresenterViewEnabled"))return Ba.a.J(512496091,822,10,"PresenterViewManager: ShowPresenterView triggered but feature is disabled by BRS."),
2;if(2===c&&0<this.WQ.length){if(!this.LDb){const h=this.la.podsWebServiceBase,m=String.format("{0}presenter.aspx",h),y=new FL;y.fileUrl=this.WQ;y.podsUrl=h;const G=new JL;G.userSessionId=u.AFrameworkApplication.userSessionId;G.uiHost="UnifiedApp";const U=new IL;U.presenterWindowWidth=1024;U.presenterWindowHeight=576;this.LDb=new PresenterView.PresentationProxy(2,m,y,G,U)}this.LDb.startPresentation();this.LDb.subscribe(Object(F.a)(this,this.wrk,"onPresentationChannelMessageHandler"))}return 32}catch(h){return Ba.a.J(512496090,
822,10,"PresenterViewManager: Failed to handle ShowPresenterView: {0}",h),16}}lJc(a,b,c){2===c&&(Ba.a.J(512496089,822,50,"PresenterViewManager: ClosePresenterView called"),this.LDb.terminatePresentation());return 32}D9h(a){this.va.addHandler("OnPresenterViewSyncMessageReceived",a)}p3k(a){a=this.gfi(a);this.LDb.sendMessage(a)}gfi(a){const b=new HL;b.sender="slideshow";b.messageType=1;b.data=JSON.stringify({["slideLocation"]:{["slideId"]:{["sid"]:a.slideId,["cid"]:0},["slideIndex"]:a.slideIndex},["timelineMappings"]:a.Gsc});
return b}wrk(a){try{if(!a||0>=a.length)Ba.a.J(512496088,830,15,"No message");else{var b=JSON.parse(a),c=b.sender;if(c&&"slideshow"!==c)switch(b.messageType||Ba.a.J(512496087,830,15,"No message"),b.messageType){case 1:const m=b.data;if(m&&!(0>=m.length)){var h=JSON.parse(m).slideLocation.slideIndex;this.va.raiseEvent("OnPresenterViewSyncMessageReceived",new GL({["SlideIndex"]:h}))}}}}catch(m){Ba.a.J(512496086,830,10,"Exception: {0}",m)}}NDk(){var a=vb.a.instance.resolve("PowerPointWebEditor.ISessionInfoOwner").podSessionId,
b=vb.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").podsWebServiceBase;a=String.format("{0}PodHandler.ashx?action=GetSnappedDownloadLink&PodSID={1}",b,a);b=new yQ.a(u.AFrameworkApplication.Je);this.x9=zQ.b(b.HSe(a));this.x9.then(c=>{try{const h=JSON.parse(c),m=h.downloadUrl;ta.a.Wa(m)?Ba.a.J(512496085,822,10,"PresenterViewManager: GetSnappedDownloadLink returned a bad response: {0}",h):this.WQ=m}catch(h){Ba.a.J(512496084,822,10,"PresenterViewManager: Failed to retreive document download URL: {0}",
h)}return null})}}Object(n.a)(KL,"PresenterViewManager",null,[519]);class RD{constructor(){this.qb=this.la=this.K=null;this.VBg=!1}get name(){return"PowerPointWebEditor.PresenterView"}$b(a){this.K=a;this.la=this.K.resolve("PowerPointWebEditor.IApplicationSettings");this.qb=this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame").AF()}init(){u.AFrameworkApplication.fa.jf(Object(F.a)(this,this.Om,"onFullAppSettingsReady"))}Om(){try{(this.VBg=u.AFrameworkApplication.fa.ka("PptPresenterViewEnabled"))&&
this.K.resolve("Common.IDynamicScriptLoaderProvider").Pw.loadScript("presenterView").catch(a=>Ba.a.J(594031833,830,10,"Failed to load presenterView js: {0}",a)).then(()=>this.yrk()).catch(a=>Ba.a.J(594031831,830,10,"Failure in OnPresenterScriptLoaded: {0}",a))}catch(a){ba.ULS.sendTraceTag(594031830,811,10,"PPTWebEditorPresenterViewPackage: exception in OnFullAppSettingsReady: {0}",a)}}yrk(){this.v0b();return null}v0b(){const a=document.createElement("link");a.setAttribute("rel","stylesheet");a.setAttribute("type",
"text/css");a.setAttribute("href",u.AFrameworkApplication.fa.Ha("PPTPresenterViewCssUrl"));this.qb.appendChild(a);this.K.register(519,"PowerPointWebEditor.PresenterView.IPresenterViewManager").oa(()=>new KL(u.AFrameworkApplication.Ta,this.la,this.K.resolve("PowerPointWebEditor.View.IViewEventSource"))).ma();this.K.resolve("PowerPointWebEditor.PresenterView.IPresenterViewManager").vb()}dispose(){}static main(){r.a.instance.Dc(new RD)}}Object(n.a)(RD,"PPTWebEditorPresenterViewPackage",null,[2,3]);class LL{constructor(a){this.Yda=
a}rGi(a,b,c){if(c.JRa())return null;a=this.Yda.gDa(a,b,c);for(b=Array(b.OO);a.moveNext();){c=a.t4b();var h=a.Wz;b[h.ke]||(b[h.ke]=[]);h=b[h.ke];h[h.length]=Yq.TableNodeContext.create(c)}a=[];for(c=0;c<b.length;++c)b[c]&&(a[a.length]=new Gb.Selection(b[c],!0));return new Ha.SelectionCollection(a,a.length-1,0)}}Object(n.a)(LL,"PPTSelectionFactory",null,[486]);class ML{constructor(a,b,c,h){this.Bve=this.Bma=this.Roe=null;this.D0h=a;this.CNh=b;this.Iq=c;this.JXa=h}get bpi(){return this.CNh}get wsb(){this.Roe||
(this.Roe=this.Iq.Boi(this.bpi,this.TY));return this.Roe}get tableNode(){return this.D0h}get TY(){this.Bma||(this.Bma=this.JXa.create(this.tableNode));return this.Bma}get rRj(){this.Bve||(this.Bve=this.Iq.HIj(this.wsb,this.TY));return this.Bve}}Object(n.a)(ML,"TableCellSelectionInfo",null,[]);class NL{constructor(a,b){this.JXa=a;this.Iq=b}create(a,b){return new ML(b,a,this.Iq,this.JXa)}}Object(n.a)(NL,"TableCellSelectionInfoFactory",null,[484]);var AQ=d(995);class OL{constructor(a,b,c){this.gUg=a;
this.Iq=b;this.iGa=c}S5b(a){let b=null;const c=new Date,h=({tableNode:a}=this.Iq.lYf(a)).returnValue,m=!h.JRa();m&&(b=this.gUg.create(h,a),Nc.a.Ib&&Nc.a.Ib.Va("CellRange",h.toString()));Ba.a.J(512495623,808,m?50:10,"Table cell selection range {0}, took {1}",h.toString(),+new Date-+c);return b}hij(a){if(!a)return null;var b=this.iGa.HA(a);let c=a=null;for(let m=0;m<b.length;++m)if(b[m].el){var h=Object(ua.a)(5,b[m].node);if(h){h=h.dL();if(!h)return null;if(!a)a=h,c=a.id.toString();else if(c!==h.id.toString())return null}}if(!a)return null;
b=Object.assign(new fr.a,{ke:a.rowIndex,fe:a.pi});b.ag=b.ke+1;b.Nf=b.fe+1;return this.gUg.create(b,a.getContainingTable())}}Object(n.a)(OL,"TableSelectionAdapter",null,[485]);class SD{constructor(){this.K=null}get name(){return"PowerPointWebEditor.TableMergeSplit"}$b(a){this.K=a;this.K.register(484,"PowerPointWebEditor.ITableCellSelectionInfoFactory").ma().oa(()=>new NL(this.K.resolve("PowerPointWebEditor.ITableInfoCacheFactory"),this.K.resolve("PowerPointWebEditor.ITableCellSelectionHelper")));this.K.register(485,
"PowerPointWebEditor.ITableSelectionAdapter").ma().oa(()=>new OL(this.K.resolve("PowerPointWebEditor.ITableCellSelectionInfoFactory"),this.K.resolve("PowerPointWebEditor.ITableCellSelectionHelper"),this.K.resolve("Box4.IContextSetEditor"),this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("Box4.ITableRowReader"),this.K.resolve("PowerPointWebEditor.Graph.ITableColumnReader"),this.K.resolve("Box4.ITableNavigator")));this.K.register(486,"PowerPointWebEditor.ISelectionFactory").ma().oa(()=>
new LL(this.K.resolve("PowerPointWebEditor.ICellIteratorFactory")));this.K.register(487,"PowerPointWebEditor.ITableMergeSplitEditor").ma().oa(()=>new AQ.TableMergeSplitEditor(this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("Box4.ITableNavigator"),this.K.resolve("Box4.Styles.ITableStyleReader"),this.K.resolve("PowerPointWebEditor.ITableBorderEditor"),this.K.resolve("PowerPointWebEditor.ITableBorderHelper"),this.K.resolve("PowerPointWebEditor.IGraphUtils"),this.K.resolve("PowerPointWebEditor.ITableEditor"),
this.K.resolve("Box4.ITableCellReader"),this.K.resolve("PowerPointWebEditor.ITableCellSelectionHelper"),this.K.resolve("PowerPointWebEditor.ICellIteratorFactory"),this.K.resolve("Box4.IOutlineEditor"),this.K.resolve("PowerPointWebEditor.ITableStyleReaderHelper"),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("Box4.ISelectionManager"),this.K.resolve("PowerPointWebEditor.ISelectionFactory")))}init(){}dispose(){}static main(){r.a.instance.Dc(new SD)}}Object(n.a)(SD,"PPTWebEditorTableMergeSplitPackage",
null,[2,3]);class fl{constructor(a,b,c,h,m,y,G,U){this.Upb=a;this.IKd=b;this.Ca=c;this.GKd=h;this.yk=m;this.Bt=y;this.fd=G;this.XTh=U}vb(){this.Gjd(Fc.App.zLa.DHf())}Gjd(a){this.Ca.ya(D.a.TIb,xb.a.view,a);this.Ca.ya(D.a.TIb,xb.a.table,Object(F.a)(this,this.TIb,"queryTableStyle"));this.Ca.he(D.a.TIb,103);this.Ca.ya(D.a.LZ,xb.a.view,Object(F.a)(this,this.MZe,"tableStyleGenericViewActionHandler"));this.Ca.ya(D.a.LZ,xb.a.table,Object(F.a)(this,this.LZ,"applyTableStyle"));this.Ca.he(D.a.LZ,6);this.Ca.ya(D.a.V5a,
xb.a.table,Object(F.a)(this,this.LZ,"applyTableStyle"));this.Ca.ya(D.a.MZ,xb.a.view,Object(F.a)(this,this.MZe,"tableStyleGenericViewActionHandler"));this.Ca.ya(D.a.MZ,xb.a.table,Object(F.a)(this,this.MZ,"applyTableStyleOption"));this.Ca.he(D.a.MZ,14);this.Ca.ya(D.a.Ena,xb.a.view,a);this.Ca.ya(D.a.Ena,xb.a.table,Object(F.a)(this,this.Ena,"queryTableStyleOption"));this.Ca.he(D.a.Ena,103);this.Ca.ya(D.a.uHb,xb.a.view,a);this.Ca.ya(D.a.uHb,xb.a.table,Object(F.a)(this,this.uHb,"populateMenuMoreTableStyles"));
this.Ca.he(D.a.uHb,102);this.Ca.ya(D.a.H6a,xb.a.view,Object(F.a)(this,this.MZe,"tableStyleGenericViewActionHandler"));this.Ca.ya(D.a.H6a,xb.a.table,Object(F.a)(this,this.H6a,"clearTableFormatting"));this.Ca.he(D.a.H6a,4)}TIb(a,b,c,h,m){if(!({qF:a}=this.gqc(b,c,m,!0,!0)).returnValue)return a;this.IKd.ACi(m,b.node);return 32}Ena(a,b,c,h,m){return this.o9f(b,c,h,m,!0)}uHb(a,b,c,h,m){if(!({qF:a}=this.gqc(b,c,m,!1,!0)).returnValue)return a;this.IKd.FDi(m,b.node);ba.ULS.sendTraceTag(7878019,324,50,"Gallery expanded");
return 32}LZ(a,b,c,h,m){if(!({qF:c}=this.gqc(b,c,m,!1,!0)).returnValue)return c;const y=b.node;let G=null;(G=a===D.a.LZ?this.IKd.brd(m[Zh.a.SourceControlId],y):null)?(this.DIe(y,()=>{this.GKd.K9k(G,y)}),c=32):c=8;a===D.a.LZ&&32===c&&ba.ULS.sendTraceTag(38410445,311,50,"ApplyTableStyle succeeded");ba.ULS.shipAssertTag(541172699,324,32===c);return c}MZ(a,b,c,h,m){return this.o9f(b,c,h,m,!1)}o9f(a,b,c,h,m){if(!({qF:b}=this.gqc(a,b,h,m,!0)).returnValue)return b;a=a.node;b=this.Upb.U6d(a);const y=h[Zh.a.On],
G=fl.jkj(u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.hb.Np?h.MenuItemId:h[Zh.a.SourceControlId]);m?h[Zh.a.On]=fl.Fdl(b,G):(this.cei(b,G,y,a),c.eQ=G,c.W7=y?0:1,ba.ULS.shipAssertTag(541172700,324,0!==G));return 32}MZe(a,b,c,h,m){return $h.w5(a,b,c,h,m,{},14)}DIe(a,b){const c=this.yk.le(15);try{c.kd(a),this.Bt.ZZa(),b()}finally{c&&c.dispose()}}gqc(a,b,c,h,m){return this.aUj(a,b,c,h,m)?{returnValue:h||2===b,qF:32}:{returnValue:!1,qF:8}}aUj(a,b,c,h,m){if(a.contextId!==xb.a.table)return!1;if(h||
2===b)if(m&&!c||!Object(za.a)(sy.a,a.node)||this.XTh(a.node))return!1;return!0}cei(a,b,c,h){const m=(512===b||1024===b?!c:c)?a|b:a&~b;m!==a&&this.DIe(h,()=>{this.GKd.p7k(m,h)})}H6a(a,b,c,h,m){if(!({qF:a}=this.gqc(b,c,m,!1,!1)).returnValue)return a;const y=b.node;this.DIe(y,()=>{this.GKd.Csi(y)});return 32}static mr(){fl.POa[fl.HXi]=32;fl.POa[fl.CXi]=128;fl.POa[fl.eXj]=64;fl.POa[fl.XWj]=256;fl.POa[fl.xgi]=512;fl.POa[fl.wgi]=1024}static Fdl(a,b){a=!!(a&b);if(512===b||1024===b)a=!a;return a}static jkj(a){let b=
0;a in fl.POa&&(b=fl.POa[a]);return b}}fl.HXi="buttonFirstRow";fl.CXi="buttonFirstColumn";fl.eXj="buttonLastRow";fl.XWj="buttonLastColumn";fl.xgi="buttonBandedRow";fl.wgi="buttonBandedColumn";fl.POa={};Object(n.a)(fl,"TableStyleActor",null,[]);fl.mr();class kp{constructor(a){this.C0=a}K9k(a,b){a=this.C0.N5b(a);kp.jDf(b);b.setValue(X.a.Uya,Eh.a.Hf(a.YX.styleIdField))}p7k(a,b){b.setValue(X.a.Nrc,a)}Csi(a){kp.jDf(a);a.removeProperty(X.a.Uya)}static jDf(a){if(a=Object(ua.a)(Oz.TableNode,a)){a=a.M9a();
for(const b of a){b.cellShading&&((a=To.d(b.cellShading))?(To.c(a),b.cellShading=a):Ba.a.J(22078240,822,15,"Encountered null cell shading."));for(const c of kp.Phi){let h,m;({OPa:h,i6a:a,Mrb:m}=Fp.LSa(c));b.removeProperty(a);b.removeProperty(h);b.removeProperty(m)}kp.dsi(Object(ua.a)($f.a,b))}}else Ba.a.J(587531030,822,10,"Casting of GraphNode to ITableNode is null")}static dsi(a){const b=new vF.a;b.set(a);for(a=b.Bb(1);a;){for(a=b.Bb(2);a;)12===a.type&&kp.esi(a),a=b.Cj(2);a=b.Cj(1)}}static esi(a){if(a.Ra&&
0<a.Ra.length)for(let b=0;b<a.Ra.length;b++)a.Ra.ga(b)&&kp.fsi(a.Ra.ga(b))}static fsi(a){if(a=a.formatting){const h=a.paragraph.Fh;if(h){var b=a.Pz,c=!1;if(b){for(let m=0;m<kp.ERe.length;m++)b.Sa(kp.ERe[m])&&(c||(c=!0,b=b.clone()),b.removeProperty(kp.ERe[m]));c&&(b=h.UJa(b),a.nm=b.id)}}}}}kp.ERe=[kb.a.font,X.a.latinFont,X.a.eastAsianFont,X.a.complexScriptFont,X.a.$Mb,kb.a.fontColor,kb.a.bold,kb.a.italic,X.a.schemeColor];kp.Phi=[5,6,7,0];Object(n.a)(kp,"PPTTableStyleEditor",null,[563]);class TD{constructor(){this.K=
null}get name(){return"PowerPointWebEditor.TableStyleEditor"}$b(a){this.K=a}init(){(new fl(this.K.resolve("Box4.Styles.ITableStyleReader"),this.K.resolve("Box4.TableEditors.ITableStyleRibbonControls"),this.K.resolve("Common.IActionManagerExtended"),new kp(this.K.resolve("PowerPointWebEditor.ITableStyleGalleryManager")),this.K.resolve("PowerPointWebEditor.Graph.IPptGraphTransactionFactory"),this.K.resolve("Box4.IInsertionPointFormatting"),this.K.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,
()=>!1)).vb()}dispose(){}static main(){r.a.instance.Dc(new TD)}}Object(n.a)(TD,"PPTWebEditorTableStyleEditorPackage",null,[2,3]);class UD{constructor(a,b,c){this.eBe=0;this.Ote=!1;this.Rk=a;this.Xt=b;this.pa=c;this.Rk.Zrf(Object(F.a)(this,this.lxf,"beforeForceOutboundGraphTransactionInitialize"));this.Rk.BBa(Object(F.a)(this,this.z7f,"graphTransactionDisposed"));this.Xt.gra(Object(F.a)(this,this.zYa,"onBeforeValidatePersistence"))}dispose(){this.Rk.Chh(Object(F.a)(this,this.lxf,"beforeForceOutboundGraphTransactionInitialize"));
this.Rk.NZa(Object(F.a)(this,this.z7f,"graphTransactionDisposed"));this.Xt.Gnc(Object(F.a)(this,this.zYa,"onBeforeValidatePersistence"))}lxf(){this.eBe++}zYa(){0<this.eBe&&(this.Ote=!0)}z7f(){if(!(0<--this.eBe)&&this.Ote){this.Ote=!1;var a=Nc.a.Ib;if(a){const b=this.pa.Xd();let c=0;for(const h of b)h.wL&&c++;a.Va("ShapeCount",b.length.toString());a.Va("SupportSVGCount",c.toString())}}}}Object(n.a)(UD,"SVGShapeTelemetry",null,[106]);class VD{constructor(){this.K=null}get name(){return"PowerPointWebEditor.Telemetry"}$b(a){this.K=
a;this.K.register(UD,"PowerPointWebEditor.Telemetry.SVGShapeTelemetry").ma().oa(()=>new UD(this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.K.resolve("Box4.Graph.IGraphInstance").Ad(10),this.K.resolve("PowerPointWebEditor.IPptSelectionManager")))}init(){this.K.resolve("PowerPointWebEditor.Telemetry.SVGShapeTelemetry")}dispose(){this.K.resolve("PowerPointWebEditor.Telemetry.SVGShapeTelemetry").dispose()}static main(){r.a.instance.Dc(new VD)}}Object(n.a)(VD,"PPTWebEditorTelemetryPackage",
null,[2,3]);class Rz{}Rz.och="faProofing";Object(n.a)(Rz,"ContextMenuControlId",null,[]);class WD{constructor(a,b,c,h,m,y,G){this.$M=b;this.oVb=a;this.Myc=b.nKj;this.gzc=b.Kje;this.iTh=y;this.wyc=h;this.xyc=m;this.uNa=c;this.vP=G;this.qNa=new Sc.a;this.qNa.$(1,"SpellingIssue_16x16x32");this.qNa.$(2,"GrammarIssue_16x16x32");this.qNa.$(3,"WritingIssue_16x16x32");this.qNa.$(4,null);this.qNa.$(0,null)}create(a,b,c){b=Object(ua.a)(Wi.a,b);if(!b)return ba.ULS.sendTraceTag(25007833,375,15,"Expect EditorServiceErrorDetails."),
"";const h=new Sys.StringBuilder;a=this.S0f(a);this.L0b(h,b,c,a);this.zWd(h,b);this.NEi(h,b,a);return h.toString()}Lt(a,b,c){b=Object(ua.a)(Wi.a,b);if(!b)return ba.ULS.sendTraceTag(39188232,375,15,"Expect EditorServiceErrorDetails."),[];const h=[];a=this.S0f(a);this.fXd(h,b,c,a);this.AWd(h,b);this.OEi(h,b,a);return h}L0b(a,b,c,h=null){0===b.errorType?a.append(this.oVb.build()):1===b.errorType&&(this.BRa(b)||a.append(this.ARd(b,c,h)))}fXd(a,b,c,h=null){0===b.errorType?a.push(this.oVb.Fyf()):1===b.errorType&&
(this.BRa(b)||a.push(this.Yii(b,c,h)))}zWd(a,b){if(!J.a.instance.ga(92)){const c=new Sys.StringBuilder;this.tvh(b)?c.append(gj.a("btnIgnoreAllSpellingError",(2===b.errorType?D.a.dtd:D.a.Ibe).toString(),Box4Intl.Box4Strings.l_IgnoreAllSpellingErrors,null)):this.BRa(b)||c.append(gj.a("btnIgrnoreSpellingError",this.t0f(b.errorType).toString(),Box4Intl.Box4Strings.l_IgnoreOnceSpellingError,null));this.xvh(b)&&(this.$M.Phe&&c.append(gj.a("btnDoNotCheckForThisIssue","2157977488",Box4Intl.Box4Strings.l_DoNotCheckForThisIssue,
null)),c.append(gj.a("btnGrammarOptions","3380187414",ta.a.pe(Box4Intl.Box4Strings.l_GrammarOptions),null)));c.isEmpty()||(a.append('<MenuSection Id="msIgnoreSpellingError" DisplayMode="Menu16"><Controls>'),a.append(c.toString()),a.append("</Controls></MenuSection>"))}}AWd(a,b){if(!J.a.instance.ga(92)){const h=Object.assign(new di.a,{ControlList:[]});if(this.tvh(b)){var c=Object.assign(new zf.a,{ExternalId:2===b.errorType?"UnknownAllSpellingError":"IgnoreAllSpellingError"});Array.add(h.ControlList,
c)}else this.BRa(b)||(c=Object.assign(new zf.a,{ExternalId:"btnIgrnoreSpellingError",Command:this.t0f(b.errorType).toString(),LabelText:Box4Intl.Box4Strings.l_IgnoreOnceSpellingError}),Array.add(h.ControlList,c));this.xvh(b)&&(this.$M.Phe&&(b=Object.assign(new zf.a,{ExternalId:"DoNotCheckForThisIssue",Command:"2157977488",LabelText:Box4Intl.Box4Strings.l_DoNotCheckForThisIssue}),Array.add(h.ControlList,b)),b=Object.assign(new zf.a,{ExternalId:"GrammerSettingsContext",Command:"3380187414",LabelText:Box4Intl.Box4Strings.l_GrammarOptions}),
Array.add(h.ControlList,b));a.push(h)}}S0f(a){if(!this.vP)return null;a=this.vP.language(this.vP.ps(a.Ua));return Fa.a.ue(a).name}t0f(a){return 2===a?D.a.dtd:this.$M.Sgg?D.a.NVc:D.a.ika}NEi(a,b,c=null){if(this.DVe(b)){var h=ta.a.pe(b.qN.CategoryTitle);h=gj.j(Rz.och,H.a.E7,this.qNa.ga(b.proofingType),""!==h?h:Box4Intl.Box4Strings.l_AdvancedProofingIssueContentTitle,[a.toString()],this.wyc,this.xyc);h=gj.c("cgProofingOuter",[h]);a.clear();a.append(gj.e("msProofingOuter",h,"Menu16",void 0,void 0,c,"ariaLabelledById"));
ba.ULS.sendTraceTag(36508632,375,50,"Show 2-level context menu of type {0}, critique id {1}",b.proofingType,b.typeId)}}OEi(a,b,c=null){if(this.DVe(b)){var h=ta.a.pe(b.qN.CategoryTitle);c=Object.assign(new En.a,{ExternalId:String.format("{0}_{1}",Rz.och,b.proofingType),Command:"798637440",Image16by16Class:this.qNa.ga(b.proofingType),LabelText:""!==h?h:Box4Intl.Box4Strings.l_AdvancedProofingIssueContentTitle,Lang:c,Menu:Object.assign(new Mk.a,{ExternalId:"ProofingSubMenu",UpdateDynamically:!0,ShouldAutoOpen:!0,
AriaLabel:this.j2i(b),AriaRoleDescription:Box4Intl.Box4Strings.l_SuggestionsMenuAriaRoleDescription,MenuSectionList:[]})});Array.addRange(c.Menu.MenuSectionList,a);Array.clear(a);h=Object.assign(new di.a,{ControlList:[]});Array.add(h.ControlList,c);a.push(h);ba.ULS.sendTraceTag(39188234,375,50,"Show 2-level context menu of type {0}, critique id {1}",b.proofingType,b.typeId)}}ARd(a,b,c=null){const h=this.P7i(a);var m=[];let y=!1;var G=a.qN.Suggestions;if(G)if(G=G.slice(0,Math.min(3,G.length)),this.Myc&&
(y=!Ma.a.any(G,U=>!U||!U.Description)),1===G.length&&0===G[0].Action)b=ta.a.pe(G[0].Text),m.push(gj.a("btnCorrectWord0","3587447601",b,null,null,null,null,null,null,null,void 0,void 0,void 0,void 0,String.format(Box4Intl.Box4Strings.l_SuggestionsAriaLabelFormat,h,b)));else{let U=0,ja=null;y&&(ja="font-weight: bold;");for(const va of G){if(!va)continue;G=null;let Ta="",fb=ta.a.pe(va.Text);y&&(G=this.TXf(va.Description),Ta=this.SXf(va.Description));m.push(gj.a("btnCorrectWord"+U,b[U].toString(),fb,
null,null,null,null,null,ja,null,G,null,void 0,void 0,String.format(Box4Intl.Box4Strings.l_SuggestionsAriaLabelFormatForSuggestionDescriptions,h,fb),"ariaLabelledById",String.format(Box4Intl.Box4Strings.l_SuggestionsNotInDictionaryAriaLabelFormat,a.token,this.CGf(a.token)),"ariaDescribedById",Ta));U++}}b="Menu16";0<m.length?y&&(b="Menu16DescriptionEnabled"):m=[gj.a("btnNoSuggestions","3587447601",Box4Intl.Box4Strings.l_NoSuggestions,null)];return gj.e("msUnknownWord",gj.c(null,m),b,h,this.mbj(a),
c,"ariaLabelledById")}Yii(a,b,c=null){var h=1!==a.proofingType&&0!==a.proofingType?a.qN.ExplanationTitle:"";h=Object.assign(new di.a,{Title:h,Lang:c,ControlList:[]});let m=!1;var y=a.qN.Suggestions;if(y)if(y=y.slice(0,Math.min(3,y.length)),this.Myc&&(m=!Ma.a.any(y,G=>!G||!G.Description)),1===y.length&&0===y[0].Action)a=y[0],a=Object.assign(new zf.a,{ExternalId:"NoSuggestion",Command:"3587447601",LabelText:a.Text}),Array.add(h.ControlList,a);else{let G=0;for(const U of y){if(!U)continue;y=null;let ja=
"";m&&(y=this.TXf(U.Description),ja=this.SXf(U.Description));if(G>=b.length)break;y?(y=Object.assign(new hB,{ExternalId:String.format("{0}{1}_{2}_compoundButton","btnCorrectWord",G,a.proofingType),Command:b[G].toString(),LabelText:U.Text,Description:y,Lang:c,AriaDescription:ja}),Array.add(h.ControlList,y)):(y=Object.assign(new zf.a,{ExternalId:String.format("{0}{1}_{2}_button","btnCorrectWord",G,a.proofingType),Command:b[G].toString(),LabelText:U.Text,Lang:c,RoleInMenu:"menuitem"}),Array.add(h.ControlList,
y));G++}}0>=h.ControlList.length&&Array.add(h.ControlList,Object.assign(new zf.a,{ExternalId:"btnNoSuggestions",Command:"3587447601",LabelText:Box4Intl.Box4Strings.l_NoSuggestions}));return h}P7i(a){return ta.a.pe(1!==a.proofingType&&0!==a.proofingType?a.qN.ExplanationTitle:"")}mbj(a){return this.DVe(a)?null:this.qNa.ga(a.proofingType)}DVe(a){return this.gzc&&2!==a.errorType&&(1!==a.errorType||!this.BRa(a))}tvh(a){return this.iTh&&0!==a.errorType&&1===a.proofingType&&!this.BRa(a)}j2i(a){return 1===
a.proofingType?String.format(Box4Intl.Box4Strings.l_SuggestionsNotInDictionaryAriaLabelFormat,a.token,this.CGf(a.token)):""}xvh(a){return this.$M.AUa&&this.gzc&&1===a.errorType&&(2===a.proofingType||3===a.proofingType)}BRa(a){return 0!==a.errorType&&!!this.uNa&&this.uNa.contains(a.token,a.lcid)}TXf(a){return""===a?String.format(Box4Intl.Box4Strings.l_NoReferenceInformation):a}SXf(a){return""!==a?String.format(Box4Intl.Box4Strings.l_SuggestionDescriptionAriaDescribedByFormat,a):""}CGf(a){let b="";
if(a){let c;for(c=0;c<a.length-1;c++)b=b+a.charAt(c)+",";b+=a.charAt(c)}return b}}Object(n.a)(WD,"EditorServiceProofingContextMenuCreator",null,[]);class xq{saa(a,b){this.koi&&this.rfl(a,b,xq.nYg,xq.mb)}rfl(a,b,c,h){switch(c){case 1:case 6:case 2:case 3:case 4:case 5:xq.zOi.show(h,a,b)}}lYg(){switch(xq.nYg){case 5:case 1:return!0;default:return!1}}get koi(){return 1!==Fc.App.Kb.state}static get zOi(){return xq.E9e||(xq.E9e=vb.a.instance.resolve("Box4.UI.AEditSurfaceContextMenu"))}static nbj(a){if(!a)return 0;
if(2===Fc.App.Kb.mode)if(J.a.instance.ga(17)&&1===a.length&&Yi.OutlineReader.z9b(a.Ua)&&Fc.App.Kb.Jd.Cn&&Fc.App.Kb.Jd.Cn.np){if(a=rb.GraphIterator.nb(a.Ua.node),a.Xu(),!Je.b(a))return 5}else{const b=a.Ua.node;let c=rb.GraphIterator.nb(b);c.Xu();return $t.e(c.currentNode)?2:u.AFrameworkApplication.Alb||!$a.EmbeddedFileReader.fab(b)||$a.EmbeddedFileReader.SN(b)?a.Ua.contextId===xb.a.iFrame||yI(a.Ua)?6:1:3}else return 4;return 0}static get mb(){return me.a.instance.Pa.mb}static get nYg(){return xq.nbj(xq.mb)}}
xq.E9e=null;Object(n.a)(xq,"SelectionContextMenuProvider",null,[196]);class PL{constructor(a){this.la=a}L2d(a,b,c,h,m){const y=c?u.AFrameworkApplication.qm:"";c=c?zp.getImageClass(c):"";return String.format('<FlyoutAnchor Id="{0}" Command="{1}" Image16by16="{2}" \r\n              Image16by16Class="{3}" LabelText="{4}"> {5} </FlyoutAnchor>',a,b,y,c,ta.a.pe(h),m)}menu(a,b){return String.format('<Menu Id="{0}"> {1} </Menu>',a,b)}menuSection(a,b){return String.format('<MenuSection Id="{0}" DisplayMode="Menu16"><Controls> {1} </Controls></MenuSection>',
a,b)}ZFi(){let a=ResourceStrings.l_ContextMenuSmartLookup;var b=(new dx.a).getSelectedText();b=(b=b.neighborhood.substr(b.mentionStart,b.mentionLength))?b.trim():null;let c=20;b&&0<b.length&&(b.length>c&&(c=ta.a.jx(b,c)?c-1:c),b=b.length>c?b.substr(0,c).trim()+"...":b);b&&0<b.length&&(a=String.format(ResourceStrings.l_ContextMenuTextSmartLookup,b));return a}tqi(){var a=(new dx.a).getSelectedText();a=a.neighborhood.substr(a.mentionStart,a.mentionLength);return!(a&&0<a.trim().length)}oGi(){let a=ResourceStrings.l_SynonymsSerpletContextMenu;
var b=(new dx.a).getSelectedText();b=b.neighborhood.substr(b.mentionStart,b.mentionLength);if(!b)return a;b=b.trim();let c=14;0<b.length&&(b.length>c&&(c=ta.a.jx(b,c)?c-1:c),b=b.length>c?b.substr(0,c).trim()+"...":b,a=String.format(ResourceStrings.l_ContextMenuTextSynonyms,b));return a}}Object(n.a)(PL,"ContextMenuHelper",null,[202]);class Nx extends jv{constructor(a,b,c,h){super(a,c);this.Srg=b;this.LVa=h}jQc(a){let b=null,c=!1;var h=me.a.instance.Pa.mb;h=vb.a.instance.resolve("Box4.UI.AEditSurfaceContextMenu").pae(h,
a);switch(this.LVa){case 7:b=["Picture","Comment"];c=!0;break;case 15:case 6:case 10:case 5:b=["Shape","Comment"];c=!0;break;case 8:b=["SmartArtStylesOptions","Comment"];c=!0;break;case 13:case 11:b=["SVG","Comment"];c=!0;break;default:const m=!!this.Srg&&this.Srg.xjg("1898844988"),y=vb.a.instance.resolve("Box4.ISelectionContextMenuProvider").lYg(),G=u.AFrameworkApplication.fa.ka("PPTOTableCellBordersEnabled");m?b=G?3===a&&h?"Paste FontFormatting Table TableStyle Comment ContextMenu".split(" "):["FontFormatting",
"Table","TableStyle","Comment"]:3===a&&h?["Paste","FontFormatting","Table","Comment","ContextMenu"]:["FontFormatting","Table","Comment"]:y&&(b=3===a&&h?["Paste","FontFormatting","Comment","ContextMenu"]:["FontFormatting","Comment"])}3===a&&h&&c&&b.push("ContextMenu");return b}static OCj(a,b,c,h){a.hhi(()=>Nx.Rxi(b,c,h))}static Rxi(a,b,c){return new Nx(a,b,c,0)}}Object(n.a)(Nx,"PowerPointReactFloatie",jv,[]);class QL{constructor(a,b){this.fug=b;this.Gpe=a}dispose(){}BH(){}VLi(){this.Gpe.osa()}U5(a,
b,c,h){this.fug.dph(h);this.Gpe.U5(a,b,c)}sfl(a,b,c,h){14===h?this.U5(a,b,c,h):(this.fug.dph(h),a=new Nx(vb.a.instance.rb("Common.IReactContextualUILauncher"),Fc.App.HD.KS,vb.a.instance.rb("Common.IExternalUICommandDefinitionMapping"),h),this.Gpe.jpd(b,c,a,vb.a.instance.rb("Box4.ISelectionContextMenuProvider")))}}Object(n.a)(QL,"ReactContextMenuUser",null,[200]);class RL{constructor(){this.whitelistedControlIds=this.Eaa=this.mG=null;this.IVj=!1;this.d6k=this.bga=this.Qxh=null}}Object(n.a)(RL,"ReactStatusBarInitOptions",
null,[]);class SL{constructor(){this.whitelistedControlIds=null}}Object(n.a)(SL,"StatusBarProps",null,[]);class Ox{constructor(a,b,c=!0){this.DHd=!1;this.Ujf=null;this.k5a=b.mG;this.Xmf=b.Qxh;c?Ja.a.get_instance().Dk(7,()=>{this.DHc(a,b)}):this.DHc(a,b)}DHc(a,b){window.setTimeout(()=>{id.a.instance.cG(()=>{fj.UISurfaces.djj().then(c=>{const h=Object.assign(new SL,{whitelistedControlIds:b.whitelistedControlIds});c.initializeNewStatusBar(a,h,this.Xmf);this.Ujf=c;this.DHd=!0;window.setTimeout(()=>{id.a.instance.cG(()=>
{const m=[];if(b.Eaa){const y=b.Eaa;for(let G in y)m.push(appChrome.actions.updateControlHiddenState(G,y[G]));appChrome.api.dispatch(m)}this.BH()},"RSB:I2")},0);return null}).catch(()=>{ba.ULS.sendTraceTag(51656736,324,10,"Failed to load React Status Bar API");return null})},"RSB:I1");if(b.bga&&a){Ox.Raf||(u.AFrameworkApplication.Ta.ya(H.a.Sxh,he.a.frame,Object(F.a)(this,this.Txh,"statusBarTabAction")),u.AFrameworkApplication.Ta.ya(H.a.Rxh,he.a.frame,Object(F.a)(this,this.Txh,"statusBarTabAction")),
Ox.Raf=!0);const c=Or.a.Kce(b.bga,b.d6k,a,!1);c.zL=!0;this.bJb(c,H.a.Sxh,H.a.Rxh)}},0)}BH(){this.DHd&&this.k5a&&window.setTimeout(()=>{this.k5a(this.Ujf.selectors.getStatusBarControlsMap(this.Xmf),7)},0)}N5(a,b){this.DHd&&window.setTimeout(()=>{appChrome.api.dispatch(appChrome.actions.updateControlHiddenState(a,b))},0)}bJb(a,b,c){const h=w.KeyInputManager.Na(z.a.Pq,0),m=w.KeyInputManager.Na(z.a.Pq,4);a.Ap(h);a.Ap(m);a.bindAction(h,b);a.bindAction(m,c)}Txh(){return 4}}Ox.Raf=!1;Object(n.a)(Ox,"ReactStatusBar",
null,[]);class XD{constructor(a,b,c,h,m,y,G){this.Vfc=null;this.Yb=G;this.Ugc=a;this.Hk=h;this.Lak=m;this.vck=y;this.EVa=c||new LG.a;this.nh=this.EVa.OWd(3,"StatusBarUser");a=()=>{this.DHc();this.EVa.j1c(3)};Rd.a("StatusBarTTVRImprovementEnabled")&&Object(za.a)(108,this.Yb)?this.Yb.hyb(a):this.Yb.jf(a);this.nGg=b;this.nGg.FG(Object(F.a)(this,this.Qjc,"onSlidesTopologyChanged"))}dispose(){this.nGg.ZO(Object(F.a)(this,this.Qjc,"onSlidesTopologyChanged"))}DHc(){const a=this.nh.su("createStatusBar"),
b=new RL;b.Eaa=this.jfj();b.IVj=!1;b.mG=Object(F.a)(this,this.HAl,"updateStatusBarControls");b.Qxh="PptEditingStatusBar";Rd.a("ReactStatusBarRTLSupport")&&u.AFrameworkApplication.isRtl&&this.Ugc&&(this.Ugc.style.direction="rtl");this.Vfc=new Ox(this.Ugc,b,!1);this.nh.yu(a)}BH(){this.Vfc&&this.Vfc.BH()}N5(a,b){this.Vfc&&this.Vfc.N5(this.Hwb(a),!b)}Hwb(a){const b=this.Lak.u5d(a);return b&&0<b.count?b.ga(0):a}Qjc(a,b){2===b.RZ&&this.BH()}HAl(a){Fc.App.Kb&&Fc.App.Kb.mG(a)}jfj(){const a=this.vck.Glj(),
b={};for(const c of Object.keys(a))b[this.Hwb(c)]=a[c];u.AFrameworkApplication.fa.ka("FeedbackPaneExperienceIsEnabled")&&u.AFrameworkApplication.fa.ka("HelpTabIsEnabled")?(b[this.Hwb("PptEditingStatusBar.GiveFeedbackPane")]=!u.AFrameworkApplication.fa.ka("ShowFeedback"),b[this.Hwb("PptEditingStatusBar.GiveFeedback")]=!0):(b[this.Hwb("PptEditingStatusBar.GiveFeedback")]=!u.AFrameworkApplication.fa.ka("ShowFeedback"),b[this.Hwb("PptEditingStatusBar.GiveFeedbackPane")]=!0);return b}}XD.Vxc=null;Object(n.a)(XD,
"ReactStatusBarUser",null,[282,199]);class TL{constructor(a){this.la=a}Glj(){const a={};this.la.Byb||(a["PptEditingStatusBar.ZoomScale"]=!0,a["PptEditingStatusBar.FitToWindow"]=!0);this.la.jIb||(a["PptEditingStatusBar.LanguageButton"]=!0);this.la.Qta||(a["PptEditingStatusBar.AddInCommandsLoadStatus"]=!0);this.la.officeOnlineInGallatinTextVisible||(a["PptEditingStatusBar.MiddleStatus"]=!0);this.la.vuh||(a["PptEditingStatusBar.PerfStats"]=!0);this.la.wg&&(a["PptEditingStatusBar.Reading"]=!0);u.AFrameworkApplication.fa.ka("PPTSorterViewEnabled")||
(a["PptEditingStatusBar-SlideSorterView"]=!0);u.AFrameworkApplication.fa.ka("PptPresenterViewEnabled")||(a["PptEditingStatusBar-PresenterView"]=!0);return a}}Object(n.a)(TL,"StatusBarUserHelper",null,[198]);class YD{constructor(){this.$kf=null}get slh(){return this.$kf||(this.$kf=vb.a.instance.rb("Common.IRootManager"))}vb(){}De(){}Ilg(){}QZk(){this.slh&&this.slh.JJc()}}Object(n.a)(YD,"ABox4BridgeCommandUi",null,[201,106]);class UL extends YD{constructor(a,b,c,h){super();this.ksg=a;this.hB=b;this.ia=
c;this.D9c=h}mG(a){Object(ua.a)(229,this.hB).qOb(a)}E1(a){return 32===this.ia.La(M.a.E1,2,a)}vAk(){this.ksg.clearCache();this.hB.BH()}xOb(){this.hB.xOb()}$Qe(a){a?a(this.D9c.osa()):this.D9c.osa()}xjg(a){return this.ksg.W9b(a)}Ilg(){const a=Object(ua.a)(229,this.hB);a&&a.tXj()}dispose(){}}Object(n.a)(UL,"Box4BridgeCommandUi",YD,[]);var ZD=d(1112);class hr{static get P7(){return hr.K6||(hr.K6=vb.a.instance.resolve("Box4.IContextMenuController"))}static showContextMenu(a,b){hr.P7.showContextMenu(a,b)}static U5(a,
b,c){hr.P7.U5(a,b,c)}static ipd(a,b,c,h=null){hr.P7.ipd(a,b,c,h)}}hr.K6=null;Object(n.a)(hr,"BaseContextMenu",null,[]);class lp extends Xw{constructor(){super();this.XMd();this.HNd()}XMd(){this.addCommandToMaps(Object.assign(new Pa.a("AlignCenter","4284004393"),{legacyControlId:"CenterJustify",queryCommandId:"3263071675"}));this.addCommandToMaps(Object.assign(new Pa.a("AlignLeft","2539120357"),{legacyControlId:"LeftJustify",queryCommandId:"3797776291"}));this.addCommandToMaps(Object.assign(new Pa.a("AlignRight",
"393413924"),{legacyControlId:"RightJustify",queryCommandId:"2003732276"}));this.addCommandToMaps(Object.assign(new Pa.a("AlignTableTopLeft","428881244"),{legacyControlId:"TableCellJustifyTopLeft",queryCommandId:"1001772032"}));this.addCommandToMaps(Object.assign(new Pa.a("AlignTableTopCenter","1718508548"),{legacyControlId:"TableCellJustifyTopCenter",queryCommandId:"43364900"}));this.addCommandToMaps(Object.assign(new Pa.a("AlignTableTopRight","1925534309"),{legacyControlId:"TableCellJustifyTopRight",
queryCommandId:"948656099"}));this.addCommandToMaps(Object.assign(new Pa.a("AlignTableCenterLeft","150838934"),{legacyControlId:"TableCellJustifyMiddleLeft",queryCommandId:"3335457338"}));this.addCommandToMaps(Object.assign(new Pa.a("AlignTableCenter","3219509138"),{legacyControlId:"TableCellJustifyMiddleCenter",queryCommandId:"296402530"}));this.addCommandToMaps(Object.assign(new Pa.a("AlignTableCenterRight","4038626531"),{legacyControlId:"TableCellJustifyMiddleRight",queryCommandId:"2444984437"}));
this.addCommandToMaps(Object.assign(new Pa.a("AlignTableBottomLeft","12275744"),{legacyControlId:"TableCellJustifyBottomLeft",queryCommandId:"3942794232"}));this.addCommandToMaps(Object.assign(new Pa.a("AlignTableBottomCenter","1910316280"),{legacyControlId:"TableCellJustifyBottomCenter",queryCommandId:"812840340"}));this.addCommandToMaps(Object.assign(new Pa.a("AlignTableBottomRight","719753309"),{legacyControlId:"TableCellJustifyBottomRight",queryCommandId:"347437379"}));this.addCommandToMaps(Object.assign(new Pa.a("AlignTableTopLeft_MLR",
"428881244"),{legacyControlId:"TableCellJustifyTopLeft",queryCommandId:"1001772032"}));this.addCommandToMaps(Object.assign(new Pa.a("AlignTableTopCenter_MLR","1718508548"),{legacyControlId:"TableCellJustifyTopCenter",queryCommandId:"43364900"}));this.addCommandToMaps(Object.assign(new Pa.a("AlignTableTopRight_MLR","1925534309"),{legacyControlId:"TableCellJustifyTopRight",queryCommandId:"948656099"}));this.addCommandToMaps(Object.assign(new Pa.a("AlignTableCenterLeft_MLR","150838934"),{legacyControlId:"TableCellJustifyMiddleLeft",
queryCommandId:"3335457338"}));this.addCommandToMaps(Object.assign(new Pa.a("AlignTableCenter_MLR","3219509138"),{legacyControlId:"TableCellJustifyMiddleCenter",queryCommandId:"296402530"}));this.addCommandToMaps(Object.assign(new Pa.a("AlignTableCenterRight_MLR","4038626531"),{legacyControlId:"TableCellJustifyMiddleRight",queryCommandId:"2444984437"}));this.addCommandToMaps(Object.assign(new Pa.a("AlignTableBottomLeft_MLR","12275744"),{legacyControlId:"TableCellJustifyBottomLeft",queryCommandId:"3942794232"}));
this.addCommandToMaps(Object.assign(new Pa.a("AlignTableBottomCenter_MLR","1910316280"),{legacyControlId:"TableCellJustifyBottomCenter",queryCommandId:"812840340"}));this.addCommandToMaps(Object.assign(new Pa.a("AlignTableBottomRight_MLR","719753309"),{legacyControlId:"TableCellJustifyBottomRight",queryCommandId:"347437379"}));this.addCommandToMaps(Object.assign(new Pa.a("ApplyStyle","1040747875"),{queryCommandId:"3123760305",populationProps:new Yg("681481568",!1),previewControlIds:["buttonStyle0",
"buttonStyle1","buttonStyle2","buttonStyle3","buttonStyle4"]}));this.addCommandToMaps(Object.assign(new Pa.a("AutoCorrectOptions","880879461"),{legacyControlId:"fseaOpenAutoCorrectOptionsDialog"}));this.addCommandToMaps(Object.assign(new Pa.a("AutomaticFontColor","3491966299"),{legacyControlId:"fontColor"}));this.addCommandToMaps(Object.assign(new Pa.a("Bold","4143129361"),{legacyControlId:"fsbcBold",queryCommandId:"1465813983"}));this.addCommandToMaps(Object.assign(new Pa.a("BulletLibrary","3552651681"),
{queryCommandId:"3827179399",populationProps:new Yg("2466004410",!1)}));this.addCommandToMaps(Object.assign(new Pa.a("BulletNone","3552651681"),{queryCommandId:"990335323",menuItemId:"BulletStyleBulletsLibrary_0"}));this.addCommandToMaps(Object.assign(new Pa.a("CellShading","2765388691"),{legacyControlId:"cellShadingColor",populationProps:new Yg("462656847",!1)}));this.addCommandToMaps(Object.assign(new Pa.a("ClearFormatting","2319895756"),{legacyControlId:"fseaClearFormatting"}));this.addCommandToMaps(Object.assign(new Pa.a("ClearShadingColor",
"3275596206"),{legacyControlId:"clear"}));this.addCommandToMaps(new Pa.a("ClearStyleFormatting","2319895756"));this.addCommandToMaps(Object.assign(new Pa.a("ClearTableFormatting","3835123874"),{legacyControlId:"fseaClearTableFormatting"}));this.addCommandToMaps(Object.assign(new Pa.a(lp.Tzi,"3383614517"),{legacyControlId:"fseaCopy"}));this.addCommandToMaps(Object.assign(new Pa.a(lp.YHi,"2309168610"),{legacyControlId:"fseaCut"}));this.addCommandToMaps(Object.assign(new Pa.a("DecreaseIndent","3376107472"),
{legacyControlId:"fseaOutdent",queryCommandId:"1599543798"}));this.addCommandToMaps(Object.assign(new Pa.a("DeleteColumn","2983091615"),{legacyControlId:"btnColumnDelete"}));this.addCommandToMaps(Object.assign(new Pa.a("DeleteRow","1368263559"),{legacyControlId:"btnRowDelete"}));this.addCommandToMaps(Object.assign(new Pa.a("DeleteTable","1819681963"),{legacyControlId:"btnTableDelete"}));this.addCommandToMaps(Object.assign(new Pa.a("Dictation","1394650145"),{legacyControlId:"btnStartDictation",queryCommandId:"2417470717",
populationProps:new Yg("1546254036",!0)}));this.addCommandToMaps(Object.assign(new Pa.a("DictationFloatieToggle","1394650145"),{legacyControlId:"btnDictationFloatieToggle",queryCommandId:"2417470717"}));this.addCommandToMaps(Object.assign(new Pa.a("DictationSettingsLanguages","3662249320"),{queryCommandId:"569982264",populationProps:new Yg("3836866597",!0)}));this.addCommandToMaps(new Pa.a("DictationSettingsHelp","3819824931"));this.addCommandToMaps(new Pa.a("DictationSettingsHelpShowCommands","2729830074"));
this.addCommandToMaps(Object.assign(new Pa.a("DictationSettingsAutoPunctuation","992784617"),{queryCommandId:"1118940415"}));this.addCommandToMaps(Object.assign(new Pa.a("EditInApp","3588168074"),{legacyControlId:"btnOpenInClient"}));this.addCommandToMaps(Object.assign(new Pa.a("EditingView","329275380"),{legacyControlId:"btnEditOnWeb",queryCommandId:"214409533"}));this.addCommandToMaps(Object.assign(new Pa.a("EditTableAltText","868579142"),{legacyControlId:"btnTableAltText"}));this.addCommandToMaps(Object.assign(new Pa.a("FlipHorizontal",
"2545543284"),{legacyControlId:"buttonFlipHorizontal",menuItemId:"buttonFlipHorizontal"}));this.addCommandToMaps(Object.assign(new Pa.a("FlipVertical","2545543284"),{legacyControlId:"buttonFlipVertical",menuItemId:"buttonFlipVertical"}));this.addCommandToMaps(Object.assign(new Pa.a("FontColor","1970784898"),{legacyControlId:"fontColor",populationProps:new Yg("2077552168",!1)}));u.AFrameworkApplication.fa.ka("FontPreviewEnabled")?(this.addCommandToMaps(Object.assign(new Pa.a("FontName","3430668515"),
{legacyControlId:"fontName",queryCommandId:"1223894949",populationProps:new Yg("179506844",!1),commandPreviewId:"2655634065",commandRevertId:"1138852411"})),this.addCommandToMaps(Object.assign(new Pa.a("FontSize","3217001754"),{legacyControlId:"fontSize",queryCommandId:"3829328462",commandPreviewId:"1666858098",commandRevertId:"1250696292"}))):(this.addCommandToMaps(Object.assign(new Pa.a("FontName","3430668515"),{legacyControlId:"fontName",queryCommandId:"1223894949",populationProps:new Yg("179506844",
!1)})),this.addCommandToMaps(Object.assign(new Pa.a("FontSize","3217001754"),{legacyControlId:"fontSize",queryCommandId:"3829328462"})));this.addCommandToMaps(Object.assign(new Pa.a("FormatPainter","2458503775"),{legacyControlId:"fseaFormatPainter",queryCommandId:"2544399836"}));this.addCommandToMaps(Object.assign(new Pa.a("GrammarSettings","3380187414"),{legacyControlId:"btnGrammarSettings"}));this.addCommandToMaps(Object.assign(new Pa.a("GrowFontSize","286819199"),{legacyControlId:"fseaGrowFontSize"}));
this.addCommandToMaps(Object.assign(new Pa.a("Highlighter","1784019754"),{legacyControlId:"fontBackgroundColor"}));this.addCommandToMaps(new Pa.a("HighlighterColor","1784019754"));this.addCommandToMaps(Object.assign(new Pa.a("ImmersiveReader","1925081555"),{legacyControlId:"btnImmersiveMode"}));this.addCommandToMaps(Object.assign(new Pa.a("IncreaseIndent","4073520836"),{legacyControlId:"fseaIndent",queryCommandId:"2667230914"}));this.addCommandToMaps(Object.assign(new Pa.a("IndentFirstLine","682091331"),
{legacyControlId:"buttonSpecialIndentFirstLine",queryCommandId:"1728659747"}));this.addCommandToMaps(Object.assign(new Pa.a("IndentHanging","4114875119"),{legacyControlId:"buttonSpecialIndentHanging",queryCommandId:"4115573199"}));this.addCommandToMaps(Object.assign(new Pa.a("IndentLeft","3058254979"),{legacyControlId:"spnIndentBefore",queryCommandId:"2987841675"}));this.addCommandToMaps(Object.assign(new Pa.a("IndentNone","3839386673"),{legacyControlId:"buttonSpecialIndentNone",queryCommandId:"738769293"}));
this.addCommandToMaps(Object.assign(new Pa.a("IndentRight","1217598046"),{legacyControlId:"spnIndentAfter",queryCommandId:"3085515826"}));this.addCommandToMaps(Object.assign(new Pa.a("InsertAbove","2167983890"),{legacyControlId:"btnInsertRowAbove"}));this.addCommandToMaps(Object.assign(new Pa.a("InsertBelow","3709283166"),{legacyControlId:"btnInsertRowBelow"}));this.addCommandToMaps(Object.assign(new Pa.a("InsertCameraPicture","2935789186"),{legacyControlId:"fseaInsertCameraPicture"}));this.addCommandToMaps(Object.assign(new Pa.a("InsertEmoji",
"2994090608"),{legacyControlId:"flyInsertEmojis",queryCommandId:"35811376",populationProps:new Yg("1124716226",!0)}));this.addCommandToMaps(Object.assign(new Pa.a("InsertLeft","1006902144"),{legacyControlId:"btnInsertColumnLeft"}));this.addCommandToMaps(Object.assign(new Pa.a("InsertRight","1735639577"),{legacyControlId:"btnInsertColumnRight"}));this.addCommandToMaps(Object.assign(new Pa.a("InsertLink","2711544537"),{legacyControlId:"fseaInsertHyperlink"}));this.addCommandToMaps(Object.assign(new Pa.a("InsertPicture",
"2670646631"),{legacyControlId:"fseaInsertPicture"}));this.addCommandToMaps(Object.assign(new Pa.a("InsertOnlinePicture","1685987254"),{legacyControlId:"fseaFlyInsertOnlinePictureFromSearch"}));this.addCommandToMaps(Object.assign(new Pa.a("InsertPictureFromHost","720118144"),{legacyControlId:"fseaFlyInsertOnlinePictureFromHost",queryCommandId:"3612507612"}));let a;this.addCommandToMaps((a=new Pa.a("InsertSymbol","3471878106"),a.legacyControlId="flyInsertSymbols",a.populationProps=new Yg("1256496096",
!0),a));let b;this.addCommandToMaps((b=new Pa.a("InsertTable","975293073"),b.legacyControlId="flyInsertTable",b));let c;this.addCommandToMaps((c=new Pa.a("Italic","3569444222"),c.legacyControlId="fsbcItalic",c.queryCommandId="4231335074",c));let h;this.addCommandToMaps((h=new Pa.a("Justify","1733835213"),h.legacyControlId="FullJustify",h.queryCommandId="1257252315",h));let m;this.addCommandToMaps((m=new Pa.a("LeftToRightTextDirection","927903232"),m.legacyControlId="TextDirLTR",m.queryCommandId="1154761034",
m));let y;this.addCommandToMaps((y=new Pa.a("LineSpacing","2222099814"),y.legacyControlId="flyLineSpacing",y.populationProps=new Yg("2818132660",!0),y));let G;this.addCommandToMaps((G=new Pa.a("LineSpacingOptions","2465215107"),G.legacyControlId="grpParagraphDialogLauncherButton",G));let U;this.addCommandToMaps((U=new Pa.a("LockAspectRatio","3369422509"),U.legacyControlId="toggleBtnLockAspectRatio",U.queryCommandId="4201275867",U));let ja;this.addCommandToMaps((ja=new Pa.a("Margins","1451516907"),
ja.legacyControlId="flyMargins",ja));let va;this.addCommandToMaps((va=new Pa.a("MergeCells","4127468093"),va.legacyControlId="btnMergeTableCells",va));this.addCommandToMaps(new Pa.a("MoreEmojis","1145444901"));this.addCommandToMaps(new Pa.a("MoreStyles","3340688468"));let Ta;this.addCommandToMaps((Ta=new Pa.a("MoreSymbols","3574218963"),Ta.legacyControlId="btnMoreSymbols",Ta));let fb;this.addCommandToMaps((fb=new Pa.a("MultilevelStyle1","3062940477"),fb.queryCommandId="1240192421",fb.menuItemId="MultilevelStyleMultilevelLibrary_1",
fb));let Db;this.addCommandToMaps((Db=new Pa.a("MultilevelStyle2","3062940477"),Db.queryCommandId="1240192421",Db.menuItemId="MultilevelStyleMultilevelLibrary_2",Db));let gc;this.addCommandToMaps((gc=new Pa.a("MultilevelStyle3","3062940477"),gc.queryCommandId="1240192421",gc.menuItemId="MultilevelStyleMultilevelLibrary_3",gc));let hc;this.addCommandToMaps((hc=new Pa.a("NoHighlight","562361573"),hc.legacyControlId="noFontBackgroundColor",hc));let Gc;this.addCommandToMaps((Gc=new Pa.a("NumberingLibrary",
"2213049770"),Gc.queryCommandId="3488367157",Gc.populationProps=new Yg("3149136033",!1),Gc));let Pc;this.addCommandToMaps((Pc=new Pa.a("Orientation","1451516907"),Pc.legacyControlId="flyOrientation",Pc));let yc;this.addCommandToMaps((yc=new Pa.a("ParagraphOptions","2465215107"),yc.legacyControlId="grpLayoutParagraphDialogLauncherButton",yc));this.addCommandToMaps(new Pa.a(lp.Dyk,"237279923"));let Vd;this.addCommandToMaps((Vd=new Pa.a(lp.yyk,"1656143904"),Vd.legacyControlId="fseaNewPaste",Vd));this.addCommandToMaps(new Pa.a(lp.xyk,
"1656143904"));let De;this.addCommandToMaps((De=new Pa.a("PageSize","1451516907"),De.legacyControlId="flySize",De));this.addCommandToMaps(new Pa.a("Photos","2670646631"));let Wd;this.addCommandToMaps((Wd=new Pa.a("PictureAbsoluteHeight","2808088361"),Wd.legacyControlId="spnAbsoluteHeight",Wd.queryCommandId="2181343285",Wd));let Ve;this.addCommandToMaps((Ve=new Pa.a("PictureAbsoluteWidth","3108736954"),Ve.legacyControlId="spnAbsoluteWidth",Ve.queryCommandId="1960824158",Ve));this.addCommandToMaps(new Pa.a("Print",
"1588554917"));let $e;this.addCommandToMaps(($e=new Pa.a("PrintToWeb","1997662572"),$e.legacyControlId="jbtnDigitalPrint",$e));let Qf;this.addCommandToMaps((Qf=new Pa.a("ReadingView","3849298593"),Qf.legacyControlId="btnReadingMode",Qf));let lg;this.addCommandToMaps((lg=new Pa.a("Redo","4183277502"),lg.legacyControlId="btnRedo",lg));let Hg;this.addCommandToMaps((Hg=new Pa.a("ResetPicture","2916220093"),Hg.legacyControlId="btnResetPicture",Hg));let Qg;this.addCommandToMaps((Qg=new Pa.a("RightToLeftTextDirection",
"2632572640"),Qg.legacyControlId="TextDirRTL",Qg.queryCommandId="1154760330",Qg));let Sf;this.addCommandToMaps((Sf=new Pa.a("RotatePictureMenu","2545543284"),Sf.legacyControlId="flyRotate",Sf));let sh;this.addCommandToMaps((sh=new Pa.a("RotateLeft90","2545543284"),sh.legacyControlId="buttonRotateLeft90",sh.menuItemId="buttonRotateLeft90",sh));let Xg;this.addCommandToMaps((Xg=new Pa.a("RotateRight90","2545543284"),Xg.legacyControlId="buttonRotateRight90",Xg.menuItemId="buttonRotateRight90",Xg));let ni;
this.addCommandToMaps((ni=new Pa.a("SelectCell","111222446"),ni.legacyControlId="btnSelectCell",ni));let Ri;this.addCommandToMaps((Ri=new Pa.a("SelectColumn","2341852628"),Ri.legacyControlId="btnSelectColumn",Ri));let uj;this.addCommandToMaps((uj=new Pa.a("SelectRow","3508003794"),uj.legacyControlId="btnSelectRow",uj));let dj;this.addCommandToMaps((dj=new Pa.a("SelectTable","2306914518"),dj.legacyControlId="btnSelectTable",dj));let ej;this.addCommandToMaps((ej=new Pa.a("ShrinkFontSize","3575191971"),
ej.legacyControlId="fseaShrinkFontSize",ej));let Ei;this.addCommandToMaps((Ei=new Pa.a("SetProofingLanguage","510284732"),Ei.legacyControlId="fseaOpenLanguageDialog",Ei));let Dk;this.addCommandToMaps((Dk=new Pa.a("SpacingAfter","2322582597"),Dk.legacyControlId="spnSpacingAfter",Dk.queryCommandId="2340669283",Dk));let vj;this.addCommandToMaps((vj=new Pa.a("SpacingBefore","1804274502"),vj.legacyControlId="spnSpacingBefore",vj.queryCommandId="26138520",vj));let tk;this.addCommandToMaps((tk=new Pa.a("SpecialIndent",
"2798144440"),tk.legacyControlId="flySpecialIndent",tk));let Fl;this.addCommandToMaps((Fl=new Pa.a("Spelling","2646312425"),Fl.legacyControlId="fseaNextSpellingError",Fl));let rl;this.addCommandToMaps((rl=new Pa.a("StandardShadingColorPicker","2765388691"),rl.legacyControlId="cellShadingColorTable",rl));this.addCommandToMaps(new Pa.a("StandardFontColorPicker","1970784898"));this.addCommandToMaps(new Pa.a("RecentFontColorPicker","1970784898"));let Gl;this.addCommandToMaps((Gl=new Pa.a("Strikethrough",
"4169095173"),Gl.legacyControlId="fsbcStrikethrough",Gl.queryCommandId="2742230607",Gl));let Vj;this.addCommandToMaps((Vj=new Pa.a("StyleOptionsBandedColumns","1583455318"),Vj.legacyControlId="buttonBandedColumn",Vj.queryCommandId="1762426222",Vj.menuItemId="buttonBandedColumn",Vj));let Ek;this.addCommandToMaps((Ek=new Pa.a("StyleOptionsBandedRows","1583455318"),Ek.legacyControlId="buttonBandedRow",Ek.queryCommandId="1762426222",Ek.menuItemId="buttonBandedRow",Ek));let Wj;this.addCommandToMaps((Wj=
new Pa.a("StyleOptionsFirstColumn","1583455318"),Wj.legacyControlId="buttonFirstColumn",Wj.queryCommandId="1762426222",Wj.menuItemId="buttonFirstColumn",Wj));let fk;this.addCommandToMaps((fk=new Pa.a("StyleOptionsHeaderRow","1583455318"),fk.legacyControlId="buttonFirstRow",fk.queryCommandId="1762426222",fk.menuItemId="buttonFirstRow",fk));let Fj;this.addCommandToMaps((Fj=new Pa.a("StyleOptionsLastColumn","1583455318"),Fj.legacyControlId="buttonLastColumn",Fj.queryCommandId="1762426222",Fj.menuItemId=
"buttonLastColumn",Fj));let sl;this.addCommandToMaps((sl=new Pa.a("StyleOptionsTotalRow","1583455318"),sl.legacyControlId="buttonLastRow",sl.queryCommandId="1762426222",sl.menuItemId="buttonLastRow",sl));let dh;this.addCommandToMaps((dh=new Pa.a("Subscript","1455408143"),dh.legacyControlId="fsbcSubscript",dh.queryCommandId="3960255053",dh));let Rl;this.addCommandToMaps((Rl=new Pa.a("Superscript","1107614"),Rl.legacyControlId="fsbcSuperscript",Rl.queryCommandId="692901994",Rl));let lm;this.addCommandToMaps((lm=
new Pa.a("Table","28738965"),lm.legacyControlId="flyInsertTable",lm));let Fk;this.addCommandToMaps((Fk=new Pa.a("TableStyles","4171428777"),Fk.queryCommandId="2135594455",Fk.populationProps=new Yg("3359297384",!1),Fk.previewControlIds="buttonTableStyleRibbon0 buttonTableStyleRibbon1 buttonTableStyleRibbon2 buttonTableStyleRibbon3 buttonTableStyleRibbon4 buttonTableStyleRibbon5 buttonTableStyleRibbon6".split(" "),Fk));this.addCommandToMaps(Object.assign(new Pa.a("TextAlignmentAnchor",null),{legacyControlId:"legacyTextAlignmentAnchor"}));
this.addCommandToMaps(Object.assign(new Pa.a("TextAlignmentCenterJustify","4284004393"),{legacyControlId:"legacyTextAlignmentCenterJustify",queryCommandId:"3263071675"}));this.addCommandToMaps(Object.assign(new Pa.a("TextAlignmentFullJustify","1733835213"),{legacyControlId:"legacyTextAlignmentFullJustify",queryCommandId:"1257252315"}));this.addCommandToMaps(Object.assign(new Pa.a("TextAlignmentLeftJustify","2539120357"),{legacyControlId:"legacyTextAlignmentLeftJustify",queryCommandId:"3797776291"}));
this.addCommandToMaps(Object.assign(new Pa.a("TextAlignmentRightJustify","393413924"),{legacyControlId:"legacyTextAlignmentRightJustify",queryCommandId:"2003732276"}));this.addCommandToMaps(new Pa.a("ThemeShadingColorPicker","2765388691"));this.addCommandToMaps(new Pa.a("ThemeShadingColorPickerMCU","2765388691"));this.addCommandToMaps(new Pa.a("ThemeFontColorPicker","1970784898"));this.addCommandToMaps(new Pa.a("ThemeFontColorPickerMCU","1970784898"));this.addCommandToMaps(new Pa.a("ToggleChangeCase",
"1208649786"));this.addCommandToMaps(Object.assign(new Pa.a("Underline","1863297734"),{legacyControlId:"fsbcUnderline",queryCommandId:"2302164066"}));this.addCommandToMaps(Object.assign(new Pa.a("Undo","2792113512"),{legacyControlId:"btnUndo"}));this.addCommandToMaps(new Pa.a("OpenInClientUpsell","3588168074"));this.addCommandToMaps(Object.assign(new Pa.a("SelectAll","344786228"),{legacyControlId:"SelectAllButton"}));this.addCommandToMaps(Object.assign(new Pa.a("EditInClient","3588168074"),{legacyControlId:"btnjEditInClient"}));
this.addCommandToMaps(Object.assign(new Pa.a("OpenInClient","3588168074"),{legacyControlId:"btnjOpenInClient"}));let Sl;this.addCommandToMaps((Sl=new Pa.a("PrintDocument","1588554917"),Sl.legacyControlId="jbtnDirectPrint",Sl));let Xi;this.addCommandToMaps((Xi=new Pa.a("PrintToPdf","1588554917"),Xi.legacyControlId="jbtnPrintToPdf",Xi));let xi;this.addCommandToMaps((xi=new Pa.a("ProtectDocument","1642700244"),xi.legacyControlId="btnProtectDocument",xi.queryCommandId="3993403020",xi));let mg;this.addCommandToMaps((mg=
new Pa.a("TransformToWebPage","1997662572"),mg.legacyControlId="jbtnTransformToWeb",mg));let eh;this.addCommandToMaps((eh=new Pa.a("OpenInClientWithIcon","3588168074"),eh.legacyControlId="btnOpenInClient",eh));let jh;this.addCommandToMaps((jh=new Pa.a("BulletLibrary_MLR","3552651681"),jh.queryCommandId="3827179399",jh.populationProps=new Yg("2466004410",!1),jh));let xd;this.addCommandToMaps((xd=new Pa.a("InsertPicture_MLR","2670646631"),xd.legacyControlId="fseaInsertPicture",xd));let Ne;this.addCommandToMaps((Ne=
new Pa.a("NumberingLibrary_MLR","2213049770"),Ne.queryCommandId="3488367157",Ne.populationProps=new Yg("3149136033",!1),Ne));let le;this.addCommandToMaps((le=new Pa.a("PasteStandalone","237279923"),le.legacyControlId="fseaPaste",le));let yf;this.addCommandToMaps((yf=new Pa.a("Clipboard_MLR","237279923"),yf.legacyControlId="fseaNewPaste",yf));let Eg;this.addCommandToMaps((Eg=new Pa.a("InsertOnlinePictureStandalone","1685987254"),Eg.legacyControlId="fseaInsertOnlinePicture",Eg));let Fi;this.addCommandToMaps((Fi=
new Pa.a("InsertPictureFromHostStandalone","720118144"),Fi.legacyControlId="fseaInsertOnlinePictureFromHost",Fi.queryCommandId="3612507612",Fi))}HNd(){this.addTabToMap("Picture","3523575366");this.addTabToMap("Table","1898844988")}}lp.YHi="Cut";lp.Tzi="Copy";lp.Dyk="Paste";lp.yyk="PasteAsTextOnly";lp.xyk="PasteAsTextOnlyContextMenu";Object(n.a)(lp,"Box4ReactCommandDefinitionMapping",Xw,[]);class xj extends hr{constructor(a,b,c){super();this.Ejf=b;this.Gm=c;this.vb(a)}vb(a){a.ra(D.a.Sgd,xb.a.application,
Object(F.a)(this,this.B$g,"populateContextMenu"),96);a.ra(D.a.G$g,xb.a.application,Object(F.a)(this,this.B$g,"populateContextMenu"),96)}show(a,b,c){let h=null,m=new Sys.UI.Bounds(0,0,0,0);const y=this.Jej(a);if(y&&(a=a.Ua.node)&&(a=a.sc(na.InteractiveViewManager.instance.Rd.Ma))){m=W.a.Kt(a,y.end);if(u.AFrameworkApplication.isRtl&&m.x>b.x||!u.AFrameworkApplication.isRtl&&m.x+m.width<b.x||m.y+m.height<b.y)m=W.a.Kt(a,y.end-1);b.x=m.x+(u.AFrameworkApplication.isRtl?0:m.width);b.y=m.y+m.height;h=6}hr.ipd("mnuSpellingError",
new Sys.UI.Bounds(b.x,b.y,m.width,m.height),c,h)}B$g(a,b,c,h,m){if(1===c)return 32;a=m.vv;m=m.rd;b=Object.assign(new Mk.a,{ExternalId:"ContextMenu",UpdateDynamically:!0,MenuSectionList:[]});this.GDi(b,a);m.MenuItems=b;return 32}pae(a,b){return this.zvh(a)||xj.eCf(D.a.mergeCells)||xj.eCf(D.a.splitCells)||this.uhl(a,b)||this.ifl(a,b)||xj.sgl()||xj.cvh(a).returnValue}zvh(a){return 2===Fc.App.Kb.mode&&this.$Yc(a)}L0b(a,b,c,h=null){if(this.zvh(a)){c=this.Iej(a);var m=Fa.a.ue(c.lcid);m=m?m.name:"UNKNOWN";
var y=Object(za.a)(Wi.a,c)?c.typeId:"";ba.ULS.sendTraceTag(8712398,324,50,"ErrorType:{0}, ProofingType:{1}, CritiqueId:{2}, CultureTag:{3}",c.errorType,c.proofingType,y,m);h?(a=this.Ejf.G0b(a,c))&&h.push.apply(h,a):b.append(this.Ejf.create(a,c))}}Iej(a){return this.Gm.vSa(a.Ua).Gh}$Yc(a){return this.Gm.Toc(a)}PZf(){return null}Jej(a){return this.$Yc(a)?this.Gm.vSa(a.Ua):(a=this.PZf(a))?new Bk.a(a.oN,a.Nb):null}uhl(a,b){if(2!==Fc.App.Kb.mode||!a||!xj.ePj&&this.vhl(a,b))return!1;a=ib.a.EQa(a.toArray());
return!!xj.jm.F2(a,14)}vhl(a,b){return 2===b||3===b&&!this.$Yc(a)}ifl(a,b){return 3!==b||this.$Yc(a)}static get Sf(){return xj.Ug||(xj.Ug=vb.a.instance.resolve("Box4.List.IListReader"))}static get jm(){return tg.ContextSetEditor.instance}static get ePj(){return 1===Fc.App.mode}static get JMj(){null==xj.qCd&&(xj.qCd=u.AFrameworkApplication.fa?u.AFrameworkApplication.fa.ka("HyperlinkContextMenuOnEOPFixIsEnabled"):!1);return xj.qCd}static get zic(){null==xj.z1a&&(xj.z1a=u.AFrameworkApplication.fa?u.AFrameworkApplication.fa.ka("MultiParagraphHyperlinkEditEnabled"):
!1);return xj.z1a}static get yS(){null==xj.PM&&(xj.PM=u.AFrameworkApplication.fa?u.AFrameworkApplication.fa.ka("AddHyperlinkWhenSelectionContainsLineBreak"):!1);return xj.PM}static eCf(a){return 32===u.AFrameworkApplication.Ta.processAction(a,1)}static sgl(){return 2===Fc.App.Kb.mode&&!!Fc.App.HD.KS&&Fc.App.HD.KS.xjg("510284732")}static cvh(a){let b,c;b=c=!1;if(!a)return{returnValue:!1,xTa:b,y7b:c};if(xj.zic)return xj.ggl(a);if(!(a.lca||xj.JMj&&2===a.length&&a.Ye.contextId===xb.a.endOfParagraph))return{returnValue:!1,
xTa:b,y7b:c};a=a.Ua.clone();b=32===u.AFrameworkApplication.Ta.mi(a,D.a.ZIa,1,!0,null,null);c=32===u.AFrameworkApplication.Ta.mi(a,D.a.insertHyperlink,1,!0,null,null);return{returnValue:b||c,xTa:b,y7b:c}}static ggl(a){let b;let c;var h=a.Ua.clone();c=xj.yS&&Ud.m(h);b=!c&&32===u.AFrameworkApplication.Ta.mi(h,D.a.ZIa,1,!0,null,null);if(a.lca||2===a.length&&a.Ye.contextId===xb.a.endOfParagraph)h=!c&&32===u.AFrameworkApplication.Ta.mi(h,D.a.insertHyperlink,1,!0,null,null);else{h=!0;const m=a.length;for(let y=
0;y<m;y++){const G=a.ga(y).clone();if(G.contextId===xb.a.paragraph||G.contextId===xb.a.textRange)(c=xj.yS&&Ud.m(G))||(h=32===u.AFrameworkApplication.Ta.mi(G,D.a.insertHyperlink,1,!0,null,null)&&h);else if(G.contextId!==xb.a.endOfParagraph)return h=b=!1,{returnValue:!1,xTa:b,y7b:h}}}return{returnValue:b||h,xTa:b,y7b:h}}static VCi(a,b){let c=!1,h=!1;({xTa:c,y7b:h}=xj.cvh(a)).returnValue&&(c?h?b.push(xj.b7d(["EditHyperlink","SelectHyperlink","OpenHyperlink","CopyHyperlink","RemoveHyperlink"])):b.push(xj.b7d(["OpenHyperlink"])):
h&&b.push(xj.b7d(["InsertLink"])))}static b7d(a){const b=Object.assign(new di.a,{ControlList:[]});for(const c of a)Array.add(b.ControlList,Object.assign(new zf.a,{ExternalId:c}));return b}}xj.qCd=null;xj.Ug=null;xj.z1a=null;xj.PM=null;Object(n.a)(xj,"AEditSurfaceContextMenu",hr,[]);class Sz extends xj{constructor(a,b,c,h,m,y,G,U,ja,va){super(a,c,b,void 0,va);this.LVa=0;this.Hpe=h;this.iGa=m;this.la=y;this.U8c=this.la.jIb;this.ndc=this.la.M7b;this.kUg=this.la.o_c;this.rUg=this.la.Rke;this.nXa=this.la.Iib;
this.s5j=this.la.Dlc;this.BNg=va;this.FC=b;this.EPg=G;this.qE=U;this.Sb=ja;this.o8c=this.la.Uzk}GDi(a,b){const c=[];switch(this.LVa){case 4:this.Wqa(c,!0);this.Tqf(c);this.Q4h(c);this.g5h(c);this.nXa&&this.o6h(c);this.GXb(c);this.jPa(c);break;case 7:case 8:case 13:case 15:case 11:case 14:case 16:this.Wqa(c,!1);this.ENd(c,this.LVa);this.GXb(c);this.jPa(c);this.xtb(c);break;case 6:case 5:this.Wqa(c,!1);this.ENd(c,this.LVa);this.la.jIb&&this.la.fsh&&this.Rqf(c);this.jPa(c);this.xtb(c);break;case 2:this.Wqa(c,
!0);this.wFc(c,!0);this.la.Ks&&this.vFc(c);break;case 1:this.Wqa(c,!1);this.wFc(c,!1);this.la.Eyh&&this.Q6h(c);this.Tqf(c);this.Iqf(c);bx.Ysh&&this.zrf(c);this.la.Ks&&this.vFc(c);this.GXb(c);this.jPa(c);this.xtb(c);break;case 3:this.H3h(c);this.xtb(c);break;case 19:this.I6h(c);this.wFc(c,!1);this.Iqf(c);bx.Ysh&&this.zrf(c);u.AFrameworkApplication.fa.ka("PPTSorterViewSectionMenuEnabled")&&this.vFc(c);this.GXb(c);break;case 21:this.w7h(c);break;case 20:this.Wqa(c,!0);this.wFc(c,!0);u.AFrameworkApplication.fa.ka("PPTSorterViewSectionMenuEnabled")&&
this.vFc(c);this.GXb(c);break;case 9:this.Wqa(c,!1);this.jPa(c);break;case 22:this.Wqa(c,!1);this.ENd(c,this.LVa);this.jPa(c);break;case 10:this.Wqa(c,!1);this.F5h(c);this.jPa(c);this.xtb(c);break;case 17:this.A5h(c);break;case 18:this.B5h(c);break;case 0:if(this.Sb.Lj()){var h=na.InteractiveViewManager.instance.Rd.Lb.Pa.mb;this.L0b(h,null,b,c);this.Wqa(c,!1);this.la.powerPointSmartLookupIsEnabled&&(this.H6h(c),this.V6h(c));3===b&&this.nOj(h)&&this.v4h(c);this.T5h(c);xj.VCi(h,c);this.tGi(h,c);this.sGi(h,
c);this.U8c&&this.Rqf(c);this.ABi(c);this.jPa(c);this.xtb(c)}}for(const m of c)Array.add(a.MenuSectionList,m);this.LVa=0}dph(a){this.LVa=a}Lt(){return Object.assign(new di.a,{ControlList:[]})}thl(a){if(!this.kUg&&!this.rUg||2!==Fc.App.Kb.mode)return!1;a=ib.a.EQa(a.toArray());return!!this.iGa.F2(a,14)}shl(a){if(!a||!this.s5j||2!==Fc.App.Kb.mode)return!1;a=ib.a.EQa(a.toArray());return!!this.iGa.F2(a,14)}Wqa(a,b){const c=this.Lt();b||(Array.add(c.ControlList,Object.assign(new zf.a,{ExternalId:"Cut"})),
Array.add(c.ControlList,Object.assign(new zf.a,{ExternalId:"Copy"})));this.drf(a,c)}drf(a,b){const c=Object.assign(new di.a,{DisplayMode:"Size24by24",ControlList:[],Title:ResourceStrings.L_PasteOptions,ShowMenuSectionTitleIcon:!1,ShowMenuSectionTitleBackground:!1,MenuSectionTitleFocusable:!1}),h=Object.assign(new qq.a,{Id:"PasteOptions",ExternalId:"PasteOptionsSection",ExternalGalleryId:"PasteOptionsGallery",Type:4,Width:5,ElementDimensions:"Size24by24",GalleryItems:[]});Array.add(c.ControlList,h);
for(let m=1;5>=m;m++)h.GalleryItems.push(this.Avb(m));a.push(b);a.push(c)}Avb(a){const b={root:{width:"24px",height:"24px"}};let c,h,m;switch(a){case 1:m="ContextMenu.Paste";a="Paste_20";c="3642315978";h=ResourceStrings.L_Paste;break;case 2:m="ContextMenu.PasteKeepingDestinationTheme";a="Pastedestinationtheme_20";c="4207422373";h=ResourceStrings.L_PasteWithDestinationTheme;break;case 3:m="ContextMenu.PasteKeepingSourceFormatting";a="Pastesourceformatting_20";c="2529825506";h=ResourceStrings.l_PasteWithSourceTheme;
break;case 4:m="ContextMenu.PasteAsImage";a="Pasteaspicture_20";c="1302928870";h=ResourceStrings.l_PasteAsImage;break;case 5:m="ContextMenu.PasteTextOnly";a="PasteTextOnly_20";c="2061487721";h=ResourceStrings.L_PasteTextOnly;break;default:m="ContextMenu.Paste",a="Paste_20",c="3642315978",h=ResourceStrings.L_Paste}return Object.assign(new ZD.a,{Id:m,Icon:a,Alt:h,PreviewIconStyle:b,FullIconStyle:b,Command:c})}w7h(a){const b=this.Lt();Array.add(b.ControlList,Object.assign(new zf.a,{ExternalId:"CopyInVersionHistory"}));
a.push(b)}I6h(a){const b=this.Lt();Array.add(b.ControlList,Object.assign(new zf.a,{ExternalId:"Cut"}));Array.add(b.ControlList,Object.assign(new zf.a,{ExternalId:"Copy"}));this.drf(a,b)}wFc(a,b){const c=this.Lt();Array.add(c.ControlList,Object.assign(new zf.a,{ExternalId:"NewSlideWithoutDialog"}));b||(Array.add(c.ControlList,Object.assign(new zf.a,{ExternalId:"DuplicateSlide"})),Array.add(c.ControlList,Object.assign(new zf.a,{ExternalId:"DeleteSlide"})));a.push(c)}Q4h(a){if(this.o8c){const b=this.Lt();
b.ControlList.push(Object.assign(new zf.a,{ExternalId:"FormatBackgroundFromCanvas"}));a.push(b)}}H3h(a){const b=this.Lt();Array.add(b.ControlList,Object.assign(new zf.a,{ExternalId:"Paste"}));Array.add(b.ControlList,Object.assign(new zf.a,{ExternalId:"NewSlideWithoutDialog"}));a.push(b)}Iqf(a){const b=this.Lt();Array.add(b.ControlList,Object.assign(new zf.a,{ExternalId:"HideSlide"}));this.la.fbe&&Array.add(b.ControlList,Object.assign(new zf.a,{ExternalId:"UnhideSlide"}));a.push(b)}zrf(a){const b=
this.Lt();Array.add(b.ControlList,Object.assign(new zf.a,{ExternalId:"ShareSlide"}));a.push(b)}B5h(a){const b=this.VYf();a.push(b)}vFc(a){const b=this.Lt();Array.add(b.ControlList,Object.assign(new zf.a,{ExternalId:"AddSection"}));a.push(b)}ENd(a,b){const c=this.Lt();7===b?(this.la.yJa?Array.add(c.ControlList,Object.assign(new zf.a,{ExternalId:"ChangePictureContextMenu"})):Array.add(c.ControlList,Object.assign(new zf.a,{ExternalId:"ChangePicture"})),this.la.jUa&&Array.add(c.ControlList,Object.assign(new zf.a,
{ExternalId:"AlternativeText"}))):13===b?this.la.yJa&&Array.add(c.ControlList,Object.assign(new zf.a,{ExternalId:"ChangeGraphicContextMenu"})):8===b?Array.add(c.ControlList,Object.assign(new zf.a,{ExternalId:"SmartArtEditText"})):14!==b&&15!==b&&16!==b&&22!==b&&Array.add(c.ControlList,Object.assign(new zf.a,{ExternalId:"BeginEditShapeText"}));22!==b&&(this.Gqf(c),this.la.oPc&&this.yqf(c));this.lqf(c);this.Xxf(c);this.poh(c);a.push(c)}Tqf(a){const b=this.Lt();Array.add(b.ControlList,Object.assign(new zf.a,
{ExternalId:this.la.FZa?"ChangeLayoutFlyout":"ChangeLayout"}));a.push(b)}Rqf(a){const b=this.Lt();this.ndc&&Array.add(b.ControlList,Object.assign(new zf.a,{ExternalId:"ImmersiveReader"}));Array.add(b.ControlList,Object.assign(new zf.a,{ExternalId:"OpenPowerPointLanguageDialog"}));a.push(b)}GXb(a){if(this.ndc){var b=this.Lt();Array.add(b.ControlList,Object.assign(new zf.a,{ExternalId:"ImmersiveReader"}));a.push(b)}}poh(a){Array.add(a.ControlList,Object.assign(new zf.a,{ExternalId:"SendToBackFlyout"}))}Xxf(a){Array.add(a.ControlList,
Object.assign(new zf.a,{ExternalId:"BringToFrontFlyout"}))}Gqf(a){Array.add(a.ControlList,Object.assign(new zf.a,{ExternalId:"GroupAnchor"}))}lqf(a){Array.add(a.ControlList,Object.assign(new zf.a,{ExternalId:"ShowHideFormatShapePane"}))}yqf(a){Array.add(a.ControlList,Object.assign(new zf.a,{ExternalId:"FixIt"}))}F5h(a){const b=this.Lt();this.Gqf(b);this.la.oPc&&this.yqf(b);this.lqf(b);this.Xxf(b);this.poh(b);a.push(b)}jPa(a){const b=this.Lt();Array.add(b.ControlList,Object.assign(new zf.a,{ExternalId:"InsertComment"}));
a.push(b)}g5h(a){const b=this.Lt();Array.add(b.ControlList,Object.assign(new zf.a,{ExternalId:"DesignerHome"}));a.push(b)}o6h(a){const b=this.Lt();Array.add(b.ControlList,Object.assign(new zf.a,{ExternalId:"ShowHideRuler"}));a.push(b)}cDi(){const a=this.Hpe.ZFi();return Object.assign(new zf.a,{ExternalId:"SmartLookupContextMenu",LabelText:a})}H6h(a){const b=this.Lt();Array.add(b.ControlList,this.cDi());a.push(b)}V6h(a){if(!this.Hpe.tqi()){var b=this.Hpe.oGi();if(b){var c=this.Lt();Array.add(c.ControlList,
Object.assign(new zf.a,{ExternalId:"SmartLookupSynonyms",LabelText:b}));a.push(c)}}}T5h(a){const b=this.Lt();Array.add(b.ControlList,Object.assign(new zf.a,{ExternalId:"ParagraphOptions"}));a.push(b)}v4h(a){const b=this.Lt();Array.add(b.ControlList,Object.assign(new zf.a,{ExternalId:"Delete"}));a.push(b)}Q6h(a){const b=this.Lt();Array.add(b.ControlList,Object.assign(new zf.a,{ExternalId:"SummarizeSlides"}));a.push(b)}ABi(a){var b=vb.a.instance.rb("PowerPointWebEditor.IContextMenuExtensibilityHandler");
b&&(b=b.d0i())&&a.push(b)}tGi(a,b){a&&this.thl(a)&&(a=this.Lt(),this.kUg&&Array.add(a.ControlList,Object.assign(new zf.a,{ExternalId:"MergeTableCells"})),this.rUg&&Array.add(a.ControlList,Object.assign(new zf.a,{ExternalId:"SplitTableCells"})),b.push(a))}sGi(a,b){this.shl(a)&&(a=this.Lt(),Array.add(a.ControlList,Object.assign(new zf.a,{ExternalId:"SetSizeAnchor"})),Array.add(a.ControlList,Object.assign(new zf.a,{ExternalId:"TableDistribute"})),b.push(a))}nOj(a){return this.FC.Toc(a)}A5h(a){const b=
this.VYf();Array.add(b.ControlList,Object.assign(new zf.a,{ExternalId:"NewSlideWithoutDialog"}));a.push(b)}VYf(){const a=this.Lt();Array.add(a.ControlList,Object.assign(new zf.a,{ExternalId:"RenameSection"}));Array.add(a.ControlList,Object.assign(new zf.a,{ExternalId:"RemoveSection"}));Array.add(a.ControlList,Object.assign(new zf.a,{ExternalId:"MoveSectionUp"}));Array.add(a.ControlList,Object.assign(new zf.a,{ExternalId:"MoveSectionDown"}));return a}xtb(a){this.EPg&&this.EPg.G0b(this.g4b(),a)}g4b(){return this.qE.instance?
this.qE.instance.g4b():[]}}Object(n.a)(Sz,"EditSurfaceContextMenu",xj,[]);class VL{constructor(a,b,c,h,m,y,G,U,ja,va){this.ugc=null;this.jEb=0;this.GO=b;this.hB=c;this.rla=h;this.zb=y;this.Z4j=G;this.ia=ja;this.Lc=U;this.Lc.$7h(Object(F.a)(this,this.K1g,"onCUIStatusChanged"));this.Lc.GFc(Object(F.a)(this,this.AU,"onFocusChanged"));this.Lc.NFc(Object(F.a)(this,this.zgb,"onSetFocus"));this.D9c=va}get inKeytipMode(){return appChrome.api.inKeytipMode()}dispose(){this.Lc.bTk(Object(F.a)(this,this.K1g,
"onCUIStatusChanged"));this.Lc.fkd(Object(F.a)(this,this.AU,"onFocusChanged"));this.Lc.lPe(Object(F.a)(this,this.zgb,"onSetFocus"))}initialize(){this.vb();this.BH()}AU(){}zgb(a,b){b.Zfb!==Ua.a.iaa||b.YHb===A.AFrame.Lfb||b.YHb.endsWith("/modal")||appChrome.api.enterKeytipMode()}Jsl(a){this.jEb|=a;this.ugc||(this.ugc=new He.a(0,1,0,Object(F.a)(this,this.h$k,"setTimeOutWithCurrentActionContext"),90,"11"),this.ugc.customData=new Date,this.zb.Eb(this.ugc))}vb(){this.ia.ra(M.a.E1,nc.a.application,Object(F.a)(this,
this.rsj,"handleOpenMenu"),64)}rsj(a,b,c,h,m){return this.E1(m)?32:8}h$k(a){Nc.a.lSi(Object(F.a)(this,this.BH,"poll"),Object(ua.a)(Date,a.customData));this.ugc=null}K1g(a,b){this.Jsl(b.ull)}BH(){this.Z4j.clearCache();0!==(this.jEb&1)&&this.hB.BH();0!==(this.jEb&2)&&this.GO.BH();0!==(this.jEb&4)&&this.rla.BH();this.jEb=0}E1(a){return this.D9c.E1(a)}}Object(n.a)(VL,"CUIManager",null,[197,106]);var $D=d(1218),aE=d(1190),BQ=d(1055),bE=d(1076);class $s{constructor(){this.italic=0;this.O_c=!1;this.underline=
0;this.pV=this.Vsd=!1;this.superscript=0;this.Dqd=!1;this.subscript=0;this.zqd=!1;this.strikethrough=0;this.rqd=!1;this.Vs=0;this.cNc=!1;this.fontName=null;this.R3b=this.Drd=this.APc=this.zPc=!1;this.highlight=0;this.xVc=!1;this.bold=this.italic=this.underline=this.strikethrough=this.Vs=this.superscript=this.subscript=2;this.fontColor=this.highlight=this.fontSize=-1;this.Lw=lf.Font.TFj;this.Noa=-1;this.iRd=this.O_c=this.Vsd=this.pV=this.Dqd=this.zqd=this.rqd=this.cNc=this.zPc=this.APc=this.Drd=this.R3b=
this.xVc=!1}}Object(n.a)($s,"FormattingData",null,[]);var cE=d(820),CQ=d(786);class Sk{constructor(){this.Vm=this.Egb=0;this.rd=null;this.ZF=!1;this.XK=null}}Object(n.a)(Sk,"CuiEnabledInfo",null,[]);class bh{constructor(){this.Vm=this.Egb=0;this.rd=null;this.ZF=this.Lje=this.Mje=this.aX=this.Wq=this.Rae=!1;this.XK=null}}Object(n.a)(bh,"CuiExecuteInfo",null,[]);class DQ{constructor(){this.RYe=new jq.a;this.zie=!1}}Object(n.a)(DQ,"TextRangeStyleData",null,[]);class sg{constructor(){this.jb=new Nd.a;
this.Xc=new Nd.a;this.kaf=new $s;this.Hif=new cE.a;this.KAd=this.JAd=!1}initialize(){sg.fzh=sg.gXd();this.jb.$(D.a.undo,sg.W7b);this.jb.$(D.a.redo,sg.W7b);this.jb.$(D.a.Ccd,sg.W7b);this.jb.$(D.a.G$g,sg.rrl);this.jb.$(D.a.openInClient,sg.Yuk);this.jb.$(H.a.close,sg.tti);this.jb.$(D.a.TK,sg.rLi);this.jb.$(D.a.font,sg.W2d);this.jb.$(D.a.ir,Object(F.a)(this,this.K3d,"genericFontSizeExecuteBridge"));u.AFrameworkApplication.fa.ka("FontPreviewEnabled")&&(this.jb.$(D.a.A5,sg.W2d),this.jb.$(D.a.jKa,sg.W2d),
this.jb.$(D.a.AJa,Object(F.a)(this,this.K3d,"genericFontSizeExecuteBridge")),this.jb.$(D.a.e_a,Object(F.a)(this,this.uZk,"revertPreviewFontSizeExecuteBridge")));this.jb.$(D.a.bold,sg.nvb);this.jb.$(D.a.setItalic,sg.nvb);this.jb.$(D.a.underline,sg.nvb);this.jb.$(D.a.strikethrough,sg.nvb);this.jb.$(D.a.superscript,sg.nvb);this.jb.$(D.a.subscript,sg.nvb);this.jb.$(D.a.amc,Object(F.a)(this,this.xxa,"queryFormattingExecuteBridge"));this.jb.$(D.a.jmc,Object(F.a)(this,this.xxa,"queryFormattingExecuteBridge"));
this.jb.$(D.a.Umc,Object(F.a)(this,this.xxa,"queryFormattingExecuteBridge"));this.jb.$(D.a.Kmc,Object(F.a)(this,this.xxa,"queryFormattingExecuteBridge"));this.jb.$(D.a.Mmc,Object(F.a)(this,this.xxa,"queryFormattingExecuteBridge"));this.jb.$(D.a.tMe,Object(F.a)(this,this.xxa,"queryFormattingExecuteBridge"));this.jb.$(D.a.Nmc,Object(F.a)(this,this.xxa,"queryFormattingExecuteBridge"));this.jb.$(D.a.Lhd,Object(F.a)(this,this.xxa,"queryFormattingExecuteBridge"));this.jb.$(D.a.emc,Object(F.a)(this,this.xxa,
"queryFormattingExecuteBridge"));this.jb.$(D.a.Mhd,Object(F.a)(this,this.xxa,"queryFormattingExecuteBridge"));this.jb.$(D.a.ILe,Object(F.a)(this,this.$Gk,"queryFormatPainterExecuteBridge"));this.jb.$(D.a.kmc,Object(F.a)(this,this.Whd,"queryParaFormattingExecuteBridge"));this.jb.$(D.a.wmc,Object(F.a)(this,this.Whd,"queryParaFormattingExecuteBridge"));this.jb.$(D.a.dmc,Object(F.a)(this,this.Whd,"queryParaFormattingExecuteBridge"));this.jb.$(D.a.fmc,Object(F.a)(this,this.Whd,"queryParaFormattingExecuteBridge"));
this.jb.$(D.a.MD,sg.eRf);this.jb.$(D.a.qz,sg.eRf);this.jb.$(H.a.uUd,sg.cmc);this.jb.$(D.a.fAb,sg.W7b);this.Xc.$(D.a.sHb,sg.wMc);this.Xc.$(D.a.tHb,sg.wMc);this.Xc.$(D.a.dlc,sg.wMc);this.Xc.$(D.a.clc,sg.wMc);this.Xc.$(D.a.amc,sg.Jxa);this.Xc.$(D.a.jmc,sg.Jxa);this.Xc.$(D.a.Umc,sg.Jxa);this.Xc.$(D.a.Kmc,sg.Jxa);this.Xc.$(D.a.Mmc,sg.Jxa);this.Xc.$(D.a.tMe,sg.Jxa);this.Xc.$(D.a.Nmc,sg.Jxa);this.Xc.$(D.a.Lhd,sg.Jxa);this.Xc.$(D.a.emc,sg.Jxa);this.Xc.$(D.a.Mhd,sg.Jxa);this.Xc.$(D.a.kmc,sg.Sjd);this.Xc.$(D.a.dmc,
sg.Sjd);this.Xc.$(D.a.wmc,sg.Sjd);this.Xc.$(D.a.fmc,sg.Sjd);this.jb.$(D.a.HEf,Object(F.a)(this,this.OEj,"insertHyperLinkBridge"));this.jb.$(D.a.zUd,Object(F.a)(this,this.GEf,"commandingInputMethodExecuteBridge"));this.jb.$(D.a.LEf,Object(F.a)(this,this.GEf,"commandingInputMethodExecuteBridge"));this.jb.$(D.a.IEf,Object(F.a)(this,this.XEj,"insertOnLinePictureExecuteBridge"));this.jb.$(D.a.JEf,Object(F.a)(this,this.lFj,"insertSymbolBridge"));this.jb.$(D.a.KEf,Object(F.a)(this,this.Cui,"commandingInsertTableExecuteBridge"));
this.jb.$(D.a.Dui,Object(F.a)(this,this.Gik,"navToPageExecuteBridge"));this.jb.$(D.a.FEf,sg.EEf);this.jb.$(D.a.yUd,sg.EEf);u.AFrameworkApplication.fa.ka("CuiActionBridgeBridgeFunctionEnabledInWebEditor")&&this.Xc.$(H.a.mKb,sg.D1k)}clearCache(){this.kaf=new $s;this.Hif=new cE.a;this.KAd=this.JAd=!1}k_f(a,b,c){const h=this.jb.ga(a);h?c=h(a,b,c):(c=new bh,c.rd=b);c.Egb=a;c.Vm||(c.Vm=sg.bfk(a));Dg.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.FlagExclusivelyMappedCommands")&&
this.vui(a,b)&&(c.rd||(c.rd={}),"object"===typeof c.rd&&(c.rd.MappedCommand=!0));return c}CRc(a,b=null){const c=this.Xc.ga(a);b=c?c(a,b):new Sk;b.Egb=a;b.Vm||(b.Vm=a);return b}xxa(){const a=new bh;a.Rae=this.KAd;this.KAd=!0;a.Vm=D.a.qIb;a.rd=this.kaf;a.aX=!0;return a}Whd(){const a=new bh;a.Rae=this.JAd;this.JAd=!0;a.Vm=D.a.yxa;a.rd=this.Hif;a.Lje=!0;a.aX=!0;return a}K3d(a,b){const c=new bh;c.Wq=!0;let h=0;({number:h}=ta.a.Zxk(b.CommandValueId||b.Value,u.AFrameworkApplication.numberFormat));if(isNaN(h))return Fc.App.Kb.updateCommandUI(),
c.XK=!1,c;a===D.a.AJa&&(b[en.a.Rfa]=!1);c.rd=sg.YVd(Math.floor(2*h),b);return c}uZk(a,b){a=new bh;a.Wq=!0;b[en.a.Rfa]=!1;a.rd=sg.YVd(0,b);return a}GEf(a){var b={Visible:!0};a===D.a.zUd?(b.LabelText="Undo",b.SourceControlId="btnUndo"):(b.LabelText="Redo",b.SourceControlId="btnRedo");a=new aE.a(b,2);b=new bh;b.rd=a;return b}XEj(a,b){a=new bh;const c=new E.DictionaryPropertySet;b=b.Value?b.Value:null;if(!b||""===b)return null;b=String.format("<img src={0}>",b);c.setValue(xc.a.FU,b);a.rd=c;return a}OEj(a,
b){a=new bh;b.Source="CommandingInterface";a.rd=b;return a}Cui(a,b){a=new bh;a.Wq=!0;const c=new dI;c.rows=b.Row;c.columns=b.Col;a.rd=c;return a}lFj(a,b){a=new bh;a.Wq=!0;b=b.Value;a.rd=new E.DictionaryPropertySet;const c=this.BTc(b),h={};h.SourceControlId="symbol_"+b+"_"+c;h.InnerHtml=String.format('<div class="SymbolButtonInnerHTML" aria-hidden="true" style="color: black">{0}</div>',c);a.rd=h;return a}Gik(a,b){a=new bh;a.rd=b.Value?b.Value:"";return a}$Gk(){const a=new bh;a.rd=vb.a.instance.rb("Box4.IFormatPainter");
a.aX=!0;return a}BTc(a){return sg.fzh[a.toString()]}vui(a,b){a=b&&b.launcherCommandId?b.launcherCommandId:a;b=!!this.Xc.ga(a)||!!this.jb.ga(a);return!u.AFrameworkApplication.Ta.$S(a)&&b}static gXd(){return{0:"\u2022",1:"\u20ac",2:"\u00a3",3:"\u00a5",4:"\u00a9",5:"\u00ae",6:"\u2122",7:"\u00b1",8:"\u2260",9:"\u2264",10:"\u2265",11:"\u00f7",12:"\u00d7",13:"\u221e",14:"\u00b5",15:"\u03b1",16:"\u03b2",17:"\u03c0",18:"\u03a9",19:"\u03a3",20:"\u00b0",21:"\u0394",22:"\u263a",23:"\u2665",24:"\u20b9"}}static xYb(a,
b){var c=Object(ua.a)($s,a.rd),h=Object(ua.a)(cE.a,a.rd);let m=!0;switch(a.Egb){default:m=!1;break;case D.a.Cch:b[Zh.a.On]=!0;break;case D.a.amc:b[Zh.a.On]=1===c.bold;break;case D.a.jmc:b[Zh.a.On]=1===c.italic;break;case D.a.Umc:b[Zh.a.On]=1===c.underline;break;case D.a.tMe:b[yG.a.On]=1===c.subscript;break;case D.a.Mmc:b[Zh.a.On]=1===c.subscript;break;case D.a.Nmc:b[Zh.a.On]=1===c.superscript;break;case D.a.Kmc:b[Zh.a.On]=1===c.strikethrough||1===c.Vs;break;case D.a.Lhd:b[Wn.a.IsFreeForm]=!0;b[Wn.a.Value]=
void 0!==c.fontName&&null!==c.fontName?uc.a.RZf(c.fontName,c.Noa):"";break;case D.a.emc:a="";-1!==c.fontSize&&(a=ta.a.OPc(c.fontSize/2,0,u.AFrameworkApplication.numberFormat));b[Wn.a.IsFreeForm]=!0;b[Wn.a.Value]=a;break;case D.a.Mhd:if(void 0!==c.fontName&&null!==c.fontName){if(a=1===c.bold,h=1===c.italic,a=ka.FontUtils.aHk(c.fontName,a,h,a&&h?Box4Intl.Box4Strings.L_FontNameBoldItalic:a?Box4Intl.Box4Strings.L_FontNameBold:h?Box4Intl.Box4Strings.L_FontNameItalic:"{0}"),void 0===c.fontName||null===
c.fontName)a=uc.a.RZf(c.fontName,c.Noa),a=appChrome.api.selectedFont(a,c.fontName)}else a=appChrome.api.selectedFont("");void 0!==a.isMissingFont&&null!==a.isMissingFont||void 0===a.name||null===a.name||""===a.name||(a.isMissingFont=ka.FontUtils.isMissingFont(void 0!==a.key&&null!==a.key&&""!==a.key?a.key:a.name));b[Xn.SelectedFont]=a;break;case D.a.kmc:b[Zh.a.On]=1===h.Il;break;case D.a.dmc:b[Zh.a.On]=2===h.Il;break;case D.a.wmc:b[Zh.a.On]=3===h.Il;break;case D.a.fmc:b[Zh.a.On]=6===h.Il;break;case D.a.ILe:if(c=
Object(ua.a)(254,a.rd))b[Zh.a.On]=c.oL;case H.a.uUd:}return m}static eRf(){return new bh}static cmc(a,b){a=new bh;a.rd=b;a.aX=!0;return a}static W7b(a,b,c){a=new aE.a(b,c.InvocationMethod);b=new bh;b.rd=a;return b}static rrl(a,b){a=new aE.a(b,3);b=new bh;b.rd=a;return b}static Yuk(a,b,c){a=new bh;BQ.a.Mng(c.CommandLocation)||26===c.CommandLocation||(a.rd=!1);return a}static ALe(){const a=new bh;a.rd=new E.DictionaryPropertySet;a.aX=!0;return a}static rLi(){const a=new bh;a.rd=new E.DictionaryPropertySet;
return a}static tti(){const a=new bh;a.rd=ki.b;return a}static wMc(){const a=new Sk;a.rd=new E.DictionaryPropertySet;return a}static D1k(a,b=null){a=new Sk;a.rd=b;return a}static nvb(){const a=new bh;a.rd=new T(2);a.Wq=!0;return a}static Sjd(){const a=new Sk;a.Vm=D.a.yxa;return a}static Jxa(){const a=new Sk;a.Vm=D.a.qIb;return a}static W2d(a,b){const c=new bh;c.Wq=!0;var h=b.CommandValueId?b.CommandValueId:b.Value;c.rd=h;if(lf.Font.uUa()){const y=new $s;var m=b.MenuItemId;m&&(y.Noa=lf.Font.Vkj(m));
(m=Object(ua.a)(CQ.a,b[Xn.Formatting]))&&(m.isBold||m.isItalic)&&(y.bold=m.isBold?1:0,y.italic=m.isItalic?1:0);y.fontName=h;c.rd=y}sg.K0j(b);(a=u.AFrameworkApplication.fa.ka("FontPreviewEnabled")&&(a===D.a.A5||a===D.a.jKa))&&(b[en.a.Rfa]=!1);c.rd=sg.YVd(c.rd,b);a||(ka.FontUtils.nFc(h),h=b[Xn.RequestUpdateMru],void 0!==h&&null!==h&&appChrome.api.dispatch(appChrome.actions.addFontToMru(b.SourceControlId,h)));return c}static K0j(a){void 0!==a[Wn.a.IsFreeForm]&&null!==a[Wn.a.IsFreeForm]&&a[Wn.a.IsFreeForm]?
ba.ULS.sendTraceTag(51390360,324,50,"Font applied is not a valid menu item"):void 0!==a.MenuItemId&&null!==a.MenuItemId&&ba.ULS.sendTraceTag(51390361,324,50,String.format("Font applied is in MenuItemID:{0}",a.MenuItemId))}static EEf(a,b){a=new bh;b=b.Color?b.Color:null;if(!b||6!==b.length)return null;a.rd=sg.b7a(b);a.Wq=!0;return a}static b7a(a){return 6!==a.length?null:a.substring(4,6)+a.substring(2,4)+a.substring(0,2)}static bfk(a){switch(a){case D.a.zUd:return D.a.undo;case D.a.LEf:return D.a.redo;
case D.a.KEf:return D.a.insertTable;case D.a.IEf:return D.a.Cra;case D.a.JEf:return D.a.STa;case D.a.HEf:return D.a.insertHyperlink;case D.a.FEf:return D.a.Ls;case D.a.yUd:return D.a.Q5;default:return a}}static YVd(a,b){const c=new bE.a(a);return u.AFrameworkApplication.Aa.hb.Np?new bE.a(a,b[en.a.Rfa]):c}}sg.fzh={};Object(n.a)(sg,"CuiActionBridge",null,[]);class XL{constructor(){this.JPd=this.xYb=this.rJe=this.VJe=null}}Object(n.a)(XL,"GeneralCuiUserHooks",null,[]);var EQ=d(495);class Kv{constructor(){this.XU=
this.zZa=null;this.menuItemId=0}}Object(n.a)(Kv,"QueryData",null,[]);let mf;class ud extends sg{constructor(a,b,c,h,m,y,G,U){super();this.la=a;this.pa=b;this.t3j=c;this.IDb=h;this.yc=m;this.Sb=y;this.Fb=G;this.mWa=U}initialize(){super.initialize();this.PDj();this.gEj();this.hDj();this.TDj();this.xCj();this.dEj();this.zDj();this.ACj();this.ZCj();this.ICj()}CRc(a,b=null){if(u.AFrameworkApplication.fa.ka("CuiActionBridgeBridgeFunctionEnabledInWebEditor")){const c=this.Xc.ga(a);b=c?c(a,b):new Sk;b.Egb=
a;b.Vm||(b.Vm=a);b&&this.Fb&&1===this.Fb.Sl&&!ud.she(a)&&(b.XK=!1);return b}(b=super.CRc(a))&&this.Fb&&1===this.Fb.Sl&&!ud.she(a)&&(b.XK=!1);return b}PDj(){this.la.Jib&&(this.Xc.$(M.a.ohb,Object(F.a)(this,this.Mna,"remapRumTrackerEnabledBridge")),this.Xc.$(M.a.XHb,Object(F.a)(this,this.Mna,"remapRumTrackerEnabledBridge")),this.Xc.$(H.a.zNb,Object(F.a)(this,this.Mna,"remapRumTrackerEnabledBridge")),this.Xc.$(M.a.Dqc,Object(F.a)(this,this.Mna,"remapRumTrackerEnabledBridge")),this.Xc.$(D.a.ANb,Object(F.a)(this,
this.Mna,"remapRumTrackerEnabledBridge")),this.Xc.$(H.a.Ksa,Object(F.a)(this,this.Mna,"remapRumTrackerEnabledBridge")));this.Xc.$(M.a.SKa,Object(F.a)(this,this.Mna,"remapRumTrackerEnabledBridge"));this.Xc.$(M.a.QKa,Object(F.a)(this,this.Mna,"remapRumTrackerEnabledBridge"));this.Xc.$(M.a.Xfa,Object(F.a)(this,this.Mna,"remapRumTrackerEnabledBridge"));this.Xc.$(M.a.Gya,Object(F.a)(this,this.Mna,"remapRumTrackerEnabledBridge"));this.Xc.$(M.a.vuc,Object(F.a)(this,this.Mna,"remapRumTrackerEnabledBridge"))}gEj(){this.jb.$(M.a.yIb,
Object(F.a)(this,this.DE,"remapTextQueryExecute"));this.jb.$(M.a.CIb,Object(F.a)(this,this.DE,"remapTextQueryExecute"));this.jb.$(M.a.FIb,Object(F.a)(this,this.DE,"remapTextQueryExecute"));this.jb.$(M.a.EJa,Object(F.a)(this,this.DE,"remapTextQueryExecute"));this.jb.$(M.a.FJa,Object(F.a)(this,this.DE,"remapTextQueryExecute"));this.jb.$(M.a.HJa,Object(F.a)(this,this.DE,"remapTextQueryExecute"));this.jb.$(M.a.Chb,Object(F.a)(this,this.DE,"remapTextQueryExecute"));this.jb.$(M.a.KJa,Object(F.a)(this,this.DE,
"remapTextQueryExecute"));this.jb.$(M.a.JJa,Object(F.a)(this,this.DE,"remapTextQueryExecute"));this.jb.$(M.a.IJa,Object(F.a)(this,this.DE,"remapTextQueryExecute"));this.jb.$(M.a.Ahb,Object(F.a)(this,this.DE,"remapTextQueryExecute"));this.jb.$(M.a.Bhb,Object(F.a)(this,this.DE,"remapTextQueryExecute"));this.jb.$(M.a.zIb,Object(F.a)(this,this.DE,"remapTextQueryExecute"));this.jb.$(M.a.DIb,Object(F.a)(this,this.DE,"remapTextQueryExecute"));this.jb.$(M.a.GJa,Object(F.a)(this,this.DE,"remapTextQueryExecute"));
this.jb.$(M.a.Dhb,Object(F.a)(this,this.DE,"remapTextQueryExecute"));this.jb.$(M.a.BIb,Object(F.a)(this,this.DE,"remapTextQueryExecute"));this.jb.$(M.a.AIb,Object(F.a)(this,this.DE,"remapTextQueryExecute"));this.jb.$(M.a.eMe,ud.mf);this.jb.$(M.a.EIb,Object(F.a)(this,this.DE,"remapTextQueryExecute"));this.jb.$(M.a.Axa,Object(F.a)(this,this.DE,"remapTextQueryExecute"));this.jb.$(M.a.hMe,Object(F.a)(this,this.DE,"remapTextQueryExecute"));this.jb.$(M.a.aid,Object(F.a)(this,this.DE,"remapTextQueryExecute"));
this.jb.$(M.a.xZa,Object(F.a)(this,this.DE,"remapTextQueryExecute"));this.jb.$(M.a.yZa,Object(F.a)(this,this.DE,"remapTextQueryExecute"));this.Xc.$(M.a.yIb,Object(F.a)(this,this.Bw,"remapTextQueryEnabled"));this.Xc.$(M.a.CIb,Object(F.a)(this,this.Bw,"remapTextQueryEnabled"));this.Xc.$(M.a.FIb,Object(F.a)(this,this.Bw,"remapTextQueryEnabled"));this.Xc.$(M.a.EJa,Object(F.a)(this,this.Bw,"remapTextQueryEnabled"));this.Xc.$(M.a.FJa,Object(F.a)(this,this.Bw,"remapTextQueryEnabled"));this.Xc.$(M.a.HJa,
Object(F.a)(this,this.Bw,"remapTextQueryEnabled"));this.Xc.$(M.a.Chb,Object(F.a)(this,this.Bw,"remapTextQueryEnabled"));this.Xc.$(M.a.KJa,Object(F.a)(this,this.Bw,"remapTextQueryEnabled"));this.Xc.$(M.a.JJa,Object(F.a)(this,this.Bw,"remapTextQueryEnabled"));this.Xc.$(M.a.IJa,Object(F.a)(this,this.Bw,"remapTextQueryEnabled"));this.Xc.$(M.a.Ahb,Object(F.a)(this,this.Bw,"remapTextQueryEnabled"));this.Xc.$(M.a.Bhb,Object(F.a)(this,this.Bw,"remapTextQueryEnabled"));this.Xc.$(M.a.zIb,Object(F.a)(this,this.Bw,
"remapTextQueryEnabled"));this.Xc.$(M.a.DIb,Object(F.a)(this,this.Bw,"remapTextQueryEnabled"));this.Xc.$(M.a.GJa,Object(F.a)(this,this.Bw,"remapTextQueryEnabled"));this.Xc.$(M.a.Dhb,Object(F.a)(this,this.Bw,"remapTextQueryEnabled"));this.Xc.$(M.a.BIb,Object(F.a)(this,this.Bw,"remapTextQueryEnabled"));this.Xc.$(M.a.AIb,Object(F.a)(this,this.Bw,"remapTextQueryEnabled"));this.Xc.$(M.a.EIb,Object(F.a)(this,this.Bw,"remapTextQueryEnabled"));this.Xc.$(M.a.Axa,Object(F.a)(this,this.Bw,"remapTextQueryEnabled"));
this.Xc.$(M.a.hMe,Object(F.a)(this,this.Bw,"remapTextQueryEnabled"));this.Xc.$(M.a.aid,Object(F.a)(this,this.Bw,"remapTextQueryEnabled"));this.Xc.$(M.a.xZa,Object(F.a)(this,this.Bw,"remapTextQueryEnabled"));this.Xc.$(M.a.yZa,Object(F.a)(this,this.Bw,"remapTextQueryEnabled"));this.jb.$(M.a.yHb,Object(F.a)(this,this.qt,"remapTextExecute"));this.jb.$(M.a.EHb,Object(F.a)(this,this.qt,"remapTextExecute"));this.jb.$(M.a.RHb,Object(F.a)(this,this.qt,"remapTextExecute"));this.jb.$(M.a.pxa,Object(F.a)(this,
this.V_c,"justifyExecuteBridge"));this.jb.$(M.a.rxa,Object(F.a)(this,this.V_c,"justifyExecuteBridge"));this.jb.$(M.a.txa,Object(F.a)(this,this.V_c,"justifyExecuteBridge"));this.jb.$(M.a.cZa,Object(F.a)(this,this.V_c,"justifyExecuteBridge"));this.jb.$(M.a.aZa,Object(F.a)(this,this.qt,"remapTextExecute"));this.jb.$(M.a.IHb,Object(F.a)(this,this.qt,"remapTextExecute"));this.jb.$(M.a.LHb,Object(F.a)(this,this.qt,"remapTextExecute"));this.jb.$(M.a.bZa,Object(F.a)(this,this.qt,"remapTextExecute"));this.jb.$(M.a.JHb,
Object(F.a)(this,this.qt,"remapTextExecute"));this.jb.$(M.a.MHb,Object(F.a)(this,this.qt,"remapTextExecute"));this.jb.$(M.a.fhb,Object(F.a)(this,this.qt,"remapTextExecute"));this.jb.$(M.a.chb,Object(F.a)(this,this.qt,"remapTextExecute"));this.jb.$(M.a.S0,Object(F.a)(this,this.qt,"remapTextExecute"));this.jb.$(M.a.R0,Object(F.a)(this,this.qt,"remapTextExecute"));this.jb.$(M.a.Q0,Object(F.a)(this,this.qt,"remapTextExecute"));this.jb.$(M.a.OHb,Object(F.a)(this,this.qt,"remapTextExecute"));this.jb.$(M.a.GHb,
Object(F.a)(this,this.qt,"remapTextExecute"));this.jb.$(M.a.ehb,Object(F.a)(this,this.qt,"remapTextExecute"));this.jb.$(M.a.rlc,Object(F.a)(this,this.qt,"remapTextExecute"));this.jb.$(M.a.HHb,Object(F.a)(this,this.qt,"remapTextExecute"));this.jb.$(M.a.slc,ud.hng);this.jb.$(M.a.tlc,ud.hng);this.jb.$(M.a.yna,Object(F.a)(this,this.qt,"remapTextExecute"));this.jb.$(M.a.vJa,Object(F.a)(this,this.qt,"remapTextExecute"));this.jb.$(M.a.ELb,Object(F.a)(this,this.ing,"listMarkerGalleryShapeExecuteBridge"));
this.jb.$(M.a.oLb,Object(F.a)(this,this.ing,"listMarkerGalleryShapeExecuteBridge"));this.jb.$(M.a.llc,Object(F.a)(this,this.qt,"remapTextExecute"));this.jb.$(M.a.mlc,Object(F.a)(this,this.qt,"remapTextExecute"));this.jb.$(M.a.qxa,Object(F.a)(this,this.qt,"remapTextExecute"));this.jb.$(M.a.DHb,Object(F.a)(this,this.qt,"remapTextExecute"));this.jb.$(M.a.nlc,Object(F.a)(this,this.qt,"remapTextExecute"));this.jb.$(M.a.CHb,Object(F.a)(this,this.qt,"remapTextExecute"));this.jb.$(M.a.KHb,Object(F.a)(this,
this.qt,"remapTextExecute"));this.jb.$(M.a.wlc,Object(F.a)(this,this.qt,"remapTextExecute"));this.jb.$(M.a.NHb,Object(F.a)(this,this.qt,"remapTextExecute"));this.jb.$(M.a.insertHyperlink,Object(F.a)(this,this.eRk,"remapInsertHyperlinkExecute"));this.jb.$(M.a.sxa,Object(F.a)(this,this.qt,"remapTextExecute"));this.jb.$(M.a.dhb,Object(F.a)(this,this.qt,"remapTextExecute"));this.jb.$(M.a.PHb,Object(F.a)(this,this.qt,"remapTextExecute"));this.jb.$(M.a.QHb,Object(F.a)(this,this.qt,"remapTextExecute"));
this.Xc.$(M.a.yHb,Object(F.a)(this,this.Js,"remapTextEnabled"));this.Xc.$(M.a.EHb,Object(F.a)(this,this.Js,"remapTextEnabled"));this.Xc.$(M.a.RHb,Object(F.a)(this,this.Js,"remapTextEnabled"));this.Xc.$(M.a.pxa,Object(F.a)(this,this.Js,"remapTextEnabled"));this.Xc.$(M.a.rxa,Object(F.a)(this,this.Js,"remapTextEnabled"));this.Xc.$(M.a.txa,Object(F.a)(this,this.Js,"remapTextEnabled"));this.Xc.$(M.a.cZa,Object(F.a)(this,this.Js,"remapTextEnabled"));this.Xc.$(M.a.aZa,Object(F.a)(this,this.Bw,"remapTextQueryEnabled"));
this.Xc.$(M.a.IHb,Object(F.a)(this,this.Bw,"remapTextQueryEnabled"));this.Xc.$(M.a.LHb,Object(F.a)(this,this.Bw,"remapTextQueryEnabled"));this.Xc.$(M.a.bZa,Object(F.a)(this,this.Bw,"remapTextQueryEnabled"));this.Xc.$(M.a.JHb,Object(F.a)(this,this.Bw,"remapTextQueryEnabled"));this.Xc.$(M.a.MHb,Object(F.a)(this,this.Bw,"remapTextQueryEnabled"));this.Xc.$(M.a.fhb,Object(F.a)(this,this.Js,"remapTextEnabled"));this.Xc.$(M.a.chb,Object(F.a)(this,this.Js,"remapTextEnabled"));this.Xc.$(M.a.S0,Object(F.a)(this,
this.Js,"remapTextEnabled"));this.Xc.$(M.a.R0,Object(F.a)(this,this.Js,"remapTextEnabled"));this.Xc.$(M.a.Q0,Object(F.a)(this,this.Js,"remapTextEnabled"));this.Xc.$(M.a.OHb,Object(F.a)(this,this.Js,"remapTextEnabled"));this.Xc.$(M.a.GHb,Object(F.a)(this,this.Js,"remapTextEnabled"));this.Xc.$(M.a.ehb,Object(F.a)(this,this.Js,"remapTextEnabled"));this.Xc.$(M.a.rlc,Object(F.a)(this,this.Js,"remapTextEnabled"));this.Xc.$(M.a.HHb,Object(F.a)(this,this.Js,"remapTextEnabled"));this.Xc.$(M.a.yna,Object(F.a)(this,
this.Js,"remapTextEnabled"));this.Xc.$(M.a.vJa,Object(F.a)(this,this.Js,"remapTextEnabled"));this.Xc.$(M.a.llc,Object(F.a)(this,this.Js,"remapTextEnabled"));this.Xc.$(M.a.mlc,Object(F.a)(this,this.Js,"remapTextEnabled"));this.Xc.$(M.a.qxa,Object(F.a)(this,this.Js,"remapTextEnabled"));this.Xc.$(M.a.DHb,Object(F.a)(this,this.Js,"remapTextEnabled"));this.Xc.$(M.a.nlc,Object(F.a)(this,this.Js,"remapTextEnabled"));this.Xc.$(M.a.CHb,Object(F.a)(this,this.Js,"remapTextEnabled"));this.Xc.$(M.a.KHb,Object(F.a)(this,
this.Js,"remapTextEnabled"));this.Xc.$(M.a.wlc,Object(F.a)(this,this.Js,"remapTextEnabled"));this.Xc.$(M.a.NHb,Object(F.a)(this,this.Js,"remapTextEnabled"));this.Xc.$(M.a.sxa,Object(F.a)(this,this.Js,"remapTextEnabled"));this.Xc.$(M.a.dhb,Object(F.a)(this,this.Js,"remapTextEnabled"));this.Xc.$(M.a.insertHyperlink,Object(F.a)(this,this.dRk,"remapInsertHyperlinkEnabled"));this.Xc.$(M.a.xZa,Object(F.a)(this,this.Js,"remapTextEnabled"));this.Xc.$(M.a.yZa,Object(F.a)(this,this.Js,"remapTextEnabled"));
this.Xc.$(M.a.PHb,Object(F.a)(this,this.Js,"remapTextEnabled"));this.Xc.$(M.a.QHb,Object(F.a)(this,this.Js,"remapTextEnabled"));this.Xc.$(M.a.xZa,Object(F.a)(this,this.Js,"remapTextEnabled"));this.Xc.$(M.a.yZa,Object(F.a)(this,this.Js,"remapTextEnabled"))}hDj(){this.jb.$(M.a.QLe,Object(F.a)(this,this.yhb,"queryInkControlToggledExecuteBridge"));this.jb.$(M.a.KLe,Object(F.a)(this,this.yhb,"queryInkControlToggledExecuteBridge"));this.jb.$(M.a.NLe,Object(F.a)(this,this.yhb,"queryInkControlToggledExecuteBridge"));
this.jb.$(M.a.LLe,Object(F.a)(this,this.yhb,"queryInkControlToggledExecuteBridge"));this.jb.$(M.a.OLe,Object(F.a)(this,this.yhb,"queryInkControlToggledExecuteBridge"));this.jb.$(M.a.PLe,Object(F.a)(this,this.yhb,"queryInkControlToggledExecuteBridge"));this.jb.$(M.a.MLe,Object(F.a)(this,this.yhb,"queryInkControlToggledExecuteBridge"))}TDj(){this.jb.$(M.a.Cmc,ud.mf);this.jb.$(M.a.Dmc,ud.mf);this.jb.$(M.a.Fmc,ud.mf);this.jb.$(M.a.kid,ud.mf);this.jb.$(M.a.jid,ud.mf);this.jb.$(M.a.lid,ud.mf);this.jb.$(M.a.nid,
ud.mf);this.jb.$(M.a.qid,ud.mf);this.jb.$(M.a.iid,ud.mf);this.jb.$(M.a.wid,ud.mf);this.jb.$(M.a.pid,ud.mf);this.jb.$(M.a.Did,ud.mf);this.jb.$(M.a.Bid,ud.mf);this.jb.$(M.a.Aid,ud.mf);this.jb.$(M.a.Ghb,ud.mf);this.jb.$(M.a.Hhb,ud.mf);this.jb.$(M.a.vZa,Object(F.a)(this,this.Qhd,"queryListMarkerQueryDataExecuteBridge"));this.jb.$(M.a.wZa,Object(F.a)(this,this.Qhd,"queryListMarkerQueryDataExecuteBridge"));this.jb.$(M.a.MIb,ud.mf);this.jb.$(M.a.LIb,ud.mf);this.jb.$(M.a.Emc,ud.mf);this.jb.$(M.a.yid,ud.mf);
this.jb.$(M.a.zid,ud.mf);this.Xc.$(M.a.vjb,ud.vy);this.Xc.$(M.a.wjb,ud.vy);this.Xc.$(M.a.mLb,ud.vy);this.Xc.$(M.a.Ijb,ud.vy);this.Xc.$(M.a.GLb,ud.vy);this.Xc.$(M.a.bVe,ud.vy);this.jb.$(M.a.vjb,Object(F.a)(this,this.XYi,"fontNameExecuteBridge"));this.jb.$(M.a.wjb,Object(F.a)(this,this.K3d,"genericFontSizeExecuteBridge"));this.jb.$(M.a.mLb,ud.vZe);this.jb.$(M.a.Ijb,ud.vZe);this.jb.$(M.a.GLb,ud.vZe);this.Xc.$(M.a.zvf,ud.V_a);this.Xc.$(M.a.Avf,ud.V_a);this.Xc.$(M.a.RGc,ud.V_a);this.Xc.$(M.a.OGc,ud.V_a);
this.Xc.$(M.a.QGc,ud.V_a);this.Xc.$(M.a.PGc,ud.V_a);this.Xc.$(M.a.IPd,ud.V_a);this.Xc.$(M.a.yPd,ud.V_a);this.jb.$(M.a.Wnd,ud.Zmg);this.jb.$(M.a.uZa,ud.Qch);this.jb.$(M.a.vid,ud.Qch);this.jb.$(M.a.una,ud.Zmg)}xCj(){this.jb.$(M.a.yj,Object(F.a)(this,this.Bxa,"queryQueryTransitionResultExecuteBridge"));this.jb.$(M.a.Fna,Object(F.a)(this,this.Bxa,"queryQueryTransitionResultExecuteBridge"));this.jb.$(M.a.Dxa,Object(F.a)(this,this.Bxa,"queryQueryTransitionResultExecuteBridge"));this.jb.$(M.a.YIb,Object(F.a)(this,
this.Bxa,"queryQueryTransitionResultExecuteBridge"));this.jb.$(M.a.Mhb,Object(F.a)(this,this.Bxa,"queryQueryTransitionResultExecuteBridge"));this.jb.$(M.a.Qid,Object(F.a)(this,this.Bxa,"queryQueryTransitionResultExecuteBridge"));this.jb.$(M.a.Cxa,ud.HU);this.jb.$(M.a.Rj,Object(F.a)(this,this.nsd,"transitionExecuteBridge"));this.jb.$(M.a.Bjb,Object(F.a)(this,this.nsd,"transitionExecuteBridge"));this.Xc.$(M.a.Rj,ud.vy);this.Xc.$(M.a.toa,ud.vy);this.Xc.$(M.a.pya,ud.vy);this.Xc.$(M.a.Kpc,ud.vy);this.Xc.$(M.a.Cjb,
ud.vy);this.jb.$(M.a.Cna,Object(F.a)(this,this.Bxa,"queryQueryTransitionResultExecuteBridge"));this.jb.$(M.a.pZa,Object(F.a)(this,this.Bxa,"queryQueryTransitionResultExecuteBridge"));this.jb.$(M.a.rZa,Object(F.a)(this,this.Bxa,"queryQueryTransitionResultExecuteBridge"));this.jb.$(M.a.Dna,Object(F.a)(this,this.Bxa,"queryQueryTransitionResultExecuteBridge"));this.jb.$(M.a.vz,Object(F.a)(this,this.nsd,"transitionExecuteBridge"));this.jb.$(M.a.OKb,Object(F.a)(this,this.nsd,"transitionExecuteBridge"));
this.Xc.$(M.a.vz,ud.vy);this.Xc.$(M.a.hya,ud.vy);this.Xc.$(M.a.OKb,ud.vy);this.Xc.$(M.a.PKb,ud.vy);this.Xc.$(M.a.C_a,ud.vy);this.jb.$(M.a.oZa,ud.HU);this.Xc.$(M.a.YSe,ud.vy);this.Xc.$(M.a.A_a,ud.vy);this.jb.$(M.a.qZa,ud.HU);this.Xc.$(M.a.ZSe,ud.vy);this.Xc.$(M.a.B_a,ud.vy);this.Xc.$(M.a.ePd,ud.vy);this.jb.$(M.a.Zlc,ud.mf);this.Xc.$(M.a.bnd,ud.vy);this.Xc.$(M.a.cnd,ud.vy);this.Xc.$(M.a.dnd,ud.vy);this.Xc.$(M.a.fnd,ud.vy)}dEj(){this.jb.$(D.a.UIb,sg.ALe);this.jb.$(M.a.iMe,sg.ALe);this.jb.$(M.a.RIb,ud.HU);
this.jb.$(M.a.SIb,ud.HU);this.jb.$(M.a.Smc,ud.HU);this.jb.$(M.a.Oid,ud.HU);this.jb.$(M.a.Pmc,ud.HU);this.jb.$(M.a.Qmc,ud.HU);this.jb.$(M.a.Rmc,ud.HU);this.jb.$(M.a.Omc,ud.HU);this.jb.$(M.a.olc,Object(F.a)(this,this.Rjd,"remapTableExecute"));this.jb.$(D.a.Y7,Object(F.a)(this,this.Rjd,"remapTableExecute"));this.jb.$(D.a.uKb,Object(F.a)(this,this.Rjd,"remapTableExecute"));this.jb.$(D.a.insertTable,Object(F.a)(this,this.Rjd,"remapTableExecute"));this.Xc.$(D.a.insertTable,Object(F.a)(this,this.wqi,"checkInsertTableRibbonEnabledBridge"));
this.Xc.$(D.a.Y7,Object(F.a)(this,this.Lsb,"checkWholeTableLockEnabledBridge"));this.Xc.$(D.a.LZ,Object(F.a)(this,this.Lsb,"checkWholeTableLockEnabledBridge"));this.Xc.$(D.a.MZ,Object(F.a)(this,this.Lsb,"checkWholeTableLockEnabledBridge"));this.Xc.$(M.a.bah,Object(F.a)(this,this.Lsb,"checkWholeTableLockEnabledBridge"));this.Xc.$(M.a.y5,Object(F.a)(this,this.Lsb,"checkWholeTableLockEnabledBridge"));this.Xc.$(M.a.xJa,Object(F.a)(this,this.Lsb,"checkWholeTableLockEnabledBridge"));this.jb.$(D.a.LZ,Object(F.a)(this,
this.eQa,"checkSelectionBeforeExecute"));this.jb.$(D.a.MZ,Object(F.a)(this,this.eQa,"checkSelectionBeforeExecute"));this.jb.$(D.a.H6a,Object(F.a)(this,this.eQa,"checkSelectionBeforeExecute"));this.jb.$(M.a.zlc,Object(F.a)(this,this.eQa,"checkSelectionBeforeExecute"));this.jb.$(M.a.ylc,Object(F.a)(this,this.eQa,"checkSelectionBeforeExecute"));this.jb.$(M.a.xlc,Object(F.a)(this,this.eQa,"checkSelectionBeforeExecute"));this.jb.$(M.a.y5,Object(F.a)(this,this.eQa,"checkSelectionBeforeExecute"));this.jb.$(M.a.xJa,
Object(F.a)(this,this.eQa,"checkSelectionBeforeExecute"));this.jb.$(M.a.JMe,ud.mf);this.jb.$(M.a.KMe,ud.mf);this.jb.$(M.a.LMe,ud.mf);this.jb.$(M.a.MMe,ud.mf);this.jb.$(M.a.NMe,ud.mf);this.jb.$(M.a.OMe,ud.mf);this.jb.$(M.a.PMe,ud.mf);this.jb.$(M.a.QMe,ud.mf);this.jb.$(M.a.RMe,ud.mf);this.jb.$(M.a.xMe,ud.mf);this.jb.$(M.a.yMe,ud.mf);this.jb.$(M.a.zMe,ud.mf);this.jb.$(M.a.AMe,ud.mf);this.jb.$(M.a.BMe,ud.mf);this.jb.$(M.a.CMe,ud.mf);this.jb.$(M.a.DMe,ud.mf);this.jb.$(M.a.EMe,ud.mf);this.jb.$(M.a.FMe,
ud.mf);this.jb.$(M.a.GMe,ud.mf);this.jb.$(M.a.HMe,ud.mf);this.jb.$(M.a.IMe,ud.mf);this.jb.$(M.a.Mid,ud.mf);this.jb.$(M.a.Lid,ud.mf);this.jb.$(M.a.Kid,ud.mf);this.jb.$(M.a.Nid,ud.mf)}zDj(){this.Xc.$(M.a.eid,ud.vy);this.jb.$(M.a.eid,ud.mf);this.Xc.$(M.a.ige,ud.cRk);this.jb.$(M.a.KEa,Object(F.a)(this,this.dgd,"parseSmartArtParametersBridge"));this.jb.$(M.a.SZb,Object(F.a)(this,this.dgd,"parseSmartArtParametersBridge"));this.jb.$(M.a.TZb,Object(F.a)(this,this.dgd,"parseSmartArtParametersBridge"));this.jb.$(M.a.LK,
Object(F.a)(this,this.dgd,"parseSmartArtParametersBridge"));this.Xc.$(M.a.Jhd,ud.vy);this.jb.$(M.a.Jhd,ud.mf);this.jb.$(M.a.Fra,Object(F.a)(this,this.vpi,"changePictureStyleExecuteBridge"));this.jb.$(M.a.Hmc,ud.mf);this.jb.$(M.a.uIb,ud.HU);this.jb.$(M.a.wIb,ud.HU);this.jb.$(M.a.vIb,ud.HU);this.jb.$(M.a.pmc,ud.HU)}ACj(){this.jb.$(M.a.Ych,sg.ALe);this.jb.$(M.a.$lc,ud.mf);this.jb.$(M.a.rmc,ud.mf);this.jb.$(M.a.nmc,ud.mf);this.jb.$(M.a.zmc,ud.mf);this.jb.$(M.a.Amc,ud.mf);this.jb.$(M.a.ymc,ud.mf);this.jb.$(M.a.Bmc,
ud.mf);this.jb.$(M.a.Jmc,ud.mf);this.jb.$(M.a.qmc,ud.mf);this.jb.$(M.a.mmc,ud.mf);this.jb.$(M.a.hmc,ud.mf);this.jb.$(M.a.vmc,ud.mf)}ZCj(){this.jb.$(M.a.Hhd,ud.mf);this.jb.$(M.a.Vhd,ud.mf);this.jb.$(M.a.tmc,Object(F.a)(this,this.Qhd,"queryListMarkerQueryDataExecuteBridge"));this.jb.$(M.a.umc,Object(F.a)(this,this.Qhd,"queryListMarkerQueryDataExecuteBridge"));this.jb.$(M.a.XIb,ud.mf);this.jb.$(M.a.WIb,ud.mf);this.jb.$(M.a.VIb,ud.mf);this.jb.$(M.a.Gid,ud.mf);this.jb.$(M.a.QHk,ud.mf);this.jb.$(M.a.rz,
ud.bid);this.jb.$(M.a.Tmc,ud.bid);this.jb.$(M.a.xid,ud.bid);this.jb.$(M.a.Nhd,ud.bid);this.jb.$(M.a.PIb,Object(F.a)(this,this.fRk,"remapRumTrackerExecuteQueryBridge"));this.jb.$(M.a.sIb,ud.mf);this.jb.$(M.a.hid,sg.cmc);this.jb.$(M.a.Uhd,ud.mf);this.jb.$(M.a.omc,ud.mf);this.jb.$(M.a.oIb,ud.mf);this.jb.$(M.a.JIb,ud.mf);this.jb.$(M.a.QIb,ud.mf);this.jb.$(M.a.YMe,sg.cmc);this.jb.$(M.a.Iid,ud.mf);this.jb.$(M.a.Hid,ud.mf);this.jb.$(M.a.rMe,ud.mf);this.jb.$(M.a.BZa,ud.mf);this.jb.$(M.a.Khb,ud.mf);this.jb.$(M.a.Lhb,
ud.mf);this.jb.$(M.a.Jhb,ud.mf);this.jb.$(M.a.Ihb,ud.mf);this.jb.$(M.a.GIb,ud.mf);this.jb.$(M.a.NIb,ud.mf);this.jb.$(M.a.HIb,ud.mf);this.jb.$(H.a.nIb,sg.cmc);this.Xc.$(M.a.WHe,ud.vy);this.jb.$(M.a.$v,ud.Tpd);this.jb.$(M.a.YBa,ud.Tpd);this.jb.$(M.a.lrb,ud.Tpd);this.jb.$(M.a.wYb,ud.Tpd);this.Xc.$(M.a.NVf,ud.xZi);this.jb.$(M.a.wc,ud.jHk);this.Xc.$(M.a.$hd,ud.vy);this.jb.$(M.a.$hd,ud.mf);this.Xc.$(M.a.YRa,Object(F.a)(this,this.Bw,"remapTextQueryEnabled"));this.jb.$(M.a.LJa,sg.cmc);this.jb.$(M.a.oMe,ud.mf);
this.jb.$(M.a.Gmc,ud.mf);this.jb.$(M.a.fMe,ud.mf);this.jb.$(M.a.gMe,ud.mf);this.jb.$(M.a.ZIb,ud.mf);this.jb.$(M.a.HLe,ud.mf);this.jb.$(D.a.Sgd,sg.W7b);this.jb.$(D.a.cut,Object(F.a)(this,this.ELc,"cutCopyPasteExecuteBridge"));this.jb.$(D.a.copy,Object(F.a)(this,this.ELc,"cutCopyPasteExecuteBridge"));this.jb.$(D.a.paste,Object(F.a)(this,this.ELc,"cutCopyPasteExecuteBridge"));this.jb.$(D.a.nxa,Object(F.a)(this,this.ELc,"cutCopyPasteExecuteBridge"));this.jb.$(D.a.openInClient,Object(F.a)(this,this.dvk,
"openInPowerPointExecuteBridge"));this.jb.$(D.a.Phd,ud.mf);this.jb.$(M.a.lmc,ud.mf);this.jb.$(M.a.Alc,Object(F.a)(this,this.zgh,"remapUndoRedoExecute"));this.jb.$(M.a.ulc,Object(F.a)(this,this.zgh,"remapUndoRedoExecute"));this.jb.$(M.a.AHb,Object(F.a)(this,this.Qjd,"remapCutCopyPasteExecute"));this.jb.$(M.a.zHb,Object(F.a)(this,this.Qjd,"remapCutCopyPasteExecute"));this.jb.$(M.a.wJa,Object(F.a)(this,this.Qjd,"remapCutCopyPasteExecute"));this.jb.$(M.a.FHb,Object(F.a)(this,this.Qjd,"remapCutCopyPasteExecute"));
this.Xc.$(M.a.Alc,Object(F.a)(this,this.ygh,"remapUndoRedoEnabled"));this.Xc.$(M.a.ulc,Object(F.a)(this,this.ygh,"remapUndoRedoEnabled"));this.Xc.$(M.a.AHb,Object(F.a)(this,this.Yhb,"remapCutCopyPasteEnabled"));this.Xc.$(M.a.zHb,Object(F.a)(this,this.Yhb,"remapCutCopyPasteEnabled"));this.Xc.$(M.a.wJa,Object(F.a)(this,this.Yhb,"remapCutCopyPasteEnabled"));this.Xc.$(M.a.FHb,Object(F.a)(this,this.Yhb,"remapCutCopyPasteEnabled"));this.Xc.$(D.a.cut,Object(F.a)(this,this.Yhb,"remapCutCopyPasteEnabled"));
this.Xc.$(D.a.paste,Object(F.a)(this,this.Yhb,"remapCutCopyPasteEnabled"));this.Xc.$(D.a.nxa,Object(F.a)(this,this.Yhb,"remapCutCopyPasteEnabled"));this.jb.$(D.a.Q5,ud.qwf);this.jb.$(D.a.Ls,ud.qwf);this.jb.$(D.a.jP,Object(F.a)(this,this.qng,"listsExecuteBridge"));this.jb.$(D.a.NR,Object(F.a)(this,this.qng,"listsExecuteBridge"));this.jb.$(M.a.Wjb,ud.agl);this.jb.$(M.a.vhb,ud.HU);this.jb.$(M.a.whb,ud.HU);this.jb.$(M.a.KIb,ud.mf);this.jb.$(M.a.pIb,ud.mf);this.jb.$(M.a.gmc,ud.mf);this.jb.$(M.a.IIb,ud.mf);
this.la.Yqb&&this.jb.$(M.a.Ylc,ud.mf)}ICj(){this.Xc.$(M.a.Qcg,Object(F.a)(this,this.R1b,"doPresentationCheckEnableRemap"));this.Xc.$(M.a.hTd,Object(F.a)(this,this.R1b,"doPresentationCheckEnableRemap"));this.Xc.$(M.a.cTd,Object(F.a)(this,this.R1b,"doPresentationCheckEnableRemap"));this.Xc.$(M.a.Scg,Object(F.a)(this,this.R1b,"doPresentationCheckEnableRemap"));this.Xc.$(M.a.Vcg,Object(F.a)(this,this.R1b,"doPresentationCheckEnableRemap"))}R1b(a){const b=new Sk;this.Fb&&1===this.Fb.Sl&&!ud.she(a)?b.XK=
!1:(b.ZF=!0,b.Vm=M.a.F7a);return b}M5i(){const a=new XL;a.xYb=ud.MBk;a.JPd=ud.NBk;a.VJe=Object(F.a)(this,this.kCk,"powerPointPreExecCommand");a.rJe=null;return a}kCk(a,b){var c=this.pa.Xd();c=1===c.length&&c[0].ud&&this.pa.bH()&&!c[0].IQ;switch(a.Vm){case D.a.font:case D.a.A5:case D.a.jKa:case D.a.bold:case D.a.setItalic:case D.a.underline:case D.a.strikethrough:case D.a.Ls:case D.a.Q5:case D.a.Kra:case D.a.DI:case D.a.UJ:case D.a.AJa:case D.a.e_a:case D.a.MD:case D.a.qz:case D.a.jP:case D.a.NR:case D.a.Iia:case D.a.Uka:case D.a.eoa:case D.a.yDa:case M.a.una:case M.a.S0:case M.a.R0:case M.a.Q0:case D.a.LCa:case D.a.ika:case D.a.Vya:case D.a.Wya:case D.a.Xya:case D.a.qLa:case D.a.rLa:case D.a.MZ:case D.a.LZ:case M.a.y5:case M.a.xJa:case M.a.R_a:case M.a.JKa:case M.a.soa:case M.a.KKa:case M.a.Wpd:case M.a.Vpd:b||
(b={}),b[li.a.TEc]=!(this.pa.JUa()||c),b[li.a.Apf]=!!this.pa.Yja()}return null}ing(a,b,c){const h=new bh;b=b.MenuItemId;h.rd=this.UBe(b,a);b&&Ba.a.J(512493027,820,50,"ListGallery Set on Shape from {0}",c.CommandLocation);return h}UBe(a,b){a=a?parseInt(a):-1;switch(b){case M.a.ELb:case D.a.jP:case M.a.tmc:case M.a.vZa:return this.IDb.X5b(a);case M.a.oLb:case D.a.NR:case M.a.umc:case M.a.wZa:return this.IDb.JTc(a);default:return 18}}XYi(a,b){a=new bh;a.rd=b.CommandValueId;return a}Qhd(a,b){const c=
new bh,h=new Kv;h.zZa=new Ph.a;h.menuItemId=this.UBe(b.MenuItemId,a);c.rd=h;c.aX=!0;return c}Bxa(a,b){a=new bh;const c={};c.queryResult=new Ph.a;const h=b.SourceControlId;c.SourceControlId=h.startsWith("Animation")?h.substring(9,h.length):h;c.MenuItemId=b.MenuItemId;a.rd=c;a.aX=!0;return a}nsd(a,b){a=new bh;const c={},h=b.SourceControlId;c.SourceControlId=h.startsWith("Animation")?h.substring(9,h.length):h;c.MenuItemId=b.MenuItemId;a.rd=c;return a}vpi(a,b){a=new bh;a.rd=parseFloat(b[b.MenuItemId?
"MenuItemId":"SourceControlId"]);return a}yhb(a){const b=new bh,c={},h=new Ph.a;switch(a){case M.a.QLe:h.Qf(this.mWa.isEnabled(Zd.FEa));break;case M.a.KLe:h.Qf(this.mWa.isEnabled(Zd.EEa));break;case M.a.NLe:h.Qf(this.mWa.isEnabled(Zd.J8));break;case M.a.LLe:h.Qf(this.mWa.isEnabled(Zd.I8));break;case M.a.OLe:h.Qf(this.mWa.isEnabled(Zd.WA));break;case M.a.PLe:h.Qf(this.mWa.isEnabled(Zd.$D));break;case M.a.MLe:h.Qf(this.mWa.isEnabled(Zd.ZD));break;case M.a.Mch:h.Qf(this.mWa.isEnabled(Zd.Lta))}c.queryResult=
h;b.rd=c;b.aX=!0;return b}qng(a,b,c){const h=new bh;h.rd=new E.DictionaryPropertySet;b=b.MenuItemId;this.bzl(h.rd,a,this.UBe(b,a));b&&Ba.a.J(512493026,820,50,"ListGallery Set in Box4 View from {0}",c.CommandLocation);return h}wqi(){return Object.assign(new Sk,{rd:new Ph.a,XK:!!this.t3j.Ba})}Lsb(){const a=new Sk,b=this.pa.Ym();if(!b)return a;this.yc.Xge(b)&&(a.ZF=!1,a.XK=!1,a.Vm=ed.ActionManager.w2b);return a}bzl(a,b,c){let h=14,m=0;0===c?(h=16,m=0):b===D.a.jP?(m=h=1,this.IDb.yXc(c)&&(b=this.IDb.eVa.ga(c),
a.setValue(kb.a.Ri,[b.hZb]),a.setValue(kb.a.font,b.Xrb))):b===D.a.NR&&(h=0,m=1,a.setValue(kb.a.iVa,1),a.setValue(X.a.autonumberBulletType,8),this.IDb.zXc(c)&&(b=this.IDb.Tcd.ga(c),a.setValue(X.a.autonumberBulletType,b.NQd),a.setValue(kb.a.Ri,[65533,b.b0g,ta.a.charCodeAt(b.h0g,0)])));a.setValue(xc.a.fE,h);a.setValue(xc.a.Mda,m)}Ksd(a){let b;if(this.tth()||this.pa.Yja()){if(({Ae:b}=ud.Esd(a,this.pa.pC())).returnValue)return{returnValue:!0,k5:b}}else if(this.Pcl()&&({Ae:b}=ud.sDh(a)).returnValue)return{returnValue:!0,
k5:b};return{returnValue:!1,k5:0}}C1e(a){let b;b=0;a===M.a.Alc?b=M.a.hZa:a===M.a.ulc&&(b=M.a.gZa);return{returnValue:!!b,k5:b}}B1e(a){let b;b=0;this.tth()?a===M.a.AHb?b=D.a.cut:a===M.a.zHb?b=D.a.copy:a===M.a.wJa?b=D.a.paste:a===M.a.FHb&&(b=D.a.nxa):(a===M.a.AHb&&(b=M.a.Ktb),a===M.a.zHb?b=M.a.l0b:a===M.a.wJa&&(b=M.a.Fkc));return{returnValue:!!b,k5:b}}GDh(a){switch(a){case D.a.Y7:return a=M.a.BHb,{returnValue:!0,Ae:a};case D.a.uKb:return a=M.a.HJe,{returnValue:!0,Ae:a};case D.a.insertTable:return a=
M.a.fah,{returnValue:!0,Ae:a}}a=ed.ActionManager.o5;return{returnValue:!1,Ae:a}}qt(a){let b=new bh;if(({result:b}=this.nyb(a)).returnValue)return b;({k5:a}=this.Ksd(a)).returnValue&&(b.ZF=!0,b.Vm=a);return b}Nsh(a){switch(a){case M.a.bZa:case M.a.JHb:case M.a.MHb:case M.a.chb:case M.a.fhb:case M.a.dhb:if(this.pa.Hka()||this.pa.xL())return Object.assign(new Sk,{ZF:!1,XK:!1});break;case M.a.BIb:case M.a.AIb:case M.a.IHb:case M.a.LHb:case M.a.aZa:if(this.pa.Hka())return Object.assign(new Sk,{ZF:!1,XK:!1});
break;case M.a.vJa:case M.a.yna:case M.a.hhd:case M.a.pxa:case M.a.rxa:case M.a.txa:case M.a.cZa:case M.a.KHb:case M.a.CHb:if(this.pa.xL())return Object.assign(new Sk,{ZF:!1,XK:!1});break;case M.a.NHb:case M.a.wlc:if(this.pa.xL()){var b=this.pa.Pa.mb;if(b)for(let c of b)if(c&&c.node&&(b=c.node.sa(jb.a.listLevel,0),a===M.a.NHb&&!b||No.a.qgg(c.node)))return Object.assign(new Sk,{ZF:!1,XK:!1})}}return null}Js(a){let b;new Sk;if(({result:b}=this.Oge(a)).returnValue)return this.Hnd(b,a);b=this.Nsh(a);
if(!b){let c;b=new Sk;({k5:c}=this.Ksd(a)).returnValue&&(b.ZF=!0,b.Vm=c)}return this.Hnd(b,a)}Mna(a,b=null){const c={};c.OriginalActionId=a;c.Properties=b;return Object.assign(new Sk,{Egb:a,Vm:M.a.mRe,rd:c})}fRk(a,b){const c={};c.OriginalActionId=a;c.Properties=b;return Object.assign(new bh,{Vm:M.a.mRe,rd:c,aX:!0})}DE(a){let b=new bh;if(({result:b}=this.nyb(a)).returnValue)return b;({k5:a}=this.Ksd(a)).returnValue?(b.ZF=!0,b.Vm=a):(b.rd=new Ph.a,b.aX=!0);return b}Bw(a){let b;new Sk;if(({result:b}=
this.Oge(a)).returnValue)return this.Hnd(b,a);b=this.Nsh(a);if(!b){let c;b=new Sk;({k5:c}=this.Ksd(a)).returnValue?(b.ZF=!0,b.Vm=c):b.rd=new Ph.a}return this.Hnd(b,a)}zgh(a){const b=new bh;({k5:a}=this.C1e(a)).returnValue&&(b.ZF=!0,b.Vm=a);return b}ygh(a){const b=new Sk;({k5:a}=this.C1e(a)).returnValue&&(b.ZF=!0,b.Vm=a);return b}dRk(){const a=new Sk;a.ZF=!0;a.Vm=M.a.BJe;return a}eRk(){const a=new bh;a.ZF=!0;a.Vm=M.a.BJe;return a}Qjd(a){let b=new bh;if(({result:b}=this.nyb(a)).returnValue)return b;
({k5:a}=this.B1e(a)).returnValue&&(b.ZF=!0,b.Vm=a);return b}Rjd(a){let b=new bh;if(({result:b}=this.nyb(a)).returnValue)return b;({Ae:a}=this.GDh(a)).returnValue&&(b.ZF=!0,b.Vm=a);return b}eQa(a,b){let c=new bh;if(({result:c}=this.nyb(a)).returnValue)return c;if(this.pa.xs())return c.ZF=!0,c.Vm=ed.ActionManager.w2b,c;c.Vm=a;c.rd=b;return c}Yhb(a){let b=new Sk;if(!this.Sb.Lj())return b.XK=!1,b;if(({result:b}=this.Oge(a)).returnValue)return b;({k5:a}=this.B1e(a)).returnValue&&(b.ZF=!0,b.Vm=a);return b}tth(){return this.pa.pC()}Pcl(){return this.pa.bH()}dgd(a,
b){const c=new bh;if(!b)throw Error.argumentNull();b=b[b.MenuItemId?"MenuItemId":"SourceControlId"].split(",");b=Object.assign(new EQ.a,{Uri:b[0],Category:b[1]});const h=b.Uri;a!==M.a.KEa&&a!==M.a.TZb||Ba.a.J(512493024,801,50,(a===M.a.KEa?"InsertSmartArt: ":"ChangeSmartArtLayout: ")+"{0}",h);c.rd=b;return c}V_c(a,b,c){return this.qt(a,b,c)}ELc(a){let b=new bh;if(({result:b}=this.nyb(a)).returnValue)return b;b.Wq=this.la.HXc||this.la.Lfg&&this.la.yKj&&v.a.to;return b}dvk(a,b,c){a=new bh;Ba.a.J(512493023,
801,50,"CuiActionBridge::OpenInPowerPointExecuteBridge - Open In PowerPoint from {0}",c.CommandLocation);return a}nyb(a){let b;b=new bh;return this.Rdg(a)?(b.ZF=!1,b.XK=!1,b.Vm=ed.ActionManager.w2b,{returnValue:!0,result:b}):{returnValue:!1,result:b}}Oge(a){let b;b=new Sk;return this.Rdg(a)?(b.ZF=!1,b.XK=!1,b.Vm=ed.ActionManager.w2b,{returnValue:!0,result:b}):{returnValue:!1,result:b}}Rdg(a){return this.LGj(a)}LGj(a){return this.la.podsTableCellLockEnabled&&this.la.podsTableRTTEnabled&&ud.jli.contains(a)?
this.pa.W8()?!0:!1:!1}Hnd(a,b){if(Rd.a("SetMappedCommandActionData")){let c=0;if(({Ae:c}=ud.Esd(b,this.pa.pC())).returnValue||({Ae:c}=ud.sDh(b)).returnValue||({k5:c}=this.C1e(b)).returnValue||({k5:c}=this.B1e(b)).returnValue||({Ae:c}=this.GDh(b)).returnValue)a.rd||(a.rd={}),a.rd.MappedCommand=c}return a}static she(a){const b=ud.Nij();let c=!1;for(const h of b)if(h===a){c=!0;break}return c}static Nij(){ud.Qgc||(ud.Qgc=[M.a.Alc,M.a.ulc,M.a.wJa,M.a.gJa,M.a.hJa,M.a.zHb,M.a.deleteObject,M.a.k_d,M.a.F7a,
M.a.Xma,M.a.l7b,M.a.a2e,M.a.gQ,M.a.print,M.a.BEk,M.a.sKe,M.a.uKe,M.a.vlc,M.a.FJe,M.a.GJe,M.a.downloadACopy,M.a.X1b,M.a.Y1b,M.a.Z1b,M.a.$v,M.a.Shd,M.a.YBa,M.a.cod,M.a.bod,M.a.xHe,M.a.wHb,M.a.YIb,M.a.Cxa,M.a.Mhb,M.a.yj,M.a.Fna,M.a.Rj,M.a.Bjb,M.a.Kpc,M.a.Cjb,M.a.toa,M.a.AMb,M.a.Gya,M.a.HLa,M.a.BZa,M.a.phb,M.a.eZa,M.a.Klc,M.a.HIb,M.a.fZa,M.a.GIb,M.a.NIb,M.a.Jid,M.a.$gb,M.a.ahb,M.a.ENb,M.a.Khb,M.a.FNb,M.a.Lhb,M.a.DNb,M.a.Jhb,M.a.CNb,M.a.Ihb,M.a.BNb,M.a.JIb,M.a.Afa,M.a.pnc,M.a.ZIb,M.a.B3e,M.a.Xbe,H.a.E7,
H.a.Ghd,M.a.openInClient,H.a.Kqc,H.a.PGb,H.a.bIb,H.a.iMb,H.a.jMb,M.a.QKa,M.a.Xfa,M.a.Afd,M.a.sIb,M.a.Arc,M.a.Brc,D.a.Sgd,M.a.JAk,M.a.m5,M.a.NVf,M.a.gQ,M.a.qI,M.a.rkd,M.a.VOe,M.a.hDe,M.a.gDe,M.a.g3e,M.a.I5a,M.a.immersiveReader,D.a.copy,D.a.paste,M.a.Ktb,M.a.l0b,M.a.Fkc,M.a.hZa,M.a.gZa,M.a.Fod,H.a.Ksa,H.a.renameFile,H.a.KJc,H.a.WWe,M.a.ohb,M.a.jKe,M.a.Rkc,M.a.Llc,M.a.qnc,M.a.wrc]);ud.Qgc.push(M.a.Dpc);if(u.AFrameworkApplication.fa.ka("ReactNewSlideLayoutEnabled")){const a=[M.a.vHb,M.a.Thd,M.a.UWc];
let b;(b=ud.Qgc).push.apply(b,a)}return ud.Qgc}static NBk(a,b){const c=a.Egb;let h=!0,m=null;if(null===a||null===a.rd)return!1;a=a.rd;null!==a.queryResult&&(m=a.queryResult);if(null!==m&&null!==m.uaa)switch(c){case M.a.Cxa:case M.a.RIb:case M.a.SIb:case M.a.Smc:case M.a.Oid:case M.a.Pmc:case M.a.Qmc:case M.a.Rmc:case M.a.Omc:case M.a.uIb:case M.a.wIb:case M.a.vIb:case M.a.pmc:case M.a.vhb:case M.a.whb:case M.a.oZa:case M.a.qZa:a=parseFloat(m.uaa);0<a||c===M.a.Cxa||c===M.a.uIb||c===M.a.wIb||c===M.a.vIb||
c===M.a.pmc||c===M.a.vhb||c===M.a.whb||c===M.a.oZa||c===M.a.qZa||0<=a&&(c===M.a.Pmc||c===M.a.Qmc||c===M.a.Rmc||c===M.a.Omc)?(b[Pm.Text]=m.uaa,b[Pm.Number]=a):(b[Pm.Text]="",b[Pm.Number]=Number.NaN);b[Pm.UnitType]=c===M.a.Cxa||c===M.a.oZa||c===M.a.qZa?8:3;break;default:h=!1}return h}static MBk(a,b){if(sg.xYb(a,b))return!0;if(!a||!a.rd)return!1;var c=null;Object(za.a)(Ph.a,a.rd)?c=a.rd:Object(za.a)(Kv,a.rd)?(c=a.rd,b.SourceControlId=c.XU,c=c.zZa):Object(za.a)(Object,a.rd)&&(a=a.rd,a.queryResult&&(c=
a.queryResult));c&&(b[Zh.a.On]=c.Urd?c.Urd.value:!1,c.BJc&&(b[Wn.a.IsFreeForm]=c.BJc.value),c.zDa&&(b[am.a.InnerHTML]=c.zDa),c.wvb&&(b[am.a.Alt]=c.wvb),c.hQc&&(b[am.a.On]=c.hQc.value),void 0!==c.WZ&&null!==c.WZ&&(b[Wn.a.Value]=c.WZ),void 0!==c.GHc&&null!==c.GHc&&(b[$D.a.LabelText]=c.GHc),c.l3&&(b[am.a.GalleryButtonProps]=c.l3),c.azf&&(b[$D.a.Image32by32Class]=c.azf),void 0!==c.J8a&&null!==c.J8a&&(b[bm.a.labelText]=c.J8a));return!0}static vy(){const a=new Sk;a.rd=new Ph.a;return a}static mf(){const a=
new bh;a.rd=new Ph.a;a.aX=!0;return a}static hng(a,b,c){Ba.a.J(512493021,820,50,"ListGallery Dropdown from {0}",c.CommandLocation);a=new bh;a.rd=b;return a}static vZe(a,b){a=new bh;a.rd=b.Color;return a}static qwf(a,b){a=new bh;a.rd=b.Color;a.Wq=!0;return a}static agl(){const a=new bh;a.rd={InvokeSource:0,ShowRevisionTrackingStatus:1};return a}static bid(a,b){a=new bh;const c=new Kv;c.zZa=new Ph.a;c.XU=b.SourceControlId;a.rd=c;a.aX=!0;return a}static Tpd(a,b){a=new bh;a.rd=b.SourceControlId;return a}static HU(){const a=
new bh,b={},c=new Ph.a;b.queryResult=c;a.rd=b;a.Mje=!0;return a}static V_a(a){const b=new Sk;switch(a){case M.a.zvf:b.Vm=M.a.KBa;break;case M.a.Avf:b.Vm=M.a.ria;break;case M.a.RGc:b.Vm=M.a.zPa;break;case M.a.OGc:b.Vm=M.a.T5a;break;case M.a.QGc:b.Vm=M.a.U5a;break;case M.a.PGc:b.Vm=M.a.sia;break;case M.a.IPd:b.Vm=M.a.lrb;break;case M.a.yPd:b.Vm=M.a.wYb}return b}static xZi(){const a=new Sk;a.Vm=M.a.Ssa;return a}static jHk(){const a=new bh,b={},c=new Ph.a;c.Qf(!1);b.queryResult=c;a.rd=b;a.aX=!0;return a}static Esd(a,
b){switch(a){case M.a.yHb:return a=D.a.bold,{returnValue:!0,Ae:a};case M.a.pxa:return a=D.a.Iia,{returnValue:!0,Ae:a};case M.a.aZa:return a=D.a.font,{returnValue:!0,Ae:a};case M.a.IHb:return a=D.a.A5,{returnValue:!0,Ae:a};case M.a.LHb:return a=D.a.jKa,{returnValue:!0,Ae:a};case M.a.qxa:return a=D.a.Ls,{returnValue:!0,Ae:a};case M.a.DHb:return a=D.a.Q5,{returnValue:!0,Ae:a};case M.a.nlc:return a=D.a.Kra,{returnValue:!0,Ae:a};case M.a.EHb:return a=D.a.setItalic,{returnValue:!0,Ae:a};case M.a.rxa:return a=
D.a.Uka,{returnValue:!0,Ae:a};case M.a.GHb:return a=M.a.WHe,{returnValue:!0,Ae:a};case M.a.ehb:return a=D.a.tHb,{returnValue:!0,Ae:a};case M.a.bZa:return a=D.a.ir,{returnValue:!0,Ae:a};case M.a.JHb:return a=D.a.AJa,{returnValue:!0,Ae:a};case M.a.MHb:return a=D.a.e_a,{returnValue:!0,Ae:a};case M.a.fhb:return a=D.a.UJ,{returnValue:!0,Ae:a};case M.a.chb:return a=D.a.DI,{returnValue:!0,Ae:a};case M.a.OHb:return a=D.a.strikethrough,{returnValue:!0,Ae:a};case M.a.rlc:return a=M.a.l8g,{returnValue:!0,Ae:a};
case M.a.HHb:return a=M.a.sJa,{returnValue:!0,Ae:a};case M.a.txa:return a=D.a.eoa,{returnValue:!0,Ae:a};case M.a.cZa:return a=D.a.yDa,{returnValue:!0,Ae:a};case M.a.RHb:return a=D.a.underline,{returnValue:!0,Ae:a};case M.a.KHb:return a=D.a.qz,{returnValue:!0,Ae:a};case M.a.CHb:return a=D.a.MD,{returnValue:!0,Ae:a};case M.a.NHb:return a=D.a.qz,{returnValue:!0,Ae:a};case M.a.wlc:return a=D.a.MD,{returnValue:!0,Ae:a};case M.a.yna:return a=D.a.jP,{returnValue:!0,Ae:a};case M.a.vJa:return a=D.a.NR,{returnValue:!0,
Ae:a};case M.a.sxa:return a=M.a.una,{returnValue:!0,Ae:a};case M.a.dhb:return a=M.a.mme,{returnValue:!0,Ae:a};case M.a.YRa:return a=D.a.PPc,{returnValue:!0,Ae:a};case M.a.PHb:return a=D.a.subscript,{returnValue:!0,Ae:a};case M.a.QHb:return a=D.a.superscript,{returnValue:!0,Ae:a}}return b?ud.qul(a):ud.rDh(a)}static sDh(a){switch(a){case M.a.yHb:return a=M.a.O_a,{returnValue:!0,Ae:a};case M.a.pxa:return a=M.a.FLb,{returnValue:!0,Ae:a};case M.a.aZa:return a=M.a.vjb,{returnValue:!0,Ae:a};case M.a.bZa:return a=
M.a.wjb,{returnValue:!0,Ae:a};case M.a.EHb:return a=M.a.P_a,{returnValue:!0,Ae:a};case M.a.rxa:return a=M.a.xjb,{returnValue:!0,Ae:a};case M.a.txa:return a=M.a.Kjb,{returnValue:!0,Ae:a};case M.a.cZa:return a=M.a.nLb,{returnValue:!0,Ae:a};case M.a.RHb:return a=M.a.Q_a,{returnValue:!0,Ae:a};case M.a.yna:return a=M.a.ELb,{returnValue:!0,Ae:a};case M.a.llc:return a=M.a.Xpc,{returnValue:!0,Ae:a};case M.a.mlc:return a=M.a.Aod,{returnValue:!0,Ae:a};case M.a.qxa:return a=M.a.mLb,{returnValue:!0,Ae:a};case M.a.DHb:return a=
M.a.Ijb,{returnValue:!0,Ae:a};case M.a.nlc:return a=M.a.GLb,{returnValue:!0,Ae:a};case M.a.vJa:return a=M.a.oLb,{returnValue:!0,Ae:a};case M.a.ehb:return a=M.a.bVe,{returnValue:!0,Ae:a};case M.a.fhb:return a=M.a.ILb,{returnValue:!0,Ae:a};case M.a.chb:return a=M.a.Ypc,{returnValue:!0,Ae:a};case M.a.OHb:return a=M.a.pLb,{returnValue:!0,Ae:a};case M.a.S0:return a=M.a.Znd,{returnValue:!0,Ae:a};case M.a.R0:return a=M.a.Ynd,{returnValue:!0,Ae:a};case M.a.Q0:return a=M.a.Xnd,{returnValue:!0,Ae:a};case M.a.rlc:case M.a.GHb:return ud.Esd(a,
!0);case M.a.HHb:return ud.Esd(a,!0);case M.a.sxa:return a=M.a.Wnd,{returnValue:!0,Ae:a};case M.a.dhb:return a=M.a.$Ue,{returnValue:!0,Ae:a};case M.a.PHb:return a=M.a.aqc,{returnValue:!0,Ae:a};case M.a.QHb:return a=M.a.bqc,{returnValue:!0,Ae:a}}return ud.rDh(a)}static qul(a){switch(a){case M.a.yIb:return a=D.a.amc,{returnValue:!0,Ae:a};case M.a.EJa:return a=D.a.dmc,{returnValue:!0,Ae:a};case M.a.CIb:return a=D.a.jmc,{returnValue:!0,Ae:a};case M.a.BIb:return a=H.a.E7,{returnValue:!0,Ae:a};case M.a.AIb:return a=
H.a.E7,{returnValue:!0,Ae:a};case M.a.Ahb:return a=D.a.Lhd,{returnValue:!0,Ae:a};case M.a.Bhb:return a=D.a.emc,{returnValue:!0,Ae:a};case M.a.FJa:return a=D.a.kmc,{returnValue:!0,Ae:a};case M.a.HJa:return a=D.a.wmc,{returnValue:!0,Ae:a};case M.a.Chb:return a=D.a.fmc,{returnValue:!0,Ae:a};case M.a.KJa:return a=M.a.XIb,{returnValue:!0,Ae:a};case M.a.JJa:return a=M.a.WIb,{returnValue:!0,Ae:a};case M.a.IJa:return a=M.a.VIb,{returnValue:!0,Ae:a};case M.a.FIb:return a=D.a.Umc,{returnValue:!0,Ae:a};case M.a.zIb:return a=
M.a.Hhd,{returnValue:!0,Ae:a};case M.a.DIb:return a=M.a.Vhd,{returnValue:!0,Ae:a};case M.a.GJa:return a=M.a.tmc,{returnValue:!0,Ae:a};case M.a.Dhb:return a=M.a.umc,{returnValue:!0,Ae:a};case M.a.EIb:return a=D.a.Kmc,{returnValue:!0,Ae:a};case M.a.Axa:return a=M.a.uZa,{returnValue:!0,Ae:a};case M.a.xZa:return a=D.a.Mmc,{returnValue:!0,Ae:a};case M.a.yZa:return a=D.a.Nmc,{returnValue:!0,Ae:a}}a=ed.ActionManager.o5;return{returnValue:!1,Ae:a}}static rDh(a){switch(a){case M.a.yIb:return a=M.a.Cmc,{returnValue:!0,
Ae:a};case M.a.EJa:return a=M.a.iid,{returnValue:!0,Ae:a};case M.a.CIb:return a=M.a.Dmc,{returnValue:!0,Ae:a};case M.a.Ahb:return a=M.a.lid,{returnValue:!0,Ae:a};case M.a.Bhb:return a=M.a.nid,{returnValue:!0,Ae:a};case M.a.FJa:return a=M.a.qid,{returnValue:!0,Ae:a};case M.a.HJa:return a=M.a.wid,{returnValue:!0,Ae:a};case M.a.Chb:return a=M.a.pid,{returnValue:!0,Ae:a};case M.a.KJa:return a=M.a.Did,{returnValue:!0,Ae:a};case M.a.JJa:return a=M.a.Bid,{returnValue:!0,Ae:a};case M.a.IJa:return a=M.a.Aid,
{returnValue:!0,Ae:a};case M.a.FIb:return a=M.a.Fmc,{returnValue:!0,Ae:a};case M.a.zIb:return a=M.a.Ghb,{returnValue:!0,Ae:a};case M.a.BIb:return a=M.a.kid,{returnValue:!0,Ae:a};case M.a.AIb:return a=M.a.jid,{returnValue:!0,Ae:a};case M.a.DIb:return a=M.a.Hhb,{returnValue:!0,Ae:a};case M.a.GJa:return a=M.a.vZa,{returnValue:!0,Ae:a};case M.a.Dhb:return a=M.a.wZa,{returnValue:!0,Ae:a};case M.a.EIb:return a=M.a.Emc,{returnValue:!0,Ae:a};case M.a.Axa:return a=M.a.vid,{returnValue:!0,Ae:a};case M.a.xZa:return a=
M.a.yid,{returnValue:!0,Ae:a};case M.a.yZa:return a=M.a.zid,{returnValue:!0,Ae:a}}a=ed.ActionManager.o5;return{returnValue:!1,Ae:a}}static cRk(a){const b=new Sk;switch(a){case M.a.ige:b.Vm=M.a.KEa}return b}static Zmg(a,b){a=new bh;if(!b)throw Error.argumentNull();a.rd=ud.d1f(b.MenuItemId);return a}static Qch(a,b){a=new bh;const c={},h=new Ph.a;h.Qf(!1);c.queryResult=h;c.MenuItemId=ud.d1f(b.MenuItemId);c.LineSpacingValue=-1;c.LineSpacingUnit=0;a.rd=c;a.aX=!0;a.Lje=!0;return a}static d1f(a){return parseFloat(a)}}
ud.Qgc=null;ud.jli=(mf=new Qa.a,mf.add(D.a.cut),mf.add(D.a.paste),mf.add(D.a.nxa),mf.add(D.a.Y7),mf.add(D.a.Q5),mf.add(D.a.yUd),mf.add(D.a.Kra),mf.add(D.a.A5),mf.add(D.a.jKa),mf.add(D.a.AJa),mf.add(D.a.e_a),mf.add(M.a.yIb),mf.add(M.a.CIb),mf.add(M.a.FIb),mf.add(M.a.EJa),mf.add(M.a.FJa),mf.add(M.a.HJa),mf.add(M.a.Chb),mf.add(M.a.KJa),mf.add(M.a.JJa),mf.add(M.a.IJa),mf.add(M.a.Ahb),mf.add(M.a.Bhb),mf.add(M.a.zIb),mf.add(M.a.DIb),mf.add(M.a.GJa),mf.add(M.a.Dhb),mf.add(M.a.BIb),mf.add(M.a.AIb),mf.add(M.a.EIb),
mf.add(M.a.Axa),mf.add(M.a.xZa),mf.add(M.a.yZa),mf.add(M.a.Zch),mf.add(M.a.adh),mf.add(M.a.$ch),mf.add(M.a.hMe),mf.add(M.a.aid),mf.add(M.a.yHb),mf.add(M.a.EHb),mf.add(M.a.RHb),mf.add(M.a.pxa),mf.add(M.a.rxa),mf.add(M.a.txa),mf.add(M.a.cZa),mf.add(M.a.DHb),mf.add(M.a.nlc),mf.add(M.a.aZa),mf.add(M.a.IHb),mf.add(M.a.LHb),mf.add(M.a.bZa),mf.add(M.a.JHb),mf.add(M.a.MHb),mf.add(M.a.fhb),mf.add(M.a.chb),mf.add(M.a.S0),mf.add(M.a.R0),mf.add(M.a.Q0),mf.add(M.a.OHb),mf.add(M.a.GHb),mf.add(M.a.ehb),mf.add(M.a.rlc),
mf.add(M.a.HHb),mf.add(M.a.slc),mf.add(M.a.tlc),mf.add(M.a.yna),mf.add(M.a.vJa),mf.add(M.a.ELb),mf.add(M.a.Ijb),mf.add(M.a.GLb),mf.add(M.a.oLb),mf.add(M.a.llc),mf.add(M.a.mlc),mf.add(M.a.qxa),mf.add(M.a.CHb),mf.add(M.a.KHb),mf.add(M.a.insertHyperlink),mf.add(M.a.sxa),mf.add(M.a.dhb),mf.add(M.a.PHb),mf.add(M.a.QHb),mf.add(M.a.AHb),mf.add(M.a.wJa),mf.add(M.a.FHb),mf.add(M.a.BHb),mf.add(M.a.bhd),mf.add(M.a.olc),mf.add(M.a.zlc),mf.add(M.a.ylc),mf.add(M.a.xlc),mf);Object(n.a)(ud,"CuiActionBridge",sg,[]);
class dE{constructor(){this.K=null}get name(){return"PowerPointWebEditor.UI"}$b(a){this.K=a;this.K.register(196,"Box4.ISelectionContextMenuProvider").ma().oa(()=>new xq);let b=this.K.resolve("PowerPointWebEditor.IApplicationSettings").dzb;v.a.Uj&&(b=b&&!this.K.resolve("PowerPointWebEditor.Ribbon.IPPTChromeExtensionHelper").tya);this.K.register(Sz,"PowerPointWebEditor.EditSurfaceContextMenu").as("Box4.UI.AEditSurfaceContextMenu").ma().oa(()=>new Sz(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Box4.Proofing.IErrorRangeEditor"),
this.K.resolve("Box4.UI.IProofingContextMenuSectionFactory"),this.K.resolve("PowerPointWebEditor.IContextMenuHelper"),this.K.resolve("Box4.IContextSetEditor"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("Common.App.UI.IPresenceContextMenuSectionBuilder"),this.K.Ja("PowerpointPresence.IPresenceManager"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),b));a.register(197,"PowerPointWebEditor.ICUIManager").ma().oa(()=>new VL(a.resolve("PowerPoint.IPathManager"),
a.resolve("PowerPointWebEditor.IStatusBarUser"),a.resolve("PowerPointWebEditor.IRibbonUser"),a.resolve("PowerPointWebEditor.IContextMenuUser"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("Common.ITaskManager"),a.resolve("PowerPointWebEditor.CuiActionBridge"),a.resolve("PowerPointWebEditor.View.IViewEventSource"),a.resolve("Common.IActionManagerExtended"),a.resolve("Common.IRibbonExternal")));a.register(ud,"PowerPointWebEditor.CuiActionBridge").as("Box4.UI.CuiActionBridge").ma().oa(()=>
new ud(a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.IPptListMarkersLoader"),a.resolve("PowerPointWebEditor.Graph.ITableReader"),a.resolve("PowerPointWebEditor.IPresentationReader"),a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IInkRibbonManager")));this.K.register(198,"PowerPointWebEditor.IStatusBarUserHelper").ma().oa(()=>
new TL(a.resolve("PowerPointWebEditor.IApplicationSettings")));a.register(199,"PowerPointWebEditor.IStatusBarUser").ma().oa(()=>new XD(a.resolve("PowerPointWebEditor.IStatusBarPane").xa,a.resolve("Box4.Graph.IGraphInstance").Ad(7),a.rb("PowerPointWebEditor.Core.IBundleMetricRecorder"),this.K.resolve("PowerPointWebEditor.IPPTRumTracker"),a.resolve("Common.IExternalUICommandDefinitionMapping"),a.resolve("PowerPointWebEditor.IStatusBarUserHelper"),a.resolve("Common.IAppSettingsManager")));a.register(ax,
"CommandUI.ReactRibbonRoot").ma().oa(()=>new ax(Qr.instance,a.resolve("Common.IExternalUICommandDefinitionMapping"),a.resolve("Box4.IGeneralCuiUser")));a.register(200,"PowerPointWebEditor.IContextMenuUser").ma().oa(()=>new QL(a.resolve("Box4.IContextMenuController"),Object(ua.a)(Sz,a.resolve("Box4.UI.AEditSurfaceContextMenu"))));a.register(201,"Box4.IBox4BridgeCommandUi").ma().oa(()=>new UL(a.resolve("Box4.IGeneralCuiUser"),a.resolve("PowerPointWebEditor.IRibbonUser"),a.resolve("Common.IActionManager"),
a.resolve("Common.IRibbonExternal")));this.K.register(202,"PowerPointWebEditor.IContextMenuHelper").ma().oa(()=>new PL(a.resolve("PowerPointWebEditor.IApplicationSettings")));this.K.register(WD,"Box4.UI.EditorServiceProofingContextMenuCreator").ma().oa(()=>new WD(a.resolve("Box4.UI.IProofingRepeatedWordSectionBuilder"),a.resolve("Box4.Proofing.IProofingFeatureConfiguration"),a.rb("Box4.Proofing.IIgnoreAllKeywords"),"pegal",a.resolve("PowerPoint.IPathManager").pk("pegal.png"),!1,a.resolve("Box4.IFormattingReader")))}init(){this.K.resolve("PowerPointWebEditor.ActionCommandsRumTrackerReporter");
this.K.resolve("PowerPointWebEditor.CuiActionBridge").initialize();this.K.resolve("PowerPointWebEditor.ICUIManager").initialize();this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame").ehi(this.K.resolve("Box4.IBox4BridgeCommandUi"))}dispose(){this.K.resolve("PowerPointWebEditor.ICUIManager").dispose();this.K.resolve("PowerPointWebEditor.IStatusBarUser").dispose();this.K.resolve("PowerPointWebEditor.IContextMenuUser").dispose()}static main(){r.a.instance.Dc(new dE)}}Object(n.a)(dE,"PPTWebEditorUIPackage",
null,[2,3]);class YL{constructor(a){this.dOh="FontPicker";this.xCd=null;this.P1=a;this.uxc=this.P1.Vhb(Pr.a.$Ua,Object(F.a)(this,this.Yub,"featureStateChangeCallback"));this.P1.isFeatureEnabled(Pr.a.$Ua,!1).then(b=>{this.xCd=b})}get isLicensed(){return this.xCd}Yub(a){this.xCd=a.isEnabled;a=appChrome.actions.updateFontPickerLicenseState(this.dOh,a.isEnabled);appChrome.api.dispatch(a)}dispose(){this.P1.rJb(Pr.a.$Ua,this.uxc)}}Object(n.a)(YL,"ModernFontPickerFeatureHelper",null,[193,106]);class Tz{constructor(a){this.AHa=
null;a?Object.getType(a)===String?this.AHa=Tz.deserialize(a):this.AHa=a:(ba.ULS.sendTraceTag(543475146,3021,10,"Failed to populate pinned fonts."),this.AHa=[]);this.KGa=!1}get isDirty(){return this.KGa}get Cgd(){return Array.clone(this.AHa)}N4h(a){Array.contains(this.AHa,a)||(Array.add(this.AHa,a),this.KGa=!0)}QRk(a){Array.contains(this.AHa,a)&&(Array.remove(this.AHa,a),this.KGa=!0)}serialize(){return JSON.stringify(this.AHa)}CXk(){this.KGa=!1}static deserialize(a){try{return JSON.parse(a)}catch(b){return ba.ULS.sendTraceTag(543475147,
3021,10,"Deserialize failed: {0}",b.toString()),[]}}}Object(n.a)(Tz,"PinnedFontStore",null,[]);class ZL{constructor(a,b,c,h){this.ia=a;this.la=c;this.vRg=b;this.zb=h;this.G4=null}initialize(){this.ia.ya(H.a.Qkc,he.a.frame,Object(F.a)(this,this.Qkc,"pinOrUnpinFont"));this.ia.ra(H.a.uVf,he.a.frame,Object(F.a)(this,this.k3g,"onFontPickerMenuClose"),96);this.vRg.R9d("getPPTPinnedFontsSettings").continueWith(Object(F.a)(this,this.hsk,"onRoamingSettingLoaded"))}JRj(a){return a.Sn?!1:a.rm?(ba.ULS.sendTraceTag(543273993,
3021,10,"Load setting failed with exception {0}",a.Zi),!1):!0}hsk(a){this.JRj(a)?this.G4=new Tz(a.result||this.W2f()):this.G4=new Tz(this.W2f());this.zch()}zch(){appChrome.api.dispatch(appChrome.actions.updatePinnedFonts("FontPicker",this.Cgd))}get Cgd(){return this.G4?this.G4.Cgd:[]}W2f(){return this.la.Ha("RecommendedFonts")}Qkc(a,b,c,h,m){if(!this.G4)return ba.ULS.sendTraceTag(543475150,3021,50,"Roaming setting is not available yet"),64;(a=m.CommandValueId)&&(m.IsPinned?this.G4.N4h(a):this.G4.QRk(a));
return 32}k3g(){if(!this.G4||!this.G4.isDirty)return 32;const a=He.a.aLc(10,Object(F.a)(this,this.updatePinnedFonts,"updatePinnedFonts"));this.zb.Eb(a);return 32}updatePinnedFonts(){this.G4&&(this.zch(),this.Rmh(),this.G4.CXk())}Rmh(){if(this.G4&&this.G4.isDirty){var a=this.G4.serialize();this.vRg.G$k(a)}}dispose(){this.Rmh();this.ia.WO(H.a.Qkc,he.a.frame,Object(F.a)(this,this.Qkc,"pinOrUnpinFont"));this.ia.WO(H.a.uVf,he.a.frame,Object(F.a)(this,this.k3g,"onFontPickerMenuClose"))}}Object(n.a)(ZL,
"FontPinningHandler",null,[194,106]);class yq{static get Nfd(){return CommonUIStrings.l_ModernFontPicker_FontInfoPaneTitle}}yq.tDa="fontInfoTaskPane";yq.WSi="modernfontpicker";Object(n.a)(yq,"FontInfoPaneConstants",null,[]);class $L{constructor(){this.type="FontInfoTaskPaneProps";this.onUpsellButtonClicked=null;this.isLicensed=!1;this.paneId=this.helpArticleUrl=this.trigger=this.fontName=null}}Object(n.a)($L,"FontInfoTaskPaneProps",null,[]);var ju=d(642);class Uz{constructor(a,b,c,h=null){this.e5a=
this.DV=this.uxc=null;this._state=this.nob=0;this.xUh=a;this.P1=b;this.YMh=c;this.Od=h}get zn(){return this.xUh.value}initialize(){this.zn.ya(H.a.gQe,he.a.frame,Object(F.a)(this,this.gQe,"requestFontInfo"));this.uxc=this.P1.Vhb(Pr.a.$Ua,Object(F.a)(this,this.Yub,"featureStateChangeCallback"));this.Gjb()}em(a=!1){const b=fj.UISurfaces.xr(),c=this.P1.isFeatureEnabled(Pr.a.$Ua,!1),h=[];h.push(b);h.push(c);Promise.all(h).then(m=>{m[0].showTaskPane(yq.tDa,this.sca(m[1]));a&&this.Sr()})}GGh(a){fj.UISurfaces.xr().then(b=>
{b.updateTaskPane(yq.tDa,this.sca(a));return null})}Yub(a){this.GGh(a.isEnabled)}gQe(a,b,c,h,m){this.DV=m.CommandValueId;this.e5a=m.Trigger;this.nob=m.InputMethod;this.em(2===this._state&&1===this.nob);return 32}sca(a){const b=new $L;b.onUpsellButtonClicked=Object(F.a)(this,this.onUpsellButtonClicked,"onUpsellButtonClicked");b.fontName=this.DV;b.isLicensed=a;b.trigger=this.e5a;b.helpArticleUrl=this.Uxi();b.paneId=yq.tDa;a=this.eCj();a.contentProps=b;return a}eCj(){return Object.assign(new ju.a,{title:yq.Nfd,
hideHeader:!1,width:320,location:2,isModernPane:!0,enableResize:!0,minResizeWidth:320,maxResizeWidth:920,onOpen:Object(F.a)(this,this.onOpen,"onOpen"),onClose:Object(F.a)(this,this.onClose,"onClose"),onShow:Object(F.a)(this,this.onShow,"onShow"),onHide:Object(F.a)(this,this.onHide,"onHide")})}Gjb(){if(this.Od){var a=this.Od.Gc(yq.tDa);a.parent=A.AFrame.nj;a.zL=!0}}onOpen(){this._state=2;this.Sr()}onShow(a){0!==this._state&&(this._state=2,1===a&&(this.nob=a),this.Sr())}onClose(){this.nob=this._state=
0;this.blur()}onHide(){this._state=1;this.nob=0}Sr(){this.Od&&1===this.nob&&this.Od.xf(yq.tDa)}blur(){this.Od&&this.Od.Be&&this.Od.Be.name===yq.tDa&&this.Od.xf(this.Od.X7)}onUpsellButtonClicked(){this.P1.launchUpsellExperience(yq.WSi)}dispose(){this.P1.rJb(Pr.a.$Ua,this.uxc)}Uxi(){return String.format("{0}&EntryPoint=True&IsFontPane=True&HelpId={1}&ShowNav=False&NS={2}&uilcid={3}",this.YMh,this.x9i(),"PPWAENDUSER",u.AFrameworkApplication.lcid)}x9i(){switch(this.e5a){case "missing":return"hlpFontInfoMissingFont";
case "embedded":return"hlpFontInfoEmbeddedFont";case "compatible":return"hlpFontInfoCompatibilityFont";case "theme":return"hlpFontInfoThemeFont"}return Uz.Kii(this.DV)}static Kii(a){let b="hlpFontInfo";for(let c=0;c<a.length;++c){const h=ta.a.charAt(a,c);if(255<a.charCodeAt(c)||ta.a.beg(h))b+=h}return b}}Object(n.a)(Uz,"FontInfoPane",null,[195,106]);class aM extends Uz{constructor(a,b,c,h){super(a,b,c.Ha("FontInfoHelpBaseUrl"),h)}Yub(a){this.GGh(a.isEnabled)}}Object(n.a)(aM,"PPTFontInfoPane",Uz,[]);
class eE{constructor(){this.C7c=this.Rcc=this.Scc=this.K=null}get name(){return"PowerPointWebEditor.ModernFontPicker"}$b(a){this.K=a;this.K.register(193,"Common.ModernFontPicker.IModernFontPickerFeatureHelper").ma().oa(()=>new YL(this.K.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper")));this.K.register(194,"Box4.IFontPinningStore").ma().oa(()=>new ZL(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Box4.IRoamingServiceRequestManager"),this.K.resolve("Common.IAppSettingsManager"),
this.K.resolve("Common.ITaskManager")));this.K.register(195,"Common.ModernFontPicker.IFontInfoPane").ma().oa(()=>new aM(new sb.a(()=>u.AFrameworkApplication.Ta),this.K.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),this.K.resolve("Common.IAppSettingsManager"),this.K.resolve("Common.IFocusManager")))}init(){const a=this.K.resolve("Common.IAppSettingsManager");a.jf(()=>{this.K.Ja("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(b=>{a.ka("PPTOModernFontPickerIsEnabled")&&
(this.C7c=this.K.resolve("Common.ModernFontPicker.IModernFontPickerFeatureHelper"),this.Rcc=this.K.resolve("Common.ModernFontPicker.IFontInfoPane"),this.Rcc.initialize(),b.isFeatureEnabled(Pr.a.$Ua,!1).then(c=>{!u.AFrameworkApplication.fa.ka("IsAnonymousUser")&&c&&(this.Scc=this.K.resolve("Box4.IFontPinningStore"),this.Scc.initialize())}),Fc.App.Kb.updateCommandUI())})})}dispose(){this.Rcc&&(this.Rcc.dispose(),this.Rcc=null);this.Scc&&(this.Scc.dispose(),this.Scc=null);this.C7c&&(this.C7c.dispose(),
this.C7c=null)}static main(){r.a.instance.Dc(new eE)}}Object(n.a)(eE,"PPTModernFontPickerPackage",null,[2,3]);var fE=d(1064);class bM{constructor(a){this.q$=a;this.afb=this.q$.nFb("UserAction","ImageProcessor");this.j4j=67}xng(a,b){if(b)if(a&&this.NUj){let c=new Image;c.onload=()=>{b(c);URL.revokeObjectURL(c.src);c=null};(a=URL.createObjectURL(a))?c.src=a:b(null)}else b(null)}Jvh(a,b,c){c-=this.j4j;if(0>=c||!a)return null;let h=a.width,m=a.height;if(0>=h||0>=m)return null;let y=null,G=1,U=0;try{const ja=
Math.ceil(1.37*b);if(c<=ja){const va=Math.sqrt(c/(1.3*ja));h=Math.floor(a.width*va);m=Math.floor(a.height*va)}if(y=this.zNf(a,h,m))if(U=y.length,y.length>=c){const va=this.s4f(a.width,a.height);va*Math.floor(a.width)*va*Math.floor(a.height)>=h*m?y=null:(G++,(y=this.Nhl(a))&&y.length>=c&&(y=null))}}catch(ja){y=null,ba.ULS.sendTraceTag(20841025,826,15,"ShrinkImageBySize failed. Error message: "+ja.message+", Call stack: "+ja.stack)}a=String.format("ShrinkImageBySize: BlobSize={0},numTry={1},Base64AfterFirstShrink={2},FinalBase64Length={3}",
b,G,U,y?y.length:0);ba.ULS.sendTraceTag(20841026,826,50,a);return y}Nhl(a){let b=null;if(a){let c=a.width,h=a.height;const m=this.s4f(c,h);c=Math.floor(c*m);h=Math.floor(h*m);try{b=this.zNf(a,c,h)}catch(y){ba.ULS.sendTraceTag(20841027,826,15,"ShrinkHTML5ImageByResolution failed. Error message: "+y.message+", Call stack: "+y.stack)}}return b}zNf(a,b,c){if(0>=b||0>=c)return null;let h;this.afb.start();var m=document.createElement("canvas");m.width=b;m.height=c;var y=m.getContext("2d");h=this.afb.Rq;
y.drawImage(a,0,0,b,c);y=this.afb.Rq-h;m=m.toDataURL("image/png");a=String.format("DoShrink: Before={0}x{1},After={2}x{3},CreateCanvas={4}ms,DrawImage={5}ms,ToDataURL={6}ms",a.width,a.height,b,c,h,y,this.afb.Rq-(h+y));ba.ULS.sendTraceTag(20841028,813,50,a);return m}s4f(a,b){return 0>=a||0>=b?0:1280<a||1280<b?Math.min(1280/a,1280/b):1}get NUj(){return!!this.URL&&!!this.URL.createObjectURL&&!!this.URL.revokeObjectURL}get URL(){return window.URL||window.webkitURL}}Object(n.a)(bM,"ImageProcessor",null,
[331]);class gE{constructor(a,b,c,h,m){this.Ca=a;this.iNh=b;this.hNh=c;this.x6e=h;this.jXh=m}get zn(){return this.Ca}gii(a){this.zn.vhd(a,this.iNh,null,null)}eii(a){this.zn.vhd(a,this.hNh,null,null)}Cra(a,b,c){c?this.zn.vhd(a,this.x6e,b,null):this.zn.La(this.x6e,2,b)}g9g(a,b=!1){const c=new E.DictionaryPropertySet;c.setValue(xc.a.FU,a);c.setValue(xc.a.pgd,!0);c.setValue(xc.a.gab,b);this.zn.La(this.jXh,2,c)}}Object(n.a)(gE,"ClipboardCommands",null,[301]);class hE{N2b(){}}Object(n.a)(hE,"NoOpEdgeSystemClipboardSelectionEnsureStrategy",
null,[480]);class zq{constructor(a,b,c,h,m,y){this.wD=a;this.Zg=b;this.Zu=c;this.Hm=h;this.$o=m;this.fd=y}UEj(a,b){a=b.view;b=b.xE;if(!b||J.a.instance.ga(14)&&!this.wD.Rfg(b,!0)||this.Hm&&this.Hm.instance&&this.Hm.instance.UW(b))return 2;var c=zq.YU?!zq.Rt.Fka(b):!0;this.Zu&&c&&this.Zu.gtc(b.node,z.a.tq,b.Qa);this.Zg.qWc(b,m=>new wv.a(m,wv.a.OLc),Vb.AParagraphNode.f_);if(this.fd.hg&&this.fd.Ny){c=new t.GraphTransaction(15);try{c.kd(b.node)}finally{c&&c.dispose()}}var h=b.node;c=b.Nb+1;" "===Ob.ParagraphReader.text(h).charAt(c)&&
(h=md.a.createTextRange(h,c,c+1),this.Zg.replaceTextRange(h,"\u00a0"));b=md.a.Kj(b.node,c);a.Lb.setSelection(yd.SelectionFactory.wu(b));return 32}static get Rt(){return zq.uD||(zq.uD=vb.a.instance.resolve("Box4.IHyperlinkStrategy"))}static get YU(){null==zq.hI&&(zq.hI=u.AFrameworkApplication.fa?u.AFrameworkApplication.fa.ka("SplitHyperlinkFixWithEnterIsEnabled"):!1);return zq.hI}}zq.uD=null;zq.hI=null;Object(n.a)(zq,"InsertLineBreakStrategy",null,[]);class Bn{static get Ph(){return Bn.Di||(Bn.Di=
vb.a.instance.resolve("Box4.IOutlineElementEditor"))}static get jm(){return tg.ContextSetEditor.instance}static get p6(){return Bn.$o||(Bn.$o=vb.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}static get Tf(){return Bn.fd||(Bn.fd=vb.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static bFj(a,b,c,h,m){if(m&&m.Sa(xc.a.targetObject)){var y=b.view.yg.Fh.ye(m.eb(xc.a.targetObject));y=md.a.create(y)}else y=Bn.jm.F2(b.xE,11);if(!y)return 8;a=u.AFrameworkApplication.Ta.mi(y,
a,c,!0,h,m);if(32===a&&2===c){if(!b.view.Mh)return 2;b=b.view;h=b.Lb.Qj;if(h=Bn.jm.F2(h,11)){c=new fn.a;c.set(h.node);c.gf();if(m&&m.Sa(xc.a.targetObject))for(m=m.Lh(xc.a.targetObject);!c.currentNode.id.equals(m)&&c.zc()&&(mc.OutlineElementNavigator.Oe(c),11===c.ri););mc.OutlineElementNavigator.Hwa(c,!1,!1);m=Bb.SelectionEditor.xja(c,!0);m=Ob.ParagraphReader.hs(m)?yd.SelectionFactory.Qg(m,0):yd.SelectionFactory.wl(m);b.Lb.setSelection(m)}}return a}static mde(a,b,c,h,m){a=a===D.a.d8b;b=b.node;if(m&&
m.Sa(xc.a.targetObject)&&!b.id.equals(m.Lh(xc.a.targetObject)))return 2;if(1===c)return 32;c=new rb.GraphIterator;c.set(b);c.rc(10);Bn.Ph.pda(c,a,!0);Bn.Tf.hg&&Bn.Tf.Ny&&mc.OutlineElementNavigator.wi(c);return 32}}Bn.Di=null;Bn.$o=null;Bn.fd=null;Object(n.a)(Bn,"InsertOutlineElementStrategy",null,[]);var FQ=d(412);class Vz{constructor(a,b,c,h,m,y,G,U){this.Zu=b;this.bQh=a;this.Bt=m;this.Xo=h;this.Di=c;this.wD=y;this.Tc=G;this.x4a=U}fjk(a,b,c,h,m){if(!b.view.Mh)return 2;b=b.view;let y=null;b.np&&(y=
b);const G=b.Lb.Qj;let U=!0,ja=!1,va=null;if(!G)return 2;const Ta=new t.GraphTransaction(15);Ta.kd(b.yg);let fb=null;2===c&&(fb=new fn.a,fb.set(G.node),fb.gf(),va=new lx(fb),2===Fc.App.mode&&Bb.SelectionEditor.Sg(G)&&(fb.AB(11)&&Wb.ListReader.tk(fb)&&Kd.OutlineElementReader.isEmpty(fb,!1)&&(U=!1),U&&Fc.App.Ih.lw&&Kd.OutlineElementReader.rC(fb,G,!1)&&!Kd.OutlineElementReader.rC(fb,G,!0)&&(U=!1)),mc.OutlineElementNavigator.Oe(fb),Kd.OutlineElementReader.isEmpty(fb,!1)&&(FQ.a.rPj(fb)&&(U=!1),1===Fc.App.mode&&
Wb.ListReader.tk(fb)&&(ja=!0)));a=u.AFrameworkApplication.Ta.mi(G,a,c,!1,h,m);U&&32===a&&2===c&&(ja||mc.OutlineElementNavigator.CIa(fb,!1,!Bb.SelectionEditor.Sg(G),!1),ja&&va&&va.restore(fb),J.a.instance.ga(101)&&this.Bt.freeze(),b.Lb.setSelection(yd.SelectionFactory.sj(fb.currentNode,!0)),J.a.instance.ga(101)&&this.Bt.H_e(),this.bQh.In.kw());y&&(U||y.aya());Hh.GrippersManager.instance.j1a(1);Ta.dispose();return a}rB(a,b,c){a=!1;if(aa.ImageReader.dFa(b)||aa.ImageReader.pyb(b))b=this.ozi(b),a=!0;const h=
b;b=Bb.SelectionEditor.Sg(b);if(1===c)return 32;const m=h.node,y=new rb.GraphIterator;y.set(m);y.gf();mc.OutlineElementNavigator.Oe(y);c=new t.GraphTransaction(15);c.yy(y);b?(b=!0,J.a.instance.ga(101)&&Ob.ParagraphReader.Yd(m)&&h.Qa===Ob.ParagraphReader.textLength(m)&&Ud.n(h)&&9===Ob.ParagraphReader.ISc(m)&&this.Bt.dAi(h),1===Fc.App.mode&&Kd.OutlineElementReader.isEmpty(y,!1)&&Wb.ListReader.tk(y)&&(b=!1),this.Xo.Tph(y,b,h,m),this.Zu&&this.Zu.gtc(m,z.a.tq,h.Qa),a&&(mc.OutlineElementNavigator.yJ(y,
!1,!1),a=y.Bb(2),(a=this.x4a.Qg(a,0))&&this.Tc.setSelection(a))):this.Di.pda(y,!0,!0);c.dispose();Fc.App.Kb&&Fc.App.Kb.updateCommandUI();return 32}ozi(a){if(aa.ImageReader.dFa(a))var b=md.a.Kj(a.node,a.Qa);else b=Ob.ParagraphReader.lCa(a.node),a=Vz.A5i(a.node.properties.eb(jb.a.runId),b.properties.Lh(jb.a.CY),b.Ra),b=md.a.Kj(b,a);return b}static WWi(a,b){let c=0;for(;c<b.length&&!(a<b[c]);)c++;return c}static A5i(a,b,c){let h=0;a=Vz.WWi(a,b);let m=0;if(a===b.length)m=c.length-1;else for(;m<c.length;){b=
c.ga(m);if(b.formatting&&b.formatting.ng===a)break;m++}m<c.length&&(h=c.ga(m).cp);return h}}Object(n.a)(Vz,"NewLineStrategy",null,[]);class ku{constructor(a,b,c,h,m,y,G,U,ja,va,Ta,fb,Db){this.Us=null;this.CZ=a;this.mxc=y;this.wAc=new Vz(this,b,c,h,m,G,va,Ta);this.acf=new zq(G,U,b,ja,fb,Db)}get In(){return this.Us||(this.Us=this.CZ())}vb(){const a=u.AFrameworkApplication.Ta,b=Object(F.a)(this.wAc,this.wAc.rB,"newLine");a.ra(D.a.enter,xb.a.view,Object(F.a)(this.mxc.value,this.mxc.value.ORi,"enterView"),
1124);a.ra(D.a.Iod,xb.a.view,Object(F.a)(this.mxc.value,this.mxc.value.sbl,"shiftEnterView"),1124);a.ya(D.a.rB,xb.a.view,Object(F.a)(this.wAc,this.wAc.fjk,"newLineView"));a.ya(D.a.rB,xb.a.Of,b);a.ya(D.a.rB,xb.a.image,b);a.ya(D.a.rB,xb.a.textRange,b);a.ya(D.a.rB,xb.a.anchoredObject,b);a.ya(D.a.rB,xb.a.embeddedFile,b);a.ya(D.a.rB,xb.a.ink,b);a.ya(D.a.rB,xb.a.paragraph,b);a.ya(D.a.rB,xb.a.iFrame,b);a.ya(D.a.rB,xb.a.unsupportedObject,b);a.he(D.a.rB,1124);a.ra(D.a.b8b,xb.a.view,Object(F.a)(this.acf,this.acf.UEj,
"insertLineBreakView"),1028);a.ya(D.a.d8b,xb.a.view,Bn.bFj);a.ya(D.a.d8b,xb.a.outlineElement,Bn.mde);a.he(D.a.d8b,1092)}static get instance(){return ku.Ka||(ku.Ka=ku.iC())}static iC(){return new ku(()=>vb.a.instance.resolve("Box4.IUndoManager"),vb.a.instance.rb("Box4.IAutoCorrectScheduler"),vb.a.instance.resolve("Box4.IOutlineElementEditor"),vb.a.instance.resolve("Box4.List.IListEditor"),vb.a.instance.resolve("Box4.IInsertionPointFormatting"),vb.a.instance.re("Box4.Actors.IEnterViewStrategy"),Dc.a.instance,
vb.a.instance.resolve("Box4.ICharacterPropertiesEditor"),vb.a.instance.Ja("Box4.IExternalSelectionManager"),me.a.instance,vb.a.instance.resolve("Box4.ISelectionFactory"),vb.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,vb.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}}ku.Ka=null;Object(n.a)(ku,"EnterActor",null,[]);class cM{Myh(a){return a}jig(){return!0}}Object(n.a)(cM,"EopFormattingStrategy",null,[307]);var dM=d(150);class iE{constructor(a,
b,c,h,m,y,G,U,ja,va,Ta,fb,Db){this.mOa=this.IUb=this.Fmb=null;this.TJd=0;this.RBd=!1;this.Oa=new bd.a;this.RRb=null;this.BK=a;this.Bt=b;this.Kf=c;this.Rw=h;this.pr=m;this.Xo=y;this.Ug=G;this.Zg=U;this.wD=ja;this.hd=va;this.fd=Ta;this.$o=fb;this.TOa=Db}get SPi(){return J.a.instance.ga(105)?this.hd?this.hd.isFeatureEnabled(55):u.AFrameworkApplication.fa.ka("Box4EndOfParagraphFormattingIsEnabled"):!1}get Nca(){return this.RRb||(this.RRb=vb.a.instance.resolve("Box4.IFormatPainterStrategy"))}get oL(){return this.RBd}set oL(a){this.RBd!==
a&&(this.RBd=a,this.Oa.raiseEvent("FormatPainterBrushActiveStatusChanged"))}V7h(a){this.Oa.addHandler("FormatPainterBrushActiveStatusChanged",a)}a$g(a){const b=a.Ua;ba.ULS.sendTraceTag(22832028,354,50,"Picked format from context: {0}",b.contextId);this.reset();var c=b.node;a=this.Rhg(a);if(this.Nca.Bth(b.contextId,a))try{this.mOa=this.pr.nta(c)}catch(h){throw ba.ULS.sendTraceTag(22832029,354,10,"GetParagraphProperties error: {0}",h.message),h;}this.IUb=Ya.StyleReader.XD(c);c=uc.a.ps(b);c.Pz&&(this.Fmb=
Object(ua.a)(jq.a,c.Pz.clone()));this.TJd=a?xb.a.paragraph:b.contextId;this.Nca.stf(b.node,this.mOa,this.Fmb)}qvf(a){const b=J.a.instance.ga(14),c=this.Rhg(a);for(let U=0;U<a.length;U++){var h=a.ga(U);if(h.el){var m=void 0;if(h.contextId===xb.a.Of||h.contextId===xb.a.textRange)m=b&&this.wD.hua(h);else if(h.contextId===xb.a.paragraph)m=b&&this.wD.pZc(h);else if(h.contextId===xb.a.endOfParagraph)m=b&&this.wD.mYc(h);else{ba.ULS.sendTraceTag(22832033,354,50,"Skipped applying format to context: {0}",h.contextId);
continue}ba.ULS.sendTraceTag(22832034,354,50,"Applied format to context: {0}",h.contextId);if(m)ba.ULS.sendTraceTag(22832035,354,50,"Tried format painting to locked context. Skipped.");else{m=Object(ua.a)(Vb.AParagraphNode,h.node);var y=!1;m&&(y=h.contextId===xb.a.textRange&&!!m&&!h.Qa&&h.Nb===this.pr.textLength(m));if(y=this.Nca.Qsh(this.TJd,h.contextId,c,y))try{Ob.ParagraphReader.Yd(m)?(this.IUb&&this.BK.paa(this.IUb,m,!0),this.Rw.uvf(m,this.mOa)):ba.ULS.sendTraceTag(22832064,354,50,"Tried to apply paragraph style and properties to non-paragraph node: {0}",
h.node.type)}catch(ja){throw ba.ULS.sendTraceTag(22832065,354,10,"ApplyParagraphProperties error: {0}",ja.message),ja;}var G=h;h.contextId===xb.a.paragraph?G=md.a.createTextRange(m,0,Ob.ParagraphReader.textLength(m)):h.contextId===xb.a.Of&&(G=this.Bt.x5b(h),G=me.a.AQa(G));if(G&&G.contextId===xb.a.textRange)try{this.wdi(G,this.Fmb,y?null:this.IUb)}catch(ja){throw ba.ULS.sendTraceTag(22832066,354,10,"ApplyFormattingsToTextRange error: {0}",ja.message),ja;}if(h.contextId===xb.a.paragraph||h.contextId===
xb.a.endOfParagraph){y=new rb.GraphIterator;y.set(m);y.gf();y.Ng(11);G=Wb.ListReader.tk(y);const ja=!Ob.ParagraphReader.textLength(m);ba.ULS.sendTraceTag(22832067,354,50,"Applied format to EOP: InList - {0}, IsEmpty - {1}.",G,ja);G?(this.Ug.Sma(y),h=y.currentNode,this.Ug.zda(h)&&this.Xo.Gnd(h,m,this.Fmb)):this.SPi&&this.vdi(h,this.Fmb)}}}else ba.ULS.sendTraceTag(22832068,354,50,"Attempt to apply format to non-graph-node context: {0}",h.contextId)}}vdi(a,b){b&&(a=this.Zg.e0d(a.node),a.$d(a.Ee),this.rvf(a,
b,null))}wdi(a,b,c){if(b||c)0<Ud.h(a).length&&ba.ULS.sendTraceTag(22832071,354,50,"User tried to apply format on Blob objects"),this.TOa.JGc(a,h=>{this.rvf(h,b,c)})}rvf(a,b,c){this.Kf.$Ba(a);a.Pz&&a.Pz.removeProperty(kb.a.highlight);this.Kf.RIc(a);this.Ux(a,c);this.Ux(a,b)}Ux(a,b){if(b){var c=a.paragraph.Fh;if(c){var h=a.Pz;h=h?Object(ua.a)(dM.a,h.clone()):jq.a.jCa(1179725);for(const y of b.Tz())if(y!==jb.a.JG&&y!==jb.a.fieldInstruction&&y!==kb.a.Zs&&y!==kb.a.z_&&y!==jb.a.Z$a&&y!==kb.a.$s&&y!==jb.a.languageHint&&
y!==jb.a.noProof){if(y===Ie.a.L2){var m=b.sa(Ie.a.L2,pa.a.nil);if(m!==pa.a.nil&&(m=Object(ua.a)(jq.a,c.ye(m)),m=Ya.StyleReader.ATc(m),m===Box4Intl.Box4Strings.L_StyleWordHyperlink)){m=Ya.StyleReader.iL(a.paragraph).qjj(m);h.Ux(m);continue}}h.setValue(y,b.Lh(y))}h.Oab?b=c.UJa(h):(c.CE(h),b=h);a.nm=b.id}}}Rhg(a){return!a.lca&&a.Ye.contextId!==xb.a.endOfParagraph}reset(){this.mOa=this.IUb=this.Fmb=null;this.TJd=xb.a.none}}Object(n.a)(iE,"FormatPainter",null,[254]);class Wz{constructor(a){this.ll=this.transaction=
null;this.If=a;this.jtb=this.rq=0}}Object(n.a)(Wz,"SelectAllArguments",null,[]);class as{constructor(a,b,c,h,m){this.ZWh=a;this.vha=b;this.yk=c;this.fCd=h;this.hTb=m}get PHe(){return this.ZWh}get In(){return this.vha.value}get P1k(){return this.fCd?this.hTb?Object(F.a)(this,this.SSi,"expandSelectionOneNote"):Object(F.a)(this,this.TSi,"expandSelectionWord"):Object(F.a)(this,this.Cnh,"selectAllInOutline")}get Dnh(){return this.hTb?Object(F.a)(this,this.emd,"selectAllOutlines"):null}vb(){const a=u.AFrameworkApplication.Ta;
this.Dnh&&a.ra(D.a.emd,xb.a.view,this.Dnh,2);a.ya(D.a.saa,he.a.frame,as.yuh);a.ya(D.a.Jod,he.a.frame,as.yuh);a.ra(D.a.Bsa,xb.a.view,this.P1k,2);a.ra(D.a.Xtf,xb.a.view,A.AFrame.qe,100);a.ra(D.a.cDe,xb.a.view,as.cDe,4)}SSi(a,b,c){return this.Bsa(b,c,null)}Bsa(a,b,c){if(1===b)return 32;if(!a.view.Mh)return 2;b=a.view;if(!b.Lb)return 8;const h=b.Lb.Pa;if(!h||!h.length)return 8;Te.a.mark(5798);Fc.App.Kb.Jd.isEditingAllowed||Fc.App.Kb.Jd.Wy?a=Bb.SelectionEditor.k7d(h):(C.FocusManager.instance().bD(A.AFrame.wW),
a=yd.SelectionFactory.hSe(b.yg));if(!a)return 8;this.fCd&&!h.bsa&&ba.ULS.sendTraceTag(39098305,324,50,"Progress selection start");c&&this.PHe.Eab(Bb.SelectionEditor.sZf(a))?c=c(b):(c=new Wz(b),c.ll=a,c=new Sh.a(null,Object(F.a)(this,this.fIb,"processSetSelection"),c),c.Nl("ExpandSelection"),c.run());return c.inProgress?1:32}TSi(a,b,c,h,m){return b.view.np?this.Bsa(b,c,Object(F.a)(this,this.zxh,"startOperationOfSelectAllInOutline")):this.Cnh(a,b,c,h,m)}fIb(a,b){return 0===b.rq?(b.transaction=this.yk.le(2),
b.transaction.kd(b.If.yg),b.rq=1,!0):1===b.rq?(b.If.Lb.lLb(b.ll,a),b.rq=2,!0):2===b.rq?(b.If.Lb.Pa.bsa=b.ll.bsa,this.In.kw(),b.transaction.SU(a),b.rq=3,b.transaction.dispose(),Te.a.mark(5799),!0):!1}Cnh(a,b,c){if(1===c)return 32;if(!b.view.Mh)return 2;a=b.view;return a.Lb&&a.Lb.Pa&&a.Lb.Pa.mb?this.zxh(a).inProgress?1:32:8}zxh(a){u.AFrameworkApplication.fk("Microsoft.Office.Web.SessionSettings.IQoETinyWinsSelectAllSettings");this.fCd&&a.np&&ba.ULS.sendTraceTag(39098306,324,50,"Progress select all reach top");
a=new Sh.a(null,Object(F.a)(this,this.JFk,"processSelectAllInOutline"),new Wz(a));a.Nl("SelectAllInOutline");a.run();return a}JFk(a,b){if(0===b.rq)return b.ll=yd.SelectionFactory.Q1k(b.If.Lb.Pa.mb),b.transaction=this.yk.le(2),b.transaction.kd(b.If.yg),b.rq=1,!0;if(1===b.rq){if(!b.jtb)return J.a.instance.ga(77)&&J.a.instance.ga(104)&&b.ll.Gl?(b.If.Lb.lLb(b.ll,a),b.jtb=b.ll.length):(b.If.Lb.setSelection(b.ll.ga(0),a),++b.jtb),!0;if(b.jtb<b.ll.length)return b.If.Lb.urf(b.ll.ga(b.jtb),a),++b.jtb,!0;b.rq=
2}return 2===b.rq?(b.If.Lb.Pa.bsa=b.ll.bsa,this.In.kw(),b.transaction.SU(a),b.rq=3,b.transaction.dispose(),!0):!1}emd(a,b,c){if(1===c)return 32;if(!b.view.Mh)return 2;b=b.view;a=yd.SelectionFactory.hSe(b.yg);if(!a)return 8;b=new Wz(b);b.ll=a;a=new Sh.a(null,Object(F.a)(this,this.fIb,"processSetSelection"),b);a.Nl("ExpandSelection");a.run();return a.inProgress?1:32}static get Xib(){return as.w4a||(as.w4a=vb.a.instance.resolve("Box4.ISelectionContextMenuProvider"))}static cDe(a,b,c){if(1===c)return 32;
if(!b.view.Mh)return 8;a=b.view;b=yd.SelectionFactory.sj(a.root.graphNode,!0);if(!b)return 8;a.Lb.setSelection(b);return 32}static yuh(){if(!J.a.instance.ga(75))return 2;var a=Fc.App.Kb.Jd.GK;if(!a.Mh)return 2;if(a.Mh&&1!==Fc.App.Kb.state){Te.a.mark(4668);var b=a.Lb.Pa.mb;if(!b&&u.AFrameworkApplication.fa.ka("ContextMenuOnSelectionFixIsEnabled"))return 2;b=Bb.SelectionEditor.Cia(b);let c=b.x,h=b.y+b.height;if(!a.container)return 8;a=Sys.UI.DomElement.getBounds(a.container);if(b.y<a.y||b.y>a.y+a.height||
b.x<a.x||b.x>a.x+a.width)c=a.x,h=a.y;as.Xib.saa(new Sys.UI.Point(c,h),1);Te.a.mark(4669)}return 32}}as.w4a=null;Object(n.a)(as,"SelectAllHandlers",null,[308]);class eM extends Rf.StandardDialog{constructor(a,b,c=null){super();this.xd=1;b?(b=CommonUIStrings.l_GoToClassicRibbonDialogMesage,this.jNd(CommonUIStrings.l_ToggleRibbonUXDialogTellUsWhy,c)):b=CommonUIStrings.l_GoToSingleLineRibbonDialogMessage;this.qFb(CommonUIStrings.l_ToggleRibbonUXDialogTitle,b,null,null,a,null)}}Object(n.a)(eM,"ToggleRibbonUXDialog",
Rf.StandardDialog,[]);const IQ=()=>{const a=u.AFrameworkApplication.Ta;a.ra(H.a.zHk,he.a.frame,GQ,101);a.ya(H.a.Nql,he.a.frame,HQ)},HQ=(a,b,c)=>{if(1===c)return 32;if(b.contextId!==he.a.frame)return 2;ba.ULS.sendTraceTag(25523336,340,50,"User opened the toggle Ribbon UX dialog from the {0}",u.AFrameworkApplication.Aa.hb.Np?"Single Line Ribbon":"Classic Ribbon");new eM(h=>{1===h&&u.AFrameworkApplication.Ta.processAction(H.a.GBh,2)},u.AFrameworkApplication.Aa.hb.Np);return 32},GQ=(a,b,c,h,m)=>{m[Zh.a.On]=
u.AFrameworkApplication.Aa.hb.Np;return 32};class jE{constructor(a){this.Kf=a}ATe(a,b){this.Kf.TU(a,b.cache.zN);this.Kf.ir(a,b.cache.fontSize)}lTe(){}B6d(){return null}JW(){return null}TSa(){return null}v8(){return null}Vth(){return!1}}Object(n.a)(jE,"FormattingStewardBridge",null,[297]);var fM=d(726),JQ=d(677);class gM{constructor(a,b,c,h,m,y,G,U,ja,va,Ta,fb){if(a)if(b)if(c)if(h)if(m)if(y)if(G){if(!U)throw Error.argumentNull("errorHandler");if(!ja)throw Error.argumentNull("sessionInfo");}else throw Error.argumentNull("graphActionBlockingManager");
else throw Error.argumentNull("graphTopologyManager");else throw Error.argumentNull("graphOperationEventSource");else throw Error.argumentNull("pptWorkspace");else throw Error.argumentNull("transactionFactory");else throw Error.argumentNull("pptSelectionManager");else throw Error.argumentNull("actionManager");this.ia=a;this.ob=b;this.Jb=c;this.PX=h;this.zs=m;this.ua=y;this.fc=G;this.Qd=U;this.Ce=ja;this.Nac=va;this.Ahc=Ta;this.Fdb=fb}vb(){this.ia.ra(M.a.nqf,nc.a.application,Object(F.a)(this,this.Doj,
"handleAddEditOrSetAsSlideTitle"),4);this.ia.ra(M.a.editSlideTitle,nc.a.application,Object(F.a)(this,this.Y7f,"handleEditSlideTitle"),4);this.ia.ra(M.a.addSlideTitle,nc.a.application,Object(F.a)(this,this.E7f,"handleAddSlideTitle"),4);this.ia.ra(M.a.Hqf,nc.a.application,Object(F.a)(this,this.Foj,"handleAddHiddenSlideTitle"),4);this.ia.ra(M.a.setAsSlideTitle,nc.a.application,Object(F.a)(this,this.a9f,"handleSetAsSlideTitle"),4);this.ia.ra(M.a.eah,nc.a.application,Object(F.a)(this,this.frj,"handleHyperlinkText"),
4);this.ia.ya(M.a.upf,nc.a.application,Object(F.a)(this,this.Aoj,"handleAccessibleAuthoringHelp"));this.ia.ra(M.a.Ecg,xb.a.application,Object(F.a)(this,this.r9f,"handleUploadCaptionsDialog"),4);this.ia.ra(M.a.Fcg,xb.a.application,Object(F.a)(this,this.r9f,"handleUploadCaptionsDialog"),4);this.ia.ra(M.a.Cgh,nc.a.application,Object(F.a)(this,this.Utj,"handleRemoveAllCaptions"),4)}De(){}fEa(){const a=this.ob.sk();return a?a.fEa():null}onShapeSelected(a,b){this.zs.rih(Object(F.a)(this,this.onShapeSelected,
"onShapeSelected"));b.shapeNode.V3?32!==this.ia.processAction(M.a.Grb,2)&&Ba.a.J(509724675,822,10,"Not able to begin edit shape text on title placeholder"):Ba.a.J(509724674,822,10,"After selecting title placeholder, the selected shape is not the title placeholder")}Enh(){const a=this.fEa();return a?(this.zs.Vsf(Object(F.a)(this,this.onShapeSelected,"onShapeSelected")),this.ob.selectShape(a,!0),!0):!1}Nfg(){const a=this.ob.We();return!!a&&1===a.length&&!!this.fEa()}Wdg(){for(const a of this.ob.We())if(a&&
!a.fEa())return!0;return!1}Vjg(){var a=this.ob.Xd();if(1!==a.length)return!1;a=a[0];return!a.V3&&!a.Jf&&!a.Kg&&!a.Rf&&a.hasText&&0<a.textLength()}Doj(a,b,c,h,m){if(1===c)return 32;var y=this.fEa();const G=this.ob.Xd(),U=1===G.length?G[0]:null;0<G.length&&U!==y?this.Vjg()?(y=3,a=this.a9f(a,b,c,h,m)):(y=4,a=32):this.Nfg()?(y=1,a=this.Y7f(a,b,c,h,m)):this.Wdg()?(y=2,a=this.E7f(a,b,c,h,m)):(Ba.a.J(509724673,822,10,"SlideTitle performed no action since none were enabled"),y=5,a=8);Jf.a("AddEditOrSetAsSlideTitle",
32===a,void 0,[Object.assign(new Ga.a,{name:"SubAction",int64:y})]);return a}Y7f(a,b,c){return 1===c?this.Nfg()?32:2:this.Enh()?32:8}F7f(a,b,c){if(1===b)return this.Wdg()?32:2;b=new Date;const h=this.Jb.zd(15,void 0,void 0,()=>{const m=this.ob.We();if(m&&1===m.length){const y=new Date;let G=0;G=window.setInterval(()=>{this.Enh()?window.clearInterval(G):2E3<+new Date-+y&&(Ba.a.J(509724672,822,50,"AddSlideTitle or AddHiddenSlideTitle couldn't find title placeholder {0}ms after executing",2E3),window.clearInterval(G))},
100)}});try{Ba.a.J(509724643,822,50,"HandleAddSlideTitle called with isOffSlideTitle {0}",c);h.nc(this.PX.Cf);h.jd=a;for(const m of this.ob.We())m&&!m.fEa()&&(m.jFa=c)}finally{h&&h.dispose()}a=new Date;Ba.a.J(509724642,822,50,"HandleAddSlideTitle completed with isOffSlideTitle {0}",c);if(c=Nc.a.Ib)c.Wm("AddSlideTitleStart",b),c.Wm("AddSlideTitleEnd",a),c.Nj=!1,c.Qr=!0,Nc.a.zfa(c);return 32}E7f(a,b,c){return this.F7f(a,c,!1)}Foj(a,b,c){return this.F7f(a,c,!0)}a9f(a,b,c){if(1===c)return this.Vjg()?
32:2;c=this.ob.sk();const h=this.ob.Xd();if(1!==h.length)return Ba.a.J(509724641,822,10,"SetAsSlideTitle should only be enabled with 1 shape selected"),8;b=new Date;const m=this.Jb.zd(15);try{Ba.a.J(509724640,822,50,"HandleSetAsSlideTitle called for SlideId.Cid {0} with shapeId {1}",c.Cb.cid,h[0].get_shapeId()),m.nc(c),m.jd=a,c.OKa=h[0].get_shapeId()}finally{m&&m.dispose()}a=new Date;Ba.a.J(509724639,822,50,"HandleSetAsSlideTitle completed for SlideId.Cid {0} with shapeId {1}",c.Cb.cid,h[0].get_shapeId());
if(c=Nc.a.Ib)c.Wm("SetAsSlideTitleStart",b),c.Wm("SetAsSlideTitleEnd",a),c.Nj=!1,c.Qr=!0,Nc.a.zfa(c);32!==this.ia.processAction(M.a.Grb,2)&&Ba.a.J(509724638,822,10,"Not able to begin edit shape text after Set as Slide Title");return 32}frj(a,b,c){return this.ob.O8()?this.ia.processAction(D.a.B7b,c):this.ia.processAction(M.a.Wqb,c)}Aoj(a,b,c){if(1===c)return 32;a={};this.Nac&&(a.query="AssetID="+this.Nac);b={};b.TE=ResourceStrings.L_Help;b.assetId="FA000000012";b.nonPersistedSettings=a;return this.ia.La(M.a.Ufa,
2,b)}iNj(){if(!this.Ahc)return!1;const a=this.ob.Xd();return 1!==a.length?!1:a[0].KQ}r9f(a,b,c){const h=this.ua.Ba;if(!h||this.fc.$c(h))return 8;if(1===c)return this.iNj()?32:2;b=Nc.a.Ik("Captions::Insert");try{return JQ.a.jXe(".vtt",fM.e,()=>fM.d(a,Object(F.a)(this,this.HEj,"insertCaptionsSuccessAfterUpload"),"captions",this.Ce,h),"captions",h,this.ua.presentation,this.fc,this.Qd,b,!1,this.Fdb,50,10,3),b&&b.Va("CaptionsDialogInitialized","true"),32}catch(m){Ba.a.J(509724637,818,10,"Error while rendering new captions selection dialog.")}b&&
(b.Va("CaptionsDialogInitialized","false"),b.finish(),b=null);return 8}HEj(a,b,c,h,m,y,G){h.PN(c)&&Ba.a.J(509724636,822,15,"Captions::InsertCaptionsSuccessAfterUpload:Presentation was blocked with loader for {0} milliseconds",+new Date-+c.Ria);h.ZJ(c);m&&m.Va("CaptionsUploadToRC","true");Object(Rd.a)("FixForInsertMediaSlideNavigationIssue")||(G=this.ua.Ba);if(G&&G.isConnected){y=y.files[0].name;h=c="";var U=y.split(".");2<=U.length&&(h=U[U.length-2]);Fa.a.ue(h)||(c=y.lastIndexOf("."),c=0<=c?y.substring(0,
c):y,h="");y=this.ob.Xd();if(1===y.length){y=y[0];U=this.Jb.zd(15);try{U.nc(G),U.jd=a,m&&m.Va("InsertCaptionsInProgress","true"),y.zsb=b,y.xsb=c,y.ysb=h}finally{U&&U.dispose()}m&&(m.Va("InsertCaptionsSuccessful","true"),m.finish())}}}sRj(){if(!this.Ahc)return!1;const a=this.ob.Xd();return 1!==a.length?!1:a[0].KQ}Utj(a,b,c){if(1===c)return this.sRj()?32:2;b=this.ob.Xd();if(1!==b.length)return 16;c=b[0];b=new Date;const h=this.Jb.zd(15);try{Ba.a.J(509724635,822,50,"RemoveAllCaptions started"),h.nc(this.PX.Cf),
h.jd=a,c.mzb=!0}finally{h&&h.dispose()}a=new Date;Ba.a.J(509724634,822,50,"RemoveAllCaptions completed");if(c=Nc.a.Ib)c.Wm("RemoveAllCaptionsStart",b),c.Wm("RemoveAllCaptionsEnd",a),c.Nj=!1,c.Qr=!0,Nc.a.zfa(c);return 32}}Object(n.a)(gM,"AccessibleAuthoringActor",null,[227]);var KQ=d(141),LQ=d(170),MQ=d(179);class hM{constructor(a,b,c,h){this.l5c=!1;this.r9="";this.hCb=!1;this.wXa=null;this.L2c=-1;this.oCb=!1;this.$ka=[];this.Yb=b;this.la=c;this.Gad=h;a&&this.Yb.jf(()=>{a.GG(Object(F.a)(this,this.Csk,
"onSelectionChangeFinished"))})}vb(){}De(){}u5b(a,b,c){const h=[];for(const m of a)h.push(appChrome.actions.addScalingStepInTab("Home",{["type"]:b,["controlId"]:m},c));return h}USc(a){const b=[];for(let c=0;4>c;c++){const h={["type"]:"DropPreviewItemFromGallery",["controlId"]:a};let m=null;2>c&&(m=0);b.push(appChrome.actions.addScalingStepInTab("Home",h,m))}b.push(appChrome.actions.addScalingStepInTab("Home",{["type"]:"GalleryToFlyout",["controlId"]:a},null));return b}Q3f(a){const b=[];let c=!1;if(a){switch(this.r9){case "FormatPicture":Array.addRange(b,
this.USc("PictureStyles"));c=!0;break;case "Table":this.oCb||Array.addRange(b,this.USc("TableStyles"));c=!0;break;case "SmartArtDesign":Array.addRange(b,this.USc("ChangeSmartArtLayoutAnchor"));c=!0;break;case "Graphics":Array.addRange(b,this.USc("GraphicsStylePreviewGallery"));c=!0;break;case "Audio":c=!0;break;case "FormatShape":Array.addRange(b,this.u5b(["InsertShapeTextBoxBig","AlternativeText"],"DropLabel",0)),Array.addRange(b,this.u5b(["InsertShapeTextBoxBig","AlternativeText"],"MoveToOverflow",
0)),Array.addRange(b,this.u5b(["SetWidth","SetHeight"],"MoveToOverflow",null))}c&&(a=null,this.oCb&&(a=0),Array.addRange(b,this.u5b(this.wXa,"DropLabel",a)),a=this.wXa.slice(0,this.wXa.length).reverse(),Array.addRange(b,this.u5b(a,"MoveToOverflow",null)))}else for(const h of this.wXa)b.push(appChrome.actions.removeControlScalingStepsFromTab(h,"Home"));return b}S4d(a){const b={};for(const c of a)try{b[c]=appChrome.selectors.getModelType(c)}catch(h){return this.NFa("Error","GetModelType failed for "+
c),null}return b}e5d(a){switch(a){case "FormatPicture":case "SmartArtDesign":case "Audio":case "Graphics":return["Font","Paragraph","Drawing"]}return[]}pOb(a){this.Gad&&(a=this.S4d(a))&&this.Gad(a)}Vwl(a){if(a.length){if(this.Gad){var b=this.S4d(a);if(!b)return;var c=this.e5d(this.r9);if(0<c.length&&!this.hCb){for(var h of c)this.$ka.push(appChrome.actions.updateGroupHiddenState(h,!0));this.hCb=!0}else if(this.hCb&&!c.length){c=[];h=this.e5d("FormatPicture");for(var m of h)this.$ka.push(appChrome.actions.updateGroupHiddenState(m,
!1)),Array.addRange(c,appChrome.selectors.getVisibleControlsInGroup(m));if(m=this.S4d(c))for(let y in m)b[y]=m[y];this.hCb=!1}this.Gad(b)}this.wXa=a;b=[];for(const y of a)appChrome.selectors.isControlDisabled(y)&&b.push(y);0<b.length&&this.NFa("Disabled",b.join(","));0<this.wXa.length&&(this.$ka.push(appChrome.actions.updateGroupHiddenState("Adaptive",!1)),this.$ka.push(appChrome.actions.updateControlsInGroup("Adaptive",this.wXa)),Array.addRange(this.$ka,this.Q3f(!0)),this.l5c=!0)}}hkh(a){""!==this.r9&&
this.r9!==a&&Array.addRange(this.$ka,this.Q3f(!1))}o2e(a,b){if(a||this.l5c)if(this.$ka.push(appChrome.actions.updateGroupHiddenState("Adaptive",!a)),this.l5c=a,b=this.e5d(b),a&&0<b.length||this.hCb){for(var c of b)this.$ka.push(appChrome.actions.updateGroupHiddenState(c,a));a||(c=appChrome.selectors.getVisibleControlsInGroup("Font"),Array.addRange(c,appChrome.selectors.getVisibleControlsInGroup("Paragraph")),this.pOb(c));this.hCb=a}}ZMf(){0<this.$ka.length&&(appChrome.api.dispatch(this.$ka),this.$ka=
[])}Lqi(a,b){if(0>Array.indexOf(a,b)||"SmartArtDesign"===b&&(this.pOb(["SmartArtEditText"]),appChrome.selectors.getButtonToggleState("SmartArtEditText")))return!1;a=!1;if("Table"===b&&Jl.a.instance.mb){const c=!Jl.a.instance.mb.Gl&&!Jl.a.instance.mb.q_c;if(a=(""===this.r9||this.r9===b)&&c!==this.oCb)this.oCb=c}a?this.hkh("TableCellEdit"):this.hkh(b);this.r9=b;return!0}X1k(){const a="Table FormatPicture SmartArtDesign Audio Graphics FormatShape".split(" ");let b=!1;const c=appChrome.selectors.getActiveContextualTabIds();
for(const h of a)if(this.Lqi(c,h)){b=!0;break}return b?this.r9:""}i2i(){switch(this.r9){case "FormatPicture":return"ChangePictureFlyout ChangePicture ResetPicture PictureStyles PictureBorders AlternativeText ArrangeAnchor PictureCropAnchor SetWidth SetHeight".split(" ");case "Table":return this.oCb?["Select","TableDelete","TableInsert","TableAlignmentAnchor"]:"Select TableDelete TableInsert MergeTableCells SplitTableCells SetSizeAnchor TableDistribute TableAlignmentAnchor TableCellMarginAnchor ApplyTableStyleOptionAnchor TableStyles PowerPointCellShadingMenuOpen TableAlternativeText TableBordersMenuOpen TableBorderWidthAnchor SetCellBorderColor".split(" ");
case "SmartArtDesign":return"SmartArtEditText SmartArtPromote SmartArtDemote SmartArtReverse ChangeSmartArtLayoutAnchor ChangeSmartArtColorAnchor SmartArtStyles SmartArtResetGraphic AlternativeText SetWidth SetHeight".split(" ");case "FormatShape":return["SetWidth","SetHeight","InsertShapeTextBoxBig","AlternativeText"];case "Audio":return"AudioPlay AudioPause SetVolume StartAudio SetAudioOptions PlayInBackground NoAudioStyle ChangePictureFlyout ChangePicture ResetPicture AudioPictureStyles PictureBorders AlternativeText ArrangeAnchor PictureCropAnchor SetWidth SetHeight".split(" ");
case "Graphics":return"GraphicsStylePreviewGallery ChangeGraphicFlyout GraphicsFill GraphicsOutline AlternativeText ArrangeAnchor SetWidth SetHeight".split(" ")}return[]}Csk(a,b){if(!this.la.zoa&&"Home"===appChrome.selectors.getSelectedTabId()&&b.ll&&b.ll.mb&&b.ll.length){var c=()=>{const h=this.r9;""===this.X1k()?this.o2e(!1,h):this.oCb||""===h||h!==this.r9?this.Vwl(this.i2i()):this.l5c||(this.pOb(this.wXa),this.o2e(!0,this.r9));this.ZMf()};-1!==this.L2c&&window.clearTimeout(this.L2c);this.L2c=window.setTimeout(()=>
{this.L2c=-1;let h=!1;try{window.self.requestIdleCallback(c)}catch(m){h=!0}h&&window.self.requestAnimationFrame(c)},250)}else this.o2e(!1,this.r9),this.ZMf()}NFa(a,b){a={["Time"]:window.performance.now(),["Event"]:a,["Message"]:b,["Scenario"]:"AdaptiveTabGroup"};KQ.a.sendActivityEvent(Object.assign(new MQ.a,{name:"Office.TellMe.TellMeWAC.Events",dataFields:LQ.a.ND(a),durationMs:window.performance.now()}))}}Object(n.a)(hM,"AdaptiveTabGroupUpdaterActor",null,[227]);class iM extends It{constructor(a,
b){super(a);this.s1h=b;this.zt=a}getAltText(a){return(a=this.sQ(a))?a.get_altTitle():""}IZf(a){return(a=this.sQ(a))?a.get_alt():""}XOd(a,b){if(1===a)if(this.hide(),a=this.sQ(this.zt)){const c=this.s1h.le(15);c.nc(a);a.f0a=!1;a.set_altTitle(b[iq.ZOd]);a.set_alt(b[iq.WOd]);c.dispose()}else Ba.a.J(17876899,822,10,"Try to set alternative text on a null shape.")}sQ(a){let b;return(a=(a=Lh.b(a))?a.Lb:null)&&(b=a.Xd())&&1===b.length?b[0]:null}}Object(n.a)(iM,"ShapeAltTextDialog",It,[]);class jM{constructor(a,
b,c,h,m,y){this.Jb=m;this.ia=a;this.la=b;this.ob=h;this.bcb=c;this.fc=y}vb(){this.la.ceg&&this.ia.ra(M.a.Wqb,xb.a.view,Object(F.a)(this,this.mci,"altTextDispatcher"),4)}De(){}Q1i(a){new iM(a,this.Jb)}mci(a,b,c){if(a!==M.a.Wqb)return 16;a=this.ob.Xd();if(!a||1!==a.length||this.fc.$c(a[0]))return Ba.a.J(17876881,822,50,"No or multiple shapes selected or the selected shape is blocked. Disable the alternative text button."),16;if(1===c)return 32;Ba.a.J(17876883,822,50,"Begin setting the alternative text for shape.");
a[0].Ej&&!a[0].get_isSVGBlipFilled()&&this.la.jUa?this.bcb.HKk():this.Q1i(b);return 32}}Object(n.a)(jM,"AltTextActor",null,[227]);class kM{constructor(a,b,c,h,m,y,G,U){this.gE=null;this.ia=a;this.ob=b;this.Fa=c;this.Jb=h;this.Lbb=m;this.ova=y;this.mc=U;this.Lbb&&this.Lbb.execute(ja=>{this.gE=ja})}vb(){this.ia.ra(M.a.$Gc,nc.a.application,Object(F.a)(this,this.jpj,"handleAudioPlay"),96);this.ia.ra(M.a.IYb,nc.a.application,Object(F.a)(this,this.ipj,"handleAudioPause"),96);this.ia.ra(M.a.Hwf,nc.a.application,
Object(F.a)(this,this.Qfi,"audioPlayPauseCommandHandler"),96);this.ia.ra(M.a.Poh,nc.a.application,Object(F.a)(this,this.H6b,"handleSetAudioOptions"),96);this.ia.ra(M.a.$lc,nc.a.application,Object(F.a)(this,this.$lc,"queryAudioOptions"),96);this.ia.ra(M.a.playAcrossSlides,nc.a.application,Object(F.a)(this,this.H6b,"handleSetAudioOptions"),96);this.ia.ra(M.a.qmc,nc.a.application,Object(F.a)(this,this.qmc,"queryPlayAcrossSlides"),96);this.ia.ra(M.a.loopUntilStopped,nc.a.application,Object(F.a)(this,
this.H6b,"handleSetAudioOptions"),96);this.ia.ra(M.a.mmc,nc.a.application,Object(F.a)(this,this.mmc,"queryLoopUntilStopped"),96);this.ia.ra(M.a.hideDuringShow,nc.a.application,Object(F.a)(this,this.H6b,"handleSetAudioOptions"),96);this.ia.ra(M.a.hmc,nc.a.application,Object(F.a)(this,this.hmc,"queryHideDuringShow"),96);this.ia.ra(M.a.rewindAfterPlaying,nc.a.application,Object(F.a)(this,this.H6b,"handleSetAudioOptions"),96);this.ia.ra(M.a.vmc,nc.a.application,Object(F.a)(this,this.vmc,"queryRewindAfterPlaying"),
96);this.ia.ya(M.a.playInBackground,nc.a.application,Object(F.a)(this,this.b9f,"handleSetAudioStyles"));this.ia.ya(M.a.noAudioStyle,nc.a.application,Object(F.a)(this,this.b9f,"handleSetAudioStyles"));this.ia.ra(M.a.rmc,nc.a.application,Object(F.a)(this,this.rmc,"queryPlayInBackground"),96);this.ia.ra(M.a.nmc,nc.a.application,Object(F.a)(this,this.nmc,"queryNoAudioStyle"),96);this.ia.ra(M.a.setVolume,nc.a.application,Object(F.a)(this,this.I6b,"handleSetVolume"),96);this.ia.ra(M.a.pod,nc.a.application,
Object(F.a)(this,this.I6b,"handleSetVolume"),96);this.ia.ra(M.a.zmc,nc.a.application,Object(F.a)(this,this.zmc,"querySetVolumeLow"),96);this.ia.ra(M.a.qod,nc.a.application,Object(F.a)(this,this.I6b,"handleSetVolume"),96);this.ia.ra(M.a.Amc,nc.a.application,Object(F.a)(this,this.Amc,"querySetVolumeMedium"),96);this.ia.ra(M.a.ood,nc.a.application,Object(F.a)(this,this.I6b,"handleSetVolume"),96);this.ia.ra(M.a.ymc,nc.a.application,Object(F.a)(this,this.ymc,"querySetVolumeHigh"),96);this.ia.ra(M.a.rod,
nc.a.application,Object(F.a)(this,this.I6b,"handleSetVolume"),96);this.ia.ra(M.a.Bmc,nc.a.application,Object(F.a)(this,this.Bmc,"querySetVolumeMute"),96);this.ia.ra(M.a.jxh,nc.a.application,Object(F.a)(this,this.Yuj,"handleStartAudio"),96);this.ia.ra(M.a.Jmc,nc.a.application,Object(F.a)(this,this.Jmc,"queryStartAudio"),96)}De(){}jpj(a,b,c,h,m){b=this.ob.Xd();if(1<b.length||!this.gE)return 16;const y=this.gE.bL(b[0]);if(!y||!y.isPlayerReady())return 16;if(1===c)return 32;let G=!1;m&&(G=!!m.ActionFromPlayer);
return zg.b("AudioPlaybackOptionsActor::HandleAudioPlay ActionFromPlayer",G.toString(),a,()=>{y&&!G&&y.startPlaying();const U=[appChrome.actions.updateControlHiddenState("AudioPlay",!0),appChrome.actions.updateControlEnabledDisabledState("AudioPause",!1),appChrome.actions.updateControlHiddenState("AudioPause",!1)];appChrome.api.dispatch(U);return 32})}ipj(a,b,c,h,m){const y=this.ob.Xd();if(1<y.length||!this.gE)return 16;if(1===c)return 32;let G=!1;m&&(G=!!m.ActionFromPlayer);return zg.b("AudioPlaybackOptionsActor::HandleAudioPause ActionFromPlayer",
G.toString(),a,()=>{var U=this.gE.bL(y[0]);U&&!G&&U.pause();U=[appChrome.actions.updateControlEnabledDisabledState("AudioPlay",!1),appChrome.actions.updateControlHiddenState("AudioPlay",!1),appChrome.actions.updateControlHiddenState("AudioPause",!0)];appChrome.api.dispatch(U);return 32})}Qfi(){var a=this.ob.qTc();if(!a||!this.gE)return 2;(a=this.gE.bL(a))&&!a.isPlayerFocused()&&(a.isAudioPlaying()?this.ia.processAction(M.a.IYb,2):this.ia.processAction(M.a.$Gc,2));return 32}H6b(a,b,c,h,m){if(1===c)return 32;
if(!m)return Ba.a.J(512500762,822,10,"AudioPlaybackOptionsActor::HandleSetAudioOptions actionData is null"),8;const y=m.On;return zg.b("AudioPlaybackOptionsActor::HandleSetAudioOptions audioOption: ",m.SqmControlId,a,()=>{const G=this.ob.sg();if(G&&0<G.length){const U=this.Jb.zd(15,void 0,()=>{this.ob.ij();this.Fa.Ed()});try{U.nc(G[0]);for(const ja of G){if(!ja||!ja.media)continue;const va=ja.media;switch(a){case M.a.playAcrossSlides:va.plyAcrssSldsField=y;break;case M.a.loopUntilStopped:va.repeatField=
y;break;case M.a.hideDuringShow:va.hideDrngShwField=y;break;case M.a.rewindAfterPlaying:va.rewindField=y}ja.media=va;if(this.ova&&this.gE&&(a===M.a.loopUntilStopped||a===M.a.rewindAfterPlaying)){const Ta=this.gE.bL(ja);Ta&&(a===M.a.loopUntilStopped?Ta.setRepeat(va.repeatField):a===M.a.rewindAfterPlaying&&Ta.setRewind(va.rewindField))}}}finally{U&&U.dispose()}}return 32})}b9f(a,b,c,h,m){return 1===c?32:m?zg.b("AudioPlaybackOptionsActor::HandleSetAudioStyles",m.SourceControlId,a,()=>{const y=this.ob.sg();
if(y&&0<y.length){const G=this.Jb.zd(15,void 0,()=>{this.ob.ij();this.Fa.Ed()});try{G.nc(y[0]);for(const U of y){if(!U||!U.media||U.Kg)continue;const ja=U.media;switch(a){case M.a.playInBackground:ja.plyAcrssSldsField=!0;ja.repeatField=!0;ja.hideDrngShwField=!0;ja.strtField=0;break;case M.a.noAudioStyle:ja.plyAcrssSldsField=!1,ja.repeatField=!1,ja.hideDrngShwField=!1,ja.strtField=2}U.media=ja}}finally{G&&G.dispose()}}return 32}):(Ba.a.J(512500761,822,10,"AudioPlaybackOptionsActor::HandleSetAudioStyles actionData is null"),
8)}Yuj(a,b,c,h,m){if(1===c)return 32;if(!m)return Ba.a.J(512500760,822,10,"AudioPlaybackOptionsActor::HandleStartAudio actionData is null"),8;const y=m.CommandValueId;return zg.b("AudioPlaybackOptionsActor::HandleStartAudio Start Option: ",y,a,()=>{if(!y||""===y.trim())return 32;const G=this.ob.sg();if(G&&0<G.length){const U=this.Jb.zd(15,void 0,()=>{this.ob.ij();this.Fa.Ed()});try{U.nc(G[0]);for(const ja of G){if(!ja||!ja.media||ja.Kg)continue;const va=ja.media;va.strtField="Automatically"===y?0:
2;ja.media=va}}finally{U&&U.dispose()}}return 32})}rmc(a,b,c,h,m){return this.zxa(m,1)}nmc(a,b,c,h,m){return this.zxa(m,0)}I6b(a,b,c,h,m){return 1===c?32:m?zg.b("AudioPlaybackOptionsActor::HandleSetVolume Volume: ",m.SourceControlId,a,()=>{const y=this.ob.sg();if(y&&0<y.length){const G=this.Jb.zd(15,void 0,()=>{this.ob.ij();this.Fa.Ed()});try{G.nc(y[0]);for(const U of y){if(!U||!U.media)continue;const ja=U.media;switch(a){case M.a.rod:ja.mteField=!0;break;case M.a.pod:ja.vlmField=.2;ja.mteField=!1;
break;case M.a.qod:ja.vlmField=.5;ja.mteField=!1;break;case M.a.ood:ja.vlmField=.8,ja.mteField=!1}this.mc.rL&&(U.media=ja);const va=m.ActionFromPlayer;if(this.ova&&this.gE&&!va){const Ta=this.gE.bL(U);Ta&&(Ta.setMute(ja.mteField),Ta.setVolume(ja.vlmField))}}}finally{G&&G.dispose()}}return 32}):(Ba.a.J(512500759,822,10,"AudioPlaybackOptionsActor::HandleSetVolume actionData is null"),8)}zmc(a,b,c,h,m){return this.zxa(m,2)}Amc(a,b,c,h,m){return this.zxa(m,3)}ymc(a,b,c,h,m){return this.zxa(m,4)}Bmc(a,
b,c,h,m){return this.zxa(m,5)}Jmc(a,b,c,h,m){if(a=Object(ua.a)(Ph.a,m))c=this.ob.sg(),b=this.Oig(c,2),c=this.Oig(c,0),b?(a.WZ=ResourceStrings.L_AudioStartWhenClickedOn,a.dpc()):c&&(a.WZ=ResourceStrings.L_AudioStartAutomatically,a.dpc());return 32}$lc(){this.c$b()&&Fc.App.Kb.mG({PlayAcrossSlides:"CheckboxModel",LoopUntilStopped:"CheckboxModel",RewindAfterPlaying:"CheckboxModel",HideDuringShow:"CheckboxModel"});return 32}qmc(a,b,c,h,m){return this.zxa(m,6)}mmc(a,b,c,h,m){return this.zxa(m,7)}hmc(a,
b,c,h,m){return this.zxa(m,9)}vmc(a,b,c,h,m){return this.zxa(m,8)}APi(a){return a.media.plyAcrssSldsField&&a.media.repeatField&&!a.media.strtField}zPi(a){return!a.media.plyAcrssSldsField&&!a.media.repeatField&&!!a.media.strtField}Oig(a,b){if(a&&0<a.length){for(const c of a)if(!c||!c.media||c.media.strtField!==b)return!1;return!0}return!1}zxa(a,b){if(a=Object(ua.a)(Ph.a,a)){const c=this.ob.sg();if(c&&0<c.length){let h=!1;for(const m of c)if(m&&m.media){switch(b){case 0:h=this.zPi(m);break;case 1:h=
this.APi(m);break;case 5:h=m.media.mteField;break;case 2:h=!m.media.mteField&&.2>=m.media.vlmField;break;case 3:h=!m.media.mteField&&.2<m.media.vlmField&&.8>m.media.vlmField;break;case 4:h=!m.media.mteField&&.8<=m.media.vlmField;break;case 6:h=m.media.plyAcrssSldsField;break;case 7:h=m.media.repeatField;break;case 8:h=m.media.rewindField;break;case 9:h=m.media.hideDrngShwField;break;default:h=!1}if(!h)break}a.Qf(h)}}return 32}c$b(){return!!u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.hb.Np}}
Object(n.a)(kM,"AudioPlaybackOptionsActor",null,[227]);class lM{constructor(){this.type="AudioSettingsTaskPaneProps";this.hiddenSettings=this.onSubtitleLanguageUpdated=this.onSpokenLanguageUpdated=this.onSpeakersUpdated=this.onMicrophoneUpdated=this.availableSubtitleLanguages=this.availableSpokenLanguages=this.deviceSpeakers=this.deviceMicrophones=null;this.disableDeviceDropdown=!0;this.showDeviceErrorMessage=!1}}Object(n.a)(lM,"AudioSettingsTaskPaneProps",null,[]);class lu{constructor(){this.text=
this.key=null;this.itemType=0;this.selected=!1}}Object(n.a)(lu,"DropdownOption",null,[]);class mM{constructor(a,b,c,h,m){this.bM=null;this.OGa=this.Db=!1;a.loadScript("audio-settings-strings").then(()=>{this.OGa=!0;Ba.a.J(592447300,833,50,"audio-settings-strings loaded successfully")}).catch(y=>{Ba.a.J(592447298,833,10,"Failed to load audio-settings-strings "+y.toString())});this.ia=b;this.jE=h;this.Hc=c;this.eO=m}vb(){this.ia.ya(M.a.mpd,nc.a.application,Object(F.a)(this,this.mpd,"showHideAudioSettingsPane"));
this.ia.ra(M.a.NIb,nc.a.application,Object(F.a)(this,this.NIb,"queryShowHideAudioSettingsPane"),96)}De(){}mpd(a,b,c){return b.contextId===nc.a.application&&this.OGa?1===c?32:zg.a("AudioSettingsPaneToggle",a,()=>{(this.Db=!this.Db)?(this.em(),this.eO.R7h(Object(F.a)(this,this.q1g,"onAudioDevicesChanged")),Ba.a.J(592447296,833,50,"AudioSettingsPaneActor::ShowHideAudioSettingsPane show")):(this.eO.XSk(Object(F.a)(this,this.q1g,"onAudioDevicesChanged")),this.QK(),Ba.a.J(592447266,833,50,"AudioSettingsPaneActor::ShowHideAudioSettingsPane close"));
return 32}):2}NIb(a,b,c,h,m){if(!Object(za.a)(Ph.a,m))return 8;m.Qf(this.Db);return 32}em(a=!1){a||this.jC();const b=Object.assign(new ju.a,{title:ResourceStrings.L_AudioSettings,hideHeader:!1,width:320,location:2,contentProps:this.bM,onOpen:()=>{},onClose:()=>{this.Db=!1},isModernPane:!0}),c=document.getElementById("AudioSettingsPaneFocus-panel");this.jE.H8(Ua.a.NBa,Ua.a.nj,c,()=>{this.rA(!0)},()=>{this.rA(!1)});fj.UISurfaces.xr().then(h=>{a?this.Db&&h.updateTaskPane(Ua.a.NBa,b):h.showTaskPane(Ua.a.NBa,
b);return null}).catch(h=>{Ba.a.J(592447264,833,10,"AudioSettingsPaneActor::ShowPane exception: {0}",h.toString())})}QK(){fj.UISurfaces.xr().then(a=>{a.hideTaskPane(Ua.a.NBa,2);return null}).catch(a=>{Ba.a.J(592447262,833,10,"AudioSettingsPaneActor::ClosePane exception: {0}",a.toString())})}jC(){this.bM=Object.assign(new lM,{deviceMicrophones:[],deviceSpeakers:[],availableSpokenLanguages:this.Vij(),availableSubtitleLanguages:this.Hjj(),onMicrophoneUpdated:Object(F.a)(this,this.kzl,"updateMicrophone"),
onSpeakersUpdated:Object(F.a)(this,this.AAl,"updateSpeaker"),onSpokenLanguageUpdated:Object(F.a)(this,this.DAl,"updateSpokenLanguage"),onSubtitleLanguageUpdated:Object(F.a)(this,this.JAl,"updateSubtitleLanguage"),hiddenSettings:["Speaker"],disableDeviceDropdown:!0,showDeviceErrorMessage:!1});this.eO.enumerateDevices(Object(F.a)(this,this.ijc,"onEnumerateDevicesSuccess"),Object(F.a)(this,this.DYa,"onDevicesFailure"),Object(F.a)(this,this.OYa,"onUnsupported"))}rA(a){const b=document.getElementById("TaskPaneCloseBtnAudioSettingsPaneFocus");
a&&b&&b.focus()}ijc(a){if(0!==a.length)if(ta.a.Wa(a[0].label))this.eO.requestPermission(Object(F.a)(this,this.bsk,"onRequestPermissionSuccess"),Object(F.a)(this,this.DYa,"onDevicesFailure"),Object(F.a)(this,this.OYa,"onUnsupported")),Ba.a.J(592447260,833,50,"AudioSettingsPaneActor::OnEnumerateDevicesSuccess requesting device permission");else{var b=new Qa.a,c=new Qa.a;for(const h of a)ta.a.Wa(h.deviceId)||(a=Object.assign(new lu,{key:h.deviceId,text:ta.a.Wa(h.label)?h.deviceId:h.label}),"audiooutput"===
h.kind?c.add(a):"audioinput"===h.kind&&b.add(a));0<b.count&&(b.ga(0).selected=!0);0<c.count&&(c.ga(0).selected=!0);this.bM.deviceMicrophones=b.toArray();this.bM.deviceSpeakers=c.toArray();this.bM.disableDeviceDropdown=!1;this.bM.showDeviceErrorMessage=!1;this.em(!0)}}bsk(){this.eO.enumerateDevices(Object(F.a)(this,this.ijc,"onEnumerateDevicesSuccess"),Object(F.a)(this,this.DYa,"onDevicesFailure"),Object(F.a)(this,this.OYa,"onUnsupported"));Ba.a.J(592447258,833,50,"AudioSettingsPaneActor::OnRequestPermissionSuccess successfully received permissions")}DYa(a){this.bM.disableDeviceDropdown=
!0;this.bM.showDeviceErrorMessage=!0;this.em(!0);Ba.a.J(592447256,833,10,"AudioSettingsPaneActor::OnDevicesFailure unable to get devices. Error: {0}",a.toString())}OYa(){this.bM.disableDeviceDropdown=!0;this.em(!0);Ba.a.J(592447254,833,10,"AudioSettingsPaneActor::OnDevicesUnsupported mediaDevices API not available for browser: {0}",v.a.Ly)}kzl(a){this.eO.microphoneDeviceId=a.key;Ba.a.J(592447252,833,50,"AudioSettingsPaneActor::UpdateMicrophone user updated microphone")}AAl(){Ba.a.J(592447250,833,
50,"AudioSettingsPaneActor::UpdateSpeaker user updated speaker")}q1g(a,b){b.Egk&&this.eO.enumerateDevices(Object(F.a)(this,this.ijc,"onEnumerateDevicesSuccess"),Object(F.a)(this,this.DYa,"onDevicesFailure"),Object(F.a)(this,this.OYa,"onUnsupported"))}Vij(){const a=new Qa.a;for(let b of this.Hc.cZe)a.add(Object.assign(new lu,{key:b,text:Fa.a.ue(b).displayName,selected:this.Hc.Eoa.toLowerCase()===b.toLowerCase()}));a.add(Object.assign(new lu,{key:"seperator",text:"-",itemType:1}));a.add(Object.assign(new lu,
{key:"header",text:ResourceStrings.L_SubtitlesPreviewSpokenLanguageSectionTitle,itemType:2}));for(let b of this.Hc.bZe)a.add(Object.assign(new lu,{key:b,text:Fa.a.ue(b).displayName,selected:this.Hc.Eoa.toLowerCase()===b.toLowerCase()}));return a.toArray()}Hjj(){const a=new Qa.a;for(let b of this.Hc.OXe)a.add(Object.assign(new lu,{key:b,text:Fa.a.ue(b).displayName,selected:this.Hc.hza.toLowerCase()===b.toLowerCase()}));return a.toArray()}DAl(a){this.Hc.Eoa=a.key;Ba.a.J(592447248,833,50,"AudioSettingsPaneActor::UpdateSpokenLanguage user updated spoken language")}JAl(a){this.Hc.hza=
a.key;this.Hc.clb=this.Hc.XTc();Ba.a.J(592447246,833,50,"AudioSettingsPaneActor::UpdateSpeaker user updated subtitle language")}}Object(n.a)(mM,"AudioSettingsPaneActor",null,[227]);class nM{constructor(){this.type="CaptionDiscoverabilityTaskPaneProps";this.podiumPresentationImageUrl=null;this.enableDoNotShowAgain=!1;this.onLaunchSlideShowButtonClicked=this.onDismissButtonClicked=this.onTurnOnButtonClicked=null}}Object(n.a)(nM,"CaptionDiscoverabilityTaskPaneProps",null,[]);class Lv{constructor(a,b,
c,h,m,y,G,U,ja,va){this.FCg=!1;a.loadScript("powerpoint-discoverability-strings").then(()=>{this.FCg=!0;Ba.a.J(591971352,801,50,"powerpoint-discoverability-strings is loaded successfully")}).catch(Ta=>{Ba.a.J(591971350,801,10,"Failed to load powerpoint-discoverability-strings "+Ta.toString())});this.ia=b;this.Lc=c;this.qc=h;this.je=m;this.jE=y;this.Hc=G;this.eO=U;this.e9j=va;this.mck=ja;this.ISg=oi.a.get("PPTCaptionDiscoverabilityLastShownTime")?!0:!1;this.Idc=!1;this.Lc.M5a(Object(F.a)(this,this.R$,
"onRibbonTabSwitched"))}dispose(){this.Lc.DJb(Object(F.a)(this,this.R$,"onRibbonTabSwitched"))}vb(){this.ia.ya(M.a.xqc,nc.a.application,Object(F.a)(this,this.xqc,"showCaptionDiscoverabilityPane"))}De(){}xqc(a,b,c){if(b.contextId!==nc.a.application||!this.FCg)return 2;if(1===c)return 32;if(Lv.Gie||Lv.JZd||!this.nUi()||!this.mUi())return 8;this.Idc||this.Npi(a);return 32}Npi(a){zg.a("CaptionDiscoverabilityPaneActor::CheckAudioAndShowPane",a,()=>{this.Idc=!0;this.eO.enumerateDevices(Object(F.a)(this,
this.fmk,"onAudioInputAvailable"),Object(F.a)(this,this.DYa,"onDevicesFailure"),Object(F.a)(this,this.OYa,"onUnsupported"));return 32})}fmk(a){if(a.length){for(const b of a)if("audioinput"===b.kind&&!this.mck.Qab()){Lv.Gie=!0;this.em();break}this.Idc=!1}}DYa(a){this.Idc=!1;Ba.a.J(591538019,822,10,"CaptionDiscoverabilityPaneActor::OnDevicesFailure exception: {0}",a.toString())}OYa(){this.Idc=!1;Ba.a.J(591538017,822,15,"CaptionDiscoverabilityPaneActor::OnUnsupported mediaDevices API not available for browser: {0}",
v.a.Ly)}em(){const a=this.jC(),b=Object.assign(new ju.a,{title:ResourceStrings.l_CaptionDiscoverabilityPane,hideHeader:!1,width:320,location:2,contentProps:a,onOpen:()=>{Ba.a.J(591538015,822,50,"CaptionDiscoverabilityPaneActor::ShowPane")},onClose:()=>{Ba.a.J(591738121,822,50,"CaptionDiscoverabilityPaneActor::ClosePane")},isModernPane:!0});this.jE.H8(Ua.a.YPa,Ua.a.nj,null,()=>{},()=>{});fj.UISurfaces.xr().then(c=>{c.showTaskPane(Ua.a.YPa,b);return null}).catch(c=>{Ba.a.J(591971348,822,10,"CaptionDiscoverabilityPaneActor::ShowPane exception: {0}",
c.toString())})}zr(){fj.UISurfaces.xr().then(a=>{a.hideTaskPane(Ua.a.YPa,2);return null}).catch(a=>{Ba.a.J(591971346,822,10,"CaptionDiscoverabilityPaneActor::HidePane exception: {0}",a.toString())})}jC(){return Object.assign(new nM,{podiumPresentationImageUrl:this.je.pk("CaptionDiscoverabilityPromptViewImage.png"),enableDoNotShowAgain:this.ISg,onTurnOnButtonClicked:Object(F.a)(this,this.onTurnOnButtonClicked,"onTurnOnButtonClicked"),onDismissButtonClicked:Object(F.a)(this,this.onDismissButtonClicked,
"onDismissButtonClicked"),onLaunchSlideShowButtonClicked:Object(F.a)(this,this.onLaunchSlideShowButtonClicked,"onLaunchSlideShowButtonClicked")})}onTurnOnButtonClicked(){zg.a("CaptionDiscoverabilityPaneTurnOn",M.a.HLa,()=>{let a=8;this.Hc.Kh||(a=this.ia.La(M.a.HLa,2,{}));this.e9j&&8!==a||this.zr();return a})}onDismissButtonClicked(){this.ISg&&(Lv.JZd=!0,Ba.a.J(591738117,822,50,"CaptionDiscoverabilityPaneActor::DoNotShowAgain"));this.zr()}onLaunchSlideShowButtonClicked(){zg.a("CaptionDiscoverabilityPaneLaunchSlideshow",
M.a.AMb,()=>{this.zr();return this.ia.processAction(M.a.AMb,2)})}R$(a,b){2!==b.vv&&3!==b.vv&&4!==b.vv||!b.G$||"SlideShow"!==b.G$||zg.a("OnRibbonTabSwitched",M.a.xqc,()=>this.ia.processAction(M.a.xqc,2))}mUi(){let a=0,b=!1,c=!1;for(var h of this.qc.h4b()){if(h.an){b=!0;break}if(h.qEa&&(a+=h.hQ.length,4<=a))break;if(h.r$a){c=!0;break}}h=c||b||4<=a;Ba.a.J(591738113,822,50,"CaptionDiscoverabilityPaneActor::FMeetsIntentToPresent - Result: {0}; Animation Count: {1}; Hidden slide: {2}, Transition: {3}",
h.toString(),a.toString(),b.toString(),c.toString());return h}nUi(){return!this.Hc.Kh&&this.VTi()}VTi(){const a=Fa.a.ue(u.AFrameworkApplication.lcid);return!a||ta.a.Wa(a.name)?!1:a.name.toLowerCase()===this.Hc.Eoa}static get Gie(){var a=oi.a.get("PPTCaptionDiscoverabilityLastShownTime");if(!a)return!1;const b=new Date;a=new Date(decodeURIComponent(a));return 14>(+b-+a)/864E5}static set Gie(a){oi.a.SJ("PPTCaptionDiscoverabilityLastShownTime",(new Date).toUTCString(),oi.a.wJ)||Ba.a.J(591971344,822,
10,"Failed to set cookie for discoverability last shown time to {0}",a.toString())}static get JZd(){const a=oi.a.get("PPTCaptionDiscoverabiltyDoNotShowAgain");return a?"true"===a.toLowerCase():!1}static set JZd(a){oi.a.SJ("PPTCaptionDiscoverabiltyDoNotShowAgain",a.toString(),oi.a.wJ)||Ba.a.J(591971342,822,10,"Failed to set cookie for discoverability opt out to {0}",a.toString())}}Object(n.a)(Lv,"CaptionDiscoverabilityPaneActor",null,[227]);var oM=d(724);class at{constructor(a,b){this.id=a;this.version=
b}}Object(n.a)(at,"PackageAccessKey",null,[]);const Mv=a=>a?dd.c({["I"]:a.id,["V"]:a.version}):null;var mp=d(328),pM=d(948);class Px extends pM.a{constructor(a,b,c){super(a,b);this.raa=c}}Object(n.a)(Px,"ClipServiceShapeCopyParams",pM.a,[]);var kE=d(671),lE=d(707),mE=d(442);class Qx{constructor(a,b,c){this.ia=a;this.Fa=b;this.vHa=c}kQ(a){a=Qx.M4b(a);return this.vHa.x8b(this.Fa)&&!!a&&!!a.src}paste(a){u.AFrameworkApplication.LQ?mE.a(ResourceStrings.l_GenericDialogTitle,CommonUIStrings.l_NeedToSignIn,
null):this.ia.La(M.a.Hkc,2,a)}static M4b(a){if(!a||!a.tn)return Ba.a.J(558445148,826,15,"ImagePasteHandler: User attempted to paste null content."),null;a=a.tn.getElementsByTagName(cf.a.G8);if(!a.length)return null;a=a[0];return a.src?a:null}}Object(n.a)(Qx,"ImagePasteHandler",null,[382]);var Dm=d(430);class nE{constructor(){this.gbh=this.UZd=null}}Object(n.a)(nE,"PasteSlideAsImageData",null,[]);class oE{constructor(){this.pastedContent=this.lxa=null}}Object(n.a)(oE,"PasteSlideAsImageFromRibbonData",
null,[]);var pE=d(675);class qE extends Sys.EventArgs{constructor(a,b,c){super();this.Gp=a;this.Poi=b;this.Qoi=c}}Object(n.a)(qE,"UpdateCcpInfoEventArgs",Sys.EventArgs,[]);class qM{constructor(){this.ShapeId=this.Cid=this.Sid=0}}Object(n.a)(qM,"CopiedShape",null,[]);class rM{constructor(){this.Cid=this.Sid=0}}Object(n.a)(rM,"CopiedSlide",null,[]);class rE extends Vf.a{constructor(){super();this.Shapes=this.Slides=this.Location=this.CcpId=null;this.MultiSlideCopy=!1;this.PackageAccessKey=this.CcpCorrelation=
null}$k(){return 65}}Object(n.a)(rE,"CopyRequest",Vf.a,[]);class Rx{constructor(a,b,c,h,m,y,G,U,ja,va,Ta,fb,Db,gc,hc,Gc,Pc,yc,Vd,De,Wd,Ve,$e,Qf,lg,Hg,Qg,Sf){this.iwe=this.Cva=null;this.ia=a;this.fO=h;this.Fa=m;this.fc=y;this.ua=G;this.Jb=U;this.OL=yc;this.vi=ja;this.Vb=va;this.qx=Ta;this.jGa=fb;this.Fb=Db;this.Wj=gc;this.la=b;this.pa=hc;this.rrg=Gc;this.W$j=Vd;this.Ie=Pc;this.Sb=De;this.X$j=Wd;this.Lr=Ve;this.Pxe=this.la.ejg;this.hze=this.la.llh;this.zs=$e;this.Bc=Qf;this.JC=lg;this.Ev=Hg;this.AGg=
Qg;this.FL=Sf;if(!this.JC)throw Ba.a.J(512356641,826,10,"ClipServiceActor pastemanager is null"),Error.argumentNull("ClipServiceActor pastemanager is null");}vb(){this.ia.ra(M.a.PVd,nc.a.application,Object(F.a)(this,this.Zpj,"handleCopySlidesToClipService"),0);this.ia.ra(M.a.ngd,nc.a.application,Object(F.a)(this,this.W$d,"handlePasteSlidesFromClipService"),4);this.ia.ra(M.a.Ikc,nc.a.application,Object(F.a)(this,this.Isj,"handlePasteSlideKeepingDestinationThemeFromFloatie"),4);this.ia.ra(M.a.kHb,nc.a.application,
Object(F.a)(this,this.Jsj,"handlePasteSlideKeepingSourceFormattingFromFloatie"),4);this.ia.ra(M.a.dMe,nc.a.application,Object(F.a)(this,this.Yhd,"queryPasteOptions"),97);this.ia.ra(M.a.QGf,nc.a.application,Object(F.a)(this,this.Ypj,"handleCopyShapesToClipService"),0);this.ia.ra(M.a.o9g,nc.a.application,Object(F.a)(this,this.Fsj,"handlePasteShapesFromClipService"),4);this.ia.ra(M.a.q9g,nc.a.application,Object(F.a)(this,this.V$d,"handlePasteSlideFromDesktop"),4);this.ia.ra(M.a.mgd,nc.a.application,
Object(F.a)(this,this.Gsj,"handlePasteSlideAsImage"),4);this.ia.ra(M.a.p9g,nc.a.application,Object(F.a)(this,this.Hsj,"handlePasteSlideAsImageFromRibbon"),4);this.ia.ra(M.a.ZJf,nc.a.application,Object(F.a)(this,this.$pj,"handleCutShapes"),4);this.ia.ra(M.a.P0d,nc.a.application,Object(F.a)(this,this.P0d,"expandPasteFloatieMenu"),96);this.ia.ra(M.a.$Jf,xb.a.application,Object(F.a)(this,this.aqj,"handleCutSlides"),4);this.ia.ra(M.a.t9g,xb.a.application,Object(F.a)(this,this.ysj,"handlePasteCancelledByUser"),
2048)}De(){}Hsj(a,b,c,h,m){Ba.a.J(512356640,826,50,"HandlePasteSlideAsImageFromRibbon called");a=Object(ua.a)(oE,m);if(!a||!a.lxa)return Ba.a.J(512356639,826,10,"HandlePasteSlideAsImageFromRibbon pasteSlideAsImageFromRibbonData is invalid"),8;if(1===c)return 32;c=a.lxa.Ub;b=this.Bc.eP(2,1,"HandlePasteSlideAsImageFromRibbon");this.Bc.Yh("PasteSlideAsImageFromRibbon",c,b);a.lxa.Ub=b;this.JC.paste(a.lxa,a.pastedContent,!0);return 32}Gsj(a,b,c,h,m){a=Object(ua.a)(nE,m);if(!a||!a.UZd)return Ba.a.J(512356638,
826,10,"HandlePasteSlideAsImage PasteSlideAsImageData is null"),8;if(1===c)return 32;this.JC.mgd(a.UZd,a.gbh);return 32}P0d(a,b,c){if(1===c)return 32;this.W$j.TIk();return 32}Yhd(a,b,c,h,m){if(!this.Lr||!this.Lr.Ngb)return 8;a=this.Lr.Ngb.sA;m.SourceControlId&&("PasteSlideKeepDestinationFromClipService"===m.SourceControlId?m[Zh.a.On]=null!=a&&!a:"PasteSlideKeepSourceFromClipService"===m.SourceControlId&&(m[Zh.a.On]=null!=a&&a));return 32}Jsj(a,b,c,h){if(1===c)return 32;const m=this.Lr.Ngb;if(!m)return 8;
const y=m.uu,G=m.qM;if(!y&&!G)return 8;if(null!=m.sA&&m.sA)return 32;m.Ub=this.Bc.eP(2,2,"HandlePasteSlideKeepingSourceFormattingFromFloatie");m.sA=!0;const U=this.Sb.mC(this.Lr.lIe);Ba.a.J(512356637,307,50,"HandlePasteSlideKeepingSourceFormattingFromFloatie - KeepSource set to true");if(G)return G.skipUndo=!0,G.selectionSlide=U,this.V$d(a,b,c,h,m);y.skipUndo=!0;y.selectionSlide=U;return this.W$d(a,b,c,h,m)}Isj(a,b,c,h){if(1===c)return 32;const m=this.Lr.Ngb;if(!m)return 8;const y=m.uu,G=m.qM;if(!y&&
!G)return 8;if(null!=m.sA&&!m.sA)return 32;m.Ub=this.Bc.eP(2,2,"HandlePasteSlideKeepingDestinationThemeFromFloatie");m.sA=!1;const U=this.Sb.mC(this.Lr.lIe);Ba.a.J(512356636,307,50,"HandlePasteSlideKeepingDestinationThemeFromFloatie - KeepSource set to false");if(G)return G.skipUndo=!0,G.selectionSlide=U,this.V$d(a,b,c,h,m);y.skipUndo=!0;y.selectionSlide=U;return this.W$d(a,b,c,h,m)}Ypj(a,b,c,h,m){a=Object(ua.a)(Px,m);if(!a)return Ba.a.J(512356635,307,50,"ClipServiceCopyParams are null."),8;b=a.uu;
c=a.raa;if(!b||!c||!c.length)return Ba.a.J(512356634,307,50,"Copied shapes are empty."),this.Bc.Gg(!1,a.Ub,23),8;if(this.fc.dUa())return this.Bc.Gg(!1,a.Ub,2),16;if(Ma.a.any(c,G=>G.L3))return Ba.a.J(512356633,826,15,"HandleCopyShapesToClipService: deferred content detected."),8;h=[];for(var y of c)h.push(Object.assign(new qM,{Sid:y.slideSid,Cid:y.slideCid,ShapeId:y.get_shapeId()}));y=Object.assign(new rE,{CcpId:b.Gp,Location:b.location,Shapes:h,CcpCorrelation:a.Ub,PackageAccessKey:Mv(new at(a.uu.ty,
b.version))});this.gOc(y,2,a.Ub);return 32}Fsj(a,b,c,h,m){b=Object(ua.a)(Dm.a,m);if(!b)return 8;3!==b.uu.dataType?this.Bc.CB(2,b.Ub):(this.Bc.CB(7,b.Ub),this.Bc.Ew(5,b.Ub));c=b.uu;if(!c)return this.Bc.Gg(!1,b.Ub,16),Ba.a.J(512356632,307,50,"HandlePasteShapesFromClipService: Cross-session pasted shapes are empty."),8;3!==b.uu.dataType&&this.Bc.Ew(lE.ClipboardHelper.Peg(c)?2:3,b.Ub);h=this.ua.Ba;if(!h||!h.isConnected)return this.Bc.Gg(!1,b.Ub,3),Ba.a.J(512356631,307,50,"HandlePasteShapesFromClipService: targetSlide: {0}.",
h?"not null":"null"),16;if(this.fc.$c(h))return this.Bc.Gg(!1,b.Ub,3),Ba.a.J(512356630,307,50,"HandlePasteShapesFromClipService: failed since the targetSlide is blocked."),2;if(!this.Wj.JF(h,c.objectCount))return this.Bc.Gg(!1,b.Ub,8),Ba.a.J(512356629,307,50,"HandlePasteShapesFromClipService: failed since there are too many shapes on the target slide."),this.Wj.hG(h),16;this.UMd(c.Gp,b.Ub);Nc.a.mza("PasteShapesFromClipService",!0);Nc.a.kP(!1,!1);this.iwe&&this.iwe===c.Gp||(this.Cva=new Nd.a(0));h.lN=
c.Gp;h.YP=c.location;h.O2=c.mD;h.SZ=Rx.Y_e(c.Dsa);h.ty=Mv(new at(c.ty,c.version));m=null;this.Bc.V9b(b.Ub)&&(m=Qx.M4b(b));if(this.hze&&3===b.uu.dataType)try{let y=0;this.Cva&&this.Cva.Hb(h.Cb)&&(y=this.Cva.ga(h.Cb));this.fc.aRd(h,a,y);Ba.a.J(512356628,307,50,"HandlePasteShapesFromClipService: shimmer view successful")}catch(y){Ba.a.J(512356627,307,10,"HandlePasteShapesFromClipService: failed to show shimmer view")}this.jGa.eHi(h,c,this.Cva,a,b.Ub,m);this.iwe=c.Gp;this.Bc.Gg(!0,b.Ub);return 32}$pj(a,
b,c,h,m){if(this.fc.dUa())return 16;if(1===c)return 32;Nc.a.kP(!0,!0);const y=this.pa.sg();b=this.pa.sk();var G=h=c=null;let U=[];m=Object(ua.a)(Px,m);if(!m)return 8;if(m.uu){var ja=m.uu;U=m.raa;if(!U||!U.length)return 8;c=ja.Gp;G=ja.version;h=ja.location;G=Mv(new at(ja.ty,G))}else for(ja of y)ja.m_c&&U.push(ja);for(var va of U)if(va.Jf||va.Kg){gn(va);break}va=this.Jb.zd(15,void 0,()=>{this.pa.Qh()});try{va.nc(b),va.jd=a,this.rrg.weh(new qE(c,h,G)),b.Ub=m.Ub,b.KU(U)}finally{va&&va.dispose()}for(const Ta of U)this.zs.eeh(new KJ.a(Ta));
this.fO.Lle=c;return 32}aqj(a,b,c,h,m){b=this.pa.We();if(!b||!b.length||!this.ua.Ba)return 16;for(var y of b)if(!y||this.fc.$c(y)||!y.isConnected)return 16;if(1===c)return 32;Nc.a.Ib&&(Nc.a.Ib.actionName="CutSlide",Nc.a.Ib.Qr=!1,Nc.a.Ib.Nj=!0,Nc.a.Ib.pF=new Date,Nc.a.Ib.Va("SlideCount",b.length.toString()));h=y=c=null;var G=[];m=Object(ua.a)(kE.a,m);if(!m)return 8;if(m.uu){h=m.uu;G=m.gwh;if(!G||!G.length)return 8;c=h.Gp;G=h.version;y=h.location;h=Mv(new at(h.ty,G))}G=this.Vb.Cf;if(!G)return 16;const U=
this.Jb.zd(15,void 0,()=>{this.pa.Qh()});try{this.rrg.weh(new qE(c,y,h));U.nc(G);for(const ja of b)ja&&!ja.Cb.equals(this.ua.Ba.Cb)&&G.qI(ja);G.qI(this.ua.Ba);U.jd=a;G.Ub=m.Ub}finally{U&&U.dispose()}this.la.unblockContentWhenDeletingSlideEnabled||this.fc.Zv(G,a);this.zs?this.zs.ljd(new pE.a(b)):Ba.a.J(512356626,826,10,"HandleCutSlides: graphOperationEventNotifier is null for raising event.");this.fO.Lle=c;return 32}gOc(a,b){this.fO.mmk(a);var c=[String.format("{0}={1}","CcpId",a.CcpId),String.format("{0}={1}",
mp.a.type,oM.a(b))];Nc.a.xk("CcpId",a.CcpId);c=new Rh.a(a,()=>{this.unk(a)},h=>this.tnk(h,a,b),h=>0===h.StatusCode,void 0,c);Ba.a.J(512356625,307,50,String.format("Created task: {0} for ccpid: {1}",c.id,a.CcpId));this.vi.Eb(c)}unk(a){this.fO.U0g(!0,a)}tnk(a,b,c){Ba.a.J(512356624,307,10,String.format("Failed to copy {0} for ccpid: {1} with statuscode: {2}.",oM.a(c),b.CcpId,a.StatusCode));this.fO.U0g(!1,b);return!0}UMd(a,b){const c=Nc.a.Ib;c&&(c.Va("CcpId",a),this.Bc.Yh("CcpId",a,b))}Zpj(a,b,c,h,m){a=
Object(ua.a)(kE.a,m);if(!a||!a.uu)return Ba.a.J(512356623,307,50,"HandleCopySlidesToClipService: either copyParams '{0}' or copyParams.ClipServiceObject is null.",a?"not null":"null"),8;Ba.a.J(512356622,307,50,"HandleCopySlidesToClipService: executing for ccpid: {0}",a.uu.Gp);b=a.gwh;if(!b||!b.length||0>=zi.e(b,y=>Object(za.a)(116,y)).length)return Ba.a.J(512356621,307,50,"HandleCopySlidesToClipService: no slide is copied"),8;if(Ma.a.any(b,y=>y.hasDeferredContent))return Ba.a.J(512356620,826,15,"HandleCopySlidesToClipService: trying to copy slides with deferred content to clipboard service"),
8;b=Object.assign(new rE,{CcpId:a.uu.Gp,Location:a.uu.location,MultiSlideCopy:!0,Slides:zi.c(b,y=>Object.assign(new rM,{Sid:y.sid,Cid:y.cid})),CcpCorrelation:a.Ub,PackageAccessKey:Mv(new at(a.uu.ty,a.uu.version))});this.gOc(b,1,a.Ub);return 32}V$d(a,b,c,h,m){if(1===c)return 32;b=Object(ua.a)(Dm.a,m);if(!b)return Ba.a.J(512356619,826,10,"HandlePasteSlideFromDesktop: PasteParams is null."),8;c=b.qM;if(!c||ta.a.Wa(c.ccpid)||ta.a.Wa(c.data))return Ba.a.J(512356618,826,10,String.format("HandlePasteSlideFromDesktop: Invalid pickling data ccpid: {0}",
c?c.ccpid:"null")),this.Bc.Gg(!1,b.Ub,28),8;Nc.a.mza("PasteSlideFromDesktop",!0);this.UMd(c.ccpid,b.Ub);this.Bc.Ew(12,b.Ub);h={};h.CcpCorrId=b.Ub;return this.H8f(b,a,c.skipUndo,c.selectionSlide,c.objectCount,null!=b.sA?b.sA:!0,c.ccpid,null,null,u.AFrameworkApplication.userSessionId,0,h,c.data,c.isDataCompressed)}W$d(a,b,c,h,m){if(1===c)return 32;b=Object(ua.a)(Dm.a,m);if(!b)return Ba.a.J(51520671,307,10,"HandlePasteSlidesFromClipService: PasteParams is null."),8;Nc.a.mza("PasteSlidesFromClipService",
!0);c=b.uu;if(!c)return this.Bc.Gg(!1,b.Ub,16),Ba.a.J(512356617,307,10,"HandlePasteSlidesFromClipService: Cross-session pasted slides are empty."),8;this.Bc.Ew(lE.ClipboardHelper.Peg(c)?2:3,b.Ub);this.UMd(c.Gp,b.Ub);h=this.qx.Ghe(c);return!this.la.$ig&&h?(this.Bc.Gg(!1,b.Ub,17),Ba.a.J(34481168,307,10,"HandlePasteSlidesFromClipService: Don't support cross-dc paste slide: {0}",c),16):this.H8f(b,a,c.skipUndo,c.selectionSlide,c.objectCount,null!=b.sA?b.sA:!0,c.Gp,c.location,c.mD,c.ty,c.version,c.Dsa,
null,!1)}H8f(a,b,c,h,m,y,G,U,ja,va,Ta,fb,Db,gc){this.Bc.CB(19,a.Ub);const hc=this.ua.presentation;if(!hc)return this.Bc.Gg(!1,a.Ub,3),Ba.a.J(512356616,307,10,"HandlePasteSlide: Failed because presentation node is null"),16;if(this.fc.$c(hc))return this.Bc.Gg(!1,a.Ub,3),Ba.a.J(512356615,307,10,"HandlePasteSlide: Can't continue because the presentation was being blocked."),2;var Gc=this.ua.Ba;if(Gc&&!Gc.isConnected)return this.Bc.Gg(!1,a.Ub,3),Ba.a.J(512356614,307,10,"HandlePasteSlide: Failed since the selected slide is disconnected."),
16;Ba.a.J(512356613,307,50,String.format("HandlePasteSlide skipUndo: {0} and keepSource value is: {1}",c.toString(),y.toString()));this.Pxe&&!this.qx.yeg(a)&&this.X$j.w6h();this.Lr.m0c=Date.now();this.OL.SW(this.Sb.Pn)&&Ba.a.J(512356612,307,50,"cross session paste slide happened before last action server result is not returned");Nc.a.kP(!1,!1);let Pc;var yc=null;Gc=this.la.Qpd&&!ta.a.Wa(Db)&&1!==this.Fb.Sl;if(c)yc=h,Pc=null;else{yc=this.ua.presentation;if(!yc)throw Error.argumentNull("Presentation is null");
Pc=Array.isArray(yc.$If(m,a.Ub,Gc))?yc.$If(m,a.Ub,Gc):null;h=yc=this.Odj();this.Lr.position=null;this.Lr.lIe=yc?yc.slideIndex:0}m=null;c||(m=()=>{let Vd;(Vd=this.pa).WU.apply(Vd,Pc)});m=this.Jb.zd(15,void 0,()=>{this.Fa.xf(Ua.a.UE)},m);try{if(m.nc(hc),m.jd=c?hc.dbb?M.a.kHb:M.a.Ikc:b,Gc?(hc.Wta=!0,this.Ev.init(G)):(hc.lN=G,hc.dbb=y,hc.jIe=yc?yc.Cb:null,hc.YP=U,hc.O2=ja,hc.SZ=Rx.Y_e(fb),hc.skipUndo=c,hc.ty=Mv(new at(va,Ta)),hc.fzb=null==gc?!1:gc,hc.Jkc=Db,hc.Ub=a.Ub),!c){U=yc;for(ja=0;ja<Pc.length;ja++)this.la.Ks?
hc.P$a(Pc[ja],U,null,!0):hc.P$a(Pc[ja],U,null),U=Pc[ja],Gc&&(Pc[ja].Wta=!0,this.Ev.aka.add(Pc[ja].id));this.Vb.Ba=Pc[Pc.length-1];this.Ie.U7a=!0}}finally{m&&m.dispose()}Gc?(this.Ev.etd(!0),this.fc.blockContent(hc,b)):this.fc.Zv(hc,b);this.Lr.Ngb=a;this.Lr.Sjb=!0;this.Lr.kJa=null;this.Ie.U7a=!0;this.Lr.e1b=this.Sb.Pn.VJ;Gc&&(this.Bc.Yh("DisplayNewPasteProgressUX","true",a.Ub),this.fIi(Db,u.AFrameworkApplication.userSessionId,yc,c,y,G,fb,gc,a.Ub));this.Bc.Gg(!0,a.Ub);return 32}fIi(a,b,c,h,m,y,G,U,ja){const va=
this.Bc.eP(2,0,"DataUploadInit");this.Bc.Ew(13,va);this.Bc.CB(19,va);this.Bc.Yh("DataUploadInitOldCcpCorrId",ja,va);this.Ev.wxl(va);const Ta=(new Date).getTime();this.AGg.kll(a,b,y,()=>{const fb=(new Date).getTime()-Ta;Ba.a.J(512356611,826,50,"DataUploadInit: Upload pasted data successful for ccpid: {0} time: {1}",y,fb);this.Bc.Yh("DataUploadTime",fb.toString(),va);this.eIi(va,b,c,h,m,y,G,U)},fb=>{Ba.a.J(512356610,826,10,"DataUploadInit: Upload pasted data failed for ccpid: {0}, error:{1} time: {2}",
y,yg.a[fb.error.Code],(new Date).getTime()-Ta);this.bqj();this.Bc.Gg(!1,va,30)})}eIi(a,b,c,h,m,y,G,U){const ja=this.ua.presentation;if(ja){this.Ev.qkk();Nc.a.kP(!1,!1);Ba.a.J(512356608,307,50,"DataUploadFinish: FakeSlideIds: {0}",this.Ev.aka.toArray().join(",").toString());var va=this.Jb.zd(15);try{va.nc(ja),va.jd=M.a.kHb,ja.jIe=c?c.Cb:null,ja.c_b=b,ja.Kkc=this.Ev.aka.toArray().join(",").toString(),ja.lN=y,ja.SZ=Rx.Y_e(G),ja.skipUndo=h,ja.fzb=null==U?!1:U,ja.dbb=m,ja.Ub=a}finally{va&&va.dispose()}this.Bc.Gg(!0,
a)}else Ba.a.J(512356609,307,10,"DataUploadFinish: Failed because presentation node is null")}ysj(a,b,c,h,m){if(1===c)return 32;if(!(m&&"UploadId"in m&&"CcpCorrId"in m))return Ba.a.J(512356579,307,10,"HandlePasteCancelledByUser: actionDataDictionary invalid {0}",m),8;a=m.UploadId;m=m.CcpCorrId;Ba.a.J(512356578,307,50,"HandlePasteCancelledByUser: uploadId: {0}",a);this.AGg.zoi(a);this.Bc.Gg(!1,m,31);return 32}bqj(){this.Ev.qBf(!0);this.FL.Tfa(ResourceStrings.l_SomethingWentWrongCalloutTitle,ResourceStrings.errorTitle_PasteSlideFailed,
!1,null,!1,null,0,0,null,null,!0,20)}xjl(a){a.sort((b,c)=>c.slideIndex-b.slideIndex)}Odj(){const a=this.pa.We();return 0<a.length&&(this.xjl(a),a[0])?a[0]:this.ua.Ba}static Y_e(a){return JSON.stringify(a)}}Object(n.a)(Rx,"ClipServiceActor",null,[227]);class sE{constructor(){this.actionId=0;this.context=null;this.behavior=0;this.rd=this.KJ=null}}Object(n.a)(sE,"AActionArgs",null,[]);class tE extends sE{constructor(){super()}}Object(n.a)(tE,"ActionArgs$2",sE,[]);class uE extends tE{constructor(){super()}}
Object(n.a)(uE,"ActionArgs$1",tE,[]);var Aq=d(388),mu=d(381);class bt{constructor(a,b=!1){this.ffg=!0;this.Ub=null;this.dataType=0;this.kUi=a;this.Yta=b}}Object(n.a)(bt,"CutCopyParams",null,[]);var Nv=d(441),sM=d(531);class Xz{constructor(a,b,c,h){this.ia=a;this.o9j=h;this.vHa=c;this.Fa=b}kQ(a){return this.vHa.x8b(this.Fa)&&!!Xz.D_f(a)}paste(a){this.o9j?mE.a(ResourceStrings.l_GenericDialogTitle,CommonUIStrings.l_NeedToSignIn,null):(Ba.a.J(17310402,826,50,"TablePasteHandler: Execute command to paste table from clipboard."),
this.ia.La(M.a.mxa,2,a))}static D_f(a){return a&&a.tn?(a=a.tn.getElementsByTagName(cf.a.hNb))&&a.length?a[0]:null:null}}Object(n.a)(Xz,"TablePasteHandler",null,[382]);class Tk{static get wA(){return vb.a.instance.rb("PowerPointWebEditor.ISystemClipboard")}}Object(n.a)(Tk,"SystemClipboardFactory",null,[]);class tM{constructor(a,b,c,h,m,y,G,U,ja,va,Ta,fb,Db,gc,hc,Gc,Pc,yc,Vd,De,Wd,Ve,$e,Qf,lg,Hg,Qg){this.Cva=this.I6c=null;this.Eug=0;if(!Qg)throw Error.argumentNull("DeferredContentManager");this.ia=
a;this.Fa=b;this.pa=c;this.lh=Db;this.fc=va;this.xla=Ta;this.JC=fb;this.Vb=h;this.jq=m;this.vw=Qg;this.Jb=y;this.$z=G;this.Hq=ja;this.jGa=gc;this.Sb=hc;this.Tk=Gc;this.Fb=Pc;this.Btg=yc;this.Ubb=Vd;this.Wj=De;this.OT=Wd;this.oWa=$e;this.zb=Qf;this.I9=lg;this.Bc=Hg;this.la=U}vb(){this.la.HXc?(this.ia.ra(M.a.Ktb,nc.a.application,Object(F.a)(this,this.U7f,"handleCutCopyToSystemClipboardAsync"),4),this.ia.ra(M.a.l0b,nc.a.application,Object(F.a)(this,this.U7f,"handleCutCopyToSystemClipboardAsync"),0),
this.ia.ra(M.a.Fkc,nc.a.application,Object(F.a)(this,this.GUc,"handlePasteFromSystemClipboardAsync"),4),this.ia.ra(M.a.gJa,nc.a.application,Object(F.a)(this,this.GUc,"handlePasteFromSystemClipboardAsync"),4),this.ia.ra(M.a.hJa,nc.a.application,Object(F.a)(this,this.GUc,"handlePasteFromSystemClipboardAsync"),4),this.ia.ra(M.a.VYa,nc.a.application,Object(F.a)(this,this.GUc,"handlePasteFromSystemClipboardAsync"),4)):(this.ia.ra(M.a.Ktb,nc.a.application,Object(F.a)(this,this.T7f,"handleCutCopyToSystemClipboard"),
4),this.ia.ra(M.a.l0b,nc.a.application,Object(F.a)(this,this.T7f,"handleCutCopyToSystemClipboard"),0),this.ia.ra(M.a.Fkc,nc.a.application,Object(F.a)(this,this.FUc,"handlePasteFromSystemClipboard"),4),this.ia.ra(M.a.gJa,nc.a.application,Object(F.a)(this,this.FUc,"handlePasteFromSystemClipboard"),4),this.ia.ra(M.a.hJa,nc.a.application,Object(F.a)(this,this.FUc,"handlePasteFromSystemClipboard"),4),this.ia.ra(M.a.VYa,nc.a.application,Object(F.a)(this,this.FUc,"handlePasteFromSystemClipboard"),4));this.ia.ra(M.a.PGf,
nc.a.application,Object(F.a)(this,this.Xpj,"handleCopyShapes"),0);this.ia.ra(M.a.kgd,xb.a.application,Object(F.a)(this,this.Esj,"handlePasteShapes"),4);this.ia.ra(M.a.Hkc,nc.a.application,Object(F.a)(this,this.Dsj,"handlePastePicture"),4);this.ia.ra(M.a.mxa,xb.a.application,Object(F.a)(this,this.Lsj,"handlePasteTable"),4);this.ia.ra(M.a.lgd,nc.a.application,Object(F.a)(this,this.Ksj,"handlePasteSlides"),4);this.ia.ra(M.a.oIe,nc.a.application,Object(F.a)(this,this.Msj,"handlePasteTextIntoNewShape"),
4);this.ia.WV(M.a.$$g,nc.a.application,Object(F.a)(this,this.tpj,"handleBrowserCut"),4);this.ia.WV(M.a.Zgd,nc.a.application,Object(F.a)(this,this.spj,"handleBrowserCopy"),0);this.ia.WV(M.a.$gd,nc.a.application,Object(F.a)(this,this.upj,"handleBrowserPaste"),4);this.ia.WV(M.a.jah,nc.a.application,Object(F.a)(this,this.Bsj,"handlePasteGivenText"),4);this.ia.ra(M.a.b9g,nc.a.application,Object(F.a)(this,this.Asj,"handlePasteContentFromPandora"),4);this.ia.ra(M.a.fJa,xb.a.application,Object(F.a)(this,
this.handlePasteHtml,"handlePasteHtml"),4);this.ia.ra(M.a.igd,xb.a.application,Object(F.a)(this,this.Csj,"handlePasteHtmlAsync"),4);this.ia.ra(M.a.NVd,he.a.frame,Object(F.a)(this,this.zsj,"handlePasteChartAsImage"),4);this.ia.ya(M.a.ZXd,he.a.frame,Object(F.a)(this,this.S7f,"handleCutCopyThroughShortcuts"));this.ia.ya(M.a.SGf,he.a.frame,Object(F.a)(this,this.S7f,"handleCutCopyThroughShortcuts"));this.ia.ra(M.a.s9g,he.a.frame,Object(F.a)(this,this.Nsj,"handlePasteThroughShortcuts"),4)}De(){if(Rd.a("ShortcutsFixInMac")&&
v.a.Z9b){const a=[this.Fa.Gc(Di.a.JD),this.Fa.Gc(Ua.a.rg)];for(const b of a)b.bindAction(w.KeyInputManager.Na(z.a.yza,w.KeyInputManager.Le),M.a.SGf),b.bindAction(w.KeyInputManager.Na(z.a.v1a,w.KeyInputManager.Le),M.a.s9g)}}S7f(a){a=M.a.ZXd===a;const b=this.Bc.eP(a?1:0,0,a?"OnBrowserCut":"OnBrowserCopy");this.xla.ssa(Object.assign(new bt(!1,a),{Ub:b}));return 32}Nsj(){const a=this.Bc.eP(2,0,"OnBrowserPaste");this.JC.paste(Object.assign(new Dm.a(!0),{Ub:a}),null,!1);return 32}U7f(a,b,c,h){let m,y;if(!({qF:m,
DLc:y}=this.kGf(c,a)).returnValue)return m;if(!Tk.wA)return this.Bc.Gg(!1,y.Ub,1),8;this.Fca(a,b,c,h,!0,y.Ub);return 32}GUc(a,b,c,h){if(1===c)return this.pa.ZTa()?2:a===M.a.gJa?2:a===M.a.hJa?this.fqc(!1):a===M.a.VYa?this.fqc(!0):32;const m=this.Bc.eP(2,1,"HandlePasteFromSystemClipboardAsync");if(this.pa.W8())return this.Bc.Gg(!1,m,3),16;if(!Tk.wA)return this.Bc.Gg(!1,m,1),8;this.Fca(a,b,c,h,!1,m);Nc.a.kP(!0,!1);return 32}fqc(a){Ba.a.J(512356577,826,50,"ShouldEnablePasteAsOptions called");return this.pa.O8()?
(Ba.a.J(512356576,826,15,"ShouldEnablePasteAsOptions: inside textbox hence disabled"),2):this.JC.Ipi(a)?32:2}sNf(a,b){a===M.a.Ktb?this.xla.ssa(Object.assign(new bt(!1,!0),{Ub:b})):a===M.a.l0b?this.xla.ssa(Object.assign(new bt(!1),{Ub:b})):a===M.a.Fkc?this.JC.paste(Object.assign(new Dm.a(!1),{Ub:b}),null,!1):a===M.a.gJa?this.JC.paste(Object.assign(new Dm.a(!1),{Ub:b,sA:!1}),null,!1):a===M.a.hJa?this.JC.paste(Object.assign(new Dm.a(!1),{Ub:b,sA:!0}),null,!1):a===M.a.VYa?this.JC.paste(Object.assign(new Dm.a(!1),
{Ub:b,j8a:!0}),null,!1):(Ba.a.J(512356575,826,50,"Only Copy or Paste command are accepted."),this.Bc.Gg(!1,b,5))}Fca(a,b,c,h,m,y){Tk.wA.Fca(m);m=Tk.wA.J5;null!=m&&m?this.sNf(a,y):(a=new Sh.a(null,Object(F.a)(this,this.g4e,"waitingForEnsureAccessOperationResult"),Object.assign(new uE,{actionId:a,context:b,behavior:c,KJ:h,rd:y})),a.Nl("ClipboardPreProcess"),this.Eug=Date.now(),a.run())}g4e(a,b){a=!0;let c=!1;const h=b.rd.toString(),m=Tk.wA.J5,y=Tk.wA.ay;null!=m?(a=!1,m?this.sNf(b.actionId,h):c=!0):
Date.now()-this.Eug>this.la.MCf&&null!=y&&(Ba.a.J(512356574,826,15,"Timeout while trying to execute SystemClipboardAccessManager.EnsureSystemClipboardAccess method."),a=!1,c=!0);c&&this.Bc.Gg(!1,h,29);return a}T7f(a,b,c){if(!({qF:a,DLc:b}=this.kGf(c,a)).returnValue)return a;this.xla.ssa(b);return 32}kGf(a,b){let c;c=32;const h=M.a.Ktb===b;b=new bt(!1,h);const m=!!this.xla&&this.xla.kQ(b);if(1===a)return c=this.pa.ZTa()?2:m?32:16,{returnValue:!1,qF:c,DLc:b};a=this.Bc.eP(h?1:0,1,"HandleCutCopyToSystemClipboard");
this.Bc.Ew(1,a);b.Ub=a;return!m||this.fc.dUa()?(this.Bc.Gg(!1,a,2),{returnValue:!1,qF:16,DLc:b}):{returnValue:!0,qF:c,DLc:b}}FUc(a,b,c){if(1===c)return this.pa.ZTa()?2:a===M.a.gJa?this.fqc(!1):a===M.a.hJa?this.fqc(!1):a===M.a.VYa?this.fqc(!0):32;b=this.Bc.eP(2,1,"HandlePasteFromSystemClipboard");c=this.jq.Ba;if(!c||this.fc.$c(c)||this.pa.W8())return this.Bc.Gg(!1,b,3),16;c=null;let h=!1;a===M.a.gJa?c=!1:a===M.a.hJa?c=!0:a===M.a.VYa&&(h=!0);this.JC.paste(Object.assign(new Dm.a(!1),{Ub:b,sA:c,j8a:h}),
null,!1);return 32}Xpj(a,b,c){if(this.fc.dUa())return 16;if(1===c)return 32;a=this.pa.sg();for(const h of a)if(h.Jf||h.Kg){gn(h);break}this.Wyl(a);return 32}Wyl(a){if(!a||!a.length)this.Cva=this.I6c=null;else if(!this.I6c||!this.Hei(this.I6c,a)){const b=[];for(const c of a)b.push(c);this.Cva=new Nd.a(0);this.Cva.$(b[0].slideId,1);this.I6c=b}}Hei(a,b){if(a.length!==b.length)return!1;for(let c=0;c<b.length;c++)if(a[c]!==b[c])return!1;return!0}Jhj(a,b,c,h){let m;m=b?b.twb(110,75):this.Sb.pta(c.clientWidth,
c.clientHeight);a=this.Tk.PWd(a.Cb.cid,a.Cb.sid,!0,m._x,m._y,c.width,c.height,a.Pt()+1,c.src,c.alt&&c.alt.length?c.alt:"image",h);b&&(a.eca=b.id);return a}Dsj(a,b,c,h,m){b=this.jq.Ba;if(!b)return Ba.a.J(512356573,826,50,"Active Slide is null"),8;if(1===c)return this.fc.$c(b)?16:32;if(!m)return 16;this.Bc.CB(5,m.Ub);if(!this.Wj.JF(b,1))return this.Bc.Gg(!1,m.Ub,8),this.Wj.hG(b),16;Nc.a.mza("PastePicture",!1);h=Qx.M4b(m);if(!h||!h.src)return this.Bc.Gg(!1,m.Ub,10),8;if((c=b.n3(this.pa.Xd()))&&this.fc.$c(c))return this.Bc.Gg(!1,
m.Ub,3),16;const y=this.Jhj(b,c,h,m.Ub);h=this.Jb.zd(15,void 0,()=>{this.pa.Vx();this.Fa.Ed()},()=>{this.pa.selectShape(y,!0)});try{h.nc(b),h.jd=a,h.Py[wq.a.W6b]=!0,c&&b.KU([c]),b.UB(y)}finally{h&&h.dispose()}this.Bc.Gg(!0,m.Ub);return 32}H2i(){if(!this.jq.Ba)return null;const a=this.jq.Ba.Pk();for(const b of a)if(b.kIc)return b;return null}Lsj(a,b,c,h,m){b=this.jq.Ba;if(!b)return Ba.a.J(512356572,826,50,"Active Slide is null"),8;if(1===c)return b&&!this.fc.$c(b)?32:16;if(!m)return 8;this.Bc.CB(6,
m.Ub);if(!this.Wj.JF(b,1))return this.Wj.hG(b),this.Bc.Gg(!1,m.Ub,8),16;const y=this.H2i();if(y){if(this.fc.$c(y))return this.Bc.Gg(!1,m.Ub,3),16;if(y.KI)return Ba.a.J(512356571,826,50,"Unable to block placeholder because the shape {0} is changing ShapeIds",y.id),this.Bc.Gg(!1,m.Ub,3),32}h=Xz.D_f(m);if(!(h&&h.innerHTML&&h.rows&&h.rows.length&&h.getElementsByTagName(cf.a.Vqd).length))return this.Bc.Gg(!1,m.Ub,24),8;c=document.createElement("div");if(!c)return this.Bc.Gg(!1,m.Ub,24),8;c.appendChild(h.cloneNode(!0));
c=c.innerHTML;if(!c||0>=c.length)return this.Bc.Gg(!1,m.Ub,24),8;Ba.a.J(512356570,826,50,"Paste table with {0} rows, table length {1}",h.rows.length,c.length);var G=this.J0f();h=G.x-55;G=G.y-37.5;if(y){b=this.Jb.zd(15,void 0,()=>{this.pa.Vx();this.pa.Qh();this.Fa.Ed()},()=>{this.pa.selectShape(y,!0)});try{b.nc(y),b.jd=a,b.Py[wq.a.X6b]=!0,y.Ub=m.Ub,y.YYa=c}finally{b&&b.dispose()}this.fc.Zv(y,a)}else c=b.tEi(h,G,b.Pt()+1,c,m.Ub),c.Ub=m.Ub,this.$z.zW([Object(ua.a)(4,c)],Object(ua.a)(116,b),a);this.Bc.Gg(!0,
m.Ub);return 32}Csj(a,b,c,h,m){if(1===c)return 32;b=m?Object(ua.a)(sM.a,m):null;if(!b)return Ba.a.J(512356569,826,50,"Html paste context should not be null."),8;c=this.jq.Ba;if(!c)return Ba.a.J(512356568,826,50,"Active Slide is null"),8;if(!c||this.fc.$c(c))return this.Bc.Gg(!1,b.Ub,3),16;Nc.a.mza("PasteHtmlAsync",!0);Ba.a.J(512356567,826,50,"Paste html start");return this.xNf(b,c,a)}handlePasteHtml(a,b,c,h,m){if(1===c)return this.pa.ZTa()?2:32;const y=m?Object(ua.a)(sM.a,m):null;if(!y)return Ba.a.J(512356566,
826,50,"Html paste context should not be null"),8;b=this.jq.Ba;if(!b)return Ba.a.J(512356565,826,50,"Active Slide is null"),8;if(!b||this.fc.$c(b))return this.Bc.Gg(!1,y.Ub,3),16;Ba.a.J(512356564,826,50,"Paste html start");Nc.a.kP(!1,!1);Nc.a.mza("PasteHtml",!0);Nc.a.xk(li.a.Iyk,"Image:"+y.kda.length.toString()+",Table:"+y.Fkb.length.toString()+",Text:"+(y.VY?y.VY.length.toString():"0"));h=this.pa.Xd();a=Aq.a.fkh(0<y.kda.length?!0:!1,!1,0<y.Fkb.length?!0:!1,!1,this.la.jza,a);if(y.pqc)return Ba.a.J(512356563,
826,50,"Will replace text"),this.Bc.CB(1,y.Ub),a=this.ZMi(y,h[0],a),16!==a?this.Bc.Gg(!0,y.Ub):this.Bc.Gg(!1,y.Ub,15),a;Ba.a.J(512356562,826,50,"Will paste html into new shapes");if(y.wZc){if(this.la.Yig){const G=Nc.a.Ib;this.zb.Eb(new He.a(2,1,0,()=>{Nc.a.vF(G,()=>{this.ia.La(M.a.igd,c,y)})},90,"66"));return 64}return this.xNf(y,b,a)}return this.XMi(y,b,h,a)}ZMi(a,b,c){if(this.fc.$c(b))return 16;if(a.VY&&0<a.VY.length){Ba.a.J(512356561,826,50,String.format("ReplaceText: {0}",this.jGa.sSd([b])));
if(this.Tkg(a.VY))return 16;this.fc.Zv(b,c);const h=this.Jb.zd(15);try{b.Ub=a.Ub,h.nc(b),h.jd=c,b.Snc=a.VY,Object(za.a)(471,h)&&b.id&&(Object(ua.a)(471,h).Py[wq.a.A9g]=b.id.toString())}finally{h&&h.dispose()}}return 32}XMi(a,b,c,h){const m=[],y=b.Pt();var G=this.J0f(),U=G.x,ja=G.y;G=0;for(var va=0;va<a.Fkb.length;++va)G=this.Tk.QWd(!0,b.cid,b.sid,!1,U,ja,110,75,y+1,a.Fkb[va],a.Ub),m.push(G),G=6;U=a.kda;ja=1===U.length?0:Aq.a.HS;for(va=0;va<U.length;va++){const Ta=this.Tk.PWd(b.cid,b.sid,!1,ja,ja,
U[va].width,U[va].height,y+1,U[va].src,U[va].alt,a.Ub);m.push(Ta);ja+=Aq.a.HS;G=0===G?5:20}if(a.VY&&0<a.VY.length)if(Ba.a.J(512356560,826,50,String.format("PasteTextIntoNewTextbox: {0}",this.jGa.sSd(c))),!this.Tkg(a.VY))c=this.Tk.RWd(b.cid,b.sid,y+1,a.VY,a.Ub),m.push(c),G=0===G?1:20;else if(!m.length)return this.Bc.CB(1,a.Ub),this.Bc.Gg(!1,a.Ub,7),16;this.Bc.CB(G,a.Ub);if(0<m.length){if(!this.Wj.JF(b,m.length))return this.Wj.hG(b),this.Bc.Gg(!1,a.Ub,8),16;1===m.length&&a&&this.la.insertVideoWithPasteEnabled?
(c=a.VY,this.I9.ulg(c)?(this.Bc.CB(8,a.Ub),Ba.a.J(512356559,826,50,String.format("[Insert Online Video]: Inserting online video by paste!")),this.$z.zW(m,b,h),this.I9.nul(c,Object(F.a)(this,this.ADl,"videoInsertionFail"))):(this.$z.zW(m,b,h),this.fc.Zv(b,h))):(this.$z.zW(m,b,h),this.fc.Zv(b,h));this.Bc.Gg(!0,a.Ub)}else this.Bc.Gg(!1,a.Ub,9);return 32}ADl(){Ba.a.J(512356557,826,50,String.format("[Insert Online Video] Failed to insert online video by paste!"))}xNf(a,b,c){this.Bc.CB(5,a.Ub);if(Ma.a.Wa(a.kda))return this.Bc.Gg(!1,
a.Ub,10),16;if(!b)return 16;var h=Object(ua.a)(295,b.sc(this.Fb.Ma));if(!h)return this.Bc.Gg(!1,a.Ub,3),8;var m=Nc.a.Ib;m&&(m.actionName="SinglePicturePaste",m.Qr=!0,m.Nj=!0,m.Va("PreloadImageDuration",a.nIe.toString()));m=a.kda[0];const y=b.n3(this.pa.Xd());var G=b.Pt();let U,ja;({F1d:ja,fD:U}=this.oWa.$Ud(y,m.width,m.height));G=this.Tk.PWd(b.cid,b.sid,!1,U.x,U.y,ja.width,ja.height,G+1,m.src,m.alt,a.Ub);Nc.a.xk("ImageSrcSize",m.src.length.toString());h=this.oWa.mRd(this.Fb.Ld,ja,U,h.mT);G.NU=h;y&&
(G.eca=y.id);G.isResizable=!0;G.r9b=!0;G.vL=!0;G.FIa=!0;G.Pda=m.src;this.$z.zW([G],b,c,null,y);this.Bc.Gg(!0,a.Ub);return 32}Tkg(a){return 65535<a.length?(Ba.a.J(512356556,826,50,"Exceed text size limit: {0}",a.length),!0):!1}Esj(a,b,c,h,m){b=this.jq.presentation;if(!b)throw Error.argumentNull("Presentation is null");if(1===c)return 32;c=Object(ua.a)(Dm.a,m);if(!c)return 8;h=c.OW;if(Ma.a.Wa(h))return this.Bc.Gg(!1,c.Ub,11),8;this.Bc.CB(2,c.Ub);this.Bc.Ew(2,c.Ub);m=this.jq.Ba;if(!m||this.fc.$c(m))return this.Bc.Gg(!1,
c.Ub,3),16;Nc.a.mza("PasteShape",!1);if(!this.Wj.JF(m,h.length))return this.Wj.hG(m),this.Bc.Gg(!1,c.Ub,8),16;Ba.a.J(512356555,826,50,"Start Handle paste shapes");var y=Mr.b(h,ja=>ja.shapeNode);this.vw.sae(y,"HandlePasteShapes");for(var G of h){if(!G||!G.shapeNode.isConnected)return Ba.a.J(512356554,826,50,"Paste deleted shapes"),this.Btg.Mqc(ResourceStrings.l_CannotPasteDeletedObjectsTitle,String.format(ResourceStrings.l_CannotPasteDeletedObjectsMessage),null),this.Bc.Gg(!1,c.Ub,12),16;if(this.fc.PN(G.shapeNode))return this.Bc.Gg(!1,
c.Ub,3),16;if(!G.shapeNode.get_shapeId())return this.Bc.Gg(!1,c.Ub,12),16}G=[];for(y=0;y<h.length;y++)G.push(h[y].shapeNode);for(var U of G)if(U.Jf||U.Kg){gn(U);break}U=Object(ua.a)(116,b.lC(h[0].shapeNode.slideId));this.jGa.n9g(U,m,G,this.Cva,a,c.Ub);Ba.a.J(512356553,826,50,({contentType:a}=this.jGa.tSd(G)).returnValue);this.Bc.CB(a,c.Ub);Nc.a.kP(!0,!0);this.Bc.Gg(!0,c.Ub);return 32}zsj(a,b,c,h,m){(a=Object(ua.a)(Dm.a,m))&&this.JC.Ayk(a.Ub);return 32}Ksj(a,b,c,h,m){if(1===c)return 32;b=Object(ua.a)(Dm.a,
m);if(!b)return 8;this.Bc.CB(19,b.Ub);this.Bc.Ew(2,b.Ub);if(Ma.a.Wa(b.OW))return this.Bc.Gg(!1,b.Ub,11),8;Nc.a.mza("PasteSlide",!0);if(c=Array.isArray(b.OW)?b.OW:null){let G=0;c.forEach(U=>{U.Fd&&U.Fd.hasDeferredContent&&G++});0<G&&Ba.a.J(512356552,843,50,"HandlePasteSlides total: {0}, deferredSlideCount: {1}",c.length,G)}c=[];for(var y of b.OW){h=Object(ua.a)(Nv.a,y);if(!h)return this.Bc.Gg(!1,b.Ub,11),8;h=h.Fd;if(!h||!h.isConnected)return Ba.a.J(512356551,826,50,"Paste deleted slide"),this.Btg.Mqc(ResourceStrings.l_CannotPasteDeletedObjectsTitle,
String.format(ResourceStrings.l_CannotPasteDeletedObjectsMessage),null),b.c7g&&(this.Hq.Uq=null),this.Bc.Gg(!1,b.Ub,13),16;if(this.fc.$c(h))return this.Bc.Gg(!1,b.Ub,3),16;Array.add(c,h)}y=Array.clone(this.pa.We());y.sort((G,U)=>G.oe-U.oe);y=y[y.length-1];if(!y)return Ba.a.J(512356550,826,50,"Paste slides with no slide selected"),this.Bc.Gg(!1,b.Ub,13),8;Nc.a.xk("SlideCount",c.length.toString());y=this.$z.jRf(c,a,y,b.Ub,!1);c=!0;for(const G of y)if(!G.XN){c=!1;break}c||this.fc.Zv(this.Vb.Cf,a);Nc.a.kP(!0,
!0);this.Bc.Gg(!0,b.Ub);return 32}OVe(){return this.pa.xs()||this.pa.bH()}Qcl(){if(this.pa.xs())return!0;if(this.pa.bH()){const a=this.pa.Xd();return 1!==a.length||!a[0].isEditable}return!1}tpj(a,b,c,h,m,y){const G=this.Bc.eP(1,0,"HandleBrowserCut");this.Bc.CB(1,G);this.OVe()?(a=this.Ubb(a,this.ia,b,c,h,m,y,this.Bc,G),a.T6a(16)):(Nc.a.kP(!0,!0),this.Bc.Qhc(G),a=this.Ubb(a,this.ia,D.a.$Yb,c,h,m,y,this.Bc,G),a.eWc());return a}spj(a,b,c,h,m,y){const G=this.Bc.eP(0,0,"HandleBrowserCopy");this.Bc.CB(1,
G);this.OVe()?(a=this.Ubb(a,this.ia,b,c,h,m,y,this.Bc,G),2===h&&this.xla.ssa(Object.assign(new bt(!0),{ffg:!1,Ub:G})),a.T6a(32)):(this.Bc.Qhc(G),a=this.Ubb(a,this.ia,D.a.uHc,c,h,m,y,this.Bc,G),a.eWc());return a}upj(a,b,c,h,m,y){const G=this.Bc.eP(2,0,"HandleBrowserPaste"),U=this.OVe();a=this.Ubb(a,this.ia,U?b:D.a.Cra,c,h,m,y,this.Bc,G);y=Object(ua.a)(10,y);Nc.a.kP(!0,!1);if(this.pa.W8())return a.T6a(16),this.Bc.Gg(!1,G,3),a;y&&y.Sa(xc.a.FU)?2===h&&this.Hsd(y,G)?a.T6a(32):U?(2===h&&this.JC.paste(Object.assign(new Dm.a(!0),
{Iig:!1}),y.eb(xc.a.FU),!1),a.T6a(32)):a.eWc():(Ba.a.J(512356549,826,50,"Invalid action data for browser paste, expect PastedHtmlContent"),a.T6a(16),this.Bc.Gg(!1,G,14));return a}Bsj(a,b,c,h,m,y){Nc.a.mza("PasteGivenText",!1);this.Qcl()?(a=this.Ubb(a,this.ia,b,c,h,m,y,this.Bc,""),a.T6a(16)):(Nc.a.kP(!0,!0),a=this.Ubb(a,this.ia,D.a.hgd,c,h,m,y,this.Bc,""),a.eWc());return a}Msj(a,b,c,h,m){if(1===c)return 32;if((b=this.pa.Xd())&&0<b.length)return Ba.a.J(512356548,826,50,"HandlePasteTextIntoNewShape: do not paste text into a new textbox since a shape is selected. {0}",
this.jGa.sSd(b)),16;Ba.a.J(512356547,826,50,"HandlePasteTextIntoNewShape: a. Paste text as new shape.");if(!(m&&m.tn&&m.tn.innerHTML&&m.tn.innerHTML.length))return Ba.a.J(512356546,826,50,"HandlePasteTextIntoNewShape: a. User attempted to paste null content."),8;Nc.a.mza("PasteTextIntoNewShape",!0);b=this.jq.Ba;if(!b)return Ba.a.J(512356545,826,50,"insert shape with no slide selected"),16;if(!this.Wj.JF(b,1))return this.Wj.hG(b),16;m=this.Tk.RWd(b.cid,b.sid,b.Pt()+1,m.tn.innerHTML,m.Ub);this.$z.zW([m],
b,a);return 32}J0f(){const a=this.Sb.zu();return new ad.a(Math.floor(a.width/2),Math.floor(a.height/2))}Asj(a,b,c,h,m){if(1===c)return 32;a="";m&&(a=m.getAttribute(mu.a.LBf).toString());this.Bc.Nzb(a)||(a=this.Bc.eP(2,1,"HandlePasteContentFromPandora"));b=this.ia.processAction(M.a.Qia,2);if(32!==b)return this.Bc.Gg(!1,a,15),Ba.a.J(512356544,826,50,"Exit from box4 failed."),b;a=Object.assign(new Dm.a(!0),{Ub:a});this.OT.gMj(m)?a.tn=m:(cf.a.WIc(this.lh),this.lh.contentWindow.document.body.appendChild(m));
this.JC.paste(a,null,!1);Ba.a.J(512356515,826,50,null);return 32}Hsd(a,b){if(a){if(this.la.jhe){const c=a.sa(xc.a.QVc,"");if(c.startsWith("data:image/"))return this.Bc.CB(5,b),this.JC.mIe(c,b)}a=a.eb(xc.a.FU);ta.a.Wa(a)||(a=this.OT.UYa(a),this.Bc.Z9k(a,b))}return!1}}Object(n.a)(tM,"ClipboardActor",null,[227]);var np=d(1116);class uM{constructor(a,b){this.ia=a;this.Eq=b;this.vb()}vb(){this.ia.ra(M.a.Ech,he.a.frame,Object(F.a)(this,this.xtc,"updateCoauthStatus"),96)}De(){}xtc(a,b,c,h,m){if(1===c)return 32;
a=this.Eq.alc;ta.a.Wa(a)&&(a="NotConnected");this.Eq.u7a&&(a=String.format("{0} ~:{1}",a,this.Eq.u7a));m[np.a.Value]=a;m[bm.a.labelText]=a;m[np.a.Visible]=!0;return 32}}Object(n.a)(uM,"CoauthActor",null,[227]);var nu=d(241),Uk=d(345);class vM{constructor(a,b,c,h){this.NGa=!1;a("powerpoint-editor-intl").then(()=>{Ba.a.J(51519637,801,50,"Icons and strings script is loaded successfully");a("colorPickerManager").then(()=>{Ba.a.J(51519639,801,50,"Color Picker Manager script is loaded successfully");this.NGa=
!0}).catch(m=>{Ba.a.J(51519641,801,10,"Failed to load colorpickerManager "+m.toString())})}).catch(m=>{Ba.a.J(51519643,801,10,"Failed to load powerpoint-editor-intl "+m.toString())});this.ia=b;this.Fa=c;this.Vb=h}vb(){this.ia.ya(M.a.renderColorPicker,nc.a.application,Object(F.a)(this,this.renderColorPicker,"renderColorPicker"));this.ia.ya(M.a.zBa,nc.a.application,Object(F.a)(this,this.zBa,"addRecentColor"))}De(){}renderColorPicker(a,b,c,h,m){if(1===c)return this.NGa?32:8;a=!1;b=m.currentColor;c=m.handleCommand;
m.hideAlphaSlider&&(a=!0);this.sVk(b,c,a);return 32}zBa(a,b,c,h,m){if(a=nu.a.parse(m.Color)){b=this.Vb.Cf;if(!b)return Ba.a.J(595186576,822,10,"AddRecentColor: pagemanifestnode is null"),8;b.te(X.a.RHi,a.RGBColor);b.te(X.a.M7,JSON.stringify(Uk.g(b.M7,a.RGBColor)))}else return Ba.a.J(595186574,822,10,"AddRecentColor: failed to parse colorinfo, colorInfo is null"),8;return 32}sVk(a,b,c){let h="#000000",m=100;a&&(h=hb.a.oI(a.lD),m=100*a.alpha);a=document.getElementById("colorPickerDiv");a||(a=document.createElement("div"),
a.id="colorPickerDiv",document.getElementById("WACInnerFrame").appendChild(a),this.Fa.iWc(Ua.a.z_b,Ua.a.nj,a));const y=colorPickerManager.FactoryGlobal.getColorPickerManagerInstance();if(y)if(y.addEventListener("onColorChange",ja=>{const va={};va.Color=ja;va.sourceControlId="CustomColors";let Ta=8;zg.a("ColorPicker_ColorApplied",b,()=>Ta=this.ia.La(b,2,va));32===Ta?Ba.a.J(595186570,822,50,"RenderColorPickerDialog: Color applied successfully from color picker dialog through {0} command.",b):Ba.a.J(595186568,
822,50,"RenderColorPickerDialog: Color not applied successfully from color picker dialog through {0} command.",b);this.Fa.Bj(Ua.a.z_b,!1)}),y.addEventListener("onCancel",()=>{this.Fa.Bj(Ua.a.z_b,!1)}),zg.a("ColorPicker_DialogInvocation",b,()=>{y.render("colorPickerDiv",h,m,c);return 32}),Ba.a.J(595186566,822,50,"RenderColorPickerDialog: Color Picker Dialog invoked through {0} command.",b),this.Fa.Bj(Ua.a.z_b,!0),a=this.Fa.Gc(Ua.a.z_b)){a.zL=!0;var G=w.KeyInputManager.Na(z.a.Pq,0),U=w.KeyInputManager.Na(z.a.Pq,
4);a.Ap(G);a.Ap(U);a.bindAction(G,H.a.rsa);a.bindAction(U,H.a.rsa)}else Ba.a.J(595186564,822,10,"RenderColorPickerDialog: colorPickerScope is null");else Ba.a.J(595186572,822,10,"RenderColorPickerDialog: colorPickerManagerInstace is null")}}Object(n.a)(vM,"ColorPickerActor",null,[227]);var NQ=d(1030);class wM{constructor(a,b,c,h,m,y,G,U,ja,va,Ta,fb=!1,Db=!1){this.ia=a;this.Xbc=b;this.VQ=c;this.Fma=m.vsc;this.rla=h;this.ua=y;this.Ea=G;this.pa=U;this.Fa=ja;this.n0=va;this.W7j=fb;this.Fb=Ta;this.gk=
Db}vb(){this.ia.ya(M.a.dKc,nc.a.application,Object(F.a)(this,this.mvj,"handleThumbnailPanelContextMenu"));this.ia.ya(M.a.BVd,nc.a.application,Object(F.a)(this,this.Tuj,"handleSorterViewThumbnailContextMenu"));this.ia.ya(M.a.fGf,nc.a.application,Object(F.a)(this,this.Suj,"handleSorterViewBlankSpaceMenu"));this.ia.ya(M.a.yVd,nc.a.application,Object(F.a)(this,this.ruj,"handleSectionContextMenu"));this.ia.ya(M.a.AVd,xb.a.view,Object(F.a)(this,this.Nuj,"handleSlidePanelContextMenu"));this.ia.ya(M.a.zVd,
xb.a.view,Object(F.a)(this,this.hsj,"handleMultiSelectShapeContextMenu"));this.ia.ya(M.a.iGf,nc.a.application,Object(F.a)(this,this.Dvj,"handleVersionHistoryThumbnailContextMenu"));this.ia.he(M.a.dKc,2048)}De(){this.W7j&&v.a.Uj&&(this.Fa.Gc(I.AppFrame.xW).bindAction(w.KeyInputManager.Na(z.a.cMa,0),D.a.saa),this.Fa.Gc(I.AppFrame.BNe).bindAction(w.KeyInputManager.Na(z.a.cMa,0),D.a.saa))}mvj(a,b,c,h,m){if(1===c)return 32;if(this.ia.YW)return this.n0.show(1,-1),32;this.Xbc.D8a();if(m.Cc&&Sys.UI.DomElement.containsCssClass(m.Cc,
pe.a.HBa))return 16;if(this.VQ.v_||!m.Cc)return 32;2===m.Yf||3===m.Yf?(a=m.clientPoint.y-Td.a.Ycj(this.Fma.EU)+this.Fma.EU.scrollTop,a=this.Fma.p1d(a),b=new Sys.UI.Point(m.clientPoint.x,m.clientPoint.y)):(a=0>this.Fma.selectedIndex?2:1,b=Sys.UI.DomElement.getLocation(this.Fma.EU),b=new Sys.UI.Point(b.x+xf.a.Ura,b.y+xf.a.Ura));this.rla.value.U5(xf.a.usa,b,m.Yf,a);return 32}Dvj(a,b,c,h,m){if(1===c)return 32;if(m.Cc&&Sys.UI.DomElement.containsCssClass(m.Cc,pe.a.HBa))return 16;if(!m.Cc)return 32;a=new Sys.UI.Point(m.clientPoint.x,
m.clientPoint.y);this.rla.value.U5(xf.a.usa,a,m.Yf,21);return 32}Suj(a,b,c,h,m){if(1===c)return 32;a=new Sys.UI.Point(m.clientPoint.x,m.clientPoint.y);b=20;this.gk&&0===this.Fb.Sl&&(b=2);this.rla.value.U5(xf.a.usa,a,m.Yf,b);return 32}Tuj(a,b,c,h,m){if(1===c)return 32;if(m.Cc&&Sys.UI.DomElement.containsCssClass(m.Cc,pe.a.HBa))return 16;if(this.VQ.v_||!m.Cc)return 32;if(2===m.Yf||3===m.Yf||1===m.Yf)b=19,this.gk&&0===this.Fb.Sl&&(b=1),a=new Sys.UI.Point(m.clientPoint.x,m.clientPoint.y),this.rla.value.U5(xf.a.usa,
a,m.Yf,b);return 32}ruj(a,b,c,h,m){if(1===c)return 32;u.AFrameworkApplication.fa.ka("PPTSorterViewSectionMenuEnabled")&&(a=m.contextMenuArgs,b=new Sys.UI.Point(a.clientPoint.x,a.clientPoint.y),m.isEmptySection?this.rla.value.U5(xf.a.usa,b,a.Yf,17):this.rla.value.U5(xf.a.usa,b,a.Yf,18));return 32}Nuj(a,b,c,h,m){if(1===c)return 32;this.Xbc.D8a();if(m.Cc&&Sys.UI.DomElement.containsCssClass(m.Cc,pe.a.HBa))return 16;if(this.VQ.v_||!m.Cc)return 32;if(2===m.Yf||3===m.Yf)a=new Sys.UI.Point(m.clientPoint.x,
m.clientPoint.y);else{a=Lh.b(b);a=Lh.e(this.ua.Ba,a.Ma);if(!a)return 16;a=Sys.UI.DomElement.getLocation(a.BB);a=new Sys.UI.Point(a.x+xf.a.Ura,a.y+xf.a.Ura)}this.rla.value.U5(xf.a.usa,a,m.Yf,4);return 32}hsj(a,b,c,h,m){if(1===c||m.Cc&&Sys.UI.DomElement.containsCssClass(m.Cc,xf.a.wci))return 32;this.Xbc.D8a();if(m.Cc&&Sys.UI.DomElement.containsCssClass(m.Cc,pe.a.HBa))return 16;if(this.VQ.v_||!m.Cc)return 32;b=Lh.b(b);var y;if(!(b&&b.Lb&&(y=this.pa.sg())&&y.length))return 16;a=this.zcj(y);if(2===m.Yf||
3===m.Yf)y=new Sys.UI.Point(m.clientPoint.x,m.clientPoint.y);else{y=Lh.c(y[0],b.Ma);if(!y||!y.xa)return 16;y=qd.a.ii(y.xa.xa);b=qd.a.ii(b.container);c=y.x+xf.a.Ura<b.x?b.x:y.x+xf.a.Ura;y=y.y+xf.a.Ura<b.y?b.y:y.y+xf.a.Ura;c=c>b.x+b.width?b.x+b.width:c;y=y>b.y+b.height?b.y+b.height:y;y=new Sys.UI.Point(c,y)}1===m.Yf||4===a?this.rla.value.U5(xf.a.usa,y,m.Yf,a):this.rla.value.sfl(xf.a.usa,y,m.Yf,a);return 32}zcj(a){let b=a[0];b.get_smartArtModelId()&&(b=this.Ea.vr(b));return 1<a.length?this.Ea.nGc(a)?
11:10:b.Vy||!b.tua||b.Jf?5:b.get_isSVGBlipFilled()?13:b.Ej||1===b.mediaType?7:b.Rf?8:b.lx?6:b.Cq?22:b.ar?9:b.ud?14:b.Mp?15:b.I3?16:0}}Object(n.a)(wM,"ContextMenuActor",null,[227]);class xM{constructor(a,b,c,h,m,y,G){this.ia=a;this.pa=b;this.Ea=c;this.Abb=h;this.u8j=m;this.Fue=y;this.aU=G}vb(){this.ia.ra(M.a.h$g,nc.a.application,Object(F.a)(this,this.Qzk,"pictureToolsTabViewHandler"),4);this.ia.ra(M.a.hOf,nc.a.application,Object(F.a)(this,this.ZNi,"drawingToolsTabViewHandler"),4);this.ia.ra(M.a.Iwf,
nc.a.application,Object(F.a)(this,this.Rfi,"audioPlaybackToolsTabViewHandler"),4);this.ia.ra(M.a.Gwf,nc.a.application,Object(F.a)(this,this.Pfi,"audioFormatToolsTabViewHandler"),4);this.ia.ra(M.a.Jwf,nc.a.application,Object(F.a)(this,this.Sfi,"audioSettingsTabViewHandler"),4);this.ia.ra(M.a.Jch,nc.a.application,Object(F.a)(this,this.soj,"graphicsTabViewHandler"),100);this.ia.ra(M.a.iMe,nc.a.application,Object(F.a)(this,this.ool,"tableTabViewHandler"),100);this.ia.ra(M.a.Ych,nc.a.application,Object(F.a)(this,
this.Ofi,"audioContextualGroupHandler"),100);this.ia.ra(M.a.CMd,nc.a.application,Object(F.a)(this,this.$2h,"accessibleAuthoringViewHandler"),4)}De(){}Qzk(){return this.mMj()?32:this.Nig(this.pa.sg())?32:8}ZNi(){const a=this.pa.sg();return a&&a.length?1===a.length?this.Dgg(a)?32:16:this.eci(a)||this.OHj(a)&&this.Dgg(a)?32:this.Sqb(a)||this.jOj(a)?16:32:16}Rfi(){return this.Fue?this.DYc()?32:this.Sqb(this.pa.sg())?32:8:2}Pfi(){return this.aU?this.DYc()?32:this.Sqb(this.pa.sg())?32:8:2}Sfi(){return this.aU&&
this.Fue?this.DYc()?32:this.Sqb(this.pa.sg())?32:8:2}soj(){return this.u8j?this.nMj()?32:this.Ea.zrc(this.pa.sg())?32:16:2}ool(){const a=this.pa.Xd();return a&&1===a.length&&a[0].ud?32:8}Ofi(){return this.aU||this.Fue?this.DYc()?32:this.Sqb(this.pa.sg())?32:8:2}$2h(){return this.Abb&&this.Abb.isVisible?32:2}jOj(a){if(!a)return!1;let b=!0;for(const c of a){if(c.Mp||1===c.mediaType)return!0;c.Ej||(b=!1)}return b}eci(a){if(!a)return!1;for(const b of a)if(!b.Mp)return!1;return!0}Nig(a){if(!a)return!1;
let b=!1;for(const c of a)if(c)if(c.Ej&&!c.get_isSVGBlipFilled())b=!0;else if(c.Mp)return!1;return b}Sqb(a){if(!a||!a.length)return!1;for(const b of a)if(b&&1!==b.mediaType)return!1;return!0}OHj(a){if(!a||!a.length)return!1;for(const b of a)if(b&&1===b.mediaType)return!0;return!1}Dgg(a){if(!a)return!1;for(const b of a)if(b&&(b.eua||b.I3))return!0;return!1}mMj(){return this.yie(this.pa.sg())&&this.Nig(this.pa.YO(this.pa.Xd()))}nMj(){return this.yie(this.pa.sg())&&this.RRj(this.pa.YO(this.pa.Xd()))}DYc(){return this.yie(this.pa.sg())&&
this.Sqb(this.pa.YO(this.pa.Xd()))}RRj(a){if(!a)return!1;for(const b of a)if(b&&b.Kg&&b.get_isSVGBlipFilled())return!0;return!1}yie(a){if(!a)return!1;for(const b of a)if(b&&b.Jf)return!0;return!1}}Object(n.a)(xM,"ContextualTabsActor",null,[227]);class yM{constructor(a,b,c,h){this.gze=null;this.ia=a;this.ua=b;this.Jb=c;this.Xug=h;this.Xug.ik(Object(F.a)(this,this.k5g,"onRichApiResponseReceived"))}vb(){this.ia.ra(M.a.I0d,xb.a.application,Object(F.a)(this,this.Jqj,"handleExecuteAddinBatchOperation"),
4)}De(){}dispose(){this.Xug.Cm(Object(F.a)(this,this.k5g,"onRichApiResponseReceived"))}k5g(a,b){this.gze&&(a=Object(ua.a)(469,b.node))&&a.GQe&&this.gze(a.GQe)}Jqj(a,b,c,h,m){b=this.ua.presentation;if(1===c)return b?32:8;if(!b)return Ba.a.J(509364444,802,10,"HandleExecuteAddinBatchOperation with null IPageManifestNode."),16;if(!m)return Ba.a.J(509364443,802,10,"HandleExecuteAddinBatchOperation with null action data."),16;this.gze=m.promiseToResolve;c=this.Jb.zd(15,void 0,void 0,void 0,!0);try{c.nc(b),
c.jd=a,b.wNd(m.requestBody)}finally{c&&c.dispose()}return 32}}Object(n.a)(yM,"ExtensibilityActor",null,[227]);var Sx;(function(a){a[a.height=0]="height";a[a.width=1]="width";a[a.rotation=2]="rotation";a[a.leftMargin=3]="leftMargin";a[a.rightMargin=4]="rightMargin";a[a.topMargin=5]="topMargin";a[a.bottomMargin=6]="bottomMargin"})(Sx||(Sx={}));Object(n.b)("FormatPaneProperty",Sx);class Yz{constructor(a,b){this.p1=a;this.D$=b}}Object(n.a)(Yz,"MarginShapeData",null,[]);class vE{constructor(){this.type=
"FormatShapeTaskPaneProps";this.onToggleAspectRatio=this.onChange=this.bottomMargin=this.topMargin=this.rightMargin=this.leftMargin=this.rotation=this.width=this.height=this.numberFormatInfo=null;this.isMarginFieldEnabled=this.isAspectRatioFeatureEnabled=this.isAspectRatioDisabled=this.isAspectRatioLocked=!1;this.emptyValueFields=this.disabled=0}}Object(n.a)(vE,"FormatShapeTaskPaneProps",null,[]);class zM{constructor(a,b,c,h,m,y,G,U,ja,va,Ta,fb,Db,gc,hc,Gc,Pc){this.oIa=this.mXa=this.JX=this.Xva=null;
this.UDg=0;this.Db=!1;this.PHa=null;this.FGa=this.nva=!1;this.m8j=!0;this.ob=b;this.Qb=c;this.ia=h;this.Fa=m;this.Lg=G;this.qd=U;this.Lc=ja;this.Fb=va;this.QFa=Ta;this.Vb=fb;this.Lg.kI(Object(F.a)(this,this.Pwa,"onChangeRenderFormatShapePane"));this.Lg.BBa(Object(F.a)(this,this.Pwa,"onChangeRenderFormatShapePane"));this.Lc.oPa(Object(F.a)(this,this.Pwa,"onChangeRenderFormatShapePane"));this.qd.EBa(Object(F.a)(this,this.Pwa,"onChangeRenderFormatShapePane"));this.Qb.IK(Object(F.a)(this,this.Mu,"onAppFrameModeSwitched"));
this.pzg=gc;this.I3c=hc;this.Ea=Db;this.j0=Gc;this.hn=Pc;Rd.a("FixHeightAndWidthButtonValues")&&this.hn&&this.hn.UNd(Object(F.a)(this,this.Pwa,"onChangeRenderFormatShapePane"))}dispose(){this.Lg.F5(Object(F.a)(this,this.Pwa,"onChangeRenderFormatShapePane"));this.Lg.NZa(Object(F.a)(this,this.Pwa,"onChangeRenderFormatShapePane"));this.Lc.gib(Object(F.a)(this,this.Pwa,"onChangeRenderFormatShapePane"));this.qd.iib(Object(F.a)(this,this.Pwa,"onChangeRenderFormatShapePane"));this.Qb.wY(Object(F.a)(this,
this.Mu,"onAppFrameModeSwitched"));Rd.a("FixHeightAndWidthButtonValues")&&this.hn.gkd(Object(F.a)(this,this.Pwa,"onChangeRenderFormatShapePane"))}vb(){this.ia.ra(M.a.Cqc,nc.a.application,Object(F.a)(this,this.Cqc,"showHideFormatShapePane"),4);this.ia.ra(M.a.Wmd,nc.a.application,Object(F.a)(this,this.Wmd,"setAbsoluteHeight"),4);this.ia.ra(M.a.XXe,nc.a.application,Object(F.a)(this,this.XXe,"spinAbsoluteHeight"),4);this.ia.ra(M.a.vhb,nc.a.application,Object(F.a)(this,this.vhb,"queryAbsoluteHeight"),
100);this.ia.ra(M.a.Xmd,nc.a.application,Object(F.a)(this,this.Xmd,"setAbsoluteWidth"),4);this.ia.ra(M.a.YXe,nc.a.application,Object(F.a)(this,this.YXe,"spinAbsoluteWidth"),4);this.ia.ra(M.a.whb,nc.a.application,Object(F.a)(this,this.whb,"queryAbsoluteWidth"),100);this.ia.ra(M.a.pIb,nc.a.application,Object(F.a)(this,this.pIb,"queryFormatShapePane"),96)}De(){}Pwa(){this.Db&&this.em(!0)}Mu(a){1===a.mode&&this.Db&&(this.Db=!1,this.zr(),this.Fa.Bj(Ua.a.DW,this.Db))}ULj(a){return this.Vb.isEditingAllowed&&
this.m8j&&!this.RVe(a)}pIb(a,b,c,h,m){(a=Object(ua.a)(Ph.a,m))&&a.Qf(this.Db);return 32}Cqc(a,b,c){b=this.ob.sg();return 1===c?b.length&&this.ULj(b)?32:8:zg.b("FormatShapePaneActor::ShowHideFormatShapePane PaneOpen:",this.Db.toString(),a,()=>{(this.Db=!this.Db)?this.em():this.zr();return 32})}Wmd(a,b,c,h,m){b=this.ob.sg();return 1===c?this.Wsh(b)?8:32:zg.a("FormatShapePaneActor::SetAbsoluteHeight",a,()=>{if(!m)return Ba.a.J(512500608,822,10,"FormatShapePaneActor::SetAbsoluteHeight actionData == null"),
8;const y=m.Number;void 0===y||null===y||isNaN(y)||this.Wwa(y,0);return 32})}XXe(a,b,c,h,m){if(!m)return 8;m.Increment&&(this.Wwa(0,0),this.S5a());return 32}vhb(a,b,c,h,m){if(!m)return Ba.a.J(512500579,822,10,"FormatShapePaneActor::QueryAbsoluteHeight actionData is null"),8;if(a=m.queryResult)b=this.jC(),a.uaa=b.height.toFixed(2).toString()+'"',1===(b.emptyValueFields&1)&&(a.uaa="");return 32}Xmd(a,b,c,h,m){b=this.ob.sg();return 1===c?this.Wsh(b)?8:32:zg.a("FormatShapePaneActor::SetAbsoluteWidth",
a,()=>{if(!m)return Ba.a.J(512500578,822,10,"FormatShapePaneActor::SetAbsoluteWidth actionData == null"),8;const y=m.Number;void 0===y||null===y||isNaN(y)||this.Wwa(y,1);return 32})}YXe(a,b,c,h,m){if(!m)return 8;m.Increment&&(this.Wwa(0,1),this.S5a());return 32}whb(a,b,c,h,m){if(!m)return Ba.a.J(512500577,822,10,"FormatShapePaneActor::QueryAbsoluteWidth actionData is null"),8;if(a=m.queryResult)b=this.jC(),a.uaa=b.width.toFixed(2).toString()+'"',2===(b.emptyValueFields&2)&&(a.uaa="");return 32}em(a=
!1){const b=this.jC(),c=Object.assign(new ju.a,{title:ResourceStrings.l_FormatOptions,hideHeader:!1,width:320,location:2,contentProps:b,onOpen:()=>{},onClose:()=>{this.Db=!1},isModernPane:!0});fj.UISurfaces.xr().then(h=>{a?h.updateTaskPane(Ua.a.DW,c):h.showTaskPane(Ua.a.DW,c);return null})}zr(){fj.UISurfaces.xr().then(a=>{a.hideTaskPane(Ua.a.DW,2);return null})}jC(){const a=this.ob.sg();var b=[];for(var c of a)c.Jf?b=Array.isArray(b.concat.apply(b,this.Ea.Yw(c)))?b.concat.apply(b,this.Ea.Yw(c)):null:
b.push(c);if(!(c=this.al(a[0]))||this.RVe(a))return this.FGa=!0,this.sph(0,0,0,0,0,0,0,127,127);var h=this.getBounds(a[0]),m=c.vd;c=this.e6d(h);c=this.hKc(c,1,m);h=this.a$d(h);h=this.hKc(h,0,m);this.FGa=0===c||0===h?!0:!1;m=Math.round(a[0].get_shapeRotation());m=0>m&&Rd.a("fixBugOfNegativeAngle")?m+360:m;b=this.al(b[0]);let y=0,G=0,U=0,ja=0;b&&(y=b.JTa[0],G=b.JTa[1],U=b.JTa[2],ja=b.JTa[3]);c=this.sph(c,h,m,y,G,U,ja,this.b7i(a),0);this.Pzl(a,c);return c}b7i(a){let b=[];for(var c of a)c.Jf?b=Array.isArray(b.concat.apply(b,
this.Ea.Yw(c)))?b.concat.apply(b,this.Ea.Yw(c)):null:b.push(c);c=0;for(let h=0;h<a.length;h++)this.rsb(a[h])||(c|=4),this.j0&&!this.FZb(a[h])&&(c|=1,c|=2);for(a=0;a<b.length;a++)if(!b[a].Lzb){c|=120;break}return c}rsb(a){return!!a&&a.vL&&!a.KI}FZb(a){return!!a&&a.isResizable&&!a.KI}Wsh(a){if(0>=a.length)return!0;let b=!1;if(this.j0){b=!0;for(let c=0;c<a.length;c++)if(a[c]&&this.FZb(a[c])){b=!1;break}}return b||this.RVe(a)}RVe(a){if(!a.length)return!0;let b=!1;for(let c=0;c<a.length;c++)if(a[c]&&a[c].ud){b=
!0;break}return b}Pzl(a,b){if(this.I3c){var c=[];for(var h of a)h.Jf?c=Array.isArray(c.concat.apply(c,this.Ea.Yw(h)))?c.concat.apply(c,this.Ea.Yw(h)):null:c.push(h);var m=h=!0,y=!0,G=!0;if(2<=c.length)for(var U=1;U<c.length;U++){var ja=c[U];if(!ja)continue;if(!this.getBounds(ja))continue;ja=this.al(ja);let va=0,Ta=0,fb=0,Db=0;ja&&(va=ja.JTa[0],Ta=ja.JTa[1],fb=ja.JTa[2],Db=ja.JTa[3]);h&&b.leftMargin!==va&&(b.leftMargin=0,b.emptyValueFields|=8,h=!1);m&&b.rightMargin!==Ta&&(b.rightMargin=0,b.emptyValueFields|=
16,m=!1);y&&b.topMargin!==fb&&(b.topMargin=0,b.emptyValueFields|=32,y=!1);G&&b.bottomMargin!==Db&&(b.bottomMargin=0,b.emptyValueFields|=64,G=!1);if(!(h||m||y||G))break}}if(!(2>a.length))for(m=h=c=!0,y=1;y<a.length;y++)if(G=a[y])if(U=this.getBounds(G))if(ja=this.al(G).vd,G=this.e6d(U),G=this.hKc(G,1,ja),U=this.a$d(U),U=this.hKc(U,0,ja),ja=a[y].get_shapeRotation(),c&&b.height.toFixed(2).localeCompare(G.toFixed(2))&&(b.height=0,b.emptyValueFields|=1,c=!1),h&&b.width.toFixed(2).localeCompare(U.toFixed(2))&&
(b.width=0,b.emptyValueFields|=2,h=!1),m&&b.rotation!==ja&&(b.rotation=0,b.emptyValueFields|=4,m=!1),!(c||h||m))break}q6k(a,b,c,h,m,y,G,U,ja){const va=new vE,Ta=Object(ua.a)(Object,Dg.e().numberFormatInfo);va.numberFormatInfo=Ta;va.height=a;va.width=b;va.rotation=c;va.leftMargin=h;va.rightMargin=m;va.topMargin=y;va.bottomMargin=G;va.disabled=U;va.onChange=Object(F.a)(this,this.Wwa,"onPropertyChange");va.emptyValueFields=ja;va.isAspectRatioLocked=this.nva;va.isAspectRatioDisabled=this.FGa;va.onToggleAspectRatio=
Object(F.a)(this,this.onToggleAspectRatio,"onToggleAspectRatio");va.isAspectRatioFeatureEnabled=this.pzg;va.isMarginFieldEnabled=this.I3c;return va}r6k(a,b,c,h,m){const y=new vE,G=Object(ua.a)(Object,Dg.e().numberFormatInfo);y.numberFormatInfo=G;y.height=a;y.width=b;y.rotation=c;y.disabled=h;y.onChange=Object(F.a)(this,this.Wwa,"onPropertyChange");y.emptyValueFields=m;y.isAspectRatioLocked=this.nva;y.isAspectRatioDisabled=this.FGa;y.onToggleAspectRatio=Object(F.a)(this,this.onToggleAspectRatio,"onToggleAspectRatio");
y.isAspectRatioFeatureEnabled=this.pzg;return y}sph(a,b,c,h,m,y,G,U,ja){return this.I3c?this.q6k(a,b,c,h,m,y,G,U,ja):this.r6k(a,b,c,U,ja)}Wwa(a,b){const c=this.ob.sg();this.UDg!==b&&(this.S5a(),this.UDg=b);switch(b){case 0:case 1:this.resize(a,c,b);break;case 3:case 4:case 5:case 6:this.opi(a,c,b);break;case 2:this.rotate(a,c)}}onToggleAspectRatio(a){this.nva=a}iAf(a,b,c,h){a/=b;return c?Math.round(c/a):Math.round(h*a)}opi(a,b,c){let h=[];for(const y of b)y.Jf?h=Array.isArray(h.concat.apply(h,this.Ea.Yw(y)))?
h.concat.apply(h,this.Ea.Yw(y)):null:h.push(y);this.PHa=b=h;let m=!0;this.JX||(this.JX=[],m=!1);zg.b("FormatShapePaneActor::ChangeMargin Property:",Sx[c]+"; AspectRatioLocked: "+(!this.FGa&&this.nva),M.a.Ipc,()=>{for(let y=0;y<b.length;y++){const G=b[y],U=this.al(G);if(!U)continue;m||this.JX.push(new Yz(G,new yi.a));this.JX.length===y&&this.JX.push(new Yz(G,new yi.a));this.JX[y]||(this.JX[y]=new Yz(G,new yi.a));const ja=this.JX[y];ja.D$.left=G.zia;ja.D$.right=G.Aia;ja.D$.top=G.Bia;ja.D$.bottom=G.yia;
3===c&&(this.JX[y].D$.left=a);4===c&&(this.JX[y].D$.right=a);5===c&&(this.JX[y].D$.top=a);6===c&&(this.JX[y].D$.bottom=a);U.qza(this.JX[y].D$)}return 32});this.Htc()}resize(a,b,c){this.PHa=b;let h=!0;const m=[],y=[];this.Xva||(this.Xva=[],h=!1);0===a&&(this.FGa=!0);zg.b("FormatShapePaneActor::Resize Property:",Sx[c]+"; AspectRatioLocked: "+(!this.FGa&&this.nva),M.a.vib,()=>{for(let va=0;va<b.length;va++){var G=b[va];const Ta=this.al(G);if(this.j0){if(!Ta||!this.FZb(G))continue}else if(!Ta)continue;
var U=this.getBounds(G),ja=this.e6d(U);U=this.a$d(U);h||(Array.add(this.Xva,new yz(G,new yi.a)),Ta.uL=!0,Ta.OD(!1));Array.add(m,Ta.vYa);Array.add(y,new yi.a);Ta.shapeNode.Jf&&Ta.shapeNode.isEditable&&Ta.Ok&&(Ta.Ok.visible=!0);G=Ta.vd;if(0===c){G=this.xGf(a,1,G);G=Math.round(G-ja);y[va].bottom=G;let fb;(fb=this.Xva[va].b1).bottom=fb.bottom+G;if(!this.FGa&&this.nva){ja=this.iAf(U,ja,0,G);y[va].right=ja;let Db;(Db=this.Xva[va].b1).right=Db.right+ja}}else{G=this.xGf(a,0,G);G=Math.round(G-U);y[va].right=
G;let fb;(fb=this.Xva[va].b1).right=fb.right+G;if(!this.FGa&&this.nva){ja=this.iAf(U,ja,G,0);y[va].bottom=ja;let Db;(Db=this.Xva[va].b1).bottom=Db.bottom+ja}}Ta.setOffsets(yi.a.add(m[va],y[va]),!0);Ta.shapeNode.Jf&&Ta.shapeNode.isEditable&&(Ta.Xae(),Ta.tVc())}return 32});this.Htc()}rotate(a,b){this.PHa=b;let c=!0;a=Math.round(a);this.mXa||(this.mXa=[],c=!1);zg.a("FormatShapePaneActor::Rotate",M.a.toc,()=>{for(let h=0;h<b.length;h++){const m=b[h],y=this.al(m);if(!y)continue;const G=y.Gvb().Xf(),U=
a%So.Zjc;c||(y.OD(!1),Array.add(this.mXa,new So(m,U)));this.mXa[h].wYd=U;y.setRotation(U,G)}return 32});this.Htc()}al(a){return a?Object(ua.a)(zz.a,a.tg(this.Fb.Ma)):(Ba.a.J(512500576,822,10,"shapeNode == null"),null)}getBounds(a){var b=this.al(a);if(!b)return Ba.a.J(512500575,822,10,"shapeViewElement == null"),null;b=b.p4b();a.G_&&(b=this.q4d(b));return b}xGf(a,b,c){return this.QFa.zM(this.Fb.Ld.t_(a,b),c)}hKc(a,b,c){a=this.Fb.Ld.rf(this.QFa.wM(a,c),b);return te.a.Jv(a)}e6d(a){a=ad.a.lm(a.qk(ke.a.Ku),
a.qk(ke.a.IH));return 1>=a?0:a}a$d(a){a=ad.a.lm(a.qk(ke.a.Ku),a.qk(ke.a.yE));return 1>=a?0:a}S5a(){this.I3c&&this.JX&&(this.ia.La(M.a.Ipc,2,this.JX),this.JX=null);if(this.Xva){for(var a=0;a<this.PHa.length;a++){var b=this.al(this.PHa[a]);b&&!b.Al&&(b.shapeNode.Jf&&b.shapeNode.isEditable||(b.uL=!1),b.Oz(!1))}this.ia.La(M.a.vib,2,this.Xva);this.Xva=null}if(this.mXa){a=[];for(b=0;b<this.PHa.length;b++){let c=this.al(this.PHa[b]);c&&!c.Al&&(c.Oz(!1),Rd.a("FixForUndoRotateMultipleShapes")?a.push(this.PHa[b]):
this.ia.La(M.a.toc,2,this.mXa[b]))}Rd.a("FixForUndoRotateMultipleShapes")&&(b={},b.selectedNodes=a,b.rotateData=this.mXa,this.ia.La(M.a.xlh,2,b));this.mXa=null}this.oIa=this.PHa=null}Htc(){this.oIa&&Nc.a.Osb(this.oIa);this.oIa=Nc.a.qaa(Object(F.a)(this,this.S5a,"applyPendingChangesToServerIfRequired"),1E3)}q4d(a){const b=ad.a.v9a(a.ga(0),a.ga(3));a=ad.a.v9a(a.ga(1),a.ga(2));return new pj.a(new ad.a(b.x,b.y),new ad.a(a.x,b.y),new ad.a(a.x,a.y),new ad.a(b.x,a.y))}}Object(n.a)(zM,"FormatShapePaneActor",
null,[106,227]);class Zz{constructor(a,b,c,h,m,y,G){this.type="FormatTableTaskPaneProps";this.onChange=this.bottomMargin=this.topMargin=this.rightMargin=this.leftMargin=this.tableWidth=this.tableHeight=this.cellWidth=this.cellHeight=this.numberFormatInfo=null;this.isAspectRatioLocked=!1;this.onToggleAspectRatio=null;this.disabled=!1;this.emptyValueFields=0;const U=Object(ua.a)(Object,Dg.e().numberFormatInfo);if(!U)throw Error.argumentNull("numberFormatInfo");this.numberFormatInfo=U;this.cellHeight=
b;this.cellWidth=c;this.tableHeight=h;this.tableWidth=m;this.leftMargin=a.leftMargin;this.rightMargin=a.rightMargin;this.topMargin=a.topMargin;this.bottomMargin=a.bottomMargin;this.disabled=y;this.emptyValueFields=G}}Object(n.a)(Zz,"FormatTableTaskPaneProps",null,[]);class AM{constructor(){this.bottomMargin=this.topMargin=this.rightMargin=this.leftMargin=0;this.$ah=this.cbh=this.bbh=this.abh=-1}}Object(n.a)(AM,"Margins",null,[]);class BM{constructor(a,b,c,h,m,y,G,U,ja,va,Ta,fb,Db,gc,hc){this.nva=
this.Db=!1;this.Ali=320;this.pXa=!1;if(!a)throw Error.argumentNull("pptSelectionManager");if(!b)throw Error.argumentNull("appFrame");if(!c)throw Error.argumentNull("actionManager");if(!h)throw Error.argumentNull("focusManager");if(!m)throw Error.argumentNull("formatTablePane");if(!y)throw Error.argumentNull("graphOperationEventHandler");if(!G)throw Error.argumentNull("viewElementEventHandlers");if(!U)throw Error.argumentNull("viewEventSource");if(!ja)throw Error.argumentNull("pageView");if(!va)throw Error.argumentNull("unitConversion");
if(!Ta)throw Error.argumentNull("workspace");if(!Db)throw Error.argumentNull("tableReader");if(!gc)throw Error.argumentNull("rowReader");if(!hc)throw Error.argumentNull("columnReader");if(!fb)throw Error.argumentNull("dynamicScriptLoader");fb.loadScript("powerpoint-editor-intl").then(()=>{this.pXa=!0}).catch(Gc=>{Ba.a.J(512500574,801,10,"Failed to load powerpoint-editor-intl "+Gc.toString())});this.ob=a;this.Qb=b;this.ia=c;this.Fa=h;this.Lg=y;this.qd=G;this.Lc=U;this.Lg.kI(Object(F.a)(this,this.AYa,
"onChangeRenderFormatTablePane"));this.Lg.BBa(Object(F.a)(this,this.AYa,"onChangeRenderFormatTablePane"));this.Lc.oPa(Object(F.a)(this,this.AYa,"onChangeRenderFormatTablePane"));this.qd.EBa(Object(F.a)(this,this.AYa,"onChangeRenderFormatTablePane"));this.Qb.IK(Object(F.a)(this,this.Mu,"onAppFrameModeSwitched"));this.rJ=hc;this.MXa=gc;this.yc=Db}dispose(){this.Lg.F5(Object(F.a)(this,this.AYa,"onChangeRenderFormatTablePane"));this.Lg.NZa(Object(F.a)(this,this.AYa,"onChangeRenderFormatTablePane"));this.Lc.gib(Object(F.a)(this,
this.AYa,"onChangeRenderFormatTablePane"));this.qd.iib(Object(F.a)(this,this.AYa,"onChangeRenderFormatTablePane"));this.Qb.wY(Object(F.a)(this,this.Mu,"onAppFrameModeSwitched"))}vb(){this.ia.ra(M.a.Eqc,nc.a.application,Object(F.a)(this,this.Eqc,"showHideReactFormatTablePane"),4);this.ia.ra(M.a.IIb,nc.a.application,Object(F.a)(this,this.IIb,"queryReactFormatTablePane"),96)}De(){}AYa(){this.Db&&this.em(!0)}Mu(a){1===a.mode&&this.Db&&(this.Db=!1,this.zr(),this.Fa.Bj(Ua.a.Sya,this.Db))}IIb(a,b,c,h,m){(a=
Object(ua.a)(Ph.a,m))&&a.Qf(this.Db);return 32}Eqc(a,b,c){if(!this.pXa)return 8;b=this.ob.sg();if(1===c)return b.length?32:8;this.Db=!this.Db;return zg.b("FormatTablePaneActor::ShowHideFormatTablePane PaneOpen: ",this.Db.toString(),a,()=>{this.Db?this.em():this.zr();return 32})}em(a=!1){const b=this.jC(),c=Object.assign(new ju.a,{title:ResourceStrings.L_FormatTable,hideHeader:!1,width:this.Ali,location:2,contentProps:b,onOpen:()=>{Ba.a.J(512500573,833,50,"FormatTablePaneActor::ShowHideReactFormatTablePane pane is now visible")},
onClose:()=>{this.Db=!1;Ba.a.J(512500572,833,50,"FormatTablePaneActor::ShowHideReactFormatTablePane pane is now hidden")},isModernPane:!0});fj.UISurfaces.xr().then(h=>{a?h.updateTaskPane(Ua.a.Sya,c):h.showTaskPane(Ua.a.Sya,c);return null}).catch(h=>{Ba.a.J(512500571,822,10,"FormatTablePaneActor::ShowPane, Failed to show format table pane. Exception: "+h.toString())})}zr(){fj.UISurfaces.xr().then(a=>{a.hideTaskPane(Ua.a.Sya,2);return null}).catch(a=>{Ba.a.J(512500570,822,10,"FormatTablePaneActor::HidePane, Failed to hide format table pane. Exception: "+
a.toString())})}jC(){var a=this.ob.Ym();const b=new AM;if(!a)return a=new Zz(b,0,0,0,0,!0,255),this.yTe(a);let c=0,h=0;({cellHeight:c,cellWidth:h}=this.Qej(a,c,h));const m=te.a.Jv(this.yc.t9d(a)),y=te.a.Jv(this.yc.v9d(a));let G=this.ob.rv();G&&G.length||(G=this.yc.DF(a));if(!G||!G.length)return a=new Zz(b,c,h,m,y,!0,255),this.yTe(a);this.Pej(G,b);a=new Zz(b,c,h,m,y,!1,0);this.yTe(a);this.Ozl(a);return a}yTe(a){a.onChange=Object(F.a)(this,this.Wwa,"onPropertyChange");a.isAspectRatioLocked=this.nva;
a.onToggleAspectRatio=Object(F.a)(this,this.onToggleAspectRatio,"onToggleAspectRatio");return a}Qej(a,b,c){let h=this.ob.iTc(),m=this.ob.Nwb();h&&h.length||(h=this.yc.Zja(a));m&&m.length||(m=this.Uwb(a));h.length&&(b=te.a.Jv(this.MXa.UYf(h)));m.length&&(c=te.a.Jv(this.rJ.WYf(a,m)));return{cellHeight:b,cellWidth:c}}Pej(a,b){let c=!0,h=!0,m=!0,y=!0;for(const G of a)G&&!G.isGhostCell&&({EXc:c,cellMargin:b.leftMargin,rhd:b.abh}=this.gtd(c,b.leftMargin,G.marginLeft,b.abh),{EXc:h,cellMargin:b.rightMargin,
rhd:b.bbh}=this.gtd(h,b.rightMargin,G.marginRight,b.bbh),{EXc:m,cellMargin:b.topMargin,rhd:b.cbh}=this.gtd(m,b.topMargin,G.marginTop,b.cbh),{EXc:y,cellMargin:b.bottomMargin,rhd:b.$ah}=this.gtd(y,b.bottomMargin,G.marginBottom,b.$ah))}gtd(a,b,c,h){a&&(b=te.a.Jv(c),0<=h&&h!==b&&(b=-1,a=!1),h=b);return{EXc:a,cellMargin:b,rhd:h}}Ozl(a){0>a.cellHeight&&(a.emptyValueFields|=1);0>a.cellWidth&&(a.emptyValueFields|=2);0>a.leftMargin&&(a.emptyValueFields|=16);0>a.rightMargin&&(a.emptyValueFields|=32);0>a.topMargin&&
(a.emptyValueFields|=64);0>a.bottomMargin&&(a.emptyValueFields|=128)}Wwa(a,b){const c={};c.Number=a;switch(b){case 0:this.ia.La(M.a.R_a,2,c);break;case 1:this.ia.La(M.a.JKa,2,c);break;case 2:this.ia.La(M.a.soa,2,c);break;case 3:this.ia.La(M.a.KKa,2,c);break;case 4:this.ia.La(M.a.Grc,2,c);break;case 5:this.ia.La(M.a.Krc,2,c);break;case 6:this.ia.La(M.a.Lrc,2,c);break;case 7:this.ia.La(M.a.Frc,2,c)}}onToggleAspectRatio(a){this.nva=a;this.ia.La(M.a.opc,2,null)}Uwb(a){let b=null;a&&14===a.type&&(b=this.yc.r9d(a.firstRow));
return b}}Object(n.a)(BM,"FormatTablePaneActor",null,[106,227]);class $z{constructor(a,b,c){this.pa=a;this.Fb=b;this.Ea=c}process(a,b,c,h){2===c&&32===h&&b.contextId===xb.a.view&&Array.contains($z.N_k,a)&&(a=this.pa.Xd(),0<a.length&&0<this.Ea.textLength(a[0])&&this.Ppi(a[0]))}Ppi(a){if(!a.H$){var b=yd.SelectionFactory.wl(a);b=Bb.SelectionEditor.t3b(b);var c=Bb.SelectionEditor.s3b(b,!1);b=yd.SelectionFactory.wN(b,c.Ua,!1);if((c=this.pa.Pa)&&c.mb&&c.mb.contains(b)&&2===a.wz){var h=Object(ua.a)(117,
a.sc(this.Fb.Ma));if(h){b=a.wz;c=a.q1;var m=a.r1;a.wz=1;a.q1=1;a.r1=0;h=h.SPf();h.uxf();h.xwf();h.uza();h.fSf()&&(a.wz=b,a.q1=c,a.r1=m);h.detach();h.Z1e()}}}}}$z.N_k=[D.a.ir,D.a.DI,D.a.UJ];Object(n.a)($z,"FormattingViewOperationFinishedStageProcessor",null,[333]);var OQ=d(613);class CM extends Sys.EventArgs{constructor(a){super();this.section=a}}Object(n.a)(CM,"SectionNodeChangedArgs",Sys.EventArgs,[]);class DM{constructor(a,b,c,h,m,y,G,U,ja,va,Ta,fb,Db){this.TQ=null;this.nt=a;this.Jb=b;this.Vb=c;
this.pa=h;this.Fa=m;this.la=U;this.jn=this.la.tC;this.Ie=G;this.vea=this.la.Ije;this.Sb=y;this.y6c=this.la.z$b;this.fc=ja;this.Fu=va;this.ua=Ta;this.Fb=fb;Db.execute(gc=>{this.TQ=gc})}BSi(a,b,c){if(a&&a.length){for(var h of a)if(!h||lc.a.ax(h.Cb))return;h=this.la.Ks?!0:u.AFrameworkApplication.fa.ka("PPTSorterViewEnabled")&&!!this.Fb&&1===this.Fb.Sl;var m=this.Jb.zd(15,void 0,()=>{this.Fa.xf(Di.a.JD);this.pa.Qh()});try{m.nc(this.nt),this.vea?this.nt.kDe(a,b,c,h):this.nt.jDe(a[0],b,c,h)}finally{m&&
m.dispose()}}}nRf(a,b){var c=this.Sb.Pn;if(c&&c.Tp)if(b&&!a||!b&&a===c.Tp.length-1)Ba.a.J(509364431,822,50,"ExecuteMoveSectionGraphTransaction: User has attempted to move a section out of range.");else{var h=Rd.a("FixSectionMoveBug")?c.I1k:c.Tp;var m=Date.now(),y=this.Jb.zd(15,void 0,()=>{},()=>{});try{y.nc(this.nt);const G=h[a],U=b?h[a-1]:h[a+1];c.setValue(X.a.tik,G);c.setValue(X.a.Zhk,U);if(G&&U){let ja=-1,va=-1;for(let Ta=0;Ta<h.length&&!(G===h[Ta]&&(ja=Ta),U===h[Ta]&&(va=Ta),0<=ja&&0<=va);Ta++);
Array.removeAt(h,ja);Array.insert(h,va,G);c.anchor?c.anchor.wkb(h,34,!1):Ba.a.J(509364430,822,10,"ExecuteMoveSectionGraphTransaction: Presentation node should have valid anchor.")}}finally{y&&y.dispose()}this.ua.Nz=b?0<=a-1?a-1:0:a+1;c=Date.now();Ba.a.J(509364429,822,50,"ExecuteMoveSectionGraphTransaction: selectedSectionIndex: {0}, transactionStartTime: {1}, transactionFinishTime: {2}, elapse: {3}, isMoveUp: {4}",a,m,c,c-m,b);this.Fu?this.Fu.oNe():Ba.a.J(509364428,822,10,"ExecuteMoveSectionGraphTransaction: graphOperationEventNotifier is null for raising event.")}else Ba.a.J(509364432,
808,10,"ExecuteMoveSectionGraphTransaction: pageManifest or SectionNodes are null.")}kSi(a,b){if(a){var c=this.Sb.Pn;if(c){var h=c.Tp;h&&h.length||Ba.a.J(509364425,822,50,"ExecuteAddSectionGraphTransaction: User has added first section.");c=Date.now();var m=this.Jb.zd(15,void 0,()=>{},()=>{});try{m.nc(this.nt);m.jd=b;const y=h&&h.length?this.Ie.KW(a.Cb):0;this.nt.I5a(a,y)}finally{m&&m.dispose()}this.fc.Zv(this.nt,b);b=Date.now();Ba.a.J(509364424,822,50,"ExecuteAddSectionGraphTransaction: selectedSlideIndex: {0}, transactionStartTime: {1}, transactionFinishTime: {2}, elapse: {3}",
a.slideIndex,c,b,b-c);this.Fu?this.Fu.oNe():Ba.a.J(509364423,822,10,"ExecuteAddSectionGraphTransaction: graphOperationEventNotifier is null for raising event.")}else Ba.a.J(509364426,808,10,"ExecuteAddSectionGraphTransaction: pageManifest is null.")}else Ba.a.J(509364427,808,10,"ExecuteAddSectionGraphTransaction: selectedSlideNode is null.")}NSi(a){var b=this.Sb.Pn;if(b&&b.Tp){var c=b.Tp;if(!a||a.sectionIndex>=c.length)Ba.a.J(509364421,808,10,"ExecuteUpdateSectionGraphTransaction: invalid .");else{var h=
b.U3f(a.sectionIndex);c=null;h&&(c=Object(ua.a)(OQ.a,b.Igj(h.GE)));b=Date.now();h=this.Jb.zd(15,void 0,()=>{this.Fa.Ed();this.pa.Qh()},()=>{});try{h.nc(c),c.title=a.rBl}finally{h&&h.dispose()}c=Date.now();Ba.a.J(509364420,822,50,"ExecuteUpdateSectionGraphTransaction: updateSectionIndex: {0}, transactionStartTime: {1}, transactionFinishTime: {2}, elapse: {3}, ",a.sectionIndex,b,c,c-b)}}else Ba.a.J(509364422,808,10,"ExecuteUpdateSectionGraphTransaction: pageManifest or SectionNodes are null.")}GSi(a,
b){const c=this.Sb.Pn;if(c&&c.Tp){var h=c.Tp,m=this.ua.Sba,y=Date.now(),G=h.length,U=this.Jb.zd(15,void 0,()=>{},()=>{});try{U.nc(this.nt);U.jd=b;if(a){const ja=this.Sb.Lwb(a-1);let va=m.uA;if(ja&&va){const Ta=ja.uA?ja.uA:[];for(let fb=0;fb<va.length;fb++)Array.insert(Ta,Ta.length,va[fb]);va=[];ja.uA=Ta}}Array.removeAt(h,a);c.lLf(m)}finally{U&&U.dispose()}this.ua.Nz=0<=a-1?a-1:0;this.fc.Zv(this.nt,b);b=Date.now();Ba.a.J(509364418,822,50,"ExecuteRemoveSectionGraphTransaction: selectedSectionIndex: {0}, transactionStartTime: {1}, transactionFinishTime: {2}, elapse: {3}, initialSectionArrayLength: {4}, finialSectionArrayLength: {5}",
a,y,b,b-y,G,h.length);this.Fu?this.Fu.eKk(new CM(m)):Ba.a.J(509364417,822,10,"ExecuteRemoveSectionGraphTransaction: graphOperationEventNotifier is null for raising event.")}else Ba.a.J(509364419,808,10,"ExecuteRemoveSectionGraphTransaction: pageManifest or SectionNodes are null.")}kOc(a,b,c,h){if(!b||!this.y6c&&!c)return null;let m=null;const y=this.Jb.zd(15,void 0,()=>{Rd.a("FixDocumentFocusIssue")||this.Fa.Ed();this.pa.Qh()},()=>{1!==this.Fb.Sl&&(Rd.a("FixDocumentFocusIssue")?this.Fa.xf(this.Fa.Be.name):
this.Fa.xf(Di.a.JD))});try{let G;G=this.la.Ks?!0:u.AFrameworkApplication.fa.ka("PPTSorterViewEnabled")&&!!this.Fb&&1===this.Fb.Sl;let U;U=Rd.a("SlideSorterInsertionAfterFirstSlide")?!!this.Fb&&1===this.Fb.Sl&&-1===this.Vb.oxa:!!this.Fb&&1===this.Fb.Sl&&!this.Vb.oxa;const ja=this.ua.Sba;if(G&&ja&&(!ja.VJ||!ja.VJ.length)||U)U&&(this.Vb.oxa=-1),a=null;y.nc(this.Vb.Cf);y.jd=h;m=Object(ua.a)(116,this.nt.IXb(a,ja,b,c,G));this.jn&&this.pa.WU(m);this.Vb.Ba=m;this.Vb.Cf.removeProperty(X.a.kIe)}finally{y&&
y.dispose()}return m}ASi(a,b,c,h,m,y){if(5!==h)throw Error.invalidOperation();const G=Object(ua.a)(116,this.nt.dXd(a,b,c));if(!G)return Ba.a.J(509364416,822,10,"CreateSlideNodeForInsertion returned null"),null;b=this.la.Ks?!0:u.AFrameworkApplication.fa.ka("PPTSorterViewEnabled")&&!!this.Fb&&1===this.Fb.Sl;c=this.Jb.zd(15,void 0,()=>{this.Fa.Ed();this.pa.Qh()},()=>{this.jn&&this.pa.WU(G);this.Fa.xf(Di.a.JD)});try{c.nc(this.Vb.Cf),c.jd=y,this.nt.P$a(G,a,null,b),m&&(this.Vb.Ba=G)}finally{c&&c.dispose()}return G}uSi(a,
b){var c=null;if(!a)throw Error.argumentNull("srcSlideNode");c||(c=a);let h;h=this.la.Ks?!0:u.AFrameworkApplication.fa.ka("PPTSorterViewEnabled")&&!!this.Fb&&1===this.Fb.Sl;let m=null;const y=this.Jb.zd(15,void 0,()=>{this.Fa.Ed();this.pa.Qh()},()=>{1!==this.Fb.Sl&&this.Fa.xf(Di.a.JD)});try{y.nc(this.Vb.Cf),y.jd=b,m=Object(ua.a)(116,this.nt.gQ(Object(ua.a)(115,a),Object(ua.a)(115,c),h,!0)),this.TQ&&this.TQ.TLf([m]),this.jn&&this.pa.WU(m),this.Vb.Ba=m}finally{y&&y.dispose()}return m}jRf(a,b,c,h,m){if(!a||
!a.length)throw Error.argumentNull("srcSlideNodes");const y=[];a=Array.clone(a);a.sort((ja,va)=>va.oe-ja.oe);c||(c=a[0]);let G;G=this.la.Ks?!0:u.AFrameworkApplication.fa.ka("PPTSorterViewEnabled")&&!!this.Fb&&1===this.Fb.Sl;const U=this.Jb.zd(15,void 0,()=>{this.Fa.Ed();this.pa.Qh()},()=>{1!==this.Fb.Sl&&this.Fa.xf(Di.a.JD)});try{U.nc(this.Vb.Cf);U.jd=b;for(b=0;b<a.length;b++){if(!a[b])continue;const va=Object(ua.a)(116,this.nt.gQ(Object(ua.a)(115,a[b]),Object(ua.a)(115,c),G,m));ta.a.Wa(h)||(va.Ub=
h);Array.add(y,va)}0<y.length&&this.TQ&&this.TQ.TLf(y);let ja;(ja=this.pa).WU.apply(ja,y);this.Vb.Ba=y[y.length-1];this.Ie.U7a=!0}finally{U&&U.dispose()}return y}zW(a,b,c,h=null,m=null,y=!0){if(!a)throw Error.argumentNull("shapeNodes");if(!a.length)throw Error.argumentOutOfRange("shapeNodes.Length",a.length);if(!b)throw Error.argumentNull("slideNode");if(h&&a.length!==h.length)throw Error.invalidOperation();let G=null;y&&1!==this.Fb.Sl&&(G=()=>{this.pa.s_a(a,!0)});y=this.Jb.zd(15,void 0,()=>{this.pa.Vx();
this.pa.Qh();this.Fa.Ed()},G);try{y.nc(b);y.jd=c;this.o7h(y,a);const U=new Sys.StringBuilder;for(c=0;c<a.length;c++){const ja=h?h[c]:null;a[c]&&(b.UB(a[c],ja),a[c].id&&U.append(a[c].id.toString()+";"))}y.Py[wq.a.A9g]=U.toString();m&&b.KU([m])}finally{y&&y.dispose()}}o7h(a,b){if(1!==b.length||!b[0].ud&&ta.a.Wa(b[0].YYa))for(const c of b){if(c.Gab||c.Ej)a.Py[wq.a.W6b]=!0;if(c.Mp||2===c.mediaType||1===c.mediaType)a.Py[wq.a.$Uc]=!0;c.ar&&(a.Py[wq.a.ZUc]=!0)}else a.Py[wq.a.X6b]=!0}a8a(a,b){if(!(1>b.length)){var c=
this.Jb.zd(15);try{c.nc(b[0]);const h=this.pa.YO(Array.isArray(b)?b:null);for(const m of h)a(m)}finally{c&&c.dispose()}}}sja(a,b){this.a8a(c=>{(c=Object(ua.a)(4,c))&&a(c)},b)}}Object(n.a)(DM,"GraphTransactionHelperProxy",null,[298]);var wE=d(296),Hp=d(297);class EM{constructor(a,b,c,h){this.Boc=a;this.Coc=b;this.f0c=c;this.g0c=h}Y2e(a,b,c,h){a<this.Boc&&(this.Boc=a);b<this.Coc&&(this.Coc=b);a+c>this.f0c&&(this.f0c=a+c);b+h>this.g0c&&(this.g0c=b+h)}}Object(n.a)(EM,"GroupShapeOffset",null,[]);class FM{constructor(a,
b,c,h,m,y,G,U,ja,va){this.ia=a;this.Jb=b;this.pa=c;this.Ea=h;this.ua=m;this.Tk=y;this.Fb=G;this.Pi=U;this.eJ=ja;this.la=va}vb(){this.ia.ra(M.a.AJe,nc.a.application,Object(F.a)(this,this.brj,"handleGroupShapes"),4);this.ia.ra(M.a.IJe,nc.a.application,Object(F.a)(this,this.rvj,"handleUngroupShapes"),4);this.ia.ra(M.a.zJe,nc.a.application,Object(F.a)(this,this.arj,"handleGroupFlyoutAnchor"),4)}De(){const a=this.eJ.Jo.Gc(Ua.a.rg);a.bindAction(w.KeyInputManager.Na(z.a.iPb,w.KeyInputManager.Le),M.a.AJe);
a.bindAction(w.KeyInputManager.Na(z.a.iPb,w.KeyInputManager.Le|4),M.a.IJe)}TAf(a){let b=1<a.length&&!a[0].Kg&&!a[1].Kg;if(b)for(const c of a)if(this.la.cka){if(c.VFb||c.gl||c.ud){b=!1;break}}else if(c.gl||c.ud){b=!1;break}return b}Hcj(a){a=a.get_shapeRotation()%180;0<=a&&45>a?a=0:45<=a&&135>a?a=90:135<=a&&180>a&&(a=0);return a}brj(a,b,c){const h=this.pa.Xd();return this.TAf(h)?1===c?32:zg.a("GroupOperations_GroupShapes",a,()=>{const m=[];for(var y of h)m.push(y.id);y=Object(ua.a)(116,this.ua.Ba);
if(!y)throw Error.argumentNull("ActiveSlide is null");const G=y.Pt(),U=new EM(y.oq,y.Wk,0,0);var ja=0;let va=ja=0;for(var Ta of h)(ja=this.Hcj(Ta),Ta.Vy)?(ja=Ta.qy,va=Ta.ry,U.Y2e(ja,va,Ta.Bca,Ta.Aca)):ja?90===ja&&(ja=Ta.qy+Ta.nx/2-Ta.wC/2,va=Ta.ry+Ta.wC/2-Ta.nx/2,U.Y2e(ja,va,Ta.wC,Ta.nx)):(ja=Ta.qy,va=Ta.ry,U.Y2e(ja,va,Ta.nx,Ta.wC));const fb=this.Tk.FQa(!1,y.Cb.cid,y.Cb.sid,0,10,U.Boc,U.Coc,U.f0c-U.Boc,U.g0c-U.Coc,G+1);Ba.a.J(595359714,822,50,"GroupUngroupShapesActor::HandleGroupShapes : Group Action performed on {0}",
h.length);this.fFj(fb,y.Cb,U.f0c-U.Boc,U.g0c-U.Coc);y.UB(fb);Ta=this.Jb.zd(15,void 0,void 0,()=>{this.pa.selectShape(fb,!0)});try{Ta.nc(y),Ta.jd=a,1<m.length&&(y.C8=m)}finally{Ta&&Ta.dispose()}return 32}):8}iBf(a){for(const b of a)if(this.la.cka){if(b.Jf&&!b.WFb)return!0}else if(b.Jf)return!0;return!1}rvj(a,b,c){const h=this.pa.Xd();return this.iBf(h)?1===c?32:zg.a("GroupOperations_UngroupShapes",a,()=>{const m=[];var y=[];for(const U of h)if(U.Jf){m.push(U.id);const ja=this.Ea.Yw(U);for(const va of ja)y.push(va);
this.pa.Z7(U)}for(var G of y)y=Lh.c(G,this.Fb.Ma),this.pa.Z7(G),y.gka(),y.sKb=!0;G=this.ua.Ba;Ba.a.J(595359712,822,50,"GroupUngroupShapesActor::HandleUngroupShapes : Ungroup Action performed on {0}",h.length);y=this.Jb.zd(15);try{y.nc(G),y.jd=a,G.Uoa=m}finally{y&&y.dispose()}return 32}):8}arj(a,b,c){b=this.pa.Xd();a=this.TAf(b);b=this.iBf(b);return 1===c?a||b?32:8:32}fFj(a,b,c,h){var m=Object(ua.a)(295,Object(ua.a)(116,this.ua.Ba).tg(this.Fb.Ma));const y=this.Fb.Ld,G=Math.round(this.Pi.zM(y.Me(c,
0),m.mT));m=Math.round(this.Pi.zM(y.Me(h,1),m.mT));a.setValue(kb.a.nx,c);a.setValue(kb.a.wC,h);a.setValue(X.a.cPb,c);a.setValue(X.a.rxb,h);a.isEditable=!0;a.Jf=!0;a.setValue(X.a.KK,4);a.setValue(X.a.skd,!0);a.Bca=$d.a.pJa(G,0);a.Aca=$d.a.pJa(m,1);a.setValue(X.a.iRa,0);a.setValue(X.a.jRa,0);a.setValue(X.a.vUa,!0);a.setValue(X.a.isResizable,!0);a.setValue(X.a.vL,!0);a.UN=!0;a.pUa=!0;a.vL=!0;a.isResizable=!0;a.jG=lc.a.PE(b.sid,b.cid);a.hkb=a.get_shapeId();a.setValue(X.a.Uta,!0);b=Object.assign(new wE.a,
{TopLeft:Object.assign(new Hp.a,{X:0,Y:0}),TopRight:Object.assign(new Hp.a,{X:G,Y:0}),BottomLeft:Object.assign(new Hp.a,{X:0,Y:m}),BottomRight:Object.assign(new Hp.a,{X:G,Y:m})});a.NU=b;this.Ea.wL(a)&&Nc.a.Ib&&(Nc.a.Ib.Nj=!0)}}Object(n.a)(FM,"GroupUngroupShapesActor",null,[227]);class GM{constructor(){this.isFooterInsert=this.omitOnTitle=!1;this.sFooterName=null;this.isMultipleSlidesSelected=this.isSlideNumInsert=!1}}Object(n.a)(GM,"FooterPaneInfo",null,[]);var HM=d(611);class xE{constructor(){this.ActiveSlideSid=
this.ActiveSlideCid=0;this.IsToggled=this.IsSlideNumInsert=this.IsOmitOnTitlePh=this.IsFooterInsert=!1;this.SFooterName=null}}Object(n.a)(xE,"PresFooterInfo",null,[]);var IM=d(639);class JM{constructor(a,b,c,h,m,y,G,U,ja,va,Ta,fb,Db){this.Hla=null;a("powerpoint-editor-intl").then(()=>{Ba.a.J(594321887,801,50,"Icons and strings script is loaded successfully");a("headerFooterManager").then(()=>{Ba.a.J(594321885,801,50,"Header Footer Pane Manager script is loaded successfully");this.Hla=headerFooterManager.FactoryGlobal.getHeaderFooterManagerInstance();
this.APk()}).catch(gc=>{Ba.a.J(594321883,801,10,"Failed to load headerfooter pane manager "+gc.toString())})}).catch(gc=>{Ba.a.J(594321881,801,10,"Failed to load powerpoint-editor-intl "+gc.toString())});this.ob=b;this.Qb=c;this.ia=h;this.Vb=m;this.ua=y;this.Fa=G;this.Av=U;this.Lg=ja;this.qd=va;this.Lc=Ta;this.Jb=fb;this.Lg.kI(Object(F.a)(this,this.zJ,"onChangeRenderHeaderFooterPane"));this.Lg.Hqb(Object(F.a)(this,this.zJ,"onChangeRenderHeaderFooterPane"));this.Lg.BBa(Object(F.a)(this,this.zJ,"onChangeRenderHeaderFooterPane"));
this.Lc.oPa(Object(F.a)(this,this.zJ,"onChangeRenderHeaderFooterPane"));this.qd.EBa(Object(F.a)(this,this.zJ,"onChangeRenderHeaderFooterPane"));this.Qb.IK(Object(F.a)(this,this.Mu,"onAppFrameModeSwitched"));this.ez=null;this.dDb=!1;this.xEb=Db}dispose(){this.Lg.F5(Object(F.a)(this,this.zJ,"onChangeRenderHeaderFooterPane"));this.Lg.pkd(Object(F.a)(this,this.zJ,"onChangeRenderHeaderFooterPane"));this.Lg.NZa(Object(F.a)(this,this.zJ,"onChangeRenderHeaderFooterPane"));this.Lc.gib(Object(F.a)(this,this.zJ,
"onChangeRenderHeaderFooterPane"));this.qd.iib(Object(F.a)(this,this.zJ,"onChangeRenderHeaderFooterPane"));this.Qb.wY(Object(F.a)(this,this.Mu,"onAppFrameModeSwitched"))}De(){}vb(){this.ia.ra(M.a.M$a,nc.a.application,Object(F.a)(this,this.M$a,"insertFooterFlyoutMenu"),4);this.ia.ra(M.a.PY,nc.a.application,Object(F.a)(this,this.PY,"showHideHeaderFooterPane"),4);this.ia.ra(M.a.RTa,nc.a.application,Object(F.a)(this,this.RTa,"insertSlideNumber"),4);this.ia.ra(M.a.gmc,nc.a.application,Object(F.a)(this,
this.gmc,"queryHeaderFooterPane"),96)}gmc(a,b,c,h,m){(a=Object(ua.a)(Ph.a,m))&&a.Qf(this.Av.isVisible);return 32}M$a(){return this.Hla&&this.Vb&&this.ua.Ba&&this.Vb.isEditingAllowed?32:8}PY(a,b,c){if(1===c)return this.Av&&this.ua.Ba?32:8;if(!this.Av)return 8;this.ez=null;this.Av.isVisible=!this.Av.isVisible;this.Av.isVisible?(zg.a("FooterPaneOpen",a,()=>{this.Lnc();return 32}),this.xEb||(this.Fa.Bj(Ua.a.HI,!0),this.Hla.focus())):this.Fa.Bj(Ua.a.HI,!1);return 32}RTa(a,b,c,h,m){return 1===c?this.ua.Ba?
32:8:zg.a("FooterPaneInsertSldNumber",a,()=>{const y=this.flc();this.Etc(y.OmitOnTitlePh,y.IsFooterInsert,y.SFooterName,!0);return this.PY(a,b,c,h,m)})}Mu(a){1===a.mode&&this.Av&&this.Av.isVisible&&(this.ez=null,this.Av.isVisible=!1,this.Fa.Bj(Ua.a.HI,!1))}H7d(a){const b=new Qa.a;a=a.WD();for(const c of a)(a=Ob.ParagraphReader.text(c))&&0<a.length&&b.add(a);return b.toArray().join(" ")}flc(){const a=new HM.a;a.IsSlideNumInsert=!1;a.IsFooterInsert=!1;a.SFooterName="";var b=this.ua.Ba;if(!b)return a;
if((b=b.Pk(!0))&&0<b.length)for(const c of b)!c.isLocal&&c.gl&&(5===c.Gj?a.IsSlideNumInsert=!0:6===c.Gj&&(a.IsFooterInsert=!0,b=c.isEditable&&!c.sC?this.H7d(c):"",0<b.length?a.SFooterName=b:Ba.a.J(594321879,822,50,"Footer string is empty")));a.OmitOnTitlePh=this.Vb.Cf.NIa;return a}isMultipleSlidesSelected(){const a=this.ob.We();return a&&1<a.length?!0:!1}Lnc(){if(this.Av.isVisible)if(this.ua.Ba){var a=this.flc(),b=this.isMultipleSlidesSelected();if(!this.ez||a.IsFooterInsert!==this.ez.IsFooterInsert||
a.IsSlideNumInsert!==this.ez.IsSlideNumInsert||a.OmitOnTitlePh!==this.ez.OmitOnTitlePh||a.SFooterName.localeCompare(this.ez.SFooterName)||b!==this.dDb){this.ez=a;this.dDb=b;var c=new GM;c.isFooterInsert=a.IsFooterInsert;c.isSlideNumInsert=a.IsSlideNumInsert;c.sFooterName=a.SFooterName;c.omitOnTitle=a.OmitOnTitlePh;c.isMultipleSlidesSelected=b;this.Hla.renderHeaderFooterTaskPane(IM.a.Dbe,c)}}else this.Av.isVisible=!1,this.ez=null}zJ(){this.Lnc()}APk(){this.Hla.addCloseHeaderFooterPaneEventListener(()=>
{this.Av.isVisible=!1;this.ez=null});this.Hla.addFocusHeaderFooterPaneListener(()=>{this.Fa.Bj(Ua.a.HI,!0)});this.Hla.addUpdateHeaderFooterListener((a,b,c,h,m)=>{this.J2e(a,b,c,h,m)});this.Hla.addUpdateMultiSlideHeaderFooterListener((a,b,c,h)=>{this.V2e(a,b,c,h)})}J2e(a,b,c,h,m){this.ua.Ba&&(m?this.b3e(a,b,c,h):this.Etc(a,b,c,h))}V2e(a,b,c,h){this.ua.Ba&&zg.a("FooterPaneMultiSlide",M.a.PY,()=>{const m=this.Jb.zd(15,void 0,()=>{this.ob.ij()});try{m.nc(this.ua.Ba);const y=this.ob.We();if(y&&1<y.length){for(const G of y){const U=
G.j8;U.IsSlideNumInsert=h;U.IsFooterInsert=b;U.OmitOnTitlePh=a;U.SFooterName=c;U.IsToggled=!U.IsToggled;G.j8=U}this.Vb.Cf.NIa=a}}finally{m&&m.dispose()}return 32})}Etc(a,b,c,h){let m="FooterPaneSingleSlide";const y=this.ua.Ba,G=y.j8;if(a||b||h)G.OmitOnTitlePh!==a?m+="_OPH":G.IsSlideNumInsert!==h?m+="_ISN":G.IsFooterInsert!==b&&(m+="_IFT");zg.a(m,M.a.PY,()=>{const U=this.Jb.zd(15,void 0,()=>{this.ob.ij()});try{U.nc(this.ua.Ba),G.IsSlideNumInsert=h,G.IsFooterInsert=b,G.OmitOnTitlePh=a,G.SFooterName=
c,G.IsToggled=!G.IsToggled,this.Vb.Cf.NIa=a,y.j8=G}finally{U&&U.dispose()}return 32})}b3e(a,b,c,h){zg.a("FooterPaneAllSlides",M.a.PY,()=>{const m=this.Jb.zd(15,void 0,()=>{this.ob.ij()});try{const y=this.Vb.Cf;m.nc(y);let G=y.zJa;G||(G=new xE);const U=this.ua.Ba;G.ActiveSlideCid=U.cid;G.ActiveSlideSid=U.sid;G.IsSlideNumInsert=h;G.IsFooterInsert=b;G.IsOmitOnTitlePh=a;G.SFooterName=c;G.IsToggled=!G.IsToggled;y.NIa=a;y.zJa=G}finally{m&&m.dispose()}return 32})}}Object(n.a)(JM,"HeaderFooterPaneActor",
null,[227]);class KM{constructor(){this.isFooterInsert=!1;this.sFooterName=null;this.isMultipleSlidesSelected=this.omitOnTitle=this.isSlideNumInsert=!1}}Object(n.a)(KM,"FooterPaneInfo",null,[]);class LM{constructor(){this.type="HeaderFooterContentProps";this.onFocusPane=this.onUpdateMultiSlideHeaderFooter=this.onUpdateHeaderFooter=this.activeSlideFooterInfo=null}}Object(n.a)(LM,"HeaderFooterContentProps",null,[]);class MM{constructor(a,b,c,h,m,y,G,U,ja,va,Ta,fb,Db){this.P4c=!1;Db?this.P4c=!0:a("powerpoint-editor-intl").then(()=>
{Ba.a.J(590210325,801,50,"Icons and strings script is loaded successfully");a("powerpoint-ribbon-intl").then(()=>{Ba.a.J(590210323,801,50,"Ribbon script is loaded successfully");a("taskPanes").then(()=>{Ba.a.J(590210321,801,50,"Header Footer Pane script is loaded successfully");this.P4c=!0}).catch(()=>{Ba.a.J(590210319,801,10,"Failed to load Header Footer Pane script")})}).catch(()=>{Ba.a.J(590210317,801,10,"Failed to load Ribbon script")})}).catch(gc=>{Ba.a.J(590210315,801,10,"Failed to load powerpoint-editor-intl "+
gc.toString())});this.ob=b;this.Qb=c;this.ia=h;this.Vb=m;this.ua=y;this.Av=U;this.Lg=ja;this.qd=va;this.Lc=Ta;this.Jb=fb;this.Lg.kI(Object(F.a)(this,this.zJ,"onChangeRenderHeaderFooterPane"));this.Lg.Hqb(Object(F.a)(this,this.zJ,"onChangeRenderHeaderFooterPane"));this.Lg.BBa(Object(F.a)(this,this.zJ,"onChangeRenderHeaderFooterPane"));this.Lc.oPa(Object(F.a)(this,this.zJ,"onChangeRenderHeaderFooterPane"));this.qd.EBa(Object(F.a)(this,this.zJ,"onChangeRenderHeaderFooterPane"));this.Qb.IK(Object(F.a)(this,
this.Mu,"onAppFrameModeSwitched"));this.ez=null;this.dDb=!1;this.xEb=Db}dispose(){this.Lg.F5(Object(F.a)(this,this.zJ,"onChangeRenderHeaderFooterPane"));this.Lg.pkd(Object(F.a)(this,this.zJ,"onChangeRenderHeaderFooterPane"));this.Lg.NZa(Object(F.a)(this,this.zJ,"onChangeRenderHeaderFooterPane"));this.Lc.gib(Object(F.a)(this,this.zJ,"onChangeRenderHeaderFooterPane"));this.qd.iib(Object(F.a)(this,this.zJ,"onChangeRenderHeaderFooterPane"));this.Qb.wY(Object(F.a)(this,this.Mu,"onAppFrameModeSwitched"))}De(){}vb(){this.ia.ra(M.a.M$a,
nc.a.application,Object(F.a)(this,this.M$a,"insertFooterFlyoutMenu"),4);this.ia.ra(M.a.PY,nc.a.application,Object(F.a)(this,this.PY,"showHideHeaderFooterPane"),4);this.ia.ra(M.a.RTa,nc.a.application,Object(F.a)(this,this.RTa,"insertSlideNumber"),4)}M$a(){return this.Vb&&this.ua.Ba&&this.Vb.isEditingAllowed?32:8}PY(a,b,c){if(1===c)return this.P4c?32:8;if(!this.Av)return 8;this.ez=null;this.Av.isVisible=!this.Av.isVisible;this.Av.isVisible?zg.a("WACFooterPaneOpen:: IsTabbedPaneEnabled: "+this.xEb.toString(),
a,()=>{this.Lnc();return 32}):this.zr();return 32}Mu(a){1===a.mode&&this.Av&&this.Av.isVisible&&(this.ez=null,this.Av.isVisible=!1,this.zr())}em(a=!1){const b=this.jC(),c=Object.assign(new ju.a,{title:ResourceStrings.l_InsertFooter,hideHeader:!1,width:320,location:2,contentProps:b,onOpen:()=>{},onClose:()=>{this.Av.isVisible=!1},isModernPane:!0});this.xEb?fj.UISurfaces.xr().then(h=>{a?h.updateTaskPane(Ua.a.HI,c):h.showTaskPane(Ua.a.HI,c);return null}):(this.Av.isVisible=!0,taskPanes.taskPane.renderTaskPane(IM.a.Dbe,
c))}zr(){this.xEb&&fj.UISurfaces.xr().then(a=>{a.hideTaskPane(Ua.a.HI,2);return null})}jC(){const a=new KM;a.isFooterInsert=this.ez.IsFooterInsert;a.sFooterName=this.ez.SFooterName;a.isSlideNumInsert=this.ez.IsSlideNumInsert;a.omitOnTitle=this.ez.OmitOnTitlePh;a.isMultipleSlidesSelected=this.dDb;const b=new LM;b.activeSlideFooterInfo=a;b.onUpdateHeaderFooter=Object(F.a)(this,this.J2e,"updateFooterInfo");b.onUpdateMultiSlideHeaderFooter=Object(F.a)(this,this.V2e,"updateMultiSlidesFooterInfo");return b}RTa(a,
b,c,h,m){return 1===c?this.P4c?32:8:zg.a("WACFooterPaneInsertSldNumber:: IsTabbedPaneEnabled: "+this.xEb.toString(),a,()=>{const y=this.flc();this.Etc(y.OmitOnTitlePh,y.IsFooterInsert,y.SFooterName,!0);return this.PY(a,b,c,h,m)})}H7d(a){const b=new Qa.a;a=a.WD();for(const c of a)(a=Ob.ParagraphReader.text(c))&&0<a.length&&b.add(a);return b.toArray().join(" ")}flc(){const a=new HM.a;a.IsSlideNumInsert=!1;a.IsFooterInsert=!1;a.SFooterName="";var b=this.ua.Ba;if(!b)return a;if((b=b.Pk(!0))&&0<b.length)for(const c of b)!c.isLocal&&
c.gl&&(5===c.Gj?a.IsSlideNumInsert=!0:6===c.Gj&&(a.IsFooterInsert=!0,b=c.isEditable&&!c.sC?this.H7d(c):"",0<b.length?a.SFooterName=b:Ba.a.J(590210313,822,50,"Footer string is empty")));a.OmitOnTitlePh=this.Vb.Cf.NIa;return a}isMultipleSlidesSelected(){const a=this.ob.We();return a&&1<a.length?!0:!1}Lnc(a=!1){if(this.Av.isVisible)if(this.ua.Ba){var b=this.flc(),c=this.isMultipleSlidesSelected();if(!this.ez||b.IsFooterInsert!==this.ez.IsFooterInsert||b.IsSlideNumInsert!==this.ez.IsSlideNumInsert||b.OmitOnTitlePh!==
this.ez.OmitOnTitlePh||b.SFooterName.localeCompare(this.ez.SFooterName)||c!==this.dDb)this.ez=b,this.dDb=c,this.em(a)}else this.Av.isVisible=!1,this.ez=null}zJ(){this.Lnc(!0)}J2e(a,b,c,h,m){this.ua.Ba&&(h?this.b3e(a,b,m,c):this.Etc(a,b,m,c))}V2e(a,b,c,h){this.ua.Ba&&zg.a("FooterPaneMultiSlide",M.a.PY,()=>{const m=this.Jb.zd(15,void 0,()=>{this.ob.ij()});try{m.nc(this.ua.Ba);const y=this.ob.We();if(y&&1<y.length){for(const G of y){const U=G.j8;U.IsSlideNumInsert=c;U.IsFooterInsert=b;U.OmitOnTitlePh=
a;U.SFooterName=h;U.IsToggled=!U.IsToggled;G.j8=U}this.Vb.Cf.NIa=a}}finally{m&&m.dispose()}return 32})}Etc(a,b,c,h){let m="FooterPaneSingleSlide";const y=this.ua.Ba,G=y.j8;if(a||b||h)G.OmitOnTitlePh!==a?m+="_OPH":G.IsSlideNumInsert!==h?m+="_ISN":G.IsFooterInsert!==b&&(m+="_IFT");zg.a(m,M.a.PY,()=>{const U=this.Jb.zd(15,void 0,()=>{this.ob.ij()});try{U.nc(this.ua.Ba),G.IsSlideNumInsert=h,G.IsFooterInsert=b,G.OmitOnTitlePh=a,G.SFooterName=c,G.IsToggled=!G.IsToggled,this.Vb.Cf.NIa=a,y.j8=G}finally{U&&
U.dispose()}return 32})}b3e(a,b,c,h){zg.a("FooterPaneAllSlides",M.a.PY,()=>{const m=this.Jb.zd(15,void 0,()=>{this.ob.ij()});try{const y=this.Vb.Cf;m.nc(y);let G=y.zJa;G||(G=new xE);const U=this.ua.Ba;G.ActiveSlideCid=U.cid;G.ActiveSlideSid=U.sid;G.IsSlideNumInsert=h;G.IsFooterInsert=b;G.IsOmitOnTitlePh=a;G.SFooterName=c;G.IsToggled=!G.IsToggled;y.NIa=a;y.zJa=G}finally{m&&m.dispose()}return 32})}}Object(n.a)(MM,"HeaderFooterPaneWacActor",null,[227]);class NM{constructor(a,b,c,h,m){this.Hs=a;this.ia=
b;this.Vb=c;this.ua=h;this.fc=m}vb(){this.ia.ra(M.a.uWc,xb.a.application,Object(F.a)(this,this.urj,"handleInsertContentFromStream"),4)}De(){}urj(a,b,c,h,m){b=this.ua.Ba;if(this.fc.$c(b))return 16;if(1===c)return 32;Nc.a.xk("SlideCount","1");c=this.Hs.ASi(b,m.streamUrl,m.formatType,m.objectType,m.renderAfterInsert,a);m.renderAfterInsert&&c&&!c.XN&&this.fc.Zv(this.Vb.Cf,a);return 32}}Object(n.a)(NM,"InsertContentFromStreamActor",null,[227]);class OM{constructor(a,b){this.Pi=a;this.Sb=b}mRd(a,b,c,h){const m=
G=>this.Pi.zM(a.Me($d.a.rf(G,0),0),h),y=Math.round(m(c.x+b.width))-Math.round(m(c.x));b=Math.round(m(c.y+b.height))-Math.round(m(c.y));return Object.assign(new wE.a,{TopLeft:Object.assign(new Hp.a,{X:0,Y:0}),TopRight:Object.assign(new Hp.a,{X:y,Y:0}),BottomLeft:Object.assign(new Hp.a,{X:0,Y:b}),BottomRight:Object.assign(new Hp.a,{X:y,Y:b})})}$Ud(a,b,c){var h=a?a.Tae:9;const m=$d.a.Me(a?a.k4e:6,0,!1);h=$d.a.Me(h,1,!1);b=this.Ovi(m,h,b,c);a=a?a.twb(b.width,b.height,!0):this.Sb.pta(b.width,b.height);
return{F1d:b,fD:a}}Ovi(a,b,c,h){let m=0,y=0;0<c&&0<h&&(a=Math.min(1*a/c,1*b/h,1),m=Math.max(c*a,1),y=Math.max(h*a,1));return new cr.a(m,y)}}Object(n.a)(OM,"InsertImageHelper",null,[338]);var Sd=d(674),aA=d(673);class PM{i4f(a,b,c,h){b=a.right-a.left;let m=a.bottom-a.top;b=Math.max(b,1);m=Math.max(m,1);Rd.a("FixInkDotInsertionAtHighZooms")?(a=h.zM(b,c),c=h.zM(m,c)):(a=Math.round(h.zM(b,c)),c=Math.round(h.zM(m,c)));return{jsh:a,ash:c}}qHf(a,b,c){return Object.assign(new wE.a,{TopLeft:Object.assign(new Hp.a,
{X:0,Y:0}),TopRight:Object.assign(new Hp.a,{X:a*c,Y:0}),BottomLeft:Object.assign(new Hp.a,{X:0,Y:b*c}),BottomRight:Object.assign(new Hp.a,{X:a*c,Y:b*c})})}Rph(){}bqh(){}}Object(n.a)(PM,"InsertInkActorHelper",null,[467]);var PQ=d(499);class bA{constructor(a,b,c,h,m,y,G,U,ja,va,Ta,fb,Db){this.H9=Db;this.Hs=a;this.ia=b;this.ua=c;this.fc=h;this.Fb=m;this.Hu=U;this.Tk=ja;this.Wj=va;this.Ea=Ta;this.Pi=fb}dispose(){}vb(){this.ia.ra(M.a.Jcg,xb.a.application,Object(F.a)(this,this.vrj,"handleInsertInk"),4)}De(){}vrj(a,
b,c,h,m){if(!m)return 16;b=m.Fd;if(!b)return Ba.a.J(595080221,822,15,"HandleInsertInk was called with invalid slideNode!"),8;h=b.Cb;if(lc.a.ax(h)||this.fc.$c(b))return 16;if(1===c)return 32;c=this.U8a(a);if(!c)return 8;if(!this.Wj.JF(b,1))return this.Wj.hG(b),16;var y=m.TEj;if(!y)return Ba.a.J(595153805,822,15,"HandleInsertInk was called with invalid actionData!"),8;if(!y.count)return Ba.a.J(595153803,822,15,"HandleInsertInk was called with 0 ink objects!"),8;m=new Qa.a;for(let Ta of y){y=Ta.Thi;
if(!y)return 16;var G=b.Ow;G=G&&null!=G.Wr?G.Wr:1;y.right=y.left+(y.right-y.left)/(1/G);y.bottom=y.top+(y.bottom-y.top)/(1/G);var U=y.right-y.left,ja=y.bottom-y.top;U=Math.max(U,1);ja=Math.max(ja,1);var va=this.Fb.Ld;U=$d.a.rf(U,0);ja=$d.a.rf(ja,1);const fb=va.rf(y.left,0);va=va.rf(y.top,1);const Db=b.Pt();y=aA.a.gLc(h,c,G,y,new PM,fb,va,U,ja,Db,this.Ea,this.Tk,this.Fb,this.ua,this.Pi);y.setValue(X.a.qka,Ta.json);y.setValue(X.a.cFa,!0);Nc.a.Ib&&(Nc.a.Ib.actionName=bA.vUc);y.lI=new PQ.a([Ta.stroke],
Ta.json,!1);m.add(y)}this.Hs.zW(m.toArray(),b,a,void 0,void 0,!1);for(let Ta of m)this.H9.registerInkWithStrokeCollection(Ta.lI.Iya,Ta.id);this.Hu.NF=m.ga(m.count-1);return 32}U8a(){return new Sd.a(4,10,1,1)}}bA.vUc="InsertInk";Object(n.a)(bA,"InsertInkActor",null,[227,106]);class QM{constructor(a,b,c,h,m,y,G,U,ja,va,Ta){this.Jj=null;this.x5c=!1;this.Fb=a;this.Tk=b;this.Fa=c;this.ua=h;this.Sb=m;this.pa=G;this.Hu=U;this.Wj=ja;this.Jb=va;this.fc=Ta;this.la=y;this.zBl=y.insertOnlineVideoUrlPatterns;
this.Vjh=y.insertOnlineVideoEndpoint;this.tw=u.AFrameworkApplication.Je;this.pql=3E4}get startTime(){return this.Jj}ETi(a){if(!a)return null;const b=a.trim();this.MMj(b)&&(Ba.a.J(38322700,352,50,"[Insert Online Video] Used iframe instead of url"),a=this.FTi(b));return a}ulg(a){if(!a)return!1;a=a.trim();for(const b of this.zBl)if((new RegExp(b)).test(a))return!0;return!1}DVj(a){if(!a)return!1;a=a.trim();a=ng.a.UD(a).toLowerCase();return!this.la.jab&&"shorts.flipgrid.com"===a||"flipgrid.com"===a||"www.flipgrid.com"===
a||!this.la.Izb&&("embed.ted.com"===a||"www.ted.com"===a||"ted.com"===a)?!1:!0}nul(a,b){this.requestVideoData(a,c=>{this.Wcg(c)},b)}requestVideoData(a,b,c){this.x5c?Ba.a.J(38901280,352,15,"[Insert Online Video] Multiple videos at the same time!"):(this.x5c=!0,c=c||Object(F.a)(this,this.VMi,"doNothingCallback"),this.Jj=new Date,a=ta.a.Ke(a),a=this.Vjh+(0<this.Vjh.indexOf("?")?"&":"?")+"url="+a,this.tw.Aj(a,1,null,null,!1,2,h=>{b(h);this.x5c=!1},h=>{c(h);this.x5c=!1},null,void 0,void 0,void 0,this.pql,
Ax.a("1")))}Wcg(a){var b=+new Date-+this.startTime;Ba.a.J(38322702,352,50,"[Insert Online Video] Success!!! Hubble call completed in {0}ms",b);Nc.a.xk("HubbleCallDuration",b.toString());if((b=this.ua.Ba)&&!this.fc.$c(b)&&this.Wj.JF(b,1))try{const U=b.n3(this.pa.Xd());if(!U||!this.fc.$c(U)){var c=this.H9a(b,U),h=JSON.parse(a.data.Zd),m=h.width,y=h.height;c.WTe(h.embed_url,h.thumbnail_url,h.title,h.description,0<m?m:0,0<y?y:0);var G=this.Jb.zd(15,void 0,()=>{this.pa.Vx();this.pa.Qh();this.Fa.Ed()},
()=>{this.pa.selectShape(c,!0)});try{G.kd(b),this.la.rsl&&(G.jd=M.a.Ota,G.Py[wq.a.$Ca]=wq.a.online),U&&b.KU([U]),b.UB(c)}finally{G&&G.dispose()}this.fc.Zv(b,"InsertOnlineVideo");this.Hu.NF=c;Ba.a.J(38322704,352,50,"[Insert Online Video] Video inserted")}}catch(U){Ba.a.J(38322706,352,10,"[Insert Online Video] Exception after successful Hubble callback: Exception = [{0}], stack = {1}.",U.message,U.stack)}else this.Wj.hG(b)}VMi(){}H9a(a,b){if(!a)return null;var c=a.Cb;a=a.Pt();let h;const m=xf.a.cY,
y=xf.a.h5;h=b?b.twb(xf.a.cY,xf.a.h5):this.Sb.pta(xf.a.cY,xf.a.h5);const G=b?0:0*Aq.a.HS;c=this.Tk.$ra(!0,c.cid,c.sid,0,h.x+G,h.y+G,m,y,a+1,!0);b&&(c.eca=b.id);return c}FTi(a){if(!a)return null;a=RegExp("src\\s*=\\s*['\"][^'\"]*").exec(a);if(!a||1!==a.length)return Ba.a.J(38322708,352,10,"[Insert Online Video] iframe error"),null;a=a[0];let b=a.indexOf('"');-1===b&&(b=a.indexOf("'"));return a=a.substr(b+1)}MMj(a){return a?RegExp(".*iframe.*").test(a):!1}ZZf(a){if(!a)return"NA";let b=a.indexOf(".com/");
if(-1===b)return"NA";if(a.startsWith("https://"))a=a.substring(8,b);else if(a.startsWith("http://"))a=a.substring(7,b);else return"NA";b=a.lastIndexOf(".");return-1===b?a:a.substr(b+1)}}Object(n.a)(QM,"InsertOnlineVideoDialogHelper",null,[299]);var RM=d(1012);class Hj{constructor(a,b,c,h,m,y,G,U,ja,va,Ta,fb,Db,gc,hc,Gc,Pc,yc,Vd,De,Wd,Ve,$e,Qf,lg){this.bDb=this.iHa=0;if(!yc)throw Error.argumentNull("insertShapeOverlayViewStateManager");if(!Ve)throw Error.argumentNull("appFrame");if(!$e)throw Error.argumentNull("viewEventNotifier");
this.Hs=a;this.ia=b;this.Fa=c;this.pa=h;this.hO=0;this.ua=ja;this.fc=m;this.Fb=y;this.jGa=G;this.Hu=Ta;this.CPg=U;this.Lg=va;this.nt=ja.presentation;this.Tk=fb;this.Wj=Db;this.R5c=gc;this.tXa=hc;this.Ea=Gc;this.Pi=Pc;this.qWa=yc;this.qea=Vd;this.Qdc=De;this.f5c=Wd;this.Qb=Ve;this.ve=$e;this.npe=Qf;this.sSg=lg;this.Lg.kI(Object(F.a)(this,this.LYa,"onSlideNavigation"));this.CPg.ik(Object(F.a)(this,this.wgb,"onPresentationPropertyChanged"));this.Qdc&&(this.Qb.IK(Object(F.a)(this,this.Mu,"onAppFrameModeSwitched")),
this.ve.M5a(Object(F.a)(this,this.R$,"onRibbonTabSwitched")),this.ve.g8h(Object(F.a)(this,this.K2g,"onEscapeKeyPressed")));Hj.Jcd.push(M.a.QWc);Hj.Jcd.push(M.a.OWc);this.nAf()}dispose(){this.CPg.Cm(Object(F.a)(this,this.wgb,"onPresentationPropertyChanged"));this.Lg.F5(Object(F.a)(this,this.LYa,"onSlideNavigation"));this.Qdc&&(this.Qb.wY(Object(F.a)(this,this.Mu,"onAppFrameModeSwitched")),this.ve.DJb(Object(F.a)(this,this.R$,"onRibbonTabSwitched")),this.ve.eTk(Object(F.a)(this,this.K2g,"onEscapeKeyPressed")))}vb(){for(const a of Hj.jpl)this.ia.ra(a,
xb.a.application,Object(F.a)(this,this.q8f,"handleInsertShape"),4);for(const a of Hj.Icd)this.ia.ra(a,xb.a.application,Object(F.a)(this,this.q8f,"handleInsertShape"),4);this.ia.ra(M.a.JWc,xb.a.application,Object(F.a)(this,this.xrj,"handleInsertShapeAtSpecifiedLocation"),4);this.ia.ra(M.a.TWc,xb.a.application,Object(F.a)(this,this.yrj,"handleInsertShapeTextBoxAtSpecifiedLocation"),4);this.ia.ra(M.a.voi,xb.a.application,Object(F.a)(this,this.M7f,"handleCancelInsertShape"),4);this.ia.ra(M.a.pBf,xb.a.application,
Object(F.a)(this,this.M7f,"handleCancelInsertShape"),4);this.ia.ra(M.a.M7a,xb.a.application,Object(F.a)(this,this.wqj,"handleDuplicateShape"),4)}De(){this.Fa.Gc(Ua.a.rg).bindAction(w.KeyInputManager.Na(z.a.nMa,w.KeyInputManager.Le),M.a.M7a);this.Fa.Gc(Ua.a.iQ).bindAction(w.KeyInputManager.Na(z.a.nMa,w.KeyInputManager.Le),M.a.M7a)}nAf(){if(this.nt){var a=Math.min(this.nt.Sil,this.nt.wil);a=Math.max(a-50,0);this.iHa=Math.floor(a/(2*Aq.a.HS))-1;this.iHa=Math.max(this.iHa,0);this.bDb=-1*this.iHa}else this.iHa=
1,this.bDb=-1}wgb(a,b){b.property!==X.a.slideWidth&&b.property!==X.a.slideHeight||this.nAf()}LYa(){this.hO=0;this.Qdc&&this.qga(0)}Mu(a){1===a.mode&&this.qga(0)}R$(){this.qga(0)}K2g(){this.qga(0)}qga(a){1===a&&this.Fa.Ed();this.qWa.i0e(a)}q8f(a,b,c,h,m){b=this.ua.Ba;if(!b)return 16;h=b.Cb;if(lc.a.ax(h)||this.fc.$c(b))return 16;if(1===c)return 32;c=this.U8a(a);if(!c)return 8;if(!this.Wj.JF(b,1))return this.Wj.hG(b),16;const y=this.R5c&&this.tXa.sL;var G=b.Ne.HasDefaultShape,U=b.Ne.HasDefaultLine,ja=
95===c.$fa||97===c.$fa||Array.contains(aA.a.lme,c.$fa);U=U&&ja;G=G&&!ja;ja=!1;m&&(en.a.vv in m?m=m[en.a.vv]:(Ba.a.J(512349792,829,15,"actionData {0} does not contain the InputMethod",m),m=0),ja=!Array.contains(Hj.Wjk,m));if(ja){if(a===M.a.JEa)return this.qga(1),this.qea.instance.Xxb=-1,32;if(y&&!Array.contains(Hj.Jcd,a)&&!G&&!U){this.qga(2);if(null==this.qea.instance)throw Error.argumentNull("insertShapeOverlayViewElement");this.qea.instance.Xxb=a;return 32}}this.qga(0);let va,Ta;var fb=this.nt.slideWidth,
Db=this.nt.slideHeight;ja=new ad.a((fb-c.width*te.a.UC)/2,(Db-c.height*te.a.UC)/2);m=ja.x+$d.a.rf(this.hO*Aq.a.HS,0);Ta=ja.y+$d.a.rf(this.hO*Aq.a.HS,1);y?(ja=c.width*te.a.UC,va=c.height*te.a.UC):(ja=$d.a.rf(Hj.vZb,0),va=$d.a.rf(Hj.uZb,1),m=fb/2-$d.a.rf(Hj.vZb/2-this.hO*Aq.a.HS,0),Ta=Db/2-$d.a.rf(Hj.uZb/2-this.hO*Aq.a.HS,1));this.hO++;this.hO>this.iHa&&(this.hO=this.bDb);fb=b.Pt();Db=Object(ua.a)(295,this.ua.Ba.tg(this.Fb.Ma));Nc.a.Ib&&(U||G)&&Nc.a.Ib.Va(li.a.w1d,U?"HasDefaultLine":"HasDefaultShape");
!y||a===M.a.JEa||Array.contains(Hj.Jcd,a)||G||U?h=this.Tk.FQa(!1,h.cid,h.sid,0,c.shapeType,m,Ta,ja,va,fb+1):(h=aA.a.gLc(h,c,Db.mT,null,new RM.a,m,Ta,ja,va,fb,this.Ea,this.Tk,this.Fb,this.ua,this.Pi),Nc.a.Ib&&(Nc.a.Ib.actionName=Hj.vUc));Rd.a("MoveCursorToTextboxAfterKeyboardInsert")&&a===M.a.JEa&&(this.Sqf(),this.vdb=h);h.isEditable=!Array.contains(Hj.Icd,a);this.Hs.zW([h],b,a);this.Hu.NF=h;this.Ysc();return 32}Sqf(){this.fve||(this.sSg.gra(this.Qmh.bind(this)),this.Lg.VFc(this.fZg.bind(this)),this.fve=
!0)}eSk(){this.fve&&(this.sSg.Gnc(this.Qmh.bind(this)),this.Lg.kih(this.fZg.bind(this)),this.fve=!1)}Qmh(a,b){a=b.node;null!=a&&a==this.vdb&&(this.vdb=a,this.LDg=b.revisionId.toString())}fZg(a,b){b.faa&&b.faa.Id&&this.LDg==b.faa.Id&&(null==this.vdb||this.npe.Xta(this.vdb)||setTimeout(()=>{this.ia.La(M.a.LPa,2,new Al.a(this.vdb,!0,null));this.eSk();this.LDg=this.vdb=null},0))}yrj(a,b,c,h,m){if(1===c)return 2;this.qga(0);b=this.ua.Ba;if(!b)return 16;h=b.Cb;if(lc.a.ax(h)||this.fc.$c(b))return 16;c=this.U8a(a);
if(!c)return 16;if(!this.Wj.JF(b,1))return this.Wj.hG(b),16;this.hO++;this.hO>this.iHa&&(this.hO=this.bDb);if(!Rd.a("IsAnyOffsetZeroForTextbox")){if(!(m&&m.left&&m.right&&m.bottom&&m.top))return Ba.a.J(512349791,829,10,"Invalid offsets : {0}",m),16}else if(!m)return Ba.a.J(512336011,829,10,"Invalid offsets"),16;const y=this.ua.Ba.Ow.Wr;let G=$d.a.rf(this.Pi.zM(m.right-m.left,y),0),U=$d.a.rf(this.Pi.zM(m.bottom-m.top,y),1);U||G||(this.f5c?(G=c.width*te.a.UC,U=c.height*te.a.UC):(G=$d.a.rf(Hj.qli,0),
U=$d.a.rf(Hj.pli,1)));G=G?G:$d.a.rf(Hj.Rli,0);U=U?U:$d.a.rf(Hj.Qli,1);const ja=$d.a.rf(this.Pi.zM(m.left,y),0);m=$d.a.rf(this.Pi.zM(m.top,y),1);m=this.Tk.FQa(!1,h.cid,h.sid,0,c.shapeType,ja,m,G,U,b.Pt()+1);if(!m)return Ba.a.J(512349790,829,10,"Unable to create shape node as CreateShapeNode returned null"),16;Rd.a("FixNarratorTextBoxBug")&&(m.setValue(X.a.KK,c.$fa),m.setValue(X.a.lx,!0));Rd.a("MoveCursorToTextboxAfterInsert")&&this.Sqf();m.isEditable=!Array.contains(Hj.Icd,a);this.vdb=m;this.Hs.zW([m],
b,a);this.Hu.NF=m;this.Ysc();Ba.a.J(512349789,829,50,"Successfully inserted the textbox at specified location");return 32}xrj(a,b,c,h,m){if(1===c)return Ba.a.J(512349511,829,10,"behavior is ActionBehavior.isEnabled"),2;this.qga(0);b=this.ua.Ba;if(!b)return Ba.a.J(512349510,829,10,"slideNode is null"),16;c=b.Cb;if(lc.a.ax(c))return Ba.a.J(512349509,829,10,"slideNode is fake"),16;if(this.fc.$c(b))return Ba.a.J(512349508,829,10,"GraphNodeAndParent is blocked"),16;h=this.U8a(m.insertShapeActionId);if(!h)return Ba.a.J(512349507,
829,10,"autoShapeProps is null"),16;if(!this.Wj.JF(b,1))return this.Wj.hG(b),16;var y=m.offsets;if(!y)return Ba.a.J(512349788,829,10,"Invalid offsets"),16;const G=this.ua.Ba.tg(this.Fb.Ma);let U=this.Fb.Ld.rf(y.right-y.left,0),ja=this.Fb.Ld.rf(y.bottom-y.top,1);ja||U||(U=h.width*te.a.UC,ja=h.height*te.a.UC);const va=this.Fb.Ld.rf(y.left,0);y=this.Fb.Ld.rf(y.top,1);h.height=ja/te.a.UC;h.width=U/te.a.UC;const Ta=b.Pt();c=aA.a.gLc(c,h,G.mT,null,new RM.a,va,y,U,ja,Ta,this.Ea,this.Tk,this.Fb,this.ua,this.Pi);
Nc.a.Ib&&(Nc.a.Ib.actionName=Hj.vUc);if(!c)return Ba.a.J(512349787,829,10,"Unable to create shape node as CreateShapeNode returned null"),16;c.isEditable=!Array.contains(Hj.Icd,a);m.insertLocalShape?b.UB(c,null):(this.Hs.zW([c],b,a),this.qea.instance.Xxb=-1,this.Hu.NF=c,this.Ysc());m.node=c;Ba.a.J(512349786,829,50,"Successfully inserted the shape at specified location");return 32}M7f(a,b,c){if(1===c)return 32;this.qga(0);return 32}U8a(a){switch(a){case M.a.JEa:return new Sd.a(4,16,.5,3);case M.a.TWc:return new Sd.a(4,
16,.5,3);case M.a.fee:return new Sd.a(34,9,1,1);case M.a.age:return new Sd.a(2,17,1,1.16);case M.a.wfe:return new Sd.a(3,55,1,1);case M.a.gfe:return new Sd.a(6,56,1,1.33);case M.a.$fe:return new Sd.a(7,57,1.33,1);case M.a.Ude:return new Sd.a(5,58,1,1);case M.a.Cfe:return new Sd.a(9,59,1,1.05);case M.a.oee:return new Sd.a(10,60,1,1.16);case M.a.nee:return new Sd.a(11,61,1,1);case M.a.cfe:return new Sd.a(12,62,1,1);case M.a.Qde:return new Sd.a(13,63,1,1);case M.a.Yde:return new Sd.a(14,64,1,1);case M.a.ife:return new Sd.a(39,
65,1,1);case M.a.Bde:return new Sd.a(87,66,1,1);case M.a.Yfe:return new Sd.a(35,67,1,1);case M.a.kee:return new Sd.a(83,68,1,1);case M.a.lee:return new Sd.a(84,69,1,1);case M.a.ree:return new Sd.a(85,70,1,1);case M.a.Tde:return new Sd.a(86,71,1,1);case M.a.Hde:return new Sd.a(130,72,1,1);case M.a.jfe:return new Sd.a(33,73,1,1);case M.a.yde:return new Sd.a(73,7,1.33,1);case M.a.Ide:return new Sd.a(72,8,1.33,1.33);case M.a.wde:return new Sd.a(82,74,1.14,1.14);case M.a.Zde:return new Sd.a(41,75,1,1);
case M.a.afe:return new Sd.a(42,76,1,1);case M.a.xde:return new Sd.a(40,77,1,1);case M.a.jee:return new Sd.a(81,78,1,1);case M.a.Efe:return new Sd.a(78,79,1,1);case M.a.mee:return new Sd.a(75,18,1,1);case M.a.Bee:return new Sd.a(74,80,1,1);case M.a.Xfe:return new Sd.a(76,81,1,1);case M.a.Zee:return new Sd.a(77,82,1,.5);case M.a.Dde:return new Sd.a(120,83,1,1);case M.a.tde:return new Sd.a(88,84,1,1);case M.a.aee:return new Sd.a(93,85,1,1);case M.a.$de:return new Sd.a(94,86,1,1.17);case M.a.wee:return new Sd.a(89,
87,1,.08);case M.a.vfe:return new Sd.a(90,88,1,.08);case M.a.vee:return new Sd.a(91,89,1,.17);case M.a.ufe:return new Sd.a(92,90,1,.17);case M.a.Xee:return new Sd.a(175,19,1,1);case M.a.Uee:return new Sd.a(176,20,1,1);case M.a.Vee:return new Sd.a(177,21,1,1);case M.a.Ree:return new Sd.a(178,22,1,1);case M.a.Tee:return new Sd.a(179,23,1,1);case M.a.Wee:return new Sd.a(180,24,1,1);case M.a.QWc:return new Sd.a(95,12,1,1);case M.a.RWc:return new Sd.a(95,13,1,1);case M.a.SWc:return new Sd.a(95,14,1,1);
case M.a.OWc:return new Sd.a(97,26,1,1);case M.a.NWc:return new Sd.a(97,155,1,1);case M.a.PWc:return new Sd.a(97,156,1,1);case M.a.LWc:return new Sd.a(101,25,1,1);case M.a.KWc:return new Sd.a(101,153,1,1);case M.a.MWc:return new Sd.a(101,154,1,1);case M.a.cee:return new Sd.a(46,0,1.07,.53);case M.a.see:return new Sd.a(44,1,.53,1.07);case M.a.xee:return new Sd.a(50,2,.53,1.33);case M.a.sfe:return new Sd.a(43,3,.53,1.07);case M.a.cge:return new Sd.a(45,4,1.07,.53);case M.a.ege:return new Sd.a(51,5,
1.33,.53);case M.a.zee:return new Sd.a(53,27,.93,1.33);case M.a.ude:return new Sd.a(62,28,.95,.89);case M.a.bge:return new Sd.a(63,29,.96,.97);case M.a.Aee:return new Sd.a(52,30,.93,.93);case M.a.vde:return new Sd.a(49,31,.8,.93);case M.a.Mde:return new Sd.a(67,32,1.33,.8);case M.a.Lde:return new Sd.a(68,33,1.33,.8);case M.a.Nde:return new Sd.a(69,34,.8,1.33);case M.a.Jde:return new Sd.a(70,46,.8,1.33);case M.a.Vfe:return new Sd.a(47,35,.53,1.07);case M.a.bfe:return new Sd.a(48,36,.53,1.07);case M.a.hfe:return new Sd.a(36,
37,.53,1.07);case M.a.Ade:return new Sd.a(37,38,.53,.53);case M.a.tfe:return new Sd.a(56,39,1,1);case M.a.dee:return new Sd.a(58,40,1,1);case M.a.uee:return new Sd.a(55,41,1,1);case M.a.dge:return new Sd.a(57,42,1,1);case M.a.yee:return new Sd.a(59,43,.63,1.33);case M.a.pfe:return new Sd.a(61,44,1.33,1.33);case M.a.Cde:return new Sd.a(64,45,1.07,1.07);case M.a.ofe:return new Sd.a(54,47,1.33,1.33);case M.a.qfe:return new Sd.a(4,10,1,1);case M.a.Afe:return new Sd.a(25,11,1,1);case M.a.xfe:return new Sd.a(28,
48,1,1);case M.a.yfe:return new Sd.a(27,49,1,1);case M.a.zfe:return new Sd.a(26,50,1,1);case M.a.Gfe:return new Sd.a(29,51,1,1);case M.a.Ffe:return new Sd.a(32,52,1,1);case M.a.Hfe:return new Sd.a(31,53,1,1);case M.a.Ife:return new Sd.a(30,54,1,1);case M.a.rfe:return new Sd.a(116,91,.67,1);case M.a.Bfe:return new Sd.a(117,6,.67,1);case M.a.ffe:return new Sd.a(118,92,.67,1);case M.a.Ede:return new Sd.a(119,93,.67,1);case M.a.Cee:return new Sd.a(104,94,.67,1);case M.a.Gee:return new Sd.a(105,95,.67,
1);case M.a.Kee:return new Sd.a(106,96,.67,1);case M.a.Dee:return new Sd.a(107,97,.67,1);case M.a.Hee:return new Sd.a(108,98,.67,1);case M.a.Lee:return new Sd.a(109,99,.67,1);case M.a.Eee:return new Sd.a(110,100,.67,1);case M.a.Iee:return new Sd.a(111,101,.67,1);case M.a.Mee:return new Sd.a(112,102,.67,1);case M.a.Fee:return new Sd.a(113,103,.67,1);case M.a.Jee:return new Sd.a(114,104,.67,1);case M.a.Nee:return new Sd.a(115,105,.67,1);case M.a.gee:return new Sd.a(79,106,1,1);case M.a.hee:return new Sd.a(80,
107,1,1);case M.a.Pfe:return new Sd.a(15,108,1,1);case M.a.Qfe:return new Sd.a(16,15,1,1);case M.a.Rfe:return new Sd.a(17,109,1,1);case M.a.Sfe:return new Sd.a(18,110,1,1);case M.a.Tfe:return new Sd.a(19,111,1,1);case M.a.Kfe:return new Sd.a(20,112,1,1);case M.a.Lfe:return new Sd.a(21,113,1,1);case M.a.Mfe:return new Sd.a(22,114,1,1);case M.a.Nfe:return new Sd.a(23,115,1,1);case M.a.Ofe:return new Sd.a(24,116,1,1);case M.a.fge:return new Sd.a(122,117,.67,1.33);case M.a.eee:return new Sd.a(121,118,
.67,1.33);case M.a.Ode:return new Sd.a(124,119,.83,1.33);case M.a.Kde:return new Sd.a(123,120,.83,1.33);case M.a.gge:return new Sd.a(126,121,1.25,1.13);case M.a.pee:return new Sd.a(127,122,1.13,1.25);case M.a.hge:return new Sd.a(128,123,1,1);case M.a.bee:return new Sd.a(129,124,1,1);case M.a.mfe:return new Sd.a(131,125,.67,1);case M.a.sde:return new Sd.a(158,126,.67,1);case M.a.Rde:return new Sd.a(132,127,.67,1);case M.a.Pde:return new Sd.a(133,128,.67,1);case M.a.kfe:return new Sd.a(134,129,.67,
1);case M.a.qee:return new Sd.a(135,130,.67,.67);case M.a.Xde:return new Sd.a(136,131,.67,1);case M.a.$ee:return new Sd.a(137,132,.83,1.16);case M.a.Zfe:return new Sd.a(138,133,.33,1);case M.a.lfe:return new Sd.a(139,134,.67,1.16);case M.a.Pee:return new Sd.a(140,135,.5,1);case M.a.Qee:return new Sd.a(141,136,.67,1);case M.a.Gde:return new Sd.a(142,137,.5,.5);case M.a.dfe:return new Sd.a(159,138,.67,.67);case M.a.zde:return new Sd.a(143,139,.88,1);case M.a.nfe:return new Sd.a(144,140,.88,1);case M.a.Wfe:return new Sd.a(145,
141,.67,.67);case M.a.efe:return new Sd.a(146,142,.67,.67);case M.a.Fde:return new Sd.a(147,143,1,.5);case M.a.Jfe:return new Sd.a(148,144,1,.5);case M.a.iee:return new Sd.a(149,145,.75,.75);case M.a.Yee:return new Sd.a(150,146,.75,.75);case M.a.Ufe:return new Sd.a(152,147,.67,1);case M.a.Sde:return new Sd.a(157,148,.67,.67);case M.a.Dfe:return new Sd.a(153,149,.67,.67);case M.a.Oee:return new Sd.a(154,150,.67,1);case M.a.Vde:return new Sd.a(155,151,.75,1);case M.a.Wde:return new Sd.a(156,152,.67,
1);default:return null}}wqj(a,b,c){b=this.pa.sg();if(!(b&&0<b.length&&Aq.a.l2k(b)))return 16;if(1===c)return 32;c=this.ua.Ba;if(!c)return 16;if(!this.Wj.JF(c,b.length))return this.Wj.hG(c),16;if(this.fc.$c(c))return 16;this.jGa.n9g(c,c,b,null,a);return 32}Ysc(){try{const a=vb.a.instance.Ja("Common.ISystemInitiatedFeedback");a&&a.execute(b=>{b.logActivity("InsertShapeActivity",null)})}catch(a){Ba.a.J(512349783,829,10,"Exception thrown while triggering InsertShapeActivity. Exception: {0}",a)}}}Hj.vZb=
110;Hj.uZb=75;Hj.qli=19;Hj.pli=38;Hj.Rli=4;Hj.Qli=4;Hj.vUc="InsertShape";Hj.jpl=[M.a.Xee,M.a.Uee,M.a.Vee,M.a.Ree,M.a.Tee,M.a.Wee,M.a.JEa,M.a.fee,M.a.age,M.a.wfe,M.a.gfe,M.a.$fe,M.a.Ude,M.a.Cfe,M.a.oee,M.a.nee,M.a.cfe,M.a.Qde,M.a.Yde,M.a.ife,M.a.Bde,M.a.Yfe,M.a.kee,M.a.lee,M.a.ree,M.a.Tde,M.a.Hde,M.a.jfe,M.a.yde,M.a.Ide,M.a.wde,M.a.Zde,M.a.afe,M.a.xde,M.a.jee,M.a.Efe,M.a.mee,M.a.Bee,M.a.Xfe,M.a.Zee,M.a.Dde,M.a.tde,M.a.aee,M.a.$de,M.a.wee,M.a.vfe,M.a.vee,M.a.ufe,M.a.qfe,M.a.Afe,M.a.xfe,M.a.yfe,M.a.zfe,
M.a.Gfe,M.a.Ffe,M.a.Hfe,M.a.Ife,M.a.rfe,M.a.Bfe,M.a.ffe,M.a.Ede,M.a.Cee,M.a.Gee,M.a.Kee,M.a.Dee,M.a.Hee,M.a.Lee,M.a.Fee,M.a.Jee,M.a.Nee,M.a.Eee,M.a.Iee,M.a.Mee,M.a.gee,M.a.hee,M.a.Pfe,M.a.Qfe,M.a.Rfe,M.a.Sfe,M.a.Tfe,M.a.Kfe,M.a.Lfe,M.a.Mfe,M.a.Nfe,M.a.Ofe,M.a.fge,M.a.eee,M.a.Ode,M.a.Kde,M.a.gge,M.a.pee,M.a.hge,M.a.bee,M.a.mfe,M.a.sde,M.a.Rde,M.a.Pde,M.a.kfe,M.a.qee,M.a.Xde,M.a.$ee,M.a.Zfe,M.a.lfe,M.a.Pee,M.a.Qee,M.a.Gde,M.a.dfe,M.a.zde,M.a.nfe,M.a.Wfe,M.a.efe,M.a.Fde,M.a.Jfe,M.a.iee,M.a.Yee,M.a.Ufe,
M.a.Sde,M.a.Dfe,M.a.Oee,M.a.Vde,M.a.Wde,M.a.sfe,M.a.cee,M.a.see,M.a.cge,M.a.ege,M.a.xee,M.a.zee,M.a.ude,M.a.bge,M.a.Aee,M.a.vde,M.a.Mde,M.a.Lde,M.a.Jde,M.a.Nde,M.a.Vfe,M.a.bfe,M.a.hfe,M.a.Ade,M.a.tfe,M.a.dee,M.a.uee,M.a.dge,M.a.yee,M.a.pfe,M.a.Cde,M.a.ofe];Hj.Icd=[M.a.QWc,M.a.RWc,M.a.SWc,M.a.LWc,M.a.KWc,M.a.MWc,M.a.OWc,M.a.NWc,M.a.PWc];Hj.Jcd=[M.a.RWc,M.a.SWc,M.a.LWc,M.a.KWc,M.a.MWc,M.a.NWc,M.a.PWc];Hj.Wjk=[1,5];Object(n.a)(Hj,"InsertShapeActor",null,[227,106]);class SM{constructor(){this.type="LivePollTaskPaneProps";
this.formsUrl=this.onCloseButtonClicked=null}}Object(n.a)(SM,"LivePollTaskPaneProps",null,[]);class TM{constructor(a,b,c,h,m,y,G,U){this.bM=null;this.OGa=this.Db=!1;a.loadScript("powerpoint-live-strings").then(()=>{this.OGa=!0;Ba.a.J(512500544,833,50,"powerpoint-live-strings loaded successfully")}).catch(ja=>{Ba.a.J(512500515,833,10,"Failed to load powerpoint-live-strings "+ja.toString())});if(!b)throw Error.argumentNull("formsDesignPageUrl LivePollPaneActor is null");if(!c)throw Error.argumentNull("formsResultsPageUrl for LivePollPaneActor is null");
if(!h)throw Error.argumentNull("actionManager for LivePollPaneActor is null");if(!m)throw Error.argumentNull("actionBlockingManager for LivePollPaneActor is null");if(!y)throw Error.argumentNull("graphTopologyManager for LivePollPaneActor is null");if(!G)throw Error.argumentNull("selectionManager for LivePollPaneActor is null");if(!U)throw Error.argumentNull("shapeCountValidator for LivePollPaneActor is null");this.E6j=b;this.F6j=c;this.ia=h;this.ua=y;this.ff=m;this.pa=G;this.Wj=U;this.pGg=Object(F.a)(this,
this.zol,"taskPaneMessageHandler")}vb(){this.ia.ya(M.a.opd,nc.a.application,Object(F.a)(this,this.opd,"showHideLivePollPane"))}De(){}opd(a,b,c){return b.contextId===nc.a.application&&this.OGa?1===c?32:zg.a("LivePollPaneToggle",a,()=>{(this.Db=!this.Db)?(this.em(),Ba.a.J(512500514,833,50,"LivePollPaneActor::ShowHideLivePollPane show")):(this.QK(),Ba.a.J(512500513,833,50,"LivePollPanePaneActor::ShowHideLivePollPanePane close"));return 32}):2}em(){this.jC();const a=Object.assign(new ju.a,{title:ResourceStrings.L_LivePollTaskPane,
hideHeader:!1,width:320,location:2,contentProps:this.bM,onOpen:()=>{},onClose:()=>{this.Db=!1},isModernPane:!0});fj.UISurfaces.xr().then(b=>{b.showTaskPane("LivePollTaskPaneProps",a);window.addEventListener("message",this.pGg,!1);return null}).catch(b=>{Ba.a.J(512500512,833,10,"LivePollPaneActor::ShowPane exception: {0}",b.toString())})}QK(){fj.UISurfaces.xr().then(a=>{a.hideTaskPane("LivePollTaskPaneProps",2);window.removeEventListener("message",this.pGg);return null}).catch(a=>{Ba.a.J(512500511,
833,10,"LivePollPaneActor::ClosePane exception: {0}",a.toString())})}jC(){this.bM=Object.assign(new SM,{onCloseButtonClicked:Object(F.a)(this,this.onCloseButtonClicked,"onCloseButtonClicked"),formsUrl:this.V8i()})}V8i(){return String.format("{0}{1}{2}",this.E6j,"&auth_upn=",u.AFrameworkApplication.fa.Ha("UserPrincipalName"))}onCloseButtonClicked(){this.QK()}zol(a){if("data"in a){var b;({kv:b}=dd.d(a.data)).returnValue&&b&&"type"in b&&"PollCreated"===b.type&&"payload"in b&&(a=b.payload,"formId"in a&&
(a=String.format("{0}{1}{2}{3}{4}",this.F6j,"?Id=",a.formId,"&auth_pvr=OrgId&auth_upn=",u.AFrameworkApplication.fa.Ha("UserPrincipalName")),this.wrj(a)))}}wrj(a){const b=this.ua.Ba;if(b&&!this.ff.$c(b))if(this.Wj.JF(b,1)){var c=b.Cb;b.$Di(c.sid,c.cid,a,b.Pt());b.n3(this.pa.Xd())}else this.Wj.hG(b)}}Object(n.a)(TM,"LivePollPaneActor",null,[227]);var QQ=d(952);class Tx{constructor(a,b,c,h,m,y,G,U,ja,va,Ta,fb){this.fA=h;this.Dva=m;this.ia=a;this.fc=b;this.Fa=c;this.eJ=U;this.Vb=y;this.ua=G;this.Kc=ja;
this.Qb=va;this.iwa=Ta;this.Fb=fb}vb(){this.ia.ya(M.a.SKa,nc.a.application,Object(F.a)(this,this.SKa,"showHideNotes"));this.ia.ra(M.a.Uhd,nc.a.application,Object(F.a)(this,this.lHk,"queryNotesPaneState"),96);this.ia.ra(M.a.ghd,nc.a.application,Object(F.a)(this,this.f8g,"pageScrollNotesPane"),64);this.ia.ra(M.a.fhd,nc.a.application,Object(F.a)(this,this.f8g,"pageScrollNotesPane"),64);this.ia.ya(M.a.TTe,nc.a.application,Object(F.a)(this,this.fkk,"notesResize"))}De(){const a=this.Fa.Gc(Di.a.J2);a.bindAction(w.KeyInputManager.Na(z.a.JB,
0),M.a.ghd);a.bindAction(w.KeyInputManager.Na(z.a.IB,0),M.a.fhd)}SKa(a,b,c,h,m){if(this.Fb&&0!==this.Fb.Sl)return 2;a=this.Vb.Cf;if(!this.ua.Ba||!a||this.fc.PN(a))return 16;if(1===c)return 32;m&&Object(za.a)(QQ.a,m)?m.sqc?this.fA.QWe():this.fA.Oxj():(this.fA.Vtk(),this.fA.zYb()&&this.Dva.so?this.Fa.Bj(Di.a.J2,!0):this.Fa.Bj(Di.a.J2,!1));this.eJ.eTa();return 32}lHk(a,b,c,h,m){if(!m||!Object(za.a)(Ph.a,m))return 8;m.Qf(this.fA.zYb());return 32}f8g(a,b,c){return 1===c?32:this.fA?(a===M.a.fhd?this.fA.xa.scrollTop+=
Tx.Vzf:a===M.a.ghd&&(this.fA.xa.scrollTop-=Tx.Vzf),32):8}fkk(a,b,c,h,m){Ba.a.J(37524685,822,50,"Notes Resize Begin");if(!this.fA||!m||"number"!==typeof m)return Ba.a.J(37524687,822,50,"Notes Resize Fail"),8;this.fA.bfa=m;this.Kc.Ic.Vqh(1);this.Qb.Mq();this.iwa.cDl();Ba.a.J(37524689,822,50,"Notes Resize Success, Notes status:{0}, Notes Height:{1}",this.fA.dkk?"On":"Off",this.fA.bfa);return 32}}Tx.Vzf=80;Object(n.a)(Tx,"NotesActor",null,[227]);class UM{constructor(a,b,c,h){this.ia=a;this.Yec=b;this.la=
c;this.ZDg=0;this.GO=h}De(){}vb(){this.ia.ra(M.a.Tch,he.a.frame,Object(F.a)(this,this.mHk,"queryOfflineStatusHandler"),2144)}mHk(a,b,c,h,m){if(1===c)return 32;switch(this.Yec.status){case 0:1===this.ZDg&&(m[np.a.Value]=CommonUIStrings.L_Connected,m[bm.a.labelText]=CommonUIStrings.L_Connected,m[np.a.Visible]=!0,this.hideIcon(),mh.a.instance.Eb(new He.a(2,1,this.la.offlineLabelTimeoutInMs,()=>{this.igl();this.GO.N5("GetOfflineStatus",!1);this.GO.BH()},90,"108")));break;case 2:m[np.a.Value]=CommonUIStrings.L_Disconnected;
m[bm.a.labelText]=CommonUIStrings.L_Disconnected;m[np.a.Visible]=!0;break;case 1:m[np.a.Value]=CommonUIStrings.L_Reconnecting,m[bm.a.labelText]=CommonUIStrings.L_Reconnecting,m[np.a.Visible]=!0}this.ZDg=this.Yec.status;return 32}hideIcon(){this.Dph(Mi.a.hidden)}igl(){this.Dph(Mi.a.visible)}Dph(a){const b=document.querySelector("[data-icon-name='SBVBASecurity_16']");b&&(b.style.visibility=a)}}Object(n.a)(UM,"OfflineStatusLabelActor",null,[227]);class VM{constructor(a,b,c,h,m,y,G,U){this.nCg=!1;this.Zpe=
null;this.ia=a;this.ff=b;this.eJ=c;this.Fa=c.Jo;this.Jb=h;this.pa=m;this.Ea=y;this.jq=G;this.e0=U}vb(){this.ia.ra(M.a.bringForward,nc.a.application,Object(F.a)(this,this.EUc,"handleOrganizeAction"),4);this.ia.ra(M.a.bringToFront,nc.a.application,Object(F.a)(this,this.EUc,"handleOrganizeAction"),4);this.ia.ra(M.a.sendBackward,nc.a.application,Object(F.a)(this,this.EUc,"handleOrganizeAction"),4);this.ia.ra(M.a.sendToBack,nc.a.application,Object(F.a)(this,this.EUc,"handleOrganizeAction"),4);this.ia.ra(M.a.Vxf,
nc.a.application,Object(F.a)(this,this.g8f,"handleFrontBackFlyout"),4);this.ia.ra(M.a.ooh,nc.a.application,Object(F.a)(this,this.g8f,"handleFrontBackFlyout"),4);u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",!1)&&Rd.a("DelayRegisterArrangeShapesAction")?this.Zpe=()=>{this.ia.ra(M.a.srb,nc.a.application,Object(F.a)(this,this.E8f,"handleOrganizeShapeAnchor"),4)}:this.ia.ra(M.a.srb,nc.a.application,Object(F.a)(this,this.E8f,"handleOrganizeShapeAnchor"),
4)}De(){const a=this.eJ.Jo.Gc(Ua.a.rg);a.bindAction(w.KeyInputManager.Na(z.a.$tc,w.KeyInputManager.Le),M.a.bringForward);a.bindAction(w.KeyInputManager.Na(z.a.$tc,w.KeyInputManager.Le|4),M.a.bringToFront);a.bindAction(w.KeyInputManager.Na(z.a.Ytc,w.KeyInputManager.Le),M.a.sendBackward);a.bindAction(w.KeyInputManager.Na(z.a.Ytc,w.KeyInputManager.Le|4),M.a.sendToBack)}g8f(a,b,c){return 1===c?this.pa.J3()?32:8:32}E8f(){return this.nCg?32:this.pa.J3()?32:16}EUc(a,b,c){b=this.jq.presentation;if(!b)throw Error.argumentNull("Presentation is null");
let h=this.pa.sg();var m=this.Ea.g9a(h);m&&(this.pa.Ckd(m),h=this.pa.sg());if(!this.pa.J3()||this.ff.qC(h))return 16;if(1===c)return 32;switch(a){case M.a.bringForward:c=1;break;case M.a.bringToFront:c=0;break;case M.a.sendBackward:c=3;break;case M.a.sendToBack:c=2;break;default:return 8}Nc.a.Ib&&(Nc.a.Ib.Qr=!1,Nc.a.Ib.Nj=!0);1===h.length?Ba.a.J(17598029,815,50,"OrganizeShapesActor::HandleOrganizeAction Organizing only one shape."):1<h.length&&Ba.a.J(17598031,815,50,"OrganizeShapesActor::HandleOrganizeAction Organizing {0} shapes.",
h.length);m=this.Jb.zd(15,void 0,()=>{this.pa.ij();this.Fa.Ed()});try{m.nc(h[0]);m.jd=a;const y=Object(ua.a)(116,b.lC(h[0].slideId));this.zvk(y,h,c)}finally{m&&m.dispose()}return 32}mik(a,b){const c=this.Jb.zd(15,void 0,()=>{this.pa.ij();this.Fa.Ed()});try{const h=this.jq.Ba,m=h.kC(a),y=h.kC(b);c.nc(m);this.nik(h,m.id,y.id)}finally{c&&c.dispose()}}g9k(){this.nCg=!0;Rd.a("DelayRegisterArrangeShapesAction")&&this.Zpe&&this.Zpe()}zvk(a,b,c){a&&b&&0<b.length&&Ba.a.J(51164099,815,50,"OrganizeShapes has invalid params");
let h=Ma.a.clone(a.eb(kb.a.NA));const m=[];let y=null;Ma.a.gpa(b,G=>!G.Kg).length||(y=this.Ea.rs(b[0]))&&(h=Ma.a.clone(y.eb(kb.a.NA)));for(const G of b)m.push(G.id);a.c3b(c,h,m)&&(y&&y.anchor?y.anchor.wkb(h,1,!1):a.anchor?a.anchor.wkb(h,1,!1):Ba.a.J(51164101,815,50,"slideNode/groupNode should have valid anchor"))}yvk(a,b,c){var h=this.pa.Xd(),m=this.D7i(h,b);a.reverse();b=new Qa.a;h=[];let y=-1,G=!1;for(let ja=0;ja<a.length;ja++){let va=!1;for(var U of m)if(U.equals(a[ja])){b.add(U);va=G=!0;break}va||
h.push(a[ja]);c.equals(a[ja])&&(y=ja)}if(G)if(-1===y)Ba.a.J(593514880,815,10,"Invalid param endShapeId"),G=!1;else{c=0;U=a.length;for(m=0;c<y;)a[c++]=h[m++];for(let ja of b)a[c++]=ja;for(;c<U;)a[c++]=h[m++]}a.reverse();return G}D7i(a,b){let c=[],h=!1;for(const m of a)m.id.equals(b)&&(h=!0),c.push(m.id);h||(c=[],c.push(b));return c}nik(a,b,c){if(a){var h=Ma.a.clone(a.eb(kb.a.NA));var m=this.e0.Zca(b);var y=this.e0.Zca(c);m=this.Ea.rs(m);y=this.Ea.rs(y);m?y===m&&(h=Ma.a.clone(m.eb(kb.a.NA))):y&&(c=
y.id);this.yvk(h,b,c)&&(Ba.a.J(51385985,815,50,"ReorderShapeInSelectionPane : Reorder shape"),m?m.anchor?m.anchor.wkb(h,1,!1):Ba.a.J(594023564,815,10,"shapeNode should have valid anchor"):a.anchor?a.anchor.wkb(h,1,!1):Ba.a.J(51385987,815,10,"slideNode should have valid anchor"))}else Ba.a.J(51385955,815,10,"MoveShapeOnTopOfShape has invalid params")}}Object(n.a)(VM,"OrganizeShapesActor",null,[227]);class WM extends Is.a{constructor(a,b,c,h,m,y,G,U,ja){super();this.G$c=0;this.Pf=h;this.Bc=U;this.qrg=
ja;this.init(a);this.Nl("PPTClipboardActionOperation");(a=Object(ua.a)(10,G))||(a=new E.DictionaryPropertySet);a.setValue(zm.a.Ub,ja);this.AEa(b,c,m,y,a)}eWc(){this.ijb(this.Pf)}T6a(a){this.Ep=a;this.G$c=1}run(){if(0===this.G$c){if(1===this.Ana())return;this.G$c=1}1===this.G$c&&this.EY();this.Bc.rIj(this.qrg)&&this.Bc.Gg(!0,this.qrg)}}Object(n.a)(WM,"PPTClipboardActionOperation",Is.a,[442,369,370]);var XM=d(367),yE=d(532);class ou{constructor(a,b,c,h,m,y,G,U,ja,va,Ta,fb,Db,gc,hc,Gc,Pc,yc,Vd,De,Wd,
Ve,$e,Qf,lg,Hg,Qg,Sf,sh){this.ia=a;this.pa=b;this.Fa=c;this.eA=h;this.Adb=m;this.Jb=y;this.kxg=G;this.Pb=U;this.Bea=ja;this.oDb=va;this.Ea=Ta;this.iGa=fb;this.TL=Db;this.f6c=gc;this.FWa=hc;this.H4j=Gc;this.eec=Pc;this.yc=yc;this.Sp=Vd;this.Fs=De;this.RQ=Wd;this.Qb=Ve;this.Vb=$e;this.lO=Qf;this.rWa=lg;this.lU=Hg;if(Rd.a("RulerIndentBugFix")){if(!Qg)throw Error.argumentNull("paragraphIndentationReader");if(!Sf)throw Error.argumentNull("paragraphEditor");}this.X9=Qg;this.Gva=Sf;this.nXa=sh}vb(){this.ia.ra(M.a.WHe,
nc.a.application,Object(F.a)(this,this.Vsj,"handlePopulateFontColorDropdown"),101);this.ia.ra(M.a.l8g,nc.a.application,Object(F.a)(this,this.Xsj,"handlePopulateFontSizeDropdown"),100);this.ia.ra(M.a.Qia,nc.a.application,Object(F.a)(this,this.Tpj,"handleCommitShapeText"),4);this.ia.ra(M.a.Hhd,nc.a.application,Object(F.a)(this,this.Rch,"queryListCommonLevel"),96);this.ia.ra(M.a.Vhd,nc.a.application,Object(F.a)(this,this.Rch,"queryListCommonLevel"),96);this.ia.ra(M.a.tmc,nc.a.application,Object(F.a)(this,
this.kdh,"queryTextListMarkerGallery"),96);this.ia.ra(M.a.umc,nc.a.application,Object(F.a)(this,this.kdh,"queryTextListMarkerGallery"),96);this.ia.ra(M.a.slc,nc.a.application,Object(F.a)(this,this.K8f,"handlePopulateListMarkerDropdown"),100);this.ia.ra(M.a.tlc,nc.a.application,Object(F.a)(this,this.K8f,"handlePopulateListMarkerDropdown"),100);this.ia.ra(M.a.mme,xb.a.view,Object(F.a)(this,this.Orj,"handleLineSpacingMenuOpen"),68);this.ia.ra(M.a.aZg,nc.a.application,Object(F.a)(this,this.Xrj,"handleMoreFontColors"),
96);this.ia.ra(M.a.qlc,nc.a.application,Object(F.a)(this,this.Yrj,"handleMoreFontColorsResponse"),96);this.ia.ya(M.a.uZa,xb.a.paragraph,Object(F.a)(this,this.uZa,"queryLineSpacing"));this.ia.ya(M.a.uZa,xb.a.view,this.Bea);this.ia.he(M.a.uZa,96);this.ia.ya(M.a.una,xb.a.paragraph,Object(F.a)(this,this.m1,"setLineSpacing"));this.ia.ya(M.a.una,xb.a.view,this.Bea);this.ia.he(M.a.una,68);this.ia.ya(M.a.sJa,nc.a.application,Object(F.a)(this,this.sJa,"populateLineSpacingFlyout"));this.ia.ya(M.a.k8g,nc.a.application,
Object(F.a)(this,this.vsj,"handlePandoraEscapeKeyPressed"));this.ia.ya(M.a.zjb,xb.a.paragraph,Object(F.a)(this,this.Bvf,"applySpacingToParagraph"));this.ia.ya(M.a.zjb,xb.a.view,this.Bea);this.ia.he(M.a.zjb,4);this.ia.ya(M.a.yjb,xb.a.paragraph,Object(F.a)(this,this.Bvf,"applySpacingToParagraph"));this.ia.ya(M.a.yjb,xb.a.view,this.Bea);this.ia.he(M.a.yjb,4);this.ia.ya(M.a.mka,xb.a.paragraph,Object(F.a)(this,this.krb,"applyIndentationToParagraph"));this.ia.ya(M.a.mka,xb.a.view,this.Bea);this.ia.he(M.a.mka,
4);this.ia.ya(M.a.rLb,xb.a.paragraph,Object(F.a)(this,this.krb,"applyIndentationToParagraph"));this.ia.ya(M.a.rLb,xb.a.view,this.Bea);this.ia.he(M.a.rLb,4);this.ia.ya(M.a.tLb,xb.a.paragraph,Object(F.a)(this,this.krb,"applyIndentationToParagraph"));this.ia.ya(M.a.tLb,xb.a.view,this.Bea);this.ia.he(M.a.tLb,4);this.ia.ya(M.a.vLb,xb.a.paragraph,Object(F.a)(this,this.krb,"applyIndentationToParagraph"));this.ia.ya(M.a.vLb,xb.a.view,this.Bea);this.ia.he(M.a.vLb,4);this.nXa&&(this.ia.ya(M.a.sLb,xb.a.paragraph,
Object(F.a)(this,this.krb,"applyIndentationToParagraph")),this.ia.ya(M.a.sLb,xb.a.view,this.Bea),this.ia.he(M.a.sLb,4),this.ia.ya(M.a.uLb,xb.a.paragraph,Object(F.a)(this,this.krb,"applyIndentationToParagraph")),this.ia.ya(M.a.uLb,xb.a.view,this.Bea),this.ia.he(M.a.uLb,4));this.ia.ra(M.a.Y$g,nc.a.application,Object(F.a)(this,this.dtj,"handlePowerPointTextAlignmentAnchor"),4);this.ia.ra(M.a.hhd,nc.a.application,Object(F.a)(this,this.etj,"handlePowerPointTextAnchoringAnchor"),4);this.ia.ya(M.a.S0,xb.a.view,
this.oDb);this.ia.ya(M.a.R0,xb.a.view,this.oDb);this.ia.ya(M.a.Q0,xb.a.view,this.oDb);this.ia.ya(M.a.S0,xb.a.outline,Object(F.a)(this,this.Y$d,"handlePowerPointTextAnchoring"));this.ia.ya(M.a.R0,xb.a.outline,Object(F.a)(this,this.Y$d,"handlePowerPointTextAnchoring"));this.ia.ya(M.a.Q0,xb.a.outline,Object(F.a)(this,this.Y$d,"handlePowerPointTextAnchoring"));this.ia.he(M.a.S0,4);this.ia.he(M.a.R0,4);this.ia.he(M.a.Q0,4);this.ia.ya(M.a.XIb,xb.a.view,this.oDb);this.ia.ya(M.a.XIb,xb.a.outline,Object(F.a)(this,
this.TMe,"queryTextAnchoring"));this.ia.he(M.a.XIb,96);this.ia.ya(M.a.WIb,xb.a.view,this.oDb);this.ia.ya(M.a.WIb,xb.a.outline,Object(F.a)(this,this.TMe,"queryTextAnchoring"));this.ia.he(M.a.WIb,96);this.ia.ya(M.a.VIb,xb.a.view,this.oDb);this.ia.ya(M.a.VIb,xb.a.outline,Object(F.a)(this,this.TMe,"queryTextAnchoring"));this.ia.he(M.a.VIb,96);this.Sp&&(this.ia.ra(D.a.PPc,xb.a.view,Object(F.a)(this,this.Vqj,"handleFormatPainterPick"),4),this.ia.ra(M.a.o3d,xb.a.view,Object(F.a)(this,this.Uoj,"handleApplyFormatToText"),
4),this.ia.ra(D.a.Cja,xb.a.view,Object(F.a)(this,this.Uqj,"handleFormatPainterCancel"),4),this.RQ.V7h(()=>{this.lO.PUa=this.RQ.oL;this.Qb.updateCommandUI()}))}De(){var a=this.Fa.Gc(Ua.a.iQ);const b=this.Fa.Gc(Di.a.J2),c=this.Fa.Gc(Ua.a.HR),h=w.KeyInputManager.Na(z.a.J1,0);a.bindAction(w.KeyInputManager.Na(z.a.Cuc,0),M.a.Qia);a.bindAction(h,M.a.k8g);c.bindAction(h,M.a.Qia);b.bindAction(w.KeyInputManager.Na(z.a.dvd,2),H.a.qe);a.bindAction(w.KeyInputManager.Na(z.a.dvd,2),H.a.qe);this.FWa&&(a.bindAction(w.KeyInputManager.Na(z.a.zga,
5),M.a.MD),a.bindAction(w.KeyInputManager.Na(z.a.Naa,5),M.a.qz));this.Sp&&(a=this.Fa.Gc(Di.a.JD),a.Ap(h),a.bindAction(h,D.a.Cja))}Vqj(a,b,c){a=this.pa.Jp();b=!1;let h=null,m=this.pa.Pa.mb;const y=!!this.pa.Pa&&this.pa.Pa.Gl;y&&(m=this.pa.Pa.ga(0));m&&(h=m.Ua);if(h){switch(h.contextId){case xb.a.textRange:case xb.a.paragraph:case xb.a.endOfParagraph:case xb.a.Of:b=!0}b&&Bb.SelectionEditor.ek(h)&&Ud.b(h)&&(b=!1);h.contextId===xb.a.outline&&a.ud&&(b=!0);a&&!a.Kyh&&(b=!1)}if(1===c||!b)return b?32:8;6!==
this.ia.wq?(this.RQ.oL?Ba.a.J(40703699,820,50,"User deactivated the Format Painter button"):(Ba.a.J(40703697,820,50,"User activated the Format Painter button"),this.$9g(m,y,a)),this.RQ.oL=!this.RQ.oL):(Ba.a.J(40703701,820,50,"User picked format from keyboard shortcut"),this.$9g(m,y,a));return 32}$9g(a,b,c){this.RQ.a$g(a);var h=a.Ua;const m=Object(ua.a)(Vb.AParagraphNode,h.node);var y=Object(ua.a)(441,this.Qb.Jd);let G=null;if(m&&y&&(G=y.yi)){y=this.Jb.le(4);const ja=G.zi;y.nc(G);var U=this.Pb.Nc(m);
U.rc(8);const va=this.yc.ys(U);let Ta=h.Qa,fb=h.Nb-h.Qa;a=!a.lca&&a.Ye.contextId!==xb.a.endOfParagraph;b?(Ta=0,fb=Ob.ParagraphReader.textLength(m)+1):({selectionStart:Ta,Unh:fb}=this.wAf(h,m,U,Ta,fb,null,!1),a&&h.contextId===xb.a.textRange&&fb++);b=this.lU.YDa(ja);h=null;va&&(U.Ng(16),h=Object(ua.a)(123,U.currentNode));U.AB(8);U=Object(ua.a)(116,U.currentNode);this.lU.f3e(b,!0,m.sa(X.a.hFa,!1),U,c,h,null,Ta,fb);(c=ja.Wlc(b))&&G.nAb(c);y.dispose()}}wAf(a,b,c,h,m,y,G){switch(a.contextId){case xb.a.Of:m=
null;G&&(m=this.rWa.x5b(a))?(m=m.Ua,h=m.Qa,m=m.Nb-m.Qa):(h=0<h?h-1:0,m=1);break;case xb.a.paragraph:h=0;m=Ob.ParagraphReader.textLength(b)+1;break;case xb.a.endOfParagraph:h=Ob.ParagraphReader.textLength(b),m=1}for(c.AB(11);c.oEa();)c.Bb(2),(a=Object(ua.a)(Vb.AParagraphNode,c.currentNode))&&(h+=Ob.ParagraphReader.textLength(a)+1),c.AB(11);if(G)for(c=1;c<y.length;c++)if((G=Object(ua.a)(md.a,y.ga(c)))&&Ob.ParagraphReader.Yd(G.node))switch(G.contextId){case xb.a.textRange:m+=G.Nb-G.Qa;break;case xb.a.Of:m+=
1;break;case xb.a.paragraph:m+=Ob.ParagraphReader.textLength(G.node)+1;break;case xb.a.endOfParagraph:m+=1}return{selectionStart:h,Unh:m}}Uoj(a){if(6===this.ia.wq||this.RQ.oL){Ba.a.J(40703703,820,50,"User applied the Format Painter from command location: {0}",this.ia.wq);const G=this.pa.Jp();if(G&&!ou.ISj(G))return 2;var b=this.pa.Pa.mb;if(b&&b.Ua){var c=b.Ua;const U=Object(ua.a)(Vb.AParagraphNode,c.node);var h=Object(ua.a)(441,this.Qb.Jd),m=null;if(U&&h&&(m=h.yi)){h=this.Jb.le(15);h.nc(m);h.jd=a;
const ja=this.pa.Pa.Gl;a=U.sa(X.a.hFa,!1);if(ja)for(var y of this.pa.Pa)this.RQ.qvf(y);else this.RQ.qvf(b);Nc.a.Ib&&(Nc.a.Ib.Nj=!1,Nc.a.Ib.actionName="FormatPainterApplyToText",Nc.a.Ib.pF=new Date);const va=this.Pb.Nc(U);va.rc(8);y=c.Qa;let Ta=c.Nb-c.Qa;ja?y=Ta=-1:{selectionStart:y,Unh:Ta}=this.wAf(c,U,va,y,Ta,b,!0);va.Ng(8);b=Object(ua.a)(116,va.currentNode);c=this.pa.rv();m=this.lU.YDa(m.zi);this.lU.f3e(m,!1,a,b,G,null,c,y,Ta);6!==this.ia.wq&&(this.RQ.oL=!1);h.dispose()}}}return 32}vsj(a,b,c,h,
m){this.Sp&&this.ia.La(D.a.Cja,c,m);Rd.a("PandoraEscapeKeyPressed")&&this.ia.La(M.a.Qia,c,m);return 32}Uqj(){this.lO.PUa&&(this.RQ.oL=!1);return 32}dtj(){return this.mPf()}etj(){return this.mPf()}Y$d(a,b,c){let h=!1;b=this.kxg.Khj(b);var m=this.pa.Ym();if(b&&b.Lzb||m)h=!0;if(!h)return 16;if(1===c)return 32;switch(a){case M.a.S0:c=0;break;case M.a.R0:c=1;break;case M.a.Q0:c=2;break;default:return 8}if(m)this.pa.bH()?this.Fs.T4k(m,c):(b=this.Jb.le(15),b.nc(m),b.jd=a,this.Fs.S4k(this.pa.Pa,c),b.dispose());
else{m=this.Jb.le(15);try{m.nc(b),m.jd=a,b.setValue(X.a.hP,c)}finally{m&&m.dispose()}}return 32}TMe(a,b,c,h,m){c=!1;b=this.kxg.b0f(b);h=this.pa.Pa;let y=0;const G=this.pa.Ym();if(b.Sa(X.a.hP)||G){switch(a){case M.a.XIb:c=G?({exa:y}=this.yc.ysd(h)).returnValue&&0===y:0===b.eb(X.a.hP);break;case M.a.WIb:c=G?({exa:y}=this.yc.ysd(h)).returnValue&&1===y:1===b.eb(X.a.hP);break;case M.a.VIb:c=G?({exa:y}=this.yc.ysd(h)).returnValue&&2===y:2===b.eb(X.a.hP)}m.Qf(c);return 32}return 8}Rch(a,b,c,h,m){if(this.pa.xs())return m.Qf(!1),
32;b=this.iGa.HA(this.pa.Qj);c=!0;for(const y of b)if((b=y.el?y.node:null)?(c=this.Pb.Nc(b),c.set(b),c.rc(11),c.Ng(11),c=(b=this.eA.fw(c))?a===M.a.Hhd?1===b.listType:a===M.a.Vhd?0===b.listType:!1:!1):c=!1,!c)break;m.Qf(c);return 32}kdh(a,b,c,h,m){b=m.zZa;m=m.menuItemId;if(this.pa.xs())return b.Qf(!1),32;h=this.iGa.HA(this.pa.Qj);c=!0;for(const G of h){if(h=G.el?G.node:null){var y=this.Pb.Nc(h);y.set(h);y.rc(11);y.Ng(11);if(h=this.eA.fw(y)){if(0===m){c=!1;break}a===M.a.tmc?(c=this.TL.eVa.ga(m).hZb,
y=this.TL.eVa.ga(m).Xrb,c=h.kxb&&0<h.h9.length&&h.h9[0]===c&&h.k$a&&h.font===y):a===M.a.umc?(c=this.TL.Tcd.ga(m).NQd,c=!!h.propertySet&&h.propertySet.Sa(X.a.autonumberBulletType)&&h.propertySet.eb(X.a.autonumberBulletType)===c):c=!1}else 0!==m&&(c=!1)}if(!c)break}b.Qf(c);return 32}Xsj(a,b,c,h,m){if(1===c)return 32;m.PopulationXML=String.format("<Menu Id='menuFontSize'>\r\n               <MenuSection Id='fontSizes'>\r\n                    <Controls Id='ctrlFontSizes'>\r\n                        <Button MenuItemId='8'  Id='8'  Command='{0}' LabelText='8'/>\r\n                        <Button MenuItemId='9'  Id='9'  Command='{0}' LabelText='9'/>\r\n                        <Button MenuItemId='10' Id='10' Command='{0}' LabelText='10'/>\r\n                        <Button MenuItemId='10.5' Id='10.5' Command='{0}' LabelText='10.5'/>\r\n                        <Button MenuItemId='11' Id='11' Command='{0}' LabelText='11'/>\r\n                        <Button MenuItemId='12' Id='12' Command='{0}' LabelText='12'/>\r\n                        <Button MenuItemId='14' Id='14' Command='{0}' LabelText='14'/>\r\n                        <Button MenuItemId='16' Id='16' Command='{0}' LabelText='16'/>\r\n                        <Button MenuItemId='18' Id='18' Command='{0}' LabelText='18'/>\r\n                        <Button MenuItemId='20' Id='20' Command='{0}' LabelText='20'/>\r\n                        <Button MenuItemId='24' Id='24' Command='{0}' LabelText='24'/>\r\n                        <Button MenuItemId='28' Id='28' Command='{0}' LabelText='28'/>\r\n                        <Button MenuItemId='32' Id='32' Command='{0}' LabelText='32'/>\r\n                        <Button MenuItemId='36' Id='36' Command='{0}' LabelText='36'/>\r\n                        <Button MenuItemId='40' Id='40' Command='{0}' LabelText='40'/>\r\n                        <Button MenuItemId='44' Id='44' Command='{0}' LabelText='44'/>\r\n                        <Button MenuItemId='48' Id='48' Command='{0}' LabelText='48'/>\r\n                        <Button MenuItemId='54' Id='54' Command='{0}' LabelText='54'/>\r\n                        <Button MenuItemId='60' Id='60' Command='{0}' LabelText='60'/>\r\n                        <Button MenuItemId='66' Id='66' Command='{0}' LabelText='66'/>\r\n                        <Button MenuItemId='72' Id='72' Command='{0}' LabelText='72'/>\r\n                        <Button MenuItemId='80' Id='80' Command='{0}' LabelText='80'/>\r\n                        <Button MenuItemId='88' Id='88' Command='{0}' LabelText='88'/>\r\n                        <Button MenuItemId='96' Id='96' Command='{0}' LabelText='96'/>\r\n                     </Controls>\r\n               </MenuSection>\r\n            </Menu>",
"2016320825");return 32}Xrj(a,b,c,h,m){if(1===c)return this.ia.La(M.a.renderColorPicker,1,m);u.AFrameworkApplication.Ta.La(D.a.qIb,2,m);a=new hb.a(m&&0<=m.fontColor&&16777215>=m.fontColor?m.fontColor:0);b={};b.currentColor=a;b.handleCommand=M.a.qlc;b.hideAlphaSlider=!0;return this.ia.La(M.a.renderColorPicker,2,b)}Yrj(a,b,c,h,m){if(1===c)return this.ia.La(M.a.Ls,c,m);if(!m)return Ba.a.J(595186523,820,10,"HandleMoreFontColorsResponse: actionData is null"),16;if(a=nu.a.parse(m.Color))return a=this.ia.La(M.a.Ls,
c,"@"+a.RGBColor),32===a&&this.ia.La(M.a.zBa,c,m),a;Ba.a.J(595186521,820,10,"HandleMoreFontColorsResponse: failed to parse colorinfo, colorInfo is null");return 8}Vsj(a,b,c,h,m){if(1===c)return 32;a=(a=this.pa.sk())?a.Ne:null;b=M.a.qxa;var y=M.a.qlc;c=this.Vb.Cf.M7;if(!m.MenuId||0>ta.a.og(m.MenuId).indexOf("floatie")){h=b.toString();y=y.toString();b=Object.assign(new Mk.a,{Id:"menuFontColor",MenuSectionList:[]});const G=Rd.a("ColorPickerHighlighterFix")?yE.a.themeColors:"Colors";Array.add(b.MenuSectionList,
Uk.e(a,G,"Font.Color.Menu.Controls","fontColor","ThemeFontColorPicker",h,0,!this.eec));Array.add(b.MenuSectionList,Uk.d("fontColor","Font.Color.Menu.Controls","fontColor","StandardFontColorPicker",h,!0));c&&0<c.length?(appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("FontRecentColors",!1)),Array.add(b.MenuSectionList,Uk.c(c,"Recent Colors","Font.Color.Menu.Controls","recentColor","FontRecentColors",y,!1))):appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("FontRecentColors",
!0));Array.add(b.MenuSectionList,Uk.a("More Font Color","Font.Color.Menu.Controls","862825906",ResourceStrings.l_MoreFontColors,"Color.Menu.MoreFontColors","MoreFontColors","per_AppointmentColor0_16x16x32",ResourceStrings.l_MoreFontColorsKeytip));if(Rd.a("ColorPickerHighlighterFix")&&(c=new $s,32===u.AFrameworkApplication.Ta.La(D.a.qIb,2,c)&&c&&!c.R3b))if(c=c.fontColor,-1===c)Uk.h(b,null,a);else if(c=Cj.i(c)||"",c=nu.a.parse(c))c=Uf.Box4ColorHelper.DDa(c.GLa(),a),Uk.h(b,c,a);m.MenuItems=b}else a=
this.H4j.LYf(a,!this.eec),m.PopulationXML=a.Aki(b,c,M.a.qlc);return 32}Tpj(a,b,c){if(!this.pa.pC())return 16;if(1===c)return 32;a=this.pa.Xd();if(!a||1!==a.length)return 16;this.pa.selectShape(a[0],!0);this.Fa.Ed();return 32}Orj(){return 32}sJa(a,b,c,h,m){if(1===c)return 32;a=new Mk.a;a.MenuSectionList=[];b=Object.assign(new di.a,{ControlList:[]});for(c=0;5>c;++c)h=Object.assign(new Sy.a,{Id:"buttonLineSpacing"+ou.nme[c].replace(".","_"),LabelText:ou.nme[c].substring(0,3),ExternalId:"LineSpacingButton"+
ou.nme[c].replace(".","_")}),Array.add(b.ControlList,h);Array.add(a.MenuSectionList,b);m.MenuItems=a;return 32}K8f(a,b,c,h,m){if(1===c)return 32;a=a===M.a.slc?1:a===M.a.tlc?0:14;Nc.a.Ib&&(1===a?Nc.a.Ib.actionName="PowerPointPopulateListMarkerBulletsDropDown":0===a&&(Nc.a.Ib.actionName="PowerPointPopulateListMarkerNumberingsDropDown"));!m.MenuId||0>ta.a.og(m.MenuId).indexOf("floatie")?m.MenuItems=this.ovi(a):m.PopulationXML=this.pvi(a);return 32}uZa(a,b,c,h,m){var y=m.MenuItemId;a=m.queryResult;c=
m.LineSpacingValue;h=m.LineSpacingUnit;let G=!1;b=this.Adb.JW(b.node);y=kf.a.Uy(b.lineSpacing.value,y)&&2===b.lineSpacing.Vf;if(-1===c)h=b.lineSpacing.Vf,c=b.lineSpacing.value;else if(c!==b.lineSpacing.value||h!==b.lineSpacing.Vf)c=h=0;0!==h&&(G=y);a.Qf(G);m.LineSpacingUnit=h;m.LineSpacingValue=c;return 32}m1(a,b,c,h,m){if(1===c)return 32;if(void 0===m||null===m)return Ba.a.J(8955530,820,10,"PandoraActor::SetLineSpacing - Null action data passed. "),8;c=this.Jb.le(15);b=b.node;c.nc(b);c.jd=a;b.setValue(X.a.gX,
2);a=m;this.f6c&&(a+=this.Ea.e4d(this.Ea.Zm(b)));b.setValue(X.a.ox,a);c.dispose();return 32}Bvf(a,b,c,h,m){b=b.node;if(12!==b.type||!m)return 8;c=new XM.a(m.Vf,m.value);m=c.Vf;c=c.value;switch(a){case M.a.zjb:b.setValue(X.a.Kda,c);b.setValue(X.a.Xka,m);break;case M.a.yjb:b.setValue(X.a.Jda,c),b.setValue(X.a.Wka,m)}return 32}krb(a,b,c,h,m){b=b.node;if(12!==b.type||!m)return 8;m=(new lv.a(m.Vf,m.value)).MM;c=this.X9.v8(b).MM;h=this.X9.TSa(b);switch(a){case M.a.mka:b.setValue(jb.a.Zl,m);break;case M.a.rLb:b.setValue(jb.a.$n,
m);break;case M.a.tLb:b.setValue(jb.a.$n,-m);break;case M.a.vLb:b.setValue(jb.a.$n,0);break;case M.a.sLb:this.nXa&&b.setValue(jb.a.$n,m-c);break;case M.a.uLb:this.nXa&&(this.Gva.uv.ljb(b,(1===h.specialIndentType?c+h.MM:c-h.MM)-m),this.Gva.uv.Cnd(b,1,m))}return 32}pvi(a){const b=new Sys.StringBuilder;b.append('<Menu Id="menuListMarkersDropDown">');b.append('<MenuSection Id="msListMarkersPosition" ShowMenuSectionSeparator="false" DispalyMode="Menu16">');b.append('<Gallery Id="galleryListMarkersPosition" Width="3" ElementDimensions="Size48by48">');
let c,h,m;switch(a){case 1:c="BulletsLibrary_";h=M.a.yna;m=M.a.GJa;break;case 0:c="NumberingLibrary_";h=M.a.vJa;m=M.a.Dhb;break;default:c="BulletsLibrary_",h=M.a.yna,m=M.a.GJa}for(let y=0;8>y;++y)b.append(String.format('<GalleryButton Id="{0}" Command="{1}" QueryCommand="{2}" InnerHTML="{3}" Alt="{4}" MenuItemId="{5}" ShouldSetTitle="true" />',c+y,h,m,ta.a.pe(String.format('<DIV class="ListMarkerPreview" style="{0}">{1}</DIV>',this.J6d(a,y),this.I6d(a,y))),this.h1f(a,y),y));b.append("</Gallery>");
b.append("</MenuSection>");b.append("</Menu>");return b.toString()}ovi(a){const b=Object.assign(new Mk.a,{Id:"menuListMarkersDropDown",MenuSectionList:[]});Array.add(b.MenuSectionList,this.Vqf(a));return b}Vqf(a){var b="",c="";let h="",m=M.a.yna,y=M.a.GJa;switch(a){case 1:b="Bullets Library";h="BulletsLibrary_";m=M.a.yna;y=M.a.GJa;c="BulletLibrarySection";break;case 0:b="Numbering Library",h="NumberingLibrary_",m=M.a.vJa,y=M.a.Dhb,c="NumberingLibrarySection"}b=Object.assign(new di.a,{Id:"msListMarkersPosition",
Title:b,ShowMenuSectionSeparator:!1,DisplayMode:"Menu16",ControlList:[]});c=Object.assign(new qq.a,{Id:"galleryListMarkersPosition",ExternalId:c,ExternalGalleryId:this.X5d(a),Type:5,Width:3,ElementDimensions:"Size48by48",GalleryItems:[]});for(let G=0;8>G;++G)c.GalleryItems.push(this.W5d(a,G,h+G,m.toString(),y.toString(),this.h1f(a,G)));Array.add(b.ControlList,c);return b}X5d(a){switch(a){case 1:return"BulletLibraryGallery";case 0:return"NumberingLibraryGallery";default:return""}}W5d(a,b,c,h,m,y){a=
Object.assign(new pz,{LevelInfo:this.kaj(a,b)});a.Id=c;a.Command=h;a.QueryCommand=m;a.Alt=y;a.ShouldSetTitle="true";a.MenuItemId=b.toString();return a}kaj(a,b){const c=[],h={};h.fontFamily=ka.FontUtils.Uia("Calibri");if(!b)return Object.assign(new Qk,{textAtLevel:Box4Intl.Box4Strings.L_ListStyleNone,styleAtLevel:h});h.fontFamily=ka.FontUtils.Uia(this.j1f(a,b));1===a?(a=this.TL.O0c.ga(b).Syf,c.push(Object.assign(new Qk,{textAtLevel:a,styleAtLevel:h})),c.push(Object.assign(new Qk,{textAtLevel:a,styleAtLevel:h})),
c.push(Object.assign(new Qk,{textAtLevel:a,styleAtLevel:h}))):0===a&&(a=this.TL.O0c.ga(b).l0g,c.push(Object.assign(new Qk,{textAtLevel:a[0],styleAtLevel:h})),c.push(Object.assign(new Qk,{textAtLevel:a[1],styleAtLevel:h})),c.push(Object.assign(new Qk,{textAtLevel:a[2],styleAtLevel:h})));return c}h1f(a,b){return 1===a?this.TL.gng.ga(this.TL.X5b(b)):0===a?this.TL.gng.ga(this.TL.JTc(b)):""}I6d(a,b){return b?1===a?(a=this.TL.O0c.ga(b).Syf,this.BJa([a,a,a])):0===a?(a=this.TL.O0c.ga(b).l0g,this.BJa(a)):
"":Box4Intl.Box4Strings.L_ListStyleNone}BJa(a){return a&&3===a.length?String.format('<DIV class="ListNumberPreview" style="padding-left: 2pt; font-size: 9pt; ">{0}{1}{2}</DIV>',this.WDa(a[0]),this.WDa(a[1]),this.WDa(a[2])):""}WDa(a){return String.format('<DIV style="position: relative;"><SPAN>{0}</SPAN><SPAN class="ListMarkerGalleryPreviewLine"></SPAN></DIV>',a)}J6d(a,b){const c=new Sys.StringBuilder;c.append("position: relative; ");b?(c.append("font-family: "),c.append(ka.FontUtils.Uia(this.j1f(a,
b))),c.append("; "),c.append("font-size: 24pt;")):(c.append("font-size: 12pt; "),c.append("top: 22%;"));c.append("color: black;");return c.toString()}j1f(a,b){return 1===a?this.TL.eVa.ga(this.TL.X5b(b)).Xrb:0===a?"Calibri":""}mPf(){let a=16;if(this.pa.W8())return 16;const b=this.pa.Jp(),c=this.pa.Ym();if(b&&b.Lzb||c)a=32;return a}static ISj(a){return!!a&&(a.Jyh||a.ud)}}ou.nme=["1.00","1.50","2.00","2.50","3.00"];Object(n.a)(ou,"PandoraActor",null,[227]);var RQ=d(742);class pu{constructor(a,b){this.fBd=
this.S2a=null;this.Ca=a;this.iAa=b;if(this.Kte=u.AFrameworkApplication.fa.ka("HandleRaceConditionInHostManagerInit"))this.fBd=RQ.a.create();this.rS=vb.a.instance.Ja("Common.ISystemInitiatedFeedback")}get BQ(){return this.S2a}vb(){this.Ca.ra(H.a.close,he.a.frame,Object(F.a)(this,this.closeDocument,"closeDocument"),2176);this.Ca.ra(H.a.j3b,he.a.frame,Object(F.a)(this,this.j3b,"fileProperties"),128);this.Ca.ya(H.a.Ksa,he.a.frame,Object(F.a)(this,this.Ksa,"fileSharing"));this.Ca.ra(H.a.copyAndEdit,he.a.frame,
Object(F.a)(this,this.copyAndEdit,"copyAndEdit"),128);this.Ca.ra(H.a.KJb,he.a.frame,Object(F.a)(this,this.KJb,"replyWithChanges"),128);this.Ca.ra(H.a.Aqc,he.a.frame,Object(F.a)(this,this.KVi,"fileVersion"),128);this.Ca.ya(H.a.downloadACopy,he.a.frame,Object(F.a)(this,this.downloadACopy,"downloadACopy"));this.Ca.ya(H.a.DNi,he.a.frame,ed.ActionManager.Jg);this.Ca.ra(H.a.XPe,he.a.frame,Object(F.a)(this,this.XPe,"reportAbuseLink"),128);this.Ca.ra(H.a.Lpd,he.a.frame,Object(F.a)(this,this.Nqc,"signInInternal"),
128);this.Ca.ya(H.a.workflow,he.a.frame,Object(F.a)(this,this.workflow,"workflow"));u.AFrameworkApplication.fa.ka("DocumentNameInJewelInfoMenuIsEnabled")&&this.Ca.ra(H.a.Ghd,he.a.frame,Object(F.a)(this,this.Ghd,"queryBreadcrumbDocName"),96);this.Ca.ra(H.a.yLe,he.a.frame,Object(F.a)(this,this.yLe,"queryCopyAndEditButton"),96);u.AFrameworkApplication.fa.ka("DiagnosticsInfoInJewelAboutMenuIsEnabled")&&(this.Ca.ra(H.a.vLe,he.a.frame,Object(F.a)(this,this.vLe,"queryBuildVersion"),2144),this.Ca.ra(H.a.lMe,
he.a.frame,Object(F.a)(this,this.lMe,"querySessionId"),2144));this.Ca.ya(H.a.c0b,he.a.frame,Object(F.a)(this,this.c0b,"conversation"));this.iAa.execute(Object(F.a)(this,this.njc,"onHostPostmessengerCreated"));ba.ULS.sendTraceTag(536987588,306,50,"WebAppFrameCommandUIActor-RegisterActions done.")}njc(a){this.S2a=a;this.Kte&&(this.fBd.instance=a);ba.ULS.sendTraceTag(536987589,306,this.BQ?50:10,String.format("OnHostPostmessengerCreated - Setting OnHostPostmessengerCreated as null value = {0}",!this.BQ))}closeDocument(a,
b,c,h,m){a=2===c;c=ki.h;m&&(c=m);return b&&a&&!this.lHc(c)?8:this.sti(a,c)}lHc(){return!0}sti(a,b){if(u.AFrameworkApplication.Aa.hb.AVe("3033402446"))return ba.ULS.sendTraceTag(41231952,306,50,"CloseDocumentInternal - Sending FileClose postMessage to give the host control of closing the page"),this.joa(a,gf.a.fTf,!0,{});if(u.AFrameworkApplication.Unc&&b&&b===ki.f)return ba.ULS.sendTraceTag(6070357,306,50,"CloseDocumentInternal - navigating to ReportAbuseUrl"),u.AFrameworkApplication.Aa.MO(a,u.AFrameworkApplication.Unc);
if(u.AFrameworkApplication.isEmbedded)return a&&ba.ULS.sendTraceTag(6070358,306,50,"CloseDocumentInternal - cannot close because application is embedded"),8;if(u.AFrameworkApplication.fEf){if(!a)return 32;ba.ULS.sendTraceTag(6070359,306,50,"CloseDocumentInternal - closing the window");try{return window.top.close(),32}catch(m){return ba.ULS.sendTraceTag(6070360,306,10,"CloseDocumentInternal - encountered unexpected exception: {0}",m),8}}let c=u.AFrameworkApplication.mJc;if(!c)return a&&ba.ULS.sendTraceTag(6070361,
306,50,"CloseDocumentInternal - no closeUrl found"),8;b||(b=ki.h);if(b===ki.c||b===ki.h)return u.AFrameworkApplication.Aa.MO(a,c);let h;if(u.AFrameworkApplication.RZa)return a&&ba.ULS.sendTraceTag(6070362,306,50,"CloseDocumentInternal - Using ReplyWithChanges postmessage"),h=b===ki.d||b===ki.b?this.joa(a,gf.a.KJb,u.AFrameworkApplication.Rtc,{["event_source"]:b}):2,32!==h?(c=b?ng.a.Wi(u.AFrameworkApplication.RZa,ki.e,b):u.AFrameworkApplication.RZa,u.AFrameworkApplication.Aa.MO(a,c)):h;a&&ba.ULS.sendTraceTag(6070363,
306,50,"CloseDocumentInternal - Using FileClose postmessage");h=b===ki.b?this.joa(a,gf.a.fTf,u.AFrameworkApplication.v3e,null):2;return 32!==h?u.AFrameworkApplication.Aa.MO(a,c):h}Nqc(a,b,c,h,m){a=this.joa(2===c,gf.a.Lpd,!0,m);8===a&&(window.top.location=u.AFrameworkApplication.signInUrl,a=32);return a}j3b(a,b,c){a=this.joa(2===c,gf.a.j3b,u.AFrameworkApplication.FHh,null);return 32!==a?u.AFrameworkApplication.Aa.MO(2===c,u.AFrameworkApplication.kTf):a}Ksa(a,b,c,h,m){if(1===c)return rz.SessionStatusManager.instance.eka?
8:32;a=H.a.abl;b=Eh.a.create().toString();h={};h.event_source=m;h[hd.a.cqc]=b;var y=m?m.nav:null;y&&(h[hd.a.ebl]=y);(y=m?m.scenarioId:null)&&(h[hd.a.fbl]=y);m&&"CopyLink"===m.SourceControlId&&(m.mode="copy",a=H.a.$al);m&&"ManageAccess"===m.SourceControlId&&(m.mode="manageAccess",a=H.a.bbl);m&&"ShareTopBar"===m.SourceControlId&&u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.isTUIEnabledOnShare",!1)&&pu.Ip.raiseEvent(pu.Xpi);(y=m?m.mode:null)&&(h[hd.a.cbl]=y);if(u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShareWithSummaryIsEnabled",
!1)){var G=m?m.additionalData:null;G&&(h[hd.a.Qai]=G)}2===c&&(G={},G[hd.a.cqc]=b,y&&(G.mode=y),ba.ULS.sendTraceTag(38278995,306,50,dd.c(G)));b=this.joa(2===c,gf.a.pbl,u.AFrameworkApplication.x3e,h);if(32!==b){if(u.AFrameworkApplication.k3b)return m=m?ng.a.Wi(u.AFrameworkApplication.k3b,ki.e,m):u.AFrameworkApplication.k3b,u.AFrameworkApplication.Aa.MO(2===c,m,!0);ba.ULS.sendTraceTag(7985242,306,50,"Sharing PostMessage didn't succeed but there is no FileSharingURL to fallback to.",{["Result"]:b})}c=
oi.a.n8("PPTIsSimplifiedRibbonOn",!1);ba.ULS.sendTraceTag(509441175,306,15,"ActionName=FileSharing;SimplifiedRibbonMode={0}",c);Jf.c(a);return b}c0b(a,b,c){return this.joa(2===c,gf.a.c0b,!0,{})}workflow(a,b,c){a=this.joa(2===c,gf.a.workflow,u.AFrameworkApplication.E3e,{["WorkflowType"]:u.AFrameworkApplication.suc});if(32!==a){if(u.AFrameworkApplication.Jud)return u.AFrameworkApplication.Aa.MO(2===c,u.AFrameworkApplication.Jud,!0);ba.ULS.sendTraceTag(19781538,306,50,"Workflow PostMessage didn't succeed.",
{["Result"]:a})}return a}XPe(a,b,c){a=2===c;return b&&a&&!this.lHc(ki.f)?8:u.AFrameworkApplication.Aa.MO(a,u.AFrameworkApplication.Unc)}copyAndEdit(a,b,c){a={};2===c&&(a=u.AFrameworkApplication.Aa.hb.gZf());a=this.joa(2===c,gf.a.copyAndEdit,u.AFrameworkApplication.EHh,a);return 32!==a?u.AFrameworkApplication.Aa.MO(2===c,u.AFrameworkApplication.LVd,u.AFrameworkApplication.hideHeader):a}downloadACopy(a,b,c){return 1===c?u.AFrameworkApplication.EJ||u.AFrameworkApplication.GQ||rz.SessionStatusManager.instance.eka?
8:32:u.AFrameworkApplication.Aa.MO(2===c,u.AFrameworkApplication.eRa,!0)}KJb(a,b,c){a=2===c;if(b&&a&&!this.lHc(ki.d))return 8;b=this.joa(a,gf.a.KJb,u.AFrameworkApplication.Rtc,{["event_source"]:ki.d});return 32!==b?(b=ng.a.Wi(u.AFrameworkApplication.RZa,ki.e,ki.d),u.AFrameworkApplication.Aa.MO(a,b)):b}KVi(a,b,c){a=this.joa(2===c,gf.a.LVi,u.AFrameworkApplication.y3e,null);return 32!==a?u.AFrameworkApplication.Aa.MO(2===c,u.AFrameworkApplication.U1d):a}Ghd(a,b,c,h,m){if(2===c){if(!m)return 8;m.Value=
ta.a.TG(u.AFrameworkApplication.xu.Uw)}return 32}vLe(a,b,c,h,m){if(2===c){if(!m)return 8;m.Text=u.AFrameworkApplication.instance.RKi}return 32}lMe(a,b,c,h,m){if(2===c){if(!m)return 8;m.Text=u.AFrameworkApplication.instance.SKi}return 32}joa(a,b,c,h){return this.Kte?this.g3k(a,b,c,h):c?a?this.BQ.sendMessage(b,h)?32:8:32:2}g3k(a,b,c,h){return c?a?this.BQ?this.BQ.sendMessage(b,h)?32:8:(ba.ULS.sendTraceTag(528234241,306,15,"SendPostmessage called when HostPostmessenger was not initialized yet.Queueing the request."),
this.fBd.execute(()=>{ba.ULS.sendTraceTag(528234242,306,50,"HostPostmessenger now available. Executing the request.");this.BQ.sendMessage(b,h)}),32):32:2}yLe(a,b,c,h,m){if(2===c){if(!m)return 8;u.AFrameworkApplication.fa.ka("IsEditAndReplyFlow")&&(m.LabelText=CommonUIStrings.l_EditAndReply)}return 32}}pu.Ip=new bd.a;pu.Xpi="CheckEditorSuggestions";Object(n.a)(pu,"WebAppFrameCommandUIActor",null,[]);class YM extends pu{constructor(a,b,c,h,m,y,G){super(a,b);this.Iu=c;this.rE=h;this.pa=m;this.Ga=y;this.Xa=
G}vb(){super.vb();this.Ga.pptEnablePreviousVersionsOptionForOneDriveConsumer&&this.Ca.ya(M.a.lah,he.a.frame,Object(F.a)(this,this.QJe,"pptoShowFileVersion"))}QJe(a,b,c){return 1===c&&this.Xa.xda?2:this.Ca.processAction(H.a.Aqc,c)}workflow(a,b,c,h,m){if(1===c)return 32;this.pa.Qh();this.Iu.mXe(!0,ResourceStrings.l_Loading,a);Ba.a.J(20187205,801,50,"PPT save and launch workflow");this.rE.j3(!1,!0,()=>{this.Fni(m)},Object(F.a)(this,this.Yxa,"saveFailureCallback"));return 32}lHc(a){return a!==ki.a||u.AFrameworkApplication.isEmbedded||
u.AFrameworkApplication.fEf||u.AFrameworkApplication.mJc||this.ZOj()?!0:(Ba.a.J(37007442,306,15,"PptWebAppFrameCommandUIActor::BeforeCloseDocument - CloseUrl is null, fallback to RefreshPage"),this.Ca.La(M.a.refresh,2,{refreshtrigger:"PptWebAppFrameCommandUIActor::BeforeCloseDocument"}),!1)}ZOj(){var a=u.AFrameworkApplication.fa.Ha(u.AFrameworkApplication.YJ);a=u.AFrameworkApplication.Zab&&!!a&&"teams"===a.toLowerCase();return Rd.a("ReactDialogsProtocolLaunchingTeamsFix")&&this.Ga.I_d&&a&&u.AFrameworkApplication.Aa.hb.AVe("3033402446")}Fni(a){this.Iu.hide();
super.workflow(0,null,2,null,a)}Yxa(){this.Iu.hide();return!1}}Object(n.a)(YM,"PptWebAppFrameCommandUIActor",pu,[]);class ZM{constructor(a,b,c){if(!a)throw Error.argumentNull("actionManager");if(!b)throw Error.argumentNull("focusManager");if(!c)throw Error.argumentNull("presentationReader");this.ia=a;this.Fa=b;this.qc=c}vb(){this.ia.ra(M.a.ykd,nc.a.application,Object(F.a)(this,this.ykd,"replaceFonts"),4)}De(){const a=[this.Fa.Gc(Di.a.JD),this.Fa.Gc(Di.a.J2),this.Fa.Gc(Ua.a.rg),this.Fa.Gc(Ua.a.iQ)];
for(const b of a)b.bindAction(w.KeyInputManager.Na(z.a.jPb,w.KeyInputManager.Le),M.a.ykd)}ykd(a,b,c){return b.contextId!==nc.a.application?2:1===c?this.qc.Lj()?32:8:32}}Object(n.a)(ZM,"ReplaceFontsActor",null,[]);var $M=d(1063);class aN extends Sys.EventArgs{constructor(a,b,c){super();this.G0g=a;this.G$=b;this.vv=c}}Object(n.a)(aN,"RibbonTabSwitchedEventArgs",Sys.EventArgs,[]);class bN{constructor(a,b,c,h,m,y,G,U,ja){if(!a)throw Error.argumentNull("actionManager");if(!b)throw Error.argumentNull("frameContext");
if(!c)throw Error.argumentNull("ribbonUser");if(!h)throw Error.argumentNull("focusManager");if(!G)throw Error.argumentNull("ribbonExternal");this.Fa=h;this.ia=a;this.eJ=b;this.hB=c;this.jsg=m;this.ve=y;this.L3j=U;this.Ola=ja}vb(){this.ia.ya(H.a.aRe,he.a.frame,Object(F.a)(this,this.fsk,"onRibbonFocus"));this.ia.ra(H.a.DZk,he.a.frame,Object(F.a)(this,this.nuj,"handleRibbonStateChanged"),64);this.ia.ya(H.a.Zrd,nc.a.application,Object(F.a)(this,this.Zrd,"toggleRibbonState"));this.ia.ya(H.a.klh,xb.a.view,
Object(F.a)(this,this.ouj,"handleRibbonTabSwitched"));this.ia.ya(H.a.old,xb.a.view,Object(F.a)(this,this.old,"ribbonModeToggledToMLR"));this.ia.ya(H.a.pld,xb.a.view,Object(F.a)(this,this.pld,"ribbonModeToggledToSLR"));Ja.a.get_instance().Dk(7,Object(F.a)(this,this.registerOnShyRibbonStateChange,"registerOnShyRibbonStateChange"))}De(){const a=C.FocusManager.instance().Gc(Di.a.kzf);A.AFrame.jk(a,w.KeyInputManager.Na(z.a.Duc,w.KeyInputManager.Le),H.a.Zrd);A.AFrame.jk(a,w.KeyInputManager.Na(v.a.uk?z.a.yga:
z.a.iud,1),H.a.aRe);A.AFrame.jk(a,w.KeyInputManager.Na(z.a.dMa,v.a.uk?2:1),H.a.aRe);this.L3j&&(this.eJ.ebb.Jjd(ra.a.Hl,window.document,Object(F.a)(this,this.Bzj,"ignoreAltKeyUpOnDocument")),fE.a.instance().tsf(Object(F.a)(this,this.Nqk,"onOnlyAltKeyPressed")))}old(a,b,c){try{if(1===c)return 32;Rd.a("ReactMLRReuseSLRCookieForMLR")?this.Mqh(!1):this.vpc(!0);Ba.a.J(512500443,822,50,"[ReactRibbon] - Ribbon mode toggled to MLR");this.Ola&&(this.hB.GPi(),Rd.a("toggleChatPPTPane")&&(this.ve.vNe(new Dz(!0)),
this.Jrf("ChatPPT-Exit")));this.eJ.eTa()}catch(h){Ba.a.J(512500442,822,10,"[ReactRibbon] - Error when Ribbon mode toggled to MLR",h)}return 32}pld(a,b,c){try{if(1===c)return 32;Rd.a("ReactMLRReuseSLRCookieForMLR")||this.vpc(!1);this.Mqh(!0);Ba.a.J(512500441,822,50,"[ReactRibbon] - Ribbon mode toggled to SLR");this.Ola&&(this.hB.GMf(),Rd.a("toggleChatPPTPane")&&(this.ve.vNe(new Dz(!0)),this.Jrf("ChatPPT-Entry")));this.eJ.eTa()}catch(h){Ba.a.J(512500440,822,10,"[ReactRibbon] - Error when Ribbon mode toggled to SLR",
h)}return 32}Mqh(a){oi.a.SJ(u.AFrameworkApplication.fa.Ha("IsSimplifiedRibbonOnCookieName"),a.toString(),oi.a.wJ)}vpc(a){oi.a.SJ(u.AFrameworkApplication.fa.Ha("ReactRibbonMLRPreferenceCookieName"),a.toString(),oi.a.wJ)}Jrf(a){Ba.a.J(509616535,811,15,a)}nuj(a,b,c){if(1===c)return 32;this.eJ.eTa();return 32}Zrd(){return 32}ouj(a,b,c,h,m){if(!m)return 8;m&&m.NewContextId!==m.OldContextId&&(a=0,m&&m[en.a.vv]&&(a=m[en.a.vv]),this.ve.cKk(new aN(m.OldContextId,m.NewContextId,a)));this.Fa.Be&&2===m[en.a.vv]&&
this.Fa.Be.name===Ua.a.iaa&&(b=b.view)&&!ta.a.Wa(b.vI)&&this.Fa.xf(b.vI);return 32}Nqk(){$M.a.instance.keyCode===z.a.bMa&&(appChrome.api.inKeytipMode()?appChrome.api.exitKeytipMode():appChrome.api.enterKeytipMode(),this.V8f())}Bzj(a){return a.pc.keyCode===z.a.bMa}V8f(){if(document.activeElement&&document.activeElement.id!==xf.a.r_b)return this.Fa.EBh(!this.jsg.inKeytipMode,!1),32;this.Fa.Be&&this.Fa.EBh(this.Fa.Be.name===Ua.a.iaa||this.jsg.inKeytipMode,!0);return 32}fsk(a,b,c){return 1===c?32:this.V8f()}registerOnShyRibbonStateChange(){u.AFrameworkApplication.Aa&&
u.AFrameworkApplication.Aa.hb.Lo&&Dg.a("registerOnShyRibbonStateChange")&&appChrome.api.registerOnShyRibbonStateChange((a,b)=>{if(3===a&&3!==b||0===a&&3===b)Ba.a.J(512500439,822,50,"[ReactRibbon] - Ribbon shy mode toggled. Relayout the app."),this.eJ.eTa()})}}Object(n.a)(bN,"RibbonStateActor",null,[227]);class cA{constructor(a,b){this.sectionIndex=a;this.slideIndex=b}}Object(n.a)(cA,"SelectSectionAndSlidesData",null,[]);class cN{constructor(a,b,c,h,m,y,G,U,ja,va){this.qXa=null;if(ja){if(!y)throw Error.argumentNull("SectionActor.workspace");
if(!G)throw Error.argumentNull("SectionActor.presentationReader");if(!U)throw Error.argumentNull("SectionActor.selectionManager");}this.ia=a;this.$z=b;this.ua=c;this.Mfc=h;this.Fu=m;this.Vb=y;this.qc=G;this.pa=U;this.R4=ja;this.jn=va;this.Mfc.FG(Object(F.a)(this,this.uB,"onChildTopologyChanged"));this.ua.presentation&&(this.qXa=this.ua.presentation.Tp)}vb(){this.ia.ra(M.a.VOe,xb.a.application,Object(F.a)(this,this.Wtj,"handleRemoveSection"),4);this.ia.ra(M.a.hDe,xb.a.application,Object(F.a)(this,
this.csj,"handleMoveSectionUp"),4);this.ia.ra(M.a.gDe,xb.a.application,Object(F.a)(this,this.bsj,"handleMoveSectionDown"),4);this.ia.ra(M.a.g3e,xb.a.application,Object(F.a)(this,this.xvj,"handleUpdateSectionTitle"),4);this.ia.ra(M.a.I5a,xb.a.application,Object(F.a)(this,this.Hoj,"handleAddSection"),4)}De(){}xvj(a,b,c,h,m){if(1===c)return(a=this.ua.presentation)&&a.Tp&&a.Tp.length?32:8;if(!m)return Ba.a.J(509368192,822,10,"HandleUpdateSectionTitle with null action data."),8;this.$z.NSi(m);return 32}Wtj(a,
b,c){b=this.ua.Nz;const h=this.ua.Sba;if(1===c){const m=this.ua.presentation;if(!m||!m.Tp||!m.Tp.length)return 8;if(!b&&1<m.Tp.length)return h&&!h.VJ.length?32:8}if(2===c){Ba.a.J(509368163,822,50,"HandleRemoveSection called.");try{h&&this.$z.GSi(b,a),this.qXa=this.ua.presentation.Tp,this.ia.La(M.a.wmd,2,new cA(this.ua.Nz,this.ua.Ba.slideIndex))}catch(m){Ba.a.J(509368162,822,10,"SectionActor: Exception in HandleRemoveSection: {0}.",m)}}return 32}csj(a,b,c){a=this.ua.Nz;if(1===c)return c=this.ua.presentation,
!c||!c.Tp||!c.Tp.length||0>=a?8:32;if(2===c){Ba.a.J(509368161,822,50,"HandleMoveSectionUp called.");try{-1!==a&&(this.$z.nRf(a,!0),this.ia.La(M.a.wmd,2,new cA(this.ua.Nz,this.ua.Ba.slideIndex)))}catch(h){Ba.a.J(509368160,822,10,"SectionActor: Exception in HandleMoveSectionUp: {0}.",h)}}return 32}bsj(a,b,c){a=this.ua.Nz;if(1===c)return(c=this.ua.presentation)&&c.Tp&&c.Tp.length&&a!==c.Tp.length-1&&-1!==a?32:8;if(2===c){Ba.a.J(509368159,822,50,"HandleMoveSectionDown called.");try{-1!==a&&(this.$z.nRf(a,
!1),this.ia.La(M.a.wmd,2,new cA(this.ua.Nz,this.ua.Ba.slideIndex)))}catch(h){Ba.a.J(509368158,822,10,"SectionActor: Exception in HandleMoveSectionDown: {0}.",h)}}return 32}Hoj(a,b,c){if(2===c){b=-1;c=this.ua.Nz;Ba.a.J(509368157,822,50,"HandleAddSection called.");try{let h;h=this.R4&&0<=this.Vb.oxa?this.qc.mC(this.Vb.oxa+1):this.ua.Ba;this.$z.kSi(h,a);b=this.ua.Nz;if(this.R4&&(-1!==this.Vb.oxa&&(this.Vb.oxa=-1,this.Vb.Ba=h),this.jn)){const m=this.qc.gSa(b).map(G=>this.qc.mC(G));let y;(y=this.pa).WU.apply(y,
m)}}catch(h){Ba.a.J(509368156,822,10,"SectionActor: Exception in HandleAddSection: {0}.",h)}-1!==b&&b!==c&&this.ia.processAction(M.a.R0e,2)}return 32}uB(a,b){try{if(34===b.RZ&&!b.node.isDirty){const c=this.qXa?Array.clone(this.qXa):null;this.qXa=Array.clone(this.ua.presentation.Tp);if(!c&&this.qXa||c.length<this.qXa.length)2===this.qXa.length&&-1===this.ua.Nz&&(this.ua.Nz=1),this.Fu?this.Fu.oNe():Ba.a.J(509368155,822,10,"SectionActor: graphOperationEventNotifier is null for raising event."),this.ia.processAction(M.a.R0e,
2)}}catch(c){Ba.a.J(509368154,822,10,"SectionActor: Exception in OnChildTopologyChanged: {0}.",c)}}dispose(){this.Mfc.ZO(Object(F.a)(this,this.uB,"onChildTopologyChanged"))}}Object(n.a)(cN,"SectionActor",null,[227]);var dN=d(624);class eN{constructor(a,b,c,h,m,y,G,U,ja,va,Ta,fb,Db,gc,hc,Gc,Pc,yc,Vd){if(!yc)throw Error.argumentNull("viewEventNotifier");this.ia=a;this.ff=b;this.Fa=c;this.VQ=h;this.Vb=m;this.ua=y;this.ob=G;this.HC=U;this.Sb=ja;this.zVa=va;this.Ie=Ta;this.jn=fb;this.vJ=Db;this.Ea=gc;
this.ww=hc;this.z$=Gc;this.ova=Pc;this.ve=yc;this.R7j=Vd}vb(){this.ia.ya(M.a.Grd,nc.a.application,Object(F.a)(this,this.rKb,"selectNextSlideHandler"));this.ia.ya(M.a.Hrd,nc.a.application,Object(F.a)(this,this.rKb,"selectNextSlideHandler"));this.ia.ya(M.a.K0a,nc.a.application,Object(F.a)(this,this.rKb,"selectNextSlideHandler"));this.ia.ya(M.a.J0a,nc.a.application,Object(F.a)(this,this.rKb,"selectNextSlideHandler"));this.ia.ya(M.a.Skb,nc.a.application,Object(F.a)(this,this.rKb,"selectNextSlideHandler"));
this.ia.ya(M.a.Rkb,nc.a.application,Object(F.a)(this,this.rKb,"selectNextSlideHandler"));this.jn&&(this.ia.ya(M.a.zsc,nc.a.application,Object(F.a)(this,this.dxb,"handleKeyboardMultiSelectSlides")),this.ia.ya(M.a.ssc,nc.a.application,Object(F.a)(this,this.dxb,"handleKeyboardMultiSelectSlides")),this.ia.ya(M.a.usc,nc.a.application,Object(F.a)(this,this.dxb,"handleKeyboardMultiSelectSlides")),this.ia.ya(M.a.tsc,nc.a.application,Object(F.a)(this,this.dxb,"handleKeyboardMultiSelectSlides")),this.ia.ya(M.a.xsc,
nc.a.application,Object(F.a)(this,this.dxb,"handleKeyboardMultiSelectSlides")),this.ia.ya(M.a.wsc,nc.a.application,Object(F.a)(this,this.dxb,"handleKeyboardMultiSelectSlides")),this.ia.ya(M.a.fmd,nc.a.application,Object(F.a)(this,this.S1k,"selectAllSlidesHandler")),this.ia.ya(M.a.o_a,nc.a.application,Object(F.a)(this,this.quj,"handleScrollSelectedThumbnailsIntoView")));this.ia.ya(M.a.Pib,nc.a.application,Object(F.a)(this,this.puj,"handleScrollActiveThumbnailIntoViewSlim"));this.ia.ya(M.a.g0a,nc.a.application,
Object(F.a)(this,this.Jnh,"selectNextShapeHandler"));this.ia.ya(M.a.pMb,nc.a.application,Object(F.a)(this,this.Jnh,"selectNextShapeHandler"));this.ia.ya(M.a.iOb,nc.a.application,Object(F.a)(this,this.Iwl,"unselectShapesHandler"));this.ia.ya(M.a.Poc,nc.a.application,Object(F.a)(this,this.R1k,"selectAllShapesHandler"));this.ia.ya(M.a.$rh,nc.a.application,Object(F.a)(this,this.Ial,"shapeEscapeKeyPressedHandler"));this.ia.ya(M.a.akb,nc.a.application,Object(F.a)(this,this.OUc,"handleSlideScopeArrowKeyboard"));
this.ia.ya(M.a.bkb,nc.a.application,Object(F.a)(this,this.OUc,"handleSlideScopeArrowKeyboard"));this.ia.ya(M.a.ckb,nc.a.application,Object(F.a)(this,this.OUc,"handleSlideScopeArrowKeyboard"));this.ia.ya(M.a.dkb,nc.a.application,Object(F.a)(this,this.OUc,"handleSlideScopeArrowKeyboard"));this.ia.ya(M.a.Rwh,nc.a.application,Object(F.a)(this,this.Uuj,"handleSpaceKeyPressed"));this.ia.ya(M.a.k$g,nc.a.application,Object(F.a)(this,this.cAk,"playVideoCommandHandler"))}De(){var a=this.Fa.Gc(Di.a.JD);const b=
this.Fa.Gc(Ua.a.rg),c=this.Fa.Gc(Ua.a.iQ);a.bindAction(w.KeyInputManager.Na(z.a.Pq,0),M.a.Grd);a.bindAction(w.KeyInputManager.Na(z.a.Pq,4),M.a.Hrd);a.bindAction(w.KeyInputManager.Na(z.a.JB,0),M.a.K0a);a.bindAction(w.KeyInputManager.Na(z.a.K1,0),M.a.K0a);a.bindAction(w.KeyInputManager.Na(z.a.IB,0),M.a.J0a);a.bindAction(w.KeyInputManager.Na(z.a.I1,0),M.a.J0a);a.bindAction(w.KeyInputManager.Na(z.a.YE,0),M.a.Skb);a.bindAction(w.KeyInputManager.Na(z.a.Nw,0),M.a.Rkb);this.jn&&(a.bindAction(w.KeyInputManager.Na(z.a.K1,
4),M.a.zsc),a.bindAction(w.KeyInputManager.Na(z.a.I1,4),M.a.ssc),a.bindAction(w.KeyInputManager.Na(z.a.YE,4),M.a.usc),a.bindAction(w.KeyInputManager.Na(z.a.Nw,4),M.a.tsc),a.bindAction(w.KeyInputManager.Na(z.a.JB,4),M.a.xsc),a.bindAction(w.KeyInputManager.Na(z.a.IB,4),M.a.wsc),a.bindAction(w.KeyInputManager.Na(z.a.mMa,2),M.a.fmd));b.bindAction(w.KeyInputManager.Na(z.a.JB,0),M.a.K0a);b.bindAction(w.KeyInputManager.Na(z.a.IB,0),M.a.J0a);b.bindAction(w.KeyInputManager.Na(z.a.YE,0),M.a.Skb);b.bindAction(w.KeyInputManager.Na(z.a.Nw,
0),M.a.Rkb);b.bindAction(w.KeyInputManager.Na(z.a.Pq,0),M.a.g0a);b.bindAction(w.KeyInputManager.Na(z.a.Pq,4),M.a.pMb);b.bindAction(w.KeyInputManager.Na(z.a.J1,0),M.a.$rh);b.bindAction(w.KeyInputManager.Na(z.a.mMa,2),M.a.Poc);b.bindAction(w.KeyInputManager.Na(z.a.x6,0),M.a.akb);b.bindAction(w.KeyInputManager.Na(z.a.Naa,0),M.a.bkb);b.bindAction(w.KeyInputManager.Na(z.a.zga,0),M.a.ckb);b.bindAction(w.KeyInputManager.Na(z.a.aZ,0),M.a.dkb);a=w.KeyInputManager.Na(z.a.JB,0);c.Ap(a);c.bindAction(a,M.a.K0a);
a=w.KeyInputManager.Na(z.a.IB,0);c.Ap(a);c.bindAction(a,M.a.J0a);b.bindAction(w.KeyInputManager.Na(z.a.mP,0),M.a.Rwh)}rKb(a,b,c){if(this.VQ.v_||this.ff.$c(this.Vb.Cf))return 16;if(1===c)return 32;if(!this.Vb.Cf||!this.ua.Ba)return 16;32===this.ia.processAction(M.a.wic,1)&&this.ia.processAction(M.a.vic,2);b=this.ycj(this.ua.Ba,a);if(b===this.ua.Ba.oe)return 32;if(this.ww&&a!==M.a.Skb&&a!==M.a.Rkb&&(a=this.Ie.fT(b),!a||!a.QN))return 16;this.Fa.S7===Ua.a.rg&&this.Fa.Ed();return this.Ie.xU(b)}ycj(a,b){a=
a.oe;const c=this.Sb.Lj();switch(b){case M.a.J0a:a=Math.min(a+1,c-1);break;case M.a.Grd:a=a+1>c-1?0:a+1;break;case M.a.K0a:a=Math.max(a-1,0);break;case M.a.Hrd:a=0>a-1?c-1:a-1;break;case M.a.Skb:a=0;break;case M.a.Rkb:a=c-1}return a}dxb(a,b,c){if(this.VQ.v_||this.ff.$c(this.Vb.Cf)||!this.Vb.Cf||!this.ua.Ba)return 16;if(1===c)return 32;32===this.ia.processAction(M.a.wic,1)&&this.ia.processAction(M.a.vic,2);if(1>=this.Sb.Lj())return 32;Ba.a.J(34395531,816,50,"Selected multiple Slides by Shift+Up/Down, Shift+Home/End and Shift+PageUp/PageDown");
switch(a){case M.a.zsc:case M.a.ssc:case M.a.usc:case M.a.tsc:this.vvj(a);break;case M.a.xsc:case M.a.wsc:this.usj(a);break;default:return Ba.a.J(25751680,816,50,"SelectionActor::HandleKeyboardMultiSelectSlides does not recognize this action"),8}return 32}Bij(a,b){const c=[];var h=this.Sb.Lj();for(b=b>h-1?h-1:b;a<=b;a++)(h=this.Sb.mC(a))&&c.push(h);return c}vvj(a){if(!this.ua.Ba)throw Error.argumentNull("ActiveSlide is null");const b=this.ob.We();b.sort((Ta,fb)=>Ta.oe-fb.oe);const c=b[0].oe,h=b[b.length-
1].oe,m=this.ua.Ba.oe,y=this.Sb.Lj();var G=[];let U=m,ja=m,va=m;G=!0;switch(a){case M.a.zsc:1===b.length?va=U=0<=m-1?m-1:m:m===c?ja=0<=h-1?h-1:h:c?va=U=c-1:G=!1;break;case M.a.ssc:1===b.length?va=ja=m<y-1?m+1:m:m===c&&h<y-1?va=ja=h+1:m===c&&h===y-1?G=!1:U=c+1;break;case M.a.usc:U=0;break;case M.a.tsc:ja=y-1}if(this.ww&&va!==m&&(a=this.Ie.fT(va),!a||!a.QN))return;if(G){G=this.Bij(U,ja);let Ta;(Ta=this.ob).WU.apply(Ta,G);this.Ie.bya(U===m?ja:U)}}usj(a){const b=this.ob.We();b.sort((ja,va)=>ja.oe-va.oe);
const c=b[0].oe,h=b[b.length-1].oe,m=this.ua.Ba;if(!m)throw Error.argumentNull("ActiveSlide is null");const y=m.oe,G=this.Sb.Lj();let U=null;if(!(1>=G)){switch(a){case M.a.xsc:if(!y)break;(U=this.Sb.mC(y-1))&&1<b.length&&y===h&&this.orb(b)&&this.ob.Dnc(m);break;case M.a.wsc:y!==G-1&&(U=this.Sb.mC(y+1))&&1<b.length&&y===c&&this.orb(b)&&this.ob.Dnc(m)}if(U){if(this.ww&&(a=U.tg(this.Ie.Ma),!a||!a.QN))return;this.Vb.Ba=U;this.ob.J5a(U);this.Ie.bya(U.oe)}}}orb(a){if(!a||!a.length)return!1;if(1<a.length)for(let b=
0;b<a.length-1;b++)if(1!==a[b+1].oe-a[b].oe)return!1;return!0}quj(a,b,c){if(!this.Vb.Cf||!this.ua.Ba||this.ff.$c(this.Vb.Cf))return 16;2===c&&this.Ie.o_a();return 32}puj(a,b,c){if(!this.Vb.Cf||!this.ua.Ba||this.ff.$c(this.Vb.Cf))return 16;2===c&&this.Ie.Zld();return 32}OUc(a,b,c){return this.ob.J3()?this.dsj(a,c):this.wuj(a,c)}wuj(a,b){if(this.jn&&1!==this.ob.We().length)return 8;let c;switch(a){case M.a.akb:case M.a.ckb:a=M.a.J0a;c="ThumbnailPageDownNavigation";break;case M.a.dkb:case M.a.bkb:a=
M.a.K0a;c="ThumbnailPageUpNavigation";break;default:return Ba.a.J(8955553,816,50,"SelectionActor::HandleSelectSlideKeyboard does not recognize this action"),8}Nc.a.Ib&&(Nc.a.Ib.actionName=c,Nc.a.Ib.Nj=!1,Nc.a.Ib.Qr=!0);return this.ia.processAction(a,b)}dsj(a,b){switch(a){case M.a.akb:a=M.a.qic;break;case M.a.bkb:a=M.a.ric;break;case M.a.ckb:a=M.a.sic;break;case M.a.dkb:a=M.a.tic;break;default:return Ba.a.J(8955555,816,50,"SelectionActor::HandleMoveShapeKeyboard does not recognize this action"),8}return this.ia.processAction(a,
b)}Jnh(a,b,c,h,m){if(this.VQ.v_)return 16;if(1===c)return 32;b=this.ua.Ba;if(!b)return 16;c=b.Pk();if(!c||!c.length)return 16;this.Ed();h=this.ob.sg();if(this.ob.xKb){if(c=this.ob.xKb.tg(this.Vb.GK.Ma))c.cbe(),c.Goh(!1);h.length||h.push(this.ob.xKb);this.ob.xKb=null}h&&this.UKa(h,!1);c=null;a===M.a.g0a?c=m?m:b.x9a(h,!1,0):a===M.a.pMb&&(c=b.x9a(h,!0,0));if(!c)return ba.ULS.sendTraceTag(587563472,816,10,"SelectionActor.SelectNextShapeHandler: failed to find next shape to select"),16;if(this.R7j){m=
Object(ua.a)(zz.a,c.tg(this.Vb.GK.Ma));if(c.eFa&&m&&a===M.a.pMb){const y=document.getElementById(dN.a.IHe+m.kT);if(y&&document.activeElement!==y)return m.UKa(),y.focus(),32}if(h.length&&(m=h[0],h=Object(ua.a)(zz.a,m.tg(this.Vb.GK.Ma)),m.eFa&&h&&a===M.a.g0a&&(a=document.getElementById(dN.a.IHe+h.kT))&&document.activeElement!==a))return a.focus(),32}return this.bch(c,b)}R1k(a,b,c){if(this.VQ.v_)return 16;if(1===c)return 32;a=this.ua.Ba;if(!a)return 16;b=a.Pk();if(!b.length)return 16;a=[];for(const h of b)(b=
Object(ua.a)(117,h.tg(this.Vb.GK.Ma)))&&b.$p?b.UKa():(b&&b.shapeNode&&b.shapeNode.Yx&&b.h1(!1),a.push(h));this.ob.s_a(a,!0);this.vJ.FKk();this.UKa(a,!0);this.Ed();return 32}S1k(a,b,c){if(1===c)return 32;a=this.ua.presentation;if(!a)throw Error.argumentNull("Presentation is null");a=a.slides||[];if(!a.length)return 16;Ba.a.J(34358608,816,50,"Selected All Slides");let h;(h=this.ob).WU.apply(h,a);this.Ie.bya(this.Sb.Lj()-1);return 32}Ial(a,b,c){if(1===c)return 32;this.ia.processAction(M.a.Zce,2);this.ia.processAction(M.a.iOb,
2);Rd.a("RaiseEscapeKeyPressedEvent")&&this.ve.RIk();return 32}Iwl(a,b,c){if(!this.ob.bH())return 16;if(1===c)return 32;this.HC.XPa();a=this.ob.Xd();if(b=this.Ea.g9a(a))return a=this.Ea.vr(b),this.bch(a,this.ua.Ba);this.UKa(a,!1);this.ob.Qh();this.Ed();return 32}Uuj(){this.ia.processAction(M.a.k$g,2);this.ova&&this.ia.processAction(M.a.Hwf,2);return 32}cAk(){if(!this.ob.sei()&&!this.ob.tei())return 2;const a=this.ob.Xd();if(1<a.length)return 2;for(let b=0;b<a.length;b++){const c=this.z$.ZSa(a[b]);
c&&c.startPlaying()}return 32}bch(a,b){const c=a.tg(this.Vb.GK.Ma);if(c){if(c.$p)return this.ob.Qh(),c.UKa(),c.Goh(!0),c.DR(),b=null,c.X0c?b=String.format(ResourceStrings.L_CannotEditHint,c.X0c.userName):Ba.a.J(19140689,828,10,"Shape is locked but the LockOwner is null. Shape: {0}.",c.shapeNode?c.shapeNode.get_shapeId().toString():""),this.zVa.Seh(a,b),this.ob.xKb=a,32}else return ba.ULS.sendTraceTag(587563469,816,10,"SelectionActor.SelectNextShapeHandler: ShapeViewElement of next shape is null"),
8;this.ob.selectShape(a,!0);(a=b.tg(this.Vb.GK.Ma))&&a.aya();c&&(c.UKa(),c.DR());return 32}Ed(){this.Vb.GK.np||this.Fa.Ed()}UKa(a,b){for(const c of a)(a=c.tg(this.Vb.GK.Ma))&&(b?a.UKa():a.cbe())}}Object(n.a)(eN,"SelectionActor",null,[227]);class dA{constructor(){this.isHiddenShape=!1;this.shapeName=null;this.shapeId=0;this.key=null;this.isFocussedShape=!1;this.children=null}}Object(n.a)(dA,"SelectionPaneShapeNode",null,[]);var SQ=d(883);class fN{constructor(a,b,c,h,m,y,G,U,ja,va,Ta,fb,Db,gc,hc,Gc,
Pc){this.Qec=this.jR=null;a("powerpoint-editor-intl").then(()=>{Ba.a.J(512500438,801,50,"Icons and strings script is loaded successfully");a("selectionPaneManager").then(()=>{Ba.a.J(512500437,801,50,"selection Pane Manager script is loaded successfully");this.jR=selectionPaneManager.FactoryGlobal.getSelectionPaneManagerInstance();this.yQk();ja.g9k()}).catch(yc=>{Ba.a.J(512500436,801,10,"Failed to load selectionPaneManager "+yc.toString())})}).catch(yc=>{Ba.a.J(512500435,801,10,"Failed to load powerpoint-editor-intl "+
yc.toString())});this.ob=b;this.Qb=c;this.ia=h;this.ua=m;this.Fa=y;this.iA=G;this.BSg=U;this.J$j=ja;this.Lg=va;this.qd=Ta;this.Lc=fb;this.q$=Db;this.eJ=gc;this.Ea=hc;this.mz=Gc;this.Jb=Pc;this.fpg=!1;this.Lg.kI(Object(F.a)(this,this.BYa,"onChangeRenderSelectionPane"));this.Lg.BBa(Object(F.a)(this,this.BYa,"onChangeRenderSelectionPane"));this.Lc.oPa(Object(F.a)(this,this.BYa,"onChangeRenderSelectionPane"));this.qd.EBa(Object(F.a)(this,this.BYa,"onChangeRenderSelectionPane"));this.Qb.IK(Object(F.a)(this,
this.Mu,"onAppFrameModeSwitched"));this.qVa=!1;this.PPg=null}dispose(){this.Lg.F5(Object(F.a)(this,this.BYa,"onChangeRenderSelectionPane"));this.Lg.NZa(Object(F.a)(this,this.BYa,"onChangeRenderSelectionPane"));this.Lc.gib(Object(F.a)(this,this.BYa,"onChangeRenderSelectionPane"));this.qd.iib(Object(F.a)(this,this.BYa,"onChangeRenderSelectionPane"));this.Qb.wY(Object(F.a)(this,this.Mu,"onAppFrameModeSwitched"))}De(){const a=this.Fa.Gc(Ua.a.HE);a.bindAction(w.KeyInputManager.Na(z.a.u1a,6),M.a.Voc);a.bindAction(w.KeyInputManager.Na(z.a.ipa,
6),M.a.YYb)}Voc(a){return zg.a("SelectionPaneBringBackward",a,()=>{this.qVa=!0;this.ia.processAction(M.a.sendBackward,2);Ba.a.J(512500434,822,50,"SelectionPane SendBackwardSelectionPane action is generated");return 32})}YYb(a){return zg.a("SelectionPaneBringForward",a,()=>{this.qVa=!0;this.ia.processAction(M.a.bringForward,2);Ba.a.J(512500433,822,50,"SelectionPane BringForwardSelectionPane action is generated");return 32})}vb(){this.ia.ra(M.a.X5,nc.a.application,Object(F.a)(this,this.X5,"showHideSelectionPane"),
4);this.ia.ra(M.a.KIb,nc.a.application,Object(F.a)(this,this.KIb,"querySelectionPane"),96);this.ia.ya(M.a.Voc,nc.a.application,Object(F.a)(this,this.Voc,"sendBackwardSelectionPane"));this.ia.ya(M.a.YYb,nc.a.application,Object(F.a)(this,this.YYb,"bringForwardSelectionPane"))}KIb(a,b,c,h,m){(a=Object(ua.a)(Ph.a,m))&&a.Qf(this.iA.isVisible);return 32}X5(a,b,c){return 1===c?this.jR&&this.ua.Ba?32:8:zg.a("SelectionPaneOpen",a,()=>{this.iA.isVisible=!this.iA.isVisible;this.Qih();this.iA.isVisible?(this.eJ.notesPane&&
this.eJ.notesPane.zYb()&&this.Fa.Ed(),this.Fa.Bj(Ua.a.HE,!0),this.jR.focusShowAllButton()):this.Fa.Bj(Ua.a.HE,!1);return 32})}Mu(a){1===a.mode&&this.iA&&this.iA.isVisible&&(this.iA.isVisible=!1,this.Fa.Bj(Ua.a.HE,!1))}ayi(){const a={};this.Qec=new xa.ScriptSharpLegacyMap;var b=this.ua.Ba,c=b?b.Pk(!0):null;b=this.ob.sg();const h=new Qa.a;let m=0;if(c){c.reverse();for(const G of c)if(!G.isLocal)if(c=this.$3f(G,b),G.Jf){if(m++,c=this.Ea.Yw(G)){c.reverse();for(const U of c){c=this.$3f(U,b);let ja=null;
for(const va of U.UA){var y=void 0;va.ShapeId.toString()in a?(y=Object(ua.a)(dA,a[va.ShapeId.toString()]),this.Qec.ga(va.ShapeId).push(U.get_shapeId())):(y=[U.get_shapeId()],this.Qec.add(va.ShapeId,y),y=this.hhj(va,b),a[va.ShapeId.toString()]=y,ja?ja.children.push(y):h.add(y));ja=y}ja.children.push(c)}}}else h.add(c)}0<m&&!this.fpg&&(Ba.a.J(512500432,822,50,"SelectionPane Group count:{0}",m),this.fpg=!0);return h}$3f(a,b){const c=new dA;c.shapeId=a.get_shapeId();c.key=a.get_shapeId().toString();c.shapeName=
a.shapeName;c.isHiddenShape=a.isHiddenShape;c.isFocussedShape=Array.contains(b,a);c.children=[];return c}hhj(a,b){const c=new dA;c.shapeId=a.ShapeId;c.shapeName=a.ShapeName;c.isHiddenShape=a.IsHidden;c.isFocussedShape=!1;const h=this.ua.Ba;if(!h)throw Error.argumentNull("ActiveSlide is null");if(a=h.kC(a.ShapeId))c.isFocussedShape=Array.contains(b,a),c.shapeName=a.shapeName,c.isHiddenShape=a.isHiddenShape;c.children=[];return c}Qih(){if(!this.ua.Ba)this.iA.isVisible=!1;else if(this.iA.isVisible){var a=
this.ayi();if(this.Wvf(a?a.toArray():null,this.PPg)){this.PPg=a?a.toArray():null;var b=this.q$.Ci("UserAction","SelectionPane Rendering started");this.jR.renderSelectionPane(SQ.a.Vnh,a.toArray());a=b.Rq.toString();b.stop();Ba.a.J(512500430,822,50,"SelectionPane Rendering Completed. Time(in ms) : {0}",a)}else Ba.a.J(512500431,822,50,"SelectionPane Rendering not required.")}}Wvf(a,b){if(!a&&b||a&&!b)return!0;if(!a&&!b||!a.length&&!b.length)return!1;if(a.length!==b.length)return!0;for(let c=0;c<a.length;c++){const h=
a[c],m=b[c];if(h||m)if(!h&&m||h&&!m||h.shapeId!==m.shapeId||h.key!==m.key||h.shapeName!==m.shapeName||h.isHiddenShape!==m.isHiddenShape||h.isFocussedShape!==m.isFocussedShape||this.Wvf(h.children,m.children))return!0}return!1}BYa(){this.Qih();this.qVa&&(this.iA.isVisible?this.Fa.Bj(Ua.a.HE,!0):this.Fa.Bj(Ua.a.HE,!1));this.qVa=!1}CWe(a,b,c){let h;const m=c.UA.length,y=[];h=!1;for(let G=0;G<m;G++){const U=c.UA[G];U.ShapeId===a&&(2===b?(U.IsHidden=!U.IsHidden,h=U.IsHidden):0===b?h=U.IsHidden=!0:1===
b&&(h=U.IsHidden=!1));y.push(U)}return{returnValue:y,BOj:h}}ppi(a){var b=this.ua.Ba;if(!b)throw Error.argumentNull("ActiveSlide is null");var c=this.Qec.ga(a);if(!c||1>=c.length)Ba.a.J(512500429,801,10,"There should be atleast 2 child shapes in the nested group");else{var h=b.kC(c[0]);if(h){var m=!1;a=({BOj:m}=this.CWe(a,2,h)).returnValue;for(const y of c){const G=(c=b.kC(y))?Object(ua.a)(117,c.sc(this.mz)):null;G&&(m?(G.gka(),this.ob.cX(c)&&this.ob.Z7(c)):!m&&G.PLa())}b=this.Jb.zd(15);try{b.nc(h),
h.UA=a}finally{b&&b.dispose()}}else Ba.a.J(512500428,801,10,"ChildShapeNode for nested group with the given Id should not be NULL")}}Tuh(a){const b=this.ua.Ba;if(!b)throw Error.argumentNull("ActiveSlide is null");var c=b.Pk(!0),h=[];for(const m of c)if(m.Jf){const y=this.Ea.Yw(m);h=h.concat.apply(h,y)}if((c=c.concat.apply(c,h))&&c.length){a&&(this.ob.ij(),this.ob.fsa(c));for(const m of c)!a&&m.isHiddenShape?Object(ua.a)(117,m.sc(this.mz)).PLa():a&&!m.isHiddenShape&&Object(ua.a)(117,m.sc(this.mz)).gka();
h=this.Jb.zd(15);try{h.nc(b);for(const m of c)!a&&m.isHiddenShape?m.isHiddenShape=!1:a&&!m.isHiddenShape&&(m.isHiddenShape=!0);for(let m of this.Qec)if(!b.kC(m.key)){const y=m.value;if(!y||1>=y.length){Ba.a.J(512500427,801,10,"There should be atleast 2 child shapes in the nested group");continue}const G=b.kC(y[0]);G?(c=[],c=a?this.CWe(m.key,0,G).returnValue:this.CWe(m.key,1,G).returnValue,G.UA=c):Ba.a.J(512500426,801,10,"ChildShapeNode for nested group with the given Id should not be NULL")}}finally{h&&
h.dispose()}}}yQk(){this.jR.addCloseSelectionPaneEventListener(()=>{Ba.a.J(512500425,822,50,"SelectionPane AddCloseSelectionPaneEventListener event is generated");this.iA.isVisible=!1});this.jR.addFocusSelectionPaneListener(()=>{Ba.a.J(512500424,822,50,"SelectionPane AddFocusSelectionPaneListener event is generated");this.Fa.Bj(Ua.a.HE,!0)});this.jR.addSelectShapeEventListener(a=>{Ba.a.J(512500423,822,50,"SelectionPane AddSelectShapeEventListener event is generated");const b=this.ua.Ba;if(!b)throw Error.argumentNull("ActiveSlide is null");
(a=b.kC(a))&&(a.isHiddenShape||this.ob.selectShape(a,!0))});this.jR.addSelectMultipleShapesEventListener(a=>{Ba.a.J(512500422,822,50,"SelectionPane AddSelectMultipleShapesEventListener event is generated");const b=this.ua.Ba;if(!b)throw Error.argumentNull("ActiveSlide is null");zg.a("SelectionPaneMultiSelect",M.a.X5,()=>{if(!a.length){var c=this.ob.Xd();this.ob.fsa(c)}c=0;for(const h of a){const m=b.kC(h);m&&!m.isHiddenShape&&(c?this.ob.selectShape(m,!1):(this.ob.selectShape(m,!0),c++))}return 32})});
this.jR.addToggleVisibilityListener(a=>{Ba.a.J(512500421,822,50,"SelectionPane ToggleShapeVisibility event is generated");var b=this.ua.Ba;if(!b)throw Error.argumentNull("ActiveSlide is null");const c=b.kC(a);b="";if(!c||c.Kg||c.Jf)b="Group";zg.b("SelectionPaneToggleVisibilty",b,M.a.X5,()=>{c?this.BSg.Pql(a):this.ppi(a);return 32})});this.jR.addShapeRenameListener((a,b)=>{Ba.a.J(512500420,822,50,"SelectionPane AddShapeRenameListener event is generated");var c=this.ua.Ba;if(!c)throw Error.argumentNull("ActiveSlide is null");
c=c.kC(a);let h="";if(!c||c.Kg||c.Jf)h="Group";zg.b("SelectionPaneRename",h,M.a.X5,()=>{this.BSg.n9k(a,b);return 32})});this.jR.addShapeReorderListener((a,b)=>{Ba.a.J(512500419,822,50,"SelectionPane AddShapeReorderListener event is generated");var c=this.ua.Ba;if(!c)throw Error.argumentNull("ActiveSlide is null");const h=c.kC(a);let m="";if(!h||h.Kg||h.Jf)m="Group";else if(c=c.kC(b),!c||c.Kg||c.Jf)m="Group";zg.b("SelectionPaneReorder",m,M.a.X5,()=>{this.J$j.mik(a,b);return 32})});this.jR.addShowAllButtonEventListener(()=>
{this.qVa=!0;Ba.a.J(512500418,822,50,"SelectionPane ShowOrHideAllShapes event is generated");zg.a("SelectionPaneShowAll",M.a.X5,()=>{this.Tuh(!1);return 32})});this.jR.addHideAllButtonEventListener(()=>{this.qVa=!0;Ba.a.J(512500417,822,50,"SelectionPane AddHideAllButtonEventListener event is generated");zg.a("SelectionPaneHideAll",M.a.X5,()=>{this.Tuh(!0);return 32})});this.jR.addBringForwardButtonEventListener(()=>{this.qVa=!0;Ba.a.J(512500416,822,50,"SelectionPane AddBringForwardButtonEventListener event is generated");
zg.a("SelectionPaneBringForward",M.a.X5,()=>{this.ia.processAction(M.a.bringForward,2);return 32})});this.jR.addBringBackwardButtonEventListener(()=>{this.qVa=!0;Ba.a.J(512500387,822,50,"SelectionPane AddBringBackwardButtonEventListener event is generated");zg.a("SelectionPaneBringBackward",M.a.X5,()=>{this.ia.processAction(M.a.sendBackward,2);return 32})});Ba.a.J(512500386,822,50,"SelectionPane RegisterSelectionPaneEventListeners is finished")}}Object(n.a)(fN,"SelectionPaneActor",null,[227]);class gN{constructor(a,
b,c,h){this.Tda=!1;this.Aec="ShapeAlignToSelectedObjects";this.ia=a;this.Fb=c;this.ob=b;this.j0=h}vb(){Ba.a.J(50630811,822,50,"ShapeAlignmentActor::RegisterActions() - OptIn: True");this.ia.ra(M.a.Otf,nc.a.application,Object(F.a)(this,this.nTa,"handleShapesAlignment"),4);this.ia.ra(M.a.Wrh,nc.a.application,Object(F.a)(this,this.nTa,"handleShapesAlignment"),4);this.ia.ra(M.a.uod,nc.a.application,Object(F.a)(this,this.nTa,"handleShapesAlignment"),4);this.ia.ra(M.a.Upc,nc.a.application,Object(F.a)(this,
this.nTa,"handleShapesAlignment"),4);this.ia.ra(M.a.vod,nc.a.application,Object(F.a)(this,this.nTa,"handleShapesAlignment"),4);this.ia.ra(M.a.Rpc,nc.a.application,Object(F.a)(this,this.nTa,"handleShapesAlignment"),4);this.ia.ra(M.a.Spc,nc.a.application,Object(F.a)(this,this.nTa,"handleShapesAlignment"),4);this.ia.ra(M.a.Tpc,nc.a.application,Object(F.a)(this,this.nTa,"handleShapesAlignment"),4);this.ia.ra(M.a.TCa,nc.a.application,Object(F.a)(this,this.d9f,"handleShapesDistribution"),4);this.ia.ra(M.a.L1b,
nc.a.application,Object(F.a)(this,this.d9f,"handleShapesDistribution"),4);this.ia.ra(M.a.MIb,nc.a.application,Object(F.a)(this,this.MIb,"queryShapeAlignToSlide"),96);this.ia.ya(M.a.Msc,nc.a.application,Object(F.a)(this,this.Msc,"toggleShapeAlignToSlide"));this.ia.ra(M.a.LIb,nc.a.application,Object(F.a)(this,this.LIb,"queryShapeAlignToSelectedObjects"),96);this.ia.ya(M.a.Lsc,nc.a.application,Object(F.a)(this,this.Lsc,"toggleShapeAlignToSelectedObjects"))}De(){}c$b(){return u.AFrameworkApplication.Aa&&
u.AFrameworkApplication.Aa.hb.Np?!0:!1}nTa(a,b,c){if(this.j0){b=this.ob.Xd();for(const m of b)if(!m.eb(X.a.vUa))return 16}const h=this.ob.sg();return h?1===c?h.length?32:8:zg.a("Align",a,()=>{Ba.a.J(50598728,822,50,"ShapeAlignmentActor::HandleShapesAlignment, Align operation performed");const m=[],y=1===h.length||this.Tda?this.UTf(a):this.TTf(a,h);if(null===y)return Ba.a.J(50598730,822,10,"ShapeAlignmentActor::HandleShapesAlignment, error in finding reference point"),16;for(const G of h)m.push(new Bv(G,
this.Vbj(a,G,y)));if(!m[0].shapeNode.Kg)for(const G of m)this.al(G.shapeNode).setPosition(G.position.x,G.position.y,!0);this.ia.La(M.a.BIa,2,m);return 32}):(Ba.a.J(50598726,822,10,"ShapeAlignmentActor::HandleShapesAlignment, selected nodes: null"),16)}MIb(a,b,c,h,m){if(!m||!Object(za.a)(Ph.a,m))return Ba.a.J(50598732,822,10,"ShapeAlignmentActor::QueryShapeAlignToSlide Invalid actionData"),8;m.Qf(this.Tda);Ba.a.J(50598734,822,50,"ShapeAlignmentActor::QueryShapeAlignToSlide: Align to Slide button is selected");
return 32}Msc(a,b,c,h,m){a=this.ob.sg();if(1===c)return 2>a.length&&(this.Tda=!0,this.Aec="ShapeAlignToSlide",Ba.a.J(50598736,822,50,"ShapeAlignmentActor::ToggleShapeAlignToSlide single shape selected, enable Align to slide button")),32;if(!m||"object"!==typeof m)return Ba.a.J(50598738,822,10,"ShapeAlignmentActor::ToggleShapeAlignToSlide requires actionData"),8;this.mFh(m)&&(this.Tda=!0,Ba.a.J(50598740,822,50,"ShapeAlignmentActor::ToggleShapeAlignToSlide: Align to slide is enabled"));return 32}LIb(a,
b,c,h,m){if(!m||!Object(za.a)(Ph.a,m))return Ba.a.J(50598742,822,10,"ShapeAlignmentActor::QueryShapeAlignToSelectedObjects Invalid actionData"),8;m.Qf(!this.Tda);Ba.a.J(50598744,822,50,"ShapeAlignmentActor::QueryShapeAlignToSelectedObjects: Align Selected Objects button is enabled");return 32}Lsc(a,b,c,h,m){a=this.ob.sg();if(1===c)return 1<a.length?32:8;if(!m||"object"!==typeof m)return Ba.a.J(50598746,822,10,"ShapeAlignmentActor::ToggleShapeAlignToSelectedObjects requires actionData"),8;this.mFh(m)&&
(this.Tda=!1,Ba.a.J(50598748,822,50,"ShapeAlignmentActor::ToggleShapeAlignToSelectedObjects: Align Selected Objects is enabled"));return 32}Vbj(a,b,c){let h=null;var m=this.al(b);b=m.OQc();m=m.ls();switch(a){case M.a.uod:Ba.a.J(50598750,822,50,"ShapeAlignmentActor::ShapeAlignLeft: Align Left is selected ");h=new ad.a(b.x-m.hc+c,b.y);break;case M.a.Upc:Ba.a.J(50598752,822,50,"ShapeAlignmentActor::ShapeAlignRight: Align Right is selected");h=new ad.a(b.x+(c-m.Zb),b.y);break;case M.a.vod:Ba.a.J(50598754,
822,50,"ShapeAlignmentActor::ShapeAlignTop: Align Top is selected");h=new ad.a(b.x,b.y-m.kc+c);break;case M.a.Rpc:Ba.a.J(50598784,822,50,"ShapeAlignmentActor::ShapeAlignBottom: Align Bottom is selected");h=new ad.a(b.x,b.y+(c-m.Xb));break;case M.a.Spc:Ba.a.J(50598786,822,50,"ShapeAlignmentActor::ShapeAlignCenter: Align Center is selected");h=new ad.a(b.x+(c-m.Xf().x),b.y);break;case M.a.Tpc:Ba.a.J(50598788,822,50,"ShapeAlignmentActor::ShapeAlignMiddle: Align Middle is selected"),h=new ad.a(b.x,b.y+
(c-m.Xf().y))}return h}d9f(a,b,c){const h=this.ob.sg();return h?1===c?!h.length||2===h.length&&!this.Tda?8:32:zg.a("Align",a,()=>{Ba.a.J(50902275,822,50,"ShapeAlignmentActor::HandleShapesDistribution, Distribute operation performed");this.NXe(h,a,0,h.length-1);var m=1===h.length||2===h.length||this.Tda?this.UTf(a):this.TTf(a,h);if(null===m)return Ba.a.J(527013341,815,10,"ShapeAlignmentActor::HandleShapesDistribution, error in finding reference point"),16;var y=m-this.oni(a,h);m=this.Zmi(h,y);y=this.cni(a,
h,y,m);this.HMi(a,h,h.length-1,m,y);return 32}):(Ba.a.J(50902273,822,10,"ShapeAlignmentActor::HandleShapesDistribution, selected nodes: null"),16)}oni(a,b){return a===M.a.TCa?this.pni(b):this.qni(b)}pni(a){let b=0;for(const c of a)a=this.al(c),b+=a.ls().Xb-a.ls().kc;return b}qni(a){let b=0;for(const c of a)a=this.al(c),b+=a.ls().Zb-a.ls().hc;return b}cni(a,b,c,h){if(1===b.length||this.Tda)return 0<c?h:0;b=this.al(b[0]);return a===M.a.TCa?b.ls().Xb+h:b.ls().Zb+h}Zmi(a,b){return(1===a.length||this.Tda)&&
0<b?1*b/(a.length+1):1*b/(a.length-1)}HMi(a,b,c,h,m){var y=0;const G=[];1<b.length&&!this.Tda?(Ba.a.J(50902277,822,50,"ShapeAlignmentActor::DistributeShapes, Distribute: Align to Selected Objects"),y++,c--):Ba.a.J(50902279,822,50,"ShapeAlignmentActor::DistributeShapes, Distribute: Align to Slide");for(a===M.a.TCa?Ba.a.J(50902281,822,50,"ShapeAlignmentActor::DistributeShapes, Distribute Vertically"):Ba.a.J(50902283,822,50,"ShapeAlignmentActor::DistributeShapes, Distribute Horizontally");y<=c;y++){const ja=
b[y];if(!ja)continue;let va=this.al(ja);if(va){var U=va.OQc();a===M.a.TCa?(U=new ad.a(U.x,m),G.push(new Bv(ja,U)),m+=va.ls().Xb-va.ls().kc+h):(U=new ad.a(m,U.y),G.push(new Bv(ja,U)),m+=va.ls().Zb-va.ls().hc+h)}}if(G[0]&&!G[0].shapeNode.Kg)for(const ja of G)this.al(ja.shapeNode).setPosition(ja.position.x,ja.position.y,!0);this.ia.La(M.a.BIa,2,G)}UTf(a){const b=Object(ua.a)(295,this.ob.sk().sc(this.Fb.Ma));if(!b)return Ba.a.J(51500956,822,10,"ShapeAlignmentActor::FindReferencePointRelativeToSlide,Error in finding reference point: SlideViewElement is NULL, ActionID: {0}",
a),null;switch(a){case M.a.Upc:case M.a.L1b:return b.BB.clientWidth;case M.a.Rpc:case M.a.TCa:return b.BB.clientHeight;case M.a.Spc:return b.BB.clientWidth/2;case M.a.Tpc:return b.BB.clientHeight/2;default:return Ba.a.J(51500958,822,10,"ShapeAlignmentActor::FindReferencePointRelativeToSlide, Error in finding reference point, ActionID: {0}",a),0}}TTf(a,b){switch(a){case M.a.uod:var c=Number.MAX_VALUE;for(const y of b)b=this.al(y),c=Math.min(b.ls().hc,c);return c;case M.a.Upc:c=-Number.MAX_VALUE;for(const y of b)b=
this.al(y),c=Math.max(b.ls().Zb,c);return c;case M.a.vod:c=Number.MAX_VALUE;for(const y of b)b=this.al(y),c=Math.min(b.ls().kc,c);return c;case M.a.Rpc:c=-Number.MAX_VALUE;for(const y of b)b=this.al(y),c=Math.max(b.ls().Xb,c);return c;case M.a.Spc:var h=Number.MAX_VALUE,m=-Number.MAX_VALUE;for(c of b)b=this.al(c),h=Math.min(b.ls().hc,h),m=Math.max(b.ls().Zb,m);return h+(m-h)/2;case M.a.Tpc:c=Number.MAX_VALUE;m=-Number.MAX_VALUE;for(h of b)b=this.al(h),c=Math.min(b.ls().kc,c),m=Math.max(b.ls().Xb,
m);return c+(m-c)/2;case M.a.TCa:c=Number.MAX_VALUE;h=-Number.MAX_VALUE;for(m of b)b=this.al(m),c=Math.min(c,b.ls().kc),h=Math.max(b.ls().Xb,h);return h-c;case M.a.L1b:c=Number.MAX_VALUE;h=-Number.MAX_VALUE;for(const y of b)b=this.al(y),c=Math.min(c,b.ls().hc),h=Math.max(b.ls().Zb,h);return h-c;default:return Ba.a.J(51500960,822,10,"ShapeAlignmentActor::FindReferencePointRelativeToSelectedObjects, Error in finding reference point, ActionID: {0}, No of selectedNodes: {1}",a,b.length),null}}NXe(a,b,
c,h){if(!(c>=h)){var m=this.tyk(a,b,c,h);this.NXe(a,b,c,m-1);this.NXe(a,b,m+1,h)}}tyk(a,b,c,h){if(b===M.a.TCa)return this.vyk(a,c,h);if(b===M.a.L1b)return this.uyk(a,c,h);Ba.a.J(50902285,822,10,"ShapeAlignmentActor::SortSelectedShapes:PartitionSelectedNodesList, actionId not supported");return-1}vyk(a,b,c){var h=this.al(a[c]).ls().Xf().y;let m=b-1;for(;b<=c-1;b++)if(this.al(a[b]).ls().Xf().y<h){m++;const y=a[m];a[m]=a[b];a[b]=y}h=a[m+1];a[m+1]=a[c];a[c]=h;return m+1}uyk(a,b,c){var h=this.al(a[c]).ls().Xf().x;
let m=b-1;for(;b<=c-1;b++)if(this.al(a[b]).ls().Xf().x<h){m++;const y=a[m];a[m]=a[b];a[b]=y}h=a[m+1];a[m+1]=a[c];a[c]=h;return m+1}mFh(a){const b=a.SourceControlId;return a[Zh.a.On]&&this.Aec!==b?(this.Tda="ShapeAlignToSelectedObjects"===this.Aec,this.c$b()&&(a={},a[b]="ToggleButtonModel",a[this.Aec]="ToggleButtonModel",Fc.App.Kb.mG(a)),this.Aec=b,!0):!1}al(a){return a?Object(ua.a)(117,a.sc(this.Fb.Ma)):null}}Object(n.a)(gN,"ShapeAlignmentActor",null,[227]);var hN=d(497),TQ=d(950);class Ux{}Object(n.a)(Ux,
"CT_NoFillProperties",null,[]);var UQ=d(951);class eA{constructor(a,b){this.Xol=a;this.Xrc=b}}Object(n.a)(eA,"FormatPainterData",null,[]);var iN=d(725);class fi{constructor(a,b,c,h,m,y,G,U,ja,va,Ta,fb,Db,gc,hc,Gc,Pc,yc,Vd,De,Wd,Ve){this.Uml="data:image/svg+xml;charset=utf8,";this.XIe=96;this.ia=a;this.pa=G;this.je=h;this.Jb=c;this.Fa=b;this.HC=m;this.fc=y;this.Tte=ja;this.bJ=U;this.$ve=Ta;this.GCg=(a=!yc||!yc.isInHighContrastMode)&&Pc.ehe;this.FX=Pc.powerPointGraphicToolTabIsEnabled;this.Hve=a&&Pc.svgIconLocalEditingIsEnabled;
this.dfb=va;this.mz=Ve;this.Ea=fb;this.RQ=Db;this.lU=gc;this.Vb=hc;this.ua=Gc;this.yc=Vd;this.Sp=Pc.pptTextFormatPainterIsEnabled;this.uwg=Pc.formatPainterApplyRemappedIsEnabled;this.uCg=Pc.e_c;this.pdb=Pc.mDk;this.aU=Pc.SHb;this.la=Pc;this.gj=De;this.uec=new xa.ScriptSharpLegacyMap;this.jA=Wd}vb(){this.ia.ra(M.a.mJe,nc.a.application,Object(F.a)(this,this.Zsj,"handlePopulateShapeFillMenu"),96);this.ia.ra(M.a.JCe,nc.a.application,Object(F.a)(this,this.Wrj,"handleMoreFillColors"),96);this.ia.ra(M.a.LCe,
nc.a.application,Object(F.a)(this,this.asj,"handleMoreOutlineColors"),96);this.ia.ra(M.a.KBa,nc.a.application,Object(F.a)(this,this.J7f,"handleApplyShapeFillColor"),4);this.ia.ra(M.a.MGc,nc.a.application,Object(F.a)(this,this.apj,"handleApplyShapeFillCustomColor"),4);this.ia.ra(M.a.irb,nc.a.application,Object(F.a)(this,this.J7f,"handleApplyShapeFillColor"),4);this.ia.ra(M.a.akd,nc.a.application,Object(F.a)(this,this.O8f,"handleRemoveShapeFill"),4);this.ia.ra(M.a.KOe,nc.a.application,Object(F.a)(this,
this.O8f,"handleRemoveShapeFill"),4);this.ia.ra(M.a.Vgd,nc.a.application,Object(F.a)(this,this.$sj,"handlePopulateShapeOutlineMenu"),96);this.ia.ra(M.a.ria,nc.a.application,Object(F.a)(this,this.K7f,"handleApplyShapeOutlineColor"),4);this.ia.ra(M.a.NGc,nc.a.application,Object(F.a)(this,this.bpj,"handleApplyShapeOutlineCustomColor"),4);this.ia.ra(M.a.jrb,nc.a.application,Object(F.a)(this,this.K7f,"handleApplyShapeOutlineColor"),4);this.ia.ra(M.a.zPa,nc.a.application,Object(F.a)(this,this.fpj,"handleApplyShapeOutlineWidth"),
4);this.ia.ra(M.a.T5a,nc.a.application,Object(F.a)(this,this.cpj,"handleApplyShapeOutlineDashStyle"),4);this.uCg&&this.ia.ra(M.a.U5a,nc.a.application,Object(F.a)(this,this.epj,"handleApplyShapeOutlineSketchStyle"),4);this.ia.ra(M.a.sia,nc.a.application,Object(F.a)(this,this.dpj,"handleApplyShapeOutlineEndStyle"),4);this.ia.ra(M.a.bkd,nc.a.application,Object(F.a)(this,this.P8f,"handleRemoveShapeOutline"),4);this.ia.ra(M.a.LOe,nc.a.application,Object(F.a)(this,this.P8f,"handleRemoveShapeOutline"),4);
this.ia.ra(M.a.YRa,nc.a.application,Object(F.a)(this,this.nvj,"handleToggleFormatPainterActive"),4);this.ia.ra(M.a.Bja,nc.a.application,Object(F.a)(this,this.Soj,"handleApplyFormat"),4);this.ia.ra(M.a.n3d,nc.a.application,Object(F.a)(this,this.Toj,"handleApplyFormatToShape"),5);this.ia.ra(M.a.$hd,nc.a.application,Object(F.a)(this,this.ptj,"handleQueryFormatPainter"),97);this.ia.ra(M.a.ZHb,nc.a.application,Object(F.a)(this,this.ftj,"handlePreviewShapeFillColor"),4);this.ia.ra(M.a.$Jb,nc.a.application,
Object(F.a)(this,this.muj,"handleRevertPreviewShapeFillColor"),4)}De(){const a=this.Fa.Gc(Ua.a.rg);a.bindAction(w.KeyInputManager.Na(z.a.yza,6),M.a.YRa);const b=this.Fa.Gc(Ua.a.iQ);let c=w.KeyInputManager.Na(z.a.yza,6);b.Ap(c);this.Sp?b.bindAction(c,D.a.PPc):b.bindAction(c,M.a.YRa);Ba.a.J(512500379,815,50,"formatPainterApplyRemapped: {0}",this.uwg);this.uwg||(c=w.KeyInputManager.Na(z.a.v1a,6),a.bindAction(c,M.a.Bja),b.Ap(c),this.Sp?b.bindAction(c,M.a.o3d):b.bindAction(c,M.a.Bja))}gwb(a,b){const c=
[];if(a)for(const h of a)(h.eua||b&&h.get_isSVGBlipFilled()||h.Ej||this.aU&&1===h.mediaType)&&Array.add(c,h);return c}i9a(a,b){const c=[];if(a)for(const h of a)(h.eua&&!h.Vy||b&&h.get_isSVGBlipFilled()||this.pdb&&h.ud)&&Array.add(c,h);return c}Zsj(a,b,c,h,m){if(!this.pa.J3()||this.fc.qC(this.pa.Xd()))return 16;if(1===c)return 32;if(!m)return 8;b=this.ua.presentation;if(!b)throw Error.argumentNull("Presentation is null");a=b.M7;b=(c=this.pa.Jp())?b.lC(c.slideId):null;if(!b)return 16;var y=!!m.MenuId&&
-1!==m.MenuId.indexOf("Graphics");c=y?M.a.irb:M.a.KBa;h=y?M.a.KOe:M.a.akd;const G=M.a.JCe;if(m.MenuId&&"fill"===m.MenuId){var U=new iN.a(b.Ne);y=new Sys.StringBuilder;y.append(String.format(fi.Mzf,"PptRibbon.Drawing.ShapeFill"));if(!b.Ne)return 8;y.append(U.d$d(c,a,M.a.MGc));y.append(fi.Szf);y.append(String.format(fi.Qzf,h,u.AFrameworkApplication.qm,ResourceStrings.L_RemoveShapeFill,CommonUIStrings.l_RemoveShapeFillKeytip));y.append(fi.Rzf);y.append(fi.Uli);y.append(String.format(fi.Sli,G,u.AFrameworkApplication.qm,
ResourceStrings.L_MoreFillColors,CommonUIStrings.l_MoreFillColorsKeytip));y.append(fi.Tli);y.append(fi.Lzf);m.PopulationXML=y.toString()}else{U=Object.assign(new Mk.a,{Id:"PptRibbon.Drawing.ShapeFill",MenuSectionList:[]});const ja=y?"StandardGraphicFillColorPicker":"StandardShapeFillColorPicker",va=y?"GraphicNoFill":"ShapeNoFill";Array.add(U.MenuSectionList,Uk.f(b.Ne,yE.a.themeColors,"Color.Menu.Controls","themeColor",y?"ThemeGraphicFillColorPicker":"ThemeShapeFillColorPicker",c.toString(),1));Array.add(U.MenuSectionList,
Uk.d("Standard Colors","Color.Menu.Controls","standardColor",ja,c.toString(),!1));a&&0<a.length?(appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("ShapeFillRecentColors",!1)),Array.add(U.MenuSectionList,Uk.c(a,"Recent Colors","Color.Menu.Controls","recentColor","ShapeFillRecentColors","3745557472",!1))):appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("ShapeFillRecentColors",!0));Array.add(U.MenuSectionList,Uk.b("Remove Color","Color.Menu.Controls",h.toString(),ResourceStrings.L_RemoveShapeFill,
"Color.Menu.RemoveColor",va,"per_AppointmentColor0_16x16x32",CommonUIStrings.l_RemoveShapeFillKeytip));Array.add(U.MenuSectionList,Uk.a("More Fill Color","Color.Menu.Controls",G.toString(),ResourceStrings.L_MoreFillColors,"Color.Menu.MoreFillColor","MoreFillColors","per_AppointmentColor0_16x16x32",CommonUIStrings.l_MoreFillColorsKeytip));Rd.a("ColorPickerHighlighterFix")&&(a=this.Tgj(b.Ne),Uk.h(U,a,b.Ne));m.MenuItems=U}return 32}$sj(a,b,c,h,m){a=this.ua.presentation;if(!a)throw Error.argumentNull("Presentation is null");
if(!this.pa.J3()||this.fc.qC(this.pa.Xd()))return 16;if(1===c)return 32;if(!m)return 8;c=(c=this.pa.Jp())?a.lC(c.slideId):null;if(!c||!c.Ne)return 8;a=a.M7;var y=this.je.pk("pegal.png"),G=!!m.MenuId&&-1!==m.MenuId.indexOf("Graphics");b=G?M.a.jrb:M.a.ria;h=G?M.a.LOe:M.a.bkd;const U=M.a.LCe;if(m.MenuId&&"outline"===m.MenuId){var ja=new Sys.StringBuilder;ja.append(String.format(fi.Mzf,"PptRibbon.Drawing.ShapeOutline"));c=new iN.a(c.Ne);ja.append(c.d$d(b,a,M.a.NGc));ja.append(fi.Szf);ja.append(String.format(fi.Qzf,
h,u.AFrameworkApplication.qm,ResourceStrings.L_RemoveShapeOutline,CommonUIStrings.l_RemoveShapeOutlineKeytip));ja.append(fi.Rzf);ja.append(fi.Xli);ja.append(String.format(fi.Vli,U,u.AFrameworkApplication.qm,ResourceStrings.L_MoreOutlineColors,CommonUIStrings.l_MoreOutlineColorsKeytip));ja.append(fi.Wli);c=this.pa.Xd();a=fi.vgj(c,this.FX);if(!a||!a.length||c&&c.length!==a.length)ja.append('<MenuSection Id="OutlineEffects"><Controls Id="OutlineControls">'),ja.append(String.format('<FlyoutAnchor\r\n                   Id="OutlineWeightAnchor"\r\n                   Command="{0}"\r\n                   Image16by16="{2}"\r\n                   Image16by16Class="per_GalLineWidth_16x16x32"\r\n                   LabelText="{3}"\r\n                   Keytip="{9}">\r\n                   <Menu Id="MenuOutlineWeight">\r\n                      <MenuSection\r\n                         Id="MenuSectionOutlineWeight" DisplayMode="Menu16">\r\n                         <Controls Id="MenuSectionOutlineWeight.Controls">\r\n                         <Button\r\n                            Id="OutlineWidthPresent,1"\r\n                            Command="{1}"\r\n                            Image16by16="{8}"\r\n                            Image16by16Class="pegal_GalLineWidthStyle1_16x16x32"\r\n                            LabelText="{4}"/>\r\n                         <Button\r\n                            Id="OutlineWidthPresent,2"\r\n                            Command="{1}"\r\n                            Image16by16="{8}"\r\n                            Image16by16Class="pegal_GalLineWidthStyle2_16x16x32"\r\n                            LabelText="{5}"/>\r\n                         <Button\r\n                            Id="OutlineWidthPresent,3"\r\n                            Command="{1}"\r\n                            Image16by16="{8}"\r\n                            Image16by16Class="pegal_GalLineWidthStyle3_16x16x32"\r\n                            LabelText="{6}"/>\r\n                         <Button\r\n                            Id="OutlineWidthPresent,4"\r\n                            Command="{1}"\r\n                            Image16by16="{8}"\r\n                            Image16by16Class="pegal_GalLineWidthStyle4_16x16x32"\r\n                            LabelText="{7}"/>\r\n                         </Controls>\r\n                      </MenuSection>\r\n                   </Menu>\r\n                </FlyoutAnchor>',
M.a.RGc,M.a.zPa,u.AFrameworkApplication.qm,ResourceStrings.L_ApplyShapeOutlineWidth,ResourceStrings.L_ApplyShapeOutlineWidth_1,ResourceStrings.L_ApplyShapeOutlineWidth_2,ResourceStrings.L_ApplyShapeOutlineWidth_3,ResourceStrings.L_ApplyShapeOutlineWidth_4,y,CommonUIStrings.l_ApplyShapeOutlineWidthKeytip)),ja.append(String.format('<FlyoutAnchor\r\n                   Id="OutlineDashesAnchor"\r\n                   Command="{0}"\r\n                   Image16by16="{2}"\r\n                   Image16by16Class="per_DashStyle_16x16x32"\r\n                   LabelText="{3}"\r\n                   Keytip="{8}">\r\n                   <Menu Id="MenuOutlineDashStyle">\r\n                      <MenuSection\r\n                         Id="MenuSectionOutlineDashStyle" DisplayMode="Menu16">\r\n                         <Controls Id="MenuSectionOutlineDashStyle.Controls">\r\n                         <Button\r\n                            Id="OutlineDashStylePresent,1"\r\n                            Command="{1}"\r\n                            Image16by16="{7}"\r\n                            Image16by16Class="pegal_DashStyle1_16x16x32"\r\n                            LabelText="{4}"/>\r\n                         <Button\r\n                            Id="OutlineDashStylePresent,2"\r\n                            Command="{1}"\r\n                            Image16by16="{7}"\r\n                            Image16by16Class="pegal_DashStyle2_16x16x32"\r\n                            LabelText="{5}"/>\r\n                         <Button\r\n                            Id="OutlineDashStylePresent,4"\r\n                            Command="{1}"\r\n                            Image16by16="{7}"\r\n                            Image16by16Class="pegal_DashStyle3_16x16x32"\r\n                            LabelText="{6}"/>\r\n                         </Controls>\r\n                      </MenuSection>\r\n                   </Menu>\r\n                </FlyoutAnchor>',
M.a.OGc,M.a.T5a,u.AFrameworkApplication.qm,ResourceStrings.L_ApplyShapeOutlineDashStyle,ResourceStrings.L_ApplyShapeOutlineDashStyle_1,ResourceStrings.L_ApplyShapeOutlineDashStyle_2,ResourceStrings.L_ApplyShapeOutlineDashStyle_3,y,CommonUIStrings.l_PPTApplyShapeOutlineDashStyleKeytip)),this.uCg&&ja.append(String.format('<FlyoutAnchor\r\n                   Id="OutlineSketchesAnchor"\r\n                   Command="{0}"\r\n                   Image16by16="{2}"\r\n                   Image16by16Class="per_GalLineSketchy_16x16x32"\r\n                   LabelText="{3}">\r\n                   Keytip="{9}">\r\n                   <Menu Id="MenuOutlineSketchStyle">\r\n                      <MenuSection\r\n                         Id="MenuSectionOutlineSketchStyle" DisplayMode="Menu16">\r\n                         <Controls Id="MenuSectionOutlineSketchStyle.Controls">\r\n                         <Button\r\n                            Id="OutlineSketchStylePresent,1"\r\n                            Command="{1}"\r\n                            Image16by16="{8}"\r\n                            Image16by16Class="pegal_OartLineSketchNone_16x16x32"\r\n                            LabelText="{4}"/>\r\n                         <Button\r\n                            Id="OutlineSketchStylePresent,2"\r\n                            Command="{1}"\r\n                            Image16by16="{8}"\r\n                            Image16by16Class="pegal_OartLineSketchSubtleCurve_16x16x32"\r\n                            LabelText="{5}"/>\r\n                         <Button\r\n                            Id="OutlineSketchStylePresent,3"\r\n                            Command="{1}"\r\n                            Image16by16="{8}"\r\n                            Image16by16Class="pegal_OartLineSketchSubtleWave_16x16x32"\r\n                            LabelText="{6}"/>\r\n                         <Button\r\n                            Id="OutlineSketchStylePresent,4"\r\n                            Command="{1}"\r\n                            Image16by16="{8}"\r\n                            Image16by16Class="pegal_OartLineSketchIntenseWave_16x16x32"\r\n                            LabelText="{7}"/>\r\n                         </Controls>\r\n                      </MenuSection>\r\n                   </Menu>\r\n                </FlyoutAnchor>',
M.a.QGc,M.a.U5a,u.AFrameworkApplication.qm,ResourceStrings.l_ApplyShapeOutlineSketchStyle,ResourceStrings.l_ApplyShapeOutlineSketchStyle_1,ResourceStrings.l_ApplyShapeOutlineSketchStyle_2,ResourceStrings.l_ApplyShapeOutlineSketchStyle_3,ResourceStrings.l_ApplyShapeOutlineSketchStyle_4,y,CommonUIStrings.l_PPTApplyShapeOutlineSketchStyleKeytip)),ja.append(String.format('<FlyoutAnchor\r\n                   Id="OutlineArrowsAnchor"\r\n                   Command="{0}"\r\n                   Image16by16="{2}"\r\n                   Image16by16Class="per_ArrowStyle_16x16x32"\r\n                   LabelText="{3}"\r\n                   Keytip="{12}">\r\n                   <Menu Id="MenuOutlineEndStyle">\r\n                      <MenuSection\r\n                         Id="MenuSectionOutlineEndStyle" DisplayMode="Menu16">\r\n                         <Controls Id="MenuSectionOutlineEndStyle.Controls">\r\n                         <Button\r\n                            Id="OutlineEndStylePresent,1"\r\n                            Command="{1}"\r\n                            Image16by16="{11}"\r\n                            Image16by16Class="pegal_ArrowStyle1_16x16x32"\r\n                            LabelText="{4}"/>\r\n                         <Button\r\n                            Id="OutlineEndStylePresent,2"\r\n                            Command="{1}"\r\n                            Image16by16="{11}"\r\n                            Image16by16Class="pegal_ArrowStyle2_16x16x32"\r\n                            LabelText="{5}"/>\r\n                         <Button\r\n                            Id="OutlineEndStylePresent,3"\r\n                            Command="{1}"\r\n                            Image16by16="{11}"\r\n                            Image16by16Class="pegal_ArrowStyle3_16x16x32"\r\n                            LabelText="{6}"/>\r\n                         <Button\r\n                            Id="OutlineEndStylePresent,4"\r\n                            Command="{1}"\r\n                            Image16by16="{11}"\r\n                            Image16by16Class="pegal_ArrowStyle4_16x16x32"\r\n                            LabelText="{7}"/>\r\n                         <Button\r\n                            Id="OutlineEndStylePresent,5"\r\n                            Command="{1}"\r\n                            Image16by16="{11}"\r\n                            Image16by16Class="pegal_ArrowStyle5_16x16x32"\r\n                            LabelText="{8}"/>\r\n                         <Button\r\n                            Id="OutlineEndStylePresent,6"\r\n                            Command="{1}"\r\n                            Image16by16="{11}"\r\n                            Image16by16Class="pegal_ArrowStyle6_16x16x32"\r\n                            LabelText="{9}"/>\r\n                         <Button\r\n                            Id="OutlineEndStylePresent,7"\r\n                            Command="{1}"\r\n                            Image16by16="{11}"\r\n                            Image16by16Class="pegal_ArrowStyle7_16x16x32"\r\n                            LabelText="{10}"/>\r\n                         </Controls>\r\n                      </MenuSection>\r\n                   </Menu>\r\n                </FlyoutAnchor>',
M.a.PGc,M.a.sia,u.AFrameworkApplication.qm,ResourceStrings.L_ApplyShapeOutlineEndStyle,ResourceStrings.L_ApplyShapeOutlineEndStyle_1,ResourceStrings.L_ApplyShapeOutlineEndStyle_2,ResourceStrings.L_ApplyShapeOutlineEndStyle_3,ResourceStrings.L_ApplyShapeOutlineEndStyle_4,ResourceStrings.L_ApplyShapeOutlineEndStyle_5,ResourceStrings.L_ApplyShapeOutlineEndStyle_6,ResourceStrings.L_ApplyShapeOutlineEndStyle_7,y,CommonUIStrings.l_ApplyShapeOutlineEndStyleKeytip)),ja.append("</Controls></MenuSection>");
ja.append(fi.Lzf);m.PopulationXML=ja.toString()}else{y=G?"ThemeGraphicOutlineColorPicker":"ThemeShapeOutlineColorPicker";ja=G?"StandardGraphicOutlineColorPicker":"StandardShapeOutlineColorPicker";const va=G?"GraphicNoOutline":"ShapeNoOutline";G=Object.assign(new Mk.a,{Id:"PptRibbon.Drawing.ShapeOutline",MenuSectionList:[]});Array.add(G.MenuSectionList,Uk.f(c.Ne,"Theme Colors","Color.Menu.Controls","themeColor",y,b.toString(),1));Array.add(G.MenuSectionList,Uk.d("Standard Colors","standardColor","Standard Colors",
ja,b.toString(),!1));a&&0<a.length?(appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("ShapeOutlineRecentColors",!1)),Array.add(G.MenuSectionList,Uk.c(a,"Recent Colors","Color.Menu.Controls","recentColor","ShapeOutlineRecentColors","1244537109",!1))):appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("ShapeOutlineRecentColors",!0));Array.add(G.MenuSectionList,Uk.b("Remove Color","Color.Menu.Controls",h.toString(),ResourceStrings.L_RemoveShapeOutline,"Color.Menu.RemoveColor",
va,"per_AppointmentColor0_16x16x32",CommonUIStrings.l_RemoveShapeOutlineKeytip));Array.add(G.MenuSectionList,Uk.a("More Outline Color","Color.Menu.Controls",U.toString(),ResourceStrings.L_MoreOutlineColors,"Color.Menu.MoreOutlineColor","MoreOutlineColors","per_AppointmentColor0_16x16x32",CommonUIStrings.l_MoreOutlineColorsKeytip));Rd.a("ColorPickerHighlighterFix")&&(a=this.Sgj(c.Ne),Uk.h(G,a,c.Ne));m.MenuItems=G}return 32}ftj(a,b,c,h,m){if(!m)return Ba.a.J(512500374,815,10,"HandlePreviewShapeFillColor: action data cannot be null."),
8;if(!this.la.Clc)return 2;b=this.pa.sg();const y=this.i9a(b,this.FX);return y&&y.length?this.pdb&&1===y.length&&y[0].ud?(Ba.a.J(512500372,815,50,"HandlePreviewShapeFillColor: Preview for table shapes to be handled separately."),32):zg.a("HandlePreviewShapeFillColor:",a,()=>{const G=this.pa.YO(y),U=this.bJ.oV(m),ja=Object.assign(new hN.a,{});ja.solidFillField=U;for(const va of G)va?va.ud||(this.uec.Hb(va.get_shapeId())?this.uec.$(va.get_shapeId(),va.fill):this.uec.add(va.get_shapeId(),va.fill),va.fill=
ja,va.Ifa=null):Ba.a.J(512500371,822,50,"HandlePreviewShapeFillColor, shape with shape id : {0} is null",va.get_shapeId());return 32}):(Ba.a.J(512500373,815,50,"HandlePreviewShapeFillColor: No shape is selected to show preview color."),16)}muj(a,b,c,h,m){if(!m)return Ba.a.J(512500370,815,10,"HandleRevertPreviewShapeFillColor: action data cannot be null."),8;if(!this.la.Clc)return 2;a=this.pa.sg();a=this.i9a(a,this.FX);if(!a||!a.length)return Ba.a.J(512500369,815,50,"HandleRevertPreviewShapeFillColor: No shape is selected to show preview color."),
16;if(this.pdb&&1===a.length&&a[0].ud)return Ba.a.J(512500368,815,50,"HandleRevertPreviewShapeFillColor: Preview for table shapes to be handled separately."),32;a=this.pa.YO(a);for(const y of a)if(!y)Ba.a.J(512500367,822,50,"HandleRevertPreviewShapeFillColor, shape with shape id : {0} is null",y.get_shapeId());else if(!y.ud)if(this.uec.Hb(y.get_shapeId()))y.fill=this.uec.ga(y.get_shapeId()),y.Ifa=null;else return Ba.a.J(512500366,815,10,"HandleRevertPreviewShapeFillColor: last applied shape fill color cannot be empty."),
8;return 32}J7f(a,b,c,h,m){var y=this.ua.presentation;if(!y)throw Error.argumentNull("Presentation is null");h=this.pa.sg();b=this.i9a(h,this.FX);const G={type:"ColorPickerPayload",color:""};m&&(G.color=m.Color);if(!(b&&0<b.length||this.pa.xL()&&this.gkg(h[0],a,G))||this.fc.qC(b))return 16;const U=this.pa.Jp();y=U?y.lC(U.slideId):null;if(!y||!y.Ne||!y.Ne.PresetSchemeColorMapping)return 16;if(1===c)return 32;if(!m)return 8;if(this.pdb&&1===b.length&&b[0].ud)return Ba.a.J(512500364,815,50,"HandleApplyShapeFillColor: send PowerPointCellShadingColor"),
this.ia.La(M.a.y5,c,m);c=fi.Yfd(m);if(!c)return 8;1<h.length?Ba.a.J(512500362,815,50,"HandleApplyShapeFillColor: Apply shape fill color on {0} selected shapes.",h.length):Ba.a.J(512500361,815,50,"HandleApplyShapeFillColor: Apply shape fill color on one selected shape.");for(var ja of h)if(ja.Jf||ja.Kg){gn(ja);break}if(this.pa.xL()&&this.gkg(h[0],a,G)&&this.J$d(h[0],a,G))return 32;ja=this.Jb.zd(15,void 0,()=>{this.pa.ij();this.Fa.Ed()});try{ja.nc(b[0]);ja.jd=a;const va=this.bJ.oV(m),Ta=this.pa.YO(b);
for(const fb of Ta)if(fb.ud){if(!this.pdb)continue;Ba.a.J(512500360,815,50,"HandleApplyShapeFillColor: Process table");const Db=this.yc.FN(fb);if(!Db){Ba.a.J(512500359,815,10,"HandleApplyShapeFillColor: Table Node from shape is null");continue}const gc=Db.M9a();for(const hc of gc){const Gc=hc.cellShading;To.b(Gc);Gc.solidFillField=va;hc.cellShading=Gc}}else{const Db=this.xQf(fb);Db&&(this.bJ.sRa(Db),Db.solidFillField=va,fb.fill=Db,fb.Ifa=null,this.VGh(fb,Db));fb.woa=JSON.stringify(c);this.LKb(fb)}}finally{ja&&
ja.dispose()}return 32}Wrj(a,b,c,h,m){if(1===c)return this.ia.La(M.a.renderColorPicker,1,m);a=this.Rgj();b={};b.currentColor=a;b.handleCommand=M.a.MGc;return this.ia.La(M.a.renderColorPicker,2,b)}apj(a,b,c,h,m){if(1===c)return this.ia.La(M.a.KBa,c,m);if(!m)return Ba.a.J(512500358,815,10,"HandleApplyShapeFillCustomColor: actionData is null"),16;a=this.ia.La(M.a.KBa,c,m);32===a&&this.ia.La(M.a.zBa,c,m);return a}asj(a,b,c,h,m){a=this.pa.sg();a=Rd.a("FixColorPickerPictureBorderColor")?this.gwb(a,this.FX):
this.i9a(a,this.FX);a=this.pa.YO(a);if(1===c)return this.ia.La(M.a.renderColorPicker,1,m);c=null;1===a.length&&a[0].Aua&&(c=Uf.Box4ColorHelper.Usa(a[0].Aua));m={};m.currentColor=c;m.handleCommand=M.a.NGc;return this.ia.La(M.a.renderColorPicker,2,m)}O8f(a,b,c,h,m){h=this.pa.sg();b=this.i9a(h,this.FX);const y=!!b&&0<b.length;if(this.fc.qC(b))return 16;if(1===c)return y?32:8;if(!y)return 16;1<h.length?Ba.a.J(512500357,815,50,"HandleRemoveShapeFill: Remove shape fill on {0} selected shapes.",h.length):
Ba.a.J(512500356,815,50,"HandleRemoveShapeFill: Remove shape fill on one selected shape.");if(this.pdb&&1===b.length&&b[0].ud)return Ba.a.J(512500355,815,50,"HandleRemoveShapeFill: send PowerPointRemoveCellShading"),this.ia.La(M.a.xJa,c,m);c=this.Jb.zd(15,void 0,()=>{this.pa.ij();this.Fa.Ed()});try{c.nc(b[0]);c.jd=a;const G=this.pa.YO(b);for(const U of G)if(U.ud){if(!this.pdb)continue;Ba.a.J(512500354,815,50,"HandleRemoveShapeFill: Process table");const ja=this.yc.FN(U);if(!ja){Ba.a.J(512500353,815,
10,"HandleRemoveShapeFill: Table Node from shape is null");continue}const va=ja.M9a();for(const Ta of va){const fb=Ta.cellShading;To.b(fb);fb.noFillField=new Ux;Ta.cellShading=fb}}else{const ja=this.xQf(U);ja&&(this.bJ.sRa(ja),ja.noFillField=new Ux,U.fill=ja,U.Ifa=null,this.VGh(U,ja));U.ORk();this.LKb(U)}}finally{c&&c.dispose()}return 32}K7f(a,b,c,h,m){var y=this.ua.presentation;if(!y)throw Error.argumentNull("Presentation is null");h=this.pa.sg();b=this.gwb(h,this.FX);if(!(b&&0<b.length)||this.fc.qC(b))return 16;
const G=this.pa.Jp();y=G?y.lC(G.slideId):null;if(!y||!y.Ne||!y.Ne.PresetSchemeColorMapping)return 16;if(1===c)return 32;if(!m)return 8;c=fi.Yfd(m);if(!c)return 8;1<h.length?Ba.a.J(512500322,815,50,"HandleApplyShapeOutlineColor: Apply shape outline color on {0} selected shapes.",h.length):Ba.a.J(512500321,815,50,"HandleApplyShapeOutlineColor: Apply shape outline color on one selected shape.");for(var U of h)if(U.Jf||U.Kg){gn(U);break}U=this.Jb.zd(15,void 0,()=>{this.pa.ij();this.Fa.Ed()});try{U.nc(b[0]);
U.jd=a;const ja=this.pa.YO(b);for(const va of ja){const Ta=this.m0d(va);if(Ta){this.bJ.sRa(Ta);const fb=this.bJ.oV(m);Ta.solidFillField=fb;va.lineStyle=Ta;va.Aua=null;this.Htd(va,Ta)}va.sya=JSON.stringify(c);this.LKb(va)}}finally{U&&U.dispose()}return 32}bpj(a,b,c,h,m){if(1===c)return this.ia.La(M.a.ria,c,m);if(!m)return Ba.a.J(512500320,815,10,"HandleApplyShapeOutlineCustomColor: actionData is null"),16;a=this.ia.La(M.a.ria,c,m);32===a&&this.ia.La(M.a.zBa,c,m);return a}fpj(a,b,c,h,m){h=this.pa.sg();
b=this.gwb(h,this.FX);if(!(b&&0<b.length)||this.fc.qC(b))return 16;if(1===c)return 32;if(!m)return 8;c=this.QTc(m[m.MenuItemId?"MenuItemId":"SourceControlId"]);c=parseInt(c)-1;if(c>=fi.zmh.length||0>c)return 8;1<h.length?Ba.a.J(512500317,815,50,"HandleApplyShapeOutlineWidth: Apply shape outline width on {0} selected shapes.",h.length):Ba.a.J(512500316,815,50,"HandleApplyShapeOutlineWidth: Apply shape outline width on one selected shape.");m=this.Jb.zd(15,void 0,()=>{this.pa.ij();this.Fa.Ed()});try{m.nc(b[0]);
m.jd=a;const y=this.pa.YO(b);for(const G of y){const U=this.m0d(G);U&&(U.wField=fi.d0k[c],U.wFieldSpecified=!0,this.Htd(G,U),this.oQf(U),G.lineStyle=U);G.outlineWidth=fi.zmh[c];this.LKb(G)}}finally{m&&m.dispose()}return 32}LKb(a){this.Ea.wL(a)&&Nc.a.Ib&&(Nc.a.Ib.Nj=!0)}xQf(a){if(!this.GCg)return null;let b=a.fill;b||!a.wL&&!a.get_isSVGBlipFilled()||(b=new hN.a);return b}m0d(a){var b=this.ua.presentation;if(!b)throw Error.argumentNull("Presentation is null");if(!this.GCg)return null;let c=a.lineStyle;
if(this.Hve&&a.PZc()&&c&&c.wFieldSpecified){b=Object(ua.a)(116,b.lC(a.slideId));var h=this.gj.EG;b&&b.Ow&&null!=b.Ow.Wr&&(h=b.Ow.Wr);b=c.wField/h;h=this.A5b(a);if(!h||!h.IPa||!h.eHc)return c.wField=b,c;var m;(m=h.Ok&&h.Ok.fH&&h.Ok.fH.qL()&&1===h.Ok.fH.xa.childNodes.length?h.Ok.fH.xa.childNodes[0].getAttribute("width"):h.IPa.getAttribute("width"))&&!ta.a.Wa(m.toString())&&(m=parseFloat(m.toString()),isNaN(m)||(h=Math.sqrt(m*m/(h.kgi*h.eHc)),1E-6<h&&(b/=h)));c.wField=b}c||!a.wL&&!a.get_isSVGBlipFilled()||
(c=new TQ.a);return c}oQf(a){if(a.noFillField||To.e(a))a.noFillField=null,a.solidFillField=Object.assign(new Mu.a,{schemeClrField:Object.assign(new nn.a,{valField:1})})}cpj(a,b,c,h,m){h=this.pa.sg();b=this.gwb(h,this.FX);if(!(b&&0<b.length)||this.fc.qC(b))return 16;if(1===c)return 32;if(!m)return 8;c=this.QTc(m[m.MenuItemId?"MenuItemId":"SourceControlId"]);c=parseInt(c)-1;if(0>c)return 8;1<h.length?Ba.a.J(512500313,815,50,"HandleApplyShapeOutlineWidth: Apply shape outline dash style on {0} selected shapes.",
h.length):Ba.a.J(512500312,815,50,"HandleApplyShapeOutlineWidth: Apply shape outline dash style on one selected shape.");m=this.Jb.zd(15,void 0,()=>{this.pa.ij();this.Fa.Ed()});try{m.nc(b[0]);m.jd=a;const y=this.pa.YO(b);for(const G of y){const U=this.m0d(G);U&&(U.prstDashField=U.prstDashField||new UQ.a,U.prstDashField.valField=this.zej(c),U.prstDashField.valFieldSpecified=!0,U.custDashField=null,this.Htd(G,U),this.oQf(U),G.lineStyle=U);G.QO=c;this.LKb(G)}}finally{m&&m.dispose()}return 32}zej(a){switch(a){case 0:return 0;
case 1:return 8;case 3:return 2;default:return 0}}dpj(a,b,c,h,m){h=this.pa.sg();b=fi.raj(h);if(!(b&&0<b.length)||this.fc.qC(b))return 16;if(1===c)return 32;if(!m)return 8;c=this.QTc(m[m.MenuItemId?"MenuItemId":"SourceControlId"]);m=parseInt(c)-1;if(0>m||m>=fi.mmh.length)return 8;c=fi.mmh[m];m=fi.$_k[m];1<h.length?Ba.a.J(512500308,815,50,"HandleApplyShapeOutlineEndStyle: Apply shape outline end style on {0} selected shapes.",h.length):Ba.a.J(512500307,815,50,"HandleApplyShapeOutlineEndStyle: Apply shape outline end style on one selected shapes.");
h=this.Jb.zd(15,void 0,()=>{this.pa.ij();this.Fa.Ed()});try{h.nc(b[0]);h.jd=a;const y=this.pa.YO(Array.isArray(b)?b:null);for(const G of y)G.o9k(c,m)}finally{h&&h.dispose()}return 32}P8f(a,b,c){const h=this.pa.sg();b=this.gwb(h,this.FX);if(!(b&&0<b.length)||this.fc.qC(b))return 16;if(1===c)return 32;1<h.length?Ba.a.J(512500306,815,50,"HandleRemoveShapeOutline: Remove shape outline on {0} selected shapes.",h.length):Ba.a.J(512500305,815,50,"HandleRemoveShapeOutline: Remove shape outline on one selected shape.");
c=this.Jb.zd(15,void 0,()=>{this.pa.ij();this.Fa.Ed()});try{c.nc(b[0]);c.jd=a;const m=this.pa.YO(b);for(const y of m){const G=y.lineStyle;G&&(this.bJ.sRa(G),G.noFillField=new Ux,y.lineStyle=G,y.Aua=null,this.Htd(y,G));y.sSk();this.LKb(y)}}finally{c&&c.dispose()}return 32}epj(a,b,c,h,m){h=this.pa.sg();b=this.gwb(h,this.FX);if(!(b&&0<b.length)||fi.m2k(h))return 8;if(this.fc.qC(b))return 16;if(1===c)return 32;if(!m)return Ba.a.J(512500304,815,50,"HandleApplyShapeOutlineSketchStyle requires actionData"),
8;c=this.QTc(m[m.MenuItemId?"MenuItemId":"SourceControlId"]);c=parseInt(c)-1;if(0>c)return Ba.a.J(512500303,815,50,"Invalid outline sketch style ",c),8;1<h.length?Ba.a.J(512500301,815,50,"HandleApplyShapeOutlineWidth: Apply shape outline sketch style on {0} selected shapes.",h.length):Ba.a.J(512500300,815,50,"HandleApplyShapeOutlineWidth: Apply shape outline sketch style on one selected shape.");m=this.Jb.zd(15,void 0,()=>{this.pa.ij();this.Fa.Ed()});try{m.nc(b[0]);m.jd=a;for(const y of b)y.ikc=c,
y.setValue(X.a.g$b,!0)}finally{m&&m.dispose()}return 32}nvj(a,b,c){b=this.pa.sg();a=this.pa.Jp();if(!(this.HC.isActive||1===b.length&&a&&a.Kyh||this.Sp&&this.pa.Hka()))return 16;if(1===c)return 32;if(this.fc.$c(a))return 16;c=32;if(this.HC.isActive)this.HC.XPa();else if(this.Sp)if(this.RQ.oL)this.RQ.oL=!1;else{b=this.pa.Pa.mb;var h=null;if(b&&(h=b.Ua)&&(h.contextId===xb.a.Of||h.contextId===xb.a.textRange||h.contextId===xb.a.endOfParagraph||h.contextId===xb.a.paragraph))c=this.ia.processAction(D.a.PPc,
2);else if(a.ud&&this.pa.F_(this.pa.Pa)){if(b=a.CTc())if(b=b.qf(0,0)){b.p6k(this.RQ);var m=b.A3b;h=-1;m&&(h=Ob.ParagraphReader.textLength(Object(ua.a)($f.a,m))+1);if(m=this.Vb.yi){const y=this.Jb.le(4),G=m.zi;y.nc(m);const U=this.lU.YDa(G),ja=Object(ua.a)(116,this.Tte.A4f(b));this.lU.f3e(U,!0,!1,ja,a,b,null,0,h);(a=G.Wlc(U))&&m.nAb(a);y.dispose()}}}else this.HC.d$g(a)}else this.HC.d$g(a);Fc.App.Kb.updateCommandUI();return c}Soj(a,b,c){return this.Sp&&(a=this.pa.Pa.mb)&&(a=a.Ua)&&(a.contextId===xb.a.Of||
a.contextId===xb.a.textRange||a.contextId===xb.a.endOfParagraph||a.contextId===xb.a.paragraph)?(this.HC.XPa(),this.ia.processAction(M.a.o3d,2)):(a=this.pa.Jp())?this.ia.La(M.a.n3d,c,new eA(this.HC.Wol,a)):16}Toj(a,b,c,h,m){if(!m||!Object(za.a)(eA,m))return Ba.a.J(512500299,822,10,"Invalid ActionData. Type: {0}",m?Object.getType(m).getName():"null"),8;if(this.Sp&&this.RQ.oL)return this.RQ.oL=!1,16;b=m.Xrc;if(!(this.HC.isActive&&b&&b.Jyh))return this.HC.XPa(),16;if(this.fc.$c(b))return 16;if(1===c)return 32;
Nc.a.Ib&&(Nc.a.Ib.Nj=!1,Nc.a.Ib.actionName="FormatPainterApplyToShape",Nc.a.Ib.Qr=!0);c=this.Jb.zd(15,void 0,()=>{this.pa.ij();this.Fa.Ed()});try{c.nc(m.Xrc),c.jd=a,m.Xrc.mvb=m.Xol.id}finally{c&&c.dispose()}this.HC.XPa();return 32}ptj(a,b,c,h,m){if(!m||!Object(za.a)(Ph.a,m))return 8;m.Qf(this.HC.isActive||(this.Sp?this.RQ.oL:!1));return 32}bHk(a,b,c){return(a=this.A5b(a))&&Object(za.a)(Ps.a,a.Ok)&&(a=Object(ua.a)(Ps.a,a.Ok))?a.xLe(M.a.Qz(b),c):!1}J$d(a,b,c){return(a=this.A5b(a))&&Object(za.a)(Ps.a,
a.Ok)&&(a=Object(ua.a)(Ps.a,a.Ok))?a.ugd(M.a.Qz(b),c):!1}QTc(a){return a.split(",")[1]}VGh(a,b){if(this.Hve&&a.PZc()){var c=this.A5b(a),h=this.BGf(c,a);a=b.noFillField?null:this.LJ(b,a);h=this.dfb.mvl(h,a);this.zuf(c,h)}}Htd(a,b){var c=this.ua.presentation;if(!c)throw Error.argumentNull("Presentation is null");if(this.Hve&&a.PZc()){var h=this.A5b(a),m=this.BGf(h,a);if(null!==m){if(b.noFillField)m=this.dfb.cEh(m);else{if(b.wFieldSpecified){var y=Object(ua.a)(116,c.lC(a.slideId)),G=this.gj.EG;y&&y.Ow&&
null!=y.Ow.Wr&&(G=y.Ow.Wr);m=this.dfb.dEh(m,b.wField,h.vd,G)}b.prstDashField&&b.prstDashField.valFieldSpecified&&(m=this.dfb.nvl(m,b.prstDashField.valField));if(b.solidFillField){b=this.LJ(b,a);m=this.dfb.cEh(m,b);if(!m)return;b=m.querySelectorAll(this.dfb.pZe);y=!0;for(G=0;G<b.length;++G){const U=b[G].getAttribute("stroke-width");if(U&&!ta.a.Wa(U.toString())){y=!1;break}}y&&(a=Object(ua.a)(116,c.lC(a.slideId)),c=this.gj.EG,a&&a.Ow&&null!=a.Ow.Wr&&(c=a.Ow.Wr),m=this.dfb.dEh(m,te.a.dJe/this.XIe,h.vd,
c))}}this.zuf(h,m)}}}LJ(a,b){const c=this.ua.presentation;if(!c)throw Error.argumentNull("Presentation is null");b=c.lC(b.slideId);return this.bJ.OJb(a,b.Ne)}zuf(a,b){if(b&&a&&a.Ok){a.Ok.NZ.Pd(!1);var c=a.Ok.fH.xa.childNodes;for(let h=0;h<c.length;++h)a.Ok.fH.xa.removeChild(c[h]);a.Ok.fH.xa.appendChild(b);(b=a.IPa.getAttribute("transform"))&&a.Ok.fH.xa.setAttribute("transform",b.toString());a.Ok.fH.Pd(!0);Nc.a.Ib&&(Nc.a.Ib.Nj=!0,Nc.a.Ib.pF=new Date)}}gkg(a,b,c){return Rd.a("EnableSmartArtFillColor")&&
this.bHk(a,b,c)}Rgj(){var a=this.pa.sg();a=this.i9a(a,this.FX);var b=this.pa.YO(a),c=null;a=null;Rd.a("FixColorPickerSelectedColor")&&(a=this.ua.Ba);if(1===b.length){if(b[0].Ifa)c=Uf.Box4ColorHelper.Usa(b[0].Ifa);else if(b[0].ud&&Rd.a("FixColorPickerSelectedColor")){const h=this.pa.rv();if(!h||!h.length){if(b=this.pa.Ym())b=b.qf(0,0),c=Uf.Box4ColorHelper.DDa(b.cellShading.solidFillField,a.Ne);return c}c=h[0];c=c.cellShading&&c.cellShading.solidFillField&&a?Uf.Box4ColorHelper.DDa(c.cellShading.solidFillField,
a.Ne):this.jA.IQc(Object(ua.a)($f.a,c))}!c&&Rd.a("FixColorPickerSelectedColor")&&b[0].fill&&b[0].fill.solidFillField&&(c=Uf.Box4ColorHelper.DDa(b[0].fill.solidFillField,a.Ne))}return c}Pql(a){var b=this.ua.Ba;if(!b)throw Error.argumentNull("ActiveSlide is null");b=b.kC(a).isHiddenShape;this.q9k(a,b)}Oql(a,b){a.isHiddenShape=!b;const c=Object(ua.a)(117,a.sc(this.mz));b?c.PLa():(c.gka(),this.pa.cX(a)&&this.pa.Z7(a))}q9k(a,b){const c=this.Jb.zd(15,void 0,()=>{this.pa.ij()});try{const h=this.ua.Ba;if(!h)throw Error.argumentNull("ActiveSlide is null");
const m=h.kC(a);c.nc(m);this.Oql(m,b)}finally{c&&c.dispose()}}n9k(a,b){const c=this.Jb.zd(15,void 0,()=>{this.pa.ij()});try{const h=this.ua.Ba;if(!h)throw Error.argumentNull("ActiveSlide is null");const m=h.kC(a);c.nc(m);m.shapeName=b}finally{c&&c.dispose()}}Pgj(){var a=this.pa.sg();a=this.i9a(a,this.FX);return this.pa.YO(a)}Tgj(a){const b=this.Pgj();return b&&1===b.length?b[0].ud?this.jA.nYf(this.pa.rv()):b[0].fill&&b[0].fill.solidFillField?Uf.Box4ColorHelper.DDa(b[0].fill.solidFillField,a):null:
null}Sgj(a){const b=this.pa.sg();return b&&1===b.length&&b[0].lineStyle&&b[0].lineStyle.solidFillField?Uf.Box4ColorHelper.DDa(b[0].lineStyle.solidFillField,a):null}A5b(a){return a?Object(ua.a)(117,a.sc(this.mz)):null}BGf(a,b){try{if(!(a&&a.IPa&&a.Ok&&a.Ok.fH))return null;if(a.Ok.fH.qL()){if(!a.Ok.fH.xa)return null;const m=a.Ok.fH.xa.childNodes;for(a=0;a<m.length;++a)if("svg"===m[a].tagName.toLowerCase())return m[a];return null}if(!a.IPa.getAttribute(Gk.a.SVc))return null;let c=a.IPa.getAttribute(Gk.a.SVc).toString();
if(!c.toLowerCase().startsWith(this.Uml))return null;c=decodeURIComponent(c.substr(c.indexOf(",")+1));const h=this.$ve.sanitize(c);return h&&1===h.children.length?h.children[0]:(b.ATa=!0,null)}catch(c){return Ba.a.J(512500295,815,10,"ConvertSourceToDOMElement Unexpected exception when update svg domelement fill: {0}, stack: {1}",c.message,c.stack),null}}static vgj(a,b){const c=[];if(a)for(const h of a)b&&h.get_isSVGBlipFilled()&&Array.add(c,h);return c}static raj(a){if(!a)return null;const b=[];for(const c of a)c.Vy&&
Array.add(b,c);return b}static m2k(a){let b;for(let c=0;c<a.length;c++){if(!a[c])return!0;b=a[c].shapeType;if(127===b||121===b||124===b)return!0}return!1}static Yfd(a){return nu.a.parse(a.Color)}}fi.zmh=[.5,1,2.25,4.5];fi.d0k=[6350,12700,28575,57150];fi.mmh=[0,0,2,2,0,1,1];fi.$_k=[0,2,0,2,1,0,1];fi.Mzf='<Menu Id="{0}">';fi.Szf='<MenuSection Id="Remove Color"><Controls Id="Color.Menu.Controls">';fi.Qzf='<Button Id="Color.Menu.RemoveColor" Command="{0}" Image16by16="{1}" Image16by16Class="per_AppointmentColor0_16x16x32" LabelText="{2}" Keytip="{3}" />';
fi.Rzf="</Controls> </MenuSection>";fi.Uli='<MenuSection Id="More Fill Colors"><Controls Id="Color.Menu.Controls">';fi.Sli='<Button Id="Color.Menu.MoreFillColors" Command="{0}" Image16by16="{1}" Image16by16Class="per_MoreColors_16x16x32" LabelText="{2}" Keytip="{3}" />';fi.Tli="</Controls> </MenuSection>";fi.Xli='<MenuSection Id="More Outline Colors"><Controls Id="Color.Menu.Controls">';fi.Vli='<Button Id="Color.Menu.MoreOutlineColors" Command="{0}" Image16by16="{1}" Image16by16Class="per_MoreColors_16x16x32" LabelText="{2}" Keytip="{3}" />';
fi.Wli="</Controls> </MenuSection>";fi.Lzf="</Menu>";Object(n.a)(fi,"ShapesFormatActor",null,[227]);var Zi=d(228);class qi{constructor(a,b,c){this.f$c=Array(qi.jW);this.h7c=Array(qi.jW);this.Ene=Array(qi.jW);if(!a)throw Error.argumentNull("mainMasterResources");if(!b)throw Error.argumentNull("theme");if(!c)throw Error.argumentNull("resourceViewElementResolver");this.hJ=a;this.Bm=b;this.Pad=c;this.Tva={}}dispose(){Array.clear(this.f$c);Array.clear(this.h7c);this.Bm=this.hJ=null;const a=Da.a.fL(this.Tva);
a.length&&appChrome.api.unregisterIcons(a);this.Tva=null}get hj(){return this.hJ.MasterId}n5b(a,b,c){const h=Object.assign(new Mk.a,{Id:"PptRibbon.DrawingFormat.StylesMenu",MenuSectionList:[]});var m=Object.assign(new di.a,{Id:"MenuSectionShapeStyles",ControlsId:"MenuSectionShapeStyles.Controls",Title:"Quick Styles",DisplayMode:"Size48by48",ControlList:[]});Array.add(h.MenuSectionList,m);var y=c?"GraphicsStyleSection":"ApplyShapeStyleSection",G=c?"GraphicsStyleGallery":"ApplyShapeStyleGallery";y=
Object.assign(new qq.a,{Id:"ControlsShapeStyles",ExternalId:y,ExternalGalleryId:G,Type:4,Width:qi.jW,ElementDimensions:"Size48by48",GalleryItems:[]});Array.add(m.ControlList,y);m=qi.jW*(a?qi.jzf:qi.nzf);c&&(m=qi.jW*qi.mzf);for(G=0;G<m;++G){const U=c?"ApplyGraphicsStyle"+G:"ApplyShapeStyle"+G;Array.add(y.GalleryItems,c?this.I3d(U,G,a,b,!0):this.I3d(U,G,a,b,!1))}return h}I3d(a,b,c,h,m){if(m){var y=this.hJ?this.hJ.SVGStyles[b]:null;c="SVGStyle";y=y?y.ToolTip:""}else y=this.hJ?this.hJ.ShapeStyles[b]:
null,c=c?"LineStyle":"ShapeStyle",y=y?this.J8d(y.StyleId):"";return Object.assign(new ZD.a,{Id:a,ExternalId:a,Icon:qi.o5b(c,h,b),PreviewIconStyle:qi.Bej(),Command:m?"2748140308":"1963674920",QueryCommand:m?"1903137544":"2375118752",Alt:y})}Kjd(a){this.addIconToMap(this.hJ.ShapeStyles,"ShapeStyle");this.addIconToMap(this.hJ.LineStyles,"LineStyle");a&&this.addIconToMap(this.hJ.SVGStyles,"SVGStyle");appChrome.api.registerIconProvider(()=>this.Tva)}Ahj(a){if(a<qi.jW&&this.f$c[a])return this.f$c[a];if(a>=
this.hJ.ShapeStyles.length)return"";var b=this.hJ.ShapeStyles[a];const c=String.format("width:{0}px; height:{1}px; position:relative; overflow:hidden; display:inline-block;",b.Icon.Clip.Bounds.Right-b.Icon.Clip.Bounds.Left,b.Icon.Clip.Bounds.Bottom-b.Icon.Clip.Bounds.Top),h=String.format("position:absolute; top:{0}px; left:{1}px;",-1*b.Icon.Clip.Bounds.Top,-1*b.Icon.Clip.Bounds.Left),m=this.J8d(b.StyleId);b=String.format('<Span Style="{0}"><Img Src="{1}" Alt="{2}" Style="{3}"></Span>',c,this.o5d(this.Pad.resolve(ca.a.oub,
b.Icon.ImgId,"StyleGallery")),m,h);a<qi.jW&&(this.f$c[a]=b);return b}tgj(a){if(a<qi.jW&&this.Ene[a])return this.Ene[a];if(a>=this.hJ.SVGStyles.length)return"";var b=this.hJ.SVGStyles[a];const c=String.format("width:{0}px; height:{1}px; position:relative; overflow:hidden; display:inline-block;",b.Icon.Clip.Bounds.Right-b.Icon.Clip.Bounds.Left,b.Icon.Clip.Bounds.Bottom-b.Icon.Clip.Bounds.Top),h=String.format("position:absolute; top:{0}px; left:{1}px;",-1*b.Icon.Clip.Bounds.Top,-1*b.Icon.Clip.Bounds.Left),
m=this.L3f(b.StyleId);b=String.format('<Span Style="{0}"><Img Src="{1}" Alt="{2}" Style="{3}"></Span>',c,this.o5d(this.Pad.resolve(ca.a.oub,b.Icon.ImgId,"StyleGallery")),m,h);a<qi.jW&&(this.Ene[a]=b);return b}paj(a){if(a<qi.jW&&this.h7c[a])return this.h7c[a];if(a>=this.hJ.LineStyles.length)return"";var b=this.hJ.LineStyles[a];const c=String.format("width:{0}px; height:{1}px; position:relative; overflow:hidden; display:inline-block;",b.Icon.Clip.Bounds.Right-b.Icon.Clip.Bounds.Left,b.Icon.Clip.Bounds.Bottom-
b.Icon.Clip.Bounds.Top),h=String.format("position:absolute; top:{0}px; left:{1}px;",-1*b.Icon.Clip.Bounds.Top,-1*b.Icon.Clip.Bounds.Left),m=this.e1f(b.StyleId);b=String.format('<Span Style="{0}"><Img Src="{1}" Alt="{2}" Style="{3}"></Span>',c,this.o5d(this.Pad.resolve(ca.a.oub,b.Icon.ImgId,"StyleGallery")),m,h);a<qi.jW&&(this.h7c[a]=b);return b}J8d(a){let b=null;switch(parseInt(String(a/qi.jW))){case 0:b=ResourceStrings.l_ShapeStyleColoredOutline;break;case 1:b=ResourceStrings.l_ShapeStyleColoredFill;
break;case 2:b=ResourceStrings.l_ShapeStyleLightOutlineColoredFill;break;case 3:b=ResourceStrings.l_ShapeStyleSubtleEffect;break;case 4:b=ResourceStrings.l_ShapeStyleModerateEffect;break;case 5:b=ResourceStrings.l_ShapeStyleIntenseEffect}let c;({color:a,YAh:c}=this.JYf(a));return String.format(b,a.toString(),c)}L3f(a){return(a=this.hJ?this.hJ.SVGStyles[a]:null)?a.ToolTip:""}e1f(a){let b=null;switch(parseInt(String(a/qi.jW))){case 0:b=ResourceStrings.l_LineStyleSubtleEffect;break;case 1:b=ResourceStrings.l_LineStyleModerateEffect;
break;case 2:b=ResourceStrings.l_LineStyleIntenseEffect}let c;({color:a,YAh:c}=this.JYf(a));return String.format(b,a.toString(),c)}o5d(a){return null===a?"":ta.a.v7b(a)}addIconToMap(a,b){for(let h=0;h<a.length;++h){var c=a[h];const m=qi.o5b(b,this.hj,h),y={},G={};G.top=String.format("-{0}px",c.Icon.Clip.Bounds.Top);G.left=String.format("-{0}px",c.Icon.Clip.Bounds.Left);G.position="absolute";y.root=G;c=appChrome.buildImageIconFromUrl(this.Pad.resolve(ca.a.oub,c.Icon.ImgId,"StyleGallery"),y);this.Tva[m]=
c}}JYf(a){let b,c;c=b=null;a%=qi.jW;switch(a){case 0:b=Zi.Color.Ti(this.Bm.Dark1);c=String.format(ResourceStrings.l_DarkFormat,1);break;case 1:b=Zi.Color.Ti(this.Bm.Accent1);c=String.format(ResourceStrings.L_AccentFormat,a);break;case 2:b=Zi.Color.Ti(this.Bm.Accent2);c=String.format(ResourceStrings.L_AccentFormat,a);break;case 3:b=Zi.Color.Ti(this.Bm.Accent3);c=String.format(ResourceStrings.L_AccentFormat,a);break;case 4:b=Zi.Color.Ti(this.Bm.Accent4);c=String.format(ResourceStrings.L_AccentFormat,
a);break;case 5:b=Zi.Color.Ti(this.Bm.Accent5);c=String.format(ResourceStrings.L_AccentFormat,a);break;case 6:b=Zi.Color.Ti(this.Bm.Accent6),c=String.format(ResourceStrings.L_AccentFormat,a)}return{color:b,YAh:c}}static get phi(){return qi.D_k}static get nhi(){return qi.B_k}static get ohi(){return qi.C_k}static Bej(){const a={},b=28/48,c=(28-28*b)/2,h={};h.width=String.format("{0}px",28);h.height=String.format("{0}px",28);h.transform=String.format("matrix({0},0,0,{1},-{2},-{3})",b,b,c,c);a.root=h;
return a}static m4d(a,b){const c=new Sys.StringBuilder;c.append('<Menu Id="PptRibbon.DrawingFormat.StylesMenu">');c.append('<MenuSection Id="MenuSectionShapeStyles"><Gallery Id="ControlsShapeStyles" ElementDimensions="Size48by48" Width="7">');a*=qi.jW;for(let h=0;h<a;++h)c.append(String.format('<GalleryButton Id="Style{0}" ElementDimensions="Size48by48" Command="{1}" QueryCommand="{2}" Alt="" InnerHTML=""/>',h,b?M.a.wYb:M.a.lrb,b?M.a.Nhd:M.a.xid));c.append("</Gallery> </MenuSection>");c.append("</Menu>");
return c.toString()}static o5b(a,b,c){return String.format("{0}_{1}_{2}",a,b,c)}}qi.jW=7;qi.nzf=6;qi.mzf=4;qi.jzf=3;qi.D_k=qi.m4d(qi.nzf,!1);qi.C_k=qi.m4d(qi.jzf,!1);qi.B_k=qi.m4d(qi.mzf,!0);Object(n.a)(qi,"StyleGalleryBuilder",null,[106]);class jN{constructor(a,b,c,h,m,y,G,U,ja,va,Ta,fb){this.IEb="";this.NBb=[];this.ia=a;this.jq=b;this.ff=c;this.Fa=m;this.Jb=h;this.Gu=y;this.bEb=G;this.pa=U;this.Ea=ja;this.Xa=va;this.FX=Ta;fb.WB(Object(F.a)(this,this.Bo,"onSessionRehydrated"));this.Xa.zsf(Object(F.a)(this,
this.Zed,"onSessionInfoChanged"))}vb(){this.ia.ra(M.a.xid,nc.a.application,Object(F.a)(this,this.stj,"handleQueryShapesStyle"),97);this.ia.ra(M.a.nJe,nc.a.application,Object(F.a)(this,this.atj,"handlePopulateShapesStyles"),96);this.ia.ra(M.a.lrb,nc.a.application,Object(F.a)(this,this.gpj,"handleApplyShapesStyle"),4);this.ia.ra(M.a.Nhd,nc.a.application,Object(F.a)(this,this.qtj,"handleQueryGraphicsStyle"),97);this.ia.ra(M.a.kJe,nc.a.application,Object(F.a)(this,this.Ysj,"handlePopulateGraphicsStyles"),
96);this.ia.ra(M.a.wYb,nc.a.application,Object(F.a)(this,this.Voj,"handleApplyGraphicsStyle"),4)}De(){}qtj(a,b,c,h,m){return this.tRf(m,!0)}stj(a,b,c,h,m){return this.tRf(m,!1)}tRf(a,b){var c=this.jq.presentation;if(!c)throw Error.argumentNull("Presentation is null");if(!a||!Object(za.a)(Kv,a))return 8;var h=a.XU.startsWith("Style")?"Style":b?"ApplyGraphicsStyle":"ApplyShapeStyle";h=parseInt(a.XU.substr(h.length));if(isNaN(h)||0>h)return Ba.a.J(509678939,822,10,"ExecuteQuery{0}Style: Invalid style id recieved from the gallery",
b?"Graphics":"Shapes"),8;var m=this.pa.sg();if(!m||!m.length)return 16;const y=a.zZa;if(!y)return 8;var G=c.lC(m[0].slideId);if(!G)return 16;c=G.hj;G=this.Z_f(G);a.XU.startsWith(b?"ApplyGraphicsStyle":"ApplyShapeStyle")?(this.IEb=(m=this.cYb(m))?"SGT_Line":"SGT_Shape",y.l3=G?G.I3d(a.XU,h,m,c,b?!0:!1):null):G?(this.cYb(m)?(this.IEb="SGT_Line",y.zDa=G.paj(h),y.wvb=G.e1f(h)):b?(this.IEb="SGT_SVG",y.zDa=G.tgj(h),y.wvb=G.L3f(h)):(this.IEb="SGT_Shape",y.zDa=G.Ahj(h),y.wvb=G.J8d(h)),y.UU(!1)):(y.zDa="",
y.wvb="");return 32}Ysj(a,b,c,h,m){return this.rRf(c,m,!0)}atj(a,b,c,h,m){return this.pa.ZTa()?8:this.rRf(c,m,!1)}rRf(a,b,c){var h=this.jq.presentation;if(!h)throw Error.argumentNull("Presentation is null");if(1===a)return 32;if(!b)return Ba.a.J(509678937,822,10,"ExecutePopulate{0}Styles - Invalid action data",c?"Graphics":"Shapes"),8;a=this.pa.sg();h=a[0]?h.lC(a[0].slideId):null;const m=this.Z_f(h);if(b.MenuId&&"style"===b.MenuId)this.cYb(a)?b.PopulationXML=qi.ohi:b.PopulationXML=c?qi.nhi:qi.phi;
else{this.IEb=(a=this.cYb(a))?"SGT_Line":"SGT_Shape";if(!h)return 16;b.MenuItems=m?m.n5b(a,h.hj,c?!0:!1):null}return 32}Voj(a,b,c,h,m){if(Rd.a("FixForPictureAndGraphicsStyleForGrpShapes")){if(0>=this.Ugj().length)return 8}else if(!this.Ea.zrc(this.pa.sg()))return 16;return this.L7f(a,c,m,!0)}Ugj(){var a=this.pa.Xd();const b=[];let c=!1;for(const h of a){if(!h)return b.length=0,b;h.Kg&&(c=!0)}if(c)for(const h of a)h.Kg&&this.Ea.zrc([h])&&b.push(h);else for(const h of a)if(this.Ea.zrc([h]))b.push(h);
else if(h.Jf){a=this.Ea.Yw(h);for(const m of a)this.Ea.zrc([m])&&b.push(m)}return b}gpj(a,b,c,h,m){return this.Nal(this.pa.sg())?this.L7f(a,c,m,!1):16}L7f(a,b,c,h){var m=this.jq.presentation;if(!m)throw Error.argumentNull("Presentation is null");const y=this.pa.sg();if(!y||!y.length||this.ff.qC(y))return 16;m=m.lC(y[0].slideId);var G=this.Gu.v1f(m);if(!G)return this.Gu.Qkl(m),Ba.a.J(509678936,822,15,"HandleApply{0}Style - MainMasterResources are missing",h?"Graphics":"Shapes"),8;if(1===b)return 32;
if(!c)return Ba.a.J(509678935,822,10,"HandleApply{0}Style - Invalid action data",h?"Graphics":"Shapes"),8;b=this.cYb(y)?G.LineStyles.length:G.ShapeStyles.length;G=c.startsWith("Style")?"Style":h?"ApplyGraphicsStyle":"ApplyShapeStyle";c=parseInt(c.substr(G.length));if(isNaN(c)||0>c||c>=b)return Ba.a.J(509678934,822,10,"HandleApply{0}Style - Invalid style id recieved from gallery",h?"Graphics":"Shapes"),16;1===y.length?Ba.a.J(509678933,815,50,"ShapesStyleActor::HandleApply{0}Style Applying style on only one {1}.",
h?"Graphics":"Shapes",h?"SVG":"Shape"):1<y.length&&Ba.a.J(509678932,815,50,"ShapesStyleActor::HandleApply{0}Style Applying style on {1} {2}.",h?"Graphics":"Shapes",y.length,h?"SVGs":"Shapes");h=this.Jb.zd(15,void 0,()=>{this.Fa.Ed();this.pa.ij()});try{h.nc(Object(ua.a)(116,m));h.jd=a;const U=this.pa.YO(Array.isArray(y)?y:null);for(const ja of U)ja&&ja.p9k(c,this.IEb)}finally{h&&h.dispose()}return 32}Zed(){for(const a of this.NBb)a.dispose();Array.clear(this.NBb)}Z_f(a){const b=this.Gu.v1f(a);if(!b||
!a)return Ba.a.J(509678931,815,15,"ShapesStyleActor::GetGalleryBuilderForCurrentSlide: MainMasterResource is null now!"),null;for(const c of this.NBb)if(c.hj===a.hj)return c;a=new qi(b,a.Ne,this.bEb);Array.add(this.NBb,a);a.Kjd(this.FX);return a}Nal(a){if(!a||!a.length||this.Ea.nGc(a))return!1;for(const b of a)if(b.eua)return!0;return!1}cYb(a){if(!a)return!1;for(const b of a)if(!b.Vy)return!1;return!0}Bo(){this.Xwa()}Xwa(){this.Gu.clearCache();for(const a of this.NBb)a.dispose();Array.clear(this.NBb)}}
Object(n.a)(jN,"ShapesStyleActor",null,[227,438]);class Ov{constructor(a,b,c,h,m,y,G,U,ja,va,Ta,fb){this.ux=this.Nm=-1;this.Hs=a;this.ia=b;this.Fa=c;this.ff=h;this.az=m;this.pa=y;this.ki=G;this.Ea=U;this.T7j=ja;this.Y7j=va;this.Pla=Ta;this.yc=fb}get Lb(){return this.pa}vb(){this.ia.ra(M.a.O_a,nc.a.application,Object(F.a)(this,this.dTa,"handleFontFormatAction"),4);this.ia.ra(M.a.P_a,nc.a.application,Object(F.a)(this,this.dTa,"handleFontFormatAction"),4);this.ia.ra(M.a.Q_a,nc.a.application,Object(F.a)(this,
this.dTa,"handleFontFormatAction"),4);this.ia.ra(M.a.Ypc,nc.a.application,Object(F.a)(this,this.dTa,"handleFontFormatAction"),4);this.ia.ra(M.a.ILb,nc.a.application,Object(F.a)(this,this.dTa,"handleFontFormatAction"),4);this.ia.ra(M.a.pLb,nc.a.application,Object(F.a)(this,this.dTa,"handleFontFormatAction"),4);this.ia.ra(M.a.mLb,nc.a.application,Object(F.a)(this,this.A6b,"handleFont"),5);this.ia.ra(M.a.vjb,nc.a.application,Object(F.a)(this,this.A6b,"handleFont"),5);this.ia.ra(M.a.wjb,nc.a.application,
Object(F.a)(this,this.A6b,"handleFont"),5);this.ia.ra(M.a.bVe,nc.a.application,Object(F.a)(this,this.Wsj,"handlePopulateFontNameDropdown"),97);this.ia.ra(M.a.Ijb,nc.a.application,Object(F.a)(this,this.A6b,"handleFont"),4);this.ia.ra(M.a.GLb,nc.a.application,Object(F.a)(this,this.A6b,"handleFont"),4);this.ia.ra(M.a.bqc,nc.a.application,Object(F.a)(this,this.dTa,"handleFontFormatAction"),4);this.ia.ra(M.a.aqc,nc.a.application,Object(F.a)(this,this.dTa,"handleFontFormatAction"),4);this.ia.ra(M.a.Cmc,
nc.a.application,Object(F.a)(this,this.fxb,"handleQueryFontToggleButton"),97);this.ia.ra(M.a.Dmc,nc.a.application,Object(F.a)(this,this.fxb,"handleQueryFontToggleButton"),97);this.ia.ra(M.a.Fmc,nc.a.application,Object(F.a)(this,this.fxb,"handleQueryFontToggleButton"),97);this.ia.ra(M.a.Emc,nc.a.application,Object(F.a)(this,this.fxb,"handleQueryFontToggleButton"),97);this.ia.ra(M.a.kid,nc.a.application,Object(F.a)(this,this.HUc,"handleQueryFont"),100);this.ia.ra(M.a.jid,nc.a.application,Object(F.a)(this,
this.HUc,"handleQueryFont"),100);this.ia.ra(M.a.lid,nc.a.application,Object(F.a)(this,this.HUc,"handleQueryFont"),97);this.ia.ra(M.a.nid,nc.a.application,Object(F.a)(this,this.HUc,"handleQueryFont"),97);this.ia.ra(M.a.zid,nc.a.application,Object(F.a)(this,this.fxb,"handleQueryFontToggleButton"),97);this.ia.ra(M.a.yid,nc.a.application,Object(F.a)(this,this.fxb,"handleQueryFontToggleButton"),97)}De(){const a=this.Fa.Gc(Ua.a.rg);a.bindAction(w.KeyInputManager.hw(ResourceStrings.l_HK_Bold),M.a.O_a);a.bindAction(w.KeyInputManager.hw(ResourceStrings.l_HK_Italic),
M.a.P_a);a.bindAction(w.KeyInputManager.hw(ResourceStrings.l_HK_Underline),M.a.Q_a);a.bindAction(w.KeyInputManager.Na(z.a.dMa,w.KeyInputManager.Le|4),M.a.Ypc);a.bindAction(w.KeyInputManager.Na(z.a.bud,w.KeyInputManager.Le|4),M.a.ILb)}HUc(a,b,c,h,m){c=this.Lb.sg();if(!c||1>c.length)return 16;h=this.Ea.n_(c);var y=this.Lb.Yja();if(1>h.length&&!y)return 16;b=null;this.Nm=Date.now();y&&(b=this.yc.$Yf(y,new $s),this.ux=Date.now(),Ba.a.J(512500294,815,50,"Query table shape font timespan by {0}",(this.ux-
this.Nm).toString()));c=y?[c[0]]:h;for(const G of c){switch(a){case M.a.kid:case M.a.jid:break;case M.a.lid:c=this.az.Y4b(G.ud&&b?b.fontName:G.mNb);if(m.WZ&&m.WZ!==c){m.WZ="";break}m.WZ=c;m.dpc();break;case M.a.nid:c="";G.ud&&b?-1!==b.fontSize&&(c=ta.a.OPc(b.fontSize/2,0,u.AFrameworkApplication.numberFormat)):c=G.zaa?Ov.YYf(G).toString():"";h=parseFloat(c);if(!isNaN(h)&&(y=m.WZ)&&y!==c){y=Math.min(h,parseFloat(y)).toString()+"+";m.WZ=y;break}m.WZ=c;m.dpc();break;default:return Ba.a.J(512500293,820,
10,"Unexpected actionId for HandleQueryFont"),8}if(m&&m.WZ&&!m.WZ.length)break}return 32}fxb(a,b,c,h,m){b=this.Lb.sg();if(!b||1>b.length)return 16;b=this.Ea.n_(b);c=this.Lb.Yja();if(1>b.length&&!c)return 16;a=c?this.UHk(c,a,new $s):this.bdh(b,a);m.Qf("select"===a);return"disable"!==a?32:8}A6b(a,b,c,h,m){b=this.Lb.sg();if(!b||1>b.length)return 16;const y=this.Lb.Yja();h=this.Ea.n_(b);if(1>h.length&&!y||this.ff.qC(h)||this.ff.qC([y]))return 16;if(1===c)return 32;this.Lb.ij();this.Fa.Ed();switch(a){case M.a.mLb:const U=
this.rta(m,!0);if(!U)return 8;1<b.length?Ba.a.J(512500292,815,50,"Set {0} shapes font color.",b.length):Ba.a.J(512500291,815,50,"Set one shape font color.");for(const fb of b)if(fb.Jf||fb.Kg){gn(fb);break}this.Hs.sja(fb=>{fb.xLa=U},h);break;case M.a.Ijb:case M.a.GLb:let ja;if(a===M.a.Ijb){if(ja=this.rta(m,!1),!ja)return 8}else ja="";1<b.length?Ba.a.J(512500290,815,50,"Set {0} shapes highlight.",b.length):Ba.a.J(512500289,815,50,"Set one shape highlight.");this.Hs.sja(fb=>{fb.highlight=ja},h);break;
case M.a.vjb:if(!m)return 8;const va=this.az.Y4b(m);if(va.length){1<b.length?Ba.a.J(512500288,815,50,"Set {0} shapes font name.",b.length):Ba.a.J(512500259,815,50,"Set one shape font name.");var G=null;for(const fb of b)if(fb.Jf||fb.Kg)gn(fb),fb.Jf&&(G=fb);if(1>this.H1f(h,a,va).length)return 16;this.Hs.sja(fb=>{fb.mNb=va},h);G&&(G.mNb=va);this.az.nFc(m)}break;case M.a.wjb:m=Object(ua.a)(bE.a,m);if(!m||!m.rd)return 8;const Ta=this.ki.U_b(m.rd);if(isNaN(Ta))return 8;1<b.length?Ba.a.J(512500258,815,
50,"Set {0} shapes font size.",b.length):Ba.a.J(512500257,815,50,"Set one shape font size.");m=null;for(G of b)if(G.Jf||G.Kg)gn(G),G.Jf&&(m=G);if(1>this.H1f(h,a,Ta*ff.a.v$a).length)return 16;this.Hs.sja(fb=>{fb.mrh(Ta)},h);m&&m.mrh(Ta);break;default:return Ba.a.J(512500256,820,10,"Unexpected actionId for HandleFont"),8}return 32}dTa(a,b,c){b=this.Lb.sg();if(!b||1>b.length)return 16;const h=this.Lb.Yja(),m=this.Ea.n_(b);if(1>m.length&&!h||this.ff.qC(m)||this.ff.qC([h]))return 16;if(1===c)return 32;
const y="select"!==this.bdh(this.Ea.n_(b),a);this.Lb.ij();this.Fa.Ed();switch(a){case M.a.O_a:1<b.length?Ba.a.J(512500255,815,50,"Set {0} shapes bold.",b.length):Ba.a.J(512500254,815,50,"Set one shape bold.");h&&Object(Rd.a)("FixTableModifyFontShortcut")&&this.ia.processAction(M.a.bold,2);this.Hs.sja(U=>{U.isBold=y},m);break;case M.a.P_a:1<b.length?Ba.a.J(512500253,815,50,"Set {0} shapes italic.",b.length):Ba.a.J(512500252,815,50,"Set one shape italic.");h&&Object(Rd.a)("FixTableModifyFontShortcut")&&
this.ia.processAction(M.a.setItalic,2);this.Hs.sja(U=>{U.isItalic=y},m);break;case M.a.Q_a:1<b.length?Ba.a.J(512500251,815,50,"Set {0} shapes underline.",b.length):Ba.a.J(512500250,815,50,"Set one shape underline.");h&&Object(Rd.a)("FixTableModifyFontShortcut")&&this.ia.processAction(M.a.underline,2);this.Hs.sja(U=>{U.dE=y},m);break;case M.a.pLb:1<b.length?Ba.a.J(512500249,815,50,"Set {0} shapes strikethrough.",b.length):Ba.a.J(512500248,815,50,"Set one shape strikethrough.");this.Hs.sja(U=>{U.KF=
y},m);break;case M.a.Ypc:case M.a.ILb:const G=a===M.a.ILb?!1:!0;1<b.length?Ba.a.J(512500247,815,50,"Step {0} shapes font size.",b.length):Ba.a.J(512500246,815,50,"Step one shape font size.");this.Hs.sja(U=>{U.Mzb=G},m);break;case M.a.bqc:1<b.length?Ba.a.J(512500245,815,50,"Step {0} shapes superscript.",b.length):Ba.a.J(512500244,815,50,"Step one shape superscript.");this.Hs.sja(U=>{U.gN=y?3E4:0},m);break;case M.a.aqc:1<b.length?Ba.a.J(512500243,815,50,"Step {0} shapes subscript.",b.length):Ba.a.J(512500242,
815,50,"Step one shape subscript.");this.Hs.sja(U=>{U.gN=y?-25E3:0},m);break;default:return 8}return 32}Wsj(a,b,c,h,m){if(1===c)return 32;lf.Font.Oce(b);m.MenuItems=ka.FontUtils.HWf(Ov.$od,Ov.RPc,this.T7j,this.Pla,this.Y7j);return 32}bdh(a,b){let c="select";for(const h of a){switch(b){case M.a.Cmc:case M.a.O_a:c=h.isBold?"select":"normal";break;case M.a.Dmc:case M.a.P_a:c=h.isItalic?"select":"normal";break;case M.a.Fmc:case M.a.Q_a:c=h.dE?"select":"normal";break;case M.a.Emc:case M.a.pLb:c=h.KF?"select":
"normal";break;case M.a.zid:case M.a.bqc:c=0<h.gN?"select":"normal";break;case M.a.yid:case M.a.aqc:c=0>h.gN?"select":"normal";break;default:return"disable"}if("select"!==c)break}return c}UHk(a,b,c){this.Nm=Date.now();c=this.yc.$Yf(a,c);switch(b){case M.a.Cmc:a=1===c.bold?"select":"normal";break;case M.a.Dmc:a=1===c.italic?"select":"normal";break;case M.a.Fmc:a=1===c.underline?"select":"normal";break;case M.a.Emc:a=1===c.strikethrough?"select":"normal";break;default:return"disable"}this.ux=Date.now();
Ba.a.J(512500241,815,50,"Query table shape font state timespan by {0}",(this.ux-this.Nm).toString());return a}H1f(a,b,c){const h=[];for(const m of a)switch(b){case M.a.O_a:m.isBold!==c&&Array.add(h,m);break;case M.a.P_a:m.isItalic!==c&&Array.add(h,m);break;case M.a.Q_a:m.dE!==c&&Array.add(h,m);break;case M.a.pLb:m.KF!==c&&Array.add(h,m);break;case M.a.vjb:m.mNb!==c&&Array.add(h,m);break;case M.a.wjb:Ov.YYf(m)!==c&&Array.add(h,m);break;case M.a.bqc:0<m.gN!==c&&Array.add(h,m);break;case M.a.aqc:0>m.gN!==
c&&Array.add(h,m);break;default:Ba.a.J(512500240,820,10,"ShapesTextFontActor::GetModifiedShapeMonikers unsupported action Id: {0}.",b)}return h}rta(a,b){if(b)return b=ao.SchemeColor.parse(a),b&&b.zta?Cj.i(Cj.g(b.WP)):(Ba.a.J(512500239,820,10,"Font color '{0}' is incorrect",a),null);b=nu.a.parse(a);return b&&b.RGBColor?b.RGBColor:(Ba.a.J(512500238,820,10,"Color '{0}' is incorrect",a),null)}static RPc(a,b){return b}static $od(){return!1}static YYf(a){const b=a.G2;return kf.a.Uy(b,1)?a.zaa:Math.round(a.zaa)*
b}}Object(n.a)(Ov,"ShapesTextFontActor",null,[227]);class kN{constructor(a,b,c,h,m,y,G,U,ja,va,Ta,fb,Db){this.ux=this.Nm=-1;this.Hs=a;this.ia=b;this.Fa=c;this.ff=h;this.pa=m;this.Ea=y;this.Adb=G;this.TL=U;this.Pb=ja;this.Jb=va;this.s1c=Ta;this.yc=fb;this.eA=Db}get Lb(){return this.pa}vb(){this.ia.ra(M.a.ELb,nc.a.application,Object(F.a)(this,this.D8,"handleFormatAction"),4);this.ia.ra(M.a.oLb,nc.a.application,Object(F.a)(this,this.D8,"handleFormatAction"),4);this.ia.ra(M.a.xjb,nc.a.application,Object(F.a)(this,
this.D8,"handleFormatAction"),4);this.ia.ra(M.a.FLb,nc.a.application,Object(F.a)(this,this.D8,"handleFormatAction"),4);this.ia.ra(M.a.Kjb,nc.a.application,Object(F.a)(this,this.D8,"handleFormatAction"),4);this.ia.ra(M.a.nLb,nc.a.application,Object(F.a)(this,this.D8,"handleFormatAction"),4);this.ia.ra(M.a.Xpc,nc.a.application,Object(F.a)(this,this.D8,"handleFormatAction"),4);this.ia.ra(M.a.Aod,nc.a.application,Object(F.a)(this,this.D8,"handleFormatAction"),4);this.ia.ra(M.a.Znd,nc.a.application,Object(F.a)(this,
this.D8,"handleFormatAction"),4);this.ia.ra(M.a.Ynd,nc.a.application,Object(F.a)(this,this.D8,"handleFormatAction"),4);this.ia.ra(M.a.Xnd,nc.a.application,Object(F.a)(this,this.D8,"handleFormatAction"),4);this.ia.ra(M.a.Wnd,nc.a.application,Object(F.a)(this,this.D8,"handleFormatAction"),4);this.ia.ra(M.a.$Ue,nc.a.application,Object(F.a)(this,this.M8f,"handleQueryLineSpacing"),4);this.ia.ra(M.a.Ipc,nc.a.application,Object(F.a)(this,this.D8,"handleFormatAction"),4);this.ia.ra(M.a.Ghb,nc.a.application,
Object(F.a)(this,this.fTa,"handleQueryToggleButton"),97);this.ia.ra(M.a.Hhb,nc.a.application,Object(F.a)(this,this.fTa,"handleQueryToggleButton"),97);this.ia.ra(M.a.vZa,nc.a.application,Object(F.a)(this,this.fTa,"handleQueryToggleButton"),97);this.ia.ra(M.a.wZa,nc.a.application,Object(F.a)(this,this.fTa,"handleQueryToggleButton"),97);this.ia.ra(M.a.qid,nc.a.application,Object(F.a)(this,this.fTa,"handleQueryToggleButton"),97);this.ia.ra(M.a.iid,nc.a.application,Object(F.a)(this,this.fTa,"handleQueryToggleButton"),
97);this.ia.ra(M.a.wid,nc.a.application,Object(F.a)(this,this.fTa,"handleQueryToggleButton"),97);this.ia.ra(M.a.pid,nc.a.application,Object(F.a)(this,this.fTa,"handleQueryToggleButton"),97);this.ia.ra(M.a.Did,nc.a.application,Object(F.a)(this,this.Z$d,"handleQueryTextAnchoring"),97);this.ia.ra(M.a.Bid,nc.a.application,Object(F.a)(this,this.Z$d,"handleQueryTextAnchoring"),97);this.ia.ra(M.a.Aid,nc.a.application,Object(F.a)(this,this.Z$d,"handleQueryTextAnchoring"),97);this.ia.ra(M.a.vid,nc.a.application,
Object(F.a)(this,this.M8f,"handleQueryLineSpacing"),97)}De(){const a=this.Fa.Gc(Ua.a.rg);a.bindAction(w.KeyInputManager.hw(ResourceStrings.l_HK_FullJustify),M.a.nLb);a.bindAction(w.KeyInputManager.hw(ResourceStrings.l_HK_CenterJustify),M.a.FLb);v.a.uk?(a.bindAction(w.KeyInputManager.hw(ResourceStrings.l_HK_LeftJustify_Mac),M.a.xjb),a.bindAction(w.KeyInputManager.hw(ResourceStrings.l_HK_RightJustify_Mac),M.a.Kjb)):(a.bindAction(w.KeyInputManager.hw(ResourceStrings.l_HK_LeftJustify),M.a.xjb),a.bindAction(w.KeyInputManager.hw(ResourceStrings.l_HK_RightJustify),
M.a.Kjb))}fTa(a,b,c,h,m){const y=this.Lb.sg();if(!y||1>y.length)return 16;b=this.Lb.Yja();const G=this.Ea.n_(y);if(1>G.length&&!b)return 16;h=c=null;let U=a===M.a.Ghb?1:a===M.a.Hhb?2:18;Object(za.a)(Ph.a,m)?h=m:Object(za.a)(Kv,m)&&(h=m.zZa,U=m.menuItemId);m=b?[y[0]]:G;this.Nm=Date.now();for(const ja of m){switch(a){case M.a.Ghb:c=ja.ud?this.u9d(U,a):this.F8d(U,ja,a);break;case M.a.Hhb:c=ja.ud?this.u9d(U,a):this.F8d(U,ja,a);break;case M.a.vZa:case M.a.wZa:c=ja.ud?this.u9d(U,a):this.F8d(U,ja,a);break;
case M.a.qid:c=ja.ud?1===this.yc.aRc(b)?"select":"normal":1===ja.Il?"select":"normal";break;case M.a.iid:c=ja.ud?2===this.yc.aRc(b)?"select":"normal":2===ja.Il?"select":"normal";break;case M.a.wid:c=ja.ud?3===this.yc.aRc(b)?"select":"normal":3===ja.Il?"select":"normal";break;case M.a.pid:c=ja.ud?6===this.yc.aRc(b)?"select":"normal":4===ja.Il?"select":"normal";break;default:c="disable"}if("normal"===c)break}h.Qf("select"===c);this.ux=Date.now();b&&Ba.a.J(512500237,815,50,"Query table shape timespan by {0}",
(this.ux-this.Nm).toString());return"disable"!==c?32:8}F8d(a,b,c){return c===M.a.vZa||c===M.a.Ghb||c===M.a.wZa||c===M.a.Hhb?this.TL.Ovf(b,a)?"select":"normal":"normal"}u9d(a,b){var c=!0,h=this.Lb.Yja();h=yd.SelectionFactory.PKc(Object(ua.a)($f.a,h));for(const m of h){if(c=m.el?m.node:null)if(h=this.Pb.Nc(c),h.set(c),h.rc(11),h.Ng(11),c=this.eA.fw(h)){if(0===a){c=!1;break}if(b===M.a.Ghb)c=1===c.listType;else if(b===M.a.Hhb)c=0===c.listType;else if(b===M.a.vZa){h=this.TL.eVa.ga(a).hZb;const y=this.TL.eVa.ga(a).Xrb;
c=c.kxb&&0<c.h9.length&&c.h9[0]===h&&c.k$a&&c.font===y}else b===M.a.wZa?(h=this.TL.Tcd.ga(a).NQd,c=!!c.propertySet&&c.propertySet.Sa(X.a.autonumberBulletType)&&c.propertySet.eb(X.a.autonumberBulletType)===h):c=!1}else c=0===a?b===M.a.vZa||b===M.a.wZa?!0:!1:!1;else c=!1;if(!c)break}return c?"select":"normal"}D8(a,b,c,h,m){h=this.Lb.sg();if(!h||1>h.length)return 16;b=this.Ea.n_(h);const y=this.Lb.Yja(),G=!!y&&(a===M.a.Xpc||a===M.a.Aod);if(!b.length&&!y||G||this.ff.qC(b)||this.ff.qC([y]))return 16;if(1===
c)return 32;this.Lb.ij();a!==M.a.Ipc&&this.Fa.Ed();switch(a){case M.a.ELb:case M.a.oLb:if(Object.getType(m)!==Number)return 8;this.m9k(h,b,m);break;case M.a.xjb:case M.a.FLb:case M.a.Kjb:case M.a.nLb:var U=this.sLf(b);this.k9k(b,a,m);U&&this.pa.selectShape(U,!1);Nc.a.kP(!0,!1);break;case M.a.Xpc:case M.a.Aod:m=[];const ja=a===M.a.Xpc?1:2;for(U of b)Array.add(m,U);1<h.length?Ba.a.J(512500236,815,50,"Set {0} shapes text direction.",h.length):Ba.a.J(512500235,815,50,"Set one shape text direction.");
this.Hs.a8a(Ta=>{if(Ta=Object(ua.a)(4,Ta))Ta.lNb=ja},m);break;case M.a.Ipc:if(!m||!Object(za.a)(Array,m)||1>m.length)return 8;Nc.a.Ib&&(Nc.a.Ib.Nj=!0);b=this.Jb.zd(15);try{for(b.nc(m[0].p1),b.jd=a,a=0;a<m.length;a++)m[a].p1.zia=m[a].D$.left,m[a].p1.Aia=m[a].D$.right,m[a].p1.Bia=m[a].D$.top,m[a].p1.yia=m[a].D$.bottom}finally{b&&b.dispose()}Nc.a.kP(!0,!1);break;case M.a.Znd:case M.a.Ynd:case M.a.Xnd:m=[];let va=1;switch(a){case M.a.Znd:va=0;break;case M.a.Ynd:va=1;break;case M.a.Xnd:va=2}for(const Ta of b)Array.add(m,
Ta);Ba.a.J(512500234,815,50,"Set text anchoring, shape count: {0}.",h.length);this.Hs.a8a(Ta=>{if(Ta=Object(ua.a)(4,Ta))Ta.Loa=va},m);Nc.a.kP(!0,!1);break;case M.a.Wnd:if(!m||Object.getType(m)!==Number)return 8;U=this.sLf(b);this.l9k(b,m,a);U&&this.pa.selectShape(U,!1);Nc.a.kP(!0,!1);break;default:return 8}return 32}Z$d(a,b,c,h,m){b=this.Lb.sg();if(!b||1>b.length)return 16;b=this.Lb.M5d(b);h=b.Lzb;c=0;const y=this.Lb.Yja();if(!h&&!y)return 16;switch(a){case M.a.Did:a=y?({exa:c}=this.yc.g1e(y)).returnValue&&
0===c?"select":"normal":0===b.Loa?"select":"normal";break;case M.a.Bid:a=y?({exa:c}=this.yc.g1e(y)).returnValue&&1===c?"select":"normal":1===b.Loa?"select":"normal";break;case M.a.Aid:a=y?({exa:c}=this.yc.g1e(y)).returnValue&&2===c?"select":"normal":2===b.Loa?"select":"normal";break;default:a="disable"}m.Qf("select"===a);return"disable"!==a?32:8}M8f(a,b,c,h,m){c=this.Lb.sg();if(!c||1>c.length)return 16;b=this.Lb.Yja();c=this.Ea.n_(c);if(!c.length&&!b)return 16;this.Nm=Date.now();switch(a){case M.a.$Ue:break;
case M.a.vid:a=new XM.a;a.Vf=2;a.value=m.MenuItemId;h=!0;b&&(h=this.pel(b,m),this.ux=Date.now(),Ba.a.J(512500233,815,50,"Query table shape timespan by {0}",(this.ux-this.Nm).toString()));for(const y of c){b=this.Ea.E8d(y);if(!b||!this.Adb.Uvf(b,a)){h=!1;break}this.s1c&&2===b.Vf&&(b.value=Math.max(0,b.value-this.Ea.e4d(y)))}m.queryResult.Qf(h);break;default:return 8}return 32}l9k(a,b,c){const h=this.Jb.zd(15);try{h.nc(a[0]);h.jd=c;for(const m of a)m.Rsa();this.ia.La(M.a.una,2,b)}finally{h&&h.dispose()}}k9k(a,
b,c){const h=[];let m=0,y=0;switch(b){case M.a.xjb:m=1;y=D.a.Uka;break;case M.a.FLb:m=2;y=D.a.Iia;break;case M.a.Kjb:m=3;y=D.a.eoa;break;case M.a.nLb:m=4,y=D.a.yDa}a=this.pa.YO(a);for(const G of a)G.Il!==m&&Array.add(h,G);if(y&&h.length){for(const G of a)if(G.Jf||G.Kg){gn(G);break}a=this.Jb.zd(15);try{a.nc(h[0]);for(const G of h)G.Rsa(),G.a$k(m);this.ia.La(y,2,c)}finally{a&&a.dispose()}}}m9k(a,b,c){const h=[];let m=1===c||2===c;for(const G of b)this.TL.Ovf(G,c)||(m=!1,Array.add(h,G));1<a.length?Ba.a.J(512500231,
815,50,"ListGallery enabled, set {0} shapes bullet.",a.length):Ba.a.J(512500230,815,50,"ListGallery enabled, set one shape bullet.");for(const G of a)if(G.Jf||G.Kg){gn(G);break}a=m?b:h;2!==c||m||(a=b,c=11);if(m||0===c)c=18;const y=this.TL.eVa.ga(c);0<a.length&&this.Hs.a8a(G=>{G.setValue(X.a.kNb,c);y&&(G.setValue(X.a.GAh,y.Xrb),G.setValue(X.a.FAh,y.hZb))},a)}pel(a,b){let c=!1;const h=b.MenuItemId;let m=b.LineSpacingValue;b=b.LineSpacingUnit;a=yd.SelectionFactory.PKc(Object(ua.a)($f.a,a));for(const y of a){if(a=
y.el?y.node:null){a=this.Adb.JW(a);const G=kf.a.Uy(a.lineSpacing.value,h)&&2===a.lineSpacing.Vf;if(-1===m)b=a.lineSpacing.Vf,m=a.lineSpacing.value;else if(m!==a.lineSpacing.value||b!==a.lineSpacing.Vf)m=b=0,c=!1;0!==b&&(c=G)}if(!c)break}return c}sLf(a){return 0<a.length&&a[0].Kg&&(a=this.Ea.rs(a[0]))?(this.pa.Z7(a),a):null}}Object(n.a)(kN,"ShapesTextParagraphActor",null,[227]);var VQ=d(676);class lN{constructor(a,b,c,h,m,y,G,U,ja,va,Ta,fb,Db){this.ia=a;this.ff=b;this.Jb=c;this.$z=h;this.Fa=m;this.pa=
y;this.Vb=G;this.ua=U;this.Sb=ja;this.Ga=va;this.Fu=Ta;this.Fb=fb;if(!Db)throw Error.argumentNull("GraphOperationEventHandler is null");this.Lg=Db}vb(){this.ia.ra(M.a.deleteObject,xb.a.application,Object(F.a)(this,this.cqj,"handleDelete"),4);this.Ga.podsEnableSlideScoreCard&&this.ia.ra(M.a.ddh,he.a.frame,Object(F.a)(this,this.vAl,"updateSlideScore"),96);this.ia.ra(M.a.k_d,nc.a.application,Object(F.a)(this,this.vqj,"handleDuplicate"),4);this.ia.ra(M.a.wqf,nc.a.application,Object(F.a)(this,this.Eoj,
"handleAddFirstSlide"),4);this.Ga.FQj?(this.ia.ra(M.a.qI,xb.a.application,Object(F.a)(this,this.mqj,"handleDeleteSlides"),4),this.ia.ra(M.a.gQ,nc.a.application,Object(F.a)(this,this.yqj,"handleDuplicateSlides"),4),this.Ga.fbe?(this.ia.ra(M.a.l7b,nc.a.application,Object(F.a)(this,this.erj,"handleHideSlides"),4),this.ia.ra(M.a.a2e,nc.a.application,Object(F.a)(this,this.svj,"handleUnhideSlides"),4),this.Lg.Hqb(Object(F.a)(this,this.Vil,"slidesSelectionChangedHandler"))):this.ia.ra(M.a.l7b,nc.a.application,
Object(F.a)(this,this.K$d,"handleHideSlidesOld"),4),this.ia.ra(M.a.Gid,xb.a.application,Object(F.a)(this,this.vtj,"handleQuerySlidesHidden"),96)):(this.ia.ra(M.a.qI,xb.a.application,Object(F.a)(this,this.lqj,"handleDeleteSlide"),4),this.ia.ra(M.a.gQ,nc.a.application,Object(F.a)(this,this.xqj,"handleDuplicateSlide"),4),this.ia.ra(M.a.l7b,nc.a.application,Object(F.a)(this,this.drj,"handleHideSlide"),4),this.ia.ra(M.a.Gid,xb.a.application,Object(F.a)(this,this.utj,"handleQuerySlideHidden"),96));this.ia.ra(M.a.EYd,
xb.a.application,Object(F.a)(this,this.fqj,"handleDeleteFakeSlides"),2048);this.ia.ra(M.a.eDf,xb.a.application,Object(F.a)(this,this.Kpj,"handleClearAndResizeSlideCanvas"),2048);this.ia.ya(M.a.Fod,nc.a.application,Object(F.a)(this,this.Iuj,"handleShareSlide"));this.ia.ra(M.a.pMe,xb.a.application,Object(F.a)(this,this.O$d,"handleIsDirectManipulationEnabled"),97)}De(){const a=this.Fa.Gc(Di.a.JD);a.bindAction(w.KeyInputManager.Na(z.a.bpa,0),M.a.qI);a.bindAction(w.KeyInputManager.Na(z.a.MH,0),M.a.qI);
a.bindAction(w.KeyInputManager.Na(z.a.nMa,w.KeyInputManager.Le),M.a.gQ)}cqj(a,b,c,h,m){if(this.Fa.Be)if(this.Fa.S7===Di.a.JD||1===this.Fb.Sl||this.Ga.Ks&&this.Fa.S7===Ua.a.QE)a=M.a.qI;else if(this.Fa.S7===Ua.a.rg)a=M.a.G6a;else return 8;else return 8;return this.ia.La(a,c,m)}lqj(a,b,c){b=this.ua.Ba;if(!b||this.ff.$c(b)||this.Ga.tC&&1!==this.pa.We().length)return 16;if(1===c)return 32;if(!b.isConnected)return 16;Nc.a.Ib&&(Nc.a.Ib.actionName="DeleteSlide",Nc.a.Ib.Qr=!1,Nc.a.Ib.Nj=!0,Nc.a.Ib.Va("SlideCount",
"1"));c=this.Vb.Cf;if(!c)return 16;const h=this.Jb.zd(15,void 0,()=>{this.pa.Qh()});try{h.nc(c),h.jd=a,c.qI(b)}finally{h&&h.dispose()}this.ff.Zv(c,a);a=[];a.push(b);this.Fu?this.Fu.ljd(new pE.a(a)):Ba.a.J(512313375,822,10,"HandleDeleteSlide: graphOperationEventNotifier is null for raising event.");return 32}Kpj(a,b,c){a=this.Sb.mC(this.ua.l0c?this.ua.l0c.slideIndex:0);if(!a)return Ba.a.J(512313374,822,50,"HandleClearAndResizeSlideCanvas: slideNode null"),8;a=Object(ua.a)(295,a.sc(this.Fb.Ma));if(!a)return Ba.a.J(512313373,
822,50,"HandleClearAndResizeSlideCanvas: slideViewElement null"),16;if(1===c)return 32;Ba.a.J(512313372,822,50,"HandleClearAndResizeSlideCanvas: updating slideViewElement");a.ZTe(!1);a.updateOffSlideView(0,!0);return 32}fqj(a,b,c){b=[];for(const h of this.Sb.h4b())h.ON&&Array.add(b,h);if(!b.length||!this.ua.Ba)return Ba.a.J(512313371,822,50,"HandleDeleteFakeSlides: empty fake slides"),8;if(1===c)return 32;Ba.a.J(512313370,822,50,"HandleDeleteFakeSlides: deleting fake slides");return this.oLf(b,"DeleteFakeSlide",
a)}mqj(a,b,c){b=this.pa.We();if(!b||!b.length||!this.ua.Ba)return 16;for(const h of b)if(!h||this.ff.$c(h))return 16;if(1===c)return 32;for(const h of b)if(!h.isConnected)return 16;return this.oLf(b,"DeleteSlide",a)}oLf(a,b,c){Nc.a.Ib&&(Nc.a.Ib.actionName=b,Nc.a.Ib.Qr=!1,Nc.a.Ib.Nj=!0,Nc.a.Ib.Va("SlideCount",a.length.toString()));1<a.length?Ba.a.J(512313369,822,50,"HandleDeleteSlides: Selected slidenodes: {0}",a.length):Ba.a.J(512313368,822,50,"HandleDeleteSlides: Selected one slidenode.");b=this.Vb.Cf;
if(!b)return 16;this.HJi(b,a,c,()=>{this.pa.Qh()});return 32}HJi(a,b,c,h){h=this.Jb.zd(15,void 0,h);try{h.nc(a);for(const m of b)m&&!m.Cb.equals(this.ua.Ba.Cb)&&a.qI(m);a.qI(this.ua.Ba);h.jd=c}finally{h&&h.dispose()}this.Ga.unblockContentWhenDeletingSlideEnabled||this.ff.Zv(a,c);this.Fu?this.Fu.ljd(new pE.a(b)):Ba.a.J(512313367,822,10,"HandleDeleteSlides: graphOperationEventNotifier is null for raising event.")}utj(a,b,c,h,m){a=this.ua.Ba;if(!a)return 16;m.Qf(a.an);return 32}vtj(a,b,c,h,m){a=this.pa.We();
if(!a||!a.length)return 16;a=this.$Pd(a);m.Qf(a);return 32}Iuj(a,b,c,h,m){a=this.ua.Ba;if(!a||this.ff.$c(a)||1!==this.pa.We().length)return 16;if(1===c)return 32;Nc.a.Ib&&(Nc.a.Ib.Qr=!1,Nc.a.Ib.Va("SlideCount","1"));c=a.Cb;if(!c)return 16;c=JSON.stringify({["sId"]:c.sid,["cId"]:c.cid});m.nav=VQ.a(c);m.mode="copy";Ba.a.J(512313364,822,50,"HandleShareSlide: nav:{0}",c);this.ia.La(H.a.Ksa,2,m);return 32}drj(a,b,c){b=this.ua.Ba;if(!b||this.ff.$c(b)||this.Ga.tC&&1!==this.pa.We().length)return 16;if(1===
c)return 32;Nc.a.Ib&&(Nc.a.Ib.Qr=!1,Nc.a.Ib.Va("SlideCount","1"));c=this.Jb.zd(15,void 0,()=>{this.Fa.Ed();this.pa.Qh()},()=>{1!==this.Fb.Sl&&(this.Ga.Ks?this.Fa.xf(Ua.a.QE):this.Fa.xf(Di.a.JD))});try{c.nc(b),c.jd=a,b.an=!b.an}finally{c&&c.dispose()}return 32}K$d(a,b,c){b=this.pa.We();if(!b||!b.length)return 16;for(var h of b)if(!h||this.ff.$c(h))return 8;if(1===c)return 32;Ba.a.J(512313363,822,50,"HandleHideSlidesOld: Selected slidenodes: {0}",b.length);Nc.a.Ib&&(Nc.a.Ib.Qr=!1,Nc.a.Ib.Va("SlideCount",
b.length.toString()));c=!this.$Pd(b);h=this.Jb.zd(15,void 0,()=>{this.Fa.Ed();this.pa.Qh()},()=>{1!==this.Fb.Sl&&(this.Ga.Ks?this.Fa.xf(Ua.a.QE):this.Fa.xf(Di.a.JD))});try{h.nc(this.Vb.Cf);h.jd=a;for(const m of b)m.an=c}finally{h&&h.dispose()}return 32}erj(a,b,c,h,m){const y=this.pa.We();if(!y||!y.length)return 16;for(const G of y)if(!G||this.ff.$c(G))return 8;if(this.$Pd(y))return this.RUc(),32;this.K$d(a,b,c,h,m);this.RUc();return 32}svj(a,b,c,h,m){const y=this.pa.We();if(!y||!y.length)return 16;
for(const G of y)if(!G||this.ff.$c(G))return 8;if(1===c)return 32;this.K$d(a,b,c,h,m);this.RUc();return 32}RUc(){var a=this.pa.We();if(a&&a.length){for(var b of a)if(!b||this.ff.$c(b))return;if(Dg.c()){b=!0;for(const c of a)if(!c.an){b=!1;break}a=[appChrome.actions.updateControlHiddenState("HideSlide",b),appChrome.actions.updateControlEnabledDisabledState("UnhideSlide",!b),appChrome.actions.updateControlHiddenState("UnhideSlide",!b)];appChrome.api.dispatch(a)}else Ba.a.J(512313362,822,50,"HandleToggleHiddenBehavior: appChrome not defined")}}Vil(){this.RUc()}vAl(a,
b,c,h,m){if(1===c)return 32;this.ua.Ba&&(a="Slide Complex: "+this.ua.Ba.sa(X.a.Wna,0).toString(),m[np.a.Value]=a,m[bm.a.labelText]=a,m[np.a.Visible]=!0);return 32}vqj(a,b,c,h,m){if(this.Fa.Be)if(this.Fa.S7===Di.a.JD)a=M.a.gQ;else if(this.Fa.S7===Ua.a.rg)a=M.a.M7a;else return 8;else return 8;return this.ia.La(a,c,m)}xqj(a,b,c){b=this.ua.Ba;if(!b||this.ff.$c(b)||this.Ga.tC&&1!==this.pa.We().length)return 16;if(1===c)return 32;Nc.a.xk("SlideCount","1");this.$z.uSi(b,a).XN||this.ff.Zv(this.Vb.Cf,a);return 32}yqj(a,
b,c){b=this.pa.We();if(!b||!b.length)return 16;for(var h of b)if(!h||this.ff.$c(h))return 16;if(1===c)return 32;1<b.length?Ba.a.J(512313361,822,50,"HandleDuplicateSlides: Selected slidenodes: {0}",b.length):Ba.a.J(512313360,822,50,"HandleDuplicateSlides: Selected one slidenode.");Nc.a.xk("SlideCount",b.length.toString());c=this.$z.jRf(b,a,null,null,!0);h=!0;for(const m of c)if(!m.XN){h=!1;break}h||this.ff.Zv(this.Vb.Cf,a);return 32}Eoj(){try{Ba.a.J(512313359,801,50,"SlideActor: HandleAddFirstSlide called.");
const a=this.Sb.xI();a&&0<a.length&&this.$z.kOc(null,a[0].Id,this.Ga.z$b?0:a[0].ContentMasters[0].Id,M.a.QFb);return 32}catch(a){return Ba.a.J(512313358,801,10,"Exception in HandleAddFirstSlide: {0}.",a),8}}O$d(a,b,c,h,m){return m&&Object(za.a)(lc.a,m)?this.ff.$c(this.Sb.zl(m))?16:32:8}$Pd(a){for(const b of a)if(!b.an)return!1;return!0}}Object(n.a)(lN,"SlideActor",null,[227]);var WQ=d(1115);const zE=()=>{appChrome.PRIToastManager.dismissToast()};class AE{constructor(a,b,c){this.slideId=a;this.Dek=
b;this.Eyi=c}}Object(n.a)(AE,"NewSlideWithLayoutData",null,[]);class Si{constructor(a,b,c,h,m,y,G,U,ja,va,Ta,fb,Db,gc){this.wva=0;this.X4c={};this.XRg=this.YRg=0;this.ia=a;this.fc=b;this.Fa=c;this.a8j=Si.xKj(h);this.pa=m;this.Jb=y;this.$z=G;this.Vb=U;this.ua=ja;this.Sb=va;this.jqe=Ta;this.Gu=fb;this.Gu.MFc(Object(F.a)(this,this.h7g,"openIgnoredDialog"));this.Ga=Db;this.bEb=gc;this.Tva={}}vb(){this.Ga.EQj?this.ia.ra(M.a.Jia,nc.a.application,Object(F.a)(this,this.i9f,"handleSlidesChangeLayout"),4):
this.ia.ra(M.a.Jia,nc.a.application,Object(F.a)(this,this.Cpj,"handleChangeLayout"),4);this.ia.ra(M.a.Xma,nc.a.application,Object(F.a)(this,this.z8f,"handleNewSlideWithLayoutOptions"),4);this.ia.ra(M.a.m5,nc.a.application,Object(F.a)(this,this.y8f,"handleNewSlideWithDefaultLayout"),4);this.ia.ra(M.a.QFb,nc.a.application,Object(F.a)(this,this.y8f,"handleNewSlideWithDefaultLayout"),4);this.ia.ra(M.a.wcd,nc.a.application,Object(F.a)(this,this.msj,"handleNewSlideWithLayout"),4);this.ia.ra(M.a.vHb,nc.a.application,
Object(F.a)(this,this.z8f,"handleNewSlideWithLayoutOptions"),4);this.ia.ra(M.a.UWc,nc.a.application,Object(F.a)(this,this.Stj,"handleReactInsertSlideWithLayout"),4);this.ia.ra(M.a.gJe,nc.a.application,Object(F.a)(this,this.i9f,"handleSlidesChangeLayout"),4);this.ia.ra(M.a.iTd,nc.a.application,Object(F.a)(this,this.Rtj,"handleReactChangeSlideLayout"),4);this.ia.ra(M.a.Thd,nc.a.application,Object(F.a)(this,this.Thd,"queryNewSlideLayout"),4);this.ia.ra(M.a.wLe,nc.a.application,Object(F.a)(this,this.wLe,
"queryChangeSlideLayout"),4)}De(){const a=this.Fa.Gc(Di.a.JD),b=this.Fa.Gc(Di.a.J2),c=this.Fa.Gc(Ua.a.rg),h=this.Fa.Gc(Ua.a.iQ);a.bindAction(w.KeyInputManager.Na(z.a.tq,0),M.a.m5);a.bindAction(w.KeyInputManager.Na(z.a.Dga,w.KeyInputManager.Le),M.a.m5);c.bindAction(w.KeyInputManager.Na(z.a.Dga,w.KeyInputManager.Le),M.a.m5);b.bindAction(w.KeyInputManager.Na(z.a.Dga,w.KeyInputManager.Le),M.a.m5);h.bindAction(w.KeyInputManager.Na(z.a.Dga,w.KeyInputManager.Le),M.a.m5)}tqc(){return this.a8j||this.Sb.uae()}Cpj(a,
b,c){const h=this.ua.Ba;if(!h||this.fc.$c(h)||this.Ga.tC&&1!==this.pa.We().length)return 16;a=h.hj;if(!a)return 8;b=this.Sb.xI();if(!this.Ga.IUa){if(!b)return Ba.a.J(512500229,822,10,"SlideLayoutActor::HandleChangeLayout fails to get mainMasters"),8;if(!this.Dlb(b,a))return 8}if(1===c)return 32;if((!this.Ga.IUa||b&&this.Dlb(b,a))&&this.Gu.KO.Hb(a)&&this.fme()){this.wva=0;c=h.Bn;if(!c)return Ba.a.J(512500227,822,10,"SlideLayoutActor::HandleChangeLayout fails to get contentMasterId"),8;this.jqe.nWd(0,
this.Sb.zu(),b,this.Gu.KO,a,Object(F.a)(this,this.iTd,"changeSlideLayout"),this.tqc(),u.AFrameworkApplication.isRtl).ypd(c)}else Ba.a.J(512500228,822,50,"SlideLayoutActor::HandleChangeLayout does not have MainMasterResources ready yet"),this.Gu.kYe(a),this.wva=M.a.Jia;return 32}i9f(a,b,c,h,m){b=this.pa.We();if(!b||!b.length)return 8;h=0;const y=[],G=this.Sb.xI();if(!G)return Ba.a.J(512500226,822,10,"SlideLayoutActor::HandleSlidesChangeLayout fails to get mainMasters"),8;for(var U of b){if(this.fc.$c(U)||
!U)return 16;h=U.hj;if(!h)return Ba.a.J(512500225,822,50,"SlideLayoutActor::HandleSlidesChangeLayout MainmasterId is 0"),8;y.push(h);if(!this.Ga.IUa&&!this.Dlb(G,h))return Ba.a.J(512500224,822,50,"SlideLayoutActor::HandleSlidesChangeLayout fails to validate masters"),8}if(1===c&&!this.Ga.FZa)return 32;for(const ja of y)if(this.Ga.IUa&&!this.Dlb(G,h)||!this.Gu.KO.Hb(ja)){Ba.a.J(512500195,822,50,"SlideLayoutActor::HandleSlidesChangeLayout does not have MainMasterResources ready yet");this.Gu.kYe(h);
if(this.Ga.FZa)return this.hae(a,c,()=>{this.Gu.MFc(zE)},m);this.wva=M.a.Jia;return 32}U=this.wva=0;for(const ja of b)if(U=ja.Bn,!U)return Ba.a.J(512500194,822,10,"SlideLayoutActor::HandleSlidesChangeLayout fails to get contentMasterId"),8;1<b.length?Ba.a.J(512500193,822,50,"HandleSlidesChangeLayout: Selected slidenodes: {0}",b.length):Ba.a.J(512500192,822,50,"HandleSlidesChangeLayout: Selected one slidenode.");1<b.length&&(U=0);if(!this.fme())return Ba.a.J(512500191,822,50,"HandleSlidesChangeLayout: Layout masters not ready yet "),
Rd.a("RaiseFirstMasterRetrievedEvent")?this.hae(a,c,()=>{this.Gu.n9h(zE)},m):8;if(this.Ga.FZa){if(1===c)return 32;if(!m)return 8;this.XRg=U;this.Tgd(m,G,h,!0)}else this.jqe.nWd(0,this.Sb.zu(),G,this.Gu.KO,h,Object(F.a)(this,this.WBf,"changeSlidesLayout"),this.tqc(),u.AFrameworkApplication.isRtl).ypd(U);return 32}iTd(a,b){const c=this.ua.Ba;if(c){var h=()=>{this.Fa.Ed();this.pa.Qh()},m=()=>{this.Fa.xf(Di.a.JD)};a=parseInt(a);b=parseInt(b);if(a!==c.hj||b!==c.Bn){const y=Nc.a.Ib;Nc.a.Msd("ChangeSlideLayout");
Nc.a.Ib&&(Nc.a.Ib.Qr=!0,Nc.a.Ib.Va("SlideCount","1"));h=this.Jb.zd(15,void 0,h,m);try{h.nc(c),h.jd=M.a.Jia,c.hj=a,c.Bn=b}finally{h&&h.dispose()}this.fc.Zv(c,"ChangeSlideLayout");Nc.a.Ib=y}}}WBf(a,b){const c=this.pa.We();if(c&&c.length){a=parseInt(a);b=parseInt(b);var h=Nc.a.Ib;Nc.a.Msd("ChangeSlidesLayout");Nc.a.Ib.Qr=!0;var m=[];for(var y of c)a===y.hj&&b===y.Bn||m.push(y);if(m.length){Nc.a.xk("SlideCount",m.length.toString());y=this.Jb.zd(15,void 0,()=>{this.Fa.Ed();this.pa.Qh()},()=>{this.Fa.xf(Di.a.JD)});
try{y.nc(this.ua.Ba);y.jd=M.a.Jia;for(const G of m)G.hj=a,G.Bn=b}finally{y&&y.dispose()}for(const G of c)this.fc.Zv(G,"ChangeSlidesLayout");Nc.a.Ib=h}}}Rtj(a,b,c,h,m){if(1===c)return 32;if(!m)return 8;try{let y,G;if(!({masterId:y,layoutId:G}=this.y1e(m.SourceControlId)).returnValue)return 8;Ba.a.J(512500189,822,50,"SlideLayoutActor:: React Change Layout Dropdown invoked command to Change Layout.");this.WBf(y,G)}catch(y){return Ba.a.J(512500188,822,10,"SlideLayoutActor:: react change slide layout failed with Exception {0} ",
y),8}return 32}z8f(a,b,c,h,m){h=this.Vb.Cf;if((b=this.ua.Ba)&&this.fc.$c(b)||this.fc.$c(h))return Ba.a.J(512500187,822,50,"SlideLayoutActor::HandleNewSlideWithLayoutOptions Graph node blocked"),16;h=this.Sb.xI();if(!h||!h.length)return Ba.a.J(512500186,822,10,"SlideLayoutActor::HandleNewSlideWithLayoutDialog fails to get mainMasters"),8;let y=0;if(b){if(y=b.hj,!y)return Ba.a.J(512500185,822,50,"SlideLayoutActor::HandleNewSlideWithLayoutDialog MainMasterId is 0"),8}else y=h[0].Id;let G=0;({hj:y,Bn:G}=
this.mRc(h,b));if(!this.Ga.IUa&&!this.Dlb(h,y))return Ba.a.J(512500184,822,50,"SlideLayoutActor::HandleNewSlideWithLayoutDialog fails to validate mainMasters"),8;if(1===c){if(!this.Sb.Lj())return 8;if(!this.Ga.FZa)return 32}if(this.Ga.IUa&&!this.Dlb(h,y)||!this.Gu.KO.Hb(y)||!this.fme()){Ba.a.J(512500183,822,50,"SlideLayoutActor::HandleNewSlideWithLayoutDialog does not have MainMasterResources ready yet");this.Gu.kYe(y);if(this.Ga.FZa)return this.hae(a,c,()=>{this.Gu.MFc(zE)},m);this.wva=M.a.Xma}else if(this.wva=
0,this.Ga.FZa){if(1===c)return 32;if(!m)return 8;this.YRg=G;this.Tgd(m,h,y,!1)}else this.jqe.nWd(1,this.Sb.zu(),h,this.Gu.KO,y,Object(F.a)(this,this.UWc,"insertSlideWithLayout"),this.tqc(),u.AFrameworkApplication.isRtl).ypd(G);return 32}Tgd(a,b,c,h){a.MenuId&&"style"===a.MenuId||(a.MenuItems=Rd.a("ReactSlideLayoutSectionsAPIEnabled")?this.n5b(b,c,h):this.ffj(b,c,h));Ba.a.J(512500182,822,50,"SlideLayoutActor:: React Slide Layout DropDown Invoked. Type : IsChangeLayout : {0}  ",h)}r8d(){const a=this.Sb.zu();
if(!a||!a.width||!a.height)return Ba.a.J(512500181,822,15,"SlideLayoutActor:: Slide size is null or 0"),new cr.a(Si.Gzf,Si.Gli);const b=Si.Gzf;return new cr.a(b,a.height/a.width*b)}ORc(){const a={},b={},c=this.r8d();b.root=this.YWd(c.width+Si.Ozf,c.height+Si.Ozf+Si.zli+Si.Mli);b.flexContainer={flexDirection:"column"};b.label=Si.DWd();a.galleryButtonInExpanded=b;return a}YWd(a,b){const c={};c.width=a;c.height=b;c.backgroundColor="transparent";return c}ffj(a,b,c){this.Kjd();const h=Object.assign(new Mk.a,
{Id:c?"PptRibbon.ChangeLayout":"PptRibbon.NewSlideLayout",MenuSectionList:[],UpdateDynamically:!0});let m=0,y=!1;const G=a.length;if(!G||1===G&&a&&a[0]&&!a[0].InContent)return h;for(var U=0;U<G;U++)a[U].Id===b&&(m=U,y=!0);y&&(b=this.z1f(a[m],b,c,m),Array.add(h.MenuSectionList,b));for(b=0;b<G;b++)y&&b===m||(U=this.z1f(a[b],a[b].Id,c,b),Array.add(h.MenuSectionList,U));return h}z1f(a,b,c,h){const m=Object.assign(new di.a,{ControlList:[],Title:a.Name});if(!(a.InContent&&this.Gu.KO&&this.Gu.KO.Hb(a.Id)))return m;
var y=this.ORc(),G=c?"ChangeLayout":"NewSlide",U=c?"ChangeLayoutControls":"NewSlideLayoutControls";Si.Dad++;h=Rd.a("ReactSlideLayoutUniqueIdFix")?h.toString():b.toString()+"_"+Si.Dad.toString();y=Object.assign(new qq.a,{Id:U,ExternalId:G+"_"+h,Type:4,Title:a.Name,GalleryStyle:y,Width:3,GalleryItems:[]});a=a.ContentMasters;if(!a)return m;G=a.length;for(U=0;U<G;U++)h=a[U],!h||!this.tqc()&&this.Sb.cab(h)||Array.add(y.GalleryItems,this.Avb(h,b,c));Array.add(m.ControlList,y);return m}msi(){try{const a=
[],b=this.Tva;for(let c in b)a.push(c);this.Tva={};this.X4c={};appChrome.api.unregisterIcons(a)}catch(a){Ba.a.J(512500180,822,15,"SlideLayoutActor::Failed to unregister icons for react new slide layout {0}",a)}}Kjd(){this.msi();try{const a=this.Sb.xI();if(a){for(let b=0;b<a.length;b++){const c=a[b];c&&this.Gu.KO&&this.Gu.KO.count&&this.Gu.KO.Hb(c.Id)&&this.addIconToMap(this.Gu.KO.ga(c.Id).LayoutIcons,c.Id)}appChrome.api.registerIconProvider(()=>this.Tva)}}catch(a){Ba.a.J(512500179,822,15,"SlideLayoutActor::Failed to register icons for react new slide layout {0}",
a)}}o5b(a,b){a=String.format("{0}_{1}_{2}",Si.Tyj,a,b);a in this.X4c||(Si.Dad++,this.X4c[a]=a+"_"+Si.Dad.toString());return this.X4c[a]}addIconToMap(a,b){if(this.ua.Ba&&a)for(let h=0;h<a.length;++h){var c=a[h];if(!c)continue;const m=this.o5b(b,c.LayoutId),y={},G={};c.Icon&&c.Icon.Clip&&c.Icon.Clip.Bounds&&(G.top=String.format("-{0}px",c.Icon.Clip.Bounds.Top),u.AFrameworkApplication.isRtl&&Rd.a("ReactSlideLayoutRTLFix")?G.right=String.format("-{0}px",c.Icon.Clip.Bounds.Left):G.left=String.format("-{0}px",
c.Icon.Clip.Bounds.Left));G.position="absolute";const U={},ja={},va=this.r8d();ja.height=va.height.toString()+"px";ja.width=va.width.toString()+"px";ja.position="relative";ja.overflow="hidden";ja.display="inline-block";U.root=ja;y.root=G;this.bEb&&c.Icon&&(c=appChrome.buildLayoutImageIconFromUrlWithStyles(this.bEb.resolve(ca.a.oub,c.Icon.ImgId,Si.omi),y,U),this.Tva[m]=c)}}n5b(a,b,c){this.Kjd();const h=Object.assign(new Mk.a,{Id:c?"PptRibbon.ChangeLayout":"PptRibbon.NewSlideLayout",MenuSectionList:[],
UpdateDynamically:!0});var m=Object.assign(new di.a,{Id:c?"ChangeLayoutMenuSection":"NewSlideLayoutMenuSection",ControlsId:c?"ChangeLayoutMenuSection.Controls":"NewSlideLayoutMenuSection.Controls",ControlList:[]});Array.add(h.MenuSectionList,m);var y=this.ORc();y=Object.assign(new qq.a,{Id:c?"ChangeLayoutControls":"NewSlideLayoutControls",ExternalId:c?"ChangeLayoutSection":"NewSlideSection",ExternalGalleryId:c?"ChangeLayoutGallery":"NewSlideGallery",GalleryStyle:y,Width:3,Type:4,GallerySections:[]});
Array.add(m.ControlList,y);m=0;let G=!1;const U=a.length;Ba.a.J(512500178,822,50,"React Slide layout: Count of main masters :{0}",U);if(!U||1===U&&a&&a[0]&&!a[0].InContent)return Ba.a.J(512500177,822,10,"React Slide layout rendered empty as main masters not loaded; Type: IsChangelayout:{0} cMainMasters: {1} InContent: {2} ",c,U,1===U&&!!a&&!!a[0]&&a[0].InContent),h;for(var ja=0;ja<U;ja++)a[ja].Id===b&&(m=ja,G=!0);G&&(b=this.I$g(a[m],b,c),y.GallerySections.push(b));for(b=0;b<U;b++)G&&b===m||(ja=this.I$g(a[b],
a[b].Id,c),y.GallerySections.push(ja));return h}I$g(a,b,c){const h=Object.assign(new WQ.a,{SectionId:b.toString(),Title:a.Name,GalleryButtons:[]});if(!(a.InContent&&this.Gu.KO&&this.Gu.KO.Hb(a.Id)))return Ba.a.J(512500176,822,50,"React Slide layout: Gallery section rendered empty as main masters not loaded;Type: IsChangelayout:{0} , mainMaster.InContent: {1} , presentatonresourcemanager contains main master : {2} ",c,a.InContent,!!this.Gu.KO&&this.Gu.KO.Hb(a.Id)),h;a=a.ContentMasters;if(!a)return Ba.a.J(512500175,
822,50,"React Slide layout: Gallery section rendered empty as content master is null ;Type: IsChangelayout:{0} ",c),h;const m=a.length;for(let y=0;y<m;y++){const G=a[y];!G||!this.tqc()&&this.Sb.cab(G)||Array.add(h.GalleryButtons,this.Avb(G,b,c))}return h}HDa(a,b,c){return Rd.a(Si.UBf)?(c?"ChangeLayoutButton_":"NewSlideLayoutButton_")+a+"_"+b:a+"_"+b}Avb(a,b,c){const h=a.Id,m=this.HDa(b.toString(),h.toString(),c),y={},G={},U=this.r8d();G.width=U.width.toString()+"px";G.height=U.height.toString()+"px";
Rd.a("ReactNewSlideLayoutIconBorderFix")||(G.border="#858585 1px solid");y.root=G;return Object.assign(new ZD.a,{Id:m,ExternalId:m,Icon:this.o5b(b,h),Command:c?"3430900587":"1579226270",QueryCommand:Rd.a("NewSlideLayoutShowCurrentLayout")?c?"630989293":"2230133927":null,LabelText:a.Name,FullIconStyle:y,Alt:a.Name})}y8f(a,b,c){if(this.fc.PN(this.Vb.Cf))return 16;b=this.Sb.xI();if(!b)return 8;let h=null;if(this.Ga.tC){var m=this.pa.We();1<=m.length&&(m.sort((G,U)=>G.oe-U.oe),a!==M.a.QFb&&(h=m[m.length-
1]))}else a!==M.a.QFb&&(h=this.ua.Ba);if(this.fc.$c(h))return 16;let y;({hj:m,Bn:y}=this.mRc(b,this.ua.Ba));if(!this.Dlb(b,m))return 8;if(1===c)return 32;c=this.$z.kOc(Object(ua.a)(116,h),m,y,a);this.Oqf(m,y);c.XN||this.fc.Zv(c,a);return 32}msj(a,b,c,h,m){if(this.fc.PN(this.Vb.Cf))return 16;if(1===c)return 32;if(!m)return 8;c=m.slideId;b=m.Dek;m=m.Eyi;h=null;this.Ga.tC?(c=this.pa.We(),1<=c.length&&(c.sort((y,G)=>y.oe-G.oe),h=c[c.length-1])):h=this.Sb.zl(c);c=this.$z.kOc(h,b,m,a);this.Oqf(b,m);c.XN||
this.fc.Zv(c,a);return 32}dispose(){this.Gu.YTk(Object(F.a)(this,this.h7g,"openIgnoredDialog"));this.Tva=null}UWc(a,b){const c=this.ua.Ba;let h=lc.a.empty;c&&(h=c.Cb);const m=this.Sb.xI();m&&("0"===a||"0"===b?{hj:a,Bn:b}=this.mRc(m,c):(a=parseInt(a),b=parseInt(b)),this.ia.La(M.a.wcd,2,new AE(h,a,b)))}Stj(a,b,c,h,m){if(1===c)return 32;if(!m||!({masterId:c,layoutId:b}=this.y1e(m.SourceControlId)).returnValue)return 8;h=this.ua.Ba;a=lc.a.empty;h&&(a=h.Cb);m=this.Sb.xI();if(!m)return 8;"0"===c||"0"===
b?{hj:c,Bn:b}=this.mRc(m,h):(c=parseInt(c),b=parseInt(b));Ba.a.J(512500172,822,50,"SlideLayoutActor:: React New Slide Dropdown invoked command to insert new slide.");return this.ia.La(M.a.wcd,2,new AE(a,c,b))}mRc(a,b){let c,h;h=c=0;if(!this.PTi(a))return{hj:c,Bn:h};if(b){c=b.hj;if(!c)return{hj:c,Bn:h};if(!this.Ga.z$b||this.lUi(c)){h=b.Bn;if(!h)return{hj:c,Bn:h};if(b.QUa)for(b=0;b<a.length;b++)if(a[b].Id===c&&1<a[b].ContentMasters.length){h=a[b].ContentMasters[1].Id;break}}}else c=a[0].Id,h=this.Ga.z$b?
0:a[0].ContentMasters[0].Id;return{hj:c,Bn:h}}sRf(a,b,c){if(1===a)return 32;a=this.y1e(b.SourceControlId);if(!a.returnValue)return 8;a.layoutId&&"0"!==a.layoutId&&(b[am.a.On]=a.layoutId===(c?this.XRg.toString():this.YRg.toString()));return 32}Thd(a,b,c,h,m){return this.sRf(c,m,!1)}wLe(a,b,c,h,m){return this.sRf(c,m,!0)}y1e(a){let b,c;c=b=null;if(!a)return Ba.a.J(512500171,822,10,"SlideLayoutActor::Unable to get master id and layout id from action data"),{returnValue:!1,masterId:b,layoutId:c};a=a.split("_");
const h=Rd.a(Si.UBf),m=h?1:0,y=h?2:1;if(!a||a.length!==(h?3:2))return Ba.a.J(512500170,822,10,"SlideLayoutActor::Unable to get master id and layout id from action data"),{returnValue:!1,masterId:b,layoutId:c};b=a[m];c=a[y];return{returnValue:!0,masterId:b,layoutId:c}}PTi(a){if(0===a.length)return!1;for(let b=0;b<a.length;++b)if(0!==a[b].ContentMasters.length)return!0;return!1}h7g(){this.wva&&(Ba.a.J(512500169,822,50,"SlideLayoutActor::OpenIgnoredDialog is auto-opening dialog {0}",this.wva===M.a.Jia?
"ChangeLayout":"NewSlide"),this.ia.processAction(this.wva,2));this.wva=0}Dlb(a,b){for(let c=0;c<a.length;c++)if(a[c].Id===b)return!0;return!1}Oqf(a,b){Nc.a.xk("MainMasterId",a.toString());Nc.a.xk("ContentMasterId",b.toString());const c=this.Sb.xI(),h=new Sys.StringBuilder;if(c){for(let m=0;m<c.length;m++)h.appendLine(String.format("MainMasterId={0}, ContentMasterCount={1}; ",c[m].Id,c[m].ContentMasters.length));Ba.a.J(512500168,813,50,"Insert slide with layout: MainMasterCount={0}. {1}. SelectedMainMasterId={2}, SelectedContentMasterId={3}",
c.length,h,a,b)}}fme(){return this.Gu.twf()}lUi(a){if(0===a)return!1;const b=this.Sb.Cvb();if(b&&0<b.length)for(const c of b)if(c.idField===a&&0<c.layoutCountField)return!0;return!1}hae(a,b,c,h){this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",!1)?1===b?a=32:2===b?(b={},h=!!h&&h.IsShadowMenuOpen,b.payload={["isShadowRendering"]:h},u.AFrameworkApplication.nHb.handleCommand(ed.ActionManager.v5a(a),b),h||c(),a=2):a=8:a=8;return a}static xKj(a){return a===Si.Jli||a===
Si.Kli||a===Si.Hli||a===Si.Lli||a===Si.Ili}static DWd(){return{"margin-top":"5px","max-width":"100px","font-size":"10px"}}}Si.Jli=1041;Si.Kli=1042;Si.Hli=2052;Si.Lli=1028;Si.Ili=3076;Si.Tyj="LayoutIcon";Si.UBf="ReactSlideLayoutButtonIdChange";Si.omi="SlideLayoutActor";Si.Gzf=145;Si.Gli=82;Si.Ozf=24;Si.zli=14;Si.Mli=5;Si.Dad=1;Object(n.a)(Si,"SlideLayoutActor",null,[227,106]);class mN{constructor(a,b,c,h,m,y,G,U,ja,va,Ta,fb,Db){this.WF=this.Z9=this.eeb=this.a$=null;this.ia=a;this.VQ=b;this.Fa=c;this.fc=
h;this.$z=m;this.Vb=y;this.ua=G;this.qc=U;this.Ie=ja;this.$pe=va(500,Object(F.a)(this,this.vgd,"performKeyboardThumbnailReorder"));this.pa=Ta;this.jn=fb;this.vea=Db}vb(){this.ia.ra(M.a.uic,xb.a.application,Object(F.a)(this,this.fsj,"handleMoveSlide"),4);this.ia.ra(M.a.lZg,xb.a.application,Object(F.a)(this,this.gsj,"handleMoveSlideById"),4);this.ia.ra(M.a.Sfb,nc.a.application,Object(F.a)(this,this.KUc,"handleReorderSlide"),4);this.ia.ra(M.a.Pfb,nc.a.application,Object(F.a)(this,this.KUc,"handleReorderSlide"),
4);this.ia.ra(M.a.Rfb,nc.a.application,Object(F.a)(this,this.KUc,"handleReorderSlide"),4);this.ia.ra(M.a.Qfb,nc.a.application,Object(F.a)(this,this.KUc,"handleReorderSlide"),4);this.ia.ra(M.a.vic,nc.a.application,Object(F.a)(this,this.Spj,"handleCommitPendingMoveSlideData"),4);this.ia.ra(M.a.wic,nc.a.application,Object(F.a)(this,this.mtj,"handleQueryCommitMoveSlideDataEnabled"),100)}De(){const a=this.Fa.Gc(Di.a.JD);a.bindAction(w.KeyInputManager.Na(z.a.K1,w.KeyInputManager.Le),M.a.Sfb);a.bindAction(w.KeyInputManager.Na(z.a.I1,
w.KeyInputManager.Le),M.a.Pfb);a.bindAction(w.KeyInputManager.Na(z.a.K1,w.KeyInputManager.Le|4),M.a.Rfb);a.bindAction(w.KeyInputManager.Na(z.a.I1,w.KeyInputManager.Le|4),M.a.Qfb)}gsj(a,b,c,h,m){a=this.ua.presentation;if(!a)throw Error.argumentNull("Presentation is null");if(!this.vea&&(this.jn&&1<this.pa.We().length||this.fc.dUa()))return 16;if(1===c)return 32;if(!m)return Ba.a.J(50348433,822,10,"HandleMoveSlideById with no null action data."),8;b=m.Xea;c=[];for(var y of b)(b=a.lC(y))?c.push(b):Ba.a.J(50348435,
822,15,"HandleMoveSlideById: slide node is null for given Sid:{0}, Cid:{1}.",y.sid,y.cid);y=m.Ba?a.lC(m.Ba):null;b=a.lC(m.oic);h=null;0<=m.sectionIndex&&(h=a.U3f(m.sectionIndex));return this.w8f(c,b,y,h,m.Qie)}fsj(a,b,c,h,m){return!this.vea&&(this.jn&&1<this.pa.We().length||this.fc.dUa())?16:1===c?32:m?this.w8f(m.Xea,m.oic,m.Ba,null,m.Qie):8}w8f(a,b,c,h,m){if(this.vea)for(var y of a)if(!y||this.fc.$c(this.qc.zl(y.Cb)))return 16;y=[];for(var G of a){if(!G)continue;const U=this.qc.zl(G.Cb);U?y.push(U):
Ba.a.J(591737178,822,15,"HandleMoveSlideById: slide node is null for given Sid:{0}, Cid:{1}.",G.Cb.sid,G.Cb.cid)}if(G=Nc.a.Ib)G.Nj=!0,G.pF||(G.pF=new Date),y&&G.Va("SlideCount",a.length.toString());G=null;m||(this.vea?c&&(G=c):a&&0<a.length&&(G=a[0]),G&&!this.Vb.Ba.Cb.equals(G.Cb)&&(this.Vb.Ba=this.qc.zl(G.Cb)));a=b?this.qc.zl(b.Cb):null;this.$z.BSi(y,a,h);return 32}KUc(a,b,c){if(this.VQ.v_||!this.ua.Ba||this.fc.$c(this.Vb.Cf)||!this.vea&&this.jn&&1<this.pa.We().length)return 16;if(1===c)return 32;
if(this.vea){b=this.pa.We();if(!b||!b.length)return 16;this.aql(b,a)}else this.Wpl(this.ua.Ba,a);return 32}Spj(a,b,c){if(this.fc.$c(this.Vb.Cf)||!this.tCf())return 16;if(1===c)return 32;this.vgd();return 32}mtj(){return this.a$?32:16}orb(a){if(!a||!a.length)return!1;if(1<a.length)for(let b=0;b<a.length-1;b++)if(1!==a[b+1].slideIndex-a[b].slideIndex)return!1;return!0}Wpl(a,b){var c=this.ua.presentation;if(!c)throw Error.argumentNull("Presentation is null");var h=this.Ie.XY;if(!(1>=h)){var m=!1;this.eeb||
(this.eeb=a,this.WF=c.slides||[],m=!0);a=-1;for(c=0;c<h;c++)if(this.WF[c]&&this.eeb.Cb.equals(this.WF[c].Cb)){a=c;break}if((b!==M.a.Sfb&&b!==M.a.Rfb||a)&&(b!==M.a.Pfb&&b!==M.a.Qfb||a!==h-1)){switch(b){case M.a.Sfb:b=a-1;break;case M.a.Pfb:b=a+1;break;case M.a.Rfb:b=0;break;case M.a.Qfb:b=h-1;break;default:return}Array.removeAt(this.WF,a);Array.insert(this.WF,b,this.eeb);for(m=0;m<h;m++)this.WF[m]?this.WF[m].oe=m:Ba.a.J(576758465,822,50,"Attempted to set ThumbnailSlideIndex on a null slide - slide {0} of {1} is null",
m,h);this.Ie.bya(b);h=new Hx(!0,[this.eeb],0<b?this.WF[b-1]:null);this.zwf(h)}else m&&(this.WF=this.eeb=null)}}aql(a,b){var c=this.ua.presentation;if(!c)throw Error.argumentNull("Presentation is null");var h=this.Ie.XY;if(!(1>=h)&&(a.sort((y,G)=>y.slideIndex-G.slideIndex),this.orb(a))){var m=!1;this.Z9||(this.Z9=a,this.WF=c.slides||[],m=!0);a=this.sTc(this.Z9[0],this.WF);c=this.sTc(this.Z9[this.Z9.length-1],this.WF);if((b!==M.a.Sfb&&b!==M.a.Rfb||a)&&(b!==M.a.Pfb&&b!==M.a.Qfb||c!==h-1)){m=null;switch(b){case M.a.Sfb:m=
0<=a-2?this.WF[a-2]:null;b=a-1;break;case M.a.Pfb:b=a+this.Z9.length<h?a+this.Z9.length:h-1;m=this.WF[b];break;case M.a.Rfb:m=null;b=0;break;case M.a.Qfb:m=this.WF[h-1];b=h-1;break;default:return}for(a=this.Z9.length-1;0<=a;a--)this.zbi(this.Z9[a],m);for(a=0;a<h;a++)this.WF[a]?this.WF[a].oe=a:Ba.a.J(576758466,822,50,"Attempted to set ThumbnailSlideIndex on a null slide - slide {0} of {1} is null",a,h);this.Ie.bya(b);h=new Hx(!0,this.Z9,m);this.zwf(h)}else m&&(this.WF=this.Z9=null)}}zbi(a,b){const c=
this.sTc(a,this.WF);Array.removeAt(this.WF,c);b=this.sTc(b,this.WF)+1;Array.insert(this.WF,b,a)}sTc(a,b){if(a&&b)for(let c=0;c<b.length;c++)if(a.Cb.equals(b[c].Cb))return c;return-1}Kei(a,b){if(!a||!b)return a!==b?!1:!0;if(a.length!==b.length)return!1;for(const c of a){a=!1;for(const h of b)if(c&&h&&c.Cb.equals(h.Cb)){a=!0;break}if(!a)return!1}return!0}zwf(a){if(!a)throw Error.argumentNull("moveData");this.vea?this.Kei(this.Z9,a.Xea)||this.vgd():this.a$&&this.a$.Xea&&a.Xea&&this.a$.Xea[0]&&a.Xea[0]&&
!this.a$.Xea[0].Cb.equals(a.Xea[0].Cb)&&this.vgd();this.a$=a;this.$pe.perform()}vgd(){if(this.tCf()){var a=this.a$;this.Z9=this.eeb=this.a$=null;Array.clear(this.WF);this.ia.La(M.a.uic,2,a)}}tCf(){const a=this.ua.presentation;if(!a)throw Error.argumentNull("Presentation is null");if(!this.a$)return!1;let b=!0,c=!this.a$.oic;for(let h=0;h<this.a$.Xea.length;h++)b=!!a.lC(this.a$.Xea[h].Cb)&&b;c||(c=!!a.lC(this.a$.oic.Cb));return b&&c}}Object(n.a)(mN,"SlideMoveActor",null,[227]);class Vx extends Zw.a{constructor(){super();
this.TableStyles=this.TableCellStyles=null;this.columns=0}}Object(n.a)(Vx,"TableGalleryButtonProps",Zw.a,[]);class nN extends Vx{constructor(){super()}get Type(){return 8}}Object(n.a)(nN,"ChangeColorsGalleryButtonProps",Vx,[]);class oN{constructor(){this.hasMath=this.fReverseEnabled=this.fReverseChecked=!1;this.SemanticNodes=null;this.SmartArtLayout=0}}Object(n.a)(oN,"SmartArtInfo",null,[]);var ct=d(488);class Gi{constructor(a,b,c){this.TF=a;this.U$j=b;this.fbk=c}get id(){return this.TF}get parameter(){return this.U$j}get Ikh(){return this.fbk}}
Object(n.a)(Gi,"SmartArtColorInfo",null,[]);class pN{constructor(a,b,c,h,m,y,G,U,ja,va,Ta,fb){this.iq=[];this.ia=a;this.fc=b;this.ob=c;this.Jb=h;this.Fa=m;this.ua=y;this.Hu=G;this.Sb=U;this.Fb=va;this.Wj=Ta;this.Ea=fb;this.nBk()}vb(){this.ia.ra(M.a.KEa,xb.a.view,Object(F.a)(this,this.zrj,"handleInsertSmartArt"),4);this.ia.ra(M.a.Cwh,xb.a.application,Object(F.a)(this,this.Ruj,"handleSmartArtToolsTabViewHandler"),4);this.ia.ra(M.a.TZb,xb.a.application,Object(F.a)(this,this.Hpj,"handleChangeSmartArtLayout"),
4);this.ia.ra(M.a.L$g,xb.a.application,Object(F.a)(this,this.btj,"handlePopulateSmartArtColorStyles"),96);this.ia.ra(M.a.SZb,xb.a.application,Object(F.a)(this,this.Fpj,"handleChangeSmartArtColor"),4);this.ia.ra(M.a.XBf,xb.a.application,Object(F.a)(this,this.Gpj,"handleChangeSmartArtColorAnchor"),4);this.ia.ra(M.a.LK,xb.a.application,Object(F.a)(this,this.Ipj,"handleChangeSmartArtStyle"),4);this.ia.ra(M.a.Qxa,xb.a.application,Object(F.a)(this,this.guj,"handleResetSmartArt"),4);this.ia.ra(M.a.VQe,xb.a.application,
Object(F.a)(this,this.kuj,"handleReverseSmartArt"),4);this.ia.ra(M.a.eid,xb.a.application,Object(F.a)(this,this.rtj,"handleQueryReverseSmartArt"),97);this.ia.ra(M.a.wOf,xb.a.application,Object(F.a)(this,this.zqj,"handleEditSmartArtText"),4);this.ia.ra(M.a.Jhd,xb.a.application,Object(F.a)(this,this.ntj,"handleQueryEditSmartArtText"),96)}De(){}zrj(a,b,c,h,m){b=this.ua.Ba;if(!b||this.fc.$c(b))return 16;if(1===c)return 32;this.cgd(m,a);if(!m)return 8;if((c=b.n3(this.ob.Xd()))&&this.fc.$c(c))return 16;
if(!this.Wj.JF(b,1))return this.Wj.hG(b),16;const y=this.Gij(b,c,m);m=this.Jb.zd(15,void 0,()=>{this.ob.Vx();this.ob.Qh();this.Fa.Ed()},()=>{this.ob.selectShape(Object(ua.a)(4,y),!0)});try{m.nc(b),m.jd=a,c&&b.KU([c]),b.UB(Object(ua.a)(4,y))}finally{m&&m.dispose()}this.Hu.NF=Object(ua.a)(4,y);return 32}Ruj(){return Object(ua.a)(433,this.lza())?32:16}Hpj(a,b,c,h,m){b=this.lza();if(!b||this.fc.$c(b))return 16;if(1===c)return 32;c=this.ob.Xd();for(var y of c){if(y.Rf){b=y;break}if(y.get_smartArtModelId()){b=
this.Ea.vr(y);this.ob.Z7(y);this.ob.selectShape(b,!1);break}}this.cgd(m,a);y=this.Jb.zd(15,void 0,()=>{this.ob.ij();this.Fa.Ed()});try{y.nc(b),y.jd=a,Object(ua.a)(433,b).ensureModelData().get_elementCollection().documentElement.Coa=m}finally{y&&y.dispose()}return 32}btj(a,b,c,h,m){if(!this.lza())return 16;a=this.ob.sk();if(!a)return 16;if(1===c)return 32;if(!m)return 8;m.MenuId&&"color"===m.MenuId?m.PopulationXML=this.jki(a):m.MenuItems=this.aki(a);return 32}Fpj(a,b,c,h,m){b=this.lza();if(!b||this.fc.$c(b))return 16;
if(1===c)return 32;this.cgd(m,a);c=this.Jb.zd(15,void 0,()=>{this.ob.ij();this.Fa.Ed()});try{c.nc(b),c.jd=a,Object(ua.a)(433,b).ensureModelData().get_elementCollection().documentElement.Cya=m}finally{c&&c.dispose()}return 32}Gpj(){return this.lza()?32:16}Ipj(a,b,c,h,m){b=this.lza();if(!b||this.fc.$c(b))return 16;if(1===c)return 32;this.cgd(m,a);c=this.Jb.zd(15,void 0,()=>{this.ob.ij();this.Fa.Ed()});try{c.nc(b),c.jd=a,Object(ua.a)(433,b).ensureModelData().get_elementCollection().documentElement.Dya=
m}finally{c&&c.dispose()}return 32}guj(a,b,c){b=Object(ua.a)(433,this.lza());if(!b||this.fc.$c(Object(ua.a)(4,b)))return 16;if(1===c)return 32;c=this.Jb.zd(15,void 0,()=>{this.ob.ij();this.Fa.Ed()});try{c.nc(b),c.jd=a,b.Qxa=!0}finally{c&&c.dispose()}return 32}kuj(a,b,c){b=this.lza();if(!b||!b.zke||this.fc.$c(b))return 16;if(1===c)return 32;c=new oN;c.fReverseEnabled=b.zke;c.fReverseChecked=!b.yke;const h=this.Jb.zd(15,void 0,()=>{this.ob.ij();this.Fa.Ed()});try{h.nc(b),h.jd=a,Object(ua.a)(433,b).ensureModelData().get_elementCollection().documentElement.smartArtInfo=
c}finally{h&&h.dispose()}return 32}rtj(a,b,c,h,m){a=this.lza();a=!!a&&a.yke;if(!Object(za.a)(Ph.a,m))return 8;m.Qf(a);return 32}zqj(a,b,c){a=this.lza();if(!a||this.fc.$c(a))return 16;if(1===c)return 32;this.ia.La(M.a.LPa,2,new Al.a(a,!0,null));return 32}ntj(a,b,c,h,m){a=this.ob.pC();if(!Object(za.a)(Ph.a,m))return 8;m.Qf(a);return 32}Gij(a,b,c){if(!a)return null;const h=a.Pt();let m;m=b?b.twb(xf.a.cY,xf.a.h5):this.Sb.pta(xf.a.cY,xf.a.h5);return a.eXd(!0,0,b,c,m.x,m.y,xf.a.cY,xf.a.h5,h+1)}lza(){const a=
this.ob.Xd();for(const b of a){if(b.Rf)return b;if(b.get_smartArtModelId())return this.Ea.vr(b)}return null}nBk(){Array.add(this.iq,new Gi(0,"accent0_1,mainScheme",ResourceStrings.L_SmartArtDark1Outline));Array.add(this.iq,new Gi(1,"accent0_2,mainScheme",ResourceStrings.L_SmartArtDark2Outline));Array.add(this.iq,new Gi(2,"accent0_3,mainScheme",ResourceStrings.L_SmartArtDark2Fill));Array.add(this.iq,new Gi(3,"colorful1,colorful",ResourceStrings.L_SmartArtColorful1));Array.add(this.iq,new Gi(4,"colorful2,colorful",
ResourceStrings.L_SmartArtColorful2));Array.add(this.iq,new Gi(5,"colorful3,colorful",ResourceStrings.L_SmartArtColorful3));Array.add(this.iq,new Gi(6,"colorful4,colorful",ResourceStrings.L_SmartArtColorful4));Array.add(this.iq,new Gi(7,"colorful5,colorful",ResourceStrings.L_SmartArtColorful5));Array.add(this.iq,new Gi(8,"accent1_1,accent1",ResourceStrings.L_SmartArtColoredOutline1));Array.add(this.iq,new Gi(9,"accent1_2,accent1",ResourceStrings.L_SmartArtColoredFill1));Array.add(this.iq,new Gi(10,
"accent1_3,accent1",ResourceStrings.L_SmartArtGradientRange1));Array.add(this.iq,new Gi(11,"accent1_4,accent1",ResourceStrings.L_SmartArtGradientLoop1));Array.add(this.iq,new Gi(12,"accent1_5,accent1",ResourceStrings.L_SmartArtTransparentGradientRange1));Array.add(this.iq,new Gi(13,"accent2_1,accent2",ResourceStrings.L_SmartArtColoredOutline2));Array.add(this.iq,new Gi(14,"accent2_2,accent2",ResourceStrings.L_SmartArtColoredFill2));Array.add(this.iq,new Gi(15,"accent2_3,accent2",ResourceStrings.L_SmartArtGradientRange2));
Array.add(this.iq,new Gi(16,"accent2_4,accent2",ResourceStrings.L_SmartArtGradientLoop2));Array.add(this.iq,new Gi(17,"accent2_5,accent2",ResourceStrings.L_SmartArtTransparentGradientRange2));Array.add(this.iq,new Gi(18,"accent3_1,accent3",ResourceStrings.L_SmartArtColoredOutline3));Array.add(this.iq,new Gi(19,"accent3_2,accent3",ResourceStrings.L_SmartArtColoredFill3));Array.add(this.iq,new Gi(20,"accent3_3,accent3",ResourceStrings.L_SmartArtGradientRange3));Array.add(this.iq,new Gi(21,"accent3_4,accent3",
ResourceStrings.L_SmartArtGradientLoop3));Array.add(this.iq,new Gi(22,"accent3_5,accent3",ResourceStrings.L_SmartArtTransparentGradientRange3));Array.add(this.iq,new Gi(23,"accent4_1,accent4",ResourceStrings.L_SmartArtColoredOutline4));Array.add(this.iq,new Gi(24,"accent4_2,accent4",ResourceStrings.L_SmartArtColoredFill4));Array.add(this.iq,new Gi(25,"accent4_3,accent4",ResourceStrings.L_SmartArtGradientRange4));Array.add(this.iq,new Gi(26,"accent4_4,accent4",ResourceStrings.L_SmartArtGradientLoop4));
Array.add(this.iq,new Gi(27,"accent4_5,accent4",ResourceStrings.L_SmartArtTransparentGradientRange4));Array.add(this.iq,new Gi(28,"accent5_1,accent5",ResourceStrings.L_SmartArtColoredOutline5));Array.add(this.iq,new Gi(29,"accent5_2,accent5",ResourceStrings.L_SmartArtColoredFill5));Array.add(this.iq,new Gi(30,"accent5_3,accent5",ResourceStrings.L_SmartArtGradientRange5));Array.add(this.iq,new Gi(31,"accent5_4,accent5",ResourceStrings.L_SmartArtGradientLoop5));Array.add(this.iq,new Gi(32,"accent5_5,accent5",
ResourceStrings.L_SmartArtTransparentGradientRange5));Array.add(this.iq,new Gi(33,"accent6_1,accent6",ResourceStrings.L_SmartArtColoredOutline6));Array.add(this.iq,new Gi(34,"accent6_2,accent6",ResourceStrings.L_SmartArtColoredFill6));Array.add(this.iq,new Gi(35,"accent6_3,accent6",ResourceStrings.L_SmartArtGradientRange6));Array.add(this.iq,new Gi(36,"accent6_4,accent6",ResourceStrings.L_SmartArtGradientLoop6));Array.add(this.iq,new Gi(37,"accent6_5,accent6",ResourceStrings.L_SmartArtTransparentGradientRange6))}aki(a){const b=
Object.assign(new Mk.a,{Id:"ControlsChangeSmartArtColor",MenuSectionList:[]}),c=Object.assign(new di.a,{Id:"MenuSectionChangeSmartArtColor",ControlList:[]});Array.add(b.MenuSectionList,c);const h=Zi.Color.Ti(a.Ne.Light1),m=Zi.Color.Ti(a.Ne.Dark1),y=Zi.Color.Ti(a.Ne.Light2),G=Zi.Color.Ti(a.Ne.Dark2),U=Array(6);U[0]=Zi.Color.Ti(a.Ne.Accent1);U[1]=Zi.Color.Ti(a.Ne.Accent2);U[2]=Zi.Color.Ti(a.Ne.Accent3);U[3]=Zi.Color.Ti(a.Ne.Accent4);U[4]=Zi.Color.Ti(a.Ne.Accent5);U[5]=Zi.Color.Ti(a.Ne.Accent6);a=0;
Array.add(c.ControlList,({F7b:a}=this.Vji(a,h,m,y,G)).returnValue);Array.add(c.ControlList,({F7b:a}=this.Sii(a,h,U)).returnValue);Array.addRange(c.ControlList,({F7b:a}=this.Dii(a,h,U)).returnValue);return b}Vji(a,b,c,h,m){const y=Object.assign(new qq.a,{Id:"PrimaryThemeColorsGallery",ExternalId:"ChangeSmartArtColorGalleryPrimary",ExternalGalleryId:"ChangeSmartArtColorGallery",Title:ResourceStrings.L_PrimaryThemeColors,Type:8,Width:5,ElementDimensions:"Size64by48",GalleryItems:[]});Array.add(y.GalleryItems,
this.Ohc(b,c,a++));Array.add(y.GalleryItems,this.Ohc(b,m,a++));Array.add(y.GalleryItems,this.Ohc(m,h,a++));return{returnValue:y,F7b:a}}Sii(a,b,c){const h=Object.assign(new qq.a,{Id:"ColorfulGallery",ExternalId:"ChangeSmartArtColorGalleryColorful",ExternalGalleryId:"ChangeSmartArtColorGallery",Title:ResourceStrings.L_Colorful,Type:8,Width:5,ElementDimensions:"Size64by48",GalleryItems:[]});Array.add(h.GalleryItems,this.kbd(c[1],c[2],c[3],c[4],c[5],c[1],b,a++));for(let m=1;5>m;m++)Array.add(h.GalleryItems,
this.TBe(c[m],c[m+1],b,a++));return{returnValue:h,F7b:a}}Dii(a,b,c){const h=[];for(let G=0;6>G;G++){const U=Object.assign(new qq.a,{Id:"ColorfulGallery"+(G+1),ExternalId:"ChangeSmartArtColorGalleryAccent"+(G+1),ExternalGalleryId:"ChangeSmartArtColorGallery",Title:String.format(ResourceStrings.L_AccentFormat,G+1),Type:8,Width:5,ElementDimensions:"Size64by48",GalleryItems:[]});var m=new Zi.Color;m.r=m.g=m.b=255;var y=new Zi.Color;m=Zi.Color.PZ(c[G],m,.5);y=Zi.Color.PZ(c[G],y,.25);Array.add(U.GalleryItems,
this.Ohc(b,c[G],a++));Array.add(U.GalleryItems,this.Ohc(c[G],b,a++));Array.add(U.GalleryItems,this.TBe(c[G],m,b,a++));Array.add(U.GalleryItems,this.Rek(y,c[G],m,b,a++));Array.add(U.GalleryItems,this.TBe(c[G],m,b,a++));Array.add(h,U)}return{returnValue:h,F7b:a}}Ohc(a,b,c){return this.kbd(a,a,a,a,a,a,b,c)}TBe(a,b,c,h){const m=ct.a.PZ(a,b,2/6),y=ct.a.PZ(a,b,.5),G=ct.a.PZ(a,b,4/6),U=ct.a.PZ(a,b,5/6);return this.kbd(a,m,y,G,U,b,c,h)}Rek(a,b,c,h,m){const y=Zi.Color.PZ(b,c,.5);return this.kbd(a,b,y,c,y,
b,h,m)}kbd(a,b,c,h,m,y,G,U){U=this.G4f(U);const ja="ChangeSmartArtColor__"+U.parameter.replace(",","__");return Object.assign(new nN,{Id:ja,ExternalId:ja,MenuItemId:U.parameter,Command:"367274693",QueryCommand:"1384172858",Alt:U.Ikh,TableCellStyles:[this.lFb(a,G),this.lFb(b,G),this.lFb(c,G),this.lFb(h,G),this.lFb(m,G),this.lFb(y,G)]})}lFb(a,b){const c={};c.backgroundColor=this.AEf(a);c.border=String.format("1px solid {0}",this.AEf(b));return c}AEf(a){return String.format("rgb( {0:d},{1:d},{2:d} )",
a.r,a.g,a.b)}jki(a){const b=new Sys.StringBuilder;b.append('<Menu Id="ControlsChangeSmartArtColor">');const c=new Zi.Color;c.r=c.g=c.b=255;const h=new Zi.Color,m=Zi.Color.Ti(a.Ne.Light1);var y=Zi.Color.Ti(a.Ne.Dark1),G=Zi.Color.Ti(a.Ne.Light2),U=Zi.Color.Ti(a.Ne.Dark2);const ja=Array(6);ja[0]=Zi.Color.Ti(a.Ne.Accent1);ja[1]=Zi.Color.Ti(a.Ne.Accent2);ja[2]=Zi.Color.Ti(a.Ne.Accent3);ja[3]=Zi.Color.Ti(a.Ne.Accent4);ja[4]=Zi.Color.Ti(a.Ne.Accent5);ja[5]=Zi.Color.Ti(a.Ne.Accent6);a=0;b.append(String.format('<MenuSection Id="PrimaryThemeColors" Title="{0}">',
ResourceStrings.L_PrimaryThemeColors));b.append('<Gallery Id="PrimaryThemeColorsGallery" ElementDimensions="Size64by48" Width="5">');this.Nhc(b,m,y,a++);this.Nhc(b,m,U,a++);this.Nhc(b,U,G,a++);b.append("</Gallery>");b.append("</MenuSection>");b.append(String.format('<MenuSection Id="Colorful" Title="{0}">',ResourceStrings.L_Colorful));b.append('<Gallery Id="ColorfulGallery" ElementDimensions="Size64by48" Width="5">');this.gbd(b,ja[1],ja[2],ja[3],ja[4],ja[5],ja[1],m,a++);for(y=1;5>y;y++)this.PBe(b,
ja[y],ja[y+1],m,a++);b.append("</Gallery>");b.append("</MenuSection>");for(y=0;6>y;y++)G=String.format(ResourceStrings.L_AccentFormat,y+1),b.append(String.format('<MenuSection Id="Accent{0}" Title="{1}">',y+1,G)),b.append(String.format('<Gallery Id="ColorfulGallery{0}" ElementDimensions="Size64by48" Width="5">',y+1)),G=Zi.Color.PZ(ja[y],c,.5),U=Zi.Color.PZ(ja[y],h,.25),this.Nhc(b,m,ja[y],a++),this.Nhc(b,ja[y],m,a++),this.PBe(b,ja[y],G,m,a++),this.Mek(b,U,ja[y],G,m,a++),this.PBe(b,ja[y],G,m,a++),b.append("</Gallery>"),
b.append("</MenuSection>");b.append("</Menu>");return b.toString()}Nhc(a,b,c,h){this.gbd(a,b,b,b,b,b,b,c,h)}PBe(a,b,c,h,m){const y=ct.a.PZ(b,c,2/6),G=ct.a.PZ(b,c,.5),U=ct.a.PZ(b,c,4/6),ja=ct.a.PZ(b,c,5/6);this.gbd(a,b,y,G,U,ja,c,h,m)}Mek(a,b,c,h,m,y){const G=Zi.Color.PZ(c,h,.5);this.gbd(a,b,c,G,h,G,c,m,y)}gbd(a,b,c,h,m,y,G,U,ja){ja=this.G4f(ja);a.append('<GalleryButton Id="');a.append(ja.parameter);a.append('" Command="');a.append(M.a.SZb.toString());a.append('" QueryCommand="');a.append(M.a.wc.toString());
a.append('" InnerHTML="');a.append("&lt;div style=&quot;width:64px;height:48px;position:relative;font-size:1px;&quot;&gt;");this.mFb(a,b,U,8,-1);this.mFb(a,c,U,34,-1);this.mFb(a,h,U,8,16);this.mFb(a,m,U,34,16);this.mFb(a,y,U,8,33);this.mFb(a,G,U,34,33);a.append("&lt;/div&gt;");a.append('" Alt="');a.append(ja.Ikh);a.append('"/>')}cgd(a,b){a.Uri=b===M.a.SZb?"urn:microsoft.com/office/officeart/2005/8/colors/"+a.Uri:b===M.a.LK?"3d8"===a.Uri?"urn:microsoft.com/office/officeart/2009/2/quickstyle/3d8":"urn:microsoft.com/office/officeart/2005/8/quickstyle/"+
a.Uri:"timeline"===a.Category?"BasicTimeline"===a.Uri||"HexagonTimeline"===a.Uri||"RoundedRectangleTimeline"===a.Uri||"AccentHomeChevronProcess"===a.Uri?"urn:microsoft.com/office/officeart/2016/7/layout/"+a.Uri:"urn:microsoft.com/office/officeart/2017/3/layout/"+a.Uri:"urn:microsoft.com/office/officeart/2005/8/layout/"+a.Uri}G4f(a){let b;for(let c=0;c<this.iq.length;c++)if(b=this.iq[c],b.id===a)return b;return new Gi(-1,"","")}mFb(a,b,c,h,m){a.append("&lt;div style=&quot;");b.j1d()||(b=String.format("rgb( {0:d},{1:d},{2:d} )",
b.r,b.g,b.b),a.append("background-color:"),a.append(b),a.append(";"));a.append("left:");a.append(h.toString());a.append("px;top:");a.append(m.toString());a.append("px;width:22px;height:14px;position:absolute;");c.j1d()||(c=String.format("rgb( {0:d},{1:d},{2:d} )",c.r,c.g,c.b),a.append("border:solid 1px "),a.append(c),a.append(";"));a.append("&quot;&gt;&lt;/div&gt;")}}Object(n.a)(pN,"SmartArtActor",null,[227]);class Wx{constructor(a,b,c,h){this.fAe="BottomOverlaid";this.ia=a;this.Hc=h;this.qc=b;this.Lc=
c;this.gAe="productionSpokenLanguages_"+this.Hc.Eoa;this.hAe="productionSubtitleLanguages_"+this.Hc.hza}vb(){Ba.a.J(512500167,822,50,"SubtitleActor::RegisterActions - OptIn: True, FUseSubtitles:{0}",this.Hc.Kh);this.ia.ra(M.a.BZa,nc.a.application,Object(F.a)(this,this.BZa,"querySubtitleIsEnabled"),96);this.ia.ya(M.a.HLa,nc.a.application,Object(F.a)(this,this.HLa,"toggleUseSubtitles"));this.ia.ra(M.a.Jid,nc.a.application,Object(F.a)(this,this.NHk,"querySubtitleSettingsIsEnabled"),96);this.ia.ra(M.a.ahb,
nc.a.application,Object(F.a)(this,this.ahb,"populateTranscriptionSubtitleLanguage"),96);this.ia.ra(M.a.$gb,nc.a.application,Object(F.a)(this,this.$gb,"populateTranscriptionSpokenLanguage"),96);this.ia.ya(M.a.Sql,nc.a.application,Object(F.a)(this,this.ovj,"handleToggleTranscriptionSpokenLanguage"));this.ia.ya(M.a.Tql,nc.a.application,Object(F.a)(this,this.pvj,"handleToggleTranscriptionSubtitleLanguage"));this.ia.ra(M.a.WMe,nc.a.application,Object(F.a)(this,this.WMe,"queryToggleTranscriptionSpokenLanguage"),
96);this.ia.ra(M.a.XMe,nc.a.application,Object(F.a)(this,this.XMe,"queryToggleTranscriptionSubtitleLanguage"),96);this.ia.ra(M.a.Khb,nc.a.application,Object(F.a)(this,this.Khb,"querySubtitlesBottomOverlay"),96);this.ia.ya(M.a.ENb,nc.a.application,Object(F.a)(this,this.ENb,"toggleSubtitlesBottomOverlay"));this.ia.ra(M.a.Lhb,nc.a.application,Object(F.a)(this,this.Lhb,"querySubtitlesTopOverlay"),96);this.ia.ya(M.a.FNb,nc.a.application,Object(F.a)(this,this.FNb,"toggleSubtitlesTopOverlay"));this.ia.ra(M.a.Jhb,
nc.a.application,Object(F.a)(this,this.Jhb,"querySubtitlesBelowSlide"),96);this.ia.ya(M.a.DNb,nc.a.application,Object(F.a)(this,this.DNb,"toggleSubtitlesBelowSlide"));this.ia.ra(M.a.Ihb,nc.a.application,Object(F.a)(this,this.Ihb,"querySubtitlesAboveSlide"),96);this.ia.ya(M.a.CNb,nc.a.application,Object(F.a)(this,this.CNb,"toggleSubtitlesAboveSlide"))}De(){}BZa(a,b,c,h,m){if(!m||!Object(za.a)(Ph.a,m))return 8;m.Qf(this.Hc.Kh);return 32}NHk(a,b,c,h,m){return 1===c?this.qc.Lj()?32:8:m&&"object"===typeof m?
this.Hc&&this.Hc.b3b?32:(Ba.a.J(512500164,822,10,"QuerySubtitleSettingsIsEnabled requires valid subtitleContext"),8):(Ba.a.J(512500165,822,10,"QuerySubtitleSettingsIsEnabled requires actionData"),8)}Khb(a,b,c,h,m){if(!m||!Object(za.a)(Ph.a,m))return Ba.a.J(512500163,822,10,"SubtitleActor::QuerySubtitlesBottomOverlay requires actionData"),8;m.Qf("BottomOverlay"===this.Hc.Ov);Ba.a.J(512500162,822,50,"SubtitleActor::QuerySubtitlesBottomOverlay: subtitles position is {0}",this.Hc.Ov);return 32}Lhb(a,
b,c,h,m){if(!m||!Object(za.a)(Ph.a,m))return 8;m.Qf("TopOverlay"===this.Hc.Ov);Ba.a.J(512500160,822,50,"SubtitleActor::QuerySubtitlesTopOverlay: subtitles position is {0}",this.Hc.Ov);return 32}Jhb(a,b,c,h,m){try{m&&m.Qf("BelowSlide"===this.Hc.Ov)}catch(y){Ba.a.J(512500131,822,10,"Exception in QuerySubtitlesBelowSlide: {0}.",y)}return 32}Ihb(a,b,c,h,m){try{m&&m.Qf("AboveSlide"===this.Hc.Ov)}catch(y){Ba.a.J(512500130,822,10,"Exception in QuerySubtitlesBelowSlide: {0}.",y)}return 32}HLa(a,b,c,h,m){if(1===
c)return this.qc.Lj()?32:8;if(!m||"object"!==typeof m)return 8;this.Hc.Kh&&(oi.a.SJ("PPTCaptionDiscoverabiltyDoNotShowAgain","true",oi.a.wJ)||Ba.a.J(512500128,822,10,"SubtitleActor::ToggleUseSubtitles - Failed to set cookie for discoverability opt out to true"));this.Hc.Kh=!this.Hc.Kh;Ba.a.J(512500127,822,50,"SubtitleActor::HandleToggleUseSubtitles: Changed UseSubtitles status to:{0}",this.Hc.Kh);Fc.App.Kb.mG({AlwaysUseSubtitles:"SplitButtonModel",UseSubtitles:"CheckboxModel"});return 32}ahb(a,b,
c,h,m){try{if(1===c)return 32;if(!m)return Ba.a.J(512500126,822,10,"PopulateTranscriptionSubtitleLanguage requires actionData"),8;this.J$g(m,!1)}catch(y){Ba.a.J(512500125,822,10,"Exception in PopulateTranscriptionSubtitleLanguage: {0}.",y)}return 32}$gb(a,b,c,h,m){try{if(1===c)return 32;if(!m)return Ba.a.J(512500124,822,10,"PopulateTranscriptionSpokenLanguage requires actionData"),8;this.J$g(m,!0)}catch(y){Ba.a.J(512500123,822,10,"Exception in PopulateTranscriptionSpokenLanguage: {0}.",y)}return 32}pvj(a,
b,c,h,m){try{if(m){this.Hc.hza=m.MenuItemId;this.Hc.clb=this.Hc.XTc();const y=m.SourceControlId;this.hAe!==y&&(a={},a[y]="ToggleButtonModel",a[this.hAe]="ToggleButtonModel",Fc.App.Kb.mG(a),this.hAe=y)}}catch(y){Ba.a.J(512500122,822,10,"Exception in HandleToggleTranscriptionSubtitleLanguage: {0}.",y)}return 32}XMe(a,b,c,h,m){try{m&&(m[Zh.a.On]=m.MenuItemId.toLowerCase()===this.Hc.hza.toLowerCase())}catch(y){Ba.a.J(512500121,822,10,"Exception in QueryToggleTranscriptionSubtitleLanguage: {0}.",y)}return 32}ovj(a,
b,c,h,m){try{if(m){this.Hc.Eoa=m.MenuItemId;const y=m.SourceControlId;this.gAe!==y&&(a={},a[y]="ToggleButtonModel",a[this.gAe]="ToggleButtonModel",Fc.App.Kb.mG(a),this.gAe=y)}}catch(y){Ba.a.J(512500120,822,10,"Exception in HandleToggleTranscriptionSpokenLanguage: {0}.",y)}return 32}WMe(a,b,c,h,m){try{m&&(m[Zh.a.On]=m.MenuItemId.toLowerCase()===this.Hc.Eoa.toLowerCase())}catch(y){Ba.a.J(512500119,822,10,"Exception in QueryToggleTranscriptionSpokenLanguage: {0}.",y)}return 32}ENb(a,b,c,h,m){if(1===
c)return 32;if(!m||"object"!==typeof m)return Ba.a.J(512500118,822,10,"SubtitleActor::ToggleSubtitlesBottomOverlay requires actionData"),8;m[Zh.a.On]&&(this.Hc.Ov="BottomOverlay",Ba.a.J(512500117,822,50,"SubtitleActor::ToggleSubtitlesBottomOverlay: Bottom overlay is enabled"));this.Jtd(m.SourceControlId);return 32}FNb(a,b,c,h,m){if(1===c)return 32;if(!m||"object"!==typeof m)return Ba.a.J(512500116,822,10,"SubtitleActor::ToggleSubtitlesTopOverlay requires actionData"),8;m[Zh.a.On]&&(this.Hc.Ov="TopOverlay",
Ba.a.J(512500115,822,50,"SubtitleActor::ToggleSubtitlesTopOverlay: Top overlay is enabled"));this.Jtd(m.SourceControlId);return 32}DNb(a,b,c,h,m){if(1===c)return 32;if(!m||"object"!==typeof m)return Ba.a.J(512500114,822,10,"SubtitleActor::ToggleSubtitlesBelowSlide requires actionData"),8;m[Zh.a.On]&&(this.Hc.Ov="BelowSlide",Ba.a.J(512500113,822,50,"SubtitleActor::ToggleSubtitlesBelowSlide: Below Slide is enabled"));this.Jtd(m.SourceControlId);return 32}CNb(a,b,c,h,m){if(1===c)return 32;if(!m||"object"!==
typeof m)return Ba.a.J(512500112,822,10,"SubtitleActor::ToggleSubtitlesAboveSlide requires actionData"),8;m[Zh.a.On]&&(this.Hc.Ov="AboveSlide",Ba.a.J(512500111,822,50,"SubtitleActor::ToggleSubtitlesAboveSlide: Above Slide is enabled"));this.Jtd(m.SourceControlId);return 32}J$g(a,b){a.MenuItems=Object.assign(new Mk.a,{Id:b?"SpokenLanguageList":"SubtitleLanguageList",MenuSectionList:[],UpdateDynamically:!0});b?((b=this.Hc.cZe)&&0<b.count&&(b=Wx.bJf(b,"productionSpokenLanguages",""),Array.add(a.MenuItems.MenuSectionList,
b)),(b=this.Hc.bZe)&&0<b.count&&(b=Wx.bJf(b,"previewSpokenLanguages",ResourceStrings.L_SubtitlesPreviewSpokenLanguageSectionTitle),Array.add(a.MenuItems.MenuSectionList,b))):(b=this.Hc.QMb)&&0<Da.a.count(b)&&(b=Wx.jGi(this.Hc.OXe),Array.add(a.MenuItems.MenuSectionList,b));a.PopulationXML=gj.l(a.MenuItems)}Jtd(a){if(this.fAe!==a){const b={};b[a]="ToggleButtonModel";b[this.fAe]="ToggleButtonModel";Fc.App.Kb.mG(b);this.fAe=a;this.Lc.sz(new Gp.a(1))}}static bJf(a,b,c){c=Object.assign(new di.a,{DisplayMode:"Menu",
Title:c,Id:b,ControlsId:"ctr"+b,ControlList:[]});for(let h of a)try{const m=h.toLowerCase(),y=Object.assign(new Sy.a,{Id:b+"_"+m,ExternalId:b+"_"+m,LabelText:Fa.a.ue(h).displayName,Command:"892576938",MenuItemId:m,QueryCommand:"1887433262",Visible:!0,AriaLabel:zc.a.rrb});Array.add(c.ControlList,y)}catch(m){Ba.a.J(512500110,822,10,"SubtitleActor::CreateSpokenLanaguageMenuSection Exception when trying to show language: {0}, e: {1}.",h,m)}return c}static jGi(a){const b=Object.assign(new di.a,{DisplayMode:"Menu",
Title:"",Id:"productionSubtitleLanguages",ControlsId:"ctrproductionSubtitleLanguages",ControlList:[]});for(let c of a)try{const h=Object.assign(new Sy.a,{Id:"productionSubtitleLanguages_"+c,ExternalId:"productionSubtitleLanguages_"+c,LabelText:Fa.a.ue(c).displayName,Command:"2717950896",MenuItemId:c,QueryCommand:"4282741576",Visible:!0,AriaLabel:zc.a.rrb});Array.add(b.ControlList,h)}catch(h){Ba.a.J(512500109,822,10,"SubtitleActor::CreateSubtitleLanaguageMenuSection Exception when trying to show language: {0}, e: {1}.",
c,h)}return b}}Object(n.a)(Wx,"SubtitleActor",null,[227]);var XQ=d(403);class Zn{constructor(a){this.Nx=this.Us=this.Zu=this.fK=this.eI=null;this.CZ=a}get OYb(){return this.fK||(this.fK=vb.a.instance.rb("Box4.IAutoCorrectRules"))}get $ba(){return this.Zu||(this.Zu=vb.a.instance.rb("Box4.IAutoCorrectScheduler"))}get BJ(){return this.eI||(this.eI=vb.a.instance.rb("Box4.Pages.IPageContentEditor"))}get wB(){return this.Nx||(this.Nx=vb.a.instance.rb("Box4.IOutlineEditor"))}get In(){return this.Us||(this.Us=
this.CZ())}hAb(a,b,c){if(this.wB&&Zn.kh){var h=tg.ContextSetEditor.s6d(b);a=h.node;Bb.SelectionEditor.Wl(h)&&(h=md.a.Kj(a,Ob.ParagraphReader.textLength(a)));var m=uc.a.language(uc.a.ps(h));h=rb.GraphIterator.nb(c.yg);Zn.Yl.iKa(h);var y=a=null;if(h)for(let G=h.Bb(1);G&&!y;G=h.Cj(1))Yi.OutlineReader.ZW(G)&&(y=G);if(h&&!y){if(!this.BJ||!this.wB)return;a=new t.GraphTransaction(7);a.yy(h);y=this.BJ.D0b(h);this.wB.Jnd(y,c.h6b());this.wB.JZ(h,!0);m&&(mc.OutlineElementNavigator.wi(h),h=md.a.Kj(h.currentNode,
0),Zn.kh.I_a(uc.a.ps(h),m))}m=yd.SelectionFactory.sj(y,!0);c.Lb.setSelection(m);Bb.SelectionEditor.Sg(b)&&(c=rb.GraphIterator.nb(b.node),c.Xu(),ii.OutlineNavigator.ild(c),this.OYb&&this.$ba&&Yi.OutlineReader.rC(c,b,!0)&&(b=this.OYb.f2d(b,-1,!1,z.a.Pq))&&this.$ba.gnh(b));this.In&&this.In.kw();a&&a.dispose()}}s0d(a,b,c){a=rb.GraphIterator.nb(c.yg);a=XQ.a(a);a=yd.SelectionFactory.sj(a,!1);c.Lb.setSelection(a)}static get kh(){return Zn.Kf||(Zn.Kf=vb.a.instance.rb("Box4.IFormattingEditor"))}static get instance(){return Zn.Ka||
(Zn.Ka=Zn.iC())}static iC(){return new Zn(()=>vb.a.instance.rb("Box4.IUndoManager"))}static get Yl(){return vy.PageNavigator.instance}}Zn.Ka=null;Zn.Kf=null;Object(n.a)(Zn,"TitleViewEditor",null,[]);class qu{constructor(a,b,c,h=null,m=null,y,G,U=null,ja=null){this.Us=null;this.Cof=!1;this.CZ=a;this.BKd=b;this.Hm=c;this.fK=h;this.Zu=m;this.hd=U;this.yk=ja}get In(){return this.Us||(this.Us=this.CZ())}vb(){const a=u.AFrameworkApplication.Ta,b=Object(F.a)(this,this.nnl,"tabView");a.ra(D.a.tab,xb.a.view,
b,1124);a.ra(D.a.eqc,xb.a.view,b,1124);a.ya(D.a.zcg,xb.a.view,ed.ActionManager.Jg)}nnl(a,b,c,h,m){if(1===c)return 32;const y=a===D.a.eqc;if(!b.view.Mh)return 2;const G=b.view,U=G.Lb;var ja=U.Qj;if(!ja||J.a.instance.ga(14)&&qu.aj.Z6a(ja))return 2;if(this.Hm&&this.Hm.instance&&this.Hm.instance.UW(ja))return 4;var va=null,Ta=ed.ActionManager.o5,fb=!1,Db=Bb.SelectionEditor.Sg(ja);if(ja.$w){if(U.Pa.eH&&(Ta=ja.getContext(0),va=new rb.GraphIterator,va.set(Ta.node),va.Xu(),Ta=y?D.a.sSe:D.a.vmd),Ta=this.BKd.FEk(Ta,
y?D.a.qz:D.a.MD),Ta===ed.ActionManager.o5){var gc=qu.jm.F2(ja,16);if(gc)y&&(Ta=D.a.qcd),va=new rb.GraphIterator,va.set(gc.node),va.gf();else{if(J.a.instance.ga(77))return 2;if(qu.GJj(ja)){if(y)return 2;Ta=D.a.hAb}else Ta=y?D.a.qz:D.a.MD}}}else if(ja.el)va=new rb.GraphIterator,va.set(ja.node),Bb.SelectionEditor.xt(va),Yi.OutlineReader.Ika(ja)?Ta=y?D.a.sSe:D.a.vmd:(Ta=y?this.BKd.ooj(va,ja,Ta):this.BKd.noj(va,ja,Ta),Kd.OutlineElementReader.Wg(va)&&ja.contextId===xb.a.Of&&(fb=Kd.OutlineElementReader.rC(va,
ja,!1)),(gc=Wb.ListReader.tk(va)&&fb)&&ba.ULS.sendTraceTag(509659340,383,50,"Tab pressed at starting of list item IsLevelIncreased:{0}",Ta===D.a.MD),Ta!==ed.ActionManager.o5||Qe.isTableCellOrInside(va)||gc||(this.Cof||(ba.ULS.sendTraceTag(39662619,383,50,"User tried to insert inline tabs"),this.Cof=!0),u.AFrameworkApplication.Ta.processAction(D.a.zcg,2),u.AFrameworkApplication.CL("Microsoft.Office.Web.SessionSettings.IWacWordWordEditorInlineTabInsertionSettings"),this.hd&&this.hd.isFeatureEnabled(84)&&
this.hd.isFeatureEnabled(83)));else return 2;if(!y&&Ta===ed.ActionManager.o5&&Qe.isTableCellOrInside(va))if(Gd.returnToCell(va),Qe.isLastCellInTable(va)||rd.TableReader.Kyb(va)&&Qe.isLastCellInTableIgnoringGhostCells(va)){if(Ta=this.HMd(va,ja),!Ta)return 2}else Ta=D.a.QZg;if(Ta===ed.ActionManager.o5)return 2;switch(Ta){case D.a.hAb:Zn.instance.hAb(a,ja,b.view);ja=32;break;case D.a.s0d:Zn.instance.s0d(a,ja,b.view);ja=32;break;case D.a.QZg:case D.a.qcd:fb=Ta===D.a.qcd;Db&&this.fK&&this.Zu&&(Db=this.fK.f2d(ja,
-1,!0,z.a.Pq))&&this.Zu.gnh(Db);ja=32;Gd.returnToCell(va);Gd.moveToNextOrPreviousCell(va,fb)&&(Db=!0,fb=!1,Yi.OutlineReader.YUc(va)||(ii.OutlineNavigator.mDe(va,!1),mc.OutlineElementNavigator.wi(va),Ob.ParagraphReader.hs(va.currentNode)&&(Db=!1,Ob.ParagraphReader.textLength(va.currentNode)||(fb=!0)),fb||Gd.returnToCell(va)),fb?va=yd.SelectionFactory.Qg(va.currentNode,0):(va=yd.SelectionFactory.wl(va.currentNode),!Db&&Bb.SelectionEditor.Wl(va.Ye)&&(Db=va.toArray(),Array.removeAt(Db,Db.length-1),va=
new Gb.Selection(Db,va.yf))),U.setSelection(va));break;case D.a.sSe:case D.a.vmd:Ta===D.a.vmd?ii.OutlineNavigator.tZg(va,!1):ii.OutlineNavigator.tZg(va,!0);U.setSelection(yd.SelectionFactory.wl(va.currentNode));ja=32;break;case D.a.j0a:ja=u.AFrameworkApplication.Ta.mi(b,Ta,c,!0,h,m);1===Fc.App.mode&&Gd.moveToNextOrPreviousCell(va,!1)&&(Gd.returnToCell(va),va=yd.SelectionFactory.sj(va.currentNode,!0),Bb.SelectionEditor.Wl(va.Ye)&&(Db=va.toArray(),Array.removeAt(Db,Db.length-1),va=new Gb.Selection(Db,
va.yf)),U.setSelection(va));break;default:if(ja=u.AFrameworkApplication.Ta.mi(b,Ta,c,!0,h,m),!fb&&Db&&(Ta===D.a.qz||Ta===D.a.MD)){const hc=Bb.SelectionEditor.Cia(U.Pa.mb).y;Fc.App.tOk(()=>{this.kik(U,G,hc)})}}32===ja&&b.view.Mh&&this.In.kw();return ja}kik(a,b,c){if(a&&b){var h=a.Pa.mb;Bb.SelectionEditor.Cia(h).y<c?(b=Bb.SelectionEditor.p3b(b,h,!1),b=Bb.SelectionEditor.Msa(b,!1,!1,!1,!0)):b=Bb.SelectionEditor.aPc(b,h,!1);a.setSelection(b)}}HMd(){return D.a.Pta}iZg(a,b,c){if(a&&b){var h=a.Pa.mb;Bb.SelectionEditor.Cia(h).y<
c?(b=Bb.SelectionEditor.p3b(b,h,!1),b=Bb.SelectionEditor.Msa(b,!1,!1,!1,!0)):b=Bb.SelectionEditor.Msa(h,!1,!1,!1,!0);a.setSelection(b)}}static get aj(){return Dc.a.instance}static get jm(){return tg.ContextSetEditor.instance}static GJj(a){a=qu.jm.F2(a,10);return!!a&&Je.a(a)}}Object(n.a)(qu,"TabActor",null,[]);class qN extends qu{constructor(a,b,c,h){super(a,b,c);this.la=h}HMd(a,b){return this.la.Kzb?super.HMd(a,b):0}}Object(n.a)(qN,"Box4TabActor",qu,[]);class rN{constructor(a,b,c,h){this.Gck=new qN(a,
b,c,h)}vb(){this.Gck.vb()}De(){}}Object(n.a)(rN,"TabActor",null,[227]);class sN{constructor(a,b,c){this.wyg=b;this.pa=a;this.iGa=c}FEk(a,b){const c=this.pa.Qj;return c&&this.iGa.F2(c,16)?a:this.GVe(b)?b:H.a.qe}ooj(a,b,c){(c=Object(ua.a)(5,b.node))&&c.ys()?c=D.a.qcd:(mc.OutlineElementNavigator.Oe(a),c=(Bb.SelectionEditor.ek(b)||Bb.SelectionEditor.Sg(b)&&Kd.OutlineElementReader.rC(a,b,!1))&&this.wyg.qsb(a)&&this.GVe(D.a.qz)?D.a.qz:H.a.qe,Ba.a.J(8955994,820,50,"TabActorPromoteDemoteStrategy::GraphNodePlanPromote actionToTake={0}",
c===D.a.qz?"Promote":"DoNothing"));return c}noj(a,b,c){const h=Object(ua.a)(5,a.xq);if(h&&h.ys())return c;mc.OutlineElementNavigator.Oe(a);c=(Bb.SelectionEditor.ek(b)||Bb.SelectionEditor.Sg(b)&&Kd.OutlineElementReader.rC(a,b,!1))&&this.wyg.iIc(a)&&this.GVe(D.a.MD)?D.a.MD:H.a.qe;Ba.a.J(8955996,820,50,"TabActorPromoteDemoteStrategy::GraphNodePlanDemote actionToTake={0}",c===D.a.qz?"Demote":"DoNothing");return c}GVe(a){var b=this.pa.Pa.mb;let c=!1;if(b)for(let h of b)if(h&&h.node)if(Ob.ParagraphReader.VW(h.node)){if(b=
h.node.sa(jb.a.listLevel,0),a===D.a.MD&&b>=No.a.K7-1||a===D.a.qz&&!b||this.pa.xL()&&No.a.qgg(h.node)){c=!0;break}}else{c=!0;break}return!c}}Object(n.a)(sN,"TabActorPromoteDemoteStrategy",null,[432]);var tN=d(395),YQ=d(851),uN=d(954);class Pv extends Nh.a{constructor(a,b,c,h,m,y,G,U,ja){super(void 0,void 0,!0);this.cva=null;this.p5j=b;this.SEg=h;this.QEg=m;this.LEg=y;this.FEg=G;this.ysg=U;this.xsg=ja;this.wwa=a;this.Rbb=c}kpd(){this.ig=this.p5j;const a={};a.bodyControls=this.n4d();this.$i(this.wwa,
Object(F.a)(this,this.eZd,"dialogResultHandler"),a)}eZd(a,b){1===a&&this.Rbb(parseInt(this.PSa(b)),parseInt(this.t4i(b)));this.dispose()}n4d(){this.cva=Pv.h5d();const a={};this.hxi(a);this.lwi(a);return a}hxi(a){const b=String.format(ResourceStrings.l_InsertTableMouseHoverMessage,this.SEg,this.LEg),c=[uN.a("None",0,this.SEg,this.LEg,1)];a.rowsSpinButtonProps={["type"]:"AppSpinButtonProps",["id"]:"TableSizeDialogRowSpinner",["label"]:ResourceStrings.l_InsertTableDialogRowLabelText,["customTooltip"]:b,
["unitType"]:"None",["value"]:this.ysg,["validUnits"]:c,["numberFormatInfo"]:this.cva,["validReservedValues"]:[""]}}lwi(a){const b=String.format(ResourceStrings.l_InsertTableMouseHoverMessage,this.QEg,this.FEg),c=[uN.a("None",0,this.QEg,this.FEg,1)];a.columnsSpinButtonProps={["type"]:"AppSpinButtonProps",["id"]:"TableSizeDialogColumnSpinner",["label"]:ResourceStrings.l_InsertTableDialogColumnLabelText,["customTooltip"]:b,["unitType"]:"None",["value"]:this.xsg,["validUnits"]:c,["numberFormatInfo"]:this.cva,
["validReservedValues"]:[""]}}PSa(a){return a.rows&&""!==a.rows.toString()?a.rows.toString():this.ysg.toString()}t4i(a){return a.columns&&""!==a.columns.toString()?a.columns.toString():this.xsg.toString()}static h5d(){return{["negativeSign"]:"-",["numberDecimalDigits"]:0,["numberDecimalSeparator"]:".",["numberNegativePattern"]:1,["numberGroupSeparator"]:",",["numberGroupSizes"]:[3]}}}Object(n.a)(Pv,"AReactTableSizeDialog",Nh.a,[]);class vN extends Pv{constructor(a){super(ResourceStrings.L_InsertTableDialogTitleText,
"InsertTableDialog",a,1,1,35,35,2,5)}}Object(n.a)(vN,"ReactInsertTableDialog",Pv,[]);class wN extends Pv{constructor(a,b,c){super(ResourceStrings.L_SplitTableCells,"SplitTableCellsDialog",a,1,1,b,c,1,Math.min(2,c))}}Object(n.a)(wN,"ReactSplitTableCellsDialog",Pv,[]);var Qv=d(614),xN=d(946);class eF{constructor(a){this.SFa=a;if(!a)throw Error.argumentNull("m_actionData");}xs(){return!1}Ym(){return this.SFa.TableNode}rv(){var a;return null!==(a=this.SFa.CellNodes)&&void 0!==a?a:this.Ym().M9a()}MY(a){return a&&
!!a.Ba}}Object(n.a)(eF,"TableActionDataContextHelper",null,[473]);class fF{constructor(a){this.pa=a;if(!a)throw Error.argumentNull("m_selectionManager");}xs(){return this.pa.xs()}Ym(){return this.pa.Ym()}rv(){return this.pa.rv()}MY(a){let b=!1;a&&a.Ba&&(a=this.pa.Jp(),b=!!a&&a.ud);return b}}Object(n.a)(fF,"TableSelectionManagerContextHelper",null,[473]);class ru{constructor(a,b,c,h,m,y,G,U,ja,va,Ta,fb,Db,gc,hc,Gc,Pc,yc,Vd,De,Wd,Ve,$e,Qf,lg,Hg,Qg){this.uVa={};this.Fec=!1;this.F8c=null;this.Kz=[0,.25,
.5,.75,1,1.5,2.25,3,4.5,6];this.HF=new xa.ScriptSharpLegacyMap;this.Vb=gc;this.ua=hc;this.Pb=b;this.ia=a;this.ff=c;this.pa=Gc;this.Fa=h;this.eA=m;this.Ea=y;this.Fs=Ta;this.Tk=va;this.Ga=fb;this.Jb=Db;this.rJ=ja;this.MXa=U;this.yc=G;this.Wj=Pc;this.MEb=yc;this.lUg=Vd;this.Yda=De;this.Fb=Wd;this.QFa=Ve;this.Hu=$e;this.WX=Qf;this.CAg=lg;this.sH=1;this.yx=Uf.Box4ColorHelper.oV({Color:"##T,1,0,0"});this.hB=Hg;this.jA=Qg}vb(){this.uVa["465284484"]=0;this.uVa["212166888"]=1;this.uVa["530759702"]=2;this.uVa["1915511548"]=
0;this.uVa["2003354004"]=1;this.uVa["2257534378"]=2;wc.m8d=Object(F.a)(this,this.l8d,"getRowOrColumnsForDelete");wc.a8d=Object(F.a)(this,this.vfj,"getRefRowWhenInsertRow");wc.Y7d=Object(F.a)(this,this.pfj,"getRefCellWhenInsertColumn");wc.Z7d=Object(F.a)(this,this.rfj,"getRefColumnFromRefCell");wc.$7d=Object(F.a)(this,this.tfj,"getRefColumnsWhenSelectColumn");wc.b8d=Object(F.a)(this,this.xfj,"getRefRowsWhenSelectRow");wc.o$d=Object(F.a)(this,this.foj,"gotoFocusCellAfterInsertColumn");wc.swb=Object(F.a)(this,
this.O1f,"getNewOutlineElementInfoFromCell");wc.qzb=a=>this.Ga.yv||!rd.TableReader.Kyb(a);this.ia.ra(M.a.BHb,nc.a.application,Object(F.a)(this,this.nqj,"handleDeleteTable"),4);this.ia.ra(M.a.olc,xb.a.view,Object(F.a)(this,this.pqj,"handleDeleteTableRow"),4);this.ia.ra(M.a.bhd,xb.a.view,Object(F.a)(this,this.oqj,"handleDeleteTableColumn"),4);this.ia.ra(M.a.HJe,nc.a.application,Object(F.a)(this,this.xuj,"handleSelectTable"),4);this.ia.ra(M.a.chd,nc.a.application,Object(F.a)(this,this.Arj,"handleInsertTable"),
4);this.ia.ra(M.a.CJe,nc.a.application,Object(F.a)(this,this.Brj,"handleInsertTableDialog"),4);this.ia.ra(M.a.fah,nc.a.application,Object(F.a)(this,this.Crj,"handleInsertTableFromRibbon"),4);this.ia.ra(M.a.nCk,nc.a.application,Gr.a.ZG,4);this.ia.ra(M.a.oCk,nc.a.application,Gr.a.ZG,4);this.ia.ra(M.a.qHk,nc.a.application,Gr.a.W0,96);this.ia.ra(M.a.rHk,nc.a.application,Gr.a.W0,96);this.ia.ra(M.a.adh,xb.a.view,Object(F.a)(this,this.SMe,"queryTableCellAnchoring"),96);this.ia.ra(M.a.$ch,xb.a.view,Object(F.a)(this,
this.SMe,"queryTableCellAnchoring"),96);this.ia.ra(M.a.Zch,xb.a.view,Object(F.a)(this,this.SMe,"queryTableCellAnchoring"),96);this.ia.ya(M.a.zlc,xb.a.view,wc.Gja);this.ia.ya(M.a.ylc,xb.a.view,wc.Gja);this.ia.ya(M.a.xlc,xb.a.view,wc.Gja);this.ia.ya(M.a.zlc,xb.a.tableCell,Object(F.a)(this,this.fae,"handleTableCellAnchoring"));this.ia.ya(M.a.ylc,xb.a.tableCell,Object(F.a)(this,this.fae,"handleTableCellAnchoring"));this.ia.ya(M.a.xlc,xb.a.tableCell,Object(F.a)(this,this.fae,"handleTableCellAnchoring"));
this.ia.he(M.a.zlc,4);this.ia.he(M.a.ylc,4);this.ia.he(M.a.xlc,4);this.ia.ya(M.a.bah,xb.a.view,Object(F.a)(this,this.ypj,"handleCellShadingMenuOpen"));this.ia.ra(M.a.kah,xb.a.view,Object(F.a)(this,this.Ssj,"handlePopulateCellShadingColor"),96);this.ia.ya(M.a.y5,xb.a.view,wc.Gja);this.ia.ya(M.a.y5,xb.a.tableCell,Object(F.a)(this,this.wpj,"handleCellShadingColor"));this.ia.ya(M.a.hah,xb.a.view,Object(F.a)(this,this.Vrj,"handleMoreCellShadingColor"));this.ia.ya(M.a.ahd,xb.a.view,wc.Gja);this.ia.ya(M.a.ahd,
xb.a.tableCell,Object(F.a)(this,this.xpj,"handleCellShadingCustomColor"));this.ia.ya(M.a.xJa,xb.a.view,wc.Gja);this.ia.ya(M.a.xJa,xb.a.tableCell,Object(F.a)(this,this.Vtj,"handleRemoveCellShading"));this.ia.he(M.a.y5,4);this.ia.he(M.a.xJa,4);this.ia.ra(M.a.lmc,xb.a.application,Object(F.a)(this,this.lmc,"queryLockAspectRatio"),96);this.ia.ra(M.a.opc,xb.a.application,Object(F.a)(this,this.opc,"setLockAspectRatio"),4);this.ia.ra(M.a.SIb,xb.a.view,Object(F.a)(this,this.SIb,"queryTableRowHeight"),96);
this.ia.ra(M.a.RIb,xb.a.view,Object(F.a)(this,this.RIb,"queryTableColumnWidth"),96);this.ia.ra(M.a.R_a,xb.a.view,Object(F.a)(this,this.R_a,"setTableRowHeight"),4);this.ia.ra(M.a.JKa,xb.a.view,Object(F.a)(this,this.JKa,"setTableColumnWidth"),4);this.ia.ra(M.a.Wpd,xb.a.view,Object(F.a)(this,this.R_a,"setTableRowHeight"),4);this.ia.ra(M.a.Vpd,xb.a.view,Object(F.a)(this,this.JKa,"setTableColumnWidth"),4);this.ia.ra(M.a.zkh,nc.a.application,Object(F.a)(this,this.huj,"handleResizeFallbackTable"),4);this.ia.ra(M.a.Smc,
xb.a.view,Object(F.a)(this,this.jdh,"queryTableSize"),96);this.ia.ra(M.a.Oid,xb.a.view,Object(F.a)(this,this.jdh,"queryTableSize"),96);this.ia.ra(M.a.soa,xb.a.view,Object(F.a)(this,this.irh,"setTableSize"),4);this.ia.ra(M.a.KKa,xb.a.view,Object(F.a)(this,this.irh,"setTableSize"),4);this.ia.ra(M.a.mergeTableCells,xb.a.view,Object(F.a)(this,this.Srj,"handleMergeTableCells"),4);this.ia.ra(M.a.splitTableCells,xb.a.view,Object(F.a)(this,this.Xuj,"handleSplitTableCells"),4);this.ia.ra(M.a.qNf,xb.a.view,
Object(F.a)(this,this.W7f,"handleDistributeRows"),4);this.ia.ra(M.a.pNf,xb.a.view,Object(F.a)(this,this.rqj,"handleDistributeColumns"),4);this.ia.ra(M.a.Szh,xb.a.view,Object(F.a)(this,this.W7f,"handleDistributeRows"),4);this.ia.ra(M.a.A$g,xb.a.view,Object(F.a)(this,this.Rsj,"handlePopulateCellBorderColorMenu"),96);this.ia.ra(M.a.aah,xb.a.view,Object(F.a)(this,this.vpj,"handleCellBorderRecentColor"),96);this.ia.ra(M.a.$Yg,xb.a.view,Object(F.a)(this,this.Urj,"handleMoreCellBorderColors"),96);this.ia.ra(M.a.Izh,
xb.a.view,Object(F.a)(this,this.hvj,"handleTableBorderWidthAnchor"),4);this.ia.ra(M.a.Oya,xb.a.view,Object(F.a)(this,this.zuj,"handleSelectTableBorderWidth"),4);this.ia.ra(M.a.uzh,xb.a.view,Object(F.a)(this,this.fvj,"handleTableBorderColorAnchor"),4);this.ia.ra(M.a.B0a,xb.a.view,Object(F.a)(this,this.yuj,"handleSelectTableBorderColor"),4);this.ia.ra(M.a.Hzh,xb.a.view,Object(F.a)(this,this.gvj,"handleTableBorderTypeAnchor"),4);this.ia.ra(M.a.Koa,xb.a.view,Object(F.a)(this,this.NUc,"handleSelectTableBorderType"),
4);this.ia.ra(M.a.wzh,xb.a.view,Object(F.a)(this,this.uuj,"handleSelectInsideTableBorderType"),4);this.ia.ra(M.a.vzh,xb.a.view,Object(F.a)(this,this.Z8f,"handleSelectInsideHorizontalTableBorderType"),4);this.ia.ra(M.a.xzh,xb.a.view,Object(F.a)(this,this.$8f,"handleSelectInsideVerticalTableBorderType"),4);this.ia.ra(M.a.JMe,xb.a.view,Object(F.a)(this,this.Itj,"handleQueryTableBorderWidth_1"),96);this.ia.ra(M.a.KMe,xb.a.view,Object(F.a)(this,this.Jtj,"handleQueryTableBorderWidth_2"),96);this.ia.ra(M.a.LMe,
xb.a.view,Object(F.a)(this,this.Ktj,"handleQueryTableBorderWidth_3"),96);this.ia.ra(M.a.MMe,xb.a.view,Object(F.a)(this,this.Ltj,"handleQueryTableBorderWidth_4"),96);this.ia.ra(M.a.NMe,xb.a.view,Object(F.a)(this,this.Mtj,"handleQueryTableBorderWidth_5"),96);this.ia.ra(M.a.OMe,xb.a.view,Object(F.a)(this,this.Ntj,"handleQueryTableBorderWidth_6"),96);this.ia.ra(M.a.PMe,xb.a.view,Object(F.a)(this,this.Otj,"handleQueryTableBorderWidth_7"),96);this.ia.ra(M.a.QMe,xb.a.view,Object(F.a)(this,this.Ptj,"handleQueryTableBorderWidth_8"),
96);this.ia.ra(M.a.RMe,xb.a.view,Object(F.a)(this,this.Qtj,"handleQueryTableBorderWidth_9"),96);this.ia.ra(M.a.EMe,xb.a.view,Object(F.a)(this,this.Dtj,"handleQueryTableBorderType_LeftBorder"),96);this.ia.ra(M.a.HMe,xb.a.view,Object(F.a)(this,this.Gtj,"handleQueryTableBorderType_RightBorder"),96);this.ia.ra(M.a.IMe,xb.a.view,Object(F.a)(this,this.Htj,"handleQueryTableBorderType_TopBorder"),96);this.ia.ra(M.a.yMe,xb.a.view,Object(F.a)(this,this.xtj,"handleQueryTableBorderType_BottomBorder"),96);this.ia.ra(M.a.AMe,
xb.a.view,Object(F.a)(this,this.ztj,"handleQueryTableBorderType_DiagonalUpBorder"),96);this.ia.ra(M.a.zMe,xb.a.view,Object(F.a)(this,this.ytj,"handleQueryTableBorderType_DiagonalDownBorder"),96);this.ia.ra(M.a.CMe,xb.a.view,Object(F.a)(this,this.Btj,"handleQueryTableBorderType_InsideHorizontalBorder"),96);this.ia.ra(M.a.DMe,xb.a.view,Object(F.a)(this,this.Ctj,"handleQueryTableBorderType_InsideVerticalBorder"),96);this.ia.ra(M.a.BMe,xb.a.view,Object(F.a)(this,this.Atj,"handleQueryTableBorderType_InsideBorder"),
96);this.ia.ra(M.a.GMe,xb.a.view,Object(F.a)(this,this.Ftj,"handleQueryTableBorderType_OutsideBorder"),96);this.ia.ra(M.a.xMe,xb.a.view,Object(F.a)(this,this.wtj,"handleQueryTableBorderType_AllBorder"),96);this.ia.ra(M.a.FMe,xb.a.view,Object(F.a)(this,this.Etj,"handleQueryTableBorderType_NoBorder"),96)}De(){}rra(a){return a.Lp()?Rd.a("TableBordersComplexTableFixEnabled"):!0}MY(){var a=!1;this.ua.Ba&&(a=this.pa.Jp(),a=!!a&&a.ud);return a}ypj(){return this.MY()?32:8}Ssj(a,b,c,h,m){if(!this.MY())return 16;
if(1===c)return 32;if(!m)return 8;a=this.ua.Ba;if(!a)throw Error.argumentNull("ActiveSlide is null");c=this.Vb.Cf.M7;b=Object.assign(new Mk.a,{Id:"PptRibbon.TableDesign.Shading",MenuSectionList:[]});Array.add(b.MenuSectionList,Uk.f(a.Ne,yE.a.themeColors,"Color.Menu.Controls","themeColor","ThemeCellShadingColorPicker","3704601382",1));Array.add(b.MenuSectionList,Uk.d("Standard Colors","Color.Menu.Controls","standardColor","StandardCellShadingColorPicker","3704601382",!1));Array.add(b.MenuSectionList,
Uk.b("Remove Color","Color.Menu.Controls","2292419401",ResourceStrings.L_RemoveShapeFill,"Color.Menu.RemoveColor","ShapeNoFill","per_AppointmentColor0_16x16x32",CommonUIStrings.l_RemoveShapeFillKeytip));c&&0<c.length?(appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("CellShadingRecentColors",!1)),Array.add(b.MenuSectionList,Uk.c(c,"Recent Colors","Color.Menu.Controls","recentColor","CellShadingRecentColors","4078162917",!1))):appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("CellShadingRecentColors",
!0));Rd.a("ColorPickerHighlighterFix")&&(c=this.jA.nYf(this.pa.rv()),Uk.h(b,c,a.Ne));m.MenuItems=b;return 32}Vrj(a,b,c,h,m){if(!this.MY())return Ba.a.J(512500107,822,10,"HandleMoreCellShadingColor: ShouldExecuteTableEditAction returned false"),16;if(1===c)return this.ia.La(M.a.renderColorPicker,1,m);a=this.Ngj();b={};b.currentColor=a;b.handleCommand=M.a.ahd;return this.ia.La(M.a.renderColorPicker,2,b)}xpj(a,b,c,h,m){if(1===c)return this.ia.La(M.a.y5,c,m);if(!m)return Ba.a.J(512500106,822,10,"HandleCellShadingCustomColor: actionData is null"),
16;a=this.ia.La(M.a.y5,c,m);32===a&&this.ia.La(M.a.zBa,c,m);return a}wpj(a,b,c,h,m){if(!this.MY())return 16;if(1===c)return 32;if(!m)return 8;b=b.node;m=Uf.Box4ColorHelper.oV(m);if(!m)return 8;c=this.Jb.le(15);c.nc(b);c.jd=a;a=b.cellShading;To.b(a);a.solidFillField=m;b.cellShading=a;c.dispose();Ba.a.J(573437397,822,15,String.format("HandleCellShadingColor: EntryPoint:{0} ",tN.a[this.ia.wq]));return 32}Vtj(a,b,c){if(!this.MY())return 16;if(1===c)return 32;b=b.node;c=this.Jb.le(15);c.nc(b);c.jd=a;a=
vg.a.ui(b,X.a.cellShading,new YQ.a);To.b(a);a.noFillField=new Ux;b.cellShading=a;c.dispose();return 32}hvj(){const a=this.pa.Ym();return a&&this.MY()&&this.Ga.UHb&&this.rra(a)?32:8}zuj(a,b,c,h,m){a=this.pa.Ym();if(!(a&&this.MY()&&this.rra(a)&&this.Ga.UHb))return 16;if(1===c)return 32;if(!m)return 8;switch(m.SourceControlId){case "TableBorderWidth_1":this.sH=this.Kz[1];break;case "TableBorderWidth_2":this.sH=this.Kz[2];break;case "TableBorderWidth_3":this.sH=this.Kz[3];break;case "TableBorderWidth_4":this.sH=
this.Kz[4];break;case "TableBorderWidth_5":this.sH=this.Kz[5];break;case "TableBorderWidth_6":this.sH=this.Kz[6];break;case "TableBorderWidth_7":this.sH=this.Kz[7];break;case "TableBorderWidth_8":this.sH=this.Kz[8];break;case "TableBorderWidth_9":this.sH=this.Kz[9]}this.hB.BH();return 32}DJa(a,b){return(a=Object(ua.a)(Ph.a,a))?(this.sH===b?a.Qf(!0):a.Qf(!1),32):8}Itj(a,b,c,h,m){return this.DJa(m,this.Kz[1])}Jtj(a,b,c,h,m){return this.DJa(m,this.Kz[2])}Ktj(a,b,c,h,m){return this.DJa(m,this.Kz[3])}Ltj(a,
b,c,h,m){return this.DJa(m,this.Kz[4])}Mtj(a,b,c,h,m){return this.DJa(m,this.Kz[5])}Ntj(a,b,c,h,m){return this.DJa(m,this.Kz[6])}Otj(a,b,c,h,m){return this.DJa(m,this.Kz[7])}Ptj(a,b,c,h,m){return this.DJa(m,this.Kz[8])}Qtj(a,b,c,h,m){return this.DJa(m,this.Kz[9])}fvj(){const a=this.pa.Ym();return a&&this.MY()&&this.Ga.ihb&&this.rra(a)?32:8}yuj(a,b,c,h,m){a=e(this.pa,m);b=a.Ym();if(!(b&&a.MY(this.ua)&&this.rra(b)&&this.Ga.ihb))return 16;if(1===c)return 32;if(!m)return 8;this.yx=Uf.Box4ColorHelper.oV(m);
this.hB.BH();return 32}Rsj(a,b,c,h,m){a=this.pa.Ym();if(!(a&&this.MY()&&this.rra(a)))return 16;if(1===c)return 32;if(!m)return 8;c=this.ua.Ba;if(!c)throw Error.argumentNull("ActiveSlide is null");a=this.Vb.Cf.M7;b=Object.assign(new Mk.a,{Id:"PptRibbon.TableDesign.CellBorderColors",MenuSectionList:[]});Array.add(b.MenuSectionList,Uk.f(c.Ne,"Theme Colors","Color.Menu.Controls","themeColor","CellBorderColorPicker","71763897",1));Array.add(b.MenuSectionList,Uk.d("Standard Colors","Color.Menu.Controls",
"standardColor","StandardCellBorderColorPicker","71763897",!1));a&&0<a.length?(appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("CellBorderRecentColors",!1)),Array.add(b.MenuSectionList,Uk.c(a,"Recent Colors","Color.Menu.Controls","recentColor","CellBorderRecentColors","1124206375",!1))):appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("CellBorderRecentColors",!0));m.MenuItems=b;return 32}vpj(a,b,c,h,m){if(1===c)return this.ia.La(M.a.B0a,c,m);if(!m)return Ba.a.J(512500100,
822,10,"HandleCellBorderRecentColor: actionData is null"),16;a=this.ia.La(M.a.B0a,c,m);32===a&&this.ia.La(M.a.zBa,c,m);return a}Urj(a,b,c,h,m){a=this.pa.Ym();if(!(a&&this.MY()&&this.Ga.ihb&&this.rra(a)))return Ba.a.J(512500099,822,10,"HandleMoreCellBorderColors: ShouldExecuteTableEditAction returned false"),16;if(1===c)return this.ia.La(M.a.renderColorPicker,1,m);c=null;b.el&&(b=b.node)&&b.cellShading&&b.cellShading.solidFillField&&(c=Uf.Box4ColorHelper.Usa(b.cellShading.solidFillField));b={};b.currentColor=
c;b.handleCommand=M.a.B0a;return this.ia.La(M.a.renderColorPicker,2,b)}gvj(){const a=this.pa.Ym();return a&&this.MY()&&this.Ga.X$&&this.rra(a)?32:8}uuj(a,b,c,h,m){if(2===c)return this.NUc(a,b,c,h,m);const y=this.Z8f(a,b,c,h,m);a=this.$8f(a,b,c,h,m);return 32===y||32===a?32:8}Z8f(a,b,c,h,m){if(2===c)return this.NUc(a,b,c,h,m);c=this.pa.Ym();a=!!c&&this.MY()&&this.Ga.X$&&this.rra(c);if(!a)return 8;if(this.pa.xs())return 16;b=this.pa.rv();if(!b)return 16;b.length||(b=this.yc.DF(c));if(!b||!b.length)return 16;
a=!1;c=b[0].rowIndex;for(const y of b)if(c!==y.rowIndex){a=!0;break}return a?32:8}$8f(a,b,c,h,m){if(2===c)return this.NUc(a,b,c,h,m);c=this.pa.Ym();a=!!c&&this.MY()&&this.Ga.X$&&this.rra(c);if(!a)return 8;if(this.pa.xs())return 16;b=this.pa.rv();if(!b)return 16;b.length||(b=this.yc.DF(c));if(!b||!b.length)return 16;a=!1;c=b[0].pi;for(const y of b)if(c!==y.pi){a=!0;break}return a?32:8}NUc(a,b,c,h,m){var y;b=e(this.pa,m);if(b.xs())return 16;const G=b.Ym();if(!G)return 16;if(1===c)return this.rra(G)?
32:8;if(!m)return Ba.a.J(512500098,822,10,"HandleSelectTableBorderType: actionData is null"),16;let U=b.rv();if(!U)return 16;U.length||(U=this.pDa(this.yc.DF(G)));if(!U||!U.length)return Ba.a.J(512500097,822,10,"HandleSelectTableBorderType: unable to get valid cellNodes"),16;c=this.sH;let ja=te.a.AH(c),va=null!==(y=m.BorderColor)&&void 0!==y?y:this.yx;const Ta=m.SourceControlId,fb=!!m.DoNotCreateTransaction;if(!Ta||!va)return Ba.a.J(512500096,822,10,String.format("HandleSelectTableBorderType: Invalid Table Border params recorded.")),
8;this.HF.Hb(Ta)&&this.HF.ga(Ta)&&(ja=c=0,va=nu.a.parse("000000").GLa());return ru.zSi(a,Ta,c.toString(),this.Ezi(va),tN.a[this.ia.wq],()=>{let Db;fb||(Db=this.Jb.le(15),Db.nc(G),Db.jd=a);this.LAl(a,Ta,G,U,ja,va);Db&&Db.dispose();return 32})}LAl(a,b,c,h,m,y){switch(b){case "TableBordersTopBorder":this.mTa(c,h,m,y,!1,!1);break;case "TableBordersBottomBorder":this.hTa(c,h,m,y,!1,!1);break;case "TableBordersLeftBorder":this.kTa(c,h,m,y,!1,!1);break;case "TableBordersRightBorder":this.lTa(c,h,m,y,!1,
!1);break;case "TableBordersInsideHorizontalBorder":this.iTa(c,h,m,y,!1,!1,!1);break;case "TableBordersInsideVerticalBorder":this.jTa(c,h,m,y,!1,!1,!1);break;case "TableBordersInsideBorders":this.iTa(c,h,m,y,!1,!1,!1);this.jTa(c,h,m,y,!1,!1,!1);break;case "TableBordersOutsideBorders":this.mTa(c,h,m,y,!1,!1);this.hTa(c,h,m,y,!1,!1);this.kTa(c,h,m,y,!1,!1);this.lTa(c,h,m,y,!1,!1);break;case "TableBordersNoBorder":m=0;y=nu.a.parse("000000").GLa();this.mTa(c,h,m,y,!1,!1);this.hTa(c,h,m,y,!1,!1);this.kTa(c,
h,m,y,!1,!1);this.lTa(c,h,m,y,!1,!1);this.iTa(c,h,m,y,!1,!1,!1);this.jTa(c,h,m,y,!1,!1,!1);this.Ga.SJe&&(this.I7f(h,m,y),this.H7f(h,m,y));break;case "TableBordersAllBorders":this.mTa(c,h,m,y,!1,!1);this.hTa(c,h,m,y,!1,!1);this.kTa(c,h,m,y,!1,!1);this.lTa(c,h,m,y,!1,!1);this.iTa(c,h,m,y,!1,!1,!1);this.jTa(c,h,m,y,!1,!1,!1);break;case "TableBordersDiagonalUpBorder":this.I7f(h,m,y);break;case "TableBordersDiagonalDownBorder":this.H7f(h,m,y);break;default:Ba.a.J(512500067,822,10,String.format("HandleSelectTableBorderType: Invalid Table borderType : {0} with actionId : {1} ",
b,a))}}pDa(a){const b=[];for(const c of a)c.isGhostCell||b.push(c);return b}Dtj(a,b,c,h,m){a=this.pa.Ym();if(!a)return 16;b=this.pa.rv();if(!b)return 16;b.length||(b=this.pDa(this.yc.DF(a)));if(!b||!b.length)return Ba.a.J(512500066,822,10,"HandleQueryTableBorderType_LeftBorder: unable to get valid cellNodes"),16;m=Object(ua.a)(Ph.a,m);c=te.a.AH(this.sH);return m?(this.kTa(a,b,c,this.yx,!0,!1)?(this.HF.$("TableBordersLeftBorder",!0),m.Qf(!0)):(this.HF.$("TableBordersLeftBorder",!1),m.Qf(!1)),32):8}Gtj(a,
b,c,h,m){a=this.pa.Ym();if(!a)return 16;b=this.pa.rv();if(!b)return 16;b.length||(b=this.pDa(this.yc.DF(a)));if(!b||!b.length)return Ba.a.J(512500065,822,10,"HandleQueryTableBorderType_RightBorder: unable to get valid cellNodes"),16;m=Object(ua.a)(Ph.a,m);c=te.a.AH(this.sH);return m?(this.lTa(a,b,c,this.yx,!0,!1)?(this.HF.$("TableBordersRightBorder",!0),m.Qf(!0)):(this.HF.$("TableBordersRightBorder",!1),m.Qf(!1)),32):8}Htj(a,b,c,h,m){a=this.pa.Ym();if(!a)return 16;b=this.pa.rv();if(!b)return 16;b.length||
(b=this.pDa(this.yc.DF(a)));if(!b||!b.length)return Ba.a.J(512500064,822,10,"HandleQueryTableBorderType_TopBorder: unable to get valid cellNodes"),16;m=Object(ua.a)(Ph.a,m);c=te.a.AH(this.sH);return m?(this.mTa(a,b,c,this.yx,!0,!1)?(this.HF.$("TableBordersTopBorder",!0),m.Qf(!0)):(this.HF.$("TableBordersTopBorder",!1),m.Qf(!1)),32):8}xtj(a,b,c,h,m){a=this.pa.Ym();if(!a)return 16;b=this.pa.rv();if(!b)return 16;b.length||(b=this.pDa(this.yc.DF(a)));if(!b||!b.length)return Ba.a.J(512500063,822,10,"HandleQueryTableBorderType_BottomBorder: unable to get valid cellNodes"),
16;m=Object(ua.a)(Ph.a,m);c=te.a.AH(this.sH);return m?(this.hTa(a,b,c,this.yx,!0,!1)?(this.HF.$("TableBordersBottomBorder",!0),m.Qf(!0)):(this.HF.$("TableBordersBottomBorder",!1),m.Qf(!1)),32):8}Btj(a,b,c,h,m){a=this.pa.Ym();if(!a)return 16;b=this.pa.rv();if(!b)return 16;b.length||(b=this.yc.DF(a));if(!b||!b.length)return Ba.a.J(512500062,822,10,"HandleQueryTableBorderType_InsideHorizontalBorder: unable to get valid cellNodes"),16;m=Object(ua.a)(Ph.a,m);c=te.a.AH(this.sH);return m?(this.iTa(a,b,c,
this.yx,!0,!1,!1)?(this.HF.$("TableBordersInsideHorizontalBorder",!0),m.Qf(!0)):(this.HF.$("TableBordersInsideHorizontalBorder",!1),m.Qf(!1)),32):8}Ctj(a,b,c,h,m){a=this.pa.Ym();if(!a)return 16;b=this.pa.rv();if(!b)return 16;b.length||(b=this.yc.DF(a));if(!b||!b.length)return Ba.a.J(512500061,822,10,"HandleQueryTableBorderType_InsideVerticalBorder: unable to get valid cellNodes"),16;m=Object(ua.a)(Ph.a,m);c=te.a.AH(this.sH);return m?(this.jTa(a,b,c,this.yx,!0,!1,!1)?(this.HF.$("TableBordersInsideVerticalBorder",
!0),m.Qf(!0)):(this.HF.$("TableBordersInsideVerticalBorder",!1),m.Qf(!1)),32):8}ztj(a,b,c,h,m){return this.N8f(m,"TableBordersDiagonalUpBorder")}ytj(a,b,c,h,m){return this.N8f(m,"TableBordersDiagonalDownBorder")}N8f(a,b){if(!this.Ga.SJe)return 8;const c=this.pa.Ym();if(!c||!a)return 16;var h=this.pa.rv();if(!h)return 16;h.length||(h=this.pDa(this.yc.DF(c)));if(!h||!h.length)return Ba.a.J(512500060,822,10,String.format("HandleQueryTableBorderType: unable to get valid cellNodes, borderType : {0} ",
b)),16;a=Object(ua.a)(Ph.a,a);if(null===a)return 8;h=this.kIj(b,h,te.a.AH(this.sH));this.HF.$(b,h);a.Qf(h);return 32}kIj(a,b,c){switch(a){case "TableBordersDiagonalUpBorder":return this.Bfg(b,c,this.yx,!1);case "TableBordersDiagonalDownBorder":return this.Afg(b,c,this.yx,!1);default:return Ba.a.J(512500059,822,10,String.format("IsBorderApplied: Invalid Table borderType : {0} ",a)),!1}}Atj(a,b,c,h,m){a=this.pa.Ym();if(!a)return 16;b=this.pa.rv();if(!b)return 16;b.length||(b=this.yc.DF(a));if(!b||!b.length)return Ba.a.J(512500058,
822,10,"HandleQueryTableBorderType_InsideBorder: unable to get valid cellNodes"),16;m=Object(ua.a)(Ph.a,m);c=te.a.AH(this.sH);return m?(1<b.length&&this.jTa(a,b,c,this.yx,!0,!1,!0)&&this.iTa(a,b,c,this.yx,!0,!1,!0)?(this.HF.$("TableBordersInsideBorders",!0),m.Qf(!0)):(this.HF.$("TableBordersInsideBorders",!1),m.Qf(!1)),32):8}Ftj(a,b,c,h,m){a=this.pa.Ym();if(!a)return 16;b=this.pa.rv();if(!b)return 16;b.length||(b=this.pDa(this.yc.DF(a)));if(!b||!b.length)return Ba.a.J(512500057,822,10,"HandleQueryTableBorderType_OutsideBorder: unable to get valid cellNodes"),
16;m=Object(ua.a)(Ph.a,m);c=te.a.AH(this.sH);return m?(this.mTa(a,b,c,this.yx,!0,!1)&&this.lTa(a,b,c,this.yx,!0,!1)&&this.hTa(a,b,c,this.yx,!0,!1)&&this.kTa(a,b,c,this.yx,!0,!1)?(this.HF.$("TableBordersOutsideBorders",!0),m.Qf(!0)):(this.HF.$("TableBordersOutsideBorders",!1),m.Qf(!1)),32):8}wtj(a,b,c,h,m){a=this.pa.Ym();if(!a)return 16;b=this.pa.rv();if(!b)return 16;b.length||(b=this.pDa(this.yc.DF(a)));if(!b||!b.length)return Ba.a.J(512500056,822,10,"HandleQueryTableBorderType_AllBorder: unable to get valid cellNodes"),
16;m=Object(ua.a)(Ph.a,m);c=te.a.AH(this.sH);return m?(this.mTa(a,b,c,this.yx,!0,!1)&&this.lTa(a,b,c,this.yx,!0,!1)&&this.hTa(a,b,c,this.yx,!0,!1)&&this.kTa(a,b,c,this.yx,!0,!1)&&this.iTa(a,b,c,this.yx,!0,!1,!0)&&this.jTa(a,b,c,this.yx,!0,!1,!0)?(this.HF.$("TableBordersAllBorders",!0),m.Qf(!0)):(this.HF.$("TableBordersAllBorders",!1),m.Qf(!1)),32):8}Etj(a,b,c,h,m){a=this.pa.Ym();if(!a)return 16;b=this.pa.rv();if(!b)return 16;b.length||(b=this.pDa(this.yc.DF(a)));if(!b||!b.length)return Ba.a.J(512500055,
822,10,"HandleQueryTableBorderType_NoBorder: unable to get valid cellNodes"),16;m=Object(ua.a)(Ph.a,m);c=te.a.AH(this.sH);return m?(h=!0,this.Ga.SJe&&(h=this.Bfg(b,c,this.yx,!0)&&this.Afg(b,c,this.yx,!0)),h&&this.mTa(a,b,c,this.yx,!0,!0)&&this.lTa(a,b,c,this.yx,!0,!0)&&this.hTa(a,b,c,this.yx,!0,!0)&&this.kTa(a,b,c,this.yx,!0,!0)&&this.iTa(a,b,c,this.yx,!0,!0,!0)&&this.jTa(a,b,c,this.yx,!0,!0,!0)?(this.HF.$("TableBordersNoBorder",!0),m.Qf(!0)):(this.HF.$("TableBordersNoBorder",!1),m.Qf(!1)),32):8}sEa(a,
b){if(!a)return!1;const c=Uf.Box4ColorHelper.Doa(a),h=Uf.Box4ColorHelper.Doa(b);a=Uf.Box4ColorHelper.Usa(a);b=Uf.Box4ColorHelper.Usa(b);return c.schemeClrField&&h.schemeClrField&&!a&&!b&&c.schemeClrField.valField===h.schemeClrField.valField?!0:a&&b?a.alpha===b.alpha&&a.lD===b.lD:!1}Ezi(a){a=Uf.Box4ColorHelper.Doa(a);const b=this.ua.Ba;return(a=Uf.Box4ColorHelper.LJ(a,b?b.Ne:null))&&Uf.Box4ColorHelper.Poa(a)?Uf.Box4ColorHelper.Poa(a).jV():null}nub(a,b,c,h){if(a=Object(ua.a)(Zs,a.sc(this.Fb.Ma))){h=
Uf.Box4ColorHelper.Doa(h);var m=this.ua.Ba;h=(h=Uf.Box4ColorHelper.LJ(h,m?m.Ne:null))?Uf.Box4ColorHelper.Poa(h):null;a.U4k(b,c,h)}}gv(a,b,c,h){if(a)switch(b){case "Top":a.Qya=c;a.lLa=h;this.nub(a,"Top",c,h);break;case "Right":a.jga=c;a.hga=h;this.nub(a,"Right",c,h);break;case "Bottom":a.iga=c;a.gga=h;this.nub(a,"Bottom",c,h);break;case "Left":a.Pya=c;a.kLa=h;this.nub(a,"Left",c,h);break;case "DiagonalUp":a.Akb=c;a.ykb=h;this.nub(a,"DiagonalUp",c,h);break;case "DiagonalDown":a.zkb=c,a.xkb=h,this.nub(a,
"DiagonalDown",c,h)}}mTa(a,b,c,h,m,y){const G=new xa.ScriptSharpLegacyMap;let U=Number.MAX_VALUE,ja=-1;for(const va of b)b=va.pi,U=Math.min(U,b),ja=Math.max(ja,b),G.Hb(b)?G.$(b,Math.min(G.ga(b),va.rowIndex)):G.$(b,va.rowIndex);if(m)return this.zUj(a,c,h,U,ja,G,y);this.hpj(a,c,h,U,ja,G);return!0}hpj(a,b,c,h,m,y){if(Rd.a("TableBordersComplexTableFixEnabled"))for(;h<=m;){const U=a.qf(y.ga(h),h);this.gv(U,"Top",b,c);let ja=h;const va=h+U.colSpan;for(;ja<va;){var G=a.qf(y.ga(h)-1,ja);G?G.isGhostCell?(G=
G.Ry(),G.pi<h?ja+=1:(this.gv(G,"Bottom",b,c),ja+=G.colSpan)):(this.gv(G,"Bottom",b,c),ja+=G.colSpan):ja+=1}h+=U.colSpan}else for(;h<=m;++h)this.gv(a.qf(y.ga(h),h),"Top",b,c),this.gv(a.qf(y.ga(h)-1,h),"Bottom",b,c)}zUj(a,b,c,h,m,y,G){for(;h<=m;){const U=a.qf(y.ga(h),h),ja=U.lLa,va=te.a.iM(U.Qya),Ta=te.a.iM(b);if(G){if(va!==this.Kz[0])return!1}else if(va!==Ta||!this.sEa(ja,c))return!1;h+=U.colSpan}return!0}hTa(a,b,c,h,m,y){const G=new xa.ScriptSharpLegacyMap;let U=Number.MAX_VALUE,ja=-1;for(const va of b)b=
va.pi,U=Math.min(U,b),ja=Math.max(ja,b),G.Hb(b)?G.$(b,Math.max(G.ga(b),va.rowIndex)):G.$(b,va.rowIndex);if(m)return this.nIj(a,c,h,U,ja,G,y);this.Roj(a,c,h,U,ja,G);return!0}Roj(a,b,c,h,m,y){if(Rd.a("TableBordersComplexTableFixEnabled"))for(;h<=m;){const U=a.qf(y.ga(h),h);this.gv(U,"Bottom",b,c);let ja=h;const va=h+U.colSpan;for(;ja<va;){var G=a.qf(y.ga(h)+U.rowSpan,ja);G?G.isGhostCell?(G=G.Ry(),G.pi<h?ja+=1:(this.gv(G,"Top",b,c),ja+=G.colSpan)):(this.gv(G,"Top",b,c),ja+=G.colSpan):ja+=1}h+=U.colSpan}else for(;h<=
m;++h)this.gv(a.qf(y.ga(h),h),"Bottom",b,c),this.gv(a.qf(y.ga(h)+1,h),"Top",b,c)}nIj(a,b,c,h,m,y,G){for(;h<=m;){const U=a.qf(y.ga(h),h),ja=U.gga,va=te.a.iM(U.iga),Ta=te.a.iM(b);if(G){if(va!==this.Kz[0])return!1}else if(va!==Ta||!this.sEa(ja,c))return!1;h+=U.colSpan}return!0}kTa(a,b,c,h,m,y){const G=new xa.ScriptSharpLegacyMap;let U=Number.MAX_VALUE,ja=-1;for(const va of b)b=va.rowIndex,U=Math.min(U,b),ja=Math.max(ja,b),G.Hb(b)?G.$(b,Math.min(G.ga(b),va.pi)):G.$(b,va.pi);if(m)return this.LNj(a,c,h,
U,ja,G,y);this.Yoj(a,c,h,U,ja,G);return!0}Yoj(a,b,c,h,m,y){if(Rd.a("TableBordersComplexTableFixEnabled"))for(;h<=m;){const U=a.qf(h,y.ga(h));this.gv(U,"Left",b,c);let ja=h;const va=h+U.rowSpan;for(;ja<va;){var G=a.qf(ja,y.ga(h)-1);G?G.isGhostCell?(G=G.Ry(),G.rowIndex<h?ja+=1:(this.gv(G,"Right",b,c),ja+=G.rowSpan)):(this.gv(G,"Right",b,c),ja+=G.rowSpan):ja+=1}h+=U.rowSpan}else for(;h<=m;++h)this.gv(a.qf(h,y.ga(h)),"Left",b,c),this.gv(a.qf(h,y.ga(h)-1),"Right",b,c)}LNj(a,b,c,h,m,y,G){for(;h<=m;){const U=
a.qf(h,y.ga(h)),ja=U.kLa,va=te.a.iM(U.Pya),Ta=te.a.iM(b);if(G){if(va!==this.Kz[0])return!1}else if(va!==Ta||!this.sEa(ja,c))return!1;h+=U.rowSpan}return!0}lTa(a,b,c,h,m,y){const G=new xa.ScriptSharpLegacyMap;let U=Number.MAX_VALUE,ja=-1;for(const va of b)b=va.rowIndex,U=Math.min(U,b),ja=Math.max(ja,b),G.Hb(b)?G.$(b,Math.max(G.ga(b),va.pi)):G.$(b,va.pi);if(m)return this.IRj(a,c,h,U,ja,G,y);this.Zoj(a,c,h,U,ja,G);return!0}Zoj(a,b,c,h,m,y){if(Rd.a("TableBordersComplexTableFixEnabled"))for(;h<=m;){const U=
a.qf(h,y.ga(h));this.gv(U,"Right",b,c);let ja=h;const va=h+U.rowSpan;for(;ja<va;){var G=a.qf(ja,y.ga(h)+U.colSpan);G?G.isGhostCell?(G=G.Ry(),G.rowIndex<h?ja+=1:(this.gv(G,"Left",b,c),ja+=G.rowSpan)):(this.gv(G,"Left",b,c),ja+=G.rowSpan):ja+=1}h+=U.rowSpan}else for(;h<=m;++h)this.gv(a.qf(h,y.ga(h)),"Right",b,c),this.gv(a.qf(h,y.ga(h)+1),"Left",b,c)}IRj(a,b,c,h,m,y,G){for(;h<=m;){const U=a.qf(h,y.ga(h)),ja=U.hga,va=te.a.iM(U.jga),Ta=te.a.iM(b);if(G){if(va!==this.Kz[0])return!1}else if(va!==Ta||!this.sEa(ja,
c))return!1;h+=U.rowSpan}return!0}jTa(a,b,c,h,m,y,G){b=this.pa.Nwb();if(!b)return!1;b.length||(b=this.yc.DF(a));if(!b||!b.length)return Ba.a.J(512500054,822,10,"HandleSelectionInsideVerticalBorders: unable to get valid cellNodes"),!1;const U=new xa.ScriptSharpLegacyMap,ja=new xa.ScriptSharpLegacyMap;let va=Number.MAX_VALUE,Ta=-1;for(const fb of b)b=fb.rowIndex,va=Math.min(va,b),Ta=Math.max(Ta,b),U.Hb(b)?U.$(b,Math.min(U.ga(b),fb.pi)):U.$(b,fb.pi),ja.Hb(b)?ja.$(b,Math.max(ja.ga(b),fb.pi)):ja.$(b,fb.pi);
if(m)return this.lNj(a,c,h,va,Ta,U,ja,y,G);this.Xoj(a,c,h,va,Ta,U,ja);return!0}Xoj(a,b,c,h,m,y,G){if(Rd.a("TableBordersComplexTableFixEnabled"))for(;h<=m;h++){if(y.Hb(h)&&G.Hb(h))for(var U=y.ga(h),ja=G.ga(h);U<ja;){const Ta=a.qf(h,U);if(!Ta.isGhostCell&&Ta.pi+Ta.colSpan<=ja){this.gv(Ta,"Right",b,c);let fb=h;const Db=h+Ta.rowSpan;for(;fb<Db;){var va=a.qf(fb,U+Ta.colSpan);va?va.isGhostCell?(va=va.Ry(),va.rowIndex<h?fb+=1:(this.gv(va,"Left",b,c),fb+=va.rowSpan)):(this.gv(va,"Left",b,c),fb+=va.rowSpan):
fb+=1}}U+=Ta.colSpan}}else for(;h<=m;++h)for(U=y.ga(h),ja=G.ga(h);U<ja;++U)this.gv(a.qf(h,U),"Right",b,c),this.gv(a.qf(h,U+1),"Left",b,c)}lNj(a,b,c,h,m,y,G,U,ja){if(Rd.a("TableBordersComplexTableFixEnabled")){for(var va=!1;h<=m;h++)if(y.Hb(h)&&G.Hb(h))for(var Ta=y.ga(h),fb=G.ga(h);Ta<fb;){var Db=a.qf(h,Ta);if(!Db.isGhostCell&&Db.pi+Db.colSpan<=fb){var gc=Db.hga;let hc=te.a.iM(Db.jga),Gc=te.a.iM(b);va=!0;if(U){if(hc!==this.Kz[0])return!1}else if(hc!==Gc||!this.sEa(gc,c))return!1}Ta+=Db.colSpan}return va?
!0:ja}for(va=h;va<=m;++va){fb=y.ga(va);h=G.ga(va);if(fb===h)return ja?!0:!1;for(;fb<h;++fb)if(Db=a.qf(va,fb),Ta=Db.hga,Db=te.a.iM(Db.jga),gc=te.a.iM(b),U){if(Db!==this.Kz[0])return!1}else if(Db!==gc||!this.sEa(Ta,c))return!1}return!0}iTa(a,b,c,h,m,y,G){b=this.pa.Nwb();if(!b)return!1;b.length||(b=this.yc.DF(a));if(!b||!b.length)return Ba.a.J(512500053,822,10,"HandleSelectionInsideHorizontalBorders: unable to get valid cellNodes"),!1;const U=new xa.ScriptSharpLegacyMap,ja=new xa.ScriptSharpLegacyMap;
let va=Number.MAX_VALUE,Ta=-1;for(const fb of b)b=fb.pi,va=Math.min(va,b),Ta=Math.max(Ta,b),U.Hb(b)?U.$(b,Math.min(U.ga(b),fb.rowIndex)):U.$(b,fb.rowIndex),ja.Hb(b)?ja.$(b,Math.max(ja.ga(b),fb.rowIndex)):ja.$(b,fb.rowIndex);if(m)return this.kNj(a,c,h,va,Ta,U,ja,y,G);this.Woj(a,c,h,va,Ta,U,ja);return!0}Woj(a,b,c,h,m,y,G){if(Rd.a("TableBordersComplexTableFixEnabled"))for(;h<=m;h++){if(y.Hb(h)&&G.Hb(h))for(var U=y.ga(h),ja=G.ga(h);U<ja;){const Ta=a.qf(U,h);if(!Ta.isGhostCell&&Ta.rowIndex+Ta.rowSpan<=
ja){this.gv(Ta,"Bottom",b,c);let fb=h;const Db=h+Ta.colSpan;for(;fb<Db;){var va=a.qf(U+Ta.rowSpan,fb);va?va.isGhostCell?(va=va.Ry(),va.pi<h?fb+=1:(this.gv(va,"Top",b,c),fb+=va.colSpan)):(this.gv(va,"Top",b,c),fb+=va.colSpan):fb+=1}}U+=Ta.rowSpan}}else for(;h<=m;++h)for(U=y.ga(h),ja=G.ga(h);U<ja;++U)this.gv(a.qf(U,h),"Bottom",b,c),this.gv(a.qf(U+1,h),"Top",b,c)}kNj(a,b,c,h,m,y,G,U,ja){if(Rd.a("TableBordersComplexTableFixEnabled")){for(var va=!1;h<=m;h++)if(y.Hb(h)&&G.Hb(h))for(var Ta=y.ga(h),fb=G.ga(h);Ta<
fb;){var Db=a.qf(Ta,h);if(!Db.isGhostCell&&Db.rowIndex+Db.rowSpan<=fb){var gc=Db.gga;let hc=te.a.iM(Db.iga),Gc=te.a.iM(b);va=!0;if(U){if(hc!==this.Kz[0])return!1}else if(hc!==Gc||!this.sEa(gc,c))return!1}Ta+=Db.rowSpan}return va?!0:ja}for(va=h;va<=m;++va){fb=y.ga(va);h=G.ga(va);if(fb===h)return ja?!0:!1;for(;fb<h;++fb)if(Db=a.qf(fb,va),Ta=Db.gga,Db=te.a.iM(Db.iga),gc=te.a.iM(b),U){if(Db!==this.Kz[0])return!1}else if(Db!==gc||!this.sEa(Ta,c))return!1}return!0}I7f(a,b,c){for(const h of a)this.gv(h,
"DiagonalUp",b,c)}Bfg(a,b,c,h){for(const m of a)if(!this.Fjg(te.a.iM(m.Akb),te.a.iM(b),m.ykb,c,h))return!1;return!0}H7f(a,b,c){for(const h of a)this.gv(h,"DiagonalDown",b,c)}Afg(a,b,c,h){for(const m of a)if(!this.Fjg(te.a.iM(m.zkb),te.a.iM(b),m.xkb,c,h))return!1;return!0}Fjg(a,b,c,h,m){if(m){if(a!==this.Kz[0])return!1}else if(a!==b||!this.sEa(c,h))return!1;return!0}SMe(a,b,c,h,m){if(!m)return 8;if(1===c)return 32;m[Zh.a.On]=!1;a=this.uVa[a.toString()];if(!this.pa||!this.pa.Pa.mb||this.pa.W8())return 16;
b=0;({exa:b}=this.yc.ysd(this.pa.Pa)).returnValue&&b===a&&(m[Zh.a.On]=!0);return 32}tpc(a,b){a=a.queryResult;null!==a&&(a.uaa=parseFloat(b.toFixed(2)).toString())}lmc(a,b,c,h,m){if(!m)return 16;m.Qf(this.Fec);return 32}opc(a,b,c){if(1===c)return 32;2===c&&(this.Fec=!this.Fec);Fc.App.Kb.mG({SetLockAspectRatio:"CheckboxModel"});return 32}jdh(a,b,c,h,m){if(!m)return 16;b=this.pa.Ym();if(!b)return 8;a=a===M.a.Smc?this.yc.t9d(b):this.yc.v9d(b);this.tpc(m,te.a.Jv(a));return 32}irh(a,b,c,h,m){const y=this.pa.Ym();
return a!==M.a.soa&&a!==M.a.KKa||!y?16:1===c?32:zg.a(String.format("{0}::Entry point:{1}",M.a.Qz(a),this.ia.wq),a,()=>{if(!m)return Ba.a.J(512500052,822,10,"TableActor::SetTableSize actionData == null"),8;var G=te.a.MW(m.Number);var U=a===M.a.soa?this.yc.t9d(y):this.yc.v9d(y);if(G<Qv.a.Qbd||U<Qv.a.Qbd)return 16;G/=U;U=this.Jb.le(15);try{U.nc(y),U.jd=a,a===M.a.soa?(this.Fs.soa(y,G),this.Fec&&this.Fs.KKa(y,G)):(this.Fs.KKa(y,G),this.Fec&&this.Fs.soa(y,G)),this.Fs.IZa(y)}finally{U&&U.dispose()}return 32})}SIb(a,
b,c,h,m){a=this.pa.Ym();if(!a)return 16;b=this.pa.iTc();if(!b)return 16;b.length||(b=this.yc.Zja(a));if(!b.length)return 16;a=this.MXa.UYf(b);this.tpc(m,te.a.Jv(a));return 32}R_a(a,b,c,h,m){const y=this.pa.Ym();return y?1===c?32:zg.a(String.format("SetTableRowHeight::Entry point:{0}",this.ia.wq),a,()=>{if(null===m)return Ba.a.J(512500051,822,10,"TableActor::SetTableRowHeight actionData == null"),16;let G=this.pa.iTc();if(!G)return Ba.a.J(512500050,822,10,"TableActor::SetTableRowHeight, selected table row nodes == null"),
16;G.length||(G=this.yc.Zja(y));if(!G.length)return 16;let U=Qv.a.KYg;a!==M.a.Wpd&&(U=m.Number);const ja=this.Jb.le(15);try{ja.nc(y),ja.jd=a,this.Fs.hrh(G,U)}finally{ja&&ja.dispose()}this.Fs.IZa(y);return 32}):16}RIb(a,b,c,h,m){a=this.pa.Ym();if(!a)return 16;b=this.pa.Nwb();if(!b)return 16;b.length||(b=this.Uwb(a));if(!b.length)return 16;a=this.rJ.WYf(a,b);this.tpc(m,te.a.Jv(a));return 32}JKa(a,b,c,h,m){const y=this.pa.Ym();return y?1===c?32:zg.a(String.format("SetTableColumnWidth::Entry point:{0}",
this.ia.wq),a,()=>{if(null===m)return Ba.a.J(512500049,822,10,"TableActor::SetTableColumnWidth actionData == null"),16;var G=this.pa.Nwb();if(!G)return Ba.a.J(512500048,822,10,"TableActor::SetTableColumnWidth, selected column node == null"),16;G.length||(G=this.Uwb(y));if(!G.length)return 16;let U=Qv.a.JYg;a!==M.a.Vpd&&(U=m.Number);G=this.rJ.L4d(G);const ja=this.Jb.le(15);try{ja.nc(y),ja.jd=a,this.Fs.grh(y,G,U)}finally{ja&&ja.dispose()}this.Fs.IZa(y);return 32}):16}W7f(a,b,c,h,m){const y=this.pa.Ym();
return y?1===c?Rd.a("DistributeRowsAndColumnsComplexTableFixEnabled")?32:y.Lp()?8:32:zg.a("HandleDistributeRows:Entry point:"+this.ia.wq,a,()=>{if(2===c){if(null===m)return 16;let ja=this.pa.iTc();if(!ja)return 16;var G=this.pa.rv();if(!G)return 16;ja.length&&1!==G.length||(ja=this.yc.Zja(y));if(!ja)return 16;if(!ja.length)return Ba.a.J(512500047,822,50,"HandleDistributeRows: unable to get valid tableRowNodes"),16;G=0;for(var U of ja)U&&(G+=this.MXa.k9a(U));U=this.zbj(ja,y);const va=ja.length;G=G<
va*U?U:G/va;U=this.Jb.le(15);try{U.nc(y),U.jd=a,this.Fs.hrh(ja,te.a.Jv(G))}finally{U&&U.dispose()}Ba.a.J(512500046,822,50,"HandleDistributeRows: Table Rows Distributed with height: {0}, from Entry Point: {1}",te.a.Jv(G),this.ia.wq);this.Fs.IZa(y)}return 32}):16}zbj(a,b){let c=te.a.MW(Qv.a.KYg);for(const m of a){a=this.yc.L9a(m);for(const y of a)if(y&&(a=y.A3b)&&(a=Ob.ParagraphReader.text(a))&&0<a.length){var h=y.rowIndex;const G=y.pi;if(a=Object(ua.a)(Zs,y.sc(this.Fb.Ma)))this.WX.Tah(b,this.Fb.Ma),
h=this.WX.u4b(b,a.Sia,h,G),a=a.Md.Ld.rf(h,1),Rd.a("DistributeRowsAndColumnsComplexTableFixEnabled")&&1<y.rowSpan&&(a/=y.rowSpan),c=Math.max(c,a)}}return c}rqj(a,b,c,h,m){const y=this.pa.Ym();return y?1===c?Rd.a("DistributeRowsAndColumnsComplexTableFixEnabled")?32:y.Lp()?8:32:zg.a("HandleDistributeColumns:Entry point:"+this.ia.wq,a,()=>{if(2===c){if(null===m)return 16;var G=this.pa.Nwb();G.length||(G=this.Uwb(y));if(!G)return 16;var U=this.pa.rv();if(!U)return 16;G.length&&1!==U.length||(G=this.Uwb(y));
if(!G.length)return Ba.a.J(512500045,822,50,"HandleDistributeColumns: unable to get valid tableColumnNodes"),16;U=0;G=this.rJ.L4d(G);if(!G)return Ba.a.J(512500044,822,50,"HandleDistributeColumns: table columnIndex array is null"),16;var ja=y.G4d;if(!ja)return Ba.a.J(512500043,822,50,"HandleDistributeColumns: table columnWidths array is null"),16;for(let va=0;va<G.length;va++)U+=ja[G[va]];U/=G.length;if(te.a.Jv(U)<Qv.a.JYg)return 16;ja=this.Jb.le(15);try{ja.nc(y),ja.jd=a,this.Fs.grh(y,G,te.a.Jv(U))}finally{ja&&
ja.dispose()}Ba.a.J(512500042,822,50,"HandleDistributeColumns: Table Columns Distributed with width: {0}, from Entry Point: {1}",te.a.Jv(U),this.ia.wq);this.Fs.IZa(y)}return 32}):16}fae(a,b,c,h,m){if(!this.Ga.Mke||this.pa.W8())return 16;if(1===c)return 32;if(!m)return 8;c=this.uVa[a.toString()];b=b.node;h=this.Jb.le(15);h.nc(b);h.jd=a;a=b.cellShading;a.anchorField=c;b.cellShading=a;b.Loa=c;h.dispose();return 32}Arj(a,b,c,h,m){b=this.ua.Ba;if(!b||this.ff.$c(b))return 16;if(!this.Wj.JF(b,1))return this.Wj.hG(b),
16;c=m.Rows;h=m.Columns;m=m.From;var y=b.Cb;y=b.U2(y.sid,y.cid,0,c,h,b.Pt());var G=b.n3(this.pa.Xd());if(G){if(this.ff.$c(G)||this.Ea.KI(G))return 16;this.Tk.R4k(y,G.id);this.ff.Zv(G,a)}G=this.Jb.zd(15,void 0,()=>{this.pa.Vx();this.pa.Qh();this.Fa.Ed()});try{G.nc(b),G.jd=a,b.UB(y)}finally{G&&G.dispose()}this.pa.selectShape(y,!0);Ba.a.J(512500040,822,50,"Insert {0}x{1} table from {2}",h,c,m);this.Hu.NF=y;return 32}Brj(){(new vN((a,b)=>{const c={};c.Rows=a;c.Columns=b;c.From="Placeholder";this.ia.La(M.a.chd,
2,c)})).kpd();return 32}Crj(a,b,c,h,m){m.From="Ribbon";return this.ia.La(M.a.chd,c,m)}nqj(a,b,c){b=this.ua.Ba;if(!b||this.pa.W8())return 16;const h=this.pa.Jp();if(!h||!h.ud||this.ff.$c(h))return 16;if(1===c)return 32;Nc.a.kP(!0,!0);c=this.Jb.zd(15,void 0,()=>{this.pa.setSelection(null);this.Fa.Ed()});try{c.nc(b),c.jd=a,this.Tk.EMc(h)}finally{c&&c.dispose()}this.ff.Zv(b,a);return 32}pqj(a,b,c,h,m){if(this.pa.xs())return 16;a=this.l8d(this.pa.Qj,!0,this.pa);return this.tHj(a)?16:32!==a.response?8:
a.ZC&&a.ZC.length===rd.TableReader.rk(a.gp)?this.ia.processAction(M.a.BHb,c):this.ia.mi(b,D.a.deleteRow,c,!1,h,m)}oqj(a,b,c,h,m){if(this.pa.xs())return 16;a=this.l8d(this.pa.Qj,!1,this.pa);return this.sHj(a)?16:32!==a.response?8:a.ZC&&a.ZC.length===rd.TableReader.Ai(a.gp)?this.ia.processAction(M.a.BHb,c):this.ia.mi(b,D.a.ICa,c,!1,h,m)}xuj(a,b,c,h,m){return 1===c?32:this.ia.mi(b,M.a.Qia,c,!1,h,m)}Srj(a,b,c){if(this.pa.xs()||this.pa.W8()||!this.Ga.o_c)return 16;b=this.pa.Pa;if(!b||!b.Gl||1===b.length&&
1===b.ga(0).length)return 16;b=this.MEb.S5b(b);if(!b)return Ba.a.J(36721626,822,50,"Unable to get cell selection info"),8;if(!b.rRj)return 16;if(1===c)return 32;Nc.a.Ib&&(Nc.a.Ib.Nj=!0,Nc.a.Ib.pF=new Date);Ba.a.J(36721628,822,50,"Perform table merge cells");const h=b.tableNode;c=this.Jb.le(15);c.nc(h);c.jd=a;a=this.lUg.merge(h,b.wsb,b.TY);a=Yq.TableNodeContext.create(a);a=yd.SelectionFactory.J0b(yd.SelectionFactory.wu(a));this.pa.ME(a);c.dispose();Ba.a.J(36721630,822,50,"Table merge cells succeeded");
return 32}Xuj(a,b,c,h,m){if(this.pa.xs()||this.pa.W8()||!this.Ga.Rke)return 16;h=null;h=this.pa.Pa.Gl?this.MEb.S5b(this.pa.Pa):this.MEb.hij(b.view.Lb.Qj);if(!h)return 16;const y=h.tableNode.tg(this.Fb.Ma);if(y&&!y.JNj)return Ba.a.J(512500037,822,50,"Suspend split cells as table layout service is running"),16;const G=Object(ua.a)(175,h.tableNode);if(this.yc.Xge(G))return 16;const U=h.wsb;if(!({rows:b,cols:a}=this.Ytl(G,U)).returnValue)return 8;if(1===c)return 1<b||1<a?32:16;const ja=h.TY,va=new Date;
({rows:c,cols:h}=this.M3i(G,ja,U,y));const Ta=Nc.a.Ib;Ta&&(Ta.Va("GetClientSplitLimit",(+new Date-+va).toString()),Ta.Qr=!1);const fb=(Db,gc)=>{this.lUg.ckl(G,U,Db,gc,ja,y,this.Fb.Ld,Object(F.a)(this,this.O1f,"getNewOutlineElementInfoFromCell"),()=>{})};m&&m.rows&&m.columns&&!Number.isNaN(m.rows)&&!Number.isNaN(m.columns)?(b=Number.parseInt(m.rows),m=Number.parseInt(m.columns),m>h&&(m=h),b>c&&(b=c),fb(b,m)):(new wN((Db,gc)=>{fb(Db,gc)},Math.min(b,c),Math.min(a,h))).kpd();return 32}huj(a,b,c,h,m){if(!m||
!Object(za.a)(Array,m))return 8;if(1!==m.length)return Ba.a.J(512500036,822,50,"Fallback table resize fail: reiszeShapeData length is {0}.",m.length),8;if(this.ff.$c(m[0].p1))return 16;b=m[0].p1;if(!(b&&b.isConnected&&b.isResizable&&b.ud)||b.KI)return Ba.a.J(512500035,822,50,"Fallback table resize: try to resize shape {0} which is not resizeable",b.get_shapeId()),16;h=Object(ua.a)(117,b.sc(this.Fb.Ma));if(!h)return Ba.a.J(512500034,822,50,"Fallback table resize fail: shape {0} has no shapeviewelement",
b.get_shapeId()),8;const y=this.yc.FN(b);if(!y)return Ba.a.J(512500033,822,50,"Fallback table resize fail: shape {0} has no table node",b.get_shapeId()),8;const G=y.sc(this.Fb.Ma);if(!G)return Ba.a.J(512500032,822,50,"Fallback table resize fail: fallback table shape {0} has no tableviewelement and no rendered",b.get_shapeId()),8;if(!m[0].$1b)return h&&h.setOffsets(new yi.a,!0),Ba.a.J(512500003,822,50,"Fallback table resize fail: resizeShapeData no drag direction"),8;if(1===c)return 32;let U=c=1;try{h.Ok.cnh.etb.length||
(this.F8c=new yi.a);h.setOffsets(new yi.a,!0);var ja=G.R5b();const va=this.QFa.Pm(ja.Zb-ja.hc),Ta=this.QFa.Pm(ja.Xb-ja.kc),fb=new ad.a(h.x+va,h.y+Ta),Db=new ad.a(h.Nfa(m[0].dZg.x),h.Nfa(m[0].dZg.y)),gc=Rk.rSd(m[0].$1b,ja,Db,!1,!1);c=va?1+(gc.right-gc.left)/va:1;U=Ta?1+(gc.bottom-gc.top)/Ta:1;G.krh(c,U);const hc=G.R5b();let Gc=pj.a.d5b(hc,ja);Gc.Hj(1/h.vd);this.F8c&&(Gc=yi.a.add(Gc,this.F8c));h.setOffsets(Gc,!0);this.F8c=Gc;m[0].b1.Hj(h.vd);this.zZe(m[0].$1b,h,hc,fb,m[0].b1)}catch(va){return Ba.a.J(512500002,
822,50,"Fallback table resize fail: ",va.toString()),8}ja=this.Jb.le(15);ja.nc(y);ja.jd=a;a=G.Md.Ld;this.Fs.DQe(y,c,U,G,a);if(ru.PEa(m[0].$1b)||ru.PEa(m[0].$1b,!0))m=a.rf(h.x,0),a=a.rf(h.y,1),b.qy=m,b.ry=a;ja.dispose();return 32}Ytl(a,b){let c,h;c=h=1;try{return c=Math.max(1,Math.floor((35-this.yc.rk(a))/b.OO)+1),h=Math.max(1,Math.floor((35-this.yc.Ai(a))/b.sR)+1),{returnValue:!0,rows:c,cols:h}}catch(m){Ba.a.J(512500001,822,10,"Failed to get server split limits, Exception: {0}",m.toString())}return{returnValue:!1,
rows:c,cols:h}}M3i(a,b,c,h){a=this.Yda.gDa(a,b,c);b=h.K3f();h=h.HYf();let m=c=Number.MAX_VALUE;for(;a.moveNext();){const y=a.Wz;m=Math.min(m,b[y.ag]-b[y.ke]);c=Math.min(c,h[y.Nf]-h[y.fe])}return{rows:Math.max(1,Math.floor(m/xN.a)),cols:Math.max(1,Math.floor(c/xN.a))}}O1f(a){const b=Gh.s2f(a,!1);b.style||(b.style=new jq.a);a=Object(ua.a)(rb.GraphIterator,this.Pb.Nc(a));a.Xu();if(a.TA(1)){if(Wb.ListReader.tk(a)){const h=this.eA.fw(a),m=Pe.a.pN(h.listType,h.listStyle);0===m.listType&&(m.qA=m.eX=h.qA);
h.propertySet.Sa(kb.a.Ri)&&m.propertySet.setValue(kb.a.Ri,h.propertySet.eb(kb.a.Ri));h.propertySet.Sa(kb.a.font)&&m.propertySet.setValue(kb.a.font,h.propertySet.eb(kb.a.font));h.propertySet.Sa(X.a.autonumberBulletType)&&m.propertySet.setValue(X.a.autonumberBulletType,h.propertySet.eb(X.a.autonumberBulletType));b.style.Ux(m.propertySet)}var c;(c=b.style).c7a.apply(c,[a.currentNode].concat(Uq.h$d()));if(c=a.TA(2)){let h;(h=b.style).c7a.apply(h,[c].concat(Uq.h$d()));a.zc()}}return b}vfj(a,b){const c=
new Yt;c.response=8;if(!a)return c;let h=null;var m=null,y=!1;const G=tg.ContextSetEditor.instance.HA(a);a=[];for(var U=0;U<G.length;++U)if(G[U].el){var ja=Object(ua.a)(5,G[U].node);if(!ja||!ja.ys())return c;ja=ja.dL();h||(h=ja.cRc());m?m!==ja&&(y=!0):m=ja}if(!h)return c;U=h.getContainingTable();if(!U)return c;if(y){b=new Qa.a;if(this.CAg){m=this.MEb.S5b(this.pa.Pa).wsb;if(m.JRa())return c;for(y=m.ke;y<m.ag;y++)b.add(y);Ba.a.J(5125E5,822,50,"Insert {0} rows",b.count)}else if(b=this.H4i(G),1!==b.count)return c;
m=U.$fj(b.ga(0));for(y=0;y<b.count;y++)Array.add(a,md.a.create(Object(ua.a)($f.a,m))),m=m.EIa}else{if(!b)for(b=m.rowSpan;0<--b;)h=h.EIa;Array.add(a,md.a.create(Object(ua.a)($f.a,h)))}c.ZC=a;c.mMb=Object(ua.a)($f.a,h);c.gp=Object(ua.a)($f.a,U);c.dgb=a.length;if(this.Ga.yv||!rd.TableReader.Cu(c.gp))c.response=32;return c}pfj(a,b){const c=new Yt;c.response=8;if(!a)return c;var h=null,m=null,y=tg.ContextSetEditor.instance.HA(a);let G=!1;a=[];for(let ja=0;ja<y.length;++ja)if(y[ja].el){var U=Object(ua.a)(5,
y[ja].node);if(!U||!U.ys())return c;U=U.dL();h||(h=U.bZf());m?m!==U&&(G=!0):m=U}if(!m)return c;h=h.getContainingTable();if(!h)return c;if(G){b=new Qa.a;if(this.CAg){m=this.MEb.S5b(this.pa.Pa).wsb;if(m.JRa())return c;for(y=m.fe;y<m.Nf;y++)b.add(y);Ba.a.J(512499998,822,50,"Insert {0} columns",b.count)}else if(b=this.F4i(y),1!==b.count)return c;m=h.qf(0,b.ga(0));for(y=0;y<b.count;y++)Array.add(a,md.a.create(Object(ua.a)($f.a,m))),m=m.k_()}else b&&(m=h.qf(0,m.pi+m.colSpan-1)),Array.add(a,md.a.create(Object(ua.a)($f.a,
m)));c.ZC=a;c.mMb=Object(ua.a)($f.a,m);c.gp=Object(ua.a)($f.a,h);c.dgb=a.length;if(this.Ga.yv||!h.Lp())c.response=32;return c}H4i(a){const b=new Qa.a,c=new xa.ScriptSharpLegacyMap;let h=0;for(let G=0;G<a.length;++G)if(a[G].el){var m=Object(ua.a)(5,a[G].node);if(m&&m.ys()){h++;var y=m.dL();m=y.rowIndex;for(y=m+y.rowSpan;m<y;m++)if(c.Hb(m)){let U;c.$(U=m,c.ga(U)+1)}else c.add(m,1)}}for(let G of c.keys)c.ga(G)===h&&b.add(G);return b}F4i(a){const b=new Qa.a,c=new xa.ScriptSharpLegacyMap;let h=0;for(let G=
0;G<a.length;++G)if(a[G].el){var m=Object(ua.a)(5,a[G].node);if(m&&m.ys()){h++;var y=m.dL();m=y.pi;for(y=m+y.colSpan;m<y;m++)if(c.Hb(m)){let U;c.$(U=m,c.ga(U)+1)}else c.add(m,1)}}for(let G of c.keys)c.ga(G)===h&&b.add(G);return b}rfj(a){return xn.a(a)}tfj(a){const b=new Yt;b.response=8;if(!a)return b;if(a.Gl){var c=a.o0a;a=a.qja;if(!c||!a)return b;c=Object(ua.a)(123,c.currentNode);a=Object(ua.a)(123,a.currentNode);if(!c||!a)return b;var h=c.pi;a=a.pi;if(h>a){var m=h;h=a;a=m}}else{c=me.a.Wrb(a);c=
tg.ContextSetEditor.instance.HA(c);if(!c||1>c.length||!c[0].el)return b;c=Object(ua.a)(5,c[0].node);if(!c||!c.ys())return b;c=c.dL();a=h=c.pi}m=this.yc.T5b(c);if(!m||14!==m.type||0>h||0>a)return b;const y=[];let G=m.qf(0,h);if(!G)return b;for(;h<=a;)Array.add(y,md.a.create(Object(ua.a)($f.a,G))),G=G.k_(),h++;b.ZC=y;b.mMb=Object(ua.a)($f.a,c);b.gp=Object(ua.a)($f.a,m);b.dgb=y.length;if(this.Ga.yv||!m.Lp())b.response=32;return b}xfj(a){const b=new Yt;b.response=8;if(!a)return b;if(a.Gl){var c=a.o0a;
a=a.qja;if(!c||!a)return b;var h=gk.c(c);a=gk.c(a);c=Object(ua.a)(Tl.TableCellNode,c.currentNode);if(h>a){var m=h;h=a;a=m}}else{a=me.a.Wrb(a);a=tg.ContextSetEditor.instance.HA(a);if(!a||1>a.length||!a[0].el)return b;a=Object(ua.a)(5,a[0].node);if(!a||!a.ys())return b;c=a.dL();a=h=c.rowIndex}if(!c)throw Ba.a.J(512499997,822,10,"TypeCasting to ITableCellNode failed"),Error.argumentNull("TypeCasting to ITableCellNode failed");m=c.getContainingTable();if(!m||14!==m.type||0>h||0>a)return b;const y=[];
let G=m.qf(h,0).cRc();for(;h<=a;)Array.add(y,md.a.create(Object(ua.a)($f.a,G))),G=G.EIa,h++;b.ZC=y;b.mMb=Object(ua.a)($f.a,c);b.gp=Object(ua.a)($f.a,m);b.dgb=y.length;if(this.Ga.yv||!rd.TableReader.Cu(b.gp))b.response=32;return b}foj(a,b){if(a=Object(ua.a)(Tl.TableCellNode,a.currentNode)){if(b)for(b=a.colSpan;0<b--;)a=a.k_();else a=a.W8a();a&&(b=a.getContainingTable().firstRow,a=a.getContainingTable().qf(b.rowIndex,a.pi),a=a.Ry(),rb.GraphIterator.nb(Object(ua.a)($f.a,a)))}}l8d(a,b,c){const h=new Yt;
h.response=8;if(!a||!c||!c.Pa)return h;const m=[],y=[];c=c.Pa;if(c.Gl){if(c=this.MEb.S5b(c))if(a=c.wsb,c=c.tableNode.firstRow,b)for(b=0;b<=a.Sle;b++){var G=c.rowIndex;G>=a.zUf&&G<=a.Sle&&m.push(c);c=c.EIa}else for(b=c.rUf,c=0;c<=a.Kle;c++)G=b.pi,G>=a.sUf&&G<=a.Kle&&y.push(b),b=b.k_()}else for(a=tg.ContextSetEditor.instance.HA(a),c=0;c<a.length;++c)if(a[c].el){G=Object(ua.a)(5,a[c].node);if(!G||!G.ys())return h;var U=G.dL();if(b)for(G=U.rowSpan,U=U.cRc();0<G--;)Array.contains(m,U)||m.push(U),U=U.EIa;
else for(G=U.colSpan,U=U.bZf();0<G--;)Array.contains(y,U)||y.push(U),U=U.k_()}if(!m.length&&!y.length)return h;b=[];for(a=0;a<m.length;a++)Array.add(b,md.a.create(Object(ua.a)($f.a,m[a])));for(a=0;a<y.length;a++)Array.add(b,md.a.create(Object(ua.a)($f.a,y[a])));h.ZC=b;h.mMb=0<m.length?Object(ua.a)($f.a,m[0]):Object(ua.a)($f.a,y[0]);h.gp=0<m.length?Object(ua.a)($f.a,m[0].getContainingTable()):Object(ua.a)($f.a,y[0].getContainingTable());if(this.Ga.yv||!Object(ua.a)(175,h.gp).Lp())h.response=32;return h}tHj(a){if(!a.ZC)return!1;
for(let c=0;c<a.ZC.length;c++){var b=Object(ua.a)(md.a,a.ZC[c]);if(b&&(b=Object(ua.a)(155,b.node))){b=this.yc.L9a(b);for(const h of b)if(h&&h.tyb)return!0}}return!1}sHj(a){if(!a.ZC)return!1;var b=Object(ua.a)(175,a.gp);if(!b)return!1;var c=Object(ua.a)(md.a,a.ZC[0]);if(!c)return!1;c=Object(ua.a)(123,c.node);if(!c)return!1;c=Object(ua.a)(rb.GraphIterator,this.Pb.Nc(c));c.rc(14);b=this.yc.rk(b);a=a.ZC.length;const h=new rb.GraphIterator;h.Rc(c);for(let m=0;m<b;m++){for(let y=0;y<a;y++){const G=Object(ua.a)(123,
c.currentNode);if(G&&G.tyb)return!0;c.Af(1)}Gd.moveToNextRow(h);c.Rc(h)}return!1}Uwb(a){let b=null;a&&14===a.type&&(b=this.yc.r9d(a.firstRow));return b}zZe(a,b,c,h,m){var y=ru.PEa(a);a=ru.PEa(a,!0);if(y||a)y=this.QFa.Pm(c.Zb-c.hc),c=this.QFa.Pm(c.Xb-c.kc),h._x+=this.QFa.Pm(m.right),h._y+=this.QFa.Pm(m.bottom),b.setPosition(h.x-y,h.y-c,!0)}Ngj(){var a=null;const b=this.ua.Ba;var c=this.pa.rv();if(Rd.a("FixColorPickerSelectedColor")){if(!c||!c.length){if(c=this.pa.Ym())a=c.qf(0,0),a=Uf.Box4ColorHelper.DDa(a.cellShading.solidFillField,
b.Ne);return a}(c=c[0])&&(a=c.cellShading&&c.cellShading.solidFillField?Uf.Box4ColorHelper.DDa(c.cellShading.solidFillField,b.Ne):this.jA.IQc(Object(ua.a)($f.a,c)))}return a}static zSi(a,b,c,h,m,y){const G=Nc.a.Ik("HandleSelectTableBorderType");G.Va("CommandId",a.toString());G.Va("BorderType",b);G.Va("BorderWidth",c);G.Va("BorderColor",h);G.Va("CommandLocation",m);try{return y()}finally{G.finish(!0)}}static PEa(a,b=!1){return a.equals(ke.a.Ku)?!0:b?a.equals(ke.a.north)||a.equals(ke.a.yE):a.equals(ke.a.west)||
a.equals(ke.a.IH)}}Object(n.a)(ru,"TableActor",null,[227]);class Rv{constructor(){this.marginRight=this.marginLeft=this.marginBottom=this.marginTop=0}}Object(n.a)(Rv,"TableCellMargin",null,[]);class Sv{constructor(a,b,c,h,m,y,G,U){this.hIa=null;this.F6c=0;this.QFl=te.a.Mgd(2);this.DKf=Object.assign(new Rv,{marginTop:.05,marginBottom:.05,marginLeft:.1,marginRight:.1});this.CKf=Object.assign(new Rv,{marginTop:0,marginBottom:0,marginLeft:0,marginRight:0});this.BKf=Object.assign(new Rv,{marginTop:.05,
marginBottom:.05,marginLeft:.05,marginRight:.05});this.NKf=Object.assign(new Rv,{marginTop:.15,marginBottom:.15,marginLeft:.15,marginRight:.15});this.REh=Object.assign(new Rv,{marginTop:-1,marginBottom:-1,marginLeft:-1,marginRight:-1});if(a)if(b)if(c)if(h)if(m)if(y){if(!G)throw Ba.a.J(512499990,822,50,"Table Cell Margin Actor constructor argument:functionThrottlerFactory cannot be null"),Error.argumentNull("Table Cell Margin Actor constructor argument:functionThrottlerFactory cannot be null");if(!U)throw Ba.a.J(512499989,
822,50,"Table Cell Margin Actor constructor argument:pageView cannot be null"),Error.argumentNull("Table Cell Margin Actor constructor argument:pageView cannot be null");}else throw Ba.a.J(512499991,822,50,"Table Cell Margin Actor constructor argument:tableReader cannot be null"),Error.argumentNull("Table Cell Margin Actor constructor argument:tableReader cannot be null");else throw Ba.a.J(512499992,822,50,"Table Cell Margin Actor constructor argument:selectionManager cannot be null"),Error.argumentNull("Table Cell Margin Actor constructor argument:selectionManager cannot be null");
else throw Ba.a.J(512499993,822,50,"Table Cell Margin Actor constructor argument:graphTopologyManager cannot be null"),Error.argumentNull("Table Cell Margin Actor constructor argument:graphTopologyManager cannot be null");else throw Ba.a.J(512499994,822,50,"Table Cell Margin Actor constructor argument:transactionFactory cannot be null"),Error.argumentNull("Table Cell Margin Actor constructor argument:transactionFactory cannot be null");else throw Ba.a.J(512499995,822,50,"Table Cell Margin Actor constructor argument:applicationSettings cannot be null"),
Error.argumentNull("Table Cell Margin Actor constructor argument:applicationSettings cannot be null");else throw Ba.a.J(512499996,822,50,"Table Cell Margin Actor constructor argument:actionManager cannot be null"),Error.argumentNull("Table Cell Margin Actor constructor argument:actionManager cannot be null");this.ia=a;this.Ga=b;this.Jb=c;this.ua=h;this.pa=m;this.yc=y;this.a5j=G.tWd(50,Object(F.a)(this,this.S5a,"applyPendingChangesToServerIfRequired"));this.Fb=U}vb(){this.ia.ra(M.a.FZe,xb.a.view,Object(F.a)(this,
this.J6b,"handleTableCellMargins"),4);this.ia.ra(M.a.Jrc,xb.a.tableCell,Object(F.a)(this,this.J6b,"handleTableCellMargins"),4);this.ia.ra(M.a.Mid,nc.a.application,Object(F.a)(this,this.JUc,"handleQueryTableCellDefaultMargins"),96);this.ia.ra(M.a.Irc,xb.a.tableCell,Object(F.a)(this,this.J6b,"handleTableCellMargins"),4);this.ia.ra(M.a.Lid,nc.a.application,Object(F.a)(this,this.JUc,"handleQueryTableCellDefaultMargins"),96);this.ia.ra(M.a.Hrc,xb.a.tableCell,Object(F.a)(this,this.J6b,"handleTableCellMargins"),
4);this.ia.ra(M.a.Kid,nc.a.application,Object(F.a)(this,this.JUc,"handleQueryTableCellDefaultMargins"),96);this.ia.ra(M.a.Mrc,xb.a.tableCell,Object(F.a)(this,this.J6b,"handleTableCellMargins"),4);this.ia.ra(M.a.Nid,nc.a.application,Object(F.a)(this,this.JUc,"handleQueryTableCellDefaultMargins"),96);this.ia.ya(M.a.Jrc,xb.a.view,wc.Gja);this.ia.ya(M.a.Irc,xb.a.view,wc.Gja);this.ia.ya(M.a.Hrc,xb.a.view,wc.Gja);this.ia.ya(M.a.Mrc,xb.a.view,wc.Gja);this.ia.ra(M.a.Grc,xb.a.view,Object(F.a)(this,this.QUc,
"handleTableCellCustomMargins"),4);this.ia.ra(M.a.Pmc,xb.a.view,Object(F.a)(this,this.IUc,"handleQueryTableCellCustomMargins"),96);this.ia.ra(M.a.Krc,xb.a.view,Object(F.a)(this,this.QUc,"handleTableCellCustomMargins"),4);this.ia.ra(M.a.Qmc,xb.a.view,Object(F.a)(this,this.IUc,"handleQueryTableCellCustomMargins"),96);this.ia.ra(M.a.Lrc,xb.a.view,Object(F.a)(this,this.QUc,"handleTableCellCustomMargins"),4);this.ia.ra(M.a.Rmc,xb.a.view,Object(F.a)(this,this.IUc,"handleQueryTableCellCustomMargins"),96);
this.ia.ra(M.a.Frc,xb.a.view,Object(F.a)(this,this.QUc,"handleTableCellCustomMargins"),4);this.ia.ra(M.a.Omc,xb.a.view,Object(F.a)(this,this.IUc,"handleQueryTableCellCustomMargins"),96)}De(){}J6b(a,b,c,h,m){return this.ath(a)?1===c?32:zg.a("HandleTableCellMargins:Entry point:"+this.ia.wq,a,()=>{if(!m)return Ba.a.J(512499987,822,50,"HandleTableCellMargins: actionData cannot be null"),16;if(!b||!b.node)return Ba.a.J(512499986,822,50,"HandleTableCellMargins: Either node context is null or unable to extract Table cell node from context"),
16;const y=b.node,G=this.rTi(a);if(!G)return Ba.a.J(512499985,822,50,"HandleTableCellMargins: unable to get Table cell margins"),16;const U=this.Jb.le(15);U.nc(y);U.jd=a;this.pvf(y,G);U.dispose();Ba.a.J(512499984,822,50,"HandleTableCellMargins: EntryPoint={1} ActionId={2}",this.ia.wq,a);return 32}):(Ba.a.J(512499988,822,50,"HandleTableCellMargins: ShouldExecuteTableEditMarginsAction returned false"),8)}JUc(a,b,c,h,m){if(!this.Ga.fNb)return 8;b=Object(ua.a)(Ph.a,m);if(!b)return 16;h=this.pa.Ym();if(!h)return Ba.a.J(512499983,
822,50,"QueryTableCellDefaultMarginsOptions: unable to get valid tableNode"),16;c=this.pa.rv();if(!c)return 16;c.length||(c=this.yc.DF(h));if(!c||!c.length)return Ba.a.J(512499982,822,50,"QueryTableCellDefaultMarginsOptions: unable to get valid cellNodes"),16;h=!1;switch(a){case M.a.Mid:h=this.ZQc(c,this.DKf);break;case M.a.Lid:h=this.ZQc(c,this.CKf);break;case M.a.Kid:h=this.ZQc(c,this.BKf);break;case M.a.Nid:h=this.ZQc(c,this.NKf)}b.Qf(h);return 32}ZQc(a,b){for(const c of a)if(c&&!c.isGhostCell&&
(te.a.Jv(c.marginTop)!==b.marginTop||te.a.Jv(c.marginBottom)!==b.marginBottom||te.a.Jv(c.marginLeft)!==b.marginLeft||te.a.Jv(c.marginRight)!==b.marginRight))return!1;return!0}rTi(a){let b=lh.b(this.REh);switch(a){case M.a.Jrc:b=this.DKf;break;case M.a.Irc:b=this.CKf;break;case M.a.Hrc:b=this.BKf;break;case M.a.Mrc:b=this.NKf}return b}pvf(a,b){0<=b.marginLeft&&(a.marginLeft=te.a.MW(b.marginLeft));0<=b.marginRight&&(a.marginRight=te.a.MW(b.marginRight));0<=b.marginTop&&(a.marginTop=te.a.MW(b.marginTop));
0<=b.marginBottom&&(a.marginBottom=te.a.MW(b.marginBottom))}ybi(a,b){b=Math.max(te.a.MW(this.QFl+b.marginLeft+b.marginRight),a);kf.a.Uy(b,a)||(a={},a.Number=te.a.Jv(b),this.ia.La(M.a.JKa,2,a))}ath(a){if(!this.ua.Ba)return!1;const b=this.pa.Jp();return!!b&&b.ud&&(this.Ga.fNb&&Array.contains(Sv.y_k,a)||this.Ga.Ekb&&Array.contains(Sv.J_k,a))}IUc(a,b,c,h,m){if(!this.Ga.Ekb)return 8;b=this.pa.Ym();if(!b)return Ba.a.J(512499981,822,50,"HandleQueryTableCellCustomMargins: unable to get valid tableNode"),
16;c=this.pa.rv();if(!c)return Ba.a.J(512499980,822,50,"HandleQueryTableCellCustomMargins: unable to get selected table cells"),16;c.length||(c=this.yc.DF(b));if(!c||!c.length)return Ba.a.J(512499979,822,50,"HandleQueryTableCellCustomMargins: unable to get valid cellNodes"),16;b=this.Zgj(c,a);this.tpc(m,te.a.Jv(b));Ba.a.J(512499978,822,50,"HandleQueryTableCellCustomMargins: EntryPoint={1} ActionId={2}",this.ia.wq,a);return 32}Zgj(a,b){let c=-1,h=-1;for(const m of a)if(m&&!m.isGhostCell){switch(b){case M.a.Pmc:c=
m.marginLeft;break;case M.a.Qmc:c=m.marginRight;break;case M.a.Rmc:c=m.marginTop;break;case M.a.Omc:c=m.marginBottom}if(0<=h&&h!==c)return-1;h=c}return c}tpc(a,b){a=a.queryResult;null!==a&&(a.uaa=parseFloat(b.toFixed(2)).toString())}QUc(a,b,c,h,m){return this.ath(a)?1===c?32:zg.a("HandleTableCellCustomMargins:Entry point:"+this.ia.wq,a,()=>{if(!m)return Ba.a.J(512499976,822,50,"HandleTableCellCustomMargins: actionData cannot be null"),16;const y=this.pa.Ym();if(!y)return Ba.a.J(512499975,822,50,"HandleTableCellCustomMargins: unable to get valid tableNode"),
16;let G=this.pa.rv();if(!G)return Ba.a.J(512499974,822,50,"HandleTableCellCustomMargins: unable to get selected table cells"),16;G.length||(G=this.yc.DF(y));this.wnk(a,G,m);Ba.a.J(512499973,822,50,"HandleTableCellCustomMargins: EntryPoint={1} ActionId={2}",this.ia.wq,a);return 32}):(Ba.a.J(512499977,822,50,"HandleTableCellCustomMargins: ShouldExecuteTableEditMarginsAction returned false"),8)}wnk(a,b,c){this.F6c!==a&&(this.S5a(),this.F6c=a);this.hIa||(this.hIa=[]);zg.a("OnCustomMarginChange:Entry point:"+
this.ia.wq,a,()=>{for(let m=0;m<b.length;m++){var h=b[m];if(!h||!h||h.isGhostCell)continue;const y=Object(ua.a)(Zs,h.sc(this.Fb.Ma));if(y){this.hIa[m]||(this.hIa[m]=new Vw.a(h,this.ckj(h)));h=this.hIa[m];switch(a){case M.a.Grc:h.second.marginLeft=c.Number;break;case M.a.Krc:h.second.marginRight=c.Number;break;case M.a.Lrc:h.second.marginTop=c.Number;break;case M.a.Frc:h.second.marginBottom=c.Number}y.Y4k(h.second,a)}}return 32});this.a5j.perform()}S5a(){this.Ga.Ekb&&this.hIa&&this.hIa.length&&(zg.a("ApplyPendingChangesToServerIfRequired:Entry point:"+
this.ia.wq,this.F6c,()=>{const a=this.Jb.le(15);try{a.jd=this.F6c;let b=null;for(const c of this.hIa)b||(b=c.first.getContainingTable(),a.nc(b)),this.pvf(c.first,c.second),this.ybi(c.first.width,c.second);a.dispose()}finally{a&&a.dispose()}return 32}),this.hIa=null)}ckj(a){const b=lh.b(this.REh);b.marginLeft=te.a.Jv(a.marginLeft);b.marginRight=te.a.Jv(a.marginRight);b.marginTop=te.a.Jv(a.marginTop);b.marginBottom=te.a.Jv(a.marginBottom);return b}}Sv.y_k=[M.a.FZe,M.a.Jrc,M.a.Irc,M.a.Hrc,M.a.Mrc];Sv.J_k=
[M.a.Grc,M.a.Krc,M.a.Lrc,M.a.Frc];Object(n.a)(Sv,"TableCellMarginActor",null,[227]);class Bq{constructor(a,b,c,h,m,y,G,U){this.Bm=this.Vgc=null;this.jUg=0;this.L4c=!1;this.Cwe=this.vAe=this.KUg=this.Bqg=this.JUg=this.Aqg=null;this.jA=a;this.Uk=b;this.Tte=c;this.C0=h;this.CAe=m;this.Vck=y;this.Qck=G;this.JWa=U}kol(a,b){const c=new Sys.StringBuilder('<div class="PreviewStyleContainer" aria-hidden="true" style="display:table-cell; text-align:center; vertical-align:middle;">');this.Qce(a,b);try{c.append(String.format('<table class="TableStylePreview" style="background:{0}">',
this.Uk.Crb(this.Uk.F5d(this.Vgc),this.Bm)));for(a=0;5>a;a++){c.append("<tr>");for(b=0;5>b;b++){const h=this.vAe.u4d(a,b,1,1),m=this.J_f(this.Cwe,this.Bm,a,b),y=this.Uk.Crb(h.Sa(X.a.cellShading)?h.Lh(X.a.cellShading):wl.a.Otb,this.Bm),G=new Sys.StringBuilder;for(let U=0;U<Bq.fbc.length;U++){const ja=Fp.LSa(Bq.d2c[U]),va=h.sa(ja.i6a,wl.a.MLc),Ta=h.sa(ja.Mrb,wl.a.Mtb);G.append(Bq.fbc[U]);if(va.lD===hb.a.auto){const fb=this.Uk.p4d(.0277777777777778);G.append(String.format("inset {0}px transparent",fb))}else G.append(this.Uk.C3d(Ta,
.0277777777777778,va));G.append(";")}c.append(String.format('<td style="color: {0}; background-color: {1}; {2}">',m,y,G));c.append("<div>&#x2014;</div>");c.append("</td>")}c.append("</tr>")}c.append("</table></div>")}finally{this.L4c&&this.Okh()}return c.toString()}p3i(a,b){const c=[];this.Qce(a,b);try{for(a=0;5>a;a++)for(b=0;5>b;b++){const h={},m=this.vAe.u4d(a,b,1,1),y=this.J_f(this.Cwe,this.Bm,a,b);h.color=y;const G=this.Uk.Crb(m.Sa(X.a.cellShading)?m.Lh(X.a.cellShading):wl.a.Otb,this.Bm);h["background-color"]=
G;h.overflow="visible";for(let U=0;U<Bq.fbc.length;U++){let ja=null,va=null,Ta=null;({OPa:ja,i6a:va,Mrb:Ta}=Fp.LSa(Bq.d2c[U]));let fb;if(this.JWa){const Pc=Uf.Box4ColorHelper.oV({Color:"##T,0,0,0"}),yc=vg.a.ui(m,va,Pc),Vd=Uf.Box4ColorHelper.Doa(yc),De=Uf.Box4ColorHelper.LJ(Vd,this.Bm);fb=De?Uf.Box4ColorHelper.Poa(De):null}else fb=m.sa(va,wl.a.MLc);const Db=m.sa(Ta,wl.a.Mtb),gc=Bq.fbc[U].substring(0,Bq.fbc[U].length-1),hc=m.sa(ja,wl.a.Ntb),Gc=this.JWa&&Rd.a("TableBordersLocalRenderingFix");if(Gc&&
!hc||!Gc&&fb.lD===hb.a.auto){const Pc=this.Uk.p4d(.0277777777777778);h[gc]=String.format("inset {0}px transparent",Pc)}else h[gc]=this.Uk.C3d(Db,.0277777777777778,fb)}c.push(h)}}finally{this.L4c&&this.Okh()}return c}GTc(a,b){this.Qce(a,b);a={};a.background=this.Uk.Crb(this.Uk.F5d(this.Vgc),this.Bm);return a}Qce(a,b){this.Vgc=this.C0.N5b(a).YX;this.jUg=this.jA.U6d(b);this.Bm=this.Tte.A4f(b).Ne;this.L4c=this.axj(this.Vgc);this.Aqg=this.Bm.PresetSchemeColorMapping.Background1;this.JUg=this.Bm.PresetSchemeColorMapping.Text1;
this.Bqg=this.Bm.PresetSchemeColorMapping.Background2;this.KUg=this.Bm.PresetSchemeColorMapping.Text2;this.L4c&&(this.Bm.PresetSchemeColorMapping.Background1=this.Bm.PresetSchemeColorMapping.Light1,this.Bm.PresetSchemeColorMapping.Text1=this.Bm.PresetSchemeColorMapping.Dark1,this.Bm.PresetSchemeColorMapping.Background2=this.Bm.PresetSchemeColorMapping.Light2,this.Bm.PresetSchemeColorMapping.Text2=this.Bm.PresetSchemeColorMapping.Dark2);a=this.CAe(()=>5,()=>5,()=>this.jUg,()=>null,()=>this.Bm,()=>
this.Vgc);this.vAe=this.Vck(a);this.Cwe=this.Qck(a)}Okh(){this.Bm.PresetSchemeColorMapping.Background1=this.Aqg;this.Bm.PresetSchemeColorMapping.Text1=this.JUg;this.Bm.PresetSchemeColorMapping.Background2=this.Bqg;this.Bm.PresetSchemeColorMapping.Text2=this.KUg}axj(a){if(a.tblBgField&&a.tblBgField.fillField)return!1;if(!a.wholeTblField||!a.wholeTblField.tcStyleField)return!0;a=a.wholeTblField.tcStyleField.fillField;return!a||a.noFillField?!0:!1}J_f(a,b,c,h){let m="black";a&&(m=a.CZf(b,c,h,1,1).jV());
return m}}Bq.fbc=["border-top:","border-left:","border-bottom:","border-right:"];Bq.d2c=[7,5,0,6];Object(n.a)(Bq,"TableStylePreviewGenerator",null,[329]);class BE extends Vx{constructor(){super()}get Type(){return 6}}Object(n.a)(BE,"TableStyleGalleryButtonProps",Vx,[]);class CE{}CE.Rjk=2147483647;Object(n.a)(CE,"TableStyleUtil",null,[]);class Uo{constructor(a,b,c,h,m){this.UTd="Clear";this.f8a=null;this.Upb=a;this.zaf=c;this.Aaf=h;this.qRh=m;this.HKd=b;this.KN=u.AFrameworkApplication.KN;this.qm=u.AFrameworkApplication.qm}I2b(){}T4h(a,
b){this.I2b();const c=this.pQc(),h=c.length;if(!(0>=h)){var m=CE.Rjk,y=null;for(let va=0;va<h;va++){var G=c[va],U=this.qRh(G);m!==U&&(m=Object.assign(new di.a,{Id:"msMoreTableStyles"+U,Title:this.okj(U),ControlList:[]}),y=Object.assign(new qq.a,{Type:6,Id:"galleryMoreTableStyles"+U,ExternalGalleryId:"TableStylesGallery",Width:Uo.yyh,ElementDimensions:"Size64by48",GalleryItems:[]}),u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.hb.Np&&this.f8a&&(y.ExternalId=this.f8a[U.toString()]),Array.add(m.ControlList,
y),Array.add(b.MenuSectionList,m),m=U);var ja=this.Aaf(G);G=Uo.LZe+va;U=!!u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.hb.Np;ja=Object.assign(new BE,{Id:G,ExternalId:G,Command:"4171428777",QueryCommand:"2135594455",LabelText:ja?ta.a.pe(ja):"",Alt:U?ja:null,VerticalCenterAlign:"true"});U&&(ja.TableCellStyles=this.q5f(G,a),ja.TableStyles=this.GTc(G,a));y&&y.GalleryItems.push(ja)}}}R4h(a){const b=Object.assign(new di.a,{Id:"msMoreTableStyleCommands",DisplayMode:"Menu16",ControlsId:"ctrlMoreTableStyleCommands",
ControlList:[]}),c=Object.assign(new zf.a,{Id:"fseaClearTableFormatting",Command:"3835123874",LabelText:ta.a.pe(this.UTd),Alt:ta.a.pe(this.UTd),Image16by16:this.qm,Image16by16Class:zp.getImageClassWithCluster(this.KN,Uo.Bsi),KeyTip:CommonUIStrings.l_ClearTableFormattingKeytip});Array.add(b.ControlList,c);Array.add(a.MenuSectionList,b)}ACi(a,b){this.I2b();const c=a[Zh.a.SourceControlId],h=this.brd(c,b);if(h){var m=this.Upb.b9d(b);m=m?this.zaf(m):null;var y=this.Aaf(h),G=this.zaf(h);a[am.a.Alt]=y;a[am.a.On]=
G===m;u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.hb.Np?(b=Object.assign(new BE,{Id:c,ExternalId:c,Command:"4171428777",QueryCommand:"2135594455",TableCellStyles:this.q5f(c,b),TableStyles:this.GTc(c,b),Alt:y}),a[am.a.GalleryButtonProps]=b):(b=this.HKd.kol(h,b),a[am.a.InnerHTML]=b)}else a[am.a.InnerHTML]=null,a[am.a.Alt]=null,a[am.a.On]=!1,a[am.a.GalleryButtonProps]=null}q5f(a,b){this.I2b();return(a=this.brd(a,b))?this.HKd.p3i(a,b):null}GTc(a,b){this.I2b();return(a=this.brd(a,b))?this.HKd.GTc(a,
b):null}FDi(a,b){u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.hb.Np?a.MenuItems=this.J1f(b):a.PopulationXML=gj.l(this.J1f(b))}J1f(a){const b=Object.assign(new Mk.a,{Id:"menuMoreTableStyles",MenuSectionList:[]});this.T4h(a,b);this.R4h(b);return b}brd(a,b){return a?a.startsWith(Uo.LZe)?this.Ajj(parseInt(a.substr(Uo.LZe.length))):this.pYk(parseInt(a.substr(Uo.iol.length)),b):null}}Uo.LZe="buttonTableStyleMenu";Uo.iol="buttonTableStyleRibbon";Uo.yyh=7;Uo.Bsi="ClearTableStyle_16x16x32";Object(n.a)(Uo,
"ATableStyleRibbonControl",null,[330]);class yN extends Uo{constructor(a,b,c,h,m){super(a,m,Object(F.a)(h,h.yjj,"getStyleIdFromStyleContainer"),Object(F.a)(h,h.zjj,"getStyleNameFromStyleContainer"),Object(F.a)(h,h.rjj,"getStyleCatogeryFromStyleContainer"));this.jA=a;this.C0=h;this.UTd=ResourceStrings.L_ClearTableStyle;this.KN=xf.a.Lkc;this.qm=c.pk(xf.a.sgd);this.OAk()}okj(a){switch(a){case 1:return ResourceStrings.L_Themed;case 2:return ResourceStrings.L_Light;case 3:return ResourceStrings.L_Medium;
case 4:return ResourceStrings.L_Dark;case 5:return ResourceStrings.L_Customize;default:return ResourceStrings.L_Customize}}pYk(a,b){let c=null;(b=this.jA.U5b(b))&&(c=this.C0.t5f(b.styleIdField));return c?this.C0.ojj(c.prg,c.xyg-c.xyg%Uo.yyh+a):this.C0.Swb(a)}pQc(){return this.C0.pQc()}Ajj(a){return this.C0.Swb(a)}I2b(){this.C0.Z_d()}OAk(){this.f8a={};this.f8a["1"]="TableStylesBestMatch";this.f8a["2"]="TableStylesLight";this.f8a["3"]="TableStylesMedium";this.f8a["4"]="TableStylesDark"}}Object(n.a)(yN,
"TableStyleRibbonControls",Uo,[]);class zN{constructor(a,b,c,h,m,y,G,U,ja,va,Ta,fb,Db,gc,hc,Gc,Pc,yc){this.gE=this.OXa=null;this.ia=a;this.ff=b;this.Ga=c;this.Fa=h;this.pa=m;this.Hv=y;this.Zc=G;this.Zac=U;this.Fb=ja;this.Ea=va;this.ve=Ta;this.Fea=Db;this.yc=gc;this.Qea=hc;this.YXa=Pc;this.dA=fb;Gc.execute(Vd=>{this.OXa=Vd});this.Ga.VP&&yc.execute(Vd=>{this.gE=Vd})}get Kd(){return this.Zc.instance}get sF(){return this.Zac.value}vb(){this.ia.ra(M.a.oxf,nc.a.application,Object(F.a)(this,this.mpj,"handleBeginEditShapeTextByF2"),
4);this.ia.ra(M.a.Grb,nc.a.application,Object(F.a)(this,this.lpj,"handleBeginEditShapeText"),4);this.ia.ra(M.a.LPa,xb.a.view,Object(F.a)(this,this.npj,"handleBeginEditShapeTextForShapeMoniker"),5)}De(){const a=this.Fa.Gc(Ua.a.rg),b=this.Fa.Gc(Di.a.J2);a.bindAction(w.KeyInputManager.Na(z.a.Cuc,0),M.a.oxf);a.bindAction(w.KeyInputManager.Na(z.a.tq,0),M.a.Grb);b.bindAction(w.KeyInputManager.Na(z.a.Cuc,0),M.a.Lgi)}lpj(a,b,c){if(this.Qea&&this.Qea.isVisible())return Ba.a.J(40735957,820,50,"The slideless pane is shown, hide and replace it with new slide on default master by VK_Enter."),
this.Qea.hide(2,!0),32;if(1===c&&this.pa.ZTa())return 2;a=this.pa.Jp();if(!a)return 16;b=Object(ua.a)(4,a.I8i(Rd.a("EnableRetrieveFirstIcon")));if(a.get_smartArtModelId())a=this.Ea.vr(a);else{if(a.Rf&&b)return this.ia.La(M.a.g0a,c,b);if(a.Jf){var h=this.Ea.Yw(a);if(0<h.length)return this.ia.La(M.a.g0a,c,h[0])}else if(this.Ga.VP&&1===a.mediaType&&!a.Kg&&this.gE)return(h=this.gE.bL(a))&&h.setFocusOnPlayer(),32}return this.ia.La(M.a.LPa,c,new Al.a(a,!1))}mpj(a,b,c){a=this.pa.Jp();if(!a)return 16;a.get_smartArtModelId()&&
(a=this.Ea.vr(a));return this.ia.La(M.a.LPa,c,new Al.a(a,!1))}npj(a,b,c,h,m){if(!m||!Object(za.a)(Al.a,m))return Ba.a.J(8956046,820,10,"Invalid ActionData"),8;a=m.shapeNode;if(!a||!(a.isEditable&&!a.afa||a.Cq)||this.ff.$c(a))return 16;if(1===c)return 32;a.ud&&(c=this.yc.FN(a),c=!!c&&c.Lp(),Ba.a.J(41007122,820,50,"Entering table edit mode, isComplexTable:{0}",c),this.ia.processAction(M.a.S6a,2));if(a.Cq){if(this.sF&&this.Kd)return m=this.sF.R2(a),this.Kd.notifyAgave(m.id,11),32;Ba.a.J(18989144,820,
10,"AppForOffice package should have already been loaded.");return 8}c=a.tg(this.Fb.Ma);if(!c)return 16;this.OXa&&this.OXa.C1d(a,!0);this.YXa&&this.Ga.z3k&&this.YXa.ping();Nc.a.Ib&&(Nc.a.Ib.actionName="BeginEditShapeText",(a.Jf||a.Kg)&&gn(a));if(this.dA&&a.Rf&&c.kL())Nc.a.xk(li.a.TEc,"false"),this.ve.ieh(new Bx.a(a));else{this.Fa.xf(Ua.a.rg,m.kcl);this.Hv.kw();c.iXe();if(a.ud&&m.dJc&&(c=this.yc.FN(a))&&c.Lp())return(a=this.Fea.g2d(m.dJc.clientPoint,c,null,null))?(c=a.sc(this.Fb.Ma),this.Fb.r6(m.dJc.clientPoint,
c,a,this.Fb,!1,!1,0),32):8;a.Kg&&(c=this.Ea.rs(a))&&(c=c.tg(this.Fb.Ma))&&c.Rd&&c.Rd.aLb(!0);this.Fb.i2k(a,m.dJc)}return 32}}Object(n.a)(zN,"TextEditorLaunchingActor",null,[227]);class DE{constructor(a,b,c,h,m,y,G,U){this.ia=a;this.Fa=b;this.Ea=c;this.Hs=h;this.ff=m;this.pa=y;this.rWa=G;this.Hh=U}vb(){this.ia.ya(M.a.TBf,nc.a.application,Object(F.a)(this,this.Apj,"handleChangeCaseMenu"));this.ia.ya(M.a.BJe,nc.a.application,Object(F.a)(this,this.ctj,"handlePowerPointInsertHyperlink"));this.ia.ra(M.a.clearFormatting,
nc.a.application,Object(F.a)(this,this.Lpj,"handleClearFormatting"),4)}De(){this.Fa.Gc(Ua.a.iQ).bindAction(w.KeyInputManager.Na(z.a.mP,2),M.a.clearFormatting)}Apj(){var a=this.pa.Pa.mb;return a&&(a=a.Ua)&&(a.contextId===xb.a.Of||a.contextId===xb.a.textRange)?32:this.qIh(!0)?32:8}ctj(a,b,c,h,m){return(a=this.pa.Pa.mb)&&this.pa.RLj()?8:!a||this.pa.JUa()&&!DE.f$b(a)?8:this.ia.La(M.a.insertHyperlink,c,m)}Lpj(a,b,c){if(!this.qIh(!1))return 16;a=this.pa.Pa.mb;if(!a)return 8;2===c&&this.$Ba(a);return 32}$Ba(a){Ba.a.J(593892321,
820,50,"TextOperationsActor: Clear Formatting Triggered");var b=this.pa.Xd();let c;if((c=this.Zhj(b))&&c.length){if(1===c.length){b=a.Ua;if(!b){Ba.a.J(594614167,820,50,"TextOperationsActor: ClearCharacterFormatting - Could not create GraphNodeContext");return}if(b.contextId===xb.a.Of){this.ndi(b,c[0]);return}if(b.contextId===xb.a.textRange||b.contextId===xb.a.paragraph){this.pdi(a,c);return}}this.odi(c)}else b.length?this.$Jc(b)?Ba.a.J(593892317,820,50,"ClearFormatting on table(s)"):Ba.a.J(593892315,
820,50,"ClearFormatting attempted on non table and non text formattable shape"):Ba.a.J(593892319,820,50,"ClearFormatting triggered when nothing selected")}Zhj(a){a=this.Ea.n_(a,!1);const b=[];let c=!0;for(const h of a)h.Jf&&(c=!1,1!==a.length&&this.Xal(h,a)?b.push.apply(b,this.Ugh(h,a,!1)):b.push.apply(b,this.Ugh(h,a,!0)));return c?a:b}Xal(a,b){for(const c of b)if(c&&!c.Jf&&(b=c.rs(),!b||a!==b))return!1;return!0}Ugh(a,b,c=!1){const h=[];for(const m of b)if(m!==a)h.push(m);else if(c){const y=this.Ea.n_(this.pa.YO(b),
!1);h.push.apply(h,y)}return h}odi(a){this.Hs.a8a(b=>{this.fTe(b,0,this.Rhj(b))},a)}pdi(a,b){const c=a.Ua,h=this.E0f(c,b[0]);if(c.contextId===xb.a.paragraph||-1!==h){var m=this.Rkj(a);this.Hs.a8a(y=>{this.fTe(y,h,m)},b)}}ndi(a,b){const c=this.rWa.x5b(a);if(c){var h=c.Ua,m=this.E0f(a,b)+h.Qa;this.Hs.a8a(y=>{this.fTe(y,m,h.Nb-h.Qa)},[b])}}fTe(a,b,c){a.te(X.a.clearFormatting,!0);a.te(X.a.E_e,b);a.te(X.a.D_e,c)}E0f(a,b){let c=0,h=!1;if(!this.Hh.Yd(a.node))return-1;const m=a.node;this.Ea.DJ(b,y=>{y===
m?h=!0:h||(c+=this.Hh.textLength(y)+1)});return h?a.contextId===xb.a.paragraph||a.contextId===xb.a.Of?c:c+a.Qa:-1}Rkj(a){let b=0;for(let c=0;c<a.length;c++){const h=a.ga(c);h.contextId===xb.a.textRange?b+=h.Nb-h.Qa:h.contextId===xb.a.paragraph?b+=this.Hh.textLength(h.node)+1:h.contextId===xb.a.endOfParagraph&&b++}return b}Rhj(a){let b=0;if(a.sC)return 1;this.Ea.DJ(a,c=>{b+=this.Hh.textLength(c)+1});return b}$Jc(a){for(const b of a)if(b.ud)return!0;return!1}qIh(a){const b=this.pa.Xd();if(!b||1>b.length)return!1;
const c=this.pa.Ym();if(c&&!a&&1===b.length)return!1;a=this.Ea.n_(b);return 1>a.length&&!c||this.ff.qC(a)||this.ff.qC([c])?!1:!0}static f$b(a){if(1===a.length)return!0;if(2===a.length){const b=a.Ua;a=a.ga(1);return!(!Bb.SelectionEditor.ek(b)||!Bb.SelectionEditor.Wl(a)||b.node!==a.node)}return!1}}Object(n.a)(DE,"TextOperationsActor",null,[227]);class EE{HYd(a,b,c){return 1===c?32:EE.EJi(b.node)}static EJi(a){const b=new rb.GraphIterator;b.set(a);b.Xu();if(Je.b(b))return 2;a=new t.GraphTransaction(7);
a.yy(b);b.Mi();a.dispose();return 32}}Object(n.a)(EE,"DeleteOutlineLevelContentStrategy",null,[]);class gl{constructor(){this.kPh=new EE}vb(a){const b=Object(F.a)(this.XLc,this.XLc.IYd,"deleteView"),c=Object(F.a)(this,this.HYd,"deleteOutlineLevelContent"),h=Object(F.a)(this.iLf,this.iLf.FJi,"deleteParagraphContent");a.ya(D.a.backspace,xb.a.Of,h);a.ya(D.a.backspace,xb.a.textRange,h);a.ya(D.a.backspace,xb.a.endOfParagraph,ed.ActionManager.ov);a.ya(D.a.backspace,xb.a.outline,c);a.ya(D.a.backspace,xb.a.view,
b);a.he(D.a.backspace,1124);a.ya(D.a.KCa,xb.a.Of,ed.ActionManager.ov);a.ya(D.a.KCa,xb.a.textRange,h);a.ya(D.a.KCa,xb.a.endOfParagraph,ed.ActionManager.ov);a.ya(D.a.KCa,xb.a.outline,c);a.ya(D.a.KCa,xb.a.view,b);a.ra(D.a.Ctb,xb.a.view,b,1124);a.ya(D.a.TK,xb.a.Of,h);a.ya(D.a.TK,xb.a.textRange,h);a.ya(D.a.TK,xb.a.endOfParagraph,ed.ActionManager.ov);a.ya(D.a.TK,xb.a.outline,c);a.ya(D.a.TK,xb.a.view,b);a.he(D.a.TK,1124);a.ra(D.a.$0b,xb.a.view,b,1124);a.ra(D.a.JCa,xb.a.view,gl.JCa,1028);a.ya(D.a.XQa,xb.a.view,
Object(F.a)(this.XLc,this.XLc.XQa,"deleteFromInputEvent"));a.ya(D.a.XQa,xb.a.textRange,h);a.he(D.a.XQa,1028)}HYd(a,b,c,h,m){return this.kPh.HYd(a,b,c,h,m)}static get Yl(){return vy.PageNavigator.instance}static get Ph(){return gl.Di||(gl.Di=vb.a.instance.resolve("Box4.IOutlineElementEditor"))}static get BJ(){return gl.eI||(gl.eI=vb.a.instance.resolve("Box4.Pages.IPageContentEditor"))}static get DJi(){return gl.p2a||(gl.p2a=vb.a.instance.resolve("Box4.Actors.IDeleteOutlineElementNodeStrategy"))}static get wB(){return gl.Nx||
(gl.Nx=vb.a.instance.resolve("Box4.IOutlineEditor"))}static get xe(){return gl.hd||(gl.hd=vb.a.instance.rb("Box4.IFeatureHelper"))}static JCa(a,b,c,h,m){h=b.view;if(!h.Lb||!h.Lb.Pa.mb||Bb.SelectionEditor.gx(h.Lb.Pa.mb))return 8;if(1===c)return 32;c=h.Lb.Pa;const y=c.mb;var G=y.Ua;let U=!1;var ja=null,va=!1;if(c.eH)if(Je.a(G))U=!0;else{if(G.contextId===xb.a.outline&&1===c.length){for(a=rb.GraphIterator.nb(G.node);a.Gi();)a.Mi();gl.wB.JZ(a,!0);mc.OutlineElementNavigator.wi(a);a=yd.SelectionFactory.Qg(a.currentNode,
0);h.Lb.setSelection(a);return 32}var Ta=G.node;ja=null;if($t.c(G)){var fb=Ta.sc(h.Ma);fb&&(fb=fb.tIl)&&0<=fb.width&&0<=fb.height&&(ja=new Qw.a($d.a.rf(fb.x,0),$d.a.rf(fb.y,1)));ja||(ja=kq.b(Ta))}else ja=kq.b(G.node);G=rb.GraphIterator.nb(G.node);G.Xu();gl.Yl.iKa(G);Ta=gl.BJ.D0b(G);kq.c(Ta,ja.x,ja.y);gl.wB.JZ(G,!0);ja=yd.SelectionFactory.sj(Ta,!0)}else if(1===c.length){va=c.last;G=me.a.AQa(va);if(gl.xe&&gl.xe.isFeatureEnabled(33)&&tg.ContextSetEditor.instance.nXe(G).returnValue)return 2;va=va.Ye;
va=!Je.a(va)&&!c.Gl&&(Bb.SelectionEditor.Wl(va)||Ob.ParagraphReader.tm(va)||Bb.SelectionEditor.RW(va))}va&&(va=Bb.SelectionEditor.Ql(y,!1,!1,void 0,gl.DJi.KVe(null,1)),h.Lb.setSelection(va),u.AFrameworkApplication.Ta.mi(b,D.a.rB,2,!1,null,m),ja=h.Lb.Pa.mb,h.Lb.setSelection(y));m||(m=new E.DictionaryPropertySet);m.setValue(xc.a.fub,!0);u.AFrameworkApplication.Ta.mi(b,D.a.TK,2,!0,null,m);if(ja&&ja.Ua.isValid)return h.Lb.setSelection(ja),32;c.eH&&(U||Zn.instance.hAb(a,b.xE,h));Bb.SelectionEditor.gx(h.Lb.Pa.mb)||
u.AFrameworkApplication.Ta.mi(b,D.a.rB,2,!1,null,m);return 32}}gl.eI=null;gl.Di=null;gl.p2a=null;gl.Nx=null;gl.hd=null;Object(n.a)(gl,"ADeleteActor",null,[]);class Vk{get aj(){return Dc.a.instance}FJi(a,b,c,h,m){if(1===c)return 32;h=a===D.a.backspace||a===D.a.XQa;if(Vk.Zq()&&Vk.Zq().instance&&Vk.Zq().instance.UW(b))return 4;c=b.node;var y=b.Qa;b=b.Nb;const G=Ob.ParagraphReader.text(c),U=G.length;let ja=!1;if(y===b){if(h&&!y||!h&&y===U)return 2;h?(J.a.instance.ga(14)&&({cp:y,returnValue:ja}=this.aj.jik(c,
y)),ja||(y--,ta.a.jx(G,y)&&y--),a=D.a.QBa):(J.a.instance.ga(14)&&({cp:b,returnValue:ja}=this.aj.iik(c,b)),ja||(b++,ta.a.jx(G,b)&&b++),a=D.a.WQa)}y=y===b?md.a.Kj(c,y):md.a.createTextRange(c,y,b);h=new t.GraphTransaction(15);h.jd=a;h.kd(c);c=Object(za.a)(Ks,m)&&m.V3b;if(Vk.Tf.hg&&Vk.Tf.Ny&&!c){c=Vk.Tf.Hrb();try{let va;if(({type:va}=null.j6f()).returnValue){const Ta=Object(ua.a)(10,m);if(Ta&&Ta.sa(Js.a.vfg,!1)||1===va)Vk.Tf.I9g=va}m=0;for(let Ta=null.length-1;0<=Ta;--Ta){let fb;const Db=({Zkg:fb}=null.getContext(Ta)).returnValue;
fb?(Vk.hyperlinkEditor.YFb(Db,null),m+=0,Vk.p6.VVd=b+m):this.jLf(Db)}}finally{c&&c.dispose()}}else this.jLf(y);h.dispose();return 32}static get Tf(){return Vk.fd||(Vk.fd=vb.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static get p6(){return Vk.$o||(Vk.$o=vb.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}static get Usc(){return Vk.BD||(Vk.BD=vb.a.instance.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance)}static get hyperlinkEditor(){return Vk.yn||
(Vk.yn=vb.a.instance.resolve("Box4.IHyperlinkEditor"))}static Zq(){return Vk.Hm||(Vk.Hm=vb.a.instance.Ja("Box4.IExternalSelectionManager"))}}Vk.fd=null;Vk.$o=null;Vk.BD=null;Vk.yn=null;Vk.Hm=null;Object(n.a)(Vk,"ADeleteParagraphContentStrategy",null,[]);class Tv extends Vk{constructor(){super()}jLf(a){Tv.characterPropertiesEditor.replaceTextRange(a,"")}static get characterPropertiesEditor(){return Tv.cmh||(Tv.cmh=vb.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}}Tv.cmh=null;Object(n.a)(Tv,
"DeleteParagraphContentStrategy",Vk,[]);var ZQ=d(467);class AN{constructor(a,b,c,h){this.V3e=a;this.KJ=c;this.rd=h;this.actionId=b}}Object(n.a)(AN,"DeleteActionData",null,[]);class hf{get ati(){return hf.s7e||(hf.s7e=vb.a.instance.resolve("Box4.Clipboard.IClipboardOperationCutStrategy"))}zrl(a){return!Bb.SelectionEditor.ek(a)}jhj(a,b,c){if(!a)return null;if(!c)return a;b=Bb.SelectionEditor.SRa(a,!1,!b,!0,!0,!0);return yd.SelectionFactory.wN(a,b.Ua,!1)}IYd(a,b,c,h,m){if(1===c)return 32;var y=!1;a===
D.a.$0b&&(a=D.a.TK,y=!0);a===D.a.Ctb&&(a=D.a.backspace,y=!0);a===D.a.KCa&&(b=new bC.a(Fc.App.Kb.Jd.Cn));var G=b;if(!G.view.Mh)return 2;var U=G.view.Lb;Hh.GrippersManager.instance.setVisibility(!1);G=a===D.a.TK;U=0<U.Pa.length?U.Pa.ga(0):null;y=this.jhj(U,G,y);return this.rLf(a,b,c,h,m,y,G)}rLf(a,b,c,h,m,y,G){const U=b.view,ja=U.Lb;var va=m,Ta=m;a===D.a.KCa&&(Ta=va=null,y=new Gb.Selection(m,!0));if(!y)return 32;const fb=new AN(b,a,h,Ta),Db=this.Qbl(va,G,ja);va=!1;if(({eUa:va}=this.Ath(a,Db,ja)).returnValue)return a=
va?D.a.ICa:D.a.deleteRow,u.AFrameworkApplication.Ta.mi(b,a,c,!1,h,m);let gc;G?Te.a.mark(gc=5009):Te.a.mark(gc=5011);c=new t.GraphTransaction(15);c.jd=a;c.kd(U.yg);va=null;let hc=({O0k:va}=this.$4i(a,m,ja,y)).returnValue;Ta=null;({Kpd:Ta}=tg.ContextSetEditor.instance.nXe(hc)).returnValue&&(hc=Ta);if(!hc)return c.dispose(),32;this.TBh(hc);const Gc=this.y1i(y,G);let Pc=null;G?Pc=new Zq(y):Gc&&(Pc=new Zq(Gc));Ta=!1;if(Bb.SelectionEditor.Sg(hc)){if(a===D.a.XQa)return 2;const yc=Fh.ASc(U.yg,Db);hf.LS.cG(()=>
{this.wJi(b,h,m,hc,G,Pc,y,yc,ja,Db,fb,Gc)},"DeleteViewStrategy:DeleteAtInsertionPointContext")}else hf.Tf.hg&&hf.Tf.Ny?(this.yrl(a,U.yg,hc,G,y,ja,Db,fb,Pc),Ta=!0):Ta=this.T9g(a,U.yg,hc,ja,Db,fb,Pc,va);hf.MXi(ja);this.pkh(hc);c.dispose();Te.a.mark(gc+1);return a===D.a.KCa?Ta?32:8:32}XQa(a,b,c,h,m){return b.view.Mh?this.rLf(a,b,c,h,null,m,!1):2}T9g(a,b,c,h,m,y,G,U){b=Fh.ASc(b,m);this.zrl(c)&&b.Qoa(c);a=hf.Wc.Vp(a);a.properties.$("CountOfParagraphsDeleted",hf.u5.TVd(c).toString());c=hf.$Li(hf.Ubl,Object(F.a)(this,
this.Tbl,"shouldDispatchNoSpecialize"),c,h,m,b,y,G,U);a.end();return c}yrl(a,b,c,h,m,y,G,U,ja){var va=0,Ta=null;const fb=tg.ContextSetEditor.instance.HA(c),Db=fb[fb.length-1];if(Db.contextId===xb.a.paragraph||Db.contextId===xb.a.endOfParagraph){var gc=rb.GraphIterator.nb(Db.node);gc.gf();mc.OutlineElementNavigator.Oe(gc);mc.OutlineElementNavigator.yJ(gc,!0,!1)&&(Ta=mc.OutlineElementNavigator.wi(gc))&&(va=hf.u5.textLength(Ta))}else va=hf.u5.textLength(Db.node)-Db.Nb;if((gc=Object(ua.a)(10,U.rd))&&
gc.sa(Js.a.vfg,!1))this.S9g(a,b,c,y,G,U,ja,!1);else{gc=hf.Tf.Hrb();try{this.S9g(a,b,c,y,G,U,ja,!0)}finally{gc&&gc.dispose()}}if(h){if(c.$w){a=fb.length-1;do m=fb[a],a--;while(!m.node.isConnected&&0<=a)}else m=c;if(!hf.u5.Yd(m.node))return;switch(Db.contextId){case xb.a.paragraph:case xb.a.endOfParagraph:va=Ta&&Ta.isConnected?0:va;break;case xb.a.Of:case xb.a.textRange:break;default:va=0}va=yd.SelectionFactory.Qg(m.node,hf.u5.textLength(m.node)-va);m.z5a===va.Ua.Qa&&(va.Ua.IS=m.IS)}else{va=m.Ua.node;
if(!hf.u5.Yd(va))return;Ta=m.Ua.contextId===xb.a.paragraph?0:m.Ua.contextId===xb.a.endOfParagraph?hf.u5.textLength(va):m.Ua.Qa;va=yd.SelectionFactory.Qg(va,Ta)}me.a.instance.setSelection(va)}S9g(a,b,c,h,m,y,G,U){this.O_i(h,c);!({type:ja}=null.j6f()).returnValue||U&&1!==ja||(hf.Tf.I9g=ja);for(c=null.length-1;0<=c;--c){var ja=({Zkg:U}=null.getContext(c)).returnValue;U?hf.hyperlinkEditor.YFb(ja,2):this.T9g(a,b,ja,h,m,y,G,null)}}O_i(a,b){if(Object(za.a)(ZQ.a,b))for(a=pi.Vsa(a.Pa,!0),b=0;b<a.length&&a.getContext(b).contextId!==
xb.a.table;b++);}$4i(a,b,c,h){a===D.a.KCa?(c=ib.a.EQa(b),a=Ym.SelectionReferenceFactory.instance.Yra()):(a=null,c=1===c.Pa.length?me.a.AQa(h):c.Qj);return{returnValue:c,O0k:a}}Xni(a){return!a.el||a.contextId!==xb.a.paragraph||!hf.u5.Yd(a.node)||hf.Tf.hg&&hf.Tf.Ny||J.a.instance.ga(14)&&hf.aj.pZc(a)?!1:!0}TBh(a){if(a.$w)for(let b=0;b<a.length;b++)this.TBh(a.getContext(b));else this.Xni(a)&&(a.node.hIc=!0)}pkh(a){if(a.$w)for(let b=0;b<a.length;b++)this.pkh(a.getContext(b));else a.el&&(a=a.node)&&hf.u5.Yd(a)&&
(a.hIc=!1)}wJi(a,b,c,h,m,y,G,U,ja,va,Ta,fb){const Db=new rb.GraphIterator,gc=h.node;Db.set(gc);Db.gf();Bb.SelectionEditor.rC(Db.currentNode,h,m)?this.AJi(a,b,c,h,m,y,G,U,ja,Ta,fb,Db,gc):hf.BJi(h,m,y,G,U,ja,va,Ta)}CUc(a,b,c,h){return!a&&Wb.ListReader.tk(b)?(h=hf.Qna(b,c),{returnValue:!0,response:h}):{returnValue:!1,response:h}}lrj(a,b,c,h,m,y){return J.a.instance.ga(65)&&!a&&0<Kd.OutlineElementReader.cwb(b)?(y=u.AFrameworkApplication.Ta.mi(c,D.a.Rgh,2,!1,h,m),{returnValue:!0,response:y}):{returnValue:!1,
response:y}}Hvj(a,b,c,h,m,y){return J.a.instance.ga(54)&&!a&&0<Kd.OutlineElementReader.j9a(b)?(y=u.AFrameworkApplication.Ta.mi(c,D.a.URk,2,!1,h,m),{returnValue:!0,response:y}):{returnValue:!1,response:y}}jtj(a,b,c,h,m,y){return J.a.instance.ga(80)&&!a&&hf.uv.qsb(b)?(y=u.AFrameworkApplication.Ta.mi(c,D.a.qz,2,!1,h,m),{returnValue:!0,response:y}):{returnValue:!1,response:y}}Joj(a,b,c,h,m,y,G,U,ja,va,Ta){const fb=new fn.a;fb.Rc(b);if(mc.OutlineElementNavigator.CIa(fb,!1,!a,!1)){Ta=!0;va=32;const Db=
new rb.GraphIterator;Db.Rc(fb);mc.OutlineElementNavigator.wi(fb);y&&h&&Bb.SelectionEditor.RW(h.Ua)?(c.Qoa(m),hf.Ph.BRk(b.currentNode)):fb.currentNode.QW?(J.a.instance.ga(68)&&c.Qoa(m),mc.OutlineElementNavigator.Oe(fb),fb.Mi()):J.a.instance.ga(66)&&a&&y?hf.aj.Eig(U)&&!({vya:Ta}=this.Mbh(a,U,fb.currentNode,h,Ta)).returnValue&&(c.Qoa(m),hf.eq.Qna(b),b.Mi()):rd.TableReader.aq(fb)?(c.Qoa(m),this.qLf&&({response:va,returnValue:Ta}=this.qLf.lHl(a,Db,b,fb,G,ja,va))):hf.u5.Yd(fb.currentNode)&&(({vya:Ta}=this.Mbh(a,
U,fb.currentNode,h,Ta)).returnValue||this.kLf&&this.kLf.xJi(a,c,m,b,U,fb));return{returnValue:!0,response:va,vya:Ta}}return{returnValue:!1,response:va,vya:Ta}}Mbh(a,b,c,h,m){return hf.Tf.hg&&hf.Tf.Ny&&(a=(a?b:c).Ra.last,b=u.AFrameworkApplication.userName,!a.Do||a.Do.authorName!==b)?(h&&(me.a.instance.setSelection(h),m=!1),{returnValue:!0,vya:m}):{returnValue:!1,vya:m}}jvj(a,b,c,h,m,y,G,U){return J.a.instance.ga(67)&&Kd.OutlineElementReader.pgg(b,a)?(Qe.isInTableCell(b)&&(Gd.returnToContainingCell(b),
Qe.isEmpty(b)&&c.Qoa(h),{Ucl:a,returnValue:U}=hf.Thk(b,G,a,m,y),a||(U=2)),{returnValue:!0,response:U}):{returnValue:!1,response:U}}Drj(a,b,c,h,m,y,G,U){Kd.OutlineElementReader.pgg(b,a)||({response:G,vya:U}=hf.MMi(c,h,a,y,m,G,U));return{returnValue:!1,response:G,vya:U}}AJi(a,b,c,h,m,y,G,U,ja,va,Ta,fb,Db){let gc=!1,hc=2;const Gc=hf.u5.isEmpty(fb),Pc=fb.currentNode;mc.OutlineElementNavigator.Oe(fb);({response:hc}=this.CUc(m,fb,va,hc)).returnValue||({response:hc}=this.lrj(m,fb,a,b,c,hc)).returnValue||
({response:hc}=this.Hvj(m,fb,a,b,c,hc)).returnValue||({response:hc}=this.jtj(m,fb,a,b,c,hc)).returnValue||({response:hc,vya:gc}=this.Joj(m,fb,U,Ta,h,Gc,Pc,Db,ja,hc,gc)).returnValue||({response:hc}=this.jvj(m,fb,U,h,ja,va,Pc,hc)).returnValue||({response:hc,vya:gc}=this.Drj(m,fb,b,c,U,G,hc,gc));hf.y_g(U,32===hc);gc&&hf.LU(ja,y)}Qbl(a,b,c){return a&&a.Sa(xc.a.fub)?this.ati.Vsh()||a.eb(xc.a.fub)?!a.sa(xc.a.fub,!1):this.FZf(!1,c):this.FZf(b,c)}Ath(){return{returnValue:!1,eUa:!1}}static get characterPropertiesEditor(){return hf.Zg||
(hf.Zg=vb.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static get Sf(){return hf.Ug||(hf.Ug=vb.a.instance.resolve("Box4.List.IListReader"))}static get u5(){return hf.pr||(hf.pr=vb.a.instance.resolve("Box4.IParagraphReader"))}static get hyperlinkEditor(){return hf.yn||(hf.yn=vb.a.instance.resolve("Box4.IHyperlinkEditor"))}static get eq(){return hf.Xo||(hf.Xo=vb.a.instance.resolve("Box4.List.IListEditor"))}static get Ph(){return hf.wif||(hf.wif=vb.a.instance.resolve("Box4.IOutlineElementEditor"))}static get LH(){return pm.a.instance}static get uv(){return kv.a.vwb}static get Tf(){return hf.fd||
(hf.fd=vb.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static get p6(){return hf.$o||(hf.$o=vb.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}static get Usc(){return hf.BD||(hf.BD=vb.a.instance.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance)}static get Wc(){return ec.a.instance}static get aj(){return Dc.a.instance}static get Rt(){return hf.uD||(hf.uD=vb.a.instance.resolve("Box4.IHyperlinkStrategy"))}static get LS(){return id.a.instance}static MXi(a){if(1===
a.Pa.length&&(a=a.Pa.ga(0),Bb.SelectionEditor.gx(a))){var b=a.Ua;a=b.node;b=b.Qa;var c=hf.u5.text(a);b<c.length&&0<b&&" "===c.charAt(b-1)&&" "===c.charAt(b)&&hf.characterPropertiesEditor.replaceTextRange(md.a.createTextRange(a,b-1,b),"\u00a0")}}static qgi(a,b){if(!b.hyperlink.Lyb){const c=new t.GraphTransaction(15);try{c.kd(a.node),hf.Rt.sM(a,b)}finally{c&&c.dispose()}}}static Qna(a,b){a=hf.Sf.fw(a).jZc?D.a.NR:D.a.jP;return u.AFrameworkApplication.Ta.mi(b.V3e,a,2,!1,b.KJ,b.rd)}static MMi(a,b,c,h,
m,y,G){if(c=Bb.SelectionEditor.SRa(h,!1,!c,!1,!1,!0)){h=yd.SelectionFactory.wN(h,c.Ua);y=32;for(c=0;c<h.length;++c){m.Qoa(h.ga(c));const U=u.AFrameworkApplication.Ta.mi(h.ga(c),D.a.TK,2,!0,a,b);2!==U&&(y=U)}32===y&&(G=!0)}return{response:y,vya:G}}static $Li(a,b,c,h,m,y,G,U,ja){let va=!1;a(c)?(va=hf.wZd(c,!0,h,m,y,G))&&hf.WLa(U,h,ja):b(c)?(va=hf.wZd(c,!1,h,m,y,G))&&hf.WLa(U,h,ja):(y.normalize(),hf.WLa(U,h,ja));return va}static WLa(a,b,c){c&&c.LU()||hf.LU(b,a)}static wZd(a,b,c,h,m,y){h||Yi.OutlineReader.Ika(a)||
(c=hf.fvl(c))&&m.R9k(c);a=32===u.AFrameworkApplication.Ta.mi(a,y.actionId,2,b,y.KJ,y.rd);hf.y_g(m,a);return a}static y_g(a,b){b?a.normalize():a.cancel()}static LU(a,b){b&&(b=b.restore())&&a.setSelection(b)}static BJi(a,b,c,h,m,y,G,U){let ja;!b&&({A7b:ja}=hf.Rt.yab(a)).returnValue?(c=new Zq(h),hf.qgi(a,ja),m.normalize(),hf.LU(y,c)):hf.wZd(a,!1,y,G,m,U)&&(b&&hf.Tf.hg&&hf.Tf.Ny?(b=hf.p6.VVd)?(y.setSelection(yd.SelectionFactory.Qg(a.node,b)),hf.p6.VVd=null):hf.LU(y,c):hf.LU(y,c))}static Thk(a,b,c,h,m){let y,
G=2;y=!0;if(Qe.isEmpty(a)){const U=Gd.getContainingTable(a),ja=rd.TableReader.rk(U),va=rd.TableReader.Ai(U);1===ja&&1===va?(G=u.AFrameworkApplication.Ta.mi(md.a.create(U),D.a.Q6a,2,!1,m.KJ,m.rd),h.setSelection(yd.SelectionFactory.Qg(b,0)),y=!1):1===ja?G=u.AFrameworkApplication.Ta.mi(m.V3e,D.a.ICa,2,!1,m.KJ,m.rd):(b=Qe.isEmptyIncludingTheRestOfTheRow(a),Qe.isFirstCellInRow(a)&&b?G=u.AFrameworkApplication.Ta.mi(m.V3e,D.a.deleteRow,2,!1,m.KJ,m.rd):!c&&b&&(G=32,a=Bb.SelectionEditor.Nsa(h.Pa.mb,!1,!1,
!1,!0),h.setSelection(a),y=!1))}return{returnValue:G,Ucl:y}}static Ubl(a){return a.$w||Yi.OutlineReader.Ika(a)||hf.u5.tm(a)}static fvl(a){return(a=pi.Vsa(a.Pa,!0))&&1===a.length&&(a=a.getContext(0).node,rd.TableReader.Vab(a))?a:null}}hf.Ug=null;hf.Zg=null;hf.wif=null;hf.pr=null;hf.yn=null;hf.Xo=null;hf.fd=null;hf.$o=null;hf.BD=null;hf.s7e=null;hf.uD=null;Object(n.a)(hf,"ADeleteViewStrategy",null,[]);class su{constructor(a,b){this.Pb=a;this.Hh=b}xJi(a,b,c,h,m,y){m=this.Pb.Nc(m);a&&!this.Hh.isEmpty(m)?
(mc.OutlineElementNavigator.Oe(y),b.VBh(y.currentNode),su.Ph.merge(h,y,!1,!1)):(mc.OutlineElementNavigator.Oe(y),b.Qoa(c),su.Ph.merge(y,h,!1,!1))}static get Ph(){return su.Di||(su.Di=vb.a.instance.resolve("Box4.IOutlineElementEditor"))}}su.Di=null;Object(n.a)(su,"DeleteParagraphNodeStrategy",null,[481]);class BN extends hf{constructor(a,b,c,h){super();this.n5j=new su(c,h);this.la=a;this.cGg=b;this.Pb=c}get qLf(){throw Error.notImplemented();}get kLf(){return this.n5j}y1i(a,b){return Bb.SelectionEditor.SRa(a,
!0,!b,!1,!1,!0)}Tbl(a){return Bb.SelectionEditor.ek(a)}FZf(a,b){if(!this.la.Nke||!this.la.Kzb||!this.la.Oke||a)return!1;a=this.mkj(b);return 1===(a&1)&&2!==(a&2)}mkj(a){var b=a.Pa;if(!b.length)return 0;a=Object(ua.a)(5,b.ga(0).Ua.node);if(!a||!a.ys())return 0;a=(a=(a=a.dL())?a.$5f():null)?a.getContainingTable():null;if(!a)return 0;const c=[];for(var h=0;h<b.length;++h){var m=b.ga(h);if(m){var y=pi.JRc(m,!0),G=pi.JRc(m,!1);if(y&&G){if(Bb.SelectionEditor.Du(y)&&!Bb.SelectionEditor.Dyb(y)||!Ob.ParagraphReader.eie(y.node)||
y!==G&&Bb.SelectionEditor.Du(G)&&!Bb.SelectionEditor.Dyb(G)||!Ob.ParagraphReader.FNj(G.node))return 0;if(m=Object(ua.a)(ib.a,tg.ContextSetEditor.instance.a4b(ib.a.EQa(m.toArray()),16,!1)))for(y=0;y<m.length;++y)G=Object(ua.a)(Tl.TableCellNode,m.getContext(y).node),a.Lp()&&G.isControllingCell?this.pGj(G,c):G.isGhostCell||Array.add(c,G)}}}if(!c.length)return 0;b=a.BY;h=a.N7;y=m=0;G=Array(b);const U=Array(h);for(var ja=0;ja<b;++ja)G[ja]=0;for(ja=0;ja<h;++ja)U[ja]=0;for(ja=0;ja<c.length;++ja){const va=
c[ja].$5f();++G[va.rowIndex]===h&&++m;++U[va.pi]===b&&++y}if(0<m&&0<y){if(m===b&&y===h)return 3}else if(m||y){if(0<m){if(!a.Lp())for(a=0;a<h;++a)if(U[a]!==m)return 0;return 1}if(0<y){if(!a.Lp())for(a=0;a<b;++a)if(G[a]!==y)return 0;return 1}}return 0}pGj(a,b){Qe.foreachMergedCells(Object(ua.a)($f.a,a),c=>{Array.add(b,c)})}CUc(a,b,c,h){if(!a&&Wb.ListReader.tk(b)){var m=this.Pb.zSa();m.Rc(b);if((m=Object(ua.a)(4,m.Ng(10)))&&m.Rf){if(this.cGg.qsb(b))this.cGg.uhb(b,-1,0),h=32;else if(b.FF(1)){if(b.Af(1),
({response:h}=super.CUc(a,b,c,h)).returnValue)return{returnValue:!1,response:h}}else h=32;return{returnValue:!0,response:h}}return super.CUc(a,b,c,h)}return{returnValue:!1,response:h}}Ath(a,b,c){if(!(b&&a===D.a.backspace&&c.Pa&&c.Pa.length&&c.Pa.Gl))return{returnValue:!1,eUa:!1};b=c.Ym();if(!b||!b.Lp())return{returnValue:!1,eUa:!1};a=b.BY;b=b.N7;let h=a,m=0,y=b,G=0;c=tg.ContextSetEditor.instance.HA(c.Qj);for(let va=0;va<c.length;va++){if(!c[va].el)return a=!1,{returnValue:!1,eUa:a};var U=Object(ua.a)(5,
c[va].node);if(!U||!U.ys())return a=!1,{returnValue:!1,eUa:a};var ja=(U=U.dL())?U.Ry():null;if(!ja)return a=!1,{returnValue:!1,eUa:a};U=ja.rowIndex;const Ta=ja.pi,fb=ja.rowSpan;ja=ja.colSpan;h=Math.min(h,U);m=Math.max(m,U+fb-1);y=Math.min(y,Ta);G=Math.max(G,Ta+ja-1)}return m-h+1!==a&&G-y+1!==b?{returnValue:!1,eUa:!1}:{returnValue:!0,eUa:m-h+1===a?!0:!1}}}Object(n.a)(BN,"DeleteViewStrategy",hf,[]);class CN extends gl{constructor(a,b,c,h){super();this.o5j=new BN(a,b,c,h);this.m5j=new Tv}get XLc(){return this.o5j}get iLf(){return this.m5j}}
Object(n.a)(CN,"Box4DeleteActor",gl,[]);class DN{constructor(a,b,c,h,m){this.ia=a;this.l5j=new CN(b,c,h,m);na.InteractiveViewManager.instance.editingView.u1b=!0}vb(){this.l5j.vb(this.ia)}De(){var a=D.a.backspace;const b=C.FocusManager.instance().Gc(I.AppFrame.xW);b.bindAction(w.KeyInputManager.Na(z.a.MH,0),a);b.bindAction(w.KeyInputManager.Na(z.a.MH,4),D.a.backspace);b.bindAction(w.KeyInputManager.Na(z.a.MH,4|w.KeyInputManager.Le),H.a.qe);b.bindAction(w.KeyInputManager.Na(z.a.MH,w.KeyInputManager.Le),
D.a.Ctb);b.bindAction(w.KeyInputManager.Na(z.a.bpa,0),D.a.TK);b.bindAction(w.KeyInputManager.Na(z.a.bpa,w.KeyInputManager.Le),D.a.$0b);v.a.uk&&(b.bindAction(w.KeyInputManager.Na(z.a.MH,3),D.a.backspace),b.bindAction(w.KeyInputManager.Na(z.a.MH,7),D.a.backspace),b.bindAction(w.KeyInputManager.Na(z.a.MH,5),D.a.backspace),b.bindAction(w.KeyInputManager.Na(z.a.MH,1),D.a.Ctb))}}Object(n.a)(DN,"DeleteActor",null,[227]);class EN{constructor(a){this.n4j=a}vb(){this.n4j.vb()}De(){}}Object(n.a)(EN,"EnterActor",
null,[227]);class Ip{constructor(a,b,c){this.Zu=a;this.SWb=b;this.Hm=c}get In(){return this.SWb.value}ORi(a,b,c,h,m){var y;if(!({If:c,selected:y,qF:ja}=this.Eth(b,c,!1)).returnValue)return ja;Te.a.mark(5013);var G=Ip.jm.HA(y);for(var U=0;U<G.length;++U){if(!G[U].isValid)continue;let va=G[U].iterator;va.Xu();if(Yi.OutlineReader.Ut(va))return this.FQf(c,va);if(Je.b(va))return Zn.instance.hAb(a,y,c),this.In.kw(),Te.a.mark(5014),32}G=this.T7i(y);if(y.$w||Bb.SelectionEditor.ek(y)||Ob.ParagraphReader.tm(y)&&
!Bb.SelectionEditor.RW(y)){if(Ip.xe&&Ip.xe.isFeatureEnabled(33)&&tg.ContextSetEditor.instance.nXe(y).returnValue)return 8;var ja=this.GQf(b,c,a,h,m,G)}else if(Bb.SelectionEditor.Wl(y))ja=this.EQf(b,c,a,h,m,G);else if(Bb.SelectionEditor.Sg(y)){ja=new rb.GraphIterator;ja.set(y.node);ja.rc(10);if(this.Sik()&&(U=Ib.HyperlinkReader.hC(y,!1),0<U.length)){if(!U[0].hyperlink)return ba.ULS.sendTraceTag(38835461,324,15,"Hyperlink is null. CpBegin: {0}, CpEnd: {1}",U[0].Qa,U[0].Nb),8;Fc.App.Q3b(U[0].hyperlink.url);
return 32}Qe.isInTableCell(ja)&&!J.a.instance.ga(77)&&(Gd.returnToContainingCell(ja),J.a.instance.ga(30)&&Qe.isLastCellInTable(ja)&&!Yi.OutlineReader.YUc(ja)&&Yi.OutlineReader.rC(ja,y,!0)&&(ii.OutlineNavigator.F$(ja),Wb.ListReader.tk(ja)||(G=D.a.Pta),Gd.returnToCell(ja)),Qe.isFirstCellInRow(ja)&&(U=new rb.GraphIterator,U.Rc(ja),Gd.returnToContainingRow(U),J.a.instance.ga(30)&&gk.j(U)&&gk.e(U)&&1<rd.TableReader.rk(Gd.getContainingTable(U))?G=D.a.deleteRow:Yi.OutlineReader.rC(ja,y,!1)&&(gk.g(U)&&0>=
y.IS?(G=D.a.d8b,Gd.returnToContainingTable(ja),mc.OutlineElementNavigator.Oe(ja),m||(m=new E.DictionaryPropertySet),m.te(xc.a.targetObject,ja.currentNode.id)):J.a.instance.ga(30)&&(G=D.a.QTa))));ja=this.IQf(b,c,a,h,m,G)}else Bb.SelectionEditor.RW(y)&&(ja=u.AFrameworkApplication.Ta.mi(b,D.a.rB,2,!1,h,m));Te.a.mark(5014);return ja}Eth(a,b,c){let h,m;m=h=null;if(1===b)return{returnValue:!1,If:h,selected:m,qF:32};if(!a.view.Mh)return{returnValue:!1,If:h,selected:m,qF:2};h=a.view;m=h.Lb.Qj;return!m||J.a.instance.ga(14)&&
!Ip.aj.Rfg(m,c)?{returnValue:!1,If:h,selected:m,qF:2}:this.Hm&&this.Hm.instance&&this.Hm.instance.UW(m)?{returnValue:!1,If:h,selected:m,qF:4}:{returnValue:!0,If:h,selected:m,qF:2}}sbl(a,b,c,h,m){let y,G;if(!({If:c,selected:y,qF:G}=this.Eth(b,c,!0)).returnValue)return G;const U=Ip.jm.HA(y);for(let ja=0;ja<U.length;++ja){if(!U[ja].isValid)continue;const va=U[ja].iterator;va.Xu();if(Yi.OutlineReader.Ut(va))return this.FQf(c,va)}y.$w||Bb.SelectionEditor.ek(y)?G=this.GQf(b,c,a,h,m,D.a.b8b):Bb.SelectionEditor.Wl(y)?
G=this.EQf(b,c,a,h,m,D.a.b8b):Bb.SelectionEditor.Sg(y)?G=this.IQf(b,c,a,h,m,D.a.b8b):Bb.SelectionEditor.RW(y)&&(G=u.AFrameworkApplication.Ta.mi(b,D.a.rB,2,!1,h,m));return G}FQf(a,b){a.Lb.setSelection(yd.SelectionFactory.sj(b.currentNode,!1));return 32}GQf(a,b,c,h,m,y){const G=new t.GraphTransaction(15);G.jd=c;G.kd(b.yg);b=new E.DictionaryPropertySet;b.setValue(xc.a.fub,!0);b=u.AFrameworkApplication.Ta.mi(a,D.a.TK,2,!0,h,b);32===b&&(b=u.AFrameworkApplication.Ta.mi(a,y,2,!1,h,m));G.dispose();return b}EQf(a,
b,c,h,m,y){const G=new t.GraphTransaction(15);G.jd=c;G.kd(b.yg);b.Lb.setSelection(Bb.SelectionEditor.Ql(b.Lb.Pa.ga(0),!1,!1));a=u.AFrameworkApplication.Ta.mi(a,y,2,!1,h,m);G.dispose();return a}IQf(a,b,c,h,m,y){const G=new t.GraphTransaction(15,c);G.jd=c;G.kd(b.yg);a=u.AFrameworkApplication.Ta.mi(a,y,2,!1,h,m);G.dispose();return a}static get jm(){return tg.ContextSetEditor.instance}static get aj(){return Dc.a.instance}static get xe(){return Ip.hd||(Ip.hd=vb.a.instance.rb("Box4.IFeatureHelper"))}}Ip.hd=
null;Object(n.a)(Ip,"AEnterViewStrategy",null,[451]);class dt extends Ip{constructor(a,b,c){super(a,b,c)}T7i(a){let b=D.a.rB;if(a&&(a=Ip.jm.HA(a))&&0<a.length){const c=new rb.GraphIterator;c.set(a[0].node);c.rc(10);(a=c.o1a())&&a.Sa(X.a.Gj)&&(a=a.eb(X.a.Gj),0===a||2===a)&&(b=D.a.b8b)}return b}Sik(){return dt.YU?!1:!0}static get YU(){null==dt.hI&&(dt.hI=u.AFrameworkApplication.fa?u.AFrameworkApplication.fa.ka("SplitHyperlinkFixWithEnterIsEnabled"):!1);return dt.hI}}dt.hI=null;Object(n.a)(dt,"EnterViewStrategy",
Ip,[]);class FE{constructor(a){this.D6j=a}xnd(a,b){this.D6j.TU(a,b)}}Object(n.a)(FE,"PPTFontNameFormattingStrategy",null,[431]);class FN{Vsh(){return!1}}Object(n.a)(FN,"PptClipboardOperationCutStrategy",null,[311]);class GN{constructor(a,b){this.YL=a;this.pa=b}QPj(a){return 10===a.ri||16===a.ri||60===a.ri}Wni(a){if(this.YL.Aab(a)&&this.YL.Gyb(a))return!1;let b=a=null;this.pa.Pa.mb&&(b=this.pa.Pa.mb.Ua,a=this.pa.Pa.mb.Ye);return this.qle(b)&&this.qle(a)}qle(a){if(a){if(a.contextId===xb.a.paragraph)return!0;
if(a.contextId===xb.a.endOfParagraph&&(a=a.node))return ta.a.Wa(a.characterData)}return!1}Jcl(a,b){return this.KVe(a,b)}KVe(a,b){let c=null;this.pa.Pa.mb&&(c=this.pa.Pa.mb.Ua);return this.qle(c)?!!a&&this.YL.Gyb(a)||1===b:!1}}Object(n.a)(GN,"PptDeleteOutlineElementNodeStrategy",null,[309]);class HN{constructor(a,b,c){this.Iq=a;this.rJ=b;this.ob=c}cRf(a){if(this.ob.Pa&&this.ob.Pa.Gl){const h=this.Iq.lYf(this.ob.Pa).returnValue;if(!h.JRa()&&a.$w){a=new ib.a;var b=this.ob.rv();for(const m of b)if(b=
Object(ua.a)(Tl.TableCellNode,m)){var c=rb.GraphIterator.nb(b);if(c.gf()){const y=gk.c(c);c=this.rJ.SQc(Object(ua.a)(123,c.currentNode));h.OTi(y,c)&&a.eia(me.a.AQa(yd.SelectionFactory.wl(b)))}}}}return a}}Object(n.a)(HN,"PptDeleteTableSegmentStrategy",null,[312]);class IN{Myh(){return!1}jig(a){return!!a&&!a.nm.equals(pa.a.nil)}}Object(n.a)(IN,"PptEopFormattingStrategy",null,[307]);class JN{constructor(a,b,c){this.C6c=!1;this.Ea=a;this.gJ=b;this.pa=c}SDh(a,b){a&&b&&(b.beforeSpacing&&(a.setValue(X.a.Kda,
b.beforeSpacing.value),a.setValue(X.a.Xka,b.beforeSpacing.Vf)),b.afterSpacing&&(a.setValue(X.a.Jda,b.afterSpacing.value),a.setValue(X.a.Wka,b.afterSpacing.Vf)),b.lineSpacing&&(a.setValue(X.a.ox,b.lineSpacing.value),a.setValue(X.a.gX,b.lineSpacing.Vf)));return!0}Ssh(){return!1}Hth(){return!1}Psh(){return!this.C6c}Bth(a,b){return a===xb.a.paragraph||a===xb.a.endOfParagraph||b}Qsh(a,b,c){this.pa.Pa&&this.pa.Pa.mb&&(c=!this.pa.Pa.mb.lca);return a!==xb.a.textRange&&(b===xb.a.paragraph||c)}stf(a,b,c){this.C6c=
!1;if(a.ys()&&this.pa.Pa.mb){var h=this.pa.Pa.mb.Ua;this.pa.Pa&&this.pa.Pa.Gl&&this.pa.Pa.ga(0)&&(h=this.pa.Pa.ga(0).Ua);if(h=uc.a.ps(Ob.ParagraphReader.Yd(h.node)?h:yd.SelectionFactory.wl(a).Ua))if(h=h.cache)!c.Sa(X.a.latinFont)&&h.Sa(X.a.latinFont)&&c.setValue(X.a.latinFont,h.zN),!c.Sa(kb.a.fontColor)&&h.C3&&c.setValue(kb.a.fontColor,h.fontColor),!c.Sa(kb.a.fontSize)&&h.Ata&&c.setValue(kb.a.fontSize,h.fontSize),!c.Sa(kb.a.bold)&&h.qTa&&c.setValue(kb.a.bold,h.isBold)}if(b){if(h=a.nQ(this.gJ)){b.GT||
a.sa(X.a.khe,!1)||h.sa(X.a.khe,!1)||(this.C6c=!0);const m=b.spacing;m&&(!m.beforeSpacing||m.beforeSpacing.value||h.Sa(X.a.Kda)||(m.beforeSpacing=null),!m.afterSpacing||m.afterSpacing.value||h.Sa(X.a.Jda)||(m.afterSpacing=null),m.lineSpacing&&2===m.lineSpacing.Vf&&1===m.lineSpacing.value&&!h.Sa(X.a.ox)&&(m.lineSpacing=null))}this.C6c||(b.GT||(b.GT=Pe.a.pN(16,0)),b.GT.bWf=!0)}if((h=a.f4f())&&!h.H$&&(c.Sa(kb.a.fontSize)&&(h=this.Ea.FDa(this.Ea.Zm(a)),c.setValue(kb.a.fontSize,c.eb(kb.a.fontSize)*h)),
b&&b.spacing&&b.spacing.lineSpacing&&2===b.spacing.lineSpacing.Vf)){let m;(m=b.spacing.lineSpacing).value=m.value-this.Ea.Pvb(this.Ea.Zm(a))}c.sa(kb.a.Zs,!1)&&c.setValue(kb.a.Zs,!1);c.sa(kb.a.z_,!1)&&c.setValue(kb.a.z_,!1)}}Object(n.a)(JN,"PptFormatPainterStrategy",null,[310]);class fA{constructor(a,b,c,h,m,y,G){this.ia=a;this.Fa=h;this.pa=b;this.rE=c;this.Iu=m;this.kB=y;this.oXa=!G.wg;this.Nve=G.cjg}vb(){this.ia.ra(H.a.GBh,he.a.frame,Object(F.a)(this,this.$Ck,"pptToggleRibbonUXHandler"),128);this.ia.ya(H.a.rjh,
he.a.frame,ed.ActionManager.Jg);this.ia.ya(H.a.qjh,he.a.frame,ed.ActionManager.Jg)}De(){}$Ck(a,b){if(b.contextId!==he.a.frame)return 2;this.pa.Qh();this.Fa.Ed();this.Iu.show(!0,a);this.Nve?(Ba.a.J(33859651,340,50,"User is switching to the Classic Ribbon from Single Line Ribbon"),u.AFrameworkApplication.Ta.processAction(H.a.rjh,2)):(Ba.a.J(33859653,340,50,"User is switching to the Single Line Ribbon from Classic Ribbon"),u.AFrameworkApplication.Ta.processAction(H.a.qjh,2));u.AFrameworkApplication.Vu&&
u.AFrameworkApplication.Vu.i8();this.kB.S3&&2===this.kB.fG?fA.Lmh(this.ia,this.Nve,Vy.a.hhb):this.rE.j3(!1,this.oXa,()=>{fA.Lmh(this.ia,this.Nve,Vy.a.hhb)},null);return 32}static Lmh(a,b,c){oi.a.SJ(c,(!b).toString(),oi.a.wJ);a.processAction(M.a.refresh,2)}}Object(n.a)(fA,"ToggleRibbonUXActor",null,[227]);class KN extends Sys.EventArgs{constructor(a,b,c){super();this.actionId=a;this.$1e=b;this.$ab=c}}Object(n.a)(KN,"UndoRedoEventArgs",Sys.EventArgs,[]);class LN{constructor(a,b,c,h,m,y,G,U,ja,va,Ta,
fb,Db,gc){this.ia=a;this.ff=b;this.pa=c;this.Fa=h;this.Hv=m;this.Z5c=y;this.gak=G;this.LPg=U;this.qE=ja;this.hfb=va;this.YI=Ta;this.d7j=fb;this.ve=gc}vb(){this.ia.ra(M.a.hZa,nc.a.application,Object(F.a)(this,this.q9f,"handleUndoRedo"),4);this.ia.ra(M.a.gZa,nc.a.application,Object(F.a)(this,this.q9f,"handleUndoRedo"),4)}De(){const a=this.Fa.Gc(Ua.a.nj);a.pHc(w.KeyInputManager.Na(z.a.Wlb,w.KeyInputManager.Le),M.a.hZa,()=>!0);a.bindAction(w.KeyInputManager.Na(z.a.Kuc,w.KeyInputManager.Le),M.a.gZa)}q9f(a,
b,c,h,m){b=!0;a===M.a.gZa&&(b=!1);if(this.ff.$c(this.LPg)||!this.Bbl(b,m))return 16;if(!this.Cbl())return this.Hv.doa(),16;if(1===c)return 32;if(c=!this.Hv.UJj(b))this.pa.ij(),this.GXk();h=this.Hv.kRc(b);(m=this.YI.I5(h))&&Nc.a.xk("UndoRedoActionName",m);this.hfb.hdd(!c);this.ve.XKk(new KN(a,h,b));(h=this.Hv.$4d(b))&&h.b6!==pa.a.nil&&Nc.a.xk("UndoRedoRevision",Nc.a.D9a(h.b6.toString()).toString());this.d7j.hdd(h,m,b);if(b?!this.Hv.undo():!this.Hv.redo())return ba.ULS.sendTraceTag(512499928,801,10,
"User perform {0} failed!!",a===M.a.undo?"undo":"redo"),8;c&&this.ff.Zv(this.LPg,a);return 32}Bbl(a,b){a&&!this.Hv.LW&&b&&ba.ULS.sendTraceTag(512499927,801,50,"User pressed ctrl+z, but no undo entry left. Is in box4? {0}",this.Hv.rab());return(a?this.Hv.LW:this.Hv.fka)&&!(this.Fa.Be&&this.Fa.Be.name===Ua.a.YOd)&&this.Dbl()}Cbl(){return this.Z5c||!this.SMj()}SMj(){return!this.gak.ADa&&!!this.qE.instance&&this.qE.instance.OQj()}Dbl(){return!this.TMj()}TMj(){const a=this.pa.Jp();return a?a.Yx:!1}GXk(){const a=
this.Fa.Be;!a||a.name!==Ua.a.rg&&a.name!==Ua.a.bna||this.Fa.Ed()}}Object(n.a)(LN,"UndoRedoActor",null,[227]);class MN{constructor(a,b,c,h,m,y,G,U,ja,va,Ta,fb,Db,gc,hc,Gc,Pc,yc,Vd,De,Wd,Ve,$e,Qf,lg,Hg,Qg,Sf,sh,Xg,ni,Ri,uj,dj){this.wGa=this.Jva=this.u9c=null;this.cDb=0;this.Lxg=this.Vue=!1;this.rE=y;this.ia=a;this.ZAb=b;this.Fa=c;this.mh=h;this.pa=m;this.ff=G;this.je=U;this.Vb=ja;this.ua=va;this.Sb=Ta;this.Ihc=fb;this.Yb=Db;this.la=gc;this.Iu=hc;this.Xa=Gc;this.kB=Pc;this.Ie=yc;this.DXa=Vd;this.lGg=
De;this.Bv=Wd;this.zb=Ve;this.tw=$e;this.B6c=Qf;this.oAg=gc.Pgg;this.Lc=lg;this.Zbb=Hg;this.Qo=Qg;this.Hc=Sf;this.Tb=sh;this.Fb=Xg;this.GO=ni;this.Qb=Ri;this.tH=uj;this.vw=dj;this.fqi()}vb(){this.ia.ra(M.a.oIb,nc.a.application,Object(F.a)(this,this.oIb,"queryEdit"),96);this.ia.ra(M.a.QIb,nc.a.application,Object(F.a)(this,this.QIb,"querySorterView"),96);this.ia.ra(M.a.PIb,nc.a.application,Object(F.a)(this,this.PIb,"querySlideInformation"),96);this.ia.ya(M.a.sjd,nc.a.application,Object(F.a)(this,this.$ml,
"switchToReadingMode"));this.ia.ya(M.a.AMb,nc.a.application,Object(F.a)(this,this.gll,"startSlideShowFromBegnning"));this.ia.ya(M.a.XHb,nc.a.application,Object(F.a)(this,this.XHb,"present"));this.ia.ya(M.a.ohb,nc.a.application,Object(F.a)(this,this.ohb,"presentDropDown"));this.ia.ya(M.a.Rkc,nc.a.application,Object(F.a)(this,this.Rkc,"playFromBeginningTopBar"));this.ia.ya(M.a.Gya,nc.a.application,Object(F.a)(this,this.Gya,"startSlideShowFromCurrentSlide"));this.ia.ya(M.a.jvb,nc.a.application,Object(F.a)(this,
this.jvb,"forceClose"));this.ia.ya(M.a.Afa,nc.a.application,Object(F.a)(this,this.Afa,"rehearsePresentation"));this.ia.ya(M.a.qnc,nc.a.application,Object(F.a)(this,this.qnc,"rehearsePresentationTopBar"));this.la.pptEditorRehearsalSpeechClientEnabled&&(this.ia.ya(M.a.DNc,nc.a.application,Object(F.a)(this,this.DNc,"enableSubtitlesKeyboardShortcut")),this.ia.ya(M.a.CNc,nc.a.application,Object(F.a)(this,this.CNc,"enableLivePresenterKeyboardShortcut")));this.v5h();this.ia.ya(M.a.QKa,nc.a.application,Object(F.a)(this,
this.QKa,"showEditTriPaneView"));this.Yb.ka("PPTSorterViewEnabled")&&(this.Vue=this.Yb.ka("FeedbackPaneExperienceIsEnabled")&&this.Yb.ka("HelpTabIsEnabled"),this.ia.ya(M.a.u_b,nc.a.application,Object(F.a)(this,this.u_b,"closeEditTriPaneView")));this.la.EYc&&this.DXa.$Bj(u.AFrameworkApplication.buildVersion,this.Xa.nk,u.AFrameworkApplication.userSessionId,this.Hc)}De(){if(this.Yb.ka("SlideShowByShortcutEnabled")){const a=this.Fa.Gc(A.AFrame.nj);A.AFrame.jk(a,w.KeyInputManager.Na(z.a.Euc,w.KeyInputManager.Le|
4),M.a.Gya);A.AFrame.jk(a,w.KeyInputManager.Na(z.a.Euc,w.KeyInputManager.Le),M.a.AMb)}}v5h(){this.ia.ya(M.a.eZa,nc.a.application,Object(F.a)(this,this.eZa,"presentLive"));this.ia.ya(M.a.Llc,nc.a.application,Object(F.a)(this,this.Llc,"presentLiveTopBar"));this.ia.ya(M.a.fZa,nc.a.application,Object(F.a)(this,this.fZa,"presentLiveSetAccessControlAnyone"));this.ia.ya(M.a.Klc,nc.a.application,Object(F.a)(this,this.Klc,"presentLiveSetAccessControlOrganization"));this.ia.ra(M.a.GIb,nc.a.application,Object(F.a)(this,
this.GIb,"queryPresentLiveAccessControlAnyone"),96);this.ia.ra(M.a.HIb,nc.a.application,Object(F.a)(this,this.HIb,"queryPresentLiveAccessControlOrganization"),96);vb.a.instance.Ja("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").execute(a=>{a.o3("L_PublicLivePresentations",!0).then(b=>{b||(Ba.a.J(512499926,822,15,"Public Live Presentations is disabled by publiclivepresentations policy"),this.ia.WO(M.a.fZa,xb.a.application,Object(F.a)(this,this.fZa,"presentLiveSetAccessControlAnyone")),
Fc.App.Kb.e1a(M.a.fZa,Object(F.a)(new lp,(new lp).EDa,"getCommandById")));return null},b=>{Ba.a.J(512499925,822,10,"Could not get publiclivepresentations policy {0}",b);return null})})}PIb(a,b,c,h,m){a=(a=this.ua.Ba)?a.oe+1:0;a=(b=this.Sb.Lj())?String.format(ResourceStrings.l_SlideMenuButtonLabel,a,b):ResourceStrings.l_Slide;m[np.a.Value]=a;m[bm.a.labelText]=a;return 32}oIb(a,b,c,h,m){this.Fb&&0!==this.Fb.Sl?m.Qf(!1):m.Qf(!0);return 32}QIb(a,b,c,h,m){(a=Object(ua.a)(Ph.a,m))&&(1!==this.Fb.Sl?a.Qf(!1):
a.Qf(!0));return 32}QKa(a,b,c){try{if(1===c)return 32;2===c&&0!==this.Fb.Sl&&(Ba.a.J(512499924,822,50,"ViewSwitchingActor: ShowEditTriPaneView."),this.Fb.Sl=0,this.Qb&&(this.Qb.slidePane.em(),this.la.Ks||this.Qb.thumbnailPane.em(),this.Qb.notesPane.em(),this.tH&&this.tH.setVisibility(!0)),this.ia.processAction(M.a.Pib,2),this.ia.processAction(M.a.Usb,2),this.GO.N5("PptEditingStatusBar.Notes",!0),this.GO.N5("PptEditingStatusBar.ZoomScale",!0),this.GO.N5("PptEditingStatusBar.FitToWindow",!0),this.Vue?
this.GO.N5("PptEditingStatusBar.GiveFeedbackPane",!0):this.GO.N5("PptEditingStatusBar.GiveFeedback",!0),this.Lc.sz(new Gp.a(2)),this.Lc.sz(new Gp.a(1)),this.la.Ks||this.mh.EK(Ua.a.UE),this.mh.EK(Ua.a.bna),this.mh.EK(Ua.a.rg),this.mh.EK(Ua.a.iQ))}catch(h){Ba.a.J(512499923,822,10,"ViewSwitchingActor - Expcetion in ShowEditTriPaneView: {0}.",h)}return 32}u_b(a,b,c){try{if(1===c)return 32;2===c&&(this.Qb&&(this.Qb.slidePane.zr(),this.Qb.thumbnailPane.zr(),this.Qb.notesPane.zr(),this.tH&&this.tH.setVisibility(!1)),
this.GO.N5("PptEditingStatusBar.Notes",!1),this.GO.N5("PptEditingStatusBar.ZoomScale",!1),this.GO.N5("PptEditingStatusBar.FitToWindow",!1),this.Vue?this.GO.N5("PptEditingStatusBar.GiveFeedbackPane",!1):this.GO.N5("PptEditingStatusBar.GiveFeedback",!1),this.Lc.sz(new Gp.a(2)),this.Lc.sz(new Gp.a(1)),this.la.Ks||this.mh.Ho(Ua.a.UE),this.mh.Ho(Ua.a.bna),this.mh.Ho(Ua.a.rg),this.mh.Ho(Ua.a.iQ),this.pa.Qh())}catch(h){Ba.a.J(512499922,822,10,"ViewSwitchingActor - Exception in CloseEditTriPaneView: {0}.",
h)}return 32}$ml(a,b,c){if(this.ff.$c(this.Vb.Cf))return 16;if(1===c)return this.ua.Ba?32:16;b=(new Date).getTime();let h=ng.a.Wi(window.document.URL,ca.a.L8g,ca.a.readingView,!0);if(!this.ua.Ba)throw Error.argumentNull("ActiveSlide is null");c=this.ua.Ba.Cb;h=ng.a.Wi(h,ca.a.Dkc,c?c.sid.toString():"",!0);h=this.ZAb.instance&&this.ZAb.instance.isVisible?ng.a.Wi(h,ca.a.K8g,"1",!0):ng.a.removeParameter(h,ca.a.K8g,!0);this.eqi();h=ng.a.Wi(h,u.AFrameworkApplication.Vbd,b.toString(),!0);this.pa.Qh();this.Fa.Ed();
this.Iu.show(!0,a);this.rE.j3(!1,!0,()=>{this.Cxh(h)},()=>{Ba.a.J(512499921,818,10,"SwitchingToReadingMode: ForceSave triggered failed.");this.Cxh(h);return!0});return 32}Cxh(a){this.Ihc.openWindow(1,a,!1)||this.Iu.hide()}XHb(a,b,c){return this.lkb(a,c,null)}ohb(a,b,c){return this.lkb(a,c,null)}Rkc(a,b,c){return this.lkb(a,c,null)}gll(a,b,c){return this.lkb(a,c,null)}Gya(a,b,c){return this.lkb(a,c,this.ua.Ba?this.ua.Ba.Cb:null)}lkb(a,b,c,h=!1,m=!1){if(!this.la.EYc)return this.Okl(a,b,c);if(this.ff.$c(this.Vb.Cf)||
!this.Sb.Lj()||this.la.preventDuplicateSlideShowLaunches&&this.DXa.j$b()||this.la.allowDisablingSlideShowButtonDueToRehydration&&this.DXa.gbe)return 16;if(1===b)return 32;this.la.Hfg&&!Rd.a("DummyChangeGateForTest")&&Ba.a.J(512499920,830,100,"StartSlideShow::DummyChangeGateForTest is disabled");this.vw.hasDeferredContent()&&Ba.a.J(512499919,830,100,"StartSlideShow attemped with deferred content");this.fll(c,h,m);return 32}fll(a,b,c){this.cDb=(new Date).getTime();this.pa.Qh();this.Fa.xf(Ua.a.GD);this.Lc.leh();
Ba.a.J(512499918,830,50,"ViewSwitchActor.StartSlideShowFrom Should HideSlideShowButton: {0}",this.DXa.gbe);const h=a?a.sid:-1;a=(a=a?Object(ua.a)(115,this.Sb.cEa(a.sid)):null)?a.oe+1:-1;let m=!1;this.Qo.instance?m=this.Qo.instance.i_?!0:!1:Ba.a.J(512499917,818,15,"StartSlideShowFrom: m_podSeamlessFailoverManager is null.");this.DXa.cqd(h,a,b,this.Yb.Ha("361"),this.Xa.nk,this.Xa.podSessionId,this.Yb.Ha("387"),u.AFrameworkApplication.userSessionId,this.la.NQj,this.cDb,m,this.Xa,c);this.DXa.lia(Object(F.a)(this,
this.Ldd,"onExitSlideshowHandler"));this.kB.gil()}qnc(a,b,c,h){return this.Afa(a,b,c,h,{entryPoint:4})}Afa(a,b,c,h,m){switch(c){case 2:if(!this.ua.Ba)throw Error.argumentNull("ActiveSlide is null");this.la.pptEditorRehearsalSpeechClientEnabled&&(b=0,m&&(b=m&&"entryPoint"in m?m.entryPoint:1),this.ia.La(M.a.hrc,2,b),this.Hc&&(this.Hc.kDa=!1),this.Tb&&this.Tb.instance&&(this.Tb.instance.kDa=!1));return this.DXa.j$b()?(this.Hc&&(this.Hc.Kh=!1),32):this.lkb(a,c,this.ua.Ba.Cb,!0);case 1:if(0<this.Sb.Lj())if(this.la.pptEditorRehearsalSpeechClientEnabled){if(32===
this.ia.processAction(M.a.VKa,1)&&32===this.ia.processAction(M.a.hrc,1))return 32;break}else return this.ia.processAction(M.a.VKa,1);else break;default:Ba.a.J(512499916,822,10,"RehearsePresentation: Unimplemented action behavior")}return 8}DNc(a,b,c){switch(c){case 2:if(this.la.pptEditorRehearsalSpeechClientEnabled&&this.Hc)return this.Hc.kDa=!0,32;break;case 1:return this.la.pptEditorRehearsalSpeechClientEnabled?32:8;default:Ba.a.J(512499915,822,10,"EnableSubtitlesKeyboardShortcut: Unimplemented action behavior")}return 8}CNc(a,
b,c){switch(c){case 2:if(this.la.pptEditorRehearsalSpeechClientEnabled&&this.Tb&&this.Tb.instance)return this.Tb.instance.kDa=!0,32;break;case 1:return this.la.pptEditorRehearsalSpeechClientEnabled?32:8;default:Ba.a.J(512499914,822,10,"EnableLivePresenterKeyboardShortcut: Unimplemented action behavior")}return 8}Llc(a,b,c,h,m){return this.eZa(a,b,c,h,m)}eZa(a,b,c){if(this.Lxg){try{appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("PresentLive",!0))}catch(h){Ba.a.J(512499913,833,10,
"ViewSwitchingActor::PresentLive unhandled exception: {0}",h)}return 8}if(1===c)return this.Tb&&this.Tb.instance&&this.Tb.instance.sr&&this.Tb.instance.i8a?0<this.Sb.Lj()?32:8:8;this.Tb&&this.Tb.instance&&this.Tb.instance.sr&&(this.Tb.instance.jDa=!0);if(!this.ua.Ba)throw Error.argumentNull("ActiveSlide is null");return this.lkb(a,c,this.ua.Ba.Cb,!1,!0)}fZa(a,b,c){if(1===c)return this.Tb&&this.Tb.instance&&this.Tb.instance.sr&&this.Tb.instance.i8a?32:8;this.Tb.instance.Yq&&0!==this.Tb.instance.accessControl?
this.Tb.instance.showEndSessionDialog(()=>{this.Tb.instance.C2b(5);this.Tb.instance.accessControl=0;this.Lc.sz(new Gp.a(1))},()=>{}):(this.Tb.instance.accessControl=0,this.Lc.sz(new Gp.a(1)));return 32}Klc(a,b,c){if(1===c)return this.Tb&&this.Tb.instance&&this.Tb.instance.sr&&this.Tb.instance.i8a&&this.Tb.instance.qSf?32:8;this.Tb.instance.Yq&&1!==this.Tb.instance.accessControl?this.Tb.instance.showEndSessionDialog(()=>{this.Tb.instance.C2b(5);this.Tb.instance.accessControl=1;this.Lc.sz(new Gp.a(1))},
()=>{}):(this.Tb.instance.accessControl=1,this.Lc.sz(new Gp.a(1)));return 32}GIb(a,b,c,h,m){try{const y=Object(ua.a)(Ph.a,m);y&&this.Tb.instance&&y.Qf(0===this.Tb.instance.accessControl)}catch(y){Ba.a.J(512499912,833,10,"ViewSwitchingActor::QueryPresentLiveAccessControlAnyone unhandled exception: {0}",y)}return 32}HIb(a,b,c,h,m){try{const y=Object(ua.a)(Ph.a,m);y&&this.Tb.instance&&y.Qf(1===this.Tb.instance.accessControl)}catch(y){Ba.a.J(512499911,833,10,"ViewSwitchingActor::QueryPresentLiveAccessControlOrganization unhandled exception: {0}",
y)}return 32}Okl(a,b,c){if(this.ff.$c(this.Vb.Cf))return 16;if(1===b)return this.Sb.Lj()?32:16;this.cDb=(new Date).getTime();this.pa.Qh();this.Fa.xf(Ua.a.GD);this.Lc.leh();this.Iu.show(!0,a);this.rE.j3(!1,!0,()=>{this.Kmh(c,this.cDb)},()=>{Ba.a.J(512499910,818,10,"StartSlideShowFrom: ForceSave triggered failed.");this.Kmh(c,this.cDb);return!0});return 32}Ldd(a,b){a=((new Date).getTime()-this.cDb).toString();Ba.a.J(512499909,830,50,"ViewSwitchingActor.OnExitSlideshowHandler: Exit slideshow. Duration: {0}. HasDeferredContentInFile: {1}, HasDeferredContentOnSlide: {2}",
a,this.vw.hasDeferredContent(),this.vw.tae(b.slideId.toString()));this.vw.hasDeferredContent()||this.vw.tae(b.slideId.toString())?this.vw.bra("DeferredExitSlideshowDuration",a):this.vw.bra("ExitSlideshowDuration",a);this.DXa.Cfa(Object(F.a)(this,this.Ldd,"onExitSlideshowHandler"));(this.Jva=b)&&!this.Jva.dIj&&!this.Jva.YLj&&0<this.Jva.slideId&&0<=this.Jva.slideIndex&&this.Hik(this.Jva.slideId,this.Jva.slideIndex);this.Fa.Ed();this.oAg?(this.wGa=Nc.a.Ik("ExitSlideshow"),this.ff.blockContent(this.Vb.Cf,
"ExitSlideshow"),this.lGg.ik(Object(F.a)(this,this.w4g,"onPageManifestNodePropertyChanged")),this.wGa.Va("UnlockPodsSessionStartTime",Nc.a.nf(new Date)),this.unlockPodsSession(c=>{this.wGa&&(this.wGa.Va("UnlockPodsSessionWithMerge",c.toString()),this.wGa.Va("UnlockPodsSessionEndTime",Nc.a.nf(new Date)));c?this.Bv.oZi():this.LQe()})):this.LQe()}LQe(a=null){a&&(this.u9c=null);this.Jva&&(this.oAg&&(this.lGg.Cm(Object(F.a)(this,this.w4g,"onPageManifestNodePropertyChanged")),this.ff.ZJ(this.Vb.Cf),this.wGa&&
(this.wGa.Va("InboundPresentationEndTime",Nc.a.nf(new Date)),this.wGa.finish(),this.wGa=null)),this.Jva=null,this.kB.jZk())}unlockPodsSession(a){const b=Eh.a.create().toString();Ba.a.J(512499907,830,50,"ViewSwitchingActor.UnlockPodsSession: Unlock Pods session, correlation={0}",b);const c=String.format("{0}PodHandler.ashx?action=LockUnlockSession&PodSID={1}&locked=false",u.AFrameworkApplication.fa.appSettings["361"],this.Xa.podSessionId),h={WaitForSessionTimeoutMs:"0"};h["X-UserSessionId"]=u.AFrameworkApplication.userSessionId;
h["X-CorrelationID"]=b;h["X-WacCluster"]=this.Xa.nk;this.roh(c,h,0,a)}roh(a,b,c,h){this.tw.Aj(a,2,null,b,!1,2,m=>{this.ewl(m,c,h)},m=>{this.OEh(m,a,b,c,h)},null,void 0,void 0,void 0,void 0,Ax.a("2"))}ewl(a,b,c){if(b)Ba.a.J(512499905,830,50,"ViewSwitchingActor.UnlockPodsSession: Succeed with retry: {0}",b);else{b=!1;try{a.data.Zd&&0<a.data.Zd.length&&(b=JSON.parse(a.data.Zd).FMerged)}catch(h){Ba.a.J(512499906,830,10,"ViewSwitchingActor.UnlockPodsSession: Failed to deserialize unlock Pods session response: {0}",
a.toString())}c(b)}}OEh(a,b,c,h,m){h||m(!1);3>h?this.roh(b,c,h+1,m):Ba.a.J(512499904,830,10,"ViewSwitchingActor.UnlockPodsSession: Failed with status code: {0}, retry count: {1}",this.B6c.Nja(a),h)}w4g(a,b){this.u9c||b.property!==X.a.P7b||(this.u9c=new He.a(2,1,0,Object(F.a)(this,this.LQe,"resumeEditor"),90,"65"),this.zb.Eb(this.u9c))}Kmh(a,b){this.Iu.hide();let c=!0,h=!1,m=this.je.slideShowUrl;m||(m=ng.a.Wi(window.document.URL,ca.a.L8g,ca.a.slideShowView,!0),h=!0);m=ng.a.removeParameter(m,ca.a.mxk);
m=a?ng.a.Wi(m,ca.a.Dkc,a.sid.toString(),!0):ng.a.removeParameter(m,ca.a.Dkc);0<b&&(m=ng.a.Wi(m,u.AFrameworkApplication.Vbd,b.toString(),!0));a=String.format("menubar=false,fullscreen=yes,scrollbars=yes,resizable=yes,left=0,top=0,width={0},height={1}",window.screen.width,window.screen.height);b=null;try{b=this.Ihc.yHe(4,m,"SlideShowWindow",a,h,!1)}catch(y){Ba.a.J(512499875,818,10,"StartSlideShowFrom: Exception throw trying to open the window. {0}",y),c=!1}b||(Ba.a.J(512499874,818,10,"StartSlideshowFrom:: failed to open slide show window"),
c=!1);Nc.a.xk("Window Opened",c.toString());Nc.a.usd()}jvb(a,b,c){if(2!==c)return this.ia.processAction(H.a.close,c);a=this.ia.processAction(H.a.close,2);32!==a&&(Ba.a.J(512499873,801,50,"Close action failed to execute. Response: {0}",a),window.location="about:blank");return 32}Hik(a,b){Ba.a.J(512499872,830,50,"ViewSwitchingActor.NavigateAtSlideshowExit: SlideIndex={0}",b);(a=this.Sb.cEa(a))?this.Ie.xU(a.oe):(Ba.a.J(512499871,830,50,"ViewSwitchingActor.NavigateAtSlideshowExit: SlideId does not exist.  Navigate to slide index {0}.",
b),a=this.Sb.Lj()-1,b=b>a?a:b,0>b||this.Ie.xU(b))}eqi(){this.Zbb.instance&&this.Zbb.instance.fUa&&(this.Zbb.instance.vLc.fC?this.Zbb.instance.endCommentSession(this.Zbb.instance.vLc.fC.draftId,7):this.Zbb.instance.endCommentSession("",7),this.Zbb.instance.grf())}fqi(){this.la.powerPointLiveBroadcastEnabled&&vb.a.instance.Ja("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(a=>{a.isFeatureEnabled("PowerPointLivePresentations",!1).then(b=>{b||(Ba.a.J(512499870,822,15," User doesn't have license for PPTLive, Hiding Present Live button"),
this.Lxg=!0);return null})})}}Object(n.a)(MN,"ViewSwitchingActor",null,[227]);class NN{constructor(a,b){this.zpe=null;this.Xa=a;this.Vea=b;this.jyf();this.Xa.zsf(Object(F.a)(this,this.Zed,"onSessionInfoChanged"))}jyf(){const a=new Sys.StringBuilder;a.append(String.format("?{0}",this.Xa.presentationId.string));a.append(String.format("&{0}={1}",ca.a.S3k,this.Xa.pub));a.append(String.format("&{0}={1}",ca.a.vna,"368"in u.AFrameworkApplication.fa.appSettings?void 0===this.Xa.sessionInfo||null===this.Xa.sessionInfo?
"undefined":this.Xa.sessionInfo:this.Xa.sessionInfo));this.Xa.nk&&a.append(String.format("&{0}={1}",ca.a.M8g,this.Xa.nk));this.Xa.podSessionId&&a.append(String.format("&{0}={1}",ca.a.U$,this.Xa.podSessionId));this.zpe=a.toString()}Zed(){this.jyf()}resolve(a,b,c){if(!b||!b.length)return null;if(b.startsWith("./"+a))return b;const h=Rd.a("FixInvalidOperationErrorInEditImageHandler")?encodeURIComponent(b):b;return c?this.Vea+a+this.zpe+`&cl=${c}&${ca.a.I8g}=${h}`:this.Vea+a+this.zpe+String.format("&{0}={1}",
ca.a.I8g,b)}dispose(){this.Xa.lUk(Object(F.a)(this,this.Zed,"onSessionInfoChanged"))}}Object(n.a)(NN,"ResourceViewElementResolver",null,[340,106]);var $Q=d(1029),aR=d(947);class ON{constructor(a,b){this.F1c=this.g4=0;this.BDg=null;this.CDg=-1;this.DDg=null;this.Sua=a;this.Bc=b}get Ehe(){return 0<this.F1c}get kmg(){return this.BDg}mmk(a){this.F1c++;this.Bc.Axh(a.CcpId,a.CcpCorrelation)}get Lle(){return this.DDg}set Lle(a){this.DDg=a}U0g(a,b){if(!a){const c=this.Amj(b);c>this.CDg&&(this.CDg=c,this.BDg=
b.CcpId)}0<this.F1c?this.F1c--:Ba.a.J(20760084,307,15,"ClipServiceManager - bad state");this.Bc.EPf(b.CcpId,a,0)}DKc(a,b,c=!1,h=!1){a=Object.assign(new aR.a,{qW:32,Gp:Eh.a.create().toString(),version:this.g4++,location:this.Sua.ccpInfo,mD:this.Sua.nk||mp.a.JIh,dataType:a,objectCount:b,XEa:c,VEa:h,ty:Eh.a.create().toString()});Ba.a.J(24945860,307,50,"CreateClipServiceObject: A ClipServiceObject was just created for Ccpid: {0}.",a);return a}Amj(a){let b=null;a:{var c=a.PackageAccessKey;let m;m=null;
if(c)try{const y=dd.a(c);if(y&&"I"in y&&"V"in y){m=new at(y.I,parseInt(y.V));var h={returnValue:!0,ty:m};break a}}catch(y){}h={returnValue:!1,ty:m}}if(({ty:b}=h).returnValue&&b)return b.version;Ba.a.J(21066257,307,15,"Fail to parse packageAccessKeyString for ccpid: {0}",a.CcpId);return-1}}Object(n.a)(ON,"ClipServiceManager",null,[328]);class PN{constructor(a,b,c,h,m,y,G,U,ja){this.lh=a;this.Zcc=c;this.V$c=h;this.Ioe=m;this.Jr=y;this.Bc=G;this.n0=U;this.ia=ja;this.Bl=b;this.Vda=this.lh.contentWindow.document.body;
this.Jr.addHandler(this.Vda,ra.a.cut,Object(F.a)(this,this.I1g,"onBrowserCut"));this.Jr.addHandler(this.Vda,ra.a.copy,Object(F.a)(this,this.H1g,"onBrowserCopy"))}get Ic(){return this.Zcc.Ic}dispose(){this.lh&&this.lh.contentWindow&&(this.Jr.removeHandler(this.Vda,ra.a.cut,Object(F.a)(this,this.I1g,"onBrowserCut")),this.Jr.removeHandler(this.Vda,ra.a.copy,Object(F.a)(this,this.H1g,"onBrowserCopy")));this.lh=null}I1g(){if(Tk.wA&&!Tk.wA.e1d){var a=this.Bc.eP(1,0,"OnBrowserCut");this.ssa(Object.assign(new bt(!0,
!0),{Ub:a}))}}H1g(){if(Tk.wA&&!Tk.wA.e1d){var a=this.Bc.eP(0,0,"OnBrowserCopy");this.ssa(Object.assign(new bt(!0),{Ub:a}))}}kQ(a){if((u.AFrameworkApplication.yR||u.AFrameworkApplication.EJ)&&!u.AFrameworkApplication.tRa)return!1;for(let b=0;b<this.Bl.length;b++)if(this.Bl[b].kQ(a))return!0;return!1}ssa(a){if(this.ia.YW)this.n0?(this.n0.show(5,-1),this.Bc.Gg(!1,a.Ub,26)):Ba.a.J(509444690,826,10,"m_offlineModalCallout is null");else if(!u.AFrameworkApplication.yR&&!u.AFrameworkApplication.EJ||u.AFrameworkApplication.tRa){var b=
0,c=!1;for(var h=0;h<this.Bl.length;h++)if(this.Bl[h].kQ(a)){c=!0;this.Bl[h].ssa(a)||(b=21);break}switch(a.dataType){case 2:h=2;break;case 1:h=19;break;default:h=0}this.Bc.CB(h,a.Ub);if(c){if(a.ffg&&(this.Ioe.Tib(this.lh),!a.kUi)){if(!this.V$c){this.Bc.Gg(!1,a.Ub,1);return}this.V$c.copy(this.lh)||0!==b||(b=22)}this.Bc.Gg(0===b,a.Ub,b)}else this.Bc.Gg(!1,a.Ub,20)}else this.Bc.Gg(!1,a.Ub,32)}}Object(n.a)(PN,"CutCopyManager",null,[323,106]);var bR=d(899);class QN{constructor(a,b,c){this.VX=a;this.VX.ik(Object(F.a)(this,
this.hh,"onPropertyChanged"));this.dM=b;this.dM.ik(Object(F.a)(this,this.hh,"onPropertyChanged"));this.Hq=c}hh(a,b){this.Hq.Uq&&0<this.Hq.Uq.length&&(this.Hq.Uq=Ma.a.gpa(this.Hq.Uq,c=>!(pa.a.SP(c.id,b.node.id)||Object(za.a)(Nv.a,c))));this.Hq.Uq&&!this.Hq.Uq.length&&(this.Hq.Uq=null)}}Object(n.a)(QN,"GraphNodeChangeListener",null,[]);class RN{constructor(a,b){this.Pbc=null;a&&b&&new QN(a,b,this)}get Uq(){return this.Pbc}set Uq(a){const b=this.Pbc&&0<this.Pbc.length?this.Pbc[0]:null,c=a?a[0]:null,
h=!!b&&!!c&&b.id.equals(c.id)&&b.Utf;this.Pbc=a;c&&(c.Utf=h,c.QDf=h&&b?b.QDf:bR.a.create().toString())}}Object(n.a)(RN,"InternalClipboard",null,[322]);class SN{constructor(a,b,c,h,m,y,G,U,ja,va){this.Jqg=a;this.ki=b;this.Eea=c;this.uHa=h;this.X9=m;this.Ea=y;this.rve=G;this.dec=U;this.v8j=ja;this.e6c=va}lTe(a,b,c){this.Jqg.lTe(a,b,c);b=new dM.a;this.rve&&c||(b.setValue(kb.a.bold,!1),b.setValue(kb.a.underline,!1),b.setValue(kb.a.Lw,lf.Font.pV),b.setValue(kb.a.strikethrough,!1),b.setValue(kb.a.italic,
!1),b.setValue(kb.a.Zs,!1),b.setValue(kb.a.z_,!1));this.ki.wUe(a,b)}ATe(a,b,c){const h=b.cache;if(this.e6c){var m=this.s6i(b);ta.a.Wa(m)||c?h.propertySet.Sa(kb.a.font)&&(h.sa(X.a.YXc,!1)||c)&&this.ki.TU(a,h.zN):this.ki.TU(a,m);h.Ata&&this.ki.ir(a,h.fontSize)}else this.Jqg.ATe(a,b,c);(!this.dec||this.rve&&c)&&h.C3&&(this.ki.Dm(a,kb.a.fontColor,h.fontColor),this.dec&&(m=ao.SchemeColor.create(null,h.fontColor),this.ki.Dm(a,X.a.schemeColor,m.toString())));this.rve&&c&&(this.ki.GH(a,h.isBold),this.ki.setItalic(a,
h.isItalic),this.ki.GY(a,h.KF),this.ki.jjb(a,h.w_),this.ki.JY(a,h.dE),this.ki.uoa(a,h.Lw),this.ki.J_a(a,h.Zs),this.ki.njb(a,h.z_),this.ki.R5(a,h.LF),this.ki.IY(a,h.isSuperscript),this.ki.lya(a,h.an));this.ki.J_a(a,!1);this.u8k(a,b)}B6d(a){return this.Eea.JSa(a)}JW(a){return this.Eea.JW(a)}TSa(a){return this.uHa.TSa(a)}v8(a){return this.X9.v8(a)}u8k(a,b){b=b.Pz;if(null!==b&&b.Sa(X.a.OJa)){b=b.eb(X.a.OJa);var c=a.Pz;null===c?this.ki.Dm(a,X.a.OJa,b):c.setValue(X.a.OJa,b)}}Vth(a){return this.v8j&&a&&
(a=a.paragraph)&&(a=this.Ea.Zm(a))&&a.Rf?!0:!1}s6i(a){if(!this.e6c||!a)return null;let b="";var c=a.paragraph;if(!c)return null;var h=this.Ea.Zm(c);if(!h)return null;a=h.sa(jb.a.L_,[]);c=c.sa(jb.a.listLevel,Vg.a.zEa);a&&0<=c&&c<a.length&&(h=h.Fh)&&(a=h.ye(a[c]))&&(a.Sa(X.a.qYd)?b=a.eb(X.a.qYd):a.Sa(X.a.nYd)?b=a.eb(X.a.nYd):a.Sa(X.a.kYd)?b=a.eb(X.a.kYd):a.Sa(X.a.uYd)&&(b=a.eb(X.a.uYd)));return b}}Object(n.a)(SN,"PPTFormattingStewardBridge",null,[297]);class TN{constructor(a,b,c,h){this.jc=c;this.jA=
h}}Object(n.a)(TN,"PPTFormattingStewardHelper",null,[306]);class UN{constructor(a,b,c,h,m){this.R$j=[jb.a.Zl,jb.a.$n];this.la=a;this.NAb=b;this.ywg=c;this.gJ=h;this.Pb=m;this.idb=a.xig;this.sva=a.pptCopyPasteListMarkerEnabled;this.Xdc=a.pptCopyPasteMarginAndIndentationEnabled}o1e(a){return this.NAb.DPj(a)}T$d(a,b){return this.NAb.YRi(a,b)}qoa(a,b,c,h=null,m=null){if(this.ywg.jgd)if(this.NAb.Jfg(c))a.setValue(xc.a.Tfg,!0);else if(this.NAb.fl(c)){if(this.Xdc&&a&&b){var y=this.Pb.Nc(a);y.rc(11);y.Ng(11);
c=Wb.ListReader.tk(y);const G=this.gJ.w6i(a,y);y=this.gJ.t6i(a,y);c&&(h||(Ba.a.J(41219841,826,50,"Default marginLeft for internal"),b[jb.a.Zl.id.toString()]=G),m||(Ba.a.J(41219843,826,50,"Default textIndent for internal"),b[jb.a.$n.id.toString()]=y));h&&Ba.a.J(41018240,826,50,"Customized marginLeft");m&&Ba.a.J(41018242,826,50,"Customized textIndent")}this.ywg.qoa(a,b)}if(this.la.NYc&&!Ob.ParagraphReader.VW(a))for(const G of this.R$j)void 0===a.Lh(G)&&a.te(G,0)}eLb(a,b,c){if(this.idb){var h=b.propertySet.Sa(kb.a.Ri)?
b.propertySet.eb(kb.a.Ri).length:1;if(a=this.gJ.nQ(a,b.propertySet.sa(jb.a.listLevel,0)))if(this.sva&&(0<c.Trb||c.dQa&&0<c.dQa.length)){h="";b.k$a&&!b.a$f&&(h=c.font);let m=null;c.dQa&&0<c.dQa.length&&(m=c.dQa,1===c.dQa.length&&Ba.a.J(41219847,826,50,"Customized bullet."));let y=-1;0<c.Trb&&(y=c.Trb,Ba.a.J(41219849,826,50,"Customized number list."));this.gJ.nKc(a,b.propertySet);m&&b.propertySet.setValue(kb.a.Ri,m);ta.a.Wa(h)||b.propertySet.setValue(kb.a.font,h);0<y&&b.propertySet.setValue(X.a.autonumberBulletType,
y)}else a.sa(kb.a.Ri,[]).length===h&&this.gJ.nKc(a,b.propertySet)}}zYc(a){return this.NAb.zYc(a)}get uZc(){return this.NAb.uZc}m1(a,b){2===b.Vf?(a.setValue(X.a.gX,2),a.setValue(X.a.ox,b.value)):Ba.a.J(36779851,826,50,"the un-support text spacing unit")}FKa(a,b){b.beforeSpacing.value&&(a.setValue(X.a.Kda,b.beforeSpacing.value),a.setValue(X.a.Xka,4));b.afterSpacing.value&&(a.setValue(X.a.Jda,b.afterSpacing.value),a.setValue(X.a.Wka,4))}Yqh(a,b){const c=(new lv.a(b.Vf,b.value)).MM;1===b.specialIndentType?
a.setValue(jb.a.$n,c):2===b.specialIndentType?a.setValue(jb.a.$n,-c):0===b.specialIndentType&&a.setValue(jb.a.$n,0)}Pph(a,b){b=(new lv.a(b.Vf,b.value)).MM;a.setValue(jb.a.Zl,b)}get Yth(){return!0}}Object(n.a)(UN,"PPTPasteStewardBridge",null,[304]);class VN extends jv{constructor(a,b){super(a,b)}jQc(){return["PasteSlide"]}}Object(n.a)(VN,"PasteSlideReactFloatie",jv,[]);class WN{constructor(a,b,c,h,m,y,G,U,ja,va,Ta,fb,Db,gc,hc,Gc,Pc,yc,Vd,De,Wd,Ve,$e){this.D9f=!1;this.iR=[];this.mgc=[];this.Wne=[];
this.tqe=0;this.qc=c;this.pa=h;this.kfb=m;this.jfb=y;this.Fma=G;this.Yc=U;this.Pxe=Vd;this.qd=a;this.hdk=b;this.Rk=Ta;this.tak=ja;this.Vb=fb;this.Fa=Db;this.Lr=gc;this.Z6j=hc;this.R6j=Gc;this.fc=Pc;this.qRg=yc;this.Yb=De;this.xak=Wd;this.lh=$e;this.$bb=vb.a.instance.rb("Common.IReactContextualUILauncher");this.ABb=vb.a.instance.rb("Common.IExternalUICommandDefinitionMapping")}N$(a){2===a.behavior&&(a=a.actionId,a!==M.a.$v&&a!==M.a.YBa&&a!==M.a.Xma&&a!==M.a.m5&&a!==M.a.Jia&&a!==M.a.gQ&&a!==M.a.insertPicture&&
a!==M.a.Xma&&a!==M.a.Ssa&&a!==M.a.m3d&&a!==M.a.l3d&&a!==M.a.insertPicture&&a!==M.a.LPc&&a!==M.a.MPc&&a!==M.a.jJe&&a!==M.a.lgd||this.tN(new ac(!0)))}M$(){}w6h(){this.Pxe&&!this.D9f&&(this.pa.GG(Object(F.a)(this,this.S$,"onSelectionChange")),this.hdk.Ad(7).FG(Object(F.a)(this,this.uB,"onChildTopologyChanged")),this.qd.EBa(Object(F.a)(this,this.nY,"onThumbnailDrawCompleted")),wd.a.addHandler(this.Fma.EU,"scroll",Object(F.a)(this,this.n_a,"scrollHandler")),wd.a.addHandler(this.lh.contentWindow.document.body,
ra.a.Zf,Object(F.a)(this,this.onKeyDown,"onKeyDown")),this.Yc.pb(ra.a.click,this.Fma.EU,Object(F.a)(this,this.ZB,"clickHandler")),u.AFrameworkApplication.Aa.nia(Object(F.a)(this,this.Ffa,"resizeHandler")),this.tak.N5a(Object(F.a)(this,this.M0,"onSlidePresenceChanged")),this.Rk.Gsf(Object(F.a)(this,this.XGe,"onSlidesIdReturned")),this.Z6j.VFc(Object(F.a)(this,this.Ved,"onRevisionProcessedOnServerHandler")),this.R6j.W8h(Object(F.a)(this,this.vmk,"onBlockingHandler")),this.xak.tsf(Object(F.a)(this,this.Oqk,
"onOnlyKeyPressed")),this.D9f=!0)}Oqk(){if($M.a.instance.keyCode===z.a.yga){const c=document.getElementById("PasteSlideControl");if(c){var a=qd.a.ii(c),b=this.qRg.xa.style.height;a.y+a.height+61+2<parseInt(b.substr(0,b.length-2))+Kz.a.c2e?Ba.a.J(512497815,826,10,"recoveryUIElement rendering to wrong place"):(a=c.getAttribute(zc.a.qrb)||"",zc.a.ura===a&&c.click())}else Ba.a.J(512497816,826,10,"recoveryUIElement is null")}}onKeyDown(a){a.keyCode===z.a.J1&&this.tN(new ac(!0))}vmk(a,b){1===b.block?this.tN(null):
2===b.block&&this.tN(new ac(!0))}Ved(a,b){b&&(a=b.faa)&&a.ActionInformation.ActionId!==""+M.a.Ikc&&a.ActionInformation.ActionId!==""+M.a.kHb&&a.ActionInformation.ActionId!==""+M.a.ngd&&this.Lr.m0c&&this.Lr.m0c<parseInt(a.ActionInformation.ActionTime)&&this.tN(new ac(!0))}M0(a,b){this.YTf(b.slideId.sid,this.iR)&&(this.tN(new ac(!0)),this.Lr.Sjb=!1)}YTf(a,b){for(const c of b)if(c.sid===a)return!0;return!1}XGe(a,b){if(b&&b.tYa){if(this.Wne.length>=b.tYa.length&&!this.$bb.Hyb&&(this.setSelection(b.tYa),
this.iR.length===b.tYa.length)){this.showFloatie({},new vh(1,u.AFrameworkApplication.isRtl));let c;(c=this.pa).J5a.apply(c,this.iR)}this.Lr.kJa.length||(this.Lr.kJa=b.tYa,Array.clear(this.iR),Array.clear(this.mgc))}}S$(a,b){if(this.Lr.Sjb){for(a=0;a<b.zE.length;a++)if(Object(ua.a)(4,b.zE[a].context.node)){this.tN(new ac(!0));return}!this.Fa.Be||this.Fa.Be.name!==Di.a.J2&&this.Fa.Be.name!==Di.a.lzf&&this.Fa.Be.name!==Di.a.izf&&this.Fa.Be.name!==Ua.a.HE&&this.Fa.Be.name!==Ua.a.HI&&this.Fa.Be.name!==
Ua.a.DW||this.tN(new ac(!0))}}Ffa(){this.$bb.Hyb&&this.tN(new ac(!1))}n_a(){this.Veh()}ZB(){this.Veh();return!0}Veh(){if(this.Lr.Sjb){const a=new vh(1,u.AFrameworkApplication.isRtl);this.showFloatie(null,a)}}nY(a,b){a=this.Lr.kJa;this.Wne.push(b.Fd);if(!this.$bb.Hyb&&this.Lr.Sjb&&a&&a.length>=this.mgc.length&&b.succeeded)for(var c of a)if((b=this.qc.zl(new lc.a(c)))&&!this.YTf(b.sid,this.mgc)&&(this.mgc.push(b),this.tqe++,b=a.length,this.tqe===b)){this.pa.Utb();this.setSelection(a);var h=void 0;(h=
this.pa).J5a.apply(h,this.iR);if(c=this.F8i())this.Vb.Ba=c;this.tqe=0;c=!0;for(h=0;h<b;h++)(a=this.iR[h].tg(this.kfb))&&a.mhb&&a.mhb.x8()&&0<a.mhb.x8().length&&(c=!1);c&&this.showFloatie({},new vh(1,u.AFrameworkApplication.isRtl));break}}F8i(){let a=this.iR.length;if(!a&&(this.setSelection(this.Lr.kJa),a=this.iR.length,!a))return Ba.a.J(512497814,826,50,"GetLastPastedSlideNode and selectedNode is empty"),null;let b=this.iR[0];for(let c=1;c<a;c++)b.slideIndex>this.iR[c].slideIndex&&(b=this.iR[c]);
return b}setSelection(a){if(a&&a.length){Array.clear(this.iR);for(const b of a)(a=this.qc.zl(new lc.a(b)))?this.iR.push(a):Ba.a.J(512497813,826,50,"Cannot find the slide")}}caj(){let a=this.iR.length;if(!a&&(this.setSelection(this.Lr.kJa),a=this.iR.length,!a))return Ba.a.J(512497812,826,50,"GetLastPastedSlideNode and selectedNode is empty"),null;Ba.a.J(512497811,826,50,String.format("Pasted slides count is: {0} ",a));let b=this.iR[0];for(let c=1;c<a;c++)b.slideIndex<this.iR[c].slideIndex&&(b=this.iR[c]);
return b}showFloatie(a,b){b.location=this.LRc();if(b.location){const c=this.fc.$c(this.qc.Pn);if(!c||c&&a)Ba.a.J(512497810,826,50,"ShowFloatie number"),this.Yb.ka("ReactSlidePasteFloatieEnabled")&&(new VN(this.$bb,this.ABb)).Luh(b.location,b.vv),Array.clear(this.Wne)}}tN(a){this.$bb.Hyb&&(this.$bb.tN(),a&&(this.Lr.Sjb=!a.rTf,a.rTf&&this.Lr.Ngb&&(a=this.Lr.Ngb.sA,null!=a&&Ba.a.J(512497809,826,50,String.format("last user selcted keepSource:{0}",a.toString()))),this.Lr.Sjb||(this.Lr.m0c=0)))}evi(a){if(!this.Lr.e1b)return!0;
a=a.VJ;if(a.length!==this.Lr.e1b.length)return!0;let b=0;for(let c=0;c<a.length;c++)if(a[c]&&!a[c].equals(this.Lr.e1b[c])||!a[c]&&this.Lr.e1b[c])if(b++,b>this.mgc.length)return!0;return!1}uB(a,b){this.$bb.Hyb&&(a=Object(ua.a)(388,b.node))&&this.evi(a)&&this.tN(null)}LRc(){var a=this.caj();if(!a)return Ba.a.J(512497808,826,50,null),null;a=a.tg(this.kfb);if(!a)return Ba.a.J(512497807,826,50,null),null;a=qd.a.ii(a.Qkb);const b=a.x+a.width-86;let c=a.y+a.height+61+2;const h=this.jfb.xa.style.height;var m=
this.qRg.xa.style.height;m=parseInt(m.substr(0,m.length-2))+Kz.a.c2e;if(c>parseInt(h.substr(0,h.length-2))+m)c=c-a.height/2-2;else if(c<m)return this.tN(new ac(!1)),null;this.Lr.position=new Sys.UI.Point(b,c);return this.Lr.position}}Object(n.a)(WN,"PasteFloatieHelper",null,[305,141]);class GE{constructor(){this.Sjb=!1;this.m0c=0;this.Ngb=null;this.lIe=0;this.$db=[];this.position=this.e1b=null}get kJa(){return this.$db}set kJa(a){a?this.$db=a:Array.clear(this.$db)}}Object(n.a)(GE,"PasteFromFloatieArgs",
null,[]);var cR=d(1028);class XN{x8b(a){a=a.S7;return a===Ua.a.rg||a===Ua.a.UE||a===Ua.a.QE}}Object(n.a)(XN,"PasteHandlerUtil",null,[326]);class YN{constructor(a,b,c,h,m,y){this.TT=0;this.ia=a;this.B4=b;this.vHa=c;this.qx=h;this.gCb=m;this.X7j=y}kQ(a){if(!this.vHa.x8b(this.B4.value))return!1;if(this.qx.YHj(a)){a=Array.isArray(a.OW)?a.OW:null;if(this.dwj(a)&&!this.Cwj(a))return!1;this.TT=1}else if(this.gCb&&(this.qx.WHj(a)||this.qx.VHj(a))){a=this.qx.Ghe(a.uu);if(!this.X7j&&a)return ba.ULS.sendTraceTag(36558551,
307,50,"Cross-dc shape pasting is not allowed since its BRS is off."),this.TT=0,!1;this.TT=2}else this.TT=0;return 0!==this.TT}paste(a){1===this.TT?this.ia.La(M.a.kgd,2,a):2===this.TT&&this.ia.La(M.a.o9g,2,a)}dwj(a){for(const b of a)if(!b.isConnected)return!0;return!1}Cwj(a){for(const b of a)if(a=b.shapeNode,!a.Ej&&!a.ud)return!0;return!1}}Object(n.a)(YN,"ShapePasteHandler",null,[382]);class ZN{constructor(a,b,c){this.TT=0;this.ia=a;this.qx=b;this.vWa=c}kQ(a){this.qx.yeg(a)?this.TT=1:this.vWa&&this.qx.XHj(a)?
this.TT=2:this.TT=this.qx.$Hj(a)?3:0;return 0!==this.TT}paste(a){a.sA=null!=a.sA?a.sA:!0;Rd.a("UseClipServiceForDestinationThemePaste")&&1===this.TT&&!a.sA&&a.uu&&(this.TT=2);1===this.TT?this.ia.La(M.a.lgd,2,a):2===this.TT?(a.uu?Ba.a.J(512356509,826,50,"SlidePasteHandler:Paste FromClipService, pasteParams keepsource value {0}",a.sA):Ba.a.J(512356508,826,50,"SlidePasteHandler:Paste FromClipService, pasteParams is null"),this.ia.La(M.a.ngd,2,a)):3===this.TT&&this.ia.La(M.a.q9g,2,a)}}Object(n.a)(ZN,
"SlidePasteHandler",null,[382]);class HE{constructor(a,b,c,h){this.Ptg=[cf.a.Pag,cf.a.hNb,cf.a.bAh,cf.a.Vqd];this.ia=a;this.Fa=b;this.vHa=c;this.qx=h}kQ(a){if(!this.vHa.x8b(this.Fa)||HE.XPj(a)||this.qx.oVj(a))return!1;a.kQ=!this.jyi(a.tn);return a.kQ}jyi(a){for(let b=0;b<this.Ptg.length;++b)if(0<a.getElementsByTagName(this.Ptg[b]).length)return!0;return!1}paste(a){Ba.a.J(17310408,826,50,"TextPasteHandler: Execute command to paste text as new shape.");this.ia.La(M.a.oIe,2,a)}static XPj(a){if(!a||!a.tn)return Ba.a.J(17310404,
826,15,"TextPasteHandler: User attempted to paste null content."),!0;a=Wa.b(a.tn);return a&&a.length?!1:(Ba.a.J(17310406,826,15,"TextPasteHandler: User attempted to paste empty content."),!0)}}Object(n.a)(HE,"TextPasteHandler",null,[382]);var dR=d(877),eR=d(1033),fR=d(440),gA=d(670);class $N{constructor(a,b){this.lxa=a;this.pastedContent=b}}Object(n.a)($N,"PasteContext",null,[]);class aO{constructor(a){this.kwe=0;this.TEb=null;this.wck=a;this.afb=this.wck.nFb("UserAction","TimingLogger");this.reset()}start(){this.reset();
this.afb.start()}JXb(a){if(a&&0<a.length){this.TEb||(this.TEb={});const b=this.afb.Rq;this.TEb[a]=b-this.kwe;this.kwe=b}}flush(a=null){let b="";a&&0<a.length&&(b=a+":");if(this.TEb){a=this.TEb;for(let c in a)b+=String.format(" {0}={1}ms,",c,a[c])}0<b.length&&Ba.a.J(20570128,826,50,b);this.reset()}reset(){this.kwe=0;this.TEb=null}}Object(n.a)(aO,"TimingLogger",null,[]);class Jp{constructor(){this.objectCount=0;this.data=this.ccpid=null;this.contentType=this.dataSize=this.errorInCopying=0;this.packageSize=
this.packageKey=this.isDataCompressed=null;this.skipUndo=!1;this.selectionSlide=null}static AEi(a){if(!a)return null;a=a.getData(Jp.Xki);return Jp.Sbg(Jp.Qeh(a))}static BEi(a){return a?Jp.Sbg(Jp.Qeh(a.pptSlide)):null}static Sbg(a){if(!a||0===a.contentType)return Ba.a.J(541405764,826,15,"InitPicklingClipboardObject mimetype not supported"),null;a.dataSize=a.data?a.data.length/Jp.Ski:Number.MAX_VALUE;a.skipUndo=!1;Ba.a.J(540932290,826,50,"InitPicklingClipboardObject successful ccpid: {0}, datasize: {1}, objectCount: {2}, errorCode: {3}",
a.ccpid,a.dataSize,a.objectCount,a.errorInCopying);return a}static uVj(a){return!!a&&0<a.objectCount&&!!a.ccpid&&(!!a.data||!a.data&&!!a.errorInCopying)&&null!=a.isDataCompressed}static Qeh(a){try{let b=null;if(!a)return null;b=JSON.parse(a);if(Jp.uVj(b))return b.contentType=1,b.errorInCopying=void 0===b.errorInCopying||null===b.errorInCopying?0:b.errorInCopying,b}catch(b){Ba.a.J(541405765,826,15,"ReadPicklingData exception occured in parsing")}return null}}Jp.Ski=1048576;Jp.Xki="ppt/slides";Object(n.a)(Jp,
"PicklingClipboardObject",null,[]);var gR=d(672);class nh{constructor(a,b,c,h,m,y,G,U,ja,va,Ta,fb,Db,gc,hc,Gc,Pc,yc,Vd,De,Wd){this.yve=!1;this.BPg=0;this.uXa=null;this.Fgc=!1;this.jwe=null;this.tve=!1;this.B4=a;this.lh=b;this.Hq=c;this.Nbb=m;this.la=h;this.Bl=y;this.Jr=G;this.Vda=this.lh.contentWindow.document.body;this.Jr.addHandler(this.Vda,ra.a.paste,Object(F.a)(this,this.aFe,"onBrowserPaste"));this.Qd=U;this.No=ja;this.ldc=Db;this.Hma=new aO(va);this.ila=fb;this.vfc=null;this.w6c=h.iUj;this.jCg=
this.No.YN(7);this.qx=Ta;this.fO=gc;this.OT=hc;this.Ea=Pc;this.jc=Gc;this.Bc=yc;this.n0=Vd;this.ia=De;this.Wwe=h.pptEditingImageMaxSizeInBytes;this.IEg=Math.floor(h.pptEditingImageMaxSizeInBytes*nh.gxf);this.vdc=h.Ceg;this.vWa=h.qhe;this.t5c=h.UIj;this.KSg=h.gRj&&this.No.XW;this.Mve=this.p6c=!1;this.gCb=h.phe;this.Fdc=h.Lfg&&this.No.to;this.Pbk=h.G9i&&this.No.fg;this.r3j=h.pptCopyPasteRotateImageOnSafariFixIsEnabled&&this.No.oua;this.I5c=this.la.yLj;this.FL=Wd}dispose(){this.lh&&this.Jr.removeHandler(this.Vda,
ra.a.paste,Object(F.a)(this,this.aFe,"onBrowserPaste"));this.Hma=this.lh=null}Ayk(a){a===this.jwe.Ub&&this.ia.La(M.a.Hkc,2,this.jwe)}aFe(a){const b=this.Bc.eP(2,0,"OnBrowserPaste");this.Hma.start();this.p6c=this.tve=!1;if(Tk&&Tk.wA&&!Tk.wA.e1d){!this.No.MF||this.No.Uj||this.r3j?cf.a.WIc(this.lh):this.Nbb.Tib(this.lh);var c=this.OT.Rca(a);c=this.qx.vZc()?Jp.AEi(c):null;var h=new nE;h.UZd=a;h.gbh=b;null!=this.uXa&&(this.Bc.Yh(nh.tzf,"menu",b),this.Bc.Yh(nh.rzf,this.uXa?nh.ali:nh.Zki,b));this.Fgc&&(this.Bc.Yh(nh.tzf,
"menu",b),this.Bc.Yh(nh.rzf,nh.$ki,b));!this.Fgc&&c&&this.d9g(c,null,b,M.a.mgd,h)?this.uXa=null:(this.c9g(a,b),this.uXa=null,this.Fgc=!1)}}c9g(a,b){var c=this.OT.Rca(a);const h=this.OT.WRf(c);this.Bc.vUe(h,b);if(!this.ntl(a,b)){var m=Object.assign(new Dm.a(!0),{Ub:b,sA:this.uXa}),y=null;u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.SlideSorterPasteViaKeyboardEnabled",!1)&&document.activeElement.classList.contains("grid-content-editable-cursor-hide-class")&&(Ba.a.J(509669642,
826,50,"Getting html from dom event for slide sorter"),(y=a=this.OT.Q4b(c))||(y=c.getData("text/plain")));this.Pbk&&(Ba.a.J(512356507,826,50,"OnBrowserPaste::Getting html data from Clipboard"),c=this.OT.Q4b(c),a=this.OT.UYa(c),c?(this.DCf(a)&&(this.Hq.Uq[0].K6a=a.firstChild.className,m.OW=null),m.tn=a):Ba.a.J(512356506,826,15,"OnBrowserPaste::htmlString is empty"));this.jwe=m;Nc.a.qaa(()=>{this.AEe(void 0,m,y)},0,this.la.APj?0:2)}}Ipi(a){let b=!1;Tk.wA.C6a(c=>{Ba.a.J(512356505,826,50,"CheckAndEnablePasteAsOptions: isAccessible : {0}",
c);null!=c&&c&&(b=this.Qpi(a))});return b}Qpi(a){const b=Date.now();let c=!1;Tk.wA.Rca(this.lh,a,h=>{Ba.a.J(512356504,826,50,"CheckClipboardDataToEnablePasteAsOptions: GetClipboardData returned, time taken : "+(Date.now()-b));if(h){if(!a)h.html&&h.html.length<=nh.Pli?-1!==h.html.indexOf(nh.imi)&&(c=!0):h.pptSlide&&h.pptSlide.length&&(c=!0);else if(h.img||h.isImageAvailable)c=!0;c&&(h=[],a?(h.push(appChrome.actions.updateControlEnabledDisabledState(nh.cmi,!1)),h.push(appChrome.actions.updateControlEnabledDisabledState(nh.bmi,
!1)),h.push(appChrome.actions.updateControlEnabledDisabledState(nh.ami,!1))):(h.push(appChrome.actions.updateControlEnabledDisabledState(nh.sli,!1)),h.push(appChrome.actions.updateControlEnabledDisabledState(nh.kmi,!1)),h.push(appChrome.actions.updateControlEnabledDisabledState(nh.uli,!1)),h.push(appChrome.actions.updateControlEnabledDisabledState(nh.nmi,!1)),h.push(appChrome.actions.updateControlEnabledDisabledState(nh.tli,!1)),h.push(appChrome.actions.updateControlEnabledDisabledState(nh.lmi,!1))),
appChrome.api.dispatch(h));Ba.a.J(512356502,826,50,"CheckClipboardDataAndEnablePasteAsOptions: isCopiedDataCompatible={0}, time taken : {1}",c,Date.now()-b)}else Ba.a.J(512356503,826,50,"CheckClipboardDataToEnablePasteAsOptions: GetClipboardData returned, clipboardObject is null")});return c}d9g(a,b,c,h,m){b||(b=Object.assign(new Dm.a(!0),{Ub:c,sA:this.uXa}));b.qM=a;this.Bc.Yh(nh.objectCount,a.objectCount.toString(),c);this.Bc.Yh(nh.isDataCompressed,null==a.isDataCompressed?!1:a.isDataCompressed.toString(),
c);this.Bc.Yh(nh.dmi,(b.qM.packageSize?null==b.qM.packageSize?0:b.qM.packageSize/nh.gxf:b.qM.dataSize).toString(),b.Ub);return 0!==b.qM.errorInCopying?(Ba.a.J(541647952,826,15,"PastePicklingData invalid package ccpid: {0}, objectCount: {1}, error: {2}",b.qM.ccpid,b.qM.objectCount,b.qM.errorInCopying),this.Juh(b.qM.errorInCopying,h,m,b),!0):this.qx.bQj(b.qM.dataSize)?this.yZd(b):(Ba.a.J(541647953,826,15,"PastePicklingData package size exceeds limit ccpid: {0}, size: {1}, objectCount: {2}",b.qM.ccpid,
b.qM.dataSize,b.qM.objectCount),this.Juh(1,h,m,b),!0)}Juh(a,b,c,h){switch(a){case 1:this.Bc.Gg(!1,h.Ub,27);this.FL.Tfa(ResourceStrings.l_PasteAsImageErrorCalloutTitle,ResourceStrings.l_PasteAsImageErrorCalloutMessage,!0,ResourceStrings.l_PasteAsImageButtonTitle,!0,CommonUIStrings.l_DialogCancel,b,0,c,null,!1,nh.szf);break;default:this.Bc.Gg(!1,h.Ub,28),this.FL.Tfa(ResourceStrings.l_SomethingWentWrongCalloutTitle,ResourceStrings.errorTitle_PasteSlideFailed,!1,null,!1,null,0,0,null,null,!0,nh.szf)}}mgd(a,
b){Ba.a.J(512356499,826,50,"PasteSlideAsImage called");const c=this.Bc.eP(2,0,"PasteSlideAsImage");this.Bc.Yh("PasteSlideAsImage",b,c);this.Hma.start();this.p6c=this.tve=!1;this.c9g(a,c)}Rqi(a){a=a.split("+");const b=this.jc.mg(this.Hq.Uq[0].Fd).Cb;return b.cid.toString()===a[0]&&b.sid.toString()===a[1]}ntl(a,b){let c=!1,h=this.Fgc;var m=this.OT.D4d(a.rawEvent,this.lh.contentWindow);if(m){let y=null;({J7b:y,f0g:m}=this.OT.zsd(m,this.la.clipboardDataImageBlobNumberLimitaton,this.vdc?50*nh.OKh:this.IEg));
this.Hma.JXb("GetBlob");0<m&&(Ba.a.J(512356498,826,50,"Blob is too large"),this.wpd(b),c=!0);y&&1===y.length&&(Nc.a.qaa(()=>{this.xni(y,b,h)},0),this.KSg&&a.preventDefault(),c=!0)}else this.w6c&&this.jCg&&(this.vfc=this.ila.Utl(a.rawEvent));c&&this.Bc.CB(5,b);return c}xni(a,b,c){if(c||a&&(this.OT.Wtd(this.Vda)||this.KSg)){const h=a[0],m=Nc.a.Ib;Nc.a.xk(li.a.rhi,h.size.toString());this.vdc&&h.size>=this.IEg?(this.Mve&&Ba.a.J(512356497,826,50,"Ctrl-v pressed while shrinking image"),this.ldc.xng(h,y=>
{Nc.a.vF(m,()=>{y&&this.Mhl(y,h.size,b)||(this.p6c=!0,this.AEe(b));this.Mve=!1})}),this.Mve=!0):(new dR.a).cDh(a,y=>{Nc.a.vF(m,()=>{this.c$i(y,b)})})}else this.AEe(b)}c$i(a,b){this.Hma.JXb("GetDataUrl");this.Aul(a,b)||(Ba.a.J(512356496,826,15,"Paste image data uri failed"),this.paste(Object.assign(new Dm.a(!0),{Ub:b}),null,!1))}AEe(a="",b=null,c=null){this.paste(b||Object.assign(new Dm.a(!0),{Ub:a}),c,!1)}Kyk(a,b){if(Tk.wA){Ba.a.J(512356495,826,50,"PasteManager::PastePicklingData called ccpCorrId: {0}",
a.Ub);var c=Date.now();Tk.wA.Rca(this.lh,a.j8a,h=>{a.j8a&&(h.html=null,h.pptSlide=null,h.text=null);this.S_j(h,c);if(h=Jp.BEi(h)){var m=new oE;m.pastedContent=b;m.lxa=a;this.d9g(h,a,a.Ub,M.a.p9g,m)}else this.paste(a,b,!0)})}}S_j(a,b){if(a){var c=a.img?a.img.length:0,h=a.html?a.html.length:0,m=a.text?a.text.length:0;a=a.pptSlide?a.pptSlide.length:0;Ba.a.J(512356493,826,50,"LogClipboardObjectLength:: timeTaken: {0}, imgLength: {1}, htmlLength: {2}, textLength: {3}, pptSlideLength: {4}",Date.now()-b,
c,h,m,a)}else Ba.a.J(512356494,826,50,"clipboardObject is null")}paste(a,b,c){if(this.ia.YW)this.n0.show(5,-1),this.Bc.Gg(!1,a.Ub,26);else if(a.cSf)this.U$d(a,b);else if(Tk.wA){var h=this.No.uT&&u.AFrameworkApplication.fa.ka("ElectronClipboardAccessFix");this.la.HXc&&!h||this.Fdc?(a.qM=null,this.qx.vZc()&&!c?this.Kyk(a,b):(Ba.a.J(512356492,826,50,"Paste::m_isEdgeContextMenuPasteFixEnabled {0} or IsChromeClipboardAccessEnabled: {1} is enabled",this.Fdc,this.la.HXc),this.qRe(a,b))):(this.uXa=a.sA,this.Fgc=
a.j8a,this.qx.vZc()&&Tk.wA.Hsl(this.lh,a.Ub)?(this.Bc.Yh(nh.Tyk,"true",a.Ub),this.Bc.Gg(!0,a.Ub)):(this.uXa=null,({content:b}=Tk.wA.paste(this.lh,this.B4.value,a.Ub,!1)).returnValue?this.U$d(a,b):(Tk.wA.Fca(!1),b=Tk.wA.ay,null==b?(a=new Sh.a(null,Object(F.a)(this,this.CUi,"fWaitForAsyncAPIResult"),Object.assign(new uE,{rd:a.Ub})),a.Nl("ClipboardPreProcessForAsyncAPI"),a.run()):null!=b&&b&&this.qRe(a,null))))}else this.Bc.Gg(!1,a.Ub,1)}CUi(a,b){a=Tk.wA.ay;if(null==a)return!0;b=b.rd.toString();a?this.qRe(Object.assign(new Dm.a(!1),
{Ub:b}),null):this.Bc.Gg(!1,b,29);return!1}qRe(a,b){this.BPg=Date.now();this.yve=!1;Tk.wA.prepareForPaste(a.j8a,c=>{this.Bc.Yh("isPasteFromAsyncApi",c.toString(),a.Ub);this.yve=!0});b=new $N(a,b);(new Sh.a(null,Object(F.a)(this,this.prepareForPaste,"prepareForPaste"),b)).run()}mIe(a,b){return a&&0<a.length?(a=Object.assign(new Dm.a(!0),{Ub:b,Nbe:a,zOc:!0}),this.yZd(a),!0):!1}prepareForPaste(a,b){a=!0;let c=!1;if(this.yve){let h;({content:h}=Tk.wA.paste(this.lh,this.B4.value,b.lxa.Ub,b.lxa.j8a)).returnValue&&
h?this.U$d(b.lxa,h):c=!0;a=!1}else Date.now()-this.BPg>this.la.MCf&&(Ba.a.J(512356491,826,50,null),a=!1,c=!0,Tk.wA.reset());c&&this.Bc.Gg(!1,b.lxa.Ub,29);return a}get ucl(){return this.No.Dj&&this.la.BIj}U$d(a,b){if(!a.tn)if(Ba.a.J(512356490,826,50,"HandlePasteContent::pasteParams.PastedHtml is empty"),!b||a.Iig&&this.ucl)if(this.Ycl()){b=cf.a.eC();b.src=this.vfc;this.vfc=null;var c=cf.a.Fe();c.appendChild(b);a.tn=c}else this.DCf(this.Vda)&&(Ba.a.J(512356488,826,50,"HandlePasteContent::CheckWhetherFixClipboardId is true"),
this.Hq.Uq[0].K6a=this.Vda.firstChild.className,a.OW=null),Ba.a.J(512356487,826,50,"HandlePasteContent::Using m_body for PastedHTML."),a.tn=this.Vda;else Ba.a.J(512356489,826,50,"HandlePasteContent::Paste not from IFrame Clipboard or !ShouldGetPastedContentFromClipboardTargetDOM"),c=cf.a.Fe(),eR.a.Dnd(c,b,"PasteManager"),a.tn=c;this.BRd(a);b=this.qx.QKj(a.tn.firstChild);c=this.qx.TKj(a.tn.firstChild);if(b||c)Ba.a.J(512356486,826,50,"HandlePasteContent:pasteParams.PastedHtml is empty clipboard {0} / empty placeholder {1}",
b,c),this.Bc.Gg(!0,a.Ub);else if(this.LXi(a.tn),b=a.tn.innerHTML.startsWith("<img"),c=a.tn.innerHTML.length,a.cSf&&b&&(this.Hma.JXb("ConvertDataUrlToDOMNode"),this.Hma.flush(String.format("Browser={0}, Length={1}, IsFromBlob={2}",this.No.Ly,c,this.tve))),!c&&this.p6c)this.wpd(a.Ub);else{var h=0,m=!1;({dUd:h,h1d:m}=this.ltl(a));1===h?(Ba.a.J(512356485,843,15,"Failed to attach clipServiceObject due to deferred content, IsSlidePaste: {0}",m),this.Bc.Gg(!1,a.Ub,25)):!a.OW&&!a.uu&&c>this.Wwe?(Rd.a("PasteManagerOacr73010Fix")?
(this.lh.contentWindow.document.body.innerText="",a.tn.innerText=""):(this.lh.contentWindow.document.body.innerHTML=null,a.tn.innerHTML=null),b?(Ba.a.J(512356484,826,50,"Image too large"),this.wpd(a.Ub)):(Ba.a.J(512356483,826,50,String.format("Paste content size is {0} which is too big.",c)),this.Bc.Gg(!1,a.Ub,7))):(a.uu?(Ba.a.J(512356482,826,50,"HandlePasteContent - Before DispatchPaste,  pasteParams keepsource value {0}",a.sA),this.Bc.Yh(mp.a.Gp,a.uu.Gp,a.Ub)):Ba.a.J(512356481,826,50,"HandlePasteContent - Before DispatchPaste,  pasteParams ClipServiceObject is null"),
this.yZd(a))}}BRd(a){a?a.tn?a.tn.firstChild?a.tn.firstChild.getAttribute||Ba.a.J(512356449,826,50,"BuildDiagnosticInfo:pasteParams.PastedHtml.FirstChild.getAttribute is null"):Ba.a.J(512356450,826,50,"BuildDiagnosticInfo:pasteParams.PastedHtml.FirstChild is null"):Ba.a.J(512356451,826,50,"BuildDiagnosticInfo:pasteParams.PastedHtml is null"):Ba.a.J(512356480,826,50,"BuildDiagnosticInfo:pasteParams is null")}DCf(a){if(!(this.t5c&&a.firstChild&&a.firstChild.tagName&&"A"===a.firstChild.tagName.toUpperCase()&&
a.firstChild.getAttribute(mp.a.type)&&a.firstChild.getAttribute(mp.a.Jjb)&&this.Hq.Uq))return!1;const b=a.firstChild.className;return a.firstChild.getAttribute(mp.a.sessionId).toString()===this.Hq.Uq[0].sessionId&&b.startsWith("CID")&&b!==this.Hq.Uq[0].K6a&&(Object(za.a)(gA.a,this.Hq.Uq[0])&&"shape"===a.firstChild.getAttribute(mp.a.type).toString()&&this.Pqi(a.firstChild.getAttribute(mp.a.Jjb).toString())||Object(za.a)(Nv.a,this.Hq.Uq[0])&&"slide"===a.firstChild.getAttribute(mp.a.type).toString()&&
this.Rqi(a.firstChild.getAttribute(mp.a.slideId).toString()))}Pqi(a){a=a.split(",");let b=0;if(a.length!==this.Hq.Uq.length)return!1;for(const c of a)for(const h of this.Hq.Uq)if(c===this.Ea.Qwb(h.shapeNode).toString()){b++;break}return b===a.length}yZd(a){let b=!1;for(let c=0;c<this.Bl.length;c++)if(this.Bl[c].kQ(a)){b=!0;this.Bl[c].paste(a);break}b||this.Bc.Gg(!1,a.Ub,19);return b}Mhl(a,b,c){if(a){const h=new gR.a("ShrinkImage",!0);a=this.ldc.Jvh(a,b,this.Wwe);h.stop();if(a)return this.Hma.JXb("LoadAndShrinkImage"),
this.Hma.flush(String.format("Browser={0}, Length={1}",this.No.Ly,a.length)),Nc.a.xk(li.a.jAj,h.vaa.toFixed(0)),Nc.a.xk(li.a.iAj,h.gNc.toFixed(0)),Nc.a.xk(li.a.kAj,a.length.toString()),this.mIe(a,c)}return!1}LXi(a){this.I5c&&a&&(a=a.ownerDocument)&&(a=a.getElementById(mp.a.mbg))&&a.parentNode&&a.parentNode.removeChild(a)}ltl(a){let b,c;b=0;c=!1;if(a&&a.tn&&a.tn.firstChild&&a.tn.firstChild.getAttribute){var h=a.tn.firstChild;const m=h.getAttribute(mp.a.Gp),y=this.Hq.Uq;if(y&&0<y.length&&y[0]&&Sys.UI.DomElement.containsCssClass(h,
y[0].K6a)){let G=!1;(this.vWa&&Object(za.a)(Nv.a,y[0])||this.gCb&&Object(za.a)(gA.a,y[0]))&&this.oNj(y)&&(this.YIj(m)?G=!0:(a.c7g=!1,Ba.a.J(512356448,826,50,"Cannot use ClipService due to copy failure: ccpCorrId: {0}.",a.Ub)),Ba.a.J(512356447,826,50,"The copied graph nodes has been deleted, try to fall back to clip service; ccpCorrId: {0}, useClipService: {1}.",a.Ub,G));if(G)Ba.a.J(512356446,826,50,"TryAttachClipboardObjects: Using clip service for ccpCorrId: {0} for in-session COPY/PASTE but actually use clip service to fulfill the request.",
a.Ub),this.Hq.Uq=null;else if(Ba.a.J(512356445,826,50,"TryAttachClipboardObjects: Using internal objects for in-session COPY/PASTE for ccpCorrId: {0}.",a.Ub),a.OW=y,!Rd.a("UseClipServiceForDestinationThemePaste"))return{returnValue:!0,dUd:b,h1d:c}}else Ba.a.J(512356444,826,50,"it is not an internal paste, use ClipService instead; ccpId: {0}, ccpCorrId: {1} .",m,a.Ub);h=this.qx.sTi(h,a.Ub);b=h.uQa;c=1===h.dataType;if(this.qx.fVj(h)&&void 0!==h&&null!==h&&32===h.qW)return a.uu=h,Ba.a.J(512356443,826,
50,"This is IsValidClipServiceObject and copy action has succeeded, clipServiceObject.DataType {0}, pasteParams keepsource value {1} ",h.dataType,a.sA),{returnValue:!0,dUd:b,h1d:c};Ba.a.J(512356442,826,10,"Failed to use clip service, ClipServiceObject: [{0}].",h?h.toString():"(null)")}Ba.a.J(512356441,826,50,"TryAttachClipboardObjects::Failed to attach ClipboardObjects.");return{returnValue:!1,dUd:b,h1d:c}}Aul(a,b){let c=!1;if(this.ila.okg(a))if(a.length>=this.Wwe)this.wpd(b),c=!0;else{if(a=this.ila.Dtl(a))this.Hma.JXb("ExtractDataUri"),
this.Hma.flush(String.format("Browser={0}, Length={1}, IsFromBlob=true",this.No.Ly,a.length));c=this.mIe(a,b)}return c}oNj(a){for(const b of a)if(b.eig)return!0;return!1}YIj(a){if(this.fO.Ehe)return Ba.a.J(512356439,826,50,"Cannot predict copy result due to incompletion"),!1;Ba.a.J(512356440,826,50,"ccpId: {0}, LastCopyFailureCcpId: {1}.",a,this.fO.kmg);return!!a&&a!==this.fO.kmg}wpd(a){this.Bc.Gg(!1,a,18);this.Qd.YG(60,null)}Ycl(){let a=!1;if(this.vfc&&0<this.vfc.length&&this.jCg){const b=this.Vda.getElementsByTagName(cf.a.G8);
if(b){for(let c=0;c<b.length;c++){const h=b[c];if(h.src&&h.src.toLowerCase().startsWith("webkit-fake-url:")){a=!0;break}}Ba.a.J(512356438,826,50,"Get image url in Safari "+(a?"Succeeded":"Failed"))}}return a}}nh.OKh=1048576;nh.gxf=.75;nh.Pli=5E3;nh.Tyk="PasteViaTriggeringEvent";nh.objectCount="ObjectCount";nh.isDataCompressed="IsDataCompressed";nh.dmi="PastedObjectDataSize";nh.rzf="ActionName";nh.tzf="CcpMethod";nh.ali="PasteKeepingSourceFormatting";nh.Zki="PasteKeepingDestinationTheme";nh.$ki="PasteAsImage";
nh.imi='data-clipservice-type="slide"';nh.sli="ContextMenu.PasteKeepingDestinationTheme";nh.kmi="ContextMenu.PasteKeepingSourceFormatting";nh.uli="PasteKeepingDestinationTheme";nh.nmi="PasteKeepingSourceFormatting";nh.tli="PasteKeepingDestinationThemeMLR";nh.lmi="PasteKeepingSourceFormattingMLR";nh.szf=20;nh.cmi="PasteAsImageSLR";nh.bmi="PasteAsImageMLR";nh.ami="ContextMenu.PasteAsImage";Object(n.a)(nh,"PasteManager",null,[324,106]);class bO{constructor(a,b){this.tsg=a;this.Ga=b}kll(a,b,c,h,m){this.tsg.s1(this.Ga.ori,
a,b,c,this.Ga.pri,this.Ga.qri,this.Ga.rri,h,m)}zoi(a){this.tsg.yoi(a)}}Object(n.a)(bO,"PastedDataUploader",null,[320]);class IE{static create(a){const b=new IE;b.Xjg=Mr.b(a,c=>c.isEditable);return b}}Object(n.a)(IE,"ShapeCopyPasteParams",null,[]);class cO{constructor(a,b,c,h,m,y,G,U,ja,va,Ta,fb,Db,gc,hc,Gc,Pc,yc,Vd){this.pa=a;this.lh=b;this.B4=c;this.Hq=m;this.Zcc=h;this.ila=y;this.qx=G;this.fO=U;this.ia=ja;this.i7j=va;this.j7j=Ta;this.wdc=fb;this.Bdc=Db;this.u5c=gc;this.Pue=hc;this.dwa=Gc;this.Ea=
Pc;this.Bc=yc;this.vw=Vd}kQ(a){const b=this.pa.sg();let c=!1;b&&0<b.length&&this.B4.value.S7===Ua.a.rg&&(a.dataType=2,c=a.Yta?this.HTi(b):!this.pa.ZTa());return c}HTi(a){let b=!0;for(const c of a){if(c.m_c&&!c.isLocal)return!0;c.sC||(b=!1)}return b}ssa(a){u.AFrameworkApplication.fk("Microsoft.Office.Server.Powerpoint.Web.IPPTEditorPasteShapesWithEmbeddedClipServiceSettings");const b=this.pa.sg();if(!b||!b.length)return this.Hq.Uq=null,!1;var c;let h=({contentType:c}=this.ila.tSd(b)).returnValue;this.Bc.CB(c,
a.Ub);a.Yta?({Hjb:h,returnValue:c}=this.OMi(b,a.Ub,h),h="Cut:"+h):({Hjb:h,returnValue:c}=this.LMi(b,a.Ub,h),h="Copy:"+h);this.vw.sae(b,"DoCutCopy")&&(Ba.a.J(525960395,826,50,"ShapeCutCopyHandler: DoCutCopy HasDeferredContentOnShape: True"),a.Yta?this.vw.bra("ShapeCutCopyHandlerHasDeferredContentIsCut","true"):this.vw.bra("ShapeCutCopyHandlerHasDeferredContentIsCopy","true"));Ba.a.J(23614726,307,50,h);return c}OMi(a,b,c){let h=!0,m=[];for(const y of a)y.m_c&&m.push(y),y.sC||(h=!1);m=h?a:m;b=({Hjb:c}=
this.oJh(m,m,!0,!0,c,b,h)).returnValue;this.OGf(m);this.Bdc&&this.RGf(a);return{returnValue:32===this.ia.La(M.a.ZJf,2,b),Hjb:c}}LMi(a,b,c){if(this.wdc&&this.HJj(this.Mhj(),a))return{returnValue:!0,Hjb:c};const h=[];for(const m of a)m.m_c&&h.push(m);b=({Hjb:c}=this.oJh(a,h,this.wdc,!1,c,b)).returnValue;b.uu&&this.ia.La(M.a.QGf,2,b);this.OGf(a);this.Bdc&&this.RGf(a);return{returnValue:32===this.ia.processAction(M.a.PGf,2),Hjb:c}}HJj(a,b){if(!this.fO.Ehe||a.length!==b.length)return!1;for(let c=0;c<b.length;c++)if(!a[c].id||
!a[c].id.equals(b[c].id))return!1;return!0}nel(a){if(!a.length)return!0;let b=0,c=0;for(let h=0;h<a.length;h++){const m=a[h];if(m.isLocal)return!0;!m.Ej||m.get_isSVGBlipFilled()||m.isGif||b++;m.ud&&c++}return this.u5c?c===a.length:b+c===a.length}w$i(a){const b=[];for(const c of a)c&&(a=new gA.a(c),a.sessionId=this.dwa,b.push(a));return b}Mhj(){const a=[];if(this.Hq.Uq&&this.Hq.Uq.length)for(const b of this.Hq.Uq){const c=Object(ua.a)(gA.a,b);if(c&&c.shapeNode)a.push(c.shapeNode);else return[]}return a}oJh(a,
b,c,h,m,y,G=!1){let U=new Px(null,y,null);this.Hq.Uq=this.w$i(a);!c||this.nel(b)?(c&&(Ba.a.J(23614724,307,50,"Clip service shapes cut/copy is throttled"),this.Bc.Yh(mu.a.NDf,"true",y)),this.qx.Kud(this.lh,this.Hq.Uq,null,this.dwa,this.j4f(a),null,y)):(this.ila.Lwh(b),c=this.fO.DKc(2,b.length,h,G),c.Ric=IE.create(b),this.Pue&&this.vw.sae(a,h?"ShapeCutCopyHandler_DoCut":"ShapeCutCopyHandler_DoCopy")&&(c.uQa=1,c.qW=8),this.Bc.Yh(mu.a.Gp,c.Gp,y),m+=String.format(", CcpId={0}",c.Gp),this.qx.Kud(this.lh,
this.Hq.Uq,c,this.dwa,this.j4f(a),null,y),U=new Px(c,y,b));return{returnValue:U,Hjb:m}}j4f(a){const b=[];for(const c of a)Array.add(b,this.Ea.Qwb(c));return b}OGf(a){for(const b of a)if(b&&b.Ej&&(a=Lh.c(b,this.Zcc.Ic.Ma))&&!a.Al){a=a.IPa;if(!a)continue;a=a.getAttribute(Gk.a.SVc);if(!a)continue;const c=cf.a.eC();c.src=a.toString();b.get_shapeRotation()||this.ila.J6k(c,b.nx,b.wC);c.className+=this.Hq.Uq[0].K6a;this.lh.contentWindow.document.body.appendChild(c)}}RGf(a){(a=this.j7j.o0i(a,b=>!!b&&b.ud))&&
0<a.length&&(a=this.i7j.p0i(a))&&this.lh.contentWindow.document.body.appendChild(a)}}Object(n.a)(cO,"ShapeCutCopyHandler",null,[375]);class bs{constructor(a,b,c,h,m,y,G,U,ja,va,Ta,fb,Db){this.lh=b;this.B4=c;this.Hq=h;this.ua=m;this.ia=y;this.qx=G;this.fO=U;this.v5c=ja;this.Pue=va;this.pa=a;this.dwa=Ta;this.Bc=fb;this.vw=Db}kQ(a){var b=this.B4.value.S7;if(b=!!this.ua.Ba&&!!b&&b===Di.a.JD||b===Ua.a.rg&&!this.pa.Xd().length||b===Ua.a.QE)a.dataType=1;return b}ssa(a){this.Bc.CB(19,a.Ub);return this.XHi(a)}get Lb(){return this.pa}XHi(a){var b=
this.Lb.We();if(!b||!b.length)return this.Hq.Uq=null,ba.ULS.sendTraceTag(512497806,826,10,"Tried to copy slides but no slides were selected."),!1;var c=bs.ZYf(b,!0);if(!c.length)return a=this.B4f(b).join(","),ba.ULS.sendTraceTag(512497805,826,10,"Tried to copy slides but all of them were disconnected: '{0}'.",a),!1;b.length!==c.length&&(b=bs.ZYf(b,!1),b=this.B4f(b).join(","),ba.ULS.sendTraceTag(512497804,826,15,"Tried to copy slides but some of them were disconnected: '{0}', ignore them and continue",
b));var h=bs.getSlides(this.Hq),m=bs.fDi(this.dwa,c);this.Hq.Uq=bs.yql(m);b=(b=c[0])?b.Cb:null;const y=this.vw.cwj(c);this.v5c?this.fWe(h,m)?(Ba.a.J(512497801,307,50,"Clip service slide copy is throttled for ccopCorrId: {0}",a.Ub),this.Bc.Yh(mu.a.NDf,"true",a.Ub)):(h=this.fO.DKc(1,c.length,a.Yta),c=new kE.a(h,a.Ub,c),this.Bc.Yh(mu.a.Gp,h.Gp,a.Ub),m=8,y?this.Pue&&(h.uQa=1,h.qW=8):a.Yta||(m=this.ia.La(M.a.PVd,2,c),h.qW=m),this.qx.Kud(this.lh,this.Hq.Uq,h,this.dwa,null,b,a.Ub),!y&&a.Yta&&(m=this.ia.La(M.a.$Jf,
2,c)),Ba.a.J(512497802,307,32!==m?10:50,"Clip service slide isCut: {0} status: {1} for ccpid: {2}",a.Yta,h.qW,h.Gp),a.Yta?this.vw.bra("DeferredSlideCutStatus",h.qW.toString()):this.vw.bra("DeferredSlideCopyStatus",h.qW.toString())):(this.qx.Kud(this.lh,this.Hq.Uq,null,this.dwa,null,b,a.Ub),Ba.a.J(576745568,307,15,"Clip service has been disabled. CcpCorId: {0}",a.Ub));return!0}B4f(a){return zi.c(a,b=>b?b.Cb.toString():null)}fWe(a,b){if(!b||!b.length||bs.qei(b))return!0;if(this.fO.Ehe){if(!a||a.length!==
b.length)return!1;for(let c=0;c<b.length;c++)if(!bs.Iei(a[c],b[c]))return!1;return!0}return!1}static ZYf(a,b){const c=new Qa.a;for(const h of a)h.isConnected===b&&c.add(h);return c.toArray()}static getSlides(a){const b=[];if(!a||!a.Uq||!a.Uq.length)return b;for(let c=0;c<a.Uq.length;c++)b.push(Object(ua.a)(Nv.a,a.Uq[c]));return b}static Iei(a,b){return!a&&!b||!!a&&!a.Fd&&!!b&&!b.Fd||!!a&&!!a.Fd&&!!b&&!!b.Fd&&(!a.Fd.id&&!b.Fd.id||!!a.Fd.id&&!!b.Fd.id&&a.Fd.id.equals(b.Fd.id))}static qei(a){for(let b=
0;b<a.length;b++)if(a[b]&&a[b].Fd&&!lc.a.ax(a[b].Fd.Cb))return!1;return!0}static yql(a){const b=[];for(const c of a)b.push(c);return b}static fDi(a,b){const c=[];for(const h of b)c.push(Object.assign(new Nv.a(h),{sessionId:a}));return c}}Object(n.a)(bs,"SlideCopyHandler",null,[375]);class dO{constructor(a,b,c,h){this.Cla=this.Lse=!1;this.tWb=null;this.Nbb=a;this.Fck=b;this.Xbc=c;this.Bc=h}get DM(){this.tWb||(this.tWb=this.Fck.create());return this.tWb}get e1d(){return this.Cla}Fca(a){this.DM.Fca(a)}C6a(a){this.DM.C6a(a)}get J5(){return this.DM.J5}get ay(){return this.DM.ay}prepareForPaste(a,
b){this.Cla=!0;this.DM.prepareForPaste(b,a,this.Xbc.dCa.contentWindow.document)}Rca(a,b,c){this.Cla=!0;this.DM.Rca(a,b,c);this.Cla=!1}reset(){this.Cla=!1}Hsl(a,b){if(!this.vLa(a,b))return!1;try{const c=a.contentWindow.document;let h=c.body;La.a.tu(h);this.DM.Z7a(c,h);return!0}catch(c){Ba.a.J(512497800,826,10,"TriggerPasteRequest: We failed to generate the system clipboard event, even though we thought we had access!")}return!1}paste(a,b,c){let h;h="";b.xf(Ua.a.rg);if(!this.vLa(a,c)&&(null==this.ay||
null!=this.ay&&!this.ay))return{returnValue:!1,content:h};b=a.contentWindow.document;let m=b.body;this.Cla=!0;La.a.tu(m);let y=!1;try{this.Nbb.Tib(a),m=this.DM.Z7a(b,m),h=m.innerHTML,y=!0}catch(G){this.y6b(c)}this.Cla=!1;return{returnValue:y,content:h}}copy(a){a.contentWindow.focus();this.Cla=!0;let b;try{this.DM.hOc(a.contentWindow.document),b=!0}catch(c){b=!1}this.Cla=!1;return b?!0:!1}vLa(a,b){if(this.Lse)return!0;this.Cla=!0;let c=!1;try{c=this.DM.vLa(a.contentWindow.document.body,()=>{La.a.tu(a.contentWindow.document.body)},
()=>{this.Nbb.Tib(a)})}catch(h){}this.Cla=!1;c?this.Lse=!0:v.a.Dj||null==this.ay||this.ay||this.y6b(b);return c}y6b(a){this.Lse=!1;sq.instance.stb(null,null);this.Bc.Gg(!1,a,29)}}Object(n.a)(dO,"SystemClipboard",null,[321]);class eO{constructor(a,b,c,h,m,y,G,U){this.lve=!0;this.rwg=!1;m.pptOfflineModeEnabled&&a.HFc(Object(F.a)(this,this.uGb,"onNetworkHealthStateChanged"));this.kt=b;this.ia=c;this.n0=h;this.la=m;this.GO=y;this.OL=G;this.ua=U;this.AG=0;this.hdb=!1;this.r2c=0;this.YDg=new Date}get status(){return this.AG}uGb(a,
b){this.lve=b.bZc;this.rwg||this.Bph(this.lve,"NetworkHealthStateChanged")}EVf(a){this.rwg=!a;this.lve&&this.Bph(a,"PodSeamlessFailoverManager")}Bph(a,b){a&&this.hdb&&(this.n0.sqc=!1,this.AG=1,this.GO.BH());const c=!a,h=this.r2c+1;mh.a.instance.Eb(new He.a(2,1,c?this.la.switchToOfflineDelayInMs:this.la.switchToOnlineDelayInMs,()=>{this.qjb(c,h)},90,"107"));this.r2c++;ba.ULS.sendTraceTag(41272025,813,50,lh.c({["Current state"]:this.hdb.toString(),["Received signal"]:a.toString(),["Change id"]:h.toString(),
["State change source"]:b}))}qjb(a,b){this.r2c===b&&this.hdb!==a&&(this.n0.sqc=a,a&&3!==this.ia.mode||((this.hdb=a)?(this.AG=2,this.GO.BH(),this.OL.SW(this.ua.presentation)&&this.n0.show(0,-1)):(this.AG=0,this.n0.dismiss(),this.GO.BH()),this.kt.qjb(a),ba.ULS.sendTraceTag(41272026,813,50,"PPTO switches to {0}. The change id is {1} and the last state switching time is {2}",a?"Offline":"Online",this.r2c,Nc.a.nf(this.YDg)),this.YDg=new Date))}}Object(n.a)(eO,"PPTOfflineManager",null,[342]);class fO{Mqc(a,
b,c){mE.a(a,b,c)}}Object(n.a)(fO,"WarningDialogProxy",null,[317]);var hR=d(276);class Xx extends Nh.a{constructor(a,b,c,h,m,y,G,U,ja){super();this.Q3c=!1;this.vbc=null;this.zdb=0;this.c7c=this.oec=this.$6c=this.X6c=this.F9c=this.g7c=this.q3c=this.Fad=this.QWa=this.wwe=this.Owe=this.y0=this.A4=null;this.yma=a;this.Hec=b;this.hJ=c;this.F9j=h;this.k3j=m;this.c6j=ja;this.Fa=y;this.OSg=U;this.qc=G}dispose(){this.wwe=this.Owe=this.y0=this.A4=null;super.dispose()}Guh(a){this.dFh();this.$i(a,Object(F.a)(this,
this.PPi,"endDialogHandler"),{["MasterId"]:0,["LayoutId"]:0})}Hnh(a){if(a)for(let b=0;b<this.QWa.length;b++){const c=document.getElementById(this.QWa[b]);if(parseInt(c.getAttribute("LayoutId"))===a){this.oKb(c);break}}}ju(){super.ju();cf.a.Fe().appendChild(this.hDi());const a=document.getElementById(this.Nh("WACDialogPanel"));a&&a.removeAttribute(zc.a.tra)}tA(){super.tA();var a=document.getElementById(this.Nh("WACDialogPanel"));a.style.width=cf.a.Pc(532);a=parseInt(Oe.a.Qt(a).top);this.A4.style.height=
cf.a.Pc(Math.min(Math.max(0,Cf.a.DU-a-100),398));this.qg=this.A4.parentNode.innerHTML}I7(){super.I7();this.Owe=document.getElementById("MasterId");this.wwe=document.getElementById("LayoutId");this.oec=Object(F.a)(this,this.fbb,"keyPressHandler");u.AFrameworkApplication.Aa.kG.Jjd(ra.a.Zf,window.document,this.oec,null);this.X6c=Object(F.a)(this,this.GXj,"layoutClickHandler");this.$6c=Object(F.a)(this,this.HXj,"layoutDoubleClickHandler");this.c7c=Object(F.a)(this,this.JXj,"layoutOnFocus");for(let a=
0;a<this.QWa.length;a++){const b=document.getElementById(this.QWa[a]);this.vn.pb(ra.a.click,b,this.X6c);this.vn.pb(ra.a.doubleClick,b,this.$6c);wd.a.addHandler(b.firstChild,"focus",this.c7c)}}jsa(){super.jsa();this.oec&&u.AFrameworkApplication.Aa.kG.g2e(ra.a.Zf,window.document,this.oec);this.oec=null;for(let a=0;a<this.QWa.length;a++){const b=document.getElementById(this.QWa[a]);this.vn.yb(ra.a.click,b,this.X6c);this.vn.yb(ra.a.doubleClick,b,this.$6c);wd.a.removeHandler(b.firstChild,"focus",this.c7c)}this.c7c=
this.$6c=this.X6c=null}hDi(){if(this.A4)return this.A4;this.A4=cf.a.Fe();this.A4.id="LayoutPickerDiv";this.A4.className="LayoutPicker";this.zdb=0;this.QWa=[];var a=this.Hec.length;if(!a||1===a&&!this.Hec[0].InContent)return Ba.a.J(509654401,822,10,"Legacy LayoutDialog:: Master not loaded."),this.A4;var b=0;let c=!1;for(var h=0;h<a;h++)this.Hec[h].Id===this.F9j&&(b=h,c=!0);c&&this.hqf(this.Hec[b],1!==a);for(h=0;h<a;h++)c&&h===b||this.hqf(this.Hec[h],1!==a);a=cf.a.ZHf();a.id="MasterId";a.type="hidden";
b=cf.a.ZHf();b.id="LayoutId";b.type="hidden";this.A4.appendChild(a);this.A4.appendChild(b);return this.A4}hqf(a,b){a.InContent&&this.hJ.Hb(a.Id)&&(b&&this.A4.appendChild(this.ADi(a)),this.A4.appendChild(this.wBi(a)))}ADi(a){const b=cf.a.Fe();b.className="MasterSlideTitleBar";b.innerText=a.Name;return b}wBi(a){const b=a.Id;a=a.ContentMasters;if(!this.hJ.Hb(b))return null;const c=this.hJ.ga(b),h=cf.a.Fe();h.className="LayoutTableContainer";var m=cf.a.fJf();const y=cf.a.qGi();let G=null;h.appendChild(m);
m.appendChild(y);m=this.yma.width;let U=this.yma.height,ja;m||(m=1);U||(U=1);ja=U/m*145;let va=0;const Ta=a.length;for(var fb=0;fb<Ta;fb++)!this.OSg&&this.qc.cab(a[fb])||va++;fb=1;for(let Pc=0;Pc<Ta;Pc++){var Db=a[Pc];if(!this.OSg&&this.qc.cab(Db))continue;1===fb%3&&(G=cf.a.hXd(),y.appendChild(G));var gc=Db.Id.toString();const yc=Db.Name,Vd=cf.a.hLc();Vd.id="Layout"+this.zdb;Vd.setAttribute("LayoutIndex",this.zdb);Vd.setAttribute("MasterId",b);Vd.setAttribute("LayoutId",gc);Vd.setAttribute(zc.a.af,
zc.a.fN);Array.add(this.QWa,Vd.id);var hc=null;if(gc=!!c.LayoutIcons&&c.LayoutIcons.length>Pc&&!!c.LayoutIcons[Pc].Icon){hc=-1;for(var Gc=0;Gc<c.LayoutIcons.length;Gc++)if(c.LayoutIcons[Gc].LayoutId===Db.Id){hc=Gc;break}-1===hc&&(hc=Pc);hc=c.LayoutIcons[hc].Icon;Gc=new hR.a(hc.Clip.Bounds.Left,hc.Clip.Bounds.Top,145,ja);Db=cf.a.eC();Db.src=vb.a.instance.resolve("PPTe.IResourceViewElementResolver").resolve(ca.a.oub,hc.ImgId,"LayoutPicker");Db.title=yc;Db.style.clip=this.JNk(Gc);Db.style.left=cf.a.Pc(-Gc.w1a);
Db.style.overflow=Td.a.Ms;Db.style.position=Td.a.Ioa;Db.style.top=cf.a.Pc(-Gc.x1a);Db.style.zIndex="0";m<U&&(Db.style.height=cf.a.Pc(ja));Db.setAttribute(zc.a.af,zc.a.DPa);hc=document.createElement("span");hc.style.width=cf.a.Pc(145);hc.style.height=cf.a.Pc(ja);hc.setAttribute("Unselectable","on");hc.style.zIndex="0";hc.style.overflow=Td.a.Ms;hc.style.display=Td.a.eml;hc.style.position=Td.a.prc;hc.appendChild(Db);hc.setAttribute(zc.a.JK,zc.a.XB)}Db=cf.a.Fe();Db.id="title_Layout"+this.zdb;Db.className=
"LayoutTitle LayoutTitleHighContrast";Db.innerText=yc;Gc=cf.a.nca();Gc.setAttribute("tabindex","0");Gc.setAttribute("onclick","return false;");Gc.setAttribute("unselectable","on");Gc.setAttribute(zc.a.gs,yc);Gc.setAttribute(zc.a.af,zc.a.DPa);Gc.setAttribute(zc.a.mQd,fb);Gc.setAttribute(zc.a.nQd,va);gc&&Gc.appendChild(hc);Gc.appendChild(Db);G.appendChild(Vd);Vd.appendChild(Gc);this.zdb++;fb++}Ta%3&&(this.zdb+=3-Ta%3);return h}JNk(a){let b;b="rect( "+(cf.a.Pc(a.x1a)+", ");b+=cf.a.Pc(a.tLh)+", ";b+=
cf.a.Pc(a.uLh)+", ";return b+=cf.a.Pc(a.w1a)+")"}PPi(a,b){this.Q3c&&(Nc.a.Osb(this.vbc),this.Q3c=!1,this.vbc=null);1===a&&this.k3j(b.MasterId,b.LayoutId)}JXj(a){a=a.target.parentNode;this.y0&&a.id===this.y0.id||this.oKb(a)}fbb(a){a=a.pc;var b=this.fcj(a);if(b===z.a.lPb)return!0;if(b===z.a.tq)return(a=this.Fa.yl())&&"WACDialogCancelButton"!==a.uj.$Z.id?(this.$pa(1),this.hide(),!0):!1;a.preventDefault();if(!this.y0)return a=document.getElementById("Layout0"),this.oKb(a),!0;a=parseInt(this.y0.getAttribute("LayoutIndex"));
b=this.faj(b);for(let c=0;c<b.length;c++){const h=document.getElementById("Layout"+(a+b[c]));if(h){this.oKb(h);break}}return!0}fcj(a){let b=z.a.lPb;switch(a.keyCode){case z.a.K1:b=z.a.K1;break;case z.a.I1:b=z.a.I1;break;case z.a.PR:b=z.a.PR;break;case z.a.lP:b=z.a.lP;break;case z.a.tq:b=z.a.tq}this.c6j&&(b===z.a.lP?b=z.a.PR:b===z.a.PR&&(b=z.a.lP));return b}faj(a){let b=[0];switch(a){case z.a.K1:if(!this.Fad)for(this.Fad=Array(3),a=0;3>a;a++)this.Fad[a]=-3-a;b=this.Fad;break;case z.a.PR:if(!this.g7c)for(this.g7c=
Array(3),a=0;3>a;a++)this.g7c[a]=-1-a;b=this.g7c;break;case z.a.lP:if(!this.F9c)for(this.F9c=Array(3),a=0;3>a;a++)this.F9c[a]=a+1;b=this.F9c;break;case z.a.I1:if(!this.q3c)for(this.q3c=Array(3),a=0;3>a;a++)this.q3c[a]=3-a;b=this.q3c}return b}GXj(a){this.oKb(a.YB);return!0}HXj(a){a=a.YB;a!==this.y0&&this.oKb(a);this.$pa(1);this.hide();return!0}oKb(a){this.dFh();this.y0=a;const b=this.Fa.yl();b?b.uj.VE(a.firstChild):Ba.a.J(509654368,807,10,"LayoutDialog::SelectElement cannot find current FocusRegion");
Sys.UI.DomElement.addCssClass(this.y0,"Selected");this.Oxl();this.Q3c=!0;this.vbc||(this.vbc=Nc.a.qaa(Object(F.a)(this,this.Z1k,"selectElement_Finish"),0))}Z1k(){this.y0&&this.v1k(this.y0);this.Q3c=!1;this.vbc=null}dFh(){this.y0&&(Sys.UI.DomElement.removeCssClass(this.y0,"Selected"),this.y0=null)}v1k(a){const b=document.getElementById("LayoutPickerDiv");if(b){var c=b.scrollTop,h=b.offsetHeight,m=cf.a.z0g(b,a)._y,y=a.offsetHeight;m<c?3>a.getAttribute("LayoutIndex")?b.scrollTop=0:b.scrollTop=m:(a=h+
c,m=y+m,m>a&&(b.scrollTop=c+(m-a)))}}Oxl(){this.Owe.value=this.y0.getAttribute("MasterId");this.wwe.value=this.y0.getAttribute("LayoutId")}}Object(n.a)(Xx,"LayoutPicker",Nh.a,[]);class gO extends Xx{constructor(a,b,c,h,m,y,G,U,ja){super(a,b,c,h,m,y,G,U,ja)}dispose(){super.dispose()}ypd(a){this.Guh(ResourceStrings.l_NewSlideTitle);this.Hnh(a)}ju(){this.Xe(1,ResourceStrings.l_AddSlide);super.ju()}}Object(n.a)(gO,"AddSlideDialog",Xx,[399]);class hO extends Xx{constructor(a,b,c,h,m,y,G,U,ja){super(a,
b,c,h,m,y,G,U,ja)}dispose(){super.dispose()}ypd(a){this.Guh(ResourceStrings.L_SlideLayoutDialog);this.Hnh(a)}ju(){this.Xe(1,ResourceStrings.L_ChangeLayout);super.ju()}}Object(n.a)(hO,"ChangeLayoutDialog",Xx,[399]);class iO{constructor(a,b){this.Fa=a;this.qc=b}nWd(a,b,c,h,m,y,G,U){switch(a){case 1:return new gO(b,c,h,m,y,this.Fa,this.qc,G,U);case 0:return new hO(b,c,h,m,y,this.Fa,this.qc,G,U);default:return null}}}Object(n.a)(iO,"DialogFactory",null,[376]);class jO{constructor(a,b,c,h,m){this.Cma=
null;this.ia=a;this.cM=b;this.lq=c;this.lO=h;this.Sp=m;this.cM.y7(Object(F.a)(this,this.Jjc,"onShapeDisconneted"));this.lq.sOd(Object(F.a)(this,this.KYa,"onSlideBackgroundClicked"));this.lq.L$h(Object(F.a)(this,this.J5g,"onShapeViewElementBackgroundClicked"))}d$g(a){if(!a)throw Error.argumentNull("template");this.Cma=a;Ba.a.J(18368227,822,50,"FormatPainter::PickupFormat Template shape {0}",a.get_shapeId());this.lO.E_=!0}tdi(a){if(!a)throw Error.argumentNull("target");let b=!1;!this.Cma||a.id.equals(this.Cma.id)?
b=!0:a.get_isSVGBlipFilled()&&(this.Cma.lx||!this.Cma.nua&&!this.Cma.get_isSVGBlipFilled())&&(b=!0);b?this.XPa():(Ba.a.J(18368260,822,50,"FormatPainter::ApplyFormat Template shape {0} Target shape {1}",this.Cma.get_shapeId(),a.get_shapeId()),this.ia.La(M.a.n3d,2,new eA(this.Cma,a)))}XPa(){this.isActive&&(Ba.a.J(18368262,822,50,"FormatPainter::CancelFormat"),this.Cma=null,this.lO.E_=!1)}dispose(){this.cM.$Ja(Object(F.a)(this,this.Jjc,"onShapeDisconneted"));this.lq.sPe(Object(F.a)(this,this.KYa,"onSlideBackgroundClicked"));
this.lq.MUk(Object(F.a)(this,this.J5g,"onShapeViewElementBackgroundClicked"))}Jjc(a,b){b.node===this.Cma&&this.XPa()}KYa(){const a=this.isActive;this.XPa();this.Sp&&a&&this.ia.processAction(D.a.Cja,2)}J5g(a,b){this.isActive&&this.tdi(b.Gw.shapeNode)}get isActive(){return this.lO.E_}get Wol(){return this.Cma}}Object(n.a)(jO,"FormatPainter",null,[339,106]);var iR=d(1136),hA;(function(a){a[a.unsaved=0]="unsaved";a[a.rightClickThumbnailPanel=1]="rightClickThumbnailPanel";a[a.rightClickCanvas=2]="rightClickCanvas";
a[a.clickObjectOnCanvas=3]="clickObjectOnCanvas";a[a.tokenRefresh=4]="tokenRefresh";a[a.clipServiceCopy=5]="clipServiceCopy"})(hA||(hA={}));Object(n.b)("OfflineModalCalloutTrigger",hA);class kO{constructor(a){this.uo=null;this.sqc=!1;this.Qb=a;a=document.createElementNS(Gk.a.qZe,"polyline");a.setAttribute(Gk.a.v$g,"1,1 15,14 30,1");a.setAttribute(Gk.a.sqd,"rgb(234,234,234)");a.setAttribute(Gk.a.GYe,"2");a.setAttribute(Gk.a.V1d,"white");a.setAttribute(Gk.a.FYe,"bevel");this.Aoe=new Le.a;this.Aoe.ih(32,
16);this.Aoe.xa.appendChild(a);this.qbc=document.createElement("p");this.qbc.innerText=CommonUIStrings.l_ModalCalloutContentWhenDisconnected;this.qbc.style.width="258px";this.qbc.style.color="black";this.qbc.style.fontSize="14px"}dismiss(){this.uo&&(this.uo.dismiss(),this.uo=null)}show(a,b){ba.ULS.sendTraceTag(512497097,813,50,"OfflineModalCallout.Show is triggered by {0}",hA[a]);if(this.sqc){if(this.uo){if(this.uo.qL)return;this.uo.dispose()}let c=null;c=document.querySelector("[data-unique-id='GetOfflineStatus']");
Rd.a("OfflineModalCalloutCrashFix")&&!c?ba.ULS.sendTraceTag(512497096,813,10,"[Offline Modal Callout] Call out not shown as top element is null"):(a=qd.a.ii(c),this.uo=iR.a.HWd(a,c,this.Qb.kqd,2),this.uo.OZ=4,0<b&&(this.uo.T_e=b),this.uo.yr=!0,this.uo.content=this.qbc,this.uo.lUd=()=>{ba.ULS.sendTraceTag(512497095,813,50,"The user clicks the button to close the callout.");this.uo&&(this.uo.dispose(),this.uo=null)},this.uo.afd=()=>{if(this.uo&&this.uo.content){this.uo.content.parentNode.style.width=
"258px";this.uo.AJ.style.borderColor="rgb(234,234,234)";for(var h=this.uo.Erb;h.firstChild;)h.removeChild(h.firstChild);h.appendChild(this.Aoe.xa);this.uo.pUe()}else ba.ULS.sendTraceTag(512497094,813,50,"callout content is empty in OnShowCallback")},this.uo.show(),ba.ULS.sendTraceTag(512497093,813,50,"Display the callout control"))}}}Object(n.a)(kO,"OfflineModalCallout",null,[341]);var lO=d(300),iA=d(205);class mO{constructor(a,b,c){this.Xg=this.mO=this.xb=null;this.Db=!0;this.ta=a;this.Fcb=b;this.uxe=
a.Rub?a.Pda:null;this.tea=c}dispose(){this.tea&&this.mO&&($removeHandler(this.mO.xa,"error",Object(F.a)(this,this.z3g,"onImageLoadError")),this.mO.dispose(),this.mO=null);this.xb&&this.xb.yq();this.mO=this.Xg=this.xb=null;this.uxe&&(this.Fcb.revokeObjectURL(this.uxe),this.uxe=null)}Im(a){this.xb=new KD.a;this.xb.loa(Mi.a.SYe);a.appendChild(this.xb.viewport);this.mO=new lO.a;this.mO.Yj(0);this.xb.appendChild(this.mO);this.mO.Ew(this.ta.Pda);$addHandler(this.mO.xa,"error",Object(F.a)(this,this.z3g,
"onImageLoadError"));a=this.ta.fp;const b=pj.a.wBh(a);this.mO.setPosition(a.hc,a.kc);this.mO.ih(b.width,b.height);this.mO.Pd(!0);this.Xg=new ch.a;this.Xg.Yj(1);this.Xg.setVisibility(!1);this.Xg.xa.setAttribute("class","ShapeMoveHandle");this.Xg.Pd(!0);this.Xg.ut(a.points);this.Xg.HY("cursor: move");this.xb.appendChild(this.Xg);this.xb.Pl()}z3g(){Ba.a.J(34182307,826,15,"Locally rendered a broken image, IsPastingPicture={0}",this.ta.Gab)}setPosition(a,b){this.xb.setPosition(a,b)}eD(){}Hj(a){this.xb.Hj(a)}Nq(a){this.xb.LE(a,
iA.a.cca)}Ru(a){this.xb.LE(a,iA.a.esb)}setZIndex(a){this.xb.DB(a)}My(){}YD(){return null}yB(){return[]}draw(){}JE(){}Yp(){return this.Db?this.xb.Yp():null}get visible(){return this.Db}set visible(a){this.Db=a;this.xb.Pd(this.Db)}get qq(){return this.Xg}get me(){return this.xb}HN(a){return a.Cc===this.qq.xa}Jx(){}setSelection(){}}Object(n.a)(mO,"LocalImageView",null,[396,284,285,106]);class nO{constructor(a,b){this.Fcb=a;this.v7j=b}create(a){return new mO(a,this.Fcb,this.v7j)}}Object(n.a)(nO,"Factory",
null,[334]);class oO{constructor(a){this.Db=!0;this.CVa=this.jWa=this.xb=null;this.Vd=a}dispose(){this.xb&&this.xb.yq();this.jWa=this.CVa=this.xb=null;this.Db=!1}Im(a){this.xb=new KD.a;this.xb.loa(Mi.a.SYe);a.appendChild(this.xb.viewport);this.CVa=new ch.a;this.xb.appendChild(this.CVa);this.CVa.KE(Gk.a.none);a=this.Vd.shapeNode.fp;this.CVa.Su(xf.a.o1);this.CVa.jr(xf.a.NE);this.CVa.roa("2,2");this.CVa.ut(a.points);this.jWa=new lO.a;this.jWa.Yj(0);this.xb.appendChild(this.jWa);this.jWa.Ew(Rn.a.RK(xf.a.Bna));
a=pj.a.wBh(a);const b=xf.a.hIb,c=xf.a.yhd;this.jWa.setPosition(a.width/2-b/2,a.height/2-c/2);this.jWa.ih(b,c);this.jWa.Pd(!0);this.xb.Pl()}setPosition(a,b){this.xb.setPosition(a,b)}eD(){}Hj(){}Nq(a){this.xb.LE(a,iA.a.cca)}Ru(a){this.xb.LE(a,iA.a.esb)}setZIndex(a){this.xb.DB(a)}My(){}YD(){return null}yB(){return[]}draw(){}JE(){}Yp(){return this.Db?this.xb.Yp():null}get visible(){return this.Db}set visible(a){this.Db=a;this.xb.Pd(this.Db)}get me(){return this.xb}HN(){return!1}Jx(){}setSelection(){}}
Object(n.a)(oO,"ShapeProgressIndicatorView",null,[397,284,285,106]);class pO{create(a){return new oO(a)}}Object(n.a)(pO,"Factory",null,[335]);var cs=d(321);class JE{constructor(){this.Sy=null;this.Hra=this.jN=this.Ira=0;this.startTime=this.xhd=this.Ws=this.EH=this.oC=this.h3b=null}Jic(){return this.jN<this.Sy.mL?Object.assign(new JE,{Sy:this.Sy,Ira:this.jN,jN:this.jN+Math.min(this.Hra,this.Sy.mL-this.jN),Hra:this.Hra,h3b:this.h3b,oC:this.oC,EH:this.EH,Ws:this.Ws,xhd:this.xhd}):null}}Object(n.a)(JE,
"ChunkUploadingContext",null,[]);var ds=d(501);class Uv{constructor(a,b,c,h){this.wf=this.sJ=this.vH=null;this.mec=b;this.ubc=c;this.geb=h;this.zb=a}get d9(){return!!this.vH}s1(a,b,c,h,m,y,G,U=null,ja=null){this.d9?G(new ds.a(Object.assign(new cs.a,{Code:59}))):(ja&&ja.register(Object(F.a)(this,this.abort,"abort")),0<m&&(this.sJ=Object.assign(new He.a(2,1,m,Object(F.a)(this,this.lM,"onTimeout"),90,"85"),{customData:G}),this.zb.Eb(this.sJ)),(this.vH=Object.assign(new JE,{Sy:a,h3b:c,Ira:0,jN:0,Hra:b,
oC:h,EH:y,Ws:G,xhd:U,startTime:new Date}).Jic())?this.HOb(this.vH):G(new ds.a(Object.assign(new cs.a,{Code:92}))))}HOb(a){this.mec();if(this.ubc()||!this.d9)this.reset();else{this.vxa();var b=a.Sy,c=a.oC,h=a.Ira,m=a.jN,y=a.Hra,G=!h&&m===b.mL,U=new FormData;U.append("Type","2");U.append("FileName",a.Sy.fileName);c&&U.append("ImageToken",c);U.append("Content-Range","bytes "+h+"-"+(m-1)+"/"+b.mL);Ba.a.J(34420808,818,50,"ChunkedPictureUploader::UploadChunk - upload chunkStart:{0}, chunkEnd:{1}, chunkSize:{2}, fileSize:{3}",
h,m,y,b.mL);this.wf.onreadystatechange=()=>{this.wf&&4===this.wf.readyState&&this.iFe(a,this.wf.status)};b=G?a.h3b:a.h3b.slice(h,m);U.append("chunk",b);this.wf.send(U)}}iFe(a,b){let c=Object.assign(new cs.a,{Code:94});if(200===b){this.geb.wtc(this.wf.getResponseHeader(Uv.OSd));b=a.xhd;let h=null;try{h=Sys.Serialization.JavaScriptSerializer.deserialize(this.wf.responseText)}catch(m){Ba.a.J(34420810,818,10,"ChunkedPictureUploader::UploadChunk - failed to deserialize response {0}",m)}if(h&&!h.Error&&
h.Result){const m=h.Result;a.oC=m.ItemId;const y=a.Jic();a.Ira===m.XOffset&&m.ItemId?y?(b&&b.Brk(100*a.jN/a.Sy.mL,!1),c=null,this.HOb(y)):(b&&b.Brk(100,!0),c=null,Ba.a.J(34420812,818,50,"ChunkedPictureUploader::UploadChunk - upload completed, duration:{0}",+new Date-+a.startTime),this.reset(),a.EH(new vo.a(h.Result))):c.Code=152}else h&&h.Error&&(c=h.Error)}else Ba.a.J(34869445,818,10,"ChunkedPictureUploader::UploadChunk - upload failed, status:{0}, imageToken:{1}",b,a.oC||"");c&&(this.reset(),a.Ws(new ds.a(c)))}vxa(){this.wf=
new XMLHttpRequest;this.wf.open("POST",this.geb.S9a(),!0);u.AFrameworkApplication.accessToken&&(this.wf.setRequestHeader("X-AccessToken",u.AFrameworkApplication.accessToken),this.wf.setRequestHeader("X-AccessTokenTtl",u.AFrameworkApplication.t7.toString()));u.AFrameworkApplication.canary&&this.wf.setRequestHeader(Uv.noi,u.AFrameworkApplication.canary)}lM(a){Ba.a.J(34420816,818,15,"ChunkedPictureUploader::OnTimeout - upload timeout");this.sJ=null;this.abort();(a=a.customData)&&a(new ds.a(Object.assign(new cs.a,
{Code:299})))}abort(){if(this.d9){Ba.a.J(34420818,818,15,"ChunkedPictureUploader::Aborting upload");const a=this.wf;this.reset();a&&a.abort()}}reset(){this.sJ&&(this.zb.Rg(this.sJ),this.sJ=null);this.vH=this.wf=null}}Uv.noi="X-Key";Uv.OSd="X-NewKey";Object(n.a)(Uv,"ChunkedPictureUploader",null,[316]);class qO{constructor(a,b,c,h){this.zb=a;this.m6j=b;this.ldc=c;this.Vwe=h.pptEditingImageMaxSizeInBytes;this.REg=Math.floor(.75*this.Vwe);this.K9j=52428800;this.tCg=h.Ceg&&h.jhe;this.udc=h.jhe;this.J5c=
h.zLj;this.cec=h.Yig}get Uhc(){return this.tCg?this.K9j:this.REg}get oqc(){return this.udc}get Rod(){return this.J5c}e0b(a,b){if(b)if(a&&1===a.length){const c=a[0];c.size<this.REg?this.convertToBase64AndCallback(a,b):this.tCg?this.shrinkToBase64AndCallback(c,b):b(null)}else b(null)}convertToBase64AndCallback(a,b){const c=this.m6j.create();this.udc?c.Vtl(a,h=>{let m=h&&0<h.length?h[0]:null;m&&m.length>=this.Vwe&&(m=null);this.cec?b(m):this.zb.Eb(new He.a(2,1,0,()=>{b(m)},90,"83"))}):c.cDh(a,b)}shrinkToBase64AndCallback(a,
b){this.ldc.xng(a,c=>{const h=this.ldc.Jvh(c,a.size,this.Vwe);this.cec?b(h):this.zb.Eb(new He.a(2,1,0,()=>{b(h)},90,"84"))})}}Object(n.a)(qO,"PPTProcessImageStrategy",null,[372]);var jR=d(1113);class jA{static get qg(){return Nh.a.gC(jA.ro,ResourceStrings.l_ImageUploadMessage,ResourceStrings.l_NoImageSpecifiedErrorMessage)}}jA.ro="<div class='WACDialogRow' id='block1'> <label id='labelText' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='block2'> <input type='file' id='fileInput' name='fileInput' class='WACDialogInputFile'/> <div class='WACDialogError' id='errorText' role='alert'>{1}</div> </div>";
Object(n.a)(jA,"InsertImageDialogHtml",null,[]);class rO extends Nh.a{constructor(a){super();this.Jl=null;this.Xv=[];this.fB=a;this.qnf=!1;this.pWa=u.AFrameworkApplication.fa.ka("InsertLocalPictureMultiSelectionEnabled")}mgl(a){this.qg=jA.qg;this.Xe(1,ResourceStrings.L_Insert);this.showDialog(ResourceStrings.L_InsertPicture,Object(F.a)(this,this.REj,"insertImageDialogHandler"));if(this.Jl=document.getElementById("fileInput"))this.Jl.setAttribute("accept","image/*"),this.pWa&&a&&this.Jl.setAttribute("multiple",
"multiple");a=[];this.Jl&&(wd.a.addHandler(this.Jl,ra.a.Zf,Object(F.a)(this,this.onKeyDown,"onKeyDown")),a.push(this.Jl));var b=this.DQc(1);b&&a.push(b);(b=this.DQc(0))&&a.push(b);this.Xv=a;this.gzl()}validate(){const a=this.fB.jud(this.Jl.value);if(0!==a){const b=document.getElementById("errorText");b.innerText=this.fB.$7i(a);b.style.display="inline-block";return!1}return!0}dispose(){this.Jl&&wd.a.removeHandler(this.Jl,ra.a.Zf,Object(F.a)(this,this.onKeyDown,"onKeyDown"));super.dispose()}REj(a){1===
a&&this.fB.nrk(this.Jl);this.Jl=null}gzl(){if(0<this.Xv.length){const a=new jR.a(this.Xv),b=C.FocusManager.instance().yl();b&&(this.Xv[0].focus(),b.uj=a,b.kX=!0)}}onKeyDown(a){4!==C.FocusManager.instance().Qbh(a)&&a.preventDefault()}}Object(n.a)(rO,"InsertImageDialog",Nh.a,[]);class KE{constructor(){this.OVc=this.file=this.fileName=null;this.ASf=!1;this.dGb=null;this.mL=this.imageHeight=this.imageWidth=0;this.c1d=!1}}Object(n.a)(KE,"ImageType",null,[]);class sO{constructor(a,b,c,h,m,y,G,U,ja,va){this.IOb=
0;this.j3c=this.Cfc=this.pEg=this.Mjb=!1;this.ML=[];this.nWa="image/*";this.ia=a;this.Vdb=b?b.xa:null;this.pIa=null;this.Qd=c;this.lye=h;this.qBe=m;this.n8c=U.pptEditingUploadedImageMaxSizeInBytes;this.Fcb=y;this.x4j=G;this.aye=U.pptEditingUploadLargeImageMaxSizeInBytes;this.aak=U.pptEditingUploadLargeImageChunkSizeInBytes;this.bak=1E3*U.pptEditingUploadLargeImageTimeoutInSeconds;if(this.sfb=U.Tzk)this.nWa=this.sfb.join(",");this.pWa=U.WEj;this.geb=ja;this.Ce=va;this.ccc=U.zLi}get W0c(){return this.pEg}set W0c(a){this.pEg=
a;this.Cfc=0<this.aye&&this.Fcb.$Oj&&a}get Szk(){return this.Cfc}nrk(a){this.bqf(a);this.Vdb&&this.qBe.nXd(this.Vdb,a,Object(F.a)(this,this.mHe,"onUploadFrameInitialized"),Object(F.a)(this,this.Q7d,"getPictureUploadEndPoint"),this.nWa,!1,!1)}YAf(){return!(void 0===window.self.FormData||null===window.self.FormData)}jch(a){if(this.Vdb){if(this.ccc){if(this.YAf()){this.qBe.nXd(this.Vdb,null,Object(F.a)(this,this.mHe,"onUploadFrameInitialized"),Object(F.a)(this,this.Q7d,"getPictureUploadEndPoint"),this.nWa,
a&&this.pWa,!0);this.j3c=!1;return}Ba.a.J(558445203,822,10,"Browser does not support directly opening file dialog. Falling back to the old method")}v.a.Dj||v.a.rzb||v.a.uyb&&72>v.a.OIc?(this.qBe.nXd(this.Vdb,null,Object(F.a)(this,this.mHe,"onUploadFrameInitialized"),Object(F.a)(this,this.Q7d,"getPictureUploadEndPoint"),this.nWa,!1,!1),this.j3c=!1):((new rO(this)).mgl(a),this.j3c=!0)}else Ba.a.J(18643099,822,15,"PictureUploader initialize failed.")}SNi(a){this.Ttd&&(Array.addRange(this.ML,a),this.xHh())}get Ttd(){return 1>
this.ML.length}xHh(){if(!this.Ttd){const a=new KE,b=this.ML[0];b?(a.fileName=this.$0d(b.name),a.c1d=!0,this.Oeh(a)):(Ba.a.J(40993185,822,15,"PictureUploader.UploadNextImage File is null. Count of files: {0}.",this.ML.length.toString()),Array.clear(this.ML))}}Q7d(){return this.geb.S9a()}mHe(a){this.pIa=a;if(!this.j3c){if(this.ccc&&this.YAf()){a.IZd(Object(F.a)(this,this.Bqk,"onMultipleFileChosen"));return}if(v.a.MF){a.IZd(Object(F.a)(this,this.ktk,"onSingleFileChosen"));return}a=a.IZd(null);if(!a)return;
this.ML.push(a.files[0])}this.OOd()}bqf(a){if(a)if(this.pWa)for(const b of a.files)this.ML.push(b);else this.ML.push(a.files[0])}Bqk(a){this.bqf(a);this.OOd()}cNi(a){a=this.jud(a.fileName);return 0!==a?(this.pIa&&this.pIa.TLc(),2!==a&&3!==a||this.wt(90,a),!1):!0}n3b(a){let b=!0;this.W0c&&a.OVc&&!this.FCl(a)&&(this.pIa&&(this.pIa.C$b=!1),b=!1);!a.dGb||!this.Mjb&&b||(this.Fcb.revokeObjectURL(a.dGb),a.dGb=null);if(b){switch(this.IOb){case 0:this.ia.La(M.a.XOc,2,a);break;case 1:this.ia.La(M.a.l3d,2,a)}this.xHh()}else Array.clear(this.ML)}$0d(a){if(a){let b=
-1;const c=a.lastIndexOf("\\"),h=a.lastIndexOf("/");-1!==h?b=h:-1!==c&&(b=c);return a.substr(b+1)}return null}FCl(a){if(a.mL>this.n8c){if(this.Cfc&&a.mL<this.aye)return Ba.a.J(34420823,822,50,"Upload large image: {0}",a.mL),a.c1d=!0;Ba.a.J(20828424,822,50,"Image size is: {0} MB, bigger than {1} MB ",a.mL/1024/1024,this.n8c/1024/1024);this.wt(87,4);return!1}return!0}tTi(a){if(!a)return null;const b=a.lastIndexOf(".");return-1===b?null:a.substr(b+1)}pYe(a,b,c,h=null){if(a.c1d||this.pWa&&1<this.ML.length){const m=
this.pIa,y=this.ML[0];Array.remove(this.ML,y);const G=Nc.a.Ib;G&&G.Va("FChuckedPictureUpload","True");this.x4j().s1(a,this.aak,y,h,this.bak,U=>{m&&(m.C$b=!1,m.dispose());b(U)},U=>{m&&(m.C$b=!1,m.dispose());Array.clear(this.ML);c(U)})}else this.pIa&&(a=this.mej(h),this.pIa.kml(b,c,a)),Array.clear(this.ML)}mej(a){const b=new Jb.a;b.$("PresentationId",this.Ce.presentationId.string);b.$(ca.a.vna,this.Ce.sessionInfo);b.$("Canary",u.AFrameworkApplication.canary);b.$("access_token",u.AFrameworkApplication.accessToken);
b.$("Type",this.IOb.toString());a&&b.$("ImageToken",a);return b}ktk(a){a&&(Array.add(this.ML,a.files[0]),this.OOd())}OOd(){if(this.Ttd||!this.ML[0])Array.clear(this.ML);else{var a=new KE;a.fileName=this.$0d(this.ML[0].name);this.pIa.C$b=!0;this.Oeh(a)}}Oeh(a){this.cNi(a)?this.W0c?this.XLk(a):this.n3b(a):Array.clear(this.ML)}jud(a,b=!1){if(a&&a.length){if(1===this.IOb&&this.JTj(a))return Ba.a.J(39154959,822,50,"Try to set background picture using svg file but not supported."),3;if(this.t$f(a))return 0;
this.tTi(a)?Ba.a.J(20471823,822,50,"Insert local picture with invalid extension forCopyPaste: {0}",b):Ba.a.J(20471825,822,50,"Insert local picture with empty extension, forCopyPaste: {0}",b);return 1===this.IOb?3:2}return 1}JTj(a){return!!a&&0<a.length&&ta.a.og(a).endsWith(".svg")}$7i(a){switch(a){case 1:return ResourceStrings.l_NoImageSpecifiedErrorMessage;case 2:return this.vkg()?ResourceStrings.l_InvalidImageErrorWithSvgSupportedMessage:ResourceStrings.l_InvalidImageErrorMessage;case 3:return ResourceStrings.l_InvalidImageErrorMessage;
default:return""}}vkg(){return this.t$f(".svg")}t$f(a){a=ta.a.og(a);for(let b=0;b<this.sfb.length;++b)if(this.sfb[b]&&0<this.sfb[b].length&&a.endsWith(this.sfb[b].trim().toLowerCase()))return!0;return!1}wt(a,b){if(87===a){const c=this.Cfc?this.aye:this.n8c;this.Qd.YG(a,h=>{h.$B=1;h.GRa=[(c/1024/1024).toString()];return!1})}else{const c=this.Z7i(b);this.Qd.YG(a,h=>{h.$B=1;h.message=c;return!1})}}Z7i(a){return 2===a&&this.vkg()?String.format(ResourceStrings.imageFileNotListedInPptPictureUploadSupportedExtensions,
this.sfb.join(", ")):ResourceStrings.invalidImageFileError}XLk(a){let b=this.ML[0];if(b){a.mL=b.size;a.file=b;if(b.size>this.n8c&&this.Cfc)try{b=b.slice(0,6),a.ASf=!0}catch(c){Ba.a.J(34420828,822,50,"File.slice throw exception"),this.Mjb=!0,this.n3b(a)}this.lye.WLk(b,c=>{this.x2i(c,a)})}}x2i(a,b){try{let c=a.target.result;b.OVc=c;b.ASf&&(c=this.Fcb.createObjectURL(b.file),b.dGb=c);let h=new Image;h.onload=()=>{b.imageWidth=h.width;b.imageHeight=h.height;this.lHj(b.OVc)&&(this.Mjb=!0,Ba.a.J(22880261,
822,50,"Fallback for gif"));h.onload=h.onerror=null;h.src="";h=null;this.n3b(b)};h.onerror=()=>{Ba.a.J(20828428,822,50,"Read image failed");this.Mjb=!0;this.n3b(b)};h.src=c}catch(c){Ba.a.J(20828430,822,50,"GetBase64Image throw exception"),this.Mjb=!0,this.n3b(b)}}lHj(a){return 0<a.indexOf("base64,R0lGODlh")||0<a.indexOf("base64,R0lGODdh")}}Object(n.a)(sO,"PictureUploader",null,[315]);class tO{constructor(a){this.Ce=a}S9a(){let a="pptPictureUpload.ashx";if(Fc.App.webServiceBase)a=Fc.App.webServiceBase+
a;else if(v.a.fg||v.a.zua)a=ng.a.Wsa(a);a+=String.format("?{0}&{1}&{2}",u.AFrameworkApplication.QSa(),this.Ce.presentationId.string,u.AFrameworkApplication.q4b());this.Ce.podSessionId&&(a+=String.format("&{0}={1}",ca.a.U$,this.Ce.podSessionId));this.Ce.nk&&(a+=String.format("&waccluster={0}",this.Ce.nk));return a}wtc(a){if(a){var b=a.split(",");if(4===b.length){const c=b[0].trim()+","+b[1].trim();b=b[2].trim()+","+b[3].trim();a=c===b?c:a}u.AFrameworkApplication.canary=a;u.AFrameworkApplication.tac&&
Ba.a.J(37818512,818,50,"PictureUploaderHelper::UpdateCanary - New canary in response: {0}",a)}}}Object(n.a)(tO,"PictureUploaderHelper",null,[314]);class kA{constructor(a,b,c,h,m,y,G,U,ja,va){this.C$b=!1;this.ZT=null;this.Kla=!1;this.wf=this.KX=this.$Wa=this.Mcc=this.uhc=this.Jl=this.wx=this.ite=null;this.kf=a;this.D7j=h;this.Ce=c;this.v9=m;this.lCb=y;b&&(this.Jl=b.cloneNode(!0));this.P6j=G;this.nWa=U;this.i$j=ja;(this.qcb=va)?this.hQf():this.FAi()}FAi(){this.ZT=document.createElement("iframe");this.ZT.style.visibility=
Mi.a.hidden;this.ZT.id=kA.ymi;this.ZT.className="ObjectInDialog";this.kf.appendChild(this.ZT);this.uhc=Object(F.a)(this,this.R6g,"onUploadFrameLoad");wd.a.addHandler(this.ZT,"load",this.uhc);v.a.MF&&this.R6g(null)}IZd(a){u.AFrameworkApplication.Aa.lhb();if(!this.Jl)return null;this.qcb?wd.a.addHandler(this.Jl,"change",()=>{this.AVi(a)}):v.a.MF&&(this.ite=a,this.Mcc=Object(F.a)(this,this.KOc,"fileInputChange"),wd.a.addHandler(this.Jl,"change",this.Mcc));try{this.Jl.click()}catch(b){const c=String.format("UploadFrame::DoFileOpenDialog failed. Message: {0}. Stack: {1}",
b.message,b.stack);Ba.a.J(19505501,818,10,c);return null}return this.Jl}AVi(a){a&&a(this.Jl)}KOc(){this.ite&&this.ite(this.Jl)}kml(a,b,c){a||Ba.a.J(590210183,818,10,"UploadFrame::SubmitForm - The responseHandler value is null.");b||Ba.a.J(590210181,818,10,"UploadFrame::SubmitForm - The errorHandler value is null.");this.$Wa=a;this.KX=b;if(c.Hb("ImageToken")||c.Hb("AudioToken"))a=this.wx.action,a+=String.format("&{0}={1}",ca.a.dxk,1),this.Ce.podSessionId&&(a+=String.format("&{0}={1}","NoAuth","1")),
this.wx.action=a;for(let h of c.keys)this.b5h(h,c.ga(h));this.qcb?this.lml():this.wx.submit()}lml(){try{Ba.a.J(558445200,818,50,"SubmitFormWithRequest is preparing to send an upload request");const a=new (Type.parse("FormData"))(this.wx);this.f3k(a)}catch(a){Ba.a.J(558445201,818,10,"SubmitFormWithRequest failed to send the request with exception "+a.message),this.Mtc("SubmitFormWithRequest failed to send the request with exception "+a.message),this.TLc()}}f3k(a){if(a){const b=this.wx.action;this.wf=
new XMLHttpRequest;this.wf.open("POST",b);this.wf.onreadystatechange=Object(F.a)(this,this.quk,"onUploadResponseReceived");this.wf.send(a)}}quk(){4===this.wf.readyState&&(this.wf.status===Xp.a.Ey?this.Mtc(this.wf.responseText):(Ba.a.J(558445202,818,10,"Upload request failed with status: {0} [isResponseNull: {1}]",this.wf.status,this.wf.responseText?!1:!0),this.Mtc("Upload request failed")),this.TLc())}dispose(){this.v9(this);this.qcb&&this.kf?this.kf.removeChild(this.wx):this.kf&&this.ZT&&(this.kf.contains(this.ZT)&&
this.kf.removeChild(this.ZT),this.uhc&&wd.a.removeHandler(this.ZT,"load",this.uhc),this.uhc=null);this.Mcc&&(wd.a.removeHandler(this.Jl,"change",this.Mcc),this.Mcc=null);this.ZT=this.Jl=this.wx=this.kf=null}b5h(a,b){const c=this.bDi();c.type="hidden";c.id=a;c.name=a;c.value=b;this.wx.appendChild(c)}bDi(){return this.qcb?document.createElement("input"):this.ZT.contentWindow.document.createElement("input")}R6g(a){try{if(!this.ZT.contentWindow.document.body)return}catch(b){Ba.a.J(8958480,818,10,"UploadFrame::OnUploadFrameLoaded - Javascript exception thrown while accessing the document body: {0}",
b.toString());this.Mtc("0;Javascript exception thrown accessing the document body.");this.dispose();return}this.Kla?this.$Wa?(this.Mtc(this.Vlj(this.ZT.contentWindow.document.body)),this.TLc()):Ba.a.J(35984990,818,10,"UploadFrame::OnUploadFrameLoaded - Triggered by {0}",a?"load event":"explicit call"):this.hQf()}hQf(){if(!this.Kla){const a=this.P6j();this.qcb?(this.wx=document.createElement("form"),this.kf.appendChild(this.wx)):(this.wx=this.ZT.contentWindow.document.createElement("form"),this.ZT.contentWindow.document.body.appendChild(this.wx));
this.mCi();this.wx.id="formId";this.wx.method="post";this.wx.encoding="multipart/form-data";this.wx.action=a;this.wx.appendChild(this.Jl);this.Kla=!0;this.D7j(this)}}mCi(){this.Jl||(this.qcb?(this.Jl=document.createElement("input"),this.Jl.style.opacity="0",this.i$j&&(this.Jl.multiple="multiple")):this.Jl=this.ZT.contentWindow.document.createElement("input"),this.Jl.type="file",this.Jl.accept=this.nWa,this.Jl.id="fileInputId",this.Jl.name="fileInputId")}delayedDispose(){this.dispose()}TLc(){const a=
new He.a(2,1,0,Object(F.a)(this,this.delayedDispose,"delayedDispose"),90,"82");u.AFrameworkApplication.we.Eb(a)}Mtc(a){let b=null;try{b=Sys.Serialization.JavaScriptSerializer.deserialize(a)}catch(c){Ba.a.J(8958484,818,10,"UploadFrame::UploadResponseReceived - Exception when deserializing response. Response: {0}",a)}b&&!b.Error?this.$Wa?this.$Wa(new vo.a(b.Result)):Ba.a.J(8958482,818,10,"UploadFrame::SubmitInsertPictureForm - The m_onFinished value is null."):(a=b&&b.Error?b.Error:Object.assign(new cs.a,
{Code:94}),this.KX?this.KX(new ds.a(a)):Ba.a.J(8958486,818,10,"UploadFrame::SubmitForm - The m_onError value is null."))}Vbl(){return this.Kla&&!this.C$b}Vlj(a){let b=null;this.lCb?(this.fSk(a,c=>3!==c.nodeType||!!c.nodeValue&&!c.nodeValue.trim().length),a.firstChild&&3===a.firstChild.nodeType&&(b=a.firstChild.nodeValue)):b=v.a.Dj?a.innerText:a.innerHTML;return b||"No response got from server"}fSk(a,b){for(;a.firstChild&&b(a.firstChild);)a.removeChild(a.firstChild)}}kA.ymi="ppt_uploadframe";Object(n.a)(kA,
"UploadFrame",null,[393,394,395]);class uO{constructor(a,b){this.KBb=[];this.Ce=a;this.lCb=b}nXd(a,b,c,h,m,y,G){if(0<this.KBb.length)for(let U=this.KBb.length-1;0<=U;U--)this.KBb[U].Vbl()&&this.KBb[U].dispose();a=new kA(a,b,this.Ce,c,Object(F.a)(this,this.vMi,"disposeHandler"),this.lCb,h,m,y,G);Array.add(this.KBb,a)}vMi(a){Array.remove(this.KBb,a)}}Object(n.a)(uO,"UploadFrameFactory",null,[313]);class vO extends tq{constructor(a,b,c,h,m){super(a,b);this.jc=c;this.pa=h;this.Adc=m}Ls(a){var b="";if(this.Adc){const c=
ao.SchemeColor.parse(a);c&&(c.color&&!c.zta&&(b=Object(ua.a)(115,this.jc.mg(this.pa.Pa.mb.Ua.node)),(b=c.resolve(b?b.Ne:null))?c.WP=Cj.g(b.f_a):Ba.a.J(38061255,826,15,"PptInsertionPointFormatting: SetFontColor: Couldn't resolve font color: {0}",Cj.c(a))),b=c.toString());Ba.a.J(41267233,826,50,"PptInsertionPointFormatting: SetFontColor: set SchemeColor to: {0}",Cj.c(b));this.Zk.setValue(X.a.schemeColor,b);c&&c.zta&&(a=Cj.i(c.WP))}ta.a.Wa(a)||super.Ls(a)}}Object(n.a)(vO,"PptInsertionPointFormatting",
tq,[]);class LE{constructor(){this.Hra=this.jN=this.Ira=0;this.packageKey=this.zz=this.Zoa=null;this.WJb=this.eYa=this.E2=0;this.startTime=this.Ws=this.EH=null}Jic(){return this.jN<this.Zoa.length?Object.assign(new LE,{Ira:this.jN,jN:this.jN+Math.min(this.Hra,this.Zoa.length-this.jN),Hra:this.Hra,Zoa:this.Zoa,zz:this.zz,packageKey:this.packageKey,EH:this.EH,Ws:this.Ws,E2:0,eYa:this.eYa,WJb:this.WJb,startTime:new Date}):null}}Object(n.a)(LE,"ChunkContext",null,[]);class wO{constructor(a,b,c,h,m){this.wf=
this.sJ=this.vH=null;this.mec=b;this.ubc=c;this.zb=a;this.Ce=h;this.Ev=m}get d9(){return!!this.vH}s1(a,b,c,h,m,y,G,U,ja){this.d9?(Ba.a.J(512496902,818,15,"ChunkedDataUploader::StartUpload - already uploading with uploadId: {0}, not starting new upload for uploadId: {1}",this.vH.zz,h),ja&&ja(new ds.a(Object.assign(new cs.a,{Code:59})))):(0<m&&(this.sJ=Object.assign(new He.a(2,1,m,Object(F.a)(this,this.lM,"onTimeout"),90,"85"),{customData:ja}),this.zb.Eb(this.sJ)),(this.vH=Object.assign(new LE,{Ira:0,
jN:0,Hra:a,Zoa:b,packageKey:c,zz:h,EH:U,Ws:ja,E2:0,eYa:y,WJb:G,startTime:new Date}).Jic())?this.HOb(this.vH):(Ba.a.J(512496901,818,10,"ChunkedDataUploader::StartUpload - m_uploadingContext is null for uploadId: {0}",h),ja&&ja(new ds.a(Object.assign(new cs.a,{Code:437})))))}yoi(a){this.d9&&(Ba.a.J(512496900,818,50,"ChunkedDataUploader::CancelUpload - cancelling upload for uploadId: {0}",this.vH.zz),this.vH.zz===a&&this.abort())}HOb(a){this.mec();if(this.ubc()||!this.d9)Ba.a.J(512496899,818,15,"ChunkedDataUploader::UploadChunk - session expired or not uploading for uploadId: {0}",
a.zz),this.reset();else{var b=this.vxa(a);this.wf.onreadystatechange=()=>{this.wf&&4===this.wf.readyState&&this.iFe(a,this.wf.status)};this.wf.send(b)}}iFe(a,b){let c=Object.assign(new cs.a,{Code:94});if(200===b){b=null;try{b=Sys.Serialization.JavaScriptSerializer.deserialize(this.wf.responseText)}catch(h){Ba.a.J(512496898,818,10,"ChunkedDataUploader::OnChunkUploadComplete - failed to deserialize response {0}, uploadId: {1}",h,a.zz)}if(b&&!b.Error&&b.Result){const h=a.Jic();h?(this.Ev.VLa(100*a.jN/
a.Zoa.length),this.HOb(h)):(Ba.a.J(512496897,818,50,"ChunkedDataUploader::OnChunkUploadComplete - upload completed, duration:{0}, uploadId: {1}",+new Date-+a.startTime,a.zz),this.Ev.VLa(100),this.reset(),a.EH&&a.EH(new vo.a(b.Result)))}b&&(c=b.Error)}else Ba.a.J(512496896,818,10,"ChunkedDataUploader::OnChunkUploadComplete - upload failed, status:{0}, uploadId:{1}",b,a.zz);c&&(a.E2<a.eYa?(Ba.a.J(512496867,818,15,"ChunkedDataUploader::OnChunkUploadComplete - Retrying a chunk to upload again - upload chunkStart:{0}, chunkEnd:{1}, uploadId:{2}",
a.Ira,a.jN,a.zz),window.setTimeout(()=>{a.E2++;this.HOb(a)},a.WJb)):(Ba.a.J(512496866,818,10,"ChunkedDataUploader::OnChunkUploadComplete - Retry count exceeded - upload chunkStart:{0}, chunkEnd:{1}, uploadId:{2}",a.Ira,a.jN,a.zz),this.reset(),a.Ws&&a.Ws(new ds.a(c))))}vxa(a){this.wf=new XMLHttpRequest;this.wf.open("POST",this.S9a(),!0);u.AFrameworkApplication.accessToken&&(this.wf.setRequestHeader("X-AccessToken",u.AFrameworkApplication.accessToken),this.wf.setRequestHeader("X-AccessTokenTtl",u.AFrameworkApplication.t7.toString()));
const b=a.packageKey,c=a.Ira,h=a.jN,m=!c&&h===a.Zoa.length,y=new FormData;y.append("FileName",a.zz);b&&y.append("PackageKey",b);y.append("Content-Range","bytes "+c+"-"+(h-1)+"/"+a.Zoa.length);Ba.a.J(512496865,818,50,"ChunkedDataUploader::UploadChunk - upload chunkStart:{0}, chunkEnd:{1}, uploadLength: {2}, uploadId:{3}",c,h,a.Zoa.length,a.zz);a=m?a.Zoa:a.Zoa.slice(c,h);y.append("ChunkData",a);return y}S9a(){let a="PastedDataUpload.ashx";if(Fc.App.webServiceBase)a=Fc.App.webServiceBase+a;else if(v.a.fg||
v.a.zua)a=ng.a.Wsa(a);a+=String.format("?{0}&{1}&{2}",u.AFrameworkApplication.QSa(),this.Ce.presentationId.string,u.AFrameworkApplication.q4b());this.Ce.podSessionId&&(a+=String.format("&{0}={1}",ca.a.U$,this.Ce.podSessionId));this.Ce.nk&&(a+=String.format("&waccluster={0}",this.Ce.nk));return a}lM(a){Ba.a.J(512496864,818,15,"ChunkedDataUploader::OnTimeout - upload timeout for uploadId: {0}",this.vH.zz);this.sJ=null;this.abort();(a=a.customData)&&a(new ds.a(Object.assign(new cs.a,{Code:299})))}abort(){if(this.d9){Ba.a.J(512496863,
818,15,"ChunkedDataUploader::Aborting upload for uploadId: {0}",this.vH.zz);const a=this.wf;this.reset();a&&a.abort()}}reset(){this.sJ&&(this.zb.Rg(this.sJ),this.sJ=null);this.vH=this.wf=null}}Object(n.a)(wO,"ChunkedDataUploader",null,[319]);class xO{constructor(){this.Y5j=new sb.a(Object(F.a)(this,this.tIj,"isBrowerSupportObjectUrl"))}get $Oj(){return this.Y5j.value}tIj(){return!!this.URL&&!!this.URL.createObjectURL&&!!this.URL.revokeObjectURL}createObjectURL(a){return URL.createObjectURL(a)}revokeObjectURL(a){URL.revokeObjectURL(a)}get URL(){return window.URL||
window.webkitURL}}Object(n.a)(xO,"PPTFileApiHelper",null,[337]);class yO{yIj(){return window.FileReader?!0:!1}WLk(a,b){const c=new FileReader;c.onload=b;c.readAsDataURL(a)}readAsArrayBuffer(a,b){const c=new FileReader;c.onload=b;c.readAsArrayBuffer(a)}$0d(a){var b=null;if(a){b=-1;const c=a.lastIndexOf("\\"),h=a.lastIndexOf("/");-1!==h?b=h:-1!==c&&(b=c);b=a.substr(b+1)}return b}}Object(n.a)(yO,"PPTFileReaderHelper",null,[332]);var kR=d(953),lR=d(616),es;(function(a){a.ChatPPTExitClicked="ChatPPTExitClicked";
a.ChatPPTLikeClicked="ChatPPTLikeClicked";a.ChatPPTDislikeClicked="ChatPPTDislikeClicked";a.ChatPPTSuggestionClicked="ChatPPTSuggestionClicked";a.ChatPPTShowDesigner="ChatPPTShowDesigner";a.ChatPPTQueryExecutionStart="ChatPPTQueryExecutionStart";a.ChatPPTQueryExecutionComplete="ChatPPTQueryExecutionComplete"})(es||(es={}));Object(n.b)("ChatPPTEvents",es);class zO{constructor(a,b,c,h,m,y,G){this.WGa=!1;this.ofc=null;this.Uad=this.oBg=!1;this.Mu=U=>{1!==U.mode&&this.Ola&&Object(Rd.a)("EnableChatPPTPaneOnEditingMode")&&
!this.WGa&&"SingleLine".match(appChrome.selectors.getRibbonMode())&&this.showTaskPane()};this.DWe=(U,ja,va)=>{if(1==va)return 32;this.WGa?(this.Log(!1),this.dEf()):(this.Log(!0),this.showTaskPane());return 32};this.Kql=(U,ja)=>{this.WGa||this.oBg||!"SingleLine".match(appChrome.selectors.getRibbonMode())?this.WGa&&"Multiline".match(appChrome.selectors.getRibbonMode())&&ja.Yje?this.dEf():!this.WGa&&"SingleLine".match(appChrome.selectors.getRibbonMode())&&ja.Yje&&this.showTaskPane():this.showTaskPane()};
this.L5d=()=>{const U={TE:"What do you want to do? [Beta]",lAh:"What do you want to do?",assetId:"FA000000121"};U.nonPersistedSettings=this.A3i();U.ZLa=!0;U.p5=this.tgb;Object(Rd.a)("AddClassOnSDXPaneContainer")&&(U.yol="ActionAITaskPane");return U};this.XIa=(U,ja)=>{ja&&(U=ja.instanceId)&&U.length&&this.ofc==U&&(this.WGa=!1,this.ofc=null,Object(Rd.a)("EnableChatPPTEventListenerFromSDX")&&this.xll())};this.tgb=()=>{this.ofc=this.m9a();this.oBg=this.WGa=!0;Object(Rd.a)("EnableChatPPTEventListenerFromSDX")&&
this.Ckl()};this.e6k=()=>{fj.UISurfaces.xr().then(U=>{U.setSelectedTaskPane(this.m9a());return null}).catch(U=>{Ba.a.J(509354912,811,10,"ChatPPTPane::SelectPane exception: {0}",U.toString())})};this.dCf=U=>{if(null!=U&&void 0!=U&&null!=U.data&&void 0!=U.data)switch(U.data.type){case es.ChatPPTShowDesigner:this.ia.processAction(M.a.q7g,2);break;case es.ChatPPTQueryExecutionStart:this.ia.processAction(M.a.avb,2);break;case es.ChatPPTQueryExecutionComplete:this.e6k();break;case es.ChatPPTExitClicked:Object(Rd.a)("EnableFeedbackInChatPPTMode")?
this.tvk():this.CRf();break;case es.ChatPPTLikeClicked:Object(Rd.a)("EnableFeedbackInChatPPTMode")&&this.Kmk();break;case es.ChatPPTDislikeClicked:Object(Rd.a)("EnableFeedbackInChatPPTMode")&&this.Jmk()}};this.ia=a;this.Zc=b;if(!c&&Object(Rd.a)("EnableChatPPTPaneOnEditingMode"))throw Error.argumentNull("appFrame");this.Ola=y;this.M8j=G;this.Jne=m;this.Zc.execute(U=>{U.KFc(this.XIa)});h&&(this.ve=h,this.ve.sai(this.Kql));Object(Rd.a)("EnableChatPPTPaneOnEditingMode")&&c.IK(U=>{this.Mu(U)})}vb(){this.ia.ya(M.a.XZb,
xb.a.view,this.DWe);this.ia.ya(M.a.XZb,xb.a.notes,this.DWe);this.ia.ya(M.a.XZb,xb.a.Of,this.DWe);this.ia.he(M.a.XZb,4)}De(){}Log(a){Object(Rd.a)("logTelemetryForOpenClosePane")&&Ba.a.J(509613323,811,15,"ChatPPT-IsOpen:"+a)}showTaskPane(){if(this.WGa)return 8;const a=this.L5d();if(!a)return 8;this.ia.La(M.a.Ufa,2,a);return 32}dEf(){this.WGa&&this.ofc&&this.ia.La(M.a.Ssb,2,this.ofc)}A3i(){return Object(Rd.a)("NewSettingsForChatPPT")?{ChatPPTSessionID:Eh.a.create().toString(),AugloopClouldALServiceUrl:u.AFrameworkApplication.fa.Ha("AugLoopCloudALServiceUrl"),
ShouldUseEnvSpecificALUrl:1==this.M8j?"true":"false"}:{lGl:Eh.a.create(),jGl:u.AFrameworkApplication.fa.Ha("AugLoopCloudALServiceUrl")}}m9a(){if(!this.Zc.instance)return null;const a=this.Zc.instance.mQ("FA000000121");return a&&a.instanceId?a.instanceId:null}Mql(){appChrome.onRibbonModeToggle()}CRf(){this.Mql()}tvk(){Ba.a.J(509613280,811,15,"Chat PPT opt out via SDX");this.wWe("optOut",!1,!0)}Kmk(){Ba.a.J(509613250,811,15,"Chat PPT like button clicked");this.wWe("like",!0,!1)}Jmk(){Ba.a.J(509613249,
811,15,"Chat PPT dislike button clicked");this.wWe("dislike",!1,!1)}wWe(a,b,c){if(this.Jne){var h=null;if(c){let m=this;h=function(){m.CRf()}}try{b?this.Jne.mhl(a,h):this.Jne.Wfl(a,h)}catch(m){Ba.a.J(509613584,811,10,"Missed opening dialog; Error:"+m.toString()+" isLikeDialog:"+b+" exitChatPPTMode:"+c),h(!1)}}else Ba.a.J(509613464,811,10,"ActionAIFeedback is received as null")}Ckl(){this.Uad||(window.addEventListener("message",this.dCf),this.Uad=!0)}xll(){this.Uad&&(window.removeEventListener("message",
this.dCf),this.Uad=!1)}}Object(n.a)(zO,"ActionAIActor",null,[227]);class AO{constructor(a,b){this.Wxl=(c,h,m,y,G)=>{if(1===m)return 32;c=this.la.ECa?"DataSync: Fluid":"DataSync: Box4";G[np.a.Value]=c;G[bm.a.labelText]=c;G[np.a.Visible]=!0;return 32};if(!a||!b)throw ba.ULS.sendTraceTag(509384847,844,10,"DataSyncActor:IActor: ActionManager or appSettings should not be null."),Error.argumentNull("actionManager and appSettings cannot be null.");this.ia=a;this.la=b}vb(){this.ia.ra(M.a.Fch,he.a.frame,this.Wxl,
96)}De(){}}Object(n.a)(AO,"DataSyncActor",null,[227]);class BO{constructor(a){this.Upe=a}mhl(a,b){let c=this.DZf();c.initialFeedbackType="Smile";this.showDialog(a,c,b)}Wfl(a,b){let c=this.DZf();c.initialFeedbackType="Idea";this.showDialog(a,c,b)}showDialog(a,b,c){function h(y){Ba.a.J(509613319,811,15,"Feedback dialog dismissed. FeedbackSent:"+y+" Source:"+a);c&&c(y)}let m=this.Ws;fj.UISurfaces.e2f().then(y=>{y.initializeFeedbackModal(b,h,m)})}Ws(a){Ba.a.J(509613318,811,10,"Error in submitting feedback: "+
a)}DZf(){var a={};u.AFrameworkApplication.fa.qNd(a);a=this.Upe.getContext(a)||{};a.uiType="Modal";a.screenshot=!0;a.showEmailAddress=!0;let b=a.telemetryGroup||{};b.processSessionId=a.sessionId;b.officeBuild=a.build;b.featureArea="Chat PPT";a.telemetryGroup=b;return a}}Object(n.a)(BO,"ActionAIFeedback",null,[]);var mR=d(1004),nR=d(1241);class CO{constructor(a){this.wrc=(b,c,h)=>{var m;b=(new mR.a(new sb.a(()=>Fc.App.Kb?Fc.App.Kb.Jd.yi:null),na.InteractiveViewManager.instance,vb.a.instance.rb("Box4.ISelectionFactory"),
vb.a.instance.rb("PowerPointWebEditor.ISlideReader"),vb.a.instance.rb("PowerPointWebEditor.IPPTWorkspace"),vb.a.instance.rb("PowerPointWebEditor.Graph.IGraphTopologyManager"),new nR.a,vb.a.instance.rb("Common.IActionManagerExtended"),vb.a.instance.rb("PowerPointWebEditor.IPptSelectionManager"),vb.a.instance.rb("PowerPointWebEditor.IClipServiceManager"),vb.a.instance.rb("PowerPointWebEditor.IPresentationReader"))).getSelectedSlidesAsPPTXStream();if(null===(m=null===b||void 0===b?void 0:b.selectedSlideIDs)||
void 0===m||!m.length)return 16;if(1===h)return 2>b.selectedSlideIDs.length?16:32;this.ia.La(H.a.qXc,2,b);return 32};if(!a)throw Error.argumentNull("actionManager");this.ia=a;this.vb()}vb(){this.ia.ya(M.a.wrc,nc.a.application,this.wrc)}De(){}}Object(n.a)(CO,"AICopilotActor",null,[227]);class DO{constructor(){this.Wug=this.Q9c=this.rue=this.sue=this.Rze=this.JC=this.xla=this.K=null}get name(){return"PowerPointWebEditor.Actor"}$b(a){this.K=a;const b=a.resolve("PowerPointWebEditor.IApplicationContext");
a.resolve("PowerPointWebEditor.IApplicationSettings").zMj?a.register(297,"Box4.Actors.IFormattingStewardBridge").ma().oa(()=>new SN(new jE(a.resolve("Box4.IFormattingEditor")),a.resolve("Box4.IFormattingEditor"),a.resolve("PowerPointWebEditor.Graph.IPPTLineSpacingHelper"),a.resolve("PowerPointWebEditor.IPPTParagraphReader"),a.resolve("Box4.IParagraphIndentationReader"),a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.IApplicationSettings").dzb,a.resolve("PowerPointWebEditor.IApplicationSettings").Zig,
a.resolve("PowerPointWebEditor.IApplicationSettings").pptCopyPasteTextWithHighlight,a.resolve("PowerPointWebEditor.IApplicationSettings").pptCopyPasteFontFamilyEnabled)):a.register(297,"Box4.Actors.IFormattingStewardBridge").ma().oa(()=>new jE(a.resolve("Box4.IFormattingEditor")));a.register(298,"PowerPointWebEditor.IGraphTransactionHelper").ma().oa(()=>new DM(a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager").presentation,a.resolve("Common.Transaction.ITransactionFactory"),a.resolve("PowerPointWebEditor.IPPTWorkspace"),
a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IPresentationReader"),a.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventSource"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.View.IPPTPageView"),
a.Ja("PowerPointWeb.Comments.ICommentFrame")));a.register(299,"PowerPointWebEditor.IInsertOnlineVideoDialogHelper").ma().oa(()=>new QM(a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IShapeEditor"),a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.IPresentationReader"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),
a.resolve("PowerPointWebEditor.IRibbonChangeManager"),a.resolve("PowerPointWebEditor.ShapeEdit.IShapeCountValidator"),a.resolve("Common.Transaction.ITransactionFactory"),a.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager")));a.register(300,"Box4.IInsertionPointFormatting").ma().oa(()=>new vO(a.rb("Box4.IFontSlotProvider"),a.resolve("Box4.Actors.IFontNameFormattingStrategy"),a.resolve("PowerPointWebEditor.ISlideReader"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),
a.resolve("PowerPointWebEditor.IApplicationSettings").DZc));a.register(301,"Box4.IClipboardCommands").ma().oa(()=>a.resolve("PowerPointWebEditor.IApplicationSettings").remapShapeEditCommandEnabled?new gE(u.AFrameworkApplication.Ta,M.a.$$g,M.a.Zgd,M.a.$gd,M.a.jah):new gE(u.AFrameworkApplication.Ta,D.a.$Yb,D.a.uHc,D.a.Cra,D.a.hgd));a.register(302,"HtmlImport.IHtmlNormalizerSettings").ma().oa(()=>new iC(!1,a.resolve("Common.IAppSettingsManager").ka("SplitHyperlinkFixWithEnterIsEnabled")));a.register(303,
"HtmlImport.IHtmlTranslatorSettings").ma().oa(()=>{const c=a.resolve("PowerPointWebEditor.IApplicationSettings");return new XB(c.vig&&a.resolve("Common.IAppSettingsManager").ka("ListMarkerIsEnabled"),void 0,void 0,void 0,!0,c.gUa||c.Gyk,c.gUa,c.pptCopyPasteTextWithHighlight,c.gUa,c.gUa||c.pptCopyPasteFontFamilyEnabled,void 0,c.pptCopyPasteMarginAndIndentationEnabled,a.resolve("Common.IAppSettingsManager").ka("CopyAndPasteTextFromWordWin32FixIsEnabled"),c.pptCopyPasteFontFamilyEnabled,a.resolve("Common.IAppSettingsManager").ka("SupportCloudFontInExternalPasteIsEnabled"),
void 0,void 0,c.gUa,h=>h.xyb&&c.uje,()=>c.Gje)});a.register(304,"Box4.Actors.IBox4PasteStewardBridge").ma().oa(()=>new UN(a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("Box4.Actors.IBox4PasteStewardUtils"),a.resolve("Box4.IFormattingPropertyTransitStrategy"),a.resolve("PowerPointWebEditor.IPptListEditor"),a.resolve("Box4.Graph.IGraphIteratorFactory")));a.register(fE.a,"Common.PressOnlyKeyEvent").ma().oa(()=>fE.a.instance());a.register(GE,"PowerPointWebEditor.PasteFromFloatieArgs").ma().oa(()=>
new GE);a.register(305,"PowerPointWebEditor.IPasteFloatieHelper").ma().oa(()=>new WN(a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),a.resolve("Box4.Graph.IGraphInstance"),a.resolve("PowerPointWebEditor.IPresentationReader"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView").Ma,a.resolve("PowerPointWebEditor.IThumbnailPane"),a.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView"),a.resolve("Common.IClickInputManager"),
a.resolve("PowerpointPresence.IPresenceEventSource"),a.resolve("PowerPointWebEditor.IDialogManager"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),a.resolve("PowerPointWebEditor.IPPTWorkspace"),a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.PasteFromFloatieArgs"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventSource"),a.resolve("PowerPointWebEditor.IGraphActionBlockingEventHandlers"),a.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),
a.resolve("PowerPointWebEditor.IRibbonPane"),a.resolve("PowerPointWebEditor.IApplicationSettings").ejg,a.resolve("Common.IAppSettingsManager"),a.resolve("Common.PressOnlyKeyEvent"),a.resolve("Box4.IPasteFloatieEventNotifier"),a.resolve("PowerPointWebEditor.IDesignModeManager").dCa));a.register(hE,"Box4.Clipboard.NoOpEdgeSystemClipboardSelectionEnsureStrategy").as("Box4.Clipboard.IEdgeSystemClipboardSelectionEnsureStrategy").ma().oa(()=>new hE);a.register(278,"Box4.IContextSetEditor").ma().oa(()=>
tg.ContextSetEditor.instance);a.register(306,"PowerPointWebEditor.IPPTFormattingStewardHelper").ma().oa(()=>new TN(a.resolve("Box4.Graph.IGraphIteratorFactory"),a.resolve("Box4.ITableCellReader"),a.resolve("PowerPointWebEditor.ISlideReader"),a.resolve("PowerPointWebEditor.IPPTTableStyleReader")));a.register(dt,"PowerPointWebEditor.EnterViewStrategy").as("Box4.Actors.IEnterViewStrategy").ma().oa(()=>new dt(a.rb("Box4.IAutoCorrectScheduler"),a.re("Box4.IUndoManager"),a.Ja("Box4.IExternalSelectionManager")));
a.register(FE,"PowerPointWebEditor.PPTFontNameFormattingStrategy").as("Box4.Actors.IFontNameFormattingStrategy").ma().oa(()=>new FE(a.resolve("PowerPointWebEditor.IFormattingHelper")));a.register(307,"Box4.Actors.IEopFormattingStrategy").ma().oa(()=>a.resolve("PowerPointWebEditor.IApplicationSettings").obb?Object(ua.a)(307,new IN):Object(ua.a)(307,new cM));a.register(308,"Box4.ISelectAllHandlers").ma().oa(()=>new as(Pw.PageReader.instance,a.re("Box4.IUndoManager"),a.resolve("Box4.Graph.IGraphTransactionFactory"),
!1,!0));a.register(309,"Box4.Actors.IDeleteOutlineElementNodeStrategy").ma().oa(()=>new GN(a.resolve("Box4.IOutlineElementReader"),a.resolve("Box4.ISelectionManager")));a.register(310,"Box4.IFormatPainterStrategy").ma().oa(()=>new JN(a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.IPptListEditor"),a.resolve("PowerPointWebEditor.IPptSelectionManager")));a.register(311,"Box4.Clipboard.IClipboardOperationCutStrategy").ma().oa(()=>new FN);a.register(312,"Box4.Actors.IDeleteTableSegmentStrategy").ma().oa(()=>
new HN(a.resolve("PowerPointWebEditor.ITableCellSelectionHelper"),a.resolve("PowerPointWebEditor.Graph.ITableColumnReader"),a.resolve("PowerPointWebEditor.IPptSelectionManager")));a.register(313,"PowerPointWebEditor.IUploadFrameFactory").ma().oa(()=>new uO(a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.resolve("PowerPointWebEditor.IApplicationSettings").ALj));a.register(314,"PowerPointWebEditor.IPictureUploaderHelper").ma().oa(()=>new tO(a.resolve("PowerPointWebEditor.ISessionInfoOwner")));
a.register(315,"PowerPointWebEditor.IPictureUploader").ma().oa(()=>new sO(a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.ISlidePane"),a.resolve("PowerPointWebEditor.IErrorHandler"),a.resolve("PowerPointWebEditor.IPPTFileReaderHelper"),a.resolve("PowerPointWebEditor.IUploadFrameFactory"),a.resolve("PowerPointWebEditor.IFileApiHelper"),()=>a.resolve("PowerPointWebEditor.IChunkedPictureUploader"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.IPictureUploaderHelper"),
a.resolve("PowerPointWebEditor.ISessionInfoOwner")));a.register(316,"PowerPointWebEditor.IChunkedPictureUploader").oa(()=>new Uv(a.resolve("Common.ITaskManager"),()=>{Nc.a.cbb()},Object(F.a)(wg.a.instance,wg.a.instance.A6a,"checkAndTriggerSessionHasExpired"),a.resolve("PowerPointWebEditor.IPictureUploaderHelper")));a.register(317,"PowerPointWebEditor.IWarningDialog").ma().oa(()=>new fO);a.register(318,"PowerPointWebEditor.ICalloutNotificationAdapter").ma().oa(()=>new $Q.a(a.resolve("Common.App.CalloutNotification.ICalloutNotification"),
a.resolve("PowerPointWebEditor.IRibbonPane").xa));a.register(319,"PowerPointWebEditor.IDataUploader").oa(()=>new wO(a.resolve("Common.ITaskManager"),()=>{Nc.a.cbb()},Object(F.a)(wg.a.instance,wg.a.instance.A6a,"checkAndTriggerSessionHasExpired"),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.resolve("PowerPointWebEditor.Core.IPasteProgressManager")));a.register(320,"PowerPointWebEditor.IPastedDataUploader").ma().oa(()=>new bO(a.resolve("PowerPointWebEditor.IDataUploader"),a.resolve("PowerPointWebEditor.IApplicationSettings"),
a.resolve("PowerPointWebEditor.Core.IPasteProgressManager")));a.register(160,"PowerPointWebEditor.IMediaUploader").oa(()=>new lR.a(a.resolve("Common.ITaskManager"),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.resolve("PowerPointWebEditor.Core.IPasteProgressManager"),()=>{Nc.a.cbb()},wg.a.instance.A6a.bind(wg.a.instance)));a.register(321,"PowerPointWebEditor.ISystemClipboard").ma().oa(()=>new dO(a.resolve("PowerPoint.IBrowserHelperManager"),a.resolve("Box4.Clipboard.ISystemClipboardAccessManagerFactory"),
a.resolve("PowerPointWebEditor.IDesignModeManager"),a.resolve("PowerPointWebEditor.IClipboardTelemetry"),a.resolve("PowerPointWebEditor.IApplicationSettings")));a.register(322,"PowerPointWebEditor.IInternalClipboard").ma().oa(()=>new RN(a.resolve("PowerPointWebEditor.IApplicationSettings").vgg?a.resolve("Box4.Graph.IGraphInstance").Ad(10):null,a.resolve("PowerPointWebEditor.IApplicationSettings").vgg?a.resolve("Box4.Graph.IGraphInstance").Ad(8):null));a.register(323,"PowerPointWebEditor.ICutCopyManager").ma().oa(()=>
new PN(a.resolve("PowerPointWebEditor.IDesignModeManager").dCa,[new cO(a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.IDesignModeManager").dCa,a.re("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IActiveSlideViewManager"),a.resolve("PowerPointWebEditor.IInternalClipboard"),a.resolve("PowerPointWebEditor.ICopyPasteUtility"),a.resolve("PowerPointWebEditor.IClipboardHelper"),a.resolve("PowerPointWebEditor.IClipServiceManager"),a.resolve("Common.IActionManagerExtended"),
a.resolve("PowerPointWebEditor.HtmlExport.IHtmlExportProcessor"),a.resolve("PowerPointWebEditor.HtmlExport.IHtmlExportUtils"),a.resolve("PowerPointWebEditor.IApplicationSettings").$Ij,a.resolve("PowerPointWebEditor.IApplicationSettings").OJj,a.resolve("PowerPointWebEditor.IApplicationSettings").ZIj,a.resolve("Common.IAppSettingsManager").ka("UseToastForDeferredBlobsEnabled"),u.AFrameworkApplication.userSessionId,a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.IClipboardTelemetry"),
a.resolve("PowerPointWebEditor.IDeferredContentManager")),new bs(a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.IDesignModeManager").dCa,a.re("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IInternalClipboard"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.IClipboardHelper"),a.resolve("PowerPointWebEditor.IClipServiceManager"),a.resolve("PowerPointWebEditor.IApplicationSettings").aJj,
a.resolve("Common.IAppSettingsManager").ka("UseToastForDeferredBlobsEnabled"),u.AFrameworkApplication.userSessionId,a.resolve("PowerPointWebEditor.IClipboardTelemetry"),a.resolve("PowerPointWebEditor.IDeferredContentManager"))],a.resolve("PowerPointWebEditor.IActiveSlideViewManager"),a.resolve("PowerPointWebEditor.ISystemClipboard"),a.resolve("PowerPoint.IBrowserHelperManager"),a.resolve("PowerPointWebEditor.IInputHandlerManager"),a.resolve("PowerPointWebEditor.IClipboardTelemetry"),a.resolve("PowerPointWebEditor.IOfflineModalCallout"),
a.resolve("Common.IActionManagerExtended")));a.register(324,"PowerPointWebEditor.IPasteManager").ma().oa(()=>new nh(a.re("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IDesignModeManager").dCa,a.resolve("PowerPointWebEditor.IInternalClipboard"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPoint.IBrowserHelperManager"),[new YN(a.resolve("Common.IActionManagerExtended"),a.re("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IPasteHandlerUtil"),
a.resolve("PowerPointWebEditor.IClipboardHelper"),a.resolve("PowerPointWebEditor.IApplicationSettings").phe,a.resolve("PowerPointWebEditor.IApplicationSettings").$ig),new ZN(a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.IClipboardHelper"),a.resolve("PowerPointWebEditor.IApplicationSettings").qhe),new cR.a(a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IPasteHandlerUtil"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),
a.resolve("PowerPointWebEditor.IWarningDialog"),a.resolve("Common.IBrowserUtils"),a.resolve("PowerPointWebEditor.ICopyPasteUtility"),a.resolve("PowerPointWebEditor.IApplicationSettings").TPj,a.resolve("PowerPointWebEditor.IApplicationSettings").wRj,a.resolve("PowerPoint.IBrowserHelperManager"),a.resolve("PowerPointWebEditor.IPictureUploader"),a.resolve("PowerPointWebEditor.IClipboardTelemetry")),new Qx(a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IPasteHandlerUtil")),
new Xz(a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IPasteHandlerUtil"),u.AFrameworkApplication.LQ),new HE(a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IPasteHandlerUtil"),a.resolve("PowerPointWebEditor.IClipboardHelper"))],a.resolve("PowerPointWebEditor.IInputHandlerManager"),a.resolve("PowerPointWebEditor.IErrorHandler"),a.resolve("Common.IBrowserUtils"),
a.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),a.resolve("PowerPointWebEditor.IClipboardHelper"),a.resolve("PowerPointWebEditor.ICopyPasteUtility"),a.resolve("Common.App.ImageProcessor.IImageProcessor"),a.resolve("PowerPointWebEditor.IClipServiceManager"),a.resolve("Box4.IClipboardDataHelper"),a.resolve("PowerPointWebEditor.ISlideReader"),a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.IClipboardTelemetry"),a.resolve("PowerPointWebEditor.IOfflineModalCallout"),
a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.ICalloutNotificationAdapter")));a.register(325,"PowerPointWebEditor.ICopyPasteUtility").ma().oa(()=>new Aq.a(a.resolve("PowerPointWebEditor.IGraphTransactionHelper"),a.resolve("PowerPointWebEditor.IShapeEditor"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.IGraphHotColdManager"),a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IApplicationSettings"),
a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.IClipboardTelemetry"),a.resolve("PowerPointWebEditor.IPresentationReader")));a.register(326,"PowerPointWebEditor.IPasteHandlerUtil").ma().oa(()=>new XN);a.register(327,"PowerPointWebEditor.IClipboardHelper").ma().oa(()=>new lE.ClipboardHelper(a.resolve("PowerPointWebEditor.IInternalClipboard"),b.MSa().nk||mp.a.JIh,a.resolve("Common.IAppSettingsManager").Ha("RedisCacheServiceEnabledDatacenters"),a.resolve("Common.IAppSettingsManager").Fc("ClipServiceItemExpireTimeInMinutes",
60),a.resolve("Common.IAppSettingsManager").ka("PptEditingSlideCopyAsImageUrlEnabled"),a.resolve("PowerPointWebEditor.IClipboardTelemetry")));a.register(328,"PowerPointWebEditor.IClipServiceManager").ma().oa(()=>new ON(b.MSa(),a.resolve("PowerPointWebEditor.IClipboardTelemetry")));a.register(329,"Box4.TableEditors.ITableStylePreviewGenerator").ma().oa(()=>new Bq(a.resolve("Box4.Styles.ITableStyleReader"),a.resolve("PowerPointWebEditor.ITableStyleReaderHelper"),a.resolve("PowerPointWebEditor.DataModel.IHierarchyHelper"),
a.resolve("PowerPointWebEditor.ITableStyleGalleryManager"),Qz.hJf,c=>new JD(c,a.resolve("PowerPointWebEditor.ITableStyleResolver")),c=>new HD(c),a.resolve("PowerPointWebEditor.IApplicationSettings").X$));a.register(330,"Box4.TableEditors.ITableStyleRibbonControls").ma().oa(()=>new yN(a.resolve("PowerPointWebEditor.IPPTTableStyleReader"),a.resolve("PowerPointWebEditor.ISlideReader"),a.resolve("PowerPoint.IPathManager"),a.resolve("PowerPointWebEditor.ITableStyleGalleryManager"),a.resolve("Box4.TableEditors.ITableStylePreviewGenerator")));
a.register(331,"Common.App.ImageProcessor.IImageProcessor").ma().oa(()=>new bM(a.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder")));a.register(332,"PowerPointWebEditor.IPPTFileReaderHelper").ma().oa(()=>new yO);a.register(333,"Box4.Actors.IFormattingViewOperationFinishedStageProcessor").ma().oa(()=>new $z(a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("Box4.IPageView"),a.resolve("PowerPointWebEditor.IShapeReader")));a.register(334,"PowerPointWebEditor.ILocalImageViewFactory").ma().oa(()=>
new nO(a.resolve("PowerPointWebEditor.IFileApiHelper"),a.resolve("PowerPointWebEditor.IApplicationSettings").qab));a.register(335,"PowerPointWebEditor.IShapeProgressIndicatorViewFactory").ma().oa(()=>new pO);a.register(336,"PPTe.IColorPickerBuilderFactory").ma().oa(()=>new NQ.a);a.register(337,"PowerPointWebEditor.IFileApiHelper").ma().oa(()=>new xO);a.register(338,"PowerPointWebEditor.IInsertImageHelper").ma().oa(()=>new OM(a.resolve("PowerPointWebEditor.IPPTUnitConversion"),a.resolve("PowerPointWebEditor.IPresentationReader")));
a.register(iE,"Box4.Actors.FormatPainter").as("Box4.IFormatPainter").ma().oa(()=>new iE(a.resolve("Box4.Styles.IStyleEditor"),a.resolve("Box4.IInsertionPointFormatting"),a.resolve("Box4.IFormattingEditor"),a.resolve("Box4.IParagraphEditor"),a.resolve("Box4.IParagraphReader"),a.resolve("Box4.List.IListEditor"),a.resolve("Box4.List.IListReader"),a.resolve("Box4.ICharacterPropertiesEditor"),Dc.a.instance,a.rb("Box4.IFeatureHelper"),a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,a.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,
a.resolve("Box4.TextFormattingHelper")));a.register(339,"PowerPointWebEditor.IFormatPainter").ma().oa(()=>new jO(a.resolve("Common.IActionManagerExtended"),a.resolve("Box4.Graph.IGraphInstance").Ad(10),a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),a.resolve("PowerPointWebEditor.ViewCore.IFormatPainterContext"),a.resolve("PowerPointWebEditor.IApplicationSettings").pptTextFormatPainterIsEnabled));a.register(340,"PPTe.IResourceViewElementResolver").ma().oa(()=>new NN(b.MSa(),
Fc.App.webServiceBase));a.register(341,"PowerPointWebEditor.IOfflineModalCallout").ma().oa(()=>new kO(a.resolve("Box4.IAppFrame")));a.register(342,"PowerPointWebEditor.IPPTOfflineManager").ma().oa(()=>new eO(a.resolve("PowerPointWebEditor.Core.INetworkHealthManager"),a.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.IOfflineModalCallout"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.IStatusBarUser"),
a.resolve("PowerPointWebEditor.IGraphHotColdManager"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager")));a.register(343,"PowerPointWebEditor.IClipboardTelemetry").ma().oa(()=>new mu.a(a.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),a.resolve("Box4.IClipboardDataHelper"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),a.resolve("Box4.Graph.IGraphInstance").Ad(8),a.resolve("Box4.Graph.IGraphInstance").Ad(10),
a.resolve("Box4.Graph.IGraphInstance").Ad(12),a.resolve("Box4.Graph.IGraphInstance").Ad(60),a.resolve("Box4.Graph.IGraphInstance").Ad(7),a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.ICalloutNotificationAdapter"),a.resolve("PowerPointWebEditor.Core.IPasteProgressManager")))}init(){const a=this.K;var b=a.resolve("Common.AFrameworkApplication");const c=b.BS;var h=b.rr;const m=c.od;var y=a.resolve("PowerPointWebEditor.CoreExt.ICoreExtEventSource"),G=h.Qgb;const U=a.resolve("Common.IActionManagerExtended"),
ja=a.resolve("PowerPointWebEditor.IFrameContext"),va=a.resolve("PowerPointWebEditor.IFocusManager"),Ta=a.resolve("PowerPointWebEditor.IFormatPainter"),fb=a.resolve("PowerPointWebEditor.CoauthManager"),Db=a.resolve("PowerPointWebEditor.ISessionLifetimeManager"),gc=vb.a.instance.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),hc=vb.a.instance.resolve("PowerPointWebEditor.IDialogManager"),Gc=vb.a.instance.resolve("PowerPointWebEditor.IPptSelectionManager"),Pc=vb.a.instance.resolve("Box4.ISelectionManager"),
yc=vb.a.instance.Ja("Box4.IExternalSelectionManager"),Vd=vb.a.instance.resolve("PowerPoint.IPathManager");var De=vb.a.instance.resolve("PowerPointWebEditor.IInternalClipboard");const Wd=h.Jd,Ve=vb.a.instance.resolve("PowerPointWebEditor.IRibbonChangeManager");b=vb.a.instance.resolve("PowerPointWebEditor.ISaveBlockingUI");const $e=vb.a.instance.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView"),Qf=vb.a.instance.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoManager"),lg=vb.a.instance.resolve("PowerPointWebEditor.INotesView");
var Hg=vb.a.instance.resolve("Box4.IFormatPainter");const Qg=a.resolve("PowerPointWebEditor.IRevisionMetadataHelper"),Sf=a.resolve("Common.Transaction.ITransactionFactory"),sh=a.resolve("PowerPointWebEditor.IPresentationReader"),Xg=a.resolve("PowerPointWebEditor.IShapeReader"),ni=a.resolve("PowerPointWebEditor.Graph.ITableReader"),Ri=a.resolve("PowerPointWebEditor.Graph.ITableColumnReader"),uj=a.resolve("PowerPointWebEditor.Graph.ITableRowReader");var dj=a.resolve("PowerPointWebEditor.ITableEditor");
const ej=vb.a.instance.resolve("PowerPointWebEditor.IShapeEditor"),Ei=vb.a.instance.resolve("PowerPointWebEditor.IGraphTransactionHelper"),Dk=a.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),vj=a.resolve("PowerPointWebEditor.Storage.ISaveAndCloseHandler"),tk=a.resolve("PowerPointWebEditor.Graph.IGraphNodeContextHelper"),Fl=vb.a.instance.resolve("Box4.List.IListReader"),rl=a.resolve("Box4.Graph.IGraphIteratorFactory"),Gl=a.resolve("PPTe.IColorPickerBuilderFactory"),Vj=a.resolve("PowerPointWebEditor.View.IPPTPageView");
this.xla=vb.a.instance.resolve("PowerPointWebEditor.ICutCopyManager");this.JC=vb.a.instance.resolve("PowerPointWebEditor.IPasteManager");const Ek=vb.a.instance.resolve("PowerPointWebEditor.IPresentationResourcesManager"),Wj=vb.a.instance.resolve("PPTe.IResourceViewElementResolver");vb.a.instance.resolve("PowerPointWebEditor.ILocalImageViewFactory");vb.a.instance.resolve("PowerPointWebEditor.IShapeProgressIndicatorViewFactory");const fk=vb.a.instance.resolve("PowerPointWebEditor.IGraphHotColdManager"),
Fj=vb.a.instance.resolve("PowerPointWebEditor.ShapeEdit.IShapeCountValidator"),sl=a.resolve("Common.Utils.IHighContrastDetector"),dh=vb.a.instance.resolve("PowerPointWebEditor.ISubtitleContext"),Rl=a.resolve("PowerPointWebEditor.IRibbonUser"),lm=a.resolve("Box4.CloudFontService"),Fk=a.resolve("Box4.CustomFontService");this.Rze=new Si(U,gc,va,ja.LCID,Gc,Sf,Ei,Wd,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),sh,new iO(vb.a.instance.resolve("PowerPointWebEditor.IFocusManager"),vb.a.instance.resolve("PowerPointWebEditor.IPresentationReader")),
Ek,m,Wj);this.sue=new Hj(Ei,U,va,Gc,gc,Vj,a.resolve("PowerPointWebEditor.ICopyPasteUtility"),a.resolve("Box4.Graph.IGraphInstance").Ad(7),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),Ve,ej,Fj,a.resolve("PowerPointWebEditor.IApplicationSettings").hNj,a.resolve("PowerPointWebEditor.ShapeSVG.IShapeSVGDependencyLoader"),a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.IPPTUnitConversion"),a.resolve("PowerPointWebEditor.IInsertShapeOverlayViewStateManager"),
a.Ja("PowerPointWebEditor.IInsertShapeOverlayViewElement"),a.resolve("PowerPointWebEditor.IApplicationSettings").Yxb,m.qFj,a.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),a.resolve("PowerPointWebEditor.View.IViewEventSource"),a.resolve("PowerPointWebEditor.IGraphHotColdManager"),a.resolve("Box4.Graph.IGraphInstance").Ad(10));this.rue=new bA(Ei,U,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),gc,Vj,a.resolve("Box4.Graph.IGraphInstance").Ad(7),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager").presentation,
Ve,ej,Fj,a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.IPPTUnitConversion"),a.resolve("PowerPointWebEditor.IInkDryStore"));De=new tM(U,va,a.resolve("PowerPointWebEditor.IPptSelectionManager"),Wd,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Sf,a.resolve("PowerPointWebEditor.IGraphTransactionHelper"),a.resolve("PowerPointWebEditor.IApplicationSettings"),De,gc,this.xla,this.JC,a.resolve("PowerPointWebEditor.IDesignModeManager").dCa,a.resolve("PowerPointWebEditor.ICopyPasteUtility"),
sh,ej,Vj,a.resolve("PowerPointWebEditor.IWarningDialog"),(mg,eh,jh,xd,Ne,le,yf,Eg,Fi)=>new WM(mg,eh,jh,xd,Ne,le,yf,Eg,Fi),Fj,a.resolve("Box4.IClipboardDataHelper"),a.resolve("PowerPointWebEditor.ISystemClipboard"),a.resolve("PowerPointWebEditor.IInsertImageHelper"),a.resolve("Common.ITaskManager"),a.resolve("PowerPointWebEditor.IInsertOnlineVideoDialogHelper"),a.resolve("PowerPointWebEditor.IClipboardTelemetry"),a.resolve("PowerPointWebEditor.IDeferredContentManager"));const Sl=new fi(U,va,Sf,G,Ta,
gc,a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.IBox4ColorHelper"),a.resolve("PowerPointWebEditor.Graph.GraphHierarchyHelper"),a.resolve("PowerPointWebEditor.ShapeEdit.ISVGIconLocalEditor"),a.resolve("PowerPointWebEditor.IJSanityHelper"),a.resolve("PowerPointWebEditor.IShapeReader"),Hg,Qg,Wd,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.IApplicationSettings"),sl,a.resolve("PowerPointWebEditor.Graph.ITableReader"),
a.resolve("PowerPointWebEditor.IZoomContext"),a.resolve("Box4.Styles.ITableStyleReader"),a.resolve("Box4.IPageView").Ma),Xi=new VM(U,gc,ja,Sf,Gc,a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.Graph.GraphHierarchyHelper"));G=new FM(U,Sf,Gc,a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.IShapeEditor"),a.resolve("PowerPointWebEditor.View.IPPTPageView"),
a.resolve("PowerPointWebEditor.IPPTUnitConversion"),ja,a.resolve("PowerPointWebEditor.IApplicationSettings"));y=[new jM(U,m,y,Gc,Sf,gc),De,new Rx(U,m,u.AFrameworkApplication.fa.ka("UseToastForDeferredBlobsEnabled"),a.resolve("PowerPointWebEditor.IClipServiceManager"),va,gc,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Sf,Dk,Wd,a.resolve("PowerPointWebEditor.IClipboardHelper"),a.resolve("PowerPointWebEditor.ICopyPasteUtility"),Vj,Fj,a.resolve("PowerPointWebEditor.IPptSelectionManager"),
a.resolve("PowerPointWebEditor.ICcpEventNotifier"),a.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView"),fk,a.resolve("Box4.IPasteFloatieEventNotifier"),a.resolve("PowerPointWebEditor.IPresentationReader"),a.resolve("PowerPointWebEditor.IPasteFloatieHelper"),a.resolve("PowerPointWebEditor.PasteFromFloatieArgs"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventSource"),a.resolve("PowerPointWebEditor.IClipboardTelemetry"),this.JC,a.resolve("PowerPointWebEditor.Core.IPasteProgressManager"),
a.resolve("PowerPointWebEditor.IPastedDataUploader"),a.resolve("PowerPointWebEditor.ICalloutNotificationAdapter")),new wM(U,vb.a.instance.resolve("PowerPointWebEditor.IDesignModeManager"),hc,a.re("PowerPointWebEditor.IContextMenuUser"),Wd,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),va,a.resolve("PowerPointWebEditor.IOfflineModalCallout"),a.resolve("PowerPointWebEditor.View.IPPTPageView"),
m.pptContextMenuOnSelectionFixIsEnabled,m.Ks),new xM(U,Gc,a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.View.IAccCheckPane"),m.powerPointGraphicToolTabIsEnabled,m.Aah,m.SHb),new DN(U,m,kv.a.vwb,rl,a.resolve("Box4.IParagraphReader")),new EN(ku.instance),this.sue,this.rue,G,new Tx(U,gc,va,ja.notesPane,lg,Wd,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),ja,a.resolve("PowerPointWebEditor.IActiveSlideViewManager"),h,vb.a.instance.resolve("PowerPointWebEditor.ISlideCacheManager"),
a.resolve("PowerPointWebEditor.View.IPPTPageView")),new UM(U,a.resolve("PowerPointWebEditor.IPPTOfflineManager"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.IStatusBarUser")),Xi,new bN(U,ja,Rl,va,a.resolve("PowerPointWebEditor.ICUIManager"),a.resolve("PowerPointWebEditor.View.IViewEventNotifier"),a.resolve("Common.IRibbonExternal"),a.resolve("Common.IAppSettingsManager").ka("AltForKeytipEnabled"),a.resolve("PowerPointWebEditor.IApplicationSettings").qT),new eN(U,
gc,va,hc,Wd,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),Ta,a.resolve("PowerPointWebEditor.IPresentationReader"),a.resolve("PowerPointWebEditor.IAriaManager"),a.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView"),m.tC,a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventNotifier"),a.resolve("PowerPointWebEditor.IShapeReader"),m.podsNewThumbnailVisibleRangeFetchExperience,a.resolve("PowerPointWebEditor.IVideoManagerStore"),
m.VP,a.resolve("PowerPointWebEditor.View.IViewEventSource"),m.u6a),Sl,new jN(U,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),gc,Sf,va,Ek,Wj,Gc,Xg,a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.resolve("PowerPointWebEditor.IApplicationSettings").powerPointGraphicToolTabIsEnabled,a.resolve("PowerPointWebEditor.Core.ICoreEventHandler")),new Ov(Ei,U,va,gc,a.resolve("PowerPointWebEditor.IFontUtilsManager"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("Box4.IFormattingEditor"),
Xg,!!lm&&lm.isEnabled,!!Fk&&Fk.isEnabled,a.resolve("PowerPointWebEditor.IApplicationSettings").podsHtmlTextForEmbeddedFontsIsEnabled,a.resolve("PowerPointWebEditor.Graph.ITableReader"),a.resolve("PowerPointWebEditor.IApplicationSettings")),new kN(Ei,U,va,gc,Gc,Xg,a.resolve("PowerPointWebEditor.Graph.IPPTLineSpacingHelper"),a.resolve("PowerPointWebEditor.IPptListMarkersLoader"),a.resolve("Box4.Graph.IGraphIteratorFactory"),Sf,m.Hje,a.resolve("PowerPointWebEditor.Graph.ITableReader"),a.resolve("Box4.List.IListReader"),
a.resolve("PowerPointWebEditor.IApplicationSettings")),this.Rze,new lN(U,gc,Sf,Ei,va,Gc,Wd,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),sh,m,a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventSource"),a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers")),new mN(U,hc,va,gc,Ei,Wd,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),sh,$e,(mg,eh)=>new kR.a(mg,eh),a.resolve("PowerPointWebEditor.IPptSelectionManager"),
m.tC,m.Ije),new pN(U,gc,Gc,Sf,va,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Ve,sh,ej,Vj,Fj,a.resolve("PowerPointWebEditor.IShapeReader")),new rN(()=>Qf,new sN(Pc,kv.a.vwb,a.resolve("Box4.IContextSetEditor")),yc,m),new zN(U,gc,m,va,Gc,Qf,a.Ja("PowerPointWebEditor.IAppForOfficeManager"),a.re("PowerPointWebEditor.IAppforOfficeClassFactory"),Vj,a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventNotifier"),a.resolve("PowerPointWebEditor.IApplicationSettings").powerPointEditSmartArtTextPaneIsEnabled,
a.resolve("PowerPointWebEditor.IPptTableDragSelectionHelper"),a.resolve("PowerPointWebEditor.Graph.ITableReader"),a.resolve("PowerPointWebEditor.ISlidelessPane"),a.Ja("PowerPointWebEditor.ITextLayoutManager"),a.resolve("PowerPointWebEditor.WebSocketFrontDoor.IWebSocketFrontDoor"),a.Ja("PowerPointWebEditor.IAudioManagerStore")),new fA(U,Gc,vj,va,b,Db,vb.a.instance.resolve("PowerPointWebEditor.IApplicationSettings")),new MN(U,a.Ja("PowerPointWebEditor.ICommentsPane"),va,a.resolve("Common.IF6Manager"),
Gc,vj,gc,Vd,Wd,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),sh,a.resolve("PowerPointWebEditor.IWindowUtils"),u.AFrameworkApplication.fa,m,b,c.MSa(),Db,$e,vb.a.instance.resolve("PowerPointWebEditor.ISlideshowManager"),vb.a.instance.resolve("Box4.Graph.IGraphInstance").Ad(7),vb.a.instance.resolve("PowerPointWebEditor.IInboundHelper"),vb.a.instance.resolve("Common.ITaskManager"),u.AFrameworkApplication.Je,vb.a.instance.resolve("PowerPointWebEditor.IJsonpHelperManager"),vb.a.instance.resolve("PowerPointWebEditor.View.IViewEventSource"),
a.Ja("PowerPointWeb.Comments.ICommentFrame"),a.Ja("PowerPointWebEditor.PodsPops.IPodSeamlessFailoverManager"),dh,vb.a.instance.Ja("PowerPointLive.ILivePresenter"),a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IStatusBarUser"),h,a.resolve("PowerPointWebEditor.ITaskPaneManager"),a.resolve("PowerPointWebEditor.IDeferredContentManager"))];dj=new ru(U,rl,gc,va,Fl,Xg,ni,uj,Ri,ej,dj,m,Sf,Wd,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Gc,Fj,a.resolve("PowerPointWebEditor.ITableSelectionAdapter"),
a.resolve("PowerPointWebEditor.ITableMergeSplitEditor"),a.resolve("PowerPointWebEditor.ICellIteratorFactory"),a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IPPTUnitConversion"),a.resolve("PowerPointWebEditor.IRibbonChangeManager"),a.resolve("PowerPointWebEditor.ITableMetrics"),a.resolve("PowerPointWebEditor.IApplicationSettings").pptIsInsertMultiRowColumnEnabled,Rl,a.resolve("Box4.Styles.ITableStyleReader"));y.push(new ou(U,Gc,va,Fl,a.resolve("Box4.ILineSpacingHelper"),
Sf,tk,rl,Fc.App.zLa.HKc(12),Fc.App.zLa.HKc(10),Xg,a.resolve("Box4.IContextSetEditor"),a.resolve("PowerPointWebEditor.IPptListMarkersLoader"),m.Hje,m.isPromoteDemoteOnParagraphEnabled,Gl,m.DZc,a.resolve("PowerPointWebEditor.Graph.ITableReader"),a.resolve("PowerPointWebEditor.IApplicationSettings").pptTextFormatPainterIsEnabled,a.resolve("PowerPointWebEditor.ITableEditor"),Hg,h,Wd,a.resolve("PowerPointWebEditor.ViewCore.IFormatPainterContext"),a.resolve("Box4.IInsertionPointFormatting"),Qg,a.resolve("Box4.IParagraphIndentationReader"),
a.resolve("Box4.IParagraphEditor"),a.resolve("PowerPointWebEditor.IApplicationSettings").Iib));y.push(dj);h=new DE(U,va,Xg,Ei,gc,Gc,a.resolve("Box4.IInsertionPointFormatting"),a.resolve("Box4.IParagraphReader"));y.push(h);m.fWk&&y.push(new ZM(U,va,a.resolve("PowerPointWebEditor.IPresentationReader")));m.eDk&&y.push(new uM(U,a.resolve("PowerPointWebEditor.ICoauthStateSetter"),m));(m.fNb||m.Ekb)&&y.push(new Sv(U,m,Sf,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Gc,ni,a.resolve("PowerPointWebEditor.IFunctionThrottlerFactory"),
a.resolve("PowerPointWebEditor.View.IPPTPageView")));m.w3h&&y.push(new hM(Gc,u.AFrameworkApplication.fa,m,Object(F.a)(Lz.App.y5a,Lz.App.y5a.HVf,"forceUpdateRibbonControls")));m.qT&&(h=null,Object(Rd.a)("EnableFeedbackInChatPPTMode")&&(h=this.K.resolve("Common.App.ICustomerFeedbackUiWrapper"),h=new BO(h)),Hg=!1,Object(Rd.a)("NewSettingsForChatPPT")&&(Hg=a.resolve("PowerPointWebEditor.IApplicationSettings").NSj),y.push(new zO(this.K.resolve("Common.IActionManagerExtended"),this.K.Ja("PowerPointWebEditor.IAppForOfficeManager"),
a.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),a.resolve("PowerPointWebEditor.View.IViewEventSource"),h,a.resolve("PowerPointWebEditor.IApplicationSettings").qT,Hg)));m.Eyh&&y.push(new CO(U));Rd.a("DataSyncModeOnStatusBar")&&"inner"===u.AFrameworkApplication.fa.Ha("Microsoft365Ring")&&y.push(new AO(U,m));for(const mg of y)mg.vb(),mg.De();vb.a.instance.Ja("PowerPointWebEditor.ISorterViewActorMain").execute(mg=>{mg.vb()});a.resolve("PowerPointWebEditor.IPPTProcessImageStrategy").ihi(new qO(a.resolve("Common.ITaskManager"),
a.resolve("Box4.IFileReaderHelperFactory"),a.resolve("Common.App.ImageProcessor.IImageProcessor"),a.resolve("PowerPointWebEditor.IApplicationSettings")));const xi=this;u.AFrameworkApplication.fa.jf(()=>{const mg=Uy.a(a),eh=[new LN(U,gc,Gc,va,Qf,m.wOj,fb,Wd.Cf,a.Ja("PowerpointPresence.IPresenceManager"),a.resolve("PowerPointWebEditor.ITablePartialEditController"),a.resolve("PowerPointWebEditor.IActionNameResolver"),a.resolve("PowerPointWebEditor.IGroupUngroupUndoRedoActionController"),a.resolve("PowerPointWebEditor.IApplicationSettings"),
a.resolve("PowerPointWebEditor.View.IViewEventNotifier"))],jh=u.AFrameworkApplication.fa.ka("LiveSubtitlesEnabled");m.Pka&&jh&&eh.push(new Wx(U,a.resolve("PowerPointWebEditor.IPresentationReader"),a.resolve("PowerPointWebEditor.View.IViewEventSource"),dh));xi.Q9c=new cN(U,Ei,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("Box4.Graph.IGraphInstance").Ad(7),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventSource"),a.resolve("PowerPointWebEditor.IPPTWorkspace"),a.resolve("PowerPointWebEditor.IPresentationReader"),
Gc,a.resolve("PowerPointWebEditor.IApplicationSettings").Ks,a.resolve("PowerPointWebEditor.IApplicationSettings").tC);eh.push(xi.Q9c);eh.push(new gN(U,Gc,Vj,a.resolve("PowerPointWebEditor.IApplicationSettings").cka));eh.push(new fN(mg,Gc,a.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),U,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),va,a.resolve("PowerPointWebEditor.View.ISelectionPane"),Sl,Xi,a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),
a.resolve("PowerPointWebEditor.View.IViewEventSource"),a.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),ja,Xg,a.resolve("Box4.IPageView").Ma,a.resolve("Common.Transaction.ITransactionFactory")));eh.push(new zM(mg,Gc,a.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),U,va,a.resolve("PowerPointWebEditor.View.IFormatShapePane"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),a.resolve("PowerPointWebEditor.View.IViewEventSource"),
a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IPPTUnitConversion"),a.resolve("PowerPointWebEditor.IPPTWorkspace"),Xg,m.zZi,m.Oal,m.cka,a.resolve("PowerPointWebEditor.IImageViewManager")));eh.push(new BM(Gc,a.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),U,va,a.resolve("PowerPointWebEditor.View.IFormatTablePane"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),a.resolve("PowerPointWebEditor.View.IViewEventSource"),
a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IPPTUnitConversion"),a.resolve("PowerPointWebEditor.IPPTWorkspace"),a.resolve("Common.IDynamicScriptLoaderProvider").Pw,ni,uj,Ri));m.wig?eh.push(new MM(mg,Gc,a.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),U,Wd,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),va,a.resolve("PowerPointWebEditor.View.IHeaderFooterPane"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),
a.resolve("PowerPointWebEditor.View.IViewEventSource"),Sf,m.PJe)):eh.push(new JM(mg,Gc,a.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),U,Wd,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),va,a.resolve("PowerPointWebEditor.View.IHeaderFooterPane"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),a.resolve("PowerPointWebEditor.View.IViewEventSource"),Sf,m.PJe));eh.push(new vM(mg,U,va,Wd));m.powerPointSmartLookupIsEnabled&&
eh.push(new NM(Ei,U,Wd,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),gc));m.bDk&&eh.push(new mM(a.resolve("Common.IDynamicScriptLoaderProvider").Pw,U,a.resolve("PowerPointWebEditor.ISubtitleContext"),a.resolve("PowerPointWebEditor.View.IFocusManagerHelper"),a.resolve("PowerPointWebEditor.Core.IAudioSettingsContext")));eh.push(new kM(U,Gc,va,Sf,a.Ja("PowerPointWebEditor.IAudioManagerStore"),m.VP,a.resolve("PowerPointWebEditor.View.IViewEventSource"),a.resolve("PowerPointWebEditor.Core.IUnifiedAppState")));
eh.push(new gM(U,Gc,Sf,Wd,a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventSource"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),a.resolve("PowerPointWebEditor.IErrorHandler"),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),m.Z2h,m.CDl,()=>this.K.resolve("PowerPointWebEditor.IMediaUploader")));m.hDk&&eh.push(new TM(a.resolve("Common.IDynamicScriptLoaderProvider").Pw,m.fDk,m.gDk,U,gc,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
Gc,Fj));m.pptoCaptionDiscoverabilityPaneEnabled&&eh.push(new Lv(a.resolve("Common.IDynamicScriptLoaderProvider").Pw,U,a.resolve("PowerPointWebEditor.View.IViewEventSource"),a.resolve("PowerPointWebEditor.IPresentationReader"),a.resolve("PowerPoint.IPathManager"),a.resolve("PowerPointWebEditor.View.IFocusManagerHelper"),a.resolve("PowerPointWebEditor.ISubtitleContext"),a.resolve("PowerPointWebEditor.Core.IAudioSettingsContext"),a.resolve("PowerPointWebEditor.ISlideshowFrame"),m.cDk));xi.Wug=new yM(U,
a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Sf,a.resolve("Box4.Graph.IGraphInstance").Ad(82));eh.push(xi.Wug);for(const xd of eh)xd.vb(),xd.De();dh.b3b=jh});(new YM(c.QG(),c.f6d(),b,vj,Gc,a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.resolve("PowerPointWebEditor.IActionNameResolver"))).vb();u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.hb.rke&&IQ()}dispose(){this.xla.dispose();this.JC.dispose();this.Rze.dispose();
this.sue.dispose();this.rue.dispose();this.Q9c&&this.Q9c.dispose();const a=this.K.Ja("PowerPointWebEditor.IDesignerManager").instance;a&&a.dispose()}}Object(n.a)(DO,"ActorPackage",null,[2,3]);class EO{constructor(a,b,c,h,m,y,G,U,ja,va){this.rH=!1;this.Vb=a;this.ua=b;this.Lg=c;this.mH=h;this.Sb=m;this.Bv=y;this.zb=G;this.Eva=U;this.eTg=ja;this.Oc=va;this.tye=[0,1,2,3];this.S4=new Nd.a;for(const Ta of this.tye)this.S4.$(Ta,[]);this.S4.$(4,[]);this.Lg.kI(Object(F.a)(this,this.sB,"onActiveSlideChanged"));
this.Eva.ik(Object(F.a)(this,this.led,"onMainMastersLoaded"));this.eTg.mia(Object(F.a)(this,this.WGe,"onSlideLoaded"));this.eTg.ik(Object(F.a)(this,this.rna,"onSlidePropertyChanged"));this.Oc.GA(Object(F.a)(this,this.kM,"onSessionClosed"));this.Oc.rPa(Object(F.a)(this,this.L0,"onSessionRehydrating"));this.Oc.WB(Object(F.a)(this,this.Bo,"onSessionRehydrated"));this.APg=new Ex(Object(F.a)(this,this.ADk,"prefetchSlideMasterNode"),250,15E3,8E3,500,"slide master node",this.zb,3);this.zPg=new Ex(Object(F.a)(this,
this.zDk,"prefetchSlideMasterImage"),250,6E4,8E3,500,"slide master image",this.zb,3);this.sB(null,null)}sB(){this.Y_d()}Y_d(){const a=this.ua.Ba;a&&8===a.type&&a.Sa(X.a.hj)&&a.Sa(X.a.Bn)&&this.Hul(a.hj,a.Bn)}ADk(){if(!this.rH){var a=this.S4.ga(0),b=this.S4.ga(1);if(0<a.length){const c=a.length-1,h=a[c];this.fTj(h.first,h.second)&&(Array.removeAt(a,c),Array.add(b,h),this.APg.krd(),this.Bv.yDk(h.first,h.second))}}}zDk(){if(!this.rH){this.ksd(1,2,c=>!!this.Sb.t8a(c.first,c.second));var a=this.S4.ga(2);
if(0<a.length){const c=a[0];var b=this.Sb.t8a(c.first,c.second);b&&this.TVe(b)?(b=b.Ixb(new cr.a(b.oq,b.Wk)),this.zPg.krd(),Array.removeAt(a,0),Array.add(this.S4.ga(3),c),this.mH.$ub(b,!0,()=>{this.ksd(3,4,h=>!this.TVe(this.Sb.t8a(h.first,h.second)));this.zPg.grd()})):(Array.removeAt(a,0),Array.add(this.S4.ga(4),c))}this.ksd(3,4,c=>!this.TVe(this.Sb.t8a(c.first,c.second)))}}vDf(){for(const a of this.tye)Array.clear(this.S4.ga(a));Array.clear(this.S4.ga(4))}WGe(a,b){(a=Object(ua.a)(116,b.node))&&a.aE&&
this.fjc(a)}rna(a,b){a=b.property;b.node&&a===X.a.Bn&&b.node===this.ua.Ba&&this.Y_d()}fjc(a){if(this.cTj(a)&&a){const b=a.hj,c=a.Bn;b&&c&&(this.ksd(1,2,h=>h.first===b&&h.second===c),this.APg.grd())}}led(a,b){a=b.property;if(a===X.a.kFb||a===X.a.xY)this.vDf(),this.Y_d()}kM(){this.rH=!0}L0(){this.vDf()}Bo(){this.rH=!1}Hul(a,b){this.dTj(a,b)||this.eTj(a,b)||Array.add(this.S4.ga(0),new Vw.a(a,b))}eTj(a,b){for(const c of this.tye)for(const h of this.S4.ga(c))if(h.first===a&&h.second===b)return!0;return!1}dTj(a,
b){for(const c of this.S4.ga(4))if(c.first===a&&c.second===b)return!0;return!1}ksd(a,b,c){a=this.S4.ga(a);b=this.S4.ga(b);for(let h=a.length-1;0<=h;--h)if(c(a[h])){const m=a[h];Array.removeAt(a,h);Array.add(b,m)}}TVe(a){if(!a)return!1;a=a.Ixb(new cr.a(a.oq,a.Wk));if(null===a)return!1;for(const b of a)if(!this.mH.PVc.bld(b).data)return!0;return!1}cTj(a){const b=this.Vb.Cf.sa(X.a.fwh,null);if(!b)return!1;for(let c=0;c<b.length;++c)if(b[c].equals(a.id))return!0;return!1}fTj(a,b){var c=this.Sb.xI();if(!c)return!1;
for(let h=0;h<c.length;++h)if(c[h].Id===a){a=c[h].ContentMasters;if(!a)break;for(c=0;c<a.length;++c)if(a[c].Id===b)return!0;break}return!1}}Object(n.a)(EO,"SlideMasterPrefetchManager",null,[191]);var oR=d(956);class FO{constructor(a,b,c,h,m,y,G){this.Db=!1;this.sX=null;if(!b)throw Error.argumentNull("appFrame");if(!h)throw Error.argumentNull("viewElementEventSource");if(!y)throw Error.argumentNull("taskManager");if(!m)throw Error.argumentNull("viewElementEventHandlers");this.zb=y;this.Fr=a;this.Qb=
b;this.Zt=c;this.oy=h;this.qd=m;this.xzg=G;this.Sak=new He.a(0,1,0,Object(F.a)(this,this.uVk,"renderCommentShimmerHandler"),90,"115")}get isVisible(){return this.Db}ghl(){if(!this.Db&&this.Fr&&this.Fr.xa){this.sX=this.Uii();this.xzg||this.Fr.xa.appendChild(this.sX);this.Fr.setVisibility(!0);this.xzg&&this.qd.jsf(Object(F.a)(this,this.udd,"onCommentContainersChanged"));var a=new oR.a(!0);this.oy.udh(a);this.Qb.bgb(1);this.Db=!0}}udd(){this.Qb.OFc(Object(F.a)(this,this.Gih,"renderCommentShimmerOnSlideResize"));
this.qd.HTk(Object(F.a)(this,this.udd,"onCommentContainersChanged"))}Gih(){this.zb.Eb(this.Sak);this.Qb.jkd(Object(F.a)(this,this.Gih,"renderCommentShimmerOnSlideResize"))}uVk(){!this.sX||this.gSf()?Ba.a.J(522724993,805,10,"Either CommentShimmerView is null or the Element is already added to DOM"):this.Fr.xa.appendChild(this.sX)}Y$f(){if(this.Db&&this.Fr&&this.Fr.xa&&this.gSf()){this.Fr.xa.removeChild(this.sX);this.sX=null;this.Db=!1;var a={};a.commentShimmerHideTime=(new Date).getTime();Ba.a.J(523352018,
809,50,Da.a.toJSON(a))}}FUi(){this.Db&&this.Fr&&this.Fr.xa&&(this.sX.className+=" CommentShimmerFadeAwayStyles",window.setTimeout(Object(F.a)(this,this.Y$f,"hideShimmerUX"),600))}Uii(){const a=document.createElement("div");a.className="CommentShimmerFrameStyles";for(let b=0;2>b;b++)a.appendChild(this.Vii());return a}Vii(){const a=document.createElement("div");a.className=this.Zt?"CommentShimmerContainerRtlStyles":"CommentShimmerContainerStyles";a.id="CommentShimmerContainer";const b=document.createElement("div");
b.className="CommentShimmerPersonaStyles";const c=document.createElement("div");c.className="CommentShimmerHeaderStyles";const h=document.createElement("div");h.className="CommentShimmerBodyDiv1Styles";const m=document.createElement("div");m.className="CommentShimmerBodyDiv2Styles";const y=document.createElement("div");y.className="CommentShimmerActionStyles";a.appendChild(b);a.appendChild(c);a.appendChild(h);a.appendChild(m);a.appendChild(y);return a}gSf(){return!!document.getElementById("CommentShimmerContainer")}}
Object(n.a)(FO,"CommentShimmerView",null,[192]);class ME{constructor(a,b){this.Qb=a;this.zwa=b;this.zwa.Osf(Object(F.a)(this,this.$mh,"scaleOnUIChanged"))}dispose(){this.zwa.lih(Object(F.a)(this,this.$mh,"scaleOnUIChanged"))}N$(){}M$(a){2===a.behavior&&(a=a.actionId,a!==M.a.S0&&a!==M.a.R0&&a!==M.a.Q0&&a!==M.a.una||this.updateCommandUI())}$mh(){this.updateCommandUI()}updateCommandUI(){this.Qb.updateCommandUI()}}Object(n.a)(ME,"UpdateCommandUIActionListener",null,[141,106]);class NE{constructor(){this.correlationId=
this.sessionId=this.wHd=null;this.actionId=0;this.rd=null}get Ff(){return this.wHd?this.wHd:""}set Ff(a){this.wHd=a}}Object(n.a)(NE,"AssistanceSearchVariableUrlParameterSet",null,[]);class ir{constructor(){this.zP=!1;this.yP=!0;this.ylf=this.CPb=null}get isInitialized(){return this.zP}initialize(a,b){const c=!!a&&!!b;c&&(this.CPb=a,this.ylf=b);this.zP=c;u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",
!1)||vb.a.instance.Ja("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").execute(h=>{h.o3("Enabled").then(m=>{this.yP=m;return null},()=>null)})}vb(a){a||(a=u.AFrameworkApplication.Ta);u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1)&&(this.yP=u.AFrameworkApplication.OE,vb.a.instance.Ja("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(b=>{b.isFeatureEnabled("mso_sendASmile",
!0).then(c=>{this.yP=u.AFrameworkApplication.OE&&c;(c=u.AFrameworkApplication.Aa)&&c.updateCommandUI();return null},()=>null)}));a.ya(H.a.mKb,he.a.frame,Object(F.a)(this,this.dhl,"showSearchResults"))}dhl(a,b,c,h,m){if(1===c)return u.AFrameworkApplication.fa.ka("IsFeedbackExperiencesAvailable")||(this.yP=!1),m&&"SourceControlId"in m&&(m=m.SourceControlId,("GiveFeedback"===m||"btnFeedback"===m||"btnFeedbackPane"===m||"PptEditingStatusBar.GiveFeedbackPane"===m||"GiveFeedbackPane"===m)&&!this.yP)?8:
rz.SessionStatusManager.instance.eka?8:32;ba.ULS.sendTraceTag(4761738,1302,50,"");Te.a.mark(4771);if(this.isInitialized){a=m.CommandValueId;b=m.SourceControlId;m=Object.assign(new NE,{actionId:H.a.mKb,rd:m});if(void 0!==a&&null!==a)m=ir.Xlj(a);else if(void 0!==b&&null!==b)switch(b){case "btnFeedback":case "btnFeedbackPane":case "PptEditingStatusBar.GiveFeedbackPane":case "GiveFeedbackPane":case "GiveFeedback":m.actionId=H.a.giveFeedback;break;case "btnContactSupport":case "ContactSupport":m.actionId=
H.a.gVd;break;case "btnShowTraining":case "Training":m.actionId=H.a.XBh;break;case "btnWhatsNew":case "WhatsNew":m.actionId=H.a.VIh}this.CPb.nfl(this.ylf,m);Te.a.mark(4772);return 32}Te.a.mark(4772);return 8}dispose(){this.CPb&&(this.CPb.dispose(),this.CPb=null)}static get instance(){ir.Ka||(ir.Ka=new ir);return ir.Ka}static Xlj(a){const b=new NE,c=a.indexOf("|");b.sessionId=a.substring(0,c);const h=a.indexOf("|",c+1);b.correlationId=a.substring(c+1,h);b.Ff=a.substr(h+1);return b}}ir.Ka=null;Object(n.a)(ir,
"AssistanceActor",null,[106]);class OE{constructor(){this.X5e=this.$a=this.rmb=null;this.yGd=!1}nfl(a,b){if(b.actionId!==H.a.giveFeedback||u.AFrameworkApplication.OE)if(this.yGd&&!u.AFrameworkApplication.nsa)this.rmb||(this.rmb=this.X5e()),this.rmb.em(a,b);else if(b.actionId===H.a.giveFeedback)this.Zel();else{a=a.UTc(b);b=null;try{ta.a.V8(a)&&(b=qd.a.un(a,"_blank","height=500,width=400,channelmode=no,directories=no,fullscreen=no,location=no,menubar=no,resizable=yes,scrollbars=yes,status=no,titlebar=yes,toolbar=no",
"AssistanceDisplayManager:HelpWindow"))}catch(c){throw ba.ULS.sendTraceTag(4543175,1302,10,"An exception has occured while trying to launch the Online Assistance window: "+c.message),c;}b?ba.ULS.sendTraceTag(4543177,1302,50,"Window.Open() returned a window when opened with URL {0}",a):ba.ULS.sendTraceTag(4543176,1302,15,"Window.Open() returned a null window when opened with URL {0} and help options {1}",a,"height=500,width=400,channelmode=no,directories=no,fullscreen=no,location=no,menubar=no,resizable=yes,scrollbars=yes,status=no,titlebar=yes,toolbar=no")}else ba.ULS.sendTraceTag(554295451,
356,15,"ShowFeedbackButton is false, but ShowContent got called, some feedback entry point is still visible")}dispose(){this.rmb&&(this.rmb.dispose(),this.rmb=null)}Qrh(a,b,c){c&&cl.b(a)?this.yGd=!1:(this.X5e=a,this.yGd=c);this.$a=b}Zel(){u.AFrameworkApplication.Ta.processAction(H.a.giveFeedback,2)}static createInstance(a,b,c=null){const h=new OE;null==c?h.Qrh(a,b,u.AFrameworkApplication.owf||b.ka("HelpTabIsEnabled")):h.Qrh(a,b,c);return h}}Object(n.a)(OE,"AssistanceDisplayManager",null,[392,106]);
class Vv{constructor(a,b,c,h,m){this.xG=a;this.TVh=b;this.Xzc=c;this.uMh=h;this.UUh=m}get lcid(){return this.xG}get namespace(){return this.TVh}get wIa(){return this.Xzc}get nei(){return this.uMh}get locale(){return this.UUh}static Flj(a){const b=a.indexOf(".");return 0<=b&&b<a.length&&(a=parseInt(a.substring(0,b)),!isNaN(a))?a:Vv.mfi}static createInstance(a){return new Vv(u.AFrameworkApplication.lcid,a,Vv.Flj(u.AFrameworkApplication.buildVersion),"WDWAENDUSER,XLWAENDUSER,PPWAENDUSER,ONWAENDUSER",
Fa.a.ue(u.AFrameworkApplication.lcid).name)}}Vv.mfi=16;Object(n.a)(Vv,"AssistanceSearchUrlParameterSet",null,[]);class PE{constructor(a,b){a=new Vl.QueryStringBuilder(a);a.Ki("clid",b.lcid.toString());a.Ki("p1",b.namespace);a.Ki("ver",b.wIa.toString());a.Ki("apps",b.nei);a.Ki("lc",b.locale);this._url=a.toString()}UTc(a){const b=new Vl.QueryStringBuilder(this._url);b.Ki("src","TellMe");b.Ki("query",a.Ff);b.Ki("sessionid",a.sessionId);b.Ki("correlationid",a.correlationId);return b.toString()}static createInstance(a){return new PE(u.AFrameworkApplication.pwf,
a)}}Object(n.a)(PE,"AssistanceSearchUrlProvider",null,[390]);class QE{$b(){}init(){u.AFrameworkApplication.vrb&&!u.AFrameworkApplication.WMb&&ir.instance.vb(u.AFrameworkApplication.Ta)}dispose(){ir.instance.dispose()}Ybg(a){ir.instance.initialize(OE.createInstance(a,u.AFrameworkApplication.fa),PE.createInstance(Vv.createInstance("PPWAEndUser")))}}Object(n.a)(QE,"AssistancePackage",null,[2,3]);var pR=d(1007);class GO{constructor(a,b,c,h,m,y){this.ia=a;this.Zc=b;this.Upe=c;this.b5j=h;this.gte=m;this.Kua=
y}em(a,b){if(b&&this.ia){a={};let c;switch(b.actionId){case H.a.gVd:a.query="contactsupport";c=ResourceStrings.L_ContactSupport;break;case H.a.giveFeedback:a.feedback=this.Qxi(b);a.query="givefeedback";c=ResourceStrings.L_GiveFeedback;break;case H.a.XBh:a.query="showtraining";c=ResourceStrings.L_Training;break;case H.a.VIh:a.query="whatsnew";c=ResourceStrings.L_WhatsNew;break;default:a.query=b.Ff,c=ResourceStrings.L_Help}const h={};h.TE=c;h.assetId="FA000000012";this.Kua.kje&&b.actionId===H.a.giveFeedback&&
(h.sourceLocationOverrideResourceId="Help.GiveFeedback.Url");h.nonPersistedSettings=a;b.actionId==H.a.gVd&&(h.sourceLocationOverrideResourceId="Help.ContactSupport.Url");this.ia.La(M.a.Ufa,2,h)}}zr(){const a=this.wwb();a&&this.ia&&this.ia.La(M.a.Ssb,2,a)}dispose(){}wwb(){if(this.Zc.instance){const a=this.Zc.instance.mQ("FA000000012");if(a)return a.instanceId}return null}Qxi(a){this.Kua.kje||(this.gte?this.gte.kTb?this.EBf():this.b5j.ZZd(Object(F.a)(this,this.ZUi,"feedbackDownloaded")):Ba.a.J(512324302,
1302,15,"feedbackFormManager is undefined"));a=a.rd?a.rd:{};u.AFrameworkApplication.fa.qNd(a);a=this.Upe.getContext(a);let b={};"telemetryGroup"in a&&(b=a.telemetryGroup);b.processSessionId=a.sessionId;b.officeBuild=a.build;a.telemetryGroup=b;if(void 0===a.feedbackType||null===a.feedbackType)a.feedbackType=-1;"disableIncludeScreenshot"in a||(a.disableIncludeScreenshot=!1);"screenshot"in a||(a.screenshot=!0);a.disableScreenshotPreview=!1;a.includeScreenshotSelectedDefault=!0;return a}EBf(){if(pR.a.u0g())Ba.a.J(512324300,
1302,15,"OBF is undefined");else{try{OfficeBrowserFeedback.createScreenshot(document.body).then(Object(F.a)(this,this.X$g,"postScreenshotData"));return}catch(a){Ba.a.J(512324299,1302,15,"Failed to use createScreenshot. "+(a?"Message: "+a.message+" Stack: "+a.stack:null))}try{OfficeBrowserFeedback.html2canvas(document.body,null)().then(Object(F.a)(this,this.X$g,"postScreenshotData"))}catch(a){Ba.a.J(512324298,1302,15,"Failed to use html2canvas. "+(a?"Message: "+a.message+" Stack: "+a.stack:null))}}}ZUi(a){a&&
(this.gte.Olg(a),this.EBf())}X$g(a){a=a.toDataURL("image/jpeg");const b=this.wwb(),c={};c.screenshot=a;OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(b,"onScreenshot",c,null)}}Object(n.a)(GO,"AgaveAssistancePane",null,[368,106]);class HO extends QE{constructor(){super();this.T5e=this.y$e=this.j8e=this.k8e=this.Da=null;this.Load=this.load}get name(){return"PowerPointEditor.Assistance"}$b(a){this.Da=a}load(){this.init()}init(){super.init();!u.AFrameworkApplication.vrb&&u.AFrameworkApplication.WMb?
Ba.a.J(512258326,1302,50,"Not initializing the PowerPoint Assistance package because the feature is disabled."):(Ba.a.J(512258325,1302,50,"Initializing the PowerPoint Assistance package (the feature is enabled)."),u.AFrameworkApplication.fa.ka("HelpTabIsEnabled")?(this.k8e=this.Da.resolve("Common.App.ICustomerFeedbackUiWrapper"),this.j8e=this.Da.resolve("Common.App.CustomerFeedback.ICustomerFeedbackResourceDownloadManager"),this.y$e=this.Da.resolve("Common.App.CustomerFeedback.ICustomerFeedbackFormManager"),
this.T5e=this.Da.resolve("PowerPointWebEditor.IApplicationSettings"),this.Ybg(()=>new GO(this.Da.resolve("Common.IActionManagerExtended"),this.Da.Ja("PowerPointWebEditor.IAppForOfficeManager"),this.k8e,this.j8e,this.y$e,this.T5e))):this.Ybg(null))}}Object(n.a)(HO,"PowerPointAssistancePackage",QE,[293]);class RE{pXi(a,b,c){return a?this.pWi(b,c):this.qXi(b,c)}STf(a,b,c){return a?this.SWi(b,c):this.KWi(b,c)}IWi(a){var b=a.yf?a.kg.Ye:a.kg.Ua;const c=new rb.GraphIterator;a.nq?c.Rc(a.nq):c.set(b.node);
c.rc(14);a=new rb.GraphIterator;a.Rc(c);a.rc(14);b=Qe.findControllingCellFromNode(c.currentNode);let h=null,m=!1;if(!Qe.isLastCellInRow(a)){do if((h=Gd.moveToNextColumn(a))&&Qe.findControllingCellFromNode(h)!==b){m=!0;break}while(h&&!Qe.isLastCellInRow(a))}if(!m&&!Qe.isLastCellInColumn(c)){do if((h=Gd.moveToNextRow(c))&&Qe.findControllingCellFromNode(h)!==b){m=!0;break}while(h&&!Qe.isLastCellInColumn(c))}return m?h:null}QWi(a){var b=a.yf?a.kg.Ye:a.kg.Ua;const c=new rb.GraphIterator;a.nq?c.Rc(a.nq):
c.set(b.node);c.rc(14);a=new rb.GraphIterator;a.Rc(c);a.rc(14);b=Qe.findControllingCellFromNode(c.currentNode);let h=null,m=!1;if(!Qe.isFirstCellInRow(a)){do if((h=Gd.moveToPreviousColumn(a))&&Qe.findControllingCellFromNode(h)!==b){m=!0;break}while(h&&!Qe.isFirstCellInRow(a))}if(!m&&!Qe.isFirstCellInColumn(c)){do if((h=Gd.moveToPreviousRow(c))&&Qe.findControllingCellFromNode(h)!==b){m=!0;break}while(h&&!Qe.isFirstCellInColumn(c))}return m?h:null}ePc(a,b){var c=a.yf?a.kg.Ye:a.kg.Ua;const h=new rb.GraphIterator;
a.nq?h.Rc(a.nq):h.set(c.node);h.rc(14);a=Qe.findControllingCellFromNode(c.node);c=null;if(b){do{if(Qe.isFirstCellInColumn(h))break;c=Gd.moveToPreviousRow(h)}while(c&&Qe.findControllingCellFromNode(c)===a)}else{do{if(Qe.isLastCellInColumn(h))break;c=Gd.moveToNextRow(h)}while(c&&Qe.findControllingCellFromNode(c)===a)}return c}RTf(a,b){if(!gk.l(a))return null;a=rb.GraphIterator.nb(a.currentNode);a.rc(14);let c;const h=rd.TableReader.Cu(a.origin);do c=b?Gd.moveToPreviousRow(a):Gd.moveToNextRow(a);while(h&&
c&&gk.h(a));return c}oYa(a,b,c,h,m){let y=null;mc.OutlineElementNavigator.Oe(a);const G=Kd.OutlineElementReader.isRtl(a.currentNode);if(c)if(Gd.returnToCell(a),b=Qe.isLastCellInRow(a),c=Qe.isFirstCellInRow(a),m||!G&&c||G&&h&&b)Gd.returnToContainingRow(a),(h=this.RTf(a,!0))?y=yd.SelectionFactory.sj(h,!b):m&&(mc.OutlineElementNavigator.Oe(a),m=new fn.a,m.Rc(a),(a=mc.OutlineElementNavigator.Hwa(m,!1,!1))&&(y=yd.SelectionFactory.sj(a,!1)));else{do G?Gd.moveToNextColumn(a):Gd.moveToPreviousColumn(a);while(Qe.isGhostCell(a)&&
!Qe.isFirstCellInColumn(a));Qe.isGhostCell(a)||(y=yd.SelectionFactory.sj(a.currentNode,!G))}else Kd.OutlineElementReader.rC(a,b,G)||Bb.SelectionEditor.Sg(b)||Gd.returnToCell(a),y=yd.SelectionFactory.sj(a.currentNode,!G);return y}nYa(a,b,c,h,m){let y=null;mc.OutlineElementNavigator.Oe(a);const G=Kd.OutlineElementReader.isRtl(a.currentNode);if(c)if(Gd.returnToCell(a),c=Qe.isLastCellInRow(a),b=Qe.isFirstCellInRow(a),m||!G&&h&&c||G&&!h&&b)Gd.returnToContainingRow(a),(h=this.RTf(a,!1))?y=yd.SelectionFactory.sj(h,
b):(mc.OutlineElementNavigator.Oe(a),h=new fn.a,h.Rc(a),(a=mc.OutlineElementNavigator.yJ(h,!1,!1))&&(y=yd.SelectionFactory.sj(a,!0)));else{do G?Gd.moveToPreviousColumn(a):Gd.moveToNextColumn(a);while(Qe.isGhostCell(a)&&!Qe.isLastCellInRow(a));Qe.isGhostCell(a)||(y=yd.SelectionFactory.sj(a.currentNode,G))}else Kd.OutlineElementReader.rC(a,b,!G)||Bb.SelectionEditor.Sg(b)||Gd.returnToCell(a),y=yd.SelectionFactory.sj(a.currentNode,G);return y}}Object(n.a)(RE,"ATableCellSelectionStrategy",null,[389]);
class SE extends RE{constructor(){super()}KWi(a,b){var c=a.mb;let h=null;if(a.Gl){let m=null;if(b){if(c.nq=a.qja,a=Object(ua.a)(Tl.TableCellNode,this.IWi(c)))a.isGhostCell&&(m=a,a=a.Ry()),h=c.KG.isValid&&c.KG.node&&a===c.KG.node?yd.SelectionFactory.sj(c.KG.node,!c.yf):yd.SelectionFactory.wu(Yq.TableNodeContext.create(Object(ua.a)($f.a,a)),c.yf)}else if(c=a.ga(Math.max(0,Math.min(a.eja,a.Rya))),c=Object(ua.a)(Tl.TableCellNode,c.kg.Ye.node),c.isControllingCell&&(c=c.t6d(2)),a=c.k_(),b=c.cRc().EIa,!a&&
b&&(c=b.rUf),a=c)a.isGhostCell&&(m=a,a=a.Ry()),h=Bb.SelectionEditor.Ql(yd.SelectionFactory.wl(Object(ua.a)($f.a,a)),!0,!1);h&&m&&(h.nq=rb.GraphIterator.nb(m))}return h}SWi(a,b){let c=a.mb,h=null;a.Gl&&(b?(c.nq=a.qja,a=Object(ua.a)(Tl.TableCellNode,this.QWi(c)),b=null,a&&(a.isGhostCell&&(b=a,a=a.Ry()),(h=c.KG&&c.KG.isValid&&a===Object(ua.a)(123,c.KG.node)?yd.SelectionFactory.sj(c.KG.node,!c.yf):yd.SelectionFactory.wu(Yq.TableNodeContext.create(Object(ua.a)($f.a,a)),c.yf))&&b&&(h.nq=rb.GraphIterator.nb(Object(ua.a)($f.a,
b))))):(a.eja>a.Rya?(c=a.g6,c.nq=c.yf?a.o0a:null):c.nq=c.yf?null:a.qja,h=Bb.SelectionEditor.Ql(yd.SelectionFactory.wl(c.kg.Ua.node),!0,!1),h.nq=c.nq));return h}qXi(a,b){let c=a.mb;var h=null;if(a.Gl){const m=a.eja>a.Rya;let y=null;if(b){if(c.nq=a.qja,a=Object(ua.a)(Tl.TableCellNode,this.ePc(c,!0)))a.isGhostCell&&(y=a,a=a.Ry()),h=m&&c.KG&&c.KG.isValid&&a===c.KG.node?yd.SelectionFactory.sj(c.KG.node,!c.yf):yd.SelectionFactory.wu(Yq.TableNodeContext.create(Object(ua.a)($f.a,a)),c.yf)}else m?(c=a.g6,
c.yf&&(c=c.fvb(),c.nq=a.o0a)):c.yf?c=c.fvb():c.nq=a.qja,h=Object(ua.a)(Tl.TableCellNode,this.ePc(c,!0)),h?h.isGhostCell&&(y=h,h=h.Ry()):(h=Object(ua.a)(Tl.TableCellNode,c.kg.Ua.node),y=c.nq?Object(ua.a)(Tl.TableCellNode,c.nq.currentNode):null),h=yd.SelectionFactory.sj(Object(ua.a)($f.a,h),!0);h&&y&&(h.nq=rb.GraphIterator.nb(Object(ua.a)($f.a,y)))}return h}pWi(a,b){let c=a.mb;var h=null;if(a.Gl){const m=a.eja<a.Rya;let y=null;if(b){if(c.nq=a.qja,a=Object(ua.a)(Tl.TableCellNode,this.ePc(c,!1)))a.isGhostCell&&
(y=a,a=a.Ry()),h=m&&c.KG&&c.KG.isValid&&a===Object(ua.a)(123,c.KG.node)?yd.SelectionFactory.sj(c.KG.node,!c.yf):yd.SelectionFactory.wu(Yq.TableNodeContext.create(Object(ua.a)($f.a,a)),c.yf)}else m?(c=a.g6,c.yf&&(c=c.fvb(),c.nq=a.o0a)):c.yf?c=c.fvb():c.nq=a.qja,h=Object(ua.a)(Tl.TableCellNode,this.ePc(c,!1)),h?h&&h.isGhostCell&&(y=h,h=h.Ry()):(h=Object(ua.a)(Tl.TableCellNode,c.kg.Ua.node),y=c.nq?Object(ua.a)(Tl.TableCellNode,c.nq.currentNode):null),h=yd.SelectionFactory.sj(Object(ua.a)($f.a,h),!0);
h&&y&&(h.nq=rb.GraphIterator.nb(Object(ua.a)($f.a,y)))}return h}}Object(n.a)(SE,"TableCellSelectionStrategy",RE,[]);class IO extends cz{constructor(a,b,c,h,m,y,G,U,ja,va,Ta,fb,Db,gc,hc,Gc){super(a,b,c,h,m,y,G,U,ja,va,Ta,fb,Db,gc,hc);this.CZh=m;this.zSh=c;this.Ovc=Gc}j0b(a,b){var c=Object(ua.a)(Ro,b);c&&c.mZa&&this.iqi(this.zSh.I_e)&&(c=c.mZa.sa(zm.a.Ub,""),this.Ovc.Qhc(c),this.Ovc.CB(6,c));return super.j0b(a,b)}iqi(a){const b=new hC;for(b.enqueue(a);0<b.count;){a=b.dequeue();if(14===a.type)return!0;
a=rb.GraphIterator.nb(a);let c=a.Gi();for(;c;)b.enqueue(c),c=a.kp()}return!1}VLc(a,b){var c=Object(ua.a)(Ro,b);if(c&&c.mZa){c=c.mZa.sa(zm.a.Ub,"");const h=Object(ua.a)(5,this.CZh.Pa.mb.Ye.node);h&&(h.Ub=c)}return super.VLc(a,b)}}Object(n.a)(IO,"PPTClipboardOperationCutCopy",cz,[]);class JO{constructor(a,b,c,h,m,y,G,U,ja,va,Ta,fb,Db,gc,hc,Gc){this.Ca=a;this.ld=b;this.Zr=c;this.BZ=y;this.Tc=m;this.Di=h;this.pr=G;this.hf=U;this.Eha=ja;this.rK=va;this.Fha=Ta;this.bpb=fb;this.x4a=Db;this.$a=gc;this.hk=
hc;this.Ovc=Gc}create(){return new IO(this.Ca,this.ld,this.Zr,this.Di,this.Tc,this.BZ,this.pr,this.hf,this.Eha,this.rK,this.Fha,this.bpb,this.x4a,this.$a,this.hk,this.Ovc)}}Object(n.a)(JO,"Factory",null,[291]);class KO{constructor(){}get Agd(){return!1}Krb(){}get WXg(){return!1}set WXg(a){}get rgk(){return!1}kna(){}IYa(){}get e0g(){return-1}get jMc(){return null}}Object(n.a)(KO,"NoImageSteward",null,[387]);class TE{constructor(a){this.aec=a}create(a,b){return this.aec||1!==a?new KO(b):null}}Object(n.a)(TE,
"PPTImageStewardFactory",null,[363]);class Cq extends Wr{constructor(a,b,c,h,m,y,G){super(a,b,c);this.ia=h;this.qx=m;this.Bc=G;this.q8j=y.Byk;this.vWa=y.qhe;this.S7j=y.phe;this.aec=y.dzb;this.r8j=y.xQj}Lie(a,b,c){const h=Cq.fYf(c);a=(!J.a.instance.ga(82)||this.BPj(a,b,h))&&super.Lie(a,b,c);3===c.vQa?this.Bc.Ew(2,h):2===c.vQa&&this.Bc.Ew(3,h);a&&(this.Bc.Qhc(h),this.xFh(b,h));return a}BVe(a,b,c){const h=Cq.fYf(c);a.setAttribute(mu.a.LBf,h);let m=!1;const y=Cq.zPj(a);if(y)Ba.a.J(17310354,826,50,null),
m=!0;else if(this.r8j&&1===a.getElementsByTagName("Table").length&&!b.iterator.rc(60))this.Bc.CB(6,h),m=!0;else{const G=Wa.b(a);G&&G.length||!Cq.M4b(a)||(Ba.a.J(17310356,826,50,null),m=!0)}m&&!Cq.lmh&&(u.AFrameworkApplication.CL("Microsoft.Office.Server.Powerpoint.Web.IPasteContentFromPandoraSettings"),Cq.lmh=!0);if(!this.q8j)return!0;m&&(this.aec&&this.Jig(c)?Ba.a.J(36779848,826,50,"Paste text only action."):(Ba.a.J(17310358,826,50,null),this.ESi(a.cloneNode(!0),y)));if(a=!m&&super.BVe(a,b,c))this.Bc.Qhc(h),
this.Bc.CB(1,h),this.xFh(b,h);return a}ESi(a,b){b&&a.firstChild&&a.firstChild.className&&(a.className=a.firstChild.className,(this.vWa||this.S7j)&&this.qx.cti(a.firstChild,a));Nc.a.qaa(()=>{this.ia.La(M.a.b9g,2,a)},100)}BPj(a,b,c){if(u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.ka("ComplexTableCellPasteWithFormattingIsEnabled")){a=Cq.qkj(a);if(1!==a.count)return!1;this.Bc.CB(6,c);a=a.ga(0);return!u.AFrameworkApplication.fa.ka("ComplexTableCellPasteFromComplexTableIsEnabled")&&this.Zvj(a)?
!1:Cq.UPj(b)}c=Object(ua.a)(5,b.iterator.currentNode);let h=null;c&&(h=(c=c.dL())?c.getContainingTable():null);return!!u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.ka("PPTInternalPasteTableInTableIsEnabled")&&b.el&&b.node.Sa(X.a.cellId)&&1===a.getElementsByTagName("Table").length&&!!h&&!h.Lp()}Zvj(a){a=a.getElementsByTagName("Table");if(1===a.length){a=a[0].getElementsByTagName("td");for(let c=0;c<a.length;c++){var b=a[c];if(!b)continue;const h=b.attributes.getNamedItem("rowspan");if(!h||
!h.specified||"1"!==h.value)return!0;b=b.attributes.getNamedItem("colspan");if(!b||!b.specified||"1"!==b.value)return!0}}return!1}xFh(a,b){if(Object(ua.a)(5,a.node)&&a.iterator)if(a.iterator.rc(10)){if(a=Object(ua.a)(4,a.iterator.Mw(10)))a.Ub=b}else a.iterator.rc(60)&&(a=Object(ua.a)(362,a.iterator.Mw(60)))&&(a.Ub=b)}static qkj(a){a=a.getElementsByTagName("Table");if(1===a.length){var b;return b=new Qa.a,b.add(a[0]),b}b=new Qa.a;if(2===a.length){for(let c=0;c<a.length;c++){if(0<a[c].getElementsByTagName("Table").length){if(0<=
a[c].className.indexOf("Selected_Table"))continue;b.clear();break}b.add(a[c])}1<b.count&&b.clear()}return b}static UPj(a){return a.el&&a.node.Sa(X.a.cellId)&&a.iterator.rc(14)?!0:!1}static M4b(a){a=a.getElementsByTagName(cf.a.G8);if(!a.length)return null;a=a[0];return a.src?a:null}static zPj(a){return!!a.firstChild&&!!a.firstChild.className&&fR.a.Qdg(a.firstChild.className)}static fYf(a){let b="";a&&a.mZa&&(b=a.mZa.sa(zm.a.Ub,""));return b}}Cq.lmh=!1;Object(n.a)(Cq,"PPTPasteCoordinator",Wr,[]);class LO{constructor(){}Krb(){}get vca(){return!1}mY(){}jY(){}lY(){}kY(){}iY(){}hY(){}}
Object(n.a)(LO,"TextOnlyTableSteward",null,[385,386]);class UE{constructor(a){this.aec=a}create(a,b){return this.aec||1!==a?new LO(b):null}}Object(n.a)(UE,"PPTTableStewardFactory",null,[361]);class VE{constructor(a,b,c){this.J6j=a;this.h9j=b;this.la=c}kOe(){this.J6j.execute(a=>{this.la.xje&&a.vOe(this.h9j.value)})}}Object(n.a)(VE,"AccessibilityActor",null,[]);class tu{get key(){return"LIST"}get O7(){return Box4Intl.Box4Strings.l_ListContentTitle}h1e(a){let b;b=null;const c=tu.Sf.fw(a);if(!c)return{returnValue:!1,
gtb:b};a=this.xaj(a,c);b=Object.assign(new Zy,{T0:this.key,contentId:a.listId,ZP:a});return{returnValue:!0,gtb:b}}gRc(a,b){a=a.ZP;const c=this.C$i(a.GT),h=new Li.a;b?(b=b.ZP,b.level!==a.level?(h.add(String.format(Box4Intl.Box4Strings.l_ListContentDetailsLevelFormat,a.level)),h.add(c)):b.id.equals(a.id)&&b.GT.listType===a.GT.listType||h.add(c)):(h.add(String.format(Box4Intl.Box4Strings.l_ListContentTitle)),h.add(String.format(Box4Intl.Box4Strings.l_ListContentDetailsLevelFormat,a.level)),h.add(c));
return h.toArray().join(" ")}C$i(a){let b="";const c=a.listStyle;if(0===a.listType)b=String.format(Box4Intl.Box4Strings.l_ListContentDetailsItemFormat,a.eX);else if(1===a.listType)switch(c){case 1:b=this.Tyf;break;case 2:b=this.Eki;break;case 3:b=this.Fki;break;default:b=this.Tyf}return b}static get Sf(){return tu.Ug||(tu.Ug=vb.a.instance.resolve("Box4.List.IListReader"))}}tu.Ug=null;Object(n.a)(tu,"ListDetailsProvider",null,[383,384]);class MO{constructor(){this.GT=this.listId=this.id=null;this.level=
0}}Object(n.a)(MO,"ListItemInfo",null,[]);class WE extends tu{constructor(a){super();this.oH=a}get Tyf(){return ResourceStrings.l_BulletStyle1}get Eki(){return ResourceStrings.l_BulletStyle1}get Fki(){return ResourceStrings.l_BulletStyle1}xaj(a,b){const c=this.oH.Wca(a),h=this.oH.vaj(a);return Object.assign(new MO,{id:a.currentNode.id,listId:new pa.a(Eh.a.nil,h),GT:b,level:c+1})}}Object(n.a)(WE,"ListDetailsProvider",tu,[]);class NO{constructor(){this.aJ=this.K=null}dispose(){}$b(a){this.K=a;this.aJ=
this.K.resolve("Common.AFrameworkApplication");a.register(TE,"PowerPointWebEditor.PPTImageStewardFactory").as("Box4.Actors.IBox4ImageStewardFactory").ma().oa(()=>new TE(a.resolve("PowerPointWebEditor.IApplicationSettings").dzb));a.register(UE,"PowerPointWebEditor.PPTTableStewardFactory").as("Box4.Actors.IBox4TableStewardFactory").ma().oa(()=>new UE(a.resolve("PowerPointWebEditor.IApplicationSettings").dzb));a.register(Wr,"Box4.Actors.PasteCoordinator").ma().oa(()=>new Cq(a.resolve("Box4.Actors.InternalClipboard"),
a.resolve("Box4.Actors.IInternalPasteExecutionManagerFactory"),a.resolve("Box4.Actors.IExternalPasteExecutionManagerFactory"),a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.IClipboardHelper"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.IClipboardTelemetry")));a.register(291,"Box4.Actors.IClipboardOperationCutCopyFactory").ma().oa(()=>new JO(u.AFrameworkApplication.Ta,ec.a.instance,a.resolve("Box4.Actors.InternalClipboard"),a.resolve("Box4.IOutlineElementEditor"),
me.a.instance,a.resolve("Box4.Actors.ISystemClipboard"),a.resolve("Box4.IParagraphReader"),Pi.a.instance,a.resolve("Box4.IOutlineElementNavigator"),a.resolve("Box4.Graph.IGraphIteratorFactory"),a.resolve("Box4.IOutlineElementReader"),a.resolve("Box4.IRenderOrderGraphIteratorFactory"),a.resolve("Box4.ISelectionFactory"),a.resolve("Common.IAppSettingsManager"),a.resolve("Box4.IClipboardDataHelper"),a.resolve("PowerPointWebEditor.IClipboardTelemetry")));a.register(WE,"PowerPointWebEditor.ListDetailsProvider").oa(()=>
new WE(a.resolve("PowerPointWebEditor.IPptListCore")));a.register(VE,"PowerPointWebEditor.AccessibilityActor").ma().oa(()=>new VE(a.Ja("Box4.Accessibility.IAccessibilityContextManager"),a.re("PowerPointWebEditor.ListDetailsProvider"),this.aJ.BS.od));a.register(SE,"PowerPointWebEditor.TableCellSelectionStrategy").as("Box4.ITableCellSelectionStrategy").ma().oa(()=>new SE)}init(){const a=Fc.App.HD.KS;Nx.OCj(this.aJ.rr,this.K.resolve("Common.IReactContextualUILauncher"),a,this.K.resolve("Common.IExternalUICommandDefinitionMapping"));
this.K.resolve("PowerPointWebEditor.AccessibilityActor").kOe()}get name(){return"PowerPointWebEditor.Box4DelayedLoadedPackage"}}Object(n.a)(NO,"Box4DelayedLoadedPackage",null,[2,3]);class OO{constructor(a,b,c,h,m,y,G,U){this.ecb=this.Xua=null;this.C1c=0;this.y1c=new Nd.a(0);this.wcb=this.Hqe=this.tcc=null;this.z1c=!1;this.Oug=[ra.a.contextMenu,ra.a.fza,ra.a.GM,ra.a.mouseDown,ra.a.pointerDown,ra.a.RPa,ra.a.Wfb,ra.a.paste];this.IVg=[ra.a.Zf,ra.a.Hl,ra.a.ey,ra.a.click,ra.a.doubleClick,ra.a.xR,ra.a.vRd,
ra.a.xJ,ra.a.mcd];this.YI=a;this.Kne=c||[];this.A3j=h||[];this.B2c=m||[];this.JSg=y;this.Oc=b;this.Oc.M7h(Object(F.a)(this,this.h1g,"onAppClosing"));this.Oc.GA(Object(F.a)(this,this.vB,"onSessionEnd"));this.r8c=G;U&&(Fd.EventHandlerManager.instance.qOe(this.Oug,Object(F.a)(this,this.nmk,"onBeforeEventActionContextCreated")),Fd.EventHandlerManager.instance.hgh(this.Oug,Object(F.a)(this,this.Blk,"onAfterEventActionContextCreated")),Fd.EventHandlerManager.instance.qOe(this.IVg,Object(F.a)(this,this.omk,
"onBeforeEventTriggered")),Fd.EventHandlerManager.instance.hgh(this.IVg,Object(F.a)(this,this.Clk,"onAfterEventTriggered")));this.mve=!1}N$(a){if(2===a.behavior){var b=a.actionId;if(this.yoa(b)){var c=this.getCommandName(b);Ba.a.J(18956760,817,50,"ActionContextListener::OnBeforeAction "+this.Aag(a,c,"",!1)+"; Current Event: "+(this.wcb||"")+"; Current ActionContext: "+(Nc.a.Ib?Nc.a.Ib.toString():""));if(!this.C1c)if(this.z1c=!0,this.Lbl(a)){this.Xua=Nc.a.Msd(c);this.mve=!0;a=a.telemetryData;c=this.tcc;
let h=this.Hqe;null===c&&a&&a[li.a.iDa]&&(c=a[li.a.iDa],h=Nc.a.llb(c));null!==h&&(this.Xua.Va(li.a.w5a,h.toFixed(2)),null!==c&&this.Xua.Va(li.a.iDa,c.toFixed(2)));a&&Da.a.forEach(a,(m,y)=>{this.Xua.kza(m,(null===y||void 0===y?void 0:y.toString())||"")},null);c=!1;Array.contains(ci.q2k,b)?c=!0:this.Xua.Qr=!0;c=c||this.Nj(b,a);this.Xua.Nj=c}else this.Xua=Nc.a.Ib}this.C1c++}}M$(a){if(2===a.behavior){var b=a.actionId;if(this.yoa(b)){var c=Nc.a.Ib;const h=c?c.WJ(li.a.Apf).toString():"";Ba.a.J(18956762,
817,50,"ActionContextListener::OnAfterAction "+this.Aag(a,this.getCommandName(b),h,!0)+";Result:"+a.response.toString()+";Current Event:"+(this.wcb||"")+";Current ActionContext:"+(c?c.toString():"")+";RevisionId: "+(c?c.WJ(li.a.zY).toString():""))}this.jel(b)&&(c=this.y1c.ESc(b,0),this.y1c.add(b,c+1));this.C1c--;0<this.C1c||!Nc.a.Ib||!this.Xua||(Nc.a.xk(li.a.l3h,a.response.toString()),Nc.a.Ib!==this.Xua||this.ecb||this.b1g(),this.Xua=null)}}b1g(){const a=Nc.a.Ib;if(a){var b=new Date;a.Nj&&!a.TLb&&
null===a.pF&&(a.pF=b);a.kza(li.a.f3h,(+b-+a.CD).toString());a.Qr?0<a.WJ(li.a.zY).length&&Nc.a.zfa(a):Nc.a.usd();this.mve&&(Nc.a.Ib=null,this.mve=!1)}}yoa(a){if(!this.JSg)return!1;if(Array.contains(this.Kne,a))return!0;a=u.AFrameworkApplication.Ta.$S(a);return!!a&&!(a.flags[32]||a.flags[64])}Nj(a,b){return Array.contains(this.A3j,a)?b&&li.a.TEc in b?b[li.a.TEc]:!0:!1}jel(a){return this.JSg&&Array.contains(this.B2c,a)}Lbl(a){return this.r8c?!Nc.a.Ib:!Nc.a.Ib&&a.Oi}Aag(a,b,c,h){if(null===a)return"null";
b="ActionName="+b+", IsTableShapeSelected="+c+", ActionId="+a.actionId+", BeginMode="+a.mHc+", InvocationMethod="+a.oT+", CommandLocation="+a.wq+", CommandTabName="+a.Ora;return h?"Response="+a.response+", "+b:b}getCommandName(a){const b=this.YI?this.YI.I5(a):null;return b?b:a.toString()}h1g(){if(!(1>this.y1c.count)){var a={};this.y1c.forEach((b,c)=>{b=this.getCommandName(b);a[b]=c;return!0});Ba.a.J(512491875,817,15,"ActionContextListener::OnAppClosed {0}",dd.c(a));this.Oc.VSk(Object(F.a)(this,this.h1g,
"onAppClosing"))}}vB(){Nc.a.Cri()}nmk(a){this.wcb=a.type;this.ecb=Nc.a.Msd(this.wcb);this.ecb.Nj=!0;this.z1c=!1;a=Nc.a.xsd(a);null!==a&&Nc.a.gtl(a)&&this.ecb.Va(li.a.iDa,a.toFixed(2))}Blk(){this.ecb&&Nc.a.Ib===this.ecb&&this.z1c&&this.b1g();Nc.a.Ib=null;this.z1c=!1;this.ecb=this.wcb=null}omk(a){this.wcb=a.type;this.tcc=Nc.a.xsd(a);null!==this.tcc&&(this.Hqe=Nc.a.llb(this.tcc))}Clk(){this.wcb=this.Hqe=this.tcc=null}}Object(n.a)(OO,"ActionContextListener",null,[141]);var qR=d(369),rR=d(433);class XE{constructor(){this.K=
null;this.Stg=[];this.Rk=null;this.Lva="";this.LX=[new NO,new DO];this.L9=!!window.performance&&!!window.performance.now}get name(){return"PowerPointWebEditor.EditingPackage"}$b(a){this.Lva=String.format("EditingPackage ConfigureStart:{0}",(new Date).getTime());rg.a.instance.ic("EditingPackageConfigureStart",Date.now());this.K=a;this.vb();for(const b of this.LX)b.$b(a);this.K.resolve("PowerPointWebEditor.IApplicationSettings").Ogg&&this.K.register(191,"PowerPointWebEditor.ISlideMasterPrefetchManager").ma().oa(()=>
new EO(this.K.resolve("PowerPointWebEditor.IPPTWorkspace"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.K.resolve("PowerPointWebEditor.Image.IImageManager"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.IInboundHelper"),this.K.resolve("Common.ITaskManager"),this.K.resolve("Box4.Graph.IGraphInstance").Ad(7),this.K.resolve("Box4.Graph.IGraphInstance").Ad(8),
this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler")));this.K.register(ME,"PowerPointWebEditor.UpdateCommandUIActionListener").ma().oa(()=>new ME(this.K.resolve("Box4.IAppFrame"),this.K.resolve("PowerPointWebEditor.ViewCore.IViewCoreEventHandlers")))}uqj(a,b,c){return 1===c?32:2===c?(this.iDj(),Ba.a.J(512497352,822,50,"Draw tab was clicked."),this.K.resolve("Common.IActionManagerExtended").processAction(M.a.rcg,2),32):8}FCj(){const a=this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame");
a.Mq();this.K.resolve("Box4.IGeneralCuiUser");a.updateCommandUI()}kcg(a){const b=this.K.resolve("PowerPointWebEditor.ShapeSVG.IShapeSVGDependencyLoader");b.rJf=!0;b.Tyh=a;b.Dng()}SYj(a,b){Ba.a.J(512497351,835,50,"Init GC2 started");const c=new Date,h=this.K.resolve("PowerPointWebEditor.GraphicalContentComponents.IGraphicalContentComponentsDependencyLoader");h.uZj().continueWith(m=>{var y=new Date;Ba.a.J(512497350,813,50,"gc2 dependency loader loadJS starts: {0}, ends: {1}, durationMS: {2}",Nc.a.nf(c),
Nc.a.nf(y),+y-+c);if(6===m.status){m=EJ.a({});const G=(y=XC())&&m&&(b||a);Ba.a.J(512497349,835,50,"{0}",{["message"]:"InitializeGraphicalContentComponents",["gc2ShapeBuilderImageRenderingEnabled"]:a,["gc2PreloadShadersEnabled"]:b,["isBrowserShapeBuilderCompatible"]:m,["browserSupportsWebGL"]:y,["shouldUseShapeBuilder"]:G});m=G?document.createElement("canvas"):null;h.bDj(m,this.K.resolve("Gc2.IGlyphStore"))}}).continueWith(m=>{6!==m.status&&Ba.a.J(512497348,835,10,"Exception: {0}",m.Zi)})}lEj(){this.K.resolve("PowerPointWebEditor.Video.IVideoDependencyLoader").Gng()}iDj(){this.K.resolve("PowerPointWebEditor.Ink.IInkDependencyLoader").oAb().continueWith(()=>
{this.K.resolve("PowerPointWebEditor.WetInkView")})}vb(){this.K.resolve("Common.IActionManagerExtended").ya(M.a.wjh,he.a.frame,Object(F.a)(this,this.uqj,"handleDrawTabClicked"))}init(){const a=!this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager").presentation;this.Lva=String.format("{0}, InitStart:{1}, OpenEarlyNotBack:{2}",this.Lva,(new Date).getTime(),a);rg.a.instance.ic("EditingPackageInitStart",Date.now());a?(this.Rk=this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),
this.Rk.Ksf(Object(F.a)(this,this.Nbg,"initEditingPackage"))):this.Obg()}Nbg(){this.Rk.gih(Object(F.a)(this,this.Nbg,"initEditingPackage"));this.Obg()}Obg(){const a=this.K.resolve("PowerPointWebEditor.IAppBootCompletedListener");this.Lva=String.format("{0}, IsBootComplete:{1}, OnBootCompleteTime:{2}",this.Lva,a.uka,(new Date).getTime());a.OEa(()=>{this.rBj(a)});a.Kdg(()=>{this.Fxi()})}rBj(a){this.Lva=String.format("{0}, InitStartInternal:{1}",this.Lva,(new Date).getTime());rg.a.instance.ic("EditingPackageInitStartInternal",
Date.now());var b=this.K.resolve("Common.AFrameworkApplication");const c=this.K.resolve("PowerPointWebEditor.IApplicationSettings"),h=new HO;h.$b(this.K);h.load(b);for(const y of this.LX)y.init();c.pptSkipFidelityImageFetchDuringBootIfRemoveFidelityEnabled&&(vb.a.instance.resolve("PowerPointWebEditor.IImageViewManager").jkb(),c.tUa&&b.rr.Z$f());this.FCj();this.K.resolve("Common.IActionManagerExtended").Lna(new OO(this.K.resolve("PowerPointWebEditor.IActionNameResolver"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),
ci.Rng,ci.l_j,c.xui,c.JPj,c.podsEnableAyncActionContext,c.actionContextEnableEventCallbacks));if(c.AIa){let y=null;(b=this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager").Ba)?(b=Lh.e(b,this.K.resolve("PowerPointWebEditor.View.IPPTPageView").Ma))?y=b.kca:Ba.a.J(512497347,809,10,"slideViewElement is null."):Ba.a.J(512497346,809,15,"activeSlide is null. SlideCount: "+this.K.resolve("PowerPointWebEditor.IPresentationReader").Lj());this.K.register(192,"PowerPointWebEditor.ICommentShimmerView").ma().oa(()=>
new FO(y,this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),u.AFrameworkApplication.isRtl,this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventSource"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("Common.ITaskManager"),c.Sui))}this.K.resolve("Common.IActionManagerExtended").Lna(this.K.resolve("PowerPointWebEditor.UpdateCommandUIActionListener"));a.Sta||(Jj.a.instance.GNe((new Date).getTime()),c.podsRibbonEarlyRendererExposureControl&&
c.AIa&&PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.RegisterOrInvokeOnInitializeEarlyRenderedPptRibbon(()=>{PowerPointWebEditor.MinimalBoot.SetRealRibbon("OnContentEditable")}),qR.a.CMk(),this.K.resolve("PowerPointWebEditor.ISessionState").C5("AppInteractive"),this.L9&&rg.a.instance.ic("ContentEditablePerfMark",window.performance.now()),this.K.resolve("PowerPointWebEditor.IPPTRumTracker").J$("canvas","slide"),c.podTransmitMetricsBeaconOnBoot&&(Lz.App.DKb(null,Uh.a.contentEditable),this.N_j()),Ja.a.get_instance().PJ(4),
a.Sta=!0);c.AIa&&((a=this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager").Ba)?(a=a.SD(),this.K.resolve("PowerPointWebEditor.Graph.ICommentReader").v9f(a)&&(this.K.resolve("PowerPointWebEditor.ICommentShimmerView").ghl(),Ba.a.J(512497345,809,50,"CommentLandingSlide: true"))):Ba.a.J(512497344,809,10,"activeSlide is null"));rg.a.instance.ic(rR.a.U0d,(new Date).getTime());c.stc?this.K.resolve("PowerPointWebEditor.ScriptLoader.IUnifiedScriptLoader").Gca("pptedit.extcommon",null,()=>d.e(6).then(d.bind(null,
1233))):(a=Dx.a.create("pptedit.extcommon",null,()=>d.e(6).then(d.bind(null,1233))),Jk.a.Wx(a));this.lEj();(a=this.K.resolve("Common.Utils.IHighContrastDetector"))&&a.isInHighContrastMode&&Ba.a.J(512497315,809,50,"HighContrastMode enabled");!c.ehe||a&&a.isInHighContrastMode?c.Sce&&c.ehe&&this.kcg(!1):this.kcg(!0);c.tUc&&(this.Stg.push(this.K.resolve("PowerPointWebEditor.GraphicalContentComponents.Gc2WebSocketFrontDoorResponseHandler")),this.SYj(c.fQc,c.G_i));u.AFrameworkApplication.Vu||(u.AFrameworkApplication.Vu=
Ba.a.A0b());c.Ogg&&this.K.resolve("PowerPointWebEditor.ISlideMasterPrefetchManager");const m=this.K.rb("Common.IFrameTimingMeter");m&&(Ba.a.J(512497314,809,50,"Frame timing meter start:{0}",window.performance.now()),m.start(this.K.resolve("PowerPointWebEditor.IApplicationSettings").podsFrameTimingMeterReportingIntervalInSeconds),this.K.resolve("Common.ITaskManager").Eb(new He.a(3,1,this.K.resolve("PowerPointWebEditor.IApplicationSettings").podsFrameTimingMeterRunningTimeInMiliseconds,()=>{m.stop()},
90,"93")));this.Lva=String.format("{0}, InitDone:{1}",this.Lva,(new Date).getTime());rg.a.instance.ic("EditingPackageInitDone",Date.now());Ba.a.J(512497313,809,50,this.Lva)}Fxi(){const a=this.K.resolve("PowerPointWebEditor.IApplicationSettings");Ba.a.J(39370892,809,50,"Connect RTC by default: BrowserToServerRtc:{0}",a.podsTriggerServerRtcConnectionFromBrowserIsEnabled);const b=Date.now(),c=this.K.resolve("PowerPointWebEditor.ICoauthStateSetter");c.tGh("{"+u.AFrameworkApplication.userSessionId+"}");
const h=this.K.resolve("PowerpointPresence.IPresencePrepCacheParser").w7i();h&&(c.xtc(0<h.length?2:1),c.NFh(h),this.K.resolve("PowerpointPresence.IPresencePerfLogger").n0j(Date.now(),h.length));this.K.resolve("PowerPointWebEditor.PresenceLoader").qQf();this.K.resolve("PowerPointWebEditor.CoauthNotificationManager");this.K.resolve("PowerPointWebEditor.ICoauthSubscriptionManager").ocg();Ba.a.J(512497312,828,50,"PresenceCallback took {0}ms",Date.now()-b);a.podsTriggerServerRtcConnectionFromBrowserIsEnabled&&
u.AFrameworkApplication.fa.jf(Object(F.a)(this.K.resolve("PowerPointWebEditor.CoauthNotificationManager"),this.K.resolve("PowerPointWebEditor.CoauthNotificationManager").Exh,"startServerRtcConnection"))}N_j(){if(rg.a.instance.n$a)Ba.a.J(512497311,813,15,"LogBootMetrics: Cannot import metrics from PageLoadPerfRecorder since it has been logged and disposed.");else{var a={};for(var b of[Uh.a.vDa,Uh.a.XVf,Uh.a.ZVf,Uh.a.UPc,Uh.a.YVf,Uh.a.$qb,Uh.a.xGc,Uh.a.yca,Uh.a.$P,Uh.a.contentEditable,Uh.a.Utc,"UserClickTime",
"DocPageNavigationStart","DocPageFetchStart","DocPageResponseStart","DocPageResponseEnd","BootJsStartTime","BootJsEndTime",Uh.a.Skd,"BootSegments","BootOperations","EditingPackageInitStartInternal","FirstExtJsExecTime","PageViewValidationStart","PageViewValidationDuration","AllViewsValidationDuration","ViewValidationYieldTime","ViewValidationYieldCount","ThumbnailNavigationPaneViewValidationStart","ThumbnailNavigationPaneViewValidationDuration","TMYielded","MicrosoftAjaxLoadStartTime","HermesIntlLoadStartTime",
"EditCoreJsExecStartTime","EditCoreJsLoadStartTime","EditCoreJsLoadEndTime","EditingPackageConfigureStart","EditingPackageInitStart","EditExtSliceTaskRegTime",Uh.a.B3b,Uh.a.C3b,"MBootFirstImgReqStart","MBootFirstImgReqEnd","MBootFirstImgDrawEnd","MBootRetryCount","MBootCacheHit","NPLT","SplashScreenShown","LogoScreenHideTime","SplashScreenHideSource","SplashScreenTextShownTime","OpenEarlyRequestServerReceived","OpenEarlyRequestServerEnd","OpenEarlyImagesRequestStartTime","OpenEarlyImagesRequestEndTime",
"OpenEarlyImagesRequestImagesCount","OpenEarlyClientRequestSentTime","OpenEarlyClientResponseReceivedTime","TimeDiffToOpenEarly","OpenEarlyCacheDisposed","DocModelManagerLoadAsyncStart","DocModelManagerLoadDocModelEnd","DocModelManagerGetObjectsStart","DocModelManagerGetObjectsEnd","DocModelManagerOnDocModelChanged","DocModelManagerGetHeadersEnd","FluidNewContainerStart","FluidNewContainerAfterCreateDocModel","FluidNewContainerBeforeAttach","FluidNewContainerAfterAttach","FluidNewContainerEnd","ParseOpenEarlyServerResponseStart",
"ParseOpenEarlyServerResponseEnd","AppBootCompleted","FirstDrawStarted","EditingPackageRegisterTime","PackageConfigurerAndInitiatorStartTime","CalculateVisibleThumbRangeWaitTime","CalculateVisibleThumbRangeStartTime","DeepLinkSlideIndex","CalculateVisibleThumbRangeEndTime"])rg.a.instance.Fo(b)&&(a[b]=rg.a.instance.ah(b));u.AFrameworkApplication.fa.Ha("PodSID")&&(a.PodSessionID=u.AFrameworkApplication.fa.Ha("PodSID"));(b=window.self.RealRibbonDisplayTime)&&(a.RealRibbonDisplayTime=b);(b=window.self.RealRibbonDisplaySource)&&
(a.RealRibbonDisplaySource=b);(b=window.self.ThumbnailShimmerHideTime)?a.ThumbnailShimmerHideTime=b:rg.a.instance.Fo("ThumbnailShimmerHideTime")&&(a.ThumbnailShimmerHideTime=rg.a.instance.ah("ThumbnailShimmerHideTime"));Ba.a.J(39184516,809,50,"Perf metrics: "+Da.a.toJSON(a));b=this.K.resolve("PowerPointWebEditor.IApplicationSettings");b.cOj&&this.H1j(a,b)}}H1j(a,b){if(a[Uh.a.$P])if(a[Uh.a.contentEditable])if(a.UserClickTime||a.DocPageFetchStart){if(a[Uh.a.contentEditable]-a[Uh.a.$P]>b.lgi){var c=
new Map;c.set("ContentEditable",a[Uh.a.contentEditable].toString());c.set("ContentViewable",a[Uh.a.$P].toString());Mf.Health.instance.recordQosError("InteractiveOpenSlowError",["InteractiveOpenSlow"],!1,!0,!1,!1,Object.assign(new ql.a,{extendedProperties:c}))}c=b.bSi;b=a.UserClickTime?a.UserClickTime:a.DocPageFetchStart;a[Uh.a.$P]-b>c&&(c=new Map,c.set("TimingOrigin",b.toString()),c.set("ContentViewable",a[Uh.a.$P].toString()),Mf.Health.instance.recordQosError("PerceivedOpenSlowError",["PerceivedOpenSlow"],
!1,!0,!1,!1,Object.assign(new ql.a,{extendedProperties:c})))}else Ba.a.J(512497308,809,15,"Both UserClickTime and DocPageFetchStart are null");else Ba.a.J(512497309,809,15,"ContentEditable is null");else Ba.a.J(512497310,809,15,"ContentViewable is null")}dispose(){for(const a of this.LX)a.dispose();for(const a of this.Stg)a.dispose();this.K.resolve("PowerPointWebEditor.UpdateCommandUIActionListener").dispose()}static main(){const a=(new Date).getTime();Ba.a.J(38876352,809,50,"EditingPackage::Register time:{0}",
a);rg.a.instance.ic("EditingPackageRegisterTime",a);r.a.instance.Dc(new XE)}}Object(n.a)(XE,"EditingPackage",null,[2,3]);var sR=d(572);class YE{constructor(a,b,c,h,m,y,G,U,ja,va,Ta,fb,Db,gc,hc,Gc){this.Sla=this.O9=!1;this.bM={};this.p4=this.fJ=null;this.axa=()=>{this.O9&&this.renderRuler()};if(!a)throw Error.argumentNull("appFrame");if(!b)throw Error.argumentNull("activeSlideViewManager");if(!c)throw Error.argumentNull("browserHelper");if(!h)throw Error.argumentNull("viewPanelContainer");if(!m)throw Error.argumentNull("selectionManager");
if(!y)throw Error.argumentNull("shapeReader");if(!G)throw Error.argumentNull("pageView");if(!U)throw Error.argumentNull("actionManager");if(!ja)throw Error.argumentNull("slideDimensionsHelper");if(!va)throw Error.argumentNull("presentationReader");if(!Ta)throw Error.argumentNull("transactionFactory");if(!fb)throw Error.argumentNull("pptPageView");if(!Db)throw Error.argumentNull("applicationSettings");if(!gc)throw Error.argumentNull("viewElementEventHandlers");if(!hc)throw Error.argumentNull("viewCoreEventHandlers");
this.Qb=a;this.Kc=b;this.He=c;this.qIa=h;this.pa=m;this.Ea=y;this.Fb=G;this.ia=U;this.Zt=Gc;this.ny=ja;this.qc=va;this.Jb=Ta;this.Ifc=fb;this.jze=Db.Nlh;this.lze=Db.Mlh;this.qd=gc;this.uJ=hc}get Ghc(){return document.getElementById(I.AppFrame.DIh)}dispose(){this.O9=!1;this.Qb.Jhh(Object(F.a)(this,this.renderRuler,"renderRuler"));wd.a.removeHandler(this.Ghc,ra.a.scroll,Object(F.a)(this,this.ulb,"updateRulerLocation"));this.qd.rPe(Object(F.a)(this,this.bjc,"onCloseTextEditView"));this.qd.okd(Object(F.a)(this,
this.zjc,"onOpenTextEditView"));this.uJ.ekd(this.axa);this.fJ&&this.p4?(La.a.XJa(this.fJ,"ShowWACHorizontalRulerContainer"),La.a.sI(this.fJ,"HideWACHorizontalRulerContainer"),fj.UISurfaces.cTc().then(a=>{a.dispose(this.p4);return null}),this.fJ.removeChild(this.p4),this.qIa.removeChild(this.fJ),this.p4=this.fJ=null):Ba.a.J(512496006,824,50,"Ruler container div / Ruler div null")}renderRuler(){const a=window.performance.now();if(this.fJ&&this.p4){La.a.XJa(this.fJ,"HideWACHorizontalRulerContainer");
La.a.sI(this.fJ,"ShowWACHorizontalRulerContainer");var b=this.Kc.Ic;if(b&&b.Fd){var c=b.Fd;c=new cr.a(c.oq,c.Wk);b=this.ny.E5b(c,b.kca?b.kca.xa.style.visibility===Mi.a.visible:!1).width;c=this.He.ii(this.Kc.Ic.BB).width;1===this.Ifc.Sl||0>=b||0>=c?Ba.a.J(512496003,824,50,"Ruler should not be rendered"):(this.bM.rulerCanvasProps=this.EAk($d.a.rfa(b,0)),c=Object(F.a)(this,this.wpk,"onIndentChange"),this.bM.onIndentChange=c,this.bM.indents=this.bM.rulerCanvasProps.textEditableArea?this.iBk():null,this.bM.rtl=
this.Sla?!this.Zt:this.Zt,this.bM.inverted=this.Sla?!this.Zt:this.Zt,this.p4.style.width=this.He.Pc(b),this.ulb(null),fj.UISurfaces.cTc().then(h=>{h.renderRuler(this.p4,this.bM);return null}),b=window.performance.now(),Ba.a.J(512496002,824,15,"HorizontalRenderRulerDuration:{0}",(b-a).toString()))}else Ba.a.J(512496004,824,50,"Unable to get slideViewElement")}else Ba.a.J(512496005,824,50,"Ruler container div / Ruler div null")}EAk(a){const b={},c=te.a.Jv(this.qc.Pn.eb(X.a.slideWidth));var h=a/2;let m=
0,y=$d.a.XJ(a,0);b.zeroScale=$d.a.XJ(h,0);this.Sla=!1;b.textEditableArea=!1;if(this.pa.O8()&&!this.pa.JUa()){h=this.pa.m_();var G=h.sc(this.Fb.Ma),U=G.rotation;U>this.jze&&U<this.lze&&(this.Sla=!0);const ja=G.htmlElement.querySelector(".ShapeViewContent"),va=this.Ea.lSc(h,this.Fb.Ld);U=0;h.Kg&&(U=h.rs().sc(this.Fb.Ma).htmlElement.offsetLeft);U+=G.htmlElement.offsetLeft+ja.parentNode.offsetLeft+(va?va.e:0);G=U+ja.offsetWidth;h=(this.Sla?!this.Zt:this.Zt)?G:U;U>=m&&U<=y&&G>=m&&G<=y&&(m=U,y=G,b.zeroScale=
h,b.textEditableArea=!0)}U=te.a.Ita(c)/a;a=U*$d.a.rfa(y-m,0);U*=$d.a.rfa(m,0);b.leftMargin=m;b.rightMargin=y;b.precision=.0625;b.scale=c;b.rulerType="Horizontal";b.rightBoundary=te.a.OLa(a);b.leftBoundary=te.a.OLa(U);return b}zjc(){this.O9&&this.renderRuler()}bjc(){this.O9&&this.renderRuler()}iBk(){var a={};if(32!==this.ia.La(D.a.tIb,2,a))return Ba.a.J(512496001,824,10,"Unable to read paragraph indentation for Ruler"),null;const b={type:"FirstLineIndent"},c={type:"HangingIndent"},h={type:"LeftIndent"};
a=a.VA;if(!a)return Ba.a.J(512496E3,824,10,"indentInfo is null"),null;b.value=1===a.specialIndentType?te.a.OLa(a.xMb+a.LN):2===a.specialIndentType?te.a.OLa(a.LN-a.xMb):te.a.OLa(a.LN);c.value=te.a.OLa(a.LN);h.value=te.a.OLa(a.LN);return[b,c,h]}wpk(a,b){const c=new sR.a;c.Vf=1;c.value=te.a.Ita(b);this.QAj(a,c)}QAj(a,b){var c=this.pa.m_();if(a&&b&&c){var h=window.performance.now(),m=this.Jb.le(15);m.nc(c);c=8;switch(a){case "FirstLineIndent":c=this.ia.La(M.a.sLb,2,b);m.jd=M.a.sLb;break;case "HangingIndent":c=
this.ia.La(M.a.uLb,2,b);m.jd=M.a.uLb;break;case "LeftIndent":c=this.ia.La(M.a.mka,2,b);m.jd=M.a.mka;break;default:Ba.a.J(512495970,824,10,"IndentChangeHandler called with invalid type")}m.dispose();b=window.performance.now();Ba.a.J(512495969,824,15,"Indent type:{0} indentChangeDuration: {1}",a,(b-h).toString());32!==c&&Ba.a.J(512495968,824,10,"Indent operation: {0} failed",c)}else Ba.a.J(512495971,824,10,"IndentChangeHandler called with invalid params")}HJ(){this.ANd();this.O9=!0;this.Qb.isf(Object(F.a)(this,
this.renderRuler,"renderRuler"));wd.a.addHandler(this.Ghc,ra.a.scroll,Object(F.a)(this,this.ulb,"updateRulerLocation"));this.qd.XFc(Object(F.a)(this,this.bjc,"onCloseTextEditView"));this.qd.UXb(Object(F.a)(this,this.zjc,"onOpenTextEditView"));this.uJ.EFc(this.axa)}ulb(){if(this.O9){var a=this.Kc.Ic;a&&a.BB&&window.requestAnimationFrame(()=>{const b=qd.a.d9a(a.BB),c=qd.a.d9a(this.qIa);this.p4.style.marginLeft=this.He.Pc(b.x-c.x+1)})}else Ba.a.J(512495967,824,10,"UpdateRulerLocation called with cookie value false")}JQi(){if(this.fJ)return this.fJ;
this.fJ=document.createElement("div");this.fJ.id="WACHorizontalRulerContainer";this.fJ.className="WACHorizontalRulerContainer";this.fJ.setAttribute(zc.a.gs,"ruler");this.fJ.setAttribute(zc.a.af,zc.a.LBa);Sys.UI.DomElement.addCssClass(this.fJ,"HideWACHorizontalRulerContainer");return this.fJ}KQi(){if(this.p4)return this.p4;this.p4=document.createElement("div");this.p4.className="WACHorizontalRuler";this.p4.id="WACHorizontalRuler";return this.p4}ANd(){this.fJ=this.JQi();this.fJ.appendChild(this.KQi());
this.qIa.insertBefore(this.fJ,this.qIa.firstChild)}}Object(n.a)(YE,"HorizontalRuler",null,[228]);class ZE{constructor(a,b,c,h,m){this.dKj=!0;if(!a)throw Error.argumentNull("actionManager");if(!b)throw Error.argumentNull("activeAppFrame");if(!c)throw Error.argumentNull("rulerFactory");if(!h)throw Error.argumentNull("horizontalRuler");if(!m)throw Error.argumentNull("verticalRuler");this.ia=a;this.Qb=b;this.ERg=c;this.S4c=h;this.Lad=m}vb(){this.ia.ra(M.a.upd,xb.a.application,Object(F.a)(this,this.upd,
"showHideRuler"),4);this.ia.ra(M.a.fid,xb.a.application,Object(F.a)(this,this.fid,"queryRulerToggle"),96)}QBj(){this.OZc()&&(Ba.a.J(523351431,824,15,"Ruler init is called"),this.ERg.jcg())}upd(a,b,c){return this.OZc()?this.Txj(c):this.chl(c)}SGh(){this.Qb.mG({ShowHideRuler:"ToggleButtonModel"})}chl(a){if(1===a)return 32;Ba.a.J(523351432,824,15,"ShowRuler called");this.ERg.jcg();this.Lqh(!0);this.Qb.Mq();this.SGh();return 32}Txj(a){if(1===a)return 32;Ba.a.J(523351433,824,15,"HideRuler called");this.BMi();
this.Lqh(!1);this.Qb.Mq();this.SGh();return 32}BMi(){this.OZc()&&(this.S4c.dispose(),this.Lad.dispose(),this.Qb.Mq())}fid(a,b,c,h,m){if(1===c)return 32;m&&(m[Zh.a.On]=this.OZc());return 32}OZc(){return oi.a.n8(Vy.a.wah,this.dKj)}Lqh(a){oi.a.SJ(u.AFrameworkApplication.fa.Ha("IsRulerOnCookieName"),a.toString(),oi.a.wJ)}}Object(n.a)(ZE,"RulerActor",null,[]);class PO{constructor(a,b,c){if(!a)throw Error.argumentNull("horizontalRuler");if(!b)throw Error.argumentNull("verticalRuler");if(!c)throw Error.argumentNull("appFrame");
this.S4c=a;this.Lad=b;this.Qb=c}jcg(){this.S4c.HJ();this.Lad.HJ();this.Qb.Mq();this.S4c.renderRuler();this.Lad.renderRuler()}}Object(n.a)(PO,"RulerFactory",null,[190]);class Dq{constructor(a,b,c,h,m,y,G,U,ja,va,Ta,fb,Db,gc){this.YRd="HideWACVerticalRulerContainer";this.Xzf="ShowWACVerticalRulerContainer";this.Sla=this.O9=!1;this.c5=this.tJ=null;this.axa=()=>{this.O9&&this.renderRuler()};if(!a)throw Error.argumentNull("appFrame");if(!b)throw Error.argumentNull("activeSlideViewManager");if(!c)throw Error.argumentNull("browserHelper");
if(!m)throw Error.argumentNull("selectionManager");if(!y)throw Error.argumentNull("shapeReader");if(!G)throw Error.argumentNull("pageView");if(!U)throw Error.argumentNull("slideDimensionsHelper");if(!ja)throw Error.argumentNull("presentationReader");if(!va)throw Error.argumentNull("pptPageView");if(!Ta)throw Error.argumentNull("applicationSettings");if(!fb)throw Error.argumentNull("viewElementEventHandlers");if(!Db)throw Error.argumentNull("viewCoreEventHandlers");this.Qb=a;this.Kc=b;this.He=c;this.qIa=
h;this.pa=m;this.Fb=G;this.qc=ja;this.Zt=gc;this.ny=U;this.Ifc=va;this.jze=Ta.Nlh;this.lze=Ta.Mlh;this.qd=fb;this.uJ=Db}get Ghc(){return document.getElementById(I.AppFrame.DIh)}dispose(){this.O9=!1;wd.a.removeHandler(this.Ghc,ra.a.scroll,Object(F.a)(this,this.ulb,"updateRulerLocation"));this.Qb.Jhh(Object(F.a)(this,this.renderRuler,"renderRuler"));this.qd.rPe(Object(F.a)(this,this.bjc,"onCloseTextEditView"));this.qd.okd(Object(F.a)(this,this.zjc,"onOpenTextEditView"));this.uJ.ekd(this.axa);this.tJ&&
this.c5?(La.a.XJa(this.tJ,this.Xzf),La.a.sI(this.tJ,this.YRd),fj.UISurfaces.cTc().then(a=>{a.dispose(this.c5);return null}),this.tJ.removeChild(this.c5),this.qIa.removeChild(this.tJ),this.c5=this.tJ=null):Ba.a.J(512495966,824,50,"Ruler container div / Ruler div null")}renderRuler(){const a=window.performance.now();if(this.tJ&&this.c5){La.a.XJa(this.tJ,this.YRd);La.a.sI(this.tJ,this.Xzf);var b=this.Kc.Ic;if(b&&b.Fd){var c=b.Fd;c=new cr.a(c.oq,c.Wk);b=this.ny.E5b(c,b.kca?b.kca.xa.style.visibility===
Mi.a.visible:!1).height;c=this.He.ii(this.Kc.Ic.BB).height;if(1===this.Ifc.Sl||0>=b||0>=c)Ba.a.J(512495963,824,50,"Ruler should not be rendered");else{var h={};h.rulerCanvasProps=this.kBk($d.a.rfa(b,1));h.rtl=this.Sla?!this.Zt:this.Zt;h.inverted=this.Sla?!this.Zt:this.Zt;this.c5.style.height=this.He.Pc(b);this.ulb(null);fj.UISurfaces.cTc().then(m=>{m.renderRuler(this.c5,h);return null});b=window.performance.now();Ba.a.J(512495962,824,15,"VerticalRenderRulerDuration:{0}",(b-a).toString())}}else Ba.a.J(512495964,
824,50,"Unable to get slideViewElement")}else Ba.a.J(512495965,824,50,"Ruler container div / Ruler div null")}kBk(a){const b={},c=te.a.Jv(this.qc.Pn.eb(X.a.slideHeight));var h=a/2;let m=0;a=$d.a.XJ(a,0);b.zeroScale=$d.a.XJ(h,0);this.Sla=!1;b.textEditableArea=!1;if(this.pa.O8()&&!this.pa.JUa()){h=this.pa.m_();var y=h.sc(this.Fb.Ma);const U=y.htmlElement.querySelector(".ShapeViewContent");var G=y.rotation;G>this.jze&&G<this.lze&&(this.Sla=!0);G=0;h.Kg&&(G=h.rs().sc(this.Fb.Ma).htmlElement.offsetTop);
G+=y.htmlElement.offsetTop+U.parentNode.offsetTop+U.offsetTop;y=G+U.offsetHeight;h=(this.Sla?!this.Zt:this.Zt)?y:G;G>=m&&G<=a&&y>=m&&y<=a&&(m=G,a=y,b.zeroScale=h,b.textEditableArea=!0)}b.precision=.0625;b.topMargin=m;b.bottomMargin=a;b.rulerType="Vertical";b.scale=c;return b}HJ(){this.ANd();this.O9=!0;wd.a.addHandler(this.Ghc,ra.a.scroll,Object(F.a)(this,this.ulb,"updateRulerLocation"));this.Qb.isf(Object(F.a)(this,this.renderRuler,"renderRuler"));this.qd.XFc(Object(F.a)(this,this.bjc,"onCloseTextEditView"));
this.qd.UXb(Object(F.a)(this,this.zjc,"onOpenTextEditView"));this.uJ.EFc(this.axa)}ulb(){if(this.O9){var a=this.Kc.Ic;a&&a.BB&&window.requestAnimationFrame(()=>{const b=qd.a.d9a(a.BB),c=qd.a.d9a(this.qIa);this.c5.style.marginTop=this.He.Pc(b.y-c.y+1)})}else Ba.a.J(512495961,824,10,"UpdateRulerLocation called with cookie value false")}zjc(){this.O9&&this.renderRuler()}bjc(){this.O9&&this.renderRuler()}ANd(){this.tJ=this.GRi();this.tJ.appendChild(this.HRi());this.qIa.insertBefore(this.tJ,this.qIa.firstChild)}GRi(){if(this.tJ)return this.tJ;
this.tJ=document.createElement("div");this.tJ.id=Dq.Bmi;this.tJ.className=Dq.Ami;this.tJ.setAttribute(zc.a.gs,"ruler");this.tJ.setAttribute(zc.a.af,zc.a.LBa);Sys.UI.DomElement.addCssClass(this.tJ,this.YRd);return this.tJ}HRi(){if(this.c5)return this.c5;this.c5=document.createElement("div");this.c5.className=Dq.zmi;this.c5.id=Dq.Cmi;return this.c5}}Dq.Bmi="WACVerticalRulerContainer";Dq.Ami="WACVerticalRulerContainer";Dq.Cmi="WACVerticalRuler";Dq.zmi="WACVerticalRuler";Object(n.a)(Dq,"VerticalRuler",
null,[228]);class $E{constructor(){this.K=null}get name(){return"PowerPointWebEditor.Ruler"}$b(a){this.K=a}init(){if(this.K.resolve("PowerPointWebEditor.IApplicationSettings").Iib){var a=this.K.resolve("PowerPointWebEditor.AppFrame");this.K.register(YE,"PowerPointWebEditor.Ruler.HorizontalRuler").ma().oa(()=>new YE(a,this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.K.resolve("PowerPoint.IBrowserHelperManager"),a?a.luc:null,this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),
this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("Box4.IPageView"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.ISlideDimensionsHelper"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("PowerPointWebEditor.ViewCore.IViewCoreEventHandlers"),
u.AFrameworkApplication.isRtl));this.K.register(Dq,"PowerPointWebEditor.Ruler.VerticalRuler").ma().oa(()=>new Dq(a,this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.K.resolve("PowerPoint.IBrowserHelperManager"),a?a.luc:null,this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("Box4.IPageView"),this.K.resolve("PowerPointWebEditor.ISlideDimensionsHelper"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),
this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("PowerPointWebEditor.ViewCore.IViewCoreEventHandlers"),u.AFrameworkApplication.isRtl));this.K.register(190,"PowerPointWebEditor.Ruler.IRulerFactory").ma().oa(()=>new PO(this.K.resolve("PowerPointWebEditor.Ruler.HorizontalRuler"),this.K.resolve("PowerPointWebEditor.Ruler.VerticalRuler"),a));this.K.register(ZE,
"PowerPointWebEditor.Ruler.RulerActor").ma().oa(()=>new ZE(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Box4.IAppFrame"),this.K.resolve("PowerPointWebEditor.Ruler.IRulerFactory"),this.K.resolve("PowerPointWebEditor.Ruler.HorizontalRuler"),this.K.resolve("PowerPointWebEditor.Ruler.VerticalRuler")));this.K.resolve("PowerPointWebEditor.Ruler.RulerActor").vb();Ja.a.get_instance().Dk(8,()=>{this.ZEe()})}}ZEe(){this.K.resolve("PowerPointWebEditor.Ruler.RulerActor").QBj()}dispose(){}static main(){r.a.instance.Dc(new $E)}}
Object(n.a)($E,"PPTWebEditorRulerPackage",null,[2,3]);class lA{static get XFl(){return lA.YFl}}lA.YFl="<div class='WACZoomDialogRadioRow' id='ZoomDlgBlock{0}'> <input type='radio' id='radiobox{0}' name='{2}' class='WACDialogRadio' alt='{1}' title='{1}'></input> <label id='ZoomDlgList{0}' class='WACDialogLabel' for='radiobox{0}' >{1}</label> </div>";Object(n.a)(lA,"ZoomDialogHtml",null,[]);class Yx extends Nh.a{constructor(a,b,c,h,m=!1){super(!1,!1,m);this.lXb=this.kXb=this.Da=this.Tuc=null;this.SFl=
"ZoomDialogBoxGroup";this.cPa=a;this.JEc=b;this.lpf=c;this.Od=h;this.qg=this.bji();this.xd=1;this.ig="ZoomDialog"}get cNe(){return"ListRadioBox"}get Vmc(){return"radiobox"}get ndh(){return"WACZoomDialogRadioRow"}get bNe(){return"WACZoomDialogRadioRow-highlight"}get Jo(){return this.Od}get u7(){return this.Tuc}Ivh(a,b){if(this.DK)this.Lhl(a,b);else{const c={};for(let h=0;h<this.cPa.length;h++)c[this.Vmc+h]=this.JEc[h]===b?!0:!1;this.$i(a,Object(F.a)(this,this.UFl,"zoomDialogHandler"),c);this.ENe();
this.mOe()}}Lhl(a,b){var c=Array(this.cPa.length);let h="";for(let m=0;m<this.cPa.length;m++){const y=m.toString();c[m]={["key"]:y,["text"]:this.cPa[m]};b===this.JEc[m]&&(h=y)}b={};b.dialogChoiceGroupProps={["id"]:this.SFl,["defaultSelectedKey"]:h,["options"]:c};c={["id"]:"OptionsDialog",["bodyControls"]:b};this.$i(a,Object(F.a)(this,this.ZFl,"zoomDialogReactHandler"),c)}b2k(){this.Tuc=document.getElementsByName(this.cNe)[0];this.xPc(this.u7)}I7(){this.Da||(this.Da=document.getElementById("WACDialogText"));
this.Da&&(this.kXb||(this.kXb=Object(F.a)(this,this.TFl,"zoomDialogClickHandler"),this.vn.pb(ra.a.click,this.Da,this.kXb)),this.lXb||(this.lXb=Object(F.a)(this,this.VFl,"zoomDialogKeyDownHandler"),this.Pg.pb(ra.a.Zf,this.Da,this.lXb)));super.I7();this.Gb&&this.Pg.pb(ra.a.Hl,this.Gb,Object(F.a)(this,this.sN,"dialogDefaultEnterKeyHandler"))}ENe(){this.Jo.yl().scope.Ap(C.FocusManager.instance().Eqa);this.Jo.yl().scope.Ap(C.FocusManager.instance().Fqa);this.Jo.yl().scope.bindAction(C.FocusManager.instance().Eqa,
H.a.uuc);this.Jo.yl().scope.bindAction(C.FocusManager.instance().Fqa,H.a.tuc)}mOe(){const a=document.getElementsByName(this.cNe);for(let b=0;b<a.length;b++){const c=a[b];wd.a.addHandler(c,ra.a.focus,Object(F.a)(this,this.Rid,"radioButtonFocusHandler"));c.checked&&(this.Tuc=c)}}UFl(a,b){if(1===a)for(a=0;a<this.cPa.length;a++)if(b[this.Vmc+a]){this.lpf(this.JEc[a]);break}}Rid(a){this.xPc(a.target)}TFl(a){a=a.Cc;if(!a||!a.parentNode||"label"!==a.tagName.toLowerCase()&&!a.className.startsWith(this.ndh))return!1;
a=this.A0f(a);a=document.getElementById(this.Vmc+a);this.xPc(a);return!0}ZFl(a,b){1===a&&(a=Number.parseInvariant(b.selectedOption.toString()),this.lpf(this.JEc[a]))}VFl(a){a=a.pc.keyCode;if(a!==Sys.UI.Key.down&&a!==Sys.UI.Key.right&&a!==Sys.UI.Key.up&&a!==Sys.UI.Key.left)return!1;let b=this.A0f(this.u7);const c=this.cPa.length-1;if(a===Sys.UI.Key.down||a===Sys.UI.Key.right)b=b<c?b+1:0;else if(a===Sys.UI.Key.up||a===Sys.UI.Key.left)b=0<b?b-1:c;a=document.getElementById(this.Vmc+b);this.xPc(a);return!0}sN(a){return a.eventName===
ra.a.Hl&&a.pc.keyCode===Sys.UI.Key.enter?(super.sN(a),!0):!1}xPc(a){a&&(a.checked=!0,this.Jo.Be&&this.Jo.Be.name===this.aL||this.Jo.xf(this.aL),this.Jo.yl().uj.VE(a),a.focus(),this.u7&&Sys.UI.DomElement.removeCssClass(this.u7.parentNode,this.bNe),Sys.UI.DomElement.addCssClass(a.parentNode,this.bNe),this.Tuc=a)}A0f(a){return Number.parseInvariant(ta.a.substr(a.id,a.id.length-1,1))}tA(){super.tA();const a=document.getElementById(this.Nh("WACDialogPanel"));a.style.minWidth=String.format("{0}px",200);
a.style.width=String.format("{0}px",200)}bji(){let a="";for(let b=0;b<this.cPa.length;b++)a+=Nh.a.gC(Yx.WFl,b.toString(),this.cPa[b],this.cNe);return a}dispose(){this.Da&&(this.vn&&this.kXb&&this.vn.yb(ra.a.click,this.Da,this.kXb),this.Pg&&this.lXb&&this.Pg.yb(ra.a.Zf,this.Da,this.lXb));this.vn&&this.Gb&&this.Pg.yb(ra.a.Hl,this.Gb,Object(F.a)(this,this.sN,"dialogDefaultEnterKeyHandler"));super.dispose()}}Yx.WFl=lA.XFl;Object(n.a)(Yx,"ZoomDialog",Nh.a,[263]);class aF{constructor(){this.zf=null}create(a,
b,c,h){return this.zf=new Yx(a,b,c,h)}}Object(n.a)(aF,"ZoomDialogFactory",null,[247]);class bF{constructor(){this.Da=null}get name(){return"Common.App.Zoom"}init(){}dispose(){}$b(a){this.Da=a;this.Da.register(aF,"Common.App.Zoom.ZoomDialogFactory").as("Common.App.Zoom.IZoomDialogFactory").oa(()=>new aF).ma()}static main(){r.a.instance.Dc(new bF)}}Object(n.a)(bF,"ZoomPackage",null,[2,3]);class QO{constructor(a,b,c,h,m,y,G){this.vek=[ResourceStrings.L_ZoomDialogFit,"400%","200%","150%","100%","66%",
"50%","33%"];this.bbd="fittowindow 4 2 1.5 1 0.66 0.5 0.33".split(" ");this.zf=null;this.ia=a;this.Fa=b;this.qc=m;this.gj=c;this.Qb=h;this.Hk=y;this.jqg=G}vb(){this.ia.ra(M.a.YMe,nc.a.application,Object(F.a)(this,this.bIk,"queryZoom"),96);this.ia.ya(M.a.zHe,nc.a.application,Object(F.a)(this,this.Jvj,"handleZoomConfig"));this.ia.ya(M.a.vuc,nc.a.application,Object(F.a)(this,this.Kvj,"handleZoomToFit"));this.ia.ya(H.a.uuc,he.a.frame,Object(F.a)(this,this.CJh,"zoomDialogTabFocusHandler"));this.ia.ya(H.a.tuc,
he.a.frame,Object(F.a)(this,this.CJh,"zoomDialogTabFocusHandler"));u.AFrameworkApplication.fa.ka("ZoomSliderIsEnabled")&&(this.ia.ya(H.a.Ltb,he.a.frame,Object(F.a)(this,this.Ltb,"decreaseZoom")),this.ia.ya(H.a.Mxb,he.a.frame,Object(F.a)(this,this.Mxb,"increaseZoom")),this.ia.ya(H.a.aGl,he.a.frame,Object(F.a)(this,this.Fuk,"onZoomToPercentage")),this.ia.ra(H.a.cIk,he.a.frame,Object(F.a)(this,this.Hrk,"onQueryZoomPercentage"),96),Rd.a("ZoomShortCutsEnabled")&&(this.ia.ya(D.a.wJf,he.a.frame,ed.ActionManager.Jg),
this.ia.ya(D.a.vJf,he.a.frame,ed.ActionManager.Jg)))}De(){if(u.AFrameworkApplication.fa.ka("ZoomSliderIsEnabled")&&Rd.a("ZoomShortCutsEnabled")){const a=this.Fa.Gc(Ua.a.nj);a.bindAction(w.KeyInputManager.Na(z.a.dud,w.KeyInputManager.Le),H.a.Mxb);a.bindAction(w.KeyInputManager.Na(z.a.gud,w.KeyInputManager.Le),H.a.Mxb);a.bindAction(w.KeyInputManager.Na(z.a.eud,w.KeyInputManager.Le),H.a.Ltb);a.bindAction(w.KeyInputManager.Na(z.a.Ztc,w.KeyInputManager.Le),H.a.Ltb);this.jqg&&ha.a.instance.pb(ra.a.yFb,
this.jqg,Object(F.a)(this,this.Fbi,"adjustZoomOnMouseWheel"))}}Fbi(a){return a?a.XZ?(0<a.WIh?this.YLa(this.p_g):0>a.WIh&&this.YLa(this.q_g),!0):!1:!1}get m7a(){return Math.round(100*this.gj.OU)}get q_g(){return Math.floor(this.m7a/10)/10+.1}get p_g(){return Math.ceil(this.m7a/10)/10-.1}bIk(a,b,c,h,m){if(!m||Rd.a("ZoomPercentageNaNBugFixEnabled")&&(isNaN(this.m7a)||0==this.m7a))return 8;m[$D.a.LabelText]=Math.round(100*this.gj.OU)+"%";this.Hk&&(this.Hk.L$(this.Hk.r0a,this.Hk.DJh),this.Hk.J$(this.Hk.r0a,
this.Hk.DJh));return 32}Jvj(a,b,c,h,m){if(1===c)return this.qc.Lj()?32:8;if(!m)return 8;this.zf=new Yx(this.vek,this.bbd,Object(F.a)(this,this.Pud,"zoomSettingAction"),C.FocusManager.instance(),!0);this.zf.Ivh(CommonUIStrings.l_ZoomDialogTitle,this.gj.Bka?this.bbd[0]:this.gj.OU.toString());return 32}Pud(a){if(a!==this.bbd[0]){const b=parseFloat(a);if(isNaN(b)){Ba.a.J(512288459,827,10,"Invalid Zoom Value: {0}",a);return}this.gj.Bka=!1;this.gj.OU=b;this.gj.Klb=2}else this.gj.Bka=!0;this.Qb.Mq();Ba.a.J(512288458,
827,50,"Succeeded to Zoom: {0}",a)}Kvj(a,b,c,h,m){if(1===c)return this.qc.Lj()?32:8;if(!m)return 8;this.Pud(this.bbd[0]);return 32}CJh(a){if(!this.zf)return 8;var b=this.zf.Jo.yl().uj.$Z;if(b===this.zf.Qv&&a===H.a.uuc||b===this.zf.pD&&a===H.a.tuc)this.zf.u7||this.zf.b2k(),this.zf.Jo.yl().uj.VE(this.zf.u7);else if(b.id.startsWith(this.zf.Vmc)||b.className.startsWith(this.zf.ndh))b=null,a===H.a.uuc?b=this.zf.pD:a===H.a.tuc&&(b=this.zf.Qv),this.zf.Jo.yl().uj.VE(b),Sys.UI.DomElement.removeCssClass(this.zf.u7.parentNode,
this.zf.bNe);else if(a===H.a.uuc)this.zf.Jo.yl().BFb();else if(a===H.a.tuc)this.zf.Jo.yl().zFb();else return 16;return 32}Mxb(a,b,c){if(1===c)return 32;this.YLa(this.q_g);Ba.a.J(512288456,827,50,"Increase Zoom triggered via ZoomIn");return 32}Ltb(a,b,c){if(1===c)return 32;this.YLa(this.p_g);Ba.a.J(512288455,827,50,"Decrease Zoom triggered via ZoomOut");return 32}Fuk(a,b,c,h,m){if(1===c)return 32;a=m.value/100;this.YLa(a);Ba.a.J(512288454,827,50,"Zoom changed via zoom slider: {0}",a);h&&(h.eQ=Math.floor(100*
a));return 32}Hrk(a,b,c,h,m){if(Rd.a("ZoomPercentageNaNBugFixEnabled")&&(isNaN(this.m7a)||0==this.m7a))return 8;m.MinValue=10;m.MaxValue=400;m.value=this.m7a;return 32}YLa(a){.1>a?a=.1:4<a&&(a=4);this.gj.Bka=!1;this.gj.OU=a;this.gj.Klb=2;this.Qb.Mq()}}Object(n.a)(QO,"ZoomActor",null,[227]);class cF{constructor(){this.K=null}get name(){return"PowerPointWebEditor.Zoom"}$b(a){this.K=a}init(){var a=this.K.resolve("PowerPointWebEditor.AppFrame");const b=this.K.resolve("Common.IActionManagerExtended"),
c=this.K.resolve("PowerPointWebEditor.IFocusManager");a=new QO(b,c,this.K.resolve("PowerPointWebEditor.IZoomContext"),a,this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.IPPTRumTracker"),a.qPd);a.vb();a.De()}dispose(){}static main(){r.a.instance.Dc(new cF)}}Object(n.a)(cF,"PPTWebEditorZoomPackage",null,[2,3]);Type.registerNamespace("B4A11Y");Type.registerNamespace("B4Ac");Type.registerNamespace("B4AuC");Type.registerNamespace("B4Im");Type.registerNamespace("B4LE");
Type.registerNamespace("B4OLE");Type.registerNamespace("B4Proofing");Type.registerNamespace("B4TLE");Type.registerNamespace("B4TM");Type.registerNamespace("B4TaE");Type.registerNamespace("B4TaVE");Type.registerNamespace("B4UI");Type.registerNamespace("B4UndoRedo");Type.registerNamespace("B4Up");Type.registerNamespace("Box3");Type.registerNamespace("Box4");Type.registerNamespace("Box4.Clipboard");Type.registerNamespace("Box4.ContentEditable");Type.registerNamespace("Box4.Insights");Type.registerNamespace("Box4.ListMarker");
Type.registerNamespace("Box4.ListMarkerGallery");Type.registerNamespace("Box4.ParagraphRenderElements");Type.registerNamespace("Box4.Shortcuts");Type.registerNamespace("Box4.WordPrediction");Type.registerNamespace("Box4.WordPrediction.Telemetry");Type.registerNamespace("ColorPickerManager");Type.registerNamespace("Microsoft.Office.Infrared");Type.registerNamespace("PPTe");Type.registerNamespace("PowerPoint");Type.registerNamespace("PowerPointLive");Type.registerNamespace("PowerPointWebEditor");Type.registerNamespace("PowerPointWebEditor.Aria");
Type.registerNamespace("PowerPointWebEditor.Assistance");Type.registerNamespace("PowerPointWebEditor.AugmentationLoop");Type.registerNamespace("PowerPointWebEditor.AutoFit");Type.registerNamespace("PowerPointWebEditor.CoreExt");Type.registerNamespace("PowerPointWebEditor.DragDrop");Type.registerNamespace("PowerPointWebEditor.DynamicScriptLoader");Type.registerNamespace("PowerPointWebEditor.ErrorHandling");Type.registerNamespace("PowerPointWebEditor.EventTiming");Type.registerNamespace("PowerPointWebEditor.Fonts");
Type.registerNamespace("PowerPointWebEditor.GraphEditor");Type.registerNamespace("PowerPointWebEditor.GraphMerge");Type.registerNamespace("PowerPointWebEditor.HtmlExport");Type.registerNamespace("PowerPointWebEditor.Infrared");Type.registerNamespace("PowerPointWebEditor.ModernFontPicker");Type.registerNamespace("PowerPointWebEditor.Notes");Type.registerNamespace("PowerPointWebEditor.Paragraph");Type.registerNamespace("PowerPointWebEditor.PodsPops");Type.registerNamespace("PowerPointWebEditor.PowerPointFeedback");
Type.registerNamespace("PowerPointWebEditor.PresenterView");Type.registerNamespace("PowerPointWebEditor.Proofing");Type.registerNamespace("PowerPointWebEditor.Proofing.CloudAL");Type.registerNamespace("PowerPointWebEditor.ReplaceObject");Type.registerNamespace("PowerPointWebEditor.Ribbon");Type.registerNamespace("PowerPointWebEditor.Ruler");Type.registerNamespace("PowerPointWebEditor.ShapeEdit");Type.registerNamespace("PowerPointWebEditor.ShapeManipulation");Type.registerNamespace("PowerPointWebEditor.SlideShow");
Type.registerNamespace("PowerPointWebEditor.SmartArt");Type.registerNamespace("PowerPointWebEditor.SmartGuide");Type.registerNamespace("PowerPointWebEditor.Storage");Type.registerNamespace("PowerPointWebEditor.Table");Type.registerNamespace("PowerPointWebEditor.TableStyleEditor");Type.registerNamespace("PowerPointWebEditor.Telemetry");Type.registerNamespace("PowerPointWebEditor.TextEditing");Type.registerNamespace("PowerPointWebEditor.TextFormatting");Type.registerNamespace("PowerPointWebEditor.UI");
Type.registerNamespace("PowerPointWebEditor.UndoRedo");Type.registerNamespace("PowerPointWebEditor.UnifiedApp");Type.registerNamespace("PowerPointWebEditor.ViewEventHandler");Type.registerNamespace("PowerPointWebEditor.WebSocketFrontDoor");Type.registerNamespace("PowerpointPresence");Type.registerNamespace("TableCellMargin");Type.registerNamespace("PowerPointWebEditor.Zoom");window.g_hermesExtJS=Date.now();Q.main();fa.main();Xf.main();Ra.main();Em.main();fm.main();r.a.instance.Dc(new Gg);Jh.main();
Xd.main();kl.main();Ej.main();Hn.main();sn.main();Mj.main();Fo.main();sp.main();or.main();Ql.main();Yc.main();Type.registerNamespace("Common.App.AccountSwitching");Ae.main();Type.registerNamespace("Common.App.AltTextDialog");Type.registerNamespace("Common.App.ChromeExtensionHelper");Type.registerNamespace("CommonUI");Type.registerNamespace("Common.App.HostNotification");sk.main();Type.registerNamespace("Common");Ck.main();Type.registerNamespace("Common.App.FirstRunExperienceLauncher");mt.main();Type.registerNamespace("Common.App.ImageProcessor");
Type.registerNamespace("Common.App.NewAndOpen.Core");r.a.instance.Dc(new $v);Type.registerNamespace("Common");Type.registerNamespace("Common.App.People");Bu.main();sw.main();ss.main();Type.registerNamespace("Common.App.People");dv.main();Type.registerNamespace("Common");Type.registerNamespace("Common.App.OpenInClient");window.MSOJS=fq;Ff.main();Type.registerNamespace("Common");r.a.instance.Dc(new wo);Type.registerNamespace("CAUI");Vo.main();Type.registerNamespace("Common.App.SaveStatus");r.a.instance.Dc(new gF);
Type.registerNamespace("Fdbk");Type.registerNamespace("Common.App.CustomerFeedback");d(1125).CustomerFeedbackPackage.main();Type.registerNamespace("Common.App.Zoom");bF.main();window.PPTUserInitiatedSurveysDictionary_FromAppPackage={PPTIdeasSurvey:{campaignId:"00832D36-A8AF-4883-B8C2-7FD77D1E3829",commentQuestion:"Why did you choose that answer?",isZeroBased:!1,promptQuestion:"Not Used",promptNoButtonText:"Not Used",promptYesButtonText:"Not Used",ratingQuestion:"Overall how do you feel while using Ideas to get suggestions for improving your slides?",
ratingValuesAscending:["Extremely negative","Somewhat negative","Neither negative nor positive","Somewhat positive","Extremely positive"],showPrompt:!1,surveyType:4,title:"Thanks for using Ideas"},PPTRehearsePresentationSurvey:{campaignId:"2c3d6424-b363-4328-8dec-a07edda7a808",commentQuestion:"Why did you choose that answer?",isZeroBased:!1,promptQuestion:"Not Used",promptNoButtonText:"Not Used",promptYesButtonText:"Not Used",ratingQuestion:"Overall, how do you feel while using Presenter Coach?",
ratingValuesAscending:["Extremely negative","Somewhat negative","Neither negative nor positive","Somewhat positive","Extremely positive"],showPrompt:!1,surveyType:4,title:"Thanks for using Presenter Coach"},TellMeSurvey:{campaignId:"e55e81b0-5645-4111-b08e-18d7cdaf2bef",commentQuestion:"Please tell us more. Why did you choose that answer?",isZeroBased:!1,promptQuestion:"We have two questions for you.",promptNoButtonText:"Not now",promptYesButtonText:"Sure",ratingQuestion:"How satisfied are you with using Microsoft Search in PowerPoint?",
ratingValuesAscending:["Very dissatisfied","Dissatisfied ","Neutral","Satisfied","Very satisfied"],showEmailRequest:!0,showPrompt:!1,surveyType:4,title:"We'd love your feedback on Microsoft Search in PowerPoint"}};oA.main();Type.registerNamespace("CommandUI");Type.registerNamespace("CommandUI.Controls");Type.registerNamespace("CommandUI");Type.registerNamespace("CommandUI.React");pA.main();xA.main();zA.main();AA.main();BA.main();CA.main();HA.main();IA.main();QA.main();window.PowerPointEditingJewelRibbonData=
{name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"Jewel",attrs:{Alt:"STR@L_JewelText",Id:"PptJewel",DefaultSelection:"PptJewel.Open",TextDirection:"STR@L_TextDirection",LabelText:"STR@L_JewelText",Keytip:"STR@l_JewelTextKeytip"},children:[{name:"Menu",attrs:{Id:"PptJewel.Menu"},children:[{name:"MenuSection",attrs:{Id:"PptJewel.PrimaryMenu",DisplayMode:"Menu32"},children:[{name:"Controls",attrs:{Id:"PptJewel.PrimaryMenu.Controls"},children:[{name:"Button",
attrs:{Alt:"STR@L_CloseMenu",Id:"jbtnBackArrow",Image32by32:"IMGMAP@prt2@CloseFileMenuPowerPoint_32x32x32",Command:"0x2F9A3D80"}},{name:"FlyoutAnchor",attrs:{Id:"PptJewel.Info",LabelText:"STR@L_Info",Command:"0x2F9A3D80",Keytip:"STR@l_InfoKeytip"},children:[{name:"Menu",attrs:{Id:"PptJewel.Info.Menu"},children:[{name:"MenuSection",attrs:{DisplayMode:"MenuFileName",Title:"STR@L_Info",ShowMenuSectionSeparator:"false"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblBreadcrumbDocName",
QueryCommand:"0xE55B9734",LabelText:""}}]}]},{name:"MenuSection",attrs:{DisplayMode:"Menu48",ShowMenuSectionSeparator:"false"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"PptJewel.Info.OpenInClient",LabelText:"STR@L_OpenInPowerPoint",Description:"STR@L_OpenInPowerPointDescription",Image48by48:"IMGMAP@prt2@PowerPoint_48x48x32",Command:"0xD5DF198A",Keytip:"STR@l_EditInPowerPointKeytip"}},{name:"Button",attrs:{Id:"PptJewel.Info.VersionHistory",LabelText:"STR@L_FileHistory",
Description:"STR@L_FileHistoryDescription",Image48by48:"IMGMAP@prt2@History_48x48x32",Command:"0x1BD57F1B",Keytip:"STR@l_FileVersionKeytip"}},{name:"Button",attrs:{Id:"PptJewel.Info.FileVersion",LabelText:"STR@L_FileVersion",Description:"STR@L_FileVersionDescription",Image48by48:"IMGMAP@prt2@Versions_48x48x32",Command:"0xFF30AFCC",Keytip:"STR@l_FileVersionKeytip"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptJewel.New",LabelText:"STR@L_New",Command:"0x2F9A3D80",PopulateDynamically:"true",PopulateOnlyOnce:"false",
AllowDefaultContent:"true",PopulateQueryCommand:"0x7BA0BBA5",Keytip:"STR@l_NewKeytip"},children:[{name:"Menu",attrs:{Id:"menuJewelNew"},children:[{name:"MenuSection",attrs:{Id:"menuLoadingNew",DisplayMode:"MenuLoading",Title:"STR@L_New"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblNewButtonsLoading"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptJewel.Open",LabelText:"STR@L_Open",Command:"0x2F9A3D80",PopulateDynamically:"true",PopulateOnlyOnce:"false",AllowDefaultContent:"true",
PopulateQueryCommand:"0xA6D756C7",Keytip:"STR@l_OpenKeytip"},children:[{name:"Menu",attrs:{Id:"menuJewelOpen"},children:[{name:"MenuSection",attrs:{Id:"menuLoadingMru",DisplayMode:"MenuLoading",Title:"STR@L_Open"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblMruButtonsLoading"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptJewel.Rename",LabelText:"STR@L_RenameButtonTitle",Command:"0x2F9A3D80",Keytip:"STR@l_RenameButtonTitleKeytip"},children:[{name:"Menu",attrs:{Id:"PptJewel.Rename.Menu"},
children:[{name:"MenuSection",attrs:{DisplayMode:"Menu48",Title:"STR@L_RenameButtonTitle"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"PptJewel.Rename.RenameDialog",LabelText:"STR@L_RenameButtonTitle",Description:"STR@L_RenameButtonDescription",Image48by48:"IMGMAP@prt2@RenameColumn_48x48x32",Command:"0x8E08F41F",Keytip:"STR@l_RenameButtonTitleKeytip"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptJewel.SaveACopy",LabelText:"STR@L_SaveACopy",Command:"0x2F9A3D80",Keytip:"STR@l_SaveAsKeytip"},
children:[{name:"Menu",attrs:{Id:"PptJewel.SaveACopy.Menu"},children:[{name:"MenuSection",attrs:{DisplayMode:"Menu48",Title:"STR@L_SaveACopy"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"PptJewel.SaveACopy.SaveACopy",LabelText:"STR@L_SaveACopy",Description:"STR@L_SaveAsButtonDescription",Image48by48:"IMGMAP@prt2@SaveAs_48x48x32",Command:"0x72B6A68C",Keytip:"STR@l_SaveAsKeytip"}},{name:"Button",attrs:{Id:"PptJewel.SaveACopy.SaveAsToHost",LabelText:"STR@L_SaveACopy",Description:"STR@L_SaveACopyOnline",
Image48by48:"IMGMAP@prt2@SaveAs_48x48x32",Command:"0xB8A8271F",Keytip:"STR@l_SaveAsKeytip"}},{name:"Button",attrs:{Id:"PptJewel.SaveACopy.SaveToSharePoint",LabelText:"STR@L_SaveACopy",Description:"STR@L_SaveACopyOnline",Image48by48:"IMGMAP@prt2@SaveAs_48x48x32",Command:"0xBAA2DFAC",Keytip:"STR@l_SaveAsKeytip"}}]}]},{name:"MenuSection",attrs:{Id:"SaveAsInformationMenuSection",ShowMenuSectionSeparator:"false",DisplayMode:"MenuSaveButton"},children:[{name:"Controls",attrs:{},children:[{name:"Label",
attrs:{Id:"PptJewel.SaveACopy.WheresTheSaveButton",LabelText:"STR@L_WheresTheSaveButton",Description:"STR@L_WheresTheSaveButtonDescription"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptJewel.Print",LabelText:"STR@L_Print",Command:"0x2F9A3D80",Keytip:"STR@l_PrintKeytip"},children:[{name:"Menu",attrs:{Id:"PptJewel.Print.Menu"},children:[{name:"MenuSection",attrs:{DisplayMode:"Menu48",Title:"STR@L_Print"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"PptJewel.Print.PrintToPdf",
LabelText:"STR@L_Print",Description:"STR@L_PrintDescription",Image48by48:"IMGMAP@prt2@Print_48x48x32",Command:"0x5EAF6CA5",Keytip:"STR@l_PrintToPdfKeytip"}},{name:"Button",attrs:{Id:"PptJewel.Print.PrintFullSlide",LabelText:"STR@L_PrintFullSlide",Description:"STR@L_PrintFullSlideDescription",Image48by48:"IMGMAP@prt2@HandoutsLandscapeSlides_48x48x32",Command:"0x5EAF6CA5",Keytip:"STR@l_PrintToPdfKeytip"}},{name:"Button",attrs:{Id:"PptJewel.Print.PrintNotes",LabelText:"STR@L_PrintNotes",Description:"STR@L_PrintNotesDescription",
Image48by48:"IMGMAP@prt2@HandoutsPortraitNotesLandscapePaper_48x48x32",Command:"0x108EE012",Keytip:"STR@l_PrintToPdfKeytip"}},{name:"Button",attrs:{Id:"PptJewel.Print.PrintHandouts",LabelText:"STR@L_PrintHandouts",Description:"STR@L_PrintHandoutsDescription",Image48by48:"IMGMAP@prt2@HandoutsPortraitOnPortrait3_48x48x32",Command:"0x866D929F",Keytip:"STR@l_PrintToPdfKeytip"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptJewel.Share",LabelText:"STR@L_Share",Command:"0x2F9A3D80",Keytip:"STR@l_ShareKeytip"},
children:[{name:"Menu",attrs:{Id:"PptJewel.Share.Menu"},children:[{name:"MenuSection",attrs:{DisplayMode:"Menu48",Title:"STR@L_Share"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"PptJewel.Share.ShareWithPeople",LabelText:"STR@L_ShareWithPeople",Description:"STR@L_ShareWithPeopleDescription",Image48by48:"IMGMAP@prt2@ShareDoc_48x48x32",Command:"0x3A7DFAA4",Keytip:"STR@l_ShareWithPeopleKeytip"}},{name:"Button",attrs:{Id:"PptJewel.Share.Embed",LabelText:"STR@L_Embed",Description:"STR@L_EmbedDescription",
Image48by48:"IMGMAP@prt2@EmbedDocument15_48x48x32",Command:"0x3A7B8B90",Keytip:"STR@l_EmbedKeytip"}},{name:"Button",attrs:{Id:"PptJewel.Share.ReplyWithChanges",LabelText:"STR@L_ReplyWithChanges",Description:"STR@L_ReplyWithChangesDescription",Image48by48:"IMGMAP@prt2@SendAsLink_48x48x32",Command:"0x4759B1F9",Keytip:"STR@l_ReplyWithChangesKeytip"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptJewel.DownloadAs",LabelText:"STR@L_DownloadAs",Command:"0x2F9A3D80",Keytip:"STR@l_DownloadAsKeytip"},children:[{name:"Menu",
attrs:{Id:"PptJewel.DownloadAs.Menu"},children:[{name:"MenuSection",attrs:{DisplayMode:"Menu48",Title:"STR@L_DownloadAs"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"PptJewel.DownloadAs.DownloadACopy",LabelText:"STR@L_DownloadCopy",Description:"STR@L_DownloadCopyDescription",Image48by48:"IMGMAP@prt2@SaveAsPowerPointPptx_48x48x32",Command:"0xD3EF8F78",Keytip:"STR@l_DownloadCopyKeytip"}},{name:"Button",attrs:{Id:"PptJewel.DownloadAs.DownloadACopyAsPdf",LabelText:"STR@L_DownloadAsPdf",
Description:"STR@L_DownloadCopyAsPdfDescription",Image48by48:"IMGMAP@prt2@PDF_file_48x48x32",Command:"0x91656D12",Keytip:"STR@l_DownloadAsPDFKeytip"}},{name:"Button",attrs:{Id:"PptJewel.DownloadAs.DownloadACopyAsOdp",LabelText:"STR@L_DownloadAsOdp",Description:"STR@L_DownloadCopyAsOdpDescription",Image48by48:"IMGMAP@prt2@SaveAsPowerPointOdp_48x48x32",Command:"0x4A7CCC65",Keytip:"STR@l_DownloadAsOdpKeytip"}},{name:"Button",attrs:{Id:"PptJewel.DownloadAs.DownloadAsImages",LabelText:"STR@L_DownloadAsImages",
Description:"STR@L_DownloadAsImagesDescription",Image48by48:"IMGMAP@prt2@Downloadasimage_48x48x32",Command:"0x47057070",Keytip:"STR@l_DownloadAsImagesKeytip"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptJewel.About",LabelText:"STR@L_AboutOffice",Command:"0x2F9A3D80",Keytip:"STR@l_AboutOfficeKeytip"},children:[{name:"Menu",attrs:{Id:"PptJewel.About.Menu"},children:[{name:"MenuSection",attrs:{DisplayMode:"Menu48",Title:"STR@L_AboutOffice"},children:[{name:"Controls",attrs:{},children:[{name:"Button",
attrs:{Id:"PptJewel.About.TermsOfUse",LabelText:"STR@L_TermsOfUse",Description:"STR@L_TermsOfUseDescription",Image48by48:"IMGMAP@prt2@Info_48x48x32",Command:"0x8C0EBBB3",Keytip:"STR@l_TermsOfUseKeytip"}},{name:"Button",attrs:{Id:"PptJewel.About.Privacy",LabelText:"STR@L_Privacy",Description:"STR@L_PrivacyDescription",Image48by48:"IMGMAP@prt2@ProtectForm_48x48x32",Command:"0x48091446",Keytip:"STR@l_PrivacyKeytip"}},{name:"Button",attrs:{Id:"PptJewel.About.TrustCenter",LabelText:"STR@L_TrustCenter",
Description:"STR@L_TrustCenterDescription",Image48by48:"IMGMAP@prt2@ProtectForm_48x48x32",Command:"0x9A00EB4E",Keytip:"STR@l_TrustCenterKeytip"}},{name:"Button",attrs:{Id:"PptJewel.About.ThirdPartyNotices",LabelText:"STR@l_ThirdPartyNotices",Description:"STR@l_ThirdPartyNoticesDescription",Image48by48:"IMGMAP@prt2@Info_48x48x32",Command:"0x8458E357",Keytip:"STR@l_ThirdPartyNoticesKeytip"}}]}]},{name:"MenuSection",attrs:{Id:"PptJewel.About.DiagnosticsSection",ShowMenuSectionSeparator:"false",DisplayMode:"MenuDiagnostics"},
children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"PptJewel.About.Diagnostics",LabelText:"STR@L_Diagnostics",Description:"STR@L_DiagnosticsDescription",LabelCss:"padding-bottom: 12px; padding-top: 0px;"}},{name:"TextBox",attrs:{Id:"PptJewel.About.SessionId",LabelText:"STR@L_DiagnosticsSessionId",QueryCommand:"0xA67B8E1D",ControlCss:"padding-top: 0px; padding-bottom: 0px;"}},{name:"TextBox",attrs:{Id:"PptJewel.About.Build",LabelText:"STR@L_DiagnosticsBuild",QueryCommand:"0xE6F12176",
ControlCss:"padding-top: 0px;"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptJewel.Help",LabelText:"STR@L_Help",Command:"0x2F9A3D80",Keytip:"STR@l_TabHelpKeytip"},children:[{name:"Menu",attrs:{Id:"PptJewel.Help.Menu"},children:[{name:"MenuSection",attrs:{DisplayMode:"Menu48",Title:"STR@L_Help"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"PptJewel.Help.Help",LabelText:"STR@L_Help",Description:"STR@L_HelpDescription",Image48by48:"IMGMAP@prt2@OfficeAssistant_48x48x32",Command:"0x56B04A51",
Keytip:"STR@l_HelpKeytip"}},{name:"Button",attrs:{Id:"PptJewel.Help.GiveFeedback",LabelText:"STR@L_GiveFeedback",Description:"STR@L_GiveFeedbackDescription",Image48by48:"IMGMAP@prt2@GiveFeedback_48x48x32",Command:"0x2FD6BDE0",Keytip:"STR@l_GiveFeedbackKeytip"}},{name:"Button",attrs:{Id:"PptJewel.Help.ReportAbuse",LabelText:"STR@L_ReportAbuse",Description:"STR@L_ReportAbuseDescription",Image48by48:"IMGMAP@prt2@ReportAbuse_48x48x32",Command:"0xC0F351AE",Keytip:"STR@l_ReportAbuseKeytip"}}]}]}]}]}]}]},
{name:"MenuSection",attrs:{Id:"PptJewel.SecondaryMenu",DisplayMode:"Menu32"},children:[{name:"Controls",attrs:{Id:"PptJewel.SecondaryMenu.Controls"},children:[{name:"Button",attrs:{Id:"PptJewel.Close",Command:"0xB4CE0C4E",LabelText:"STR@L_Exit",Keytip:"STR@l_ExitKeytip"}}]}]}]}]}]};wB.main();Type.registerNamespace("Common.App.Insights");r.a.instance.Dc(new QG);Type.registerNamespace("Common.App.Activities");AB.main();Type.registerNamespace("Common.App.ActivityAggregator");FB.main();Type.registerNamespace("Common.App.AppsForOffice");
window.Common.App.AppsForOffice.AddinShortcutsPreferenceSettingHelper=Wq;Type.registerNamespace("Common.App.Assistance");Type.registerNamespace("Common.App.BrowserInfoLogger");GB.main();Type.registerNamespace("Common.App.CommandUIActors");Type.registerNamespace("CADWLTR");HB.main();Type.registerNamespace("Common.App.EventsCacheManager");IB.main();Type.registerNamespace("Common.App.AppsForOfficeCommon");Type.registerNamespace("Common.App.FloatPane");LB.main();Type.registerNamespace("Common.App.InsertFile");
Type.registerNamespace("Common.App.InsertPicture");OB.main();rC.main();vC.main();Type.registerNamespace("Common.App.AppsForOfficeCommon");Type.registerNamespace("Common.App.AppsForOfficeCommon");Type.registerNamespace("CNT");xC.main();Type.registerNamespace("Common.App.VisibilityManagement");zC.main();Type.registerNamespace("Common.ModernFontPicker");AC.main();BC.main();GC.main();MC.main();PC.main();YC.main();$C.main();fD.main();Gz.main();zD.main();BD.main();CD.main();QD.main();RD.main();SD.main();
TD.main();VD.main();dE.main();eE.main();XE.main();$E.main();cF.main()},123:function(K,Z,d){d.d(Z,"a",function(){return k});d.d(Z,"b",function(){return e});const k=n=>null===n||"undefined"===typeof n||!n.length,e=n=>null===n||"undefined"===typeof n},1241:function(K,Z,d){K=d(0);class k{constructor(n,r,v,C){this.yOh=n;this.$Yh=r;this.ZYh=v;this.aZh=C}get Syi(){return this.yOh}get dZk(){return this.$Yh}get aZk(){return this.ZYh}get resultType(){return this.aZh}}Object(K.a)(k,"SearchContext",null,[440]);
d.d(Z,"a",function(){return e});class e{rFi(n,r,v){var C=v-r;let w;if(100<=C)C=r,w=v;else{C=Math.max(0,r+Math.ceil(C/2)-50);w=Math.min(n.length,C+100);C=Math.max(0,w-100);let A;if(C&&" "!==n.charAt(C-1)){A=Math.min(r,C+10);for(var z=C;z<A;++z)if(" "===n.charAt(z)){C=z+1;break}}if(w!==n.length&&" "!==n.charAt(w))for(A=Math.max(v,w-10),z=w-1;z>=A;--z)if(" "===n.charAt(z)){w=z;break}}return new k(n.substring(C,w),r-C,v-C,"")}}Object(K.a)(e,"SearchContextFactory",null,[417])},153:function(K,Z,d){d.d(Z,
"a",function(){return e});d.d(Z,"b",function(){return n});var k=d(41);const e=(r,v,C)=>{r=k.a.Ik(r);r.Va("CommandId",v.toString());try{return C()}finally{r.finish(!0)}},n=(r,v,C,w)=>e(r+v,C,w)},233:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k{}k.kGc="AfterValidate";k.autoCorrect="AutoCorrect";k.Igi="BeforeValidate";k.VHi="CutAction";k.FOi="EditingElementContainerDisconnectingFromView";k.endEditing="EndEditing";k.wXi="FinishingSelectionValidation";k.oAj="ImeTypingEnd";k.qAj="ImeTypingStart";
k.GGj="IpMode";k.ey="KeyPress";k.Zf="KeyDown";k.Sjk="NotFinishingSelectionValidation";k.kwk="OvertypeEnd";k.mwk="OvertypeStart";k.pwk="PaddingChanged";k.w8g="ParagraphContentUpdated";k.wyk="PasteAction";k.x7k="SetMode";k.typingProcess="TypingProcess";k.Zsi="ClipboardModeBegin";k.$si="ClipboardModeEnd";Object(K.a)(k,"EditEventKeys",null,[])},245:function(K,Z,d){d.d(Z,"a",function(){return n});var k=d(25),e=d(13);const n=r=>k.AFrameworkApplication.fa.ka("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk:
Object(e.a)(r.resolve("Common.IDynamicScriptLoaderProvider").Pw,r.resolve("Common.IDynamicScriptLoaderProvider").Pw.loadScript,"loadScript")},248:function(K,Z,d){d.r(Z);K=d(0);var k=d(382),e=d(55),n=d(25),r=d(45),v=d(575),C=d(1194),w=d(17);d(1186);var z=d(992),A=d(27),u=d(75),E=d(121),H=d(31),I=d(40),J=d(36),T=d(74),D=d(52),R=d(72),Q=d(57),W=d(86);d(415);var O=d(49),Y=d(417);class S{constructor(ha,F,na,ba,Ea){this.BGd=ha;this.f1h=na;this.e1h=F;this.VQh=ba;this.oWh=Ea}y0k(ha,F){F.z0k(ha,this.BGd,this.e1h,
this.f1h,this.VQh,this.oWh)}}Object(K.a)(S,"MathPropertyObject",null,[]);var da=d(30),fa=d(107);d.d(Z,"Box4PasteSteward",function(){return ka});class ka extends z.a{constructor(ha,F,na,ba,Ea,La,ta,oa=null,wa=null){super(ha,ta,oa,wa);this.lo=this.i2=null;this.Ppa=!1;this.T2a=null;this.Mnb=-1;this.L3a=0;this.JKd=new w.a;fa.a(4223754,307,Q.OutlineElementReader.Wg(ha));this.X2a=F;this.X2a.Krb(this);this.nF=na;this.nF.Krb(this);this.CBd=ba;this.Xo=Ea;this.dVh=La;this.NGd=T.ListReader.tk(this.Ab);ka.xDj();
ka.lDj();ka.bEj()}get L8(){return this.i2||(this.i2=e.a.instance.rb("Box4.IInternalLinkManager"))}get KQa(){return this.lo}get $6a(){return this.NGd&&!this.nF.vca}get o7a(){return 0<this.L3a}get uv(){return this.CBd}get eq(){return this.Xo}get n1c(){return this.dVh}get Whi(){return!!n.AFrameworkApplication.fa&&n.AFrameworkApplication.fa.ka("Box4EnsurePasteFormatOnTextIsEnabled")}reset(){super.reset();this.lo=this.f5d(!1)}pPd(ha){fa.a(4223762,307,Q.OutlineElementReader.Wg(this.Ab)||R.OutlineReader.Ut(this.Ab));
this.CFb(!1);var F=new da.GraphIterator;F.Rc(this.Ab);ha=z.a.Ph.qca(this.Ab,this.DSa(ha));this.LGc(F,!1);fa.a(4223763,307,ha===this.Ab.currentNode);fa.a(4223764,307,H.ParagraphReader.Yd(ha));-1!==this.lo.eE&&ka.paragraphEditor.RJ(ha,this.lo.eE);if(ka.paragraphEditor.uv&&!this.gZ.Yth){if(this.lo.textIndent){let Ea;({Vf:ba,returnValue:Ea}=ka.$fd(this.lo.textIndent));var na=!1;if(Ea||!T.ListReader.g8a){0>Ea&&(na=!0,Ea*=-1);var ba=ka.IVd(Ea,ba);na||ka.paragraphEditor.uv.ljb(ha,ba)}}!this.lo.marginLeft||
ka.BL.IZc||T.ListReader.tk(F)||({Vf:F,returnValue:na}=ka.$fd(this.lo.marginLeft),F=ka.IVd(na,F),ka.paragraphEditor.uv.Cnd(ha,1,F))}(ka.Tf.hg&&ka.Tf.Ny||J.a.instance.ga(45)&&A.App.HD.NNb)&&ha.setValue(I.a.s9b,!0);this.lo.lineSpacing&&ka.paragraphEditor.m1(ha,this.lo.lineSpacing);this.lo.paragraph=ha;this.Ppa=!0}LGc(ha,F){fa.a(8128518,307,!F);this.pM&&!J.a.instance.ga(76)&&(0<this.pM&&this.uv.eMc(ha,this.pM),0>this.pM&&this.uv.uhb(ha,this.pM,0));J.a.instance.ga(29)&&(this.Ab.Rc(ha),D.OutlineElementNavigator.wi(this.Ab));
!this.$6a||2===A.App.mode&&this.n1c.Xlc?ha&&this.eq.KTe(ha,this.o7a):this.eq.tqh(ha);this.pM=0}esd(ha){this.JKd.add(ha)}PTd(){this.pM=0}N0(ha,F=null){fa.a(4223772,307,H.ParagraphReader.fl(this.Ab));const na=this.Ab.currentNode;this.lo.a1e(na);if(!this.gZ.o1e(F)){n.AFrameworkApplication.fk("Microsoft.Office.Web.Common.Flighting.IBox4EnsurePasteFormatOnTextSettings");var ba=na.Ra.last,Ea=O.a.zQa(na),La=!1;this.Ppa&&(ba.formatting=this.lo.G8a.$d(ba),J.a.instance.ga(57)&&na.Yu(),this.Ppa=!1,La=!0);ha=
this.gZ.T$d(ha,F);this.gZ.qoa(this.Ab.currentNode,this.lo.nfa,F);this.characterPropertiesEditor.replaceTextRange(Ea,ha);this.Whi&&La&&(ha=na.Cub(Ea.Qa),ha.formatting=this.lo.G8a.$d(ha));J.a.instance.ga(2)}}lna(ha){this.gZ.uZc&&this.gZ.zYc(ha)?(this.mA(),this.nA(ha)):(fa.a(4223773,307,H.ParagraphReader.fl(this.Ab)),ha=O.a.zQa(this.Ab.currentNode),this.characterPropertiesEditor.qWc(ha,F=>new Y.a(F,Y.a.OLc),u.AParagraphNode.f_))}NYa(){}kna(ha){this.X2a.kna(ha)}jna(ha){this.lo=ha;this.Ppa=!0}Owa(ha){fa.a(4223774,
307,H.ParagraphReader.fl(this.Ab));fa.a(4223775,307,!this.T2a);fa.a(4223776,307,0>this.Mnb);this.T2a=ha;this.Mnb=H.ParagraphReader.textLength(this.Ab.currentNode)}Nwa(){fa.a(4223777,307,H.ParagraphReader.fl(this.Ab));fa.a(4223778,307,!!this.T2a);fa.a(4223779,307,0<=this.Mnb);let ha=O.a.createTextRange(this.Ab.currentNode,this.Mnb,H.ParagraphReader.textLength(this.Ab.currentNode)),F="",na="";this.L8&&({wgh:F,$Zi:na}=this.L8.MCh(E.HyperlinkReader.ZDa(this.T2a),!0)).returnValue&&(this.T2a=F,na&&(this.characterPropertiesEditor.replaceTextRange(ha,
na),ha=O.a.createTextRange(this.Ab.currentNode,this.Mnb,H.ParagraphReader.textLength(this.Ab.currentNode))));ka.hyperlinkEditor.Zia(ha,this.T2a,!1);this.Ppa=!0;this.T2a=null;this.Mnb=-1}nA(ha){this.pPd(ha);this.lo.ssd(this.Ab.currentNode);ha&&"P"===ha.BU.w7b&&ka.paragraphEditor.FKa(this.Ab.currentNode,this.lo.Qfd);this.gZ.qoa(this.Ab.currentNode,this.lo.nfa,ha,this.lo.marginLeft,this.lo.textIndent)}mA(){fa.a(4223808,307,H.ParagraphReader.fl(this.Ab));ka.hyperlinkEditor.NQi(this.Ab.currentNode);D.OutlineElementNavigator.Oe(this.Ab)}HYa(){}GYa(){}Twa(){}WIa(){}ona(){fa.a(4223809,
307,Q.OutlineElementReader.Wg(this.Ab)||R.OutlineReader.Ut(this.Ab));let ha=!1;this.o7a||(ha=this.$6a||!0);ha||(this.pM+=1);this.L3a++}mna(){this.L3a--;let ha=!1;this.o7a||(ha=this.$6a||!0);ha||--this.pM}Swa(ha){fa.a(4223810,307,Q.OutlineElementReader.Wg(this.Ab)||R.OutlineReader.Ut(this.Ab));fa.a(4223811,307,0!==ha.listStyleType);this.eq.eLb(this.BYj(ha))}nna(){fa.a(4223813,307,Q.OutlineElementReader.Wg(this.Ab));n.AFrameworkApplication.fk("Microsoft.Office.Web.SessionSettings.IWacWordQoEListExternalPasteImprovementSettings");
if(ka.BL.IZc&&T.ListReader.tk(this.Ab)){const ha=H.ParagraphReader.dwb(this.Ab.currentNode),F=this.n1c.l1f(this.Ab);this.eq.Gnd(F,ha,null)}}IYa(ha){this.X2a.IYa(ha)}mY(ha){this.nF.mY(ha)}jY(){this.nF.jY()}lY(ha){this.nF.lY(ha)}kY(){this.nF.kY()}iY(ha){this.nF.iY(ha)}hY(){this.nF.hY()}static get paragraphEditor(){return ka.Rw||(ka.Rw=e.a.instance.resolve("Box4.IParagraphEditor"))}static get hyperlinkEditor(){return ka.yn||(ka.yn=e.a.instance.resolve("Box4.IHyperlinkEditor"))}static get Tf(){return ka.fd||
(ka.fd=e.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static get PMb(){return ka.mnf}static get BL(){return ka.tK||(ka.tK=e.a.instance.rb("Box4.List.ListSettings"))}static xDj(){const ha=J.a.instance.ga(61);ka.dJa[1]=ha?W.StyleReader.Cud:W.StyleReader.FMb;ka.dJa[2]=ha?W.StyleReader.Dud:W.StyleReader.GMb;ka.dJa[3]=ha?W.StyleReader.Eud:W.StyleReader.HMb;ka.dJa[4]=ha?W.StyleReader.Fud:W.StyleReader.IMb;ka.dJa[5]=ha?W.StyleReader.Gud:W.StyleReader.JMb;ka.dJa[6]=ha?W.StyleReader.Hud:
W.StyleReader.KMb;ka.dJa[7]=ha?null:W.StyleReader.mrc}static lDj(){ka.Nda.unspecified=0;ka.Nda.defaultUnordered=1;ka.Nda.defaultOrdered=1;ka.Nda.none=0;ka.Nda.disc=1;ka.Nda.circle=2;ka.Nda.square=3;ka.Nda.decimal=1;ka.Nda.lowerAlpha=2;ka.Nda.lowerRoman=3;ka.Nda.upperAlpha=4;ka.Nda.upperRoman=5}static bEj(){ka.mnf=W.StyleReader.Twb()}static b7a(ha){return r.a.substring(ha,4,6)+r.a.substring(ha,2,4)+r.a.substring(ha,0,2)}static $fd(ha){let F,na;F=0;const ba=ha.length;na=parseFloat(r.a.substring(ha,
0,ba-2));ha=r.a.substr(ha,ba-2,2);switch(ha){case "in":F=3;break;case "px":F=7;break;case "cm":F=1;break;case "pt":F=5;break;default:k.ULS.sendTraceTag(8208450,307,50,"Pasted DOM with unrecognized css length unit {0}, will default to UnitType.None and value 0",ha),na=0}return{returnValue:na,Vf:F}}static IVd(ha,F){let na=0;switch(F){case 3:na=v.a.Ita(ha);break;case 7:na=C.a.rfa(ha,0);break;case 1:na=v.a.aTd(ha);break;case 5:na=v.a.Ita(v.a.Mgd(ha));break;default:k.ULS.sendTraceTag(8208451,307,50,"ConvertToTwips unable to convert inputValue {0} and inputUnit {1} to twips, returning 0",
ha,F)}return na}}ka.Rw=null;ka.yn=null;ka.fd=null;ka.dJa=Array(8);ka.Nda={};ka.mnf=null;ka.tK=null;Object(K.a)(ka,"Box4PasteSteward",z.a,[])},263:function(K,Z,d){d.r(Z);K=d(0);d(382);var k=d(916);d(917);var e=d(25),n=d(95),r=d(55),v=d(35);class C{}Object(K.a)(C,"RibbonUpsellButtonCreator",null,[]);class w extends Sys.EventArgs{constructor(Y){super();this.FEl=Y}}Object(K.a)(w,"TopRowCreatedEventArgs",Sys.EventArgs,[]);d(383);var z=d(359);d(172);var A=d(134);d(310);d(73);var u=d(223),E=d(161),H=d(65);
class I{constructor(Y,S){this.cluster=Y;this.pLc=S}}Object(K.a)(I,"ImageInfo",null,[]);class J{constructor(Y,S,da,fa,ka,ha,F,na,ba,Ea,La,ta,oa,wa,ra=null,ya=null){this.id=Y;this.MEc=S;this.QEc=da;this.PEc=fa;this.OEc=ka;this.NEc=ha;this.SEc=F;this.GMd=na;this.nMb=new I(ba,Ea);this.Mpd=new I(La,ta);this.ocd=new I(oa,wa);ra&&ya&&new I(ra,ya)}}Object(K.a)(J,"PeoplesWellBaseSettings",null,[]);class T{constructor(){this.Rxf=null}}Object(K.a)(T,"BreadcrumbControls",null,[]);class D{constructor(Y){this.id=
Y}}new D("DocChat",void 0,void 0,void 0,void 0,"WACSkypeDocChat_16x16x32","WACSkypeDocChatUnread_16x16x32");Object(K.a)(D,"ChatButtonSettings",null,[]);class R{constructor(){this.id=this.image=this.label=this.command=null}}Object(K.a)(R,"SkypeButtonInfo",null,[]);class Q{constructor(){this.G3e=this.pBh=this.qRd=null}}Object(K.a)(Q,"TopRowControls",null,[]);var W=d(199);d(45);d.d(Z,"CuiHelper",function(){return O});class O{constructor(Y,S,da=null,fa,ka=null){this.lha=Y;this.ASh=W.a.jhk(S,ka);this.ASh.push(CommonUIStrings);
k.b();O.Ca=void 0===da||null===da?e.AFrameworkApplication.Ta:da}static get qxj(){return O.Spa||(O.Spa=r.a.instance.resolve("Common.App.Header.HeaderEventSource"))}static Vdj(Y,S,da){return new J(O.zIe,v.a.Kti,v.a.uUd,v.a.Nti,v.a.Mti,v.a.Lti,v.a.Oti,v.a.O6a,Y,"per_SingleCollabUserGlyph_16x16x32",S,"per_SingleCollabUserGlyph_32x32x32",da,"per_MoreUsersGlyph_16x16x32",null,null)}static EMi(Y){Y.qRd&&(O.DMi(Y.qRd),Y.qRd=null);Y.pBh&&(O.CMi(),Y.pBh=null);Y.G3e&&(O.FMi(Y.G3e),Y.G3e=null);O.qxj.DJk();let S;
({g7b:S}=z.a.ZNb(!1)).returnValue&&n.a.aCa(S)}static S7b(){e.AFrameworkApplication.Ta.processAction(v.a.S7b,2)}static CMi(){e.AFrameworkApplication.bNc&&E.EventHandlerManager.instance.btd(e.AFrameworkApplication.bNc)}static addButton(Y,S,da,fa,ka,ha,F,na){S=A.a(Y,S,da,fa,null,null,null,ha,null,null,void 0,void 0,ka);(Y=na.hostControl(Y,S,ha))&&F.appendChild(Y);return Y}static AKc(Y,S,da){let fa;fa=document.createElement("span");fa.className="BreadcrumbItem";fa.id=S;fa.innerText=da;fa.setAttribute("dir",
"auto");Y.appendChild(fa);return fa}static DMi(Y){Y.Rxf&&E.EventHandlerManager.instance.kwl(Y.Rxf)}static FMi(Y){u.a.instance.XEh(H.a.click,Y,O.gtk,!0)}static gtk(){e.AFrameworkApplication.D3e?(e.AFrameworkApplication.Aa.Nqc(e.AFrameworkApplication.Aa.hb.u4f()),e.AFrameworkApplication.D3e=!1):window.top.location=e.AFrameworkApplication.signInUrl;return!0}static z_c(){return!!e.AFrameworkApplication.Aa&&e.AFrameworkApplication.Aa.hb.z_c}}O.Spa=null;O.Zal="ShareServerWhite_20x20x32";O.Z0d="ExternalHeaderFullTopBars";
O.vxj="HeaderTopBars";O.rRd="BreadcrumbBrand";O.sRd="BreadcrumbFolder";O.tRd="BreadcrumbTitle";O.oVf="FolderSeparator";O.n_e="sbTellMe";O.rXe="TellMe-SearchBox";O.i7g="btnOpenInClient";O.iVe="btnFileSharing";O.jil="BasicChat";O.Ekd="btnReplyWithChanges";O.XSf="jbtnGiveFeedback";O.zIe="PeoplesWellControl";O.xOf="EditableBreadcrumbItem";O.Ca=null;O.c2e=50;O.oxj=null;Object(K.a)(O,"CuiHelper",null,[661])},302:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k{}k.alt="Alt";k.iconColor="IconColor";
k.Exb="Image16by16Class";k.Gzj="Image30by30Class";k.xEa="Image32by32Class";k.Mbe="Image48by48Class";k.labelText="LabelText";k.SWj="LabelTextUserGeneratedPlaceholderReplacements";k.visible="Visible";k.XU="SourceControlId";k.customTooltip="CustomTooltip";k.Icon="Icon";k.IconSet="IconSet";k.Bfh="ReduxActions";Object(K.a)(k,"SharedControlCommandProperties",null,[])},304:function(K,Z,d){K=d(0);var k=d(55),e=d(383),n=d(588),r=d(126),v=d(382),C=d(95),w=d(649),z=d(398),A=d(45),u=d(197),E=d(54),H=d(1097),
I=d(25),J=d(163);class T{constructor(oa,wa){this.cp=oa;this.distance=wa}}Object(K.a)(T,"CpDistanceResult",null,[]);class D{constructor(){this.pEa=0;this.ft=null;this.Htb=this.Itb=this.NQa=this.BCa=0;this.isc=this.HFa=this.cLa=null;this.$zb=this.Kca=this.vbd=0;this.h4e=this.gZd=!1;this.g1b=this.sDa=this.bja=this.X2=this.Olc=0;this.EJh=this.DUf=this.Zqc=this.uMb=!1;this.result=null;this.t0b=this.WVd=this.d7a=this.Q7=this.mca=0;this.Aka=this.vKc=!1;this.$O=null}}Object(K.a)(D,"CpFromPointState",null,
[]);class R{constructor(oa,wa,ra,ya,Da,pa,la,Fa=null,Qa=0,Sa=null){this.qCa=this.cp=this.Qa=0;this.s0b=-1;this.deltaX=this.$Gf=Number.MAX_VALUE;this.xYa=0;this.cVa=-Number.MAX_VALUE;this.aVa=-Number.MAX_VALUE;this.x1d=this.T2b=this.Jrb=this.sFe=!1;this.element=oa;this.point=ra;this.nbb=ya;this.hOe=Da;this.gOe=pa;this.fdg=la;this.Fia=Fa;this.q6a=Qa;this.originalText=wa;this.$Ia=this.originalText.length;this.Nb=this.$Ia-1;this.l9b=4===this.nbb||3===this.nbb;this.$O=Sa}}Object(K.a)(R,"CpFromPointElementState",
null,[]);var Q=d(42);class W{constructor(oa,wa,ra){this.CpBegin=oa;this.CpEnd=wa;this.IsEop=ra}}Object(K.a)(W,"CpFromPointResult",null,[]);class O{constructor(oa,wa,ra){this.LineBounds=oa;this.ClientRects=wa;this.IsRangeMultipleLines=ra}}Object(K.a)(O,"LineCoordinateResult",null,[]);class Y{constructor(oa,wa,ra,ya,Da,pa){this.xmb={};this.KSb=!0;this.lmg=this.KAc=this.gDc=this.Hpb=this.L4a=null;this.ld=oa;this.uZ=wa;this.bUh=ra?ra.ka("TextFidelityLayoutFixesEnabled"):!1;this.hTh=ra?ra.ka("HyperlinkFirstCharacterSelectionFixIsEnabled"):
!1;this.SSh=ra?ra.ka("CharacterBeforeEOPSelectionFixIsEnabled"):!1;(this.UNa=ya)||v.ULS.sendTraceTag(21051272,324,10,"_measureBoundsUsingSpansStrategy is null");this.HP=Da;this.d1h=pa}rda(){this.KSb=!1}e7a(oa,wa,ra,ya=null){this.lmg=[];var Da=oa.k6;if(!oa.textLength)return this.Fqj(oa,wa,ra,ya);ya=Object.assign(new D,{cLa:Array(Da.length),HFa:Array(Da.length),isc:Array(Da.length),gZd:!0,ft:Da,$O:ya});for(var pa=0;pa<=Da.length;pa++){ya.BCa=0;ya.NQa=0;ya.Itb=0;ya.Htb=0;ya.pEa=0;ya.uMb=!1;ya.Zqc=!1;
if(pa<Da.length){if(!this.FWi(oa,ya,pa))continue}else{ya.$zb=pa-1;break}if(this.hXi(wa,ya,pa))break}if(ya.h4e&&ya.Olc<wa.y&&wa.y<ya.X2)return this.E1k(oa,wa,ra,ya);ya.result=null;ya.mca=-1;ya.Q7=ya.sDa;ya.d7a=Number.MAX_VALUE;ya.WVd=0;ya.t0b=0;ya.vKc=!1;ya.Aka=!1;for(Da=ya.Kca;Da<=ya.$zb;Da++)if(pa=this.fXi(oa,wa,ra,Da,ya))return pa;return this.opj(oa,wa,ra,ya)}Fqj(oa,wa,ra,ya){const Da=oa.isRtl;if(!ra)return new W(0,0,!1);oa=this.QPa(oa,ya);return!Da&&wa.x>oa.x+oa.width/2||Da&&wa.x<oa.x+oa.width/
2?new W(-1,-1,!0):new W(0,0,!0)}FWi(oa,wa,ra){if(this.Hqi(wa.ft[ra].htmlElement)||wa.ft[ra].ryb)return!1;var ya=this.oRd(wa.ft[ra],wa.$O);wa.cLa[ra]=ya;var Da=ya.y;let pa=ya.y+ya.height;wa.ft[ra].Qfg||wa.ft[ra].Aka||wa.ft[ra].K3&&!wa.ft[ra].nUa?({PJf:Da,OJf:pa}=this.rtf(wa.ft[ra].htmlElement,Da,pa),wa.BCa=wa.Itb=Da,wa.NQa=wa.Htb=pa,wa.HFa[ra]=pa-Da,wa.isc[ra]=wa.HFa[ra]):(this.Fel(oa,ra)?(ya=this.Kt(oa,wa.g1b,void 0,void 0,void 0,wa.$O),Da=this.R4b(wa.ft[ra].htmlElement),oa=1<Da?this.Kt(oa,wa.g1b+
Da-1,void 0,void 0,void 0,wa.$O):ya,wa.BCa=Da=ya.y,wa.NQa=ya.y+ya.height,wa.Itb=oa.y,wa.Htb=oa.y+oa.height,wa.HFa[ra]=ya.height,wa.isc[ra]=ya.height):(oa=this.d1h.Ikj(wa.ft[ra].htmlElement),wa.pEa=this.UNa.Pij(wa.ft[ra].htmlElement,oa),{PJf:Da,OJf:pa}=this.rtf(wa.ft[ra].htmlElement,Da,pa),wa.EJh=1<Math.abs(ya.width-this.I9i(wa.ft[ra].htmlElement))||1<Math.abs(ya.height-this.H9i(wa.ft[ra].htmlElement)),wa.EJh&&this.uZ.instance&&(oa=Math.round(oa*this.uZ.instance.Y2),wa.pEa=Math.round(wa.pEa*this.uZ.instance.Y2)),
wa.BCa=Da-wa.pEa,wa.NQa=Da+oa+wa.pEa,wa.Itb=pa-oa-wa.pEa,wa.Htb=pa+wa.pEa,wa.HFa[ra]=oa+2*wa.pEa,wa.isc[ra]=oa),wa.vbd=Math.max(wa.vbd,wa.HFa[ra]));wa.DUf||(wa.X2=wa.BCa,wa.bja=wa.NQa,wa.DUf=!0);wa.Zqc=wa.Itb>(wa.BCa+wa.NQa)/2;ra=Y.Zsa(wa.vbd);this.bUh&&(ra=this.KOd(wa,ra));wa.uMb=this.qIj(wa.X2,wa.bja,Da,ra);return!0}qIj(oa,wa,ra,ya){return oa===wa?ra>wa:ra>=wa-ya}KOd(oa,wa){return wa=this.UNa.KOd(!!oa.$O&&oa.$O.pzb,oa.BCa,oa.NQa,wa)}hXi(oa,wa,ra){if(wa.uMb||wa.Zqc){wa.uMb?wa.$zb=ra-1:(wa.X2=Math.min(wa.X2,
wa.BCa),wa.bja=Math.max(wa.bja,wa.NQa),wa.$zb=ra);Array.add(this.lmg,wa.bja);if(oa.y<=wa.bja)return!0;wa.Olc=wa.bja;wa.X2=wa.Itb;wa.bja=wa.Htb;wa.Kca=ra;wa.sDa=wa.g1b;wa.gZd=wa.uMb;wa.h4e=wa.Zqc;wa.vbd=wa.ft[ra].Aka||wa.ft[ra].K3&&!wa.ft[ra].nUa?0:wa.HFa[ra]}else wa.X2=Math.min(wa.X2,wa.BCa),wa.bja=Math.max(wa.bja,wa.Htb);oa.y>wa.Olc&&oa.y<wa.X2&&!wa.ft[wa.Kca].Aka&&!wa.ft[wa.Kca].K3&&wa.X2-wa.Olc<wa.isc[wa.Kca]/2&&(wa.X2=oa.y);wa.g1b+=this.LHi(wa.ft[ra]);return!1}E1k(oa,wa,ra,ya){if(ya.ft[ya.Kca].K3)return ra?
new W(ya.sDa,ya.sDa,!1):new W(ya.sDa,ya.sDa+1,!1);if(ra=this.ZGf(ya.ft[ya.Kca].htmlElement,ya.cLa[ya.Kca],wa,ya.gZd?4:3,ya.Olc,ya.X2,ya.HFa[ya.Kca],oa.isRtl,oa.Fia,ya.sDa,ya.$O))return ra=ya.sDa+ra.cp,ra=this.ntf(oa,wa,ra,ya.Kca,ya.sDa,void 0,void 0,ya.$O),new W(ra,ra,!1);this.ld.Wb(w.a.tjk,{["Reason"]:n.a.MSf});return null}fXi(oa,wa,ra,ya,Da){if(Da.ft[ya].ryb)return null;const pa=Da.ft[ya].K3,la=Da.ft[ya].Aka;let Fa=!1;if(pa){if(Da.cLa[ya].y>=Da.X2&&(Da.ft[ya].nUa||Da.ft[ya].mZc)){var Qa=Da.cLa[ya];
const Sa=Qa.x+Qa.width/2,Na=Math.abs(wa.x-Sa);if(Na<Da.d7a||!Qa.width&&Na===Da.d7a)Da.vKc=!0,Da.d7a=Na,Da.Aka=!1,Da.mca=!ra||!oa.isRtl&&wa.x<Sa||oa.isRtl&&wa.x>Sa?Da.Q7:Da.Q7+1}if(!Da.ft[ya].nUa&&!Da.ft[ya].mZc){Qa=Da.cLa[ya];if(!ra&&wa.x>Qa.x&&wa.x<Qa.x+Qa.width&&!Da.ft[ya].KMj)return new W(Da.Q7,Da.Q7+1,!1);Da.result=wa.x<Qa.x+Qa.width/2?new T(oa.isRtl?1:0,Math.max(Qa.x-wa.x,0)):new T(oa.isRtl?0:1,Math.max(wa.x-Qa.x-Qa.width,0))}}else la?(oa=this.QPa(oa,Da.$O),Fa=1>oa.width,Da.result=new T(-1,z.a.OMc(wa,
oa))):Da.result=this.ZGf(Da.ft[ya].htmlElement,Da.cLa[ya],wa,ya===Da.Kca&&Da.h4e?1:ya===Da.$zb&&!Da.uMb&&Da.Zqc?0:2,Da.X2,Da.bja,Da.HFa[ya],oa.isRtl,oa.Fia,Da.Q7,Da.$O);Da.result&&(Da.result.distance<Da.d7a||Fa&&Da.result.distance<=Da.d7a+1)&&(Da.mca=Da.result.cp+Da.Q7,Da.Aka=la,Da.d7a=Da.result.distance,Da.WVd=Da.Q7,Da.t0b=ya,Da.vKc=pa);Da.Q7=pa?Da.Q7+1:Da.Q7+this.R4b(Da.ft[ya].htmlElement);return null}opj(oa,wa,ra,ya){if(-1===ya.mca)return this.ld.Wb(w.a.NFj,{["Reason"]:n.a.HSf}),null;const Da=
oa.textLength;if(ya.Aka){if(ra)return ra=ya.cLa[ya.cLa.length-1],!oa.isRtl&&wa.x<ra.x+ra.width/2||oa.isRtl&&wa.x>ra.x+ra.width/2?new W(Da,Da,!1):new W(-1,-1,!0);ya.mca=Da}ya.mca>Da&&(ya.mca=Da);!ya.vKc&&ya.mca<Da&&(ya.mca=this.ntf(oa,wa,ya.mca,ya.t0b,ya.WVd,ya.t0b===ya.Kca,ya.t0b===ya.$zb,ya.$O));return new W(ya.mca,ya.mca,!1)}ntf(oa,wa,ra,ya,Da,pa=!1,la=!1,Fa=null){const Qa=oa.isRtl,Sa=oa.characterData,Na=oa.textLength;ra=A.a.jx(Sa,ra)?ra-1:ra;const ua=A.a.DMj(Sa,ra)?ra+2:ra+1,za=this.Kt(oa,ra,void 0,
void 0,void 0,Fa);wa=wa.x>za.x+za.width/2;if(ra-Da===this.R4b(oa.k6[ya].htmlElement)&&oa.k6.length>ya+1&&oa.k6[ya+1].K3)return ra;if(oa.k6[ya].xJj)return++ra;if(oa.k6[ya].wJj)return ra;let Wa=null,yb=!1;0<ra&&(Wa=this.Kt(oa,A.a.jx(Sa,ra-1)?ra-2:ra-1,void 0,void 0,void 0,Fa),0<ra-Da?yb=Wa.y+Wa.height/2>za.y:pa||oa.k6[ya-1].K3||(yb=!0));pa=null;let Za=!1;if(this.SSh?ua<=Na:ua<Na)pa=this.Kt(oa,ua,void 0,void 0,void 0,Fa),ua-Da<this.R4b(oa.k6[ya].htmlElement)?Za=pa.y+pa.height/2<za.y+za.height:la||oa.k6[ya+
1].nUa||oa.k6[ya+1].mZc||(Za=!0);yb&&Za?Wa.x<=za.x&&pa.x>=za.x?wa&&(ra=ua):Wa.x>=za.x&&pa.x<=za.x?wa||(ra=ua):Wa.x<pa.x?wa||(ra=ua):pa.x<Wa.x&&wa&&(ra=ua):yb||(Za?pa.x>=za.x&&wa?ra=ua:pa.x<=za.x&&!wa&&(ra=ua):!A.a.Xy(Sa.charCodeAt(ra))&&(!Qa&&wa||Qa&&!wa)&&(ra=ua));return ra}F9i(oa){return C.a.sv(oa)}H9i(oa){return oa.offsetHeight}I9i(oa){return oa.offsetWidth}Hqi(oa){return!oa.parentNode}R4b(oa){return C.a.e9a(oa)}Fel(oa,wa){wa=oa.k6[wa];if(wa.K3)return!1;oa=oa.htmlElement;Sys.UI.DomElement.containsCssClass(oa,
"Paragraph")||(oa=oa.firstChild);return""!==oa.style.lineHeight&&oa.style.lineHeight!==wa.htmlElement.style.lineHeight}LHi(oa){return oa.K3?1:C.a.e9a(oa.htmlElement)}rtf(oa,wa,ra){ra=new Sys.UI.Bounds(0,wa,0,ra-wa);this.$ai(oa,[ra]);wa=ra.y;ra=ra.y+ra.height;return{PJf:wa,OJf:ra}}$ai(oa,wa){if(oa=u.a.Qt(oa)){var ra=oa.borderTopWidth,ya=ra.indexOf("px");if(-1<ya)for(ra=parseInt(ra.substr(0,ya)),ya=0;ya<wa.length;ya++)wa[ya].y+=ra,wa[ya].height-=ra;oa=oa.borderBottomWidth;ra=oa.indexOf("px");if(-1<
ra)for(oa=parseInt(oa.substr(0,ra)),ra=0;ra<wa.length;ra++)wa[ra].height-=oa}}ZGf(oa,wa,ra,ya,Da,pa,la,Fa,Qa,Sa,Na=null){if(this.tLj(oa))return this.ld.Wb(w.a.BXi,{["Reason"]:n.a.LSf}),new T(0,z.a.OMc(ra,wa));if(this.sLj(oa))return this.ld.Wb(w.a.jPc,{["Reason"]:n.a.jPc}),null;oa=this.FBi(oa,ra,ya,Da,pa,la,Qa,Sa,Na);if(1>=oa.$Ia)return new T(0,z.a.OMc(oa.point,wa));this.$Yk(oa);do{if(oa.Qa>oa.Nb)return this.SJb(),this.ld.Wb(w.a.sjk,{["Reason"]:n.a.r_g}),null;this.pik(oa)}while(!oa.sFe);for(oa.qCa=
!Fa&&oa.xYa<oa.point.x||Fa&&oa.xYa>oa.point.x?oa.Nb:oa.Qa;!oa.Jrb&&!this.chi(oa););if(oa.x1d)for(oa.cp=oa.Qa;oa.cp<=oa.Nb&&!this.tYj(oa);oa.cp++);return this.Eri(oa)}FBi(oa,wa,ra,ya,Da,pa,la,Fa,Qa=null){return new R(oa,this.F9i(oa),wa,ra,ya,Da,pa,la,Fa,Qa)}tLj(oa){return!oa.firstChild}sLj(oa){return 3!==oa.firstChild.nodeType}$Yk(oa){let wa;if(0===oa.nbb){oa.cVa=oa.hOe;oa.aVa=oa.gOe;for(var ra=40;ra<oa.$Ia;ra+=40)if(wa=this.PPa(oa.element,oa.originalText,ra,oa.Fia,oa.q6a,void 0,void 0,oa.$O),wa.height&&
wa.y+wa.height/2>oa.aVa){oa.Nb=ra;break}}else if(1===oa.nbb)for(oa.Nb=oa.$Ia-1,oa.cVa=oa.hOe,oa.aVa=oa.gOe,ra=oa.$Ia-40;0<=ra;ra-=40){if(wa=this.PPa(oa.element,oa.originalText,ra,oa.Fia,oa.q6a,void 0,void 0,oa.$O),wa.height&&wa.y+wa.height/2<oa.cVa){oa.Qa=ra;break}}else if(2===oa.nbb)oa.Nb=oa.$Ia-1,oa.cVa=oa.hOe,oa.aVa=oa.gOe;else if(3===oa.nbb||4===oa.nbb)for(ra=0;ra<oa.$Ia+40;ra+=40){const ya=ra<oa.$Ia?ra:oa.$Ia-1;wa=this.PPa(oa.element,oa.originalText,ya,oa.Fia,oa.q6a,void 0,void 0,oa.$O);if(wa.height&&
(wa.y+wa.height<oa.point.y&&(oa.Qa=ya),wa.y>oa.point.y)){oa.Nb=ya;break}}}pik(oa){const wa=Math.floor((oa.Qa+oa.Nb)/2);oa.cp=wa;let ra=this.PPa(oa.element,oa.originalText,oa.cp,oa.Fia,oa.q6a,void 0,void 0,oa.$O);for(;oa.cp<oa.Nb&&!ra.height;)oa.cp++,ra=this.PPa(oa.element,oa.originalText,oa.cp,oa.Fia,oa.q6a,void 0,void 0,oa.$O);oa.cp!==oa.Nb||ra.height?!oa.l9b&&ra.y+ra.height/2<oa.cVa||oa.l9b&&ra.y+oa.fdg<oa.point.y?oa.Qa=oa.cp+1:!oa.l9b&&ra.y+ra.height/2>oa.aVa||oa.l9b&&ra.y>oa.point.y?oa.Nb=oa.cp-
1:ra.x<=oa.point.x&&ra.x+ra.width>=oa.point.x?(oa.Jrb=!0,oa.T2b=!0,oa.sFe=!0):(oa.sFe=!0,oa.xYa=ra.x+ra.width/2,oa.s0b=oa.cp,oa.deltaX=Math.abs(oa.xYa-oa.point.x),oa.l9b&&(oa.cVa=ra.y,oa.aVa=ra.y+oa.fdg)):oa.Nb=wa-1}chi(oa){var wa=Math.abs(oa.qCa-oa.cp);if(wa<oa.$Gf)oa.$Gf=wa;else return oa.Jrb=!0,oa.x1d=!0;wa=Math.floor((oa.cp+oa.qCa)/2);wa===oa.cp&&(wa=oa.qCa);var ra=this.PPa(oa.element,oa.originalText,wa,oa.Fia,oa.q6a,void 0,void 0,oa.$O);if(0<ra.height&&ra.y+ra.height/2<=oa.cVa||ra.y+ra.height/
2>=oa.aVa)oa.qCa=oa.cp<oa.qCa?wa-1:wa+1;else if(ra.x<=oa.point.x&&ra.x+ra.width>=oa.point.x)oa.cp=wa,oa.T2b=!0,oa.Jrb=!0;else{ra=ra.x+ra.width/2;const ya=Math.abs(oa.xYa-ra),Da=Math.abs(oa.xYa-oa.point.x),pa=Math.abs(ra-oa.point.x);pa<oa.deltaX&&(oa.s0b=wa,oa.deltaX=pa);ya+pa===Da?(oa.cp=wa,oa.xYa=ra):Da+pa===ya?(oa.qCa=oa.cp<oa.qCa?oa.cp+1:oa.cp-1,oa.cp=wa,oa.xYa=ra):ya+Da===pa&&(oa.Jrb=!0,oa.x1d=!0)}oa.qCa===oa.cp&&(oa.Jrb=!0);return!1}tYj(oa){var wa=this.PPa(oa.element,oa.originalText,oa.cp,oa.Fia,
oa.q6a,void 0,void 0,oa.$O);if(0<wa.height&&wa.y+wa.height/2<=oa.cVa||wa.y+wa.height/2>=oa.aVa)return!1;if(wa.x<=oa.point.x&&wa.x+wa.width>=oa.point.x)return oa.T2b=!0;wa=Math.abs(wa.x+wa.width/2-oa.point.x);wa<oa.deltaX&&(oa.s0b=oa.cp,oa.deltaX=wa);return!1}Eri(oa){if(!oa.T2b&&-1===oa.s0b)return this.SJb(),this.ld.Wb(w.a.ujk,{["Reason"]:n.a.ISf}),null;oa.T2b?oa.deltaX=0:oa.cp=oa.s0b;A.a.jx(oa.originalText,oa.cp)&&oa.cp--;this.SJb();return new T(oa.cp,oa.deltaX)}Kt(oa,wa,ra=!1,ya=!1,Da=!1,pa=null){let la;
oa||v.ULS.sendTraceTag(6870734,315,50,"paragraphElement is null");let Fa=({i:za,ft:la,Q7:Da,Xik:wa}=this.N4f(oa,wa,Da)).returnValue,Qa="";Qa=oa.Fia;oa=C.a.sv(Fa.htmlElement);let Sa=oa.length,Na,ua=!1;if(!Sa)if(Na=Sys.UI.DomElement.getBounds(Fa.htmlElement),ua=!0,!Na.height&&za<la.length-1)za++,Fa=la[za],oa=J.b(Fa.htmlElement),Sa=oa.length;else if(!Fa.htmlElement.firstChild||Fa.Qfg)return this.HP.pga(Na,pa,()=>Fa.htmlElement.offsetWidth/Fa.htmlElement.offsetHeight);var za=!1;!ua&&wa>=Sa&&(wa=Sa-1,
za=!0);if(Na=Fa.K3||!Fa.htmlElement.firstChild||Fa.afg?this.oRd(Fa,pa):this.PPa(Fa.htmlElement,oa,wa,Qa,Da,ra,ya,pa))ua?Na.width=1:za&&(Na.x+=Na.width,Na.width=1);this.SJb();return Na}dEa(oa,wa,ra=!1,ya=!0){return this.N4f(oa,wa,ra,ya).returnValue}$9b(oa,wa){return wa.y>oa.y+oa.height-Y.Zsa(oa.height)}N4f(oa,wa,ra=!1,ya=!0){let Da,pa,la=oa;Da=oa.k6;for(oa=pa=0;oa<Da.length;oa++){if(Da[oa].ryb)continue;let Fa;if(Da[oa].K3){if(!wa){ra||this.KNj(Da,oa)?la=Da[oa]:(la=Da[oa-1],wa=Fa=C.a.e9a(la.htmlElement),
pa-=Fa);break}wa--;pa++;continue}Fa=C.a.e9a(Da[oa].htmlElement);let Qa=!1;if(this.hTh){const Sa=Da[oa].htmlElement,Na=Sa.nextSibling;Na&&(Qa=Sys.UI.DomElement.containsCssClass(Sa,"EmptyTextRun")&&Sys.UI.DomElement.containsCssClass(Na,"Hyperlink"))}if(wa<Fa||!wa&&ya&&!Qa||oa>=Da.length-1){la=Da[oa];break}else wa-=Fa,pa+=Fa}return{returnValue:la,i:oa,ft:Da,Q7:pa,Xik:wa}}KNj(oa,wa){if(!wa)return!0;const ra=this.Orb(oa[wa-1].htmlElement);oa=this.Orb(oa[wa].htmlElement);return this.$9b(ra,oa)}PPa(oa,wa,
ra,ya,Da,pa=!1,la=!1,Fa=null){let Qa=ra+1;ra||wa.length?A.a.jx(wa,ra)?ra--:A.a.jx(wa,Qa)&&Qa++:Qa=0;if(""!==ya)if(ya=Da+ra+"-"+ya,this.KSb){if(Da=this.xmb[ya],void 0!==Da&&null!==Da)return ya=this.HP.pga(Da,Fa,()=>this.HP.rYf(oa,ra)),ya=this.UNa.LOd(Fa,oa,ya)}else this.xmb={},this.KSb=!0;Da=this.Otc(oa,ra,Qa);pa=pa&&(E.a.Dj||E.a.to);if(!Da&&!la||pa)wa=this.Cgk(oa,wa,ra,Qa),Da||(Da=wa),pa&&Da&&(Da.y=wa.y,Da.height=wa.height);""!==ya&&Da&&(this.xmb[ya]=new Sys.UI.Bounds(Da.x,Da.y,Da.width,Da.height));
ya=this.HP.pga(Da,Fa,()=>this.HP.rYf(oa,ra));return ya=this.UNa.LOd(Fa,oa,ya)}Otc(oa,wa,ra){let ya=null;if(this.R4b(oa)<ra)return null;E.a.dV&&(ya=this.Bgk(oa,wa,ra));!ya&&E.a.Dj&&(ya=this.Dgk(oa,wa,ra));return ya}Jxf(oa,wa=null){return this.Orb(oa.htmlElement.firstChild,wa)}oRd(oa,wa=null){return oa.nUa?this.Jxf(oa,wa):this.Orb(oa.htmlElement,wa)}Orb(oa,wa=null){var ra=Sys.UI.DomElement.getBounds(oa);ra=this.HP.pga(ra,wa,()=>oa.offsetWidth/oa.offsetHeight);return ra=this.UNa.LOd(wa,oa,ra)}QZ(oa,
wa,ra,ya,Da,pa){return oa!==wa.characterData.length||ra?this.Vhi(oa,wa,ra,ya,Da,pa):this.Uhi(wa)}Uhi(oa){const wa=this.QPa(oa);return this.v_f(wa,!oa.isRtl)}Vhi(oa,wa,ra,ya,Da,pa){var la=wa.textLength;if(E.a.wT&&ra&&0<oa&&oa<la){var Fa=this.dEa(wa,oa-1,!0),Qa=this.dEa(wa,oa,!0);Fa===Qa&&(ra=!1)}var Sa=ra?oa-1:oa;A.a.jx(wa.characterData,Sa)&&--Sa;var Na=!0;Qa=this.dEa(wa,Sa,!0,!1);if(Qa.K3)if(Qa.nUa){if(ra)return this.QZ(oa,wa,!1,ya,!1,pa);Fa=this.Jxf(Qa)}else if(Qa.mZc){if(ra)return this.QZ(oa,wa,
!1,ya,!1,pa);if(oa)return this.QZ(oa,wa,!0,ya,!1,pa);Fa=this.oRd(Qa)}else Fa=this.Orb(Qa.htmlElement),Qa.aNj&&(Na=!1);else{Qa=Sa;do{Fa=this.Kt(wa,Qa,Da,pa);if(!Fa)return null;Qa+=1}while(!Fa.height&&Qa<=la)}Qa=la=wa.isRtl;if(Na){Na=this.eGc(wa,Sa,-1,Da,pa);Da=this.eGc(wa,Sa,1,Da,pa);pa=new Sys.UI.Point(Fa.x+Fa.width/2,Fa.y+Fa.height/2);Sa=Fa.y;var ua=Fa.y+Fa.height;Sa=!Na||Na.y+Na.height<=Sa;ua=!Da||Da.y>=ua;let za=!1;Sa||ua?Sa||A.a.Xy(wa.characterData.charCodeAt(oa))?ua||(Da.x>=pa.x?Qa=!1:Da.x<=
pa.x&&(Qa=!0),za=Qa!==la):(Na.x<=pa.x?Qa=!1:Na.x>=pa.x&&(Qa=!0),za=Qa!==la):Na.x<=pa.x&&pa.x<=Da.x?Qa=!1:Da.x<=pa.x&&pa.x<=Na.x?Qa=!0:Na.x<Da.x?(Qa=!0,za=ra?pa.x<Na.x:Na.x<pa.x):Da.x<Na.x&&(Qa=!1,za=ra?Na.x<pa.x:pa.x<Na.x);if(za&&E.a.MF){if(ra&&!ya)return this.QZ(oa,wa,!1,!1);oa||(Fa=this.Y6i(wa,la))}}return this.v_f(Fa,Qa===ra)}eGc(oa,wa,ra,ya,Da){if(0>ra&&0>=wa||0<ra&&wa>=oa.characterData.length-1)return null;const pa=wa+ra;return A.a.jx(oa.characterData,pa)?this.eGc(oa,pa,ra,ya,Da):this.dEa(oa,
wa,!0,!1).nUa?null:(wa=this.Kt(oa,pa,ya,Da))?wa.height&&wa.width?wa:this.eGc(oa,pa,ra,ya,Da):null}Y6i(oa,wa){let ra=null;for(var ya=0;ya<oa.k6.length;ya++){const Da=oa.k6[ya];if(!Da.ryb){ra=Da.htmlElement;break}}for(ya=ra.childNodes[0];ya&&1===ya.nodeType;)ra=ya,ya=ra.childNodes[0];ya=C.a.sv(ra);C.a.Ix(ra,(wa?"\u202e":"\u202d")+ya);this.rda();oa=this.Kt(oa,0);C.a.Ix(ra,ya);this.rda();return oa}v_f(oa,wa){return new Sys.UI.Bounds(wa?oa.x:oa.x+oa.width,oa.y,0,oa.height)}QPa(oa,wa=null){return this.Orb(oa.JQf.htmlElement,
wa)}Bgk(oa,wa,ra){this.SJb();try{const ya=oa.firstChild,Da=ya.ownerDocument.createRange();Da.setStart(ya,wa);Da.setEnd(ya,ra);const pa=this.Rcj(Da,(la,Fa)=>(0<la||wa===ra)&&0<Fa);if(!pa||!pa.length)return null;this.mtf(ya,pa[0]);Da.detach();return pa[0]}catch(ya){return null}}Rcj(oa,wa){this.SJb();try{let ra;ra=oa.getClientRects();oa=[];for(let ya=0;ya<ra.length;ya++){const Da=ra[ya];if(Da){const pa=Math.floor(Da.width/1),la=Math.floor(Da.height/1);if(wa(pa,la)){const Fa=new Sys.UI.Bounds(Math.floor(Da.left/
1),Math.floor(Da.top/1),pa,la);Array.add(oa,Fa)}}}return oa}catch(ra){return null}}Dgk(oa,wa,ra){if(!E.a.VMb)return null;let ya=null;try{ya=oa.ownerDocument.body.createTextRange(),ya.moveToElementText(oa)}catch(Da){return null}if(ya.collapse&&ya.move&&ya.moveEnd)ya.collapse(),ya.move("character",wa),ya.moveEnd("character",ra-wa);else return null;wa=new Sys.UI.Bounds(ya.boundingLeft,ya.boundingTop,ya.boundingWidth,ya.boundingHeight);if(!(wa.x||wa.y||wa.width||wa.height))return null;this.mtf(oa,wa);
oa=window.screen.deviceXDPI/window.screen.logicalXDPI;1!==oa&&(wa.x=Math.round(wa.x/oa),wa.y=Math.round(wa.y/oa),wa.width=Math.round(wa.width/oa),wa.height=Math.round(wa.height/oa));return wa}Cgk(oa,wa,ra,ya){this.L4a&&this.L4a.ownerDocument===oa.ownerDocument||(this.L4a=oa.ownerDocument.createElement("SPAN"),this.Hpb=oa.ownerDocument.createElement("SPAN"),this.gDc=oa.ownerDocument.createElement("SPAN"));oa.firstChild!==this.L4a&&(this.KAc=new H.a(oa),C.a.tu(oa),this.UNa&&this.UNa.gsi(this.L4a,this.Hpb,
this.gDc),oa.appendChild(this.L4a),oa.appendChild(this.Hpb),oa.appendChild(this.gDc));C.a.Ix(this.L4a,A.a.substring(wa,0,ra));C.a.Ix(this.Hpb,A.a.substring(wa,ra,ya));C.a.Ix(this.gDc,A.a.substring(wa,ya,wa.length));I.AFrameworkApplication.fa.ka("ChromiumSpanIssueFixIsEnabled")&&E.a.Uj&&E.a.SIj&&" "===A.a.substring(wa,ra,ya)&&Sys.UI.DomElement.addCssClass(this.Hpb,"WhiteSpaceSpanElement");return Sys.UI.DomElement.getBounds(this.Hpb)}mtf(oa,wa){this.Vai(oa,[wa])}Vai(oa,wa){try{if(void 0!==oa.ownerDocument.parentWindow){var ra=
oa.ownerDocument.parentWindow.frameElement;if(ra&&("0"===ra.frameBorder||"no"===ra.frameBorder))for(oa=0;oa<wa.length;oa++)wa[oa].x+=2,wa[oa].y+=2}}catch(ya){}}SJb(){this.KAc&&this.KAc.restore();this.KAc=null}Prb(oa,wa){if(""!==wa){let ra;if(this.KSb){if(ra=this.xmb["VE-"+wa])return oa=new Sys.UI.Bounds(ra.x,ra.y,ra.width,ra.height)}else this.xmb={},this.KSb=!0;ra=Sys.UI.DomElement.getBounds(oa);this.xmb["VE-"+wa]=ra;return oa=new Sys.UI.Bounds(ra.x,ra.y,ra.width,ra.height)}return Sys.UI.DomElement.getBounds(oa)}static get instance(){return Y.Ka||
(Y.Ka=new Y(e.a.instance,k.a.instance.Ja("Common.IZoomManager"),I.AFrameworkApplication.fa,k.a.instance.resolve("Box4.TextMetricsApi.IMeasureBoundsUsingSpansStrategy"),k.a.instance.resolve("Box4.IRotatingCoordinateConverter"),k.a.instance.resolve("Box4.TextMetricsApi.ITextMetricsHelper")))}static Zsa(oa){return Q.SelectionEditor.Zsa(oa)}}Y.Ka=null;Object(K.a)(Y,"TextMetrics",null,[]);var S=d(96);class da{get nUa(){return Sys.UI.DomElement.containsCssClass(this.htmlElement,S.a.aac)}get K3(){return Sys.UI.DomElement.containsCssClass(this.htmlElement,
S.a.hN)}get mZc(){return Sys.UI.DomElement.containsCssClass(this.htmlElement,S.a.rwk)}get aNj(){return Sys.UI.DomElement.containsCssClass(this.htmlElement,S.a.vEj)||Sys.UI.DomElement.containsCssClass(this.htmlElement,S.a.uEj)||Sys.UI.DomElement.containsCssClass(this.htmlElement,S.a.sEj)}get Qfg(){return Sys.UI.DomElement.containsCssClass(this.htmlElement,S.a.E_d)}get afg(){return Sys.UI.DomElement.containsCssClass(this.htmlElement,S.a.ZFf)}}Object(K.a)(da,"ATextMetricsElement",null,[275]);var fa=
d(31),ka=d(149);class ha extends da{constructor(oa){super();this.wP=oa}get htmlElement(){return this.wP}get Aka(){return Sys.UI.DomElement.containsCssClass(this.htmlElement,S.a.vN)}get ryb(){return Sys.UI.DomElement.containsCssClass(this.htmlElement,ka.a.eW)}get KMj(){return Sys.UI.DomElement.containsCssClass(this.htmlElement,S.a.IGj)}get xJj(){return Sys.UI.DomElement.containsCssClass(this.htmlElement,S.a.thi)||Sys.UI.DomElement.containsCssClass(this.htmlElement,S.a.xEj)}get wJj(){return Sys.UI.DomElement.containsCssClass(this.htmlElement,
S.a.shi)||Sys.UI.DomElement.containsCssClass(this.htmlElement,S.a.wEj)}}Object(K.a)(ha,"TextMetricsLeafElement",da,[345,275]);var F=d(52),na=d(57);class ba extends da{constructor(oa){super();this.Mob=oa;this.Ii=this.Mob.gb;this.yWb=Array(oa.gt.length);for(oa=0;oa<this.Mob.gt.length;oa++){const wa=new ha(this.Mob.gt[oa]);this.yWb[oa]=wa}}get k6(){return this.yWb}get paragraphId(){return this.Ii.id.toString()}get htmlElement(){return this.Mob.htmlElement}get Fia(){return this.Mob.Qc.Mh?this.Mob.gb.id.toString():
""}get textLength(){return fa.ParagraphReader.textLength(this.Ii)}get isRtl(){return na.OutlineElementReader.um(F.OutlineElementNavigator.PA(this.Ii))}get hs(){return fa.ParagraphReader.Yd(this.Ii)&&!this.Ii.QW}get characterData(){return this.Ii.characterData}get JQf(){return this.yWb.length?this.yWb[this.yWb.length-1]:null}static i7a(oa){return new ba(oa)}}Object(K.a)(ba,"TextMetricsParagraphElement",da,[274,275]);var Ea=d(49),La=d(32);d.d(Z,"a",function(){return ta});class ta{static get r0b(){return ta.yA||
(ta.yA=k.a.instance.rb("Box4.CharacterPointConverter"))}static get Wc(){return e.a.instance}static Kt(oa,wa,ra=!1,ya=!1,Da=!1,pa=null){oa=ba.i7a(oa);return Y.instance.Kt(oa,wa,ra,ya,Da,pa)}static Otc(oa,wa,ra){return Y.instance.Otc(oa,wa,ra)}static Prb(oa,wa){return Y.instance.Prb(oa,wa)}static QZ(oa,wa,ra,ya,Da=!1,pa=!1){wa=ba.i7a(wa);return Y.instance.QZ(oa,wa,ra,ya,Da,pa)}static QPa(oa,wa=null){oa=ba.i7a(oa);return Y.instance.QPa(oa,wa)}static rda(){Y.instance.rda()}static e7a(oa,wa,ra,ya=null){let Da=
null,pa=null;try{const la=ba.i7a(oa);let Fa=null;Da=ta.Wc.Vp(La.a.x3i);(Fa=Y.instance.e7a(la,wa,ra,ya))&&(pa=ta.r0b?ta.r0b.hHl(Fa,oa.gb):Ea.a.xQa(Fa.CpBegin,Fa.CpEnd,Fa.IsEop,oa.gb))}catch(la){ta.Wc.Wb(r.a.GFl,{["Reason"]:n.a.iSi,["ExceptionMessage"]:la.message,["ExceptionCallstack"]:la.stack}),pa=null}Da&&Da.end();return pa}static dEa(oa,wa,ra=!1,ya=!0){oa=ba.i7a(oa);return Y.instance.dEa(oa,wa,ra,ya).htmlElement}static $9b(oa,wa){return Y.instance.$9b(oa,wa)}}ta.yA=null;Object(K.a)(ta,"TextMetricsAdapter",
null,[])},309:function(K,Z,d){K=d(0);var k=d(382),e=d(25),n=d(1213);const r=(C,w)=>{const z={};let A=null;switch(C){case 0:A="HtmlProcessor";var u=w.a;null!=u&&(z.SessionID=u);var E=w.b.toString();null!=E&&(z.Elements=E);var H=w.c.toString();null!=H&&(z.PrunedElements=H);var I=w.d.toString();null!=I&&(z.TransparentElements=I);var J=w.e.toString();null!=J&&(z.VoidElements=J);var T=w.f.toString();null!=T&&(z.UnknownElements=T);break;case 1:A="WordConverter";var D=w.a;null!=D&&(z.SessionID=D);var R=
w.b.toString();null!=R&&(z.BulletsConverted=R);var Q=w.c.toString();null!=Q&&(z.NumberedConverted=Q);break;case 2:A="FormattingSteward";var W=w.a;null!=W&&(z.SourceApp=W);var O=w.b;null!=O&&(z.Browser=O);var Y=w.c;null!=Y&&(z.OperationId=Y);var S=w.d.toString();null!=S&&(z.Lang=S);var da=w.e.toString();null!=da&&(z.TextDir=da);var fa=w.f.toString();null!=fa&&(z.Bold=fa);var ka=w.g.toString();null!=ka&&(z.Math=ka);var ha=w.h.toString();null!=ha&&(z.Italics=ha);var F=w.i.toString();null!=F&&(z.Underline=
F);var na=w.j.toString();null!=na&&(z.Strikethrough=na);var ba=w.k.toString();null!=ba&&(z.Subscript=ba);var Ea=w.l.toString();null!=Ea&&(z.Superscript=Ea);var La=w.m.toString();null!=La&&(z.Fontsize=La);var ta=w.n.toString();null!=ta&&(z.Fontface=ta);var oa=w.o.toString();null!=oa&&(z.GrowFontsize=oa);var wa=w.p.toString();null!=wa&&(z.ShrinkFontsize=wa);var ra=w.q.toString();null!=ra&&(z.FontColor=ra);var ya=w.r.toString();null!=ya&&(z.FontHighlight=ya);var Da=w.s.toString();null!=Da&&(z.ParagraphStyle=
Da);var pa=w.t.toString();null!=pa&&(z.TextAlign=pa);var la=w.u.toString();null!=la&&(z.TextIndent=la);var Fa=w.v.toString();null!=Fa&&(z.MarginLeft=Fa);var Qa=w.w.toString();null!=Qa&&(z.ParagraphSpaceBefore=Qa);var Sa=w.x.toString();null!=Sa&&(z.ParagraphSpaceAfter=Sa);var Na=w.y.toString();null!=Na&&(z.LineSpace=Na);var ua=w.z.toString();null!=ua&&(z.CellShadingColor=ua);break;case 3:A="SemanticEvents";var za=w.a;null!=za&&(z.SessionID=za);var Wa=w.b.toString();null!=Wa&&(z.Text=Wa);var yb=w.c.toString();
null!=yb&&(z.LineBreak=yb);var Za=w.d.toString();null!=Za&&(z.Image=Za);var ub=w.e.toString();null!=ub&&(z.File=ub);var Ib=w.f.toString();null!=Ib&&(z.FormattingChange=Ib);var Ob=w.g.toString();null!=Ob&&(z.Anchor=Ob);var Hc=w.h.toString();null!=Hc&&(z.Paragraph=Hc);var kb=w.i.toString();null!=kb&&(z.Math=kb);var jb=w.j.toString();null!=jb&&(z.List=jb);var hb=w.k.toString();null!=hb&&(z.ListItem=hb);var uc=w.l.toString();null!=uc&&(z.RenderAugmentation=uc);var mc=w.m.toString();null!=mc&&(z.Span=
mc);break;case 4:A="SemanticTableEvents";var Ya=w.a;null!=Ya&&(z.SessionID=Ya);var Mb=w.b.toString();null!=Mb&&(z.Tables=Mb);var Kc=w.c.toString();null!=Kc&&(z.TableRow=Kc);var eb=w.d.toString();null!=eb&&(z.TableCell=eb);var Tb=w.e.toString();null!=Tb&&(z.TablePart=Tb);break;case 5:A="HtmlEvents";var lb=w.a;null!=lb&&(z.OperationId=lb);var Fb=w.b;null!=Fb&&(z.SourceApp=Fb);var rb=w.c;null!=rb&&(z.Browser=rb);var Qb=null==w.d?null:w.d.toString();null!=Qb&&(z.Text=Qb);var Bc=null==w.e?null:w.e.toString();
null!=Bc&&(z.A=Bc);var wb=null==w.f?null:w.f.toString();null!=wb&&(z.Abbr=wb);var Ad=null==w.g?null:w.g.toString();null!=Ad&&(z.Acronym=Ad);var bc=null==w.h?null:w.h.toString();null!=bc&&(z.Address=bc);var Sb=null==w.i?null:w.i.toString();null!=Sb&&(z.Applet=Sb);var Zb=null==w.j?null:w.j.toString();null!=Zb&&(z.Area=Zb);var cb=null==w.k?null:w.k.toString();null!=cb&&(z.B=cb);var Xa=null==w.l?null:w.l.toString();null!=Xa&&(z.Base=Xa);var Lb=null==w.m?null:w.m.toString();null!=Lb&&(z.Basefont=Lb);var pc=
null==w.n?null:w.n.toString();null!=pc&&(z.Bdo=pc);var fc=null==w.o?null:w.o.toString();null!=fc&&(z.Big=fc);var bd=null==w.p?null:w.p.toString();null!=bd&&(z.Blockquote=bd);var od=null==w.q?null:w.q.toString();null!=od&&(z.Body=od);var ye=null==w.r?null:w.r.toString();null!=ye&&(z.Br=ye);var pd=null==w.s?null:w.s.toString();null!=pd&&(z.Button=pd);var ab=null==w.t?null:w.t.toString();null!=ab&&(z.Caption=ab);var Yb=null==w.u?null:w.u.toString();null!=Yb&&(z.Center=Yb);var Sc=null==w.v?null:w.v.toString();
null!=Sc&&(z.Cite=Sc);var Jb=null==w.w?null:w.w.toString();null!=Jb&&(z.Code=Jb);var Oc=null==w.x?null:w.x.toString();null!=Oc&&(z.Col=Oc);var Wb=null==w.y?null:w.y.toString();null!=Wb&&(z.Colgroup=Wb);var Ab=null==w.z?null:w.z.toString();null!=Ab&&(z.Dd=Ab);var Xb=null==w.ba?null:w.ba.toString();null!=Xb&&(z.Del=Xb);var vb=null==w.bb?null:w.bb.toString();null!=vb&&(z.Dfn=vb);var $c=null==w.bc?null:w.bc.toString();null!=$c&&(z.Dir=$c);var fd=null==w.bd?null:w.bd.toString();null!=fd&&(z.Div=fd);var Bd=
null==w.be?null:w.be.toString();null!=Bd&&(z.Dl=Bd);var gd=null==w.bf?null:w.bf.toString();null!=gd&&(z.Dt=gd);var Pd=null==w.bg?null:w.bg.toString();null!=Pd&&(z.Em=Pd);var cd=null==w.bh?null:w.bh.toString();null!=cd&&(z.Fieldset=cd);var lf=null==w.bi?null:w.bi.toString();null!=lf&&(z.Font=lf);var Jd=null==w.bj?null:w.bj.toString();null!=Jd&&(z.Form=Jd);var Xf=null==w.bk?null:w.bk.toString();null!=Xf&&(z.Frame=Xf);var ee=null==w.bl?null:w.bl.toString();null!=ee&&(z.Frameset=ee);var Ra=null==w.bm?
null:w.bm.toString();null!=Ra&&(z.H=Ra);var sb=null==w.bn?null:w.bn.toString();null!=sb&&(z.Head=sb);var ec=null==w.bo?null:w.bo.toString();null!=ec&&(z.Hr=ec);var Lc=null==w.bp?null:w.bp.toString();null!=Lc&&(z.Html=Lc);var nd=null==w.bq?null:w.bq.toString();null!=nd&&(z.I=nd);var Fd=null==w.br?null:w.br.toString();null!=Fd&&(z.Iframe=Fd);var Ja=null==w.bs?null:w.bs.toString();null!=Ja&&(z.Img=Ja);var db=null==w.bt?null:w.bt.toString();null!=db&&(z.Input=db);var ic=null==w.bu?null:w.bu.toString();
null!=ic&&(z.Ins=ic);var id=null==w.bv?null:w.bv.toString();null!=id&&(z.Isindex=id);var qd=null==w.bw?null:w.bw.toString();null!=qd&&(z.Kbd=qd);var Fc=null==w.bx?null:w.bx.toString();null!=Fc&&(z.Label=Fc);var Ze=null==w.by?null:w.by.toString();null!=Ze&&(z.Legend=Ze);var df=null==w.bz?null:w.bz.toString();null!=df&&(z.Li=df);var ve=null==w.ca?null:w.ca.toString();null!=ve&&(z.Link=ve);var md=null==w.cb?null:w.cb.toString();null!=md&&(z.Map=md);var Kf=null==w.cc?null:w.cc.toString();null!=Kf&&(z.Math=
Kf);var oe=null==w.cd?null:w.cd.toString();null!=oe&&(z.Menu=oe);var Hf=null==w.ce?null:w.ce.toString();null!=Hf&&(z.Meta=Hf);var xb=null==w.cf?null:w.cf.toString();null!=xb&&(z.Noframes=xb);var hg=null==w.cg?null:w.cg.toString();null!=hg&&(z.Noscript=hg);var rf=null==w.ch?null:w.ch.toString();null!=rf&&(z.Object=rf);var nf=null==w.ci?null:w.ci.toString();null!=nf&&(z.Ol=nf);var kd=null==w.cj?null:w.cj.toString();null!=kd&&(z.Optgroup=kd);var If=null==w.ck?null:w.ck.toString();null!=If&&(z.Option=
If);var og=null==w.cl?null:w.cl.toString();null!=og&&(z.P=og);var pf=null==w.cm?null:w.cm.toString();null!=pf&&(z.Param=pf);var ig=null==w.cn?null:w.cn.toString();null!=ig&&(z.Pre=ig);var Oe=null==w.co?null:w.co.toString();null!=Oe&&(z.Q=Oe);var Ag=null==w.cp?null:w.cp.toString();null!=Ag&&(z.S=Ag);var ce=null==w.cq?null:w.cq.toString();null!=ce&&(z.Samp=ce);var me=null==w.cr?null:w.cr.toString();null!=me&&(z.Script=me);var Je=null==w.cs?null:w.cs.toString();null!=Je&&(z.Select=Je);var ie=null==w.ct?
null:w.ct.toString();null!=ie&&(z.Small=ie);var Tf=null==w.cu?null:w.cu.toString();null!=Tf&&(z.Span=Tf);var He=null==w.cv?null:w.cv.toString();null!=He&&(z.Strike=He);var Sg=null==w.cw?null:w.cw.toString();null!=Sg&&(z.Strong=Sg);var jc=null==w.cx?null:w.cx.toString();null!=jc&&(z.Style=jc);var be=null==w.cy?null:w.cy.toString();null!=be&&(z.Sub=be);var Md=null==w.cz?null:w.cz.toString();null!=Md&&(z.Sup=Md);var de=null==w.da?null:w.da.toString();null!=de&&(z.Tables=de);var Zc=null==w.db?null:w.db.toString();
null!=Zc&&(z.Tbody=Zc);var Yf=null==w.dc?null:w.dc.toString();null!=Yf&&(z.Td=Yf);var Vc=null==w.dd?null:w.dd.toString();null!=Vc&&(z.Textarea=Vc);var zc=null==w.de?null:w.de.toString();null!=zc&&(z.Tfoot=zc);var vf=null==w.df?null:w.df.toString();null!=vf&&(z.Th=vf);var Tg=null==w.dg?null:w.dg.toString();null!=Tg&&(z.Thead=Tg);var bb=null==w.dh?null:w.dh.toString();null!=bb&&(z.Title=bb);var Vb=null==w.di?null:w.di.toString();null!=Vb&&(z.Tr=Vb);var Ub=null==w.dj?null:w.dj.toString();null!=Ub&&(z.Tt=
Ub);var Jc=null==w.dk?null:w.dk.toString();null!=Jc&&(z.U=Jc);var Mc=null==w.dl?null:w.dl.toString();null!=Mc&&(z.Ul=Mc);var ed=null==w.dm?null:w.dm.toString();null!=ed&&(z.Var=ed);var dd=null==w.dn?null:w.dn.toString();null!=dd&&(z.Unknown=dd);break;case 6:A="List";var je=w.a;null!=je&&(z.SessionID=je);var Nd=w.b.toString();null!=Nd&&(z.MaxListLevel=Nd)}z.Table=A;return Sys.Serialization.JavaScriptSerializer.serialize(z)};d.d(Z,"a",function(){return v});class v{static get X8(){null==v.l3a&&(v.l3a=
!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("UsageEditorLoggingIsDisabled"));return v.l3a}static get Ghg(){null==v.ACd&&(v.ACd=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("WordUsageEditorLoggingIsEnabled"));return v.ACd}static NQ(C){k.ULS.sendTraceTag(5822145,307,50,C)}static o0f(C){const w={};w.a=C;w.b=0;w.c=0;w.d=0;w.e=0;w.f=0;return w}static X0j(C){v.X8||v.NQ(r(0,C))}static b$d(C){const w={};w.a=C;w.b=0;w.c=0;return w}static W2j(C){v.X8||v.NQ(r(1,C))}static n0f(C,
w){const z={};z.c=n.a[C];z.a=w;return z}static W0j(C,w){v.Ghg&&C&&(C.b=w,v.NQ(r(5,C)))}static b4f(C){const w={};w.a=C;w.b=0;w.c=0;w.d=0;w.e=0;w.f=0;w.g=0;w.h=0;w.i=0;w.j=0;w.k=0;w.l=0;w.m=0;return w}static j2j(C){v.X8||v.NQ(r(3,C))}static c4f(C){const w={};w.a=C;w.b=0;w.c=0;w.d=0;w.e=0;return w}static k2j(C){v.X8||v.NQ(r(4,C))}static V5d(C,w){const z={};z.b=n.a[C];z.c=w;z.d=0;z.e=0;z.f=0;z.g=0;z.h=0;z.i=0;z.j=0;z.k=0;z.l=0;z.m=0;z.n=0;z.o=0;z.p=0;z.q=0;z.r=0;z.s=0;z.t=0;z.w=0;z.x=0;z.y=0;z.z=0;z.u=
0;z.v=0;return z}static L0j(C,w){v.Ghg&&C&&(C.a=w,v.NQ(r(2,C)))}static Laj(C){const w={};w.a=C;w.b=-1;return w}static p1j(C){!v.X8&&C&&0<=C.b&&v.NQ(r(6,C))}}v.l3a=null;v.ACd=null;Object(K.a)(v,"UsageEditor",null,[])},326:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k{}k.Taa=1E5;Object(K.a)(k,"ViewConstants",null,[])},327:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k{constructor(){this.ke=this.ag=this.fe=this.Nf=0}WTi(e){return e.ke<this.ag&&this.ke<e.ag&&e.fe<this.Nf&&
this.fe<e.Nf}Oub(e){return e.ke>=this.ke&&e.ag<=this.ag&&e.fe>=this.fe&&e.Nf<=this.Nf}OTi(e,n){return e>=this.zUf&&e<=this.Sle&&n>=this.sUf&&n<=this.Kle}JRa(){return 0>=this.OO||0>=this.sR}equals(e){return e.ke===this.ke&&e.ag===this.ag&&e.fe===this.fe&&e.Nf===this.Nf}clone(){return Object.assign(new k,{ke:this.ke,ag:this.ag,fe:this.fe,Nf:this.Nf})}toString(){return String.format("CellRange, rowFirst:{0}, rowLim:{1}, colFirst:{2}, colLim:{3}",this.ke,this.ag,this.fe,this.Nf)}get OO(){return this.ag-
this.ke}get sR(){return this.Nf-this.fe}get Sle(){return this.ag-1}get Kle(){return this.Nf-1}get zUf(){return this.ke}get sUf(){return this.fe}}Object(K.a)(k,"CellRange",null,[])},328:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k{}k.qW="data-copystatus";k.uQa="data-copyfailedreason";k.Gp="data-clipservice-ccpid";k.version="data-clipservice-version";k.location="data-clipservice-location";k.mD="data-clipservice-dc";k.type="data-clipservice-type";k.rEe="data-clipservice-param";k.count=
"data-clipservice-count";k.XEa="data-clipservice-cut";k.VEa="data-clipservice-isEmptyPlaceholder";k.client="data-clipservice-client";k.Vsi="data-clipboardasbytes-url";k.JIh="wacserver";k.sessionId="data-SessionId";k.Jjb="data-ShapeIds";k.slideId="data-SlideId";k.timeStamp="data-TimeStamp";k.rAj="data-willexpire";k.mbg="ClipboardAsImage";k.ty="data-pkey";Object(K.a)(k,"ClipServiceConstants",null,[])},339:function(K,Z,d){var k=d(17),e=d(112),n=d(497),r=d(147),v=d(228);K=d(0);var C=d(204),w=d(26);class z{constructor(Q,
W,O,Y){this.type=Q;this.stops=W;this.angle=O;this.dzk=Y}jV(){const Q=C.b(this.stops,W=>W.jV()).join(",");if(0===this.type)return String.format("linear-gradient({0}deg, {1})",this.angle,Q);if(1===this.type||2===this.type)return String.format("radial-gradient(circle at {0}, {1})",this.dzk.jV(),Q);w.a.J(18392962,822,15,String.format("Unexpected gradient type encountered: {0}.",this.type));return v.Color.auto.jV()}static createLinearGradient(Q,W){return new z(0,Q,W,null)}static uEi(Q,W){return new z(1,
Q,0,W)}}Object(K.a)(z,"GradientFill",null,[]);class A{constructor(Q,W){this.left=Q;this.top=W}jV(){return String.format("{0}% {1}%",this.left,this.top)}}Object(K.a)(A,"GradientPathCenter",null,[]);class u{constructor(Q,W){this.color=Q;this.position=W}jV(){return String.format("{0} {1}%",this.color.jV(),this.position)}}Object(K.a)(u,"GradientStop",null,[]);d.d(Z,"a",function(){return E});d.d(Z,"g",function(){return H});d.d(Z,"e",function(){return I});d.d(Z,"b",function(){return J});d.d(Z,"c",function(){return T});
d.d(Z,"f",function(){return D});d.d(Z,"d",function(){return R});const E=Q=>{Q?(Q=e.a(Q),Q=Object.assign(new n.a,{blipFillField:Q.blipFillField||null,gradFillField:Q.gradFillField||null,grpFillField:Q.grpFillField||null,noFillField:Q.noFillField||null,pattFillField:Q.pattFillField||null,solidFillField:Q.solidFillField||null})):Q=null;return Q},H=Q=>{r.Box4ColorHelper.sRa(Q)},I=Q=>{Q=e.a(Q);return!Q||!Q.blipFillField&&!Q.gradFillField&&!Q.grpFillField&&!Q.noFillField&&!Q.pattFillField&&!Q.solidFillField},
J=Q=>{r.Box4ColorHelper.sRa(Q)},T=Q=>{J(Q);Q&&(Q.cell3DField=null,Q.extLstField=null,Q.lnBField=null,Q.lnBlToTrField=null,Q.lnLField=null,Q.lnRField=null,Q.lnTField=null,Q.lnTlToBrField=null)},D=(Q,W)=>{if(!Q)return null;var O=Q.gsLstField;if(O){var Y=new k.a;for(const S of O)O=r.Box4ColorHelper.qOc(S),r.Box4ColorHelper.V$a(O)?w.a.J(18397184,822,15,"Encountered invalid gradient stop color."):Y.add(new u(r.Box4ColorHelper.LJ(O,W),S.posField/1E3));W=Y.toArray()}else W=null;if(Q.linField)return Y=90,
Q.linField.angFieldSpecified&&(Y=(Q.linField.angField/6E4+90)%360),z.createLinearGradient(W,Y);if(Q.pathField)return Y=new A(50,50),Q.pathField.fillToRectField&&(Y=new A(Q.pathField.fillToRectField.lField/1E3,Q.pathField.fillToRectField.tField/1E3)),z.uEi(W,Y);w.a.J(18397154,822,50,"Gradient fill's linField and pathField are both null");return z.createLinearGradient(W,90)},R=Q=>e.b(Q)},344:function(K,Z,d){K=d(0);var k=d(382),e=d(268),n=d(656),r=d(27),v=d(516);class C{}Object(K.a)(C,"ProofingFeedbackLoopRequestObject",
null,[]);var w=d(517),z=d(32),A=d(515);d.d(Z,"a",function(){return u});class u extends n.a{constructor(E,H,I,J,T=null){super(H);this.cba=E;this.HTh=I;this.VXh=J;this.Kbf=!1;this.$a=T;this.errorType=1===(this.cba.CritiqueActions&1)?0:1}get proofingType(){return v.b(this.cba)}get traceId(){return this.cba.TraceId}get typeId(){return this.cba.TypeId}get qN(){return this.cba}get suggestions(){const E=[];if(this.cba.Suggestions)for(const H of this.cba.Suggestions)E.push(H.Text);return E}get metadata(){const E=
[];if(this.cba.Metadata&&0<this.cba.Metadata.length)for(const H of this.cba.Metadata)H.Name&&H.Value&&E.push(H);return E}JLa(E,H=0){this.Hjf.track(()=>Object.assign(new w.a,{E:2,T:this.proofingType,A:E,I:H,G:this.typeId}));if(this.HTh){var I=e.a.ue(this.lcid);let J="";I?J=I.name:k.ULS.sendTraceTag(36316369,375,50,"Lcid results in null CultureInfo: [LCID: {0}]",this.lcid);I=null;k.ULS.sendTraceTag(39416218,375,50,"Sending proofing context with feedback loop API");I=Object.assign(new C,{AppId:A.a[r.App.mode]+
"_online",TraceId:this.traceId,LanguageId:J,CritiqueTypeId:this.typeId,EventId:this.ffk(E),FlaggedText:this.token,SuggestionText:this.Pjj(E),PreContextBegin:this.Y$,PostContextEnd:this.uJa,OriginalText:this.originalText,Suggestions:this.suggestions,CritiquePriority:this.cba.Priority,Metadata:this.cba.Metadata});14!==I.EventId&&this.VXh.N2k(I)}}ffk(E){switch(E){case z.a.ika:return 0;case z.a.Ibe:return 1;case z.a.LCa:return 3;case z.a.Vya:return 4;case z.a.Wya:return 5;case z.a.Xya:return 6;case z.a.eub:return 13;
default:return 14}}Pjj(E){switch(E){case z.a.Vya:return this.suggestions[0];case z.a.Wya:return this.suggestions[1];case z.a.Xya:return this.suggestions[2];case z.a.qLa:return this.suggestions[3];case z.a.rLa:return this.suggestions[4];default:return""}}get wEa(){return this.Kbf}set wEa(E){this.Kbf=E}}Object(K.a)(u,"EditorServiceErrorDetails",n.a,[287,288])},345:function(K,Z,d){var k=d(271),e=d(785),n=d(1215),r=d(45),v=d(213),C=d(25);K=d(0);class w{constructor(){this.g=this.b=0;this.hex=null;this.r=
0}}Object(K.a)(w,"RecentColor",null,[]);var z=d(228),A=d(241),u=d(229),E=d(262),H=d(1030),I=d(532),J=d(26);d.d(Z,"f",function(){return T});d.d(Z,"e",function(){return D});d.d(Z,"d",function(){return R});d.d(Z,"c",function(){return Q});d.d(Z,"g",function(){return W});d.d(Z,"b",function(){return O});d.d(Z,"a",function(){return Y});d.d(Z,"h",function(){return S});const T=(fa,ka,ha,F,na,ba,Ea)=>D(fa,ka,ha,F,na,ba,Ea,!1),D=(fa,ka,ha,F,na,ba,Ea,La)=>{ka=Object.assign(new k.a,{Id:ka,ControlsId:ha,Title:ResourceStrings.L_ThemeFontColor,
ControlList:[]});F=Object.assign(new e.a,{Id:F,ExternalId:na,McuExternalId:String.format("{0}MCU",na),McuLayout:!0,Command:ba,Width:10});if(fa)if(na=[],1===Ea||2===Ea){La=(new H.a).n4i(fa);({themeColors:fa,WAh:Ea}=da(La,fa));for(var ta=0;6>ta;ta++)for(var oa=0;oa<fa.length;oa++){ba=na;ha=ba.push;var wa=void 0,ra=void 0;wa=La;var ya=fa[oa][ta];ra=fa[oa][0];var Da=Ea[oa],pa=ta,la=oa;ya=r.a.dw(ya.r,2)+r.a.dw(ya.g,2)+r.a.dw(ya.b,2);({vJc:wa,LNb:ra}=wa.K4d(ra,ya,Da,pa,la));ya=Object.assign(new n.a,{Color:"#"+
wa,DisplayColor:"#"+ya,Alt:ra});ha.call(ba,ya)}}else for(La=(new H.a).LYf(fa,La),{themeColors:fa,WAh:Ea}=da(La,fa),ta=0;6>ta;ta++)for(oa=0;oa<fa.length;oa++)ba=na,ha=ba.push,wa=La,ya=fa[oa][ta],ra=fa[oa][0],Da=Ea[oa],pa=ta,la=oa,ya=r.a.dw(ya.r,2)+r.a.dw(ya.g,2)+r.a.dw(ya.b,2),{vJc:ra,LNb:wa}=wa.K4d(ra,ya,Da,pa,la),{zZk:ra,j1k:wa,LNb:ya}={zZk:ya,j1k:ra,LNb:wa},ya=Object.assign(new n.a,{Color:wa,DisplayColor:"#"+ra,Alt:ya}),ha.call(ba,ya);else na=null;F.Colors=na;Array.add(ka.ControlList,F);return ka},
R=(fa,ka,ha,F,na,ba)=>{fa=Object.assign(new k.a,{Id:fa,ControlsId:ka,Title:ResourceStrings.L_StandardFontColor,ControlList:[]});ha=Object.assign(new e.a,{Id:ha,ExternalId:F,Command:na,Width:10,Colors:[]});ba?(ha.Colors.push(Object.assign(new n.a,{Color:"0000C0",Alt:r.a.pe(ResourceStrings.L_FontColorDarkRed),DisplayColor:"#C00000"})),ha.Colors.push(Object.assign(new n.a,{Color:"0000FF",Alt:r.a.pe(ResourceStrings.L_FontColorRed),DisplayColor:"#FF0000"})),ha.Colors.push(Object.assign(new n.a,{Color:"00C0FF",
Alt:r.a.pe(ResourceStrings.L_FontColorOrange),DisplayColor:"#FFC000"})),ha.Colors.push(Object.assign(new n.a,{Color:"00FFFF",Alt:r.a.pe(ResourceStrings.L_FontColorYellow),DisplayColor:"#FFFF00"})),ha.Colors.push(Object.assign(new n.a,{Color:"50D092",Alt:r.a.pe(ResourceStrings.L_FontColorLightGreen),DisplayColor:"#92D050"})),ha.Colors.push(Object.assign(new n.a,{Color:"50B000",Alt:r.a.pe(ResourceStrings.L_FontColorDarkGreen),DisplayColor:"#00B050"})),ha.Colors.push(Object.assign(new n.a,{Color:"F0B000",
Alt:r.a.pe(ResourceStrings.L_FontColorLightBlue),DisplayColor:"#00B0F0"})),ha.Colors.push(Object.assign(new n.a,{Color:"C07000",Alt:r.a.pe(ResourceStrings.L_FontColorBlue),DisplayColor:"#0070C0"})),ha.Colors.push(Object.assign(new n.a,{Color:"602000",Alt:r.a.pe(ResourceStrings.L_FontColorDarkBlue),DisplayColor:"#002060"})),ha.Colors.push(Object.assign(new n.a,{Color:"A03070",Alt:r.a.pe(ResourceStrings.L_FontColorPurple),DisplayColor:"#7030A0"}))):(ha.Colors.push(Object.assign(new n.a,{Color:"#C00000",
Alt:r.a.pe(ResourceStrings.L_FontColorDarkRed),DisplayColor:"#C00000"})),ha.Colors.push(Object.assign(new n.a,{Color:"#FF0000",Alt:r.a.pe(ResourceStrings.L_FontColorRed),DisplayColor:"#FF0000"})),ha.Colors.push(Object.assign(new n.a,{Color:"#FFC000",Alt:r.a.pe(ResourceStrings.L_FontColorOrange),DisplayColor:"#FFC000"})),ha.Colors.push(Object.assign(new n.a,{Color:"#FFFF00",Alt:r.a.pe(ResourceStrings.L_FontColorYellow),DisplayColor:"#FFFF00"})),ha.Colors.push(Object.assign(new n.a,{Color:"#92D050",
Alt:r.a.pe(ResourceStrings.L_FontColorLightGreen),DisplayColor:"#92D050"})),ha.Colors.push(Object.assign(new n.a,{Color:"#00B050",Alt:r.a.pe(ResourceStrings.L_FontColorDarkGreen),DisplayColor:"#00B050"})),ha.Colors.push(Object.assign(new n.a,{Color:"#00B0F0",Alt:r.a.pe(ResourceStrings.L_FontColorLightBlue),DisplayColor:"#00B0F0"})),ha.Colors.push(Object.assign(new n.a,{Color:"#0070C0",Alt:r.a.pe(ResourceStrings.L_FontColorBlue),DisplayColor:"#0070C0"})),ha.Colors.push(Object.assign(new n.a,{Color:"#002060",
Alt:r.a.pe(ResourceStrings.L_FontColorDarkBlue),DisplayColor:"#002060"})),ha.Colors.push(Object.assign(new n.a,{Color:"#7030A0",Alt:r.a.pe(ResourceStrings.L_FontColorPurple),DisplayColor:"#7030A0"})));Array.add(fa.ControlList,ha);return fa},Q=(fa,ka,ha,F,na,ba,Ea)=>{ka=Object.assign(new k.a,{Id:ka,ControlsId:ha,Title:ResourceStrings.L_RecentColors,ControlList:[]});F=Object.assign(new e.a,{Id:F,ExternalId:na,Command:ba,Width:10,Colors:[]});if(Ea)for(Ea=0;fa&&Ea<fa.length&&fa[Ea];Ea++)na=fa[Ea],F.Colors.push(Object.assign(new n.a,
{Color:na.hex,Alt:r.a.pe(na.hex),DisplayColor:na.hex}));else for(Ea=0;fa&&Ea<fa.length&&fa[Ea];Ea++)na=fa[Ea],F.Colors.push(Object.assign(new n.a,{Color:"#"+na.hex,Alt:r.a.pe("#"+na.hex),DisplayColor:"#"+na.hex}));Array.add(ka.ControlList,F);return ka},W=(fa,ka)=>{if(!ka)return fa;var ha=new w;ha.hex=ka;const F=[];let na=0;F[na++]=ha;for(ha=0;fa&&ha<fa.length&&10>ha&&10>na&&fa[ha];ha++)fa[ha].hex!==ka&&(F[na++]=fa[ha]);return F},O=(fa,ka,ha,F,na,ba,Ea,La)=>{fa=Object.assign(new k.a,{Id:fa,ControlsId:ka,
DisplayMode:"Menu16",ControlList:[]});ha=Object.assign(new v.a,{Command:ha,LabelText:F,Image16by16:C.AFrameworkApplication.qm,Image16by16Class:Ea,Id:na,ExternalId:ba,KeyTip:La});Array.add(fa.ControlList,ha);return fa},Y=(fa,ka,ha,F,na,ba,Ea,La)=>{fa=Object.assign(new k.a,{Id:fa,ControlsId:ka,DisplayMode:"Menu16",ControlList:[]});ha=Object.assign(new v.a,{Command:ha,LabelText:F,Image16by16:C.AFrameworkApplication.qm,Image16by16Class:Ea,Id:na,ExternalId:ba,KeyTip:La});Array.add(fa.ControlList,ha);return fa},
S=(fa,ka,ha)=>{for(let wa=0;wa<fa.MenuSectionList.length;wa++){var F=fa.MenuSectionList[wa],na=F.ControlList;if(na&&0<na.length&&(na=na[0]))if(ka)if(F.Id===I.a.themeColors&&ha){var ba=u.i(ka.lD)||"";F=ha;var Ea=na.Colors,La="#";if(Ea&&Ea.length)if(r.a.Wa(ba))J.a.J(523531867,820,10,"selectedFontColor should not be empty in FindSelectedThemeColor");else for(var ta=0;ta<Ea.length;ta++){var oa=Ea[ta].Color;if(!r.a.Wa(oa)&&(oa=(oa=A.a.parse(Ea[ta].Color))?oa.Isc():E.SchemeColor.parse(Ea[ta].Color),F&&
oa&&oa.ZNe(F)&&oa.zta&&(oa=u.i(oa.WP),oa.toLowerCase()===ba.toLowerCase()))){La=Ea[ta].Color;break}}F=La;na.SelectedColorId=F}else{Ea=u.i(u.g(ka.lD))||"";F=na.Colors;ba="#";if(F&&F.length)if(r.a.Wa(Ea))J.a.J(523531868,820,10,"selectedFontColor should not be empty in FindSelectedStandardColor");else for(La=0;La<F.length;La++)if(ta=F[La].DisplayColor,!r.a.Wa(ta)&&ta.replace("#","").toLowerCase()===Ea.toLowerCase()){ba=F[La].Color;break}F=ba;na.SelectedColorId=F}else na.SelectedColorId="#"}},da=(fa,
ka)=>{let ha;ha=Array(10);ha[0]=fa.cL(z.Color.Ti(ka.PresetSchemeColorMapping.Background1));ha[1]=fa.cL(z.Color.Ti(ka.PresetSchemeColorMapping.Text1));ha[2]=fa.cL(z.Color.Ti(ka.PresetSchemeColorMapping.Background2));ha[3]=fa.cL(z.Color.Ti(ka.PresetSchemeColorMapping.Text2));ha[4]=fa.cL(z.Color.Ti(ka.PresetSchemeColorMapping.Accent1));ha[5]=fa.cL(z.Color.Ti(ka.PresetSchemeColorMapping.Accent2));ha[6]=fa.cL(z.Color.Ti(ka.PresetSchemeColorMapping.Accent3));ha[7]=fa.cL(z.Color.Ti(ka.PresetSchemeColorMapping.Accent4));
ha[8]=fa.cL(z.Color.Ti(ka.PresetSchemeColorMapping.Accent5));ha[9]=fa.cL(z.Color.Ti(ka.PresetSchemeColorMapping.Accent6));fa=Array(10);fa[0]=ResourceStrings.l_ThemeLabel1;fa[1]=ResourceStrings.l_ThemeLabel2;fa[2]=ResourceStrings.l_ThemeLabel3;fa[3]=ResourceStrings.l_ThemeLabel4;fa[4]=ResourceStrings.l_ThemeLabel5;fa[5]=ResourceStrings.l_ThemeLabel6;fa[6]=ResourceStrings.l_ThemeLabel7;fa[7]=ResourceStrings.l_ThemeLabel8;fa[8]=ResourceStrings.l_ThemeLabel9;fa[9]=ResourceStrings.l_ThemeLabel10;return{themeColors:ha,
WAh:fa}}},373:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k{}k.sFf="CU";k.yvi="CS";k.vvi="CE";k.Cle="KP";k.npl="TI";k.i1j="L";Object(K.a)(k,"CharacterBlockTrackerKeys",null,[])},374:function(K,Z,d){d.d(Z,"a",function(){return e});K=d(0);var k=d(33);class e{constructor(n,r){this.Flight=this.BaseDocQuerySignature=null;this.BaseDocQuerySignature=n;this.Flight=r}serialize(){return k.c([this.$k(),this])}}Object(K.a)(e,"ACommonHandlerRequest",null,[])},375:function(K,Z,d){d.d(Z,"a",function(){return k});
K=d(0);class k{}k.Psc="ToolbarButton";k.KNb="ToolbarButtonHome";k.insertPicture="InsertPicture";k.CXe="SlideNavigationDesignMode";k.Bib="Retrigger";k.refresh="Refresh";k.typing="Typing";k.uLf="DesignElementsDeleted";k.jTd="ChangeSlideSize";k.mrb="ApplyTheme";k.xXe="SlideChangeLayout";k.Xma="NewSlide";k.dTd="ChangeIconInSmartArt";k.Dsb="ChangeIcon";k.insertTable="InsertTable";k.mxa="PasteTable";k.rWc="InsertChart";k.FPd="ApplyReplaceObject";k.moreIdeas="MoreIdeas";k.newDocument="NewDocument";k.QYd=
"DesignTab";k.makeItVisual="MakeItVisual";k.iJa="PasteText";k.JVd="ConvertedToPPT";k.QOd="AgendaToPPT";Object(K.a)(k,"DesignerTrigger",null,[])},381:function(K,Z,d){K=d(0);var k=d(54),e=d(25),n=d(45),r=d(104),v=d(1213),C=d(13),w=d(1186),z;(function(fa){fa[fa.none=0]="none";fa[fa.noSystemClipboardAccess=1]="noSystemClipboardAccess";fa[fa.cutCopyDisallowed=2]="cutCopyDisallowed";fa[fa.pasteDisallowed=3]="pasteDisallowed";fa[fa.invalidPasteContext=4]="invalidPasteContext";fa[fa.invalidCcpOperation=5]=
"invalidCcpOperation";fa[fa.multiSlideCcpDisallowed=6]="multiSlideCcpDisallowed";fa[fa.pastedHtmlLengthExceeded=7]="pastedHtmlLengthExceeded";fa[fa.tooManyShapesAfterPaste=8]="tooManyShapesAfterPaste";fa[fa.noShapesPasted=9]="noShapesPasted";fa[fa.invalidImagePasteArgs=10]="invalidImagePasteArgs";fa[fa.invalidClipboardData=11]="invalidClipboardData";fa[fa.invalidCopiedShapes=12]="invalidCopiedShapes";fa[fa.invalidCopiedSlides=13]="invalidCopiedSlides";fa[fa.invalidHtmlContent=14]="invalidHtmlContent";
fa[fa.textEditFailed=15]="textEditFailed";fa[fa.clipServiceDataInvalid=16]="clipServiceDataInvalid";fa[fa.crossDCPasteDisallowed=17]="crossDCPasteDisallowed";fa[fa.imageTooLarge=18]="imageTooLarge";fa[fa.noAvailablePasteHandler=19]="noAvailablePasteHandler";fa[fa.noAvailableCutCopyHandler=20]="noAvailableCutCopyHandler";fa[fa.cutCopyHandlerFailed=21]="cutCopyHandlerFailed";fa[fa.systemClipboardCopyFailed=22]="systemClipboardCopyFailed";fa[fa.copyObjectEmpty=23]="copyObjectEmpty";fa[fa.tableInvalid=
24]="tableInvalid";fa[fa.copyObjectHasDeferredContent=25]="copyObjectHasDeferredContent";fa[fa.userOffline=26]="userOffline";fa[fa.picklingPasteFailedDueToMaxSizeLimit=27]="picklingPasteFailedDueToMaxSizeLimit";fa[fa.picklingInvalidCopyData=28]="picklingInvalidCopyData";fa[fa.systemClipboardAccessFailure=29]="systemClipboardAccessFailure";fa[fa.chunkUploaderFailure=30]="chunkUploaderFailure";fa[fa.pasteCancelledByUser=31]="pasteCancelledByUser";fa[fa.cutCopyIRMRestricted=32]="cutCopyIRMRestricted"})(z||
(z={}));Object(K.b)("CcpFailure",z);var A=d(930),u=d(112),E=d(26),H=d(328),I;(function(fa){fa[fa.none=0]="none";fa[fa.text=1]="text";fa[fa.shape=2]="shape";fa[fa.textbox=3]="textbox";fa[fa.normalShape=4]="normalShape";fa[fa.image=5]="image";fa[fa.table=6]="table";fa[fa.chart=7]="chart";fa[fa.video=8]="video";fa[fa.list=9]="list";fa[fa.ink=10]="ink";fa[fa.addin=11]="addin";fa[fa.smartArt=12]="smartArt";fa[fa.group=13]="group";fa[fa.placeholder=14]="placeholder";fa[fa.line=15]="line";fa[fa.activeX=
16]="activeX";fa[fa.oleObject=17]="oleObject";fa[fa.media=18]="media";fa[fa.slide=19]="slide";fa[fa.mixed=20]="mixed"})(I||(I={}));Object(K.b)("ClipboardContentType",I);var J;(function(fa){fa[fa.keyboard=0]="keyboard";fa[fa.menu=1]="menu";fa[fa.floatie=2]="floatie";fa[fa.ribbon=3]="ribbon"})(J||(J={}));Object(K.b)("ClipboardMethod",J);var T;(function(fa){fa[fa.copy=0]="copy";fa[fa.cut=1]="cut";fa[fa.paste=2]="paste"})(T||(T={}));Object(K.b)("ClipboardOperation",T);var D;(function(fa){fa[fa.other=
0]="other";fa[fa.pptOnline=1]="pptOnline";fa[fa.pptOnlineSameSession=2]="pptOnlineSameSession";fa[fa.pptOnlineCrossSession=3]="pptOnlineCrossSession";fa[fa.wordOnline=4]="wordOnline";fa[fa.xlOnline=5]="xlOnline";fa[fa.oneNoteOnline=6]="oneNoteOnline";fa[fa.pptWin32=7]="pptWin32";fa[fa.wordWin32=8]="wordWin32";fa[fa.xlWin32=9]="xlWin32";fa[fa.oneNoteWin32=10]="oneNoteWin32";fa[fa.googleDocs=11]="googleDocs";fa[fa.pptDesktop=12]="pptDesktop";fa[fa.pptDesktopWithDataUpload=13]="pptDesktopWithDataUpload"})(D||
(D={}));Object(K.b)("ClipboardSource",D);class R{constructor(){this.data={};this.Nxf=!1;this.nkb=null}}Object(K.a)(R,"TelemetryEntry",null,[]);var Q=d(1028),W=d(430),O=d(41),Y=d(28),S=d(67);d.d(Z,"a",function(){return da});class da{constructor(fa,ka,ha,F,na,ba,Ea,La,ta,oa,wa,ra){this.Kqg=k.a.Ly;this.sRg=this.Pxg=this.b3c="";this.lR=fa;this.OT=ka;this.Gv=new S.a;this.w$=new S.a;F.VFc(Object(C.a)(this,this.OGe,"onRevisionProcessedOnServer"));na.gra(Object(C.a)(this,this.Lrl,"trackSlideCcpRevision"));
ba.gra(Object(C.a)(this,this.Krl,"trackShapeCcpRevision"));Ea.gra(Object(C.a)(this,this.Hrl,"trackParagraphCcpRevision"));La.gra(Object(C.a)(this,this.Grl,"trackNotesCcpRevision"));ta&&ta.gra(Object(C.a)(this,this.Irl,"trackPresentationCcpRevision"));this.FL=wa;this.ia=oa;this.rpg=ha.Qpd;this.Ev=ra;if(fa=e.AFrameworkApplication.gd)this.Pxg=Object(w.a)(String,fa.Host)||"",this.sRg=Object(w.a)(String,fa.Ring)||"",this.b3c=Object(w.a)(String,fa.WACDatacenter)||""}Nzb(fa){return this.Gv.Hb(fa)}CB(fa,
ka){n.a.Wa(ka)||(this.Nzb(ka)?da.contentType in this.Gv.ga(ka).data&&!this.zJj(ka,fa)||this.ZV(da.contentType,I[fa],ka):E.a.J(50393377,826,15,"attempted to update clipboard telemetry before tracking started "+ka))}O9a(fa,ka){if(!this.Gv.Hb(fa))return null;let ha=null;if(this.Gv.ga(fa)&&!(ka in this.Gv.ga(fa).data))switch(ka){case da.contentType:ha="none";break;case da.source:ha="other"}return ha?ha:this.Gv.ga(fa).data[ka].toString()}cZf(fa){return this.O9a(fa,da.contentType)}DYf(fa){return this.O9a(fa,
da.source)}R3i(fa){return this.O9a(fa,da.operation)}V9b(fa){return"xlOnline"===this.DYf(fa)&&"chart"===this.cZf(fa)}i_c(fa){return"slide"===this.cZf(fa)&&"paste"===this.R3i(fa)}Fxk(fa){const ka=I;for(let F in ka){var ha=ka[F];if(F.toLowerCase()===fa.toLowerCase())return ha}return 0}Gxk(fa){const ka=D;for(let F in ka){var ha=ka[F];if(F.toLowerCase()===fa.toLowerCase())return ha}return 0}zJj(fa,ka){fa=this.Fxk(this.Gv.ga(fa).data[da.contentType].toString());return ka>fa}Ew(fa,ka){n.a.Wa(ka)||(this.Nzb(ka)?
da.source in this.Gv.ga(ka).data&&!this.nTj(ka,fa)||this.ZV(da.source,D[fa],ka):E.a.J(50393379,826,15,"attempted to update clipboard telemetry before tracking started "+ka))}nTj(fa,ka){fa=this.Gxk(this.Gv.ga(fa).data[da.source].toString());return ka>fa}Yh(fa,ka,ha){n.a.Wa(ha)||this.ZV(fa,ka,ha)}eP(fa,ka,ha){const F=O.a.Ib&&!n.a.Wa(O.a.Ib.actionName)?O.a.Ib.actionName:ha,na=r.a.create().toString();this.Gv.$(na,Object.assign(new R,{nkb:this.lR.Ci("UserAction","ClipboardTelemetry")}));this.ZV(da.MBf,
na,na);this.ZV(da.actionName,F,na);this.ZV("ActualActionName",ha,na);this.ZV("CcpOperation",T[fa],na);this.ZV("CcpMethod",J[ka],na);this.ZV("CcpBrowser",this.Kqg,na);this.ZV("CcpHost",this.Pxg,na);this.ZV("CcpDatacenter",this.b3c,na);this.ZV("CcpRing",this.sRg,na);E.a.J(51179864,826,50,"start telemetry tracking. browser: {0}; CcpCorrelation: {1}; method: {2}; operation: {3}; actionName: {4}",this.Kqg,na,J[ka],T[fa],F);return na}Gg(fa,ka,ha=0){if(n.a.Wa(ka))E.a.J(51478666,826,15,"attempted to end telemetry tracking for empty correlation");
else if(n.a.Wa(ka)||!this.Nzb(ka))E.a.J(51478669,826,15,"attempted to end telemetry tracking for invalid correlation id: {0}",ka);else{var F=this.Gv.ga(ka);this.ZV("CcpTotalMs",F.nkb.Rq.toString(),ka);this.ZV(da.NBf,fa.toString(),ka);0!==ha&&(this.ZV("CcpFailureReason",z[ha],ka),this.V9b(ka)?16===ha?this.FL.Tfa(ResourceStrings.l_CopyErrorCalloutTitle,ResourceStrings.l_CopyErrorCalloutMessage,!1,null,!1,null,0,0,null,null,!0,da.nsb):(fa=Object.assign(new W.a(!0),{Ub:ka}),this.FL.Tfa(ResourceStrings.l_CopyPasteErrorCalloutTitle,
ResourceStrings.l_CopyPasteErrorCalloutMessage,!0,CommonUIStrings.l_CalloutNotificationPButtonLabel,!0,CommonUIStrings.l_CalloutNotificationSButtonLabel,Y.a.MGf,Y.a.NVd,null,fa,!0,da.nsb)):25===ha&&(E.a.J(523298057,826,15,"Attempted to paste deferred content/slide on another deck with correlation: {0}",ka),this.FL.Tfa(ResourceStrings.l_DeferredContentPasteDialogTitle,ResourceStrings.l_DeferredContentPasteDialogMessage,!1,null,!1,null,0,0,null,null,!1,da.nsb)));E.a.J(50733397,826,50,u.c(F.data));this.V9b(ka)||
this.i_c(ka)||this.Gv.remove(ka)}}Z9k(fa,ka){n.a.Wa(ka)||(this.Ew(0,ka),this.jrh(fa,ka,0))}jrh(fa,ka,ha){if(fa){if(ha>=Q.a.IHc)throw Error.create(String.format("Exceeds the maximum recursions ({0}).",Q.a.IHc));if(1===fa.nodeType){for(var F=fa.firstChild;F;)this.jrh(F,ka,ha+1),F=F.nextSibling;this.vUe(fa,ka)}}}vUe(fa,ka){const {ClipboardHelper:ha}=d(707);if(!n.a.Wa(ka))if(!this.Nzb(ka))E.a.J(50393415,826,15,"attempted to update clipboard telemetry before tracking started "+ka);else if(fa)if("head"===
fa.tagName.toLowerCase()){var F=this.OT.XRf(fa);n.a.Wa(F)||this.H9k(F,ka)}else{F=0;var na=fa.getAttribute(H.a.sessionId);na?F=ha.Gjg(na.toString())?2:3:fa.getAttribute(A.a.cKf)?F=5:fa.getAttribute(A.a.dKf)||fa.getAttribute(A.a.hKf)?F=1:fa.id&&fa.id.startsWith&&fa.id.startsWith(A.a.i7f)&&(F=11);if(fa.className&&fa.className.split)for(const ba of fa.className.split(" "))if(ba.startsWith(k.a.ZYb)&&ba.length===k.a.ZYb.length+1&&(fa=parseInt(n.a.substring(ba,ba.length-1,ba.length)),isNaN(fa)||this.ZV("CcpSourceBrowser",
v.a[fa],ka)),0===F)if(ba.startsWith(A.a.iah))F=1;else if(ba.startsWith(A.a.Y6g))F=6;else if(ba.startsWith(A.a.eJh))F=4;else if(ba===A.a.KZg||ba===A.a.LZg)F=8,this.CB(9,ka);0!==F&&this.Ew(F,ka)}}H9k(fa,ka){switch(fa){case "PowerPoint.Slide":this.Ew(7,ka);break;case "Word.Document":this.Ew(8,ka);break;case "Excel.Sheet":this.Ew(9,ka);break;case "OneNote.File":this.Ew(10,ka)}}ZV(fa,ka,ha){this.Gv.Hb(ha)&&(this.Gv.ga(ha).data[fa]=ka)}OGe(fa,ka){ka.faa&&!n.a.Wa(ka.faa.Id)&&this.w$.Hb(ka.faa.Id)&&this.EPf(ka.faa.Id,
!ka.faa.Error,ka.faa.Error?ka.faa.Error.Code:0)}Lrl(fa,ka){this.Tsc(ha=>{let F=null;if(ha=Object(w.a)(116,ha.node))F=ha.Ub,ha.Ub=null;return F},ka)}Krl(fa,ka){this.Tsc(ha=>{let F=null;if(ha=Object(w.a)(4,ha.node))F=ha.Ub,ha.Ub=null;return F},ka)}Hrl(fa,ka){this.Tsc(ha=>{let F=null;if(ha=Object(w.a)(5,ha.node))F=ha.Ub,ha.Ub=null;return F},ka)}Grl(fa,ka){this.Tsc(ha=>{let F=null;if(ha=Object(w.a)(362,ha.node))F=ha.Ub,ha.Ub=null;return F},ka)}Irl(fa,ka){this.Tsc(ha=>{let F=null;if(ha=Object(w.a)(388,
ha.node))F=ha.Ub,ha.Ub=null;return F},ka)}Tsc(fa,ka){ka.revisionId&&ka.node&&(fa=fa(ka),n.a.Wa(fa)||this.Axh(ka.revisionId.toString(),fa))}Axh(fa,ka){n.a.Wa(fa)||n.a.Wa(ka)||this.w$.$(fa,ka)}EPf(fa,ka,ha){if(!n.a.Wa(fa)&&this.w$.Hb(fa)){this.rpg&&"pptDesktopWithDataUpload"===this.DYf(this.w$.ga(fa))&&this.Ev.P_d();var F={};F[da.MBf]=this.w$.ga(fa);F[da.NBf]=ka;F[da.Xsi]=ha;this.V9b(this.w$.ga(fa))?(F[da.source]="xlOnline",F[da.contentType]="chart",0!==ha&&(ka=Object.assign(new W.a(!0),{Ub:this.w$.ga(fa)}),
this.FL.Tfa(ResourceStrings.l_CopyPasteErrorCalloutTitle,ResourceStrings.l_CopyPasteErrorCalloutMessage,!0,CommonUIStrings.l_CalloutNotificationPButtonLabel,!0,CommonUIStrings.l_CalloutNotificationSButtonLabel,Y.a.MGf,Y.a.NVd,null,ka,!0,da.nsb))):433===ha?(this.i_c(this.w$.ga(fa))&&this.ia.processAction(Y.a.qI,2),this.FL.Tfa(ResourceStrings.l_CopyPasteErrorCalloutTitle,ResourceStrings.l_CopyPasteLargeDataErrorCalloutMessage,!1,null,!1,null,0,0,null,null,!0,da.nsb)):434===ha&&(this.i_c(this.w$.ga(fa))&&
(this.rpg?this.ia.processAction(Y.a.EYd,2):this.ia.processAction(Y.a.qI,2)),this.FL.Tfa(ResourceStrings.l_SomethingWentWrongCalloutTitle,ResourceStrings.errorTitle_PasteSlideFailed,!1,null,!1,null,0,0,null,null,!0,da.nsb));E.a.J(50733400,826,50,u.c(F));(this.V9b(this.w$.ga(fa))||this.i_c(this.w$.ga(fa)))&&this.Gv.remove(this.w$.ga(fa));this.w$.remove(fa)}}rIj(fa){return!n.a.Wa(fa)&&this.Gv.Hb(fa)?this.Gv.ga(fa).Nxf:!1}Qhc(fa){n.a.Wa(fa)||(this.Nzb(fa)?this.Gv.ga(fa).Nxf=!0:E.a.J(595206346,826,15,
"attempted to update clipboard telemetry before tracking started "+fa))}}da.source="CcpSource";da.contentType="CcpContentType";da.operation="CcpOperation";da.NBf="CcpSuccess";da.actionName="ActionName";da.nsb=20;da.MBf="CcpCorrelation";da.Vzi="CcpCopyIframeContent";da.NDf="ClipServiceThrottled";da.LBf="data-corr-id";da.Gp="CcpId";da.Xsi="ClipServiceFailureReason";Object(K.a)(da,"ClipboardTelemetry",null,[343])},388:function(K,Z,d){K=d(0);var k=d(45),e=d(199),n=d(1194),r=d(1186),v=d(56);class C{constructor(){this.shapeType=
this.gCe=this.eYg=this.B0g=this.A0g=0;this.ar=this.aq=this.Mp=this.Ej=!1;this.gHc=null}}Object(K.a)(C,"ShapeProperties",null,[]);var w=d(26),z=d(41),A=d(100),u=d(211);d.d(Z,"a",function(){return E});class E{constructor(H,I,J,T,D,R,Q,W,O){this.Hs=H;this.Tk=I;this.Ea=Q;this.q$c=R.eel;this.Gak=this.QEi();this.jq=J;this.OL=T;this.Re=D.Ma;this.rO=R.rua;this.V8j=R.jza;this.Sb=O}n9g(H,I,J,T,D,R=null){if(I){var Q=this.Ea.g9a(J);Q&&(Array.remove(J,Q),Array.add(J,this.Ea.vr(Q)));this.Lwh(J);var W=J.length;
Q=Array(W);T=this.T1f(I,T);for(var O=0;O<W;O++){var Y=J[O],S=this.xcj(Y,T);Q[O]=Object.assign(new C,{A0g:S.x,B0g:S.y,eYg:Y.nx,gCe:Y.wC,shapeType:Y.shapeType,Ej:Y.Ej,Mp:Y.Mp||2===Y.mediaType||1===Y.mediaType,aq:Y.ud,ar:Y.ar,gHc:""});Q[O].Ej&&(S=Object(r.a)(117,Y.sc(this.Re)),Q[O].gHc=S?S.QXe:"",w.a.J(512500632,826,50,"PendingImage: {0}, State: {1}, HasImageId: {2}",Y.Cae,this.OL.SW(Y),0<Q[O].gHc.length))}O=I.Cb;Y=I.Pt();S=[];T=!0;var da=H.hj===I.hj,fa=H.Bn===I.Bn,ka=!1;H!==I&&(da?(ka=H.q$a||I.q$a,
fa||(ka=H.i$a||I.i$a||ka),T=!ka):T=!1,T&&this.rO&&(H.oq!==I.oq||H.Wk!==I.Wk)&&(T=!1));for(var ha=0;ha<W;ha++)this.cel(J[ha])||(S.push(J[ha]),T&&(T=this.acl(J[ha],fa)));J=S;w.a.J(512500631,826,50,"{0}",{["LocalRenderEnabled"]:T,["SameSlide"]:H===I,["SameMaster"]:da,["SameLayout"]:fa,["ThemeOverrides"]:ka});W=[];ha=ka=fa=da=S=!1;for(let F=0;F<J.length;F++){const na=Q[F];let ba=this.Tk.bCi(O.cid,O.sid,na.A0g,na.B0g,na.eYg,1>na.gCe?1:na.gCe,Y+J[F].get_zIndex(),H.id,J[F],na.shapeType,na.Ej,na.gHc,T);k.a.Wa(R)||
(ba.Ub=R);W.push(ba);S=S||na.Ej;da=da||na.Mp;fa=fa||na.aq;ka=ka||na.ar;ha=ha||this.V8j&&E.mQj(ba)}D=E.fkh(S,da,fa,ka,ha,D);if(0<W.length&&(H=T?J:null,this.Hs.zW(W,I,D,H),T&&z.a.Ib)){if(H){I="";for(const F of H)I+=this.Ea.q5b(F)+",";z.a.Ib.Va(A.a.Qzi,I);z.a.Ib.Va(A.a.Fal,H.length.toString())}z.a.Ib.Nj=!0;z.a.Ib.TLb=!0}}}eHi(H,I,J,T,D,R){var Q=this.T1f(H,J);J=[];const W=I.Ric,O=!!W&&!e.a.Wa(W.Xjg);R=this.wcj(R,Q);for(Q=0;Q<I.objectCount;Q++){const Y=this.Tk.nBi(H.cid,H.sid,R.x,R.y,D);Y.isEditable=O&&
W.Xjg[Q];J.push(Y)}0<J.length&&this.Hs.zW(J,H,T)}wcj(H,I){const J=I*E.HS;I*=E.HS;let T=new v.a(J,I);H&&(T=this.Sb.pta(H.clientWidth,H.clientHeight))&&(T.x+=J,T.y+=I);return T}cel(H){return H.sC&&this.q$c||!H.hfg}acl(H,I){return H.Cae||this.OL.SW(H)||H.gl&&H.hasText&&!I&&10!==H.Gj&&12!==H.Gj||H.Cq?!1:!0}Lwh(H){H.sort((I,J)=>I.get_zIndex()-J.get_zIndex())}ZQj(H){return H?this.Gak.contains(H):!1}T1f(H,I){if(!H)return 0;if(!I)return E.vli;let J,T;return I.$(J=H.Cb,(T=I.ga(J))+1),T}xcj(H,I){var J=this.jq.presentation;
if(!J)throw Error.argumentNull("Presentation is null");let T=H.qy,D=H.ry;H=J.xij(J.lC(H.slideId));J=Math.round(E.HS/H)*H;H=n.a.rf(J,0);for(J=n.a.rf(J,1);0<I;)T+=H,D+=J,I--;return new v.a(T,D)}Utl(H){try{if(H&&H.clipboardData){const I=H.clipboardData.types;for(let J=0;J<I.length;J++){const T=H.clipboardData.getData(I[J]);if(this.FIj(T))return T}}}catch(I){}return null}FIj(H){return!!H&&0<H.length&&this.aVj(H)}aVj(H){H=H.trim().toLowerCase();return H.startsWith("http:")||H.startsWith("https:")}J6k(H,
I,J){H&&(H.setAttribute(E.Dzf,I.toString()),H.setAttribute(E.Czf,J.toString()),H.setAttribute(E.Ezf,"true"))}QEi(){const H=new u.a;H.add("param");H.add("map");H.add("area");H.add("script");H.add("noscript");H.add("col");H.add("colgroup");H.add("caption");H.add("head");H.add("title");H.add("link");H.add("meta");H.add("style");H.add("base");H.add("input");H.add("textarea");H.add("select");H.add("option");H.add("optgroup");H.add("button");H.add("hr");return H}b$i(H){return this.ADh(H,E.Dzf)}T9i(H){return this.ADh(H,
E.Czf)}OMj(H){return H?"true"===H.getAttribute(E.Ezf):!1}Dtl(H){if(this.okg(H)){const I=H.indexOf('"')+1,J=H.lastIndexOf('"');if(1<I&&J>I&&(H=H.slice(I,J),H.startsWith(E.Bli)))return H}return null}okg(H){return!!H&&H.length>E.$li&&H.startsWith(E.Cli)}ADh(H,I){let J=0;this.OMj(H)&&(J=parseFloat(H.getAttribute(I)));return isNaN(J)?0:J}sSd(H){return this.tSd(H).returnValue}tSd(H){let I;I=2;let J=0,T=0,D=0,R=0,Q=0,W=0,O=0,Y=0,S=0,da=0,fa=0,ka=0,ha=0,F=0,na=0,ba=0,Ea=0;for(const La of H)La.ud?(I=2===I?
6:20,J++):La.Rf?(I=2===I?12:20,T++):La.ar?(I=2===I?7:20,D++):La.Jf?(I=2===I?13:20,R++):22===La.t6b?(I=2===I?10:20,Q++):La.Ej?(I=2===I?5:20,W++):La.lx?(I=2===I?3:20,O++):La.V3?(I=2===I?14:20,La.sC&&S++,Y++):La.gl?(I=2===I?14:20,La.sC&&fa++,da++):La.Vy?(I=2===I?15:20,ka++):La.pT?(I=2===I?16:20,ha++):La.Mp?(I=2===I?18:20,F++):La.Cq?(I=2===I?11:20,na++):La.Bda?(I=2===I?17:20,ba++):(I=2===I?4:20,Ea++);return{returnValue:String.format("numTotalShapes={0}, numTables={1}, numSmartArt={2}, numCharts={3}, numGroups={4}, numInk={5}, numPictures={6}, numTextbox={7}, numTitlePlaceholder={8}, numEmptyTitlePlaceholder={9}, numNonTitlePlaceholder={10}, numEmptyNonTitlePlaceholder={11}, numLine={12}, numActiveX={13}, numMedia={14}, numAppForOffice={15}, numOleObject={16}, numNormalShape={17}",
H.length,J,T,D,R,Q,W,O,Y,S,da,fa,ka,ha,F,na,ba,Ea),contentType:I}}static l2k(H){for(const I of H)if(!I.hfg||I.isLocal)return!1;return!0}static mQj(H){return H&&4===H.KK?(!H.fill||!!H.fill.noFillField)&&(!H.lineStyle||!!H.lineStyle.noFillField):!1}static fkh(H,I,J,T,D,R){return H||I||J||T||D?R:0}}E.Ezf="data-from-ppt-online";E.Dzf="data-image-width-mu";E.Czf="data-image-height-mu";E.Bli="data:image/";E.Cli="<img src=";E.$li=14;E.vli=1;E.HS=15;Object(K.a)(E,"CopyPasteUtility",null,[325])},389:function(K,
Z,d){K=d(0);var k=d(514),e=d(127);class n extends k.a{constructor(){super();this.nextId=this.prevId=null;this.H_=Object.assign(new e.a,{T_:n.getTypeName(),B_:n.getBaseTypes()})}static getTypeName(){return"AugLoop_Core_OperationWithSiblingContext"}static getBaseTypes(){return["AugLoop_Core_Operation"]}}Object(K.a)(n,"OperationWithSiblingContext",k.a,[]);d.d(Z,"a",function(){return r});class r extends n{constructor(){super();this.H_=Object.assign(new e.a,{T_:r.getTypeName(),B_:r.getBaseTypes()})}static getTypeName(){return"AugLoop_Core_AddOperation"}static getBaseTypes(){return["AugLoop_Core_OperationWithSiblingContext",
"AugLoop_Core_Operation"]}}Object(K.a)(r,"AddOperation",n,[])},434:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k{constructor(){this.body=this.contextId=this.revId=this.source=this.id=null}}Object(K.a)(k,"Item",null,[])},435:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k{}k.open="open";k.refresh="refresh";k.HRe="saveAs";k.translate="translate";k.modeSwitch="modeSwitch";k.PDi="createNew";k.convert="convert";Object(K.a)(k,"ReasonList",null,[])},436:function(K,Z,d){d.d(Z,
"a",function(){return k});K=d(0);class k{constructor(){this.func=this.outputSchema=this.inputSchema=this.name=null}}Object(K.a)(k,"Lambda",null,[906])},437:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k{}k.Sqc="SlideTextTile";k.hVe="ShapeTextTile";Object(K.a)(k,"AugmentationSchemas",null,[])},438:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);d(25);class k{static vb(){}static W0(e,n,r,v,C){return 1===r?32:k.MGk(e,C)?32:8}static ZG(e,n,r,v,C){return 1===r?32:k.pkk(e,C)?32:8}static pkk(e,
n){const r=k.AOh[e.toString()];if(void 0===r||null===r)return!1;r(e,n);return!0}static MGk(e,n){const r=k.DOh[e.toString()];if(void 0===r||null===r)return!1;r(e,n);return!0}}k.AOh={};k.DOh={};Object(K.a)(k,"DialogCuiControlActor",null,[])},439:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k{constructor(){this.description=this.title=this.ZP=this.T0=null}}Object(K.a)(k,"CpContentDetails",null,[407])},440:function(K,Z,d){d.d(Z,"a",function(){return e});K=d(0);var k=d(104);class e{constructor(){this.Utf=
!1;this.sessionId=this.QDf=null;this.K6a=e.F0i()}static F0i(){return"CID"+k.a.create().toString()}static Qdg(n){return n&&n.length?n.startsWith("CID")&&k.a.isValid(n.substring(3,n.length))?!0:!1:!1}}Object(K.a)(e,"InternalClipboardObject",null,[])},441:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);d=d(440);class k extends d.a{constructor(e){super();this.Fd=e}get eig(){return!this.Fd||!this.Fd.isConnected}get id(){return this.Fd.id}get isConnected(){return this.Fd.isConnected}}Object(K.a)(k,
"InternalClipboardSlide",d.a,[])},442:function(K,Z,d){d.d(Z,"a",function(){return e});var k=d(106);const e=(n,r,v)=>{const C=new k.StandardDialog;C.xd=0;C.cP(n,r,v);return C}},453:function(K,Z,d){K=d(0);var k=d(382),e=d(13),n=d(25),r=d(177),v=d(73),C=d(65),w=d(171),z=d(102),A=d(170);d(70);class u{constructor(){this.secondActionButtonProps=this.firstActionButtonProps=this.messageTitle=this.message=null;this.isMultiline=!1;this.messageBarType=0;this.closeable=!1;this.messageBarIconProps=this.linkProps=
this.dismissButtonAriaLabel=this.onDismiss=null}}Object(K.a)(u,"MessageBarProps",null,[]);class E{constructor(W,O){this.onExecute=this.label=this.type=null;this.label=W;this.type="AppButtonProps";this.onExecute=O}}Object(K.a)(E,"AppButtonProps",null,[]);var H=d(140),I=d(778),J=d(133),T=d(208),D=d(104),R=d(35);d.d(Z,"a",function(){return Q});class Q{constructor(W,O,Y){this._message=this.PB=null;this.ECd=this.Imb=!1;this.xwd=0;this.kha="";this.iS=0;this.$E=this.VR=this.xpa=this.T6=this.y3a=this.OPb=
this.NPb=this.MPb=this.LPb=this.bN=this.D6=this.Lqa=this.vNa=null;this.Bmb=this.Amb=!1;this.A6e=this.Pwd="";this.Nwd=!1;this.B6e=this.Twd="";this.Rwd=!1;this.Swd=this.Owd=null;this.DTb=!1;this.Aff=this.rob="";this.x3a=null;this.NSb=this.kcf=!1;this.kCa=this.P2=this.lda=this.wP=this.businessBar=null;this.errorCode=0;this.Ztf=this.visible=!1;this.title=W;this.message=O;this.r8b=Y;this.id=0;this.image=1;this.eje=!0;this.fxf=5}get htmlElement(){return this.wP}get eje(){return this.ECd}set eje(W){this.ECd=
W}get fxf(){return this.xwd}set fxf(W){this.xwd=W}get title(){return this.PB}set title(W){this.PB!==W&&(this.PB=W,this.Lqa&&(this.Lqa.innerText=this.PB))}get message(){return this._message}set message(W){this._message!==W&&(this._message=W,this.D6&&(this.D6.innerText=this._message))}get image(){return this.iS}set image(W){this.iS=W;4!==this.iS&&(this.lda="")}get yEa(){return this.kha}set yEa(W){this.kha=W}get closeable(){return this.Imb}set closeable(W){this.Imb!==W&&(this.Imb=W,this.xpa&&(this.xpa.style.display=
this.Imb?"table-cell":"none"))}get Zmc(){return n.AFrameworkApplication.fa.ka("ReactBusinessBarIsEnabled")}get ECl(){return n.AFrameworkApplication.fa.ka("Fluent2StyleIsEnabled")}addButton(W,O,Y,S=!1){this.Pwd=W;this.Owd=O;this.Amb=!0;this.A6e=Y;this.Nwd=S}BNd(W,O){this.Twd=W;this.Swd=O;this.Bmb=!0;this.B6e="";this.Rwd=!1}Uqf(W,O){this.rob=W;this.x3a=O;this.DTb=!0}SEi(){var W=T.a.n8(n.AFrameworkApplication.fa.Ha("VNextStyleOptOutCookieName"),!1);W=this.ECl&&!W;this.wP=document.createElement("div");
this.htmlElement.className=String.format("{0} {1} {2}",Q.z6e,Q.rYh,W?Q.p2h:"");this.htmlElement.setAttribute("UNSELECTABLE","on");void 0!==this.kCa&&null!==this.kCa&&(this.htmlElement.id=this.kCa);W=()=>{H.UISurfaces.ubj().then(O=>{this.businessBar.Oje||(O.initializeMessageBarInStore(),this.businessBar.Oje=!0);const Y=Object.assign(new u,{message:this._message,messageTitle:this.PB,isMultiline:this.ECd,messageBarType:this.xwd});if(this.Imb){Y.closeable=!0;var S=this._message+". "+CommonUIStrings.l_DialogClose;
this.PB&&(S=this.PB+". "+S);Y.dismissButtonAriaLabel=S;Y.onDismiss=()=>{this.nUd(this)}}4===this.iS&&(Y.messageBarIconProps={["iconName"]:this.lda});this.DTb&&(Y.linkProps={["type"]:"AppLinkProps",["text"]:this.rob,["handler"]:{["href"]:this.Aff,["target"]:"_blank"}},this.x3a&&(S=Object(e.a)(this,this.lqk,"onMessageBarLinkClicked"),Y.linkProps.handler=S));this.Amb&&(Y.firstActionButtonProps=new E(this.Pwd,()=>{this.Jki(this)}));this.Bmb&&(Y.secondActionButtonProps=new E(this.Twd,()=>{this.Lki(this)}));
O.createNewMessageBarWithCallback?O.createNewMessageBarWithCallback(this.htmlElement,Y,()=>{n.AFrameworkApplication.Aa.Mq()}):O.createNewMessageBar(this.htmlElement,Y);return null}).catch(()=>{k.ULS.sendTraceTag(595096981,324,10,"Failed to load React Message Bar API");return null})};r.a.get_instance().isCompleted(7)?W():r.a.get_instance().Dk(7,W);this.r8b&&(n.AFrameworkApplication.Aa.By.pb(C.a.click,this.htmlElement,Object(e.a)(this,this.onClick,"onClick")),n.AFrameworkApplication.Aa.kG.JU(C.a.Hl,
this.htmlElement,Object(e.a)(this,this.XEe,"onBodyKeyUp"),this),this.kcf&&!this.NSb&&(n.AFrameworkApplication.Aa.Aaa.pb(this.htmlElement,Object(e.a)(this,this.onClick,"onClick"),null),this.NSb=!0));return this.htmlElement}createElement(){n.AFrameworkApplication.CL("Microsoft.Office.Web.SessionSettings.IWacWordReactBusinessBarSettings");if(this.Zmc)return this.SEi();this.wP=document.createElement("div");this.htmlElement.className=Q.z6e;this.htmlElement.setAttribute("UNSELECTABLE","on");void 0!==this.kCa&&
null!==this.kCa&&(this.htmlElement.id=this.kCa);this.vNa=null;if(0!==this.iS){this.vNa=document.createElement("span");this.vNa.className="WACBusinessBarIcon";this.htmlElement.appendChild(this.vNa);var W=null;let O=null;switch(this.iS){case 2:W=Q.gQh;O=CommonUIStrings.l_DialogError;break;case 1:W=Q.B2h;O=CommonUIStrings.l_DialogWarning;break;case 3:W=Q.oSh;O=CommonUIStrings.l_DialogInfo;break;case 4:W=this.lda,O=this.kha}this.vNa.title=O;this.vNa.setAttribute(J.a.af,J.a.cwf);this.vNa.appendChild(v.createClusteredImage(24,
24,W,Q.eSh,!0,""))}W=D.a.create().toString();this.bN=document.createElement("div");this.bN.id="BBTitleAndBody"+W;this.bN.className=Q.rNh;this.bN.tabIndex=0;this.PB&&(this.Lqa=document.createElement("p"),this.Lqa.innerText=this.PB,this.Lqa.className=Q.sNh+" UIFontBold",this.Lqa.id="BBTitle"+W,this.Lqa.setAttribute("UNSELECTABLE","on"),this.bN.setAttribute(J.a.D2,this.Lqa.id),this.bN.appendChild(this.Lqa));this.D6=document.createElement("p");this.D6.className=Q.mNh;this.D6.innerText=this._message;this.D6.id=
"BBBody"+W;this.D6.setAttribute("UNSELECTABLE","on");this.D6.style.width="100%";this.bN.setAttribute(J.a.tra,this.D6.id);this.Amb&&this.gqf(this.D6,this.A6e);this.Bmb&&this.gqf(this.D6,this.B6e);this.bN.appendChild(this.D6);W=document.createElement("div");W.setAttribute(J.a.af,J.a.gQd);W.appendChild(this.bN);this.htmlElement.appendChild(W);this.Amb&&(this.MPb=document.createElement("span"),this.LPb=document.createElement("button"),this.sHf(this.MPb,this.LPb,this.Pwd,Object(e.a)(this,this.bzf,"buttonOneClickHandler")));
this.Bmb&&(this.OPb=document.createElement("span"),this.NPb=document.createElement("button"),this.sHf(this.OPb,this.NPb,this.Twd,Object(e.a)(this,this.czf,"buttonTwoClickHandler")));this.DTb&&(this.y3a=document.createElement("span"),this.y3a.className=Q.qNh,this.T6=document.createElement("a"),this.T6.className=I.a.pNh,this.T6.innerText=this.rob,this.x3a?(this.T6.tabIndex=0,n.AFrameworkApplication.Aa.By.JU(C.a.click,this.T6,Object(e.a)(this,this.$mg,"linkClickHandler"),this),n.AFrameworkApplication.Aa.kG.JU(C.a.Hl,
this.T6,Object(e.a)(this,this.R3g,"onLinkKeyUp"),this)):(this.T6.href=this.Aff,this.T6.target="_blank"),this.y3a.appendChild(this.T6),this.htmlElement.appendChild(this.y3a));n.AFrameworkApplication.Aa.By.pb(C.a.click,this.htmlElement,Object(e.a)(this,this.onClick,"onClick"));n.AFrameworkApplication.Aa.kG.JU(C.a.Hl,this.bN,Object(e.a)(this,this.XEe,"onBodyKeyUp"),this);this.kcf&&!this.NSb&&(n.AFrameworkApplication.Aa.Aaa.pb(this.htmlElement,Object(e.a)(this,this.onClick,"onClick"),null),this.NSb=!0);
this.Imb&&(this.xpa=document.createElement("span"),this.xpa.className=Q.VNh,this.VR=document.createElement("a"),this.VR.className=Q.WNh,this.VR.tabIndex=0,this.VR.title=CommonUIStrings.l_DialogClose,this.VR.setAttribute(J.a.af,J.a.ru),this.$E=v.createClusteredImage(16,16,Q.XNh,"",!0,""),this.VR.appendChild(this.$E),this.xpa.style.display="table-cell",this.xpa.appendChild(this.VR),this.htmlElement.appendChild(this.xpa),n.AFrameworkApplication.Aa.By.JU(C.a.click,this.VR,Object(e.a)(this,this.T1g,"onCloseClick"),
this),n.AFrameworkApplication.Aa.kG.JU(C.a.Hl,this.VR,Object(e.a)(this,this.U1g,"onCloseKeyUp"),this));return this.htmlElement}Dfl(){this.bN&&this.bN.setAttribute(J.a.JK,J.a.ura)}gqf(W,O){if(O&&""!==O){var Y=document.createElement("span");Y.className=Q.tZh;Y.innerText=O;W.appendChild(Y)}}sHf(W,O,Y,S){W.className=Q.oNh;O.setAttribute("type","button");O.className=Q.nNh;O.innerText=Y;W.appendChild(O);this.htmlElement.appendChild(W);n.AFrameworkApplication.Aa.By.JU(C.a.click,O,S,this)}Akh(){this.Zmc||
(this.bN.style.whiteSpace="nowrap",this.closeable?this.xpa.style.width="auto":this.DTb?this.y3a.style.width="auto":this.Bmb?this.OPb.style.width="auto":this.Amb?this.MPb.style.width="auto":this.bN.style.width="auto",this.htmlElement.clientWidth>this.businessBar.htmlElement.clientWidth?this.bN.style.whiteSpace="normal":this.closeable?this.xpa.style.width="100%":this.DTb?this.y3a.style.width="100%":this.Bmb?this.OPb.style.width="100%":this.Amb?this.MPb.style.width="100%":this.bN.style.width="100%")}U1e(W,
O){if(A.a.eGb()){var Y={};Y.WacSessionId=n.AFrameworkApplication.userSessionId;Y.ActionName="BusinessBar"+W;Y.InputMethod=O;k.ULS.sendTraceTag(35489761,207,50,JSON.stringify(Y))}}iX(W,O,Y,S){this.U1e(W,Y);A.a.SUa()&&z.c(O,!0,z.e,S,10)}bzf(W){this.Owd(W.kD);this.iX("ButtonOne",R.a.Wyf,"Mouse",2);this.Nwd&&(this.iX("Close",R.a.Yrb,"Mouse_ButtonOne",2),this.close(W));return!0}Jki(W){this.Owd(W);this.iX("ButtonOne",R.a.Wyf,"Mouse",2);this.Nwd&&(this.iX("Close",R.a.Yrb,"Mouse_ButtonOne",2),this.nUd(W))}czf(W){this.Swd(W.kD);
this.iX("ButtonTwo",R.a.Xyf,"Mouse",2);this.Rwd&&(this.iX("Close",R.a.Yrb,"Mouse_ButtonTwo",2),this.close(W));return!0}Lki(W){this.Swd(W);this.iX("ButtonTwo",R.a.Xyf,"Mouse",2);this.Rwd&&(this.iX("Close",R.a.Yrb,"Mouse_ButtonTwo",2),this.nUd(W))}$mg(W){this.x3a(W.kD);this.iX("Link",R.a.$yf,"Mouse",2);return!0}lqk(){this.x3a(null)}R3g(W){return W.pc.keyCode!==w.a.tq||W.pc.altKey?!1:(this.x3a(W.kD),this.iX("Link",R.a.$yf,"Keyboard",1),!0)}XEe(W){return W.pc.keyCode===w.a.tq&&!W.pc.altKey&&this.r8b?
(this.r8b(W.kD,W),this.iX("Invoke",R.a.Zyf,"Keyboard",1),!0):!1}dispose(){this.htmlElement&&(n.AFrameworkApplication.Aa.By.yb(C.a.click,this.htmlElement,Object(e.a)(this,this.onClick,"onClick")),this.NSb&&n.AFrameworkApplication.Aa.Aaa.yb(this.htmlElement,Object(e.a)(this,this.onClick,"onClick")));this.VR&&(n.AFrameworkApplication.Aa.By.yb(C.a.click,this.VR,Object(e.a)(this,this.T1g,"onCloseClick")),n.AFrameworkApplication.Aa.kG.yb(C.a.Hl,this.VR,Object(e.a)(this,this.U1g,"onCloseKeyUp")));this.LPb&&
n.AFrameworkApplication.Aa.By.yb(C.a.click,this.LPb,Object(e.a)(this,this.bzf,"buttonOneClickHandler"));this.NPb&&n.AFrameworkApplication.Aa.By.yb(C.a.click,this.NPb,Object(e.a)(this,this.czf,"buttonTwoClickHandler"));this.T6&&this.x3a&&(n.AFrameworkApplication.Aa.By.yb(C.a.click,this.T6,Object(e.a)(this,this.$mg,"linkClickHandler")),n.AFrameworkApplication.Aa.kG.yb(C.a.Hl,this.T6,Object(e.a)(this,this.R3g,"onLinkKeyUp")));this.bN&&n.AFrameworkApplication.Aa.kG.yb(C.a.Hl,this.bN,Object(e.a)(this,
this.XEe,"onBodyKeyUp"));this.businessBar=this.VR=this.xpa=this.$E=this.y3a=this.T6=this.OPb=this.NPb=this.MPb=this.LPb=this.bN=this.D6=this.wP=this.Lqa=this.vNa=this.kha=null}onClick(W){this.iX("Invoke",R.a.Zyf,"Mouse",2);return!!this.r8b&&this.r8b(this,W)}T1g(W){this.iX("Close",R.a.Yrb,"Mouse",2);this.close(W);return!0}U1g(W){return W.pc.keyCode!==w.a.tq||W.pc.altKey?!1:(this.iX("Close",R.a.Yrb,"Keyboard",1),this.close(W),!0)}close(W){const O=W.kD;this.businessBar.removeEntry(O);this.Ddg(O,W.Yf)}Ddg(W,
O){if(W.P2){const Y=n.AFrameworkApplication.Ta;Y.wq=10;Y.oT=O;W.P2(W);Y.wq=0;Y.oT=0}}nUd(W){W&&this.businessBar&&(this.businessBar.removeEntry(W),this.Ddg(W,0))}}Q.z6e="WACBusinessBarEntry";Q.sNh="WACBusinessBarTitle";Q.mNh="WACBusinessBarBody";Q.rNh="WACBusinessBarTitleBodyHolder";Q.oNh="WACBusinessBarButtonHolder";Q.nNh="WACBusinessBarButton";Q.qNh="WACBusinessBarLinkHolder";Q.WNh="WACBusinessBarClose";Q.VNh="WACBusinessBarCloseHolder";Q.XNh="BusinessBarClose_16x16x32";Q.eSh="WACBusinessBarImage";
Q.tZh="WACScreenReaderOnly";Q.gQh="CancelRequest_24x24x32";Q.B2h="Risks_24x24x32";Q.oSh="Info_24x24x32";Q.rYh="ReactBusinessBarEntry";Q.p2h="VNextBusinessBarEntry";Object(K.a)(Q,"BusinessBarEntry",null,[424,106])},512:function(K,Z,d){d.d(Z,"a",function(){return r});K=d(0);var k=d(63),e=d(513),n=d(902);class r{B_b(v,C){if(1===v.nodeType&&C){var w=this.GW(C);v=this.aUf(v,w);this.qui(w,v,C)}}aUf(v,C){const {CombineHelper:w}=d(1137),z=[];let A=null;for(let E=0;E<v.childNodes.length;E++){var u=v.childNodes[E];
3===u.nodeType?(A||(A=new w(v,E,C)),A.b7h(E)):(A&&(A.end(z,E-1),A=null),u=this.aUf(u,C),Array.addRange(z,u))}A&&A.end(z,v.childNodes.length-1);return z}qui(v,C,w){v=v.clone();let z=!1;for(let A=C.length-1;0<=A;A--){const u=C[A].pui();z=v.merge(u)||z}z&&this.setSelection(v,w)}setSelection(v,C){C=k.a.IDa(C);C.setStart(v.start.element,v.start.offset);C.setEnd(v.end.element,v.end.offset)}GW(v){return(v=k.a.IDa(v))?Object.assign(new n.a,{start:Object.assign(new e.a,{element:v.startContainer,offset:v.startOffset}),
end:Object.assign(new e.a,{element:v.endContainer,offset:v.endOffset})}):new n.a}}r.unused=-1;Object(K.a)(r,"TextNodeCombiner",null,[1405])},513:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k{constructor(){this.element=null;this.offset=0}clone(){return Object.assign(new k,{element:this.element,offset:this.offset})}merge(e){if(!e.element||this.element===e.element&&this.offset===e.offset)return!1;this.element=e.element;this.offset=e.offset;return!0}}Object(K.a)(k,"SelectionSide",null,
[])},514:function(K,Z,d){d.d(Z,"a",function(){return e});K=d(0);Z=d(256);var k=d(127);class e extends Z.a{constructor(){super();this.items=this.parentRevId=this.parentPath=null;this.H_=Object.assign(new k.a,{T_:e.getTypeName(),B_:e.getBaseTypes()})}static getTypeName(){return"AugLoop_Core_Operation"}static getBaseTypes(){return[]}}Object(K.a)(e,"Operation",Z.a,[])},515:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);var k;(function(e){e[e.none=0]="none";e[e.oneNote=1]="oneNote";e[e.word=2]=
"word";e[e.wordViewer=3]="wordViewer";e[e.powerPoint=4]="powerPoint"})(k||(k={}));Object(K.b)("AppMode",k)},516:function(K,Z,d){d.d(Z,"a",function(){return e});d.d(Z,"b",function(){return n});d.d(Z,"c",function(){return r});const k=v=>{switch(v){case 1:return 5;case 2:return 4;case 3:return 3;case 5:return 2;case 4:return 1;default:return 0}},e=v=>k(r(v.Priority,v.Tag)),n=v=>r(v.Priority,v.Tag),r=(v,C)=>{switch(v){case 0:return 1;case 1:return 2;case 2:return C&1?5:3;case 3:return 4;default:return 0}}},
517:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k{constructor(){this.C=this.T=this.E=0;this.F=null;this.I=this.A=0;this.G=null}}Object(K.a)(k,"ProofingTraceMetrics",null,[])},518:function(K,Z,d){d.d(Z,"a",function(){return n});d.d(Z,"b",function(){return r});d.d(Z,"c",function(){return v});var k=d(25),e=d(519);const n=()=>{const C=k.AFrameworkApplication.Aa.hb.Vk;return(3===C||1===C||2===C||4===C)&&k.AFrameworkApplication.fa.ka("PremiumUpsellIsEnabled")},r=(C,w,z,A=!1)=>{w=1===w;
1===C&&(w=2===k.AFrameworkApplication.Aa.mode);return String.format("PROD_OfficeOnline-{0}_{1}_{2}_{3}",e.a[C],w?"Editor":"Viewer",A?"Dime":"Unknown",z?z:"dimedefault")},v=C=>{switch(C){case 3:return"OfficeOnlineWord";case 1:return"OfficeOnlineExcel";case 2:return"OfficeOnlinePowerPoint";case 4:return"OfficeOnlineOneNote";default:return null}}},519:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);var k;(function(e){e[e.unknown=0]="unknown";e[e.excel=1]="excel";e[e.powerPoint=2]="powerPoint";
e[e.word=3]="word";e[e.oneNote=4]="oneNote";e[e.visio=5]="visio"})(k||(k={}));Object(K.b)("OfficeAppType",k)},520:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k{}k.Kwf="AugEditorServiceTileCheckRequest";k.Lwf="AugEditorServiceTileCheckResponse";k.TOi="EditorServiceTileCheckRequest";k.gEf="Proofing.ProofingRequest";k.pUd="Proofing.ProofingResponse";Object(K.a)(k,"ProofingAugmentationSchemaNames",null,[])},521:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k{constructor(){this.slideId=
null;this.Yah=this.Rqc=0}}Object(K.a)(k,"SlidePresenceInfo",null,[])},522:function(K,Z,d){d.d(Z,"a",function(){return r});K=d(0);var k=d(382),e=d(1047),n=d(33);class r{execute(v,C,w=null){k.ULS.sendTraceTag(572846934,380,50,"reqType:{0}",v.$k());const z=new e.a,A=this.f8(v,C,w);A.continueWith(()=>{if(A.rm)z.lG(A.Zi);else if(A.Sn)z.A1();else{const u=A.result;if(u&&!u.succeeded&&u.Xi&&u.Xi.data&&5===A.result.Xi.data.status){const E=this.f8(v,C,w);E.continueWith(()=>{E.rm?z.lG(E.Zi):E.Sn?z.A1():z.HM(E.result)})}else z.HM(u)}});
return z.task}f8(v,C,w){w=this.qhj(w);return C(w,{"Content-Type":"application/json; charset=utf-8"},v.serialize())}qhj(v){return v?String.format("{0}/{1}",v,"people.ashx"):"people.ashx"}static x7a(v){if(!v)return k.ULS.sendTraceTag(572846935,380,10,"ResponseBodyTask from PeopleHandler is null"),null;try{return n.a(v)}catch(C){k.ULS.sendTraceTag(572846936,380,10,"Could not parse the response. Message: {0}",C.message)}return null}}Object(K.a)(r,"CommonHandlerRequestManager",null,[])},523:function(K,
Z,d){d.d(Z,"a",function(){return e});K=d(0);var k=d(382);class e{equals(n,r){if(!n||!r)return!n&&!r;if(n.UserId!==r.UserId){if(!e.GNf(n.Provider)||!e.GNf(r.Provider))return!1;const C=n.UserId.startsWith(e.xXb);var v=r.UserId.startsWith(e.xXb);if(C&&v){if(n.Provider!==r.Provider)return k.ULS.sendTraceTag(593368202,327,10,"Provider mismatch when both IDs are in AD format. Providers: {0} , {1}",n.Provider,r.Provider),!1;v=e.URf(n.UserId);r=e.URf(r.UserId);return!!v&&v===r}n=n.Email&&""!==n.Email?n.Email:
C?e.h8a(n.UserId):n.UserId;r=r.Email&&""!==r.Email?r.Email:v?e.h8a(r.UserId):r.UserId;return!!n&&n===r}return n.Provider!==r.Provider?!1:n.Provider&&""!==n.Provider||n.UserId&&""!==n.UserId?!0:n.DisplayName===r.DisplayName}IW(){return 0}static GNf(n){return"O365"===n||"AD"===n}static h8a(n){if(!n.startsWith(e.xXb))return null;n=n.substr(e.xXb.length);const r=n.lastIndexOf("::");return-1===r?null:n.substr(0,r)}static URf(n){if(!n.startsWith(e.xXb))return null;var r=n.lastIndexOf("::");if(-1===r)return null;
r+=2;return r>=n.length?null:n.substr(r)}}e.xXb="S::";Object(K.a)(e,"CommentTaskPersonIdentityComparer",null,[353])},524:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k{constructor(e){this.MessageId=e;this.SendTime=0;this.CorrelationId="";this.Values={}}}Object(K.a)(k,"CrossDocumentMessage",null,[])},525:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k{constructor(){this.additionalDataFields=this.otelEvent=null}}Object(K.a)(k,"OtelTelemetryEvent",null,[])},526:function(K,
Z,d){d.d(Z,"a",function(){return k});K=d(0);class k{constructor(e,n){this.previewControlIds=this.legacyControlId=this.populationProps=this.menuItemId=this.commandRevertId=this.commandPreviewId=this.queryCommandId=this.commandId=this.externalUxCommand=null;this.externalUxCommand=e;this.commandId=n}}Object(K.a)(k,"CommandMetadata",null,[])},527:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);d=d(302);class k{}k.CommandValueId="CommandValueId";k.Description="Description";k.Image16by16Class=d.a.Exb;
k.Image30by30Class=d.a.Gzj;k.Image32by32Class=d.a.xEa;k.Image48by48Class=d.a.Mbe;k.On="On";k.LabelText=d.a.labelText;k.Visible=d.a.visible;k.SourceControlId="SourceControlId";k.DisplayMode="DisplayMode";k.Alt=d.a.alt;Object(K.a)(k,"ToggleButtonCommandProperties",null,[])},528:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k{}k.vv="InputMethod";k.Rfa="ShouldCanvasTakeFocus";k.qEh="UILocation";Object(K.a)(k,"ReactRibbonConstants",null,[])},529:function(K,Z,d){d.d(Z,"a",function(){return k});
K=d(0);class k{static get instance(){const {NewCustomEventFactory:e}=d(1108),{IECustomEventFactory:n}=d(1109);k.Ka||(k.Ka="function"===typeof window.CustomEvent?new e:new n);return k.Ka}}k.Ka=null;Object(K.a)(k,"CustomEventFactory",null,[])},530:function(K,Z,d){d.d(Z,"a",function(){return e});d.d(Z,"b",function(){return r});var k=d(8);d(1047);const e=C=>n(C),n=C=>new Promise((w,z)=>{C.continueWith(A=>{A.rm?z(A.Zi.message):A.Sn?z(k.a.CKc()):w(null)})}),r=C=>v(C),v=C=>new Promise((w,z)=>{C.continueWith(()=>
{C.rm?z(C.Zi.message):C.Sn?z(k.a.CKc()):w(C.result)})})},531:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k{constructor(){this.Fkb=this.kda=this.VY=null;this.wZc=this.pqc=!1;this.nIe=0;this.Ub=null;this.reset()}reset(){this.kda=[];this.VY=null;this.Fkb=[];this.wZc=this.pqc=!1;this.nIe=0;this.Ub=null}}Object(K.a)(k,"HtmlPasteContext",null,[])},532:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k{}k.themeColors="Theme Colors";Object(K.a)(k,"ReactColorConstants",null,[])},
542:function(K,Z,d){K=d(0);var k=d(382),e=d(348),n=d(55),r=d(65),v=d(171),C=d(91),w=d(25);d(13);var z=d(33),A=d(48),u=d(97);class E{constructor(){this.khb=this.z5=null;this.KBh=0}}Object(K.a)(E,"CandidateManager",null,[]);var H=d(652),I=d(650),J=d(651);class T{constructor(){this.keyCode=0;this.WEl=this.VEl=null}}Object(K.a)(T,"PredictionKeptState",null,[]);class D{constructor(){this.values={}}zbg(Da,pa,la){Da=this.V4f(Da);Da[pa]=pa in Da?Da[pa]+la:la}add(Da,pa,la){this.V4f(Da)[pa]=la}ga(Da){return this.values[Da]}$(Da,
pa){return this.values[Da]=pa}MFf(Da){return Da in this.values?!0:!1}V4f(Da){let pa;Da in this.values?pa=this.values[Da]:(pa={},this.values[Da]=pa);return pa}}Object(K.a)(D,"PredictionState",null,[]);class R{constructor(){this.WordPredIsEnabled=!0;this.PredictionSeenCount=0;this.PredictionAccepted=!1}}Object(K.a)(R,"TypeAheadRoamingSettings",null,[]);var Q=d(199),W=d(1186),O=d(17),Y=d(906),S=d(653);d(908);var da=d(907);class fa{constructor(Da){this.hvc=null;this.qD=Da;Da=n.a.instance.resolve("Common.IDynamicScriptLoaderProvider").Pw;
const pa=n.a.instance.resolve("Common.ISharedDependencyLoader");this.initialize(Da,pa)}initialize(Da,pa){const la=new S.a;return Da?pa?this.hvc?this.hvc:w.AFrameworkApplication.Aa.hb.bgg?this.hvc=new Promise((Fa,Qa)=>{const Sa=w.AFrameworkApplication.Pj("al",2);pa.pAb(Sa).continueWith(Na=>{Na.rm?(this.W3g(),Qa(Na.Zi.message)):(this.$bg(la),Fa({}))})}):this.hvc=Da.loadScript("al").then(()=>{this.$bg(la)}).catch(Fa=>{this.W3g();return Promise.reject(Fa)}):Promise.reject("SharedDependencyLoader is null"):
Promise.reject("DynamicScriptLoader is null")}$bg(Da){fa.LS.cG(()=>{k.ULS.sendTraceTag(595091613,3010,50,"AugLoop TextPrediction Load success");const pa=augLoop.ALFactoryGlobal.getAugLoopRuntimeManager();let la=w.AFrameworkApplication.fa.Ha("OfficeApplicationName")||"";la=la.replace("Web","");Da.appName=Da.appName||la;Da.serviceUrl=Da.serviceUrl||w.AFrameworkApplication.fa.Ha("AugLoopCloudALServiceUrl");Da.appVersion=Da.appVersion||w.AFrameworkApplication.fa.Ha("BuildVersion")||"";Da.releaseAudienceGroup=
Da.releaseAudienceGroup||(w.AFrameworkApplication.gd?Object(W.a)(String,w.AFrameworkApplication.gd.AudienceGroup)||"":"");Da.sessionId=Da.sessionId||w.AFrameworkApplication.fa.Ha("SessionId")||"";Da.uiLanguage=Da.uiLanguage||w.AFrameworkApplication.uiCulture;Da.flights=this.m2i();Da.initSession=Da.initSession||!0;pa.initialize(Da);pa.activateAnnotation(Object.assign(new Y.a,{annotationType:da.a.getTypeName(),handler:this.qD}))},"WordPredictionAL:Initialize")}W3g(){k.ULS.sendTraceTag(595091612,3010,
50,"AugLoop TextPrediction Load Fail")}m2i(){var Da=w.AFrameworkApplication.fa.Ha("FlightId"),pa=w.AFrameworkApplication.fa.RA("AugLoopFlightKeywordList");Da=this.UVi(Da,pa);pa="";0<Da.length&&(pa=Q.a.join(Da,";"),k.ULS.sendTraceTag.apply(null,[595091610,3010,50,"FlightCount: [{0}], flightIds: [{1}]",Da.length].concat(Da)));return pa}UVi(Da,pa){const la=new O.a;if(Da&&""!==Da&&pa&&0<pa.length){for(let Fa=0;Fa<pa.length;Fa++)pa[Fa]=pa[Fa].toLowerCase();Da=Da.toLowerCase().split(";");for(const Fa of Da)Q.a.any(pa,
Qa=>-1<Fa.indexOf(Qa))&&la.add(Fa)}return la.toArray()}static get LS(){return e.a.instance}}Object(K.a)(fa,"WordPredictionAugLoopHandler",null,[941]);var ka=d(141),ha=d(179),F=d(129);class na{constructor(Da,pa,la,Fa){this.m1b=null;this.fYg=Da;this.P3k=la;this.Aoi=Fa;this.C3k=pa;this.HLc=Array(Da);this.jkh();this.wkh()}LAj(Da,pa,la){Da>this.fYg-1||this.ybg(this.HLc[Da],pa,la)}E$a(Da,pa){this.ybg(this.m1b,Da,pa)}aNd(Da,pa){this.m1b[Da]=pa}flush(){na.LS.cG(()=>{for(let Da=0;Da<this.HLc.length;Da++){const pa=
this.k1i(Da);pa&&(pa.dataFields.push(Object.assign(new F.a,{name:I.a.nP,int64:Da})),ka.a.sendActivityEvent(pa))}this.jkh()},"WPT:F")}KYi(){na.LS.cG(()=>{const Da=this.j1i();Da&&ka.a.sendActivityEvent(Da);this.wkh()},"WPT:FSD")}FYi(Da){na.LS.cG(()=>{const pa=this.i1i(Da);pa&&ka.a.sendActivityEvent(pa)},"WPT:FCD")}j1i(){const Da=this.j7d(this.P3k);for(var pa=0;pa<J.a.fSa.length;pa++)this.bNd(J.a.fSa[pa],this.m1b,Da.dataFields);for(pa=0;pa<J.a.i4b.length;pa++)this.MXb(J.a.i4b[pa],this.m1b,Da.dataFields);
return Da.dataFields.length?Da:null}k1i(Da){const pa=this.j7d(this.C3k);for(let la=0;la<I.a.fSa.length;la++)this.bNd(I.a.fSa[la],this.HLc[Da],pa.dataFields);return pa.dataFields.length?pa:null}i1i(Da){const pa=this.j7d(this.Aoi);for(var la=0;la<H.a.fSa.length;la++)this.bNd(H.a.fSa[la],Da,pa.dataFields);for(la=0;la<H.a.i4b.length;la++)this.MXb(H.a.i4b[la],Da,pa.dataFields);return pa.dataFields.length?pa:null}ybg(Da,pa,la){Da[pa]=pa in Da?Da[pa]+la:la}j7d(Da){const pa=new ha.a;pa.name=Da;pa.dataFields=
[];return pa}bNd(Da,pa,la){Da in pa&&Array.add(la,Object.assign(new F.a,{name:Da,int64:pa[Da]}))}MXb(Da,pa,la){Da in pa&&Array.add(la,Object.assign(new F.a,{name:Da,string:pa[Da]}))}jkh(){for(let Da=0;Da<this.fYg;Da++)this.HLc[Da]={}}wkh(){this.m1b={}}static get LS(){return e.a.instance}}Object(K.a)(na,"WordPredictionTelemetryHandler",null,[940]);var ba=d(62),Ea=d(31),La=d(380),ta=d(304),oa=d(90);d(233);var wa=d(49),ra=d(32);d(389);d(434);d(1032);d.d(Z,"a",function(){return ya});class ya{static get LS(){return e.a.instance}static get KD(){ya.Dvc||
(ya.Dvc=new E);return ya.Dvc}static set KD(Da){ya.Dvc=Da}static get EZc(){return ya.dpf}static set EZc(Da){ya.dpf=Da}static get fJh(){ya.oMd||(ya.oMd=ya.IEi());return ya.oMd}static get settings(){ya.RCc||(ya.RCc=Object.assign(new R,{WordPredIsEnabled:!0,PredictionSeenCount:0,PredictionAccepted:!1}));return ya.RCc}static set settings(Da){ya.RCc=Da}static get dZa(){ya.fHd||(ya.fHd=new D);return ya.fHd}static get Ool(){return ya.aJi}static get h6(){ya.qMd||(ya.qMd=new na(ya.Ool,"Office.Word.Online.WordPredictionTelemetryData",
"Office.Word.Online.WordPredictionTelemetryDataPerSession","Office.Word.Online.WordPredictionTelemetryDataPerCandidate"));return ya.qMd}static get NHi(){return ya.t5a?ya.t5a.instance?ya.t5a.instance.Y2:1:(ya.t5a=n.a.instance.Ja("Common.IZoomManager"),ya.t5a&&ya.t5a.instance?ya.t5a.instance.Y2:1)}static get characterPropertiesEditor(){ya.mxd||(ya.mxd=n.a.instance.resolve("Box4.ICharacterPropertiesEditor"));return ya.mxd}static get Bhd(){ya.rHd||n.a.instance.Ja("Box4.Proofing.IProofingSentenceSeparator").execute(Da=>
{Da&&(ya.rHd=Da)});return ya.rHd}static get XEl(){ya.pMd||(ya.pMd=n.a.instance.resolve("Box4.WordPrediction.IWordPredictionSettingsInfo"));return ya.pMd}static M0k(){window.setTimeout(()=>{const Da={};Da.WordPredIsEnabled=ya.settings.WordPredIsEnabled;Da.PredictionSeenCount=ya.settings.PredictionSeenCount;Da.PredictionAccepted=ya.settings.PredictionAccepted;ya.XEl.IIl(z.c(Da))},ya.uKf)}static P$d(Da,pa){if(!Da||!pa||Da.eventName!==r.a.KPa)return!1;const la=Da.pc.keyCode;if(ya.Geg(pa)){ya.iPk();pa=
pa.node;if((la===v.a.lP||la===v.a.Pq)&&ya.zUa)return C.a.An(Da.pc),ya.iFj(pa),ya.Jzl(la),k.ULS.sendTraceTag(578307398,820,50,"Prediction Text Accepted"),!0;if(la===v.a.mP)ya.EZc&&(ya.EZc=!1);else if(la===v.a.J1&&ya.zUa)ya.EZc=!0,k.ULS.sendTraceTag(578307397,820,50,"Prediction Text Rejected"),ya.ETa();else if(la===v.a.Wlb&&Da.pc.ctrlKey&&ya.eHd)return k.ULS.sendTraceTag(578307396,820,50,"Prediction Undid"),ya.ukh(),!1}if(la===v.a.Clb&&Da.pc.shiftKey||la===v.a.yga&&Da.pc.ctrlKey||la===v.a.bMa&&Da.pc.altKey)return!1;
pa=ya.KD.z5;const Fa=la===v.a.aZ||la===v.a.x6||la===v.a.zga||la===v.a.Naa;if(Fa||Fa&&(Da.pc.ctrlKey||Da.pc.shiftKey)||la!==v.a.yga&&Da.pc.ctrlKey||la!==v.a.bMa&&Da.pc.altKey||la===v.a.MH||ya.zUa&&pa&&0<pa.B8.length&&!pa.B8.toLowerCase().startsWith(String.fromCharCode(la).toLowerCase()))ya.ETa(),ya.KD.z5=null,k.ULS.sendTraceTag(578307395,820,50,"Prediction hidden due to user typing a character that did not match prediction");ya.ukh();return!1}static suj(){5>ya.settings.PredictionSeenCount&&(ya.settings.PredictionSeenCount+=
1)}static ETa(){La.a.ETa();ya.zUa=!1}static iFj(Da){ya.LS.cG(()=>{var pa=document.getElementById("inlinePredictedWord");if(pa){var la=pa.innerText;if(la&&0<la.length&&(Da=Da?Da:ya.tdj())){var Fa=new A.GraphTransaction(7);Fa.kd(Da);var Qa=Da.Ra.last,Sa=wa.a.zQa(Da),Na=oa.a.ps(Sa);Qa.formatting=Na.$d(Qa);ya.characterPropertiesEditor.replaceTextRange(Sa,la,!0,!0,ra.a.typing);Fa.dispose();la=u.InteractiveViewManager.instance.Rd;Fa=Da.tg(la.Ma);Fa=ta.a.Kt(Fa,Ea.ParagraphReader.textLength(Da));Qa=new Sys.UI.Point(Fa.x,
Fa.y);Qa.y+=Fa.height;la.r6(Qa,null,null,la,!1);ya.zUa=!1;pa.innerText="";(pa=document.getElementById("inlinePlaceholderTab"))&&ya.m9f()&&(pa.className="hidePanel")}}},"WPT:IIG")}static y7k(Da){ya.$lf=Da;ya.h6.aNd(J.a.modelId,Da.modelId);ya.h6.aNd(J.a.modelVersion,Da.modelVersion);ya.h6.aNd(J.a.configId,Da.configId)}static Kbj(){return ya.$lf}static EPd(Da,pa){const la=ya.fJh;var Fa=document.getElementById("inlinePredictedWord");Fa&&(Fa.innerText=pa,(pa=document.getElementById("WACViewPanel_EditingElement_WrappingDiv").getElementsByClassName("TextRun"))&&
0<pa.length&&(pa=pa[pa.length-1],Fa.style.fontSize=pa.style.fontSize,Fa.style.fontFamily=pa.style.fontFamily,Fa.style.color=pa.style.color,Fa.style.whiteSpace="pre",Fa=Fa.parentNode,Da="suggestion: "+Da,pa=document.getElementById("inlinePlaceholderTab"),pa.className="hidePanel",pa&&ya.m9f()&&(pa.className="inlinePlaceholderTab",Da+=". Tab to accept"),Fa.parentNode.setAttribute("aria-label",Da)),la&&(la.className="textareaCaretTracker"),ya.k8k()&&(ya.zUa=!0,k.ULS.sendTraceTag(578307393,820,50,"Ghost Text Visible")))}static Geg(Da){Da||
(Da=ya.W4i());if(Da){const pa=Da.node;try{return Ea.ParagraphReader.textLength(pa)<=Da.Qa}catch(la){}}return!1}static K_j(Da){Da=ya.dZa.ga(Da);Da=Da[J.a.fPd]-Da[J.a.Oqc];300<Da?(ya.h6.E$a(J.a.aLf,Da),ya.h6.E$a(J.a.$Kf,1)):(ya.h6.E$a(J.a.Mwf,Da),ya.h6.E$a(J.a.buf,1))}static I2d(Da){ya.wgg("TextPredictionTelemetryIsEnabled")&&ya.h6.FYi(Da)}static bog(Da,pa){Da=ya.dZa.ga(Da);const la=Da[J.a.Oqc];pa?ya.h6.E$a(J.a.Qvh,Da[J.a.cuf]-la):ya.h6.E$a(J.a.Ovh,Da[J.a.auf]-la)}static vac(Da){ya.h6.E$a(Da,1)}static Bua(Da,
pa,la){ya.h6.LAj(Da,pa,la)}static Qkd(){ya.KD.z5=null;ya.KD.khb=null}static uDk(){ya.flb("TextPredictionsSeen","TextPredictionsSeenIsEnabled");ya.suj();ya.DGj()}static flb(Da,pa){ya.wgg(pa)&&window.setTimeout(()=>{const la=n.a.instance.Ja("Common.ISystemInitiatedFeedback");la&&la.execute(Fa=>{Fa.logActivity(Da,pa)})},ya.uKf)}static wgg(Da){return!!w.AFrameworkApplication.fa&&w.AFrameworkApplication.fa.ka(Da)}static IEi(){var Da=document.body;const pa=document.createElement("div");if(Da){Da.appendChild(pa);
pa.setAttribute("id","textareaCaretTracker");pa.className="hidePanel";pa.setAttribute("role","alert");Da=document.createElement("button");const la=document.createElement("span");Da.setAttribute("disabled",!0);Da.setAttribute("aria-disabled",!0);Da.setAttribute("aria-hidden",!0);la.setAttribute("aria-disabled",!0);la.setAttribute("aria-hidden",!0);la.setAttribute("id","inlinePredictedWord");la.className="inlinePredictedWord";Da.className="inlinePredictedWordButton";Da.appendChild(la);pa.appendChild(Da);
pa.appendChild(ya.pGi());(Da=document.getElementById("WACViewPanel"))&&$addHandler(Da,"scroll",ya.wsj)}return pa}static k8k(){const Da=ya.fJh;var pa=document.getElementById("WACViewPanel_EditingElement_WrappingDiv");pa=(pa=pa?pa.getElementsByClassName("EOP")[0]:null)?pa.getBoundingClientRect():null;return Da&&pa?(Da.style.cssText="transform: scale("+ya.NHi+"); transform-origin: 0% 0%",Da.style.top=pa.top+"px",Da.style.left=pa.left+"px",!0):!1}static m9f(){return!ya.settings.PredictionAccepted}static DGj(){5!==
ya.settings.PredictionSeenCount||ya.settings.PredictionAccepted||(ya.flb("PredictionNotAccepted","PredictionNotAcceptedIsEnabled"),ya.M0k())}static pGi(){const Da=document.createElement("button");Da.setAttribute("aria-hidden",!0);Da.className="hidePanel";Da.id="inlinePlaceholderTab";Da.disabled=!0;Da.innerText="Tab";return Da}static wsj(){ya.ETa()}static tdj(){const Da=ba.a.instance.Pa.mb;return Da&&Da.Ye?Da.Ye.node:null}static iPk(){ya.NKd||(ya.NKd=window.setTimeout(ya.Tqj,6E4*ya.$Ii))}static Tqj(){ya.h6.flush();
ya.h6.KYi();ya.NKd=0}static W0f(Da){return Da&&0<Da.length&&(Da=Da.split(" "),0<Da.length)?Da[Da.length-1].length:-1}static Jzl(Da){const pa=ya.KD.z5,la=ya.KD.khb;pa&&(ya.eHd=Object.assign(new T,{keyCode:Da,VEl:pa,WEl:la}))}static W4i(){const Da=ba.a.instance.Pa.mb;return Da&&Da.Ye?Da.Ye:null}static ukh(){ya.eHd=null}}ya.aJi=30;ya.$Ii=5;ya.uKf=5E3;ya.oMd=null;ya.rHd=null;ya.mxd=null;ya.t5a=null;ya.dpf=!1;ya.NKd=0;ya.qMd=null;ya.fHd=null;ya.eHd=null;ya.pMd=null;ya.RCc=null;ya.$lf=null;ya.Dvc=null;
ya.zUa=!1;Object(K.a)(ya,"WordPredictionHandler",null,[])},649:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k{}k.sjk="NoCharacterPositionOnLine";k.ujk="NoCharacterPositionOnSpan";k.tjk="NoCharacterPositionOnMultilineSpan";k.Q1b="DoNothingResult";k.vja="FailedProcessingStep";k.l8a="FailedResult";k.jPc="FirstChildNotText";k.BXi="FirstChildNull";k.NFj="InvalidCharacterPositionResult";k.wh="NoExecute";k.To="NoApply";k.C1="UnexpectedState";Object(K.a)(k,"ActivityEventName",null,[])},650:function(K,
Z,d){d.d(Z,"a",function(){return k});K=d(0);class k{}k.nP="WordIndex";k.Vih="RenderedCandidateCount";k.B_g="NotRenderedCandidateCount";k.yBf="CandidateListCount";k.AJf="CumulativeIndexOfSeen";k.xHi="CumulativeIndexOfRejected";k.wHi="CumulativeIndexOfKept";k.zJf="CumulativeIndexOfCorrect";k.vHi="CumulativeIndexOfAcceptedCandidate";k.Bnh="SeenCount";k.YQk="RejectedCount";k.yWj="KeptCount";k.iEh="TypedThroughCount";k.yHi="CumulativeScoreOfKept";k.zHi="CumulativeScoreOfRejected";k.CJf="CumulativeScoreOfTypeThrough";
k.Wih="RenderedCharSum";k.xWj="KeptCharSum";k.wWj="KeptCandidateTokenSum";k.Qvl="UndoOfKeptCount";k.Tvl="UndoneKeptCharCount";k.jEh="TypedThroughLastMatchingCharCount";k.language="Language";k.fSa=[k.Vih,k.B_g,k.yBf,k.AJf,k.xHi,k.wHi,k.zJf,k.vHi,k.Bnh,k.YQk,k.yWj,k.iEh,k.yHi,k.zHi,k.CJf,k.Wih,k.xWj,k.wWj,k.Qvl,k.Tvl,k.jEh,k.language];Object(K.a)(k,"DataFieldsPerSentence",null,[])},651:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k{}k.modelId="ModelId";k.configId="ConfigId";k.modelVersion=
"ModelVersion";k.sDk="PredictionAcceptedByTab";k.rDk="PredictionAcceptedByRightArrow";k.Mwf="AugLoopResponseTime";k.Qvh="SignalRenderedTime";k.Ovh="SignalNotRenderedTime";k.aLf="DelayedResponseTime";k.Qhl="SignalGeneratedCount";k.buf="AnnotationReceivedCount";k.Jah="PredictionRenderedCount";k.Iah="PredictionNotRenderedCount";k.D_d="EmptyPredictionResponseCount";k.$vh="SkippedPredictionResponseCount";k.$Kf="DelayedResponseCount";k.Ejk="NonEnglishSkipCount";k.Oqc="SignalGenerationTime";k.fPd="AnnotationReceivedTime";
k.cuf="AnnotationRenderedTime";k.auf="AnnotationNotRenderedTime";k.fSa=[k.rDk,k.sDk,k.Mwf,k.Qvh,k.Ovh,k.aLf,k.Qhl,k.buf,k.Jah,k.Iah,k.D_d,k.$vh,k.$Kf,k.Ejk];k.i4b=[k.modelId,k.configId,k.modelVersion];Object(K.a)(k,"DataFieldsPerSession",null,[])},652:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k{}k.language="Language";k.mTd="CharIndex";k.FIc="CharIndexRendered";k.amg="KeptCharCount";k.modelId="ModelId";k.Hah="PredictionLength";k.Kah="PredictionTokenCount";k.score="Score";k.status=
"Status";k.Q1e="TypedThroughCharCount";k.nP="WordIndex";k.modelVersion="ModelVersion";k.mBh="TimeTakenAugloop";k.Mrd="TimeToRender";k.configId="ConfigId";k.fSa=[k.mTd,k.FIc,k.amg,k.Hah,k.Kah,k.score,k.status,k.Q1e,k.nP,k.mBh,k.Mrd];k.i4b=[k.language,k.modelId,k.configId,k.modelVersion];Object(K.a)(k,"DataFieldsPerCandidate",null,[])},653:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k{constructor(){this.syncDeltaTimeout=this.disableSyncDeltaSending=this.isDeltaGeneratorEnabled=this.powerpoint=
this.downloadPolymerBaseUrl=this.inferenceServiceVersion=this.downloadBaseUrl=this.sessionCreationOptions=this.disabledServiceGroups=this.privateMode=this.flights=this.excelServer=this.initSession=this.sessionId=this.releaseFork=this.releaseCustomAudience=this.releaseChannel=this.releaseAudienceGroup=this.uiLanguage=this.appVersion=this.appName=this.serviceUrl=null}}Object(K.a)(k,"InitializeParameters",null,[])},654:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k{constructor(e){this.KGa=
!0;this.e2c=this.E9c=this.tad=this.f7c=null;this.hla=e}copy(){return new k(this.hla.copy())}move(e,n){this.KGa=!0;this.hla.move(e,n)}setOffsets(e){this.KGa=!0;this.hla.setOffsets(e)}Xf(){return this.hla.Xf()}get hc(){this.ftd();return this.f7c}get kc(){this.ftd();return this.tad}get Zb(){this.ftd();return this.E9c}get Xb(){this.ftd();return this.e2c}ftd(){if(this.KGa){var e=this.hla.points;this.f7c=this.E9c=e[0].x;this.tad=this.e2c=e[0].y;for(const n of e)this.f7c=Math.min(this.f7c,n.x),this.tad=
Math.min(this.tad,n.y),this.E9c=Math.max(this.E9c,n.x),this.e2c=Math.max(this.e2c,n.y);this.KGa=!1}}}Object(K.a)(k,"Boundary",null,[])},655:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k extends Sys.EventArgs{constructor(e){super();this.fG=e}}Object(K.a)(k,"SessionEndedEventArgs",Sys.EventArgs,[])},656:function(K,Z,d){d.d(Z,"a",function(){return e});K=d(0);var k=d(55);class e{constructor(n){this.Ing=this.errorType=0;this.originalText=this.token=null;this.uJa=this.Y$=this.lcid=0;this.OIh=
!1;this.Hjf=n}Die(){const n=this.token?this.token:null;return 0!==this.errorType&&e.Azj.contains(n,this.lcid)}static get Azj(){return e.uNa||(e.uNa=k.a.instance.resolve("Box4.Proofing.IIgnoreAllKeywords"))}}e.uNa=null;Object(K.a)(e,"ProofingErrorDetails",null,[288])},657:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);var k;(function(e){e[e.Load=0]="Load";e[e.Edit=1]="Edit"})(k||(k={}));Object(K.b)("UserAction",k)},658:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);Z=d(108);class k extends Z.a{constructor(){super();
this.Input=null;this.Lcid=0;this.UserActionType=this.PostContextText=this.PreContextText=null;this.ApplicationMode=0}$k(){return 4}static i_i(e,n){const r=new k;k.hJe(r,e,n);r.UserActionType=e.paragraphNode.TSb?"Edit":"Load";return r}static hJe(e,n,r){e.Lcid=n.range.lcid;e.Input=n.tna.substring(n.range.begin,n.range.end);e.ApplicationMode=r;0<=n.range.Y$&&(e.PreContextText=n.tna.substring(n.range.Y$,n.range.begin));0<=n.range.uJa&&(e.PostContextText=n.tna.substring(n.range.end,n.range.uJa))}static nhj(e,
n,r,v,C,w,z,A){const {SpellingRequestObjectUpdatedV2:u}=d(1098),{SpellingRequestObjectUpdated:E}=d(1099);return A?u.y3d(n,r):e?E.y3d(n,r,v,C,w,z):k.i_i(n,r)}}Object(K.a)(k,"SpellingRequestObject",Z.a,[])},659:function(K,Z,d){d.d(Z,"a",function(){return e});K=d(0);var k=d(79);class e{static Aqb(n,r,v="GenericCommentsTask"){v=new k.a(2,1,0,()=>{r()},92,v);n.Eb(v)}static vu(n){return Error.create("SDXHostAPI Error : "+n,{["SDXHostAPIErrorCode"]:n})}}Object(K.a)(e,"OfficeSharedCommentsUtils",null,[])},
660:function(K,Z,d){d.d(Z,"a",function(){return r});K=d(0);var k=d(382);Z=d(721);var e=d(1022),n=d(914);class r extends Z.a{constructor(v,C,w=null){super(v,C,w||e.a.instance,r.CCj)}static CCj(){n.a.sendTraceTag=r.w3k;n.a.debugAssertTag=r.hIi}static w3k(v,C,w,...z){k.ULS.sendTraceTag.apply(null,[v,204,r.dHi(C),w].concat(z))}static hIi(){}static dHi(v){switch(v){case 0:return 200;case 1:return 100;case 2:return 50;case 4:return 15;case 3:return 10;default:return 100}}}r.rKe="wdPreviousSession";r.MJf=
"wdUserSession";Object(K.a)(r,"CommonCrossDocumentMessenger",Z.a,[])},661:function(K,Z,d){d.d(Z,"a",function(){return n});K=d(0);var k=d(382),e=d(25);class n{static Q9d(r,v){let C=null;if(r&&0<r.length&&v&&0<v.length){const w=window[v];w?w&&r in w?C=w[r]:k.ULS.sendTraceTag(38605909,356,10,"Couldnt find survey json for survey "+r+" from dictionary "+v):k.ULS.sendTraceTag(38605910,356,10,"Couldnt find survey dictionary "+v)}return C}static lie(){const r=e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateLatestVersionIsEnabled",
!1);r?k.ULS.sendTraceTag(50668111,356,50,"Using floodgate latest version "):k.ULS.sendTraceTag(595342404,356,50,"Using floodgate stable version");return r}}Object(K.a)(n,"CommonUtils",null,[])},662:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k{constructor(e){this.type=null;this.type=e}}Object(K.a)(k,"CustomContentProps",null,[])},663:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);d=d(302);class k{}k.LabelText=d.a.labelText;k.LabelTextUserGeneratedPlaceholderReplacements=d.a.SWj;
k.Visible=d.a.visible;k.ImageIsVisible="ImageIsVisible";k.ImageUsesSpaceWhileInvisible="ImageUsesSpaceWhileInvisible";k.Image16by16Class=d.a.Exb;k.Image32by32Class=d.a.xEa;k.Image48by48Class=d.a.Mbe;k.ImageBackColor="ImageBackColor";k.On="On";k.SourceControlId="SourceControlId";Object(K.a)(k,"FlyoutAnchorCommandProperties",null,[])},664:function(K,Z,d){d.d(Z,"a",function(){return w});K=d(0);var k=d(263),e=d(25),n=d(359),r=d(197),v=d(95),C=d(63);class w{static m_a(z){let A,u;({irl:A,jrl:u}=w.nWi());
w.R0k(A,u,z)}static nWi(){({g7b:A}=n.a.ZNb(!e.AFrameworkApplication.zQ));var z=$get(k.CuiHelper.vxj);if(A)var A=document.getElementById(k.CuiHelper.Z0d);else A=z.childNodes[0],z=z.childNodes[1];return{irl:A,jrl:z}}static R0k(z,A,u){if(z&&A&&0<A.clientHeight){const E=-1!==A.parentNode.parentNode.className.indexOf("cui-ribbon");w.Zmh(z,A,u,E)}}static Zmh(z,A,u,E){let H=null,I=null,J=null,T=null,D=null,R=null,Q=null,W=null,O=null,Y=null,S=null,da=null,fa=null,ka=null,ha=null,F=null,na=null,ba=null,Ea=
null,La=null;({YOf:H,XOf:I,ZOf:J,P7a:T,Q7a:D,oRa:R,WS:Q,pv:W,pRa:O,jQ:Y,qRa:S,$Of:La}=w.ETf(z,H,I,J,T,D,R,Q,W,O,Y,S,La));({t2b:da,OG:fa,WOf:ka,UOf:ha,R7a:F,uub:na,vub:ba,VOf:Ea}=w.cUf(A,da,fa,ka,ha,F,na,ba,Ea));z=[H,I,J,T,D,R,Q,W,O,Y,S,ka,ha,F,na,ba,Ea,La];for(var ta of z)w.Afl(ta);ta=[H,I,J,D,Q,W,Y,S,ha,na,ba,Ea];for(const oa of ta)w.n2e(oa);w.tkh(I);w.Aph(fa,0);w.jRi(H,I,J,T,D,R,Q,W,O,Y,S,da,fa,ka,ha,F,na,ba,Ea,La,E,u);w.Yai(R,Q)}static U0k(z,A){w.Zmh(z,null,A,!1)}static Yai(z,A){z&&A&&(z.style.marginTop=
(A.offsetHeight-z.offsetHeight)/2+"px")}static ETf(z,A,u,E,H,I,J,T,D,R,Q,W,O){for(let Y=0;z&&Y<z.childNodes.length;Y++){const S=z.childNodes[Y],da=v.a.Ija(S),fa=!!S.id;-1!==da.indexOf("cui-QATRowLeft")?A=S:-1!==da.indexOf("cui-QATRowCenter")?u=S:-1!==da.indexOf("cui-QATRowRight")?E=S:-1!==da.indexOf("OfficeOnlineBrandBreadcrumbSeparator")?H=S:S.id===k.CuiHelper.rRd?I=S:S.id===k.CuiHelper.oVf?J=S:S.id===k.CuiHelper.sRd?T=S:S.id===k.CuiHelper.tRd?D=S:fa&&w.JKj(S)?R=S:-1!==da.indexOf("UsernameNameContainer")?
Q=S:-1!==da.indexOf("UsernameNameItem")?W=S:-1!==da.indexOf("FreemiumUpsellButton")&&(O=S);({YOf:A,XOf:u,ZOf:E,P7a:H,Q7a:I,oRa:J,WS:T,pv:D,pRa:R,jQ:Q,qRa:W,$Of:O}=w.ETf(S,A,u,E,H,I,J,T,D,R,Q,W,O))}return{YOf:A,XOf:u,ZOf:E,P7a:H,Q7a:I,oRa:J,WS:T,pv:D,pRa:R,jQ:Q,qRa:W,$Of:O}}static cUf(z,A,u,E,H,I,J,T,D){for(let R=0;z&&R<z.childNodes.length;R++){const Q=z.childNodes[R],W=v.a.Ija(Q),O=!!Q.id;-1!==W.indexOf("cui-jewel-container")?A=Q:-1!==W.indexOf("cui-tts")?u=Q:-1!==W.indexOf("cui-TabRowInline")?H=
Q:-1!==W.indexOf("cui-TabRowRight")?D=Q:-1!==W.indexOf("cui-separator")?E=Q:O&&Q.id.startsWith(k.CuiHelper.i7g)&&!I?I=Q:O&&Q.id.startsWith(k.CuiHelper.XSf)?J=Q:O&&Q.id.startsWith(k.CuiHelper.zIe)&&(T=Q);({t2b:A,OG:u,WOf:E,UOf:H,R7a:I,uub:J,vub:T,VOf:D}=w.cUf(Q,A,u,E,H,I,J,T,D))}return{t2b:A,OG:u,WOf:E,UOf:H,R7a:I,uub:J,vub:T,VOf:D}}static Q0k(z,A,u,E,H,I,J,T,D){w.zR(z,A,D)&&(w.hVc(A),w.zR(z,A,D)&&w.hVc(A));w.zR(A,E,D)&&(w.lL(u),w.lL(H),w.zR(A,E,D)&&(w.hVc(A),w.zR(A,E,D)&&(w.hVc(A),w.zR(A,E,D)&&w.lL(E))));
w.zR(E,T,D)&&(w.lL(u),w.lL(H));z=[I,J,T];w.K$f(E,T,z,D);w.K$f(A,T,z,D)}static K$f(z,A,u,E){let H=0;for(;H<u.length&&w.zR(z,A,E);)w.lL(u[H]),H++}static Cgj(z){if(!z)return 0;if(void 0===z._scaleStep||null===z._scaleStep){let A=0;-1!==z.className.indexOf("cui-tts-scale1")?A=1:-1!==z.className.indexOf("cui-tts-scale2")&&(A=2);z._scaleStep=A}return parseInt(z._scaleStep)}static hVc(z){let A=w.Cgj(z);2>A&&w.Aph(z,++A)}static Aph(z,A){z&&(z.className=w.CZk[A],z._scaleStep=A)}static zR(z,A,u){return z&&
A?C.a.Smg(C.a.ii(z),C.a.ii(A),u):!1}static TGb(z,A,u){let E=0;z&&A&&(E=C.a.hme(C.a.ii(z),C.a.ii(A),u));return E}static DVd(z){for(let A=0;z&&A<z.childNodes.length;A++)if(-1!==z.childNodes[A].className.indexOf("cui-cg"))return!0;return!1}static I5d(z){let A=null;for(let u=z.childNodes.length-1;z&&0<=u;u--){const E=z.childNodes[u];if(-1===E.className.indexOf("cui-cg"))break;A=E}return A}static XNb(z,A,u){if(z&&!w.an(z)){var E=r.a.Qt(z);E=v.a.oM(E.paddingLeft)+v.a.oM(E.paddingRight);u=z.offsetWidth-
u-E;let H=0;for(;A&&A!==z;)(E=r.a.Qt(A))&&(H+=v.a.oM(E.paddingLeft)+v.a.oM(E.paddingRight)),A=A.parentNode;u=Math.max(u,75+H);z.style.width=u+"px"}}static aXk(z,A,u){if(z&&A){let E=0,H=0;({left:E,top:H}=C.a.d_f(A,E,H));w.dik(z,u?E-z.offsetWidth:E+A.offsetWidth)}}static jRi(z,A,u,E,H,I,J,T,D,R,Q,W,O,Y,S,da,fa,ka,ha,F,na,ba){na&&w.Q0k(W,O,Y,S,da,fa,ka,ha,ba);w.DVd(O)?w.Z0k(O,z,A,u,E,H,I,J,T,D,R,Q,F,ba):w.Y0k(z,A,u,E,H,I,J,T,D,R,Q,F,ba)}static Y0k(z,A,u,E,H,I,J,T,D,R,Q,W,O){const Y=!!H,S=!!J,da=!!T;
let fa=0;if((S||da)&&0<(fa=w.TGb(z,A,O))){let ka=S;da&&(!S||T.offsetWidth>J.offsetWidth)&&(ka=!1);w.XNb(ka?J:T,ka?J:T,ka?fa:2*fa);S&&da&&0<(fa=w.TGb(z,A,O))&&w.XNb(ka?J:T,ka?J:T,ka?fa:2*fa)}if(S&&w.zR(J,A,O)||Y&&w.zR(H,A,O))w.lL(E),w.lL(H),w.lL(I),w.lL(J),da&&(w.n2e(A),w.n2e(T));w.Agh(A,u,T,D,R,Q,W,O);da&&w.CBf(T,z,u,O)}static Z0k(z,A,u,E,H,I,J,T,D,R,Q,W,O,Y){const S=!!T,da=!!D,fa=!!R,ka=!!O,ha=w.I5d(z);0<(A=w.TGb(A,ha,Y))&&(S&&w.XNb(T,T,A),!S||w.zR(T,ha,Y))&&(w.lL(H),w.lL(I),w.lL(J),w.lL(T));w.zR(z,
u,Y)&&w.aXk(u,z,Y);w.Agh(u,E,D,R,Q,W,O,Y);0<(A=w.TGb(z,E,Y))&&(w.XNb(Q,W,A),ka&&w.zR(z,E,Y)&&w.lL(O),fa&&w.zR(z,E,Y)&&w.lL(R));da&&!w.an(u)&&w.CBf(D,z,E,Y)}static Agh(z,A,u,E,H,I,J,T){const D=!!u,R=!!E,Q=!!H,W=!!J;let O=0;if((D||Q)&&0<(O=w.TGb(z,A,T))){const Y=!!z&&"absolute"!==z.style.position;let S=D;Q&&(!D||H.offsetWidth>u.offsetWidth)&&(S=!1);w.XNb(S?u:H,S?u:I,S&&Y?2*O:O);D&&Q?(0<(O=w.TGb(z,H,T))&&(S=!S,w.XNb(S?u:H,S?u:I,S&&Y?2*O:O)),w.zR(z,H,T)&&w.lL(z)):D&&w.zR(z,A,T)&&w.lL(z)}W&&w.zR(z,A,T)&&
w.lL(J);R&&w.zR(z,A,T)&&w.lL(E)}static an(z){if(!z)return!0;z=z._isHidden;return!(void 0===z||null===z||"0"===z)}static lL(z){z&&!w.an(z)&&(z.style.display="none",z._isHidden="1")}static Afl(z){z&&w.an(z)&&(z.style.display="",z._isHidden="0")}static n2e(z){z&&(z.style.width="auto",z.style.maxWidth="none")}static dik(z,A){z&&(z.style.position="absolute",z.style.left=A+"px")}static tkh(z){z&&(z.style.position="static",z.style.left="auto")}static CBf(z,A,u,E){if(z&&z.parentNode&&z.parentNode.parentNode){var H=
w.zzk(z);"auto"!==z.parentNode.style.width&&(z.style.width=z.parentNode.offsetWidth-H+"px");var I=E?u:A;A=E?A:u;u=C.a.ii(z.parentNode.parentNode);I=I?C.a.ii(I):new Sys.UI.Bounds(u.x,0,0,0);A=A?C.a.d9a(A):new Sys.UI.Point(u.x+u.width,0);"absolute"===z.parentNode.style.position?H=A.x-(I.x+I.width)-H-1:(u=C.a.ii(z.nextSibling?z.parentNode:z),u=u.x+u.width/2,H=2*Math.min(u-(I.x+I.width),A.x-u)-H-1);z.style.maxWidth=H+"px"}}static zzk(z){var A=r.a.Qt(z);A=A?v.a.oM(A.paddingLeft)+v.a.oM(A.paddingRight):
0;var u=r.a.Qt(z.parentNode);u=u?v.a.oM(u.paddingLeft)+v.a.oM(u.paddingRight):0;let E=0;for(;z.nextSibling;)z=z.nextSibling,E+=z.offsetWidth;return A+u+E}static JKj(z){return!!z.id&&(z.id.startsWith(k.CuiHelper.iVe)||z.id.startsWith(k.CuiHelper.Ekd))}}w.CZk=["cui-tts","cui-tts-scale-1","cui-tts-scale-2"];Object(K.a)(w,"RibbonTabScalingActor",null,[])},665:function(K,Z,d){d.d(Z,"a",function(){return z});K=d(0);var k=d(382),e=d(13),n=d(25),r=d(141),v=d(55),C=d(179),w=d(129);class z{constructor(){this.IOa=
null;this.wmf=!1}D1e(){try{this.IOa||(this.IOa=v.a.instance.resolve("Common.App.SearchCommon.ISearchOAuthManager"),this.wmf=!!n.AFrameworkApplication.fa&&n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.EnableOAuthMgrForService",!1))}catch(A){k.ULS.sendTraceTag(51689674,1300,10,"Unable to resolve ISearchOAuthManager: "+A)}}Vaj(){this.D1e();return this.IOa?this.IOa.getToken("Search",n.AFrameworkApplication.rne,!1):null}f5f(){if("Dev Box"===n.AFrameworkApplication.fa.Ha("StatusBarEnvironmentNameToUse")&&
void 0!==window.TellMeSubstrateTokenOverride&&null!==window.TellMeSubstrateTokenOverride)return new Promise(A=>{window.setTimeout(()=>{A(window.TellMeSubstrateTokenOverride)},750)});this.D1e();return this.IOa?this.IOa.getToken("Search",n.AFrameworkApplication.XYe,!0):null}ykj(){this.D1e();return this.IOa?this.IOa.getToken("Search",this.vkj(),this.wmf):null}vkj(){return n.AFrameworkApplication.fa.Ha("TellMeServiceAuthEndpointForSearch")}Waj(){return Object(e.a)(this,this.Vaj,"getLokiTokenPromise")}Gjj(){return Object(e.a)(this,
this.f5f,"getSubstrateTokenPromise")}QLb(){return!!n.AFrameworkApplication.Aa&&n.AFrameworkApplication.Aa.hb.QLb}klj(){const A={};this.QLb()&&(A.Loki=this.Waj(),A.Substrate=this.Gjj());return A}Dac(A){r.a.sKa(Object.assign(new C.a,{name:"Events",dataFields:[Object.assign(new w.a,{name:"Event",string:"StringsLoaded"}),Object.assign(new w.a,{name:"Status",bool:A})],durationMs:Math.round(window.performance.now())}),"TellMeWAC.")}PZj(){return n.AFrameworkApplication.fa.ka("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("tellme-strings").catch(()=>
{this.Dac(!1);return!1}).then(()=>{this.Dac(!0);return!0}):new Promise((A,u)=>{const E=v.a.instance.resolve("Common.IDynamicScriptLoaderProvider").Pw;E?E.loadScript("tellme-strings").then(()=>{this.Dac(!0);A(!0)}).catch(()=>{this.Dac(!1);u(!1)}):(this.Dac(!1),u(!1))})}static hSj(){return!!n.AFrameworkApplication.Aa&&(n.AFrameworkApplication.Aa.hb.s$b||n.AFrameworkApplication.Aa.hb.zzb)}static SZc(){return!!n.AFrameworkApplication.Aa&&n.AFrameworkApplication.Aa.hb.zzb}}Object(K.a)(z,"ReactSharedHeaderSearchUtils",
null,[])},666:function(K,Z,d){d.d(Z,"a",function(){return z});K=d(0);var k=d(382),e=d(45),n=d(929),r=d(27),v=d(42),C=d(75),w=d(31);class z{constructor(A=2E3){this.TNa=A}VJj(){const A=z.GW();return this.kVj(A)}kVj(A){return 0<this.jTc(A).mentionLength}getSelectedText(){const A=z.GW();return this.jTc(A)}jTc(A){return this.ahj(A)}ahj(A){var u=null;A&&A.lca&&v.SelectionEditor.Sg(A.Ua)&&v.SelectionEditor.wzb(A.Ua)&&(k.ULS.sendTraceTag(17944729,1303,50,"Selection was an insertion point, expanding to word"),
u=v.SelectionEditor.DRa(A.Ua,!1));u&&(A=u);if(!A)return Object.assign(new n.a,{neighborhood:"",mentionStart:0,mentionLength:0});const E=new Sys.StringBuilder;let H=u=0;const I=[],J=A.length;for(let D=0;D<J;D++){const R=A.ga(D);if(!w.ParagraphReader.Yd(R.node)||Array.contains(I,R.node.RLa))continue;I.push(R.node.RLa);let Q=w.ParagraphReader.text(R.node),W=0;var T=w.ParagraphReader.lta(R.node,!0,!0,!0);let O=w.ParagraphReader.lta(R.node,!1,!0,!0),Y=0;for(;Q.length<this.TNa&&(T||O);){if(!(Y%2)&&T){const S=
w.ParagraphReader.text(T);Q=S+" "+Q;W+=S.length+1;T=w.ParagraphReader.lta(T,!0,!0,!0)}1===Y%2&&O&&(Q=Q+" "+w.ParagraphReader.text(O),O=w.ParagraphReader.lta(O,!1,!0,!0));Y++}T=D===J-1;D||-1===R.Qa||(u=R.Qa);H+=T&&-1!==R.Nb?R.Nb:Q.length;E.append(Q);u+=W;H+=W;T||(E.append(" "),H++)}for(A=C.AParagraphNode.$jd(E.toString()," ");u<H&&e.a.Xy(A.charCodeAt(u));)u++;for(;H>u&&e.a.Xy(A.charCodeAt(H-1));)H--;return this.vbi(A,u,H)}vbi(A,u,E){if(A.length>this.TNa){var H=E-u;if(H>this.TNa)A=A.substr(u,this.TNa),
E=this.TNa,u=0;else{H=Math.max(u-Math.floor((this.TNa-H)/2),0);let I;I=Math.min(H+this.TNa,A.length);H=Math.max(I-this.TNa,0);u-=H;E-=H;A=A.substring(H,I)}}return Object.assign(new n.a,{neighborhood:A,mentionStart:u,mentionLength:E-u})}static GW(){var A=r.App.Kb.Jd.Cn;if(!A)return k.ULS.sendTraceTag(38548897,1303,50,"ContentView is null"),null;A=A.Lb;return A&&A.Pa&&A.Pa.length?A.Pa.mb:(k.ULS.sendTraceTag(38548898,1303,50,"SelectionManager or selectionCollection is null"),null)}}Object(K.a)(z,"Box4InsightsSelection",
null,[359,360])},667:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k{constructor(){this.style=this.formatting=null;this.languageId=0}}Object(K.a)(k,"NewOutlineElementInfo",null,[])},668:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k{}k.Mcd="Listening";k.$Fb="Warning";k.uYa="Error";Object(K.a)(k,"VoiceNotificationResourceStrings",null,[])},669:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k{}k.CoachButton="coachButton";k.MicButton="micButton";k.PrevButton=
"prevButton";k.NextButton="nextButton";k.GridButton="gridButton";k.InkButton="inkButton";k.SubtitlesButton="subButton";k.LiveButton="liveButton";k.MoreButton="moreButton";k.ExitButton="exitButton";Object(K.a)(k,"SlideshowToolbarButtonIDs",null,[])},670:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);d=d(440);class k extends d.a{constructor(e){super();this.shapeNode=e}get eig(){return!this.shapeNode||!this.shapeNode.isConnected}get id(){return this.shapeNode.id}get isConnected(){return this.shapeNode.isConnected}}
Object(K.a)(k,"InternalClipboardShape",d.a,[])},671:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);d=d(948);class k extends d.a{constructor(e,n,r){super(e,n);this.gwh=r}}Object(K.a)(k,"ClipServiceSlideCopyParams",d.a,[])},672:function(K,Z,d){d.d(Z,"a",function(){return e});K=d(0);var k=d(41);class e{constructor(n,r){this.Zeb=!1;this.czd=this.Umf=-1;this.Qw=n;r&&this.start()}start(){this.Zeb=!0;this.czd=-1;const n=k.a.YY();n&&(this.Umf=n)}stop(){this.Zeb=!1;const n=k.a.YY();n&&0<this.vaa&&
n>=this.vaa&&(this.czd=n-this.vaa)}get operation(){return this.Qw}get gNc(){return this.czd}get vaa(){return this.Umf}}Object(K.a)(e,"PPTStopwatch",null,[])},673:function(K,Z,d){d.d(Z,"a",function(){return C});K=d(0);var k=d(1194),e=d(38),n=d(37),r=d(61),v=d(41);class C{static gLc(w,z,A,u,E,H,I,J,T,D,R,Q,W,O,Y){H=Q.FQa(!1,w.cid,w.sid,0,z.shapeType,H,I,J,T,D+1);H.setValue(n.a.KK,z.$fa);({jsh:u,ash:O}=E.i4f(u,z,A,Y,W,O));W=W.Ld;H.setValue(e.a.nx,W.rf(Y.wM(u,A),0));H.setValue(e.a.wC,W.rf(Y.wM(O,A),1));
H.setValue(n.a.cPb,H.nx);H.setValue(n.a.rxb,H.wC);H.setValue(n.a.skd,!0);H.Bca=k.a.pJa(u,0);H.Aca=k.a.pJa(O,1);H.setValue(n.a.iRa,0);H.setValue(n.a.jRa,0);H.setValue(n.a.vUa,!0);H.setValue(n.a.isResizable,!0);H.setValue(n.a.vL,!0);H.UN=!0;H.pUa=!0;Y=(W=95===z.$fa||97===z.$fa)||Array.contains(C.lme,z.$fa);H.vL=!W;H.isResizable=!0;H.setValue(n.a.Vy,W);H.setValue(n.a.G_,95===z.$fa);H.jG=r.a.PE(w.sid,w.cid);H.hkb=H.get_shapeId();H.setValue(n.a.Uta,!0);w=E.qHf(u,O,A);H.NU=w;(R.wL(H)||R.Dka(H))&&v.a.Ib&&
(v.a.Ib.Nj=!0);Y?E.Rph(H):E.bqh(H);return H}}C.lme=[88,93,94,89,90,91,92];Object(K.a)(C,"InsertContentShapeNodeFactory",null,[])},674:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k{constructor(e,n,r,v){this.$fa=e;this.shapeType=n;this.height=r;this.width=v}}Object(K.a)(k,"AutoShapeProps",null,[])},675:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k extends Sys.EventArgs{constructor(){super()}}Object(K.a)(k,"SlidesChangedArgs",Sys.EventArgs,[])},676:function(K,Z,d){d.d(Z,
"a",function(){return e});d.d(Z,"b",function(){return n});var k=d(45);const e=r=>{r=btoa(r);r=r.replace(RegExp("\\+","g"),"-");r=r.replace(RegExp("\\/","g"),"_");return r=r.replace(RegExp("\\=+$","g"),"")},n=r=>{if(k.a.Wa(r))return null;const v=RegExp("%([0-9A-F]{2})","g");r=encodeURIComponent(r);let C="",w=0,z;for(;z=v.exec(r);){const A=v.lastIndex-3;A>w&&(C+=r.substring(w,A));C+=k.a.fromCharCode(parseInt(String("0x"+z[1])));w=v.lastIndex}w<r.length&&(C+=r.substring(w,r.length));return btoa(C)}},
677:function(K,Z,d){d.d(Z,"a",function(){return w});K=d(0);var k=d(25),e=d(174),n=d(91),r=d(13);Z=d(17);var v=d(26),C=d(66);class w{constructor(z,A,u,E,H,I,J,T,D,R,Q,W,O,Y){this.b5=this.Jl=this.wx=null;this.QAf=!0;this.nWa=z;this.Xdk=A;this.M6j=u;this.Ncc=E;this.H4=I;this.fc=J;this.Qd=T;this.Pf=D;this.Mdk=R;this.Fdb=Q;this.S9j=W;this.R9j=O;this.Q9j=Y;this.ZI=H}openDialog(){this.wCi();k.AFrameworkApplication.Aa.lhb();try{this.Jl.click()}catch(z){const A=String.format("UploadFrame::DoFileOpenDialog failed. Message: {0}. Stack: {1}",
z.message,z.stack);v.a.J(509727820,818,10,A);throw z;}}submit(){const z=this.Jl.files[0];this.b5=this.M6j();this.b5.VEe&&this.b5.VEe(this.H4,this.fc,this.Qd,this.Pf);if(this.Mdk)this.uBl(z);else{const A=new FormData;for(let E of this.b5.IOd)A.append(E.key,E.value);A.append("fileInputId",z,z.name);const u=new XMLHttpRequest;u.onreadystatechange=()=>{this.KGb(u)};u.open("POST",this.b5.R$g);u.send(A)}}KGb(z){if(4===z.readyState){const A=z.status;if(!A||A>=e.a.Ey&&A<e.a.vgi){if(this.b5.onSuccess)this.b5.onSuccess(z.responseText,
this.H4,this.fc,this.Qd,this.Pf,this.Jl)}else this.b5.oz&&this.b5.oz(z.responseText,this.H4,this.fc,this.Qd,this.Pf);this.dispose()}}uBl(z){this.Fdb().s1(this.Ncc,this.ZI,z.size,z,this.b5.IOd.ga("MediaToken"),this.Pf,this.S9j,this.R9j,this.Q9j,A=>{if(this.b5.onSuccess)this.b5.onSuccess(A.result,this.H4,this.fc,this.Qd,this.Pf,this.Jl)},A=>{this.b5.oz&&this.b5.oz(A.error.Code.toString(),this.H4,this.fc,this.Qd,this.Pf)})}dispose(){this.wx&&(n.a.removeHandler(this.Jl,"change",Object(r.a)(this,this.KOc,
"fileInputChange")),document.body.removeChild(this.wx),this.Jl=this.wx=null,w.q3e.remove(this))}wCi(){this.wx||(this.wx=document.createElement("form"),this.wx.id="uploadFormId",this.wx.style.visibility=C.a.hidden,this.wx.method="post",this.wx.encoding="multipart/form-data",this.wx.action="",this.Jl=document.createElement("input"),this.Jl.style.visibility=C.a.hidden,this.Jl.type="file",this.Jl.id="uploadFileInputId",this.Jl.name="uploadFileInputId",this.Jl.accept=this.nWa,this.wx.appendChild(this.Jl),
document.body.appendChild(this.wx),n.a.addHandler(this.Jl,"change",Object(r.a)(this,this.KOc,"fileInputChange")))}KOc(){this.Jl.value&&this.Jl.value.length?(this.QAf=!1,this.Xdk(this.Jl,this.Qd,this.Pf,this.Ncc).then(()=>{this.submit()}).catch(()=>{this.dispose()})):this.dispose()}static jXe(z,A,u,E,H,I,J,T,D,R,Q,W,O,Y){for(let S of w.q3e)S.QAf&&S.dispose();z=new w(z,A,u,E,H,I,J,T,D,R,Q,W,O,Y);w.q3e.add(z);z.openDialog()}}w.q3e=new Z.a;Object(K.a)(w,"UploadFileDialog",null,[])},698:function(K,Z,d){d.r(Z);
K=d(0);var k=d(382),e=d(189),n=d(924),r=d(1082),v=d(25),C=d(1081),w=d(13),z=d(1185),A=d(1186),u=d(27),E=d(461);class H extends E.a{constructor(ta,oa,wa,ra,ya,Da){super();this.init(ta);this.Nl("DummyClipboardOperation");this.AEa(v.AFrameworkApplication.Ta,oa,ra,ya,Da);this.zt=wa;this.Ep=8;this.EY()}run(){this.yNa=!0;this.ijb(this.zt);this.Ana();this.Ep=32}}Object(K.a)(H,"DummyClipboardOperation",E.a,[]);var I=d(95),J=d(126),T=d(117),D=d(59);class R{constructor(ta,oa,wa){k.ULS.shipAssertTag(6305502,
307,!!ta);this.properties=ta;this.ld=oa;this.Aqa=wa}get Wc(){return this.ld}F2f(){return this.properties.sa(D.a.FU,"")}Oah(){return!0}aDh(){let ta,oa=!1;ta=null;const wa=this.F2f();if(this.Aqa||""!==wa)try{({I7a:ta,returnValue:oa}=this.x1e(wa))}catch(ra){k.ULS.shipAssertTag(4203138,307,!1),this.Wc.Wb(J.a.vja,{["Reason"]:T.a.Zxf}),I.a.aCa(ta)}else k.ULS.sendTraceTag(3994443,307,50,"PastedHTMLString empty"),this.Wc.Wb(J.a.C1,{["Reason"]:T.a.Q0d});return{returnValue:oa,cKc:ta}}}Object(K.a)(R,"AStringInputImportStrategy",
null,[1147]);class Q extends R{constructor(ta,oa,wa,ra,ya){super(ta,oa,ya);this.hk=wa;this.uJd=ra}x1e(ta){const {ClipboardActor:oa}=d(698);let wa;if(this.Aqa&&!ta)return k.ULS.sendTraceTag(541172643,307,10,"No htmlDomContent and htmlClipboardDataContent"),{returnValue:!1,I7a:null};wa=null;if(this.Aqa)return wa=this.hk.UYa(ta),{returnValue:!0,I7a:wa};if(this.uJd){const ra=this.properties.sa(D.a.rIe,"");ra&&(wa=this.hk.UYa(ra))}wa||(k.ULS.sendTraceTag(520931392,307,15,"HtmlStringImportStrategy:: use of innerHtml because domContainer is null"),
wa=oa.l9g,wa.innerHTML=ta);return{returnValue:!0,I7a:wa}}}Object(K.a)(Q,"HtmlStringImportStrategy",R,[]);var W=d(45);class O extends R{constructor(ta,oa,wa){super(ta,oa,wa)}x1e(ta){let oa;if(this.Aqa&&!ta)return k.ULS.sendTraceTag(541172642,307,10,"No htmlDomContent"),{returnValue:!1,I7a:null};oa=document.createElement("div");ta=ta.split(RegExp("\r\n|\r|\n"));for(var wa=0;wa<ta.length-1;wa++){const ra=document.createElement("p");ra.innerText=this.ome(ta[wa]);oa.appendChild(ra)}wa=document.createElement("span");
wa.innerText=W.a.L_d(ta[ta.length-1]);oa.appendChild(wa);return{returnValue:!0,I7a:oa}}ome(ta){return W.a.L_d(ta.length?ta:" ")}}Object(K.a)(O,"MultiLineTextImportStrategy",R,[]);class Y extends O{constructor(ta,oa,wa){super(ta,oa,wa)}F2f(){return this.properties.sa(D.a.Pgb,"")}ome(ta){ta=super.ome(ta);return ta.length&&" "!==ta?ta:"\u00a0"}}Object(K.a)(Y,"MultiLinePlainTextImportStrategy",O,[]);class S extends R{constructor(ta,oa,wa){super(ta,oa,wa)}x1e(ta){var {ClipboardActor:oa}=d(698);if(this.Aqa&&
!ta)return k.ULS.sendTraceTag(541172641,307,10,"No htmlDomContent"),{returnValue:!1,I7a:null};oa=oa.l9g;oa.innerText=ta;return{returnValue:!0,I7a:oa}}}Object(K.a)(S,"PlainTextImportStrategy",R,[]);var da=d(383);class fa{constructor(ta){this.gg=this.Jje=!1;this.BZ=ta}Oah(){this.Jje||(this.Jje=!0,this.gg=!1,this.BZ.prepareForPaste(()=>{this.gg=!0}));return this.gg}aDh(){let ta;this.Jje=!1;ta=this.BZ.paste();return ta?ta.hasChildNodes()?{returnValue:!0,cKc:ta}:(k.ULS.sendTraceTag(7891019,307,50,"DOM innerText empty."),
fa.Wc.Wb(J.a.C1,{["Reason"]:T.a.Q0d}),{returnValue:!1,cKc:ta}):(k.ULS.sendTraceTag(6305676,307,50,"SystemClipboard didn't paste"),fa.Wc.Wb(J.a.l8a,{["Reason"]:T.a.CZe}),{returnValue:!1,cKc:ta})}static get Wc(){return da.a.instance}}Object(K.a)(fa,"SystemClipboardImportStrategy",null,[1147]);var ka=d(62),ha=d(36),F=d(49),na=d(39),ba=d(32),Ea=d(258);d.d(Z,"ClipboardActor",function(){return La});class La{constructor(ta,oa,wa,ra,ya,Da,pa,la){this.C6e=null;this.vTb=0;this.TNh=ta;this.BZ=oa;this.ld=wa;
this.hk=ra;this.Tc=ya;this.Ca=Da;this.Us=pa;this.bef=!!la&&la.ka("SupportImageDragDropExternalIsEnabled");this.IJd=!!la&&la.ka("ShowKeepSourceFormattingOnPasteFloatieIsEnabled");this.XM=new Ea.a;this.XM.$(ba.a.paste,257);this.XM.$(ba.a.nxa,8449);this.XM.$(ba.a.Cra,1);this.XM.$(ba.a.kdg,513);this.XM.$(ba.a.reformatPastedContent,4097);this.XM.$(ba.a.Ajd,12289);this.XM.$(ba.a.hgd,7);this.XM.$(ba.a.ggd,1);this.XM.$(ba.a.f9g,8193);this.XM.$(ba.a.copy,272);this.XM.$(ba.a.uHc,16);this.XM.$(ba.a.cut,304);
this.XM.$(ba.a.$Yb,48);this.XM.$(ba.a.fcd,64);this.XM.$(ba.a.gcd,64);this.XM.$(ba.a.showPlaceholderGlossary,65536);this.bef&&this.XM.$(ba.a.VNf,1)}get PDf(){return this.TNh.value}get wA(){return this.BZ}vb(){this.Ca.ra(ba.a.nHk,na.a.application,Object(w.a)(this,this.Yhd,"queryPasteOptions"),97);this.Ca.ra(ba.a.oHk,na.a.application,Object(w.a)(this,this.Yhd,"queryPasteOptions"),97);this.IJd?this.Ca.ra(ba.a.Vch,na.a.application,Object(w.a)(this,this.jMe,"queryReformatPasteOptions"),97):this.Ca.ra(ba.a.Wch,
na.a.application,Object(w.a)(this,this.jMe,"queryReformatPasteOptions"),97);this.Ca.ra(ba.a.Xch,na.a.application,Object(w.a)(this,this.jMe,"queryReformatPasteOptions"),97);this.Ca.WV(ba.a.$Yb,na.a.view,Object(w.a)(this,this.mW,"clipboardAction"),1028);this.Ca.WV(ba.a.cut,na.a.view,Object(w.a)(this,this.mW,"clipboardAction"),1028);this.Ca.vBa(ba.a.uHc,na.a.view,Object(w.a)(this,this.mW,"clipboardAction"));this.Ca.vBa(ba.a.copy,na.a.view,Object(w.a)(this,this.mW,"clipboardAction"));this.bef&&this.Ca.WV(ba.a.VNf,
na.a.view,Object(w.a)(this,this.$Ni,"dropBrowserContent"),1028);this.Ca.WV(ba.a.Cra,na.a.view,Object(w.a)(this,this.mW,"clipboardAction"),1028);this.Ca.WV(ba.a.paste,na.a.view,Object(w.a)(this,this.mW,"clipboardAction"),1028);this.Ca.WV(ba.a.nxa,na.a.view,Object(w.a)(this,this.mW,"clipboardAction"),1028);this.Ca.WV(ba.a.f9g,na.a.view,Object(w.a)(this,this.mW,"clipboardAction"),1028);this.Ca.WV(ba.a.ggd,na.a.view,Object(w.a)(this,this.mW,"clipboardAction"),1028);this.Ca.WV(ba.a.hgd,na.a.view,Object(w.a)(this,
this.mW,"clipboardAction"),1028);this.Ca.WV(ba.a.reformatPastedContent,na.a.view,Object(w.a)(this,this.mW,"clipboardAction"),1028);this.Ca.WV(ba.a.Ajd,na.a.view,Object(w.a)(this,this.mW,"clipboardAction"),1028);this.Ca.ya(ba.a.Kkd,na.a.view,e.ActionManager.Jg);this.Ca.ya(ba.a.czk,na.a.view,e.ActionManager.Jg);this.Ca.ya(ba.a.x9g,na.a.view,e.ActionManager.Jg);this.Ca.ya(ba.a.y9g,na.a.view,e.ActionManager.Jg);this.Ca.ya(ba.a.z9g,na.a.view,e.ActionManager.Jg);this.Ca.ya(ba.a.w9g,na.a.view,e.ActionManager.Jg);
this.Ca.vBa(ba.a.fcd,na.a.view,Object(w.a)(this,this.mW,"clipboardAction"));this.Ca.vBa(ba.a.gcd,na.a.view,Object(w.a)(this,this.gcd,"moveSelectedContentWithinCurrentParagraph"));this.Ca.vBa(ba.a.kdg,na.a.view,Object(w.a)(this,this.mW,"clipboardAction"));this.Ca.vBa(ba.a.showPlaceholderGlossary,na.a.view,Object(w.a)(this,this.mW,"clipboardAction"));this.Ca.ya(ba.a.xJf,na.a.view,e.ActionManager.Jg);this.Ca.ya(ba.a.YJf,na.a.view,e.ActionManager.Jg)}Yhd(ta,oa,wa,ra,ya){if(1===wa)return 32;ya[n.a.On]=
!1;return 32}$Ni(ta,oa,wa,ra,ya,Da){k.ULS.sendTraceTag(42530335,307,50,"Drag and drop browser content");var pa=Da.DataTransfer;Da=pa.getData("text/html");pa=pa.getData("text/plain");let la=!1;const Fa=new r.DictionaryPropertySet;0<Da.length?(k.ULS.sendTraceTag(42530336,307,50,"Drag and drop browser content with HTML"),Fa.setValue(D.a.FU,Da),la=!0):0<pa.length&&(k.ULS.sendTraceTag(42530337,307,50,"Drag and drop browser content with plain text"),Fa.setValue(D.a.Pgb,pa),la=!0);if(la){const Qa=this.XM.ga(oa);
return this.PDf.create(ta,oa,Qa,new z.a(()=>this.SLf(Qa,Fa)),wa,ra,ya,Fa)}return null}jMe(ta,oa,wa,ra,ya){if(oa=Object(A.a)(Object,ya))v.AFrameworkApplication.fk("Microsoft.Office.Web.SessionSettings.IWacWordShowKeepSourceFormattingOnPasteFloatieSettings"),!this.IJd&&ta===ba.a.Wch||this.IJd&&ta===ba.a.Vch?(ta=this.vTb!==ba.a.reformatPastedContent&&this.vTb!==ba.a.Ajd,oa[n.a.On]=this.vTb===ba.a.reformatPastedContent||ta):ta===ba.a.Xch&&(oa[n.a.On]=this.vTb===ba.a.Ajd);return 32}mW(ta,oa,wa,ra,ya,Da){if((v.AFrameworkApplication.yR||
v.AFrameworkApplication.EJ)&&!v.AFrameworkApplication.tRa||ha.a.instance.ga(83))return new H(ta,oa,wa,ra,ya,Da);const pa=this.XM.ga(oa);1!==ra&&pa&1&&(this.vTb=oa);1!==ra&&Da&&pa&1&&(this.C6e=Da);1!==ra&&!Da&&pa&4096&&(Da=this.C6e);return this.PDf.create(ta,oa,pa,new z.a(()=>this.SLf(pa,Da)),wa,ra,ya,Da)}gcd(ta,oa,wa,ra,ya,Da){Da=F.a.Kj(ka.a.instance.Pa.mb.Ua.node,Da);return this.mW(ta,oa,wa,ra,ya,Da)}SLf(ta,oa){return ta&256?new fa(this.wA):ta&2?ta&4096?new Q(oa,this.ld,this.hk,u.App.instance.d9b,
u.App.instance.NLb):new S(oa,this.ld,u.App.instance.NLb):oa.Sa(D.a.Pgb)?new Y(oa,this.ld,u.App.instance.NLb):new Q(oa,this.ld,this.hk,u.App.instance.d9b,u.App.instance.NLb)}static get l9g(){return C.a.F9a("Box4PasteScratchPad")}}Object(K.a)(La,"ClipboardActor",null,[])},705:function(K,Z,d){K=d(0);var k=d(17),e=d(13),n=d(395),r=d(396);class v{constructor(E,H,I,J=0,T=0,D=null,R=null){this.commandId=E;this.controlId=H;this.timeStamp=I;this.commandSurface=n.a[J];this.vv=r.a[T];this.contentType=D;this.prd=
R}}Object(K.a)(v,"CommandActionInfo",null,[]);class C{constructor(){this.KLh=RegExp("(Close|TabSwitch|((Populate|Query|Report|Show|BrowserFocus).+)|(.+(Rendered|Seen|Scroll)))")}zVj(E){return!this.KLh.exec(E)}}Object(K.a)(C,"EventsCacheLoggingUtils",null,[]);var w=d(25),z=d(1105),A=d(751);d.d(Z,"a",function(){return u});class u{constructor(){this.$ff=null;this.EEd=20;this.Bxc=this.Z1a=this.xQb=null}init(){this.$ff=new C;this.xQb=new k.a;this.Z1a=new k.a;this.Bxc=new k.a;this.EEd=w.AFrameworkApplication.fa.Fc("MaxCommandClickedEventQueueSize",
20);z.a.$8h(Object(e.a)(this,this.uui,"commandClickEventRaised"));A.a.instance.csf(Object(e.a)(this,this.sMk,"recordActionEvent"))}W0e(E){E.count>this.EEd&&E.removeAt(this.EEd)}uui(E,H){this.xQb.insert(0,new v(H.commandId,H.controlId,H.time,H.commandSurface,H.vv,H.contentType));this.W0e(this.xQb)}sMk(E,H){this.Z1a.insert(0,new v(H.actionName,H.controlId,H.timeStamp,H.commandSurface,H.vv,H.contentType,H.prd));this.W0e(this.Z1a);this.$ff.zVj(H.actionName)&&(this.Bxc.insert(0,new v(H.actionName,H.controlId,
H.timeStamp,H.commandSurface,H.vv,H.contentType,H.prd)),this.W0e(this.Bxc))}static get instance(){return u.Ka||(u.Ka=new u)}}u.Ka=null;Object(K.a)(u,"CommandClickEventsCache",null,[])},707:function(K,Z,d){d.r(Z);K=d(0);var k=d(712),e=d(25),n=d(45),r=d(54),v=d(104),C=d(1187),w=d(1188),z=d(22),A=d(328);const u=(O,Y)=>{if(O){O=O.trim().toLowerCase();if("true"===O)return!0;if("false"===O)return!1}return Y};var E=d(724),H=d(26),I=d(947),J;(function(O){O[O.none=0]="none";O[O.internal=1]="internal";O[O.clipService=
2]="clipService"})(J||(J={}));Object(K.b)("ClipboardIframeContent",J);var T=d(381),D=d(670),R=d(441),Q=d(46);d.d(Z,"ClipboardHelper",function(){return W});class W{constructor(O,Y,S,da,fa,ka){this.z4j=[A.a.qW,A.a.Gp,A.a.location,A.a.mD,A.a.type,A.a.rEe,A.a.count,A.a.XEa,A.a.VEa,A.a.Jjb,A.a.slideId,A.a.sessionId,A.a.timeStamp,A.a.ty];this.Hye=new k.a;this.$xe=new C.a(w.a.jp());this.Hq=O;this.msg=Y;this.Bc=ka;if(S&&0<S.length){O=S.split(";");for(const ha of O)O=this.W1f(ha),0<O.length&&this.Hye.add(O)}this.A4j=
da;this.Ove=fa;if(this.vZc()){da=e.AFrameworkApplication.fa.Ha("PicklingAPIMaxPackageSizeInMB").split(";");for(const ha of da)da=ha.split(":"),2===da.length&&0<da[0].length&&0<da[1].length&&this.$xe.add(da[0],parseInt(da[1]))}}Kud(O,Y,S,da,fa,ka,ha){if(O.contentWindow&&O.contentWindow.document&&O.contentWindow.document.body){Q.a.WIc(O);const na=Q.a.nca();var F=document.createTextNode(Q.a.QDe);na.appendChild(F);F=null;let ba=0;if(!Y)H.a.J(512329178,826,50,"ClipboardHelper::WriteClipboardObjectsToClipboardTarget: internalClipboardObjects is empty for ccpCorrId: {0}",
ha),Sys.UI.DomElement.addCssClass(na,Q.a.B_d);else if(Y.length&&Y[0]&&Y[0].K6a&&(Sys.UI.DomElement.addCssClass(na,this.Hq.Uq[0].K6a),ba=1,S)){n.a.Wa(S.mD)&&H.a.J(512329177,307,10,"ClipboardHelper::WriteClipboardObjectsToClipboardTarget: DC was empty for the given ccpid: {0}",S.Gp);ba=2;Y=E.a(S.dataType);na.setAttribute(A.a.qW,S.qW);na.setAttribute(A.a.uQa,S.uQa);na.setAttribute(A.a.Gp,S.Gp);na.setAttribute(A.a.version,S.version);na.setAttribute(A.a.location,S.location);na.setAttribute(A.a.mD,S.mD);
na.setAttribute(A.a.type,Y);na.setAttribute(A.a.count,S.objectCount.toString());na.setAttribute(A.a.XEa,S.XEa);na.setAttribute(A.a.VEa,S.VEa);na.setAttribute(A.a.ty,S.ty);const Ea=(new Date).toUTCString();H.a.J(512329176,307,50,"ClipboardHelper::WriteClipboardObjectsToClipboardTarget: A {0} cut/copy:{1} was performed at UTC Time: {2}",Y,S.XEa,Ea);na.setAttribute(A.a.timeStamp,Ea);if(1===S.dataType||2===S.dataType)Y=String.format("{0}GetClipboardBytes.ashx",e.AFrameworkApplication.fa.Ha("361"))+"?Id="+
n.a.Ke(S.Gp)+"&DC="+n.a.Ke(S.mD)+"&pkey="+n.a.Ke(S.ty)+"&wdwaccluster="+n.a.Ke(S.mD)+"&DataType="+Y,na.setAttribute(A.a.Vsi,Y);S.Ric&&na.setAttribute(A.a.rEe,this.H3k(S.Ric));1===S.dataType&&this.Ove&&(F=Q.a.eC(),F.id=A.a.mbg,F.setAttribute(A.a.rAj,"true"),S=String.format("{0}GetClipboardImage.ashx",e.AFrameworkApplication.fa.Ha("361"))+"?Id="+n.a.Ke(S.Gp)+"&DC="+n.a.Ke(S.mD)+"&pkey="+n.a.Ke(S.ty)+"&wdwaccluster="+n.a.Ke(S.mD),F.src=S)}na.setAttribute(A.a.sessionId,da);na.setAttribute(A.a.Jjb,fa?
fa.join(","):"");ka?na.setAttribute(A.a.slideId,ka.cid.toString()+"+"+ka.sid.toString()):na.setAttribute(A.a.slideId,"");O.contentWindow.document.body.appendChild(na);F&&O.contentWindow.document.body.appendChild(F);this.Bc.Yh(T.a.Vzi,J[ba],ha)}}bQj(O){var Y="";r.a.Uj?Y="Chromium":r.a.fg?Y="Firefox":r.a.Z9b&&(Y="Safari");Y=this.$xe.Hb(Y)?this.$xe.ga(Y):0;(Y=Math.ceil(O)<=Y)||H.a.J(512329175,307,15,"Package size exceeds for pickling paste browser:{0}, size:{1}",r.a.Ly,O);return Y}QKj(O){return O&&Sys.UI.DomElement.containsCssClass(O,
Q.a.B_d)?!0:!1}TKj(O){return!!O&&!!O.getAttribute&&u(O.getAttribute(A.a.VEa),!1)}oVj(O){return!!O&&!!O.tn&&!!O.tn.firstChild&&!!O.tn.firstChild.className&&this.pVj(O.tn.firstChild.className)}pVj(O){return!!O&&O.startsWith("CID")&&v.a.isValid(O.substring(3,O.length))}fVj(O){return!!O&&!!O.Gp&&!!O.mD&&0!==O.dataType&&0<O.objectCount&&!!O.ty}Zcl(O){if(!this.eHj(O))return H.a.J(512329174,307,50,"DC '{0}' is not allowed",O.mD),!1;if(O.Dsa&&"TimeStamp"in O.Dsa){var Y=new Date(Date.parse(O.Dsa.TimeStamp));
O=60*this.A4j-5;Y=W.lAf(Y);if(Y>=O)return H.a.J(512329173,307,50,"The data copied expired: expireTime: '{0}', elapsedTime: '{1}'.",O,Y),!1}return!0}W1f(O){return O?O.trim().toUpperCase():""}eHj(O){return!this.Ghe(O)||this.Hye.contains(this.W1f(O.mD))||this.Hye.contains("ALL")}xeg(O){return!!O&&!!O.OW&&!!O.OW.length&&!!O.OW[0]}yeg(O){return this.xeg(O)&&Object(z.a)(R.a,O.OW[0])}YHj(O){return this.xeg(O)&&Object(z.a)(D.a,O.OW[0])}fhe(O){return!!O&&!!O.uu&&this.Zcl(O.uu)}XHj(O){return this.fhe(O)&&1===
O.uu.dataType}WHj(O){return this.fhe(O)&&2===O.uu.dataType}VHj(O){return this.fhe(O)&&3===O.uu.dataType}ZHj(O){return!!O&&!!O.qM}$Hj(O){return this.ZHj(O)&&1===O.qM.contentType}vZc(){return!(r.a.hx||r.a.Z9b)&&e.AFrameworkApplication.fa.ka("PicklingAPISlidePasteEnabled")}cti(O,Y){if(O&&Y&&O.getAttribute)for(const S of this.z4j){const da=O.getAttribute(S);da&&Y.setAttribute(S,da)}}Ghe(O){if(O.mD!==this.msg)return H.a.J(512329172,307,50,String.format("IsCrossDCPaste: It's a cross-dc paste '{0}': from '{1}' to '{2}', {3}.",
E.a(O.dataType),O.mD,this.msg,O.Gp)),!0;H.a.J(512329171,307,50,String.format("IsCrossDCPaste: It's a paste '{0}' in '{1}', {2}.",E.a(O.dataType),O.mD,O.Gp));return!1}sTi(O,Y){var S=O.getAttribute(A.a.Gp),da=parseInt(O.getAttribute(A.a.version)),fa=O.getAttribute(A.a.ty),ka=parseInt(O.getAttribute(A.a.qW)),ha=parseInt(O.getAttribute(A.a.uQa)),F=O.getAttribute(A.a.type);F=F?E.b(F):2;var na=Object,ba=na.assign,Ea=new I.a;ka=isNaN(ka)?32:ka;ha=isNaN(ha)?0:ha;da=isNaN(da)?0:da;var La=O.getAttribute(A.a.location),
ta=O.getAttribute(A.a.mD),oa=O.getAttribute(A.a.count);oa=parseInt(oa);S=ba.call(na,Ea,{qW:ka,uQa:ha,Gp:S,version:da,location:La,mD:ta,dataType:F,objectCount:isNaN(oa)?-1:oa,XEa:u(O.getAttribute(A.a.XEa),!1),VEa:u(O.getAttribute(A.a.VEa),!1),ty:fa});fa=W.zTi(O);F=W.DTi(O);S.Dsa={["SessionId"]:fa,["TimeStamp"]:F?F.toUTCString():""};Y=W.BRd(S,F,this.Bc,Y);H.a.J(512329170,307,50,"ExtractClipboardObjectFromClipboard: {0}",Y);if(O=O.getAttribute(A.a.rEe))S.Ric=this.bKi(O);return S}H3k(O){return JSON.stringify(O)}bKi(O){try{return JSON.parse(O)}catch(Y){return H.a.J(512329169,
826,15,"{0} when parse json string: {1}",Y.toString(),O),null}}static Peg(O){return O&&O.Dsa&&"SessionId"in O.Dsa?W.Gjg(O.Dsa.SessionId.toString()):!1}static Gjg(O){return n.a.Wa(O)||n.a.Wa(e.AFrameworkApplication.userSessionId)?!1:e.AFrameworkApplication.userSessionId.toLowerCase()===O.toLowerCase()}static BRd(O,Y,S,da){const fa=E.a(O.dataType);O=String.format("A {0} ClipServiceObject was just created: '{1}'",fa,O);Y&&(Y=W.lAf(Y),O+=String.format(", time elapsed between COPY and PASTE: {0} seconds.",
Y),S.Yh("CopyPasteElapsedSec",Y.toString(),da));return O}static zTi(O){O=O.getAttribute(A.a.sessionId);return void 0===O||null===O?"":O}static DTi(O){O=O.getAttribute(A.a.timeStamp);return void 0===O||null===O?null:new Date(Date.parse(O))}static lAf(O){var Y=new Date;if(!O)throw Error.argumentNull("fromTime");if(!Y)throw Error.argumentNull("toTime");return(Y.getTime()-O.getTime())/1E3}}Object(K.a)(W,"ClipboardHelper",null,[327])},721:function(K,Z,d){K=d(0);var k=d(13),e=d(25),n=d(78),r=d(54),v=d(45),
C=d(104);class w{constructor(I,J){this.message=I;this.Yi=J}}Object(K.a)(w,"CrossDocumentEventArgs",null,[]);var z=d(524),A=d(173),u=d(566),E=d(914);d.d(Z,"a",function(){return H});class H{constructor(I,J,T,D){this._name="";this.qMa={};this.Cgf=null;this.fVb=[];this.WRb=[];this.XRb=[];this.tUb=[];this.ynf=I;this.xnf=J;this.Y6={};this.hba={};this.cUb=T;H._id++;D&&D();this.tG=this.enable()}get sLa(){return this.xnf}get gAh(){return this.ynf}enable(){if(!u.a())return E.a.sendTraceTag(5018251,2,"Not supported for current browser."),
!1;this.HFj();E.a.sendTraceTag(5018252,2,"Enabled.");return!0}isEnabled(){return this.tG}HFj(){E.a.debugAssertTag(5018253,!!this.cUb,null);this.Cgf=Object(k.a)(this,this.nhk,"messageListener");this.cUb.yfi(this.Cgf)}disable(){this.tG=!1;this.fVb=[];this.WRb=[];this.XRb=[];this.tUb=[];this.ynf=null;this.xnf="";this.cUb.xKi();this.Y6={};this.hba={}}dispose(){this.disable()}$ie(I){return!!this.fVb&&Array.contains(this.fVb,I)||this.Ohg(I)}Ohg(I){return!!this.WRb&&Array.contains(this.WRb,I)}pu(I){E.a.debugAssertTag(5018259,
!!this.fVb,null);Array.add(this.fVb,I);E.a.sendTraceTag(5018260,2,"Allow receiving : {0}",I)}Qpf(I){E.a.debugAssertTag(5018261,!!this.WRb,null);Array.add(this.WRb,I);E.a.sendTraceTag(5018262,2,"Allow free receiving: {0}",I)}kOj(I){return!!this.XRb&&Array.contains(this.XRb,I)}Rpf(I){E.a.debugAssertTag(5018263,!!this.XRb,null);Array.add(this.XRb,I);E.a.sendTraceTag(5018264,2,"Allow free sending: {0}",I)}y9b(I){I=n.a.pQ(I);return!!I&&!!this.tUb&&Array.contains(this.tUb,I)}uBa(I){E.a.debugAssertTag(5018265,
!!this.tUb,null);if(I===H.jYb)return E.a.debugAssertTag(5018266,!1,null),!1;let J=n.a.pQ(I);if(!J)return E.a.sendTraceTag(5018267,4,"Get origin fail:{0}",I),!1;e.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.NormalizePostMessageOrigin")&&(J=v.a.og(J));Array.add(this.tUb,J);E.a.sendTraceTag(5018268,2,"Add origin:{0}",J);return!0}send(I,J=null){let T=this.sLa;if(J){J=n.a.pQ(J);if(!J)return!1;T=J}return this.$ib(I,this.gAh,T)}sendMessage(I,J,T=""){T=T&&""!==T?
T:C.a.create().toString();return this.send(this.MHe(I,J,T,e.AFrameworkApplication.userSessionId))}postMessage(I){const J=C.a.create().toString();if(!e.AFrameworkApplication.fa.ka("RetryablePostMessagingIsEnabled")||!I.shouldRetry)return this.send(this.MHe(I.messageId,I.values,J,I.userSessionId));if(!this.Y6[I.KEc]){this.pu(I.KEc);const T=Object(k.a)(this,this.ackMessageHandler,"ackMessageHandler");this.zB(I.KEc,T)}this.qMa[J]="";return this.V$g(I,J,1)}V$g(I,J,T){if(""!==J&&J in this.qMa&&"ACK_RECEIVED"===
this.qMa[J])return delete this.qMa[J],!0;if(T>I.Ewa)return E.a.sendTraceTag(40716250,4,'No retries remaining. {{"MessageId":{0}, "CorrelationId":{1}}}',I.KEc,J),delete this.qMa[J],!1;E.a.sendTraceTag(40716251,1<T?4:2,'Sending postmessage. Attempts remaining {0}. {{"MessageId":{1}, "CorrelationId":{2}}}',I.Ewa-T,I.messageId,J);T++;window.setTimeout(()=>{this.V$g(I,J,T)},I.b3h);I.values[A.a.a3h]=!0;return this.send(this.MHe(I.messageId,I.values,J,I.userSessionId))}ackMessageHandler(I){I=I.CorrelationId;
""!==I&&I in this.qMa&&(E.a.sendTraceTag(42783044,2,"Received Ack for Message {0} CorrelationId: {1}",this.qMa[I],I),this.qMa[I]="ACK_RECEIVED")}MHe(I,J,T,D){I=new z.a(I);I.CorrelationId=T;J&&(I.Values=J);I.Values.wdUserSession=D;return I}$ib(I,J,T){E.a.debugAssertTag(5018269,!!I,null);if(!this.tG)return!1;E.a.debugAssertTag(5018270,!!J,null);E.a.debugAssertTag(5018271,!!T,null);if(!J||!T)return E.a.debugAssertTag(5018272,!1,null),!1;if(T===H.jYb&&!this.kOj(I.MessageId))return E.a.sendTraceTag(5018273,
1,"Got unregistered message {0}",{["id"]:I.MessageId}),!1;I.SendTime=(new Date).getTime();let D="";try{D=Sys.Serialization.JavaScriptSerializer.serialize(I)}catch(R){return E.a.sendTraceTag(5018274,4,"JSON Ser failed {0}",{["Exception"]:R.message}),!1}J=H.sendMessage(J,D,T);E.a.sendTraceTag(5018275,2,"Send {0}. {1}",J?"succeeded":"failed",{["id"]:I.MessageId,["origin"]:T});return J}zB(I,J){E.a.debugAssertTag(5018304,!!J,null);E.a.debugAssertTag(5018305,!!this.Y6&&!!this.hba,null);this.tG&&(this.$ie(I)?
this.Y6[I]!==J&&(E.a.debugAssertTag(5018307,!this.Y6[I]&&!this.hba[I],null),this.Y6[I]=J,delete this.hba[I]):E.a.sendTraceTag(5018306,2,"Not allow receiving {0}",{["id"]:I}))}KZa(I,J){E.a.debugAssertTag(40420062,!!J,null);E.a.debugAssertTag(40420063,!!this.hba&&!!this.Y6,null);this.tG&&(this.$ie(I)?this.hba[I]!==J&&(E.a.debugAssertTag(40420065,!this.Y6[I]&&!this.hba[I],null),this.hba[I]=J,delete this.Y6[I]):E.a.sendTraceTag(40420064,2,"Not allow receiving {0}",{["id"]:I}))}lwl(I){this.tG&&(this.Y6[I]&&
delete this.Y6[I],this.hba[I]&&delete this.hba[I])}nhk(I){const J=this.vbj(I);if(!J)return!1;if(this.Y6[J.MessageId])return this.cUb.iXc(this.Y6[J.MessageId],J),!0;if(this.hba[J.MessageId]){let T=this.hba[J.MessageId];I=new w(J,I);this.cUb.qGj(T,I);return!0}return!1}vbj(I){const J=new Date;this.W1j(I);if(!I.origin||!I.source||void 0===I.data||null===I.data)return E.a.sendTraceTag(5018308,4,"eventArgs missing required properties."),null;const T=this.nWj(I.data);if(!T)return null;if(!this.y9b(I.origin)){if(!this.Ohg(T.MessageId))return E.a.sendTraceTag(5018309,
1,"{0}",{["id"]:T.MessageId}),null;if(!r.a.wab&&I.source!==this.gAh)return E.a.sendTraceTag(5018310,4,"Received message came from a source other than the parent window."),null}E.a.debugAssertTag(5018311,!!T.Values,null);T.Values.m_Source=I.source;T.Values.m_Origin=I.origin;T.Values.m_ReceivedTime=J.getTime();return T}nWj(I){if(!I)return null;let J=null;try{J=Sys.Serialization.JavaScriptSerializer.deserialize(I,!0)}catch(R){return 2>H.D8e&&(E.a.sendTraceTag(5018312,2,"Deser failed"),H.D8e++),null}if(!J)return E.a.debugAssertTag(5018313,
!1,null),null;for(I=0;I<H.oLc.length;I++)if(!J[H.oLc[I]])return"MessageId"!==H.oLc[I]&&E.a.sendTraceTag(41502555,2,"Cannot find required message field: {0}",H.oLc[I]),null;if(J.Values)try{J.Values}catch(R){return E.a.sendTraceTag(5018314,4,"Not a valid dictionary: {0}",R.message),null}else E.a.sendTraceTag(41502556,2,"No values in message");I=J.MessageId;if(!this.$ie(I))return E.a.sendTraceTag(5018315,1,"Ignore recvd {0}",{["id"]:I}),null;const T=J.SendTime,D=(new Date).getTime()-T;if(0>T)return E.a.sendTraceTag(520435660,
2,"{0}",{["t"]:T,["id"]:I}),null;6E4<D&&E.a.sendTraceTag(520435659,2,"{0}",{["t"]:T,["delta"]:D,["id"]:I});-300>D&&E.a.sendTraceTag(520435658,2,"{0}",{["t"]:T,["delta"]:D,["id"]:I});I=new z.a;I.MessageId=J.MessageId;I.SendTime=J.SendTime;I.CorrelationId=J.CorrelationId;J.Values&&(I.Values=J.Values);E.a.sendTraceTag(40640779,1,"Received message with MessageId:{0}, SendTime:{1}, CorrelationId:{2}",I.MessageId,I.SendTime,I.CorrelationId);return I}W1j(I){E.a.sendTraceTag(5018318,1,String.format("Received: {0}",
{["origin"]:I.origin,["data"]:I.data,["source"]:I.source}))}static sendMessage(I,J,T){if(!u.a())return E.a.debugAssertTag(5018319,!1,null),!1;try{return I.postMessage(J,T),!0}catch(D){E.a.sendTraceTag(5018320,4,"{0}",{["exception"]:D.message})}return!1}}H.oLc=["MessageId","SendTime"];H.jYb="*";H._id=0;H.D8e=0;Object(K.a)(H,"CrossDocumentMessenger",null,[106,867])},722:function(K,Z,d){d.r(Z);var k=d(630);K=d(0);var e=d(394),n=d(76),r=d(141),v=d(91),C=d(65),w=d(286),z=d(25),A=d(45),u=d(268),E=d(54),
H=d(94),I=d(26),J=d(34),T=d(84),D=d(941),R=d(933),Q=d(931),W=d(934),O=d(935),Y=d(938),S=d(939),da=d(936),fa=d(932),ka=d(940),ha=d(937),F=d(55);class na{createAuthProviderAsync(ta){F.a.instance.resolve("PowerPointWebEditor.IAppForOfficeManagerFactory").Kia();return new Promise(oa=>{F.a.instance.Ja("PowerPointWebEditor.IAppForOfficeAuthFactory").execute(wa=>{wa=wa.ZAi(ta);oa(wa)})})}}Object(K.a)(na,"SlideShowAppForOfficeAuthFactory",null,[]);var ba=d(990),Ea=d(69);d.d(Z,"SlideShowCoreFrame",function(){return La});
class La{constructor(ta,oa,wa,ra,ya,Da,pa,la,Fa,Qa,Sa,Na,ua,za){this.nn=this.Ufc=this.p8c=null;this.xea=new e.a;this.va=new n.a;this.DBe="";this.qw=null;this.Sad="";this.bAe=this.Jyg=this.Mgc=this.WQ=this.o$=this.n$=this.jva=this.K=null;this.Ogc=!0;this.PWa=Date.now();this.NWa=Date.now();this.Jcb=this.JTg=0;this.qCb=!1;this.dok=()=>{I.a.J(512309270,830,50,"SlideShowCoreFrame::OnEditHappened");this.NWa=Date.now()};this.Upk=()=>{I.a.J(512309269,830,50,"SlideShowCoreFrame::OnLastMergeEditUTCChangedHandler");
this.NWa=Date.now()};this.Lrk=()=>{I.a.J(512309268,830,50,"SlideShowCoreFrame::OnRealTimeEditHandler");this.NWa=Date.now()};this.kf=ta;this.la=oa;this.Hc=wa;this.qBb=ra;this.Kl=ya;this.Tb=Da;this.eO=la;this.Wt=pa;this.sBe=Fa;this.je=Qa;this.eug=Sa;this.Zh=Na;this.AO=ua;this.tw=za;this.$ck=r.a.getInstance();this.eug&&this.eug.execute(Wa=>{Wa.JFc(this.dok)});this.Zh&&(this.Zh.B8h(this.Upk),this.Zh.s$h(this.Lrk));try{const Wa=this.Q4=JSON.parse(this.la.Ha("Settings"))||{};Wa.slideshowcore||(Wa.slideshowcore=
{});Wa.slideshowcore&&Wa.slideshowcore.forceSvg&&"true"===Wa.slideshowcore.forceSvg.toString().toLowerCase()?this.sBe=!0:this.sBe&&(Wa.slideshowcore.forceSvg="True")}catch(Wa){I.a.J(512495906,830,15,"Exception in parsing settings:{0}",Wa),this.Q4={}}}preloadShaders(){this.UUe();this.tod();SlideShowCore.SlideShowCore.preloadShaders()}init(ta,oa,wa,ra){return Object(k.a)(this,void 0,void 0,function*(){this.DBe=wa;this.AO=ra;this.Sad=oa;if(this.qw)I.a.J(509636752,830,50,"SlideShowCoreFrame::init - initPromise {0}",
this.pdc);else{this.jva=document.getElementById("HiddenFocusTrapAnchor");this.qw=document.createElement("div");this.qw.id="SlideShowBackground";this.qw.className="SlideShowBackground";this.qw.style.visibility=Ea.a.Ms;this.qw.tabIndex=-1;this.K=document.createElement("div");this.K.id="SlideShowContainer";this.K.className="SlideShowContainer";this.K.tabIndex=-1;this.K.style.width=window.screen.width+"px";this.K.style.height=window.screen.height+"px";v.a.addHandler(this.qw,C.a.Fwa,pa=>{this.yqk(pa)});
w.a.instance.pb(this.qw,pa=>this.kgb(pa));this.qw.appendChild(this.K);J.a("PresenterCoachTabFix")&&this.jva?this.kf.insertBefore(this.qw,this.jva):this.kf.appendChild(this.qw);var ya=this.la.Ha("pptSlideShowCoreCssUrl"),Da=document.createElement("link");Da.setAttribute("rel","stylesheet");Da.setAttribute("type","text/css");Da.setAttribute("href",ya);this.K.appendChild(Da);ba.a.instance.init(this.la,this.qw,this.Hc,this,this.Kl,this.Tb,this.eO);this.n$=document.getElementById("slideshowBeginningFocusTrap");
this.o$=document.getElementById("slideshowEndFocusTrap");this.n$||this.o$||(this.n$=document.createElement("div"),this.n$.id="slideshowBeginningFocusTrap",this.n$.className="FocusTrap",this.n$.tabIndex=0,v.a.addHandler(this.n$,C.a.focus,pa=>{this.Ojc(pa)}),this.o$=document.createElement("div"),this.o$.id="slideshowEndFocusTrap",this.o$.className="FocusTrap",this.o$.tabIndex=0,v.a.addHandler(this.o$,C.a.focus,pa=>{this.Ojc(pa)}),J.a("PresenterCoachTabFix")&&this.jva?(this.kf.insertBefore(this.n$,this.kf.firstChild),
this.kf.insertBefore(this.o$,this.jva.nextSibling)):(ya=document.getElementById("slideshow-toolbar"),this.kf.insertBefore(this.n$,this.qw),this.kf.insertBefore(this.o$,ya)));this.pdc=this.I4f(1)}yield this.pdc})}I4f(ta){return Object(k.a)(this,void 0,void 0,function*(){const oa=String.format("{0}PodHandler.ashx?action=GetSnappedDownloadLink&PodSID={1}",this.la.podsWebServiceBase,this.AO),wa={"Content-Type":"application/json; charset=utf-8",WaitForSessionTimeoutMs:"0"};wa["X-UserSessionId"]=z.AFrameworkApplication.userSessionId;
const ra=new Date;return new Promise((ya,Da)=>{this.tw.Aj(oa,1,"",wa,!1,0,pa=>Object(k.a)(this,void 0,void 0,function*(){yield this.VFe(pa,ra);I.a.J(509636751,830,50,"SlideShowCoreFrame - getSnappedUrl GettingSnappedUrlSucceeded");ya()}),pa=>Object(k.a)(this,void 0,void 0,function*(){yield this.UFe(pa,ta);I.a.J(509636750,830,50,"SlideShowCoreFrame - getSnappedUrl GettingSnappedUrlFailed");Da()}),null,null)})})}VFe(ta,oa){return Object(k.a)(this,void 0,void 0,function*(){I.a.J(512309283,830,50,"SlideShowCoreFrame - OnGettingSnappedUrlSucceeded. Time-Taken : {0}",
+new Date-+oa);const wa=JSON.parse(ta.data.Zd);this.WQ=wa.downloadUrl;A.a.Wa(this.WQ)?I.a.J(512309282,830,10,"SlideShowCoreFrame - OnGettingSnappedUrlSucceeded but downloadUrl is null or empty - {0}",wa):(this.PWa=Date.now(),yield this.ZBj())})}m3f(){const ta={};ta.settings=this.Q4;ta.retryCount=this.la.Fc("GetItemsRetryCount",3);ta.retryOnCategories=this.la.Ha("GetItemsRetryCategories").split(";");const oa={};oa.Slide=ResourceStrings.l_Slide;oa.AnimNum=ResourceStrings.l_AccSsAnimNum;oa.SldNameWithTooltip=
ResourceStrings.l_AccSsSldNameWithTooltip;oa.SldNameWithoutTooltip=ResourceStrings.l_AccSsSldNameWithoutTooltip;oa.AnimTotalSingular=ResourceStrings.l_AccSsAnimTotalSingular;oa.AnimTotalPlural=ResourceStrings.l_AccSsAnimTotalPlural;ta.localizedStrings=oa;return ta}ZBj(){return Object(k.a)(this,void 0,void 0,function*(){this.UUe();this.tod();this.p8c=new PodsProxy.PodsProxy(this.la.s9a?this.la.gSc:this.la.podsWebServiceBase,{DownloadUrl:this.WQ,DocID:z.AFrameworkApplication.jh,CustomFontCatalogUrl:this.la.Ha("CustomFontCatalogURL")},
this.la.qJa?A.a.bT(this.la.qJa).toLowerCase():"",this.xea,this.L2f(),this.M2f());this.Ufc=new SlideShowCore.DefaultResourceProviders(this.p8c,this.xea,this.m3f());const ta={};ta.initTime=La.g5b();ta.uiHost="Unified App";ta.serverUrl=A.a.Ke(this.la.podsWebServiceBase);ta.userSessionId=this.DBe;ta.jsScriptsBasePath=this.la.Ha("StaticContentHost")+"pptscripts/ssapp/";ta.fileHost=this.la.Ha("FileHost");ta.isRtl=z.AFrameworkApplication.isRtl;ta.applicationLcid=z.AFrameworkApplication.lcid;ta.applicationLocaleName=
z.AFrameworkApplication.uiCulture;ta.areThirdPartyAddInsAllowed=z.AFrameworkApplication.tia;ta.theWsaClient=z.AFrameworkApplication.jj;ta.appForOfficeContextActivationParameters=D.a.X4f(this.je);ta.hubbleVideoEndpoint=this.la.insertOnlineVideoEndpoint;ta.acceptLanguage=u.a.ue(z.AFrameworkApplication.lcid).name;this.la.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.ModernSlideShowAddInSSO",!1)&&(ta.appForOfficeAuthFactory=new na);const oa={};oa.settings=this.Q4;oa.transitionResourceCDNPath=
this.la.XJf;oa.transitionDisabledList=this.la.LLa;oa.clickTargetEnabled=!0;oa.mediaEnabled=!0;oa.gifEnabled=!0;oa.convertGifToVideo=!0;oa.crossSlideAudioEnabled=!0;oa.editAudioEnabled=this.la.ka("PPTOAudioPlaybackOptionsEnabled");oa.flipgridVideoEnabled=this.la.ka("PptModernSlideShowFlipgridVideoEnabled");oa.useNewYoutubePlayer=!0;oa.useNewVimeoPlayer=!0;oa.useOnlineVideoPlayer=!0;oa.tedVideoEnabled=this.la.ka("PptModernSlideShowTEDVideoEnabled");oa.isStream2Enabled=this.la.ka("IsStream2VideoEnabled");
oa.endOfShowText=ResourceStrings.l_EndOfSlideShowMessage;oa.enableSVGAsWebGLTexture=!E.a.fg&&this.la.ka("SlideShowShapeBuilderSVGEnabled");oa.maxSvgTextureSize=this.la.Fc("ShapeBuilderMaxSvgTextureSize",2048);oa.enableSlideSizeAdjust=this.la.ka("EnableSlideSizeAdjust");oa.slideSizeMax={["x"]:this.la.Fc("SlideShowMaxWidth",1504),["y"]:this.la.Fc("SlideShowMaxHeight",849)};oa.slideSizeMin={["x"]:this.la.Fc("SlideShowMinWidth",348),["y"]:this.la.Fc("SlideShowMinHeight",261)};oa.slideSizeDefault={["x"]:this.la.Fc("SlideShowDefaultWidth",
1504),["y"]:this.la.Fc("SlideShowDefaultHeight",849)};oa.streamVideoUseThinEmbed=this.la.ka("StreamVideoUseThinEmbed");oa.slideMetadataEnabled=this.la.ka("PptModernSlideShowSlideMetadataEnabled");oa.disabledChangeGates=this.la.Ha("PPTDisabledChangeGates");oa.combineBootRequest=!0;oa.localVideoTelemetryEnabled=this.la.ka("IsGFXVideoLocalTelemetryEnabled");oa.imageSettings={["imageAppendOption"]:"all"};const wa={["slideShowCoreSettings"]:oa,["appSettings"]:ta};this.nn=new SlideShowCore.SlideShowCore(this.K,
this.Ufc,this.xea,wa);new SlideShowCore.PrefetchAddon(this.nn,this.xea,{["forwardPrefechCount"]:this.la.Fc("PptModernSlideShowForwardPrefetchCount",10),["backwardPrefechCount"]:this.la.Fc("PptModernSlideShowBackwardPrefetchCount",5),["forwardPrerenderCount"]:this.la.Fc("PptModernSlideShowForwardPrerenderCount",2),["backwardPrerenderCount"]:this.la.Fc("PptModernSlideShowBackwardPrerenderCount",2)});new SlideShowCore.SlideAdvanceAddon(this.nn,this.xea);this.JTg=Date.now();this.bAe=this.nn.init();this.nn.events.on("slideLocationChanged",
()=>{this.Ned()});this.nn.events.on("animationStateChanged",()=>{this.Ned()});this.nn.events.on("slideDimensionsChanged",()=>{this.getCurrentSlideDimensions()});this.nn.events.on("exitFromEndOfShow",()=>{this.JFe(!0)});this.nn.events.on("blankSlideStateChanged",ra=>{this.umk(ra)});this.nn.events.on("slideshowError",ra=>{this.Kdd(ra)});return new Promise(ra=>{this.bAe.then(()=>{this.Ogc=!1;this.Jyg=new SlideShowCore.InputsAddon(this.nn,this.K,z.AFrameworkApplication.isRtl);new SlideShowCore.AnimationLoggerAddon(this.nn,
wa,this.xea);new SlideShowCore.TransitionLoggerAddon(this.nn,wa,this.xea);new SlideShowCore.PerfCheckerAddon(this.nn,wa,this.xea);this.Mgc=new SlideShowCore.SlideShowInkAddon(this.nn,this.xea,this.K,()=>this.qBb.loadScript("slideshowink"),{["telemetryLogger"]:this.$ck});this.Jyg.events.on("keydown",ya=>{this.UIa(ya)});I.a.J(509636749,830,50,"SlideShowCoreFrame - initSlideShowCore Finshed Initializing");ra()})})})}M2f(){const ta={};ta.timeout=this.la.Fc("PptModernSlideShowGetItemsTimeoutMs",3E4);ta.throwHttpErrors=
!1;ta.enableServerSpecificErrorCode=J.a("SSCore.EnableServerSpecificErrorCode");return ta}tod(){try{const ta=this.Q4;if(ta.slideshowcore){const oa={};oa.settings=ta;oa.logger=this.xea;oa.disabledChangeGates=this.la.Ha("PPTDisabledChangeGates");window.SlideShowCore.setupGlobals_SlideShowCore(oa)}}catch(ta){I.a.J(509703488,830,15,"Exception in passing settings to slideshowcore:{0}",ta)}}UUe(){try{const ta=this.Q4;if(ta.podsproxy){const oa={};oa.settings=ta;window.PodsProxy.setupGlobals_PodsProxy(oa)}}catch(ta){I.a.J(512309267,
830,15,"Exception in passing settings to podsproxy:{0}",ta)}}eHh(ta,oa){return Object(k.a)(this,void 0,void 0,function*(){this.UUe();this.tod();this.p8c=new PodsProxy.PodsProxy(this.la.s9a?this.la.gSc:this.la.podsWebServiceBase,{DownloadUrl:this.WQ,DocID:z.AFrameworkApplication.jh,CustomFontCatalogUrl:this.la.Ha("CustomFontCatalogURL")},this.la.qJa?A.a.bT(this.la.qJa).toLowerCase():"",this.xea,this.L2f(),this.M2f());const wa=this.Ufc;this.Ufc=new SlideShowCore.DefaultResourceProviders(this.p8c,this.xea,
this.m3f());yield this.nn.updateResourceProviders(this.Ufc,{shouldRerenderSlide:!0});wa&&wa.dispose();I.a.J(593827098,830,50,"Done updating ResourceProvider. StartUrl:{0}, downloadUrl:{1}, updatedResourceProvider:{2}, IsSlideShowVisible:{3}",ta,oa,Date.now(),this.Qab())})}UFe(ta,oa){return Object(k.a)(this,void 0,void 0,function*(){const wa=ta.data?ta.data.Te:-1;0<oa--?(I.a.J(512309281,830,15,"SlideShowCoreFrame - OnGettingSnappedUrlFailed : Retrying to Get Snapped Download Url. Current Retry Count: {0}, HttpStatus: {1}",
wa),yield this.I4f(oa)):I.a.J(512309280,830,10,"SlideShowCoreFrame - OnGettingSnappedUrlFailed : HttpStatus: {0}",wa)})}cqd(ta,oa,wa,ra,ya,Da,pa,la,Fa){Object(k.a)(this,void 0,void 0,function*(){this.pdc&&(I.a.J(509617947,830,50,"SlideShowCoreFrame::StartFrom - initPromise {0}",this.pdc),yield this.pdc,this.Qab()||this.show());if(this.nn&&!A.a.Wa(this.WQ)){const Qa={};this.NWa>this.PWa||this.Ogc?(this.Q4.slideshowcore.vetoBootDurationMs=this.la.Fc("PptModernSlideShowEditVetoBootDurationMs",8E3),Qa.BootScenario=
this.NWa>this.PWa?"AfterEdit":"Init",I.a.J(509703459,830,50,"SlideShowCoreFrame::StartFrom - Setting vetoBootDurationMs to: {0}, LastEditTime: {1}, LastSnapTime: {2}, SlideshowWaitedForInit: {3}",this.la.Fc("PptModernSlideShowEditVetoBootDurationMs",8E3),this.NWa,this.PWa,this.Ogc)):(this.Q4.slideshowcore.vetoBootDurationMs=this.la.Fc("PptModernSlideShowCachedVetoBootDurationMs",2E3),Qa.BootScenario="Relaunch",I.a.J(509703458,830,50,"SlideShowCoreFrame::StartFrom - Setting vetoBootDurationMs to: {0}, LastEditTime: {1}, LastSnapTime: {2}, SlideshowWaitedForInit: {3}",
this.la.Fc("PptModernSlideShowCachedVetoBootDurationMs",2E3),this.NWa,this.PWa,this.Ogc));this.tod();this.NWa>this.PWa&&(yield this.fHh(1));Qa.startFromTime=Fa-window.performance.timing.navigationStart;Qa.SSCoreFrameStartTime=La.g5b();ba.a.instance.KSk();this.K.style.top="0";this.n$&&this.o$&&(this.n$.tabIndex=0,this.o$.tabIndex=0);const Sa={["slideId"]:{["sid"]:ta,["cid"]:0}};Sa.slideIndex=oa-1;this.Wt.Y8b&&!this.Wt.U8?this.hqi(Sa,Qa):this.mUf(Sa,Qa)}else I.a.J(512495901,830,15,"Failed to get download Url")})}prev(){this.nn&&
this.nn.prevStep("0_anim").then(()=>{})}next(){this.nn&&this.nn.nextStep("0_anim",3).then(()=>{})}show(){this.Ksc(!0)}Qab(){return this.qw&&this.qw.style.visibility===Ea.a.xz?!0:!1}y8(){return"Modern"}Ksc(ta){ba.a.instance.setVisibility(ta&&this.Hc.Kh);this.qw&&(ta?(this.qw.style.visibility=Ea.a.xz,$addHandler(window,"visibilitychange",oa=>{this.PYa(oa)})):(this.qw.style.visibility=Ea.a.Ms,$removeHandler(window,"visibilitychange",oa=>{this.PYa(oa)})))}exit(){this.JFe(!1)}dQc(){this.JFe(!1)}transcribe(ta,
oa,wa,ra,ya,Da,pa){const la=!!this.Tb&&!!this.Tb.instance&&(this.Tb.instance.LRa||this.Tb.instance.Yq);(this.Tb&&this.Tb.instance&&this.Tb.instance.sr&&this.Tb.instance.jDa||la)&&!this.Tb.instance.Uub()?I.a.J(512495900,830,50,"SlideShowCoreFrame::Transcribe - LivePresenter prevented transcriber from starting"):(ba.a.instance.transcribe(ta,oa,wa,ra,ya,Da,pa),this.Hc.Kh&&this.nn.recordSessionStats({["metadata"]:"subtitles"}),this.MZd())}mUf(ta,oa){this.nn.clearNavigationState();const wa={navigationType:"init"};
wa.startFromTime=oa.startFromTime;oa.waitedForInit=this.Ogc;oa.startInitTime=this.JTg;oa.beforeInitPromise=La.g5b();this.bAe.then(()=>{oa.afterInitPromise=La.g5b();wa.bootMetrics=oa;if(0>ta.slideIndex)this.nn.gotoFirstSlide(!0,wa).then(()=>{this.K.style.height="100%";this.K.style.width="100%";this.va.raiseEvent("OnSlideshowReady",new Sys.EventArgs)});else{const ra={};ra.actionContext=wa;ra.fSkipTransition=!0;this.nn.gotoSlide(ta,ra).then(()=>{this.K.style.height="100%";this.K.style.width="100%";this.va.raiseEvent("OnSlideshowReady",
new Sys.EventArgs)})}})}hqi(ta,oa){const wa=this.la.Fc("PptModernSlideShowCheckFullscreenCounter",10);let ra=wa;this.Jcb=window.setInterval(()=>{ra--;I.a.J(512495899,830,50,"SlideShowCoreFrame::StartFrom - check fullscreen counter: {0}.",ra);if(this.Wt.U8||0>=ra){window.clearInterval(this.Jcb);this.Jcb=0;const ya=20*(wa-ra);oa.checkFullscreenMs=ya;I.a.J(512495898,830,50,"SlideShowCoreFrame::StartFrom - check fullscreen duration: {0} ms.",ya);this.mUf(ta,oa)}},20)}MZd(){let ta=0,oa=100;this.Hc.Kh&&
ba.a.instance.isVisible()&&("AboveSlide"===this.Hc.Ov?(ta=15,oa=85):"BelowSlide"===this.Hc.Ov&&(oa=85));const wa=document.getElementById("LiveURLBarLayerHost");this.qCb&&wa?(this.K.style.top=String.format("calc({0}% + {1})",ta.toString(),"26px"),this.K.style.height=String.format("calc({0}% - {1})",oa.toString(),"26px")):(this.K.style.top=ta.toString()+"%",this.K.style.height=oa.toString()+"%")}setMicrophoneState(ta){ba.a.instance.setMicrophoneState(ta)}HNb(ta,oa=""){this.qCb=ta;ba.a.instance.FBh(ta,
oa);this.MZd()}toggleTranscriberUIVisibility(ta){ba.a.instance.setVisibility(ta);ba.a.instance.fGc();this.MZd()}h0e(){this.va.raiseEvent("OnFullscreenClick",new Sys.EventArgs)}restoreFocus(){this.qw&&this.qw.style.visibility!==Ea.a.Ms&&!this.Uhe()&&this.K.focus()}pausePresentation(){}getCurrentPosition(){if(this.nn){const ta=this.nn.getSlideLocation();ta?this.va.raiseEvent("OnGetCurrentPosition",new W.a({["SlideId"]:ta.slideId.sid,["SlideIndex"]:ta.slideIndex})):I.a.J(512495897,830,15,"SlideShowCoreFrame::GetCurrentPosition: currentLocation is null")}}getCurrentPositionWithTimeLines(){if(this.nn){const ta=
this.nn.getSlideLocation();if(ta){const oa=this.nn.getAnimationState(!0),wa=oa.timelineStates,ra=[];for(let ya=0;ya<wa.length;ya+=1)ra.push({["TimeLineId"]:wa[ya].timelineId,["Step"]:wa[ya].step,["LastClickTime"]:wa[ya].lastClickTime,["StartTimeOffset"]:oa.startTimeOffset});this.va.raiseEvent("OnGetCurrentPosition",new W.a({["SlideId"]:ta.slideId.sid,["SlideIndex"]:ta.slideIndex,["TimeLineMappings"]:ra}))}else I.a.J(512495896,830,15,"SlideShowCoreFrame::GetCurrentPositionWithTimeLines: currentLocation is null")}}getCurrentSlideDimensions(){if(this.nn&&
this.qw&&this.qw.style.visibility!==Ea.a.Ms){const ta=document.getElementById(this.sBe?"svg-canvas":"webgl-canvas");ta&&this.va.raiseEvent("OnGetCurrentSlideDimensions",new O.a({["SlideHeight"]:ta.offsetHeight,["SlideWidth"]:ta.offsetWidth,["SlideLeftBound"]:ta.offsetLeft,["SlideBottomBound"]:ta.offsetTop+ta.offsetHeight}))}}$Sa(ta){this.nn&&this.nn.gotoSlide({["slideIndex"]:ta},{actionContext:{navigationType:"goto"},fSkipTransition:!1}).then(()=>{})}f7f(ta,oa){if(this.nn){const wa={},ra=[];let ya=
0;for(let Da=0;Da<oa.length;Da+=1){const pa={};pa.timelineId=oa[Da].TimeLineId;pa.step=oa[Da].Step;pa.lastClickTime=oa[Da].LastClickTime;ya=oa[Da].StartTimeOffset;ra.push(pa)}wa.timelineStates=ra;wa.startTimeOffset=ya;oa={actionContext:{navigationType:"goto"}};oa.animationState=wa;oa.fSkipTransition=!1;this.nn.gotoSlide({["slideIndex"]:ta},oa).then(()=>{})}}fHh(ta){return Object(k.a)(this,void 0,void 0,function*(){I.a.J(512309260,830,50,"updateSlideShowCoreAfterEdit: CurrentPodSessionId:{0}",this.AO);
const oa=String.format("{0}PodHandler.ashx?action=GetSnappedDownloadLink&PodSID={1}",this.la.podsWebServiceBase,this.AO),wa={"Content-Type":"application/json; charset=utf-8",WaitForSessionTimeoutMs:"0"};wa["X-UserSessionId"]=z.AFrameworkApplication.userSessionId;const ra=new Date;return new Promise((ya,Da)=>{this.tw.Aj(oa,1,"",wa,!1,0,pa=>Object(k.a)(this,void 0,void 0,function*(){yield this.hpk(pa,ra);I.a.J(509636748,830,50,"SlideShowCoreFrame - updateSlideShowCoreAfterEdit GettingSnappedUrlSucceededAfterEdit");
ya()}),pa=>Object(k.a)(this,void 0,void 0,function*(){yield this.fpk(pa,ta);I.a.J(509636747,830,50,"SlideShowCoreFrame - updateSlideShowCoreAfterEdit GettingSnappedUrlFailedAfterEdit");Da()}),null,null)})})}hpk(ta,oa){return Object(k.a)(this,void 0,void 0,function*(){const wa=new Date;I.a.J(512309279,830,50,"SlideShowCoreFrame - onGettingSnappedUrlSucceededAfterEdit. Time-Taken : {0}",+wa-+oa);const ra=JSON.parse(ta.data.Zd);this.WQ=ra.downloadUrl;A.a.Wa(this.WQ)?I.a.J(512309278,830,10,"SlideShowCoreFrame - onGettingSnappedUrlSucceededAfterEdit but downloadUrl is null or empty : {0}",
ra):(this.PWa=Date.now(),yield this.eHh(oa,wa))})}fpk(ta,oa){return Object(k.a)(this,void 0,void 0,function*(){const wa=ta.data?ta.data.Te:-1;0<oa--?(I.a.J(512309277,830,15,"SlideShowCoreFrame - onGettingSnappedUrlFailedAfterEdit : Retrying to Get Snapped Download Url. Current Retry Count: {0}, HttpStatus: {1}",wa),yield this.fHh(oa)):I.a.J(512309276,830,10,"SlideShowCoreFrame - onGettingSnappedUrlFailedAfterEdit : HttpStatus: {0}",wa)})}refreshPodSession(ta,oa,wa=1){I.a.J(512309259,830,50,"RefreshPodSession: CurrentPodSessionId:{0}, UpdatedPodSessionId:{1}",
this.AO,ta);this.AO=ta;this.Sad=oa;ta=String.format("{0}PodHandler.ashx?action=GetSnappedDownloadLink&PodSID={1}",this.la.podsWebServiceBase,this.AO);oa={"Content-Type":"application/json; charset=utf-8",WaitForSessionTimeoutMs:"0"};oa["X-UserSessionId"]=z.AFrameworkApplication.userSessionId;const ra=new Date;this.tw.Aj(ta,1,"",oa,!1,0,ya=>Object(k.a)(this,void 0,void 0,function*(){yield this.ipk(ya,ra)}),ya=>Object(k.a)(this,void 0,void 0,function*(){yield this.gpk(ya,wa)}),null,null)}ipk(ta,oa){return Object(k.a)(this,
void 0,void 0,function*(){var wa=new Date;I.a.J(512309275,830,50,"SlideShowCoreFrame - onGettingSnappedUrlSucceededOnRefreshPodSession. Time-Taken : {0}",+wa-+oa);const ra=JSON.parse(ta.data.Zd);this.WQ=ra.downloadUrl;A.a.Wa(this.WQ)?(I.a.J(512309274,830,10,"SlideShowCoreFrame - onGettingSnappedUrlSucceededOnRefreshPodSession but downloadUrl is null or empty : {0}",ra),this.Qab()&&(wa=T.a.Uh(413),z.AFrameworkApplication.xp(wa),H.Health.instance.recordQosError(T.a.Wia(wa),["SlideShowACE"],!1,!0,!0,
!0,null),this.nn&&this.nn.recordSessionStats({["errorName"]:"ErrorSlideShowRehydrationFailed"}),this.exit())):(this.PWa=Date.now(),yield this.eHh(oa,wa))})}gpk(ta,oa){ta=ta.data?ta.data.Te:-1;0<oa--?(I.a.J(512309273,830,15,"SlideShowCoreFrame - onGettingSnappedUrlFailedOnRefreshPodSession : Retrying to Get Snapped Download Url. Current Retry Count: {0}, HttpStatus: {1}",ta),this.refreshPodSession(this.AO,this.Sad,oa)):(I.a.J(512309272,830,10,"SlideShowCoreFrame - onGettingSnappedUrlFailedOnRefreshPodSession : HttpStatus: {0}",
ta),this.Qab()&&this.exit())}setVisibility(ta){this.Ksc(ta)}Vfa(ta){this.qw&&(this.qw.style.cursor=ta?"default":"none");ba.a.instance.Vfa(ta)}setOsfLocalStorage(){}uJe(ta){if(this.Mgc)this.Mgc.onInkManagerActivity(ta)}UIa(ta){this.ISe(ta)}ISe(ta){this.va.raiseEvent("OnSpecialKey",new fa.a({["Key"]:ta.keyCode,["ShiftKey"]:ta.shiftKey}))}moh(){}Ojc(){this.qw&&this.restoreFocus()}L2f(){const ta=new Map;ta.set("X-UserSessionId",this.DBe);ta.set("X-WacNoAuth","1");ta.set("X-WacCluster",this.Sad);ta.set("Client",
"Unified App");this.la.D$i&&ta.set("UseDocCache","True");return ta}JFe(ta=!1){this.Jcb&&(I.a.J(512495890,830,50,"SlideShowCoreFrame::OnExitFromSlideShowHandler m_fullscreenCheckerId is not zero: {0}",this.Jcb),window.clearInterval(this.Jcb),this.Jcb=0);this.Mgc&&this.Mgc.resetInkCanvas();this.n$&&this.o$&&(this.n$.tabIndex=-1,this.o$.tabIndex=-1);if(this.nn){const oa=this.nn.getSlideLocation();this.nn.endSession(La.g5b());oa?this.va.raiseEvent("OnExit",new Q.a({["SlideId"]:oa.slideId.sid,["IsBeforeReady"]:!1,
["SlideIndex"]:oa.slideIndex,["IsFromEndOfSlideshow"]:ta})):I.a.J(512495889,830,15,"SlideShowCoreFrame::OnExitFromSlideShowHandler: currentLocation is null")}this.K.style.width=window.screen.width+"px";this.K.style.height=window.screen.height+"px";this.Ksc(!1);ba.a.instance.yYe()}Ned(){if(this.nn&&this.qw&&this.qw.style.visibility!==Ea.a.Ms){const ta=this.nn.getSlideLocation();if(ta){const oa=this.nn.getAnimationState(!0),wa=oa.timelineStates,ra=[];for(let ya=0;ya<wa.length;ya+=1)ra.push({["TimeLineId"]:wa[ya].timelineId,
["Step"]:wa[ya].step,["LastClickTime"]:wa[ya].lastClickTime,["StartTimeOffset"]:oa.startTimeOffset});this.va.raiseEvent("OnPositionChangeEventId",new S.a({["SlideId"]:ta.slideId.sid,["SlideIndex"]:ta.slideIndex,["TimeLineMappings"]:ra}))}else I.a.J(512495888,830,50,"SlideShowCoreFrame::OnPositionChangedHandler: currentLocation is null")}}umk(ta){if(this.nn&&this.qw&&this.qw.style.visibility!==Ea.a.Ms)switch(ta){case "Hidden":this.va.raiseEvent("OnLeaveEndOfShowEventId",Sys.EventArgs.Empty);break;
case "EndOfShow":this.va.raiseEvent("OnEnterEndOfShowEventId",Sys.EventArgs.Empty);break;default:I.a.J(512495887,830,50,"SlideshowCoreFrame.OnBlankSlideStateChangedHandler {0}",ta)}}Kdd(ta){if(this.nn){I.a.J(512495886,830,15,"SlideshowCoreFrame.OnErrorHandler {0}",ta);let oa;ta.startsWith("Server")&&(ta="GetItemsRequestFailed");switch(ta){case "GetItemsFailedDownloadFile":I.a.J(512495885,830,50,"SlideshowCoreFrame.OnErrorHandler ErrorSlideShowFailedToDownloadFile PodSessionId {0}",this.AO);this.va.raiseEvent("OnPodSessionExpired",
new Y.a({["Code"]:5341407,["Reason"]:"Failed To Download File",["PodSessionId"]:this.AO}));return;case "LoadFailed":oa=407;break;case "GetItemsFailedInvalidResponse":oa=408;break;case "GetItemsRequestFailed":oa=409;break;case "GetItemsTimeout":oa=411;break;case "EnsureSlideFailed":oa=412;break;case "SetupWebGLContextFailed":case "RestoreWebGLContextFailed":oa=414;break;default:oa=359}if(0!==oa)if(this.Qab()){const wa=T.a.Uh(oa);z.AFrameworkApplication.xp(wa);ta=409===oa?ta:T.a.Wia(wa);H.Health.instance.recordQosError(ta,
["SlideShowACE"],!1,!0,!0,!0,null);this.nn.recordSessionStats({["errorName"]:ta})}else I.a.J(512495884,830,15,"SlideshowCoreFrame.OnErrorHandler received error when frame is hidden. ErrorCode:{0}",ta)}}sfd(ta){I.a.J(512495883,830,50,"SlideshowCoreFrame.OnTranscriberStartedHandler");this.nn&&this.qw&&this.qw.style.visibility!==Ea.a.Ms&&this.va.raiseEvent("OnTranscriberStartedEventId",new ka.a({["TranscriberSessionId"]:ta}));this.Hc.Wub=!0}PYa(){I.a.J(512495882,830,50,"SlideshowCoreFrame.OnVisibilityChangeHandler");
window.document.hidden&&this.va.raiseEvent("OnVisibilityChangeEventId",new ha.a(!1))}Uhe(){return!!this.Tb&&!!this.Tb.instance&&this.Tb.instance.lSf}PFc(ta){this.va.addHandler("OnSlideshowReady",ta)}kkd(ta){this.va.removeHandler("OnSlideshowReady",ta)}aOd(ta){this.va.addHandler("OnBrowserEvent",ta)}ePe(ta){this.va.removeHandler("OnBrowserEvent",ta)}rsf(ta){this.va.addHandler("OnFullscreenClick",ta)}Shh(ta){this.va.removeHandler("OnFullscreenClick",ta)}cOd(ta){this.va.addHandler("OnSlideshowContextMenu",
ta)}gPe(ta){this.va.removeHandler("OnSlideshowContextMenu",ta)}lia(ta){this.va.addHandler("OnExit",ta)}Cfa(ta){this.va.removeHandler("OnExit",ta)}osf(ta){this.va.addHandler("OnSlideshowError",ta)}Phh(ta){this.va.removeHandler("OnSlideshowError",ta)}LFc(ta){this.va.addHandler("OnGetCurrentSlideDimensions",ta)}ikd(ta){this.va.removeHandler("OnGetCurrentSlideDimensions",ta)}TXb(ta){this.va.addHandler("OnGetCurrentPosition",ta)}eib(ta){this.va.removeHandler("OnGetCurrentPosition",ta)}QFc(ta){this.va.addHandler("OnSpecialKey",
ta)}lkd(ta){this.va.removeHandler("OnSpecialKey",ta)}Fsf(ta){this.va.addHandler("OnVisibilityChangeEventId",ta)}oPe(ta){this.va.removeHandler("OnVisibilityChangeEventId",ta)}gOd(ta){this.va.addHandler("OnPodSessionExpired",ta)}kPe(ta){this.va.removeHandler("OnPodSessionExpired",ta)}vsf(ta){this.va.addHandler("OnLogEndOfTranscriptionSession",ta)}Uhh(ta){this.va.removeHandler("OnLogEndOfTranscriptionSession",ta)}nPa(ta){this.va.addHandler("OnPositionChangeEventId",ta)}fib(ta){this.va.removeHandler("OnPositionChangeEventId",
ta)}usf(ta){this.va.addHandler("OnLiveSubtitlesDockedViewEventId",ta)}Thh(ta){this.va.removeHandler("OnLiveSubtitlesDockedViewEventId",ta)}eOd(ta){this.va.addHandler("OnEnterEndOfShowEventId",ta)}hPe(ta){this.va.removeHandler("OnEnterEndOfShowEventId",ta)}fOd(ta){this.va.addHandler("OnLeaveEndOfShowEventId",ta)}jPe(ta){this.va.removeHandler("OnLeaveEndOfShowEventId",ta)}Csf(ta){this.va.addHandler("OnSubtitleUpdatedEventId",ta)}$hh(ta){this.va.removeHandler("OnSubtitleUpdatedEventId",ta)}Esf(ta){this.va.addHandler("OnTranscriberStartedEventId",
ta)}aih(ta){this.va.removeHandler("OnTranscriberStartedEventId",ta)}Msf(ta){this.va.addHandler("RecordQosErrorEventId",ta)}iih(ta){this.va.addHandler("RecordQosErrorEventId",ta)}yqk(ta){this.va.raiseEvent("OnBrowserEvent",new R.a({["ClientX"]:ta.clientX,["ClientY"]:ta.clientY}))}kgb(ta){this.va.raiseEvent("OnSlideshowContextMenu",new da.a({["ClientX"]:ta.clientPoint.x,["ClientY"]:ta.clientPoint.y}));return!0}static g5b(){return Math.round(window.performance.now())}}Object(K.a)(La,"SlideShowCoreFrame",
null,[535])},724:function(K,Z,d){K=d(0);class k{}k.slideType="slide";k.shapeType="shape";k.Hsb="chart";Object(K.a)(k,"ClipserviceDataConstants",null,[]);d.d(Z,"b",function(){return e});d.d(Z,"a",function(){return n});const e=r=>r===k.slideType?1:r===k.shapeType?2:r===k.Hsb?3:0,n=r=>1===r?k.slideType:2===r?k.shapeType:""},725:function(K,Z,d){K=d(0);var k=d(17),e=d(45),n=d(838),r=d(228),v=d(241),C=d(229),w=d(488);class z{constructor(u,E){this.f_a=u;this.description=E}}Object(K.a)(z,"ColorEntry",null,
[]);d.d(Z,"a",function(){return A});class A{constructor(u){this.ope={};this.mAe=null;this.Bm=u}get ykl(){if(!this.mAe){const u=new Sys.StringBuilder;for(let E of this.standardColors)u.append(String.format(A.eSd,this.vBh(E.f_a),this.Z_e(E.f_a),E.description));this.mAe=u.toString()}return this.mAe}get standardColors(){let u;return u=new k.a,u.add(new z(12582912,ResourceStrings.L_FontColorDarkRed)),u.add(new z(16711680,ResourceStrings.L_FontColorRed)),u.add(new z(16760832,ResourceStrings.L_FontColorOrange)),
u.add(new z(16776960,ResourceStrings.L_FontColorYellow)),u.add(new z(9621584,ResourceStrings.L_FontColorLightGreen)),u.add(new z(45136,ResourceStrings.L_FontColorDarkGreen)),u.add(new z(45296,ResourceStrings.L_FontColorLightBlue)),u.add(new z(28864,ResourceStrings.L_FontColorBlue)),u.add(new z(8288,ResourceStrings.L_FontColorDarkBlue)),u.add(new z(7352480,ResourceStrings.L_FontColorPurple)),u}vBh(u){return String.format("#{0}",C.i(u))}Z_e(u){return C.i(u)}Isc(u){return Object.assign(new v.a,{ThemeColor:u.ThemeColor,
ColorLuminance:u.ColorLuminance,FTintColor:u.FTintColor}).toString()}d$d(u,E,H){const I=new Sys.StringBuilder;I.append(this.zRd("ThemeColors",ResourceStrings.L_ThemeFontColor,!0,u));this.e7h(I);I.append(this.yRd());I.append(this.zRd("StandardColors",ResourceStrings.L_StandardFontColor,!1,u));I.append(this.ykl);I.append(this.yRd());E&&0<E.length&&(I.append(this.zRd("RecentColors",ResourceStrings.L_RecentColors,!1,H)),I.append(this.lfj(E)),I.append(this.yRd()));return I.toString()}lfj(u){const E=new Sys.StringBuilder;
for(let H=0;H<u.length;H++){const I=u[H];E.append(String.format(A.eSd,"#"+I.hex,I.hex,"#"+I.hex))}return E.toString()}zRd(u,E,H,I){return String.format(A.lli,u,E,"ColorPicker",H?'McuLayout = "true" ':"",I)}yRd(){return A.kli}e7h(u){const E=Array(10);E[0]=this.cL(r.Color.Ti(this.Bm.PresetSchemeColorMapping.Background1));E[1]=this.cL(r.Color.Ti(this.Bm.PresetSchemeColorMapping.Text1));E[2]=this.cL(r.Color.Ti(this.Bm.PresetSchemeColorMapping.Background2));E[3]=this.cL(r.Color.Ti(this.Bm.PresetSchemeColorMapping.Text2));
E[4]=this.cL(r.Color.Ti(this.Bm.PresetSchemeColorMapping.Accent1));E[5]=this.cL(r.Color.Ti(this.Bm.PresetSchemeColorMapping.Accent2));E[6]=this.cL(r.Color.Ti(this.Bm.PresetSchemeColorMapping.Accent3));E[7]=this.cL(r.Color.Ti(this.Bm.PresetSchemeColorMapping.Accent4));E[8]=this.cL(r.Color.Ti(this.Bm.PresetSchemeColorMapping.Accent5));E[9]=this.cL(r.Color.Ti(this.Bm.PresetSchemeColorMapping.Accent6));const H=Array(10);H[0]=ResourceStrings.l_ThemeLabel1;H[1]=ResourceStrings.l_ThemeLabel2;H[2]=ResourceStrings.l_ThemeLabel3;
H[3]=ResourceStrings.l_ThemeLabel4;H[4]=ResourceStrings.l_ThemeLabel5;H[5]=ResourceStrings.l_ThemeLabel6;H[6]=ResourceStrings.l_ThemeLabel7;H[7]=ResourceStrings.l_ThemeLabel8;H[8]=ResourceStrings.l_ThemeLabel9;H[9]=ResourceStrings.l_ThemeLabel10;for(let I=0;5>=I;I++)for(let J=0;J<E.length;J++)u.append(this.C0i(E[J][I],E[J][0],H[J],I,J))}cL(u){const E=e.a.dw(u.r,2)+e.a.dw(u.g,2)+e.a.dw(u.b,2);if(this.ope[E])return this.ope[E];const H=w.a.$Ra(u),I=[];Array.add(I,u);if(u.j1d())for(var J=0;J<n.a.XIh.length;++J)u=
w.a.Z3b(H),u.darken(n.a.XIh[J]/100),Array.add(I,u.rta());else if(u.XTi())for(J=0;J<n.a.wxf.length;++J)u=w.a.Z3b(H),u.lighten(n.a.wxf[J]/100),Array.add(I,u.rta());else if(H.lum<A.Wki)for(J=0;J<n.a.dpg.length;++J)u=w.a.Z3b(H),u.lighten(n.a.dpg[J]/100),Array.add(I,u.rta());else if(H.lum>A.Vki)for(J=0;J<n.a.cpg.length;++J)u=w.a.Z3b(H),u.darken(n.a.cpg[J]/100),Array.add(I,u.rta());else for(J=0;J<n.a.xJc.length+n.a.yEf.length;++J)u=w.a.Z3b(H),J<n.a.xJc.length?u.lighten(n.a.xJc[J]/100):u.darken(n.a.yEf[J-
n.a.xJc.length]/100),Array.add(I,u.rta());return this.ope[E]=I}C0i(u,E,H,I,J){u=this.Z_e(u.f_a);({vJc:E,LNb:H}=this.K4d(E,u,H,I,J));return String.format(A.eSd,E,u,H)}K4d(u,E,H,I,J){var T;var D=T=null;if(0>I)return{vJc:T,LNb:D};E=Object.assign(new v.a,{RGBColor:E,ThemeColor:J,ColorLuminance:0,FTintColor:!1});I?(J=w.a.$Ra(u),D=I-1,J.lum?1===J.lum?(I=!1,D=[242,217,191,166,127][D]):.8<J.lum?(I=!1,D=[229,191,127,64,25][D]):.2>J.lum?(I=!0,D=[25,64,127,191,229][D]):(J=[51,102,153],T=[191,127],D=(I=D<J.length)?
J[D]:T[D-J.length]):(I=!0,D=[127,166,191,217,242][D]),D=255-D,D=Math.round(100*D/255),E.ColorLuminance=100-D,E.FTintColor=I,D=String.format(I?ResourceStrings.l_ColorPickerTooltipTint:ResourceStrings.l_ColorPickerTooltipShade,u.toString(),H,D)):D=String.format(ResourceStrings.l_ColorPickerTooltipBase,u.toString(),H);T=this.Isc(E);return{vJc:T,LNb:D}}}A.lli='<MenuSection Id="{0}" Title="{1}"><Controls Id="Color.Menu.Controls"><ColorPicker Id="{2}" {3}Width="10" Command="{4}"><Colors>';A.kli="</Colors></ColorPicker></Controls></MenuSection>";
A.eSd='<Color Color="{0}" DisplayColor="#{1}" Alt="{2}" />';A.Wki=.2;A.Vki=.8;Object(K.a)(A,"ColorPickerBuilder",null,[])},726:function(K,Z,d){var k=d(104),e=d(54),n=d(78),r=d(25),v=d(33),C=d(85),w=d(27),z=d(230),A=d(321),u=d(26),E=d(955);K=d(0);class H{constructor(){this.oz=this.onSuccess=this.VEe=this.IOd=this.R$g=null}}Object(K.a)(H,"UploadFileDialogData",null,[]);var I=d(67),J=d(34);K=d(76);d.d(Z,"d",function(){return D});d.d(Z,"e",function(){return R});d.d(Z,"a",function(){return Y});d.d(Z,"c",
function(){return S});d.d(Z,"b",function(){return da});const T=new K.a,D=(fa,ka,ha,F,na)=>{const ba=String.format("{0}{1}",ha,k.a.create().toString());return Object.assign(new H,{IOd:O(ba,F),R$g:W(ha,F),VEe:(Ea,La)=>{switch(ha){case "video":La.blockContent(na,fa);break;default:La.blockContent(Ea,"Insert Media")}},onSuccess:(Ea,La,ta,oa,wa,ra)=>{ka(fa,ba,La,ta,wa,ra,na)},oz:(Ea,La,ta,oa,wa)=>{ta.PN(La)?u.a.J(509727823,822,15,"Media::InsertMediaFailureAfterUpload:Presentation was blocked with loader for {0} milliseconds",
+new Date-+La.Ria):ta.PN(na)&&u.a.J(509666848,822,15,"Media::InsertMediaFailureAfterUpload:Slide was blocked with loader for {0} milliseconds",+new Date-+na.Ria);J.a("FixHideShimmerIssueOnUploadFailure")&&"video".match(ha)?ta.ZJ(na):ta.ZJ(La);La=null;try{const ra=v.a(Ea);La=ra?ra.Error:null}catch(ra){u.a.J(509727822,818,10,"UploadResponseReceived - Exception when deserializing response. Response: {0}",Ea)}if(!La){let ra;J.a("FixHideShimmerIssueOnUploadFailure")&&Ea&&!isNaN(parseInt(Ea))&&(ra=Enum.parse(z.a,
z.a[parseInt(Ea)],!0));La=Object.assign(new A.a,{Code:ra?ra:444})}wa&&(wa.finish(),wa=null);u.a.J(509727821,822,10,"Upload media failed");Y(ha)?S(ResourceStrings.l_FileInsertFailedMessageTitle,ResourceStrings.l_VideoUploadTimeoutMessage,null):Q(oa,wa,La.Code,null)}})},R=(fa,ka,ha,F)=>new Promise((na,ba)=>{const Ea=new E.a(F);u.a.J(509727828,822,50,"Media File details: Number of media files: {0}, media file extension: {1}, media file size: {2}",fa&&fa.value?fa.files.length:0,E.a.z5d(fa),E.a.u_f(fa));
ha&&ha.Va("MediaFileValidationStarts",String.format("Number of media files: {0}, media file extension: {1}, media file size: {2}",fa&&fa.value?fa.files.length:0,E.a.z5d(fa),"video"===F?"":E.a.u_f(fa)));if(fa&&fa.value&&fa.value.length)if(Ea.UCl(fa.value)){var La=fa.files[0];if(Ea.VCl(La.size))Ea.nqi(La).then(ta=>{ta?(ha&&ha.Va("MediaFileValidationPassedOnUI","true"),na(!0)):(Y(F)?S(ResourceStrings.l_UnsuportedFileFormatTitle,ResourceStrings.l_UnsuportedFileFormatMessage,[Ea.Jma.join(", ")]):Q(ka,
ha,443,[Ea.Jma.join(", ")]),ba(443))},()=>{u.a.J(509727825,822,10,"Invalid media file, fileType:{0}",F);Y(F)?S(ResourceStrings.l_UnsuportedFileFormatTitle,ResourceStrings.l_UnsuportedFileFormatMessage,[Ea.Jma.join(", ")]):Q(ka,ha,443,[Ea.Jma.join(", ")]);ba(443)});else{u.a.J(509727826,822,10,"video"===F?"Media::Insert:video: max size error":`Media::Insert:Invalid media file size:${La.size}`);La=J.a("FetchMediaSizeLimitFromValidationHelper")?Ea.Lec.toString():"16";const ta="video"===F?450:442;Y(F)?
S(ResourceStrings.l_MaxFileSizeValidationErrorTitle,ResourceStrings.l_MaxVideoSizeValidationErrorMessage,[La]):Q(ka,ha,ta,[La]);ba(442)}}else u.a.J(509727827,822,10,"{flow:Insert{0}, fileExt:{1}}",null===F||void 0===F?void 0:F.toString(),E.a.z5d(fa)),Y(F)?S(ResourceStrings.l_UnsuportedFileFormatTitle,ResourceStrings.l_UnsuportedFileFormatMessage,[Ea.Jma.join(", ")]):Q(ka,ha,441,[Ea.Jma.join(", ")]),ba(441);else Y(F)?S(ResourceStrings.l_FileInsertFailedMessageTitle,ResourceStrings.l_FileInsertFailedMessage,
null):Q(ka,ha,440,null),ba(440)}),Q=(fa,ka,ha,F)=>{ka&&(ka.Va("MediaFileValidationPassedOnUI","false"),ha&&ka.Va("ErrorCode",ha.toString()),ka.finish());fa.YG(ha,na=>{na.$B=1;na.GRa=F;return!1})},W=(fa,ka)=>{let ha="MediaUpload.ashx";if(w.App.webServiceBase)ha=w.App.webServiceBase+ha;else if(e.a.fg||e.a.zua)ha=n.a.Wsa(ha);let F="";switch(fa){case "audio":F="audio";break;case "captions":F="captions";break;case "video":F="video";break;default:u.a.J(509727824,822,10,"Media::GetMediaUploadEndpoint: file type not supported")}ha+=
String.format("?MediaType={0}&{1}&{2}&{3}",F,r.AFrameworkApplication.QSa(),ka.presentationId.string,r.AFrameworkApplication.q4b());ka.podSessionId&&(ha+=String.format("&{0}={1}",C.a.U$,ka.podSessionId));ka.nk&&(ha+=String.format("&waccluster={0}",ka.nk));return ha},O=(fa,ka)=>{const ha=new I.a;ha.$("PresentationId",ka.presentationId.string);ha.$(C.a.vna,ka.sessionInfo);ha.$("Canary",r.AFrameworkApplication.canary);ha.$("access_token",r.AFrameworkApplication.accessToken);ha.$("MediaToken",fa);return ha},
Y=fa=>J.a("EnableCalloutNotificationsForVideos")&&"video".match(fa)?!0:!1,S=(fa,ka,ha)=>{let F=new A.a;F.Title=fa;F.Message=ka;F.ExtraErrorParam=ha;T.raiseEvent("videoCalloutNotificationEvent",F)},da=fa=>{T.addHandler("videoCalloutNotificationEvent",fa)}},901:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k{}k.NDe="TraceIdNoBar";k.H0c="TraceIdLeftBar";k.rld="TraceIdRightBar";k.sHc="TraceIdBothBar";Object(K.a)(k,"ConsistencyCheckTraceIdType",null,[])},902:function(K,Z,d){d.d(Z,"a",function(){return e});
K=d(0);var k=d(513);class e{constructor(){this.start=new k.a;this.end=new k.a}clone(){return Object.assign(new e,{start:this.start.clone(),end:this.end.clone()})}merge(n){let r=!1;n.start&&(r=this.start.merge(n.start));n.end&&(r=this.end.merge(n.end)||r);return r}}Object(K.a)(e,"TextNodeSelection",null,[])},903:function(K,Z,d){d.d(Z,"a",function(){return 19})},904:function(K,Z,d){d.r(Z);d.d(Z,"WordPredictionAugLoopResponseManager",function(){return A});K=d(0);Z=d(17);var k=d(348),e=d(905),n=d(652),
r=d(650),v=d(651),C=d(542),w=d(62),z=d(31);class A{F6b(u){A.LS.cG(()=>{this.Ybl(u)||(this.D0e(u),this.QAl(),this.Ndi())},"WPT:PR")}Ndi(){const u=C.a.KD.z5,E=C.a.KD.khb;if(u){var H=w.a.instance.Pa.mb;if(H&&H.Ye&&C.a.Geg(H.Ye)){H=H.Ye.node;var I=z.ParagraphReader.text(H);I=I.substring(u.Qmd,I.length);H=this.Z5d(H,u,I);"string"===typeof H?H.length?(u.B8=H,u.lMb+=1,C.a.EPd(u.text,H),this.Uzl(),u.ZHe=I,this.Tzl(u)):E&&0===E[n.a.status]?(this.uGh(),C.a.Qkd()):this.gBl():(this.uGh(),C.a.Qkd())}}}Tzl(u){A.gvd.count>=
A.tVh&&A.gvd.removeAt(0);A.gvd.add(this.bti(u))}bti(u){return Object.assign(new e.a,{id:u.id,Bya:u.Bya,Cx:u.Cx,Qmd:u.Qmd,text:u.text,B8:u.B8,UZb:u.UZb,y6a:u.y6a,score:u.score,n0e:u.n0e,m0e:u.m0e,nP:u.nP,lMb:u.lMb,ZHe:u.ZHe})}Ybl(u){if(u&&u.parentPath&&7===u.parentPath.length){const E=u.parentPath[6];C.a.dZa.add(E,v.a.fPd,(new Date).getTime());C.a.K_j(E)}else return C.a.vac(v.a.D_d),!0;return C.a.zUa?(u=this.e6f(u),u=this.Pah(u[0]),u[n.a.status]=5,C.a.I2d(u),C.a.vac(v.a.$vh),!0):!1}D0e(u){(u=this.e6f(u))&&
u.length?(C.a.KD.z5=u[0],C.a.KD.KBh=u.length,C.a.KD.khb=this.Pah(u[0])):(C.a.Qkd(),C.a.vac(v.a.D_d))}e6f(u){if(!u||!u.items||!u.parentPath||7!==u.parentPath.length)return null;var E=u.items[0];let H;try{H=E.body}catch(R){return null}E=u.parentPath[2];const I=parseInt(u.parentPath[3]),J=parseInt(u.parentPath[4]),T=u.parentPath[5];u=u.parentPath[6];if(!H.predictions.length)return null;C.a.y7k(H.modelInfo);const D=Array(H.predictions.length);for(let R=0;R<H.predictions.length;R++){const Q=H.predictions[R];
if(Q.text){const W=Q.characterRange,O=Q.tokenRange;D[R]=Object.assign(new e.a,{id:T,Bya:u,Cx:E,Qmd:I,text:Q.text,B8:Q.text.substr(W.start),UZb:W.start,y6a:W.length,score:Q.score,n0e:O.start,m0e:O.length,nP:J,lMb:0})}}return D}Pah(u){const E={};E[n.a.language]="en-US";const H=C.a.Kbj();E[n.a.modelId]=H.modelId;E[n.a.modelVersion]=H.modelVersion;E[n.a.configId]=H.configId;E[n.a.mTd]=u.y6a;E[n.a.FIc]=u.y6a;E[n.a.amg]=u.B8.length;E[n.a.Hah]=u.text.length;E[n.a.Kah]=u.text.split(" ").length;E[n.a.score]=
u.score;E[n.a.status]=0;E[n.a.Q1e]=u.B8.length;E[n.a.nP]=u.nP;u=C.a.dZa.ga(u.Bya);E[n.a.mBh]=u[v.a.fPd]-u[v.a.Oqc];E[n.a.Mrd]=0;return E}QAl(){const u=C.a.KD.z5;u&&(C.a.Bua(u.nP,r.a.yBf,C.a.KD.KBh),C.a.Bua(u.nP,r.a.zJf,u.y6a))}Uzl(){const u=C.a.KD.z5,E=C.a.KD.khb;if(u&&1===u.lMb){const H=(new Date).getTime();C.a.dZa.zbg(u.Bya,v.a.cuf,H);C.a.bog(u.Bya,!0);C.a.vac(v.a.Jah);const I=C.a.dZa.ga(u.Bya)[v.a.Oqc];E[n.a.Mrd]=H-I;E[n.a.status]=1;E[n.a.FIc]=u.text.length-u.B8.length;C.a.Bua(u.nP,r.a.Bnh,1);
C.a.Bua(u.nP,r.a.Vih,1);C.a.Bua(u.nP,r.a.Wih,u.B8.length);C.a.Bua(u.nP,r.a.AJf,u.text.length-u.B8.length);C.a.uDk()}}gBl(){const u=C.a.KD.z5,E=C.a.KD.khb;u&&(E[n.a.status]=3,E[n.a.FIc]=0,E[n.a.Q1e]=u.text.length-E[n.a.mTd],C.a.I2d(E),C.a.Bua(u.nP,r.a.iEh,1),C.a.Bua(u.nP,r.a.CJf,u.score),C.a.Bua(u.nP,r.a.jEh,u.text.length-u.y6a),C.a.Qkd())}uGh(){const u=C.a.KD.z5,E=C.a.KD.khb;if(u){if(0===E[n.a.status]){const H=(new Date).getTime();C.a.dZa.zbg(u.Bya,v.a.auf,H);C.a.bog(u.Bya,!1);C.a.vac(v.a.Iah);const I=
C.a.dZa.ga(u.Bya)[v.a.Oqc];E[n.a.Mrd]=H-I;C.a.Bua(u.nP,r.a.B_g,1);E[n.a.status]=6}C.a.I2d(E)}}Z5d(u,E,H){let I=null;E.Cx===u.id.toString()&&H&&E.UZb<H.length&&(u=H.substring(0,E.UZb)+E.text,u=u.replace(RegExp("\\u00a0","g")," "),H=H.replace(RegExp("\\u00a0","g")," "),0<u.length&&0<H.length&&(u.indexOf(H)||(I=u.substring(H.length,u.length))));return I}static get LS(){return k.a.instance}}A.tVh=4;A.gvd=new Z.a;Object(K.a)(A,"WordPredictionAugLoopResponseManager",null,[])},905:function(K,Z,d){d.d(Z,
"a",function(){return k});K=d(0);class k{constructor(){this.Cx=this.Bya=this.id=null;this.nP=this.Qmd=0;this.B8=this.text=null;this.lMb=this.m0e=this.n0e=this.score=this.y6a=this.UZb=0;this.ZHe=null}}Object(K.a)(k,"Candidate",null,[])},906:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k{constructor(){this.stateUpdateHandler=this.handler=this.config=this.annotationType=null}}Object(K.a)(k,"ActivateAnnotationParameters",null,[])},907:function(K,Z,d){d.d(Z,"a",function(){return e});K=
d(0);Z=d(602);var k=d(127);class e extends Z.a{constructor(){super();this.tokenRange=this.predictions=this.modelInfo=this.characterRange=null;this.H_=Object.assign(new k.a,{T_:e.getTypeName(),B_:e.getBaseTypes()})}static getTypeName(){return"AugLoop_Text_TextPredictionAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}Object(K.a)(e,"TextPredictionAnnotation",Z.a,[])},908:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k{constructor(){this.operation=null}}Object(K.a)(k,
"SubmitOperationParameters",null,[])},909:function(K,Z,d){d.d(Z,"a",function(){return e});K=d(0);Z=d(256);var k=d(127);class e extends Z.a{constructor(){super();this.timestamp=this.targetObject=null;this.H_=Object.assign(new k.a,{T_:e.getTypeName(),B_:e.getBaseTypes()})}static getTypeName(){return"AugLoop_Signals_Signal"}static getBaseTypes(){return[]}}Object(K.a)(e,"Signal",Z.a,[])},910:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k extends Sys.EventArgs{constructor(e,n,r){super();
this.actionId=e;this.Tyb=n;this.revisionId=r}}Object(K.a)(k,"UndoRedoMarkedUndoEventArgs",Sys.EventArgs,[])},911:function(K,Z,d){d.d(Z,"c",function(){return v});d.d(Z,"b",function(){return C});d.d(Z,"a",function(){return w});var k=d(17),e=d(382),n=d(25),r=d(33);const v=z=>{if(!z)return null;let A;try{A=r.b(z)}catch(u){A=null,e.ULS.sendTraceTag(578352835,202,15,"MruActor.TryDeserializeMruV2Response: SecureDeserialize Exception: {0}",u)}return A},C=(z,A)=>{let u=[];if(z.breadcrumbs&&0<z.breadcrumbs.length)u=
z.breadcrumbs;else{const E=z.service_info;E&&E.friendly_service_name&&Array.add(u,E.friendly_service_name);z.display_path&&Array.addRange(u,z.display_path)}return u.join(A?" \u00ab ":" \u200f\u00bb ")},w=(z,A=!1)=>{if(!z)return[];if(!z.documents)return e.ULS.sendTraceTag(578352838,202,15,"missing documents object"),[];if(!z.documents.items)return e.ULS.sendTraceTag(578352839,202,15,"missing items object"),[];z=z.documents.items;const u=new k.a;for(let H=0;H<z.length;H++){const I=z[H];var E=I.web_url;
if(!E){e.ULS.sendTraceTag(578320064,202,15,"Empty web_url");if(!I.url){e.ULS.sendTraceTag(578140248,202,15,"Empty url");continue}E=String.format("{0}?web=1",I.url)}const J={};J.DocumentUrl=E;J.MruId=I.mru_id;{E=I;let T=E.title;T?(E.extension&&(T=String.format("{0}.{1}",T,E.extension)),E=T):(e.ULS.sendTraceTag(578352837,202,15,"empty file title"),E="")}J.FileName=E;J.IsPinned=I.is_pinned;J.Path=C(I,n.AFrameworkApplication.isRtl);A&&(J.App=I.app,J.TimeStamp=I.time_stamp);u.add(J)}return u.toArray()}},
912:function(K,Z,d){d.d(Z,"a",function(){return z});K=d(0);var k=d(382),e=d(1006),n=d(1186),r=d(13),v=d(17),C=d(38),w=d(34);class z{constructor(A,u,E,H,I,J,T,D,R){this.wR=new e.a;this.HPg=A;this.Sb=u;this.aB=I;this.Ea=E;this.Zc=J;this.Zac=T;this.Xl=H;this.Hh=D;this.la=R;this.NBj()}get Kd(){return this.Zc.instance}get sF(){return this.Zac.value}NBj(){this.wR.$(0,[ResourceStrings.l_PhTypeCenterTitle,ResourceStrings.l_ClickToAddTitle]);this.wR.$(1,[ResourceStrings.l_PhTypeBody,ResourceStrings.l_ClickToAddText]);
this.wR.$(2,[ResourceStrings.l_PhTypeCenterTitle,ResourceStrings.l_ClickToAddTitle]);this.wR.$(3,[ResourceStrings.l_PhTypeSubTitle,ResourceStrings.l_ClickToAddSubTitle]);this.wR.$(8,[ResourceStrings.l_PhTypeObject,ResourceStrings.l_ClickToAddText]);this.wR.$(9,[ResourceStrings.l_PhTypeGraph,ResourceStrings.l_InsertContent]);this.wR.$(10,[ResourceStrings.l_PhTypeTable,ResourceStrings.l_InsertContent]);this.wR.$(11,[ResourceStrings.l_PhTypeClipArt,ResourceStrings.l_InsertContent]);this.wR.$(12,[ResourceStrings.l_PhTypeSmartArt,
ResourceStrings.l_ClickToAddSmartArt]);this.wR.$(13,[ResourceStrings.l_PhTypeMedia,ResourceStrings.l_InsertContent]);this.wR.$(15,[ResourceStrings.l_PhTypePicture,ResourceStrings.l_ClickToAddPicture]);this.wR.$(6,[ResourceStrings.l_PhTypeFooter,ResourceStrings.l_ClickToAddFooter]);this.wR.$(5,[ResourceStrings.l_PhTypeSlideNumber,ResourceStrings.l_ClickToAddSlideNumber])}h4f(A,u){A&&(this.$ca(A,u),A.nua?u.insert(0,document.createTextNode(ResourceStrings.l_ShapeObject)):this.R7d(A,null,u));return null}Nhj(A){if(!this.HPg.instance||
!A)return null;A=this.HPg.instance.m4f(A);if(!A||!A.length)return null;const u=A.length;return 1===u?String.format(ResourceStrings.l_ShapePresenceForOneUser,A[0].userName):2===u?String.format(ResourceStrings.l_ShapePresenceForTwoUsers,A[0].userName,A[1].userName):3===u?String.format(ResourceStrings.l_ShapePresenceForThreeUsers,A[0].userName,A[1].userName,A[2].userName):String.format(ResourceStrings.l_ShapePresenceForFourOrMoreUsers,u)}B9d(A){let u="";A&&A.QN&&A.image.title&&0<A.image.title.length&&
(u=A.image.title);A&&(u=String.format(ResourceStrings.l_ThumbnailInfoNew,A.slideIndex+1,this.Sb.Lj(),u),A=this.dlj(A),0<A.length&&(u+=A));return u}dlj(A){const u=new Sys.StringBuilder;A.isSelected&&u.append(ResourceStrings.L_SlideIsSelected);A.an&&u.append(ResourceStrings.l_SlideIsHidden);const E=Object(n.a)(116,A.Fd);if(E){var H=E.GSa();H&&!this.Xl.ije(H)&&u.append(ResourceStrings.l_SlideHasNotes);(H=E.SD())&&this.aB.instance&&this.aB.instance.H9f(H)&&(H=this.aB.instance.YQc(H),u.append(1===H?ResourceStrings.l_SlideHasOneComment:
String.format(ResourceStrings.l_SlideHasCommentsWithCount,H)))}A.xQ&&u.append(ResourceStrings.l_SlideHasAnimationOrTransition);if(A.mhb&&(A=A.mhb.x8())&&0<A.length)if(1===A.length)u.append(String.format(ResourceStrings.l_SlideHasPresenceForOneUser,A[0].userName));else{H="";for(const I of A)H+=I.userName+",";u.append(String.format(ResourceStrings.l_SlideHasPresenceForTwoOrMoreUsers,H))}E&&E.isUnread&&u.append(ResourceStrings.l_RevisionTracking_SlideHasUnreadChanges);return u.toString()}w9a(A,u){return String.format(ResourceStrings.l_MultipleSlidesSelected,
A,u)}K6i(A,u){return String.format(ResourceStrings.l_DesignerSuggestionSelected,A+1,u)}nij(){return ResourceStrings.l_SlidePanel}ccj(){return ResourceStrings.l_MultipleShapes}QPk(A){A&&(this.la.u6a&&A.D5(Object(r.a)(this,this.i3i,"getCameoAccMessage")),A.D5(Object(r.a)(this,this.$jj,"getTableAccMessage")),A.D5(Object(r.a)(this,this.Q9i,"getImageAccMessage")),A.D5(Object(r.a)(this,this.kbj,"getMediaAccMessage")),A.D5(Object(r.a)(this,this.y3i,"getChartAccMessage")),this.Qod?(A.D5(Object(r.a)(this,
this.F4f,"getSmartArtAccMessage")),A.D5(Object(r.a)(this,this.R7d,"getPlaceHolderAccMessage"))):(A.D5(Object(r.a)(this,this.R7d,"getPlaceHolderAccMessage")),A.D5(Object(r.a)(this,this.F4f,"getSmartArtAccMessage"))),A.D5(Object(r.a)(this,this.Tkj,"getTextboxAccMessage")),A.D5(Object(r.a)(this,this.Chj,"getShapeGroupAccMessage")),A.D5(Object(r.a)(this,this.zhj,"getShapeAccMessage")),A.D5(Object(r.a)(this,this.r1i,"getAddinAccMessage")),A.D5(Object(r.a)(this,this.X0i,"get3DAccMessage")))}R7d(A,u,E,H=
null){if(A&&E&&A.gl&&(this.LTc(A,E),u=A.get_altTitle(),this.wR.Hb(A.Gj))){H&&H(String.format("{0} {1}",this.wR.ga(A.Gj)[0],ResourceStrings.l_Placeholder));if(A.xT||!E.count){E=this.wR.ga(A.Gj)[0];H="";if(!this.Qod||A.xT)H=this.wR.ga(A.Gj)[1];return String.format(A.get_alt()?ResourceStrings.l_AccMessagePlaceHolderPromptAlt:ResourceStrings.l_AccMessagePlaceHolderPrompt,E,u,H,A.get_alt())}A=String.format(A.get_alt()?ResourceStrings.l_AccMessagePlaceHolderTextAlt:ResourceStrings.l_AccMessagePlaceHolderText,
this.wR.ga(A.Gj)[0],u,A.get_alt());E.insert(0,document.createTextNode(A))}return null}Tkj(A,u,E,H=null){if(A&&E&&A.lx)if(this.LTc(A,E),H&&H(ResourceStrings.L_TextBox),0<E.count)A=String.format(A.get_alt()?ResourceStrings.l_AccMessageTextboxHasTextAlt:ResourceStrings.l_AccMessageTextboxHasText,A.get_altTitle(),A.get_alt()),E.insert(0,document.createTextNode(A));else return String.format(A.get_alt()?ResourceStrings.l_AccMessageTextboxNoTextAlt:ResourceStrings.l_AccMessageTextboxNoText,A.get_altTitle(),
A.get_alt());return null}F4f(A,u,E,H=null){if(A&&E&&A.Rf)if(this.LTc(A,E),H&&H(ResourceStrings.L_SmartArt),0<E.count)A=String.format(A.get_alt()?ResourceStrings.l_AccMessageSmartArtHasTextAlt:ResourceStrings.l_AccMessageSmartArtHasText,this.H4f(A)||"",A.get_altTitle(),A.get_alt()),E.insert(0,document.createTextNode(A));else return String.format(A.get_alt()?ResourceStrings.l_AccMessageSmartArtNoTextAlt:ResourceStrings.l_AccMessageSmartArtNoText,this.H4f(A)||"",A.get_altTitle(),A.get_alt());return null}$ca(A,
u){A&&u&&this.Ea.DJ(A,E=>{E.Sa(C.a.pq)&&this.T0f(E,u)})}LTc(A,u){if(A&&u){const E=this.Qod?new v.a:u;let H=!1;this.Ea.DJ(A,I=>{const J=this.Hh.VW(I),T=this.Hh.Kgb(I);J&&E.add(document.createTextNode(String.format(ResourceStrings.l_AccMessageTextLevel,T)));H=this.T0f(I,E)||H});this.Qod&&H&&u.addRange(E);u.count||(A=A.q_e)&&u.add(document.createTextNode(A))}}get Qod(){return w.a("AriaMessageHelper.FixAccMessageForEmptyList")}T0f(A,u){let E;const H=A.sa(C.a.nsc,null),I=A.sa(C.a.pq,"");if(I&&u){if(H){let J=
0,T=null,D;for(let R=0;R<H.length+1;R++)D=this.Ea.hSc(A,R),T&&T!==D&&(E=document.createElement("span"),E.setAttribute("lang",T),E.innerText=I.substring(J,H[R-1]),J=H[R-1],u.add(E)),T=D;E=document.createElement("span");T&&E.setAttribute("lang",T);E.innerText=I.substring(J,I.length)}else E=document.createElement("span"),(A=this.Ea.hSc(A,0))&&E.setAttribute("lang",A),E.innerText=I;u.add(E)}return!!I&&0<I.length}$jj(A,u,E,H=null){return A&&A.ud?(H&&H(ResourceStrings.L_Table),String.format(A.get_alt()?
ResourceStrings.l_AccMessageTableAlt:ResourceStrings.l_AccMessageTable,A.get_altTitle(),A.get_alt())):null}Q9i(A,u,E,H=null){return A&&A.Ej?(H&&H(ResourceStrings.l_Image),String.format(A.get_alt()?ResourceStrings.l_AccMessageImageAlt:ResourceStrings.l_AccMessageImage,A.get_altTitle(),A.get_alt())):null}i3i(A,u,E,H=null){if(!A||!A.eFa)return null;H&&H(ResourceStrings.l_Cameo);return A.get_alt()?String.format(ResourceStrings.l_AccMessageCameoAlt,A.get_altTitle(),A.get_alt(),ResourceStrings.l_CameoLearnMoreMessage):
String.format(ResourceStrings.l_AccMessageCameo,A.get_altTitle(),ResourceStrings.l_CameoLearnMoreMessage)}kbj(A,u,E,H=null){if(A){if(0===A.mediaType)return null;if(1===A.mediaType)return H&&H(ResourceStrings.l_Audio),this.la.VP?String.format(ResourceStrings.l_AccMessageCanvasAudio,A.shapeName):String.format(A.get_alt()?ResourceStrings.l_AccMessageAudioAlt:ResourceStrings.l_AccMessageAudio,A.get_altTitle(),A.get_alt());if(2===A.mediaType)return H&&H(ResourceStrings.l_Video),String.format(A.get_alt()?
ResourceStrings.l_AccMessageVideoAlt:ResourceStrings.l_AccMessageVideo,A.get_altTitle(),A.get_alt())}return null}y3i(A,u,E,H=null){return A&&A.ar?(H&&H(ResourceStrings.l_Chart),String.format(A.get_alt()?ResourceStrings.l_AccMessageChartAlt:ResourceStrings.l_AccMessageChart,this.z3i(A)||"",A.get_altTitle(),A.get_alt())):null}Chj(A,u,E,H=null){return A&&A.Jf?(H&&H(ResourceStrings.L_GroupObjects),w.a("GroupShapeAltTitleFixEnabled")?String.format(A.get_alt()?ResourceStrings.l_AccMessageShapeGroupAlt:
ResourceStrings.l_AccMessageShapeGroup,A.Yw().length,A.get_alt()):String.format(A.get_alt()?ResourceStrings.l_AccMessageShapeGroupAlt:ResourceStrings.l_AccMessageShapeGroup,A.get_altTitle(),A.get_alt())):null}zhj(A,u,E,H=null){if(A&&E&&A.nua&&!A.lx)if(this.LTc(A,E),u=this.Ea.o4f(A),A.TEa&&(u=ResourceStrings.l_DecorativeLabel),H&&H(u||ResourceStrings.l_TextShape),0<E.count)A=String.format(A.get_alt()?ResourceStrings.l_AccMessageShapeHasTextAlt:ResourceStrings.l_AccMessageShapeHasText,u||ResourceStrings.l_TextShape,
A.get_altTitle(),A.get_alt()),E.insert(0,document.createTextNode(A));else return String.format(A.get_alt()?ResourceStrings.l_AccMessageShapeNoTextAlt:ResourceStrings.l_AccMessageShapeNoText,u||ResourceStrings.l_TextShape,A.get_altTitle(),A.get_alt());return null}r1i(A,u,E,H=null){return A&&A.Cq&&this.Kd&&this.sF?(A=this.sF.R2(A),A=this.Kd.Dvb(A.id),H&&H(A?A.Xba:null),A?A.Xba:null):null}X0i(A,u,E,H=null){return A&&A.I3?(H&&H(ResourceStrings.l_3DModel),String.format(A.get_alt()?ResourceStrings.l_AccMessage3DAlt:
ResourceStrings.l_AccMessage3D,A.get_altTitle(),A.get_alt())):null}H4f(A){return A.smartArtInfo?z.D8d(A.smartArtInfo.SmartArtLayout,1,177,"L_SAType"):(k.ULS.sendTraceTag(588375196,815,10,"SmartArt {0}#{1} has no SmartArtInfo",A.slideId?A.slideId.toString():"",A.get_shapeId()),null)}z3i(A){return z.D8d(A.Hsb,0,102,"L_ChartType")}Ohj(A,u){return(A=this.Ea.aTc(A))&&u?String.format(ResourceStrings.l_RevisionTracking_ShapeHasUnreadChanges,u,A):null}static Skj(A){return z.D8d(A,1,177,"L_SAType")}static D8d(A,
u,E,H){return A>=u&&A<=E&&(A=ResourceStrings[H+A])?A:null}}Object(K.a)(z,"AriaMessageHelper",null,[1016])},913:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k{constructor(e,n=null,r=null,v=null,C=!1,w=null){this.DisplayName=this.ClientId=this.Provider=this.UserId=null;this.IsAnonymous=!1;this.Email=null;this.UserId=e;this.Provider=n;this.DisplayName=r;this.Email=v;this.IsAnonymous=C;this.ClientId=w}}Object(K.a)(k,"Person",null,[])},914:function(K,Z,d){d.d(Z,"a",function(){return k});
K=d(0);class k{static x3k(){}static iIi(){}}k.sendTraceTag=k.x3k;k.debugAssertTag=k.iIi;Object(K.a)(k,"BULS",null,[])},915:function(K,Z,d){d.d(Z,"a",function(){return v});K=d(0);var k=d(996),e=d(25),n=d(164),r=d(55);class v{constructor(C,w,z,A,u,E){this.zba=C;this.Aba=w;this.kBd=z;this.pP=A;this.Rwc=u;this.pmb=E}get Quh(){return!this.Aba&&!this.kBd}get t0g(){return 2===this.pmb?CommonUIStrings.l_OICErrorC2ROneNoteOffer:CommonUIStrings.l_OICErrorC2ROffer}get id(){return"OICErrorDialogWithTrial"}get OQf(){return CommonUIStrings.l_OICErrorMessageNoOffice}get Cag(){return CommonUIStrings.l_OICErrorIHaveOfficeButton}get BTa(){return CommonUIStrings.l_OICErrorHelpLink}get B$f(){return"OICFailure"}get icon(){return 3}get ypf(){return 2===
this.pmb?CommonUIStrings.l_OICErrorC2RInstallOneNoteButton:CommonUIStrings.l_OICErrorC2RInstallButton}get $Qa(){return CommonUIStrings.l_DefaultDialogTitle}BLk(C){this.E0g(C)}eYj(C){this.E0g(C)}E0g(C){let w=10;1===C?(r.a.instance.resolve("Common.IOfficeTrialExperience").bme(this.pmb),w=3):2===C&&((!this.kBd||this.kBd(this.pP))&&this.Aba&&k.a.instance.cEi(this.Aba,this.zba,this.pP),w=5);(0===C||1===C)&&this.zba&&this.zba(this.pP);e.AFrameworkApplication.qib(n.a.m7g,this.Rwc,w);this.dispose()}dispose(){this.pP=
this.Aba=this.zba=null}}Object(K.a)(v,"AOICErrorDialogWithTrial",null,[106])},916:function(K,Z,d){d.d(Z,"b",function(){return r});d.d(Z,"g",function(){return v});d.d(Z,"d",function(){return C});d.d(Z,"f",function(){return z});d.d(Z,"e",function(){return A});d.d(Z,"c",function(){return u});d.d(Z,"a",function(){return E});var k=d(25);d(710);var e=d(1102),n=d(518);d(466);const r=()=>k.AFrameworkApplication.isEmbedded,v=()=>{const H=k.AFrameworkApplication.Aa.hb.WN;return!r()&&!k.AFrameworkApplication.hideHeader&&
n.a()&&(H||1===k.AFrameworkApplication.YZi)},C=()=>k.AFrameworkApplication.fa.ka("DiscoverPremiumButtonEnabled"),w=()=>k.AFrameworkApplication.Rth&&!r()&&!k.AFrameworkApplication.hideHeader,z=()=>w()&&"officecomhwa"!==(k.AFrameworkApplication.fa.Ha(k.AFrameworkApplication.YJ)||"").toLowerCase()&&!k.AFrameworkApplication.G$f,A=()=>!k.AFrameworkApplication.$ae&&w(),u=()=>!r()&&!k.AFrameworkApplication.hideHeader&&k.AFrameworkApplication.fa.ka("BasicChatIsEnabled"),E=()=>{if(k.AFrameworkApplication.$$f)return null;
var H=!!k.AFrameworkApplication.Aa&&k.AFrameworkApplication.Aa.hb.WN;if((k.AFrameworkApplication.Vje&&k.AFrameworkApplication.RZa||k.AFrameworkApplication.Rtc)&&H)return Object.assign(new e.a,{command:"1197060601",label:CommonUIStrings.l_ReplyWithChanges,id:d(263).CuiHelper.Ekd});if(k.AFrameworkApplication.workflowEnabled){H="";switch(k.AFrameworkApplication.suc){case "Assign":H=CommonUIStrings.l_Assign;break;case "Submit":H=CommonUIStrings.l_Submit}if(""!==H)return Object.assign(new e.a,{command:"2988588587",
label:H,id:"btnWorkflow"})}return null}},917:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k{}Object(K.a)(k,"RibbonPeripheralSection",null,[])},918:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k{constructor(){this.isForAlertableKpi=this.extendedProperties=null}}Object(K.a)(k,"IKpiUsageOptionalProperties",null,[])},919:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k{constructor(){this.kpiName=null;this.kpiType=0;this.blockFutureEmissionDurationInMs=this.optionalProperties=
null}}Object(K.a)(k,"KpiUsageParams",null,[])},920:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k{constructor(){this.doNotEmitAggregatedCount=this.areaName=this.vetoPillar=this.crewAlias=this.featureName=this.topLevelKpiName=null}}Object(K.a)(k,"FeatureUsageAndHealthConfig",null,[])},921:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k{constructor(){this.onFullRenderComplete=this.useCoachmark=this.jumpToCalloutTargetButtonEnabled=this.hasDynamicSizing=this.preventLightDismiss=
this.useTeachingStyles=this.hasFocusableControls=this.calloutProps=this.showCloseIcon=this.secondaryButtonProps=this.primaryButtonProps=this.title=this.content=this.target=null}}Object(K.a)(k,"CalloutParameters",null,[])},922:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k{}Object(K.a)(k,"ICalloutProps",null,[])},923:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k{}k.IsFreeForm="IsFreeForm";k.Value="Value";k.Key="Key";k.FontStyle="FontStyle";Object(K.a)(k,"ComboBoxCommandProperties",
null,[])},924:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k{}k.Alt="Alt";k.CommandValueId="CommandValueId";k.InnerHTML="InnerHTML";k.On="On";k.IsRtl="IsRtl";k.GalleryButtonProps="GalleryButtonProps";k.Text="Text";k.HighlightOn="HighlightOn";Object(K.a)(k,"GalleryButtonCommandProperties",null,[])},925:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);d=d(251);class k extends d.a{constructor(){super();this.OnRetryCommandId=this.RetryButtonTitle=this.IconName=this.Label=null}get ControlType(){return 12}}
Object(K.a)(k,"ErrorViewProps",d.a,[])},926:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k{}Object(K.a)(k,"PersonaInfo",null,[])},927:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k{}Object(K.a)(k,"PersonaIdentifiers",null,[])},928:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k{constructor(e){this.xn=e}O3d(e){const n=[];if(e)for(let C in e){var r=C,v=e[C];const w=this.xn.u5d(r);if(w)for(let z of w)n.push(appChrome.actions.updateControlHiddenState(z,v));
else if(r=this.xn.p9i(r))for(const z of r)if(z.externalUxCommandIds)for(const A of z.externalUxCommandIds)n.push(appChrome.actions.updateControlHiddenState(A,v));else n.push(appChrome.actions.updateGroupHiddenState(z.externalUxGroupId,v))}return n}h1i(e){const n=[];if(e)for(let r in e){if(!e[r])continue;const v=r;v&&n.push(appChrome.actions.deactivateRibbonTab(v))}return n}}Object(K.a)(k,"ReactRibbonTrimmingHelper",null,[])},929:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k{constructor(){this.neighborhood=
null;this.mentionLength=this.mentionStart=0}}Object(K.a)(k,"InsightsParameters",null,[])},930:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k{}k.cKf="data-ccp-timestamp";k.dKf="data-clipservice-ccpid";k.hKf="data-shapeids";k.i7f="docs-internal-guid-";k.Y6g="SCXO";k.iah="SCXP";k.eJh="SCXW";k.KZg="MsoListParagraphCxSpFirst";k.LZg="MsoListParagraphCxSpLast";Object(K.a)(k,"HtmlContentMetadataConstants",null,[])},931:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k extends Sys.EventArgs{constructor(e){super();
this.slideId=e.SlideId;this.slideIndex=e.SlideIndex;this.dIj=e.IsBeforeReady;this.YLj=e.IsFromEndOfSlideshow;this.summary=e.Summary}}Object(K.a)(k,"OnExitSlideshowEventArgs",Sys.EventArgs,[])},932:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k extends Sys.EventArgs{constructor(e){super();this.key=e.Key;this.shiftKey=e.ShiftKey}}Object(K.a)(k,"OnSpecialKeyEventArgs",Sys.EventArgs,[])},933:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k extends Sys.EventArgs{constructor(e){super();
this.clientX=e.ClientX;this.clientY=e.ClientY}}Object(K.a)(k,"OnBrowserEventArgs",Sys.EventArgs,[])},934:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k extends Sys.EventArgs{constructor(e){super();this.slideId=e.SlideId;this.slideIndex=e.SlideIndex;this.Gsc=e.TimeLineMappings}}Object(K.a)(k,"OnGetCurrentPositionEventArgs",Sys.EventArgs,[])},935:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k extends Sys.EventArgs{constructor(e){super();this.slideHeight=e.SlideHeight;
this.slideWidth=e.SlideWidth;this.ewh=e.SlideLeftBound;this.bwh=e.SlideBottomBound}}Object(K.a)(k,"OnGetCurrentSlideDimensionsEventArgs",Sys.EventArgs,[])},936:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k extends Sys.EventArgs{constructor(e){super();this.clientX=e.ClientX;this.clientY=e.ClientY}}Object(K.a)(k,"OnSlideshowContextMenuEventArgs",Sys.EventArgs,[])},937:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k extends Sys.EventArgs{constructor(e){super();this.isVisible=
e.IsVisible}}Object(K.a)(k,"OnVisibilityChangeEventArgs",Sys.EventArgs,[])},938:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k extends Sys.EventArgs{constructor(e){super();this.code=e.Code;this.reason=e.Reason;this.podSessionId=e.PodSessionId}}Object(K.a)(k,"OnPodSessionExpiredEventArgs",Sys.EventArgs,[])},939:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k extends Sys.EventArgs{constructor(e){super();this.slideId=e.SlideId;this.slideIndex=e.SlideIndex;this.Gsc=e.TimeLineMappings}}
Object(K.a)(k,"OnPositionChangedEventArgs",Sys.EventArgs,[])},940:function(K,Z,d){d.d(Z,"a",function(){return e});K=d(0);var k=d(1186);class e extends Sys.EventArgs{constructor(n){super();this.YBh=null;this.YBh="string"===typeof n?Object(k.a)(String,n):n.TranscriberSessionId}}Object(K.a)(e,"OnTranscriberStartedEventArgs",Sys.EventArgs,[])},941:function(K,Z,d){d.d(Z,"a",function(){return z});K=d(0);var k=d(382),e=d(268),n=d(25),r=d(172),v=d(54),C=d(45),w=d(224);class z{static X4f(A){const u={};u.appSettings=
z.SAi();u.singleSignOnSettings=z.v4f();u.appVersion="16";u.appUILocale=e.a.ue(n.AFrameworkApplication.lcid).ovb;u.dataLocale=e.a.ue(n.AFrameworkApplication.lcid).ovb;u.osfOmexBaseUrl=n.AFrameworkApplication.fa.Ha("50");u.firstPartyManifestCDNUrl=n.AFrameworkApplication.fa.Ha("565");u.sdxCdnUrl=n.AFrameworkApplication.fa.Ha("649");u.sdxDmsUrl=n.AFrameworkApplication.fa.Ha("650");u.sdxAssetsToPrefetchMapping=n.AFrameworkApplication.fa.Ha("974");u.docUrl=A?A.documentUrl:"";u.pageBaseUrl=r.a.fP;u.lcid=
n.AFrameworkApplication.lcid.toString();u.allowExternalMarketplace=n.AFrameworkApplication.fa.ka("51");u.localizedScriptsUrl=r.a.fP+n.AFrameworkApplication.fa.Ha("52");A=A?A.Zag:"";u.localizedImagesUrl=r.a.fP+A;u.localizedStylesUrl=r.a.fP+A;u.localizedResourcesUrl=r.a.U2h(A);u.enableAddinCommands=n.AFrameworkApplication.fa.ka("203");u.enableMyApps=n.AFrameworkApplication.fa.ka("186");u.enableMyOrg=n.AFrameworkApplication.fa.ka("187");u.enableUploadFileDevCatalog=n.AFrameworkApplication.fa.ka("203")&&
!n.AFrameworkApplication.fa.ka("847");u.enableDevCatalog=n.AFrameworkApplication.fa.ka("221");u.devCatalogUrl=n.AFrameworkApplication.fa.Ha("220");u.enablePrivateCatalog=n.AFrameworkApplication.fa.ka("305");u.showSignOutFromPrivateCatalogMessage=n.AFrameworkApplication.fa.ka("307");u.enableBlackForestRedirect=n.AFrameworkApplication.fa.ka("348");u.enableSingleSignOnForAddin=n.AFrameworkApplication.fa.ka("342")&&n.AFrameworkApplication.EHj;u.enableTaskpaneUpgradeToAppCommand=n.AFrameworkApplication.fa.ka("381");
u.hideAppsExtensionUrl=n.AFrameworkApplication.hideAppsExtensionUrl;u.enableAnonymousUseLegacyCatalogService=n.AFrameworkApplication.fa.ka("549");u.enableInsertDialogAccessibilityFix=n.AFrameworkApplication.fa.ka("584");u.enableFirstPartySDXErrorMessages=n.AFrameworkApplication.fa.ka("677");u.disableAppsForOfficeThirdParty=n.AFrameworkApplication.fa.ka("569");u.wacSessionId=n.AFrameworkApplication.userSessionId;u.disableLogging=!n.AFrameworkApplication.fa.ka("AriaLoggingIsEnabled");u.loggableUserId=
n.AFrameworkApplication.fa.Ha("LoggableUserId");u.sessionStartInfoJson=n.AFrameworkApplication.fa.Ha("SessionStartInfoJson");u.wopiHostOriginFromPostMessage=n.AFrameworkApplication.wopiHostOriginFromPostMessage;u.wopiHostOriginFromWacPropBag=n.AFrameworkApplication.fa.Ha("PostMessageOrigin");u.wacIsEmbedded=n.AFrameworkApplication.fa.ka("IsEmbedded");u.accessibilityAllowFocusAddinTaskpane=n.AFrameworkApplication.fa.ka("1055");u.disableMicrophonePermission=v.a.YN(1)&&n.AFrameworkApplication.fa.ka("TranscriberSafariEnabled")&&
n.AFrameworkApplication.fa.ka("RehearsalSafariEnabled");u.isHostFrameTrustCheckEnabledForAddIns=n.AFrameworkApplication.fa.ka("1100");u.isHostFrameTrusted=n.AFrameworkApplication.isHostFrameTrusted;u.hostAllowedSdxEmbedding=n.AFrameworkApplication.fa.ka("HostAllowedSdxEmbedding");u.hostAllowedOfficeStore=n.AFrameworkApplication.fa.ka("HostAllowedOfficeStore");u.hostInstallAddIns=n.AFrameworkApplication.fa.Ha("HostInstallAddIns");u.hostInstallAddInsIsEnabled=n.AFrameworkApplication.fa.ka("HostInstallAddInsIsEnabled");
u.approvedAddIns=n.AFrameworkApplication.fa.Ha("ApprovedAddIns");u.isUpnCheckEnabled=n.AFrameworkApplication.fa.ka("1132");u.wacUpn=n.AFrameworkApplication.fa.Ha("UserPrincipalName");u.isReactRibbonEnabled=!0;u.enableSetFocusOnTaskpaneOnUserAction=n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.SetFocusOnTaskpaneOnUserActionIsEnabled",!1);u.enableMyOrg&&u.docUrl&&(A=u.docUrl.split("/"),u.spBaseUrl=2<A.length?A[0]+"//"+A[2]:null,u.spBaseUrl||k.ULS.sendTraceTag(512263002,
806,10,String.format("Failed to parse SpBaseUrl from DocUrl: {0}",u.docUrl)));u.userNameHashCode=C.a.iN(n.AFrameworkApplication.userName);u.envCode=n.AFrameworkApplication.fa.Fc("312",0).toString();return u}static SAi(){const A={};A.AddinRibbonIdAllowUnknown=n.AFrameworkApplication.fa.ka("AddinRibbonIdAllowUnknown");A.AddinRibbonNativeGroupControlIsEnabled=!0;A.AddinRibbonTabAutoFocusIsEnabled=!0;A.AddinRibbonTabPositionIsEnabled=!0;A.AgaveAddinUploadEnabled=n.AFrameworkApplication.fa.ka("AgaveAddinUploadEnabled");
A.DevConsoleEnabled=n.AFrameworkApplication.fa.ka("AddinDevConsoleLog");A.ManifestParserDevConsoleEnabled=!0;A.flightingTreatmentVariables=n.AFrameworkApplication.fa.pPc;return A}static v4f(){try{const A={};v.a.zFa&&w.OAuthManagerSettings.t$a&&(A.UiHostSupportsAuthTokenAddinList=z.lPc);A.UiHostSupportsAuthToken=w.OAuthManagerSettings.t$a;return A}catch(A){k.ULS.sendTraceTag(512263001,344,10,"GetSingleSignOnRuntimeSettings: exception message: {0}",A.message)}return null}}z.lPc="wa200000047 wa104381973 42de5e8d-cfa0-459d-813d-cf777d47ada0 97d94c7b-54e5-4098-8dbb-b486b6c1f049 wa104381526 d98404ac-f9e2-4292-8cb6-eec349559ae5".split(" ");
Object(K.a)(z,"AppForOfficeHelper",null,[])},942:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k extends Sys.EventArgs{constructor(e){super();this.h_g=e}}Object(K.a)(k,"CoauthorStatusChangedEventArgs",Sys.EventArgs,[])},943:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k{constructor(e,n,r){this.TXa={};this.FGg=e;this.wCb=n;this.Ddc=r}hEa(e,n,r,v){n=k.GKf;if(this.wCb)if(this.Ddc){const C=e.UserId?e.UserId.toLowerCase():null;r=r?r.toLowerCase():null;n=C&&C in this.TXa?
this.TXa[C]:r&&r in this.TXa?this.TXa[r]:this.FGg.hEa(e,v);!C||C in this.TXa||(this.TXa[C]=n);!r||r in this.TXa||(this.TXa[r]=n)}else n=this.FGg.hEa(e,v);return n}}k.GKf="#C0C0C0";Object(K.a)(k,"PresenceColorProvider",null,[506])},944:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k extends Sys.EventArgs{constructor(e){super();this.fG=e}}Object(K.a)(k,"BeforeSessionEndEventArgs",Sys.EventArgs,[])},945:function(K,Z,d){d.d(Z,"a",function(){return v});K=d(0);var k=d(1135),e=d(25),n=d(33),
r=d(78);class v{constructor(){this.BaseDocQuerySignature=null;this.RoamingApp=0}GKb(){return n.c([this.$k(),this])}execute(C,w,z){let A="RoamingAppsHandler.ashx";k.a.instance.bRe&&0<document.URL.toUpperCase().indexOf("WDENABLEROAMING=1")&&(A=r.a.Wi(A,"wdEnableRoaming","1"));e.AFrameworkApplication.Je.Aj(A,2,this.GKb(),{"Content-Type":"application/json; charset=utf-8"},!1,this.Ewb(),C,w,z,void 0,void 0,void 0,void 0,"6")}}Object(K.a)(v,"ARoamingAppsRequest",null,[])},946:function(K,Z,d){d.d(Z,"a",
function(){return 2});d.d(Z,"c",function(){return k});d.d(Z,"b",function(){return e});const k=(n,r,v=2)=>{let C;if(0>r||r>n[n.length-1])throw Error.argumentOutOfRange("y");C=!0;let w=0,z;const A=n.length-1;for(z=0;z<A;z++){const u=w;w=n[z+1];if(r<w){w-r<v&&z<A-1?z++:r-u>=v&&(C=!1);break}}return{returnValue:z<A?z:-1,oje:C}},e=(n,r,v=2)=>{let C;if(0>r||r>n[n.length-1])throw Error.argumentOutOfRange("x");C=!0;let w=0,z;const A=n.length-1;for(z=0;z<A;z++){const u=w;w=n[z+1];if(r<w){w-r<v&&z<A-1?z++:r-
u>=v&&(C=!1);break}}return{returnValue:z<A?z:-1,oje:C}}},947:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k{constructor(){this.uQa=this.qW=0;this.skipUndo=!1;this.Gp=this.selectionSlide=null;this.version=0;this.mD=this.location=null;this.dataType=0;this.Ric=null;this.objectCount=0;this.VEa=this.XEa=!1;this.ty=this.Dsa=this.nodes=null}toString(){const e=JSON.stringify(this.Dsa);return String.format("CcpId:{0}, version:{1}, DC:{2}, DataType:{3}, ObjectCount:{4}, Cut?:{5}, IsEPH?:{6}, ExtraData:[{7}], CopyStatus: {8}.",
this.Gp,this.version,this.mD,this.dataType,this.objectCount,this.XEa,this.VEa,e,this.qW)}}Object(K.a)(k,"ClipServiceObject",null,[])},948:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k{constructor(e,n){this.uu=e;this.Ub=n}}Object(K.a)(k,"ClipServiceCopyParams",null,[])},949:function(K,Z,d){d.d(Z,"a",function(){return v});K=d(0);var k=d(13),e=d(73),n=d(65),r=d(133);class v extends Sys.UI.Control{constructor(C,w,z,A){super(document.createElement("div"));this.I6=this.G6=this.$E=this.f2a=
this.gS=this.zMa=this.kOa=null;this.gSb=this.mNa=!1;this.content=this.PB=null;this.Qaa=0;this.jxf=null;this.OZ=0;this.afd=null;this.wnf=C;this.Nob=w;this.AP=z;this.lUd=A;this.hi=w.ownerDocument;this.c7b=this.yr=this.PSb=!1}get AJ(){this.kOa||(this.kOa=this.hi.createElement("div"),this.kOa.id=this.Nh("WACCalloutOuter"),this.kOa.className="WACCalloutOuter",this.kOa.setAttribute(r.a.af,r.a.jQd),this.kOa.style.width=this.Qaa+"px");return this.kOa}get Erb(){if(!this.zMa){this.zMa=this.hi.createElement("div");
this.zMa.id=this.Nh("WACCalloutBeakContainer");this.zMa.className="WACCalloutBeakContainer";var C="CalloutBeakTopFilled_32x16x32";if(5===this.OZ||6===this.OZ||4===this.OZ)C="CalloutBeakBottomFilled_32x16x32";C=e.createClusteredImage(32,16,C,"WACCalloutBeak",!0,"");this.zMa.appendChild(C)}return this.zMa}set Erb(C){this.zMa=C}get qL(){return this.PSb}get title(){return this.PB}set title(C){this.PB!==C&&(this.PB=C,this.G6&&(this.G6.innerText=this.PB))}get yr(){return this.mNa}set yr(C){this.mNa!==C&&
(this.mNa=C,this.gS&&(this.gS.contains(this.$E)&&!this.mNa?this.gS.removeChild(this.$E):!this.gS.contains(this.$E)&&this.mNa&&this.cqf()))}get c7b(){return this.gSb}set c7b(C){this.gSb!==C&&(this.gSb=C,this.gS&&(this.gS.contains(this.G6)&&!this.gSb?this.gS.removeChild(this.G6):!this.gS.contains(this.G6)&&this.gSb&&this.Drf()))}show(){this.PSb||(this.$Bi(),this.wfi(),this.Nob.appendChild(this.AJ),this.AJ.style.display="Block",this.pUe(),this.PSb=!0,this.afd&&this.afd())}dismiss(){this.PSb&&(this.vKi(),
this.Nob.removeChild(this.AJ),this.PSb=!1,this.lUd&&this.lUd())}dispose(){this.dismiss();this.G6=this.$E=this.f2a=this.zMa=this.gS=this.kOa=null;Sys.Component.prototype.dispose.call(this)}Nh(C){return this.get_element().id+C}$Bi(){this.gS=this.hi.createElement("div");this.gS.id=this.Nh("WACCalloutHeader");this.gS.className="WACCalloutHeader";this.yr&&this.cqf();this.c7b&&this.Drf();this.f2a=this.hi.createElement("div");this.f2a.id=this.Nh("WACCalloutContent");this.f2a.className="WACCalloutContent";
this.f2a.style.width=190<this.Qaa?this.Qaa-26+"px":"164px";this.f2a.appendChild(this.content);this.AJ.appendChild(this.Erb);this.AJ.appendChild(this.gS);this.AJ.appendChild(this.f2a)}cqf(){this.$E=this.hi.createElement("a");this.$E.className="WACCalloutCloseAnchor";this.$E.id=this.Nh("WACCalloutCloseAnchor");this.$E.href="#";this.gS.appendChild(this.$E);const C=e.createClusteredImage(16,16,"ClosePaneGlyph_16x16x32","WACCalloutCloseIcon",!0,CommonUIStrings.l_DialogClose);this.$E.appendChild(C)}Drf(){this.G6=
this.hi.createElement("div");this.G6.className="WACCalloutTitle UIFontBold";this.G6.style.width=190<this.Qaa?this.Qaa-30+"px":"160px";this.G6.id=this.Nh("WACCalloutTitle");this.G6.innerText=this.title;this.gS.contains(this.$E)?this.gS.insertBefore(this.G6,this.$E):this.gS.appendChild(this.G6)}pUe(){var C=this.wnf;let w;if(1===this.OZ){var z=this.jxf.y+16;w=-16}else 2===this.OZ||3===this.OZ||0===this.OZ?(z=C.y+C.height+15,w=-15):(z=C.y-this.AJ.clientHeight-15-2,w=this.AJ.clientHeight-1);this.AJ.style.top=
z+"px";this.Erb.style.top=w+"px";1===this.OZ?(C=this.jxf.x-16,this.AJ.style.left="50%",this.AJ.style.marginLeft=-this.Qaa/2+"px",z=Sys.UI.DomElement.getBounds(this.AJ),this.Erb.style.left=C-z.x+"px"):(z=C.x+this.wnf.width/2,2===this.OZ||5===this.OZ?(C=20,z-=36):0===this.OZ||4===this.OZ?(C=this.Qaa/2-16,z-=this.Qaa/2):(C=this.Qaa-20-32,z=z-this.Qaa+36),this.AJ.style.left=z+"px",this.Erb.style.left=C+"px")}wfi(){this.yr&&!this.I6&&(this.I6=Object(k.a)(this,this.P2,"closeHandler"),this.AP.pb(n.a.click,
this.$E,this.I6,null))}vKi(){this.yr&&this.I6&&(this.AP.yb(n.a.click,this.$E,this.I6),this.I6=null)}P2(){this.dismiss();return!0}}Object(K.a)(v,"Callout",Sys.UI.Control,[470])},950:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k{constructor(){this.algnField=0;this.algnFieldSpecified=!1;this.bevelField=null;this.capField=0;this.capFieldSpecified=!1;this.cmpdField=0;this.cmpdFieldSpecified=!1;this.tailEndField=this.solidFillField=this.roundField=this.prstDashField=this.pattFillField=
this.noFillField=this.miterField=this.headEndField=this.gradFillField=this.extLstField=this.custDashField=null;this.wField=0;this.wFieldSpecified=!1}}Object(K.a)(k,"CT_LineProperties",null,[])},951:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k{constructor(){this.valField=0;this.valFieldSpecified=!1}}Object(K.a)(k,"CT_PresetLineDashProperties",null,[])},952:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k{constructor(e){this.Tbk=e}get sqc(){return this.Tbk}}Object(K.a)(k,
"ShowHideNotesData",null,[])},953:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);d=d(886);class k extends d.a{constructor(e,n){super(n);this.$Eg=e;this.tdb=0}tSf(){const e=(new Date).getTime(),n=e-this.tdb;if(0<this.tdb&&0>=this.$Eg-n)return this.tdb=0,this.TSd(),!0;this.tdb=e;this.TSd();this.setTimeout(this.$Eg);return!1}}Object(K.a)(k,"FunctionDelayer",d.a,[])},954:function(K,Z,d){d.d(Z,"b",function(){return e});d.d(Z,"a",function(){return n});d.d(Z,"c",function(){return r});var k=d(45);
d(398);d(27);d(59);const e=(v,C)=>{const w=[];if(v.length!==C.length)return w;for(let z=0;z<v.length;z++){const A={};A.key=C[z];A.text=v[z];A.type="AppComboBoxItem";w[z]=A}return w},n=(v,C,w,z,A)=>({["unitType"]:v,["unitPlaceholder"]:k.a.ZIe(C),["minValue"]:w,["maxValue"]:z,["step"]:A}),r=v=>"1.00"===v?1:"1.50"===v?1.5:"2.00"===v?2:0},955:function(K,Z,d){d.d(Z,"a",function(){return v});K=d(0);var k=d(45),e=d(91),n=d(26),r=d(34);class v{constructor(C){this.Jma=null;this.Lec=0;this.Ncc=C;switch(this.Ncc){case "audio":this.Jma=
v.Udk;this.Lec=v.d4j;break;case "captions":this.Jma=v.Vdk;this.Lec=v.t4j;break;case "video":this.Jma=v.Wdk;this.Lec=v.cek;break;default:n.a.J(509727835,822,10,"Invalid file type")}}static set GCl(C){v.Wdk=C}static set BDl(C){v.cek=C}nqi(C){switch(this.Ncc){case "audio":return v.lqi(C);case "captions":return v.mqi(C);case "video":return r.a("DisableVideoAsFileCheck")?new Promise(w=>{w(!0)}):v.oqi(C);default:return n.a.J(509727834,822,10,"Invalid file type"),new Promise(w=>{w(!1)})}}UCl(C){C=k.a.og(C);
for(let w=0;w<this.Jma.length;++w){const z=this.Jma[w];if(z&&0<z.length&&C.endsWith(z))return!0}return!1}VCl(C){return C<=1048576*this.Lec}static lqi(C){return new Promise((w,z)=>{if(C&&C.size){var A=document.createElement("video"),u=URL.createObjectURL(C);A.setAttribute("src",u);e.a.addHandler(A,"loadedmetadata",()=>{URL.revokeObjectURL(u);const E=A.videoHeight,H=A.videoWidth;0<A.duration&&!E&&!H?w(!0):(n.a.J(509727832,822,10,"Invalid audio File"),w(!1))});e.a.addHandler(A,"error",()=>{URL.revokeObjectURL(u);
n.a.J(509727831,822,10,"Invalid audio File");z(ResourceStrings.L_InvalidAudioFileError)})}else n.a.J(509727833,822,10,"Empty media File"),w(!1)})}static mqi(C){return new Promise((w,z)=>{if(C&&C.size){var A=URL.createObjectURL(C),u=document.createElement("video"),E=document.createElement("track");u.appendChild(E);e.a.addHandler(E,"load",()=>{URL.revokeObjectURL(A);w(!0)});e.a.addHandler(E,"error",()=>{URL.revokeObjectURL(A);n.a.J(509727829,822,10,"Invalid captions File");z(ResourceStrings.l_InvalidCaptionsFileError)});
E.setAttribute("src",A);E.setAttribute("default","true")}else n.a.J(509727830,822,10,"Empty captions File"),w(!1)})}static oqi(C){return new Promise((w,z)=>{if(C&&C.size){var A=document.createElement("video"),u=URL.createObjectURL(C);A.setAttribute("src",u);e.a.addHandler(A,"loadedmetadata",()=>{URL.revokeObjectURL(u);const E=A.videoHeight,H=A.videoWidth;0<A.duration&&0<E&&0<H?w(!0):(n.a.J(509727837,822,10,"Invalid video File"),w(!1))});e.a.addHandler(A,"error",()=>{URL.revokeObjectURL(u);n.a.J(509727836,
822,10,"Invalid video File");z(ResourceStrings.L_InvalidVideoFileError)})}else n.a.J(509727838,822,10,"Empty media File"),w(!1)})}static u_f(C){return C&&C.value?C.files[0].size.toString():"Invalid number of files"}static z5d(C){if(!C||!C.value)return"Input file name is null";const w=C.value.lastIndexOf(".");return-1===w?"":C.value.substring(w+1,w+5)}}v.d4j=16;v.t4j=16;v.Vdk=[".vtt"];v.Udk=[".mp3",".wav",".m4a",".aac",".oga"];Object(K.a)(v,"MediaValidationHelper",null,[])},956:function(K,Z,d){d.d(Z,
"a",function(){return k});K=d(0);class k extends Sys.EventArgs{constructor(e){super();this.eSf=e}}Object(K.a)(k,"CommentContainersChangedEventArgs",Sys.EventArgs,[])},988:function(K,Z,d){d.r(Z);K=d(0);var k=d(76),e=d(45),n=d(91),r=d(65),v=d(25),C=d(1185),w=d(13),z=d(17),A=d(85),u=d(343),E=d(26),H=d(34);class I{constructor(Wa){this.ApiType=0;this.ApiType=Wa}}Object(K.a)(I,"SlideshowApiMessage",null,[]);class J extends I{constructor(){super(14);this.TopValue="0%";this.HeightValue="100%"}}Object(K.a)(J,
"DockSlideshowViewMessage",I,[]);class T extends I{constructor(){super(6);this.AnimStep=this.SlideIndex=0}}Object(K.a)(T,"GoToSlideApiMessage",I,[]);class D extends I{constructor(){super(16);this.SlideIndex=0;this.TimeLineMappings=null}}Object(K.a)(D,"GoToSlideWithTimeLinesApiMessage",I,[]);class R extends I{constructor(){super(19);this.Color=this.Item=null}}Object(K.a)(R,"InkManagerMessage",I,[]);class Q{constructor(Wa){this.pH=Wa.origin;this.BTg=Wa.source;this.ava=Wa.data}}Object(K.a)(Q,"MessageEvent",
null,[]);var W=d(933),O=d(931),Y=d(934),S=d(935);class da extends Sys.EventArgs{constructor(Wa){super();this.l$b=Wa.IsStartTranscription;this.Ov=Wa.SubtitlesPosition}}Object(K.a)(da,"OnLiveSubtitlesDockedViewEventArgs",Sys.EventArgs,[]);class fa extends Sys.EventArgs{constructor(Wa){super();this.Hx=Wa.SessionTelemetry}}Object(K.a)(fa,"OnLogEndOfTranscriptionSessionEventArgs",Sys.EventArgs,[]);var ka=d(938),ha=d(939),F=d(936);class na extends Sys.EventArgs{constructor(Wa,yb){super();this.xHj=Wa;this.category=
yb.Category;this.code=yb.Code;this.message=yb.Message;this.Py=yb.ExtraInfo;this.correlationId=yb.CorrelationId;this.sessionId=yb.SessionId}}Object(K.a)(na,"OnSlideshowErrorEventArgs",Sys.EventArgs,[]);var ba=d(932);class Ea extends Sys.EventArgs{constructor(Wa){super();this.isFinal=Wa.IsFinal;this.ZBh=Wa.Transcripts}}Object(K.a)(Ea,"OnSubtitleUpdatedEventArgs",Sys.EventArgs,[]);var La=d(940),ta=d(937);class oa extends Sys.EventArgs{constructor(Wa){super();this.errorName=Wa.ErrorName;this.vetoName=
Wa.VetoName;this.isIntentional=Wa.IsIntentional;this.isInternal=Wa.IsInternal;this.alertOnPillar=Wa.AlertOnPillar;this.isSessionEndingError=Wa.IsSessionEndingError;this.durationMs=Wa.DurationMs}}Object(K.a)(oa,"RecordQosErrorEventArgs",Sys.EventArgs,[]);class wa extends I{constructor(){super(11);this.StartSlideShowTime=0}}Object(K.a)(wa,"RecordStartedSlideShowTimestampApiMessage",I,[]);class ra extends I{constructor(){super(7);this.WacCluster=this.PodSessionId=null}}Object(K.a)(ra,"RefreshPodSessionApiMessage",
I,[]);class ya extends I{constructor(){super(21);this.IsMute=!1}}Object(K.a)(ya,"SetMicrophoneStateMessage",I,[]);class Da extends I{constructor(){super(12);this.OsfLocalStorageData=null}}Object(K.a)(Da,"SetOsfLocalStorageApiMessage",I,[]);class pa{constructor(){this.l$b=this.Ahg=!1;this.Ov=null}}Object(K.a)(pa,"SlideShowViewDockingState",null,[]);var la=d(990);class Fa extends I{constructor(){super(0);this.SlideIndex=this.SlideId=0;this.WacCluster=this.Endpoint=this.PodSessionId=this.WacUserSessionId=
this.UserId=null;this.FPrerenderSS=!1;this.PrerenderCid=null;this.SlideShowClickTime=0;this.EndSlideShowText=null;this.FSupportSVGInWebGL="0";this.HostSupportsSessionRefreshEnabled=!1;this.RenderShapeBuilder="0";this.CustomTransitionResourceUrl=this.DisabledTransitionsList=this.VetoAppSettingsStr=this.FileHost=null;this.StreamVideoUseThinEmbed=!1;this.DisabledChangeGates=null;this.AllowExternalMarketplace=this.AreThirdPartyAddInsAllowed=!1}}Object(K.a)(Fa,"StartSlideShowApiMessage",I,[]);class Qa extends I{constructor(){super(13);
this.IsToggleOn=!1;this.PragueSessionInfo=""}}Object(K.a)(Qa,"ToggleTranscriberLiveBroadcastModeMessage",I,[]);class Sa extends I{constructor(){super(18);this.HideUI=!1}}Object(K.a)(Sa,"ToggleTranscriberUIVisibilityMessage",I,[]);class Na extends I{constructor(){super(8);this.SubtitlesResourceStr=this.SubtitlesContextStr=this.SubtitlesAppSettingsStr=null;this.MicrophoneDeviceId=this.LiveBroadcastContextStr=this.RehearsalContextStr=""}}Object(K.a)(Na,"TranscribeApiMessage",I,[]);var ua=d(69);d.d(Z,
"SlideshowFrame",function(){return za});class za{constructor(Wa,yb,Za,ub,Ib,Ob,Hc,kb){this.kb=this.SWa=this.RWa=this.jva=null;this.va=new k.a;this.tGa=null;this.lAe=this.FTg=!1;this.kf=yb;this.la=Za;this.Hc=ub;this.Tb=Ib;this.eO=Ob;this.Kl=Hc;this.qBb=kb;this.g9j=new C.a(Object(w.a)(Wa,Wa.xii,"browserSupportsRenderingSVGInWebGL"))}init(Wa,yb,Za){if(!this.kb){this.jva=document.getElementById("HiddenFocusTrapAnchor");this.kb=document.createElement("iframe");this.kb.id="SlideShowHostFrame";this.kb.className=
"SlideShowHostFrame";this.kb.style.display=ua.a.Gf;this.kb.setAttribute("allow","microphone; autoplay");this.tGa=new pa;Za=this.la.isHermesSlideShowPreloadEnabled?String.format("EndSlideShowText={0}&UserSessionId={1}&WacCluster={2}",e.a.Ke(ResourceStrings.l_EndOfSlideShowMessage),e.a.Ke(Za),e.a.Ke(yb)):"";Za+=String.format(Za?"&HostSupportsSessionRefreshEnabled={0}":"HostSupportsSessionRefreshEnabled={0}",e.a.Ke(this.la.hostSupportsSessionRefreshEnabled.toString()));Za+=String.format(Za?"&InkingEnabled={0}":
"InkingEnabled={0}",e.a.Ke(this.la.isInkingInSlideShowEnabled.toString()));Za+=String.format(Za?"&VideoThruTransparentCanvas={0}":"VideoThruTransparentCanvas={0}",e.a.Ke(this.la.EVj.toString()));Za+=String.format(Za?"&IsFlipgridVideoEnabled={0}":"IsFlipgridVideoEnabled={0}",e.a.Ke(this.la.jab.toString()));Za+=String.format(Za?"&IsTEDVideoEnabled={0}":"IsTEDVideoEnabled={0}",e.a.Ke(this.la.Izb.toString()));Za+=String.format(Za?"&IsAllowExternalMarketplace={0}":"IsAllowExternalMarketplace={0}",e.a.Ke(this.la.Uge.toString()));
Za+=String.format(Za?"&IsNewSlideShowToolbarEnabled={0}":"IsNewSlideShowToolbarEnabled={0}",e.a.Ke(this.la.t9b.toString()));Za+=String.format("&ImageCachingEnabled={0}",e.a.Ke(this.la.Hil.toString()));Za+=String.format("&PodSlideshowEnableTabLoopFix={0}",e.a.Ke(this.la.hAk.toString()));Za+=String.format("&PodsLoadSlideShowFrameFromCdn={0}",e.a.Ke(this.la.podsLoadSlideShowFrameFromCdn.toString()));Za+=String.format("&PodsBase={0}",e.a.Ke(this.la.podsWebServiceBase));var ub=this.la.sfa;this.la.FUa&&
(ub=new u.a(ub),ub.Ttc=this.la.FUa,ub.Wpc=this.la.Yrh,ub.Vpc=this.la.Xrh,ub=ub.toString());var Ib=this.la.podsLoadSlideShowFrameFromCdn&&!e.a.Wa(this.la.podsBaseSlideShowFramePath);this.kb.src=Ib?this.la.podsBaseSlideShowFramePath:"./SlideShowFrame.html";this.kb.src=String.format(this.kb.src+"?Version={0}&WacCluster={1}&BootJS={2}&{3}={4}",Wa,e.a.Ke(yb),e.a.Ke(this.la.pptEditorSlideShowWrsEndpoint),A.a.Ekc,ub);E.a.J(512495881,830,50,String.format("LoadFromCdn {0}, IsTranscriberEnabled {1}",Ib,this.la.Pka));
if(this.la.Pka||this.la.w$b)this.kb.src=String.format(this.kb.src+"&TranscriberJS={0}&ClientAudioMessageJS={1}&SpeechResultMessageJS={2}&TranscriberURI={3}",e.a.Ke(this.la.pptEditorTranscriberJsUri),e.a.Ke(this.la.pptEditorTransciberClientAudioMessageJsUri),e.a.Ke(this.la.pptEditorTransciberSpeechResultMessageJsUri),e.a.Ke(this.la.pptEditorSpeechHandlerBaseUri)),this.kb.src=String.format(this.kb.src+"&SpeechResponseMessageJS={0}",e.a.Ke(this.la.pptEditorTranscriberSpeechResponseMessageJsUri)),e.a.og(this.la.pptEditorTranscriberQualityStatusMessageJsUri).endsWith("qualitystatusmessage.js")&&
(this.kb.src=String.format(this.kb.src+"&QualityStatusMessageJS={0}",e.a.Ke(this.la.pptEditorTranscriberQualityStatusMessageJsUri))),this.la.w$b&&e.a.og(this.la.pptEditorTranscriberRehearsalResultMessageJsUri).endsWith("rehearsalresultmessage.js")&&(this.kb.src=String.format(this.kb.src+"&RehearsalResultMessageJS={0}",e.a.Ke(this.la.pptEditorTranscriberRehearsalResultMessageJsUri))),this.la.pptEditorTranscriberLiveAgentEnabled&&e.a.og(this.la.pptEditorTranscriberAgentCommandMessageJsUri).endsWith("agentcommandmessage.js")&&
(this.kb.src=String.format(this.kb.src+"&AgentCommandMessageJS={0}",e.a.Ke(this.la.pptEditorTranscriberAgentCommandMessageJsUri)));this.la.powerPointLiveBroadcastEnabled&&(this.kb.src+="&wdLiveBroadcast=true");this.kb.src=String.format(this.kb.src+"#{0}",Za);H.a("PresenterCoachTabFix")&&this.jva?this.kf.insertBefore(this.kb,this.jva):this.kf.appendChild(this.kb);n.a.addHandler(window,r.a.message,Object(w.a)(this,this.stk,"onSlideshowMessage"));this.Hc.Pub&&this.la.ihd&&this.KZj();H.a("PresenterCoachTabFix")&&
(this.RWa=document.getElementById("legacySlideshowBeginningFocusTrap"),this.SWa=document.getElementById("legacySlideshowEndFocusTrap"),this.RWa||this.SWa||(this.RWa=document.createElement("div"),this.RWa.id="legacySlideshowBeginningFocusTrap",this.RWa.className="FocusTrap",this.RWa.tabIndex=0,n.a.addHandler(this.RWa,r.a.focus,Object(w.a)(this,this.Ojc,"onSlideShowContainerDivFocusHandler")),this.SWa=document.createElement("div"),this.SWa.id="legacySlideshowEndFocusTrap",this.SWa.className="FocusTrap",
this.SWa.tabIndex=0,n.a.addHandler(this.SWa,r.a.focus,Object(w.a)(this,this.Ojc,"onSlideShowContainerDivFocusHandler")),this.kf.insertBefore(this.RWa,this.kf.firstChild),this.kf.insertBefore(this.SWa,this.jva.nextSibling)))}}k8a(){return this.la.ihd&&this.lAe}ytk(){E.a.J(512495880,830,50,"SlideShowFrame::OnSpeechClientScriptLoaded Speech client script has been loaded successfully");this.FTg=!0;return null}KZj(){const Wa=new z.a;Wa.add(this.qBb.loadScript("PPTSpeechClient"));Promise.all(Wa.toArray()).then(()=>
this.ytk()).catch(yb=>{E.a.J(512495879,830,10,"SlideShowFrame::LoadSpeechClientResources Failed to load the resources for SlideShowCore: {0}",yb)})}cqd(Wa,yb,Za,ub,Ib,Ob,Hc,kb,jb){this.tGa=new pa;Hc&&E.a.J(512495878,830,50,String.format("Will trigger slideshow bundle rendering, correlation = {0}",kb));this.bG(Object.assign(new Fa,{WacCluster:Za,PodSessionId:ub,UserId:Ib,WacUserSessionId:Ob,SlideId:Wa,SlideIndex:yb,FPrerenderSS:Hc,PrerenderCid:kb,SlideShowClickTime:jb,EndSlideShowText:ResourceStrings.l_EndOfSlideShowMessage,
FSupportSVGInWebGL:this.g9j.value?"1":"0",RenderShapeBuilder:this.la.FUa?"1":"0",FileHost:v.AFrameworkApplication.fa.Ha("FileHost"),VetoAppSettingsStr:this.Emj(),DisabledTransitionsList:this.la.LLa,CustomTransitionResourceUrl:this.la.XJf,StreamVideoUseThinEmbed:v.AFrameworkApplication.fa.ka("StreamVideoUseThinEmbed"),DisabledChangeGates:v.AFrameworkApplication.fa.Ha("PPTDisabledChangeGates"),AreThirdPartyAddInsAllowed:v.AFrameworkApplication.tia,AllowExternalMarketplace:v.AFrameworkApplication.fa.ka("51")}))}prev(){this.bG(new I(2))}next(){this.bG(new I(1))}transcribe(Wa,
yb,Za,ub,Ib,Ob,Hc){var kb=!!this.Tb&&!!this.Tb.instance&&(this.Tb.instance.LRa||this.Tb.instance.Yq);(this.Tb&&this.Tb.instance&&this.Tb.instance.sr&&this.Tb.instance.jDa||kb)&&!this.Tb.instance.Uub()?E.a.J(512495877,830,50,"LivePresenter prevented transcriber from starting"):this.k8a()?(la.a.instance.transcribe(Wa,yb,Za,ub,Ib,Ob,Hc),this.WMc(this.Hc.Kh&&5!==Ib,this.Hc.Ov)):(kb={},kb.TranslationLanguages=this.la.powerPointLiveBroadcastEnabled?this.la.liveBroadcastTranslationLanguagesOverride:"",kb.BroadcastSubtitlesFromSpeechFrontDoorForLive=
this.la.powerPointLiveBroadcastEnabled?!0:!1,this.bG(Object.assign(new Na,{SubtitlesAppSettingsStr:this.Ijj(Wa,Za,yb,ub,Ib,Ob),SubtitlesContextStr:this.Hc.rml,SubtitlesResourceStr:this.Jjj(),RehearsalContextStr:Hc?Hc.QQk:"",LiveBroadcastContextStr:JSON.stringify(kb),MicrophoneDeviceId:this.eO.microphoneDeviceId})))}setMicrophoneState(Wa){this.k8a()?la.a.instance.setMicrophoneState(Wa):(this.bG(Object.assign(new ya,{IsMute:Wa})),this.Tb&&this.Tb.instance&&(Wa?this.Tb.instance.Vph():this.Tb.instance.Wph()))}HNb(Wa,
yb=""){this.tGa.Ahg=Wa;E.a.J(512495876,830,50,"Toggling transcriber's Live Broadcast mode ... On: {toggleOn}");this.k8a()?(la.a.instance.FBh(Wa,yb),this.WMc(this.Hc.Kh,this.Hc.Ov)):this.bG(Object.assign(new Qa,{IsToggleOn:Wa,PragueSessionInfo:yb}));this.t2g()}toggleTranscriberUIVisibility(Wa){E.a.J(512495875,830,50,"Toggling Transcriber UI visibilitye ... On: {showUI}");this.k8a()?(Wa=Wa?Wa?!1:!0:!la.a.instance.isVisible(),la.a.instance.setVisibility(Wa),la.a.instance.fGc(),this.WMc(this.Hc.Kh,this.Hc.Ov)):
this.bG(Object.assign(new Sa,{HideUI:Wa}))}WMc(Wa,yb){this.tGa.l$b=Wa;this.tGa.Ov=yb;this.t2g()}setOsfLocalStorage(){const Wa={};let yb=!1;try{const Za=RegExp("^osfCacheVersion|_?_OSF_.+$");for(let ub=0;ub<localStorage.length;++ub){const Ib=localStorage.key(ub);if(Za.test(Ib)){const Ob=localStorage.getItem(Ib);Wa[Ib]=Ob;yb=!0}}}catch(Za){E.a.J(512495874,830,50,"SlideShowFrame::Exception while retrieving OSF Local Storage data: {0}",Za.toString())}yb&&this.bG(Object.assign(new Da,{OsfLocalStorageData:Wa}))}show(){E.a.J(512495873,
830,50,"SlideShowFrame::Show Making frame visible.");if(this.kb){this.kb.style.display=ua.a.Xk;var Wa=(new Date).getTime();E.a.J(512495843,830,50,"SlideShowFrame::Show Sending startedSlideShowTimestamp: {0} to SlideShowFrame.html",Wa);this.bG(Object.assign(new wa,{StartSlideShowTime:Wa}))}else E.a.J(512495872,830,15,"SlideShowFrame::Show Making frame visible, but m_frame is null.")}Qab(){return this.kb&&this.kb.style.display!==ua.a.Gf?!0:!1}y8(){return"Legacy"}Ksc(Wa){this.kb.style.display=Wa?ua.a.Xk:
ua.a.Gf;this.k8a()&&la.a.instance.setVisibility(Wa&&this.Hc.Kh)}dQc(){E.a.J(512495842,830,50,"SlideShowFrame: Exiting with post message");this.bG(new I(3))}exit(){this.kb.style.display===ua.a.Gf?this.va.raiseEvent("OnExit",new O.a({SlideId:0,IsBeforeReady:!0})):(E.a.J(512495841,830,50,"SlideShowFrame: Making frame invisible"),this.kb.style.display=ua.a.Gf,this.bG(new I(3)));this.k8a()&&la.a.instance.yYe()}restoreFocus(){this.kb.style.display===ua.a.Gf||this.Uhe()||(this.kb.focus(),this.bG(new I(4)))}pausePresentation(){this.bG(new I(15))}h0e(){this.va.raiseEvent("OnFullscreenClick",
new Sys.EventArgs)}getCurrentPosition(){this.bG(new I(5))}getCurrentPositionWithTimeLines(){this.bG(new I(17))}getCurrentSlideDimensions(){this.bG(new I(20))}$Sa(Wa){this.bG(Object.assign(new T,{SlideIndex:Wa,AnimStep:0}))}uJe(Wa){this.bG(Object.assign(new R,{Item:Wa.item,Color:Wa.color}))}ISe(Wa){this.va.raiseEvent("OnSpecialKey",new ba.a({["Key"]:Wa.keyCode,["ShiftKey"]:Wa.shiftKey}))}moh(){this.bG(new I(22))}f7f(Wa,yb){this.bG(Object.assign(new D,{SlideIndex:Wa,TimeLineMappings:yb}))}refreshPodSession(Wa,
yb){this.bG(Object.assign(new ra,{PodSessionId:Wa,WacCluster:yb}))}setVisibility(Wa){this.kb.style.visibility=Wa?ua.a.xz:ua.a.Ms}Vfa(Wa){this.bG(new I(Wa?9:10));this.k8a()&&la.a.instance.Vfa(Wa)}PFc(Wa){this.va.addHandler("OnSlideshowReady",Wa)}kkd(Wa){this.va.removeHandler("OnSlideshowReady",Wa)}aOd(Wa){this.va.addHandler("OnBrowserEvent",Wa)}ePe(Wa){this.va.removeHandler("OnBrowserEvent",Wa)}rsf(Wa){this.va.addHandler("OnFullscreenClick",Wa)}Shh(Wa){this.va.removeHandler("OnFullscreenClick",Wa)}cOd(Wa){this.va.addHandler("OnSlideshowContextMenu",
Wa)}gPe(Wa){this.va.removeHandler("OnSlideshowContextMenu",Wa)}gOd(Wa){this.va.addHandler("OnPodSessionExpired",Wa)}kPe(Wa){this.va.removeHandler("OnPodSessionExpired",Wa)}nPa(Wa){this.va.addHandler("OnPositionChangeEventId",Wa)}fib(Wa){this.va.removeHandler("OnPositionChangeEventId",Wa)}lia(Wa){this.va.addHandler("OnExit",Wa)}Cfa(Wa){this.va.removeHandler("OnExit",Wa)}osf(Wa){this.va.addHandler("OnSlideshowError",Wa)}Phh(Wa){this.va.removeHandler("OnSlideshowError",Wa)}TXb(Wa){this.va.addHandler("OnGetCurrentPosition",
Wa)}eib(Wa){this.va.removeHandler("OnGetCurrentPosition",Wa)}LFc(Wa){this.va.addHandler("OnGetCurrentSlideDimensions",Wa)}ikd(Wa){this.va.removeHandler("OnGetCurrentSlideDimensions",Wa)}QFc(Wa){this.va.addHandler("OnSpecialKey",Wa)}lkd(Wa){this.va.removeHandler("OnSpecialKey",Wa)}Fsf(Wa){this.va.addHandler("OnVisibilityChangeEventId",Wa)}oPe(Wa){this.va.removeHandler("OnVisibilityChangeEventId",Wa)}vsf(Wa){this.va.addHandler("OnLogEndOfTranscriptionSession",Wa)}Uhh(Wa){this.va.removeHandler("OnLogEndOfTranscriptionSession",
Wa)}usf(Wa){this.va.addHandler("OnLiveSubtitlesDockedViewEventId",Wa)}Thh(Wa){this.va.removeHandler("OnLiveSubtitlesDockedViewEventId",Wa)}eOd(Wa){this.va.addHandler("OnEnterEndOfShowEventId",Wa)}hPe(Wa){this.va.removeHandler("OnEnterEndOfShowEventId",Wa)}fOd(Wa){this.va.addHandler("OnLeaveEndOfShowEventId",Wa)}jPe(Wa){this.va.removeHandler("OnLeaveEndOfShowEventId",Wa)}Csf(Wa){this.va.addHandler("OnSubtitleUpdatedEventId",Wa)}$hh(Wa){this.va.removeHandler("OnSubtitleUpdatedEventId",Wa)}Esf(Wa){this.va.addHandler("OnTranscriberStartedEventId",
Wa)}aih(Wa){this.va.removeHandler("OnTranscriberStartedEventId",Wa)}Msf(Wa){this.va.addHandler("RecordQosErrorEventId",Wa)}iih(Wa){this.va.removeHandler("RecordQosErrorEventId",Wa)}stk(Wa){Wa=new Q(Wa.rawEvent);if(this.vVj(Wa)){var yb=this.kZk(Wa.ava),Za=yb.EventType;28===Za&&E.a.J(512495840,830,50,"SlideshowFrame.OnSlideshowMessage: Receive message event: {0}",Wa.ava);switch(Za){case 23:this.Ldd(yb);break;case 18:this.jgb(yb);break;case 6:this.xrk();break;case 11:this.a6g(!1,yb);break;case 13:this.a6g(!0,
yb);break;case 2:this.ffa(yb);break;case 7:this.Qwa(yb);break;case 12:this.$wa(yb);break;case 24:this.rtk(yb);break;case 26:this.PYa(yb);break;case 27:this.Led(yb);break;case 29:this.ked(yb);break;case 5:this.Ned(yb);break;case 30:this.Etk(yb);break;case 32:this.sfd(yb);break;case 31:this.jed(yb);break;case 19:this.Idd(yb);break;case 20:this.ged(yb);break;case 33:this.yjd(yb)}}}vVj(Wa){try{if(Wa.BTg!==this.kb.contentWindow)return E.a.J(512495839,830,50,"SlideshowFrame.IsValidSlideshowEventSourceAndOrigin: Invalid message source or origin: {0}",
Wa.BTg.location.href),!1}catch(yb){return E.a.J(512495838,830,50,"SlideshowFrame.IsValidSlideshowEventSourceAndOrigin: Exception at checking event source/origin: {0}",yb.toString()),!1}return!0}kZk(Wa){try{return Sys.Serialization.JavaScriptSerializer.deserialize(Wa)}catch(yb){let Za=yb.toString();H.a("DisableLogPostMsgData")&&(Wa="<redacted>");H.a("DisableLogPostMsgEx")&&(Za="<redacted>");E.a.J(512495837,830,15,"SlideshowFrame.RetrieveMsgEventData: Exception at deserializing event data: {0}.  Exception: {1}",
Wa,Za)}return{}}xrk(){if(this.la.ihd&&this.FTg&&!this.lAe)try{const Wa=(new Date).getTime();la.a.instance.init(this.la,this.kb.contentDocument.body,this.Hc,this,this.Kl,this.Tb,this.eO);this.lAe=!0;E.a.J(512495836,833,50,"SlideshowFrame.OnPresentationOpenedHandler: SpeechClient initialized successfully! TimeUsed: {0} ms",(new Date).getTime()-Wa)}catch(Wa){E.a.J(512495835,830,10,"SlideshowFrame.OnPresentationOpenedHandler: Exception thrown: {0}.",Wa.toString())}E.a.J(512495834,830,50,"SlideshowFrame.OnPresentationOpenedHandler");
this.va.raiseEvent("OnSlideshowReady",new Sys.EventArgs)}jgb(Wa){this.va.raiseEvent("OnBrowserEvent",new W.a(Wa))}Ldd(Wa){E.a.J(512495833,830,50,"SlideshowFrame.OnExitSlideshowHandler");E.a.J(512495832,830,50,"SlideShowFrame: Making frame invisible");this.kb.style.display=ua.a.Gf;this.va.raiseEvent("OnExit",new O.a(Wa))}ffa(Wa){E.a.J(512495831,830,50,"SlideshowFrame.OnGetCurrentPositionHandler");this.va.raiseEvent("OnGetCurrentPosition",new Y.a(Wa))}Qwa(Wa){E.a.J(512495830,830,50,"SlideshowFrame.OnGetCurrentSlideDimensionsHandler");
this.va.raiseEvent("OnGetCurrentSlideDimensions",new S.a(Wa))}a6g(Wa,yb){this.va.raiseEvent("OnSlideshowError",new na(Wa,yb))}$wa(Wa){Wa=new ba.a(Wa);E.a.J(512495829,830,50,"SlideshowFrame.OnSpecialKeyHandler: Key={0}",Wa.key);this.va.raiseEvent("OnSpecialKey",Wa)}rtk(Wa){E.a.J(512495828,830,50,"SlideshowFrame.OnSlideshowContextMenuHandler");this.va.raiseEvent("OnSlideshowContextMenu",new F.a(Wa))}PYa(Wa){E.a.J(512495827,830,50,"SlideshowFrame.OnVisibilityChangeHandler");this.va.raiseEvent("OnVisibilityChangeEventId",
new ta.a(Wa))}Led(Wa){E.a.J(512495826,830,50,"SlideshowFrame.OnPodSessionExpiredHandler");this.va.raiseEvent("OnPodSessionExpired",new ka.a(Wa))}ked(Wa){E.a.J(512495825,830,50,"SlideshowFrame.OnLogEndOfTranscriptionSessionHandler");this.va.raiseEvent("OnLogEndOfTranscriptionSession",new fa(Wa));this.Hc.Wub=!1}Ned(Wa){E.a.J(512495824,830,50,"SlideshowFrame.OnPositionChangedHandler");this.va.raiseEvent("OnPositionChangeEventId",new ha.a(Wa))}Etk(Wa){E.a.J(512495823,830,50,"SlideshowFrame.OnSubtitleUpdatedHandler");
this.va.raiseEvent("OnSubtitleUpdatedEventId",new Ea(Wa))}sfd(Wa){E.a.J(512495822,830,50,"SlideshowFrame.OnTranscriberStartedHandler");this.va.raiseEvent("OnTranscriberStartedEventId",new La.a(Wa));this.Hc.Wub=!0}Ojc(){this.restoreFocus()}jed(Wa){E.a.J(512495821,830,50,"SlideshowFrame.OnLiveSubtitlesDockedViewHandler");try{const yb=new da(Wa);this.WMc(yb.l$b,yb.Ov);this.va.raiseEvent("OnLiveSubtitlesDockedViewEventId",yb)}catch(yb){E.a.J(512495820,830,15,"SlideshowFrame.OnLiveSubtitlesDockedViewHandler threw exception: {0}.",
yb.toString())}}Idd(){E.a.J(512495819,830,50,"SlideshowFrame.OnEnterEndOfShowHandler");this.va.raiseEvent("OnEnterEndOfShowEventId",Sys.EventArgs.Empty)}ged(){E.a.J(512495818,830,50,"SlideshowFrame.OnLeaveEndOfShowHandler");this.va.raiseEvent("OnLeaveEndOfShowEventId",Sys.EventArgs.Empty)}yjd(Wa){E.a.J(512495817,830,50,"SlideshowFrame.RecordQosErrorHandler");this.va.raiseEvent("RecordQosErrorEventId",new oa(Wa))}bG(Wa){this.kb&&this.kb.contentWindow&&this.kb.contentWindow.postMessage(Sys.Serialization.JavaScriptSerializer.serialize(Wa),
"*")}t2g(){var Wa=0,yb=100;this.tGa.l$b&&("BelowSlide"===this.tGa.Ov?(Wa=0,yb=85):"AboveSlide"===this.tGa.Ov&&(Wa=15,yb=85));Wa=Wa.toString()+"%";yb=yb.toString()+"%";this.tGa.Ahg&&(Wa=String.format("calc({0} + {1})",Wa,"26px"),yb=String.format("calc({0} - {1})",yb,"26px"));this.bG(Object.assign(new J,{TopValue:Wa,HeightValue:yb}))}Emj(){const Wa={};Wa.AnimTranstionMinDurationMs=v.AFrameworkApplication.fa.Fc("PodSlideShowVetoAnimTranstionMinDurationMs",1E3);Wa.AnimTranstionWorstFrameIndex=v.AFrameworkApplication.fa.Fc("PodSlideShowVetoAnimTranstionWorstFrameIndex",
3);Wa.AnimTranstionMaxFrameDurationMs=v.AFrameworkApplication.fa.Fc("PodSlideShowVetoAnimTranstionMaxFrameDurationMs",300);Wa.AnimTranstionMinFPS=v.AFrameworkApplication.fa.Fc("PodSlideShowVetoAnimTranstionMinFPS",24);Wa.NavDurationMs=v.AFrameworkApplication.fa.Fc("PodSlideShowVetoNavDurationMs",1250);Wa.SlideShowEUPLThresholdInMs=v.AFrameworkApplication.fa.Fc("SlideShowEUPLThresholdInMs",6E3);Wa.SlideShowNavigationThresholdInMs=v.AFrameworkApplication.fa.Fc("SlideShowNavigationThresholdInMs",1250);
return JSON.stringify(Wa)}Ijj(Wa,yb,Za,ub,Ib,Ob){const Hc=this.la.xCk&&e.a.og(this.la.pptEditorTranscriberQualityStatusMessageJsUri).endsWith("qualitystatusmessage.js"),kb={};kb.WacUserSessionId=Wa;kb.WacUserDatacenterCluster=yb;kb.PodSessionId=Za;kb.DocId=ub;kb.EntryPoint=Ib;kb.StartTime=Ob;kb.PodsWebServiceBase=this.la.podsWebServiceBase;kb.TranscriberLoggingIntervalInMS=this.la.Qrl;kb.TranscribeRealTimeFactorLowerThreshold=this.la.Mrl;kb.TranscribeRealTimeFactorUpperThreshold=this.la.Nrl;kb.IsTranscriberLogEachTranscriptMessage=
this.la.FUj;kb.IsTranscriberContentLoggingEnabled=this.la.CUj;kb.FUseEndpointInWebapp=this.la.IUj;kb.CustomEndpointRequestTimeoutInMs=this.la.pptEditorTransriberCustomEndpointRequestTimeoutInMs;kb.RTLLanguages=this.la.pptEditorTranscribeRTLTranslationLanguages;kb.HeartbeatInterval=5E3;kb.RoundtripLatencyThreshold=1E6;kb.AudioSendingCountIntervalMS=this.la.pptEditorTranscribeAudioSendingCountIntervalMS;kb.FragmentLatencyWarnThreshold=1E6;kb.FragmentLatencyErrorThreshold=1E6;kb.MessageType=this.la.pptEditorTransciberMessageType;
kb.MaxAllowedFragmentLatencyMS=this.la.kAk;kb.DynamicBufferEnabled=this.la.DUj;kb.DefaultBufferSize=this.la.Prl;kb.MaxAllowedFinalFragmentLatencyMS=this.la.jAk;kb.FSupportSpeechResponseMessage=Hc;kb.IsLiveAgent=this.la.pptEditorTranscriberLiveAgentEnabled&&Hc&&e.a.og(this.la.pptEditorTranscriberAgentCommandMessageJsUri).endsWith("agentcommandmessage.js");kb.ShouldCreateCustomEndpointWithSession=this.la.pptEditorTranscriberCustomEndpointWithSession;kb.TranscriberShowListeningDetectionTextInMS=this.la.wCk;
kb.PodTranscriberAudioContextSampleRate=this.la.iAk;kb.RehearsalGrammarIsEnabled=this.la.LJe;kb.PodRehearsalMonotoneEnabled=this.la.aJe;return JSON.stringify(kb)}Jjj(){const Wa={};Wa.Detection_AudioQualityIssue=ResourceStrings.L_SubtitleDetection_AudioQualityIssue;Wa.Detection_HighBackgroundNoise=ResourceStrings.L_SubtitleDetection_HighBackgroundNoise;Wa.Detection_HighJitter=ResourceStrings.L_SubtitleDetection_HighJitter;Wa.Detection_HighLatency=ResourceStrings.L_SubtitleDetection_HighLatency;Wa.Detection_Listening=
ResourceStrings.L_SubtitleDetection_Listening;Wa.Detection_MicReady=ResourceStrings.L_SubtitleDetection_MicReady;Wa.Detection_NetworkQualityIssue=ResourceStrings.L_SubtitleDetection_NetworkQualityIssue;Wa.Detection_NoMicrophone=ResourceStrings.L_SubtitleDetection_NoMicrophone;Wa.Detection_SoundReminder=ResourceStrings.L_SubtitleDetection_SoundReminder;Wa.Detection_SpeakingTooLoud=ResourceStrings.L_SubtitleDetection_SpeakingTooLoud;Wa.Detection_SpeakingTooQuiet=ResourceStrings.L_SubtitleDetection_SpeakingTooQuiet;
Wa.DetectionText_AudioQualityIssue=ResourceStrings.L_SubtitleDetectionText_AudioQualityIssue;Wa.DetectionText_HighBackgroundNoise=ResourceStrings.L_SubtitleDetectionText_HighBackgroundNoise;Wa.DetectionText_HighJitter=ResourceStrings.L_SubtitleDetectionText_HighJitter;Wa.DetectionText_HighLatency=ResourceStrings.L_SubtitleDetectionText_HighLatency;Wa.DetectionText_NetworkQualityIssue=ResourceStrings.L_SubtitleDetectionText_NetworkQualityIssue;Wa.DetectionText_SpeakingTooLoud=ResourceStrings.L_SubtitleDetectionText_SpeakingTooLoud;
Wa.DetectionText_SpeakingTooQuiet=ResourceStrings.L_SubtitleDetectionText_SpeakingTooQuiet;Wa.Accessibility_Content=ResourceStrings.L_SubtitleAccessibilityContent;Wa.Accessibility_Window=ResourceStrings.L_SubtitleAccessibilityWindow;Wa.InitialMessage=ResourceStrings.L_SubtitleInitMessage;Wa.GenericErrorMessage=ResourceStrings.L_SubtitleGenericErrorMessage;Wa.RetryErrorMessage=ResourceStrings.L_SubtitleRetryErrorMessage;Wa.ErrorAudioDevice=ResourceStrings.L_SubtitleAudioDeviceErrorMessage;Wa.GenericRetryErrorMessage=
ResourceStrings.L_SpeechGenericRetryErrorMessage;Wa.GenericNetworkErrorMessage=ResourceStrings.L_SpeechGenericNetworkErrorMessage;return JSON.stringify(Wa)}Uhe(){return!!this.Tb&&!!this.Tb.instance&&this.Tb.instance.lSf}}Object(K.a)(za,"SlideshowFrame",null,[535])},990:function(K,Z,d){K=d(0);var k=d(286),e=d(25),n=d(45),r=d(13),v=d(22),C=d(1186),w=d(33),z=d(26);class A{}A.speechMode="Subtitles";A.QJf=[A.speechMode];A.sourceLanguage=null;A.targetLanguages=null;A.speechFDBase=null;A.podSessionId=null;
A.KIh=null;A.docId=null;A.webServiceBase=null;A.userSessionId=e.AFrameworkApplication.userSessionId;Object(K.a)(A,"PPTSpeechClientConfig",null,[]);var u=d(76);class E{constructor(){this.va=new u.a}onFinalRecognitionText(da){this.va.raiseEvent("OnFinalRecognitionText",da)}onPartialRecognitionText(da){this.va.raiseEvent("OnPartialRecognitionText",da)}onError(da){this.va.raiseEvent("OnError",da)}onSpeechRecognitionStarted(da){this.va.raiseEvent("OnSpeechRecognitionStarted",da)}onEventUpdate(da){this.va.raiseEvent("OnEventUpdate",
da)}l8h(da){this.va.addHandler("OnFinalRecognitionText",da)}iTk(da){this.va.removeHandler("OnFinalRecognitionText",da)}i$h(da){this.va.addHandler("OnPartialRecognitionText",da)}xUk(da){this.va.removeHandler("OnPartialRecognitionText",da)}f8h(da){this.va.addHandler("OnError",da)}dTk(da){this.va.removeHandler("OnError",da)}gai(da){this.va.addHandler("OnSpeechRecognitionStarted",da)}bVk(da){this.va.removeHandler("OnSpeechRecognitionStarted",da)}h8h(da){this.va.addHandler("OnEventUpdate",da)}fTk(da){this.va.removeHandler("OnEventUpdate",
da)}}Object(K.a)(E,"PPTSpeechClientObserverController",null,[]);var H=d(382),I=d(394);class J{constructor(){this.accessToken=null}}Object(K.a)(J,"IAuthenticationProvider",null,[]);class T{constructor(){this.docId=this.podsSessionId=this.webServiceBase=this.userDataCenterClusterId=null}}Object(K.a)(T,"IDocumentDownloadConfig",null,[]);class D{constructor(){this.documentDownloadConfig=this.userSessionId=this.speechFDBase=this.properties=this.targetLanguages=this.sourceLanguage=this.speechMode=null;
this.clientApp=0;this.clientMetaData=null;this.captureAudioPauseResumeRecordingState=this.requestServiceCustomEndpoint=!1;this.microphoneDeviceId=null}}Object(K.a)(D,"ISpeechConfig",null,[]);class R{constructor(da){this.V4=da}onFinalText(){}onFragmentText(){}onFinalRecognitionText(da,fa){this.V4.onFinalRecognitionText(da,fa)}onPartialRecognitionText(da,fa){this.V4.onPartialRecognitionText(da,fa)}onError(da){if("ErrorNone"!==da)switch(da){case "ErrorInvalidSubscriptionFromConfig":case "ErrorInvalidRegionFromConfig":case "ErrorAddSessionFailure":case "ErrorCreateSpeechSessionBadRequest":this.V4.onError("AccessDenied");
break;case "ErrorSpeechHandlerWebSocketFailure":case "ErrorProtobufDeserializationFailure":case "ErrorConnectionRetryFailure":this.V4.onError("FailedToConnect");break;case "ErrorWaitAudioTimeout":case "ErrorInitialBabbleTimeout":case "ErrorCustomEndpointTimeout":this.V4.onError("Timeout");break;case "ErrorInitialSilenceTimeout":this.V4.onError("InitialSilenceTimeout");break;case "ErrorSpeechRecognitionFailure":case "ErrorTranslationFailure":case "ErrorFailedToGetSupportedTextLanguages":case "ErrorUnknown":this.V4.onError("UnknownError");
break;case "ErrorInvalidMessage":case "ErrorAudioAbortError":case "ErrorAudioOverconstrainedError":case "ErrorAudioTypeError":this.V4.onError("MicrophoneError");break;case "ErrorAudioSecurityError":case "ErrorAudioNotAllowedError":this.V4.onError("NotAllowedError");break;case "ErrorAudioNotFoundError":this.V4.onError("NotFoundError");break;case "ErrorAudioNotReadableError":this.V4.onError("NotReadableError");break;default:this.V4.onError("CustomError-"+da)}}onSpeechRecognitionStarted(da){H.ULS.sendTraceTag(594355729,
830,50,"PPTSpeechClientObserver::OnSpeechRecognitionStarted {0}",da);this.V4.onSpeechRecognitionStarted(da)}onEventUpdate(da){this.V4.onEventUpdate(da)}}Object(K.a)(R,"PPTSpeechClientObserver",null,[658]);class Q{constructor(da){this.p$=null;this.bIa=0;this.microphoneDeviceId="";this.tck=new R(da)}pTj(){return 2===this.bIa}WDj(){const da=this.mWd(),fa=Object.assign(new J,{accessToken:""});this.p$&&0!==this.bIa&&(this.p$.stopSpeechRecognition(),this.bIa=0);this.p$=(new PPTSpeechClient.SpeechClientFactory).createSpeechClient(da,
this.tck,fa,null,new I.a);return this.p$?!0:(H.ULS.sendTraceTag(594355727,830,10,"Speech client was not successfully created"),!1)}Gxh(){this.p$&&(0===this.bIa?(this.p$.startSpeechRecognition(),this.bIa=2):1===this.bIa&&(this.p$.resumeSpeechRecognition(),this.bIa=2))}Ill(){this.p$&&(this.p$.stopSpeechRecognition(),this.bIa=0)}izk(){this.p$&&(this.p$.pauseSpeechRecognition(),this.bIa=1)}setCustomSetting(da,fa){this.p$&&this.p$.setCustomSetting(da,fa)}mWd(){return Object.assign(new D,{speechMode:A.speechMode,
sourceLanguage:A.sourceLanguage,targetLanguages:A.targetLanguages,speechFDBase:A.speechFDBase,captureAudioPauseResumeRecordingState:!0,clientApp:0,documentDownloadConfig:Object.assign(new T,{docId:A.docId,podsSessionId:A.podSessionId,userDataCenterClusterId:A.KIh,webServiceBase:A.webServiceBase}),userSessionId:A.userSessionId,microphoneDeviceId:this.microphoneDeviceId})}}Object(K.a)(Q,"PPTSpeechClientProxy",null,[]);var W;(function(da){da[da.none=0]="none";da[da.singleLineRibbon=1]="singleLineRibbon";
da[da.multipleLineRibbon=2]="multipleLineRibbon";da[da.slideShowToolbar=3]="slideShowToolbar";da[da.slideShowKeyboardShortcut=4]="slideShowKeyboardShortcut";da[da.liveBroadcast=5]="liveBroadcast"})(W||(W={}));Object(K.b)("TranscriptionEntryPoint",W);var O=d(668),Y=d(69);d.d(Z,"a",function(){return S});class S{constructor(){this.kf=this.r$=this.NC=this.cfb=this.Mr=this.kb=this.la=this.Tb=this.Hc=null;this.qCb=!1;this.Kl=null;this.mfb=this.khc=0;this.QAg=!1;this.fIa=this.eIa="";this.a4c=!1;this.wAe=
"";this.Spe=0;this.QBb=this.ZX=this.bFb="";this.eO=null;this.qwa={};this.gma=new E;this.d$=new Q(this.gma);S.$Dj()}init(da,fa,ka,ha,F,na,ba){z.a.J(512495707,830,50,"SlideshowSubtitles.Init");this.kf=fa;this.la=da;this.Hc=ka;this.kb=ha;this.Kl=F;this.Tb=na;this.eO=ba;this.Mr=document.createElement("div");this.Mr.id="SubtitleContainer";this.Mr.className="SubtitleContainer";this.Mr.style.display=Y.a.Gf;this.Mr.style.visibility=Y.a.Ms;this.cfb=document.createElement("div");this.cfb.id="SubtitleResultDiv";
this.cfb.className="SubtitleResultDiv";this.Hc.RTi&&(this.cfb.style.direction="rtl");this.NC=document.createElement("span");this.NC.id="SubtitleResultSpan";this.NC.className="SubtitleResultSpan";this.NC.setAttribute("aria-hidden","true");this.r$=document.createElement("span");this.r$.id="SubtitleAccessibilitySpan";this.r$.className="SubtitleAccessibilitySpan";this.r$.innerText="";this.r$.setAttribute("lang",this.Hc.hza);this.r$.setAttribute("aria-live","assertive");this.r$.setAttribute("aria-label",
ResourceStrings.L_SubtitleAccessibilityWindow);this.r$.setAttribute("aria-atomic","true");this.cfb.appendChild(this.NC);this.cfb.appendChild(this.r$);this.Mr.appendChild(this.cfb);this.kf.appendChild(this.Mr);k.a.instance.pb(this.NC,()=>!1);e.AFrameworkApplication.fa.vda?this.Om():e.AFrameworkApplication.fa.jf(Object(r.a)(this,this.Om,"onFullAppSettingsReady"))}Om(){this.bFb=this.getUserId();this.ZX=e.AFrameworkApplication.fa.Ha("TenantId");this.QBb=this.la.hostAuthType||e.AFrameworkApplication.fa.Ha("HostAuthType")||
"Unknown"}getUserId(){let da=e.AFrameworkApplication.fa.Ha("PptEditingUserId");n.a.Wa(da)&&(da=e.AFrameworkApplication.fa.Ha("LoggableUserId"),z.a.J(512495706,822,50,"GetUserId PptEditingUserId is empty. LoggableUserId is null or empty {0}",n.a.Wa(da)));return da}KSk(){this.Mr.style.display=Y.a.Gf;this.Mr.style.visibility=Y.a.Ms}transcribe(da,fa,ka,ha,F,na){this.Ezb()&&(this.Kl.instance.show(ResourceStrings.L_SubtitleDetection_SoundReminder,O.a.Mcd),this.khc=window.setTimeout(Object(r.a)(this,this.hbe,
"hideSoundReminderNotification"),3E3));this.uzl(fa,ka,ha,this.Hc);this.d$&&(this.d$.microphoneDeviceId=this.eO.microphoneDeviceId);this.Hc.Kh&&this.d$.WDj()?(this.qwa.StartTime=na,this.qwa.LastError="ErrorNone",this.qwa.EntryPoint=W[F],this.gma.l8h(Object(r.a)(this,this.a3g,"onFinalRecognitionTextHandler")),this.gma.i$h(Object(r.a)(this,this.D4g,"onPartialRecognitionTextHandler")),this.gma.f8h(Object(r.a)(this,this.j6g,"onSpeechProxyErrorHandler")),this.gma.h8h(Object(r.a)(this,this.k6g,"onSpeechProxyEventUpdateHandler")),
this.gma.gai(Object(r.a)(this,this.l6g,"onSpeechRecognitionStartedHandler")),this.d$.Gxh(),this.d$.setCustomSetting("clientMetadata",JSON.stringify(this.AZf())),this.NC.innerText="["+ResourceStrings.L_SubtitleInitMessage+"]",this.NC.style.color="rgba( 255, 255, 0, 1 )",this.setVisibility(5!==F),this.fGc(),this.kb.LFc(Object(r.a)(this,this.Qwa,"onGetCurrentSlideDimensionsHandler")),this.kb.nPa(Object(r.a)(this,this.bfd,"onSlideChangedHandler"))):this.yYe()}AZf(da=""){const fa=w.b(e.AFrameworkApplication.fa.appSettings.SessionStartInfoJson.toString()),
ka={};ka.userID=this.bFb;ka.tenantId=this.ZX;ka.identityProvider=this.QBb;ka.audienceChannel="";ka.audienceGroup=fa.Ring||"Unknown";ka.buildVersion=e.AFrameworkApplication.buildVersion||"Unknown";ka.locale=this.la.rJa||"Unknown";ka.wacHost=fa.Host||"Unknown";ka.wacDatacenter=fa.WACDatacenter||"Unknown";ka.livePragueSessionInfo=da;return ka}yYe(){this.Mr.style.display=Y.a.Gf;this.Mr.style.visibility=Y.a.Ms;this.d$.Ill();this.gma.iTk(Object(r.a)(this,this.a3g,"onFinalRecognitionTextHandler"));this.gma.xUk(Object(r.a)(this,
this.D4g,"onPartialRecognitionTextHandler"));this.gma.dTk(Object(r.a)(this,this.j6g,"onSpeechProxyErrorHandler"));this.gma.fTk(Object(r.a)(this,this.k6g,"onSpeechProxyEventUpdateHandler"));this.gma.bVk(Object(r.a)(this,this.l6g,"onSpeechRecognitionStartedHandler"));this.kb.ikd(Object(r.a)(this,this.Qwa,"onGetCurrentSlideDimensionsHandler"));this.kb.fib(Object(r.a)(this,this.bfd,"onSlideChangedHandler"));this.Ezb()&&this.Kl.instance.hide();this.qwa.EndTime=Date.now();z.a.J(512495705,817,15,JSON.stringify(this.qwa,
S.Mvl));this.qwa={};this.Hc.Wub=!1}fGc(){let da=3;this.qwa.LastPosition=this.Hc.Ov;"AboveSlide"===this.Hc.Ov&&this.Mr.style.visibility===Y.a.xz?(this.Mr.style.display=Y.a.Lya,this.Mr.style.backgroundColor="black",this.Mr.style.bottom="auto"):"BelowSlide"===this.Hc.Ov&&this.Mr.style.visibility===Y.a.xz?(this.Mr.style.display=Y.a.Lya,this.Mr.style.backgroundColor="black",this.Mr.style.bottom="3%",da=-1):"TopOverlay"===this.Hc.Ov?(this.Mr.style.display=Y.a.Lya,this.Mr.style.backgroundColor="transparent",
this.Mr.style.bottom="auto",da=5):"BottomOverlay"===this.Hc.Ov&&(this.Mr.style.display=Y.a.Lya,this.Mr.style.backgroundColor="transparent",this.Mr.style.bottom="5%",da=-1);this.qCb&&document.getElementById("LiveURLBarLayerHost")?this.Mr.style.top=-1<da?String.format("calc({0}% + {1})",da.toString(),"26px"):"auto":(this.Mr.style.top=-1<da?da.toString()+"%":"auto",this.Atf())}isVisible(){return this.Mr.style.visibility===Y.a.xz}FBh(da,fa=""){A.QJf=da?["Live","Subtitles"]:["Subtitles"];this.qCb=da;this.setVisibility(this.Mr.style.visibility===
Y.a.xz);this.fGc();this.d$.setCustomSetting("clientMetadata",JSON.stringify(this.AZf(fa)));this.d$.setCustomSetting("slideIndex",this.Spe);this.d$.setCustomSetting("currentSpeechModes",JSON.stringify(A.QJf))}Vfa(da){this.Mr.style.cursor=da?"default":"none"}Atf(){this.NC.style.fontSize=Math.floor(this.Mr.clientHeight/2/1.5).toString()+"px";this.wAe=Math.floor(this.Mr.clientHeight/12-2)+"px";this.NC.style.display="inline"}setVisibility(da){this.Mr?(null===da&&(da=this.Mr.style.visibility===Y.a.Ms),
this.Mr.style.visibility=da?Y.a.xz:Y.a.Ms):z.a.J(509703457,817,50,"SlideshowSubtitles::setVisibility SubtitleContainer is null")}Qwa(){this.Atf()}bfd(da,fa){this.Spe=fa.slideIndex;this.d$.pTj()&&this.qCb&&(this.d$.setCustomSetting("currentSlideIndex",this.Spe),z.a.J(512495704,817,50,"SlideshowSubtitles::OnSlideChangedHandler Updated current slide index for live"))}setMicrophoneState(da){da?(this.d$.izk(),this.coc(),this.a4c=!0,this.Tb&&this.Tb.instance&&this.Tb.instance.Vph()):(this.d$.Gxh(),this.Tb&&
this.Tb.instance&&this.Tb.instance.Wph())}hbe(){this.Ezb()&&(window.clearTimeout(this.khc),this.Kl.instance.hide())}uzl(da,fa,ka,ha){A.sourceLanguage=ha.Eoa;A.targetLanguages=ha.clb;A.podSessionId=da;A.KIh=fa;A.docId=ka;A.webServiceBase=this.la.podsWebServiceBase;A.speechFDBase=e.AFrameworkApplication.fa.Ha("715");da=!!this.Tb&&!!this.Tb.instance&&(this.Tb.instance.LRa||this.Tb.instance.Yq);A.speechMode=this.Tb&&this.Tb.instance&&this.Tb.instance.sr&&this.Tb.instance.jDa||da?"Live":"Subtitles"}fNf(da,
fa){this.QAg||(this.NC.style.color="rgba( 255, 255, 255, 1 )",window.clearTimeout(this.mfb),this.NC.innerText=this.Clj(da,fa),this.NC.scrollTop=this.NC.scrollHeight,this.mfb=window.setTimeout(Object(r.a)(this,this.coc,"resetSubtitlesToEmpty"),1E4),fa&&(this.r$.innerText=da,this.r$.focus()),this.NC.style.padding=n.a.Wa(da)?"0px":this.wAe)}nv(da){this.QAg||(this.NC.style.color="rgba( 255, 255, 0, 1 )",n.a.Wa(da)&&(da=ResourceStrings.L_SubtitleGenericErrorMessage),window.clearTimeout(this.mfb),this.NC.innerText=
"["+da+"]",this.NC.scrollTop=this.NC.scrollHeight,this.mfb=window.setTimeout(Object(r.a)(this,this.coc,"resetSubtitlesToEmpty"),1E4),this.NC.style.padding=this.wAe,this.r$.innerText="",this.r$.focus())}Wuj(da){if(null!==da)switch(da){case "NotAllowedError":case "NotFoundError":case "NotReadableError":case "MicrophoneError":this.nv(ResourceStrings.L_SubtitleAudioDeviceErrorMessage);this.qwa.LastError="MicrophoneError";break;case "FailedToConnect":this.nv(ResourceStrings.L_SubtitleRetryErrorMessage);
this.qwa.LastError="FailedToConnect";break;case "AccessDenied":case "UnknownError":case "Timeout":this.nv(ResourceStrings.L_SubtitleGenericErrorMessage);this.qwa.LastError="FailedToCreateSpeechSession";break;default:z.a.J(512495703,830,15,"HandleSpeechProxyError {0}",da)}}a3g(da,fa){this.Mr.style.visibility!==Y.a.Ms&&this.fNf(fa[this.Hc.clb],!0)}D4g(da,fa){this.Mr.style.visibility!==Y.a.Ms&&this.fNf(fa[this.Hc.clb],!1)}j6g(da,fa){z.a.J(512495702,830,10,"OnSpeechProxyErrorHandler {0}",fa);(da=fa.toString())&&
(-1<da.indexOf("NotAllowedError")||-1<da.indexOf("NotFoundError")||-1<da.indexOf("NotReadableError")||-1<da.indexOf("MicrophoneError"))&&this.Ezb()&&this.Kl.instance.show(ResourceStrings.L_SubtitleDetection_NoMicrophone,O.a.uYa);this.Wuj(da)}l6g(da,fa){({SlideShowCoreFrame:da}=d(722));const {SlideshowFrame:ka}=d(988);z.a.J(512495701,830,50,"OnSpeechRecognitionStartedHandler {0}",fa.toString());Object(v.a)(da,this.kb)?Object(C.a)(da,this.kb).sfd(fa.toString()):Object(v.a)(ka,this.kb)&&this.la.ihd&&
Object(C.a)(ka,this.kb).sfd(fa.toString());this.coc();this.Ezb()&&this.Kl.instance.hide()}k6g(da,fa){if(this.Ezb())switch(da=fa.eventName,da){case "MediaEvent":"AudioDeviceConnected"===fa.mediaStatus&&this.Kl.instance.show(ResourceStrings.L_SubtitleDetection_MicReady,O.a.Mcd);break;case "ConnectionRetry":this.Kl.instance.show(ResourceStrings.L_SpeechGenericRetryErrorMessage,O.a.uYa);this.nv(ResourceStrings.L_SubtitleGenericErrorMessage);break;case "QualityStatusUpdate":const ka=fa.shortCode;da=fa.longCode;
const ha=fa.shortString,F=fa.longString;switch(fa.severity){case 0:this.Kl.instance.hide();break;case 1:(fa=0<ka?S.uY[ka]:ha)&&this.Kl.instance.show(fa,O.a.$Fb);break;case 2:(fa=0<ka?S.uY[ka]:ha)&&this.Kl.instance.show(fa,O.a.uYa),fa=null===da?F:S.uY[da],n.a.Wa(fa)||(window.clearTimeout(this.mfb),this.nv(fa),this.mfb=window.setTimeout(Object(r.a)(this,this.coc,"resetSubtitlesToEmpty"),3E4))}break;default:z.a.J(512495700,830,50,"OnSpeechProxyEventUpdateHandler Event {0}",da)}}Ezb(){return this.la.pptEditorVoiceUXEnabled&&
!!this.Kl&&!!this.Kl.instance}coc(){this.NC.style.color="rgba( 255, 255, 255, 1 )";this.NC.innerText="";this.NC.scrollTop=this.NC.scrollHeight;this.fIa=this.eIa="";this.a4c=!1;this.mfb=0;this.NC.style.padding="0px"}Clj(da,fa){this.a4c?this.ddi(da):this.gWk(da);this.a4c=fa;return n.a.Wa(this.eIa)||n.a.Wa(this.fIa)?n.a.Wa(this.eIa)?this.fIa:this.eIa:this.eIa+"\n"+this.fIa}ddi(da){this.eIa=n.a.Wa(this.fIa)?this.eIa:this.fIa;this.fIa=da}gWk(da){n.a.Wa(this.eIa)||n.a.Wa(this.fIa)?this.eIa=da:this.fIa=
da}static get instance(){return S.Qp}static $Dj(){S.uY[1]=ResourceStrings.L_SubtitleDetection_Listening;S.uY[2]=ResourceStrings.L_SubtitleDetectionText_AudioQualityIssue;S.uY[3]=ResourceStrings.L_SubtitleDetectionText_HighBackgroundNoise;S.uY[4]=ResourceStrings.L_SubtitleDetectionText_SpeakingTooLoud;S.uY[5]=ResourceStrings.L_SubtitleDetection_SpeakingTooQuiet}static Mvl(da,fa){return"undefined"===typeof fa?null:fa}}S.uY=Array(20);S.Qp=new S;Object(K.a)(S,"SlideshowSubtitles",null,[597])},992:function(K,
Z,d){K=d(0);var k=d(25),e=d(54),n=d(55),r=d(268),v=d(309);class C{constructor(Sa,Na=null){this.dWh=Sa;this.uS=Na||v.a.V5d(e.a.j6a,"")}get Ju(){return this.dWh}get Mb(){return this.uS}HTe(Sa){this.Mb.d++;return this.Ju.HTe(Sa)}zLb(Sa){this.Mb.e++;return this.Ju.zLb(Sa)}GH(Sa){this.Mb.f++;return this.Ju.GH(Sa)}H_a(Sa){this.Mb.h++;return this.Ju.H_a(Sa)}JY(Sa){this.Mb.i++;return this.Ju.JY(Sa)}GY(Sa){this.Mb.j++;return this.Ju.GY(Sa)}R5(Sa){this.Mb.k++;return this.Ju.R5(Sa)}IY(Sa){this.Mb.l++;return this.Ju.IY(Sa)}xTe(Sa){this.Mb.m++;
return this.Ju.xTe(Sa)}AKa(Sa,Na=!1){this.Mb.n++;return this.Ju.AKa(Sa,Na)}z$d(){this.Mb.o++;return this.Ju.z$d()}oXe(){this.Mb.p++;return this.Ju.oXe()}NKb(Sa){this.Mb.m++;return this.Ju.NKb(Sa)}Ls(Sa){this.Mb.q++;return this.Ju.Ls(Sa)}noa(Sa){this.Mb.r++;return this.Ju.noa(Sa)}gLb(Sa){this.Mb.g++;return this.Ju.gLb(Sa)}fod(Sa){return this.Ju.fod(Sa)}N_a(Sa){this.Mb.s++;return this.Ju.N_a(Sa)}Lnd(Sa){this.Mb.s++;return this.Ju.Lnd(Sa)}Pfa(Sa){this.Mb.s++;return this.Ju.Pfa(Sa)}M_a(Sa){this.Mb.s++;
return this.Ju.M_a(Sa)}Ajb(Sa){this.Mb.t++;return this.Ju.Ajb(Sa)}god(Sa){this.Mb.u++;return this.Ju.god(Sa)}ppc(Sa){this.Mb.v++;return this.Ju.ppc(Sa)}qoa(Sa){return this.Ju.qoa(Sa)}jnd(Sa){this.Mb.z++;return this.Ju.jnd(Sa)}tQe(){return this.Ju.tQe()}FKa(Sa,Na){this.Mb.w++;this.Mb.x++;return this.Ju.FKa(Sa,Na)}m1(Sa){this.Mb.y++;return this.Ju.m1(Sa)}clearFormatting(){return this.Ju.clearFormatting()}clone(){return new C(this.Ju.clone(),this.Mb)}}Object(K.a)(C,"FormattingStewardUsageCollector",
null,[1132]);class w extends C{constructor(Sa,Na=null){super(Sa,Na)}get n5(){return this.Ju}get eE(){return this.n5.eE}set eE(Sa){this.n5.eE=Sa}get textIndent(){return this.n5.textIndent}get marginLeft(){return this.n5.marginLeft}get Qfd(){return this.n5.Qfd}get lineSpacing(){return this.n5.lineSpacing}get Yfa(){return this.n5.Yfa}get I0c(){return this.n5.I0c}get nfa(){return this.n5.nfa}get paragraph(){return this.n5.paragraph}set paragraph(Sa){this.n5.paragraph=Sa}get G8a(){return this.n5.G8a}ssd(Sa){return this.n5.ssd(Sa)}a1e(Sa){return this.n5.a1e(Sa)}clone(){const Sa=
this.Ju.clone();return new w(Sa,this.Mb)}}Object(K.a)(w,"FormattingStewardUsageCollector",C,[1131,1132]);var z=d(31),A=d(74),u=d(181),E=d(667),H=d(52),I=d(145),J=d(72),T=d(57),D=d(347),R=d(1082),Q=d(335),W=d(45),O=d(1194),Y=d(1189),S=d(1188),da=d(111),fa=d(38),ka=d(81),ha=d(40),F=d(36),na=d(86),ba=d(305);class Ea{}Ea.yellow="FFFF00";Ea.lime="00FF00";Ea.aqua="00FFFF";Ea.fuchsia="FF00FF";Ea.blue="0000FF";Ea.red="FF0000";Ea.navy="000080";Ea.teal="008080";Ea.green="008000";Ea.purple="800080";Ea.maroon=
"800000";Ea.olive="808000";Ea.gray="808080";Ea.Wil="C0C0C0";Ea.black="000000";Object(K.a)(Ea,"FontHighlightColorEnum",null,[]);var La=d(338),ta=d(49),oa=d(878),wa=d(367),ra=d(107);class ya{constructor(Sa,Na,ua,za,Wa,yb,Za,ub,Ib=null,Ob=!1){this.Rv=this.hBc=null;this.HUb=0;this.e7e=this.GUb=null;this.m2=0;this.mOa=this.zDc=this.Lzc=this.hDc=this.w3a=this.Hha=this.Yzc=this.MDc=null;this.FKf=.25*da.Font.pI;this.paragraph=Sa;this.Kf=Na;this.BK=ua;this.vP=za;this.dha=Wa;this.EV=yb;this.qZ=Za;this.F2a=
ub;Ib?(ra.a(4223818,307,!!Ib.Rv),this.Rv=Ib.Rv.hJc(this.paragraph),this.HUb=Ib.HUb,this.GUb=Ib.GUb,Ib.Hha&&(this.Hha=new oa.a,this.Hha.afterSpacing.value=Ib.Hha.afterSpacing.value,this.Hha.beforeSpacing.value=Ib.Hha.beforeSpacing.value),Ib.w3a&&(this.w3a=Ib.w3a.clone()),this.m2=Ib.m2,this.zDc=Ib.zDc.clone(),this.MDc=Ib.MDc,this.Yzc=Ib.Yzc,this.hDc=Ib.hDc,this.Lzc=Ib.Lzc,Ib.nfa&&(this.mOa=Ib.nfa)):(this.Rv=new ba.a(this.paragraph,0),this.Rv.formatting=new La.a(this.Rv,D.a.nil),Na=ta.a.zQa(Sa),Na=this.vP.ps(Na),
this.w5k(Na),ya.Iel(Sa)?(this.dha.ATe(this.Rv.formatting,Na,Ob),this.m2=Sa.Sa(fa.a.Il)?Sa.eb(fa.a.Il):0):this.m2=-1,this.HUb=0,this.GUb=null,this.Hha=this.y6i(),this.F2a&&(this.Hha=this.dha.JW(Sa),this.w3a=this.dha.B6d(Sa),this.hDc=this.dha.TSa(Sa),this.Lzc=this.dha.v8(Sa)),this.zDc=new R.DictionaryPropertySet,this.dha.lTe(this.Rv.formatting,Sa,Ob))}get paragraph(){return this.hBc}set paragraph(Sa){ra.a(4223816,307,!!Sa&&z.ParagraphReader.Yd(Sa));this.hBc=Sa}get G8a(){return this.Rv.formatting}get wkc(){return this.HUb}get z8g(){return this.GUb}get L2(){return this.e7e}get eE(){return this.m2}set eE(Sa){ra.a(4223817,
307,1===Sa||2===Sa||3===Sa||F.a.instance.ga(54)&&6===Sa);this.m2=Sa}get textIndent(){return this.MDc}get marginLeft(){return this.Yzc}get Qfd(){return this.Hha}get lineSpacing(){return this.w3a}get Yfa(){return this.hDc}get I0c(){return this.Lzc}get nfa(){return this.mOa}w5k(Sa){const Na=this.vP.language(Sa);Na&&this.Kf.mpc(this.Rv.formatting,Na,0,Sa.cache.wUa,!1)}y6i(){if(F.a.instance.ga(54))return null;const Sa=new oa.a;Sa.afterSpacing.value=this.FKf;Sa.beforeSpacing.value=this.FKf;return Sa}HTe(Sa){(Sa=
r.a.ue(Sa))&&this.Kf.I_a(this.Rv.formatting,Sa.LCID);return!0}zLb(){return!1}GH(Sa){this.Kf.GH(this.Rv.formatting,Sa);return!0}H_a(Sa){this.Kf.setItalic(this.Rv.formatting,Sa);return!0}JY(Sa){this.Kf.JY(this.Rv.formatting,Sa);return!0}GY(Sa){this.Kf.GY(this.Rv.formatting,Sa);return!0}R5(Sa){this.Kf.R5(this.Rv.formatting,Sa);return!0}IY(Sa){this.Kf.IY(this.Rv.formatting,Sa);return!0}xTe(Sa){if(0>=Sa)return!1;this.Kf.ir(this.Rv.formatting,Sa);return!0}AKa(Sa,Na){if(!Sa||""===Sa)return!1;if(({fontInfo:ua}=
Q.FontUtils.cvl(Sa)).returnValue)return this.Kf.TU(this.Rv.formatting,ua.fontName),!0;var ua=!1;const za=Q.FontUtils.$F(Sa);Na&&this.l_c(za,this.EV)&&(this.EV.createFontUrl(Sa),ua=!0);this.l_c(za,this.qZ)&&(ua=!0);ua&&this.Kf.TU(this.Rv.formatting,za);return ua}l_c(Sa,Na){return!!Na&&Na.isEnabled&&Na.l_c(Sa)}z$d(){this.Kf.wUc(this.Rv.formatting);return!0}oXe(){this.Kf.Jpd(this.Rv.formatting);return!0}NKb(Sa){if(0>=Sa)return!1;this.Kf.NKb(this.Rv.formatting,Sa);return!0}Ls(Sa){var {Box4PasteSteward:Na}=
d(248);if(!this.Kf.Jjg(Sa)){if(null===Sa||""===Sa)return!1;Sa=Na.b7a(Sa)}Na=null;this.nfa&&this.nfa.hasOwnProperty(ha.a.listLevel.id.toString())&&(Na=this.nfa[ha.a.listLevel.id.toString()]);this.Kf.Ls(this.Rv.formatting,Sa,Na);return!0}noa(Sa){const {Box4PasteSteward:Na}=d(248);if(!Sa||""===Sa||F.a.instance.ga(49)&&!ya.Hnj().contains(Sa)||this.dha.Vth(this.Rv.formatting))return!1;this.Kf.noa(this.Rv.formatting,Na.b7a(Sa));return!0}gLb(Sa){this.Kf.gLb(this.Rv.formatting,Sa);return!0}fod(Sa){let Na=
0;switch(W.a.og(Sa)){case "small-caps":Na=1;break;case "uppercase":Na=2}this.Kf.Dm(this.Rv.formatting,ka.a.capitalization,Na);return!0}jnd(Sa){const {Box4PasteSteward:Na}=d(248);if(!Sa||""===Sa)return!1;this.zDc.setValue(fa.a.wIc,parseInt(Na.b7a(Sa),16));return!0}M_a(Sa){return 0>=Sa?!1:this.Lnd(na.StyleReader.xjj(Sa))}N_a(Sa){this.clearFormatting();this.HUb=Sa;return!0}Lnd(Sa){const {Box4PasteSteward:Na}=d(248);return Sa&&0<Sa.length&&Na.PMb&&Na.PMb.WG(Sa)?(this.GUb=Sa,!0):!1}Pfa(Sa){const {Box4PasteSteward:Na}=
d(248);return Sa&&0<Sa.length&&Na.PMb&&Na.PMb.WG(Sa)?(this.e7e=Sa,!0):!1}a1e(Sa){if(this.L2){Sa=d(248).Box4PasteSteward.PMb||na.StyleReader.iL(Sa);if(!Sa)return ra.a(41968715,307,!1),!1;(Sa=Sa.WG(this.L2))&&this.Kf.Pfa(this.Rv.formatting,Sa);return!0}return!1}FKa(Sa,Na){if(F.a.instance.ga(54))return!1;ra.a(5297416,307,0<=Sa&&0<=Na);0<=Sa&&(this.Hha.beforeSpacing.value=Sa);0<=Na&&(this.Hha.afterSpacing.value=Na);return 0<=Sa||0<=Na}m1(Sa){if(!F.a.instance.ga(54)||!Sa)return!1;const Na=parseFloat(W.a.substring(Sa,
0,W.a.og(Sa).indexOf("px")));if(!isNaN(Na))return this.w3a=new wa.a(3,O.a.rfa(Na,1)),!0;Sa=parseFloat(W.a.substring(Sa,0,W.a.og(Sa).indexOf("%")));return isNaN(Sa)?!1:(this.w3a=new wa.a(2,Sa/100),!0)}Ajb(Sa){let Na=0;if(!Sa||""===Sa)return!1;switch(Sa){case "left":Na=1;break;case "center":Na=2;break;case "right":Na=3;break;case "justify":F.a.instance.ga(54)&&(Na=6)}if(0===Na)return!1;this.eE=Na;return!0}god(Sa){this.MDc=Sa;return!0}ppc(Sa){this.Yzc=Sa;return!0}qoa(Sa){this.mOa=JSON.parse(Sa);return this.nfa?
!0:!1}clearFormatting(){this.Rv.formatting=new La.a(this.Rv,D.a.nil);return!0}tQe(){this.m2=0;return!0}ssd(Sa){var {Box4PasteSteward:Na}=d(248);if(!F.a.instance.ga(71))return!1;if(0<this.wkc&&Na.dJa[this.wkc]){ra.a(4223819,307,1<=this.wkc);ra.a(4223820,307,7>=this.wkc);Na=na.StyleReader.iL(Sa);if(!Na)return ra.a(4223821,307,!1),!1;Na=Na.WG(d(248).Box4PasteSteward.dJa[this.wkc]);this.BK.paa(Na,Sa,!1);return!0}if(this.z8g){Na=d(248).Box4PasteSteward.PMb||na.StyleReader.iL(Sa);if(!Na)return ra.a(41968716,
307,!1),!1;this.BK.paa(Na.WG(this.z8g),Sa,!1);return!0}return!1}clone(){return new ya(this.paragraph,this.Kf,this.BK,this.vP,this.dha,this.EV,this.qZ,this.F2a,this)}static Hnj(){ya.NP||(ya.NP=new Y.a(S.a.jp()),ya.NP.add(Ea.yellow),ya.NP.add(Ea.lime),ya.NP.add(Ea.aqua),ya.NP.add(Ea.fuchsia),ya.NP.add(Ea.blue),ya.NP.add(Ea.red),ya.NP.add(Ea.navy),ya.NP.add(Ea.teal),ya.NP.add(Ea.green),ya.NP.add(Ea.purple),ya.NP.add(Ea.maroon),ya.NP.add(Ea.olive),ya.NP.add(Ea.gray),ya.NP.add(Ea.Wil),ya.NP.add(Ea.black));
return ya.NP}static Iel(Sa){if(!F.a.instance.ga(71))return!0;Sa=na.StyleReader.tQ(na.StyleReader.XD(Sa));return Sa===na.StyleReader.gJh||Sa===na.StyleReader.iMa||Sa===na.StyleReader.jJh||Sa===na.StyleReader.Hoa}}ya.NP=null;Object(K.a)(ya,"FormattingSteward",null,[1131,1132]);class Da{o1e(){return!1}T$d(Sa){return Sa}qoa(){}eLb(){}zYc(){return!1}get uZc(){return!1}m1(){}FKa(){}Yqh(){}Pph(){}get Yth(){return!1}}Object(K.a)(Da,"NoOpPasteStewardBridge",null,[304]);var pa=d(17);class la{constructor(Sa,
Na){this.Zjk=Sa;this.$jk=Na||"Normal"}}Object(K.a)(la,"NoteTagInfoBox4",null,[]);const Fa=Sa=>{const Na=new pa.a;for(let ua of Sa)Sa=new la(ua.Zjk,ua.$jk),Na.add(Sa);return Na};d.d(Z,"a",function(){return Qa});class Qa{constructor(Sa,Na,ua=null,za=null){this.qZ=this.EV=null;this.TYi=k.AFrameworkApplication.fa.ka("FollowDestinationFormattingPasteIsEnabled");this.Rif=0;this.Ab=Sa;this.xG=Na;this.gZ=za||new Da;this.uS=ua||v.a.V5d(e.a.j6a,"")}get Mb(){return this.uS}get characterPropertiesEditor(){return Qa.Zg||
(Qa.Zg=n.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}get fontService(){return this.EV||(this.EV=n.a.instance.rb("Box4.IFontService"))}get DCa(){return this.qZ||(this.qZ=n.a.instance.rb("Box4.CustomFontService"))}reset(){}get q1b(){return this.f5d(!1)}f5d(Sa){ra.a(4223770,307,T.OutlineElementReader.Wg(this.Ab));const Na=H.OutlineElementNavigator.wi(this.Ab);H.OutlineElementNavigator.Oe(this.Ab);ra.a(4223771,307,!!Na&&z.ParagraphReader.Yd(Na));Sa=new ya(Na,Qa.kh,Qa.gP,Qa.GZi,Qa.HZi,this.fontService,
this.DCa,this.TYi,void 0,Sa);return new w(Sa,this.Mb)}N0(){}lna(){}NYa(){}kna(){}jna(){}Owa(){}Nwa(){}nA(){}mA(){}HYa(){}GYa(){}Twa(){}WIa(){}ona(){}mna(){}Swa(){}nna(){}IYa(){}CFb(Sa){T.OutlineElementReader.Wg(this.Ab)?(Qa.Ph.g8b(this.Ab,!0),H.OutlineElementNavigator.yJ(this.Ab,!1,!1)):J.OutlineReader.Ut(this.Ab)?I.OutlineNavigator.F$(this.Ab)?Sa?(this.Ab.Mi(),Qa.wB.JZ(this.Ab,!1)):Qa.Ph.xnc(this.Ab):Qa.wB.JZ(this.Ab,!1):ra.a(8128524,307,!1,"Unexpected node type {0} encountered",this.Ab.ri)}DSa(Sa){let Na=
null;if(Sa&&Sa.BU&&Sa.cultureName)try{Na=Object.assign(new E.a,{languageId:r.a.ue(Sa.cultureName).LCID})}catch(ua){ra.a(8128526,307,!1,"Setting up culture {0} encountered {1}",Sa.cultureName,ua)}Na||null==this.xG||(Na=Object.assign(new E.a,{languageId:this.xG}));return Na}get pM(){return this.Rif}set pM(Sa){this.Rif=Sa}LGc(){}esd(){}PTd(){}get $6a(){return!1}get o7a(){return!1}BYj(Sa){let Na=1;if(Sa.xhg){var ua=0;switch(Sa.listStyleType){case 1:Na=0;break;case 7:Na=1;break;case 8:Na=2;break;case 9:Na=
3;break;case 10:Na=4;break;case 11:Na=5}}else switch(ua=1,Sa.listStyleType){case 1:Na=0;break;case 3:Na=1;break;case 4:Na=2;break;case 5:Na=3}let za;ua=(za=A.ListReader.g8a)?u.a.pN(ua,Na,Fa(Sa.t5),Sa.listId,Sa.listLevel,Sa.levelText,Sa.font):u.a.pN(ua,Na,Fa(Sa.t5));Sa.xhg&&!Sa.THj&&(ua.qA=za&&0<Sa.listId&&0<=Sa.listLevel&&!Sa.jHb?Sa.Vkl:Sa.GHi);this.gZ.eLb(this.Ab,ua,Sa);return ua}mY(){}jY(){}lY(){}kY(){}iY(){}hY(){}static get Ph(){return Qa.Di||(Qa.Di=n.a.instance.resolve("Box4.IOutlineElementEditor"))}static get wB(){return Qa.Nx||
(Qa.Nx=n.a.instance.resolve("Box4.IOutlineEditor"))}static get kh(){return Qa.Kf||(Qa.Kf=n.a.instance.resolve("Box4.IFormattingEditor"))}static get gP(){return Qa.BK||(Qa.BK=n.a.instance.resolve("Box4.Styles.IStyleEditor"))}static get GZi(){return Qa.vP||(Qa.vP=n.a.instance.resolve("Box4.IFormattingReader"))}static get HZi(){return Qa.dha||(Qa.dha=n.a.instance.resolve("Box4.Actors.IFormattingStewardBridge"))}}Qa.Di=null;Qa.Nx=null;Qa.Zg=null;Qa.Kf=null;Qa.BK=null;Qa.vP=null;Qa.dha=null;Object(K.a)(Qa,
"Box4PasteStewardBase",null,[1105,1106,386])},995:function(K,Z,d){d.r(Z);K=d(0);var k=d(712),e=d(1014),n=d(1E3),r=d(199),v=d(13),C=d(38),w=d(72),z=d(30),A=d(37),u=d(26),E=d(41);class H{constructor(S,da){this.ke=S;this.ag=da}}Object(K.a)(H,"RowSpan",null,[]);class I{constructor(S){this.pB=S;this.aIa=[]}GNd(S,da){Array.add(this.aIa,new H(S,da))}XZk(S){for(let da=0;da<this.aIa.length;da++){const fa=this.aIa[da];S<=fa.ke&&fa.ke++;S<=fa.ag&&fa.ag++}}get x(){return this.pB}get Dlh(){return this.aIa}static Ale(S,
da){return S.pB===da}static RUd(S,da){S=S.pB-da.pB;return 0<S?1:0>S?-1:0}}Object(K.a)(I,"ColSplit",null,[]);const J=(S,da,fa)=>{let ka;ka=-1;for(let ha=0;ha<S.length;++ha)if(fa(S.ga(ha),da))return ka=ha,{returnValue:!0,Cxb:ka};return{returnValue:!1,Cxb:ka}};class T{constructor(S,da){this.fe=S;this.Nf=da}}Object(K.a)(T,"ColSpan",null,[]);class D{constructor(S){this.qB=S;this.aIa=[]}GNd(S,da){Array.add(this.aIa,new T(S,da))}Pti(S){for(let da=0;da<this.aIa.length;da++){const fa=this.aIa[da];S<=fa.fe&&
fa.fe++;S<=fa.Nf&&fa.Nf++}}get tEf(){return this.aIa}get y(){return this.qB}static Ale(S,da){return S.qB===da}static RUd(S,da){S=S.qB-da.qB;return 0<S?1:0>S?-1:0}}Object(K.a)(D,"RowSplit",null,[]);var R=d(946),Q=d(27);class W{constructor(S,da,fa,ka,ha,F,na,ba,Ea,La,ta,oa,wa,ra,ya){this.lUa=!1;this.Zi=this.uIc=this.MTg=this.L$c=null;this.gEh=S;this.Uc=da;this.dxh=fa;this.k0a=ka;this.vud=ha;this.tableNode=F;this.Ld=na;this.TY=ba;this.DSa=Ea;this.YZk=La;this.Qti=ta;this.Cld=oa;this.qJc=wa;this.rows=
ra;this.cols=ya;this.l0a=0;this.n$b=!1}g6a(S){this.L$c=new Date;this.MTg=S}S7a(){this.L$c>Q.App.Um&&this.Uc&&this.Uc.Va(this.MTg,(+new Date-+this.L$c).toString());this.L$c=Q.App.Um}finish(){const {TableMergeSplitEditor:S}=d(995);this.Uc&&(this.Zi&&(this.n$b=!1,this.Uc.Va(S.pHl,this.Zi.message)),this.Uc.Va("SplitCellsSucceeded",this.n$b.toString()),this.Uc.finish(),this.Uc=null);if(this.Zi)throw this.Zi;this.dxh&&this.dxh(this.n$b,this.k0a)}}Object(K.a)(W,"SplitCellsArguments",null,[]);var O=d(327);
d.d(Z,"TableMergeSplitEditor",function(){return Y});class Y{constructor(S,da,fa,ka,ha,F,na,ba,Ea,La,ta,oa,wa,ra,ya){this.Pb=S;this.XX=da;this.jA=fa;this.Y4=ka;this.W$c=ha;this.PL=F;this.D8c=na;this.Iq=Ea;this.Yda=La;this.jfc=ta;this.Uk=oa;this.Jb=wa;this.pa=ra;this.W9c=ya}merge(S,da,fa){const ka=S.qf(da.ke,da.fe),ha=this.Pb.Nc(ka);let F=ha.TA(1);const na=[A.a.rowId,A.a.cellId];F&&ha.zc();let ba=!0;for(let La=da.ke;La<da.ag;++La){let ta=S.qf(La,da.fe);for(let oa=da.fe+(La===da.ke?1:0);oa<da.Nf;++oa)if(oa!==
da.fe&&(ta=S.qf(La,oa)),!ta||!ta.isGhostCell){ta.ao(A.a.rowSpan,A.a.colSpan);ta.isGhostCell=!0;var Ea=z.GraphIterator.nb(ta);w.OutlineReader.isEmpty(Ea)?this.Jgh(Ea):(ba&&w.OutlineReader.isEmpty(ha)&&(ba=!1,F=null,this.Jgh(ha)),this.PL.lZi(ta,wa=>{this.PL.Ux(ha.currentNode,wa,na);return!0},wa=>11===wa.type||22===wa.type||12===wa.type),Ea=this.Pb.$5d(Ea),Ea.Bb(1),this.PL.bik(ha,F,Ea.role,Ea.role,Ea),Ea.axb(1),F=Ea.currentNode)}}this.Y4.xxl(fa,ka,da);ka.rowSpan=da.OO;ka.colSpan=da.sR;S.setValue(A.a.complexTable,
!0);this.D8c.YOe(S);S.qda(511);this.jA.l8b(S);return ka}ckl(S,da,fa,ka,ha,F,na,ba,Ea){if(1>=fa&&1>=ka)Ea&&Ea(!0,da);else{var La=new Date,ta=E.a.Ik("SplitCells",1);ta.Nj=!0;var oa=new k.a,wa=new e.a,ra=new e.a,ya=this.Yda.gDa(S,ha,da);da=this.Iq.nOc(ha,da);var Da=F.K3f();for(F=F.HYf();ya.moveNext();){oa.add(ya.t4b().id.toString());const Qa=ya.Wz;for(var pa=1;pa<fa;pa++){var la=Da[Qa.ke];la+=(Da[Qa.ag]-la)*pa/fa;var Fa=void 0;({Cxb:Fa}=J(wa,la,D.Ale)).returnValue||(Fa=wa.length,wa.add(new D(la)));wa.ga(Fa).GNd(Qa.fe,
Qa.Nf)}for(pa=1;pa<ka;pa++)la=F[Qa.fe],la+=(F[Qa.Nf]-la)*pa/ka,({Cxb:Fa}=J(ra,la,I.Ale)).returnValue||(Fa=ra.length,ra.add(new I(la))),ra.ga(Fa).GNd(Qa.ke,Qa.ag)}wa=wa.toArray();ra=ra.toArray();wa.sort((Qa,Sa)=>D.RUd(Sa,Qa));ra.sort((Qa,Sa)=>I.RUd(Sa,Qa));ta.Va("Prep",(+new Date-+La).toString());La=this.Jb.le(15);La.nc(S);S=new W(La,ta,Ea,da,oa,S,na,ha,ba,Da,F,wa,ra,fa,ka);S=new n.a(null,Object(v.a)(this,this.jkl,"splitRowSeams"),S);S.Oi=!1;S.Nl("SplitTableCells");S.run()}}jkl(S,da){try{for(da.g6a("SplitRowSeams");da.l0a<
da.Cld.length;){const fa=({lUa:da.lUa}=this.MAi(da.tableNode,da.Ld,da.TY,da.DSa,da.YZk,da.Cld[da.l0a])).returnValue;da.l0a++;if(da.lUa){let ka;(ka=da.k0a).ag=ka.ag+1;for(let ha=0;ha<da.qJc.length;ha++)da.qJc[ha].XZk(fa)}if(S.Ooa)return!0}da.S7a();da.l0a=0;S.$g(Object(v.a)(this,this.gkl,"splitColSeams"))}catch(fa){da.Zi=fa,S.$g(Object(v.a)(this,this.Hkb,"tearDownSplit"))}return!0}gkl(S,da){try{for(da.g6a("SplitColSeams");da.l0a<da.qJc.length;){const fa=({lUa:da.lUa}=this.LAi(da.tableNode,da.Ld,da.TY,
da.DSa,da.Qti,da.qJc[da.l0a])).returnValue;da.l0a++;if(da.lUa){let ka;(ka=da.k0a).Nf=ka.Nf+1;for(let ha=0;ha<da.Cld.length;++ha)da.Cld[ha].Pti(fa)}if(S.Ooa)return!0}da.S7a();da.l0a=0;S.$g(Object(v.a)(this,this.vOb,"updateIsComplexTableProperty"))}catch(fa){da.Zi=fa,S.$g(Object(v.a)(this,this.Hkb,"tearDownSplit"))}return!0}vOb(S,da){try{da.g6a("UpdateComplex"),this.D8c.t2e(this.Pb.Nc(da.tableNode)),da.S7a(),da.uIc=this.Yda.gDa(da.tableNode,da.TY,da.k0a),S.$g(Object(v.a)(this,this.VXi,"fixSplitCells"))}catch(fa){da.Zi=
fa,S.$g(Object(v.a)(this,this.Hkb,"tearDownSplit"))}return!0}VXi(S,da){try{for(da.g6a("FixInsideBorders");da.uIc.moveNext();)if(da.vud.contains(da.uIc.t4b().id.toString())&&this.UXi(da.tableNode,da.TY,da.uIc,da.rows,da.cols),S.Ooa)return!0;da.S7a();S.$g(Object(v.a)(this,this.gRi,"ensureMinRowHeightColumnWidth"))}catch(fa){da.Zi=fa,S.$g(Object(v.a)(this,this.Hkb,"tearDownSplit"))}return!0}gRi(S,da){try{da.g6a("EnsureMinHeightWidth"),1<da.rows&&this.hRi(da.tableNode,da.k0a),1<da.cols&&this.fRi(da.tableNode,
da.k0a),da.S7a(),S.$g(Object(v.a)(this,this.setSelection,"setSelection"))}catch(fa){da.Zi=fa,S.$g(Object(v.a)(this,this.Hkb,"tearDownSplit"))}return!0}setSelection(S,da){try{da.g6a("SetSelection");da.n$b=!da.k0a.JRa();if(da.n$b){const fa=this.W9c.rGi(da.tableNode,da.TY,da.k0a);fa&&this.pa.ME(fa)}da.S7a();da.g6a("Render");S.Oi||da.gEh.cqh(S);da.gEh.dispose();S.$g(Object(v.a)(this,this.Hkb,"tearDownSplit"))}catch(fa){da.Zi=fa,S.$g(Object(v.a)(this,this.Hkb,"tearDownSplit"))}return!0}Hkb(S,da){da.S7a();
da.finish();return!1}MAi(S,da,fa,ka,ha,F){var na;let ba=({oje:na}=R.c(ha,F.y)).returnValue;if(na=!na){ba++;var Ea=ha[ba-1],La=ha[ba],ta=this.Pb.Nc(S);this.yic(ta,ba-1);var oa=ta.currentNode;ta=this.D8c.gde(ta);Ea=F.y-Ea;oa.setValue(A.a.mu,da.rf(Ea,1));Ea=La-F.y;ta.setValue(A.a.mu,da.rf(Ea,1));Array.insert(ha,ba,F.y);fa.VTa(3)}for(da=0;da<F.tEf.length;++da){ha=F.tEf[da];La=[];for(oa=ha.fe;oa<=ha.Nf;++oa)({Vka:Ea}=this.W$c.VCh(S,fa,oa,ba)),La[La.length]=Ea;oa=new O.a;oa.fe=ha.fe;oa.Nf=ha.Nf;oa.ke=ba-
1;oa.ag=ba+1;for(oa=this.Yda.gDa(S,fa,oa);oa.moveNext();)Ea=oa.Wz,ta=oa.t4b(),this.IGf(ba,Ea.fe,ta),this.nph(ba,Ea.fe,ta,ka);for(oa=ha.fe;oa<ha.Nf;++oa){Ea=S.qf(ba-1,oa);ta=S.qf(ba,oa);var wa=this.Iq.uI(fa,ba-1,oa);wa.fe===oa&&(Ea=S.qf(wa.ke,wa.fe),wa=ba-wa.ke,ta.rowSpan=Ea.rowSpan-wa,Ea.rowSpan=wa,ta.colSpan=Ea.colSpan);ta.isGhostCell=Ea.isGhostCell}fa.VTa(1);this.Y4.B2d(S,fa,ba,ha.fe,ha.Nf,!0);for(let ra=ha.fe,ya=0;ra<=ha.Nf;++ra,++ya)La[ya]&&this.Y4.JUe(S,fa,ra,ba,ba+1,La[ya])}return{returnValue:ba,
lUa:na}}LAi(S,da,fa,ka,ha,F){var na;let ba=({oje:na}=R.b(ha,F.x)).returnValue;if(na=!na){ba++;var Ea=ha[ba-1],La=ha[ba],ta=this.Pb.Nc(S);this.XX.pZg(ta);ta.Zp(ba-1,1);this.D8c.fde(ta);if(ta=S.sa(C.a.Tu,null))ta=r.a.clone(ta),ta[ba-1]=da.rf(F.x-Ea,0),ta[ba]=da.rf(La-F.x,0),S.setValue(C.a.Tu,ta);Array.insert(ha,ba,F.x);fa.VTa(3)}for(da=0;da<F.Dlh.length;++da){ha=F.Dlh[da];Ea=[];for(La=ha.ke;La<=ha.ag;++La)({Vka:ta}=this.W$c.RCh(S,fa,La,ba)),Ea[Ea.length]=ta;La=new O.a;La.ke=ha.ke;La.ag=ha.ag;La.fe=
ba-1;La.Nf=ba+1;for(La=this.Yda.gDa(S,fa,La);La.moveNext();){ta=La.Wz;var oa=La.t4b();this.IGf(ta.ke,ba,oa);this.nph(ta.ke,ba,oa,ka)}for(La=ha.ke;La<ha.ag;++La){ta=S.qf(La,ba-1);oa=S.qf(La,ba);var wa=this.Iq.uI(fa,La,ba-1);wa.ke===La&&(ta=S.qf(wa.ke,wa.fe),wa=ba-wa.fe,oa.colSpan=ta.colSpan-wa,ta.colSpan=wa,oa.rowSpan=ta.rowSpan);oa.isGhostCell=ta.isGhostCell}fa.VTa(1);this.Y4.D2d(S,fa,ba,ha.ke,ha.ag,!0);for(let ra=ha.ke,ya=0;ra<=ha.ag;++ra,++ya)Ea[ya]&&this.Y4.DTe(S,fa,ra,ba,ba+1,Ea[ya])}return{returnValue:ba,
lUa:na}}UXi(S,da,fa,ka,ha){var F=this.Yda.gDa(S,da,fa.oE);F.moveTo(fa.DO,fa.GL);fa=F.Wz;for(let na=1;na<ka;++na)F.lik(),fa.ag=F.Wz.ag,fa.Nf=F.Wz.Nf;for(ka=1;ka<ha;++ka)F.moveNext(),fa.ag=F.Wz.ag,fa.Nf=F.Wz.Nf;for(ha=this.Yda.gDa(S,da,fa);ha.moveNext();){F=ha.Wz;let na;F.ag<fa.ag&&({Vka:na}=this.W$c.RCh(S,da,fa.ag,F.fe)).returnValue&&this.Y4.DTe(S,da,F.ag,F.fe,F.Nf,na);F.Nf<fa.Nf&&({Vka:na}=this.W$c.VCh(S,da,fa.Nf,F.ke)).returnValue&&this.Y4.JUe(S,da,F.Nf,F.ke,F.ag,na)}}hRi(S,da){S=this.Pb.Nc(S);this.yic(S,
da.ke);for(let fa=da.ke;fa<da.ag;++fa){const ka=S.currentNode.sa(A.a.mu,0);ka&&ka<this.Uk.bIc(S.currentNode)&&S.currentNode.setValue(A.a.mu,0);S.Af(1)}}fRi(S,da){let fa=S.sa(C.a.Tu,null),ka=!1;if(fa){fa=r.a.clone(fa);for(let ha=da.fe;ha<da.Nf;++ha){const F=this.Uk.gsb(S,ha);fa[ha]&&fa[ha]<F&&(fa[ha]=F,ka=!0)}}ka&&S.setValue(C.a.Tu,fa)}IGf(S,da,fa){const ka=fa.getContainingTable();ka||u.a.J(512495627,822,10,"Not able to access TableNode from Table Cell Node");ka.qf(S,da).cellShading=fa.cellShading}nph(S,
da,fa,ka){const ha=fa.getContainingTable();ha||u.a.J(512495625,822,10,"Not able to access TableNode from Table Cell Node");S=z.GraphIterator.nb(ha.qf(S,da));this.jfc.JZ(S,!0,ka(fa))}yic(S,da){for(this.XX.pZg(S);0<da--;)this.XX.rik(S)}Jgh(S){S=this.Pb.$5d(S);let da=S.Bb(1);for(;da;)da=S.aRa(1)}}Object(K.a)(Y,"TableMergeSplitEditor",null,[487])},996:function(K,Z,d){K=d(0);var k=d(13),e=d(382),n=d(25),r=d(164),v=d(195),C=d(55);class w{constructor(R,Q,W,O){this.BEd=null;this.Rwc=O;this.zba=R;this.Aba=
Q;this.pP=W;this.pmf=this.dXg.Wcl;R=CommonUIStrings.l_OICErrorMacOfficeOffer.split("{0}");this.fVh=R[0];this.eVh=R[1]}get dXg(){return this.BEd||(this.BEd=C.a.instance.resolve("Common.IMacOfficeOffer"))}get id(){return"OICErrorDialog"}get errorMessage(){return CommonUIStrings.l_OICErrorMessage}get BTa(){return CommonUIStrings.l_OICErrorHelpLink}get mqc(){return this.pmf}get fXg(){return this.fVh}get eXg(){return this.eVh}get cXg(){return CommonUIStrings.l_OICErrorMacOFficeLink}get icon(){return this.pmf?
3:2}get Q2b(){return CommonUIStrings.l_OICErrorFileDownloadOffer}get ZJc(){return!!this.Aba}get R2b(){return CommonUIStrings.l_OICErrorNoOfficeDownloadButton}get $Qa(){return CommonUIStrings.l_DefaultDialogTitle}zNe(R){this.Wic(R)}jme(R){this.Wic(R)}Wic(R){let Q=10;this.Aba&&1===R&&(this.Aba(this.pP),Q=1);this.zba&&this.zba(this.pP);this.xp(Q)}hgb(){v.Redirect.showHelp("OICFailure");this.xp(2)}uEe(){this.dXg.Kmg();this.xp(4)}xp(R){e.ULS.sendTraceTag(18715410,211,10,"Report OICErrorDialog. Dialog cause: {0}, solution: {1}",
this.Rwc,R);n.AFrameworkApplication.qib(r.a.k7g,this.Rwc,R)}dispose(){this.pP=this.zba=this.Aba=null}}Object(K.a)(w,"AOICErrorDialog",null,[106]);var z=d(91),A=d(106);class u extends w{constructor(R,Q,W,O){super(R,Q,W,O);this.RNa=this.Ez=null;R=document.createElement("span");R.id="errorMessageText";R.innerText=this.errorMessage;R.appendChild(document.createElement("br"));R.appendChild(document.createElement("br"));this.Ez=document.createElement("a");this.Ez.href="#";this.Ez.innerText=this.BTa;R.appendChild(this.Ez);
z.a.addHandler(this.Ez,"click",Object(k.a)(this,this.hgb,"oicErrorHelpLinkHandler"));Q=new A.StandardDialog;Q.ig=this.id;this.mqc?(W=document.createElement("span"),O=document.createElement("span"),W.innerText=this.fXg,O.innerText=this.eXg,this.RNa=document.createElement("a"),this.RNa.href="#",this.RNa.innerText=this.cXg,R.appendChild(document.createElement("br")),R.appendChild(W),R.appendChild(this.RNa),R.appendChild(O),z.a.addHandler(this.RNa,"click",Object(k.a)(this,this.uEe,"oicErrorMacOfferLinkHandler"))):
this.ZJc&&(R.appendChild(document.createElement("br")),R.appendChild(document.createElement("br")),W=document.createElement("span"),W.innerText=this.Q2b,R.appendChild(W));this.ZJc?(Q.xd=1,Q.Xe(1,this.R2b)):Q.xd=0;Q.Bx(this.$Qa,null,this.icon,Object(k.a)(this,this.jme,"legacyOICErrorDialogHandler"),R);Q.O5("errorMessageText")}dispose(){this.Ez&&(z.a.removeHandler(this.Ez,"click",Object(k.a)(this,this.hgb,"oicErrorHelpLinkHandler")),this.Ez=null);this.RNa&&(z.a.removeHandler(this.RNa,"click",Object(k.a)(this,
this.uEe,"oicErrorMacOfferLinkHandler")),this.RNa=null);super.dispose()}}Object(K.a)(u,"OICErrorDialog",w,[]);class E{constructor(R,Q,W){this.zba=Q;this.Aba=R;this.pP=W}get id(){return"OICErrorDialogWithDownload"}get PQf(){return CommonUIStrings.l_OICErrorNoOfficeDetected}get BTa(){return CommonUIStrings.l_OICErrorHelpLink}get Q2b(){return CommonUIStrings.l_OICErrorFileDownloadOffer}get R2b(){return CommonUIStrings.l_OICErrorNoOfficeDownloadButton}get icon(){return 2}get $Qa(){return CommonUIStrings.l_DefaultDialogTitle}zNe(R){this.Wic(R)}jme(R){this.Wic(R)}Wic(R){let Q=
10;1===R&&(this.Aba(this.pP),Q=1);this.zba&&this.zba(this.pP);this.xp(Q)}hgb(){v.Redirect.showHelp("OICFailure");this.xp(2)}xp(R){n.AFrameworkApplication.qib(r.a.l7g,3,R)}dispose(){this.pP=this.Aba=this.zba=null}}Object(K.a)(E,"AOICErrorDialogWithDownload",null,[106]);class H extends E{constructor(R,Q,W){super(R,Q,W);this.Ez=null;R=document.createElement("span");R.id="errorMessageText";R.innerText=this.PQf;R.appendChild(document.createElement("br"));R.appendChild(document.createElement("br"));this.Ez=
document.createElement("a");this.Ez.href="#";this.Ez.innerText=this.BTa;R.appendChild(this.Ez);z.a.addHandler(this.Ez,"click",Object(k.a)(this,this.hgb,"oicErrorHelpLinkHandler"));R.appendChild(document.createElement("br"));R.appendChild(document.createElement("br"));Q=document.createElement("span");Q.innerText=this.Q2b;R.appendChild(Q);Q=new A.StandardDialog;Q.ig=this.id;Q.xd=1;Q.Xe(1,this.R2b);Q.Bx(this.$Qa,null,this.icon,Object(k.a)(this,this.jme,"legacyOICErrorDialogHandler"),R);Q.O5("errorMessageText")}dispose(){this.Ez&&
(z.a.removeHandler(this.Ez,"click",Object(k.a)(this,this.hgb,"oicErrorHelpLinkHandler")),this.Ez=null);super.dispose()}}Object(K.a)(H,"OICErrorDialogWithDownload",E,[]);var I=d(80);class J extends w{constructor(R,Q,W,O){super(R,Q,W,O);Q={["errorMessage"]:this.errorMessage};Q.helpLink={["type"]:"AppLinkProps",["id"]:"helpLink",["text"]:this.BTa,["onExecute"]:Y=>{this.hgb(Y)}};this.mqc?(Q.macOfficePreLinkText=this.fXg,Q.macOfficeLink={["type"]:"AppLinkProps",["id"]:"macOfficeLink",["text"]:this.cXg,
["onExecute"]:Y=>{this.uEe(Y)}},Q.macOfficePostText=this.eXg):this.ZJc&&(Q.errorFileDownloadOffer=this.Q2b);R=new I.a(!1,!1,!0);this.ZJc?(R.xd=1,R.Xe(1,this.R2b)):R.xd=0;R.ig=this.id;Q={["id"]:this.id,["dialogIcon"]:this.icon,["bodyControls"]:Q};R.$i(this.$Qa,Object(k.a)(this,this.zNe,"reactOICErrorDialogHandler"),Q)}}Object(K.a)(J,"ReactOICErrorDialog",w,[]);class T extends E{constructor(R,Q,W){super(R,Q,W);Q={["errorMessage"]:this.PQf,["errorFileDownloadOffer"]:this.Q2b};Q.helpLink={["type"]:"AppLinkProps",
["id"]:"helpLink",["text"]:this.BTa,["onExecute"]:O=>{this.hgb(O)}};R=new I.a(!1,!1,!0);R.xd=1;R.Xe(1,this.R2b);R.ig=this.id;Q={["id"]:this.id,["dialogIcon"]:this.icon,["bodyControls"]:Q};R.$i(this.$Qa,Object(k.a)(this,this.zNe,"reactOICErrorDialogHandler"),Q)}}Object(K.a)(T,"ReactOICErrorDialogWithDownload",E,[]);d.d(Z,"a",function(){return D});class D{constructor(){this.Vpa=!!n.AFrameworkApplication.Aa&&n.AFrameworkApplication.Aa.hb.uC}bEi(R,Q,W){this.Vpa?new J(R,Q,null,W):new u(R,Q,null,W)}cEi(R,
Q,W){this.Vpa?new T(R,Q,W):new H(R,Q,W)}dEi(R,Q,W,O,Y){const {ReactOICErrorDialogWithTrial:S}=d(1100),{OICErrorDialogWithTrial:da}=d(1101);this.Vpa?new S(R,Q,W,null,O,Y):new da(R,Q,W,null,O,Y)}static get instance(){return D.Ka||(D.Ka=new D)}}D.Ka=null;Object(K.a)(D,"OICErrorDialogFactory",null,[1347])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/18430998/wdjs/ppteditDS.ext.js.map