'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[8],{1124:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k{constructor(){this.authority=this.userId=this.upn=null;this.authorityType=0;this.tenantId=null;this.supportsAuthToken=this.isAnonymous=!1;this.authority=this.userId=this.upn="";this.authorityType=0;this.tenantId="";this.isAnonymous=!0;this.supportsAuthToken=!1}static o2i(e){switch(e){case 0:return"external";case 2:return"aad";case 1:return"msa";
default:return"external"}}}Object(K.a)(k,"WopiAuthContext",null,[880])},1222:function(K,Z,d){d.r(Z);var k=d(0),e=d(68),n=d(382),r=d(13),v=d(25),C=d(196),w=d(141),z;(function(t){t[t.error=0]="error";t[t.warning=1]="warning";t[t.tip=2]="tip";t[t.intelligentService=3]="intelligentService"})(z||(z={}));Object(k.b)("AccessibilityRuleCategory",z);var A=d(55),u=d(71),E=d(35),H=d(129),I=d(192),J=d(107);class T{constructor(t,P,ia=null){this.nvd=null;this.ddf=this.zcf=!1;this.sBa=t;this.Puc=P;this.Ca=ia;this.zn.ya(E.a.jti,
u.a.frame,Object(r.a)(this,this.QK,"closePane"))}get zn(){return this.Ca||(this.Ca=v.AFrameworkApplication.Ta)}set zn(t){this.Ca=t}sQi(){this.zcf||(this.sBa.initialize(this),this.Puc.initialize(this),this.zcf=!0)}fFe(){J.c(19969184,200,50,"{0}",{["AccCheckInvoked"]:1});this.Puc.h_k()}em(t,P,ia){if(1===ia)return C.SessionStatusManager.instance.eka?8:32;this.sBa.isVisible||this.sQi();this.Kgl();return 32}QK(t,P,ia){1!==ia&&this.sBa.zr();return 32}MGe(){this.sBa.Yuh(!0)}EZd(t){if(t){if(t.AccessibilityRules&&
Object.keys(t.AccessibilityRules).length){const ia=t.AccessibilityRules;for(let Aa in ia){var P=Aa;const Ka=ia[Aa].RuleId+"";P!==Ka&&J.c(36214998,200,15,"AccessibilityRules is malformed: rule ID {0} maps to rule with ID {1}",P,Ka)}this.nvd=ia}else!this.nvd&&t.Results&&0<t.Results.length?(J.c(18993251,200,15,"No accessibility rule definitions available"),t.IsSuccess=!1):t.AccessibilityRules=this.nvd;t.IsSuccess||J.c(19969185,200,50,"{0}",{["accCheckFailed"]:1});this.cSk(t);this.g2j(t);this.sBa.EZd(t)}}cSk(t){const P=
t.AccessibilityRules;if(t=t.Results)for(let ia=t.length-1;0<=ia;ia--){const Aa=t[ia];let Ka="";const pb=Aa.RuleId;Aa.ContentName||(Ka+="Result does not have content name. ");pb in P||(Ka+=String.format("No accessibility check rule exists for ID {0}.",pb));0<Ka.length&&(J.c(36214999,200,15,"Omitting invalid accessibility check result: "+Ka),Array.removeAt(t,ia))}}Fgj(){return v.AFrameworkApplication.fa.ka("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("accessibility-checker-pane-strings"):
A.a.instance.resolve("Common.IDynamicScriptLoaderProvider").Pw.loadScript("accessibility-checker-pane-strings")}Kgl(){this.ddf?this.sBa.em():this.Fgj().then(()=>{this.ddf=!0;this.sBa.em()}).catch(t=>n.ULS.sendTraceTag(540034694,334,10,"Failed to load the resources for the accessibilityChecker feature: {0}",t))}g2j(t){var P={};const ia={};var Aa=t.Results,Ka=[];Array.add(Ka,Object.assign(new H.a,{name:"FinalViolationCount",int64:0}));Array.add(Ka,Object.assign(new H.a,{name:"FinalErrorCount",string:"0"}));
Array.add(Ka,Object.assign(new H.a,{name:"FinalWarningCount",string:"0"}));Array.add(Ka,Object.assign(new H.a,{name:"FinalTipCount",string:"0"}));Array.add(Ka,Object.assign(new H.a,{name:"FinalIntelligentServiceCount",string:"0"}));if(Aa){for(const kc of Aa)if(t.AccessibilityRules){var pb=t.AccessibilityRules[kc.RuleId];if(pb){if(P[z[pb.Category]]){let Rc=P[z[pb.Category]];P[z[pb.Category]]=++Rc}else P[z[pb.Category]]=1;ia[kc.RuleId]?(pb=ia[kc.RuleId],ia[kc.RuleId]=++pb):ia[kc.RuleId]=1}}Ka[0].int64=
Aa.length;for(var Nb in P)switch(t=P[Nb],Aa=Nb,Aa="Final"+Aa.charAt(0).toUpperCase()+Aa.substring(1,Aa.length)+"Count",Aa){case "FinalErrorCount":Ka[1].string=t.toString();break;case "FinalWarningCount":Ka[2].string=t.toString();break;case "FinalTipCount":Ka[3].string=t.toString();break;case "FinalIntelligentServiceCount":Ka[4].string=t.toString()}}w.a.sendTelemetryEvent(Object.assign(new I.a,{name:String.format("{0}.{1}","Office.UX.AccChecker","AccCheckerViolationInformation"),dataFields:Ka}));for(let kc in ia)P=
kc,Ka=ia[kc],Nb=[],Array.add(Nb,Object.assign(new H.a,{name:"RuleID",string:P})),Array.add(Nb,Object.assign(new H.a,{name:"FinalViolationCount",string:Ka.toString()})),w.a.sendTelemetryEvent(Object.assign(new I.a,{name:String.format("{0}.{1}","Office.UX.AccChecker","AccCheckerFinalViolationCountPerRule"),dataFields:Nb}))}dispose(){this.sBa&&this.sBa.dispose();this.Puc&&this.Puc.dispose()}}Object(k.a)(T,"AAccessibilityCheckManager",null,[180,106]);var D=d(79),R=d(1186),Q=d(61),W=d(295),O=d(26);class Y extends T{constructor(t,
P,ia,Aa,Ka,pb,Nb,kc,Rc){super(t,P);this.seb=this.BHa=null;this.Fa=ia;this.zb=Aa;this.Lq=Ka;this.PX=pb;this.ua=Nb;this.pa=kc;this.Sb=Rc;this.Oze=!1}f6k(t){if(!t)return O.a.J(19227927,334,15,"Cannot navigate since violation data is null"),!1;if(t.sldIdField){var P=new Q.a(Object.assign(new W.a,{Sid:t.sldIdField.sidField,Cid:t.sldIdField.cidField}));P=this.Sb.Vja(P);if(!P)return!1;let ia=null;if(t.spIdFieldSpecified&&(ia=P.kC(t.spIdField),!ia&&this.Oze))return!1;this.f2k(P,ia)}else O.a.J(19227929,334,
15,"There is no slide id info in violation data");return!0}fFe(){this.Oze=!1;super.fFe()}MGe(){this.Oze=!0;super.MGe()}f2k(t,P){if(t){const ia=this.ua.Ba!==t?!0:!1;P&&(this.seb=P,ia?this.Lq.$V(Object(r.a)(this,this.iGb,"onActiveSlideDomChanged")):this.Knh());ia&&(this.PX.Ba=t);this.pa.Vx();this.Fa.Ed()}}iGb(){this.Lq.Una(Object(r.a)(this,this.iGb,"onActiveSlideDomChanged"));this.BHa||(this.BHa=new D.a(2,1,0,Object(r.a)(this,this.FGe,"onPostActiveSlideDomChangedTask"),90,"20"),this.zb.Eb(this.BHa))}FGe(){this.BHa=
null;this.Knh()}Ed(){this.PX.GK.np||this.Fa.Ed()}Knh(){if(this.seb){const t=Object(R.a)(117,this.seb.tg(this.PX.GK.Ma));t?t.Al?O.a.J(19227931,334,50,"Shape view element of node {0} has been disposed",this.seb.id):t.$p?t.zpd():this.pa.selectShape(this.seb,!0):O.a.J(19227933,334,50,"Try select node {0} but cannot find its shape view element",this.seb.id);this.Ed();this.seb=null}}}Object(k.a)(Y,"PptAccCheckManager",T,[]);class S{constructor(){this.AccessibilityRules=null;this.IsSuccess=this.IsPartialResult=
!1;this.Results=null}static deserialize(t){t=Sys.Serialization.JavaScriptSerializer.deserialize(t);const P=t.AccessibilityRules,ia={};if(P)for(let Aa=0;Aa<P.length;++Aa){const Ka=P[Aa];ia[Ka.Key]=Ka.Value}t.AccessibilityRules=ia;return t}}Object(k.a)(S,"AccessibilityCheckResultCollection",null,[]);class da{}Object(k.a)(da,"AccessibilityCheckResult",null,[]);class fa{}Object(k.a)(fa,"AccessibilityCheckRule",null,[]);class ka{constructor(t){this.pMa=null;this.uaf=t}get fileId(){return this.uaf?this.uaf():
null}initialize(t){this.pMa=t}O1g(t){this.pMa.EZd(t)}}Object(k.a)(ka,"AAccessibilityCheckService",null,[187,106]);var ha=d(17),F=d(108);class na extends F.a{constructor(){super()}$k(){return 56}}Object(k.a)(na,"AccCheckRequest",F.a,[]);var ba=d(242);class Ea extends ka{constructor(t,P){super(null);this.vi=t;this.eXa=P}h_k(){const t=new ba.a(new na,Object(r.a)(this,this.nlk,"onAccCheckSucceed"),Object(r.a)(this,this.mlk,"onAccCheckFailed"));this.vi.Eb(t)}dispose(){}get KGj(){return 0<this.eXa.oXb.length}nlk(t){if(t&&
t.ACResult&&(t=this.Cii(t.ACResult))){this.O1g(t);O.a.J(19227935,334,50,"Acc-check succeeded");return}this.nXg("Succeeded but response is invalid")}mlk(t){this.nXg(t.toString());return!0}nXg(t){O.a.J(19227937,334,50,String.format("Acc-check failed: {0}",t));t=new S;t.IsSuccess=!1;this.O1g(t)}Cii(t){if(t){var P=null;try{P=JSON.parse(t)}catch(ia){return O.a.J(19227939,334,10,"Cannot parse acc-check result json: {0}",ia.toString()),null}if(P){t=new S;t.IsSuccess=!0;t.IsPartialResult=P.isPartialResultField;
t.AccessibilityRules={};if(P.violatedRulesField){const ia=new ha.a;for(const Aa of P.violatedRulesField)if(P=this.Eii(Aa)){t.AccessibilityRules[P.RuleId]=P;for(const Ka of Aa.violationsField){const pb=new da;pb.RuleId=P.RuleId;pb.ContentName=Ka.labelField;pb.ContentId=Ka;ia.add(pb)}}t.Results=ia.toArray()}return t}}return null}Eii(t){if(!t)return null;if(t.ruleIdField>=this.eXa.oXb.length)return O.a.J(19227971,334,10,"Rule id {0} is bigger than total rule info list count {1}",t.ruleIdField,this.eXa.oXb.length),
null;const P=new fa;P.RuleId=t.ruleIdField.toString();P.RuleName=this.eXa.oXb[t.ruleIdField].ruleTextField;switch(this.eXa.oXb[t.ruleIdField].ruleTypeField){case 0:P.Category=0;break;case 1:P.Category=1;break;case 2:P.Category=2;break;case 3:P.Category=3}return P}}Object(k.a)(Ea,"PptAccCheckService",ka,[798,187,106]);class La{get Fyi(){return CommonUIStrings.l_AccCheckerContentNotFoundDialogActionButton}get Gyi(){return CommonUIStrings.l_AccCheckerContentNotFoundDialogBody}get Hyi(){return CommonUIStrings.l_AccCheckerContentNotFoundDialogTitle}get Kvk(){return CommonUIStrings.l_AccCheckerOutOfSyncNotificationMessageBody}get Nfd(){return CommonUIStrings.l_AccCheckerPaneTitle}get syk(){return CommonUIStrings.l_AccCheckerPartialResultNotification}}
Object(k.a)(La,"AccessibilityCheckStringsProvider",null,[186]);class ta{constructor(){this.Llh=this.contentId=null}}Object(k.a)(ta,"ResultIds",null,[]);var oa=d(65),wa=d(171);class ra{constructor(t,P){this._element=null;this.Jn=P;this.Pg=t}get element(){this._element||(this._element=this.oWd(),this.Pu());return this._element}Ejb(t){this._element=t}dispose(){this.element&&(this.Voa(),this.Ejb(null))}Pu(){this.Jn&&this.Pg?(this.Jn.pb(oa.a.click,this.element,Object(r.a)(this,this.onClick,"onClick")),
this.Pg.pb(oa.a.Zf,this.element,Object(r.a)(this,this.M3g,"onKeyPress"))):n.ULS.shipAssertTag(19789026,334,!1,String.format("ClickInputManager or KeyInputManager is null. Couldn't register events on element ( ID: {0}).",this.element.id))}Voa(){this.Jn&&this.Pg&&(this.Jn.yb(oa.a.click,this.element,Object(r.a)(this,this.onClick,"onClick")),this.Pg.yb(oa.a.Zf,this.element,Object(r.a)(this,this.M3g,"onKeyPress")))}onClick(){this.H3g();return!0}M3g(t){return this.CNj(t.pc.keyCode)?(this.H3g(),!0):!1}CNj(t){return t===
wa.a.QOb||t===wa.a.tq}}Object(k.a)(ra,"AInteractivePaneElement",null,[225,106]);const ya=(t,P,ia)=>{t=document.createElement(t);P&&(t.id=P);ia&&(t.className=ia);t.setAttribute("Unselectable","on");return t};var Da=d(73),pa=d(133),la=d(95);class Fa extends ra{constructor(t,P,ia){super(t,P);this.yWh=ia}hide(){this.element.removeAttribute(pa.a.af);pa.a.bP(this.element,pa.a.JK,pa.a.XB);this.element.style.display="none"}show(){pa.a.bP(this.element,pa.a.JK,pa.a.ura);pa.a.bP(this.element,pa.a.af,pa.a.gQd);
this.element.style.display="block"}oWd(){const t=ya("div",this.K_g,"AccCheckerNotification");pa.a.bP(t,pa.a.hQd,pa.a.XB);pa.a.bP(t,pa.a.D2,this.YDe);t.tabIndex=0;const P=ya("span",this.J_g,"AccCheckerNotificationIcon");var ia=Da.createClusteredImage(16,16,"Info_16x16x32","",!0,"");P.appendChild(ia);ia=ya("span",this.YDe,"AccCheckerNotificationText");la.a.Ix(ia,this.L_g);t.appendChild(P);t.appendChild(ia);return t}H3g(){this.yWh()}}Object(k.a)(Fa,"APopupNotification",ra,[410,225,106]);class Qa extends Fa{constructor(t,
P,ia,Aa){super(t,P,ia);this.Jba=Aa}get K_g(){return"AccCheckerOutOfSyncNotificationId"}get J_g(){return"AccCheckerOutOfSyncNotificationIconId"}get YDe(){return"AccCheckerOutOfSyncNotificationTextId"}get L_g(){return this.Jba.Kvk}}Object(k.a)(Qa,"OutOfSyncNotification",Fa,[]);class Sa extends Fa{constructor(t,P,ia,Aa){super(t,P,ia);this.Jba=Aa}get K_g(){return"AccCheckerPartialResultNotificationId"}get J_g(){return"AccCheckerPartialResultNotificationIconId"}get YDe(){return"AccCheckerPartialResultNotificationTextId"}get L_g(){return this.Jba.syk}}
Object(k.a)(Sa,"PartialResultNotification",Fa,[]);var Na=d(119),ua=d(106);class za{constructor(t,P,ia,Aa=null,Ka=null,pb=null,Nb=null){this.Fkf=this.m7=this.Pg=this.pMa=null;this.ebb=Aa;this.Jn=t;this.Od=P;this.oK=ia;this.Jba=Nb||new La;this.pGd=Ka||new Qa(this.ebb,this.Jn,Object(r.a)(this,this.xLi,"dimissOutOfSyncNotification"),this.Jba);this.FGd=pb||new Sa(this.ebb,this.Jn,Object(r.a)(this,this.yLi,"dimissPartialResultNotification"),this.Jba)}show(){}hide(){}get ebb(){return this.Pg||(this.Pg=v.AFrameworkApplication.Aa.kG)}set ebb(t){this.Pg=
t}zHf(){}zr(){}dispose(){}SEh(){}pnd(){}uGj(t){var P=this.Fkf[t];t=P.contentId;if((P=P.Llh+"")&&P.length){const ia=[];Array.add(ia,Object.assign(new H.a,{name:"RuleID",string:P}));w.a.sendTelemetryEvent(Object.assign(new I.a,{name:String.format("{0}.{1}",za.b_e,"ViolationSelected"),dataFields:ia}))}this.Lik(t)}Lik(t){t&&this.pMa.f6k(t)||(this.Od.tY(Na.AFrame.UV,!1),this.pfl())}xLi(){this.Yuh(!1);this.pnd()}yLi(){this.$uh(!1);this.pnd()}pfl(){const t=Object.assign(new ua.StandardDialog(!0),{yr:v.AFrameworkApplication.tda,
xd:1,e0a:!1});t.jya(1);t.Xe(1,this.Jba.Fyi);t.Xe(0,CommonUIStrings.l_DialogCancel);t.cP(this.Jba.Hyi,this.Jba.Gyi,P=>{1===P&&this.Hge()})}fki(t){let P=null;if(t.Results&&0<t.Results.length){P={};let ia=0;for(const Aa of t.Results)Aa.ResultId=za.W2h+ ++ia,t=new ta,t.contentId=Aa.ContentId,t.Llh=Aa.RuleId,P[Aa.ResultId]=t}return P}o2j(){w.a.addNamespaceMapping(za.b_e,za.Pol);w.a.sendTelemetryEvent(Object.assign(new I.a,{name:String.format("{0}.{1}",za.b_e,"ShowTaskpane")}))}}za.W2h="AccCheckResult";
za.b_e="Office.UX.AccChecker";za.Pol="c4388c977297413bb054bad1acf0ade1-cc58e53e-f5a4-4f37-b0d2-9a8079e34420-6879";Object(k.a)(za,"BaseAccessibilityCheckPane",null,[188,106]);class Wa{constructor(){this.type="AccCheckerTaskPaneProps";this.accessibilityCheckResultCollection=this.onRecheckExecute=null;this.resultsReady=!1;this.helpLink=this.onInvokeNavigateExecute=null;this.partialResult=this.outOfSync=!1;this.showHelpPane=this.updateLastScanTime=null}}Object(k.a)(Wa,"AccCheckerTaskPaneProps",null,[]);
var yb=d(1144),Za=d(279);class ub{constructor(){this.Bvc=new ha.a}TJa(t){this.Bvc.add(t)}t8k(t){for(let P of this.Bvc)P(t)}}Object(k.a)(ub,"ReactTaskPaneManager",null,[223]);var Ib=d(642),Ob=d(140);class Hc extends za{constructor(t,P,ia,Aa,Ka=null,pb=null,Nb,kc=null,Rc=null){super(P,ia,Aa,pb,void 0,void 0,kc);this.m5e=null;this.Sjf=this.EGd=this.bBc=this.CCc=this.nCc=!1;this.PLd=null;this.LKd=!!v.AFrameworkApplication.Aa&&!!v.AFrameworkApplication.Aa.hb&&v.AFrameworkApplication.Aa.hb.Tke;this.JRb=
this.lpa=null;this.hSb=0;this.iyc=null;this.iwd=Ka;Rc&&(this.lpa=Rc.i3h,this.JRb=Rc.GXi,this.hSb=Rc.zxj);this.nqa=new ub}get isVisible(){return this.Sjf}DLb(t){this.Sjf=t}EZd(t){t&&(this.m5e=t,t.IsSuccess&&(this.Fkf=this.fki(t),t.IsPartialResult&&this.$uh(!0)),this.nCc=!0,this.CCc=!1,this.Ctc())}Yuh(t){this.isVisible&&t!==this.bBc&&(this.bBc=t,this.Ctc())}$uh(t){this.EGd=t;this.Ctc()}em(){this.CCc||Ob.UISurfaces.xr().then(t=>{Za.a.instance.z2(Hc.A1a+":PaneOpen:Start");t.showTaskPane(Hc.A1a,this.sca());
this.Hge();return null});this.isVisible?Ob.UISurfaces.xr().then(t=>{t.setSelectedTaskPane(Hc.A1a);return null}):this.o2j()}Ctc(){Ob.UISurfaces.xr().then(t=>{t.updateTaskPane(Hc.A1a,this.sca());return null})}sca(){var t=new Wa;this.nqa.t8k(t);t=Object.assign(new Ib.a,{title:this.Jba.Nfd,hideHeader:!1,width:320,location:2,contentProps:t,onOpen:()=>{this.i6k();this.DLb(!0);v.AFrameworkApplication.Aa.updateCommandUI()},onClose:()=>{this.wnd();this.DLb(!1);this.CCc=this.nCc=!1;this.Ctc();v.AFrameworkApplication.Aa.updateCommandUI()},
isModernPane:!0});this.LKd&&(t.enableResize=!0,t.minResizeWidth=268,t.maxResizeWidth=920);return t}initialize(t){const P=this.Od.Gc(Hc.A1a);P.parent=Na.AFrame.nj;P.zL=!0;this.pMa=t;this.x3h()}dispose(){this.SEh();this.pGd&&(this.pGd.dispose(),this.pGd=null);this.FGd&&(this.FGd.dispose(),this.FGd=null);super.dispose()}x3h(){this.nqa.TJa(this.onRecheckExecute());this.nqa.TJa(this.a1i());this.nqa.TJa(this.Nfj());this.nqa.TJa(this.onInvokeNavigateExecute());this.nqa.TJa(this.y9i());this.nqa.TJa(this.kdj());
this.nqa.TJa(this.Ndj());this.nqa.TJa(this.updateLastScanTime());this.nqa.TJa(this.showHelpPane())}onRecheckExecute(){return t=>{t.onRecheckExecute=()=>{this.Hge()}}}a1i(){return t=>{t.accessibilityCheckResultCollection=this.m5e}}Nfj(){return t=>{t.resultsReady=this.nCc}}onInvokeNavigateExecute(){return t=>{t.onInvokeNavigateExecute=P=>{this.uGj(P)}}}y9i(){return t=>{t.helpLink=this.mTi}}kdj(){return t=>{t.outOfSync=this.bBc}}Ndj(){return t=>{t.partialResult=this.EGd}}updateLastScanTime(){return t=>
{t.updateLastScanTime=P=>{this.PLd=P}}}showHelpPane(){return t=>{t.showHelpPane=()=>{v.AFrameworkApplication.fa&&v.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.WordHelpPaneFix")?v.AFrameworkApplication.nsa||this.Qvf()?this.iyc?this.iyc():this.lpa.value&&this.JRb&&this.hSb&&this.lpa.value.La(this.hSb,2,this.JRb):this.Hvh():this.Qvf()?this.iyc?this.iyc():this.lpa.value&&this.JRb&&this.hSb&&this.lpa.value.La(this.hSb,2,this.JRb):this.Hvh()}}}Qvf(){return!this.iwd||
!this.iwd.value}Hvh(){const t=this.iwd.value;if(t){var P={};P.query=Hc.lYh+Hc.UAd;P=Object.assign(new yb.a,{nonPersistedSettings:P});t.Ufa(Hc.TAd,P)}}Hge(){this.EGd=this.bBc=this.nCc=!1;this.PLd&&this.PLd();this.Ctc();this.CCc=!0;this.pMa.fFe()}i6k(){this.Od.xf(Hc.A1a)}wnd(){this.Ske()&&this.Od.xf(this.Od.X7)}Ske(){return!!this.Od.Be&&this.Od.Be.name===Hc.A1a}}Hc.A1a="AccessibilityCheckerPane";Hc.UAd="a16f6de0-2f39-4a2b-8bd8-5ad801426c7f";Hc.TAd="FA000000012";Hc.lYh="AssetID=";Object(k.a)(Hc,"ReactAccessibilityCheckPane",
za,[]);class kb{constructor(t,P,ia){this.i3h=t;this.GXi=P;this.zxj=ia}}Object(k.a)(kb,"HelpPaneProperties",null,[]);var jb=d(102),hb=d(28);class uc extends Hc{constructor(t,P,ia,Aa,Ka,pb,Nb,kc){super(null,P,ia,Aa,void 0,null,void 0,void 0,new kb(Nb,uc.L5d(),hb.a.Ufa));this.Hfc=t;this.w3j=Ka;this.tH=pb;this.hEg=Nb;this.hB=kc}get isVisible(){return!!this.Hfc&&this.Hfc.isVisible}DLb(t){this.Hfc&&(this.Hfc.isVisible=t)}get mTi(){return this.w3j}em(){this.DLb(!0);this.tH.yM(this.Hfc,!0,ResourceStrings.l_AccessibilityCheckerTaskPaneToolTip,
Na.AFrame.UV);super.em();if(this.hEg){var t=this.hEg.value;if(t){t.processAction(hb.a.CMd,1);t=!1;try{this.hB.selectRibbonTabById("AccessibleAuthoring"),t=!0}catch(P){O.a.J(544736533,822,10,"PptReactAccCheckControl: can't select ribbon tab AccessibleAuthoring: {0}",P.toString())}jb.a("AccessibleAuthoringTab",t)}else O.a.J(544286875,822,10,"PptReactAccCheckControl: can't get IActionManagerExtended to show AccessibleAuthoring Ribbon Tab")}else O.a.J(544265629,822,10,"PptReactAccCheckControl: can't get Lazy<IActionManagerExtended> to show AccessibleAuthoring Ribbon Tab")}Tdd(){}onBeforeLoadContent(){}onAfterLoadContent(){this.pMa&&
this.pMa.MGe()}onAfterFirstSaveContent(){}static L5d(){const t={};t.TE=ResourceStrings.L_Help;t.assetId="FA000000012";t.nonPersistedSettings={query:"AssetID=a16f6de0-2f39-4a2b-8bd8-5ad801426c7f"};return t}}Object(k.a)(uc,"PptReactAccCheckControl",Hc,[797]);class mc{constructor(){this.K=null}get name(){return"PowerPointWebEditor.Accessibility"}$b(t){this.K=t;this.K.register(Ea,"PowerPointWebEditor.Accessibility.PptAccCheckService").as("PowerPointWebEditor.Accessibility.IPptAccCheckService").as("Common.App.AccessibilityChecker.IAccessibilityCheckService").ma().oa(()=>
new Ea(this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.K.resolve("PowerPointWebEditor.IPresentationResourcesManager")));this.K.register(188,"Common.App.AccessibilityChecker.IAccessibilityCheckPane").ma().oa(()=>new uc(this.K.resolve("PowerPointWebEditor.View.IAccCheckPane"),this.K.resolve("Common.IClickInputManager"),this.K.resolve("Common.IFocusManager"),this.K.resolve("Common.IF6Manager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointAccCheckHelpUrl,this.K.resolve("PowerPointWebEditor.ITaskPaneManager"),
this.K.re("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IRibbonUser")));this.K.register(180,"Common.App.AccessibilityChecker.IAccessibilityCheckManager").ma().oa(()=>new Y(this.K.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckPane"),this.K.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckService"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("Common.ITaskManager"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),
this.K.resolve("PowerPointWebEditor.IPPTWorkspace"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.IPresentationReader")))}init(){}dispose(){this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointEnableAccCheck&&(this.K.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckService").dispose(),this.K.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckPane").dispose(),
this.K.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckManager").dispose())}static main(){e.a.instance.Dc(new mc)}}Object(k.a)(mc,"PptAccessibilityPackage",null,[2,3]);var Ya=d(177),Mb=d(1191),Kc=d(236),eb=d(178),Tb=d(527),lb=d(50),Fb=d(122);class rb{constructor(t,P,ia,Aa,Ka,pb,Nb,kc,Rc){this.ia=t;this.la=P;this.x3j=ia;this.y3j=Aa;this.Abb=Ka;this.hB=Nb;this.eXa=pb;this.Fa=kc;this.qc=Rc;this.eXa.K8h(Object(r.a)(this,this.Cfh,"refreshAccCheckButtonStatus"))}vb(){this.la.powerPointEnableAccCheck&&
(this.ia.ra(hb.a.vJe,lb.a.application,Object(r.a)(this,this.Gpi,"checkAccessibility"),4),this.ia.ra(hb.a.pHk,lb.a.application,Object(r.a)(this,this.LGk,"queryCheckAccessibility"),97))}De(){this.la.powerPointEnableAccCheck&&this.Fa.Gc(Fb.a.kzf).bindAction(eb.KeyInputManager.Na(wa.a.Fuc,eb.KeyInputManager.Le|1),hb.a.vJe)}Gpi(t,P,ia,Aa,Ka){return 1===ia?this.qc.Lj()?this.y3j.KGj?32:8:8:this.x3j.em(t,P,ia,Aa,Ka)}LGk(t,P,ia,Aa,Ka){Ka[Tb.a.On]=this.Abb.isVisible;return 32}dispose(){this.eXa.vTk(Object(r.a)(this,
this.Cfh,"refreshAccCheckButtonStatus"))}Cfh(){this.hB.BH()}}Object(k.a)(rb,"AccCheckActor",null,[227,106]);class Qb{constructor(){this.Kac=this.K=null}get name(){return"PowerPointWebEditor.LazyActors"}$b(t){this.K=t}init(){this.K.resolve("PowerPointWebEditor.IAppBootCompletedListener").gyb(()=>{this.Pxb()})}Pxb(){const t=this.K.resolve("Common.AFrameworkApplication").BS.od,P=this.K.resolve("Common.IActionManagerExtended");t.powerPointEnableAccCheck&&(this.Kac=new rb(P,t,this.K.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckManager"),
this.K.resolve("PowerPointWebEditor.Accessibility.IPptAccCheckService"),this.K.resolve("PowerPointWebEditor.View.IAccCheckPane"),this.K.resolve("PowerPointWebEditor.IPresentationResourcesManager"),this.K.resolve("PowerPointWebEditor.IRibbonUser"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("PowerPointWebEditor.IPresentationReader")),this.Kac.vb(),this.Kac.De());t.zme&&Ya.a.get_instance().Dk(7,Object(r.a)(this,this.zme,"loadInternalSlice"))}zme(){const t=Mb.a.create("pptedit.internal",
null,()=>d.e(17).then(d.bind(null,1237)));Kc.a.Wx(t)}dispose(){this.Kac&&this.Kac.dispose()}static main(){e.a.instance.Dc(new Qb)}}Object(k.a)(Qb,"PptLazyActorsPackage",null,[2,3]);var Bc=d(209),wb=d(575),Ad=d(1194),bc=d(184),Sb=d(165),Zb=d(56),cb=d(46),Xa=d(66),Lb=d(137),pc=d(622);class fc extends pc.a{constructor(){super();this.ie=this.createElement(Xa.a.F_e)}c$k(t){this.xa.textContent=t}appendChild(t){if(!t.xa||!this.xa)throw Error.argumentNull();this.xa.appendChild(t.xa)}}Object(k.a)(fc,"HTMLText",
pc.a,[]);var bd=d(325),od=d(194);class ye{constructor(t,P,ia,Aa,Ka,pb,Nb,kc){this.vd=1;this.nze=null;this.x0=new bc.a;this.gu=new bc.a;this.rn=null;this.Po=!1;this.m3c=null;this.nyg="";this.pGa=this.l$=!1;this.Leb=this.PVa=this.jcb=this.oGa=this.iBb=this.cea=null;this.MUa=!1;this.ta=t;this.zb=P;this.je=ia;this.la=Aa;this.ia=Ka;this.Yc=pb;this.ob=Nb;this.PC=kc}jgl(t){this.cea&&this.Leb&&(this.l$=!0,this.Leb.appendChild(this.cea.xa),this.ob.GG(Object(r.a)(this,this.S$,"onSelectionChange")),this.m3c=
new D.a(3,1,this.la.fvh,Object(r.a)(this,this.dismissImageDescriptionBarTask,"dismissImageDescriptionBarTask"),90,"19"),this.eGh(t))}Kyl(t){this.ta===t&&this.l$&&this.eGh(this.ta.get_alt())}Im(t){this.Leb=t.xa;this.RBi()}eD(t){if(this.l$&&!this.Po)switch(t){case 1:t=this.je.pk("formatpainterobject.cur");this.oGa.nl(cb.a.cQ(t,Xa.a.lrc));break;case 0:this.oGa.nl(Xa.a.lrc)}}Yp(){return null}HN(){return!1}Jx(t){this.Po=t}dispose(){this.HMc();this.cea&&(this.PVa=this.jcb=this.iBb=this.oGa=this.cea=null)}My(){}YD(){return null}yB(){return[]}draw(){this.l$&&
this.y2e(!0)}get visible(){return this.pGa}set visible(t){this.l$&&(this.pGa!==t&&(this.pGa=t,this.cea.setVisibility(this.pGa)),this.pGa||this.HMc())}setPosition(){}Hj(t){this.vd=t;this.l$&&(this.Xgd(),this.dGh())}Nq(t){this.x0=t;this.l$&&this.Xgd()}Ru(t){this.gu=t;this.l$&&this.Xgd()}setZIndex(t){this.l$&&this.cea.DB(t)}JE(t,P){this.l$&&(this.y2e(!t&&P||!P),t||this.zb.G5(this.m3c,this.la.fvh))}setSelection(){}RBi(){this.cea=new Lb.a;this.oGa=new bd.a;this.oGa.loa("ImageDescriptionBarBackground");
this.Yc.pb(oa.a.click,this.oGa.xa,Object(r.a)(this,this.tpk,"onImageDescriptonBarClickHandler"));this.iBb=new od.a;this.iBb.appendChild(this.oGa);this.jcb=new fc;this.jcb.qr("ImageDescriptionBarText");this.dGh();this.PVa=new Lb.a;this.PVa.qr("ImageDescriptionBarTextWrappingDiv");this.PVa.appendChild(this.jcb);this.cea.appendChild(this.iBb);this.cea.appendChild(this.PVa)}eGh(t){const P=t.indexOf("\n");this.nyg=-1===P?t:t.substring(0,P);this.jcb.c$k(ResourceStrings.L_ShapeAltText+": "+this.nyg);this.y2e(!0)}y2e(t){this.rn=
this.ta.fp;this.pGa=t;this.Xgd();this.cea.setVisibility(this.pGa);this.MUa||(this.MUa=!0,this.zb.Eb(this.m3c))}dGh(){this.jcb.xa.style.fontSize=this.PC.Via(29)}tpk(){this.ia.processAction(hb.a.Wqb,2);return!0}S$(){this.HMc()}dismissImageDescriptionBarTask(){this.HMc()}HMc(){this.l$&&(this.pGa=this.l$=!1,this.ob.Nxa(Object(r.a)(this,this.S$,"onSelectionChange")),this.MUa&&(this.zb.Rg(this.m3c),this.MUa=!1),this.Leb&&this.Leb.contains(this.cea.xa)&&this.Leb.removeChild(this.cea.xa))}Xgd(){if(this.l$&&
this.rn){var t=this.rn.copy();this.x0.El(t);this.gu.El(t);this.nze=wb.a.UO(Zb.a.IG(t.ga(0),t.ga(1)));var P=t.qk(new Sb.a(6)),ia=t.qk(new Sb.a(4));t=t.qk(new Sb.a(2));t=Zb.a.lm(ia,t)*this.vd;ia=Zb.a.lm(P,ia)*this.vd;if(60>ia||80>t)this.pGa=!1;else{t=this.Leb.children[0].style;this.iBb.setPosition(this.cOb(t.left),this.cOb(t.top));this.iBb.ih(this.cOb(t.width),this.cOb(t.height));var Aa=this.PC.Me(Ad.a.rf(40,1),1);this.PVa.setPosition(P.x*this.vd,P.y*this.vd-Aa);this.PVa.ih(ia,Aa);this.PVa.xa.style.transform=
this.TQa(this.nze);this.jcb.ih(ia-9,Aa-6);var Ka=new bc.a;Ka.x7(this.nze,new Zb.a(0,Aa));Ka.VB(P.x*this.vd-this.cOb(t.left),P.y*this.vd-this.cOb(t.top)-Aa);this.oGa.LE(Ka,1);this.oGa.ih(ia,Aa)}}}cOb(t){t=parseFloat(t);return isNaN(t)?0:t}TQa(t){return"rotate("+t.toString()+"deg)"}}Object(k.a)(ye,"ImageDescriptionBarView",null,[799,284,285,106]);var pd=d(1006),ab=d(45),Yb=d(37);class Sc{constructor(t,P,ia,Aa){this.shapeNode=t;this.EOc=P;this.$Pj=ia;this.imageDescription=Aa}}Object(k.a)(Sc,"ImageDescriptionCache",
null,[]);var Jb=d(216);class Oc{constructor(t,P,ia,Aa,Ka,pb,Nb,kc,Rc,Yc,hd){this.F9=new pd.a;this.Fb=t;this.vi=P;this.Lq=Nb;this.bcb=ia;this.ob=Aa;this.e0=pb;this.t7j=Ka;this.Xt=kc;this.Jb=Rc;this.fc=Yc;this.fue=hd}initialize(){this.Xt.ik(Object(r.a)(this,this.hh,"onPropertyChanged"));this.Lq.Bsf(Object(r.a)(this,this.GGb,"onShapeImageFirstDraw"));this.Lq.y9h(Object(r.a)(this,this.$3g,"onLocalImageViewDismissed"));this.bcb.t9h(Object(r.a)(this,this.x3g,"onImageDescriptionReady"))}dispose(){this.Xt.Cm(Object(r.a)(this,
this.hh,"onPropertyChanged"));this.Lq.mPe(Object(r.a)(this,this.GGb,"onShapeImageFirstDraw"));this.Lq.XTk(Object(r.a)(this,this.$3g,"onLocalImageViewDismissed"));this.bcb.UTk(Object(r.a)(this,this.x3g,"onImageDescriptionReady"))}hh(t,P){(t=P.node)&&t.Ej&&(P=P.property,P===Yb.a.alt?((P=Object(R.a)(117,t.sc(this.Fb.Ma)))&&P.yQ&&t.get_alt()&&this.fue.VG(t).Kyl(t),this.t7j.bxl(t),t.get_alt()&&this.vpd(t,t.get_alt())):P===Yb.a.oC?t.oC&&(P=Object(R.a)(117,t.sc(this.Fb.Ma)))&&P.yQ&&(this.fue.VG(t).visible=
!1):P===Yb.a.fh&&t.fh!==Jb.a.lT&&(P=Object(R.a)(117,t.sc(this.Fb.Ma)))&&P.yQ&&!t.Pda&&this.F9.ga(t.id)&&this.F9.ga(t.id).EOc&&(this.yvb(t,P),this.F9.remove(t.id)))}x3g(t,P){if(t=P.qUc){var ia=P.confidence,Aa=P.imageDescription,Ka=P.fMj;P=P.EOc;var pb=this.e0.Zca(t),Nb=pb?Object(R.a)(117,pb.sc(this.Fb.Ma)):null;P?Nb&&Nb.yQ&&!pb.isLocal&&!pb.oC?this.yvb(pb,Nb):this.F9.add(t,new Sc(pb,!0,!0,Aa)):!Aa||!Ka&&60>ia?O.a.J(33609505,815,15,"isGenerateSuggestion: {0}, confidence: {1}",Ka,ia):(Aa=this.rvi(ia,
Aa),Ka?this.XSe(pb,Aa,!1):(O.a.J(34194368,815,50,"Image description ready for show and save"),Nb&&Nb.yQ?(O.a.J(34194370,815,50,"Show image description immediately, GraphNodeId: {0}, TimeMs: {1}",t.toString(),(new Date).getTime()),this.vpd(pb,Aa),pb.isLocal?this.F9.add(t,new Sc(pb,!1,!1,Aa)):(O.a.J(34194372,815,50,"Save image description immediately"),this.XSe(pb,Aa,!0))):this.F9.add(t,new Sc(pb,!1,!0,Aa))))}else O.a.J(33609503,815,15,"Graph node id is null")}GGb(t,P){t=P.qUc;O.a.J(34194374,815,50,
"OnShapeImageFirstDraw, GraphNodeId: {0}, TimeMs: {1}",t?t.toString():"",(new Date).getTime());this.F9.Hb(t)?this.Obh(t):(t=this.e0.Zca(t))&&t.get_alt()&&this.vpd(t,t.get_alt())}rvi(t,P){P+=String.fromCharCode(10,10);return P=80<=t?P+ResourceStrings.L_ImageDescriptionWithVeryHighConfidence:60<=t?P+ResourceStrings.L_ImageDescriptionWithHighConfidence:40<=t?P+ResourceStrings.L_ImageDescriptionWithMediumConfidence:20<=t?P+ResourceStrings.L_ImageDescriptionWithLowConfidence:P+ResourceStrings.L_ImageDescriptionWithVeryLowConfidence}$3g(t,
P){(t=P.Bjl)&&this.F9.Hb(t.id)&&this.Obh(t.id)}Obh(t){const P=this.F9.ga(t).shapeNode;if(P){var ia=this.F9.ga(t).EOc,Aa=this.F9.ga(t).$Pj,Ka=this.F9.ga(t).imageDescription;ia?(ia=Object(R.a)(117,P.sc(this.Fb.Ma)))&&this.yvb(P,ia):(Aa&&this.vpd(P,Ka),P.isLocal?O.a.J(33609539,815,15,"Try to save alt text for local picture"):this.XSe(P,Ka,!0));this.F9.remove(t)}else O.a.J(37029889,815,15,"ProcessImageDescriptionInCache, shape node has been changed")}yvb(t,P){this.vi.generateImageDescription(t.id,P.QXe,
t.get_isSVGBlipFilled(),!1)}XSe(t,P,ia){if(!ia||!t.get_alt()){var Aa=this.Jb.le(ia?7:15);Aa.nc(t);t.f0a=ia;t.set_alt(ab.a.FTa(P));Aa.dispose();ia&&this.vi.forceOutbound()}}vpd(t,P){if(t.Ej){this.fc.$c(t)&&O.a.J(34079445,815,50,"Graph node or parents blocked");var ia=this.ob.Xd();ia&&this.ob.cX(t)?(O.a.J(33609545,815,50,"ImageDescriptionManager::ShowImageDescriptionBar, GraphNodeId: {0}, TimeMs: {1}",t.id.toString(),(new Date).getTime()),this.fue.VG(t).jgl(P)):O.a.J(33609543,815,50,"Is selected shapes empty: {0}",
!ia)}else O.a.J(33609541,815,50,"ShapeNode.IsPicture: {0}",t.Ej)}}Object(k.a)(Oc,"ImageDescriptionManager",null,[106]);var Wb=d(93),Ab=d(337),Xb=d(58),vb=d(69),$c=d(34),fd=d(47);class Bd{constructor(t,P,ia,Aa,Ka,pb,Nb,kc,Rc,Yc,hd,se){this.ta=null;this.QT=0;this.i6c=!0;this.iue=new pd.a(0);this.hF=!!v.AFrameworkApplication.Aa&&!!v.AFrameworkApplication.Aa.hb&&v.AFrameworkApplication.Aa.hb.bX;this.mh=t;this.Qb=P;this.je=ia;this.Fa=Yc;this.vi=Aa;this.Yc=Ka;this.ob=pb;this.jE=Nb;this.h0=kc;this.Jb=Rc;
this.bcb=hd;this.tH=se;this.qb=document.createElement("div");this.qb.className=Xb.a.abg;this.qb.id=Xb.a.abg;this.qb.style.position=vb.a.Ioa;this.qb.setAttribute(pa.a.af,pa.a.LBa);this.qb.setAttribute(pa.a.D2,"ImageDescriptionPaneLabel");this.Yc.pb(oa.a.click,this.qb,Object(r.a)(this,this.plh,"rootElementClickHandler"));this.h0.addHandler(this.qb,oa.a.Zf,Object(r.a)(this,this.Mta,"inputKeyPressHandler"));this.Db=!1;this.DGa=cb.a.Fe();this.DGa.className="ImageDescriptionPaneLayoutRoot";this.vo=this.tCa("per",
"ClosePaneGlyph_16x16x32");Sys.UI.DomElement.addCssClass(this.vo,"ImageDescriptionPaneCloseButton");this.vo.setAttribute(pa.a.af,pa.a.ru);this.DGa.appendChild(this.vo);this.Yc.pb(oa.a.click,this.vo,Object(r.a)(this,this.Tsb,"closeButtonClickHandler"));this.h0.addHandler(this.vo,oa.a.focus,Object(r.a)(this,this.pGb,"onElementFocused"));this.kdc=cb.a.Fe();this.kdc.id="ImageDescriptionPaneLabel";this.kdc.className="PaneLabel";this.kdc.innerText=ResourceStrings.L_ShapeAltText;this.DGa.appendChild(this.kdc);
this.Z4c=cb.a.Fe();this.Z4c.innerText=ResourceStrings.l_ImageDescriptionPaneLabel;this.Z4c.className="ImageDescriptionLabel";this.DGa.appendChild(this.Z4c);this.Y4c=cb.a.Fe();this.Y4c.innerText=ResourceStrings.L_ImageDescriptionPaneHint;this.Y4c.className="ImageDescriptionHint";this.DGa.appendChild(this.Y4c);this.gue=cb.a.Fe();this.$I=document.createElement("textarea");this.$I.className="AltTextTextArea";this.$I.setAttribute(pa.a.gs,ResourceStrings.L_ShapeAltText);this.$I.tabIndex=0;this.gue.appendChild(this.$I);
this.DGa.appendChild(this.gue);this.Yc.pb(oa.a.click,this.$I,Object(r.a)(this,this.Vtf,"altTextboxClickHandler"));this.h0.addHandler(this.$I,oa.a.Zf,Object(r.a)(this,this.Wtf,"altTextboxTypingHandler"));this.h0.addHandler(this.$I,oa.a.focus,Object(r.a)(this,this.pGb,"onElementFocused"));t=cb.a.Nn();t.className="GenerateDescriptionButtonText";t.innerText=ResourceStrings.L_ImageDescriptionPaneButtonTooltip;t.setAttribute("Unselectable","on");this.XT=cb.a.nca();this.XT.className="ImageDescriptionPaneButton cui-ctl";
this.XT.setAttribute(pa.a.af,pa.a.ru);this.XT.tabIndex=0;this.XT.appendChild(t);this.DGa.appendChild(this.XT);this.Yc.pb(oa.a.click,this.XT,Object(r.a)(this,this.EWf,"generateDescriptionClickHandler"));this.h0.addHandler(this.XT,oa.a.focus,Object(r.a)(this,this.pGb,"onElementFocused"));this.jE.H8(fd.a.jka,fd.a.nj,this.qb,()=>{this.zU(!0)},()=>{this.zU(!1)},!0);this.jE.H8(fd.a.YOd,fd.a.nj,this.$I,()=>{this.h3g(!0)},()=>{this.h3g(!1)},!0);this.bcb.W9h(Object(r.a)(this,this.L5g,"onShowHideAltTextPane"))}vCj(){this.Hpi()&&
(this.$I.disabled=!1,this.$I.value=this.ta.get_alt(),this.qb.appendChild(this.DGa),this.XT.style.display=this.ta.isLocal?vb.a.Gf:vb.a.Xk,this.Db=!0,this.qb.style.display=vb.a.Xk,this.hF?(this.bFc(this.qb),this.tH.yM(this,this.Db,ResourceStrings.L_ShapeAltText,fd.a.jka)):this.Qb.Mq(),this.ob.GG(Object(r.a)(this,this.S$,"onSelectionChange")),O.a.J(512233536,815,50,"ImageDescriptionPane::InitializeAndShow"))}dispose(){this.QIc();this.bcb.nUk(Object(r.a)(this,this.L5g,"onShowHideAltTextPane"));this.Yc.yb(oa.a.click,
this.qb,Object(r.a)(this,this.plh,"rootElementClickHandler"));this.h0.removeHandler(this.qb,oa.a.Zf,Object(r.a)(this,this.Mta,"inputKeyPressHandler"));this.Yc.yb(oa.a.click,this.vo,Object(r.a)(this,this.Tsb,"closeButtonClickHandler"));this.h0.removeHandler(this.vo,oa.a.focus,Object(r.a)(this,this.pGb,"onElementFocused"));this.Yc.yb(oa.a.click,this.$I,Object(r.a)(this,this.Vtf,"altTextboxClickHandler"));this.h0.removeHandler(this.$I,oa.a.Zf,Object(r.a)(this,this.Wtf,"altTextboxTypingHandler"));this.h0.removeHandler(this.$I,
oa.a.focus,Object(r.a)(this,this.pGb,"onElementFocused"));this.Yc.yb(oa.a.click,this.XT,Object(r.a)(this,this.EWf,"generateDescriptionClickHandler"));this.h0.removeHandler(this.XT,oa.a.focus,Object(r.a)(this,this.pGb,"onElementFocused"));this.XT=this.$I=this.gue=this.Y4c=this.Z4c=this.kdc=null;O.a.J(512233507,815,50,"ImageDescriptionPane::Dispose")}bxl(t){this.ta&&t===this.ta&&this.Db&&(this.iue.Hb(t.id.toString())&&this.ta.fh!==this.iue.ga(t.id.toString())&&O.a.J(512233506,815,50,"ImageDescriptionPane::UpdateAltTextbox - Image version have been changed after generate description"),
2!==this.QT&&(this.$I.value=this.ta.get_alt()))}layout(t,P){const ia=P?t.hD(this.width):t.iD(this.width);this.Db&&(P?(Sys.UI.DomElement.addCssClass(this.qb,Xb.a.cbg),ia.hD(Xb.a.Obe)):(Sys.UI.DomElement.addCssClass(this.qb,Xb.a.bbg),ia.iD(Xb.a.Obe)));cb.a.k1(this.qb,ia);return t}get isVisible(){return this.Db}get xa(){return this.qb}get order(){return 10}zU(t){this.Db&&(t?0===this.QT&&this.WCh():this.QT=0)}h3g(t){this.Db&&(t||this.FTe(),this.Qb.updateCommandUI())}Wtf(t){t.keyCode===wa.a.cZ&&t.ctrlKey?
this.ZKb():(2!==this.QT&&this.oph(),this.QT=2)}Mta(t){this.Db&&(t.keyCode===wa.a.tq||t.keyCode===wa.a.mP?1===this.QT?this.QK():3===this.QT?this.yvb():2===this.QT&&(this.XT.style.display=vb.a.Xk):2===this.QT&&(this.XT.style.display=vb.a.Xk))}WCh(){Wb.FocusManager.Sr(this.vo)?(this.ZKb(),this.QT=1):O.a.J(512233505,815,50,"Fail to set focus on close button")}ZKb(){this.Fa.bD(fd.a.jka)}oph(){this.Fa.bD(fd.a.YOd)}Hpi(){const t=this.ob.Xd();if(!t||1<t.length||!t[0].Ej)return O.a.J(512233504,815,50,"ImageDescriptionPane::CheckAndCacheShapeNode - shape node is null: {0}",
!t),!1;this.ta=t[0];return!0}Tsb(){this.QK();return!0}QK(){this.Db&&(this.QIc(),this.Fa.Bj(fd.a.jka,!1),O.a.J(512233503,815,50,"ImageDescriptionPane::CloseButtonClickHandler - Image Description pane close button clicked."))}plh(){this.Db&&(this.ZKb(),this.QT=0);return!0}Vtf(){this.oph();this.QT=2;return!0}EWf(){this.ZKb();this.yvb();return!0}yvb(){this.QT=3;this.XT.style.display=vb.a.Gf;this.WCh();const t=this.ta?Object(R.a)(117,this.ta.sc(0)):null;t?(this.iue.add(this.ta.id.toString(),this.ta.fh),
this.vi.generateImageDescription(this.ta.id,t.QXe,this.ta.get_isSVGBlipFilled(),!0)):O.a.J(512233502,815,15,"ImageDescriptionPane::GenerateDescriptionClickHandler - Is shape node null {0}",!this.ta)}L5g(){this.Db?this.QIc():(this.vCj(),this.QT=0);this.Fa.Bj(fd.a.jka,this.Db);O.a.J(512233501,815,50,"ImageDescrptionPane::ShowOrHidePane {0}",!this.Db)}cxl(t){t=t.Xd();this.i6c&&this.FTe();1===t.length&&t[0].Ej?(this.ta=t[0],this.i6c=!0,this.$I.value=this.ta.get_alt(),this.$I.disabled=!1,this.XT.style.display=
this.ta.isLocal?vb.a.Gf:vb.a.Xk):(this.XT.style.display=vb.a.Gf,this.$I.disabled=!0,this.$I.value=null,this.i6c=!1)}S$(t){$c.a("ChangePictureAltTextFixEnabled")?this.cxl(t):this.QIc();this.mh.Ho(fd.a.jka)}pGb(t){this.Db&&(t.target===this.vo?this.QT=1:t.target===this.$I?this.QT=2:t.target===this.XT&&(this.QT=3))}QIc(){this.Db&&(this.ob.Nxa(Object(r.a)(this,this.S$,"onSelectionChange")),this.i6c&&this.FTe(),this.Db=!1,this.qb.removeChild(this.DGa),this.qb.style.display=vb.a.Gf,this.hF?(this.bFc(this.qb),
this.tH.yM(this,this.Db,ResourceStrings.L_ShapeAltText,fd.a.jka)):this.Qb.Mq(),O.a.J(512233500,815,50,"ImageDescriptionPane::CleanUpAndHide"))}bFc(t){v.AFrameworkApplication.isRtl?Sys.UI.DomElement.addCssClass(t,Xb.a.cbg):Sys.UI.DomElement.addCssClass(t,Xb.a.bbg)}FTe(){const t=this.$I.value;if(!($c.a("ChangePictureAltTextFixEnabled")&&null===t||t===this.ta.get_alt())){var P=this.Jb.le(15);P.nc(this.ta);this.ta.f0a=!1;this.ta.set_alt(t);P.dispose()}}tCa(t,P){return this.sCa(t,"cui-img-16by16","cui-ctl-iconContainer",
P,CommonUIStrings.l_DialogClose,null)}sCa(t,P,ia,Aa,Ka,pb){const Nb=cb.a.eC();Nb.alt=Ka;Nb.className=Da.getImageClassWithCluster(t,Aa);Nb.src=this.je.pk(t+".png");Nb.setAttribute("Unselectable","on");t=cb.a.Nn();t.className=P+" cui-img-cont-float";t.appendChild(Nb);P=cb.a.Nn();P.className=ia;P.setAttribute("Unselectable","on");P.appendChild(t);ia=cb.a.nca();ia.className="ImageDescriptionPaneNoBorderButton cui-ctl";ia.title=Ka;ia.setAttribute(pa.a.af,pa.a.ru);ia.tabIndex=0;ia.appendChild(P);pb&&(Ka=
cb.a.Nn(),Ka.className="cui-ctl-mediumlabel",Ka.setAttribute("Unselectable","on"),Ka.innerText=pb,ia.appendChild(Ka));return ia}get width(){return this.Db?Xb.a.Tzj+Xb.a.Obe+Ab.a.nKa:0}}Object(k.a)(Bd,"ImageDescriptionPane",null,[773,461,106]);var gd=d(277);class Pd{constructor(){this.K=null;this.hF=!!v.AFrameworkApplication.Aa&&!!v.AFrameworkApplication.Aa.hb&&v.AFrameworkApplication.Aa.hb.bX}get name(){return"PowerPointWebEditor.ImageDescription"}$b(t){this.K=t;this.K.register(255,"PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IImageDescriptionBarView>").ma().oa(()=>
new gd.a(P=>{let ia=null;const Aa=Object(R.a)(117,P.sc(t.resolve("Box4.IPageView").Ma));Aa&&!Aa.Al&&(ia=new ye(P,this.K.resolve("Common.ITaskManager"),this.K.resolve("PowerPoint.IPathManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Common.IClickInputManager"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("Box4.IPageView").Ld),ia.Im(Aa.RU),Aa.dra(ia,4));return ia}));this.K.register(773,"PowerPointWebEditor.IImageDescriptionPane").ma().oa(()=>
new Bd(this.K.resolve("Common.IF6Manager"),this.K.resolve("Box4.IAppFrame"),this.K.resolve("PowerPoint.IPathManager"),this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.K.resolve("Common.IClickInputManager"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.View.IFocusManagerHelper"),this.K.resolve("PowerPointWebEditor.IInputHandlerManager"),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("PowerPointWebEditor.IFocusManager"),
this.K.resolve("PowerPointWebEditor.CoreExt.ICoreExtEventSource"),this.K.resolve("PowerPointWebEditor.ITaskPaneManager")));this.K.register(Oc,"PowerPointWebEditor.ImageDescriptionManager").ma().oa(()=>new Oc(this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.K.resolve("PowerPointWebEditor.CoreExt.ICoreExtEventSource"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.IImageDescriptionPane"),
this.K.resolve("PowerPointWebEditor.Graph.GraphHierarchyHelper"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("Box4.Graph.IGraphInstance").Ad(10),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),this.K.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IImageDescriptionBarView>")))}init(){this.K.resolve("PowerPointWebEditor.IApplicationSettings").jUa&&
(this.hF||this.K.resolve("PowerPointWebEditor.IPaneManager").OP(this.K.resolve("PowerPointWebEditor.IImageDescriptionPane")),this.K.resolve("PowerPointWebEditor.ImageDescriptionManager").initialize())}dispose(){this.K.resolve("PowerPointWebEditor.IApplicationSettings").jUa&&this.K.resolve("PowerPointWebEditor.ImageDescriptionManager").dispose()}static main(){e.a.instance.Dc(Bc.a(new Pd,0))}}Object(k.a)(Pd,"PPTWebEditorImageDescriptionPackage",null,[2,3]);var cd=d(80);class lf extends cd.a{constructor(t){super(!1,
!1,!0);this.Quc=t}start(){const t={["id"]:"AccessibilitySettingsDialog",["bodyControls"]:{["tooltipPersistenceEnabled"]:this.Quc.Abe}};this.$i("",Object(r.a)(this,this.bZk,"resultHandler"),t)}bZk(t,P){1===t&&(this.Quc.Abe=P.tooltipPersistenceEnabled)}}Object(k.a)(lf,"AccessibilitySettingsDialog",cd.a,[]);class Jd{constructor(t,P){this.Ca=t;this.Quc=P}vb(){this.Ca.ya(E.a.Pel,u.a.frame,Object(r.a)(this,this.Qel,"showAccessibilitySettingsDialogHandler"))}Qel(){(new lf(this.Quc)).start();return 32}}Object(k.a)(Jd,
"AccessibilitySettingsDialogActor",null,[824]);var Xf=d(1047);const ee=t=>{const P=new Xf.a;v.AFrameworkApplication.Je.Aj(Ra(t),1,null,null,!0,2,ia=>{200===ia.data.Te?P.Fg("true"===ia.data.Zd.toLowerCase()):P.Fg(!1)},()=>{P.Fg(!1)},null,void 0,void 0,void 0,void 0,"7");return P.task},Ra=t=>String.format("{0}RoamingServiceHandler.ashx?action={1}&{2}",v.AFrameworkApplication.fa.appSettings.RoamingServiceHandlerWebServiceBase||"",t,v.AFrameworkApplication.jh);var sb=d(70);class ec{constructor(){this.Lnb=
null}get Abe(){return!!this.Lnb}set Abe(t){t!==this.Lnb&&(this.Lnb=t,sb.a("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(t),this.yjg()&&v.AFrameworkApplication.Je.Aj(Ra("saveHoverableRibbonTooltipIsEnabled"),2,t.toString().toLowerCase(),null,!0,2,null,null,null,void 0,void 0,void 0,void 0,"8"))}pZj(){const t=new Xf.a;if(this.Lnb)t.Fg(this.Lnb);else if(this.yjg()){const P=ee("getHoverableRibbonTooltipIsEnabled");P.continueWith(()=>{this.Lnb=P.result;sb.a("setHoverableTooltipsPreference")&&
appChrome.api.setHoverableTooltipsPreference(P.result);t.Fg(P.result)},8)}else t.Fg(!1)}yjg(){const t=v.AFrameworkApplication.fa.ka("IsRoamingServiceEnabled"),P=v.AFrameworkApplication.fa.ka("IsAnonymousUser");return t&&!P}}Object(k.a)(ec,"AccessibilitySettingsInfo",null,[823]);class Lc{constructor(){this.Da=null}get name(){return"Common.App.AccessibilitySettings"}$b(t){this.Da=t;this.Da.register(ec,"Common.App.AccessibilitySettings.AccessibilitySettingsInfo").as("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo").oa(()=>
new ec).ma();this.Da.register(Jd,"Common.App.AccessibilitySettings.AccessibilitySettingsDialogActor").as("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor").oa(()=>new Jd(v.AFrameworkApplication.Ta,this.Da.rb("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo"))).ma()}init(){const t=this.Da.rb("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo"),P=this.Da.rb("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor");t&&P?(P.vb(),t.pZj()):J.c(539637639,
200,15,"Failed to resolve IAccessibilitySettingsDialogActor or IAccessibilitySettingsInfo. A11y dialog feature is not enabled.")}dispose(){}static main(){e.a.instance.Dc(new Lc)}}Object(k.a)(Lc,"AccessibilitySettingsPackage",null,[2,3]);var nd=d(91),Fd=d(218),Ja=d(1113),db=d(78),ic=d(704);class id extends ua.StandardDialog{constructor(t,P,ia,Aa=null){super();this.p2=this.ds=this.dNa=null;this.Xv=[];this.nBc=P;this.AP=t;this.LRh=ia;this.NCc=Aa;this.Mpb=new ic.a("LoadResource","LoadPrintablePdf")}mja(){this.xd=
5;this.width=40;const t=document.createElement("span");t.id=this.Nh("DirectPrintHeaderContent");const P=document.createElement("span");P.innerText=CommonUIStrings.l_DirectPrintDialogHeader;Sys.UI.DomElement.addCssClass(P,"DirectPrintHeader");this.p2=document.createElement("iframe");this.p2.name="pdfObjectFrame";this.p2.title=CommonUIStrings.l_DirectPrintDialogIFrame;this.p2.onload=Object(r.a)(this,this.CEk,"printablePdfLoaded");if(this.NCc&&0<this.NCc.count){var ia=db.a.I7d(this.nBc,this.NCc);const Aa=
db.a.QOe(this.nBc,this.NCc);this.ds=document.createElement("form");this.ds.id="printPreviewPostForm";this.ds.method="POST";this.ds.target=this.p2.name;this.ds.action=Aa;for(let Ka of ia)ia=document.createElement("input"),ia.type="hidden",ia.name=Ka.key,ia.value=Ka.value,this.ds.appendChild(ia)}else this.p2.setAttribute("src",this.nBc);Sys.UI.DomElement.addCssClass(this.p2,Fd.a.Jhf);this.LRh?(Sys.UI.DomElement.addCssClass(this.p2,"DirectPrintPdfObjectHidden"),P.innerText=CommonUIStrings.l_DirectPrintDialogSuccessText,
pa.a.bP(this.p2,pa.a.JK,pa.a.XB)):(Sys.UI.DomElement.addCssClass(this.p2,"DirectPrintPdfObject"),this.Xv.push(this.p2));t.appendChild(P);t.appendChild(document.createElement("br"));t.appendChild(this.p2);this.ds&&t.appendChild(this.ds);t.appendChild(document.createElement("br"));t.appendChild(this.Pxi(this.ds?"#":this.nBc));this.Mpb.start();this.qFb(CommonUIStrings.l_AppTitle,null,null,null,null,t);this.O5(this.Nh("DirectPrintHeaderContent"));this.ds&&this.ds.submit();this.rCi();n.ULS.sendTraceTag(4771852,
328,50,"Direct Print Dialog launched.")}Pxi(t){const P=document.createElement("span");var ia=document.createElement("span");ia.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFHeader;P.appendChild(ia);v.AFrameworkApplication.fa&&(2===v.AFrameworkApplication.Aa.hb.Vk&&v.AFrameworkApplication.fa.ka("PPTDisableDirectPrintDialogDownloadPDFLink")||1===v.AFrameworkApplication.Aa.hb.Vk&&v.AFrameworkApplication.fa.ka("XLODisableDirectPrintDialogOpenPDFLink"))?(t=document.createElement("span"),2===
v.AFrameworkApplication.Aa.hb.Vk?t.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFLabel:1===v.AFrameworkApplication.Aa.hb.Vk&&(t.innerText=CommonUIStrings.l_InternalError_Directive,n.ULS.sendTraceTag(573691527,328,50,"Hyperlink removed from DirectPrintDialog in XLO.")),this.dNa=t,P.appendChild(document.createElement("br")),P.appendChild(t)):(ia=document.createElement("a"),ia.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFLink,ia.href=t,ia.target="_blank",ia.id="PrintPDFLink",ia.className=
"AllowBrowserClick",this.dNa=ia,P.appendChild(document.createElement("br")),P.appendChild(ia),this.ds&&nd.a.addHandler(ia,"click",Object(r.a)(this,this.Dtk,"onSubmit")),this.AP.pb(oa.a.click,this.dNa,Object(r.a)(this,this.RNf,"downloadPDFLinkClicked"),null));this.Xv.push(this.dNa);return P}Dtk(t){this.ds&&(this.ds.target="_blank",this.ds.submit());t.preventDefault()}rCi(){if(0<this.Xv.length){const t=new Ja.a(this.Xv),P=Wb.FocusManager.instance().yl();P&&(this.dNa.focus(),P.uj=t,P.kX=!0)}}RNf(){n.ULS.sendTraceTag(4585050,
328,50,"Download PDF from Direct Print dialog clicked.");return!1}ubb(){n.ULS.sendTraceTag(21031114,328,50,"Download PDF from Direct Print dialog button clicked")}CEk(){n.ULS.sendTraceTag(51426332,328,50,"PDF content loaded successfully");this.Mpb&&this.Mpb.stop()}dispose(){this.dNa&&(this.AP.yb(oa.a.click,this.dNa,Object(r.a)(this,this.RNf,"downloadPDFLinkClicked")),this.dNa=null);la.a.XO(this.p2);this.p2=null;super.dispose()}}Object(k.a)(id,"DirectPrintDialog",ua.StandardDialog,[958]);class qd{constructor(t){this.AP=
t}X6i(t,P){return new id(this.AP,t,P,null)}}Object(k.a)(qd,"DirectPrintDialogFactory",null,[945]);var Fc=d(1185),Ze=d(63);class df{constructor(t,P){this._url=t;this.JWh=P}tNf(){this.JWh?Ze.a.downloadFile(this._url):Ze.a.un(this._url,"_blank",void 0,"OpenUrlInTabDialogDownloadBehavior:DoDownload")}dispose(){}}Object(k.a)(df,"OpenUrlInTabDialogDownloadBehavior",null,[935,106]);var ve=d(54);class md extends ua.StandardDialog{constructor(t,P=!0,ia=!1,Aa=null,Ka=null,pb=!1){super();this.Bnb=this.Anb=this.ds=
this.tba=null;var Nb=this.X_e?this.X_e:CommonUIStrings.l_DefaultDialogTitle;md.txb=pb;this.Zyd=Aa||new df(t,!0);const kc=[],Rc=[];md.F1&&(this.dGc&&this.dGc.forEach(se=>{Array.add(kc,se)}),this.ktf&&this.ktf.forEach(se=>{Array.add(Rc,se)}));P?ia?(this.xd=4,this.Xe(1,this.buttonText),this.Xe(2,CommonUIStrings.l_DialogClose)):(this.xd=6,this.Xe(0,CommonUIStrings.l_DialogClose)):this.xd=5;pb=document.createElement("span");this.X0b&&(pb.className=this.X0b);Aa=document.createElement("a");Aa.innerText=
this.iAb;Aa.href=t;Aa.target="_blank";Aa.id=this.bac;Aa.className=Na.AFrame.Qtf;var Yc=!ve.a.uT&&!!Ka&&0<Ka.count;if(Yc){const se=db.a.I7d(t,Ka);Ka=db.a.QOe(t,Ka);Aa.href="#";Aa.target="_self";this.ds=document.createElement("form");this.ds.id="printPreviewPostForm1";this.ds.method="post";this.ds.target="_blank";this.ds.action=Ka;for(var hd of se)Ka=document.createElement("input"),Ka.type="hidden",Ka.name=hd.key,Ka.value=hd.value,this.ds.appendChild(Ka)}else this.ds=null;this.ds||md.txb?md.txb||Array.add(Rc,
{["type"]:"AppLinkProps",["id"]:this.bac,["text"]:this.iAb,["onExecute"]:()=>{this.Feh()}}):Array.add(Rc,{["type"]:"AppLinkProps",["id"]:this.bac,["text"]:this.iAb,["handler"]:{["href"]:Yc?"#":t,["target"]:Yc?"_self":"_blank"}});this.Nma&&Array.add(kc,this.Nma);ia?(t=document.createElement("span"),t.innerText=this.Nma.replace("{0}",""),pb.appendChild(t)):this.yYg?(t=document.createElement("span"),t.id=this.Nh("message"),hd=document.createElement("span"),Ka=document.createElement("span"),Yc=this.Nma.split("{0}"),
hd.innerText=Yc[0],Ka.innerText=Yc[1],t.appendChild(hd),t.appendChild(Aa),t.appendChild(Ka),pb.appendChild(t)):(t=document.createElement("span"),t.innerText=this.Nma,pb.appendChild(t),pb.appendChild(document.createElement("br")),pb.appendChild(document.createElement("br")),pb.appendChild(Aa),md.txb||Array.add(kc,"{0}"));this.ds&&pb.appendChild(this.ds);md.F1&&(this.ZUa&&(this.Z$b?this.tqf(this.ZUa,this.Z$b):(Array.add(kc,"{0}"),Array.add(Rc,{["type"]:"AppLinkProps",["id"]:"LearnMoreLinkId",["text"]:this.ZUa,
["onExecute"]:()=>{this.F0c()}}))),this.ZEc(kc,Rc));this.qFb(Nb,null,this.Ebe,null,Object(r.a)(this,this.Z2,"dialogHandler"),md.F1?null:pb);this.O5(this.Nh("message"));!md.F1&&this.Z$b&&this.ZUa&&(Nb=document.createElement("div"),Nb.className="WACDialogLearnMoreLinkContainer",this.tba=document.createElement("a"),this.tba.innerText=this.ZUa,this.tba.href=this.Z$b,this.tba.target="_blank",this.tba.id=this.Nh("LearnMoreLinkId"),this.tba.className=Na.AFrame.Qtf,Nb.appendChild(this.tba),P?this.Gb.insertBefore(Nb,
this.Gb.lastChild):this.Gb.appendChild(Nb),this.O5(String.format("{0} {1}",this.Nh("message"),this.Nh("LearnMoreLinkId"))));this.$Qb=Aa;ia?this.DR(this.pD):this.DR(this.$Qb);this.wac();v.AFrameworkApplication.Aa.LR.pb(oa.a.click,this.$Qb,Object(r.a)(this,this.QNf,"downloadLinkClicked"),null);this.tba&&v.AFrameworkApplication.Aa.LR.pb(oa.a.click,this.tba,Object(r.a)(this,this.F0c,"learnMoreLinkClicked"),null);this.e9e=!1}get Ebe(){return null}get X_e(){return null}get Nma(){return null}get Z$b(){return null}get ZUa(){return null}get yYg(){return!1}get buttonText(){return CommonUIStrings.l_Open}get X0b(){return null}get dGc(){return null}get ktf(){return null}I7(){this.ds&&
(this.Anb||(this.Anb=Object(r.a)(this,this.rlk,"onActionButtonClicked"),this.vn.pb(oa.a.click,this.pD,this.Anb)),this.Bnb||(this.Bnb=Object(r.a)(this,this.slk,"onActionButtonKeyUp"),this.Pg.pb(oa.a.Hl,this.pD,this.Bnb)));super.I7()}rlk(t){this.iRf(t);return!0}slk(t){return this.b0c(t,Object(r.a)(this,this.iRf,"executeDismissActionButtonFromArgs"))}iRf(t){this.ds&&this.ds.submit();this.X7a(t.Cc)}ubb(){}QNf(){this.yac();this.ds?this.ds.submit():this.Zyd.tNf();return!0}F0c(){return!1}dispose(){this.Zyd.dispose();
this.$Qb&&(v.AFrameworkApplication.Aa.LR.yb(oa.a.click,this.$Qb,Object(r.a)(this,this.QNf,"downloadLinkClicked")),this.$Qb=null);this.tba&&(v.AFrameworkApplication.Aa.LR.yb(oa.a.click,this.tba,Object(r.a)(this,this.F0c,"learnMoreLinkClicked")),this.tba=null);this.vn&&this.Anb&&(this.vn.yb(oa.a.click,this.pD,this.Anb),this.Anb=null);this.Pg&&this.Bnb&&(this.Pg.yb(oa.a.Hl,this.pD,this.Bnb),this.Bnb=null);super.dispose()}Feh(){this.ds&&(document.body.appendChild(this.ds),this.ds.submit(),document.body.removeChild(this.ds))}Z2(t){1===
t&&(this.ubb(),this.ds?md.F1&&this.Feh():this.Zyd.tNf());this.dispose()}static get F1(){return v.AFrameworkApplication.Aa.hb.uC&&v.AFrameworkApplication.Aa.hb.ljg}static get txb(){return md.gbf}static set txb(t){md.gbf=t}}md.gbf=!1;Object(k.a)(md,"ADialogWithLinkToResource",ua.StandardDialog,[]);class Kf extends md{constructor(t,P,ia=null,Aa=!0,Ka=!1){super(t,!0,!(Kf.n1a&&Aa),new df(t,P),ia,Ka);Kf.n1a=Kf.n1a&&Aa;if(Kf.n1a){P=document.createElement("iframe");Aa=null;Ka=this.ZKi;P.name="pdfObjectFrame";
P.id="pdfObjectIFrame";if(ia&&0<ia.count){const pb=db.a.I7d(t,ia);t=db.a.QOe(t,ia);Aa=document.createElement("form");Aa.id="printPreviewPostForm";Aa.method="POST";Aa.target=P.name;Aa.action=t;for(let Nb of pb)t=document.createElement("input"),t.type="hidden",t.name=Nb.key,t.value=Nb.value,Aa.appendChild(t)}else P.src=t;Ka.appendChild(P);Aa&&(Ka.appendChild(Aa),Aa.submit());Sys.UI.DomElement.addCssClass(P,"DirectPrintPdfObjectHidden");pa.a.bP(P,pa.a.JK,pa.a.XB)}}get Ebe(){return"Print_32x32x32"}get X_e(){return Kf.n1a?
CommonUIStrings.l_PrintDialogDocumentIsReadyToPrint:null}get Nma(){return Kf.n1a?null:CommonUIStrings.l_PrintDialogDocumentIsReadyToPrint}get dGc(){const t=[];Array.add(t,CommonUIStrings.l_PrintDialogCanCloseDocument);if(md.txb){let P=CommonUIStrings.l_DirectPrintDialogFallbackSuggestion;""!==v.AFrameworkApplication.Aa.hb.VJf&&(P=v.AFrameworkApplication.Aa.hb.VJf);Array.add(t,P)}return Kf.n1a?t:null}get iAb(){return CommonUIStrings.l_DirectPrintDialogDownloadPDFLink}get bac(){return"PrintPDFLink"}get buttonText(){return CommonUIStrings.l_PrintDialogOpenPDF}get X0b(){return v.AFrameworkApplication.ksa?
"UIFontDialogTextLarge":null}wac(){n.ULS.sendTraceTag(7690390,324,50,"Legacy print dialog displayed")}yac(){v.AFrameworkApplication.jj.F$a(9540,1);n.ULS.sendTraceTag(7690391,324,50,"Legacy print dialog clicked")}ubb(){n.ULS.sendTraceTag(19462215,324,50,"Legacy print dialog button clicked")}static get n1a(){return!!v.AFrameworkApplication.Aa&&v.AFrameworkApplication.Aa.hb.uC&&v.AFrameworkApplication.fa.ka("DirectPrintDialogAsStandardDialogIsEnabled")&&!(ve.a.uT||ve.a.Dj||ve.a.fg||ve.a.Z9b)&&!v.AFrameworkApplication.y$b&&
v.AFrameworkApplication.fa.ka("ShouldHostDefaultToNativeBrowserPrintExperience")}static set n1a(t){}}Object(k.a)(Kf,"PrintDialogWithLinkToPdf",md,[]);class oe{constructor(t){this.isEnabled=Boolean.parse(t.DirectPrintIsEnabled||"false");this.RQj=Boolean.parse(t.DirectPrintProbeIsEnabled||"false");this.pNj=Boolean.parse(t.DirectPrintEnabledForInternetExplorer||"false");this.tkb=(t.DirectPrintSupportedMimeTypes||"").split(oe.iZd);this.x0a=(t.DirectPrintSupportedPlugins||"").split(oe.iZd);this.tAj=(t.DirectPrintImmersivePreviewPlugins||
"").split(oe.iZd);this.Mfg=Boolean.parse(t.DirectPrintEnabledForEdge||"false");this.WIj=Boolean.parse(t.ChromePrintLayoutFixIsEnabled||"false");this.mri=parseInt(t.ChromeVersionFromWhichPrintLayoutIsEnabled||"76");this.zCe=14;this.AYg=14394;if(t=t.DirectPrintMinimalSupportedEdgeVersion){const P=t.split(".");2===P.length?(this.zCe=parseInt(P[0]),this.AYg=parseInt(P[1])):n.ULS.sendTraceTag(20734112,208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is invalid: {0}",t)}else n.ULS.sendTraceTag(20734113,
208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is not set in BRS")}}oe.iZd=",";Object(k.a)(oe,"DirectPrintBrsSettings",null,[]);class Hf{constructor(t,P){this.aZe=t;this.x0a=P}}Object(k.a)(Hf,"DirectPrintProbeResults",null,[]);var xb=d(199),hg=d(103);class rf{constructor(t,P,ia,Aa,Ka,pb,Nb,kc,Rc,Yc){this.uEc=null;this.uPh=t;this.hUb=P;this.oFd=ia;this.$Sh=Aa;this.UTh=Ka;this.WUb=new Fc.a(Object(r.a)(this,this.Gej,"getProbeResults"));this.Dyd=pb;this.tff=Rc;this.gKd=Nb;this.VTh=
kc;this.iUh=Yc}get UK(){return this.uPh}start(){}PEk(){this.UK.RQj&&this.P1j()}OHk(){const t=Array(this.UK.tkb.length);if(void 0!==this.hUb&&null!==this.hUb)for(let P=0;P<this.UK.tkb.length;P++)t[P]=this.UK.tkb[P]in this.hUb&&this.$Sh(this.hUb[this.UK.tkb[P]]);return t}PHk(){const t=Array(this.UK.x0a.length),P=!(void 0===this.oFd||null===this.oFd);for(let ia=0;ia<this.UK.x0a.length;ia++){const Aa=this.UK.x0a[ia];t[ia]=P&&Aa in this.oFd?!0:this.UTh(Aa)}return t}Ujj(){const t=this.OHk(),P=Array(t.length);
for(let ia=0;ia<t.length;ia++)P[ia]=t[ia]?this.wTi(this.hUb[this.UK.tkb[ia]]):null;return P}wTi(t){if(void 0===t||null===t)return null;t=t.enabledPlugin;return void 0===t||null===t?null:t.name}P1j(){n.ULS.sendTraceTag(4535643,328,50,"[MimeTypes: {0}] [Plugins: {1}]",this.WUb.value.aZe,this.WUb.value.x0a)}Gej(){var t=this.Ujj();const P=this.PHk(),ia={},Aa={};for(let Ka=0;Ka<this.UK.tkb.length;Ka++)ia[this.UK.tkb[Ka]]=t[Ka];for(t=0;t<this.UK.x0a.length;t++)Aa[this.UK.x0a[t]]=P[t];return new Hf(ia,Aa)}Hel(){return this.iUh||
!this.UK.isEnabled||v.AFrameworkApplication.y$b?!1:this.Eml()}ouh(){if(null!=this.uEc)return this.uEc;const t=rf.Kfg(this.UK);return this.uEc=this.UK.Mfg&&t||this.TIj()}TIj(){return ve.a.Uj&&this.UK.WIj&&ve.a.OIc>=this.UK.mri?!0:!1}Eml(){if(!this.VTh(this.UK))return!1;var t=hg.a.V9d(this.WUb.value.aZe);for(const P of t)if(void 0!==P&&null!==P)return!0;t=hg.a.V9d(this.WUb.value.x0a);for(const P of t)if(P)return!0;return!1}nwj(){const t=hg.a.V9d(this.WUb.value.aZe);for(const P of t)if(xb.a.contains(this.UK.tAj,
P))return!0;return!1}rvh(t){v.AFrameworkApplication.Aa&&v.AFrameworkApplication.fa.ka("DirectPrintDialogAsStandardDialogIsEnabled")?this.tff(t,null):this.Hel()?this.fMi(t,this.nwj()&&!0):this.tff(t,null)}fMi(t,P){const ia=this.gKd.Ci("UserAction","OpenDirectPrintDialog");this.Dyd.X6i(t,P).mja();ia.stop()}static zTj(t){try{return new ActiveXObject(t),!0}catch(P){n.ULS.sendTraceTag(4535642,328,100,"Failed to instantiate {0} as an ActiveX control.",t)}return!1}static XKj(t){return void 0===t||null===
t?!1:!(void 0===t.enabledPlugin||null===t.enabledPlugin)}static create(t){const P=new oe(v.AFrameworkApplication.fa.appSettings);let ia=null;try{ia=window.navigator.mimeTypes}catch(Yc){n.ULS.sendTraceTag(573923532,328,15,"Failed to get Window.Navigator.mimeTypes")}let Aa=null;try{Aa=window.navigator.plugins}catch(Yc){n.ULS.sendTraceTag(573923533,328,15,"Failed to get Window.Navigator.plugins")}const Ka=rf.XKj,pb=rf.zTj;t=t.resolve("Common.App.DirectPrint.DirectPrintDialogFactory");const Nb=v.AFrameworkApplication.Aa.gV,
kc=rf.ATj,Rc=!!v.AFrameworkApplication.Aa&&v.AFrameworkApplication.Aa.hb.uC&&!v.AFrameworkApplication.fa.ka("PrintDialogFallbackLinkEnabled");return new rf(P,ia,Aa,Ka,pb,t,Nb,kc,(Yc,hd)=>new Kf(Yc,!1,hd,!0,Rc),v.AFrameworkApplication.isEmbedded)}static ATj(t){return ve.a.Uj||ve.a.Dj&&t.pNj||t.Mfg&&rf.Kfg(t)?!0:!1}static Kfg(t){var P=ve.a.hRa;if(P){var ia=P.split(".");if(2===ia.length)return P=parseInt(ia[0]),ia=parseInt(ia[1]),P>t.zCe||P===t.zCe&&ia>=t.AYg}return!1}}Object(k.a)(rf,"DirectPrintManager",
null,[822]);class nf{constructor(){this.W8e=this.Da=null}get name(){return"Common.App.DirectPrint"}$b(t){this.Da=t;t.register(qd,"Common.App.DirectPrint.DirectPrintDialogFactory").ma().oa(()=>new qd(v.AFrameworkApplication.Aa.LR));t.register(822,"Common.App.DirectPrint.IDirectPrintManager").ma().oa(()=>rf.create(this.Da))}init(){this.W8e=this.Da.resolve("Common.App.DirectPrint.IDirectPrintManager");this.W8e.start()}dispose(){}}Object(k.a)(nf,"PackageManager",null,[2,3]);var kd=d(1116),If=d(302);class og{constructor(t,
P){this.rRb=null;this.Ca=t;this.$a=P}vb(){(this.rRb=this.$a.Ha("StatusBarEnvironmentNameToUse"))&&""!==this.rRb&&this.Ca.ra(E.a.FLe,u.a.frame,Object(r.a)(this,this.nyl,"updateEnvironmentName"),96)}nyl(t,P,ia,Aa,Ka){if(1===ia)return 32;Ka[kd.a.Value]=this.rRb;Ka[If.a.labelText]=this.rRb;Ka[kd.a.Visible]=!0;return 32}}Object(k.a)(og,"DisplayEnvironmentName",null,[]);class pf{constructor(){this.Da=null}get name(){return"Common.App.DisplayEnvironmentName"}$b(t){this.Da=t;this.Da.register(og,"Common.App.DisplayEnvironmentName.DisplayEnvironmentName").ma().oa(()=>
new og(v.AFrameworkApplication.Ta,v.AFrameworkApplication.fa))}init(){this.Da.resolve("Common.App.DisplayEnvironmentName.DisplayEnvironmentName").vb()}dispose(){}static main(){e.a.instance.Dc(new pf)}}Object(k.a)(pf,"DisplayEnvironmentNamePackage",null,[2,3]);var ig=d(172),Oe=d(544);class Ag extends Oe.a{constructor(t){super(t)}get p0b(){return!1}createElement(){const t=document.createElement("link");t.setAttribute("rel","stylesheet");t.setAttribute("type","text/css");t.setAttribute("href",this.rt);
return t}QKc(){return null}unc(){this.element.setAttribute("href","");this.element.setAttribute("href",this.vM.rt)}}Object(k.a)(Ag,"CssResource",Oe.a,[]);var ce=d(281),me=d(2);class Je{constructor(){this.zBc=this.Gxc=null}mZj(){this.Gxc||(n.ULS.sendTraceTag(21030598,324,50,"InProductMessagingDependenciesLoad usage"),this.Gxc=me.Task.WAA(Je.vZj(),Je.cZj()),this.Gxc.continueWith(t=>{n.ULS.sendTraceTag(21030599,324,10,"{0}",ab.a.r5d(t.Zi))},5));return this.Gxc}nZj(){if(!this.zBc)try{n.ULS.sendTraceTag(39978390,
324,50,"InProductMessagingFreemiumDependenciesLoad usage"),this.zBc=me.Task.WAA(Je.V_d(ce.a.create(v.AFrameworkApplication.fa.Ha("DimeUrl"),null,null))),this.zBc.continueWith(t=>{n.ULS.sendTraceTag(39978391,324,10,"{0}",ab.a.r5d(t.Zi))},5)}catch(t){n.ULS.sendTraceTag(594874951,324,10,"{0}",ab.a.r5d(t))}return this.zBc}static vZj(){var t=Je.UTc("inproductmessaging.js");t=ce.a.create(t,null,null);return Je.V_d(t)}static cZj(){var t=Je.UTc("inproductmessaging.css");t=new Ag(t);return Je.V_d(t)}static UTc(t){return ig.a.J_b(String.format("ipm/{0}",
t))}static V_d(t){Kc.a.Wx(t);return t.JFa}}Object(k.a)(Je,"DependencyDownloader",null,[837]);class ie{}ie.ewk="inProductMessagingOverlayDiv";ie.aAk="PlayButtonImage";ie.pWk="ReplayButtonImage";Object(k.a)(ie,"Constants",null,[]);class Tf{constructor(){this.xmf=this.Ngf=this.g6e=!0;this.qWk=this.bAk=null;this.Eik=!1;this.locale=null;this.rEh={}}get autoPlay(){return this.g6e}set autoPlay(t){this.g6e=t}get WYg(){return this.Ngf}set WYg(t){this.Ngf=t}get ivh(){return this.xmf}set ivh(t){(this.xmf=t)&&
this.d8k()}d8k(){this.Mrf(ie.aAk,this.bAk);this.Mrf(ie.pWk,this.qWk)}Mrf(t,P){P&&(this.rEh[t]=P)}}Object(k.a)(Tf,"FirstRunExperienceUISettings",null,[836]);class He{constructor(){this.completed=this.gRk=!1}}Object(k.a)(He,"FirstRunExperienceViewData",null,[835]);var Sg=d(189);class jc{constructor(t,P,ia){this.Ca=t;this.Rh=P;this.zyc=ia}vb(){this.Ca.ra(E.a.KXi,u.a.frame,Object(r.a)(this,this.JXi,"firstRunExperienceHandler"),64);this.Ca.ya(E.a.CUf,u.a.frame,Object(r.a)(this,this.AAj,"inProductMessagingTabHandler"));
this.Ca.ya(E.a.BUf,u.a.frame,Object(r.a)(this,this.zAj,"inProductMessagingShiftTabHandler"));this.Ca.ya(E.a.vLi,u.a.frame,Object(r.a)(this,this.wLi,"dimeLaunchHandler"));this.Ca.ya(E.a.jjh,u.a.frame,Sg.ActionManager.Jg);this.Ca.ya(E.a.JWk,u.a.frame,Sg.ActionManager.Jg);this.Ca.ya(E.a.KWk,u.a.frame,Sg.ActionManager.Jg);this.Rh&&this.Rh.updateCommandUI()}JXi(t,P,ia,Aa,Ka){2===ia&&this.zyc.rXj(Ka);return 32}wLi(t,P,ia,Aa,Ka){2===ia&&this.zyc.qXj(Ka);return 32}AAj(t,P,ia){return 2===ia?this.zyc.aDe():
32}zAj(t,P,ia){return 2===ia?this.zyc.UCe():32}}Object(k.a)(jc,"InProductMessagingActor",null,[]);class be{constructor(){this.vgh=this.I5=this.iAh=this.C0c=this.instance=null}}Object(k.a)(be,"DimeExperienceUISettings",null,[]);var Md=d(518);class de{constructor(t,P,ia,Aa,Ka){this.VPc=!1;this.D1b=null;this.Ca=t;this.g5a=P;this.jCc=ia;this.Iga=Aa;this.Hga=Ka}aDj(t){sb.b("getHeaderApi")?t.isFeatureEnabled("MsoPremiumBadge",!0).then(P=>{const ia=t.isFreemiumUpsellEnabled();ia&&(appChrome.getHeaderApi().then(Aa=>
{Aa.updatePremiumStatus(P,ia);return null}),t.Vhb("MsoPremiumBadge",Aa=>{appChrome.getHeaderApi().then(Ka=>{Ka.updatePremiumStatus(Aa.isEnabled,ia);return null})}));return null}):n.ULS.sendTraceTag(593859840,324,10,"getHeaderApi not available")}rXj(t){this.jCc.mZj().continueWith(()=>{this.g5a.Fhl(t)})}qXj(t){let P="gopremium",ia=null,Aa=()=>{};t?(t.experience&&""!==Object(R.a)(String,t.experience)&&(P=Object(R.a)(String,t.experience)),t.onTaskComplete&&(Aa=t.onTaskComplete),t.campaignId&&""!==Object(R.a)(String,
t.campaignId)&&(ia=Object(R.a)(String,t.campaignId))):n.ULS.sendTraceTag(51675402,324,50,"Experience not given, using default experience");this.Emg(P,Aa,ia)}Emg(t,P,ia=null){if(this.VPc&&this.D1b){const Aa={};Aa.experience=t||"gopremium";Aa.campaignId=ia||Md.b(this.Iga,this.Hga,Object(R.a)(String,Aa.experience),!0);this.Ca.processAction(E.a.jjh,2);n.ULS.sendTraceTag(51675403,324,50,"Launching Freemium Upsell dialog: "+Aa.experience);try{const Ka=Object.assign(new be,{instance:this.D1b,C0c:Aa,iAh:P||
(()=>{}),I5:pb=>{n.ULS.sendTraceTag(51675405,324,50,"Dime launch result: "+pb.status)},vgh:()=>{n.ULS.sendTraceTag(51675406,324,10,"Dime launch error");this.VPc=!1;this.D1b=null}});this.g5a.Vfl(Ka)}catch(Ka){n.ULS.sendTraceTag(51675407,324,10,"Dime launch error: "+Ka.message),this.VPc=!1,this.D1b=null,this.Ca.La(E.a.WPc,2,{["experience"]:Aa.experience})}}else n.ULS.sendTraceTag(39978392,324,10,"FreemiumUpsellDialogDependencies not loaded"),this.Ca.La(E.a.WPc,2,{["experience"]:t})}oZj(){this.jCc.nZj().continueWith(()=>
{try{var t=ab.a.og(v.AFrameworkApplication.uiCulture);const Aa=Md.c(this.Iga);if(Aa){var P={};P.partnerId=Aa;P.language=t;P.sessionId=v.AFrameworkApplication.userSessionId;P.authHint=v.AFrameworkApplication.fa.Ha("UserPrincipalName");var ia=v.AFrameworkApplication.fa.Ha("Puid")||"";""!==ia&&(t={},t.puid=ia,P.userInfo=t);this.D1b=new Dime(P);this.VPc=!0;n.ULS.sendTraceTag(592721856,324,50,"Dime initialized")}else n.ULS.sendTraceTag(51675409,324,15,"App not supported")}catch(Aa){n.ULS.sendTraceTag(51675410,
324,10,"FreemiumUpsellDialogDependencies failed: "+Aa.message)}},3)}aDe(){return this.g5a.aDe()}UCe(){return this.g5a.UCe()}}Object(k.a)(de,"InProductMessagingUIManager",null,[834]);class Zc{constructor(){this.Wnf=0;this.qob=Array(5);this.qob[0]=10;this.qob[1]=15;this.qob[2]=50;this.qob[3]=100;this.qob[4]=200}Init(t){this.Wnf=t}SendTrace(t,P){n.ULS.sendTraceTag(34182235,this.Wnf,this.qob[t],"{0}",P)}}Object(k.a)(Zc,"DefaultNetworkingManager",null,[889]);var Yf=d(198);class Vc{constructor(t){this.Od=
t}Fhl(t){t&&(InProductMessaging.Networking.NetworkingMgr=new Zc,InProductMessaging.Networking.NetworkingMgr.Init(387),InProductMessaging.Init(t.ivh,t.WYg,t.autoPlay,t.Eik,t.locale,Object(r.a)(this,this.Wnk,"onDismissFirstRunExperience"),t.rEh),this.P5(ie.ewk,!0))}Vfl(t){if(t&&t.instance&&t.C0c){let P=document.getElementById("wacDimeContainer");P||(P=document.createElement("div"),P.id="wacDimeContainer",document.body.appendChild(P));v.AFrameworkApplication.fa.ka("DimeFocusManagerIsEnabled")&&this.P5("wacDimeContainer",
!1);t.C0c.parentElementId="wacDimeContainer";t.instance.launch(t.C0c,t.iAh).then(ia=>{this.Ona();document.body.removeChild(P);t.I5(ia)}).catch(ia=>{this.Ona();document.body.removeChild(P);t.vgh(ia)})}else throw Error.argument("DimeExperienceUISettings");}P5(t,P){if(this.Od&&t&&(t=document.getElementById(t),this.RCj(t),t=this.Od.rQ("InProductMessagingFocusId"))){const ia=this.Od.Be;ia&&"InProductMessagingFocusId"===ia.name||this.Od.tY("InProductMessagingFocusId",!1);P&&this.ENe(t.scope)}}RCj(t){var P=
this.Od.Gc("InProductMessagingFocusId");P.parent=Na.AFrame.GD;const ia=new Yf.DOMFocusListing(()=>t);ia.Zhb=!1;ia.Eo(3);ia.Eo(2);ia.Eo(4);P=this.Od.Eia(()=>t,P,ia);P.$hb();P.kX=!0;P.rQa=!0}ENe(t){t.Ap(Wb.FocusManager.instance().Eqa);t.Ap(Wb.FocusManager.instance().Fqa);t.bindAction(Wb.FocusManager.instance().Eqa,E.a.CUf);t.bindAction(Wb.FocusManager.instance().Fqa,E.a.BUf)}Ona(){this.Od&&(this.Od.x5("InProductMessagingFocusId"),this.Od.wJb("InProductMessagingFocusId"))}Wnk(t,P){this.Ona();t=Object.assign(new He,
{completed:t,gRk:P});v.AFrameworkApplication.Ta.La(E.a.IXi,2,t)}aDe(){const t=document.activeElement,P=this.Od.yl();return t&&P&&P.uj&&t===P.uj.Xzb?(P.uj.VE(t),P.BFb()?32:8):4}UCe(){const t=document.activeElement,P=this.Od.yl();return t&&P&&P.uj&&t===P.uj.zja?(P.uj.VE(t),P.zFb()?32:8):4}}Object(k.a)(Vc,"InProductMessagingUIWrapper",null,[821]);class zc{constructor(){this.Da=null}get name(){return"Common.App.InProductMessaging"}$b(t){t.register(Je,"Common.App.InProductMessaging.DependencyDownloader").as("Common.App.InProductMessaging.IDependencyDownloader").ma().oa(()=>
new Je);t.register(Vc,"Common.App.InProductMessaging.InProductMessagingUIWrapper").as("Common.IInProductMessagingUIWrapper").ma().oa(()=>new Vc(Wb.FocusManager.instance()));t.register(de,"Common.App.InProductMessaging.InProductMessagingUIManager").as("Common.IInProductMessagingUIManager").ma().oa(()=>new de(v.AFrameworkApplication.Ta,t.resolve("Common.IInProductMessagingUIWrapper"),t.resolve("Common.App.InProductMessaging.IDependencyDownloader"),v.AFrameworkApplication.Aa.hb.Vk,v.AFrameworkApplication.Aa.hb.KIa));
t.register(jc,"Common.App.InProductMessaging.InProductMessagingActor").ma().oa(()=>new jc(v.AFrameworkApplication.Ta,v.AFrameworkApplication.Aa,t.resolve("Common.IInProductMessagingUIManager")));t.register(Tf,"Common.App.InProductMessaging.FirstRunExperienceUISettings").as("Common.IFirstRunExperienceUISettings").ma().oa(()=>new Tf);t.register(He,"Common.App.InProductMessaging.FirstRunExperienceViewData").as("Common.IFirstRunExperienceViewData").ma().oa(()=>new He);this.Da=t}init(){this.Da.resolve("Common.App.InProductMessaging.InProductMessagingActor").vb();
v.AFrameworkApplication.fa.jf(()=>{v.AFrameworkApplication.Aa.hb.WN&&Ya.a.get_instance().Dk(15,()=>{this.Da.Ja("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(t=>{this.Da.resolve("Common.App.InProductMessaging.InProductMessagingUIManager").aDj(t)})});v.AFrameworkApplication.fa.ka("FreemiumUpsellShowDialogIsEnabled")&&Md.a()&&!ve.a.hx&&1!==v.AFrameworkApplication.Aa.hb.Vk&&this.Da.Ja("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(t=>{t.isFeatureEnabled("MsoPremiumBadge",
!0).then(P=>{!P&&t.isFreemiumUpsellEnabled()&&this.Da.resolve("Common.App.InProductMessaging.InProductMessagingUIManager").oZj();return null})})})}dispose(){}static main(){e.a.instance.Dc(new zc)}}Object(k.a)(zc,"InProductMessagingPackage",null,[2,3]);var vf=d(387),Tg=d(557);class bb{static JPi(t){return bb.Nyf("New",t)}static KPi(t){return bb.Nyf("Open",t)}static vyf(t,P){return bb.k6a("LoadingMenuSection",bb.i_j,t,bb.eZb("lblLoading",P))}static fZb(t,P,ia=null,Aa=null){return bb.k6a("MessageMenuSection",
bb.yZg,P,bb.eZb("lblMessage",t,ia,Aa))}static Lji(t){return bb.vyf(t,CommonUIStrings.l_VoicedLoadingText)}static Mji(t,P){return bb.fZb(CommonUIStrings.l_NewCreationLocationMessage,t.labelText,P.vR,P.gLa)}static Kji(t,P){return bb.fZb(String.format(CommonUIStrings.l_NewProvisioningStorageMessage,P.gLa,"\n\n"),t.labelText)}static xyf(t){return bb.fZb(CommonUIStrings.l_NewGenericErrorMessage,t.labelText)}static Iji(t,P,ia){return bb.k6a("menuNewBlank",bb.nxj,ia?t.labelText:null,bb.aZb(t.w$f,t.x$f,t.y$f,
null,t.xEa,t.I7b,P,"blank"))}static ski(){return bb.eZb("lblTemplatesLoading",CommonUIStrings.l_VoicedLoadingText)}static Kyf(){return bb.eZb("lblTemplatesError",CommonUIStrings.l_NewTemplateErrorMessage)}static tki(t,P){return bb.k6a("menuNewTemplates",t,null,P)}static Gji(t,P){return bb.k6a("menuNewMoreTemplates",bb.yVf,null,bb.aZb("menuNewMoreTemplatesButton",CommonUIStrings.l_NewMoreTemplates,CommonUIStrings.l_NewMoreTemplates,null,null,null,t,P))}static Mii(t,P,ia){let Aa="";ia&&P&&(Aa=bb.k6a("BrowseMoreMenuSection",
bb.yVf,null,bb.aZb("btnBrowseMore",P,P,null,null,null,t||"1959943459",ia)));return Aa}static eZb(t,P,ia=null,Aa=null){let Ka=Aa;P&&0<P.length&&(Ka=bb.c_g.mJa(P).trimEnd(),Ka=0<=Ka.indexOf("{0}")?String.format(Ka,Aa):String.format("{0} {1}",Ka,Aa));ia=ia&&Aa?String.format('\r\n\t\t\t\t\tInnerLink="{0}"\r\n\t\t\t\t\tInnerLinkText="{1}"\r\n\t\t\t\t\tInnerLinkTitle="{2}"',ab.a.pe(ia),ab.a.pe(Aa),ab.a.pe(Ka)):"";return String.format('\r\n\t\t\t\t<Label\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\t{2}/>',
ab.a.pe(t||""),bb.c_g.mJa(ab.a.pe(P||"")),ia)}static aZb(t,P,ia,Aa,Ka,pb,Nb,kc){return String.format('\r\n\t\t\t\t<Button\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\tDescription="{2}"\r\n\t\t\t\t\tImage{3}Class="{4}"\r\n\t\t\t\t\tImage{3}="{5}"\r\n\t\t\t\t\tCommand="{6}"\r\n\t\t\t\t\tMenuItemId="{7}"/>',ab.a.pe(t||""),ab.a.pe(P||""),ab.a.pe(ia||""),Aa||"32by32",ab.a.pe(Ka||""),ab.a.pe(pb||""),Nb,ab.a.pe(kc||""))}static Nyf(t,P){return String.format('\r\n\t\t\t\t<Menu Id="menuJewel{0}">{1}\r\n\t\t\t\t</Menu>',
t,P)}static k6a(t,P,ia,Aa){ia=ia?String.format('Title="{0}"',ab.a.pe(ia)):"";return String.format('\r\n\t\t\t\t<MenuSection\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tDisplayMode="{1}"\r\n\t\t\t\t\t{2}\r\n\t\t\t\t\tShowMenuSectionSeparator="false">\r\n\t\t\t\t\t<Controls>{3}\r\n\t\t\t\t\t</Controls>\r\n\t\t\t\t</MenuSection>',ab.a.pe(t||""),ab.a.pe(P||""),ia,Aa)}}bb.yZg="MenuMru";bb.i_j="MenuLoading";bb.nxj="MenuHeader";bb.yVf="MenuFooter";bb.c_g=Tg.a.Vw("\n","&#10;");Object(k.a)(bb,"NewAndOpenXmlUtilities",
null,[]);var Vb=d(94);class Ub{constructor(){this.folderName=this.folderUrl=this.hostName=this.hostUrl=null}}Object(k.a)(Ub,"HostInformation",null,[]);var Jc=d(132),Mc=d(173),ed=d(124),dd=d(435),je=d(519);class Nd{constructor(t,P,ia,Aa,Ka,pb){this.KDc=this.io=this.wvc=null;this.bDc=this.JJd=!1;this.zgf=0;this.vJd=this.OCd=!1;this.yha=t;this.FRb=P;this.fha=new Fc.a(()=>new vf.a(ia.value,Object(r.a)(this,this.TDa,"getMoreInfoEventReceived")));this.NVh=Aa;this.aOa=Ka;this.z_h=pb;this.YVb=this.Zod;2===
this.yU.Wma&&(this.vJd=!0);v.AFrameworkApplication.fa&&v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.AdditionalDocumentTemplates",!1)&&this.tVi()}get C2(){switch(this.yU.Wma){case 3:return"WordWAC";case 1:return"ExcelWAC";case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null}tVi(){Jc.a.instance.Eb(new D.a(5,1,0,()=>{this.getTemplateListJson()}))}vb(){const t=this.yU.OFb;t.ya(E.a.newDocument,u.a.frame,Object(r.a)(this,this.newDocument,"newDocument"));t.ya(E.a.hlc,
u.a.frame,Object(r.a)(this,this.hlc,"populateNewMenu"))}newDocument(t,P,ia,Aa,Ka){if(1===ia)return 32;if(2===ia&&Ka){if(v.AFrameworkApplication.fa.ka("BackstagePremiumTemplateExperienceEnabled")&&Ka.IsPremium)return appChrome.api.dispatch(appChrome.actions.updateFileMenuExpandedValue(!1)),v.AFrameworkApplication.Ta.processAction(E.a.EDk,2);if(Ka.MenuItemId&&Ka.SourceControlId)return"NewDocumentHome"===Ka.SourceControlId&&jb.a("NewDocumentFromHomeTab"),this.h7a(Ka.MenuItemId,Ka.SourceControlId)}return 8}h7a(t,
P){var ia=this.ucd.KWd;if(null===ia)return 8;var Aa=v.AFrameworkApplication.fa.ka("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC");if(v.AFrameworkApplication.Zab&&Aa){n.ULS.sendTraceTag(51455198,202,50,"CreateNewActor.CreateNewDocument: Sending CreateNewDocument post message.");const Ka={};Ka[Mc.a.DAh]=t;Ka[Mc.a.C2]=this.C2;Ka[Mc.a.lcid]=v.AFrameworkApplication.lcid.toString();Ka[Mc.a.reason]=dd.a.PDi;v.AFrameworkApplication.gT().execute(pb=>{pb.sendMessage(ed.a.h7a,Ka)})}else Aa=(new Date).getTime(),
P=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&or=wacFileNew&bid={6}&Canary={7}&{8}",ia,ab.a.Ke(this.Iwa),ab.a.Ke(t),ab.a.Ke(this.C2),ab.a.Ke(v.AFrameworkApplication.lcid.toString()),ab.a.Ke(Aa.toString()),ab.a.Ke(P),ab.a.Ke(v.AFrameworkApplication.canary),v.AFrameworkApplication.jh),(ia=v.AFrameworkApplication.fa.Ha("ScenarioId"))&&""!==ia&&(P+="&wdscenarioid="+ab.a.Ke(ia)),P+="&"+v.AFrameworkApplication.QSa(),v.AFrameworkApplication.qUa&&(P+="&"+v.AFrameworkApplication.qSc()),
(ia=this.io?this.io.vR:null)&&(P+="&DestinationUrl="+ab.a.Ke(ia)),Ze.a.un(P,"_blank",void 0,"CreateNewDocument");2===this.yU.Wma&&n.ULS.sendTraceTag(24700384,202,50,"CreateNewDocument from New Menu {0}",{["AppType"]:je.a[this.yU.Wma],["Template"]:t});return 32}G2j(t){let P=Number.MAX_VALUE,ia=Number.MIN_VALUE;const Aa=window.performance;if(Aa&&"undefined"!==typeof Aa.getEntriesByName){for(let pb=0;pb<t.length;pb++){var Ka=Aa.getEntriesByName(t[pb]);Ka&&0<Ka.length&&(Ka=Ka[0],P=Math.min(parseInt(String(Ka.fetchStart)),
P),ia=Math.max(parseInt(String(Ka.responseEnd)),ia))}ia>P&&n.ULS.sendTraceTag(5849601,202,50,"Total time to download template thumbnails {0}",{["TotalElapsedMs"]:ia-P,["MinFetchStart"]:P,["MaxResponseEnd"]:ia})}}hlc(t,P,ia,Aa,Ka){if(1===ia)return this.vJd&&(v.AFrameworkApplication.CL("Microsoft.Office.Server.Powerpoint.Web.IPptMoreThemesInNewMenuSettings"),this.vJd=!1),32;2!==ia||this.OCd||(this.zgf=(new Date).getTime(),n.ULS.sendTraceTag(5849602,202,50,"File New menu flyout opened by user {0}",{["ShouldShowTemplates"]:this.Zod,
["CachedNewMenuXmlExists"]:!!this.wvc,["ShouldCallGetMoreInfo"]:this.yU.iLa}));v.AFrameworkApplication.PFa("AdditionalDocumentTemplates-tf;AdditionalDocumentTemplates-cf");v.AFrameworkApplication.PFa("templatesCreateNewcf;templatesCreateNewtf");return this.eBk(Ka)}eBk(t){t&&(this.wvc?t.PopulationXML=this.wvc:(this.yU.iLa&&!this.io&&this.gjk.Yca("Opened New menu",!0),t.PopulationXML=this.V0i(this.getTemplateListJson())));return 32}ojg(){return!this.yU.iLa||!!this.io&&3===this.io.state&&!!this.io.gLa&&
!!this.io.vR}jRj(){return v.AFrameworkApplication.Aa&&v.AFrameworkApplication.Aa.hb.qFa?!0:this.ojg()}getTemplateListJson(){if(!this.Zod||!this.jRj())return null;if(this.YVb&&!this.bDc){var t="9";v.AFrameworkApplication.fa&&v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.AdditionalDocumentTemplates",!1)&&(t="21");const P=v.AFrameworkApplication.fa.appSettings;"NumberOfTemplatesInBackstage"in P&&(t=P.NumberOfTemplatesInBackstage);let ia=this.C2;const Aa=v.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.WordOnline.CreateNewTemplates",
"");""===Aa?"TemplateCollectionId"in P&&(ia=P.TemplateCollectionId):3===this.yU.Wma&&(ia=Aa);t=String.format(this.yU.Vma+"TemplateServiceProxy.ashx?lcid={0}&apps={1}&show={2}",ab.a.Ke(v.AFrameworkApplication.lcid.toString()),ab.a.Ke(ia),t);Boolean.parse(P.AppendOriginQueryParam||"false")&&(t+="&org=backstage");Boolean.parse(P.BackstagePremiumTemplateExperienceEnabled||"false")&&"TemplateTier"in P&&(t+="&templateTier="+P.TemplateTier);t+="&"+v.AFrameworkApplication.QSa();v.AFrameworkApplication.qUa&&
(t+="&"+v.AFrameworkApplication.qSc());this.yU.Gic.Aj(t,1,null,null,!1,2,Ka=>{this.yU.vbb("CreateNewActor.GetTemplateListJson",Ka.data);this.Vol(Ka.data.Zd)},Ka=>{this.yU.vbb("CreateNewActor.GetTemplateListJson",Ka.data);this.Uol()},null,void 0,void 0,void 0,void 0,"5");this.YVb=!1}return this.KDc}Vol(t){v.AFrameworkApplication.fa&&v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.AdditionalDocumentTemplates",!1)?this.KDc=this.cWi(t):this.KDc=t;this.YVb=!1;this.hnc();if(v.AFrameworkApplication.Aa&&
v.AFrameworkApplication.Aa.hb.qFa&&sb.c()){t=v.AFrameworkApplication.fa.ka("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC");const P=v.AFrameworkApplication.Zab;appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson(this.KDc,!0,t&&P))}}Uol(){this.bDc=this.YVb=!0;this.hnc();v.AFrameworkApplication.Aa&&v.AFrameworkApplication.Aa.hb.qFa&&sb.c()&&appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson("",!1,!1));Vb.Health.instance.recordQosError("TemplateServiceReturnedFailure",
["TemplateServiceFailed"],!1,!0,!0,!1,null)}cWi(t){t=JSON.parse(t);const P=new ha.a;P.add("TM00002102");P.add("TM00002101");P.add("TM16392939");const ia=xb.a.gpa(t,Aa=>P.contains(Aa.AssetId));t=t.slice(0,9);t.splice.apply(t,[2,0].concat(ia));return JSON.stringify(t)}glj(t){var P=0;for(var ia=0;ia<t.length;ia++)if("ST"===t[ia].ImageType){P=ia;break}const Aa=t.length?t[P]:null;t=Aa?Aa.Url||"":"";var Ka;let pb=ia=P=!1;if(Aa&&(Ka=Aa.AspectRatio))Ka=parseFloat(Ka),1>Ka?P=!0:1.5<Ka?ia=!0:1===Ka&&(pb=!0);
else switch(n.ULS.sendTraceTag(5849603,202,10,"Thumbnail aspect ratio missing {0}",{["Url"]:t}),this.yU.Wma){case 3:P=!0;break;case 2:ia=!0;break;case 5:pb=!0}return{returnValue:t,mL:P?"95by123":ia?"123by69":pb?"100by100":"123by95"}}V0i(t){const P=({Mod:t}=this.Jji(t,this.ucd,this.ucd.lZb||"1056925771")).returnValue;t&&(this.wvc=P,n.ULS.sendTraceTag(5849604,202,50,"New menu rendering completed by GenerateXMLFromJSON {0}",{["ElapsedMsSinceMenuOpened"]:(new Date).getTime()-this.zgf}));return P}TDa(t,
P){n.ULS.sendTraceTag(590964757,202,50,"GetMoreInfoEventReceived");this.io||3!==t.state?2===t.state&&(n.ULS.sendTraceTag(590964759,202,50,"GetMoreInfoResult was bad, need to retry"),this.JJd=!0,this.hnc()):(this.io=t,P||this.hnc(),v.AFrameworkApplication.Aa&&v.AFrameworkApplication.Aa.hb.qFa&&sb.c()&&sb.d("setFileMenuHostInformation")&&(t=Object.assign(new Ub,{hostUrl:this.io.vR,hostName:this.io.gLa,folderUrl:v.AFrameworkApplication.breadcrumbFolderUrl,folderName:v.AFrameworkApplication.breadcrumbFolderName}),
n.ULS.sendTraceTag(590964758,202,50,"Sending HostInformation to FileMenu"),appChrome.api.dispatch(appChrome.actions.setFileMenuHostInformation(t))))}Jji(t,P,ia){let Aa;Aa=!1;const Ka=this.ojg();let pb="";this.yU.iLa&&(this.JJd?(pb=bb.xyf(P),this.JJd=!1,n.ULS.sendTraceTag(5849605,202,10,"Rendering File>New with error message due to GetMoreInfo request failure")):this.io?Ka?pb=bb.Mji(P,this.io):this.io.DFj?(Aa=!0,this.YVb=!1,pb=bb.Kji(P,this.io),n.ULS.sendTraceTag(5849607,202,50,"Rendering File>New with personal storage instantiation message")):
(Aa=!0,pb=bb.xyf(P),n.ULS.sendTraceTag(5849608,202,10,"Rendering File>New with error message due to GetMoreInfo invalid response. {0}",{["PersonalFileStorageUrlIsSet"]:!!this.io.vR,["StorageServiceDisplayNameIsSet"]:!!this.io.gLa})):(pb=bb.Lji(P.labelText),n.ULS.sendTraceTag(5849606,202,50,"Rendering File>New with loading spinner")));Ka&&(pb+=bb.Iji(P,ia,!pb)+({Mod:Aa}=this.rki(t,ia)).returnValue);return{returnValue:bb.JPi(pb),Mod:Aa}}rki(t,P){let ia;ia=!1;if(!this.Zod)return ia=!0,n.ULS.sendTraceTag(5849609,
202,50,"Rendering File>New without template buttons due to BRS"),{returnValue:"",Mod:ia};let Aa="",Ka="",pb="MenuTemplate";if(this.bDc)Aa=bb.Kyf(),this.bDc=!1,n.ULS.sendTraceTag(5849610,202,10,"Rendering File>New with template error message");else if(t){try{const Nb=Sys.Serialization.JavaScriptSerializer.deserialize(t,!0);Aa=this.qki(Nb,P);n.ULS.sendTraceTag(5849612,202,50,"Rendering File>New with template buttons");v.AFrameworkApplication.e_g&&"OneDrive"===this.Iwa&&(Ka=bb.Gji(this.hjk,v.AFrameworkApplication.e_g))}catch(Nb){n.ULS.sendTraceTag(5849613,
202,10,"Failed to parse JSON response from template service {0}",{["JsonToConvert"]:t}),Aa=bb.Kyf()}ia=!0}else pb="MenuLoading",Aa=bb.ski(),n.ULS.sendTraceTag(5849611,202,50,"Rendering File>New with template loading spinner");return{returnValue:bb.tki(pb,Aa)+Ka,Mod:ia}}qki(t,P){let ia="";const Aa=[];for(let pb=0;pb<t.length;pb++){var Ka=t[pb];let Nb="";if(Ka){const kc=Ka.Title,Rc=Ka.AssetId;Ka=Ka.Thumbnails;Rc&&kc&&Ka&&({mL:Ka,returnValue:Nb}=this.glj(Ka),ia+=bb.aZb("jbtnNewTemplate"+pb,kc,null,Ka,
null,Nb,P,Rc))}Aa[pb]=Nb}t=new D.a(4,1,5E3,()=>{this.G2j(Aa)},106);this.yU.scd.Eb(t);return ia}hnc(){this.OCd=!0;this.yU.$Zg.E1(this.ucd.M3b);this.OCd=!1}get yU(){return this.yha.value}get ucd(){return this.FRb.value}get gjk(){return this.fha.value}get hjk(){return this.NVh.value}get Iwa(){return this.aOa.value}get Zod(){return this.z_h.value}}Object(k.a)(Nd,"CreateNewActor",null,[]);class Ld{constructor(){this._initialized=!1;this.mKd={}}nC(t){this.yQf();return this.get(t)}contains(t){this.yQf();
return t.toString()in this.mKd}yQf(){this._initialized||(this.O6h(),this._initialized=!0)}zqb(t,P){this.mKd[t.toString()]=P}get(t){return this.mKd[t.toString()]}}Object(k.a)(Ld,"AIntlHelper",null,[]);class Xe extends Ld{constructor(){super()}O6h(){this.zqb(0,CommonUIStrings.l_OpenMenuEmptyMruMessage);this.zqb(1,CommonUIStrings.l_OpenMenuServerErrorMessage);this.zqb(2,CommonUIStrings.l_Open);this.zqb(3,CommonUIStrings.l_OpenMenuRecentDocuments);this.zqb(4,CommonUIStrings.l_OpenMenuMoreOnHost);this.zqb(5,
CommonUIStrings.l_VoicedLoadingText)}static get instance(){return Xe.Ka||(Xe.Ka=new Xe)}static ivk(t){return Xe.instance.nC(t)}}Xe.Ka=null;Object(k.a)(Xe,"MruActorIntlHelper",Ld,[]);var pe;(function(t){t[t.success=0]="success";t[t.failure=1]="failure";t[t.spinner=2]="spinner";t[t.none=3]="none"})(pe||(pe={}));Object(k.b)("DisplayState",pe);var fe=d(33);class wd{constructor(t,P,ia,Aa,Ka,pb,Nb,kc){this.Wwd=null;this.eMd=!0;this.vvc="";this.p1h=0;this.pob=null;this.JDd=3;this.$a=kc;this.yha=t;this.Jba=
P;this.BQh=ia;this.gNh=Aa;this.fNh=Ka;this.fha=new Fc.a(()=>new vf.a(pb.value,null));this.kRh=new Fc.a(()=>new vf.a(Nb.value,Object(r.a)(this,this.wik,"mruEventResultReceived")));this.$a.ka("WacInTabOpenMRUIsEnabledForUiHost");this.$a.ka("UiHostSupportsDocRebootFeatures")}wik(t,P){this.pob=t;P||this.Ifh()}pQk(){this.PO.OFb.ra(E.a.Ugd,u.a.frame,Object(r.a)(this,this.Ugd,"populateMruMenu"),96)}Ugd(t,P,ia,Aa,Ka){return 1!==ia&&Ka?this.dBk(Ka):32}dBk(t){this.mQi();this.lQi();t.PopulationXML=bb.KPi(this.vvc+
this.Wwd);return 32}mQi(){var t=3;let P=!1;if(this.vvc&&this.p1h===this.pob.qql)n.ULS.sendTraceTag(5849627,202,50,"Open menu MRU entries to XML conversion not required {0}",{["CacheRefresh"]:"Not Dirty"}),t=this.JDd;else{n.ULS.sendTraceTag(5849628,202,50,"Open menu MRU entries to XML conversion started {0}",{["CacheRefresh"]:"Starting"});var ia=this.PO.zF();this.pob=this.vik.Yca("File Open opened",!0);this.vvc&&2!==this.JDd&&3!==this.pob.state?P=!0:(t=this.lhj(this.pob),v.AFrameworkApplication.Aa&&
v.AFrameworkApplication.Aa.hb.qFa&&sb.c()&&t&&appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(t,!0)),this.vvc=({Yik:t}=this.W0i(this.pob)).returnValue);ia=this.PO.zF()-ia;n.ULS.sendTraceTag(5849629,202,50,"Open menu MRU entries to XML conversion ended {0}",{["CacheRefresh"]:"Complete",["ElapsedMs"]:ia})}2!==t&&(ia={["DisplayState"]:pe[t]},1!==t&&(ia.IsStale=P),n.ULS.sendTraceTag(5849630,202,50,"MRU section display state {0}",ia));this.JDd=t}lhj(t){let P;try{P=fe.c(t.rDe)}catch(ia){P=null,
n.ULS.sendTraceTag(0,202,10,"MruActor.Serialize: Exception thrown from JsonSerializer.Serialize Exception: {0}",ia)}return P}lQi(){this.eMd?(n.ULS.sendTraceTag(5849632,202,50,"Open menu Browse More Link creation necessary."),this.Wwd=({oEl:this.eMd}=this.Iek()).returnValue):n.ULS.sendTraceTag(5849631,202,50,"Open menu Browse More Link creation not required.");n.ULS.sendTraceTag(5849633,202,50,"Browse More link display state {0}",{["WaitingOnLinkInfo"]:this.eMd,["NotDisplayingLink"]:!this.Wwd})}W0i(t){let P;
1===t.state||0===t.state?(n.ULS.sendTraceTag(5849635,202,50,"Open menu XML built {0}",{["Display"]:"Spinner"}),t=2,P=bb.vyf(this.gEa(2),this.gEa(5))):3===t.state&&t.rDe?(P=this.Hji(t.rDe),t=0):(n.ULS.sendTraceTag(5849634,202,50,"Open menu XML built {0}",{["Display"]:"Server Error"}),P=bb.fZb(this.gEa(1),this.gEa(2)),t=1);return{returnValue:P,Yik:t}}Hji(t){let P;const ia=this.aic.lZb||"2155708348";if(t.length){P=bb.eZb("lblRecentDocuments",this.gEa(3));let Aa=0;for(let Ka=0;Ka<t.length;Ka++){const pb=
t[Ka];"FileName"in pb&&"DocumentUrl"in pb&&"Path"in pb&&(P+=bb.aZb("MruButton"+Ka,pb.FileName.toString(),pb.Path.toString(),null,this.aic.xEa,this.aic.I7b,ia,pb.DocumentUrl.toString()),pb.IsPinned&&Aa++)}P=bb.k6a("RecentDocumentsMenuSection",bb.yZg,this.gEa(2),P);n.ULS.sendTraceTag(5849665,202,50,"Open menu XML built {0}",{["Display"]:"MRU List",["TotalDocuments"]:t.length,["NumPinnedDocuments"]:Aa})}else P=bb.fZb(this.gEa(0),this.gEa(2)),n.ULS.sendTraceTag(5849664,202,50,"Open menu XML built {0}",
{["Display"]:"Empty MRU"});return P}Iek(){let t;t=!0;let P=this.dii;var ia=this.cii;if(P&&ia||!this.PO.iLa)t=!1;else{const Aa=this.uSc.Yca("File Open",!1);3===Aa.state&&(P=Aa.vR,ia=Aa.gLa,t=!1)}ia=ia?String.format(this.gEa(4),ia):null;return{returnValue:bb.Mii(this.aic.lZb,ia,P),oEl:t}}Ifh(){this.PO.$Zg.E1(this.aic.M3b)}get PO(){return this.yha.value}get gEa(){return this.Jba.value}get aic(){return this.BQh.value}get dii(){return this.gNh.value}get cii(){return this.fNh.value}get uSc(){return this.fha.value}get vik(){return this.kRh.value}}
Object(k.a)(wd,"MruRenderer",null,[]);var Ue=d(174),rd=d(444);class Ud{constructor(t,P,ia,Aa,Ka,pb,Nb){this.io=null;this.zlf=!1;this.gNa=this.I6e=0;this.YVh=t;this.Cob=P;this.vAc=ia;this.FRb=Aa;this.aOa=Ka;this.yha=pb;this.fha=new Fc.a(()=>new vf.a(Nb.value,Object(r.a)(this,this.TDa,"getMoreInfoEventReceived")))}h7a(){!this.io&&this.EDe.iLa?this.uSc.Yca("NewDocumentFromStream",!0):this.createNewDocumentFromStream()}TDa(t){if(!this.io&&3===t.state)this.io=t;else if(2===t.state){this.zlf?n.ULS.sendTraceTag(24904471,
202,10,"After second try GetMoreResult still fail."):(this.uSc.Yca("NewDocumentFromStream",!0),this.zlf=!0);return}this.createNewDocumentFromStream()}createNewDocumentFromStream(){this.I6e=(new Date).getTime();var t=this.BVi.KWd;if(null===t)this.Cob(null);else{var P=this.vAc.menuItemId,ia=this.vAc.XU,Aa=this.vAc.Tll,Ka=this.vAc.IVi;this.gNa="streamBase64"===Aa?Ka.length/1024:0;n.ULS.sendTraceTag(35156358,202,50,"FileType:{0}, FileSize:{1}",this.C2,this.gNa);var pb=(new Date).getTime();t=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&bid={6}&Canary={7}&{8}&sa={9}",
t,ab.a.Ke(this.Iwa),ab.a.Ke(P),ab.a.Ke(this.C2),ab.a.Ke(v.AFrameworkApplication.lcid.toString()),ab.a.Ke(pb.toString()),ab.a.Ke(ia),ab.a.Ke(v.AFrameworkApplication.canary),v.AFrameworkApplication.jh,ab.a.Ke(Aa));t+="&"+v.AFrameworkApplication.QSa();v.AFrameworkApplication.qUa&&(t+="&"+v.AFrameworkApplication.qSc());(P=this.io?this.io.vR:null)&&(t+="&DestinationUrl="+ab.a.Ke(P));this.EDe.Gic.Aj(t,2,Ka,{"Content-Type":"application/json; charset=utf-8"},!0,2,Object(r.a)(this,this.ajk,"newDocumentFromStreamSuccessHandler"),
Object(r.a)(this,this.$ik,"newDocumentFromStreamFailureHandler"),null,void 0,void 0,void 0,void 0,"31")}}ajk(t){if(t&&t.data&&t.data.Zd){var P;({kv:P}=fe.d(t.data.Zd)).returnValue?(t=P,t.StatusCode!==Ue.a.Ey&&t.StatusCode!==Ue.a.T0b?(n.ULS.sendTraceTag(24904475,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: StatusCode: {2}",this.C2,this.gNa,t.StatusCode),this.Cob(null)):t.NewDocumentUrl&&""!==t.NewDocumentUrl?(n.ULS.sendTraceTag(35156359,202,50,"FileType:{0}, FileSize:{1}, TimeConsumed:{2}",
this.C2,this.gNa,(new Date).getTime()-this.I6e),this.YVh(t.NewDocumentUrl)):(n.ULS.sendTraceTag(24904476,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data do not have NewDocumentUrl.",this.C2,this.gNa),this.Cob(null))):(n.ULS.sendTraceTag(24904474,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Failed to deserialize: {2}",this.C2,this.gNa,{["ResponseData"]:rd.a.btc(t.data.Zd)}),this.Cob(null))}else n.ULS.sendTraceTag(24904473,202,10,
"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data is null",this.C2,this.gNa),this.Cob(null)}$ik(t){t&&t.data&&n.ULS.sendTraceTag(24904477,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: ErrorStatus: {2}",this.C2,this.gNa,t.data.status);this.Cob(null)}get C2(){switch(this.EDe.Wma){case 3:return"WordWAC";case 1:return"ExcelWAC";case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null}get BVi(){return this.FRb.value}get Iwa(){return this.aOa.value}get EDe(){return this.yha.value}get uSc(){return this.fha.value}}
Object(k.a)(Ud,"NewDocumentFromStreamOperation",null,[]);class qe{constructor(t,P,ia,Aa){this.FRb=t;this.aOa=P;this.yha=ia;this.jRh=Aa}create(t,P,ia){return new Ud(t,P,ia,this.FRb,this.aOa,this.yha,this.jRh)}}Object(k.a)(qe,"NewDocumentFromStreamOperationFactory",null,[887]);var Nf=d(288);class sf{get name(){return"Common.App.NewAndOpen.UX"}$b(t){t.register(qe,"Common.App.NewAndOpen.UX.NewDocumentFromStreamOperationFactory").as("Common.App.NewAndOpen.UX.INewDocumentFromStreamOperationFactory").ma().oa(()=>
new qe(new Fc.a(()=>v.AFrameworkApplication.Aa.hb.A5d()),new Fc.a(()=>v.AFrameworkApplication.Iwa),new Fc.a(()=>t.rb("Common.INewAndOpenCommonHelpers")),new Fc.a(()=>t.rb("Common.IEventEmitter<Common.IGetMoreInfoResult>"))))}init(){v.AFrameworkApplication.fa.jf(()=>{this.BEa()})}BEa(){const t=Nf.a.Uu(A.a.instance.Ja("Common.INewAndOpenCommonHelpers")),P=Nf.a.Uu(A.a.instance.Ja("Common.IEventEmitter<Common.IGetMoreInfoResult>"));v.AFrameworkApplication.Iwa&&me.Task.WAA.call(null,t,P).continueWith(()=>
{const ia=new Nd(new Fc.a(()=>t.result),new Fc.a(()=>v.AFrameworkApplication.Aa.hb.A5d()),new Fc.a(()=>P.result),new Fc.a(()=>v.AFrameworkApplication.Aa.hb.B5d().lZb||"1959943459"),new Fc.a(()=>v.AFrameworkApplication.Iwa),new Fc.a(()=>v.AFrameworkApplication.EOj));ia.vb();ia.hnc()});if(v.AFrameworkApplication.ANe){const ia=Nf.a.Uu(A.a.instance.Ja("Common.IEventEmitter<Common.IMruResult>"));me.Task.WAA.call(null,t,P,ia).continueWith(()=>{const Aa=new wd(new Fc.a(()=>t.result),new Fc.a(()=>Xe.ivk),
new Fc.a(()=>v.AFrameworkApplication.Aa.hb.B5d()),new Fc.a(()=>v.AFrameworkApplication.hvk),new Fc.a(()=>v.AFrameworkApplication.gvk),new Fc.a(()=>P.result),new Fc.a(()=>ia.result),v.AFrameworkApplication.fa);Aa.pQk();Aa.Ifh()})}}dispose(){}}Object(k.a)(sf,"UXPackageManager",null,[2,3,106]);class tf extends ua.StandardDialog{constructor(){super();this.xd=0;this.Xe(1,CommonUIStrings.l_DialogClose)}nv(t){this.zy(t,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError,null)}SCa(t){this.zy(t,
CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError,null,!0)}}Object(k.a)(tf,"ErrorDialog",ua.StandardDialog,[856]);class Lf{qXf(){n.ULS.sendTraceTag(24134234,352,50,"Returning endpoint for ODC");const t=new Xf.a;t.Fg("api.onedrive.com");return t.task}}Object(k.a)(Lf,"OneDriveConsumerEndpointHelper",null,[793]);var kf=d(164);class Ed{constructor(t,P,ia,Aa){this.V3a=this.ina=null;this.nJd=this.pJd=!1;this.Iob=null;this.$a=t;this.mmb=P;this.v3a=ia;this.zA=Aa}get iuf(){return this.mmb}get fa(){return this.$a}uwb(){this.Iob||
(this.Iob=this.MGb?ce.a.create(this.MGb,null,null,null,!1):null);return this.Iob}setup(t){this.V3a=t;this.pJd||this.nJd?this.pJd&&this.V3a&&this.V3a(!0):(t=this.uwb())?(this.nJd=!0,t.JFa.continueWith(P=>{this.Lqk(P)}),Kc.a.Wx(t)):(n.ULS.sendTraceTag(20509837,352,15,"Failure with OneDrive API download as the onedrive url received is empty."),this.V3a(!1))}jGe(t){n.ULS.sendTraceTag(20509838,352,15,"Failure during OneDrive API download: {0}",t.Zi?t.Zi.toString():"No error detail.")}Lqk(t){this.nJd=!1;
if(t.rm)this.jGe(t),this.V3a(!1);else try{this.pJd=!0,n.ULS.sendTraceTag(17909022,352,50,"Initializing OneDrive API"),this.Gce(),n.ULS.sendTraceTag(17909023,352,50,"OneDrive API is initialized."),this.V3a(!0)}catch(P){n.ULS.sendTraceTag(20555412,352,10,"Failed during OneDrive API init: {0}",P.toString()),this.V3a(!1)}}grc(t){this.ina=t;this.v3a?n.ULS.sendTraceTag(23881878,216,50,"In limited edit mode, will not show Picker."):(n.ULS.sendTraceTag(23881877,216,50,"Not in limited edit mode, will show file picker."),
this.setup(Object(r.a)(this,this.EEe,"onApiReady")))}EEe(t){t?this.D0c():this.wt()}wt(){this.zA().nv(kf.a.Huk)}onSuccess(t){n.ULS.sendTraceTag(17909057,352,50,"Success Callback called. Calling callback function.");this.ina&&this.ina(!0,t)}dispose(){this.Iob&&this.Iob.dispose()}}Object(k.a)(Ed,"AOneDriveFilePickerApiManager",null,[888,106]);class Cd extends Ed{constructor(t,P,ia,Aa,Ka,pb){super(P,ia,Aa,pb);this.ol=null;this.Iba=t;this.E_h=Ka}get MGb(){return this.fa.Ha("OneDriveApiUrl")}start(t,P){this.ol=
t;this.grc(P)}Gce(){WL.init(1===this.iuf||2===this.iuf?{["client_id"]:this.fa.appSettings.UploadToSkyDriveClientId}:{["client_id"]:this.fa.appSettings.UploadToSkyDriveClientId,["env"]:"INT"})}grc(t){this.ina=t;!this.v3a&&this.Iba.ahe?(n.ULS.sendTraceTag(17909025,352,50,"User is signed in. We will show file picker."),this.setup(Object(r.a)(this,this.EEe,"onApiReady"))):(n.ULS.sendTraceTag(17909026,352,50,"User is not signed in. show need to sign in dialog."),this.E_h())}D0c(){try{n.ULS.sendTraceTag(17909027,
352,50,"Launching file dialogue"),WL.fileDialog(this.ol).then(Object(r.a)(this,this.onSuccess,"onSuccess"),Object(r.a)(this,this.oz,"onFailure"))}catch(t){n.ULS.sendTraceTag(17909056,352,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",t,t.stack),this.wt()}}oz(t){if(t&&t.error){if("user_canceled"===t.error.code){n.ULS.sendTraceTag(17909058,352,50,"User canceled.");return}n.ULS.sendTraceTag(17909059,352,50,"File Dialog returned with error code:{0}, and error message: {1}",t.error.code,t.error.message)}else n.ULS.sendTraceTag(17909060,
352,50,"File Dialog returned with no response");this.ina&&this.ina(!1,t);this.wt()}}Object(k.a)(Cd,"OneDriveFilePickerApiManagerV5",Ed,[]);class oh extends Ed{constructor(t,P,ia,Aa,Ka){super(t,P,ia,Aa);this.lyc=this.bif=null;this.$Ph=Ka;this.options={};this.options.clientId=this.fa.Ha("OneDriveApiV7ClientId");this.options.cancel=Object(r.a)(this,this.Yrd,"toggleHostDivVisibility")}get MGb(){return this.fa.Ha("OneDriveApiV72Url")}start(t,P){this.lyc=P;const ia=this.$Ph.qXf();ia.continueWith(()=>{n.ULS.sendTraceTag(24134241,
352,50,"Fetch endpoint task completed, attempting to start OneDrive picker");this.bif=ia.result;this.grc((Aa,Ka)=>{this.Yrd();t(Aa,Ka)})},3);ia.continueWith(()=>{n.ULS.sendTraceTag(24134242,352,15,ia.Zi.message);this.Yrd()},5)}Gce(){this.options.success=t=>{const P={};P.data=t;this.onSuccess(P)};this.options.error=t=>{const P={};P.error=t;this.oz(P)};this.options.advanced={};this.options.advanced.linkType="share";this.options.advanced.endpointHint=this.bif;this.options.advanced.iframeParentDiv=this.lyc}D0c(){try{n.ULS.sendTraceTag(22090007,
352,50,"Launching OneDrive file picker dialog"),this.Yrd(),OneDrive.open(this.options)}catch(t){n.ULS.sendTraceTag(22090008,352,10,"Opening OneDrive file picker threw an exception: {0}",t.message),this.wt()}}oz(t){this.ina&&this.ina(!1,t);this.wt()}Yrd(){this.lyc.style.visibility="hidden"===this.lyc.style.visibility?"":"hidden"}}Object(k.a)(oh,"OneDriveFilePickerApiManagerV7",Ed,[]);class Kg extends Ed{constructor(t,P,ia,Aa){super(t,P,ia,Aa);this.tMh=t;this.options={};this.options.advanced={};this.options.action=
"query";this.options.clientId=this.fa.Ha("OneDriveApiV72ClientId");this.options.advanced.trapFocus=!0}get MGb(){return this.fa.Ha("OneDriveApiV72Url")}start(t,P,ia,Aa){this.options.advanced.iframeParentDiv=ia;this.options.advanced.endpointHint=Aa;this.options.cancel=P;this.tMh.ka("OneDriveApiV72RecentsViewEnabled")&&(this.options.advanced.navigation={},this.options.advanced.navigation.entryLocation={},this.options.advanced.navigation.entryLocation.oneDrive={},this.options.advanced.navigation.entryLocation.oneDrive.recent=
{});this.grc(t)}grc(t){this.ina=t;this.v3a?n.ULS.sendTraceTag(24391838,216,50,"In limited edit mode, will not show Picker."):(n.ULS.sendTraceTag(24391837,216,50,"Not in limited edit mode, will show file picker."),this.setup(Object(r.a)(this,this.EEe,"onApiReady")))}Gce(){this.options.success=t=>{const P={};P.data=t;this.onSuccess(P)};this.options.error=t=>{const P={};P.error=t;this.oz(P)}}D0c(){try{n.ULS.sendTraceTag(23881879,216,50,"Launching OneDrive file picker dialog"),OneDrive.save(this.options)}catch(t){n.ULS.sendTraceTag(23881880,
216,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",t.message,t.stack),this.wt()}}jGe(t){n.ULS.sendTraceTag(25180160,216,15,"Failure during OneDrive API download: {0}",t.Zi?t.Zi.toString():"No error detail.");Kc.a.CSk(this.MGb);this.Iob=null}wt(){this.zA().SCa(kf.a.o0k)}oz(t){this.ina&&this.ina(!1,t)}}Object(k.a)(Kg,"OneDriveFilePickerApiManagerV72",Ed,[]);class ri{constructor(t){this.olsSessionId=this.value=this.key=null;this.olsSessionId=t}}Object(k.a)(ri,"IExtraData",null,
[]);class Af extends Kg{constructor(t,P,ia,Aa){super(t,P,ia,Aa);this.options.advanced.filter=t.Ha("OneDriveApiV72Filter")||"folder,photo";this.options.advanced.linkType="download";this.options.multiSelect=v.AFrameworkApplication.uuf;t.ka("OneDriveApiV72CommandModeEnabled")&&(this.options.commandMode=t.Ha("OneDriveApiV72CommandMode")||"none");t.ka("OneDriveApiV72QosExtraDataEnabled")&&(this.options.qosExtradata=new ri(v.AFrameworkApplication.userSessionId))}get MGb(){return this.fa.Ha("OneDriveApiV72Url")}D0c(){try{n.ULS.sendTraceTag(26071182,
352,50,"Launching OneDrive file picker dialog with filter: {0}, commandMode: {1}, QosExtraData: {2} officeSessionId: {3}",this.options.advanced.filter,this.options.commandMode,this.options.qosExtradata?this.options.qosExtradata.olsSessionId:"",v.AFrameworkApplication.userSessionId),OneDrive.open(this.options)}catch(t){n.ULS.sendTraceTag(26071183,352,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",t.message,t.stack),this.wt()}}}Object(k.a)(Af,"OneDriveFilePickerApiOpenManagerV72",
Kg,[]);class Zg{constructor(t){this.Vv=null;this.ei=t;this.iId=3}qXf(){this.Vv=new Xf.a;n.ULS.sendTraceTag(24134235,352,50,"Sending initial request for OneDrive for Business Endpoint");this.CSe();return this.Vv.task}CSe(t=null){const P=String.format("GetMoreInfoHandler.ashx?{0}",v.AFrameworkApplication.k7a);this.ei.YV(P,1,null,t,["PersonalFileStorageUrl","X-NewKey"],2,Object(r.a)(this,this.Tbj,"getMoreInfoSucceeded"),Object(r.a)(this,this.Rbj,"getMoreInfoFailed"),null,void 0,void 0,void 0,void 0,
"21")}Rbj(t){if(t.data.Te===Ue.a.Hlc&&"X-NewKey"in t.data.rj){n.ULS.sendTraceTag(24134236,352,50,"GetMoreInfo request failed due to bad canary. Updating with new canary and resending");const P={};P["X-Key"]=t.data.rj["X-NewKey"];this.CSe(P)}else 0<this.iId?(n.ULS.sendTraceTag(24134237,352,50,"GetMoreInfo request failed, attmepting again. {0} retries remaining",this.iId),this.iId--,this.CSe()):(n.ULS.sendTraceTag(24134238,352,50,"GetMoreInfo request failed, and no more retries remaining. Faulting task"),
this.Vv.setException(Error.create("GetMoreInfo request failed and no more retries remain")))}Tbj(t){"PersonalFileStorageUrl"in t.data.rj&&""!==t.data.rj.PersonalFileStorageUrl?(n.ULS.sendTraceTag(24134239,352,50,"Successfully received an ODB endpoint"),this.Vv.Fg(t.data.rj.PersonalFileStorageUrl)):(n.ULS.sendTraceTag(24134240,352,50,"GetMoreInfo request was successful but didn't return an ODB endpoint"),this.Vv.setException(Error.create("GetMoreInfo request succeeded but did not have ODB endpoint")))}}
Object(k.a)(Zg,"OneDriveForBusinessEndpointHelper",null,[793]);var gi=d(350);class jg{constructor(){this.Da=null}get name(){return"Common.App.OneDriveFilePickerApi"}init(){}dispose(){}$b(t){this.Da=t;this.Da.register(Cd,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV5").as("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager").ma().oa(()=>new Cd(gi.a.instance,v.AFrameworkApplication.fa,v.AFrameworkApplication.ARa,v.AFrameworkApplication.LQ,v.AFrameworkApplication.vvh,()=>
new tf));v.AFrameworkApplication.Czb?this.Da.register(793,"Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper").ma().oa(()=>new Lf):this.Da.register(793,"Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper").ma().oa(()=>new Zg(v.AFrameworkApplication.Je));this.Da.register(oh,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV7").ma().oa(()=>new oh(v.AFrameworkApplication.fa,v.AFrameworkApplication.ARa,v.AFrameworkApplication.LQ,()=>new tf,this.Da.resolve("Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper")));
this.Da.register(Kg,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72").ma().oa(()=>new Kg(v.AFrameworkApplication.fa,v.AFrameworkApplication.ARa,v.AFrameworkApplication.LQ,()=>new tf));this.Da.register(Af,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiOpenManagerV72").ma().oa(()=>new Af(v.AFrameworkApplication.fa,v.AFrameworkApplication.ARa,v.AFrameworkApplication.LQ,()=>new tf))}static main(){e.a.instance.Dc(new jg)}}Object(k.a)(jg,"PackageManager",null,[2,3]);var Hh=d(170),
hj=d(179);class Hk{constructor(t){this.Pbb=this.fye=this.jeb=this.J6c=0;this.Lwe=this.CGg=null;t?(this.zb=t,this.n1b=Date.now,this.wEi(),this.dQk()):n.ULS.sendTraceTag(520955213,209,10,"Can not initialize PenMinutesManager because TaskManager is null")}b8k(){this.CGg="Office.PowerPoint.Online.Data.Activity.PenInputMinutes"}dQk(){window.document.body.addEventListener("pointerenter",Object(r.a)(this,this.prk,"onPointerEnter"));window.document.body.addEventListener("pointerleave",Object(r.a)(this,this.qrk,
"onPointerLeave"));A.a.instance.Ja("Common.App.VisibilityManagement.IVisibilityManager").execute(t=>{t.TFc(Object(r.a)(this,this.P6b,"handleVisibilityChange"))})}prk(t){"pen"!==t.pointerType||this.jeb||(this.jeb=Math.floor(this.n1b()/1E3),this.jeb<=this.J6c&&(this.jeb=this.J6c),this.fye=0)}qrk(){this.J8f()}J8f(){const t=Math.ceil(this.n1b()/1E3);this.jeb&&t>this.J6c&&(this.fye=t,this.Pbb+=this.fye-this.jeb);this.J6c=t;this.jeb=0}P6b(t,P){0!==P.newState&&this.J8f()}wEi(){this.Lwe=new D.a(4,2,6E4,Object(r.a)(this,
this.L1j,"logPenUsage"));this.zb.Eb(this.Lwe)}L1j(){0<this.Pbb&&this.koh(this.Pbb);this.Pbb=0}koh(t){const P=new hj.a;P.name=this.CGg;const ia=[];(t=Hh.a.t8("PenInputSec",t.toString(),3))&&Array.add(ia,t);P.dataFields=ia;w.a.sendActivityEvent(P)}dispose(){0<this.Pbb&&this.koh(this.Pbb);this.zb.Rg(this.Lwe)}}Object(k.a)(Hk,"PenMinutesManager",null,[792]);class yd{constructor(){this.PGd=this.Da=null}get name(){return"Common.App.PenMinutesManager"}$b(t){this.Da=t;const P=v.AFrameworkApplication.we;this.Da.register(792,
"Common.App.PenMinutesManager.IPenMinutesManager").ma().oa(()=>new Hk(P))}init(){this.PGd=this.Da.resolve("Common.App.PenMinutesManager.IPenMinutesManager")}dispose(){this.PGd&&this.PGd.dispose()}static main(){e.a.instance.Dc(new yd)}}Object(k.a)(yd,"PenMinutesManagerPackage",null,[2,3]);class ef extends ua.StandardDialog{constructor(t,P){super();this.Kob=!1;this.pK=null;this.Ca=t;this.xRb=P;this.e0a=!1}nv(t,P,ia){this.pK=P;this.Kob=ia;n.ULS.sendTraceTag(8194008,216,50,"Display error with code:{0}, overwriteTarget:{1}.",
t,ia);t=this.sTd(t);0===t?(this.xd=6,this.Xe(0,CommonUIStrings.l_DialogClose)):(this.xd=0,this.Xe(1,CommonUIStrings.l_DialogClose));0===t&&n.ULS.sendTraceTag(8194009,216,50,"Show standard error dialog.");this.zy(kf.a.n0k,this.R6i(t),this.Q6i(t,P),Object(r.a)(this,this.SQe,"retryDialogHandler"),!0)}SQe(t){1===t?(n.ULS.sendTraceTag(8194010,216,50,"User click to retry button in error dialog."),this.pK?this.Ca.La(E.a.gKb,2,[this.pK,this.Kob]):this.Ca.processAction(E.a.gKb,2)):n.ULS.sendTraceTag(8194011,
216,50,"User cancel the error dialog.")}sTd(t){return 0>t||6<t?(n.ULS.sendTraceTag(8194012,216,15,"Unexpected error code {0}.",t),0):t}Q6i(t,P){t=this.sTd(t);return this.xRb?[CommonUIStrings.l_FailToSaveFile,CommonUIStrings.l_InvalidFileNameAllowPercentOctothorpe,CommonUIStrings.l_EmptyNameText,CommonUIStrings.l_InvalidPermissionText,String.format(CommonUIStrings.l_OverwriteTargetText,P),CommonUIStrings.l_LockTargetText,CommonUIStrings.l_InvalidFileNameDisallowPercentOctothorpe][t]:[CommonUIStrings.l_FailToSaveFile,
CommonUIStrings.l_InvalidFileNameText,CommonUIStrings.l_EmptyNameText,CommonUIStrings.l_InvalidPermissionText,String.format(CommonUIStrings.l_OverwriteTargetText,P),CommonUIStrings.l_LockTargetText,CommonUIStrings.l_InvalidFileNameText][t]}R6i(t){t=this.sTd(t);return[CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_InvalidFileNameTitle,CommonUIStrings.l_EmptyNameTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_InvalidFileNameTitle][t]}}
Object(k.a)(ef,"ErrorRetryDialog",ua.StandardDialog,[896]);class yh{constructor(t,P){this.$a=t;this.Ca=P;this.xRb=this.$a.ka("SaveToHostWithExtraCharsInFileName")}create(){return new ef(this.Ca,this.xRb)}}Object(k.a)(yh,"ErrorRetryDialogFactory",null,[858]);class Bg extends cd.a{constructor(t,P,ia,Aa,Ka,pb,Nb=null){super();this.zV=null;this.Ca=P;this.Xaa=Aa;this.lBa=pb;this.$a=t;this.zA=Ka;this.Rh=ia;this.xRb=this.$a.ka("SaveToHostWithExtraCharsInFileName");this.ol=Nb;this.Xe(1,CommonUIStrings.l_SaveButtonLabel)}get Aa(){return this.Rh}FMf(t,
P){this.cD(1,!!t&&t!==P);this.zV=document.getElementById(Bg.iTf);nd.a.addHandler(this.zV,"change",Object(r.a)(this,this.Mdd,"onFileNameChange"));nd.a.addHandler(this.zV,"input",Object(r.a)(this,this.Mdd,"onFileNameChange"));this.zV.focus()}hTf(t){return this.xRb?(new RegExp("["+this.TQf('\\/:*?"<>|')+"]")).test(t):(new RegExp("["+this.TQf('\\/:*?"<>|#{}%~&')+"]")).test(t)}TQf(t){return t.replace(RegExp("[.*+?|()\\[\\]{}\\\\]","g"),"\\\\$&")}G$d(){const t=ab.a.TG(v.AFrameworkApplication.xu.Uw);this.cD(1,
!!this.zV&&""!==this.zV.value&&this.zV.value!==t)}Mdd(){this.zV&&window.setTimeout(()=>{this.G$d()},0)}LOc(t,P){if(1!==t)n.ULS.sendTraceTag(23881882,216,50,"User click cancel to cancel upload file in file name dialog.");else{t=P[Bg.iTf];P=Bg.S7g in P?P[Bg.S7g]:!1;n.ULS.sendTraceTag(23881883,216,50,"User click save to upload file with new name {0} and overwrite the target {1}.",ab.a.xfh(t),P);const ia=ab.a.bT(v.AFrameworkApplication.fileName);(t=t?t.trim():null)&&""!==t&&""!==ia||1===this.Aa.state?
this.hTf(t)?this.zA.create().nv(1,t,P):this.lBa.s1(t+ia,P,this.ol):this.zA.create().nv(2,t,P)}}dispose(){this.zV&&(nd.a.removeHandler(this.zV,"change",Object(r.a)(this,this.Mdd,"onFileNameChange")),nd.a.removeHandler(this.zV,"input",Object(r.a)(this,this.Mdd,"onFileNameChange")),this.zV=null);super.dispose()}}Bg.iTf="txtFileName";Bg.S7g="chkOverwrite";Object(k.a)(Bg,"FileNameDialogBase",cd.a,[]);class Kd{static get qg(){return cd.a.gC(Kd.ro,CommonUIStrings.l_SaveACopyFileName,CommonUIStrings.l_SaveAsToHostOverwrite)}}
Kd.ro="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='OverwriteBlock'> <span id='OverwriteBlockSpan' class='WACDialogSpan'><input type='checkbox' id='chkOverwrite' class='WACDialogCheckBox'></input> <label id='lbcOverwrite' class='\"WACDialogInlineLabel\"' for='chkOverwrite'>{1}</label></span> </div>";
Object(k.a)(Kd,"FileNameDialogHtml",null,[]);class Rj extends Bg{constructor(t,P,ia,Aa,Ka,pb){super(t,P,ia,Aa,Ka,pb);this.qg=Kd.qg;this.ig="FileNameDialog-SaveAsToHost"}mja(t,P){const ia=ab.a.TG(v.AFrameworkApplication.xu.Uw);P={["txtFileName"]:t||ia,["lblFolderName"]:CommonUIStrings.l_ToCurrentFolder,["chkOverwrite"]:P};this.$i(CommonUIStrings.L_SaveAs,Object(r.a)(this,this.LOc,"fileNameDialogHandler"),P);this.FMf(t,ia)}}Object(k.a)(Rj,"FileNameDialog",Bg,[895]);class Ia{constructor(t,P,ia,Aa,Ka,
pb){this.Ca=P;this.$a=t;this.Xaa=Aa;this.lBa=pb;this.zA=Ka;this.Rh=ia}create(){return new Rj(this.$a,this.Ca,this.Rh,this.Xaa,this.zA,this.lBa)}}Object(k.a)(Ia,"FileNameDialogFactory",null,[857]);class nb{constructor(t,P,ia){this.lBa=ia;this.Pzd=P;this.$a=t}vb(){2===v.AFrameworkApplication.Aa.hb.Vk?v.AFrameworkApplication.Ta.ra(E.a.gKb,u.a.frame,Object(r.a)(this,this.Fmh,"saveAsToHostActionDispatcher"),4):v.AFrameworkApplication.Ta.ya(E.a.gKb,u.a.frame,Object(r.a)(this,this.Fmh,"saveAsToHostActionDispatcher"))}Fmh(t,
P,ia,Aa,Ka){return P.contextId!==u.a.frame||t!==E.a.gKb?2:this.$a.ka("SaveAsToHostBrsIsEnabled")?1===ia?C.SessionStatusManager.instance.eka||v.AFrameworkApplication.GQ?8:32:2===ia?(n.ULS.sendTraceTag(8194015,216,50,"User clicked on SaveAsToHost button from the backstage."),t=this.Pzd.create(),Ka&&Object.getType(Ka)===Array&&2===Ka.length?t.mja(Ka[0],!!Ka[1]):t.mja(null,!1),32):8:8}}Object(k.a)(nb,"SaveAsToHostActor",null,[]);class Kb{constructor(t,P,ia,Aa,Ka,pb,Nb,kc){this.Ln=null;this.Kob=this.e2=
!1;this.kBa=this.ol=this.pK=null;this.$a=P;this.pBa=this.$a.appSettings.SaveAsToHostWebServiceBase;this.scf=Aa;this.kqa=Ka;this.ei=ia;this.zA=pb;this.Xh=kc;this.Rh=Nb;this.Ca=t;this.fAa=P.Ha("SaveAsToHostUploadHandler")||"hostuploadhandler.ashx"}Lqc(){1!==this.Rh.state&&(this.Ln=this.kqa(),this.Ln.message=CommonUIStrings.l_CommentProgressTooltip,this.Ln.xd=5,this.Ln.yr=!1,this.Ln.Boa(CommonUIStrings.l_DefaultDialogTitle,null,null))}OY(t=0){1!==this.Rh.state&&this.zA.create().nv(t,ab.a.TG(this.pK),
this.Kob)}Thb(){const t=this.$a.appSettings.BreadcrumbFolderUrl;n.ULS.sendTraceTag(8194016,216,50,"Redirecting to OneDrive for business Folder.");Ze.a.un(t,Ze.a.Raa(3),void 0,"UploadToHostManager.RedirectToFolder")}Shb(t){let P=!1,ia=!1;this.$a&&(P=this.$a.ka("SaveACopyIsEnabledForUiHost"),ia=this.$a.ka("UiHostSupportsDocRebootFeatures"));n.ULS.sendTraceTag(8194017,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1} uiHostSupportsFeature {2}",t,P,ia);if(P&&ia){n.ULS.sendTraceTag(51245197,
216,50,"UploadToHostManager.RedirectToEditUrl: Sending DocumentRefresh post message.");const Aa={};Aa[Mc.a.cJb]="1";Aa[Mc.a.documentUrl]=t;Aa[Mc.a.reason]=dd.a.HRe;v.AFrameworkApplication.gT().execute(Ka=>{Ka.sendMessage(ed.a.VCa,Aa)})}else P&&!ia&&v.AFrameworkApplication.iua?Ze.a.un(t,Ze.a.Raa(4),void 0,"UploadToHostManager.RedirectToEditUrl"):Ze.a.un(t,Ze.a.Raa(3),void 0,"UploadToHostManager.RedirectToEditUrl")}s1(t,P,ia=null){n.ULS.sendTraceTag(8194018,216,50,"Starting to upload file");this.scf&&
!this.scf()&&this.ei&&(this.Xh&&(this.kBa=this.Xh.Ci("DialogShown","SaveAsToHostUploadTime")),this.Lqc(),this.Kob=P,this.pK=t,(this.ol=ia)&&"true"===this.ol.SkipSaveToHost?this.fOc():this.f3())}f3(){32!==this.Ca.processAction(E.a.l_a,1)?(n.ULS.sendTraceTag(18989378,219,15,"The save file change is not supported, this operation may exist data losting."),this.fOc()):this.Ca.La(E.a.l_a,2,[()=>{n.ULS.sendTraceTag(18989379,219,50,"Call the force save file change successfully.");this.fOc()},(t,P)=>{n.ULS.sendTraceTag(18989380,
219,15,"The file change is not saved successfully, this operation may lead to data loss.");this.OY(P)}])}puk(t){this.C7a();this.e2=!1;if(t&&t.data&&t.data.Zd)if(({kv:P}=fe.d(t.data.Zd)).returnValue)if(t=P,t.StatusCode!==Ue.a.Ey&&t.StatusCode!==Ue.a.T0b){n.ULS.sendTraceTag(8194049,216,10,"UploadToHostManager failure. Response data is not JSON.");var P={};P.FailureReason=t.StatusCode.toString();P.ExtraInfo=t.ExtraInfo;this.Oxa(P);this.OY(parseInt(t.ExtraInfo))}else{n.ULS.sendTraceTag(8194050,216,50,
"UploadToHost execute success.");this.cQe();try{t.NewDocumentUrl&&""!==t.NewDocumentUrl?this.Shb(t.NewDocumentUrl):this.Thb()}catch(ia){n.ULS.sendTraceTag(37025699,216,15,"Redirect failed with exception: {0}",ia.toString())}this.Mkc()}else n.ULS.sendTraceTag(8194048,216,10,"Failed to deserialize : {0}",{["ResponseData"]:rd.a.btc(t.data.Zd)}),this.Oxa({["FailureReason"]:"Failed to deserialize response"}),this.OY();else n.ULS.sendTraceTag(8194019,216,10,"UploadToHostManager failure. Response data is null"),
this.Oxa({["FailureReason"]:"null response"}),this.OY()}ouk(t){5!==t.data.status&&12!==t.data.status||this.e2?(n.ULS.sendTraceTag(8194052,216,10,"UploadToHostManager HTTP failure with code: {0}",{["Status"]:t.data.status,["HttpStatus"]:t.data.Te}),this.Oxa({["FailureReason"]:t.data.Te.toString()}),this.C7a(),this.OY(),this.Mkc()):(n.ULS.sendTraceTag(8194051,216,10,"UploadToHostManager failure. Retry automatically."),this.e2=!0,this.ol&&"true"===this.ol.SkipSaveToHost?this.fOc():this.f3())}C7a(){this.Ln&&
(this.Ln.close(),this.Ln=null)}Mkc(){this.kBa&&(this.kBa.stop(),this.kBa=null)}cQe(){this.ol&&"VersionHistory"===this.ol.SaveEntryPoint&&this.Ca.processAction(E.a.Hkd,2)}Oxa(t){this.ol&&"VersionHistory"===this.ol.SaveEntryPoint&&this.Ca.La(E.a.dQe,2,t)}fOc(){let t=this.pBa+this.fAa;t=db.a.Wi(t,"qs",ab.a.Ke(v.AFrameworkApplication.jh));t=db.a.Wi(t,"n",ab.a.Ke((new Date).getTime().toString()));t=db.a.Wi(t,"ov",ab.a.Ke(this.Kob.toString()));t=db.a.Wi(t,"fn",ab.a.Ke(this.pK));this.ol&&this.ol.FileDownloadUrl&&
(t=db.a.Wi(t,"furl",ab.a.Ke(this.ol.FileDownloadUrl)));this.ei.Aj(t,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,Object(r.a)(this,this.puk,"onUploadFinished"),Object(r.a)(this,this.ouk,"onUploadFailed"),null,void 0,void 0,void 0,void 0,"1")}}Object(k.a)(Kb,"UploadToHostManager",null,[820]);var dc=d(548);class Ic{constructor(){this.Da=null}get name(){return"Common.App.SaveAsToHost"}init(){v.AFrameworkApplication.fa.jf(Object(r.a)(this,this.Om,"onFullAppSettingsReady"))}Om(){v.AFrameworkApplication.fa.ka("SaveAsToHostBrsIsEnabled")&&
this.Da.resolve("Common.App.SaveAsToHost.SaveAsToHostActor").vb()}$b(t){this.Da=t;this.Da.register(yh,"Common.App.SaveAsToHost.ErrorRetryDialogFactory").as("Common.App.SaveAsToHost.IErrorRetryDialogFactory").oa(()=>new yh(v.AFrameworkApplication.fa,v.AFrameworkApplication.Ta)).ma();this.Da.register(Kb,"Common.App.SaveAsToHost.UploadToHostManager").as("Common.App.SaveAsToHost.IUploadToHostManager").oa(()=>new Kb(v.AFrameworkApplication.Ta,v.AFrameworkApplication.fa,v.AFrameworkApplication.Je,()=>v.AFrameworkApplication.Tg,
()=>(new dc.a).create(),t.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),v.AFrameworkApplication.Aa,v.AFrameworkApplication.Aa.gV)).ma();this.Da.register(Ia,"Common.App.SaveAsToHost.FileNameDialogFactory").as("Common.App.SaveAsToHost.IFileNameDialogFactory").oa(()=>new Ia(v.AFrameworkApplication.fa,v.AFrameworkApplication.Ta,v.AFrameworkApplication.Aa,v.AFrameworkApplication.Aa.hb,t.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),t.resolve("Common.App.SaveAsToHost.UploadToHostManager"))).ma();
this.Da.register(nb,"Common.App.SaveAsToHost.SaveAsToHostActor").oa(()=>new nb(v.AFrameworkApplication.fa,t.resolve("Common.App.SaveAsToHost.FileNameDialogFactory"),t.resolve("Common.App.SaveAsToHost.UploadToHostManager"))).ma()}dispose(){}static main(){e.a.instance.Dc(new Ic)}}Object(k.a)(Ic,"SaveAsToHostPackage",null,[2,3]);class Id extends ua.StandardDialog{constructor(){super();this.xd=0;this.Xe(1,CommonUIStrings.l_DialogClose)}nv(t,P){this.aNf(t,P,kf.a.p0k)}aNf(t,P,ia){n.ULS.sendTraceTag(25180161,
216,10,"Show upload error dialog with error code {0}.",ia);this.zy(ia,t,P,null)}SCa(t,P){n.ULS.sendTraceTag(25235986,216,15,"Show warning dialog of Picker related issue.");this.zy(kf.a.r0k,t,P,null,!0)}}Object(k.a)(Id,"ErrorDialog",ua.StandardDialog,[866]);class ae{static get qg(){return cd.a.gC(ae.ro,CommonUIStrings.l_FileNameLabel,CommonUIStrings.l_NewFileLocationLabel,CommonUIStrings.l_CurrentOnlineFolder,"")}}ae.ro="<div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='DocumentLocationBlock'> <label id='locationName' class='WACDialogLabel' for='locationName' >{1}</label> <div class='FolderLocationDiv' id='folderLocation'> <label id='currentLocation' class='WACDialogLabel' for='currentLocation' >{2}</label> <span id='anotherFolder' class='WACDialogSpan'>{3}</span> </div> </div>";
Object(k.a)(ae,"FileNameDialogHtml",null,[]);class Od extends Bg{constructor(t,P,ia,Aa,Ka,pb,Nb,kc){super(t,P,ia,Aa,Ka,pb,kc);this.rNa=this.NId=this.gI=null;this.Kki=CommonUIStrings.l_SaveToAnotherFolder;this.qg=ae.qg;this.ig="FileNameDialog-SaveToSharePoint";this.FVb=Nb;this.LWh=kc}mja(t){const P=ab.a.TG(v.AFrameworkApplication.xu.Uw),ia=v.AFrameworkApplication.breadcrumbFolderName,Aa=v.AFrameworkApplication.breadcrumbBrandName,Ka={["txtFileName"]:t||P};let pb=CommonUIStrings.L_SaveAs;2===v.AFrameworkApplication.Aa.hb.Vk&&
(pb=CommonUIStrings.L_SaveACopy);this.$i(pb,Object(r.a)(this,this.LOc,"fileNameDialogHandler"),Ka);this.FMf(t,P);this.bZd.style.width="450px";Sys.UI.DomElement.addCssClass(document.getElementById("DocumentLocationBlock"),"SaveAsDialogRow");v.AFrameworkApplication.fa.ka("HideSaveToAnotherFolderButtonforUIHost")||(this.gI=document.getElementById("anotherFolder"),t=document.getElementById("folderLocation"),this.NId=pa.a.xuf(t,this.gI,"anotherFolderDescribedBy",""),this.gI.className="WACButton WACDialogButtonNormal",
t=!1,ia&&ia.length?(this.Ypf(this.gI,this.NId,String.format(CommonUIStrings.l_ScreenReader_CurrentFileLocation,Aa,ia)),t=this.J3h(Aa,ia)):this.Ypf(this.gI,this.NId,CommonUIStrings.l_CurrentOnlineFolder),this.e5h(this.gI),this.L3h(this.gI),t?(document.getElementById("currentLocation").style.width="100%",Sys.UI.DomElement.addCssClass(this.gI,"SaveToAnotherLocationTwo"),n.ULS.sendTraceTag(24459297,216,50,"Move save to another folder button to second line.")):Sys.UI.DomElement.addCssClass(this.gI,"SaveToAnotherLocationOne"),
nd.a.addHandler(this.gI,oa.a.click,Object(r.a)(this,this.QGe,"onSaveToAnotherLocationClick")),nd.a.addHandler(this.gI,oa.a.Zf,Object(r.a)(this,this.m5g,"onSaveToAnotherLocationKeyDown")))}J3h(t,P){let ia;ia=!1;const Aa=document.getElementById("currentLocation");Aa.innerText="";const Ka=this.N1f(Aa,t),pb=this.N1f(Aa,P);let Nb=255,kc=255;255<Ka+pb&&(Nb=Math.max(238,408-Ka),kc=Math.max(170,408-pb),ia=!0);this.D6h(Aa,t,kc,P,Nb);return ia}N1f(t,P){const ia=document.createElement("div");ia.innerText=P;
ia.style.visibility="hidden";t.appendChild(ia);P=ia.clientWidth;t.removeChild(ia);return P}D6h(t,P,ia,Aa,Ka){P&&(this.Xpf(t,P,ia),this.r6h(t));Aa&&this.Xpf(t,Aa,Ka)}Xpf(t,P,ia){const Aa=document.createElement("div");Aa.innerText=P;Aa.title=P;Aa.className="SaveToAnotherFolderBreadcrumb";Aa.style.maxWidth=ia.toString()+"px";t.appendChild(Aa)}r6h(t){const P=document.createElement("span");P.id="FolderSeparator";const ia=document.createElementNS("http://www.w3.org/2000/svg","svg");ia.setAttribute("class",
"SeparatorCaret");const Aa=document.createElementNS("http://www.w3.org/2000/svg","polygon");Aa.setAttribute("points","1 4 1 11 5 7.5");ia.appendChild(Aa);P.appendChild(ia);t.appendChild(P)}Ypf(t,P,ia){ia=String.format(CommonUIStrings.l_ScreenReader_SaveToAnotherFolderButton,ia);P&&(P.innerText=ia);t.tabIndex=0;t.setAttribute(pa.a.af,pa.a.ru)}L3h(t){const P=document.createElement("span");P.id="anotherFolderText";P.innerText=this.Kki;P.className="AnotherFolderTextSpan";t.appendChild(P)}e5h(t){const P=
document.createElement("span");P.className="cui-img-cont-float cui-img-16by16 ";this.rNa=document.createElementNS("http://www.w3.org/2000/svg","svg");this.rNa.setAttribute("class","FolderIconSVG");const ia=document.createElementNS("http://www.w3.org/2000/svg","path");ia.setAttribute("d","M0,14V4L1.25,3h6.5L9.606,1H13.25L14,2V6h1.5L16,7.25,14.25,14H0ZM13,6V2H10L8.25,4,1.957,3.914,1,4.75V12L3.25,6.75l1-.75H13Z");this.rNa.appendChild(ia);P.appendChild(this.rNa);t.appendChild(P)}m5g(t){!t||t.keyCode!==
wa.a.tq&&t.keyCode!==wa.a.QOb||this.QGe(t)}QGe(){if(this.zV){const t=ab.a.bT(v.AFrameworkApplication.fileName);let P=this.zV.value;this.hide();P&&""!==P&&""!==t||1===this.Aa.state?(""!==t&&(P+=t),this.hTf(P)?this.zA.create().nv(1,P,!1):this.FVb.start(P,this.LWh)):this.zA.create().nv(2,P,!1)}}xpi(t){this.gI&&this.rNa&&(t?(this.gI.tabIndex=0,Sys.UI.DomElement.removeCssClass(this.gI,"DisabledSaveAsButton"),Sys.UI.DomElement.removeCssClass(this.rNa,"DisabledFolderIconSVG")):(this.gI.tabIndex=-1,Sys.UI.DomElement.containsCssClass(this.gI,
"DisabledSaveAsButton")||Sys.UI.DomElement.containsCssClass(this.rNa,"DisabledFolderIconSVG")||(Sys.UI.DomElement.addCssClass(this.gI,"DisabledSaveAsButton"),Sys.UI.DomElement.addCssClass(this.rNa,"DisabledFolderIconSVG"))))}G$d(){super.G$d();this.xpi(!!this.zV&&""!==this.zV.value)}dispose(){this.gI&&(nd.a.removeHandler(this.gI,oa.a.click,Object(r.a)(this,this.QGe,"onSaveToAnotherLocationClick")),nd.a.removeHandler(this.gI,oa.a.Zf,Object(r.a)(this,this.m5g,"onSaveToAnotherLocationKeyDown")),this.gI=
null);super.dispose()}}Object(k.a)(Od,"FileNameDialog",Bg,[899]);var Hd=d(1187),Bf=d(1188),Of=d(911),ph=d(219);class Qh{constructor(){this.extension=this.fileName=null;this.enableMoreLocations=!1;this.saveLocations=this.scenario=null}}Object(k.a)(Qh,"SaveAsDialogInput",null,[]);class Lg{constructor(){this.properties=this.friendlyPath=this.folderName=null}}Object(k.a)(Lg,"SaveLocation",null,[]);var Fg=d(87);class dg{constructor(t,P,ia,Aa,Ka,pb,Nb,kc,Rc){this.bEd=null;this.pK="";this.FVb=t;this.zA=
P;this.ol=Rc;this.lBa=ia;this.Rh=Ka;this.cF=Aa;this.l5a=Nb;this.wpb=kc;pb&&(this.bEd=new Fc.a(()=>new vf.a(pb.value,null)))}W5i(){const t=new Hd.a(Bf.a.jp());t.$("type","currentHost");return Object.assign(new Lg,{folderName:this.cF.breadcrumbFolderName,friendlyPath:this.cF.breadcrumbBrandName,properties:t})}LSj(t){return!!t&&"ClassicMru"===t.type&&!!t.service_info&&!!t.service_info.service_id&&-1!==t.service_info.service_id.indexOf("SHAREPOINT")}dij(){if(!this.bEd||!this.l5a)return null;var t=this.bEd.value.Yca("SaveAsToSharePointDialog",
!1);if(!t||3!==t.state||!t.zZg)return null;t=t.zZg;const P=new ha.a;let ia=0,Aa=0;for(var Ka=0;Ka<t.length;Ka++){var pb=t[Ka];if(!this.LSj(pb))continue;ia++;if(!pb.sharepoint_info)continue;const Nb=pb.url,kc=pb.sharepoint_info.site_url,Rc=pb.title;pb=Of.b(pb,v.AFrameworkApplication.isRtl);if(!(Nb&&kc&&Rc&&pb))continue;Aa++;const Yc=new Hd.a(Bf.a.jp());Yc.$("type","SharePoint");Yc.$("siteUrl",kc);Yc.$("folderUrl",Nb);Aa++;P.add(Object.assign(new Lg,{folderName:Rc,friendlyPath:pb,properties:Yc}))}Ka=
new Map;Ka.set("NumPlaces",t.length.toString());Ka.set("NumSharepointPlaces",ia.toString());Ka.set("placesWithMetadata",Aa.toString());Vb.Health.instance.recordKpiUsage("SharePointSaveAsDialogMru",0,"smartfio",Ka);0<ia&&(Aa?.5>1*Aa/ia&&Vb.Health.instance.recordKpiFailure("SharePointSaveAsDialogMru","PartialPlacesMetadataMissing",!1,!1,null):Vb.Health.instance.recordKpiFailure("SharePointSaveAsDialogMru","AllPlacesMetadataMissing",!1,!1,null));return P}P6i(){const t=new ha.a;t.add(this.W5i());const P=
this.dij();P&&t.addRange(P);return Object.assign(new Qh,{enableMoreLocations:!v.AFrameworkApplication.fa.ka("HideSaveToAnotherFolderButtonforUIHost"),fileName:this.pK,extension:ab.a.bT(this.cF.Uw),saveLocations:t.toArray(),scenario:"SaveToSharePoint"})}nRc(){const t=Object(r.a)(this,this.P6i,"getDialogInput"),P={};P.inputPropsCallback=t;return P}mja(t){this.pK=t;this.pK||(this.pK=String.format(CommonUIStrings.l_SaveACopy_Filename,ab.a.TG(this.cF.Uw)));t={["id"]:"SaveAsDialog",["bodyControls"]:this.nRc()};
let P=CommonUIStrings.L_SaveAs;2===this.Rh.hb.Vk&&(P=CommonUIStrings.L_SaveACopy);const ia=new cd.a(!1,!1,!0);ia.xd=1;ia.ig="SaveAsDialog";ia.Xe(1,CommonUIStrings.l_SaveButtonLabel);ia.$i(P,Object(r.a)(this,this.l0k,"saveAsDialogHandler"),t)}zgl(t,P){t&&""!==t&&""!==P||1===this.Rh.state?this.KSj()?this.HZj(t,P):(""!==P&&(t+=P),this.FVb.start(t,this.ol)):(n.ULS.sendTraceTag(579179796,216,10,"filename is empty but dialog should have handled this error case"),this.zA.create().nv(2,t,!1))}HZj(t,P){Vb.Health.instance.recordKpiUsage("SaveACopySFP",
0,"smartfio",null);const ia=this.wpb.sWd(CommonUIStrings.l_PickerSaveACopyOkButton,CommonUIStrings.l_PickerSaveACopyTitle,!1,!0,!1,null,"SaveACopy",2);this.wpb.C5d(ia).then(Aa=>{if(Aa&&0<Aa.length){const Ka=Aa[0][Mc.a.Jzk];Aa=Aa[0][Mc.a.SIe];if(""!==Ka&&""!==Aa)this.l5a.s1(Aa,t+P,Ka,this.ol),Vb.Health.instance.recordKpiSuccess("SaveACopySFP",null);else{this.zA.create().nv(0,t,!1);const pb=ph.a.Lz();pb&&(pb.set("SiteUrlAvailable",""===Ka?"false":"true"),pb.set("FolderUrlAvailable",""===Aa?"false":
"true"));Vb.Health.instance.recordKpiFailure("SaveACopySFP","Not all values Available to start upload",!1,!1,Object.assign(new Fg.a,{extendedProperties:pb}))}}else this.zA.create().nv(0,t,!1),Vb.Health.instance.recordKpiFailure("SaveACopySFP","Picker Data is unavaliable",!1,!1,null)}).catch(Aa=>{"Canceled"===Aa?((Aa=ph.a.Lz())&&Aa.set("IsCanceled","true"),Vb.Health.instance.recordKpiSuccess("SaveACopySFP",Object.assign(new Fg.a,{extendedProperties:Aa}))):Vb.Health.instance.recordKpiFailure("SaveACopySFP",
Aa,!1,!1,null)})}KSj(){return this.wpb?this.wpb.oke():(n.ULS.sendTraceTag(572343636,216,50,"_sharedFilePickerManager is null"),!1)}l0k(t,P){if(P&&1===t){t=P.fileName;var ia=ab.a.bT(this.cF.Uw);P.moreLocationsSelected&&this.zgl(t,ia);if(P.locationCallback){var Aa=P.locationCallback();Aa?Aa.properties&&"currentHost"===Aa.properties.ga("type")?this.lBa.s1(t+ia,!1,this.ol):Aa.properties&&"SharePoint"===Aa.properties.ga("type")?(P=Aa.properties.ga("siteUrl"),Aa=Aa.properties.ga("folderUrl"),this.l5a.s1(Aa,
t+ia,P,this.ol)):n.ULS.sendTraceTag(579179799,216,10,"unknown location type sent back"):n.ULS.sendTraceTag(579179798,216,10,"selected location is empty")}else n.ULS.sendTraceTag(579179797,216,10,"locationCallback is empty")}}}Object(k.a)(dg,"ReactSaveAsDialog",null,[899]);class hi{constructor(t,P,ia,Aa,Ka,pb,Nb,kc=null,Rc=null,Yc=null){this.Ca=P;this.$a=t;this.Xaa=Aa;this.lBa=pb;this.zA=Ka;this.Rh=ia;this.ulf=Nb;this.DUh=kc;this.l5a=Rc;this.wpb=Yc}create(t){return this.Rh&&this.Rh.hb.uC?new dg(this.ulf,
this.zA,this.lBa,v.AFrameworkApplication.xu,this.Rh,this.DUh,this.l5a,this.wpb,t):new Od(this.$a,this.Ca,this.Rh,this.Xaa,this.zA,this.lBa,this.ulf,t)}}Object(k.a)(hi,"FileNameDialogFactory",null,[864]);class Mg{constructor(t,P,ia,Aa){this.io=this.Cha=null;this.D2a=t;this.Rh=ia;this.uXh=Aa;this.fha=new Fc.a(()=>new vf.a(P.value,Object(r.a)(this,this.TDa,"getMoreInfoEventReceived")))}get NGb(){this.Cha||(this.fha.value.Yca("Save As",!0),this.io&&this.io.vR&&this.io.vR.length&&(this.Cha=this.t7d(this.io.vR)));
return this.Cha}start(t){if(!this.NGb)if(v.AFrameworkApplication.breadcrumbFolderUrl&&v.AFrameworkApplication.breadcrumbFolderUrl.length)this.Cha=v.AFrameworkApplication.breadcrumbFolderUrl;else return n.ULS.sendTraceTag(23881884,216,10,"CachedGetMoreInfoResult is null, can't get OneDrive for Bussiness page url. BreadcrumbFolderUrl is null. Get more info result is null: ",!this.io),!1;const P=this.uXh();P.SWe();const ia=P.N7d();if(!ia)return n.ULS.sendTraceTag(24664067,216,10,"Picker container is null, will not show picker."),
!1;this.D2a.start((Aa,Ka)=>{P.hide();t(Aa,Ka)},()=>{this.dFe(P)},ia,this.Cha);return!0}dFe(t){t.hide();n.ULS.sendTraceTag(24664068,216,50,"User cancelled save to another folder.")}t7d(t){t=t.toLowerCase();t.endsWith("/")||(t+="/");const P=t.indexOf("/documents/");return-1!==P?t.substring(0,P+1)+"_layouts/15/onedrive.aspx":""}TDa(t){this.io||3!==t.state||(this.io=t)}}Object(k.a)(Mg,"OneDriveFilePickerHelper",null,[863]);class ne extends cd.a{constructor(){super()}SWe(){this.Gwc="FilePickerDialog";
this.qg="<div class='FilePickerDiv' id='FilePickerDiv'></div>";this.ig="PickerDialog-MsoSp";this.showDialog("",null)}N7d(){return document.getElementById("FilePickerDiv")}tA(){}aaa(){}}Object(k.a)(ne,"PickerDialog",cd.a,[862]);var Bh=d(482);class Vh{constructor(t,P,ia,Aa,Ka,pb,Nb){this.$a=t;this.Pzd=ia;this.Ca=P;this.FVb=Aa;this.D2a=Ka;this.eGd=pb;this.yNh=Nb}vb(){const t=this.D2a.uwb();t?ve.a.hx||this.$a.ka("SaveToSharePointOnDemandDownloadJsIsEnabled")?this.Ca.ra(E.a.Nib,u.a.frame,Object(r.a)(this,
this.Ymh,"saveToSharePointActionDispatcher"),64):(t.JFa.continueWith(P=>{P.rm&&this.D2a.jGe(P)}),this.dIc()):n.ULS.sendTraceTag(25180162,216,15,"Failure with OneDrive API download as the js url is empty.")}dIc(){Kc.a.Hjd(Object(r.a)(this,this.Ymh,"saveToSharePointActionDispatcher"));Kc.a.F2b([new Bh.a(E.a.Nib,u.a.frame,0)],this.D2a.uwb())}get Ozb(){return this.$a.ka("SaveToAnotherFolderBrsIsEnabled")}get jBf(){return this.$a.ka("UserCanWriteRelative")}Ymh(t,P,ia,Aa,Ka){return P.contextId!==u.a.frame||
t!==E.a.Nib?2:this.Ozb&&(this.eGd.NGb||this.jBf)?1===ia?C.SessionStatusManager.instance.eka||v.AFrameworkApplication.GQ?8:this.yNh()?32:8:2===ia?(n.ULS.sendTraceTag(23881885,216,50,"User clicked on SaveToSharePoint button from "+(Ka&&Ka.SaveEntryPoint&&"VersionHistory"===Ka.SaveEntryPoint.toString()?"version history.":"the backstage.")),this.jBf?(n.ULS.sendTraceTag(24524226,216,50,"Show save a copy dialog."),this.Pzd.create(Ka).mja(null)):(n.ULS.sendTraceTag(24524225,216,50,"No permission save to current folder, show Picker to save to another folder."),
this.FVb.start(null,Ka)),32):8:8}}Object(k.a)(Vh,"SaveToSharePointActor",null,[]);class ij{constructor(t,P,ia,Aa){this.ol=this.ghf=null;this.l5a=t;this.zA=P;this.eGd=ia;this.Rh=Aa}start(t,P){n.ULS.sendTraceTag(25180163,216,50,"Try launch Picker.");this.ghf=t;this.ol=P;this.eGd.start((ia,Aa)=>{this.eIb(ia,Aa)})||this.TWe()}eIb(t,P){if(t)this.onSuccess(P);else this.oz(P)}TWe(){1!==this.Rh.state&&this.zA().SCa(CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError)}onSuccess(t){n.ULS.sendTraceTag(23881886,
216,50,"Success Callback called. Calling UploadToSharePointManager to start upload.");if(t&&t.data&&t.data.value&&t.data.value.length&&t.data.value[0].sharePoint){const P=t.data.value[0].sharePoint.url;t=t.data.value[0].sharePoint.listUrl;let ia=null;if(P&&(ia=t?this.kij(t):this.jij(P))){this.l5a.s1(P,this.ghf,ia,this.ol);return}n.ULS.sendTraceTag(25180164,216,10,"Picker return invalid data, folder url is null: {0}, siteUrl url is null: {1}.",!P,!ia)}n.ULS.sendTraceTag(23881887,216,10,"Picker return invalid data or empty SharePoint url.");
this.TWe()}jij(t){t.endsWith("/")||(t+="/");let P=0;for(let ia=0;ia<t.length;ia++)if("/"===t.charAt(ia)&&5===++P)return t.substr(0,ia);return null}kij(t){t.endsWith("/")&&(t=t.substring(0,t.length-1));const P=t.lastIndexOf("/");return-1!==P?t.substring(0,P):null}oz(t){n.ULS.sendTraceTag(23881888,216,10,"Picker failure Callback called.");t&&t.error?n.ULS.sendTraceTag(23881889,216,10,"File Dialog returned with error code:{0}, and error message: {1}.",t.error.errorCode,t.error.message):n.ULS.sendTraceTag(23881890,
216,10,"File Dialog returned empty error.");this.TWe()}}Object(k.a)(ij,"SaveToSharePointManager",null,[861]);class Ij{constructor(t,P,ia,Aa,Ka,pb,Nb,kc){this.pBa=t;this.pK=P;this.wnb=Aa;this.vHd=pb;this.Opa=ia;this.P_h=Ka;this.fAa=Nb;this.ol=kc}execute(t,P){if(!v.AFrameworkApplication.Tg&&v.AFrameworkApplication.Je){var ia=this.pBa+this.fAa;ia=db.a.Wi(ia,"fu",ab.a.Ke(this.Opa));ia=db.a.Wi(ia,"su",ab.a.Ke(this.P_h));ia=db.a.Wi(ia,"fn",ab.a.Ke(this.pK));ia=db.a.Wi(ia,"n",ab.a.Ke((new Date).getTime().toString()));
this.ol&&this.ol.FileDownloadUrl&&(ia=db.a.Wi(ia,"furl",ab.a.Ke(this.ol.FileDownloadUrl)));ia=ia+"&"+this.vHd;this.wnb&&this.wnb.length?ia=db.a.Wi(ia,"fnn",ab.a.Ke(this.wnb)):n.ULS.sendTraceTag(23881891,216,15,"No new file name in request.");n.ULS.sendTraceTag(23881920,216,50,"Trying send SharePointSaveAsHandler.ashx request.");v.AFrameworkApplication.Je.Aj(ia,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,t,P,null,void 0,void 0,void 0,void 0,"9")}}}Object(k.a)(Ij,"SharePointSaveAsCaller",
null,[897]);class Yj{constructor(t){this.Qqa=t.appSettings.SaveAsToHostWebServiceBase;this.pK=t.appSettings.FileName;this.fAa=t.Ha("SharePointSaveAsHandler")||"sharepointsaveashandler.ashx"}create(t,P,ia,Aa){return new Ij(this.Qqa,this.pK,t,P,ia,v.AFrameworkApplication.jh,this.fAa,Aa)}}Object(k.a)(Yj,"SharePointUploadCallerFactory",null,[860]);var ii=d(492);class Wh{constructor(t,P,ia,Aa,Ka){this.Ln=this.VPb=null;this.Yvd=!1;this.KId=this.Opa=null;this.RLd=P;this.kqa=ia;this.zA=Aa;this.Rh=Ka;this.Ca=
t}s1(t,P,ia,Aa){this.Yvd=!1;n.ULS.sendTraceTag(23881921,216,50,"UploadToSharePointManager.StartUpload : Starting to upload file");this.Lqc();this.Opa=t;Aa&&Aa.SaveEntryPoint&&(this.KId=Aa.SaveEntryPoint);this.VPb=this.RLd.create(t,P,ia,Aa);Aa&&"true"===Aa.SkipSaveToHost?this.f3():this.vZi()}vZi(){const t=()=>{n.ULS.sendTraceTag(23881923,216,15,"The file change is not saved successfully, this operation may lead to data loss.");this.f3()};32!==this.Ca.La(E.a.l_a,2,[()=>{n.ULS.sendTraceTag(23881922,
216,50,"Call the force save file change successfully.");this.f3()},t])&&t()}f3(){n.ULS.sendTraceTag(23881924,216,50,"Send SharePointSaveAsHandler.ashx request.");this.VPb.execute(Object(r.a)(this,this.tsk,"onSaveToSharePointUploadFinished"),Object(r.a)(this,this.ssk,"onSaveToSharePointUploadFailed"))}tsk(t){if(t&&t.data&&t.data.Zd){var P;if(({kv:P}=fe.d(t.data.Zd)).returnValue)if(P.StatusCode!==Ue.a.Ey&&P.StatusCode!==Ue.a.T0b)n.ULS.sendTraceTag(25235987,216,15,"UploadToSharePointManager upload failed with status: {0}, status code: {1}.",
t.data.status,P.StatusCode),P.StatusCode!==Ue.a.Njh&&this.yNf(t.data.status)||(this.Oxa(P.StatusCode.toString()),this.Ffl(P.StatusCode));else{n.ULS.sendTraceTag(23881927,216,50,"UploadToSharePointManager upload success.");this.cQe();try{P.NewDocumentUrl?this.Shb(P.NewDocumentUrl):this.Thb()}catch(ia){n.ULS.sendTraceTag(37025729,216,15,"Redirect failed with exception: {0}",ia.toString())}}else n.ULS.sendTraceTag(23881926,216,10,"Failed to deserialize : {0}",{["ResponseData"]:rd.a.btc(t.data.Zd)}),
this.RMc()||(this.Oxa("Failed to deserialize response"),this.Jqc())}else n.ULS.sendTraceTag(23881925,216,10,"Upload failure. Response data is null"),this.RMc()||(this.Oxa("Unknown"),this.Jqc())}ssk(t){t&&t.data?this.yNf(t.data.status)||(n.ULS.sendTraceTag(23881929,216,10,"Upload failed."),this.Oxa(ii.a[t.data.status]),this.Jqc()):(n.ULS.sendTraceTag(23881928,216,10,"Upload failure. Response data is null"),this.RMc()||(this.Oxa("Unknown"),this.Jqc()))}RMc(){if(!this.Yvd)return n.ULS.sendTraceTag(23881930,
216,10,"Upload fail. Retrying."),this.Yvd=!0,this.f3(),!0;n.ULS.sendTraceTag(23881931,216,10,"Upload fail. Already retry once but still fail.");return!1}yNf(t){n.ULS.sendTraceTag(23881932,216,10,"HTTP failure with code: {0}",t);return this.RMc()}Thb(){n.ULS.sendTraceTag(23881933,216,50,"Redirecting to Folder.");Ze.a.un(this.Opa,Ze.a.Raa(3),void 0,"UploadToSharePointManager.RedirectToFolder")}Shb(t){let P=!1,ia=!1;v.AFrameworkApplication.fa&&(P=v.AFrameworkApplication.fa.ka("SaveACopyIsEnabledForUiHost"),
ia=v.AFrameworkApplication.fa.ka("UiHostSupportsDocRebootFeatures"));n.ULS.sendTraceTag(23881934,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",t,P);if(P&&ia){n.ULS.sendTraceTag(51245198,216,50,"UploadToSharePointManager.RedirectToEditUrl: Sending DocumentRefresh post message.");const Aa={};Aa[Mc.a.cJb]="1";Aa[Mc.a.documentUrl]=t;Aa[Mc.a.reason]=dd.a.HRe;v.AFrameworkApplication.gT().execute(Ka=>{Ka.sendMessage(ed.a.VCa,Aa)})}else Ze.a.un(t,Ze.a.Raa(3),void 0,"UploadToSharePointManager.RedirectToEditUrl")}Lqc(){this.Rh&&
1===this.Rh.state||(this.Ln=this.kqa(),this.Ln.message=CommonUIStrings.l_CommentProgressTooltip,this.Ln.xd=5,this.Ln.yr=!1,this.Ln.Boa(CommonUIStrings.l_DefaultDialogTitle,null,null))}C7a(){this.Ln&&(this.Ln.close(),this.Ln=null)}Jqc(){this.wt(CommonUIStrings.l_SaveFailedDialogTitle,CommonUIStrings.l_FailToSaveFile)}Dgl(){this.wt(CommonUIStrings.l_NoSavePermissionDialogTitle,CommonUIStrings.l_NoSavePermissionDialogMessage)}Mfl(){const t=String.format(CommonUIStrings.l_SaveAsFileTooLargeMessage,250);
this.wt(CommonUIStrings.l_SaveAsFileTooLargeTitle,t,kf.a.m0k)}wt(t,P,ia=kf.a.q0k){n.ULS.sendTraceTag(25180165,216,10,"Upload failure with title: {0}, message: {1}",t,P);this.C7a();1!==this.Rh.state&&this.zA().aNf(t,P,ia)}Ffl(t){n.ULS.sendTraceTag(25180166,216,50,"Upload fail with status code: {0}.",t);switch(t){case Ue.a.yEh:this.Dgl();break;case Ue.a.Njh:this.Mfl();break;default:this.Jqc()}}cQe(){"VersionHistory"===this.KId&&this.Ca.processAction(E.a.Hkd,2)}Oxa(t){"VersionHistory"===this.KId&&this.Ca.La(E.a.dQe,
2,{["FailureReason"]:t})}}Object(k.a)(Wh,"UploadToSharePointManager",null,[859]);class Zj{constructor(){this.SCc=this.hFd=this.bFd=this.Da=null}get name(){return"Common.App.SaveToSharePoint"}init(){}dispose(){}$b(t){this.Da=t;this.bFd=Nf.a.Uu(t.Ja("Common.IEventEmitter<Common.IGetMoreInfoResult>"));this.hFd=Nf.a.Uu(t.Ja("Common.IEventEmitter<Common.IMruResult>"));this.SCc=Nf.a.Uu(t.Ja("Common.App.SharedFilePicker.ISharedFilePicker"));me.Task.WAA.call(null,this.bFd,this.hFd,this.SCc).continueWith(()=>
{this.uOk()})}uOk(){this.Da.register(Yj,"Common.App.SaveToSharePoint.SharePointUploadCallerFactory").as("Common.App.SaveToSharePoint.ISharePointUploadCallerFactory").oa(()=>new Yj(v.AFrameworkApplication.fa)).ma();this.Da.register(Wh,"Common.App.SaveToSharePoint.UploadToSharePointManager").as("Common.App.SaveToSharePoint.IUploadToSharePointManager").oa(()=>new Wh(v.AFrameworkApplication.Ta,this.Da.resolve("Common.App.SaveToSharePoint.SharePointUploadCallerFactory"),()=>(new dc.a).create(),()=>new Id,
v.AFrameworkApplication.Aa)).ma();this.Da.register(ij,"Common.App.SaveToSharePoint.SaveToSharePointManager").as("Common.App.SaveToSharePoint.ISaveToSharePointManager").oa(()=>new ij(this.Da.resolve("Common.App.SaveToSharePoint.UploadToSharePointManager"),()=>new Id,this.Da.resolve("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper"),v.AFrameworkApplication.Aa)).ma();this.Da.register(Mg,"Common.App.SaveToSharePoint.OneDriveFilePickerHelper").as("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper").oa(()=>
new Mg(this.Da.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72"),new Fc.a(()=>this.bFd.result),v.AFrameworkApplication.Aa,()=>new ne)).ma();this.Da.register(hi,"Common.App.SaveToSharePoint.FileNameDialogFactory").oa(()=>new hi(v.AFrameworkApplication.fa,v.AFrameworkApplication.Ta,v.AFrameworkApplication.Aa,v.AFrameworkApplication.Aa.hb,this.Da.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),this.Da.resolve("Common.App.SaveAsToHost.IUploadToHostManager"),this.Da.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager"),
new Fc.a(()=>this.hFd.result),this.Da.resolve("Common.App.SaveToSharePoint.UploadToSharePointManager"),this.SCc?this.SCc.result:null)).ma();this.Da.register(Vh,"Common.App.SaveToSharePoint.SaveToSharePointActor").oa(()=>new Vh(v.AFrameworkApplication.fa,v.AFrameworkApplication.Ta,this.Da.resolve("Common.App.SaveToSharePoint.FileNameDialogFactory"),this.Da.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager"),this.Da.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72"),
this.Da.resolve("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper"),()=>v.AFrameworkApplication.Aa.nIc)).ma();v.AFrameworkApplication.fa.ka("SaveToAnotherFolderBrsIsEnabled")&&this.Da.resolve("Common.App.SaveToSharePoint.SaveToSharePointActor").vb()}static main(){e.a.instance.Dc(new Zj)}}Object(k.a)(Zj,"PackageManager",null,[2,3]);class Hi extends ua.StandardDialog{constructor(){super();this.xd=0;this.Xe(1,CommonUIStrings.l_DialogClose)}nv(t){this.zy(t,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_ErrorSavingToOneDrive,
null)}}Object(k.a)(Hi,"ErrorDialog",ua.StandardDialog,[818]);class $i{}$i.default=0;Object(k.a)($i,"SaveToCloudErrorCodes",null,[]);class Ai{constructor(t,P,ia,Aa,Ka,pb){this.ol=null;this.H_h=t;this.Iba=P;this.WWb=ia;this.$a=Aa;this.mmb=Ka;this.zA=pb}start(t){this.ol=t;if("SharePointOnlineConsumer"===this.$a.Ha("FileSource")){const P=A.a.instance.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager");if(P){P.start(null,t);return}}this.Iba.ahe?(n.ULS.sendTraceTag(6590559,216,50,"User is signed in. We will show file picker."),
this.zni()):(n.ULS.sendTraceTag(6590560,216,50,"User is not signed in. We will show sign in dialog."),this.jhl())}jhl(){this.H_h.create().mja()}wt(){this.zA().nv($i.default)}zni(){try{n.ULS.sendTraceTag(6590561,216,50,"Initializing OneDrive API");let t={["client_id"]:this.$a.appSettings.UploadToSkyDriveClientId,["env"]:"INT"};if(1===this.mmb||2===this.mmb)t={["client_id"]:this.$a.appSettings.UploadToSkyDriveClientId};WL.init(t);n.ULS.sendTraceTag(6590562,216,v.AFrameworkApplication.Aa&&v.AFrameworkApplication.Aa.hb&&
1===v.AFrameworkApplication.Aa.hb.Vk?15:50,"OneDrive API is initialized. Launching file dialogue");WL.fileDialog({["mode"]:"save",["lightbox"]:"grey"}).then(Object(r.a)(this,this.onSuccess,"onSuccess"),Object(r.a)(this,this.oz,"onFailure"))}catch(t){n.ULS.sendTraceTag(6590563,216,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",t,t.stack),this.wt()}}onSuccess(t){n.ULS.sendTraceTag(6590592,216,50,"Success Callback called. Calling UploadToCloudManger to start upload.");t&&t.data&&t.data.folders&&
this.WWb.s1(t.data.folders[0].id,t.data.folders[0].urls.viewInBrowser,null,this.ol)}oz(t){if(t&&t.error){if("user_canceled"===t.error.code){n.ULS.sendTraceTag(6590593,216,50,"User cancelled upload to their OneDrive.");return}n.ULS.sendTraceTag(6590594,216,50,"File Dialog returned with error code:{0}, and error message: {1}",t.error.code,t.error.message)}else n.ULS.sendTraceTag(6590595,216,50,"File Dialog returned with no response");this.wt()}}Object(k.a)(Ai,"SaveToCloudManager",null,[816]);class si{constructor(t,
P,ia,Aa){this.mCc=null;this.rZh=t;this.$a=ia;this.cif=P;this.Gff=new Xf.a;this.Xh=Aa}Ozb(){return this.$a.ka("SaveToCloudStorageUIIsEnabled")}ZWf(){return E.a.QRe}dIc(){Kc.a.Hjd(Object(r.a)(this,this.Vmh,"saveToCloudActionDispatcher"));Kc.a.F2b([new Bh.a(E.a.QRe,u.a.frame,0)],this.cif.uwb())}vb(){const t=this.cif.uwb();t?(t.zS(()=>{this.Gff.Fg(!0)}),this.dIc()):n.ULS.sendTraceTag(6590596,216,15,"Failure with OneDrive API download as the onedrive url received is empty ")}ifh(){n.ULS.sendTraceTag(6590597,
216,50,"User clicked on SaveToOneDrive button")}Vmh(t,P,ia,Aa,Ka){return P.contextId!==u.a.frame||t!==this.ZWf()?2:this.Ozb()?1===ia?C.SessionStatusManager.instance.eka||v.AFrameworkApplication.GQ?8:32:2===ia?(this.ifh(),Ka&&Ka.FileDownloadUrl&&n.ULS.sendTraceTag(50708835,216,50,"SaveToCloudStorageActor FileDownloadUrl is there"),this.Xh&&(this.mCc=this.Xh.Ci("DialogShown","SaveToOneDriveReponseTime")),this.Gff.task.continueWith(()=>{this.mCc&&(this.mCc.stop(),this.mCc=null);this.rZh.start(Ka)}),
32):8:8}}Object(k.a)(si,"SaveToCloudStorageActor",null,[817]);var Ni=d(222);class ak extends ua.StandardDialog{constructor(t,P,ia){super();this.Ca=t;this.Iba=P;this.Xaa=ia;this.GV=!1;this.xd=1;this.jya(1);this.Xe(1,CommonUIStrings.l_SignIn);this.Xe(0,CommonUIStrings.l_SignInToSaveDialogCancelButton)}mja(){this.Iba.Urf(Object(r.a)(this,this.N5g,"onSignIn"));this.Bx(CommonUIStrings.l_SignInToSaveDialogTitle,CommonUIStrings.l_SaveToCloudSignInDialog,0,Object(r.a)(this,this.zEj,"inputHandler"))}zEj(t){0===
t?(n.ULS.sendTraceTag(6590598,216,v.AFrameworkApplication.Aa&&v.AFrameworkApplication.Aa.hb&&1===v.AFrameworkApplication.Aa.hb.Vk?15:50,"User dismissed SignIn Dialog."),this.hide()):this.xgd()}Mpi(){let t="2";if(this.Xaa)switch(this.Xaa.Vk){case 3:t="0";break;case 2:t="3";break;case 1:t="1"}return t}hide(){this.Iba.YSk(Object(r.a)(this,this.N5g,"onSignIn"));super.hide()}xgd(){var t=v.AFrameworkApplication.fa.ka("SignInAspxInWebAppsPortalIsEnabled")?"/start/signin.aspx":"Signin.aspx";t=new Ni.QueryStringBuilder(t);
t.Ki("prompt","1");t.Ki("cbcxt",this.Mpi());v.AFrameworkApplication.gPa(t);Ze.a.un(t.toString(),"LoginWindow",void 0,"SignInDialog")}N5g(){this.HQ&&this.hide();n.ULS.sendTraceTag(7143885,216,v.AFrameworkApplication.Aa&&v.AFrameworkApplication.Aa.hb&&1===v.AFrameworkApplication.Aa.hb.Vk?15:50,"User signed in successfully. Calling Savetocloudstorage action handler");this.Ca.processAction(E.a.QRe,2)}}Object(k.a)(ak,"SignInDialog",ua.StandardDialog,[882]);class Sj{constructor(t,P,ia){this.Ca=t;this.Iba=
P;this.Xaa=ia}create(){return new ak(this.Ca,this.Iba,this.Xaa)}}Object(k.a)(Sj,"SignInDialogFactory",null,[815]);class ti{constructor(t,P,ia,Aa,Ka,pb,Nb){this.pBa=t;this.pK=P;this.wnb=ia;this.Kxc=Aa;this.vHd=Ka;this.fAa=pb;this.ol=Nb}execute(t,P){if(!v.AFrameworkApplication.Tg&&v.AFrameworkApplication.Je){var ia=this.pBa+this.fAa;ia=db.a.Wi(ia,"fo",ab.a.Ke(this.Kxc));ia=db.a.Wi(ia,"fn",ab.a.Ke(this.pK));ia=db.a.Wi(ia,"qs",ab.a.Ke(this.vHd));ia=db.a.Wi(ia,"n",ab.a.Ke((new Date).getTime().toString()));
this.ol&&this.ol.FileDownloadUrl&&(ia=db.a.Wi(ia,"furl",ab.a.Ke(this.ol.FileDownloadUrl)));this.wnb&&(ia=db.a.Wi(ia,"fnn",ab.a.Ke(this.wnb)));v.AFrameworkApplication.Je.Aj(ia,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,t,P,null)}}}Object(k.a)(ti,"SkyDriveUploadCaller",null,[881]);class Ii{constructor(t){this.$a=t;this.Qqa=t.appSettings.SkyDriveUploadWebServiceBase;this.pK=t.appSettings.FileName;this.fAa=t.Ha("SkyDriveUploadHandler")||"skydriveuploadhandler.ashx"}create(t,P,ia){return new ti(this.Qqa,
this.pK,P,t,v.AFrameworkApplication.jh,this.fAa,ia)}}Object(k.a)(Ii,"SkydriveUploadCallerFactory",null,[814]);class bg{constructor(t,P,ia,Aa,Ka){this.Opa=this.Ln=this.VPb=null;this.e2=!1;this.ol=this.kBa=null;this.RLd=t;this.kqa=P;this.zA=ia;this.Rh=Aa;this.Xh=Ka}Lqc(){this.Rh&&1===this.Rh.state||(this.Ln=this.kqa(),this.Ln.message=CommonUIStrings.l_CommentProgressTooltip,this.Ln.xd=5,this.Ln.yr=!1,this.Ln.Boa(CommonUIStrings.l_DefaultDialogTitle,null,null))}C7a(){this.Ln&&(this.Ln.close(),this.Ln=
null)}OY(){1!==v.AFrameworkApplication.Aa.state&&this.zA().nv($i.default)}Thb(){n.ULS.sendTraceTag(6590599,216,50,"Redirecting to OneDrive Folder.");Ze.a.un(this.Opa,Ze.a.Raa(3),void 0,"UploadToCloudManager.RedirectToFolder")}Shb(t){let P=!1,ia=!1;v.AFrameworkApplication.fa&&(P=v.AFrameworkApplication.fa.ka("SaveACopyIsEnabledForUiHost"),ia=v.AFrameworkApplication.fa.ka("UiHostSupportsDocRebootFeatures"));n.ULS.sendTraceTag(6654163,216,v.AFrameworkApplication.Aa&&v.AFrameworkApplication.Aa.hb&&1===
v.AFrameworkApplication.Aa.hb.Vk?15:50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",t,P);if(P&&ia){n.ULS.sendTraceTag(594929733,216,50,"UploadToCloudManager.RedirectToEditUrl: Sending DocumentRefresh post message.");const Aa={};Aa[Mc.a.cJb]="1";Aa[Mc.a.documentUrl]=t;v.AFrameworkApplication.gT().execute(Ka=>{Ka.sendMessage(ed.a.VCa,Aa)})}else Ze.a.un(t,Ze.a.Raa(3),void 0,"UploadToCloudManager.RedirectToEditUrl")}s1(t,P,ia=null,Aa=null){n.ULS.sendTraceTag(7143886,216,50,"Starting to upload file");
this.Xh&&(this.kBa=this.Xh.Ci("DialogShown","SaveToOneDriveUploadTime"));this.Lqc();this.Opa=P;this.VPb=this.RLd.create(t,ia,Aa);this.ol=Aa;this.f3()}f3(){n.ULS.sendTraceTag(6590600,216,50,"Calling SkydriveUploadHandler.");this.VPb.execute(Object(r.a)(this,this.rsk,"onSaveToCloudUploadFinished"),Object(r.a)(this,this.qsk,"onSaveToCloudUploadFailed"))}rsk(t){this.C7a();this.e2=!1;if(t&&t.data&&t.data.Zd){var P;if(({kv:P}=fe.d(t.data.Zd)).returnValue)if(t=P,t.StatusCode!==Ue.a.Ey&&t.StatusCode!==Ue.a.T0b)n.ULS.sendTraceTag(6590602,
216,10,"UploadToCloudManager upload failure. Response data is not JSON."),this.OY();else{n.ULS.sendTraceTag(6590603,216,v.AFrameworkApplication.Aa&&v.AFrameworkApplication.Aa.hb&&1===v.AFrameworkApplication.Aa.hb.Vk?15:50,"UploadToCloudManager upload success.");try{t.NewDocumentUrl&&""!==t.NewDocumentUrl?this.Shb(t.NewDocumentUrl):this.Thb()}catch(ia){n.ULS.sendTraceTag(37025728,216,15,"Redirect failed with exception: {0}",ia.toString())}this.Mkc()}else n.ULS.sendTraceTag(7660114,216,10,"Failed to deserialize : {0}",
{["ResponseData"]:rd.a.btc(t.data.Zd)}),this.OY()}else n.ULS.sendTraceTag(6590601,216,10,"UploadToCloudManager upload failure. Response data is null"),this.OY()}qsk(t){5!==t.data.status&&12!==t.data.status||this.e2?(n.ULS.sendTraceTag(6590605,216,10,"UploadToCloudManager HTTP failure with code: {0}",t.data.status),this.C7a(),this.OY(),this.Mkc()):(n.ULS.sendTraceTag(6590604,216,10,"UploadToCloudManager failure. Retrying."),this.e2=!0,this.f3())}Mkc(){this.kBa&&(this.kBa.stop(),this.kBa=null)}}Object(k.a)(bg,
"UploadToCloudManager",null,[813]);class xa{constructor(){this.Da=null}get name(){return"Common.App.SaveToCloudStorage"}init(){v.AFrameworkApplication.fa.ka("SaveToCloudStorageUIIsEnabled")&&this.Da.resolve("Common.App.SaveToCloudStorage.SaveToCloudStorageActor").vb()}dispose(){}$b(t){this.Da=t;this.Da.register(Sj,"Common.App.SaveToCloudStorage.SignInDialogFactory").as("Common.App.SaveToCloudStorage.ISignInDialogFactory").oa(()=>new Sj(v.AFrameworkApplication.Ta,gi.a.instance,v.AFrameworkApplication.Aa.hb)).ma();
this.Da.register(Ii,"Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory").as("Common.App.SaveToCloudStorage.ISkydriveUploadCallerFactory").oa(()=>new Ii(v.AFrameworkApplication.fa)).ma();this.Da.register(si,"Common.App.SaveToCloudStorage.SaveToCloudStorageActor").oa(()=>new si(t.resolve("Common.App.SaveToCloudStorage.SaveToCloudManager"),t.resolve("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager"),v.AFrameworkApplication.fa,v.AFrameworkApplication.Aa.gV)).ma();this.Da.register(bg,
"Common.App.SaveToCloudStorage.UploadToCloudManager").oa(()=>new bg(t.resolve("Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory"),()=>(new dc.a).create(),()=>new Hi,v.AFrameworkApplication.Aa,v.AFrameworkApplication.Aa.gV)).ma();this.Da.register(Ai,"Common.App.SaveToCloudStorage.SaveToCloudManager").oa(()=>new Ai(t.resolve("Common.App.SaveToCloudStorage.SignInDialogFactory"),gi.a.instance,t.resolve("Common.App.SaveToCloudStorage.UploadToCloudManager"),v.AFrameworkApplication.fa,v.AFrameworkApplication.ARa,
()=>new Hi)).ma()}static main(){e.a.instance.Dc(new xa)}}Object(k.a)(xa,"PackageManager",null,[2,3]);class Ma{static get qg(){return cd.a.gC(Ma.ro,CommonUIStrings.l_SaveACopyFileName)}}Ma.ro="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div>";
Object(k.a)(Ma,"FileNameDialogHtml",null,[]);class $a extends cd.a{constructor(t,P,ia,Aa){super();this.Kxc=this.Opa=null;this.Ca=t;this.Xaa=P;this.WWb=ia;this.Xe(1,CommonUIStrings.l_SaveButtonLabel);this.qg=Ma.qg;this.ig="FileNameDialog-SaveACopy";this.ol=Aa}mja(t,P,ia){this.Kxc=t;this.Opa=ia;t={["txtFileName"]:ab.a.TG(v.AFrameworkApplication.xu.Uw),["lblFolderName"]:String.format(CommonUIStrings.l_DestinationFolder,P)};this.$i(CommonUIStrings.l_SaveToOneDrive,Object(r.a)(this,this.LOc,"fileNameDialogHandler"),
t);n.ULS.sendTraceTag(7174148,216,50,"The file name dialog is initialized and shown.");document.getElementById("txtFileName").focus()}LOc(t,P){1!==t?n.ULS.sendTraceTag(7165650,216,50,"User click cancel to cancel upload file in file name dialog."):(t=P.txtFileName.trim(),n.ULS.sendTraceTag(7165651,216,50,"User click save to upload file with new name."),P=ab.a.bT(v.AFrameworkApplication.fileName),t&&""!==t&&""!==P&&(t+=P),this.WWb.s1(this.Kxc,this.Opa,t,this.ol))}}Object(k.a)($a,"FileNameDialog",cd.a,
[884]);class Eb{constructor(t,P,ia){this.Ca=t;this.Xaa=P;this.WWb=ia}create(t){return new $a(this.Ca,this.Xaa,this.WWb,t)}}Object(k.a)(Eb,"FileNameDialogFactory",null,[819]);class ac extends ua.StandardDialog{constructor(t){super();this.xd=1;this.Xe(1,CommonUIStrings.l_RetryButtonLabel);this.Xe(0,CommonUIStrings.l_DialogClose);this.Ca=t}nv(t){n.ULS.sendTraceTag(7165652,216,50,"Show error dialog here {0}.",t);this.zy(t,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_ErrorSavingToOneDrive,Object(r.a)(this,
this.SQe,"retryDialogHandler"))}SQe(t){1===t?(n.ULS.sendTraceTag(7165653,216,50,"User click to retry the action."),this.Ca.processAction(E.a.Ioc,2)):n.ULS.sendTraceTag(7165654,216,50,"User cancel the error dialog.")}}Object(k.a)(ac,"RetryDialog",ua.StandardDialog,[818]);class tc extends si{constructor(t,P,ia,Aa){super(t,P,ia,Aa);this.EWh=P}Ozb(){return this.$a.ka("SaveACopyBrsIsEnabled")}ZWf(){return E.a.Ioc}dIc(){Kc.a.Hjd(Object(r.a)(this,this.Vmh,"saveToCloudActionDispatcher"));Kc.a.F2b([new Bh.a(E.a.Ioc,
u.a.frame,0)],this.EWh.uwb())}ifh(){v.AFrameworkApplication.PFa("CreateCopy_cf;CreateCopy_tf");n.ULS.sendTraceTag(7205456,216,50,"User clicked on SaveAs button from the backstage.")}}Object(k.a)(tc,"SaveACopyActor",si,[]);class aa extends Ai{constructor(t,P,ia,Aa,Ka,pb,Nb){super(P,ia,Aa,Ka,pb,Nb);this.AQh=t}onSuccess(t){t&&t.data&&t.data.folders?(n.ULS.sendTraceTag(7165655,216,50,"User selected which folder to upload file to."),this.AQh.create(this.ol).mja(t.data.folders[0].id,t.data.folders[0].name,
t.data.folders[0].urls.viewInBrowser)):(n.ULS.sendTraceTag(7165656,216,10,"Fail to select folder to upload file."),this.wt())}oz(t){t&&t.error&&"user_canceled"===t.error.code&&n.ULS.sendTraceTag(7205457,216,50,"User cancelled upload to their OneDrive in Save A Copy.");super.oz(t)}wt(){n.ULS.sendTraceTag(7205458,216,50,"Error occur in Save A Copy Manager.");super.wt()}}Object(k.a)(aa,"SaveACopyManager",Ai,[]);class sa extends bg{constructor(t,P,ia,Aa,Ka,pb){super(P,ia,Aa,Ka,pb);this.Ca=t}dke(){return!!this.ol&&
!!this.ol.SaveEntryPoint&&"VersionHistory"===this.ol.SaveEntryPoint.toString()}OY(){n.ULS.sendTraceTag(7205459,216,50,"Display Error for Save A Copy.");this.dke()&&this.Ca.La(E.a.dQe,2,{["FailureReason"]:"Unknown"});super.OY()}Thb(){n.ULS.sendTraceTag(7205460,216,50,"Redirecting to OneDrive Folder for Save A Copy.");this.dke()&&this.Ca.processAction(E.a.Hkd,2);super.Thb()}Shb(t){n.ULS.sendTraceTag(7205461,216,50,"Redirecting to edit url {0} for Save A Copy.",t);this.dke()&&this.Ca.processAction(E.a.Hkd,
2);super.Shb(t)}f3(){this.ol&&"true"===this.ol.SkipSaveToHost?super.f3():32!==this.Ca.processAction(E.a.l_a,1)?(n.ULS.sendTraceTag(8741711,216,15,"The save file change is not supported, this operation may result in data loss"),super.f3()):this.Ca.La(E.a.l_a,2,[()=>{n.ULS.sendTraceTag(8741712,216,50,"Call the force save file change successfully.");bg.prototype.f3.call(this)},()=>{n.ULS.sendTraceTag(8741713,216,15,"The file change is not saved successfully, this operation may lead to data loss.");this.OY()}])}}
Object(k.a)(sa,"SaveACopyUploadToCloudManager",bg,[]);class Oa{constructor(){this.Da=null}get name(){return"Common.App.SaveACopy"}init(){v.AFrameworkApplication.fa.jf(Object(r.a)(this,this.Om,"onFullAppSettingsReady"))}Om(){v.AFrameworkApplication.fa.ka("SaveACopyBrsIsEnabled")&&this.Da.resolve("Common.App.SaveACopy.SaveACopyActor").vb()}dispose(){}$b(t){this.Da=t;this.Da.register(sa,"Common.App.SaveACopy.SaveACopyUploadToCloudManager").oa(()=>new sa(v.AFrameworkApplication.Ta,t.resolve("Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory"),
()=>(new dc.a).create(),()=>new ac(v.AFrameworkApplication.Ta),v.AFrameworkApplication.Aa,v.AFrameworkApplication.Aa.gV)).ma();this.Da.register(Eb,"Common.App.SaveACopy.FileNameDialogFactory").as("Common.App.SaveACopy.IFileNameDialogFactory").oa(()=>new Eb(v.AFrameworkApplication.Ta,v.AFrameworkApplication.Aa.hb,t.resolve("Common.App.SaveACopy.SaveACopyUploadToCloudManager"))).ma();this.Da.register(tc,"Common.App.SaveACopy.SaveACopyActor").oa(()=>new tc(t.resolve("Common.App.SaveACopy.SaveACopyManager"),
t.resolve("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager"),v.AFrameworkApplication.fa,v.AFrameworkApplication.Aa.gV)).ma();this.Da.register(aa,"Common.App.SaveACopy.SaveACopyManager").oa(()=>new aa(t.resolve("Common.App.SaveACopy.FileNameDialogFactory"),t.resolve("Common.App.SaveToCloudStorage.SignInDialogFactory"),gi.a.instance,t.resolve("Common.App.SaveACopy.SaveACopyUploadToCloudManager"),v.AFrameworkApplication.fa,v.AFrameworkApplication.ARa,()=>new ac(v.AFrameworkApplication.Ta))).ma()}static main(){e.a.instance.Dc(new Oa)}}
Object(k.a)(Oa,"PackageManager",null,[2,3]);var ib=d(368);class Gb{constructor(t){this.HDg=null;n.ULS.sendTraceTag(527574681,306,50,"PhoneLinkManager - Initialize");this.Bfc=v.AFrameworkApplication.fa.Ha("PhoneLinkServiceEndpoint");(this.XL=t)||n.ULS.sendTraceTag(527574720,306,10,"PhoneLinkManager - OAuthManager is null");this.Bfc&&this.Bfc.length||n.ULS.sendTraceTag(527574721,306,10,"PhoneLinkManager - Missing service endpoint")}pVi(t){t&&(this.Bfc="https://dcg-df.microsoft.com/",n.ULS.sendTraceTag(526697302,
306,50,"PhoneLinkManager::FetchPhoneLinkData override endpoint to dogfood"));this.oVi()}oVi(){n.ULS.sendTraceTag(527214155,306,50,"PhoneLinkManager::FetchPhoneLinkData...");if(864E5>=+new Date-+this.HDg)n.ULS.sendTraceTag(527574722,306,10,"PhoneLinkManager::FetchPhoneLinkData - Can't get more than 1 time within 1 day");else{this.HDg=new Date;var t=new Date;this.XL.nV("BayBridge",this.Bfc).then(P=>{const ia=+new Date-+t;P.IsSuccess?(n.ULS.sendTraceTag(527574723,306,50,"PhoneLinkManager::FetchPhoneLinkData Phone Link Authentication Latency: {0}",
ia),this.iVi(P.Token,this.$1i())):n.ULS.sendTraceTag(527574724,306,15,"PhoneLinkManager::FetchPhoneLinkData Failed to get AAD token with error, authDuration: {0}, ErrorCode: {1}, ErrorMessage: {2}",ia,P.ErrorCode,P.ErrorMessage)}).catch(P=>{n.ULS.sendTraceTag(527574725,306,15,"PhoneLinkManager::FetchPhoneLinkData - Token retrival failed: {0}, Latency: {1}",P,+new Date-+t)})}}iVi(t,P){const ia={};ia.Authorization="Bearer "+t;ia["Authorization-Type"]="AAD";ia.Accept="application/json";ia["DCG-SessionId"]=
v.AFrameworkApplication.userSessionId;v.AFrameworkApplication.Je.Aj(P,1,null,ia,!1,2,Object(r.a)(this,this.gjj,"getStatusSucceeded"),Object(r.a)(this,this.ejj,"getStatusFailed"),null,void 0,void 0,void 0,void 0,"39");jb.a("FetchAccountLinkedStatus")}d3i(){const t=ib.a.instance.getItem("AccountLinkedStatusCache");return t&&t.length?"true"===t.toLowerCase()?!0:!1:!1}$1i(){return this.Bfc+"DeviceAuthProxy/IsAccountLinked?api-version=1.0.0"}ejj(){n.ULS.sendTraceTag(527214156,306,15,"PhoneLinkManager FetchAccountLinkedStatus request failed")}gjj(t){n.ULS.sendTraceTag(527214157,
352,50,"GetStatusSucceeded FetchAccountLinkedStatus request was successful");t=fe.a(t.data.Zd).state+"";ib.a.instance.setItem("AccountLinkedStatusCache",t)}}Object(k.a)(Gb,"PhoneLinkManager",null,[790]);class Bb{constructor(){this.Da=null}get name(){return"Common.App.PhoneLink"}$b(t){this.Da=t;this.Da.register(790,"Common.App.PhoneLink.IPhoneLinkManager").ma().oa(()=>new Gb(this.Da.resolve("Common.App.OAuth.IOAuthManager")))}init(){v.AFrameworkApplication.fa.jf(()=>{this.BEa()})}BEa(){this.Da.resolve("Common.App.PhoneLink.IPhoneLinkManager")}dispose(){}static main(){e.a.instance.Dc(new Bb)}}
Object(k.a)(Bb,"PhoneLinkPackage",null,[2,3]);var Cc;(function(t){t[t.myFiles=0]="myFiles";t[t.recent=1]="recent";t[t.currentFolder=2]="currentFolder";t[t.yourPhone=3]="yourPhone"})(Cc||(Cc={}));Object(k.b)("SharedFilePickerLandingLocation",Cc);class cc{constructor(t){this.u$a=this.iIb=null;this._initialized=!1;this.vbe=t}i0d(t){this._initialized||(t.pu(ed.a.Weh),t.zB(ed.a.Weh,Object(r.a)(this,this.Prk,"onReceivedPickerResponse")),this._initialized=!0)}C5d(t){return this.u$a=new Promise((P,ia)=>{const Aa=
{};Aa[Mc.a.Izk]=t;this.iIb=(Ka,pb)=>{""===pb?(n.ULS.sendTraceTag(572548163,306,50,"Resolving Promise with Picker Data"),P(Ka)):("Canceled"===pb?n.ULS.sendTraceTag(572548164,306,50,pb):n.ULS.sendTraceTag(556901065,306,10,pb),ia(pb))};this.vbe.execute(Ka=>{this.i0d(Ka);Ka.sendMessage(ed.a.ovk,Aa)})})}Prk(t){this.iIb(t.Values[Mc.a.k2k],void 0===t.Values[Mc.a.LIe]||null===t.Values[Mc.a.LIe]?"":t.Values[Mc.a.LIe])}oke(){return v.AFrameworkApplication.fa.ka("UiHostCommonFilePicker")}sWd(t,P,ia,Aa,Ka,pb,
Nb,kc,Rc=null){const Yc={};Yc[Mc.a.V1k]=t;Yc[Mc.a.titleText]=P;Yc[Mc.a.hci]=ia;Yc[Mc.a.ici]=Aa;Yc[Mc.a.jci]=Ka;Yc[Mc.a.dMi]=!0;Yc[Mc.a.JVi]=pb;Yc[Mc.a.Lzk]=Nb;Yc[Mc.a.Kzk]=Cc[kc];sb.a("isSharedUXDarkModeOn")&&appChrome.api.isSharedUXDarkModeOn()&&(Yc[Mc.a.Mzk]="Dark");Rc&&(null!=Rc.Uqb&&(Yc[Mc.a.Uqb]=Rc.Uqb),null!=Rc.Lxb&&(Yc[Mc.a.Lxb]=Rc.Lxb));return Yc}}Object(k.a)(cc,"SharedFilePickerManager",null,[811]);class Qd{constructor(){this.Da=null}get name(){return"Common.App.SharedFilePicker"}$b(t){this.Da=
t;t.register(cc,"Common.App.SharedFilePicker.SharedFilePickerManager").as("Common.App.SharedFilePicker.ISharedFilePicker").ma().oa(()=>new cc(t.Ja("Postmessage.IHostPostmessenger")))}init(){v.AFrameworkApplication.fa.jf(()=>{this.BEa()})}BEa(){this.Da.resolve("Common.App.SharedFilePicker.ISharedFilePicker")}dispose(){}static main(){e.a.instance.Dc(new Qd)}}Object(k.a)(Qd,"SharedFilePickerPackage",null,[2,3]);class re{constructor(t,P=3E4){this.Yql=9E5;this.crl=1E4;this.arg=this.kDb=null;this.Moe=0;
this.n1b=Date.now;this.OTc=t;this.$rd=P;this.rQc()}W5f(t=!0){const P=this.n1b();if(P<this.Moe+this.Yql)return P>this.Moe+this.crl&&this.rQc(),this.arg;t&&this.rQc();return null}getToken(t=!0){return(t=this.W5f(t))?Promise.resolve(t):this.rQc()}rQc(){return this.kDb=this.kDb||new Promise(t=>{this.OTc().then(P=>{this.kDb=null;""!==P&&P&&(this.arg=P,this.Moe=this.n1b(),t(P));t(null)}).catch(()=>{this.kDb=null;t(null)});window.setTimeout(()=>{this.kDb=null;t(null)},this.$rd)})}}Object(k.a)(re,"OAuthCacheManager",
null,[]);var Ca=d(104),ob=d(67);class Hb{static c4d(t){return""!==t&&t?Hb.Hci[t.toLowerCase()]:""}static llj(t,P){const ia=Date.now();var Aa=Hb.UJc();const Ka=v.AFrameworkApplication.fa.Ha("UserPrincipalName"),pb=Hb.c4d(t);n.ULS.sendTraceTag(593862986,1300,50,"Begin SSO Request for app: "+t);if(""===Ka||!Ka)return n.ULS.sendTraceTag(593862985,1300,10,"Missing login hint for silent oAuth"),Promise.resolve("");if(""===pb||!pb)return n.ULS.sendTraceTag(593862984,1300,10,"Missing AAD appId for appName: "+
t),Promise.resolve("");const Nb=Ca.a.create().toString();Aa=String.format("{0}/common/oauth2/authorize?response_type=token&scope=openid&domain_hint=organizations&client_id={1}&resource={2}&login_hint={3}&redirect_uri={4}&state={5}&prompt=none","https://login.microsoftonline.com",pb,encodeURIComponent(P),encodeURIComponent(Ka),encodeURIComponent(Aa),Nb);const kc=document.createElement("iframe");kc.style.display="none";kc.setAttribute("sandbox","allow-forms allow-scripts allow-same-origin");kc.src=
Aa;document.body.appendChild(kc);return new Promise(Rc=>{Hb.Whk(kc.contentWindow).then(Yc=>{document.body.removeChild(kc);const hd=new ob.a,se=RegExp("[#?&]+([^=&]+)=([^&]*)","gi");let Ae;for(;Ae=se.exec(Yc);)3!==Ae.length&&(n.ULS.sendTraceTag(593862983,1300,10,"Unexpected Hash respones in OAuth header! Match length: {0}",Ae.length),Rc("")),hd.$(Ae[1],Ae[2]);hd.Hb("access_token")?(n.ULS.sendTraceTag(593862982,1300,50,"SSO Request successful for resource: {0} for app: {1} Latency: {2}",P,t,Date.now()-
ia),Rc(hd.ga("access_token"))):(n.ULS.sendTraceTag(526668183,1300,10,"SSO Request failure for resource: {0} for app: {1}. Latency: {2}",P,t,(Date.now()-ia).toString()),Rc(""))}).catch(Yc=>{try{document.body.removeChild(kc)}catch(hd){}n.ULS.sendTraceTag(593862980,1300,10,"SSO Request failure for resource: {0} for app: {1} Error: {2} Latency: {3}",P,t,JSON.stringify(Yc),(Date.now()-ia).toString());Rc("")})})}static UJc(){const t=window.location.protocol,P=window.location.host;var ia=v.AFrameworkApplication.fa.Ha("OAuthManagerHostPathOverride");
if(void 0===ia||null===ia){ia=window.location.pathname;const Aa=ia.lastIndexOf("/");ia=0<=Aa?ia.substring(0,Aa+1):""}return t+"//"+P+ia+"WacOAuth.html"}static Whk(t){return new Promise((P,ia)=>{let Aa=0,Ka=0;Ka=window.setInterval(()=>{if(200<Aa++)window.clearInterval(Ka),ia("Exceeded 10000ms timeout after 200 polls");else{var pb=null,Nb=null;try{if(!t||t.closed){window.clearInterval(Ka);ia("Window or Frame is closed before completion");return}pb=t.location.href;Nb=t.location.hash}catch(kc){}pb&&"about:blank"!==
pb&&Nb&&""!==Nb&&(window.clearInterval(Ka),P(Nb))}},50)})}}Hb.Hci={["smartlookup"]:"4d5c2d63-cf83-4365-853c-925fd1a64357",["search"]:"a9b49b65-0a12-430b-9540-c80b3332c127"};Object(k.a)(Hb,"OAuthHelper",null,[]);class rc{constructor(t,P){this.token=t;this.source=P}}Object(k.a)(rc,"TokenResult",null,[]);class td{constructor(){this.XL=null;this.Y9e={};this.INb=new Hd.a(Bf.a.jp())}getToken(t,P,ia=!1){if(this.INb.Hb(P))return this.INb.ga(P).getToken();const Aa=new re(()=>ia?this.X5f(t,P):this.OTc(t,P));
this.INb.$(P,Aa);return Aa.getToken()}jlj(t,P,ia=!1){if(this.INb.Hb(P))return this.INb.ga(P).W5f();const Aa=new re(()=>ia?this.X5f(t,P):this.OTc(t,P));this.INb.$(P,Aa);return null}OTc(t,P){const ia=Date.now();return Hb.llj(t,P).then(Aa=>new rc(Aa,"SSOStack")).then(Aa=>new Promise(Ka=>{Aa.token&&""!==Aa.token?(n.ULS.sendTraceTag(593862979,1300,50,"{0}: SSO Token resolved from {1}. Latency: {2}",t,Aa.source,Date.now()-ia),this.w_a("GetTokenInternal",!0,Date.now()-ia,t,"","",P),Ka(Aa.token)):(n.ULS.sendTraceTag(593862978,
1300,50,"{0}: SSO Token provider failed! Latency: {1}",t,Date.now()-ia),this.w_a("GetTokenInternal",!1,Date.now()-ia,t,"GetTokenSilent Failed","SSO Token provider failed!",P),Ka(""))}))}X5f(t,P){if(!this.XL)try{this.XL=A.a.instance.resolve("Common.App.OAuth.IOAuthManager")}catch(ia){n.ULS.sendTraceTag(51689675,1300,10,"Unable to resolve IOAuthManager: "+ia)}return this.XL?new Promise(ia=>{const Aa=Date.now();this.XL.nV(t,P).then(Ka=>{const pb=Ka.Token;!Ka.IsSuccess||this.wUj(pb)?(this.w_a("GetTokenInternalImplicitJS",
!1,Date.now()-Aa,t,Ka.ErrorCode,Ka.ErrorMessage,P),ia(null)):(this.w_a("GetTokenInternalImplicitJS",!0,Date.now()-Aa,t,Ka.ErrorCode,Ka.ErrorMessage,P),ia(pb))}).catch(Ka=>{Ka=Ka?fe.c(Ka):"";this.w_a("GetTokenInternalImplicitJS",!1,Date.now()-Aa,t,"Caught Exception",Ka,P);ia(null)})}):new Promise(ia=>{this.w_a("GetTokenInternalImplicitJS",!1,0,t,"Null OAuthManager","OAuthManager not set");ia(null)})}w_a(t,P,ia,Aa,Ka="",pb="",Nb=""){var kc="Search"===Aa;const Rc=[];t=Hh.a.t8(kc?"Event":"EventName",
t,2);Aa=Hh.a.t8("AppName",Aa,2);Array.add(Rc,t);Array.add(Rc,Aa);kc&&(Aa=Hh.a.t8("LatencyType","FetchToken",2),Array.add(Rc,Aa));Ka&&""!==Ka&&(Ka=Hh.a.t8("ErrorCode",Ka,2),Array.add(Rc,Ka));pb&&""!==pb&&(pb=Hh.a.t8("ErrorMessage",pb,2),Array.add(Rc,pb));Nb&&""!==Nb&&(pb=!(Nb in this.Y9e),this.Y9e[Nb]=pb,pb=Hh.a.t8("WarmUpCall",pb.toString(),1),Array.add(Rc,pb),Nb=Hh.a.t8("Service",this.mTc(Nb),2),Array.add(Rc,Nb));kc=kc?"Office.TellMe.TellMeWAC.Latency":"Office.Insights.SmartLookup.Authentication";
P=Object.assign(new hj.a,{name:kc,samplingPolicy:2,dataFields:Rc,succeeded:P,durationMs:ia});w.a.sendActivityEvent(P)}mTc(t){return t===v.AFrameworkApplication.rne?"Loki":t===v.AFrameworkApplication.XYe?"Substrate":v.AFrameworkApplication.fa&&t===v.AFrameworkApplication.fa.Ha("SmartLookupShredderServiceEndpoint")?"Shredder":"Other"}wUj(t){return!t||!t.length}}Object(k.a)(td,"SearchOAuthManager",null,[789]);class sc{constructor(){this.Da=null}get name(){return"Common.App.SearchOAuthManager"}$b(t){this.Da=
t;this.Da.register(789,"Common.App.SearchCommon.ISearchOAuthManager").ma().oa(()=>new td)}init(){}dispose(){}static main(){e.a.instance.Dc(new sc)}}Object(k.a)(sc,"SearchOAuthPackage",null,[2,3]);var Tc;(function(t){t[t.generalException=0]="generalException";t[t.invalidArgument=1]="invalidArgument";t[t.notAllowed=2]="notAllowed";t[t.apiNotAvailable=3]="apiNotAvailable";t[t.unresolvedPendingRequest=4]="unresolvedPendingRequest";t[t.timeout=5]="timeout";t[t.adalTimeout=6]="adalTimeout";t[t.userNotSignedIn=
7]="userNotSignedIn";t[t.userAborted=8]="userAborted";t[t.silentSignInFailed=9]="silentSignInFailed";t[t.invalidResourceUrl=10]="invalidResourceUrl";t[t.invalidGrant=11]="invalidGrant";t[t.connectionLost=12]="connectionLost";t[t.clientError=13]="clientError";t[t.serverError=14]="serverError"})(Tc||(Tc={}));Object(k.b)("ErrorCodes",Tc);class Dc{}Object(k.a)(Dc,"HostApplicationType",null,[]);class xc{constructor(t,P){this.requestCallback=this.requestParameters=null;this.requestParameters=t;this.requestCallback=
P}}Object(k.a)(xc,"OutstandingRequest",null,[]);class pg{}pg.Djk="AADSTS50058";pg.invalidResourceUrl="AADSTS50001";pg.xjk="AADSTS65001";pg.Qjk="AADSTS70011";pg.userAborted="13002";pg.yBk="Popup Window is null";pg.xBk="Popup Window closed";pg.adalTimeout="Token renewal operation failed due to timeout";pg.drl="tokenRevoked";Object(k.a)(pg,"WopiHostErrorType",null,[]);var Ih=d(224),vh=d(347),Ti=d(1124);class ai{constructor(){this.authority=this.email=this.displayName=null;this.authority=this.email=this.displayName=
""}}Object(k.a)(ai,"WopiIdentityInfo",null,[877]);class Il{constructor(t,P,ia){this.expiration=this.authority=this.accessToken=null;this.accessToken=t;this.authority=P;this.expiration=ia}}Object(k.a)(Il,"WopiIdentityToken",null,[878]);class ui{constructor(t){this._initialized=!1;this.SGb={};this.nqd={};this.waa=v.AFrameworkApplication.Aa.gV;this.vbe=t}i0d(t){this._initialized||(t.pu(ed.a.N$g),t.zB(ed.a.N$g,Object(r.a)(this,this.Nrk,"onReceivedAccessToken")),this._initialized=!0)}getAccessToken(t,
P,ia=null){this.R2j(t,P);return new Promise((Aa,Ka)=>{if(this.Vge(P))if(P in this.SGb)Ka("unresolvedPendingRequest");else{var pb=window.setTimeout(()=>{n.ULS.sendTraceTag(37856032,344,10,fe.c({["error"]:"Request timeout.",["callerId"]:P}));Ka("timeout")},12E4);this.N3d(t,P,ia,(Nb,kc)=>{window.clearTimeout(pb);Nb?Aa(Nb):(n.ULS.sendTraceTag(37856033,369,15,fe.c({["error"]:Tc[kc]})),Ka(kc))})}else n.ULS.sendTraceTag(37856034,344,10,fe.c({["error"]:"Caller is not allowed."})),Ka("notAllowed")})}getPrimaryIdentityInfo(t){return new Promise((P,
ia)=>{this.Vge(t)?this.Dej((Aa,Ka)=>{Aa?P(Aa):(n.ULS.sendTraceTag(37856064,369,10,fe.c({["error"]:Ka.toString()})),ia(Ka))}):(n.ULS.sendTraceTag(37856065,344,10,fe.c({["error"]:"Caller is not allowed."})),ia("notAllowed"))})}getAuthContext(t){return new Promise((P,ia)=>{const Aa=this.getAuthContextSync(t);Aa?P(Aa):ia("notAllowed")})}getAuthContextSync(t){if(this.Vge(t)){const P=new Ti.a;P.upn=v.AFrameworkApplication.fa.Ha("UserPrincipalName");P.userId=v.AFrameworkApplication.fa.Ha("LoggableUserId");
P.authority=v.AFrameworkApplication.fa.Ha("HostAuthAuthority");P.tenantId=v.AFrameworkApplication.fa.Ha("TenantId");P.isAnonymous=v.AFrameworkApplication.fa.ka("IsAnonymousUser");P.supportsAuthToken=this.vyj(t);t=v.AFrameworkApplication.fa.Ha("HostAuthType");P.authorityType="aad"===t.toLowerCase()?2:"msa"===t.toLowerCase()?1:0;return P}n.ULS.sendTraceTag(40751647,344,10,fe.c({["error"]:"Caller is not allowed."}));return null}vyj(t){const P=Ih.OAuthManagerSettings.t$a;return ve.a.zFa?P&&Ih.OAuthManagerSettings.qAh?
Array.contains(Ih.OAuthManagerSettings.qAh,t.toLowerCase()):!1:P}N3d(t,P,ia,Aa){var Ka=[];Array.add(Ka,Object.assign(new H.a,{name:"CallerId",string:P}));Array.add(Ka,Object.assign(new H.a,{name:Mc.a.aYe,string:t.correlationId}));w.a.sendTelemetryEvent(Object.assign(new I.a,{name:"Office.Online.Extensibility.SSO.FirstPartyRequestTokenFromHost",dataFields:Ka}));Ka=vh.a.create().toString();const pb="getAccessToken_"+Ka,Nb=this.waa.Ci("ComponentAttach",pb);this.nqd[pb]=Nb;const kc={};kc[Mc.a.bYe]=Ka;
kc[Mc.a.tkl]=t.resource;kc[Mc.a.ukl]=t.scope;kc[Mc.a.ixh]=v.AFrameworkApplication.fa.Ha("HostAuthType");kc[Mc.a.xkl]=v.AFrameworkApplication.fa.Ha("UserPrincipalName");kc[Mc.a.vkl]=t.silentLogin;kc[Mc.a.qkl]=t.options;kc[Mc.a.aYe]=t.correlationId;kc[Mc.a.rkl]=P;ia&&(kc[Mc.a.addinName]=ia.AddinName,kc[Mc.a.pkl]=ia.AddinTrustId);this.vbe.execute(Rc=>{this.i0d(Rc);Rc.sendMessage(ed.a.getAuthToken,kc)});this.SGb[Ka]=new xc(t,Aa)}Dej(t){const P=v.AFrameworkApplication.fa.Ha("UserName"),ia=v.AFrameworkApplication.fa.Ha("UserPrincipalName"),
Aa=v.AFrameworkApplication.fa.Ha("LoggableUserIdSpace"),Ka=new ai;Ka.email=ia;Ka.displayName=P;switch(Aa){case "OrgIdPuid":Ka.authority="AzureActiveDirectoryAccount";break;case "MsaCid":case "MsaPuid":Ka.authority="MicrosoftAccount";break;default:Ka.authority=Aa}t(Ka,null)}Nrk(t){let P=null;try{let Aa=t.Values[Mc.a.bYe];const Ka=t.Values[Mc.a.okl],pb=t.Values[Mc.a.ixh],Nb=t.Values[Mc.a.wkl];let kc=null,Rc=null;const Yc=this.SGb[Aa];if("undefined"!==typeof Yc&&Yc){var ia=[];Array.add(ia,Object.assign(new H.a,
{name:Mc.a.aYe,string:Yc.requestParameters.correlationId}));w.a.sendTelemetryEvent(Object.assign(new I.a,{name:"Office.Online.Extensibility.SSO.FirstPartyResponseTokenFromHost",dataFields:ia}));P=Yc.requestCallback;delete this.SGb[Aa];"undefined"!==typeof Ka&&Ka&&Ka.length?Rc=new Il(Ka,pb,Nb):kc=Tc[this.hfk(t)];ia="getAccessToken_"+Aa;ia in this.nqd&&(this.nqd[ia].stop(),delete this.nqd[ia]);P(Rc,kc)}else n.ULS.sendTraceTag(37856066,344,10,fe.c({["error"]:"No matching outstanding request for request ID.",
["requestId"]:Aa}))}catch(Aa){t=t.Values[Mc.a.bYe],t in this.SGb&&delete this.SGb[t],this.a1c(),n.ULS.sendTraceTag(37856067,344,10,fe.c({["error"]:Aa.message,["stack"]:Aa.stack})),P&&P(null,"generalException")}}Vge(t){var P=v.AFrameworkApplication.Enj();t=t.toLowerCase();for(const ia of P)if(t===ia.toLowerCase())return!0;P=Ih.OAuthManagerSettings.hPd;for(let ia in P)if(t===P[ia].toLowerCase())return!0;return!1}hfk(t){t=t.Values[Mc.a.skl];this.a1c();n.ULS.sendTraceTag(39068821,344,15,fe.c({["error"]:t}));
return t?-1<t.indexOf(pg.Djk)?9:-1<t.indexOf(pg.yBk)||-1<t.indexOf(pg.xBk)?12:-1<t.indexOf(pg.invalidResourceUrl)?10:-1<t.indexOf(pg.userAborted)?8:-1<t.indexOf(pg.Qjk)||-1<t.indexOf(pg.xjk)||t===pg.drl?11:-1<t.indexOf(pg.adalTimeout)?6:0:13}R2j(t,P){t=this.SNk(t.resource);n.ULS.sendTraceTag(39921882,344,50,fe.c({["callerId"]:P,["resource"]:t}))}a1c(){n.ULS.sendTraceTag(39068822,344,50,fe.c({["userAgent"]:window.navigator.userAgent}))}SNk(t){return(t?t:"").replace("://","__").replace(RegExp("\\.",
"g"),"_dot_").replace("/","\\")}}Object(k.a)(ui,"WopiIdentityManager",null,[810]);class Cg{constructor(){this.Da=null}get name(){return"Common.App.WopiIdentity"}$b(t){this.Da=t;t.register(ui,"Common.App.WopiIdentity.WopiIdentityManager").as("Common.App.WopiIdentity.IWopiIdentity").ma().oa(()=>new ui(t.Ja("Postmessage.IHostPostmessenger")))}init(){v.AFrameworkApplication.fa&&v.AFrameworkApplication.fa.jf(Object(r.a)(this,this.Om,"onFullAppSettingsReady"))}Om(){try{this.Da.resolve("Common.App.WopiIdentity.IWopiIdentity")}catch(t){n.ULS.sendTraceTag(571074327,
383,10,"Failed to initialize WopiIdentityPackage with exception: "+t)}}dispose(){}static main(){e.a.instance.Dc(new Cg)}}Object(k.a)(Cg,"WopiIdentityPackage",null,[2,3]);var hl=d(660);class yj extends hl.a{constructor(t,P){super(t,db.a.pQ(P))}Hxa(t,P){this.isEnabled()&&this.uBa(this.sLa)&&(this.pu(t),this.zB(t,P))}}Object(k.a)(yj,"InsertMediaCrossDocumentMessenger",hl.a,[995,867,106]);class Oi{getInstance(t,P){return new yj(t,P)}}Object(k.a)(Oi,"InsertMediaCrossDocumentMessengerFactory",null,[979]);
class jj{constructor(t,P,ia){this.correlationId=null;this.f5=0;this.insertPictureTelemetryEndpoint=null;this.cZd=0;this.RRh=t;this.TWb=[];this.PRh=P;this.lnf=ia.split(";")}cMb(t,P){Array.clear(this.TWb);t=this.RRh.value;t.lwl(P.xxb);t.uBa(this.PRh);t.pu(P.xxb);t.zB(P.xxb,ia=>{this.cGe(ia,P)});n.ULS.sendTraceTag(17838540,352,100,"InsertMediaFromHostDialog::ShowInsertMediaDialog : Sending opening message.");t.sendMessage(P.sJf,{["FileExtensionFilterList"]:this.lnf})}r7h(t){Array.contains(this.TWb,t)||
Array.add(this.TWb,t)}cGe(t,P){n.ULS.sendTraceTag(17838544,352,100,"InsertMediaFromHostDialog::OnInsert : Got message.");t=P.S8g(t);const ia=[];for(let Aa=0;Aa<t.length;Aa++){const Ka=t[Aa];P.sYc(Ka,this.lnf)?Array.add(ia,Ka):this.r7h(P.C3f(Ka))}ia&&ia.length?P.Nta(ia):n.ULS.sendTraceTag(20509843,352,50,"InsertMediaFromHostDialog::OnInsert : search result is empty");0<this.TWb.length&&(P=this.TWb.join(", "),n.ULS.sendTraceTag(20509844,352,15,"InsertMediaFromHostDialog::OnInsert : Unsupported files {0} were selected.",
P),this.Ihl(P))}Ihl(t){const P=new ua.StandardDialog;P.xd=0;P.cP(CommonUIStrings.l_DefaultDialogTitle,String.format(CommonUIStrings.l_OnlinePictureFromHostUnsupportedFiles,t),null)}dispose(){}}Object(k.a)(jj,"InsertMediaFromHostManager",null,[980,106]);class zh{constructor(t){this.tSh=t}getInstance(){return this.tSh}}Object(k.a)(zh,"InsertMediaFromHostManagerFactory",null,[976,977]);class bk{constructor(){this.BRb=document.createElement("iframe");this.BRb.src="about:blank";this.BRb.style.visibility=
"hidden";this.BRb.style.position="absolute";this.BRb.style.zIndex="-100"}get o8a(){return this.BRb}}Object(k.a)(bk,"InsertMediaFromHostOneDriveHostFrame",null,[978]);class Wk extends hl.a{constructor(t,P){super(t,"*"===P?P:db.a.pQ(P));this.Rpf(ed.a.insertImage);this.Rpf(ed.a.ide)}reportDocumentLoadedTime(){}}Object(k.a)(Wk,"InsertMediaFromOneDriveCrossDocumentMessenger",hl.a,[975,867,106]);var Xk=d(268),he=d(533);class ik{zGc(t){switch(t){case 1:t=8;break;case 4:t=3;break;case 2:t=0;break;default:t=
0}return t}yji(t,P){return String.format(P,this.zGc(t))}xji(t,P,ia,Aa,Ka,pb,Nb){t=this.zGc(t);const kc=Xk.a.ue(v.AFrameworkApplication.lcid).name,Rc=v.AFrameworkApplication.buildVersion;v.AFrameworkApplication.PFa("ShIns226;ShIns226cf");return String.format(P,v.AFrameworkApplication.lcid,kc,Rc,Ka,t,pb,ia,Aa,Nb)}Aji(t,P){t=this.zGc(t);const ia=v.AFrameworkApplication.buildVersion,Aa=0<ia.indexOf(".")?ia.substring(0,ia.indexOf(".")):"16";return String.format(P,v.AFrameworkApplication.lcid,v.AFrameworkApplication.lcid,
v.AFrameworkApplication.lcid,t,Aa,ia,"Video",0,0)}zji(t,P,ia,Aa,Ka,pb,Nb){const kc=Xk.a.ue(v.AFrameworkApplication.lcid).name;t=String.format(P,v.AFrameworkApplication.lcid,kc,v.AFrameworkApplication.buildVersion,ia,this.zGc(t),Aa);Ka&&(t+="&flipgrid=1");pb&&(Ka=new Ni.QueryStringBuilder(t),Ka.Ki("stream2","1"),t=Ka.toString());"defaultModal"!=Nb&&(Ka=new Ni.QueryStringBuilder(t),Ka.Ki("modalvariation",Nb),t=Ka.toString());return t}U8g(t){if(!t||!t.Values)return null;t=t.Values;if(!t)return null;
let P="";"sourceProvider"in t&&(P=t.sourceProvider||"");return Object.assign(new he.a,{Action:t.action||"",Caption:t.caption||"",ContentType:t.contentType||"",Type:t.extension||"",PageUrl:t.pageUrl||"",OriginalUrl:t.sourceUrl||"",ContentProvider:P,ThumbnailUrl:t.thumbnailUrl||"",LicenseUrl:t.licenseUrl||"",LicenseDisplayName:t.licenseDisplayName||"",Height:t.height||0,Width:t.width||0,SvgContent:t.svgContent||"",Description:t.description||"",ProviderName:t.providerName||"",StartInsertTime:t.startInsertTime||
0})}ayk(t){const P=[];if(!t||!t.Values||!t.Values.Items)return P;t=t.Values.Items;for(let Aa=0;Aa<t.length;Aa++){var ia=t[Aa];ia&&(ia=Object.assign(new he.a,{Type:ia.Extension||"",OriginalUrl:ia.SourceUrl||"",Caption:ia.caption,Description:ia.description||"",Height:ia.Height||0,Width:ia.Width||0}),Array.add(P,ia))}return P}sYc(t,P){if(!t)return!1;for(let ia=0;ia<P.length;ia++)if(0<=t.toLowerCase().indexOf(P[ia]))return!0;return!1}QDk(t){let P="";if(t)for(let ia=0;ia<t.length;ia++){const Aa=t[ia];
Aa&&(P+=String.format('<img src="{0}" width="{1}" height="{2}"></img>',Aa.OriginalUrl,Aa.Width,Aa.Height))}return P}Fmj(t){return(t=ik.u_k.exec(t))&&2<t.length?t[2].trim():""}}ik.u_k=RegExp("<iframe\\s(.*\\s)*src=[\\\"|'](.*?)[\\\"|'].*/(iframe)?>","im");Object(k.a)(ik,"InsertMediaHelper",null,[974]);var Zf=d(32);class em{constructor(t){this.DSb=Zf.a.insertHyperlink;this.Ca=t}get Ty(){return this.DSb}set Ty(t){this.DSb=t}Nta(t){try{n.ULS.sendTraceTag(21612191,352,50,"InsertOneDriveFileLinkHelper::InsertMediaCallback: Insert {0} links.",
t.length);for(let P=0;P<t.length;P++)this.Ca.La(this.Ty,2,t[P]);n.ULS.sendTraceTag(21612192,352,50,"InsertOneDriveFileLinkHelper::InsertMediaCallback: Insert {0} links.",t.length)}catch(P){n.ULS.sendTraceTag(21612193,352,10,"InsertOneDriveFileLinkHelper::InsertMediaCallback: Exception = [{0}].",P.toString())}}}Object(k.a)(em,"InsertOneDriveFileHandler",null,[971]);class nj extends em{constructor(t){super(t)}get sJf(){return ed.a.ide}get xxb(){return ed.a.MEj}S8g(t){return t&&t.Values&&"Items"in t.Values?
t.Values.Items:null}C3f(){J.a(21612194,315,!1,"InsertOneDriveFileLinkHelper::GetResultFileType: Method should never be called when for OneDrive files");return""}sYc(){return!0}Vbh(t,P,ia){t=ia(t);t.length&&(ia={},ia.Items=t,P.sendMessage(this.xxb,ia))}T8g(t){const P=[];for(let ia=0;ia<t.data.value.length;ia++){const Aa=t.data.value[ia];if(Aa){const Ka={};Ka.DisplayText=Aa.name;Ka.Url=Aa.urls.download;Ka.sourceUrl=Aa.urls.download;Ka.caption=Aa.name;Array.add(P,Ka)}}return P}}Object(k.a)(nj,"InsertOneDriveFileHelper",
em,[970,971]);class vk extends cd.a{constructor(){super()}SWe(){this.Gwc="FilePickerDialog";this.qg="<div class='FilePickerDiv' id='OpenFilePickerDiv'></div>";this.ig="PickerDialog-Livebooks";this.showDialog("",null)}N7d(){return document.getElementById("OpenFilePickerDiv")}tA(){}aaa(){}}Object(k.a)(vk,"PickerDialog",cd.a,[992]);class wk{constructor(t,P,ia){this.io=this.Cha=null;this.D2a=t;this.dHd=ia;this.fha=new Fc.a(()=>new vf.a(P.value,Object(r.a)(this,this.TDa,"getMoreInfoEventReceived")))}get NGb(){this.Cha||
(this.fha.value.Yca("InsertFromOneDrive",!0),this.io&&this.io.vR&&this.io.vR.length&&(this.Cha=this.t7d(this.io.vR)));return this.Cha}t7d(t){t=t.toLowerCase();t.endsWith("/")||(t+="/");const P=t.indexOf("/documents/");return-1!==P?t.substring(0,P+1)+"_layouts/15/onedrive.aspx":""}TDa(t){this.io||3!==t.state||(this.io=t)}start(t){if(!this.NGb)if(v.AFrameworkApplication.breadcrumbFolderUrl&&v.AFrameworkApplication.breadcrumbFolderUrl.length)this.Cha=v.AFrameworkApplication.breadcrumbFolderUrl;else{n.ULS.sendTraceTag(26071185,
352,10,"CachedGetMoreInfoResult is null, can't get OneDrive for Bussiness page url. BreadcrumbFolderUrl is null. Get more info result is null: ",!this.io);return}const P=new vk;P.SWe();const ia=P.N7d();ia?this.D2a.start((Aa,Ka)=>{P.hide();this.eIb(Aa,Ka,t)},()=>{this.dFe(P)},ia,this.Cha):n.ULS.sendTraceTag(26071186,352,10,"Picker container is null, will not show picker.")}dFe(t){t.hide();n.ULS.sendTraceTag(26071187,352,50,"User cancelled to insert picture from onedrive.")}eIb(t,P,ia){n.ULS.sendTraceTag(26071188,
352,50,"OneDriveFilePickerHelperV7::ProcessOneDriveFilePickerResponse : Response received. IsSuccess: {0}.",t);t&&P&&P.data&&P.data.value&&0<P.data.value.length?(t=this.dHd.getInstance(window.frames[0].parent,window.document.URL),ia.Vbh(P,t,Object(r.a)(ia,ia.T8g,"parseOneDriveV7Response"))):n.ULS.sendTraceTag(24134243,352,50,"Response from the OneDriveFilePicker was empty. No media to insert")}}Object(k.a)(wk,"OneDriveFilePickerHelperV7",null,[972,973]);class yl{constructor(t,P,ia,Aa){this.ia=P;this.la=
t;this.v4=this.la.Qta;this.EL=ia;this.Fpg=Aa}get PP(){return this.Fpg?this.Fpg.instance:null}vb(){this.ia.ra(E.a.z0c,lb.a.application,Object(r.a)(this,this.iza,"triggerCommandforAddinCommands"),4);this.ia.ra(E.a.F5a,lb.a.application,Object(r.a)(this,this.iza,"triggerCommandforAddinCommands"),4);this.ia.ra(E.a.YNe,lb.a.application,Object(r.a)(this,this.iza,"triggerCommandforAddinCommands"),4);this.ia.ra(E.a.nIb,lb.a.application,Object(r.a)(this,this.nIb,"queryAddInCommandsLoadStatus"),96);this.ia.ya(E.a.mWe,
lb.a.application,Object(r.a)(this,this.iza,"triggerCommandforAddinCommands"));this.ia.ra(E.a.Z$,lb.a.application,Object(r.a)(this,this.iza,"triggerCommandforAddinCommands"),64);this.ia.ra(E.a.VJb,lb.a.application,Object(r.a)(this,this.iza,"triggerCommandforAddinCommands"),64);this.ia.ya(E.a.Iqc,lb.a.application,Object(r.a)(this,this.iza,"triggerCommandforAddinCommands"));this.ia.ra(E.a.n7b,lb.a.application,Object(r.a)(this,this.iza,"triggerCommandforAddinCommands"),64);this.ia.ya(E.a.YLb,lb.a.application,
Object(r.a)(this,this.iza,"triggerCommandforAddinCommands"));this.ia.ya(E.a.V2b,lb.a.application,Object(r.a)(this,this.iza,"triggerCommandforAddinCommands"))}De(){}iza(t,P,ia,Aa,Ka){if(!this.v4)return 16;if(1===ia)return P=t===E.a.F5a&&(!this.PP||!this.PP.Goj(Ka)),t=t===E.a.F5a&&!!this.PP&&this.PP.Rbl(Ka),P||t?8:32;if(this.PP)switch(t){case E.a.z0c:this.PP.A0c(Ka);break;case E.a.F5a:this.PP.x6b(Ka);break;case E.a.nIb:this.PP.Bch(Ka);break;case E.a.mWe:this.PP.Uel();break;case E.a.Z$:this.PP.HGk(Ka);
break;case E.a.VJb:this.PP.VJb(Ka);break;case E.a.YNe:this.PP.UNk();break;case E.a.Iqc:this.PP.Iqc(Ka);break;case E.a.n7b:this.PP.n7b(Ka);break;case E.a.YLb:this.PP.YLb(Ka);break;case E.a.V2b:this.PP.V2b(Ka)}else this.EL.Kia(),this.EL.fPa(t,Ka);return 32}nIb(t,P,ia,Aa,Ka){if(!this.v4)return 16;this.PP&&this.PP.Bch(Ka);return 32}}Object(k.a)(yl,"AddinCommandsActor",null,[227]);class tg{}tg.taskPaneWidth="TaskPaneWidth";tg.sourceLocationOverrideResourceId="SourceLocationOverrideResourceId";tg.TE="TaskPaneTitle";
tg.nonPersistedSettings="NonPersistedSettings";tg.onTaskPaneClose="OnTaskPaneClose";tg.p5="OnRenderedCallback";tg.qMc="DialogIsModal";tg.uMc="DialogShowTitleBar";tg.dialogWidth="DialogWidth";tg.dialogHeight="DialogHeight";tg.dialogLeft="DialogLeft";tg.tMc="DialogRight";tg.dialogTop="DialogTop";tg.oMc="DialogBottom";Object(k.a)(tg,"PropertyNames",null,[]);var Pi;(function(t){t[t.OK=0]="OK";t[t.notReady=1]="notReady";t[t.storeDisabled=2]="storeDisabled";t[t.invokeFailure=3]="invokeFailure"})(Pi||(Pi=
{}));Object(k.b)("AddinDetailsQueryError",Pi);class Jl{constructor(t){this.spb=t}next(t){this.spb=(9301*this.spb+49297)%233280;return Math.floor(this.spb/233280*t)}}Object(k.a)(Jl,"Random",null,[]);var pm=d(213),hn=d(925),Em=d(578),fm=d(1115),qm=d(1112),Ik=d(312),Jk=d(271),Kl=d(190);class Fm{constructor(t,P,ia,Aa,Ka,pb=null){this.I2a={};this.Txc={};this.Fnb=0;this.hjf=!1;this.wPb=0;this.Oaf=!1;this.fmb=P;this.EAa=null;this.uUh=ia;this.wUh=Aa;this.AZh=Ka;this.$a=pb;t=this.oRj?Object(r.a)(this,this.yEe,
"onAddinDetailsRefreshed"):Object(r.a)(this,this.dgh,"registerIcons");this.fmb.RPk(t);appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("InsertAddInFlyout",!1));appChrome.addInApi.loadOfficeAddInIcons()}get mGf(){return this.Txc}dgh(t,P){if(P.C7)for(t=0;t<P.C7.length;t++)appChrome.addInApi.registerAddinIcon("AddinFlyoutControl"+P.C7[t].solutionId,P.C7[t].iconUrl);else n.ULS.sendTraceTag(509687429,220,10,"addinDetails is null which will lead to no icons registered")}get oRj(){return!!this.$a&&
this.$a.isChangeGateEnabled("Microsoft.Office.SharedOnline.FlyoutGeneratorRefactorEnabled")}$bl(t){0===t.WXb&&(this.wPb|=1);1===t.WXb&&(this.wPb|=2);return!!this.wPb}yEe(t,P){this.dgh(t,P);this.$bl(P)&&(appChrome.api.dispatch(appChrome.actions.updateControlEnabledDisabledState("InsertAddInFlyout",!1)),this.$a&&this.$a.isChangeGateEnabled("OverflowTelemetryForAddinButton")&&this.J1j())}fCf(){let t=this.fmb.e4b(0);if(1!==t.errorCode)return!0;t=this.fmb.e4b(1);return 1!==t.errorCode}Nzk(t){const P=[];
var ia=new Jl((new Date).getDate());for(var Aa=0;8>Aa;Aa++)Array.add(P,ia.next(t.count));ia=0;for(let Ka of t){Aa=!1;for(const pb of P)if(ia===pb){Aa=!0;break}ia++;if(Aa){let pb;(pb=Ka.addinInfo).AUP=20*pb.AUP}else if(1===Ka.addinInfo.priority){let pb;(pb=Ka.addinInfo).AUP=4*pb.AUP}else if(2===Ka.addinInfo.priority){let pb;(pb=Ka.addinInfo).AUP=2*pb.AUP}}t.Sc((Ka,pb)=>Ka.addinInfo.AUP<pb.addinInfo.AUP?1:-1);return t}YWd(t,P){const ia={};ia.width=t;ia.height=P;ia.backgroundColor="transparent";return ia}DWd(){return{"margin-top":"4px",
"max-width":"96px",height:"32px","font-size":"12px",overflow:"hidden",display:"-webkit-box","-webkit-line-clamp":"2","-webkit-box-orient":"vertical","white-space":"normal","word-break":"break-word","text-overflow":"ellipsis"}}ORc(){const t={},P={},ia={};P.root={marginTop:"12px",marginLeft:"16px",marginRight:"16px",marginBottom:"20px",width:"100%",padding:0};P.inner={margin:"-4px"};ia.root=this.YWd(100,100);ia.flexContainer={flexDirection:"column"};ia.label=this.DWd();t.galleryButtonInExpanded=ia;
t.galleryStack=P;return t}H0i(){return Object.assign(new qm.a,{Id:"AddinFlyoutMoreButton",ExternalId:"AddinFlyoutMoreButton",Icon:"QuickSearchNoCategories_16",Command:this.AZh,LabelText:CommonUIStrings.l_AddinsFlyoutSeeAllButtonText,FullIconStyle:{root:{"max-width":"16px","max-height":"16px","min-width":"16px","min-height":"16px",border:"1px solid #E0E0E0","border-radius":"6px",padding:"15px 15px 15px 15px",overflow:"hidden"}},Alt:CommonUIStrings.l_AddinsPickerGalleryButtonMoreArialText})}Avb(t,P,
ia){t=Object.assign(new qm.a,{Id:ia,ExternalId:ia,Icon:"AddinFlyoutControl"+P.solutionId,Command:t===CommonUIStrings.l_PopularAddins?this.uUh:this.wUh,LabelText:P.displayName,FullIconStyle:{root:{width:"32px",height:"32px","border-radius":"6px",overflow:"hidden",padding:"7px",border:"1px solid #E0E0E0"}},Alt:P.displayName});this.$a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DescriptionInTooltipEnabled",!1)&&(t.Alt=P.description);return t}VAk(t,P,ia){const Aa=Object.assign(new fm.a,{SectionId:t,
Title:t,GalleryButtons:[]});for(let Ka=0;Ka<ia;Ka++)Array.add(Aa.GalleryButtons,this.Avb(t,P[Ka],this.I2a[P[Ka].solutionId]));return Aa}n5b(){var t=[];const P=this.fmb.e4b(0);Array.addRange(t,P.C7);const ia=this.fmb.e4b(1);Array.addRange(t,ia.C7);let Aa=t.length;v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutTelemetryEnabled",!0)&&n.ULS.sendTraceTag(509687428,220,15,"The MRU list number is {0}, myAddins: {1}|{2}, adminManaged: {3}|{4}",Aa,Pi[P.errorCode],
P.C7.length,Pi[ia.errorCode],ia.C7.length);t.sort((hd,se)=>{hd=Kl.d(hd.displayName);se=Kl.d(se.displayName);return ab.a.localeCompare(hd,se)});const Ka=6<Aa;Ka&&(Aa=5);if(this.$a.isChangeGateEnabled("Microsoft.Office.SharedOnline.CustomizablePopularAddinsEnabled"))for(var pb=0;pb<Aa;pb++)this.ryf(t[pb]);else for(pb=0;pb<Aa;pb++)if(!(t[pb].solutionId in this.I2a)){var Nb="AddinGalleryButton"+this.Fnb.toString();this.I2a[t[pb].solutionId]=Nb;this.Txc[Nb]=t[pb].solutionId;this.Fnb++}let kc=[];pb=null;
if(this.EAa)kc=this.EAa;else if(pb=this.fmb.e4b(2),0===pb.errorCode)if(this.$a.isChangeGateEnabled("Microsoft.Office.SharedOnline.CustomizablePopularAddinsEnabled"))pb.C7.forEach(hd=>{-1!==hd.addinInfo.priority&&(this.ryf(hd),kc.push(hd))});else for(kc=pb.C7,pb=0;pb<kc.length;pb++)kc[pb].solutionId in this.I2a||(Nb="AddinGalleryButton"+this.Fnb.toString(),this.I2a[kc[pb].solutionId]=Nb,this.Txc[Nb]=kc[pb].solutionId,this.Fnb++);pb=!0;kc.length||(pb=!1);Nb=0;if(pb&&(Nb=t.length?3>=t.length?9:6:12,
kc=this.Sdi(kc,t),Nb>kc.length&&(Nb=kc.length),v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutTelemetryEnabled",!0)&&!this.hjf)){var Rc="",Yc="";for(let hd=0;hd<kc.length&&hd<Nb;hd++)Rc+=kc[hd].displayName,Rc+=",",Yc+=kc[hd].solutionId,Yc+=",";n.ULS.sendTraceTag(509673818,220,15,"The popular list number is {0}, addin name list:{1}, addin solution id list:{2}",Nb,Rc,Yc);this.hjf=!0}Rc=Object.assign(new Jk.a,{Id:"FooterSection",ControlsId:"FooterSection.Controls",
ControlList:[]});Yc=Object.assign(new pm.a,{ExternalId:"InsertMoreAddInsFromFooter",AriaDescription:CommonUIStrings.l_AddinsPickerFooterButtonMoreArialText});Array.add(Rc.ControlList,Yc);appChrome.api.dispatch(appChrome.actions.setControlLabel("InsertMoreAddInsFromFooter",CommonUIStrings.l_AddinPickerButtonMore));Rc=Object.assign(new Ik.a,{Id:"Ribbon.AddinPicker",MenuSectionList:[],MenuFooterSection:Rc,UpdateDynamically:!0});2!==P.errorCode||t.length?3===P.errorCode||3===ia.errorCode?(n.ULS.sendTraceTag(509687426,
220,10,"dataProvider invoke error hit"),t=this.GWf("Common",CommonUIStrings.l_AddinPickerGeneralError),Array.add(Rc.MenuSectionList,t)):(0<Aa&&this.dHf(Rc,t,Aa,"MRUAddins",CommonUIStrings.l_MyAddinSection,Ka),pb&&this.dHf(Rc,kc,Nb,"PopularAddins",CommonUIStrings.l_PopularAddins)):(n.ULS.sendTraceTag(509687427,220,10,"store disabled hit"),t=this.GWf("StoreDisabled",CommonUIStrings.l_AddinPickerDisableError),Array.add(Rc.MenuSectionList,t));return Rc}ryf(t){if(!(t.solutionId in this.I2a)){const P="AddinGalleryButton"+
this.Fnb.toString();this.I2a[t.solutionId]=P;this.Txc[P]=t.solutionId;this.Fnb++}}GWf(t,P){const ia=Object.assign(new Jk.a,{Id:"ErrorSection",ControlsId:"ErrorSection.Controls",ControlList:[]});t=Object.assign(new hn.a,{Id:"ErrorView",ExternalId:"ReloadAddInPicker",IconName:t,Label:P});Array.add(ia.ControlList,t);return ia}Sdi(t,P){var ia=new ha.a;for(let Aa=0;Aa<t.length;Aa++)ia.add(t[Aa]);this.EAa||(8<ia.count&&(ia=this.Nzk(ia)),this.EAa=ia.toArray());for(t=0;t<this.EAa.length;t++)for(ia=0;ia<P.length;ia++)if(this.EAa[t].solutionId.toLowerCase()===
P[ia].solutionId.toLowerCase()){Array.remove(this.EAa,this.EAa[t--]);break}return this.EAa}dHf(t,P,ia,Aa,Ka,pb=!1){const Nb=Object.assign(new Jk.a,{Id:Aa+"Section",ControlsId:Aa+"Section.Controls",ControlList:[]});Aa=Object.assign(new Em.a,{Id:Aa+"GalleryControl",ExternalId:Aa+"GalleryControl",GalleryStyle:this.ORc(),Width:3,Type:4,GallerySections:[]});Array.add(t.MenuSectionList,Nb);Array.add(Nb.ControlList,Aa);t=this.VAk(Ka,P,ia);pb&&Array.add(t.GalleryButtons,this.H0i());Aa.GallerySections.push(t)}Tgd(t){if(t)try{t.MenuItems=
this.n5b()}catch(P){n.ULS.sendTraceTag(509687425,220,10,"GetReactGalleryMenu hit exception "+(P?P.toString():""))}else n.ULS.sendTraceTag(509687424,220,10,"PopulateMenu menuProps is null")}dispose(){}J1j(){if(!this.Oaf&&this.Fmd){var t=appChrome.selectors.getSelectedTabId();t&&Kl.a(t,"Home")&&((t=document.getElementById("InsertAddInFlyout"))&&"none"!==window.getComputedStyle(t,"").display||n.ULS.sendTraceTag(509368032,344,15,"Addin button is in overflow"),this.Oaf=!0)}}get Fmd(){return!!window.appChrome&&
!!appChrome.selectors}}Object(k.a)(Fm,"AppsFlyoutGenerator",null,[106]);var ck=d(979),Ui=d(217);class Ch{}Ch.Z2b="extId";Ch.N_b="ComponentType";Ch.pW="ComponentId";Ch.dkc="OptionalProps";Object(k.a)(Ch,"ActionPropertyNames",null,[]);var Ba=d(40),il=d(82);class Gg{constructor(){this.idField=null;this.stateField=0}}Object(k.a)(Gg,"CT_OsfBackgroundAppData",null,[]);class zj{constructor(){this.currentStoreTypeField=this.bkgdDataField=this.assetStoreIdField=this.assetIdField=this.appVersionField=null;
this.heightField=0;this.heightFieldSpecified=!1;this.idField=null;this.isAddinCommandsField=!1;this.storeIdField=null;this.widthField=this.targetTypeField=0;this.widthFieldSpecified=!1}}Object(k.a)(zj,"CT_OsfInsertionInfo",null,[]);var Mf=d(978),Ll=d(980),nc=d(331);class Tm{constructor(t,P,ia,Aa,Ka,pb,Nb,kc,Rc,Yc,hd,se){this.nrb=0;this.y9f=!1;this.G3j="g_InstallOrigin";this.DTg=new Map([["InsertAddInsFromBackstage","Backstage"],["InsertAddIns","Ribbon"],["LaunchAddinDialogFromTellMe","TellMe"]]);
this.ltj=()=>this.eQd&&!v.AFrameworkApplication.fa.ka("AppsForOfficeThirdPartyIsDisabled")&&this.qra&&this.qra.fCf()?32:8;this.Qsj=(Ae,we,Jf,Yh,Me)=>{if(2!==Jf)return this.qra&&this.qra.fCf()?32:8;if(!this.qra)return 8;this.qra.Tgd(Me);return 32};this.Jrj=(Ae,we,Jf,Yh,Me)=>{if(!this.v4||!Me)return 8;if(1===Jf)return this.Kd?32:8;if(!this.Kd)return this.nrb||(this.nrb=window.performance.now()),this.EL.Kia(),this.EL.fPa(Ae,Me),8;Ae=Me[Ch.Z2b];Me=Me[Ch.dkc].optionalProperties;we={};we.TE=Me.bLh;we.assetId=
Ae.getId();we.p5=Me.QKh;we.nonPersistedSettings=Me.mMc;we.ZLa=!0;we.qMc=Me.oGl;we.uMc=Me.rGl;we.dialogWidth=Me.tGl;we.dialogHeight=Me.nGl;we.dialogLeft=Me.pGl;we.tMc=Me.qGl;we.dialogTop=Me.sGl;we.oMc=Me.mGl;this.Kd.PVk(we);return 32};this.Duj=(Ae,we,Jf,Yh,Me)=>{if(2!==Jf)return 32;if(!this.Kd)return 8;we=Me[Ch.Z2b];Jf=Me[Ch.dkc].optionalProperties;Ae={};Ae.TE=Jf.bLh;Ae.assetId=we.getId();Ae.sourceLocationOverrideResourceId=Jf.IGl;Ae.p5=Jf.QKh;Ae.nonPersistedSettings=Jf.mMc;Ae.ZLa=!0;we=this.Kd.zvb(Ae);
we=this.Kd.mQ(we);Me=Me[Ch.N_b];return we&&"taskpane"==Me.toLowerCase()?(this.Kd.$5k(we.instanceId,Ae),32):8};this.Krj=(Ae,we,Jf,Yh,Me)=>{if(2!==Jf)return 32;if(!this.qra)return 8;we=this.qra.mGf[Me.SourceControlId];if(!we)return n.ULS.sendTraceTag(509383066,220,10,"SourceControlId (solutionId) is empty in LaunchAddinInstallDialog"),8;this.Kd?this.Kd.jXj(we):(this.EL.Kia(),this.EL.fPa(Ae,Me));return 32};this.Irj=(Ae,we,Jf,Yh,Me)=>{if(2!==Jf)return 32;if(!this.qra)return 8;we=this.qra.mGf[Me.SourceControlId];
if(!we)return n.ULS.sendTraceTag(509383065,220,10,"SourceControlId (solutionId) is empty in LaunchAddinInstallDialog"),8;this.Kd?this.Kd.B0c(we):(this.EL.Kia(),this.EL.fPa(Ae,Me));return 32};this.o8f=(Ae,we,Jf,Yh,Me)=>{we=this.ua.Ba;Yh=this.Vb.Cf;if(!(this.v4&&we&&Yh)||this.ff.$c(we))return 8;if(!this.eQd)return n.ULS.sendTraceTag(512288602,802,50,"Web add-in insert blocked by doc IRM"),8;if(1===Jf)return 32;$c.a("LogAddinInstallOriginEnabledForPPT")&&(Jf=Me?Me.SourceControlId:void 0,window[this.G3j]=
this.DTg.get(Jf)?this.DTg.get(Jf):"Unknown");this.Kd?$c.a("UpdateLaunchInsertDialog")?(Ae=Me?Me.SourceControlId:void 0,Me=Me?Me.CommandValueId:null,"InsertMoreAddInsFromFooter"===Ae?this.Kd.Jmg("{98143890-AC66-440E-A448-ED8771A02D52}"):"AddinFlyoutMoreButton"===Ae?this.Kd.Jmg("0"):"LaunchAddinDialogFromTellMe"==Ae&&Me?this.Kd.sXj(Me):this.Kd.launchInsertDialog()):this.Kd.launchInsertDialog():(this.EL.Kia(),this.EL.fPa(Ae,Me));return 32};this.N$d=(Ae,we,Jf,Yh,Me)=>{if(!this.eQd)return n.ULS.sendTraceTag(512288601,
802,50,"Web add-in insert blocked by doc IRM"),16;if(!Me)return 8;if(0===Me.targetType)return this.$Ej(Me,Ae);if(1===Me.targetType){if(this.ff.$c(this.Vb.Cf))return 16;this.O7j?Me.isAddinCommands?$c.a("AddinCommandsActionTypeUndefinedCheck")?void 0===Me.addinCommandsActionType||null===Me.addinCommandsActionType||0===Me.addinCommandsActionType?this.TNb(Me):1===Me.addinCommandsActionType?this.EWc(Me):n.ULS.sendTraceTag(512288600,802,50,"HandleInsertAppForOfficeUpload invalid AddinCommandsActionType of "+
Me.addinCommandsActionType.toString()):0===Me.addinCommandsActionType?this.TNb(Me):1===Me.addinCommandsActionType&&this.EWc(Me):(Ae={},Ae.solutionId=Me.solutionId,Ae.version=Me.version,Ae.storeType=Me.storeType,Ae.storeId=Me.storeId,Ae.targetData=Me,this.Kd.vl.isAddinCommandsAsync(Ae,(mh,af,sk)=>{af?this.TNb(sk.targetData):this.EWc(sk.targetData);mh||(mh=sk.targetData,n.ULS.sendTraceTag(512288599,220,10,"Checking AddinCommands fails for {0} from {1}",Telemetry.PrivacyRules.GetPrivacyCompliantId(mh.solutionId,
mh.storeType,mh.assetId,null,null,mh.storeId),mh.storeType))})):this.EWc(Me);Mf.a.add(Me.solutionId,Me.targetType,Me.storeId,Me.storeType,Me.version);return 32}return 8};this.la=t;this.v4=this.la.pptEditInsertAppsForOfficeEnabled;this.O7j=this.la.Qta;this.Hs=P;this.ia=ia;this.Vb=Aa;this.ua=Ka;this.d7c=Nb;this.Jb=pb;this.EL=kc;this.Zc=Rc;this.Pb=Yc;this.ff=hd;this.Wj=se}get eQd(){return this.v4&&v.AFrameworkApplication.tia}vb(){this.ia.ra(hb.a.Txb,lb.a.application,this.o8f,516);this.ia.ra(hb.a.pWc,
lb.a.application,this.N$d,4);this.ia.ya(hb.a.mVc,lb.a.application,Object(r.a)(this,this.crj,"handleHideAppForOfficeTaskPane"));this.ia.ra(hb.a.kib,lb.a.application,Object(r.a)(this,this.Ytj,"handleRenderAppForOfficeTaskPane"),4);this.ia.ra(hb.a.sZa,lb.a.application,Object(r.a)(this,this.sZa,"queryEntitledAppsForOffice"),96);this.ia.ya(hb.a.Ufa,lb.a.application,Object(r.a)(this,this.g9f,"handleShowFirstPartyTaskPane"));this.ia.ya(hb.a.Ssb,lb.a.application,Object(r.a)(this,this.Mpj,"handleCloseAppsForOfficeTaskPane"));
this.ia.ya(E.a.Hfl,lb.a.application,Object(r.a)(this,this.Juj,"handleShowExtensionTaskPane"));this.ia.ya(E.a.uti,lb.a.application,Object(r.a)(this,this.Npj,"handleCloseExtensionTaskPane"));this.ia.ya(E.a.OYk,lb.a.application,Object(r.a)(this,this.juj,"handleRestartExtensionTaskPane"));this.ia.ya(hb.a.sFh,lb.a.application,Object(r.a)(this,this.wvj,"handleUpdateBackgroundAppData"));$c.a("EnableSDXDialog2")&&this.ia.ya(E.a.zXj,lb.a.application,this.Jrj);$c.a("EnabledTellMeAddinOnPPTO")&&(this.ia.ra(E.a.Ncg,
lb.a.application,this.N$d,4),this.ia.ra(E.a.$le,lb.a.application,this.o8f,4));this.etf&&(this.ia.ya(E.a.B0c,lb.a.application,this.Irj),this.ia.ya(E.a.jde,lb.a.application,this.N$d),this.ia.ya(E.a.Nmg,lb.a.application,this.Krj),this.ia.ya(E.a.FGk,lb.a.application,this.ltj),this.ia.ya(E.a.BAk,lb.a.application,this.Qsj),appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("InsertAddInFlyout",!1)));$c.a("EnableSetTitleExtensionTaskPane")&&this.ia.ya(E.a.l$k,lb.a.application,this.Duj)}get qra(){if(!this.etf)return null;
if(!this.Kd)return this.EL.Kia(),n.ULS.sendTraceTag(509383064,220,10,"appForOfficeManager is null"),null;this.lqg||(this.Kd.btf?this.lqg=new Fm(this.ia,this.Kd.btf,E.a.B0c.toString(),E.a.Nmg.toString(),hb.a.Txb.toString()):n.ULS.sendTraceTag(509379480,220,10,"this.appForOfficeManager.addinDetailsProvider is null"));return this.lqg}get etf(){return v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GetAddinFlyoutEnabled",!1)&&v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",
!1)}De(){}get Kd(){return this.Zc.instance}Juj(t,P,ia,Aa,Ka){if(2!==ia)return 32;const pb=Ka[Ch.Z2b];Ka=Ka[Ch.dkc];const Nb={};Nb.TE=Ka.optionalProperties[tg.TE];Nb.assetId=pb.getId();Nb.p5=Ka.optionalProperties[tg.p5];Nb.nonPersistedSettings=Ka.mMc;Nb.ZLa=!0;return this.g9f(t,P,ia,Aa,Nb)}Npj(t,P,ia,Aa,Ka){if(2!==ia)return 32;t=Ka[Ch.Z2b];Ka=Ka[Ch.dkc];P={};P.TE=Ka.optionalProperties[tg.TE];P.assetId=t.getId();P.sourceLocationOverrideResourceId=Ka.optionalProperties[tg.sourceLocationOverrideResourceId];
P.p5=Ka.optionalProperties[tg.p5];P.nonPersistedSettings=Ka.mMc;P.ZLa=!0;Ka=this.Kd.zvb(P);return(Ka=this.Kd.mQ(Ka))&&this.Kd.hUd(Ka.instanceId)?32:8}juj(t,P,ia,Aa,Ka){if(2!==ia)return 32;t=Ka[Ch.Z2b];P=Ka[Ch.dkc];Ka={};Ka.TE=P.optionalProperties[tg.TE];Ka.assetId=t.getId();Ka.sourceLocationOverrideResourceId=P.optionalProperties[tg.sourceLocationOverrideResourceId];Ka.p5=P.optionalProperties[tg.p5];Ka.nonPersistedSettings=P.mMc;Ka.ZLa=!0;t=this.Kd.zvb(Ka);return(t=this.Kd.mQ(t))?(this.Kd.Gfh(t.instanceId,
Ka),32):8}crj(t,P,ia,Aa,Ka){if(!this.v4)return 16;if(!Ka)return 8;if(1===ia)return 32;t=Object(R.a)(String,Ka);if(!t||!t.length)return 8;if((P=this.Kd.dPc(t))&&P.taskpane){if(this.Kd.aua(t))return this.Kd.MKb(t,!1),32;if(P.ap&&OSF.OsfControl.isFirstPartyStoreString(P.ap.storeType))return this.Kd.FZd(t),this.Kd.YIk(t),32;P=P.taskpane.ownerAddinSolutionId;if(this.Kd.WGj(t)||P)this.Kd.FZd(t);else if(P=this.Kd.uQc(),ia=this.Pb.Nc(P),t=this.Kd.$Tf(t)){ia.Qk(Object(R.a)(il.a,t));t=this.Jb.zd(4,void 0,void 0,
void 0,!0);try{t.nc(P),ia.Mi()}finally{t&&t.dispose()}}}return 32}Ytj(t,P,ia,Aa,Ka){if(!this.v4)return 16;if(!Ka)return 8;if(1===ia)return 32;P=Object(R.a)(String,Ka);if(!P||!P.length)return 8;this.Kd?this.Kd.kib(P):this.EL.fPa(t,Ka);return 32}g9f(t,P,ia,Aa,Ka){if(!this.v4)return 16;if(!Ka)return 8;if(1===ia)return 32;if(this.Kd){if(!Ka||!Ka.assetId||!v.AFrameworkApplication.eke(Ka.assetId))return 8;Ka.nonPersistedSettings||(Ka.nonPersistedSettings={});Ka.nonPersistedSettings.ShowFeedback=v.AFrameworkApplication.OE;
!this.y9f&&this.nrb&&(this.y9f=!0,t=window.performance.now()-this.nrb,n.ULS.sendTraceTag(512288597,220,50,"Apps for office load time {0}",t));t=this.Kd.zvb(Ka);if(t=this.Kd.mQ(t))return this.Kd.Gfh(t.instanceId,Ka),32;this.Kd.AVk(Ka)}else this.nrb||(this.nrb=window.performance.now()),this.EL.Kia(),this.EL.fPa(t,Ka);return 32}wvj(t,P,ia,Aa,Ka){if(1===ia)return this.v4?32:8;if(!this.v4)return 16;if(!(Ka&&Ka.Yv&&-1!==Ka.Yv.state&&Ka.Yv.Xxa&&this.Kd))return 8;t=this.Kd.qDa(Ka.ap.id);if(!t)return 8;P=
this.Jb.zd(4,void 0,void 0,void 0,!0);try{P.nc(t),t.setValue(Yb.a.Brb,Ka.Yv.state),t.setValue(Yb.a.c6a,Ka.Yv.Xxa),t.setValue(Ba.a.mYb,Ka.ap.storeType)}finally{P&&P.dispose()}return 32}Mpj(t,P,ia,Aa,Ka){return this.v4?Ka?1===ia?32:this.Kd&&Ka&&Ka.length?this.Kd.hUd(Ka)?32:8:8:8:16}sZa(t,P,ia,Aa,Ka){var pb;if(2===ia){P=Ka.callback;if(!P)return 16;$c.a("AllowQueryAddinsForStoreTypes")?this.Kd?this.SGk(P,null!==(pb=Ka.storeType)&&void 0!==pb?pb:OSF.StoreTypeEnum.MarketPlace):(Ka=Object.assign({},Ka),
this.EL.fPa(t,Ka)):this.RGk(P)}return 32}SGk(t,P){const ia=new ck.a;ia.callbackFunc=t;ia.storeType=P;ia.fromInsertDialog=!1;ia.refresh="true"===ib.a.instance.getItem(Ui.a.yOd);this.Kd.vl.queryEntitlementDetails(ia)}RGk(t){const P=new ck.a;P.callbackFunc=t;P.storeType=OSF.StoreTypeEnum.MarketPlace;P.fromInsertDialog=!1;P.refresh="true"===ib.a.instance.getItem(Ui.a.yOd);this.Kd.vl.queryEntitlementDetails(P)}TNb(t){const P=new ha.a;P.add(t);t={};t[Ui.a.aGc]=P;t[Ui.a.A7]=3;this.ia.La(E.a.z0c,2,t)}$Ej(t,
P){const ia=this.ua.Ba;if(!ia||this.ff.$c(ia))return 16;if(!this.Wj.JF(ia,1))return this.Wj.hG(ia),16;try{return this.Pcg(t,ia,ia.Cb,P)}catch(Aa){return 8}}Pcg(t,P,ia,Aa){ia=P.hEi(t.width,t.height,P.Pt()+1);Ll.a.crf(ia,t,this.Kd);this.Hs.zW([Object(R.a)(4,ia)],P,Aa);Mf.a.add(t.solutionId,t.targetType,t.storeId,t.storeType,t.version);return 32}EWc(t){if(!this.Kd.mQ(t.solutionId)){var P=this.Kd.qDa(t.solutionId),ia=this.Kd.uQc();if(P){ia=new nc.a(P);if(!ia.visibility){let Aa=this.Jb.zd(4,void 0,void 0,
void 0,!0);try{Aa.nc(P),P.setValue(Ba.a.oYb,!0),P.setValue(Ba.a.mYb,t.storeType)}finally{Aa&&Aa.dispose()}}this.Kd.kib(ia.id)}else{P=Ll.a.QAi(this.d7c.value,t,this.Kd);t=this.Jb.zd(4,void 0,void 0,void 0,!0);try{t.nc(ia),Ll.a.M3h(ia,P)}finally{t&&t.dispose()}}}}}Object(k.a)(Tm,"AppForOfficeActor",null,[227]);var Nc=d(208),qf=d(85),gm=d(166),Rh=d(41),Vf=d(1011),jn=d(294);class kn{constructor(t,P,ia,Aa,Ka,pb,Nb,kc,Rc,Yc,hd,se,Ae,we,Jf,Yh,Me,mh,af,sk,Nj,an,oo,Ho,Pn,Io){this.hcc=null;this.iqg=!1;this.hWa=
null;this.xvg=$c.a("PartialDoc.SkipCutCopyCallout");if(!Io)throw Error.argumentNull("calloutNotificationAdapter");this.ia=t;this.ff=P;this.Fa=ia;this.pa=Aa;this.nt=Ka;this.rE=pb;this.MRg=Nb;this.h7j=kc;this.yak=Rc;this.M2c=Yc;this.Qb=hd;this.fdc=mh.iag;this.Iu=se;this.qc=sk;this.n3j=mh.powerPointEditorDownloadACopyUiIsEnabled;this.fak=Ae;this.r3c=we;this.Xa=Me;this.oXa=!mh.wg;this.XPg=Nj;this.HSg=oo;this.lDg=Ho;this.vw=Pn;this.Htg=!mh.printingEnabled||af.ka("DisablePrint");this.Itg=Jf;this.hl=Yh;
this.z5j=af.Ha("DownloadPdfFromPodsUrl");this.m_printUrl=af.Ha("PrintPdfFromPodsUrl");this.y5j=af.Ha("DownloadOdpFromPodsUrl");this.Ztg=af.Ha("DownloadImagesFromPodsUrl");this.Rak=af.ka("UseToastForDeferredBlobsEnabled");this.Kbk=mh.pptAppendFileNameToQueryUrlForDocumentOperationsActor;t=(v.AFrameworkApplication.fileName||"").toLowerCase();mh.wg&&mh.qKj?(this.iqg=!0,this.hcc=af.Ha("DownloadACopyPodsUrl")):!mh.wg&&mh.tRj&&(t.endsWith(".pptx")||t.endsWith(".ppsx"))?this.hcc=this.Kek():this.hcc=v.AFrameworkApplication.eRa;
this.Vte=an;this.p8j=mh.iZc;this.swa=A.a.instance.Ja("Common.ISystemInitiatedFeedback");this.U7j=af.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CollabCornerFloodgateDownloadCopy",!1);this.FL=Io}vb(){const t=!!this.Itg&&!this.XPg();O.a.J(512500629,801,50,"Limited printing access: {0}, Message shown: {1}",this.Htg,t);this.Htg?t&&this.hl.hgl(this.Itg):(this.ia.ya(hb.a.print,lb.a.application,Object(r.a)(this,this.gtj,"handlePrint")),this.ia.ya(hb.a.downloadACopy,lb.a.application,Object(r.a)(this,
this.downloadACopy,"downloadACopy")),this.ia.ya(hb.a.Y1b,lb.a.application,Object(r.a)(this,this.Y1b,"downloadACopyAsPdf")),this.ia.ya(hb.a.X1b,lb.a.application,Object(r.a)(this,this.X1b,"downloadACopyAsOdp")),this.ia.ya(hb.a.Z1b,lb.a.application,Object(r.a)(this,this.Z1b,"downloadAsImages")),this.ia.ya(hb.a.PRe,lb.a.application,Object(r.a)(this,this.PRe,"saveSlidesAsImages")),this.ia.ya(hb.a.vlc,lb.a.application,Object(r.a)(this,this.jDk,"pptoSaveACopy")),this.ia.ya(hb.a.FJe,lb.a.application,Object(r.a)(this,
this.kDk,"pptoSaveAsToHost")),this.ia.ya(hb.a.GJe,lb.a.application,Object(r.a)(this,this.lDk,"pptoSaveToSharePoint")),this.ia.ya(hb.a.uKe,lb.a.application,Object(r.a)(this,this.itj,"handlePrintNotes")),this.ia.ya(hb.a.sKe,lb.a.application,Object(r.a)(this,this.htj,"handlePrintHandouts")));this.ia.ya(E.a.l_a,lb.a.application,Object(r.a)(this,this.l_a,"saveFileChange"));this.MRg&&this.ia.ra(hb.a.hid,lb.a.application,Object(r.a)(this,this.hid,"querySaveStatus"),96);this.Vte.execute(Object(r.a)(this,
this.njc,"onHostPostmessengerCreated"))}De(){const t=this.Fa.Gc(Fb.a.Qki);t.bindAction(eb.KeyInputManager.Na(wa.a.Vlb,eb.KeyInputManager.Le),hb.a.print);t.bindAction(eb.KeyInputManager.Na(wa.a.nMa,eb.KeyInputManager.Le),E.a.qe);t.bindAction(eb.KeyInputManager.Na(wa.a.evd,eb.KeyInputManager.Le),E.a.qe);t.bindAction(eb.KeyInputManager.Na(wa.a.cZ,eb.KeyInputManager.Le),E.a.qe);t.bindAction(eb.KeyInputManager.Na(wa.a.cZ,eb.KeyInputManager.Le|4),E.a.qe)}kDk(t,P,ia){return this.IRe(ia,E.a.gKb,"SaveAsToHost")}jDk(t,
P,ia){return this.IRe(ia,E.a.Ioc,"SaveACopy")}lDk(t,P,ia){return this.IRe(ia,E.a.Nib,"SaveToSharePoint")}IRe(t,P,ia){if(1===t)return v.AFrameworkApplication.EJ||v.AFrameworkApplication.GQ?8:this.ia.processAction(P,1);if(this.vw.hasDeferredContent()&&(O.a.J(512500628,843,15,"{0} is triggered while document has deferred content",ia),!this.Rak))return this.vw.qWe(ia,null,null),8;this.qqb(ia);return this.Xa.xda?(O.a.J(512500627,801,50,"DocumentOperationsActor:SaveAsImpl - Inline Repair Case , ActionId: {0}",
P),this.ia.La(hb.a.iKb,2,P)):this.ia.processAction(P,2)}downloadACopy(t,P,ia,Aa,Ka){if(this.ff.$c(this.nt))return 16;if(1===ia)return!this.qc.Lj()||v.AFrameworkApplication.GQ?8:kn.kSf()?32:this.Ksb();if(this.vw.hasDeferredContent())return O.a.J(512500626,843,15,"DownloadACopy is triggered while document has deferred content"),this.xvg&&this.FL.qZd(),this.vw.qWe("DownloadACopy",new Vf.a,()=>{this.M0e(Ka)}),this.vw.bra("DownloadACopyRequestedTime",Rh.a.nf(new Date)),8;this.pa.Qh();this.Fa.Ed();O.a.J(512500625,
801,50,"PPT save and download a copy");this.Xa.xda?this.M0e(Ka):(this.Iu.show(!0,t),this.rE.j3(!1,this.oXa,()=>{this.M0e(Ka)},Object(r.a)(this,this.Yxa,"saveFailureCallback")));this.qqb("DownloadACopy");return 32}M0e(t){this.Iu.hide();let P;P=kn.kSf()?v.AFrameworkApplication.eRa:this.iqg?this.crb(this.hcc):this.hcc;t&&t.FileDownloadUrl&&(P=t.FileDownloadUrl.toString());this.k0j();this.lDg&&!this.lDg()&&this.HSg&&this.HSg("3555692408")?this.hWa.sendMessage(ed.a.download,{}):this.n3j?(this.fak.Pgl(P),
this.vw.bra("DownloadModalTime",Rh.a.nf(new Date))):this.Qb.MO(!0,P,!0)}k0j(){this.U7j&&this.swa&&this.swa.execute(t=>{t.logActivity("CollabCornerSurveyLogDownloadACopyCommandActivity","CollabCornerFloodgateSurveysIsEnabled")})}hid(t,P,ia,Aa,Ka){t="";this.MRg&&(t=this.h7j.SW(this.nt)?String.format(ResourceStrings.L_SavingStatus):this.fdc?String.format(CommonUIStrings.l_SavedToStatus,this.fdc):String.format(ResourceStrings.L_SavedStatus));Ka[kd.a.Value]=t;return 32}gtj(t,P,ia){return this.tKe(ia,0,
t)}itj(t,P,ia){return this.tKe(ia,8,t)}htj(t,P,ia){return this.tKe(ia,4,t)}tKe(t,P,ia){if(this.ff.$c(this.nt))return 16;if(1===t)return!this.qc.Lj()||v.AFrameworkApplication.GQ?8:this.Ksb();if(this.XPg())return O.a.J(512500624,328,50,"Printing not allowed for IRM protected documents"),16;O.a.J(512500623,328,50,"PPT Editor print. PublishOption: {0}",P);this.pa.Qh();this.Fa.Ed();this.Xa.xda?this.Jmh(P):(this.Iu.show(!0,ia),this.rE.j3(!1,this.oXa,()=>{this.Jmh(P)},Object(r.a)(this,this.Yxa,"saveFailureCallback")));
this.qqb("Print-"+ia);return 32}Jmh(t){this.Iu.hide();this.yak.print(this.Xa.presentationId.string,this.crb(this.m_printUrl),t)}Y1b(t,P,ia){if(this.ff.$c(this.nt))return 16;if(1===ia)return!this.qc.Lj()||v.AFrameworkApplication.GQ?8:this.Ksb();this.r3c.TNf=new Date;this.pa.Qh();this.Fa.Ed();this.Xa.xda?this.Gmh():(this.Iu.show(!0,t),this.rE.j3(!1,this.oXa,()=>{this.Gmh()},Object(r.a)(this,this.Yxa,"saveFailureCallback")));this.qqb("DownloadACopyAsPDF");return 32}Gmh(){this.Iu.hide();this.r3c.Omh=
new Date;this.M2c.convert(this.Xa.presentationId.string,1,this.crb(this.z5j))}Z1b(t,P,ia){if(this.ff.$c(this.nt))return 16;if(1===ia)return!this.qc.Lj()||v.AFrameworkApplication.GQ?8:this.Ksb();this.pa.Qh();this.Fa.Ed();this.Xa.xda?this.Hmh():(this.Iu.show(!0,t),this.rE.j3(!1,this.oXa,()=>{this.Hmh()},Object(r.a)(this,this.Yxa,"saveFailureCallback")));this.qqb("DownloadAsImages");return 32}PRe(t,P,ia){if(this.ff.$c(this.nt))return 16;if(1===ia)return!this.qc.Lj()||v.AFrameworkApplication.GQ?8:this.Ksb();
this.pa.Qh();this.Fa.Ed();this.Xa.xda?this.SNf():(this.Iu.show(!0,t),this.rE.j3(!1,this.oXa,()=>{this.SNf()},Object(r.a)(this,this.Yxa,"saveFailureCallback")));this.qqb("SaveSlidesAsImages");return 32}Hmh(){this.Iu.hide();this.M2c.convert(this.Xa.presentationId.string,2,this.crb(this.Ztg))}SNf(){this.Iu.hide();var t=this.crb(this.Ztg),P=this.pa.We();0<P.length&&(P=gm.c(P,ia=>ia.sid.toString()).join(","),t=new Ni.QueryStringBuilder(t),t.Ki(qf.a.xil,P),this.M2c.convert(this.Xa.presentationId.string,
2,t.toString()))}X1b(t,P,ia){if(this.ff.$c(this.nt))return 16;if(1===ia)return!this.qc.Lj()||v.AFrameworkApplication.GQ?8:this.Ksb();if(this.vw.hasDeferredContent())return this.xvg&&this.FL.qZd(),O.a.J(512500622,843,15,"DownloadACopyAsOdp is triggered while document has deferred content"),this.vw.qWe("DownloadACopyAsOdp",new Vf.a,()=>{this.JRe()}),8;this.pa.Qh();this.Fa.Ed();this.Xa.xda?this.JRe():(this.Iu.show(!0,t),this.rE.j3(!1,this.oXa,()=>{this.JRe()},Object(r.a)(this,this.Yxa,"saveFailureCallback")));
return 32}Yxa(){this.Iu.hide();return!1}JRe(){this.Iu.hide();this.M2c.convert(this.Xa.presentationId.string,0,this.crb(this.y5j))}l_a(t,P,ia,Aa,Ka){if(this.ff.$c(this.nt))return 16;if(1===ia)return 32;this.pa.Qh();this.Fa.Ed();this.rE.j3(!1,!0,pb=>{if(Ka&&1<=Ka.length)Ka[0](pb)},pb=>Ka&&2<=Ka.length?(Ka[1](pb,pb.ServerError.Code),!0):!1);return 32}Kek(){const t=new Ni.QueryStringBuilder(db.a.Wsa("DownloadACopyHandler.ashx"));t.Ki(qf.a.Ufd,this.Xa.presentationId.string);t.Ki(qf.a.vna,this.Xa.sessionInfo);
t.Ki("fn",v.AFrameworkApplication.fileName);v.AFrameworkApplication.gPa(t);return t.toString()}crb(t){if(t){const P=new Ni.QueryStringBuilder(t);this.Xa&&this.Xa.podSessionId&&0>t.indexOf(this.Xa.podSessionId)&&(P.fFc(qf.a.U$+"="+this.Xa.podSessionId),O.a.J(512500620,801,50,"Append PodSessionId in url: {0}",this.Xa.podSessionId));this.Kbk&&v.AFrameworkApplication.xu.Uw&&0<v.AFrameworkApplication.xu.Uw.length&&(P.Ki(qf.a.F8g,v.AFrameworkApplication.xu.Uw),O.a.J(512500619,801,50,"Appended FileName in url"));
this.p8j&&(P.Ki(qf.a.exk,"true"),O.a.J(512500618,801,50,"Appended IsPasswordProtectedFile param"));v.AFrameworkApplication.gPa(P);return P.toString()}return null}qqb(t){const P=Nc.a.n8(jn.a.hhb,!0);O.a.J(509448414,801,15,"DocOperation={0};SimplifiedRibbonON={1}",t,P)}njc(t){this.hWa=t}Ksb(){return v.AFrameworkApplication.EJ?8:32}static kSf(){const t=v.AFrameworkApplication.EJ,P=!ab.a.Wa(v.AFrameworkApplication.eRa),ia=v.AFrameworkApplication.fa.ka("SupportsOfficeClientCoauthoring"),Aa=v.AFrameworkApplication.fa.ka("PPTClpSwitchEnabled");
O.a.J(512500617,801,50,"FIsClpProtectedFileAndDownloadEnabled - fProtected:{0} fHasDownload:{1} fClpTenantSwitchEnabled:{2} fClpPPTSwitchEnabled:{3}",t,P,ia,Aa);return t&&P&&ia&&Aa}}Object(k.a)(kn,"DocumentOperationsActor",null,[227]);class M{}M.qg="<div class='EmbedDialog' id='embeddialog'> <div class='EmbedPreviewPane' id='embedpreviewpane'> </div> <div class='EmbedOptionPane' id='embedoptionpane'> </div> </div>";Object(k.a)(M,"EmbedDialogHtml",null,[]);class Gm{constructor(t,P,ia,Aa){this.CHe=
t;this.E3=P;this.B7g=ia;this.value=Aa}}Object(k.a)(Gm,"OptionInfo",null,[]);class jl{constructor(t,P,ia){this.cSe=t;this.Gxb=P;this.E3=ia}}Object(k.a)(jl,"SectionInfo",null,[]);var Aj=d(286);class Cf extends cd.a{constructor(t,P=!1){super(!1,!1,P);this.N9e=476;this.fxc=288;this.qPh=798;this.KXh=476;this.IXh=288;this.Vfd={};this.r_a=[];this.sP=this.HAa=this.jGd=this.Twc=this.YAc=this.Qob=null;this.kRb=v.AFrameworkApplication.yxb;this.ABc=t;this.hGd=Object(r.a)(this,this.uvk,"optionClickHandler");this.iGd=
Object(r.a)(this,this.vvk,"optionKeyHandler");this.lwd=Object(r.a)(this,this.cfi,"arrowClickHandler");this.qmb=Object(r.a)(this,this.dfi,"arrowKeyHandler");this.LDc=Object(r.a)(this,this.gpl,"textAreaOnFocusHandler");this.ITh=P;this.qg=M.qg;this.xd=0;this.ig="EmbedDialog"}get Jnb(){return this.fxc}set Jnb(t){this.fxc=t}uvh(t){const P={["id"]:this.ig,["bodyControls"]:{},["embedPreviewSectionTitle"]:CommonUIStrings.l_Preview,["embedCodeSectionTitle"]:CommonUIStrings.l_EmbedCode,["dimensionsSectionTitle"]:CommonUIStrings.l_Dimensions,
["interactionSectionTitle"]:CommonUIStrings.l_Interaction,["initialPreviewUrl"]:db.a.Wi(this.ABc,"wdPreview","1"),["initialEmbedUrl"]:this.kRb,["getEmbedCode"]:Cf.g_f,["codeCopiedText"]:CommonUIStrings.l_EmbedCodeCopied};for(const ia of Object.keys(t))P[ia]=t[ia];this.xd=1;this.Xe(1,CommonUIStrings.l_CopyAction);this.Xe(0,CommonUIStrings.l_Close);this.$i(CommonUIStrings.l_Embed,null,P)}Ujb(){if(this.ITh)this.uvh({});else{this.showDialog(CommonUIStrings.l_Embed,null);this.Qob=document.getElementById("embedpreviewpane");
this.YAc=document.getElementById("embedoptionpane");this.Qob.style.width=String.format("{0}px",this.KXh);this.HAa=document.createElement("iframe");this.HAa.className=Cf.HXh;this.HAa.frameBorder="0";this.HAa.style.height=String.format("{0}px",this.IXh);this.HAa.tabIndex=-1;this.Qob.appendChild(this.eLc(CommonUIStrings.l_Preview,this.HAa,Cf.sjf,Cf.JXh,Cf.sjf,!0));this.sP=document.createElement("textarea");this.sP.className=Cf.VPh;Sys.UI.DomElement.addCssClass(this.sP,Aj.a.HBa);this.sP.id=Cf.WPh;ve.a.Ni||
(this.sP.readOnly=!0);this.sP.rows=4;this.sP.style.fontFamily=CommonUIStrings.l_UserInterfaceFontName;this.sP.style.fontSize=CommonUIStrings.l_UserInterfaceFontSize;this.sP.setAttribute(pa.a.D2,String.format("{0} {1}",Cf.M9e,Cf.L9e));this.Qob.appendChild(this.eLc(CommonUIStrings.l_EmbedCode,this.sP,Cf.M9e));nd.a.addHandler(this.sP,"focus",this.LDc);var t=document.createElement("span");t.className=Cf.TQh;t.innerText=CommonUIStrings.l_CopyText;t.id=Cf.L9e;this.Qob.appendChild(t);this.Twc=document.createElement("div");
this.Twc.className=Cf.tPh;this.YAc.appendChild(this.eLc(CommonUIStrings.l_Dimensions,this.Twc));this.jGd=document.createElement("div");this.YAc.appendChild(this.pBi(Cf.MWh,this.jGd));this.xd=0;this.Xe(1,CommonUIStrings.l_Close);this.PFh();this.KGh();ve.a.Ni||this.sP.focus()}}dispose(){if(this.Vfd){var t=this.Vfd;for(let P in t){const ia=t[P];this.vn.yb(oa.a.click,ia.CHe,this.hGd);this.Pg.yb(oa.a.Zf,ia.CHe,this.iGd);this.Pg.yb(oa.a.Hl,ia.CHe,this.iGd)}this.iGd=this.hGd=this.Vfd=null}if(this.r_a){for(t=
0;t<this.r_a.length;++t)this.vn.yb(oa.a.click,this.r_a[t].Gxb,this.lwd),this.Pg.yb(oa.a.Zf,this.r_a[t].Gxb,this.qmb),this.Pg.yb(oa.a.ey,this.r_a[t].Gxb,this.qmb),this.Pg.yb(oa.a.Hl,this.r_a[t].Gxb,this.qmb);this.Pg=this.lwd=this.r_a=null}this.LDc&&this.sP&&(nd.a.removeHandler(this.sP,"focus",this.LDc),this.LDc=null);this.sP=this.HAa=this.jGd=this.Twc=this.YAc=this.Qob=null;super.dispose()}aaa(){super.aaa();this.Gb.style.width=String.format("{0}px",this.qPh);this.XBa()}QFh(t,P){const ia=db.a.Wi(this.kRb,
t,P);return this.kRb!==ia?(this.kRb=ia,this.ABc=db.a.Wi(this.ABc,t,P),!0):!1}PFh(){this.sP&&(this.sP.innerText=Cf.g_f(this.kRb,this.N9e,this.fxc))}KGh(){this.HAa&&this.HAa.contentWindow.location.replace(db.a.Wi(this.ABc,"wdPreview","1"))}kyl(t,P){this.QFh(t,P)&&(this.PFh(),this.KGh())}eLc(t,P,ia=null,Aa=null,Ka=null,pb=!1){const Nb=document.createElement("div");Nb.className=Cf.yZh;Aa&&(Nb.id=Aa);Ka&&Nb.setAttribute(pa.a.D2,Ka);pb&&(Nb.tabIndex=0);Aa=document.createElement("span");Aa.className=Cf.zZh;
Aa.innerText=t;ia&&(Aa.id=ia);Nb.appendChild(Aa);Nb.appendChild(P);return Nb}pBi(t,P){const ia=this.eLc(CommonUIStrings.l_Interaction,P),Aa=this.hi.createElement("div");Aa.className=Cf.AMh;Aa.id=Cf.CMh+t;Aa.setAttribute(pa.a.af,pa.a.ru);Aa.tabIndex=0;ia.insertBefore(Aa,P);t=Da.createClusteredImage(16,16,Cf.BMh,Cf.DMh,!0,"");Aa.appendChild(t);t=t.childNodes[0];t.className=Da.getImageClass(Cf.p9e);t.title=CommonUIStrings.l_Expand;Aa.title=CommonUIStrings.l_Expand;P.style.visibility="hidden";P=new jl(P,
Aa,t);Array.add(this.r_a,P);this.vn.JU(oa.a.click,Aa,this.lwd,P);this.Pg.JU(oa.a.Zf,Aa,this.qmb,P);this.Pg.JU(oa.a.ey,Aa,this.qmb,P);this.Pg.JU(oa.a.Hl,Aa,this.qmb,P);return ia}cfi(t){this.SBf(t);return!0}dfi(t){return this.b0c(t,Object(r.a)(this,this.SBf,"changeArrowState"))}SBf(t){t=t.kD;"visible"===t.cSe.style.visibility?(t.cSe.style.visibility="hidden",t.E3.className=Da.getImageClass(Cf.p9e),t.E3.title=CommonUIStrings.l_Expand,t.Gxb.title=CommonUIStrings.l_Expand):(t.cSe.style.visibility="visible",
t.E3.className=Da.getImageClass(Cf.Y1h),t.E3.title=CommonUIStrings.l_Collapse,t.Gxb.title=CommonUIStrings.l_Collapse)}uvk(t){this.A7g(t);return!0}vvk(t){return this.b0c(t,Object(r.a)(this,this.A7g,"optionHandler"))}A7g(t){const P=this.Vfd[t.kD.toString()];P.value?(P.value=0,P.E3.className=Da.getImageClass(Cf.J1h),P.B7g.setAttribute(pa.a.awf,pa.a.ura)):(P.value=1,P.E3.className=Da.getImageClass(Cf.HNh),P.B7g.setAttribute(pa.a.awf,pa.a.XB));this.kyl(t.kD.toString(),P.value.toString())}gpl(){this.sP.select()}static g_f(t,
P,ia){if(!Cf.uFd){const Aa=String.format('<a target="_blank" href="{0}">{1}</a>',ab.a.v7b("https://office.com"),CommonUIStrings.l_Office),Ka=String.format('<a target="_blank" href="{0}">{1}</a>',ab.a.v7b("https://office.com/webapps"),CommonUIStrings.l_WebAppName);Cf.uFd=String.format(CommonUIStrings.l_NoFrames,Aa,Ka)}return String.format('<iframe src="{0}" width="{1}px" height="{2}px" frameborder="0">{3}</iframe>',ab.a.v7b(t),P,ia,Cf.uFd)}}Cf.uFd=null;Cf.HNh="CheckboxChecked_16x16x32";Cf.J1h="CheckboxUnchecked_16x16x32";
Cf.Y1h="OutlookSearchChevronUp_16x16x32";Cf.p9e="OutlookSearchChevronDown_16x16x32";Cf.BMh="UpArrowServer";Cf.yZh="EmbedSectionHeader";Cf.zZh="EmbedSectionName UIFontBold";Cf.TQh="EmbedCodeFooter";Cf.HXh="EmbedPreviewFrame";Cf.VPh="EmbedCodeTextArea";Cf.tPh="EmbedDimensionSection";Cf.DMh="EmbedArrowIcon";Cf.AMh="WACGlyph EmbedArrowHolder";Cf.WPh="EmbedCode";Cf.M9e="EmbedCodeHeader";Cf.sjf="Preview";Cf.JXh="PreviewHeader";Cf.MWh="Options";Cf.CMh="Arrow";Cf.L9e="EmbedCodeFooter";Object(k.a)(Cf,"EmbedDialog",
cd.a,[]);class Rf extends Cf{constructor(t,P){super(t,!0);P&&P&&!isNaN(P)||O.a.J(539762772,820,10,"Invalid aspectRatio in ReactEmbedDialog");this.QFh(qf.a.Wwk,P.toString())}Ujb(){const t=[];t.push({["id"]:"wdEaaCheck",["checkboxInitialValue"]:!1,["checkboxLabel"]:ResourceStrings.l_AutoAdvanceLabel,["urlTransformFunctionOnChange"]:Rf.VLk});this.uvh({["dimensionsOptions"]:{["isMultipleChoice"]:!1,["defaultWidth"]:this.N9e,["defaultHeight"]:this.fxc,["minWidth"]:375,["minHeight"]:250,["widthLabel"]:ResourceStrings.l_EmbedSlideWidth,
["heightLabel"]:ResourceStrings.l_EmbedSlideHeight},["interactionOptions"]:t})}static VLk(t,P,ia){return"wdEaaCheck"===P?db.a.Wi(t,P,ia?"1":"0"):t}}Object(k.a)(Rf,"ReactEmbedDialog",Cf,[]);class jk{constructor(t,P,ia,Aa,Ka){this.WFa=null;this.sre=!1;this.hWa=null;this.Qb=t;this.Dte=P;this.qcc=ia;this.Vte=Aa;this.Xa=Ka}Ujb(t,P,ia){(t=(t=v.AFrameworkApplication.yR)||this.Xa.xda)||this.sre||(t=!this.ICh());return 1===ia?t?2:32:this.Cfl()}Cfl(){if(!this.sre)return 8;if(v.AFrameworkApplication.yxb&&this.qcc)this.Huh();
else{const t=v.AFrameworkApplication.w3e?this.hWa.sendMessage(ed.a.zVi,null)?32:8:2;return 32!==t?this.Qb.MO(!0,v.AFrameworkApplication.K1d):t}return 32}Bfl(t){t.Values.HostEmbeddedViewUrl&&(this.qcc=v.AFrameworkApplication.yxb=t.Values.HostEmbeddedViewUrl.toString(),this.Huh())}ICh(){return!1}E4h(t,P){this.WFa=P;this.sre=!!this.Qb&&!!this.Dte&&!(void 0===this.qcc||null===this.qcc)&&!!t&&!!P}Huh(){(new Rf(this.qcc,this.WFa)).Ujb()}}Object(k.a)(jk,"EmbedManager",null,[]);class ki{constructor(t,P,ia){this.WFa=
null;this.C6j={};for(P=0;P<t.length;P++)this.C6j[t[P].Format.toString()]=P;this.WFa=ia&&!isNaN(ia)&&isFinite(ia)?ia:0}}Object(k.a)(ki,"FormatPicker",null,[]);class $n extends jk{constructor(t,P,ia,Aa,Ka,pb,Nb,kc){super(t,P,ia,pb,Nb,kc);this.ia=Aa;this.Sb=Ka}vb(){this.ia.ya(hb.a.Ujb,lb.a.application,Object(r.a)(this,this.Ujb,"showEmbedDialog"));this.Vte.execute(Object(r.a)(this,this.njc,"onHostPostmessengerCreated"))}De(){}ICh(){var t=this.Sb.zu();if(!this.Dte||!t.height)return!1;t=t.width/t.height;
const P=new ki(this.Dte,!1,t);this.E4h(P,t);return!0}njc(t){this.hWa=t;v.AFrameworkApplication.isEmbedded||v.AFrameworkApplication.yxb||!this.hWa||(this.hWa.pu(ed.a.RAf),this.hWa.zB(ed.a.RAf,Object(r.a)(this,this.Bfl,"showEmbedDialogPostMessage")))}}Object(k.a)($n,"EmbedActor",jk,[227]);var yg=d(39),rm=d(726),dk=d(677);class Jj{constructor(t,P,ia,Aa,Ka,pb,Nb,kc,Rc,Yc,hd,se){this.ia=t;this.Vdb=P?P.xa:null;this.ua=ia;this.fc=Aa;this.ob=Ka;this.Hu=pb;this.Jb=Nb;this.Tk=kc;this.Qd=Rc;this.KAb=null;this.Fa=
Yc;this.nt=ia.presentation;this.Ce=hd;this.Pf=null;this.Fdb=se}vb(){this.ia.ra(hb.a.gvh,yg.a.application,Object(r.a)(this,this.yvj,"handleUploadAudioDialog"),4)}De(){}yvj(t,P,ia){const Aa=this.ua.Ba;if(!Aa||this.fc.$c(Aa))return 16;if(1===ia)return 32;if(this.Vdb){this.Pf=Rh.a.Ik("Audio::Insert");try{return dk.a.jXe("audio/*",rm.e,()=>rm.d(t,Object(r.a)(this,this.EEj,"insertAudioSuccessAfterUploadUsingMediaUpload"),"audio",this.Ce,Aa),"audio",Aa,this.ua.presentation,this.fc,this.Qd,this.Pf,!1,this.Fdb,
50,10,3),this.Pf&&this.Pf.Va("AudioDialogInitialized","true"),32}catch(Ka){O.a.J(509724633,818,10,"Error while rendering new audio selection dialog.")}}else return O.a.J(512500560,822,15,"Insert Audio initialization failed."),8;this.showErrorMessage(446,null);return 8}showErrorMessage(t,P){this.Pf&&(this.Pf.finish(),this.Pf=null);this.Qd.YG(t,ia=>{ia.$B=1;ia.GRa=P;return!1})}EEj(t,P,ia,Aa,Ka,pb,Nb){Aa.PN(ia)&&O.a.J(512500553,822,15,"Audio::InsertAudioSuccessAfterUploadUsingMediaUpload:Presentation was blocked with loader for {0} milliseconds",
+new Date-+ia.Ria);Aa.ZJ(ia);Ka&&Ka.Va("AudioUploadToRC","true");Object($c.a)("FixForInsertMediaSlideNavigationIssue")||(Nb=this.ua.Ba);ia=Nb.Pt();var kc=this.nt.slideWidth,Rc=this.nt.slideHeight;Aa=Ad.a.rf(32,0);const Yc=Ad.a.rf(32,1);kc=kc/2-Ad.a.rf(16,0);Rc=Rc/2-Ad.a.rf(16,1);if(Nb&&Nb.isConnected){var hd=this.Jb.zd(15,void 0,void 0,()=>{this.Hu.NF=this.KAb;this.ob.selectShape(this.KAb,!0);this.Fa.Ed()});try{hd.nc(Nb);hd.jd=t;Ka&&Ka.Va("CreatingAudioShape","true");this.KAb=this.Tk.FQa(!1,Nb.Cb.cid,
Nb.Cb.sid,0,10,kc,Rc,Aa,Yc,ia+1);const se=pb.files[0].name;this.KAb.JYb=P;this.KAb.HYb=se;Nb.UB(this.KAb)}finally{hd&&hd.dispose()}Ka&&(Ka.Va("AudioShapeSuccessfullyCreated","true"),Ka.finish(),Ka=null)}}}Object(k.a)(Jj,"InsertAudioActor",null,[227]);class gf{constructor(){this.Lxb=this.Uqb=null}}Object(k.a)(gf,"CreatePickerCustomizationDictionaryOptions",null,[1565]);var Ul=d(163),Vi=d(27);class Rd{}Rd.qg="<div class='InsertMediaDialog' id='insertmediadialog'> <div class='InsertMediaPanel' id='insertmediapanel'> <iframe id='insertmediaframe' class='InsertMediaFrame' name='InsertMediaFrame'></iframe> </div> </div>";
Object(k.a)(Rd,"InsertMediaDialogHtml",null,[]);class kk{}kk.qg="<div class='InsertMediaM365Dialog' id='insertmediadialog'> <div class='InsertMediaM365Panel' id='insertmediapanel'> <iframe id='insertmediaframe' class='InsertMediaFrame' name='InsertMediaFrame'></iframe> </div> </div>";Object(k.a)(kk,"InsertMediaM365DialogHtml",null,[]);var Fe=d(388);class ug{static get qg(){return cd.a.gC(ug.ro,ResourceStrings.l_InsertOnlineVideoDescription,ResourceStrings.l_InsertOnlineVideoPrivacy,ResourceStrings.L_LearnMore,
"http://go.microsoft.com/fwlink/?linkid=2010177")}}ug.ro="<div class='VideoUrl' id='videourl'> <label id='labelVideoUrl' class='WACDialogLabel' for='url' >{0}</label> </div> <div class='VideoUrl' id='videourl'> <input type='text' id='url' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='VideoOutput' id='videooutput'> <label id='privacyandtos' class='WACDialogLabel' >{1}</label> </div> <div class='LearnMore' id='learnmore'> <a id='learnmore' class='LearnMore' href={3} target='newtab' >{2}</a> </div> <div class='VideoOutput' id='videooutput'> <label id='labelmessage' class='WACDialogLabel' >message</label> </div>";
Object(k.a)(ug,"InsertOnlineVideoDialogHtml",null,[]);class Kk extends cd.a{constructor(t){super();this.cD(1,!0);this.Xe(1,ResourceStrings.L_Insert);this.qg=ug.qg;this.I9=t;this.GV=!1}T5(){this.width=50;this.$i(ResourceStrings.L_OnlineVideo,Object(r.a)(this,this.ZEj,"insertOnlineVideoDialogHandler"),{["url"]:""});document.getElementById("labelmessage").innerText="";document.getElementById("labelmessage").setAttribute(pa.a.lQd,pa.a.Sei);const t=document.getElementById("url");this.cD(1,!!t&&0<t.value.length);
nd.a.addHandler(t,oa.a.input,Object(r.a)(this,this.Fed,"onPatternChanged"));nd.a.addHandler(t,oa.a.change,Object(r.a)(this,this.Fed,"onPatternChanged"));this.DR(t)}hide(){const t=document.getElementById("url");t&&(nd.a.removeHandler(t,oa.a.input,Object(r.a)(this,this.Fed,"onPatternChanged")),nd.a.removeHandler(t,oa.a.change,Object(r.a)(this,this.Fed,"onPatternChanged")));super.hide()}ZEj(t,P){if(1===t){if(P){var ia=Rh.a.Ik("InsertOnlineVideo",1);ia.Qr=!0;t=P.url.trim();(t=this.I9.ETi(t))?this.I9.ulg(t)&&
this.I9.DVj(t)?(O.a.J(512500548,352,50,"[Insert Online Video] Creating Hubble request for {0}",this.I9.ZZf(t)),this.I9.requestVideoData(t,Aa=>{Rh.a.vF(ia,()=>{this.RY(Aa)})},Object(r.a)(this,this.GUi,"failCallback"))):(O.a.J(512500547,352,10,"[Insert Online Video] Dialog url doesn't match, given url: "+this.I9.ZZf(t)),this.fail(null,ResourceStrings.l_InsertOnlineVideoUnsupportedProvider)):(O.a.J(512500549,352,10,"[Insert Online Video] Dialog url is null!"),this.fail(null,ResourceStrings.l_InsertOnlineVideoIframeError))}}else this.hide()}RY(t){this.hide();
this.I9.Wcg(t)}GUi(t){this.fail(t,ResourceStrings.l_CannotInsertOnlineVideo)}fail(t,P){if(document.getElementById("labelmessage")){var ia=+new Date-+this.I9.startTime;document.getElementById("labelVideoUrl").removeAttribute("for");document.getElementById("labelmessage").innerText=P;document.getElementById("labelmessage").setAttribute("for","url");document.getElementById("url").focus();t&&O.a.J(512500545,352,10,"InsertOnlineVideoDialog:Fail {0}",JSON.stringify({["TimeMs"]:ia,["ResponseCode"]:t.data.Te}))}else O.a.J(512500546,
352,15,"[Insert Online Video] Request failed after the dialog dissapeared!")}Fed(){Rh.a.cbb();const t=document.getElementById("url");this.cD(1,!!t&&0<t.value.length)}}Object(k.a)(Kk,"InsertOnlineVideoDialog",cd.a,[994]);class zl{static get qg(){return cd.a.gC(zl.ro,ResourceStrings.l_InsertCameoExpDialogContent,ResourceStrings.L_LearnMore,"https://aka.ms/pptocameoblog")}}zl.ro="<div class='CameoExperimentTextDiv' id='cameoexperimenttextdiv'> <label id='cameoexperimenttext' class='WACDialogLabel' >{0}</label> </div> <div class='cameoexperimentlearnmorediv' id='CameoExperimentLearnMoreDiv'> <a id='cameoexperimentlearnmore' class='CameoExperimentLearnMore' href={2} target='newtab' >{1}</a> </div>";
Object(k.a)(zl,"InsertCameoDialogHtml",null,[]);class Dh extends cd.a{constructor(){super();this.cD(1,!0);this.qg=zl.qg;this.xd=0}T5(){this.width=50;this.$i(ResourceStrings.l_InsertCameoExpDialogTitle);const t=document.getElementById("cameoexperimentlearnmore");t&&(t.onclick=()=>O.a.J(520119896,352,50,"InsertCameoDialog::showAndFocus : Click on learn more of insert cameo"))}}Object(k.a)(Dh,"InsertCameoDialog",cd.a,[993]);var Sh=d(1082),oj=d(59);class ag{constructor(t,P,ia){this.DSb=Zf.a.Cra;this.pG=
null;this.Ca=t;this.ESb=P;this.fBa=ia}get zn(){return this.Ca}get H7(){return this.pG||(this.pG=A.a.instance.resolve("Common.Utils.IAriaNotifier"))}get Ty(){return this.DSb}set Ty(t){this.DSb=t}Nta(t){try{n.ULS.sendTraceTag(21612195,352,50,"InsertImageFromHostHelper::InsertMediaCallback : Insert {0} pictures.",t.length);const P=this.ESb.QDk(t);let ia=2;if(P&&0<P.length){const Aa=new Sh.DictionaryPropertySet;Aa.setValue(oj.a.FU,P);Aa.setValue(oj.a.KYc,!0);if(this.fBa){const Ka=this.fBa.lYe();Ka.GGc("insertOnlineImage");
Aa.setValue(oj.a.iQa,Ka)}v.AFrameworkApplication.fa.ka("OneNoteExplicitlyNarrateOnInsertingFilesAndImages")&&this.H7.sendNotification(Box4Intl.Box4Strings.l_ImageUploading,!0);ia=this.Ca.La(this.Ty,2,Aa)}n.ULS.sendTraceTag(21612224,352,50,"InsertImageFromHostHelper::InsertMediaCallback : Insert {0} pictures success: {1}. pastedHtmlContentIsEmpty: {2}",t.length,32===ia,""===P)}catch(P){n.ULS.sendTraceTag(21612225,352,10,"InsertImageFromHostHelper::InsertMediaCallback : Exception = [{0}].",P.toString())}}}
Object(k.a)(ag,"InsertOnlineImageHandler",null,[971]);class uf extends ag{constructor(t,P,ia=null){super(t,P,ia)}get sJf(){return ed.a.insertImage}get xxb(){return ed.a.SEj}S8g(t){return this.ESb.ayk(t)}C3f(t){return t.Type}sYc(t,P){return this.ESb.sYc(t.Type,P)}T8g(t){const P=[];if(t&&t.data&&t.data.value&&0<t.data.value.length)for(let Aa=0;Aa<t.data.value.length;Aa++)if(t.data.value[Aa]&&t.data.value[Aa].urls&&t.data.value[Aa].urls.download){var ia=t.data.value[Aa];ia=Object.assign(new he.a,{OriginalUrl:ia.urls.download,
Type:ia.extension||"",Caption:ia.name,ContentType:"",Height:ia.driveItem||ia.driveItem.image?ia.driveItem.image.height:0,Width:ia.driveItem||ia.driveItem.image?ia.driveItem.image.width:0});Array.add(P,ia)}P.length||n.ULS.sendTraceTag(26071184,352,10,"InsertOnlineImageHelper::ParseOneDriveV7Response failed since no valid url was found");return P}Vbh(t,P,ia){ia=ia(t);if(ia.length){t=[];for(let Aa=0;Aa<ia.length;Aa++){const Ka=ia[Aa],pb={};pb.Extension=Ka.Type;pb.SourceUrl=Ka.OriginalUrl;pb.SourceUrl=
Ka.OriginalUrl;pb.Width=Ka.Width;pb.Height=Ka.Height;Array.add(t,pb)}ia={};ia.Items=t;P.sendMessage(this.xxb,ia)}}}Object(k.a)(uf,"InsertOnlineImageHelperBox4",ag,[970,971]);class hm extends uf{constructor(t,P,ia){super(t,P);this.rBe=ia.insertOnlineVideoUrlPatterns;this.Ty=hb.a.lde}Nta(t){if(t&&0<t.length){var P=db.a.UD(t[0].OriginalUrl);P=this.Lke(P)?P:"unsupported";O.a.J(512517837,352,50,"InsertMediaCallback: Insert online video called for {0}",P);this.zn.La(this.Ty,2,t[0])}}Lke(t){if(!t)return!1;
t=t.trim();for(const P of this.rBe)if((new RegExp(P)).test(t))return!0;return!1}}Object(k.a)(hm,"InsertOnlineVideoHelper",uf,[]);class lc{static get qg(){return cd.a.gC(lc.ro,ResourceStrings.l_InsertSocialMediaDialogMsg)}}lc.ro="<div class='WACDialogRow' id='block1'> <div class='WACDialogGroupBox' id='SocialmediaLabelDiv' style=\"width:300px;word-wrap: break-word;\"> <label id='labelText' class='WACDialogLabel' >{0}</label> </div> </div>";Object(k.a)(lc,"InsertSocailMediaDialogHtml",null,[]);var Lk=
d(84),Ye=d(244);class im extends Sys.EventArgs{constructor(t,P,ia,Aa){super();this.slideId=t;this.QY=ia;this.shapeId=P;this.vEa=Aa}}Object(k.a)(im,"IconChangedEventArgs",Sys.EventArgs,[]);var ih=d(489),Jh=d(260);class L{constructor(t,P,ia,Aa,Ka,pb,Nb,kc,Rc,Yc,hd,se,Ae,we,Jf,Yh,Me,mh,af,sk,Nj,an,oo,Ho,Pn,Io,Cl,Ck,Vp){this.A6c=this.qYc=!1;this.yEb=this.xwe=null;this.la=t;this.ia=P;this.fc=ia;this.pa=Aa;this.Fa=Ka;this.ua=pb;this.Jb=Nb;this.e5c=kc;this.H7j=Rc;this.d5c=Yc;this.s4=hd;this.Gbb=se;this.pea=
Ae;this.Tua=we;this.Sb=Jf;this.Tk=Yh;this.Ea=Me;this.Fb=mh;this.Hu=af;this.Wj=sk;this.Odb=Nj;this.oWa=Pn;this.$ve=Io;this.Lc=Cl;this.aU=t.SHb;this.Yb=Vp;this.Odb&&(this.Odb.o8a.removeAttribute("style"),this.Odb.o8a.style.display="none");this.yxe=an;this.I7j=oo;this.I9=Ho;this.a4=Ck;this.Gbb.execute(Wp=>{Wp.isFeatureEnabled("MsoPremiumStockImages",!1).catch(bn=>O.a.J(593627152,352,10,"InsertMediaActor::Constructor - Failed to load the premium state from application feature helper: {0}",bn)).then(bn=>
{this.A6c=bn;this.A6c||(this.xwe=Wp.Vhb("MsoPremiumStockImages",()=>{this.A6c=!0;O.a.J(512517962,352,50,"InsertMediaActor::Constructor - Thanks for purchasing!")}));return null})})}vb(){this.n5h();this.ia.ra(hb.a.zWc,yg.a.application,Object(r.a)(this,this.vBl,"uploadIcon"),4);$c.a("ChangePictureOnMultiSelectFixEnabled")?this.ia.ra(hb.a.zIc,yg.a.application,Object(r.a)(this,this.Api,"changeToIcon"),4):this.ia.ra(hb.a.zIc,yg.a.application,Object(r.a)(this,this.Bpi,"changeToIcon"),4);this.ia.ra(hb.a.O$a,
yg.a.application,Object(r.a)(this,this.Std,"uploadOnlinePicture"),4);$c.a("ChangePictureOnMultiSelectFixEnabled")?this.ia.ra(hb.a.PZb,yg.a.application,Object(r.a)(this,this.CIc,"changeToOnlinePicture"),4):this.ia.ra(hb.a.PZb,yg.a.application,Object(r.a)(this,this.DIc,"changeToOnlinePicture"),4);this.ia.ra(hb.a.CWc,yg.a.application,Object(r.a)(this,this.Std,"uploadOnlinePicture"),4);$c.a("ChangePictureOnMultiSelectFixEnabled")?this.ia.ra(hb.a.AIc,yg.a.application,Object(r.a)(this,this.CIc,"changeToOnlinePicture"),
4):this.ia.ra(hb.a.AIc,yg.a.application,Object(r.a)(this,this.DIc,"changeToOnlinePicture"),4);this.ia.ra(hb.a.DWc,yg.a.application,Object(r.a)(this,this.Std,"uploadOnlinePicture"),4);$c.a("ChangePictureOnMultiSelectFixEnabled")?this.ia.ra(hb.a.MZb,yg.a.application,Object(r.a)(this,this.CIc,"changeToOnlinePicture"),4):this.ia.ra(hb.a.MZb,yg.a.application,Object(r.a)(this,this.DIc,"changeToOnlinePicture"),4);this.m5h();this.ia.ra(hb.a.Mcg,yg.a.application,Object(r.a)(this,this.Std,"uploadOnlinePicture"),
4);$c.a("ChangePictureOnMultiSelectFixEnabled")?this.ia.ra(hb.a.gTd,yg.a.application,Object(r.a)(this,this.CIc,"changeToOnlinePicture"),4):this.ia.ra(hb.a.gTd,yg.a.application,Object(r.a)(this,this.DIc,"changeToOnlinePicture"),4);this.o5h();this.l5h();this.ia.ra(hb.a.lde,yg.a.application,Object(r.a)(this,this.yBl,"uploadOnlineVideo"),4);this.ia.ra(hb.a.kde,yg.a.application,Object(r.a)(this,this.xBl,"uploadOnlineHubbleVideo"),4);this.ia.ra(hb.a.imc,lb.a.application,Object(r.a)(this,this.myl,"updateEntryPoints"),
96)}n5h(){this.ia.ra(hb.a.vWc,yg.a.application,Object(r.a)(this,this.TKa,"showInsertMediaDialogFromM365"),4);this.ia.ra(hb.a.x6a,yg.a.application,Object(r.a)(this,this.TKa,"showInsertMediaDialogFromM365"),4);this.ia.ra(hb.a.insertOnlinePicture,yg.a.application,Object(r.a)(this,this.HWe,"showInsertPictureDialog"),4);this.ia.ra(hb.a.NZb,yg.a.application,Object(r.a)(this,this.HWe,"showInsertPictureDialog"),4);$c.a("InsertSocialMediaVideoIcon")&&this.ia.ra(hb.a.Ucg,yg.a.application,Object(r.a)(this,this.ngl,
"showInsertSocialMediaDialog"),4);$c.a("InsertDalleIcon")&&(this.ia.ra(hb.a.dde,yg.a.application,Object(r.a)(this,this.TKa,"showInsertMediaDialogFromM365"),4),this.ia.ra(hb.a.ede,yg.a.application,Object(r.a)(this,this.TKa,"showInsertMediaDialogFromM365"),4));this.ia.ra(hb.a.e8b,yg.a.application,Object(r.a)(this,this.TKa,"showInsertMediaDialogFromM365"),4);this.ia.ra(hb.a.Esb,yg.a.application,Object(r.a)(this,this.TKa,"showInsertMediaDialogFromM365"),4);this.ia.ra(hb.a.BWc,yg.a.application,Object(r.a)(this,
this.TKa,"showInsertMediaDialogFromM365"),4);this.ia.ra(hb.a.Wxb,yg.a.application,Object(r.a)(this,this.IWe,"showInsertPictureFromHostDialog"),4);this.ia.ra(hb.a.OZb,yg.a.application,Object(r.a)(this,this.IWe,"showInsertPictureFromHostDialog"),4);this.la.ocpsIsEnabled&&(this.ia.aib("ppt_insertOnlinePictures",hb.a.insertOnlinePicture,yg.a.application,Object(r.a)(this,this.HWe,"showInsertPictureDialog"),t=>{Vi.App.Kb.e1a(t,Object(r.a)(this.a4,this.a4.EDa,"getCommandById"))}),this.ia.aib("ppt_insertOnlinePictures",
hb.a.e8b,yg.a.application,Object(r.a)(this,this.TKa,"showInsertMediaDialogFromM365"),t=>{Vi.App.Kb.e1a(t,Object(r.a)(this.a4,this.a4.EDa,"getCommandById"))}),this.ia.aib("ppt_insertOnlinePictures",hb.a.BWc,yg.a.application,Object(r.a)(this,this.TKa,"showInsertMediaDialogFromM365"),t=>{Vi.App.Kb.e1a(t,Object(r.a)(this.a4,this.a4.EDa,"getCommandById"))}),this.ia.aib("ppt_insertOnlinePictures",hb.a.Wxb,yg.a.application,Object(r.a)(this,this.IWe,"showInsertPictureFromHostDialog"),t=>{Vi.App.Kb.e1a(t,
Object(r.a)(this.a4,this.a4.EDa,"getCommandById"))}))}m5h(){this.la.HWc&&this.Yb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InsertMediaSharedFilePickerEnabled",!1)&&(this.ia.ra(hb.a.GWc,yg.a.application,Object(r.a)(this,this.xpd,"showInsertPictureFromMobileDeviceDialog"),4),this.ia.ra(hb.a.QZb,yg.a.application,Object(r.a)(this,this.xpd,"showInsertPictureFromMobileDeviceDialog"),4),this.la.ocpsIsEnabled&&(this.ia.aib("mso_insertMobileDevicePictures",hb.a.GWc,yg.a.application,Object(r.a)(this,
this.xpd,"showInsertPictureFromMobileDeviceDialog"),t=>{Vi.App.Kb.e1a(t,Object(r.a)(this.a4,this.a4.EDa,"getCommandById"))}),this.ia.aib("mso_insertMobileDevicePictures",hb.a.QZb,yg.a.application,Object(r.a)(this,this.xpd,"showInsertPictureFromMobileDeviceDialog"),t=>{Vi.App.Kb.e1a(t,Object(r.a)(this.a4,this.a4.EDa,"getCommandById"))})))}o5h(){this.ia.ra(hb.a.Ota,yg.a.application,Object(r.a)(this,this.dMb,"showInsertVideoDialog"),4);this.la.ocpsIsEnabled&&this.ia.aib("ppt_insertOnlineVideos",hb.a.Ota,
yg.a.application,Object(r.a)(this,this.dMb,"showInsertVideoDialog"),t=>{Vi.App.Kb.e1a(t,Object(r.a)(this.a4,this.a4.EDa,"getCommandById"))})}l5h(){Jh.a(this.Yb.appSettings,"InsertCameoExperimentEnabled",!1)&&this.Yb.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.InsertCameoExperimentEnabled",!1)&&this.ia.ra(hb.a.Lcg,yg.a.application,this.lgl.bind(this),4)}SDk(){v.AFrameworkApplication.k9b()&&v.AFrameworkApplication.muh()&&(v.AFrameworkApplication.Aa.get_element().appendChild(this.Odb.o8a),
nd.a.addHandler(this.Odb.o8a.contentWindow,"message",Object(r.a)(this,this.pvh,"showOneDriveFilePickerDialog")),this.qYc=!0)}pvh(t){if(t.rawEvent&&(t=t.rawEvent.data))try{O.a.J(512517961,352,50,"User select images.");const P=Sys.Serialization.JavaScriptSerializer.deserialize(t,!0),ia=P.MessageId?P.MessageId.toString():null;P&&ia&&(ia===ed.a.insertImage||ia===ed.a.ide)&&this.yxe.start(ia===ed.a.insertImage?this.pea:this.I7j)}catch(P){O.a.J(512517960,352,10,"malformatted postmessage here.")}}De(){}myl(){return 32}HWe(t,
P,ia){if(!this.S5(this.ua.Ba,t,this.la.pptInsertOnlinePictureEnabled))return 8;if(1===ia)return 32;O.a.J(512517959,352,50,"InsertMediaActor::ShowInsertPictureDialog : Show dialog.");try{const Aa=Ca.a.create(),Ka=ab.a.iN(this.la.pptEditingUserId).toString(),pb=t===hb.a.insertOnlinePicture&&this.la.zCk?1:0;let Nb=String.format(this.la.insertPictureServiceEndpoint,v.AFrameworkApplication.lcid,Xk.a.ue(v.AFrameworkApplication.lcid).name,v.AFrameworkApplication.buildVersion,Aa.toString(),3,Ka,pb);0<this.la.insertPictureServiceEndpoint.search(RegExp("insertmedia.bing.office.net",
"gi"))&&(Nb=this.s4.yji(Vi.App.mode,this.la.pptInsertOnlineContentImagesEnabled?this.la.insertOnlineContentImagesEndpoint:this.la.insertPictureServiceEndpoint));this.Gbb.execute(kc=>{kc=this.e5c.getInstance(Nb,this.d5c,this.s4,kc,Rd.qg);kc.insertPictureTelemetryEndpoint=this.la.insertPictureTelemetryEndpoint;kc.correlationId=Aa;kc.f5=1;switch(t){case hb.a.NZb:this.Tua.Ty=hb.a.PZb;break;default:this.pea.Ty=hb.a.O$a}kc.cMb(CommonUIStrings.L_PictureInsertTitle,t===hb.a.insertOnlinePicture?this.pea:this.Tua);
O.a.J(512517958,352,50,"InsertMediaActor::ShowInsertPictureDialog : Show dialog success.")});return 32}catch(Aa){return O.a.J(512517957,352,10,"InsertMediaActor::ShowInsertPictureDialog : Exception = [{0}]",Aa.toString()),L.wt(Lk.a.d4b,ResourceStrings.l_GenericDialogTitle,ResourceStrings.l_CannotInsertOnlinePicture),8}}ngl(t,P,ia){if(1===ia)return 32;t=new cd.a(void 0,void 0,!1);t.xd=5;t.qg=lc.qg;t.$i(ResourceStrings.l_InsertSocialMediaDialogTitle,null,{["id"]:"SocialMediaExperimentDialog"});O.a.J(512517956,
352,15,"InsertMediaActor::ShowInsertSocialMediaDialog : Show dialog.");return 32}TKa(t,P,ia){if(!this.S5(this.ua.Ba,t,this.la.N$a))return 8;if(1===ia)return 32;let Aa;switch(t){case hb.a.e8b:case hb.a.BWc:P=new Ni.QueryStringBuilder(this.la.Ocg);this.Yb.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.InsertDalle",!1)&&P.Ki("dalle","1");Aa=1;this.pea.Ty=hb.a.CWc;break;case hb.a.dde:case hb.a.ede:P=new Ni.QueryStringBuilder(this.la.Ocg);P.Ki("dalle","1");P.Jz("initpivot","dalle");Aa=1;this.pea.Ty=
hb.a.CWc;break;case hb.a.vWc:P=new Ni.QueryStringBuilder(this.la.AWc);Aa=1;this.pea.Ty=hb.a.zWc;break;case hb.a.x6a:$c.a("ChangePictureFromIconsFixEnabled")?(P=new Ni.QueryStringBuilder(this.la.AWc),this.Tua.Ty=hb.a.AIc):(P=new Ni.QueryStringBuilder(this.la.rpi),this.Tua.Ty=hb.a.zIc);Aa=0;break;case hb.a.Esb:P=new Ni.QueryStringBuilder(this.la.spi);Aa=0;this.Tua.Ty=hb.a.AIc;break;default:return O.a.J(512517955,352,10,"InsertMediaActor::ShowInsertMediaDialogFromM365 : unrecognized actionId",t.toString()),
16}this.Yb.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.EnableGettyApiExperiment",!1)&&(P.Ki("gae","1"),v.AFrameworkApplication.Aac("0fecb342;2aaje503"));const Ka=P.toString();if(!Ka||!Ka.length)return 16;O.a.J(512517954,352,50,"InsertMediaActor::ShowInsertMediaDialogFromM365 : Show dialog.");try{const pb=Ca.a.create(),Nb=ab.a.iN(this.la.pptEditingUserId).toString();this.Gbb.execute(kc=>{var Rc=this.la.YEj&&kc.isFreemiumUpsellEnabled();Rc=this.A6c?1:Rc?0:-1;var Yc=this.Yb.ka("InsertOnlineM365ExperimentEnabled")?
1:0;Yc=this.s4.xji(Vi.App.mode,Ka,Rc,Aa,pb.toString(),Nb,Yc);kc=this.e5c.getInstance(Yc,this.d5c,this.s4,kc,kk.qg);kc.correlationId=pb;kc.f5=2;kc.cZd=Rc;kc.cMb(CommonUIStrings.L_PictureInsertTitle,t===hb.a.x6a||t===hb.a.Esb?this.Tua:this.pea);O.a.J(512517953,352,50,"InsertMediaActor::ShowInsertMediaDialogFromM365 : Show dialog success.")});return 32}catch(pb){return O.a.J(512517952,352,10,"InsertMediaActor::ShowInsertMediaDialogFromM365 : Exception = [{0}]",pb.toString()),L.wt(Lk.a.d4b,ResourceStrings.l_GenericDialogTitle,
ResourceStrings.l_CannotInsertOnlinePicture),8}}IWe(t,P,ia){if(!this.S5(this.ua.Ba,t,v.AFrameworkApplication.k9b()&&(L.S9f?!!this.yxe.NGb&&9<this.yxe.NGb.length:!0)))return 8;if(1===ia)return 32;O.a.J(512517923,352,50,"InsertMediaActor::ShowInsertPictureFromHostDialog : Show dialog.");try{P=!0;let Aa=0;if(this.Yb.ka("InsertMediaSharedFilePickerEnabled")){const pb=A.a.instance.resolve("Common.App.SharedFilePicker.ISharedFilePicker");if(pb.oke()){P=!1;const Nb=this.la.Rcg;ia=!1;this.la.HWc&&(ia=this.c1i());
const kc=Object.assign(new gf,{Uqb:ia,Lxb:!0}),Rc=pb.sWd(CommonUIStrings.l_ImageUploadButtonText,CommonUIStrings.l_ImageUploadingTitle,!0,!1,!0,Nb,"InsertPicture",0,kc);pb.C5d(Rc).then(Yc=>{if(Yc&&0<Yc.length){const hd=[];for(let se=0;se<Yc.length;se++){const Ae=Yc[se][Mc.a.SIe],we={};we.Extension=Yc[se][Mc.a.c$g];we.OriginalUrl=Mc.a.NIe in Yc[se]?Yc[se][Mc.a.NIe]:Ae;we.Type=Mc.a.OIe in Yc[se]?Yc[se][Mc.a.OIe]:"";we.Caption=Mc.a.RIe in Yc[se]?Yc[se][Mc.a.RIe]:"";we.Description=Mc.a.MIe in Yc[se]?
Yc[se][Mc.a.MIe]:"";we.Width=Mc.a.QIe in Yc[se]?Yc[se][Mc.a.QIe]:0;we.Height=Mc.a.PIe in Yc[se]?Yc[se][Mc.a.PIe]:0;Array.add(hd,we)}this.q$i(t).Nta(hd);O.a.J(512517922,352,50,"InsertMediaActor::ShowInsertPictureFromHostDialog : SharedFilePicker Show dialog success.")}Aa=32}).catch(Yc=>{O.a.J(512517921,352,10,"InsertMediaActor::ShowInsertPictureFromHostDialog : Exception = [{0}]",Yc.toString());L.wt(Lk.a.d4b,ResourceStrings.l_GenericDialogTitle,ResourceStrings.l_CannotInsertOnlinePicture);Aa=8})}}if(!P)return Aa;
L.S9f=!0;this.qYc||this.SDk();const Ka=this.H7j.getInstance();Ka.f5=4;switch(t){case hb.a.OZb:this.Tua.Ty=hb.a.MZb;break;default:this.pea.Ty=hb.a.DWc}Ka.cMb(CommonUIStrings.L_PictureInsertTitle,t===hb.a.Wxb?this.pea:this.Tua);O.a.J(512517920,352,50,"InsertMediaActor::ShowInsertPictureFromHostDialog : Show dialog success.");return 32}catch(Aa){return O.a.J(512517919,352,10,"InsertMediaActor::ShowInsertPictureFromHostDialog : Exception = [{0}]",Aa.toString()),L.wt(Lk.a.d4b,ResourceStrings.l_GenericDialogTitle,
ResourceStrings.l_CannotInsertOnlinePicture),8}}q$i(t){if(!$c.a("ChangePictureFromOneDriveFixEnabled"))return this.pea;const P=(t=t===hb.a.Wxb)?this.pea:this.Tua;P.Ty=t?hb.a.DWc:hb.a.MZb;return P}c1i(){return A.a.instance.resolve("Common.App.PhoneLink.IPhoneLinkManager").d3i()}xpd(t,P,ia){if(!this.S5(this.ua.Ba,t,this.la.HWc&&this.Yb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InsertMediaSharedFilePickerEnabled",!1)))return 8;if(1===ia)return 32;A.a.instance.resolve("Common.App.PhoneLink.IPhoneLinkManager").pVi(this.Yb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OverridePhoneLinkEndpointToDogfoodEnabled",
!1));try{let Aa=0;const Ka=A.a.instance.resolve("Common.App.SharedFilePicker.ISharedFilePicker");if(Ka.oke()){const pb=t===hb.a.GWc,Nb=this.la.Rcg,kc=Object.assign(new gf,{Uqb:!0,Lxb:!0}),Rc=Ka.sWd(CommonUIStrings.l_ImageUploadButtonText,CommonUIStrings.l_ImageUploadingTitle,!0,!1,pb,Nb,"InsertPictureFromMobile",3,kc);Ka.C5d(Rc).then(Yc=>{if(Yc&&0<Yc.length){const hd=[];let se=!1;const Ae=this.Yb.Ha("PhoneLinkServiceEndpoint");for(let we=0;we<Yc.length;we++){const Jf=Yc[we][Mc.a.SIe],Yh=Yc[we],Me=
{};Me.Extension=Yc[we][Mc.a.c$g];Me.OriginalUrl=this.aJb(Yh,Mc.a.NIe,Jf);Me.Type=this.aJb(Yh,Mc.a.OIe,"");Me.Caption=this.aJb(Yh,Mc.a.RIe,"");Me.Description=this.aJb(Yh,Mc.a.MIe,"");Me.Width=this.aJb(Yh,Mc.a.QIe,0);Me.Height=this.aJb(Yh,Mc.a.PIe,0);Array.add(hd,Me);se||(se=-1!==Me.OriginalUrl.indexOf(Ae))}Yc=pb?this.pea:this.Tua;Yc.Ty=se?pb?hb.a.Mcg:hb.a.gTd:pb?hb.a.DWc:hb.a.MZb;Yc.Nta(hd);O.a.J(512517918,352,50,"InsertMediaActor::ShowInsertPictureFromMobileDeviceDialog : SharedFilePicker Show dialog success.")}Aa=
32}).catch(Yc=>{O.a.J(512517917,352,10,"InsertMediaActor::ShowInsertPictureFromMobileDeviceDialog : Exception = [{0}]",Yc.toString());Aa=8})}return Aa}catch(Aa){return O.a.J(512517916,352,10,"InsertMediaActor::ShowInsertPictureFromMobileDeviceDialog : Exception = [{0}]",Aa.toString()),8}}aJb(t,P,ia){return P in t?t[P]:ia}Std(t,P,ia,Aa,Ka){P=this.ua.Ba;if(!P)return O.a.J(512517915,352,50,"Active Slide is null"),8;if(!this.S5(P,t,this.la.pptInsertOnlinePictureEnabled))return 8;if(1===ia)return 32;if(!this.Wj.JF(P,
1))return this.Wj.hG(P),16;try{const pb=P.n3(this.pa.Xd());if(pb&&this.fc.$c(pb))return 16;const Nb=this.H9a(P,pb);let kc=null;const Rc=this.Jb.zd(15,void 0,()=>{this.pa.Vx();this.pa.Qh();this.Fa.Ed()},()=>{this.pa.selectShape(Nb,!0);kc&&this.pa.selectShape(kc,!1)});try{Rc.nc(P);Rc.jd=hb.a.insertOnlinePicture;Rc.Py[Ye.a.$Ca]=Ye.a.online;ia=null;t={["actionId"]:t};if(this.la.pptInsertOnlinePictureAttributionIsEnabled)if(Ka.LicenseUrl&&Ka.LicenseDisplayName){const Yc=L.bKe(Ka);ia=Ul.c(Yc);if(this.la.pptImageAttributionSelectionImprove){const hd=
P.Cb;kc=this.Tk.$ra(!0,hd.cid,hd.sid,0,0,0,Xb.a.cY,Xb.a.h5,P.Pt()+1,!1)}}else t["result.LicenseDisplayName"]=Ka.LicenseDisplayName,t["result.LicenseUrl"]=ab.a.iN(Ka.LicenseUrl);else t.IsEnabled=this.la.pptInsertOnlinePictureAttributionIsEnabled;O.a.J(512517914,352,50,"InsertMediaActor::UploadOnlinePicture: {0}.",t);Nb.iLb(Ka.OriginalUrl,Ka.LicenseUrl?null:Ka.Caption,ia,Ka.PageUrl);pb&&P.KU([pb]);P.UB(Nb);kc&&(P.UB(kc),Nb.a6a=kc.id,kc.y$a=!0)}finally{Rc&&Rc.dispose()}this.Hu.NF=Nb;return 32}catch(pb){return O.a.J(512517913,
352,10,"InsertMediaActor::UploadOnlinePicture : Exception = [{0}].",pb.toString()),8}}DIc(t,P,ia,Aa,Ka){P=this.ua.Ba;if(!P)return O.a.J(512517912,352,50,"Active Slide is null"),8;if(!this.S5(P,t,this.la.yJa))return 8;if(1===ia)return 32;O.a.J(512517910,352,50,"InsertMediaActor::changeToOnlinePictureSingleImage : Start changing.");if(!Ka)return 16;try{const pb=this.f9a()||this.KRc();if(!pb||this.fc.$c(pb))return 16;let Nb=null;const kc=this.Jb.zd(15,void 0,void 0,()=>{this.pa.selectShape(pb,!0);Nb&&
this.pa.selectShape(Nb,!1);O.a.J(512517908,352,50,"InsertMediaActor::changeToOnlinePictureSingleImage : Finish changing.")});try{kc.nc(P);kc.jd=hb.a.PZb;kc.Py[Ye.a.$Ca]=Ye.a.online;t=null;if(this.la.pptInsertOnlinePictureAttributionIsEnabled&&Ka.LicenseUrl&&Ka.LicenseDisplayName){const Rc=L.bKe(Ka);t=Ul.c(Rc);if(this.la.pptImageAttributionSelectionImprove){const Yc=P.Cb;Nb=this.Tk.$ra(!0,Yc.cid,Yc.sid,0,0,0,Xb.a.cY,Xb.a.h5,P.Pt()+1,!1);O.a.J(512517907,352,50,"InsertMediaActor::changeToOnlinePictureSingleImage : Adding license info to attributionShapeNode.")}}pb.iLb(Ka.OriginalUrl,
Ka.LicenseUrl?null:Ka.Caption,t,Ka.PageUrl);pb.set_isSVGBlipFilled(!1);Nb&&(P.UB(Nb),pb.a6a=Nb.id,Nb.y$a=!0)}finally{kc&&kc.dispose()}this.Hu.NF=pb;return 32}catch(pb){return O.a.J(512517905,352,10,"InsertMediaActor::changeToOnlinePictureSingleImage : Exception = [{0}].",pb.toString()),8}}CIc(t,P,ia,Aa,Ka){P=this.ua.Ba;if(!P)return O.a.J(512517911,352,50,"Active Slide is null"),8;if(!this.S5(P,t,this.la.yJa))return 8;if(1===ia)return 32;O.a.J(512517909,352,50,"InsertMediaActor::ChangeToOnlinePicture : Start changing.");
if(!Ka)return 16;try{var pb=this.pa.Xd();t=[];for(var Nb of pb)Nb.Jf||t.push(Nb);for(const Rc of t)if(!Rc||this.fc.$c(Rc))return 16;pb=null;const kc=this.Jb.zd(15,void 0,void 0);try{kc.nc(P);kc.jd=hb.a.PZb;kc.Py[Ye.a.$Ca]=Ye.a.online;Nb=null;if(this.la.pptInsertOnlinePictureAttributionIsEnabled&&Ka.LicenseUrl&&Ka.LicenseDisplayName){const Yc=L.bKe(Ka);Nb=Ul.c(Yc);if(this.la.pptImageAttributionSelectionImprove){const hd=P.Cb;pb=this.Tk.$ra(!0,hd.cid,hd.sid,0,0,0,Xb.a.cY,Xb.a.h5,P.Pt()+1,!1);O.a.J(512517906,
352,50,"InsertMediaActor::ChangeToOnlinePicture : Adding license info to attributionShapeNode.")}}const Rc=Ka.LicenseUrl?null:Ka.Caption;for(const Yc of t)Yc.iLb(Ka.OriginalUrl,Rc,Nb,Ka.PageUrl),Yc.set_isSVGBlipFilled(!1),pb&&(P.UB(pb),Yc.a6a=pb.id,pb.y$a=!0)}finally{kc&&kc.dispose()}this.Hu.NF=t[0];return 32}catch(kc){return O.a.J(512517904,352,10,"InsertMediaActor::ChangeToOnlinePicture : Exception = [{0}].",kc.toString()),8}}vBl(t,P,ia,Aa,Ka){P=this.ua.Ba;if(!P)return O.a.J(512517903,352,50,"Active Slide is null"),
8;if(!this.S5(P,t,this.la.N$a))return 8;if(1===ia)return 32;O.a.J(512517902,352,50,"InsertMediaActor::UploadIcon : Start inserting.");if(!Ka||!Ka.length)return 16;if(!this.Wj.JF(P,Ka.length))return this.Wj.hG(P),16;try{let pb=null;ia=null;if(!({Zzk:ia,Pzk:pb}=this.Zdj(Ka,P)).returnValue)return 16;const Nb=this.Jb.zd(15,void 0,()=>{this.pa.Vx();this.pa.Qh();this.Fa.Ed()},()=>{this.pa.s_a(pb,!0)});try{for(Nb.nc(P),Nb.jd=t,Nb.Py[Ye.a.$Ca]=Ye.a.icon,ia&&P.KU(ia),t=0;t<pb.length;t++)P.UB(pb[t])}finally{Nb&&
Nb.dispose()}this.Hu.NF=pb[pb.length-1];return 32}catch(pb){return O.a.J(512517901,352,10,"InsertMediaActor::UploadIcon : icon count = [{0}], Exception = [{1}].",Ka.length,pb.toString()),8}}Zdj(t,P){let ia,Aa;ia=Array(t.length);Aa=Array(t.length);var Ka=P.i4d(this.pa.Xd());if(Ka&&0<Ka.length){var pb=0;for(const Nb of Ka)if(Nb&&!this.fc.$c(Nb)&&pb<t.length&&(ia[pb]=Nb,pb++,pb===t.length))break}Ka=!0;for(pb=0;pb<ia.length;pb++)this.la.svgIconLocalEditingIsEnabled&&t[pb].SvgContent&&0<t[pb].SvgContent.length&&
(!ia[pb]||ia[pb]&&15!==ia[pb].Gj)?Aa[pb]=this.Xdj(P,ia[pb],t[pb],pb):(Aa[pb]=this.k4f(P,ia[pb],t[pb],!0,pb),Ka=!1),Ka&&Rh.a.kP(!0,!0),Aa[pb].iLb(t[pb].OriginalUrl,t[pb].Caption,null,null);return{returnValue:!0,Zzk:ia,Pzk:Aa}}Xdj(t,P,ia,Aa){if(!t)return null;var Ka=t.Cb,pb=t.Pt();let Nb;const kc=Object(R.a)(295,t.sc(this.Fb.Ma));({F1d:Nb,fD:t}=this.oWa.$Ud(P,ia.Width,ia.Height));Aa=P?0:Aa*Fe.a.HS;Ka=this.Tk.$ra(!0,Ka.cid,Ka.sid,0,t.x+Aa,t.y+Aa,Nb.width,Nb.height,pb+1,!1);pb=this.oWa.mRd(this.Fb.Ld,
Nb,t,kc.mT);Ka.NU=pb;Ka.isResizable=!0;Ka.r9b=!0;Ka.vL=!0;Ka.FIa=!0;Ka.set_isSVGBlipFilled(!0);ia=this.$ve.e0k(ia.SvgContent);Ka.Pda=ia?String.format("data:image/svg+xml;charset=utf8,{0}",encodeURIComponent(ia)):"";P&&(Ka.eca=P.id);return Ka}Api(t,P,ia,Aa,Ka){P=this.ua.Ba;if(!P)return O.a.J(512517900,352,50,"Active Slide is null"),8;if(!this.S5(P,t,this.la.pptSmartArtSubNodeIconChangeEnabled))return 8;if(1===ia)return 32;O.a.J(512517898,352,50,"InsertMediaActor::ChangeToIcon : Start changing.");if(!Ka||
!Ka.length)return 16;try{const pb=this.pa.Xd(),Nb=[];for(const Yc of pb)Yc.Jf||Nb.push(Yc);const kc=Ka[0].Caption;for(const Yc of Nb){if(!Nb||this.fc.$c(Yc))return 16;const hd=this.Ea.vr(Yc);kc&&hd&&this.Lc.Adh(new im(P.Cb,Yc.get_shapeId(),Yc.get_smartArtModelId(),kc))}const Rc=this.Jb.zd(15,void 0,void 0,()=>{for(const Yc of Nb){const hd=this.Ea.vr(Yc);hd&&(this.Lc.Uid(),this.pa.selectShape(hd,!0),this.Lc.Tid())}O.a.J(512517896,352,50,"InsertMediaActor::ChangeToIcon : Finish changing.")});try{Rc.nc(Nb[0]);
Rc.jd=t;Rc.Py[Ye.a.$Ca]=Ye.a.icon;for(const Yc of Nb)Yc.set_isSVGBlipFilled(!0),Yc.iLb(Ka[0].OriginalUrl,kc,null,null)}finally{Rc&&Rc.dispose()}for(const Yc of Nb)this.fc.Bra(P,Yc,this.Fb.Ma,t);return 32}catch(pb){return O.a.J(512517894,352,10,"InsertMediaActor::ChangeToIcon : icon count = [{0}], Exception = [{1}].",Ka.length,pb.toString()),8}}Bpi(t,P,ia,Aa,Ka){P=this.ua.Ba;if(!P)return O.a.J(512517899,352,50,"Active Slide is null"),8;if(!this.S5(P,t,this.la.pptSmartArtSubNodeIconChangeEnabled))return 8;
if(1===ia)return 32;O.a.J(512517897,352,50,"InsertMediaActor::changeToIconSingleIcon : Start changing.");if(!Ka||!Ka.length)return 16;try{const pb=this.KRc()||this.f9a();if(!pb||this.fc.$c(pb))return 16;const Nb=Ka[0].Caption,kc=this.Ea.vr(pb);Nb&&kc&&this.Lc.Adh(new im(P.Cb,pb.get_shapeId(),pb.get_smartArtModelId(),Nb));const Rc=this.Jb.zd(15,void 0,void 0,()=>{kc&&(this.Lc.Uid(),this.pa.selectShape(kc,!0),this.Lc.Tid());O.a.J(512517895,352,50,"InsertMediaActor::changeToIconSingleIcon : Finish changing.")});
try{Rc.nc(pb),Rc.jd=t,Rc.Py[Ye.a.$Ca]=Ye.a.icon,pb.set_isSVGBlipFilled(!0),pb.iLb(Ka[0].OriginalUrl,Nb,null,null)}finally{Rc&&Rc.dispose()}(ia=kc||pb)&&this.fc.Bra(P,ia,this.Fb.Ma,t);return 32}catch(pb){return O.a.J(512517893,352,10,"InsertMediaActor::changeToIconSingleIcon : icon count = [{0}], Exception = [{1}].",Ka.length,pb.toString()),8}}KRc(){let t=null;const P=this.pa.Xd();for(const ia of P)if(ia&&ia.get_isSVGBlipFilled())if(t)break;else t=ia;return t}f9a(){if(this.aU){const t=this.pa.Xd();
return t&&t.length?this.ZPd(t)?t[0]:this.ewb():null}return this.ewb()}ZPd(t){if(!t||!t.length)return!1;let P=t[0].Ej,ia=1===t[0].mediaType;for(const Aa of t)P=P&&Aa.Ej,ia=ia&&1===Aa.mediaType;return P||ia}ewb(){const t=this.pa.Xd();for(const P of t)if(P&&P.Ej)return P;return null}Mog(t,P){const ia=this.Yb.getStringFeatureGate("Microsoft.Office.PowerPointOnline.InsertOnlineVideoModal","defaultModal");"defaultModal"!==ia&&O.a.J(t,352,15,`${P}::Modal:${ia}`)}dMb(t,P,ia){if(!this.S5(this.ua.Ba,t,this.la.pptInsertOnlineVideoEnabled))return 8;
if(1===ia)return 32;this.yEb=Rh.a.Ik("ShowInsertVideoDialog",1);const Aa=this.Yb.getStringFeatureGate("Microsoft.Office.PowerPointOnline.InsertOnlineVideoModal","defaultModal");try{if(this.la.insertVideoOnlineFromHubbleEnabled){O.a.J(512517890,352,50,"InsertMediaActor::ShowInsertVideoDialog : Insert online video using Hubble");const pb=Ca.a.create(),Nb=ab.a.iN(this.la.pptEditingUserId).toString();this.Gbb.execute(kc=>{kc=this.e5c.getInstance(this.s4.zji(Vi.App.mode,this.la.sFj,pb.toString(),Nb,this.la.jab,
this.la.Gzb,Aa),this.d5c,this.s4,kc,kk.qg);kc.correlationId=pb;kc.f5=5;const Rc=new hm(this.ia,this.s4,this.la);Rc.Ty=hb.a.kde;kc.cMb(CommonUIStrings.L_VideoInsertTitle,Rc)})}else this.la.insertVideoOnlineFromUrlEnabled?(O.a.J(512517889,352,50,"[Insert Online Video] Insert online video from URL, creating dialog"),(new Kk(this.I9)).T5()):(O.a.J(512517888,352,50,"InsertMediaActor::ShowInsertVideoDialog : Insert online video"),this.Gbb.execute(pb=>{this.e5c.getInstance(this.s4.Aji(Vi.App.mode,this.la.insertVideoServiceEndpoint),
this.d5c,this.s4,pb,Rd.qg).cMb(CommonUIStrings.L_VideoInsertTitle,new hm(this.ia,this.s4,this.la))}));this.Mog(512557208,"ShowInsertOnlineVideoDialog");null!=this.yEb&&Object(ih.a)(this.yEb.actionName,(new Date).getTime()-this.yEb.CD.getTime(),"InsertOnlineVideoDialog",this.yEb.actionId,this.yEb.Nj);const Ka=this.Yb.getStringFeatureGate("Microsoft.Office.PowerPointOnline.InsertOnlineVideoToolTipMessage","InsertOnlineVideo");$c.a("LogInsertOnlineVideoCustomToolTip")&&"InsertOnlineVideo"!==Ka&&O.a.J(512517859,
352,15,"InsertOnlineVideo::ToolTipMessage : "+Ka);if("Microsoft.Office.PowerPointOnline.InsertSocialMediaVideo"in this.Yb.pPc){const pb=this.Yb.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.InsertSocialMediaVideo",!1)?"Visible":"NotVisible";O.a.J(512517858,352,15,"InsertOnlineVideo::SocialMediaIconIs"+pb)}O.a.J(512517857,352,50,"InsertMediaActor::ShowInsertVideoDialog : Show dialog success.");return 32}catch(Ka){return O.a.J(512517856,352,10,"InsertMediaActor::ShowInsertVideoDialog : Exception = [{0}]",
Ka.toString()),L.wt(Lk.a.d4b,ResourceStrings.l_GenericDialogTitle,ResourceStrings.l_CannotInsertOnlineVideo),8}}lgl(t,P,ia){if(!this.S5(this.ua.Ba,t,!0))return 8;if(1===ia)return 32;try{return O.a.J(512517855,352,50,"InsertMediaActor::ShowInsertCameoDialog : Insert cameo, creating dialog"),(new Dh).T5(),32}catch(Aa){return O.a.J(512517854,352,10,"InsertMediaActor::ShowInsertCameoDialog : Exception = [{0}]",Aa.toString()),8}}yBl(t,P,ia,Aa,Ka){P=this.ua.Ba;if(!P)return O.a.J(512517853,352,50,"Active Slide is null"),
8;if(!this.S5(P,t,this.la.pptInsertOnlineVideoEnabled))return 8;if(1===ia)return 32;if(!this.Wj.JF(P,1))return this.Wj.hG(P),16;try{const pb=P.n3(this.pa.Xd());if(pb&&this.fc.$c(pb))return 16;const Nb=this.H9a(P,pb),kc=this.s4.Fmj(Ka.OriginalUrl);Nb.WTe(kc,Ka.ThumbnailUrl,Ka.Caption,Ka.Description,0<Ka.Width?Ka.Width:0,0<Ka.Height?Ka.Height:0);const Rc=this.Jb.zd(15,void 0,()=>{this.pa.Vx();this.pa.Qh();this.Fa.Ed()},()=>{this.pa.selectShape(Nb,!0)});try{Rc.nc(P),Rc.jd=t,pb&&P.KU([pb]),P.UB(Nb)}finally{Rc&&
Rc.dispose()}O.a.J(512517852,352,50,"InsertMediaActor::UploadOnlineVideo : Inserting online video is done.");this.Hu.NF=Nb;return 32}catch(pb){return O.a.J(512517851,352,10,"InsertMediaActor::UploadOnlineVideo : Exception = [{0}].",pb.toString()),8}}xBl(t,P,ia,Aa,Ka){P=this.ua.Ba;if(!P)return O.a.J(512517850,352,50,"Active Slide is null"),8;if(!this.S5(P,t,this.la.insertVideoOnlineFromHubbleEnabled))return 8;if(1===ia)return 32;O.a.J(512517849,352,50,"InsertMediaActor::UploadOnlineHubbleVideo : Start inserting.");
if(!this.Wj.JF(P,1))return this.Wj.hG(P),16;try{const pb=P.n3(this.pa.Xd());if(pb&&this.fc.$c(pb))return 16;const Nb=this.H9a(P,pb),kc=0<Ka.Width?Ka.Width:0,Rc=0<Ka.Height?Ka.Height:0;let Yc=Ka.PageUrl;this.la.Gzb&&"odspbusiness"===Ka.ProviderName.toLocaleLowerCase()&&(Yc=Ka.OriginalUrl);Nb.WTe(Yc,Ka.ThumbnailUrl,Ka.Caption,Ka.Description,kc,Rc);const hd=this.Jb.zd(15,void 0,()=>{this.pa.Vx();this.pa.Qh();this.Fa.Ed()},()=>{this.pa.selectShape(Nb,!0)});try{hd.nc(P),hd.jd=t,pb&&P.KU([pb]),P.UB(Nb)}finally{hd&&
hd.dispose()}this.Mog(512557200,"InsertOnlineHubbleVideo");O.a.J(512517848,352,50,"InsertMediaActor::UploadOnlineVideo : Inserting online video is done in {0} ms.",Date.now()-Ka.StartInsertTime);this.Hu.NF=Nb;return 32}catch(pb){return O.a.J(512517847,352,10,"InsertMediaActor::UploadOnlineHubbleVideo : Exception = [{0}].",pb.toString()),8}}S5(t,P,ia){t=!!t&&ia&&!this.fc.$c(t);switch(P){case hb.a.x6a:return t&&(!!this.f9a()||!!this.KRc());case hb.a.NZb:case hb.a.OZb:case hb.a.QZb:case hb.a.Esb:return t&&
this.Mqi();default:return t}}Mqi(){const t=this.f9a()||this.KRc();return t?this.Ea.vr(t)?!1:!0:!1}H9a(t,P){return this.k4f(t,P,null,!1,0)}k4f(t,P,ia,Aa,Ka){if(!t)return null;var pb=t.Cb;t=t.Pt();let Nb;Aa?{width:ia,height:Nb}=L.Vjj(P,ia):(ia=Xb.a.cY,Nb=Xb.a.h5);let kc;kc=P?P.twb(ia,Nb):this.Sb.pta(ia,Nb);Ka=P?0:Ka*Fe.a.HS;pb=this.Tk.$ra(!0,pb.cid,pb.sid,0,kc.x+Ka,kc.y+Ka,ia,Nb,t+1,!0);pb.set_isSVGBlipFilled(Aa);P&&(pb.eca=P.id);return pb}dispose(){this.Gbb.instance&&this.xwe&&this.Gbb.instance.rJb("MsoPremiumStockImages",
this.xwe);this.qYc&&this.Odb.o8a.contentWindow&&(nd.a.removeHandler(this.Odb.o8a.contentWindow,"message",Object(r.a)(this,this.pvh,"showOneDriveFilePickerDialog")),this.qYc=!1)}static hki(){const t=CommonUIStrings.l_AttributionText.split(/[{}]+/);return gm.e(t,P=>!!P)}static vji(t,P){const ia=document.createElement("body");var Aa="";let Ka="",pb=CommonUIStrings.L_CCYYSA;void 0!==P&&null!==P&&(void 0!==P.PageUrl&&null!==P.PageUrl&&(Aa=P.PageUrl),void 0!==P.LicenseDisplayName&&null!==P.LicenseDisplayName&&
0<P.LicenseDisplayName.length&&(pb=P.LicenseDisplayName),void 0!==P.LicenseUrl&&null!==P.LicenseUrl&&(Ka=P.LicenseUrl));for(const Nb of t){switch(Nb){case "L_ThePhoto":t=L.syf(CommonUIStrings.l_ThePhoto,Aa);break;case "L_CCYYSA":t=L.syf(pb,Ka);break;case "L_PhotoAuthor":t=L.Lyf(CommonUIStrings.l_PhotoAuthor);break;default:t=L.Lyf(Nb)}t&&ia.appendChild(t)}Aa=document.createElement("html");Aa.appendChild(ia);return Aa}static Lyf(t){const P=document.createElement("span");P.innerText=t;return P}static syf(t,
P){const ia=document.createElement("A");ia.setAttribute("href",P);ia.setAttribute("target","_blank");ia.setAttribute("rel","noreferrer");P=document.createElement("span");P.innerText=t;ia.appendChild(P);return ia}static bKe(t){const P=L.hki();return L.vji(P,t)}static wt(){}static Vjj(t,P){let ia;t&&15===t.Gj?(ia=Ad.a.Me(t.k4e,0,!1),t=Ad.a.Me(t.Tae,0,!1)):P&&0<P.Width&&0<P.Height?(ia=P.Width,t=P.Height):(ia=Ad.a.Me(2,0,!1),t=Ad.a.Me(2,0,!1));return{width:ia,height:t}}}L.S9f=!1;Object(k.a)(L,"InsertMediaActor",
null,[227]);var ca=d(694);class X{}X.hql=864E5;X.Iai=3;X.llk=144E5;Object(k.a)(X,"AddinConstantsNum",null,[]);var qb=d(693),Rb=d(534);class Qc{constructor(t,P,ia,Aa=null){this.fa=Aa?Aa:v.AFrameworkApplication.fa;this.DBd=2;this.Qxb=t;this.i2h=P;this.Iw=ia}get KTa(){return this.DBd}get XBl(){return this.i2h}OQe(t){if(this.fa.ka("AgaveSupportsLiveIdSpoofing"))this.Qxb(t,this.KTa,{["ak0"]:(new Date).getTime()});else if(Rb.a.rdl(t)){var P=String.format(v.AFrameworkApplication.Aa.hb.Vma+"AddinServiceHandler.ashx?action={0}&app={1}&lc={2}&{3}",
"laststoreupdate",v.AFrameworkApplication.Aa.hb.Vk,this.XBl,v.AFrameworkApplication.jh);const ia=v.AFrameworkApplication.Je;let Aa=null;this.Iw&&(Aa=this.Iw.Ci("ComponentAttach",qb.a[t]+ca.a[this.KTa]));ia.Aj(P,1,null,null,!0,4,Ka=>{this.wuk(t,Ka.data.Zd);Aa&&Aa.stop()},Ka=>{n.ULS.sendTraceTag(17438153,220,50,"GetLastUpdate request failed with {0}.",Ka.data.Te);Aa&&Aa.stop()},null)}else Rb.a.x9f(t)?(P=Rb.a.dXf(t),this.Qxb(t,this.KTa,{["ak0"]:P})):this.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",
!1)&&this.Qxb(t,this.KTa,null)}wuk(t,P){if(P&&""!==P&&(P=Sys.Net.XMLDOM(P))){Rb.a.dOb(Ui.a.ftf,((new Date).getTime()+X.llk).toString(),t);let ia=P.getElementsByTagName("update");ia&&ia.length||(ia=P.getElementsByTagName("o:update"));ia&&0<ia.length&&(P=Date.parse(ia[0].firstChild.nodeValue),(Rb.a.dXf(t)<P||Rb.a.x9f(t))&&this.Qxb(t,this.KTa,{["ak0"]:P}))}}}Object(k.a)(Qc,"AddinCommandsAnonymousAPIInitializer",null,[1092]);class jd{constructor(t,P,ia){this.DBd=ia;this.Qxb=t;this.Xh=P}get KTa(){return this.DBd}OQe(t){let P=
null;this.Xh&&(P=this.Xh.Ci("ComponentAttach",qb.a[t]+ca.a[this.KTa]));(null==this.VVe(t)?0:this.VVe(t))&&this.Qxb(t,this.KTa,{["ak0"]:(new Date).getTime()-X.Iai*X.hql});P&&P.stop()}}Object(k.a)(jd,"AddinCommandsInitializerBase",null,[1092]);class vd extends jd{constructor(t,P){super(t,P,5)}VVe(){return!0}}Object(k.a)(vd,"AddinCommandsInitializer",jd,[]);class Xd extends jd{constructor(t,P){super(t,P,1)}VVe(t){try{const P=Ui.a.G_f()+t;return Boolean.parse(this.c3i(P)||"false")}catch(P){n.ULS.sendTraceTag(17306844,
220,50,"LocalStorage is not allowed, {0}.",P.toString())}return null}c3i(t){const P=localStorage;return void 0!==P&&null!==P?P.getItem(t):null}}Object(k.a)(Xd,"AddinCommandsLocalCacheInitializer",jd,[]);class Ke{constructor(t,P=null){this.Iw=t;this.fa=P?P:v.AFrameworkApplication.fa}get appUILocale(){return Xk.a.ue(v.AFrameworkApplication.lcid).name}uCj(){if(this.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GetAddinFlyoutEnabled",!1)&&this.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",
!1)&&this.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GetAddinHomeTabEntranceEnabled",!1)&&this.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableTUIForBEPHomeTab",!1)){var t={};t[Ui.a.nOi]="TeachingCallout";this.FKe(E.a.Qsl,t)}const P=this.g4d();if(P)if(this.fa.ka("OcpsIsEnabled"))A.a.instance.Ja("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(ia=>{ia.isFeatureEnabled("ConnectedServices",!0).then(Aa=>{for(let Ka of P){if(!Aa&&0===Ka.key)continue;const pb=
this.IWf(Ka.value);pb&&pb.OQe(Ka.key)}return null})});else for(let ia of P)(t=this.IWf(ia.value))&&t.OQe(ia.key)}PQe(t,P,ia){ia&&ia[Ui.a.Mqb]?(ia[Ui.a.B7]=t,ia[Ui.a.A7]=P,this.FKe(E.a.VJb,ia),Rb.a.dOb(Ui.a.Mqb,ia[Ui.a.Mqb].toString(),t)):this.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)&&0===t&&(ia={},ia[Ui.a.B7]=t,ia[Ui.a.A7]=P,this.FKe(E.a.Z$,ia))}IWf(t){let P=null;switch(t){case 1:P=new Xd(Object(r.a)(this,this.PQe,"retrieveAddinFlagCompleted"),
this.Iw);break;case 2:P=new Qc(Object(r.a)(this,this.PQe,"retrieveAddinFlagCompleted"),this.appUILocale,this.Iw,this.fa);break;case 5:P=new vd(Object(r.a)(this,this.PQe,"retrieveAddinFlagCompleted"),this.Iw)}return P}}Object(k.a)(Ke,"AddinCommandsInitializerHost",null,[]);var jf=d(1117),wf=d(156);class eg extends Ke{constructor(t,P){super(t.Y4f());this.Mo=t;this.Yb=P;jf.a.r7b=jf.a.mah}kul(){this.uCj()}g4d(){const t=new wf.a;this.Yb.ka("51")&&(t.$(0,2),t.$(16,5));this.Yb.ka("187")&&t.$(1,1);this.Mo.od.Qta&&
t.$(8,1);this.Yb.ka("305")&&t.$(10,5);return t}FKe(t,P){this.Mo.QG().La(t,2,P)}}Object(k.a)(eg,"AddinCommandsInitService",Ke,[988]);class Ng{constructor(){this.K=null}get name(){return"PowerPointWebEditor.AddinCommands"}$b(t){this.K=t;A.a.instance.register(eg,"PowerPointWebEditor.AddinCommandsInitService").as("PowerPointWebEditor.IAddinCommandsInitService").oa(()=>new eg(this.K.resolve("PowerPointWebEditor.IApplicationContext"),this.K.resolve("Common.IAppSettingsManager"))).ma()}init(){this.K.resolve("PowerPointWebEditor.IApplicationSettings").Vdg&&
this.K.resolve("Common.IAppSettingsManager").jf(()=>{A.a.instance.resolve("PowerPointWebEditor.IAddinCommandsInitService").kul()})}dispose(){}}Object(k.a)(Ng,"AddInCommandsInitPackage",null,[2,3]);class Ug extends Kf{constructor(t,P=null){super(t,!0,P,!1)}get Ebe(){return null}get Nma(){return v.AFrameworkApplication.ksa?CommonUIStrings.l_DownLoadACopyDialogMessage:CommonUIStrings.l_PrintDialogDocumentIsPrinting}get iAb(){return CommonUIStrings.l_DownloadAsPdfDialogLinkSuggestion}get buttonText(){return CommonUIStrings.l_Download}get dGc(){return null}}
Object(k.a)(Ug,"DownloadAsPdfDialog",Kf,[]);class Ah extends Ug{constructor(t){super(t)}get Nma(){return v.AFrameworkApplication.ksa?CommonUIStrings.l_DownLoadACopyDialogMessage:ResourceStrings.l_DownloadAsPdfDialogPdfReady}wac(){O.a.J(25544926,801,50,"Images download dialog displayed")}yac(){O.a.J(25544928,801,50,"Images download dialog link clicked")}ubb(){O.a.J(25544930,801,50,"Images download dialog button clicked")}}Object(k.a)(Ah,"DownloadACopyAsImagesDialog",Ug,[]);var We=d(195);class lk extends md{constructor(t){super(t,
void 0,v.AFrameworkApplication.ksa)}get Nma(){return ResourceStrings.l_DownloadAsOdpDialogOdpReady}get iAb(){return ResourceStrings.l_DownloadAsOdpDialogLinkSuggestion}get bac(){return"DownloadOdpLink"}get buttonText(){return ResourceStrings.L_Download}get X0b(){return v.AFrameworkApplication.ksa?"UIFontDialogTextLarge":null}wac(){O.a.J(8958087,801,50,"ODP download dialog displayed")}yac(){O.a.J(8958089,801,50,"ODP download dialog link clicked")}ubb(){O.a.J(19505496,801,50,"ODP download dialog button clicked")}F0c(){We.Redirect.showHelp("PPTODF");
return!0}get Z$b(){return v.AFrameworkApplication.fa&&v.AFrameworkApplication.fa.ka("EnableReactDialogs")&&$c.a("ReactDialogsODPDialogFix")?null:"#"}get ZUa(){return ResourceStrings.l_DownloadAsOdpDialogLearnMoreLinkText}get yYg(){return!v.AFrameworkApplication.ksa}}Object(k.a)(lk,"DownloadACopyAsOdpDialog",md,[]);class jm extends Ug{constructor(t){super(t)}get Nma(){return v.AFrameworkApplication.ksa?CommonUIStrings.l_DownLoadACopyDialogMessage:ResourceStrings.l_DownloadAsPdfDialogPdfReady}wac(){O.a.J(21050910,
801,50,"PDF download dialog displayed")}yac(){O.a.J(21050912,801,50,"PDF download dialog link clicked")}ubb(){O.a.J(21050914,801,50,"PDF download dialog button clicked")}}Object(k.a)(jm,"DownloadACopyAsPdfDialog",Ug,[]);var Kh=d(1141),$d=d(385);class xk extends $d.a{constructor(t,P,ia){super();this.QX=null;this.Y2c=0;this.Qd=this.FFg=null;this.Bak=t;this.N5j=P;this.j3j=ia;this.EYa=Object(r.a)(this,this.q5,"onRequestComplete");this.onError=Object(r.a)(this,this.ask,"onRequestError")}get Rjc(){return this.FFg}set Rjc(t){this.FFg=
t}get Ws(){return this.Qd}set Ws(t){this.Qd=t}start(){this.fMb()}fMb(){1!==v.AFrameworkApplication.Aa.state&&(this.QX=new Kh.a,this.QX.yr=!1,this.QX.xd=5,this.QX.message=this.Bak,this.QX.Boa(ResourceStrings.l_GenericDialogTitle,null,null),this.Y2c=0)}iT(){this.QX&&(this.QX.close(),this.QX=null)}q5(t){this.iT();t.MRa?this.Rjc(t):this.OY()}ask(t){t.NTi&&this.Y2c<xk.R_k?(this.Y2c+=1,t.start()):this.OY()}OY(){this.iT();if(1!==v.AFrameworkApplication.Aa.state){const t=new ua.StandardDialog;t.xd=0;t.zy(this.j3j,
ResourceStrings.l_GenericDialogTitle,this.N5j,this.Ws)}}}xk.R_k=3;Object(k.a)(xk,"UIBlockingTask",$d.a,[]);var Ie=d(275);class Yd extends xk{constructor(t){super(ResourceStrings.l_ConvertingToOdpProgressString,ResourceStrings.l_ConvertingToOdpErrorString,Lk.a.Xkk);this.gB=t}start(){super.start();Ie.a.Izi(this.gB,Object(r.a)(this,this.gda,"handleWebserviceResponse"),Object(r.a)(this,this.fda,"handleWebserviceError"))}}Object(k.a)(Yd,"ConvertToOdpTask",xk,[]);class Pe extends xk{constructor(t){super(ResourceStrings.L_PrintingProgressString,
ResourceStrings.l_ConvertingToPdfErrorString,Lk.a.lzk);this.gB=t}start(){super.start();Ie.a.Kzi(this.gB,Object(r.a)(this,this.gda,"handleWebserviceResponse"),Object(r.a)(this,this.fda,"handleWebserviceError"))}}Object(k.a)(Pe,"ConvertToPdfTask",xk,[]);class so{constructor(t,P,ia){this.r3c=t;this.ze=P;this.Sqe=ia}get lub(){return this.r3c.value}convert(t,P,ia){let Aa=null;0===P?this.Sqe?new lk(ia):(Aa=new Yd(t),Aa.Rjc=Object(r.a)(this,this.rnk,"onConvertOdpRequestSucceeded"),Aa.start()):1===P?this.ze.od.Kgg&&
this.Sqe?new jm(ia):Rh.a.ZK(Rh.a.Ib,()=>{Aa=new Pe(t);Aa.Rjc=Object(r.a)(this,this.snk,"onConvertPdfRequestSucceeded");Aa.start()}):2===P?this.ze.od.ajg&&this.Sqe&&new Ah(ia):Error.invalidOperation(String.format("Convert task type '{0}' is not supported",P))}rnk(t){t=t.result;1!==v.AFrameworkApplication.Aa.state&&(t=db.a.Wsa(t.PrintUrl),new lk(t))}snk(t){t=t.result;1!==v.AFrameworkApplication.Aa.state&&(t=db.a.Wsa(t.PrintUrl),this.lub.tGf=new Date,new jm(t),this.lub.aMf=new Date,O.a.J(21050908,801,
50,"DownloadACopyAsPdf-StartTime: {0}, DownloadACopyAsPdf-SaveEnd: {1}, DownloadACopyAsPdf-ConvertEnd: {2}, DownloadACopyAsPdf-DialogShowEnd: {3}.",this.lub.TNf.toString(),this.lub.Omh.toString(),this.lub.tGf.toString(),this.lub.aMf.toString()))}}Object(k.a)(so,"Converter",null,[989]);class Bj{constructor(){this.TNf=this.Omh=this.tGf=this.aMf=Vi.App.Um}}Object(k.a)(Bj,"DownloadACopyAsPdfContext",null,[]);class Qe extends xk{constructor(t,P){super(ResourceStrings.L_PrintingProgressString,ResourceStrings.L_PrintingErrorString,
Lk.a.DEk);this.gB=t;this.Qdk=P}start(){super.start();Ie.a.print(this.gB,this.Qdk,Object(r.a)(this,this.gda,"handleWebserviceResponse"),Object(r.a)(this,this.fda,"handleWebserviceError"))}}Object(k.a)(Qe,"PrintTask",xk,[]);class ln{constructor(t,P,ia){if(!t)throw Error.argumentNull("directPrintManager");this.bcc=t;this.ze=P;this.b6j=ia}Ark(t){this.bcc.PEk();t=t.result;1!==v.AFrameworkApplication.Aa.state&&(t=db.a.Wsa(t.PrintUrl),this.bcc.rvh(t))}print(t,P,ia){this.ze.od.Kgg&&this.b6j?(t=new Ni.QueryStringBuilder(P),
t.Ki(qf.a.nxk,this.bcc.ouh().toString()),t.Ki(qf.a.kxk,ia.toString()),this.bcc.rvh(t.toString())):(ia=new Qe(t,this.bcc.ouh()),ia.Rjc=Object(r.a)(this,this.Ark,"onPrintRequestSucceeded"),ia.start())}}Object(k.a)(ln,"Printer",null,[990]);class Yk{get name(){return"PowerPointWebEditor.PrintPackage"}$b(){A.a.instance.register(ln,"PowerPointWebEditor.Printer").as("PowerPointWeb.IPrinter").ma().oa(()=>new ln(A.a.instance.rb("Common.App.DirectPrint.IDirectPrintManager"),A.a.instance.rb("PowerPointWebEditor.IApplicationContext"),
A.a.instance.rb("PowerPointWebEditor.IApplicationSettings").wg));A.a.instance.register(so,"PowerPointWeb.Converter").as("PowerPointWeb.IConverter").ma().oa(()=>new so(A.a.instance.re("PowerPointWebEditor.DownloadACopyAsPdfContext"),A.a.instance.rb("PowerPointWebEditor.IApplicationContext"),A.a.instance.rb("PowerPointWebEditor.IApplicationSettings").wg));A.a.instance.register(Bj,"PowerPointWebEditor.DownloadACopyAsPdfContext").ma().oa(()=>new Bj)}init(){}dispose(){}}Object(k.a)(Yk,"PrintPackage",null,
[2,3]);class xf{constructor(t,P){this.actionId=t;this.rd=P}}Object(k.a)(xf,"CommandActionData",null,[]);class Vg{constructor(t,P,ia,Aa,Ka){this.NVg=[];this.yig=!1;this.boe=null;this.A2c=new ha.a;this.ia=t;this.pye=P;this.Opf=!1;this.Pb=ia;this.aJ=Aa;this.Lea=Ka;this.U7c=null}get Tsd(){return this.NVg}get v0g(){this.U7c||(this.U7c=v.AFrameworkApplication.Pj("officeExtensionMerge.js",5));return this.U7c}set v0g(t){this.U7c=t}get Bci(){if(!this.boe){const t=[this.Lea.I0b(this.v0g)];this.boe=Mb.a.create("pptedit.appforoffice",
t,()=>d.e(9).then(d.bind(null,1225)))}return this.boe}v6h(t){this.Tsd.push(t)}Kia(){this.yig||(Kc.a.Wx(this.Bci),this.yig=!0)}Ksl(){for(const t of this.Tsd)t.Tjb();this.NVg=[]}Lsl(){var t=this.Pb.Nc(this.pye.Cf).Bb(18);t=this.Pb.Nc(t);let P=t.Bb(19);if(P){do P=t.xq,this.ia.La(hb.a.kib,2,P.eb(Yb.a.IZ));while(t.Af(19))}}fPa(t,P){this.A2c.add(new xf(t,P))}Qpj(){if(0<this.A2c.count){for(let t of this.A2c)this.ia.La(t.actionId,2,t.rd);this.A2c.clear()}}mae(){const t=!!this.Tsd&&0<this.Tsd.length;let P=
!1;if(this.pye.Cf&&!t){const ia=this.Pb.Nc(this.pye.Cf).Bb(18);ia&&0<this.Pb.Nc(ia).p8(19)&&(P=!0)}return t||P}}Object(k.a)(Vg,"AppForOfficeManagerFactory",null,[969]);class mn extends uf{constructor(t,P,ia){super(t,P);this.la=ia;this.Ty=hb.a.Dsb}Nta(t){if(t&&t.length){var P=hb.a.Qz(this.Ty),ia=this.LIj(t[0]);try{O.a.J(512517845,352,50,"ChangeOnlineImageHelper: InsertMediaCallback() - Change online images, from command: {0} to command: {1}.",P,ia?"ChangeOnlineIconUpload":"ChangeOnlinePictureUpload");
if(32!==(ia?this.zn.La(hb.a.zIc,2,t):this.zn.La(this.Ty,2,t[0])))throw Error.invalidOperation(String.format("Failed to change online images, command: {0}.",ia?"ChangeOnlineIconUpload":"ChangeOnlinePictureUpload"));O.a.J(512517844,352,50,"ChangeOnlineImageHelper: InsertMediaCallback() - Change online images successfully, from command: {0} to command: {1}.",P,ia?"ChangeOnlineIconUpload":"ChangeOnlinePictureUpload")}catch(Aa){O.a.J(512517843,352,10,"ChangeOnlineImageHelper: InsertMediaCallback() - {0}: Exception = [{1}].",
P,Aa.toString())}}}LIj(t){(t=!!t&&!!t.OriginalUrl&&0<t.OriginalUrl.length&&this.la.pptSmartArtSubNodeIconChangeEnabled&&!!this.la.powerPointInsertContentSvgPath&&0<this.la.powerPointInsertContentSvgPath.length&&0<=t.OriginalUrl.toLowerCase().indexOf(this.la.powerPointInsertContentSvgPath.toLowerCase())&&t.OriginalUrl.toLowerCase().indexOf(".svg")===t.OriginalUrl.length-4)||O.a.J(512517842,352,50,"isChangeSvg = false");return t}}Object(k.a)(mn,"ChangeOnlineImageHelper",uf,[]);class Hm extends uf{constructor(t,
P,ia){super(t,P);this.la=ia;this.Ty=hb.a.O$a}Nta(t){if(t&&t.length){var P=hb.a.Qz(this.Ty),ia=new Map;ia.set("InsertMediaCommand",P);Vb.Health.instance.recordKpiUsageForAlertableKpi("InsertOnlineImage",null,ia);try{const Ka=[],pb=[];for(let kc=0;kc<t.length;kc++){const Rc=t[kc];this.ghg(Rc)?Array.add(Ka,Rc):Array.add(pb,Rc)}O.a.J(512517841,352,50,"InsertMediaCallback:  Insert {0} pictures {1} svg images, command: {2}.",pb.length,Ka.length,P);let Nb=this.Ty;Nb===hb.a.zWc&&(Nb=hb.a.CWc);for(t=0;t<pb.length;t++){var Aa=
this.zn.La(Nb,2,pb[t]);if(32!==Aa)throw Error.invalidOperation(String.format("Failed to upload picture {0} with command {1}.",pb.toString(),P));}if(this.ghg(Ka[0])&&(Aa=this.zn.La(hb.a.zWc,2,Ka),32!==Aa))throw Error.invalidOperation(String.format("Failed to insert M365 svg images {0}",Ka.toString()));O.a.J(512517840,352,50,"InsertMediaCallback: Insert {0} pictures {1} svg images success, command: {2}.",pb.length,Ka.length,P)}catch(Ka){O.a.J(512517839,352,10,"InsertMediaActor::{0}: Exception = [{1}].",
this.Ty.toString(),Ka.toString()),ia.set("Exception",Ka.toString()),Vb.Health.instance.recordKpiFailure("InsertOnlineImage","InsertMediaException",!1,!0,Object.assign(new Fg.a,{extendedProperties:ia}))}}}ghg(t){(t=!!t&&!!t.OriginalUrl&&0<t.OriginalUrl.length&&this.la.N$a&&!!this.la.powerPointInsertContentSvgPath&&0<this.la.powerPointInsertContentSvgPath.length&&0<=t.OriginalUrl.toLowerCase().indexOf(this.la.powerPointInsertContentSvgPath.toLowerCase())&&t.OriginalUrl.toLowerCase().indexOf(".svg")===
t.OriginalUrl.length-4)||O.a.J(512517838,352,50,"isInsertSvg = false");return t}}Object(k.a)(Hm,"InsertOnlineImageHelper",uf,[]);var Im=d(712);class ff{constructor(t,P){this.cdb=!1;this.xdb=new Date(0);this.wdb=new Date(0);this.rze=t;this.zb=P}D7f(){this.cdb=!0}mKa(){this.cdb?O.a.J(593884831,813,100,"PrefetchScheduler::ScheduleJob: A scan has been requested but we have been paused or halted."):this.xdb>this.wdb?O.a.J(593884829,813,100,"PrefetchScheduler::ScheduleJob: A scan has been requested but we are already waiting for a different scan. Last scan schedule at "+
this.xdb+". Last scan at "+this.wdb+"."):(this.xdb=new Date,this.zb.Eb(new D.a(3,1,0,Object(r.a)(this,this.pRe,"runJob"),90,"112")))}pRe(){this.wdb=new Date;this.cdb?O.a.J(593884827,813,100,"PrefetchScheduler::RunJob: We were halted while waiting to be scheduled, so we won't do our work."):this.rze()&&this.mKa()}}Object(k.a)(ff,"PrefetchScheduler",null,[]);class to{constructor(t,P,ia){this.m2c=null;this.zwg=P;this.Cqg=ia;this.DAb=t}e4k(t){this.DAb!==t&&(this.DAb=t,this.m2c=null)}zij(){this.m2c||(this.m2c=
this.lni());return this.m2c}lni(){const t=[];Array.add(t,this.DAb);for(let P=1;P<=this.zwg||P<=this.Cqg;P++)P<=this.zwg&&Array.add(t,this.DAb+P),P<=this.Cqg&&0<=this.DAb-P&&Array.add(t,this.DAb-P);return t}}Object(k.a)(to,"SlideWindow",null,[]);class nn{constructor(t,P,ia,Aa,Ka,pb,Nb,kc){this.Zeb=!1;this.jc=Ka;this.jq=Aa;this.pwa=kc;this.FAb=new Im.a;this.hA=new ff(Object(r.a)(this,this.F1e,"tryScan"),pb);this.OWg=new to(Aa&&Aa.Ba?Aa.Ba.slideIndex:0,Nb?Nb.Vll:10,Nb?Nb.Ull:5);this.VUe(t,P,ia)}start(){this.Zeb?
O.a.J(593884825,813,100,"StreamVideoPrefetchOrchestrator::Start: Trying to start StreamVideoPrefetchOrchestrator twice."):(O.a.J(593773075,813,100,"StreamVideoPrefetchOrchestrator Starting."),this.Zeb=!0,this.hA.mKa())}VUe(t,P,ia){t&&t.kI(Object(r.a)(this,this.Fdd,"onEditSlideChanged"));P&&P.mia(Object(r.a)(this,this.Ded,"onPageContentLoaded"));ia&&ia.nPa(Object(r.a)(this,this.ttk,"onSlideshowSlideChanged"))}Ded(t,P){this.Zeb&&(t=Object(R.a)(116,P.node))&&t.aE&&(this.FAb.remove(t.Cb),this.hA.mKa())}Fdd(t,
P){P&&P.Uma&&this.sB(P.Uma.slideIndex)}ttk(t,P){P&&this.sB(P.slideIndex)}sB(t){this.OWg.e4k(t);this.Zeb&&this.hA.mKa()}F1e(){const t=this.V8d();0<t.length&&this.TRe(t[0]);return 1<t.length}V8d(){const t=[];var P=this.jq.presentation;if(!P)throw Error.argumentNull("Presentation is null");P=P.slides||[];for(const ia of this.OWg.zij()){const Aa=P[ia];this.vdl(Aa)&&Array.add(t,Aa)}return t}vdl(t){return!!t&&t.aE&&!t.ON&&!this.FAb.contains(t.Cb)}TRe(t){this.FAb.add(t.Cb);t=this.jjj(t);0<t.length&&(O.a.J(593773072,
813,100,"StreamVideoPrefetchOrchestrator::ScanSlide: Found {0} videos.",t.length),this.pwa?this.pwa.oDk(t):O.a.J(593773070,813,10,"StreamVideoPrefetchOrchestrator::ScanSlide: Found videos to prefetch, but StreamPreFetchService is null."))}jjj(t){if(!this.jc)return O.a.J(593884821,813,10,"StreamVideoPrefetchOrchestrator::GetStreamVideosToLoadForSlide: SlideReader is null, so we cannot scan slides for Stream videos."),this.hA.D7f(),[];const P=[];if(!t)return P;t=Object(R.a)(116,t);if(!t)return P;for(const ia of t.Pk())(t=
ia.cpa)&&this.pwa&&this.pwa.Sab(t)&&Array.add(P,t);return P}static JQj(t){return!!t&&t.lkg&&!ve.a.Ni&&!ve.a.$Ea&&!ve.a.JI&&!ve.a.rle}}Object(k.a)(nn,"StreamVideoPrefetchOrchestrator",null,[]);class Uf{static addAppPLTEventToLog(t){try{Microsoft.VersionHistory.VersionHistoryLogHelper.addAppPLTEventToLog(t)}catch(P){}}static setIsPageLoadForFirstTime(t){try{Microsoft.VersionHistory.VersionHistoryLogHelper.setIsPageLoadForFirstTime(t)}catch(P){}}}Object(k.a)(Uf,"VersionHistoryLogConnector",null,[]);
class Cj{constructor(t,P,ia,Aa){this.aY=null;this.gkh=this.ResetAppVersionController;this.xw=t;this.Bi=P;this.Ga=ia;this.qc=Aa;this.NXa={}}OnVersionHistorySelected(t,P){try{O.a.J(39105290,822,50,"PPTVersionHistorySelectionHandler:OnVersionHistorySelected");const ia=document.getElementById("VersionHistoryViewerSpinner");ia&&(ia.style.display="none");if(this.aY)this.aY.onVersionSelected(t,P,this.NXa)}catch(ia){O.a.J(39146258,822,50,"PPTVersionHistorySelectionHandler: OnVersionHistorySelected failed due to exception. {0}",
ia)}}ResetAppVersionController(t){try{if(this.aY)Uf.setIsPageLoadForFirstTime(!1),this.aY.switchParentViewContainer(t);else{Uf.setIsPageLoadForFirstTime(!0);const P=new PowerPointVersionHistory.AppBootSettings;P.RenderServiceBase="";P.IsRtl=!1;const ia=new PowerPointVersionHistory.AppCallbackBag;ia.animationDecoratorCallback=Object(r.a)(this.xw,this.xw.cWd,"createAnimationOrTransitionStar");ia.notesIconDecoratorCallback=Object(r.a)(this,this.CreateNotesIcon,"CreateNotesIcon");P.IsHighContrast=!1;
this.Bi&&(P.IsHighContrast=this.Bi.isInHighContrastMode);P.IsHighContrast&&(P.ClientColorSettings=this.Bi.highContrastColors.foregroundTextColor+"_"+this.Bi.highContrastColors.backgroundColor+"_"+this.Bi.highContrastColors.linkColor);if(this.qc){const Aa=this.qc.OSa();P.DefaultSlideWidth=Aa.width;P.DefaultSlideHeight=Aa.height}P.UserSessionId=v.AFrameworkApplication.userSessionId;P.VersionViewerCssUrl=this.Ga.versionHistoryViewerCssUrl;P.ProgressImageResourceUrl=ig.a.RK(Xb.a.Bna);this.aY=new PowerPointVersionHistory.AppVersionController(P,
t,ia)}}catch(P){O.a.J(39146260,822,50,"PPTVersionHistorySelectionHandler: ResetAppVersionController failed due to exception. {0}",P)}}CreateNotesIcon(){return Da.createClusteredImage(14,14,"ToolbarNotesActiveDark_14x14x32",null,!0,"Notes")}}Object(k.a)(Cj,"PPTVersionHistorySelectionHandler",null,[960]);class ao extends md{constructor(t){super(t,void 0,v.AFrameworkApplication.ksa)}get Nma(){return CommonUIStrings.l_DownLoadACopyDialogMessage}get iAb(){return CommonUIStrings.l_DownLoadACopyDialogLinkSuggestion}get bac(){return"PowerPointDownloadCopyLink"}get buttonText(){return CommonUIStrings.l_Download}get X0b(){return v.AFrameworkApplication.ksa?
"UIFontDialogTextLarge":null}wac(){O.a.J(19743688,801,50,"Download a copy dialog displayed")}yac(){O.a.J(19743690,801,50,"Download a copy dialog clicked")}ubb(){O.a.J(19743692,801,50,"Download a copy dialog button clicked")}}Object(k.a)(ao,"PowerPointDownloadACopyDialog",md,[]);class bo{Pgl(t){new ao(t)}}Object(k.a)(bo,"PowerPointDownloadACopyDialogFactory",null,[767]);var Um;(function(t){t[t.unknown=0]="unknown";t[t.bing=1]="bing";t[t.M365=2]="M365";t[t.icons=3]="icons";t[t.oneDrive=4]="oneDrive";
t[t.hubbleVideos=5]="hubbleVideos"})(Um||(Um={}));Object(k.b)("InsertMediaProviders",Um);var Wf;(function(t){t[t.OK=0]="OK";t[t.cancel=1]="cancel";t[t.error=2]="error";t[t.open=3]="open"})(Wf||(Wf={}));Object(k.b)("HubbleAction",Wf);var on=d(525);class vg extends cd.a{constructor(t,P,ia,Aa,Ka){super();this.zD=null;this.rxc=!1;this.jdc=this.fEd=this.DX=null;this.$Rd="KeepFocusDiv";this.aSd="KeepFocusStartDiv";this.correlationId=null;this.f5=0;this.insertPictureTelemetryEndpoint=null;this.cZd=0;if(!t)throw Error.argumentNull("insertMediaSeviceEndpoint",
"insertMediaSeviceEndpoint cannot be null.");this.bcf=t;this.R8e="";this.ESb=ia;this.P1=Aa;this.WAa=[];this.dHd=P;this.qg=Ka||Rd.qg;this.ig="InsertMediaDialog";this.oae=!1;this.xd=5}cMb(t,P){this.R8e=t;this.rxc=!1;this.showDialog(this.R8e,null);this.DX=this.oRc(this.Nh("insertmediaframe"));if(!this.DX)throw this.X7a(this.zHc),Error.invalidOperation("Couldn't get InsertMediaIframe.");(t=document.getElementById(this.Nh("WACDialogPanel")))&&t.setAttribute(pa.a.af,pa.a.jQd);t=document.createElement("div");
t.setAttribute("Id",this.aSd);t.setAttribute("tabindex","0");t.setAttribute("position","absolute");t.setAttribute("width","-1000px");t.setAttribute("top","-1000px");this.DX.parentNode.insertBefore(t,this.DX.parentNode.firstChild);t=document.createElement("div");t.setAttribute("Id",this.$Rd);t.setAttribute("tabindex","0");this.DX.parentNode.appendChild(t);t.setAttribute("position","absolute");t.setAttribute("width","-1000px");t.setAttribute("top","10000px");$addHandler(this.bZd,"keydown",Object(r.a)(this,
this.Sz,"keyDownHandler"));this.DX.setAttribute("src",this.bcf);this.DX.setAttribute("width","100%");this.DX.setAttribute("height","100%");this.DX.setAttribute("frameborder","0");v.AFrameworkApplication.fa.ka("ShowInsertMediaIframeWhenIframeIsReady")&&(ve.a.fg||ve.a.Z9b)?(this.DX.style.visibility="hidden",this.jdc=Object(r.a)(this,this.Bpk,"onInsertMediaIframeLoaded"),nd.a.addHandler(this.DX,"load",this.jdc)):this.DX.style.visibility="visible";this.oRc(this.Nh("WACDialogTitleText")).style.display=
"none";if(2===this.f5||5===this.f5)this.oRc(this.Nh("WACDialogTitlePanel")).style.display="none",this.oRc(this.Nh("WACDialogBodyPanel")).style.padding="0";Wb.FocusManager.instance().yl().scope.zL=!0;this.zD=this.dHd.getInstance(this.DX.contentWindow,this.bcf);this.zD.uBa("https://osiziwuspersimmon002.blob.core.windows.net");this.zD.uBa("https://osizewuspersimmon001.blob.core.windows.net");this.zD.uBa("https://osizpscuspersimmon000.blob.core.windows.net");this.zD.uBa("https://cdn.hubblecontent.msit.osi.office.net");
this.zD.uBa("https://cdn.hubblecontent.osi.office.net");this.zD.Hxa(ed.a.Pqf,ia=>{this.vlk(ia,Object(r.a)(P,P.Nta,"insertMediaCallback"))});this.zD.Hxa(ed.a.insert,ia=>{this.cGe(ia,Object(r.a)(P,P.Nta,"insertMediaCallback"))});this.zD.Hxa(ed.a.O5h,ia=>{this.Pqk(ia)});this.zD.Hxa(ed.a.b6i,Object(r.a)(this,this.Lok,"onGetCustomHeaders"));this.zD.Hxa(ed.a.uhj,Object(r.a)(this,this.Wok,"onGetSessionId"));this.zD.Hxa(ed.a.b3i,Object(r.a)(this,this.Iok,"onGetCID"));this.zD.Hxa(ed.a.roi,Object(r.a)(this,
this.Cmk,"onCancelDialog"));2===this.f5&&0===this.cZd&&(this.zD.Hxa(ed.a.vXj,Object(r.a)(this,this.Xpk,"onLaunchM365Upsell")),this.fEd=this.P1.Vhb("MsoPremiumStockImages",ia=>{n.ULS.sendTraceTag(512497694,352,50,"OnCompleteM365Upsell: Thanks for purchasing!");this.zD.sendMessage(ed.a.tBl,{["LicenseTier"]:ia.toString()})}));this.cpc(3)}Bpk(){this.DX&&(this.DX.style.visibility="visible",window.setTimeout(()=>{if(this.hi){const t=this.hi.getElementById("insertmediaframe");t&&t.focus()}},0))}Sz(t){t.keyCode===
Sys.UI.Key.tab&&(t.target.id!==this.$Rd||t.shiftKey?t.target.id===this.aSd&&t.shiftKey&&(t.preventDefault(),this.hi.getElementById(this.$Rd).focus()):(t.preventDefault(),this.hi.getElementById(this.aSd).focus()))}dispose(){this.P1&&this.fEd&&this.P1.rJb("MsoPremiumStockImages",this.fEd);this.zD&&(this.zD.dispose(),this.zD=null);this.jdc&&(nd.a.removeHandler(this.DX,"load",this.jdc),this.jdc=null);super.dispose()}vlk(t,P){n.ULS.sendTraceTag(7135752,352,100,"OnAddItem : Got message.");if(t=this.ESb.U8g(t))50<
this.WAa.length?n.ULS.sendTraceTag(7135753,352,15,"OnAddItem : Only allow 50 items to be added."):(Array.add(this.WAa,t),this.rxc&&(P(this.WAa),this.rxc=!1))}Cmk(){n.ULS.sendTraceTag(17662422,352,100,"OnCancelDialog : Got message.");this.X7a(this.zHc);this.cpc(1)}cpc(t){var P=RegExp("hubble","gi");if(this.insertPictureTelemetryEndpoint&&0<this.insertPictureTelemetryEndpoint.search(P)&&this.correlationId){P=v.AFrameworkApplication.gd;var ia={};ia.InsertedFiles=this.WAa.length;ia.DialogResult=Wf[t];
ia.DialogMode=this.lbj();ia.CorrelationId="{"+this.correlationId.toString()+"}";ia.Platform="Wac";ia.Provider=Um[this.f5]||"Unknown";ia.AudienceGroup=P&&"AudienceGroup"in P?P.AudienceGroup.toString():"Unknown";ia.Ring=P&&"Ring"in P?P.Ring.toString():"Unknown";ia.AppId=Vi.App.mode;ia.Build=v.AFrameworkApplication.buildVersion;ia.Locale=Xk.a.ue(v.AFrameworkApplication.lcid).name;this.vxa().send(JSON.stringify(ia))}if(2===this.f5||5===this.f5){const Aa=v.AFrameworkApplication.fa.Ha("InsertMediaDialogAriaTenantNameSpace");
Aa&&""!==Aa&&(P=[],ia="InsertUnknownContent",2===this.f5?(Array.add(P,Object.assign(new H.a,{name:"DialogMode",string:"M365Content"})),Array.add(P,Object.assign(new H.a,{name:"Provider",string:"M365Content"})),ia="InsertM365Content"):5===this.f5&&(Array.add(P,Object.assign(new H.a,{name:"DialogMode",string:"HubbleVideo"})),Array.add(P,Object.assign(new H.a,{name:"Provider",string:"HubbleVideo"})),ia="InsertHubbleVideo"),Array.add(P,Object.assign(new H.a,{name:"InsertedFiles",int64:this.WAa.length})),
Array.add(P,Object.assign(new H.a,{name:"DialogResult",string:Wf[t]})),Array.add(P,Object.assign(new H.a,{name:"CorrelationId",string:this.correlationId.toString()})),w.a.sendTelemetryEvent(Object.assign(new I.a,{name:String.format("{0}.{1}",Aa,ia),dataFields:P})))}}lbj(){return 3===this.f5?"Icons":"Images"}oRc(t){const P=document.getElementById(t);if(!P)throw Error.invalidOperation(String.format("Couldn't get {0}.",t));return P}vxa(){const t=new XMLHttpRequest;t.open("POST",this.insertPictureTelemetryEndpoint,
!0);t.setRequestHeader("Content-Type","");return t}cGe(t,P){n.ULS.sendTraceTag(7135754,352,100,"OnInsert : Got message.");this.X7a(this.zHc);P?this.WAa&&0<this.WAa.length?(P(this.WAa),this.cpc(0)):(n.ULS.sendTraceTag(23078422,352,15,"Empty search result."),this.rxc=!0,P(this.WAa),this.cpc(2)):this.cpc(2)}Lok(){this.zD&&(n.ULS.sendTraceTag(7135755,352,100,"OnGetCustomHeaders : Got message."),this.zD.sendMessage(ed.a.t5k,{["CustomHeaders"]:""}))}Wok(){this.zD&&(n.ULS.sendTraceTag(7135756,352,100,"OnGetSessionId : Got message."),
this.zD.sendMessage(ed.a.j9k,{["SessionId"]:v.AFrameworkApplication.userSessionId||"00000000-0000-0000-0000-000000000000"}))}Iok(){this.zD&&(n.ULS.sendTraceTag(7135757,352,100,"OnGetCID : Got message."),this.zD.sendMessage(ed.a.P4k,{["CID"]:""}))}Pqk(t){t&&t.Values&&(t=t.Values,delete t.m_Origin,delete t.m_Source,delete t.m_ReceivedTime,n.ULS.sendTraceTag(51652562,352,50,"Received OTel event: "+t.eventName||!1),w.a.sendOtelEvent(Object.assign(new on.a,{otelEvent:t})))}Xpk(){this.P1&&(n.ULS.sendTraceTag(512497693,
352,50,"OnLaunchM365Upsell: Launch Dime Upsell flow from Stock Image picker."),this.P1.launchUpsellExperience("stockimages"))}}Object(k.a)(vg,"InsertMediaDialog",cd.a,[980,106]);class Td{getInstance(t,P,ia,Aa,Ka){return new vg(t,P,ia,Aa,Ka)}}Object(k.a)(Td,"PptInsertMediaDialogFactory",null,[959]);var Kj=d(111);class uo{constructor(t){this.Icb=t;this.VUe(this.Icb.Rk,this.Icb.jGg)}VUe(t,P){t&&t.kI(Object(r.a)(this,this.Fdd,"onEditSlideChanged"));P&&P.mia(Object(r.a)(this,this.Ded,"onPageContentLoaded"))}jSk(t,
P){t&&t.F5(Object(r.a)(this,this.Fdd,"onEditSlideChanged"));P&&P.OZa(Object(r.a)(this,this.Ded,"onPageContentLoaded"))}Ded(t,P){(t=Object(R.a)(116,P.node))&&t.aE&&(this.Icb.FAb.remove(t.Cb),this.Icb.hA.mKa())}Fdd(t,P){P&&P.Uma&&(this.Icb.OVa=P.Uma,this.Icb.hA.mKa(),this.Icb.Lne=new Date)}}Object(k.a)(uo,"SlideEventListener",null,[]);class co{constructor(t,P,ia){this.vUg="";this.cdb=!1;this.xdb=new Date(0);this.wdb=new Date(0);this.rze=t;this.zb=P;ia&&(this.vUg=ia)}D7f(){this.cdb=!0}mKa(){this.cdb?
O.a.J(591003664,813,100,"BackgroundJobScheduler::ScheduleJob: A scan has been requested but we have been paused or halted."):this.xdb>this.wdb?O.a.J(591003662,813,100,"BackgroundJobScheduler::ScheduleJob: A scan has been requested but we are already waiting for a different scan. Last scan schedule at "+this.xdb+". Last scan at "+this.wdb+"."):(this.xdb=new Date,this.zb.Eb(new D.a(3,1,0,Object(r.a)(this,this.pRe,"runJob"),90,this.vUg)))}pRe(){this.wdb=new Date;this.cdb?O.a.J(591003660,813,100,"BackgroundJobScheduler::RunJob: We were halted while waiting to be scheduled, so we won't do our work."):
this.rze()&&this.mKa()}}Object(k.a)(co,"BackgroundJobScheduler",null,[]);class Ml{constructor(t,P,ia,Aa,Ka,pb,Nb,kc,Rc,Yc,hd){this.y$c=null;this.Lne=new Date;this.OVa=null;this.bwg={};this.gVg={};this.UVg={};this.Yug={};if(!ia)throw Error.argumentNull("graphTopologyManager");if(!Aa)throw Error.argumentNull("fontUtilsManager");this.jq=ia;this.az=Aa;this.Rk=t;this.jGg=P;this.uEb=kc;this.vXa=Rc;this.vEb=Yc;this.o$c=hd;this.FAb=new Im.a;this.hA=new co(Object(r.a)(this,this.F1e,"tryScan"),Ka,"");0<pb&&
window.setInterval(Object(r.a)(this,this.sog,"logMissingFonts"),pb);this.D9j=Nb;t=ia.Ba?ia.Ba.slideIndex:0;if(P=this.jq.presentation)P=P.slides||[],t<P.length&&(this.OVa=P[t],this.Lne=new Date)}dispose(){this.stop();this.sog()}start(){this.stop();this.y$c=new uo(this);this.hA.mKa()}stop(){this.y$c&&this.y$c.jSk(this.Rk,this.jGg);this.y$c=null}V8d(){const t=[];this.OVa&&t.push(this.OVa);return t}F1e(){const t=this.V8d();0<t.length&&(this.TRe(t[0]),this.FAb.add(t[0].Cb));return 1<t.length}Qme(t,P,ia,
Aa){const Ka=[];for(const pb of Object.keys(t))t[pb]||this.Yug[pb]||(Ka.push(pb),this.Yug[pb]=!0);t=Ka.length;0<t&&(O.a.J(ia,820,15,"{0}",t),P&&O.a.J(Aa,820,15,"{0}",Ka.join(",")))}TRe(t){const P=t.SSa();if(P&&(this.uEb||this.vEb||this.vXa||$c.a("ShouldLogMissingThirdPartyFontCount"))){var ia={},Aa={},Ka={};t.yUf.split(",").forEach(Yc=>{Yc&&(Yc=this.az.$F(Yc),ia[Yc]=!1)});t.cBh.split(",").forEach(Yc=>{Yc&&(Yc=this.az.$F(Yc),Aa[Yc]=!1)});t.LEh.split(",").forEach(Yc=>{Yc&&(Yc=this.az.$F(Yc),Ka[Yc]=
!1)});t=[];var pb=[],Nb=[];for(let Yc=0;Yc<P.length;Yc++){var kc=P[Yc];kc=Array.isArray(kc.WD())?kc.WD():null;for(const hd of kc)for(kc=0;hd.Ra&&kc<hd.Ra.length;){var Rc=hd.Ra.ga(kc);Rc=Rc.formatting?this.az.$F(Kj.Font.MDa(Rc.formatting.cache.zN.trim().toLowerCase())):"";ab.a.Wa(Rc)||(Rc in ia&&!ia[Rc]?(t.push(Rc),ia[Rc]=!0):Rc in Aa&&!Aa[Rc]?(pb.push(Rc),Aa[Rc]=!0):Rc in ia||Rc in Aa||Ka[Rc]||(Nb.push(Rc),Ka[Rc]=!0));kc++}}this.uEb&&(Ml.Pce(this.bwg,t,this.az),this.Qme(ia,!0,555886295,555886296));
if(this.vXa||$c.a("ShouldLogMissingThirdPartyFontCount"))Ml.Pce(this.gVg,pb,this.az),this.Qme(Aa,this.vXa||this.o$c,555886297,555886298);this.vEb&&(Ml.Pce(this.UVg,Nb,this.az),this.Qme(Ka,this.o$c,555886299,555886300))}}sog(){+new Date-+this.Lne<this.D9j||(this.uEb&&Ml.$me(this.bwg,this.az,591003669,!0,"MissingFirstPartyFonts"),(this.vXa||$c.a("ShouldLogMissingThirdPartyFontCount"))&&Ml.$me(this.gVg,this.az,591003667,this.vXa||this.o$c,"MissingThirdPartyFonts"),this.vEb&&Ml.$me(this.UVg,this.az,587337796,
this.o$c,"MissingNonLoggableFonts"))}static Pce(t,P,ia){P.forEach(Aa=>{$c.a("ShouldNormalizeFontNamesBeforeLogging")&&(Aa=ia.$F(Aa));if(void 0===t[Aa]||null===t[Aa])t[Aa]=!1})}static Fbj(t,P){if(!t)throw Error.argumentNull("fonts");const ia=[];for(const Aa of Object.keys(t))t[Aa]||(P.T8(Aa)||P.T8('"'+Aa+'"')||ia.push(Aa),t[Aa]=!0);return ia}static $me(t,P,ia,Aa,Ka){P=Ml.Fbj(t,P);t=P.length;0<t&&(P=P.join(","),Aa&&587337796===ia?O.a.J(ia,820,15,"{0}",P):O.a.J(ia,820,15,"{0}",Aa?P:t.toString()),ia=
new Map,Aa&&ia.set("Fonts",P),ia.set("FontsCount",t.toString()),Vb.Health.instance.recordQosError(Ka,["MissingFont"],!1,!1,!0,!1,Object.assign(new Fg.a,{extendedProperties:ia})))}}Object(k.a)(Ml,"FontLogger",null,[106]);var Jm=d(955),Cn=d(957);class Zk{constructor(t,P,ia,Aa,Ka,pb,Nb,kc,Rc,Yc,hd,se,Ae){this.Tfa=(we,Jf)=>{var Yh;this.Pf&&(this.Pf.Va("MediaFileValidationPassedOnUI","false"),this.Pf.Va("ErrorMessage",null===(Yh=Jf.Message)||void 0===Yh?void 0:Yh.toString()),this.Pf.finish(),this.Pf=null);
we=Jf.ExtraErrorParam?String.format(Jf.Message,Jf.ExtraErrorParam):Jf.Message;Jf=Object.assign(new Cn.a,{title:Jf.Title,message:we,timeoutInSeconds:20});this.FL.wuh(Jf)};if(!t)throw Error.argumentNull("applicationSettings");if(!P)throw Error.argumentNull("actionManager");if(!ia)throw Error.argumentNull("graphTopologyManager");if(!Aa)throw Error.argumentNull("graphActionBlockingManager");if(!Ka)throw Error.argumentNull("pptSelectionManager");if(!pb)throw Error.argumentNull("ribbonChangeManager");if(!Nb)throw Error.argumentNull("transactionFactory");
if(!kc)throw Error.argumentNull("shapeEditor");if(!Rc)throw Error.argumentNull("errorHandler");if(!Yc)throw Error.argumentNull("focusManager");if(!hd)throw Error.argumentNull("sessionInfo");if(!se)throw Error.argumentNull("mediaUploaderFactory");if(!Ae)throw Error.argumentNull("calloutNotificationAdapter");this.Ga=t;this.ia=P;this.ua=ia;this.fc=Aa;this.ob=Ka;this.Hu=pb;this.Jb=Nb;this.Tk=kc;this.Qd=Rc;this.Fa=Yc;this.nt=ia.presentation;this.Ce=hd;this.Fdb=se;this.FL=Ae;Jm.a.GCl=this.Ga.uIh;Jm.a.BDl=
this.Ga.DDl}vb(){this.ia.ra(hb.a.dMb,yg.a.application,this.Bvj.bind(this),4);$c.a("EnableCalloutNotificationsForVideos")&&rm.b(this.Tfa)}De(){}Bvj(t,P,ia){const Aa=this.ua.Ba;if(!Aa||this.fc.$c(Aa))return 16;if(1===ia)return 32;this.Pf=Rh.a.Ik("Video::Insert");try{return O.a.J(509650205,846,50,"InsertLocalVideo: flow initiated"),dk.a.jXe(this.Ga.uIh.toString(),rm.e,()=>rm.d(t,this.tFj.bind(this),"video",this.Ce,Aa),"video",Aa,this.ua.presentation,this.fc,this.Qd,this.Pf,!0,this.Fdb,this.Ga.huc,this.Ga.guc,
this.Ga.fuc),this.Pf&&this.Pf.Va("VideoDialogInitialized","true"),32}catch(Ka){O.a.J(509724677,818,10,"Exception {0} while rendering file selection dialog.",Ka)}rm.a("video")?rm.c(ResourceStrings.l_FileInsertFailedMessageTitle,ResourceStrings.l_FileInsertFailedMessage,null):this.showErrorMessage(446,null);return 8}showErrorMessage(t,P){this.Pf&&(this.Pf.finish(),this.Pf=null);this.Qd.YG(t,ia=>{ia.$B=1;ia.GRa=P;return!1})}tFj(t,P,ia,Aa,Ka,pb,Nb){Aa.PN(ia)&&O.a.J(509724676,822,15,"Video::insertVideoSuccessAfterUpload:Presentation was blocked with loader for {0} milliseconds",
+new Date-+ia.Ria);Aa.ZJ(Nb);ia=Nb.Pt();var kc=this.nt.slideHeight;Aa=this.nt.slideWidth/2-Ad.a.rf(Xb.a.cY/2,0);kc=kc/2-Ad.a.rf(Xb.a.cY/2,1);if(Nb&&Nb.isConnected){var Rc=this.Jb.zd(15,void 0,void 0,()=>{this.Hu.NF=this.dFb;this.ob.selectShape(this.dFb,!0);this.Fa.Ed()});try{Rc.nc(Nb);Rc.jd=t;Ka&&Ka.Va("CreatingVideoShape","true");this.dFb=this.Tk.FQa(!1,Nb.Cb.cid,Nb.Cb.sid,0,10,Aa,kc,Xb.a.cY,Xb.a.h5,ia+1);const Yc=pb.files[0].name;this.dFb.euc=P;this.dFb.duc=Yc;$c.a("SetMediaTypeAsVideoForEmbeddedVideo")&&
this.dFb.setValue(Yb.a.mediaType,2);Nb.UB(this.dFb)}finally{Rc&&Rc.dispose()}Ka&&(Ka.Va("VideoShapeSuccessfullyCreated","true"),Ka.finish(),Ka=null)}}}Object(k.a)(Zk,"InsertVideoActor",null,[227]);class Km{constructor(){this.Lea=this.nh=this.I4=this.K=null;this.qFg=[];this.Wbc=[new Yk];this.LX=[]}get name(){return"PowerPointWebEditor.Chronos2"}$b(t){this.K=t;this.I4=this.K.resolve("PowerPointWebEditor.Core.IBundleMetricRecorder");this.nh=this.I4.VDa(5,this.name);this.Lea=this.K.resolve("PowerPointWebEditor.IDelayLoadedScriptResourceFactory");
for(let Ka=0;Ka<this.Wbc.length;++Ka)Array.add(this.LX,Bc.a(this.Wbc[Ka],5));for(const Ka of this.LX)Ka.$b(t);const P=this.K.resolve("PowerPointWebEditor.IApplicationContext"),ia=v.AFrameworkApplication.fa.ka("InsertOnlinePictureFromHostEmulatedOneDriveHostEnabled"),Aa=Nf.a.Uu(this.K.Ja("Common.IEventEmitter<Common.IGetMoreInfoResult>"));this.K.register(Vg,"PowerPointWebEditor.AppForOfficeManagerFactory").as("PowerPointWebEditor.IAppForOfficeManagerFactory").oa(()=>new Vg(this.K.resolve("Common.IActionManager"),
this.K.resolve("PowerPointWebEditor.IPPTWorkspace"),this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.IPPTApp"),this.K.resolve("PowerPointWebEditor.IDelayLoadedScriptResourceFactory"))).ma();this.K.register(Cj,"PowerPointWebEditor.PPTVersionHistorySelectionHandler").as("Common.IVersionHistorySelectionHandler").ma().oa(()=>new Cj(this.K.resolve("PowerPointWebEditor.IThumbnailViewHelper"),this.K.resolve("Common.Utils.IHighContrastDetector"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),
this.K.resolve("PowerPointWebEditor.IPresentationReader")));this.K.register(wk,"Box4.Media.OneDriveFilePickerHelperV7").as("Box4.Media.IImageFilePickerHelper").ma().oa(()=>new wk(t.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiOpenManagerV72"),new Fc.a(()=>Aa.result),t.resolve("Box4.Media.IInsertMediaCrossDocumentMessengerFactory")));this.K.register(nj,"Box4.Media.InsertOneDriveFileHelper").ma().oa(()=>new nj(v.AFrameworkApplication.Ta));this.K.register(ik,"Box4.Media.InsertMediaHelper").as("Box4.Media.IInsertMediaHelper").ma().oa(()=>
new ik);this.K.register(Hm,"PowerPointWebEditor.InsertOnlineImageHelper").ma().oa(()=>new Hm(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Box4.Media.InsertMediaHelper"),this.K.resolve("PowerPointWebEditor.IApplicationSettings")));this.K.register(mn,"PowerPointWebEditor.ChangeOnlineImageHelper").ma().oa(()=>new mn(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Box4.Media.InsertMediaHelper"),this.K.resolve("PowerPointWebEditor.IApplicationSettings")));this.K.register(zh,
"Box4.Media.InsertMediaFromHostManagerFactory").as("Box4.Media.IInsertMediaFromHostManagerFactory").ma().oa(()=>new zh(new jj(new Fc.a(()=>{if(v.AFrameworkApplication.muh()){var Ka=this.K.resolve("Box4.Media.IInsertMediaFromHostOneDriveHostFrame").o8a;Ka=new Wk(Ka.contentWindow,"*")}else Ka=P.D9i();return Ka}),ia?db.a.pQ(window.document.URL):db.a.pQ(v.AFrameworkApplication.xna),v.AFrameworkApplication.fa.appSettings.ImageFetcherSupportedExtensions)));this.K.register(Oi,"Box4.Media.InsertMediaCrossDocumentMessengerFactory").as("Box4.Media.IInsertMediaCrossDocumentMessengerFactory").ma();
this.K.register(bk,"Box4.Media.InsertMediaFromHostOneDriveHostFrame").as("Box4.Media.IInsertMediaFromHostOneDriveHostFrame").ma().oa(()=>new bk);this.K.register(Td,"PowerPointWebEditor.PptInsertMediaDialogFactory").as("PowerPointWebEditor.IPptInsertMediaDialogFactory").ma();this.K.register(767,"PowerPointWebEditor.IPowerPointDownloadACopyDialogFactory").ma().oa(()=>new bo);this.K.register(nn,"PowerPointWebEditor.StreamVideoPrefetchOrchestrator").ma().oa(()=>new nn(this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),
this.K.resolve("Box4.Graph.IGraphInstance").Ad(8),this.K.resolve("PowerPointWebEditor.ISlideshowFrame"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.resolve("Common.ITaskManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.Video.IStreamPreFetchService")))}init(){let t=this.nh.su("resolvechronos2");const P=this.K.resolve("Common.AFrameworkApplication"),ia=this.K.resolve("PowerPointWebEditor.IApplicationContext"),
Aa=ia.od,Ka=P.rr,pb=this.K.resolve("PowerPointWebEditor.IPowerPointDownloadACopyDialogFactory"),Nb=this.K.resolve("Common.IActionManagerExtended"),kc=this.K.resolve("PowerPointWebEditor.IAppForOfficeManagerFactory");var Rc=this.K.resolve("PowerPointWebEditor.IGraphTransactionHelper");const Yc=this.K.resolve("PowerPointWebEditor.IFocusManager"),hd=Ka.Jd,se=this.K.resolve("Common.Transaction.ITransactionFactory"),Ae=this.K.resolve("PowerPointWebEditor.IShapeEditor"),we=this.K.re("PowerPointWebEditor.IClassFactory"),
Jf=this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),Yh=this.K.resolve("Box4.Graph.IGraphIteratorFactory"),Me=this.K.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),mh=this.K.resolve("PowerPointWebEditor.ShapeEdit.IShapeCountValidator"),af=this.K.resolve("PowerPointWebEditor.IPresentationReader"),sk=Ka.Qgb,Nj=this.K.resolve("PowerPointWebEditor.Storage.ISaveAndCloseHandler"),an=this.K.resolve("PowerPointWebEditor.IGraphHotColdManager"),oo=this.K.resolve("PowerPointWebEditor.ISaveBlockingUI"),
Ho=this.K.resolve("PowerPointWebEditor.IRibbonChangeManager"),Pn=this.K.resolve("PowerPointWebEditor.IShapeReader"),Io=this.K.resolve("PowerPointWebEditor.View.IPPTPageView");this.nh.yu(t);t=this.nh.su("regactorschronos2");Rc=[new yl(Aa,Nb,kc,this.K.Ja("PowerPointWebEditor.IAddinCommandsManager")),new Tm(Aa,Rc,Nb,hd,this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),se,we,kc,this.K.Ja("PowerPointWebEditor.IAppForOfficeManager"),Yh,Me,mh),new L(Aa,Nb,Me,Jf,Yc,this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
se,this.K.resolve("PowerPointWebEditor.IPptInsertMediaDialogFactory"),this.K.resolve("Box4.Media.IInsertMediaFromHostManagerFactory"),this.K.resolve("Box4.Media.IInsertMediaCrossDocumentMessengerFactory"),this.K.resolve("Box4.Media.InsertMediaHelper"),this.K.Ja("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),this.K.resolve("PowerPointWebEditor.InsertOnlineImageHelper"),this.K.resolve("PowerPointWebEditor.ChangeOnlineImageHelper"),af,Ae,Pn,Io,Ho,mh,this.K.resolve("Box4.Media.InsertMediaFromHostOneDriveHostFrame"),
this.K.resolve("Box4.Media.IImageFilePickerHelper"),this.K.resolve("Box4.Media.InsertOneDriveFileHelper"),this.K.resolve("PowerPointWebEditor.IInsertOnlineVideoDialogHelper"),this.K.resolve("PowerPointWebEditor.IInsertImageHelper"),this.K.resolve("PowerPointWebEditor.IJSanityHelper"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),this.K.resolve("Common.IExternalUICommandDefinitionMapping"),this.K.resolve("Common.IAppSettingsManager")),new Jj(Nb,this.K.resolve("PowerPointWebEditor.ISlidePane"),
this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Me,Jf,Ho,this.K.resolve("Common.Transaction.ITransactionFactory"),Ae,this.K.resolve("PowerPointWebEditor.IErrorHandler"),Yc,this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),()=>this.K.resolve("PowerPointWebEditor.IMediaUploader")),new Zk(this.K.resolve("PowerPointWebEditor.IApplicationSettings"),Nb,this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Me,Jf,Ho,this.K.resolve("Common.Transaction.ITransactionFactory"),
Ae,this.K.resolve("PowerPointWebEditor.IErrorHandler"),Yc,this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),()=>this.K.resolve("PowerPointWebEditor.IMediaUploader"),this.K.resolve("PowerPointWebEditor.ICalloutNotificationAdapter"))];for(const Cl of Rc)Cl.vb(),Cl.De();kc.Opf=!0;this.nh.yu(t);v.AFrameworkApplication.fa.jf(()=>{t=this.nh.su("regfullactorschronos2");const Cl=[new kn(Nb,Me,Yc,Jf,this.K.resolve("PowerPointWebEditor.IPPTWorkspace").Cf,Nj,ia.MSa().aSj,an,this.K.resolve("PowerPointWeb.IPrinter"),
this.K.resolve("PowerPointWeb.IConverter"),this.K.resolve("Box4.IAppFrame"),oo,pb,this.K.resolve("PowerPointWebEditor.DownloadACopyAsPdfContext"),P.irmPolicyDescription,this.K.resolve("PowerPointWebEditor.IBusinessBarController"),this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("Common.IAppSettingsManager"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),()=>v.AFrameworkApplication.yR,ia.f6d(),Ck=>v.AFrameworkApplication.Aa.hb.AVe(Ck),
()=>v.AFrameworkApplication.y$b,this.K.resolve("PowerPointWebEditor.IDeferredContentManager"),this.K.resolve("PowerPointWebEditor.ICalloutNotificationAdapter")),new $n(Ka,Aa.yZi,sk.embedPreviewUrl,Nb,af,ia.f6d(),this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"))];for(const Ck of Cl)Ck.vb(),Ck.De();this.nh.yu(t)});O.a.J(512360593,809,50,"Chronos2Package::Init");for(const Cl of this.LX)this.nh.su(Cl.name),Cl.init(),this.nh.yu(Cl.name);
t=this.nh.su("al");this.BCj();this.nh.yu(t);v.AFrameworkApplication.fa.jf(()=>{if(Aa.powerPointIdeasIsEnabled){t=this.nh.su("idea");var Cl=this.gDj();this.fDj(Cl);this.nh.yu(t)}Aa.powerPointSmartLookupIsEnabled&&(t=this.nh.su("smartLookup"),this.VDj(),this.nh.yu(t));v.AFrameworkApplication.K_c()&&(t=this.nh.su("versionhistory"),this.kEj(),this.nh.yu(t));nn.JQj(Aa)&&Ya.a.get_instance().Dk(7,()=>{this.K.resolve("PowerPointWebEditor.StreamVideoPrefetchOrchestrator").start()});const Ck=this.K.resolve("PowerPointWebEditor.IApplicationSettings");
if(Ck&&(Ck.qth||Ck.nth||Ck.rth)){const Vp=!ab.a.Wa(v.AFrameworkApplication.fa.Ha("TenantId"))&&Array.contains(Ck.$ol,v.AFrameworkApplication.fa.Ha("TenantId"));this.K.register(Ml,"PowerPointWebEditor.Text.FontLogger").ma().oa(()=>new Ml(this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.K.resolve("Box4.Graph.IGraphInstance").Ad(8),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.IFontUtilsManager"),this.K.resolve("Common.ITaskManager"),
Ck.Dhk,Ck.Chk,Ck.qth,Ck.nth&&v.AFrameworkApplication.fa.ka("IsO365ConsumerHost"),Ck.rth,Ck.wPi&&Vp));Cl=this.K.resolve("PowerPointWebEditor.Text.FontLogger");this.qFg.push(Cl);Cl.start()}});v.AFrameworkApplication.nsa||(t=this.nh.su("appforoffice"),this.yCj(),this.nh.yu(t));Aa.mwh&&this.K.resolve("PowerPointWebEditor.ISorterViewActorMain").Cme()}dispose(){for(const t of this.LX)t.dispose();for(const t of this.qFg)try{t&&t.dispose()}catch(P){O.a.J(512360592,306,10,"Exception disposing a disposable. {0} {1}",
P.message,P.stack)}}BCj(){O.a.J(512360591,809,50,"Start to download augloop.hermes.js file and its dependency files");try{const t=Mb.a.create("pptedit.augloop",null,()=>d.e(10).then(d.bind(null,1226)));if(this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptAugLoopRuntimeIntegrationEnabled){const P=this.K.resolve("Common.ISharedDependencyLoader"),ia=v.AFrameworkApplication.Pj("augloop-runtime-shim-ie",2);P.pAb(ia).continueWith(()=>{Kc.a.Wx(t)})}else Kc.a.Wx(t)}catch(t){O.a.J(512360590,306,
10,"Failure downloading the augloop js with its depdencies: Message: {0}, Callstack: {1}",t.message,t.stack)}}gDj(){O.a.J(512360588,809,50,"Start to download infrared.hermes.js file");var t=[this.Lea.I0b(v.AFrameworkApplication.Pj("ir-plugin-ski.min.js",5))];t=Mb.a.create("pptedit.infrared",t,()=>d.e(13).then(d.bind(null,1232)));Kc.a.Wx(t);return t}fDj(t){O.a.J(512360587,809,50,"Start to download ideas.hermes.js file");t=this.Lea.XWd(v.AFrameworkApplication.Pj("microsoft.ideas.runtime.js",5),[t],
!1);t=Mb.a.create("pptedit.ideas",[t],()=>d.e(14).then(d.bind(null,1234)));Kc.a.Wx(t)}VDj(){O.a.J(512360586,809,50,"Start to download smartlookup.hermes.js file");const t=Mb.a.create("pptedit.smartlookup",null,()=>d.e(12).then(d.bind(null,1229)));Kc.a.Wx(t)}kEj(){const t=this.Lea.I0b(v.AFrameworkApplication.aga+"pptVersionHistory.js");try{Kc.a.Wx(t)}catch(P){O.a.J(512360585,809,10,"ChronosPackage::InitializeVersionHistory - Failed to download VersionHistory script, Exception: {0}",P.toString())}}yCj(){const t=
this.K.resolve("PowerPointWebEditor.IApplicationSettings");A.a.instance.resolve("PowerPointWebEditor.IAppForOfficeManagerFactory").mae()?Km.vce():t.wg?v.AFrameworkApplication.fa.jf(Km.Kbg):Ya.a.get_instance().Dk(8,()=>{Km.Kbg()})}static main(){v.AFrameworkApplication.Tg&&ve.a.fg?O.a.J(512360584,809,15,"Firefox attempts to load chronos2 package when App is disposing"):e.a.instance.Dc(Bc.a(new Km,5))}static vce(){A.a.instance.resolve("PowerPointWebEditor.IAppForOfficeManagerFactory").Kia();e.a.instance.Dc(new Ng)}static Kbg(){let t=
!1;try{window.self.requestIdleCallback(Km.vce)}catch(P){t=!0}t&&window.setTimeout(Km.vce,0)}}Object(k.a)(Km,"Chronos2Package",null,[2,3]);var kl=d(245),Eh;(function(t){t[t.unsupported=0]="unsupported";t[t.designer=1]="designer";t[t.blank=2]="blank"})(Eh||(Eh={}));Object(k.b)("AgendaSlideThemeType",Eh);var mk=d(112);class eo{constructor(){this.AgendaSlideSid=this.AgendaSlideCid=0;this.CorrelationId=null}}Object(k.a)(eo,"AgendaApplyInfo",null,[]);class fo{constructor(){this.DeckSuggestionId=this.CorrelationId=
this.AgendaSessionId=null;this.FIsBlankOption=!1}}Object(k.a)(fo,"AgendaThemeApplyInfo",null,[]);class Dj{constructor(t,P){this.i1d=!1;this.lKe=[];this.kKf=t;this.YTi=P}}Object(k.a)(Dj,"DeckOptionInformation",null,[]);class Vm{constructor(){this.JVg=this.KVg=0;this.vsg=[]}get qsd(){return this.KVg}set qsd(t){this.KVg=t}get psd(){return this.JVg}set psd(t){this.JVg=t}get s7a(){return this.vsg}set s7a(t){this.vsg=t}D$g(t,P,ia){const Aa=new ha.a;if(t)for(let Ka=0;Ka<ia-1&&Ka<t.length;Ka++)Aa.add(new Dj(t[Ka],
!1));ab.a.Wa(P)||Aa.add(new Dj(P,!0));this.s7a=Aa.toArray()}}Object(k.a)(Vm,"AgendaDeckSessionInformation",null,[]);class Ki{constructor(){this.Tac=this.Uac=this.Opg=0;this.tze=this.O1c=this.txe=this.a8c=null}n4k(t){t&&(this.Opg=t.body.slideIndex)}Q7k(t){t.body&&t.body.outlineRequestContent&&(this.a8c=JSON.stringify(t.body.outlineRequestContent))}j4k(t){t.body&&(this.Tac=t.body.slideCId)}m4k(t){t.body&&(this.Uac=t.body.slideSId)}k4k(t){this.O1c=t.id}bHj(t){return t===this.O1c?(this.O1c=this.a8c=null,
!0):!1}cVj(){return!ab.a.Wa(this.a8c)&&!ab.a.Wa(this.O1c)}G7k(t){t.body&&t.body.outlineRequestContent&&t.body.outlineRequestContent.Slides&&(this.txe=t.body.outlineRequestContent.Slides.length)}l4k(t){this.tze=t.body.score}}Object(k.a)(Ki,"AgendaDetection",null,[]);class ek{constructor(t,P,ia,Aa,Ka,pb,Nb,kc,Rc,Yc,hd){this.Hua=this.ZA=null;this.T1c=0;this.P_=null;this.nEb="";this.V3c=!1;this.dla=0;this.j9=new ha.a;this.jzg=!1;this.vi=t;this.Sb=P;this.ua=ia;this.fc=Aa;this.Ga=Ka;this.Gq=pb;this.Ie=
kc;this.ob=Rc;this.ow=Yc;this.peb=hd;this.ow.$nk(this.Ga)}gCh(){this.orh();this.IAi();this.Tub()?(this.P_=new Vm,this.P_.qsd=this.eL(),this.osl()):1!==this.dla||this.Ga.ANc?2===this.dla&&this.Ga.zNc&&(this.P_=new Vm,this.P_.qsd=this.eL(),this.Vsl()):this.Usl()}IAi(){this.Hua=Ca.a.create().toString();this.ow.EWk(this.Hua);this.ow.wlk()}I0e(t,P){if(this.ZA){if(!this.ZA.Uac||!this.ZA.Tac){var ia=this.Sb.mC(this.ZA.Opg);this.ZA.Uac=ia.Cb.sid;this.ZA.Tac=ia.Cb.cid}ia=this.Sb.mC(0);this.vi.generateAgendaSuggestion(ia.Cb.cid,
ia.Cb.sid,this.Hua,this.ZA.a8c,this.l0i(),t,P)}else P(null)}Usl(){this.I0e(Object(r.a)(this,this.Sqk,"onPODSTriggerAgendaConversionSuccessV1"),Object(r.a)(this,this.t4g,"onPODSTriggerAgendaConversionFailureV1"));this.fc.blockContent(this.ua.presentation,"ApplyAgenda",!0)}Vsl(){for(let t of this.j9)t&&t.tsl();this.I0e(Object(r.a)(this,this.Tqk,"onPODSTriggerAgendaConversionSuccessV2"),Object(r.a)(this,this.Rqk,"onPODSTriggerAgendaConversionFailureV2"))}osl(){this.I0e(Object(r.a)(this,this.Uqk,"onPODSTriggerAgendaConversionSuccessV3"),
Object(r.a)(this,this.u4g,"onPODSTriggerAgendaConversionFailureV3"));this.fc.blockContent(this.ua.presentation,"ApplyAgenda",!0)}vgb(t,P){if(P.property===Yb.a.$Ya&&this.T1c){t=Object(R.a)(388,P.node);if(t.$Ya===ek.QJh)for(let ia of this.j9)ia&&ia.Ulk();else if(t.$Ya===ek.RJh){for(let ia of this.j9)ia&&ia.g1g();this.V3c=!0}this.peb.Cm(Object(r.a)(this,this.vgb,"onPresentationPropertyChange"));this.T1c=0}}l0i(){const t={};this.Ga.zNc&&2===this.dla&&(t.shouldGenerateThemes="true",t.themeCount="3");this.Tub()&&
(t.shouldNotConvertToGVMLBytes="true",t.shouldInsertBlankSlides="true");return mk.c(t)}b0i(t){const P={};P.SlideCount=this.Lj().toString();P.isBlankThemeRequest=(this.P_.s7a[t].YTi&&!this.Tub()).toString();P.isRequestForDeckDesignerForNonBlankSlides=this.Tub();return mk.c(P)}Tub(){return this.Ga.ANc&&(1===this.dla||0===this.dla)}nsl(){this.ob.Qh();const t=this.ua.presentation;if(t){const P=this.Gq.le(15);try{P.nc(t),P.jd=hb.a.uYb,t.Qqb=Object.assign(new eo,{CorrelationId:this.Hua,AgendaSlideSid:this.ZA.Uac,
AgendaSlideCid:this.ZA.Tac})}finally{P&&P.dispose()}this.fc.Zv(t,hb.a.uYb);this.fc.ZJ(t)}else this.$cd()}hCh(t){this.ob.Qh();this.ow.eei(this.d5d(t));const P=this.ua.presentation;if(P){const ia=this.Gq.le(15);try{ia.nc(P),ia.jd=hb.a.uYb,P.$Ya=ek.PJh,this.T1c=this.eL(),this.peb.ik(Object(r.a)(this,this.vgb,"onPresentationPropertyChange")),P.Rqb=Object.assign(new fo,{DeckSuggestionId:this.d5d(t),AgendaSessionId:this.Hua,CorrelationId:Ca.a.create().toString()})}finally{ia&&ia.dispose()}this.fc.Zv(P,
hb.a.uYb);this.fc.ZJ(P)}else this.$cd()}$cd(){for(let t of this.j9)t&&t.Tlk();this.fc.ZJ(this.ua.presentation)}Sqk(){this.nsl();this.V3c=!0;for(let t of this.j9)t&&t.g1g()}Tqk(t){this.P_.psd=this.eL();const P=this.C_f(),ia=new ha.a;if(t.Images)for(const Aa of t.Images)ia.add("data:image/jpg;base64, "+Aa);ia.add(P);ab.a.Wa(t.BlankSuggestionId)&&(t.BlankSuggestionId=Ca.a.create().toString());this.P_.D$g(t.DeckSuggestionId,t.BlankSuggestionId,ek.H4e);for(let Aa of this.j9)Aa&&Aa.Wlk(ia.toArray());this.L0e(0)}Uqk(){this.P_.psd=
this.eL();this.P_.D$g(null,Ca.a.create().toString(),ek.H4e);this.L0e(0)}L0e(t){this.Tub()?this.mCh(t,Object(r.a)(this,this.Wqk,"onPODSTriggerAgendaDeckSuggestionSuccessForNonBlankTheme"),Object(r.a)(this,this.u4g,"onPODSTriggerAgendaConversionFailureV3")):this.mCh(t,Object(r.a)(this,this.Vqk,"onPODSTriggerAgendaDeckSuggestionSuccess"),Object(r.a)(this,this.v4g,"onPODSTriggerAgendaDeckSuggestionFailure"))}mCh(t,P,ia){if(this.P_.psd<this.P_.qsd)this.gCh();else if(this.ow.Ztk(t),this.nEb=this.d5d(t),
this.xUi(this.P_.s7a[t])){var Aa=Ca.a.create().toString();this.vi.generateAgendaDeckSuggestion(this.ZA.Tac,this.ZA.Uac,Aa,this.Hua,this.nEb,this.b0i(t),P,ia);O.a.J(512496859,813,50,"AgendaConverterManager::TriggerDifferentThemeWorkflow - CorrelationID: {0}, RequestDeckSuggestionId: {1}",Aa,this.nEb)}else this.O_g(this.P_.s7a[t].lKe,this.nEb),this.ow.c1g(t,!0)}Vqk(t){if(t.Images&&t.Images.length){var P=new ha.a;for(var ia of t.Images)P.add("data:image/jpg;base64, "+ia);this.O_g(P.toArray(),t.DeckSuggestionId);
if(ia=({themeIndex:t}=this.zZf(t.DeckSuggestionId)).returnValue)ia.lKe=P.toArray(),ia.i1d=!0;this.ow.c1g(t,!1)}else this.v4g(t)}Wqk(t){t.Images&&t.Images.length?this.hCh(0):this.$cd()}O_g(t,P){for(let ia of this.j9)ia&&P===this.nEb&&ia.Plk(t)}v4g(t){try{let P;const ia=({themeIndex:P}=this.zZf(t.DeckSuggestionId)).returnValue;ia&&(ia.i1d=!1,ia.lKe=[]);this.ow.Olk(P);if(this.nEb!==t.DeckSuggestionId)return!0}catch(P){O.a.J(512496858,813,10,"Exception in OnPODSTriggerAgendaDeckSuggestionFailure: "+P.message)}for(let P of this.j9)P&&
P.f1g();return!0}t4g(){this.$cd();return!0}u4g(t){return this.t4g(t)}Rqk(){const t=this.C_f(),P=new ha.a;P.add(t);for(let ia of this.j9)ia&&(ia.Vlk(P.toArray()),ia.f1g());return!0}C_f(){const t=this.Sb.mC(0);return this.Ie.jL(t.Cb).image.src}yta(t,P){try{this.ZA||(this.ZA=new Ki);let ia=!1;P?this.ZA.bHj(t.id)&&(this.Kph(!1,this.dla),ia=!0):(this.ZA.n4k(t),this.ZA.Q7k(t),this.ZA.j4k(t),this.ZA.m4k(t),this.ZA.k4k(t),this.ZA.l4k(t),this.orh(),this.ZA.cVj()&&(this.Kph(!0,this.dla),this.ZA.G7k(t)));if(!(0>=
this.j9.count))for(let Aa of this.j9)try{Aa&&(ia?window.setTimeout(()=>{Aa.N_g()},100):Aa.N_g())}catch(Ka){O.a.J(512496857,813,10,"Exception message: "+Ka.message)}}catch(ia){O.a.J(512496856,813,10,"Exception message: "+ia.message)}}wOk(t){t&&this.j9.add(t)}jwl(t){this.j9.remove(t)}Kph(t,P){this.jzg=this.Ga.ANc?t:t&&0!==P}N0f(){return this.jzg&&!this.V3c}jHe(t){this.V3c=!t}Lj(){return this.ua.presentation.XKa+this.ZA.txe}orh(){this.dla=this.Xkj();this.ow.PWk(Eh[this.dla]);this.yWk()}yWk(){this.Tub()?
this.ow.YPe("V3"):1!==this.dla||this.Ga.ANc?2===this.dla&&this.Ga.zNc&&this.ow.YPe("V2"):this.ow.YPe("V1")}Xkj(){try{const t=this.Sb.xI();if(t&&0<t.length)for(const P of t)if(P){const ia=P.ThemeFamilyId;if(this.Ga.zNc&&ia.toLowerCase()===ek.bKh.toLowerCase())return 2;if(0<=Array.indexOf(this.Ga.Sbi,ia))return 1}return 0}catch(t){return O.a.J(512496855,813,10,"AgendaConverterManager::IsThemeSupportedForAgendaV1: Exception message: "+t.message),0}}d5d(t){return this.P_.s7a[t].kKf}zZf(t){let P;P=0;for(const ia of this.P_.s7a){if(ia.kKf===
t)return{returnValue:ia,themeIndex:P};P++}O.a.J(512496854,813,10,"AgendaConverterManager::GetDeckOptionInfoWithDeckSuggestionID: cannot find DeckOptionInfo with deckSuggestionId "+t);return{returnValue:null,themeIndex:P}}xUi(t){return t?!t.i1d:(O.a.J(512496853,813,10,"AgendaConverterManager::FShouldQueryFreshPreview: DeckOptionInfo is null "),!1)}dispose(){this.peb.Cm(Object(r.a)(this,this.vgb,"onPresentationPropertyChange"));this.T1c=0}eL(){return(new Date).getTime()}}ek.H4e=4;ek.bKh="62F939B6-93AF-4DB8-9C6B-D6C7DFDC589F";
ek.RJh=1;ek.QJh=2;ek.PJh=0;Object(k.a)(ek,"AgendaConverterManager",null,[106]);class Dn{constructor(t,P,ia){this.ow=t;this.Lc=P;this.bO=ia;this.Pu()}Pu(){this.Lc.SFc(Object(r.a)(this,this.sna,"onUndoRedo"))}dispose(){this.Lc.mkd(Object(r.a)(this,this.sna,"onUndoRedo"))}N6b(t,P){t===hb.a.uYb&&(this.ow.jHe(P),this.bO.jHe(P))}sna(t,P){this.N6b(P.$1e,P.$ab)}}Object(k.a)(Dn,"AgendaConverterUndoRedoController",null,[769]);var wg=d(76);class Vl{constructor(){this.isEntryState=!1;this.pptAppFrameDomElement=
null;this.maxTryAgainCount=0}}Object(k.a)(Vl,"IAgendaSettings",null,[]);class lh{constructor(t,P,ia,Aa,Ka){this.Azf="HighConfidenceAgendaDetected";this.Yy=null;this.va=new wg.a;this.N1c=null;this.zad=0;this.la=ia;this.kt=P;this.Fa=Ka;this.Yy||(P=new Vl,P.isEntryState=!0,P.pptAppFrameDomElement=this.kt.AF(),P.maxTryAgainCount=this.la.Ltf,this.Yy=agendaConverter.AgendaConverterFactory.CREATE_AGENDA_CONVERTER_ACTOR(P));this.oml();this.bO=t;this.la&&this.la.yNc&&this.bO.wOk(this);this.ow=Aa;this.Dbb=
!1}N_g(){this.bO&&(this.bO.N0f()?(this.ow.xWk(this.bO.ZA.tze),this.uuh(this.N1c),1===this.bO.ZA.tze&&this.va.raiseEvent(this.Azf,null)):this.Wae())}tsl(){this.Yy&&(this.ow.Qlk(),this.Yy.showAgendaToPptDialog(this.bO.Lj()),this.Fa.iWc(fd.a.Ktf,fd.a.nj,document.getElementById("AgendaToPptDialogHostElement")),this.Fa.Bj(fd.a.Ktf,!0),this.Dbb=!0)}g1g(){this.Wae();this.ow.Slk();window.setTimeout(()=>{this.Bsl()},8E3)}Wlk(t){this.Dvh(t);this.ow.d1g(!0)}Vlk(t){this.Dvh(t);this.ow.d1g(!1)}Plk(t){this.Rgl(t)}Tlk(){this.zad>=
this.la.Ltf?this.Yy.showAgendaToPptDismissCard():(this.zad+=1,this.Yy.showAgendaToPptFailureCard());this.ow.b4g()}f1g(){this.Yy&&this.Dbb&&this.Yy.showSlidePreviewError()}Ulk(){this.Yy.showMergeSlidesError();this.ow.b4g()}uuh(t){this.la.yNc&&(this.VSe(t),this.Yy&&this.N1c&&this.bO&&this.bO.N0f()&&(this.Yy.showAgendaCard(this.N1c,this.bO.ZA.txe),this.ow.Nlk()))}Wae(){O.a.J(538469316,829,100,"AgendaConverterView::HideAgendaEntryCard");this.Yy&&!this.Dbb&&(this.Yy.hideAgendaCard(),this.VSe(null))}Dvh(t){this.Yy&&
this.Dbb&&this.Yy.populateThemesInAgendaDialog(t)}Rgl(t){this.Yy&&this.Dbb&&this.Yy.populatePreviewSlidesInAgendaDialog(t)}VSe(t){this.N1c=t}Bsl(){if(this.la.KBk)try{const t=A.a.instance.Ja("Common.ISystemInitiatedFeedback");t&&(O.a.J(562422277,813,50,"AgendaConverterView::TriggerFpsForAgendaToPpt Floodgate survey for agenda to presentation triggered"),t.execute(P=>{P.logActivity("AgendaToPresentationActivity","PowerPointAgendaToPptSurveyEnabled")}))}catch(t){O.a.J(562422278,813,10,"Exception thrown while triggering floodgate survey. Exception: {0}",
t)}}oml(){this.Yy.on(lh.SJh,()=>{this.Nbi()});this.Yy.on(lh.VJh,()=>{this.Qbi()});this.Yy.on(lh.TJh,()=>{this.Obi()});this.Yy.on(lh.UJh,()=>{this.Pbi()});this.Yy.on(lh.ZJh,t=>{this.Mbi(t)});this.Yy.on(lh.WJh,t=>{this.Jtf(t,!1)});this.Yy.on(lh.XJh,()=>{this.Rbi()});this.Yy.on(lh.YJh,t=>{this.Jtf(t,!0)})}Nbi(){this.Bxh()}Qbi(){this.ow.auk();this.Bxh()}Obi(){this.Itf();this.ow.L1g()}Pbi(){this.Itf();this.ow.Vnk()}Itf(){this.cleanup();this.bO.jwl(this)}Bxh(){this.bO.gCh()}Mbi(t){this.bO.L0e(t)}Jtf(t,
P){this.ow.Rlk(t,P);this.Dbb=!1;this.Yy.hideAgendaToPptDialog();this.bO.hCh(t)}Rbi(){this.Dbb=!1;this.Yy.hideAgendaToPptDialog();this.ow.L1g()}cleanup(){this.VSe(null);this.zad=0;this.Yy.cleanup()}q9h(t){this.va.addHandler(this.Azf,t)}}lh.SJh="AgendaCardAddSlides";lh.VJh="AgendaCardTryAgain";lh.TJh="AgendaCardCancel";lh.UJh="AgendaCardDismiss";lh.ZJh="AgendaToPptDialogThemeSuggestionSelected";lh.WJh="AgendaToPptDialogApply";lh.XJh="AgendaToPptDialogCancel";lh.YJh="AgendaToPptDialogMergeTryAgain";
Object(k.a)(lh,"AgendaConverterView",null,[770,788]);var sm=d(672);class vo{constructor(){this.Afc={}}dqd(t){this.Afc[t]=new sm.a(t,!0)}BMb(t){if(t in this.Afc){var P=this.Afc[t];P.stop();P=P.gNc;delete this.Afc[t];return P}return-1}AHe(t){return t in this.Afc}}Object(k.a)(vo,"AgendaPerfLogger",null,[]);class yk{constructor(){this.FYc=this.Zdg=this.aeg=this.$dg=!1}i2j(){this.FYc&&!this.$dg&&(this.$dg=!0,jb.b(yk.dli))}K2j(){this.FYc&&!this.aeg&&(this.aeg=!0,jb.b(yk.eli))}h1j(){this.FYc&&!this.Zdg&&
(this.Zdg=!0,jb.b(yk.cli))}static i0j(t){t&&t.tT&&jb.b(yk.bli)}}yk.dli="WAC_Exp_AgendaToPPTHighConfidenceSeen";yk.eli="WAC_Exp_AgendaToPPTHighConfidenceTried";yk.cli="WAC_Exp_AgendaToPPTHighConfidenceKept";yk.bli="WAC_Exp_AgendaToPPTIsCreateNew";Object(k.a)(yk,"ExperimentationMetrics",null,[]);class pn{constructor(){this.pqe=this.Ope=this.Vne=this.Hua=null;this.Bre=!1;this.Sug=this.Npg=this.yUg=this.Ga=null;this.IAe="";this.Ere=!1;this.Tne=""}reset(){this.yUg={};this.Npg=new vo;this.Sug=new yk;this.IAe=
"";this.Ere=!1;this.Tne="";this.pqe=this.Ope=this.Vne=this.Hua=null;this.Bre=!1}get telemetryData(){return this.yUg}get pOc(){return this.Sug}get D7(){return this.Npg}get od(){return this.Ga}set od(t){this.Ga=t}get lrd(){return this.IAe}set lrd(t){this.IAe=t}get KRa(){return this.Ere}set KRa(t){this.Ere=t}get QP(){return this.Tne}set QP(t){this.Tne=t}get bW(){return this.Hua}set bW(t){this.Hua=t}get HG(){return this.Vne}set HG(t){this.Vne=t}get MS(){return this.Ope}set MS(t){this.Ope=t}get documentOpenType(){return this.pqe}set documentOpenType(t){this.pqe=
t}get u8b(){return this.Bre}set u8b(t){this.Bre=t}}Object(k.a)(pn,"AgendaMetricsState",null,[]);var $k=d(764);class kj{constructor(t,P){if(!t)throw Error.argumentNull("AgendaThemetype is null");if(!P)throw Error.argumentNull("AgendaToPptFlowVersion is null");this.bva=new $k.a;this.bva.gia(Object.assign(new H.a,{name:"AgendaThemeType",string:t}));this.bva.gia(Object.assign(new H.a,{name:"AgendaFlowVersion",string:P}))}M5(t){ab.a.Wa(t)||this.bva.gia(Object.assign(new H.a,{name:"AgendaSessionId",string:t}));
return this}$md(t){this.bva.gia(Object.assign(new H.a,{name:"AgendaThemeIndexSelected",int64:t}));return this}bjb(t){ab.a.Wa(t)||this.bva.gia(Object.assign(new H.a,{name:"AgendaCardState",string:t}));return this}uKa(t){ab.a.Wa(t)||this.bva.gia(Object.assign(new H.a,{name:"AgendaDialogState",string:t}));return this}D_a(t){ab.a.Wa(t)||this.bva.gia(Object.assign(new H.a,{name:"AgendaButtonClickedType",string:t}));return this}Vnd(t){ab.a.Wa(t)||this.bva.gia(Object.assign(new H.a,{name:"AgendaSeenTriedKept",
string:t}));return this}j1(t){ab.a.Wa(t)||this.bva.gia(Object.assign(new H.a,{name:"DocumentOpenType",string:t}));return this}build(){return this.bva.dataFields}}Object(k.a)(kj,"AgendaToPptActivityDataPointBuilder",null,[]);class Ej{constructor(){this.Vc=null;this.HXa=new sm.a("AgendaToPpt",!1);this.WUe()}WUe(){this.Vc=new pn;this.Vc.reset();this.Vc.telemetryData.Flights="";v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.AugloopAgendaTASClassifierModelIsEnabled",
!1)&&(this.Vc.telemetryData.Flights+="AugloopAgendaTASClassifierModelIsEnabled;");this.Vc.telemetryData.InitialUserThemeType=this.Vc.QP}$nk(t){t&&(this.Vc.od=t,this.Vc.documentOpenType=Ej.i7i(t),yk.i0j(this.Vc.od),this.Vc.telemetryData.IsDocumentOpenTypeCreateNew=this.Vc.od.tT.toString())}e1g(t,P){if(this.Vc.D7.AHe("AgendaToPptDialogThemeApply")&&"V2"===this.Vc.HG){var ia=this.Vc.D7.BMb("AgendaToPptDialogThemeApply");this.Vc.telemetryData.TotalTimeTakenToMerge=ia.toString();jb.a(Ej.kW,t,ia,P)}else this.Vc.D7.AHe("OnAddSlidesClicked")?
(ia=this.Vc.D7.BMb("OnAddSlidesClicked"),this.Vc.telemetryData.TotalTimeTakenToMerge=ia.toString(),jb.a(Ej.kW,t,ia,P)):this.Vc.D7.AHe("OnTryAgainClicked")&&(ia=this.Vc.D7.BMb("OnTryAgainClicked"),this.Vc.telemetryData.TotalTimeTakenToMerge=ia.toString(),jb.a(Ej.kW,t,ia,P));this.Vc.u8b=!1}Nlk(){this.Vc.u8b=!1;if(!("Seen"in this.Vc.telemetryData)){this.LM("OnAgendaCardShown");this.HXa.start();this.Vc.telemetryData.Seen="true";O.a.J(576746627,813,50,"AgendaCard shown");const t=(new kj(this.Vc.QP,this.Vc.HG)).bjb("AgendaCardShown").Vnd("Seen").j1(this.Vc.documentOpenType).build();
jb.a(Ej.kW,!0,0,t);this.Vc.pOc.i2j()}}wlk(){this.Vc.u8b?this.M2j():this.y_j()}y_j(){this.LM("OnAddSlidesClicked");this.HXa.stop();this.Vc.telemetryData.Tried="true";this.Vc.D7.dqd("OnAddSlidesClicked");O.a.J(576746628,813,50,"AgendaCard tried in MS:{0}",this.HXa.gNc);const t=(new kj(this.Vc.QP,this.Vc.HG)).M5(this.Vc.bW).bjb("AgendaCardShown").D_a("AddSlides").Vnd("Tried").j1(this.Vc.documentOpenType).build();jb.a(Ej.kW,!0,this.HXa.gNc,t);this.Vc.pOc.K2j()}Slk(){this.LM("OnAgendaToPPTApply");this.Vc.KRa=
!0;this.Vc.telemetryData.Kept="true";this.Vc.telemetryData.Event="AgendaCompleted";const t=(new kj(this.Vc.QP,this.Vc.HG)).M5(this.Vc.bW).bjb("AgendaCompleted").j1(this.Vc.documentOpenType).build();this.e1g(!0,t);O.a.J(572842050,813,50,"AgendaToPPT Completed successfully")}auk(){this.Vc.u8b=!0;this.LM("OnTryAgainClicked");this.Vc.telemetryData.Tried="true";this.Vc.telemetryData.Event="AgendaTryAgain";this.Vc.D7.dqd("OnTryAgainClicked");O.a.J(556561858,813,50,"AgendaCard retry attempt")}M2j(){const t=
(new kj(this.Vc.QP,this.Vc.HG)).M5(this.Vc.bW).bjb("AgendaMergeError").D_a("TryAgain").Vnd("Tried").j1(this.Vc.documentOpenType).build();jb.a(Ej.kW,!0,0,t)}Qlk(){this.LM("OnAgendaDialogShown");this.Vc.MS="Loading";O.a.J(556602440,813,50,"AgendaDialog shown");const t=(new kj(this.Vc.QP,this.Vc.HG)).M5(this.Vc.bW).uKa(this.Vc.MS).j1(this.Vc.documentOpenType).build();jb.a(Ej.kW,!0,0,t)}d1g(t){this.LM("OnAgendaThemePaneLoadedSuccess");this.Vc.MS=t?"ThemeSuggestions":"ThemeSuggestionsFailure";t=this.Vc.D7.BMb("OnAddSlidesClicked");
this.Vc.telemetryData.ThemePaneLoadingTime=t.toString();const P=(new kj(this.Vc.QP,this.Vc.HG)).M5(this.Vc.bW).uKa(this.Vc.MS).j1(this.Vc.documentOpenType).build();jb.a(Ej.kW,!0,t,P)}eei(t){this.LM("ThemeDeckSuggestionId");this.Vc.telemetryData.SelectedDeckSuggestionId=t}Ztk(t){"V2"===this.Vc.HG&&(this.LM("OnTriggerDifferentThemeWorkflow"),this.Vc.MS="ThemeSuggestions",this.Vc.D7.dqd("TriggerDeckLevelDesigner_"+t),t=(new kj(this.Vc.QP,this.Vc.HG)).M5(this.Vc.bW).uKa(this.Vc.MS).$md(t).D_a("ThemeSelected").j1(this.Vc.documentOpenType).build(),
jb.a(Ej.kW,!0,0,t))}c1g(t,P){this.LM("OnAgendaDeckPreviewLoaded");this.Vc.MS=P?"AgendaDeckPreviewLoadedFromCache":"AgendaDeckPreviewLoaded";P=this.Vc.D7.BMb("TriggerDeckLevelDesigner_"+t);this.Vc.telemetryData["DeckPreviewLoadTime_"+t]=P.toString();t=(new kj(this.Vc.QP,this.Vc.HG)).M5(this.Vc.bW).uKa(this.Vc.MS).$md(t).j1(this.Vc.documentOpenType).build();jb.a(Ej.kW,!0,P,t)}Olk(t){const P=this.Vc.D7.BMb("TriggerDeckLevelDesigner_"+t);this.LM("OnAgendaDeckPreviewError");this.Vc.MS="AgendaDeckPreviewError";
let ia="";"DeckPreviewFailure"in this.Vc.telemetryData&&(ia=this.Vc.telemetryData.DeckPreviewFailure.toString());this.Vc.telemetryData.DeckPreviewFailure=ia+t.toString()+";";t=(new kj(this.Vc.QP,this.Vc.HG)).M5(this.Vc.bW).uKa(this.Vc.MS).$md(t).j1(this.Vc.documentOpenType).build();jb.a(Ej.kW,!1,P,t)}Rlk(t,P){this.LM("OnAgendaDialogThemeApply");this.Vc.MS=P?"AgendaDeckMergeError":this.Vc.MS;this.Vc.D7.dqd("AgendaToPptDialogThemeApply");t=(new kj(this.Vc.QP,this.Vc.HG)).M5(this.Vc.bW).$md(t).uKa(this.Vc.MS).D_a(P?
"TryAgain":"Apply").j1(this.Vc.documentOpenType).build();jb.a(Ej.kW,!0,0,t)}L1g(){this.LM("OnCancelClicked");this.Vc.KRa=!0;this.Vc.telemetryData.Kept="false";this.Vc.telemetryData.Event="AgendaCancelled";O.a.J(572842051,813,50,"AgendaToPPT clicked Cancel button");const t=(new kj(this.Vc.QP,this.Vc.HG)).M5(this.Vc.bW).D_a("Cancel").j1(this.Vc.documentOpenType);"V2"===this.Vc.HG?t.uKa(this.Vc.MS):t.bjb("AgendaMergeError");jb.a(Ej.kW,!0,0,t.build())}Vnk(){this.LM("OnDismissClicked");this.Vc.KRa=!0;
this.Vc.telemetryData.Kept="false";this.Vc.telemetryData.Event="AgendaDismissed";O.a.J(556607430,813,50,"AgendaToPPT clicked Dismiss button");const t=(new kj(this.Vc.QP,this.Vc.HG)).M5(this.Vc.bW).D_a("Dismiss").j1(this.Vc.documentOpenType);"V2"===this.Vc.HG?t.uKa(this.Vc.MS):t.bjb("AgendaMergeError");jb.a(Ej.kW,!0,0,t.build())}b4g(){this.LM("OnMergingErrorInAgenda");this.Vc.KRa=!0;this.Vc.telemetryData.Kept="false";this.Vc.telemetryData.Event="AgendaError";const t=(new kj(this.Vc.QP,this.Vc.HG)).M5(this.Vc.bW).j1(this.Vc.documentOpenType);
"V2"===this.Vc.HG?(this.Vc.MS="AgendaMergeError",t.uKa("AgendaMergeError")):t.bjb("AgendaMergeError");this.e1g(!1,t.build())}jHe(t){let P=!1;this.LM("OnUndoRedoClicked");let ia=(new kj(this.Vc.QP,this.Vc.HG)).M5(this.Vc.bW).j1(this.Vc.documentOpenType);if("Kept"in this.Vc.telemetryData){this.Vc.telemetryData.Kept=(!t).toString();const Aa=t?"UndoClicked":"RedoClicked";this.Vc.telemetryData.Event=Aa;ia=ia.D_a(Aa)}else P=!0,ia.D_a("UndoRedoPostAgendaKept");jb.a(Ej.kW,!0,0,ia.build());O.a.J(576746629,
813,50,"AgendaToPPT did UndoRedo: {0} and IsError:{1}",(!t).toString(),P.toString())}EWk(t){this.LM("ReportCorrelationID");this.Vc.telemetryData.CorrelationId=t;this.Vc.bW=t}PWk(t){this.LM("ReportInitialUserThemeType");this.Vc.telemetryData.InitialUserThemeType=t;this.Vc.QP=t}YPe(t){this.LM("ReportAgendaToPptFlowVersion");this.Vc.telemetryData.AgendaToPptFlowVersion=t;this.Vc.HG=t}xWk(t){this.LM("ReportAgendaScore");this.Vc.telemetryData.AgendaScore=t.toString();1===t&&this.NWk()}NWk(){this.LM("ReportHighConfidenceAgendaDetected");
this.Vc.telemetryData.HighConfidenceAgendaDetected="true";this.Vc.pOc.FYc=!0}dispose(){O.a.J(576746630,813,50,"AgendaToPPTMetrics: {0}",mk.c(this.Vc.telemetryData))}WWk(){if(!this.Vc.telemetryData||!hg.a.count(this.Vc.telemetryData))return"";const t=mk.c(this.Vc.telemetryData);if(this.Vc.lrd===t)return"";this.Vc.lrd=t;if("Kept"in this.Vc.telemetryData){const P=(new kj(this.Vc.QP,this.Vc.HG)).M5(this.Vc.bW).Vnd("Kept").j1(this.Vc.documentOpenType).build(),ia=Boolean.parse(this.Vc.telemetryData.Kept.toString());
jb.a(Ej.kW,ia,0,P);ia&&this.Vc.pOc.h1j()}this.Vc.KRa&&(this.WUe(),this.Vc.KRa=!1);O.a.J(572663111,813,50,"AgendaToPPTMetrics: {0}; isFinalTelemetryData: {1}",this.Vc.lrd,this.Vc.KRa.toString());return t}LM(t){this.Vc.telemetryData||(O.a.J(574665996,813,15,"AgendaMetrics::ValidateTelemetryData null  for method :{0}",t),this.WUe())}static i7i(t){return t.tT?"NewDocument":t.VUa?"ViewOnlyDocument":"EditDocument"}}Ej.kW="AgendaToPptEvents";Object(k.a)(Ej,"AgendaMetrics",null,[768]);class nk{constructor(){this.Ga=
this.K=null;this.gQg=!0;this.Mpg="AugLoop_AgendaDetection_AgendaDetectionAnnotation";this.bO=null}get name(){return"PowerPointWebEditor.AgendaConverter"}$b(t){this.K=t;this.K.register(768,"PowerPointWebEditor.IAgendaMetrics").ma().oa(()=>new Ej);this.K.register(ek,"PowerPointWebEditor.AgendaConverter.AgendaConverterManager").ma().oa(()=>new ek(this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
this.K.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.Graph.IPptGraphTransactionFactory"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.IAgendaMetrics"),this.K.resolve("Box4.Graph.IGraphInstance").Ad(7)));this.K.register(769,
"PowerPointWebEditor.IAgendaConverterUndoRedoController").ma().oa(()=>new Dn(this.K.resolve("PowerPointWebEditor.IAgendaMetrics"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),this.K.resolve("PowerPointWebEditor.AgendaConverter.AgendaConverterManager")));this.K.resolve("PowerPointWebEditor.IAgendaConverterUndoRedoController");const P=kl.a(this.K);$c.a("AgendaToPPT.DisableLocalizedStrings")?P("agendaConverter").then(()=>{this.K.register(770,"PowerPointWebEditor.AgendaConverter.IAgendaConverterView").ma().oa(()=>
new lh(this.K.resolve("PowerPointWebEditor.AgendaConverter.AgendaConverterManager"),this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.IAgendaMetrics"),this.K.resolve("PowerPointWebEditor.IFocusManager")));this.K.resolve("PowerPointWebEditor.AgendaConverter.IAgendaConverterView")}).catch(()=>{}):P("powerpoint-agenda-to-ppt-strings").then(()=>{P("agendaConverter").then(()=>{this.K.register(770,"PowerPointWebEditor.AgendaConverter.IAgendaConverterView").ma().oa(()=>
new lh(this.K.resolve("PowerPointWebEditor.AgendaConverter.AgendaConverterManager"),this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.IAgendaMetrics"),this.K.resolve("PowerPointWebEditor.IFocusManager")));this.K.resolve("PowerPointWebEditor.AgendaConverter.IAgendaConverterView")}).catch(()=>{})}).catch(()=>{})}init(){this.K.resolve("Common.IAppSettingsManager").jf(Object(r.a)(this,this.vOk,"registerAgendaDetectionEventHandler"))}dispose(){}vOk(){this.Ga=
this.K.resolve("PowerPointWebEditor.IApplicationSettings");this.bO=this.K.resolve("PowerPointWebEditor.AgendaConverter.AgendaConverterManager");const t=this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame");this.Ga.nPi&&this.gQg&&2===t.mode&&(this.K.Ja("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager").execute(P=>{P.x5a(this.Mpg);P.Ufh(this.Mpg,Object(r.a)(this.bO,this.bO.yta,"handleAnnotationEvent"))}),this.gQg=!1)}static main(){e.a.instance.Dc(new nk)}}Object(k.a)(nk,"AgendaConverterPackage",
null,[2,3]);var pj=d(676);class ke{constructor(t,P,ia,Aa,Ka,pb,Nb,kc,Rc,Yc,hd){this.Oac=0;this.ia=t;this.Qb=P;this.la=ia;this.Fa=Aa;this.je=Ka;this.pa=pb;this.Lm=Nb;this.rE=kc;this.Iu=Rc;this.Mo=Yc;this.twa=hd}vb(){this.y3h();this.la.dEk&&this.pSf()&&this.twa.continueWith(()=>{this.twa.result.logActivity("HasPresentInTeamsSeen","PresentToTeamsTeachingUIEnabled")})}y3h(){this.ia.ra(hb.a.phb,lb.a.application,Object(r.a)(this,this.phb,"presentToTeams"),4);this.ia.ra(hb.a.jKe,lb.a.application,Object(r.a)(this,
this.phb,"presentToTeams"),4);this.ia.ra(hb.a.iKe,lb.a.application,Object(r.a)(this,this.phb,"presentToTeams"),4)}Imh(){this.Iu.hide();this.r2d()}r2d(){let t;Rh.a.usd();t=this.pvk();this.showDialog();return t}pvk(){this.Mo.L9b=!0;const t=Ca.a.create().toString(),P=this.je.documentUrl;try{const Aa={};Aa.pptSharingUrl=pj.b(P);const Ka=encodeURIComponent(fe.c(Aa));let pb=String.format("msteams:/l/present?ver={0}&deeplinkId={1}&pptContext={2}","1",t,Ka);if(!ab.a.Wa(null)){const Nb=db.a.UD(null);pb=pb+
"&fqdn="+Nb;const kc=encodeURIComponent(fe.c({joinUrl:null}));pb=pb+"&meetingContext="+kc}var ia=pb;n.ULS.sendTraceTag(556541766,838,50,"actionId: {0}, deepLinkId: {1}",this.Oac,t);window.open(ia,"_top")}catch(Aa){return n.ULS.sendTraceTag(523084876,838,15,"PresentToTeamsActor: failed with error: {0}",Aa),!1}return!0}showDialog(){const t=new ua.StandardDialog;t.xd=4;t.Xe(1,ResourceStrings.l_PresentToTeamsResumeInPowerPoint);t.Xe(2,ResourceStrings.l_PresentToTeamsTryAgainInTeams);t.Bx(ResourceStrings.l_PresentingFileInTeamsTitle,
ResourceStrings.l_PresentingFileInTeamsMessage,0,Object(r.a)(this,this.Vlc,"protocolLaunchingDialogResultHandler"))}Vlc(t){1===t||0===t?(n.ULS.sendTraceTag(523084877,838,50,"PresentToTeamsActor - restarting PPT session"),this.c_a()):2===t&&(n.ULS.sendTraceTag(523084878,838,50,"PresentToTeamsActor - retry present to teams"),this.ia.processAction(hb.a.iKe,2))}c_a(){this.ia.La(hb.a.refresh,2,{refreshtrigger:"PresentToTeamsActor::RestartApplication"})}pSf(){return!!this.je.documentUrl}phb(t,P,ia){if(!this.pSf())return n.ULS.sendTraceTag(523084879,
838,10,"PresentToTeamsActor: Document not supported"),8;if(1===ia)return 32;this.Oac=t;if(this.Lm.isPaused)return this.Fa.Ed(),this.r2d()?32:8;this.pa.Qh();this.Fa.Ed();if(t===hb.a.iKe||1===this.Qb.mode)return this.r2d()?32:8;this.rE.j3(!0,!0,()=>{this.Imh()},()=>{n.ULS.sendTraceTag(523084880,838,15,"PresentToTeamsActor: ForceSave failed");this.Imh();return!0});this.Iu.show(!1,this.Oac);return 32}N$(){}M$(){}}Object(k.a)(ke,"PresentToTeamsActor",null,[141]);class yi{constructor(){this.K=null}get name(){return"PowerPointWebEditor.PresentToTeams"}$b(t){this.K=
t}init(){v.AFrameworkApplication.fa.jf(()=>{(new ke(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Box4.IAppFrame"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("PowerPoint.IPathManager"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("Box4.IReplicationScheduler"),this.K.resolve("PowerPointWebEditor.Storage.ISaveAndCloseHandler"),this.K.resolve("PowerPointWebEditor.ISaveBlockingUI"),
this.K.resolve("PowerPointWebEditor.IApplicationContext"),Nf.a.Uu(A.a.instance.Ja("Common.ISystemInitiatedFeedback")))).vb()})}dispose(){}static main(){e.a.instance.Dc(new yi)}}Object(k.a)(yi,"PPTWebEditorPresentToTeamsPackage",null,[2,3]);var ad=d(727),Lh=d(22);class kg{constructor(){this.ActiveSlideSid=this.ActiveSlideCid=0;this.CorrelationId=null;this.SuggestionSid=this.SuggestionCid=0}}Object(k.a)(kg,"DesignerSuggestionApplyInfo",null,[]);var ok=d(333),Fn=d(521),Nl=d(109);class Gn{constructor(){this.KGc=
null}}Object(k.a)(Gn,"IdeasSlideSuggestionWrapper",null,[]);var bi=d(100);class zk{constructor(){this.trigger=null;this.cid=this.sid=0;this.AQ=null;this.timestamp=new Date;this.correlationId=Ca.a.create().toString()}}Object(k.a)(zk,"DesignerRequestData",null,[]);var aj=d(197);class xo{}Object(k.a)(xo,"SlideSuggestionData",null,[]);class Dd{}Dd.Hhk="mivTitle";Dd.Ghk="mivSubtitle";Dd.Ubd="mivContainer";Dd.Fhk="mivButtonsContainer";Dd.PYg="mivButton";Dd.Ehk="mivButtonImage";Dd.sFb="mivOverlayContainer";
Dd.DCe="mivIcon";Dd.tFb="mivTerm";Dd.RYg="mivFrame";Dd.Ihk="mivView";Dd.SYg="mivIdx";Dd.FCe="mivKeepFocusStart";Dd.ECe="mivKeepFocusEnd";Dd.KOf="Editor";Dd.x_d="EditorContainer";Dd.YOi="EditorTitle";Dd.UOi="EditorSubtitleContainer";Dd.MOf="EditorSubtitle";Dd.IOi="EditorBucketContainer";Dd.O7a="EditorPrev";Dd.p2b="EditorPrevDisabled";Dd.tub="EditorPrevEnabled";Dd.w_d="EditorBucketCurrent";Dd.JOi="EditorBucketTotalCount";Dd.BOf="EditorBucketTotal";Dd.qub="EditorNext";Dd.rub="EditorNextEnabled";Dd.o2b=
"EditorNextDisabled";Dd.LOi="EditorDescription";Dd.OOi="EditorIgnoreContainer";Dd.n2b="EditorIgnore";Dd.SOi="EditorSeeMoreContainer";Dd.r2b="EditorSeeMoreLabel";Dd.COf="EditorCardContent";Dd.POf="EditorSuggestionsContainer";Dd.nRa="EditorSuggestionContainer";Dd.oNc="EditorSuggestionArrow";Dd.VOi="EditorSuggestionCheck";Dd.OOf="EditorSuggestionText";Dd.NOf="EditorSuggestionInstances";Dd.POi="EditorNoMoreContainer";Dd.WOi="EditorSvgCheck";Dd.ZOi="EditorWhiteCheck";Dd.NOi="EditorGreenFill";Dd.MOi="EditorGreenBorder";
Dd.QOi="EditorNoMoreLabel";Object(k.a)(Dd,"IdeasCss",null,[]);class ch{}ch.G7b="IdeasPane";ch.mRa="editorSuggestionIdx";ch.QK="ClosePane";ch.izj="IdeasPaneOpen";ch.Vhc=6;ch.dgk=3;ch.wKf="Architecture Backgrounds Cities Nature People Technology".split(" ");Object(k.a)(ch,"IdeasPaneConstants",null,[]);var Le=d(375),km=d(167);class ze{constructor(t,P,ia,Aa,Ka,pb,Nb){this.odc=null;this.ua=t;this.qc=P;this.la=ia;this.Rb=Aa;this.s9c=(t=this.la.useWideSuggestionThumbs)?"DesignerSuggestionResultWide":"DesignerSuggestionResult";
this.t9c=t?"DesignerSuggestionResultSelectedWide":"DesignerSuggestionResultSelected";this.zb=Ka;this.je=pb;this.EAb=Nb}iyk(t){const P=[];try{if(!t||!t.SlideSuggestions)return O.a.J(510248778,829,50,"DesignerViewHelper:ParseSuggestionDataFromJsonResults - no slide suggestions to parse"),P;for(let ia=0;ia<t.SlideSuggestions.length;ia++){if(!t.SlideSuggestions[ia])continue;const Aa=t.SlideSuggestions[ia].Base64Img;let Ka=null;try{Ka=Object.assign(new xo,{suggestionIndex:t.SlideSuggestions[ia].Index.toString(),
suggestionCid:t.SlideSuggestions[ia].SlideId.Cid.toString(),suggestionSid:t.SlideSuggestions[ia].SlideId.Sid.toString(),imageData:Aa.startsWith("data:image")?Aa:"data:image/png;base64,"+Aa,label:String.format(ResourceStrings.l_DesignerSuggestionItem,ia+1)})}catch(pb){O.a.J(510248777,829,15,"DesignerViewHelper:ParseSuggestionDataFromJsonResults - error happened on getting slide suggestions by SlideId"),Ka=null}Ka||(Ka=Object.assign(new xo,{suggestionIndex:t.SlideSuggestions[ia].Index.toString(),suggestionSid:t.SlideSuggestions[ia].SlideSid.toString(),
imageData:Aa.startsWith("data:image")?Aa:"data:image/png;base64,"+Aa,label:String.format(ResourceStrings.l_DesignerSuggestionItem,ia+1)}));Array.add(P,Ka)}}catch(ia){O.a.J(510248776,829,10,"DesignerViewHelper:ParseSuggestionDataFromJsonResults - error happened on getting slide suggestions. {0}",ia)}return P}L6i(t,P,ia){if(!t)throw Error.argumentNull("suggestionsContainer");return t.querySelector("#"+P+" ."+ze.UPa+'[correlationId="'+ia+'"]')}O9d(){return this.la.rKi?this.la.qKi:this.la.pKi}YVc(t){if(!this.la.designerIncrementalRenderEnabled)return!1;
let P=!0;switch(t){case Le.a.moreIdeas:P=!1;break;case Le.a.newDocument:P=!1}return P}FPe(t){O.a.J(510248775,829,50,"DesignerViewHelper:RenderSuggestions. CorrelationId:{0}, FirstRender:{1}",this.Rb.correlationId,t.u8a);if(t.Wtb&&t.oOc&&t.dga){var P=this.Mge(),ia=t.dga.parentNode.parentNode.id;if(t.kXe&&this.la.ZQa&&t.u8a)switch(t.Wtb.DocumentUpsellStatus){case 0:this.N6h(t.dga);break;case 1:this.i5h(t.dga);break;case 2:this.S4h(t.dga)}t.u8a&&this.la.yNc&&this.Bih(t.dga);var Aa;if(Aa=t.u8a?this.SBi(t.oOc,
t.Jh,t.dga,P,t.Xtd):this.L6i(t.dga,ia,t.Jh))try{const pb=this.Rb.$Pa,Nb=!xb.a.Wa(pb)&&ia===ch.G7b,kc=this.pki(t.Wtb,Nb,pb);if(t.u8a){this.Rb.S_e=new Date;t.Xtd&&this.Nkl(t.VSi);for(var Ka=0;Ka<Aa.childNodes.length;Ka++){let Rc=Aa.childNodes[Ka];t.Xtd&&this.Udl(kc,Ka)?ze.kgl(P,Ka,Rc):this.BPe(Nb?pb[Ka].Type:0,t.dga,Rc,ia,t.oOc,kc[Ka.toString()],Ka,t.kXe,t.Wtb.DocumentUpsellStatus)}this.la.jja&&t.Wtb.HasPaginationInfo&&this.nvh(t.dga,t.Jh)}else if(t.Xtd){O.a.J(510248774,829,50,"DesignerViewHelper:RenderSuggestions. CorrelationId:{0}, Incremental Render. suggestionDataDict Count:{1}",
this.Rb.correlationId,hg.a.count(kc));for(Ka of Object.keys(kc)){const Rc=parseInt(Ka);let Yc=t.dga.querySelector("#"+ia+" ["+ze.UBa+'="'+Rc+'"]');kc[Ka]&&Yc&&Sys.UI.DomElement.containsCssClass(Yc.firstChild,"IncSuggestionPlaceholder")&&this.BPe(Nb?pb[Rc].Type:0,t.dga,Yc,ia,t.oOc,kc[Ka],Rc,t.kXe,t.Wtb.DocumentUpsellStatus)}}}catch(pb){O.a.J(510248773,829,10,"DesignerViewHelper:RenderSuggestions - exception. CorrelationId:{0}, Error:{1}",this.Rb.correlationId,pb)}}}IVk(t,P,ia,Aa){try{if(!(t&&t.SlideSuggestions&&
t.SlideSuggestions.length&&P))return!1;this.pVc(P);const Ka=P.querySelector("."+ze.UPa);if(!Ka)return!1;const pb=Ka.childNodes.length,Nb=Ka.childNodes.length+t.SlideSuggestions.length,kc=this.Mge(),Rc=P.parentNode.parentNode.id;for(let Yc=0;Yc<t.SlideSuggestions.length;++Yc){const hd=this.FHf(pb+Yc,Nb,kc);this.BPe(0,P,hd,Rc,Nb,t.SlideSuggestions[Yc],pb+Yc,Aa,t.DocumentUpsellStatus);Ka.appendChild(hd)}t.HasPaginationInfo&&this.nvh(P,ia);return!0}catch(Ka){return O.a.J(510248772,829,10,"DesignerViewHelper:RenderMoreIdeas - Exceptionstion {0}",
Ka),!1}}pki(t,P,ia){const Aa={};if(P)for(const Ka of ia)switch(Ka.Type){case 0:P=Ka;ia=null;for(const pb of t.SlideSuggestions)if(pb.Index===P.IndexInDesigner){ia=pb;break}Aa[Ka.Index.toString()]=ia;break;default:Aa[Ka.Index.toString()]=Ka}else for(const Ka of t.SlideSuggestions)Aa[Ka.Index.toString()]=Ka;return Aa}Udl(t,P){P=P.toString();return!(P in t)||!t[P]}N6h(t){const P=cb.a.Fe();P.className="DesignerFreeTrialCardContainer";const ia=cb.a.Fe();ia.className="DesignerFreeTrialCardTitle";ia.innerText=
ResourceStrings.l_DesignerUpsellStartFreeTrialTitle;const Aa=cb.a.Fe();Aa.className="DesignerFreeTrialCardContent";Aa.innerText=String.format(ResourceStrings.l_DesignerUpsellStartFreeTrialContent,this.O9d());const Ka=cb.a.Fe();Ka.className="DesignerStartFreeTrialButtonsContainer";const pb=cb.a.Fe();pb.className=ze.bsb;pb.innerText=ResourceStrings.l_DesignerUpsellStartFreeTrialButtonText;pb.tabIndex=0;pb.setAttribute(pa.a.gs,pb.innerText);pb.setAttribute(pa.a.af,pa.a.ru);const Nb=cb.a.Fe();Nb.className=
ze.MHc;const kc=document.createElement("i");kc.className=ze.SHc;kc.style.lineHeight="20px";kc.setAttribute("Unselectable","on");const Rc=cb.a.Fe();Rc.className="DesignerStartTrialGoPremiumButtonText";Rc.innerText=ResourceStrings.l_DesignerUpsellGoPremiumText;Rc.setAttribute("Unselectable","on");Nb.setAttribute(pa.a.gs,Rc.innerText);Nb.setAttribute(pa.a.af,pa.a.ru);Nb.tabIndex=0;Nb.appendChild(kc);Nb.appendChild(Rc);Ka.appendChild(pb);Ka.appendChild(Nb);P.appendChild(ia);P.appendChild(Aa);P.appendChild(Ka);
P.setAttribute(pa.a.gs,String.format("{0}. {1}",ia.innerText,Aa.innerText));P.setAttribute(pa.a.af,pa.a.LBa);t.appendChild(P)}VHf(){const t=cb.a.Fe();t.className="DesignerInFreeTrialView";const P=document.createElement("i");P.className=v.AFrameworkApplication.isRtl?"ms-Icon ms-Icon--Diamond DesignerInFreeTrialViewIconRTL":"ms-Icon ms-Icon--Diamond DesignerInFreeTrialViewIcon";const ia=cb.a.Fe();ia.className=ze.tZb;ia.innerText=ResourceStrings.l_DesignerUpsellGoPremiumText;ia.tabIndex=0;const Aa=cb.a.Fe();
Aa.className=v.AFrameworkApplication.isRtl?"DesignerInFreeTrialViewTextRTL":"DesignerInFreeTrialViewText";Aa.innerText=ResourceStrings.l_DesignerUpsellInFreeTrialText;ia.setAttribute(pa.a.af,pa.a.kQd);ia.setAttribute(pa.a.qrb,pa.a.ura);ia.setAttribute(pa.a.gs,ia.innerText);t.appendChild(P);t.appendChild(ia);t.appendChild(Aa);t.setAttribute(pa.a.gs,ia.innerText+" "+Aa.innerText);t.setAttribute(pa.a.af,pa.a.LBa);return t}bsl(){const t=document.getElementsByClassName("DesignerFreeTrialCardContainer");
if(t)for(let P=0;P<t.length;P++){const ia=t[P];if(ia.parentNode){const Aa=this.VHf();ia.parentNode.replaceChild(Aa,ia)}}this.eFh()}i5h(t){const P=this.VHf();t.appendChild(P)}S4h(t){const P=cb.a.Fe();P.className="DesignerFreeTrialCardContainer";const ia=cb.a.Fe();ia.className="DesignerFreeTrialCardTitle";ia.innerText=ResourceStrings.l_DesignerUpsellFreeTrialExhaustedTitle;const Aa=cb.a.Fe();Aa.className="DesignerFreeTrialCardContent";Aa.innerText=ResourceStrings.l_DesignerUpsellFreeTrialExhaustedContent;
const Ka=cb.a.Fe();Ka.className=ze.sZb;const pb=document.createElement("i");pb.className=ze.SHc;pb.style.lineHeight="20px";const Nb=cb.a.Fe();Nb.className="DesignerTrialExhaustedGoPremiumButtonText";Nb.innerText=ResourceStrings.l_DesignerUpsellGoPremiumText;Ka.setAttribute(pa.a.gs,Nb.innerText);Ka.setAttribute(pa.a.af,pa.a.ru);Ka.tabIndex=0;Ka.appendChild(pb);Ka.appendChild(Nb);P.appendChild(ia);P.appendChild(Aa);P.appendChild(Ka);P.setAttribute(pa.a.gs,String.format("{0}. {1}",ia.innerText,Aa.innerText));
P.setAttribute(pa.a.af,pa.a.LBa);t.appendChild(P)}nvh(t,P){const ia=cb.a.Fe();ia.className=ze.dSd;ia.setAttribute(ze.asb,P);ia.tabIndex=0;P=new od.a;P.ih(16,16);P.qya("0,0,2048,2048");const Aa=new km.a;Aa.i1("M 1536 138 q 115 66 209 160 q 94 93 162 207 q 67 114 104 246 q 37 131 37 273 q 0 141 -36 272 q -37 131 -104 245 q -67 113 -160 207 q -94 93 -207 160 q -114 67 -245 104 q -131 36 -272 36 q -141 0 -272 -36 q -131 -37 -244 -104 q -114 -67 -207 -160 q -94 -94 -161 -207 q -67 -114 -103 -245 q -37 -131 -37 -272 q 0 -145 39 -278 q 38 -134 108 -249 q 69 -116 167 -210 q 97 -94 216 -159 h -530 v -128 h 768 v 768 h -128 v -553 q -113 54 -207 137 q -95 83 -162 188 q -68 104 -105 227 q -38 123 -38 257 q 0 124 32 238 q 32 114 91 214 q 58 99 140 181 q 82 82 182 141 q 99 58 214 90 q 114 32 237 32 q 123 0 238 -32 q 114 -32 214 -90 q 99 -59 181 -141 q 82 -82 141 -181 q 58 -100 90 -214 q 32 -115 32 -238 q 0 -114 -27 -220 q -28 -106 -78 -200 q -50 -94 -121 -173 q -71 -80 -158 -141 z");
P.appendChild(Aa);P=P.xa;P.setAttribute("class","DesignerMoreIdeasButtonIcon");ia.appendChild(P);P=cb.a.Fe();P.className="DesignerMoreIdeasButtonLabel";P.innerText=ResourceStrings.l_DesignerSeeMoreIdeas;ia.appendChild(P);ia.setAttribute(pa.a.gs,P.innerText);ia.setAttribute(pa.a.af,pa.a.ru);t.appendChild(ia)}vgl(t){if(t){var P=cb.a.eC();P.className="DesignerMoreIdeasLoading";P.src=ig.a.RK(Xb.a.Bna);t.appendChild(P)}}pVc(t){if(t){var P=t.querySelector("."+ze.dSd);P&&t.removeChild(P);(P=t.querySelector(".DesignerMoreIdeasLoading"))&&
t.removeChild(P)}}SBi(t,P,ia,Aa,Ka){const pb=cb.a.Fe();pb.className=ze.UPa;pb.setAttribute(ze.asb,P);pb.setAttribute(pa.a.gs,ResourceStrings.l_DesignerSuggestions);pb.setAttribute(pa.a.af,pa.a.DYb);Ka&&(this.Rb.GZb=this.l3i());for(P=0;P<t;++P)pb.appendChild(this.FHf(P,t,Aa));ia.appendChild(pb);return pb}FHf(t,P,ia){const Aa=cb.a.Fe();Aa.className=ia?this.s9c+"4x3":this.s9c;Aa.setAttribute(ze.UBa,t);Aa.tabIndex=0;Aa.setAttribute(pa.a.gs,String.format(ResourceStrings.l_DesignerSuggestionItem,t+1));
Aa.setAttribute(pa.a.af,pa.a.DPa);Aa.setAttribute(pa.a.mQd,t+1);Aa.setAttribute(pa.a.nQd,P);return Aa}BPe(t,P,ia,Aa,Ka,pb,Nb,kc,Rc){let Yc=null;this.la.designerIncrementalRenderEnabled&&(P&&(Yc=P.querySelector("#"+Aa+' [IncSuggestionPlaceholder="'+Nb+'"]')),Yc&&Sys.UI.DomElement.addCssClass(Yc,"ShimmerPaused"),this.c1j(Nb,Ka));P=!1;switch(t){case 0:this.N9k(ia,pb,Nb);P=(t=kc&&this.la.ZQa)&&1!==Rc;Ka=Aa=Rc=!1;if(pb&&pb.Categories)for(const hd of pb.Categories)2===hd?Rc=kc&&!t:1===hd?Aa=!0:3===hd?Ka=
!0:4===hd&&this.sce(ia,"commoncontrolsmartalignandspace.svg",ResourceStrings.l_DesignerFixItSuggestionItem,Nb);(Rc||P)&&this.E$k(ia);Aa?this.sce(ia,"commoncontrolvideocamerawithwhiteborder_24.svg",ResourceStrings.l_DesignerLoopingVideoSuggestionItem,Nb):Ka&&(this.sce(ia,"commoncontrolanimationsuggestioniconnoborder.svg",ResourceStrings.l_DesignerAnimationSuggestionItem,Nb),ia.setAttribute(ze.VRd,ze.VRd),ia.setAttribute("title",ResourceStrings.l_DesignerAnimationSuggestionTooltip));this.la.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.Designer.EnableDesignDescriptions",
!1)&&this.w4h(ia,pb);break;case 1:this.GVk(ia,pb);break;case 2:this.xVk(ia);break;case 3:case 4:this.TVk(ia,pb)}Yc&&Yc.parentNode.removeChild(Yc);pb=cb.a.Fe();pb.className=ze.WHc;P&&(pb.style.visibility=Xa.a.visible,ia.removeAttribute("tabindex"),ia.setAttribute(pa.a.JK,pa.a.XB));ia.appendChild(pb)}GVk(t,P){if(P){t.className=Dd.Ubd;t.setAttribute(pa.a.gs,ResourceStrings.L_MakeItVisualCardTitle);var ia=cb.a.Nn();ia.className=Dd.Hhk;ia.innerText=ResourceStrings.L_MakeItVisualCardTitle;var Aa=cb.a.Nn();
Aa.className=Dd.Ghk;Aa.innerText=ResourceStrings.L_MakeItVisualCardSubtitle;var Ka=cb.a.Fe();Ka.className=Dd.Fhk;Ka.setAttribute(pa.a.af,pa.a.DYb);var pb=0,Nb=new Im.a,kc=Math.min(ch.Vhc,P.SearchTerms.length);for(let Rc=0;Rc<kc;Rc++)pb=this.kIf(P.SearchTerms[Rc].Term,Ka,Nb,Rc,pb);for(P=kc;P<ch.Vhc;P++)for(const Rc of ch.wKf)if(!Nb.contains(Rc)){pb=this.kIf(Rc,Ka,Nb,P,pb);break}t.appendChild(ia);t.appendChild(Aa);t.appendChild(Ka);this.Rb.jbd=!0}}kIf(t,P,ia,Aa,Ka){const pb=cb.a.Fe();pb.className=Dd.PYg;
pb.setAttribute(pa.a.af,pa.a.DPa);const Nb=Dd.tFb+"."+Aa,kc=cb.a.eC();kc.className=Dd.Ehk;kc.src=({Cxb:Ka}=this.ebj(t,ia,Ka)).returnValue;kc.setAttribute(pa.a.D2,Nb);ia=cb.a.Fe();ia.className=Dd.sFb;ia.tabIndex=0;ia.setAttribute(Dd.SYg,Aa);ia.setAttribute(pa.a.af,pa.a.ru);Aa=document.createElement("i");Aa.className=Dd.DCe;Aa.innerText="\ue721";Aa.setAttribute(pa.a.af,pa.a.fN);const Rc=cb.a.Nn();Rc.className=Dd.tFb;Rc.innerText=t;Rc.id=Nb;pb.appendChild(kc);pb.appendChild(ia);ia.appendChild(Aa);ia.appendChild(Rc);
P.appendChild(pb);return Ka}ebj(t,P,ia){for(const Aa of ch.wKf)if(Aa.toLowerCase()===t.toLowerCase())return P.add(Aa),{returnValue:this.je.pk(t+".png"),Cxb:ia};return{returnValue:this.je.pk("stock"+ia++ +".png"),Cxb:ia}}M9k(t,P){if(t){var ia=document.createElement("video");ia.className="SuggestedVideoBackgroundContainer";ia.setAttribute("Src",P);ia.setAttributeNode(document.createAttribute("muted"));aj.a.nRj()||(ia.setAttributeNode(document.createAttribute("autoplay")),ia.setAttributeNode(document.createAttribute("loop")),
ia.addEventListener("canplay",()=>{ia.muted="true";ia.play()}));t.appendChild(ia)}}sce(t,P,ia,Aa){if(t){var Ka=cb.a.eC();Ka.src=this.je.pk(P);Ka.className="SuggestedMediaIcon";P=cb.a.Nn();P.className="SuggestedMediaContainer";P.appendChild(Ka);t.setAttribute(pa.a.gs,String.format(ia,Aa+1));P.setAttribute("aria-hidden",pa.a.XB);P.setAttribute("Unselectable","on");t.appendChild(P)}}w4h(t,P){t&&P&&P.DesignDescription&&0!=P.DesignDescription.length&&t.setAttribute(pa.a.gs,P.DesignDescription)}E$k(t){if(t)if(this.la.ZQa)Sys.UI.DomElement.addCssClass(t,
Xa.a.Tkc);else{t.setAttribute(ze.PHc,ze.PHc);var P=t.getAttribute(pa.a.gs);P&&t.setAttribute(pa.a.gs,String.format("{0}. {1}",P.toString(),ResourceStrings.l_DesignerPremiumSuggestionItem));pa.a.bP(t,pa.a.qrb,pa.a.ura);P=cb.a.Fe();P.className=ze.VHc;var ia=document.createElement("i");ia.className=ze.SHc;P.appendChild(ia);t.appendChild(P)}}eFh(){const t=document.getElementsByClassName(ze.wZb);if(t)for(let P=0;P<t.length;P++){Sys.UI.DomElement.removeCssClass(t[P].parentNode,Xa.a.Tkc);t[P].parentNode.tabIndex=
0;t[P].parentNode.removeAttribute(pa.a.JK);const ia=la.a.Pca(t[P].parentNode,ze.WHc);!ia||ia.getAttribute(ze.jSd)&&ia.getAttribute(ze.jSd).toString()===ze.Pzf||(ia.style.visibility=Xa.a.hidden)}}Jwl(){if(this.la.ZQa){var t=document.getElementsByClassName("DesignerFreeTrialCardContainer");if(t)for(var P=0;P<t.length;P++)t[P].parentNode.removeChild(t[P]);if(t=document.getElementsByClassName("DesignerInFreeTrialView"))for(P=0;P<t.length;P++)t[P].parentNode.removeChild(t[P]);this.eFh()}else if(t=document.getElementsByClassName(ze.VHc))for(P=
0;P<t.length;P++){t[P].style.display="none";const Aa=t[P].parentNode;Aa.removeAttribute(ze.PHc);Aa.removeAttribute(pa.a.qrb);var ia=Aa.getAttribute(pa.a.gs);ia&&(ia=ia.toString(),ia=ia.replace(ResourceStrings.l_DesignerPremiumSuggestionItem,""),Aa.setAttribute(pa.a.gs,ia))}}N9k(t,P,ia){if(t&&P)try{let Aa=!1;try{t.setAttribute(ze.dsb,P.SlideId.Sid),t.setAttribute(ze.iSd,P.SlideId.Cid),Aa=!0}catch(pb){O.a.J(510248771,829,15,"DesignerViewHelper:SetSuggestionImgSrc - failed to access suggestionItem.SlideId"),
Aa=!1}Aa||t.setAttribute(ze.dsb,P.SlideSid);const Ka=cb.a.eC();Ka.className=ze.wZb;Ka.src=P.Base64Img;this.Rb.isa.contains(P.Index)||this.Rb.isa.add(P.Index);this.la.hMc&&!ab.a.Wa(P.DesignerMediaURL)&&P.Categories&&xb.a.contains(P.Categories,1)&&this.M9k(t,P.DesignerMediaURL);t.appendChild(Ka);O.a.J(510248770,829,50,"DesignerViewHelper:SetSuggestionImgSrc - img at index {0} rendered. CorrelationId: {1}",ia,this.Rb.correlationId)}catch(Aa){t.parentNode.removeChild(t),O.a.J(510248769,829,10,"DesignerViewHelper:SetSuggestionImgSrc - img at index {0} failed to render in browser. CorrelationId: {1}, Error: {2}",
ia,this.Rb.correlationId,Aa)}}xVk(t){if(xb.a.Wa(this.Rb.yW)||!this.Rb.Lxi())t.style.display=Xa.a.none;else{t.className=Dd.x_d;var P=cb.a.Nn();P.className=Dd.YOi;P.innerText=ResourceStrings.L_ConsistencyCardTitle;var ia=cb.a.Fe();ia.className=Dd.UOi;var Aa=cb.a.Nn();Aa.className=Aa.id=Dd.MOf;Aa.innerText=Aa.title=this.Rb.yW[0].critiques[0].explanationLabel;var Ka=cb.a.Fe();Ka.className=Dd.IOi;var pb=cb.a.Nn();pb.innerText="<";pb.tabIndex=0;Sys.UI.DomElement.addCssClass(pb,Dd.O7a);Sys.UI.DomElement.addCssClass(pb,
Dd.p2b);pb.id=Dd.O7a;var Nb=cb.a.Nn();Nb.innerText="1";Nb.id=Dd.w_d;this.Rb.rN=0;var kc=cb.a.Nn();kc.innerText="/";var Rc=cb.a.Nn();Rc.className=Dd.JOi;Rc.id=Dd.BOf;Rc.innerText=this.Rb.yW.length.toString();var Yc=cb.a.Nn();Yc.innerText=">";Yc.tabIndex=0;Yc.className=Yc.id=Dd.qub;0<this.Rb.yW.length-1?Sys.UI.DomElement.addCssClass(Yc,Dd.rub):Sys.UI.DomElement.addCssClass(Yc,Dd.o2b);Ka.appendChild(pb);Ka.appendChild(Nb);Ka.appendChild(kc);Ka.appendChild(Rc);Ka.appendChild(Yc);ia.appendChild(Aa);ia.appendChild(Ka);
Aa=cb.a.Nn();Aa.className=Dd.LOi;Aa.innerText=ResourceStrings.L_ConsistencyCardDescription;Ka=ze.IHf();this.Q8f(Ka,0);pb=cb.a.Fe();pb.className=Dd.OOi;Nb=cb.a.Fe();Nb.className=Dd.n2b;Nb.innerText=ResourceStrings.L_ConsistencyCardIgnore;Nb.title=ResourceStrings.L_ConsistencyCardIgnoreTitle;Nb.tabIndex=0;pb.appendChild(Nb);Nb=cb.a.Fe();Nb.className=Dd.SOi;kc=cb.a.Nn();kc.className=Dd.r2b;kc.innerText=ResourceStrings.L_ConsistencyCardSeeMore;kc.tabIndex=0;Nb.appendChild(kc);kc=cb.a.Fe();kc.id=Dd.COf;
kc.appendChild(ia);kc.appendChild(Aa);kc.appendChild(Ka);kc.appendChild(pb);t.appendChild(P);t.appendChild(kc);t.appendChild(Nb);this.Rb.nNc=!0}}TVk(t,P){if(P){t.className=ze.Zzf;t.setAttribute(pa.a.gs,P.TitleText);t.setAttribute(ze.UBa,P.Index);var ia=this.vml(P.ExecutionActionName);if(ia){var Aa=cb.a.eC();Aa.src=this.je.pk("pegal.png");Aa.className=ia;var Ka=cb.a.Nn();Ka.className="cui-img-container cui-img-24by24";Ka.appendChild(Aa);t.appendChild(Ka)}Aa=cb.a.Nn();Aa.className="DesignerSuggestedActionTitle";
Aa.innerText=P.TitleText;Ka=cb.a.Nn();Ka.className="DesignerSuggestedActionSubtitle";Ka.innerText=P.DescriptionText;P=cb.a.Fe();P.className=ia?"DesignerSuggestedActionDescriptionWithIcon":"DesignerSuggestedActionDescription";P.appendChild(Aa);P.appendChild(Ka);t.appendChild(P)}}Bih(t){try{if(this.EAb&&this.EAb.instance){const P=cb.a.Fe();P.id="AgendaCardContainer";P.className="AgendaCardContainer";t.appendChild(P);this.EAb.instance.uuh(P)}}catch(P){O.a.J(510248768,829,10,"DesignerViewHelper:RenderAgendaCard failed with Exception. CorrelationId:{0}, Exception:{1}",
this.Rb.correlationId,P)}}Dri(){try{this.EAb&&this.EAb.instance&&this.EAb.instance.Wae()}catch(t){O.a.J(510248729,829,10,"DesignerViewHelper:CleanUpAgendaCard failed with Exception. CorrelationId:{0}, Exception:{1}",this.Rb.correlationId,t)}}vml(t){switch(t){case "PowerPointConvertImageToTable":return"pegal_ImageToTable_24x24x32";default:return null}}Q8f(t,P){P=this.Rb.yW[P].critiques[0].suggestions;const ia=Math.min(ch.dgk,P.length);for(let Aa=0;Aa<ia;Aa++)this.Ztj(t,P[Aa].description,P[Aa].numberOfInstances,
Aa)}Ztj(t,P,ia,Aa){const Ka=cb.a.Fe();Ka.className=Dd.nRa;Ka.tabIndex=0;Ka.setAttribute(ch.mRa,Aa);const pb=cb.a.Nn();pb.className=Dd.oNc;pb.innerText="\u2192";pb.setAttribute(ch.mRa,Aa);const Nb=cb.a.Nn();Nb.className=Dd.OOf;Nb.innerText=P;Nb.setAttribute(ch.mRa,Aa);P=cb.a.Nn();P.className=Dd.NOf;P.innerText=String.format("[{0}]",ia);P.setAttribute(ch.mRa,Aa);Ka.appendChild(pb);Ka.appendChild(Nb);Ka.appendChild(P);t.appendChild(Ka)}Nkl(t){this.mqd();this.odc=new D.a(2,1,this.la.designerIncrementalRenderTimeoutInMs,
()=>{this.b1j(t)},void 0,"IncrementalRenderTimeoutTask");this.zb.Eb(this.odc)}mqd(){this.odc&&(this.zb.Rg(this.odc),this.odc=null)}b1j(t){this.mqd();for(let P=0;P<t;P++)this.Rb.isa.contains(P)||this.Rb.XVc.add(P)}c1j(t,P){if(!this.Rb.ZPa.contains(t)&&(this.Rb.ZPa.add(t),t=this.Rb.ZPa.count,t===P&&(this.Rb.bYb=new Date,this.mqd()),!this.Rb.XOb&&t>=this.Rb.GZb)){for(P=0;P<this.Rb.GZb;P++)if(!this.Rb.ZPa.contains(P))return;this.Rb.XOb=new Date}}l3i(){const t=document.getElementById("WACDocumentPanel");
if(t){const P=this.la.useWideSuggestionThumbs,ia=this.Mge();return Math.floor((t.offsetHeight-87)/(P||ia?135:101))}return 1}Mge(){const t=this.zu();return.01>=Math.abs(t.width/t.height-1.33)}VCf(t,P){this.n3e(this.Evb(t,P),P,!1)}Moh(t,P){this.n3e(t,P,!0)}Nvl(t){if(t&&(t=t.querySelector(".DesignerSuggestionResultSelected, .DesignerSuggestionResultSelected4x3, .DesignerSuggestionResultSelectedWide, .DesignerSuggestionResultSelectedWide4x3"))){var P=-1!==t.className.indexOf("4x3");this.n3e(t,P,!1)}}n3e(t,
P,ia){t&&(ia?(t.className=P?this.t9c+"4x3":this.t9c,pa.a.bP(t,pa.a.X5a,pa.a.XB)):(t.className=P?this.s9c+"4x3":this.s9c,pa.a.bP(t,pa.a.X5a,pa.a.ura)))}zu(){return this.qc.zu()}Evb(t,P){return t.querySelector("."+(P?this.t9c+"4x3":this.t9c))}get Ba(){return Object(R.a)(116,this.ua.Ba)}onh(t,P){if(t){if(t=t.querySelector("["+ze.UBa+'="'+P+'"]'))P=Ze.a.ii(t),t.contains(Ze.a.rSa(new Sys.UI.Point(P.x,P.y)))&&t.contains(Ze.a.rSa(new Sys.UI.Point(P.x+P.width-1,P.y)))?t.contains(Ze.a.rSa(new Sys.UI.Point(P.x,
P.y+P.height-1)))&&t.contains(Ze.a.rSa(new Sys.UI.Point(P.x+P.width-1,P.y+P.height-1)))||t.scrollIntoView(!1):t.scrollIntoView(!$c.a("Designer.ScrollIntoViewFix"))}else O.a.J(510248728,829,15,"Designer view has been removed from DesignerViewContainer")}static OYd(t){let P=null;try{P=fe.a(t)}catch(ia){O.a.J(510248727,829,10,"DesignerViewHelper:TransformSuggestionDataFormat - parsing suggestionResults failed")}return P}static Cxk(t){const P=t.CardData;let ia=null;try{if(ia=fe.a(P),!t.SlideSuggestions&&
ia)for(ia=gm.e(ia,Aa=>0!==Aa.Type),t=0;t<ia.length;t++)ia[t].Index=t}catch(Aa){O.a.J(510248726,829,10,"parsing cards failed with exception: {0}",Aa)}return ia}static kgl(t,P,ia){ia.style.backgroundColor="white";const Aa=cb.a.Fe();Aa.className=t?"IncSuggestionPlaceholder placeholder_237x178":"IncSuggestionPlaceholder placeholder_237x137";Aa.setAttribute("IncSuggestionPlaceholder",P);(ve.a.Uj||ve.a.fg)&&Sys.UI.DomElement.addCssClass(Aa,"Shimmer");ia.appendChild(Aa)}static IHf(){const t=cb.a.Fe();t.className=
t.id=Dd.POf;return t}}ze.UPa="DesignerSuggestionList";ze.asb="correlationId";ze.UBa="suggestionIndex";ze.dsb="slideId";ze.iSd="slideCid";ze.PHc="isShownAsPremiumContent";ze.VRd="containsAnimation";ze.Pzf="Refreshing";ze.jSd="SourceTrigger";ze.wZb="SuggestionImg";ze.SHc="ms-Icon ms-Icon--Diamond";ze.VHc="ShadowedTriangleContainer";ze.WHc="DesignerSuggestionListDisabled";ze.dSd="DesignerMoreIdeasButton";ze.Zzf="DesignerSuggestedActionResult";ze.tZb="DesignerInFreeTrialViewGoPremiumText";ze.sZb="DesignerFreeTrialCardGoPremiumButton";
ze.bsb="DesignerStartFreeTrialButton";ze.MHc="DesignerStartFreeTrialGoPremiumButton";Object(k.a)(ze,"DesignerViewHelper",null,[758]);class Hn{constructor(){this.cid=this.sid=0;this.yVc=this.AQ=this.trigger=null}}Object(k.a)(Hn,"PendingRequest",null,[]);class ci{constructor(){this.Yye=!1;this.PCb=null}get ujg(){return this.Yye}get vmg(){return this.PCb}static get inProgress(){const t=new ci;t.Yye=!0;t.PCb=new Date;return t}static get ready(){const t=new ci;t.Yye=!1;t.PCb=null;return t}}Object(k.a)(ci,
"RequestState",null,[]);var Og=d(332),qn=d(432);class tm{constructor(t,P,ia,Aa,Ka,pb,Nb,kc,Rc,Yc,hd,se,Ae,we,Jf,Yh,Me,mh,af,sk,Nj,an,oo,Ho,Pn,Io,Cl,Ck,Vp,Wp){this.$L=null;this.tIa=this.Bwg=0;this.oDg=!1;this.nVa=this.nfb=null;this.Ksg=!1;this.ssj=(bn,mt,Oq)=>{if(1===Oq)return 32;try{this.Op&&this.Op.Uo&&this.Op.Uo.isVisible?Ob.UISurfaces.xr().then(Jo=>{Jo.setSelectedTaskPane(fd.a.b_);return null}).catch(Jo=>{O.a.J(509354911,811,10,"DesignerPane::SelectPane exception: {0}",Jo.toString())}):this.ia.processAction(hb.a.avb,
2)}catch(Jo){return O.a.J(509354910,811,10,"DesignerPane::OpenOrSelectPane exception: {0}",Jo.toString()),8}return 32};this.Oo=Nb;this.Op=kc;this.dr=Rc;this.$y=Yc;this.Rb=hd;this.ia=t;this.OT=P;this.ob=Ka;this.Fa=pb;this.ua=se;this.Lg=Ae;this.Lc=we;this.la=Yh;this.fc=ia;this.Jb=Aa;this.vi=Me;this.hma=mh;this.pma=ci.ready;this.D9=af;this.Fb=sk;this.Oc=Nj;this.zb=an;this.WEb=oo;this.occ=Io;this.qc=Cl;this.XL=Ck;this.ow=Vp;this.Lpg=Wp;this.Awg=Object(r.a)(this,this.Qqj,"handleFirstRunExperienceEvent");
Pn&&Pn.isFeatureEnabled("PowerPointEnterpriseDesigner",!1).then(bn=>{this.oDg=bn;return null});this.ia.Lna(this)}vb(){this.la.ZXc&&(this.ia.ra(hb.a.Wuh,lb.a.application,Object(r.a)(this,this.Vuh,"showHideIdeas"),4),this.ia.ra(hb.a.BWe,lb.a.application,Object(r.a)(this,this.Vuh,"showHideIdeas"),4),$c.a("Designer.QueryNewPane")&&this.ia.ra(hb.a.Gmc,lb.a.application,Object(r.a)(this,this.yHk,"queryShowHideDesignerPane"),96),this.la.qT&&$c.a("HandleDesignerAutoFocus")&&this.ia.ra(hb.a.q7g,lb.a.application,
this.ssj,4),this.ia.ra(hb.a.avb,lb.a.application,Object(r.a)(this,this.AWe,"showHideDesigner"),4),this.ia.ra(hb.a.IBa,lb.a.application,Object(r.a)(this,this.IBa,"applyDesignerSuggestion"),4),this.ia.ra(hb.a.grb,lb.a.application,Object(r.a)(this,this.IBa,"applyDesignerSuggestion"),4),this.ia.ya(hb.a.sYa,lb.a.application,Object(r.a)(this,this.qYa,"navigateDesignerSuggestion")),this.ia.ya(hb.a.JFb,lb.a.application,Object(r.a)(this,this.qYa,"navigateDesignerSuggestion")),this.ia.ya(hb.a.KFb,lb.a.application,
Object(r.a)(this,this.qYa,"navigateDesignerSuggestion")),this.ia.ya(hb.a.rYa,lb.a.application,Object(r.a)(this,this.qYa,"navigateDesignerSuggestion")),this.ia.ya(hb.a.GFb,lb.a.application,Object(r.a)(this,this.qYa,"navigateDesignerSuggestion")),this.ia.ya(hb.a.HFb,lb.a.application,Object(r.a)(this,this.qYa,"navigateDesignerSuggestion")),this.ia.ya(hb.a.IFb,lb.a.application,Object(r.a)(this,this.qYa,"navigateDesignerSuggestion")),this.ia.ya(hb.a.Xfb,lb.a.application,Object(r.a)(this,this.qYa,"navigateDesignerSuggestion")),
this.ia.ra(hb.a.Zna,lb.a.application,Object(r.a)(this,this.Zna,"reportSuggestionSessionInfo"),64),this.ia.ya(hb.a.GLf,lb.a.application,Object(r.a)(this,this.Gsl,"triggerOnUndoRedo")),this.ia.ya(hb.a.ode,lb.a.application,Object(r.a)(this,this.l8f,"handleImageUploadForDesigner")),this.ia.ya(hb.a.FWc,lb.a.application,Object(r.a)(this,this.l8f,"handleImageUploadForDesigner")),this.hma.N5a(Object(r.a)(this,this.M0,"onSlidePresenceChanged")),this.Lg.kI(Object(r.a)(this,this.mKi,"designerTargetSlideChangedHandler")),
this.la.designerIncrementalRenderEnabled&&this.Lc.K9h(Object(r.a)(this,this.Zrk,"onRenderSuggestions")),this.la.jja&&this.Lc.a8h(Object(r.a)(this,this.wqk,"onMoreIdesClicked")),this.la.yLf&&this.Lc.M5a(Object(r.a)(this,this.R$,"onRibbonTabSwitched")),this.la.tC&&this.Lg.Hqb(Object(r.a)(this,this.kKi,"designerSlidesSelectionChangedHandler")),this.la.designerSendAppliedSuggestionHistoryEnabled&&this.D9.SXb(Object(r.a)(this,this.dfa,"onBlockingStateChanged")),this.Lg.Yrf(Object(r.a)(this,this.Qdd,"onForceOutboundGraphTransactionDisposed")),
this.WEb.RXb(Object(r.a)(this,this.rgb,"onMarkedUndo")),this.la.UYd&&this.Oc.qPa(Object(r.a)(this,this.ygb,"onSessionEnding")),this.Oc.WB(Object(r.a)(this,this.Bo,"onSessionRehydrated")),this.occ&&this.occ.execute(t=>{t.nsf(Object(r.a)(this,this.GFe,"onEditorCritiques"))}),this.Lpg&&this.Lpg.execute(t=>{t.q9h(Object(r.a)(this,this.opk,"onHighConfidenceAgendaDetected"))}),this.la.fKi?(this.Bwg=window.setTimeout(Object(r.a)(this,this.O1e,"tryTriggerNewDocDesignerRequest"),this.la.eKi),window.addEventListener("FREDecisionEvent",
this.Awg,!0)):this.O1e(),!ab.a.Wa(this.la.DJe)&&this.nKi(this.la.DJe)&&(this.Wpj(),this.Csl(this.la.DJe)))}Qqj(t){window.removeEventListener("FREDecisionEvent",this.Awg,!0);window.clearTimeout(this.Bwg);(t=t.detail)&&t.show&&t.show||this.O1e()}De(){const t=this.Fa.Gc(fd.a.b_);t.bindAction(eb.KeyInputManager.Na(wa.a.K1,0),hb.a.sYa);t.bindAction(eb.KeyInputManager.Na(wa.a.JB,0),hb.a.sYa);t.bindAction(eb.KeyInputManager.Na(wa.a.YE,0),hb.a.JFb);t.bindAction(eb.KeyInputManager.Na(wa.a.Pq,4),hb.a.KFb);
t.bindAction(eb.KeyInputManager.Na(wa.a.I1,0),hb.a.rYa);t.bindAction(eb.KeyInputManager.Na(wa.a.IB,0),hb.a.rYa);t.bindAction(eb.KeyInputManager.Na(wa.a.Nw,0),hb.a.GFb);t.bindAction(eb.KeyInputManager.Na(wa.a.Pq,0),hb.a.HFb);t.bindAction(eb.KeyInputManager.Na(wa.a.PR,0),hb.a.IFb);t.bindAction(eb.KeyInputManager.Na(wa.a.lP,0),hb.a.Xfb)}AWe(t,P,ia,Aa,Ka){return this.yM(this.Op,fd.a.b_,ia,t,Ka)}Vuh(t,P,ia,Aa,Ka){return Ka||!this.Oo.isVisible?this.yM(this.Op,fd.a.x$a,ia,t,Ka):0}yM(t,P,ia,Aa,Ka){var pb=
this.ua.presentation;pb=!!this.ua.Ba&&!!pb&&!this.fc.$c(pb);if(this.la.tC){const Nb=this.ob.We();pb=!!Nb&&1===Nb.length&&pb}if(!pb)return 16;if(!this.$y.isEnabled())return 8;if(1===ia)return 32;Ka||this.Fa.Bj(P,t.Uo.isVisible);Aa===hb.a.avb?this.Rb.correlationId&&!this.Rb.Hzb(this.Rb.correlationId)||this.dda(Le.a.KNb):t.Uo.isVisible?t.Uo.yp(!1,Og.a.NMb):(this.dda(Aa===hb.a.BWe?Le.a.KNb:Le.a.Psc),t.Uo.yp(!0,Og.a.none));return 32}yHk(t,P,ia,Aa,Ka){if(!Object(Lh.a)(Nl.a,Ka)||!this.Op||!this.Op.Uo)return 8;
Ka.Qf(this.Op.Uo.isVisible);return 32}IBa(t,P,ia,Aa,Ka){P=this.ua.presentation;if(!this.ua.Ba||!P||this.fc.$c(P))return 16;Aa=null;let pb=!0;Object(Lh.a)(kg,Ka)?Aa=Ka:Object(Lh.a)(Gn,Ka)&&(Aa=Ka.KGc,pb=!1);if(!this.$y.isEnabled()||!Aa)return 8;if(this.$y.Dwk())return O.a.J(512496589,829,50,"DesignerActor::ApplyDesignerSuggestion - skipped when client refresh. CorrelationId: {0}, ActionId: {1}",Aa.CorrelationId,t),8;if(1===ia)return 32;if(!this.ob.xs()){if(1===this.ob.Xd().length&&this.ob.Xd()[0].Yx)return this.ob.Qh(),
O.a.J(512496588,829,15,"DesignerActor::ApplyDesignerSuggestion - skipped when there are picture in crop mode. CorrelationId: {0}, ActionId: {1}",Aa.CorrelationId,t),8;this.ob.Qh()}if(!this.la.jja&&this.Rb.KZ.sid===Aa.SuggestionSid)return O.a.J(512496587,829,50,"DesignerActor::ApplyDesignerSuggestion - suggestion already applied, skipping. CorrelationId: {0}, SuggestionSid: {1}",Aa.CorrelationId,Aa.SuggestionSid),2;ia=this.Jb.le(15);try{this.la.designerSendAppliedSuggestionHistoryEnabled&&(this.Rb.APa=
new Date),ia.nc(P),ia.jd=t,P.NCa=Aa,this.Rb.KZ=Q.a.PE(Aa.SuggestionSid,Aa.SuggestionCid),this.Rb.zT=!0,O.a.J(512496586,829,50,"DesignerActor::ApplyDesignerSuggestion - CorrelationId: {0}, ActionId: {1}, SuggestionSid: {2}",Aa.CorrelationId,t,Aa.SuggestionSid)}finally{ia&&ia.dispose()}this.la.designerBlockApplyUntilDraw?this.fc.Bra(P,this.ua.Ba,this.Fb.Ma,t):this.fc.Zv(P,t);this.Oo.isVisible&&this.Fa.xf(fd.a.x$a);pb&&this.Rb.aCe();return 32}qYa(t,P,ia){P=this.ua.presentation;if(!this.ua.Ba||!P||this.fc.$c(P))return 16;
if(!this.$y.isEnabled())return 8;if(1===ia)return 32;this.$y.Zuj(t);return 32}Zna(t,P,ia,Aa,Ka){if(this.$y.Op.Uo.isVisible)return 0;this.EKb(Ka.oZc,Ka.QXk);return 32}EKb(t,P){const ia=this.Rb.correlationId;if(ab.a.Wa(ia))O.a.J(512496585,829,50,"DesignerActor::SendTraceRequest - skipped for empty correlation. ResetReason:{0}",P);else if(this.Rb.Hzb(ia))O.a.J(512496584,829,50,"DesignerActor::SendTraceRequest - skipped for closed correlation. CorrelationId:{0}, ResetReason:{1}",ia,P);else{var Aa={};
Aa.CachedTrigger=this.Rb.mSd;Aa.SuggestionSlideId=this.Rb.KZ.sid.toString();Aa.SuggestionSlideCreationId=this.Rb.KZ.cid.toString();Aa.AppliedSuggestion=this.Rb.zT;Aa.DisplaySuggestionsTimeoutInMs=this.la.TYd;Aa.SuggestionsTimeout=this.Rb.KUa;Aa.ClientAbort=this.Rb.vyb||this.$y.Awk();Aa.DesignerPaneClosed=t;Aa.ResetReason=P;Aa.HoverPreviewDesignerTriggered=this.Rb.Rgg;Aa.DesignerFixPaneOpenHint=this.la.ALf;Aa.DesignerSendTraceRequestOnSessionEnded=this.la.UYd;Aa.UseWin32DesignerIconEnabled=this.la.WYd;
Aa.IsSimplifiedRibbon=this.c$b();this.la.yLf&&(Aa.DesignerDesignTabTriggerEnabled=!0);this.Op.Fsa()&&(this.la.ZQa?(Aa[Ye.a.AHh]=this.dr.O9d(),Aa[Ye.a.BHh]=!0,this.Rb.qYe&&(Aa.StartUpsellFreeTrial=!0)):Aa[Ye.a.YFf]=!0);t=!!P&&0<=P.indexOf(Le.a.moreIdeas);this.la.jja&&(Aa.TermCorrelationId=tm.x9d(),t||(Aa.TermAction=this.zkj()));var Ka=fe.b(v.AFrameworkApplication.fa.appSettings.SessionStartInfoJson.toString()),pb={};pb.ClientOS=Ka.Os;pb.Browser=Ka.Browser||"";pb.BrowserVersion=Ka.BrowserVersion||"";
pb.BrowserMajorVersion=Ka.BrowserMajorVersion||"";pb.BrowserMinorVersion=Ka.BrowserMinorVersion||"";this.Rb.vrc&&this.Rb.ega&&this.Rb.ega>this.Rb.vrc&&(pb.SuggestionsE2ETimeMs=+this.Rb.ega-+this.Rb.vrc);this.la.designerIncrementalRenderEnabled&&(this.dr.mqd(),this.vYe(),Aa[Ye.a.Abg]=!0,pb.VisibleSuggestionsCount=this.Rb.GZb,0<this.Rb.XVc.count&&(pb.IncrementalRenderTimeoutIndexes=this.Rb.XVc.toArray().join(",")),0<this.Rb.Wea.count&&(pb.MissingDesignerCardIndexes=this.Rb.Wea.toArray().join(",")),
0<this.Rb.ZPa.count&&(pb.CardIndexes=this.Rb.ZPa.toArray().join(",")),0<this.Rb.isa.count&&(pb.DesignerCardIndexes=this.Rb.isa.toArray().join(",")),this.Rb.bQ&&(this.Rb.iic&&this.Rb.iic>this.Rb.bQ&&(pb.MissingDesignerCardsReceivedTime=+this.Rb.iic-+this.Rb.bQ),this.Rb.bYb&&this.Rb.bYb>this.Rb.bQ&&(pb.AllIncRenderReceivedTime=+this.Rb.bYb-+this.Rb.bQ),this.Rb.XOb&&this.Rb.XOb>this.Rb.bQ&&(pb.VisibleIncRenderReceivedTime=+this.Rb.XOb-+this.Rb.bQ)));this.h5h(pb);try{if(this.ow.instance){const Nb=this.ow.instance.WWk();
ab.a.Wa(Nb)||(Aa.AgendaMetrics=Nb)}}catch(Nb){O.a.J(512496583,813,10,"exception while populating AgendaMetrics",Nb)}Aa.BrowserData=pb;this.Rb.bQ&&this.Rb.ega&&this.Rb.ega>this.Rb.bQ&&(Aa.TimeToDisplaySuggestionsInMs=+this.Rb.ega-+this.Rb.bQ);this.Rb.S_e&&this.Rb.Esc&&(Aa.TimeSuggestionsRendered=this.Rb.S_e.toUTCString());this.Rb.Esc&&(Aa.TimeDesignerPaneClosed=this.Rb.Esc.toUTCString());this.Rb.yYb&&0<this.Rb.yYb.count&&(Aa.AppliedSuggestionHis=this.Rb.yYb.toArray().join(" "));this.vi.Zna(ia,mk.c(Aa),
P===Og.a.Umd);this.Hyl(ia,P);this.Rb.jqf(ia,this.la.jja&&t);O.a.J(512496582,829,50,"DesignerActor::ReportSuggestionSessionInfo - Send session info and add correlationId to closed list. resetReason: {0}; CorrelationId:{1}",P,ia)}}c$b(){return v.AFrameworkApplication.Aa&&v.AFrameworkApplication.Aa.hb.Np?!0:!1}h5h(t){t.IdeasMivShown=this.Rb.jbd;t.IdeasMivDrillIn=this.Rb.SBe;t.IdeasEditorShown=this.Rb.nNc;t.IdeasEditorKept=this.Rb.mNc;t.IdeasEditorDrillIn=this.Rb.DOf;t.AnyCardShown=this.Rb.nNc||this.Rb.jbd||
0<this.Rb.ZPa.count;t.AnyCardKept=this.Rb.mNc||this.Rb.zT}Hyl(t,P){this.$y.HIa(t,P===Og.a.NMb||P===Og.a.Cqd||P===Og.a.noSuggestion||P===Og.a.KMf?ok.a.GIa:ok.a.pending)}Zrk(t,P){P.Cyh.addRange(this.Rb.isa);this.gCf(P.Cyh,P.HRf,P.slideId,P.trigger,P.correlationId);P.u8a&&(this.nVa||this.Rb.Wea.count||this.Dkl(P.trigger,P.HRf))}wqk(t,P){this.dda(Le.a.moreIdeas,null,P.o0c)}R$(t,P){!P.G$||"PptRibbon.Design"!==P.G$&&"Design"!==P.G$||2!==P.vv&&3!==P.vv&&4!==P.vv||this.$y.Op.Uo.isVisible||32!==this.ia.processAction(hb.a.ppd,
1)||this.dda(Le.a.QYd)}Dkl(t,P){this.vYe();const ia=this.ua.Ba.Cb,Aa=this.Rb.correlationId;this.nVa=new D.a(2,1,this.la.retryMissingDesignerCardsCountdownInMs,()=>{this.Rb.Hzb(Aa)||this.gCf(this.Rb.isa,P,ia,t,Aa,P)},void 0,"CheckAndFetchMissingDesignerCardsTask");this.zb.Eb(this.nVa)}gCf(t,P,ia,Aa,Ka,pb=-1){if(this.Rb.isa.count===P)this.vYe();else if(t&&t.count&&!(0<this.Rb.Wea.count)){if(-1===pb)for(let Nb of t)Nb>pb&&(pb=Nb);this.gqi(t,P,pb)&&this.Ftl(ia,Aa,Ka)}}gqi(t,P,ia){for(let Aa=0;Aa<P&&(t.contains(Aa)||
this.Rb.Wea.contains(Aa)||this.Rb.Wea.add(Aa),Aa!==ia||this.Rb.Wea.count);Aa++);return 0<this.Rb.Wea.count}Ftl(t,P,ia){const Aa={};Aa.MissingDesignerCardIndexes=this.Rb.Wea.toArray().join(",");this.nVa=new D.a(0,1,0,()=>{this.vi.Fja(t.cid,t.sid,ia,tm.x9d(),P,null,mk.c(Aa),()=>{O.a.J(512496581,829,50,"DesignerActor::TryFetchMissingDesignerCardsAsync - request successfully sent for fetch missing Designer indexes {0} for correlationId: {1}",Aa.MissingDesignerCardIndexes,ia)},Ka=>{O.a.J(512496580,829,
15,"DesignerViewHelper:FetchMissingDesignerCardsAsync - request failed for fetch missing Designer indexes {0} with response: {1}. returning true to prevent ACE",Aa.MissingDesignerCardIndexes,Ka.HttpStatusCode);return!0})},void 0,"FetchMissingDesignerCardsTask");this.zb.Eb(this.nVa)}vYe(){this.nVa&&(this.zb.Rg(this.nVa),this.nVa=null)}M0(t,P){(t=this.ua.Ba)&&P.slideId.equals(t.Cb)&&(this.$y.Spd(P.pwh,P.Zah),this.$y.Op.Uo.isVisible&&!this.$y.isEnabled()&&(O.a.J(512496579,829,50,"DesignerActor::OnSlidePresenceChanged - More than two users in same slide and close opened designer pane. In the slide user count:{0}, presentation user count:{1}, CorrelationId:{2}",
P.pwh,P.Zah,this.Rb.correlationId),this.Oo.yp(!1,Og.a.Fti)),this.Oo.isVisible&&(this.$y.isEnabled()||this.$y.HIa(this.Rb.correlationId,ok.a.GIa)))}mKi(t,P){P.Uma?(t=Object.assign(new Fn.a,{slideId:P.Uma.Cb}),this.ia.La(hb.a.AZa,2,t),this.$y.Spd(t.Rqc,t.Yah),this.Oo.isVisible&&(O.a.J(512496577,829,50,"DesignerActor::DesignerTargetSlideChangedHandler - Slide changed when Designer pane is opened. CorrelationId:{0}",this.Rb.correlationId),this.$y.isEnabled()&&!P.Uma.ON?this.dda(Le.a.CXe):P.Uma.ON&&this.la.designerNewSlideEnabled||
(this.Oo.yp(!1,Og.a.slideNavigation),this.$y.HIa(this.Rb.correlationId,ok.a.GIa)))):O.a.J(512496578,829,50,"DesignerActor::DesignerTargetSlideChangedHandler - active slide was null. CorrelationId:{0}",this.Rb.correlationId)}K6b(t){this.la.designerRequestThrottlingEnabled&&(this.pma=ci.ready,this.$L&&(this.Oo.isVisible?(O.a.J(512496576,829,50,"DesignerActor::OnTaskComplete - sending pending request for triger {0}, sid: {1}",this.$L.trigger,this.$L.sid),t()):this.$L=null))}Bgb(t,P){this.K6b(P);O.a.J(512496547,
829,15,"DesignerActor::OnTaskFailure - request failed with response: {0}. returning true to prevent ACE",t.HttpStatusCode);return!0}kKi(){if(this.$y.Op.Uo.isVisible){const t=this.ob.We();t&&1<t.length&&(O.a.J(512496546,829,50,"DesignerActor::DesignerSlidesSelectionChangedHandler - More than one slides are selected, close the opened designer pane."),this.Oo.isVisible&&this.Oo.yp(!1,Og.a.zik))}}dfa(t,P){t=this.Rb.APa;const ia=this.la.designerBlockApplyUntilDraw?"UnblockContentWhenDraw":"SessionRehydrated";
t&&Object(R.a)(String,P.actionName)===ia&&(this.Rb.yYb.add(String.format("{0}:{1}:{2}",this.Rb.KZ,+t-+this.Rb.ega,+new Date-+t)),this.Rb.APa=null)}ygb(t,P){this.$y.Op.Uo.isVisible&&(O.a.J(512496545,829,50,"DesignerActor::OnSessionEnding. Correlation={0}, Reason={1}",this.Rb.correlationId,qn.a[P.fG]),1!==P.fG&&3!==P.fG||this.EKb(!0,Og.a.Umd))}Bo(){O.a.J(512496544,829,50,"DesignerActor::OnSessionRehydrated");const t={};t[Ye.a.DOc]=!0;this.dda(Le.a.refresh,t)}Qdd(t,P){P&&this.D$d(P.actionId,P.transaction.Py)}rgb(t,
P){if(P.Tyb&&this.$y.dlg(P.actionId)){t={};if(P.revisionId){const ia=Rh.a.sta(bi.a.zY,Rh.a.D9a(P.revisionId.toString()).toString());ia&&1===ia.length&&(t[Ye.a.CD]=ia[0].CD)}this.D$d(P.actionId,t)}}l8f(t,P,ia,Aa,Ka){switch(t){case hb.a.ode:return this.Rb.Ffk(Ka),32;case hb.a.FWc:return this.Rb.ISk(Ka),32;default:return 2}}cfk(t,P,ia){if(t!==Le.a.insertPicture&&t!==Le.a.mxa&&t!==Le.a.rWc)return null;const Aa=ia?ia[Ye.a.W6b]:!1,Ka=ia?ia[Ye.a.$Uc]:!1,pb=ia?ia[Ye.a.X6b]:!1,Nb=ia?ia[Ye.a.ZUc]:!1;let kc=
null;switch(P){case hb.a.fJa:case hb.a.igd:kc=Aa?Ye.a.Wyk:Ka?Ye.a.Vyk:pb?Ye.a.Xyk:Nb?Ye.a.Uyk:null;break;case hb.a.kgd:kc=Aa?Ye.a.$yk:Ka?Ye.a.Zyk:pb?Ye.a.azk:Nb?Ye.a.Yyk:null;break;case hb.a.XOc:kc=Ye.a.aWf;break;case hb.a.insertOnlinePicture:case hb.a.Ota:kc=Ye.a.online;break;case hb.a.Icg:kc=Ye.a.icon}kc||O.a.J(512496543,829,50,"DesignerActor::MapActionIdToElementSource - Unexpected NULL ElementSource. Trigger: {0}, ActionId: {1}, CorrelationId: {2}",t,P,this.Rb.correlationId);delete ia[Ye.a.W6b];
delete ia[Ye.a.$Uc];delete ia[Ye.a.X6b];delete ia[Ye.a.ZUc];return kc}dfk(t,P){switch(t){case hb.a.XOc:case hb.a.insertOnlinePicture:case hb.a.Ota:case hb.a.Hkc:case hb.a.Icg:case hb.a.Jqf:return Le.a.insertPicture;case hb.a.kgd:case hb.a.fJa:case hb.a.igd:case hb.a.$gd:return P&&P[Ye.a.W6b]||P&&P[Ye.a.$Uc]&&this.la.ssl?Le.a.insertPicture:P&&P[Ye.a.X6b]?Le.a.mxa:P&&P[Ye.a.ZUc]&&this.la.lCh?Le.a.rWc:this.la.jza?Le.a.iJa:"";case hb.a.$v:case hb.a.YBa:case hb.a.mrb:return Le.a.mrb;case hb.a.Jia:return Le.a.xXe;
case hb.a.Apc:case hb.a.Bpc:case hb.a.bod:case hb.a.cod:case hb.a.Dpc:return P&&Ye.a.ixb in P&&P[Ye.a.ixb]?Le.a.jTd:Le.a.refresh;case hb.a.uDf:case hb.a.G6a:return P&&Ye.a.ixb in P&&P[Ye.a.ixb]?Le.a.uLf:Le.a.refresh;case hb.a.BIa:case hb.a.vib:case hb.a.apc:case Zf.a.LTa:case hb.a.bringForward:case hb.a.bringToFront:case hb.a.sendToBack:case hb.a.sendBackward:return Le.a.Bib;case Zf.a.yQd:case Zf.a.BQd:case Zf.a.NYb:case Zf.a.AQd:case Zf.a.CQd:case Zf.a.DQd:case Zf.a.GPa:case Zf.a.EQd:case Zf.a.FQd:case Zf.a.GQd:case Zf.a.HQd:case Zf.a.JQd:case Zf.a.LQd:case Zf.a.backspace:case Zf.a.QBa:case Zf.a.TK:case Zf.a.WQa:case Zf.a.enter:case Zf.a.rB:case Zf.a.typing:return Le.a.typing;
case hb.a.mxa:return Le.a.mxa;case hb.a.chd:return this.la.ka("DesignerUseRefreshTriggerForInsertTable")?Le.a.refresh:Le.a.insertTable;case hb.a.m5:case hb.a.wcd:case hb.a.QFb:case hb.a.gQ:return Le.a.Xma;case hb.a.yPa:return Le.a.FPd;case hb.a.YBf:return Le.a.dTd;case hb.a.Dsb:return Le.a.Dsb;default:return Le.a.refresh}}Gsl(){const t={};t[Ye.a.undoRedo]=!0;this.dda(Le.a.refresh,t);return 32}D$d(t,P){if(!this.NGj(t)){var ia=pb=>{const Nb={};Nb[Ye.a.timestamp]=pb.timestamp;Nb[Ye.a.correlationId]=
pb.correlationId;Nb[Ye.a.trigger]=pb.trigger;Nb[Ye.a.sid]=pb.sid;Nb[Ye.a.cid]=pb.cid;Nb[Ye.a.AQ]=pb.AQ;pb=this.Jb.zd(4);try{pb.nc(this.ua.presentation),pb.jd=hb.a.BLf,this.ua.presentation.Vtb=mk.c(Nb)}finally{pb&&pb.dispose()}},Aa=this.dfk(t,P),Ka=this.cfk(Aa,t,P);ab.a.Wa(Ka)||(P||(P={}),P[Ye.a.$Ca]=Ka);this.$y.dlg(t)&&this.Oo.isVisible?(this.nfb&&this.zb.Rg(this.nfb),this.$y.HIa(this.Rb.correlationId,ok.a.pending),this.Knd(Le.a.typing),this.nfb=new D.a(2,1,this.la.designerTypeRefreshThrottleTimeoutMs,
()=>{this.Oo.isVisible&&O.a.J(512496542,829,50,"Potential candidate for typing refresh request for designer pane");this.iel(this.ua.Ba)||this.iOc(ia,Aa,P)},void 0,"DesignerTypingRefreshTask"),this.zb.Eb(this.nfb)):this.iOc(ia,Aa,P)}}dda(t,P=null,ia=null){this.iOc(Aa=>{if(this.la.designerRequestThrottlingEnabled){if(this.pma.ujg&&+new Date-+this.pma.vmg<this.la.designerRequestThrottleIntervalMs){this.$L=new Hn;this.$L.sid=Aa.sid;this.$L.cid=Aa.cid;this.$L.trigger=Aa.trigger;this.$L.yVc=Aa.AQ;O.a.J(512496541,
829,50,"prior request in progress, marking current request as next pending. next trigger: {0}; next sid: {1}",t,Aa.sid);return}this.pma=ci.inProgress;this.$L=null}const Ka=()=>{this.dda(this.$L.trigger,this.$L.yVc,ia)};this.vi.Fja(Aa.cid,Aa.sid,Aa.correlationId,tm.x9d(),Aa.trigger,ia,mk.c(Aa.AQ),pb=>{pb&&pb.Status===Ye.a.$jh?this.fld(()=>{this.dda(Aa.trigger,Aa.AQ,ia)}):this.tIa=0;this.tIa||this.K6b(Ka)},pb=>this.Bgb(pb,Ka))},t,P)}fld(t){this.tIa<this.la.designerMaxRetryOnWait?this.zb.Eb(new D.a(2,
1,1E3,()=>{O.a.J(512496540,829,50,"retry request due to waiting on pending edits. prior correlation: {0}",this.Rb.correlationId);this.pma=ci.ready;this.tIa++;t()},void 0,"RetryRequestOnWait")):O.a.J(512496539,829,50,"retries for request awaiting prior edits exceeded. skipping request. correlation: {0}",this.Rb.correlationId)}A9i(t,P=null){P=P||{};this.la.iMc&&t===Le.a.newDocument&&(P[Ye.a.rPi]="true");this.la.lKi&&(P[Ye.a.Cml]=this.oDg);this.Op.Fsa()&&(this.la.ZQa?(P[Ye.a.AHh]=this.dr.O9d(),P[Ye.a.BHh]=
!0):P[Ye.a.YFf]=!0);this.dr.YVc(t)&&(P[Ye.a.Abg]=!0);this.$y.iJj()&&(P[Ye.a.qUd]=this.$y.qUd());P.NewPaneEnabled=!0;var ia=!xb.a.Wa(this.Rb.yW);(P.RequestForEditorCardsForNewIdeasPane=ia)&&(P.NumEditorCritiques=this.vAi());ia={};ia.SupportsImageToTableSuggestedAction=32===this.ia.processAction(hb.a.wJe,1);P.PPTOEnabledSuggestedActions=mk.c(ia);this.la.jza&&t===Le.a.iJa&&(P[Ye.a.Ogb]=this.la.Ogb,P[Ye.a.qIe]=this.la.qIe,P[Ye.a.pIe]=this.la.pIe);return P}vAi(){let t=0;for(const P of this.Rb.yW)for(const ia of P.critiques)t+=
ia.suggestions.length;return t}NGj(t){if(void 0===t||null===t)return!0;switch(t){case hb.a.IBa:case hb.a.grb:case hb.a.rYa:case hb.a.GFb:case hb.a.HFb:case hb.a.sYa:case hb.a.JFb:case hb.a.KFb:case hb.a.IFb:case hb.a.Xfb:case hb.a.BLf:return!0;case hb.a.BIa:case hb.a.vib:case hb.a.apc:case Zf.a.LTa:case hb.a.bringForward:case hb.a.bringToFront:case hb.a.sendToBack:case hb.a.sendBackward:return!this.Rb.zT;default:return!1}}aFi(t,P=null){const ia=this.ua.Ba;return ia?Object.assign(new zk,{trigger:t,
sid:ia.sid,cid:ia.cid,AQ:this.A9i(t,P)}):null}xRj(t){return this.yRj(t)}yRj(t){if(!t||!t.sid||!this.Sfg(t.trigger)&&!this.Oo.isVisible)return!1;switch(t.trigger){case Le.a.Xma:case Le.a.Psc:case Le.a.KNb:case Le.a.insertPicture:case Le.a.mrb:case Le.a.QYd:case Le.a.JVd:case Le.a.mxa:case Le.a.CXe:case Le.a.xXe:case Le.a.insertTable:return!0;case Le.a.rWc:return this.la.lCh;case Le.a.typing:return this.la.FLf&&this.Oo.isVisible;case Le.a.Bib:return this.la.designerRetriggerEnabled&&this.Rb.zT;case Le.a.jTd:case Le.a.uLf:return this.la.designerDesignElementsRemovedEnabled;
case Le.a.iJa:return this.la.jza;case Le.a.FPd:case Le.a.dTd:case Le.a.Dsb:return this.la.triggerDesignerAfterApplyReplaceObject;case Le.a.refresh:return this.qRj(t.AQ);case Le.a.moreIdeas:return this.la.jja;case Le.a.newDocument:return this.la.iMc&&this.la.tT;case Le.a.QOd:return this.la.K0e;default:return O.a.J(512496538,829,15,"invalid trigger: {0}",t.trigger),!1}}qRj(t){return Ye.a.DOc in t&&t[Ye.a.DOc]||Ye.a.undoRedo in t&&t[Ye.a.undoRedo]||this.la.iKi&&this.$y.Op.Uo.isVisible?!0:!1}Sfg(t){switch(t){case Le.a.Psc:case Le.a.KNb:case Le.a.insertPicture:case Le.a.rWc:case Le.a.xXe:case Le.a.jTd:case Le.a.mrb:case Le.a.mxa:case Le.a.newDocument:case Le.a.FPd:case Le.a.QYd:case Le.a.JVd:return!0;
case Le.a.QOd:return this.la.K0e;case Le.a.iJa:return this.la.jza;default:return!1}}MGj(t){if(!(this.la.designerSendActionDuration&&Ye.a.CD in t.AQ&&t.AQ[Ye.a.CD]))return!1;switch(t.trigger){case Le.a.Psc:case Le.a.KNb:case Le.a.CXe:case Le.a.newDocument:return!1;case Le.a.refresh:return!(Ye.a.DOc in t.AQ)||!(Ye.a.undoRedo in t.AQ);default:return!0}}Knd(t){const P=t===Le.a.typing?4:t===Le.a.moreIdeas?7:1;(this.$y.Op.Uo.isVisible||this.Sfg(t))&&this.Op.U_a(P)}K0d(t,P,ia=null){this.nfb&&(this.zb.Rg(this.nfb),
this.nfb=null);const Aa=this.aFi(P,ia);this.xRj(Aa)?this.Rb.iTj(this.ua.Ba.sid)?(this.Knd(Aa.trigger),this.fld(()=>{this.iOc(t,P,ia)})):(O.a.J(512496537,829,50,"trigger: {0}; sid: {1}; correlationId: {2}",Aa.trigger,Aa.sid,Aa.correlationId),this.Rb.correlationId&&!this.Rb.Hzb(this.Rb.correlationId)&&this.EKb(this.$y.Op.Uo.isVisible,Aa.trigger),this.Rb.vrc=new Date,this.Rb.correlationId=Aa.correlationId,this.Rb.mSd=Aa.trigger,this.Rb.bQ=this.MGj(Aa)?Aa.AQ[Ye.a.CD]:new Date,t(Aa),this.Knd(Aa.trigger),
this.$y.HIa(Aa.correlationId,ok.a.pending)):(O.a.J(512496536,829,50,"Designer call not currently allowed for trigger {0}",P),this.Oo.yp(!1,Og.a.KMf))}iOc(t,P,ia=null){if(this.la.designerAuthEnabled&&this.XL){this.Knd(P);ia||(ia={});var Aa=new Date;this.XL.nV(this.la.pptDesignerImplicitAuthAppName,this.la.designerResourceUri).then(Ka=>{const pb=+new Date-+Aa;Ka.IsSuccess?(ia[Ye.a.jVi]=pb,ia[Ye.a.O3k]=Ka.Token):(ia[Ye.a.$Sf]=pb,O.a.J(512496535,829,15,"DesignerActor::ExecuteDesignerRequestProcessingWithAuth Failed to get AAD token with error: "+
Ka.ErrorCode+": "+Ka.ErrorMessage));this.K0d(t,P,ia)}).catch(Ka=>{O.a.J(512496534,829,10,"DesignerActor::ExecuteDesignerRequestProcessingWithAuth - Token retrival failed:{0}",Ka);ia[Ye.a.$Sf]=+new Date-+Aa;this.K0d(t,P,ia)})}else this.K0d(t,P,ia)}O1e(){if(this.la.iMc&&this.la.tT)if(this.qc){var t=this.ua.presentation;if(!t)throw Error.argumentNull("Presentation is null");var P=this.qc.xI();if(!P||0>=P.length)O.a.J(512496531,829,15,"Triggering NewDocument designer request failed, Presentation.MainMasters is invalid");
else{var ia="62f939b6-93af-4db8-9c6b-d6c7dfdc589f"===P[0].ThemeFamilyId.toLowerCase();ia&&1!==P.length?O.a.J(512496530,829,15,"Triggering NewDocument designer request failed, Presentation.MainMasters Length is invalid"):this.la.J0e||ia?!t.slides||0>=t.slides.length?O.a.J(512496528,829,15,"Triggering NewDocument designer request failed, Presentation.slideNodes invalid"):ia&&1!==t.slides.length?O.a.J(512496527,829,15,"Triggering NewDocument designer request failed, Presentation.slideNodes Length for blank theme invalid"):
(t=null,this.la.r3k&&this.la.nrd&&0<this.la.nrd.length&&(t={},t.TemplateId=this.la.nrd),O.a.J(512496526,829,50,"Triggering NewDocument designer request"),this.dda(Le.a.newDocument,t)):O.a.J(512496529,829,50,"Not Triggering NewDocument designer request, themeFamilyId is invalid")}}else O.a.J(512496532,829,15,"Triggering NewDocument designer request failed, PresentationReader invalid");else O.a.J(512496533,829,50,"Not Triggering NewDocument designer request, DesignerNewDocTriggerEnabled:{0}, IsCreateNew:{1}",
this.la.iMc,this.la.tT)}GFe(t,P){this.Rb.iyl(P.q2b)}iel(t){return!t||!this.Oo.isVisible}zkj(){const t=document.querySelector("."+ze.UPa);return t&&(this.dr.Evb(t,!1)||this.dr.Evb(t,!0))?"Kept":"NotKept"}I0f(t){const P=new ha.a;if(t&&t.children)for(let ia=0;ia<t.children.length;ia++){const Aa=t.children[ia].innerText;Aa&&0<Aa.length&&P.add(t.children[ia].innerText)}return P.toArray()}Sdj(t){if(!t)return null;var P=t.sa(oj.a.Pgb,null);if(P)return P.replace("\r","\n").replace("\n\n","\n").split("\n");
if(P=t.sa(oj.a.FU,null))if(P=this.OT.UYa(P))return this.I0f(P);if(P=t.sa(oj.a.rIe,null))if(t=this.OT.UYa(P))return this.I0f(t);return null}N$(){}M$(t){if(this.la.jza&&t.actionId===hb.a.$gd&&32===t.response){var P=this.ob.Xd();if(P&&1===P.length&&P[0].id&&(P=this.Sdj(Object(R.a)(10,t.rd)))&&!(0>=P.length)){var ia={};ia[Ye.a.bzk]=P;this.D$d(t.actionId,ia)}}}nKi(t){switch(t){case Ye.a.lJh:return this.la.pPi;default:return!1}}Wpj(){this.Oo.yp(!0,Og.a.none);this.dda(Le.a.JVd);this.Op.U_a(3)}Csl(t){switch(t){case Ye.a.lJh:this.Dsl()}}Dsl(){if(this.la.OBk)try{const t=
A.a.instance.Ja("Common.ISystemInitiatedFeedback");t&&(O.a.J(512496525,829,50,"Floodgate survey for word to presentation triggered"),t.execute(P=>{P.logActivity("ConvertWordToPresentationActivity","PowerPointDesignerWordToPptSurveyEnabled")}))}catch(t){O.a.J(512496524,829,10,"Exception thrown while triggering floodgate survey. Exception: {0}",t)}}opk(){this.la.K0e&&(this.Oo.isVisible||this.Ksg||(this.Oo.yp(!0,Og.a.none),this.dda(Le.a.QOd),this.Op.U_a(3),O.a.J(512496523,829,50,"Auto opening designer pane for high confidence agenda")),
this.Ksg=!0)}static x9d(){const t=document.querySelector("."+ze.UPa);return t&&t.getAttribute(ze.asb)?t.getAttribute(ze.asb).toString():null}}Object(k.a)(tm,"DesignerActor",null,[141]);var um=d(536),yo=d(695);class zo{constructor(t){this.bucketId=t;this.critiques=[]}}Object(k.a)(zo,"BucketedEditorData",null,[]);class Wm{constructor(t){this.mSd=this.correlationId=this.JVa=this.Oqg=null;this.vyb=this.KUa=this.zT=!1;this.Esc=this.S_e=null;this.Rgg=!1;this.$Pa=this.suggestions=this.XOb=this.bYb=this.bQ=
this.APa=this.iic=this.ega=this.vrc=null;this.rN=0;this.qYe=this.SBe=this.jbd=this.DOf=this.mNc=this.nNc=!1;this.cpe=[];this.aAe=[];this.Zbc=t;this.KZ=Q.a.empty;this.yYb=new ha.a;this.ZPa=new ha.a;this.isa=new ha.a;this.XVc=new ha.a;this.Wea=new ha.a;this.GZb=1}vfk(){this.x_a(0,0)}ufk(){this.x_a(1,0)}aCe(){this.x_a(2,4)}x_a(t,P){this.Zbc&&this.Zbc.execute(ia=>{const Aa=Object.assign(new yo.a,{cardId:um.a.nwh,actionType:t,actionEngagement:P});ia.Ncd(Aa)})}jqf(t,P){this.Hzb(t)||(Array.add(this.cpe,
t),O.a.J(22853508,829,50,"DesignerContext::AddCurrentSuggestionToClosedList - CorrelationId:{0}, ClosedSuggestionListLength:{1}",t,this.cpe.length));this.wQe(!P)}Hzb(t){return Array.contains(this.cpe,t)}Ffk(t){Array.add(this.aAe,t)}ISk(t){Array.remove(this.aAe,t)}iTj(t){return Array.contains(this.aAe,t)}get cVd(){return this.JVa}Lxi(){if(this.JVa)return!0;try{const t=A.a.instance.rb("PowerPointWebEditor.Proofing.IConsistencyCheckActor");if(t)return this.JVa=t,!0}catch(t){O.a.J(42001674,829,15,"error resolving consistencyCheckActor. ex: {0}",
t)}return!1}iyl(t){if(t){var P=[],ia=new pd.a;for(const Aa of t.critiques){t=Aa.bucketId;let Ka=ia.ga(t);Ka||(Ka=new zo(t),ia.$(t,Ka),P.push(Ka));Ka.critiques.push(Aa)}this.Oqg=P}}get yW(){return this.Oqg}wQe(t){this.correlationId="";this.KZ=Q.a.empty;this.mSd="";this.vyb=this.KUa=this.zT=!1;this.Esc=null;this.Rgg=!1;this.APa=this.iic=this.ega=this.vrc=null;this.yYb.clear();this.XOb=this.bYb=this.bQ=null;this.GZb=1;this.ZPa.clear();this.isa.clear();this.XVc.clear();this.Wea.clear();this.rN=0;this.qYe=
this.nNc=this.mNc=this.jbd=this.SBe=!1;t&&(this.suggestions=this.$Pa=null)}}Object(k.a)(Wm,"DesignerContext",null,[761]);class pk{constructor(){this.CardData=null;this.DocumentUpsellStatus=0;this.HasPaginationInfo=!1;this.SlideSuggestions=null}}Object(k.a)(pk,"DesignerSuggestions",null,[]);var ll;(function(t){t[t.init=0]="init";t[t.loading=1]="loading";t[t.noSuggestion=2]="noSuggestion";t[t.showSuggestion=3]="showSuggestion";t[t.refreshing=4]="refreshing";t[t.sameSlideCoauthNoSuggestion=5]="sameSlideCoauthNoSuggestion";
t[t.makeItVisualDrillIn=6]="makeItVisualDrillIn";t[t.loadingMoreIdeas=7]="loadingMoreIdeas";t[t.moreIdeas=8]="moreIdeas";t[t.noSuggestionRibbon=9]="noSuggestionRibbon"})(ll||(ll={}));Object(k.b)("DesignerViewState",ll);class Wl{constructor(){this.suggestions=[]}}Object(k.a)(Wl,"SlideSuggestionNotificationData",null,[]);var $g=d(257),vm=d(386);class Th{constructor(t,P,ia){this.Ynb=this.NB=!1;t&&(this.xVa=t,this.xVa.isFeatureEnabled("PowerPointDesigner",!1).then(Aa=>{(this.NB=Aa)?O.a.J(591942685,829,
50,"DesignerStateManager:: Designer is enabled"):(this.Ynb=this.xVa.isFreemiumUpsellEnabled(),this.isFreemiumUpsellEnabled?ia?O.a.J(591942691,829,50,"DesignerStateManager:: Usage based Upsell experience is enabled for deisgner"):O.a.J(591942689,829,50,"DesignerStateManager:: Content based Upsell experience is enabled for deisgner"):O.a.J(591942687,829,50,"DesignerStateManager:: Upsell experience is disbaled"));return null}),this.Qak=this.xVa.Vhb("PowerPointDesigner",Object(r.a)(this,this.Yub,"featureStateChangeCallback")),
this.F$j=P)}Fsa(){return!this.isEnabled&&this.isFreemiumUpsellEnabled}dispose(){this.xVa&&(this.xVa.rJb("PowerPointDesigner",this.Qak),this.xVa=null)}get isEnabled(){return this.NB}get isFreemiumUpsellEnabled(){return this.Ynb}launchUpsellExperience(t){this.xVa&&this.xVa.launchUpsellExperience(t)}Yub(t){t&&"PowerPointDesigner"===t.featureName&&(!this.isEnabled&&t.isEnabled&&this.F$j(),this.NB=t.isEnabled)}}Object(k.a)(Th,"DesignerStateManager",null,[]);class Xl{constructor(t,P,ia){this.Ack=t;this.mB=
P;this.bck=ia}toString(){return"SuggestionIndex:"+this.Ack+" SlideId:"+this.mB+" CreationId:"+this.bck}}Object(k.a)(Xl,"LoggableSourceContext",null,[]);var Ol=d(1136),Re=d(949),qk=d(535);class qj{constructor(t,P,ia,Aa,Ka,pb,Nb,kc,Rc,Yc,hd,se,Ae,we){this.xdc=!1;this.zBe=0;this.vo=this.jBb=null;this.va=new wg.a;this.hF=!!v.AFrameworkApplication.Aa&&!!v.AFrameworkApplication.Aa.hb&&v.AFrameworkApplication.Aa.hb.bX;this.JTh=!!v.AFrameworkApplication.Aa&&!!v.AFrameworkApplication.Aa.hb&&v.AFrameworkApplication.Aa.hb.bX&&
v.AFrameworkApplication.fa.ka("PptReactTabbedTaskPanesFocusV2IsEnabled");this.Qb=t;this.je=P;this.Yc=ia;this.Jr=Aa;this.ia=Ka;this.Rb=pb;this.jE=Nb;this.Oc=kc;this.hz=Rc;this.mc=Yc;this.Fa=hd;this.la=se;this.Bv=Ae;this.TF=ch.G7b;this.P$j=ResourceStrings.L_Designer;this.tH=we;this.qb=document.createElement("div");this.qb.className=Xb.a.gKi;this.qb.id=ch.G7b;this.qb.style.position=vb.a.Ioa;this.qb.setAttribute(pa.a.af,pa.a.LBa);this.qb.setAttribute(pa.a.D2,Xb.a.SYd);this.Db=!1;this.QVa=cb.a.Fe();this.QVa.className=
"DesignerPaneLayoutRoot";this.qb.appendChild(this.QVa);t=v.AFrameworkApplication.fa.Ha("PPTFabricIconDiamondCssUrl");P=document.createElement("link");P.setAttribute("rel","stylesheet");P.setAttribute("type","text/css");P.setAttribute("href",t);this.qb.appendChild(P);this.Qb.L5a(Object(r.a)(this,this.gY,"onSetOffline"))}dispose(){this.M2();this.qb.removeChild(this.QVa);this.Qb.CJb(Object(r.a)(this,this.gY,"onSetOffline"));O.a.J(22590850,829,50,"DesignerPane::Dispose")}initialize(){this.vo=qj.tCa(this.je);
Sys.UI.DomElement.addCssClass(this.vo,"DesignerPaneCloseButton");this.vo.setAttribute(pa.a.af,pa.a.ru);this.QVa.appendChild(this.vo);this.Yc.pb(oa.a.click,this.vo,Object(r.a)(this,this.gCa,"closePaneButtonClickHandler"));this.Jr.addHandler(this.vo,oa.a.Zf,Object(r.a)(this,this.Mta,"inputKeyPressHandler"));this.jBb=cb.a.Fe();this.jBb.id=Xb.a.SYd;this.jBb.className=Xb.a.SYd;this.jBb.innerText=this.P$j;this.QVa.appendChild(this.jBb);this.jE.H8(this.I_f(),fd.a.nj,this.qb,t=>{this.JTh&&t===this.Fa.Gc(fd.a.EM)&&
this.vo?this.rA(!0):this.zU(!0)},()=>{this.zU(!1)});this.Oc.z7(Object(r.a)(this,this.Aw,"onUnifiedAppStateChanged"));this.Oc.WB(Object(r.a)(this,this.Q$,"onPodSessionRehydrated"));this.hz.Fqb(Object(r.a)(this,this.Q$,"onPodSessionRehydrated"));O.a.J(22590852,829,50,"DesignerPane::Initialize")}I_f(){return fd.a.b_}M2(){this.Yc&&0<this.QVa.childNodes.length&&(this.Yc.yb(oa.a.click,this.vo,Object(r.a)(this,this.gCa,"closePaneButtonClickHandler")),this.Jr.removeHandler(this.vo,oa.a.Zf,Object(r.a)(this,
this.Mta,"inputKeyPressHandler")),this.QVa.removeChild(this.jBb),this.QVa.removeChild(this.vo));this.Oc.jib(Object(r.a)(this,this.Aw,"onUnifiedAppStateChanged"));this.Oc.Dfa(Object(r.a)(this,this.Q$,"onPodSessionRehydrated"));this.hz.hib(Object(r.a)(this,this.Q$,"onPodSessionRehydrated"));this.Fa.Be&&this.Fa.Be.name===fd.a.b_&&this.Fa.Bj(fd.a.b_,!1)}Aw(t,P){P.dab&&!this.mc.Fn&&this.isVisible&&(O.a.J(24760967,829,50,"DesignerPane::OnUnifiedAppStateChanged - Switching to read-only mode and Designer pane is opened. CorrelationId:{0}",
this.Rb.correlationId),this.yp(!1,Og.a.NMb))}gY(t){t&&this.isVisible&&this.yp(!1,Og.a.NMb)}Q$(){O.a.J(37861251,801,50,"Designer Pane is closed because session is rehydrated.");this.yp(!1,Og.a.Y3k)}layout(t,P){const ia=P?t.hD(this.width):t.iD(this.width);this.isVisible&&(P?(Sys.UI.DomElement.addCssClass(this.qb,Xb.a.ELf),ia.hD(Xb.a.RYd)):(Sys.UI.DomElement.addCssClass(this.qb,Xb.a.DLf),ia.iD(Xb.a.RYd)));cb.a.k1(this.qb,ia);return t}yp(t,P){if(this.Db!==t){this.Db=t;var ia=this.la.ALf||this.id!==ch.G7b?
Ye.a.Cwk:ch.izj;t?(P={},P[ia]=!0,this.Bv.Oqd(mk.c(P)),this.initialize(),this.qb.style.display=vb.a.Lya,this.Rb.vfk(),O.a.J(22590854,829,50,"DesignerPane::SetIsVisible - Set to visible")):(t={},t[ia]=!1,this.Bv.Oqd(mk.c(t)),this.M2(),this.qb.style.display=vb.a.Gf,this.Zhl(P)||(this.Rb.Esc=new Date,1===this.zBe&&(this.Rb.vyb=!0),this.ia.La(hb.a.Zna,2,new qk.a(!0,P))),this.Rb.ufk(),O.a.J(22590856,829,50,"DesignerPane::SetIsVisible - Set to not visible"));this.hF?(this.bFc(this.qb),ia=ResourceStrings.L_Designer,
this.tH.yM(this,this.Db,this.id===ch.G7b?ia:ResourceStrings.L_ShowHideDesignerPane,this.I_f())):this.Qb.Mq()}}bFc(t){v.AFrameworkApplication.isRtl?Sys.UI.DomElement.addCssClass(t,Xb.a.ELf):Sys.UI.DomElement.addCssClass(t,Xb.a.DLf)}Zhl(t){return t===Og.a.aEf||this.isVisible&&t===Og.a.NMb}zU(t){t?this.va.raiseEvent("OnDesignerPaneFocusOn"):this.va.raiseEvent("OnDesignerPaneFocusBlur")}psf(t){this.va.addHandler("OnDesignerPaneFocusOn",t)}Qhh(t){this.va.removeHandler("OnDesignerPaneFocusOn",t)}qsf(t){this.va.addHandler("OnDesignerPaneFocusBlur",
t)}Rhh(t){this.va.removeHandler("OnDesignerPaneFocusBlur",t)}Mta(t){!this.isVisible||t.keyCode!==wa.a.tq&&t.keyCode!==wa.a.mP||this.yp(!1,Og.a.typing)}gCa(){this.isVisible&&(O.a.J(22853525,829,50,"DesignerPane::ClosePaneButtonClickHandler - Designer pane close button clicked. CorrelationId:{0}",this.Rb.correlationId),this.yp(!1,Og.a.NMb));return!0}rA(t){(this.xdc=t)&&this.vo.focus()}get Paa(){return this.zBe}set Paa(t){this.zBe=t}pjb(t){this.setFocus("#"+this.id+" ."+Dd.PYg+":nth-child("+t+") > ."+
Dd.sFb)}J5k(){this.setFocus("#"+Dd.O7a)}I5k(){this.setFocus("#"+Dd.qub)}qnd(t){this.setFocus("."+Dd.nRa+"["+ch.mRa+'="'+t+'"')}G5k(){this.setFocus("."+Dd.n2b)}H5k(){this.setFocus("."+Dd.r2b)}setFocus(t){(t=document.querySelector(t))&&Wb.FocusManager.Sr(t)}get isVisible(){return this.Db}get bUa(){return this.xdc}get xa(){return this.qb}get order(){return 7}get id(){return this.TF}get width(){let t=0;this.isVisible&&(t=Xb.a.hKi,t+=Xb.a.RYd+Ab.a.nKa);return t}static tCa(t){return qj.sCa(t,"per","cui-img-16by16",
"cui-ctl-iconContainer","ClosePaneGlyph_16x16x32",CommonUIStrings.l_DialogClose,null)}static sCa(t,P,ia,Aa,Ka,pb,Nb){const kc=cb.a.eC();kc.alt=pb;kc.className=Da.getImageClassWithCluster(P,Ka);kc.src=t.pk(P+".png");kc.setAttribute("Unselectable","on");t=cb.a.Nn();t.className=ia+" cui-img-cont-float";t.appendChild(kc);ia=cb.a.Nn();ia.className=Aa;ia.setAttribute("Unselectable","on");ia.appendChild(t);Aa=cb.a.nca();Aa.className="cui-ctl DesignerPaneButton";Aa.title=pb;Aa.setAttribute(pa.a.af,pa.a.ru);
Aa.tabIndex=0;Aa.appendChild(ia);Nb&&(pb=cb.a.Nn(),pb.className="cui-ctl-mediumlabel",pb.setAttribute("Unselectable","on"),pb.innerText=Nb,Aa.appendChild(pb));return Aa}}Object(k.a)(qj,"DesignerPane",null,[757,461,106]);class ml{constructor(t,P,ia,Aa,Ka,pb){this.rad=this.rbc=this.gDb=this.uo=null;this.Que=this.$8b=!1;this.kAe=null;this.la=P;this.ia=t;this.G$j=pb;this.Yc=Aa;this.Jr=Ka;this.Jug=eb.KeyInputManager.Na(wa.a.Blb,0);this.ia.ya(hb.a.zHh,u.a.frame,Object(r.a)(this,this.oti,"closeCallout"));
this.NT=cb.a.Fe();this.NT.className="GoPremiumCalloutContainer";this.Vbb=qj.tCa(ia);Sys.UI.DomElement.addCssClass(this.Vbb,"GoPremiumCalloutClose");this.Vbb.setAttribute(pa.a.af,pa.a.ru);this.NT.appendChild(this.Vbb);t=document.createElement("i");t.className=ze.SHc;t.setAttribute(pa.a.af,pa.a.fN);t.setAttribute("Unselectable","on");t.setAttribute(pa.a.JK,pa.a.XB);this.NT.appendChild(t);this.wwa=cb.a.Fe();this.wwa.className="GoPremiumTitle";this.NT.appendChild(this.wwa);this.PT=cb.a.Fe();this.PT.className=
"GoPremiumSubtitle";this.NT.appendChild(this.PT);this.Fla=cb.a.Fe();this.Fla.className="GoPremiumButton";t=cb.a.Nn();t.innerText=ResourceStrings.l_DesignerUpsellGoPremiumText;t.setAttribute("Unselectable","on");t.setAttribute(pa.a.JK,pa.a.XB);this.Fla.appendChild(t);this.Fla.tabIndex=0;this.Fla.setAttribute(pa.a.gs,t.innerText);this.Fla.setAttribute(pa.a.af,pa.a.ru);this.NT.appendChild(this.Fla);this.Pu()}show(t,P,ia,Aa,Ka,pb){this.qL&&this.dismiss();this.gDb=Aa;this.rbc=P;this.rad=Ka;this.kAe=pb;
this.gDb&&Sys.UI.DomElement.addCssClass(this.gDb,this.rad);ia?(this.wwa.innerText=ResourceStrings.l_DesignerInFreeTrialCalloutTitle,this.PT.innerText=ResourceStrings.l_DesignerInFreeTrialCalloutContent):(this.wwa.innerText=ResourceStrings.l_DesignerUpsellCalloutTitle,this.PT.innerText=ResourceStrings.l_DesignerUpsellCalloutContent);P.setAttribute(pa.a.qrb,pa.a.XB);this.la.jPf?this.uo=new Re.a(t,document.body,v.AFrameworkApplication.Aa.LR,null):(this.uo=Ol.a.HWd(t,document.body,document.body,2,Object(r.a)(this,
this.dismiss,"dismiss")),this.uo.T_e=120);this.uo.Qaa=310;this.NT.setAttribute(pa.a.gs,String.format("{0}. {1}",this.wwa.innerText,this.PT.innerText));this.NT.setAttribute(pa.a.af,pa.a.LBa);this.Jr&&this.Jr.addHandler(this.NT,oa.a.Zf,Object(r.a)(this,this.Mta,"inputKeyPressHandler"));this.uo.content=this.NT;this.Zqa();P=new Sys.UI.Bounds(0,0,la.a.$Tc(),la.a.ZTc());this.uo.OZ=this.v4d(P,t,240,ia);this.uo.yr=!1;this.uo.afd=()=>{this.NT.parentNode&&Sys.UI.DomElement.addCssClass(this.NT.parentNode,"GoPremiumCalloutContentContainer");
this.uo.AJ&&(Sys.UI.DomElement.addCssClass(this.uo.AJ,"GoPremiumCalloutOuter"),this.uo.AJ.removeAttribute(pa.a.af),this.la.jPf||(this.uo.AJ.style.zIndex=String(v.AFrameworkApplication.Aa.oqb)));this.uo.pUe();this.DR(this.Fla);this.$8b=!0};this.uo.show()}Zqa(){if(Wb.FocusManager.KM()){var t=Wb.FocusManager.instance(),P=t.Gc("callout/modal");P.parent=fd.a.nj;t.kNd("callout/modal",fd.a.nj,this.NT);t.tY("callout/modal",!1);P.bindAction(this.Jug,hb.a.zHh);P=new Yf.DOMFocusListing(()=>this.NT);P.Zhb=!0;
P.Eo(2);t=t.Eia(()=>this.NT,t.Gc("callout/modal"),P);t.$hb();t.kX=!0;t.rQa=!0}}dib(){if(Wb.FocusManager.KM()&&!v.AFrameworkApplication.Tg){const P=Wb.FocusManager.instance();var t=P.Gc("callout/modal");t&&t.Ap(this.Jug);P.x5("callout/modal");(t=P.rQ("callout/modal"))&&t.uj.VE(null);P.wJb("callout/modal")}}DR(t){Wb.FocusManager.KM()?Wb.FocusManager.instance().rQ("callout/modal").uj.F8a(t):t.focus()}get qL(){return!!this.uo&&this.uo.qL}bvj(){this.qL&&(this.$8b?this.Vbb.focus():this.Fla.focus(),this.$8b=
!this.$8b)}UMf(){this.dismiss();return!0}oti(){this.dismiss();return 32}dismiss(){if(!this.Que){this.Que=!0;try{this.dib(),this.rbc&&(this.rbc.setAttribute(pa.a.qrb,pa.a.ura),Wb.FocusManager.Sr(this.rbc),this.rbc=null),this.gDb&&(Sys.UI.DomElement.removeCssClass(this.gDb,this.rad),this.gDb=null),this.kAe=this.rad=null,this.$8b=!1,this.uo&&(this.uo.dismiss(),this.uo.dispose(),this.uo=null),this.Jr&&this.Jr.removeHandler(this.NT,oa.a.Zf,Object(r.a)(this,this.Mta,"inputKeyPressHandler"))}finally{this.Que=
!1}}}dispose(){this.dismiss();this.Voa();this.NT=this.Vbb=this.Fla=null}Mta(t){if(t.keyCode===wa.a.tq||t.keyCode===wa.a.mP){t.preventDefault();t=document.activeElement;try{t?t.click():O.a.J(590967751,829,15,"PremiumContentCallout::InputKeyPressHandler active element is null.")}catch(P){O.a.J(590967749,829,15,"PremiumContentCallout::InputKeyPressHandler Exception: {0}",P)}}}p3g(){this.G$j(this.kAe);return!0}Pu(){this.Yc?(this.Yc.pb(oa.a.click,this.Vbb,Object(r.a)(this,this.UMf,"dismissAndReturn")),
this.Yc.pb(oa.a.click,this.Fla,Object(r.a)(this,this.p3g,"onGoPremiumClicked"))):O.a.J(594031904,829,50,"PremiumContentCallout::RegisterEvents ClickInputManager or KeyInputManager is null. Couldn't register events on the goPremiumButton")}Voa(){this.Yc&&(this.Yc.yb(oa.a.click,this.Vbb,Object(r.a)(this,this.UMf,"dismissAndReturn")),this.Yc.yb(oa.a.click,this.Fla,Object(r.a)(this,this.p3g,"onGoPremiumClicked")))}v4d(t,P,ia,Aa){if(Aa)return 0;Aa=6;P.y-t.y<ia&&(Aa=3);return Aa}}Object(k.a)(ml,"PremiumContentCallout",
null,[]);class vi{constructor(t,P,ia,Aa,Ka,pb,Nb,kc){this.Wtb=t;this.VSi=P;this.oOc=ia;this.Jh=Aa;this.dga=Ka;this.u8a=pb;this.kXe=Nb;this.Xtd=kc}}Object(k.a)(vi,"RenderSuggestionsArgs",null,[996]);class zi extends Sys.EventArgs{constructor(t){super();this.card=t}}Object(k.a)(zi,"ClickSuggestedActionEventArgs",Sys.EventArgs,[]);class pp extends Sys.EventArgs{constructor(t){super();this.o0c=t}}Object(k.a)(pp,"DesignerClickMoreIdesEventArgs",Sys.EventArgs,[]);class Xh extends Sys.EventArgs{constructor(t,
P){super();this.o2k=t;this.zml=P}}Object(k.a)(Xh,"DesignerClickSuggestionEventArgs",Sys.EventArgs,[]);class Yl extends $g.a{constructor(t,P,ia,Aa,Ka,pb,Nb,kc,Rc,Yc,hd,se,Ae,we){super(new vm.a,t,pb);this.kcb=this.lcb=this.IL=this.Y_=this.Ybc=this.vX=null;this.axg=this.fxg=0;this.Kla=!1;this.IUg=this.hHa=this.GDb=null;this.Oo=ia;this.dr=Aa;this.Rb=Ka;this.Fa=Nb;this.Yc=kc;this.je=P;this.rp=Rc;this.Jr=Yc;this.ia=hd;this.ve=se;this.la=Ae;this.PHh=this.la.useWideSuggestionThumbs;this.eR=new Fc.a(()=>new ml(this.ia,
this.la,P,kc,Yc,Object(r.a)(this,this.V6f,"goPremiumExperience")));this.ptg=new Th(we,Object(r.a)(this,this.qlk,"onAccountUpgrade"),Ae.ZQa);this.s4=new ik;this.J7j=Object.assign(new Hm(hd,this.s4,this.la),{Ty:hb.a.O$a})}dispose(){this.Kla&&this.WCf();this.GDb&&(this.GDb.dispose(),this.GDb=null);this.eR.s$a&&this.eR.value.dispose();super.dispose();O.a.J(512496477,829,50,"DesignerView::Dispose")}T7b(){this.vX=cb.a.Fe();this.vX.className="DesignerViewContainer";this.container.appendChild(this.vX);this.Kla=
!0;O.a.J(512496476,829,50,"DesignerView::InitializeView")}WCf(){this.la.yNc&&this.dr.Dri();if(this.vX.children&&0<this.vX.children.length)for(const t=0;t<this.vX.children.length;)this.vX.removeChild(this.vX.children[t]);this.Oo.Paa=0;this.Oo.Qhh(Object(r.a)(this,this.onFocus,"onFocus"));this.Oo.Rhh(Object(r.a)(this,this.g3g,"onFocusBlur"));this.eR.s$a&&this.eR.value.dismiss();O.a.J(512496475,829,50,"DesignerView::CleanUpView")}U_a(t){O.a.J(512496474,829,50,"DesignerView.SetViewState. CorrelationId:{0}, ViewState:{1}",
this.Rb.correlationId,ll[t]);this.kN();4!==t&&7!==t&&8!==t&&(this.WCf(),this.vX.id=this.Rb.correlationId);this.Oo.Paa=t;switch(this.Oo.Paa){case 1:this.ABj();this.k$k();break;case 7:this.j$k();break;case 2:this.HBj();break;case 9:this.GBj();break;case 5:this.SBj();break;case 3:this.XBj();break;case 6:this.BBj();break;case 4:if(t=document.querySelectorAll(".DesignerSuggestionListDisabled"))for(let P=0;P<t.length;P++)t[P].style.visibility=Xa.a.visible,t[P].setAttribute(ze.jSd,ze.Pzf)}this.Oo.psf(Object(r.a)(this,
this.onFocus,"onFocus"));this.Oo.qsf(Object(r.a)(this,this.g3g,"onFocusBlur"))}Fsa(){return this.la.HLf&&this.ptg.Fsa()}V6f(t){this.la.HLf&&(O.a.J(512496473,829,50,"DesignerView::GoPremiumExperience SourceContext:{0}",t?t.toString():""),this.eR.s$a&&this.eR.value.dismiss(),this.ptg.launchUpsellExperience(this.la.ZQa?"designertrial":"designer"))}startFreeTrial(){this.eR.s$a&&this.eR.value.dismiss();this.dr.bsl();this.Rb.qYe=!0;this.Fw(0,!0);O.a.J(512496472,829,50,"DesignerView::StartFreeTrial Free Trial started")}qlk(){O.a.J(512496471,
829,50,"DesignerView::OnAccountUpgrade Account has been upgraded");this.eR.s$a&&this.eR.value.dismiss();this.dr.Jwl()}ABj(){this.Ybc=cb.a.Fe();this.Ybc.className="DesignerLoadingView";const t=cb.a.eC();t.className=v.AFrameworkApplication.isRtl?"DesignerLoadingViewSpinnerRTL":"DesignerLoadingViewSpinner";t.src=ig.a.RK(Xb.a.Bna);const P=cb.a.Fe();P.className=v.AFrameworkApplication.isRtl?"DesignerLoadingViewTextRTL":"DesignerLoadingViewText";P.innerText=ResourceStrings.L_DesignerLoading;this.Ybc.appendChild(t);
O.a.J(512496470,829,50,"DesignerView::spinner shows up");this.Ybc.appendChild(P);this.vX.appendChild(this.Ybc);O.a.J(512496469,829,50,"DesignerView::InitLoadingState")}IBj(){const t=cb.a.Fe();t.className="DesignerNoSuggestionNewButton";t.tabIndex=0;t.innerText=ResourceStrings.L_DesignerLearnMoreShort;t.setAttribute("Unselectable","on");t.setAttribute(pa.a.gs,t.innerText);t.setAttribute(pa.a.af,pa.a.ru);t.setAttribute("href",Xb.a.CLf);this.Yc.pb(oa.a.click,t,Object(r.a)(this,this.KDf,"clickSuggestionLinkHandler"));
this.Y_.appendChild(t)}FBj(){const t=cb.a.nca();t.className="DesignerNoSuggestionView-Link";t.setAttribute("href",Xb.a.CLf);t.setAttribute("target","_blank");t.innerText=ResourceStrings.L_DesignerLearnMore;t.tabIndex=0;t.setAttribute(pa.a.af,pa.a.kQd);this.Y_.appendChild(t);this.Yc.pb(oa.a.click,t,Object(r.a)(this,this.KDf,"clickSuggestionLinkHandler"))}HBj(){this.Oo.isVisible&&(this.xce(!1),this.lcb.innerText=ResourceStrings.L_DesignerNoSuggestionHeader,this.kcb.innerText=ResourceStrings.L_DesignerNoSuggestionContent,
O.a.J(512496468,829,50,"DesignerView::InitNoSuggestionState"))}GBj(){this.Oo.isVisible&&(this.xce(!0),this.lcb.innerText=ResourceStrings.L_DesignerNoIdeasHeader,this.kcb.innerText=ResourceStrings.L_DesignerNoIdeas,O.a.J(512496467,829,50,"DesignerView::InitNoSuggestionState"))}SBj(){this.Oo.isVisible&&(this.xce(!1),this.lcb.innerText=ResourceStrings.L_DesignerCoauthorHeader,this.kcb.innerText=ResourceStrings.L_DesignerCoauthorContent,O.a.J(512496466,829,50,"DesignerView::InitSameSlideCoauthNoSuggestionState"))}xce(t){this.Y_=
cb.a.Fe();this.Y_.className=v.AFrameworkApplication.isRtl?"DesignerNoSuggestionViewRTL":"DesignerNoSuggestionView";this.lcb=cb.a.Fe();this.kcb=cb.a.Fe();this.dr.Bih(this.vX);if(t){this.lcb.className="DesignerNoSuggestionNew-Header";this.kcb.className="DesignerNoSuggestionNew-Content";const P=cb.a.eC();P.src=this.je.pk("DesignerNoIdeas.svg");P.className="DesignerNoIdeasIllustration";this.Y_.appendChild(P)}else this.lcb.className="DesignerNoSuggestionView-Header",this.kcb.className="DesignerNoSuggestionView-Content";
this.Y_.appendChild(this.lcb);this.Y_.appendChild(this.kcb);t?this.IBj():this.FBj();this.vX.appendChild(this.Y_);this.Jr.addHandler(this.Y_,oa.a.Zf,Object(r.a)(this,this.Mta,"inputKeyPressHandler"))}XBj(){this.Oo.isVisible||this.Oo.yp(!0,Og.a.none);this.IL=cb.a.Fe();const t=this.PHh?"DesignerShowSuggestionViewWide":"DesignerShowSuggestionView",P=this.PHh?"DesignerShowSuggestionViewRTLWide":"DesignerShowSuggestionView";this.IL.className=v.AFrameworkApplication.isRtl?P:t;this.vX.appendChild(this.IL);
this.la.FLf||(this.Fa.Bj(fd.a.b_,!0),this.Fa.Ed());this.Yc.pb(oa.a.click,this.IL,Object(r.a)(this,this.Psi,"clickSuggestionHandler"));this.Jr.addHandler(this.IL,oa.a.Zf,Object(r.a)(this,this.oWc,"inputKeyApplyHandler"));this.rp.pb(oa.a.pointerOver,this.IL,Object(r.a)(this,this.WC,"onPointerOver"));this.rp.pb(oa.a.pointerOut,this.IL,Object(r.a)(this,this.pz,"onPointerOut"));O.a.J(512496465,829,50,"DesignerView::InitShowSuggestionState")}Ygj(){return this.P5b(this.IL.querySelector("#"+this.Uo.id+" .DesignerSuggestionResultSelected"))}E9i(){return this.P5b(this.IL.querySelector("#"+
this.Uo.id+" ["+ze.dsb+"]:hover"))}P5b(t){let P;return({suggestionIndex:P}=this.h5f(t)).returnValue?parseInt(P):-1}h5f(t){let P,ia,Aa;Aa=ia=P="";if(t){const Ka=t.getAttribute(ze.UBa),pb=t.getAttribute(ze.dsb);if(!Ka||!pb)return O.a.J(512496464,829,10,"DesignerView::GetSuggestionIndexAndSlideId - Failed to parse suggestion index and slideId, CorrelationId: {0}",this.Rb.correlationId),{returnValue:!1,suggestionIndex:P,slideId:ia,AXe:Aa};P=Ka.toString();ia=pb.toString();(t=t.getAttribute(ze.iSd))?Aa=
t.toString():O.a.J(512496463,829,15,"DesignerView::GetSuggestionIndexAndSlideId - Failed to parse suggestion slide creationId, CorrelationId: {0}",this.Rb.correlationId);return{returnValue:!0,suggestionIndex:P,slideId:ia,AXe:Aa}}return{returnValue:!1,suggestionIndex:P,slideId:ia,AXe:Aa}}Q5b(){return this.IL.querySelectorAll("#"+this.Uo.id+" ["+ze.UBa+"]").length}KDf(t){return this.Oo.isVisible&&t&&t.YB?this.g7f(t.YB.className):!1}Xja(){const t=this.la.useWideSuggestionThumbs?"DesignerShowSuggestionViewWide":
"DesignerShowSuggestionView",P=this.la.useWideSuggestionThumbs?"DesignerShowSuggestionViewRTLWide":"DesignerShowSuggestionView";return this.container.querySelector("."+(v.AFrameworkApplication.isRtl?P:t))}Osi(t){t=t.getAttribute(ze.UBa).toString();t=this.Rb.$Pa[parseInt(t)];if(!t||3!==t.Type&&4!==t.Type)return!1;this.ve.zIk(new zi(t));return!0}YOc(t,P){for(;t&&t.className!==P;)t=t.parentNode;return t}Psi(t){if(!this.Oo.isVisible||t.lA!==Sys.UI.MouseButton.leftButton||!this.dr.Ba||!t.Cc)return!1;var P=
t.Cc;try{if(P.className){if(P.className===Dd.sFb||P.className===Dd.tFb||P.className===Dd.DCe||P.className===Dd.Ubd)return this.Nsi(P);if(P.className.startsWith(Dd.KOf))return this.Msi(P)}else O.a.J(512496462,829,15,"DesignerView::ClickSuggestionHandler ClassName is null")}catch(hd){return O.a.J(512496461,829,15,"DesignerView::ClickSuggestionHandler unexpected exception: {1}",P.className,hd.message),!1}if(t=this.YOc(P,ze.Zzf))return this.Osi(t);if(this.Fsa()){if(P.className===ze.bsb)return this.startFreeTrial(),
!0;if(P.className===ze.tZb)return t=Ze.a.ii(P),this.eR.value.show(t,P,!0,P,"DesignerInFreeTrialViewGoPremiumTextSelected",null),!0;(t=this.YOc(P,ze.sZb))||(t=this.YOc(P,ze.MHc));if(t)return this.V6f(null),!0}if(this.la.jja&&(t=this.YOc(P,ze.dSd))){this.dr.pVc(this.Xja());if(!t.getAttribute(ze.asb))return!1;this.dr.vgl(this.Xja());t=new pp(t.getAttribute(ze.asb).toString());this.ve.LIk(t);return!0}if(Sys.UI.DomElement.containsCssClass(P,"ms-Icon--Diamond")){if(P=P.parentNode,!P)return!1}else if(!(Sys.UI.DomElement.containsCssClass(P,
ze.VHc)||Sys.UI.DomElement.containsCssClass(P,ze.wZb)||Sys.UI.DomElement.containsCssClass(P,ze.WHc)||(P=P.firstChild,P)))return!1;t=P.parentNode;var ia=document.querySelector("#"+this.Uo.id+" ."+ze.UPa);if(!({suggestionIndex:kc,slideId:Rc,AXe:Yc}=this.h5f(t)).returnValue)return!1;var Aa=parseInt(kc),Ka=parseInt(Rc);const pb=parseInt(Yc)||0;let Nb=this.Rb.KZ.sid===Ka;this.la.jja&&(Nb=this.dr.Evb(ia,!1)===t||this.dr.Evb(ia,!0)===t);if(Nb)return O.a.J(512496460,829,50,"DesignerView::ClickSuggestionHandler clicked the applied suggestion"),
this.ve.vdh(new Xh(Aa,this.Q5b())),!1;if(t&&t.getAttribute(ze.PHc)){P=null;ia=t.childNodes;for(Aa=0;Aa<ia.length;Aa++)if(Ka=ia[Aa],Sys.UI.DomElement.containsCssClass(Ka,ze.VHc)){P=Ka;break}ia=new Xl(kc,Rc,Yc);P=Ze.a.ii(P||t);this.eR.value.show(P,t,!1,null,null,ia);return!1}if(Sys.UI.DomElement.containsCssClass(P,ze.WHc))return!1;var kc=this.zgj(P,Ka,pb);var Rc=Object.assign(new kg,{SuggestionCid:pb,SuggestionSid:Ka,CorrelationId:ia.getAttribute("correlationId").toString(),ActiveSlideCid:this.dr.Ba.cid,
ActiveSlideSid:this.dr.Ba.sid});var Yc=P;Yc=.01>=Math.abs(Yc.width/Yc.height-1.33);this.dr.Evb(ia,Yc)?(this.dr.VCf(ia,Yc),kc&&kc.parentNode&&kc.parentNode.parentNode&&this.dr.VCf(kc.parentNode.parentNode,Yc),this.ia.La(hb.a.grb,2,Rc),O.a.J(512496459,829,50,"DesignerView::ClickSuggestionHandler Trigger ApplyDesignerSuggestionMultiple")):(this.ia.La(hb.a.IBa,2,Rc),O.a.J(512496458,829,50,"DesignerView::ClickSuggestionHandler Trigger ApplyDesignerSuggestion"));this.la.dKi&&t&&t.getAttribute(ze.VRd)&&
A.a.instance.Ja("Common.ISystemInitiatedFeedback").execute(hd=>{try{hd.logActivity("DesignerAnimationSuggestion",null)}catch(se){O.a.J(512496457,829,10,"Designer Animation Suggestion teaching UI failed with exception: {0}",se)}});this.dr.Moh(P.parentNode,Yc);kc&&this.dr.Moh(kc.parentNode,Yc);this.dr.onh(this.vX,Aa);this.ve.vdh(new Xh(Aa,this.Q5b()));return!0}zgj(t,P,ia){var Aa="["+ze.dsb+'="'+P+'"] > .'+ze.wZb;ia&&(Aa=String.format('[{0}="{1}"][{2}="{3}"] > .{4}',ze.dsb,P,ze.iSd,ia,ze.wZb));P=document.querySelectorAll(Aa);
if(!P)return null;for(ia=0;ia<P.length;ia++)if(Aa=P[ia],Aa!==t)return Aa;return null}Mta(t){this.Oo.isVisible&&(t.keyCode!==wa.a.tq&&t.keyCode!==wa.a.mP||this.g7f(t.target.className))}oWc(t){!this.Oo.isVisible||t.keyCode!==wa.a.tq&&t.keyCode!==wa.a.mP||(t.preventDefault(),(t=document.activeElement)&&t.click())}Fw(t,P){if(!(0>t)){var ia=this.IL.querySelector("["+ze.UBa+'="'+t+'"]');ia?P&&(Wb.FocusManager.Sr(ia),this.dr.onh(this.vX,t)):O.a.J(512496456,829,15,"DesignerView::SetSuggestionItemFocus, suggestionItem {0} is null",
t)}}m6f(){return this.Fsa()?this.IL.querySelector("."+ze.tZb)?2:this.IL.querySelector("."+ze.bsb)?1:this.IL.querySelector("."+ze.sZb)?3:0:0}kkg(){return!!this.IL.querySelector("."+ze.bsb+":focus")}Epc(t){const P=this.IL.querySelector("."+ze.bsb);P?t?Wb.FocusManager.Sr(P):P.blur():O.a.J(512496455,829,15,"DesignerView::SetStartFreeTrialFocus, StartFreeTrial Button is not present")}n9f(){this.klg()&&this.eR.value.bvj()}klg(){return this.eR.s$a&&this.eR.value.qL}XUj(t){return t?!!t&&(t.className===ze.bsb||
t.className===ze.MHc||t.className===ze.tZb||t.className===ze.sZb):!1}ooa(t,P){let ia=null;1===P?ia=this.IL.querySelector("."+ze.MHc):2===P?ia=this.IL.querySelector("."+ze.tZb):3===P&&(ia=this.IL.querySelector("."+ze.sZb));ia?t?Wb.FocusManager.Sr(ia):ia.blur():O.a.J(512496454,829,15,"DesignerView::SetGoPremiumFocus, Go Premium Button is not present for {0} for upsell View State",P)}O9k(t,P){(P=9===P?this.Y_.querySelector(".DesignerNoSuggestionNewButton"):this.Y_.querySelector(".DesignerNoSuggestionView-Link"))?
t?P.focus():P.blur():O.a.J(512496453,829,15,"DesignerView::SetSuggestionLinkFocus, Can't find linkelement")}xTj(t){return!(9===t?!this.Y_.querySelector(".DesignerNoSuggestionNewButton:focus"):!this.Y_.querySelector(".DesignerNoSuggestionView-Link:focus"))}g7f(t){try{const P=this.Y_.querySelector("."+t);if(!P)return!1;const ia=P.getAttribute("href").toString();if(!ia)return!1;Ze.a.openWindow(4,ia);return!0}catch(P){return O.a.J(512496452,829,10,"DesignerView:GoToSuggestionLink exception: {0}",P),!1}}g3g(){this.Oo.isVisible&&
this.eR.s$a&&this.eR.value.qL&&this.eR.value.dismiss()}onFocus(){if(this.Oo.isVisible)if(2===this.Oo.Paa)Wb.FocusManager.Sr(this.Y_.lastChild);else if(3===this.Oo.Paa){var t=this.m6f();if(1===t)this.Epc(!0);else if(3===t)this.ooa(!0,t);else{t=this.Ygj();var P=this.E9i();-1===t?this.Fw(-1===P?0:P,!0):this.Fw(t,!0)}}}WC(t){return this.Oo.isVisible&&t.Cc?this.JOf(t.clientPoint):!1}pz(t){return this.Oo.isVisible&&t.Cc?this.JOf(t.clientPoint):!1}Zqj(t){this.kN();this.U_a(2);O.a.J(512496451,829,50,"DesignerView::HandleGetSuggestionsTimeout, CorrelationId: {0}",
t);this.Oo.isVisible&&(this.Rb.KUa=!0,this.ia.La(hb.a.Zna,2,new qk.a(!1,Og.a.Cqd)))}k$k(){const t=this.Rb.correlationId;this.fxg=window.setTimeout(()=>{this.Zqj(t)},this.la.TYd)}Yqj(t){this.kN();this.dr.pVc(this.Xja());O.a.J(512496450,829,15,"DesignerView::HandleGetMoreIdeasTimeout, CorrelationId: {0}",t)}j$k(){const t=this.Rb.correlationId;this.axg=window.setTimeout(()=>{this.Yqj(t)},this.la.TYd)}kN(){window.clearTimeout(this.fxg);window.clearTimeout(this.axg)}get Uo(){return this.Oo}BBj(){this.IL.style.display=
Xa.a.none;this.Rb.SBe=!0;this.hHa=cb.a.Fe();this.hHa.className=Dd.Ihk;const t=this.dIf(Dd.FCe),P=document.createElement("iframe");P.className=P.id=Dd.RYg;const ia=this.dIf(Dd.ECe);this.hHa.appendChild(t);this.hHa.appendChild(P);this.hHa.appendChild(ia);this.vX.appendChild(this.hHa);const Aa=this.Fa.Gc(fd.a.JVc);Aa.parent=Na.AFrame.GD;this.Yc.eFc(fd.a.JVc,P);Aa.Wba(()=>{P.focus();const Ka=Object.assign(new Yf.DOMFocusListing(()=>this.hHa),{Zhb:!0});Ka.Eo(3);Ka.Eo(2);Ka.Eo(4);Ka.Eo(1);Ka.Eo(6);Ka.Eo(5);
Wb.FocusManager.instance().ERd(this.hHa,Aa,Ka);const pb=Wb.FocusManager.instance().rQ(fd.a.JVc);pb.$hb();pb.kX=!0;pb.rQa=!0;Aa.Ap(Wb.FocusManager.instance().Eqa);Aa.Ap(Wb.FocusManager.instance().Fqa);Ka.VE(P)});this.Fa.xf(fd.a.JVc);this.Jr.addHandler(this.hHa,oa.a.Zf,Object(r.a)(this,this.Sz,"keyDownHandler"))}dIf(t){const P=document.createElement("div");P.setAttribute("Id",t);P.setAttribute("tabindex",0);P.setAttribute("position","absolute");P.setAttribute("width","-1000px");P.setAttribute("top",
"-1000px");return P}Sz(t){t.keyCode===Sys.UI.Key.tab&&(t.target.id!==Dd.ECe||t.shiftKey?t.target.id===Dd.FCe&&t.shiftKey&&this.Zph(t,Dd.ECe):this.Zph(t,Dd.FCe))}Zph(t,P){t.preventDefault();t.stopPropagation();(t=document.getElementById(P))&&t.focus()}Nsi(t){switch(t.className){case Dd.Ubd:return this.Uo.pjb(1),!0;case Dd.sFb:t=t.querySelector("."+Dd.tFb).innerText;break;case Dd.tFb:t=t.innerText;break;case Dd.DCe:t=t.parentNode.querySelector("."+Dd.tFb).innerText;break;default:return!1}return this.HVk(t)}HVk(t){this.la.jja&&
(this.IUg=this.Xja().querySelector("."+ze.UPa).getAttribute("correlationId").toString());this.U_a(6);var P=ab.a.iN(this.la.pptEditingUserId).toString();P=String.format(this.la.insertPictureServiceEndpoint,v.AFrameworkApplication.lcid,Xk.a.ue(v.AFrameworkApplication.lcid).name,v.AFrameworkApplication.buildVersion,Ca.a.create().toString(),3,P,0);P=P.replace(RegExp("&amp;","g"),"&").replace(RegExp("&p=3"),"&p=6")+"&q="+t;t=document.getElementById(Dd.RYg);t.setAttribute("src",P);t.style.visibility=Xa.a.visible;
this.GDb=(new Oi).getInstance(t.contentWindow,P);this.GDb.Hxa(ed.a.Pqf,ia=>{if(ia=this.s4.U8g(ia)){const Aa=[];Array.add(Aa,ia);this.ia.processAction(hb.a.Dqc,2);this.Uo.yp(!1,Og.a.aEf);this.J7j.Nta(Aa)}});this.GDb.Hxa(ch.QK,()=>{this.U_a(3);const ia=new vi(this.Rb.suggestions,this.Rb.suggestions?this.Rb.suggestions.SlideSuggestions.length:0,this.Rb.$Pa.length,this.la.jja?this.IUg:this.Rb.correlationId,this.Xja(),!0,this.Fsa(),this.dr.YVc(Le.a.makeItVisual));this.dr.FPe(ia)});return!0}Msi(t){return Sys.UI.DomElement.containsCssClass(t,
Dd.tub)||Sys.UI.DomElement.containsCssClass(t,Dd.rub)?this.Dqj(t):Sys.UI.DomElement.containsCssClass(t,Dd.nRa)||Sys.UI.DomElement.containsCssClass(t,Dd.oNc)||Sys.UI.DomElement.containsCssClass(t,Dd.OOf)||Sys.UI.DomElement.containsCssClass(t,Dd.NOf)?this.Eqj(t):Sys.UI.DomElement.containsCssClass(t,Dd.n2b)?this.irj():Sys.UI.DomElement.containsCssClass(t,Dd.r2b)?this.qsj():!1}qsj(){this.ia.processAction(hb.a.xJe,2);this.Uo.yp(!1,Og.a.Ruk);return this.Rb.DOf=!0}JOf(t){const P=this.Rb.cVd;if(!P||xb.a.Wa(this.Rb.yW))return!1;
t=Ze.a.rSa(t);this.FKj(t)?P.wVc(this.oZf()):P.wVc([]);return!0}FKj(t){for(;t&&t.className!==Dd.x_d;)t=t.parentNode;return!!t&&t.className===Dd.x_d}irj(){const t=this.Rb.cVd;if(!t)return!1;t.ignoreCritiques(this.oZf(),4);this.Rb.yW.splice(this.Rb.rN,1);if(this.Rb.rN===this.Rb.yW.length){let P;(P=this.Rb).rN=P.rN-1}this.cOk();return!0}oZf(){const t=[];for(const P of this.Rb.yW[this.Rb.rN].critiques)t.push(P.critiqueId);return t}Dqj(t){if(Sys.UI.DomElement.containsCssClass(t,Dd.tub)){let P;(P=this.Rb).rN=
P.rN-1;this.Rb.rN||(Sys.UI.DomElement.removeCssClass(t,Dd.tub),Sys.UI.DomElement.addCssClass(t,Dd.p2b));t=document.getElementById(Dd.qub);Sys.UI.DomElement.removeCssClass(t,Dd.o2b);Sys.UI.DomElement.addCssClass(t,Dd.rub)}else{let P;(P=this.Rb).rN=P.rN+1;this.Rb.rN===this.Rb.yW.length-1&&(Sys.UI.DomElement.removeCssClass(t,Dd.rub),Sys.UI.DomElement.addCssClass(t,Dd.o2b));t=document.getElementById(Dd.O7a);Sys.UI.DomElement.removeCssClass(t,Dd.p2b);Sys.UI.DomElement.addCssClass(t,Dd.tub)}document.getElementById(Dd.w_d).innerText=
(this.Rb.rN+1).toString();this.MFh(this.Rb.rN);return!0}MFh(t){var P=this.Rb.yW[t].critiques[0].explanationLabel;document.getElementById(Dd.MOf).innerText=P;P=document.getElementById(Dd.POf);const ia=ze.IHf();P.parentNode.replaceChild(ia,P);this.dr.Q8f(ia,t)}Eqj(t){const P=this.Rb.cVd;if(xb.a.Wa(this.Rb.yW)||!P)return!1;t=t.getAttribute(ch.mRa);var ia=document.querySelector("."+Dd.oNc+"["+ch.mRa+'="'+t+'"]');ia&&(ia.innerText="\u2713",Sys.UI.DomElement.removeCssClass(ia,Dd.oNc),Sys.UI.DomElement.addCssClass(ia,
Dd.VOi));ia=new pd.a(0);for(const Aa of this.Rb.yW[this.Rb.rN].critiques)ia.add(Aa.critiqueId,t);P.eAh(ia);return this.Rb.mNc=!0}cOk(){var t=document.getElementById(Dd.BOf);let P=parseInt(t.innerText);P--;if(0>=P)this.Cgl(document.getElementById(Dd.COf));else{t.innerText=P.toString();this.MFh(this.Rb.rN);t=this.Rb.rN===this.Rb.yW.length-1;const ia=document.getElementById(Dd.qub);1<P&&!t?(Sys.UI.DomElement.addCssClass(ia,Dd.rub),Sys.UI.DomElement.removeCssClass(ia,Dd.o2b)):(Sys.UI.DomElement.addCssClass(ia,
Dd.o2b),Sys.UI.DomElement.removeCssClass(ia,Dd.rub));t&&(document.getElementById(Dd.w_d).innerText=P.toString());t=document.getElementById(Dd.O7a);1<P&&this.Rb.rN?(Sys.UI.DomElement.addCssClass(t,Dd.tub),Sys.UI.DomElement.removeCssClass(t,Dd.p2b)):(Sys.UI.DomElement.addCssClass(t,Dd.p2b),Sys.UI.DomElement.removeCssClass(t,Dd.tub))}}Cgl(t){const P=cb.a.Fe();P.className=Dd.POi;const ia=new od.a;ia.ih(40,40);ia.qya("0,0,2048,2048");ia.qr(Dd.WOi);var Aa=new km.a;Aa.i1("M 1024 102 q 127 0 245 33 q 118 33 221 93 q 102 60 186 144 q 84 84 144 187 q 60 102 93 220 q 33 118 33 245 q 0 127 -33 245 q -33 118 -93 221 q -60 102 -144 186 q -84 84 -186 144 q -103 60 -221 93 q -118 33 -245 33 q -127 0 -245 -33 q -118 -33 -220 -93 q -103 -60 -187 -144 q -84 -84 -144 -186 q -60 -103 -93 -221 q -33 -118 -33 -245 q 0 -127 33 -245 q 33 -118 93 -220 q 60 -103 144 -187 q 84 -84 187 -144 q 102 -60 220 -93 q 118 -33 245 -33 m 0 1792 q 120 0 232 -31 q 111 -31 208 -87 q 96 -57 176 -136 q 79 -80 136 -176 q 56 -97 87 -208 q 31 -112 31 -232 q 0 -120 -31 -231 q -31 -112 -87 -208 q -57 -97 -136 -176 q -80 -80 -176 -136 q -97 -57 -208 -88 q -112 -31 -232 -31 q -120 0 -231 31 q -112 31 -208 88 q -97 56 -176 136 q -80 79 -136 176 q -57 96 -88 208 q -31 111 -31 231 q 0 120 31 232 q 31 111 88 208 q 56 96 136 176 q 79 79 176 136 q 96 56 208 87 q 111 31 231 31 m -599 -783 l 72 -72 l 348 348 l 706 -706 l 72 72 l -778 779 z");
const Ka=new km.a;Ka.i1("M 1894 1024 q 0 120 -31 232 q -31 111 -87 208 q -57 96 -136 176 q -80 79 -176 136 q -97 56 -208 87 q -112 31 -232 31 q -120 0 -231 -31 q -112 -31 -208 -87 q -97 -57 -176 -136 q -80 -80 -136 -176 q -57 -97 -88 -208 q -31 -112 -31 -232 q 0 -120 31 -231 q 31 -112 88 -208 q 56 -97 136 -176 q 79 -80 176 -136 q 96 -57 208 -88 q 111 -31 231 -31 q 120 0 232 31 q 111 31 208 88 q 96 56 176 136 q 79 79 136 176 q 56 96 87 208 q 31 111 31 231 z");Ka.xa.setAttribute("class",Dd.ZOi);const pb=
new km.a;pb.i1("M 1024 128 q 124 0 239 32 q 114 32 214 91 q 99 58 181 140 q 81 81 140 181 q 58 99 90 214 q 32 114 32 238 q 0 124 -32 239 q -32 114 -90 214 q -59 99 -140 181 q -82 81 -181 140 q -100 58 -214 90 q -115 32 -239 32 q -124 0 -238 -32 q -115 -32 -214 -90 q -100 -59 -181 -140 q -82 -82 -140 -181 q -59 -100 -91 -214 q -32 -115 -32 -239 q 0 -124 32 -238 q 32 -115 91 -214 q 58 -100 140 -181 q 81 -82 181 -140 q 99 -59 214 -91 q 114 -32 238 -32 m 599 625 l -72 -72 l -706 706 l -348 -348 l -72 72 l 420 421 z");
pb.xa.setAttribute("class",Dd.NOi);const Nb=new km.a;Nb.i1("M 1024 102 q 127 0 245 33 q 118 33 221 93 q 102 60 186 144 q 84 84 144 187 q 60 102 93 220 q 33 118 33 245 q 0 127 -33 245 q -33 118 -93 221 q -60 102 -144 186 q -84 84 -186 144 q -103 60 -221 93 q -118 33 -245 33 q -127 0 -245 -33 q -118 -33 -220 -93 q -103 -60 -187 -144 q -84 -84 -144 -186 q -60 -103 -93 -221 q -33 -118 -33 -245 q 0 -127 33 -245 q 33 -118 93 -220 q 60 -103 144 -187 q 84 -84 187 -144 q 102 -60 220 -93 q 118 -33 245 -33 m 0 1792 q 120 0 232 -31 q 111 -31 208 -87 q 96 -57 176 -136 q 79 -80 136 -176 q 56 -97 87 -208 q 31 -112 31 -232 q 0 -120 -31 -231 q -31 -112 -87 -208 q -57 -97 -136 -176 q -80 -80 -176 -136 q -97 -57 -208 -88 q -112 -31 -232 -31 q -120 0 -231 31 q -112 31 -208 88 q -97 56 -176 136 q -80 79 -136 176 q -57 96 -88 208 q -31 111 -31 231 q 0 120 31 232 q 31 111 88 208 q 56 96 136 176 q 79 79 176 136 q 96 56 208 87 q 111 31 231 31 m 672 -1141 l -851 851 l -493 -493 l 145 -144 l 348 347 l 706 -706 m -706 924 l 778 -779 l -72 -72 l -706 706 l -348 -348 l -72 72 z");
Nb.xa.setAttribute("class",Dd.MOi);ia.appendChild(Aa);ia.appendChild(Ka);ia.appendChild(pb);ia.appendChild(Nb);Aa=cb.a.Nn();Aa.innerText=ResourceStrings.l_ConsistencyCardNoMore;Aa.className=Dd.QOi;P.appendChild(ia.xa);P.appendChild(Aa);t.parentNode.replaceChild(P,t)}}Yl.KOi=[Dd.O7a,Dd.qub,Dd.nRa,Dd.n2b,Dd.r2b];Object(k.a)(Yl,"DesignerView",$g.a,[756,565,167,106]);var Kp=d(186);class al extends Sys.EventArgs{constructor(t,P){super();this.slideId=t.slideId;this.Cyh=t.trc;this.HRf=t.Daa;this.u8a=P;this.trigger=
t.trigger;this.correlationId=t.correlationId}}Object(k.a)(al,"RenderSuggestionsEventArgs",Sys.EventArgs,[]);class bj{constructor(t,P,ia,Aa,Ka,pb,Nb,kc,Rc,Yc,hd,se){this.myg=new Im.a;this.Op=t;this.dr=P;this.Rb=ia;this.la=Aa;this.ia=Ka;this.ua=pb;this.Jb=Nb;this.Lc=kc;this.Fa=Rc;this.ybc=this.kpe=0;this.kWa=Yc;this.$3j=hd;this.twa=se;this.Pu()}Pu(){this.Lc.e9h(Object(r.a)(this,this.q6g,"onSuggestionsUpdated"));this.Lc.d9h(Object(r.a)(this,this.X1g,"onCoauthModifiedSameSlide"));this.$3j.execute(t=>
{t.y6h(Object(r.a)(this,this.ftk,"onShowMoreSuggestions"),()=>{this.WKb(this.Op,3)})});this.la.designerIncrementalRenderEnabled&&this.Lc.b$h(Object(r.a)(this,this.S6g,"onUserBeginUploadPicture"));this.Lc.SFc(Object(r.a)(this,this.sna,"onUndoRedo"))}dispose(){this.Lc.KTk(Object(r.a)(this,this.q6g,"onSuggestionsUpdated"));this.Lc.JTk(Object(r.a)(this,this.X1g,"onCoauthModifiedSameSlide"));this.la.designerIncrementalRenderEnabled&&this.Lc.sUk(Object(r.a)(this,this.S6g,"onUserBeginUploadPicture"));this.Lc.mkd(Object(r.a)(this,
this.sna,"onUndoRedo"))}k3k(t){this.ia.La(hb.a.Zna,2,new qk.a(!1,t))}WKb(t,P){t?t.U_a(P):O.a.J(512496522,829,50,"SetDesignerViewState - null view. CorrelationId:{0}, ViewState:{1}",this.Rb.correlationId,P)}Zuj(t){const P=this.OKi(t);if(P){var ia=P.Uo;O.a.J(512496521,829,50,"DesignerManager::HandleSuggestionItemNavigation - ActionId: {0} in ViewState: {1}",t,ll[ia.Paa]);switch(ia.Paa){case 3:this.Jik(t,P);break;case 2:case 9:this.Iik(t,P,ia.Paa)}}}OKi(t){switch(t){case hb.a.rYa:case hb.a.GFb:case hb.a.HFb:case hb.a.sYa:case hb.a.JFb:case hb.a.KFb:case hb.a.IFb:case hb.a.Xfb:t=
this.Op;break;default:return null}return t}Jik(t,P){if(P&&P.Uo){var ia=document.activeElement;if(ia){var Aa=ia.getAttribute(ze.UBa),Ka=P.XUj(ia),pb=Sys.UI.DomElement.containsCssClass(ia,"DesignerPaneCloseButton")||Sys.UI.DomElement.containsCssClass(ia,"IdeasText"),Nb=this.QYg(ia)||this.EOf(ia),kc=P.klg();if(Aa||pb||Nb||Ka||kc)if(Aa=Aa?parseInt(Aa.toString()):-1,Ka=P.Q5b()-1,!(1>Ka))switch(pb=P.Uo,Nb=P.m6f(),t){case hb.a.rYa:if(kc||1===Nb||3===Nb)break;pb.rA(!1);Aa<Ka&&(P.Fw(Aa,!1),P.Fw(Aa+1,!0));
break;case hb.a.GFb:if(kc||1===Nb||3===Nb)break;pb.rA(!1);Aa!==Ka&&(P.Fw(Aa,!1),P.Fw(Ka,!0));break;case hb.a.HFb:if(kc){P.n9f();break}this.isj(P,Aa,Ka,Nb);break;case hb.a.sYa:if(kc||1===Nb||3===Nb)break;pb.rA(!1);0<Aa&&(P.Fw(Aa,!1),P.Fw(Aa-1,!0));break;case hb.a.JFb:if(kc||1===Nb||3===Nb)break;pb.rA(!1);Aa&&(P.Fw(Aa,!1),P.Fw(0,!0));break;case hb.a.KFb:if(kc){P.n9f();break}this.jsj(P,Aa,Ka,Nb);break;case hb.a.IFb:case hb.a.Xfb:kc||1===Nb||3===Nb||(t=t===hb.a.Xfb,P=P.Uo,this.QYg(ia)?this.lsj(t,P):this.EOf(ia)&&
this.ksj(t,P))}}}}isj(t,P,ia,Aa){const Ka=t.Uo;if(-1===P){switch(Aa){case 1:Ka.bUa?(Ka.rA(!1),t.Epc(!0)):t.kkg()?(t.Epc(!1),t.ooa(!0,Aa)):(t.ooa(!1,Aa),Ka.rA(!0));return;case 2:Ka.bUa?(Ka.rA(!1),t.Fw(0,!0)):(t.ooa(!1,Aa),Ka.rA(!0));return;case 3:P=Ka.bUa;Ka.rA(!P);t.ooa(P,Aa);return}Ka.rA(!1);t.Fw(0,!0)}else P===ia?(t.Fw(P,!1),2===Aa?t.ooa(!0,Aa):Ka.rA(!0)):(t.Fw(P,!1),t.Fw(P+1,!0))}jsj(t,P,ia,Aa){const Ka=t.Uo;if(0<P)t.Fw(P,!1),t.Fw(P-1,!0);else if(-1===P){switch(Aa){case 1:Ka.bUa?(Ka.rA(!1),t.ooa(!0,
Aa)):t.kkg()?(t.Epc(!1),Ka.rA(!0)):(t.ooa(!1,Aa),t.Epc(!0));return;case 2:Ka.bUa?(Ka.rA(!1),t.ooa(!0,Aa)):(t.ooa(!1,Aa),t.Fw(ia,!0));return;case 3:P=Ka.bUa;Ka.rA(!P);t.ooa(P,Aa);return}Ka.bUa&&(Ka.rA(!1),t.Fw(ia,!0))}else t.Fw(0,!1),Ka.rA(!0)}Iik(t,P,ia){if(P){var Aa=P.Uo;if(t===hb.a.HFb||t===hb.a.KFb||t===hb.a.sYa||t===hb.a.rYa)t=P.xTj(ia),Aa.rA(t),P.O9k(!t,ia)}}QYg(t){return Sys.UI.DomElement.containsCssClass(t,Dd.Ubd)||Sys.UI.DomElement.containsCssClass(t,Dd.sFb)}EOf(t){return t.className.startsWith(Dd.KOf)}lsj(t,
P){var ia=document.activeElement;ia&&(Sys.UI.DomElement.containsCssClass(ia,Dd.sFb)?(ia=parseInt(ia.getAttribute(Dd.SYg).toString())+1,t?ia!==ch.Vhc?P.pjb(ia+1):P.pjb(1):1!==ia?P.pjb(ia-1):P.pjb(ch.Vhc)):t?P.pjb(1):P.pjb(ch.Vhc))}ksj(t,P){var ia=document.activeElement;if(ia){for(var Aa=Yl.KOi,Ka=0;!Sys.UI.DomElement.containsCssClass(ia,Aa[Ka]);)if(Ka++,Ka===Aa.length){Ka=-1;break}var pb=document.querySelectorAll("."+Dd.nRa).length;Aa[Ka]!==Dd.nRa?t?Ka!==Aa.length-1&&-1!==Ka?Aa[Ka+1]!==Dd.nRa?this.exb(Aa[Ka+
1],P):P.qnd(0):this.exb(Aa[0],P):Ka&&-1!==Ka?Aa[Ka-1]!==Dd.nRa?this.exb(Aa[Ka-1],P):P.qnd(pb-1):this.exb(Aa[Aa.length-1],P):(ia=parseInt(ia.getAttribute(ch.mRa).toString()),t?ia!==pb-1?P.qnd(ia+1):this.exb(Aa[Ka+1],P):ia?P.qnd(ia-1):this.exb(Aa[Ka-1],P))}}exb(t,P){switch(t){case Dd.O7a:P.J5k();break;case Dd.qub:P.I5k();break;case Dd.n2b:P.G5k();break;case Dd.r2b:P.H5k()}}N6b(t,P){if(this.la.ZXc&&this.Op.Uo.isVisible){if(P&&(t===hb.a.IBa||t===hb.a.grb)){this.Rb.KZ=Q.a.empty;P=this.ua.presentation;
const ia=this.Jb.zd(7,void 0,void 0,void 0,!0);try{ia.nc(P),this.la.oKi&&(ia.jd=t),P.removeProperty(Yb.a.NCa)}finally{ia&&ia.dispose()}}this.dr.Nvl(this.Op.Xja());this.la.jKi&&t!==hb.a.IBa&&t!==hb.a.grb&&this.ia.processAction(hb.a.GLf,2)}}sna(t,P){this.N6b(P.$1e,P.$ab)}gJj(t){return this.Rb.Hzb(t)}dlg(t){switch(t){case Zf.a.yQd:case Zf.a.BQd:case Zf.a.NYb:case Zf.a.AQd:case Zf.a.CQd:case Zf.a.DQd:case Zf.a.GPa:case Zf.a.EQd:case Zf.a.FQd:case Zf.a.GQd:case Zf.a.HQd:case Zf.a.JQd:case Zf.a.LQd:case Zf.a.backspace:case Zf.a.QBa:case Zf.a.TK:case Zf.a.WQa:case Zf.a.enter:case Zf.a.rB:case Zf.a.typing:return!0;
default:return!1}}isEnabled(){return this.la.ZXc}iJj(){return 0<this.ybc}qUd(){return this.ybc}X1g(t,P){t=P.slideId;O.a.J(512496520,829,50,"DesignerManager::OnCoauthModifiedSameSlide - Others is editing in slide sid: {0}",t.sid);if((P=this.ua.Ba)&&P.Cb.equals(t)){P="unopened";this.Op.Uo.isVisible&&(this.Op.Uo.isVisible&&this.WKb(this.Op,5),P="set to SameSlideCoauthNoSuggestion UI");let ia="unopened";this.Op.Uo.isVisible&&(this.HIa(this.Rb.correlationId,ok.a.GIa),ia="closed");"unopened"===P&&"unopened"===
ia||O.a.J(512496519,829,50,"DesignerManager::OnCoauthModifiedSameSlide - Designer pane state: {0}. Designer card in Ideas pane state: {1}. Slide sid:{2}, cid:{3}, CorrelationId:{4}, CoauthCountInPresentation:{5} and CoauthCountInSlide:{6}.",P,ia,t.sid,t.cid,this.Rb.correlationId,this.kpe,this.ybc)}}q6g(t,P){O.a.J(512496518,829,50,"DesignerManager::OnSuggestionsUpdated - IsDesignerEnabled:{0}, CoauthCountInPresentation:{1}, CoauthCountInSlide:{2}, correlationId:{3}; trigger: {4}",this.la.ZXc,this.kpe,
this.ybc,P.correlationId,P.trigger);if(this.isEnabled()){if(t=this.ua.Ba)if(P.slideId.equals(t.Cb))if(this.gJj(P.correlationId))O.a.J(512496515,829,50,"DesignerManager::OnSuggestionsUpdated - CorrelationId is in closed suggestion list. CorrelationId:{0}",P.correlationId);else if(this.fCl(P.correlationId))O.a.J(512496514,829,50,"DesignerManager::OnSuggestionsUpdated - User began to upload picture during incremental rendering, so ignore further suggestions for this CorrelationId. CorrelationId:{0}",
P.correlationId);else{this.Rb.correlationId!==P.correlationId&&(this.Rb.jqf(P.correlationId,this.la.jja&&P.trigger===Le.a.moreIdeas),O.a.J(512496513,829,50,"DesignerManager::OnSuggestionsUpdated - ignore result from different correlation. expected correlation: {0}; received correlation: {1}",this.Rb.correlationId,P.correlationId));if(this.Rb.correlationId===P.correlationId&&this.Op.Uo.isVisible&&3===this.Op.Uo.Paa)if(this.la.designerIncrementalRenderEnabled&&xb.a.any(P.trc.toArray(),ia=>0<=this.Rb.Wea.indexOf(ia)))this.Rb.iic=
new Date,O.a.J(512496512,829,50,"DesignerManager::OnSuggestionsUpdated - Notification for missing Designer cards successfully received. CorrelationId: {0}, Received indexes: {1}, Missing indexes {2}",P.correlationId,P.trc.toString(),this.Rb.Wea.toString());else if(t=P.fLa,!this.la.designerIncrementalRenderEnabled||this.Rb.isa.contains(t)){O.a.J(512496483,829,50,"DesignerManager::OnSuggestionsUpdated - Duplicated Designer card notification. CorrelationId: {0}, StartIdx: {1}",P.correlationId,t.toString());
return}t=ze.OYd(P.UCa);this.v0k(t,P);this.avj(P);this.$uj(this.Op,P,t,P.Daa,xb.a.Wa(this.Rb.$Pa)?P.Daa:this.Rb.$Pa.length)}else O.a.J(512496516,829,50,"DesignerManager::OnSuggestionsUpdated - current slide node is different to suggestion slide node. CorrelationId:{0}",P.correlationId)}else O.a.J(512496517,829,50,"DesignerManager::OnSuggestionsUpdated - Designer is not enabled. CorrelationId:{0}",P.correlationId)}v0k(t,P){if(t&&P.trigger!==Le.a.moreIdeas){this.Rb.suggestions||(this.Rb.suggestions=
Object.assign(new pk,{CardData:t.CardData,SlideSuggestions:Array(P.ice?P.Daa:P.w0a)}));if(!xb.a.Wa(t.SlideSuggestions))for(const ia of t.SlideSuggestions)this.Rb.suggestions.SlideSuggestions[ia.Index]=ia;this.Rb.$Pa||(this.Rb.$Pa=ze.Cxk(t))}}$uj(t,P,ia,Aa,Ka){O.a.J(512496482,829,50,"DesignerView.SetViewState. CorrelationId:{0}, Trigger:{1}, TotalSuggestions:{2}, DesignerCardCount:{3}",P.correlationId,P.trigger,P.Daa,Aa);if(P.trigger===Le.a.moreIdeas)this.Rb.ega||(this.Rb.ega=new Date),Aa=t.Q5b(),
this.dr.IVk(ia,t.Xja(),P.correlationId,t.Fsa())||(this.dr.pVc(t.Xja()),Aa=t.Q5b()-1),t.Fw(Aa,!0),this.WKb(t,8);else if(!Aa)!this.la.designerNewNoIdeasUxEnabled||P.trigger!==Le.a.Psc&&P.trigger!==Le.a.KNb?this.WKb(t,2):this.WKb(t,9),this.Op.Uo.isVisible?this.HIa(this.Rb.correlationId,ok.a.GIa):this.k3k(Og.a.noSuggestion);else if(this.Ndl(P.trigger,t.Uo)){var pb=!0;if(this.la.designerIncrementalRenderEnabled){pb=null;var Nb=t.Xja();Nb&&(pb=Nb.querySelector("#"+t.Uo.id+" ."+ze.UPa+'[correlationId="'+
P.correlationId+'"]'));pb=!pb;O.a.J(512496481,829,50,"HandleSuggestionUpdate CorrelationId:{0}, Trigger:{1}, FirstRender:{2}",P.correlationId,P.trigger,pb);Nb=new al(P,pb);this.Lc.YJk(Nb)}if(pb){this.WKb(t,3);this.Rb.ega||(this.Rb.ega=new Date);try{this.la.tCk&&this.twa.execute(kc=>{kc.logActivity("HasSeenDesigner","PPTDesignerFloodgateSurveyEnabled")})}catch(kc){O.a.J(512496480,829,10,"DesignerManager::HandleSuggestionUpdate: Exception thrown when trying to trigger floodgate survey. Exception: {0}",
kc)}}t=new vi(ia,Aa,Ka,P.correlationId,t.Xja(),pb,t.Fsa(),this.dr.YVc(P.trigger));this.dr.FPe(t)}}avj(t){t.ice?(xb.a.Wa(this.Rb.suggestions.SlideSuggestions)||this.Rb.suggestions.SlideSuggestions.length===t.Daa)&&this.HIa(t.correlationId,ok.a.success,this.Rb.suggestions,t.trigger):this.HIa(t.correlationId,ok.a.success,this.Rb.suggestions,t.trigger)}Ndl(t,P){return P.isVisible||t!==Le.a.Xma&&t!==Le.a.dTd&&t!==Le.a.Dsb}Spd(t,P){this.ybc=t;this.kpe=P;this.Lc.sz(new Kp.a(1))}S6g(){this.Op.Uo.isVisible&&
3===this.Op.Uo.Paa&&(this.myg.add(this.Rb.correlationId),this.Op.U_a(1))}fCl(t){return this.myg.contains(t)}HIa(t,P,ia=null,Aa=""){O.a.J(512496479,829,50,"DesignerManager:NotifySuggestionsReadyForIdeas - CorrelationId:{0}, Status:{1}, Trigger:{2}",t,P,Aa);this.kWa.execute(Ka=>{const pb=this.Gzi(t,ia);ab.a.Wa(Aa)||(pb.trigger=Aa);Ka.notifySlideSuggestion(P,pb)})}Gzi(t,P){const ia=new Wl;ia.correlationId=t;if(!P)return O.a.J(512496478,829,50,"DesignerManager:ParseSlideSuggestionNotificationData - no suggestions to parse. CorrelationId:{0}",
t),ia;ia.suggestions=this.dr.iyk(P);return ia}ftk(t){t=new vi(this.Rb.suggestions,t.suggestions.length,t.suggestions.length,t.correlationId,this.Op.Xja(),!0,this.Op.Fsa(),this.dr.YVc(t.trigger));this.dr.FPe(t);this.Fa.Bj(fd.a.b_,!0)}Dwk(){return 4===this.Op.Uo.Paa}Awk(){return 1===this.Op.Uo.Paa}}Object(k.a)(bj,"DesignerManager",null,[759,106]);class Pl{constructor(t,P){this.reb=this.xo=null;this.jck=P;this.He=t;this.nr=!1}get Ah(){return this.nr}setup(){this.Ah||(this.reb=cb.a.Fe(),this.reb.setAttribute("Unselectable",
"on"),this.reb.style.position=Xa.a.absolute,this.He.addCssClass(this.reb,"designerPreviewImageContainer"),this.xo=new Lb.a,this.nr=!0)}dispose(){this.Ah&&(this.dismiss(),this.xo&&this.xo.xa.parentNode&&(this.xo.yq(),this.He.removeCssClass(this.xo.xa,"designerPreviewImageContainer")))}dismiss(){this.Ah?(this.Pna(),this.xo.setVisibility(!1)):O.a.J(38099035,829,15,"DesignerPreviewImageView::Dismiss - called before setup")}poa(t){if(this.Ah){this.reb&&(this.reb.appendChild(this.xo.xa),this.He.addCssClass(this.xo.xa,
"designerPreviewImageContainer"),this.xo.setVisibility(!1));var P=this.jck.Ic;if(t=this.$ia(t))this.Pna(),P.Qqc.appendChild(this.reb),this.xo.xa.appendChild(t),this.xo.setVisibility(!0);this.xo.ih(P.BB.clientWidth,P.BB.clientHeight)}else O.a.J(38099037,829,15,"DesignerPreviewImageView::SetImage - called before setup")}$ia(t){if(!ab.a.Wa(t)){const P=cb.a.eC();P.setAttribute("Unselectable","on");P.src=t;P.style.height="100%";P.style.width="100%";return P}return null}Pna(){this.xo.xa.firstChild&&this.xo.xa.removeChild(this.xo.xa.firstChild)}}
Object(k.a)(Pl,"DesignerPreviewImageView",null,[760]);var bl=d(160);class Wo{constructor(t,P,ia,Aa,Ka,pb,Nb,kc,Rc,Yc,hd,se){this.$L=null;this.tIa=0;this.ia=t;this.Jb=P;this.ob=ia;this.ua=Aa;this.Fb=Ka;this.la=pb;this.vi=Nb;this.pj=kc;this.fc=Rc;this.D9=Yc;this.zb=hd;this.Qd=se;this.pma=ci.ready}vb(){this.ia.ra(hb.a.fixIt,lb.a.application,Object(r.a)(this,this.Rqj,"handleFixIt"),4);this.ia.ra(hb.a.HLe,lb.a.application,Object(r.a)(this,this.otj,"handleQueryFixIt"),96);this.ia.ra(hb.a.hrb,lb.a.application,
Object(r.a)(this,this.hrb,"applyFixItSuggestion"),4);this.ia.ra(hb.a.SZa,lb.a.application,Object(r.a)(this,this.SZa,"reportFixItSessionInfo"),64);this.D9.SXb(Object(r.a)(this,this.dfa,"onBlockingStateChanged"))}dispose(){this.D9.hkd(Object(r.a)(this,this.dfa,"onBlockingStateChanged"))}Rqj(t,P,ia){P=this.ob.Xd();if(2>P.length)return 8;if(1===ia)return 32;ia=this.ua.presentation;this.la.designerBlockApplyUntilDraw?this.fc.Bra(ia,this.ua.Ba,this.Fb.Ma,t):this.fc.Zv(ia,t);this.pj.PXc=!0;const Aa=[];P.forEach(Ka=>
{Array.add(Aa,Ka.get_shapeId())});t={};t.SelectedShapeIds=Aa.join(",");this.pj.Jjb=Aa;this.I$d(t);this.pj.Tkb=window.setTimeout(()=>{this.Sqj(this.pj.correlationId)},this.la.JUf);return 32}Sqj(t){this.pj.KUa=!0;O.a.J(573961115,829,15,"FixItActor::HandleFixItTimeout, CorrelationId: {0}",t);this.ia.La(hb.a.SZa,2,Og.a.Cqd);this.Qd.psa(Lk.a.Uh(170),0,ResourceStrings.errorTitle_PowerpointEditingStandard,ResourceStrings.errorMessage_FixItTryAgain)}I$d(t=null,P=null){this.xSi(ia=>{if(this.la.designerRequestThrottlingEnabled){if(this.pma.ujg&&
+new Date-+this.pma.vmg<this.la.designerRequestThrottleIntervalMs){this.$L=new Hn;this.$L.sid=ia.sid;this.$L.cid=ia.cid;this.$L.yVc=ia.AQ;return}this.pma=ci.inProgress;this.$L=null}const Aa=()=>{this.I$d(this.$L.yVc,P)};this.vi.Fja(ia.cid,ia.sid,ia.correlationId,null,Ye.a.fixIt,P,mk.c(ia.AQ),Ka=>{Ka&&Ka.Status===Ye.a.$jh?this.fld(()=>{this.I$d(ia.AQ,P)}):this.tIa=0;this.tIa||this.K6b(Aa)},Ka=>this.Bgb(Ka,Aa))},t)}fld(t){this.tIa<this.la.designerMaxRetryOnWait?this.zb.Eb(new D.a(2,1,1E3,()=>{O.a.J(578937822,
829,50,"retry request due to waiting on pending edits. prior correlation: {0}",this.pj.correlationId);this.pma=ci.ready;this.tIa++;t()},void 0,"RetryRequestOnWait")):O.a.J(578937820,829,50,"retries for request awaiting prior edits exceeded. skipping request. correlation: {0}",this.pj.correlationId)}hrb(t,P,ia,Aa,Ka){P=this.ua.presentation;if(!this.ua.Ba||!P)return 16;Aa=null;Object(Lh.a)(kg,Ka)&&(Aa=Ka);if(!Aa)return 8;if(1===ia)return 32;ia=this.Jb.le(15);try{this.la.designerSendAppliedSuggestionHistoryEnabled&&
(this.pj.APa=new Date),ia.nc(P),ia.jd=t,P.NCa=Aa,this.pj.KZ=Q.a.PE(Aa.SuggestionSid,Aa.SuggestionCid),this.pj.zT=!0,O.a.J(578937818,829,50,"FixItActor::ApplyFixitSuggestion - CorrelationId: {0}, ActionId: {1}, SuggestionSid: {2}",Aa.CorrelationId,t,Aa.SuggestionSid)}finally{ia&&ia.dispose()}return 32}xSi(t,P=null){const ia=this.ua.Ba;ia&&ia.sid&&(P=Object.assign(new zk,{sid:ia.sid,cid:ia.cid,AQ:P||{}}),O.a.J(578937816,829,50,"FixIt; sid: {0}; correlationId: {1}",P.sid,P.correlationId),this.pj.correlationId&&
this.EKb(Og.a.Bib),this.pj.v0a=new Date,this.pj.correlationId=P.correlationId,this.pj.bQ=new Date,t(P))}K6b(t){this.la.designerRequestThrottlingEnabled&&(this.pma=ci.ready,this.$L&&t())}Bgb(t,P){this.K6b(P);O.a.J(578937814,829,15,"FixItActor::OnTaskFailure - request failed with response: {0}. returning true to prevent ACE",t.HttpStatusCode);return!0}otj(t,P,ia,Aa,Ka){this.psl();if(!Object(Lh.a)(Nl.a,Ka))return 8;if(1<this.ob.Bmd()){let pb;(pb=this.pj).$rb=pb.$rb+1;return 32}return 8}SZa(t,P,ia,Aa,
Ka){if(Ka===Og.a.noSuggestion||Ka===Og.a.Cqd)this.la.designerBlockApplyUntilDraw?this.fc.rtc(bl.e(this.ua.Ba,this.Fb.Ma)):this.fc.ZJ(this.ua.presentation);this.EKb(Ka);return 32}dfa(t,P){if(this.pj.PXc){t=this.fc.$c(this.ua.presentation);const ia=this.la.designerBlockApplyUntilDraw?"UnblockContentWhenDraw":"SessionRehydrated";t||Object(R.a)(String,P.actionName)!==ia||(window.clearTimeout(this.pj.Tkb),this.pj.KUa||(this.pj.u0a=new Date),this.pj.APa=null,this.pj.PXc=!1)}}EKb(t){const P=this.pj.correlationId;
if(ab.a.Wa(P))O.a.J(578937812,829,50,"FixItActor::SendTraceRequest - skipped for empty correlation. ResetReason:{0}",t);else{var ia={};this.pj.KZ&&(ia.SuggestionSlideId=this.pj.KZ.sid.toString(),ia.SuggestionSlideCreationId=this.pj.KZ.cid.toString());ia.AppliedSuggestion=this.pj.zT;ia.DisplaySuggestionsTimeoutInMs=this.la.JUf;ia.SuggestionsTimeout=this.pj.KUa;ia.ClientAbort=this.pj.vyb;ia.ResetReason=t;ia.DesignerSendTraceRequestOnSessionEnded=this.la.UYd;var Aa=fe.b(v.AFrameworkApplication.fa.appSettings.SessionStartInfoJson.toString()),
Ka={};Ka.ClientOS=Aa.Os;Ka.Browser=Aa.Browser||"";Ka.BrowserVersion=Aa.BrowserVersion||"";Ka.BrowserMajorVersion=Aa.BrowserMajorVersion||"";Ka.BrowserMinorVersion=Aa.BrowserMinorVersion||"";this.pj.v0a&&this.pj.OMb&&this.pj.OMb>this.pj.v0a&&(Ka.SuggestionsE2ETimeMs=+this.pj.OMb-+this.pj.v0a);this.pj.v0a&&this.pj.u0a&&this.pj.u0a>this.pj.v0a&&(Ka.SuggestionAppliedE2ETimeMs=+this.pj.u0a-+this.pj.v0a);ia.BrowserData=Ka;this.pj.bQ&&this.pj.u0a&&this.pj.u0a>this.pj.bQ&&(ia.TimeToDisplaySuggestionsInMs=
+this.pj.u0a-+this.pj.bQ);this.pj.R_e&&(ia.TimeSuggestionsRendered=this.pj.R_e.toUTCString());this.vi.Zna(P,mk.c(ia),t===Og.a.Umd);this.pj.wQe();O.a.J(578937810,829,50,"FixItActor::SendTraceRequest - Send session info and add correlationId to closed list. resetReason: {0}; CorrelationId:{1}",t,P)}}psl(){try{const t=A.a.instance.Ja("Common.ISystemInitiatedFeedback");t&&t.execute(P=>{P.logActivity("AutoFixInViewportActivity",null)})}catch(t){O.a.J(573649484,829,10,"Exception thrown while triggering AutoFixInViewportActivity. Exception: {0}",
t)}}N$(){}M$(){}}Object(k.a)(Wo,"FixItActor",null,[141]);class rn{constructor(){this.$rb=0;this.correlationId=this.Jjb=null;this.Tkb=0;this.vyb=this.PXc=this.zT=this.KUa=!1;this.suggestion=this.bQ=this.u0a=this.APa=this.OMb=this.v0a=this.R_e=null;this.KZ=Q.a.empty}wQe(){this.$rb=0;this.correlationId=this.Jjb=null;this.KZ=Q.a.empty;this.Tkb=0;this.vyb=this.PXc=this.zT=this.KUa=!1;this.bQ=this.u0a=this.APa=this.OMb=this.v0a=this.R_e=null}}Object(k.a)(rn,"FixItContext",null,[764]);var Xm=d(944),ho=d(959),
li=d(845),xe=d(910);class sn{constructor(t,P,ia,Aa,Ka,pb,Nb,kc,Rc,Yc){this.ia=t;this.ua=P;this.Jb=ia;this.Lc=Aa;this.pj=Ka;this.Lg=pb;this.WEb=Nb;this.YI=kc;this.Oc=Rc;this.Qd=Yc;this.Pu()}Pu(){this.WEb.RXb(Object(r.a)(this,this.wH,"onEvent"));this.Lg.kI(Object(r.a)(this,this.wH,"onEvent"));this.Oc.qPa(Object(r.a)(this,this.wH,"onEvent"));this.Oc.WB(Object(r.a)(this,this.wH,"onEvent"));this.Lc.o9h(Object(r.a)(this,this.p6g,"onSuggestionReceived"));this.Lc.SFc(Object(r.a)(this,this.sna,"onUndoRedo"))}dispose(){this.Lc.RTk(Object(r.a)(this,
this.p6g,"onSuggestionReceived"));this.Lc.mkd(Object(r.a)(this,this.sna,"onUndoRedo"))}p6g(t,P){if(t=this.ua.Ba)if(P.slideId.equals(t.Cb))if(this.pj.correlationId!==P.correlationId)O.a.J(578937806,829,50,"FixItManager::OnSuggestionReceived - ignore result from different correlation. expected correlation: {0}; received correlation: {1}",this.pj.correlationId,P.correlationId);else if(t=sn.OYd(P.UCa),t.SlideSuggestion)this.pj.OMb||(this.pj.OMb=new Date),P=Object.assign(new kg,{SuggestionCid:t.SlideSuggestion.SlideId.Cid,
SuggestionSid:t.SlideSuggestion.SlideId.Sid,CorrelationId:P.correlationId,ActiveSlideCid:Object(R.a)(116,this.ua.Ba).cid,ActiveSlideSid:Object(R.a)(116,this.ua.Ba).sid}),this.ia.La(hb.a.hrb,2,P);else switch(this.ia.La(hb.a.SZa,2,Og.a.noSuggestion),t.ResponseDescription){case "Invalid request":this.Qd.psa(Lk.a.Uh(122),0,ResourceStrings.errorTitle_PowerpointEditingStandard,ResourceStrings.errorMessage_FixItInvalidRequest);break;case "No suggestion":this.Qd.psa(Lk.a.Uh(132),0,ResourceStrings.errorTitle_PowerpointEditingStandard,
ResourceStrings.errorMessage_FixItNoSuggestion);break;default:this.Qd.psa(Lk.a.Uh(134),0,ResourceStrings.errorTitle_PowerpointEditingStandard,ResourceStrings.errorMessage_FixItTryAgain)}else O.a.J(578937808,829,50,"FixItManager::OnSuggestionReceived - current slide node is different to suggestion slide node. CorrelationId:{0}",P.correlationId)}wQ(t){this.pj.correlationId&&t!==hb.a.hrb&&this.ia.La(hb.a.SZa,2,Og.a.aPb+this.YI.I5(t))}N6b(t,P,ia){if(this.pj.correlationId&&ia&&P===hb.a.hrb){this.pj.KZ=
Q.a.empty;ia=this.ua.presentation;const Aa=this.Jb.zd(7,void 0,void 0,void 0,!0);try{Aa.nc(ia),Aa.jd=P,ia.removeProperty(Yb.a.NCa)}finally{Aa&&Aa.dispose()}this.ia.La(hb.a.SZa,2,Og.a.aPb+this.YI.I5(t))}}sna(t,P){this.N6b(P.actionId,P.$1e,P.$ab)}wH(t,P){t=!1;let ia="";if(Object(Lh.a)(Xm.a,P)){O.a.J(578937802,829,50,"FixItManager::OnSessionEnding. Correlation={0}, Reason={1}",this.pj.correlationId,qn.a[Object(R.a)(Xm.a,P).fG]);if(1===Object(R.a)(Xm.a,P).fG||3===Object(R.a)(Xm.a,P).fG)t=!0;ia=Og.a.Umd}else Object(Lh.a)(ho.a,
P)?(O.a.J(578937800,829,50,"FixItManager::OnSessionRehydrated"),t=!0,ia=Og.a.UQk):Object(Lh.a)(li.a,P)?(t=!0,ia=Og.a.slideNavigation):Object(Lh.a)(xe.a,P)&&Object(R.a)(xe.a,P).Tyb&&this.wQ(Object(R.a)(xe.a,P).actionId);t&&this.pj.correlationId&&this.ia.La(hb.a.SZa,2,ia);this.h2j()}h2j(){0<this.pj.$rb&&(O.a.J(574166159,829,50,"FixItActor::HandleQueryFixIt - FixIt button is enabled: {0}",this.pj.$rb),this.pj.$rb=0)}static OYd(t){let P=null;try{P=fe.a(t)}catch(ia){O.a.J(578937804,829,10,"FixItManager::DeserializeSuggestionResponse - parsing suggestionResults failed")}return P}}
Object(k.a)(sn,"FixItManager",null,[763,106]);var qc=d(1014),Nk=d(15),In;(function(t){t[t.seen=0]="seen";t[t.keep=1]="keep";t[t.drillIn=2]="drillIn"})(In||(In={}));Object(k.b)("IdeasCardAction",In);var Zl;(function(t){t[t.designer=0]="designer";t[t.makeItVisual=1]="makeItVisual";t[t.editor=2]="editor";t[t.UNKNOWN=3]="UNKNOWN"})(Zl||(Zl={}));Object(k.b)("IdeasCardType",Zl);class Lj{constructor(t,P){this.Qua=null;this.pfc=!1;this.ia=t;this.la=P;this.ia.ya(hb.a.ideasPaneOpened,lb.a.application,Object(r.a)(this,
this.hrj,"handleIdeasPaneOpen"));this.ia.ya(hb.a.Gbe,lb.a.application,Object(r.a)(this,this.grj,"handleIdeasPaneClose"));this.ia.ya(hb.a.Gag,lb.a.application,Object(r.a)(this,this.j8f,"handleIdeasKeep"));this.ia.ya(hb.a.Hag,lb.a.application,Object(r.a)(this,this.M$d,"handleIdeasSee"));this.ia.ya(hb.a.Mag,lb.a.application,Object(r.a)(this,this.M$d,"handleIdeasSee"));this.ia.ya(hb.a.Nag,lb.a.application,Object(r.a)(this,this.L$d,"handleIdeasDrillIn"));this.ia.ya(hb.a.Kag,lb.a.application,Object(r.a)(this,
this.j8f,"handleIdeasKeep"));this.ia.ya(hb.a.Lag,lb.a.application,Object(r.a)(this,this.M$d,"handleIdeasSee"));this.ia.ya(hb.a.Iag,lb.a.application,Object(r.a)(this,this.L$d,"handleIdeasDrillIn"));this.ia.ya(hb.a.Jag,lb.a.application,Object(r.a)(this,this.L$d,"handleIdeasDrillIn"))}hrj(){if(!this.la.pptIdeasContextEnabled)return 2;this.pfc=!0;this.CJj()||this.Tkl(Ca.a.create());return 32}grj(){if(!this.la.pptIdeasContextEnabled)return 2;this.pfc=!1;return 32}j8f(t){if(!this.la.pptIdeasContextEnabled)return 2;
this.Frl(this.aZd(t));return 32}M$d(t){if(!this.la.pptIdeasContextEnabled)return 2;this.dsd(this.aZd(t));return 32}L$d(t){if(!this.la.pptIdeasContextEnabled)return 2;this.Drl(this.aZd(t));return 32}aZd(t){switch(t){case hb.a.Gag:case hb.a.Hag:case hb.a.Iag:t=0;break;case hb.a.Mag:case hb.a.Nag:t=1;break;case hb.a.Kag:case hb.a.Lag:case hb.a.Jag:t=2;break;default:t=3}return t}Tkl(){this.la.pptIdeasContextEnabled&&(this.Qua=new qc.a)}dsd(t){this.la.pptIdeasContextEnabled&&this.pfc&&3!==t&&this.Qua&&
!this.Qua.any(P=>P.key===t)&&this.Qua.add(new Nk.a(t,0))}Frl(t){this.pfc&&3!==t&&this.Qua&&this.Qua.add(new Nk.a(t,1))}Drl(t){this.pfc&&3!==t&&this.Qua&&this.Qua.add(new Nk.a(t,2))}CJj(){return!!this.Qua&&0<this.Qua.length}}Object(k.a)(Lj,"IdeasContext",null,[762]);class Se{constructor(){this.ry=this.qy=null;this.wC=this.nx=0}}Object(k.a)(Se,"ImageLocationInfo",null,[]);var cj=d(436);class io{}Object(k.a)(io,"ImageToTableRequest",null,[]);class Mj{}Mj.kbg="ImageToTableTile";Mj.ibg="ImageToTable.Request";
Mj.jbg="ImageToTable.Response";Object(k.a)(Mj,"ImateToTableAugmentationSchemaNames",null,[]);class Jn{constructor(){this.t0=this.R_=null}get nG(){return"ImageToTableALWorkflow"}get proto(){return""}get Frb(){this.R_||(this.R_=Object.assign(new cj.a,{name:"LambdaBefore_ImageToTableAL",inputSchema:Mj.kbg,outputSchema:Mj.ibg,func:Object(r.a)(this,this.hbb,"lambdaBeforeFunc")}));return this.R_}get Pqb(){return null}get pJb(){this.t0||(this.t0=Object.assign(new cj.a,{name:"LambdaRemote_ImageToTableAL",
inputSchema:Mj.ibg,outputSchema:Mj.jbg,func:null}));return this.t0}hbb(t,P,ia){t=Object.assign(new io,{image:t.image});ia(t)}}Object(k.a)(Jn,"ImageToTableALWorkflow",null,[981]);class jo{constructor(){this.html=this.processId=this.errorDescription=null;this.errorCode=this.shapeId=this.slideId=0}}Object(k.a)(jo,"ImageToTableALv2ResponseWrapper",null,[]);class Ym{constructor(){this.sessionId=null;this.shapeId=this.slideSid=0;this.image=this.oac=null}}Object(k.a)(Ym,"ImageToTableTile",null,[]);class Li{constructor(t,
P,ia,Aa,Ka,pb,Nb,kc,Rc,Yc,hd){this.ia=t;this.ob=P;this.fc=ia;this.Rk=Aa;this.$z=Ka;this.Sb=Nb;this.Tk=kc;this.qoe=Rc;this.Ila=Yc;this.la=hd}initialize(){this.ia.ya(hb.a.wJe,lb.a.application,Object(r.a)(this,this.P7f,"handleConvertImageToTable"));this.ia.ya(hb.a.EJe,lb.a.application,Object(r.a)(this,this.R8f,"handleReplaceImageWithHtmlTable"));this.Rk.kI(Object(r.a)(this,this.sB,"onActiveSlideChanged"));this.qoe.execute(t=>{const P=new Jn;t.registerSimpleRemoteWorkflow(P.nG,P.Frb,P.pJb,P.Pqb);t.addEventHandler(Mj.jbg,
Object(r.a)(this,this.krj,"handleImageToTableALResults"));t.x5a("AugLoop_ImageToTable_DetectedHtmlTableAnnotation");t.knc("AugLoop_ImageToTable_DetectedHtmlTableAnnotation",Object(r.a)(this,this.yta,"handleAnnotationEvent"))})}dispose(){this.ia.WO(hb.a.wJe,lb.a.application,Object(r.a)(this,this.P7f,"handleConvertImageToTable"));this.ia.WO(hb.a.EJe,lb.a.application,Object(r.a)(this,this.R8f,"handleReplaceImageWithHtmlTable"));this.Rk.F5(Object(r.a)(this,this.sB,"onActiveSlideChanged"))}sB(){this.Ila.close()}P7f(t,
P,ia){if(!this.la.pptSuggestedActionImageToTableEnabled)return 16;if(1===ia)return 32;t=this.ob.Xd();if(1!==t.length)return 8;const Aa=this.Ila.Suk();if(!Aa)return O.a.J(512496449,829,15,"[ImageToTableActor::HandleConvertImageToTable] Failed to open the taskpane"),8;const Ka=t[0];this.la.Dah&&(this.Ila.p5k(Aa,Ka.slideSid,Ka.get_shapeId(),Li.GWd(Ka)),this.Ila.e2g(Aa));this.qoe.execute(pb=>{pb.wBl(Ka.slideCid,Ka.slideSid,Ka.get_shapeId(),Nb=>{this.k8f(Aa,Ka,Nb)},()=>{this.k8f(Aa,Ka,null);return!0})});
return 32}yta(t){if(t&&"errorDescription"in t&&"parentPath"in t&&"errorCode"in t){var P=new jo,ia=t.errorDescription.split(";");P.errorDescription=ia[0].split(":")[1];P.processId=ia[1].split(":")[1];P.errorCode=t.errorCode;O.a.J(512496448,829,50,"ImageToTable AL Results received. ProcessId: {0}, ErrorCode: {1}, ErrorDescription: {2}",P.processId,P.errorCode,P.errorDescription);ia=t.parentPath[1].split("|");P.slideId=Number.parseInvariant(ia[0]);P.shapeId=Number.parseInvariant(ia[2]);P.html=t.html;
this.Ila.n5k(P);this.Ila.d2g()}}k8f(t,P,ia){if(ia&&ia.ImgData)if(this.la.Dah)this.Ila.o5k(t,ia.ImgData),this.Ila.d2g();else{const Aa=Li.GWd(P),Ka=Object.assign(new Ym,{sessionId:t,slideSid:P.slideSid,shapeId:P.get_shapeId(),oac:Aa,image:ia.ImgData});this.qoe.execute(pb=>{pb.submit(Mj.kbg,Ka)});this.Ila.e2g(t)}else this.Ila.vpk(t)}krj(t,P,ia,Aa){O.a.J(512496419,829,50,"ImageToTable AL Results received. ProcessId: {0}, ErrorCode: {1}, ErrorDescription: {2}",Aa.processId,Aa.errorCode,Aa.errorDescription);
this.Ila.qnk(P,Aa)}R8f(t,P,ia,Aa,Ka){t=this.Sb.cEa(Ka.slideSid);if(!t)return 8;ia=(P=t.eT(Ka.shapeId))?Li.GWd(P):Ka.oac;if(!ia)return 8;O.a.J(512496418,829,50,"Replacing image with html table. Shape id: {0}",P.get_shapeId());Ka=this.Tk.QWd(!1,t.cid,t.sid,!1,ia.qy,ia.ry,ia.nx,ia.wC,t.Pt()+1,Ka.Tzh,"");this.$z.zW([Ka],t,0,null,P);this.fc.Zv(t,"ImageToTable");return 32}static GWd(t){return Object.assign(new Se,{qy:t.qy,ry:t.ry,nx:t.nx,wC:t.wC})}}Object(k.a)(Li,"ImageToTableActor",null,[]);class Kn{constructor(t){this.shapeId=
this.slideId=0;this.Sbe=null;this.u4e=0;this.Qae=!1;this.ckc=null;this.oZc=!1;this.TVc=this.Wbe=this.R0g=this.p7g=null;this.sessionId=t}}Object(k.a)(Kn,"ImageToTableConversionContext",null,[]);class Ln{constructor(){this.shapeId=this.slideSid=0;this.Tzh=this.oac=null}}Object(k.a)(Ln,"ReplaceImageWithHtmlTableData",null,[]);class Ao{constructor(t,P,ia,Aa){this.ia=t;this.Zc=P;this.Ga=ia;this.axe=Aa;this.G9=null}initialize(){this.Zc.execute(t=>{t.KFc(Object(r.a)(this,this.e3g,"onFirstPartyAddInHidden"))});
this.axe.XNd(Object(r.a)(this,this.s8f,"handleMessage"))}dispose(){this.Zc.execute(t=>{t.QTk(Object(r.a)(this,this.e3g,"onFirstPartyAddInHidden"))});this.axe.Ehh(Object(r.a)(this,this.s8f,"handleMessage"))}Suk(){this.close();const t=new Kn(Ca.a.create().toString());t.p7g=new Promise(ia=>{t.R0g=()=>{ia(t.sessionId)}});const P={};P.TE=ResourceStrings.L_DataFromPicturePaneTitle;P.assetId="FA000000050";P.p5=()=>{this.tgb(t)};P.nonPersistedSettings={["SessionID"]:t.sessionId};P.ZLa=!0;P.sourceLocationOverrideResourceId=
this.Ga.pptImageToTableSourceLocationId;return 32===this.ia.La(hb.a.Ufa,2,P)?(this.G9=t,this.G9.sessionId):this.G9=null}close(){this.mUd(this.G9)}tgb(t){O.a.J(593867348,375,50,"[ImageToTablePane] Taskpane rendered. SessionId = {0}",t.sessionId);const P=this.Zc.instance.mQ("FA000000050");if(P&&P.settings&&"SessionID"in P.settings){var ia;({kv:ia}=fe.d(P.settings.SessionID)).returnValue&&(t.sessionId===ia?(t.ckc=P.instanceId,O.a.J(593867346,375,50,"[ImageToTablePane] Taskpane rendered. InstanceId = {0}",
P.instanceId)):O.a.J(593867344,375,50,"[ImageToTablePane] Failed to find the taskpane"))}}mUd(t){t&&t.ckc&&(t.oZc=!0,this.ia.La(hb.a.Ssb,2,t.ckc))}p5k(t,P,ia,Aa){if(t=this.Svb(t))t.slideId=P,t.shapeId=ia,t.Sbe=Aa}n5k(t){const P=this.G9;P&&P.slideId===t.slideId&&P.shapeId===t.shapeId&&(this.G9.TVc=t)}o5k(t,P){if(t=this.Svb(t))t.Wbe=P}e2g(t){const P=this.Svb(t);P&&(P.u4e=window.setTimeout(()=>{this.Vpj(P)},this.Ga.pptImageToTableALWorkflowTimeoutMs))}qnk(t,P){if(t&&P){var ia=this.Svb(t.sessionId);if(ia&&
!ia.Qae)if(ia.slideId=t.slideSid,ia.shapeId=t.shapeId,ia.Sbe=t.oac,window.clearTimeout(ia.u4e),0===P.errorCode){const Aa={};Aa.tableHtml=P.html;Aa.imageData=t.image;this.sendMessage(ia.sessionId,Aa)}else this.Jmd(t.sessionId,"Failed to convert image to table")}}d2g(){const t=this.G9;if(t&&!t.Qae&&t.TVc&&t.Wbe)if(window.clearTimeout(t.u4e),0===t.TVc.errorCode){const P={};P.tableHtml=t.TVc.html;P.imageData=t.Wbe;this.sendMessage(t.sessionId,P)}else this.Jmd(t.sessionId,"Failed to convert image to table")}vpk(t){this.Jmd(t,
"Failed to render the image shape")}Vpj(t){t.Qae=!0;this.Jmd(t.sessionId,"Failed to convert image to table using AL")}s8f(t,P){P=P.message;(t=this.Svb(P.session_id))&&!t.oZc&&("ACK"===P.cmd_type?(O.a.J(593867342,375,50,"[ImageToTablePane::MessageReceivedHandler] ACK message received.",P.cmd_type),t.R0g()):"cancel"===P.cmd_type?(O.a.J(593867340,375,50,"[ImageToTablePane::MessageReceivedHandler] Cancel message received.",P.cmd_type),this.mUd(t)):"insert_html"===P.cmd_type?(O.a.J(593867338,375,50,"[ImageToTablePane::MessageReceivedHandler] Insert message received.",
P.cmd_type),P=Object.assign(new Ln,{slideSid:t.slideId,shapeId:t.shapeId,oac:t.Sbe,Tzh:P.parameters}),this.mUd(t),this.ia.La(hb.a.EJe,2,P)):O.a.J(593867336,375,15,"[ImageToTablePane::MessageReceivedHandler] Unknown message received. Message type: {0}",P.cmd_type))}Jmd(t,P){this.sendMessage(t,{["errorMessage"]:P})}sendMessage(t,P){const ia=this.Svb(t);ia&&ia.sessionId===t&&ia.p7g.then(()=>{this.axe.sendMessage(ia.ckc,P)})}Svb(t){return t&&this.G9&&this.G9.sessionId===t?this.G9:null}e3g(t,P){P&&this.G9&&
P.instanceId===this.G9.ckc&&(this.G9=null)}}Object(k.a)(Ao,"ImageToTablePane",null,[766]);class Xo extends Sys.EventArgs{constructor(t){super();this.message=t}}Object(k.a)(Xo,"ImageToTablePaneMessageReceivedArgs",Sys.EventArgs,[]);class Bo{constructor(t){this.va=new wg.a;this.Ga=t}XNd(t){this.va.addHandler("ImageToDocPaneMessageReceived",t)}Ehh(t){this.va.removeHandler("ImageToDocPaneMessageReceived",t)}initialize(){try{window.addEventListener?window.addEventListener("message",Object(r.a)(this,this.gic,
"messageReceivedHandler"),!1):-1<window.navigator.userAgent.indexOf("MSIE")&&window.attachEvent?window.attachEvent("onmessage",Object(r.a)(this,this.gic,"messageReceivedHandler")):O.a.J(593867334,375,10,"[ImageToTablePane::Initialize] Failed to subscribe to onmessage event of window")}catch(t){O.a.J(593867332,375,10,"[ImageToTablePane::Initialize] Failed to subscribe to onmessage event of window with exception, message: {0}, stack: {1}",t.message,t.stack)}}sendMessage(t,P){const ia={["imageToTablePaneWildcard"]:"."};
for(const Aa of Object.keys(P))ia[Aa]=P[Aa];OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(t,"onCustomMessage",ia,Aa=>{Aa&&O.a.J(593867330,375,15,"Couldn't deliver the message to ImageToDoc pane, status: {0}.",Aa)})}gic(t){if(t&&this.y9b(t.origin)){var P;({kv:P}=fe.d(t.data)).returnValue&&P&&(t=Object(R.a)(Object,P),"."===t.imageToTablePaneWildcard&&this.va.raiseEvent("ImageToDocPaneMessageReceived",new Xo(t)))}}y9b(t){return t&&t.length&&"null"!==t?t===this.Ga.pptImageToTableAllowedOrigin:
!1}}Object(k.a)(Bo,"ImageToTablePaneMessenger",null,[765]);var qp=d(1077);class Co{constructor(){this.Scenario=0;this.ShapeIds=null;this.SlideSid=this.SlideCid=0}}Object(k.a)(Co,"ImageTransformInfo",null,[]);class ko{constructor(t,P,ia,Aa){this.ia=t;this.ob=P;this.ua=ia;this.Lc=Aa}initialize(){this.Lc.W7h(Object(r.a)(this,this.o6g,"onSuggestedActionClick"))}dispose(){this.Lc.ZSk(Object(r.a)(this,this.o6g,"onSuggestedActionClick"))}o6g(t,P){if((t=P.card)&&this.ua.Ba){var ia=this.ua.Ba.Pk(),Aa=[];P=
[];for(var Ka of ia)for(const pb of t.Selects)if(pb.Id===Ka.get_shapeId()){Array.add(Aa,Ka);Array.add(P,Ka.get_shapeId());break}this.ob.Vx();this.ob.Qh();this.ob.s_a(Aa,!0);if(4===t.Type){if(Ka=this.ua.presentation)Ka.Hxb=Object.assign(new Co,{Scenario:t.Scenario,SlideSid:this.ua.Ba.sid,SlideCid:this.ua.Ba.cid,ShapeIds:P})}else this.ia.processAction(qp.a.aIc(t.ExecutionActionName),2)}}}Object(k.a)(ko,"SuggestedActionsHandler",null,[]);class tn{constructor(){this.K=null;this.qO=!1;this.hF=!!v.AFrameworkApplication.Aa&&
!!v.AFrameworkApplication.Aa.hb&&v.AFrameworkApplication.Aa.hb.bX}get name(){return"PowerPointWebEditor.Designer"}$b(t){this.K=t;this.K.register(756,"PowerPointWebEditor.IDesignerView").ma().oa(()=>new Yl(this.K.resolve("Box4.IHtmlViewRootFactory"),this.K.resolve("PowerPoint.IPathManager"),this.K.resolve("PowerPointWebEditor.IDesignerPane"),this.K.resolve("PowerPointWebEditor.IDesignerViewHelper"),this.K.resolve("PowerPointWebEditor.IDesignerContext"),this.K.resolve("Box4.IViewManager"),this.K.resolve("PowerPointWebEditor.IFocusManager"),
this.K.resolve("Common.IClickInputManager"),this.K.resolve("Common.IPointerInputManager"),this.K.resolve("PowerPointWebEditor.IInputHandlerManager"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.View.IViewEventNotifier"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper")));this.K.register(757,"PowerPointWebEditor.IDesignerPane").ma().oa(()=>new qj(this.K.resolve("Box4.IAppFrame"),
this.K.resolve("PowerPoint.IPathManager"),this.K.resolve("Common.IClickInputManager"),this.K.resolve("PowerPointWebEditor.IInputHandlerManager"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IDesignerContext"),this.K.resolve("PowerPointWebEditor.View.IFocusManagerHelper"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("PowerPointWebEditor.Core.IPodsPopsEventHandler"),this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),this.K.resolve("PowerPointWebEditor.IFocusManager"),
this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.IInboundHelper"),this.K.resolve("PowerPointWebEditor.ITaskPaneManager")));this.K.register(758,"PowerPointWebEditor.IDesignerViewHelper").ma().oa(()=>new ze(this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.IDesignerContext"),this.K.resolve("Common.ITaskManager"),
this.K.resolve("PowerPoint.IPathManager"),this.K.Ja("PowerPointWebEditor.AgendaConverter.IAgendaConverterView")));this.K.register(759,"PowerPointWebEditor.IDesignerManager").ma().oa(()=>new bj(this.K.resolve("PowerPointWebEditor.IDesignerView"),this.K.resolve("PowerPointWebEditor.IDesignerViewHelper"),this.K.resolve("PowerPointWebEditor.IDesignerContext"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.Ja("PowerPointWebEditor.IDesignerServiceProvider"),this.K.Ja("PowerPointWebEditor.IApplyDesignerSuggestions"),this.K.Ja("Common.ISystemInitiatedFeedback")));this.K.register(760,"PowerPointWebEditor.Designer.IDesignerPreviewImageView").ma().oa(()=>new Pl(this.K.resolve("PowerPoint.IBrowserHelperManager"),this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager")));
this.K.register(761,"PowerPointWebEditor.IDesignerContext").ma().oa(()=>new Wm(this.K.Ja("PowerPointWebEditor.IDesignerServiceProvider")));this.K.register(762,"PowerPointWebEditor.Infrared.IIdeasContext").ma().oa(()=>new Lj(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IApplicationSettings")));this.K.register(763,"PowerPointWebEditor.IFixItManager").ma().oa(()=>new sn(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),this.K.resolve("PowerPointWebEditor.IFixItContext"),this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.K.resolve("PowerPointWebEditor.UndoRedo.IUndoEventHandlers"),this.K.resolve("PowerPointWebEditor.IActionNameResolver"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("PowerPointWebEditor.IErrorHandler")));this.K.register(764,
"PowerPointWebEditor.IFixItContext").ma().oa(()=>new rn);(this.qO=this.K.resolve("PowerPointWebEditor.IApplicationContext").od.wg)&&this.K.register(ad.a,"PowerPointWebEditor.PodsInfoSender").ma().oa(()=>new ad.a(v.AFrameworkApplication.Je,this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("PowerPointWebEditor.Core.IPodsPopsEventHandler"),this.K.resolve("PowerPointWebEditor.IErrorHandler"),this.K.resolve("Common.ITaskManager"),
this.K.resolve("Common.IAppSettingsManager")));this.K.register(Li,"PowerPointWebEditor.Designer.ImageToTableActor").ma().oa(()=>new Li(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.K.resolve("PowerPointWebEditor.IGraphTransactionHelper"),this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),
this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.IShapeEditor"),this.K.Ja("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),this.K.resolve("PowerPointWebEditor.Designer.IImageToTablePane"),this.K.resolve("PowerPointWebEditor.IApplicationSettings")));this.K.register(765,"PowerPointWebEditor.Designer.IImageToTablePaneMessenger").ma().oa(()=>new Bo(this.K.resolve("PowerPointWebEditor.IApplicationSettings")));this.K.register(766,"PowerPointWebEditor.Designer.IImageToTablePane").ma().oa(()=>
new Ao(this.K.resolve("Common.IActionManagerExtended"),this.K.Ja("PowerPointWebEditor.IAppForOfficeManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.Designer.IImageToTablePaneMessenger")));this.K.register(ko,"PowerPointWebEditor.Designer.SuggestedActionsHandler").ma().oa(()=>new ko(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
this.K.resolve("PowerPointWebEditor.View.IViewEventSource")))}init(){const t=this.K.resolve("Common.IAppSettingsManager");t.jf(()=>{if(t.ka("248")){this.qO&&this.K.resolve("PowerPointWebEditor.PodsInfoSender");var P=this.K.resolve("PowerPointWebEditor.IDesignerView");const ia=A.a.instance.resolve("PowerPointWebEditor.IDesignerPane").xa;P.RBa(ia);P.T7b();this.hF||this.K.resolve("PowerPointWebEditor.IPaneManager").OP(this.K.resolve("PowerPointWebEditor.IDesignerPane"));P=null;if(t.ka("1034")&&(P=this.K.resolve("Common.App.OAuth.IOAuthManager"))){const Aa=
new Date;P.nV(t.Ha("1043"),t.Ha("1035")).then(Ka=>{const pb=+new Date-+Aa;Ka.IsSuccess?O.a.J(512262863,829,50,"PPTWebEditorDesignerPackage::Init Designer Authentication Latency: "+pb):(O.a.J(512262862,829,15,"PPTWebEditorDesignerPackage::Init Failed to get AAD token with error: "+Ka.ErrorCode+": "+Ka.ErrorMessage),O.a.J(512262861,829,50,"PPTWebEditorDesignerPackage::Init Designer Authentication Failed Latency: "+pb))}).catch(Ka=>{O.a.J(512262860,829,50,"PPTWebEditorDesignerPackage::Init Designer Authentication Failed Latency: "+
(+new Date-+Aa));O.a.J(512262859,829,15,"PPTWebEditorDesignerPackage::Init - Token retrival failed:{0}",Ka)})}P=new tm(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Box4.IClipboardDataHelper"),this.K.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),this.K.resolve("PowerPointWebEditor.Graph.IPptGraphTransactionFactory"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("PowerPointWebEditor.IDesignerPane"),
this.K.resolve("PowerPointWebEditor.IDesignerView"),this.K.resolve("PowerPointWebEditor.IDesignerViewHelper"),this.K.resolve("PowerPointWebEditor.IDesignerManager"),this.K.resolve("PowerPointWebEditor.IDesignerContext"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),this.K.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),
this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.K.resolve("PowerpointPresence.IPresenceEventHandlers"),this.K.resolve("PowerPointWebEditor.IGraphActionBlockingEventHandlers"),this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("Common.ITaskManager"),this.K.resolve("PowerPointWebEditor.UndoRedo.IUndoEventHandlers"),this.K.resolve("PowerPointWebEditor.Infrared.IIdeasContext"),this.K.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),
this.K.Ja("PowerPointWebEditor.Editor.Common.Model.IEditorRuntimeEventSource"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),P,this.K.Ja("PowerPointWebEditor.IAgendaMetrics"),this.K.Ja("PowerPointWebEditor.AgendaConverter.IAgendaConverterView"));P.vb();P.De();(new Wo(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.K.resolve("PowerPointWebEditor.IFixItContext"),this.K.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),this.K.resolve("PowerPointWebEditor.IGraphActionBlockingEventHandlers"),this.K.resolve("Common.ITaskManager"),this.K.resolve("PowerPointWebEditor.IErrorHandler"))).vb();this.K.resolve("PowerPointWebEditor.IApplicationSettings").designerHoverPreviewEnabled&&
this.K.resolve("PowerPointWebEditor.Designer.IDesignerPreviewImageView").setup();this.K.resolve("PowerPointWebEditor.Designer.IImageToTablePaneMessenger").initialize();this.K.resolve("PowerPointWebEditor.Designer.IImageToTablePane").initialize();this.K.resolve("PowerPointWebEditor.Designer.ImageToTableActor").initialize();this.K.resolve("PowerPointWebEditor.Designer.SuggestedActionsHandler").initialize();this.K.resolve("PowerPointWebEditor.IFixItManager")}else O.a.J(512262858,829,50,"Designer setting is disabled")})}dispose(){this.K.resolve("PowerPointWebEditor.IApplicationSettings").designerHoverPreviewEnabled&&
this.K.resolve("PowerPointWebEditor.Designer.IDesignerPreviewImageView").dispose();this.K.resolve("PowerPointWebEditor.Designer.IImageToTablePane").dispose();this.K.resolve("PowerPointWebEditor.Designer.ImageToTableActor").dispose();this.K.resolve("PowerPointWebEditor.Designer.SuggestedActionsHandler").dispose();this.K.resolve("PowerPointWebEditor.IFixItManager").dispose()}static main(){e.a.instance.Dc(Bc.a(new tn,0))}}Object(k.a)(tn,"PPTWebEditorDesignerPackage",null,[2,3]);class un{constructor(){this.K=
null}get name(){return"PowerPointWebEditor.PenMinutes"}$b(t){this.K=t}init(){const t=this.K.rb("Common.App.PenMinutesManager.IPenMinutesManager");t&&t.b8k()}dispose(){}static main(){e.a.instance.Dc(new un)}}Object(k.a)(un,"PPTWebEditorPenMinutesPackage",null,[2,3]);var nl=d(912);class wm{}Object(k.a)(wm,"TextToSmartArtSuggestionData",null,[]);class rk{constructor(){this.suggestions=[]}}Object(k.a)(rk,"TextToSmartArtSuggestionNotificationData",null,[]);class Wg{}Wg.cVe="ShapePresence";Wg.slideNavigation=
"SlideNavigation";Wg.aPb="WebActionId:";Wg.QU="SelectionChanged";Wg.$pc="ShapePositionChanged";Wg.Bib="Retrigger";Wg.PDe="NoSuggestions";Wg.h3j="LowSuggestions";Wg.vcd="NewSession";Wg.Iil="SlideShowStarted";Wg.serverError="ServerError";Wg.MDf="ClientSuggestionTimeOut";Object(k.a)(Wg,"ReplaceObjectResetReason",null,[]);class f{constructor(t,P,ia,Aa,Ka,pb,Nb,kc,Rc,Yc,hd,se,Ae,we,Jf,Yh,Me,mh,af){this.HWa=this.kue=this.Ocb=!1;this.pa=t;this.Fa=P;this.ua=ia;this.fc=Aa;this.D9=Ka;this.Lg=pb;this.ia=Nb;
this.jz=kc;this.GHa=Rc;this.kz=Yc;this.WEb=se;this.hma=Ae;this.k9c=we;this.Lc=Jf;this.YI=Yh;this.zb=Me;this.Qb=mh;this.eu=hd;this.kWa=af;this.nr=!1}get Ah(){return this.nr}setup(){this.Ah||(this.Pu(),this.kue=2===this.Qb.mode,this.nr=!0)}Pu(){this.pa.GG(Object(r.a)(this,this.yH,"onSelectionChanged"));this.WEb.RXb(Object(r.a)(this,this.bCe,"markedUndo"));this.Lg.kI(Object(r.a)(this,this.sB,"onActiveSlideChanged"));this.hma.N5a(Object(r.a)(this,this.M0,"onSlidePresenceChanged"));this.Lc.L9h(Object(r.a)(this,
this.KGe,"onReplaceObjectResponse"));this.GHa.M9h(Object(r.a)(this,this.LGe,"onReplaceObjectViewDragEnd"));this.D9.SXb(Object(r.a)(this,this.IEe,"onApplyReplaceObjectBlockingStateChanged"));this.Lg.bOd(Object(r.a)(this,this.Atc,"updateEditState"));this.Qb.IK(Object(r.a)(this,this.Mu,"onAppFrameModeSwitched"));this.Lc.gsf(Object(r.a)(this,this.o1g,"onApplyReplaceObjectSuggestionBeforeSelectionRemoval"));this.Lc.fsf(Object(r.a)(this,this.n1g,"onApplyReplaceObjectSuggestionAfterSelectionRemoval"));this.Lc.SFc(Object(r.a)(this,
this.sna,"onUndoRedo"))}dispose(){this.Ah&&(this.pa.Nxa(Object(r.a)(this,this.yH,"onSelectionChanged")),this.WEb.cPe(Object(r.a)(this,this.bCe,"markedUndo")),this.Lg.F5(Object(r.a)(this,this.sB,"onActiveSlideChanged")),this.hma.tPe(Object(r.a)(this,this.M0,"onSlidePresenceChanged")),this.Lc.fUk(Object(r.a)(this,this.KGe,"onReplaceObjectResponse")),this.GHa.gUk(Object(r.a)(this,this.LGe,"onReplaceObjectViewDragEnd")),this.D9.hkd(Object(r.a)(this,this.IEe,"onApplyReplaceObjectBlockingStateChanged")),
this.Qb.wY(Object(r.a)(this,this.Mu,"onAppFrameModeSwitched")),this.Lg.fPe(Object(r.a)(this,this.Atc,"updateEditState")),this.Lc.Hhh(Object(r.a)(this,this.o1g,"onApplyReplaceObjectSuggestionBeforeSelectionRemoval")),this.Lc.Ghh(Object(r.a)(this,this.n1g,"onApplyReplaceObjectSuggestionAfterSelectionRemoval")),this.Lc.mkd(Object(r.a)(this,this.sna,"onUndoRedo")),this.nr=!1)}$_a(t){return this.Vhe()?this.k9c.auc(t):!1}selectShape(t){t&&this.pa.selectShape(t,!1)}JYc(t){switch(t){case hb.a.yPa:case hb.a.iDe:case hb.a.qic:case hb.a.ric:case hb.a.sic:case hb.a.tic:case hb.a.BIa:return!0;
default:return!1}}Vhe(){return this.Ocb&&this.kue}W8g(t,P){const ia=[];if(ab.a.Wa(t))return ia;t=t.split(";");if(t.length<P)return O.a.J(37065230,829,10,"BaseReplaceObjectManager::ParseSuggestions - suggestionCount:{0}, resultLength:{1}",P,t.length),ia;for(let Aa=0;Aa<P;++Aa){const Ka=t[Aa].split(":");if(3!==Ka.length)throw P=String.format("Invalid format of suggestion item. Index: {0}, SuggestionItem: {1}",Aa,t[Aa]),O.a.J(37065232,829,50,"BaseReplaceObjectManager::ParseSuggestions - {0}",P),Error.create(P);
const pb=nl.a.Skj(Number.parseInvariant(Ka[1]));Array.add(ia,Object.assign(new wm,{index:Ka[0],labelText:ab.a.Wa(pb)?ResourceStrings.L_SmartArt:pb,imageData:this.$Rc(Ka[2])}))}return ia}o1g(){this.HWa=!0}n1g(){this.HWa=!1}sna(t,P){this.wQ(P.actionId)}$Rc(t){return ab.a.Wa(t)?null:"data:image/png;base64,"+t}Mu(t){O.a.J(36544854,829,50,"BaseReplaceObjectManager::OnAppFrameModeSwitched, frame mode switched to :{0}",t.mode);this.kue=2===t.mode}Atc(){this.Ocb||O.a.J(36544856,829,50,"BaseReplaceObjectManager::UpdateEditState, updating edit state");
this.Ocb=!0}aGb(t,P,ia,Aa){this.kWa.execute(Ka=>{const pb=Object.assign(new rk,{correlationId:t,shapeId:P,suggestions:ia});Ka.notifyTextToSmartArtSuggestion(Aa,pb)})}S8f(t,P,ia){if(P.cE)if(P.e9&&0!==t.aKa)O.a.J(38115480,829,10,"HandleReplaceObjectResponse - first reponse should have notification type : Normal. NotificationType: {0}",t.aKa);else{if(0===t.aKa){if(0>=t.Gda){O.a.J(38115482,829,50,"HandleReplaceObjectResponse - Reponse failed. CorrelationId {0}",t.correlationId);this.closeSession(P,Wg.PDe);
return}if(t.Gda<ia.replaceObjectMinRequiredSuggestions){O.a.J(38115484,829,50,"HandleReplaceObjectResponse - not enough suggestions returned. CorrelationId {0}",t.correlationId);this.closeSession(P,Wg.h3j);return}P.e9=!1;P.suggestions=this.W8g(t.UCa,t.Gda);P.cV=t.Gda;O.a.J(38115486,829,50,"HandleReplaceObjectResponse - suggestions returned: {0}. CorrelationId {1}",P.cV,t.correlationId)}else if(1===t.aKa){if(ab.a.Wa(t.UCa)){O.a.J(38115488,829,10,"HandleReplaceObjectResponse - empty suggestions. CorrelationId {0}",
t.correlationId);return}P.suggestions=this.W8g(t.UCa,t.Gda);P.uNb=new Date;ia.powerPointIdeasIsEnabled&&this.aGb(t.correlationId,P.shapeId,P.suggestions,ok.a.success)}else 2===t.aKa&&(P.nle=!1,P.shapeId=t.shapeId,this.aGb(P.correlationId,t.shapeId,P.suggestions,ok.a.success));ia=P.shape;P.slide&&P.slide.isConnected&&ia&&ia.isConnected&&this.eu.xFa(ia)&&this.Vhe()&&(1===t.aKa?this.kz.Qfh(P.correlationId):this.kz.Gpd(ia))}else O.a.J(38115478,829,15,"HandleReplaceObjectResponse - No session active. Reponse CorrelationId: {0}",
t.correlationId)}}Object(k.a)(f,"BaseReplaceObjectManager",null,[755,787]);class x{}x.none="";x.$pc="ShapePositionChanged";Object(k.a)(x,"ReplaceObjectRetriggerReason",null,[]);class N{}N.selectShape="SelectShape";N.Bib="Retrigger";N.Ufi="AugLoopRetrigger";N.Tfi="AugLoopDefault";Object(k.a)(N,"ReplaceObjectTrigger",null,[]);var ea=d(505);class ma extends f{constructor(t,P,ia,Aa,Ka,pb,Nb,kc,Rc,Yc,hd,se,Ae,we,Jf,Yh,Me,mh,af,sk,Nj,an,oo){super(kc,ia,Aa,Ka,pb,Nb,Rc,Yc,hd,se,Ae,Jf,Yh,Me,mh,sk,Nj,an,oo);
this.MT=t;this.V1c=P;this.Xak=we;this.la=af;this.EQg=this.la.replaceObjectGrayFloatieInTyping}Pu(){this.la.replaceObjectUseClientAL?this.V1c.execute(t=>{t.addEventHandler("ShapeTextConvertable",Object(r.a)(this,this.ach,"processShapeTextConvertibleClientAL"))}):this.MT.execute(t=>{t.addEventHandler("ShapeTextConvertable",Object(r.a)(this,this.$Ke,"processShapeTextConvertible"))});this.Lc.cai(Object(r.a)(this,this.efd,"onSlideShowStarted"));super.Pu()}dispose(){this.Ah&&(this.la.replaceObjectUseClientAL?
this.V1c.execute(t=>{t.removeEventHandler("ShapeTextConvertable",Object(r.a)(this,this.ach,"processShapeTextConvertibleClientAL"))}):this.MT.execute(t=>{t.removeEventHandler("ShapeTextConvertable",Object(r.a)(this,this.$Ke,"processShapeTextConvertible"))}),this.Lc.YUk(Object(r.a)(this,this.efd,"onSlideShowStarted")));super.dispose()}$Ke(t,P){if(t&&P){try{var ia=fe.a(t);var Aa=fe.a(P)}catch(pb){O.a.J(26080646,829,10,"AugmentationLoopReplaceObjectManager::OnSmartArtConvertable - Try parse aug response failed");
return}if(ia&&!isNaN(ia.sid)&&!isNaN(ia.cid)&&!isNaN(ia.shapeId)&&this.ua.Ba&&(t=new Date(ia.c),O.a.J(34181982,829,50,"ALEvent received: Slide:{0}|{1}, Shape:{2}, TriggerName:{3}, ElapsedTimeInMs:{4}",ia.sid,ia.cid,ia.shapeId,ia.t,ia.c?(new Date).getTime()-ia.c:-1),(P=this.ua.Ba.eT(ia.shapeId))&&(xb.a.contains(this.X3f(),P.get_shapeId())||"activeSlideChanged"===ia.t)))if(Aa&&!Aa.isTextConvertible)this.kz.Sna(P,!0);else{var Ka=this.jz.r5b(P.get_shapeId());if(Ka&&Ka.Ica&&(Ka=new ea.a(P,Ka.oga),this.ia.La(hb.a.zhb,
2,Ka),!Ka.$ta))return;this.$_a(P)&&this.Fja(this.ua.Ba,P,Aa&&Aa.smartArtInfo?Aa.smartArtInfo.length:0,ia.t||N.Tfi,x.none,t)}}}ach(t,P,ia,Aa){P&&Aa&&Aa.ContextId&&Aa.Payload&&this.$Ke(Aa.ContextId,Aa.Payload)}efd(){this.iUd(Wg.Iil)}yH(t,P){if(!this.Ah)O.a.J(26042393,829,50,"AugmentationLoopReplaceObjectManager::OnSelectionChanged - called before setup");else if(!this.HWa&&(P.zE.length||!this.Fa.Be||this.Fa.Be.name!==fd.a.rg)){t=this.X3f();for(let ia of this.jz)ia.cE&&!Array.contains(t,ia.shapeId)&&
this.closeSession(ia,Wg.QU);this.EQg&&!Array.contains(t,this.kz.bxb)&&this.kz.SRk()}}LGe(t,P){this.Ah?(t=this.jz.r5b(P.shape.get_shapeId()))&&t.cE&&(P=t.shape,this.closeSession(t,Wg.$pc),this.$_a(P)&&this.Fja(this.ua.Ba,P,0,N.Ufi,x.$pc)):O.a.J(26042395,829,50,"AugmentationLoopReplaceObjectManager::OnReplaceObjectViewDragEnd - called before setup")}bCe(t,P){P.Tyb&&this.wQ(P.actionId)}sB(){this.iUd(Wg.slideNavigation)}M0(t,P){if(P.M8&&P.shapes)for(const ia of P.shapes)(t=this.jz.r5b(ia))&&t.cE&&this.closeSession(t,
Wg.cVe)}KGe(t,P){(t=this.jz.B9a(P.correlationId))?this.S8f(P,t,this.la):O.a.J(26042397,829,50,"AugmentationLoopReplaceObjectManager::OnReplaceObjectResponse, No session active. Reponse CorrelationId: {0}",P.correlationId)}IEe(){if(this.Ah)for(let t of this.jz)t.X$a&&0===t.t1&&!this.fc.$c(this.ua.presentation)&&(t.X$a=!1,this.kz.Sna(t.shape,!0))}$_a(t){const P=this.jz.Jpf;return 1<=P?(O.a.J(34223842,829,50,"AugmentationLoopReplaceObjectManager::ShouldGenerateSuggestion, too many floaties[{0}] showing on the slide.",
P),!1):super.$_a(t)}Fja(t,P,ia,Aa,Ka,pb=null){try{let Nb=this.jz.r5b(P.get_shapeId());Nb&&this.closeSession(Nb,Wg.vcd);Nb=this.jz.$Kc(t,P.get_shapeId(),Aa,Ka,this.la);Nb.Csc=pb;Nb.Ica="richEditTextUnicodeChanged"===Aa;this.kz.ytc(Nb.correlationId);const kc=this.Xak.eoh(Nb);O.a.J(34144971,829,50,"AugmentationLoopReplaceObjectManager::GenerateSuggestion - CorrelationId:{0}, SlideId:{1}|{2}, ShapeId:{3}, state:{4}",Nb.correlationId,Nb.slide.sid,Nb.slide.cid,Nb.shapeId,kc);O.a.J(34097054,829,50,"AugmentationLoopReplaceObjectManager::GenerateSuggestion, text can convert to SmartArt, correlation id: {0}, returned suggestion count: {1}, should take suggestion count: {2}, trigger reason: {3}",
Nb.correlationId,ia,Math.min(ia,this.la.replaceObjectSuggestionMaxCount),Aa);ia&&this.la.replaceObjectShowFloatieOnShapeTextConvertibleResponse&&(ia=Math.min(ia,this.la.replaceObjectSuggestionMaxCount),Nb.suggestions=this.v0i(ia),Nb.cV=ia,Nb.e9=!1,this.kz.Gpd(P));0===kc&&this.la.powerPointIdeasIsEnabled&&this.aGb(Nb.correlationId,Nb.shapeId,[],ok.a.pending)}catch(Nb){O.a.J(34152522,829,10,"GenerateSuggestion failed!! {0} ",Nb.message)}}v0i(t){const P=Array(t);for(let ia=0;ia<t;ia++)Array.add(P,Object.assign(new wm,
{index:ia.toString(),labelText:ResourceStrings.l_Loading,imageData:null}));return P}wQ(t){this.Ah?this.JYc(t)||this.iUd(Wg.aPb+this.YI.I5(t)):O.a.J(26042447,829,15,"AugmentationLoopReplaceObjectManager::HandleAction - called before setup")}Acl(t){if(!this.EQg)return!1;const P=this.pa.Xd();return t.Ica&&Array.contains(P,t.shape)}closeSession(t,P){0===t.t1&&(P===Wg.PDe?this.kz.Sna(t.shape,!0):t.Ica&&this.kz.Sna(t.shape,!0,P!==Wg.vcd,this.Acl(t)),this.jz.fXc(t,P),this.la.powerPointIdeasIsEnabled&&this.aGb(t.correlationId,
t.shapeId,t.suggestions,ok.a.GIa))}iUd(t){for(let P of this.jz)this.closeSession(P,t)}X3f(){const t=this.pa.Xd(),P=[];t&&t.forEach(ia=>{Array.add(P,ia.get_shapeId())});return P}}Object(k.a)(ma,"AugmentationLoopReplaceObjectManager",f,[]);class Ha{constructor(t,P){this.disabled=!1;this.IDg=Vi.App.Um;this.la=t;this.zb=P}kph(t){this.disabled=!0;this.IDg=new Date;const P=new D.a(2,1,this.la.replaceObjectGrayFloatieTimeoutInMilliSeconds,()=>{this.disabled&&+new Date-+this.IDg>=this.la.replaceObjectGrayFloatieTimeoutInMilliSeconds&&
t()});this.zb.Eb(P)}y6k(t){const P=new D.a(2,1,550,()=>{t()});this.zb.Eb(P)}static DBl(t,P){return 7<=t&&8>=t&&1!==P}}Object(k.a)(Ha,"FlyoutAnchorTimer",null,[]);var Ua=d(364);class mb{constructor(t,P,ia,Aa,Ka,pb,Nb,kc,Rc,Yc,hd,se,Ae,we,Jf){this.Bs=null;this.HWa=!1;this.Lc=P;this.pa=t;this.jz=ia;this.ua=Aa;this.Ea=Ka;this.la=pb;this.kz=Nb;this.vi=kc;this.eu=Rc;this.hma=Yc;this.D9=hd;this.cWa=se;this.shc=Ae;this.YI=we;this.mc=Jf}Pu(){this.Lc.s9h(Object(r.a)(this,this.v3g,"onIconSuggestionNotification"));
this.pa.GG(Object(r.a)(this,this.yH,"onSelectionChanged"));this.Lc.gsf(Object(r.a)(this,this.m1g,"onApplyIconChunkingSuggestionBeforeSelectionRemoval"));this.Lc.fsf(Object(r.a)(this,this.l1g,"onApplyIconChunkingSuggestionAfterSelectionRemoval"));this.Lc.r9h(Object(r.a)(this,this.u3g,"onIconChanged"));this.hma.N5a(Object(r.a)(this,this.M0,"onSlidePresenceChanged"));this.D9.SXb(Object(r.a)(this,this.dfa,"onBlockingStateChanged"));this.shc.RXb(Object(r.a)(this,this.rgb,"onMarkedUndo"))}W1e(){this.Lc.TTk(Object(r.a)(this,
this.v3g,"onIconSuggestionNotification"));this.pa.Nxa(Object(r.a)(this,this.yH,"onSelectionChanged"));this.Lc.Hhh(Object(r.a)(this,this.m1g,"onApplyIconChunkingSuggestionBeforeSelectionRemoval"));this.Lc.Ghh(Object(r.a)(this,this.l1g,"onApplyIconChunkingSuggestionAfterSelectionRemoval"));this.Lc.STk(Object(r.a)(this,this.u3g,"onIconChanged"));this.hma.tPe(Object(r.a)(this,this.M0,"onSlidePresenceChanged"));this.D9.hkd(Object(r.a)(this,this.dfa,"onBlockingStateChanged"));this.shc.cPe(Object(r.a)(this,
this.rgb,"onMarkedUndo"))}dispose(){this.W1e()}setup(){this.Pu()}m1g(){this.HWa=!0}l1g(){this.HWa=!1}u3g(t,P){P&&this.Bs&&this.Bs.Ooc&&this.Bs.slide.sid===P.slideId.sid&&this.Bs.slide.cid===P.slideId.cid&&this.Bs.shapeId===P.shapeId&&this.Bs.Z5===P.QY&&(this.Bs.eSe=P.vEa)}M0(t,P){if(P.M8&&P.shapes&&this.Bs)for(const ia of P.shapes)this.Bs.shapeId===ia&&this.nW(Wg.cVe)}rgb(t,P){P.Tyb&&!this.JYc(P.actionId)&&this.nW(Wg.aPb+this.YI.I5(P.actionId))}JYc(t){switch(t){case hb.a.yPa:case hb.a.iDe:case hb.a.qic:case hb.a.ric:case hb.a.sic:case hb.a.tic:case hb.a.BIa:return!0;
default:return!1}}dfa(){if(this.Bs){const t=this.Bs.shape,P=this.Ea.vr(t);t&&P&&!this.cWa.$c(P)&&(this.Bs.X$a=!1,this.kz.Sna(t,!0),this.Bs.Asc=new Date,this.Bs.nW(Wg.QU))}}yH(){if(!this.HWa){var t=this.Ea.g9a(this.pa.Xd());if(t){if(this.Bs&&this.Bs.cE){if(Ua.a.Zpc(t.KY,this.Bs.KY))return;this.nW(Wg.QU)}this.$_a(t)&&this.Fja(this.ua.Ba,t,N.selectShape)}else this.Bs&&this.Bs.cE&&this.nW(Wg.QU)}}Fja(t,P,ia){this.Bs=this.jz.BQa(t,P.get_shapeId(),ia,"",this.la,P.get_smartArtModelId());this.Bs.e9=!0;this.kz.ytc(this.Bs.correlationId);
O.a.J(38279303,829,50,"ReplaceIconManager::GenerateSuggestion - CorrelationId:{0}, SlideId:{1}|{2}, ShapeId:{3}, SmartArtSubNodeId:{4}",this.Bs.correlationId,this.Bs.slide.sid,this.Bs.slide.cid,this.Bs.shapeId,this.Bs.Z5);const Aa=P.get_smartArtModelId()?this.Ea.vr(P):P;Aa?this.vi.s0i(t.cid,t.sid,Aa.get_shapeId(),this.eu.pTc(Aa),this.eu.oTc(Aa),P.get_smartArtModelId(),this.Bs.correlationId,ia,Object(r.a)(this,this.spk,"onIconSuggestionResponseSuccess"),Object(r.a)(this,this.Bgb,"onTaskFailure")):
O.a.J(38279305,829,15,"Parent ShapeNode of a {0} is null",P.get_smartArtModelId()?"SmartArtSubShape":"NormalShape")}spk(t){if(t&&t.SuggestionResult){var P=t.CorrelationId,ia=this.jz.B9a(P);if(ia)if(ia.cE){P=null;try{P=Sys.Serialization.JavaScriptSerializer.deserialize(t.SuggestionResult)}catch(Aa){O.a.J(38625546,829,15,"ReplaceIconManager::OnIconSuggestionResponseSuccess - Deserialize exception: {0}",Aa)}if(P){ia.suggestions=this.Vxk(P);ia.uNb=new Date;if(ia.e9){if(this.Oeg(ia)){O.a.J(39184097,829,
15,"ReplaceIconManager::OnIconSuggestionResponseSuccess - client suggestion timeout in {0}, expected in {1}",ia.p_b,this.la.pptIconChunkingSuggestionTimeoutMs);this.nW(Wg.MDf);return}O.a.J(38279317,829,50,"ReplaceIconManager::OnReplaceObjectResponse, response arrives before notification");ia.cV=ia.suggestions?ia.suggestions.length:0;ia.e9=!1;this.kz.Gpd(ia.shape)}this.kz.Qfh(ia.correlationId)}else this.nW(Wg.serverError),O.a.J(38279311,829,15,"ReplaceIconManager::OnIconSuggestionResponseSuccess - suggestion result is null")}else O.a.J(38279315,
829,50,"ReplaceIconManager::OnIconSuggestionResponseSuccess, sessio is not active . Selection might change to new shape, Current CorrelationId: {0}, Reponse CorrelationId: {1}",this.Bs?this.Bs.correlationId:"",P);else O.a.J(38279313,829,50,"ReplaceIconManager::OnIconSuggestionResponseSuccess, No session existing. Selection might change to new shape. Reponse CorrelationId: {0}",P)}else this.nW(Wg.serverError),O.a.J(38279309,829,15,"ReplaceIconManager::OnIconSuggestionResponseSuccess - response object or reponse suggestionresult is null")}Bgb(t){this.nW(Wg.serverError);
O.a.J(38279319,829,15,"ReplaceIconManager::OnTaskFailure - request failed with response {0}. returning true to avoid ACE",t.HttpStatusCode);return!0}$_a(t){return this.mc.Fn?t.get_smartArtModelId()&&t.get_isSVGBlipFilled()?(t=this.Ea.vr(t),!!t&&!t.vs):!1:!1}nW(t){this.Bs&&(this.kz.Sna(this.Bs.shape,!0),this.jz.fXc(this.Bs,t),this.Bs=null)}$Rc(t){return ab.a.Wa(t)?null:t.startsWith("<svg")?"data:image/svg+xml;charset=utf8,"+encodeURIComponent(t):"data:image/png;base64,"+t}Vxk(t){const P=[];if(!t||
!t.length)return P;for(let ia=0;ia<t.length;++ia){const Aa=Object.assign(new wm,{index:t[ia].Index.toString(),labelText:t[ia].Label,imageData:this.$Rc(t[ia].Render),renderData:this.$Rc(t[ia].Replace)});Array.add(P,Aa)}return P}WCi(t,P){const ia=[];if(ab.a.Wa(t)||!P)return ia;for(var Aa=0;Aa<P;++Aa){var Ka=Object.assign(new wm,{index:Aa.toString(),labelText:"",imageData:null,renderData:null});Array.add(ia,Ka)}t=t.split(";");if(t.length-1!==P)return O.a.J(38618200,829,15,"ReplaceIconManager::CreateIconSuggestionsFromNotification, the suggestion counts parsing from suggestion string do not match, expected:{0}, actural:{1} ",
ia.length,P),ia;for(Aa=0;Aa<P;++Aa)Ka=t[Aa].indexOf(":"),0>Ka?O.a.J(38279321,829,15,"ReplaceIconManager::CreateIconSuggestionsFromNotification, Suggestion string does not contain :"):ia[Aa].labelText=t[Aa].substr(Ka+1);return ia}Uxk(t){let P,ia,Aa,Ka;P="";Aa=ia=0;Ka=null;if(ab.a.Wa(t))return O.a.J(38279323,829,50,"ReplaceIconManager::ParseIconSuugestionNotification - docValue is null or empty"),{returnValue:!1,correlationId:P,Gda:ia,ZDe:Aa,suggestions:Ka};const pb=t.split("|");if(4!==pb.length)return O.a.J(38279325,
829,50,"ReplaceIconManager::ParseIconSuugestionNotification - docValue length is not equals to 4, actural:"+t.length),{returnValue:!1,correlationId:P,Gda:ia,ZDe:Aa,suggestions:Ka};P=pb[0];ia=parseInt(pb[1]);Aa=Number.parseInvariant(pb[2]);Ka=this.WCi(pb[3],ia);return{returnValue:!0,correlationId:P,Gda:ia,ZDe:Aa,suggestions:Ka}}v3g(t,P){let ia,Aa;if(({correlationId:t,Gda:P,ZDe:ia,suggestions:Aa}=this.Uxk(P.UCa)).returnValue){var Ka=this.jz.B9a(t);if(Ka)if(Ka.cE&&Ka.e9){var pb=Ka.shape;0===ia&&(0>=
P?(O.a.J(38279361,829,50,"ReplaceIconManager::OnReplaceObjectResponse, Reponse failed. CorrelationId {0}",t),this.nW(Wg.PDe)):this.Oeg(Ka)?(O.a.J(39184137,829,15,"ReplaceIconManager::OnIconSuggestionNotification - client suggestion timeout in {0}, expected in {1}",Ka.p_b,this.la.pptIconChunkingSuggestionTimeoutMs),this.nW(Wg.MDf)):(Ka.e9=!1,Ka.cV=P,Ka.suggestions=Aa,O.a.J(38279363,829,50,"ReplaceIconManager::OnReplaceObjectResponse, get response from GetReplaceObject request, correlation id: {0}, suggestion count: {1}",
Ka.correlationId,Ka.cV),this.kz.Gpd(pb)))}else O.a.J(38279331,829,50,"ReplaceIconManager::OnIconSuggestionNotification: Skip notification since: IsSessionActive {2}, IsWaitingForResponse {3}. Current CorrelationId: {0}, Reponse CorrelationId: {1}",this.Bs?this.Bs.correlationId:"",t,Ka.cE,Ka.e9);else O.a.J(38279329,829,50,"ReplaceIconManager::OnIconSuggestionNotification, No session existing. Selection might change to new shape. Reponse CorrelationId: {0}",t)}else O.a.J(38279327,829,50,"ReplaceIconManager::OnIconSuggestionResponse, IconSuggestionnotification parse failed")}Oeg(t){const P=
new Date,ia=t.oga,Aa=this.la.pptIconChunkingSuggestionTimeoutMs;return P&&ia&&0<Aa&&+P-+ia>Aa?(t.p_b=+P-+ia,!0):!1}}Object(k.a)(mb,"ReplaceIconManager",null,[]);var gb=d(696),Cb=d(985);class zb extends Sys.EventArgs{constructor(t){super();this.KY=t}}Object(k.a)(zb,"OnBeforeReplaceObjectSuggestionApplyEventArgs",Sys.EventArgs,[]);class Pb{constructor(){this.shape=null;this.action=0}}Object(k.a)(Pb,"ShowHideReplaceObjectGalleryData",null,[]);class oc{constructor(t,P,ia,Aa,Ka,pb,Nb,kc,Rc,Yc,hd,se,Ae){this.nr=
this.Ocb=!1;this.ia=P;this.Fa=ia;this.ua=Ka;this.Lg=Aa;this.fc=pb;this.HHa=Nb;this.kz=hd;this.Fb=se;this.Ea=Ae;this.pa=t;this.Lc=kc;this.jz=Rc;this.Jb=Yc}get Ah(){return this.nr}setup(){this.Ah||(this.Pu(),this.vb(),this.De(),this.nr=!0)}dispose(){this.Ah&&(this.W1e(),this.nr=!1)}Pu(){this.Lg.bOd(Object(r.a)(this,this.Atc,"updateEditState"))}W1e(){this.Lg.fPe(Object(r.a)(this,this.Atc,"updateEditState"))}vb(){this.ia.ra(hb.a.yPa,lb.a.application,Object(r.a)(this,this.yPa,"applyReplaceObjectSuggestion"),
4);this.ia.ra(hb.a.c0a,lb.a.application,Object(r.a)(this,this.c0a,"showHideReplaceObjectSuggestionsGallery"),4);this.ia.ra(hb.a.aMb,lb.a.application,Object(r.a)(this,this.c0a,"showHideReplaceObjectSuggestionsGallery"),4);this.ia.ra(hb.a.Cic,lb.a.application,Object(r.a)(this,this.RZg,"navigateReplaceObjectSuggestion"),4);this.ia.ra(hb.a.Bic,lb.a.application,Object(r.a)(this,this.RZg,"navigateReplaceObjectSuggestion"),4)}De(){const t=this.Fa.Gc(fd.a.iQ),P=this.Fa.Gc(fd.a.rg),ia=this.Fa.Gc(fd.a.lib);
t.bindAction(eb.KeyInputManager.Na(wa.a.tq,2),hb.a.aMb);P.bindAction(eb.KeyInputManager.Na(wa.a.tq,2),hb.a.aMb);ia.bindAction(eb.KeyInputManager.Na(wa.a.tq,2),hb.a.aMb);ia.bindAction(eb.KeyInputManager.Na(wa.a.J1,0),hb.a.aMb);ia.bindAction(eb.KeyInputManager.Na(wa.a.Naa,0),hb.a.Cic);ia.bindAction(eb.KeyInputManager.Na(wa.a.zga,0),hb.a.Bic)}Atc(){this.Ocb||O.a.J(38279365,829,50,"ReplaceObjectActor::UpdateEditState, updating edit state");this.Ocb=!0}yPa(t,P,ia,Aa,Ka){if(!this.Ah)return O.a.J(33698392,
829,15,"ReplaceObjectActor::ApplyReplaceObjectSuggestion - called before setup"),16;P=this.ua.presentation;if(!this.ua.Ba||!P||this.fc.$c(P))return 16;if(1===ia)return 32;ia=!0;Aa=null;Object(Lh.a)(gb.a,Ka)?Aa=Ka:Object(Lh.a)(Cb.a,Ka)&&(Aa=Ka.KGc,ia=!1);Ka=new Ua.a(Q.a.PE(Aa.ActiveSlideSid,Aa.ActiveSlideCid),Aa.ShapeId,Aa.SmartArtSubNodeId);const pb=new zb(Ka);this.HHa.xJk(pb);const Nb=this.jz.C9a(Ka);if(Nb&&Nb.shapeId===Aa.ShapeId){let kc=null;1===Nb.t1&&(kc=this.Ea.vr(Nb.shape));Ka=this.Jb.zd(15,
void 0,()=>{1===Nb.t1||this.pa.xs()||(this.Lc.Uid(),this.pa.Qh(),this.Lc.Tid())},()=>{kc&&(this.Lc.Uid(),this.pa.selectShape(kc,!0),this.Lc.Tid())});try{Ka.nc(P),Ka.jd=Aa.SmartArtSubNodeId?hb.a.YBf:t,P.HJb=Aa,Nb.HGc=Aa.SuggestionSid,Nb.uPd=Aa.Label,Nb.zT=!0,Nb.Bsc=new Date,O.a.J(33698394,829,50,"ReplaceObjectActor::ApplyReplaceObjectSuggestion - CorrelationId: {0}, ActionId: {1}, SuggestionSid: {2}",Aa.CorrelationId,t,Aa.SuggestionSid)}finally{Ka&&Ka.dispose()}Nb.nle=!0;Nb.X$a=!0;ia&&Nb.aCe();0===
Nb.t1?this.fc.Zv(P,t):kc?this.fc.Bra(P,kc,this.Fb.Ma,t):O.a.J(38854750,808,15,"Invalid smartArtShape")}else O.a.J(33863682,808,15,"Couldn't find active replaceObjectContext");return 32}c0a(t,P,ia,Aa,Ka){if(!this.Ah)return O.a.J(33698398,829,15,"ReplaceObjectActor::ShowHideReplaceObjectSuggestionsGallery - called before setup"),16;P=this.ua.presentation;if(!this.ua.Ba||!P||this.fc.$c(P))return 16;if(1===ia)return 32;ia=null;P=0;if(t===hb.a.c0a){t=Object(R.a)(Pb,Ka);if(!t)return 16;ia=t.shape;P=t.action}else if(t===
hb.a.aMb){t=this.pa.Xd();if(1!==t.length)return 32;ia=t[0]}if(!ia)return O.a.J(33698400,829,10,"ReplaceObjectActor::ShowHideReplaceObjectSuggestionsGallery, null shape."),16;t=this.jz.C9a(ia.KY);if(!t||!this.Ocb&&t&&0===t.t1)return 2;if(t&&t.cE&&t.shapeId===ia.get_shapeId())switch(this.pa.ij(),this.Fa.Ed(),P){case 0:this.kz.Qql(t.correlationId);break;case 1:this.kz.nB.isVisible||this.kz.hXe(t.correlationId);break;case 2:this.kz.ibe(ia)}return 32}RZg(t,P,ia){if(!this.Ah)return O.a.J(33698396,829,15,
"ReplaceObjectActor::NavigateReplaceObjectSuggestion - called before setup"),16;P=this.ua.presentation;return this.ua.Ba&&P&&!this.fc.$c(P)?1===ia?32:this.kz.nB.isVisible?t===hb.a.Cic?(this.kz.Cic(),32):t===hb.a.Bic?(this.kz.Bic(),32):16:16:16}}Object(k.a)(oc,"ReplaceObjectActor",null,[]);class Ec{constructor(t,P){this.c$=t;this.W1c=P}initialize(){this.c$.execute(t=>{t.registerSimpleRemoteWorkflow(this.W1c.nG,this.W1c.Frb,this.W1c.pJb,this.W1c.Pqb)})}}Object(k.a)(Ec,"ReplaceObjectAugLoopRuntimeManager",
null,[]);var Xc=d(1081),Ac;(function(t){t[t.textToSmartArt=0]="textToSmartArt";t[t.iconChunking=1]="iconChunking"})(Ac||(Ac={}));Object(k.b)("ReplaceObjectType",Ac);class zd{constructor(t,P){this.E4a=this.qS=this.la=null;this.shapeId=0;this.Z5=null;this.t1=0;this.Ica=!1;this.HGc=0;this.uPd=null;this.vie=this.jie=this.X$a=this.zT=!1;this.Asc=this.Bsc=this.Q_e=this.uNb=this.Fsc=this.DLa=this.Csc=this.oga=null;this.gvb=this.urc=0;this.jId=this.e5a=this.Bpa=null;this.e9=!1;this.suggestions=null;this.p_b=
this.cV=0;this.nle=!1;this.Oib=null;this.Ooc=!1;this.eSe=null;this.aDd=!1;this.NDb=[];this.vi=t;this.Zbc=P;this.reset()}BQa(t,P,ia,Aa,Ka,pb){this.cE&&this.nW(Wg.vcd);if(!t)throw Error.argumentNull("slide");const Nb=t.Pwb(new Ua.a(t?t.Cb:null,P,pb));if(!Nb)throw Error.invalidOperation(String.format("slide doesn't have shape corresponds to shapeId: {0}",P));this.qS=t;this.E4a=Nb;this.shapeId=P;this.Z5=pb;this.Bpa=Ca.a.create().toString();this.aDd=!0;this.e5a=ia;this.jId=Aa;this.la=Ka;this.oga=new Date;
this.t1=this.Qjj();return this.correlationId}$Kc(t,P,ia,Aa,Ka){return this.BQa(t,P,ia,Aa,Ka,null)}Qjj(){const t=this.shape;return this.la.iconChunkingEnabled&&t&&this.Z5&&t.get_isSVGBlipFilled()?1:0}nW(t){if(this.cE&&!this.QQj(this.correlationId)){const P={};P.SuggestionCount=this.cV;P.ClientSuggestionTimeoutInMs=this.p_b;P.IsApplied=this.zT;P.AppliedSuggestionId=this.zT?this.HGc.toString():"";P.AppliedSuggestionLabel=this.zT?this.uPd:"";P.IsFloatieShown=this.jie;P.IsGalleryShown=this.vie;P.Trigger=
this.trigger;P.RetriggerReason=this.oZk;P.ResetReason=t;P.IconId=this.la.replaceObjectIconType;P.SlideCID=this.slide.cid;P.SlideSID=this.slide.sid;P.ShapeID=this.shapeId;P.AnimId=this.la.replaceObjectAnimId;P.AnimEnabled=this.la.GJb;P.GalleryHoverEnabled=this.la.replaceObjectGalleryHoverEnabled;P.ReplaceSuggestionType=Ac[this.t1];P.SeeMoreButtonClicked=this.Ooc;P.SeeMoreIconName=this.Ooc?this.eSe:"";this.oga&&(P.SessionLiveTimeInMs=+new Date-+this.oga);this.Z5&&(P.SmartArtSubNodeId=this.Z5);this.DLa&&
this.uNb&&this.uNb>this.DLa&&(P.SuggestionsReadyInMs=+this.uNb-+this.DLa);0<this.urc&&(P.SuggestionsDisplayedForMs=this.urc);0<this.gvb&&(P.FloatieDisplayedForMs=this.gvb);this.DLa&&this.oga&&this.DLa>this.oga&&(P.FloatieReadyInMs=+this.DLa-+this.oga);this.oga&&this.Csc&&this.oga>this.Csc&&(P.TriggeredByAugLoopInMs=+this.oga-+this.Csc);this.Bsc&&this.Asc&&this.Asc>this.Bsc&&(P.SuggestionAppliedInMs=+this.Asc-+this.Bsc);if(0<this.suggestions.length){t=[];for(let ia=0;ia<this.suggestions.length;ia++)Array.add(t,
this.suggestions[ia].labelText);P.SuggestionLabels=mk.c(t)}1!==this.t1||ab.a.Wa(this.Oib)||(t=Xc.a.F9a(this.Oib))&&t.hasChildNodes()&&(Xc.a.E2b(),Xc.a.aRk(this.Oib));this.vi.UWk(this.correlationId,mk.c(P),void 0,Object(r.a)(this,this.jjc,"onFailureCallback"));this.rfk(this.correlationId)}this.reset()}reset(){this.aDd=!1;this.qS=null;this.nle=this.vie=this.jie=this.X$a=this.zT=this.Ica=!1;this.jId=this.e5a=this.Bpa="";this.suggestions=[];this.HGc=0;this.uPd="";this.e9=!1;this.p_b=this.cV=0;this.Asc=
this.Bsc=this.Q_e=this.uNb=this.Fsc=this.DLa=this.Csc=this.oga=null;this.t1=this.gvb=this.urc=0;this.Oib="";this.E4a=null;this.Ooc=!1;this.eSe=""}QQj(t){return this.NDb?Array.contains(this.NDb,t):!1}rfk(t){this.NDb&&!Array.contains(this.NDb,t)&&(Array.add(this.NDb,t),O.a.J(512496034,829,50,"ReplaceObjectContext::MarkCorrelationAsHandled - CorrelationId: {0}; handled correlations count: {1}",t,this.NDb.length))}jjc(t){O.a.J(512496033,829,15,"ReplaceObjectContext::OnFailureCallback - request failed with: {0}. returning true to prevent ACE.",
t.HttpStatusCode);return!0}aCe(){this.vXg(2,4)}wfk(){this.vXg(3,3)}vXg(t,P){this.Zbc&&this.Zbc.execute(ia=>{const Aa=Object.assign(new yo.a,{cardId:um.a.wwh,actionType:t,actionEngagement:P});ia.Ncd(Aa)})}get slide(){return this.qS}get shape(){return this.E4a}get correlationId(){return this.Bpa}get trigger(){return this.e5a}get oZk(){return this.jId}get cE(){return this.aDd}get appSettings(){return this.la}get KY(){return new Ua.a(this.slide?this.slide.Cb:null,this.shapeId,this.Z5)}}Object(k.a)(zd,
"ReplaceObjectContext",null,[1004]);class ue{constructor(){this.va=new wg.a}xJk(t){this.va.raiseEvent("ReplaceObjectBSA",t)}V8h(t){this.va.addHandler("ReplaceObjectBSA",t)}DTk(t){this.va.removeHandler("ReplaceObjectBSA",t)}Wdh(t){this.va.raiseEvent("ReplaceObjectSPOver",t)}A$h(t){this.va.addHandler("ReplaceObjectSPOver",t)}FUk(t){this.va.removeHandler("ReplaceObjectSPOver",t)}Vdh(t){this.va.raiseEvent("ReplaceObjectSPOut",t)}z$h(t){this.va.addHandler("ReplaceObjectSPOut",t)}EUk(t){this.va.removeHandler("ReplaceObjectSPOut",
t)}BJk(t){this.va.raiseEvent("ReplaceObjectViewDE",t)}M9h(t){this.va.addHandler("ReplaceObjectViewDE",t)}gUk(t){this.va.removeHandler("ReplaceObjectViewDE",t)}}Object(k.a)(ue,"ReplaceObjectEventSource",null,[1001,1002,1003]);class bf extends f{constructor(t,P,ia,Aa,Ka,pb,Nb,kc,Rc,Yc,hd,se,Ae,we,Jf,Yh,Me,mh,af,sk,Nj){super(pb,t,P,ia,Aa,Ka,Nb,kc,Rc,Yc,hd,Ae,we,Jf,Yh,mh,af,sk,Nj);this.li=kc.B_f();this.vi=se;this.la=Me}yH(t,P){if(!this.Ah)O.a.J(25306451,829,15,"ReplaceObjectManager::OnSelectionChanged - called before setup");
else if(!this.HWa&&P.zE.length)if(t=this.pa.Xd(),1!==t.length)this.li.cE&&this.closeSession(this.li,Wg.QU);else{t=t[0];if(this.li.cE){if(this.li.shapeId===t.get_shapeId())return;this.closeSession(this.li,Wg.QU)}this.$_a(t)&&this.Fja(this.ua.Ba,t,N.selectShape,"")}}LGe(t,P){this.Ah?this.li.cE&&this.li.shape===P.shape&&(t=this.li.shape,this.closeSession(this.li,Wg.$pc),this.$_a(t)&&this.Fja(this.ua.Ba,t,N.Bib,x.$pc)):O.a.J(25306453,829,15,"ReplaceObjectManager::OnReplaceObjectViewDragEnd - called before setup")}bCe(t,
P){P.Tyb&&this.wQ(P.actionId)}sB(){this.li.cE&&this.closeSession(this.li,Wg.slideNavigation)}M0(t,P){this.li.cE&&P.M8&&P.shapes&&Array.contains(P.shapes,this.li.shapeId)&&this.closeSession(this.li,Wg.cVe)}KGe(t,P){P.correlationId!==this.li.correlationId?O.a.J(25236289,829,15,"ReplaceObjectManager::OnReplaceObjectResponse, Current CorrelationId: {0}, Reponse CorrelationId: {1}",this.li.correlationId,P.correlationId):this.S8f(P,this.li,this.la)}IEe(){this.Ah&&this.li.X$a&&0===this.li.t1&&!this.fc.$c(this.ua.presentation)&&
(this.li.X$a=!1,this.kz.Sna(this.li.shape,!0))}Fja(t,P,ia,Aa=""){try{const Ka=this.li.$Kc(t,P.get_shapeId(),ia,Aa,this.la);this.li.e9=!0;this.kz.ytc(this.li.correlationId);this.vi.MWf(t.cid,t.sid,P.get_shapeId(),Ka,ia,this.eu.pTc(P),this.eu.oTc(P),void 0,Object(r.a)(this,this.Bgb,"onTaskFailure"));this.la.powerPointIdeasIsEnabled&&this.aGb(Ka,this.li.shapeId,this.li.suggestions,ok.a.pending)}catch(Ka){O.a.J(34152532,829,15,"GenerateSuggestion failed!! {0} ",Ka.message)}}Bgb(t){O.a.J(36966422,829,
15,"ReplaceObjectManager::OnTaskFailure - request failed with response {0}. returning true to avoid ACE",t.HttpStatusCode);return!0}wQ(t){this.Ah?this.li.cE&&!this.JYc(t)&&this.closeSession(this.li,Wg.aPb+this.YI.I5(t)):O.a.J(25306497,829,15,"ReplaceObjectManager::HandleAction - called before setup")}closeSession(t,P){t.Ica&&this.kz.Sna(t.shape,!0);t.nW(P);this.la.powerPointIdeasIsEnabled&&this.aGb(t.correlationId,t.shapeId,t.suggestions,ok.a.GIa)}}Object(k.a)(bf,"ReplaceObjectManager",f,[]);var Ce=
d(21);class qg{constructor(t){this.nO=-1;this.$$cu=this.get_current;this.$$mn=this.moveNext;this.$$rst=this.reset;this.joe=Array.clone(t)}get_current(){if(-1===this.nO||this.nO>=this.joe.length)throw Error.invalidOperation();return this.joe[this.nO]}moveNext(){this.nO++;return this.nO<this.joe.length}reset(){this.nO=-1}}Object(k.a)(qg,"ArrayEnumerator",null,[137]);class Df{constructor(t){this.FHa=[];this.$$ge=this.getEnumerator;this.Vak=t}getEnumerator(){return new qg(this.FHa)}[Symbol.iterator](){return Object(Ce.a)(this.getEnumerator())}fXc(t,
P){t&&(t.nW(P),Array.remove(this.FHa,t))}B9a(t){for(const P of this.FHa)if(P.correlationId===t)return P;return null}C9a(t){for(const P of this.FHa)if(Ua.a.Zpc(t,P.KY))return P;return null}w3f(t,P){for(const ia of this.FHa)if(ia.shapeId===t&&(!P&&!ia.Z5||P&&P===ia.Z5))return ia;return null}r5b(t){return this.w3f(t,null)}B_f(){return 0<this.FHa.length?this.FHa[0]:null}BQa(t,P,ia,Aa,Ka,pb){let Nb=this.C9a(new Ua.a(t.Cb,P,pb));Nb&&this.fXc(Nb,Wg.vcd);Nb=this.Vak(t,P,ia,Aa,Ka,pb);Array.add(this.FHa,Nb);
return Nb}$Kc(t,P,ia,Aa,Ka){return this.BQa(t,P,ia,Aa,Ka,null)}get Jpf(){let t=0;this.FHa.forEach(P=>{P.cE&&t++});return t}}Object(k.a)(Df,"ReplaceObjectMultipleContextManager",null,[754,136]);class Bi{constructor(t,P,ia,Aa,Ka,pb,Nb,kc,Rc,Yc){this.ua=t;this.MQg=P;this.Yak=ia;this.eu=pb;this.GHa=Ka;this.jz=Aa;this.nB=Nb;this.Fa=kc;this.Re=Rc;this.Ea=Yc;this.nr=!1;this.ayc=-1}get Ah(){return this.nr}get bxb(){return this.ayc}setup(){this.Ah||(this.GHa.V8h(Object(r.a)(this,this.A1g,"onBeforeReplaceObjectSuggestionApply")),
this.GHa.A$h(Object(r.a)(this,this.e5g,"onReplaceObjectSuggestionPointerOver")),this.GHa.z$h(Object(r.a)(this,this.d5g,"onReplaceObjectSuggestionPointerOut")),this.nr=!0)}dispose(){this.Ah&&(this.GHa.DTk(Object(r.a)(this,this.A1g,"onBeforeReplaceObjectSuggestionApply")),this.GHa.FUk(Object(r.a)(this,this.e5g,"onReplaceObjectSuggestionPointerOver")),this.GHa.EUk(Object(r.a)(this,this.d5g,"onReplaceObjectSuggestionPointerOut")),this.nr=!1)}A1g(t,P){if(!this.ua.Ba)throw Error.argumentNull("ActiveSlide is null");
(t=this.ua.Ba.Pwb(P.KY))&&this.Sna(t,!1)}e5g(t,P){this.ua.Ba&&(t=new Ua.a(this.ua.Ba.Cb,P.shapeId,P.QY),(t=this.ua.Ba.Pwb(t))&&this.gXe(t,P.hbg))}d5g(t,P){this.ua.Ba&&(t=new Ua.a(this.ua.Ba.Cb,P.shapeId,P.QY),(t=this.ua.Ba.Pwb(t))&&this.m7b(t))}gXe(t,P){let ia=t;t.get_smartArtModelId()&&(ia=this.Ea.vr(t));if(t=this.i5f(ia))this.bvh(ia,!1),t.gXe(P)}m7b(t){let P=t;t.get_smartArtModelId()&&(P=this.Ea.vr(t));if(t=this.i5f(P))this.bvh(P,!0),t.m7b()}i5f(t){return t&&!t.get_smartArtModelId()&&Object(R.a)(117,
t.sc(this.Re))?this.Yak.VG(t):null}qRi(t){return t&&Object(R.a)(117,t.sc(this.Re))?this.MQg.VG(t):null}d8d(t){return t&&Object(R.a)(117,t.sc(this.Re))?this.MQg.EF(t):null}Gpd(t){if(!this.Ah)O.a.J(25306499,829,15,"ReplaceObjectPresenter::ShowShapeReplaceObjectView - called before setup");else if(t){var P=this.qRi(t);if(P){const ia=this.jz.C9a(t.KY);!ia||ia.Ica&&this.bxb!==ia.shapeId||(ia.Ica?this.bxb===ia.shapeId&&(P.BNc(),this.ayc=-1):(this.Sna(t,!0,!(this.nB.QZa&&this.nB.isVisible&&Ua.a.Zpc(t.KY,
this.nB.QZa.KY))),P.display()),ia.Ica=!0)}}}SRk(){if(-1!==this.bxb&&this.ua.Ba){var t=this.ua.Ba.eT(this.bxb);t&&this.Sna(t,!0)}}Sna(t,P,ia=!0,Aa=!1){this.Ah?t&&(P&&this.m7b(t),ia&&this.ibe(t),P=this.d8d(t))&&(Aa?(P.BMc(),this.ayc=t.get_shapeId()):(this.bxb===t.get_shapeId()&&(this.ayc=-1),P.visible&&P.dismiss(),(Aa=this.jz.C9a(t.KY))&&t.get_shapeId()===Aa.shapeId&&(Aa.Ica=!1))):O.a.J(25306501,829,15,"ReplaceObjectPresenter::RemoveShapeReplaceObjectView - called before setup")}ytc(t){this.nB.ytc(t)}Qql(t){if(this.Ah)if(this.nB.isVisible){const P=
this.jz.B9a(t);P&&P.cE&&P.correlationId===t&&this.m7b(P.shape);this.ibe(P.shape)}else this.hXe(t);else O.a.J(25306503,829,15,"ReplaceObjectPresenter::ToggleSuggestionsGalleryView - called before setup")}ibe(t){this.nB.isVisible&&this.nB.QZa&&Ua.a.Zpc(this.nB.QZa.KY,t.KY)&&(this.nB.dismiss(),(t=this.d8d(this.nB.QZa.shape))&&t.root&&(t.root.style.zIndex="0"),this.Fa.Bj(fd.a.lib,!1))}hXe(t){const P=this.jz.B9a(t);if(P&&P.correlationId===t&&P.cE){var ia=this.d8d(P.shape);if(ia){var Aa=ia.root;Aa?this.nB.isVisible&&
this.nB.QZa&&!Ua.a.Zpc(this.nB.QZa.KY,P.KY)||(Aa=this.eu.getBounds(Aa),this.nB.show(t,Aa.x,Aa.y),ia.root.style.zIndex=String(v.AFrameworkApplication.Aa.oqb),this.Fa.Bj(fd.a.lib,!0),P.vie=!0):O.a.J(25306508,829,10,"ReplaceObjectPresenter::ShowSuggestionsGallery - rootElem is null")}else O.a.J(25306506,829,10,"ReplaceObjectPresenter::ShowSuggestionsGallery - replaceObjectView is null")}}Qfh(t){this.Ah?this.nB.isVisible&&this.hXe(t):O.a.J(25306510,829,15,"ReplaceObjectPresenter::RefreshSuggestionsGallery - called before setup")}Cic(){if(this.Ah){var t=
this.nB.P5d();t&&(-1===t?this.nB.Fw(0,!0):(this.nB.Fw(t,!1),this.nB.Fw(t-1,!0)))}else O.a.J(25306512,829,15,"ReplaceObjectPresenter::NavigateReplaceObjectSuggestionPrev - called before setup")}Bic(){if(this.Ah){var t=this.nB.P5d();t+1!==this.nB.Ljj()&&(-1===t?this.nB.Fw(0,!0):(this.nB.Fw(t,!1),this.nB.Fw(t+1,!0)))}else O.a.J(25306514,829,15,"ReplaceObjectPresenter::NavigateReplaceObjectSuggestionNext - called before setup")}bvh(t,P){t&&(t=Object(R.a)(117,t.sc(this.Re)))&&((t=t.xa)?t.Pd(P):O.a.J(25306516,
829,10,"ReplaceObjectPresenter::ShowHideShape,shapeViewDiv is null"))}}Object(k.a)(Bi,"ReplaceObjectPresenter",null,[787]);class wi{constructor(){this.shapeId=this.slideCid=this.slideSid=0;this.mHb=null;this.vIe=0}}Object(k.a)(wi,"TaskItem",null,[]);class Pf{constructor(t,P,ia){this.Geb=[];this.vi=t;this.eu=P;this.drg=ia}XWi(t,P,ia){for(let Aa=0;Aa<this.Geb.length;Aa++)if(this.Geb[Aa].slideSid===t&&this.Geb[Aa].slideCid===P&&this.Geb[Aa].shapeId===ia)return this.Geb[Aa];return null}eoh(t){var P=this.XWi(t.slide.sid,
t.slide.cid,t.shapeId);if(P)return P.mHb=t,P.vIe++,1;const ia=Object.assign(new wi,{slideSid:t.slide.sid,slideCid:t.slide.cid,shapeId:t.shapeId,vIe:0,mHb:null});Array.add(this.Geb,ia);t.e9=!0;P=t.correlationId;const Aa=t.slide,Ka=t.shape;this.vi.MWf(Aa.cid,Aa.sid,Ka.get_shapeId(),P,t.trigger,this.drg?this.eu.pTc(Ka):this.eu.C5b(Ka),this.drg?this.eu.oTc(Ka):this.eu.B5b(Ka),()=>{this.z6g(ia)},pb=>{this.z6g(ia);O.a.J(36966425,829,15,"SendGenerateReplaceObjectRequest - request failed with response {0}. returning true to avoid ACE.",
pb.HttpStatusCode);return!0});return 0}z6g(t){Array.remove(this.Geb,t);t.mHb&&t.mHb.cE&&(O.a.J(34144975,829,50,"ReplaceObjectRequestManager - Send pending request: {0}; {1} were in queue and skipped",t.mHb.correlationId,t.vIe-1),this.eoh(t.mHb))}}Object(k.a)(Pf,"ReplaceObjectRequestManager",null,[753]);class Ci{constructor(t){this.Wue=!0;this.$$cu=this.get_current;this.$$mn=this.moveNext;this.$$rst=this.reset;this.Qp=t}get_current(){return this.Qp}moveNext(){return this.Wue?(this.Wue=!1,!0):!1}reset(){this.Wue=
!0}}Object(k.a)(Ci,"SingleEnumerator",null,[137]);class Tj{constructor(t){this.$$ge=this.getEnumerator;this.li=t}getEnumerator(){return new Ci(this.li)}[Symbol.iterator](){return Object(Ce.a)(this.getEnumerator())}fXc(t,P){t&&t===this.li&&t.nW(P)}B9a(){return this.li}C9a(){return this.li}r5b(){return this.li}w3f(){return this.li}B_f(){return this.li}BQa(t,P,ia,Aa,Ka,pb){this.li.BQa(t,P,ia,Aa,Ka,pb);return this.li}$Kc(t,P,ia,Aa,Ka){return this.BQa(t,P,ia,Aa,Ka,null)}get Jpf(){return this.li.cE?1:0}}
Object(k.a)(Tj,"ReplaceObjectSingleContextManager",null,[754,136]);var qh=d(131);class Uj{constructor(t,P,ia,Aa,Ka){this.Gea=null;this.wEb=this.oqe=!1;this.jma=null;this.visible=!1;this.hu=t;this.KT=P;this.v9=ia;this.eu=Ka;this.dgc=Aa;this.nr=!1}get Ah(){return this.nr}setup(){this.Ah||(this.jma=new Lb.a,this.Gea=this.dgc.YEi(this.jma.xa),this.KT&&!this.KT.Al&&this.KT.RU&&(this.KT.RU.appendChild(this.jma),this.Pd(!1),this.wEb=!0,this.KT.dra(this,3),this.visible=this.KT.yQ||this.KT.Tn),this.nr=!0)}Im(){O.a.J(25306526,
829,15,"ReplaceObjectSuggestionPreviewView::BuildDomElements - shouldn't be called")}eD(){}Yp(){if(!this.Ah)return O.a.J(36827549,829,15,"ReplaceObjectSuggestionPreviewView::GetVisibleBoundingRegion - called before setup"),null;if(!this.oqe||!this.Gea.Ah||!this.Gea.GN)return null;const t=cb.a.En(this.Gea.GN.xa.style.left),P=cb.a.En(this.Gea.GN.xa.style.top),ia=cb.a.En(this.Gea.GN.xa.style.width),Aa=cb.a.En(this.Gea.GN.xa.style.height);return new qh.a(new Zb.a(t,P),new Zb.a(t+ia,P),new Zb.a(t+ia,P+
Aa),new Zb.a(t,P+Aa))}HN(){return!1}Jx(){}My(){}setPosition(){}Hj(){this.wEb=!0;this.Ur()}Nq(){this.wEb=!0;this.Ur()}Ru(){this.wEb=!0;this.Ur()}setZIndex(t){this.jma&&this.jma.DB(t)}JE(){}YD(){return null}yB(){return[]}draw(){}dispose(){this.v9();this.Ah&&(this.Gea.dispose(),this.jma.xa.parentNode&&this.jma.yq(),this.jma=null,this.nr=!1)}gXe(t){this.Ah?(this.lpc(t),this.Ur()):O.a.J(25306562,829,15,"ReplaceObjectSuggestionPreviewView::ShowSuggestionPreview - called before setup")}m7b(){this.Ah?this.Lra():
O.a.J(25306564,829,15,"ReplaceObjectSuggestionPreviewView::HideSuggestionPreview - called before setup")}lpc(t){this.Ah?(this.Gea.poa(t),this.Pd(!0)):O.a.J(25306566,829,15,"ReplaceObjectSuggestionPreviewView::SetGlyph - called before setup")}Lra(){this.Ah?(this.Gea.dismiss(),this.Pd(!1)):O.a.J(25306568,829,15,"ReplaceObjectSuggestionPreviewView::ClearGlyph - called before setup")}setSelection(){}Ur(){if(this.oqe&&this.wEb){var t=this.eu.C5b(this.hu),P=this.eu.B5b(this.hu);this.ih(t,P);this.jma&&(t=
this.eu.Yfj(this.hu),aj.a.setRotation(this.jma.xa,t));this.wEb=!1}}Pd(t){this.oqe=t;this.jma.Pd(t)}ih(t,P){this.Gea&&this.Gea.ih(t,P)}}Object(k.a)(Uj,"ReplaceObjectSuggestionPreviewView",null,[983,984,284,285,106,787]);var ol=d(265),pl=d(223),Lp=d(249),Do=d(984),Mp=d(983);class rp extends Sys.EventArgs{constructor(t){super();this.shape=t}}Object(k.a)(rp,"ReplaceObjectViewDragEndEventArgs",Sys.EventArgs,[]);class vn{constructor(t,P,ia,Aa,Ka,pb,Nb,kc,Rc,Yc,hd){this.TSg=!1;this.g$=this.$Va=null;this.ia=
Ka;this.He=pb;this.qd=Nb;this.jz=kc;this.HHa=Rc;this.dgc=Aa;this.v9=ia;this.hu=t;this.KT=P;this.bA=!1;this.la=Yc;this.Tye=hd;this.nr=this.visible=!1}get Ah(){return this.nr}Uvb(){return this.jz.C9a(this.hu.KY)}setup(){if(!this.Ah){var t=this.Uvb();t=t?t.t1:0;this.TSg=1===t;this.g$=new Lb.a;this.$Va=this.dgc.pCi(this.g$,vn.OHc,Object(r.a)(this,this.zok,"onFlyoutAnchorClick"),Object(r.a)(this,this.Aok,"onFlyoutAnchorHover"),t);this.KT&&!this.KT.Al&&this.KT.RU&&(this.Im(this.KT.RU),this.KT.dra(this,
3));this.nr=!0}}BNc(){this.Ah?this.$Va&&this.$Va.BNc():O.a.J(512496032,829,15,"ShapeReplaceObjectView::EnableFloatie - called before setup")}BMc(){this.Ah?this.$Va&&this.$Va.BMc():O.a.J(512496031,829,15,"ShapeReplaceObjectView::DisableFloatie - called before setup")}display(){if(!this.Ah)O.a.J(512496030,829,15,"ShapeReplaceObjectView::Display - called before setup");else if(!this.visible){this.Ur();this.$Va.show();this.visible=!0;this.FOb();var t=this.Uvb();if(t){t.jie=!0;const P=new Date;t.DLa||
(t.DLa=P);t.Fsc=P;O.a.J(512496029,829,50,"ShapeReplaceObjectView::Display - trigger: {0}, correlationId: {1}",t.trigger,t.correlationId)}}}get root(){return this.Ah?this.g$.xa:(O.a.J(512496027,829,15,"ShapeReplaceObjectView::Root - called before setup"),null)}dismiss(){if(this.Ah){this.$Va.dismiss();this.visible=!1;var t=this.Uvb();t&&(t.Ica=!1,t.Fsc&&(t.gvb+=+new Date-+t.Fsc,O.a.J(512496025,829,50,"ShapeReplaceObjectView::Dismiss - FloatieDisplayedForMs: {0}; TimeFloatieRenderedLast: {1}; trigger: {2}; correlation: {3}",
t.gvb,t.Fsc,t.trigger,t.correlationId)))}else O.a.J(512496026,829,15,"ShapeReplaceObjectView::Dismiss - called before setup")}Im(){this.visible=!1;this.He.addCssClass(this.g$.xa,"replaceObjectBody");document.body.appendChild(this.g$.xa);this.qd.VXb(Object(r.a)(this,this.onResize,"onResize"));this.Ur()}eD(){}Yp(){return null}HN(){return!1}Jx(){}My(){}setPosition(){}Hj(){}Nq(){}Ru(){}setZIndex(){}JE(t){if(this.Ah){if(t)this.visible=!1,this.FOb();else if(this.bA){const P=new rp(this.hu);this.HHa.BJk(P)}this.bA=
t}else O.a.J(512496024,829,15,"ShapeReplaceObjectView::SetDrag - called before setup")}YD(){return null}yB(){return[]}draw(){this.Ah?this.Ur():O.a.J(512496023,829,15,"ShapeReplaceObjectView::Draw - called before setup")}setSelection(){}dispose(){this.v9();this.Ah&&(this.qd.vih(Object(r.a)(this,this.onResize,"onResize")),this.g$&&(this.g$.xa.parentNode&&this.g$.yq(),this.He.removeCssClass(this.g$.xa,"replaceObjectBody")),this.dismiss(),this.$Va.dispose(),this.g$=null,this.nr=!1)}FOb(){this.g$.xa.style.visibility=
this.visible?Xa.a.visible:Xa.a.hidden;const t=this.Uvb();t&&(t.Ica=this.visible)}Ur(){let t=null;var P=this.KT.RU;P&&(t=this.He.ii(P.xa));t?(P=t.x-(vn.OHc+10),this.TSg&&this.KT&&this.KT.Md&&(P=this.KT.Md.Ld.Me(this.hu.nx,0),P=t.x+P+10),aj.a.Snd(this.g$.xa,1),this.g$.setPosition(1*P,t.y),this.gxl(1*P,t.y)):O.a.J(512496022,829,15,"ShapeReplaceObjectView::UpdateView - elementBound is null")}gxl(t,P){if(this.Tye.isVisible){var ia=this.Uvb(),Aa=this.Tye.QZa;Aa&&ia&&Aa.correlationId===ia.correlationId&&
this.Tye.updatePosition(t,P)}}zok(t){if(t.lA!==Sys.UI.MouseButton.leftButton)return!1;this.ia.La(hb.a.c0a,2,Object.assign(new Pb,{shape:this.hu,action:0}));return!0}Aok(){if(!this.la.replaceObjectGalleryHoverEnabled)return!1;const t=this.Uvb();if(t&&1===t.t1)return!1;this.ia.La(hb.a.c0a,2,Object.assign(new Pb,{shape:this.hu,action:1}));return!0}onResize(t,P){this.visible&&(t=null,P&&P.iG&&(t=P.iG.Fd),t&&t.Cb.equals(this.hu.slideId)&&this.Ur())}}vn.OHc=32;Object(k.a)(vn,"ShapeReplaceObjectView",null,
[785,786,284,285,106,787]);var $l=d(641);class Eo{constructor(t,P,ia,Aa,Ka,pb,Nb,kc,Rc,Yc,hd,se){this.fXa=this.lea=this.hXa=this.X4=this.zo=null;this.Q$c=0;this.Ate=-1;this.vq=this.li=null;this.He=t;this.Yc=ia;this.rp=P;this.ua=Aa;this.ia=Ka;this.jE=Rc;this.HHa=pb;this.jz=Nb;this.h0=kc;this.Fa=Yc;this.la=hd;this.Lbk=!se.Uj;this.nr=this.gob=!1}get Ah(){return this.nr}get isVisible(){return this.gob}get QZa(){return this.li}setup(){this.Ah||(this.zo=cb.a.Fe(),this.zo.setAttribute("Unselectable","on"),
this.zo.style.position=Xa.a.absolute,this.He.addCssClass(this.zo,"replaceObjectContainer"),this.AQe(null),document.body.appendChild(this.zo),this.Jna(),this.jE.H8(fd.a.lib,fd.a.nj,this.zo,()=>{},()=>{},!0),this.nr=!0)}dispose(){this.Ah&&(this.dismiss(),this.qtc(),this.zo&&this.zo.parentNode&&this.zo.parentNode.removeChild(this.zo),this.nr=!1)}dismiss(){this.Ah?(v.AFrameworkApplication.Aa.wRa(!0),this.setVisibility(!1),this.uFb.style.display=Xa.a.none,this.uFb.style.zIndex="-1",this.fXa=this.lea=null,
this.AQe(null)):O.a.J(25306570,829,15,"ReplaceObjectSuggestionsGalleryView::Dismiss - called before setup")}show(t,P,ia){if(!this.Ah)O.a.J(25306572,829,15,"ReplaceObjectSuggestionsGalleryView::Show - called before setup");else if(!ab.a.Wa(t)){var Aa=this.jz.B9a(t);Aa&&Aa.correlationId===t&&Aa.cE&&!Aa.e9&&(this.li=Aa,this.pBk(t,this.li.suggestions),this.Q$c=this.li.cV,this.nkh(),v.AFrameworkApplication.Aa.MPa(!0),this.uFb.style.zIndex=String(v.AFrameworkApplication.Aa.Vqa),this.zo.style.zIndex=String(v.AFrameworkApplication.Aa.oqb),
this.uFb.style.visibility=Xa.a.hidden,this.uFb.style.display=Xa.a.block,this.uFb.style.visibility=Xa.a.visible,this.Cka()?this.He.addCssClass(this.zo,"replaceIconObjectContainer"):this.He.removeCssClass(this.zo,"replaceIconObjectContainer"),this.updatePosition(P,ia),this.setVisibility(!0))}}updatePosition(t,P){let ia,Aa;this.setPosition(0,0);if(this.Cka()){ia=t+vn.OHc+7;Aa=P;const Ka=$l.a(0,0);ia+this.zo.offsetWidth>Ka.width&&(ia=t+vn.OHc-this.zo.offsetWidth,Aa=P-7-this.zo.offsetHeight)}else ia=t,
Aa=P-7-this.zo.offsetHeight;this.setPosition(ia,Aa)}Ljj(){return this.Ah?this.Q$c:(O.a.J(25306574,829,15,"ReplaceObjectSuggestionsGalleryView::GetSuggestionCount - called before setup"),0)}P5d(){return this.Ah?this.isVisible?this.zo?this.zo.querySelector(".replaceObjectSuggestionsList")?this.Ate:(O.a.J(25306580,829,15,"ReplaceObjectSuggestionsGalleryView::GetFocusedSuggestionIndex, suggestion list is null"),-1):(O.a.J(25306578,829,15,"ReplaceObjectSuggestionsGalleryView::GetFocusedSuggestionIndex, m_suggestionsContainer is null"),
-1):-1:(O.a.J(25306576,829,15,"ReplaceObjectSuggestionsGalleryView::GetFocusedSuggestionIndex - called before setup"),0)}Fw(t,P){if(!this.Ah)O.a.J(25306582,829,15,"ReplaceObjectSuggestionsGalleryView::SetSuggestionItemFocus - called before setup");else if(!(0>t)&&this.isVisible)if(this.zo)if(t>=this.Q$c)O.a.J(25306586,829,15,"ReplaceObjectSuggestionsGalleryView::SetSuggestionItemFocus, invalid suggestionIndex. SuggestionCount:{0}, SuggestionIndex:{1}",this.Q$c,t);else{var ia=this.zo.querySelector(".replaceObjectSuggestionsList");
ia?(ia=ia.children)?(ia=ia[t])?P?(this.Ate=t,Wb.FocusManager.Sr(ia)&&this.qvh(ia.firstChild)):(this.nkh(),Wb.FocusManager.mtl(ia)&&this.V$f(ia.firstChild)):O.a.J(25306592,829,15,"ReplaceObjectSuggestionsGalleryView::SetSuggestionItemFocus, suggestionItem is null"):O.a.J(25306590,829,15,"ReplaceObjectSuggestionsGalleryView::SetSuggestionItemFocus, suggestionItems is null"):O.a.J(25306588,829,15,"ReplaceObjectSuggestionsGalleryView::SetSuggestionItemFocus, suggestion list is null")}else O.a.J(25306584,
829,15,"ReplaceObjectSuggestionsGalleryView::SetSuggestionItemFocus, m_suggestionsContainer is null")}ytc(t){this.hXa&&(this.hXa.className="ReplaceObjectCorrelation "+t)}pBk(t,P){this.AQe(t);if(t=this.mGi(t,P))P=this.lGi(),this.zo.appendChild(P),this.zo.appendChild(t),this.Cka()&&(t=this.kGi(),this.zo.appendChild(t))}AQe(t){this.zo&&(this.X4&&(this.Yc.yb(oa.a.click,this.X4,Object(r.a)(this,this.Q3g,"onLinkClick")),this.X4=null),this.He.tu(this.zo),this.hXa=cb.a.Fe(),this.hXa.setAttribute("Unselectable",
"on"),this.hXa.className=ab.a.Wa(t)?"ReplaceObjectCorrelation":"ReplaceObjectCorrelation "+t,this.hXa.style.position=Xa.a.absolute,this.hXa.style.display=Xa.a.none,this.zo.appendChild(this.hXa),this.zo.style.zIndex="-1")}lGi(){const t=cb.a.Nn();t.setAttribute("Unselectable","on");this.Cka()?(t.innerText=ResourceStrings.l_ReplaceIconSuggestionGalleryTitle,this.He.addCssClass(t,"replaceIconObjectContainerTitle")):(t.innerText=ResourceStrings.l_ReplaceObjectSuggestionGalleryTitle1,this.He.removeCssClass(t,
"replaceIconObjectContainerTitle"));this.He.addCssClass(t,"UIFont replaceObjectContainerTitle");return t}mGi(t,P){if(ab.a.Wa(t))return O.a.J(25012107,829,10,"ReplaceObjectSuggestionsGalleryView::CreateSuggestionList - Empty correlationId"),null;if(!P||!P.length)return O.a.J(25012109,829,10,"ReplaceObjectSuggestionsGalleryView::CreateSuggestionList - Requires atleast one suggestion to display."),null;const ia=cb.a.Q0b();ia.id=t;ia.setAttribute("Unselectable","on");ia.setAttribute(pa.a.af,pa.a.Xei);
this.He.addCssClass(ia,"replaceObjectSuggestionsList");this.lea||(this.lea=new ob.a);this.fXa||(this.fXa=new ob.a);for(var Aa of P)ab.a.Wa(Aa.imageData)||this.lea.$(Aa.index,Aa.imageData),this.Cka()&&!ab.a.Wa(Aa.renderData)&&this.fXa.$(Aa.index,Aa.renderData),t=this.eji(Aa.index,Aa.labelText),ia.appendChild(t);if(this.Lbk&&0<this.fXa.count&&this.Cka()&&(ab.a.Wa(this.li.Oib)&&(this.li.Oib=vh.a.create().toString()),(Aa=Xc.a.F9a(this.li.Oib))&&!Aa.hasChildNodes())){Aa.style.position=Xa.a.absolute;Aa.style.left=
"0px";Aa.style.top="0px";for(let Ka of this.fXa.values)t=cb.a.eC(),t.src=Ka,t.style.display=Xa.a.block,t.style.position=Xa.a.absolute,Aa.appendChild(t);Xc.a.RYb()}return ia}kGi(){this.X4=cb.a.Nn();this.X4.setAttribute("Unselectable","on");this.X4.setAttribute("tabindex","-1");this.X4.setAttribute(pa.a.af,pa.a.kQd);this.He.addCssClass(this.X4,"UIFont replaceObjectContainerLink");this.Cka()&&this.la.pptSmartArtSubNodeIconChangeEnabled&&this.la.N$a&&(this.X4.innerText=ResourceStrings.l_ReplaceIconSuggestionGalleryLink,
this.Yc.pb(oa.a.click,this.X4,Object(r.a)(this,this.Q3g,"onLinkClick")));const t=cb.a.Fe();t.appendChild(this.X4);return t}Jna(){this.zo&&(this.Yc.pb(oa.a.click,this.zo,Object(r.a)(this,this.onClick,"onClick")),this.h0.addHandler(this.zo,oa.a.Zf,Object(r.a)(this,this.oWc,"inputKeyApplyHandler")),this.rp.pb(oa.a.pointerOver,this.zo,Object(r.a)(this,this.WC,"onPointerOver")),this.rp.pb(oa.a.pointerOut,this.zo,Object(r.a)(this,this.pz,"onPointerOut")))}qtc(){this.zo&&(this.Yc.yb(oa.a.click,this.zo,Object(r.a)(this,
this.onClick,"onClick")),this.h0.removeHandler(this.zo,oa.a.Zf,Object(r.a)(this,this.oWc,"inputKeyApplyHandler")),this.rp.yb(oa.a.pointerOver,this.zo,Object(r.a)(this,this.WC,"onPointerOver")),this.rp.yb(oa.a.pointerOut,this.zo,Object(r.a)(this,this.pz,"onPointerOut")))}WC(t){t=this.e9d(t.Cc);this.qvh(t);return!0}pz(t){t=this.e9d(t.Cc);this.V$f(t);return!0}oWc(t){if(this.isVisible&&!t.ctrlKey&&!t.altKey&&(!t.shiftKey||t.keyCode===wa.a.Pq&&this.Cka()))if(t.keyCode===wa.a.tq||t.keyCode===wa.a.mP)t.preventDefault(),
(t=this.zo.querySelector(":focus"))&&t.firstChild.click();else if(t.keyCode===wa.a.Pq&&this.Cka()){const P=this.zo.querySelector(":focus");P&&this.X4&&(P===this.X4?(t.preventDefault(),t.stopPropagation(),this.Fw(0,!0)):P.parentNode&&P.parentNode.className&&0<=P.parentNode.className.indexOf("replaceObjectSuggestionsList")&&(t.preventDefault(),t.stopPropagation(),this.Fw(this.P5d(),!1),Wb.FocusManager.Sr(this.X4)))}}onClick(t){if(t.lA!==Sys.UI.MouseButton.leftButton)return!1;var P=this.e9d(t.Cc);if(!this.Kke(P)||
!this.wTj(P))return!0;t=this.v5i(P);const ia=this.P5b(P);P=this.Ojj(P);ab.a.Wa(t)||ab.a.Wa(ia)||(t=Object.assign(new gb.a,{SuggestionSid:parseInt(ia),ShapeId:this.li.shapeId,CorrelationId:t,ActiveSlideCid:this.ua.Ba.cid,ActiveSlideSid:this.ua.Ba.sid,Label:P,SmartArtSubNodeId:this.li.Z5?this.li.Z5:null,ReplaceObjectType:this.li.t1}),this.ia.La(hb.a.yPa,2,t));return!0}Q3g(){this.li&&(this.li.Ooc=!0);this.E$d();this.ia.processAction(hb.a.x6a,2);return!0}qvh(t){t&&this.Kke(t)&&(t=this.P5b(t),ab.a.Wa(t)||
(t=this.Cka()?this.fXa.Hb(t)?this.fXa.ga(t):"":this.lea.Hb(t)?this.lea.ga(t):"",ab.a.Wa(t)||(t=new Mp.a(this.li.shapeId,t,this.li.Z5),this.HHa.Wdh(t))))}V$f(t){t&&this.Kke(t)&&(t=new Do.a(this.li.shapeId,this.li.Z5),this.HHa.Vdh(t))}e9d(t){if(!t)throw Error.argumentNull("sourceElement");return"a"===t.nodeName.toLowerCase()?t:t.parentNode}v5i(t){return t?t.parentNode.parentNode.id:null}P5b(t){if(!t)return null;t=t.id.split("_");return 2!==t.length?null:t[1]}Ojj(t){return t?t.title:null}Kke(t){return!!t&&
!ab.a.Wa(t.className)&&-1!==t.className.indexOf("ObjectSuggestionContainer")}wTj(t){return!!t&&!ab.a.Wa(t.className)&&-1===t.className.indexOf("ReplaceObjectSuggestionLoading")}eji(t,P){const ia=this.lea.Hb(t);var Aa=ia?this.lea.ga(t):ig.a.RK(Xb.a.Bna);ia||O.a.J(38340484,829,15,"ReplaceObjectSuggestionsGalleryView::spinner shows up");const Ka=cb.a.eC();Ka.setAttribute("Unselectable","on");Ka.src=Aa;Ka.title=P;Ka.setAttribute(pa.a.af,pa.a.fN);this.He.addCssClass(Ka,"replaceObjectSuggestionThumbnail");
Aa=cb.a.nca();Aa.id="ROS_"+t;Aa.setAttribute("Unselectable","on");Aa.title=P;Aa.setAttribute(pa.a.af,"none");let pb=this.Cka()?"replaceIconObjectSuggestionContainer":"replaceObjectSuggestionContainer";this.li.zT&&this.li.HGc.toString()===t&&(pb+="Selected");this.He.addCssClass(Aa,pb);ia||this.He.addCssClass(Aa,"ReplaceObjectSuggestionLoading");Aa.appendChild(Ka);t=this.He.eIf();t.setAttribute("Unselectable","on");t.setAttribute("tabindex","-1");t.setAttribute(pa.a.af,pa.a.fN);t.setAttribute(pa.a.gs,
P);t.appendChild(Aa);return t}setPosition(t,P){this.Ah?(0>t&&(t=0),0>P&&(P=0),this.zo.style.left=this.He.Pc(t),this.zo.style.top=this.He.Pc(P)):O.a.J(25306626,829,15,"ReplaceObjectSuggestionsGalleryView::SetPosition - called before setup")}setVisibility(t){if(this.zo){if(this.li)if(t)this.li.Q_e=new Date,this.li.wfk();else{let P;(P=this.li).urc=P.urc+(+new Date-+this.li.Q_e)}this.zo.style.visibility=t?Xa.a.visible:Xa.a.hidden;this.gob=t;this.Fa.Bj(fd.a.lib,t)}}nkh(){this.Ate=-1}Cka(){return!!this.li&&
1===this.li.t1}get uFb(){this.vq&&"undefined"!==typeof this.vq||(this.vq=this.He.Fe(),this.vq.setAttribute("id","ModalDiv"),this.He.addCssClass(this.vq,"cui-modalDiv"),this.vq.setAttribute("Unselectable","on"),document.body.appendChild(this.vq),ol.a.instance.pb(oa.a.pointerDown,this.vq,Object(r.a)(this,this.qed,"onModalPointerDown")),ol.a.instance.pb(oa.a.xR,this.vq,Object(r.a)(this,this.sed,"onModalPointerUp")),ol.a.instance.pb(oa.a.Ukc,this.vq,Object(r.a)(this,this.uqk,"onModalPointerMove")),ol.a.instance.pb(oa.a.pointerOut,
this.vq,Object(r.a)(this,this.vqk,"onModalPointerOut")),pl.a.instance.pb(oa.a.click,this.vq,Object(r.a)(this,this.tqk,"onModalClick")),Lp.a.instance.pb(oa.a.yFb,this.vq,Object(r.a)(this,this.qGe,"onModalMouseWheel")));return this.vq}qed(){return!0}sed(){return this.E$d()}uqk(){return!0}vqk(){return!0}tqk(){return this.E$d()}qGe(){return!0}E$d(){if(!this.li||!this.li.slide)return!0;const t=this.li.shape;if(!t)return!0;this.ia.La(hb.a.c0a,2,Object.assign(new Pb,{action:2,shape:t}));return!0}}Object(k.a)(Eo,
"ReplaceObjectSuggestionsGalleryView",null,[751,787]);class Fo{constructor(t,P,ia,Aa){this.Zak=t;this.eu=P;this.ua=ia;this.la=Aa}W1i(t){if(!this.ua.Ba)return!1;t=this.ua.Ba.eT(t);return this.auc(t)}auc(t){return!(t&&t.get_shapeId()&&t.hasText&&this.eu.xFa(t))||t.get_shapeRotation()||t.vs||t.V3||t.lx||!this.Zak.validate(t)?!1:!0}yVj(t){return!Array.contains(this.la.replaceObjectDisabledTriggers,t)}}Object(k.a)(Fo,"ReplaceObjectValidationHelper",null,[]);class Mh{constructor(t,P,ia,Aa,Ka,pb,Nb,kc,Rc){this.Ir=
this.c0=null;this.nr=!1;this.OX=t;this.Yc=P;this.rp=ia;this.wO=Aa;this.Aea=Ka;this.je=Nb;this.la=pb;this.Ebb=Rc}get Ah(){return this.nr}BMc(){this.la.GJb?this.Ir.setAttribute("Src",this.je.pk("BLUEBOLT_Deactivated.gif")):this.Ir.style.opacity=".3";this.Ebb.kph(Object(r.a)(this,this.dismiss,"dismiss"))}BNc(){this.la.GJb?this.Ir.setAttribute("Src",this.je.pk("BLUEBOLT_Reactivated.gif")):this.Ir.style.opacity="initial";this.Ebb.disabled=!1}show(){this.la.GJb?this.Ir.setAttribute("Src",this.je.pk("BLUEBOLT_Entrance.gif")):
this.Ir.setAttribute("Src",this.je.pk("LightningIdeasOOUI_blue_32x.png"))}dismiss(){this.la.GJb?(this.Ir.setAttribute("Src",this.je.pk("BLUEBOLT_Exit.gif")),this.Ebb.y6k(()=>{this.OX.xa.style.visibility=Xa.a.hidden})):(this.Ir.setAttribute("Src",""),this.OX.xa.style.visibility=Xa.a.hidden)}setup(){this.Ah||(this.OX?(this.c0=new Lb.a,this.c0.xa.style.visibility=Xa.a.inherit,this.c0.xa.style.position=Xa.a.absolute,this.Ir=cb.a.eC(),this.Ir.setAttribute("Unselectable","on"),this.Ir.setAttribute(pa.a.af,
pa.a.fN),this.Ir.className="gifFloatie",this.c0.xa.appendChild(this.Ir),this.OX.appendChild(this.c0),this.Jna()):O.a.J(38072903,829,15,"parentElement is null"),this.nr=!0)}t3g(t){let P;switch(this.la.replaceObjectIconType){case 7:P="BLUEBOLT_Hover_on.gif";break;case 8:P="BLUEBOLT_HoverWhite_On.gif";break;default:P="BLUEBOLT_Hover_on.gif"}this.Ir.setAttribute("Src",this.je.pk(P));return this.Aea(t)}onBlur(){let t;switch(this.la.replaceObjectIconType){case 7:t="BLUEBOLT_Hover_off.gif";break;case 8:t=
"BLUEBOLT_HoverWhite_Off.gif";break;default:t="BLUEBOLT_Hover_off.gif"}this.Ir.setAttribute("Src",this.je.pk(t));return!0}Jna(){this.wO&&this.Yc.pb(oa.a.click,this.Ir,this.wO);this.Aea&&(this.rp.pb(oa.a.pointerOver,this.Ir,Object(r.a)(this,this.t3g,"onHover")),this.rp.pb(oa.a.pointerOut,this.Ir,Object(r.a)(this,this.onBlur,"onBlur")))}e2e(){this.wO&&this.Yc.yb(oa.a.click,this.Ir,this.wO);this.Aea&&(this.rp.yb(oa.a.pointerOver,this.Ir,Object(r.a)(this,this.t3g,"onHover")),this.rp.yb(oa.a.pointerOut,
this.Ir,Object(r.a)(this,this.onBlur,"onBlur")))}dispose(){this.dismiss();this.e2e();this.nr=!1}}Object(k.a)(Mh,"GifFlyoutAnchor",null,[997,787]);class gt{constructor(t,P,ia,Aa,Ka,pb,Nb,kc,Rc,Yc,hd,se,Ae,we){this.Ir=this.zv=null;this.OX=t;this.$T=P;this.r7j=ia;this.w7j=Aa;this.hyg=se.replaceObjectIconType;this.Xpg=se.replaceObjectAnimId;this.Ypg=se.GJb;this.SHa=pb;this.dgc=Ka;this.Yc=Nb;this.rp=kc;this.wO=Rc;this.Aea=Yc;this.He=hd;this.Bck=Ae;this.Ebb=we;this.nr=!1}get J1b(){return 1===this.Bck?ResourceStrings.l_ReplaceIconSuggestionFloatieTooltip:
this.Ebb.disabled?ResourceStrings.l_ReplaceObjectGrayFloatieTooltip:ResourceStrings.l_ReplaceObjectFloatieTooltip}get Ah(){return this.nr}setup(){this.Ah||(this.zv=new Lb.a,this.Ir=this.dgc.XEi(),this.zv.xa.style.visibility=Xa.a.inherit,this.Dia(),this.nr=!0)}BMc(){this.Ebb.kph(Object(r.a)(this,this.dismiss,"dismiss"));this.Lra();this.lpc();this.zv.iyi()||this.zv.qr("replaceObjectGrayedFlyoutAnchor")}show(){this.Ah?this.lpc(this.Ypg):O.a.J(38072907,829,15,"ReplaceObjectFlyoutAnchor::Show - called before setup")}BNc(){this.Ebb.disabled=
!1;this.Lra();this.lpc();this.zv.bib("replaceObjectGrayedFlyoutAnchor")}lpc(t=!1){this.Ah?this.Ir.poa(this.d9i(t),""):O.a.J(25306443,829,15,"ReplaceObjectFlyoutAnchor::SetGlyph - called before setup")}d9i(t){const P=this.SHa.uWd(this.$T,this.$T,this.r7j,this.w7j,this.J1b,null);this.He.addCssClass(this.zv.xa,"replaceObjectFlyoutAnchorBase");this.He.addCssClass(this.zv.xa,"replaceObjectFlyoutAnchor"+this.hyg);t&&(this.He.addCssClass(this.zv.xa,"replaceObjectFlyoutAnchorAnimBase"),this.He.addCssClass(this.zv.xa,
"replaceObjectFlyoutAnchorAnim"+this.Xpg));return P}Lra(){this.Ah?(this.Ir.clear(),this.He.removeCssClass(this.zv.xa,"replaceObjectFlyoutAnchorBase"),this.He.removeCssClass(this.zv.xa,"replaceObjectFlyoutAnchor"+this.hyg),this.Ypg&&(this.He.removeCssClass(this.zv.xa,"replaceObjectFlyoutAnchorAnimBase"),this.He.removeCssClass(this.zv.xa,"replaceObjectFlyoutAnchorAnim"+this.Xpg))):O.a.J(25306445,829,15,"ReplaceObjectFlyoutAnchor::ClearGlyph - called before setup")}dispose(){this.Ah&&(this.e2e(),this.zv&&
this.zv.xa.parentNode&&this.zv.yq(),this.dismiss(),this.Ir.dispose(),this.zv=null,this.nr=!1)}dismiss(){this.Ah?(this.Lra(),this.OX.xa.style.visibility=Xa.a.hidden):O.a.J(25306447,829,15,"ReplaceObjectFlyoutAnchor::Dismiss - called before setup")}Dia(){this.OX?(this.zv.xa.style.width=this.He.Pc(this.$T),this.zv.xa.style.height=this.He.Pc(this.$T),this.zv.xa.setAttribute(pa.a.af,pa.a.ru),this.OX.appendChild(this.zv),this.Ir.Dia(this.zv.xa),this.Jna()):O.a.J(25306449,829,15,"ReplaceObjectFlyoutAnchor::BuildDom - parentElement is null")}ngb(){return!0}Jna(){this.wO&&
this.Yc.pb(oa.a.click,this.zv.xa,this.wO);this.Yc.pb(oa.a.doubleClick,this.zv.xa,Object(r.a)(this,this.ngb,"onDoubleClick"));this.Aea&&(this.rp.pb(oa.a.pointerOver,this.zv.xa,this.Aea),this.rp.pb(oa.a.pointerOver,this.zv.xa.firstChild,this.Aea),this.rp.pb(oa.a.pointerOver,this.zv.xa.firstChild.firstChild,this.Aea))}e2e(){this.wO&&this.Yc.yb(oa.a.click,this.zv.xa,this.wO);this.Yc.yb(oa.a.doubleClick,this.zv.xa,Object(r.a)(this,this.ngb,"onDoubleClick"));this.Aea&&(this.rp.yb(oa.a.pointerOver,this.zv.xa,
this.Aea),this.rp.yb(oa.a.pointerOver,this.zv.xa.firstChild,this.Aea),this.rp.yb(oa.a.pointerOver,this.zv.xa.firstChild.firstChild,this.Aea))}}Object(k.a)(gt,"ReplaceObjectFlyoutAnchor",null,[997,787]);class ht{constructor(t,P){this.Cz=null;this.ai=t;this.He=P;this.nr=!1}get Ah(){return this.nr}get GN(){return this.Cz}setup(){this.Ah||(this.Cz=new Lb.a,this.Dia(),this.nr=!0)}Dia(){this.ai?(this.ai.appendChild(this.GN.xa),this.He.addCssClass(this.GN.xa,"replaceObjectPreviewContainer"),this.GN.setVisibility(!1)):
O.a.J(25306518,829,15,"ReplaceObjectPreviewImageView::BuildDom - parentElement is null")}poa(t){if(this.Ah){if(t=this.$ia(t))this.Pna(),this.GN.xa.appendChild(t),this.GN.setVisibility(!0)}else O.a.J(25306520,829,15,"ReplaceObjectPreviewImageView::SetImage - called before setup")}ih(t,P){this.Ah?this.GN.ih(t,P):O.a.J(25306522,829,15,"ReplaceObjectPreviewImageView::SetSize - called before setup")}dispose(){this.Ah&&(this.dismiss(),this.GN&&this.GN.xa.parentNode&&(this.GN.yq(),this.He.removeCssClass(this.GN.xa,
"replaceObjectPreviewContainer")),this.Cz=null)}dismiss(){this.Ah?(this.Pna(),this.GN.setVisibility(!1)):O.a.J(25306524,829,15,"ReplaceObjectPreviewImageView::Dismiss - called before setup")}$ia(t){if(!ab.a.Wa(t)){const P=cb.a.eC();P.setAttribute("Unselectable","on");P.src=t;P.style.height="100%";P.style.width="100%";return P}return null}Pna(){this.GN.xa.firstChild&&this.GN.xa.removeChild(this.GN.xa.firstChild)}}Object(k.a)(ht,"ReplaceObjectPreviewImageView",null,[787]);var it=d(686);class sp{constructor(t,
P,ia,Aa,Ka,pb,Nb){this.Yc=t;this.rp=P;this.He=ia;this.SHa=Aa;this.la=Ka;this.je=pb;this.nwg=Nb}pCi(t,P,ia,Aa,Ka){t=Ha.DBl(this.la.replaceObjectIconType,Ka)?new Mh(t,this.Yc,this.rp,ia,Aa,this.la,this.je,this.He,this.nwg):new gt(t,P,"per","PowerPointDesigner_32x32x32",this,this.SHa,this.Yc,this.rp,ia,Aa,this.He,this.la,Ka,this.nwg);t.setup();return t}YEi(t){t=new ht(t,this.He);t.setup();return t}XEi(){return new it.a(this.He)}}Object(k.a)(sp,"ReplaceObjectViewFactory",null,[]);class mi{constructor(t,
P,ia){this.He=t;this.ua=ia;this.tTg=P}pTc(t){if(!t)throw Error.argumentNull("shape");var P=t.NU;t=this.mtb(P.TopLeft);P=this.mtb(P.TopRight);return Zb.a.lm(t,P)}oTc(t){if(!t)throw Error.argumentNull("shape");var P=t.NU;t=this.mtb(P.TopRight);P=this.mtb(P.BottomRight);return Zb.a.lm(t,P)}C5b(t){return this.pTc(t)*this.D6f()}B5b(t){return this.oTc(t)*this.D6f()}Yfj(t){if(!t)throw Error.argumentNull("shape");var P=t.NU;t=this.mtb(P.TopLeft);P=this.mtb(P.TopRight);return wb.a.UO(Zb.a.IG(t,P))}$Wf(){return this.getBounds(this.tTg.Ic.BB)}getBounds(t){return this.He.ii(t)}D6f(){const t=
this.tTg.Ic;return t?t.mT:1}mtb(t){return new Zb.a(t.X,t.Y)}xFa(t){return t?!!this.ua.Ba&&this.ua.Ba.Cb.equals(t.slideId):!1}}Object(k.a)(mi,"ReplaceObjectViewHelper",null,[]);var Eq=d(437);class lo{constructor(t,P,ia){this.t0=this.R_=null;this.MT=t;this.Wak=P;this.k9c=ia}get nG(){return"ReplaceObjectWacALWorkflow"}get proto(){return'syntax="proto3";message ShapeTextConvertable { string Topic = 1; string Payload = 2; string AppId = 3; string SessionId = 4; string ContextId = 5; };'}get Frb(){this.R_||
(this.R_=Object.assign(new cj.a,{name:"LambdaBefore_ReplaceObjectWacAL",inputSchema:Eq.a.hVe,outputSchema:Eq.a.hVe,func:Object(r.a)(this,this.hbb,"lambdaBeforeFunc")}));return this.R_}get Pqb(){return null}get pJb(){this.t0||(this.t0=Object.assign(new cj.a,{name:"LambdaRemote_ReplaceObjectWacAL",inputSchema:Eq.a.hVe,outputSchema:"ShapeTextConvertable",func:Object(r.a)(this,this.Hle,"lambdaRemoteFunc")}));return this.t0}hbb(t,P,ia){if(t&&this.Wak.Vhe())if(t){try{var Aa=fe.a(t.ContextId)}catch(Ka){O.a.J(37041409,
375,10,"{0}:LambdaBeforeDone - Try parse tile contextId failed",this.nG);ia(null);return}this.k9c.yVj(Aa.t)?this.k9c.W1i(Aa.shapeId)?ia(t):(O.a.J(37041411,375,50,"{0}:LambdaBeforeDone - shape invalid",this.nG),ia(null)):(O.a.J(38115527,375,50,"{0}:LambdaBeforeDone - trigger invalid",this.nG),ia(null))}else ia(null),O.a.J(37041379,375,50,"{0}:LambdaBeforeDone -  ShapeTextTile null",this.nG);else O.a.J(37041377,375,50,"{0}:LambdaBeforeDone -  input null or ineligible",this.nG),ia(null)}Hle(t,P,ia){t?
t?this.MT.execute(Aa=>{Aa.Xnc(t.Topic,t.Data,t.ContextId,Ka=>{this.eKa(Ka)},Ka=>{this.cKa(Ka)},ia)}):ia(null):ia(null)}eKa(t){if(!v.AFrameworkApplication.Tg&&t&&t.data){var P=t.data.state;if(P){try{var ia=fe.a(t.data.Zd)}catch(Aa){P(null);O.a.J(36804442,375,10,"Try parse aug response failed:{0}",Aa.message);return}P(ia)}}}cKa(t){!v.AFrameworkApplication.Tg&&t&&t.data&&(t=t.data.state)&&t(null)}}Object(k.a)(lo,"ReplaceObjectWacALWorkflow",null,[981]);class Al{constructor(){this.MDe=null}auc(t){return this.validate(t)?
this.MDe?this.MDe.auc(t):!0:!1}D7k(t){this.MDe=t}}Object(k.a)(Al,"ReplaceObjectWall",null,[]);class tp extends Al{constructor(){super();this.eu=null}g4f(t){const P=this.eu.C5b(t);t=this.eu.B5b(t);var ia=P*t;const Aa=this.eu.$Wf().width,Ka=this.eu.$Wf().height;ia=ia/(Aa*Ka)*100;O.a.J(37041415,829,50,"ReplaceObjectValidationHelper::GetShapeAreaRatio - shapeWidth: {0}; shapeHeight{1}; slideWidth:{2}; slideHeight{3}; ratio: {4}",P,t,Aa,Ka,ia);return ia}}Object(k.a)(tp,"AreaRatioWall",Al,[]);class kr extends tp{constructor(t,
P){super();this.M9j=t;this.eu=P}validate(t){return this.g4f(t)<=this.M9j}}Object(k.a)(kr,"MaxAreaRatio",tp,[]);class lr extends Al{constructor(t,P){super();this.J9j=t;this.eu=P}validate(t){return this.eu.B5b(t)<=this.J9j}}Object(k.a)(lr,"MaxShapeHeight",Al,[]);class xm extends Al{constructor(t,P){super();this.O9j=t;this.eu=P}validate(t){return this.eu.C5b(t)<=this.O9j}}Object(k.a)(xm,"MaxShapeWidth",Al,[]);class mr extends tp{constructor(t,P){super();this.a$j=t;this.eu=P}validate(t){return this.g4f(t)>=
this.a$j}}Object(k.a)(mr,"MinAreaRatio",tp,[]);var nr=d(38);class Np extends Al{constructor(t,P){super();this.$9j=t;this.Ea=P}validate(t){return this.qdj(t,this.Ea)>=this.$9j}qdj(t,P){if(!t)return 0;let ia=0;P.DJ(t,Aa=>{Aa.Sa(nr.a.pq)&&(Aa=Aa.eb(nr.a.pq))&&0<Aa.length&&ia++});return ia}}Object(k.a)(Np,"MinParagraphCount",Al,[]);class Op extends Al{constructor(t,P){super();this.Y9j=t;this.eu=P}validate(t){return this.eu.B5b(t)>=this.Y9j}}Object(k.a)(Op,"MinShapeHeight",Al,[]);class or extends Al{constructor(t,
P){super();this.d$j=t;this.eu=P}validate(t){return this.eu.C5b(t)>=this.d$j}}Object(k.a)(or,"MinShapeWidth",Al,[]);class ng{constructor(t,P,ia){this.Uea=null;this.la=t;this.Ea=P;this.eFb=ia;this.init(this.la.replaceObjectClientWalls)}validate(t){return this.Uea?this.Uea.auc(t):!0}init(t){t=this.WGi(t);this.yki(t)}WGi(t){const P={};if(ab.a.Wa(t))return P;t=t.split(";");for(const ia of t)ab.a.Wa(ia)||(t=ia.split(":"),2===t.length?P[t[0]]=t[1]:O.a.J(25192154,829,10,"ReplaceObjectClientWalls::Parse - wall: {0}",
ia));return P}yki(t){const P=[];"MinParagraphCount"in t&&Array.add(P,new Np(Jh.d(t,"MinParagraphCount",0),this.Ea));"MinShapeHeight"in t&&Array.add(P,new Op(Jh.b(t,"MinShapeHeight",0),this.eFb));"MaxShapeHeight"in t&&Array.add(P,new lr(Jh.b(t,"MaxShapeHeight",Number.MAX_VALUE),this.eFb));"MinShapeWidth"in t&&Array.add(P,new or(Jh.b(t,"MinShapeWidth",0),this.eFb));"MaxShapeWidth"in t&&Array.add(P,new xm(Jh.b(t,"MaxShapeWidth",Number.MAX_VALUE),this.eFb));"MinShapeAreaRatio"in t&&Array.add(P,new mr(Jh.b(t,
"MinShapeAreaRatio",0),this.eFb));"MaxShapeAreaRatio"in t&&Array.add(P,new kr(Jh.b(t,"MaxShapeAreaRatio",Number.MAX_VALUE),this.eFb));for(t=0;t<P.length-1;t++)P[t].D7k(P[t+1]);0<P.length&&(this.Uea=P[0])}}Object(k.a)(ng,"ReplaceObjectWalls",null,[752]);class Yo{constructor(){this.K=null;this.qO=this.cve=this.Eve=!1}get name(){return"PowerPointWebEditor.ReplaceObject"}$b(t){this.K=t;(this.qO=this.K.resolve("PowerPointWebEditor.IApplicationContext").od.wg)&&this.K.register(ad.a,"PowerPointWebEditor.PodsInfoSender").ma().oa(()=>
new ad.a(v.AFrameworkApplication.Je,this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("PowerPointWebEditor.Core.IPodsPopsEventHandler"),this.K.resolve("PowerPointWebEditor.IErrorHandler"),this.K.resolve("Common.ITaskManager"),this.K.resolve("Common.IAppSettingsManager")));t.register(ue,"PowerPointWebEditor.ReplaceObject.ReplaceObjectEventSource").as("PowerPointWebEditor.ReplaceObject.IReplaceObjectEventSource").as("PowerPointWebEditor.ReplaceObject.IReplaceObjectEventNotifier").as("PowerPointWebEditor.ReplaceObject.IReplaceObjectEventHandlers").ma().oa(()=>
new ue);t.register(mi,"PowerPointWebEditor.ReplaceObject.ReplaceObjectViewHelper").ma().oa(()=>new mi(t.resolve("PowerPoint.IBrowserHelperManager"),t.resolve("PowerPointWebEditor.IActiveSlideViewManager"),t.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager")));t.register(751,"PowerPointWebEditor.IReplaceObjectGalleryView").ma().oa(()=>new Eo(t.resolve("PowerPoint.IBrowserHelperManager"),t.resolve("Common.IPointerInputManager"),t.resolve("Common.IClickInputManager"),t.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
t.resolve("Common.IActionManagerExtended"),t.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectEventNotifier"),t.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectContextManager"),t.resolve("PowerPointWebEditor.IInputHandlerManager"),t.resolve("PowerPointWebEditor.View.IFocusManagerHelper"),t.resolve("PowerPointWebEditor.IFocusManager"),t.resolve("PowerPointWebEditor.IApplicationSettings"),t.resolve("Common.IBrowserUtils")));t.register(752,"PowerPointWebEditor.ReplaceObject.IReplaceObjectWalls").ma().oa(()=>
new ng(t.resolve("PowerPointWebEditor.IApplicationSettings"),t.resolve("PowerPointWebEditor.IShapeReader"),t.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewHelper")));t.register(Fo,"PowerPointWebEditor.ReplaceObject.ReplaceObjectValidationHelper").ma().oa(()=>new Fo(t.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectWalls"),t.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewHelper"),t.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),t.resolve("PowerPointWebEditor.IApplicationSettings")));
t.register(753,"PowerPointWebEditor.ReplaceObject.IReplaceObjectRequestManager").ma().oa(()=>new Pf(t.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),t.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewHelper"),t.resolve("PowerPointWebEditor.IApplicationSettings").keepCalculateZoomInNativeConsistentWithClientFixIsEnabled));t.register(754,"PowerPointWebEditor.ReplaceObject.IReplaceObjectContextManager").ma().oa(()=>t.resolve("Common.IAppSettingsManager").ka("473")?new Df((P,ia,Aa,
Ka,pb,Nb)=>{const kc=new zd(t.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),t.Ja("PowerPointWebEditor.IDesignerServiceProvider"));kc.BQa(P,ia,Aa,Ka,pb,Nb);return kc}):new Tj(new zd(t.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),t.Ja("PowerPointWebEditor.IDesignerServiceProvider"))));t.register(755,"PowerPointWebEditor.IReplaceObjectManager").ma().oa(()=>t.resolve("Common.IAppSettingsManager").ka("473")?new ma(t.Ja("PowerPointWebEditor.AugmentationLoop.IPPTAugmentationManager"),
t.Ja("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),t.resolve("PowerPointWebEditor.IFocusManager"),t.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),t.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),t.resolve("PowerPointWebEditor.IGraphActionBlockingEventHandlers"),t.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),t.resolve("PowerPointWebEditor.IPptSelectionManager"),t.resolve("Common.IActionManagerExtended"),t.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectContextManager"),
t.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectEventHandlers"),t.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectPresenter"),t.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewHelper"),t.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectRequestManager"),t.resolve("PowerPointWebEditor.UndoRedo.IUndoEventHandlers"),t.resolve("PowerpointPresence.IPresenceEventHandlers"),t.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectValidationHelper"),t.resolve("PowerPointWebEditor.View.IViewEventSource"),
t.resolve("PowerPointWebEditor.IApplicationSettings"),t.resolve("PowerPointWebEditor.IActionNameResolver"),t.resolve("Common.ITaskManager"),t.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),t.Ja("PowerPointWebEditor.IDesignerServiceProvider")):new bf(t.resolve("PowerPointWebEditor.IFocusManager"),t.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),t.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),t.resolve("PowerPointWebEditor.IGraphActionBlockingEventHandlers"),
t.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),t.resolve("PowerPointWebEditor.IPptSelectionManager"),t.resolve("Common.IActionManagerExtended"),t.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectContextManager"),t.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectEventHandlers"),t.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectPresenter"),t.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewHelper"),t.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),
t.resolve("PowerPointWebEditor.UndoRedo.IUndoEventHandlers"),t.resolve("PowerpointPresence.IPresenceEventHandlers"),t.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectValidationHelper"),t.resolve("PowerPointWebEditor.View.IViewEventSource"),t.resolve("PowerPointWebEditor.IApplicationSettings"),t.resolve("PowerPointWebEditor.IActionNameResolver"),t.resolve("Common.ITaskManager"),t.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),t.Ja("PowerPointWebEditor.IDesignerServiceProvider")));t.register(Bi,
"PowerPointWebEditor.ReplaceObject.ReplaceObjectPresenter").ma().oa(()=>new Bi(t.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),t.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapeReplaceObjectView>"),t.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapeReplaceObjectSuggestionPreviewView>"),t.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectContextManager"),t.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectEventHandlers"),
t.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewHelper"),t.resolve("PowerPointWebEditor.IReplaceObjectGalleryView"),t.resolve("PowerPointWebEditor.IFocusManager"),t.resolve("Box4.IPageView").Ma,t.resolve("PowerPointWebEditor.IShapeReader")));t.register(Ha,"PowerPointWebEditor.ReplaceObject.FlyoutAnchorTimer").ma().oa(()=>new Ha(t.resolve("PowerPointWebEditor.IApplicationSettings"),t.resolve("Common.ITaskManager")));t.register(sp,"PowerPointWebEditor.ReplaceObject.ReplaceObjectViewFactory").ma().oa(()=>
new sp(t.resolve("Common.IClickInputManager"),t.resolve("Common.IPointerInputManager"),t.resolve("PowerPoint.IBrowserHelperManager"),t.resolve("PowerPointWebEditor.ShapePresence.IShapeGlyphImageFactory"),t.resolve("PowerPointWebEditor.IApplicationSettings"),t.resolve("PowerPoint.IPathManager"),t.resolve("PowerPointWebEditor.ReplaceObject.FlyoutAnchorTimer")));t.register(255,"PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapeReplaceObjectView>").ma().oa(()=>new gd.a((P,
ia)=>{let Aa=null;const Ka=Object(R.a)(117,P.sc(t.resolve("Box4.IPageView").Ma));Ka&&!Ka.Al&&Ka.RU&&(Aa=new vn(P,Ka,ia,t.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewFactory"),t.resolve("Common.IActionManagerExtended"),t.resolve("PowerPoint.IBrowserHelperManager"),t.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),t.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectContextManager"),t.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectEventNotifier"),
t.resolve("PowerPointWebEditor.IApplicationSettings"),t.resolve("PowerPointWebEditor.IReplaceObjectGalleryView")),Aa.setup());return Aa}));t.register(255,"PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapeReplaceObjectSuggestionPreviewView>").ma().oa(()=>new gd.a((P,ia)=>{let Aa=null;const Ka=Object(R.a)(117,P.sc(t.resolve("Box4.IPageView").Ma));Ka&&!Ka.Al&&Ka.RU&&(Aa=new Uj(P,Ka,ia,t.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewFactory"),t.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewHelper")),
Aa.setup());return Aa}));t.register(lo,"PowerPointWebEditor.ReplaceObject.ReplaceObjectWacALWorkflow").as("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopWorkflow").ma().oa(()=>new lo(this.K.Ja("PowerPointWebEditor.AugmentationLoop.IPPTAugmentationManager"),this.K.resolve("PowerPointWebEditor.IReplaceObjectManager"),this.K.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectValidationHelper")));t.register(Ec,"PowerPointWebEditor.ReplaceObject.ReplaceObjectAugLoopRuntimeManager").ma().oa(()=>
new Ec(this.K.Ja("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),this.K.resolve("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopWorkflow")));t.register(oc,"PowerPointWebEditor.ReplaceObject.ReplaceObjectActor").ma().oa(()=>new oc(t.resolve("PowerPointWebEditor.IPptSelectionManager"),t.resolve("Common.IActionManagerExtended"),t.resolve("PowerPointWebEditor.IFocusManager"),t.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),t.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
t.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),t.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectEventNotifier"),t.resolve("PowerPointWebEditor.View.IViewEventSource"),t.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectContextManager"),t.resolve("Common.Transaction.ITransactionFactory"),t.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectPresenter"),t.resolve("PowerPointWebEditor.View.IPPTPageView"),t.resolve("PowerPointWebEditor.IShapeReader")));
t.register(mb,"PowerPointWebEditor.ReplaceObject.ReplaceIconManager").ma().oa(()=>new mb(t.resolve("PowerPointWebEditor.IPptSelectionManager"),t.resolve("PowerPointWebEditor.View.IViewEventSource"),t.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectContextManager"),t.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),t.resolve("PowerPointWebEditor.IShapeReader"),t.resolve("PowerPointWebEditor.IApplicationSettings"),t.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectPresenter"),
t.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),t.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewHelper"),t.resolve("PowerpointPresence.IPresenceEventHandlers"),t.resolve("PowerPointWebEditor.IGraphActionBlockingEventHandlers"),t.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingStatusChecker"),t.resolve("PowerPointWebEditor.UndoRedo.IUndoEventHandlers"),t.resolve("PowerPointWebEditor.IActionNameResolver"),t.resolve("PowerPointWebEditor.Core.IUnifiedAppState")))}init(){this.qO&&
this.K.resolve("PowerPointWebEditor.PodsInfoSender");const t=this.K.resolve("Common.IAppSettingsManager");t.jf(()=>{const P=new Date;t.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.TestEcsFeatureIsEnabled",!1)?O.a.J(512262752,324,50,"PPTO TestEcsFeature Client Flight Enabled."):O.a.J(512262751,324,50,"PPTO TestEcsFeature Client Flight Disabled.");if(this.Eve=t.ka("463"))t.ka("499")&&this.K.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectAugLoopRuntimeManager").initialize(),this.K.resolve("PowerPointWebEditor.IReplaceObjectGalleryView").setup(),
this.K.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectPresenter").setup(),this.K.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectActor").setup(),this.K.resolve("PowerPointWebEditor.IReplaceObjectManager").setup();if(this.cve=t.ka("676"))this.K.resolve("PowerPointWebEditor.IReplaceObjectGalleryView").setup(),this.K.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectPresenter").setup(),this.K.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectActor").setup(),this.K.resolve("PowerPointWebEditor.ReplaceObject.ReplaceIconManager").setup();
O.a.J(512262750,829,50,"ReplaceObject::Callback duration:{0}",+new Date-+P)})}dispose(){this.Eve&&(this.K.resolve("PowerPointWebEditor.IReplaceObjectGalleryView").dispose(),this.K.resolve("PowerPointWebEditor.IReplaceObjectManager").dispose(),this.K.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectPresenter").dispose(),this.K.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectActor").dispose());this.cve&&(this.K.resolve("PowerPointWebEditor.IReplaceObjectGalleryView").dispose(),this.K.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectPresenter").dispose(),
this.K.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectActor").dispose(),this.K.resolve("PowerPointWebEditor.ReplaceObject.ReplaceIconManager").dispose())}static main(){e.a.instance.Dc(Bc.a(new Yo,0))}}Object(k.a)(Yo,"PPTWebEditorReplaceObjectPackage",null,[2,3]);var ql=d(269),Fq=d(394),Zo=d(1061);class pr{constructor(){this.appName=0;this.wdEnableDownloadTokens=!1;this.retryCount=0;this.wdEnableIterator=this.wdEnableRestore=this.wdEnableSaveACopy=!1;this.uiLocale=this.wacCluster=this.userSessionId=
null;this.disableSaveACopy=this.wdEnableShowVersionChanges=this.wdEnableHiddenButtonsUntilVersionLoadComplete=this.viewerRootPositionRelative=this.useXhr=this.isRtl=!1;this.disabledChangeGates=null;this.wdEnableDeleteVersions=this.wdEnableSaveACopyOverFlowMenu=!1;this.wdExperimentWithIteratorLocation=this.wdEnableAppColorUpdate=null}}Object(k.a)(pr,"AppSettings",null,[]);class Gq{constructor(){this.perfTelemetryInfos=this.appSettings=this.docId=this.latestStreamServiceBase=this.serviceBase=this.ulsLogger=
null}}Object(k.a)(Gq,"ControllerFactoryParameters",null,[]);var qr=d(724),Pp=d(328);class Pg{}Pg.none="None";Pg.vhFailedToLoadVersionList="VHFailedToLoadVersionList";Pg.vhFailedToGetDownloadToken="VHFailedToGetDownloadToken";Pg.vhFailedToParseVersionList="VHFailedToParseVersionList";Pg.vhFetchFailed="VHFetchFailed";Pg.vhVersioningNotEnabled="VHVersioningNotEnabled";Pg.vhFileNotFound="VHFileNotFound";Pg.vhVersionTooOld="VHVersionTooOld";Pg.xDl="VHFailedToRenderThumbnails";Pg.wDl="VHFailedToRenderSlide";
Pg.vDl="VHFailedToRenderNotes";Pg.tDl="VHFailedToRenderDiff";Pg.yDl="VHFailedToShowAnimaitonIcon";Pg.zDl="VHFailedToShowHiddenEffect";Pg.uDl="VHFailedToRenderInitPresInfo";Object(k.a)(Pg,"ErrorName",null,[]);class wn{constructor(){this.UHa=new pd.a;this.UHa.add(0,Pg.none);this.UHa.add(100,Pg.vhFailedToLoadVersionList);this.UHa.add(101,Pg.vhFailedToGetDownloadToken);this.UHa.add(102,Pg.vhFailedToParseVersionList);this.UHa.add(103,Pg.vhFetchFailed);this.UHa.add(104,Pg.vhVersioningNotEnabled);this.UHa.add(105,
Pg.vhFileNotFound);this.UHa.add(106,Pg.vhVersionTooOld);this.sIa=new pd.a;this.sIa.add(0,Pg.none);this.sIa.add(100,Pg.xDl);this.sIa.add(101,Pg.wDl);this.sIa.add(102,Pg.vDl);this.sIa.add(103,Pg.tDl);this.sIa.add(104,Pg.yDl);this.sIa.add(105,Pg.zDl);this.sIa.add(106,Pg.uDl)}get mbl(){return this.UHa}get NDl(){return this.sIa}static w4f(){wn.FRe||(wn.FRe=new wn);return wn.FRe}}wn.pzf="ErrorCode";wn.FRe=null;Object(k.a)(wn,"VersionHistoryTelmetryHelper",null,[]);class Ql{constructor(t,P,ia,Aa,Ka,pb,Nb,
kc,Rc,Yc,hd,se,Ae,we,Jf,Yh,Me){this.zhc=this.qE=this.Fwg=this.l8c=this.MAb=this.g4=this.jBe=this.aY=this.iH=null;this.$ua=-1;this.rBb=null;if(!Me)throw Error.argumentNull("clientRequestManager");this.ia=t;this.xw=P;this.Bi=ia;this.Ga=Aa;this.qc=Ka;this.NXa={};this.Fa=pb;this.mh=Nb;this.pEb={};this.mc=Rc;this.Kad={};this.hak=kc;this.Dea=Yc;this.Xa=hd;this.Npe=[];se&&(this.Fwg=se,this.Fwg.execute(mh=>{this.qE=mh}));this.fO=Ae;this.lh=we;this.Ioe=Jf;this.V$c=Yh;this.tw=Me}vb(){this.ia.ya(E.a.Kqc,u.a.frame,
Object(r.a)(this,this.Jhl,"showVersionHistoryDialogAction"));this.Ga.pptEnablePreviousVersionsOptionForOneDriveConsumer||this.ia.ya(hb.a.lah,u.a.frame,Object(r.a)(this,this.QJe,"pptoShowFileVersion"));this.ia.ya(hb.a.sIh,u.a.frame,Object(r.a)(this,this.Cvj,"handleVersionHistoryCopySlides"))}Jhl(t,P,ia){if(1===ia)return t=!1,this.Xa.xda&&(t=!0),t?2:32;2===ia&&(v.AFrameworkApplication.CL("Microsoft.Office.Server.Powerpoint.Web.IDocsPptPPTVersionHistorySaveACopyOverFlowMenuSettings"),v.AFrameworkApplication.CL("Microsoft.Office.Server.Powerpoint.Web.IDocsPptVersionHistoryDeleteVersions"),
this.zhc=Ca.a.create().toString(),n.ULS.sendTraceTag(512508634,822,50,"Execute ShowVersionHistoryDialogAction. VersionHistoryLaunchSessionId: {0}",this.zhc),jb.c(hb.a.y7g,!0),this.NXa.VersionHistoryLaunchSessionId=this.zhc,this.pEb.VersionHistoryLaunchSessionId=this.zhc,this.NXa.ShowVersionHistoryDialog=(new Date).getTime().toString(),this.l8c=[],this.iH||(this.iH=versionHistory.FactoryGlobal.getVersionHistoryControllerInstance(Object.assign(new Gq,{ulsLogger:new Fq.a,serviceBase:this.Ga.getSetting("VersionHistoryWebServiceBase"),
latestStreamServiceBase:this.Ga.ka("PPTVHPodsBootEnabled")?this.Ga.getSetting("PODSLatestServiceBase")+"&PodSID="+this.Ga.getSetting("PodSID"):"",docId:v.AFrameworkApplication.jh,appSettings:Object.assign(new pr,{appName:100,wdEnableDownloadTokens:!0,retryCount:this.Ga.getSetting("PodVHRetryCount"),wdEnableSaveACopy:this.mc.Fn,wdEnableRestore:this.mc.Fn,userSessionId:v.AFrameworkApplication.userSessionId,wacCluster:this.Ga.Ha("WacCluster"),uiLocale:this.Ga.rJa?this.Ga.rJa:"en-us",isRtl:v.AFrameworkApplication.isRtl,
disabledChangeGates:this.Ga.Ha("VHSDisabledChangeGates"),wdEnableSaveACopyOverFlowMenu:this.Ga.ka("PPTVersionHistorySaveACopyOverFlowMenuIsEnabled"),wdEnableDeleteVersions:this.Ga.ka("PPTVersionHistoryDeleteVersionsIsEnabled")}),perfTelemetryInfos:this.l8c}))),this.iH&&this.iH.setDisableSaveACopy(v.AFrameworkApplication.EJ),this.Khl());return 32}QJe(t,P,ia){return 1===ia&&this.Xa.xda?2:this.ia.processAction(E.a.Aqc,ia)}Cvj(t,P,ia){if(1===ia)return this.Jth()?2:32;this.aY.onCopySlides();return 32}Khl(){var t;
if(!document.getElementById("VersionHistoryOverlay")){this.vPk();this.rPk();this.sPk();this.mPk();this.kPk();this.qPk();this.pPk();this.nPk();const P=document.createElement("div");P.id="VersionHistoryOverlay";P.style.width="100%";P.style.zIndex="998";P.style.display="block";P.style.position="absolute";P.style.top="0px";if(this.Ga.ka("RegionComposerIsEnabled")){const ia=(null===(t=document.getElementById("HeaderRegion"))||void 0===t?void 0:t.offsetHeight)||0;P.style.top=ia+"px";P.style.bottom="0px";
P.style.height=`calc(100vh - ${ia}px)`}else P.style.height="calc(100% + "+Na.AFrame.jqd+"px)";document.getElementById("WACInnerFrame").appendChild(P);this.jBe=this.iH.createVersionHistoryDialog(P);this.Gjb()}document.getElementById("VersionHistoryOverlay").style.display="block";this.iH.getTipVersion&&this.Ga.ka("PPTVHPodsBootEnabled")&&this.iH.getTipVersion();this.iH.getVersions("");this.t3h()}t3h(){try{this.rBb=this.hak.Q5i();for(let t=0;t<this.rBb.length;t++)this.mh.Ho(this.rBb[t]);this.mh.EK(fd.a.TOb)}catch(t){n.ULS.sendTraceTag(512508633,
822,10,"VersionHistoryPaneActor: exception in ActivateVersionHistoryFocus: {0}.",t)}}gIi(){try{if(this.rBb)for(let t=0;t<this.rBb.length;t++)this.mh.EK(this.rBb[t]);else n.ULS.sendTraceTag(512508632,822,10,"VersionHistoryPaneActor: editorActiveF6Focuses is null.");this.mh.Ho(fd.a.TOb)}catch(t){n.ULS.sendTraceTag(512508631,822,10,"VersionHistoryPaneActor: exception in DeactivateVersionHistoryFocus: {0}.",t)}}vPk(){this.iH.getFullAppErrorEvent().addListener(t=>{try{const P=wn.w4f().mbl.ga(t);this.pEb[wn.pzf]=
P;n.ULS.sendTraceTag(512508630,822,50,"FullApp Error Event: {0}, VersionHistoryLaunchSessionId: {1}",P,this.zhc)}catch(P){n.ULS.sendTraceTag(512508629,822,10,"Exception in FullAppErrorEvent call back: {0}.",P)}})}rPk(){this.iH.getVersionsReadyEvent().addListener(t=>{this.gkh(t.containerDiv);this.x7h(t.versions);this.Fa.tY("VersionHistoryOverlay",!0);try{this.g4&&this.g4.DownloadUrl.length&&this.aY&&(this.rJh(),this.Ubg(),this.aY.onVersionSelected(this.g4,this.MAb,this.NXa),this.tDf())}catch(P){n.ULS.sendTraceTag(512508628,
822,10,"VersionHistoryPaneActor: Exception in VersionReadyEvent callback: {0}",P)}})}x7h(t){const P=this.aY.getAppDataStore();for(const ia of t)P.AddVersionInfoToStore(ia)}sPk(){this.iH.getVersionSelectedEvent().addListener(t=>{this.g4=t.currentVersion;this.MAb=t.baseVersion;if(this.aY&&this.g4.DownloadUrl.length)try{this.rJh(),this.Ubg(),this.aY.onVersionSelected(t.currentVersion,t.baseVersion,this.NXa),this.KQk(),this.tDf()}catch(P){n.ULS.sendTraceTag(512508627,822,10,"VersionHistoryPaneActor: Exception in VersionSelectedEvent callback: {0}",
P)}})}KQk(){const t=this.f6b(2);t&&(nd.a.addHandler(t,oa.a.Zf,Object(r.a)(this,this.Sz,"keyDownHandler")),Aj.a.instance.pb(t,Object(r.a)(this,this.bC,"contextMenuHandler")))}Dwl(){const t=this.f6b(2);t&&(nd.a.removeHandler(t,oa.a.Zf,Object(r.a)(this,this.Sz,"keyDownHandler")),Aj.a.instance.yb(t,Object(r.a)(this,this.bC,"contextMenuHandler")))}Sz(t){try{if(t.shiftKey&&t.keyCode===wa.a.jpa||t.keyCode===wa.a.cMa){const P=Zo.a.create(oa.a.contextMenu,t,1);this.bC(P)}}catch(P){n.ULS.sendTraceTag(512508626,
822,10,"VersionHistoryPaneActor:  Exception in KeyDownHandler: {0}",P)}}bC(t){if(1===t.Yf){const P=this.f6b(2);P&&(t.clientPoint.x=Ze.a.AQc(P)+Xb.a.Ura,t.clientPoint.y=Ze.a.BQc(P)+Xb.a.Ura)}return 32===this.ia.La(hb.a.iGf,2,t)}mPk(){this.iH.getDownloadTokenReadyEvent().addListener(t=>{try{if(n.ULS.sendTraceTag(512508625,822,50,"VersionHistoryPaneActor - GetDownloadTokenReadyEvent called."),this.MAb)if(t&&t.updatedVersions&&2<=t.updatedVersions.length){let P=null,ia=null;const Aa=Ql.s5b(this.g4),Ka=
Ql.s5b(this.MAb);for(const pb of t.updatedVersions){const Nb=Ql.s5b(pb);Aa===Nb?P=pb:Ka===Nb&&(ia=pb);if(P&&ia)break}P&&ia?(this.g4=P,this.MAb=ia,this.aY.diff(this.g4,this.MAb)):n.ULS.sendTraceTag(512508623,822,50,"VersionHistoryPaneActor - does not find currentVersion or baseVersion from UpdatedVersions. RevisionID[N]: {0}, RevisionID[N-1]: {1}.",Aa,Ka)}else n.ULS.sendTraceTag(512508622,822,50,"VersionHistoryPaneActor - no diff call due to downloadTokenReadyObject or downloadTokenReadyObject.UpdatedVersions objects are null or not enough.");
else n.ULS.sendTraceTag(512508624,822,50,"VersionHistoryPaneActor - m_baseVersion is null in GetDownloadTokenReadyEvent callback.")}catch(P){n.ULS.sendTraceTag(512508621,822,10,"VersionHistoryPaneActor: Exception in GetDownloadTokenReadyEvent callback: {0}",P)}})}qPk(){this.iH.getSaveACopySelectedEvent().addListener(t=>{n.ULS.sendTraceTag(512508620,822,10,"VersionHistoryPaneActor:  RegisterForSaveACopySelectedEvent: {0}",t);this.Ga.ka("PowerPointVersionHistoryFloodGateIsEnabled")&&Ql.Gkk();let P=
v.AFrameworkApplication.Czb;this.Ga.ka("VHSaveACopyForOdcOnSpoEnabled")&&(P=32===this.ia.processAction(hb.a.vlc,1));t=P?this.ia.La(hb.a.vlc,2,{["FileDownloadUrl"]:t}):this.ia.La(E.a.Nib,2,{["FileDownloadUrl"]:t});32!==t?(jb.c(hb.a.YTd,!1),n.ULS.sendTraceTag(512508619,832,10,"Failed to launch Save a Copy dialog. ActionResponse: {0}",t)):jb.c(hb.a.YTd,!0)})}xCh(t,P){try{(new Promise((ia,Aa)=>{this.iH.setRestoreInProgress();this.Dea.kJc(this.Xa.Kk,this.Xa.podSessionId,this.Xa.presentationId.string,this.Ga.getSetting("361"),
this.Xa.V$,!1,!0,()=>{ia(!0)},Ka=>{Aa("ClosePopWacSessionSync:: "+Ka.error.message)})})).then(()=>{(new Promise((ia,Aa)=>{this.Dea.Wkd(this.Xa.presentationId.string,t,()=>{ia(!0)},Ka=>{Aa("RestoreFileVersion:: "+Ka.error.message)})})).then(()=>{const ia=Date.now()-P;n.ULS.sendTraceTag(512508618,832,50,"VersionHistoryPaneActor: successfully restored version, refreshing now. Time: {0}",ia);this.pEb.RestoreSucceededTime=ia;this.ia.La(hb.a.refresh,2,{["IsSourceVH"]:!0});jb.c(hb.a.n_b,!0)}).catch(ia=>
{const Aa=Date.now()-P;this.iH.setRestoreFailedAtServer(()=>{this.ia.La(hb.a.refresh,2,{["IsSourceVH"]:!0})});n.ULS.sendTraceTag(512508617,832,10,"VersionHistoryPaneActor: Failed to restore version: {0}, Time: {1}",ia,Aa);this.pEb.RestoreFailedTime=Aa;jb.c(hb.a.n_b,!1)})})}catch(ia){n.ULS.sendTraceTag(512508616,832,10,"VersionHistoryPaneActor: Sending restore failed with message: {0}",ia.message),jb.c(hb.a.n_b,!1)}}pPk(){this.iH.getRestoreVersionSelectedEvent().addListener(t=>{n.ULS.sendTraceTag(512508615,
832,50,"VersionHistoryPaneActor:  RegisterForRestoreVersionSelectedEvent: {0}",t);const P=Date.now();this.qE?(this.Npe=this.qE.g4b(),0<this.Npe.length?(n.ULS.sendTraceTag(512508614,832,15,"VersionHistoryPaneActor: restore failed because of {0} coauthors",this.Npe.length),jb.c(hb.a.n_b,!1),this.iH.setCoauthRestoreError(),this.Ga.ka("PPTVersionHistoryRestoreSurveyEnabled")&&Ql.DXj()):this.xCh(t,P)):(n.ULS.sendTraceTag(512508613,832,10,"VersionHistoryPaneActor: presence manager is null"),this.xCh(t,
P))})}nPk(){this.iH.getDownloadVersionSelectedEvent().addListener(t=>{n.ULS.sendTraceTag(512508612,832,50,"VersionHistoryPaneActor: RegisterForDownloadVersionSelectedEvent called");t=new Ni.QueryStringBuilder(t);t.Ki(qf.a.F8g,v.AFrameworkApplication.fileName);t=this.ia.La(E.a.downloadACopy,2,{["FileDownloadUrl"]:t.toString()});32!==t?(jb.c(hb.a.XTd,!1),n.ULS.sendTraceTag(512508611,832,10,"Download version failed with result: {0}",t)):jb.c(hb.a.XTd,!0)})}rJh(){for(const t of this.l8c){const P=t.TelemetryEventKey?
t.TelemetryEventKey:t.telemetryEventKey?t.telemetryEventKey:"",ia=t.TelemetryEventData?t.TelemetryEventData:t.telemetryEventData?t.telemetryEventData:"";ab.a.Wa(P)||ab.a.Wa(ia)||(this.NXa[P]=ia)}}tDf(){this.l8c=[];this.NXa={}}kPk(){this.iH.getCloseSelectedEvent().addListener(()=>{this.Ga.ka("PowerPointVersionHistoryFloodGateIsEnabled")&&Ql.CXj();this.eEf()})}eEf(){this.gIi();this.Fa.x5("VersionHistoryOverlay");document.getElementById("VersionHistoryOverlay").style.display="none";this.Ga.dxf&&(this.g4=
null);n.ULS.sendTraceTag(512508610,822,50,fe.c(this.pEb))}gkh(t){try{if(this.aY)Uf.setIsPageLoadForFirstTime(!1),this.aY.switchParentViewContainer(t);else{Uf.setIsPageLoadForFirstTime(!0);const P=new PowerPointVersionHistory.AppBootSettings;P.RenderServiceBase="";P.IsRtl=v.AFrameworkApplication.isRtl;const ia=new PowerPointVersionHistory.AppCallbackBag;ia.animationDecoratorCallback=Object(r.a)(this.xw,this.xw.cWd,"createAnimationOrTransitionStar");ia.notesIconDecoratorCallback=Object(r.a)(this,this.XDi,
"createNotesIcon");ia.addToF6LoopCallback=Object(r.a)(this,this.f7h,"addToF6Loop");ia.copySlideCallback=Object(r.a)(this,this.copySlideCallback,"copySlideCallback");ia.reportViewerErrorCallback=Aa=>{this.pEb[wn.pzf]=wn.w4f().NDl.ga(Aa);106!==Aa&&103!==Aa||this.iH.setViewerError(!0);n.ULS.sendTraceTag(512508609,822,50,"Versions viewer error: {0}",Aa);0!==Aa&&(v.AFrameworkApplication.xp(Lk.a.Uh(406)),Vb.Health.instance.recordQosError("VersionHistoryFailed",["VersionHistoryACE"],!1,!1,!0,!1,null));return!0};
P.IsHighContrast=!1;this.Bi&&(P.IsHighContrast=this.Bi.isInHighContrastMode);P.IsHighContrast&&(P.ClientColorSettings=this.Bi.highContrastColors.foregroundTextColor+"_"+this.Bi.highContrastColors.backgroundColor+"_"+this.Bi.highContrastColors.linkColor);if(this.qc){const Aa=this.qc.OSa();P.DefaultSlideWidth=Aa.width;P.DefaultSlideHeight=Aa.height}P.UserSessionId=v.AFrameworkApplication.userSessionId;P.VersionViewerCssUrl=this.Ga.versionHistoryViewerCssUrl;P.ProgressImageResourceUrl=ig.a.RK(Xb.a.Bna);
P.ThumbnailShareOptimizationEnabled=this.Ga.pptvhThumbnailShareOptimizationEnabled;P.SlidePrefetchSettings=Object.assign(new PowerPointVersionHistory.SlidePrefetchSettings,{SlidePrefetchEnabled:this.Ga.ka("PPTVHSlidePrefetchEnabled"),SlidePrefetchAhead:this.Ga.getSetting("PPTVHSlidePrefetchAhead"),SlidePrefetchBehind:this.Ga.getSetting("PPTVHSlidePrefetchBehind"),SlidePrefetchChunkSize:this.Ga.getSetting("PPTVHSlidePrefetchChunkSize"),SlidePrefetchDelay:this.Ga.getSetting("PPTVHSlidePrefetchDelay")});
P.FileExtension=void 0!==this.Ga.qJa&&null!==this.Ga.qJa?ab.a.bT(this.Ga.qJa).toLowerCase():"";P.SlideInformationLabel=ResourceStrings.l_SlideMenuButtonLabel;P.NotesButtonLabel=ResourceStrings.L_Notes;P.SynchronizerTimeout=this.Ga.getSetting("PptVersionHistorySynchronizerTimeout");P.IsRtl=v.AFrameworkApplication.isRtl;P.IsCopySlidesEnabled=!0;P.SlidePaneLabel=ResourceStrings.L_SlidePaneLabelVH;P.ThumbnailPaneLabel=ResourceStrings.L_ThumbnailPaneLabelVH;P.NotesPaneLabel=ResourceStrings.L_NotesPaneLabelVH;
P.StatusBarLabel=ResourceStrings.L_StatusBarLabelVH;P.Lcid=v.AFrameworkApplication.lcid;P.EnableOverflowXOnSlideAndNotePane=this.Ga.ka("PodVHEnableOverflowXOnSlideAndNotePane");P.ThumbnailInfoLabel=ResourceStrings.L_ThumbnailInfoLabelVH;P.IsModernCatchUpUxEnable=!0;P.IsRevisionTrackingFlyoutEnabled=$c.a("EnableRevisionTrackingFlyoutForVH");P.RevisionTrackingFlyoutContent=ResourceStrings.l_SlideIsChanged;this.aY=new PowerPointVersionHistory.AppVersionController(P,t,ia)}}catch(P){this.iH.setViewerError(!0),
n.ULS.sendTraceTag(512508608,822,50,"PPTVersionHistorySelectionHandler: ResetAppVersionController failed due to exception. {0}",P)}}XDi(){return Da.createClusteredImage(14,14,"ToolbarNotesActiveDark_14x14x32",null,!0,ResourceStrings.L_Notes)}Gjb(){const t=this.Fa.Gc("VersionHistoryOverlay");t.parent=Na.AFrame.nj;t.zL=!0;t.HQe=!0;t.Uba(P=>{P&&"dialog/modal"===P.name?this.iH.setSaveACopyCanceled():P&&P.name===Na.AFrame.VO||(this.$ua=-1,this.tDh(!0))});this.mh.w2("VersionHistoryOverlay");this.mh.qpc(fd.a.TOb,
P=>{this.tDh(P)});this.mh.hLb(fd.a.TOb,()=>{2===this.$ua&&Sys.UI.DomElement.addCssClass(this.f6b(2),"PPTVHViewerElementSelected");3===this.$ua&&Sys.UI.DomElement.addCssClass(this.f6b(3),"PPTVHViewerElementSelected")})}tDh(t){try{const P=this.YTc();(this.$ua=this.qcj(t))?1===this.$ua?this.jBe.then(ia=>{ia.enterHeaderFocusTrapZone();return null}):P&&Wb.FocusManager.Sr(document.getElementById(P[this.$ua])):this.jBe.then(ia=>{ia.enterFocusTrapZone();return null})}catch(P){n.ULS.sendTraceTag(512508579,
822,10,"VersionHistoryPaneActor: exception in SetupFocus callback: {0}.",P)}}qcj(t){const P=this.YTc();let ia=this.$ua;do if(t?P&&(ia=(ia+1)%P.length):P&&(ia=0<ia?ia-1:P.length-1),!ia||1===ia||P&&"none"!==document.getElementById(P[ia]).style.display)return ia;while(ia!==this.$ua);return 0}Ubg(){const t=Ql.s5b(this.g4);this.Kad[t]||(this.Kad[t]=["VersionListPane","vhHeader"],this.$ua=-1)}YTc(){if(!this.g4)return this.Ga.dxf?["VersionListPane","vhHeader"]:null;const t=Ql.s5b(this.g4);return this.Kad[t]?
this.Kad[t]:null}f6b(t){const P=this.YTc();return P&&P.length>t?document.getElementById(P[t]):null}f7h(t){try{const P=this.YTc();P&&P.push(t)}catch(P){n.ULS.sendTraceTag(512508578,822,10,"VersionHistoryPaneActor: exception in AddToF6Loop: {0}.",P)}return!0}copySlideCallback(t){if(this.Jth())return!1;const P=Ca.a.create().toString();n.ULS.sendTraceTag(512508577,832,50,"Execute CopySlideCallback - correlationid : {0}",P);const ia=this.fO.DKc(1,t.SlideIds.length),Aa={};Aa.WacSessionId=v.AFrameworkApplication.userSessionId;
Aa.CallerCorrelationId=P;var Ka={};Ka.Source=t.Source;Ka.SlideIds=t.SlideIds;Ka.CcpId=ia.Gp;Ka.PackageAccessKey=ia.ty;t=JSON.stringify(Ka);Ka=String.format("{0}{1}",this.Ga.podsWebServiceBase,"vhcopyslide.ashx");const pb=Date.now();try{if(this.tw.Aj(Ka,2,t,Aa,!1,0,Nb=>{Ql.sDl(Nb,pb,P)},Nb=>{Ql.rDl(Nb,pb,P)},null,null),this.lh.contentWindow&&this.lh.contentWindow.document&&this.lh.contentWindow.document.body){cb.a.WIc(this.lh);const Nb=cb.a.nca();Nb.innerText=cb.a.v_g;Nb.setAttribute(Pp.a.Gp,ia.Gp);
Nb.setAttribute(Pp.a.mD,ia.mD);Nb.setAttribute(Pp.a.count,ia.objectCount.toString());const kc=qr.a(ia.dataType);Nb.setAttribute(Pp.a.type,kc);Nb.setAttribute(Pp.a.location,ia.location);Nb.setAttribute(Pp.a.ty,ia.ty);this.lh.contentWindow.document.body.appendChild(Nb);this.Ioe.Tib(this.lh);this.V$c.copy(this.lh)}else n.ULS.sendTraceTag(512508576,832,10,"VersionHistoryPaneActor cannot set minimal HTML metadata to system clipboard ")}catch(Nb){n.ULS.sendTraceTag(512508575,832,10,"VersionHistoryPaneActor exception in CopySlideCallback: {0}",
Nb)}return!0}Jth(){return(v.AFrameworkApplication.yR||v.AFrameworkApplication.EJ)&&!v.AFrameworkApplication.tRa}dispose(){document.getElementById("VersionHistoryOverlay")&&"none"!==document.getElementById("VersionHistoryOverlay").style.display&&this.eEf();this.Dwl()}static s5b(t){return t.RevisionID?t.RevisionID:t.revisionID?t.revisionID:""}static sDl(t,P,ia){const Aa=Date.now();try{JSON.parse(t.data.Zd).IsCopied?n.ULS.sendTraceTag(512508574,832,50,"VhCopySlide operation succeeded : Duration : {0}, correlationId : {1}",
Aa-P,ia):n.ULS.sendTraceTag(512508573,832,10,"VhCopySlide operation failed : Duration : {0}, correlationId : {1}",Aa-P,ia)}catch(Ka){n.ULS.sendTraceTag(512508572,832,10,"VersionHistoryPaneActor exception in VHCopySlideRequestSucceeded: {0}, correlationId : {1} ",Ka,ia)}}static rDl(t,P,ia){const Aa=Date.now();n.ULS.sendTraceTag(512508571,832,10,"VhCopySlide operation failed : Duration : {0}, HttpStatusCode : {1}, correlationId : {2}",Aa-P,t.data?t.data.Te:-1,ia)}static CXj(){const t=A.a.instance.rb("Common.ISystemInitiatedFeedback");
t?(t.logActivity("VersionHistoryExited",null),t.logActivity("VersionHistoryCheckExited",null)):n.ULS.sendTraceTag(512508570,822,50,"ISystemInitiatedFeedback was null")}static Gkk(){const t=A.a.instance.rb("Common.ISystemInitiatedFeedback");t?t.logActivity("VersionHistoryExited",null):n.ULS.sendTraceTag(512508569,822,10,"ISystemInitiatedFeedback was null")}static DXj(){const t=A.a.instance.rb("Common.ISystemInitiatedFeedback");t?t.logActivity("VersionHistoryRestoreCoauthFailed",null):n.ULS.sendTraceTag(512508568,
822,10,"LaunchVHRestoreFailedDuringCoauthFloodgateSurvey::ISystemInitiatedFeedback was null")}}Object(k.a)(Ql,"VersionHistoryPaneActor",null,[804,106]);class rr{constructor(){this.gBc=this.Da=null}get name(){return"PowerPointWebEditor.VersionHistory"}$b(t){this.Da=t}init(){v.AFrameworkApplication.fa.jf(Object(r.a)(this,this.Om,"onFullAppSettingsReady"))}Om(){v.AFrameworkApplication.K_c()?this.Da.resolve("PowerPointWebEditor.IApplicationSettings").iZc?n.ULS.sendTraceTag(42755924,202,50,"PPTWebEditorVersionHistoryPackageManager:Init - Not initializing the React VersionHistory package because the file is open password protected"):
(n.ULS.sendTraceTag(39711108,202,50,"PPTWebEditorVersionHistoryPackageManager:Init - Initializing the React VersionHistory package"),Ya.a.get_instance().Dk(7,()=>{kl.a(this.Da)("versionHistory").catch(t=>n.ULS.sendTraceTag(39711109,811,10,"Failed to load the resources for the versionHistory feature: {0}",t)).then(()=>this.tuk()).catch(t=>n.ULS.sendTraceTag(39711110,811,10,"Failed to initialize the versionHistory feature: {0}",t))})):n.ULS.sendTraceTag(39711106,202,50,"PPTWebEditorVersionHistoryPackageManager:Init - Not initializing the React VersionHistory package because the feature is disabled")}tuk(){this.v0b();
return null}v0b(){this.Da.register(Ql,"PowerPointWebEditor.VersionHistory.VersionHistoryPaneActor").oa(()=>new Ql(v.AFrameworkApplication.Ta,this.Da.resolve("PowerPointWebEditor.IThumbnailViewHelper"),this.Da.resolve("Common.Utils.IHighContrastDetector"),this.Da.resolve("PowerPointWebEditor.IApplicationSettings"),this.Da.resolve("PowerPointWebEditor.IPresentationReader"),Wb.FocusManager.instance(),ql.a.instance,this.Da.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),this.Da.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),
this.Da.resolve("PowerPointWebEditor.IPopWebService"),this.Da.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.Da.Ja("PowerpointPresence.IPresenceManager"),this.Da.resolve("PowerPointWebEditor.IClipServiceManager"),this.Da.resolve("PowerPointWebEditor.IDesignModeManager").dCa,this.Da.resolve("PowerPoint.IBrowserHelperManager"),this.Da.resolve("PowerPointWebEditor.ISystemClipboard"),v.AFrameworkApplication.Je)).ma();this.gBc=this.Da.resolve("PowerPointWebEditor.VersionHistory.VersionHistoryPaneActor");
this.gBc.vb()}dispose(){this.gBc&&this.gBc.dispose()}}Object(k.a)(rr,"PPTWebEditorVersionHistoryPackageManager",null,[2,3]);var Hq=d(453),uu=d(722),Go;(function(t){t[t.anyone=0]="anyone";t[t.organization=1]="organization"})(Go||(Go={}));Object(k.b)("AccessControlEnum",Go);var $o=d(376);class Iq{constructor(){this.token=this.timeStamp=null}}Object(k.a)(Iq,"CachedAccessToken",null,[]);class fs{constructor(t){this.Loe={};this.Q5j=t}Hmi(t,P){if(!ab.a.Wa(t)&&!ab.a.Wa(P)){const ia=new Iq;ia.token=P;ia.timeStamp=
new Date;this.Loe[t]=ia}}aYf(t){return t in this.Loe&&(t=Object(R.a)(Iq,this.Loe[t]),+new Date-+t.timeStamp<6E4*this.Q5j)?t.token:null}}Object(k.a)(fs,"AccessTokenCache",null,[]);class Ak{constructor(){this.reject=this.resolve=this.frame=this.ufa=this.J3e=this.resource=this.appId=this.authority=this.id=null;this.Tkb=0;this.fQe=null;this.Ykc=0;this.BDh=!1}}Object(k.a)(Ak,"DirectAuthRequest",null,[]);class ap{constructor(t){this.yfc={};this.la=t;this.UEb=new fs(this.la.VBk);window.addEventListener("message",
Object(r.a)(this,this.eXk,"requestCompletionMessageHandler"),!1)}h0f(t){const P={},ia=RegExp("[#?&]+([^=&]+)=([^&]*)","gi");let Aa;for(;Aa=ia.exec(t);)P[Object(R.a)(String,Aa[1])]=Object(R.a)(String,Aa[2]);return P}eXk(t){if("data"in t){var P;({kv:P}=fe.d(t.data)).returnValue&&P&&"DirectAuthRequestID"in P&&this.cxb(P)}}cxb(t){try{const Aa=t.DirectAuthRequestID;if(Aa in this.yfc){var P=null,ia=Object(R.a)(Ak,this.yfc[Aa]);if(ia&&ia.id===Aa){O.a.J(594405506,833,50,"DirectAuth: Request completed with request ID: {0}, IsTimedOut: {1}, IsFromPolling: {2}",
Aa,"Timeouted"in t,"FromPolling"in t);window.clearTimeout(ia.Tkb);delete this.yfc[Aa];window.clearTimeout(ia.Ykc);const Ka=new $o.a;Ka.IsSuccess=!1;Ka.ErrorCode="";Ka.ErrorMessage="";Ka.Token="";"Timeouted"in t?(O.a.J(592238722,833,10,"DirectAuth: Request timed out with host: "+window.location.host),Ka.ErrorCode="Timeout",Ka.ErrorMessage="No response received in time for the authentcation request",ia.resolve(Ka)):"PopupWindowClosed"in t&&ia.ufa?(Ka.ErrorCode="User_aborted",Ka.ErrorMessage="User aborted log in by closing the popup window",
ia.resolve(Ka)):(ia.frame?P=this.h0f(ia.frame.contentWindow.location.hash):ia.ufa&&!ia.ufa.closed&&(P=this.h0f(ia.ufa.location.hash)),"access_token"in P?(Ka.IsSuccess=!0,Ka.Token=Object(R.a)(String,P.access_token),this.UEb&&this.UEb.Hmi(ia.fQe,Ka.Token),ia.resolve(Ka)):(Ka.ErrorCode="error"in P?Object(R.a)(String,P.error):"unknown",0<=Array.indexOf(this.la.XBk,Ka.ErrorCode)&&ia.BDh&&ia.frame&&!ia.ufa?this.vBk(ia.authority,ia.appId,ia.resource,ia.J3e,this.la.YBk).then(pb=>{ia.resolve(pb)}).catch(pb=>
{ia.reject(pb)}):(Ka.ErrorMessage="error_description"in P?Object(R.a)(String,P.error_description):"unknown",ia.resolve(Ka))));ia.frame?document.body.removeChild(ia.frame):ia.ufa&&!ia.ufa.closed&&ia.ufa.close()}else O.a.J(594068425,833,10,"DirectAuth: Failed to find the request entry for ID: {0}",Aa)}else O.a.J(594405508,833,50,"DirectAuth: Request response doesn't have request ID! Details: "+JSON.stringify(t))}catch(Aa){O.a.J(594375829,833,10,"DirectAuth: Excpetion thrown when handling completion response: "+
Aa.message)}}UJc(t){const P=window.location.protocol,ia=window.location.host;O.a.J(594113502,833,50,"DirectAuth: ConstructReplyUrl: Protocol: {0}, Host: {1}, IsReplyUrlRegistered: {2}",P,ia,"ffc-powerpoint.officeapps.live.com"===ia||"ppc-powerpoint.officeapps.live.com"===ia);if(void 0===t||null===t){t=window.location.pathname;const Aa=t.lastIndexOf("/");t=0<=Aa?t.substring(0,Aa+1):""}return P+"//"+ia+t+"WacDirectAuth.html"}Qtl(t,P,ia,Aa,Ka,pb=!1){return this.Thl(t,P,ia,Aa,Ka,pb)}vBk(t,P,ia,Aa,Ka){if(ab.a.Wa(t))throw Error.argumentNull("authority");
if(ab.a.Wa(P))throw Error.argumentNull("appId");if(ab.a.Wa(ia))throw Error.argumentNull("resource");if(ab.a.Wa(Aa))throw Error.argumentNull("userUPN");const pb=!ab.a.Wa(Aa)&&Aa.indexOf("@")<Aa.indexOf("."),Nb=this.UJc("/p/"),kc=String.format("{0}/common/oauth2/authorize?response_type=token&scope=openid&domain_hint=organizations&client_id={1}&resource={2}&redirect_uri={3}",t,P,encodeURIComponent(ia),encodeURIComponent(Nb));if(this.UEb){const hd=this.UEb.aYf(kc);if(!ab.a.Wa(hd))return O.a.J(593782154,
833,50,"DirectAuth: Found valid cached token and use it!"),new Promise(se=>{const Ae=new $o.a;Ae.IsSuccess=!0;Ae.ErrorCode="";Ae.ErrorMessage="";Ae.Token=hd;se(Ae)})}const Rc=Ca.a.create().toString(),Yc=String.format("{0}&state={1}",kc,Rc);return new Promise((hd,se)=>{const Ae=new Ak;Ae.authority=t;Ae.appId=P;Ae.resource=ia;Ae.J3e=Aa;Ae.resolve=hd;Ae.reject=se;Ae.id=Rc;Ae.fQe=kc;Ae.ufa=window.open("",Rc,"width=400, height=600");Ae.ufa?(this.yfc[Rc]=Ae,Ae.ufa.location.replace(Yc),O.a.J(593782152,833,
50,"DirectAuth: New popup request created with ID of: {0}, IsUserUPNAlias: {1}",Rc,pb),this.pxh(Ae,1E3*Ka).then(()=>{const we={};we.DirectAuthRequestID=Rc;we.FromPolling=!0;this.cxb(we)}).catch(we=>{"WindowClosed"===Object(R.a)(String,we)&&(we={},we.DirectAuthRequestID=Rc,we.PopupWindowClosed=!0,O.a.J(593782150,833,10,"DirectAuth: Popup window closed for request with ID of: "+Rc),this.cxb(we))}),Ae.Tkb=window.setTimeout(()=>{const we={};we.DirectAuthRequestID=Rc;we.Timeouted=!0;O.a.J(593782148,833,
10,"DirectAuth: Popup request timedout with ID of: "+Rc);this.cxb(we)},1E3*Ka)):(O.a.J(593364752,833,50,"DirectAuth: Popup window was blocked and cannot continue request of {0}",Rc),se=new $o.a,se.IsSuccess=!1,se.ErrorCode="fail_to_open_popup",se.ErrorMessage="Failed to create popup window!",se.Token="",hd(se))})}Thl(t,P,ia,Aa,Ka,pb){if(ab.a.Wa(t))throw Error.argumentNull("authority");if(ab.a.Wa(P))throw Error.argumentNull("appId");if(ab.a.Wa(ia))throw Error.argumentNull("resource");if(ab.a.Wa(Aa))throw Error.argumentNull("userUPN");
const Nb=!ab.a.Wa(Aa)&&Aa.indexOf("@")<Aa.indexOf(".");var kc=this.UJc("/p/");const Rc=String.format("{0}/common/oauth2/authorize?response_type=token&scope=openid&domain_hint=organizations&client_id={1}&resource={2}&redirect_uri={3}&prompt=none",t,P,encodeURIComponent(ia),encodeURIComponent(kc));if(this.UEb){const se=this.UEb.aYf(Rc);if(!ab.a.Wa(se))return O.a.J(594134859,833,50,"DirectAuth: Found valid cached token and use it!"),new Promise(Ae=>{const we=new $o.a;we.IsSuccess=!0;we.ErrorCode="";
we.ErrorMessage="";we.Token=se;Ae(we)})}const Yc=Ca.a.create().toString();kc=Nb?String.format("{0}&login_hint={1}&state={2}",Rc,encodeURIComponent(Aa),Yc):String.format("{0}&state={1}",Rc,Yc);const hd=document.createElement("iframe");hd.style.display="none";hd.src=kc;return new Promise((se,Ae)=>{const we=new Ak;we.authority=t;we.appId=P;we.resource=ia;we.J3e=Aa;we.frame=hd;we.resolve=se;we.reject=Ae;we.id=Yc;we.fQe=Rc;we.BDh=pb;document.body.appendChild(hd);O.a.J(594405504,833,50,"DirectAuth: New silent request created with ID of: {0}, IsUserUPNAlias: {1}",
Yc,Nb);this.pxh(we,1E3*Ka).then(()=>{const Jf={};Jf.DirectAuthRequestID=Yc;Jf.FromPolling=!0;this.cxb(Jf)});we.Tkb=window.setTimeout(()=>{const Jf={};Jf.DirectAuthRequestID=Yc;Jf.Timeouted=!0;O.a.J(594405464,833,10,"DirectAuth: Silent request timedout with ID of: "+Yc);this.cxb(Jf)},1E3*Ka);this.yfc[Yc]=we})}pxh(t,P){return new Promise((ia,Aa)=>{const Ka=P/50;let pb=0;t.Ykc=window.setInterval(()=>{try{pb++>Ka&&(window.clearInterval(t.Ykc),O.a.J(594068418,833,15,"DirectAuth: WindowHashPoller: Exceeded {0} ms timeout after {1} polls",
P,Ka),Aa(""));const Nb=t.frame?t.frame.contentWindow:t.ufa;if(!Nb||Nb.closed)window.clearInterval(t.Ykc),O.a.J(594068416,833,15,"DirectAuth: WindowHashPoller: Window or Frame is closed before completion"),Aa("WindowClosed");let kc=null,Rc=null;try{kc=Nb.location.href,Rc=Nb.location.hash}catch(Yc){}kc&&"about:blank"!==kc?ab.a.Wa(Rc)||(window.clearInterval(t.Ykc),ia(Rc)):O.a.J(594068386,833,50,"DirectAuth: WindowHashPoller: Don't process blank pages or cross domain: {0}","about:blank"===kc)}catch(Nb){O.a.J(594068384,
833,15,"DirectAuth: WindowHashPoller: threw exception {0}",Nb.message)}},50)})}}Object(k.a)(ap,"DirectAuthHelper",null,[]);class sr{constructor(){this.welcomeScreenErrorImageUrl=this.welcomeScreenBackgroundImageUrl=this.hostElement=null;this.urlBarHeightInPercentage=this.baseZIndex=0;this.reactionsBarLayerHostId=this.dialogLayerHostId=this.urlBarLayerHostId=this.calloutContainerId=this.welcomeScreenLayerHostId=null;this.isPowerpointLiveReactionEnabled=this.showTryAgainButton=!1;this.resourceCDNPath=
this.onboardingScreenHostId=null;this.enableNewLiveWelcomeScreen=this.enablePrefetchLiveResource=!1;this.podsUrl=this.userSessionId=null}}Object(k.a)(sr,"ILiveActorSettings",null,[]);class mo{constructor(){this.react=null;this.reactionCount=0;this.reactionImagePath=null;this.numberOfAnimationFrames=0}}Object(k.a)(mo,"ILiveReaction",null,[]);class Mn{constructor(){this.isPaused=this.isPrivate=!1;this.participantsCount=0;this.sessionURLPromise=null;this.sessionCurrentState=0}}Object(k.a)(Mn,"ILiveSessionState",
null,[]);class gs{constructor(){this.sessionQRCode=this.participantUrl=null}}Object(k.a)(gs,"ILiveSessionURL",null,[]);class Bk{constructor(){this.OIg=this.NIg=null}}Object(k.a)(Bk,"PollObjectInfo",null,[]);var Qp;(function(t){t[t.none=0]="none";t[t.singleLineRibbon=1]="singleLineRibbon";t[t.multipleLineRibbon=2]="multipleLineRibbon";t[t.slideShowToolbar=3]="slideShowToolbar";t[t.slideShowKeyboardShortcut=4]="slideShowKeyboardShortcut";t[t.welcomeScreenTryAgain=5]="welcomeScreenTryAgain"})(Qp||(Qp=
{}));Object(k.b)("LiveEntryPoint",Qp);var Nn;(function(t){t[t.none=0]="none";t[t.callout=1]="callout";t[t.businessBar=2]="businessBar";t[t.pausedSessionTimeout=3]="pausedSessionTimeout";t[t.slideshowContextMenu=4]="slideshowContextMenu";t[t.accessControlChange=5]="accessControlChange";t[t.welcomeScreenTryAgain=6]="welcomeScreenTryAgain"})(Nn||(Nn={}));Object(k.b)("LiveExitPoint",Nn);var Wi=d(668);class hs{constructor(t,P,ia,Aa,Ka,pb,Nb,kc,Rc,Yc,hd,se,Ae,we){this.va=new wg.a;this.xGa=this.FBb=this.X3c=
this.Fse=this.tvg=!1;this.Icc=this.qse=this.$3c=!0;this.Sfc=this.EEb=!1;this.Rp=this.qj=this.Sda=this.Vn=null;this.tVa=0;this.UCb=-1;this.XDb=30;this.Eec=-1;this.Gd=this.mma=this.U_=null;this.nSg=this.MWg=this.c$c=this.Z9c=0;this.bbc=this.Eua=this.oVa=null;this.owe=this.fcb=0;this.ekb=null;this.KAe=new Set;this.JAe=new Map;this.M6c=null;this.Tec=1;this.Dec=this.dcc=this.AO=this.Vea=this.vBe=this.mqe=null;this.je=Aa;this.la=t;this.Evg=!1;this.kb=ia;this.qc=pb;this.jq=Nb;this.Oc=kc;this.hz=Rc;this.Xa=
Yc;this.Hc=hd;this.Kl=se;this.ZWa=Ae;this.Fa=we;if(this.kt=P)this.Sda=P.AF();this.XL=Ka;this.tVa=this.qSf?1:0;this.la.powerPointLiveBroadcastEnabled&&(this.mqe=new ap(this.la));this.Oc.WB(Object(r.a)(this,this.Q$,"onPodSessionRehydrated"));this.hz.kOd(Object(r.a)(this,this.zGb,"onPodSessionUnavailable"));this.IRa()&&this.Kl.execute(Jf=>{Jf.show(ResourceStrings.L_LivePresentations_Disconnected,Wi.a.$Fb);Jf.hide()});O.a.J(512496260,833,50,"LivePresenter: Host auth type is: "+this.la.hostAuthType)}get sr(){return this.la.powerPointLiveBroadcastEnabled&&
this.$3c}get i8a(){return this.Fse}set i8a(t){(this.Fse=t)&&this.va.raiseEvent("OnLiveResourcesLoaded",Sys.EventArgs.Empty)}get Yq(){return!!this.Rp}get Jca(){return this.Evg}set Jca(t){this.Evg=t}get jDa(){return this.tvg}set jDa(t){this.tvg=t}get LRa(){return!!this.Rp&&this.Rp.isPaused}get ZTi(){return this.X3c}get kDa(){return this.Icc}set kDa(t){this.Icc=t}get KTi(){return this.i8a&&this.sr&&!!this.Vn}get accessControl(){return this.tVa}set accessControl(t){this.tVa=t}get qSf(){return"true"===
this.n3f("wdDisablePrivateSession")?!1:"aad"===this.la.hostAuthType}get lSf(){return this.sr&&this.Yq&&this.qj?this.qj.isWelcomeScreenVisible():!1}Uub(){return this.la.isMicButtonInSlideShowToolbarEnabled&&this.la.jhd&&this.Hc.a3b?this.Hc.Wub?this.Sfc=!0:this.Hc.CSf||this.Sfc:!0}efd(t,P,ia,Aa,Ka,pb,Nb,kc,Rc){if(this.sr){this.kb.eOd(Object(r.a)(this,this.V5g,"onSlideShowEnterEndOfShow"));this.kb.fOd(Object(r.a)(this,this.W5g,"onSlideShowLeaveEndOfShow"));this.kb.LFc(Object(r.a)(this,this.Qwa,"onGetCurrentSlideDimensionsHandler"));
this.FBb=!1;this.xGa=!0;try{this.la.dhd&&this.O0i();const Yc=this.N6d(Ka,Aa);if(this.Vn)(this.jDa||this.LRa)&&this.Vn.FetchDocumentDownloadURL(Yc);else{O.a.J(512496259,833,50,"Creating Broadcast monitor ...");const hd=new PowerPointLive.PPTBroadcastMonitorSettings;hd.isBlueChicken=this.la.isBlueChicken;hd.fileDownloadUrl=Yc;hd.rendezvousSvcBaseUri=this.la.podLiveBroadcastRendezvousServiceBaseUri;hd.broadcastSubtitlesFromSpeechFrontDoor=!0;hd.pragueInitTimeoutInMS=this.la.$Bk;hd.preferredSubtitleLanguage=
this.Hc.XTc();hd.useStateService=this.la.iCk;hd.numMaxAttempts=this.la.cCk;hd.delayInSecsToCloseBroadcasterOnPause=this.la.UBk;hd.batchedRequestsEnabled=this.la.RBk;hd.sharedSessionSettings={};hd.websocketAliveTimeAfterLoseFocusInMs=this.la.jCk;hd.pingTimeoutInMs=this.la.aCk;hd.pongTimeoutInMs=this.la.bCk;hd.enableTransientSessionHandling=this.la.DCk;hd.maxStateServiceRoundtripRaw=v.AFrameworkApplication.fa.Fc("PPTLiveMaxStateServiceRoundtripRaw",300);hd.sharedSessionSettings.MaxStateServiceRoundtripRaw=
hd.maxStateServiceRoundtripRaw;hd.documentSnapshotRequestUrlGenerator=this.la.ACk?()=>this.N6d(this.Xa.podSessionId,this.Xa.nk):null;this.la.gah&&(hd.sharedSessionSettings.IsAutomation=!0);this.Vn=new PowerPointLive.PPTBroadcastMonitor(hd);this.Vn.RegisterParticipantsCountChangeEventListener(se=>{this.Gd.telemetryData.maxParticipantCount=Math.max(this.Gd.telemetryData.maxParticipantCount,se);this.qj&&this.qj.setParticipantCount(se);this.va.raiseEvent("ParticipantsCountChanged",Sys.EventArgs.Empty)});
this.Vn.RegisterNewReactionEventListener(Object(r.a)(this,this.ijk,"newReactionHandler"));this.Vn.RegisterConnectionStateEventListener(Object(r.a)(this,this.Kxi,"connectionStateHandler"))}this.Vn.SetCurrentPosition(t,P-1,null);this.fcb=t;this.jDa&&!this.Rp&&Rc?(this.erc(v.AFrameworkApplication.Aa&&v.AFrameworkApplication.Aa.hb.Np?1:2,Nb,ia,Ka,kc),this.fui(t),this.Eua=new Set):this.U_&&this.uxb();this.Eua&&this.Eua.add(t)}catch(Yc){O.a.J(512496258,833,10,"LivePresenter: Exception at creating Broadcast monitor: {0}",
Yc.toString())}}}Osl(){window.setTimeout(()=>{const t=this.fcb===this.owe;this.sr&&this.Yq&&t&&this.Rp&&!this.Rp.isPaused&&(O.a.J(512496257,833,50,"LivePresenter::TriggerSurveyOnLastSlide Triggering live survey on last slide"),this.Nsd(0),this.UNb(0))},6E4*this.la.eCk)}mtk(){this.sr&&(this.kb.hPe(Object(r.a)(this,this.V5g,"onSlideShowEnterEndOfShow")),this.kb.jPe(Object(r.a)(this,this.W5g,"onSlideShowLeaveEndOfShow")),this.kb.ikd(Object(r.a)(this,this.Qwa,"onGetCurrentSlideDimensionsHandler")),this.xGa=
this.FBb=!1,this.Yq&&this.qj&&(this.qj.hideAll(),this.nke()||(this.gzk(),this.tgl()),this.IRa()&&this.Kl.instance.hide()))}Pkl(t,P,ia,Aa,Ka,pb){try{const Nb=new PowerPointLive.RendezvousSessionConfig;Nb.userSessionId=t;Nb.webServiceBase=P;Nb.podSessionId=ia;Nb.docId=Aa;Nb.sessionId=Ka;Nb.accessControl=1===this.tVa?"organization":"anyone";Nb.authTokenFunc=pb;Nb.locale=v.AFrameworkApplication.uiCulture;Nb.presentationName=ab.a.TG(v.AFrameworkApplication.fileName);Nb.slideHeight=this.qc.zu().height;
Nb.slideWidth=this.qc.zu().width;Nb.correlationId=this.Gd.telemetryData.correlationId;Nb.showQRCodeAfterFetchingDocDownloadUrl=this.la.KCk;Nb.presenterTenantId=!this.la.isBlueChicken&&this.la.rah?v.AFrameworkApplication.fa.Ha("TenantId"):null;Nb.fileSource=v.AFrameworkApplication.fa.Ha("FileHost");this.la.gCk||(Nb.fileName=v.AFrameworkApplication.fileName,Nb.bootstrapperUrl=this.la.pptEditorSlideShowWrsEndpoint);const kc=this.Vn.StartLiveBroadcasting(Nb,this.Gd,!this.la.NJe);this.mDj();if(kc){this.Rp=
new Mn;this.Rp.isPrivate=1===this.tVa;this.Rp.isPaused=!1;this.Rp.participantsCount=0;this.Rp.sessionCurrentState=0;const Rc=kc.then(Yc=>{const hd=new gs;hd.participantUrl=Yc.sessionInfo.shortParticipantUrl;hd.sessionQRCode=Yc.sessionInfo.sessionQRCode;this.Rp.sessionCurrentState=1;return hd});this.Rp.sessionURLPromise=Rc;this.la.khd?this.Dec.then(()=>{this.qj.actOnSessionRequested(this.Rp)}):this.qj.actOnSessionRequested(this.Rp);this.kb.PFc(Object(r.a)(this,this.X5g,"onSlideShowReady"));this.kb.Esf(Object(r.a)(this,
this.onTranscriberStarted,"onTranscriberStarted"));this.kb.gOd(Object(r.a)(this,this.onPodSessionExpired,"onPodSessionExpired"));kc.then(Yc=>{this.Gd.telemetryData.pragueDocId=Yc.sessionInfo.pragueDocId;this.Gd.telemetryData.sessionCreationWebServiceCallTimeInMS=this.eL()-this.c$c;this.Gd.telemetryData.startAttemptCount=Yc.numAttempt;O.a.J(512496256,833,50,"SessionId: {0}, Message: StartLiveBroadcasting succeeded!, TimeElapsed: {1}",this.Gd.telemetryData.sessionId,this.Gd.telemetryData.sessionCreationWebServiceCallTimeInMS.toString());
this.la.NJe?(this.jpc(),this.Vn.InitializeStateService().then(()=>{this.Srh(Yc);this.O_("StartLiveBroadcasting")}).catch(hd=>{this.Gd.telemetryData.sessionEndedBeforePragueInitialized||this.Gd.telemetryData.sessionId!==Ka||(O.a.J(512496227,833,10,"SessionId: {0}, Message: failed to connect state service due to error!, Details: {1}",this.Gd.telemetryData.sessionId,hd?hd.toString():""),this.Gd.telemetryData.SetErrorCode(2,hd?hd.toString():""),this.O_("StartLiveBroadcasting"),this.Hpd())})):this.Srh(Yc);
this.la.CCk&&$addHandler(window,"visibilitychange",Object(r.a)(this,this.brk,"onPageVisibilityChangedHandler"));this.O_("StartLiveBroadcasting")}).catch(Yc=>{O.a.J(512496226,833,10,"SessionId: {0}, Message: StartLiveBroadcasting failed due to error!, Details: {1}",this.Gd.telemetryData.sessionId,Yc.toString());this.Gd.telemetryData.SetErrorCode(4,Yc.toString());this.O_("StartLiveBroadcasting");this.Hpd()})}else this.Hpd(),this.Gd.telemetryData.SetErrorCode(4,"Failed to create Promise object!"),O.a.J(512496225,
833,10,"StartLiveBroadcasting failed to create Promise object!")}catch(Nb){this.Hpd(),this.Gd.telemetryData.SetErrorCode(4,Nb.toString()),O.a.J(512496224,833,10,"SessionId: {0}, Message: Exception when staring a new Live session, Details: {1}",this.Gd.telemetryData.sessionId,Nb.toString())}finally{this.O_("StartLiveBroadcasting")}}Srh(t){const P=this.Hc.W3i(this.Hc.Eoa);P?this.Vn.SetDefaultSubtitlesLanguage(P):O.a.J(512496223,833,10,"SessionId: {0}, Message: Failed to set default subtitle language.",
this.Gd.telemetryData.sessionId);this.kb.HNb(!0,this.Vn.GetPragueSessionInfoJSONString());this.kb.nPa(Object(r.a)(this,this.Pjc,"onSlideShowPositionChanged"));this.kb.Csf(Object(r.a)(this,this.onSubtitleUpdated,"onSubtitleUpdated"));this.la.NJe&&!this.qj.isWelcomeScreenVisible()||this.jpc();this.va.raiseEvent("OnLiveSessionStarted",t.sessionInfo);this.Uub()||!this.Hc.a3b||this.Hc.CSf||this.Sfc||!this.IRa()||(this.EEb=!0,this.Kl.instance.show(ResourceStrings.l_LivePresentation_UnsupportedSpeechToast.replace("{0}",
Xk.a.ue(v.AFrameworkApplication.uiCulture).displayName),Wi.a.$Fb));this.bbc=this.Vn.CreateSurvey(t.authToken,null,null,null);this.bbc.then(ia=>{if(ia){const Aa={};Aa.surveyeeName=v.AFrameworkApplication.userName;Aa.surveyId=ia.surveyId;Aa.surveyResponseUrl=ia.surveyResponseUrl;this.Vn.SetAudienceFeedbackInfo(JSON.stringify(Aa))}});this.la.dhd&&(this.JAe.clear(),this.KAe.forEach(ia=>{try{const Aa=ia.NIg;this.Vn.CreateSurvey(t.authToken,null,Aa,ia.OIg).then(Ka=>{Ka?this.JAe.set(Aa,Ka.surveyId):O.a.J(512496222,
833,10,"SessionId: {0}, Message: Duplicated poll info is not valid!",this.Gd.telemetryData.sessionId)}).catch(Ka=>{O.a.J(512496221,833,10,"SessionId: {0}, Message: Failed to duplicate poll as DuplicateSurvey request failed due to error!, Details: {1}",this.Gd.telemetryData.sessionId,Ka.toString());this.Gd.telemetryData.SetErrorCode(13,t.toString())})}catch(Aa){O.a.J(512496220,833,10,"SessionId: {0}, Message: Exception when duplicating, Details: {1}",this.Gd.telemetryData.sessionId,Aa.toString())}}));
this.ZWa.init()?this.ZWa.YNd(Object(r.a)(this,this.xjc,"onNetworkConnectivityChanged")):O.a.J(512496219,833,10,"SessionId: {0}, Message: NetworkConnectivityProvider init failed.",this.Gd.telemetryData.sessionId)}n3f(t){t=new RegExp(String.format("[\\?&]{0}=([^&#]*)",t));return(t=window.location.search.match(t))&&2===t.length?t[1]:""}erc(t,P,ia,Aa,Ka){this.vBe=P;this.Vea=ia;this.AO=Aa;this.dcc=Ka;this.c$c=this.eL();this.Z9c=this.eL();var pb=this.n3f("wdSetLiveSessionId");pb="rdvSession_"+(pb.length?
pb:Ca.a.create().toString());this.Gd=new PowerPointLive.LiveSessionTelemetry;this.Gd.telemetryData.sessionId=pb;this.Gd.telemetryData.sessionStartUtc=(new Date).format("yyyy-MM-ddTHH:mm:ss.fffffff");this.Gd.telemetryData.accessControl=Go[this.tVa];this.Gd.telemetryData.sessionEntryPoint=Qp[t];this.Gd.telemetryData.isSubtitleStartedByLive=this.Jca;this.Gd.telemetryData.isAutomation=this.la.gah;this.Gd.telemetryData.correlationId=Ca.a.create().toString();this.O_("StartLiveBroadcasting");try{this.sr&&
this.Vn&&this.J2b()&&!this.Rp?(this.xZj(),this.kb.TXb(Object(r.a)(this,this.l3g,"onGetCurrentSlideShowPosition")),this.kb.getCurrentPosition(),this.g1d()&&this.qj&&this.Dec&&this.Dec.then(()=>{this.qj.showOnboardingScreen();this.i4e=!0}),this.Pkl(P,ia,Aa,Ka,pb,()=>this.m4b("StartLiveBroadcasting",this.Gd.telemetryData.sessionId))):(this.Gd.telemetryData.SetErrorCode(4,"Live actor or broadcast monitor is null while trying to start live session!"),O.a.J(512496218,833,10,"StartLiveBroadcasting: Live actor or broadcast monitor is null while trying to start live session!")),
this.Gd.telemetryData.isMordernSlideShow=!!this.kb&&this.kb instanceof uu.SlideShowCoreFrame}catch(Nb){this.Gd.telemetryData.SetErrorCode(4,Nb.toString()),O.a.J(512496217,833,10,"SessionId: {0}, Message: Exception when starting Live session, Details: {1}",this.Gd.telemetryData.sessionId,Nb.toString())}finally{this.O_("StartLiveBroadcasting")}}gzk(){if(this.sr&&this.Yq&&this.Vn&&this.J2b()&&!this.Rp.isPaused){this.Nsd(2);this.UNb(2);try{this.Gd.telemetryData.sessionPauseCount+=1,this.Gd.telemetryData.sessionActiveDurationInMS+=
this.eL()-this.Z9c,O.a.J(512496216,833,50,"SessionId: {0}, Message: Pause live broadcasting ...",this.Gd.telemetryData.sessionId),this.qj.actOnSessionPaused(),this.Rp.isPaused=!0,this.nSg=this.eL(),this.Vn.PauseLiveBroadcasting(()=>this.m4b("PauseLiveBroadcasting",this.Gd.telemetryData.sessionId)),this.va.raiseEvent("OnLiveSessionPaused",Sys.EventArgs.Empty),this.Wkl(),this.kb.HNb(!1)}catch(t){this.Gd.telemetryData.SetErrorCode(5,t.toString()),O.a.J(512496215,833,10,"SessionId: {0}, Message: Exception when pausing Live session, Details: {1}",
this.Gd.telemetryData.sessionId,t.toString())}finally{this.O_("PauseLiveBroadcasting")}}}Qkh(){if(this.sr&&this.Yq&&this.Vn&&this.J2b()&&this.Rp.isPaused)try{this.Z9c=this.eL(),this.Gd.telemetryData.sessionResumeCount+=1,O.a.J(512496214,833,50,"SessionId: {0}, Message: Resume live broadcasting ...",this.Gd.telemetryData.sessionId),this.vkh(),this.qj.actOnSessionResumed(),this.Vn.ResumeLiveBroadcasting(()=>this.m4b("ResumeLiveBroadcasting",this.Gd.telemetryData.sessionId)),this.Rp.isPaused=!1,this.va.raiseEvent("OnLiveSessionResumed",
Sys.EventArgs.Empty),this.wYe(),this.kb.HNb(!0,this.Vn.GetPragueSessionInfoJSONString())}catch(t){this.Gd.telemetryData.SetErrorCode(6,t.toString()),O.a.J(512496213,833,10,"SessionId: {0}, Message: Exception when resuming Live session, Details: {1}",this.Gd.telemetryData.sessionId,t.toString())}finally{this.O_("ResumeLiveBroadcasting")}}C2b(t){if(this.sr&&this.Yq&&this.Vn&&this.J2b()){this.UNb(3);try{this.xsl(t,()=>{this.Gd.telemetryData.sessionExitPoint=Nn[t];this.Rp.isPaused||(this.Gd.telemetryData.sessionActiveDurationInMS+=
this.eL()-this.Z9c);this.U_&&this.uxb();this.wYe();this.IRa()&&this.Kl.instance.hide();O.a.J(512496212,833,50,"SessionId: {0}, Message: End live broadcasting ...",this.Gd.telemetryData.sessionId);this.qj.actOnSessionEnded();this.kb.kkd(Object(r.a)(this,this.X5g,"onSlideShowReady"));this.kb.fib(Object(r.a)(this,this.Pjc,"onSlideShowPositionChanged"));this.kb.$hh(Object(r.a)(this,this.onSubtitleUpdated,"onSubtitleUpdated"));this.kb.aih(Object(r.a)(this,this.onTranscriberStarted,"onTranscriberStarted"));
this.ZWa.Fhh(Object(r.a)(this,this.xjc,"onNetworkConnectivityChanged"));this.kb.kPe(Object(r.a)(this,this.onPodSessionExpired,"onPodSessionExpired"));this.xGa&&this.kb.HNb(!1);this.bbc=this.Rp=null;this.va.raiseEvent("OnLiveSessionEnded",Sys.EventArgs.Empty);this.la.jhd&&this.Hc.a3b&&(this.Sfc=this.EEb=!1);if(3!==t){const P=this.Vn.EndLiveBroadcasting(()=>this.m4b("EndLiveBroadcasting",this.Gd.telemetryData.sessionId));P?P.then(()=>{this.O_("EndLiveBroadcasting");O.a.J(512496211,833,50,"SessionId: {0}, Message: EndLiveBroadcasting web service call succeeded!",
this.Gd.telemetryData.sessionId)}).catch(ia=>{this.Gd.telemetryData.SetErrorCode(7,ia.toString());this.O_("EndLiveBroadcasting");O.a.J(512496210,833,10,"SessionId: {0}, Message: EndLiveBroadcasting web service call failed due to error!, Details: {1}",this.Gd.telemetryData.sessionId,ia.toString())}):(this.Gd.telemetryData.SetErrorCode(7,"EndLiveBroadcasting failed to created Promise object!"),O.a.J(512496209,833,10,"SessionId: {0}, Message: EndLiveBroadcasting failed to created Promise object!"))}else this.Vn.CleanUpBroadcastBeforeEnd(),
O.a.J(512496208,833,50,"SessionId: {0}, Message: Skipping EndLiveBroadcasting web service call");this.O_("EndLiveBroadcasting")})}catch(P){this.Gd.telemetryData.SetErrorCode(7),O.a.J(512496207,833,10,"SessionId: {0}, Message: Exception when ending live session!, Details: {1}",this.Gd.telemetryData.sessionId,P.toString())}finally{3!==t&&this.flb(),this.O_("EndLiveBroadcasting")}}}Vph(){this.sr&&this.Vn&&this.Vn.SetPresenterState("muted")}Wph(){this.sr&&this.Vn&&this.Vn.SetPresenterState("unmuted")}showCallout(t){this.sr&&
this.qj&&(this.X3c=!0,this.qj.showCallout(t))}showWelcomeScreen(){this.sr&&this.qj&&(this.qj.showWelcomeScreen(),this.OTe())}showEndSessionDialog(t,P){this.sr&&this.Yq&&this.qj&&this.qj.showEndSessionDialogWithCallbacks(t,P)}Hpd(){this.qj.isWelcomeScreenVisible()||this.Rp.isPaused||this.showWelcomeScreen();this.Rp=null;this.qj.onSessionRequestError()}J2b(){if(this.sr&&!this.qj&&this.Sda){const t=new sr;t.hostElement=this.Sda;t.baseZIndex=50005;t.welcomeScreenBackgroundImageUrl=this.je.pk("LiveWelcomeScreenBackground.png");
t.welcomeScreenErrorImageUrl=this.je.pk("LiveWelcomeScreenError.png");t.welcomeScreenLayerHostId="LiveWelcomeScreenLayerHost";t.calloutContainerId="LiveCalloutContainer";t.urlBarLayerHostId="LiveURLBarLayerHost";t.dialogLayerHostId="LiveDialogLayerHost";t.reactionsBarLayerHostId="LiveReactionBarLayerHost";t.showTryAgainButton=!0;t.isPowerpointLiveReactionEnabled=!$c.a("PPTLive.ReactionToggleInLiveCallout");t.onboardingScreenHostId="LiveOnboardingScreenLayerHost";t.resourceCDNPath=this.la.ghb;t.enablePrefetchLiveResource=
this.la.khd;t.enableNewLiveWelcomeScreen=this.la.khd;t.userSessionId=this.vBe;t.podsUrl=this.Vea;this.qj=liveActor.LiveActorFactory.CREATE_LIVE_ACTOR(t);this.qj.on("OnWelcomeScreenOpenedAction",()=>{this.yKa("LiveWelcomeScreenLayerHost");this.OTe();this.MWg=Date.now();this.Gd.telemetryData.welcomeShownCount+=1});this.qj.on("OnWelcomeScreenClosedAction",()=>{this.FBb&&this.qj.hideURLBar();this.oDf();this.kb.restoreFocus();this.Gd.telemetryData.welcomeScreenDurations.push(Date.now()-this.MWg);this.Gd.telemetryData.welcomeScreenFirstTimeDuration=
this.Gd.telemetryData.welcomeScreenDurations[0];this.O_("OnWelcomeScreenClosedAction");this.Vn.SetWelcomeScreenState(!1);this.la.dhd&&this.uCh();this.EEb&&this.IRa()&&window.setTimeout(()=>{this.Kl.instance.hide();this.EEb=!1},5E3)});this.qj.on("ResumeSessionAction",()=>{this.Qkh();this.FBb||this.qj.showURLBar()});this.qj.on("EndSessionAction",()=>{this.C2b(this.xGa?1:2);this.kb.restoreFocus()});this.qj.on("OnCalloutOpenedAction",()=>{this.X3c=!0;this.va.raiseEvent("OnCalloutOpened",Sys.EventArgs.Empty);
this.Gd.telemetryData.calloutShownCount+=1});this.qj.on("OnCalloutClosedAction",()=>{this.X3c=!1;this.va.raiseEvent("OnCalloutDismissed",Sys.EventArgs.Empty);this.kb.restoreFocus()});this.qj.on("OnEndSessionDialogOpenedAction",()=>{this.g6k()});this.qj.on("OnEndSessionDialogClosedAction",()=>{this.SYk()});this.qj.on("OnCalloutMenuDefinitionChangedAction",()=>{this.va.raiseEvent("CalloutMenuDefinitionChanged",Sys.EventArgs.Empty)});this.qj.on("OnTryAgainAction",()=>{O.a.J(512496206,833,15,"SessionId: {0}, Message: OnTryAgainAction called.",
this.Gd.telemetryData.sessionId);this.erc(5,this.vBe,this.Vea,this.AO,this.dcc)});this.qj.on("PresenterDisabledReactions",()=>{this.qse=!1});this.qj.on("PresenterEnabledReactions",()=>{this.qse=!0});this.qj.on("OnOnboardingScreenOpenedAction",()=>{this.yKa("LiveOnboardingScreenLayerHost");this.OTe()});this.qj.on("OnOnboardingScreenClosedAction",()=>{this.jpc()})}return!!this.qj}jpc(){this.qj&&(this.g1d()&&this.qj.isOnboardingScreenVisible()?this.yKa("LiveOnboardingScreenLayerHost"):this.qj.isWelcomeScreenVisible()?
this.yKa("LiveWelcomeScreenLayerHost"):(-1!==this.Eec&&this.oDf(),this.kb.restoreFocus()))}JLj(){const t=document.getElementById("LiveWelcomeScreenLayerHost"),P=document.getElementById("LiveOnboardingScreenLayerHost");let ia=!1;t&&(ia=t.contains(document.activeElement));return document.activeElement===P||document.activeElement===t||ia}OTe(){this.qj&&-1===this.Eec&&(this.Eec=window.setInterval(()=>{this.JLj()||this.jpc()},500))}oDf(){window.clearInterval(this.Eec);this.Eec=-1}yKa(t){this.Sda&&this.qj&&
window.setTimeout(()=>{Wb.FocusManager.Sr(this.Sda.ownerDocument.getElementById(t))},50)}g6k(){this.xGa?this.yKa("LiveDialogLayerHost"):(this.Fa.iWc(fd.a.MJe,fd.a.nj,document.getElementById("LiveDialogLayerHost")),this.Fa.Bj(fd.a.MJe,!0))}SYk(){this.xGa?this.kb.restoreFocus():this.Fa.Bj(fd.a.MJe,!1)}t8f(){this.la.jhd&&this.Hc.a3b&&(this.IRa()&&this.EEb&&(this.Kl.instance.hide(),this.EEb=!1),this.Sfc=!0)}xZj(){try{this.Dec||!this.g1d()&&!this.la.khd||(this.Dec=kl.a(A.a.instance)("liveActorLazy"))}catch(t){O.a.J(512496205,
833,10,"SessionId: {0}, Message: Exception when loading the liveActorLazy, Details: {1}",this.Gd.telemetryData.sessionId,t.toString())}}X5g(){this.sr&&this.Vn&&(this.LRa?(window.setTimeout(()=>{this.va.raiseEvent("OnRelaunchPausedSession",Sys.EventArgs.Empty)},500),this.Qkh()):this.Rp&&this.qj&&this.qj.isWelcomeScreenVisible()&&this.jpc())}Pjc(t,P){this.sr&&this.Vn&&(this.Vn.SetCurrentPosition(P.slideId,P.slideIndex,P.Gsc),this.fcb!==P.slideId&&this.vkh(),this.fcb=P.slideId,this.Eua&&(this.oVa&&10>
this.Tec&&10*this.Eua.size>=this.Tec*this.oVa.size&&(this.UNb(4),this.Tec+=1),this.Eua.add(P.slideId)),this.la.dhd&&this.uCh(),t=!!this.oVa&&this.oVa.size>=this.la.dCk,this.fcb===this.owe&&t&&this.Osl())}V5g(){this.FBb=!0;this.sr&&this.Yq&&this.qj&&(this.qj.hideURLBar(),this.Nsd(1),this.UNb(1))}W5g(){this.FBb=!1;this.sr&&this.Yq&&this.qj&&this.qj.showURLBar()}onSubtitleUpdated(t,P){this.sr&&this.Yq&&this.Vn&&(P.isFinal?this.Vn.UpdateFinalSubtitles(P.ZBh):this.Vn.UpdatePartialSubtitles(P.ZBh))}onTranscriberStarted(t,
P){this.Gd.telemetryData.transcriberSessionIds+=P.YBh+",";this.sr&&this.Yq&&this.kb.HNb(!0,this.Vn.GetPragueSessionInfoJSONString())}Wkl(){O.a.J(512496204,833,50,"SessionId: {0}, StartPausedSessionAutoExpireTimer.",this.Gd.telemetryData.sessionId);-1!==this.UCb&&window.clearInterval(this.UCb);this.XDb=30;this.UCb=window.setInterval(Object(r.a)(this,this.kzk,"pausedSessionAutoExpireTimerCallBack"),6E4)}wYe(){-1!==this.UCb&&(O.a.J(512496203,833,50,"SessionId: {0}, StopPausedSessionAutoExpireTimer.",
this.Gd.telemetryData.sessionId),window.clearInterval(this.UCb),this.UCb=-1)}kzk(){--this.XDb;0>=this.XDb?(O.a.J(512496202,833,50,"SessionId: {0}, Ending long paused session.",this.Gd.telemetryData.sessionId),this.uxb(),this.C2b(3)):this.U_&&(this.U_.message=String.format(ResourceStrings.l_LiveBusinessBarMessage_PausedSession,this.XDb.toString()))}tgl(){if(!this.U_&&this.kt&&!v.AFrameworkApplication.Tg&&0!==this.Rp.sessionCurrentState){var t=String.format(ResourceStrings.l_LiveBusinessBarMessage_PausedSession,
this.XDb.toString());t=new Hq.a(ResourceStrings.l_LiveBusinessBarTitle_PausedSession,t,null);t.closeable=!0;t.P2=Object(r.a)(this,this.xmk,"onBusinessBarClosed");t.image=3;t.addButton(ResourceStrings.l_LiveBusinessBarButton_ResumeSession,Object(r.a)(this,this.zmk,"onBusinessBarResumeSessionButtonClicked"),"");t.BNd(ResourceStrings.l_LiveBusinessBarButton_EndSession,Object(r.a)(this,this.ymk,"onBusinessBarEndSessionButtonClicked"));this.kt.businessBar.Yh(t,!1);this.kt.Mq();this.U_=t}}nke(){var t=6E4*
this.la.HCk;t=0<t?this.eL()-this.c$c>=t:!1;O.a.J(512496201,833,50,"LivePresenter::IsSessionStale {0}",t);return t}uxb(){try{this.kt&&this.U_?(this.wYe(),this.kt.businessBar.removeEntry(this.U_),this.kt.Mq(),O.a.J(512496200,833,50,"LivePresenter::HideLiveSessionBusinessBar WasSuccessful: {0}",!this.U_.businessBar),this.U_=null):O.a.J(512496199,833,15,"LivePresenter::HideLiveSessionBusinessBar failed: conditions: {0}, {1}",!!this.kt,!!this.U_)}catch(t){O.a.J(512496198,833,15,"LivePresenter::HideLiveSessionBusinessBar threw an exception of {0}",
t.toString())}}xmk(t){t===this.U_&&(this.U_=null)}zmk(t){t===this.U_&&this.qj&&(this.uxb(),this.nke()||v.AFrameworkApplication.Ta.processAction(hb.a.Gya,2))}ymk(t){t===this.U_&&this.qj&&(this.nke()?this.uxb():this.qj.showEndSessionDialog())}brk(){const t=this.eL(),P=window.document.hidden;O.a.J(512496197,833,50,"LivePresenter::OnPageVisibilityChangedHandler page {0} at {1}",P?"hidden":"visible",t);P||this.LRa&&18E5<=t-this.nSg&&this.uxb()}d4d(t,P,ia){return!this.la.powerPointLiveBroadcastEnabled||
0===this.tVa&&this.la.isBlueChicken?new Promise(Aa=>{Aa(null)}):!ia&&!this.XL||ia&&!this.mqe?(O.a.J(512496196,833,10,"LivePresenter::GetToken - action: {0}, session id: {1}, isDirectAuth: {2}, Auth manager or helper is null",t,P,ia),new Promise((Aa,Ka)=>{Ka("AuthHelperNotSet")})):new Promise((Aa,Ka)=>{let pb=this.la.hostAuthType,Nb="";if("aad"===pb||this.la.isBlueChicken)Nb=this.la.pptLiveResourceUri;else if("msa"===pb)Nb=this.la.GCk;else{O.a.J(512496195,833,10,"LivePresenter::GetToken - action: {0}, session id: {1}, hostAuthType is not aad or msa",
t,P);Ka("HostAuthTypeInvalid");return}const kc="true"===v.AFrameworkApplication.fa.Ha("IsAnonymousUser").toLowerCase();let Rc=v.AFrameworkApplication.fa.Ha(v.AFrameworkApplication.YJ);ab.a.Wa(Rc)&&(Rc="Unset");const Yc=new Date;let hd=null;hd=ia?this.mqe.Qtl(this.la.TBk,this.la.SBk,Nb,v.AFrameworkApplication.fa.Ha("UserPrincipalName"),this.la.fCk,this.la.WBk&&"StartLiveBroadcasting"===t&&!this.la.rah):this.XL.nV(this.la.pptLiveImplicitAuthAppName,Nb);hd.then(se=>{this.fog(P,t,pb,ia,kc,Rc,se.IsSuccess,
+new Date-+Yc,se.ErrorCode,se.ErrorMessage);se.IsSuccess?Aa(se.Token):Ka(se.ErrorCode)}).catch(se=>{this.fog(P,t,pb,ia,kc,Rc,!1,+new Date-+Yc,"exception",se.toString());Ka("exception")})})}m4b(t,P){if(!this.la.powerPointLiveBroadcastEnabled||0===this.tVa&&this.la.isBlueChicken)return new Promise(Aa=>{Aa(null)});if("msa"===this.la.hostAuthType)return this.d4d(t,P,!1);const ia=this;return new Promise((Aa,Ka)=>{ia.d4d(t,P,!0).then(pb=>{Aa(pb)}).catch(()=>{ia.d4d(t,P,!1).then(pb=>{O.a.J(512496194,833,
50,"LivePresenter::GetToken - WebAuth retry succeeded.");Aa(pb)}).catch(pb=>{Ka(pb)})})})}eL(){return(new Date).getTime()}fog(t,P,ia,Aa,Ka,pb,Nb,kc,Rc,Yc){const hd={};hd.SessionId=t;hd.Action=P;hd.HostAuthType=ia;hd.UseDirectAuth=Aa;hd.IsAnonymousUser=Ka;hd.UiHost=pb;hd.IsSuccess=Nb;hd.Latency=kc;hd.ErrorCode=Rc;hd.ErrorMessage=Yc;O.a.J(51197915,833,50,JSON.stringify(hd))}O_(t){this.Gd.telemetryData.action=t;this.Gd.telemetryData.sessionDurationInMS=this.eL()-this.c$c;this.Gd.telemetryData.hostAuthType=
this.la.hostAuthType;this.Gd.SetStateServiceMetrics();this.Gd.telemetryData.errorCode.length&&(!this.Gd.telemetryData.errorMessage.length||0>Array.indexOf(this.la.ZBk,this.Gd.telemetryData.errorMessage))&&(this.Gd.telemetryData.hasUnexpectedError=!0);t=this.la.podLiveBroadcastRendezvousServiceBaseUri.toLowerCase();-1!==t.indexOf("pptservicescast.officeapps.live.com")?this.Gd.telemetryData.rendezvousServiceEnvironment="prod":-1!==t.indexOf("pptservicescast.edog.officeapps.live.com")?this.Gd.telemetryData.rendezvousServiceEnvironment=
"edog":-1!==t.indexOf("pptservicescast.officeapps.live-int.com")?this.Gd.telemetryData.rendezvousServiceEnvironment="int":this.Gd.telemetryData.rendezvousServiceEnvironment="dev";O.a.J(50706442,833,this.Gd.telemetryData.hasUnexpectedError?15:50,JSON.stringify(this.Gd.telemetryData))}fui(t){if(this.qc)try{var P=this.jq.presentation;if(!P)throw Error.argumentNull("Presentation is null");const ia=P.slides||[];this.owe=ia[ia.length-1].sid;let Aa=P=!1;this.oVa=new Set;for(const Ka of ia)P||Ka.sid!==t||
(P=!0,Aa=Ka.an),!P||Ka.an&&!Aa||this.oVa.add(Ka.sid),Aa&&!Ka.an&&(Aa=!1)}catch(ia){this.Gd.telemetryData.SetErrorCode(16,ia.toString()),O.a.J(512496193,833,10,"SessionId: {0}, Message: Exception when collecting slide show info for triggering audience feedback!, Details: {1}",this.Gd.telemetryData.sessionId,ia.toString())}}Nsd(t){return new Promise(P=>{if(this.sr&&this.Vn&&this.Rp&&this.bbc)try{this.bbc.then(ia=>{let Aa=!1;switch(t){case 2:if(!this.Eua||!this.oVa||10*this.Eua.size<8*this.oVa.size){P(!0);
return}break;case 3:Aa=!0}const Ka={triggeredSurveyType:"Survey.AudienceFeedback"};Ka.isMandatory=Aa;Ka.triggerEventId=Ca.a.create().toString();Ka.surveyeeName=v.AFrameworkApplication.userName;ia?(Ka.surveyId=ia.surveyId,Ka.surveyResponseUrl=ia.surveyResponseUrl):O.a.J(512496192,833,10,"SessionId: {0}, Message: Audience feedback survey info is not valid!",this.Gd.telemetryData.sessionId);this.Vn.TriggerSurvey(JSON.stringify(Ka));O.a.J(512496163,833,50,"SessionId: {0}, Message: Triggering audience feedback!, Details: {1}",
this.Gd.telemetryData.sessionId,t);P(!0)}).catch(ia=>{O.a.J(512496162,833,10,"SessionId: {0}, Message: Failed to trigger audience feedback as CreateSurvey request failed due to error!, Details: {1}",this.Gd.telemetryData.sessionId,ia.toString());this.Gd.telemetryData.SetErrorCode(13,ia.toString());P(!1)})}catch(ia){this.Gd.telemetryData.SetErrorCode(17,ia.toString()),O.a.J(512496161,833,10,"SessionId: {0}, Message: Exception when collecting show info for triggering audience feedback!, Details: {1}",
this.Gd.telemetryData.sessionId,ia.toString()),P(!1)}else P(!0)})}l3g(t,P){this.kb&&this.Vn&&P&&(this.kb.eib(Object(r.a)(this,this.l3g,"onGetCurrentSlideShowPosition")),this.Vn.SetCurrentPosition(P.slideId,P.slideIndex,P.Gsc))}Qwa(t,P){this.qj&&this.qj.actOnCurrentSlideDimensionChange(P.slideHeight,P.bwh,P.slideWidth,P.ewh)}getCalloutMenuDefinition(){return this.J2b()?this.qj.getCalloutMenuDefinition():null}mDj(){const t=String.format("{0}{1}",this.la.ghb,"reactions/heart/default/240_anim_f/heart.png"),
P=String.format("{0}{1}",this.la.ghb,"reactions/yes/default/240_anim_f/yes.png"),ia=String.format("{0}{1}",this.la.ghb,"reactions/clap/default/240_anim_f/clap.png"),Aa=String.format("{0}{1}",this.la.ghb,"reactions/laugh/default/240_anim_f/laugh.png"),Ka=String.format("{0}{1}",this.la.ghb,"reactions/surprised/default/240_anim_f/surprised.png"),pb=String.format("{0}{1}",this.la.ghb,"reactions/wonder/default/240_anim_f/wonder.png");this.mma=[Object.assign(new mo,{react:"yes",reactionCount:0,reactionImagePath:P,
numberOfAnimationFrames:40}),Object.assign(new mo,{react:"heart",reactionCount:0,reactionImagePath:t,numberOfAnimationFrames:16}),Object.assign(new mo,{react:"clap",reactionCount:0,reactionImagePath:ia,numberOfAnimationFrames:40}),Object.assign(new mo,{react:"laugh",reactionCount:0,reactionImagePath:Aa,numberOfAnimationFrames:77}),Object.assign(new mo,{react:"surprised",reactionCount:0,reactionImagePath:Ka,numberOfAnimationFrames:68}),Object.assign(new mo,{react:"wonder",reactionCount:0,reactionImagePath:pb,
numberOfAnimationFrames:70})];this.ekb=new Map;this.Tec=1;this.M6c=null}vkh(){if(this.mma){for(const t of this.mma)t.reactionCount=0;this.qj&&this.qj.resetReactions()}}ijk(t){if(this.ekb){var P=this.ekb.has(t.slideId)?this.ekb.get(t.slideId)+1:1;this.ekb.set(t.slideId,P)}if(this.mma&&!this.LRa&&this.qse){for(const ia of this.mma)if(ia.react===t.react){ia.reactionCount+=1;break}if(this.qj){t=Array(this.mma.length);for(P=0;P<this.mma.length;P++)t[P]=Object.assign(new mo,{react:this.mma[P].react,reactionCount:this.mma[P].reactionCount,
reactionImagePath:this.mma[P].reactionImagePath,numberOfAnimationFrames:this.mma[P].numberOfAnimationFrames});this.qj.setReactions(t)}}}UNb(t){return new Promise(P=>{if(this.sr&&this.Vn&&this.Rp)try{if(1>this.ekb.size)O.a.J(512496160,833,50,"SessionId: {0}, Message: No reactions, skip save thumbnails request, Reason: {1}",this.Gd.telemetryData.sessionId,t),P(!0);else if(2===t&&(!this.Eua||1>this.Eua.size))O.a.J(512496159,833,50,"SessionId: {0}, Message: No slide presented, skip save thumbnails request, Reason: {1}",
this.Gd.telemetryData.sessionId,t),P(!0);else{var ia=null,Aa=0;this.ekb.forEach((pb,Nb)=>{pb>Aa&&(ia=Nb.toString(),Aa=pb)});if(this.M6c&&ia===this.M6c)O.a.J(512496158,833,50,"SessionId: {0}, Message: Already trigger for slideId, skip save thumbnails request, Reason: {1}",this.Gd.telemetryData.sessionId,t),P(!0);else{var Ka=this.Vn.TriggerSaveThumbnails(()=>this.m4b("SaveThumbnails",this.Gd.telemetryData.sessionId),ia);Ka?Ka.then(()=>{this.M6c=ia;O.a.J(512496156,833,50,"SessionId: {0}, Message: Triggering save thumbnails call succeeded, Reason: {1}",
this.Gd.telemetryData.sessionId,t);P(!0)}).catch(pb=>{O.a.J(512496155,833,10,"SessionId: {0}, Message: Triggering save thumbnais call failed due to error!, Details: {1}, Reason: {2}",this.Gd.telemetryData.sessionId,pb.toString(),t);P(!1)}):(this.Gd.telemetryData.SetErrorCode(15,"Triggering save thumbnails failed to created Promise object!"),O.a.J(512496157,833,10,"SessionId: {0}, Message: Triggering save thumbnails failed to created Promise object!"),P(!1))}}}catch(pb){this.Gd.telemetryData.SetErrorCode(15,
pb.toString()),O.a.J(512496154,833,10,"SessionId: {0}, Message: Exception when triggering save thumbnails, Details: {1}",this.Gd.telemetryData.sessionId,pb.toString()),P(!1)}else P(!0)})}IRa(){return this.la.pptEditorVoiceUXEnabled&&this.Kl&&this.Kl.instance?!0:!1}Kxi(t){if(this.IRa())switch(t){case 0:this.xGa&&this.Kl.instance.show(ResourceStrings.L_LivePresentations_Disconnected,Wi.a.uYa);this.Gd.telemetryData.SetErrorCode(3);this.O_("DisconnectdToPrague");break;case 1:this.Kl.instance.hide();break;
case 2:this.xGa&&this.Kl.instance.show(ResourceStrings.L_LivePresentations_Connecting,Wi.a.$Fb);break;default:O.a.J(512496152,833,10,"SessionId: {0}, Message: Unhandled connection state value.",this.Gd.telemetryData.sessionId)}else O.a.J(512496153,833,10,"SessionId: {0}, Message: Cannot show notification for service connectivity.",this.Gd.telemetryData.sessionId)}xjc(t,P){this.IRa()?P.isConnected?this.Kl.instance.hide():this.xGa&&this.Kl.instance.show(ResourceStrings.L_LivePresentations_InternetDisconnected,
Wi.a.$Fb):O.a.J(512496151,833,10,"SessionId: {0}, Message: Cannot show notification for network connectivity.",this.Gd.telemetryData.sessionId)}N6d(t,P){t=String.format("{0}PodHandler.ashx?action=GetSnappedDownloadLink&PodSID={1}&waccluster={2}",this.la.podsWebServiceBase,t,P);this.la.hCk&&(t+="&shareable=true");return t}xsl(t,P){try{const ia=new ha.a;if(1===t||2===t||4===t)ia.add(this.Nsd(3)),ia.add(this.UNb(3));ia.count?Promise.all(ia.toArray()).then(()=>P()).catch(()=>P()):P()}catch(ia){O.a.J(512496150,
833,10,"failed to create end session task promises, error : {0}",ia),P()}}get i4e(){const t=Nc.a.get("PPTLivePresentationOnboarded");return t?"true"===t.toLowerCase():!1}set i4e(t){Nc.a.SJ("PPTLivePresentationOnboarded",t.toString(),Nc.a.wJ)||O.a.J(512496149,833,10,"Failed to set cookie for PPTLivePresentationOnboarded to {0}",t.toString())}g1d(){return this.la.ICk&&!this.i4e}Q$(){try{if(O.a.J(512496148,833,15,"Pods session rehydrated!"),this.$3c=!0,this.sr&&this.Yq&&this.Vn){O.a.J(512496147,833,
15,"SessionId: {0}, Message:OnPodSessionRehydrated: Updating file download Url for DC: {1}",this.Gd.telemetryData.sessionId,this.Xa.nk);const t=this.N6d(this.Xa.podSessionId,this.Xa.nk);this.Vn.OnPodSessionUpdated(t)}}catch(t){O.a.J(512496146,833,10,"LivePresenter: Exception at OnPodSessionRehydrated: {0}",t.toString())}}zGb(){this.$3c=!1}onPodSessionExpired(){this.$3c=!1}flb(){if(this.la.JCk)try{const t=A.a.instance.Ja("Common.ISystemInitiatedFeedback");t&&(O.a.J(512496145,833,50,"LivePresenter: Floodgate survey triggered for PPTLive"),
t.execute(P=>{P.logActivity("PPTWebLivePresentationsActivity","PPTLivePresentationsFloodgateSurveyEnabled")}))}catch(t){O.a.J(512496144,833,10,"LivePresenter: Exception thrown when trying to trigger floodgate survey. Exception: {0}",t)}}R2f(t){const P=document.createElement("a");P.setAttribute("href",t);return(t=P.search.match(RegExp("[\\?&]Id=([^&#]*)")))&&2===t.length?t[1]:""}O0i(){var t=this.qc.L4f();let P=1;this.KAe.clear();for(const ia of t){t=ia.Pk();for(const Aa of t)if(!ab.a.Wa(Aa.fgb)){t=
this.R2f(Aa.fgb);const Ka=new Bk;Ka.NIg=t;Ka.OIg=P.toString();this.KAe.add(Ka);P+=1}}}uCh(){var t=this.qc.cEa(this.fcb).Pk();for(const P of t)ab.a.Wa(P.fgb)||(t=this.R2f(P.fgb),t=this.JAe.get(t),ab.a.Wa(t)||this.Vn.SetCurrentPollInfoState(t,this.fcb))}N9h(t){this.va.addHandler("OnLiveResourcesLoaded",t)}hUk(t){this.va.removeHandler("OnLiveResourcesLoaded",t)}Asf(t){this.va.addHandler("OnLiveSessionStarted",t)}Zhh(t){this.va.removeHandler("OnLiveSessionStarted",t)}ysf(t){this.va.addHandler("OnLiveSessionEnded",
t)}Yhh(t){this.va.removeHandler("OnLiveSessionEnded",t)}X8h(t){this.va.addHandler("OnCalloutDismissed",t)}ETk(t){this.va.removeHandler("OnCalloutDismissed",t)}wsf(t){this.va.addHandler("OnRelaunchPausedSession",t)}Whh(t){this.va.removeHandler("OnRelaunchPausedSession",t)}Y8h(t){this.va.addHandler("CalloutMenuDefinitionChanged",t)}FTk(t){this.va.removeHandler("CalloutMenuDefinitionChanged",t)}}Object(k.a)(hs,"LivePresenter",null,[749]);class bp{constructor(){this.K=null;this.iGg=0}get name(){return"PowerPointWebEditor.Live"}$b(t){this.K=
t;const P=this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame");this.K.register(749,"PowerPointLive.ILivePresenter").ma().oa(()=>new hs(this.K.resolve("PowerPointWebEditor.IApplicationSettings"),P,this.K.resolve("PowerPointWebEditor.ISlideshowFrame"),this.K.resolve("PowerPoint.IPathManager"),this.K.resolve("Common.App.OAuth.IOAuthManager"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),
this.K.resolve("PowerPointWebEditor.Core.IPodsPopsEventHandler"),this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.K.resolve("PowerPointWebEditor.ISubtitleContext"),A.a.instance.Ja("PowerPointWebEditor.ISlideShowVoiceNotification"),this.K.resolve("PowerPointWebEditor.Core.INetworkConnectivityProvider"),this.K.resolve("PowerPointWebEditor.IFocusManager")))}yZj(){try{this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointLiveBroadcastEnabled?(this.iGg=Date.now(),O.a.J(509441559,
833,50,"PPTWebEditorLivePackage: Loading the Live Presenter scripts"),Ya.a.get_instance().Dk(7,()=>{const t=this.K.resolve("Common.IDynamicScriptLoaderProvider").Pw,P=kl.a(this.K),ia=new ha.a;ia.add(t.loadScript("PPTLiveBroadcast"));ia.add(t.loadScript("BroadcastMonitor"));ia.add(P("liveActor"));v.AFrameworkApplication.Aa.hb.Np||ia.add(P("uiFabricLazy"));Promise.all(ia.toArray()).then(()=>this.$pk()).catch(Aa=>O.a.J(42869341,833,10,"Failed to load scripts for the Live Presenter feature: {0}",Aa))})):
O.a.J(509441560,833,50,"PPTWebEditorLivePackage: Not loading the Live Presenter scripts because the feature is not enabled")}catch(t){O.a.J(509441558,833,10,"PPTWebEditorLivePackage: exception in OnFullAppSettingsReady: {0}",t)}}Om(){try{if(this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointLiveBroadcastEnabled){if(this.K.resolve("PowerPointWebEditor.IApplicationSettings").BCk){const t=ab.a.bT((v.AFrameworkApplication.fileName||"").toLowerCase());if(".ppt"===t||".pps"===t){O.a.J(509441556,
833,50,"PPTWebEditorLivePackage: Disabling Live broadcast feature for binary file format by checking file extension.");return}".pptx"!==t&&O.a.J(509441555,833,15,"PPTWebEditorLivePackage: Allowing file extension: "+t)}this.K.resolve("PowerPointWebEditor.IApplicationSettings").ECk&&this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState").getState(4)?O.a.J(509441554,833,50,"PPTWebEditorLivePackage: Disabling Live broadcast feature for binary file format."):this.K.resolve("PowerPointWebEditor.IApplicationSettings").FCk&&
(this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState").getState(32)||this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState").getState(32768))?O.a.J(509441553,833,50,"PPTWebEditorLivePackage: Disabling Live broadcast feature for protected file."):this.K.resolve("PowerPointWebEditor.IApplicationSettings").qah&&"msa"===this.K.resolve("PowerPointWebEditor.IApplicationSettings").hostAuthType?O.a.J(509441552,833,50,"PPTWebEditorLivePackage: Disabling Live broadcast feature for MSA users."):this.K.Ja("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(t=>
{t.isFeatureEnabled("PowerPointLivePresentations",!1).then(P=>{P?this.yZj():(O.a.J(509441551,822,50,"User doesn't have license for Live broadcast feature. Skipping loading Live package!"),appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("PresentLive",!0)))})})}else O.a.J(509441557,833,50,"PPTWebEditorLivePackage: Live broadcast feature is not enabled.")}catch(t){O.a.J(509441550,833,10,"OnFullAppSettingsReady: exception in OnFullAppSettingsReady: {0}",t)}}$pk(){O.a.J(509441549,833,
50,"PPTWebEditorLivePackage: Loading time: {0}ms",Date.now()-this.iGg);this.K.resolve("PowerPointLive.ILivePresenter").i8a=!0;this.K.resolve("PowerPointWebEditor.IApplicationSettings").qah||"msa"!==this.K.resolve("PowerPointWebEditor.IApplicationSettings").hostAuthType||appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("PresentLiveSetAccessControlOrganization",!0));return null}init(){v.AFrameworkApplication.fa.jf(Object(r.a)(this,this.Om,"onFullAppSettingsReady"))}dispose(){}static main(){e.a.instance.Dc(new bp)}}
Object(k.a)(bp,"PPTWebEditorLivePackage",null,[2,3]);var up=d(717);class rj{}Object(k.a)(rj,"LokiTokenResult",null,[]);class no{constructor(t){this.HAc=t}Uaj(){const t=this.Taj();return t?no.jje?new Promise((P,ia)=>{this.HAc.continueWith(()=>{this.HAc.Sn||this.HAc.rm?ia(Error.create("Error downloading auth library")):this.HAc.result.nV("Loki",t).then(Aa=>{Aa=v.AFrameworkApplication.fa.ka("ForceLokiFallbackToACLPTokenIsEnabled")?this.Xaj():Aa.IsSuccess&&Aa.Token?Object.assign(new rj,{isSuccess:!0,
token:Aa.Token,errorMessage:null}):Object.assign(new rj,{isSuccess:!1,token:null,errorMessage:JSON.stringify(Aa)});P(Aa);return Aa})})}):Promise.resolve(Object.assign(new rj,{isSuccess:!1,token:null,errorMessage:"Not attempting to fetch token because host is not an O365 host."})):Promise.resolve(Object.assign(new rj,{isSuccess:!1,token:null,errorMessage:String.format("Could not get Loki App Id for HostAuthorityType: [{0}]",up.a.BXf())}))}Xaj(){const t=v.AFrameworkApplication.fa.Ha("LokiUserDataSignature")||
"";return Object.assign(new rj,{isSuccess:!0,token:t,errorMessage:null})}Taj(){let t=null;const P=up.a.xQc();2===P?t=v.AFrameworkApplication.fa.Ha("LokiAADAppId"):1===P&&(t=v.AFrameworkApplication.fa.Ha("LokiMSAAppId"));return t}static get jje(){return v.AFrameworkApplication.fa.ka("IsO365CommercialHost")||v.AFrameworkApplication.fa.ka("IsO365ConsumerHost")}}Object(k.a)(no,"LokiTokenManager",null,[805]);class tr{get name(){return"Common.App.LivePersonaUtils"}init(){A.a.instance.resolve("Common.ILokiTokenManager")}dispose(){}$b(t){t.register(no,
"Common.App.LivePersonaUtils.LokiTokenManager").as("Common.ILokiTokenManager").ma().oa(()=>new no(Nf.a.Uu(t.Ja("Common.App.OAuth.IOAuthManager"))))}static main(){e.a.instance.Dc(new tr)}}Object(k.a)(tr,"LivePersonaUtilsPackage",null,[2,3]);var is=d(259);class Jq{constructor(){this.displayName=this.critique=null;this.optOut=!1;this.category=null}}Object(k.a)(Jq,"RehearsalCritique",null,[]);class Ge{static oCj(){Ge.uY[2]=ResourceStrings.L_SubtitleDetection_AudioQualityIssue;Ge.uY[3]=ResourceStrings.L_SubtitleDetection_HighBackgroundNoise;
Ge.uY[4]=ResourceStrings.L_SubtitleDetection_SpeakingTooLoud;Ge.uY[5]=ResourceStrings.L_SubtitleDetection_SpeakingTooQuiet;Ge.QLf=ResourceStrings.L_SubtitleDetection_MicReady;Ge.RLf=ResourceStrings.L_SubtitleDetection_SoundReminder;Ge.MQf=ResourceStrings.L_SubtitleDetection_NoMicrophone;Ge.SQf=ResourceStrings.l_NoCamera;Ge.WWf=ResourceStrings.L_SpeechGenericRetryErrorMessage}}Ge.Jzf=20;Ge.ngh=50002;Ge.uY=Array(Ge.Jzf);Ge.QLf=null;Ge.RLf=null;Ge.MQf=null;Ge.SQf=null;Ge.WWf=null;Ge.W1d="fillerWords";
Ge.Dvk="originality";Ge.tFl="wordsPerMinute";Ge.A3k="sensitivePhrases";Ge.qAi="correctedSensitivePhrases";Ge.ABk="positivity";Ge.r$d="grammar";Ge.ICe="monotone";Ge.pLe="pronunciation";Ge.xXd="crutchWords";Ge.GIh="visionFace";Ge.VDl="visionGaze";Ge.UDl="visionGazeGood";Ge.XDl="visionOcclusion";Ge.WDl="visionOcclusionGood";Ge.RDl="visionDistanceGood";Ge.SDl="visionDistanceTooClose";Ge.TDl="visionDistanceTooFar";Ge.T4f="GetStartedButton";Ge.PYj="ListeningButtonPlayPauseButton";Ge.QYj="ListeningElement";
Ge.eyi="ContainerElement";Ge.jzk="PausedElement";Ge.kkk="NotificationButtonElement";Ge.BEl="WelcomeCheckboxElement";Ge.pgh="RehearsalFeedbackSettingPane";Ge.KJe="PPTCoachRehearsalFREShown";Object(k.a)(Ge,"RehearsalResourceString",null,[]);const Zm=(t,P)=>ab.a.Wa(P)?(n.ULS.sendTraceTag(587872E3,822,10,"RehearsalUtils:IsCritiqueEnabled Invalid critique name"),!1):t?P.toLowerCase()in t:!0,$m=(t,P)=>{let ia=null;try{if(!t||ab.a.Wa(P))return n.ULS.sendTraceTag(587871971,822,10,"RehearsalUtils:getSupportedCritiquesForLanguage SourceLanguage from session information or appsettings is null or empty"),
null;const Ka=ab.a.Wa(t.Ojd)?{}:Sys.Serialization.JavaScriptSerializer.deserialize(t.Ojd,!0);ia={};for(let pb in Ka){t=pb;var Aa=Ka[pb];if(Aa){const Nb=hg.a.dZb(Aa.split(","));Nb&&P.toLowerCase()in Nb&&(ia[t.toLowerCase()]=!0)}}}catch(Ka){O.a.J(590136391,817,10,"RehearsalUtils:getSupportedCritiquesForLanguage Exception while building supported critique map from BRS: {0}",Ka.toString()),ia=null}return ia},jt=(t,P)=>{if(ab.a.Wa(P)||ab.a.Wa(t.p$g))return null;try{var ia=Sys.Serialization.JavaScriptSerializer.deserialize(t.p$g,
!0);if(ab.a.Wa(P)){n.ULS.sendTraceTag(587871968,822,50,"RehearsalUtils:GetLanguageCodeFromLocale locale is null or empty.");var Aa=null}else Aa=P.split("-")[0].toLowerCase();return ia[Aa]}catch(Ka){return O.a.J(587872025,817,10,"RehearsalUtils:getPacingGaugeRangeLocale Exception while parsing BRS PodRehearsalLocaleBasedPacingGaugeRange: {0}",Ka.toString()),null}},Rp=t=>{if(t&&3<t.length){let P="";"ws"===t.substring(0,2)?P="http"+t.substring(2,t.length):"wss"===t.substring(0,3)&&(P="https"+t.substring(3,
t.length));return P}return t},vp=t=>{if(ab.a.Wa(t))return n.ULS.sendTraceTag(559548251,822,10,"GetMappedSourceLanguage: SourceLanguage from session information is not valid, defaulting to english. SourceLanguage: {0}",t),"en-US";switch(t.toLowerCase()){case "en-au":case "en-ca":case "en-gb":case "en-in":case "en-us":return"en-US";default:return t}};class Sp{constructor(){this.userCritiques=null}}Object(k.a)(Sp,"RehearseRoamingSettings",null,[]);class Kq{constructor(){this.critiquesDisabledByDefault=
this.critiquesDisabled=null}}Object(k.a)(Kq,"UserCritiqueSettings",null,[]);class ur{constructor(t,P,ia,Aa){this.va=new wg.a;this.kJ=this.Kbc=this.kU=null;this.KL=!1;this.org=null;this.Uva=this.Vva=0;this.tw=t;this.la=P;this.XGa=ia;this.ia=Aa}qEj(){try{this.r3f(()=>{this.va.raiseEvent("OnRehearsalOptOutSettingsRequestFinished",new Sys.EventArgs)})}catch(t){O.a.J(557602759,822,10,"InitiateRehearsalOptOutSettingsRequest catched exception: {0}",t.toString())}}MZc(){return 2===this.Vva&&2===this.Uva}N1e(){try{0!==
this.Vva&&3!==this.Vva||this.r3f(Object(r.a)(this,this.nNe,"raiseRehearsalGetCritiquesEvent")),0!==this.Uva&&3!==this.Uva||this.K7i()}catch(t){O.a.J(559548259,822,10,"TryToInitiateCritiquesFetchingRequest catched exception: {0}",t.toString())}}G5i(){if(!this.Kbc)return O.a.J(559548288,822,10,"GetCritiquesListForSettingsPane empty critique list"),null;try{if(this.kJ)for(let t of this.Kbc)this.kJ.contains(t.critique.toLowerCase())?t.optOut=!0:t.optOut=!1}catch(t){O.a.J(557602760,822,10,"GetCritiquesListForSettingsPane catched exception: {0}",
t.toString())}return this.Kbc.toArray()}tzl(t,P){this.BGh(t,P);"vision"===t.toLowerCase()&&(this.KL=!P,t={},t.triggerPoint=Ge.pgh,this.ia.La(hb.a.BNb,2,t))}k2f(t=!1){let P="";if(this.kJ&&0<this.kJ.count)if($c.a("RehearsalFilterOptOutCritiqueEnabled")&&t){a:{var ia=this.la;t=this.la.Fxa;var Aa=null;try{if(!ia||ab.a.Wa(t)){n.ULS.sendTraceTag(554837597,822,10,"RehearsalUtils:getCritiquesStatusForLanguage SourceLanguage from session information or appsettings is null or empty");var Ka=null;break a}var pb=
ab.a.Wa(ia.Ojd)?{}:Sys.Serialization.JavaScriptSerializer.deserialize(ia.Ojd,!0);Aa={};for(let kc in pb){Ka=kc;var Nb=pb[kc];if(Nb){const Rc=hg.a.dZb(Nb.split(","));Aa[Ka.toLowerCase()]=Rc&&t.toLowerCase()in Rc?!0:!1}}}catch(kc){O.a.J(554837598,817,10,"RehearsalUtils:getCritiquesStatusForLanguage Exception while building supported critique map from BRS: {0}",kc.toString()),Aa=null}Ka=Aa}if(Nb=Ka)for(let kc of this.kJ)if(pb="vision"===kc?Ge.GIh.toLowerCase():kc.toLowerCase(),pb in Nb?Nb[pb]:1)P=ab.a.Wa(P)?
kc.toLowerCase():P+","+kc.toLowerCase()}else for(Aa of this.kJ)P=ab.a.Wa(P)?Aa.toLowerCase():P+","+Aa.toLowerCase();return P}Tld(){if(2!==this.Vva)O.a.J(557602761,822,50,"SaveRehearseUserCritiques(), skipping save operation as Get request call is not succeeded");else if(this.bSj()){O.a.J(559548291,822,50,"SaveRehearseUserCritiques(), Start sending write request to FE");var t=new Sp;t.userCritiques=Object.assign(new Kq,{critiquesDisabled:this.k2f(),critiquesDisabledByDefault:this.kU.userCritiques.critiquesDisabledByDefault});
var P=fe.c(t),ia=this.la.roamingServiceHandlerWebServiceBase+String.format("RoamingServiceHandler.ashx?action={0}&{1}","savePowerPointRehearseUserCritiques",v.AFrameworkApplication.jh),Aa={};Aa["X-StatelessPopsAffinityRoutingEnabled"]=this.la.pptStatelessPOPSRequestAffinityEnabled.toString();this.tw.Aj(ia,2,P,Aa,!1,2,Ka=>{this.vsk(Ka,t)},Object(r.a)(this,this.usk,"onSaveUserCritiquesFailed"),null,void 0,void 0,void 0,void 0,is.a("17"))}else O.a.J(559548290,822,50,"SaveRehearseUserCritiques(), skipping save operation")}get s1d(){return this.KL}set s1d(t){this.KL=
t;this.BGh("vision",!this.KL);this.MZc()&&this.va.raiseEvent("OnRehearsalSettingsUpdatedExternally",Sys.EventArgs.Empty)}G9h(t){this.va.addHandler("OnRehearsalOptOutSettingsRequestFinished",t)}cUk(t){this.va.removeHandler("OnRehearsalOptOutSettingsRequestFinished",t)}F9h(t){this.va.addHandler("OnRehearsalGetCritiquesSucceeded",t)}bUk(t){this.va.removeHandler("OnRehearsalGetCritiquesSucceeded",t)}E9h(t){this.va.addHandler("OnRehearsalGetCritiquesFailed",t)}aUk(t){this.va.removeHandler("OnRehearsalGetCritiquesFailed",
t)}H9h(t){this.va.addHandler("OnRehearsalSettingsUpdatedExternally",t)}dUk(t){this.va.removeHandler("OnRehearsalSettingsUpdatedExternally",t)}BGh(t,P){this.kJ&&(t=t.toLowerCase(),P&&!this.kJ.contains(t)?this.kJ.add(t):!P&&this.kJ.contains(t)&&this.kJ.remove(t),$c.a("RehearsalRoamingSettingAutoSaveEnabled")&&this.Tld())}bSj(){let t=!1;try{var P=ab.a.Wa(this.kU.userCritiques.critiquesDisabled);if(!this.kJ||!this.kJ.count&&P)return!1;if(P&&0<this.kJ.count||!P&&!this.kJ.count)return!0;const ia=new Set(this.kU.userCritiques.critiquesDisabled.split(","));
if(this.kJ.count!==ia.size)return!0;for(P=0;P<this.kJ.count;P++)if(!ia.has(this.kJ.ga(P).toLowerCase())){t=!0;break}}catch(ia){O.a.J(557602762,822,10,"IsSaveRehearsalSettingsRequired catched exception: {0}",ia.toString())}return t}vsk(t,P){this.kU=P;O.a.J(559548292,822,50,"OnSaveUserCritiquesSucceeded, TotalTimeMs:{0}, QueueTimeMs:{1}",+t.data.hv-+t.data.rI,+t.data.St-+t.data.rI)}usk(t){const P=this.XGa.Nja(t);O.a.J(559548293,822,50,"OnSaveUserCritiquesFailed: Web service failed with {0}, NumSlides={1}",
P,t.data.state)}r3f(t){const P=this.la.roamingServiceHandlerWebServiceBase+String.format("RoamingServiceHandler.ashx?action={0}&{1}","getPowerPointRehearseUserCritiques",v.AFrameworkApplication.jh),ia={};ia["X-StatelessPopsAffinityRoutingEnabled"]=this.la.pptStatelessPOPSRequestAffinityEnabled.toString();this.tw.Aj(P,1,null,ia,!1,2,Aa=>{this.cpk(Aa,t)},Aa=>{this.bpk(Aa,t)},null,void 0,void 0,void 0,void 0,is.a("16"));this.Vva=1}cpk(t,P){let ia=0;try{t.data.Zd&&0<t.data.Zd.trim().length&&(ia=t.data.Zd.length,
this.kU=JSON.parse(t.data.Zd));this.kU&&this.kU.userCritiques||(this.kU=new Sp,this.kU.userCritiques=new Kq);ab.a.Wa(this.kU.userCritiques.critiquesDisabledByDefault)&&(this.kU.userCritiques.critiquesDisabledByDefault="vision",ab.a.Wa(this.kU.userCritiques.critiquesDisabled)?this.kU.userCritiques.critiquesDisabled="vision":this.kU.userCritiques.critiquesDisabled+=",vision");this.kJ=new ha.a;if(!ab.a.Wa(this.kU.userCritiques.critiquesDisabled)){const Aa=this.kU.userCritiques.critiquesDisabled.split(",");
for(const Ka of Aa)this.kJ.add(Ka.toLowerCase())}this.KL=!this.kJ.contains("vision");this.Vva=2}catch(Aa){this.Vva=3,O.a.J(559548294,822,10,"OnGetUserCritiquesSucceeded catched exception: {0}",Aa.toString())}P&&P();t=String.format("OnGetUserCritiquesSucceeded, responseSize={0}, EnqueueTime={1}, InvokedTime={2}, CompletedTime={3}",ia,JSON.stringify(t.data.rI),JSON.stringify(t.data.St),JSON.stringify(t.data.hv));O.a.J(559548295,822,50,t)}bpk(t,P){this.Vva=3;P&&P();t=this.XGa.Nja(t);O.a.J(559548296,
822,50,"OnGetUserCritiquesFailed: Web service failed with {0}",t)}K7i(){try{const P=this.WUi();if(ab.a.Wa(P))O.a.J(559548297,822,10,"GetEnabledCritiquesForClientAndLocale failed to generate FD url for GetCritiques request");else{var t=new XMLHttpRequest;t.open("GET",P,!0);t.onreadystatechange=()=>{if(4===t.readyState){if(200===t.status){O.a.J(559548298,822,50,"GetEnabledCritiquesForClientAndLocale: GetCritiques call successfuly completed");const ia=fe.b(t.responseText);if(ia){this.Kbc=new ha.a;for(const Aa of ia.critiquesData)this.Kbc.add(Object.assign(new Jq,
{category:Aa.category,displayName:Aa.displayName,optOut:!1,critique:Aa.critique.toLowerCase()}));this.org=ia.categoriesData;this.Uva=2}else this.Uva=3}else this.Uva=3;this.nNe()}};t.send("");this.Uva=1}}catch(P){this.Uva=3,this.nNe(),O.a.J(559548299,822,10,"GetEnabledCritiquesForClientAndLocale catched exception: {0}",P.toString())}}WUi(){const t=fe.b(v.AFrameworkApplication.fa.appSettings.SessionStartInfoJson.toString()).Ring||"Unknown",P=this.la.pptEditorSpeechHandlerBaseUri.replace("wss","https");
return P&&P.length?String.format("{0}GetCritiqueListHandler.ashx?action=GetCritiqueList&client=web&audiencegroup={1}&locale={2}",P,t,vp(this.la.Fxa)):null}nNe(){0!==this.Vva&&1!==this.Vva&&0!==this.Uva&&1!==this.Uva&&(this.MZc()?this.va.raiseEvent("OnRehearsalGetCritiquesSucceeded",new Sys.EventArgs):this.va.raiseEvent("OnRehearsalGetCritiquesFailed",new Sys.EventArgs))}}Object(k.a)(ur,"RehearsalFeedbackSettings",null,[746]);class On{constructor(){this.type="RehearsalCritiqueWithGroupProps";this.retryToFetchCritiqueSettings=
this.locale=this.updateCritiqueState=this.categoriesData=this.groupItems=null;this.isExternalUpdated=this.showErrorMessage=this.showLoadingMessage=!1}}Object(k.a)(On,"RehearsalCritiqueWithGroupProps",null,[]);class kt{constructor(t,P,ia,Aa,Ka){this.OGa=this.Db=!1;t.loadScript("powerpoint-presenter-coach-strings").then(()=>{this.OGa=!0;O.a.J(559548252,822,50,"powerpoint-presenter-coach-strings loaded successfully")}).catch(pb=>{O.a.J(559548253,822,10,"Failed to load powerpoint-presenter-coach-strings "+
pb.toString())});this.ia=P;this.la=Ka;this.jE=ia;this.iy=Aa;this.ia.Lna(this)}vb(){this.ia.ya(hb.a.Dpd,lb.a.application,Object(r.a)(this,this.Dpd,"showRehearsalFeedbackSettingsPane"));this.ia.ya(hb.a.tpd,lb.a.application,Object(r.a)(this,this.tpd,"showHideRehearsalFeedbackSettingsPane"));this.ia.ra(hb.a.Fid,lb.a.application,Object(r.a)(this,this.Fid,"queryShowHideRehearsalFeedbackSettingsPane"),96)}De(){}N$(){}M$(){}Dpd(t,P,ia){if(P.contextId!==lb.a.application||!this.OGa)return 2;if(1===ia)return 32;
this.Db?Ob.UISurfaces.xr().then(Aa=>{Aa.setSelectedTaskPane(fd.a.Xhb);this.rA(!0);return null}).catch(Aa=>{O.a.J(554447887,822,10,"RehearsalFeedbackSettingsPane::ShowRehearsalFeedbackSettingsPane exception: {0}",Aa.toString())}):(this.Db=!0,this.kgh(),(t=!this.iy.MZc())&&this.iy.N1e(),t=this.jC(t,!1),this.zqc(t),O.a.J(555832795,822,50,"RehearsalFeedbackSettingsPaneActor::ShowRehearsalFeedbackSettingsPane"));return 32}tpd(t,P,ia){if(P.contextId!==lb.a.application||!this.OGa)return 2;if(1===ia)return 32;
(this.Db=!this.Db)?(this.kgh(),(t=!this.iy.MZc())&&this.iy.N1e(),t=this.jC(t,!1),this.zqc(t),O.a.J(559548254,822,50,"RehearsalFeedbackSettingsPaneActor::ShowHideRehearsalFeedbackSettingsPane show")):(this.vti(),O.a.J(559548255,822,50,"RehearsalFeedbackSettingsPaneActor::ShowHideRehearsalFeedbackSettingsPane close"));return 32}Fid(t,P,ia,Aa,Ka){if(!Object(Lh.a)(Nl.a,Ka))return 8;Ka.Qf(this.Db);return 32}zqc(t,P=!1){const ia=Object.assign(new Ib.a,{title:ResourceStrings.L_RehearseFeedbackSettings,hideHeader:!1,
width:320,location:2,contentProps:t,onOpen:()=>{},onClose:()=>{this.Db=!1;this.OJi();this.iy.Tld()},onHide:()=>{this.iy.Tld()},isModernPane:!0});t=document.getElementById("RehearsalFeedbackSettingsPaneFocus-panel");this.jE.H8(fd.a.Xhb,fd.a.nj,t,()=>{this.rA(!0)},()=>{this.rA(!1)});Ob.UISurfaces.xr().then(Aa=>{P?this.Db&&Aa.updateTaskPane(fd.a.Xhb,ia):Aa.showTaskPane(fd.a.Xhb,ia);return null}).catch(Aa=>{O.a.J(559548256,822,10,"RehearsalFeedbackSettingsPaneActor::ShowFeedbackSettingPane exception: {0}",
Aa.toString())})}vti(){Ob.UISurfaces.xr().then(t=>{t.hideTaskPane(fd.a.Xhb,2);return null}).catch(t=>{O.a.J(559548257,822,10,"RehearsalFeedbackSettingsPaneActor::CloseFeedbackSettingPane exception: {0}",t.toString())})}jC(t,P){return Object.assign(new On,{groupItems:t||P?null:this.iy.G5i(),categoriesData:this.iy.org,locale:this.la.Fxa,updateCritiqueState:(ia,Aa)=>{this.iy.tzl(ia,Aa)},retryToFetchCritiqueSettings:()=>{this.iy.N1e()},showLoadingMessage:t,showErrorMessage:P})}rA(t){const P=document.getElementById("TaskPaneCloseBtnRehearsalFeedbackSettingsPaneFocus");
t&&P&&P.focus()}kgh(){this.iy.F9h(Object(r.a)(this,this.Y4g,"onRehearsalGetCritiquesSucceeded"));this.iy.E9h(Object(r.a)(this,this.X4g,"onRehearsalGetCritiquesFailed"));this.iy.H9h(Object(r.a)(this,this.$4g,"onRehearsalSettingsUpdatedExternally"))}OJi(){this.iy.bUk(Object(r.a)(this,this.Y4g,"onRehearsalGetCritiquesSucceeded"));this.iy.aUk(Object(r.a)(this,this.X4g,"onRehearsalGetCritiquesFailed"));this.iy.dUk(Object(r.a)(this,this.$4g,"onRehearsalSettingsUpdatedExternally"))}Y4g(){const t=this.jC(!1,
!1);this.zqc(t,!0)}X4g(){const t=this.jC(!1,!0);this.zqc(t,!0)}$4g(){const t=this.jC(!1,!1);t.isExternalUpdated=!0;this.zqc(t,!0)}}Object(k.a)(kt,"RehearsalFeedbackSettingsPane",null,[141]);var Bl;(function(t){t[t.none=0]="none";t[t.ribbon=1]="ribbon";t[t.slideShowToolbar=2]="slideShowToolbar";t[t.summaryPage=3]="summaryPage";t[t.ribbonTopBar=4]="ribbonTopBar";t[t.deepLink=5]="deepLink"})(Bl||(Bl={}));Object(k.b)("RehearsalEntryPoint",Bl);class vu{constructor(){this.imagesBaseFilePath=this.slideState=
this.rootContainer=null;this.zIndex=0;this.fUseCountdownWelcomeScreen=this.fShowRealtimeFeedbackEnabledCheckbox=this.fEnableVision=!1;this.speechFDBase=null;this.fUseNewRealtimeCheckbox=this.fUseNewRealtimePanel=this.fDontShowTooltips=!1}}Object(k.a)(vu,"ICoachActorConfig",null,[]);class Te{constructor(){this.rootContainer=this.imagesBaseFilePath=null;this.zIndex=0}}Object(k.a)(Te,"ICoachFREActorConfig",null,[]);class vr{constructor(){this.customSettings=this.requestedRehearsalOptOutFeatures=this.requestedCoachFeatures=
this.documentDownloadConfig=this.userSessionId=this.disabledCoachRealtimeFeatures=this.logger=null;this.fEnableVision=!1;this.supportedRehearsalTemplates=this.sourceLanguage=this.entryPoint=this.wacDatacenter=this.wacHost=this.locale=this.buildVersion=this.audienceGroup=this.audienceChannel=this.identityProvider=this.tenantId=this.userId=this.speechFDBase=this.webcamConfig=null;this.fEnableServiceSideAggregationForCoach=!1;this.httpTimeoutForCoachSummaryData=0;this.enableTimeStampedCritiqueTelemetry=
this.fSendClientMetaDataOnSessionStart=!1;this.audioInputDeviceCount=0}}Object(k.a)(vr,"ICoachSessionConfig",null,[]);class wu{constructor(){this.docId=this.podsSessionId=this.webServiceBase=this.userDataCenterClusterId=null}}Object(k.a)(wu,"IDocumentDownloadConfig",null,[]);class wr{constructor(){this.totalSlideCount=this.currentSlideIndex=0}}Object(k.a)(wr,"ISlideState",null,[]);class xu{constructor(){this.workingCanvas=this.videoView=null;this.requestedVideoHeight=this.requestedVideoWidth=this.webcamFrameWidth=
this.numFramesPerSecond=0}}Object(k.a)(xu,"IWebcamConfig",null,[]);var Tp=d(669);class js{constructor(t,P,ia,Aa,Ka,pb,Nb,kc,Rc,Yc,hd,se,Ae,we){this.XVa=!1;this.uw=this.jpe=this.rX=this.Sda=null;this.bgc=0;this.MPg=-1;this.khc=0;this.Xad=this.Nad=null;this.tse=this.jse=!1;this.Kye=this.nma=0;this.KL=!1;this.va=new wg.a;this.IXa=null;this.Ivg=this.xBe=this.poe=!1;this.Mye=null;this.cbc=this.Nrg=0;this.QSg=this.Zug=!1;this.gvg=v.AFrameworkApplication.fa.ka("FirstRehearsalExperienceEnabled");this.D5j=
ia;P&&(this.Sda=P.AF());this.kb=Aa;this.ia=t;this.qc=Ka;this.ua=pb;this.Xa=Nb;this.la=kc;this.Kl=Rc;this.hea=Yc;this.agc=hd;this.iy=se;this.eO=Ae;this.hB=we;this.d3b()&&this.iy.G9h(Object(r.a)(this,this.Z4g,"onRehearsalOptOutSettingsRequestFinished"))}vb(){this.ia.ya(hb.a.hrc,lb.a.application,Object(r.a)(this,this.hrc,"startRehearsalManager"));this.ia.ya(hb.a.BNb,lb.a.application,Object(r.a)(this,this.BNb,"toggleRehearsalVisionEnabled"));this.ia.ya(hb.a.pnc,lb.a.application,Object(r.a)(this,this.pnc,
"rehearsePresentationDropDown"));this.ia.ra(hb.a.JIb,lb.a.application,Object(r.a)(this,this.JIb,"queryRehearsalVisionEnabled"),96)}JIb(t,P,ia,Aa,Ka){if(!Ka||!Object(Lh.a)(Nl.a,Ka))return O.a.J(512496082,822,10,"RehearsalManager::QueryRehearsalVisionEnabled requires actionData"),8;Ka.Qf(this.KL);return 32}pnc(t,P,ia){switch(ia){case 1:if(this.XVa&&this.ble())return this.ia.processAction(hb.a.Afa,1);break;default:O.a.J(512496081,822,10,"RehearsePresentationDropDown: Unimplemented action behavior")}return 8}BNb(t,
P,ia,Aa,Ka){switch(ia){case 2:return this.KL=!this.KL,v.AFrameworkApplication.Aa&&v.AFrameworkApplication.Aa.hb.Np&&Vi.App.Kb.mG({ToggleRehearsalVisionEnabled:"CheckboxModel"}),this.d3b()&&Ka&&Ka.triggerPoint!==Ge.pgh&&(this.iy.s1d=this.KL),32;case 1:if(this.XVa&&this.ble())return 32;break;default:O.a.J(512496080,822,10,"ToggleVisionEnabled: Unimplemented action behavior")}return 8}hrc(t,P,ia,Aa,Ka){switch(ia){case 2:return this.$kl(Ka),32;case 1:if(this.XVa&&this.ble())return 32;break;default:O.a.J(512496079,
822,10,"StartRehearsalManager: Unimplemented action behavior")}return 8}kac(){try{this.Nrg=Date.now();const t=this.D5j.Pw;t.loadScript("powerpoint-presenter-coach-strings").then(()=>{const P=new ha.a;P.add(t.loadScript("CoachActorPackage"));P.add(t.loadScript("CoachPackage"));Promise.all(P.toArray()).then(()=>{this.Xmk();return null}).catch(ia=>{O.a.J(512496078,801,10,"Failed to load scripts for the Presenter Coach feature: {0}",ia);return null})})}catch(t){O.a.J(512496077,822,10,"RehearsalManager: Exception in LoadResources : {0}.",
t)}}Z8h(t){this.va.addHandler("OnCoachResourcesLoaded",t)}GTk(t){this.va.removeHandler("OnCoachResourcesLoaded",t)}Xmk(){const t=v.AFrameworkApplication.fa.Ha("CoachPackageCssUrl"),P=document.createElement("link");P.setAttribute("rel","stylesheet");P.setAttribute("type","text/css");P.setAttribute("href",t);$addHandler(P,"load",()=>{this.XVa=!0;$c.a("PollToRefreshCoachEntryPointOnRibbon")&&this.hB&&this.hB.BH();this.va.raiseEvent("OnCoachResourcesLoaded",new Sys.EventArgs);O.a.J(512496076,822,50,"RehearsalManager: Coach package loading time: {0}ms",
Date.now()-this.Nrg)});document.body.appendChild(P)}AQk(){this.kb.PFc(Object(r.a)(this,this.c6g,"onSlideshowReady"));this.kb.nPa(Object(r.a)(this,this.Pjc,"onSlideShowPositionChanged"));this.kb.lia(Object(r.a)(this,this.jfa,"onSlideshowExitHandler"));this.kb.QFc(Object(r.a)(this,this.$wa,"onSpecialKeyHandler"))}PJi(){this.kb.kkd(Object(r.a)(this,this.c6g,"onSlideshowReady"));this.kb.fib(Object(r.a)(this,this.Pjc,"onSlideShowPositionChanged"));this.kb.Cfa(Object(r.a)(this,this.jfa,"onSlideshowExitHandler"));
this.kb.lkd(Object(r.a)(this,this.$wa,"onSpecialKeyHandler"))}$wa(t,P){P.key===wa.a.jPb&&this.vTe()}vTe(){if(0===this.nma){var t=this.uw.getCoachElement(Ge.T4f);t&&this.yKa(t)}else 2===this.nma?(t=this.uw.getCoachElement(Ge.jzk))&&this.yKa(t):1===this.nma&&(t=this.uw.getCoachElement(Ge.QYj))&&this.yKa(t)}yKa(t){this.Sda&&this.uw&&window.setTimeout(()=>{Wb.FocusManager.Sr(t)},50)}Sz(t){try{const Ka=this.uw.getCoachElement(Ge.T4f),pb=this.uw.getCoachElement(Ge.PYj),Nb=this.uw.getCoachElement(Ge.BEl),
kc=this.uw.getCoachElement(Ge.kkk);if(t.keyCode===wa.a.Pq){if(!$c.a("PresenterCoachTabFix")){var P=!Nb&&!!Ka&&t.target===Ka||!!Nb&&t.target===Nb,ia=!!Ka&&!!pb&&pb.contains(t.target),Aa=!!kc&&t.target===kc;(P||ia||Aa)&&this.kb.restoreFocus()}}else t.keyCode===wa.a.PR||t.keyCode===wa.a.K1?(this.kb.prev(),this.vTe()):t.keyCode===wa.a.lP||t.keyCode===wa.a.I1?(this.kb.next(),this.vTe()):t.keyCode===wa.a.tq||t.keyCode===wa.a.QOb||t.shiftKey||this.kb.restoreFocus()}catch(Ka){O.a.J(512496075,822,10,"RehearsalManager: Exception in KeyDownHandler : {0}.",
Ka)}}LPk(){const t=this.uw.getCoachElement(Ge.eyi);if($c.a("PresenterCoachTabFix")){var P=document.getElementById("HiddenFocusTrapAnchor");this.Sda.insertBefore(t,P)}else P=document.getElementById("slideshowEndFocusTrap"),this.Sda.insertBefore(t,P);t&&nd.a.addHandler(t,oa.a.Zf,Object(r.a)(this,this.Sz,"keyDownHandler"))}$kl(t){if(!this.ua.Ba)throw Error.argumentNull("ActiveSlide is null");Ge.oCj();this.AQk();this.d3b()&&(this.iy.Tld(),this.iy.cUk(Object(r.a)(this,this.Z4g,"onRehearsalOptOutSettingsRequestFinished")));
const P=new wr;this.IXa=$m(this.la,this.la.Fxa);this.KL&&!this.la.pptRehearsalVisionEnabled&&O.a.J(512496074,822,10,"RehearsalManager::startRehearsalSession: vision enabled but BRS is disabled.");this.KL=this.KL&&this.la.pptRehearsalVisionEnabled;var ia=new Fq.a,Aa=Object(R.a)(115,this.qc.cEa(this.ua.Ba.Cb.sid));P.currentSlideIndex=Aa?Aa.oe:0;P.totalSlideCount=this.qc.Lj();Aa=this.$3i(P);this.uw=(new CoachActorPackage.CoachActorFactory).createCoachActorManager(Aa,ia);this.KL&&(this.Nad=this.uw.getRehearsalVideoElement(),
this.Xad=this.uw.getRehearsalVideoCanvas());this.Kye=t;t=this.F4d(P,this.Nad,this.Xad);this.rX=(new CoachPackage.CoachSessionFactory).createCoachManager(t);t=this.a4i();this.jpe=(new CoachActorPackage.CoachFREActorFactory).createCoachFREActorManager(t,ia);$c.a("PPTORehearsalLogAudioInputDeviceCountTelemetry")&&this.eO.enumerateDevices(Object(r.a)(this,this.ijc,"onEnumerateDevicesSuccess"),Object(r.a)(this,this.DYa,"onDevicesFailure"),Object(r.a)(this,this.OYa,"onUnsupported"));this.EOk();this.FOk();
this.bgc=0;this.tse=!1;this.LPk();2===this.Kye&&(ia=localStorage.getItem(Ge.KJe),this.gvg&&!ia?this.sxh():this.fYe())}fYe(){this.nma=0;this.hea.execute(t=>{t.cD(Tp.a.SubtitlesButton,!1);t.cD(Tp.a.LiveButton,!1);t.cD(Tp.a.CoachButton,!1);t.cD(Tp.a.MicButton,!1)});this.rX.startSession(!0)}sxh(){this.jpe.showCoachFREUI(t=>{localStorage.setItem(Ge.KJe,"true");this.QSg=t;this.fYe()})}ijc(t){this.cbc=0;if(t.length)for(var P of t)"audioinput"===P.kind&&(this.cbc+=1);else this.cbc=0;this.Zug=!0;t=new wr;
P=Object(R.a)(115,this.qc.cEa(this.ua.Ba.Cb.sid));t.currentSlideIndex=P?P.oe:0;t.totalSlideCount=this.qc.Lj();t=this.F4d(t,this.Nad,this.Xad);this.rX.updateSessionConfiguration(t)}DYa(t){O.a.J(512496073,822,50,"RehearsalManager::OnDevicesFailure unable to get devices. Error: {0}",t.toString())}OYa(){O.a.J(512496072,822,10,"RehearsalManager::OnDevicesUnsupported mediaDevices API not available for browser: {0}",ve.a.Ly)}c6g(){const t=localStorage.getItem(Ge.KJe);this.gvg&&!t?this.sxh():this.fYe()}Pjc(t,
P){t=new wr;t.currentSlideIndex=P.slideIndex;t.totalSlideCount=this.qc.Lj();P=this.F4d(t,this.Nad,this.Xad);this.rX.updateSessionConfiguration(P);this.uw.updateCoachSlideComponent(t)}getTraceRequestMetadata(t,P){const ia={};if(t)for(let Aa in t)ia[Aa]=t[Aa];if(P)for(let Aa in P)ia[Aa]=P[Aa];t=fe.b(v.AFrameworkApplication.fa.appSettings.SessionStartInfoJson.toString());ia.AudienceGroup=t.Ring||"Unknown";ia.BuildVersion=v.AFrameworkApplication.buildVersion||"Unknown";ia.ClientType="web";ia.IdentityProvider=
this.la.hostAuthType||v.AFrameworkApplication.fa.Ha("HostAuthType")||"Unknown";ia.Locale=this.la.rJa||"Unknown";ia.SpeechMode="rehearsal";ia.TenantId=v.AFrameworkApplication.fa.Ha("TenantId");ia.UserId=this.getUserId();ia.WacDatacenter=t.WACDatacenter||"Unknown";ia.WacHost=t.Host||"Unknown";ia.SourceLanguage=this.la.kEf||vp(this.la.Fxa);return ia}getUserId(){let t=v.AFrameworkApplication.fa.Ha("PptEditingUserId");ab.a.Wa(t)&&(t=v.AFrameworkApplication.fa.Ha("LoggableUserId"),n.ULS.sendTraceTag(512496071,
822,50,"GetUserId PptEditingUserId is empty. LoggableUserId is null or empty {0}",ab.a.Wa(t)));return t}$2k(){if(this.la.fAk){var t=this.rX.getTraceRequestMetadata(),P=this.uw.getTraceRequestMetadata(),ia=this.la.pptEditorSpeechHandlerBaseUri.replace("wss","https");if(ia&&ia.length){var Aa=String.format("{0}SpeechHandler.ashx?action=SendTraceRequest",ia);ia=new XMLHttpRequest;ia.open("POST",Aa,!0);Aa=Ca.a.create().toString();ia.setRequestHeader("X-Correlation",Aa);try{n.ULS.sendTraceTag(512496069,
822,50,"SendPPTCastTraceRequest: Sending request with CorrelationId:{0}",Aa);const Ka=this.getTraceRequestMetadata(t,P);ia.send(fe.c(Ka))}catch(Ka){n.ULS.sendTraceTag(512496068,822,10,"SendPPTCastTraceRequest failed. CorrelationId:{0}",Aa)}}else n.ULS.sendTraceTag(512496070,822,10,"SendPPTCastTraceRequest failed: unable to retrieve basePPTCastUrl.")}}jfa(){this.PJi();this.nma=3;this.rX.stopSession();this.jpe.hideCoachFREAndWelcomeUI();this.uw.hideCoachUI();this.xBe=this.poe=!1;try{this.rX.getSessionSummary(t=>
{t.timeSpentInSeconds=this.bgc;this.ia.processAction(hb.a.DNc,2);this.ia.processAction(hb.a.CNc,2);window.clearInterval(this.MPg);this.tse&&this.agc.instance.VKa(t,this.KL,this.IXa,this.Mye,()=>{this.$2k()})})}catch(t){n.ULS.sendTraceTag(512496067,822,10,"OnSlideshowExitHandler - getSessionSummary failed. Exception:{0}",t)}}Hfj(){let t=",visionFace";this.la.SCk&&(t+=","+Ge.VDl+","+Ge.UDl);this.la.TCk&&(t+=","+Ge.XDl+","+Ge.WDl);this.la.RCk&&(t+=","+Ge.RDl+","+Ge.SDl+","+Ge.TDl);return Ge.tFl+(Zm(this.IXa,
Ge.W1d)?","+Ge.W1d:"")+","+Ge.A3k+","+Ge.qAi+","+Ge.Dvk+","+Ge.ABk+(this.la.LJe&&Zm(this.IXa,Ge.r$d)?","+Ge.r$d:"")+(this.la.aJe&&Zm(this.IXa,Ge.ICe)?","+Ge.ICe:"")+(this.la.pptRehearsalVisionEnabled&&Zm(this.IXa,Ge.GIh)?t:"")+(this.la.pptRehearsalPronunciationEnabled&&Zm(this.IXa,Ge.pLe)?","+Ge.pLe:"")+(this.la.pptRehearsalCrutchWordsEnabled&&Zm(this.IXa,Ge.xXd)?","+Ge.xXd:"")}F4d(t,P,ia){const Aa=new vr;Aa.disabledCoachRealtimeFeatures="";Aa.userSessionId=v.AFrameworkApplication.userSessionId;var Ka=
new wu;Ka.docId=v.AFrameworkApplication.jh;Ka.podsSessionId=this.Xa.podSessionId;Ka.userDataCenterClusterId=this.Xa.nk;Ka.webServiceBase=this.la.podsWebServiceBase;Aa.documentDownloadConfig=Ka;Ka=new Fq.a;Aa.logger=Ka;Ka={};Ka.currentSlideIndex=t.currentSlideIndex.toString();Aa.customSettings=Ka;Aa.fEnableServiceSideAggregationForCoach=this.la.mhd;Aa.httpTimeoutForCoachSummaryData=this.la.dDk;Aa.fSendClientMetaDataOnSessionStart=this.la.FPi;Aa.speechFDBase=this.la.pptEditorSpeechHandlerBaseUri;Aa.requestedCoachFeatures=
this.Hfj();this.d3b()&&(this.Mye=this.iy.k2f(!0),Aa.requestedRehearsalOptOutFeatures=this.Mye);$c.a("RehearsalTimeStampedCritiqueTelemetryEnabled")&&(Aa.enableTimeStampedCritiqueTelemetry=!0);Aa.entryPoint=Bl[this.Kye];Aa.fEnableVision=this.KL;Aa.fEnableVision&&P&&ia&&(Aa.webcamConfig=Object.assign(new xu,{videoView:P,workingCanvas:ia,numFramesPerSecond:this.la.pptRehearsalVisionFramesPerSecond,webcamFrameWidth:this.la.VCk}));Aa.supportedRehearsalTemplates=this.uw.getSupportedRehearsalTemplates();
$c.a("PPTORehearsalLogAudioInputDeviceCountTelemetry")&&this.Zug&&(Aa.audioInputDeviceCount=this.cbc);t=fe.b(v.AFrameworkApplication.fa.appSettings.SessionStartInfoJson.toString());Aa.userId=this.getUserId();Aa.tenantId=v.AFrameworkApplication.fa.Ha("TenantId");Aa.identityProvider=this.la.hostAuthType||v.AFrameworkApplication.fa.Ha("HostAuthType")||"Unknown";Aa.audienceChannel="";Aa.audienceGroup=t.Ring||"Unknown";Aa.buildVersion=v.AFrameworkApplication.buildVersion||"Unknown";Aa.locale=this.la.rJa||
"Unknown";Aa.wacHost=t.Host||"Unknown";Aa.wacDatacenter=t.WACDatacenter||"Unknown";Aa.sourceLanguage=this.la.kEf||vp(this.la.Fxa);O.a.J(512496066,822,50,"getCoachSessionConfig: Language values are PodsUICulture: {0}, RegionalSettingsUserLanguage: {1}.",this.la.rJa,this.la.Fxa);return Aa}a4i(){const t=new Te;t.rootContainer=this.Sda;t.zIndex=Ge.ngh;t.imagesBaseFilePath=v.AFrameworkApplication.fa.Ha("CoachImagesBaseFilePath");return t}$3i(t){const P=new vu;P.rootContainer=this.Sda;P.slideState=t;P.imagesBaseFilePath=
v.AFrameworkApplication.fa.Ha("CoachImagesBaseFilePath");P.zIndex=Ge.ngh;P.fEnableVision=this.KL;P.fShowRealtimeFeedbackEnabledCheckbox=this.la.eAk;P.fUseNewRealtimePanel=this.la.Njd;P.fUseCountdownWelcomeScreen=v.AFrameworkApplication.fa.ka("PptCoachEnableCountdownWelcomeUI");P.speechFDBase=Rp(this.la.pptEditorSpeechHandlerBaseUri);P.fDontShowTooltips=ve.a.fg;P.fUseNewRealtimeCheckbox=$c.a("UseNewRealtimeCheckbox");return P}Kzl(){2!==this.nma&&(this.bgc+=1,this.uw&&this.uw.updateTimer(this.bgc))}EOk(){this.uw.on("CoachSessionStarted",
()=>{this.nma=1;this.MPg=window.setInterval(Object(r.a)(this,this.Kzl,"updatePresentationTimer"),1E3);this.rX.enableVoiceStreaming();this.ohl();this.tse=!0});this.uw.on("CoachSessionPaused",()=>{this.nma=2;this.rX.pauseSession();this.uja()&&this.Kl.instance.hide()});this.uw.on("CoachSessionResumed",()=>{this.nma=1;this.rX.resumeSession()})}FOk(){this.rX.on("SpeechRecognitionStarted",()=>{this.jse&&this.uja()&&(this.Kl.instance.hide(),this.jse=!1)});this.rX.on("PPTCoachRealtimeNotification",t=>{this.Ppj(t)});
this.rX.on("QualityStatusChanged",t=>{this.ktj(t)});this.rX.on("MediaStatusChanged",t=>{this.Rrj(t)});this.rX.on("Error",t=>{this.handleError(t)});this.rX.on("ConnectionRetry",()=>{this.Xqj()})}Xqj(){this.jse=!0;this.uja()&&this.Kl.instance.show(Ge.WWf,Wi.a.uYa)}Ppj(t){this.uw.updateCoachRealtimeNotification(t)}handleError(t){t=Object(R.a)(String,t);this.nma=4;t?t.startsWith("ErrorAudio")?(this.uw&&this.uw.showCoachDisabledUI(0),this.uja()&&this.Kl.instance.show(Ge.MQf,Wi.a.uYa)):t.startsWith("ErrorVideo")?
(this.uw&&this.uw.showCoachDisabledUI(1),this.uja()&&this.Kl.instance.show(Ge.SQf,Wi.a.uYa)):O.a.J(512496064,822,10,"RehearsalManager::handleError unhandled errorInfo"):O.a.J(512496065,822,10,"RehearsalManager::handleError errorInfo null")}mxh(){this.uw&&(this.KL&&this.uw.enableCoachVideoUI(),this.uw.showCoachRealtimeUI(this.QSg));this.uja()&&this.Kl.instance.show(Ge.QLf,Wi.a.Mcd)}Rrj(t){"AudioDeviceConnected"===t.mediaStatus?(this.poe=!0,this.KL&&!this.xBe||this.mxh()):"VideoSetupCompleted"===t.mediaStatus&&
(this.xBe=!0,this.poe&&(this.uw&&this.uw.enableCoachVideoUI(),this.mxh()))}ktj(t){if(this.la.pptEditorVoiceUXEnabled){var P=t.severity,ia=t.shortCode;if(0<ia&&ia<Ge.Jzf&&Ge.uY[ia])switch(P){case 0:this.uja()&&this.Kl.instance.hide();break;case 1:(t=0<ia?Ge.uY[ia]:t.shortString)&&this.uja()&&this.Kl.instance.show(t,Wi.a.$Fb);break;case 2:(t=0<ia?Ge.uY[ia]:t.shortString)&&this.uja()&&this.Kl.instance.show(t,Wi.a.uYa)}else O.a.J(512496035,822,10,"onQualityStatusChanged: Invalid short code")}}uja(){return this.la.pptEditorVoiceUXEnabled&&
this.Kl&&this.Kl.instance&&2!==this.nma?!0:!1}ohl(){this.uja()&&(this.Kl.instance.show(Ge.RLf,Wi.a.Mcd),this.khc=window.setTimeout(Object(r.a)(this,this.hbe,"hideSoundReminderNotification"),3E3))}hbe(){this.uja()&&(window.clearTimeout(this.khc),this.Kl.instance.hide())}d3b(){return this.la.THb&&!!this.iy}ble(){return this.d3b()?this.Ivg:!0}Z4g(){this.Ivg=!0;this.KL=this.iy.s1d;$c.a("PollToRefreshCoachEntryPointOnRibbon")&&this.hB&&this.hB.BH()}}Object(k.a)(js,"RehearsalManager",null,[747]);class lt{constructor(t,
P,ia){this.Ao=t;this.ia=P;this.la=ia}VKa(t,P,ia,Aa,Ka){try{const kc=document.createElement("div");kc.id="SummaryPageOverlay";kc.style.width="100%";kc.style.height="100%";kc.style.zIndex="999";kc.style.display="flex";kc.style.flexDirection="column";kc.style.justifyContent="center";kc.style.position="absolute";var pb=document.getElementById("SummaryPageOverlay");pb&&document.body.removeChild(pb);document.body.insertBefore(kc,document.body.firstChild);const Rc=kc.parentNode;nd.a.addHandler(Rc,oa.a.Zf,
Object(r.a)(this,this.C4g,"onParentNodeKeyDownHandler"));var Nb=t.thumbIndices;if(Nb){pb={};let Ae=0;const we=this.Cij(Nb);for(let Jf=0;Jf<Nb.length;Jf++)pb[Nb[Jf].toString()]=we[Jf],we[Jf]||Ae++;O.a.J(42320001,817,50,"RehearsalSummaryPageHelper::ShowRehearsalSummary: number of slide thumbs requested = {0}, number of slides not found in cache = {1}",Nb.length,Ae);t.slideImageSrcs=pb}else t.slideImageSrcs={},O.a.J(594068941,817,50,"RehearsalSummaryPageHelper::ShowRehearsalSummary: no slide thumbs object from Rehearsal");
const Yc=v.AFrameworkApplication.OE;Yc||O.a.J(557424734,817,50,"RehearsalSummaryPageHelper::ShowRehearsalSummary: Feedback card is dsiabled");ia||(ia=$m(this.la,this.la.Fxa));Nb={};const hd=fe.b(v.AFrameworkApplication.fa.appSettings.SessionStartInfoJson.toString()).WACSessionID;Nb.fFeedbackCardEnabled=this.la.gAk&&Yc;Nb.fShowFeedbackButton=Yc;Nb.fMonotoneEnabled=this.la.aJe&&Zm(ia,Ge.ICe);Nb.fGrammarEnabled=this.la.LJe&&Zm(ia,Ge.r$d);Nb.fFillersCardEnabled=Zm(ia,Ge.W1d);Nb.locale=this.la.Fxa;Nb.fPronunciationCardEnabled=
this.la.pptRehearsalPronunciationEnabled&&Zm(ia,Ge.pLe);Nb.fCrutchWordCardEnabled=this.la.pptRehearsalCrutchWordsEnabled&&Zm(ia,Ge.xXd);Nb.fVisionEnabled=P&&this.la.UCk&&this.la.pptRehearsalVisionEnabled;const se=jt(this.la,this.la.Fxa);ab.a.Wa(se)||(Nb.fPacingGaugeRange=se);ab.a.Wa(hd)||(Nb.clientSessionId=hd);this.la.THb&&(Nb.rehearsalOptOutFeatures=Aa);(new rehearsalSummaryPage.RehearsalSummaryPageController(kc,t,()=>{O.a.J(51144073,817,50,"RehearsalSummaryPageHelper::ShowRehearsalSummary: Try Again button clicked.");
Ka&&Ka();this.ia&&(kc.parentNode.removeChild(kc),this.ia.La(hb.a.Afa,2,{entryPoint:3}))},()=>{Ka&&Ka();nd.a.removeHandler(Rc,oa.a.Zf,Object(r.a)(this,this.C4g,"onParentNodeKeyDownHandler"))},this.la.podsWebServiceBase,decodeURIComponent(this.la.Fgd),()=>{this.Lfl()},Nb,Rp(this.la.pptEditorSpeechHandlerBaseUri),"Web",()=>{this.jfl()})).renderSummaryPage()}catch(kc){O.a.J(51144075,817,10,"RehearsalSummaryPageHelper::ShowRehearsalSummary Exception while generating summary page: {0}",kc.toString())}}C4g(t){"MainApp"===
t.target.id&&(t.preventDefault(),t.stopPropagation())}jfl(){O.a.J(556012420,817,50,"RehearsalSummaryPageHelper::ShowCoachSettingsTaskPane: Rehearsal opt out card clicked.");this.ia&&this.la.THb&&this.ia.La(hb.a.Dpd,2,null)}Lfl(){O.a.J(51144077,817,50,"RehearsalSummaryPageHelper::ShowRehearsalSummary: Feedback button clicked.");this.ia&&(this.la.lCk?this.ia.La(hb.a.sgh,2,null):this.ia.La(E.a.giveFeedback,2,!1))}Cij(t){const P=Array(t.length);if(!this.Ao)return P;const ia=this.Ao.hL(),Aa=this.Ao.VSa();
for(let Ka=0;Ka<t.length;Ka++){const pb=Aa[ia[t[Ka]].sid.toString()];pb&&pb.thumbnailImage.length&&(P[Ka]=pb.thumbnailImage)}return P}}Object(k.a)(lt,"RehearsalSummaryPageHelper",null,[]);class ks{constructor(t,P,ia,Aa,Ka){this.XVa=!1;this.va=new wg.a;this.ia=t;this.Q4c=new lt(P,this.ia,Aa);this.Ewe=ia;this.s$c=Ka}vb(){this.ia.ya(hb.a.VKa,lb.a.application,Object(r.a)(this,this.rhl,"showSummaryPage"));this.ia.ya(hb.a.sgh,lb.a.application,Object(r.a)(this,this.Sfl,"showFloodgateSurvey"))}VKa(t,P,ia,
Aa,Ka){this.Q4c.VKa(t,P,ia,Aa,Ka)}rhl(t,P,ia,Aa,Ka){switch(ia){case 2:return this.Q4c.VKa(Ka,!1,null,null,null),32;case 1:if(this.XVa)return 32;break;default:O.a.J(41793168,822,10,"ShowSummaryPage: Unimplemented action behavior")}return 8}Sfl(t,P,ia){switch(ia){case 2:return this.s$c.execute(Aa=>{Aa.kMb("PPTRehearsePresentationSurvey","PowerPointRehearsePresentationSurveyEnabled")}),32;case 1:if(this.XVa)return 32;break;default:O.a.J(42825479,822,10,"ShowFloodgateSurvey: Unimplemented action behavior")}return 8}kac(){const t=
Date.now();this.Ewe("rehearsalSummaryPage").then(()=>{const P=v.AFrameworkApplication.fa.Ha("RehearsalSummaryPageCssUrl"),ia=document.createElement("link");ia.setAttribute("rel","stylesheet");ia.setAttribute("type","text/css");ia.setAttribute("href",P);$addHandler(ia,"load",()=>{this.XVa=!0;this.va.raiseEvent("OnRehearsalSummaryResourcesLoaded",new Sys.EventArgs);O.a.J(555798673,817,50,"RehearsalSummaryPage: Loading time: {0}ms",Date.now()-t)});document.body.appendChild(ia);return null})}I9h(t){this.va.addHandler("OnRehearsalSummaryResourcesLoaded",
t)}eUk(t){this.va.removeHandler("OnRehearsalSummaryResourcesLoaded",t)}}Object(k.a)(ks,"RehearsalSummaryPageActor",null,[745]);class xr{constructor(t,P,ia,Aa,Ka){this.qjg=this.Reg=!1;this.ia=t;this.Ga=P;this.Lye=ia;this.agc=Aa;this.twa=Ka;this.Lye.execute(pb=>{pb.Z8h(Object(r.a)(this,this.W1g,"onCoachResourcesLoaded"))});this.agc.execute(pb=>{pb.I9h(Object(r.a)(this,this.a5g,"onRehearsalSummaryResourcesLoaded"))})}dispose(){this.Lye.instance&&this.Lye.instance.GTk(Object(r.a)(this,this.W1g,"onCoachResourcesLoaded"));
this.agc.instance&&this.agc.instance.eUk(Object(r.a)(this,this.a5g,"onRehearsalSummaryResourcesLoaded"))}W1g(){this.Reg=!0;this.vCh()}a5g(){this.qjg=!0;this.vCh()}vCh(){this.Reg&&this.qjg&&Ya.a.get_instance().Dk(10,null).continueWith(()=>{if(this.Ga.$th&&this.Ga.QCk){const t=document.getElementById("rehearsal-loading-dialog-modal");t?(t.style.display="none",O.a.J(560468302,822,50,"Rehearsal Trigger: Hide rehearsal loading dialog")):O.a.J(560468303,822,10,"Rehearsal Trigger: Rehearsal deep link session triggered with no loading dialog element")}if(32===
this.ia.processAction(hb.a.Afa,1))if(this.Ga.$th)this.ia.La(hb.a.Afa,2,{entryPoint:5});else if(!this.Ga.tT&&this.Ga.vah&&this.Ga.sCk)try{this.twa.continueWith(()=>{this.twa.result.logActivity("HasCoachInPresentDropDownSeen","PPTCoachInPresentDropDownTeachingUIEnabled")}),O.a.J(590120386,822,50,"Rehearsal Trigger: Teaching UI triggered for Coach in Present Drop Down")}catch(t){O.a.J(590120384,822,10,"Rehearsal Trigger: Exception thrown when trying to trigger teaching UI. Exception: {0}",t)}})}}Object(k.a)(xr,
"RehearsalTrigger",null,[748]);class ls{constructor(){this.K=this.iy=null}get name(){return"PowerPointWebEditor.Rehearsal"}fxi(){this.K.register(745,"PowerPointWebEditor.Rehearsal.IRehearsalSummaryPageActor").ma().oa(()=>new ks(v.AFrameworkApplication.Ta,this.K.resolve("PowerPointWebEditor.IThumbnailDataStoreManager"),kl.a(this.K),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.Ja("Common.ISystemInitiatedFeedback")));this.K.resolve("PowerPointWebEditor.Rehearsal.IRehearsalSummaryPageActor").vb()}$b(t){this.K=
t;this.K.Ja("PowerPointWebEditor.IThumbnailDataStoreManager").execute(()=>{this.fxi()});if(this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptEditorRehearsalSpeechClientEnabled){this.K.register(746,"PowerPointWebEditor.Rehearsal.IRehearsalFeedbackSettings").ma().oa(()=>new ur(v.AFrameworkApplication.Je,this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.IJsonpHelperManager"),this.K.resolve("Common.IActionManagerExtended")));this.iy=this.K.resolve("PowerPointWebEditor.Rehearsal.IRehearsalFeedbackSettings");
const P=this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame");this.K.register(747,"PowerPointWebEditor.Rehearsal.IRehearsalManager").ma().oa(()=>new js(v.AFrameworkApplication.Ta,P,this.K.resolve("Common.IDynamicScriptLoaderProvider"),this.K.resolve("PowerPointWebEditor.ISlideshowFrame"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),
A.a.instance.Ja("PowerPointWebEditor.ISlideShowVoiceNotification"),A.a.instance.Ja("PowerPointWebEditor.ISlideshowToolbar"),A.a.instance.Ja("PowerPointWebEditor.Rehearsal.IRehearsalSummaryPageActor"),this.iy,this.K.resolve("PowerPointWebEditor.Core.IAudioSettingsContext"),this.K.resolve("PowerPointWebEditor.IRibbonUser")));this.K.resolve("PowerPointWebEditor.Rehearsal.IRehearsalManager").vb();this.K.register(748,"PowerPointWebEditor.Rehearsal.IRehearsalTrigger").ma().oa(()=>new xr(v.AFrameworkApplication.Ta,
this.K.resolve("PowerPointWebEditor.IApplicationSettings"),A.a.instance.Ja("PowerPointWebEditor.Rehearsal.IRehearsalManager"),A.a.instance.Ja("PowerPointWebEditor.Rehearsal.IRehearsalSummaryPageActor"),Nf.a.Uu(A.a.instance.Ja("Common.ISystemInitiatedFeedback"))));this.K.resolve("PowerPointWebEditor.Rehearsal.IRehearsalTrigger")}}init(){v.AFrameworkApplication.fa.jf(Object(r.a)(this,this.Om,"onFullAppSettingsReady"))}Om(){this.K.resolve("PowerPointWebEditor.IApplicationSettings").w$b&&Ya.a.get_instance().Dk(7,
()=>{this.K.Ja("PowerPointWebEditor.Rehearsal.IRehearsalSummaryPageActor").execute(()=>{this.initialize()})})}initialize(){this.K.resolve("PowerPointWebEditor.Rehearsal.IRehearsalSummaryPageActor").kac();this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptEditorRehearsalSpeechClientEnabled&&this.K.resolve("PowerPointWebEditor.Rehearsal.IRehearsalManager").kac();if(this.K.resolve("PowerPointWebEditor.IApplicationSettings").THb){const t=new kt(this.K.resolve("Common.IDynamicScriptLoaderProvider").Pw,
this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.View.IFocusManagerHelper"),this.iy,this.K.resolve("PowerPointWebEditor.IApplicationSettings"));t.vb();t.De();this.iy.qEj()}}dispose(){}static main(){e.a.instance.Dc(new ls)}}Object(k.a)(ls,"PPTWebEditorRehearsalPackage",null,[2,3]);class Qi{constructor(){this.message=null;this.tv=0}}Object(k.a)(Qi,"HttpRequstToPromiseRejectData",null,[]);class Lq{constructor(t){this.Dba=t}OFa(t,P,ia,Aa,Ka,pb){w.a.sendTelemetryEvent(Object.assign(new I.a,
{name:"Office.Online."+t,dataFields:[Object.assign(new H.a,{name:"EventMessage",string:P}),Object.assign(new H.a,{name:"FormFactor",string:this.Dba.formFactor}),Object.assign(new H.a,{name:"CorrelationId",string:this.Dba.correlationId}),Object.assign(new H.a,{name:"AccountType",string:this.Dba.accountType}),Object.assign(new H.a,{name:"OSVersion",string:this.Dba.osVersion}),Object.assign(new H.a,{name:"AppId",string:this.Dba.appId}),Object.assign(new H.a,{name:"ConsentSurface",string:"AppStart"}),
Object.assign(new H.a,{name:"ConsentLanguage",string:this.Dba.consentLanguage}),Object.assign(new H.a,{name:"EventCode",string:ia}),Object.assign(new H.a,{name:"Region",string:this.Dba.region}),Object.assign(new H.a,{name:"ModelType",string:Aa}),Object.assign(new H.a,{name:"ModelId",string:Ka}),Object.assign(new H.a,{name:"Platform",string:this.Dba.os}),Object.assign(new H.a,{name:"ReConsentReason",string:""}),Object.assign(new H.a,{name:"ConsentType",string:pb})]}))}}Object(k.a)(Lq,"TelemetryLogger",
null,[]);class Mq{constructor(t,P,ia){this.mOh="https://consent.config.office.com/consentcheckin/v1.0/consents";this.$a=t;this.ei=P;this.r7=new Lq(ia)}B0b(t,P,ia,Aa=null,Ka=null){return new Promise((pb,Nb)=>{const kc=null!=Aa?Aa:this.$a.Fc("ApplicationFeatureHelperRequestQueueTimeout",1E3),Rc=null!=Ka?Ka:this.$a.Fc("ApplicationFeatureHelperRequestSentTimeout",2E3);let Yc=this.$a.Ha("UCNoticeCheckinStateUrl");Yc&&Yc.length||(Yc=this.mOh);this.ei.YV(Yc,1,null,this.c6d(t),null,0,hd=>{try{if(void 0===
hd||null===hd||void 0===hd.data||null===hd.data||void 0===hd.data.Zd||null===hd.data.Zd){this.r7.OFa("UnifiedConsent.ConsentGetFailed","ConsentGetFailed : invalid response","511",null,null,null);let Ae=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data or args.Data.ResponseData is null or undefined request {0}","UnifiedConsent.ConsentGetFailed");Nb(this.Sja(Ae,hd))}else if(hd.data.Te!==Ue.a.Ey){this.r7.OFa("UnifiedConsent.ConsentGetFailed","ConsentGetFailed",hd.data.Te.toString(),
null,null,null);let Ae=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: ApplicationFeatureHelper Service token generation returned unexpected response code {0}, request {1}",hd.data.Te,"UnifiedConsent.ConsentGetFailed");Nb(this.Sja(Ae,hd))}else{var se=ia(hd.data.Zd);if(se)pb(se);else{this.r7.OFa("UnifiedConsent.ConsentGetFailed","ConsentGetFailed : Consent Values are empty","512",null,null,null);let Ae=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Failed to parse response for request {0}",
"UnifiedConsent.ConsentGetFailed");Nb(this.Sja(Ae,hd))}}}catch(Ae){this.r7.OFa("UnifiedConsent.ConsentGetFailed","ConsentGetFailed : Unexpected Failure","601",null,null,null),se=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Exception {0} for request {1}",Ae,"UnifiedConsent.ConsentGetFailed"),Nb(this.Sja(se,hd))}},hd=>{let se;this.r7.OFa("UnifiedConsent.ConsentGetFailed","ConsentGetFailed : Error in service call","513",null,null,null);ab.a.gTc(hd.data.Zd||"No Data");se=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Request Failed: HttpStatus - {0}, request - {1}",
hd.data.Te,"UnifiedConsent.ConsentGetFailed");Nb(this.Sja(se,hd))},null,void 0,void 0,kc,Rc)})}Sja(t,P){const ia=new Qi;ia.message=t;ia.tv=P&&P.data?P.data.Te:-1;return ia}c6d(t){const P={};P["Accept-Language"]=this.$a.Ha("UICulture")||"en-US";P.consentsurface="AppStart";P.platform="Web";P.formfactor=this.$a.ka("IsMobileMode")?"Mobile":"Desktop";P["x-Cid"]=Ca.a.create();P.Authorization="Bearer "+t;return P}}Object(k.a)(Mq,"HttpRequestToPromiseUtility",null,[]);class Up{constructor(){this.accountType=
"MSA";this.modelType=null;this.appEnv=0;this.emailId=this.deviceId=this.consentLanguage=this.appVersion=this.appId=this.appName=null;this.formFactor="Unknown";this.token=this.region=this.osVersion=this.os=null;this.useCache=!1;this.correlationId=this.userId=null;this.isDarkMode=!1}}Object(k.a)(Up,"WebSdkAdapterProps",null,[]);class ym{constructor(t,P,ia,Aa){this.ybf=this.tQb=this.I3a=this.YNa=null;this.mmb=Aa;this.$a=t;this.OMh=ia;this.ei=P;this.FEc=this.rRc();this.r7=new Lq(this.FEc)}mfl(){"MSA"===
(this.$a.Ha("HostAuthType")||"").toUpperCase()&&this.OMh.execute(t=>{t.nV("Consent",ym.H0h).then(P=>{P.IsSuccess?this.L4i(P.Token).then(ia=>{this.Lbj(ia);this.YNa&&""!==this.YNa&&t.nV("Consent",ym.J0h).then(Aa=>{Aa.IsSuccess?this.Egl(Aa,this.YNa):this.r7.OFa(ym.yzc,"ConsentGetFailed : Web token generation error",Aa.ErrorCode,this.YNa,this.I3a,this.tQb);return{}});return{}}):this.r7.OFa(ym.yzc,"ConsentGetFailed : Checkin token generation error",P.ErrorCode,this.YNa,this.I3a,this.tQb);return{}})})}L4i(t){this.ybf=
new Mq(this.$a,this.ei,this.FEc);return this.ybf.B0b(t,this.FEc,Object(r.a)(this,this.Jxk,"parseConsentCheckinState")).then(P=>Promise.resolve(P),P=>{this.r7.OFa(ym.yzc,"ConsentGetFailed : Consent Checkin parse error","514",this.YNa,this.I3a,this.tQb);return Promise.reject("Error while getting result"+P)})}Jxk(t){({kv:t}=fe.d(t));return t}Lbj(t){for(const P of t.consentValues)if(P.needConsent&&!P.maxPromptsReached){this.I3a=P.id;this.tQb=P.consentType;this.YNa=P.modelType;break}}Egl(t,P){if(sb.a("showConsentNotice")){const ia=
document.createElement("div");document.body.appendChild(ia);appChrome.api.showConsentNotice(this.W6i(t.Token,P),ia)}else this.r7.OFa(ym.yzc,"ConsentGetFailed : appChrome API does not exist","604",this.YNa,this.I3a,this.tQb)}W6i(t,P){const ia=this.FEc;ia.token=t;ia.modelType=P;return ia}rRc(){const t=this.Dce(this.$a.Ha("SessionStartInfoJson"));return Object.assign(new Up,{emailId:this.$a.Ha("UserPrincipalName"),userId:this.$a.Ha("LoggableUserId"),accountType:"AAD"===(this.$a.Ha("HostAuthType")||"").toUpperCase()?
"AAD":"MSA",appId:this.$a.Ha("OfficeApplicationId"),appVersion:this.$a.Ha("appVersion"),appName:"Application"in t?t.Application:"",appEnv:this.mmb,consentLanguage:this.$a.Ha("UICulture")||"en-US",formFactor:this.$a.ka("IsMobileMode")?"Mobile":"Desktop",os:"Os"in t?t.Os:"",osVersion:"OsVersion"in t?t.OsVersion:"",region:this.$a.Ha("region"),correlationId:Ca.a.create().toString(),isDarkMode:this.$a.ka("DarkModeIsOn"),useCache:!0})}Dce(t){let P={};try{P=fe.b(t)}catch(ia){}return P}}ym.J0h="https://consentservice.microsoft.com/web";
ym.H0h="https://consentservice.microsoft.com/checkin";ym.yzc="UnifiedConsent.ConsentGetFailed";Object(k.a)(ym,"ConsentNoticeManager",null,[803]);class Nq{constructor(){this.Da=null}get name(){return"Common.App.ConsentNoticeDialog"}$b(t){this.Da=t;t.register(ym,"Common.App.ConsentNoticeDialog.ConsentNoticeManager").as("Common.App.ConsentNoticeDialog.IConsentNoticeManager").ma().oa(()=>new ym(v.AFrameworkApplication.fa,v.AFrameworkApplication.Je,t.Ja("Common.App.OAuth.IOAuthManager"),v.AFrameworkApplication.ARa))}init(){this.Da.resolve("Common.App.ConsentNoticeDialog.IConsentNoticeManager")}dispose(){}static main(){e.a.instance.Dc(new Nq)}}
Object(k.a)(Nq,"ConsentNoticeDialogPackage",null,[2,3]);Type.registerNamespace("Box4.Media");Type.registerNamespace("Common.App.VersionHistory");Type.registerNamespace("PPTe");Type.registerNamespace("PowerPointLive");Type.registerNamespace("PowerPointVersionHistory");Type.registerNamespace("PowerPointWeb");Type.registerNamespace("PowerPointWebEditor");Type.registerNamespace("PowerPointWebEditor.Accessibility");Type.registerNamespace("PowerPointWebEditor.AgendaConverter");Type.registerNamespace("PowerPointWebEditor.Designer");
Type.registerNamespace("PowerPointWebEditor.ImageDescription");Type.registerNamespace("PowerPointWebEditor.Infrared");Type.registerNamespace("PowerPointWebEditor.Live");Type.registerNamespace("PowerPointWebEditor.PenMinutes");Type.registerNamespace("PowerPointWebEditor.PresentToTeams");Type.registerNamespace("PowerPointWebEditor.Rehearsal");Type.registerNamespace("PowerPointWebEditor.ReplaceObject");Type.registerNamespace("PowerPointWebEditor.StreamVideoPrefetchOrchestratorUtility");Type.registerNamespace("PowerPointWebEditor.Text");
Type.registerNamespace("PowerPointWebEditor.VersionHistory");Type.registerNamespace("Common.App.AccessibilityChecker");mc.main();Qb.main();Pd.main();Type.registerNamespace("Common.App.AddinCommands");Type.registerNamespace("Common.App.AccessibilitySettings");Lc.main();Type.registerNamespace("Common.App.DirectPrint");e.a.instance.Dc(new nf);Type.registerNamespace("Common.App.DisplayEnvironmentName");pf.main();Type.registerNamespace("Common.App.Embed");Type.registerNamespace("Common.App.InProductMessaging");
zc.main();Type.registerNamespace("Common.App.NewAndOpen.UX");e.a.instance.Dc(new sf);Type.registerNamespace("Common.App.OneDriveFilePickerApi");jg.main();Type.registerNamespace("Common.App.PenMinutesManager");yd.main();Type.registerNamespace("Common.App.SaveAsToHost");Ic.main();Type.registerNamespace("Common.App.SaveToSharePoint");Zj.main();Type.registerNamespace("Common.App.SaveToCloudStorage");xa.main();Type.registerNamespace("Common.App.SaveACopy");Oa.main();Type.registerNamespace("Common.App.PhoneLink");
Bb.main();Type.registerNamespace("Common.App.SharedFilePicker");Qd.main();Type.registerNamespace("Common.Search");Type.registerNamespace("Common.App.SearchOAuthManager");sc.main();Type.registerNamespace("Common.App.WopiIdentity");Cg.main();Type.registerNamespace("Common.App.AppsForOfficeOauth");Type.registerNamespace("Common.App.SmartLookup");Type.registerNamespace("Common.App.ConsentNoticeDialog");Nq.main();Km.main();nk.main();yi.main();tn.main();un.main();Yo.main();e.a.instance.Dc(Bc.a(new rr,0));
bp.main();Type.registerNamespace("Common.App.LivePersonaUtils");tr.main();ls.main()},331:function(K,Z,d){d.d(Z,"a",function(){return u});K=d(0);var k=d(1186),e=d(40),n=d(475),r=d(159),v=d(37),C=d(61),w=d(26),z=d(981),A=d(982);class u{constructor(E){this.pE=E}get node(){return this.pE}get propertySet(){return this.pE}get Tw(){if(1074135132===this.pE.Se)return 0;if(1074135137===this.pE.Se)return 1;w.a.J(18354962,802,10,"Invalid AppType {0}",n.a[this.pE.Se]);return-1}get id(){return 0===this.Tw?this.propertySet.sa(v.a.IZ,
null)+this.shapeId.toString()+this.slideId.toString():this.propertySet.sa(v.a.IZ,null)}get BNf(){return this.propertySet.sa(e.a.nPd,null)}get visibility(){return this.propertySet.sa(e.a.oYb,!1)}get width(){return this.propertySet.sa(e.a.Mci,320)}get row(){return this.propertySet.sa(e.a.Lci,0)}get Ydg(){return this.propertySet.sa(r.a.isForUILessAction,!1)}get Exa(){return this.propertySet.sa(e.a.arb,null)}get version(){return this.propertySet.sa(e.a.DGc,null)}get store(){return this.propertySet.sa(e.a.CGc,
null)}get storeType(){return this.propertySet.eb(v.a.lYb)}get ownerAddinSolutionId(){return this.propertySet.sa(v.a.U7g,null)}get sharedRuntimeId(){return this.propertySet.sa(r.a.sharedRuntimeId,null)}get settings(){const E={};z.a(this.node,(H,I)=>{A.b(I,E)});return E}get slideId(){return 0===this.Tw?C.a.PE(this.pE.eb(v.a.sid),this.pE.eb(v.a.cid)):null}get shapeId(){const E=Object(k.a)(4,this.pE);return 0===this.Tw&&E?E.get_shapeId():0}get ownerAddinStoreType(){return this.propertySet.sa(v.a.ownerAddinStoreType,
null)}get Brb(){return this.propertySet.sa(v.a.Brb,-1)}get c6a(){return this.propertySet.sa(v.a.c6a,null)}}Object(K.a)(u,"AppReader",null,[991])},332:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k{}k.none=null;k.Fti="CoAuth";k.Gbe="IdeasPaneClosed";k.zik="MultiSlidesSelected";k.Bib="Retrigger";k.Umd="SessionEnded";k.Y3k="SessionRehydrated";k.slideNavigation="SlideNavigation";k.NMb="SuggestionPaneClosed";k.Cqd="SuggestionsLoadingTimeout";k.noSuggestion="NoSuggestion";k.typing="Typing";
k.aPb="WebActionId:";k.UQk="Rehydrated";k.KMf="DisallowedRequest";k.aEf="CloseSecondPane";k.Ruk="OpenEditorPane";Object(K.a)(k,"DesignerResetReason",null,[])},333:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k{}k.invalid="Invalid";k.success="Success";k.error="Error";k.pending="Pending";k.GIa="NoResult";Object(K.a)(k,"ProviderResultStatus",null,[])},387:function(K,Z,d){K=d(0);class k{static pcj(){return k._nextEventReceiverId++}}k._nextEventReceiverId=0;Object(K.a)(k,"EventReceiverIdCounter",
null,[]);d.d(Z,"a",function(){return e});class e{constructor(n,r){this.hQh=n;this._id=k.pcj();this.YYh=r}get id(){return this._id}notify(n,r){this.YYh(n,r)}Yca(n,r){return this.hQh.ZGk(n,r?this:null)}}Object(K.a)(e,"EventReceiver",null,[900])},533:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k{}Object(K.a)(k,"OnlineMediaSearchResult",null,[])},534:function(K,Z,d){d.d(Z,"a",function(){return n});K=d(0);var k=d(382),e=d(217);class n{static rdl(r){return parseInt(n.e1e(e.a.ftf,r)||"-1")<=
(new Date).getTime()}static dXf(r){return parseInt(n.e1e(e.a.Mqb,r)||"-1")}static x9f(r){return Boolean.parse(n.e1e(e.a.YXb,r)||"false")}static e1e(r,v){let C=null;try{const w=n.oSc();if(void 0!==w&&w){const z=e.a.cXf(r)+v;C=w.getItem(z)}else k.ULS.sendTraceTag(42074645,220,50,"AddInCommands.Error:TryGetAddinCommandsCache, Storage.Local null")}catch(w){k.ULS.sendTraceTag(42074646,220,10,"Failed to get AddinCommands Cache {0} for ProviderType {1}.",r,v)}return C}static dOb(r,v,C){try{const w=n.oSc();
if(void 0!==w&&w){const z=e.a.cXf(r)+C;w.setItem(z,v)}else k.ULS.sendTraceTag(42074647,220,50,"AddInCommands.Error:TrySetAddinCommandsCache, Storage.Local null")}catch(w){k.ULS.sendTraceTag(42074648,220,10,"Failed to set AddinCommands Cache {0} for ProviderType {1}.",r,C)}}static oSc(){if(!n.f7b)return null;let r=null;try{r=localStorage}catch(v){n.f7b=!1,r=null}return r}}n.f7b=!0;Object(K.a)(n,"AddinUtil",null,[])},535:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k{constructor(e,n){this.O$j=
e;this.ebk=n}get oZc(){return this.O$j}get QXk(){return this.ebk}}Object(K.a)(k,"ReportSuggestionSessionActionData",null,[])},536:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k{}k.LOf="Provider.UCI.Editor";k.FOf="EntityGroup.UCI.Editor";k.owh="Provider.Designer.Slide";k.nwh="EntityGroup.Designer.Slide.Suggestion";k.xwh="Provider.Designer.TextToSmartArt";k.wwh="EntityGroup.Designer.TextToSmartArt.Suggestion";Object(K.a)(k,"InfraredConstant",null,[])},686:function(K,Z,d){d.d(Z,"a",function(){return e});
K=d(0);var k=d(66);class e{constructor(n){this.C9=this.Ela=null;this.He=n}dispose(){this.clear();this.Ela.parentNode.removeChild(this.Ela)}Dia(n){this.Ela=this.w0b(n,"prContainerHr");this.C9=this.w0b(this.Ela,"prGlyph")}clear(){this.Pna()}poa(n,r){n&&(this.Pna(),this.C9.appendChild(n),this.C9.style.backgroundColor=r,this.Ela.style.visibility=k.a.visible)}w0b(n,r){const v=this.He.Fe();this.He.addCssClass(v,r);n.appendChild(v);return v}Pna(){this.C9.firstChild&&this.C9.removeChild(this.C9.firstChild)}}
Object(K.a)(e,"ShapePawnGlyph",null,[])},693:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);var k;(function(e){e[e.notSupported=-1]="notSupported";e[e.OMEX=0]="OMEX";e[e.spCatalog=1]="spCatalog";e[e.spApp=2]="spApp";e[e.fileSystem=3]="fileSystem";e[e.exchange=4]="exchange";e[e.oneDrive=5]="oneDrive";e[e.registry=6]="registry";e[e.inMemory=7]="inMemory";e[e.uploadFileDevCatalog=8]="uploadFileDevCatalog";e[e.hardCodedPreinstall=9]="hardCodedPreinstall";e[e.privateCatalog=10]="privateCatalog";
e[e.wopiCatalog=16]="wopiCatalog"})(k||(k={}));Object(K.b)("AddinProviderType",k)},694:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);var k;(function(e){e[e.notSupported=0]="notSupported";e[e.launchByLocalCacheInitializer=1]="launchByLocalCacheInitializer";e[e.launchByAnonymousApiInitializer=2]="launchByAnonymousApiInitializer";e[e.launchByInsertion=3]="launchByInsertion";e[e.launchByRefresh=4]="launchByRefresh";e[e.launchByLastUpdateInitializer=5]="launchByLastUpdateInitializer";e[e.launchByDynamicCall=
6]="launchByDynamicCall"})(k||(k={}));Object(K.b)("AddinCommandsLaunchOperationType",k)},695:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k{}Object(K.a)(k,"ProviderActionInfo",null,[])},696:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k{constructor(){this.ActiveSlideSid=this.ActiveSlideCid=0;this.Label=this.CorrelationId=null;this.ShapeId=this.ReplaceObjectType=0;this.SmartArtSubNodeId=null;this.SuggestionSid=0}}Object(K.a)(k,"ReplaceObjectSuggestionApplyInfo",null,
[])},978:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k{static add(e,n,r,v,C){k.kqg[k.RWf(e,n,r,v,C)]=!0}static contains(e,n,r,v,C){return k.RWf(e,n,r,v,C)in k.kqg}static RWf(e,n,r,v,C){return String.format("{0}|{1}|{2}|{3}|{4}",e.toLowerCase(),n,r.toLowerCase(),v.toLowerCase(),C.toLowerCase())}}k.kqg={};Object(K.a)(k,"AppsInsertedStorage",null,[])},979:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k{}Object(K.a)(k,"AppsForOfficeEntitlementQueryInfo",null,[])},980:function(K,
Z,d){d.d(Z,"a",function(){return u});K=d(0);var k=d(103),e=d(1186),n=d(38),r=d(40),v=d(30),C=d(82),w=d(243),z=d(37),A=d(981);class u{static QAi(E,H,I){E=Object(e.a)(C.a,E.createInstance(1074135137));u.crf(E,H,I);return E}static M3h(E,H){v.GraphIterator.nb(E).Cl(H,19)}static crf(E,H,I){E.setValue(r.a.yGc,0===H.targetType);E.setValue(r.a.arb,H.solutionId);E.setValue(r.a.DGc,H.version);E.setValue(r.a.mYb,H.storeType);E.setValue(r.a.CGc,H.storeId);E.setValue(z.a.lYb,I.iKc(H.storeType));H.assetId&&E.setValue(z.a.gPd,
H.assetId);E.setValue(z.a.fuf,H.assetStoreId);void 0===H.isAddinCommands?E.setValue(z.a.isAddinCommands,!1):E.setValue(z.a.isAddinCommands,H.isAddinCommands);H.sharedRuntimeId&&-1!==H.backgroundState&&(E.setValue(z.a.Brb,H.backgroundState),E.setValue(z.a.c6a,H.sharedRuntimeId));0===H.targetType&&(E.setValue(z.a.Cq,!0),I=H.height?H.height:200,E.setValue(n.a.nx,H.width?H.width:200),E.setValue(n.a.wC,I))}static oFh(E,H,I){const J=k.a.Qpc(I);A.b(H,D=>{D=D.eb(r.a.AGc);return!!D&&!(D in J)});A.a(H,(D,R)=>
{const Q=R.eb(r.a.AGc);Q&&Q in J&&(u.Pwl(R,J[Q],D),delete J[Q])});const T=v.GraphIterator.nb(H);k.a.forEach(J,(D,R)=>{T.Cl(u.RAi(E,D,R),21)},null)}static RAi(E,H,I){E=Object(e.a)(C.a,E.createInstance(1074135139));E.setValue(r.a.AGc,H);E.setValue(r.a.BGc,I);return E}static Pwl(E,H,I){E.setValue(r.a.BGc,H);I.sa(r.a.yGc,!0)?w.d(I,E,u.I_k):w.d(I,E,u.a0k)}}u.I_k=[z.a.sid,z.a.cid,z.a.shapeId];u.a0k=[r.a.arb];Object(K.a)(u,"AppEditor",null,[])},981:function(K,Z,d){d.d(Z,"a",function(){return n});d.d(Z,"b",
function(){return r});var k=d(30),e=d(982);const n=(v,C)=>{const w=new k.GraphIterator;w.set(v);let z=w.Bb(21);for(;z;)e.a(z)&&C(v,z),z=w.Af(21)},r=(v,C)=>{const w=new k.GraphIterator;w.set(v);let z=w.Bb(21);for(;z&&z!==v;)z=e.a(z)&&C(z)?w.aRa(21):w.Cj(21)}},982:function(K,Z,d){d.d(Z,"b",function(){return e});d.d(Z,"a",function(){return n});var k=d(40);const e=(r,v)=>{v[r.eb(k.a.AGc)]=r.eb(k.a.BGc)},n=r=>1074135139===r.Se},983:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k extends Sys.EventArgs{constructor(e,
n,r=null){super();this.shapeId=e;this.hbg=n;this.QY=r}}Object(K.a)(k,"ReplaceObjectSuggestionPointerOverEventArgs",Sys.EventArgs,[])},984:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k extends Sys.EventArgs{constructor(e,n=null){super();this.shapeId=e;this.QY=n}}Object(K.a)(k,"ReplaceObjectSuggestionPointerOutEventArgs",Sys.EventArgs,[])},985:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k{constructor(){this.KGc=null}}Object(K.a)(k,"IdeasSmartArtSuggestionWrapper",null,
[])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/18430998/wdjs/ppteditDS.chronos2.js.map