'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[13],{1232:function(K,Z,d){d.r(Z);K=d(0);var k=d(68),e=d(26),n=d(189),r=d(50),v=d(28);class C{constructor(wa,ra){this.ia=wa;this.ia.ra(v.a.ozj,r.a.application,n.ActionManager.ov,4);this.ia.ra(v.a.pzj,r.a.application,n.ActionManager.ov,4);this.ia.ra(v.a.qzj,r.a.application,n.ActionManager.ov,4);this.ia.ra(v.a.rzj,r.a.application,n.ActionManager.ov,4);this.ia.ra(v.a.szj,r.a.application,n.ActionManager.ov,4);this.ia.ra(v.a.tzj,
r.a.application,n.ActionManager.ov,4);this.ia.ra(v.a.uzj,r.a.application,n.ActionManager.ov,4);this.ia.ra(v.a.$yj,r.a.application,n.ActionManager.ov,4);this.ia.ra(v.a.azj,r.a.application,n.ActionManager.ov,4);this.ia.ra(v.a.bzj,r.a.application,n.ActionManager.ov,4);this.ia.ra(v.a.czj,r.a.application,n.ActionManager.ov,4);this.ia.ra(v.a.dzj,r.a.application,n.ActionManager.ov,4);this.ia.ra(v.a.ezj,r.a.application,n.ActionManager.ov,4);this.ia.ra(v.a.fzj,r.a.application,n.ActionManager.ov,4);this.ia.ra(v.a.Zyj,
r.a.application,n.ActionManager.ov,4);this.ia.ra(v.a.gzj,r.a.application,n.ActionManager.ov,4);this.ia.ra(v.a.hzj,r.a.application,n.ActionManager.ov,4);this.ia.ra(v.a.jzj,r.a.application,n.ActionManager.ov,4);this.ia.ra(v.a.kzj,r.a.application,n.ActionManager.ov,4);this.ia.ra(v.a.lzj,r.a.application,n.ActionManager.ov,4);this.ia.ra(v.a.mzj,r.a.application,n.ActionManager.ov,4);this.ia.ra(v.a.nzj,r.a.application,n.ActionManager.ov,4);this.usg=JSON.parse(ra.Ha("674"));for(const ya of this.usg)ya.regex=
new RegExp(ya.pattern)}trackAction(wa){for(const ra of this.usg)ra.regex.test(wa)&&this.ia.processAction(ra.actionId,2)}}Object(K.a)(C,"IdeasActionTracker",null,[886]);class w{constructor(){this.Tcb=this.QAe=this.Xze=null;this.LMj=this.VIl}addSlideSuggestionsListener(wa){this.Xze=wa}addTextToSmartArtSuggestionListener(wa){this.QAe=wa}pNd(wa){this.Tcb=wa}notifySlideSuggestion(wa,ra){this.Xze&&(this.Xze(wa,ra),e.a.J(512496328,829,50,"data: count: {0}, correlation: {1}",ra?ra.suggestions.length:0,ra?
ra.correlationId:"0"))}notifyTextToSmartArtSuggestion(wa,ra){this.QAe&&(this.QAe(wa,ra),e.a.J(512496327,829,50,"data: count: {0}, correlation: {1}",ra?ra.suggestions.length:0,ra?ra.correlationId:"0"))}Ncd(wa){this.Tcb&&this.Tcb(wa)}}Object(K.a)(w,"InfraredDesignerServiceProvider",null,[885]);class z{constructor(){this.Tcb=null}pNd(wa){this.Tcb=wa}Ncd(wa){this.Tcb&&this.Tcb(wa)}}Object(K.a)(z,"InfraredTelemetryListener",null,[883]);var A=d(199),u=d(1006),E=d(45),H=d(13),I=d(33);class J{}Object(K.a)(J,
"EntityGroup",null,[]);class T extends J{}Object(K.a)(T,"Idea",J,[]);var D=d(536);class R{}Object(K.a)(R,"ProviderResult",null,[]);var Q=d(333),W=d(437),O=d(436),Y=d(332),S=d(535),da=d(25),fa=d(268);class ka{}ka.LBk="PowerPoint";ka.fEl="WAC";Object(K.a)(ka,"ApplicationPropertiesConstants",null,[]);class ha{}Object(K.a)(ha,"EnterpriseUserInfo",null,[]);class F{}Object(K.a)(F,"Message",null,[]);class na extends F{}na.PowerPointTextTileChangedMessageType="PowerPoint.TextTileChanged";Object(K.a)(na,"PowerPointTextTileChangedMessage",
F,[]);class ba{}Object(K.a)(ba,"RankerConfiguration",null,[]);class Ea{constructor(wa){this.QWg=wa}$0i(wa,ra){return new Promise((ya,Da)=>{this.QWg&&wa&&ra||Da("wopiIdentityManager or tokenParameter or clientWoipId is null");this.QWg.getAccessToken(wa,ra).then(pa=>{pa?ya(pa.accessToken):Da("auth token is null")},pa=>{Da(pa)})})}}Object(K.a)(Ea,"AuthenticationProvider",null,[905]);class La{constructor(wa,ra,ya,Da,pa=""){this.resource=wa;this.scope=ra;this.silentLogin=ya;this.options=Da;this.correlationId=
pa}}Object(K.a)(La,"InfraredTokenParameters",null,[801]);class ta{constructor(wa,ra,ya,Da,pa,la,Fa,Qa,Sa){this.Ayg=this.soe=this.Fbf=null;this.jyg=!1;this.nwe=null;this.Eze=!1;e.a.J(512262852,809,50,"PPTWebEditorInfraredRuntimeManager - Initialize");this.rEb=wa;this.p7j=Fa;this.bue=Sa;this.G9j=wa.ka("659");this.Seb=wa.Ha("750");Fa=window.location.hostname;Sa=wa.Ha("816");Fa&&0<Fa.length&&Sa&&0<Sa.length&&0<=Sa.toLowerCase().indexOf(Fa.toLowerCase())&&(this.Seb="");this.kWa=ra;this.occ=la;if(this.sek=
wa.ka("688"))this.Ayg=wa.Ha("689"),this.soe=new Ea(Qa);this.kWa.addSlideSuggestionsListener(Object(H.a)(this,this.ptk,"onSlideSuggestion"));this.kWa.addTextToSmartArtSuggestionListener(Object(H.a)(this,this.Qtk,"onTextToSmartArtSuggestion"));this.kWa.pNd(Object(H.a)(this,this.w3g,"onIdeasSessionTelemetry"));ya.pNd(Object(H.a)(this,this.w3g,"onIdeasSessionTelemetry"));this.occ&&this.occ.execute(Na=>{Na.nsf(Object(H.a)(this,this.GFe,"onEditorCritiques"))});this.ia=Da;(this.MT=pa)&&this.MT.execute(Na=>
{Na.registerSimpleLocalWorkflow("InfraredSlideTextTileWorkflow",Object.assign(new O.a,{name:"InfraredSlideTextTileLambda",inputSchema:W.a.Sqc,outputSchema:W.a.Sqc,func:(ua,za,Wa)=>{this.qtk(ua);Wa(null)}}))});this.xal()}get Bxb(){return this.Fbf}xal(){var wa=JSON.parse(this.rEb.Ha("612"));wa=Object.assign(new ba,{rankingOrder:wa});var ra=IdeasInfraredConnector,ya=ra.setup,Da=e.a.J,pa=Object(H.a)(this,this.vzj,"ideasPaneVisibilityStatusCallback"),la=this.rEb;const Fa={};Fa.appName=2===da.AFrameworkApplication.Aa.hb.Vk?
ka.LBk:"unknown";Fa.appVersion=da.AFrameworkApplication.buildVersion;Fa.appPlatform=ka.fEl;Fa.lcid=da.AFrameworkApplication.lcid;var Qa=fa.a.ue(da.AFrameworkApplication.lcid);Qa=Qa?Qa.name:null;const Sa=Qa.split("-");Fa.market=Sa[Sa.length-1];Fa.uiLanguage=Qa;Fa.sessionId=da.AFrameworkApplication.userSessionId;Fa.tenantRoot=la.Ha("748");Fa.shredderServiceEndpoint=la.Ha("749");this.Fbf=ya.call(ra,wa,Da,pa,Fa,this.p7j,Object(H.a)(this,this.q4f,"getShredderServiceAuthTokenPromise"))}vzj(wa){this.jyg=
wa;(this.kWa.LMj=wa)?(this.ia.processAction(v.a.avb,2),this.Fbh()):this.ia.La(v.a.Zna,2,new S.a(!0,Y.a.Gbe))}ptk(wa,ra){const ya=[];ya.push(Object.assign(new T,{providerId:D.a.owh,groupTypeId:D.a.nwh,notificationConfidence:0,shouldRaiseNotification:!1,confidence:1,data:ra}));try{this.Bxb.pushProviderResult(Object.assign(new R,{providerId:D.a.owh,resultStatus:wa,entityGroups:ya}))}catch(Da){e.a.J(512262851,811,10,"OnTextToSmartArtSuggestion: Exception occured while posting message to IR, Exception is: {0} ",
Da)}"Success"===wa&&(A.a.Wa(ra.suggestions)||this.bue.dsd(0))}Qtk(wa,ra){const ya=[];ya.push(Object.assign(new T,{providerId:D.a.xwh,groupTypeId:D.a.wwh,notificationConfidence:0,shouldRaiseNotification:!1,confidence:1,data:ra}));try{this.Bxb.pushProviderResult(Object.assign(new R,{providerId:D.a.xwh,resultStatus:wa,entityGroups:ya}))}catch(Da){e.a.J(512262850,811,10,"OnTextToSmartArtSuggestion: Exception occured while posting message to IR, Exception is: {0} ",Da)}}w3g(wa){try{this.Bxb.trackIdeasProviderAction(wa.cardId,
wa.actionType,wa.actionEngagement)}catch(ra){e.a.J(512262849,811,10,"OnIdeasSessionTelemetry: Exception occured while calling TrackIdeasProviderAction in IR, Exception is: {0} ",ra)}}qtk(wa){if(this.G9j)if(wa)if(wa){try{const ra=I.a(wa.Content);this.Vfi(this.nwe,ra)&&(this.nwe=ra,this.Eze=!0)}catch(ra){e.a.J(512262818,811,10,"Deserializing tile response failed");return}this.jyg&&this.Fbh()}else e.a.J(512262819,811,50,"ProcessSlideTextTileChange,TileNull");else e.a.J(512262848,811,50,"ProcessSlideTextTileChange,InputNull")}Vfi(wa,
ra){if(!wa&&ra||wa&&!ra)return!0;if(!wa&&!ra)return!1;if(!wa.drawingElems&&ra.drawingElems||wa.drawingElems&&!ra.drawingElems)return!0;const ya=new u.a;for(const Da of wa.drawingElems)if(wa=Da.text)for(const pa of wa.paragraphs)pa&&(E.a.Wa(pa.id)||E.a.Wa(pa.chars)||ya.$(pa.id,pa.chars));for(const Da of ra.drawingElems)if(ra=Da.text)for(const pa of ra.paragraphs)if(pa&&!(E.a.Wa(pa.id)||E.a.Wa(pa.chars)||ya.Hb(pa.id)&&ya.ga(pa.id)===pa.chars))return!0;return!1}Fbh(){if(this.Eze){try{this.Bxb.postMessage(Object.assign(new na,
{messageType:na.PowerPointTextTileChangedMessageType,data:this.nwe}))}catch(wa){e.a.J(512262817,811,10,"OnSlideTextTileChange: Exception occured while posting message to IR Exception is: {0} ",wa)}this.bue.dsd(1);this.Eze=!1}}GFe(wa,ra){try{wa=[],wa.push(Object.assign(new T,{groupTypeId:D.a.FOf,providerId:D.a.LOf,notificationConfidence:ra.nka?ra.nka.notificationConfidence:0,shouldRaiseNotification:ra.nka?ra.nka.shouldRaiseNotification:!1,confidence:ra.nka?ra.nka.confidence:0,data:ra.q2b})),this.Bxb.pushProviderResult(Object.assign(new R,
{providerId:D.a.LOf,resultStatus:ra.nka?ra.nka.resultStatus:Q.a.invalid,entityGroups:wa}))}catch(ya){e.a.J(512262816,811,10,"OnEditorCritiques: Exception occured while calling PushProviderResult in IR, Exception is: {0} ",ya)}ra.nka&&"Success"===ra.nka.resultStatus&&ra.q2b&&!A.a.Wa(ra.q2b.critiques)&&this.bue.dsd(2)}q4f(){if(!this.soe)return e.a.J(512262815,811,50,"authenticationProvider is null"),null;try{if(this.Seb&&0<this.Seb.length)return this.soe.$0i(new La(this.Seb,"user_impersonation",!0,
{}),this.Ayg);e.a.J(512262814,811,50,"ShredderServiceResourceId is null or empty");return null}catch(wa){return e.a.J(512262813,811,10,"Exception occured while retrieving auth token from wopi identity, Exception is: {0} ",wa),null}}U7i(){return new Promise(wa=>{const ra=this.rEb.Ha("749"),ya=this.q4f();ra&&ra.length&&ya?ya.then(Da=>{Da&&Da.length?(Da=new ha,Da.CountryCode="US",Da.IsEnabled=!1,Da.IsEnterpriseEnabled=!0,Da.IsGoLocal=!1,Da.ServiceEndpoint=ra,Da.TenantRoot="",wa(Da)):wa(null)},()=>{wa(null)}):
wa(null)})}}Object(K.a)(ta,"PPTWebEditorInfraredRuntimeManager",null,[876]);class oa{constructor(){this.K=null}get name(){return"PowerPointWebEditor.Infrared"}$b(wa){this.K=wa;this.K.register(w,"PowerPointWebEditor.Infrared.InfraredDesignerServiceProvider").as("PowerPointWebEditor.IDesignerServiceProvider").ma().oa(()=>new w);this.K.register(z,"PowerPointWebEditor.Infrared.InfraredTelemetryListener").as("PowerPointWebEditor.IInfraredTelemetryListener").ma().oa(()=>new z);this.K.register(C,"PowerPointWebEditor.Infrared.IdeasActionTracker").as("PowerPointWebEditor.Infrared.IIdeasActionTracker").ma().oa(()=>
new C(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Common.IAppSettingsManager")));e.a.J(512262812,809,50,"PPTWebEditorInfraredRuntimePackage - Registering IInfraredRuntimeManager");this.K.register(ta,"PowerPointWebEditor.Infrared.PPTWebEditorInfraredRuntimeManager").as("PowerPointWebEditor.Infrared.IInfraredRuntimeManager").ma().oa(()=>new ta(this.K.resolve("Common.IAppSettingsManager"),this.K.resolve("PowerPointWebEditor.IDesignerServiceProvider"),this.K.resolve("PowerPointWebEditor.IInfraredTelemetryListener"),
this.K.resolve("Common.IActionManager"),this.K.Ja("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),this.K.Ja("PowerPointWebEditor.Editor.Common.Model.IEditorRuntimeEventSource"),this.K.resolve("PowerPointWebEditor.Infrared.IIdeasActionTracker"),this.K.resolve("Common.App.WopiIdentity.WopiIdentityManager"),this.K.resolve("PowerPointWebEditor.Infrared.IIdeasContext")))}init(){const wa=this.K.resolve("Common.IAppSettingsManager");wa.jf(()=>{wa.ka("610")&&(e.a.J(512262811,809,50,"PPTWebEditorInfraredRuntimePackage - Initialize IInfraredRuntimeManager"),
this.K.resolve("PowerPointWebEditor.Infrared.IInfraredRuntimeManager"))})}dispose(){}static main(){k.a.instance.Dc(new oa)}}Object(K.a)(oa,"PPTWebEditorInfraredRuntimePackage",null,[2,3]);Type.registerNamespace("Microsoft.Office.Infrared");Type.registerNamespace("PowerPointWebEditor.Infrared");oa.main()}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/18430998/wdjs/ppteditDS.infrared.js.map