'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[4],{1023:function(K,Z,d){K=d(0);var k;(function(n){n[n.multipleBrowsersImageClassName=0]="multipleBrowsersImageClassName";n[n.peopleImageClassName=1]="peopleImageClassName";n[n.peopleImageClusterPath=4]="peopleImageClusterPath";n[n.multipleBrowserImageClusterPath=5]="multipleBrowserImageClusterPath";n[n.imageDimension=6]="imageDimension";n[n.rtl=8]="rtl";n[n.pointerInputManager=9]="pointerInputManager";n[n.clickInputManager=
10]="clickInputManager";n[n.vertical=11]="vertical";n[n.zIndex=12]="zIndex";n[n.contextMenuInputManager=13]="contextMenuInputManager";n[n.imageDomElement=14]="imageDomElement";n[n.useIdleTooltip=15]="useIdleTooltip";n[n.viewportBoundsCallback=16]="viewportBoundsCallback";n[n.flipHorizontalDirection=17]="flipHorizontalDirection";n[n.fixRemoveFadeOutElementCrash=18]="fixRemoveFadeOutElementCrash";n[n.ignoreEventOnExpandedTooltip=19]="ignoreEventOnExpandedTooltip";n[n.ipWidthAdjustForFlyout=20]="ipWidthAdjustForFlyout"})(k||
(k={}));Object(K.b)("PresenceTooltipSettingKeys",k);d.d(Z,"a",function(){return e});class e{constructor(){this.Hy={}}get(n,r=null){n=k[n];return"number"===typeof r?(r=this.Hy[n])?Number.parseInvariant(r.toString()):0:this.Hy[n]}add(n,r){this.Hy[k[n]]=r}FD(n,r){k[n]in this.Hy||(this.Hy[k[n]]=r)}remove(n){delete this.Hy[k[n]]}}Object(K.a)(e,"PresenceTooltipSettings",null,[])},1024:function(K,Z,d){d.r(Z);K=d(0);var k=d(382),e=d(13),n=d(1047),r=d(347),v=d(17);class C{constructor(z){this.messageId=z;this.v3k=
(new Date).getTime();this.Wle=new v.a}}Object(K.a)(C,"MessageLatencyDetails",null,[]);d.d(Z,"ClientToClientMessageTelemetry",function(){return w});class w{constructor(z,A,u){this.aqa=null;this.AEd=this.fJd=0;this.Jc=A;this.Egf=u;this.QVb=!1;this.rl=z;this.rl.FBa(Object(e.a)(this,this.jMk,"receiveMessage"))}start(){if(this.Egf&&!this.QVb){const z=this.Jc.Klh;this.AEd=this.Jc.Hlh;z<=this.AEd?(k.ULS.sendTraceTag(570975114,500,15,"LogMetrics cannot be started because configuration values are incorrect. RtcSendTelemetryMessageIntervalInMS({0}) should be greater than RtcLogClientMessageMetricsTimeOutInMs({1})",
this.Jc.Klh,this.Jc.Hlh),this.Egf=!1):(this.QVb=!0,this.fJd=window.setInterval(Object(e.a)(this,this.sendMessage,"sendMessage"),z))}}sendMessage(){if(this.QVb){const z=r.a.create().toString();this.aqa=new C(z);this.rl.pNe(16,z,!1,new n.a);window.setTimeout(()=>{this.u1j(z)},this.AEd)}}u1j(z){this.aqa&&this.aqa.messageId===z&&(0<this.aqa.Wle.count?(z=this.aqa.Wle.toArray().join(","),k.ULS.sendTraceTag(571339719,500,15,"ClientMessageLatencies:[{0}]",z)):k.ULS.sendTraceTag(562312150,500,50,"No client message latencies recorded"),
this.aqa=null)}stop(){this.fJd&&(window.clearInterval(this.fJd),this.QVb=!1)}jMk(z,A){16===A.type?this.rl.pNe(17,A.oza,!1,new n.a):17===A.type&&this.QVb&&A.oza&&this.uFk(A.oza)}uFk(z){z&&this.aqa&&z.toString()===this.aqa.messageId&&this.aqa.Wle.add((new Date).getTime()-this.aqa.v3k)}static get instance(){return w.Ka}static bdj(z,A,u){return w.instance||(w.Ka=new w(z,A,u))}}w.Ka=null;Object(K.a)(w,"ClientToClientMessageTelemetry",null,[])},1121:function(K,Z,d){d.r(Z);d.d(Z,"RealtimeChannelMetrics",
function(){return v});K=d(0);var k=d(382),e=d(174),n=d(103),r=d(187);class v{constructor(){this.Ghf=this.Hhf=this.Ihf=this.Ehf=this.Dhf=this.Fhf=this.mUb=this.KFd=0;this.Fxc=this.XDd=this.zTb=this.NDd=this.ODd=this.FDd=this.INa=this.tTb=this.lob=this.EDd=this.Dxc=this.xnb=null;this.FEd=this.WTb=this.Vlf=this.m7e=0;this.Ggf=!1;this.wjd=this.HNe;this.KNe=this.LNe;this.xjd=this.JNe;this.bnc=this.NNe;this.ffh=this.MNe;this.UNe=this.VNe;this.RNe=this.SNe;this.Ohb=this.PNe;this.dnc=this.QNe;this.afh=this.INe;
this.NFb=this.BDe;this.Fic=this.CDe}HNe(){this.KFd++;this.EDd=new Date;this.xnb||(this.xnb=new Date)}LNe(){this.mUb++;this.INa=new Date;this.Dxc||(this.Dxc=this.INa);this.zTb=this.INa;this.Evi()}JNe(){this.Fhf++;this.FDd=new Date}NNe(){this.Dhf++;this.lob=new Date}MNe(){this.Ehf++;this.tTb=new Date}SNe(){this.ODd=new Date;this.Ihf++}QNe(){this.Fxc||(this.Fxc=new Date);this.Hhf++}PNe(){this.NDd=new Date;this.Ghf++}VNe(){if(!this.Ggf&&this.KFd){var C=this.tJc();k.ULS.sendTraceTag(39321871,500,15,n.a.toJSON(C));
this.Ggf=!0}}INe(C){let w,z;({Bbe:C,Cbe:w,Zi:z}=r.RtcUtils.VRf(C));C&&C!==e.a.Ey&&(k.ULS.sendTraceTag(40157596,500,15,n.a.toJSON({["HttpErrorCode"]:C,["HttpErrorStatus"]:w,["Exception"]:z})),e.a.Neg(C)&&this.m7e++,e.a.Tjg(C)&&this.Vlf++)}BDe(){this.XDd=new Date}CDe(){this.lob=this.zTb=new Date}tJc(){return{["numberOfConnectionAttempts"]:this.KFd,["numberOfSuccessfulConnections"]:this.mUb,["numberOfFailedConnections"]:this.Fhf,["numberOfDisconnectedConnections"]:this.Dhf,["numberOfExplicitDisconnectedConnections"]:this.Ehf,
["numberOfSentMessages"]:this.Ihf,["numberOfReceivedMessages"]:this.Hhf,["numberOfLostMessages"]:this.Ghf,["firstConnectionAttempt"]:this.xnb?this.xnb:null,["firstMessageReceived"]:this.Fxc?this.Fxc:null,["firstConnectionSuccess"]:this.Dxc?this.Dxc:null,["lastConnectionAttempt"]:this.EDd?this.EDd:null,["lastConnectionSuccess"]:this.INa?this.INa:null,["lastConnectionFailure"]:this.FDd?this.FDd:null,["lastMessageSent"]:this.ODd?this.ODd:null,["lastMessageLost"]:this.NDd?this.NDd:null,["lastDisconnect"]:this.lob?
this.lob:null,["lastExplicitDisconnect"]:this.tTb?this.tTb:null,["lastTimeOnline"]:this.zTb?this.zTb:null,["lastTimeOffline"]:this.XDd?this.XDd:null,["maxDisconnectedTimeMs"]:this.WTb,["maxExplicitDisconnectedTimeMs"]:this.FEd,["clientConnectionErrors"]:this.m7e,["serverConnectionErrors"]:this.Vlf}}Evi(){this.xnb&&1===this.mUb&&(this.WTb=Math.max(this.WTb,this.INa.getTime()-this.xnb.getTime()));this.lob&&1<this.mUb&&(this.WTb=Math.max(this.WTb,this.INa.getTime()-this.lob.getTime()));this.tTb&&1<this.mUb&&
(this.FEd=Math.max(this.FEd,this.INa.getTime()-this.tTb.getTime()))}static createInstance(C){v.Ka||(v.Ka=new v,k.ULS.sendTraceTag(39321870,500,50,"RealtimeChannelMetrics initialized for client {0}",C));return v.Ka}}v.Ka=null;Object(K.a)(v,"RealtimeChannelMetrics",null,[1423,292])},1122:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k extends Sys.EventArgs{constructor(e,n){super();this.GOb=e;this.SMf=n}}Object(K.a)(k,"PresenceUpdatedEventArgs",Sys.EventArgs,[])},1123:function(K,Z,d){d.d(Z,
"a",function(){return k});K=d(0);var k;(function(e){e[e.unspecified=0]="unspecified";e[e.word=1]="word";e[e.excel=2]="excel";e[e.powerPoint=3]="powerPoint";e[e.test=4]="test";e[e.wacFrontEnd=5]="wacFrontEnd";e[e.oneNote=6]="oneNote";e[e.visio=7]="visio";e[e.officeMobile=8]="officeMobile";e[e.cosmosDBChangefeed=9]="cosmosDBChangefeed";e[e.last=10]="last"})(k||(k={}));Object(K.b)("RtcClientAppName",k)},1127:function(K,Z,d){K=d(0);var k=d(382),e=d(13),n=d(234),r=d(235);class v{static a5d(na,ba,Ea){return v.b5d(na,
ba,Ea,!0)}static b5d(na,ba,Ea,La){const ta=document.createElementNS(v.Jlb,"svg");ta.setAttribute("viewBox",String.format(v.aYd,v.kuc,v.juc));ta.appendChild(v.j9d(na,ba,Ea,La));return ta}static j9d(na,ba,Ea,La){const ta=v.kuc/na,oa=ba/2*ta,wa=v.juc/2;let ra=0;La&&(ra=(na-3*ba-4*Ea)*ta/2);na=document.createElementNS(v.Jlb,"g");Sys.UI.DomElement.addCssClass(na,v.$Xd);for(La=1;3>=La;La++)na.appendChild(v.A4d(La,oa,ra+(La*(ba+Ea)-ba/2)*ta,wa));return na}static A4d(na,ba,Ea,La){const ta=document.createElementNS(v.Jlb,
"circle");Sys.UI.DomElement.addCssClass(ta,String.format("{0}-{1}",v.FTd,na));ta.setAttribute("cx",String.format("{0}",Ea));ta.setAttribute("cy",String.format("{0}",La));ta.setAttribute("r",String.format("{0}",ba));return ta}}v.Jlb="http://www.w3.org/2000/svg";v.$Xd="prDancingDots";v.FTd="prAnimateCircle";v.aYd="0 0 {0} {1}";v.juc=40;v.kuc=120;Object(K.a)(v,"ModernPresenceTooltipDancingDots",null,[]);var C=d(25),w=d(172),z=d(73),A=d(65),u=d(133),E=d(197),H=d(95),I=d(45),J=d(2);class T extends n.a{constructor(na,
ba){super(na);this.ZWb=this.cS=this.Y1a=this.ZM=this.UM=this.Yo=this.Jn=null;this.fI=ba.get(8,!1);this.$R=ba.get(6,0);this.TLd=ba.get(15,!1);this.Jc=ba;this.zRb=0;this.element=na;this.element.className=T.z8a;this.Ts=document.createElement("span");this.element.appendChild(this.Ts);this.hzd=v.a5d(ba.get(6,0),4,2);this.HJ(ba);this._state=5}aW(na){this.addHandler(r.a.lp,na)}Z0(na){this.removeHandler(r.a.lp,na)}get user(){return this.ZWb}get state(){return this._state}dispose(){this.element&&(this.Jn.yb(A.a.click,
this.element,Object(e.a)(this,this.onClick,"onClick")),this.Jn.yb(A.a.doubleClick,this.element,Object(e.a)(this,this.Kx,"stopPropagationAndPreventDefaultBehavior")),this.Yo.yb(A.a.pointerDown,this.element,Object(e.a)(this,this.Uwa,"onPointerDown")),this.Yo.yb(A.a.pointerOut,this.element,Object(e.a)(this,this.pz,"onPointerOut")),this.Yo.yb(A.a.pointerOver,this.element,Object(e.a)(this,this.WC,"onPointerOver")),this.UM.yb(this.element,Object(e.a)(this,this.Kx,"stopPropagationAndPreventDefaultBehavior")));
super.dispose()}HJ(na){this.Jn=na.get(10);this.Jn.pb(A.a.click,this.element,Object(e.a)(this,this.onClick,"onClick"));this.Jn.pb(A.a.doubleClick,this.element,Object(e.a)(this,this.Kx,"stopPropagationAndPreventDefaultBehavior"));this.Yo=na.get(9);this.Yo.pb(A.a.pointerOver,this.element,Object(e.a)(this,this.WC,"onPointerOver"));this.Yo.pb(A.a.pointerOut,this.element,Object(e.a)(this,this.pz,"onPointerOut"));this.Yo.pb(A.a.pointerDown,this.element,Object(e.a)(this,this.Uwa,"onPointerDown"));this.UM=
na.get(13);this.UM.pb(this.element,Object(e.a)(this,this.Kx,"stopPropagationAndPreventDefaultBehavior"))}hide(na=null,ba=0,Ea=0){this.TLd&&na?this.FWe(na,ba,Ea):(3===this.state&&this.Bnc(),this.visible=!1,this._state=5)}FWe(na,ba,Ea=0){this.show(na,ba,15,4,void 0,Ea)}yqc(na,ba,Ea,La=!1,ta=!1,oa=!1,wa=0){this.show(na,ba,Ea+20,La?2:ta?1:0,oa,wa)}vWe(na,ba,Ea,La=!1,ta=0){this.show(na,ba,Ea+20,3,La,ta)}show(na,ba,Ea,La=3,ta=!1,oa=0){!na||La===this.state&&this.Iae(ba,Ea)||(this.WMd(La,ta,oa),this.Rx(na,
La,oa),this._state=La,4===oa||0===oa&&!this.fI?this.element.style.left=ba+"px":this.element.style.right=ba+"px",this.element.style.top=Ea+"px",this.visible=!0)}Rx(na,ba,Ea){this.ZWb=na;H.a.tu(this.Ts);E.a.CDf(this.Ts);this.Ts.id="fly_"+na.clientId;this.Ts.style.backgroundColor=na.color;4!==ba?(this.Ts.style.height=this.$R+"px",this.Ts.style.lineHeight=this.$R+"px",E.a.HY(this.Ts,"border-radius",this.$R+"px")):4===Ea||0===Ea&&!this.fI?this.Ts.style.left="0px":this.Ts.style.right="0px";2!==ba&&(4===
ba?H.a.Ix(this.Ts,""):1===ba?this.Ts.appendChild(this.hzd):(this.Ts.setAttribute("dir","auto"),Ea=I.a.r6d(na.userName,!1),(!na.isAnonymous||C.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IsCustomAnonymousNameEnabled",!1))&&Ea||0!==ba?(na=na.userName,0===ba&&(na=Ea,E.a.HY(this.Ts,"text-align","center")),H.a.Ix(this.Ts,na)):(this.ZM||(this.ZM=this.dWd()),this.Ts.appendChild(this.ZM),E.a.HY(this.Ts,"text-align","start"))))}onClick(na){if(0===this.state)return this.raiseEvent(r.a.lp,
new r.a(1,na)),!0;3===this.state&&k.ULS.sendTraceTag(50436114,302,50,"User clicked on presence pill.");return!1}pz(na){3===this.state&&this.raiseEvent(r.a.lp,new r.a(3,na));return!1}WC(na){3!==na.Yf&&this.raiseEvent(r.a.lp,new r.a(2,na));return!1}Uwa(na){if(3!==na.Yf)return!0;this.raiseEvent(r.a.lp,new r.a(4,na));return!1}dWd(){const na=document.createElement("img");na.src=w.a.RK("doughperson_white_glyph.svg");na.setAttribute("Unselectable","on");u.a.bP(na,u.a.af,u.a.fN);return z.createClusteredImageFromClusterWithImageClass(this.$R,
this.$R,null,null,T.O2d,"",!1,"",this.element.ownerDocument,na)}WMd(na,ba=!1,Ea=0){if(!this.yka(this.state)||!this.yka(na))switch(Sys.UI.DomElement.removeCssClass(this.element,this.Y1a),this.state){case 4:3===na?this.eN(T.A8a,T.O3b):this.yka(na)&&this.eN(T.y8a,T.O3b);break;case 3:4===na?this.eN(T.C8a,T.N3b):this.yka(na)&&(ba&&this.Bnc(),this.eN(T.y8a,T.N3b,ba?T.N2d:""));break;case 0:case 1:case 2:4===na?this.eN(T.C8a,T.B8a):3===na&&(ba&&this.iNd(),this.eN(T.A8a,T.B8a,ba?T.P3b:"",3===Ea?T.Q2d:T.P2d));
break;default:4===na?this.eN(T.C8a):3===na?this.eN(T.A8a):this.yka(na)&&this.eN(T.y8a)}}eN(...na){this.Y1a=na.join(" ");Sys.UI.DomElement.addCssClass(this.element,this.Y1a)}iNd(){this.zRb=window.setTimeout(()=>{this.element&&(this.cS=this.element.cloneNode(!0),this.element.parentNode.appendChild(this.cS),this.element.style.zIndex="2",this.cS.style.zIndex="1")},300)}Bnc(){window.clearTimeout(this.zRb);this.cS&&(Sys.UI.DomElement.removeCssClass(this.cS,T.B8a+" "+T.P3b),Sys.UI.DomElement.addCssClass(this.cS,
T.M2d),J.Task.delay(300).continueWith(()=>{this.element&&this.element.parentNode===this.cS.parentNode&&this.element.parentNode.removeChild(this.cS)}),E.a.xJb(this.element,"z-index"))}yka(na){return 0===na||1===na||2===na}Iae(na,ba){const Ea=E.a.zH(this.element.style.top);return E.a.zH(this.element.style.left)===na&&Ea===ba}uib(na){3===na&&E.a.XP(this.element,"left")?(na=E.a.zH(this.element.style.left),E.a.xJb(this.element,"left"),this.element.style.right=-1*na+"px"):4===na&&E.a.XP(this.element,"right")&&
(na=E.a.zH(this.element.style.right),E.a.xJb(this.element,"right"),this.element.style.left=-1*na+"px")}}T.z8a="prModernFlyout UIFont";T.C8a="flyoutIdle";T.A8a="flyoutExpanded";T.y8a="flyoutCollapsed";T.O3b="flyoutFromIdle";T.N3b="flyoutFromExpanded";T.B8a="flyoutFromCollapsed";T.P3b="flyoutStacked";T.N2d="flyoutFromStacked";T.M2d="flyoutFadeOut";T.O2d="cui-img-cont-float cui-img-20by20";T.P2d="flyoutLtrDir";T.Q2d="flyoutRtlDir";Object(K.a)(T,"ModernPresenceTooltipFlyoutControl",n.a,[]);class D{constructor(na,
ba,Ea=2,La=4){this.offsetTop=na;this.offsetLeft=ba;this.buc=Ea;this.p7b=La}}Object(K.a)(D,"FlyoutsPositioningInfo",null,[]);var R=d(63);class Q{constructor(na=!1,ba=!1){this.Vi=na;this.E2a=ba}z6d(na,ba,Ea,La,ta,oa,wa){const ra=wa.y,ya=wa.height;var Da=this.s4d(oa);const pa=Da+ba;ta=na*Ea+(na-1)*ta;Ea=null;1===na||this.FSd(Da,ta,ra,ya)?na=new D(0,0,2):(na=this.z2d(pa,ta,ra,ya),na.offsetTop-=Da);this.E2a?Ea=new D(0,0,void 0,this.Vi?4:3):(oa=this.r4d(oa,wa),Da=Math.max(0,wa.x),wa=wa.width,ba=oa+ba,this.GSd(oa,
La,Da,wa)?Ea=new D(0,0,void 0,this.Vi?3:4):this.HSd(ba,La,Da)&&(Ea=new D(0,0,void 0,this.Vi?4:3)),Ea||(Ea=this.y2d(oa,ba,Da,wa)));return new D(na.offsetTop,Ea.offsetLeft,na.buc,Ea.p7b)}s4d(na){return R.a.BQc(na)}r4d(na,ba){return this.Vi?ba.width-R.a.OXf(na):R.a.AQc(na)}FSd(na,ba,Ea,La){return na+ba<=Ea+La}z2d(na,ba,Ea,La){let ta=1,oa=Math.max(Ea,na-ba);ba>na-Ea&&(ta=2,oa=ba<La?La-ba:Ea);return new D(oa,0,ta)}GSd(na,ba,Ea,La){return na+ba<=Ea+La}HSd(na,ba,Ea){return ba<=na-Ea}y2d(na,ba,Ea,La){La-
ba>=na-Ea?na=4:(ba=na,na=3);return new D(0,ba,void 0,na)}}Object(K.a)(Q,"ModernPresenceTooltipPositioner",null,[]);class W{constructor(na,ba,Ea,La,ta,oa,wa){this.Sv=na;this._parent=ba;this.iQb=Ea;this.Gxd=La;this.mBd=ta;this.p7=oa;this.fI=wa;this._element=document.createElement("div");this.element.className="prTouchTarget"}get element(){return this._element}update(na,ba){if(3!==na)if(5!==na&&this.Sv&&this.Sv.length){if(4===na){var Ea=this.mBd;var La=(this.p7-Ea)/2;this.element.style.height=this.p7+
"px";this.element.style.width=this.p7+"px";na=E.a.zH(this.Sv[0].element.style.top);ba=E.a.zH(this.fI?this.Sv[0].element.style.right:this.Sv[0].element.style.left)}else Ea=this.iQb,La=(this.p7-Ea)/2,this.element.style.height=this.p7+"px",this.element.style.width=this.H4d()+2*La+"px",na=E.a.zH(this.Sv[this.Sv.length-1].element.style.top),ba=this.uSd(this.Sv[this.Sv.length-1].element,Ea,ba);E.a.HY(this.element,"border-radius",this.p7+"px");this.element.style.top=na-La-Ea+"px";this.fI?this.element.style.right=
ba-La+"px":this.element.style.left=ba-La+"px";this.element.parentNode||this._parent.insertBefore(this.element,this._parent.firstChild)}else this.element.parentNode&&this.element.parentNode.removeChild(this.element)}uSd(na,ba,Ea){return this.fI&&!Ea?E.a.zH(na.style.right):this.fI||Ea?this.fI&&Ea?-E.a.zH(na.style.left)-ba:-E.a.zH(na.style.right)-ba:E.a.zH(na.style.left)}H4d(){return this.Sv&&this.Sv.length?this.iQb+Math.min(this.Sv.length-1,2)*this.Gxd:0}}Object(K.a)(W,"ModernPresenceTooltipTarget",
null,[]);var O=d(70),Y=d(116),S=d(199);class da extends n.a{constructor(na,ba,Ea){super(na);this.j7=this.YH=this.zSb=this.tZ=!1;this.Bf=[];this.jAa={};this.Jc=Ea;this.Vi=Ea.get(8,!1);this.lSb=Ea.get(15,!1);this.qyd=Ea.get(12,0);this.GS=Ea.get(6,0);this.K4a=ba;this.aXb=Ea.get(16);this.E2a=Ea.get(17,!1);this.oBd=Ea.get(19,!1);this.gHd=Ea.get(20,!1);this.pAa=0;this.bHd=new Q(this.Vi,this.E2a);this.Ega=this.G4b();this.c4a=!1;this.QM=[];this.jha=[];this.element.id=da.M8a();this.element.className=n.a.ytb("prControl",
this.Vi);this.defaultZIndex&&(this.zIndex=this.defaultZIndex);this.rtl=this.Vi;this.hjb(ba);this.fF=this.createElement("div");this.fF.className="prFlyoutContainer";this.element.appendChild(this.fF);this.Sv=[];this.hS=new W(this.Xs,this.element,this.GS,4,6,32,this.Vi);this.Yo=Ea.get(9);this.Yo.pb(A.a.pointerDown,this.hS.element,Object(e.a)(this,this.P$,"onHitTarget"));this.Yo.pb(A.a.pointerOver,this.hS.element,Object(e.a)(this,this.P$,"onHitTarget"));this.Yo.pb(A.a.pointerOut,this.hS.element,Object(e.a)(this,
this.P$,"onHitTarget"))}get nhb(){return S.a.clone(this.Bf)}get Xs(){return this.Sv}get defaultZIndex(){return this.qyd}get yN(){return this.Xs?this.Xs.length:0}get lV(){return 0<this.yN?this.Xs[0].state:5}get hab(){return 3===this.lV&&!this.tZ}aW(na){this.addHandler(r.a.lp,na)}Z0(na){this.removeHandler(r.a.lp,na)}dispose(){if(this.hab)this.c4a=!0;else{if(this.Xs)for(const na of this.Xs)na.Z0(Object(e.a)(this,this.aG,"onInteractivityChanged")),Y.a.Fx(na);this.Sv=null;this.Yo.yb(A.a.pointerDown,this.hS.element,
Object(e.a)(this,this.P$,"onHitTarget"));this.Yo.yb(A.a.pointerOver,this.hS.element,Object(e.a)(this,this.P$,"onHitTarget"));this.Yo.yb(A.a.pointerOut,this.hS.element,Object(e.a)(this,this.P$,"onHitTarget"));super.dispose()}}Wfa(){this.VZ();this.visible=!0}Xjb(){this.visible=!0;this.Y2b();this.tZ=!0}xya(){this.Xjb()}hide(){this.Cnc();this.JN();this.hS.update(this.lV,this.j7)}Rx(na){const ba=this.lV,Ea=this.tZ;na.clientId||(na.clientId=(da.pha++).toString());if(na.clientId in this.jAa){var La=this.YS(na.clientId);
if(0<=La){La=this.Bf[La];if(La.color===na.color&&La.userName===na.userName)return;this.JJ(na.clientId)}}this.hide();La=new T(this.createElement("div"),this.Jc);La.aW(Object(e.a)(this,this.aG,"onInteractivityChanged"));this.fF.insertBefore(La.element,this.fF.firstChild);this.jAa[na.clientId]=La;Array.add(this.Bf,na);Array.add(this.Xs,La);this.Jtc(ba,Ea);this.visible=!0}JJ(na){if(this.hab)Array.add(this.jha,na);else{var ba=this.lV,Ea=this.tZ;this.hide();this.Tna(na);this.Jtc(ba,Ea)}}Ufb(na){const ba=
this.YS(na);if(!(0>=ba)){var Ea=this.Bf[ba];na=this.jAa[na];Array.removeAt(this.Bf,ba);Array.insert(this.Bf,0,Ea);Array.removeAt(this.Xs,ba);Array.insert(this.Xs,0,na);this.fF.removeChild(na.element);this.fF.appendChild(na.element);this.VZ()}}Jtc(na,ba){0>=this.Bf.length?this.hide():3===na&&ba?this.Xjb():this.Wfa()}Djb(na,ba){ba?this.PMd(na):this.vnc(na)}S2b(na){if(this.hab&&this.oBd)return!1;na=da.A9a(na);if(this.fF!==na&&H.a.Zta(this.fF,na))return!0;for(const ba of this.Xs)if(H.a.Zta(ba.element,
na))return!0;return!1}position(na,ba){this.element.style.top=ba+"px";this.element.style.left=na+"px"}VZ(na=!1){if(!na||this.YH){this.zSb&&this.wpc(!0);var ba=Math.min(3,this.yN)-1;na=0;var Ea=1,La=0;this.j7&&(na=this.Ega,Ea=-1,La=-this.GS);for(let ta=this.yN-1;ta>ba;ta--)this.Xs[ta].yqc(this.Bf[ta],-4*ba*Ea+La,0,!0,!1,!0,na);for(;0<=ba;ba--)this.Xs[ba].yqc(this.Bf[ba],-4*ba*Ea+La,0,0<ba,Array.contains(this.QM,this.Bf[ba].clientId),ba!==this.pAa,na);this.pAa=0;this.hS.update(0,this.j7);this.zIndex=
this.defaultZIndex;this.tZ=!1;this.Cnc(0);this.c4a&&this.dispose()}}Y2b(){this.zSb&&this.wpc(!1);this.zIndex=this.defaultZIndex+1;let na,ba,Ea;({offsetX:ba,offsetY:na,o7b:Ea}=this.JTe());for(let La=0;La<this.yN;La++)this.Xs[La].vWe(this.Bf[La],ba,na+(this.GS+2)*La,La!==this.pAa,Ea)}JN(){let na=0,ba=0;this.j7&&(na=this.Ega,ba=-6);for(let Ea=0;Ea<this.yN;Ea++)this.Xs[Ea].hide(this.Bf[Ea],ba,na);this.zIndex=this.defaultZIndex;this.visible=this.tZ=!1;this.c4a&&this.dispose()}P6a(na=0){na?(this.YH=!0,
J.Task.delay(na).continueWith(()=>{this.lSb?this.jbe():this.VZ(!0);this.YH=!1})):this.lSb?this.hide():this.VZ()}jbe(){this.YH&&this.hide()}cRd(){if(C.AFrameworkApplication.Aa&&C.AFrameworkApplication.Aa.hb.a9&&O.c()){const na=appChrome.selectors.getShyState();return na.isActive&&0!==na.state}return!1}aG(na,ba){na=this.lV;this.cRd()||2!==ba.type&&(4!==ba.type||3===na)?4===ba.type&&3===na?(this.YH&&(this.YH=!1),this.P6a()):3!==ba.type||3!==na||this.tZ||(1<this.yN?(this.YH=!0,J.Task.delay(250).continueWith(()=>
{this.VZ(!0);this.YH=!1})):this.P6a()):(this.YH&&(this.YH=!1),3!==na&&(this.Y2b(),3===ba.Yi.Yf&&this.P6a(2E3)));this.raiseEvent(r.a.lp,ba)}P$(na){3===na.Yf?this.aG(this,new r.a(4,na)):na.eventName===A.a.pointerOver?this.aG(this,new r.a(2,na)):na.eventName===A.a.pointerOut&&this.aG(this,new r.a(3,na));return!1}hjb(na){this.element.style.width=na+"px";this.element.style.height=this.GS+"px"}Tna(na){this.vnc(na);na=this.YS(na);if(!(0>na)){var ba=this.Bf[na];Array.removeAt(this.Bf,na);delete this.jAa[ba.clientId];
ba=this.Xs[na];this.fF.removeChild(ba.element);this.Jc.get(18,!1)&&ba.Z0(Object(e.a)(this,this.aG,"onInteractivityChanged"));Array.removeAt(this.Xs,na);ba.dispose()}}Cnc(na=5){if(this.jha.length){this.visible&&this.JN();for(let ba=0;ba<this.jha.length;ba++)this.Tna(this.jha[ba]);Array.clear(this.jha);0>=this.Bf.length||5===na?this.hide():0===na&&this.Wfa()}}YS(na){for(let ba=0;ba<this.Bf.length;ba++)if(this.Bf[ba].clientId===na)return ba;return-1}PMd(na){if(-1===this.YS(na))k.ULS.sendTraceTag(41706451,
302,15,"Cannot set active editor because client id is invalid");else{if(Array.contains(this.QM,na)){if(this.Bf[0].clientId===na)return;Array.remove(this.QM,na)}Array.add(this.QM,na);this.Ufb(na);1!==this.lV&&this.VZ()}}vnc(na){-1===this.YS(na)?k.ULS.sendTraceTag(41706452,302,50,"Cannot remove active editor because client id is invalid"):Array.contains(this.QM,na)&&(Array.remove(this.QM,na),this.Bf[0].clientId===na&&0<this.QM.length&&this.Ufb(this.QM[this.QM.length-1]),this.Bf[0].clientId===na&&1===
this.lV&&this.VZ())}wpc(na){na?Sys.UI.DomElement.addCssClass(this.fF,"prBackgroundSelection"):Sys.UI.DomElement.removeCssClass(this.fF,"prBackgroundSelection")}JTe(){let na,ba;ba=na=0;var Ea=this.Ega;if(this.aXb){const La=this.aXb(this);if(!La)return{offsetX:na,offsetY:ba,o7b:Ea};const ta=4===this.lV;Ea=this.bHd.z6d(this.yN,ta?6:this.GS,this.GS,150,2,this.element,La);ba=Ea.offsetTop;this.pAa=this.q6d(Ea.buc,Ea.offsetTop);Ea=Ea.p7b;Ea!==this.Ega&&(this.uib(Ea),this.element.dir=3===Ea?"rtl":"ltr",this.Ega=
Ea);Ea!==this.G4b()?(na=this.gHd?-2:ta?-6:-this.GS,this.j7=!0):this.j7=!1}return{offsetX:na,offsetY:ba,o7b:Ea}}q6d(na,ba){if(1===na)return this.yN-1;na=Math.abs(ba);return 0<na?na/(this.GS+2):0}uib(na){for(let ba=0;ba<this.yN;ba++)this.Xs[ba].uib(na)}G4b(){return this.Vi?3:4}static M8a(){return String.format("{0}-{1}","presencetooltip",da.pha++)}static A9a(na){return na.pc.rawEvent.relatedTarget}}da.pha=0;Object(K.a)(da,"ModernPresenceTooltipControl",n.a,[430,106]);var fa=d(223),ka=d(286),ha=d(265);
d.d(Z,"a",function(){return F});class F{constructor(na){this.Jc=na;this.Jc.FD(10,fa.a.instance);this.Jc.FD(9,ha.a.instance);this.Jc.FD(6,20);this.Jc.FD(13,ka.a.instance);this.Jc.FD(17,!1)}MKc(na,ba){this.Jc.FD(15,!1);return new da(na,ba,this.Jc)}rtb(na){this.Jc.FD(15,!1);return new da(na,20,this.Jc)}}Object(K.a)(F,"ModernPresenceTooltipFactory",null,[429])},1130:function(K,Z,d){K=d(0);var k=d(13),e=d(1186),n=d(234),r=d(235),v=d(65),C=d(95);class w extends n.a{constructor(R,Q){super(R);this.Bf=null;
this.fI=Q.get(8,!1);this.$R=Q.get(6,0);this.element=R;this.element.className=w.z8a;this.h5a=this.createElement("ul");this.element.appendChild(this.h5a);this.Jn=Q.get(10);this.Jn.pb(v.a.click,this.element,Object(k.a)(this,this.onClick,"onClick"));this.Yo=Q.get(9);this.Yo.pb(v.a.pointerOut,this.element,Object(k.a)(this,this.pz,"onPointerOut"));this.Yo.pb(v.a.pointerDown,this.element,Object(k.a)(this,this.Kx,"stopPropagationAndPreventDefaultBehavior"));this.UM=Q.get(13);this.UM.pb(this.element,Object(k.a)(this,
this.Kx,"stopPropagationAndPreventDefaultBehavior"))}aW(R){this.addHandler(r.a.lp,R)}Z0(R){this.removeHandler(r.a.lp,R)}get Maa(){return this.Bf}dispose(){this.element&&(this.Jn.yb(v.a.click,this.element,Object(k.a)(this,this.onClick,"onClick")),this.Yo.yb(v.a.pointerDown,this.element,Object(k.a)(this,this.Kx,"stopPropagationAndPreventDefaultBehavior")),this.Yo.yb(v.a.pointerOut,this.element,Object(k.a)(this,this.pz,"onPointerOut")),this.UM.yb(this.element,Object(k.a)(this,this.Kx,"stopPropagationAndPreventDefaultBehavior")));
super.dispose()}hide(){this.visible=!1}show(R,Q,W){this.hide();!R||0>=R.length||(this.fI?this.element.style.right=Q+"px":this.element.style.left=Q+"px",this.element.style.top=W+"px",this.NNd(R),this.visible=!0)}NNd(R){this.Bf=R;C.a.tu(this.h5a);for(let Q=R.length-1;0<=Q;Q--)this.Rx(R[Q])}Rx(R){const Q=document.createElement("li");Q.style.backgroundColor=R.color;Q.style.height=this.$R+"px";Q.id="fly_"+R.clientId;Q.style.lineHeight=this.$R+"px";C.a.Ix(Q,R.userName);Q.setAttribute("dir","auto");this.h5a.appendChild(Q)}onClick(){this.hide();
return!1}pz(R){this.raiseEvent(r.a.lp,new r.a(3,R));return!1}}w.z8a="prFlyout UIFont";Object(K.a)(w,"PresenceTooltipFlyoutControl",n.a,[]);var z=d(73);class A extends n.a{constructor(R,Q,W){super(R);this.ZM=null;this.Bf=[];this.element.className="prGlyph";this.Jc=Q;this.h7=this.Jc.get(9);this.vn=this.Jc.get(10);this.UM=this.Jc.get(13);this.obe();this.Rx(W);this.i3a=!1}get NO(){return this.Bf.length}get Maa(){return this.Bf}aW(R){this.addHandler(r.a.lp,R)}Z0(R){this.removeHandler(r.a.lp,R)}dispose(){this.b2e();
super.dispose()}Rx(R){Array.add(this.Bf,R);2===this.NO?this.Jaa(!0):1===this.NO?this.Jaa(!1):this.Jaa(this.i3a)}JJ(R){this.a2d(R)&&(1<this.NO&&this.Jaa(!0),1===this.NO?this.Jaa(!1):1>this.NO&&this.hide())}show(){this.Jaa(2<=this.NO);this.visible=!0}hide(){this.visible=!1}m6d(R){return R?this.y4b(0,5):this.y4b(1,4)}a2d(R){for(let Q=0;Q<this.NO;Q++)if(this.Bf[Q].clientId===R)return R=this.Bf[Q],Array.removeAt(this.Bf,Q),R;return null}Jaa(R){this.i3a!==R&&(this.ZM&&this.element.removeChild(this.ZM),
this.ZM=this.m6d(R),this.element.appendChild(this.ZM),this.i3a=R);this.ZM.childNodes[0].style.backgroundColor=this.Bf[this.Bf.length-1].color}y4b(R,Q){const W=this.Jc.get(6,0),O=this.Jc.get(14);return z.createClusteredImageFromClusterWithImageClass(W,W,this.Jc.get(R),this.Jc.get(Q),"cui-img-cont-float cui-img-16by16","",!1,"",this.element.ownerDocument,O?O.cloneNode(!0):null)}WC(R){3!==R.Yf&&this.raiseEvent(r.a.lp,new r.a(2,R));return!1}onClick(R){this.raiseEvent(r.a.lp,new r.a(1,R));return!0}pz(R){3!==
R.Yf&&this.raiseEvent(r.a.lp,new r.a(3,R));return!1}b2e(){this.element&&(this.h7.yb(v.a.pointerDown,this.element,Object(k.a)(this,this.Kx,"stopPropagationAndPreventDefaultBehavior")),this.h7.yb(v.a.pointerOver,this.element,Object(k.a)(this,this.WC,"onPointerOver")),this.h7.yb(v.a.pointerOut,this.element,Object(k.a)(this,this.pz,"onPointerOut")),this.vn.yb(v.a.doubleClick,this.element,Object(k.a)(this,this.Kx,"stopPropagationAndPreventDefaultBehavior")),this.vn.yb(v.a.click,this.element,Object(k.a)(this,
this.onClick,"onClick")),this.UM.yb(this.element,Object(k.a)(this,this.Kx,"stopPropagationAndPreventDefaultBehavior")))}obe(){this.element&&(this.h7.pb(v.a.pointerDown,this.element,Object(k.a)(this,this.Kx,"stopPropagationAndPreventDefaultBehavior")),this.h7.pb(v.a.pointerOver,this.element,Object(k.a)(this,this.WC,"onPointerOver")),this.h7.pb(v.a.pointerOut,this.element,Object(k.a)(this,this.pz,"onPointerOut")),this.vn.pb(v.a.doubleClick,this.element,Object(k.a)(this,this.Kx,"stopPropagationAndPreventDefaultBehavior")),
this.vn.pb(v.a.click,this.element,Object(k.a)(this,this.onClick,"onClick")),this.UM.pb(this.element,Object(k.a)(this,this.Kx,"stopPropagationAndPreventDefaultBehavior")))}}Object(K.a)(A,"PresenceTooltipGlyph",n.a,[]);var u=d(116);d(63);var E=d(199);class H extends n.a{constructor(R,Q,W){super(R);this.Bf=[];this.gm=[];this.cI=0;this.Sha=this.P6=!1;this.rPb=null;this.iha={};this.Jc=W;this.Vi=W.get(8,!1);this.wG=W.get(11,!1);R=W.get(12,0);this.imageDimension=W.get(6,0);this.K4a=Q;this.element.id=H.M8a();
this.element.className=n.a.ytb("prControl",this.Vi);R&&(this.zIndex=R);this.rtl=this.Vi;this.hjb(Q);this.Cz=this.createElement("div");this.Cz.className=this.wG?"prContainerV":"prContainerHr";this.element.appendChild(this.Cz);this.LRb=Array(this.cI);for(Q=0;Q<this.cI;Q++)this.ew[Q]=new w(this.createElement("div"),this.Jc),this.ew[Q].aW(Object(k.a)(this,this.aG,"onInteractivityChanged")),this.element.appendChild(this.ew[Q].element)}get nhb(){return E.a.clone(this.Bf)}getGlyph(R){return this.iha[R]}get ew(){return this.LRb}get vXb(){return this.rPb}get bLa(){return this.imageDimension+
2}get width(){return this.wG?this.bLa:this.K4a}get height(){return this.wG?this.K4a:this.bLa}aW(R){this.addHandler(r.a.lp,R)}Z0(R){this.removeHandler(r.a.lp,R)}dispose(){if(this.ew)for(const R of this.ew)R.Z0(Object(k.a)(this,this.aG,"onInteractivityChanged")),u.a.Fx(R);u.a.Rld(this.gm);this.gm=this.LRb=null;super.dispose()}Wfa(){this.JN();this.Vjb();this.visible=!0;this.P6=!1}Xjb(){!this.gm||1>this.gm.length||(this.JN(),this.visible=!0,this.Vjb(),this.tJa(this.gm[this.gm.length-1]),this.P6=!0)}xya(){if(this.gm&&
!(1>this.gm.length)){this.visible=!0;this.Vjb();var R=0;for(const Q of this.gm)this.tJa(Q,R++);this.P6=!1;this.Sha=!0}}hide(){this.visible=!1;this.JN();for(let R=0;R<this.gm.length;R++)this.gm[R].hide();this.P6=!1}a_b(){if(!this.Sha)return!1;let R=0;for(const Q of this.ew)Q.visible&&R++;return this.Sha=0<R&&(this.Bf.length<=this.cI?R===this.Bf.length:R===this.cI)}Rx(R){if(!(0>=this.cI)){R.clientId||(R.clientId=(H.pha++).toString());if(R.clientId in this.iha){var Q=this.YS(R.clientId);if(0<=Q){Q=this.Bf[Q];
if(Q.color===R.color&&Q.userName===R.userName)return;this.JJ(R.clientId)}}Q=this.a_b();var W=0;if(this.Bf.length<this.cI){var O=new A(this.createElement("div"),this.Jc,R);O.aW(Object(k.a)(this,this.aG,"onInteractivityChanged"));this.Vi&&!this.wG&&0<this.Bf.length?this.Cz.insertBefore(O.element,this.Cz.firstChild):(this.Cz.appendChild(O.element),W=this.gm.length);Array.add(this.gm,O)}else this.Vi&&!this.wG?O=this.gm[0]:(W=this.gm.length-1,O=this.gm[W]),O.Rx(R);O.show();this.iha[R.clientId]=O;Array.add(this.Bf,
R);this.Btc(O,W);Q&&this.xya()}}JJ(R){const Q=this.a_b();Q&&this.JN();this.Tna(R);this.Bf.length>=this.cI&&this.gm.length<this.cI&&this.FNe();0>=this.Bf.length?this.hide():Q&&this.xya()}Ufb(){}Tna(R){var Q=this.YS(R);0>Q||(R=this.Bf[Q],Array.removeAt(this.Bf,Q),Q=this.iha[R.clientId],delete this.iha[R.clientId],Q.JJ(R.clientId),this.Btc(Q),0>=Q.NO&&(this.Cz.removeChild(Q.element),Array.remove(this.gm,Q),Q.dispose()))}Djb(){}FNe(){var R=this.w7d();!R||1>=R.Maa.length||(R=Array.clone(this.Bf),R.forEach(Q=>
{this.Tna(Q.clientId)}),R.forEach(Q=>{this.Rx(Q)}))}YS(R){for(let Q=0;Q<this.Bf.length;Q++)if(this.Bf[Q].clientId===R)return Q;return-1}w7d(){return this.Vi&&!this.wG?this.gm[0]:this.gm[this.gm.length-1]}position(R,Q){this.element.style.top=Q+"px";this.element.style.left=R+"px"}Vjb(){for(let R=0;R<this.gm.length;R++)this.gm[R].show()}JN(){for(let R=0;R<this.cI;R++)this.ew[R].hide();this.Sha=!1}tJa(R,Q=0){if(R)if(this.rPb=R,this.wG){const W=this.imageDimension;if(1<R.Maa.length)this.ew[Q].show(R.Maa,
W,this.height-this.imageDimension);else{const O=this.Cz.children.length;for(let Y=0;Y<this.Cz.children.length;Y++)R.element===this.Cz.children[Y]&&this.ew[Q].show(R.Maa,W,this.height-(O-Y)*this.bLa+2)}}else this.ew[Q].show(R.Maa,this.width,0)}aG(R,Q){var W=Object(e.a)(A,R);W=W?this.o3b(W):-1;if(2===Q.type||1===Q.type&&-1!==W&&!this.ew[W].visible)this.tJa(R);else if(1===Q.type)this.JN(),this.P6=!1;else if(3===Q.type){if(this.S2b(Q.Yi))return;this.P6||this.JN()}this.raiseEvent(r.a.lp,Q)}S2b(R){R=H.A9a(R);
let Q=!1;for(const W of this.ew)if(C.a.Zta(W.element,R)){Q=!0;break}return this.Cz!==R&&C.a.Zta(this.Cz,R)||Q}Btc(R,Q=0){const W=this.Pge(R);W&&0>=R.NO?this.ew[Q].hide():W?this.tJa(R):this.ew[Q].hide()}o3b(R){let Q=0;for(const W of this.gm){if(R===W)return Q;Q++}return-1}Pge(R){const Q=this.o3b(R);return!!this.vXb&&R===this.vXb&&-1!==Q&&this.ew[Q].visible}hjb(R){this.cI=R===this.imageDimension?1:Math.floor(R/this.bLa);this.wG?(this.element.style.height=R+"px",this.element.style.width=this.imageDimension+
"px"):(this.element.style.width=R+"px",this.element.style.height=this.imageDimension+"px")}static M8a(){return String.format("{0}-{1}","presencetooltip",H.pha++)}static A9a(R){R=R.pc.rawEvent;return R.relatedTarget||R.toElement}}H.pha=0;Object(K.a)(H,"PresenceTooltipControl",n.a,[430,106]);var I=d(223),J=d(286),T=d(265);d.d(Z,"a",function(){return D});class D{constructor(R){this.Jc=R;this.Jc.FD(10,I.a.instance);this.Jc.FD(9,T.a.instance);this.Jc.FD(6,16);this.Jc.FD(13,J.a.instance)}MKc(R,Q){return new H(R,
Q,this.Jc)}rtb(R){return new H(R,16,this.Jc)}}Object(K.a)(D,"PresenceTooltipFactory",null,[429])},1230:function(K,Z,d){d.r(Z);var k=d(0),e=d(382),n=d(13),r=d(17),v=d(76),C=d(79),w=d(35),z=d(2);class A{constructor(Ra,sb,ec,Lc,nd,Fd,Ja,db,ic=!1){this.tMa=null;this.Uzd=!0;this.hHd=this.pS=this.vwd=null;this.Oa=new v.a;this.SVh=Ra;this.hlf=sb;this.pjf=ec;this.ojf=Lc;this.j6e=Fd;A.Wd=nd;this.NXh=Ja;this.cOa=db;this.EYh=ic;z.Task.WAA(sb,ec).continueWith(Object(n.a)(this,this.JBj,"initOnTaskReady"))}yeh(){this.Oa.raiseEvent("u",
null,this)}JBj(){this.hlf.result&&this.pjf.result&&(this.pS=this.hlf.result,this.hHd=this.pjf.result,this.pS.UFc(Object(n.a)(this,this.Cjc,"onPresenceUpdated")),this.vwd=new C.a(2,2,this.j6e,Object(n.a)(this,this.mxl,"updateAwayClientsTask"),88),A.Wd.Eb(this.vwd))}Cjc(Ra,sb){(this.Uzd||this.mMk(sb.GOb))&&A.Wd.G5(this.vwd,0)}mMk(Ra){for(let ec in Ra){var sb=this.ojf.Y2f({key:ec,value:Ra[ec]});if(sb&&sb.clientId&&(sb=sb.clientId.toLowerCase(),(sb=this.tMa[sb]||this.tMa[sb.toUpperCase()])&&2===sb.status))return!0}return!1}mxl(Ra){var sb=
this.pS.P1i();if(sb){var ec=new Date,Lc=!1;if(this.Uzd){this.tMa=sb;this.Uzd=!1;var nd=this.tMa;for(var Fd in nd){sb=Fd;var Ja=nd[Fd];Ja.aAb<ec&&(ec=Ja.aAb);2===Ja.status&&(Lc=!0,this.hHd.ckd(sb))}Lc&&this.yeh();A.Wd.G5(Ra,this.S1f(ec))}else{Ja=new r.a;Fd=!1;var db=this.tMa;for(nd in db){db=nd;if(!(db in this.tMa)||this.SVh.clientId===db)continue;var ic=this.tMa[db];const id=sb[db];if(ic&&id){ic=ic.status;const qd=id.status;2===ic&&1===qd?(Ja.add(db),e.ULS.sendTraceTag(38052609,392,50,db+" returned from away")):
1===ic&&2===qd&&(Fd=Lc=!0,this.hHd.ckd(db),e.ULS.sendTraceTag(38052610,392,50,db+" went away"));1===qd&&id.aAb<ec&&(ec=id.aAb)}}this.tMa=sb;A.Wd.G5(Ra,this.S1f(ec));(0<Ja.count||Lc)&&this.yeh();0<Ja.count&&!this.EYh?(Ra=this.d4i(Ja),this.Fql(Ra)):Ra=new r.a;(Fd||0<Ra.count)&&this.NXh(w.a.O6a,2)}}}Fql(Ra){if(Ra.count)for(let sb of Ra)Ra=this.cOa.uCa(String.format(CommonUIStrings.l_EditorsToastArriving,sb),!1),Ra.image=5,Ra.lda="CoAuth_AuthorStatus_16x16x32",this.cOa.Yh(Ra)}d4i(Ra){const sb=this.pS.oQc(),
ec=new r.a;for(let Lc in sb){const nd={key:Lc,value:sb[Lc]};if(Ra.contains(nd.key)){const Fd=this.ojf.Y2f(nd);Fd&&(ec.add(Fd.userName),Ra.remove(nd.key))}}ec.count||e.ULS.sendTraceTag(38052611,392,10,"There were no coauthor names found");return ec}S1f(Ra){return Math.max(Ra.getTime()+this.j6e-(new Date).getTime(),0)}}A.Wd=null;Object(k.a)(A,"AwayManager",null,[]);var u=d(570),E=d(25),H=d(288),I=d(55),J=d(334),T=d(68),D=d(1123),R=d(1047),Q=d(977),W=d(699),O=d(697),Y=d(187),S=d(976),da=d(27),fa=d(545),
ka=d(207),ha=d(26),F=d(773),na=d(45),ba=d(1186),Ea=d(22),La=d(943),ta=d(373),oa=d(38),wa=d(61);class ra{constructor(Ra,sb){this.shapeNode=Ra;this.rxh=sb}}Object(k.a)(ra,"ShapeNodeStartEditingNotificationTracking",null,[]);class ya{constructor(Ra,sb,ec,Lc,nd="",Fd=""){if(!Ra||!sb||0>ec)throw Error.argumentNull("LockEntry");this.rw=Ra;this.mB=sb;this.Mea=ec;this.y9j=Lc;this.oUg=nd;this.fUg=Fd;this.bEg=new Date}get clientId(){return this.rw}get Opd(){return this.mB}get shapeId(){return this.Mea}get lockType(){return this.y9j}get Yzh(){return this.oUg}get Kzh(){return this.fUg}get Akg(){return!na.a.Wa(this.fUg)&&
!na.a.Wa(this.oUg)}get ymg(){return this.bEg}set ymg(Ra){this.bEg=Ra}}Object(k.a)(ya,"LockEntry",null,[]);class Da{constructor(Ra,sb,ec,Lc,nd="",Fd=""){this.clientId=Ra;this.slideId=sb;this.shapeId=ec;this.lockType=Lc;this.rowId=nd;this.cellId=Fd}}Object(k.a)(Da,"SerializableLockData",null,[]);var pa=d(183),la=d(214);class Fa{constructor(Ra,sb,ec,Lc,nd,Fd,Ja,db,ic,id,qd,Fc,Ze,df,ve,md,Kf,oe,Hf,xb,hg,rf){this.Lnj=new u.a("",ResourceStrings.L_GhostUserName,La.a.GKf,new F.a(1));this.WCb={};this.XCb=
{};this.VCb={};this.JDg=da.App.Um;this.gwe=null;this.sze={};this.I1c={};this.L1c={};this.KDg=da.App.Um;this.XTg=!0;this.bGg=this.aFg=0;this.H7c=(new Date(0)).getTime();this.I7c=(new Date(0)).getTime();this.hfc=(new Date(0)).getTime();this.Fxe=(new Date(0)).getTime();this.WTg=!1;this.HVa=Ra;this.qE=sb;this.eDb=ec;this.Yfc=Lc;this.Vb=nd;this.zb=Fd;this.pa=Ja;this.P4j=db;this.hr=ic;this.Ea=id;this.yc=qd;this.rfc=Fc;this.Xpe=Ze.sfg;this.Cs=df;this.bY=ve;this.ua=md;this.wSg=Kf;this.qd=oe;this.qd.P$h(Object(n.a)(this,
this.$sk,"onShapeViewElementRequestUpdateAuthorInfo"));(this.Cv=E.AFrameworkApplication.fa.ka("PPTCanvasPresenceBubbleUXEnabled"))&&this.pa.GG(Object(n.a)(this,this.yH,"onSelectionChanged"));this.Yfc.FBa(Object(n.a)(this,this.Wjc,"onUpdateNotificationReceived"));this.Ddk=Hf;this.Re=xb;this.Kck=hg;this.Ga=Ze;this.xXa=rf;this.PBj()}PBj(){ha.a.J(20821920,828,50,"CoauthStateChangesHandler:InitRttRelatedTasks - IsDedicatedSession: {0}, RttLockSettings: {1}",this.Xpe,this.Cs.u2j());this.Cs.nZd||(0<this.Cs.cib?
this.zb.Eb(new C.a(2,2,this.Cs.cib,Object(n.a)(this,this.removeExpiredLock,"removeExpiredLock"),90,"71")):ha.a.J(20821922,804,10,"RemoveExipredLockIntervalMs is not set correctly while RTT lock is enabled"),0<this.Cs.ZMb?(this.zb.Eb(new C.a(2,2,this.Cs.ZMb/2,Object(n.a)(this,this.switchPendingSveToFidelity,"switchPendingSveToFidelity"),90,"72")),this.XTg=!1):ha.a.J(21565471,804,50,"Switch to fidelity delay after unlock is disabled"),0<this.Cs.L7b?this.zb.Eb(new C.a(2,2,this.Cs.L7b,Object(n.a)(this,
this.updateLockIfImeActive,"updateLockIfImeActive"),90,"73")):ha.a.J(20030493,804,50,"IME typing lock notification disabled"),0<this.Cs.Hfb?this.zb.Eb(new C.a(2,2,this.Cs.Hfb,Object(n.a)(this,this.detectLockLeak,"detectLockLeak"),90,"74")):ha.a.J(21565474,804,50,"Lock leack detection is disabled"),this.P4j.addHandler(ta.a.sFf,(Ra,sb)=>{this.wvi(sb)}),this.Cs.CMc||this.Erc||(this.rfc.DBa(Object(n.a)(this,this.z1g,"onBeforeParagraphNodePropertyChanged")),0<this.Cs.nlb?this.zb.Eb(new C.a(2,2,this.Cs.nlb,
Object(n.a)(this,this.updateLockForActiveShapeNodes,"updateLockForActiveShapeNodes"),90,"75")):ha.a.J(20821953,804,15,"DedicatedWorkerTypingUpdateIntervalMs is not set correctly")),this.Erc&&(this.Kck.DBa(Object(n.a)(this,this.lfd,"onTableCellNodePropertyChanged")),this.rfc.DBa(Object(n.a)(this,this.z1g,"onBeforeParagraphNodePropertyChanged")),this.Ddk.initialize(),0<this.Cs.nlb&&this.zb.Eb(new C.a(2,2,this.Cs.nlb,Object(n.a)(this,this.updateLockForActiveTableCellNodes,"updateLockForActiveTableCellNodes"),
90,"76")),0<this.Cs.cib&&this.zb.Eb(new C.a(2,2,this.Cs.cib,Object(n.a)(this,this.removeExpiredTableCellLock,"removeExpiredTableCellLock"),90,"77"))))}get Erc(){return this.Cs.J_d&&this.Cs.lPf}removeExpiredLock(){var Ra=la.a(this.WCb);for(const sb of Ra){Ra=Object(ba.a)(117,this.WCb[sb]);if(!Ra){delete this.WCb[sb];continue}const ec=Ra.shapeNode;ec&&ec.isConnected?this.bY.b_f(ec)||this.Rhd(sb)||(delete this.WCb[sb],this.bY.I4b(ec)||Ra.Al?ha.a.J(18956362,814,50,"Previous non wet changes lock is expired but the shape contains wet changes now"):
this.PEh(Ra)):delete this.WCb[sb]}}removeExpiredTableCellLock(){var Ra=la.a(this.XCb);for(const sb of Ra){Ra=Object(ba.a)(454,this.XCb[sb]);if(!Ra){delete this.XCb[sb];continue}const ec=Ra.tableCellNode;ec&&ec.isConnected?na.a.Wa(this.bY.v4b(ec))&&!this.Rhd(sb)&&(delete this.XCb[sb],this.QEh(Ra)):delete this.XCb[sb]}}detectLockLeak(){const Ra=[],sb=new Date,ec=this.r6f();for(const Lc of ec)Lc.$p&&+sb-+Lc.Z0c>this.Cs.Hfb&&Ra.push(Lc.shapeNode.Cr);0<Ra.length&&ha.a.J(21565510,828,15,"Following objects are locked longer than {0} : {1}",
this.Cs.Hfb,Ra.join(";"))}switchPendingSveToFidelity(){const Ra=new Date,sb=this.r6f();for(const ec of sb)ec.$p||ec.shapeNode.ud&&this.Erc||!ec.Tn||ec.$x||!(+Ra-+ec.o_j>this.Cs.ZMb)||ec.XA||ec.YMb()}updateLockIfImeActive(){if(this.JDg>=this.KDg&&this.gwe){const Ra=this.aXi(this.gwe);this.kud(Ra)&&this.$oc(Ra.slideId,Ra.get_shapeId(),2)}this.KDg=new Date}updateLockForActiveShapeNodes(){var Ra=la.a(this.I1c);for(const sb of Ra)Ra=Object(ba.a)(4,this.I1c[sb]),this.kud(Ra)&&this.$oc(Ra.slideId,Ra.get_shapeId(),
3);this.I1c={}}updateLockForActiveTableCellNodes(){var Ra=la.a(this.L1c);for(const sb of Ra)if(Ra=Object(ba.a)(123,this.L1c[sb]),this.kud(Ra)){const ec=this.Ea.Zm(Ra);this.$oc(ec.slideId,ec.get_shapeId(),3,Ra.rowId.toString(),Ra.cellId.toString())}this.L1c={}}aXi(Ra){return(Ra=this.hr.zI(Ra))?this.Ea.Zm(Ra.gb):null}z1g(Ra,sb){sb&&sb.node?(Ra=Object(ba.a)(5,sb.node),Ra)?Ra.loading||Ra.Ulc||sb.property.id!==oa.a.pq.id||(sb=this.Ea.Xca(Ra),Ra=this.yc.eEa(Ra),sb&&(Ra?(sb=this.HQc(sb.slideId,sb.get_shapeId(),
Ra.rowId.toString(),Ra.cellId.toString()),this.L1c[sb]=Ra):(Ra=this.Rwb(sb.slideId,sb.get_shapeId()),this.I1c[Ra]=sb))):ha.a.J(20821964,828,10,"Invalid argument."):ha.a.J(20821962,828,10,"Invalid argument.")}c1k(Ra){const sb=new C.a(2,1,this.Cs.bqd,Object(n.a)(this,this.rtcNotifyStartEditing,"rtcNotifyStartEditing"),90,"78");sb.customData=new ra(Ra,!1);this.zb.Eb(sb);this.sze[this.Rwb(Ra.slideId,Ra.get_shapeId())]=sb}rtcNotifyStartEditing(Ra){Ra=Object(ba.a)(ra,Ra.customData);const sb=Ra.shapeNode;
this.kud(sb)&&this.rTj(sb)&&this.$oc(sb.slideId,sb.get_shapeId(),1);Ra.rxh=!0}kud(Ra){return Ra?Ra.isConnected:!1}rTj(Ra){return(Ra=this.al(Ra))?Ra.ZN:!1}al(Ra){return Object(ba.a)(117,Ra.tg(this.Vb.Cn.Ma))}r6f(){const Ra=[];if(!this.ua.Ba)return Ra;var sb=this.ua.Ba.Pk();if(!sb)return Ra;for(const ec of sb)(sb=this.al(ec))&&!sb.Al?Ra.push(sb):ha.a.J(21836046,828,50,"Shape {0} on active slide doesn't have valid view element",ec.Cr);return Ra}Qsk(Ra){this.Mth(Ra)&&(this.HVa.amIAlone||this.c1k(Ra))}yH(Ra,
sb){for(Ra=0;Ra<sb.zE.length;Ra++){const Lc=sb.zE[Ra];var ec=Object(ba.a)(4,Lc.context.node);ec&&ec.isConnected&&(ec=Object(ba.a)(117,ec.sc(this.Re)))&&(ec=this.wSg.EF(ec.shapeNode))&&(1===Lc.xca?ec.pic():0===Lc.xca&&ec.fDe())}}Psk(Ra){if(this.Mth(Ra)&&!this.Cs.AMc){var sb=this.Rwb(Ra.slideId,Ra.get_shapeId()),ec=Object(ba.a)(C.a,this.sze[sb]);if(ec){const Lc=Object(ba.a)(ra,ec.customData);this.zb.Rg(ec);Lc&&Lc.rxh&&this.$oc(Ra.slideId,Ra.get_shapeId(),4);this.sze[sb]=null}}}$sk(Ra,sb){this.P6g(sb.Gw)}P6g(Ra){Ra.kL()||
Ra.shapeNode.$$a?this.w5h(Ra):this.Q6g(Ra)}lfd(Ra,sb){if((sb=Object(ba.a)(pa.TableCellNode,sb.node))&&(Ra=Object(ba.a)(454,sb.tg(this.Re)))&&sb.isConnected){sb=this.bY.v4b(sb);const ec=this.$Le(Ra.tableCellNode);na.a.Wa(sb)?ec?(this.Jme(Ra,this.Rja(ec.clientId,Fa.v_d)),this.S2e(Ra)):na.a.Wa(sb)&&(this.$Le(Ra.tableCellNode)||this.QEh(Ra)):(this.Jme(Ra,this.Rja(sb,Fa.v_d)),this.S2e(Ra))}}Jme(Ra,sb){Ra.lock(sb)}QEh(Ra){Ra.unlock()}$oc(Ra,sb,ec,Lc="",nd=""){try{const Fd=new Da(this.eDb,Ra.quc,sb,ec,Lc,
nd);this.Yfc.Lfa(7,Fd)}catch(Fd){ha.a.J(17602625,814,10,"LockManager.SendLockNotification : MyClientId: {0}; Exception: {1}. ",this.eDb,Fd.stack)}}Wjc(Ra,sb){this.Ga.pptCoauthSurveyFloodgateEnabled&&!this.WTg&&8===sb.type&&this.xXa&&this.uel(sb)&&(ha.a.J(41185738,814,50,"Log coauth activity"),this.WTg=!0,this.xXa.continueWith(()=>{this.xXa.result.logActivity("CoauthContentMerge","PptCoauthSurveyFloodgateEnabled")}));7===sb.type&&((Ra=sb.oza)?Ra.clientId===this.eDb?ha.a.J(19145675,828,15,"Lock notification : lock notification from myself recieved"):
(ha.a.J(17602627,828,50,"Lock notification : LockClientId {0}, MyClientId: {1}.",Ra.clientId,this.eDb),Ra=new ya(Ra.clientId,Ra.slideId,Ra.shapeId,Ra.lockType,Ra.rowId,Ra.cellId),this.K5h(Ra),this.FFk(Ra)):ha.a.J(19145673,828,10,"Lock notification: invalid lock data recieved"))}Q6g(Ra){if(!Ra||Ra.Al)ha.a.J(18994447,828,15,"UpdateAuthorInfoTaskHandler: shapeViewElement is null: {0}.",!Ra);else{var sb=Ra.shapeNode;if(!(sb.Rf||this.Xpe&&sb.ud&&(this.Cs.$tb||this.Erc))){var ec=this.bY.I4b(sb);ec?this.Y0c(Ra,
this.Rja(ec,Fa.v_d)):(sb=this.bY.b_f(sb))?(this.Y0c(Ra,this.Rja(sb,Fa.COi)),this.R2e(Ra)):(sb=this.$Le(Ra.shapeNode))?(this.Y0c(Ra,this.Rja(sb.clientId,this.R6d(sb.lockType))),this.R2e(Ra)):Ra.$p&&this.PEh(Ra)}}}PEh(Ra){const sb=this.wSg.EF(Ra.shapeNode);sb&&(sb.Itd(null),Ra.unlock(this.XTg||!sb.Fae))}Y0c(Ra,sb){Ra.lock(sb);Ra.kL()&&this.pa.Qh()}uel(Ra){if(!Ra||null===Ra.oza)return!1;Ra=this.lyk(Ra.oza);for(const sb of Ra)sb&&sb.clientId&&(sb.clientId.toLowerCase()===this.eDb.toLowerCase()?(this.aFg++,
this.H7c=this.H7c===(new Date(0)).getTime()?(new Date).getTime():this.H7c,this.I7c=(new Date).getTime()):this.xOj(sb.clientId)||(this.bGg++,this.hfc=this.hfc===(new Date(0)).getTime()?(new Date).getTime():this.hfc,this.Fxe=(new Date).getTime()));return 5<=this.aFg&&5<=this.bGg&&(this.Fxe>=this.H7c&&this.hfc<=this.I7c||this.I7c>=this.hfc&&this.I7c<=this.Fxe)&&1<=this.qE.Dwb()?!0:!1}lyk(Ra){let sb=null;try{sb=Ra}catch(ec){}if(null===sb||!sb.length){let ec=null;try{ec=Ra}catch(Lc){ha.a.J(41185744,828,
10,"UpdateHint can't convert to RTC message.")}if(null!==ec)return[ec]}return sb}xOj(Ra){Ra=this.Rja(Ra);const sb=this.Rja(this.eDb);return Ra&&sb&&Ra.userName===sb.userName&&Ra.email===sb.email?!0:!1}R6d(Ra){switch(Ra){case 1:return Fa.Jkl;case 2:return Fa.pAj;case 3:return Fa.tvl;case 4:return Fa.QPi}ha.a.J(20821976,828,10,"Unknown lock type");return"Unknown lock type"}K5h(Ra){if(Ra&&Ra.Opd){var sb=Ra.Akg?this.HQc(new wa.a(Ra.Opd),Ra.shapeId,Ra.Yzh,Ra.Kzh):this.Rwb(new wa.a(Ra.Opd),Ra.shapeId);
if(4===Ra.lockType)this.VCb[sb]=Ra;else{var ec=Object(ba.a)(ya,this.VCb[sb]);ec?(ec=this.Q6d(ec),this.Q6d(Ra)>ec&&(this.VCb[sb]=Ra)):this.VCb[sb]=Ra}}}Q6d(Ra){return this.Raj(Ra.lockType)-(+new Date-+Ra.ymg)}Raj(Ra){switch(Ra){case 1:return this.Cs.aqd;case 2:return this.Cs.UVc;case 3:return this.Cs.Ssd;case 4:return this.Cs.zub}ha.a.J(20821980,828,10,"Unknown lock type");return 0}$Le(Ra){if(Object(Ea.a)(4,Ra)){Ra=Object(ba.a)(4,Ra);if(!Ra.slideId)return null;Ra=this.Rwb(Ra.slideId,Ra.get_shapeId());
return this.Rhd(Ra)}if(Object(Ea.a)(123,Ra)){Ra=Object(ba.a)(123,Ra);let sb=this.Ea.Xca(Ra);if(!sb.slideId)return null;Ra=this.HQc(sb.slideId,sb.get_shapeId(),Ra.rowId.toString(),Ra.cellId.toString());return this.Rhd(Ra)}return null}Rhd(Ra){if(!Ra)return null;const sb=Object(ba.a)(ya,this.VCb[Ra]);return sb?0>=this.Q6d(sb)?this.VCb[Ra]=null:sb:null}R2e(Ra){const sb=this.Ehj(Ra);sb&&(this.WCb[sb]=Ra)}S2e(Ra){const sb=this.dkj(Ra);sb&&(this.XCb[sb]=Ra)}Ehj(Ra){return Ra?this.Rwb(Ra.shapeNode.slideId,
Ra.shapeNode.get_shapeId()):null}dkj(Ra){if(!Ra)return null;Ra=Ra.tableCellNode;const sb=this.Ea.Xca(Ra);return this.HQc(sb.slideId,sb.get_shapeId(),Ra.rowId.toString(),Ra.cellId.toString())}Rwb(Ra,sb){return String.format("{0}#{1}#{2}",Ra.sid,Ra.cid,sb)}HQc(Ra,sb,ec,Lc){return String.format("{0}#{1}#{2}#{3}#{4}",Ra.sid,Ra.cid,sb,ec,Lc)}aOj(Ra){const sb=Object(ba.a)(116,this.ua.Ba);return sb&&wa.a.cwh(Ra.Opd,sb.Cb.quc)?!0:!1}FFk(Ra){if(this.aOj(Ra)){var sb=Ra.shapeId,ec=Ra.clientId;this.ua.Ba&&(sb=
this.ua.Ba.eT(sb))&&(Ra.Akg&&this.Cs.J_d?this.RFk(Ra,ec,sb):this.LFk(Ra,ec,sb))}}LFk(Ra,sb,ec){ec.Rf||this.Xpe&&ec.ud&&(this.Cs.$tb||this.Erc)||!(ec=this.al(ec))||(this.Y0c(ec,this.Rja(sb,this.R6d(Ra.lockType))),this.R2e(ec))}RFk(Ra,sb,ec){if((ec=this.fkj(ec,Ra.Yzh,Ra.Kzh))&&ec.isConnected){var Lc=Object(ba.a)(454,ec.tg(this.Re));Lc&&na.a.Wa(this.bY.v4b(ec))&&(this.Jme(Lc,this.Rja(sb,this.R6d(Ra.lockType))),this.S2e(Lc))}}fkj(Ra,sb,ec){Ra=this.yc.FN(Object(ba.a)(4,Ra));if(!Ra)return null;var Lc=this.yc.Zja(Ra);
Ra=null;for(const nd of Lc){Lc=this.yc.L9a(nd);for(const Fd of Lc)if(Fd.rowId.toString()===sb&&Fd.cellId.toString()===ec){Ra=Fd;break}}return Ra}w5h(Ra){const sb=new C.a(0,1,0,()=>{this.Q6g(Ra)},90,"79");this.zb.Eb(sb)}wvi(Ra){this.JDg=new Date;this.gwe=this.jWi(Ra.Cc)}jWi(Ra){return Ra?Ra.querySelector(".Paragraph"):null}Rja(Ra,sb=""){const ec=this.qE.Rja(Ra);if(ec)return ec;ha.a.J(19140752,828,50,"Failed to find presence user for client id: {0}; DataSource: {1}.",Ra,sb);return this.Lnj}Mth(Ra){return!this.Cs.nZd&&
!(this.Cs.$tb&&Ra.ud)&&!Ra.Rf}}Fa.v_d="EditingBy";Fa.COi="EditingByInSameWorker";Fa.Jkl="StartEditing";Fa.QPi="EndEditing";Fa.pAj="ImeTyping";Fa.tvl="Typing";Object(k.a)(Fa,"CoauthStateChangesHandler",null,[1343]);class Qa{constructor(Ra){this.Dua={};this.rw=Ra.VC;this.init(Ra)}init(Ra){if(Ra=Ra.e_)for(const sb of Ra)sb.ID!==this.rw&&(this.Dua[sb.ID]=new Date)}D4h(Ra){for(let sb=0;sb<Ra.length;sb++)Ra[sb]in this.Dua||Ra[sb]===this.rw||(this.Dua[Ra[sb]]=new Date)}Lll(Ra){const sb=this.Dua[Ra];sb&&
(ha.a.J(37590341,814,50,"EditorPresenceTracker : Presence of coauthoring user never appeared, but leaving coauth; MyClientID: {0}; Coauthor clientID: {1}; TimeElapsed: {2}",this.rw,Ra,(new Date).getTime()-sb.getTime()),delete this.Dua[Ra])}Kll(Ra){const sb=this.Dua[Ra];sb&&(ha.a.J(37590343,814,50,"EditorPresenceTracker : Presence of coauthoring user appeared; MyClientID: {0}; Coauthor clientID: {1}; TimeElapsed: {2}",this.rw,Ra,(new Date).getTime()-sb.getTime()),delete this.Dua[Ra])}Jll(){for(const Ra of Object.keys(this.Dua))ha.a.J(37590345,
814,15,"EditorPresenceTracker : Presence of coauthoring user never appear; MyClientID: {0}; Coauthor clientID: {1}; TimeElapsed: {2}",this.rw,Ra,(new Date).getTime()-this.Dua[Ra].getTime());this.Dua={}}}Object(k.a)(Qa,"EditorPresenceTracker",null,[1342]);class Sa{constructor(Ra){this.Mak=Ra;this.fM=new R.a;this.fM.Fg(this.Mak)}}Object(k.a)(Sa,"PPTRtcProvider",null,[1341]);var Na=d(104),ua=d(1185),za=d(692);class Wa{constructor(Ra,sb,ec,Lc,nd){this.gea=null;this.bU=!1;this.Ape=this.Mwe=null;this.W4j=
Na.a.create();this.W3c=!1;this.v3b=0;this.iU=nd;ec.wg&&(this.findSessionResponse=Ra,Lc.Tsf(Object(n.a)(this,this.X3k,"sessionPropertiesChanged")));this.AGa=new ua.a(()=>sb())}get findSessionResponse(){return this.gea}set findSessionResponse(Ra){if(this.bU)ha.a.J(50943949,814,15,"PptAssignRtcMachineStrategy : FindSessionResponse Not updating cached find session response as it is already set");else if(this.gea=Ra)this.bU=!0,this.Mwe=this.gea.lFf,this.Ape=this.gea.MA}get Lma(){return this.bU?this.Mwe:
this.AGa.value.Lma}set Lma(Ra){this.bU?this.Mwe=Ra:this.AGa.value.Lma=Ra}hUe(Ra){this.AGa.value.hUe(Ra)}get MA(){return this.bU?this.Ape:this.AGa.value.MA}set MA(Ra){this.bU?this.Ape=Ra:this.AGa.value.MA=Ra}GRc(){let Ra;ha.a.J(51140180,814,50,"PptAssignRtcMachineStrategy : OnConnectionStateChanged isFindSessionResponseValid:{0}, havePerformedFindSessionWithLazyStrategy:{1}",this.bU,this.W3c);return this.bU?(Ra=this.gea.correlationId||this.W4j.toString(),ha.a.J(40130654,500,50,"CorrelationId after FindSession: {0}",
Ra),{returnValue:String.format("{0}&{1}={2}",this.gea.B5,E.AFrameworkApplication.RVd,na.a.Ke(Ra)),correlationId:Ra}):this.W3c?this.AGa.value.GRc():(ha.a.J(51140183,814,50,"PptAssignRtcMachineStrategy : GetFindSessionRequestQs returning null QS to avoid crashing"),{returnValue:null,correlationId:null})}n8d(Ra,sb,ec,Lc,nd){ha.a.J(51140185,814,50,"PptAssignRtcMachineStrategy : GetRtcMachine isFindSessionResponseValid:{0}",this.bU);this.bU?(Ra(this.gea.T_b),ec(new za.a(this.gea.Abd,this.gea.xbd,this.gea.wbd,
this.gea.gUc))):(this.AGa.value.n8d(Ra,sb,ec,Lc,nd),this.W3c=!0);this.iU&&this.iU.Yh(26,!this.W3c)}GZd(){ha.a.J(51140187,814,50,"PptAssignRtcMachineStrategy : GetRtcMachine isFindSessionResponseValid:{0}",this.bU);this.bU?this.bU=!1:this.AGa.value.GZd()}dna(Ra,sb){ha.a.J(51140189,814,50,"PptAssignRtcMachineStrategy : GetRtcMachine isFindSessionResponseValid:{0}",this.bU);this.bU||this.AGa.value.dna(Ra,sb)}X3k(){ha.a.J(40464838,814,50,"PptAssignRtcMachineStrategy : SessionPropertiesChanged; FindSessionQs refreshed isFindSessionResponseValid:{0}",
this.bU);this.bU=!1}}Object(k.a)(Wa,"PptAssignRtcMachineStrategy",null,[1340]);var yb=d(1142);class Za{constructor(){this.jo=null}aYb(Ra,sb){this.jo||(this.jo={});this.jo[sb]||(this.jo[sb]=0);this.jo[sb]+=Ra}getData(){return this.jo}reset(){this.jo=null}}Object(k.a)(Za,"MultiSumDataAggregator",null,[1522]);class ub{constructor(Ra,sb){this.Tvd=yb.a.EW(Ra,sb,new Za,!0)}Ef(Ra){this.Tvd.track(1,Ra)}}Object(k.a)(ub,"MultiCounter",null,[1551]);class Ib{constructor(Ra,sb,ec,Lc){this.lz=Ra;this.J4=sb;this.ldk=
ec;this.A7j=Lc;this.lz.FBa(Object(n.a)(this,this.g_k,"rtcOnUpdateNotificationReceived"))}g_k(Ra,sb){0===sb.type&&(this.A7j.Ef("CU"),this.ldk||this.yF())}yF(){!E.AFrameworkApplication.Tg&&this.J4.dX&&this.J4.yF(null,null,null)}}Object(k.a)(Ib,"ContentNotificationManager",null,[]);class Ob extends Ib{constructor(Ra,sb,ec,Lc){super(Ra,sb,ec,Lc)}static init(){if(da.App.Kb){var Ra=da.App.Kb.Jd;if(Ra&&(Ra.Trf(Ob.i1g),Ra=Ra.yi)&&(Ra=Ra.contentReplicator)){var sb=da.App.Ih;if(sb&&sb.lw&&(sb=I.a.instance.resolve("AppRealtimeChannel.IRealtimeChannel"))){var ec=
E.AFrameworkApplication.fa.ka("Box4ThrottleInboundRequests"),Lc=new ub(11,1);Ob.w2c=Ob.w2c||new Ob(sb,Ra,ec,Lc);Ob.w2c.yF()}}}}static i1g(Ra){Ob.w2c||(Ra.yhh(Ob.i1g),Ob.init())}}Ob.w2c=null;Object(k.a)(Ob,"PptContentNotificationManager",Ib,[]);var Hc=d(103),kb=d(342),jb;(function(Ra){Ra[Ra.signalRConnectFailed=0]="signalRConnectFailed";Ra[Ra.findSessionFailed=1]="findSessionFailed"})(jb||(jb={}));Object(k.b)("RtcConnectFailureType",jb);var hb=d(260);class uc{constructor(Ra,sb,ec,Lc,nd,Fd){this.Q7c=
this.oFg=this.Kdb=this.Jdb=0;this.udb=this.$Ga=this.Tla=this.qec=this.m4c=this.b0=null;this.K4c=this.M4c=this.N4c=this.I4c=this.J4c=!1;this.CRg=Ra;this.vj=sb;this.vO=ec;this.vO.HFc(Object(n.a)(this,this.uGb,"onNetworkHealthStateChanged"));this.Vj=Lc;this.oze=Fd;$addHandler(window,"visibilitychange",Object(n.a)(this,this.onVisibilityChange,"onVisibilityChange"));this.qbk=nd;this.qbk.F$h(Object(n.a)(this,this.ksk,"onRtcConnectFailed"))}uGb(Ra,sb){sb.bZc||(this.M4c=this.N4c=!0)}onVisibilityChange(){window.document.hidden&&
(this.I4c=this.J4c=!0)}ksk(Ra,sb){Ra=sb.LUi;if(sb=sb.errorMessage){if(0===Ra){let Lc,nd;({Bbe:ec,Cbe:Lc,Zi:nd}=Y.RtcUtils.VRf(sb.ErrorDetails));sb.HttpErrorCode=ec;sb.HttpErrorStatus=Lc;sb.Exception=nd;delete sb.ErrorDetails;if(!ec&&this.oze&&0<this.oze.length)try{var ec=!0;const Fd=window.location.hostname.toLowerCase();for(const Ja of this.oze.split(";"))if(Fd.endsWith(Ja)){ec=!1;break}sb.IsCORS=ec.toString()}catch(Fd){sb.Unexpected=Fd.message}}ha.a.J(41445510,500,15,"PptRealtimeChannelMetrics:OnRtcConnectFailed; AmIAlone:{0}; IsPageHidden:{1}; IsNetworkHealthy:{2}; rtc connect failed type:{3}; errorMessage:{4}",
this.vj.amIAlone,window.document.hidden,this.Vj.FQ,jb[Ra],Hc.a.toJSON(sb));this.K4c||(this.K4c=this.xSj(Ra,sb))}}xSj(Ra,sb){const ec=hb.c(sb,"HttpErrorCode",-1);return 500<=ec&&599>=ec||1===Ra&&"FindSessionRequestFailed"!==sb.FindSessionFailureReason?!0:!1}e$f(){return this.b0&&1===this.Kdb?this.J4c||this.N4c:this.Tla&&1<this.Kdb?this.I4c||this.M4c:!1}Iwj(){return this.Tla&&0<this.Q7c?this.I4c||this.M4c:this.b0&&0<this.Jdb?this.J4c||this.N4c:!1}wjd(){this.Jdb++;this.qec=new Date;this.b0||(this.b0=
new Date,this.J4c=window.document.hidden,this.N4c=!this.Vj.FQ)}KNe(){this.bfh(0)}bfh(Ra){this.Kdb++;this.$Ga=new Date;this.m4c?this.SJc>this.CRg.Elh&&(Ra={["hasExceededReconnectionThrehold"]:!0,["numberOfSuccessfullConnections"]:this.Kdb,["numberOfConnectionAttempts"]:this.Jdb,["firstConnectionAttempt"]:this.b0?this.b0.toISOString():"",["lastConnectionSuccess"]:this.$Ga?this.$Ga.toISOString():"",["lastUnexpectedDisconnect"]:this.Tla?this.Tla.toISOString():"",["lastExplicitDisconnect"]:this.udb?this.udb.toISOString():
"",["reconnectDurationInMs"]:this.SJc,["hasPageHiddenOrNetworkIssue"]:this.e$f()},ha.a.J(36804373,500,15,Hc.a.toJSON(Ra))):(this.m4c=this.$Ga,kb.a.instance.ic("FirstPresenceUpdated",(new Date).getTime().toString()),this.SJc>this.CRg.Elh&&(Ra={["hasExceededConnectionThrehold"]:!0,["numberOfConnectionAttempts"]:this.Jdb,["firstConnectionAttempt"]:this.b0?this.b0.toISOString():"",["firstConnectionSuccess"]:this.m4c?this.m4c.toISOString():"",["lastExplicitDisconnect"]:this.udb?this.udb.toISOString():
"",["connectDurationInMs"]:this.SJc,["connectionDurationFromStopWatchInMs"]:Ra,["hasPageHiddenOrNetworkIssue"]:this.e$f()},ha.a.J(36804373,500,15,Hc.a.toJSON(Ra))))}xjd(){this.oFg++;const Ra={["numberOfFailedConnections"]:this.oFg,["numberOfConnectionAttempts"]:this.Jdb,["firstConnectionAttempt"]:this.b0?this.b0.toISOString():"",["lastConnectionAttempt"]:this.qec?this.qec.toISOString():"",["lastExplicitDisconnect"]:this.udb?this.udb.toISOString():"",["lastConnectionFail"]:(new Date).toISOString(),
["disconnectedDurationMs"]:this.QLi,["hasPageHiddenOrNetworkIssue"]:this.Iwj()};this.K4c?e.ULS.sendTraceTag(41702299,500,15,Hc.a.toJSON(Ra)):e.ULS.sendTraceTag(36804375,500,15,Hc.a.toJSON(Ra))}bnc(){this.Q7c++;this.Tla=new Date;this.I4c=window.document.hidden;this.M4c=!this.Vj.FQ}TMk(){this.hdl()&&this.xjd();this.udb=new Date;this.rsi()}rsi(){this.Q7c=this.Kdb=this.Jdb=0;this.$Ga=this.Tla=this.qec=this.b0=null;this.K4c=!1}hdl(){return!!this.qec&&!this.$Ga&&!this.Tla}get SJc(){if(this.$Ga){if(this.b0&&
1===this.Kdb)return this.vj.QQc(this.b0,this.$Ga);if(this.Tla&&1<this.Kdb)return this.vj.QQc(this.Tla,this.$Ga)}return 0}get QLi(){return this.Tla&&0<this.Q7c?this.vj.QQc(this.Tla,new Date):this.b0&&0<this.Jdb?this.vj.QQc(this.b0,new Date):0}}Object(k.a)(uc,"PptRealtimeChannelMetrics",null,[1339]);var mc=d(75),Ya=d(31),Mb=d(37);class Kc{constructor(Ra,sb,ec,Lc,nd){this.j$j=Ra.toLowerCase();this.gHa=sb;this.Ll=ec;this.Xt=Lc;this.Lq=nd;this.Xt.mia(Object(n.a)(this,this.Kjc,"onShapeNodeLoaded"));this.Lq.Ysf(Object(n.a)(this,
this.Mjc,"onShapeViewElementUnlocked"))}dispose(){this.Xt.OZa(Object(n.a)(this,this.Kjc,"onShapeNodeLoaded"));this.Lq.sih(Object(n.a)(this,this.Mjc,"onShapeViewElementUnlocked"))}aC(Ra){return this.pyi(Ra)||this.VFf(Ra)}VFf(Ra){if(!Ra||Ra.Rf)return!1;const sb=Ra.sa(Mb.a.u_d,"");return+new Date-+Ra.Z0c<this.gHa&&!!sb&&sb.toLowerCase()!==this.j$j}pyi(Ra){return!!this.I4b(Ra)}b_f(Ra){let sb="";Ra&&this.VFf(Ra)&&(sb=Ra.eb(Mb.a.u_d));return sb}I4b(Ra){return Ra?Ra.sa(Mb.a.zOf,""):""}v4b(Ra){return Ra?
Ra.sa(Mb.a.Uoi,""):""}kAl(Ra){if(Ra&&(Ra.aC=this.aC(Ra),Ra.anchor)){const ec=this.Ll.Xra(Ra);for(;ec.moveNext();){var sb=ec.currentNode;Ya.ParagraphReader.Yd(sb)&&(sb=Object(ba.a)(mc.AParagraphNode,sb))&&(sb.aC=Ra.aC)}}}Mjc(Ra,sb){this.kAl(sb.Gw.shapeNode)}Kjc(Ra,sb){Ra=sb.node;Ra.hzl();Ra.aC=this.aC(Ra)}}Object(k.a)(Kc,"PptWetChangeHandler",null,[1338,106]);class eb{constructor(Ra){this.uak=Ra}m3(){return this.uak.m3()}}Object(k.a)(eb,"PresenceCache",null,[]);var Tb=d(913),lb=d(1122),Fb=d(1210),
rb=d(1006),Qb=d(1198);class Bc extends v.a{constructor(){super();this.L8c=[]}jia(Ra){Ra&&(ha.a.J(8958528,814,50,"PresenceDataManager : AddPresence; clientId: {0}; presence: {1}",Ra.clientId,Ra.presence.toString()),Array.add(this.L8c,Ra))}ckd(Ra){(Ra=this.T9a(Ra))&&this.vJb(Ra);return Ra}vJb(Ra){Ra&&(ha.a.J(8958530,814,50,"PresenceDataManager : RemovePresence; clientId: {0}; presence: {1}",Ra.clientId,Ra.presence.toString()),Array.remove(this.L8c,Ra))}T9a(Ra){for(const sb of this.L8c)if(sb.clientId===
Ra)return sb;return null}m3(){return this.L8c}}Object(k.a)(Bc,"PresenceDataManager",v.a,[]);var wb=d(39),Ad=d(728);class bc{constructor(Ra,sb,ec,Lc,nd,Fd,Ja,db,ic,id,qd){this.clientId=Ra;this.data=Ja;this.chatThreadId=sb;this.chatThreadDiscoveryUri=ec;this.inChat=Lc;this.email=nd;this.capabilities=Fd;this.userName=db;this.clientType=ic;this.fHasClientEverExperiencedNetworkLoss=id;this.isAnonymous=qd}}Object(k.a)(bc,"SerializablePresenceInfo",null,[]);class Sb{constructor(Ra,sb,ec,Lc,nd,Fd,Ja,db,ic,
id,qd){this.Nfc=null;this.rw=Ra.toLowerCase();this.mB=sb;this.vye=ec;this.zrg=Lc;this.yrg=nd;this.tyg=Fd;this.pcc=Ja;this.jrg=db;this.Ima=ic;this.zRg=id;this.kvg=qd}w8d(){return new bc(this.rw,this.zrg,this.yrg,this.tyg,this.pcc,this.jrg.capabilities,this.vye?this.vye.w8d():null,this.Ima,this.zRg,this.kvg,E.AFrameworkApplication.Alb||E.AFrameworkApplication.LQ)}Twj(Ra){if(!(Ra&&this.$j.equals(Ra.slideId)&&this.presence&&this.presence.PU))return!1;for(const sb of this.presence.PU)if(sb===Ra.get_shapeId())return!0;
return!1}get presence(){return this.vye}get clientId(){return this.rw}get chatThreadId(){return this.zrg}get chatThreadDiscoveryUri(){return this.yrg}get inChat(){return this.tyg}get email(){return this.pcc}get capabilities(){return this.jrg}get $j(){return this.mB}get userName(){return this.Ima}get clientType(){return this.zRg}get fHasClientEverExperiencedNetworkLoss(){return this.kvg}get presenceUser(){return this.Nfc}set presenceUser(Ra){this.Nfc&&(Ra?!this.Nfc.client||0===this.Nfc.client||Ra.client&&
0!==Ra.client||ha.a.J(50942305,814,50,"PresenceEntry::SetPresenceUser; Specific to non-specific ClientType {0}.",this.rw):ha.a.J(50942303,814,50,"PresenceEntry::SetPresenceUser; Non-null to null PresenceUser {0}.",this.rw));this.Nfc=Ra}static NKc(Ra){if(!Ra||!Ra.clientId)return ha.a.J(50942301,814,50,"PresenceEntry : CreateFromData; Invalid presence info"),null;const sb=Ad.a.NKc(Ra.data);let ec=0;Ra.clientType&&8>=Ra.clientType&&(ec=Ra.clientType);return new Sb(Ra.clientId,sb.$j,sb,Ra.chatThreadId,
Ra.chatThreadDiscoveryUri,Ra.inChat,Ra.email,new F.a(Ra.capabilities),Ra.userName,ec,Ra.fHasClientEverExperiencedNetworkLoss)}}Object(k.a)(Sb,"PresenceEntry",null,[]);class Zb extends Sys.EventArgs{constructor(Ra,sb,ec,Lc,nd,Fd){super();this.mB=Ra;this.Sdk=ec;this.k$c=sb;this.ESh=Lc;this.ick=nd;this.wak=Fd}get slideId(){return this.mB}get user(){return this.Sdk}get shapes(){return this.k$c}get M8(){return this.ESh}get pwh(){return this.ick}get Zah(){return this.wak}}Object(k.a)(Zb,"SlidePresenceChangedEventArgs",
Sys.EventArgs,[]);var cb=d(28);class Xa extends v.a{constructor(Ra,sb,ec,Lc,nd,Fd,Ja,db,ic,id,qd,Fc,Ze,df,ve,md,Kf,oe,Hf,xb,hg,rf,nf,kd,If,og,pf){super();this.fR=new Bc;this.Qo=null;this.psg=[];this.qsg=null;this.lBb=!0;this.Zcb=!1;this.VDg=new Date;this.HXa=null;this.vvg=this.lvg=this.Exg=!1;this.K8c=null;this.V9=Ra;Ra.userName||(Ra.userName=kd);this.Yb=sb;this.lz=ec;this.rw=Lc.clientId;this.q$=Lc.Iw;this.ze=nd;this.mc=hg;this.Kfc=xb;this.iU=rf;this.vO=If;this.Jla=pf;nf.execute(ig=>{this.Qo=ig});
this.byj();this.vj=Ze;this.Eq=df;this.wCb=ve.fjg;this.hec=ve.GSj;this.Ddc=ve.podsDefaultToRtcForPresenceEnabled;this.n8j=ve.podsNoClientRtcConnectWhenAccessTokenExpiredEnabled;this.rDg=E.AFrameworkApplication.Rz;this.nve=ve.wg&&ve.pptNoRtcConnectWhenReadOnlyEnabled;this.pa=Fd;this.pa.GG(Object(n.a)(this,this.yH,"onSelectionChanged"));this.zs=Ja;this.zs.Dai(Object(n.a)(this,this.ruk,"onValidShapeIdLoaded"));this.qd=db;this.qd.$V(Object(n.a)(this,this.ulk,"onActiveSlideDOMReady"));this.dJ=ic;this.dJ.TNd(Object(n.a)(this,
this.Gdd,"onEditorTableUpdate"));this.Zh=md;this.Zh.GA(Object(n.a)(this,this.vB,"onSessionEnd"));this.Zh.WB(Object(n.a)(this,this.Bo,"onSessionRehydrated"));this.Zh.mPa(Object(n.a)(this,this.Ajc,"onOutboundReplication"));this.g4j=ve.pptAwayStatusTimeGapForPresenceUpdateInMs;this.Cvg=ve.iil;this.ia=qd;this.ua=id;this.M8c=Fc;this.D3c=Kf;this.neb=oe;this.tBb=Hf;ve.wg&&(this.Zh.Ssf(Object(n.a)(this,this.Gjc,"onSessionAccessTokenExpiring")),this.Zh.WFc(Object(n.a)(this,this.pna,"onSessionAccessTokenExpired")),
this.Zh.pOd(Object(n.a)(this,this.Yed,"onSessionExpired")),this.Yb.jf(()=>{this.V9.userName=this.Yb.appSettings.UserName;this.V9.email||(this.V9.email=E.AFrameworkApplication.fa.Ha("UserPrincipalName"));this.mc.rL||(ha.a.J(512360717,814,50,"PresenceManager : Disconnect from RTC"),this.disconnect());this.nve&&this.Zh.z7(Object(n.a)(this,this.Aw,"onUnifiedAppStateChanged"))}),this.rDg&&this.Zh.ZFc(Object(n.a)(this,this.kfa,"onWopiTokenRefreshed")));ha.a.J(512360716,814,50,"PresenceManager - m_isWopiTokenRefreshEnabled:{0}",
this.rDg)}vb(){this.ia.ra(cb.a.AZa,wb.a.application,Object(n.a)(this,this.AZa,"querySlidePresenceUsers"),96)}AZa(Ra,sb,ec,Lc,nd){nd.Rqc=this.I5b(nd.slideId);nd.Yah=this.Dwb();return 32}I5b(Ra){return(Ra=this.D4f(Ra))?Ra.length:0}byj(){this.lz.K5a(Object(n.a)(this,this.Jxi,"connectionStateChanged"));this.lz.UFc(Object(n.a)(this,this.presenceUpdated,"presenceUpdated"));E.AFrameworkApplication.fa.ka("PPTForceUpdateEditorTableEnabled")&&this.lz.FBa(Object(n.a)(this,this.qzl,"updateNotificationReceived"));
O.a.getInstance().p8h(Object(n.a)(this,this.q3g,"onGotCompletePersistentStateWithMetadata"));this.Cvg&&this.vO.HFc(Object(n.a)(this,this.Dqk,"onNetworkHealthChanged"));this.HXa=this.q$.Ci("WebServiceCall","RtcConnection");this.iU.$Qi();this.lz.connect()}Dfh(){const Ra=this.lz.oQc();this.JGh(new lb.a(Ra,null));this.Woc()}Dqk(Ra,sb){sb.bZc||(this.iU.aRi(),this.lvg=!0)}q3g(Ra,sb){this.iU.dRi(sb.bEk);O.a.getInstance().mTk(Object(n.a)(this,this.q3g,"onGotCompletePersistentStateWithMetadata"))}Jxi(Ra,sb){ha.a.J(512360715,
814,50,"PresenceManager : Connection State changed; oldState: {0}; newState: {1}; MyClientId: {2}",Xa.O4d(sb.oldState),Xa.O4d(sb.newState),this.rw);switch(sb.newState){case 2:this.HXa.stop();Ra=this.HXa.Rq;this.iU.ZQi();this.Dfh();this.Kfc.bfh(Ra);break;case 1:2===sb.oldState&&this.Kfc.bnc();this.Kfc.wjd();break;case 0:this.lBb?this.vsi():2===sb.oldState&&(window.setTimeout(()=>{this.lz.connect()},0),ha.a.J(512360714,814,50,"PresenceManager : Reconnect rtc; Session time: {0}",this.ze.y5b().getTime()),
this.Kfc.bnc())}}getSelectedShapes(){if(!this.hec)return null;const Ra=[],sb=this.pa.Xd();for(let ec=0;ec<sb.length;++ec)Array.add(Ra,sb[ec].get_shapeId());0<Ra.length&&Ra.sort();return Ra}vsi(){var Ra=this.fR.m3();if(Ra&&Ra.length){Ra=Array.clone(Ra);for(const sb of Ra)this.vJb(sb);this.raiseEvent("PresenceChanged")}}GSe(Ra,sb){try{this.V9.email||(this.V9.email=E.AFrameworkApplication.fa.Ha("UserPrincipalName"));const ec=new Ad.a(Ra,sb),Lc=new Sb(this.V9.clientId,Ra,ec,this.V9.chatThreadId,this.V9.chatThreadDiscoveryUri,
this.V9.inChat,this.V9.email,this.V9.capabilities,this.V9.userName,1,this.lvg);this.V9.email||ha.a.J(512360713,814,15,"PresenceManager : SendPresence; empty email for user");this.lz.GSe(Lc.w8d()).continueWith(()=>{ha.a.J(8958538,814,50,"PresenceManager : SendPresence; Send presence update; MyClientId: {0}; presence: {1}; session time: {2}",this.rw,ec.toString(),this.ze.y5b().getTime())});this.VDg=new Date;this.iU.E0j();this.QMk(Ra,sb);ha.a.J(8958540,814,50,"PresenceManager : SendPresence; Sending presence update; MyClientId: {0}; presence: {1}; session time: {2}",
this.rw,ec.toString(),this.ze.y5b().getTime());this.qNk(ec)}catch(ec){ha.a.J(512360712,814,10,"PresenceManager : SendPresence; Exception creating presence data {0}; MyClientId: {1};",ec.toString(),this.rw)}}presenceUpdated(Ra,sb){Ra=!!this.Qo&&this.Qo.i_;ha.a.J(8958544,814,50,"PresenceManager : PresenceUpdated; Received presence update; MyClientId: {0}, Rehydrating: {1} ",this.rw,Ra);if(!Ra){this.iU.G0j(sb.GOb);Ra=null;this.q$&&(Ra=this.q$.Ci("ServerNotification","Presence Updated"));try{this.JGh(sb)}finally{Ra&&
Ra.stop()}}}qzl(Ra,sb){ha.a.J(512360711,814,50,"PresenceManager : Update notification received; Type: {0}; MyClientId: {1}",sb.type,this.rw)}JGh(Ra){this.L5h(Ra.GOb);this.MZa(Ra.SMf);ha.a.J(8958546,814,50,"PresenceManager::UpdatePresenceCache; Refresh Peoples Well on presence update");this.raiseEvent("PresenceChanged")}Woc(){this.ua.$j?this.GSe(this.ua.$j,this.getSelectedShapes()):ha.a.J(512360708,814,50,"PresenceManager::SendCurrentSelection: m_graphTopologyManager.CurrentSlideId is null")}yH(){if(this.ua.$j){var Ra=
this.getSelectedShapes();(Xa.Xwj(this.qsg,this.ua.$j)||Xa.Jae(Ra,this.psg))&&this.Woc()}else ha.a.J(512360707,814,50,"PresenceManager::OnSelectionChanged: m_graphTopologyManager.CurrentSlideId is null")}ulk(Ra,sb){sb.Ba?this.ua.$j?this.Woc():ha.a.J(512360705,814,50,"PresenceManager::OnActiveSlideDOMReady: m_graphTopologyManager.CurrentSlideId is null"):ha.a.J(512360706,814,50,"PresenceManager::OnActiveSlideDOMReady: ActiveSlide is null")}ruk(Ra,sb){this.ua.$j?Array.contains(this.getSelectedShapes(),
sb.shapeNode.get_shapeId())&&this.Woc():ha.a.J(512360704,814,50,"PresenceManager::OnValidShapeIdLoaded: m_graphTopologyManager.CurrentSlideId is null")}Bhl(Ra,sb,ec){sb=this.GYf(sb);Ra=this.GYf(Ra);this.ze.e4i().qsc.raiseEvent(Xa.y_d,new Fb.a(this.vj.VC,null,sb,Ra,null,0,0,ec))}GYf(Ra){const sb=new rb.a;for(let ec=0;ec<Ra.length;ec++){const Lc=Ra[ec];if(!Lc)continue;if(Lc.ID===this.vj.VC)continue;if(!Lc.EmailAddress){sb.$(Lc.ID,this.FYf(Lc));continue}const nd=this.fR.T9a(this.vj.VC);nd&&nd.email&&
Lc.EmailAddress&&nd.email.toUpperCase()===Lc.EmailAddress.toUpperCase()||sb.$(Lc.EmailAddress.toUpperCase(),this.FYf(Lc))}return sb.values}FYf(Ra){const sb=new Qb.a;sb.EmailAddress=Ra.EmailAddress;sb.Id=Ra.ID;sb.Name=Ra.Name;return sb}Gdd(Ra,sb){this.Bhl(sb.Rmg,sb.kwf,sb.vLj);if(Ra=this.vj.e_){var ec=sb.Rmg;for(var Lc=0;Lc<ec.length;Lc++)this.D3c.Lll(ec[Lc].ID);ec=[];sb=sb.kwf;for(Lc=0;Lc<sb.length;Lc++){let Fd=sb[Lc];const Ja=Fd.ID;if(Ja!==this.vj.VC){const db=this.fR.T9a(Ja);db?this.tBb.Dyf(db.email,
Fd.EmailAddress):Array.add(ec,Ja)}}this.D3c.D4h(ec);2<=Ra.length&&ha.a.J(512360674,814,50,"PresenceManager : EditorTable has atleast 2 coauthors; MyClientID: {0}; EditorTableCount: {1}",this.rw,Ra.length);ec=[];sb=[];for(var nd of Ra)Array.add(ec,nd.ID),nd.ID===this.vj.VC||this.fR.T9a(nd.ID)||Array.add(sb,nd.ID);ha.a.J(512360673,814,50,"PresenceManager : OnEditorTableUpdate; Received Editor Table update; MyClientID: {0}; editorTableCount: {1}; ClientIDs : {2}; ClientIDs with missing presence: {3}",
this.rw,Ra.length,ec.join(","),sb.join(","));for(const Fd of this.fR.m3())({editor:nd}=this.vj.klb(Fd.clientId)).returnValue?this.exj(nd.ColorIndex)?(this.mNk(Fd),Ra=this.neb.hEa(new Tb.a(nd.EmailAddress,void 0,nd.Name),nd.ColorIndex,nd.ID,0),Fd.presenceUser=new u.a(Fd.clientId,nd.Name,Ra,new F.a(1),null,null,Fd.clientType),this.M8c.kjd(new Zb(Fd.$j,Fd.presence.PU,Fd.presenceUser,!0,this.I5b(Fd.$j),this.Dwb())),ha.a.J(512360671,814,50,"PresenceManager : OnEditorTableUpdate; Adding/Updating presence UI; ClientId: {0};  Presence: {1}; Color: {2}; MyClientId: {3};",
Fd.clientId,Fd.presence.toString(),Fd.presenceUser.color,this.rw)):ha.a.J(512360672,814,50,"PresenceManager : OnEditorTableUpdate; EditorInfo has no color assigned; ClientId: {0};  Presence: {1}; MyClientId: {2};",Fd.clientId,Fd.presence.toString(),this.rw):ha.a.J(512360670,814,50,"PresenceManager : OnEditorTableUpdate; Client not in Editor table; ClientId: {0};  Presence: {1}: Color: {2}; MyClientId: {3};",Fd.clientId,Fd.presence.toString(),Fd.presenceUser?Fd.presenceUser.color:"",this.rw);this.raiseEvent("PresenceChanged")}else ha.a.J(512360675,
814,50,"PresenceManager : OnEditorTableUpdate; Received null on Editor Table update; MyClientID: {0};",this.rw)}vB(Ra,sb){this.D3c.Jll();5!==sb.fG&&(ha.a.J(512360669,814,50,"PresenceManager : OnSessionEnd - Disconnect from RTC"),this.disconnect())}Gjc(){ha.a.J(512360668,814,50,"PresenceManager : OnSessionAccessTokenExpiring");this.Zcb||(ha.a.J(512360667,814,50,"PresenceManager : OnSessionAccessTokenExpiring; Access token expired"),this.Zcb=!0)}pna(){ha.a.J(512360666,814,50,"PresenceManager : OnSessionAccessTokenExpired; Disconnecting from RTC");
this.Zcb||(ha.a.J(512360665,814,50,"PresenceManager : OnSessionAccessTokenExpired; Access token expired"),this.Zcb=!0)}Yed(){ha.a.J(512360664,814,50,"PresenceManager : OnSessionExpired - Disconnect from RTC");this.disconnect()}kfa(Ra,sb){ha.a.J(512360663,814,50,"PresenceManager : OnWopiTokenRefreshed");try{sb.x_c?(ha.a.J(512360662,814,50,"PresenceManager::OnWopiTokenRefreshed Token refresh succeeded. - RTC Connection State: {0}",Xa.O4d(this.lz.connectionState)),this.Zcb=!1,this.nve&&!this.mc.rL?ha.a.J(512360661,
814,15,"PresenceManager : OnWopiTokenRefreshed; Do not connect to RTC in readonly mode"):this.lBb||2!==this.lz.connectionState?this.connect():(Ra={},Ra.qs=this.Jla.presentationId.string,ha.a.J(512360660,814,50,"PresenceManager : OnWopiTokenRefreshed; Calling UpdateClientInfo"),this.lz.rlb(Ra))):ha.a.J(512360659,814,15,"PresenceManager::OnWopiTokenRefreshed Token refresh failed.")}catch(ec){ha.a.J(512360658,814,10,"PresenceManager::OnWopiTokenRefreshed Exception: {0}",ec)}}Bo(Ra,sb){this.n8j&&this.Zcb||
this.nve&&!this.mc.rL?ha.a.J(512360657,814,50,"PresenceManager : OnSessionRehydrated; Do not connect to RTC; IsAccessTokenExpired={0}; IsInEditingModeOrCanEditAnyway={1};",this.Zcb,this.mc.rL):4!==sb.Ixa||this.lBb?this.connect():(ha.a.J(512360656,814,50,"PresenceManager : OnSessionRehydrated - catch up presence"),this.Dfh())}Aw(Ra,sb){sb.Hie&&!this.mc.rL&&(ha.a.J(512360655,814,50,"PresenceManager : OnUnifiedAppStateChanged; Change to readonly, disconnect from RTC"),this.disconnect())}connect(){ha.a.J(512360654,
814,50,"PresenceManager : Connect");this.lBb=!1;this.lz.connect()}Ajc(){this.ydl()&&(ha.a.J(512360653,814,50,"PresenceManager : OnOutboundReplication; Send presence update for editing actions"),this.Woc())}ydl(){const Ra=this.lz.dcj();return Ra?2===Ra.status||+new Date-+this.VDg>this.g4j?!0:!1:!1}OQj(){const Ra=this.fR.m3();if(0<Ra.length)for(const sb of Ra)if(sb.presence&&sb.presence.$j)return!0;return!1}Vcl(){return!this.Exg&&this.Ddc&&2!==this.vj.tca}L5h(Ra){for(let ec in Ra){var sb=Ra[ec];try{const Lc=
Sb.NKc(sb);if(!Lc||Lc.clientId===this.rw)continue;const nd=Lc.clientId;this.Vcl()&&(this.Exg=!0,this.Eq.xtc(2),ha.a.J(512360652,814,50,"PresenceManager : Update coauth status to Coauthoring from RTC"));ha.a.J(39326610,814,50,"PresenceManager : AddOrUpdatePresence; ClientId: {0}; NewPresence: {1};",nd,Lc.presence.toString());const Fd=Lc.email;if(!this.tBb.l5d(Fd)){let Ja;({editor:Ja}=this.vj.klb(nd)).returnValue&&this.tBb.Dyf(Fd,Ja.EmailAddress)}this.N5h(Lc);this.iU.YQi()}catch(Lc){ha.a.J(512360651,
814,10,"PresenceManager : AddOrUpdatePresence; Invalid Presence Data Received {0}; MyClientId: {1};",Lc.toString(),this.rw)}}this.iU.F0j(Ra)}N5h(Ra){this.VPi(Ra);const sb=this.lz.A3(Ra.clientId);sb&&2===sb.status?ha.a.J(39326613,814,50,"PresenceManager : AddOrUpdatePresenceWithAwayStatus; Do not add presence for inactive user; ClientId: {0};",Ra.clientId):this.M5h(Ra)}M5h(Ra){const sb=this.fR.T9a(Ra.clientId);if(sb){if(!this.Nwj(sb,Ra))return;ha.a.J(8958560,814,50,"PresenceManager : AddOrUpdatePresence; Updating existing presence; ClientId: {0};  ExistingPresence: {1}; NewPresence: {2}; MyClientId: {3};",
Ra.clientId,sb.presence.toString(),Ra.presence.toString(),this.rw);this.vJb(sb)}this.c6h(Ra)}vJb(Ra){Ra&&(this.fR.vJb(Ra),Ra.presenceUser&&this.M8c.kjd(new Zb(Ra.$j,Ra.presence.PU,Ra.presenceUser,!1,this.I5b(Ra.$j),this.Dwb())))}rQf(Ra){if(Ra)if(Ra.presenceUser)ha.a.J(512360649,814,100,"PresenceManager:AddOrUpdatePresence; PresenceUser already created for ClientId{0};",Ra.clientId);else{const sb=this.X2f(Ra.clientId);sb?Ra.presenceUser=sb:ha.a.J(512360650,814,50,"PresenceManager:AddOrUpdatePresence; Null presence user for ClientId{0};",
Ra.clientId)}}c6h(Ra){Ra&&(this.fR.jia(Ra),this.D3c.Kll(Ra.clientId),this.rQf(Ra),Ra.presenceUser?this.M8c.kjd(new Zb(Ra.$j,Ra.presence.PU,Ra.presenceUser,!0,this.I5b(Ra.$j),this.Dwb())):ha.a.J(512360648,814,50,"PresenceManager:AddOrUpdatePresence; Null presence user for ClientId{0};",Ra.clientId))}exj(Ra){return!this.wCb||Ra?!0:!1}Nwj(Ra,sb){let ec;(ec=!Ra.$j.equals(sb.$j))&&ha.a.J(512360647,814,50,"Slide Presence Changed - CurrentSlide: {0} ; NewSlide: {1}",Ra.$j,sb.$j);(Ra=this.hec&&Xa.Mal(Ra,
sb))&&ha.a.J(512360646,814,50,"Shape Presence Changed");return ec||Ra}MZa(Ra){if(Ra){for(let sb=0;sb<Ra.length;sb++)Ra[sb]=Ra[sb].toLowerCase();for(const sb of Ra)ha.a.J(512360645,814,50,"PresenceManager : RemovePresence; Removing presence for disconnected clients; ClientId: {0}",sb),(Ra=this.fR.ckd(sb))?Ra.presenceUser?this.M8c.kjd(new Zb(Ra.$j,Ra.presence.PU,Ra.presenceUser,!1,this.I5b(Ra.$j),this.Dwb())):ha.a.J(512360643,814,15,"PresenceManager : RemovePresence; entry.PresenceUser is null"):ha.a.J(512360644,
814,15,"PresenceManager : RemovePresence; entry did not exist")}}D4f(Ra){const sb=[];for(const ec of this.fR.m3())ec.$j.equals(Ra)&&ec.presenceUser&&Array.add(sb,ec.presenceUser);return sb}m4f(Ra){const sb=[];for(const ec of this.fR.m3())ec.presence&&ec.Twj(Ra)&&ec.presenceUser&&Array.add(sb,ec.presenceUser);return sb}g4b(){const Ra=[];for(const sb of this.fR.m3())sb.presenceUser&&Array.add(Ra,sb.presenceUser);return Ra}Dwb(){const Ra=this.g4b();return Ra?Ra.length:0}Rja(Ra){if(!Ra)return null;Ra=
Ra.toLocaleLowerCase();for(const sb of this.fR.m3())if(sb.presenceUser&&sb.presenceUser.clientId===Ra)return sb.presenceUser;return this.X2f(Ra)}ckd(Ra){const sb=this.fR.T9a(Ra);this.vJb(sb);ha.a.J(512360641,814,50,"PresenceManager : RemoveUserPresence; Removing presence; ClientId: {0};  MyClientId: {1};",sb?sb.clientId:Ra+" not found",this.rw)}p$h(Ra){this.addHandler("PresenceChanged",Ra)}m3(){return this.fR.m3()}connectionState(){return this.lz.connectionState}disconnect(){try{ha.a.J(512360640,
814,50,"PresenceManager : Disconnect"),this.lBb||this.Kfc.TMk(),this.lBb=!0,this.lz.disconnect()}catch(Ra){ha.a.J(512360611,814,10,"PresenceManager : Disconnect; Exception disconnecting rtc; Message: {0}; Callstack: {1}",Ra.message,Ra.stack)}}QMk(Ra,sb){this.qsg=Ra;this.psg=sb}X2f(Ra){let sb;const ec=({editor:sb}=this.vj.klb(Ra)).returnValue;var Lc=this.lz.wta(Ra),nd=!!Lc;if(!ec&&!nd)return ha.a.J(512360610,814,50,"PresenceUser:GetPresenceUser; ClientId {0} neither in presence nor rtc.",Ra),null;
Lc=nd?Lc:null;ec||ha.a.J(512360609,814,50,"PresenceUser:GetPresenceUser; ClientId{0} not in EditorTable",Ra);nd||ha.a.J(512360608,814,50,"PresenceUser:GetPresenceUser; ClientId{0} not in Presence",Ra);nd&&ec&&ha.a.J(512360607,814,50,"PresenceUser:GetPresenceUser; ClientId {0} in both. IsSameID={1}, IsSameEmail={2}.",Ra,Lc.clientId!==sb.ID,Lc.email!==sb.EmailAddress);var Fd=ec?new Tb.a(sb.EmailAddress,void 0,sb.Name):new Tb.a(this.tBb.l5d(Lc.email)||Lc.email,void 0,Lc.userName);Fd=this.neb.hEa(Fd,
ec?sb.ColorIndex:null,ec?sb.ID:Lc.clientId,0);nd=nd?Lc.clientType:0;return new u.a(Ra,ec?sb.Name:Lc.userName,Fd,new F.a(1),null,null,nd)}mNk(Ra){this.ua.$j.equals(Ra.$j)&&Ra.presence.PU&&Ra.presence.PU.length&&ha.a.J(512360606,814,50,"PresenceManager : {0}; Begin to add shape presence; ClientId: {1};  Presence data: {2}; MyClientId: {3}; Session time: {4}","OnEditorTableUpdate",Ra.clientId,Ra.presence.toString(),this.rw,this.ze.y5b().getTime());ha.a.J(512360605,814,50,"PresenceManager : {0}; Begin to add slide presence; ClientId: {1};  Presence data: {2}; MyClientId: {3}; Session time: {4}",
"OnEditorTableUpdate",Ra.clientId,Ra.presence.toString(),this.rw,this.ze.y5b().getTime())}qNk(Ra){const sb=[this.vj.userName];let ec=0;for(var Lc of this.fR.m3())Lc.presence.$j.equals(Ra.$j)&&!Xa.Jae(Lc.presence.PU,Ra.PU)&&(ec++,Lc.presenceUser&&Array.add(sb,Lc.presenceUser.userName));if(0<ec){Lc={};let nd=0,Fd=0;for(let Ja=0;Ja<sb.length;++Ja){let db=sb[Ja];db&&db.length||(db="anonymous",Fd++);db in Lc||(Lc[db]=!0,nd++)}ha.a.J(512360604,814,50,"PresenceManager : {0} users, {2} unique users are selecting same {1}. {3} users have no identity",
ec+1,Ra.PU&&0<Ra.PU.length?"shape":"slide",nd,Fd)}}VPi(Ra){try{!this.iU.wUi()||this.fR.T9a(Ra.clientId)||this.Cvg&&Ra.fHasClientEverExperiencedNetworkLoss||(this.rQf(Ra),this.WPi(Ra.presenceUser))}catch(sb){ha.a.J(512360603,814,15,"PresenceManager:EndPresenceBootTelemetry; Exception {0};",sb.toString())}}WPi(Ra){Ra&&Ra.clientId&&(this.vvg||this.K8c||(this.vvg=!0,this.K8c=I.a.instance.resolve("Common.App.CoauthTelemetry.IPresenceBootTelemetry")),this.K8c&&this.K8c.$Pi(Ra.clientId,Xa.mgj(Ra)))}static O4d(Ra){let sb=
"";switch(Ra){case 2:sb="Connected";break;case 1:sb="Connecting";break;case 0:sb="Disconnected"}return sb}static Jae(Ra,sb){if(!Ra&&!sb)return!1;if(!Ra&&sb||Ra&&!sb||Ra.length!==sb.length)return!0;for(let ec=0;ec<Ra.length;ec++)if(Ra[ec]!==sb[ec])return!0;return!1}static Xwj(Ra,sb){return!wa.a.taa(Ra,sb)}static Mal(Ra,sb){return Ra.$j.equals(sb.$j)&&Xa.Jae(Ra.presence.PU,sb.presence.PU)}static mgj(Ra){return Ra&&1===Ra.client?1:0}}Xa.y_d="ETU";Object(k.a)(Xa,"PresenceManager",v.a,[1334,1335,1336,
1337]);var Lb=d(1127),pc=d(1130),fc=d(1023),bd=d(73),od=d(46),ye=d(299);class pd{constructor(Ra,sb,ec,Lc,nd){this.au=null;this.Cv=E.AFrameworkApplication.fa.ka("PPTCanvasPresenceBubbleUXEnabled");sb=this.vej(sb,Lc,nd);this.au=this.Cv?(new Lb.a(sb)).rtb(Ra):(new pc.a(sb)).MKc(Ra,ec)}dispose(){this.au.dispose()}hKe(){return od.a.ii(document.getElementById(ye.a.qZb))}vej(Ra,sb,ec){const Lc=new fc.a;Lc.add(0,bd.getImageClassWithCluster(E.AFrameworkApplication.KN,"MoreUsersGlyph_16x16x32"));Lc.add(5,E.AFrameworkApplication.qm);
Lc.add(1,bd.getImageClassWithCluster(E.AFrameworkApplication.KN,this.Cv?"DoughboyWhiteGlyph_20x20x32":"SingleCollabUserGlyph_16x16x32"));Lc.add(4,E.AFrameworkApplication.qm);Lc.add(6,ec);Lc.add(8,E.AFrameworkApplication.isRtl);Lc.add(12,Ra);Lc.add(11,sb);this.Cv&&(Lc.add(16,Object(n.a)(this,this.hKe,"presenceViewportBoundsCallback")),Lc.add(17,!0));return Lc}Rx(Ra){this.au?(ha.a.J(8958619,814,50,"PresencePawn:AddUser at PresencePawn for ClientId {0}",Ra.clientId),this.au.Rx(Ra)):ha.a.J(8958617,814,
10,"PresencePawn:AddUser - Presence tool tip is null, skipping AddUser for ClientID {0}",Ra.clientId)}JJ(Ra){this.au?(ha.a.J(8958623,814,50,"PresencePawn:RemoveUser at PresencePawn for ClientId {0}",Ra.clientId),this.au.JJ(Ra.clientId)):ha.a.J(8958621,814,15,"PresencePawn:RemoveUser - Presence tool tip is null, skipping RemoveUser for ClientId {0}",Ra.clientId)}clear(){if(this.au)if(ha.a.J(8958627,814,50,"PresencePawn:Clear at PresencePawn "),this.x8())for(const Ra of this.x8())this.JJ(Ra);else ha.a.J(8958657,
814,50,"PresencePawn:Clear - Pawn has no users");else ha.a.J(8958625,814,15,"PresencePawn:Clear - Presence tool tip is null, skipping ClearPresence ")}x8(){return this.au?this.au.nhb:null}UWe(){this.au&&(this.Cv&&this.au.Wfa(),this.au.xya())}bbe(){this.au&&this.au.Wfa()}}Object(k.a)(pd,"PresencePawn",null,[356,106]);class ab{nJf(Ra,sb,ec){return new pd(Ra,2,sb,!0,ec)}}Object(k.a)(ab,"PresencePawnFactory",null,[1322]);var Yb=d(30);class Sc{constructor(Ra,sb,ec,Lc,nd,Fd,Ja,db,ic,id,qd){this.Wxe=[];
this.xXa=null;this.mwg=this.lwg=this.hte=0;this.G4c=this.H4c=null;this.g8c=[];if(!sb)throw Error.argumentNull("graphTopologyManager");if(!ec)throw Error.argumentNull("presenceManager");if(!Lc)throw Error.argumentNull("dragInputManager");if(!nd)throw Error.argumentNull("coauthStateChangesHandler");this.qd=Ra;this.ua=sb;this.qE=ec;this.Vt=Lc;this.mpe=nd;this.ima=Fd;this.Sb=Ja;this.Re=db;this.kfb=ic;this.hma=id;this.aR=qd;this.hma.N5a(Object(n.a)(this,this.Spd,"slidePresenceChanged"));this.qd.$V(Object(n.a)(this,
this.LYa,"onSlideNavigation"));this.qd.vOd(Object(n.a)(this,this.IGb,"onThumbnailRefresh"));this.qd.Iqb(Object(n.a)(this,this.fHe,"onThumbnailVisibleRangeChanged"));this.uzg=E.AFrameworkApplication.fa.ka("PPTCanvasPresenceFloodGateSurveyEnabled");(this.Cv=E.AFrameworkApplication.fa.ka("PPTCanvasPresenceBubbleUXEnabled"))&&this.uzg&&(this.lwg=E.AFrameworkApplication.fa.Fc("PPTCanvasPresenceFloodGateSurveyTimeLapseSec",30),this.mwg=E.AFrameworkApplication.fa.Fc("PPTCanvasPresenceFloodGateSurveyTriggerThreshold",
3),this.hte=0,this.xXa=H.a.Uu(I.a.instance.Ja("Common.ISystemInitiatedFeedbackWithTimeLapse")));this.qd.Gqb(Object(n.a)(this,this.Val,"shapeViewElementAdded"));this.qd.Wsf(Object(n.a)(this,this.Wal,"shapeViewElementLocked"));this.qd.T9h(Object(n.a)(this,this.atk,"onShapeViewElementShowLockHint"));this.qd.U9h(Object(n.a)(this,this.btk,"onShapeViewElementShowPresenceHint"));this.qd.R9h(Object(n.a)(this,this.Vsk,"onShapeViewElementHidePresenceHint"))}LYa(){this.ua.$j&&(ha.a.J(512263071,814,50,"PresencePresenter::OnSlideNavigation; refreshing shape presence for slideId: {0}",
this.ua.$j),this.lOk(this.ua.$j))}lOk(Ra){if(this.ua.$j&&this.ua.$j.equals(Ra)&&(ha.a.J(512263070,814,50,"PresencePresenter::RefreshShapePresenceOnSlide refreshing presence for slideId: {0}",Ra),Ra=new Yb.GraphIterator,Ra.set(this.ua.Ba),Ra.Bb(1))){do if(0<Ra.currentNode.eb(Mb.a.shapeId)){const sb=Object(ba.a)(4,Ra.currentNode);sb&&this.Nfh(sb)}while(Ra.Af(1))}}Spd(Ra,sb){this.Vt.aFa?(ha.a.J(512263069,814,50,"PresencePresenter:SlidePresenceChanged - DragInputManager active."),this.G4c||(this.G4c=
new C.a(2,1,0,()=>{this.handlePendingPresenceChangedEvent(sb)},90,"68"),E.AFrameworkApplication.we.Eb(this.G4c)),sb&&this.g8c.push(sb)):(this.OFk(sb),this.MFk(sb))}handlePendingPresenceChangedEvent(){this.G4c=null;this.jOk();if(this.ua.$j&&0<this.g8c.length){const ec={},Lc={};var Ra=this.ua.$j;for(var sb of this.g8c){if(!Ra.equals(sb.slideId))continue;if(!sb.shapes||!sb.user)continue;sb.user.clientId in Lc||(ec[sb.user.clientId]=sb.user,Lc[sb.user.clientId]=new rb.a(0));const nd=Lc[sb.user.clientId];
for(const Fd of sb.shapes){const Ja=sb.M8?1:0;nd.Hb(Fd)?0<(nd.ga(Fd)^Ja)&&nd.$(Fd,Ja):nd.add(Fd,Ja)}}for(let nd in ec){Ra=ec[nd];sb=nd;if(!(sb in Lc))continue;const Fd=[],Ja=[];Lc[sb].forEach((db,ic)=>{0<ic?Ja.push(db):Fd.push(db);return!0});0<Fd.length&&this.qhh(Fd,Ra);0<Ja.length&&this.wrf(Ja,Ra)}this.g8c=[]}}OFk(Ra){Ra.M8?this.jia(Ra.slideId,Ra.user):this.MZa(Ra.slideId,Ra.user)}IGb(Ra,sb){this.Lfh([sb.jBh])}fHe(Ra,sb){this.Lfh(sb.nga)}Lfh(Ra){const sb=[];for(const ec of Ra)Ra=this.aR?this.Sb.tTc(ec):
this.Sb.Vja(ec),this.aR&&0>=Ra.iV||Ra&&Array.add(sb,Ra);this.Kfh(sb)}jia(Ra,sb){const ec=this.N5f(Ra);ec?(ec.jia(sb),this.Lme(),ha.a.J(512263067,814,50,"ThumbnailNavigationPaneView : Add slide presence succeeded. slideId  = {0}",Ra.toString())):ha.a.J(21770506,814,50,"ThumbnailNavigationPaneView : AddPresence - slideId is invalid {0}",Ra.toString())}MZa(Ra,sb){const ec=this.N5f(Ra);ec?ec.MZa(sb):ha.a.J(512263066,814,50,"ThumbnailNavigationPaneView : RemovePresence - slideId is invalid {0}",Ra.toString())}N5f(Ra){const sb=
this.Sb.Vja(Ra);return sb?Object(ba.a)(681,sb.tg(this.kfb)):(ha.a.J(512263065,814,50,"ThumbnailNavigationPaneView : RemovePresence - slideId is invalid {0}",Ra.toString()),null)}jOk(){const Ra=this.ua.presentation;if(!Ra)throw Error.argumentNull("Presentation is null");this.Kfh(Ra.slides||[])}Kfh(Ra){for(const ec of Ra){var sb=Object(ba.a)(116,ec);sb?(Ra=sb.Cb,(sb=Object(ba.a)(681,sb.tg(this.kfb)))?(ha.a.J(512263062,814,50,"ThumbnailNavigationPaneView : RefreshPresenceForAllThumbnail - updating presence for {0}",
Ra.toString()),sb.d1a(this.qE.D4f(Ra))):ha.a.J(512263063,814,50,"ThumbnailNavigationPaneView : RefreshPresenceForAllThumbnail - thumbnailViewElement is null for slide {0}",Ra.toString())):ha.a.J(512263064,814,10,"ThumbnailNavigationPaneView : RefreshPresenceForThumbnails - could not cast slide to ISlideNode while updating presence for {0}",ec.Cb.toString())}}Lme(){this.Cv&&this.uzg&&(this.Rsl()||this.xXa&&this.xXa.continueWith(()=>{this.xXa.result.logActivity("PresenceBubbleRendered","PPTCanvasPresenceFloodGateSurveyEnabled",
this.lwg)&&this.hte++}))}Rsl(){return this.hte>=this.mwg}MFk(Ra){this.ua.$j&&this.ua.$j.equals(Ra.slideId)&&Ra.shapes&&(Ra.M8?this.wrf(Ra.shapes,Ra.user):this.qhh(Ra.shapes,Ra.user))}Val(Ra,sb){Ra=sb.Gw;this.Yjg(Ra.shapeNode)&&(this.Wxe.push(Ra),this.H4c||(this.H4c=new C.a(2,1,0,Object(n.a)(this,this.handlePendingShapePresenceUpdate,"handlePendingShapePresenceUpdate"),90,"69"),E.AFrameworkApplication.we.Eb(this.H4c)))}handlePendingShapePresenceUpdate(){this.H4c=null;for(const Ra of this.Wxe){if(!this.Yjg(Ra.shapeNode))return;
this.Nfh(Ra.shapeNode)}Array.clear(this.Wxe)}Nfh(Ra){const sb=Object(ba.a)(117,Ra.sc(this.Re));if(sb&&!Ra.get_smartArtModelId()){var ec=this.qE.m4f(Ra);if(ec)if(ec.length){Ra=this.ima.VG(Ra);Ra.wDf();for(const Lc of ec)Ra.jia(Lc),this.Lme()}else(ec=this.ima.EF(Ra))&&ec.wDf();this.mpe.P6g(sb)}}wrf(Ra,sb){var ec=this.p4f();let Lc=!1;for(const nd of ec){if(!Array.contains(Ra,nd.get_shapeId())||nd.get_smartArtModelId())continue;ec=Object(ba.a)(117,nd.sc(this.Re));if(!ec||nd.get_smartArtModelId())continue;
const Fd=this.ima.VG(nd);Fd?(ec.isSelected&&(Fd.Nrb=!1),Fd.jia(sb),this.Lme(),ec.isSelected&&Fd.pic()):Lc=!0}Lc||ha.a.J(512263060,814,50,"PresencePresenter::AddShapePresence succeeded")}qhh(Ra,sb){var ec=this.p4f();for(const Lc of ec)Array.contains(Ra,Lc.get_shapeId())&&(ec=this.ima.VG(Lc))&&ec.MZa(sb)}p4f(){let Ra=null;this.ua.Ba&&(Ra=this.ua.Ba.Pk());return Ra||[]}Yjg(Ra){return!!this.ua.Ba&&this.ua.Ba.Cb.equals(Ra.slideId)}Wal(Ra,sb){this.ima.VG(sb.Gw.shapeNode).Itd(sb.presenceUser)}atk(Ra,sb){(sb.Gw.$p||
sb.Gw.Yod)&&(Ra=this.ima.EF(sb.Gw.shapeNode))&&Ra.uWe()}btk(Ra,sb){(Ra=this.ima.EF(sb.Gw.shapeNode))&&Ra.Vel()}Vsk(Ra,sb){(Ra=this.ima.EF(sb.Gw.shapeNode))&&Ra.q_()}}Object(k.a)(Sc,"PresencePresenter",null,[]);class Jb{constructor(Ra){this.Yfc=Ra}wta(Ra){return this.Yfc.wta(Ra)}A3(Ra){return this.Yfc.A3(Ra)}}Object(k.a)(Jb,"PresenceUserInfoGetter",null,[1324,1220]);class Oc{constructor(Ra=null){this.vj=Ra}Y2f(Ra){if(!Ra||!Ra.value)return null;Ra=Ra.value;let sb=Ra.userName;if(!sb&&this.vj){let ec;
({editor:ec}=this.vj.klb(Ra.clientId)).returnValue&&(sb=ec.Name)}return Object.assign(new u.a,{clientId:Ra.clientId,chatThreadId:Ra.chatThreadId,chatThreadDiscoveryUri:Ra.chatThreadDiscoveryUri,inChat:Ra.inChat,email:Ra.email,capabilities:new F.a(Ra.capabilities),userName:sb})}}Object(k.a)(Oc,"PresenceUtils",null,[1333]);var Wb;(function(Ra){Ra[Ra.coauthHandlerResponse=0]="coauthHandlerResponse";Ra[Ra.popSessionResponse=1]="popSessionResponse";Ra[Ra.defaultFallback=2]="defaultFallback"})(Wb||(Wb=
{}));Object(k.b)("RtcDiscoverType",Wb);class Ab{constructor(Ra,sb,ec,Lc,nd,Fd,Ja,db,ic,id,qd,Fc,Ze,df,ve,md){this.nZd=Ra;this.bqd=sb;this.aqd=ec;this.zub=Lc;this.L7b=nd;this.UVc=Fd;this.nlb=Ja;this.Ssd=db;this.cib=ic;this.CMc=id;this.AMc=qd;this.ZMb=Fc;this.Hfb=Ze;this.$tb=df;this.lPf=ve;this.J_d=md}u2j(){return String.format("[DRL-{0},SEND-{1},SELE-{2},EELE-{3},IUI-{4},IULE-{5},TUI-{6},TULE-{7},RELI-{8},DTL-{9},DEL-{10}, STF-{11}, MLD-{12}, DTL-{13}, ETR-{14}, ETCL-{15}]",this.nZd,this.bqd,this.aqd,
this.zub,this.L7b,this.UVc,this.nlb,this.Ssd,this.cib,this.CMc,this.AMc,this.ZMb,this.Hfb,this.$tb,this.lPf,this.J_d)}}Object(k.a)(Ab,"RttLockSettings",null,[]);var Xb=d(336);class vb{constructor(Ra,sb,ec,Lc){this.yec=this.xec=null;this.jef=!1;this.sck=Ra;this.Ea=sb;this.Hh=ec;this.bY=Lc;this.GEb=new Date;this.gHa=-1}get gb(){return this.sck}get E_c(){return this.jef}set E_c(Ra){this.jef=Ra}STi(){return 0<this.gHa&&Date.now()>=this.gHa}Xph(Ra){this.gHa=Ra}Y5b(){return""}Z5b(){return""}dJb(Ra){this.xec=
Ra?this.Y5b():this.Z5b();this.yec=new Date}zTd(){}BTd(){return!1}Bmh(Ra,sb){Ra=Ra||"";sb=sb||"";if(Ra.length!==sb.length)return null;const ec=[];for(let Lc=0;Lc<Ra.length;Lc+=1)Ra.charAt(Lc)!==sb.charAt(Lc)&&ec.push(Lc);return 0<ec.length?Hc.a.JH("Length",Ra.length,"FirstDiffPos",ec[0],"DiffCount",ec.length):null}FSa(Ra){return na.a.replaceAll(Ra,"\u00a0"," ").trim()}}Object(k.a)(vb,"ATextContentRecord",null,[]);var $c=d(33),fd=d(41);class Bd extends vb{constructor(Ra,sb,ec,Lc){super(Ra,sb,ec,Lc);
this.DWg=Ra.sC}get shapeNode(){return Object(ba.a)(4,this.gb)}O$k(){this.DWg=this.shapeNode.sC}Y5b(){const Ra=new r.a;var sb=this.shapeNode.WD();for(const ec of sb)(sb=this.Hh.text(ec))&&0<sb.length&&Ra.add(sb);return Ra.toArray().join(" ")}Z5b(){return this.Ea.$ca(this.shapeNode)}zTd(){try{const Ra=this.Y5b()||"",sb=this.xec||"";if(Ra!==sb){const ec=this.FSa(Ra)===this.FSa(sb),Lc=this.DWg||this.shapeNode.sC;if(!ec&&!Lc&&!this.shapeNode.ud){const nd=Hc.a.JH("Shape",this.shapeNode.Cr,"Start",fd.a.nf(this.GEb),
"LastSnapshotTime",fd.a.nf(this.yec),"EverEdit",this.E_c,"Type",this.getShapeType());nd.Expiration=-1<this.gHa?(+new Date(this.gHa)-+this.GEb).toString():null;const Fd=Ra.length-sb.length;Fd?nd.TextLengthDelta=Fd:nd.SameLengthDiffDetails=this.Bmh(Ra,sb);ha.a.J(25539747,814,15,$c.c(nd))}}}catch(Ra){ha.a.J(25981901,814,10,"ShapeContentRecord:CheckTextContent failed. {0}",Ra)}}BTd(){try{const Ra=this.bY.I4b(this.shapeNode);if(Ra&&0<Ra.length)return!1;const sb=this.Z5b()||"",ec=this.xec||"";if(sb!==ec&&
0>sb.indexOf(ec)&&!(0<=this.FSa(sb).indexOf(this.FSa(ec))||this.shapeNode.ud)){const Lc=Hc.a.JH("Shape",this.shapeNode.Cr,"Start",fd.a.nf(this.GEb),"LastSnapshotTime",fd.a.nf(this.yec),"TextLengthDelta",sb.length-ec.length,"Type",this.getShapeType());ha.a.J(25981903,814,15,$c.c(Lc))}}catch(Ra){ha.a.J(25981905,814,10,"ShapeContentRecord:CheckWetContentUpdate failed. {0}",Ra)}return!0}getShapeType(){return this.shapeNode.ud?"Table":this.shapeNode.Rf?"SmartArt":this.shapeNode.lx?"TextBox":this.shapeNode.gl?
"PlaceHolder":this.shapeNode.nua?"Shape":"Unknown"}}Object(k.a)(Bd,"ShapeContentRecord",vb,[]);class gd{constructor(Ra,sb,ec,Lc,nd,Fd,Ja,db,ic,id,qd,Fc,Ze){this.efb=this.JEb=null;this.IO={};this.uIa={};this.pa=db;this.dJ=ic;this.Oc=Ra;this.lq=sb;this.$6j=ec;this.Xt=Lc;this.ua=nd;this.Lg=Fd;this.bY=Ja;this.Ea=id;this.yc=qd;this.NAe=Fc;this.Cs=Ze;this.pa.Lsf(Object(n.a)(this,this.urk,"onPreSelectionChanged"));this.pa.GG(Object(n.a)(this,this.FGb,"onSetSelectionFinished"));this.dJ.lai(Object(n.a)(this,
this.Ktk,"onTableCellViewElementLocked"));this.Oc.r8h(Object(n.a)(this,this.Ggi,"beforeProcessInboundResponse"));this.lq.UXb(Object(n.a)(this,this.Ysk,"onShapeViewElementOpenTextEditView"));this.lq.XFc(Object(n.a)(this,this.Ssk,"onShapeViewElementCloseTextEditView"));this.lq.Wsf(Object(n.a)(this,this.Xsk,"onShapeViewElementLocked"));this.$6j.Dsf(Object(n.a)(this,this.Gtk,"onSuccessfulInbound"));this.Xt.ik(Object(n.a)(this,this.hh,"onPropertyChanged"));this.Lg.kI(Object(n.a)(this,this.sB,"onActiveSlideChanged"))}Ysk(Ra,
sb){Ra=Object(ba.a)(4,Object(ba.a)(Xb.a,sb.Gw).gb);sb=this.NAe.jXd(Ra);this.IO[Ra.id.toString()]=sb;sb.dJb(!0)}Ssk(Ra,sb){Ra=Object(ba.a)(4,Object(ba.a)(Xb.a,sb.Gw).gb).id.toString();Ra in this.IO&&this.IO[Ra].Xph(Date.now()+this.Cs.zub)}Xsk(Ra,sb){Ra=Object(ba.a)(4,Object(ba.a)(Xb.a,sb.Gw).gb).id.toString();Ra in this.IO&&delete this.IO[Ra]}urk(){this.JEb=this.KJf}FGb(){this.efb=this.KJf;if(!(!this.JEb&&!this.efb||this.JEb&&this.efb&&this.efb.id.equals(this.JEb.id))){if(this.JEb){var Ra=this.JEb.id.toString();
Ra in this.IO&&this.IO[Ra].Xph(Date.now()+this.Cs.zub)}this.efb&&(Ra=this.NAe.jXd(this.efb),this.IO[this.efb.id.toString()]=Ra,Ra.dJb(!0))}}get KJf(){var Ra=this.pa.Pa;if(!Ra||!Ra.mb||Ra.mb.Gl)return null;Ra=Ra.mb;return Ra.Ua.node&&Ra.Ua.node.isConnected?this.yc.eEa(Ra.Ua.node):null}Ktk(Ra,sb){Ra=sb.tableCellNode.id.toString();Ra in this.IO&&delete this.IO[Ra]}Ggi(){this.Ngh();for(const Ra of Object.keys(this.IO))this.IO[Ra].dJb(!0)}Gtk(){this.Ngh();for(const Ra of Object.keys(this.IO))this.IO[Ra].zTd();
for(const Ra of Object.keys(this.uIa))this.uIa[Ra].BTd()&&delete this.uIa[Ra]}hh(Ra,sb){if(sb&&sb.node&&sb.property.id===oa.a.pq.id){Ra=Object(ba.a)(5,sb.node);sb=!sb.node.loading;const ec=this.yc.eEa(Ra);if(ec)this.YYg(ec,sb),this.ZYg(ec,sb);else if(Ra=this.Ea.Xca(Ra))this.YYg(Ra,sb),this.ZYg(Ra,sb)}}sB(){this.uIa={}}Ngh(){for(const Ra of Object.keys(this.IO))this.IO[Ra].STi()&&delete this.IO[Ra]}YYg(Ra,sb){Ra=Ra.id.toString();if(Ra in this.IO){Ra=this.IO[Ra];const ec=Object(ba.a)(Bd,Ra);ec&&ec.O$k();
Ra.dJb(!0);sb&&(Ra.E_c=!0)}}ZYg(Ra,sb){var ec=this.Ea.Zm(Ra);ec&&this.ua.Ba&&this.ua.Ba.sid===ec.get_sid()&&this.ua.Ba.cid===ec.get_cid()&&(ec=Ra.id.toString(),sb?ec in this.uIa&&delete this.uIa[ec]:(sb=Object(Ea.a)(123,Ra)?this.bY.v4b(Object(ba.a)(123,Ra)):this.bY.I4b(Object(ba.a)(4,Ra)))&&0<sb.length&&(ec in this.uIa?this.uIa[ec].dJb(!1):(Ra=this.NAe.jXd(Ra),this.uIa[ec]=Ra,Ra.dJb(!1))))}}Object(k.a)(gd,"TextContentMonitor",null,[]);class Pd extends vb{constructor(Ra,sb,ec,Lc,nd){super(Ra,sb,Lc,
nd);this.yc=ec}get tableCellNode(){return Object(ba.a)(123,this.gb)}Y5b(){const Ra=new r.a;this.yc.Glc(this.tableCellNode,sb=>{(sb=this.Hh.text(sb))&&0<sb.length&&Ra.add(sb)});return Ra.toArray().join(" ")}Z5b(){const Ra=new r.a;this.yc.Glc(this.tableCellNode,sb=>{sb.Sa(oa.a.pq)&&(sb=sb.eb(oa.a.pq))&&0<sb.length&&Ra.add(sb)});return Ra.toArray().join(" ")}zTd(){try{const Ra=this.Y5b()||"",sb=this.xec||"";if(Ra!==sb&&this.FSa(Ra)!==this.FSa(sb)){const ec=Hc.a.JH("TableCellNode",this.csh+"/"+this.tableCellNode.Cr,
"Start",fd.a.nf(this.GEb),"LastSnapshotTime",fd.a.nf(this.yec),"EverEdit",this.E_c);ec.Expiration=-1<this.gHa?(+new Date(this.gHa)-+this.GEb).toString():null;const Lc=Ra.length-sb.length;Lc?ec.TextLengthDelta=Lc:ec.SameLengthDiffDetails=this.Bmh(Ra,sb);ha.a.J(37748808,814,15,$c.c(ec))}}catch(Ra){ha.a.J(37748810,814,10,"ShapeContentRecord:CheckTextContent failed. {0}",Ra)}}BTd(){try{const Ra=this.bY.v4b(this.tableCellNode);if(Ra&&0<Ra.length)return!1;const sb=this.Z5b()||"",ec=this.xec||"";if(sb!==
ec&&0>sb.indexOf(ec)&&!(0<=this.FSa(sb).indexOf(this.FSa(ec)))){const Lc=Hc.a.JH("TableCellNode",this.csh+"/"+this.tableCellNode.Cr,"Start",fd.a.nf(this.GEb),"LastSnapshotTime",fd.a.nf(this.yec),"TextLengthDelta",sb.length-ec.length);ha.a.J(37748812,814,15,$c.c(Lc))}}catch(Ra){ha.a.J(37748814,814,10,"ShapeContentRecord:CheckWetContentUpdate failed. {0}",Ra)}return!0}get csh(){const Ra=this.Ea.Zm(this.tableCellNode);return Ra?Ra.Cr:"UnknownShape"}}Object(k.a)(Pd,"TableCellContentRecord",vb,[]);class cd{constructor(Ra,
sb,ec,Lc){this.Ea=Ra;this.yc=sb;this.Hh=ec;this.bY=Lc}jXd(Ra){return Object(Ea.a)(4,Ra)?new Bd(Object(ba.a)(4,Ra),this.Ea,this.Hh,this.bY):Object(Ea.a)(123,Ra)?new Pd(Object(ba.a)(123,Ra),this.Ea,this.yc,this.Hh,this.bY):null}}Object(k.a)(cd,"TextContentRecordFactory",null,[1323]);var lf=d(623);class Jd{constructor(Ra,sb,ec,Lc,nd){this.Fb=Ra;this.ima=sb;this.pa=ec;this.dJ=Lc;this.oy=nd;this.B3c=!1}initialize(){this.pa.GG(Object(n.a)(this,this.FGb,"onSetSelectionFinished"));this.dJ.tai(Object(n.a)(this,
this.M6g,"onTypingLockStatusChanged"))}dispose(){this.pa.hih(Object(n.a)(this,this.FGb,"onSetSelectionFinished"));this.dJ.jVk(Object(n.a)(this,this.M6g,"onTypingLockStatusChanged"))}FGb(){var Ra=this.pa.rv();let sb=null;for(const ec of Ra)if(Ra=Object(ba.a)(pa.TableCellNode,ec))if(Ra=Object(ba.a)(454,Ra.tg(this.Fb.Ma)))if(sb=Ra.X0c)break;this.oHh(sb)}M6g(Ra,sb){this.oHh(sb.MHi)}oHh(Ra=null){this.pa.W8()?this.Sml(Ra):this.iZk()}Sml(Ra=null){if(this.Fb.editingView&&this.Fb.editingView.Vl){const sb=
this.rZf();sb&&(this.ima.VG(sb.shapeNode).Itd(Ra),Ra&&(sb.Yod=!0,this.oy.heh(new lf.a(sb)),sb.Yod=!1));this.B3c||ha.a.J(37573824,828,50,"TypingLockHandler:SuspectEditingView - ContentEditableView is switching to cell-lock mode");this.Fb.editingView.disable(!1,14);this.B3c=!0}}iZk(){if(this.Fb.editingView&&this.Fb.editingView.Vl){const Ra=this.rZf();Ra&&Ra.shapeNode.ud&&(this.ima.VG(Ra.shapeNode).Itd(null),Ra.cbe());this.B3c&&ha.a.J(37573826,828,50,"TypingLockHandler:ResumeEditingView - ContentEditableView is switching back to edit mode");
this.Fb.editingView.A0a();this.B3c=!1}}rZf(){let Ra=null;const sb=this.pa.Xd();1===sb.length&&(Ra=Object(ba.a)(117,sb[0].sc(this.Fb.Ma)));return Ra}}Object(k.a)(Jd,"TypingLockHandler",null,[1332,106]);var Xf=d(898);class ee{constructor(){this.b5c=this.nh=this.I4=this.l4c=this.qE=this.K=this.aJ=null;this.Ebc=0;this.I9c=null;this.Qqe=!1;this.u1c=null;this.Vse=!1;this.c4c=!0}get name(){return"Presence"}bxi(){this.K.register(u.a,"Common.PresenceUser").as("Common.IPresenceUser").ma();this.K.register(Oc,
"PowerpointPresence.PresenceUtils").as("Common.IPresenceConverter").ma().oa(()=>new Oc(this.K.resolve("PowerPointWebEditor.ICoauthStateGetter")));this.Qqe=!0}$b(Ra){this.Ebc=(new Date).getTime();this.K!==Ra&&(this.K=Ra,this.I4=this.K.resolve("PowerPointWebEditor.Core.IBundleMetricRecorder"),this.nh=this.I4.VDa(1,this.name),this.Qqe=!1,this.Vse=this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptUseEarlyPresenceRefactoring);this.aJ=this.K.resolve("Common.AFrameworkApplication");Ra=this.K.resolve("PowerPointWebEditor.IApplicationSettings");
this.c4c=!E.AFrameworkApplication.fa.ka("PPTODeprecateRtcFallback");this.Qqe||this.bxi();const sb=Ra.Ypi&&Ra.NOb?!1:Ra.wg,ec=this.oFi(this.K.resolve("PowerpointPresence.RtcParams"),this.K.resolve("Common.IPresenceUser"),sb,Ra["368"]);ec&&(this.K.register(1320,"Common.IRealtimeChannelBasic").ma().oa(()=>ec),this.K.register(1321,"AppRealtimeChannel.IRealtimeChannel").ma().oa(()=>ec),this.Zwi(Ra))}Zwi(Ra){this.K.register(Sa,"PowerpointPresence.PPTRtcProvider").as("Common.Interface.IRtcBasicProvider").ma().oa(()=>
new Sa(this.K.resolve("Common.IRealtimeChannelBasic")));this.K.register(Qa,"PowerpointPresence.EditorPresenceTracker").as("PowerpointPresence.IEditorPresenceTracker").ma().oa(()=>new Qa(this.K.resolve("PowerPointWebEditor.ICoauthStateGetter")));this.K.register(uc,"PowerpointPresence.PptRealtimeChannelMetrics").as("PowerpointPresence.IPptRealtimeChannelMetrics").ma().oa(()=>new uc(this.K.resolve("PowerpointPresence.RtcParams"),this.K.resolve("PowerPointWebEditor.ICoauthStateGetter"),this.K.resolve("PowerPointWebEditor.Core.INetworkHealthManager"),
this.K.resolve("PowerPointWebEditor.Core.INetworkState"),O.a.getInstance(),Ra.rtcAllowCrossDomainAccessOrigins));this.K.register(Xa,"PowerpointPresence.PresenceManager").as("PowerpointPresence.IPresenceManager").as("Common.IPresenceSender").as("PowerpointPresence.IPresenceUserManager").as("Common.IPresenceRemover").ma().oa(()=>new Xa(this.K.resolve("Common.IPresenceUser"),E.AFrameworkApplication.fa,this.K.resolve("AppRealtimeChannel.IRealtimeChannel"),this.K.resolve("PowerpointPresence.RtcParams"),
this.aJ.BS,this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventSource"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerpointPresence.IPresenceEventNotifier"),this.K.resolve("PowerPointWebEditor.ICoauthStateGetter"),
this.K.resolve("PowerPointWebEditor.ICoauthStateSetter"),Ra,this.K.resolve("PowerPointWebEditor.Core.ICoreEventSource"),this.K.resolve("PowerpointPresence.IEditorPresenceTracker"),this.K.resolve("PowerpointPresence.IPresenceColorProvider"),this.K.resolve("PowerpointPresence.IPresenceEmailConverter"),this.K.resolve("PowerpointPresence.IPptRealtimeChannelMetrics"),this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),this.K.resolve("PowerpointPresence.IPresencePerfLogger"),this.K.Ja("PowerPointWebEditor.PodsPops.IPodSeamlessFailoverManager"),
this.K.resolve("PowerpointPresence.IPresencePrepCacheParser").VTc(),this.K.resolve("PowerPointWebEditor.Core.INetworkHealthManager"),this.K.resolve("PowerPointWebEditor.IPopWebService"),this.K.resolve("PowerPointWebEditor.ISessionInfoOwner")));this.K.register(eb,"PowerpointPresence.PresenceCache").ma().oa(()=>new eb(this.K.resolve("PowerpointPresence.IPresenceManager")));this.K.register(Sc,"PowerpointPresence.PresencePresenter").ma().oa(()=>new Sc(this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),
this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerpointPresence.IPresenceManager"),this.K.resolve("Common.DragInputManager"),this.K.resolve("PowerpointPresence.ICoauthStateChangesHandler"),this.K.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapePresenceView>"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("Box4.IPageView").Ma,this.K.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView").Ma,
this.K.resolve("PowerpointPresence.IPresenceEventHandlers"),Ra.podsNewThumbnailVisibleRangeFetchExperience));this.K.register(Kc,"PowerPointWebEditor.PptWetChangeHandler").as("PowerPointWebEditor.IWetChangeHandler").ma().oa(()=>new Kc(this.K.resolve("Common.IPresenceUser").clientId,Ra.obl,this.K.resolve("PowerPointWebEditor.Graph.ITraverserFactory"),this.K.resolve("Box4.Graph.IGraphInstance").Ad(10),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers")));const sb=new Ab(Ra.JLi,
Ra.bqd,Ra.aqd,Ra.zub,Ra.L7b,Ra.UVc,Ra.nlb,Ra.Ssd,Ra.cib,Ra.CMc,Ra.AMc,Ra.ZMb,Ra.Hfb,Ra.$tb,Ra.podsTableRTTEnabled,Ra.podsTableCellLockEnabled);this.K.register(Jd,"PowerpointPresence.TypingLockHandler").as("PowerpointPresence.ITypingLockHandler").ma().oa(()=>new Jd(this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),this.K.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapePresenceView>"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler"),
this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventSource")));this.K.register(Fa,"PowerpointPresence.CoauthStateChangesHandler").as("PowerpointPresence.ICoauthStateChangesHandler").ma().oa(()=>new Fa(da.App.Ih,this.K.resolve("PowerpointPresence.IPresenceManager"),this.K.resolve("Common.IPresenceUser").clientId,this.K.resolve("AppRealtimeChannel.IRealtimeChannel"),this.K.resolve("PowerPointWebEditor.IPPTWorkspace"),this.K.resolve("Common.ITaskManager"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),
this.K.resolve("Box4.ContentEditableViewEventSource"),this.K.resolve("PowerPointWebEditor.IViewElementHelper"),this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("PowerPointWebEditor.Graph.ITableReader"),this.K.resolve("Box4.Graph.IGraphInstance").Ad(12),Ra,sb,this.K.resolve("PowerPointWebEditor.IWetChangeHandler"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapePresenceView>"),
this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("PowerpointPresence.ITypingLockHandler"),this.K.resolve("PowerPointWebEditor.View.IPPTPageView").Ma,this.K.resolve("Box4.Graph.IGraphInstance").Ad(16),H.a.Uu(I.a.instance.Ja("Common.ISystemInitiatedFeedback"))));this.K.register(1322,"PowerpointPresence.IPresencePawnFactory").ma().oa(()=>new ab);this.K.register(1323,"PowerpointPresence.ITextContentRecordFactory").ma().oa(()=>new cd(this.K.resolve("PowerPointWebEditor.IShapeReader"),
this.K.resolve("PowerPointWebEditor.Graph.ITableReader"),this.K.resolve("Box4.IParagraphReader"),this.K.resolve("PowerPointWebEditor.IWetChangeHandler")));this.K.register(gd,"PowerpointPresence.TextContentMonitor").ma().oa(()=>new gd(this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),fa.a.instance,this.K.resolve("Box4.Graph.IGraphInstance").Ad(12),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.K.resolve("PowerPointWebEditor.IWetChangeHandler"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler"),this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("PowerPointWebEditor.Graph.ITableReader"),this.K.resolve("PowerpointPresence.ITextContentRecordFactory"),sb));this.K.register(A,"Common.App.Presence.AwayManager").ma().oa(()=>this.aBi(this.K.resolve("Common.IPresenceUser"),
this.K.resolve("Common.IRealtimeChannelBasic"),this.K.resolve("Common.IPresenceRemover"),this.K.resolve("Common.IPresenceConverter"),Ra.ka("PeoplesWellExtraButtonInfoIsEnabled")));this.K.register(1324,"PowerPointWebEditor.IDelayedPresenceUserInfoGetter").ma().oa(()=>new Jb(this.K.resolve("AppRealtimeChannel.IRealtimeChannel")));this.SNc().gjb("RTCConfigured")}Zej(Ra){let sb;var ec=Ra;sb=0;if(Ra=this.K.resolve("PowerpointPresence.IPresencePrepCacheParser").ngj())return ec=this.K.resolve("PowerpointPresence.IPresencePrepCacheParser").Nod(),
{jRe:Ra,hRe:sb,d1d:ec};sb=1;if(Ra=this.K.resolve("PowerPointWebEditor.ICoauthStateSetter").Flh)return ec=this.K.resolve("PowerPointWebEditor.ICoauthStateSetter").Nod,{jRe:Ra,hRe:sb,d1d:ec};if(this.c4c)return{jRe:ec,hRe:2,d1d:!0}}nFi(){const Ra=1E3*this.K.resolve("PowerPointWebEditor.IApplicationSettings").rtcDiscoveryTimeoutSeconds;0<Ra&&(this.I9c=new C.a(2,1,Ra,()=>{this.c4c?this.K.resolve("PowerPointWebEditor.ICoauthStateSetter").BSf=!0:this.K.rb("AppRealtimeChannel.IRealtimeChannel")||ha.a.J(509670485,
828,10,"PresencePackage::createRtcDiscoveryTimeoutTask RTC Discovery Timed Out after {0} ms and attempted to fallback",Ra);this.K.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler").eih(Object(n.a)(this,this.EGe,"onPopsRtcEndpointUrlReady"));this.K.rb("AppRealtimeChannel.IRealtimeChannel")||(this.$b(I.a.instance),this.init())},90,"111"),this.K.resolve("Common.ITaskManager").Eb(this.I9c))}oFi(Ra,sb,ec,Lc){ha.a.J(512360602,828,50,"PresencePackage::CreateRtcInstance; isPodsEnabled:{0}",ec);sb.clientId=
Ra.clientId;var nd=null;sb=null;const Fd=O.a.getInstance();if(ec){sb=Lc+"rtc2";({jRe:sb,hRe:ec,d1d:Lc}=this.Zej(sb));nd=!this.K.resolve("PowerPointWebEditor.ICoauthStateGetter").amIAlone;const Ja=this.c4c&&this.K.resolve("PowerPointWebEditor.ICoauthStateSetter").BSf,db=this.K.resolve("PowerPointWebEditor.ICoauthStateSetter").Sig;ha.a.J(512360601,828,15,"PresencePackage::CreateRtcInstance; Discovering RTC enabled; RtcDiscoverType:{0} fCoauthoring:{1} fDefaultConnectToRtc:{2} fUseFallback:{3} fPopsRtcConfigured:{4}",
Wb[ec],nd,Lc,Ja,db);if(2===ec&&!Ja)return this.K.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler").l$h(Object(n.a)(this,this.EGe,"onPopsRtcEndpointUrlReady")),this.nFi(),null;if(!Lc&&!nd)return this.K.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler").SNd(Object(n.a)(this,this.mGb,"onCoauthStatusChanged")),null;nd=this.VAi(Ra,sb,this.K.resolve("PowerPointWebEditor.IApplicationSettings"),Fd)}return J.RealtimeChannel.createInstance(Ra.clientId,Ra.userSessionId,Ra.Eld,Ra.hca,Ra.Aoh,
3,Ra.Iw,sb,nd,Fd)}aBi(Ra,sb,ec,Lc,nd){const Fd=new R.a;Fd.Fg(ec);ec=new R.a;ec.Fg(sb);return new A(Ra,ec.task,Fd.task,Lc,this.K.resolve("Common.ITaskManager"),this.aJ.BS.od.PQd?6E4:this.aJ.BS.od.awayCoauthorThresholdMs,Object(n.a)(this.aJ.BS.QG(),this.aJ.BS.QG().processAction,"processAction"),ka.App.y5a.notificationBar,nd)}init(){const Ra=this.K.resolve("PowerpointPresence.IPresencePerfLogger");Ra.Yh(21,ee.$fc);Ra.Yh(22,this.Ebc);Ra.Yh(24,(new Date).getTime());this.K.resolve("PowerPointWebEditor.PresentationContext").isValid?
this.SNc().gjb("PresentationId"):this.K.resolve("PowerPointWebEditor.Core.IPodsPopsEventHandler").Jsf(Object(n.a)(this,this.Djc,"onPresentationIdReady"));this.K.resolve("PowerPointWebEditor.IAppBootCompletedListener").gyb(()=>{this.SNc().gjb("B2IFinished")})}Djc(){this.SNc().gjb("PresentationId");this.K.resolve("PowerPointWebEditor.Core.IPodsPopsEventHandler").fih(Object(n.a)(this,this.Djc,"onPresentationIdReady"))}EGe(){this.I9c&&this.K.resolve("Common.ITaskManager").Rg(this.I9c);this.K.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler").eih(Object(n.a)(this,
this.EGe,"onPopsRtcEndpointUrlReady"));this.K.rb("AppRealtimeChannel.IRealtimeChannel")||(this.$b(I.a.instance),this.init())}mGb(Ra,sb){2!==sb.h_g||this.K.rb("AppRealtimeChannel.IRealtimeChannel")||(this.$b(I.a.instance),this.init());this.K.rb("AppRealtimeChannel.IRealtimeChannel")&&this.K.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler").aPe(Object(n.a)(this,this.mGb,"onCoauthStatusChanged"))}SNc(){this.b5c||(this.b5c=new Xf.a(Object(n.a)(this,this.Pxb,"initInternal"),["PresentationId",
"B2IFinished","RTCConfigured"]));return this.b5c}Pxb(){this.K.resolve("PowerpointPresence.IPresencePerfLogger").Yh(4,this.K.resolve("PowerPointWebEditor.Core.IPodsPopsEventSource").mNe);this.K.resolve("PowerpointPresence.IPresencePerfLogger").Yh(23,(new Date).getTime());this.KCj();this.CDj();this.b5c=null}CDj(){try{let Ra="";this.K.resolve("PowerPointWebEditor.IDelayedPresenceUserInfoGetter");Ra=this.nh.su("presencemanager");this.DDj();this.nh.yu(Ra);this.K.resolve("PowerPointWebEditor.ICoauthStateSetter").GZc=
!0;ha.a.J(8958608,814,50,"PresencePackage::Init; Presence downloaded");da.App.uVd&&(Ra=this.nh.su("contentnotification"),Ob.init(),this.nh.yu(Ra));Ra=this.nh.su("resolve");this.K.resolve("PowerpointPresence.IPresencePerfLogger").rRi();this.qE=this.K.resolve("PowerpointPresence.IPresenceManager");this.K.resolve("Common.IPresenceConverter");this.K.resolve("Common.IRealtimeChannelBasic");this.aJ.BS.od.XSi&&(ha.a.J(512360600,814,50,"PresencePackage::Init; Refresh Peoples well after Rtc ready"),this.aJ.BS.QG().processAction(w.a.O6a,
2));this.K.resolve("PowerPointWebEditor.IWetChangeHandler");this.K.resolve("Common.Interface.IRtcBasicProvider");this.K.resolve("PowerpointPresence.ICoauthStateChangesHandler");this.K.resolve("PowerpointPresence.PresencePresenter");this.K.resolve("PowerpointPresence.IPresencePawnFactory");this.K.resolve("Common.App.Presence.AwayManager");this.aJ.BS.od.hermesMonitorShapeContentChangeEnabled&&this.K.resolve("PowerpointPresence.TextContentMonitor");this.nh.yu(Ra);this.K.resolve("PowerpointPresence.IPresencePerfLogger").cRi();
this.K.resolve("PowerpointPresence.IPresencePrepCacheParser").K1j()}catch(Ra){ha.a.J(512360599,814,10,"PresencePackage::Init; Loading presence and peoples well failed: {0}",Ra)}}dispose(){this.qE?this.qE.disconnect():ha.a.J(512360598,814,10,"PresencePackage::Dispose; m_presenceManager is null.");this.K.resolve("PowerpointPresence.IPresencePerfLogger").dispose()}DDj(){this.K.resolve("PowerpointPresence.PresenceManager").vb();ha.a.J(512360597,814,50,"PresencePackage::InitializePresenceManager; Presence Manager loaded and initialized")}VAi(Ra,
sb,ec,Lc){let nd=sb;nd=nd.endsWith("/")?nd+"findsession":nd+"/findsession";ha.a.J(512360596,814,50,"PresencePackage::CreateAssignRtcMachineStrategy; Using rtc path: {0}; WacClusterId: {1} ",nd,Ra.hca.Bga);sb=()=>W.FindSessionStrategy.dDi(Ra.userSessionId,Ra.hca,nd,Ra.Iw,E.AFrameworkApplication.buildVersion,Ra.clientId,ee.X_i(E.AFrameworkApplication.buildVersion),Lc,Ra.Aoh,()=>{if(E.AFrameworkApplication.jh)return E.AFrameworkApplication.jh;const Ja=this.K.resolve("PowerPointWebEditor.PresentationContext").presentationId.string;
Ja||ha.a.J(512360595,814,15,"CreateAssignRtcMachineStrategy - returning a null query string");return Ja},this.K.resolve("PowerpointPresence.IPresencePrepCacheParser").lgj());const Fd=!!this.l4c;return this.Vse||Fd?this.u1c=new Wa(this.l4c,sb,ec,Lc,this.K.resolve("PowerpointPresence.IPresencePerfLogger")):sb()}KCj(){var Ra;if(Ra=this.K.resolve("PowerPointWebEditor.IApplicationSettings").presenceEarlyFindSessionEnabled?this.K.resolve("PowerpointPresence.IPresencePrepCacheParser").getFindSessionResponse():
this.K.resolve("PowerPointWebEditor.Core.IFindRtcSessionSimpleStrategy").p2d)Ra=Y.RtcUtils.deserialize(Ra,"PresencePackage","Deserialize existing FindSession response",!0),this.agd(Ra)}agd(Ra){if(Ra)try{this.l4c=Object.assign(new Q.a,{X9b:Ra[S.a.gzb],errorMessage:Ra[S.a.errorMessage],T_b:Ra[S.a.pXe],B5:Ra[S.a.B5],MA:Ra[S.a.MA],gUc:Ra[S.a.l$d],wbd:Ra[S.a.Ifb],xbd:Ra[S.a.FLa],Abd:Ra[S.a.Kfb]}),this.Vse&&this.u1c&&(this.u1c.findSessionResponse=this.l4c)}catch(sb){ha.a.J(512360594,828,10,"Exception caught while creating FindSessionResponse: {0}",
sb)}}static main(){ee.$fc=(new Date).getTime();const Ra=new ee;E.AFrameworkApplication.fa&&E.AFrameworkApplication.fa.ka("IsSyncConfigPresenceEnabled")?(Ra.$b(I.a.instance),Ra.K.rb("AppRealtimeChannel.IRealtimeChannel")&&Ra.init()):T.a.instance.Dc(Ra)}static X_i(Ra){return String.format("{0}, {1}, {2}",ee.DBf(D.a[3]),ee.DBf("browser"),Ra)}static DBf(Ra){return Ra?Ra.charAt(0).toLocaleUpperCase()+Ra.substring(1,Ra.length):Ra}}ee.$fc=0;Object(k.a)(ee,"PresencePackage",null,[2,3]);Type.registerNamespace("PowerPointWebEditor");
Type.registerNamespace("PowerpointPresence");window.g_hermesPresence1JS=new Date;Type.registerNamespace("Common.App.Presence");Type.registerNamespace("AppRealtimeChannel");ee.main()},187:function(K,Z,d){d.r(Z);d.d(Z,"RtcUtils",function(){return r});K=d(0);var k=d(382),e=d(334),n=d(33);class r{static qTd(v,C=e.RealtimeChannel.iCe){let w;try{w=n.c(v)}catch(z){throw v=String.format("Failed to JSON-serialize payload : {0}",z),k.ULS.sendTraceTag(18637072,500,10,v),Error.argument("payload",v);}if(w.length>
C)throw v=String.format("Payload exceeds maximum length: {0} > {1}.",w.length,C),k.ULS.sendTraceTag(18637074,500,10,v),Error.argument("payload",v);return w}static deserialize(v,C,w){if(!v)return null;if(Object.getType(v)!==String){var z=String.format("Failed to deserialize [{0}] - object is not of type [String] and is instead of type [{1}]. ExtraInfo: [{2}].",C,Object.getType(v).getName(),w);k.ULS.sendTraceTag(18637075,500,10,z);return null}z=null;try{z=n.a(v)}catch(A){v=String.format("Failed to deserialize [{0}]. Exception deserializing the object : [{1}]. ExtraInfo: [{2}].",
C,A,w),k.ULS.sendTraceTag(18637077,500,10,v)}return z}static cGb(v){if(!v)return"";if("string"===typeof v)return v.toString();try{return n.c(v)}catch(C){return v.toString()}}static VRf(v){let C,w,z;C=0;z=w=null;if(!v)return{Bbe:C,Cbe:w,Zi:z};try{const A=v.source;A&&Object.getType(A)===String&&(z=A);const u=v.context;u&&(v=u,C=v.status?v.status:0,w=v.statusText?v.statusText:null)}catch(A){}return{Bbe:C,Cbe:w,Zi:z}}}Object(K.a)(r,"RtcUtils",null,[])},234:function(K,Z,d){d.d(Z,"a",function(){return k});
K=d(0);d=d(76);class k extends d.a{constructor(e){super();this._element=null;this.element=e}get element(){return this._element}set element(e){this._element=e}get visible(){return"visible"===this.element.style.visibility}set visible(e){this.element.style.visibility=e?"visible":"hidden"}get rtl(){return"rtl"===this.element.dir.toLowerCase()}set rtl(e){this.element.dir=e?"rtl":"ltr"}get zIndex(){return this.element.style.zIndex}set zIndex(e){this.element.style.zIndex=String(e)}dispose(){this.element&&
this.element.parentNode&&this.element.parentNode.removeChild(this.element);this.element=null;super.dispose()}createElement(e){return this.element.ownerDocument.createElement(e)}Kx(){return!0}static ytb(e,n){return e+(n?"Rtl":"")}}Object(K.a)(k,"BasePresenceControl",d.a,[106,405])},235:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k extends Sys.EventArgs{constructor(e,n){super();this.type=e;this.Yi=n}}k.lp="InteractivityChanged";Object(K.a)(k,"InteractivityChangedEventArgs",Sys.EventArgs,
[])},306:function(K,Z,d){d.r(Z);K=d(0);var k=d(382),e=d(13),n=d(103),r;(function(z){z[z.SendNotification=0]="SendNotification";z[z.SendPersistentState=1]="SendPersistentState";z[z.FindSession=2]="FindSession";z[z.Last=3]="Last"})(r||(r={}));Object(K.b)("ApiType",r);var v;(function(z){z[z.AttemptCount=0]="AttemptCount";z[z.SuccessCount=1]="SuccessCount";z[z.DropCount=2]="DropCount";z[z.FailedCount=3]="FailedCount";z[z.LatencyOverThresholdCount=4]="LatencyOverThresholdCount";z[z.LatencyUnderThresholdCount=
5]="LatencyUnderThresholdCount";z[z.ThrottledCount=6]="ThrottledCount";z[z.Last=7]="Last"})(v||(v={}));Object(K.b)("EventCountType",v);var C=d(691);d.d(Z,"FrequentLoggingMetrics",function(){return w});class w{constructor(z){this.CFf=this.XTf=null;this.UXg=this.nWf=0;this.Et=null;this.Zff=this.zEd=0;this.ei=z;this.pDj();this.Fzd=this.R$e=this.REd=!1;this.tEd=0}get ZSi(){return this.Fzd}Rkl(z){this.Zff=z;window.setInterval(Object(e.a)(this,this.Zme,"logMetricsBatchAndReset"),z);this.zEd=(new Date).getTime()}aH(z,
A){this.Abl(z)&&!this.R$e||this.ZSi||!window.navigator.onLine||this.ei.gFa||(this.Et[z][A]++,this.REd=!0)}pDj(){this.Et=Array(3);for(let z=0;3>z;z++){this.Et[z]=Array(7);for(let A=0;7>A;A++)this.Et[z][A]=0}}Fji(){const z={};for(let A=0;3>A;A++)for(let u=0;7>u;u++)this.rVj(A,u)&&(z[r[A]+v[u]]=this.Et[A][u]);z.FSDomain=this.XTf;z.ConnectionDomain=this.CFf;z.FSRetryInterval=this.nWf;z.MaxPayloadSize=this.UXg;z.LogNumber=this.tEd;1===this.tEd&&(z.FSLatencies=C.a.instance.u8i(),z.ConLatencies=C.a.instance.K4i());
return z}rVj(z,A){return 2===z&&3!==A&&0!==A?!1:!0}Abl(z){return 2===z?!1:!0}Zme(){if(this.REd){this.tEd++;if((new Date).getTime()-this.zEd<5E3+this.Zff){var z=n.a.toJSON(this.Fji());k.ULS.sendTraceTag(50644352,500,15,z)}this.zEd=(new Date).getTime();for(z=0;3>z;z++)for(let A=0;7>A;A++)this.Et[z][A]=0;this.REd=!1}}pfk(){this.R$e=!0}static get instance(){return w.Ka}static create(z){w.instance||(w.Ka=new w(z));return w.instance}}w.Ka=null;Object(K.a)(w,"FrequentLoggingMetrics",null,[1387])},334:function(K,
Z,d){d.r(Z);K=d(0);var k=d(382),e=d(13),n=d(1047),r=d(970),v=d(67),C=d(25);class w{constructor(ua,za){this.status=ua;this.aAb=za}}Object(K.a)(w,"UserStatusInfo",null,[]);var z=d(78),A=d(691);class u{constructor(ua,za){this.data=ua;this.timeStamp=za}}Object(K.a)(u,"PresenceData",null,[]);class E{constructor(ua){this.Kqa=!1;this.$pb=0;this.Oxd=!1;this.setTimeout=E.tYd;this.clearTimeout=E.jYd;this.T2j=Object(e.a)(this,this.f2j,"logRtcConnectingUsageStatement");this.Xr=ua}hnk(){this.Kqa||(this.$pb=this.setTimeout(()=>
{this.Kqa=!1;this.Fog()},8E3),this.Kqa=!0,this.Oxd=!1)}Tnk(){this.kN()}Ftk(){this.Fog()}Fog(){this.kN();this.Oxd||(this.Oxd=!0,this.T2j())}f2j(){k.ULS.sendTraceTag(4539720,500,50,"Usage statement for the Rtc_ConnectedEver KPI for [{0}]",this.Xr)}kN(){this.Kqa&&this.clearTimeout(this.$pb);this.$pb=0;this.Kqa=!1}static tYd(ua,za){return window.setTimeout(ua,za)}static jYd(ua){window.clearTimeout(ua)}}Object(K.a)(E,"ConnectedUsageKpiLogger",null,[1430]);class H{constructor(){this.wjd=this.HNe;this.KNe=
this.LNe;this.xjd=this.JNe;this.bnc=this.NNe;this.ffh=this.MNe;this.UNe=this.VNe;this.RNe=this.SNe;this.Ohb=this.PNe;this.dnc=this.QNe;this.afh=this.INe;this.NFb=this.BDe;this.Fic=this.CDe}HNe(){}LNe(){}JNe(){}NNe(){}MNe(){}SNe(){}QNe(){}PNe(){}VNe(){}INe(){}BDe(){}CDe(){}}Object(K.a)(H,"NoopRealtimeChannelMetrics",null,[1423,292]);class I{}I.d1a="presenceUpdated";I.updateNotification="updateNotification";I.W9g="persistentStateCleared";I.updatePersistentState="persistentStateUpdated";Object(K.a)(I,
"RtcClientMethodNames",null,[]);class J{}J.Iyj="realtimeChannelHub";J.d1a="UpdatePresence";J.Lfa="SendUpdateNotification";J.N4d="GetCompletePersistentStateWithMetadata";J.updatePersistentState="UpdatePersistentState";J.rlb="UpdateClientInfo";Object(K.a)(J,"RtcHubMethodNames",null,[]);class T{constructor(ua){this.Hz=ua}lQk(ua){this.Hz.on(I.d1a,ua)}JQk(ua){this.Hz.on(I.updateNotification,ua)}iQk(ua){this.Hz.on(I.updatePersistentState,ua)}hQk(ua){this.Hz.on(I.W9g,ua)}ywl(ua){this.Hz.off(I.d1a,ua)}Cwl(ua){this.Hz.off(I.updateNotification,
ua)}xwl(ua){this.Hz.off(I.updatePersistentState,ua)}wwl(ua){this.Hz.off(I.W9g,ua)}d1a(ua){return this.Hz.invoke(J.d1a,ua)}rlb(ua){return this.Hz.invoke(J.rlb,ua)}Lfa(ua,za){return this.Hz.invoke(J.Lfa,ua,za)}N4d(ua){return this.Hz.invoke(J.N4d,ua)}updatePersistentState(ua,za){return this.Hz.invoke(J.updatePersistentState,ua,za)}}Object(K.a)(T,"RealtimeChannelProxy",null,[1427,1428,1429]);class D{constructor(){this.wwd=this.i6e=!1;this.uwd=0;this.xxd=this.xJd=this.wJd=this.Wvd=!1;this.Szd=0;this.flf=
!1;this.elf=this.dlf=0;this.xId=!1;this.BId=this.zId=this.CId=this.yId=0;this.AId=!1}get PQd(){return this.wwd}get awayCoauthorThresholdMs(){return this.uwd}get gci(){return this.Wvd}get Mcl(){return this.wJd}get Ncl(){return this.xJd}get Rsi(){return this.xxd}get v3b(){return this.Szd}get f_k(){return this.flf}get Glh(){return this.dlf}get e_k(){return this.elf}get $Zk(){return this.xId}get a_k(){return this.yId}get Klh(){return this.CId}get Hlh(){return this.zId}get Jlh(){return this.BId}get Ilh(){return this.AId}static createInstance(ua){const {RealtimeChannel:za}=
d(334);return ua?Object.assign(new D,{i6e:ua.ka("AwayStatusManagerIsEnabled"),wwd:ua.ka("AwayStatusOneMinuteTimeoutIsEnabled"),uwd:ua.Fc("AwayCoauthorThresholdMs",9E5),Wvd:ua.ka("RtcAllowCrossDomainAccessEnabled"),wJd:ua.ka("ShouldLogOnContentNotification"),xJd:ua.ka("ShouldLogOnHostSubscriptionNotification"),xxd:ua.ka("RtcClientMetricsEnabled"),Szd:ua.Fc("RtcFindSessionRequestTimeoutInMS",6E4),flf:ua.ka("RtcJsClientFrequentlyLogsMetrics"),dlf:ua.Fc("RtcJsClientFrequentMetricsLatencyThresholdInMS",
1E3),elf:ua.Fc("RtcJsClientFrequentMetricsLogIntervalInMS",3E5),xId:ua.ka("RtcClientMessageTelemetryEnabled"),yId:ua.Fc("RtcClientMessageTelemetrySampleSize",5),CId:ua.Fc("RtcSendTelemetryMessageIntervalInMS",3E5),zId:ua.Fc("RtcLogClientMessageMetricsTimeOutInMs",2E4),BId:ua.Fc("RtcMaxPayloadSizeInCharactersOverride",za.iCe),AId:ua.getBooleanFeatureGate("Microsoft.Office.SharedOnline.RTCLogSignalrHeartBeatMessages",!1)}):Object.assign(new D,{i6e:!1,wwd:!1,uwd:9E5,Wvd:!1,wJd:!1,xJd:!0,xxd:!1,Szd:9E4,
xId:!1,yId:5,CId:3E5,zId:2E4,BId:za.iCe,AId:!1})}}Object(K.a)(D,"RealtimeChannelSettings",null,[1426]);var R=d(697),Q=d(1186),W=d(156);class O{constructor(ua){this.EWb=null;this.Wxa=0;this.b8a=!1;this.rl=ua;this.rl.K5a(Object(e.a)(this,this.dna,"onConnectionStateChanged"))}dna(ua,za){this.Wxa=za.newState}Wtk(){k.ULS.sendTraceTag(18637070,500,15,"Too many undelivered messages. Restarting RTC connection.");this.rl.ijd()}fCj(ua){this.EWb.init(ua)}}Object(K.a)(O,"ARtcMessageHandler",null,[]);var Y=d(1001);
class S{constructor(){this.Presence=null;this.TimeStamp=0}}Object(K.a)(S,"PresenceDataEntryForClients",null,[]);var da=d(103);class fa{constructor(ua,za=""){this.FZh=ua;this.uAa=za}send(){return this.FZh()}get messageId(){return this.uAa}}Object(K.a)(fa,"MessageHandler",null,[1450]);var ka=d(723);class ha extends Sys.EventArgs{constructor(ua,za,Wa,yb){super();this.UPe=ua;this.reconnectDelay=za;this.reason=Wa;this.vSe=yb}}Object(K.a)(ha,"RefreshConnectionReconnectArgs",Sys.EventArgs,[]);var F=d(974);
class na{constructor(){this.fKd=this.Jj=null}get Rq(){return this.Jj?this.fKd?this.fKd.getTime()-this.Jj.getTime():(new Date).getTime()-this.Jj.getTime():0}start(){this.Jj=new Date}stop(){this.fKd=new Date}}Object(K.a)(na,"SimpleStopwatch",null,[]);var ba=d(975),Ea;(function(ua){ua[ua.contentUpdate=0]="contentUpdate";ua[ua.editorsTableUpdate=1]="editorsTableUpdate";ua[ua.fileNameUpdate=2]="fileNameUpdate";ua[ua.wetContentUpdate=3]="wetContentUpdate";ua[ua.persistedContentUpdate=4]="persistedContentUpdate";
ua[ua.clientRtcReconnectRequest=5]="clientRtcReconnectRequest";ua[ua.replicationTelemetry=6]="replicationTelemetry";ua[ua.lockUpdate=7]="lockUpdate";ua[ua.collabServiceContentUpdate=8]="collabServiceContentUpdate";ua[ua.trackChangeSettingUpdate=9]="trackChangeSettingUpdate";ua[ua.saveTargetUpdate=10]="saveTargetUpdate";ua[ua.uploadToOcsUpdate=11]="uploadToOcsUpdate";ua[ua.labelUpdate=12]="labelUpdate";ua[ua.hostNotificationSubscriptionStatus=13]="hostNotificationSubscriptionStatus";ua[ua.subscribeOrExtend=
14]="subscribeOrExtend";ua[ua.elapsedBootTelemetry=15]="elapsedBootTelemetry";ua[ua.clientToClientTelemetryMessage=16]="clientToClientTelemetryMessage";ua[ua.clientToClientResponseMessage=17]="clientToClientResponseMessage";ua[ua.verifyNotificationPipeline=18]="verifyNotificationPipeline";ua[ua.hostNotificationHeartbeat=19]="hostNotificationHeartbeat";ua[ua.secondaryMetadataUpdate=20]="secondaryMetadataUpdate";ua[ua.last=21]="last"})(Ea||(Ea={}));Object(K.b)("UpdateNotificationType",Ea);var La=d(920),
ta=d(918),oa=d(919);class wa extends O{constructor(ua,za,Wa,yb,Za,ub,Ib,Ob,Hc,kb){super(Ib);this.Hz=null;this.Tff=!1;this.uAa=0;this.RGd=new W.a;this.sUh=wa.V4i();this.wGd=C.AFrameworkApplication.fa.Ha("OwningFeatureCrewForRtcNotificationKpis");this.Jc=ua;this.zhf=this.yhf=0;this.EWb=za;this.EWb.YFc(Object(e.a)(this,this.Wtk,"onTooManyUndeliveredMessages"));this._clientId=Wa;this.iYh=Za;this.rl.v$h(Object(e.a)(this,this.Trk,"onRefreshProxyRequired"));this.rl.t$h(Object(e.a)(this,this.Rrk,"onRefreshAllPersistentStateRequest"));
this.rl.I$h(Object(e.a)(this,this.Lfa,"sendUpdateNotification"));this.rl.w8h(Object(e.a)(this,this.Ipk,"onInternalPresenceUpdated"));this.rl.x8h(Object(e.a)(this,this.Jpk,"onInternalUpdateNotificationReceived"));this.rl.v8h(Object(e.a)(this,this.Hpk,"onInternalPersistentStateUpdated"));this.rl.u8h(Object(e.a)(this,this.Gpk,"onInternalPersistentStateCleared"));this.rl.H$h(Object(e.a)(this,this.FSe,"sendPersistentState"));this.rl.Aai(Object(e.a)(this,this.rlb,"updateClientInfo"));this.Xh=ub;this.Xr=
yb;this.Et=Ob;this.YM=Hc;this.XTb=kb;this.lmb=Object(Q.a)(String,C.AFrameworkApplication.gd.Application)||""}Trk(ua,za){this.Hz=this.iYh(za.hubConnection);this.EWb.reset();this.Hz.lQk(Object(e.a)(this,this.Cjc,"onPresenceUpdated"));this.Hz.iQk(Object(e.a)(this,this.Ied,"onPersistentStateUpdated"));this.Hz.hQk(Object(e.a)(this,this.AGe,"onPersistentStateCleared"));this.Hz.JQk(Object(e.a)(this,this.Wjc,"onUpdateNotificationReceived"))}dna(ua,za){this.Wxa=za.newState;2===za.newState&&this.b3k()}b3k(){for(let ua of this.RGd)this.Lfa(null,
new F.a(ua.key,ua.value,!1,new n.a));this.RGd=new W.a}Rrk(ua,za){za.KTd();for(ua=0;3>ua;++ua)this.P2k(ua,za)}P2k(ua,za){try{this.Hz.N4d(ua).done(Wa=>{za.SOb(za.bVd,"GetCompletePresenceSuccess")&&(za.Hxi.Ftk(),k.ULS.sendTraceTag(3249540,500,50,"Successfully retrieved complete session state for [{0}]",this.Xr),this.rl.$Jk(),this.lrk(ua,Wa),this.rl.cJk(Wa),za.ARf.Hb(ua)&&this.rl.aeh(ua,za.ARf.ga(ua),new n.a))}).fail(Wa=>{const {RtcUtils:yb}=d(187);za.SOb(za.bVd,"GetCompletePresenceFail")&&(k.ULS.sendTraceTag(3249541,
500,15,"Failed to retrieve complete session state : {0} for [{1}]",yb.cGb(Wa),this.Xr),this.rl.ijd())}).always(()=>{za.Ay&&za.Ay.stop()})}catch(Wa){k.ULS.sendTraceTag(595132428,500,10,"Exception thrown while calling hub method GetCompletePersistentStateWithMetadata. Promise not even created. Current event token: {0}, Exception message: {1}",za.bVd,Wa.message)}}FSe(ua,za){var {RtcUtils:Wa}=d(187);ua=za.presence;let yb;const Za=za.uLa;this.YM.aH(1,0);try{yb=Wa.qTd(ua,this.XTb)}catch(Ib){this.YM.aH(1,
3);k.ULS.sendTraceTag(574407636,500,10,"Exception thrown while trying to serialize presence. Exception message: {0}",Ib.message);Za.setException(Ib);return}Wa=new v.a;Wa.$(this._clientId,Object.assign(new S,{Presence:ua,TimeStamp:(new Date).getTime()}));this.rl.xeh(za.type,Wa);if(2!==this.Wxa)this.Et.Ohb(),this.YM.aH(1,2),Za.Fg(null);else{var ub=this.uAa.toString();++this.uAa;ua=new fa(()=>this.d3k(za.type,yb,ub),ub);ua=this.dBh(0,za.type).add(ua);ua.ped(Ib=>{2===Ib&&this.YM.aH(1,6);Za.Fg(null)});
ua.oed(()=>{})}}d3k(ua,za,Wa){let yb=null;const Za=new na,ub=new ka.a;k.ULS.sendTraceTag(3249501,500,50,"Sending presence update for [{0}]",this.Xr);if(2!==this.Wxa)return this.Et.Ohb(),this.YM.aH(1,2),k.ULS.sendTraceTag(7934171,500,15,"Connection is lost - unable to send the message for [{0}]",this.Xr),ub.$Be(),ub;this.Xh&&20>this.yhf&&(yb=this.Xh.Ci("WebServiceCall","Send Presence Message"),this.yhf++);Za.start();ub.Phc(1);try{this.Hz.updatePersistentState(ua,za).done(()=>{this.Et.RNe();this.YM.aH(1,
1);k.ULS.sendTraceTag(3249502,500,50,"Successfully delivered presence update message [{0}] for [{1}]",Wa,this.Xr);ub.cYa(1);Za&&(Za.stop(),Za.Rq>this.Jc.Glh?this.YM.aH(1,4):this.YM.aH(1,5))}).fail(Ib=>{const {RtcUtils:Ob}=d(187);this.b8a||(this.Et.Ohb(),this.YM.aH(1,3),k.ULS.sendTraceTag(3249503,500,15,"Server failed to process the presence update message [{0}]: [{1}] for [{2}]",Wa,Ob.cGb(Ib),this.Xr));ub.cYa(2)}).always(()=>{yb&&yb.stop()})}catch(Ib){k.ULS.sendTraceTag(593072906,500,15,"Exception when invoking hub method UpdatePersistentState, error: {1}",
Ib.message),this.YM.aH(1,3),ub.cYa(2)}return ub}rlb(ua,za){({RtcUtils:ua}=d(187));const Wa=za.Qsi,yb=za.uLa;let Za;try{Za=ua.qTd(Wa,this.XTb)}catch(ub){k.ULS.sendTraceTag(544318999,500,10,"Exception thrown while trying to serialize clientInfo. Exception message: {0}",ub.message);yb.setException(ub);return}try{this.Hz.rlb(Za).done(()=>{k.ULS.sendTraceTag(544319E3,500,50,"Successfully delivered clientInfo.")}).fail(ub=>{const {RtcUtils:Ib}=d(187);this.b8a||k.ULS.sendTraceTag(544319001,500,15,"Server failed to process udpate clientInfo: {0}.",
Ib.cGb(ub));yb.Fg(null)})}catch(ub){k.ULS.sendTraceTag(544319002,500,15,"Exception when invoking hub method UpdateClientInfo: error: {0}",ub.message),yb.Fg(null)}}Lfa(ua,za){({RtcUtils:ua}=d(187));const Wa=za.type,yb=za.oza,Za=za.LJi,ub=za.uLa;let Ib;this.YM.aH(0,0);try{Ib=ua.qTd(yb,this.XTb)}catch(Hc){this.YM.aH(0,3);k.ULS.sendTraceTag(574407637,500,10,"Exception thrown while trying to serialize updateHint. Exception message: {0}",Hc.message);ub.setException(Hc);return}if(2!==this.Wxa)Za?this.RGd.$(Wa,
yb):(this.Et.Ohb(),this.YM.aH(0,2)),ub.Fg(null);else{var Ob=this.uAa.toString();++this.uAa;za=new fa(()=>this.y3k(Wa,Ib,Ob),Ob);za=this.dBh(1,Wa).add(za);za.ped(Hc=>{2===Hc&&this.YM.aH(0,6);ub.Fg(null)});za.oed(()=>{})}}y3k(ua,za,Wa){let yb=null;const Za=new na,ub=new ka.a;k.ULS.sendTraceTag(3249505,500,50,"Sending update notification for [{0}]",this.Xr);if(2!==this.Wxa)return this.Et.Ohb(),this.YM.aH(0,2),k.ULS.sendTraceTag(7934172,500,15,"Connection is lost - unable to send the message for [{0}]",
this.Xr),ub.$Be(),ub;this.Xh&&3===ua&&20>this.zhf&&(yb=this.Xh.Ci("WebServiceCall","Send WetContent Update"),this.zhf++);Za.start();ub.Phc(1);this.Hz.Lfa(ua,za).done(()=>{this.Et.RNe();this.YM.aH(0,1);k.ULS.sendTraceTag(3249506,500,50,"Successfully delivered update notification message [{0}] for [{1}]",Wa,this.Xr);ub.cYa(1);Za&&(Za.stop(),Za.Rq>this.Jc.Glh?this.YM.aH(0,4):this.YM.aH(0,5))}).fail(Ib=>{const {RtcUtils:Ob}=d(187);this.b8a||(this.Et.Ohb(),this.YM.aH(0,3),k.ULS.sendTraceTag(3249507,500,
15,"Server failed to process the update notification message [{0}] : [{1}] for [{2}]",Wa,Ob.cGb(Ib),this.Xr));ub.cYa(2)}).always(()=>{yb&&yb.stop()});return ub}nza(){this.Hz.ywl(Object(e.a)(this,this.Cjc,"onPresenceUpdated"));this.Hz.xwl(Object(e.a)(this,this.Ied,"onPersistentStateUpdated"));this.Hz.wwl(Object(e.a)(this,this.AGe,"onPersistentStateCleared"));this.Hz.Cwl(Object(e.a)(this,this.Wjc,"onUpdateNotificationReceived"))}Ipk(ua,za){this.Cjc(za.GOb,za.SMf)}Cjc(ua){this.Et.dnc();this.Ied(0,ua)}Hpk(ua,
za){this.Ied(za.type,za.GOb)}lrk(ua,za){const Wa={};for(let yb in za)Wa[yb]=za[yb].Presence;this.H4g(ua,Wa,za)}Ied(ua,za){this.Et.dnc();this.H4g(ua,za)}H4g(ua,za,Wa=null){var {RtcUtils:yb}=d(187);if(k.ULS.wya(500,100))for(var Za in za);delete za[this._clientId];if(!da.a.isEmpty(za)){for(var ub in za)Za=ub,za[Za]=yb.deserialize(za[ub],"Presence",Za,!1,this.XTb);yb=new v.a;ub=(new Date).getTime();for(let Ib in za){Za=za[Ib];let Ob=Ib,Hc;Wa?(Hc=Wa[Ob],Hc.Presence=Za):Hc=Object.assign(new S,{Presence:Za,
TimeStamp:ub});yb.$(Ob,Hc)}this.rl.xeh(ua,yb);switch(ua){case 0:this.Tff||(k.ULS.sendTraceTag(4539734,500,50,"Raising first presence update notification for [{0}]",this.Xr),this.Tff=!0,C.AFrameworkApplication.Vg&&C.AFrameworkApplication.Vg.lfk());this.rl.Qdh(za,[]);break;default:this.rl.NJk(ua,za)}}}Gpk(ua,za){this.AGe(za.bUd)}AGe(ua){this.Et.dnc();if(k.ULS.wya(500,100))for(let za=0;za<ua.length;++za);ua.length&&(this.rl.cLk(ua),this.rl.MJk(ua),this.rl.Qdh({},ua))}Jpk(ua,za){this.Wjc(za.type,za.oza)}Wjc(ua,
za=null){this.Jc.Mcl&&0===ua&&k.ULS.sendTraceTag(40128990,500,50,"Received ContentUpdate notification from the server");if(0===ua&&this.wGd&&0<this.wGd.length){var Wa=Object.assign(new La.a,{topLevelKpiName:"ContentUpdateNotificationReceived",featureName:"RtcNotification",crewAlias:this.wGd,vetoPillar:"RealTimeCoauth"});(Wa=Y.a.getInstance(Wa))&&Wa.logKpiUsage(this.sUh)}this.Jc.Ncl&&13===ua&&k.ULS.sendTraceTag(575221780,500,50,String.format("Received HostSubscription notification from the server : {0}",
za||"<none>"));this.Et.dnc();5===ua?(za=(ua=this.dyk(za))?String.format("Received client reconnection request from the server. Reason: {0}, Backoff time: {1} ",ua.reason,ua.reconnectDelay):"Received client reconnection request from the server without params.",k.ULS.sendTraceTag(18637071,500,50,za),this.rl.ijd(ua)):(za=d(187).RtcUtils.deserialize(za,String.format("UpdateNotification-{0}",Ea[ua]),null,!1,this.XTb),this.rl.bLk(ua,za))}dyk(ua){try{if(!ua||""===ua)return null;const za=JSON.parse(ua);return new ha(za[ba.a.kRe],
za[ba.a.ZZk],za[ba.a.c_k],za[ba.a.vSe])}catch(za){return k.ULS.sendTraceTag(593844380,500,15,"Error when parsing reconnect hint: {0}",za.message),null}}dBh(ua,za){return this.EWb.$kj(this.alj(ua,za))}alj(ua,za){return ua+","+za}static V4i(){var ua=new Map;ua.set("SkipAria","True");ua=Object.assign(new ta.a,{extendedProperties:ua});return Object.assign(new oa.a,{kpiName:"ContentUpdateNotificationReceived",kpiType:0,optionalProperties:ua,blockFutureEmissionDurationInMs:3E5})}}Object(K.a)(wa,"RtcMessageHandler",
O,[]);class ra{pIf(ua,za=""){const {MaxOutstandingThrottler:Wa}=d(971);return Wa.createInstance(ua,za)}DDi(ua,za=""){const {MaxRateThrottler:Wa}=d(973);return Wa.createInstance(ua,za)}}Object(K.a)(ra,"ThrottlerFactory",null,[1425]);var ya=d(76),Da=d(692);class pa{constructor(ua){this.Jc=null;this.zP=!1;this.Oa=new ya.a;this.MEd=new v.a;this.KEd=new v.a;this.cLd=ua;this.Gnb=this.cLd.pIf(za=>za.send(),"GlobalMaxOustandingThrottler");this.Gnb.YFc(()=>{this.Oa.raiseEvent("TMUDM")})}init(ua){this.zP||
(this.Jc=ua,this.Gnb.init(this.Jc.FLa,this.Jc.Rnj),this.zP=!0)}$kj(ua){var {MaxRateThrottler:za}=d(973),{MaxOutstandingThrottler:Wa}=d(971);this.zP||this.init(new Da.a(za.tKf,Wa.KKf,Wa.zKf,pa.qgk));({value:za}=this.MEd.Uf(ua)).returnValue||(({value:za}=this.KEd.Uf(ua)).returnValue||(za="MaxOutstandingThrottler-"+ua,za=this.cLd.pIf(Object(e.a)(this.Gnb,this.Gnb.add,"add"),za),za.init(this.Jc.FLa,this.Jc.pgk),za.YFc(()=>{this.Oa.raiseEvent("TMUDM")}),this.KEd.add(ua,za)),Wa="MaxRateThrottler-"+ua,za=
this.cLd.DDi(Object(e.a)(za,za.add,"add"),Wa),za.init(this.Jc.lhk),this.MEd.add(ua,za));return za}reset(){for(let ua of this.MEd)ua.value.TNe();for(let ua of this.KEd)ua.value.TNe(),ua.value.reset();this.Gnb.TNe();this.Gnb.reset()}YFc(ua){this.Oa.addHandler("TMUDM",ua)}}pa.qgk=1E3;Object(K.a)(pa,"ThrottlerManager",null,[1424]);var la=d(1123);const Fa=(ua,za,Wa,yb,Za,ub,Ib,Ob,Hc=null,kb=null,jb=null,hb=null)=>{const uc=D.createInstance(C.AFrameworkApplication.fa),mc=C.AFrameworkApplication.buildVersion?
C.AFrameworkApplication.buildVersion:"1.0",Ya=Qa(ua,za,Ib,mc),Mb=uc.Rsi?d(1121).RealtimeChannelMetrics.createInstance(Ya):new H;var Kc=d(306).FrequentLoggingMetrics.create(Za);uc.f_k&&Kc.Rkl(uc.e_k);var eb="";eb=Hc&&""!==Hc?Hc:"/rtc2/";Kc.XTf=z.a.UD(eb);const Tb=eb+"signalr";Hc=eb+"findsession";const lb=J.Iyj;eb=new ra;jb=jb||R.a.getInstance();k.ULS.shipAssertTag(556867617,500,uc.Jlh<=d(334).RealtimeChannel.VXg,"Client attempting to override max payload size beyond absolute limit");const Fb=Math.min(uc.Jlh,
d(334).RealtimeChannel.VXg);Kc.UXg=Fb;Kc=new wa(uc,new pa(eb),ua,Ya,rb=>new T(rb.createHubProxy(lb)),Ob,jb,Mb,Kc,Fb);kb||(kb=d(699).FindSessionStrategy.createInstance(za,Za,Hc,Ob,mc,Ib,ua,Ya,jb,ub,yb,hb));kb.v3b=uc.v3b;za=new E(Ya);Wa=Wa?Wa.split(","):null;ua=new (d(334).RealtimeChannel)(ua,Wa,Ya,Ob,()=>$.hubConnection(Tb),kb,Kc,za,jb,Mb,uc,Za);ua.init();return ua},Qa=(ua,za,Wa)=>String.format("ClientID={0}, App={1}, ClientType={2}, SessionId={3}",ua,Sa(la.a[Wa]),Sa("browser"),za),Sa=ua=>ua?ua.charAt(0).toLocaleUpperCase()+
ua.substring(1,ua.length):ua;d.d(Z,"RealtimeChannel",function(){return Na});class Na{constructor(ua,za,Wa,yb,Za,ub,Ib,Ob,Hc,kb,jb,hb){this.dKd=!1;this.lZ=null;this.mS=new v.a;this.sQb=1;this.Y1=null;this.mK=!1;this.GDd=(new Date(0)).getTime();this.Cmf=0;this._clientId=ua;this.cEc=za;this.mZ=0;this.Xh=yb;this.Nxd=Ob;this.pZh=Ib;this.CLh=Hc;this.lOh=Za;this.wMa=ub;this.Xr=Wa;this.Et=kb;this.Jc=jb;this.ei=hb;this.J_h=1>100*Math.random()}get Lma(){return this.wMa.Lma}set Lma(ua){this.wMa.Lma=ua}get h_a(){return this.pZh}get rl(){return this.CLh}init(){this.rl.u$h(Object(e.a)(this,
this.DMc,"disconnectAndCreateNewConnection"));this.rl.Cai(Object(e.a)(this,this.kuk,"onUpdatePersistentStateRequestReceivedInternal"));this.rl.Bai(Object(e.a)(this,this.juk,"onUpdatePersistentStateClearedRequestReceived"));this.ei.oFc(this.Et);C.AFrameworkApplication.cga(()=>{const {FrequentLoggingMetrics:ua}=d(306);this.Et.UNe();ua.instance&&ua.instance.Zme()});this.wIf();this.ILi();this.rl.Tsf(Object(e.a)(this,this.Jxl,"updateConnectionQueryString"))}ILi(){try{const Wa=$.signalR;if(!Wa)throw Error.invalidOperation("Failed to retrieve Signalr object");
const yb=Wa.version;if(!yb)throw Error.invalidOperation("Signalr object is missing version information");if("2.1.1"===yb){var ua=Wa.transports;if(!ua)throw Error.invalidOperation("Failed to retrieve transports object");var za=ua.longPolling;if(!za)throw Error.invalidOperation("Failed to retrieve longPolling object");if(!za.supportsKeepAlive)throw Error.invalidOperation("LongPolling object does not have a field called supportsKeepAlive");za.supportsKeepAlive=this.IFi()}}catch(Wa){k.ULS.sendTraceTag(6432339,
500,15,"Failed to disable longPolling KeepAlives: {0}",Wa.message)}}IFi(){return()=>!1}wIf(){const ua=++this.sQb;this.GDd=(new Date(0)).getTime();this.Y1=this.lOh();this.rl.WJk(this.Y1);this.Y1.stateChanged(za=>{this.mnk(za,ua)});this.Y1.connectionSlow(Object(e.a)(this,this.wtk,"onSlowConnection"));this.Y1.error(Object(e.a)(this,this.htk,"onSignalRError"));this.Y1.log=Object(e.a)(this,this.itk,"onSignalRLog")}SOb(ua,za){return ua!==this.sQb?(k.ULS.sendTraceTag(4309017,500,50,"ConnectionToken verification failed for {0}",
za),!1):!0}connect(){2!==this.mZ&&1!==this.mZ&&(k.ULS.sendTraceTag(4539721,500,50,"Starting a new RTC connection for client [{0}]",this.Xr),this.Nxd.hnk(),A.a.instance.Skl(),this.dna(1,this.mZ),this.oxh())}oxh(){const ua=this.sQb;this.dKd=!1;this.Et.wjd();this.wMa.n8d(Object(e.a)(this,this.Gxi,"connectSignalrConnection"),Object(e.a)(this,this.R2g,"onFailureToConnect"),Object(e.a)(this.h_a,this.h_a.fCj,"initThrottlerManager"),Object(e.a)(this,this.SOb,"verifyConnectionToken"),ua)}R2g(ua=null){this.Et.xjd();
let za=null;!ua||"documentsessiondeleted"!==(za=ua.toLowerCase())&&"documentsessionexpired"!==za?this.DMc():(k.ULS.sendTraceTag(41788292,500,15,"In RealtimeChannel method OnFailureToConnect: Disconnect was called for [{0}], due to non-retriable RtcErrorCode:{1}",this.Xr,ua),this.disconnect())}DMc(ua,za=null){k.ULS.sendTraceTag(4309018,500,50,"Disconnecting the connection [{0}]",this.lZ);ua=(ua=2===this.mZ||1===this.mZ)&&!this.h_a.b8a;let Wa=!0,yb=0;za&&Object.getType(za)!==Object.getType(Sys.EventArgs.Empty)&&
za.UPe&&""!==za.UPe&&(ua=!0,this.wMa.hUe(za.UPe),Wa=za.vSe,yb=za.reconnectDelay);ua&&this.dna(1,this.mZ);++this.sQb;this.h_a.nza();this.Hll(Wa);this.wMa.GZd();this.wIf();ua&&window.setTimeout(Object(e.a)(this,this.oxh,"startConnecting"),Math.min(yb,3E4))}Jxl(){let ua=null;const za=({correlationId:ua}=this.wMa.GRc()).returnValue;this.Y1.qs=za;k.ULS.sendTraceTag(40768457,500,50,"Connection parameters refresh finished for client [{0}], CorrelationId:{1}",this.Xr,ua)}Gxi(ua){const {FrequentLoggingMetrics:za}=
d(306);this.GDd=(new Date).getTime();let Wa=null;this.Y1.qs=({correlationId:Wa}=this.wMa.GRc()).returnValue;this.Jc.gci&&(this.Y1.url=ua,za.instance&&(za.instance.CFf=z.a.UD(ua)));let yb=null;this.Xh&&(yb=this.Xh.Ci("WebServiceCall","ConnectToServer"));k.ULS.sendTraceTag(3290048,500,50,"Connecting to server for client [{0}]",this.Xr);ua={};this.cEc&&(ua.transport=1===this.cEc.length?this.cEc[0]:this.cEc);ua.pingInterval=null;A.a.instance.cnc(1,0);ua.waitForPageLoad=!1;this.Y1.start(ua,null).done(Za=>
{this.Et.KNe();A.a.instance.cnc(1,1,!0);k.ULS.sendTraceTag(3457857,500,50,"Successfully connected to server using connection [{0}], CorrelationId:{1}",Za.id,Wa)}).fail(Za=>{k.ULS.sendTraceTag(3457858,500,15,"Failed to connect to server : connection string: {0}, CorrelationId:{1},  ClientDetails: [{2}]",this.wMa.MA,Wa,this.Xr);this.R2g();this.Et.afh(Za);A.a.instance.cnc(1,1,!1);this.rl.Ydh(0,{["CorrelationId"]:Wa,["ErrorDetails"]:Za,["ConnectionState"]:r.a[this.mZ]})}).always(()=>{const {FrequentLoggingMetrics:Za}=
d(306);yb&&yb.stop();Za.instance&&(Za.instance.Fzd=!1)})}disconnect(){const {FrequentLoggingMetrics:ua}=d(306);0===this.mZ?k.ULS.sendTraceTag(36545632,500,50,"Disconnect for [{0}] was called but the channel is already Disconnected",this.Xr):(this.Et.ffh(),ua.instance&&(ua.instance.Fzd=!0),k.ULS.sendTraceTag(36545633,500,50,"Starting explicit disconnect for [{0}]",this.Xr),this.h_a.b8a=!0,this.Nxd.Tnk(),this.dna(0,this.mZ),this.DMc(),this.h_a.b8a=!1)}Hll(ua){const za=this.sni(),Wa=this.Y1,yb=this.lZ,
Za=()=>{if(this.dKd)k.ULS.sendTraceTag(591692192,500,15,"Stop connection was called twice, possibly on the same connection.");else try{this.dKd=!0,Wa.stop(!0,ua)}catch(ub){k.ULS.sendTraceTag(591692191,500,15,"Stopping connection failed: {0}",ub.message)}};0<za?(k.ULS.sendTraceTag(4309020,500,50,"Waiting to stop connection [{0}]: [{1}] ms.",yb,za),window.setTimeout(Za,za)):(k.ULS.sendTraceTag(36804372,500,50,"Stopping connection [{0}].",yb),Za())}sni(){let ua=0;0===this.Y1.state&&(ua=this.GDd+Na.kEl-
(new Date).getTime(),0>ua&&(ua=0));return ua}get connectionState(){return this.mZ}K5a(ua){this.rl.K5a(ua)}GSe(ua){return this.FSe(0,ua)}FSe(ua,za){const Wa=new n.a;this.rl.aeh(ua,za,Wa);return Wa.task}UFc(ua){this.rl.UFc(ua)}wta(ua){return this.fmj(ua)}oQc(){return this.H1i()}H1i(){const ua={};for(let za of this.mS)za.value.Hb(0)&&(ua[za.key]=za.value.ga(0).data);return ua}fmj(ua){return this.mS.Hb(ua)&&this.mS.ga(ua).Hb(0)?this.mS.ga(ua).ga(0).data:null}kuk(ua,za){for(let Wa of za.oBl)this.mS.Hb(Wa.key)||
this.mS.$(Wa.key,new W.a),ua=Wa.value,this.mS.ga(Wa.key).$(za.type,new u(ua.Presence,new Date(ua.TimeStamp))),Wa.key===this._clientId&&0===za.type&&this.rl.vJk(ua.Presence)}juk(ua,za){for(const Wa of za.bUd)this.mS.remove(Wa)}G1i(){const ua=new W.a;if(!this.mS.Hb(this._clientId))return ua;for(let za of this.mS.ga(this._clientId))ua.$(za.key,za.value.data);return ua}Lfa(ua,za=null,Wa=!1){const yb=new n.a;this.rl.pNe(ua,za,Wa,yb);return yb.task}FBa(ua){this.rl.FBa(ua)}dcj(){return this.A3(this._clientId)}A3(ua){let za,
Wa;return({value:za}=this.mS.Uf(ua)).returnValue&&({value:Wa}=za.Uf(0)).returnValue?new w(this.jmj(Wa),Wa.timeStamp):null}P1i(){const ua={};for(let za of this.mS)za.value.Uf(0).returnValue&&(ua[za.key]=this.A3(za.key));return ua}rlb(ua){const za=new n.a;this.rl.aLk(ua,za);return za.task}get clientId(){return this._clientId}get Rhl(){return this.J_h}dispose(){const {FrequentLoggingMetrics:ua}=d(306);this.mK||(this.h_a.nza(),this.ei.Zjd(this.Et),this.Et.UNe(),ua.instance&&ua.instance.Zme(),this.mK=
!0)}mnk(ua,za){this.SOb(za,"StateChangedSignalR")&&this.dna(this.AGf(ua.newState),this.AGf(ua.oldState))}dna(ua,za){var {FrequentLoggingMetrics:Wa}=d(306),{ClientToClientMessageTelemetry:yb}=d(1024);if((1!==this.mZ||0!==za||1!==ua)&&this.mZ!==za){const Za=String.format.apply(null,["Unexpected connection state change : Current state is '{0}' while the event indicates ('{1}'->'{2}') transition"].concat([this.mZ,za,ua]));k.ULS.sendTraceTag(3290053,500,10,Za)}if(this.mZ!==ua){switch(ua){case 2:Wa.instance&&
Wa.instance.pfk();this.lZ=this.Y1.id;k.ULS.sendTraceTag(3249539,500,50,"Established connection [{0}] for client [{1}]",this.lZ,this.Xr);this.J2j(this.Y1);k.ULS.sendTraceTag(4298369,500,50,"Retrieving complete session state");Wa=null;this.Xh&&(Wa=this.Xh.Ci("WebServiceCall","Receive First Presence"));yb=this.sQb;this.rl.VJk(Object(e.a)(this,this.SOb,"verifyConnectionToken"),yb,this.Nxd,Object(e.a)(this,this.KTd,"clearExistingPersistentState"),this.G1i(),Wa);this.Jc.$Zk&&(Wa=100*Math.random()<=this.Jc.a_k,
d(1024).ClientToClientMessageTelemetry.bdj(this.rl,this.Jc,Wa).start());break;case 1:2===za&&k.ULS.sendTraceTag(4298644,500,50,"Lost connection [{0}] to the server ...trying to re-establish it",this.lZ);break;case 0:if(yb.instance&&yb.instance.stop(),this.h_a.b8a)k.ULS.sendTraceTag(3249543,500,50,"Connection [{0}] has been explicitly closed",this.lZ);else{1===za&&(k.ULS.sendTraceTag(7672737,500,50,"Signalr detected an unexpected disconnect event while attempting to re-establish connection [{0}]. Kicking off global reconnect logic ...",
this.lZ),this.Et.bnc());2===za&&k.ULS.sendTraceTag(36574532,500,50,"Signalr detected a disconnect event triggered by a period of client inactivity for connection [{0}]. Kicking off global reconnect logic ...",this.lZ);this.DMc();return}}this.mZ=ua;this.rl.GIk(ua,za)}}J2j(ua){if(ua&&ua.transport&&ua.transport.name){ua=ua.transport.name;var za=ua.toLowerCase();"websockets"===za?k.ULS.sendTraceTag(4290723,500,50,"Transport name - {0} for [{1}]",ua,this.Xr):"serversentevents"===za?k.ULS.sendTraceTag(4290752,
500,50,"Transport name - {0} for [{1}]",ua,this.Xr):"foreverframe"===za?k.ULS.sendTraceTag(4290753,500,50,"Transport name - {0} for [{1}]",ua,this.Xr):"longpolling"===za?k.ULS.sendTraceTag(4290754,500,50,"Transport name - {0} for [{1}]",ua,this.Xr):"mocktransport"!==za&&k.ULS.sendTraceTag(4290755,500,15,"Unknown transport protocol encountered - '{0}'",ua)}else k.ULS.sendTraceTag(4290722,500,10,"Transport protocol name is missing")}wtk(){if(this.Jc.Ilh){const ua=z.a.dT(this.Lma,"mid");k.ULS.sendTraceTag(3249544,
500,15,"Detected that the connection [{0}] is slow for target machine [{1}]",this.lZ,ua)}else k.ULS.sendTraceTag(522716053,500,50,"Detected that the connection [{0}] is slow",this.lZ)}htk(){k.ULS.sendTraceTag(3249545,600,15,"SignalR ERROR for connection [{0}];",this.lZ)}itk(ua){ua=d(187).RtcUtils.cGb(ua);if(this.Jc.Ilh&&ua.startsWith("Keep alive timed out.")){const za=z.a.dT(this.Lma,"mid");k.ULS.sendTraceTag(522716054,500,15,"SignalR lib: {0}. Target Machine: {1}",ua,za)}else this.Rhl&&2E3>this.Cmf&&
!ua.startsWith("Invok")&&!ua.startsWith("Trigger")&&(k.ULS.sendTraceTag(578950464,500,50,"SignalR lib: {0}",ua),this.Cmf++)}KTd(){let ua;const za=[];({value:ua}=this.mS.Uf(this._clientId)).returnValue&&this.mS.remove(this._clientId);for(let Wa of this.mS.keys)Array.add(za,Wa);for(const Wa of za)this.mS.remove(Wa);ua&&this.mS.$(this._clientId,ua);this.rl.lJk(za)}AGf(ua){switch(ua){case 0:return 1;case 2:return 1;case 1:return 2;case 4:return 0;default:throw Error.argumentOutOfRange("state",ua,"Unknown SignalR state");
}}jmj(ua){return ua&&ua.timeStamp?(new Date).getTime()-ua.timeStamp.getTime()>(this.Jc.PQd?6E4:this.Jc.awayCoauthorThresholdMs)?2:1:1}static createInstance(ua,za,Wa,yb,Za,ub,Ib,Ob=null,Hc=null,kb=null,jb=null,hb=null,uc=null){return Fa(ua,za,Wa,uc,yb,Za,ub,Ib,Ob,Hc,kb,hb,jb)}}Na.VXg=31E3;Na.iCe=8E3;Na.kEl=15E3;Object(K.a)(Na,"RealtimeChannel",null,[1321,1320])},691:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k{constructor(){this.inf=!1;this.nHd=null;this.a8e=0;this.Rzd=this.qJf();
this.Xvc=this.qJf();this.b2a=this.Cnb=0;this.zF=()=>new Date}get tml(){return this.inf}qJf(){const e=Array(6);for(let n=0;n<e.length;n++)e[n]=0;return e}u8i(){return this.Rzd.toString()}K4i(){return this.Xvc.toString()}Skl(){this.nHd=this.zF()}cnc(e,n,r=!1){this.tml||(r&&(this.inf=!0),r=this.zF(),0===e&&5<this.Cnb||1===e&&5<this.b2a||(this.a8e<e?(1===this.Cnb%2&&(this.Rzd[this.Cnb]=-1,this.Cnb++),this.a8e=e,1===n&&(this.Xvc[this.b2a]=-1,this.b2a++),this.Xvc[this.b2a]=this.zYe(r),this.b2a++):0===e?
(this.Rzd[this.Cnb]=this.zYe(r),this.Cnb++):(this.Xvc[this.b2a]=this.zYe(r),this.b2a++)))}zYe(e){const n=e.getTime()-this.nHd.getTime();this.nHd=e;return n}static get instance(){k.Ka||(k.Ka=new k);return k.Ka}static set instance(e){k.Ka=e}}k.Ka=null;Object(K.a)(k,"LatencyMetrics",null,[])},692:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k{constructor(e,n,r,v){this.lhk=e;this.FLa=n;this.pgk=r;this.Rnj=v}}Object(K.a)(k,"ThrottlerManagerSettings",null,[])},697:function(K,Z,d){K=d(0);
class k extends Sys.EventArgs{constructor(W,O){super();this.newState=W;this.oldState=O}}Object(K.a)(k,"ChangedConnectionStateEventArgs",Sys.EventArgs,[]);class e extends Sys.EventArgs{constructor(W,O){super();this.Qsi=W;this.uLa=O}}Object(K.a)(e,"ClientInfoEventArgs",Sys.EventArgs,[]);class n extends Sys.EventArgs{constructor(W){super();this.presence=W}}Object(K.a)(n,"MyPresenceUpdatedEventArgs",Sys.EventArgs,[]);class r extends Sys.EventArgs{constructor(W){super();this.bUd=W}}Object(K.a)(r,"PersistentStateClearedEventArgs",
Sys.EventArgs,[]);class v extends Sys.EventArgs{constructor(W,O){super();this.type=W;this.GOb=O}}Object(K.a)(v,"PersistentStateUpdateEventArgs",Sys.EventArgs,[]);var C=d(1122);class w extends Sys.EventArgs{constructor(W,O=null){super();this.DG=W;this.Z1h=O}get type(){return this.DG}get oza(){return this.Z1h}}Object(K.a)(w,"UpdateNotificationEventArgs",Sys.EventArgs,[]);class z extends Sys.EventArgs{constructor(W){super();this.bEk=W}}Object(K.a)(z,"GotCompletePersistentStateWithMetadataEventArgs",
Sys.EventArgs,[]);class A extends Sys.EventArgs{constructor(W,O,Y,S,da,fa){super();this.SOb=W;this.bVd=O;this.Hxi=Y;this.ARf=da;this.KTd=S;this.Ay=fa}}Object(K.a)(A,"RefreshAllPersistentStateEventArgs",Sys.EventArgs,[]);class u extends Sys.EventArgs{constructor(W){super();this.hubConnection=W}}Object(K.a)(u,"RefreshProxyEventArgs",Sys.EventArgs,[]);class E extends Sys.EventArgs{constructor(W,O){super();this.LUi=W;this.errorMessage=O}}Object(K.a)(E,"RtcConnectFailedEventArgs",Sys.EventArgs,[]);class H extends Sys.EventArgs{constructor(W,
O,Y){super();this.type=W;this.presence=O;this.uLa=Y}}Object(K.a)(H,"SendPersistentStateEventArgs",Sys.EventArgs,[]);var I=d(974);class J extends Sys.EventArgs{constructor(){super()}}Object(K.a)(J,"SessionPropertiesChangedEventArgs",Sys.EventArgs,[]);class T extends Sys.EventArgs{constructor(W){super();this.bUd=W}}Object(K.a)(T,"UpdatePersistentStateClearedRequestEventArgs",Sys.EventArgs,[]);class D extends Sys.EventArgs{constructor(W,O){super();this.type=W;this.oBl=O}}Object(K.a)(D,"UpdatePersistentStateRequestEventArgs",
Sys.EventArgs,[]);var R=d(76);d.d(Z,"a",function(){return Q});class Q{constructor(){this.Oa=new R.a}GIk(W,O){this.Oa.raiseEvent("CSC",new k(W,O))}WJk(W){this.Oa.raiseEvent("RP",new u(W))}ijd(W){this.Oa.raiseEvent("RC",W)}$Jk(){this.Oa.raiseEvent("RMID")}VJk(W,O,Y,S,da,fa){this.Oa.raiseEvent("RPS",new A(W,O,Y,S,da,fa))}xeh(W,O){this.Oa.raiseEvent("UPSR",new D(W,O))}Qdh(W,O){this.Oa.raiseEvent("PU",new C.a(W,O))}vJk(W){this.Oa.raiseEvent("MPU",new n(W))}pNe(W,O,Y,S){this.Oa.raiseEvent("SUN",new I.a(W,
O,Y,S))}bLk(W,O){this.Oa.raiseEvent("UNR",new w(W,O))}aeh(W,O,Y){this.Oa.raiseEvent("SP",new H(W,O,Y))}NJk(W,O){this.Oa.raiseEvent("PSU",new v(W,O))}MJk(W){this.Oa.raiseEvent("PSC",new r(W))}lJk(W){this.Oa.raiseEvent("IPSC",new r(W))}cLk(W){this.Oa.raiseEvent("UPSC",new T(W))}iKk(W,O){this.Oa.raiseEvent("SPC",new J(W,O))}Ydh(W,O){this.Oa.raiseEvent("RCF",new E(W,O))}cJk(W){this.Oa.raiseEvent("CPSWM",new z(W))}aLk(W,O){this.Oa.raiseEvent("UCI",new e(W,O))}K5a(W){this.Oa.addHandler("CSC",W)}v$h(W){this.Oa.addHandler("RP",
W)}u$h(W){this.Oa.addHandler("RC",W)}B$h(W){this.Oa.addHandler("RMID",W)}t$h(W){this.Oa.addHandler("RPS",W)}Cai(W){this.Oa.addHandler("UPSR",W)}UFc(W){this.Oa.addHandler("PU",W)}w8h(W){this.Oa.addHandler("IPU",W)}Aai(W){this.Oa.addHandler("UCI",W)}I$h(W){this.Oa.addHandler("SUN",W)}x8h(W){this.Oa.addHandler("IUNR",W)}FBa(W){this.Oa.addHandler("UNR",W)}v8h(W){this.Oa.addHandler("IPSU",W)}u8h(W){this.Oa.addHandler("IPSC",W)}Bai(W){this.Oa.addHandler("UPSC",W)}H$h(W){this.Oa.addHandler("SP",W)}Tsf(W){this.Oa.addHandler("SPC",
W)}F$h(W){this.Oa.addHandler("RCF",W)}p8h(W){this.Oa.addHandler("CPSWM",W)}mTk(W){this.Oa.removeHandler("CPSWM",W)}static getInstance(){return Q.Ka||(Q.Ka=new Q)}}Q.Ka=null;Object(K.a)(Q,"RtcEventHub",null,[1344])},699:function(K,Z,d){d.r(Z);K=d(0);var k=d(382),e=d(13),n=d(17),r=d(970),v=d(976),C=d(25),w=d(78),z=d(63),A=d(448),u=d(492),E=d(103),H=d(45),I=d(104),J=d(977);class T{}T.clientId="ClientId";T.SBl="UserApp";T.userSessionId="usid";T.userType="UserType";T.gCl="UserVersion";T.Imc="qs";T.Tsi=
"clientProtocol";T.rjk="NoAuth";Object(K.a)(T,"RtcFindSessionInputQueryParamConstants",null,[]);class D{constructor(ha,F,na,ba,Ea,La){this.i4a=null;const {FindSessionStrategy:ta}=d(699);this.mYh=ha;ha=String.format("{0}={1}",T.clientId,H.a.Ke(ba));ha=String.format("{0}&{1}={2}",ha,T.userSessionId,H.a.Ke(Ea));ha=String.format("{0}&{1}={2}",ha,T.SBl,H.a.Ke(na.toString()));ha=String.format("{0}&{1}={2}",ha,T.userType,H.a.Ke("1"));ha=String.format("{0}&{1}={2}",ha,T.gCl,H.a.Ke(F));ha=String.format("{0}&{1}={2}",
ha,T.Tsi,H.a.Ke(ta.Ssi));(F=D.n2i(na,La))&&(ha=String.format("{0}&{1}",ha,F));this.nOh=ha}Mfh(){this.i4a=this.mYh()}Q_i(){this.i4a&&""!==this.i4a||(this.Mfh(),k.ULS.sendTraceTag(575784194,500,this.i4a&&""!==this.i4a?50:15,"Query signature delegate called for refresh returned: {0} ",this.i4a));const ha=String.format("{0}={1}",T.Imc,H.a.Ke(this.i4a));return String.format("{0}&{1}",ha,this.nOh)}static n2i(ha,F){return 4===ha?String.format("{0}={1}",T.rjk,"1"):F?F.nmj():null}}Object(K.a)(D,"FindSessionQueryStringGenerator",
null,[]);var R=d(306),Q=d(691),W=d(187),O=d(692);class Y{}Y.$Wi="FSType";Object(K.a)(Y,"RtcFindSessionRequestHeaders",null,[]);class S{}S.ZLk="polling";Object(K.a)(S,"RtcFindSessionTypes",null,[]);var da=d(975);class fa{}fa.dDl="RTC-TokenProofkey";fa.JVj="RTC-IsWacJsBootFsRequest";Object(K.a)(fa,"RtcRequestHeaders",null,[]);d.d(Z,"FindSessionStrategy",function(){return ka});class ka{constructor(ha,F,na,ba,Ea,La,ta,oa,wa,ra,ya,Da,pa=null){this.Sef=(new Date(0)).getTime();this.cgf=0;this.Wzc=!1;this.Wlf=
null;this.bOe=36E5;this.Tmb=ka.Vbg;this.vRb=0;this.xib=null;this.Wxa=0;this.dKb=this.DFf=null;this.TYh=[v.a.gzb,v.a.errorMessage,v.a.pXe,v.a.MA,v.a.B5,v.a.l$d,v.a.Ifb,v.a.FLa,v.a.Kfb];this.SYh=[v.a.gzb,v.a.errorMessage];this.MA=this.Lma=null;this.L$e=new D(ya?ya:()=>C.AFrameworkApplication.jh,Ea,La,ta,ha,F);this.ZPb=Da;this.Xh=ba;this.ei=F;this.JQh=na;this.Xr=oa;this.rl=wa;this.HRb=pa;this.M$e=!1;this.v3b=9E4;ra&&ra.execute(la=>{la.RFc(()=>{k.ULS.sendTraceTag(40768456,500,50,"Connection parameters refresh requested for client [{0}]",
this.Xr);this.L$e.Mfh()})});2>=100*Math.random()&&(this.bOe=3E5);R.FrequentLoggingMetrics.instance&&(R.FrequentLoggingMetrics.instance.nWf=this.bOe)}hUe(ha){this.dKb=ha}init(){this.rl.B$h(Object(e.a)(this,this.HXk,"resetGetMachineIdDelay"));this.rl.K5a(Object(e.a)(this,this.dna,"onConnectionStateChanged"))}dna(ha,F){this.Wxa=F.newState;2===F.newState&&(this.vRb=0)}GRc(){let ha;ha=this.xib.correlationId;return{returnValue:String.format("{0}&{1}={2}",this.xib.B5,ka.RVd,H.a.Ke(ha)),correlationId:ha}}n8d(ha,
F,na,ba,Ea){this.O2k(()=>{ba(Ea,"GetMachineIdSuccess")&&(k.ULS.sendTraceTag(17956951,500,50,"Successfully retrieved Rtc MachineId [{0}] for [{1}]",this.MA,this.Xr),ha(this.Wlf),na(this.blj()))},La=>{ba(Ea,"GetMachineIdFailure")&&(k.ULS.sendTraceTag(4060129,500,15,"Failed to retrieve Rtc MachineId for [{0}]",this.Xr),F(La))},ba,Ea)}GZd(){this.pDf();this.JAj()}O2k(ha,F,na,ba){k.ULS.sendTraceTag(17956952,500,50,"Retrieving Rtc MachineId from server. Getting from last findsession, connectionString is [{0}]",
this.MA);this.MA?ha():window.setTimeout(()=>{this.sendFindSessionRequestToServerInternal(ha,F,na,ba)},this.$mi())}sendFindSessionRequestToServerInternal(ha,F,na,ba){na(ba,"RequestMachineId")&&(this.Sef=(new Date).getTime(),na=z.a.tj(),this.w_f(Ea=>{const La=z.a.tj();this.agd(Ea);this.QTe();ha();Ea=z.a.tj()-La;k.ULS.sendTraceTag(577356039,345,50,"SFSRTS Success - TimeElapsed: {0}",Ea)},Ea=>{const La=z.a.tj();this.pDf();R.FrequentLoggingMetrics.instance&&R.FrequentLoggingMetrics.instance.aH(2,3);F(Ea);
Ea=z.a.tj()-La;k.ULS.sendTraceTag(577356040,345,50,"SFSRTS Failure - TimeElapsed: {0}",Ea)},!1),na=z.a.tj()-na,k.ULS.sendTraceTag(577599296,345,50,"SFSRTS - TimeElapsed: {0}",na))}JAj(){this.Tmb+=ka.cbj;this.Tmb=Math.min(this.Tmb,ka.jgk)}$mi(){let ha=this.Sef+this.Tmb-(new Date).getTime();0>ha&&(ha=0);return ha}agd(ha){try{this.xib=ha,this.Lma=ha.lFf,this.MA=ha.MA,this.DFf=ha.B5,this.Wlf=ha.T_b}catch(F){k.ULS.sendTraceTag(17956953,500,10,"FindSession response contains invalid fields. Exception {0}, is thrown",
F.toString())}}pDf(){this.MA=null;this.qDf()}QTe(){this.qDf();this.Wzc=!0;this.cgf=window.setTimeout(Object(e.a)(this,this.fOk,"refreshMachineId"),this.bOe)}qDf(){this.Wzc&&(window.clearTimeout(this.cgf),this.Wzc=!1)}fOk(){this.Wzc=!1;this.w_f(ha=>{const F=this.DFf!==ha.B5,na=this.MA!==ha.MA,ba=this.MA;this.agd(ha);0!==this.Wxa&&(na?(k.ULS.sendTraceTag(17956955,500,15,"Recycling RTC connection due to RTC machine id change. old={0}, new={1}",ba||"null",ha.MA),this.rl.ijd()):(this.rl.iKk(F,na),this.QTe()))},
()=>{R.FrequentLoggingMetrics.instance&&R.FrequentLoggingMetrics.instance.aH(2,3);this.QTe()},!0)}HXk(){this.Tmb=ka.Vbg}blj(){return new O.a(this.xib.Abd,this.xib.xbd,this.xib.wbd,this.xib.gUc)}isl(ha){if(Object.getType(ha)!==Object)return null;for(let F in ha);return this.nCi(ha)}nCi(ha){if(!(v.a.gzb in ha))return null;const F=ha[v.a.gzb];var na=F?this.TYh:this.SYh;for(const ba of na)if(!(ba in ha))return null;na=Object.assign(new J.a,{X9b:ha[v.a.gzb],errorMessage:ha[v.a.errorMessage],correlationId:I.a.create().toString()});
F&&(na.T_b=ha[v.a.pXe],na.B5=ha[v.a.B5],na.MA=ha[v.a.MA],na.gUc=ha[v.a.l$d],na.wbd=ha[v.a.Ifb],na.xbd=ha[v.a.FLa],na.Abd=ha[v.a.Kfb]);return na}v8i(ha,F){k.ULS.sendTraceTag(50448152,500,50,"Using FindSessionUtils find session response");this.HRb.YWi.continueWith(()=>{this.HRb.YWi.result?(k.ULS.sendTraceTag(50448153,500,50,"FindSessionUtils find Session resulted in success"),ha(this.HRb.ZWi)):(k.ULS.sendTraceTag(50448154,500,15,"FindSessionUtils find Session resulted in error"),F(this.HRb.ZWi))})}Wjh(ha,
F,na,ba,Ea=!1){return La=>{Q.a.instance.cnc(0,1);ha&&ha.stop();this.ZPb=this.dKb=null;this.Bog(La.data,!0,F);var ta=W.RtcUtils.deserialize(La.data.Zd,"FindSession",null);if(ta)if(ta=this.isl(ta)){if(ta.X9b&&ta.B5&&ta.MA){k.ULS.sendTraceTag(4317446,500,50,"Successfully retrieved MachineId from server for [{0}]",this.Xr);this.j0j(La.data);na(ta);return}F.FindSessionFailureReason="FindSessionInvalidResponse";F.IsRtcEnabled=ta.X9b;F.IsQueryStringEmpty=!ta.B5;F.IsConnectionStringEmpty=!ta.MA;k.ULS.sendTraceTag(4290720,
500,15,"Response did not contain valid MachineId [ConnectionUrl and/or QueryString] for [{0}]; IsRtcEnabled:{1}; IsQueryStringEmpty:{2}; IsConnectionStringEmpty:{3}",this.Xr,ta.X9b,!ta.B5,!ta.MA)}else F.FindSessionFailureReason="FindSessionTranslateServerResponseFailed",k.ULS.sendTraceTag(8745097,500,15,"Could not translate server response to findSession response for [{0}]",this.Xr);else F.FindSessionFailureReason="FindSessionDeserializeServerResponseFailed",k.ULS.sendTraceTag(7372827,500,10,"Could not deserialize response data for [{0}]",
this.Xr);this.Zdh(F,Ea);ba(null)}}Ojh(ha,F,na,ba=!1){return Ea=>{Q.a.instance.cnc(0,1);ha&&ha.stop();this.ZPb=this.dKb=null;this.Bog(Ea.data,!1,F);let La=null;var ta="unknown";let oa="unknown";Ea.data&&((ta=Ea.data.rj)&&ka.zoc in ta&&(La=ta[ka.zoc].toString()),ta=u.a[Ea.data.status],oa=Ea.data.Te.toString());F.FindSessionFailureReason="FindSessionRequestFailed";F.HttpErrorCode=oa;F.HttpErrorStatus=ta;F[ka.zoc]=La;k.ULS.sendTraceTag(4290721,500,15,"Request for MachineId failed with Status='{0}'; HttpStatus='{1}' for [{2}]; RtcErrorCode='{3}'. Polling: '{4}' '",
ta,oa,this.Xr,La,ba);this.Zdh(F,ba);na(oa)}}w_f(ha,F,na=!1){let ba=null;k.ULS.sendTraceTag(4317445,500,50,"Getting MachineId from server for [{0}]",this.Xr);const Ea={};var La=this.L$e.Q_i();Ea[A.a.oCa]=I.a.create().toString();this.dKb&&""!==this.dKb?La=String.format("{0}&{1}={2}",La,da.a.kRe,this.dKb):this.ZPb&&""!==this.ZPb&&(La=String.format("{0}&{1}={2}",La,da.a.kRe,this.ZPb),Ea[fa.dDl]="True",Ea[fa.JVj]="True");La=this.JQh+"?"+La;na&&(Ea[Y.$Wi]=S.ZLk);const ta={};ta.IsNetworkOfflineBeforeSendRequest=
this.ei.gFa;ta.HasAvailableConnectionsBeforeSendRequest=this.ei.A9f;ta.MaxConnectionsAllowed=this.ei.QXg;ta.IsRefreshMachineId=na;this.HRb&&!this.M$e?(this.v8i(this.Wjh(null,ta,ha,F,na),this.Ojh(null,ta,F,na)),this.M$e=!0):(this.Xh&&(ba=this.Xh.Ci("WebServiceCall","GetMachineIdFromTheServer")),R.FrequentLoggingMetrics.instance&&R.FrequentLoggingMetrics.instance.aH(2,0),0>this.ei.YV(La,1,null,Ea,[ka.sKc,ka.zoc,ka.Sic,ka.iRe,ka.CZg,ka.x0g,ka.w0g],1,this.Wjh(ba,ta,ha,F,na),this.Ojh(ba,ta,F,na),null,
null,!1,null,this.v3b,"3",null,!0)&&(5<this.vRb&&200>this.vRb&&k.ULS.sendTraceTag(578166985,500,15,"FindSession request not scheduled due to expired token. Manually triggered failure callback {0} times.",this.vRb),window.setTimeout(()=>{this.vRb++;F("-1")},1E3)))}Bog(ha,F,na){na||(na={});na.IsNetworkOfflineAfterRequestComplete=this.ei.gFa;na.IsRequestSucceeded=F;ha&&(na.EnqueueTime=ha.rI,na.InvokedTime=ha.St,na.CompletedTime=ha.hv,ha.rj&&(ka.sKc in ha.rj&&(na.CorrelationId=ha.rj[ka.sKc]),ka.Sic in
ha.rj&&(na[ka.Sic]=ha.rj[ka.Sic])));k.ULS.sendTraceTag(38633565,500,F?50:15,W.RtcUtils.cGb(na))}Zdh(ha,F){ha||(ha={});ha.ConnectionState=r.a[this.Wxa];F||this.rl.Ydh(1,ha)}j0j(ha){try{var F=!1,na=!1,ba=ha.rj,Ea=w.a.UD(ha.request.get_url());if(ba&&ka.iRe in ba){const ra=ba[ka.iRe].toString().toLocaleLowerCase();na="true"===ra;F="false"===ra}ba=!1;const wa=0<=Ea.toLocaleLowerCase().indexOf("collab");na&&!wa?ba=!0:F&&wa&&(ba=!0);if(ba){F={};F.HostName=Ea;F.Status=u.a[ha.status];F.HttpStatus=ha.Te.toString();
var La=ha.request.get_headers();for(let ra in La){var ta=La[ra];(Ea=ra)&&0<Ea.length&&(na=0,ta&&(na=ta.toString().length),F["r_"+Ea]=na)}if(ha.rj){const ra=new n.a;ra.add(ka.sKc);ra.add(ka.Sic);ra.add(ka.zoc);ra.add(ka.x0g);ra.add(ka.w0g);ra.add(ka.CZg);ka.l6h(F,ha.rj,ra)}ka.g6h(ha.request.get_url(),F);var oa=E.a.toJSON(F);k.ULS.sendTraceTag(559437006,500,15,oa)}}catch(wa){k.ULS.sendTraceTag(559437007,500,10,"DomainLandingIncorretDC exception[{0}]",wa.toString())}}static createInstance(ha,F,na,ba,
Ea,La,ta,oa,wa,ra,ya,Da=null){return ka.UKc(ha,F,na,ba,Ea,La,ta,oa,wa,ra,null,ya,Da)}static dDi(ha,F,na,ba,Ea,La,ta,oa,wa,ra,ya=null){return ka.UKc(ha,F,na,ba,Ea,3,La,ta,oa,wa,ra,ya,null)}static UKc(ha,F,na,ba,Ea,La,ta,oa,wa,ra,ya,Da,pa=null){ha=ha||I.a.create().toString();ha=new ka(ha,F,na,ba,Ea,La,ta,oa,wa,ra,ya,Da,pa);ha.init();return ha}static l6h(ha,F,na){for(let ba of na)ba in F&&(ha[ba]=F[ba])}static g6h(ha,F){if(ha){var na=ha.indexOf("?");if(-1!==na)for(ha=ha.substr(na+1).split("&"),na=0;na<
ha.length;++na){var ba=ha[na].split("=");if(2===ba.length){const Ea=ba[0];if(Ea&&0<Ea.length){let La=0;if(ba=ba[1])La=ba.length;F["q_"+Ea]=La}}}}}}ka.cbj=3E3;ka.jgk=3E5;ka.Ssi="1.0";ka.Vbg=1E3;ka.sKc="X-CorrelationId";ka.RVd="corrid";ka.zoc="RtcErrorCode";ka.Sic="X-OfficeCluster";ka.iRe="X-NewEnv";ka.CZg="X-MSEdge-Ref";ka.w0g="X-OFFICEFD";ka.x0g="X-OfficeFE";Object(K.a)(ka,"FindSessionStrategy",null,[1340])},723:function(K,Z,d){K=d(0);class k{constructor(){this.K6e=this.Kxd=!1;this.callback=null}djc(n){this.callback=
n;this.jCh()}pXg(n){this.Kxd||(this.Kxd=!0,this.iOh=n,this.jCh())}jCh(){this.Kxd&&this.callback&&!this.K6e&&(this.K6e=!0,this.callback(this.iOh))}}Object(K.a)(k,"CompletionTask",null,[]);d.d(Z,"a",function(){return e});class e{constructor(){this.Dgf=new k;this.Bgf=new k}ped(n){this.Dgf.djc(n)}oed(n){this.Bgf.djc(n)}Phc(n){this.Dgf.pXg(n)}cYa(n){this.Bgf.pXg(n)}$Be(){this.Phc(2);this.cYa(2)}}Object(K.a)(e,"MessageStatus",null,[1449])},970:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);var k;
(function(e){e[e.disconnected=0]="disconnected";e[e.connecting=1]="connecting";e[e.connected=2]="connected"})(k||(k={}));Object(K.b)("ChannelConnectionState",k)},971:function(K,Z,d){d.r(Z);d.d(Z,"MaxOutstandingThrottler",function(){return r});K=d(0);var k=d(13),e=d(76);Z=d(972);var n=d(723);class r extends Z.a{constructor(v,C=""){super(v,C);this.Ifb=this.FLa=0;this.Oa=new e.a;this.dob=!1;this.FAc=this.pwc=this.Yvc=this.bLd=0;this.WDc=[];this.clearTimeout=r.jYd}add(v){this.eob||this.init(r.KKf,r.zKf);
this.Y4a++;const C=new n.a;this.Uyb?this.hod(v,C):this.FAc<this.Ifb?this.Yoc(v,C):(this.hod(v,C),this.dob=!1);return C}Yoc(v,C){v=this.Slf(v);const w=this.setTimeout(Object(k.a)(this,this.pqk,"onMessageWaitTimeExpired"),this.FLa);++this.FAc;Array.add(this.WDc,w);const z=this.Yvc;v.ped(A=>{C.Phc(A)});v.oed(A=>{this.Yvc===z&&(this.oqk(z,w),C.cYa(A))})}oqk(v,C){this.Yvc===v&&(--this.FAc,this.clearTimeout(C),Array.remove(this.WDc,C),this.Uyb&&this.t3k())}t3k(){this.Uyb&&!this.dob&&(this.bLd=this.setTimeout(Object(k.a)(this,
this.u3k,"sendThrottledMessageFromTimer"),0),this.dob=!0)}u3k(){this.dob=!1;if(this.Uyb){const v=this.SDc,C=this.Zpb;this.k_b(!1);this.Yoc(v,C)}}pqk(){++this.pwc;this.pwc>Math.floor(this.Ifb/2)&&(this.pwc=-1E9,this.Oa.raiseEvent("TMUDM"))}YFc(v){this.Oa.addHandler("TMUDM",v)}reset(){this.Y4a=this.DWb=this.fRb=this.pwc=0;++this.Yvc;for(const v of this.WDc)this.clearTimeout(v);this.FAc=0;this.WDc=[];this.k_b(!0);this.dob&&(this.clearTimeout(this.bLd),this.bLd=0,this.dob=!1)}init(v,C){this.eob||(this.FLa=
v,this.Ifb=C,this.eob=!0)}static createInstance(v,C=""){return new r(v,C)}static jYd(v){window.clearTimeout(v)}}r.KKf=15E3;r.zKf=5;Object(K.a)(r,"MaxOutstandingThrottler",Z.a,[1446,1447])},972:function(K,Z,d){d.d(Z,"a",function(){return e});K=d(0);var k=d(382);class e{constructor(n,r=""){this.fRb=this.DWb=0;this.DCd=!1;this.Zpb=this.SDc=null;this.eob=!1;this.Slf=n;this.eBh=r;this.setTimeout=e.tYd;this.Y4a=this.DWb=this.fRb=0}TNe(){0<this.Y4a&&0<this.fRb&&k.ULS.sendTraceTag(36545635,500,50,"Throttler [{0}] dropped [{1}] messages out of [{2}]",
this.eBh,this.fRb,this.Y4a);0<this.Y4a&&0<this.DWb&&k.ULS.sendTraceTag(36545634,500,50,"Throttler [{0}] throttled [{1}] messages out of [{2}]",this.eBh,this.DWb,this.Y4a)}get Uyb(){return this.DCd}hod(n,r){this.DWb++;this.k_b(!0);this.DCd=!0;this.SDc=n;this.Zpb=r}k_b(n){this.DCd=!1;this.Zpb&&n&&(this.fRb++,this.Zpb.$Be());this.Zpb=this.SDc=null}static tYd(n,r){return window.setTimeout(n,r)}}Object(K.a)(e,"ThrottlerBase",null,[])},973:function(K,Z,d){d.r(Z);d.d(Z,"MaxRateThrottler",function(){return n});
K=d(0);var k=d(13);Z=d(972);var e=d(723);class n extends Z.a{constructor(r,v=""){super(r,v);this.Kfb=0;this.yTb=(new Date(0)).getTime();this.currentTime=()=>(new Date).getTime()}init(r){this.eob||(this.Kfb=r,this.eob=!0)}add(r){this.eob||this.init(n.tKf);this.Y4a++;const v=this.currentTime(),C=new e.a;this.yTb>v&&(this.yTb=v);this.Uyb?(this.k_b(!0),this.hod(r,C)):this.yTb+this.Kfb<=v?this.Yoc(r,C):(this.hod(r,C),this.setTimeout(Object(k.a)(this,this.s3k,"sendThrottledMessage"),this.yTb+this.Kfb-v));
return C}s3k(){if(this.Uyb){const r=this.SDc,v=this.Zpb;this.k_b(!1);this.Yoc(r,v)}}Yoc(r,v){this.yTb=this.currentTime();r=this.Slf(r);r.ped(C=>{v.Phc(C)});r.oed(C=>{v.cYa(C)})}static createInstance(r,v=""){return new n(r,v)}}n.tKf=200;Object(K.a)(n,"MaxRateThrottler",Z.a,[1448,1447])},974:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k extends Sys.EventArgs{constructor(e,n,r,v){super();this.type=e;this.oza=n;this.LJi=r;this.uLa=v}}Object(K.a)(k,"SendUpdateNotificationEventArgs",Sys.EventArgs,
[])},975:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k{}k.kRe="rr";k.c_k="rd";k.ZZk="rbp";k.vSe="sa";Object(K.a)(k,"RtcReconnectParams",null,[])},976:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k{}k.Kfb="throttling_messageDelay";k.gzb="enabled";k.FLa="throttling_timeToWaitForResponse";k.Ifb="throttling_maxNumberOfOutstandingMessages";k.l$d="throttling_globalMaxNumberOfOutstandingMessages";k.errorMessage="errorMessage";k.pXe="url";k.B5="queryString";k.MA="connectionString";
Object(K.a)(k,"RtcFindSessionOutputFieldNameConstants",null,[])},977:function(K,Z,d){d.d(Z,"a",function(){return k});K=d(0);class k{constructor(){this.gUc=this.wbd=this.xbd=this.Abd=0;this.X9b=!1;this.correlationId=this.MA=this.B5=this.T_b=this.errorMessage=null}get lFf(){return this.T_b+"?"+this.B5}}Object(K.a)(k,"FindSessionResponse",null,[])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/18430998/wdjs/ppteditDS.presence1.js.map